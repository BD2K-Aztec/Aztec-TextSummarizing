Vol. 26 ECCB 2010, pages i659-i665
doi: 1 0. 1 093/bioinformatics/btq39 7

 

Mass spectrometry data processing using zero-crossing lines in
multi-scale of Gaussian derivative wavelet

Nha Nguyehm, Hehg Huang”, Soontorh Craihtara2 and An Vo3

1Department of Computer Science and Engineering, 2Department of Electrical Engineering, University of Texas at
Arlington, TX and 3The Feinstein Institute for Medical Research, North Shore LIJ Health System, New York, USA

 

ABSTRACT

Motivation: Peaks are the key information in mass spectrometry
(MS) which has been increasingly used to discover diseases-related
proteomic patterns. Peak detection is an essential step for MS-based
proteomic data analysis. Recently, several peak detection algorithms
have been proposed. However, in these algorithms, there are three
major deficiencies: (i) because the noise is often removed, the true
signal could also be removed; (ii) baseline removal step may get rid of
true peaks and create new false peaks; (iii) in peak quantification step,
a threshold of signal-to-noise ratio (SNR) is usually used to remove
false peaks; however, noise estimations in SNR calculation are often
inaccurate in either time or wavelet domain. In this article, we propose
new algorithms to solve these problems. First, we use bivariate
shrinkage estimator in stationary wavelet domain to avoid removing
true peaks in denoising step. Second, without baseline removal,
zero-crossing lines in multi-scale of derivative Gaussian wavelets
are investigated with mixture of Gaussian to estimate discriminative
parameters of peaks. Third, in quantification step, the frequency, SD,
height and rank of peaks are used to detect both high and small
energy peaks with robustness to noise.

Results: We propose a novel Gaussian Derivative Wavelet
(GDWaveIet) method to more accurately detect true peaks with a
lower false discovery rate than existing methods. The proposed
GDWaveIet method has been performed on the real Surface-
Enhanced Laser Desorption/Ionization Time-Of-Flight (SELDl-TOF)
spectrum with known polypeptide positions and on two synthetic
data with Gaussian and real noise. All experimental results
demonstrate that our method outperforms other commonly used
methods. The standard receiver operating characteristic (ROC)
curves are used to evaluate the experimental results.

Availability: http://ranger.uta.edu/~heng/MS/GDWavelet.htm| or
http://www.naaan.org/nhanguyen/archive.htm

Contact: heng@uta.edu

1 INTRODUCTION

Mass spectrometry (MS) is a crucial analytical tool in proteomics
research to provide tremendous information for disease proteomics
study and drug targets identiﬁcation at the protein/peptide level. Due
to measurement error, chemical and other background noise, MS
usually contains high—frequency noise and consequently a multitude
of misleading peaks. Peak detection is one of the most important
steps in MS data analysis because its performance directly effects
the ﬁnal proteomics study results.

Because the noise in MS comes from different resources and
cannot be estimated, false positive peak detection results are

 

*To whom correspondence should be addressed.

unavoidable. This makes peak detection as a challenging problem.
In recent years, several peak detection methods have been proposed
(Coombes et al., 2005; Du et al., 2006; Morris et al., 2005;
Nguyen et al., 2009). Most previous algorithms have four common
preprocessing steps: denoising, baseline correction, alignment of
spectrograms and normalization. After preprocessing, local maxima
is usually used to detect peak positions and design rules to quantify
peaks. In this article, we will explore the limitations of existing
peak detection methods and propose several new algorithms to solve
them.

Most peak detection methods employed denoising step by
removing noise in each scale of wavelet, such as commonly used
Cromwell (Coombes et al., 2005; Morris et al., 2005) and continuous
wavelet transform (CWT) (Du et al., 2006) methods. However,
true peaks in MS could have large frequency response and be
removed by denoising step. As a result, these true peaks cannot
be detected. We propose using bivariate shrinkage model, which
considers relationship of two neighbor scales, to remove noise in
stationary wavelet domain. Because utilizing relationship between
two neighbor coefﬁcients or two scales of wavelets can keep high—
frequency true signal (Selesnick et al., 2001). Stationary wavelet
transform (SWT) utilizes spatial information of signals and suppress
artifacts by redundant representations.

Baseline removal step was widely used in peak detection methods,
but it often got rid of true peaks and created new false peaks. To avoid
removing baseline, the CWT—based pattern—matching algorithm was
introduced in study by Du et al. (2006). Using Mexican Hat wavelet
in multi—scale, this method gave good results in peak detection with
high sensitivity and low false discovery rate (FDR). However, the
more important property of multi—scale in wavelet domain was not
used in this method (Mallat, 2009). Instead of considering peaks as
the sum of delta functions, more generally, we consider MS peaks
as a mixture of Gaussian in which each peak corresponds to one
Gaussian. We propose to use Gaussian derivative wavelet, instead
of Mexican Hat wavelet which is only the second derivative of
Gaussian wavelet. Zero—crossing lines which are robust to noise
are also introduced to replace Ridge—lines in Du et al. (2006).
We study the zero—crossing lines in multi—scale wavelet and provide
new theoretical analysis.

In most peak detection methods, signal—to—noise ratio (SNR) was
used to remove the small energy peaks with SNR values less than
a threshold. But MS noise cannot be correctly estimated in either
time domain or wavelet domain. Thus, in this article, instead of SNR,
frequency response, height and SD of Gaussian peaks calculated by
zero—crossing in Gaussian derivative wavelet domain are used to
remove false peaks. In order to improve sensitivity, the Envelope
analysis (Nguyen et al., 2009) is also used to save some important
peaks with small energy.

 

© The Author(s) 2010. Published by Oxford University Press.

This is an Open Access article distributed under the terms of the Creative Commons Attribution Non—Commercial License (http://creativecommons.org/licenses/
by—nc/2.5), which permits unrestricted non—commercial use, distribution, and reproduction in any medium, provided the original work is properly cited.

112 /BJO'SIBUJn0[pJOJXO'SOIlBIHJOJUIOIQ/ﬁdnq 11101; prBOIUAAOG

9IOZ ‘Ig lsnﬁnv uo ::

N.Nguyen et aI.

 

In this article, we propose a new Gaussian derivative
wavelet—based peak detection method (GDWaveIet) for Surface—
Enhanced Laser Desorption/Ionization Time—Of—Flight (SELDI—
TOF) spectrum. Both simulated and real spectrum with known
polypeptide positions and compositions are used to evaluate our
method. With simulated data, we compare different peak detection
algorithms by both Gaussian and real noise. All experimental results
show that our new approach can detect more peaks (in both high and
low amplitude) with a lower FDR than state—of—the—art methods.

2 METHODS

In this section, our new GDWaveIet method will be introduced.
In GDWaveIet, we utilize bivariate smoothing model, Gaussian derivative
wavelet and envelope analysis. First, bivariate shrinkage estimator in SWT
domain will be used to reduce noise and to keep whole true signal. Second,
we will introduce how to detect peaks using Gaussian derivative wavelet
through peak properties such as frequency response, SD and height. Finally,
envelope analysis is performed to save true small energy peaks which will
be missed if only peak properties are used.

2.1 Smoothing by bivariate shrinkage function

Noise smoothing in MS is an important step which should remove noise
and keep true peaks. In Myers et al. (2004), they tried to remove noise as
much as possible, hence some true peaks were also removed. We propose
to utilize bivariate shrinkage estimator in SWT domain to reduce noise and
keep whole true signal. More precisely, we decrease the noise level without
removing most of them. SWT is chosen due to its fast speed and redundant
representations. The later step will further handle the remaining noise.

To estimate wavelet coefﬁcients, the most well—known rules are universal
thresholding and soft thresholding (Donoho et al., 1995) which was applied
to Cromwell method (Coombes et al., 2005; Morris et al., 2005). These
algorithms assume that wavelet coefﬁcients are independent. Unfortunately,
frequency response of peak is rather wide. Hard or soft thresholding only
considers coefﬁcients in a sub—band with narrow frequency. Recent research
shows that algorithms utilizing the dependency between coefﬁcients can
give better results than those using the independency assumption (Sendur
et al., 2002). Sendur et al. exploited this dependency between coefﬁcients
and proposed a non—Gaussian bivariate pdf for the child coefﬁcient w1 and
its parent wz as follows

3 3
Pw(W)=2717€XP <—%VIW1|2+IW2|2)- (1)

The marginal variance 02 is dependent on the coefﬁcients index k.
By this bivariate pdf and the Bayesian estimation theory, the MAP estimator
of M (Sendur et al., 2002) is derived as

' 2 2 ﬁanz
0 1f |y1| +|y2| <—0 ,
W1: /—2 2_~/§Un2 (2)
M .321 otherwise.
V |y1|2+IY2|2

where yl is child noisy coefﬁcient, yz is parent noisy coefﬁcient. This
estimator is a bivariate shrinkage function. It has been used to smooth
many kinds of signals such as image (Sendur et al., 2002), DNA copy
number (Huang et al., 2008; Nguyen et al., 2010), etc. In this article, bivariate
shrinkage estimator is used to smooth MS signals. An example of denoising
result is shown in Figure 3a. This example will be discussed in Section 2.4.

2.2 Peak detection by Gaussian derivative wavelet

In previous works (Coombes et al., 2005; Morris et al., 2005), MS peaks
were considered as the sum of delta functions. That means only heights of
peaks have been used for peak detection throughout SNR. Du et al. (2006)

utilized width of peaks to improve peak detection results a lot. We consider
MS peaks as a mixture of Gaussian in which each peak corresponds to one

Gaussian:
N N (t—Mi)2
f<x>=§ :fi(t)=ZAieXP<— 20,  (3)
i=1 i=1 1‘

With this assumption, four parameters providing intrinsic differences
between true peaks and noise are peak position, SD, height and frequency
response of peak. To ﬁnd these parameters of a peak, we use zero—crossing
lines in multi—scale of Gaussian derivative wavelet instead of ridge—lines in
multi—scale of Mexican hat wavelet that was used by Du et al. (2006).

 

2.2.] Theory of zero-crossing lines in mnlti-scale Scaling theory for zero—
crossings has been studied and applied to many applications. Yuille et al.
(1986) assumed that signal is the sum of delta functions. Another similar
assumption of signal, bandlimited signal, has been studied in V0 et al.
( 1996). However, studying zero—crossing of signals with Gaussian mixture
assumption still is a new and challenging problem. We will build new
theory of zero—crossing lines in multi—scale in following sections. Through
our theory, parameters (position, SD, height and frequency response) of a
Gaussian peak can be accurately estimated.

We use the ﬁrst derivative of f,(t) to locate local maxima corresponding
peak position: f[ (to) = 0 with to = a). We continue using the second derivative
and third derivative of f,(t) to estimate height and SD of Gaussian peak:
mtg) :0 with to = h,- :l:o,-, fi”(t0) :0 with to = h,- and t0 = h,- j: #30,.

Since smoothing performed in denoising step only reduces noise and keeps
small true peaks, multi—scales of Gaussian derivative wavelet are used to
make local maxima and minima more robust to noise instead of only one
Gaussian ﬁlter in Nguyen et al. (2009). The wavelet transform can be written
as convolution product in (4):

+00 1 * t—n

According to Chapter 6 in Mallat (2009), the wavelet transform in (4) can
be rewritten as a multi—scale differential operator in (5)

 

d” _
an(u, 5) = 5" dun (ft *9s(t))(u). (5)
In this article, the Gaussian wavelet is used. So, 050) can be followed as (6):
5 (r) 1 t2 (6)
2 —ex — — .
S J; p S2

If convoluting f,(t) and 030), we get result in (7)

mtésxu) =K1 exp(—K2(u—m)2), (7)

l l
whereK =A /— andK =—.
1 2noizs3 2 s2+20i2

REMARK. The zero-crossing of WLf(n,s) and sz(n, s) belong to connected
curves that are never interrupted when the scale decreases.

PROOF. With the ﬁrst derivative, (5) can be rewritten as (8)

W1f(”a5)=25K1K2(U—Mi)eXP(—K2(U—Mi)2>- (8)

If WLf(n,s)=0, we got nozni and a0(s+l)—a0(s)=0 with any scale s.
With the second derivative, (5) can be rewritten as (9):

Wzﬂu,s)=2s2K1K2[—2K2(u—m>+ 1] €XP(—K2(M—Mi)2>- (9)

If sz(u,s)=0, we get u0=h,i,/e,2+  then 0<n0(s+l)—n0(s)§ 1
with any scale s.
With the third derivative, (5) can be rewritten as (10)

W3f(I/t, S) = —ZS3K1K2 -

l
(u—Mi)[2K2(u—Mi)2—3l eXP(—K2(u—Mi)2)- ( 0)

If W3f(n,s)=0, we get nozttl- or nozniix/St/oi2+ If we select
s=lOO and 0,201, then n0(100+1)—a0(100)=1.2247. In conclusion,

 

i660

112 /BJO'SIBUJn0[pJOJXO'SOIlBIHJOJUIOIQ/ﬁdnq 11101; prBOIUAAOG

9IOZ ‘Ig lsnﬁnv uo ::

MS peak detection by Gaussian derivative wavelet

 

 

80-

100-

 

120'

 

 

 

 

 

(C)

20 -
RI - 4o -

h 60
so -
100 -

120'

 

 

 

 

 

 

 

   
 

 

I'J‘ I"  Id“ i': IIIJ ‘

   

   

O 50 100 150 200 250 300 350 400 50 100 150

Zero Crossing line-Gaus1

I I I | I I l I I I I
200 250 300 350 400 50 100 150 200 250 300 350 400

Two Zero Crossing lines-Gau32

    

 

 

 

. d L.” I. '...|. f'.-..|. . . . I I
50 100 150 200 250 300 350 400 50 100

Two Ridge Lines-Gaus1

Fig. 1. An illustration of zero—crossing lines and ridge lines comparison. (a) A peak sample with shape followed (10 exp(—

150

Three Zero Crossing lines-Gau33

. . . u .. u...u'..2."u".' i- -. .1r.-.... -'-' .u u-. .. .. .
200 250 300 350 400 50 100 150 200 250 300 350 400

Three Ridge Lines-GausZ

0—5)2
2x052

 

)) and Gaussian noise

(SD21); (b) Using Gausl, the zero—crossing line corresponds to peak position, t=5; (c) Using Gaus2, two zero—crossing lines correspond to two peak
edges whose distances to peak position are 0,- =0.5; ((1) Using Gausl, two ridge lines are corresponding to two peak edges whose distances to peak position
are 0,- =0.5; (e) Using Gaus3, three zero—crossing lines are corresponding to one peak position and two peak edges whose distances to peak position are
x/Sol- 20.866; (1') Using Gaus2, three ridge lines are corresponding to one peak position and two peak edges whose distances to peak position are #60,.

0 5 a0(s + 1) — n0(s) 5 1 with the ﬁrst and second derivative and zero—crossing
lines belong to connected curves. Another conclusion is that zero—crossing
lines is discontinuous lines if the third derivative Gaussian wavelet is used.
Thus, only the ﬁrst and second derivative Gaussian wavelets should be used
in peak detection.

If f,- is a discrete signal, (4) can be rewritten as follows:

1 t—n
W , = ik —‘IJ* — d. 11
ﬂuo éﬁnﬂ ¢§ (S )t ( >

We get f (k) by sampling f,(t) with T S:

K+1

w—ex
fi(k)=fi(kTs)=Ai exp — S . (12)

a%r

If sz(n,s)=0, we get “Flea/aﬂw. if W3f(u,s)=0, we get “0:
2
[1401” MOZ/Liix/g 012+

Note: zero—crossing line is more robust to noise than ridge line. This
conclusion is illustrated by an example in Figure 1. Figure 10 and e show that
zero—crossing lines are easier to detect than ridge lines linking local maxima
or local minima points.

2.2.2 Applying zero-crossing to peak detection From Section 2.2.1,
parameters of a Gaussian peak could be estimated as follows:

Estimation of peak position: there are three ways to estimate peak positions
throughout zero—crossing of three kind Gaussian derivative wavelets.

(1) The ﬁrst Gaussian Derivative Wavelet (Gausl): zero—crossing line
corresponds peak position. In multi—scale, this zero—crossing line is a

continuous line with length N. Peak position should be estimated by

N
1
m=ﬁ2yw1 (B)
s=l
(2) The second Gaussian Derivative Wavelet (Gaus2): there are two zero—
crossing lines that correspond two edges of Gaussian peak. They are
“Oleft and wright. Because two zero—crossing lines are symmetric at
peak position, peak position should be estimated by
N
1 “Oleft (S) + “Oright (S)
-= — —. 14
M1 N Z 2 ( )
s=l
(3) The Third Gaussian Derivative Wavelet (Gaus3): there are three zero—

crossing lines if using the third GD Wavelet. They are “Oleft, nOmiddle
and MOI—ight. Because “Oleft and notight are non—continuous lines, they
should not be used to estimate peak position. From nOmiddle, we can
ﬁnd peak position by

N
1
Mi = N Z”0middle(s)- (15)
s=l
Estimation of peak ’s SD: Another parameter of Gaussian peak is SD 01-.
There are two ways to estimate a,- as follows

(1) The second Gaussian Derivative Wavelet (Gaus2): from Remark, 0,-
at scale s could be calculated by

2
whm9=ywwmo—mr—%u as

S
0i-right(S) = (“Oright(s) — #02 — 3- (17)

 

i661

112 /3.IO'SIBUJHOIpJOJXO'SOIlBIIIJOJUIOIQ/ﬂdnq 111011 pop1201um0q

9IOZ ‘Ig lsnﬁnv uo ::

N.Nguyen et aI.

 

Table 1. Error of peak position estimation

 

 

a in (24) Gausl Gausl Gaus2 Gaus2 Gaus3 Gaus3 Mexh
without denoise with denoise without denoise with denoise without denoise with denoise (Du et al., 2006)
0.25 0.0519 0.0365 0.1533 0.1434 0.4890 0.2652 1.979
0.50 0.1319 0.0809 0.2253 0.1943 0.6918 0.3851 2.0170
0.75 0.1658 0.1034 0.3382 0.2353 0.7008 0.4855 2.1137
1.00 0.2118 0.1469 0.4630 0.2672 0.8681 0.5874 2.1618

 

Using zero-crossing lines in multi-scale of Gaussian derivative wavelet, there are three ways to estimate peak position as in (13, 14, 15). We compare errors of these estimations
and CWT’s estimation (Du et al., 2006). The error rate is deﬁned by (25). In each Gaussian noise level, a, we created 200 signals. Error value shown in this table is average value.

After calculating 0,-_1eft (s) and oi_right(s) at all scales, 0,- should be estimated
by
Nil  Ui—left(s) + Nir  Ui—right(s)
0i = 2 a (18)
where N; and N, are length of left and right zero—crossing lines.

 

(2) The third Gaussian Derivative Wavelet (Gaus3): from Remark, 0,- at
scale s could be calculated by

 

l s2
0i—1eft(S) = §(”01eft(s) — M02 — 3, (19)
l s2
0i-right(S) = \/§ (Mot—ight(S) — M02 — 3- (20)

After calculating 0,-_1eft (s) and oi_right(s) at all scales, 0,- should be estimated
by
N I”
Nil 25:1 Ui—left(s) + Nir 237:1 Ui—right(s)
0i = 2 a (21)
where N; and Nr are length of left and right zero—crossing lines. However,
zero—crossing lines at left and right sides of the third Gaussian derivative
wavelet are disconnected lines, so it is not easy to estimate a,- through (19,
20, 21).
Estimation of peak height: ﬁnally, we develop a way to estimate real height

_ 2
of Gaussian peak. With Gaussian peak f,(t) 2A,- exp(— %)a we have

 

A _ﬁ(m)—ﬁ(m —0t)
’_ 0.3935 '
We can use (22) to estimate height of Gaussian peak after knowing [Li and 0,.
An Example: to demonstrate the above theory, we assume we have a
Gaussian peak as follows:

(22)

_ 2
(t Mag) (23)

x(t) =Ax exp (— W
x

where Ax = 10, px = 5 and ox 20.5. This peak is added Gaussian noise and
baseline as follows:
f (t)=x(t)+G(0, M)+b. (24)
where b is constant, a representation of baseline, [L =0 and a:
[0.25;0.5;0.75; 1]. With each a value, 200 signals f (s) have been created.
One sample f (t) is shown in Figure 1a. We will estimate 11.x, 0x and Ax using
above zero—crossing theory. Error rate which is deﬁned in (25) will be used
to compare accuracy of different estimation methods:
|true value—estimated valuel

error rate = x 100. (25)
true value

 

Figure 1b, 0 and e show zero—crossing lines in 128 scales using Gausl,
Gaus2 and Gaus3. These zero—crossing lines will be used to estimate 11.x, ox
and Ax. Table 1 lists error rates of four methods to estimate peak position
ax. With Gausl, Gaus2, and Gaus3 methods, ax values are calculated
by (13, 14, 15) correspondingly. The term ‘with denoise’ means bivariate

Table 2. Error of peak’s SD Estimation

 

 

a in Gaus2 Gaus2 Gaus3
(24) without denoise with denoise without denoise
0.25 1.6560 1.3829 2.3371
0.50 2.5626 2.3392 3.7318
0.75 3.3841 2.5087 4.7881
1.00 3.9726 2.8529 5.9220

 

ax can be estimated by (18) with Gaus2 or (21) with Gaus3. Error rate here is deﬁned
by (25). These error values are average values that are got from 200 signals with each
added Gaussian noise level, a.

Table 3. Error of peak’s height estimation

 

a in (24) Gaus2 Gaus2 Gaus3
without denoise with denoise without denoise

 

0.25 4.1032 1.7544 4.8886
0.50 7.8084 2.6869 8.2126
0.75 11.0612 2.8954 14.3860
1.00 13.6141 3.0502 16.9405

 

Peak height A x can be calculated by (22). Error rate here is deﬁned by (25). These error
values are average values that are got from 200 signals, with each added Gaussian noise
level, a.

shrinkage estimator is used to denoise Gaussian noise in signal f (t). The
Mexh, Mexican hat wavelet corresponding to Gaus2, is used as core part to
detect peak in CWT method (Du et al., 2006) and peak tree method (Zhang
et al., submitted for publication). Based on result’s in Table 1, the error rate
when using Mexh wavelet (Du et al., 2006) is the largest. We note that we
use package ‘MassSpecWavelet’ (Du et al., 2009) which uses denoising with
DWT and ﬁnds peak position using ridge lines (Du et al., 2006) with Mexh
wavelet. ‘Gausl with denoise’ has the smallest error rate. However, error
rates in Gausl without denoising and in Gaus2 are still acceptable and much
better than in Mexh wavelet.

We can estimate ox by (18) or (21). However, with Gaus3, zero—crossing
lines are not continuous lines (see Remark in Section 2.2.1). Thus, estimation
of zero—crossing in 128 scales of Gaus3 is a problem. This problem causes
a larger error in calculating the ox. From result of Table 2, we can conclude
that Gaus2 with denoising should be used to estimate 0;, because its error
rate is the smallest.

By using (22) with zero—crossing lines of both Gaus2 and Gaus3, the
height of Gaussian peak is estimated. In this case, baseline 19 which is used
in (24) is a constant. From Table 3, Gaus2 with denoising gives the smallest
error rate and should be used to calculate Ax.

 

i662

112 /B.IO'SIBUJHOIPJOJXO'SOIlBIIIJOJUIOIQ/ﬁdnq 111011 pop1201um0q

9IOZ ‘Ig lsnﬁnv uo ::

MS peak detection by Gaussian derivative wavelet

 

   
  
 
 
     

     
    

Peak Identification
in Multi-Scale
Gaussian Derivative
Wavelet

   
 
 

Quantification
Peak
Height

Fig. 2. GDWaveIet Method’s Flowchart. Raw MS data is smoothed by
bivariate shrinkage estimator in SWT domain to keep true signal and to
reduce noise. Without removing baseline, smoothed signal is used to estimate
parameters of peaks by zero—crossing lines in multi—scale Gaussian derivative
wavelet domain. After removing peaks with frequency response and width
less than a threshold, we get all peak candidates. All peak candidates are
quantiﬁed by PR in envelop analysis and peak height. Union results are ﬁnal
output.

From above example, the best way to estimate peak position [1.x is from
the ﬁrst Gaussian derivative wavelet, Gausl. The second Gaussian derivative
wavelet, Gaus2, should be used to estimate SD ox and height Ax of a Gaussian
peak. Figure 1d and f shows Ridge lines which correspond to zero—crossing
lines in Figure 10 and e. It is clearly that detecting Ridge lines is more
difﬁcult than detecting zero—crossing lines. Ridge lines in Du et al. (2006)
are similar to Ridge lines in Figure 1f, corresponding to zero—crossing line
in Gaus3 which should not be used because of its high error in calculating
parameters of peaks.

2.3 Saving small energy peaks by Envelope analysis

Envelope analysis was introduced by Nguyen et al. (2009). Any ﬁnite energy
signal y(t) can be analyzed into three envelope signals including MAX, MIN
and MED envelops at the ﬁrst level. Each of these envelops can be considered
as a signal and will be decomposed into three envelopes. In this article, we
use MAX and MED envelops to detect peaks because MIN envelops contain
no peak. We decompose the original signal into one MAX envelop at level 1,
one MAX and one MED envelops at level 2 and four envelops which comprise
two MAX envelops and two MED envelops at level n > 2. Empirically, 5—7
are recommended as the number of levels to get signiﬁcant peaks.

2.4 Proposed GDWaveIet method

The framework of our proposed GDWaveIet method is shown in Figure 2.
First, raw MS data is smoothed by bivariate shrinkage estimator (2) in SWT
domain to keep true signal and reduce noise. Note that, the lowest frequency
detail scale and approximate scale which may include true signal should
not be applied with any estimator, so that true signal is not removed. As a
result, noise in signal is reduced and smoothed signal still has a little noise.
Second, without applying baseline removal that often discards true peaks and
creates new peaks, smoothed signal is used to estimate frequency response,
position, height and SD of Gaussian peak by zero—crossing lines in multi—
scale Gaussian derivative wavelet domain. Frequency response of Gaussian
peak is proportional to the length of zero—crossing line if the ﬁrst derivative
Gaussian (Gausl) is used. Peak position, it), is estimated by (13). SD, 01-, of
Gaussian peak is calculated by (18). Result of (22) with Gaus2 gives heights
of peaks. Using the ﬁrst and the second derivative Gaussian wavelet, we
can estimate all parameters of a Gaussian peak. After removing peaks with
frequency response and SD less than a threshold, we get all peak candidates.
Third, in peak quantiﬁcation step, we use two rules to remove false peaks:
(i) all peak candidates are quantiﬁed by peak rank (PR; Nguyen et al., 2009)
in Envelop analysis. Peaks with PR=1, even small peaks, are important
peaks. (ii) Peak height is used to remove peaks with height smaller than
threshold. We use peak height to substitute SNR that was used by Morris
et al. (2005) and Du et al. (2006), because noise cannot be exactly estimated
in either time domain or wavelet domain. Finally, the union results of two
quantifying rules are the ﬁnal detected peaks.

We randomly select l9—th sample of CAMDA, 2006 to illustrate how
GDWaveIet method detects MS peaks. In Figure 3a, blue signal represents

 

(b)

7000

 

6000

 

5000

 

 

I I.
4000 ° 6° ' I I '-
0 I I

I I
.l I II
3000 so - I' I '.
I I
I : I
I 1
2°00 100 - i '.
I
I

1000 .'

Intensity
Scales

 

 

 

 

 

 

 

0 0.5 1 2.5 3 3.5 2.05 2.06 2.07 2.08 2.09 2.1

1.5 2
index x104 Index x104

Smoothing Step

Zero-Crossing lines

 

’6
V

——4mwMSDma .v‘
O By Peak Height 0-9 , v ’
It By Envelope
A True Peaks 0'8

   
   
      

 

— GDWaveIet
+ CWT

—I— Cromwell

- O - GaborEnvelop _

Intensity

 

 

 

 

    

 

 

o 10 "o 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9
M/Z x10‘

Peak Quantifying ROC curves off our methods

onthe 19th sample

Fig. 3. An Illustration of GDWaveIet. The 19—th sample of (CAMDA, 2006)
dataset is selected to illustrate how GDWaveIet method detects MS peaks.
(3) Blue signal is raw signal and red one is signal smoothed by bivariate
shrinkage estimator in wavelet domain. (b) Parameters of peaks are estimated
by zero—crossing lines. This ﬁgure shows zero—crossing lines of one zoomed
peak in (a). (c) Peaks are quantiﬁed by peak height and PR. Union results
include peaks with heights larger than a threshold or with PRs as one. (d) ROC
curves of four methods’ performance on the 19—th sample of CAMDA (2006)
dataset. GDWavlet gives the best performance.

raw signal and red one is signal smoothed by (2). A zoom in subﬁgure draws
the peak which is used to show its zero—crossing lines in Figure 3b. Using one
zero—crossing line in multi—scale of the Gausl and two zero—crossing lines
in multi—scale of the Gaus2, position, height, SD, and frequency response
of this peak are estimated. In Figure 30, we quantify peaks by two rules:
peak height and PR (in Envelope analysis). The circles are results from
peak height—based quantiﬁcation. The stars are from PR—based quantiﬁcation.
Union results include all peaks with heights larger than a threshold or PR
one. Figure 3d shows receiver operating characteristic (ROC) curves of four
related methods. GDWavlet gives the best performance.

3 EXPERIMENTS AND DISCUSSIONS

3.1 Experimental setup

Cruz—Marcelo et al. (2008) and Emanuele and Gurbaxani (2009)
presented the extensive studies to compare the performance of
state—of—the—art methods for SELDI data preprocessing, including
CWT (Du et al., 2006), Cromwell (Coombes et al., 2005;
Morris et al., 2005), PROcess (Li et al., 2006), Ciphergen and
SpecAlign (Wong et al., 2005). They concluded that CWT (Du
et al., 2006) has the best performance. Another method which also
works well is Cromwell (Coombes et al., 2005; Morris et al., 2005).
In this section, our GDWavelet method will be compared with the
Cromwell (Coombes et al., 2005; Morris et al., 2005), the CWT (Du
et al., 2006) and our previous method, GaborEnvelop (Nguyen
et al., 2009). Cromwell method is implemented by MATLAB which
can be downloaded from (UT—MD Anderson Cancer Centre, 2002).
The CWT method (Du et al., 2006) was implemented in R
(called ‘MassSpecWavelet’) and Version 1.12 can be downloaded

 

i663

112 /§.IO'SIBUJHOIPJOJXO'SOIlBIIIJOJUIOIQ/ﬁdnq 111011 pop1201um0q

9IOZ ‘Ig lsnﬁnv uo ::

N.Nguyen et al.

 

Average ROC Curves

(a) Average ROC Curves 

 

 

 

 

   

 

 

— GDWaveIet
+ CWT

—I— Cromwell _
-O- GaborEnvelop

   

Sensitivity

 

 

 

 

 

 

 

 

 

 

 

 

Fig. 4. ROC Curves—simulated data with Gaussian noise. Average ROC
curves of four methods (Cromwell, CWT, GaborEvelop and GDWaveIet).
(a) Obtained from 100 mean simulated MS signals which can be downloaded
from (Simulated Proteomics Spectra, 2005). There are 149 true peaks in this
data. (b) Obtained from 100 simulated MS signals in which Gaussian noise
is added. There are 20—30 true peaks in this data.

from Du et al. (2009). GaborEnvelop (Nguyen et al., 2009) is
implemented in MATLAB.

We evaluate the performance of above methods by the ROC curve.
Both simulated and real data are used. The ﬁrst simulated data was
proposed by Morris et al. (2005) and Coombes et al. (2005) and
is available for download at Simulated Proteomics Spectra (2005).
In this data, hundreds of mean spectrum samples with hundreds of
proteomics datasets are generated.

Based on the simulation engine developed by Morris et al.
(2005) and code (R and MATLAB) to generate simulated data
proposed by Cruz—Marcelo et al. (2008) and Zhang et al. (submitted
for publication), we also create two new simulated datasets
to investigate noise affection on different algorithms. The 100
spectrums with 20 — 30 true peaks are created ﬁrst, and Gaussian and
real noise are added separately to get two datasets. When Gaussian
noise is added, each sample includes 20% of protein peaks which are
below three time of SNR. Real noise is extracted from real data in
which there is no true peaks. There is only noise from 26000 (index)
to end in ﬁrst sample of CAMDA, 2006. Real noise probability
density function is built. Using this function, noise with different
SD will be created. Based on this conﬁguration, we create about
20—30 true peaks and more small energy peaks in simulated data.

The CAMDA dataset (2006) of all—in—1 Protein Standard II
(Ciphergen Cat. # C 100—007) is the real dataset. Because we know
polypeptide composition and position in this dataset, we can estimate
the sensitivity and the FDR. There are seven polypeptides which
create seven true peaks at 7034, 12230, 16951, 29023, 46 671,
66 433 and 147 300 of the m/z values.

The sensitivity and FDR of four methods are calculated for 60 real
MS signals and three simulated MS datasets with 100 signals each.
The SNR thresholding values are increased gradually to calculate the
ROC curves of Cromwell and CWT methods. The SNR thresholding
values are chosen from 0 to 20 for Cromwell method and from 0 to
120 for CWT method. In our GDWavelet method, the peak height
ratio, which is deﬁned as the ratio of current peak height over average
height of peaks, is changed from 0 to 10 to build the ROC curve.
We plot the average ROC curves in Figures 4 and 5. We should
notice that we take average of all ROC points with the same SNR
threshold (for Cromwell and CWT) and the same peak height rate
(for our GDWavelet method).

Average ROC Curves

 

 

(a)1 Average ROC Curves 

 

    

 

 

— GDWaveIet
' V - CWT

-9- GaborEnveIop
—l— Cromwell

 
 

— G DWaveIet
0.2 + CWT . 0.2
+ GaborEnveIop _ OJ

 

 

 

 

—— Cromwell

 

 

 

 

 

 

6 0.1 0.2 0.3 0.4 0.5 0.6 0-1 0-2 0.3 0.4 0.5
FDR FDR

Fig. 5. ROC curves—simulated data with real noise and real data.
Average ROC curves of four methods (Cromwell, CWT, GaborEvelop and
GDWaveIet). (a) Obtained from 100 simulated MS signals in which real
noise is used. There are 20—30 true peaks in this data. (b) Obtained from
60 MS signals (CAMDA, 2006). There are seven true peaks in this data.

3.2 Experimental results

Three simulated datasets and one real SELDI—TOF dataset are used
to create ROC curves in Figures 4 and 5. In all four datasets, the
performance of Cromwell is not stable and gets worse than CWT
and GDWavelet. Between GaborEnvelop which used Envelope
analysis and CWT which used ridge lines and SNR in peak
quantiﬁcation, GaborEnvelop is better than CWT in real data in
Figure 4b and CWT is better than GaborEnvelop in simulated data.
In all cases, our GDWavelet method has much better performance
than GaborEnvelop and CWT methods. At the same FDR, the
sensitivity of our method is consistently higher than GaborEnvelops
and CWTs. It is clear that utilizing both of Envelope analysis and
Gaussian derivative wavelet in peak quantiﬁcation made signiﬁcant
contributions to detect both high energy and small energy peaks.
Bivariate shrinkage estimator in wavelet domain guarantees that
denoising step in our method saves more true signal than in Morris
et al. (2005). Zero—crossing lines—based peak parameters estimations
in our article is more accurate and robust to noise than ridge lines
in Du et al. (2006). Envelope analysis is more efﬁciently used
in GDWavelet than in GaborEnvelop. Therefore, the GDWavelet
has better peak detection results than Cromwell, GaborEnvelop and
CWT. Thus, it is an efﬁcient and accurate method to detect peaks in
both real and simulated MS data. In Figures 4 and 5, CWT’s ROC
curves is limited in small FDR because two thresholds of the length
of ridge lines and the scale corresponding to the maximum amplitude
on the ridge line are used as default in MassSpecWavelet (Du et al.,
2009). Finally the runtime of GDWavelet algorithm is comparable
to CWT method, because both methods need more computational
time to decompose a signal to many scale using continuous wavelet
transform.

4 CONCLUSIONS

In this article, we proposed new zero—crossing line theory in multi—
scale of Gaussian derivative wavelet to estimate parameters of
peaks in MS which has been assumed as a mixture of Gaussian. A
novel GDWavelet method was proposed to efﬁciently and accurately
detect MS peaks by integrating bivariate shrinkage model, Gaussian
derivative and Envelope analysis. The bivariate shrinkage estimator
in SWT domain was used to reduce noise and still keep true peaks.

 

i664

112 /E.IO'SIBUJHOIPJOJXO'SOIlBIIIJOJUIOIQ/ﬁdnq 111011 pop1201um0q

9IOZ ‘Ig lsnﬁnv uo ::

MS peak detection by Gaussian derivative wavelet

 

All parameters of a Gaussian peak, estimated by multi—scale in
Gaussian derivative wavelet and Envelope analysis, have been used
to remove false peaks. The peak height and PR were introduced
as a nice substitution of the previous SNR method to identify true
peaks. Both simulated data and real MS data are used to evaluate
our GDWavelet method. Simulated data were created with both
Gaussian noise and real noise. Our GDWavelet method gave out a
much better performance in the ROC curves than three other state—
of—the—art peak detection methods. GDWavelet algorithm will be
extended and test with other kinds of MS (such as MALDI—TOF)
as future work. Based on GDWavelet method, many MS data—
related applications will be improved, such as protein identiﬁcation,
biomarker discovery, cancer classiﬁcation, etc.

F anding: NSF—CCF 0830780; NSF—CCF 0939187; NSF—CCF
0917274; NSF—DMS 0915228; NSF—CNS 0923494; UTA—REP.

Conﬂict of Interest: none declared.

REFERENCES

CAMDA (2006) Conference contest. Available at http://camda.duke.edu/camda06/
datasets/index.html (last accessed data July 12, 2010).

Coombes,K. et al. (2005) Improved peak detection and quantiﬁcation of mass
spectrometry data acquired from surface-enhanced laser desorption and ionization
by denoising spectra with the undecimated discrete wavelet transform. Proteomics,
5, 4107—41 17.

Cruz-Marcelo,A. et al. (2008) Comparison of algorithms for pre-processing 0f seldi-tof
mass spectrometry data. Bioinformatics, 24, 2129—2136.

Du,P. et al. (2009) Mass spectrum processing by wavelet-based algorithms. Available
at http://bioconduct0r.0rg/packages/2.5/bioc/html/MassSpecWavelet.html (last
accessed date July 12, 2010).

Du,P. et al. (2006) Improved peak detection in mass spectrum by incorporating
continuous wavelet transform-based pattern matchingBioinformatics, 22, 2059.

D0n0h0,D. et al. (1995) De-Noising by soft-thresholding. IEEE Trans. Inf. Theory, 41,
613—627.

Emanuele,V. and Gurbaxani,B. (2009) Benchmarking currently avaible SELDI-TOF
MS preprocessing techniques. Proteomics, 9, 1754—1762.

Huang,H. et al. (2008) Array CGH data modeling and smoothing in stationary wavelet
packet transform domain. BMC Genomics, 9 S2—S17.

Li,X. et al. (2006) SELDI-TOF mass spectrometry protein data. Ch. 6. Springer, New
York, pp. 91—109.

Mallat,S. (2009) Wavelet Tour of Signal Processing - The Sparse Way. Academic Press.

Myers,C. et al. (2004) Accurate detection of aneuploidies in array CGH and gene
expression microarray data. Bioinformatics, 20, 3533—3543.

Morris,J. et al. (2005) Feature extraction and quantiﬁcation for mass spectrometry in
biomedical applications using the mean spectrum. Bioinformatics, 21, 1764—1775.

Nguyen,N. et al. (2009) Peak detection in mass spectrometry by gabor ﬁlters and
envelope analysis. JBCB, 7, 547—569.

N guyen,N . et al. (2010) Stationary wavelet packet transform and dependent Laplacian
bivariate shrinkage estimator for array-CGH data smoothing. J. Comput. Biol, 17,
139—152.

Selesnick,I.W. et al.(2001) Hilbert transform pairs of wavelet bases. IEEE Signal
Process. Lett., 8, 170—173.

Sendur,L. et al. (2002) Bivariate shinkage function for wavelet-based denoising
exploiting interscale dependency. IEEE Trans. Signal Process, 50, 2744—2756.
Simulated Proteomics Spectra. (2005) Available at http://bi0inf0rmatics
.mdanderson.org/Supplements/Datasets/Simulations/index.html (last accessed

date July 12, 2010).

UT—MD Anderson Cancer Center (2002) The new model processor for mass
spectrometry data. Available at http://bi0inf0rmatics.mdanderson.0rg/cr0mwell.
html (last accessed date July 12, 2010).

V0,A. et al. (1996) Scaling theorems for zero crossings of bandlimited signals. IEEE
Trans. Pattern Anal. Mach. Intell, 18, 309—320.

W0ng,J. et al. (2005) Specalign processing and alignment of mass spectra datasets.
Bioinformatics, 21, 2088—2090.

Yuille,A. et al. (1986) Scaling theorems for zero crossings. IEEE Trans. Pattern Anal.
Mach. Intell, 8, 15-25.

 

i665

112 /E.IO'SIBUJHOIPJOJXO'SOIlBIIIJOJUIOIQ/ﬁdnq 111011 pop1201um0q

9IOZ ‘Ig lsnﬁnv uo ::

