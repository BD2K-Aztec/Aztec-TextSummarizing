ORIGINAL PAPER

Vol. 29 no. 7 2013, pages 821—829
doi:10. 1093/bioinformatics/btt056

 

Genome analysis

Advance Access publication February 17, 2013

Non-parametric Bayesian approach to post-translational
modification refinement of predictions from tandem mass

spectrometry

Clement Chung1’2, Andrew Emili3’4 and Brendan J. Frey

1,2,3!5!*

1Department of Computer Science, University of Toronto, Toronto, M58 2E4, 2Probabilistic and Statistical Inference
Group, University of Toronto, Toronto, M58 384, 3Banting and Best Department of Medical Research, 4Donnelly Centre
for Cellular and Biomolecular Research, University of Toronto, Toronto, M58 3E1 and 5Department of Electrical and
Computer Engineering, University of Toronto, Toronto, M58 384, Canada

Associate Editor: Alfonso Valencia

 

ABSTRACT

Motivation: Tandem mass spectrometry (MS/MS) is a dominant ap-
proach for large-scale high-throughput post-translational modification
(PTM) profiling. Although current state-of—the—art blind PTM spectral
analysis algorithms can predict thousands of modiﬁed peptides
(PTM predictions) in an MS/MS experiment, a significant percentage
of these predictions have inaccurate modification mass estimates and
false modification site assignments. This problem can be addressed
by post-processing the PTM predictions with a PTM refinement algo-
rithm. We developed a novel PTM refinement algorithm, iPTMClust,
which extends a recently introduced PTM refinement algorithm
PTMClust and uses a non-parametric Bayesian model to better ac-
count for uncertainties in the quantity and identity of PTMs in the input
data. The use of this new modeling approach enables iPTMClust to
provide a confidence score per modification site that allows
fine-tuning and interpreting resulting PTM predictions.

Results: The primary goal behind iPTMClust is to improve the quality of
the PTM predictions. First, to demonstrate that iPTMClust produces
sensible and accurate cluster assignments, we compare it with
k—means clustering, mixtures of Gaussians (MOG) and PTMClust on a
synthetically generated PTM dataset. Second, in two separate bench-
mark experiments using PTM data taken from a phosphopeptide and a
yeast proteome study, we show that iPTMClust outperforms
state-of—the—art PTM prediction and refinement algorithms, including
PTMClust. Finally, we illustrate the general applicability of our new ap-
proach on a set of human chromatin protein complex data, where we
are able to identify putative novel modified peptides and modification
sites that may be involved in the formation and regulation of protein
complexes. Our method facilitates accurate PTM profiling, which is an
important step in understanding the mechanisms behind many biolo-
gical processes and should be an integral part of any proteomic study.
Availability: Our algorithm is implemented in Java and is freely avail-
able for academic use from http://genes.toronto.edu.

Contact: frey@psi.utoronto.ca

Supplementary information: Supplementary data are available at
Bioinformatics online

Received on September 18, 2012; revised on January 10, 2013;
accepted on January 30, 2013

 

*To whom correspondence should be addressed.

1 INTRODUCTION

Post-translational modiﬁcations (PTMs) are known to play a vital
role in the cell and are instrumental in many disease-related
studies (Lehninger et al., 1993). A core task in studies involving
PTMs is PTM prediction, i.e. identiﬁcation of peptide sequences
and PTMs associated with each modiﬁed peptide within a biolo-
gical sample. A preferred experimental procedure for PTM pre-
diction is tandem mass spectrometry (MS/MS) followed by an
analysis with a ‘blind’ PTM search engine. [See (Cantin and
Yates, 2004; Domon and Aebersold, 2006) for reviews]. Blind
PTM search engines are commonly used because they can detect
both known and novel PTMs. However, PTM predictions pro-
duced by blind PTM search engines contain inaccurate modiﬁca-
tion masses and incorrect modiﬁcation positions (Keller et al.,
2002; Ramakrishnan et al., 2009a,b). The fragmentation process
is often incomplete and the presence of labile PTMs may interfere
with this process (Mikesh et al., 2006). These issues result in spec-
tra missing peaks that in turn may lead to ambiguous or erroneous
modiﬁcation predictions. Naturally occurring stable isotopes,
such as carbon-13, and electronic noise contribute to inaccurate
mass measurements. These issues are more prominent in spectra
generated from low mass-resolution spectrometers (e. g. ion trap
mass spectrometers), which are still commonly used in today’s MS
studies. Therefore, it is prudent to incorporate PTM reﬁnement as
part of a PTM prediction pipeline, as it can signiﬁcantly improve
the quality of PTM predictions. Previous studies demonstrate that
post-processing greatly improves the number of positive predic-
tions while reducing the amount of false PTM assignments
(Chung et al., 2011; Tanner et al., 2008).

PTM reﬁnement can be classiﬁed into two types of approach:
one that scores the localization of PTMs and one that reﬁnes
observed modiﬁcation masses and modiﬁcation positions. The
ﬁrst type provides a way to evaluate the quality of predicted
modiﬁcation sites from PTM search engines. The two main stra-
tegies for scoring the reliability of modiﬁcation site localizations
are: (i) to calculate the probability that a peak responsible for the
site determination is matched at random and (ii) to compute
the search engine score difference between predictions with vary-
ing site localizations. Methods that use the former strategy
include A-score (Beausoleil et al., 2006), PTM Score (embedded
in MaxQuant and Andromeda) (Olsen et al., 2006), the

 

© The Author 2013. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com 821

112 [glO'SIBILInO[plOJXO'SODBIILIOJHTOTQ/[ldllq IIIOJJ pepcolumoq

910K ‘09 lsnﬁnV no :2

C.Chung et al.

 

Phosphorylation Localization Score (PLS) in InsPecT (Albu-
querque et al., 2008), SLoMo (Bailey et al., 2009), Phosphinator
(Phanstiel et al., 2011), PhosphoRS (Taus et al., 2011). Examples
of the latter scoring strategy are Mascot Delta Score (Savitski
et al., 2011), the site localization in peptide (SLIP) score in Pro-
tein Prospector (Baker et al., 2011) and the variable modiﬁcation
localization score in Spectrum Mill (Agilent, 2005). A review of
the different modiﬁcation site scoring localization methods is
provided in (Chalkley and Clauser, 2012).

PTM reﬁnement using a modiﬁcation site localization scoring
algorithm can be achieved by reassigning the modiﬁcation pos-
ition to the highest scoring position for each modiﬁed peptide.
However, modiﬁcation site localization scoring methods are lim-
ited when used for general PTM reﬁnement owing to the follow-
ing three reasons. First, a predeﬁned list of PTMs is required for
these scoring methods. Second, these scoring methods assume
that input-predicted modiﬁcation masses are error-free and are
mapped precisely to one of the PTMs in the predeﬁned list.
Lastly, most of these scoring methods are designed to score
only phosphorylated predictions. Consequently, modiﬁcation
site localization scoring methods are ill-suited to analyze PTM
datasets generated from blind PTM search engines.

The second type of PTM reﬁnement approach is to reﬁne both
observed modiﬁcation masses and modiﬁcation positions. Two
recently published algorithms that use this type of PTM reﬁne-
ment method are PTMFinder (Tanner et al., 2008) and our pre-
vious algorithm, PTMClust (Chung et al., 2011). PTMFinder
takes a peptide-level approach to PTM reﬁnement, where it
groups and reanalyzes spectra mapping to the same modiﬁed
peptide sequence to produce for each spectrum a ﬁnal peptide
sequence with a modiﬁcation mass and a modiﬁcation position.
Hence, reﬁnement using this method is limited to modiﬁed pep-
tides that occur multiple times in the same dataset. As shown in a
recent study, a modiﬁed peptide is rarely found more than three
times even for a large-scale, genome-wide experiment (Chung
et al., 2011). Furthermore, PTMFinder suffers from favoring
high abundance modiﬁed peptides and discretizing observed
modiﬁcation masses. In contrast, PTMClust accounts for errors
of the observed modiﬁcation masses and modiﬁcation positions at
the PTM level, and overcomes several issues that PTMFinder has.

The principle behind, and the distinguishing feature of,
PTMClust is modeling modiﬁcations at the PTM level instead of
at the peptide level. While peptide-level modeling can beneﬁt from
correcting low-level errors, the PTMClust approach has the ad-
vantage of accounting for low abundance modiﬁed peptides be-
cause other peptides with the same underlying PTM can help
identify the correct but unknown modiﬁcation mass and modiﬁed
amino acid. PTMClust uses a generative model to capture the
hidden relationship between factors inﬂuencing the PTM mapping
process. It uses the expectation-maximization (EM) algorithm and
a modiﬁed version of the split and merge model selection method
to learn and infer an optimal parameter setting for the model. As
part of the model selection procedure, a range of models are
learned by adjusting a model complexity parameter, and the
ﬁnal model is selected by weighting the trade-off between false
positives (determined using decoy peptides) and correct (real) pep-
tides detected. The resulting PTM predictions are of higher quality
than those taken from existing blind PTM search engines alone
and those post-analyzed with PTMFinder (Chung et al., 2011).

Here, we address some limitations of PTMClust: (i) the use of
a greedy method for selecting the number of PTM clusters,
(ii) the need for manual parameter tuning, and (iii) the lack of
a conﬁdence score per modiﬁcation position. We overcame these
limitations by extending the PTMClust model to allow for an
unbounded number of mixture components that can account for
uncertainties in the quantity and identity of PTMs in the input
data. The model makes use of an inﬁnite non-parametric mixture
model, so we refer to it as inﬁnite-PTMClust or zPTMClust. This
extension parallels the conversion from a ﬁnite to an inﬁnite
standard mixture model (IMM), but the complex nature of the
underlying PTMClust model makes this extension non-trivial.
We derived and implemented a Gibbs sampling algorithm
(Bishop, 2006; Geman and Geman, 1984) and a split-and—merge
Metropolis-Hastings algorithm (Jain and Neal, 2000), which
enable zPTMClust to efﬁciently infer the groupings of input
modiﬁed peptides and reﬁne the peptides’ modiﬁcation masses
and modiﬁcation positions. zPTMClust achieves the following
beneﬁts: (i) it outperforms PTMClust and other PTM reﬁnement
algorithms, (ii) it provides a more highly automated model selec-
tion method that does not require manual parameter tuning, and
(iii) it outputs modiﬁcation position-level conﬁdence scores that
users can use to assess the quality of the result and further reﬁne
their analyses. In a series of benchmark experiments on both
synthetic and real-world phosphopeptide datasets, we show
that zPTMClust outperforms PTMClust and other state-of-
the-art PTM prediction and PTM reﬁnement algorithms. To
ensure broad applicability, we have designed and optimized
zPTMClust to analyze PTM data generated from both low-
and high-resolution MS/MS spectra processed by popular
blind PTM search engines. As with PTMClust, the input to
zPTMClust is a list of PTM predictions consisting of the peptide
sequence, modiﬁcation position and modiﬁcation mass.

2 METHODS

Similar to PTMClust, zPTMClust is based on a generative probability
model that describes a process in which observed modiﬁed peptides can
be generated by modeling interactions between hidden variables that play
a role in the protein modiﬁcation process. Given an observed modiﬁca-
tion, we assume it comes from one of many PTMs. However, the number
and identity of these PTMs are unknown. Our method accounts for this
uncertainty by considering a variable unbounded number of PTMs. By
deﬁning appropriate priors on the hidden variables, over-ﬁtting can be
avoided, and only a ﬁnite set of PTM groups are used at anytime during
inference. The latter point is important because it makes calculations in
the algorithm tractable. During inference, the properties of the active
PTM groups are inﬂuenced by the input data and the chosen priors.
We adapted both the Gibbs sampling and the restricted Gibbs sampling
split-merge algorithms to infer the values of the hidden variables and
parameters in our model. After inference, these hidden variables and
model parameters can be used to deduce the true modiﬁcation mass
and a conﬁdence score per possible modiﬁcation position for each
input peptide sequence, or the maximum a posteriori (MAP) estimate
of modiﬁcation masses and positions.

2.1 iPTMClust model and conditional distributions

The core of the generative model in zPTMClust is the same as in
PTMClust: it describes how a pair of observed modiﬁcation mass and
modiﬁcation position are generated. zPTMClust extends PTMClust by

 

822

112 ﬂJO'smumo[pJOJXO'sopchoguioiq/ﬁd11q IIIOJJ pepcolumoq

910K ‘09 lsnﬁnV no :2

iPTMClust: Non-parametric Bayesian PTM refinement algorithm

 

introducing priors on model variables and parameters that govern the
choice of active PTM groups from a boundless number of PTM groups.
Given the type of PTM (PTM group) chosen from one of the limitless
numbers of PTM groups, we can generate the observed modiﬁcation
mass as a noisy version of the mean modiﬁcation mass, and select an
amino acid most likely to contain the modiﬁcation as the modiﬁed amino
acid. Given the peptide sequence, we assume that the ‘true’ modiﬁcation
position is uniformly distributed among those positions that match the
modiﬁed amino acid. Finally, we assume that the observed modiﬁcation
position is a noisy version of the true modiﬁcation position.

The structural relationships between variables are shown by the
Bayesian network in Figure 1. The top part outlines the priors represented
by their corresponding hyper-parameters placed on the model parameters:
mixing coefﬁcient, modiﬁcation mass means, modiﬁcation mass variances
and probability of modiﬁcation occurring on an amino acid. The bottom
portion describes the model for one input peptide and is repeated for N
measurements, as indicated by the plate notation. The extension from
PTMClust to zPTMClust follows similar steps as for a standard mixture
model, as given in (Escobar and West, 1994; Rasmussen, 2000). In the
following, we outline the rational and intuition behind the different com-
ponents of our model, and the conditional probabilities used during
Markov chain sampling. Details can be found in the Appendix.

In our model, each input peptide sequence Sn, indexed by
n e {1, ...,N}, where N is the number of peptides in the dataset, has a
corresponding discrete peptide length L”, observed modiﬁcation position
xn e {1, ..., Ln} and observed modiﬁcation mass m”. We denote the amino
acid in position j of the input sequence n as Sn(i). The total number of
values Sn(j) can take on is A = 24, which includes the 20 naturally
occurring amino acids and four special characters indicating the begin-
ning and end of proteins and peptides. Additionally, we denote ok to be
the unknown number of input peptides assigned to cluster k. The hidden
variable 6,, e [1, .., oo] denotes the unknown PTM group that peptide
sequence n is assigned to. Following from the derivation of IMMs with
a Chinese Restaurant Process (Antoniak, 1974; Ferguson, 1973), its prob-
ability conditioned on all other cn’s takes into consideration the likelihood

 

 

A D (p g, Hyperparameters
I lm
pk Parameters

 

 

 

 

 

 

Pe tide . .
mass p hidden variables

Observed 6
d'f' t' '
mo l Ica Ion Correct 6 Observatlons and

 

 

 

Fig. 1. A Bayesian network describing the generative model for our new
algorithm zPTMClust, using plate notation. The shaded nodes represent
observed variables, the unshaded nodes represent hidden variables and
hyper-parameters are shown outside of the plates. The model describes
how the observed modiﬁcation mass and position are generated. The
bottom part captures the assumptions about how each observation is
generated. The plate notation indicates that there are N copies of the
model, one for each measurement. The top portion outlines the structure
of the hierarchy of priors and hyper-priors placed on the model param-
eters, mixing coefﬁcients, modiﬁcation mass means, modiﬁcation vari-
ances and probability of modiﬁed amino acid. The outer plate shows
that there is potentially an inﬁnite number of clusters, one for each pos-
sible PTM group. The probability of modiﬁed amino acid 1% is
embedded in two plates signiﬁes that there are K x A copies, one for
each K —> oo PTM groups and A possible amino acids

of the n-th input modiﬁed peptide belonging to the PTM group index is
given as

 

 

b of" if0_ ,k>o
P(Cn = kICN\m 7’: ®) 2 {  €:y othe:wise 
— y

where 0_,,, k is the number of peptides assigned to cluster k that does not
consider the n-th peptide sequence, N\n indicates all indices excluding n,
CNV, is shorthand notation for C,- : Vi e {N\n}, b is the appropriate nor-
malizing constant so the probabilities sum to one, y is the hyper-
parameter concentration parameter and 6) represents hyper-parameters
A, u, go, 5, y and (0. Furthermore, we can write the conditional posterior
probability for c” that takes into consideration the likelihood of the n-th
input modiﬁed peptide belonging to the PTM group index by cm using
parameter setting from the previous sample iteration, as follows, using D
to indicate the observed data:

P(Cn = kICN\m V, 
{b 0_n’k P(anamemmn|CmSna®)

 

N—1+y if 0—n,k>0 (2)
bN++ny(an,zn,xn,mn,0|cn,Sn, ®)8Ho(0) otherwise

where 0 represents parameters ,u, 2 and ,8, and H0 indicates the
prior distribution placed on ,u, 2 and ,8. The calculations of the condi-
tional posterior probability P(an,zn,xn,mn|cn,Sn, G) and the integral
f P(an,zn,xn,mn,0|cn,Sn, ®)8Ho(0) are given later in Equations 13
and 14, respectively. Given a vague inverse gamma prior on y,
P(y) = Ig(1,1), its conditional posterior can be derived by combining
the joint distribution of cn’s with the prior to give

P(Vlk, N) oc {Vi—3” exp[(—2y)‘1r(y)]}[r(N+ wrl (3)

We assume that the observed modiﬁcation mass for each PTM group is
normally distributed around the true modiﬁcation mass,
P(m,, |c,, = k) = Nmk, 2k), where ,uk and 2;, are the mean and variance
of the modiﬁcation mass in the k-th PTM group.

For mathematical convenience, we used the conjugate prior normal-
inverse gamma distribution with hyper-parameter mean A, variance 1),
shape (0 and scale 5‘1 for all PTM groups. Broad and vague correspond-
ing priors are given to each hyper-parameter to account for uncertainty in
their values (see Supplementary Information for details). Given the com-
bination of prior and hyper-prior distributions used, the conditional pos-
teriors for A, u, go and 5 have the following forms:

[bk/0’: + 1’2lele 1
l/of+kv ’ l/of+kv

 

P(A|,u1_k, v) = N( (4)

P(vlm_k.x)=g{k+1.[(k+1)—1(ai+ F,(uj—A)2)]} (5)

_ M k
P(¢|21_k.5) oc rg) ke-1/2r(§) ’ Relate-WA (6)
j=1

p(2121_k.¢) = g{k¢ + 1. [(k<o+ 1)‘1(a.:2 + <02; 21)]_1} (7)

where ,u* and oi are the mean and variance of the observed modiﬁcation
masses, I‘(-) is the gamma function with the form 1‘01) 2 (n — 1)! for a
positive integer n and 1 — k is shorthand for 1, ...,k.

By using conjugate priors on ,uk and 23k, both these parameters can be
integrated out to give a probability of 111,, based directly on the
hyper-parameters:

P(mnlcm A: U: (09 

= /P(mnlcn = knuk,2k)P(lLk|}»,U)P(2k|¢,$)3uk32k (8)

= t[¢, A, (O +1)(0 + 019—155]

 

823

112 ﬂJO'smumo[pJOJXO'sor1chOJurorw/2d11q IIIOJJ pepcolumoq

910K ‘09 lsnﬁnV no 22

C.Chung et al.

 

where t(-) is the Student’s t-distribution, 0k is the number of peptides

assigned to cluster k, go 2 W, A = A + 0k, 0 = v + 0],,

g = 5 + Zi:Vi,c,-=k (mi — "—7192 + W: and 57k = 0172i;v,-,c,=k mi is the
average observed modiﬁcation mass for peptides assigned to the k-th
PTM group.

Let an : n e {1, ...,N} denote the true (hidden) modiﬁed amino acid
(i.e. the amino acid that the PTM occurs on) for the n-th peptide se-
quence. Then, the probability of a,, given that the PTM group is k is
modeled as a multinomial distribution with parameters ,Bki‘v’i = 1, ..., A. A
conjugate Dirichlet distribution with hyper-parameter a) is used for ,Bki.
The hyper-parameter a) is given a vague inverse gamma distribution.
Because a conjugate prior is used on the ,Bki’s, we can integrate them
out using a standard Dirichlet integral. This leads to the conditional
posterior of a cluster assignment given all others:

0—n,ki + g

mP(menlamSn) (9)

P(an = ilcn = k: a—mzmxm Shaw) :
where P(2,,,x,,|a,,,S,,) can be factorized into P(2,,|a,,,S,,)P(x,,|s,,). Both
P(2,,|a,,, S,,) and P(x,,|s,,) are discussed below. The conditional posterior
for the hyper-parameter a) can be derived similar to Equation 3 to give

P(a)|A, N) = {wA-3/2 exp[(—2w)-1r(w)]}[r(N+ w)]_1 (10)

The details of the rest of the model are the same as those in PTMClust
given in (Chung et al., 2011). To reiterate, given the peptide sequence S,,
and true (hidden) modiﬁed amino acid a,,, we assume the distribution
over modiﬁcation position 2,, is uniform over those with matching amino
acids:

 ifS,,(j)=i,j>0
P(Zn =j|an Ziasn)=  1fj=0 (11)
0 otherwise

where 6”,- denotes the number of times amino acid 1 occurs in sequence
n and 2,, = 0 indicates that the true PTM occurs outside of the
given peptide sequence. Given the true modiﬁcation position 2,,, the prob-
ability of modiﬁcation position error (xn — 2,,) for the observed modiﬁ-
cation position x,, is modeled with a discrete probability distribution,
given as

¢(xn  if > 0
P(xn|Zn =1) = ¢(Ln) if = 0 (12)
0 otherwise

where the likelihood function ([5 accounts for the modiﬁcation position
error. This likelihood function is shared across all PTM groups and was
inferred from our empirical observation of the yeast PTM dataset as
described in (Chung et al., 2011).

Finally, we outline how the conditional posterior probability
P(a, 2, x, mlc, S, G) and the integral f P(a, 2, x, m, ,u, 2, ﬁle, S, ®)8Ho
(,u, 2, ,8) used in Equation 2 can be evaluated analytically. Based on
the structure of the Bayesian network of our model given in Figure 1,
for a given PTM group k, P(a, 2, x, mIS, G) can be derived as follows:

P(am Zn: x119 mnlcn, Sn, 
2 /P(“"’Z"’xmmm I" EaBICm Sm ®)8H—n,k(u, 2.13) (13)

= Fenian. Sn)P(Xn|Zn)[Dir(w + ok)1{r[¢. X. (a + Dé/(o + 01.)] }.

where H_,,,k is the posterior distribution of ,u, 2 and ,8 based on their
priors and all peptides that are assigned to the k-th PTM group excluding
the n-th peptide sequence, and the variables go, A, O and SA are deﬁned
before in Equation 8. It is easy to see the integral with respect to priors

f P(a,,, 2,,, x,,, mn, ,u, 2, ,8|c,,, Sn, ®)3Ho(u, 2, ,8) for unoccupied clusters is
equivalent to setting 0;, = 0 in Equation 13, which can be written as

/P(a,,,2,,, xmmn, ,u, 2, ﬁle”, Sn, ®)3Ho(,u, 2, ,8)
, (14)
= Fenian. songn Iz.)[Dir(w)1{r[¢. A“. (o + mas/0]}

By combining the structure of the Bayesian network and the condi-
tional distributions described above, we can write the joint distribution as

P(c, a, 2, x, m, ,u, 2, ,8, A, u, go, 5, y, wIS, \11)
= P(Vl‘11)P(Al\P)P(vl\P)P(¢I\P)P(SI‘P)P(wI‘1’) Hleincnly) (15)
P(mnlcm A: U: (09 S)P(anlcna w)P(Zn|ana Sm ‘11)P(xnlzna 

where II! represents the model hyper-parameters for the hyper-priors
placed on y, A, u, go, 5 and a).

2.2 Markov chain inference method

The combination of complicated interactions of hidden variables and
priors in zPTMClust leads to a complex joint distribution over
high-dimensional spaces, which is impossible to characterize analytically
in its entirety. So, we use an approximate Markov Chain Monte Carlo
(MCMC) method (Escobar and West, 1994; Neal, 2000b). MCMC meth-
ods are commonly used for IMM models. In MCMC sampling, the
model posterior distribution can be sampled to collect instances of par-
ameter and variable settings likely under the model. Given a large enough
collection of samples, the posterior can be approximated, and the ideal
settings of model parameters and hidden variables can be inferred.

Although the Gibbs sampling algorithm is a commonly used MCMC
sampling method for non-parametric Bayesian clustering models such as
ours, it can mix poorly and produce poor results when the input dataset is
large and complex (Jain and Neal, 2000). Hence, in addition to the Gibbs
sampling method, we derived and implemented the restricted Gibbs sam-
pling split-merge algorithm (or the split-merge sampling algorithm for
short) (Jain and Neal, 2000) for zPTMClust. The split-merge sampling
algorithm is designed to mitigate the aforementioned issues with the
Gibbs sampling method. We adhered to the recommended settings for
running this sampling algorithm given in (Jain and Neal, 2000).

Both of the methods with and without split-merge steps require Gibbs
sampling updates. For each Gibbs sampling step, we use the following
procedure. First, we sample the set of hidden variables (parameters are
considered as hidden variables) associated with input peptide n, where
n e {1, ...,N}. Starting with the n-th input observation, for each repre-
sented (occupied) cluster Kwp, we draw a,, according to Equation 9 and 2,,
using Equation 11. Next, we sample a new cluster assignment c,, from
Equation 2. Finally, we update the sufﬁcient statistics associated with
assignments for c,, and a,,. We repeat this procedure for each input pep-
tide sequence. At the end of each Gibbs sampling step, we obtain a new
value for each hyper-parameter, with the exception for y, a) and go, dir-
ectly by sampling from their conditional posterior distribution given in
Equations 4, 5 and 6, which are all distributions of standard form.
Although they are not standard distributions, the conditional posteriors
for y, a) and go are all log-concave, which implies that they are unimodal
in the logarithmic domain and have a single global optimum. The
log-posteriors of y, a) and S are given as

In P(y|k, N) = C + (k —  ln(y) — 2—1yln I‘(y) — ln F(N+ y) (16)

In P(a)|A, N) = C + (k —  ln(a)) — iln F(a)) — ln F(N+ (0) (17)

1nP(<0l21,  2kg) = C— kln Fan/2) — ago—1+

(18)
(kw — 3/2) Inga/2) + 2:: (go/2mm 2. + ln s) — (gong/2)

 

824

112 ﬂJO'smumo[pJOJXO'sor1chOJurorw/2d11q IIIOJJ pepcolumoq

910K ‘09 lsnﬁnV no 22

iPTMClust: Non-parametric Bayesian PTM refinement algorithm

 

where C is a normalizing constant. Given the equations for the
log-posteriors and their log-concave property, a new value for each
hyper-parameter can be efﬁciently sampled using the efﬁcient, easily im-
plemented slice sampling method (Neal, 2000a).

The MCMC sequence is guaranteed to converge to the exact posterior,
eventually. However, in practice, it is common to terminate the sampling
procedure after a ﬁxed number of iterations, based on an analysis of how
well the chain has mixed according to trace plots of the distribution of
posterior probabilities and the number of clusters over time.
Furthermore, samples from a burn-in period at the beginning of the
chain, before mixing has occurred, are discarded. Again, this is deter-
mined using trace plots. We found that 1000 bum-in samples and a
total of 15000 samples are enough to produce a good approximation
of the posterior for the large-scale PTM datasets we studied, including
the phosphopeptides, yeast proteome and human protein—protein inter-
action datasets described below. Details of this analysis, including trace
plots, are given in Supplementary Information. For simpler datasets, such
as the synthetic and phosphorylation datasets, a setting of 100 bum-ins
and 6000 total samples was sufﬁcient. A detailed analysis is provided in
Supplementary Information. Lastly, to counter auto-correlations
amongst the samples, we only use results taken from every ﬁfth sample.

2.3 Background model

Unlike PTMClust, the background model for zPTMClust does not expli-
citly encompass a predeﬁned background component. Instead, it uses a
background model consisting of multiple background components
learned directly from the input data. Based on the modiﬁcation mass
variance calculated for each PTM group, we deﬁne a background com-
ponent to be a PTM group with a variance 2 2.0. This threshold is
chosen based on the assumption that valid PTM groups should have
well-deﬁned modiﬁcation masses, and thus have low variance. By allow-
ing for multiple background components instead of one, we observe em-
pirically that the new model is better at capturing spurious data.

3 RESULTS

Our ﬁrst goal is to demonstrate that zPTMClust outperforms
existing algorithms both in terms of ﬁnding correct clustering
assignments and in reﬁning PTMs on a set of noisy modiﬁed
peptide sequences. To this end, we conducted two experiments.
We benchmarked zPTMClust against standard clustering algo-
rithms, k—means and MOG, as well as our previous algorithm
PTMClust. The key observation, given in Supplementary Figure
S1, is that zPTMClust using the split-merge algorithm attains the
most consistent results across different settings and achieves in-
creasingly better results than PTMClust as the problem becomes
more complex. Given that the true modiﬁcation positions are
known for simulated data, we can evaluate how well
PTMClust and implementations of our new algorithm perform
for the task of PTM reﬁnement. Supplementary Figure S2 shows
the same trend as above: zPTMClust with the split-merge algo-
rithm outperforms the others in almost all cases. We also com-
pared blind PTM search engines SIMS (Liu et al., 2008), InsPecT
(Tanner et al., 2005) and MODmap (Na and Pack, 2009), a
state-of—the-art PTM reﬁnement algorithm PTMFinder and
our algorithms PTMClust and zPTMClust on detecting the
true modiﬁcation positions from a well-studied phosphopeptide
dataset. In each of the experiments, we use both the split-merge
and the Gibbs sampling inference algorithms for zPTMClust. We
report results based on MAP estimation for zPTMClust for both
experiments.

The second goal is to directly show the applicability of
zPTMClust to datasets taken from studies of complex protein
solutions. To achieve this goal, we analyze data taken from a
genome-wide yeast and a human chromatin-speciﬁc protein com-
plex study. We have limited our analyses to only post-processing
PTM predictions generated from SIMS with either PTMClust or
zPTMClust. We include analysis from PTMClust to highlight
that zPTMClust is producing sensible results.

In these experiments, we initialize k—means, MOG and
PTMClust with settings that are outlined in (Chung et al.,
2011). The settings for the number of burn-in and total samples
for zPTMClust are described in the Supplementary Information.

3.1 Benchmarking against phosphopeptide predictions

We compare zPTMClust against current PTM search engines
and PTM reﬁnement algorithms using a real-world dataset en-
riched for phosphopeptides containing modiﬁcation sites that are
validated (Beausoleil et al., 2004). We will refer to the identities
of the known peptide sequences and their modiﬁcation sites as
the reference. The dataset consists of 1655 spectra, but we will
focus exclusively on the 1340 spectra mapped and curated as
singly modiﬁed phosphopeptides (SIMS, InsPecT, PTMClust
and zPTMClust are limited to one modiﬁcation per peptide se-
quence). In this analysis, we deﬁne positives (P) as outputs from
the base blind PTM search engine that match to the reference
considering only their peptide sequence, i.e. disregarding the pos-
itions of their modiﬁcation, and negatives (N) as all other out-
puts that do not match their corresponding reference peptide
sequences. Each blind PTM search engine produces a different
number of P and N. For SIMS, PTMClust and zPTMClust
(SIMS was used as the base blind PTM search engine), there
are 895P and 445 N. Lastly, for PTMFinder, which uses
InsPecT as its base unrestricted PTM search engine, there are
860P and 480 N.

For zPTMClust, in addition to the MAP estimate, we con-
sidered inference by averaging over samples to produce a conﬁ-
dence score per modiﬁcation position for each output peptide
sequence. By varying the conﬁdence threshold setting, we can
adjust the sensitivity and speciﬁcity of the PTM predictions.
For zPTMClust results evaluated using conﬁdence scores, we
deﬁne a PTM prediction as a peptide sequence and its modiﬁca-
tion positions with conﬁdence scores above the threshold; pep-
tide sequences that do not have at least one modiﬁcation position
with a conﬁdence score above the threshold are considered to be
assigned to the background model. For PTMClust and
zPTMClust using MAP estimate, a prediction is any peptide se-
quence not assigned to the background model. All peptide se-
quences assigned to the background model are removed from the
evaluation. Lastly, we consider all outputs as predictions for the
other algorithms because they do not use a background model.

Given the true phosphorylation of each peptide are known, we
plot the number of correct phosphorylation sites versus the num-
ber of incorrect phosphorylation sites identiﬁed in Figure 2A for
the results of zPTMClust, PTMClust, PTMFinder and InsPecT.
For this experiment, the blind PTM search engine InsPecT was
used to analyze the input spectra, then each of the PTM reﬁne-
ment algorithms, zPTMClust, PTMClust and PTMFinder, were
used to post-process the PTM predictions output from InsPecT.

 

825

112 ﬂJO'slcumo[pJOJXO'sor1chOJurorw/2d11q IIIOJJ pepcolumoq

910K ‘09 lsnﬁnV no 22

C.Chung et al.

 

d

(D
o
o

 
    
  
 

   

+ iPTMClust - Split-merge J
I iPTMClust-Split-merge (MAP) t 30°
—~— iPTMClust - Gibbs o
Q iPTMClust-Gibbs (MAP) ._ 200
+ PTMClust Cf I c iPTMClust-Gibbs (MAP)

E 10 + PTMClust

orrect Phos. Sites Identier

  

A SIMS

 

       

560 100 200 300 400 500
Num. of False Phos. Sites Identified

111131". of Fa1§2°phos. éiies Identified
Fig. 2. The ﬁgure is a plot of the number of correct phosphorylation sites
identiﬁed versus the number of false phosphorylation sites identiﬁed for
zPTMClust and state-of—the—art PTM reﬁnement and prediction algo-
rithms a phosphopeptide dataset with known modiﬁcation sites.
(A) Compares zPTMClust against PTMClust, InsPecT and
PTMFinder. The PTM predictions output from InsPecT are used as
the baseline and post-processed by zPTMClust, PTMClust and
PTMFinder. (B) Compares zPTMClust against PTMClust and SIMS
with output from SIMS are used as the baseline. The curves for
zPTMClust using the split-merge and the Gibbs sampling algorithm are
produced by calculating a conﬁdence score per modiﬁcation position
through inference by averaging over samples and varying the conﬁdence
score threshold [0,1]. These methods for evaluating the result outperform
their counterparts using MAP estimation. More importantly, zPTMClust
using any one of the inference methods achieves better results than
InsPecT, SIMS, PTMClust and PTMFinder

For zPTMClust, we included results for both the split-merge and
Gibbs sampling methods using either MAP estimation or infer-
ence by averaging over samples. We varied the conﬁdence thresh-
old to obtain a series of results for zPTMClust using inference by
averaging over samples. Four key observations can be made
from the result: (i) zPTMClust outperforms all other algorithms,
including PTMClust and PTMFinder; (ii) zPTMClust with infer-
ence by averaging over samples produces better results than its
MAP estimate counterpart; (iii) a background model is essential
for collecting spurious modiﬁcations; and (iv) zPTMClust with
the split-merge inference algorithm performs similarly to
zPTMClust with the Gibbs sampling algorithm except at the
region with low number of incorrect phosphorylation sites iden-
tiﬁed, where the Gibbs sampling method is performing margin-
ally better than its counterpart. The ﬁrst observation reinforces
our conclusion from the study on synthetic data that zPTMClust
outperforms other PTM reﬁnement algorithms. The second
highlights the advantage of providing a conﬁdence score per
modiﬁcation position, where adjusting for the conﬁdence thresh-
old allows us to achieve improved results over MAP estimation.
Finally, the results highlight a major beneﬁt of zPTMClust
beyond PTM reﬁnement, i.e. removal of noisy data.

Next, we conducted the same experiment by post-processing
the output from SIMS with PTMClust and zPTMClust to ensure
that our algorithms are not biased towards any one particular
blind PTM search engine. Similarly, we plot the number of cor-
rect phosphorylation sites versus the number of incorrect phos-
phorylation sites identiﬁed in Figure 2B for the results of
zPTMClust, PTMClust and SIMS. Because PTMFinder is tightly
integrated into the InsPecT algorithm, we were not able to de-
couple PTMFinder from InsPecT to post-process the output
from SIMS. Therefore, PTMFinder is omitted from this analysis.
The results based on the PTM predictions generated by
both SIMS and InsPecT (discussed above) show the same three
trends: (i) zPTMClust outperforms all other algorithms;

(ii) zPTMClust with inference by averaging over samples pro-
duces better results than its MAP estimate counterpart; and
(iii) a background model is essential for collecting spurious modi-
ﬁcations. Speciﬁc to this experiment based on the output from
SIMS, we observe that zPTMClust with the split-merge inference
algorithm markedly performs better than zPTMClust with the
Gibbs sampling in two conditions: when MAP estimate is used
and at the region between 30 and 145 number of false phosphor-
ylation sites identiﬁed when using inference by averaging over
samples. The full list of resulting PTM predictions by SIMS and
then post-processed with PTMClust and zPTMClust (one tech-
nical replicate) is given in Supplementary Table S2. The result
shows in addition to being able to correctly reﬁne PTM predic-
tions, zPTMClust can detect noisy data and rightfully assign
them to the background model.

Given enough sampling iterations, zPTMClust is able to pro-
duce remarkably consistent results. Of the correctly identiﬁed
phosphopeptides by zPTMClust, ~ 98% of them are found by
all ﬁve technical replications. This is true for either sampling
methods. Minor differences are expected and are due to the sto-
chastic nature of the inference methods used in zPTMClust.
Furthermore, trace plots of log joint probability distributions
and numbers of non-background PTM groups identiﬁed,
shown in Supplementary Figure S3, illustrate that zPTMClust
using both the split-merge and the Gibbs sampling methods
mixes well after 1000 burn-in iterations, and 15000 iterations
are enough to estimate the posterior. Both the trace plots and
level of consistency suggest that zPTMClust in each run have
converged to a high posterior likelihood solution.

The computational time for zPTMClust is heavily dependent
of the number of samples collected during inference, which were
15 000 iterations for this experiment. Keeping in mind that an
MS/MS experiment takes hours, and in the case of a shotgun
proteomics (Cantin and Yates, 2004) 12h, the time it took
zPTMClust to analyze the phosphopeptide dataset (on average
~50 mins for Gibbs sampling and ~70 mins for Spit-merge
sampling) is a reasonable investment for higher-quality PTM
predictions. As compared with other tested algorithms,
zPTMClust took a longer time than InsPect (~2.5 mins) and
PTMFinder (~4 mins), and on par with SIMS (~55 mins) and
PTMClust (~70 mins). All the algorithms, single process appli-
cations, were run on a computer with Intel Xeon 3.0 GHz CPUs
and 32 GB of RAM. zPTMClust makes a trade-off with longer
computational time for superior quality PTM predictions.

3.2 Large-scale PTM analysis of yeast proteome

Through a series of benchmark experiments, we have shown that
zPTMClust beats state-of—the-art algorithms, including our own
PTMClust. Furthermore, we demonstrate that zPTMClust using
the split-merge sampling method produces improved results over
the one using the Gibbs sampling method. Next, we will test
zPTMClust’s versatility in detecting diverse PTM groups by
applying it to analyze a large-scale PTM dataset taken from
analyses of the yeast proteome (liquid chromatography
(LC)-MS/MS spectra only) (Krogan et al., 2006) using SIMS.
Brieﬂy, the yeast dataset consists of more than 2 million ion trap
MS/MS spectra of which 19560 putatively modiﬁed peptides
were identiﬁed by SIMS with modiﬁcation range (0, 200) Da.

 

826

112 [glO'SIBILInO[plOJXO'SODBIIIJOJIIIOIQ/[i(11111 111011 pepcolumoq

910K ‘09 lsnﬁnV no 22

iPTMClust: Non-parametric Bayesian PTM refinement algorithm

 

The estimated false discovery rate for the predictions made by
SIMS is 4.3% based on the number of decoy peptides identiﬁed.
Here, we present the result taken from our post-analysis using
zPTMClust with the split-merge algorithm (MAP estimate was
used). MAP estimate is used to simplify the analysis and the
mapping to known PTMs. The speciﬁc setting used for
PTMClust is described in (Chung et al., 2011).

The known set of modiﬁcations was taken from Uniprot
(Release 2010_11). We matched the sets of modiﬁed peptides
produced by SIMS and post-processed with zPTMClust with
the split-merge algorithm, zPTMClust with the Gibbs sampling
algorithm and PTMClust to the set of known yeast modiﬁcation
sites. This table shows the number of peptides and unique sites
that are mapped to known PTMs. The results show zPTMClust
is able to improve on SIMS and signiﬁcantly outperform
PTMClust in a complex dataset.

A summary of commonly known PTMs taken from the
Uniprot knowledgebase (Release 2010_11) that are found in
our dataset is shown in Table 1. Overall, zPTMClust using
either the split-merge or the Gibbs sampling method is able to
reposition a large portion of modiﬁcations to known PTM sites
that were missed by SIMS originally (increase of ~ 49% unique
PTMs and ~ 34% modiﬁed peptides for split-merge, and ~ 55%
and ~ 43% for Gibbs). This represents a signiﬁcant increase over
what can be achieved using PTMClust. The most improvement is
gained with phosphorylation sites, where post-analysis with
zPTMClust is able to identify >65% more (known) unique
sites and almost double the number of instances of phosphopep-
tide when compared with the result obtained from SIMS.
However, zPTMClust using the split-merge method incorrectly
places a number of peptides with acetylation and other modiﬁ-
cations in the background model that SIMS correctly identiﬁed.
We note that zPTMClust using the Gibbs sampling method and
PTMClust did not make this mistake. A closer look reveals that
many of these instances belong to a few unique peptide se-
quences. The analysis on the yeast proteome dataset conﬁrms
that zPTMClust can detect other PTMs such as acetylation and
cysteine oxidation (cysteine sulﬁnic acid) in addition to phos-
phorylation. Moreover, the results reiterate that zPTMClust
using either the split-merge or the Gibbs sampling method can
reﬁne a greater number of PTMs than PTMClust.

3.3 Analysis of human protein—protein interaction data

Protein complexes and protein—protein interactions studies are a
major focal point in the ﬁeld of proteomics. However, to date,

the focus has been mainly on ﬁnding complex memberships and
interaction partners. Because it is well established that PTMs,
such as phosphorylation and acetylation, play a vital role in
the formation and regulation of protein—protein interactions,
we seek to complement these studies with an emphasis on the
identiﬁcation of PTMs.

The dataset we used consists of high mass-resolution MS/MS
spectra (Orbitrap mass spectrometer) from a human protein—
protein interaction study searched using SIMS. The study is a
collaboration with the Emili lab at the University of Toronto,
and the dataset is not yet published at the time of writing. The
experimental protocol used is tandem afﬁnity puriﬁcation (Puig
et al., 2001; Rigaut et al., 1999) followed by MS approach.
Brieﬂy, the method proceeds by placing a biological tag on all
instances of a member of the complex of interest. Next, these
tagged proteins are isolated and puriﬁed along with their inter-
acting proteins, and ﬁnally, the set of puriﬁed proteins are sub-
jected to MS analyses.

Here, we chose to focus on three well-studied protein com-
plexes, the Mediator (MED), the RNA Polymerase II (POL2)
and the Polycomb Repressive Complex 1 (PRC1). This dataset
consists of 17 experiments. These experiments include technical
replicates, covering 6 of 12 proteins known to be in the MED
complex, two experiments covering 2 of the 32 members of the
POL2 complex and three experiments covering 2 of 12 members
of the PRC1 complex. There is a total of 13 221 spectra mapped
to modiﬁed peptides by SIMS (estimated false discovery rate of
13.5% based on the number of decoy peptides identiﬁed) with a
modiﬁcation range (0, 300) Da.

Supplementary Table S1 highlights the 48 distinct peptide se-
quences putatively identiﬁed to be modiﬁed either with acetyl-
ation or phosphorylation. Including duplicates, 114 modiﬁed
peptides were found. Of the 48 unique peptides, 9 had at least
one instance with their modiﬁcation site corrected by zPTMClust
using the split-merge sampling algorithm that was originally mis-
placed by SIMS. These are highlighted in bold. We speculate this
smaller number improvement is due to two major reasons: (i) a
majority of the listed PTMs are acetylation, which SIMS does a
good job with, as seen in the yeast study above, and (ii) spectra
are cleaner owing to the use of a high-resolution mass spectrom-
eter. In this list, there are 15 putative novel modiﬁcation sites and
33 known ones according to the Uniprot knowledgebase
(Release 2011_12). Although the complete list is not shown,
after removing those assigned to the background model, we
have identiﬁed 10409 putative modiﬁed peptides such that a

Table 1. Summary of peptides with known PTM sites in the yeast proteome dataset

 

 

 

PTM Peptides with known PTM sites (number of unique sites)

i PTMClust split-merge i PTMClust Gibbs PTMClust SIMS
Phosphorylation 196 (103) 185 (101) 115 (66) 100 (61)
Acetylation 59 (5) 78 (9) 75 (9) 72 (8)
Cysteine oxidation (cysteine sulﬁnic acid) 7 (2) 6 (1) 7 (1) 6 (1)
Others 24 (2) 35 (5) 35 (5) 35 (5)
Total 286 (112) 304 (116) 232 (81) 213 (75)

 

 

827

112 /810's112umo[pJOJXO'sor112u1101urorq/ﬁd11q 111011 pepcolumoq

910K ‘09 lsnﬁnV no 22

C.Chung et al.

 

large portion of them is mapped to regions in their respective
proteins that do not contain known PTMs. Similar to those listed
putative, novel phosphorylated and acetylated peptides, we be-
lieve this list also contains many high-quality new PTM discov-
eries. Hence, this list represents a ﬁltered list of high-quality
candidates for further investigation. We have shown a PTM pre-
diction pipeline comprises a blind PTM search engine, and
zPTMClust can be fruitful in novel discoveries and should be
used routinely.

The use of a high mass-resolution mass spectrometer is ex-
pected to reduce errors and potentially remove the need for re-
ﬁnement of measured modiﬁcation masses. Even so, we noticed
many instances where the observed modiﬁcation mass deviates
from our reﬁned modiﬁcation mass by ~1 Da. This modiﬁcation
mass error is believed to be due to the presence of isotopes.
Although heuristics can be used to account for these mass
shifts, such methods can be error-prone and cannot adapt to
unforeseen mass errors. Our results show that zPTMClust can
handle such errors and improve the quality of PTM predictions
taken from an analysis of a high mass-resolution mass
spectrometer.

4 CONCLUSION

Accurately identifying PTMs and their potential roles in clinical
studies such as biomarker discovery and drug development is an
important task. Although thousands of PTM candidates have
been reported using blind PTM search engines (Liu et al.,
2006, 2008; Han et al., 2005; Searle et al., 2006; Tanner et al.,
2005; Tsur et al., 2005), these blind PTM search algorithms suffer
from mass measurement inaccuracy and uncertainty in predict-
ing modiﬁcation positions, making the ﬁndings error prone. The
importance of post-processing PTM predictions using a PTM
reﬁnement algorithm have been established in (Chung et al.,
2011; Tanner et al., 2008). The previous state-of—the-art algo-
rithm, PTMClust, achieves a signiﬁcantly higher PTM prediction
accuracy over blind PTM search engines alone and outperforms
existing PTM reﬁnement algorithm, PTMFinder. Despite signiﬁ-
cant improvements in PTM prediction, PTMClust has three
main drawbacks of particular interest: (i) it uses of a greedy-
based non-automatic model selection algorithm, (ii) it requires
manual parameterization on the maximum number of PTM
groups and (iii) it does not provide a conﬁdence score per modi-
ﬁcation position.

To address these issues, we introduce zPTMClust. zPTMClust
extends PTMClust by using an inﬁnite mixture model approach
that achieves the following three beneﬁts: (i) outperforming
PTMClust and other PTM reﬁnement algorithms, (ii) providing
a fully automated model selection method without the need for
any manual parameterization, and (iii) offering modiﬁcation pos-
ition level conﬁdence scores that users can use to assess the qual-
ity of the results and to greater reﬁne their analyses. Through a
series of benchmark experiments using both synthetic and real
(phosphopeptides and yeast proteome) data, we demonstrated
that zPTMClust better models the PTM generative process and
outperforms PTMClust, PTMFinder and other blind PTM
search engines. In addition, we analyzed data generated from a
yeast proteome study using zPTMClust in which we reported an
improvement over the base blind PTM search algorithm SIMS in

detecting annotated PTMs. Thousands of putative PTMs were
found in this analysis. Moreover, in our in—depth look at PTM
predictions for three human protein complexes, MED, POL2
and PRC1, zPTMClust identiﬁed numerous validated and puta-
tive phosphorylated and acetylated peptides that may be
involved in the formation and regulation of protein—protein
interactions. Further investigations are warranted, but we believe
a number of these putative predictions are valid PTMs and can
serve to further our understanding of the complexities involved
in protein—protein interactions. To summarize, our new algo-
rithm zPTMClust is easy to use, achieves overall greater perform-
ance than the state-of—the-art, provides conﬁdence scores at the
modiﬁcation position level that allow for a higher ﬂexibility
when evaluating potential PTMs and is designed to be broadly
applicable to PTM predictions generated from any blind PTM
search engine.

Given the rapid advancement of mass spectrometer technol-
ogy, how applicable is zPTMClust going forward? We explore
this question by analyzing data generated from high mass-
resolution mass spectrometers, e. g. from an Orbitrap. Although
mass accuracy has improved with the use of high mass-resolution
mass spectrometers, the presence of isotopes, for example, can
result in deviations in observed modiﬁcation masses. In addition,
higher mass accuracy does not necessarily equate to errorless
modiﬁcation site determination. We have shown in our analysis
of the human protein complex data that problems with mass
measurement inaccuracy and uncertainty predicting modiﬁcation
positions continue to exist for data generated from high
mass-resolution mass spectrometers, such as an Orbitrap used
in the experiment. Our results demonstrate that zPTMClust can
improve on PTM predictions taken from data with high mass
accuracy, and continue to be a vital component of a
genome-wide PTM study.

In designing zPTMClust, we have developed two different in-
ference algorithms, the split-merge Metropolis-Hastings and the
Gibbs sampling algorithm. While the Gibbs sampling method is
the standard inference algorithm for Bayesian mixture models
and IMMs, the split-merge method is shown to perform better
when dealing with complex datasets (Jain and Neal, 2000).
Results of our synthetic data experiments also exhibit this
trend. zPTMClust using the Gibbs sampling method displays a
performance drop, while its counterpart using the split-merge
sampling algorithm perform consistently well as the data used
gets more complex. It is important to note that when there are
few PTMs within a small modiﬁcation mass window, say 1—2 Da
(e.g. when two or three PTM groups added in our experiment
with the synthetic data), our algorithm using the Gibbs sampling
performs at par with or slightly worse than its counterpart using
the split-merge method. Furthermore, zPTMClust using the
Gibbs sampling runs faster per iteration (~ 50% quicker) than
zPTMClust using the split-merge method. Hence, for large data-
sets, where running time can be overwhelmingly long, we recom-
mend running zPTMClust with the Gibbs sampling method as it
provides a good trade-off between quality of the result and com-
putational cost.

Despite outperforming its competitors, zPTMClust has a
number of limitations. Similar to PTMClust, it is unable to
handle more than one modiﬁcation per input peptide sequence,
and PTM groups identiﬁed can contain multiple PTMs if their

 

828

112 /810's112umo[pJOJXO'sor112u1101urorq/ﬁd11q 111011 pepcolumoq

910K ‘09 lsnﬁnV no 22

iPTMClust: Non-parametric Bayesian PTM refinement algorithm

 

modiﬁcation masses are similar. The latter problem is less of an
issue when working with high mass-resolution data. Moreover,
zPTMClust does not consider the underlying spectrum when
reﬁning a PTM prediction. The presence of certain peaks in
the spectrum can add to support to a residue along the peptide
sequence as being the modiﬁcation position. Its limitations not-
withstanding, zPTMClust is shown to outperform both
PTMClust and previous state-of—the-art in our benchmark tests
using both synthetic and real-world PTM data.

ACKNOWLEDGEMENTS

We thank Jonathan Olsen, J ian Liu, Yoseph Barash and Leo Lee
for valuable conversations and Vincent F ong for his help with
collecting the experimental data and generating the SIMS and
InsPecT results.

Funding: This research was supported in parts by funds from a
John C Polanyi Award (to B.J.F.); an Operating Grant from the
Canadian Institutes of Health Research (to B.J.F.); and an
Ontario Ministry of Research and Innovation grant (to A.E.).

Conflict of Interest: none declared.

REFERENCES

Agilent (2005) Spectrum mill. http://www.chem.agilent.com/en-US/Products-
Services/Software-Inforrnatics/Spectrum-Mill/pages/default.aspx.

Albuquerque,C.P. et al. (2008) A multidimensional chromatography technology for
in-depth phosphoproteome analysis. Mol. Cell Proteomics, 7, 1389—1396.

Antoniak,C.E. (1974) Mixtures of Dirichlet processes with applications to Bayesian
nonparametric problems. Ann. Stat., 2, 1152—1174.

Bailey,C.M. et al. (2009) SLoMo: automated site localization of modiﬁcations from
ETD/ECD mass spectra. J. Proteome Res., 8, 1965—1971.

Baker,P.R. et al. (2011) Modiﬁcation site localization scoring integrated into a
search engine. Mol. Cell Proteomics, 10, M111.008078.

Beausoleil,S. et al. (2004) Large-scale characterization of hela cell nuclear phospho-
proteins. Proc. Natl Acad. Sci. USA, 101, 12130—12135.

Beausoleil,S.A. et al. (2006) A probability-based approach for high-throughput pro-
tein phosphorylation analysis and site localization. Nat. Biotechnol, 24,
1285—1292.

Bishop,C.M. (2006) Pattern Recognition and Machine Learning. Springer,
NY, USA.

Cantin,G.T. and Yates,J.R. (2004) Strategies for shotgun identification of
post-translational modiﬁcations by mass spectrometry. J. Chromatogr., 1053,
7—14.

Chalkley,R.J. and Clauser,K.R. (2012) Modiﬁcation site localization scoring: stra-
tegies and performance. Mol. Cell Proteomics, 11, 3—14.

Chung,C. et al. (2011) Computational refinement of post-translational modiﬁca-
tions predicted from tandem mass spectrometry. Bioinformatics, 27, 797—806.

Domon,B. and Aebersold,R. (2006) Mass spectrometry and protein analysis.
Science, 312, 212—217.

Escobar,M.D. and West,M. (1994) Bayesian density estimation and inference using
mixtures. J. Am. Stat. Assoc., 90, 577—588.

Ferguson,T.S. (1973) A Bayesian analysis of some nonparametric problems. Ann.
Stat., 1, 209—230.

Geman,S. and Geman,D. (1984) Stochastic relaxation, Gibbs distributions, and the
Bayesian restoration of images. IEEE Trans. Pattern Anal. Mach. Intel,
PAMI-6, 721—741.

Han,Y. et al. (2005) Spider: software for protein identiﬁcation from sequence tags
with de novo sequencing error. J. Bioinform. Comput. Biol, 3, 697—716.

J ain,S. and Neal,R. (2000) A split-merge Markov chain Monte Carlo procedure for
the Dirichlet process mixture model. J. Comput. Graph. Stat., 13, 158—182.
Keller,A. et al. (2002) Empirical statistical model to estimate the accuracy of peptide
identiﬁcations made by MS/MS and database search. Anal. Chem., 74,

5383—5392.

Krogan,N. et al. (2006) Global landscape of protein complexes in the yeast
Saccharomyces cerevisiae. Nature, 440, 637—643.

Lehninger,A.L. et al. (1993) Principles of Biochemistry, 2nd edn. Worth Publishing,
New York, NY.

Liu,C. et al. (2006) Peptide sequence tag-based blind identification of
post-translational modiﬁcations with point process model. Bioninformatics, 22,
e307—e313.

Liu,J. et al. (2008) Sequential interval motif search: unrestricted database searching
of global MS/MS datasets for unexpected post-translational modiﬁcations.
Anal. Chem., 80, 7846—7854.

Mikesh,L.M. et al. (2006) The utility of ETD mass spectrometry in proteomic
analysis. Biochim. Biophys. Acta., 1764, 1811—1822.

Na,S. and Paek,E. (2009) Prediction of novel modiﬁcations by unrestrictive search
of tandem mass spectra. J. Proteome Res., 8, 4418—4427.

Neal,R. (2000a) Slice sampling. Ann. Stat., 31, 705—767.

Neal,R.M. (2000b) Markov chain sampling methods for Dirichlet process mixture
models. J. Comput. Graph. Stat., 9, 249—265.

Olsen,J.V. et al. (2006) Global, in vivo, and site-speciﬁc phosphorylation dynamics
in signaling network. Cell, 127, 635—648.

Phanstiel,D.H. et al. (2011) Proteomic and phosphoproteomic comparison of
human ES and iPS cells. Mol. Cell Proteomics, 8, 821—827.

Puig,0. et al. (2001) The tandem afﬁnity puriﬁcation (tap) method: a general pro-
cedure of protein complex puriﬁcation. Methods, 24, 218—229.

Ramakrishnan,S. et al. (2009a) Mining gene functional networks to improve
mass-spectrometry based protein identiﬁcation. Bioinformatics, 25, 2955—2961.

Ramakrishnan,S.R. et al. (2009b) Integrating shotgun proteomics and mRNA ex-
pression data to improve protein identiﬁcation. Bioinformatics, 25, 1397—1403.

Rasmussen,C.E. (2000) The inﬁnite Gaussian mixture model. In: Solla,S.A.,
Leen,T.K. and Miiller,K.-R. (eds.) Advances in Neural Information Processing
Systems 12. MIT Press, Cambridge, MA, USA, pp. 554—560.

Rigaut,G. et al. (1999) A generic protein puriﬁcation method for protein complex
characterization and proteome exploration. Nat. Biotechnol, 17, 1030—1032.
Savitski,M.M. et al. (2011) Conﬁdent phosphorylation site localization using the

mascot delta score. Mol. Cell Proteomics, 10, M110.003830.

Searle,B. et al. (2006) Identiﬁcation of protein modiﬁcations using MS/MS de novo
sequencing and the opensea alignment algorithm. J. Proteome Res., 4, 546—554.

Tanner,S. et al. (2005) Inspect: identiﬁcation of posttranslationally modiﬁed pep-
tides from tandem mass spectra. Anal. Chem., 77, 4626—4639.

Tanner,S. et al. (2008) Accurate annotation of peptide modiﬁcations through
unrestrictive database search. J. Proteome Res., 7, 170—181.

Taus,T. et al. (2011) Universal and conﬁdent phosphorylation site localization using
phosphors. J. Proteome Res., 10, 5354—5362.

Tsur,D. et al. (2005) Identiﬁcation of post-translational modiﬁcations by blind
search of mass spectra. Nat. Biotechnol., 23, 1562—1567.

 

829

112 /810's112umo[pJOJXO'sor112u1101urorq/ﬁd11q 111011 pepcolumoq

910K ‘09 lsnﬁnV no 22

