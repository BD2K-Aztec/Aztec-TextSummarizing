Bioinformatics, 32(14), 2016, 2096—2102

doi: 10.1093/bioinformatics/btw212

Advance Access Publication Date: 22 April 2016
Original Paper

 

 

Genome analysis

Estimating IBD tracts from low coverage

NGS data

Filipe G. Vieira1'*, Anders Albrechtsen2 and Rasmus Nielsenz'3

1Centre for GeoGenetics, Natural History Museum of Denmark and 2Department of Biology, University of
Copenhagen, Copenhagen, Denmark and 3Department of Integrative Biology, University of California,

Berkeley, USA

*To whom correspondence should be addressed.
Associate Editor: lnanc Birol

Received on November 23, 2015; revised on March 25, 2016; accepted on April 12, 2016

Abstract

Motivation: The amount of IBD in an individual depends on the relatedness of the individual’s par-
ents. However, it can also provide information regarding mating system, past history and effective
size of the population from which the individual has been sampled.

Results: Here, we present a new method for estimating inbreeding IBD tracts from low coverage
NGS data. Contrary to other methods that use genotype data, the one presented here uses geno-
type likelihoods to take the uncertainty of the data into account. We benchmark it under a wide
range of biologically relevant conditions and show that the new method provides a marked in-

crease in accuracy even at low coverage.

Availability and implementation: The methods presented in this work were implemented in
C/C ++ and are freely available for non-commercial use from https://github.com/fgvieira/ngsF-HMM.

Contact: fgvieira@snm.ku.dk

Supplementary information: Supplementary data are available at Bioinformatics online.

 

1 Introduction

The inference of inbreeding levels is of central importance in many
studies of ecology, evolution and conservation biology. Inbred indi-
viduals often have lower fitness than offspring of unrelated parents
(Ebert et al., 2002) and a cumulative effect can reduce the popula-
tion growth rate and probability of persistence (O’Grady et al.,
2006). Furthermore, the study of inbreeding levels on natural popu-
lations can shed light into the species’ mating system and past his-
tory (Gibson et al., 2006; Stevens et al., 2012; Vieira et al., 2013)
and is important for understanding the distribution of genetic vari-
ation within and among populations and, consequently, the effect of
natural selection (Charlesworth, 2003).

In addition to the genome-wide inbreeding coefficient of an indi-
vidual, further information can be gained by examining the distribu-
tion of inbred (or Identity By Descent; IBD) regions throughout the
genome. These regions are usually organized into tracts of homozy-
gous genotypes that recombination breaks down over time. Their
number and lengths are tightly coupled to population genetics proc-
esses, from fine-scale population structure, effective population size,

selfing and recombination rate, to age and type of inbreeding and
even relatedness of the parents (Gibson et al., 2006). Brieﬂy, short
tracts reﬂect old inbreeding in the population (possibly due to large
effective population sizes), while long tracts may reﬂect recent in-
breeding either due to small effective population sizes or familial
matings. Under certain conditions and carefully designed experi-
ments, the identification of IBD tracts can even be used for other
types of analyses, like mapping of recombination breakpoints from
back-crossed individuals.

As common descent is always guaranteed for any pair of hom-
ologous loci, IBD is often defined relative to an expectation under a
certain model. An example is IBD due to recent familial relation-
ships relative to the expectation of genetic identity for two individ-
uals sampled at random from the population. A common
operational definition of inbreeding is the excess of homozygosity
compared to the Hardy—Weinberg Equilibrium expectation. This
corresponds to classical population genetic definitions dating back
to Wright (1922) and is in effect the definition used here and in
many previous papers (Leutenegger et al., 2003; Vieira et al., 2013),

©The Author 2016. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com 2096

9mg ‘09 isnﬁnV uo seleﬁuV soq ‘etulomeg JO KitSJQAtu [1 112 ﬂJO'sleumo[pJOJXO'sopeuuogutotq/ﬁdnq wort pepeolumoq

Estimating IBD tracts

2097

 

although inferences are done in a single individual by combining in-
formation from multiple sites.

Previous studies have addressed the problem of inferring IBD
tracts using Hidden Markov Models (HMMs) (Leutenegger et al.,
2003) based on individual genotype data. Current Next-Generation
Sequencing (NGS) technologies can sometimes produce data with
high error rates due to random sampling of homologous base pairs,
sequencing, or alignment errors (Nielsen et al., 2011; Ross et al.,
2013). Furthermore, due to budget constraints, many NGS studies
rely on low or medium depth of coverage sequence data ( < 5 X per
individual), causing genotype calling to be made with a considerable
amount of uncertainty. The uncertainty, especially from low depth
data, can greatly bias inferences of IBD tracts, as sites with sequenc-
ing errors can be mistaken for heterozygote sites thereby breaking
up the tracts into smaller segments.

Many recent methods rely on probabilistic frameworks to ac-
count for these errors and accurately call SNPs and genotypes,
even at low coverage (Li, 2011; Martin et al., 2010; Nielsen et al.,
2012). These methods integrate the base quality score together
with other error sources (e.g. mapping or sequencing errors) to cal-
culate an overall genotype likelihood (DePristo et al., 2011; Li
et al., 2009a,b). These likelihoods can be used directly or com-
bined with priors to take into account the uncertainty associated
with the data (for reviews see Nielsen et al., 2011; O’Rawe et al.,
2015

There are several methods available to infer inbreeding coeffi-
cients, but only ngsF (Vieira et al., 2013) is suitable for low coverage
NGS data; however, this program only estimates genome-wide in-
breeding levels and is thus incapable of inferring IBD tracts. In this
paper, we present a new method to estimate IBD tracts from low-
coverage NGS data. We evaluate its accuracy using extensive bio-
logically relevant simulations and apply it to two real datasets, one
consisting of populations from the HAPMAP and 1000 Genomes
projects, and another consisting of varieties of wild and domesti-
cated rice. When comparing against genotype-based methods, the
method presented here performs considerably better when estimat-
ing IBD tracts and per-individual inbreeding coefficients for cover-
ages < 3X.

2 Methods

2.1 Optimization and decoding
To optimize the parameters from our model (Fig. 1), we adopted a
Maximum Likelihood iterative approach. Using F for the per-indi-
vidual inbreeding coefficient, or for the transition rate, f for the allele
frequencies, TC for the most probable path (i.e. the inferred IBD
tracts) and L,- for the likelihood at iteration i:
(0) Initialization:
Set i: 0.
Initialize F, or and f from a uniform distribution.
Calculate initial likelihood L0.
(1) Given f, jointly estimate F and or through the L-BFGS-B
algorithm.
(2) Given F and or, estimate f using an EM algorithm.
(4) Check convergence:
Set i = i + 1.
Calculate Likelihood L,.
If L,- — L,_1 > epsilon go to (1).
(5) Infer the most probable path TC (decoding) with the Viterbi
algorithm.

P(Ys=1 I Ys-1=1)

P(Ys=0 I Ys-1=1)
P(AA | En) . ' P(aa | IBD)

P(Aa I IBD) P(Aa | En)

     
    
 

P(Ys=0 | Vs-1=0)

  
 
   

P(AAI IBD) P(aa | Its—D)

 

 

 

 

Fig. 1. HMM model. Illustration of the HMM model used. We used a two-state
model to represent IBD and W (not IBD) genomic regions. The model
switches between states with probability P(ys_1|ys) and each state can emit
the three different genotypes with probability P(glys) (where g represents a
genotype and ys the most probable state at site 3)

In more detail, on step (1), the L-BFGS-B algorithm (Zhu et al.,
1997) uses numerical derivatives and a new backward pass for each
evaluation of the likelihood, that is in turn calculated from the for-
ward algorithm. As for step (2), the EM algorithm was adapted
from ANGSD (Korneliussen et al., 2014) and estimates f directly
from the genotype likelihoods using, as prior, the expected genotype
frequencies under a certain inbreeding level; this is calculated from
the probability of a given site being IBD (calculated from the for-
ward and backward algorithms).

2.2 NGS data simulation
We performed extensive simulation to assess the performance of our
method when estimating all parameters. Due to computational con-
straints, we simulated mapped sequencing data directly (rather than
raw sequencing reads) similarly to previous studies (Fumagalli et al.,
2013; Kim et al., 2011; Vieira et al., 2013). When simulating geno-
types, we have to account for the IBD state in each site. Therefore,
we first sampled the true IBD states directly by implementing a
Markov model (Fig. 1), taking into account the distance between
SNPs, per-individual inbreeding coefficient (F) and a transition rate
(or). Allele frequencies were sampled uniformly between 0 and 0.5.
We then sampled genotypes given the allele frequencies and the pre-
viously simulated IBD states. Third, and similarly to previous stud-
ies, we sampled the number of reads from a Poisson distribution
with mean equal to the specified individual sequencing coverage and
simulated sequencing errors by changing each read base to any
of the other three nucleotides with probability 6/ 3, where 6 repre-
sents the error rate. We then calculated the genotype likelihoods
assuming the GATK model (DePristo et al., 2011). We note that,
since we use the same model to simulate the data and make infer-
ences, results from simulated data represent best case scenarios.

We simulated 10 000 variable sites with distances sampled from
a normal distribution with a mean of 100 000 base pairs and stand-
ard deviation equal to 1/3 of the mean. We assumed sample sizes of
10, 30 and 50 individuals, and average sequencing coverages of 0.5,
1, 3, 5 and 10x, with error rates of 0.5 , 1 and 2%, and varied the in-
breeding coefficients from 0.0 to 1.0 in steps of 0.1, for a total of
495 combinations. With these parameter choices we focused on
datasets with small sample sizes and low coverage, for which infer-
ence is harder, used realistic error rates (Glenn, 2011), and covered
biologically relevant scenarios of inbreeding from < 0.07 in humans
(Carothers et al., 2006) and ~0.3 dogs (Gray et al., 2009; Kirkness
et al., 2003) to 04—098 in rice (Kovach et al., 2007) and 0.757 in
wasps (Chapman and Stewart, 1996).

9mg ‘09 isnﬁnV uo seleﬁuV soq ‘etulomeg JO KitSJQAtu [1 112 ﬂJO'sleumo[pJOJXO'sopeuuogutotq/ﬁdnq wort pepeolumoq

2098

F. G. Vieira et al.

 

2.3 Genotype calling

Genotypes were called following a Maximum-A-Posteriori (MAP)
approach by internally setting the genotype with the highest poster-
ior probability to 1 and the remaining genotypes to 0. Genotype’s
posterior probability was calculated from the genotype likelihood
together with a prior (Li, 2011; Nielsen et al., 2011, 2012), where
the latter was either (i) a uniform distribution (GL_CG), the ex-
pected genotype frequencies under (ii) HWE (HWE_CG) or (iii)
HWE assuming an inbreeding coefficient (HWE+F_CG). In this
work, the inbreeding priors were calculated with the program ngsF
Vieira et al. (2013), that estimated genome-wide inbreeding coeffi-
cients from low coverage NGS data. It is worth noting that
under this genotype calling approach, we will only have undeter-
mined (i.e. missing) genotypes when using a uniform prior since, in
face of equally likely genotypes, the prior alone will determine the
outcome.

2.4 Metric of accuracy

We calculated error rates associated with all estimated parameters:
F, or, IBD tract (TC), allele frequencies (f) and genotype calls (g). For
genotype calls, the associated error was calculated as the proportion
of miscalled genotypes, while for the other parameters we used the
RMSD defined as:

1
 = E ZS (Xtrue _ )Cest)2 (

where Xtrue and Xe,t are the true and estimated values of the param-
eters, and S the total number of estimates (number of individuals for
F and or, and all sites across all individuals for TC; missing values were
ignored. All plots were made using R package ggplotZ (Wickham,
2009)

2.5 Analysis of real data

2.5.1 Human dataset

We selected individuals from the LWK (Luhya in Webuye, Kenya)
and GIH (Gujarati Indian from Houston, Texas) populations pre-
sent in both the HAPMAP (The International HapMap 3
Consortium, 2010) and 1000 Genomes (The 1000 Genomes Project
Consortium, 2012) datasets, on a total of 86 and 94 samples from
the LWK and GIH, respectively, with sequencing coverages ranging
from 3.13>< up to 13.98><, with an average of 6.2>< (Supplementary
Tables S1 and 52). For computational reasons, we restricted our
analyses to chromosomes 8 and 11 on the LWK and GIH popula-
tions, respectively (Supplementary Fig. S6). We selected all sites with
a Minor Allele Frequencies (MAF) of at least 0.05 and, since our
method does not explicitly account for linkage disequilibrium (LD)
among sites, devised two datasets to assess the impact of LD on the
IBD inferences: one composed of all sites in the HAPMAP dataset
(HAPMAP) and another (HAPMAP-LD) where sites in LD were
pruned with PLINK (Purcell et al., 2007) based on pairwise LD
(—indep-pairwise 50 5 0.2). To assess the impact of sample size and
sequencing coverage on the estimates, apart from the original 1000
Genomes dataset, we also analyzed downsampled datasets. For the
coverage we downsampled the original dataset to 50 and 25% of
the original total number of reads; for the sample size, we down-
sampled it to 15, 30 and 50 individuals. We extracted the sites for
each of these datasets and, using the originally mapped reads, used
‘ANGSD’ (Korneliussen et al., 2014) to calculate genotype likeli-
hoods (-baq 1 -C 50 -minMapQ 15 -minQ 10 -minInd (N_IND/2)
-GL 1 -doGlf 2 -doMajorMinor 1 -doMaf 1 -SNP_pval 1e-6).
Brieﬂy, we used the SAMtools formula (Li et al., 2009a) to calculate

the genotype likelihoods using only reads with a root mean square
(RMS) mapping quality> 15, and sites with a base quality >10,
where data was present in at least half the individuals and with a
high probability of being SNPs. To assess the accuracy of our
method, we inferred IBD tracts on all of the above mentioned 36
datasets (2 populations, 3 sample sizes, 3 coverages and 2 sets of
sites) and calculated the proportion of sites with correctly assigned
IBD states. Since we don’t know the true IBD state of these samples,
benchmarked the performance of our method dealing with low-
coverage data (using genotype likelihoods) relative to the perform-
ance of full genotyping data, using the our HMM algorithm in both
cases.

2.5.2 Rice dataset

For the rice example, we used the 113 wild, 72 indica and 79 iapon-
ica (both tropical and temperate) accessions from the MiniCore col-
lection (Wang et al., 2016). We used the original data comprising 52
838 SNPs evenly distributed across the rice genome. Brieﬂy, geno-
type likelihoods were calculated with ANGSD (options ‘-baq 1 -C
50 -minMapQ 20 -minQ 20 -GL 1 -doGlf 2’) and called SNPs with
a significance level of approx. 0.0001 for rejecting the hypothesis of
the site being non-polymorphic. We restricted our analyses to sites
with a MAF of at least 0.05 and, to account for LD, we randomly
selected a representative SNP for every 5 kb region. In this case we
simply inferred the IBD tracts, since we don’t have a high quality ref-
erence to compare to. Since the level of population structure of these
species is unclear, we analyzed the wild, indica and japonica acces-
sions separately (Supplementary Figs 57—59).

3 Results
3.1 Model for IBD tracts

To estimate Identity By Descent (IBD) tracts along a genome, we
extended the approach of Leutenegger et al. (2003) which
uses an HMM model with two hidden states (not inbred, y = 0 or
m; inbred, y = 1 or IBD) for each polymorphic site (5) of the
genome (Fig. 1). However, instead of the observed data being
genotypes, we will use genotype likelihoods directly to infer
IBD regions (or the most probable hidden state path it) across the
genome.

The transition probabilities between site 5 and s — 1 represent the
probability of switching between IBD states (y 6 {0,1}) and can
be obtained from an instantaneous rate matrix Q. This rate matrix
is naturally parametrized in terms of an inbreeding coefficient (F)
and a transition rate per Mb (or) which depends on the recombin-
ation rate and the time to common ancestor(s) in the underlying
pedigree:

State(y) W IBD

 

m 1 —ocF ocF

 

IBD oc(1 —F) 1 —oc(1 —F)

 

 

However, we note that the or parameter can only be estimated
when 0 < F < 1. Based on the instantaneous rate matrix, the

91m ‘09 1sn8nV uo sejeﬁuV soq ‘121u10111123 10 A11819Atuf1 112 /810'S{12umo[p101x0'831112u1101utotq//2d11q 111011 pepeolumoq

Estimating IBD tracts

2099

 

O
O

o u) o u)
o o! to vs
0 o o o

 

 

‘—' 6
True F

Depth
+0.5
.‘u 1
_..3
—l— 5
10

0 25
0.50
0 75
1 00

 

Fig.2. Estimation of IBD tracts. Performance of the HMM method to infer IBD tracts for a sample size of 30 individuals, a transition rate of 0.01 and 10, 000 variable

sites simulated with a 0.5% error rate. Columns represent the different analytical approaches, from genotype likelihoods (1st column), called genotypes assuming
no prior (2nd column) and called genotypes assuming a prior based on genotype frequencies under HWE (3rd column) or a prior assuming inbreeding (last col-
umn). The different lines represent RMSD under different simulated sequencing depths

transition probabilities of the continuous time Markov chain are
given by Leutenegger et al. (2003):

W = Obs—1 = 0) = <1 — woo — F) + 
P(ys = OIYS—l = 1) = (1 — e—O‘t)(1 _ F)

— (3)
P(ys = 1'3’5—1 = 0) = (1 _ e octﬂ:
P(ys : 1lys—l =  =  — e_°‘t)F+ e—oct

The emission probabilities at site 5, P(Xs|ys), represent the prob-
ability of the observed data (i.e. overlapping reads and correspond-
ing base qualities) at that site (XS) given the current state (3),). If we
were dealing with called genotypes, this would be straightforward
since the observed data would be the genotype but here, since we are
dealing with genotype likelihoods, we have to integrate over all pos-
sible genotypes:

P(Xslys) = Z P(Xslg)P(glys) (4)

where for site 5, P(X5|g) is the genotype likelihood for genotype g
and P(g5|ys) the probability of observing genotype g on state 3),.
Assuming that all sites are bi-allelic with two alleles represented by
A and a and, there are only three possible genotypes, so:

P(AAlys) = (1 — fs)2 + fs(1 — fs)ys
P(Aalys) = 2fs(1 — is) — 2fs(1 — Abs (5)
13016435): f} + 6(1 — ﬁsh’s

where yS is the IBD state and f; the minor allele (a) frequency at site
5, which is also estimated from the data (see below). From a set of
individuals, we jointly estimate the allele frequencies f, and the per-
individual inbreeding coefficients F and transitions rates or.

3.2 Estimating inbreeding from simulated data

To assess the accuracy of our method, we applied it to a simulated
dataset covering a wide range of biologically relevant scenarios. For
each simulated scenario, we used our HMM method and assessed
the estimates’ accuracy when based both on genotype likelihoods
(GL) and called genotypes (GL_CG, HWE_CG and HWE + F_CG).
On every case, we estimated the per-individual inbreeding coeffi-
cient (F), transition rate (or), most probable path (it) and allele fre-
quencies (f), together with their associated RMSD.

3.2.1 Estimating IBD tracts and transition probabilities

We benchmarked the accuracy of the new method on the above
mentioned simulated dataset for inferring IBD tracts (it). In all cases
we used the Viterbi algorithm to infer IBD tracts, i.e. the most

probable path between the model’s two states. Overall, the analyses
based on genotype likelihoods directly vastly outperform analyses
based on called genotypes (Fig. 2 and Supplementary Fig. S1). In
fact, we get broadly the same accuracy level at 0.5 X from genotype
likelihoods than at 3x when calling genotypes accounting for in-
breeding. Calling genotypes with priors that do not take inbreeding
into account (uniform or HWE priors) reduces the accuracy of the
estimates further, specially at low depth sequencing.

When inferring the transition rate (or) the overall trend is the
same as for IBD tracts, except that all methods based on called geno-
types perform quite poorly for coverages < 3x and, with higher
error rates, even < 5>< (Fig. 3 and Supplementary Fig. 52). When
calling genotypes assuming HWE in particular, it is impossible to
make any inference at coverages < 3x (and why data points are
missing for these coverages). Due to the extremely low coverage, the
HWE prior will lead to high genotype calling errors (30%;
Supplementary Fig. S5) that disrupt IBD tracts and preclude their
identification. For any given depth, inferences directly from geno-
type likelihoods always outperform all other methods, even looking
across different depths.

3.2.2 Estimating individual inbreeding coefficients

The individual inbreeding coefficients is given from the model and,
as previously shown, can be used as a prior in Bayesian analyses
(Vieira et al., 2013) and can be particularly important when dealing
with low depth-of-coverage NGS datasets. Overall we see that all
approaches perform quite well at a sequencing coverage depth of
10X, except when assuming HWE on highly inbred samples. This is
true even at > 5 X (Fig. 4 and Supplementary Fig. S3). At < 3x the
two methods based on called genotypes perform quite poorly, illus-
trating the biases that this type of approach entails when dealing
with low coverage data. At this coverage range, only genotype likeli-
hood-based methods have acceptable accuracies, with the new
method presented here slightly outperforming ngsF (Vieira et al.,
2013) at low sequencing depth (< 3x) and small sample sizes
(11 g 30).

3.2.3 Estimating allele frequencies

Allele frequencies form the backbone of most population genetics
methods and, as such, their accurate estimation is of high import-
ance. The method presented here was adapted from ANGSD and, as
such, performs similarly. Overall, genotype likelihood-based meth-
ods seem to perform better than those based on called genotypes
and be somewhat robust to various levels of inbreeding and priors
(Supplementary Fig. S4).

9mg ‘09 1sn8nV uo sejeﬁuV soq ‘121u10111123 10 A1tSJeAtuf1 112 /810'S{12umo[p101x0'831112u1101utotq//2d11q 111011 pepeolumoq

 

2100 F. G. Vieira et al.
Depth
+ 0.5
8 _.. 1
2 _.. 3
D: —l— 5

 

O ID O ID 0
O O O O 0

True alpha

 

 

005
010
0.15
020

Fig. 3. Estimation of transition rate. Performance of the HMM method when estimating or for a sample size of 30 individuals, an inbreeding coefficient of 0.5 and
10 000 variable sites simulated with a 0.5% error rate. Columns represent the different analytical approaches: genotype likelihoods (1st column), called genotypes
assuming no prior (2nd column) and called genotypes assuming a prior based on genotype frequencies under HWE (3rd column) or a prior assuming inbreeding
(last column). The different lines represent RMSD under different simulated sequencing depths

o
o.

‘—

 

o u) o u)
o o! to vs
0 o o 0

True F

 

Depth
+ 0.5
.‘H 1
_l.. 3
—l— 5

 

0 25
0.50
0 75
1 00

Fig. 4. Estimation of per-individual inbreeding coefficients. Performance of the HMM method to infer genome-wide per-individual inbreeding coefficients for a
sample size of 30 individuals, a transition rate of 0.01 and 10 000 variable sites simulated with a 0.5% error rate. Columns represent the different analytical
approaches, from genotype likelihoods (1st column), called genotypes assuming no prior (2nd column) and called genotypes assuming a prior based on geno-
type frequencies under HWE (3rd column). The last column represents the inference of per individual Ffrom genotype likelihoods (as in 1st column) but using the
previously developed method ngsF. The different lines represent RMSD under different simulated sequencing depths

3.2.4 Effect of inbreeding on genotype calling

A common downstream analysis of NGS data is the identification of
genotypes at each position for all individuals (genotype calling). The
methods developed here can provide improved Bayesian genotype-
calling in low depth-of—coverage data, by providing a more appro-
priate prior that takes inbreeding into account. However, several
factors in addition to inbreeding, can affect genotype calling, includ-
ing high error rates, sequencing coverage and small sample sizes. To
assess their impact, we calculated genotype posterior probabilities
with our HMM method, called genotypes, and compared these with
the previously mentioned called genotypes datasets: GL, HWE_CG
and HWE+F_CG (see Section 2). All methods show overall com-
parable error rates for calling genotypes (Supplementary Fig. S5 ),
but assuming a uniform prior gives a high proportion of undeter-
mined genotypes (e.g. 60 and 37% at 0.5 X and 1 X, respectively). If
we use an informative prior, the undetermined genotypes’ levels are
drastically reduced. Assuming HWE yields a relatively constant
error rate across inbreeding levels but, in highly inbred samples,
being able to incorporate inbreeding into the prior (either local or
global) can drastically reduce genotype calling errors by as much as
79% (from 0.215 to 0.046) when analysing 10 fully inbred individ-
uals at 5 X (Supplementary Fig. S5 ).

Dividing genotypes into homozygous and heterozygous calls, it
is clear they are differently affected. Homozygous genotypes tend to
have constant error rates independently of inbreeding levels, except
when assuming HWE, where higher inbred samples have higher
error since the prior makes it difficult to call low frequency homozy-
gotes. Using a uniform prior gives very low error rates but at the ex-
penses of high levels of undetermined genotypes, while both
informative inbreeding priors have similar performances.

Heterozygous genotypes are typically the most difficult geno-
types to call and, as such, have considerably higher error rates. In
this case, a uniform prior is the worst method with both high error
rates and undetermined genotypes’ levels. Assuming an inbreeding
prior performs similarly to HWE for low inbred samples but per-
forms worse for highly inbred ones (i.e. 0.5 < F < 0.9), since the
prior penalizes heterozygote genotypes. In this case, the method pre-
sented here presents another advantage as it actually allows the use
of different priors for regions that have been inferred to be IBD or
E. To sum up, the method largely has the advantages of an in-
breeding prior for homozygote genotypes and a HWE prior for het-
erozygotes genotypes in non-IBD regions.

3.3 Application to real data

In addition to simulated data, we also analyzed two publicly avail-
able datasets of low coverage NGS data: a human dataset composed
of populations from HAPMAP and the 1000 Genomes projects, as
well as a recently published rice dataset.

3.3.1 HAPMAP and 1000 genomes human datasets

In the analyses of the human dataset, we took advantage of the fact
that some individuals genotyped for the HAPMAP project (The
International HapMap 3 Consortium, 2010) have also been
sequenced at low coverage on the 1000 Genomes (The 1000
Genomes Project Consortium, 2012). This gives us a perfect test
dataset, as we have both low-coverage sequencing data and high
quality genotypes to use as reference. We selected the LWK and
GIH populations, since they are included in both datasets, both
were expected to be composed of unrelated individuals, but where

9mg ‘09 1sn8nV uo sejeﬁuV soq ‘121u10111123 10 A1tSJeAtuf1 112 /810'S{12umo[p101x0'831112u1101utotq//2d11q 111011 pepeolumoq

Estimating IBD tracts

2101

 

recent studies have shown some history of inbreeding (e.g. Gazal
et al., 2015; Stevens et al., 2012).

We inferred IBD tracts on the 1000 Genomes populations com-
paring results across several combinations of sample size and cover-
age, with and without LD pruning (see Section 2). We assume
HAPMAP genotypes are called correctly and, as such, that IBD
tracts inferred from them represent the gold standard. Comparing to
it, we show that the HMM method can accurately infer IBD tracts
even under cases of extremely low coverage and small sample sizes
(1/4 of 1000 Genomes coverage and 30 individuals) (Supplementary
Fig. S6 ). In fact, both sample size and coverage seem to have a rela-
tively small effect on IBD inference (the latter when sites in LD have
been pruned), in comparison to the presence of sites in LD. That
said, pruning of sites in LD can greatly reduce error rates by as
much as an order of magnitude, from (e.g.) an average proportion of
miss-identified sites of 0182—0020, when analysing 30 individuals
from the GIH population at 1/4 of their original coverage.

3.3.2 MiniCore rice dataset

As a second example, we used the recently published MiniCore data-
set, composed of both domesticated and wild accessions sequenced
at low coverage (Wang et al., 2016). There are several species of
wild rice but the O. rufipogon species complex is thought to be the
closest to domesticated rice (Oryza sativa) (e.g. Grillo et al., 2009;
Wei et al., 2012), which is further divided into two subspecies (O. s.
japonica and O. s. indica). Wild and domesticated accessions have
markedly different selfing rates, ranging in the wild between 50 and
95% (Gao et al., 2002; Morishima et al., 1984; Oka, 1988; Phan
et al., 2012), and in cultivated between 95 and 100%.

Our estimates show wild rice with a wide range of inbreeding
values, from totally outbred to almost fully inbred (Supplementary
Fig. S7), while cultivated rice accessions were all almost totally
inbred. These estimates are also reflected in the IBD tract inferences,
in which cultivated accessions have IBD tracts spanning whole
chromosomes (Supplementary Figs S9 and S8).

4 Discussion

The levels of inbreeding in an individual is an important parameter
in population genomic studies, since it can reﬂect mating system,
selfing rates, population size and past population history.
Theoretically, the best way to infer it is through the pedigree, but
pedigrees are not available in much studies. However, even in these
cases, inferences based on pedigrees can be biased due to incomplete
knowledge of the pedigree. In addition, pedigrees provide expected
levels of inbreeding, but these may differ from true genetic levels of
inbreeding due to the stochasticity of allelic segregation and recom-
bination. This has been demonstrated by recent analyses identifying
higher than expected ROH prevalence in unrelated individuals from
outbred populations (Gibson et al., 2006; The International
HapMap Consortium, 2007), supporting a recent claim that esti-
mates based on markers are more accurate than expected values
inferred from pedigrees (Kardos et al., 2015).

Here, we have developed a method that can reliably estimate in-
dividual Identical By Descent (IBD) tracts and inbreeding coeffi-
cient, directly from genomic data, without requiring any knowledge
of the underlying genealogy. Other methods exist for this (Hall
et al., 2012; Leutenegger et al., 2003) but all were developed for
SNP chip data, which has much lower error rates than low coverage
NGS data. NGS technologies have revolutionized genetics by pro-
viding fast, cheap and reliable large-scale DNA sequencing data.

However, the per base pair error rate in NGS data is still consider-
ably higher than in Sanger sequencing or chip-based genotyping
technologies (Glenn, 2011). As a consequence, researchers usually
sequence at high sequencing depths but this comes at an increased fi-
nancial, computational and storage cost. Furthermore, due to the
ever-growing demand for larger sample sizes, many NGS studies
rely on low coverage NGS sequence data ( < 5 X ). As such, the avail-
ability of methods that can properly handle this data will help re-
searchers make more cost-effective choices in the trade-off between
sample size and sequencing depth.

The method presented here facilitates the estimation of IBD
tracts from low coverage NGS data. We evaluate its performance
through both simulated and real data analyses. When compared to
genotype-calling-based methods, the improvement in accuracy when
estimating IBD tracts and individual inbreeding coefficients is con-
siderable for sequencing depths < 3><. Apart from the previously
mentioned use of this methods in population genomic studies, we
note that there is another possible application of the method: map-
ping of recombination breakpoints in backcrosses between inbred
lines. In backcross data, each individual in the backcross generation
effectively has an inbreeding coefficient of F = 0.5. The method pre-
sented here allows the estimation of recombination rates for such
data by estimation of the parameter a. More importantly, the poster-
ior decoding algorithm provides estimates of the genomic location
of recombination breakpoints. This provides, in combination with
low-coverage NGS sequencing of a backcross generation, an effi-
cient design for mapping recombination breakpoints from model
species such as yeast.

Acknowledgements

We would like to thank Thorﬁnn Korneliussen for helpful discussions and as-
sistance on the use of ANGSD, and Shyam Gopalakrishnan for helpful

discussions.

Funding

Funding for this work was supported by a DFF-MOBILEX grant to FGV
(DFF-1325-00136), and a Villum Foundation fellowship to AA.

Conﬂict of Interest: none declared.

References

Carothers,A.D. et al. (2006) Estimating human inbreeding coefﬁcients: com-
parison of genealogical and marker heterozygosity approaches. Ann. Hum.
Genet., 70, 666—676.

Chapman,T.W. and Stewart,S.C. (1996) Extremely high levels of inbreeding
in a natural population of the free-living wasp Ancistrocerus antilope
(Hymenoptera: Vespidae: Eumeninae). Heredity (Edinb), 76, 65—69.

Charlesworth,D. (2003) Effects of inbreeding on the genetic diversity of popu-
lations. Philos. Trans. R. Soc. London B: Biol. Sci., 358, 1051—1070.

DePristo,M.A. et al. (2011) A framework for variation discovery and genotyp-
ing using next-generation DNA sequencing data. Nat. Genet., 43, 491—498.

Ebert,D. et al. (2002) A selective advantage to immigrant genes in a Daphnia
metapopulation. Science, 295, 485—488.

Fumagalli,M. et al. (2013) Quantifying population genetic differentiation
from next-generation sequencing data. Genetics, 195, 979—992.

Gao,L. et al. (2002) Assessment of population genetic structure in common
wild rice Oryza mﬁpogon Griff. using microsatellite and allozyme markers.
Theor. Appl. Genet., 106, 173—180.

Gazal,S. et al. (2015) High level of inbreeding in ﬁnal phase of 1000 Genomes
Project. Sci. Rep., 5, 17453.

9mg ‘09 1sn8nV uo sejeﬁuV soq ‘121u10111123 10 A1tSJeAtuf1 112 /810'S{12umo[p101x0'831112u1101utotq//2d11q 111011 pepeolumoq

2102

F. G. Vieira et al.

 

Gibson,]. et al. (2006) Extended tracts of homozygosity in outbred human
populations. Hum. Mol. Genet., 15, 789—795.

Glenn,T.C. (201 1) Field guide to next-generation DNA sequencers. Mol. Ecol.
Resour., 11, 759—769.

Gray,M.M. et al. (2009) Linkage disequilibrium and demographic history of
wild and domestic canids. Genetics, 181, 1493—1505.

Grillo,M.A. et al. (2009) Genetic architecture for the adaptive origin of annual
wild rice, Oryza nivara. Evolution (N. Y), 63, 870—883.

Hall,N. et al. (2012) Maximum likelihood estimation of individual inbreed-
ing coefﬁcients and null allele frequencies. Genet. Res. (Camh)., 94,
151—161.

Kardos,M. et al. (2015 ) Measuring individual inbreeding in the age of gen-
omics: marker-based measures are better than pedigrees. Heredity (Edinh).,
115, 63—72.

Kim,S.Y. et al. (2011) Estimation of allele frequency and association mapping
using next-generation sequencing data. BMC Bioinformatics, 12, 231.

Kirkness,E.F. et al. (2003) The dog genome: survey sequencing and compara-
tive analysis. Science, 301, 1898—1903.

Korneliussen,T. et al. (2014) ANGSD: analysis of next generation sequencing
data. BMC Bioinformatics, 15, 356.

Kovach,M.J. et al. (2007) New insights into the history of rice domestication.
Trends Genet., 23, 5 78—5 87.

Leutenegger,A.L. et al. (2003) Estimation of the inbreeding coefﬁcient through
use of genomic data. Am. ]. Hum. Genet., 73, 516—523.

Li,H. (2011) A statistical framework for SNP calling, mutation discovery, as-
sociation mapping and population genetical parameter estimation from
sequencing data. Bioinformatics, 27, 2987—2993.

Li,H. et al. (2009a) The sequence alignment/map format and SAMtools.
Bioinformatics, 25 , 2078—2079.

Li,R. et al. (2009b) SNP detection for massively parallel whole-genome rese-
quencing. Genome Res., 19, 1124—1132.

Martin,E.R. et al. (2010) SquM: an adaptive genotype-calling approach for next-
generation sequencing studies. Bioinformatics, 26, 2803—2810.

Morishima,H. et al. (1984) Differentiation of perennial and annual types due
to habitat conditions in the wild rice Oryza perennis. Plant Syst. Evol., 144,
119—135.

Nielsen,R. et al. (2011) Genotype and SNP calling from next-generation
sequencing data. Nat. Rev. Genet., 12, 443—451.

Nielsen,R. et al. (2012) SNP calling, genotype calling, and sample allele fre-
quency estimation from New-Generation Sequencing data. PLoS One, 7,
e375 5 8.

O’Grady,].]. et al. (2006 ) Realistic levels of inbreeding depression strongly af-
fect extinction risk in wild populations. Biol. Conserv., 133, 42—51.

Oka,H.I. (1988). Origin of Cultivated Rice. Elsevier Science/Japan Scientiﬁc
Societies Press, Tokyo.

O’Rawe,J.A. et al. (2015) Accounting for uncertainty in DNA sequencing
data. Trends Genet., 31, 61—66.

Phan,P.D.T. et al. (2012) Estimation of the outcrossing rate for annual Asian
wild rice under ﬁeld conditions. Breed. Sci., 62, 25 6—262.

Purcell,S. et al. (2007) PLINK: a tool set for whole-genome association and
population-based linkage analyses. Am. ]. Hum. Genet., 81, 559—575.

Ross,M.G. et al. (2013) Characterizing and measuring bias in sequence data.
Genome Biol., 14, R51.

Stevens,E.L. et al. (2012) Unexpected relationships and inbreeding in
HapMap Phase III populations. PLoS One, 7, e495 75 .

The 1000 Genomes Project Consortium. (2012) An integrated map of genetic
variation from 1,092 human genomes. Nature, 491, 5 6—65 .

The International HapMap 3 Consortium. (2010) Integrating common and
rare genetic variation in diverse human populations. Nature, 467, 52—5 8.
The International HapMap Consortium. (2007) A second generation human

haplotype map of over 3.1 million SNPs. Nature, 449, 851—861.

Vieira,F.G. et al. (2013) Estimating inbreeding coefﬁcients from NGS data:
Impact on genotype calling and allele frequency estimation. Genome Res.,
23, 1852—1861.

Wang,H. et al. (2016) The power of inbreeding: NGS based GWAS of rice
reveals convergent evolution during rice domestication. Molecular Plant, (in
press).

Wei,X. et al. (2012) Domestication and geographic origin of Oryza sativa in
China: insights from multilocus analysis of nucleotide variation of O. sativa
and O. ruﬁpogon. Mol. Ecol., 21, 5073—5087.

Wickham,H. (2009) GgplotZ: Elegant Graphics for Data Analysis. Springer-
Verlag, New York.

Wright,S. ( 1922) Coefﬁcients of Inbreeding and Relationship. The American
Naturalist, 56, 330—338

Zhu,C. et al. (1997) Algorithm 778: L-BFGS-B: Fortran subroutines for large-
scale bound-constrained optimization. ACM Trans. Math. Softw., 23,
550—560.

9mg ‘09 1sn8nV uo SQIQBIIV soq ‘121u10111123 10 A1tSJeAtuf1 112 /810'S{12umo[p101x0'831112u1101utotq//2d11q 111011 pepeolumoq

