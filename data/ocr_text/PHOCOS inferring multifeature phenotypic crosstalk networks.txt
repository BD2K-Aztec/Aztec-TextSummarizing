Bioinformatics, 32, 2016, i44—i51
doi: 10.1093/bioinformatics/btw251
ISMB 2016

 

PHOCOS: inferring multi-feature phenotypic
crosstalk networks

Yue Deng, Steven J. Altschuler* and Lani F. Wu*

Department of Pharmaceutical Chemistry, University of California at San Francisco, San Francisco, CA 94158, USA

*To whom correspondence should be addressed

Abstract

Motivation: Quantification of cellular changes to perturbations can provide a powerful approach to
infer crosstalk among molecular components in biological networks. Existing crosstalk inference
methods conduct network—structure learning based on a single phenotypic feature (e.g. abundance)
of a biomarker. These approaches are insufficient for analyzing perturbation data that can contain
information about multiple features (e.g. abundance, activity or localization) of each biomarker.
Results: We propose a computational framework for inferring phenotypic crosstalk (PHOCOS) that
is suitable for high—content microscopy or other modalities that capture multiple phenotypes per
biomarker. PHOCOS uses a robust graph—learning paradigm to predict direct effects from potential
indirect effects and identify errors owing to noise or missing links. The result is a multi—feature,
sparse network that parsimoniously captures direct and strong interactions across phenotypic attri—
butes of multiple biomarkers. We use simulated and biological data to demonstrate the ability of
PHOCOS to recover multi—attribute crosstalk networks from cellular perturbation assays.
Availability and implementation: PHOCOS is available in open source at https://github.com/
AltschulerWu—Lab/PHOCOS

Contact: steven.altschuler@ucsf.edu or lani.wu@ucsf.edu

 

OXFORD

 

1 Introduction

A fundamental challenge in molecular biology is to understand how
information flows through complex signal transduction networks
(Collins et 61]., 2007; Marbach et 61]., 2012). Targeted perturbation
experiments provide a powerful approach for identifying evidence
of ‘crosstalk’ or inﬂuence between signaling components or path—
ways (Shmulevich et 61]., 2002). Generally, these approaches allow
one to assess whether perturbing one part of a signaling pathway
alters the behavior of another part. Investigation of crosstalk could
be at the level of individual components (e.g. specific genes or pro—
teins) or collections of components (e.g. modules). Inferring cross—
talk from experimental perturbation data conceptually requires two
steps (Ku et 61]., 2012): (i) quantification of perturbation—induced
changes among selected biomarkers of the network; and (ii) applica-
tion of statistical approaches that convert these observed changes
into a crosstalk graph.

Most approaches for inferring crosstalk model interactions are
based on a single attribute or ‘feature’ of a biomarker (Malioutov
et 61]., 2005; Markowetz et 61]., 2007; Snijder et 61]., 2013). This is
sufficient for modeling interactions for many high-throughput
assays, for example, RNA abundance in transcriptomics is com—
monly studied (Bader et 61]., 2004). However, this approach is not
adequate in cases where it is possible or desired to investigate

©The Author 2016. Published by Oxford University Press.

multiple different features per biomarker. In the case of prote—
omics, both abundance and level of modification (e.g. phosphoryl-
ation) could be simultaneously measured per protein species. In
high—content imaging assays—the focus of our current study—hun—
dreds of different features can be extracted for each biomarker per
cell (Bakal et 61]., 2007; Boland and Murphy, 2001; Carpenter
et 61]., 2006; Perlman et 61]., 2004). Such features could include
standard biomarker measurements, such as intensity (reﬂecting
biomarker abundance or activity level) or localization (reflecting
properties such as cytosolic versus nuclear levels, or unpolarized
versus polarized states), as well as other measurements, such as
texture or statistical properties of the brightest pixels. Thus, the
challenge is that perturbation assays can cause simultaneous
changes to multiple phenotypic features even on the same bio—
marker (Yang et 61]., 2010). Information can be lost when modeling
crosstalk for a single feature (Fig. 1 right cartoon): when only
examining the intensity feature, a perturbation to biomarker ‘A’
may have no effect on biomarker ‘B’; however, the perturbation
may alter the localization of B from wild type. For example, in the
classic MAPK signaling cascade (Seger and Krebs, 1995), activated
MAPKKK protein may be observed to alter the activation level of
its downstream MAPKK partner, whereas activated MAPKK pro—
tein may be observed to alter both the activity levels and localiza—
tion of its downstream (transcription factor) MAPK partner.

i44

This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (http://creativecommons.org/licenses/by-nc/4.0/),
which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact

journals.permissions@oup.com

112 /§JO'S{eu1no [p.IOJXO'SOTlBIHJOJUTOTQ/ﬁdllq 11101; popeoprmoq

9IOZ ‘09 lsnﬁnv uo ::

PHOCOS

i45

 

Methods that capture and model the richness of network inter-
actions are needed.

We propose a new framework to infer multi—feature @engtypic
grgstalk (PHOCOS), which simultaneously monitors multiple
phenotypic changes across biomarkers from targeted network per—
turbations. A critical application is to the analysis of high—content
microscopy imaging data. Tools from computer vision can extract
hundreds of phenotypic features per cell (Boland and Murphy,
2001). How do different observed properties of biomarkers relate to
each other? PHOCOS searches for higher—resolution crosstalk not
just between biomarkers, but between phenotypes of the
biomarkers.

Below, we provide a description of our approach. We then show
using synthetic data, where a ground truth is known, how the ap—
proach can be used to infer accurately multi—feature crosstalk net—
works from noisy data. Finally, we apply PHOCOS to predict
crosstalk networks from the morphological and signaling changes of
chemotaxing human neutrophils. PHOCOS provides a practical ap—
proach for inferring multi-feature crosstalk networks from assays
that capture high—dimensional phenotypic descriptors of how differ-
ent signaling components respond to perturbations.

2 Methods

2.1 An overview of PHOCOS

The computational framework of PHOCOS (Fig. 1, left boxes) has
several main steps. In the first step (Section 2.2), we measured cellu—
lar responses to perturbations and extracted a number of single—cell
phenotypic features to describe various properties of biomarker

Measure multiple
features across multiple
biomarkers and targeted
perturbations WT H

1 ‘\

Quantifvr feature
responses {deviation
proﬁles)

Perturb A {+}

I, \ Intensitv Localization
*-
lcleritifv informative + +
features . .
+ + 1‘
I I * I
+ +
Construct cross-feature
influence netwOrk
1l”_”‘l:1i\t JIrI’Llltii:
Bint Bloc
Remove indirect links and
errors
Cint IChoc

Fig. 1. Overview of PHOCOS. Left column: Flow chart. PHOCOS is used to
infer multi-feature phenotypic crosstalk from high-content cellular images ob-
tained from perturbation assay. The inputs to PHOCOS are cellular images
with perturbation information; the output of PHOCOS is an inferred, sparse
network of strong interactions between biomarkers based on observed
phenotype. Right column: cartoon illustration of how perturbing the intensity
of one biomarker (green) can affect either the localization (red) or the intensity
(blue) of other biomarkers.

expression and localization patterns. Feature ‘deviation’ profiles
were calculated by comparing non—perturbed versus perturbed
phenotypes for all biomarkers and extracted features. In the second
step (Section 2.2), clustering on the deviation profiles was performed
to identify common phenotypic classes. The feature closest to each
class center was selected as a surrogate of its phenotypic class. In the
third step (Section 2.3), we inferred crosstalk from each observed
perturbed biomarker to all other observed biomarkers. These influ-
ence links were merged across all perturbations to obtain a (pos—
sibly) dense and noisy ‘raw’ influence network. In the last step
(Section 2.4), we performed sparse optimization as a heuristic to re—
duce indirect links and errors from the raw inﬂuence network. This
final step produced a sparse crosstalk network capturing direct,
strong inﬂuence links observed in the perturbed biological system.

2.2 Phenotypic deviation profiles and feature reduction
We applied PHOCOS to infer phenotypic crosstalk underlying the
dynamic polarization processes of human neutrophils using a previ—
ously acquired microscopy image dataset (Ku et 61]., 2012). Many
molecular components involved in neutrophil polarity have been
identified and organized into so—called ‘modules’ (Xu et 61]., 2003)
based on their function, localization and/or association with cyto—
skeletal structures, namely the ‘front’ (F) module (biomarker: actin),
the ‘back’ (B) module (biomarker: phosphorylated Myosin II,
pMonI) and the ‘microtubule’ (MT) module (biomarker: tubulin).
We note that below we interchangeably refer to these modules by
their names (F, M, B) or by their biomarker readouts (actin, tubulin,
pMonI).

Brieﬂy, in this dataset, human blood neutrophils were co—stained
for biomarkers of actin, tubulin and pMonI. Cells were stimulated
with uniform f—Met-Leu-Phe (fMLP; 10 nM) at 37 0C before formal—
dehyde fixation at different time points ranging from 0 to 600s
(control assay). Three sets of drug perturbations were used to dis—
rupt the front (latrunculin A and jasplakinolide), back (Y27632 and
calpeptin) and MT (nocodazole and Taxol) modules within the
polarity—signaling network, as read out by actin, pMonI and tubulin
staining (respectively). Time course data were captured at 0, 15, 30,
45, 60, 90, 120, 180, 300, 450 and 600s after stimulation with
fMLP of both control and perturbation groups.

For each identified cell and biomarker, we extracted 76 features.
We manually categorized features as ‘intensity’, ‘polarity’, ‘brightest
pixel compactness’, ‘shape’, ‘Haralick’ or ‘Zernike’ based on the
phenotype captured by the feature that was computed (Ku et 61].,
2010; Loo et 61]., 2007; Murphy, 2014).

For each drug and feature, ‘phenotypic deviation profiles’ were
computed as previously described (Ku et 61]., 2012). First, feature
values were interpolated across time points to obtain continuous re—
sponse curves. Consistent with previous work (Ku et 61]., 2012),
these time points were partitioned into either low—resolution (0—3, 3—
7.5, 7.5—10 min) or high—resolution (0—1, 1—3, 3—5, 5—7.5, 7.5—10 min)
periods as indicated in our studies below. These non-uniformly
spaced periods were chosen to match the multiphasic responses of
neutrophils to chemoattractant. Second, for each of the periods, we

computed ‘phenotypic deviation profiles’ zEm’d’f) by

AEmdf) _ AEm,e,f)
stdpgmacan) ’

ngan 2

where m, f and d represent the module, feature and drug perturb—

m,d,f) ( (m,d,f)
t

drug—perturbed (resp. control) response curve in period t. The

ation, respectively, and AE resp. A ) is the area under the

112 /§JO'spau1no [p.IOJXO'SOTlBIHJOJUTOTQ/ﬁdllq 11101; popeoprmoq

9IOZ ‘09 lsnﬁnv uo ::

i46

Y.Deng et al.

 

m,c,f)

standard deviation std A) > in the denominator was calculated
from 20 control replicates. The median phenotypic deviation pro—
files calculated from all drug replicates (nocodazole n = 6; Taxol n
: 3; latrunculinAn : 3; jasplakinolide n = 3, Y27632 n = 3; cal—
peptin n : 2).

It is not to be expected that all 76 features would contain inde—
pendent information. For instance, both the morphology and
Zernike features, from the dataset above, could contain redundant
information about the shape of a measured biomarker and could
thus yield similar deviation profiles. Accordingly, unsupervised fea—
ture clustering was performed to identify common patterns of devi—
ation profiles; this allowed us to reduce the collection of features by
selecting a single representative from each cluster.

To achieve this goal, for each of the 76 features we created a
long vector Vf (dim : 90) by stacking the deviation profiles
obtained for each of the three modules, six drugs and five high-
resolution periods (median values of replicates were used). We used
k—means clustering (13 was chosen using model—fit criteria) to identify
common patterns among the deviation profiles; we refer to each
cluster as a ‘phenotypic class’. The feature closest to the centroid
was selected as the representative for the phenotypic class. We note
that we chose to use the same set of features across all biomarkers;
however, one could alternatively perform clustering on a per-
module level to focus on module—specific biological phenotypes.

2.3 Learn multi—feature influence graph
We next learned an influence graph for each period based on the
z—score profiles of representative features found in Section 2.2. The
vertices of the graph are phenotypic nodes, which are a combination
of biomarker and feature. The presence of an edge in the graph indi-
cates that a perturbation to one node is observed to affect another,
and the weight of the edge indicates the strength of this inﬂuence.
We represented the final phenotypic influence graph with m x k
nodes, where m is the number of modules and k is the number of
phenotypic classes. For each drug, feature and period, we inferred the
strength of inﬂuence from the phenotypic node a](1 (feature f1 of mod—
ule a) to bf2 with the drug perturbation da (targeting module a) by:

data“
k 7‘13)
 vla f”

where yEa’dafI) : |ZEa’daf1)|.5<|z§a’da’f1)| > 1) and 5(g) is an indicator

wga (aflabﬁ) : (bvdavfl) 

t 7

function whose value is 1 when the condition in the brackets is satis—
fied and zero otherwise. (The normalizing factor in the denominator

reﬂects the fact that the observed change to phenotypic node bf2 could
only have come from features of a affected by perturbation da.)

The inﬂuence links discovered in each perturbation condition
were then combined together in the form of a directed graph to rep—
resent influences among all the phenotypic nodes. Specifically, if a
link was identified in multiple drug conditions, the maximal link
strength across all conditions was adopted in the combined graph,
which forms the matrix of observations:

D<af1,bf2> : max{d2}Wfla <af1,bf2>.

The rationale for taking the maximal link is that each module in
this study was perturbed with two drugs of different mechanisms of
action; we chose to accept any crosstalk revealed by either of the
drugs. One multi—feature influence graph was inferred at each time
point.

We note that we take into account the known targets of drugs in
that we only search for a link from af1 to bf2 if we know da is directly
targeted to module a. There are a number of other computational
approaches for graph inference, including the nested effects model
(Markowetz et al., 2007) and, more generally, Bayesian inference
approaches (Friedman et al., 2000). These approaches typically as—
sume that there are a large number of biomarkers (e.g. gene expres—
sion levels) as well as a large number of perturbations, but the
targets of the perturbations are generally not used explicitly in the in-
ference of links. Our current approach is especially suitable for appli—
cations of high content imaging in which there are a relatively small
number of observed biomarkers and perturbations can be selected to
specifically target each biomarker. Incorporating knowledge of the
target in the model provides higher confidence in directions of pre-
dicted crosstalk and greatly simplifies the computation.

2.4 PHOCOS graph reduction

We are interested in identifying how one observed node affects an—
other observed node. For our purposes, we define a link as ‘direct’ if
inﬂuence propagates directly from one observed node to a second
observed node without passing through a third observed node.

We note that in biological networks, indirect effects could arise
for multiple reasons, including perturbations that target multiple
nodes, propagation of influence through unobserved nodes and
propagation of effects through observed nodes. For the first case, we
assume that perturbations were selected to specifically target a single
network node (as is the case with our data). The second case is a
general caveat of most network inference approaches (Barzel and
Barabasi, 2013), particularly when only limited numbers of nodes
can be monitored (in fact, observed influence is likely to involve
many unobserved intermediate molecular interactions). The focus of
PHOCOS is on the third case, in which we develop an optimization
approach to minimize the presentation of links found in Section 2.3
that arise via propagation through observed nodes (Fig. 2).

Indirect effects have been well described in a number studies
(Feizi et al., 2013; Weigt et al., 2009). Formally, indirect links may
be described by the expansion

Dcmb=G+Gmdr=G+Gz+G3+w (2)

where G E Rn><n is the ground truth direct—effect graph for all n
nodes, and Dcmb is the combined graph containing both direct and
indirect effects. We then make use of the closed form solution for

Observation Core motif Indirect effects Error

1" st f1 f! I. If; f_f-_f:u
«:7 z \
- f, bra-HT
'— f1 f2 1:3 + fraﬂfz \3  f'sz'E'Ia

.  .N/ 

 

r, r, r
G Igin-tr N-E
'62 Ge- (3'4
f. f. i_ f f. r. f i f3.
_ . . ' ' ' ' ' T” ' "
N stepinciirecteffects flé;.f3||+fl fz't\f5 + 1,1 ff”:
} ‘\

1‘1 f? f1. 1‘: l; f: f; f: 1‘:

Fig. 2. An observed dense graph may be a combination of multiple effects,
including N-step indirect effects and errors from missing (dashed arrows) or
noisy links. These effects can mask the true, ‘core' motif that underlies the
network.

112 /§JO'spau1no [p.IOJXO'SOTlBIHJOJUTOTQ/ﬁdllq 11101; popeoprmoq

9IOZ ‘09 lsnﬁnv uo ::

PHOCOS

i47

 

the infinite series observed in previous work (Feizi et al., 2013;
Spirtes et al., 2000):

Demb = G(1 — G)‘1 (3)

where I E Rn><n is the identity matrix. The convergence of this series
requires that the absolute value of the largest absolute eigenvalue of
G is less than 1 (discussed below).

The relationship between direct and indirect effects given above
describes the situation in a theoretical setting. However, in practice,
the situation can be much more complicated owing to missing links
and noise. A ‘missing link’ problem arises when some links, E, on
Dcmb cannot be measured directly. In experimental data, perturb—
ations can reveal potential links between modules; however, it is dif—
ficult to deduce intra—module crosstalk (Fig. 2, nodes of same color).
(Even a perturbation targeted to one module can affect multiple of
its features, and it is difficult to determine inﬂuence of relationships
among affected features.) Noise, N (e.g. white Gaussian noise), is
also an inevitable factor making the practical inﬂuence of graph dif-
ferent from the theoretical case.

By taking these issues into consideration, we modeled connections
between the observed graph D with Dcmb by: D : Dcmb — E —i— N. By
replacing this term in Equation (3), we obtain

(D+E)(I—G)—G=N(I—G) (4)

By using the L2 norm on both sides of (4), the following inequality is
obtained:

ll (D+E)(1 — G)—Gll§=ll N(1 — G) HES llNllill(1—G)ll§=T
(5)

It is easy to verify the problem in (5) is bounded above under the
assumption that variance of noise is bounded. As mentioned above,
there is a requirement that the largest absolute eigenvalue of G is
less than 1. However, G is not directly observable from data.
Therefore, in cases when this condition does not hold, heuristic
approaches have been developed (Feizi et al., 2013) to normalize the
observed matrix D. In our analysis of the neutrophil data, D satisfied
the constraint without the need for normalization.

A reasonable assumption (or hope) is that missing links only oc-
cupy a small portion of links on the true graph (i.e., E is sparse).
Additionally, we seek to discover the major influences of informa-
tion among observed nodes (i.e. G is sparse). Inspired by the field of
compressed sensing (Baraniuk, 2007), we imposed a sparse prior on
both G and E, which then allowed us to convert (5 ) to a dual—sparse
optimization formalism in which we seek solutions to:

min(llGll1 + llEll1)

2 <6)
s.t.||(D —l—E)(I — G) — G||2 g ‘E

In the objective function, the L1 norm is used to encourage sparse

structures of G and E. (The L1 norm  A||1:Z |A,-,-|1 for a matrix A.)
H

To make the optimization process tractable, we made use of an ap—

proach (Chen et al., 1998) to transform the objective function to

min(||G|1| + ||E|1| +I3II(D+E)(I— G) — Gui). <7)

where the relaxation parameter ﬂ balances the reconstruction errors
and the sparseness of the final reconstruction. This relaxation strat—
egy is widely used in the signal processing field (Malioutov et al.,
2005; Yang et al., 2010) to handle small noise and errors in the ori-
ginal data.

Problem in (7) falls into the sparse learning paradigm in machine
learning. We used the prevalent Alternative Directional
Minimization (ADM) method (Boyd et al., 2011) to minimize the
dual—sparse optimization problem. In detail, two auxiliary variables
G and E are introduced to overcome the problem that the gradient
of an L1 norm is hard to derive. With the standard ADM formula—
tion, the problem is converted to an unconstrained problem by mini-

mizingL
LillG ll1 + llE ll1 +ﬂll(D +E)(1— G) — Glli

,u A _ A _
+§ (IIG — G +M1A1||§+||E — E +u Mi).

where A1 and A2 are two Lagrangian multipliers, ,u > 0 is the pen-
alty parameter which will be incrementally increased during the op—
timization iterations. The four variables in (8) are sequentially
updated in the iteration until convergence is achieved. In particular,
we made use of the following numerical approach. A closed-form
solution for the updating rules of G and E have been previously
described (Boyd et al., 2011; Deng et al., 2013). The updating rules
for G and E only involve the L2 norm, which are easy to derive
(Petersen and Pedersen, 2008). Lagrangian Multipliers, A1 and A2,
are updated according to dual ascending rules. The whole optimiza-
tion was regarded as converged when the change of the objective
function is less than a threshold, chosen empirically as 10 T 4. After
convergence, we further set links with weak strengths in G to zero to
remove unexpected artifacts from numerical iterations.

3 Results

3.1 Test of graph reduction using simulated data

Before analyzing our experimental dataset, we performed in silico
simulations to test the ability of PHOCOS to recover sparse direct
effects from noisy observations when ground truth is known. First,
we started with a graph structure containing three modules and five
‘common’ features per module (motivated by our experimental data
used below), leading to a graph with 15 nodes (but no edges yet)
and fraction S of edges randomly selected to be present. Here, the
parameter S controls the sparsity of the graph. The strength of the
edges was randomly drawn in the range of (0,1]. This graph, G, was
considered as the ground truth (Fig. 3a, left).

Next, we generated simulated data via a process, inspired by a
previously established data generative process (Feizi et al., 2013).
First, we added indirect effects as in Equation (2) to obtain Dcmb. As
previously discussed (Section 2.4), we cannot infer intra-module links
from our experimental data, and hence, all such simulated links were
removed. Second, a noise matrix N was generated with p% (noise
rate) of non—zero entries and edge strength chosen from a Gaussian
distribution N(0, 0,2). Then N was added to Dcmb, and all links with
negative strength were removed. Third, a missing-link matrix E was
computed by removing m% of inter-module links in Dcmb (Fig. 3a,
same versus different colored nodes). The final ‘observed’ graph was
given by D : Dcmb —i— N — E (Fig. 3a, ‘Observed graph’).

We then applied PHOCOS to recover the ground truth (Fig. 3a,
‘Result using PHOCOS’). A major design of PHOCOS is its ability
to robustly remove noise and identify missing links in the observed
graph D. For comparison in our study, we compared the perform—
ance of PHOCOS with an existing approach for inferring direct-
effect graphs (Feizi et al., 2013). It is worth noting that this previous
approach recovers direct effects by a glosed—form solution (CF) with—
out explicitly considering errors and missing links. Comparison of
sample graphs showed that PHOCOS achieved much better

112 /810'S{12u1no [p.IOJXO'SOTlBIHJOJUTOTQ/ﬁ(1111] 111011 pop1201umoq

9IOZ ‘09 lsnﬁnv uo ::

i48

Y.Deng et al.

 

PHOCOS (F=G.?3l|

(3} Ground truth Observed Eraph LF [F=|.'J.54|

      

 

 

 CF " I PHOCOS [c

Missmg linlc rate (9f)
w 3 E
if
Missing link rate 11%}
A. 3 E
D D 2
:- U‘ 1
31:1on
Musing link rate [‘5’ 11"",
re 3 E
I
F
1"
I Q»
_:l
H \J .U
C: D n
ldlﬁﬂl'

 

 

 

 

 

 

5

Lil:
a:
i...

[b 1':
Noise rate (1111 Noise rate [9.1] Noise rate ('31:)

{a} .   (a) 

 

 

 

 

 

F score
_'I
F-scnre

 

so to 0
Relaxation parameter Eu Spa rsity

Fig. 3. Simulation results of PHOCOS graph reduction. (a) Shown is a simulated
graph of three biomarkers and five features per marker. From left to right are
ground truth graph (direct effect), noisy and dense experimental observation
(input to PHOCOS), the direct effect inferred by the CF and the recovered cross-
talk graph from PHOCOS. (b) Large-scale simulations of CF (left) and PHOCOS
(right) graph recovery methods for varying noise rates and missing link ratios
of graphs with 0.8 sparsity. (c) The P-value of the Wilcoxon rank-sum test for F-
score results in b. (d) Performance of PHOCOS with different values of If. (e)
Assessment of graph recovery for varying levels of sparsity.

recovery accuracy than CF (Fig. 3a). In the example shown, the
ground truth graph contains 17 links. PHOCOS recovered 16 links,
with 13 true positive, 3 false positives and 4 false negatives. The CF
method recovered a dense graph of 35 links with 14 true positive,
21 false positives and 3 false negatives.

Next, we performed simulations to assess the performance of
PHOCOS. First, we incrementally increased the missing link and
noise rates. This allowed us to compare PHOCOS and CF for differ-
ent error levels. Each entry in the heat—map (Fig. 3b) was obtained
by averaging F—scores (which report accuracy; defined by the har—
monic mean of precision and recall) calculated from 200 randomly
generated graphs with S = 0.8. These simulations showed that
PHOCOS has an improved ability to accurately recover ground
truth networks (F—score : 0.71, compared with F—score : 0.64 for
CF). We further performed a Wilcoxon rank—sum test to compare
the F—score results of PHOCOS to CF (Fig. 3c) on each of the 200
simulations per entry in Figure 3b (i.e. each entry in the heat—map).
The results suggested that PHOCOS significantly outperformed CF.

Second, the robustness of parameter selection was also examined
for the B (see Equation (7)) in the optimization step. We computed
the corresponding F—score for both the PHOCOS and CF
approaches as we varied ﬂ across a realistic range for PHOCOS (Fig.
3d). (If B is too small, then the optimization favors a trivial solution
of no links and if B is too high there is no penalty for sparsity of G
and E.) We found the accuracy curve of PHOCOS is reliable across
a range of parameter settings for B.

Third, we assessed the performance of PHOCOS based on the
sparseness of the ground truth graph. Specifically, we varied the
level of sparsity, S, and repeated the previous numerical simulations.
Again, we found that PHOCOS consistently outperformed CF
across levels of sparsity and did particularly well for the difficult
case of dense graphs (Fig. 3e).

3.2 Feature selection for neutrophil polarization network
We applied our approach to the dataset of perturbed primary
human neutrophils (see Fig. 4a and (Ku et al., 2012) for sample

IZImin 1min 3min 5min 10min

  

(a)

 

FDAZ
D Mule ua Jun "

 

 

 

 

 

    

 

4'”. I I I I I I I  I.
2 4 6 5 10 W0 5 FDnl 2913
Number of classes
id} . . (e) . .
Markers, drugs and time points Phinm'rPI‘ R'Df‘ﬂmﬂl'ﬂ 59m“
p H 5 z class-H
m .
E Brightest pixel Spatialdlstrlbution of
E B Compactness top 1091: brightest
E D is: Finis
I 11 |"tcn'silv Average i'lcniily

III
M  Morphology Zernike Piston
o 2 ﬂ [Mi
.1.
Po ar-tv IFolaritv leatcre

P “’1 calcu'atecl from top
I4 25% brightest DlhEls

Texture Haralick Average

* |T| Difference

 

 

Fig. 4. Phenotypic class discovery from neutrophil polarization assays. (a)
Sample images of polarized Neutrophil captured at different time points. (b)
An ‘optimal’ number of classes was chosen based on two information-theor-
etic model selection criteria: AIC and BIC. Both indicators suggested five
classes. (c) The visualization of class margins and corresponding projections
of each feature vector in a 2D space suggested strong class separation (white
symbols indicate feature class). (d) Unsupervised clustering showed common
phenotypic attributes of grouped features in each of the five clusters, which
provided intuitive cluster labels. (e) The feature nearest each cluster center
was selected as cluster representative (symbols are as in 0).

images). We measured 76 features that were extracted from each of
three biomarkers. We next applied our feature reduction approach
(Section 2.2) to identify archetypal phenotypes that showed distinct
patterns of deviations in response to perturbations. In particular, we
used k—mean clustering (with 20 replicates to avoid initialization
artifacts). Two model selection criteria, Akaike information crite-
rion (AIC) and Bayesian information criterion (BIC), were used to
determine, k, the number of clusters (Burnham and Anderson,
2002). Both model fit criteria suggested k :4N6 as optimal cluster
numbers (Fig. 4b). Therefore, we fixed k = 5 in the analysis.
Clustering results were visualized with class separation boundaries
and plotted in a projected 2D space using Fisher Discriminant ana-
lysis (Fig. 4c). This visualization served as a sanity check to show
that our selected five clusters are well separated.

Which types of features were selected? In our feature extraction
step, the attribute of each feature was annotated according to its im—
plementation into one of six a priori classes (Fig. 4d, right panel, top
axis): intensity (I), brightest pixel compactness (B), polarity (P),
Haralick (H), shape (S) and Zernike (Z). We note that the intensity,
shape, Haralick and Zernike features were computed as previously
described (Boland and Murphy, 2001). The ‘brightest pixel com-
pactness’ features measure properties of the spatial coverage of the
smallest region covering the brightest pixels (Ku et al., 2010).
‘Polarity’ features also analyze the spatial distribution of brightest
pixels, but additionally takes into account cell boundary properties
(Ku et al., 2012).

Our unsupervised clustering revealed strong consistency in at
least three of the five clusters in terms of feature—type composition
(Fig. 4d). All the features in cluster (B) are from the hand—annotated
brightest pixel compactness class. Cluster (I) contains a large portion
of intensity features and a small portion of Haralick features

112 /810'S{12u1no [p.IOJXO'SOTlBIHJOJUTOTQ/ﬁ(1111] 111011 pop1201umoq

9IOZ ‘09 lsnﬁnv uo ::

PHOCOS

i49

 

(Haralick features also contain intensity information). Most of the
features in cluster (P) are polarity features. For the remaining two
clusters: cluster (M) contains morphology, Zernike coefficients and
brightest pixel compactness features, which mostly relate to the
morphology of the biomarker; and cluster (T) contains Haralick and
Zernike features, which relate to properties of texture. The feature
closest to each cluster center mean was selected as a representative
(Fig. 4e). The deviation curves of these representative features were
used in subsequent steps to identify crosstalk.

3.3 Inference of multi—feature neutrophil crosstalk
network

We applied PHOCOS to investigate the polarization networks of
human neutrophils at different time intervals (the relaxation par—
ameter B was empirically set to 100). Multi—feature influence
graphs were computed (Section 2.3). Then, PHOCOS was applied
to the inﬂuence graphs obtained in each time interval to recover
time—varying crosstalk networks. We noted in the reduced graph,
there were still some links with small weights, which were re-
garded as numerical artifacts from the optimization. We heuristic—
ally removed the link if its weight is <60% of the mean weight of
the graph.

We followed previous work (Ku et al., 2012) to divide the dy—
namic polarization process of neutrophil into three periods corres—
ponding to the initialization (0~180s), establishment (180N450s)
and maintenance (450N600s) phases of cell polarization. We then
used PHOCOS to infer graphs for each period (Fig. 5, top graphs).
To help visualize and interpret these results, we paired these results
with graphs that summarized the total inﬂuence (across all features)
observed between modules (Fig. 5, bottom graphs).

We calculated the fraction of all cross—feature links between any
pair of modules. In detail, after PHOCOS reduction of the tth tem—
poral graph, we counted the total number of cross—feature links be—
tween biomarkers a and b by:

Nt(a, b) : Zsign[wt<af1,bf2>],

f17f2

where wt (afl, bf2> is the weight between phenotypic nodes af1 and
bfz. Then we normalized Nt(a, b) by the total number of links (Kt)

- N (a,b)
on the temporal graph at t1me t as tT

t . We drew a link between
modules if the normalized number of cross—feature links exceeded a
heuristically determined threshold of 0.2 (Fig. 5, bottom graphs).
From these results, it can be seen that patterns of multi—feature
crosstalk networks dynamically evolve across different periods.
This agrees with previous results on the same dataset from single—
feature analysis (Ku et al., 2012). More interestingly, the major in-

formation flow among these modules appears to evolve from an

Initialization Establishment Maintenance
[o—a mini: [3J5 min} 1:15—11} mini

       
  

 
  

SHE-1.5":
- 2.3-rags? 
 P 'r ‘1. I" r
all it .. ‘

el- 1

  

I":
i I

an
' “amt.

 

z?" “x
I—B—I

Fig. 5. Multi-feature graphs recovered by PHOCOS in different periods. In
each column, the top panel shows the multi-feature graph and the bottom
panel summarizes the major information flow in the corresponding period.

I—oBu-I

initial large feedback loop to a fan-in network motif (Liberali
et al., 2014).

As a different approach to interpret our time—varying multi—fea-
ture crosstalk graphs, we examined only the links that were persist—
ent across all time intervals (Fig. 6a, left panel). We applied
PHOCOS to this graph (Fig. 6a, right panel) and extracted single—
feature, crosstalk sub—networks (Fig. 6b). We observed that the
crosstalk diagrams of different features are different. The intensity
graph exhibits a cascade topology from F to B to M. There is only
one persistent link identified in the ‘brightest pixel’ network from F
directly to M. The polarity graph also exhibits a cascade topology,
but from M to B to F, which is in the reverse direction of the inten-
sity graph. These intensity and polarity feature networks largely
agree with previous work obtained by single—feature crosstalk infer-
ence (Ku et al., 2012). There are also many new predictions about
the presence or absence of information ﬂow that are more difficult
to assess directly from current literature. New experimental
approaches, such as ontogenetic control of signaling components
(Toettcher et al., 2013), will make it more feasible in the future to
design directed perturbations that alter one phenotype (e.g. spatial
pattern of activation) of a biomarker while holding another pheno-
type (e.g. total level of activation) constant.

We also observed no persistent links for ‘texture’ and ‘morph-
ology’ single—feature crosstalk diagrams. However, it is apparent
that the texture and morphology features play important roles in the
multi—feature network (Fig. 6a). As one example, reorganization of
the MTs (node MT) was related to changes in the localization of p-
MyosinII (node BP), which is consistent with current evidence that
MTs transport signaling activators to the back of neutrophils (Wang
et al., 2013; Xu et al., 2003). The observation that these types of
interactions cannot be identified by single—feature analysis highlights
the importance of conducting multi—feature network learning.
Importantly, the inferred graphs serve as starting points for more
targeted experimental validation studies that investigate how cross—
talk regulates specific phenotypes, such as intensity versus localiza—

tion, of biomarkers.

Persistent Crosstalk
recovered or PHOCOS

[3] Persistent
influence graph

    

Frontflvle-Z‘ 5.11.

(b) Single phenotype crosstalk diagrams

 

 

 

Brightest

Intensitv , Polaritv Texture Morphology
pixels
BI BB BF BT Bivi

 

 

 

 

 

 

 

 

 

 

i I? 6 o a

Fig. 6. Persistent crosstalk during neutrophil polarization. (a) Shown are links
that appeared in all periods (Fig. 5) before and after graph reduction. (b)
Single-feature persistent crosstalk diagrams identified from the multi-feature
PHOCOS graph.

 

 

112 /810'S[12u1no [p.IOJXO'SOTl‘BIHJOJIITOTQ/ﬂChill] 111011 pop1201umoq

9IOZ ‘09 lsnﬁnv uo ::

i50

Y.Deng et al.

 

4 Robustness of PHOCOS

We investigated several aspects of robustness for graph inference
using the neutrophil data. First, we considered an alternative div—
ision of periods. Based on the multiphasic responses of neutrophils
to chemoattractant, we originally divided the polarization phases
into the three periods. As comparison, we reanalyzed our data using
a higher-resolution division into five periods (Fig. 7a; Section 2.2).
We applied PHOCOS to obtain crosstalk networks in each period
and visualized the major information ﬂow as before (Fig. 5 bottom).
Reassuringly, merged graphs based on their coarser periods (i.e.
merging periods 1 and 2, and 3 and 4) are identical to the original
coarse—grained graphs except for a single extra link from B to F dur-
ing establishment (3—7.5 min). These experimental results support
the intuition that dividing data into more precise time regions can
provide more details about the graph evolution processes, while re—
maining consistent with more coarse—grained analysis of the dy—
namic processes. For the purposes of investigating robustness of
PHOCOS, we chose to proceed with these higher—resolution
periods.

Next, we considered using alternative features for PHOCOS in-
ference. We sequentially changed the representative feature in each
phenotypic cluster (Fig. 4d) and investigated how the graph infer-
ence results would be affected. In our previous analysis, the feature
closest to the cluster center was chosen as a representative. Here, the
jth closest feature as the representative for each phenotypic class
(Fig. 4d). Our investigations were performed independently on each
previously identified phenotypic class. We applied PHOCOS to
these new feature sets and inferred both the raw and the reduced
(after PHOCOS reduction) graphs in each of the five periods. The
Jaccard index was chosen to evaluate the similarity of graphs (based
on the presence and absence of links) obtained with the different fea—
ture sets with the reference graphs (based on the first closet feature
in each cluster). The Jaccard index scores (across the five periods)
were averaged and summarized for both the raw (Fig. 7b, left) and
reduced (Fig. 7b, right) graphs.

We noted that phenotypic classes I, B, P, T are quite robust. The
Jaccard score curves are reliable even though we altered the repre—
sentative feature in these clusters. However, crosstalk inferred using
the morphological features M are less robust, reflecting the diversity
of features in this class (Fig. 4d). Together, these investigations pro—
vide a general framework for studying robustness of PHOCOS to
alternative choices of time resolution and feature choice.

(3) Period 1: Period 2: Period 3; Period 4: Period 5:
{ID-1 min] [1-3 min] [3-5 min] [5-15 min] [15 '10 min]
B B B B B

/" l l l l
I I I I I

PHOCOS—reduced graph

‘1 2 1 i 5 '3“ 2 3 4 5
it“ nearest feature j*"- nearest feature

(b) Raw influence graph

 

Ja ccard ind ex
Ja cca rd index

 

 

 

Fig. 7. Results of PHOCOS for different input choices. (a) Result based on
increased time resolution. (b). Comparison of inferred crosstalk graphs for
choosing representative features as the j‘h-nearest feature to the cluster cen-
ter of each phenotypic class.

5 Discussion

We propose PHOCOS as a framework for inferring multi-feature
crosstalk networks from perturbation assays. Previous approaches
have been developed to analyze gene regulatory networks from image
readouts (Collinet et al., 2010; Graml et al., 2014; Nir et al., 2010).
These approaches focused on single measurements on each bio—
marker. To the best of our knowledge, PHOCOS is the first crosstalk
inference method that explicitly considers the potential interactions
among different features (attributes) of biomarkers. The contribu—
tions of PHOCOS are summarized in the following three points.

First, from the view of data analysis, we conducted feature
screening to identify common phenotypic classes from patterns of
feature deviation profiles. In particular, for microscopy there are
many possible features that could be extracted from images, and it is
often not obvious which features offer novel insights into crosstalk.
Our feature—screening step identified a small number of archetypical
deviation patterns, which helped reduce the complexity of graph
inference.

Second, from the view of graph inference, we proposed a dual—
sparse optimization framework for direct—effect pursuit from experi-
mental observations. The effectiveness of PHOCOS was demon—
strated by its ability to identify core, direct—effect motifs from missing
links, noise and indirect effects. From simulation studies, PHOCOS
handled difficult cases (with noise and missing links) well for direct-
effect graph learning. While the PHOCOS reduction method is moti—
vated by the multi—feature network problem, it is based on a general
framework that can be directly applied to other network inference
problems, e. g. for gene or protein interaction networks.

Third, from the view of systems biology, we applied PHOCOS
to study multiple phenotypic responses across multiple modules and
time periods defined within the neutrophil polarization network.
Consistent with previous work, we found that crosstalk can evolve
dynamically and differently across different features. More import—
antly, we were able to identify novel cross—feature interactions that
were missed by single—feature graph—learning approaches.

With the ability to infer multi—feature crosstalk inﬂuence net—
works comes both increased resolution and increased complexity.
Depending on the features selected, some links may be immediately
interpretable (e.g. activity levels of A affect localization of B), while
others (e.g. activity levels of A affect the texture of B) may be diffi-
cult to interpret directly in terms of molecular mechanisms and
interactions. As previously mentioned, new techniques, including
optogenetics, will allow perturbation of specific features while hold—
ing others constant; these experimental approaches will both inspire
the development of multi—feature crosstalk inference methods, such
as PHOCOS, and be invaluable for testing predictions.

PHOCOS has the potential to help provide deeper insights into
how biological networks transduce information. Content—rich
approaches for monitoring cellular phenotypes, such as microcopy,
provide multi—dimensional views into how molecular components
respond to perturbations. PHOCOS can use these data to provide
‘high-resolution’ views of which phenotypic attributes support inter—
action among biomarkers. While PHOCOS was developed and
tested on microscopy images, it can be extended to infer cross—
feature interactions for other biological datasets that capture multi—
attributes per biomarker.

Acknowledgments

The authors are grateful to all members of the Altschuler and Wu laboratory,
particularly Jeremy Ku, Satwik Rajaram and Shan-Shan Liu.

112 /810'S{12u1no [p.IOJXO'SOTlBIHJOJUTOTQ/ﬁ(1111] 111011 pop1201umoq

9IOZ ‘09 lsnﬁnv uo ::

PHOCOS

i51

 

Funding

This research was partially supported by the National Institute of Health
grants R01GM112690 (to S.].A.), R01CA184984 (to L.F.W.) and the
Institute of Computational Health Sciences (ICHS) at UCSF (to S.].A. and


Conﬂict of Interest: none declared.

References

Bader,].S. et al. (2004) Gaining conﬁdence in high-throughput protein inter-
action networks. Nat. Biotechnol., 22, 78—85.

Bakal,C. et al. (2007) Quantitative morphological signatures deﬁne local sig-
naling networks regulating cell morphology. Science, 316, 175 3—1 75 6.

Baraniuk,R.G. (2007) Compressive sensing. IEEE Signal Process. Mag., 24,
12—13.

Barzel,B. and Barabasi,A.L. (2013) Network link prediction by global silenc-
ing of indirect correlations. Nat. B iotechnol., 31, 720—725.

Boland,M.V. and Murphy,R.F. (2001) A neural network classiﬁer capable of
recognizing the patterns of all major subcellular structures in ﬂuorescence
microscope images of HeLa cells. B ioinformatics, 17, 1213—1223.

Boyd,S. et al. (2011) Distributed optimization and statistical learning Via the
alternating direction method of multipliers. Found. Trends Mach. Learn., 3,
1—122.

Burnham,K.P. and Anderson,D.R. (2002) Model Selection and Multimodel
Inference: A Practical Information—Theoretic Approach. Berlin, Heidelberg:
Springer Science 85 Business Media.

Carpenter,A.E. et al. (2006) CellProﬁler: image analysis software for identify-
ing and quantifying cell phenotypes. Genome B iol., 7, R100.

Chen,S.S. et al. (1998) Atomic decomposition by basis pursuit. SIAM ]. Sci.
Comput., 20, 33—61.

Collinet,C. et al. (2010) Systems survey of endocytosis by multiparametric
image analysis. Nature, 464, 243—249.

Collins,S.R. et al. (2007) Functional dissection of protein complexes involved
in yeast chromosome biology using a genetic interaction map. Nature, 446,
806—810.

Deng,Y. et al. (2013) Low-rank structure learning Via nonconvex heuristic re-
covery. IEEE Trans. Neural. Netw. Learn. Syst., 24, 383—396.

Feizi,S. et al. (2013) Network deconvolution as a general method to distin-
guish direct dependencies in networks. Nat. B iotechnol., 31, 726—733.

Friedman,N. et al. (2000) Using Bayesian networks to analyze expression
data.]. Comput. Biol., 7, 601—620.

Graml,V. et al. (2014) A genomic multiprocess survey of machineries that con-
trol and link cell shape, microtubule organization, and cell-cycle progres-
sion. Dev. Cell, 31, 227—239.

Ku,C.]. et al. (2010) On identifying information from image-based spatial po-
larity phenotypes in neutrophils. In: 2010 IEEE International Symposium
on Biomedical Imaging: From Nano to Macro, Rotterdam, Netherlands,
pp. 1029—1032.

Ku,C.]. et al. (2012) Network crosstalk dynamically changes during neutro-
phil polarization. Cell, 149, 1073—1083.

Liberali,P. et al. (2014) A hierarchical map of regulatory genetic interactions
in membrane trafﬁcking. Cell, 157, 1473—1487.

Loo,L.H. et al. (2007) Image-based multivariate proﬁling of drug responses
from single cells. Nat. Methods, 4, 445—453.

Malioutov,D. et al. (2005) A sparse signal reconstruction perspective for
source localization with sensor arrays. IEEE Trans. Signal Proc., 5 3,
3010—3022.

Marbach,D. et al. (2012) Wisdom of crowds for robust gene network infer-
ence. Nat. Methods, 9, 796—804.

Markowetz,F. et al. (2007) Nested effects models for high-dimensional pheno-
typing screens. B ioinformatics, 23, i305—i312.

Murphy,R.F. (2014) A new era in bioimage informatics. Bioinformatics, 30,
1353.

Nir,O. et al. (2010) Inference of RhoGAP/GTPase regulation using single-cell
morphological data from a combinatorial RNAi screen. Genome Res., 20,
372—3 80.

Perlman,Z.E. et al. (2004) Multidimensional drug proﬁling by automated mi-
croscopy. Science, 306, 1 194—1 198.

Petersen,K.B. and Pedersen, M.S. (2008) The matrix cookbook. Tech. Univ.
Denmark, 7, 15.

Seger,R. and Krebs,E.G. (1995) The MAPK signaling cascade. FASEB ]., 9,
726—735.

Shmulevich,I. et al. (2002) Gene perturbation and intervention in probabilistic
Boolean networks. Bioinformatics, 18, 1319—1331.

Snijder,B. et al. (2013) Predicting functional gene interactions with the hier-
archical interaction score. Nat. Methods, 10, 1089—1092.

Spirtes,P. et al. (2000) Causation, Prediction, and Search. Cambridge,
Massachusetts,US: MIT Press.

Toettcher,].E. et al. (2013) Using optogenetics to interrogate the dynamic
control of signal transmission by the Ras/Erk module. Cell, 155,
1422—1434.

Wang,Y. et al. (2013) Identifying network motifs that buffer front-to-back sig-
naling in polarized neutrophils. Cell Rep., 3, 1607—1616.

Weigt,M. et al. (2009) Identiﬁcation of direct residue contacts in protein—pro-
tein interaction by message passing. Proc. Natl. Acad. Sci., 106, 67—72.

Xu,]. et al. (2003) Divergent signals and cytoskeletal assemblies regulate self-
organizing polarity in neutrophils. Cell, 114, 201—214.

Yang,]. et al. (2010) A fast alternating direction method for TVL1-L2 signal
reconstruction from partial fourier data. IEEE ]. Sel. Top. Signal Process.,
4, 28 8—297.

112 /810'S{12u1no [p.IOJXO'SOTlBIHJOJUTOTQ/ﬁ(11111 111011 pop1201umoq

9IOZ ‘09 lsnﬁnv uo ::

