Bioinformatics, 31, 2015, i206—i213
doi: 10.1093/bioinformatics/btv240
ISMB/ECCB 2015

 

Identification of causal genes for complex traits

Farhad Hormozdiari1, Gleb Kichaevz, Wen-Yun Yang1,
Bogdan Pasaniuc2'3'4 and Eleazar Eskin1'3'*

1Department of Computer Science, 2Inter-Departmental Program in Bioinformatics, 3Department of Human
Genetics and 4Department of Pathology and Laboratory Medicine, University of California, Los Angeles, CA
90095,USA

*To whom correspondence should be addressed.

Abstract

Motivation: Although genome—wide association studies (GWAS) have identified thousands of
variants associated with common diseases and complex traits, only a handful of these variants are
validated to be causal. We consider ‘causal variants’ as variants which are responsible for the asso—
ciation signal at a locus. As opposed to association studies that benefit from linkage disequilibrium
(LD), the main challenge in identifying causal variants at associated loci lies in distinguishing
among the many closely correlated variants due to LB. This is particularly important for model or—
ganisms such as inbred mice, where LD extends much further than in human populations, resulting
in large stretches of the genome with significantly associated variants. Furthermore, these model
organisms are highly structured and require correction for population structure to remove potential
spurious associations.

Results: In this work, we propose CAVIAR—Gene (CAusal Variants Identification in Associated
Regions), a novel method that is able to operate across large LD regions of the genome while also
correcting for population structure. A key feature of our approach is that it provides as output a
minimally sized set of genes that captures the genes which harbor causal variants with probability
p. Through extensive simulations, we demonstrate that our method not only speeds up computa—
tion, but also have an average of 10% higher recall rate compared with the existing approaches.
We validate our method using a real mouse high—density lipoprotein data (HDL) and show that
CAVIAR—Gene is able to identify Ap0a2 (a gene known to harbor causal variants for HDL), while
reducing the number of genes that need to be tested for functionality by a factor of 2.

Availability and implementation: Software is freely available for download at genetics.cs.uc|a.edu/
caviar.

Contact: eeskin@cs.uc|a.edu

 

1 Introduction

OXFORD

 

Genome—Wide association studies (GWAS) have been extremely suc—
cessful in reproducibly identifying variants associated With various
complex traits and diseases (Altshuler et 61]., 2008; Hakonarson
et 61]., 2007; International Multiple Sclerosis Genetics Consortium
et 61]., 2013; Kottgen et 61]., 2013; Ripke et 61]., 2013). The most com—
mon type of genetic variants comes in the form of single nucleotide
polymorphisms (SNPs), Which we make the focus of this study.
Because of the correlation structure in the genome, a phenomenon
referred to as linkage disequilibrium (LD) (Pritchard and Przevvorski,
2001; Reich et 61]., 2001), each GWAS—associated variant Will
typically have hundreds to thousands of other variants Which are
also significantly associated With the trait. Identifying the variants
responsible for the observed effect on a trait is referred to as

©The Author 2015. Published by Oxford University Press.

fine mapping (Hormozdiari et al., 2014; Kichaev et 61]., 2014;
Maller et 61]., 2012; Yang et 61]., 2012). In the conteXt of association
studies, the genetic variants Which are responsible for the association
signal at a locus are referred to in the genetics literature as the ‘causal
variants’. Causal variants have biological effect on the phenotype.
Generally, variants can be categorized into three main groups. The
first group is the causal variants Which have a biological effect on the
phenotype and are responsible for the association signal. The second
group is the variants Which are statistically associated With the
phenotype due to LD With a causal variant. Even though association
tests for these variants may be statistically significant, under our def-
inition, they are not causal variants. The third group is the variants
Which are not statistically associated With the phenotype and are not
causal. We note that this usage of the term causal has little to do

i206

This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (http://creativecommons.org/|icenses/by-nc/4.0/),
which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact

journals.permissions@oup.com

112 /§.IO'S{BU.IT10[p.IOJXO'SOllBIHJOJUIOICI/ﬁdllq 11101; prBOIIIAAOG

9IOZ ‘09 lsnﬁnv uo ::

CA VIAR-Gene

i207

 

with the concept of causal inference as described in the computer sci—
ence and statistics literatures (Pearl, 2000; Spirtes et 61]., 2000).
Fine-mapping methods take as input the full set of association
signals in a region and attempt to identify a minimum set of vari—
ants that explains the association signals. A common approach is
to calculate marginal association statistics for each variant and,
depending on the study budget, select the top K ranked variants
for follow—up studies. However, the local correlation structure at a
fine-mapping locus will induce similar association statistics at
neighboring, non—causals variants, thereby making this approach
suboptimal in this context. Furthermore, it fails to provide a guar—
antee that the true causal variant is selected. A recent work
(Maller et 61]., 2012) addressed this issue by estimating the proba—
bilities for variants to be causal under the simplifying assumption
that each fine—mapping locus contains a single causal variant.
Ranking variants based on association strength (similar to top 13)
and this probabilistic approach (Maller et 61]., 2012) assuming a
single causal variant give identical relative rankings. However, the
probabilistic approach provides the added benefit that we can
now select enough variants to guarantee that we have captured the
true causal variants with p level of confidence. Unfortunately, the
key underlying assumption that a fine—mapping locus contains a
single causal variant is likely to be invalidated at many risk loci
(Hormozdiari et 61]., 2014; Kichaev et 61]., 2014). For regions that
putatively harbor multiple independent signals, a common strat—
egy is to use iterative conditioning to tease out secondary signals
(Yang et 61]., 2012). This process is analogous to forward stepwise
regression, where at each iteration, the variant with the strongest
association is selected to enter the model and then marginal statis—
tical scores are re—computed for the remaining variants condition
on the ones that have been selected. This process is repeated until
there are no remaining variants that are statistically significant.
However, it has been shown that this approach is highly sub—
optimal (Hormozdiari et 61]., 2014; Kichaev et 61]., 2014) due to
lack of LD consideration. To address these issues, we recently pro—
posed probabilistic fine—mapping methods (Hormozdiari et 61].,
2014; Kichaev et 61]., 2014) that build on the concept of a standard
confidence interval by providing a well—calibrated, minimally sized
confidence set of variants using principled, LD-aware modeling of
multiple causal variants. In these methods, we assign probability
to each variant to be causal and subsequently select the smallest
number of variants that achieve the desired posterior probability.
Many accurate fine—mapping methods have been designed for
human studies where there are a relatively small number of associ—
ated variants in a region. In model organism studies, however, per—
vasive LD patterns result in GWAS—associated loci that may span
several megabases and contain thousands of variants and dozens
of genes. For example, in a widely utilized design for mouse stud—
ies, the Hybrid Mouse Diversity Panel (HMDP) (Bennett et 61].,
2010)—the typical associated region—is approximately 1—2 mega-
bases. Identifying which genes underlie an associated locus in
model organism studies is a major, labor—intensive process involv—
ing generating gene knockouts. Therefore, it is often the case that
identifying the causal genes at an associated locus requires a larger
effort than the initial GWAS (Flint and Eskin, 2012). In addition
to large LD blocks, fine—mapping studies in model organisms are
complicated by population structure (i.e. the complex genetic rela—
tionship between different individuals in the study; Flint and
Eskin, 2012; Kang et 61]., 2008; Price et 61]., 2006) that invalidate
commonly used association statistics that assume the individuals
in the study are independent. Model organisms such as mice have
a high level of population structure, typically larger than what is

observed in human populations; therefore, correcting for the
population structure for mouse GWAS is imperative to mitigate
the chance of false positive signals of association (Flint and Eskin,
2012; Kang et 61]., 2008; Price et 61]., 2006).

In this article, we propose CAVIAR—Gene (CAusal Variants
Identification in Associated Regions), a statistical method for fine
mapping that addresses two main limitations of existing methods.
First, as opposed to existing approaches that focus on individual
variants, we propose to search only over the space of gene combin—
ations that explain the statistical association signal, and thus drastic—
ally reduce runtime. Second, CAVIAR—Gene extends existing
framework for fine mapping to account for population structure.
The output of our approach is a minimal set of genes that will con—
tain the true casual gene at a pre—specified significance level. This
gene set together with its individual gene probability of causality
provides a natural way of prioritizing genes for functional testing
(e.g. knockout strategies) in model organisms. Through extensive
simulations, we demonstrate that CAVIAR—Gene is superior to exist—
ing methodologies, requiring the smallest set of genes to follow—up
in order to capture the true causal gene(s). To validate our approach,
we applied CAVIAR—Gene to real mouse data and found that
we can successfully recover Apan, a known causal gene for high-
density lipoprotein (HDL) (Flint and Eskin, 2012; van Nas et 61].,
2009), for the HDL phenotype in the HMDP.

2 Methods
2.1 Overview of CAVIAR—Gene

CAVIAR—Gene takes as input the marginal statistics for each variant
at a locus, an LD matrix consisting of pairwise Pearson correlations
computed between the genotypes of a pair of genetic variants, a par—
titioning of the set of variants in a locus into genes, and the kinship
matrix which indicates the genetic similarity between each pair of
individuals. Marginal statistics are computed using methods that
correct for population structure (Kang et 61]., 2008; Lippert et 61].,
2011; Listgarten et 61]., 2012; Zhou and Stephens, 2012). We con—
sider a variant to be causal when the variant is responsible for the as—
sociation signal at a locus and aim to discriminate these variants
from ones that are correlated due to LD. Our previous proposed
method CAVIAR, is a statistical framework that provides a ‘p causal
set’ that is defined as the set of variants that contain all the causal
variants with probability of at least p. The intuition is that due to
LD structure, it is impossible to identify exactly the causal variants,
but it is possible to identify a set which contains these causal vari—
ants. CAVIAR was designed to work on human GWAS where we
deal with regions that have at most 100 variants in a locus and we
consider all possible causal combinations of at most 6 causal vari—
ants to detect the p causal set. However, in model organisms, the
large stretches of LD regions result in a large number of variants
associated in each region, thus making CAVIAR computationally
infeasible.

CAVIAR—Gene mitigates this problem by associating each vari—
ant to a proximal gene, and instead, operating on the gene level,
thus reducing the computational burden by an order of magnitude
while facilitating interpreting of GWAS results. Similarly,
CAVIAR—Gene detects a ‘p causal gene set’ which is a set of genes
in the locus that will contain the actual causal genes with
probability of at least p. Note that not all the genes selected in the
p causal gene set will be causal. A trivial solution to this problem
would be to output all the genes as the p causal gene set.
However, because this provides no additional information, we are

112 /§.IO'S{BU.IT10[p.IOJXO'SOllBIHJOJUIOICI/ﬁdllq 11101; prBOIIIAAOG

9IOZ ‘09 lsnﬁnv uo ::

i208

F. Hormozdiari et al.

 

interested in detecting the p causal gene set which has the min—
imum number of genes. We demonstrate that CAVIAR—Gene is
well—calibrated as it fails to detect the actual causal gene 1—p frac—
tion of the time.

2.2 Standard GWAS

Consider a GWAS on a quantitative trait where we collect pheno—
typic values for 11 individuals and genotype all the individuals on m
variants. Let y,- indicate the phenotypic value of the ith individual
and gik E {0, 1, 2} indicate the minor allele count of the ith individ—
ual for the lath variant. We use Y to denote the (n X 1) vector of
phenotypic values and X k to denote the (n X 1) vector of normalized
genotype values for the lath variant for all the 11 individuals in the
study. Without loss of generality, we assume that genotype values
for each variant have been standardized to have mean 0 and vari—
ance 1 yielding the following relationships: 1T Xk = 0 and
Xsz : n, where 1 denotes the (n X 1) vector of ones. We assume
that the data generating model follows a linear additive model, and
for simplicity the variant 6 is the only variant associated (causal)
with the phenotype. Each variant is categorized into one of the three
groups. The first group is variants which are associated with the
phenotype and are considered causal. The second group is variants
which are statistically associated with the phenotype due to LD
with a causal variant—these variants are considered not causal.
The third group is variants which are not associated with the pheno—
type and are considered not causal. Standard GWAS analysis for the
cth variant is performed utilizing the following model equation:

Y=u1+BCXc+e (1)

where u is the mean of the phenotypic values, BC is the effect size of
the cth variant, and e is the residual noise. In this model, the residual
error is the (n X 1) vector of i.i.d and normally distributed error. Let
6 N N(0, 631), where I is the (n x 11) identity matrix and (Se is a co—
variance scalar. The estimates of BC, which are indicated by [36, are
obtained by maximizing the likelihood,

A x,T Y A 03

B6 = xzx. ’ to N N030 —<xzxc>)

and the statistics is computed as follows:

_E T N
5,—661/(xcxc) M101).

where kc is the non—centrality parameter (NCP) and is equal to

 

 We obtain the estimated value for u, e, and Ge as follows:

A T A A A A ATA
Liz—1:9, ezY—lp—BCXC,andoe: 

2.3 The effect of LD in GWAS

In the previous section, we consider that there is only one variant (vari—
ant c), and this variant is causal. Now, we extend the previous case
and for simplicity we assume there are two variants, c and 12. Similar
to the previous section, the variant 6 is causal and variant [2 is corre—
lated to 6 through LD but has no phenotypic effect. The correlation
between the two variants is r which is approximated by iXkTXC.
Thus, the estimate for the effect size for the variant [2 is as follows:

A xTY A 02
Bk: k ,Bk~NrB,—e
leXk C(Xsz)

and the statistics is computed as follows:

 

5,, =  (xgxk) N MAC, 1).

We compute the covariance between the estimated effect size of
the two variants as follows:

Cov(SC,S,-) : Cov<(/(XCTXC)I:C, (X?X,-)E’e>

1 x,T Y x,T Y
= —2Cov —T ,—
66 V X6 X5 (/
xfx,
: — : 7".

, /x,Tx,-, /xCTx,

Thus, the joint distribution of the marginal association statistics
for the two variants given their NCPs follows a multivariate normal

distribution (MVN),
(M M) (M i1 (i)
N N 7 7
Si Ki 217 1’1,‘ 1

where r),- is the genotype correlation between the 1th and jth variants.

 

In the case that both variants are not causal, we have 2»,- : 2t,- : 0. In
the case that the jth variant is causal and the ith variant is not causal,
we have 2»,- = 72,-. In the case that jth variant is not causal and the ith
variant is causal, we have 2»,- = 7?»). This result is known from previ-
ous studies (Han et al., 2009; Hormozdiari et al., 2014; Kichaev
et al., 2014; Zaitlen et al., 2010).

2.4 Computing the likelihood of causal SNP status from
GWAS data

Given a set of m variants, the pair—wise correlations denoted by Z,
we use the (m X 1) vector S : [S1 Sm ]T to denote the mar—
ginal association statistics. We extend the joint distribution men—
tioned above for m variants. The joint distribution follows an MVN

distribution,
(SIA) N (WE/M 2), (2)

where A is the (m X 1) vector of normalized true effect sizes and Z is
a (m x m) matrix of pair—wise genotype correlations between differ—
ent SNPs. Let X : [X1,X2 - - -X,,,] be a n X m matrix of genotype.
We can approximate 21 using genotype data as follows: 2 : iXTX.

In CAVIAR (Hormozdiari et al., 2014), we introduce a new
parameter C, which is a (m X 1) binary indicator vector used to
represent causal status of m SNPs in a region (i.e. 60') is 1 if the ith
SNP is causal and 0 otherwise). We define a prior probability
on the vector of A for a given causal status using an MVN
distribution,

(AIC) NN(0726)7 (3)

where EC is a diagonal (m x m) matrix. The diagonal elements of EC
are set to 0% or e where e is a very small constant to make sure the
matrix EC is full rank. The 1th element on the diagonal is set to 0% if
the ith variant is causal and set to e if the ith variant is non—causal.
We know that the LD between two variants is symmetric (2T : Z).
We combine Equations (2) and (3) to compute the joint marginal

112 /§JO'S{12u1no [p.IOJXO'SOTlBIIIJOJUTOTQ/ﬁdllq 111011 pop1201umoq

9IOZ ‘09 lsnﬁnv uo ::

CA VIAR-Gene

i209

 

association statistics of all the variants. The joint distribution fol-
lows an MVN distribution,

(S|C) N N(0, Z + 2262). (4)

2.5 Computing the posterior probability of causal SNP
status from GWAS data
Given the observed marginal association statistics, S : [S1, - - - Sij,

we can compute the posterior probability of the causal SNP status
P(C*|S) as,

* _1 A. A. _w
M |S) _ ZP(S|C )P(C ) — stmmy (5)

C66

where C is the set of all possible causal SNPs. Thus, the size of
C is 2’”. Furthermore, P(C*) is the prior probability for a particular
causal SNP status, C*. We use Z to indicate the normalization
factor.

In CAVIAR, we use a simple prior for a causal SNP status.
We assume that the probability of an SNP to be causal is inde—
pendent from other SNPs and the probability of an SNP to be
causal is y. Thus, we compute the prior probability as
P(C*) :  ylci|(1 — y)1_|c"|. In our work, we set y to 0.01
(Darnell et al., 2012; Eskin, 2008; Jul and Eskin, 2011). It is worth
mentioning that although we use a simple prior for our model,
CAVIAR can incorporate external information such as functional
data or knowledge from previous studies. As a result, we can have
SNP—specific prior where y,- indicates the prior probability for the ith
SNP to be causal. Thus, we can extend the prior probability to a
more general case, P(C’klv = [11,12, - - w] = 11:, v)“'(1 — 10116”-

To compute the posterior probability for each causal SNP status,
we need to consider all the possible causal SNP status which is the de—
nominator of Equation (5). To ease the computational burden, we as—
sume we have at most six causal SNP in each region. Assuming we
have an upper bound on the number of causal variants is a common
procedure in fine-mapping methods (Hormozdiari et al., 2014; Kichaev
et al., 2014). We show the upper bound of six causal variants have
small effect on the results (Hormozdiari et al., 2014). This assumption
reduces the size of C from 2’" to m6 which is computationally feasible.

2.6 p causal SNP set

Give a set of SNPs IC, we define a causal SNP configuration as all the
possible causal SNP status which excludes any SNP as causal outside
the set IC. Note, our definition of causal SNP configuration includes
the causal SNP status where no SNP is considered as causal. We use
CK to denote the causal SNP configuration for the IC. We compute the
posterior probability of set [C capturing all the true causal genes,

P(C;C|S) = Z P(C|S).

CECIC

Let p denote the value of the posterior probability, where
p : P(C;C|S), and we refer to it as the confidence level of IC capturing
the actual causal SNPs. We refer to [C as the ‘p confidence set’.

Given a confidence threshold p*, there may exist many confi-
dence sets that have a confidence level greater than the threshold.
However, among all the possible p* confidence sets, the sets which
have the minimum number of SNPs are more informative or have
higher resolution to detect the actual causal SNPs. Thus, we are
interested in finding the p* confident set with the minimum size

(with minimum number of selected SNPs), P(C,C* S) 2 p*, where IC*

 

has the minimum size.

2.7 p causal gene set

Unfortunately, the p causal SNP sets for mice can select many variants
due to the high LD. Instead, we would like to find a set of genes that
harbors causal variants. We define a p causal gene set as a set of genes
which captures all the genes which harbor the causal variants with
probability at least p. One of the benefits of detecting the p causal
gene set requires less computation than detecting the p causal SNP set.

For simplicity, we use genes as a way to group the SNP to detect
the causal SNPs. Thus, SNPs are partition to sets and this partition
of the SNPs is done based on the genes. As a result, when a gene is
selected in the p causal gene set, we can consider all the SNPs which
are assigned to that gene which are selected in the p causal SNP set
in the CAVIAR model. We use a simple way to assign SNPs to a
gene—we assign an SNP to the closest gene. We would like to em—
phasize that CAVAIR—Gene can incorporate more complicated SNP
to gene assignment.

Let g be a set of genes and K(g) indicate all the SNPs assigned to
the genes in the set g. Then, we formally define the p causal gene
set as a 9* set where the total posterior probability of all the SNPs in
K(g*) that captures all the causal SNPs is p. Among all the p causal
gene set, we are interested in the set which has the minimum number
of genes selected.

P(CI<(9")|5) Z P-

Thus, to detect the p causal gene set, we need to search over all the
possible sets of genes. Given E genes in loci, we have 2f possible
causal gene set which is much smaller than all the possible sets of
SNP, which are 2’”.

2.8 Greedy algorithm to detect the p causal gene set

We would like to emphasize that p causal gene set should capture all
the causal genes; however, not all the genes selected in the p causal
gene set are causal. Thus, even if we set an upper bound of six on
the number of causal genes, the size of the p causal gene set can be
larger than six genes. For example, if we have one causal variant
and all the variants in that region have perfect LD, just utilizing the
marginal statistics is impossible to distinguish which gene is the ac—
tual causal gene. Thus, in order to have 95% causal gene set, we
have to select all the genes in the region. This is similar to what we
observe in the variant level from previous studies (Hormozdiari
et al., 2014; Kichaev et al., 2014).

Instead of considering all the possible causal gene set to find the p
causal gene set, we propose the following greedy algorithm to ease the
computational burden. For each gene, we define a weight that indi—
cates the amount that each gene contributes toward the posterior
probability of the p causal gene set. Genes which have higher weights
will have higher probability of being selected in the p causal gene set.
Thus, we pick the top set of genes for which the summation of their
weights is at least p fraction of total weights of all genes in the region.

We use W : [w1, w2, - - - wg] as a (E X 1) vector for the weights of
all the genes, where w,- is the weight of the ith gene and we compute
the weight for the ith gene as follow:

2 P(S| C)P(C)c<i>

,-= P CS =CEC—. (6)
w  ( ') ZP<sIc>P<c>
CeC

We compute the weight for the ith gene by summing over all the
causal gene statuses where the ith gene is selected as causal.
We show in Section 3 that the proposed greedy and the brute force
algorithm which consider all possible causal gene status tend to have
similar results.

112 /§JO'S{12u1no [p.IOJXO'SOTlBIIIJOJUTOTQ/ﬁdllq 111011 pop1201umoq

9IOZ ‘09 lsnﬁnv uo ::

i210

F. Hormozdiari et al.

 

2.9 Handling marginal statistics corrected for
population structure

The linear model which is used in the standard GWAS assumes only
one causal SNP as shown in Equation (1). Moreover, in this linear
model, we assume that the phenotypic value of each individual is
independent from the phenotypic value of another individual. This
assumption is not true in general for GWAS, especially in model
organisms such as inbred mice. The model that accounts for this de—
pendency is as follows:

Y: p1+ZB,x,-+e (7)
i=1

Unfortunately, in a typical GWAS, the number of individuals in a
study is much smaller than the number of SNPs (11 << m). Thus, esti—
mating the effect size of all the SNPs is not possible. We test each SNP
one at a time, Y : ul —1— BCXC —1— u —1— e, where u : Zi¢cj3iXi models
the random effects. In this model, we assume that each SNP has an
effect and the effect of each SNP is distributed normally as
[3,- N N (0,%). The total genetic variance is defined as 0:, and we use
6; as the estimated genetic variance. We compute the variance of the
random effect as Var(u) : oéK, where K : XXT / m is referred to as
the kinship matrix. The kinship matrix defines pair—wise genetic re—
latedness which is computed from the genotype data. Let V be the
total variance of phenotype Y, which is computed as V = 631 —1— oéK.
Let 66 be the estimated environment and measurement error variance.
Thus, the total estimated variance is V = 631 —1— ééK.

We assume that the collected phenotype has an MVN distribu—
tion as follows: Y NN 1,11 —1— BCXC,o§I—1— oéK . Similar to linear
regression, we compute t e estimate of the effect size of the causal
SNP BC by maximizing the likelihood. Moreover, we can estimate
the effect size of the SNP [3,- which is indirectly associated to the
causal SNP,

—, B. ~ N(Bc.(XZV—1Xc>‘1>

and the statistics is computed as follows:

5, = B,(/chv—1xc AVA/(1,, 1)

We would like to emphasize all the existing methods (Kang et al.,
2008; Lippert et al., 2011; Listgarten et al., 2012; Zhou and Stephens,
2012) which correct for population structure computes the marginal
statics for each variant. However, corrected marginal statistics cannot
be used by existing fine—mapping methods (Hormozdiari et al., 2014;
Kichaev et al., 2014). As in these methods, we assume that the correl—
ation between the computed marginal statistics is equal to the correl—
ation between the two corresponding variants. As shown in our
experiment below, the correlation between the marginal statistics
which are corrected for population structure is not equal to the correl—
ation of genotypes corresponding to the two variants.

We compute the covariance between the observed statistics for a
causal SNP (variant) and an SNP (variant) which is indirectly associ—
ated with the causal SNP as follows:

 

 

xT “IY xT “IY
Cov(S,-,SC) : Cov< ’ V C V >

\/x,Tv—1x,- ’ \/chv—1x,
_ x,T17‘1xc
\/x,Tv—1x,\/chv—1x,

 

 

Let1 matlrix L be the Cholesky decomposition of matrix
17— , 17— : LTL. Let X’C : LXC and X:- : LXi. We assume that

LXC, LXi, and LY are normalized to mean 0 and variance 1. Thus,
we can re—write the covariance between the computed statistics for
two SNPs as follow:

COV(S,', SC) I COV(X,'I,XCI) = COV(LX,‘, LXC)

This indicates that the covariance between the two marginal
statistics corrected for population structure follows an MVN
where the correlation between the two statistics is the correlation
between the transformed genotype for both SNPs. Thus, we re—
write Equation (2) for the case the marginal statistics is corrected
for population structure as follows: (S|A) N N(Z’A,Z’), where 2’
is the pair—wise correlation matrix which is computed by trans—
forming the genotyped data and then computing the pair—wise cor—
relation of transformed genotypes. In principle, this result could
also be applied to other problems such as imputing the missing
variants that utilize the summary statistics (Lee et al., 2013;
Pasaniuc et al., 2014).

3 Results

3.1 CAVIAR—Gene is computationally efficient

CAVIAR and CAVIAR-Gene at high level can consider all possible
causal combinations for variants and genes, respectively. However,
considering all possible causal combinations is intractable. In
CAVIAR, we make an assumption that in each locus we have at
most six causal variants. However, in CAVIAR, in order to detect
the p causal variants, we consider all possible causal sets which
can be very slow depending on the number of variants selected in
the p causal variant set. In the worst case, the running time of
CAVIAR can be 0(2’"), where m is the total number of variants in a
region. In CAVIAR—Gene, we use the proposed greedy method
which is mentioned in Section 2.8. This greedy algorithm reduces
the complexity of CAVIAR from 0(2’”) to O(m6). Applying
CAVIAR on loci with 100 of variants will take around 30h.
However, it will take 2h for CAVIAR—Gene to finish on the same
loci and 3 h for CAVIAR-Gene to finish on loci with 200 variants.
Figure 1 indicates the running time compression between CAVIAR
and CAVIAR-Gene for different number of variants in a region.

3.2 CAVIAR—Gene—estimated causal gene sets are well—
calibrated

To assess the performance of our method, we conducted a series of
simulations. To make our simulations more realistic, we utilize real
genotypes from three different datasets: outbred dataset (Zhang
et al., 2012), F2 dataset (van Nas et al., 2009), and HMDP dataset
(Bennett et al., 2010). After obtaining the real genotype for each

 

2000
I

1500
I

 
   

1000
I

—e— CAVIAR
—A— CAVIAR—gene

500
I

Computational Time (min)

 

 

0
I

 

50 100 150 200

Number of Variants

Fig. 1. CAVIAR-Gene is computationally more efficient than CAVIAR. Running
time comparison between CAVIAR and CAVIAR-Gene. The experiments are
run on a 64bit |nte|(R) Xeon(R) 2 G with 5 GB RAM

112 /§JO'S{12u1no [p.IOJXO'SOTlBIIIJOJUTOTQ/ﬁdllq 111011 pop1201umoq

9IOZ ‘09 lsnﬁnv uo ::

CA VIAR-Gene

i211

 

dataset, we partition the genome into segments containing 200
genes. For each segment, we implant one, two, or three causal genes
in the region where a gene is considered causal if it harbors at least
one causal variant. We then generate simulated phenotypes for each
segment using a linear mixed model as in the previous studies (Han
et al., 2009; Zaitlen et al., 2010).

We extend the existing methods, which are designed to detect
the causal variants, to detect the causal genes. For these methods,
we consider a gene to be causal if any of the variants in that gene are
selected as causal. We run TopK—Gene, conditional method
(CM—Gene) (Yang et al., 2012), 1Post—Gene (Maller et al., 2012),
and CAVIAR—Gene. Among these methods, CAVIAR—Gene is the
only method that is well—calibrated to detect causal genes as shown
in Table 1. We consider a method to be well—calibrated if it accur—
ately captures the causal genes in p fraction of the time. It is worth
mentioning that 1Post—Gene is well—calibrated when we only have
one true causal gene; however, 1Post—Gene is mis—calibrated when
there are more than one causal gene in the locus as shown in Table1.

3.3 CAVIAR—Gene provides better ranking of the causal
genes

To compare the performance of each method, we compare the recall
rate and the number of causal genes selected by each method. We
calculate the recall rate as a percentage of the total simulations
where all the true causal variants are detected. Unfortunately, each
method selects a different number of genes as causal. Thus, to make
the comparison fair, we compute the recall rate for each method as a
function of the number of genes each method selects.

The results for all the methods across all three datasets are
shown in Figure 2. In this figure, the X—axis is the number of genes
selected by each method and the Y—axis is the recall rate for each
method. Figure 2c and e indicates the recall rate for Outbred, F2,
and HMDP datasets where we have implanted one causal gene.
Although the difference between the TopK—Gene and CAVIAR—
Gene in the case of one causal gene is negligible, we observe a 10%
higher recall rate when there are multiple causal genes in a region
(Fig. 2b, d, and f).

Although in Figure 2 we only compare recall rate of different
methods as we vary the number of causal genes selected by each
method, these figures are similar to receiver operating characteristic
(ROC) curves which are used as a measure to compare results for
different methods in statistics and machine learning. In ROC curves,

Table 1. CAVIAR-Gene estimated causal gene-sets are well-
calibrated

 

Causal gene Recall rate (%) Causal gene size

 

1Post— CM— CAVIAR— 1Post— CM— CAVIAR—

 

Gene Gene Gene Gene Gene Gene
1 0.995 0.941 0.990 2.59 1.16 2.10
2 0.790 0.526 0.964 3.93 2.28 3.17
3 0.760 0.610 0.951 3.23 3.28 6.65a

 

Note: We implanted one, two, or three causal genes in a region. 1Post-
Gene is well-calibrated to detect the causal genes in regions where we have
only one true causal gene. CAVIAR-Gene is well-calibrated in all our experi-
ments. We consider a method to be well-calibrated when the recall rate is at
least 95%. We compute the recall rate of a method as a percentage of the total
simulations where all the true causal variants are detected.

aAlthough we allow for only six causal genes in a region, we can have more
than six causal genes in the p causal gene set (see Section 2.8).

the y—axis is the true positive rate which is equivalent to the recall
rate in our result, and the x—axis is the false positive rate which indi—
cates the fraction of simulations where the non—causal genes are se—
lected as causal. Because of the fact that all methods are forced to
pick the same number of causal genes, the false positive rate is the
same for all the methods. Moreover, similar to ROC curves in our
results, as we increase the false positive rate, the recall rate increases
and as we reach false positive rate of 1, which means if we select all
the genes as causal, we have a recall rate of 1.

3.4 Greedy algorithm and brute force algorithm have
similar results

We proposed a greedy algorithm in Section 2.8 to detect the p causal
gene set in order to speed up the process. In this section, we show
that the results obtained from the greedy algorithm and the brute
force algorithm are very close. The brute force algorithm considers
all the possible 2f different causal gene sets in order to compute the
p causal gene set. We consider a region with 20 genes and then we
simulated data similar to the previous sections. We implant one,
two, or three causal genes in the region. We ran both methods and
computed the recall rate as well as the size of the p causal gene set
selected by each method. Table 2 shows the results. We calculate the

(a)

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

o
0.-
9 _
Er“
_ 0
Tu _
8
Ct - O CAVIAR-Gene
—El— Top K_Gene
o' —e— CM-Gene
"._ —A— 1Post-Gene
° '1 '2 s 4 5 ' ' 6 ' '
Number of selected Genes Number Of SeleCted Genes
(C)
o
Q-
9.
cu ' 0
or
E ' ,0 c
g - o CAVIAR-Gene
—El— Top K_Gene
' —e— CM-Gene
E —A— 1Post-Gene 0.
.- o .
o 1 2 3 4 5 2 4 6 8
Number of selected Genes Number Of se'eCted Genes
o (e) (f)
O'- ' o
o
\— O O O O
_  O o
a o
O _
o— <t-
0Q- 0 CAVIAR-Gene O
0 —El— Top K_Gene _
' —e— CM-Gene
E_ —A— 1Post-Gene o_
o" 1 O 2 4 6 8 1'

 

Numbe2r of séiected4Geneg Number of selected Genes
Fig.2. CAVIAR-Gene provides better ranking of the causal genes for Outbred,
F2, and HMDP datasets. Panels a and b illustrate the results for Outbred geno-
types for case where we have one causal and two causal genes, respectively.
Panels c and d illustrate the results for F2 genotypes for case where we have
one causal and two causal genes, respectively. Panels e and f illustrate the re-
sults for Outbred genotypes for case where we have one causal and two
causal genes, respectively

112 /§JO'S{12u1no [p.IOJXO'SOTlBIIIJOJUTOTQ/ﬁdllq 111011 pop1201umoq

9IOZ ‘09 lsnﬁnv uo ::

i212

F. Hormozdiari et al.

 

recall rate as a percentage of the total simulations where all the true
causal variants are detected.

3.5 CAVIAR—Gene adjusts for population structure

It is known that in the case where there exists no population struc—
ture, the correlation between the marginal statistics of two variants
is the same as the correlation between the genotypes from which the
statistics were computed. CAVIAR utilizes this fact to compute the
likelihood for each possible causal combination. However, when
population structure is present and corrected for, this may not hold.
We demonstrate in our experiments that the correlation between the
marginal statistics for any two variants which are corrected for
population structure is the same as the correlation of a transformed
version of genotype for the same two variants. We provide the de—
scription of this transformation in Section 2. CAVIAR—Gene utilizes
this transformation to adjust for the population structure to com—
pute the correct likelihood.

We use an HMDP dataset (Bennett et al., 2010) which we deter—
mine to have population structure. We generate phenotypes with
population structure and compute the marginal statistics for each
variant both corrected and not corrected for population structure.
We then compute the correlation between each pair of marginal
statistics and the correlation between each pair of variants for the
original genotype and the transformed genotype. We calculate the
difference between the correlation computed from the marginal

Table 2. Greedy algorithm and brute force algorithm have similar
results

 

Causal gene Recall rate (%) Causal gene size

 

 

Greedy Brute force Greedy Brute force

 

1 0.999 0.999 1.72 1.67
0.983 0.990 3.84 3.30
3 0.956 0.976 4.82 4.73

 

Note: We implanted one, two, or three causal genes in a region. We run
both the greedy and brute force algorithm on the simulated data sets. This re-
sult indicates that the differences between these two methods are negligible.

(8) (b)

 

statistics for each pair of variants and the correlation of the genotype
of the same variants. The boxplot of these differences are shown in
Figure 3.

As expected, the difference between the correlation of the mar-
ginal statistics and the correlation of the transformed genotype is
close to zero and their variance is much smaller than other cases.
Thus, the correlation between the marginal statistics when popula—
tion structure is corrected is closer to the correlation between the
genotype which is transformed using the right transformation
matrix.

3.6 CAVIAR—Gene identifies Apan as causal gene

in HDL

To illustrate an application of our method in real data, we use an
HDL dataset which was collected for three different mouse strains:
outbred dataset (Zhang et al., 2012), F2 dataset (van Nas et al.,
2009), and HMDP dataset (Bennett et al., 2010). We ran CAVIAR—
Gene on a region N80 megabases in length containing 595 genes
(chr1: 120,000,000—197,195,432). This region harbors Apan, a
gene previously established to inﬂuence HDL levels (Flint and Eskin,
2012; van Nas et al., 2009). We applied CAVIAR—Gene on the
HMDP dataset considering all the genes in this region which yielded
a 95 % p causal set of 130 genes. Next, we conducted a more refined
experiment, using domain—specific knowledge of the phenotype, to
create a list of 53 potential candidate genes. CAVIAR—Gene selected
a 23 gene subset of this list as the p causal gene set. Running
CAVIAR—Gene on the Outbred dataset for all 5 95 genes resulted in
a 95% gene set of only 13 genes. Because of the fact that the
Outbred mice have a smaller degree of population structure than the
HDMP, it is expected that the gene set resolution should be greater
in this data. Most importantly, across all the datasets, CAVIAR—
Gene includes A1)an in the gene set. Figure 4 illustrates the genes
which are selected by CAVIAR—Gene for each datasets. The five
genes which are common between all the datasets are N71i3,
Tomm401, Apan, Fcerl g, andeust. All these genes are known to
be highly associated with the HDL. This suggests that CAVIAR—
Gene not only recovers the actual causal gene, but simultaneously
reduced the number of genes that need to undergo functional
validation.

(c)

 

0. 0.

 

 

 

 

-O.4

 

 

 

 

 

 

 

<1- <1-
0- o-
I I

0Q 0Q
C." C."

 

 

 

 

09
Cl)-

 

 

Fig. 3. CAVIAR-Gene adjusts for population structure. Panel a illustrates the case where the data have population structure and the statistics is not corrected for
the population structure. Panels b and c illustrate the cases where we have corrected the statistics for the population structure. However, in Panel b, we compute
the correlation between the original genotypes and in Panel c the correlation is computed from the transformed genotypes. Then, we calculate the difference be-
tween the correlation computed from the marginal statistics for each pair of variants and the correlation of the genotype of the same variants. The difference be-
tween the correlation of the marginal statistics and the correlation of the transformed genotype shown in Panel c is close to zero and their variance is much
smaller than other cases as shown in Panels a and b. To compare the results, we plot the residual difference between —0.4 and 0.4, as a result some points for

Panel b are not shown

112 /§JO'S{12u1no [p.IOJXO'SOTlBIIIJOJUTOTQ/ﬁdllq 111011 pop1201umoq

9IOZ ‘09 lsnﬁnv uo ::

CA VIAR-Gene

i213

 

HMDP CG

-: 11111313 151.. .

   

Outbred

Fig. 4. Venn diagram of the genes selected by CAVIAR-Gene on each of the
dataset. HMPD ALL is the results of CAVIAR-Gene on HMDP when we utilize
all the genes. HMDP CG is the result of CAVIAR-Gene on HMDP when we util-
ize candidate genes

4 Discussion

In this article, we propose a novel method, CAVIAR—Gene, for per—
forming fine mapping on the gene level. CAVIAR—Gene computes the
probability of each set of genes capturing the true causal genes. Then,
CAVIAR—Gene selects the set which has the minimum number of
genes selected as causal and the probability of the set capturing the
true causal gene is higher than a user—defined threshold (e.g. typically
95 % or higher). We note that the usage of the term causal has little to
do with the concept of causal inference as described in the computer
science and statistics literature (Pearl, 2000; Spirtes et al., 2000). In the
context of association studies, we consider a variant to be causal if the
variant is responsible for the association signal in the locus. CAVIAR—
Gene can incorporate marginal statistics which is corrected for popula—
tion structure. This property makes CAVIAR—Gene suitable for
performing fine mapping on the model organism such as inbred mice.
We show using simulated data that CAVIAR—Gene has higher recall
rate compared with the existing methods for fine mapping on the vari-
ants level, while the size of the causal set selected by CAVIAR—Gene is
smaller than these methods. CAVIAR—Gene incorporates external in—
formation such as functional data as a prior to improve the results.

Funding

This work was supported by the National Science Foundation (0513612,
0731455, 0729049, 0916676, 1065276,1302448, and 1320589 to F.H., W.Y.,
and BE.) and the National Institutes of Health (K25-HL080079, U01-
DA024417, P01-HL30568, P01-HL28481, R01-GM083198, R01-
MH101782, and R01-E8022282 to F.H., W.Y., and EB). BB. is supported in
part by the NIH BD2K award, U54EB020403. We acknowledge the support of
the National Institute of Neurological Disorders and Stroke Informatics Center
for Neurogenetics and Neurogenomics (P30 NSO62691 and T32 NSO48004-
09). GK. and B.P. are supported in part by the National Institutes of Health
(R01 GM05 3275 ). The funders had no role in study design, data collection and
analysis, decision to publish, or preparation of the manuscript.

Conﬂict of Interest: none declared.

References

Altshuler,D. et al. (2008) Genetic mapping in human disease. Science, 322,
881—888.

Bennett,B.J. et al. (2010) A high-resolution association mapping panel for the
dissection of complex traits in mice. Genome Res., 20, 281—290.

International Multiple Sclerosis Genetics Consortium et al. (2013) Analysis of
immune-related loci identiﬁes 48 new susceptibility variants for multiple
sclerosis. Nat. Genet., 45, 1353—1360.

Darnell,G. et al. (2012) Incorporating prior information into association
studies. Bioinformatics, 28, i147—i153.

Eskin,E. (2008) Increasing power in association studies by using linkage dis-
equilibrium structure and molecular function as prior information. Genome
Res., 18, 653—660.

Flint,]. and Eskin,E. (2012) Genome-wide association studies in mice. Nat.
Rev. Genet., 13, 807—817.

Hakonarson,H. et al. (2007) A genome-wide association study identiﬁes
kiaa0350 as a type 1 diabetes gene. Nature, 448, 591—594.

Han,B. et al. (2009) Rapid and accurate multiple testing correction and power
estimation for millions of correlated markers. PLOS Genet., 5, e100045 6.
Hormozdiari,F. et al. (2014) Identifying causal variants at loci with multiple

signals of association. Genetics, 198, 497—508.

Jul,].H. and Eskin,E. (2011) Increasing power of groupwise association test
with likelihood ratio test]. Comput. Biol., 18, 1611—1624.

Kang,H.M. et al. (2008) Efﬁcient control of population structure in model
organism association mapping. Genetics, 5, e100045 6.

KichaeV,G. et al. (2014) Integrating functional data to prioritize causal vari-
ants in statistical ﬁne-mapping studies. PLOS Genet., 10, e1004722.

Kottgen,A. et al. (2013) Genome-wide association analyses identify
18 new loci associated with serum urate concentrations. Nat. Genet., 45,
145—154.

Lee,D. et al. (2013) DIST: direct imputation of summary statistics for unmeas-
ured SNPs. B ioinformatics, 29, 2925—2927.

Lippert,C. et al. (2011) FaST linear mixed models for genome-wide associ-
ation studies. Nat. Methods, 8, 833—835.

Listgarten,]. et al. (2012) Improved linear mixed models for genome-wide
association studies. Nat. Methods, 9, 525—526.

Maller,].B. et al. (2012) Bayesian reﬁnement of association signals for 14 loci
in 3 common diseases. Nat. Genet., 44, 1294—1301.

Pasaniuc,B. et al. (2014) Fast and accurate imputation of summary
statistics enhances evidence of functional enrichment. Bioinformatics, 30,
2906—2914.

Pearl,]. (2000) Causality: Models, Reasoning and Inference. V01. 29.
Cambridge University Press, New York, NY.

Price,A.L. et al. (2006) Principal components analysis corrects for stratiﬁca-
tion in genome-wide association studies. Nat. Genet., 38, 904—909.

Pritchard,].K. and Przeworski,M. (2001) Linkage disequilibrium in humans:
models and data. Am. ]. Hum. Genet., 69, 1—14.

Reich,D.E. et al. (2001) Linkage disequilibrium in the human genome.
Nature, 411, 199—204.

Ripke,S. et al. (2013) Genome-wide association analysis identiﬁes 13 new risk
loci for schizophrenia. Nat. Genet., 45, 1 150—1 159.

Spirtes,P. et al. (2000). Causation, Prediction, and Search. V01. 81. MIT press,
Cambridge, MA, USA.

van Nas,A. et al. (2009) Elucidating the role of gonadal hormones in
sexually dimorphic gene coexpression networks. Endocrinology, 150,
1235—1249.

Yang,]. et al. (2012) Conditional and joint multiple-SNP analysis of GWAS
summary statistics identiﬁes additional variants inﬂuencing complex traits.
Nat. Genet., 44, 369—375.

Zaitlen,N. et al. (2010) Leveraging genetic variability across populations for
the identiﬁcation of causal variants. Am. ]. Hum. Genet., 86, 23—33.

Zhang,W. et al. (2012) Genome-wide association mapping of quantitative
traits in outbred mice. G3 (Bethesda), 2, 167—174.

Zhou,X. and Stephens,M. (2012) Genome-wide efﬁcient mixed model analysis
for association studies. Nat. Genet., 44, 821—824.

112 /8JO'S[12u1no IpJOJXO'SOTlBIIlJOJUTOTQ/ﬂClllq 111011 pop1201umoq

9IOZ ‘09 lsnﬁnv uo ::

