Vol. 30 ISMB 2014, pages i246—i254
doi:10. 1093/bioinformatics/btu287

 

Gene network inference by probabilistic scoring of relationships
from a factorized model of interactions

Marinka Zitnik1 and Blai Zupan1’2’*

1Faculty of Computer and Information Science, University of Ljubljana, SI—IOOO Ljubljana, Slovenia and 2Department of
Molecular and Human Genetics, Baylor College of Medicine, Houston, TX 77030, USA

 

ABSTRACT

Motivation: Epistasis analysis is an essential tool of classical genetics
for inferring the order of function of genes in a common pathway.
Typically, it considers single and double mutant phenotypes and for
a pair of genes observes whether a change in the first gene masks the
effects of the mutation in the second gene. Despite the recent emer-
gence of biotechnology techniques that can provide gene interaction
data on a large, possibly genomic scale, few methods are available
for quantitative epistasis analysis and epistasis-based network
reconstruction.

Results: We here propose a conceptually new probabilistic approach
to gene network inference from quantitative interaction data. The ap-
proach is founded on epistasis analysis. Its features are joint treatment
of the mutant phenotype data with a factorized model and probabil-
istic scoring of pain/vise gene relationships that are inferred from the
latent gene representation. The resulting gene network is assembled
from scored pain/vise relationships. In an experimental study, we show
that the proposed approach can accurately reconstruct several known
pathways and that it surpasses the accuracy of current approaches.
Availability and implementation: Source code is available at http://
github.com/biolab/red.

Contact: blaz.zupan@fri.uni-Ij.si

Supplementary information: Supplementary data are available at
Bioinformatics online.

1 INTRODUCTION

Epistasis analysis is a tool of classical genetics for inferring the
order of genes in pathways from mutant-based phenotypes
(Avery and Wasserman, 1992; Botstein and Maurer, 1982).
Epistasis asserts that two genes interact if the mutation in one
gene masks the effects of perturbations in the other gene. Then,
assuming a common pathway, the ﬁrst masking gene would be
downstream, and the products of the second gene would regulate
the expression of the ﬁrst one (Avery and Wasserman, 1992;
Cordell, 2002; Huang and Sternberg, 1995; Roth et al., 2009).
Epistasis analysis uncovers the relationship between a pair of
genes. Its logic can be further extended to uncover parallelism,
where both genes have an effect on the phenotype but where
there is no epistasis (Battle et al., 2010; Zupan et al., 2003)
(Fig. l). Uncovered pairwise relationships in a group of genes
can give rise to a reconstruction of more complex multi-gene
networks. An enlightening demonstration of the power of epis-
tasis for assembly of gene networks is for instance a reconstruc-
tion of a four-gene cell death pathway in Caenorhabditis elegans
(Metzstein et al., 1998).

 

*To whom correspondence should be addressed.

Emergent technologies from molecular biology that record
phenotypes of single and double mutants at a large, possibly
genomic scale, prompt for the development of systematic
approaches for epistasis analysis and pose the need to devise
computational tools that support gene network inference.
Approaches of mutagenesis by homologous recombination
(Collins et al., 2006; Tong et al., 2004) or RNA interference
can yield phenotype observations for thousands or even millions
of mutants (Costanzo et al., 2010). Several past studies con-
sidered mutant assays with qualitative phenotypes (Zupan

(a) Epistasis

u—>U—>

   

E(1)A'wA)

R(vAwA)
 Partial interdependence

 

R(uA) \ , R(wA) ,0
§ 1 \
/
. U}
R(quA) z E(quA)
(c) Parallelism
u
\
w /
\ J
V
(d) Multi-gene network
—>
u v \
‘ /'Reporter
7.0

Fig. 1. A hypothetical example of epistasis analysis with three genes, u, v
and w. Nodes in the central graph represent mutant phenotypes. The
phenotypic difference between a double knockout [e.g. R(uAvA)] and a
single knockout mutant [e.g. R(vA)] is represented with the length of the
corresponding dotted edge. Expected double mutant phenotypes, which
assume no interaction between genes (see also Section 2.1), are denoted
with E [e. g. E(uAvA)]. A double mutant uAvA (a) has a phenotype similar
to that of a single mutant vA, which indicates that v is epistatic to u. From
the activity of genes v and w 0)) we conjecture that gene v partially de-
pends on gene w, i.e. v also acts through a separate pathway because their
double mutant vAwA has a phenotype that is equally similar to the sin-
gle knockout R(wA) and the expected phenotype E(vAwA). The pheno-
type of double knockout quA (c) is close to the expected phenotype of
quA, E(quA), which may be explained by u and w acting independ-
ently in parallel pathways. Gene ordering from these three relations is
preserved in the joint network ((1), which is a candidate pathway of genes
u, v and w

 

© The Author 2014. Published by Oxford University Press.

This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (http://creativecommons.org/Iicenses/
by-nc/3.0/), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial

re-use, please contact journals.permissions@oup.com

112 [3.10811211an[plOJXO'SODBIILIOJIITOTQ/ﬂ(11111 IIIOJJ papeolumoq

910K ‘09 isnﬁnV no :2

Gene network inference

 

et al., 2003), quantitative ﬁtness scores (Battle et al., 2010;
Beerenwinkel et al., 2007; Drees et al., 2005; Phenix et al.,
2011, 2013; St Onge et al., 2007) or even whole-genome tran-
scriptional proﬁles (Hughes, 2005; Van Driessche et al., 2005).
Majority of these studies present gene networks as collections
of directly observed pairwise interactions (e.g. Phenix et al.,
2013; St Onge et al., 2007) and do not propose a generally ap-
plicable formalism to model the data. Only few general-purpose
algorithms for inference of epistatic networks have been pro-
posed. Zupan et al. (2003) introduced formal rules and inference
algorithm to infer different types of relationships between genes,
but could treat only qualitative phenotypes and could not handle
noise. These limitations were elegantly bypassed by a Bayesian
approach of Battle et al. (2010) that can handle larger data sets
with few hundred genes. This algorithm is to our knowledge also
the only modern approach to inference of epistasis networks.

Gene epistasis analysis infers interactions that stem directly
from mutant phenotypes. Its causative reasoning is different
from other network reconstruction tools that observe correl-
ations between gene proﬁles (e.g. Ahn et al., 2011;
Mohammadi et al., 2012) and infer relationships that are circum-
stantial (Hughes et al., 2000). Despite the growing body of quan-
titative genetic interaction data and our ability to collect such
data, computational approaches and tools to support epistasis
are at best scarce (Battle et al., 2010; J aimovich and Friedman,
2011; Zhang and Zhao, 2013). Devising methods for inference of
gene pathways from mutant-based phenotypes and developing
related software tools remains a major challenge of computa-
tional systems biology.

We here present a new epistasis analysis-inspired computa-
tional approach to infer gene networks from a collection of
quantitative mutant phenotypes. We refer to our method as
Réd (pronounced as réd, meaning ‘order’ in Slovene). Our
work was motivated by the Bayesian learning method of Battle
et al. (2010), henceforth denoted by activity pathway network
(APN), that starts from a random network and then iteratively
reﬁnes it to best match data-inferred relationships. The model
reﬁnement in APN is carried out through a succession of local
structural changes of the evolving network. This procedure may
substantially depend on (arbitrary) initialization of network
structure, and hence requires ensembling across many runs of
the algorithm to raise accuracy of the ﬁnal network.

Our approach is conceptually different from APN. We ﬁrst
simultaneously infer a probabilistic model for the entire set of
pairwise relationships. Relationship probabilities serve as prefer-
ences for different types of pairwise relationships (e.g. epistasis,
parallelism and partial interdependence) used in a single-step
construction of a gene network. In contrast to APN’s local net-
work changes, Réd applies a global procedure to infer the rela-
tionships between genes and does not require ensembling. The
probabilistic model of Réd uses matrix completion-derived latent
data representation to account for noise and sparsity. Inference
of factorized model also includes construction of a gene-speciﬁc
data transformation to account for the differences in single
mutant backgrounds, which may affect the phenotype of
double mutants. In an experimental study, we show that both
components are necessary for inferring gene networks of high
accuracy.

2 MATERIALS AND METHODS

Réd, the proposed gene network reconstruction algorithm (Alg. 1), con-
siders quantitative phenotype measurements over a set of single and
double mutants, provides preferential order-of—action scores of possible
pairwise relationships and assembles them in a joint gene network. The
essential steps of the algorithm are overviewed in Figure 2 and are
described in detail below.

2.1 Problem deﬁnition

In quantitative analysis of genetic interactions we typically observe pair-
wise interactions between n genes and measure mutant phenotypes, such
as the ﬁtness of an organism or expression of a reporter gene (Reporter).
Measurements over a set of double knockout mutants are given in a
sparse matrix G 6 RM” and those of single knockout mutants in a
vector S 6 IR”. In these matrices, Gm quantiﬁes a phenotype of double
mutant uAvA and 8,, denotes a phenotype of single mutant uA. The
expected mutant phenotypes, which represent phenotypes of double
mutants in the absence of genetic interactions, are given by a matrix H.

We aim to reconstruct a gene network that is consistent with pairwise
gene relationships inferred from G, H and S. Inputs to network recon-
struction are preferential scores for all four modeled gene relationships
that include epistasis u —> v, epistasis u <— v, parallelism v| lu and partial
interdependence vAu (Table 1). Réd represents the scores as P= (P_’,
P“, P“, PA) and computes them from the latent gene representation,
which is obtained in the inference of a factorized model.

uA 12A wA 2A

 

X
Input data

 

 

 

 

 

 

 

 

 

 

 

 

Gene latent
feature vectors

(k=2)

 

 

Learnt
gene-speciﬁc
functions

Preferential
order-of—action
pairwise scoring

Gene network
reconstruction

 

 

Fig. 2. An overview of Réd, a novel approach for automatic gene net-
work inference from mutant data. Inputs to the preferential order-of-
action factorized algorithm of Réd include a matrix of double knockout
phenotypes (G), a vector of single knockout phenotypes (S) and a matrix
of expected phenotypes corresponding to the assumption of absent inter-
actions between genes (H). Réd estimates a factorized model from G,
whose gene latent feature vectors capture the global structure of the
phenotype landscape, and learns a parametrized logistic map ‘I’, which
is a gene-dependent non-linear mapping from latent to phenotype space.
A scoring scheme is then applied to the inferred model to estimate the
probabilities of pairwise gene relationships of different types. Finally, a
multi-gene network is reconstructed, which aims to minimize the number
of violating and redundant edges

 

i247

112 ﬁhO'smumo[pJOJXO'sorichOJurorw/zdnq IIIOJJ papeolumoq

910K ‘09 isnﬁnV no :2

M.2itnik and B.Zupan

 

Table 1. Probabilistic scoring of gene-gene relationships

 

Gene—gene relationship

Network structure

Preferential order-of—action score

 

u and v in a linear pathway, v downstream, gene v is
epistatic to gene u

u and v in a linear pathway, u downstream, gene u is
epistatic to gene v

u and v affect the reporter separately

u and v are partially interdependent, each has also a
path to the reporter that is independent of the other

U

Q

€4—Q

2

—> —> P_’ = —A
v u’v 1+exp (IGu,v_Svl)

 

P(— = +
‘— u . 1] “av 1+CXp (IGu,v_Su|)
\ P“ = ,4
/' uav 1+exp (IGu,v—Hu,v|)
\ PA = A 2
/ usv 1+CXp(|Gu,v—%(Hu,v+ma-X(Sussv))|)

 

Given genes u and v, the table shows all four pairwise relationships and their corresponding network structures. These relationships have already been considered by Battle
et a]. (2010) but are here studied with probabilistic scoring functions. See main text for explanation of preferential order-of-action scores.

2.2 Factorized model

To deal with noise and address possibly incomplete input data, Réd es-
timates probabilities of gene relationships through a factorized model.
We use a Bayesian inference approach and formulate the conditional
probability of observed double mutant phenotype data, given their
latent representation, as follows:

19(GIU, V. ‘1'. 03;) = H H(N(Gu,vig(U5Vv; rm), 00%,

u=1v=1

where N(x|u, 02) is a normal distribution with mean ,u and variance 02,
and v indicates whether the phenotypic measurement of uAvA is
available.

We assume that the observed phenotype of uAvA is governed by the
latent features associated with both genes u and v. To learn the latent
features of u and v, we factorize double mutant phenotype data (G) into a
product of two low-dimensional latent matrix factors U10” and VkX”.
Their column vectors, U, and Vv, represent k—dimensional u-speciﬁc
and v-speciﬁc gene latent feature vectors, respectively. Instead of using
linear latent Gaussian model of gene interactions, we pass the dot product
UuTVv through a parametrized logistic function g. Thus, the model of
interaction between genes u and v is represented by the factorized par-
ameter gﬂJuTVv; Tm). In the factorization, gene interactions depend on
each other, as they overlap and share parameters. For instance, given
genes u, v and w, their factorized parameters gﬂJuTVv; Tm) and g(UuTVw
; me) share a common gene latent feature vector Uu.

Parametrized logistic function g is given by

$6)

, (1) (2) (3) :—
g(x,(0 ,W ’10 ) 1+w(1)exp (_¢(2)x)

and bounds the range of factorized parameters by modeling saturation of
the Reporter. Here, parameter 10(3) represents the limiting value of the
output past that g(x; 10(1), 10(2), 10(3)) cannot grow and (0(1) represents the
number of times that UuTVv must grow to reach the value of 10(3). If 10(2) is
positive, g is increasing in x, otherwise g is a decreasing function. Note
that g(x; 1, 1, 1) corresponds to the well-known sigmoid function. For
every double mutant uAvA, we represent its logistic function parameters
in a triple Tm = (T33, T33, T53) and deﬁne T to hold the parametrized
logistic function representation over all possible double mutants:
T=(T(1), Ta), Tm). We reduce the complexity of this factorized
model in Section 2.3 by replacing dense parametrization of T (one par-
ameter set for every factorized parameter, |T| = 3112) with gene-dependent
parametrization (one parameter set for every gene, |T| = 3n).

We use a Gaussian prior centered at 1 for logistic function paramet-
rization T over given phenotypic measurements:

3 n n
17(‘I’I03p)= H H H(N(‘P$?.I1,a§.1»’3v.

i=1u=1v=1

For gene latent feature vectors in U and V we assume zero-mean
Gaussian priors to avoid overﬁtting:

p(U|a%) = H Nam 0%1),p(V|a%) = H mm, 0%1).
u=1 V21

Through Bayesian inference we derive the posterior probability of gene
latent vectors and logistic function parametrization given the available
double mutants phenotypes:

p(U, V, T|G, 0%}, 0%, 0%,, 031,) cc p(G|U, V, T, 0%)p(U|0%)
p(V|0%)p(‘P|03p)-

We select the factorized model according to the maximum a posteriori
(MAP) estimation by maximizing the log-posterior of Equation (1) over
latent feature matrices and logistic function parametrization. The meas-
urement noise variance (0%) and prior variances (0%, 0%, and 031,) are kept
ﬁxed. This is equivalent to minimizing the following objective function
(see Supplementary Material for a detailed derivation of a MAP estima-
tor), which is a sum of squared errors with quadratic regularization terms:

(1)

1 n n
£(G, U, v, T) = E ZZIE,(G,,, — g(va,; Tu,v))2

u=1v=1
AU " T AV " T
+ 7X3UuUu+ TZVVV, (2)

u=1 v=1

3 n n
+ $2222.03}. — 1r.
i=1u=1v=1
where AU = 0é/0ﬁ, AV = 0é/0%, and )up = 0é/031,.

Because T, U and V are unknown, the function £ is not convex. In
particular, £ is convex in either U or V but not in both factors together,
which is a known result from matrix factorization studies (Koren et al.,
2009; Lee and Seung, 2000). In our study, £ is further coupled by the
parametrization of T. Thus, it is unrealistic to expect an algorithm to
solve the optimization problem deﬁned by £ in the sense of ﬁnding
global minimum. We thus estimate latent features and logistic function
parameters by ﬁnding a local minimum of the objective function £ through

 

i248

1e [3.10811211an[p.IOJXO'SODBIIIJOJIIIOIQ/[Z(11111 IIIOJJ papeolumoq

910K ‘09 isnﬁnV uo ::

Gene network inference

 

application of gradient descent. Derivatives of £ with respect to gene latent
features and logistic parameters are given by the following equations:

8£ "

 

m = Emu, v)V.g’(U,fV.; ‘1'...) +AuU... (3)
u v=1
£=ihg v)U ngv 'T )+A v (4)
aVv “=1 9 u u V9 u,v V V9
3 h , ‘1'“) ex T(2)UTV
—f,, = — (u v) 2;; §(  :3, 3) +r(u,v,1). (5)
BTW (exp (Tu’qu Vv) + T1”)

at _ Mu, v)‘P§.{%‘P£?1U5Vvexp (‘I'EfiUiva
WEE). (exp (rtiUivv) + 1'32?

 

+ t(u, v, 2), (6)

em = h(u, v)
an). 1+nfzexp (—‘I'EEIU.TVV)

 

+ t(u, v, 3), (7)

where for convenience of notation, h(u, v) is substituted for
h(u, v)=IuG’v(gaJuTVv; Tm) — Gm), penalty term t(u, v, i) stands for
t(u, v, i)=AwIEv(TS?v — 1) and g’ (x; Tm) is logistic function derivative
with respect to x. Efﬁciency in training Réd model comes from ﬁnding
point estimates of model unknowns instead of inferring the full posterior
distribution over them.

2.3 Gene-dependent weighting

We further reduce complexity of the model described in the previous
section by combining evidence from multiple phenotypic measurements
through their latent representation. We replace entrywise (double-
mutant—phenotype—dependent) logistic function parametrization T with
gene-dependent parametrization that is given by T3,), <— n+1 2W T9,, for
i = 1, 2, 3. This reduces the number of parameters in T that have to be
learned from 3n2 to 3n. Intuitively, measurements that involve gene a are
not independent from each other but are rather governed by the gene
pathways in which a participates. Gene-dependent parametrization of T
represents a method of regularization allowing us to remove penalty
terms in Equations (5)—(7).

Derivatives of T use only available phenotypic measurements owing to
the application of an indicator function [cf. Equations (5)—(7)]. We relax
this limitation by considering current estimates of G when computing the
derivatives of T. These estimates are given by G,” = g(UuTVv; Tm),
where U and V are latent matrix factors from the previous iteration of
gradient descent (Step 30 in Alg. 1).

2.4 Preferential order-of-action scoring of gene pairs

Probabilities of gene—gene relationships in P are computed from the
inferred phenotypes given by G = gaJTV; T), with the rules outlined in
Table 1. Estimated probabilities in P approach 1 when inferred pheno-
typic values in G are close to the phenotypes, which would be expected if
a certain network structure (—>, <—, H, A) existed between genes, and
they slowly vanish when the inferred values deviate from the values ex-
pected by a certain type of relationship.

For instance, an epistatic genetic interaction u <— v is inferred when the
trait Gm of the double mutant uAvA is similar to the single mutant uA
phenotype Su and the two single mutant phenotypes are different
(8,, $6 8,). This brings |GW —Su| close to 0 and, consequently, P1;
close to 1. With different single mutant phenotypes, the expected
phenotype Hm of the double mutant that assumes no genetic inter-
action is different from both single mutant phenotypes
(Su 56 S, => S, 56 HM /\ Su 56 Hm), bringing P3,, and P3,, close to 0.
Likewise, the phenotype of vA would be different from the phenotype
of the double mutant, bringing P17, close to 0.

Cases with less pronounced differences between phenotypes would lead
to smaller differences in relationship probabilities. Preferential order-of-
action scores generalize the epistasis analysis framework by Avery and
Wasserman (1992), wherein the signal and the genes under study were
strictly on or off with no intermediate levels of activity. An appealing
feature of scores in P is that they have a direct probabilistic
interpretation.

2.5 Multi-gene network inference

Given probabilistic scores of gene—gene network structures in P from
Section 2.4, we reconstruct a detailed multi-gene network that is consist-
ent with the inferred relationship probabilities and contains a minimum
number of violating and redundant edges. Examples of inferred networks
are given in Figures 4—7. A network is a weighted directed graph with
genes as vertices and directed edges that determine the order of action. A
designated vertex represents the observed quantitative trait. A directed
edge from u to v is violating (Fig. 3a) if there is evidence in P for both
a —> v and u <— v (e.g. PZV N P13). A directed edge from u to v is redun-
dant (Fig. 3b) if there is evidence in P that some intermediate gene exists
between a and v. That is, u and v are not adjacent in a genetic network but
rather a indirectly affects v, i.e. P17, captures the extent to which strict
weak ordering of u and v holds.

Network inference procedure assigns a level to every gene in a manner
that if there is strong evidence in P that gene a is placed upstream of gene
v, that is, if v is epistatic to u, then level(u)>level(v). In the case of
stronger evidence of parallelism or partial interdependence between a
and v the level(u) % level(v). Several genes can be assigned the same
level, but a designated vertex corresponding to a phenotype of interest
is the only vertex placed on the lowest level.

Inference of a genetic network involves two phases. In the ﬁrst phase
we perform an approximate topological sort through construction of a
directed weighted graph. Given genes u and v and the inferred epistasis
relationships between them, the direction and weight of a between-level
edge are determined by the maximum of the values P17”, (edge u —> v) and
P1; (edge u <— v). Given a parallelism or partial interdependence rela-
tionship between a and v, a within-level edge is determined by the max-
imum of the values PLI’V (no edge between a and v) and P3,, (edge u —> v).
This graph may contain directed cycles, and ﬁnding an exact topological
ordering of its vertices with the minimal set of violating edges is a known
NP-hard problem (Charbit et al., 2007; Eades et al., 1993). Thus, we pro-
ceed in the following way. We select a vertex with no incoming between-

<a) 5 (b) E
t t
U1 U2
I < I
'01 "U2
I I
wl U12
I I
91 92
‘ i

Fig. 3. Illustration of violating (a) and redundant (b) edges (in gray) in a
pathway with four genes. Edge y1 —> v1 is violating because there is evi-
dence that v1 is placed upstream of y1 (v1 —> M and W1 —> y1) but also
that yl is upstream of VI (yl —> v1). Edge uz —> W2 is redundant because
there is evidence of an intermediate gene V2. Similarly, edge uz —> yz is
redundant because of two intervening genes, v2 and w

 

i249

1e [3.10811211an[p.IOJXO'SODBIIIJOJIIIOIQ/[Z(11111 IIIOJJ papeolumoq

910K ‘09 IsnﬁnV uo ::

M.2itnik and B.Zupan

 

level edges, assign that vertex to the currently top-most level and recurse on
the graph with that vertex removed. We also look for vertices with no
outgoing between-level edges and assign them to the currently lowest
level. If in some step multiple vertices have no incoming or outgoing be-
tween-level edges, they are assigned the same level. It can happen that all
vertices have incoming and outgoing between-level edges. In this case, we
select the vertex with the highest differential between weighted incoming
between-level degree and weighted outgoing between-level degree.

 

Alg. 1: Réd, the proposed approach for gene network inference by scoring
relationships from a factorized model of interactions.

 

Input:

0 sparse matrix of double mutant phenotypes G e Rm“,
0 typical interaction values H e R”"”,
0 measured phenotypes of single mutants S 6 IR”,

0 parameters AU, AV, rates a and ,8, and rank k.
Output:

0 preferential order-of-action score matrices P,
0 completed matrix G,
o gene-dependent logistic function parametrization T,

o inferred gene network for a gene subset of interest.

1. Initialize U~N(0, 1W" and V~N(0, 1W".
2. Initialize W as 1m for i= 1, 2, 3.
3. Repeat until convergence:

%
w

b. UpdateU<—U—a%andV<—V—a%.

a. Compute and % with Equation (3) and (4), respectively.

C. Compute af% for i = 1, 2, 3 using Equations (5)—(7), respect-
ively. Substitute h(a, v) therein with h(a, v) =
gﬂJuTVv; Tm) — XW, where X,” = Gm if [Ev =1 and X,” =
Gm otherwise. Here, Gm is computed using the latent matrix
factors from the previous iteration.

(1. Update T“) <— Tw — 1333??» for i = 1, 2, 3.

e. Set gene-dependent weights T3,), <—  for i = 1, 2,
3 and Va, v. W

4. Compute preferential order-of—action scores Pf” for
i e {—>, <—, H, A} and Va, v using Equations from Table 1.
5. Normalize Pf” <— me/Z P11.” for i e {—>, <—, H, A} and Va, v.

6. Compute Gm = g(UuTVv;jTu,v).

. Given a gene subset of interest, infer a network (Section 2.5).

 

In the second phase of gene network inference we retain within-level
edges and those edges that link adjacent levels and are directed down-
ward. The latter procedure eliminates violating edges. As a ﬁnal step, we
remove redundant edges according to their deﬁnition above.

3 DATA AND EXPERIMENTAL SETUP

We assess the accuracy of Réd by applying our inference ap-
proach to the datasets of J onikas et al. (2009) and Surma et al.
(2013) and compare results to known or partially known net-
works. Experiments that use data from J onikas et al. closely

follow the setup by Battle et al. and use the same datasets and
reference pathways.

3.1 Mutant phenotype data

J onikas et al. (2009) measured unfolded protein response (UPR)
levels in single and double mutants to systematically characterize
functional interdependence of yeast genes with roles in endoplas-
mic reticulum (ER) folding. The dataset contains 444 genes that
caused high UPR reporter inductions. The interaction data in-
clude phenotypes of 42 240 distinct double mutants (matrix G)
corresponding to 43% of all possible double mutants. J onikas
et al. also computed typical (i.e. expected) values of genetic
interactions for every double mutant (matrix H). They con-
sidered multiplicative neutrality function (Mani et al., 2008)
and computed it using reporter levels of pairs of single mutants,
modiﬁed by a Hill function to account for the saturation of the
reporter signal.

Surma et al. (2013) considered 741 genes and observed the
growth phenotype (colony size) for all pairs of double mutants.
In total, after ﬁltering out unreliable measurements, their dataset
comprises 251383 double mutant ﬁtness scores. We computed
single mutant scores by averaging across all scores of double
mutants that included mutations of the corresponding genes.
We considered multiplicative model to calculate the expected
ﬁtness of a double mutant in the absence of a genetic interaction.

3.2 Gene pathways

We compare gene networks inferred by Réd to a number of
known or partially known cellular pathways that include genes
whose perturbations are measured by J onikas et al.:

0 The N-linked glycosylation pathway consisting of 10 genes
whose true ordering is known (Helenius and Aebi, 2004),

o The ER-associated degradation (ERAD) pathway for which
many functional interdependencies between its member
genes are known,

0 Tail-anchored (TA) protein biogenesis machinery consisting
of TA proteins important for transmembrane trafﬁcking
and the recently discovered GET pathway (Bozkurt et al.,
2009; Schuldiner et al., 2008; Stefanovic and Hegde, 2007).

We also compare Réd’s networks to well-characterized cellular
pathways of phospholipid biosynthesis whose gene mutants are
measured by Surma et al. and that include the following:

o The Kennedy pathway involved in the synthesis of phospha-
tidylethanolamine and phosphatidylcholine (PC), and

o The phosphatidylserine to PC conversion pathway.

3.3 Experimental setup

In the ﬁrst part of the experiments, we use mutant phenotype
data to qualitatively evaluate the reconstruction of ﬁve gene
pathways from Section 3.2. In the second part of the experi-
ments, we evaluate the accuracy of gene ordering through
three different setups. In the ﬁrst two setups, the data-inferred
gene ordering was compared with the known pathways. In the
third setup, we use cross-validation to estimate the accuracy of

 

i250

1e ﬁhO'spaumo[pJOJXO'soriemJOJurorw/2dnq IIIOJJ papeolumoq

910K ‘09 IsnﬁnV uo ::

Gene network inference

 

DIE2 ——> ALG8 —> ALG12

CWH41 —> OST5

 

 

T ALG5

\
/

ALG9 —> ALG6

 

\; ALG3 —> OST3 ——-

 

 

True ordering

CWH41 —> DIE2 —> ALG8 —> ALG6 —> ALG5 —> ALG12 —> ALG9 —> ALG3

OST5

OST3

 

 

Fig. 4. Gene network of the N—linked glycosylation pathway inferred by Réd. For reference, we show the true ordering of this pathway dielenius and
Aebi, 2004) as adapted from Battle et al. (2010). The inferred gene network reﬂects many correct gene placements

prediction of gene interaction scores with the following
experiments:

1. Battle et al. (2010) provided 168 test gene pairs (v, a) from
common KEGG pathways (Kanehisa et al., 2008). For 21
gene pairs v is known to be upstream of a, and for 147
gene pairs v is not known to be upstream of a. Given a
gene pair, Réd predicted the probability of epistasis as
P173, / (P173, +Plfv), and the accuracy of predictions on
entire set of 168 gene pairs.

2. Using the setup from Battle et al. we evaluate the accur-
acy of prediction of direct edges a —> v in the N-linked
glycosylation pathway (Fig. 4) based on the model-esti-
mated probability of epistasis P2,.

3. We estimate the accuracy when predicting that two genes
are in epistasis, that is, a —> v or v —> a. Note that in the
literature this relationship is also referred to as an alleviat-
ing interaction, where the phenotype of a double mutant is
less severe than expected from the phenotypes of the cor-
responding single mutants (J onikas et al., 2009; Mani et al.,
2008). For the data from J onikas et al. this means that the
double-mutant cell responds to ER stress surprisingly
better than how the ER stress would typically be mitigated.
The data for this experiment were preprocessed according
to the procedure described by Battle et al. A positive set
included gene pairs (a, v) with signiﬁcant alleviating genetic
interactions, for which the observed phenotype (inter-
action score) was negative with a magnitude greater than
|GW — max (Su, SV))| (see St Onge et al., 2007). It was fur-
ther required that the double-mutant phenotype data con-
tained a sufﬁcient number of observations that included aA
or VA, such that the geometric mean of such measurements
for a and for v was at least 180. There are 2723 gene pairs in
the data of J onikas et al. that match these criteria. In each
test run, we form a test set with a random selection of 5%
of the positive gene pairs and a negative set of equal size of
gene pairs that fail to satisfy the selection criteria. We
remove the test data from the interaction score matrix G,
and predict whether a test gene pair is alleviating using the
probability that a and v occur together in a linear pathway,
i.e. P17, + P;— . We report an averaged accuracy across 10

, v
different test runs.

We characterize the accuracy of predictions through the area
under the receiver-operating characteristic curve (AUC), with
a baseline of 0.5 (random networks) and a perfect score of 1.0
(inferred networks that are identical to gold standard—known
networks).

We compare Réd, our network inference approach, with a
recently published Bayesian approach by Battle et al. They de-
veloped preference scoring functions over all possible pairwise
gene relationships and applied annealed importance sampling to
reconstruct high scoring multi-gene networks. Their method
(referred here as APN) was shown to be superior to a number
of other approaches that can infer networks from gene inter-
action data by J onikas et al. These other approaches include
baseline techniques such as Pearson correlation of genetic inter-
action proﬁles and raw interaction values as well as more sophis-
ticated techniques such as Gaussian process regression (GP;
Williams and Rasmussen, 1996), a method that uses the correl-
ation of observed interaction proﬁles, the diffusion kernel
method (DK; Qi et al., 2008) and GenePath (Zupan et al.,
2003). For brevity, we therefore focus on comparing our
method with APN, which was run with default parameters as
chosen by Battle et al. for the dataset of J onikas et al., but we
also report the accuracies achieved by GP and DK.

Two essential components of Réd are latent representation of
gene interactions and their transformation through the logistic
function. To test the extent to which the performance of Réd
depends on these two components we also run experiments
where the algorithm infers probabilities and makes predictions
from raw (not factorized) phenotypes, and where the latent rep-
resentation is used without logistic transformation. We refer to
these two approaches as RAW and MF, respectively.

In all experiments with data from J onikas et al., the param-
eters of Réd are set as AU=AV=1 x 10—4, ,6=0.1, a=0.1,
k= 100. The same parameters are used on data from Surma
et al. with the exception of 0:1 x 10—3 and k = 50, which
were selected to minimize the normalized root mean square
error of  This choice of regularization parameters and learning
rates is common (cf. Min and Lee, 2005; Pedregosa et al., 2011).
We also show (see Supplementary Material; Supplementary Fig.
S4) that the performance of Réd does not critically depend on
the rank of factorization k. Réd’s optimization by gradient des-
cent is terminated when the F robenius distance between G and G
over known values fails to decrease between the two consecutive
iterations of optimization.

4 RESULTS AND DISCUSSION

4.1 Reconstruction of a known gene pathway from
data by Jonikas et al. (2009)
We analyzed the ability of Réd to reconstruct the known

N-linked glycosylation pathway. Figure 4 shows the inferred net-
work next to the known pathway as reported by Helenius and

 

i251

1e ﬁhO'spaumo[pJOJXO'soriemJOJurorw/2dnq IIIOJJ papeolumoq

910K ‘09 IsnﬁnV uo ::

M.2itnik and B.Zupan

 

Aebi (2004). Genes CWH41, DIE2 and ALG8 are correctly
placed such that they are dependent on the other genes. Also,
ALG12 is placed upstream of ALG9, which is also upstream of
ALG3. 0ST 3 is correctly placed downstream, but 0ST 5 is in-
correctly placed, likely because double—mutant data with the
other ALG genes were not available. Surprisingly, Réd correctly
placed CWH41, a gene that encodes glucosidase I, an integral
membrane protein of the ER involved in sensing ER stress
(Romero et al., 1997), at the beginning of the pathway despite
mild downstream effects observed in CWH41 mutants. Note that
the interaction proﬁle of CWH41 is only moderately correlated
with those of ALG genes, and thus, CWH41 was not clustered
together with them (J onikas et al., 2009). We hence conclude that
Réd inference of the N-linked glycans synthesis pathway was
successful with a network that closely resembles that reported
in the literature.

4.2 Reconstruction of known gene pathways from
data by Surma et al. (2013)

We applied Réd to mutant data by Surma et al. to reconstruct
two thoroughly studied pathways of phospholipid biosynthesis.
Réd’s ordering of genes in the phosphatidylserine to PC conver-
sion pathway is fully consistent with the reference pathway
(Fig. 5a). In the Kennedy pathway, Réd correctly placed PCT]
upstream of CPT] and CKI] upstream of CPT] with high con-
ﬁdence (Fig. 5b), but it misplaced gene pair PCT] and CKI]
likely owing to the ambiguity in the data. However, as Réd per-
forms global reasoning by combining evidence from all measure-
ments, it handled the data uncertainty by assigning PCT1 —>

 

 

(a) True ordering  True ordering
PSDl PSDl PCT1 CKH
CH02 CH02 CKH PCT1
OPI3 OPI3 CPTl CPI‘l

I I I I
I I I I

 

 

 

 

 

 

Fig. 5. Gene networks of the phosphatidylserine to PC conversion path-
way (a) and the Kennedy pathway 0)) as inferred by Réd. For reference,
we show the true orderings in both pathways adapted from Surma et al.
(2013). Réd correctly and with high conﬁdence (P>0.80) inferred all
three pairwise gene relationships of the PC conversion pathway. It also
correctly predicted two out of three gene relationships of the Kennedy
pathway with the wrong prediction (PCT1 —> CKIl) being assigned a low
conﬁdence G’ = 0.25)

CKIl structure the lowest score in the reconstruction of the
Kennedy pathway.

4.3 Reconstruction of partially known gene pathways

J onikas et al. (2009) identiﬁed several pathways that are import-
ant for ER protein folding. Of these, the pathways for ERAD
and TA protein insertion were considered in Battle et al. (2010).
Red-inferred networks for these two pathways are shown in
Figures 6 and 7. The solid edges in these ﬁgures are those
inferred by our algorithm, while the dotted edges indicate gene
interactions reported in the literature (Battle et al., 2010;
Carvalho et al., 2006; Clerc et al., 2009; Jonikas et al., 2009;
Kim et al., 2005; Nakatsukasa and Brodsky, 2008).

The ordering of inferred networks is entirely consistent with
the partially known gene pathways. For instance, in the network
for the ERAD pathway (Fig. 6), the upstream placement of
MNL] to YOS9 is consistent with existing data showing that
MNL] generates the sugar species recognized by YOS9 (Clerc
et al., 2009). Also, MNL], YOS9, DER] and USA] are placed
upstream of HRD3 and HRD], which is compatible with data
showing that degradation of certain substrates requires all six
components (Carvalho et al., 2006; Kim et al., 2005;
Nakatsukasa and Brodsky, 2008). For the TA protein insertion
pathway, Réd inferred a network (Fig. 7) that placed the poorly
characterized protein SGT 2 upstream of the TA protein biogen-
esis machinery components according to its function in the inser-
tion of TA proteins into membranes (Battle et al., 2010).

Similarly, positive results of network inference are also re-
ported in (Battle et al., 2010). Their method inferred a number

MDY2 

I

SGT2 YOR164C 



GET3 GETl 

I
I
n
I
n
t
I
n
I
1
n
I
l
D
"

GET2

 

b

Fig. 7. Gene network inferred by Réd that represents the likely ordering
of genes belonging to the TA protein biogenesis machinery (solid edges).
Known relationships between genes are denoted by dotted edges. Note
that the predicted ordering strongly reﬂects known interdependencies
between genes

 

 

.................................. ..

 

MNLI —>YLR104W—> YOS9 —> DERl —> USAl

i

 

""

 

/ CUEl —> UBC7   -
1112133 —> 1mm r-

 

Fig. 6. The ERAD pathway predicted by Réd is shown by solid edges. Placement of genes in the inferred network is consistent with known inter-

dependencies (dotted edges)

 

i252

1e [3.10811211an[p.IOJXO'SODBIIIJOJIIIOIQ/[Z(11111 IIIOJJ papeolumoq

910K ‘09 IsnﬁnV uo ::

Gene network inference

 

Table 2. The predictive accuracy (AUC) of gene ordering by a Bayesian
learning method [APN; Battle et al. (2010)], Réd, our proposed approach,
and its simpliﬁed variants: without factorization (RAW) and with factor-
ization but in the absence of transformation by logistic function (MF)

 

Prediction AUC

 

RAW MF APN Réd

 

KEGG pathway ordering 0.563 0.583 0.648 0.728
N—linked glycosylation pathway 0.591 0.638 0.731 0.749

 

Table 3. Prediction of unknown alleviating genetic interactions

 

Prediction AUC

 

MF DK APN GP Réd

 

Alleviating genetic interactions 0.723 0.759 0.783 0.862 0.906

 

We report the accuracy of predicted interactions based on the DK (Qi et al.), pre-
dictions based on latent representation obtained with standard two-factor matrix
factorization (MF), APNs learned through a Bayesian method by Battle et al.,
predicted genetic interaction values from GP (Williams and Rasmussen) that uses
the correlation of observed interaction proﬁles, and Réd, our proposed approach.

of candidate networks of which the best-scored were shown to be
partially consistent with known gene interdependencies. In con-
trast, for each pathway, Réd inferred a single network that is
entirely consistent with known gene relationships.

4.4 Quantitative analysis of gene ordering

Table 2 reports the accuracies of gene ordering prediction ob-
tained by four different algorithms, Réd, APN and two simpli-
ﬁed variants of Réd. In comparison with APN, Réd performs
substantially better in predicting the edges of the KEGG path-
ways and slightly better in predicting the edges of the N-linked
glycosylation pathway (Supplementary Figs S1 and S2).

The poor performance of the simpliﬁed variants of Réd (RAW
and MF) indicates that Réd’s latent representation inferred from
the factorized model, the non-linear logistic map and gene-
dependent weighting are the essential components of Réd.
Without any of these, Réd would not be able to achieve the
resulting accuracy.

4.5 Prediction of alleviating genetic interactions

Given the training and separate test datasets, we predict whether
an interaction is alleviating (see Section 3.3). Table 3 shows that
Réd performs substantially better than APN (P<0.001). Réd
also outperforms standard two-factor matrix factorization
(MF) by a large margin, which is an indicator that transform-
ation via a logistic map is essential to the performance of our
algorithm. We compare these results with those obtained by GP
Williams and Rasmussen, 1996) using squared exponential auto-
correlation model constructed from the genetic interaction pro-
ﬁles, and with the interactions predicted with the DK (Qi et al.,

2008). Réd achieves signiﬁcantly higher accuracy than GP
(P<0.01) and DK (P<0.001), although the difference with GP
is small and may be worthy of further study. Note that RAW, a
Réd variant without factorization, is not applicable for this ex-
periment, as it does not generalize across gene interaction scores.

We have observed that the probabilities of alleviating gene
pairs predicted by Réd are well correlated to the strength of
alleviating interactions (Spearman r= — 0.704, P <1 x 10—100;
Supplementary Fig. S3). Réd scores gene pairs with stronger
alleviating effects (negative interaction values with greater mag-
nitude) higher than those that interact moderately.

5 CONCLUSION

Réd is a conceptually new approach for inference of gene net-
works from quantitative genetic interaction data. It implements a
probabilistic epistasis analysis and assembles pairwise relation-
ships into gene networks. In our experiments, Réd was able to
reconstruct several known and partially known pathways with
accuracy above that of the state-of-the—art approaches. Réd out-
performs APN, the state-of-the—art method by Battle et al.
(2010), both in accuracy and speed, with CPU runtime of only
a few minutes compared with APN’s 30 min for an inference of a
single full network in an ensemble of 500 networks. We also
show that Réd’s power of generalization comes from its two
key components, a factorized model with latent representation
of gene interactions and a gene-dependent logistic map of inter-
action scores.

Our evaluation in this article was computational and thus
limited to datasets for which several gene pathways or at least
partial gene orderings were available (Battle et al., 2010; J onikas
et al., 2009). Réd can efﬁciently handle similar datasets as well as
much larger ones, such as that from the recent yeast experiments
by Costanzo et al. (2010). These are also the datasets for which
we foresee future applications of Réd and which will require
subsequent veriﬁcation of inferred networks in the wet lab.

ACKNOWLEDGEMENTS

We would like to thank Uros Petrovic for recommending the
data set by Surma et al. (2013).

Funding: This work was supported by the grants from the
Slovenian Research Agency (P2-0209, J2-5480), EU FP7
(Health-F5-2010-242038), NIH (P01-HD39691) and the
Fulbright Scholarship (BZ).

Conﬂict of Interest: none declared.

REFERENCES

Ahn,J. et al. (2011) Integrative gene network construction for predicting a set of
complementary prostate cancer genes. Bioinformatics, 27, 1846—1853.

Avery,L. and Wasserman,S. (1992) Ordering gene function: the interpretation of
epistasis in regulatory hierarchies. Trends Genet., 8, 312—316.

Battle,A. et al. (2010) Automated identiﬁcation of pathways from quantitative gen-
etic interaction data. Mo]. Sys. Biol., 6, 379.

Beerenwinkel,N. et al. (2007) Analysis of epistatic interactions and ﬁtness land-
scapes using a new geometric approach. BM C Evol. Biol., 7, 6.

Botstein,D. and Maurer,R. (1982) Genetic approaches to the analysis of microbial
development. Anna. Rev. Genet., 16, 61—83.

 

1e [3.10811211an[p.IOJXO'SODBIIIJOJIIIOIQ/[Z(11111 IIIOJJ papeolumoq

910K ‘09 IsnﬁnV uo ::

M.2itnik and B.Zupan

 

Bozkurt,G. et al. (2009) Structural insights into tail-anchored protein binding
and membrane insertion by Get3. Proc. Natl Acad. Sci. USA, 106,
21131—21136.

Carvalho,P. et al. (2006) Distinct ubiquitin-ligase complexes deﬁne convergent path-
ways for the degradation of ER proteins. Cell, 126, 361—373.

Charbit,P. et al. (2007) The minimum feedback are set problem is NP-hard for
tournaments. Comb., Probab. Comput., 16, 1—4.

Clerc,S. et al. (2009) Htrnl protein generates the N-glycan signal for glycoprotein
degradation in the endoplasmic reticulum. J. Cell Biol, 184, 159—172.

Collins,S.R. et al. (2006) A strategy for extracting and analyzing large-scale quan-
titative epistatic interaction data. Genome Biol, 7, R63.

Cordell,H.J. et al. (2002) Epistasis: what it means, what it doesn’t mean, and stat-
istical methods to detect it in humans. Hum. Mol Genet., 11, 2463—2468.

Costanzo,M. et al. (2010) The genetic landscape of a cell. Science, 327, 425—431.

Drees,B.L. et al. (2005) Derivation of genetic interaction networks from quantitative
phenotype data. Genome Biol, 6, R38.

Eades,P. et al. (1993) A fast and effective heuristic for the feedback are set problem.
Inf. Process. Lett., 47, 319—323.

Helenius,A. and Aebi,M. (2004) Roles of N-linked glycans in the endoplasmic
reticulum. Anna. Rev. Biochem., 73, 1019—1049.

Huang,L.S. and Sternberg,P.W. (1995) Genetic dissection of developmental path-
ways. Methods Cell Biol, 48, 97—122.

Hughes,T.R. (2005) Universal epistasis analysis. Nat. Genet., 37, 457—457.

Hughes,T.R. et al. (2000) Functional discovery via a compendium of expression
proﬁles. Cell, 102, 109—126.

Jaimovich,A. and Friedman,N. (2011) From large-scale assays to mechanistic
insights: computational analysis of interactions. Curr. Opin. Biotechnol, 22,
87—93.

Jonikas,M.C. et al. (2009) Comprehensive characterization of genes required for
protein folding in the endoplasmic reticulum. Science, 323, 1693—1697.

Kanehisa,M. et al. (2008) KEGG for linking genomes to life and the environment.
Nucleic Acids Res., 36 (Suppl. 1), D480—D484.

Kim,W. et al. (2005) Yos9p detects and targets misfolded glycoproteins for ER-
associated degradation. Mol Cell, 19, 753—764.

Koren,Y. et al. (2009) Matrix factorization techniques for recommender systems.
Computer, 42, 30—37.

Lee,D.D. and Seung,H.S. (2000) Algorithms for non-negative matrix factorization.
In: Advances in Neural Information Processing Systems. MIT Press, Denver,
Colorado, pp. 556—562.

Mani,R. et al. (2008) Deﬁning genetic interaction. Proc. Natl Acad. Sci. USA, 105,
3461—3466.

Metzstein,M.M. et al. (1998) Genetics of programmed cell death in C. elegans: past,
present and future. Trends Genet., 14, 410—416.

Min,J.H. and Lee,Y.C. (2005) Bankruptcy prediction using support vector machine
with optimal choice of kernel function parameters. Expert Syst. Appl, 28,
603—614.

Mohammadi,S. et al. (2012) Role of synthetic genetic interactions in understanding
functional interactions among pathways. Pac. Symp. Biocomput., 17, 43—54.
Nakatsukasa,K. and Brodsky,J.L. (2008) The recognition and retrotranslocation of

misfolded proteins from the endoplasmic reticulum. T raﬂic, 9, 861—870.

Pedregosa,F. et al. (2011) Scikit-learn: machine learning in Python. J. Mach. Learn.
Res., 12, 2825—2830.

Phenix,H. et al. (2011) Quantitative epistasis analysis and pathway inference from
genetic interaction data. PLoS Comput. Biol, 7, 61002048.

Phenix,H. et al. (2013) Identiﬁability and inference of pathway motifs by epistasis
analysis. Chaos, 23, 025103.

Qi,Y. et al. (2008) Finding friends and enemies in an enemies-only network: a graph
diffusion kernel for predicting novel genetic interactions and co-complex mem-
bership from yeast genetic interactions. Genome Res., 18, 1991—2004.

Romero,P.A. et al. (1997) The yeast CWH41 gene encodes glucosidase I.
Glycobiology, 7, 997—1004.

Roth,F.P. et al. (2009) Q&A: epistasis. J. Biol, 8, 35.

Schuldiner,M. et al. (2008) The GET complex mediates insertion of tail-anchored
proteins into the ER membrane. Cell, 134, 634—645.

St Onge,R.P. et al. (2007) Systematic pathway analysis using high-resolution ﬁtness
proﬁling of combinatorial gene deletions. Nat. Genet., 39, 199—206.

Stefanovic,S. and Hegde,R.S. (2007) Identiﬁcation of a targeting factor for post-
translational membrane protein insertion into the ER. Cell, 128, 1147—1159.

Surma,M.A. et al. (2013) A lipid E-MAP identiﬁes be2 as a critical regulator of
lipid saturation and lipid bilayer stress. Mol Cell, 51, 519—530.

Tong,A.H. et al. (2004) Global mapping of the yeast genetic interaction network.
Science, 303, 808—813.

Van Driessche,N. et al. (2005) Epistasis analysis with global transcriptional pheno-
types. Nature Genetics, 37, 471—477.

Williams,C.K. and Rasmussen,C.E. (1996) Gaussian processes for regression. In:
Advances in Neural Information Processing Systems. MIT Press, Denver,
Colorado, pp. 514—520.

Zhang,X.D. and Zhao,X.M. (2013) Computational approaches for identifying sig-
naling pathways from molecular interaction networks. Curr. Bioinform., 8,
56—62.

Zupan,B. et al. (2003) GenePath: a system for automated construction of genetic
networks from mutant data. Bioinformatics, 19, 383—389.

 

i254

1e ﬁrespaumo[pJOJXO'soriemJOJurorw/2dnq IIIOJJ papeolumoq

910K ‘09 IsnﬁnV uo ::

