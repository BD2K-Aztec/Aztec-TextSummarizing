Bioinformatics, 32(4), 2016, 523—532

doi: 10.1093/bioinformatics/btv568

Advance Access Publication Date: 26 October 2015
Original Paper

 

Gene expression

MT—HESS: an efficient Bayesian approach for
simultaneous association detection in OMICS
datasets, with application to eQTL mapping in
multiple tissues

Alex Lewin1'2'T, Habib SaadiZ'T, James E. Peters3'”,
Aida Moreno-Moral“, James C. Lee3, Kenneth G. C. Smith3,
Enrico Petrett05'6, Leonardo Bottolo7'8'* and Sylvia Richardson4'*

1Department of Mathematics, Brunel University London, 2Department of Epidemiology and Biostatistics, Imperial
College London, London, 3Cambridge Institute for Medical Research, University of Cambridge, Cambridge, 4MRC
Biostatistics Unit, Cambridge Institute of Public Health, Cambridge, 5MRC Clinical Sciences Centre, Imperial College
London, London, UK, 6Duke-NUS Graduate Medical School, Singapore, Singapore, 7Department of Mathematics,
Imperial College London, London, UK and 8Department of Medical Genetics, University of Cambridge

*To whom correspondence should be addressed.

TThe authors wish it to be known that, in their opinion, these authors should be regarded as Joint First Authors.
1The authors wish it to be known that, in their opinion, these authors should be regarded as Joint Second Authors.
Associate Editor: Janet Kelso

Received on December 5, 2014; revised on June 26, 2015; accepted on September 3, 2015

Abstract

Motivation: Analysing the joint association between a large set of responses and predictors is a
fundamental statistical task in integrative genomics, exemplified by numerous expression
Quantitative Trait Loci (eQTL) studies. Of particular interest are the so—called 'hotspots', important
genetic variants that regulate the expression of many genes. Recently, attention has focussed on
whether eQTLs are common to several tissues, cell—types or, more generally, conditions or whether
they are specific to a particular condition.

Results: We have implemented MT—HESS, a Bayesian hierarchical model that analyses the associ—
ation between a large set of predictors, e.g. SNPs, and many responses, e.g. gene expression, in mul—
tiple tissues, cells or conditions. Our Bayesian sparse regression algorithm goes beyond 'one—at—a—
time' association tests between SNPs and responses and uses a fully multivariate model search
across all linear combinations of SNPs, coupled with a model of the correlation between condition/
tissue—specific responses. In addition, we use a hierarchical structure to leverage shared information
across different genes, thus improving the detection of hotspots. We show the increase of power re—
sulting from our new approach in an extensive simulation study. Our analysis of two case studies
highlights new hotspots that would remain undetected by standard approaches and shows how
greater prediction power can be achieved when several tissues are jointly considered.

Availability and implementation: C++ source code and documentation including compilation
instructions are available under GNU licence at http://MMAN.mrc—bsu.cam.ac.uk/softwarel.

Contact: sylvia.richardson@mrc—bsu.cam.ac.uk or Ib664@cam.ac.uk

Supplementary information: Supplementary data are available at Bioinformatics online.

 

 

112 /§JO'S{eumo [p.IOJXO'SOleIHJOJUIOIQ/ﬁdllq 11101; popeoIII/vxoq

9IOZ ‘09 lsnﬁnv uo ::

©The Author 2015. Published by Oxford University Press. 523
This is an Open Access article distributed under the terms of the Creative Commons Attribution License (http://creativecommons.org/licenses/by/4.0/), Which permits
unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.

524

A.Lewin et al.

 

1 Introduction

Integrating different layers of genomic information is essential to im—
prove our understanding of the genetic basis of complex diseases.
The development of integrative analysis strategies has become an
important part of experimental design in the era of next—generation
genomics (Hawkins et al., 2010). A fundamental task faced by many
integrative strategies in genomics is to study the associations be—
tween two high—dimensional datasets. The study of such associations
and the related biological questions can be naturally built within a
regression framework, which exploits prior biological knowledge on
the direction of the relationships between the different layers of gen—
omics data.

One prime example is expression quantitative trait loci (eQTL)
analysis, which links DNA polymorphisms to gene expression levels
on a genome—wide basis. Typically, such analyses would involve test—
ing for association of all transcript—SNP pairs. When eQTL studies
involve large numbers of variants and genes, performing millions of
such tests can become slow and it has been necessary to develop fast
implementations (Shabalin, 2012). To go beyond such ‘one at—a—
time’ strategies, eQTL mapping can be performed using high-dimen-
sional regression models with expression measurements modelled as
responses and genetic variants as predictors (Bottolo et al., 2011;
Fusi et al., 2012; Scott—Boyer et al., 2012). The high-dimensional re-
gression framework leverages information across the set of re—
sponses that are related to the same predictor, increasing the
probability of detecting hotspots, i.e. genomic loci that regulate sev—
eral genes at once.

There is currently much interest in dissecting tissue, cell type or
condition specificity of eQTLs (Fairfax et al., 2012; Lee et al., 2014;
Melé et al., 2015; Raj et al., 2014; Westra et al., 2013). The multiple
tissues or cell types add an extra dimension to the data. For instance,
analysis of eQTLs across multiple tissues or cell types can inform to
which extent eQTLs are shared (or conserved) between different sys—
tems, therefore elucidating fundamental genetic regulatory mechan—
isms. So far these questions have been addressed using one of two
alternative approaches. The first uses separate analysis for each tis—
sue, and intersects the resulting lists of genetic variants (Fairfax
et al., 2012). The second approach (Flutre et al., 2013; Petretto et
al., 2010) combines tissues but performs a separate analysis for each
predictor (genetic variant) and response (gene expression level).
Neither approach fully exploits the data available, nor both can re—
sult in a loss of power to detect small effect eQTLs that are shared
across conditions. To the best of our knowledge, there is currently
no alternative method that goes beyond ‘one—at—a—time’ association
tests and models simultaneously the expression of multiple genes
under multiple conditions in a multivariate way.

In this article, we propose a generic Bayesian variable selection
approach and an associated evolutionary stochastic search algo—
rithm to tackle the challenging integrative task of linking parallel
high-dimensional multivariate regressions in a computationally effi—
cient way. The specificity of our approach is: (i) to move away from
single feature at—a—time analysis and account for the correlated na—
ture of the predictors by implementing a fully multivariate model
search over the space of predictors (ii) to allow the analysis of multi-
dimensional responses, and (iii) to exploit the relatedness of multiple
responses through a Bayesian hierarchical model. Hierarchical mod-
elling of expression responses allows us to exploit the potential func—
tional relationships (e.g. co—regulation relationship, mRNA—mRNA
interactions, protein—protein interactions, etc.) between multiple
genes, thus increasing the power to detect hotspots. We build on our
previous work (Bottolo et al., 2011; Petretto et al., 2010),

demonstrate the power of our new efficient hierarchical implemen-
tation in an extensive simulation study when compared with
MANOVA or the intersection of condition/tissue—specific results.
We also illustrate the benefits of our approach in two case studies
related to eQTLs in multiple conditions (tissues or cell types), where
we recapitulate previously validated hotspots and uncover new hot—
spots. In one case study, we also show that when several tissues are
jointly considered the prediction error is substantially reduced com—
pared with separate single—tissue analysis.

Even though our case studies relate to eQTL analyses, the model
and algorithm that we present are generic and can be used for a large
range of integrative genomics analyses that can be formulated within
a parallel regression framework, such as finding targets for miRNAs
by regressing gene expression levels on miRNA levels (Stingo et al.,
2010), linking DNA variation and metabolites levels, the so—called
mQTL analyses (Marttinen et al., 2014), or linking copy number al-
terations and tumour gene expression (Kristensen et al., 2014).

2 Modelling approach

We describe here in a non—technical fashion how we model the asso—
ciation between multiple responses, here the expression of genes in
different conditions (e.g. tissues, cell—types, disease states, etc.), and
many predictors, here the SNPs. We present a Bayesian variable se—
lection method that acts simultaneously on three levels:

1. Each response in each tissue is sparse—regressed on all the
predictors.

2. The sparse regressions from all tissues for the same response are
performed jointly as a multi—variate regression, modelling the
correlation between tissues, with the same predictors selected
for controlling the response in all tissues.

3. The multi—tissue regressions across all responses are inﬂuenced by
shared prior parameters that encourage borrowing of information.

Combining information between tissues allows us to boost signal in
a robust way because the residual correlation is modelled accurately
by latent covariance matrices.

The first level is the key driver of the method. This single re—
sponse variable selection is accurately described in Bottolo and
Richardson (2010). Building on a sparse formulation, this level of
analysis eliminates all predictors for which the signal is not strong
enough. The model takes into account the correlation between pre—
dictors to better identify the best supported combination of pre—
dictors. The performance of this method is illustrated in Bottolo and
Richardson (2010) and Bottolo et al. (2013), and it shows a major
improvement over univariate and commonly used penalized regres—
sion methods used in the ‘large p, small n’ framework in terms of
separation between signal and background noise, and in terms of
genetic resolution as it can handle the highly correlated predictors
that result from linkage disequilibrium (LD).

The second level is built on top of this variable selection, in the
sense that evidence from all the tissues influences the probability for
a predictor to be selected. This strong assumption is reasonable only
when considering a small number of correlated traits for which evi—
dence of joint control is interesting to quantify. Note that once a
predictor is selected, tissue—specific regression coefficients can be
estimated from the posterior distribution.

The third level pools information across all responses in order to
enhance the detection of hotspots. It also has the great benefit of
eliminating many false positives. The performance of this choice of
prior was explored in Bottolo et al. (2011).

112 /§JO'Sjeumo [p.IOJXO'SSUBUHOJUIOIQ/ﬁdllq 11101; popeoIII/vxoq

9IOZ ‘09 lsnﬁnv uo ::

MT—HESS: Multi—Tissue Hierarchical Evolutionary Stochastic Search

525

 

3 Methods

3.1 Bayesian hierarchical sparse regressions

Our model is an extension of HESS algorithm (Bottolo et al., 2011;
Richardson et al., 2010) to the case where the response variables are
observed in multiple conditions, e.g. in different tissues, cell types or
time points.

We consider q response variables observed in r different condi—
tions. In the following, we will use upper—case letters for matrices
and lower—case letters for vectors and scalars. For la : 1,. ..,q, let
Yk be an n X r matrix, whose entry yikg is the response la measured in
condition E for individual i. The explanatory variables are stored in
an n x p matrix X such that x,,- is the jth explanatory variable meas—
ured in individual i. The association between the explanatory vari—
ables and the responses is modelled through c] linear regressions
linked by a hierarchical model. Each of the q regression equations is
given by

Yk — Ak — XBk N Nam 2k):

where the matrix of regression coefficients B k is of size p X r, whose
generic element ﬂkl'g is the regression coefficient relating x,- to yk in
condition E. Finally, N(In,2k) is the matrix normal distribution
with independent rows, and columns correlated according to the
r X r covariance matrix 2k (Brown et al., 1998). The intercept Ak
and the between—conditions covariance matrix 2k are specific to
each response la. To perform variable selection, we introduce a bin—
ary matrix F of size q x p such that ykl- : 0 implies ﬂw : 0 for all E
and ykl- : 1 implies ﬂw 7A 0 for for all E. For a given la, we denote by
we the row binary vector (1%,“ . , ykp) with the number of its non-
zero entries given by |yk|. The matrix XWe of size n X |yk| is obtained
by selecting from the matrix X all the columns i such that we, : 1.
Similarly, we define By,a to be the matrix of non—zero coefficients of
dimension |yk| X r obtained by selecting from the matrix Bk all the
rows i such that we, : 1.

Conditionally on F, A1, . . . ,Aq, B1, . . . ,Bq and Z1, . . .,Zq, the q
sparse regressions

Yk — A, — kaByk ~ N(I,,, 2,)

are independent, and their joint likelihood is given by

q r —n/2 1 1
(an) 12;.» exp{ 7am; ><
k=1

T
(Yk — Ale _ Xan) (Yk — Ale — Xanll}

3.2 Prior settings
The prior distribution for the regression coefficients for the lath re—
sponse is the matrix—variate normal

BM lykagazk N N(g(X£XVk)—1azk)a

centred in the |yk| X r matrix of 0s, where the prior covariance of
the regression coefficients follows a g—prior (Bottolo and
Richardson, 2010). We choose for the constant Ak the non-inform-
ative prior [)(Ak) o< 1. To gain flexibility in fitting the correct
amount of shrinkage, the parameter g is learned from the data, and
its prior distribution is given by g N InvGamma(ag, bg).

For the binary matrix P, we introduce a q x p matrix Q such that
P(ykl- : 1  : wk). To favour hotspot detection while maintaining
a sparsity prior P, we decompose each cell of the matrix a) as
wk,- : wk >< pi, where the row effect wk accounts for the sparsity,
and the column effect p,- accounts for the propensity of predictor j to

be a hotspot, that is to be associated to a significant proportion of
the responses (see the following section for hotspots definition in
practical applications). The sparsity prior is given by
wk N Beta(awk,bwk) and p,- N Gamma(cpi,dpi), where w1,...,coq
and p1, . . . , )0p are all a priori independent. To enforce that wk,- is a
probability, we impose the constraint 0 3 wk X p,- g 1. The interested
reader is referred to Bottolo et al. (2011) for further information
about the multiplicative decomposition of wk,- and the sparsity priors
assigned to its components. Finally, the prior for the cross—tissue
error covariance matrix 2k is an Inverse Wishart distribution,
2k N IW(d,/akI,).

The priors we have chosen allow to integrate out the regression
coefficients Bk, the intercepts Ak and the residual cross conditions
covariances 2k. For each response la, la : 1,... ,q, the conditional
marginal likelihood is given by

P(Yk|X,Vk,g) oc (1 +g)—T|1’k|/2

1 g d+n+—2)/2
x lo In+7YTY +711 ( ’ ,
It 1+gkk1+g0k>|

where

R(Vk) = YEYk — YEXM(X3;X),.)‘1X,T Yie-

la

The joint distribution of the Bayesian model factorizes as

q
{HP(Yklxaykag)p(’l)klwkapla“‘7pp)p(wk)} X  ‘7pp)

k=1
(1)

To complete the specification of the model, we need to discuss
the hyperparameters setting for the priors. Regarding the shrink-
age parameter g, a popular choice is the Zellner—Siow prior
g N InvGamma(1 / 2, n/ 2), which allows to learn the amount of
shrinkage from the data. Theoretical results show good properties of
this prior in model selection (Liang et al., 2008), but little is known
when the Zellner prior is used in q related (multiple conditions/tis—
sues) regressions with an exchangeable shrinkage prior on g. In our
set—up we have found empirically that when q is large the level of
shrinkage is too low. We adapted the Zellner—Siow prior to related
multiple responses by taking g N InvGamma(q / 2 —l— q — 1, nq/ 2).
This corresponds to keep the same prior mode for g as in q = 1, and
at the same time increasing the precision of the prior proportionally
to the number of responses. In our experiments, this improved the
performance.

We fix cpl. : 1.2 and dpl. : 1.2 for all j, in order to centre p,- on
average around 1. This choice of parameters for the Gamma distri-
bution ensures a finite mode while allowing a large coefficient of
variation, thus providing necessary shrinkage for most pjs towards 1
but also supporting some large pjs to enhance hot—spot detection.
Alternative parameterizations cannot achieve these two competing
goals simultaneously. See Supplementary Material, Section 8.4, for a
sensitivity analysis on a simulated and real dataset. We let the par—
ameters aw,a and bwk to be chosen according to the specific dataset to
be analysed. These hyperparamters are determined by back calcula—
tion once, for each la, E(|yk|) and Var(|yk|) (respectively, the a priori
expected number of predictors and its variance for each response la)
are specified.

Finally, for the covariance matrices 212, we choose the convenient
value c123, which brings E(Zk) : ka. The choice for bk is more
complicated, as it should be comparable in size with the likely error
variance. We use the same empirical Bayes approach as in Petretto
et al. (2010), that is, for a given response la, we run a stepwise

112 /§JO'S{12umo [p.IOJXO'SOIlBIIIJOJUIOIQ/ﬁdllq 111011 pop1201umoq

9IOZ ‘09 lsnﬁnv uo ::

526

A.Lewin et al.

 

regression for each condition E = 1, . . . , r. Then we set 19k as the me—
dian of the condition—specific estimates of the error variance.

3.3 MCMC algorithm

The inference on this high-dimensional model is performed using a
specifically designed MCMC algorithm. This algorithm has already
been presented in great detail in Bottolo and Richardson (2010),
Richardson et al. (2010) and Bottolo et al. (2011), so we are simply
sketching its structure, and we refer to the relevant sources for all
the technical details.

The variables sampled are those that appear in the posterior
density (1), that is the q ><p matrix F : (1)1, . . .,yq)T, the vectors
(01, . . . , coq and p1, . . . , pp, and the parameter g. The challenging part
is the sampling of the matrices F, and this problem is solved by rely—
ing on an Evolutionary Monte Carlo (EMC) structure as introduced
in Liang and Wong (2000). To avoid being trapped in a local mode,
EMC samples several chains, each with its own temperature, and
allows them to exchange information. At each step, the chains are
updated by local moves which act on a single chain (i.e. traditional
MCMC moves), as well by global moves, which use a selection step
inspired from genetic algorithms.

In our setting, if we run the MCMC algorithm for T sweeps and
C chains, its output is given by FM), cog“), . . . ,cog’c), pg“), . . . ,pg’c)
and g“) with t : 1, ..., T and c : 1, ..., C. The parameter g has been
kept in a single chain because this setting allowed for a faster con—
vergence of our algorithm (see Bottolo et al., 2011). All the details
regarding the local moves and the global moves, as well as the tun—
ing of the temperature parameters, can be found in Bottolo and
Richardson (2010) and Bottolo et al. (2011).

The following pseudo—algorithm shows the various moves per—
formed at each iteration.

 

Algorithm 1. MCMC algorithm iteration

 

1. Sample uniformly the responses to update.
For each response la to update:
2.1 For each chain 6, update the lath row of 1”“) by using
a local move.
2.2 Update the lath row of Fm, . . . , Fm) by using a glo-
bal move.
2.3 Update (0):), . . . , (02C).
3. Update pal), . . . , p181), . . .,pgc), . . .,p,(,C).
4. Update the global shrinkage parameter g.

 

3.4 Post—processing
3.4.1 Declaration of associations and hotspots
The posterior distribution of any function of any subset of model
parameters can be calculated straightforwardly in the MCMC
estimation of the model. Since the model includes explicit variable
selection parameters (ykj), we focus on functions of those parameters
in order to summarize the evidence of association between pre—
dictors and responses.

Pairwise association between response la and predictor j is thus
quantified by the marginal posterior probability of inclusion (MPPI)

TCkl' I  I 1|Y1, . . . , Yq,X).
This quantity summarizes the evidence brought by all the data

regarding whether the predictor x,- is associated with the n X r
response Yk. It is straightforwardly estimated by the average number

of times we, : 1 during the MCMC run. In order to obtain a list of
associations of interest, we need a decision rule. The simplest choice
is to threshold on the MPPI: declare an association if n, is greater
than some threshold value c. The threshold is set according to the
user’s required balance between false positives and false negatives.
An alternative approach is to calculate the so—called Bayesian FDR
(Bro'et et al., 2004; Muller et al., 2006). For a given threshold 6, this
is defined as

Zk,j(1 — “killlﬂki > Cl

bFDR E
Ski-ﬁnk,- > c].

 

Users can either calculate the bFDR for a given threshold on the nkj,
or can set a required level of bFDR and use that to find a threshold
on the nkj. Either way, the declared pairwise associations are those
with the largest values of nkj.

In the Supplementary Material, Section 8.3, we give the true
FDR values for our simulation datasets for the decision rule defined
by setting a threshold on bFDR. We find that on average the method
is conservative, i.e. the bFDR overestimates the true FDR value in
line with the strong shrinkage of the n, resulting from our sparsity
assumptions. Thus, reported hotspots using bFDR cut—offs carry a
higher level of support than their nominal level.

For the results in this article, we use the n, to declare hotspots as
well as pairwise associations. We use a target value of the bFDR to
find a threshold on the n, to declare pairwise associations, and sub—
sequently count the number of associations for each predictor.
Other options would be to consider directly the number of associ—
ations Z}, we, for predictor j, and use the posterior mean or posterior
probability of reaching a given level to declare hotspots.

Focussing on a particular response la, it can also be of interest to
look at the whole set of predictors found to be associated with that
response. For this we consider the whole vector yk. We calculate a
‘re—normalized’ estimate of posterior model probabilities for each re—
sponse, see Supplementary Material, Section 8.2, for details.

3.4.2. Model adequacy

In this section, we describe the Bayesian implementation of leave—
one—out prediction error and model adequacy (Gelfand et al., 1992).
For ease of notation, in the following we bypass the subscript E
that indicates the condition/tissue under investigation. Let
gig : {325 :B : maxtp(y,(:)|Yk,X)} be the vector of the best model
visited during the MCMC for response la. For each response la, given
the best model visited gig and after integrating out the parameter g
numerically, we generate observations yiik from the predictive dens—
ity f (y§k|y(,)k, 1%), where yWe denote the n — 1 data vector with yik
deleted. Under model adequacy, yik is then checked against
“Vi-[ﬂy 0k, V2). Since, if the model holds, Yik is a random realization
of f(Yik|Y(,-)k, 1%), we use

A f B
We —E(Y- ly 'kaV)

gb’ikaD’i-(k) = $ (2)
Var (Yik More, if i

as checking function where E(Yi7;€|y(,-)k, gig) and @(YZQWOM, 1%) are
the empirical mean and variance calculated from the MCMC iter—
ations. For each response, squared prediction error is summed
over the sample and the quantity 2,- [g(y,-k,y§k)]2 is then used as a
measure of model adequacy with large values indicating that the
model performs poorly. This quantity resembles the widely adopted
mean—square error with the notably modification that now the dif—
ferences between the predicted and observed values are
standardized.

112 /§JO'S{12umo [p.IOJXO'SOIlBIIIJOJUIOIQ/ﬁdllq 111011 pop1201umoq

9IOZ ‘09 lsnﬁnv uo ::

MT—HESS: Multi—Tissue Hierarchical Evolutionary Stochastic Search

527

 

3.5 Simulation study

In order to investigate the performance of our multi—tissue method,
we construct an artificial dataset with three tissues and 150 re—
sponses. As in Bottolo et al. (2011), we use the whole genome data
of rat Recombinant Inbred (RI) strains derived from a cross between
the Spontaneously Hypertensive Rat (SHR) and the Brown Norway
(BN) strains, which we have used previously to identify eQTLs
across multiple tissues (Heinig et al., 2010; Hubner et al., 2005;
Petretto et al., 2006). This choice allows us to test the performance
of our algorithm and compare it with alternatives methods when
complex patterns of correlation between markers depends on gen—
etic forces that shape the structure of LD. After removing redundant
variables, the genome—wide number of SNPs is reduced to 1304, giv—
ing a 29 x 1304 X matrix.

Conditionally on the SNP matrix X, we generate responses for
each tissue from a linear model. For each tissue E, 1 3633, the
n x q matrix Yg gathering the observations of the 150 responses is
given by the regression

Yf : ){Bz + Ef + Eshareda

where B y is the p x q matrix of regression coefficients, E5 is the n x q
matrix of residuals for tissue E and EShaer is a n x q matrix of
residuals shared by all tissues. The residuals are given by
EM N N(0, 0%) and efilared N N(0, ashamed).

The matrix Bg controls the pattern and strength of signal be—
tween each responses and predictors in tissue E. For the simulations
we keep Br constant across tissues (ﬂkif : 2%,- X yki) and control the
signal—to—noise patterns through the noise variance parameters. The
pattern of non—zero associations between responses and predictors is
encoded by the matrix F of 0 s and 1 s. Because, our method is aimed
at detecting a signal that is present in different conditions, we use
the same association pattern F in all conditions. This configuration
can be seen in Figure 1 where six hotspots (vertical bars) with a
varying number of associations per hotspot are simulated. The exact
specification is given in the Supplementary Material, Section S.1.1.
The signal strength is parameterized by u, with 2%,- N N ()1, 0.0012

The signal—to—noise ratio in each tissue is tuned thorough the tis—
sue—specific noise standard deviation 07 and the ‘shared’ noise stand—
ard deviation asharcd. Assuming without loss of generality
independence of the noise variances, the total noise standard devi—
ation for tissue E is given by agoml : 0% —I— ashamed. The correlation
between tissues is proportional to the ‘shared’ noise variance and
also depends on the noise variances of the two tissues considered
(see Supplementary Material, Section S.1.2).

We have conducted an extensive investigation into the effect of
the signal—to—noise ratio imbalance across tissues and here we show
the output of the simulations for independent residuals (ashared : 0)
and correlated residuals (ashared : 0.04). In each case, we consider a
balanced case with agoml : 0.1, 1 3E g 3, and an unbalanced case
with {050ml : 0.1, 030ml : 0.2, 030ml : 0.4}. We also ran the simula—
tions with several levels of the signal strength )1. For the plots pre—
sented here we chose ,u = 0.15.

For each simulation set—up we generated nine replicates, and for
each of the datasets simulated, we ran MT—HESS analysing the three
tissues jointly and a MANOVA test (Nath and Pavur, 1985) for
each multiple tissue response—SNP pair separately. We also include
the receiver operating characteristic (ROC) curves intersecting the
results from the single—tissue version of HESS run on each separate
tissue (following Fairfax et al., 2012). We call these analyses iST—
HESS, intersection of single tissue HESS, to distinguish it from MT-
HESS, multi—tissue HESS. Associations were declared by

thresholding MPPI values for MT—HESS and ST—HESS and P—values
for MANOVA. For the intersection iST—HESS, associations are
declared positive for a given threshold if the single—tissue MPPIs ex-
ceed the threshold in all three tissues.

Figure 2 shows ROC curves for each of the four combination of
balanced/unbalanced noise across tissues and independent/corre—
lated residuals between tissues. We see that MT—HESS clearly out—
performs MANOVA in all scenarios, which confirms what has
already been shown in the literature, that is penalization methods
outperform ‘one—at—a—time’ methods (Bottolo et al., 2013), and
that borrowing information across responses improves even fur—
ther the performance (Richardson et al., 2010; Scott—Boyer et al.,
2012)

Comparison between MT—HESS versus iST—HESS also confirms
previous results (Petretto et al., 2006, 2010) that the intersection of

 

 

 

 

 

 

 

 

150 - 150 -
I II
8100 - I I 8100 - _ -
U) U) '
r: r: _ '
8 8
g; g; I - I
(I 50- (I 50-  I
r | |' | -
0 _ I I I I I I I 0 _ I I I I I I
0 200 600 1000 0 200 600 1000
SNP Index SNP Index

Fig. 1. Matrix F for the pattern of associations common to the three tissues.
The entry (k, j) of the matrix F indicates the presence of an association be-
tween SNP j and response k in all tissues. (a) Main simulation study. (b)
Study for distinguishing cis- and trans-associations

Nb of false positives Nb of false positives

190 380 570 760 950 0 190 380 570 760 95
I. . L J. J. . . I. I. L

sensitivity
sensitivity

   

— MT—HES-S ' — MT—HES-S

 

 

 

 

— MANEI'UA — MANEI'UA
0_0_- — iST—HESS OD, — iST—HESS
I I I I I I I I I I I I
0.000 0.001 0.002 0.003 0.004 0.005 0.000 0.001 0.002 0.003 0.004 0.005
1 specificity 1 speciﬁcity

(a) Balanced & Independent

(b) Balanced & Correlated

Nb of false positives

Nb of false positives

   
      

    

 

 

0 190 380 570 760 950 0 190 380 570 760 950
. I I. . L I. I. l. . . I I. . I. I. I. L .
1 0 — 1 0 —
0 8 -' ____#___— 0 8 -u _ _#
a a "’T'
E 0-6 ‘ IE 0-6 ‘
E E
(D 0.4 -I (D 0_4 _.
(I) (I)
_— — — J _I_ _—-_-
0'2 ___.—~- ——_ NIT—HESS 0'2 — NIT—HESS
— MANOVA — MHNU‘I’A
0 0 _, iS‘LHESS 0 0 _; ELHESS
I I I I I I I I I I I I
0.000 0.001 0.002 0.003 0.004 0.005 0.000 0.001 0.002 0.003 0.004 0.005
1 specificity 1 speciﬁcity

(c) Unbalanced & Independent ((1) Unbalanced & Correlated
Fig. 2. ROC curves comparing results of MT-HESS, MANOVA and iST-HESS.
Top row plots have balanced across tissues total noise standard deviation
UEOta' = 0.1, 1 g E g 3, bottom row are unbalanced with total noise standard de-
viation {atf’ta' 20.1,0't20ta' 20.2,0't30ta' :04}. Left hand column plots have
uncorrelated residuals between tissues with oshared = 0, right hand column
have ashared = 0.04

112 /§JO'S{12umo [p.IOJXO'SOTlBIIIJOJUTOTQ/ﬁdllq 111011 pop1201umoq

9IOZ ‘09 lsnﬁnv uo ::

528

A.Lewin et al.

 

tissue—specific findings is likely to be a conservative approach and is
potentially affected by variability between tissues. Specifically in the
unbalanced case, MT—HESS strongly outperforms the intersection of
separate single—tissue results. This is still evident, although less pro—
nounced, in the balanced case with independent noise. As expected,
correlated noise lower slightly the ROC curves for the multi—tissue
methods (MT—HESS and MANOVA) since it encourages propaga—
tion of false positives across all the tissues. Obviously, this does not
affect iST—HESS. Note that the balanced cases have higher signal—to—
noise ratio than the unbalanced ones, and so ROC curves for all
methods are higher.

Supplementary Material, Section S.1, shows a greater range of
simulation set—ups and detailed findings for all the methods com—
pared here, i.e. MT—HESS, MANOVA and iST—HESS. In particular,
we provide further results obtained by specifying different levels of
the signal strength )1. We illustrate how MT—HESS achieves a better
separation between noise and signal and how it allows to identify
more hotspots than traditional methods.

We now investigate the ability of the model to detect different
types of association patterns. Since the model is designed to borrow
information across responses, it is of interest to see whether the
model can also detect predictors associated with a single response,
for instance, if we can still detect cis—eQTLs. To look at this, we use
a different pattern of associations, with six markers designated as
hotspots (two each with 10, 20 and 30 responses associated) and 10
cis markers. Half the cis—associations are completely isolated, for the
other half the response is also associated with other (trans) markers.
The pattern is shown in Figure 1b. We allow the cis—associations to
be stronger than those in the hotspots, as trans—associations are ex—
pected to be weaker, thus we now have two parameters for signal
strength ucis : 0.6 and ,utrans : 0.15 with independent residuals
(ashared : 0) and balanced total noise standard deviation
agoml : 0.1, 1 3E g 3. ROC curves for these associations are very
similar to the case shown in Figure 2a (data not shown). The overall
performance for all methods considered here is slightly lower for the
new cis— and trans—association pattern, due to the lower proportion
of associations contained in hotspots.

To compare in detail cis— and trans—results, we classify the re—
sponse—predictor pairs as ‘true negative’, ‘true cis isolated’, ‘true cis
other’ and ‘true trans’ (part of hotspot). Table 1 shows the cross—
classification of ‘true’ and ‘called’ status for the three approaches
considered here. Thresholds for calling pairwise associations were
determined by fixing the true FDR level at 10%. We see that while
both MT—HESS and iST—HESS are able to detect the cis—associations
very well, the multiple tissue model is able to pick up more of the

Table 1. Classification table for marginal pairwise associations at a
true FDR level of 10%

 

 

True True cis True cis True
negative isolated other trans
MT—HESS
Negative call 195 458.2 0.0 0.0 28.2
Positive call 11.8 5.0 5.0 91.8
MANOVA
Negative call 195 469.0 0.6 4.4 120.0
Positive call 1.0 4.4 0.6 0.0
iST—HESS
Negative call 195 462.3 0.0 0.0 63.2
Positive call 7.7 5.0 5.0 56.8

 

True ositives are s lit into ‘true cis isolated’ ‘true cis other’ and ‘true
3

trans’ associations. Numbers are averages over nine replications

associations that are contained in hotspots, thus showing the benefit
of combining the tissues in a fully Bayesian way. The MANOVA
misses all hotspot associations in this example. Looking directly at
the hotspots, Table 2 shows the average estimated size of each true
hotspot (defined as number of responses called marginally): it is
clear that MT—HESS has more power to detect hotspots than iST—
HESS.

4 Results
4.1 Rat data

The rat dataset consists of multiple tissue expression and genome—
wide genotype data (N1400 SNPs) in a panel of 29 RI rat strains
(Petretto et al., 2006). Here, we focus on the multi—tissue eQTL
mapping of a previously reported Interferon regulatory factor 7
IRF7—driven inﬂammatory network (IDIN) found to be associated
with immune response and increased risk of type 1 diabetes in
humans (Heinig et al., 2010).

We used HESS to re—analyse a sub—set of the IDIN network in
three rat tissues (left ventricle, aorta and liver) focusing on 146
probe sets (corresponding to 143 protein coding genes), which are
both robustly expressed and varying in expression across the three
tissues. See Supplementary Material, Section S.5, for details of how
these genes were chosen. We ran ST—HESS separately in each tissue
and MT—HESS simultaneously across the three tissues, as well as a
MANOVA (Nath and Pavur, 1985) analysis.

We ran HESS on a 2.90—GHz Intel(R) Xeon(R) CPU computer
with 130 GB of memory for 15 000 sweeps of which 5000 as burn—
in and the same hyper—parameters as in the simulation studies.
Computational time was 70 and 114min for ST—HESS (average
across tissues) and MT—HESS, respectively. Visual inspection of the
trace of the parameters wk and p,- and g show no erratic behaviour.
Convergence is reached after few iterations due to the combined ef—
fect of the automatic tuning of the proposal density in the
Metropolis—Hastings algorithms and the parallel chains implemen-
tation which allow good mixing. Focusing on probe set—marker as—
sociations significant when using a Bayes FDR (bFDR) of 5%
(which corresponds to a MPPI > 0.8), MT-HSSS identified three loci
controlling more than 30% of the probe sets under analysis (Fig. 3).
In addition to the regulatory hotspot in rat chromosome 15q25,
which was previously identified and experimentally validated
(Heinig et al., 2010), joint analysis of the three tissues revealed two
new regulatory hotspots for the IDIN, located at marker J343641
on rat chromosome 10, and at marker SHRSPc66a05_r1_451 on rat
chromosome 1, respectively. We also investigated the associations of
IDIN network in each single tissue. ST—HESS analysis uncovered a
signal for the rat chromosome 15q25 locus in left ventricle tissue, as
previously shown (Heinig et al., 2010), but failed to identify the new
regulatory loci in chromosome 10 and 1, see Figure 3. In view of the
variability of ST—HESS between the three tissues shown in Figure 3,
we did not consider iST—HESS further as it lacks power in unbal-
anced cases.

Table 2. Average size of hotspots declared at a true FDR level of
10% on pairwise associations of 10%

 

 

True size 10 20 30

MT—HESS 5.8 17.3 24.3
MANOVA 0.0 0.0 0.0
iST—HESS 1.4 10.7 16.3

 

Numbers are averages over nine replications

112 /§JO'S{12umo [p.IOJXO'SOTlBIIIJOJUTOTQ/ﬁdllq 111011 pop1201umoq

9IOZ ‘09 lsnﬁnv uo ::

MT—HESS: Multi—Tissue Hierarchical Evolutionary Stochastic Search

529

 

Note that with the same 5% FDR threshold on P—values for
declaring associations, the MANOVA analysis does not return any
SNPs associated with five or more genes. In order to see if a
MANOVA analysis shows some of the evidence for the hotspots dis—
covered by MT—HESS, we also computed for each locus the sum
over all transcripts of the negative log P—values for the MANOVA
test (Supplementary Figure S16). This plot is very noisy, but it is
clear that the P—values contain evidence for the hotspots on chromo—
somes 10 and 15.

Given the different output produced by MT—HESS and ST—HESS,
we have also investigated their model adequacy (Gelfand et al.,
1992). We compared the two models on the basis of their leave—one—
out prediction accuracy by removing one observation at a time and
using the remaining observation for calculating the prediction error.
Following Gelfand et al. (1992) we took a fully Bayesian perspective
employing predictive distributions to evaluate model performance
by comparing model prediction with what has been observed. To be
precise, we use standardized prediction error as checking function,
as shown in Equation (2), with squared prediction error summed
over the sample as model adequacy.

Table 3 shows the value of model adequacy averaged across
probe sets. The best (shared across tissues) models {#3, . . . , 125} ob—
tained by MT—HESS have on overage smaller prediction error than
the best models identified by ST—HESS in each tissue separately. In
particular MT—HESS is able to predict better than ST—HESS in aorta
and liver tissues where ST—HESS was unable to identify any host—
post. In the left ventricle tissue, the additional two hotspots detected

 

no. of probe sets
0 20 40 60 80

 

 

_ ___ _L______2__.L_.___ _.l_.._.__L_LJ___.I_
II I

||||||
1234567891113151719

 

 

no. of probe sets
0 20 40 60 80

 

 

 

 

no. of probe sets
0 20 40 60 80

 

 

 

 

no. of probe sets
0 20 40 60 80

 

 

 

_ _..._._ ___ _- ;__.._—_—.______.._.._ __ -..a ..._ ___——

|||||||||||||||||
1234567891113151719

Fig. 3. Genome-wide Manhattan-like plots for the rat analysis showing the
number of probe sets in the IDIN network associated with each SNP accord-
ing to genomic location. The X-axis depicts chromosome number and pos-
ition. The y-axis shows the number of probe sets significantly associated with
each SNP (bFDR g 0.05). From top to bottom: results for MT-HESS, and for
ST-HESS in aorta, left ventricle and liver

by MT—HESS permit a more accurate prediction than the single ST—
HESS hotspot. Altogether, the vast majority of probe sets are better
predicted by MT—HESS: among the 32 (22%) probe sets better pre—
dicted by ST—HESS only two were declared associated at 5% bFDR
with the hotspots found by MT—HESS, showing that almost all
probe sets (51/53) controlled by MT—HESS multiple hotspots are
better predicted than by single—tissue analysis. Overall, we conclude
that the model that comprises the experimentally validated and pre—
viously undiscovered putative hotspots is a more adequate model to
explain the joint variation of the transcripts across tissues.

We comment in more details on the regulatory hotspot located
in rat chromosome 10 (rat marker J343641), which showed associ—
ation with 53 probe sets (MPPI > 0.8), representing 53 protein cod—
ing distinct genes. Enrichment analysis of transcription factor
binding sites (TFBSs) in the putative promoter of the corresponding
human orthologous genes using PASTAA (Roider et al., 2009) re—
vealed over—representation of TFBS motifs for IRF7 (adjusted
P = 3.75 X 10‘4), IRFZ (adjusted P = 2.60 x 10‘2) and NFKB (ad-
justed P = 3.19 X 10‘2) and IRFI or IRFIO (adjusted
P = 3.20 x 10_2), in keeping with the known IRF-driven regulation
of IDIN network genes (Heinig et al., 2010).

Examination of the genes in the LD block around the regulatory
locus on rat chromosome 10 (r2 > 0.8), revealed only one annotated
protein coding gene, Fox/e2, with deletion of an exon and an intron
in the Spontaneous Hypertensive Rat compared with the BN rat
(Atanur et al., 2010). Fox/22 encodes the transcription factor fork-
head box protein K2. The human orthologue FOXKZ gene is an in-
hibitor of the Sendai virus—induced IFN—ﬂ production and, at the
protein level, it forms complexes with two known interferon tran-
scriptional repressors, IRFZ (one of the transcription factors whose
binding motifs were enriched as described above) and IRF4 (Li et
al., 2011a). In view of this, we propose Fox/22 as a candidate master
regulator of the subset of the IDIN network genes whose expression
is associated with the regulatory loci located in rat chromosome 10.

4.2 Human data

The human dataset comprised genotype and corresponding expres—
sion data from three purified leukocyte subsets (monocytes, and
CD4 and CD8 T cells) isolated from the peripheral blood of 59 pa—
tients with inflammatory bowel disease (see Supplementary
Methods for full details of the cohort). Note that CD4 and CD8
T cells are both T lymphocyte subsets, whereas monocytes are from
the myeloid lineage. We ran HESS separately on each cell type, and
simultaneously on the joint dataset. The analysis was restricted to
21 788 SNPs on chromosome 5 and 3248 probesets selected by high—
est variance (see Supplementary Material, Section S.6.1) for compu—
tational feasibility. HESS was run using a burn—in of 4000 sweeps

Table 3. Leave-one-out prediction error of MT-HESS and ST-HESS
conditionally on their best models visited

 

 

MT—HESS ST—HESS MT—HESS < ST—HESS
Aorta 22.85 (3.18) 33.06 (4.49) 143 (98%)
Left ventricle 35.22 (20.31) 40.86 (15.80) 114 (78%)
Liver 23.97 (4.34) 36.88 (5.67) 143 (98%)

 

For each tissue, average model adequacy measure across probe sets is re-
ported with standard deviation in brackets. Out of 146 transcripts analysed in
the IDIN network, the number of times ST-HESS model adequacy measure is
greater than the MT-HESS one is reported in the last column with % in
brackets

112 /§JO'S{12umo [p.IOJXO'SOTlBIIIJOJUTOTQ/ﬁdllq 111011 pop1201umoq

9IOZ ‘09 lsnﬁnv uo ::

530

A.Lewin et al.

 

and values recorded for 8000 sweeps. MT—HESS took 110h on a
2.80-GHz Intel(R) Xeon(R) computer.

In the single cell type analysis, hotspots were most frequently de—
tected in CD4 T cells, followed by CD8 T cells, whereas in mono-
cytes we found a paucity of hotspot SNPs (Fig. 4). Using a 5%
bFDR, the maximum number of genes associated with a SNP in
monocytes was 6, versus 78 in CD4 T cells. There was less gene—
gene correlation in the monocyte expression data (Supplementary
Fig. S.17a—c), and this may account for the lack of hotspot detection
in this cell type.

In the joint MT—HESS analysis 28 SNPs were associated with ex—
pression of five or more genes at a 5% bFDR significance threshold,
with four of these SNPs associated with 20 or more genes
(Supplementary Fig. S.18). The signal in the joint analysis appears to
be driven predominantly by signal in either the CD4 T cells or the
CD8 T cells (Fig. 4). Unlike in the analysis of the rat data, we did
not observe any hotspots that were not detected in the single tissue
analysis. However, the number of genes associated with hotspots in
the MT—HESS analysis was not substantially diminished despite the
hotspots being highlighted mostly in one of the three cell—types
(Supplementary Fig. S.18).

We identified a putative trans master regulator SNP,
rs11745891, associated with the highest number of genes in both
the CD4 T cell and the joint analysis (78 and 71 genes, respectively).
The SNP lies in an intergenic region, N143 kB downstream from the
end of the nearest gene, PIK3R1 (phosphoinositide—3—kinase, regula—
tory subunit 1 (alpha)). Histone marks from ENCODE (Dunham
et al., 2012) suggest the SNP lies near a regulatory locus
(Supplementary Fig. S.19). Interestingly, this hotspot SNP lies
10.7kb from the start site of a long intergenic non-coding (linc)
RNA (Ensembl transcript ENST000005 07733). Emerging evidence
suggests that long non—coding RNAs play an important role in
orchestrating transcriptional programmes through a variety of
mechanisms, commonly involving ribonucleic acid—protein
interactions (Rinn and Chang, 2012). We hypothesize that our SNP
acts in cis on the lincRNA, and thus exerts its trans effects
through differential expression of the lincRNA according to
genotype.

The 78 genes whose expression in CD4 T cells was associated
with rs11745891 genotype are located on 21 chromosomes, most
frequently chromosome 1 (nine genes) (Supplementary Fig. S.20).
P-values from simple univariate regression of the expression of these
genes on rs11745 891 were skewed towards zero (range from
1.23 x 10_3 to 1.57 X 10‘8, see Supplementary Fig. S.21).

 

 

 

80 _ . 0 CD4 T cells
0 CUB T cells
+ anﬂjﬂE-S
— Jﬂlr'lt
60 -

no.01gene5

 

 

 

 

|
0 50 100 150
chr 5 position (MB)

Fig. 4. Manhattan plot for hotspot SNPs. The plot shows the number of genes
significantly associated with each SNP according to position on chromosome
5 using an MPPI threshold corresponding to a 5% Bayes FDR. Vertical purple
lines indicates results from the joint analysis. Red circles, blue diamonds and
black crosses indicate single tissue analysis in CD4 T cells, CD8 T cells and
monocytes, respectively

However, after multiple—testing of 3248 >< 217888 : 70 767 424
SNPgene pairs, using a 5% FDR threshold (Benjamini—Hochberg
procedure), none remained statistically significant, demonstrating
the strength of HESS in high-dimensional omics analysis.

The expression levels of these 78 genes were very highly corre—
lated (Fig. 5a). Strong correlation persisted in the residuals from the
simple regression of expression of these genes on rs1 1745 891 geno—
type (Fig. 5b). A strength of HESS over traditional one SNP at—a—
time methods is its multivariate approach combined with variable
selection, allowing us to ask what combination of SNPs best explain
gene expression. Using this information, we next performed regres—
sion of expression of each gene on its best combination of SNP(s).
The resulting residuals were substantially less correlated than the re—
siduals from regression on just the hotspot SNP alone (Fig. 5c).
Thus, we see that including multiple SNPs in the model accounts for
a substantial fraction of the correlation in gene expression. This
highlights a major advantage of our approach.

Additional discussion of the human results is given in the
Supplementary Material.

5 Discussion

The availability of data collected over multiple tissues or conditions
is becoming increasingly common given the decreasing cost of gener—
ating transcriptomic, metabolic and epigenetic phenotypes over
large cohorts of individuals (Li et al., 2011b).

In this article we present a new model that exploits the multidi—
mensional nature of these data and extends ST—HESS presented in
Bottolo et al. (2011): our new hierarchical model and C—I——I— algo—
rithm, MT-HESS is able to analyse a large number of responses col—
lected over dependent multiple tissues or conditions and regress
them on a large set of correlated predictors. Similar to its parent ver—
sion, MT—HESS retains the ability to perform hotspot discovery in —
omics experiments. To the best of our knowledge, MT—HESS is the
first tool able to unravel whether a genetic marker has a systemic
role and inﬂuences several OMICS traits in multiple related condi—
tions at the same time.

This is demonstrated in the complex multiple tissue scenario of
our real rat data analysis. The increased power of MT—HESS
allowed the detection of both experimentally validated and previ—
ously undiscovered putative hotspots for the IDIN network across
left ventricle, aorta and liver tissues. Prediction error analysis con—
firms the importance of the new detected hotspots. Model

EI-Clilllilli-III

   

Fig. 5. (a) Correlation matrix of expression of the 78 genes associated with
hotspot SNP rs11745891 in CD4 T cells. (b) Correlation matrix of the residuals
after simple regression of expression of each gene on rs11745891 genotype.
(c) Correlation matrix of the residuals after regression of each gene on the
SNPs in its best model. All three correlation matrices have been hierarchically
clustered. Colour key and distribution of Pearson correlation coefficients are
shown in the upper panels

112 /810'S[12u1no [p.IOJXO'SOTl‘BIHJOJIITOTQ/ﬂC1111] 111011 pop1201umoq

9IOZ ‘09 lsnﬁnv uo ::

MT—HESS: Multi—Tissue Hierarchical Evolutionary Stochastic Search

531

 

adequacy measure shows the superiority of MT—HESS model over
ST—HESS and the benefit of the integrated analysis. While in the
rats dataset it is possible to perform a leave—one—out cross—
validation approach, in larger datasets out—of—sample prediction
error can be performed by taking a random split of the data, for in—
stance 5 0/5 0, and reserving the remaining data for calculating the
average prediction error.

Due to a lack of competing algorithms that can analyse
multiple layers of correlated responses in a fully multivariate fash—
ion, we have compared MT—HESS with a MANOVA test, which is
extensively used when multiple outcomes are present. Recall
that such MANOVA test is performed for each pair of
(SNP >< response vector) at a time, where the vector of responses
correspond to the expression in multiple tissues or conditions. We
see that MT—HESS outperforms MANOVA, demonstrating that
our hierarchical modelling approach is more powerful than pair-
wise methods.

When faced with an eQTL analysis task which involves multiple
tissues, a natural alternative to MANOVA test is to compare results
from the intersection of single—tissue model (iST—HESS) with those
from the multiple—tissue one (MT—HSSS). Our extensive simulation
study show that when there is a similar pattern of association but
varying levels of signal—to—noise ratio across tissues, MT—HESS
clearly outperforms iST-HESS. This is well in keeping with the con-
struction of the model underlying MT—HESS, which performs a stat—
istically sound evidence synthesis for detecting hotspots between the
set of conditions or tissues. When signal—to—noise ratio is constant
across conditions/tissues MT—HESS results become closer to those of
iST-HESS pointing to the benefit of adjusting for external sources of
correlated noise prior to MT—HESS analysis, for example by using a
latent factor approach as in Stegle et al. (2012).

In our simulation study we show a substantial gain of power of
MT—HESS when the association in each tissue were too weak to be
detected by ST—HESS, a situation also illustrated in our first case
study where two new hotspots were highlighted by MT-HESS,
whereas they were not detected in the single tissue analyses. Here
the ST—HESS signal is relatively noisy and the ability of MT—HESS to
borrow and synthesize information between different layers of the
responses results in higher power for MT-HESS.

Our new C—I——I— implementation of the complex hierarchical struc—
ture in MT—HESS (comprising ST—HESS as a special case) permits effi—
cient analysis of very large datasets. It made feasible an MT—HESS
analysis of our human dataset, where a multivariate analysis and vari—
able selection between 3000 responses in three cell types and nearly
22 000 SNPs was carried out. The putative novel trans master regula—
tor situated near a long intergenic non-coding (linc) RNA (Ensembl
transcript ENST00000507733) (see Section 4.2) is a good example of
the power of our approach for generating hypotheses which can be
validated by follow—up experiments. The clear separation between
noise and signal offered by our sparse regression approach is para—
mount for successfully prioritizing such further validation.

In conclusion, our new algorithm MT-HESS with its efficient
C—I——I— architecture is tailored to jointly analyse realistic case studies
that comprise a large number of responses collected over dependent
multiple tissues or conditions and a large set of potentially collinear
predictors.

Acknowledgements

We thank the patients who kindly volunteered for this study, and Dr. Miles
Parkes, Consultant Gastroenterologist at Addenbrooke Hospital, Cambridge,
for helping to identify suitable patients. We are also grateful to the editor and

three anonymous referees for valuable comments that greatly improved the
presentation of the paper. We acknowledge the NIHR Cambridge Biomedical
Research Centre.

Funding

This research was funded by Medical Research Council Grant G1002319
(A.L., H.S., L.B., S.R.), a Wellcome Trust Clinical PhD Programme
Fellowship (].E.P.), Wellcome Trust Grant 083650/Z/07/Z and Medical
Research Council Grant MR/L19027/1 (K.G.C.S.), British Heart Foundation
PhD Studentship Grant FS/11/25/28740 (A.M., ER) and Engineering and
Physical Sciences Research Council Grant EP/K030760/1 (L.B.).

Conﬂict of Interest: none declared.

References

Atanur,S.S. et al. (2010) The genome sequence of the spontaneously hyperten-
sive rat: analysis and functional signiﬁcance. Genome Res., 20, 791—803.

Bottolo,L. and Richardson,S. (2010) Evolutionary Stochastic search for
Bayesian model exploration. Bayesian Anal, 5, 5 83—6 18.

Bottolo,L. et al. (201 1) Bayesian detection of expression quantitative trait loci
hot spots. Genetics, 189, 1449—1459.

Bottolo,L. et al. (2013) GUESS-ing polygenic associations with multiple
phenotypes using a GPU-based evolutionary stochastic search algorithm.
PLoS Genet., 9, e1003657.

Bro'et,P. et al. (2004) A mixture model-based strategy for selecting sets of
genes in multiclass response microarray experiments. Bioinformatics, 20,
25 62—25 71.

Brown,P.]. et al. (1998) Multivariate Bayesian variable selection and predic-
tion.]. R. Stat. Soc. B, 60, 627—641.

Dunham,I. et al. (2012) An integrated encyclopedia of DNA elements in the
human genome. Nature, 489, 5 7—74.

FairfaX,B.P. et al. (2012) Genetics of gene expression in primary immune cells
identiﬁes cell type-speciﬁc master regulators and roles of HLA alleles. Nat.
Genet., 44, 502—510.

Flutre,T. et al. (2013) A statistical framework for joint eQTL analysis in mul-
tiple tissues. PLoS Genet., 9, e1003486.

Fusi,N. et al. (2012) Joint modelling of confounding factors and prominent
genetic regulators provides increased accuracy in genetical genomics studies.
PLoS Comput. Biol., 8, e1002330.

Gelfand,A. et al. (1992) Model determination using predictive distributions
with implementation Via sampling-based-methods (with discussion). In:
Bernardo, J. (eds.), Bayesian Statistics, vol. 4, Oxford: Oxford University
Press, pp. 147—167.

Hawkins,R.D. et al. (2010) Next-generation genomics: an integrative ap-
proach. Nat. Rev. Genet., 11, 476—48 6.

Heinig,M. et al. (2010) A trans-acting locus regulates an anti-Viral expression
network and type 1 diabetes risk. Nature, 467, 460—464.

Hubner,N. et al. (2005) Integrated transcriptional proﬁling and linkage
analysis for identiﬁcation of genes underlying disease. Nat. Genet., 37,
243—253.

Kristensen,V.N. et al. (2014) Principles and methods of integrative genomic
analyses in cancer. Nat. Rev. Cancer, 14, 299—313.

Lee,M.N. et al. (2014) Common genetic variants modulate pathogen-sensing
responses in human dendritic cells. Science, 343, 1246980.

Li,S. et al. (2011a) Mapping a dynamic innate immunity protein interaction
network regulating type I interferon production. Immunity, 35, 426—440.
Li,W. et al. (2011b) Integrative analysis of many weighted co-expression net-

works using tensor computation. PLoS Comput. Biol., 7, e1001 106.

Liang,F. and Wong,W.H. (2000) Evolutionary Monte Carlo: applications to
cp model sampling and change point problem. Stat. Sin., 10, 317—342.

Liang,F. et al. (2008) Mixtures of g priors for Bayesian variable selection.
]. Am. Stat. Assoc., 103, 410—423.

Marttinen,P. et al. (2014) Assessing multivariate gene-metabolome associ-
ations with rare variants using Bayesian reduced rank regression.
Bioinformatics, 30, 2026—2034.

112 /§JO'S{12umo [p.IOJXO'SOTlBIIIJOJUTOTQ/ﬁdllq 111011 pop1201umoq

9IOZ ‘09 lsnﬁnv uo ::

532

A.Lewin et al.

 

Melé,M. et al. (2015) The human transcriptome across tissues and individuals.
Science, 348, 660—665.

Muller,P. et al. (2006) Fdr and Bayesian multiple comparisons rules. In:
Bernardo, J. (eds) Bayesian Statistics, vol. 8. Oxford University Press, Oxford.

Nath,R. and Pavur,R. (1985) A new statistic in the one-way multivariate ana-
lysis of variance. Comput. Stat. Data Anal., 2, 297—315.

Petretto,E. et al. (2006 ) Heritability and tissue speciﬁcity of expression quanti-
tative trait loci. PLoS Genet., 2, e172.

Petretto,E., et al. (2010) New insights into the genetic control of gene expression
using a Bayesian multi-tissue Approach. PLoS Comput. B iol., 6, 5 87—5 88.

Raj,T. et al. (2014) Polarization of the effects of autoimmune and neurodege-
nerative risk alleles in leukocytes. Science, 344, 519—523.

Richardson,S. et al. (2010) Bayesian models for sparse regression analysis of
high dimensional data. In: Bernardo, J. (eds) Bayesian Statistics 9, volume 9.
Oxford University Press, Oxford, pp. 5 39—5 69

Rinn,J.L. and Chang,H.Y. (2012) Genome regulation by long noncoding
RNAs. Annu. Rev. Biochem., 81, 145—166.

Roider,H.G. et al. (2009) PASTAA: identifying transcription factors associ-
ated with sets of co-regulated genes. Bioinformatics, 25, 435—442.

Scott-Boyer,M.P. et al. (2012) An integrated hierarchical Bayesian model for
multivariate eQTL mapping. Stat. Appl. Genet. Mol. Biol., 11.

Shabalin,A.A. (2012) Matrix eQTL: ultra fast eQTL analysis Via large matrix
operations. Bioinformatics, 28, 1353—1358.

Stegle,O. et al. (2012) Using probabilistic estimation of expression residuals
(PEER) to obtain increased power and interpretability of gene expression
analyses. Nat. Protoc., 7, 500—507.

Stingo,F.C. et al. (2010) A Bayesian graphical modeling approach to
microRNA regulatory network inference. Ann. Appl. Stat., 4, 20242048.
Westra,H.-J. et al. (2013) Systematic identiﬁcation of trans eQTLs as putative

drivers of known disease associations. Nat. Genet., 45, 123 8—1243.

112 /§JO'S{12umo [p.IOJXO'SOTlBIIIJOJUTOTQ/ﬁdllq 111011 pop1201umoq

9IOZ ‘09 lsnﬁnv uo ::

