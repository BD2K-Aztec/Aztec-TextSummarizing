ORIGINAL PAPER

Vol. 29 no. 13 2013, pages 1647-1653
doi:10. 1093/bioinformatics/btt263

 

Gene expression

Advance Access publication May 8, 2013

Detection of significantly differentially methylated regions in
targeted bisulfite sequencing data
Katja Hebestreit*, Martin Dugas and Hans-Ulrich Klein

Institute of Medical Informatics, University of MUnster, Albert—Schweitzer—Campus 1, 48149 MUnster, Germany

Associate Editor: lnanc Birol

 

ABSTRACT

Motivation: Bisulfite sequencing is currently the gold standard to
obtain genome-wide DNA methylation profiles in eukaryotes. In con-
trast to the rapid development of appropriate pre-processing and
alignment software, methods for analyzing the resulting methylation
profiles are relatively limited so far. For instance, an appropriate pipe-
line to detect DNA methylation differences between cancer and con-
trol samples is still required.

Results: We propose an algorithm that detects significantly differen-
tially methylated regions in data obtained by targeted bisulfite sequen-
cing approaches, such as reduced representation bisulfite
sequencing. In a first step, this approach tests all target regions for
methylation differences by taking spatial dependence into account. A
false discovery rate procedure controls the expected proportion of
incorrectly rejected regions. In a second step, the significant target
regions are trimmed to the actually differentially methylated regions.
This hierarchical procedure detects differentially methylated regions
with increased power compared with existing methods.

Availability: R/Bioconductor package BiSeq.

Contact: katja.hebestreit@uni-muenster.de

Supplementary information: Supplementary Data are available at
Bioinformatics online.

Received on January 29, 2013; revised on April 10, 2013; accepted on
May 2, 2013

1 INTRODUCTION

DNA methylation is an epigenetic modiﬁcation regulating gene
transcription and is known to direct development and differen-
tiation (Gopalakrishnan et al., 2008). A CG dinucleotide (CpG
site) is called methylated if a methyl group is attached to the
cytosine (C). DNA treatment with sodium bisulﬁte speciﬁcally
introduces conversion of unmethylated cytosine to uracil (then
read as thymine by DNA polymerase), whereas methylcytosine
remains unmodiﬁed (Krueger et al., 2012). These changes are
mapped by next-generation sequencing. To save per-sample
costs, bisulﬁte sequencing (BS) can be combined with enrichment
strategies to target bisulﬁte sequencing to a speciﬁc fraction of
the genome (Bock, 2012). Along with DNA fragment capture, it
is possible to use restriction enzymes as for reduced representa-
tion bisulﬁte sequencing (RRBS), which measures genome-wide
DNA methylation in CpG-rich regions (Meissner et al., 2005).
Mspl (cleaves at CCGG) digested fragments are size-selected to
obtain fragments with short distance between Mspl sites.

 

*To whom correspondence should be addressed.

Bisulﬁte-treated DNA fragments are then sequenced and
mapped via conversion-aware aligners, such as Bismark
(Krueger and Andrews, 2011), RRBSMAP (Xi et al., 2012),
BS Seeker (Chen et al., 2010) or PASS-bs (Campagna et al.,
2012). The aligners usually return a list of CpG sites with the
number of cytosines and thymines among all reads aligned to the
cytosine in the genomic DNA sequence, which is then used for
subsequent analyses.

Aberrant DNA methylation patterns are a characteristic fea-
ture of cancer (Das and Singal, 2004). Often, studies focus on
promoter regions or gene bodies or—more generally—genomic
regions that are differentially methylated between cancer and
normal specimens. In this context, a differentially methylated
region (DMR) denotes a genomic region of adjacent CpG sites
that are differentially methylated. Because of lower costs of
RRBS or other targeted bisulﬁte sequencing approaches increas-
ingly larger number of samples are measured, which enables a
comparison of DNA methylation and the detection of DMRs
between groups of samples (Schoofs et al., 2013).

In the past 3 years, several software tools for descriptive BS
data analysis have been published. MethVisual (Zackay and
Steinhoff, 2010) is an R/Bioconductor (Gentleman et al., 2004;
R Core Team, 2012) package for visualization and exploratory
statistical analysis of BS data. BiQ Analyzer HT (Lutsik et al.,
2011) allows a locus-speciﬁc analysis and visualization. SAAP-
RRBS (Sun et al., 2012) provides methylation summary statistics
and annotation of CpG sites. Nevertheless, few tools to detect
DMRs exist. The most common approach is to perform Fisher’s
exact test CpG-wise or region-wise (Challen et al., 2012; Gu
et al., 2010; Li et al., 2010). Recently, BSmooth was published,
a pipeline to detect differentially methylated regions in whole-
genome BS data (Hansen et al., 2012). BSmooth basically relies
on smoothing the methylation values sample-wise and then test-
ing for group differences via CpG-wise t-tests. DMRs are deﬁned
as adjacent CpG sites with absolute 1 statistics above a deﬁned
threshold.

To assess the goodness of the results, a suitable error measure
is needed. For example, it would be convenient to control the
false discovery rate (FDR) on genomic regions, i.e. the expected
proportion of regions rejected erroneously out of all regions re-
jected, testing the null hypothesis that the regions are not differ-
entially methylated. However, the desire for a convenient
analysis of BS data and the establishing of an error measure
pose challenges speciﬁc to the analysis of BS data: ﬁrst, the
coverage, i.e. the number of reads spanning a CpG site varies
widely between different CpG sites and different samples. As a
consequence, each sample has an individual proﬁle of covered

 

© The Author 2013. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oup.com 1647

112 /310's113umo [p.IOJXO'SOleIIHOJUIOIQ/ﬁdllq 11101; prBOIIIAAOG

910Z ‘091sn3nv uo ::

K.Hebestreit et al.

 

CpG sites, and missing values occur frequently. Second, the spe-
ciﬁc probability distribution of methylation levels requires spe-
ciﬁc statistical models. Third, the methylation of neighbored
CpG sites is spatially correlated and, hence, are the CpG-wise
test statistics and P—values.

The ﬁrst and to our knowledge only approach accounting for
spatial dependence in multiple hypothesis testing is methleit, an
R package for the analysis of RRBS data and its variants (Akalin
et al., 2012). methleit models the methylation per CpG site
within a logistic regression. A sliding linear model (SLIM)
method is used to determine q values from P—values to correct
for multiple hypothesis testing (W ang et al., 2011).

We propose BiSeq, a DMR detecting approach that enables
testing for DMRs within target regions and controlling a given
FDR. This approach is tailored to data received by all kinds of
targeted bisulﬁte sequencing approaches.

The article is organized as follows. In Section 2, we give a
rough overview of the step-by-step approach. The individual
steps are presented in detail in Section 3. In Section 4, we
apply the approach to simulated data and compare its results
with those from BSmooth and methleit. Furthermore, we
apply BiSeq to a published leukemia dataset. In Section 5, we
brieﬂy discuss our results.

2 APPROACH

The analysis is conﬁned to the target region. For RRBS, these
are genomic regions with a high spatial density of covered CpG
sites. These regions are called CpG clusters. The approach has
two aims: ﬁrst, the detection of CpG clusters with at least one
differentially methylated CpG site. Second, the trimming of the
differentially methylated CpG clusters to the actually differen-
tially methylated CpG sites. In detail, BiSeq is a ﬁve-step
approach:

(1) Deﬁne CpG clusters
(2) Smooth methylation data within CpG clusters
(3) Model and test group effect within CpG clusters
(4) Apply hierarchical testing procedure:
(a) Test CpG clusters for differential methylation and con-
trol weighted FDR on clusters

(b) Trim rejected CpG clusters and control FDR on single
CpG sites

(5) Deﬁne DMR boundaries

3 METHODS
3.1 Data

We used RRBS data of bone marrow specimens of 18 patients with acute
promyelocytic leukemia at diagnosis that was recently published by
Schoofs et al. (2013). Additionally, there are 16 control samples com-
posed of four samples of healthy CD34 + cells, four samples of promye-
locytes (generated in vitro from the CD34+cells) and eight remission
bone marrow samples of matched patient samples. After MspI digestion,
size selection (40—220 bp) and bisulﬁte conversion, the RRBS libraries
were sequenced on an Illumina HiScanSQ instrument. Using Bismark

version 0.5, sequencing reads were mapped to hg19 genome and methy-
lation calls were extracted (Krueger and Andrews, 2011). On average,
1.17 X 107 reads were uniquely mapped per sample yielding coverage of
almost 9.3 X 106 CpG sites of which 9.4 X 105 CpG sites were covered in
all samples.

To obtain a dataset with known DMRs, we took 12 control samples
(four remission, four CD34+and four promyelocyte) from the data
described earlier in the text. Half of the samples (two remission, two
CD34+and two promyelocyte) were kept as control samples. Within
the other half, we simulated DMRs by placing methylation differences
of various intensities and lengths, so that these could be considered as
cancer samples. CpG island positions were downloaded from UCSC
database (Goldman et al., 2012) within which 5000 DMRs were placed.
Because of the fact that DMRs reported in literature usually fall within
widths of a few hundred to a few thousand base pairs (Bock, 2012),
we sampled the DMR lengths I from a truncated Gaussian:
I~N(100, 1502), with 10<l< 1000. Each DMR was placed into a
CpG island that was at least as long as the respective DMR with prob-
abilities proportional to the CpG island length. Overlapping of simulated
DMRs was allowed. Differences d were sampled from a truncated
Gamma: d ~I‘(1.9, 0.08), with 0< d< 1, so that the resulting differences
were positive. For a detailed description of how simulated DMRs were
incorporated into the data, see the Supplementary Data. In
Supplementary Figures S1 and S2, the distributions of the lengths and
differences of the resulting 4 034 DMRs are shown. Within the 12 sam-
ples, almost 8 X 106 CpG sites were covered of which 1.9 X 106 CpG sites
were covered in all samples.

3.2 CpG clusters

The RRBS method provides methylation information of CpG-rich re-
gions primarily. For this reason and because of the spatial correlation
of the methylation of nearby CpG sites, we constrain the analysis on CpG
sites within CpG clusters. These CpG clusters are regions detected as
follows: ﬁrst, we deﬁne frequently covered CpG Sites as CpG sites that
are covered in the majority of the samples. Second, we search for regions
within which the frequently covered CpG sites are close to each other.
Third, we retain only regions with a minimum number of frequently
covered CpG sites. In both, the acute promyelocytic leukemia data as
well as in the simulated data, CpG sites covered in at least 75% of sam-
ples were deﬁned as frequently covered CpG sites. A maximum distance
dmax of 100 bp to their nearest neighbor within a CpG cluster was ac-
cepted. Only CpG clusters with at least 20 frequently covered CpG sites
were used for the analysis. Note that the frequently covered CpG sites are
considered to deﬁne the CpG cluster boundaries only. For subsequent
analysis, all methylation data within these CpG clusters are used. The
CpG cluster detection is applicable for other targeted BS data in the same
manner. Alternatively, rather than CpG clusters, the target regions may
be used, e.g. if a DNA capture method followed by BS was used.

3.3 Smoothing

Methylation levels are strongly spatially correlated (Eckhardt et al.,
2006), that is why local smoothing of the data is appropriate (Hansen
et al., 2012; Jaffe et al., 2012). Hansen et al. (2012) showed that smooth-
ing of raw methylation data can reduce the required sequencing coverage.
DMR detection approaches without smoothing often discard CpG sites
of low coverage from further analyses. Thus, the underlying spatial cor-
relation allows using information from neighboring CpG sites, on the one
hand, reducing the variance of the methylation levels especially for lowly
covered CpG sites and, on the other hand, predicting methylation levels
at CpG-sites missing any sequence reads to avoid missing values.

Within each CpG cluster and for each sample, a smoothing function is
modeled. For a given position x, the weighted local likelihood for methy-
lation level )2 at position x

 

1648

112 /310's113umo [p.IOJXO'SSUBUHOJUIOIQ/ﬁdllq 11101; popeoIII/noq

9IOZ ‘091sn3nv uo ::

DMR detection in targeted BS data

 

k
L(y|m, n, w) = H B(m,-|n,-, y)“
i=1

is maximized, with B the binomial probability function, 11,- the number of
reads and m,- the number of methylated reads at x,, i = 1, .. . , k. Weights
w,- are calculated using a triangular kernel with bandwidth h:

Ix 2 xr|)1{(bc—_I:cil):1}.

This smoothing approach ensures that CpG sites close to position x
and CpG sites with a high coverage have high inﬂuence on the estimation
of the methylation level at x. The resulting methylation levels represent
the relative methylation between 0 and 1.

At each CpG site within a CpG cluster, the raw methylation data are
smoothed with a bandwidth of h = 80 bp.

 

W1: K061) =  —

3.4 Model and test group effect

Testing of group effects on methylation levels is usually done via t-tests,
Wilcoxon rank-sum tests or linear regression (Bock, 2012; Hansen et al.,
2012; Wang et al., 2012). Nevertheless, as the methylation values
)2 e (0, 1), the beta distribution is the appropriate distribution for model-
ing )2 (Ferrari and Cribari-Neto, 2004; Kuan et al., 2010). Let
1). =p/(p + q) and <1) =p + q, with p>0, q>0. The density ofy can be
written as

F(<1>)
F(M¢)F((1 — 10¢)

with Gamma function I‘. The mean and variance of y are E(y) = 1). and
Var(y) 2 11(1 — 1).)/(1 + <1)), respectively, and <1) can be interpreted as a
precision parameter. Thus, we model the mean of the methylation level )2,-
at position 1' within a beta regression.

f0; M» <1) = WW1 — WWW—1,

k
.9014) = injﬁj,
1:1

where ,8 = (,81, ..., ,Bk)T is a vector of the regression parameters and
x,1,...,x,-k are observations on k covariates. The link function g(.)
is strictly monotonic, twice differentiable and maps (0, 1) into IR.
The most common link for methylation levels is the logit func-
tion g(11.) = log(p./(1 — 11.)). Nevertheless, we prefer to use the probit
function g(p.) = <1)—1(1),), where <1)—1(.) is the inverse of the standard cu-
mulative normal distribution function, as this link is more moderate in
the transformation of extreme values close to 0 or 1. The maximum
likelihood estimators of ,8 and <1) do not have a closed form and need
to be obtained using numerical methods, for details see Ferrari and
Cribari-Neto (2004).

The methylation variation of cancer samples is often higher than for
normal samples (Hansen et al., 2011; Schoofs et al., 2013). An extension
of the beta regression is the variable dispersion beta regression model. In
this case, the biological variability and, hence, the precision parameter <1)
may be additionally modeled within a linear model with the group (e.g.
cancer/normal) as independent variable (Cribari-Neto and Zeileis, 2010;
Simas et al., 2010).

We ﬁt the beta regression model to the smoothed methylation levels at
each CpG site and test for a group effect using the Wald test.

3.5 Hierarchical testing

As the number of tested CpG sites usually exceeds 1 million, the problem
of multiple testing plays an important role in the detection of differen-
tially methylated CpG sites. Bock (2012) points out that after multiple
testing correction, only the strongest differences tend to remain signiﬁ-
cant. We suggest applying a hierarchical testing procedure by Benjamini
and Heller (2007) on target regions. They introduced a hierarchical

testing procedure that ﬁrst tests regions and then tests the locations
within the rejected regions. As region units are tested ﬁrst rather than
locations, the number of hypothesis tests is reduced, which increases stat-
istical power.

3.6 Test CpG clusters

The aim is to detect CpG clusters containing at least one differentially
methylated location and to control a size-weighted FDR on clusters. The
weighted FDR (WFDR), proposed by Benjamini and Hochberg (1997),
ensures that the chance of rejecting a cluster increases when it is larger,
but on the other hand, that also the weight of the error increases if a large
cluster is falsely rejected. To control the WFDR, the weighted Benjamini—
Hochberg procedure (Benjamini and Hochberg, 1997) is applied on clus-
ter P—values. For CpG site iin CpG cluster c, the P—value 1),-c arising from
the Wald test is transformed to the normally distributed z—score:
zic = <1)—1(1 — pic). As cluster test statistic, the standardized z—score aver-
age Z1. /6Z-c of the cluster locations 1' = 1, ...,mc is used, with Z. the z-

score average and 62-6 the estimated standard deviation of Z}. The stand-

 

 AC

ard deviation of Z} is estimated as 62-6 2 mc + 2  1.21 pl”, with
13;: j the estimated correlation between two locations 1' and j. The correl-
ation between two locations in a cluster is estimated as
[)5]. = 1 — 77(sic — 51-6), with )2(S,~C — 51-6) the estimated semivariogram cor-
responding to the distance between locations 1' and j within cluster c. The
variogram for distance 11 is estimated robustly by 2)?(h) =
[median(Z,-C — ZJ-C)2 : sic — 51-5 2 h]/0.455, see also Cressie, 1993. The
weighted Benjamini—Hochberg procedure at level q is applied on the P-
values <I>(Z_c/6Z-c) of all CpG clusters, with (I) the right tail probability of
the standard normal distribution. The cluster P—values are ordered so that
17(1) 5  5 17(6) 5  5 pm). The CpG clusters corresponding to the
smallest k P—values are rejected, with k = max{c : 17(6) 5 (22:1 w(b)/
m)q}, with WU.) being the weight associated with the size of cluster I)
and 221:1 WI.) 2 m, the number of clusters. Benjamini and Hochberg,
1997 showed that, for independent cluster test statistics,

WFDR 5 (Zbelo wb/m>q, with IO the subset of indices corresponding

to clusters without DMRs (true null clusters). If the joint distribution
of the cluster test statistics is positive regression-dependent (PRDS) on
the subset of true null clusters then WFDRClust 5 q (Benjamini and
Yekutieli, 2001). In particular, the PRDS property is satisﬁed if the clus-
ter test statistics are Gaussian, non-negatively correlated and the testing
hypotheses are one-sided.

To ensure that the variance of the z—scores is Gaussian with variance 1,
we recommend to estimate the variogram under the null hypothesis, e.g.
for re-sampled data.

3.7 Trim signiﬁcant CpG clusters

The aim is to remove the not differentially methylated CpG sites within
the rejected CpG clusters and to control a location-wise FDR. For each
of the resulting m2 CpG sites within the rejected CpG clusters its condi-
tional P—value pic on being in a rejected CpG cluster is estimated, see
Benjamini and Heller, 2007. A multiple testing two-stage procedure
at level qz, as suggested by Benjamini et al. (2006), is applied on these
conditional P-values that ﬁrst estimates the number of null
hypotheses and then uses it to enhance the power. The P—values are
ordered so that 13(1) 5 - - - 5 130m). The number of null hypotheses 17302 is
estimated by ﬁaoz = mg — k1, with k1 = max{b : 130,) 5 (b/m2)q’2} and
q’2 = q2/(1 + q2). Then, k2 = max{b : 130,) 5 (b/ﬁaoz)q’2} is the number
of rejected CpG sites. All locations with 13,-C>(k2/ﬁa02)q’2 are trimmed.
Benjamini and Heller (2007) showed that this two-stage procedure con-
trols the location-wise FDR asymptotically at level qz.

 

1e /310's113umo [p.IOJXO'SSUBUHOJUIOIQ/ﬁdllq 11101; popeoIII/noq

9IOZ ‘091sn3nv uo ::

K.Hebestreit et al.

 

3.8 Deﬁnition of DMR boundaries

The result of the cluster testing and trimming procedure is a list of dif-
ferentially methylated CpG sites from which we expect that they form
DMRs. Thus, we deﬁne DMRs as regions of adjacent rejected CpG sites
within one CpG cluster. DMRs are divided if the methylation difference
switches from positive to negative, or vice versa. This way we ensure that
within a DMR, all CpG sites are hyperrnethylated or hypomethylated,
respectively.

4 RESULTS

4.1 Simulation data

We applied the algorithm to our simulated dataset described in
Section 3.1, obtaining 28 471 CpG clusters within which we
smoothed the methylation levels for 1710164 CpG sites.
Figure 1A shows the effect of smoothing for a selected sample
and a selected genomic region. In Figure 1B, the smoothed
methylation proﬁles for all samples are shown for the same
region.

DMRs were identiﬁed with different choices of q and q2.
Table 1 shows the chosen q and q2 together with the achieved
cluster-wise WFDRs and location-wise FDRs. For q = 0.05 and
q = 0.1, respectively, the WFDR could be controlled with

WFDR< (Zbelo wb/m>q. In contrast, the location-wise FDRs

could not be controlled. However, this result was expected as the
DMRs were expanded spatially by the smoothing step, as seen in

 

   

 

 

 

 

 

 

 

 

 

 

 

A S — Coverage
on) _ 0 1X
0 O 103x
C
O CO
“('3 o'
S
E sr.
g o
“I
O
C?
0
62859500 62860000 62860500 62861000
Position
0. _
‘— — Cancer
00. _ -—- Control
0
C
.9 C0
16 o' T
_>.
5 st _
g o
Q! _ “"\ ,‘x
o .’ \\,,’\ ’
Q _ \\ _’ —
o I I I I
62859500 62860000 62860500 62861000
Position

Fig. 1. Methylation values for a selected region. (A) Shown are the ratios
of methylated and total reads (circles) and the smoothed methylation
proﬁle (line) for a simulated cancer sample. The grade of transparency
of the circles represent the coverage of the respective CpG site. (B) Shown
are the smoothed methylation proﬁles for all samples. The shaded box
represents a simulated DMR. One of the control samples had an extreme
low coverage that is why smoothing was impossible for some genomic
regions

Figure 1B. This explanation is supported by the fact that the
location-wise FDRs could be controlled for pruned DMRs
(Table 1, last column). Pruned DMRs were obtained as follows:
after trimming and testing, the DMRs were deﬁned as described
in Section 3.8. Each DMR >80 bp, which is corresponding to
the width of the smoothing window, was pruned by 40 bp
(half the bandwidth) at each side. Smaller DMRs remained un-
changed. Thus, we omitted CpG sites that were differentially
methylated because of the smoothing. For the remaining CpG
sites, we achieved control of the location-wise FDR. Results for
other choices of parameters for CpG cluster deﬁnition (dmax) and
for smoothing (h) are shown in Supplementary Tables S1 and S2.

The probability to detect a differentially methylated CpG site
(power) is depicted in Figure 2 depending on its simulated dif-
ference and on the fraction of differentially methylated CpG sites
in its CpG cluster. As a standardized averaged z—score is used as
cluster test statistic, the fraction of high z—scores affects the prob-
ability to reject a cluster. Figure 2 suggests that a CpG site with a
methylation difference of at least 0.2 located in a CpG cluster
with >30% differentially methylated CpG sites was detected with
a probability of >90%. This implies that not only the methyla-
tion difference but also the choice of the CpG clusters is crucial
for the power.

To illustrate the performance of our approach in comparison
with others, we also applied BSmooth and methleit to the
simulated data. For BSmooth (version 0.4.3), we set the param-
eters for smoothing similar to the BiSeq parameter choices: the
minimum number of methylation loci in a smoothing window
(ns) was set to 20, the minimum bandwidth (h) was set to 80 and
the maximum gap between two methylation loci, before the
smoothing is broken across the gap (maxGap), was set to
100 bp. For CpG sites where at least two cancer samples and
at least two normal samples had a minimum coverage of two
reads (as recommended in the package vignette) were tested for
differential methylation (3187862 CpG sites). Despite of com-
parable parameter choices, the number of tested CpG sites is
higher than for BiSeq. This is because the given bandwidth is a
minimum bandwidth and is enlarged until at least 20 CpG sites
are included within the smoothing window. A consequence is
that the degree of smoothing is different from sample to
sample for the same genomic region and also within the
genome of one sample. Furthermore, BSmooth adopts local

Table 1. Cluster-wise and location-wise FDRs for BiSeq

 

 

 

 

q 2 % q qz WFDR FDR
[7610
Cluster Location Location
(pruned)
0.05 0.177 0.027
0.05 0.043 0.1 0.009 0.189 0.032
0.05 0.184 0.028
0.1 0.086 0.1 0.015 0.197 0.033

 

Note: Shown are the choices of q with the resulting upper bound for independent
cluster test statistics and qz together with the observed cluster-wise WFDR, loca-
tion-wise FDR and the location-wise FDR in pruned DMRs.

 

1650

112 /810's113umo [p.IOJXO'SSUBUHOJUIOIQ/ﬁdllq 11101; popeoIII/noq

9IOZ ‘091sn8nv uo ::

DMR detection in targeted BS data

 

 

 

 

 

   

Power
0.5 1.0
0.8
a, 0.4
O _
C
9
8 0.6
.6
C
.9
g 0.4
_C
E
2
0.2
0.0
0.2 0.4 0.6 0.8
DMR fraction

Fig. 2. Power to detect differentially methylated CpG sites. Shown is the
inﬂuence of the CpG methylation difference and DMR fraction of the
respective CpG clusters on the probability to detect a differentially
methylated CpG site. The higher the simulated methylation difference
the higher was the probability to reject the CpG site (y-axis). The
higher the fraction of differentially methylated CpG sites in CpG clusters,
the higher was the probability to reject the clusters and, hence, to reject
the CpG sites

logistic regression for smoothing. One main drawback of the
regression approach is extrapolation: if methylation is predicted
outside of a covered genomic region, the last observed slope is
continued, often resulting in extrapolated methylation values of 0
and 1, see Supplementary Figure S3 for an example. The vari-
ance was estimated for the control group, as suggested in the
package vignette. CpG sites with associated absolute t—statistics
beyond a certain cut-off were deﬁned as differentially methylated
CpG sites.

methleit (version 0.5.5) was applied to locations that are
covered in at least four samples per group (2903 270 CpG
sites). It is necessary to set such a threshold because there is no
smoothing step; hence, many CpG sites are covered in a fraction
of the samples only. CpG sites with associated q values below a
certain cut-off were deﬁned as differentially methylated CpG
sites.

Figure 3 shows ROC curves for all three approaches. As two
FDR levels have to be chosen for BiSeq, we plotted several lines
each showing the results for ﬁxed q and varying q2. In summary,
BiSeq achieved a higher sensitivity than BSmooth and methleit
for false positive rates <8%.

4.2 Acute promyelocytic leukemia dataset

To analyze the acute promyelocytic leukemia data, we ﬁrst de-
tected CpG clusters with the same parameters as used for simu-
lation data. We identiﬁed 30 205 CpG clusters with a total width
of 1.4 X 107 bp (median: 373 bp, minimum: 42 bp, maximum:
4270 bp). We modeled the methylation levels applying a beta
regression with group (cancer/control) and gender as explanatory
variables. The precision parameter was modeled within an add-
itional model with group as explanatory variable, as we expect

 

0.90
|

0.85
|

 

 

 

 

>~ ,'
E 8 _  I, Cluster-wise FDR
5 d  ’l — 10%
m  II 20%
 z’ 30%
“,3 _ ,’ — 40%
c5 1 50%
I 60%
,’ — 70%
,’ — 80%
I9. — I — 90%
O

 

 

I

I I I I I I I

0.00 0.02 0.04 0.06 0.08 0.10 0.12

1 - Specifity

Fig. 3. ROC curves for differentially methylated CpG sites detected from
BiSeq, BSmooth and methleit. Shown are ROC curves for different
t—statistic thresholds (BSmooth; dashed line), different q-value thresholds
(methleit; dotted line) and for different choices of q and qz (BiSeq;

colored lines). Each of the ROC curves for BiSeq arises from a chosen
q with different choices of qz (from 0.01 to 0.99)

higher methylation variances in the leukemia samples (Schoofs
et al., 2013). Testing the CpG clusters at a WFDR of 0.1 leads to
the rejection of 7760 clusters. Cluster trimming at an FDR of
0.05 revealed 306 807 differentially methylated CpG sites, form-
ing 9442 DMRs. The median of the DMR widths was 168 bp
(minimum: 1 bp, maximum: 2401 bp). The vast majority (95.6%)
of the differentially methylated CpG sites were hypermethylated
in leukemia samples, see Supplementary Figure S4 for the fre-
quency distribution. Plotting the chromosomal positions of the
differentially methylated and of all tested CpG sites revealed that
for some chromosomes, the distribution of differentially methy-
lated CpG sites was shifted toward chromosomal ends in relation
to the distribution of the tested CpG sites (Schoofs et al., 2013).
Supplementary Figure S5 depicts the distributions in chromo-
some 5. Moreover, it might be of interest whether certain gen-
omic regions were located in DMRs more (or less) frequently
than statistically expected. Brieﬂy, we determined the centers of
regions of interest, e.g. gene promoters, and then calculated the
expected number of region centers within each DMR, assuming
a uniform distribution of the centers in the CpG clusters. The
number of expected region centers was then subtracted from the
number of region centers actually observed in the DMRs. This
analysis yielded that gene bodies were signiﬁcantly overrepre-
sented in hypermethylated DMRs, and promoters were under-
represented in both, hyper- and hypomethylated DMRs
(Supplementary Fig. S6).

5 DISCUSSION

We proposed a DMR detection approach that tests regions for
differential methylation with subsequent localization of DMRs
within rejected regions. This hierarchical procedure is more
powerful than BSmooth and methleit.

 

1e /810's113umo [p.IOJXO'SSUBUHOJUIOIQ/ﬁdllq 11101; popeommoq

9IOZ ‘091sn8nv uo ::

K.Hebestreit et al.

 

One strength of the proposed algorithm is that a region-wise
FDR can be controlled. Nevertheless, we could ask whether
smoothing of methylation data and focusing on regions is an
appropriate strategy considering the fact that methylation of a
single CpG site can prevent transcription factor binding (Gaston
and Fried, 1995). To investigate whether focusing on region-wise
methylation changes is meaningful, we analyzed the spatial clus-
tering behavior of differentially methylated CpG sites in the leu-
kemia dataset. We tested CpG sites for differential methylation
in leukemia compared with controls without smoothing before-
hand. This way we ensured that we did not add additional spatial
correlation. We compared Ripley’s K functions for both, tested
CpG sites and differentially methylated CpG-sites and could
show that the clustering of differentially methylated CpG sites
is more pronounced than the clustering of tested CpG sites
(which is due to the targeted sequencing). Differentially methy-
lated CpG sites tend to form clusters of sizes up to 1000 bp (see
Supplementary Fig. S7). The fact that entire regions are particu-
larly effected by differential methylation in leukemia (and prob-
ably in other cancer types as well) justiﬁes smoothing and
detection of differentially methylated regions.

An advantage over other approaches is that the methylation
levels are modeled within a regression model allowing adding
further independent variables and confounders to the model.
For instance, Boks et al., 2009 found associations of DNA
methylation with gender and age; thus, it might be important
to take these confounders into account. Neither BSmooth nor
the methleit package allows adding further variables. By mod-
eling the methylation levels within a beta regression, we make
sure that basic properties of methylation levels are respected, i.e.
the distribution between 0 and l and a smaller variance near the
boundaries. Another advantage of the beta regression is the
option to consider higher variances in a group of samples (com-
monly the cancer samples) via a variable precision parameter. A
drawback is the long computing time.

Most of the parameters that have to be chosen are related to
CpG cluster detection and thus inﬂuence the extent of the
genome that is to be analyzed. Basically, the grade of the min-
imal spatial density of covered CpG sites that form CpG clusters
together with the width of the smoothing window should be ad-
justed to the expected DMR lengths. Even if many CpG sites are
covered over a wide genomic region (for example, in whole-
genome bisulﬁte sequencing data), it is advisable not to choose
too large CpG clusters with many CpG sites, when the expected
DMR widths are much smaller, as this would decrease the power
markedly (Fig. 2). Likewise, a wide smoothing window results in
a weaker sensitivity to small DMRs. Moreover, the smoothing
bandwidth should be adjusted to the choice of CpG clusters.

Benjamini and Heller (2007) showed that the cluster testing
procedure described earlier in the text controls the cluster-wise
WFDR under independence or PRDS assumption, respectively.
The procedure ensures that the cluster test statistics are
Gaussian, and that the testing hypotheses are one-sided.
Finally, to satisfy the PRDS property, the cluster test statistics
have to be non-negatively correlated under the null hypothesis.
We assume that this property is met in many cases for methyla-
tion data. Furthermore, it is important to note that the location-
wise FDR is controlled asymptotically only, and DMR
boundaries are slightly shifted by the smoothing step.

However, we think that a targeted bisulﬁte sequencing approach
primarily requires an analysis of the target units, e.g. CpG is-
lands or gene bodies, rather than individual CpG sites. Besides,
differential methylation typically is reported in terms of regions.
This indicates a region-wise testing approach in the ﬁrst place,
followed by a CpG-wise detection tolerating more errors. This
hierarchical testing procedure achieves a higher power than
BSmooth and methleit.

The approach is tailored to targeted BS data. The direct use on
whole-genome BS data would be feasible if the analysis was re-
stricted on discrete genomic regions, e.g. on genes.

We think that the two-stage testing procedure is applicable for
other types of next-generation sequencing data as well. The his-
tone modiﬁcation H3K4me3 is known to occur in promoter re-
gions primarily (Hebenstreit et al., 2011). Thus, promoters could
be tested for differential histone modiﬁcation between groups of
samples in a ﬁrst step and in bins (sub-regions) within rejected
promoters in a second step. This is a point for further research.

ACKNOWLEDGEMENT

The authors thank Till Schoofs, Christian Rohde and Carsten
Muller-Tidow (Department of Medicine A - Hematology,
Oncology and Pneumology, University of Munster, Germany)
for providing the data and discussing biological results.

Conflict of Interest: none declared.

REFERENCES

Akalin,A. et al. (2012) methleit: a comprehensive r package for the analysis of
genome-wide DNA methylation proﬁles. Genome Biol, 13, R87.

Benjamini,Y. and Heller,R. (2007) False discovery rates for spatial signals. J. Am.
Stat. Assoc., 102, 1272—1281.

Benjamini,Y. and Hochberg,Y. (1997) Multiple hypotheses testing with weights.
Scand. J. Stat, 24, 407—418.

Benjamini,Y. and Yekutieli,D. (2001) The control of the false discovery rate in
multiple testing under dependency. Ann. Stat, 29, 1165—1188.

Benjamini,Y. et al. (2006) Adaptive linear step-up procedures that control the false
discovery rate. Biometrika, 93, 491—507.

Bock,C. (2012) Analysing and interpreting DNA methylation data. Nat Rev.
Genet, 13, 705—719.

Boks,M.P. et al. (2009) The relationship of DNA methylation with age, gender and
genotype in twins and healthy controls. PLoS One, 4, e6767.

Campagna,D. et al. (2012) Pass-bis: a bisulﬁte aligner suitable for whole methylome
analysis of illumina and solid reads. Bioinformatics, 29, 268—270.

Challen,G.A. et al. (2012) Dnmt3a is essential for hematopoietic stem cell differen-
tiation. Nat. Genet, 44, 23—31.

Chen,P.Y. et al. (2010) Bs seeker: precise mapping for bisulﬁte sequencing. BM C
Bioinformatics, 11, 203.

Cressie,N.A.C. (1993) Statistics for Spatial Data. Wiley, New York.

Cribari-Neto,F. and Zeileis,A. (2010) Beta regression in r. J. Stat. Softw., 34, 1—24.

Das,P.M. and Singal,R. (2004) DNA methylation and cancer. J. Clin. Oncol., 22,
4632—4642.

Eckhardt,F. et al. (2006) DNA methylation proﬁling of human chromosomes 6, 20
and 22. Nat. Genet, 38, 1378—1385.

Ferrari,S.L. and Cribari—Neto,F. (2004) Beta regression for modelling rates and
proportions. J. Appl. Stat, 31, 799—815.

Gaston,K. and Fried,M. (1995) CpG methylation and the binding of YYl and ETS
proteins to the surf-l/surf—2 bidirectional promoter. Gene, 157, 257—259.

Gentleman,R.C. et al. (2004) Bioconductor: open software development for com-
putational biology and bioinformatics. Genome Biol, 5, R80.

Goldman,M. et al. (2012) The UCSC cancer genomics browser: update 2013.
Nucleic Acids Res., 41, D949—954.

 

1e /810's113umo [p.IOJXO'SSUBUHOJUIOIQ/ﬁdllq U101} popeommoq

9IOZ ‘091sn8nv uo ::

DMR detection in targeted BS data

 

Gopalakrishnan,S. et al. (2008) DNA methylation in development and human dis-
ease. Mutat. Res., 647, 30—38.

Gu,H. et al. (2010) Genome-scale DNA methylation mapping of clinical samples at
single-nucleotide resolution. Nat. Methods, 7, 133—136.

Hansen,K.D. et al. (2011) Increased methylation variation in epigenetic domains
across cancer types. Nat. Genet, 43, 768—775.

Hansen,K.D. et al. (2012) BSmooth: from whole genome bisulﬁte sequencing reads
to differentially methylated regions. Genome Biol, 13, R83.

Hebenstreit,D. et al. (2011) EpiChIP: gene-by-gene quantiﬁcation of epigenetic
modiﬁcation levels. Nucleic Acids Res., 39, e27.

J affe,A.E. et al. (2012) Bump hunting to identify differentially methylated regions in
epigenetic epidemiology studies. Int. J. Epidemiol, 41, 200—209.

Krueger,F. and Andrews,S.R. (2011) Bismark: a ﬂexible aligner and methylation
caller for bisulﬁte-seq applications. Bioinformatics, 27, 1571—1572.

Krueger,F. et al. (2012) DNA methylome analysis using short bisulﬁte sequencing
data. Nat Methods, 9, 145—151.

Kuan,P.F. et al. (2010) A statistical framework for illumina DNA methylation
arrays. Bioinformatics, 26, 2849—2855.

Li,Y. et al. (2010) The DNA methylome of human peripheral blood mononuclear
cells. PLoS Biol, 8, 61000533.

Lutsik,P. et al. (2011) BiQ Analyzer HT: locus-speciﬁc analysis of DNA methylation
by high-throughput bisulﬁte sequencing. Nucleic Acids Res., 39, W551—W556.

Meissner,A. et al. (2005) Reduced representation bisulﬁte sequencing for compara-
tive high-resolution DNA methylation analysis. Nucleic Acids Res., 33,
5868—5877.

R Core Team. (2012) R: A Language and Environment for Statistical Computing.
R Foundation for Statistical Computing, Vienna, Austria. ISBN 3-900051-07-0.

Schoofs,T. et al. (2013) DNA methylation changes are a late event in acute pro-
myelocytic leukemia and coincide with loss of transcription factor binding.
Blood, 121, 178—187.

Simas,A.B. et al. (2010) Improved estimators for a general class of beta regression
models. Comput Stat. Data Anal, 54, 348—366.

Sun,Z. et al. (2012) SAAB-RRBS: streamlined analysis and annotation pipeline for
reduced representation bisulﬁte sequencing. Bioinformatics, 28, 2180—2181.
Wang,D. et al. (2012) Ima: An R package for high-throughput analysis of illuminas

450k inﬁnium methylation data. Bioinformatics, 28, 729—730.

Wang,H.Q. et al. (201 1) Slim: a sliding linear model for estimating the proportion of
true null hypotheses in datasets with dependence structures. Bioinformatics, 27,
225—231.

Xi,Y. et al. (2012) RRBSMAP: a fast, accurate and user-friendly alignment tool for
reduced representation bisulﬁte sequencing. Bioinformatics, 28, 430—432.

Zackay,A. and Steinhoff,C. (2010) Methvisual - visualization and exploratory stat-
istical analysis of DNA methylation proﬁles from bisulﬁte sequencing. BM C
Res. Notes, 3, 337.

 

1e /810's113umo [p.IOJXO'SOIlBIHJOJUIOIQ/ﬁdllq U101} popeommoq

9IOZ ‘091sn8nv uo ::

