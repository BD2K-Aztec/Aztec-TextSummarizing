ORIGINAL PAPER

Vol. 26 no. 8 2010, pages 1000-1006
doi: 10. 1093/bioinformatics/btq08 7

 

Genome analysis

Advance Access publication March 5, 2010

Comparing genome-wide chromatin profiles using ChlP-chip or

ChlP-seq

Frank Johannesl’M, Pen Wardenaarl’l, Maria Colom -Tatch 2, Florence Mousson3,
Petra de Graaf3, Michal Mokry4, Victor Guryev4, H.Th. Marc Timmers3, Edwin Cuppen4

and Ritsert C. Jansenl’5

1Groningen Bioinformatics Centre, University of Groningen, Kerklaan 30, Biologisch Centrum, 9751 NN Haren,

The Netherlands, 2Institute for Theoretical Physics, Leibniz Universit t Hannover, Appelstr. 2, D—30167 Hannover,
Germany, 8Department of Physiological Chemistry, University Medical Center Utrecht, Universiteitsweg 100, 3508 AB
Utrecht, 4Hubrecht Institute, KNAW and University Medical Center Utrecht, Uppsalalaan 8, 3584 CT Utrecht and
5Department of Genetics, University Medical Centre Groningen, Hanzeplein 1, 9713 GZ Groningen, The Netherlands

Associate Editor: Alex Bateman

 

ABSTRACT

Motivation: ChlP-chip and ChlP-seq technologies provide genome-
wide measurements of various types of chromatin marks at
an unprecedented resolution. With ChlP samples collected from
different tissue types and/or individuals, we can now begin to
characterize stochastic or systematic changes in epigenetic patterns
during development (intra-individual) or at the population level
(inter-individual). This requires statistical methods that permit a
simultaneous comparison of multiple ChlP samples on a global as
well as locus-specific scale. Current analytical approaches are mainly
geared toward single sample investigations, and therefore have
limited applicability in this comparative setting. This shortcoming
presents a bottleneck in biological interpretations of multiple sample
data.

Results: To address this limitation, we introduce a parametric
classification approach for the simultaneous analysis of two (or
more) ChlP samples. We consider several competing models
that reflect alternative biological assumptions about the global
distribution of the data. Inferences about locus-specific and genome-
wide chromatin differences are reached through the estimation
of multivariate mixtures. Parameter estimates are obtained using
an incremental version of the Expectation—Maximization algorithm
(IEM). We demonstrate efficient scalability and application to three
very diverse ChlP-chip and ChlP-seq experiments. The proposed
approach is evaluated against several published ChlP-chip and
ChlP-seq software packages. We recommend its use as a first-
pass algorithm to identify candidate regions in the epigenome,
possibly followed by some type of second-pass algorithm to fine-
tune detected peaks in accordance with biological or technological
criteria.

Availability: R source code is available at http://gbic.biol.rug.nl/
supplementary/2009/ChromatinProfiles/

Access to Chip-seq data: GEO repository GSE17937

Contact: f.johannes@rug.nl

Supplementary information: Supplementary data are available at
Bioinformatics online.

 

*To whom correspondence should be addressed.
lThe authors wish it to be known that, in their Opinion, the ﬁrst two authors
should be regarded as joint First Authors.

Received on November 18, 2009; revised on February 19, 2010;
accepted on February 22, 2010

1 INTRODUCTION

Epigenetic modiﬁcations such as methylation of DNA or
histones are associated with the transcriptional output of genes.
Hence, they occupy a central role in genome function. The
use of chromatin immunoprecipitation techniques coupled with
tiling—arrays (ChIP—chip) or deep sequencing (ChIP—seq) now permit
a detailed characterization of various types of chromatin marks
on a genome—wide scale. Global surveys of this type have been
mainly conducted in the context of a single genome analyses (Suzuki
and Bird, 2008). However, to begin to understand the epigenetic
basis of biological variation, detailed comparisons of chromatin
proﬁles between different tissues and/or individuals are becoming
increasingly important. Such comparative studies can be broadly
divided into those that are concerned with intra—individual variation
and those concerned with inter—individual variation.

The goal of intra—individual analysis is the detection of key
chromatin modiﬁcations that are associated with, or possibly drive,
normative processes such as tissue development. Meissner et al.
(2008), for instance, recently compared mammalian cells across
several stages of differentiation in order to map the genome—wide
changes in DNA methylation and several histone marks that reﬂect
this progression. The focus of inter—individual comparisons, in
contrast, rests on the analysis of chromatin differences between
individuals for a given tissue (Bock et al., 2008). This is
accomplished by either treating each individual as a separate unit
of analysis, or by comparing pooled tissue from individuals that
belong to a priori well—deﬁned groups. A clear example for this latter
type of application comes from oncology studies where cancerous
tissues from patients are directly evaluated against normal tissue
from healthy individuals (Esteller, 2008).

Apart from clinically relevant inter—individual differences,
attention has recently shifted to naturally occurring chromatin
variation (Richards, 2008). A recent survey of several Arabidopsis
ecotypes, for instances, has revealed substantial variation in genome—
wide DNA methylation patterns, part of which has been shown
to be stably transmitted across generations (Vaughn et al., 2007).

 

1000 © The Author 2010. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oxfordjournals.org

112 /§JO'S{BUJnoprOJXO'SOTlBIHJOJUTOTQ/ﬁdnq U101} popnommoq

9IOZ ‘Ig1sn8nv I102:

Comparison of genome-wide chromatin profiles

 

A Model I B Model 2 C Model 3
13mph 1 RuLu-Iunn “mph: _ “In” 1 anu‘n qmpn 2 5:71;“ 1 PHI-lama Erwin:
E .. _
a . _ _ , , I“... ' '_':
-— . H .I. . .-I .- l-l I. H E. 
'5. II 1_ ' II. I a In 4- . l '|' I. I [1' .w __. I. _II _F._'
E r '. I‘I  - -. II = -' -    F”. . '.  - .' '. .- -
:l ' “ V "' '. | I 1' - ': I . - '. I
3 I III-III III I II I : I II I1... ‘_ I‘ll : Ir, II:.:I II
“a Ju— R J a - L _.r J a. _/' J a J Just-a. _';' '31; a.

I . : r I .- ' r 1 : :I . 1 I .I : . 1

ul'rplii

 

Bivariate

   

'III'I1FIE'I

I'Hl N: F: .“1 ,U'l JiI'E
.IuIIIHJ

Fig. 1. Conceptual overview of the mixture model approach. We consider
three different models for the analysis of chromatin differences between
two or more samples. Provided is a visual illustration of the conceptual
basis of these models, with a focus on the speciﬁc case of two—
sample comparisons. (A—C, top panel) Univariate representation. (A—C,
bottom panel) Bivariate representation. The colors represent the expected
distribution of the data corresponding to RSE (light gray), RSNE (dark gray),
RDE (red: sample 1 > sample 2) and RDE (green: sample 2 > sample 1). The
color coding is consistent with Supplementary Figure S1.

This latter observation suggests that many of the experimental
populations that are derived from these ecotypes and used for genetic
mapping experiments, such as F 2—intercrosses or Recombinant
Inbred Lines (RILs), could segregate a source of epi genetic variation
that impacts many commonly studied complex traits, independent
of DNA sequence polymorphisms (Johannes et al., 2008, 2009).
In light of this possibility, we have argued for a genome—wide
characterization of available parental lines to identify those that are
most divergent on the level of chromatin (Johannes et al., 2008).
Such lines can be used to obtain epigenetically informative line
crosses, which could become the basis for the dissection of the
epigenetic architecture underlying continuous trait variation.

The above intra— and inter—individual applications share a
common problem: they require a methodological approach that
permits a meaningful partition of the epigenome into regions with
differentially enrichment (RDE), regions with shared enrichment
(RSE) and regions with shared non—enrichment (RSNE) for a
chromatin mark of interest (Fig. l and Supplementary Fig. S1). In
many practical situations, researchers are interested in comparing a
small number of ChIP samples, possibly as low as two, each sample
being presented by one tiling array or sequencing experiment. Small
numbers of samples are common because of ﬁnancial constraints,
or because they represent pilot studies. Most available software
packages for the analysis of ChIP—chip or ChIP—seq data have been
designed for single genome (i.e. single ChIP sample) investigations
and therefore have limited application in this setting (Supplementary
Tables S1 and S2).

In an attempt to overcome these limitations, we introduce a
parametric classiﬁcation method based on multivariate mixture
models. The approach permits a direct comparison of two (or more)
ChIP samples (Fig. 1). Its unique feature lies in the characterization
of the global distribution of the data in accordance with several
plausible biological models. At the same time, it provides
probabilistic estimates of locus—speciﬁc chromatin states. To ease
computational demands, we implement an incremental version of
the Expectation—Maximization (IEM) algorithm. We illustrate our

approach in the context of two published ChIP—chip experiments
and one unpublished ChIP—seq experiment. We highlight the utility
of our approach in terms of the biology of each example dataset. We
also evaluate our approach against several published ChIP—chip and
ChIP—seq software packages.

2 METHODS

2.1 The parametric classiﬁcation approach

For clarity, we focus on the special case of a two—sample comparison
throughout, although extensions to additional dimensions can be
implemented. The samples should represent two different natural or
experimental units (e.g. tissue 1 versus tissue 2, genotype 1 versus
genotype 2, cancer patients versus control cases). Let xj and yj denote the
signals of the two samples recorded for the j—th genomic region. In practice,
region j represents an arbitrary unit of analysis. For ChIP—chip data, for
instance, this can be a single tile on the array or the average signal taken
over a larger sequence, such as a promoter, or gene. For ChIP—seq data,
we ﬁrst divide the genome into equally sized bins and take ‘read’ counts
within each one of these bins. Hence, in this case, region j represents one or
several of these bins and its associated counts represent the ‘signal’, which
after normalization over several experiments can be treated as a continuous
variable (see below).

When Input data is available, xj and yj are obtained by calculating
the signal difference g(IPj)—g(lnputj), where g(') denotes some suitable
normalization. IPj is the signal belonging to the immunoprecipitate and Input]-
that to the total DNA (Supplementary Fig. S1). Note that the IP and Input
material can come from the DNA of a single individual, or from pooled DNA
of multiple individuals representing a larger group.

Based on the expected distributional properties of ChIP data (Fig. l and
Supplementary Fig. S1), we let the probability of the random pair Wj = 09.32,)
be given by a four—component mixture model

4
f(w,-; w)=ZAiﬁ(w,-.6i) (1)
i=1
where \I1 = (A1, $4.01, ...,04) is a vector of parameters assumed a priori to
be distinct. Note that the component indexing corresponds to the components
associated with RSNE (dark gray), RSE (light gray), RDE (red) and RDE
(green), respectively (Fig. l and Supplementary Fig. SI), and that the mixing
weights must meet the constraint Zikizl. For the present application
of a two—sample comparison, we take the i—th component density to be
bivariate normal; that is, le0,- ~BVN(;7.,-, 2,) with (j: l, ...,n), (i: l, ...,4),
and where 0.,- and Z,- are the vector of the component means and the
component variance—covariance matrix, respectively. Based on (1), we
consider three competing models, a Null model (Model 1), a Full—switching
model (Model 2) and a Flexible—switching model (Model 3), each of which
is detailed below.

2.1.] Null model (Model 1) Model 1 (Fig. 1A) assumes that there are
effectively no chromatin differences between the two samples, implying that
A3 2A4 =0. In this conceptualization, the signals of the enriched and non—
enriched components are ‘stable’ across conditions and thus highly correlated
(i.e. both samples tend to show enrichment or non—enrichment for region j).
This is equivalent to assuming that the two samples are technical replicates
of each other. The null model is given by

f(w,-;®)=A1f1(w,;/11,21)+A2f2(w,;ﬂ2,22) (2)

where 01:01.14“) and ﬁg =(u2, Hz). The component means are
constrained to be equal, and the variance—covariance matrices are allowed
to be different (heteroscedastic).

2.1.2 Full-switching model (Model 2) Model 2 (Fig. 1B) starts from the
assumption that differential chromatin states exist between the two samples.

 

1001

112 /§JO'S{BUJHOIpJOJXO'SOIlBIHJOJUIOIQ/ﬁdnq 1110.1} popnommoq

9IOZ ‘Ig lsnﬁnv uo ::

F.Johannes et al.

 

The model is
f(Wj;(13):)‘1f1(wj;ﬂlaZI)+)V2f2(Wj;/12722)
+l3f3(Wj; l13, E3)+l4f4(Wj; l14, Z4) (3)

where, as above, 0.1, fig, 21 and 22 are the means and covariance matrices
of the RSNE and RSE component and [—1.3 = ([12, [11), [—14 201,1, [12), 23 = 24
are the means and covariance matrices of the two RDE components. From (3)
and Figure IE, it becomes clear that the differentially enriched components
are governed by different combinations of the means of the enriched and
non—enriched component. This constraint has the direct interpretation that
chromatin changes that may have arisen in one sample compared with the
other sample can be deﬁned by ‘full’ transitions from enrichment to non—
enrichment or vice versa. We assume that the two RDE components are
characterized by a homoscedastic variance—covariance structure.

2.1.3 Flexible-switching model (Model 3) Model 2 represents only a
special case of a more ﬂexible model in which chromatin transitions can
either be more subtle or more severe. This implies that the means of the
RDE components can differ from those of the RSNE and RSE components.
This ﬂexibility is provided by allowing the RDE components to be governed
by a separate set of means M3 and M4 that may or may not equal the means of
the enriched and non—enriched signals. The form of this type of model is as
in (3) but now with symmetrical constraint 0.3 201.4413) and ﬂ4 = (n.3, M4),
where most likely but not necessarily M3 75 m and M4 75 [12.

2.1.4 Estimation and classification Parameter estimation is carried
out in a maximum likelihood framework. In this case, the maximum
likelihood estimates (MLEs) must fulﬁll VlogL(\IJ|w)=0, where w:
(wj:1,w,-:2,...,w,,) and thijlw)=1‘[jf(wj;xij) is the likelihood function.
Solutions can be obtained iteratively via the EM algorithm (Dempster
et al., 1977; McLachlan and Peel, 2000) subject to the speciﬁc mean
and covariance constraints of each model. In genome—wide ChIP—chip and
ChIP—seq applications, the dimension n can be large. This can pose serious
computational difﬁculties when applying any global classiﬁcation approach.
To account for this, we implemented an incremental updating strategy
for the EM algorithm (IEM), which considerably speeds up convergence
(McLachlan and Peel, 2000). We also provide approximations to the standard
errors (SE) of the ﬁnal parameter estimates by calculating the so—called
empirical information matrix Ie(\IJ; W) (Meilijson, 1989) evaluated at the
MLEs as

1e(\IJ;w)=ZVlogL(\IJ|Wj)VT10gL(‘I’|Wj) (4)
j=l

Once the parameter estimates, \IJ, have been obtained, each Wj can be

given a probable component membership via its posterior density Ti(Wj; \If) 2

iifl-(Wj; 0,)/ f (Wj; ‘3). The highest posterior density of region j corresponds
to its most probable membership. This probability assignment provides a
quantitative measure of the locus—speciﬁc chromatin status, which is an
attractive feature given the fact that chromatin measures over a deﬁned region
are likely not discrete.

2.1.5 Criteria for model comparisons The parametric clustering approach
outlined above lends itself to a global evaluation of the best ﬁtting model
to the observed data. This is similar to testing a single hypothesis about the
entire genome. For these model comparisons, we utilize the commonly used
Akaike Information criterion (AIC; Akaike, 1974), as extensive simulations
(data not shown) indicate that this criterion appears to be very reliable in the
context of our modeling framework. The AIC is deﬁned as AIC = 2k — 2ln(L),
where k denotes the number of parameters in the model and L is the likelihood
value of the model. The model with the lowest AIC is favored.

2.1.6 Annotation-based genome partitioning The proposed mixture
modeling approach can also ﬂexibly incorporate information about speciﬁc

sequence contexts. To illustrate this, suppose each signal Wj (j=1,...,n),
can be assigned, a priori, to one of m mutually exclusive annotation sets
Sl,Sz,...,Sm, corresponding to genes, promoters, transposable elements,
CpG islands, etc. Let n1,n2, ...,nm denote the respective sizes of these sets.
Deﬁne @(Wj;Sk) to be an indicator function performing this assignment,
with @(W,-; Sk)=l if Wj e Sk and 0 otherwise. Thus, the ‘composite’ mixture
density of Wj is given by

m
few; xv): 29m; Sk)7kfsk(WJ-; we). (5)
k=1
In this way, the density contributions are simply weighted by a constant
that is proportional to the relative size of the set. Accordingly, the logarithm
of the likelihood function can be written as

logLe(®Iw)=A+ZlogLs,(®skstk), (6)
k=1

where A: —nlogn+ZZ“:1nSklog(n5k). Hence, in the case where the
parameters are uniquely indexed across annotation sets 51,52, ...,Sm, the
estimation of the likelihood function can be performed independently for
each set, and then compared with an analysis where no such a prior
categorization was performed. This partitioning strategy can also be useful if
certain sequences are known to affect the signal distribution due to technical
reasons, such as cross—hybridization, or ampliﬁcation and sequencing biases.
Formal model comparison procedure, such as the AIC, can be employed to
assess if a separate treatment of different sequence contexts is warranted. For
the sake of clarity, we will restrict ourselves to the special case of no a prior
partitioning. However, we do provide a full example of its implementation
in the Supplementary Material.

2.2 Data description and normalization

2.2.1 ChIP-chip data We consider two publicly available ChIP—chip
datasets. The ﬁrst ChIP—chip experiment compares the genome—wide
methylation proﬁles of a wild—type Arabidopsis plant to that of a methylation
maintenance mutant (Penterman et al., 2007). ChIP samples were hybridized
to NimbleGen tiling arrays consisting of 382178 probes with an average
length of 45—85 bp. The second ChIP—chip dataset compares genome—wide
promoter methylation between mouse embryonic germ cells and sperm cells
(Farthing et al., 2008). This experiment used mouse NimbleGen promoter
tiling arrays. Arrays were composed of 1.5 kb promoter regions for a set
of 26 275 mouse genes. On average, tiled regions contained 15 probes
(50 bp length) separated by a 50 bp gap. We refer the reader to the original
publications for details concerning sample preparation.

In the ChIP—chip Arabidopsis experiment, we calculated the signal
ratios for the j—th tile on the array as xj=log2(IPj,wt/Inputjaw,) and yj=
log2(IPj,mt/Inputj,m,), where wt and mt denote the wild—type and mutant
genotypes, respectively. Each genotype was represented by a single array.
For the ChIP—chip mouse data, dye—swaps were available for each of
the two cell types, embryonic germ cells (EG) and sperm cells (SP).
Hence, the signal ratios were taken as xj =log2(IPj,Eg/InputjaEG) and yj =
log2(IPj,Sp/Inputjasp), where the IPj and Input-, in this case, represent the
average of the swap of Cy3 and the Cy5 signal. Due to the constraints
imposed on the component means of the mixture model, we required that
the signal distribution of both samples be brought to a common scale, and
therefore applied quantile normalization using standard software (Gentleman
et al., 2004).

2.2.2 ChIP-seq data The unpublished ChIP—seq dataset investigates the
differences in the distribution of TATA—binding protein (TBP) across the
human genome between BTAFl and GAPDH knockdown HeLa cells derived
from human cervix carcinoma. A protocol outlining sample preparation and
library construction is provided in the Supplementary Material. Overall,
the ChIP—seq data considered here consists of three independent deep—
sequencing experiments (using SOLiD technology), two involving the

 

1 002

112 /§JO'S{BUJnolpJOJXO'SOIlBIHJOJUIOIQ/ﬁdnq 1110.1} popnoplmoq

9IOZ ‘Ig lsnﬁnv uo ::

Comparison of genome-wide chromatin profiles

 

immunoprecipitate (pull—down) of the GAPDH and BTAFl knockdown
samples (IPB and 1P0, respectively), as well as one common Input control
sample (IC). The total number of mapped reads for each of these experiments
were IPG = 2798922, IPB = 5064143 and IC = 4296061. Consistent with
previous approaches for ChIP—seq analysis (J i et al., 2008), we partitioned the
genome into bins of size 1 kb, with each bin containing the total read counts
in that particular region. Since there was a 1.5— to 2—fold difference in the total
number of reads between these three experiments, we normalized the read
counts as follows: let Kjap denote the count for the j—th bin and p—th experiment
(p = 1,2,3), and take the average total count across the three experiments as
E: %(Zp ZjKJ-ap). Hence, a normalized count can be given by

K- _
Kl =i.[{ (7)
LP ZjKjJ?

Bins with a value of zero in all three deep—sequencing experiments
were removed from further analysis. Finally, we express the Input—

normalized signal as xj=log2{(I+I§{,IPB)/(I+I§{,IC)} and yj=log2

{(1+K;,IPG)/(1+KJT,IC)}, followed by quantile normalization of the two
‘signal’ vectors. As already pointed out by others (Kharchenko et al.,
2008), read adjustments within and across experiments invariably result
in continuous rather than count data. This justiﬁes the use of continuous
density functions in the context of multiple—sample ChIP—seq experiments.
Nonetheless, care should be taken when applying the above normalization
as the linearity assumption in the scaling of reads may break down
when read counts in one or several samples are either too low (i.e. near
background) or too high (i.e. near saturation). This consideration deserves
further research.

3 RESULTS

3.1 Arabidopsis genome-wide methylation data

As a ﬁrst data example, we consider the experiment by Penterman
et al. (2007). This study compared the methylation proﬁle of a
wild—type Arabidopsis plant to that of a r0s1-3; dml2-1; dml3-1
triple mutant. All three genes are members of the DEMETER
(DME) family, which is known to be involved in the removal of
methylcytosine from DNA, and in establishing genomic imprinting
patterns in the endosperm. It was hypothesized that a disruption
of the DME genes leads to locus—speciﬁc hypermethylation. To
identify candidate loci that are targeted by DME enzymes, the
authors resorted to a genome—wide ChIP—chip approach.
Supplementary Figure S2 shows a univariate plot of the quantile—
normalized signal distribution of the original data, as well as a
bivariate plot of the wild—type array signal against that of the triple
mutant. In both cases, the data structure visually complies with our
expectations. We applied our models to this data treating individual
probes on the tiling array as separate units of analysis. The results
show that Model 2 provides the best overall ﬁt (Fig. 2A). This
conﬁrms that the triple mutation leads to non—negligible changes in
methylation levels. As anticipated, we estimate that ~0.35% (SE =
8.48 X 10‘3) of all tested regions had become hypermethylated
in the mutant relative to the wild—type (Fig. 2A), but also note a
0.15% reduction in methylation (SE:2.38 X 10‘3). This locus—
speciﬁc hypomethylation in the mutant is unexpected and suggests
an additional role of the DME genes in de novo methylation;
alternatively, it reﬂects the presence of genomic mechanisms
that counteract pervasive hypermethylation through epigenetically
mediated compensatory pathways. Apart from the differentially
methylated regions, we also estimate that 35.4% (SE = 1.7 X 10‘2)
of the Arabidopsis genome is methylated in both genotypes, a

   

 

    

A Null Best ﬁtting Diffem-noe 1%}
model model signal
. I E II . = - 1 E
E “ ' i": | i
E- . in . E I | a
| I E
d. . II I
1 I _ z'l Iv.- -
-I I'  I a} II I I 5
WILD TI'P'E nnnl WILDT'I'FE ngnnl WILD n'pE -mAHT
B
E. . E - '." i 21] .
e I_ - ' ' :31: i I.“
E a - EL 3
. . E
“I - ' _ L.' “I - n. “g
'I I genuine}.qu d GERMHS-SFERM I
c _ 
E ‘ 5" Fiﬁ? :I- 3 a
to  i   i  l
I. ,_ £3. 3. nﬁiu . g 'l
“ "gall-""15 ﬁt?!    i
ll _ 3:... II =:_ ., I II?” .I -. .Id at
q   - I ,1 . 'ir  u - -:I- ‘J’III ' 'IIK‘II-h'  ‘5'

 

kd'BTiﬁ; Hun; BTlﬂFthm; EH! II.|‘.I.- GAPDH H.11. I
Fig. 2. Mixture modeling results for the three example datasets. (A—C) The
results for the Arabidopsis, mouse and human data examples, respectively.
The color coding in these ﬁgures is consistent with the notation introduced
in Figure 1. In each panel, the ﬁrst plot shows the mixture model solution for
the null model. The second plot provides the solution for the best ﬁtting
model; the third plot, is a univariate version of the best ﬁtting model,
which is obtained by calculating the signal difference between the two
samples (i.e. sample 1 and sample 2), while keeping track of the most likely
classiﬁcation. This univariate plot reveals the potential difﬁculty in using
univariate methods to de—convolute the RSE distribution (light gray) from the
RSNE distribution (dark gray). The fourth plot (pie—charts) shows a summary
of the genome—wide classiﬁcation results in terms of percentages.

number that is roughly consistent with previous reports (Zilberman
et al., 2007).

3.2 Mouse promoter methylation data

Cell differentiation processes are accompanied by speciﬁc changes
in DNA methylation patterns in gene promoters (Reik, 2007). This
reprogramming is necessary to return the cell to a pluripotent
state. How many of these changes are taking place and their
level of tissue speciﬁcity is currently under intense investigation.
In order to understand promoter methylation changes, Farthing
et al. (2008) carried out a genome—wide promoter analysis of
DNA methylation in mouse embryonic stem (ES) cells, embryonic
germ (EG) cells, sperm, trophoblast stem (TS) cells and primary
embryonic ﬁbroblasts (pMEFs) using ChIP—chip promoter tiling
arrays. For illustrative purposes, we focus on a comparison between
EG and sperm cells.

Supplementary Figure S2 shows the univariate and bivariate plots
of the genome—wide mouse promoter methylome data. By visual
inspection, the bivariate plot of the methylation signals of EG
cells (x—axis) against those of the sperm cells (y—axis) suggests the
presence of RDE, with data points scattering along off—diagonal
components. Interestingly, applying our approach to this data, we
ﬁnd that Model 3 provides the best ﬁt (Fig. 2B). As the means of the
RDE components (red and green) are between those of the RSE and
the RSNE components, we conclude that the methylation differences
between the tissues are, at least globally, more subtle than under a

 

1 003

112 /§JO'S{BUJHOIpJOJXO'SOIlBIHJOJUIOIQ/ﬁdnq urorj popl201umoq

9IOZ ‘Ig lsnﬁnv uo ::

F.Johannes et al.

 

model that posits full transitions between the methylation states. It
is tempting to speculate that such subtle global methylation changes
are a common feature during tissue development, and are sufﬁcient
to contribute to the establishment of new cell identities.

On a genome—wide scale, we estimate that promoter methylation
in EG cells is higher compared with sperm cells. This observation
contradicts the patterns seen for particular candidate loci that
transition from a hypomethylated to a hypermethylated state during
the process of differentiation/specialization (Farthing et al., 2008).
Using a classiﬁcation based on maximum posterior loadings, we ﬁnd
that a total of ~12% (SE: 6.04 X 10‘4) of the measured regions
(i.e. tiles on the array) are differentially methylated between the two
tissues.

3.3 Human basal transcription factor data

The last data example illustrates the application of our method
to the more recent ChIP—seq technology. The goal of the ChIP—
seq study was to investigate the distribution of the TBP across
the human genome. TBP is the DNA—binding subunit of the basal
transcription factor TFIID as well as for other complexes of RNA
polymerase I and II (Sharp, 1992). The BTAFl ATPase forms a stable
complex with TBP and regulates its activity in pol II transcription.
We hypthesized that BTAFl is involved in the mobilization of TBP
from promoter and non—promoter sites (Pereira et al., 2003). To test
this hypothesis, TBP ChIP samples were prepared from human HeLa
cervix carcinoma cells after knockdown of BTAFl expression and
compared with HeLa cells with a control knockdown of GAPDH.
GAPDH is a cytosolic enzyme that participates in glycolysis, and
its inactivation is not expected to affect the genomic distribution of
TBP, and acts as negative control. ChIP samples were sequenced
using SOLiD technology along with the Input samples. The data
were normalized as described above.

Based on previous work in yeast (Li et al., 2000), we expected
the effect of the BTAFl knockdown to result in an overall reduction
in binding of TBP to promoters and redistribution of TBP to the
many A/T—rich, non—promoter sequences in the human genome.
At the same time, TBP enrichment in the GAPDH knockdown
condition should remain unchanged. Under the assumption that
TBP removal is efﬁcient, we anticipated substantial RDE between
the BTAFl and the GAPDH knockdown samples, and limited
RSE. Fitting our mixture models to these data, we ﬁnd that
Model 2 provides the best ﬁt (Fig. 2C). From these mixture results,
we highlight two important ﬁndings: ﬁrst, using a classiﬁcation
based on maximum posterior loadings, we discovered a substantial
amount (30%; SE=6.4 X 10‘3) of RSE (light gray), suggesting
that the BTAFl knockdown does not affect a large percentage
of sequences harboring TBP despite BTAFl inactivation. These
RSE corresponded mostly (96.13%) to non—promoter sequences.
The second important observation relates to the fact that RDE are
more prevalent in the direction of BTAFl than in the direction of
GAPDH (0.9%; SE = 1.43 x 10—3 versus 0.1% SE = 6.79 x 10—4).
This indicates that RDE are predominantly deﬁned by increased
TBP levels in the BTAFl relative to the GAPDH knockdown in this
system. Interestingly, a disproportionally high number of sequences
contained in the 0.9% of RDE for which BTAFl shows more TBP
binding compared with GAPDH (red), corresponds to annotated
promoters (50.09%). This trend becomes even more pronounced
when we use a more stringent classiﬁcation cutoff (Table 1).

Table 1. Overlap between detected RDE bins and promoter regions

 

RDE overlapping promoters

 

 

BTAFl >GAPDH GAPDH > BTAFl
Model 2 3152/4440 (71%) 29/947 (3%)
CisGenome 3591/5076 (70%) 34/585 (6%)
SISSRs 1273/1538 (83%) 28/166(l7%)

 

We distinguish two types of RDE, BTAF l > GAPDH and GAPDH > BTAF 1. Listed are
the number of detected bins that map to annotated promoters over the total detected
number within each of the two RDE categories (at FDR = 0.05). Promoter regions were
deﬁned as —2kb to +500 bp relative to the TSS.

We have veriﬁed this observation using ChIP—PCR experiments on a
limited set of genomic regions (data not shown). These ﬁndings point
toward a primary role of BTAFl in the mobilization (or removal) of
TBP from promoter sites, which explains the overaccumulation of
TBP at these locations in the BTAFl knockdown background. This
proposal agrees well with our recent ﬁnding that the BTAFl ortholog
in yeast, Motlp, mostly resides on promoter regions as shown by
genome—wide ChIP—chip (van Werven et al., 2008). More detailed
bioinformatic and experimental work will provide additional insight
into the speciﬁc promoter contexts underlying the detected RDE.

3.4 Comparison with alternative approaches

3.4.1 Problem statement We compared our approach with four
representative methods for ChIP—chip and ChIP—seq analysis
(ChIPmix, ChIPmonk, CisGenome, SISSRs). Speciﬁc criteria for
this selection are detailed in the Supplementary Material (see
also Supplementary Tables S1 and S2). The goal was to test the
performance of each approach in detecting RDE using the example
datasets. It is worth noting that there were three major obstacles to
a direct comparison.

First, nearly all available methods are speciﬁcally designed for
single ChIP sample analysis (Input—normalized or unnormalized).
In this case, the detection of signal differences between experiments
(e.g. BTAFl versus GAPDH) had to be done in an ad hoc fashion.
This forced us to analyze each experiment separately. RDE were
then deﬁned, informally, as those regions for which enrichment was
detected in one experiment but not in the other, and vice versa.

The second obstacle is the use of inconsistent deﬁnitions of
peak regions between methods. It was therefore important to ﬁnd a
common unit of analysis so that total RDE counts were comparable.
In the case of the ChIP—chip data, a convenient choice was the mouse
promoter methylation example, because any number of peak regions
detected within a promoter could be reported in terms of promoter
units; that is, the presence of one or more differential peak regions
resulted in calling the entire promoter RDE. In the human ChIP—seq
data example, we used the imposed 1 kb bin structure as a common
unit of references (i.e. given differential peaks anywhere within a
bin, the whole bin was reported as a RDE).

The third obstacle relates to the choice of an appropriate false
discovery rate (FDR) for calling signiﬁcant RDE on a genome—
wide scale. Ideally, this should be based on a known (or estimated)
null distribution of no enrichment differences between ChIP
samples. However, with methods where ChIP samples are analyzed
separately, such FDR calculations are not available. Our parametric

 

1 004

112 /§JO'S{BUJHOIpJOJXO'SOIlBIHJOJUIOIQ/ﬁdnq urorj pop1201umoq

9IOZ ‘Ig lsnﬁnv uo ::

Comparison of genome-wide chromatin profiles

 

mow-$313 mdal 2
Chipmunk

  

SISSRE

 

ChIPmix

CisGenome

Fig. 3. Comparison of methods for RDE mapping. Left: comparison of
ChIPmonk, ChIPmix and Model 3 in detecting RDE in the mouse promoter
methylation data (counts are in terms of numbers of promoters). Right:
comparison of CisGenome, SISSRs and Model 2 in detecting RDE in the
human transcription factor data (counts are in terms of numbers of 1 kb bins).

classiﬁcation approach elegantly circumvents this problem by
providing an estimated null distribution as part of the analysis.
This can be directly used for FDR determination (Supplementary
Material). In the absence of a more formal approach, we adopted
the following strategy: whenever ChIP samples had to be analyzed
separately (ChIPmix, CisGenome, SISSRs), a FDR for ﬁnding
enrichment peaks within the sample was applied. In this context,
we imposed no further formal requirement to determine enrichment
differences between experiments. In contrast, when differences
between ChIP samples could be assessed directly (ChIPmonk,
Model 2, Model 3), an appropriate FDR was chosen. A stringent
FDR cutoff of 0.05 was applied throughout.

3.4.2 ChIP-chip methods comparison We applied ChIPmix
(Martin—Magniette et al., 2008), ChIPmonk (Andrews, 2007) and
our best ﬁtting model (Model 3) to the mouse promoter methylation
data (Fig. 3). ChIPmix differed notably from the other two methods
in the total number of promoters detected as RDE (12507, 1226,
3972, for ChIPmix, ChIPmonk and Model 3, respectively). Only
3% of the RDE detected by ChIPmix overlapped with the other
two methods. Better percentages were found for ChIPmonk (34%
overlap) and Model 3 (11% overlap). The relatively high overlap
percentage for ChIPmonk suggests high speciﬁcity. However, this
advantage is probably offset by low sensitivity: 1891 promoters
overlapping between ChIPmix and Model 3 went undetected with
ChIPmonk. This could relate to the fact that ChIPmonk uses a sliding
window approach where the signal of several consecutive tiles are
pooled. ChIPmix and Model 3, on the other hand, use individual
tiles in the analysis. This can lead to the detection of promoters
that are subject to single tile differences. Analyses of other ChIP—
chip datasets indicate that such localized differences can indeed lead
to functional consequences on downstream gene expression (data
not shown). Importantly, 99.67% of the 9675 RDE promoters that
appear to be speciﬁc to ChIPmix were formally classiﬁed as RSE by
Model 3. We can attribute this to the fact that the RDE classiﬁcation
with ChIPmix was performed ad hoc, whereas Model 3 explicitly
modeled the null distribution of no methylation differences between
ChIP samples. Similar arguments can be given for the unique overlap

(513 promoters) between ChIPmonk and ChIPmix, 98% and 2% of
which were classiﬁed as RSE and RSNE by Model 3, respectively.

3.4.3 ChIP-seq methods comparison We applied SISSRs (Jothi
et al., 2008), CisGenome (Ji et al., 2008) and our best ﬁtting
model (Model 2) to the human transcription factor data (Fig. 3).
CisGenome and Model 2 detected a comparable number of bins
as RDE (5661 and 5387, respectively), whereas SISSRs detected
relatively few (1704). Overall 661 RDE bins overlapped between
the three methods, resulting in an overlap percentage of 38%,
11%, and 12% for SISSRs, CisGenome and Model 2, respectively.
Similar to ChIPmonk above, SIS SRs may suffer from low sensitivity
with a substantial number of overlapping bins (1331) between
CisGenome and Model 2, escaping detection with this method.
Again, it is noteworthy that among the 722 bins that overlap
exclusively between SISSRs and CisGenome, 30% were identiﬁed
as RSE and 70% RSNE by Model 2.

It is perhaps most instructive to relate the performance of these
three ChIP—seq methods back to our biological expectations of the
BTAF1 knockdown system. As discussed above, a disruption of
BTAF1 leads to an overaccumulation of TBP at promoters relative to
the GAPDH condition. Hence, we expect RDE to be in the direction
of BTAF1 rather than GAPDH (i.e. BTAF1 > GAPDH rather than
GAPDH > BTAF1). At a FDR = 0.05, Model 2 provides the clearest
support for this expectation with 71% of the bins classiﬁed as RDE
(BTAF1 >GAPDH) mapping to promoter regions, compared with
only 3% of the bins classiﬁed as RDE (GAPDH > BTAF1). The other
methods showed a similar, but less pronounced trend (Table 1).

3.4.4 Common clustering approaches Clustering methods are
common in hi gh—dimensional classiﬁcation problems, particularly in
the analysis of microarray gene expression studies (Quackenbush,
2001). We therefore compared our approach with three popular
clustering algorithms, hierarchical clustering, K —means partitioning
and the model—based multivariate normal clustering as implemented
through the Mclust R package. The details of this analysis are
provided in the Supplementary Material. Our general conclusions
highlight the poor performance of these alternative approaches in
the context of ChIP—chip and ChIP—seq data, particularly with regard
to detecting RDE. We attribute this to the lack of biologically
meaningful constraints in these clustering procedures, which can
prevent the identiﬁcation of smaller clusters corresponding to RDE.
Furthermore, the size of typical ChIP—chip or ChIP—seq datasets
makes these methods computational infeasible.

4 DISCUSSION

We presented a parametric classiﬁcation method for genome—wide
comparisons of chromatin proﬁles between multiple ChIP samples.
For simplicity, we focused our discussion on the special case of
a two—sample comparison. Extensions to additional dimensions are
possible. The number of components that have to be considered to
capture the RDE structure between additional conditions increases
at a rate 2d, where d denotes the number of conditions involved
in the comparison. While the interpretation of the classiﬁcation
results becomes increasingly complex, the actual modeling beneﬁts
greatly from the imposed parameter constraints so that the number
of parameters to be estimated increases at a much slower rate.

 

1 005

112 /BJO'S[BUJHOIPJOJXO'SOIlBIHJOJUIOIQ/ﬁdnq urorj pop1201umoq

9IOZ ‘Ig lsnﬁnv uo ::

F.Johannes et al.

 

The proposed approach provides a conceptual framework for
the analysis of ChIP—chip and ChIP—seq data. Future work should
consider the use of alternative density functions, such as the
multivariate t—distribution (Peel and McLachlan, 2000) for ChIP—
chip data, and some type multivariate discrete distribution for
ChIP—seq. The key issue will be to explore the trade—off between
model robustness on the one hand, and sensitivity—speciﬁcity on the
other.

Another interesting extension of our method is to reformulate
the mixture approach in the context of a hidden Markov modeling
(HMM) framework. In this case, the RDE, RSE and RSNE
components can be viewed as hidden Markov states and the mixture
densities as the so—called emission probabilities. With ChIP—chip and
ChIP— seq measurements collected from the same biological samples,
it may even be possible to integrate these two data sources within
a single HMM analysis, as previously attempted by Choi et al.
(2009). While an HMM approach could be appealing, we note that
its implementation would forfeit the, arguably, useful annotation—
based genome partitioning scheme outlined above. Additionally, it
still remains to be seen whether the Markov property of conditional
independence between neighboring chromatin states is a valid
assumption for this type of data.

ACKNOWLEDGEMENTS

We thank three anonymous reviewers for making this a better
manuscript; W. Reik, S. Andrews for the mouse promoter
methylation data and very helpful comments; V. Colot and
W. Krijnen for stimulating discussions; H. Stunnenberg (Radboud
University Nijmegen) for the SL30 antibody against human TBP.

Funding: The authors were supported by grants from the
Netherlands Proteomics Centre (to RM. and H.Th.M.T.);
Netherlands Organization for Scientiﬁc Research (NWO—CW TOP
700.57.302 to P.dG and H.Th.M.T.); European Union (EUTRACC
LSHG—CT—2006—037445 to  P.dG and H.Th.M.T.); Human
Frontier Science Program (grant LT—0860/ 2005 to RM); Horizon
Breakthrough grant, Netherlands Organization for Scientiﬁc
Research (NWO, 2009 to F.J.).

Conﬂict of interest: none declared.

REFERENCES

Akaike,H. (1974) A new look at the statistical model identiﬁcation. IEEE Trans.
Automat. Contr, 19, 716—723.

Andrews,S. (2007) ChIPmonk: software for viewing and analysing ChIP-on—chip data.
BMC Syst Biol, 1 (Suppl. 1), P80.

Bock,C. et al. (2008) Inter-individual variation of DNA methylation and its implications
for large-scale epigenome mapping. Nucleic Acids Res., 36, e55.

Choi,H. et al. (2009) Hierarchical hidden Markov model with application to joint
analysis of ChIP-chip and ChIP-seq data. Bioinformatics, 15, 1715—1721.

Dempster,A.P. et al. (1977) Maximum likelihood from incomplete data via the EM
algorithm. J. R. Stat. Soc. B., 39, 1—38.

Esteller,M. (2008) Epigenetics in cancer. N. Engl. J. Med, 358, 1148—1159.

Farthing,C.R. et al. (2008) Global Mapping of DNA Methylation in Mouse Promoters
Reveals Epigenetic Reprogramming of Pluripotency Genes. PLoS Genet, 4,
e1000116.

Gentleman,R. et al. (2004) Bioconductor: open software development for computational
biology and bioinformatics. Genome Biol, 5, R80.

Ji,H. et al. (2008) An integrated software system for analyzing ChIP-chip and ChIP-seq
data. Nat Biotechnol, 26, 1293—1300.

Johannes,F. et al. (2008) Epigenome dynamics: a quantitative genetics perspective.
Nat Rev. Genet, 9, 883—890.

J ohannes,F. et al. (2009) Assessing the impact of transgenerational epigenetic variation
on complex traits. PLoS Genet, 5, e1000530.

Jothi,R. et al. (2008) Genome-wide identiﬁcation of in vivo protein-DNA binding sites
from ChIP-Seq data. Nucleic Acids Res., 36, 5221—5231.

Kharchenko,P.V. et al. (2008) Design and analysis of ChIP-seq experiments for DNA-
binding proteins. Nat Biotechnol, 26, 1351—1359.

Li,X.Y. et al. (2000) Distinct classes of yeast promoters revealed by differential TAF
recruitment. Science, 288, 1242—1244.

Martin-Magniette,M. et al. (2008) ChIPmix: mixture model of regressions for two-color
ChIP-chip analysis. Bioinformatics, 24, i181—i186.

McLachlan,G.J. and Peel,D. (2000) Finite Mixture Models. John Wiley and Sons, p. 303.

Meilijson,1. (1989) A fast improvement to the EM algorithm on its own terms. J. R.
Stat. Soc. B., 51, 127—138.

Meissner,A. et al. (2008) Genome-scale DNA methylation maps of pluripotent and
differentiated cells. Nature, 454, 766—770.

Mikkelsen,T.S. et al. (2008) Dissecting direct reprogramming through integrative
genomic analysis. Nature, 454, 49—55.

Peel,D. and McLachlan,G.J. (2000) Robust mixture modelling using the t distribution.
Stat. Comput, 10, 339—348.

Penterman,J. et al. (2007) DNA demethylation in the Arabidopsis genome. Proc. Natl
Acad. Sci. USA, 104, 6752—6757.

Pereira,L.A. et al. (2003) Roles for BTAF1 and Motlp in dynamics of TATA-binding
protein and regulation of RNA polymerase II transcription. Gene, 315, 1—13.

Quackenbush,J. (2001) Computational analysis of microarray data. Nat Rev. Genet, 2,
418—427.

Reik,W. (2007) Stability and ﬂexibility of epigenetic gene regulation in mammalian
development. Nature, 447, 425—432.

Richards,E. (2008) Population epigenetics. Curr. Opin. Genet. Dev., 18, 221—226.

Schwarz,G. (1978) Estimating the dimension of a model. Ann. Stat, 6, 461—464.

Sharp,P.A. (1992) TATA-binding protein is a classless factor. Cell, 68, 819—821.

Suzuki,M.M. and Bird,A. (2008) DNA methylation landscapes: provocative insights
from epigenomics. Nat Rev. Genet, 9, 465—476.

Vaughn,M.W. et al. (2007) Epigenetic natural variation in Arabidopsis thaliana.
PLoS Biol, 5, e174.

Vermeulen,M. et al. (2007) Selective anchoring of TFIID to nucleosomes by
trimethylation of histone H3 lysine 4. Cell, 131, 58—69.

van Werven,F.J. et al. (2008) Cooperative action of N C2 and Motlp to regulate TATA-
binding protein function across the genome. Genes Dev., 22, 2359—2369.

Zilberman,D. et al. (2007) Genome-wide analysis of Arabidopsis thaliana DNA
methylation uncovers an interdependence between methylation and transcription.
Nat Genet, 39, 61—69.

 

1 006

112 /B.IO'S[BU.IHOIp.IOJXO'SOIlBIHJOJUIOIQ/ﬁdnq urorj pop1201umoq

9IOZ ‘Ig lsnﬁnv uo ::

