APPLICA TIONS NOTE V°" 2302?5.11%Sé’ibiaiiiﬁaliiilié‘2

 

Systems biology

Advance Access publication March 18, 2013

SRV: an open-source toolbox to accelerate the recovery of
metabolic biomarkers and correlations from metabolic

phenotyping datasets

Vincent Navratill’

*’l, Clement Pontoizeau‘, Elise Billoir2 and Benjamin J. Blaise”

1Centre de RMN a Tree Hauts Champs, Institut des sciences analytiques, CNRS/ENS Lyon/UCB Lyon 1, Université de
Lyon, 5 rue de la Doua, 69100 Villeurbanne, France and 2Plateforme de Recherche de Rovaltain en Toxicologie
Environnementale et Ecotoxicologie, 1 avenue de la Gare, BP 15173, 26958 Valence Cedex 9, France

Associate Editor: Martin Bishop

 

ABSTRACT

Motivation: Supervised multivariate statistical analyses are often
required to analyze the high-density spectral information in metabolic
datasets acquired from complex mixtures in metabolic phenotyping
studies. Here we present an implementation of the SRV—Statistical
Recoupling of Variables—algorithm as an open-source Matlab and
GNU Octave toolbox. SRV allows the identification of similarity be-
tween consecutive variables resulting from the high-resolution buck-
eting. Similar variables are gathered to restore the spectral
dependency within the datasets and identify metabolic NMR signals.
The correlation and significance of these new NMR variables for a
given effect under study can then be measured and represented on
a loading plot to allow a visual and efficient identiﬁcation of candidate
biomarkers. Further on, correlations between these candidate bio-
markers can be visualized on a two-dimensional pseudospectrum,
representing a correlation map, helping to understand the modifica-
tions of the underlying metabolic network.

Availability: SRV toolbox is encoded in MATLAB R2008A (Mathworks,
Natick, MA) and in GNU Octave. It is available free of charge at http://
www.prabi.fr/redmine/projects/srv/repository with a tutorial.

Contact: benjamin.blaise@chu-lyon.fr or Vincent.navratil@univ—lyon1 .fr

Received and revised on February 20, 2013; accepted on
March 12, 2013

1 INTRODUCTION

Given the complexity of metabolic samples used in metabonomics
to understand the metabolic response of an organism to patho-
physiological stimuli (Nicholson et al., 1999), the development of
efﬁcient approaches to fully analyze datasets is a growing ﬁeld
(LaVine and Workman, 2010). An NMR spectrum typically con-
tains a few hundreds of resonances over a 10-ppm-wide chemical
shift range. A high-resolution bucketing, using 0.001-ppm-wide
buckets, leads to an efficient sampling of the signal, matching the
high resolution of the NMR spectra, and results in a few thousands
of variables to handle for further statistical analyses. Multivariate
statistical analyses, such as orthogonal partial least squares

 

*To whom correspondence should be addressed.

TPresent address: Pole Rhone Alpes de Bioinformatique, Université Lyon
1, Batiment Gregor Mendel, 16 rue Raphael Dubois, 69100 Villeurbanne,
France.

(O-PLS) regressions (Trygg and Wold, 2002), are thus efficient
tools to explore these high-density information datasets and com-
bine collective modiﬁcations of metabolite concentrations to allow
a discrimination of the samples with respect to the effect under
study.

However, the interpretation of the latent variables, which are
the results of multivariate statistical analyses, is far from trivial.
The mainly used approach is to combine the representation of
the latent variable with the Pearson correlation coefﬁcients of
each variable with the information matrix, encoding the different
classes (Cloarec et al., 2005). The difﬁculty with this approach is
that multiple buckets represent a single NMR peak. It thus
shows different levels of correlation, despite the fact that it rep-
resents a single metabolic signal. A second difﬁculty is the def-
inition of a correlation threshold above which a signal can be
considered as valuable to designate a candidate biomarker.

Statistical Recoupling of Variables (SRW is an algorithm de-
signed to overthrow these main difﬁculties (Blaise et al., 2009).
The conducting idea is to restore the spectral dependency that
was lost by high-resolution bucketing. The statistical relation-
ships between consecutive variables allow aggregating them
into clusters following the highest direction of covariance/correl-
ation ratio, thus deﬁning NMR peaks. Neighbouring clusters can
then be merged into superclusters to recover NMR multiplets.
These superclusters correspond to NMR variables of interest.
SRV thus acts as an automated variable-size bucketing proced-
ure coupled with an efﬁcient noise-removing ﬁlter.

We then use a signiﬁcance-testing ﬁlter using multiple hypoth-
esis testing corrections. The Benjamini—Yekutieli measurement
of the false discovery rate seems adapted to NMR-based meta-
bonomics (Benjamini and Yekutieli, 2001), but other less strict
corrections could be considered. A typical threshold of 0.05 can
then be deﬁned, and a simple identiﬁcation of statistically sig-
niﬁcant signals allows the recovery of candidate biomarkers.

Based on the statistical total correlation spectroscopy (Cloarec
et al., 2005), it is possible to establish a two-dimensional (2D)
pseudospectrum deﬁned as a correlation map between the super-
clusters. These correlations can eventually be interpreted on the
global metabolic network to extract the perturbed metabolic net-
work associated with a major or minor perturbation (Blaise
et al., 2010, 2011). Here we present an open-source implementa-
tion of the SRV algorithm as MATLAB/GNU Octave functions
leading to the Visualization of the latent variables after O-PLS

 

1348 © The Author 2013. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oup.com

112 ﬂJO'smumo[pJOJXO'sopcuuogurorq/ﬁd11q wort pepcolumoq

910K ‘09 lsnﬁnV no :2

SRV: an open-source toolbox

 

analysis for the discrimination between two groups, with the
correlation and signiﬁcance testing representation, and the 2D
pseudospectrum allowing the identiﬁcation of coordinated
metabolic variations.

2 DESCRIPTION OF THE SRV ALGORITHM AND
IMPLEMENTATION

The SRV algorithm is divided into ﬁve steps, as schematically
described in the following text (Blaise et al., 2009). The ﬁrst three
steps correspond to the statistical mining of metabolite bio-
marker signals (i.e. the SRV clusters) from a set of NMR spectra.

Step 1: Deﬁnition of a spectral dependency landscape (L) as
the covariance/correlation ratio between neighbouring variables
along the chemical shift axis:

covariance
—. i i 1 = variancei x variancei 1
correlat10n(’ + ) \/ 0 ( + )

= Gin—2f) x Gﬁaw 1)— (i+—1))2)

 

L(z') =

 

i=1 i=1
Step 2: Identiﬁcation of spectral SRV clusters.

(i) The ﬁrst variable of the dataset starts the ﬁrst cluster.

(ii) The spectral dependency landscape is scanned to identify
local minima of covariance/correlation ratio that represent
the borders between two clusters.

(iii) Clusters representing NMR signals are deﬁned by a min-
imum number of variables, which depends on the reso-
lution of the NMR spectra.

Step 3: Identiﬁcation of NMR variables.

(iV) Superclusters are based on the aggregation of clusters de-
pending on their correlation with their neighbouring clusters.

(V) The intensity of the supercluster is the mean of the inten-
sities of the NMR signal in the buckets assigned to the
supercluster.

Step 4: Evaluation of P—Values and multiple dependent tests
correction using the Benjamini—Yekutieli false discovery rate
(Benjamini and Yekutieli, 2001). An adjusted P-Value threshold
is estimated by the identiﬁcation of the highest rank verifying the
equation below, where N is the number of variables used in the
model. We then can reject all null hypotheses corresponding to
rank 1 to k.

i X 0.05
N

NX 
i=1

The command line is executed as follow: [Data, Xclusterf,
Ibegin, Iend, number of clusters]=SRV QC matrix, Y matrix,
typical singlet peak base width, bucketing resolution, correlation
threshold, signiﬁcance threshold, ppm, number of factors).

We commonly use the analysis of variance for the evaluation of
P—Values and the Benj amini—Yekutieli correction for the measure-
ment of the false discovery rate in our NMR metabolic phenotyp-
ing datasets. However, other evaluation procedures can be used
on SRV clusters based on the properties of the variables under

k=max i=1:N,p,-<

study. SRV clusters are available in the output Xclusterf of the
SRV function. Data is a four-row table containing the ppm line,
the loading value, the correlation value and the signiﬁcance of
each initial NMR variable. Xclusterf is a matrix containing the
intensity of the signal in each cluster for the different spectra of the
dataset. Ibegin and Iend are tables containing the limits of each
cluster, and S is a table allowing the identiﬁcation of the initial
NMR signal contained in the SRV clusters and the amount of
signal lost. X matrix is the dataset matrix with spectra in row.
Columns of zeros must represent the excluded residual water
signal area. SRV is not able to deal with multiple exclusion
areas (for instance, NMR buffer signals). In such cases, additional
exclusion areas should simply be removed from the dataset before
the use of SRV. One can eventually choose to reintroduce these
areas in the output matrix of SRV. For the corresponding chem-
ical shifts, O-PLS coefﬁcients and correlation values should be put
to 0 and P—Values to 1. Y matrix is the column vector encoding the
membership of each sample to the groups under study. ppm is a
row vector containing the ppm value of each bucket. Number of
factors is the total number of components for the O-PLS analysis,
including the orthogonal ones. The main output of the function is
the loading plot of the O-PLS analysis (Cloarec et al., 20054) with
a colour code of correlation. Variables that are not statistically
signiﬁcant are coloured in grey.

Step 5: Computation and Visualization of the SRV 2D
pseudospectrum. Finally, after a deﬂation of the data matrix by
an O-PLS analysis based on the class information matrix (Trygg
and Wold, 2002), we compute the autocorrelation matrix between
SRV clusters identiﬁed within the dataset (Cloarec et al., 2005).

[ORStocsy, Correlation table]: orstocsy (Xclusterf, Y matrix,
number of factors, correlation threshold, Ibegin, Iend, ppm).

ORStocsy is a N x N matrix containing the correlation be-
tween SRV clusters (Blaise et al., 2010, 2011). Correlation table
is a seven-row table containing the identiﬁcation number of the
correlated clusters, the ppm starting and ending values of the
correlated clusters and the level of correlation. The other param-
eters are identical to those described previously.

Funding: The French government.

Conﬂict of Interest: none declared.

REFERENCES

Blaise,B.J. et al. (2009) Statistical recoupling prior to signiﬁcance testing in nuclear
magnetic resonance based metabonomics. Anal. Chem, 81, 6242—6251.

Blaise,B.J. et al. (2010) Two-dimensional statistical recoupling for the identiﬁcation
of perturbed metabolic networks from NMR spectroscopy. J. Proteome Res., 9,
4513—4520.

Blaise,B.J. et al. (2011) Orthogonal Filtered Recoupled-STOCSY to extract meta-
bolic networks associated with minor perturbations from NMR spectroscopy.
J. Proteome Res., 10, 4342—4348.

Benjamini,B.Y. and Yekutieli,D. (2001) The control of the false discovery rate in
multiple testing under dependency. Ann. Stat., 29, 1165—1188.

Cloarec,0. et al. (2005) Statistical total correlation spectroscopy: an exploratory
approach for latent biomarker identiﬁcation from metabolic 1H NMR data
sets. Anal. Chem, 77, 1282—1289.

Lavine,B. and Workman,J. (2010) Chemometrics. Anal. Chem, 82, 4699—4711.

Nicholson,J. et al. (1999) “Metabonomics”: understanding the metabolic responses
of living systems to pathophysiological stimuli Via multivariate statistical ana-
lysis of biological NMR spectroscopic data. Xenobiotica, 29, 1181—1189.

Trygg,J. and Wold,S. (2002) Orthogonal projections to latent structures (O-PLS).
J. Chemom, 16, 119—128.

 

112 /810's112umo[pJOJXO'sot1emJOJutotw/2d11q wort pepeolumoq

910K ‘09 lsnﬁnV uo ::

