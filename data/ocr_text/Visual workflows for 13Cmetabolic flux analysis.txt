ORIGINAL PAPER

Vol. 31 no. 3 2015, pages 346-354
doi:10. 1093/bioinformatics/btu585

 

Systems biology

Advance Access publication October 7, 2014

Visual workflows for 13C-metabolic flux analysis
Katharina Noh*, Peter Droste and Wolfgang Wiechert

Institute of Bio— and Geosciences, lBG—f: Biotechnology, Forschungszentrum JUlich GmbH, 52425 JUlich, Germany

Associate Editor: Jonathan Wren

 

ABSTRACT

Motivation: The precise quantification of intracellular metabolic flow
rates is of fundamental importance in bio(techno)logy and medical
research. The gold standard in the field is metabolic flux analysis
(MFA) with 13C-labeling experiments. 13C-MFA workflows orchestrate
several, mainly human-in-the—loop, software applications, integrating
them with plenty of heterogeneous information. In practice, this had
posed a major practical barrier for evaluating, interpreting and under-
standing isotopic data from carbon labeling experiments.

Results: Graphical modeling, interactive model exploration and visual
data analysis are the key to overcome this limitation. We have
developed a first-of-its-kind graphical tool suite providing scientists
with an integrated software framework for all aspects of 13C-MFA.
Almost 30 modules (plug-ins) have been implemented for the Omix
visualization software. Several advanced graphical workflows and
ergonomic user interfaces support major domain-specific modeling
and proofreading tasks. With that, the graphical suite is a productivity
enhancing tool and an original educational training instrument support-
ing the adoption of 13C-MFA applications in all life science fields.
Availability: The Omix Light Edition is freely available at http://www.
omix-visualization.com

Contact: k.noeh@fz-juelich.de, p.droste@omix-visualization.com
Supplementary information: Supplementary data are available at
Bioinformatics online.

Received on April 30, 2014; revised and accepted on August 25, 2014

1 INTRODUCTION

1.1 13C—metabolic ﬂux analysis

Fluxomics, which is also known as metabolic ﬂux analysis (MFA;
Winter and Kromer, 2013), deals with the detailed quantiﬁcation
of metabolic reaction rates inside living cells. Fluxes are material
ﬂows through biochemical pathways, rather than metabolite
concentrations. Fluxomics is unique among the ‘omics’ methods
because it does not—like the other methods—characterize the
mere potential of an organism to perform a certain function,
but rather it reﬂects its physiological status quo (Sauer, 2006;
Wiechert, 2001).

A distinguishing feature of MFA is that metabolic ﬂuxes
cannot be directly quantiﬁed but must be computed from
measured data based on a mathematical model. This particularly
applies to MFA with stable isotopic carbon atoms (BC-MFA),
which is considered the gold standard in the ﬁeld, calculating
the in vivo ﬂuxes from stable 13C enrichments of intracellular
metabolites described by a mathematical model (Sauer, 2006;

 

*To whom correspondence should be addressed.

Stephanopoulos, 1999). The unique information quality of
isotope-based ﬂuxomics is increasingly recognized as enabling
technology in metabolic engineering, systems biology and bio-
medical research.

The methodology of model-based 13C—MFA is continuously
developed since the early 19903. The basics are described in
tutorial papers (Tang et al., 2009; Wiechert et al., 2001;
Zamboni et al., 2009) and the state of the art is covered by seV-
eral reviews (Kruger and Ratcliffe, 2009; Wiechert and Noh,
2013; Zamboni, 2011). In addition to the experimental proced-
ures of carbon labeling experiments (CLEs) and the protocols for
biochemical analytics, the computational aspects play a central
role in 13C—MFA. The latter involve a sequence of modeling,
simulation, experimental design, ﬂux estimation and statistical
evaluation steps. In all steps, the biological expert must have
the ability to intervene and stir the process. Up to now, estab-
lishing tailored computational evaluation pipelines for 13C—MFA
is a time-consuming exercise. Easing these tasks is the subject of
this article.

1.2 Modeling CLEs

Label distribution over a metabolic network is governed by well-
established physical laws. This means that all frameworks for
modeling and simulating CLEs involve the same basic principles
and thus require the same input, i.e. mass balances, reaction
stoichiometry, carbon mappings between reactants and measure-
ments Wiechert et al., 2001). On the other hand, various com-
putational formalisms have also emerged, which process the
physical laws in different ways (Antoniewicz et al., 2007;
Schmidt et al., 1997; van Winden et al., 2002; Wiechert et al.,
1999). More importantly, these formalisms impact on the per-
formance of the computational procedures but not on the calcu-
lated ﬂux results ONeitzel et al., 2007).

Unfortunately, structural and measured input data are both
extensive and heterogeneous. A lot of information must be com-
piled on the metabolic network structure, carbon atom mappings
(CAMS) for reactions, measurement conﬁgurations, ﬂux con-
straints, input substrate compositions, etc. This implies that
13C—MFA involves a painstaking conﬁguration procedure requir-
ing considerable experience. To this end, a general evaluation
workﬂow for modeling and simulation of CLEs was proposed
in Wiechert et al., 2001).

Most software systems for 13C—MFA follow a universal
approach (e.g. inﬂux_s, NMR2Flux+, Metran, OpenFLUX,
13CFLUX2, cf. Supplementary Table 81.4). In this context,
‘universal’ means that a modeling environment is available
for the speciﬁcation of arbitrary metabolic networks, input
substrate compositions, measurement conﬁgurations and

 

346 © The Author 2014. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com

112 /§.IO'S[BU.IHO[p.IOJXO'SOIlBIHJOJUIOIQ/ﬁ(1111] 11101; pepBOIUAAOG

9IOZ ‘091sn3nv uo ::

Visual workflows for 1"’C-metabolic flux analysis

 

additional constraints. Available software tools for 13C—MFA
rely heavily on text-, table-, XML- or matrix-based input
documents to specify models. From these ﬁles, all equations
needed to describe the CLE are automatically generated. It is
neither easy nor straightforward to build up the complex conﬁg-
uration for 13C-MFA, to check its correctness and consistency,
to trigger simulation and data evaluation runs or to automatic-
ally Visualize the ﬁnal ﬂux maps in the metabolic network
context.

Notably, in all parts of a 13C—MFA model, 100% correctness
is needed. If, for example, one single CAM has been incorrectly
speciﬁed, a measurement has been incorrectly related to a me-
tabolite’s fragment or the actual input substrate has not been
accurately mirrored, the CLE analysis will fail to calculate the
correct ﬂux map. At present, it is difﬁcult to detect and, in turn,
locate the error in a model ﬁle or table covering several printed
pages. Although more than 400 possible syntactic and semantic
errors in the model speciﬁcation can be detected, even the re-
cently published 13CFLUX2 compiler, representing a decade of
experience in 13C-MFA, cannot prevent systematic mistakes or
fundamental misunderstandings in the model formulation
(VVeitzel et al., 2013).

1.3 Visual workﬂows

Experience has shown that building up the ﬁrst model descrip-
tion of a complex CLE usually cannot be managed by a new-
comer without experienced help. This simple fact is certainly one
of the major reasons why 13C—MFA is still not as commonly used
as other omics techniques. This contribution goes one step fur-
ther by addressing this very problem. An innovative collection of
Visual workﬂows is presented, which are intuitive to use and
cover the 13C—MFA model setup, all computational steps of
simulation, experimental design, parameter ﬁtting and statistical
analysis, as well as the Visual presentation of results.

The comprehensive graphical tool suite that we have devel-
oped builds on the functionality of the network-based Visualiza-
tion software Omix® (Droste et al., 2013). The base
functionalities of Omix allow even an inexperienced user to
quickly create and edit metabolic networks (Droste et al.,
2011a, 2011b). Because all metabolic ﬂux maps generated
during the analysis are later Visualized in the same network
diagram, Omix users can design the network to suit their
personal preferences and context-dependent priorities. This is
essential for intuitive and effective Visual recognition. The
Omix Visualization Language (OVL) makes network drawings
scriptable, which enables the easy and ﬂexible user-deﬁned
mapping of data to the Visual attributes of each single network
node and edge (Droste et al., 2011b).

To draw the maximum advantage from a graphical conﬁgur-
ation of CLEs, it is important that graphical tools are not
mere user interfaces to the underlying data structures but that
they represent powerful, easy-to-leam, interactive and intui-
tive tools for immediate consistency, syntactical/semantical
correctness and completeness checking, modeling and Visual
analysis. We achieved this goal by developing several advanced
Visual workﬂows supporting the model building processes
(cf. Supplementary Table Sl.3 for a complete list).

In the subsequent sections, we follow the general 13C—MFA
workﬂow outlined in (Wiechert et al., 2001) and illustrate how
the Visual model conﬁguration is implemented for each of the
steps. Orchestration of the single workﬂow steps is made easier
by a graphical workﬂow manager, facilitating plug-and-play
assembly and coordinated execution of each step. The estab-
lished comprehensive Visual 13C—MFA workﬂow, as illustrated
in Supplementary Figure Sl.l, consists of a unique collection of
almost 30 Omix plug-ins (cf. Supplementary Table Sl.2). Several
ﬁgures illustrating the core elements of the graphical workﬂow
along with a detailed explanation of non-trivial algorithms and
additional applications are provided as Supplementary Material.
Having brieﬂy outlined the general aspects of metabolic network
modeling, we will focus, in the following, on the 13C—MFA-
speciﬁc aspects of the Visual workﬂows.

2 METABOLIC NETWORK ASSEMBLY

2.1 Metabolic network speciﬁcation and annotation

The ﬁrst step in any 13C—MFA workﬂow is the collection of
reactions, i.e. the stoichiometric relation between enzymes and
metabolites. Clearly, building on expert-curated information
sources minimizes the error in model conﬁguration. There is a
wide range of publicly available information sources, and a
wealth of Omix plug-ins have been developed for importing
metabolic networks into the workﬂow from databases (KEGG,
BioCyc), ﬁles (SBML, BioPAX, SBGN—ML, GraphML) and re-
action lists. In addition to the network structure, subsequent
13C—MFA modeling steps rely heavily on accessory information
such as the chemical structure formulas of metabolites, or
common names and database IDs of reactions. Our graphical
workﬂow helps to cut the costs of assembly and data integration
by compiling tailored information sets automatically. In turn,
these sets provide a valuable knowledge base for the subsequent
modeling workﬂow (cf. Supplementary Fig. S21).

2.2 Flux constraints

From the network topology, one stoichiometric constraint for
each internal metabolite node is derived by balancing the rates
of incoming and outgoing reactions. In 13C-MFA, reversible
reaction steps have to be taken into account because they inﬂu-
ence the labeling distribution, meaning that net ﬂuxes should be
complemented by their respective exchange ﬂuxes (W iechert and
de Graaf, 1997). Both net ﬂuxes and exchange ﬂuxes can be
further constrained by imposing linear equality and inequality
constraints derived from expert knowledge, e.g. concentration-
induced ﬂux directions (cf. Supplementary Fig. S2.2). These add-
itional modeling assumptions can be introduced in a dedicated
window with a register of deﬁned ﬂuxes. Here, the user speciﬁes
(in)equality constraints in terms of linear sums of ﬂuxes. When
the user is deﬁning these assumptions, a pop-up window opens
showing a register of all ﬂuxes contained in the network. The
(in)equalities are parsed in real time. Immediate reporting of
typing errors prevents users from entering reaction names that
do not exist. Expressive error messages point out inconsistencies
with the network and typing errors (cf. Supplementary Fig. S2.3).

 

347

112 /§.IO'S[BU.IHO[p.IOJXO'SOIlBIHJOJUIOIQ/ﬁ(1111] 11101; pepBOIUAAOG

9IOZ ‘091sn3nv uo ::

K.th et aI.

 

2.3 CAMs: status quo

CAMS must be speciﬁed to simulate CLES. To this end, the fate
of every single carbon atom in every reaction step of the network
must be unambiguously deﬁned (cf. Fig. 1B and Supplementary
Figs S2.4—6). This information must be absolutely correct and
consistent. Unfortunately, the correctness of the transitions is
difﬁcult to verify manually in both the textual representation
of CAMS (Wiechert et al., 1999) and in the mapping matrix
representation (Schmidt et al., 1997). ThuS, it iS almost impos-
Sible to proofread large modelS using the current state of the art.

Some databases like ARM (Arita et al., 2006), carbon-fate
mapS (Mu et al., 2007), the MetaCyc database family and pub-
lications (e.g. Ravikirthi et al., 2011) supply computationally
generated and partially manually curated information on
CAMS. Nevertheless, some general fundamental problems have
yet to be solved.

Firstly, there iS still a lack of reliable CAM information with
high coverage. Although progreSS waS recently made in heuris-
tics-based CAM generation (Latendresse et al., 2012), unknown
reaction mechanisms inducing unusual mappings pose an
inherent problem for all automated approaches. Speciﬁcally,
enzymatically indistinguishable ‘C-Symmetric’ atomS require the
formulation of alternative CAMS in 13C-MFA models, which iS
still an unsolved problem (Zhou and Nakhleh, 2012).

Secondly, there iS a lack of 13C-MFA standards for CAMS and
common toolS for their data management, rendering model
reuse, Sharing and merging almost impossible. The underlying
reason for this iS that CAMS can only be correctly interpreted
when the numbering of the carbon atomS iS unambiguously sti-
pulated and when this setting iS clearly documented. Although
IUPAC/IUBMB commissions provide detailed recommenda-
tionS, these guidelines are invariably not obeyed in practice. In
addition, the widely applied MDL®, MOL or CML ﬁleS are not
standardized with regard to atom numbers and, hence, cannot be
used aS standard (cf. Supplementary Fig. S2.7). AS a conse-
quence, up to now, 13C-MFA modelS can only be exchanged
on a personal baSiS.

2.4 Canonical CAMS and supportive automatisms

The most reliable way to addreSS this limitation while unlocking
available CAM information for ﬂuxomics iS (i) to trust in the
human expert’s modeling and proofreading capabilities, and (ii)
to keep the atom numbering issue away from the user. ThiS
requires graphical front-end toolS that gather and display all of
the necessary information in an intuitive visualization, allow for
quick correction and the straightforward Speciﬁcation of new
CAMS. If a unique numbering of the carbon atomS iS addition-
ally guaranteed in the back-end, this effort payS off immediately
because once a correct model with curated CAMS of the central
metabolism haS been developed, further modelS can be quickly
derived. Notably, model reuse and assembly beneﬁts enormously
from cut, copy and paste functionalitieS.

This principle haS been applied for the ﬁrst time by implement-
ing CAMS that are independent of human-imposed numbering
schemes. To this end, we used the IUPAC International
Chemical Identiﬁer (InChITM ver. 1.04, www.iupac.org/home/
publicationS/e-resourceS/inchi.html). The InChI Trust provides
open software to transform a given structural formula into an

InChI string. A unique atom sequence iS obtained in the proceSS.
Referring CAMS to thiS reference numbering ensures that two
humans drawing the same molecule or loading itS MOL or CML
ﬁleS will alwayS get the same carbon atom numbering. InChI’S
AuxInfo layer contains the information required to revert the
conversion procedure (cf. Supplementary Fig. S2.7).

By using molecular structure ﬁleS, the human user directly
obtains a graphical representation of each molecule along with
a standardized atom numbering. The open-source Java library
CDK (Chemistry Development Kit ver. 1.4, Steinbeck et al.,
2003) iS used for InChI string generation and the handling of
diverse data formats. The molecules are imported and visualized
by the Structural Formula plug-in. The limitation of InChI to
correctly handle generic structures, such aS MarkuSh structures
with generic R groups, iS algorithmically solved within the
plug-in.

In Supplementary Figure S2.8, we demonstrate how the
KEGG RPAIR database containing atom correspondences
between substrate and product metabolite pairs can be used to
generate canonical CAMS. Owing to itS universality, our novel
approach iS readily applicable to other CAM resources such aS
the BioCyc database. If the atom correspondences are not
known, the user interactively Speciﬁes or editS the atom transi-
tionS by choosing the source carbon atom marker (colored circle)
and dragging it toward itS companion atom, which then changes
itS color from gray to the color of the source atom (cf.
Supplementary FigS. S2.4—6). The actual carbon atom number-
ing of the reactants playS no role in this procedure and iS only
optionally displayed for the sake of integrity. It iS not alwayS
desirable to map all atomS of a molecule. For instance, coenzyme
A (CoA) syntheSiS iS usually not regarded in 13C-MFA network
models. ThuS, pruned CAMS include only the core carbon Skel-
eton of compounds like acetyl CoA or succinyl CoA (cf.
Supplementary Material Fig. S2.5). Consequently, only the bal-
ances of the traced carbon atomS are checked by the Atomic
Layer Modeling plug-in.

Importantly, the user can also Specify alternative mappings,
so-called ‘variantS’, for reactions with C-Symmetric reactants (cf.
Supplementary Fig. S2.6). This obviates the need for the modeler
to explicitly formulate symmetric reactions.

All in all, the graphical Speciﬁcation and more vitally the
proofreading have been turned into convenient procedures.
Biochemical experts are familiar with the resulting representation
and can now, for the ﬁrst time, check aS many aS 100 reactions in
a Short time. We evaluated the visual CAM Speciﬁcation with a
large carbon atom transition network for yeast metabolism con-
taining 845 metabolites and 1100 reactions (826 thereof carrying
manually Speciﬁed CAMS). Visual proofreading of the network
structure and CAMS took leSS than one working day. Other
studies have Showed Similar ﬁgures.

3 SETTING THE NETWORK’S INS AND OUTS

The next taSk iS to Specify labeled substrates aS an additional
information source to effectively narrow down the number of
possible ﬂux solutions. Administering cells with 13C-labeled
substrates imprints Speciﬁc labeling patterns on the intracellular
metabolites. The goal iS to end up with only one possible

 

348

112 /§JO'S{12umo [p.IOJXO'SOIlBIHJOJUIOIQ/ﬁdllq 1110131 pep1201umoq

9IOZ ‘091sn3nv uo ::

Visual workflows for 1("C-metabolic flux analysis

 

 

 

 

 

 

 

 

 

Ediioh'nhrul-u- --'——-—w —- ...._._.._...I -. ._. _u _-
b-IH Wren-r: _ _- _. .'.' ' _ "_ __. H
“Inﬁll-"ll .. .H I... I
Ikln-c-I hpiﬂ mi:- 4"” I I. F I I I wﬂ‘ I I __ ....I .. .._ -
IhI-u-P—Ir" Inn-U -.- __. _ . _ F - _
"rug-hr. m” LP'IIﬂ-JI'I‘I‘ 11ml"; um Hm HII‘H' 
GM lam-r :ua :-:- I-.'r.-~. :1: - '_-_'_"_' ' "
3 H i H - H. ...
i-w-eHuIL-haurm 'v a I I _
"Ii-"m '-:|.I.': "31"
mA‘ A‘T‘i‘ n I I _ . 
I . i __ . .
. 1.5. if. ....__....._ m _
I I III III III III aH.‘
H ""' “" _I—" -|' I! In!
. I...  5‘1 '. - I, I . -" if H
nw "I L.— 1 - - inn-nu .TI I _ III“- 4 I; l q "I u
a. 1'..- 'r-- '_'I' r-l'l I Il—l . I. if. I -
-1 I—  ' H ' _ H _
— o  . .
IGLCU : . dept.

1F

0 deptifree
0 free

 

 

 

 

 

 

 

 

 

 

Mi 131: :1
3 Nat 535—1 2?“
ll Iﬁh   -__ _PI
=—l'ir.u i’l—"i’I __

  
  
  
  

 

13': — — I. J'-

Nat mm 121.1124 T- j j I
‘ ' {If .It'lr 'H. II "a  .L
@

Fig. 1. Visual elements of graphical 13C-MFA workﬂows. (A) User interfaces for the graphical composition of input labeling Species. (B) Graphical
modeling of CAMS. (C) Graphical Speciﬁcation of MS/MS labeling measurements. (D) Network annotation with qualitative and quantitative data: free
ﬂuxes. (E) Differential View of Simulated and measured mass lanes from seven datasets (red—negative, green—positive) with measurement standard
deviations (gray bars) and (F) comparison of ﬂux maps derived from FBA and 13C-MFA (blue—low, white—medium, red—high ﬂuxes). The color
coding provides a visual aid for identifying network-wide comparable ﬂux values. (G) With the Omix workﬂow manager 13C-MFA workﬂows can be
easily constructed, conﬁgured, saved, run and Shared. Enlarged versions of the ﬁgures are found in the supplement

 

 

 

 

 

 

349

112 /3JO‘SIBUJHOIpJOJXO'SOIlBUHOJUIOIQ/ﬂdnq 11101; pep1201umoq

9IOZ ‘OE lsnﬁnv uo ::

K.th et aI.

 

remaining ﬂux distribution that is consistent with these labeling
patterns.

3.1 Isotopic substrate speciﬁcation

It is common practice in 13C-MFA to administer mixtures
of differently labeled (13C) and unlabeled (12C) substrates to
obtain maximum information from the CLE. Importantly,
isotopically labeled substrate species always contain a small pro-
portion of impure substances (commercially available substrates
have typically a purity of <99 atom%).This means that each
compound in a mixture is itself a mixture of differently labeled
isotopomers. Owing to their impact on the ﬂux calculation, it is
essential to precisely deﬁne the input labeling impurities accord-
ing to the manufacturer’s speciﬁcation.

As shown in (W iechert et al., 2001), mixture compositions can
be conveniently modeled by including multiple conﬂuent sub-
strate uptake steps into the network. Each inﬂux carries the frac-
tion of one of the (impure) labeled species provided in the
substrate mixture. All of these input ﬂuxes are then blended in
one single mixture pool, and the sum of all inﬂuxes constitutes
the total carbon uptake rate. The inﬂux ratio determines the
proportion of the mixture species. In this way, input substrate
compositions can be intuitively modeled as an integral part of the
metabolic network structure.

In the graphical 13C-MFA workﬂow, a list is generated of all
input compounds found in the model. For each compound, the
modeler speciﬁes the associated input isotopomer visually by in-
dividually selecting the carbon atoms and interactively switching
between labeled and unlabeled states (cf. Fig. 1A and
Supplementary Fig. S2.9). Finally, the isotopic purity of each
labeled species is entered into the user interface.

3.2 Measurement (error) conﬁguration

One of the most difﬁcult tasks in 13C-MFA is identifying the
precise relation between various measured signals and the
corresponding labeling fractions of intracellular metabolite
pools. The reason for this is the enormous heterogeneity of
mass spectrometric (MS) and nuclear magnetic resonance
(NMR) analytical platforms and protocols published in the lit-
erature as well as the continually advancing techniques. Recent
developments in this ﬁeld are described, for example, by Fan
et a]. (2012) and Nagana Gowda and Raftery (2014). Several
other papers are concerned with the determination of labeling
patterns for special equipment (cf. Supplementary Fig. S2.10—12
for more references).

A universal modeling framework must be ﬂexible enough to
model all present and expected future measurement conﬁgur-
ations. A matrix representation describing a group of simultan-
eously measured signals as linear combinations of the analyte’s
isotopomer fractions provides a generally applicable approach
(Choi and Antoniewicz, 2011 and Wiechert and de Graaf, 1997).

Although measurement matrices are universal, they are incon-
venient for manual speciﬁcation. For example, a metabolite with
nine carbon atoms, such as the amino acid L-phenylalanine, has
29 = 512 isotopomers, which induces a measurement matrix with
as many columns. The generation of the corresponding measure-
ment matrices should be hidden from the user and automated in
such a way that the corresponding matrices are automatically

generated from a structure— or fragment-related input while
remaining consistent with the carbon atom network (cf. Fig. 1C).

The general approach taken in our visual 13C-MFA workﬂow
is to provide an interactive canvas where the modeler conveni-
ently speciﬁes the measurements. After one of the intracellular
metabolites has been chosen from a drop-down menu, the meas-
urement technique is selected (cf. Supplementary Fig. S21 1).
Here, the modeler chooses between four different measurement
types: ‘lH-NMR’ (positional 13C enrichments), ‘MS’ (mass
isotopomers), ‘MS/MS’ (positional mass isotopomers) and
‘Generic’ for all cases where the aforementioned measurement
techniques do not provide sufﬁcient ﬂexibility. All measurement
types are exempliﬁed for L-phenylalanine in Supplementary Fig.
S2.l2. In addition to labeling patterns, the modeler likewise
speciﬁes extracellular ﬂuxes, i.e. speciﬁc rates associated with
substrate consumption, biomass and product synthesis. Each
single measurement has to be accompanied by its estimated
standard deviation, which depends on experimental, analytical
and device-speciﬁc factors.

4 NETWORK ANALYSIS

Graphical tools and algorithms help us to understand important
characteristics of the formulated metabolic labeling system and
thus play an important role in the plausibility assessment, testing
and proofreading of network models. Conventionally, any net-
work analysis starts with inspecting the stoichiometric matrix
containing the full set of stoichiometric coefﬁcients of all react-
ants in the network. The set of all minimal pathways through the
network is characterized by the elementary ﬂux mode (Terzer
and Stelling, 2008), and phenotypes can be predicted with ﬂux
balance analysis (FBA, Orth et al., 2010). We have developed
Omix plug-ins for all of these analyses (cf. Supplementary Table
Sl.2). Additionally, the Klamt group has provided an Omix
plug-in for the CellNetAnalyzer toolbox, facilitating various fur-
ther network analysis functions (Klamt et al., 2007). In the fol-
lowing, we concentrate on the advanced analysis of isotope
labeling systems.

4.1 Picking free net ﬂuxes

The set of stoichiometric equations in union with the equality
constraints reduces the dimension of the network model’s ﬂux
space. The rank of the corresponding extended stoichiometric
matrix determines the dimensionality of the feasible ﬂux space.
It proved convenient to represent the degrees of freedom in the
stoichiometric space using so-called ‘free ﬂuxes’ (W iechert and de
Graaf, 1997). A set of free ﬂuxes is a distinguished non-unique
subset of all network ﬂuxes. When it has been assigned to certain
values, it can uniquely determine all other ﬂuxes and thus the
complete ﬂux map. Usually, free ﬂuxes are ‘prominent’ ﬂuxes
like the entry ﬂuxes of the glycolysis or the citric acid cycle.
Manual selection eases some of the following tasks because
guesses for the initial ﬂuxes are intuitively interpretable.
Unfortunately, not every combination of the right number of
ﬂuxes gives a proper set of free ﬂuxes (Wiechert and de Graaf,
1997). For large networks, it is almost impossible to guess a valid
set of independent ﬂuxes by intuition. Various matrix factoriza-
tion algorithms (e.g. singular value decomposition or Gaussian

 

350

112 /§JO'S{12umo IpJOJXO'SOIlBIHJOJUIOIQ/ﬁdllq 1110131 pep1201umoq

9IOZ ‘091sn3nv uo ::

Visual workflows for 13C-metabolic flux analysis

 

elimination) are capable of determining free ﬂux sets automatic-
ally. However, the trade-off is that the proposed ﬂux constella-
tions are seldom human-interpretable.

To avoid these problems and to allow a convenient and rapid
user-driven selection of free ﬂuxes, we invented an interactive
recursive graphical algorithm. From the user viewpoint, the
Omix Free Flux plug-in displays a clickable ‘trafﬁc light’
symbol in the vicinity of each ﬂux node in the network visual-
ization (cf. Fig. 1D and Supplementary Fig. S2.l3). This symbol
is green (the ﬂux is selected as a free ﬂux), yellow (the ﬂux can
still be chosen as free ﬂux) or red (the ﬂux can no longer be
selected because of its stoichiometry-induced dependency on
the free ﬂuxes already selected). After each selection, the depen-
dencies are automatically recalculated by recursive Gaussian
elimination and the trafﬁc light colors are updated. If a free
ﬂux selection turns out to be disadvantageous, it can be simply
redeﬁned with another mouse click on the trafﬁc light symbol.
Our experience with large-scale networks has shown that this
visual explorative procedure always yields a convenient result
for the selection of free ﬂuxes within a short time frame of
only a few minutes.

4.2 Tracing the paths of labeled atoms

Recently, a universal path-tracing theory was developed for
CAM networks that quantitatively explains the accumulation
of labeled molecular species in each metabolite for a given
input labeling composition (Wiechert et al., 2013). It was
found that metabolic cycles induce an inﬁnite number of reaction
sequences contributing to the label enrichment of a single me-
tabolite pool. Path tracing of (un)labeled atoms and molecule
fragments with a ﬁnite number of steps already enables a quali-
tative simulation of the CLE. This means that by forward track-
ing the fate of labeled input species and the backward tracing of
measured species to their origins, CLEs can be played through.

For this reason, tracing the possible paths of isotopically
labeled atoms is an invaluable visual aid for proofreading and
identifying basic effects such as the cycling of carbon atoms
(Chance et al., 1983) or the unexpected emergence/dilution of
labeling suggesting alternative routes (Creek et al., 2012). For
inexperienced users, the tracing of labeled molecules is an essen-
tial tool to understand the underlying complexity of CLEs and
provides more conﬁdence for evaluating the signiﬁcance of
observed effects. As a result, label path tracing has been fre-
quently applied in the literature using manually drawn two-
dimensional pictures (e.g. Klapa et al., 1999).

The CumoVis plug-in provides a tailored tool for label tracing
that serves the needs of both, the practitioner and the theorist.
CumoVis displays not only single paths of isotopic tracers but
also the complete isotope labeling network (cf. Supplementary
Fig. S2.14), which complements the reaction-wise proofreading
described in Section 2.4. To facilitate a better understanding,
three-dimensional visualization techniques are applied (Droste
et al., 2008). As an extension of its ﬁrst version, the second-
generation CumoVis plug-in fully exploits the beneﬁts of this
visualization in a wealth of 3D views (cf. Supplementary
Movies). The views show freely rotatable and zoomable large-
scale metabolic and isotope labeling networks from every angle,
allowing the user to browse the network structure and to ﬁlter

out subgraphs for closer inspection. Important new features are
that tracers can be followed both forward and backward through
the network starting from any speciﬁed atom or molecule frag-
ment, represented by its chemical structure, up to a speciﬁed path
length. All label paths can be conveniently investigated one by
one in a fully animated fashion.

5 COMPUTATIONAL TASKS

The subsequent computational tasks constitute the backbone of
any 13C-MFA workﬂow and thus provide typical functionalities
of ﬂuxomics software tools. In this article, we feature the
l3CFLUX2 simulation framework (W eitzel et al., 2013). In prin-
ciple, it is also possible to interface other 13C-MFA software
systems from the Omix environment (cf. Supplementary Table
Sl.4). We have developed several tailored visual interfaces to
pass the input data to the respective computational tools,
check the validity of the 13CFLUX2 model ﬁle, launch calcula-
tions via Web services on distributed computers and, ﬁnally,
aggregate and visually present the results to the modeler.

5.1 CLE simulation

Based on the CAM network model with speciﬁed input substrate
labeling, constraints and, optionally, measurements, the forward
simulation of a CLE represents the central computational
module of any 13C-MFA workﬂow. ‘Forward simulation’
is the assumption of some feasible ﬂux distribution—i.e. values
are assigned to the free ﬂuxes fulﬁlling all speciﬁed constraints—
followed by the computing of the steady-state isotope labeling
distribution of the metabolic intermediates. The simulation tool
is of great value for exploring the inﬂuence of different ﬂuxes and
input labels on the outcome of the CLE. In this way, for
example, sensitive measurement signals can be identiﬁed. The
calculated simulation results are deposited in 13CFLUX2-
tailored XML-based output formats and stored for subsequent
analysis or directly used to visualize informative ﬂux maps
(cf. Fig. 1E).

5.2 Experimental design

Owing to a limited number of available measurements and the
ubiquitous measurement errors in extracellular ﬂuxes and label-
ing data, it can happen that not all ﬂuxes in a metabolic network
are reasonably well determined. Fortunately, a good prediction
of the expected quality of the ﬂux map can be calculated before
any experiment is carried out (Mollney et al., 1999). Thus, the
optimal experimental design (OED) methodology has become a
routine tool for designing CLEs with a wide range of applica-
tions (Crown et al., 2012; Millard et al., 2014; Nargund and
Sriram, 2013; Weitzel et al., 2013). OED algorithms compute a
maximally informative input substrate mixture targeted to the
speciﬁc research aim. All OED variants are based on statistical
quality measures evaluating how well the ﬂuxes are determined
by the data. By assigning user-speciﬁed weights to the ﬂuxes, the
design can be focused on speciﬁc regions of the network. The
mathematical details of various design measures and ‘alphabet—
ical’ optimality criteria can be found in the classical literature
(Pazman, 1986).

 

351

112 /810's112umo IpJOJXO'SOIlBIHJOJUIOIQ/ﬁdllq 1110131 pep1201umoq

9IOZ ‘091sn8nv uo ::

K.th et aI.

 

In 13C-MFA studies, seldom more than three differently labeled
substrate species—typically 12C-, 1-13C- and U-13C-labeled
glucose—are fed to the cells. In the triplicate case, the space of
possible substrate mixtures can be conveniently presented by a
mixture triangle (Mollney et al., 1999), which is a statistical quality
measure for each input composition (cf. Supplementary Fig. S2.
15). From this mixture triangle, optimal or suboptimal input
composites can be directly read off. It is just as important that
the robustness of an experimental design with respect to variations
in the input mixture can be easily judged visually.

Nowadays, a variety of speciﬁcally labeled substrate species
can be synthetized. Thus, for explorative purposes, higher-
dimensional OEDs with more than three labeled substrate spe-
cies may be investigated with the 13CFLUX2 program. Instead
of directly visualizing the results of such OEDs, the modeler can
download them as HDF5 ﬁles for post-processing purposes.

5.3 Flux estimation and statistical assessment

After the well-designed CLE has been carried out, the central
step in the 13C-MFA workﬂow is the estimation of the in vivo
ﬂuxes from the data. Measurements are typically made available
as a table of extracellular measured ﬂuxes and MS(/MS)- or
NMR-based labeling enrichments. Every measured value must
be accompanied by a standard deviation characterizing its
uncertainty. All measurement/standard deviation pairs can be
either arranged in groups or as independent single measure-
ments. Measurement values and standard deviations can be con-
veniently copied from prepared spreadsheets and pasted in the
measurement speciﬁcation dialogue as described in Section 3.2
(cf. Supplementary Fig. S2.11).

The unknown in vivo ﬂuxes are calculated from a parameter
ﬁtting procedure where the difference between real and simulated
data is minimized, e. g. by means of a non-linear weighted least-
squares functional (Draper and Smith, 1998). In contrast to the
simulation step, the process of ﬁtting CLE data depends on
various factors and its running time therefore cannot be pre-
dicted a priori (Dalman et al., 2013). Hence, the modeler can
monitor the progress of the iterative ﬂux estimation procedure
online (cf. Supplementary Fig. S2.17).

After ﬁnalization of the ﬁtting procedure, the best ﬂux ﬁts are
collected and transferred back to the local Omix modeling envir-
onment to visualize the resulting ﬂux maps. The ﬁnal step
involves a companion uncertainty analysis (Dalman et al.,
2013; Wiechert et al., 1997), which assesses the reliability of the
calculated ﬂux estimates. Conﬁdence intervals provide a range
for each ﬂux, which contains the true ﬂux value up to a certain
degree of conﬁdence. By using OVL, reaction/metabolite nodes
of the ﬂux maps are easily decorated with annotation boxes that
display all relevant values numerically, size- or color-coded (Fig.
1F).

5.4 Putting pieces together: workﬂow composition

We have described various computational modules requiring dif-
ferent input conﬁgurations, data speciﬁcations and dependencies
that must be ﬁxed and maintained by the scientist. Controlling
the tools manually is a must for learning and training purposes
and is adequate for one single ﬂuxome study. For routine
analysis of large-scale datasets, however, this practice is not

effective. Particularly in eScience, scientiﬁc workﬂows have
emerged as a useful new paradigm to describe and automate
routine computational analysis tasks (Ebert et al., 2012 and Gil
et al., 2007). By stringing existing 13CFLUX2 modules together,
tailored 13C-MFA evaluation pipelines can be assembled, ran-
ging from initial model building to ﬁnal ﬂux-map visualization.
In turn, these workﬂows act as computational protocols for
subsequent reuse, veriﬁcation and adaption purposes.

The Omix 13CFLUX2 Launcher plug-in provides a light-
weight scientiﬁc workﬂow manager with a graphical editor to
ease the tasks of designing, manipulating, executing and moni-
toring universal ﬂuxomics analysis (cf. Fig. 1G). As a starting
point, all network, atom mapping, constraint, measurement and
input substrate-mixture data are assumed to be available either
as Omix or 13CFLUX2 model ﬁles. Graphical primitives repre-
senting the workﬂow’s atomic components on a high-level are
provided, representing fully conﬁgurable front-ends to the afore-
mentioned tools. These components can be manually selected
and linked by the modeler to set up comprehensive 13C-MFA
evaluation pipelines.

Supplementary Figure S2.16 shows the Omix workﬂow
manager canvas with an explorative 13C-MFA workﬂow
assembled by drag-and-drop from the tool list. The workﬂow
composition is guided by the colors of the modules’ I/O nodes,
which indicate their interoperability. All workﬂow tasks are
implemented as remote Web services where independent work-
ﬂow branches run in parallel. To enable an easy online survey of
the computation progress, advancing steps are colored yellow,
completed tasks are displayed in green and, should unexpected
failures emerge, the box turns red and the reasons for interrup-
tions can be inspected in detail. Once all computational tasks
have been completed, the workﬂow manager automatically
downloads and saves the simulation results for further
processing.

6 DISCUSSION

The presented comprehensive plug-in suite for the Omix visual-
ization software complements the recently published 13CFLUX2
software and graphically supports the complete well-established
13C-MFA workﬂow. The new ‘look’ and ‘feel’ enables experi-
mentalists who are not familiar with programming or scripting to
use the 13C-MFA computational machinery immediately. The
classical command-line orientation of 13C-MFA tools has thus
become history, although certain special requirements still might
require a scripted solution. At the time of writing, 27 Omix plug-
ins can be orchestrated to tailored evaluation workﬂows (cf.
Supplementary Fig. S1.1 and Supplementary Table S1.2).
These plug-ins have been extensively tested and used in several
13C-MFA studies with toy examples as well as with realistically
complex real-life examples. As a typical use case, the developed
suite is used to analyze a variety of Corynebacterium glutamicum
strains for a broad range of dilution rates and bioreactor work-
ing volumes (unpublished data). Once a reference network model
was set up, >20 datasets were quickly processed and visually
evaluated with no overhead. Resulting ﬂux maps were visualized
with a tailored OVL script (e.g. Fig. 1E), making it easy for the
experimentalist to comparatively assess and characterize the
CLEs according to their biological, analytical and experimental

 

352

112 /810's112umo IpJOJXO'SOIlBIHJOJUIOIQ/ﬁdllq 1110131 pep1201umoq

9IOZ ‘091sn8nv uo ::

Visual workflows for 1"’C-metabolic flux analysis

 

reproducibility. With that an in-depth understanding of experi-
mental and biological robustness of C.glutamicum is conveyed.
In similar studies, the graphical workﬂows was found to strongly
reduce the development time for ﬂux models and ease serial, yet
interactive, ﬂuxome analyses. Equally important, the graphical
look-and-feel makes it much easier for 13C-MFA newcomers to
get started. Therewith, our graphical suite delivers productivity-
enhancing tools that accelerate 13C-MFA learning, execution
and dissimilation processes.

Apart from practical issues, the implementation of a complete
graphical tool suite supporting 13C-MFA is not just a simple
WYSIWYG task. A collection of innovative ideas and algo-
rithms were developed to exploit the potential of interactive
graphical visualization. Non-trivial, domain-speciﬁc, yet univer-
sal, algorithmic solutions are the derivation of CAMS from in-
formation contained in databases, full copy/paste functionality
and compatibility of CAMS, graphical proofreading and editing
of CAMS, interactive determination of free ﬂux sets, three-
dimensional representation and exploration of carbon labeling
networks, interactive path tracing, as well as the automatic gen-
eration and drawing of mixture diagrams (cf. Supplementary
Table S1.3 for a complete list).

Although bare simulation times at present are in the range of
milliseconds for single simulation runs, extensive analyses should
preferably be distributed to dedicated computing resources.
Purchase-on-demand compute models are an option for large-
scale 13C-MFA workﬂows (Dalman et al, 2013). Future work
will be dedicated to alleviating (post-)processing tasks on distrib-
uted HPC resources to meet the increasing need for real-time
accessibility and the control of ﬂuxomics workﬂows, which,
undoubtedly, presents new challenges for our visual workﬂow.

ACKNOWLEDGEMENTS

The development of Omix plug-ins for ﬂuxomics is driven by
interactions and collaborations with the 13C-MFA community
and 13CFLUX2 user groups as the ultimate end users of the
suite. On the other hand, work in related projects also inspired
and inﬂuenced the presented developments. The authors would
like to thank all direct and indirect contributors, in particular,
Andreas Dietrich (FreeFluxes, FBA plug-ins), Tobias Vehrkamp
(KEGG, Molecular Structure plug-ins), Michael Weitzel, Tolga
Dalman and Robert Siegburg (13CFLUX2 and Web service
assistance), Sebastian Niedenfiihr, Stephan Noack, as well as
Elisabeth and Stephan Zelle for providing application studies
and rigorous and time-intensive testing.

Funding: This work is partially supported by the European
Commission project SysInBio (212766).

Conﬂict of interest: none declared.

REFERENCES

Antoniewicz,M.R. et al. (2007) Elementary metabolite units (EMU): a novel frame-
work for modeling isotopic distributions. Metab. Eng., 9, 68—86.

Arita,M. et al. (2006) Map editor for the atomic reconstruction of metabolism
(ARM). In: Saito,K. et al. (eds) Plant Metabolomics. Springer-Verlag, Berlin
Heidelberg, pp. 129—139.

Chance,E.M. et al. (1983) Mathematical analysis of isotope labeling in the citric acid
cycle with applications to 13C NMR studies in perfused rat hearts. J. Biol.
Chem, 258, 13785—13794.

Choi,J. and Antoniewicz,M.R. (2011) Tandem mass spectrometry: a novel ap-
proach for metabolic ﬂux analysis. Metab. Eng, 13, 225—233.

Creek,D.J. et al. (2012) Stable isotope-assisted metabolomics for network-wide
metabolic pathway elucidation. Anal. Chem, 84, 8442—8447.

Crown,S.B. et al. (2012) Rational design of 13C-labeling experiments for metabolic
ﬂux analysis in mammalian cells. BM C Syst. Biol, 6, 43.

Dalman,T. et al. (2013) Cloud MapReduce for Monte Carlo bootstrap applied to
metabolic ﬂux analysis. Futur. Gener. Comput. Syst., 29, 582—590.

Draper,N.R. and Smith,H. (1998) Applied Regression Analysis, 3rd edn. Wiley, New
York, USA.

Droste,P. et al. (2013) Omix - a visualization tool for metabolic networks with
highest usability and customizability in focus. Chemie Ing. T ech., 85, 849—862.

Droste,P. et al. (2011a) Semi-automatic drawing of metabolic networks. Inf Vis.,
11, 171—187.

Droste,P. et al. (2008) Visual exploration of isotope labeling networks in 3D.
Bioprocess Biosyst. Eng, 31, 227—239.

Droste,P. et al. (2011b) Visualizing multi-omics data in metabolic networks with the
software Omix: a case study. Biosystems, 105, 154—161.

Ebert,B.E. et al. (2012) Flux-P: automating metabolic ﬂux analysis. Metabolites, 2,
872—890.

Fan,T.W.-M. et al. (2012) Stable isotope-resolved metabolomics and applications
for drug development. Pharmacol T her., 133, 366—391.

Gil,Y. et al. (2007) Examining the challenges of scientiﬁc workﬂows. IEEE Comput.,
40, 24—32.

Klamt,S. et al. (2007) Structural and functional analysis of cellular networks with
CellNetAnalyzer. BM C Syst. Biol, 1, 2.

Klapa,M.I. et al. (1999) Metabolite and isotopomer balancing in the analysis of
metabolic cycles: I. Theory. Biotechnol Bioeng., 62, 375—391.

Kruger,N.J. and Ratcliffe,R.G. (2009) Insights into plant metabolic networks from
steady-state metabolic ﬂux analysis. Biochimie, 91, 697—702.

Latendresse,M. et al. (2012) Accurate atom-mapping computation for biochemical
reactions. J. Chem. Inf. Model, 52, 2970—2982.

Millard,P. et al. (2014) IsoDesign: a software for optimizing the design of 13C-
metabolic ﬂux analysis experiments. Biotechnol Bioeng., 111, 202—208.

Mollney,M. et al. (1999) Bidirectional reaction steps in metabolic networks: IV.
Optimal design of isotopomer labeling experiments. Biotechnol Bioeng., 66,
86—103.

Mu,F. et al. (2007) Carbon-fate maps for metabolic reactions. Bioinformatics, 23,
3193—3199.

Nagana Gowda,G.A. and Raftery,D. (2014) Advances in NMR based metabolo-
mics. In: Simo et al. (eds) Fundamentals of Advanced Omics Technologies:
From Genes to Metabolites, Comprehensive Analytical Chemistry. Elsevier,
Amsterdam, The Netherlands, pp. 187—21 1.

Nargund,S. and Sriram,G. (2013) Designer labels for plant metabolism: statistical
design of isotope labeling experiments for improved quantiﬁcation of ﬂux in
complex plant metabolic networks. Mol Biosyst., 9, 99—112.

Orth,J.D. et al. (2010) What is ﬂux balance analysis? Nat. Biotechnol, 28, 245—248.

Pazman,A. (1986) Foundations of Optimum Experimental Design. Reidel, Dordrecht,
The Netherlands.

Ravikirthi,P. et al. (2011) Construction of an E. coli genome-scale atom mapping
model for MFA calculations. Biotechnol Bioeng., 108, 1372—1382.

Sauer,U. (2006) Metabolic networks in motion: 13C-based ﬂux analysis. Mol Syst.
Biol, 2, 62.

Schmidt,K. et al. (1997) Modeling isotopomer distributions in biochemical networks
using isotopomer mapping matrices. Biotechnol Bioeng., 55, 831—840.

Steinbeck,C. et al. (2003) The Chemistry Development Kit (CDK): an open-source
Java library for Chemo- and Bioinformatics. J. Chem. Inf Comput. Sci, 43,
493—500.

Stephanopoulos,G. (1999) Metabolic ﬂuxes and metabolic engineering. Metab.
Eng, 1, 1—11.

Tang,Y.J. et al. (2009) Advances in analysis of microbial metabolic ﬂuxes via 13C
isotopic labeling. Mass Spectrom Rev., 28, 362—375.

Terzer,M. and Stelling,J. (2008) Large-scale computation of elementary ﬂux modes
with bit pattern trees. Bioinformatics, 24, 2229—35.

Weitzel,M. et al. (2013) 13CFLUX2 - high-performance software suite for 13C-
metabolic ﬂux analysis. Bioinformatics, 29, 143—145.

Weitzel,M. et al. (2007) The topology of metabolic isotope labeling networks. BM C
Bioinformatics, 8, 315.

Wiechert,W. (2001) 13C metabolic ﬂux analysis. Metab. Eng, 3, 195—206.

 

353

112 /810's112umo [p.IOJXO'SOIlBIHJOJUIOIQ/ﬁ(11111 U101} pep1201umoq

9IOZ ‘091sn8nv uo ::

K.th et aI.

 

Wiechert,W. et al. (2001) A universal framework for 13C metabolic ﬂux analysis.
Metal). Eng, 3, 265—283.

Wiechert,W. et al. (1997) Bidirectional reaction steps in metabolic networks: II. Flux
estimation and statistical analysis. Biotechnol. Bioeng., 55, 118—135.

Wiechert,W. et al. (1999) Bidirectional reaction steps in metabolic networks: III.
Explicit solution and analysis of isotopomer labeling systems. Biotechnol.
Bioeng., 66, 69—85.

Wiechert,W. et al. (2013) Metabolic isotopomer labeling systems. Part III: path
tracing. Math. Biosci., 244, 1—12.

Wiechert,W. and de Graaf,A.A. (1997) Bidirectional reaction steps in metabolic
networks: I. Modeling and simulation of carbon isotope labeling experiments.
Biotechnol. Bioeng., 55, 101—117.

Wiechert,W. and Noh,K. (2013) Isotopically non-stationary metabolic ﬂux analysis:
complex yet highly informative. Curr. Opin. Biotechnol, 24, 979—986.

van Winden,W. et al. (2002) Cumulative bondomers: a new concept in ﬂux analysis
from 2D [13cm] COSY NMR data. Biotechnol. Bioeng., 80, 731—745.

Winter,G. and Kromer,J.O. (2013) Fluxomics - connecting’ omics analysis and
phenotypes. Environ. Microbiol, 15, 1901—1916.

Zamboni,N. (2011) 13C metabolic ﬂux analysis in complex systems. Curr. Opin.
Biotechnol, 22, 103—108.

Zamboni,N. et al. (2009) 13C-based metabolic ﬂux analysis. Nat. Protoc., 4,
878—892.

Zhou,W. and Nakhleh,L. (2012) Quantifying and assessing the effect of chemical
symmetry in metabolic pathways. J. Chem. Inf. Model, 52, 2684—2696.

 

354

112 /810's112umo [p.IOJXO'SOIlBIHJOJUIOIQ/ﬁ(11111 U101} pep1201umoq

9IOZ ‘091sn8nv uo ::

