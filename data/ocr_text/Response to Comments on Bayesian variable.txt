LETTER TO THE EDITOR

Vol. 27 no. 15 2011, pages 2169—2170
doi: 10. 1093/bioinformatics/btr334

 

Gene expression

Advance Access publication June 22, 2011

Response to “Comments on ‘Bayesian variable selection for
disease classification using gene expression data’ ”

Xin-Yuan Song* and Zhao—Hua Lu

Department of Statistics, Chinese University of Hong Kong, Shatin, N.T., Hong Kong

Associate Editor: Alfonso Valencia

 

Contact: xysong@sta.cuhk.edu.hk

Received on April 6, 2011; revised on May 17, 2011; accepted on
May 30, 2011

This letter is a response to the comments of Baragatti and
Pommeret (2011) on Yang and Song (2010a) in Bioinformatics.
Baragatti and Pommeret (2011) pointed out that in the case where
the covariance matrix of the g—prior (Zellner, 1986) is singular, the
computation of the posterior distributions proposed by Yang and
Song (2010a) has a technical issue. In this letter, we provide a
solution to address this issue.

Following notations in Yang and Song (2010a), Y is an n-
dimensional vector of binary observed random variables, Z is an
n X 1 vector of the underlying continuous latent variables, Xy is an
n X py matrix of selected covariates, or is an intercept, ,6), is a py X 1
vector of the corresponding regression coefﬁcients and py is the
number of selected covariates. The g-prior (see Zellner, 1986) for
,6), is N(0,c(X;,Xy)_1), where c is a speciﬁed value. If n <py, Xij
is not a full rank matrix and (X;,Xy)_1 does not exist. Moreover,
X3,Xy is nearly singular when highly collinear covariates exist.
In these cases, Yang and Song (2010a) proposed a modiﬁed form
of the g-prior, namely the generalized singular g-prior (gsg—prior),
in which the matrix (X;,Xy)_1 was replaced by the Moore—
Penrose generalized inverse (Xij)+. Under the model and prior
speciﬁcations, the joint posterior distribution p(Z, or, ,By, yl Y, X) can
be derived; see Equation (7) in Yang and Song (2010a). However,
directly simulating observations from this joint posterior distribution
is infeasible due to its complexity. To simplify the computation, Yang
and Song (2010a) integrated or and ,6), out from p(Z,a, ,By, le,X),
and obtained the joint posterior distribution of (Z, 3/) as follows:

P(Z,)/|Y,X)O< (1)

1 212—12 n P .
.exp — V HI(Ai)x1'[n,V'(1—m)1—Vi,
lib/l5 2 i=1 i=1

 

 

where 2}, :1n +h11’ +ch(X§,Xy)+X;,. When integrating out ,By,
the inverse of the matrix A=X;,{(In +h11’ )_1 +0—1In}Xy is used
in their Equation (A7) (see Yang and Song, 2010b). The technical
issue pointed out by Baragatti and Pommeret (2011) is about the
infeasibility of taking inverse of the matrix A if Xg,Xy is singular.

 

*To whom correspondence should be addressed.

In the following, we show thatA‘1 is not necessary in the derivation
of p(Z, le,X), and thus p(Z, le,X) in Yang and Song (2010a) is
still valid when X3,Xy is singular.

Let my 2 rank(Xy) 5 min(n,py), Xg, = QVD be the singular value
decomposition (SVD) of X’ , where Q and D are py X py and n X n
orthogonal matrices, respectively, and V is a py X 11 diagonal matrix,
the ﬁrst my diagonal elements of which are positive. The SVD can
be expressed as

X’, =QVD=QR= (01 Q2)  =Q1R1a (2)

where Q1 and Q2 are py xmy and py X (py —my) matrices,
respectively, and R1 is an my X 11 matrix with full row rank. When
Xg,Xy is singular, inspired by the Theorem 1 in Panagiotelis and
Smith (2008), we modify the gsg-prior to make it proper:

ﬂy ~N(0, C(X;Xy)+)I(Q/2,By =0), (3)

the density of which can be expressed as:

my my _1 [Bl XI X ’6
P<ﬁylw=<2ncr7 HA, 2 exp (_L”V

i=1 26 )I(Q216'}/=0)s

(4)
where A1, ...,)tmy are the non-zero eigenvalues of (X3,Xy)+.
Q2 contains the eigenvectors corresponding to the null-space of
X3,Xy. By adding a point mass at zero in (3) or (4), we restrict
,6), on the reduced space over which the covariates set provides
information. We will show that this restriction solves the problem
of integrating out ,8), when X3,Xy is singular. We also show that this
restriction is only for the purpose of integrating or and ,6), out from
p(Z,a, ,By, le,X), and it is not involved in the subsequent MCMC
algorithm. Therefore, the restricted gsg-prior in (3) or (4) is a natural
and realistic choice in the case of singularity of X3,Xy. If X’ Xy is
invertible, Q2 does not exist, the restriction in (3) or (4) disappears,
leading to the gsg-prior proposed in Yang and Song (2010a). Let
ﬂy: [1,3y’ IBy=QI2IBw and ﬁ:=(ﬁ’,,ﬁ’,)’=Q'/8y. The prior (4)
can be induced by the following prior for ,835:

p(ﬁ:ly)=p(Bny)p(/§y|y) (5)
m, my _1 ,"3’ R R’B :
= |:(27tc)_7i11)ti 2exp(—%):| XI(,By=0),

where the distribution of By and 73),, given 3/ are N (0, C(R1 R’1)_1)

~

and a degenerate distribution with a point mass density on By :0,
respectively (see Panagiotelis and Smith, 2008).

 

© The Author 2011. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oup.com 2169

112 Bio'SIBulnoprOJxo'soi1cu110juioiq//:d11q IIIOJJ p9p1201umoq

910K ‘09 lsnﬁnV uo ::

X.-K Song and Z.-H. Lu

 

In implementation of the MCMC algorithm, Yang and Song
(2010a) ﬁrst integrated at and ,6), out from the joint posterior
distribution p(Z , a, ,By, yl Y, X), and then sampled from the marginal
posterior distribution p(Z, le,X) with Gibbs sampler. In the
following, we show that the same marginal posterior distribution
p(Z, le,X) can be derived when X3,Xy is singular. To do so, we
transform ,6), to ,6)"; as follows:

p(z,yIY,X)= ffp(z,a,ﬁy,yIY,X)dad/8y

 

 

 

 

* dIBV >l< ( dﬁy )
= p(Z,a,/3 ,le,X) * dad/3 * =|Q|=1
ff V ldﬁy V dﬁy

where

P(Za0(al~3ya/:3ys 
hes—awry»<Z-a1-th>}nh.)]

 

2 i=1
a2 BleRiBy : my _1/2
xexp —Z X exp —2—C 1033,2041)”
P
xnng’ia—mf—Vi. (7)

i=1

From (7), 3;, is integrated out immediately. According to the same
reasonings given in Yang and Song (2010a), a can be integrated
out by forming a Gaussian probability density of a in (7), and the
remaining exponentiated term in (7) can then be rewritten as

33,1313); — 233,3 z'(I,, +h11’)Z

 

 

 

2 2
_ _ (By —A—1B)’A(By 41—13) _
_ 2
z’(I,,+h11')z—B’A-1B
2 , (8)

where A=R1{(I,,+h11’)-1+c-1In}R’, and B=R1(I,,+
h11’)_1Z. The above expression (8) is similar to (A7) in Yang and
Song (2010b) but here A is invertible. The ﬁrst term in (8) is a
completed quadratic form of By, which forms a gaussian probability
density and can be integrated out. The second term in (8) ffgrms the
kernel of a posterior probability density of Z |X, y as —Z’E; 1Z/2,
where §;1=(I+h11’)-1—(I,,Min-1113241110,,+h11’)-1.
Similar to the derivation in Yang and Song (2010b), we can prove
that

P(Z|X, V) ~N(0, Ely), and

1 zl —1Z n
p(Z,r|Y,X)o< Wexp(— Tyﬂ'jlmi)
l:

P
i 1— i
xnnﬂl—m) V,
i=1

where §y=1n+h11’+cR;(R1R;)+R1.

In the following, we further show that Ely = 2),. Thus, the
marginal posterior distribution p(Z, le,X) in Yang and Song
(2010a) is unchanged even if X3,Xy is singular.

PROPOSITION 1. If S is a symmetric matrix and Q is an orthogonal
matrix of appropriate dimensions, then (QSQ’)+ = QS+Q’.

PROPOSITION 2.

l + _ (R1R1)+ 0
(RR ) _( 0 0 .

These propositions can be veriﬁed easily by using the deﬁnition
of the Moore—Penrose inverse.

THEOREM 1. xy(x;,x,,)+x;,=R;(R1R’1)+R1.
Proof.
Xy(X’,Xy)+X’, = R’Q’(QRR’Q’)+QR
= R’(RR’)+R
= R’1(R1R;)+R1.
Based on Theorem 1,
E, = In+h11’+cR’1(R1R;)+R1
= In+h11’+cx;,(x,,x;,)+x,,=>:,,.

We are very thankful to Baragatti and Pommeret for pointing
out the technical issue when integrating out ,6), in the case of
singularity of X3,Xy. In this response, we have shown that the
technical issue can be addressed by slightly modifying the gsg—
prior in Yang and Song (2010a), and that this minor modiﬁcation
does not change the marginal posterior distribution p(Z, le,X).
Therefore, the MCMC algorithm proposed in Yang and Song (2010a)
encounters no problem regardless of singularity of Xij.

Funding: This research was fully supported by grants (GRF 446609
and 403109) from the Research Grant Council of the Hong Kong
Special Administration Region.

Conﬂict of Interest: none declared.

REFERENCES

Baragatti,M. and Pommeret,D. (2011) Comments on ‘Bayesian variable selection for
disease classiﬁcation using gene expression data’. Bioinformatics, 27, 1194.

Panagiotelis,A. and Smith,M. (2008) Bayesian identiﬁcation, selection and estimation
of semiparametric functions in high-dimensional additive models. J. Econometrics,
143, 291—3 16.

Yang,A.J. and Song,X.Y. (2010a) Bayesian variable selection for disease classiﬁcation
using gene expression data. Bioinformatics, 26, 215—222.

Yang,A.J. and Song,X.Y. (2010b) Supplementary material to Bayesian variable selection
for disease classiﬁcation using gene expression data. Bioinformatics, 26.

Zellner,A. (1986) On assessing prior distributions and Bayesian regression analysis
with g-prior distributions. In Geol,P.K. and Zellner,A. (eds) Bayesian Inference
and Decision Techniques: Essays in Honour of Bruno de Finetti. Elsevier Science,
North Holland, Amsterdam, pp. 233—243.

 

2170

112 /810'SIBulnoprOJxo'sor1eu110jurorq//:d11q uroxj pepeommoq

910K ‘09 lsnﬁnV uo ::

