ORIGINAL PAPER

Vol. 29 no. 22 2013, pages 2835—2843
doi:10. 1093/bioinformatics/btt503

 

Genome analysis

Advance Access publication September 3, 2013

A statistical variant calling approach from pedigree information
and local haplotyping with phase informative reads

Kaname Kojima", Naoki Nariai, Takahiro Mimori, Mamoru Takahashi,
Yumi Yamaguchi-Kabata, Yukuto Sato and Masao Nagasaki*
Department of Integrative Genomics, Tohoku Medical Megabank Organization, Tohoku University, 2—1 Seiryo—machi,

Aoba—ku, Sendai, Miyagi 980—8573, Japan
Associate Editor: Martin Bishop

 

ABSTRACT

Motivation: Variant calling from genome-wide sequencing data is
essential for the analysis of disease-causing mutations and elucidation
of disease mechanisms. However, variant calling in low coverage
regions is difficult due to sequence read errors and mapping errors.
Hence, variant calling approaches that are robust to low coverage
data are demanded.

Results: We propose a new variant calling approach that considers
pedigree information and haplotyping based on sequence reads span-
ning two or more heterozygous positions termed phase informative
reads. In our approach, genotyping and haplotyping by the assign-
ment of each read to a haplotype based on phase informative reads
are simultaneously performed. Therefore, positions with low evidence
for heterozygosity are rescued by phase informative reads, and such
rescued positions contribute to haplotyping in a synergistic way. In
addition, pedigree information supports more accurate haplotyping as
well as genotyping, especially in low coverage regions. Although het-
erozygous positions are useful for haplotyping, homozygous positions
are not informative and weaken the information from heterozygous
positions, as majority of positions are homozygous. Thus, we intro-
duce latent variables that determine zygosity at each position to filter
out homozygous positions for haplotyping. In performance evaluation
with a parent—offspring trio sequencing data, our approach outper-
forms existing approaches in accuracy on the agreement with single
nucleotide polymorphism array genotyping results. Also, performance
analysis considering distance between variants showed that the use of
phase informative reads is effective for accurate variant calling, and
further performance improvement is expected with longer sequencing
data.

Contact: nagasaki@megabank.tohoku.ac.jp or kojima@megabank.
tohoku.ac.jp

Supplementary information: Supplementary data are available at
Bioinformatics online.

Received on March 19, 2013; revised on August 26, 2013; accepted
on August 27, 2013

1 INTRODUCTION

Owing to the progress of next-generation sequencing (NGS)
technologies, whole-genome sequencing for each individual

 

*To whom correspondence should be addressed.

becomes possible in practical time and with reasonable cost for
the identiﬁcation of disease-associated mutations. Also, individ-
ual genome data from case—control study or study with pedigree
analysis contribute to the elucidation of unknown disease mech-
anisms. Because accurate variant calling is required for the ana-
lysis of these genomes in a reliable manner, the development of
accurate variant callers is demanded.

In most of the variant callers, variants such as single nucleotide
polymorphisms (SNPs), insertions and deletions are detected at
each position in a reference genome from the information of
mapped sequence reads. Because there exist positions with insuf-
ﬁcient coverage of reads due to bias in the library preparation
and mapping failures at short tandem repeat polymorphic sites
or variable number of tandem repeat sites, reliable variant calling
is challenging at these sites (Li et al., 2009; Treangen and
Salzberg, 2011). To improve the reliability of variant calling,
several approaches have been proposed, where additional infor-
mation such as pedigree information among individuals and link-
age disequilibrium among SNPs is considered (Cartwright et al.,
2012; Chen et al., 2013; Li et al., 2012).

At present, read length of sequence reads from most of the
next-generation sequencers is <250 bp.

However, read length is still extending from the improvement
of sequencing protocols, and several sequencers such as Paciﬁc
Biosciences’ RS sequencer can produce sequence reads with
thousands of base pairs although their throughput is not high
and their read error rate is relatively high compared with other
sequencers such as Illumina HiSeq (Quail et al., 2012). Longer
sequence reads are more likely to cover two or more heterozy-
gous genotyping positions, and the use of reads spanning
multiple heterozygous positions is effective for accurate phasing
(He et al., 2012; Menelaou and Marchini, 2013).

Thus, an approach considering such phase informative reads
is promising for reliable variant calling even in low coverage
regions.

We propose a new statistical variant calling approach that
considers pedigree information and haplotyping based on
phase informative reads. In the estimation process, genotyping
and haplotyping by the assignment of each read to a haplotype
based on phase-informative reads are simultaneously performed
in a probabilistic manner. Thus, positions that have low evidence
for heterozygosity owing to the lack of mapped sequence reads
are rescued by the phase informative reads, and such rescued
variant positions also can be used for the evidence on phasing.

 

© The Author 2013. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com 2835

112 ﬁle'slcumo[pJOJXO'sopchOJuioiq/ﬁd11q IIIOJJ pepcolumoq

910K ‘09 lsnﬁnV no :2

K.Kojima et al.

 

In addition, the use of pedigree information is effective not only
for phasing but also for estimating variant positions because low
coverage regions in each individual are supported by sequence
reads covering the same regions in other individuals Via pedigree
information. From the synergistic effect by the use of phase-
informative reads and pedigree information, more accurate
variant calling is expected in our proposed approach than
other variant callers estimating variants independently on pos-
itions and individuals.

In the haplotyping process of our approach, sequence reads
are assigned to a more probable haplotype between two haplo-
types based on a binomial model, and heterozygous positions are
phased by the assigned reads spanning multiple heterozygous
positions.

Although homozygous positions are not informative for phas-
ing and cannot be used to distinguish between haplotypes, they
are also used for data for the binomial model for phasing.
Because the majority of positions are homozygous, information
from heterozygous positions is weakened and assignment of
reads to haplotypes can be misled. To address this issue, we
introduce latent variables that determine zygosity at each pos-
ition to the model. By ﬁltering out the information from highly
probably homozygous positions by using the latent variables,
only information from heterozygous positions is selectively
used for phasing.

The remainder of this manuscript is organized as follows. We
describe a statistical model of our proposed approach and pro-
Vide how the parameters and genotypes are estimated in Section
2. In Section 3, we compare the performance of our proposed
approach and other existing variant callers through a simulation
data analysis and real data analysis with human whole-genome
sequencing data from Illumina HiSeq 2000 and SNP array gen-
otyping results from Illumina OMNI 2.5 BeadChip. We finally
discuss and conclude the performance evaluation results and
effective points of our approach in Section 4.

2 METHODS

Our approach uses mapped sequence reads to a reference genome on the
SAM/BAM format and pedigree information of individuals as input
data, and then variant calling results are returned in variant calling
format WCF) (Danecek et al., 2011) after the estimation. The model of
our approach comprises three parts: allele likelihood part, pedigree part
and haplotype selection part. Allele likelihood part represents a likelihood
function of an allele, given aligned reads at a position under the consid-
eration of sequencing errors and mapping errors. Pedigree part represents
the allele transmission from parents to offspring, and haplotype selection
part represents selection of haplotype from which sequence reads are
generated. In the following sections, we describe the details of these
three parts and procedures for parameter estimation and genotype infer-
ence in the proposed model.

2.1 Allele likelihood part

Let Rx, be the ith read in a SAM/BAM ﬁle for individual x. Rx, contains
its mapping quality score in Phred scale MAPQxi, strings for bases
aligned to position k in the reference genome rii and vectors of base
quality scores in Phred scale for the aligned bases bqii. Note that r; is
just one nucleotide such as ‘T’ in many cases, but it can be a string with
more than one nucleotide for representing insertion, e. g. a string ‘TGC’
represents an insertion ‘GC’ right after a base ‘T’. The rﬁi can also be a

string of length 0 to represent deletion. By using these notations, we give a
likelihood function for allele A at position k as:

Pei/1,1242): Z : P<&.iA,b:.->’<mﬁ=l>

bﬁizo, 1 mﬁizo, 1 (1)
k _
mei. (rkxi)1(mx‘_0)P(m’;,-)P(b’;,|bﬁi),

where mi,- is a binary variable that takes 1 if the alignment of rkxi is correct
and 0 otherwise. The term bit. is a vector of binary variables, and each
element indicates the correctness of each base in rﬁi, i.e. if sequencing of a
base is correct, the corresponding element takes 1 and 0 otherwise. The
term I(-) is an indicator function that returns 1 if condition in its argu-
ment is true, and 0 otherwise. As with rkxi, allele A is represented by a
string with nucleotides ‘A’, ‘T’, ‘G’ and ‘C’. The term P(r§i|A,b§i) in
Equation (1) is the probability of read generation for the correct read
alignment, and we represent the probability as:
min(Iz‘1|,|r’,§,-|)
P(/;.-IA,b§.-) = Indel(A,rJ;.-) H P(&.inIAili.b§.izi),
[:1

where A[l] is the lth nucleotide of A, r§i[l] is the lth nucleotide of rii, b§i[l]
is the lth value of bit. and function Indel represents read skip errors and
insertion errors. | - | takes a string or set as its argument and returns
length for string or size for set, e.g. |ATG| = 3. We model function
Indel by using read skip error rate 6 and insertion error rate L as:

Indel“,  = 51(IAI>Ir’;,-I)(1 _ 8)1(IAISI/;,-I)

In this study, we set 8 and L to 0.001. P(r§i[l]|A[l],b§,-[l]) models base
substitution error on each base and is given by:

1  = All] & béiU] = 1
PV’xiVI'AI’I’ biz-I11) = 1/3 rill] 75 All] & 12:11] = 0.

0 otherwise

Pm,-_,(r§i) represents the probability of read generation for misaligned
reads. We consider that reads representing indels, i.e. reads with 0 length
or >1 nt are generated more probably than reads with lnt in the mis-
alignment, and design Pmis(rkxi) as:

I l/Nmis  = 1
Pmls  _  OthCrWiSe ,

Here, Nmis is the normalization factor given by ZAEAxk 11(IA'21)p,I,gL;4I¢D,
where Axk is a set of possible alleles for individual x at position k. Axk is
given by {‘A’, ‘T’, ‘G’, ‘C’}U null string for deletion. In addition, if there
exist reads with nucleotides more than one aligned at position k, the
corresponding sequences are added, Axk. In this study, we set pmis to
1.0, i.e. we assume that the read is generated from possible alleles equally
probably. P(b§i|bq§i) is factorized as H,P(b§i[l]|bq§i[l]), and each term is
given by a binomial distribution with parameter 1 — 10‘bqiiW10:

k. :
P(b:illllbq§,[l]) = [1 _ 10—bq’;i[[]/10:|I(bx,[ll 1)

k _
x [lO‘bqiilﬂ/10]I(bxim_o)
P(m§i) is given by a binomial distribution with parameter pmk_. We also

give a beta distribution with parameters am(1 — 10‘MAPQxi/10) and
or,,,10‘1‘4““DQxi/10 as prior distributions of pmk_. Thus, pmk_ is updated by
considering both probability for alignment reliability of read r§i from the
model and mapping quality score MAPQxi. We set prior strength am to 10.

2.2 Pedigree part

Pedigree part considers statistical relationship among the genotype of
individuals in a pedigree. Here, we consider a model of a parent—cth

 

2836

112 [glO'SIBILInO[p.IOJXO'SODBIIIJOJIIIOIQ/ﬂdllq IIIOJJ pepcolumoq

910K ‘09 lsnﬁnV no :2

Variant caller with pedigree information and local haplotyping

 

trio with child 6, mother m and father f. Let ka be a genotype
(Aik,A§k) at position k for individual x e {c,m, f}. We also let tmk
and tfk be binary variables that take 1 or 2 to indicate the allele trans-
mission to the offspring, e.g. if tmk is 1, AEnk is transmitted to the off-
spring. The joint probability of genotypes for child, mother and father
is factorized as:

P (Gck, G/k, Gmklt/k, tmk) = P (Gclemk, G/k, t/k, tmk)
x P(G,,,k)P(Gﬂ,)

P(Gck|Gmk, G/k, tfk, tmk) represents allele transmission, and we model it as:

P(Gck|Gmk, Gfk, ka, tmk) :  8)I(tmk=l)
x P(A(1:k|A2 .8)1(tmk=2)

mk’
It :1
x P(Aik|A}k; 8) (1k )
It :2
x P(Aik|A}k; 8) (1k )

The conditional probability P(A(1,k|A1 ' 8) is given by:

mk’

1‘8 AlkZAllnk

1 1 . _
P(ACk|Amk’ 8) _ { 8 otherwise ’

where 8 is de novo mutation rate including both germline and somatic
mutation rate. We set 8 to 2.5 x 10‘7 based on the assumption about de
novo mutation rate in the genome-wide mutation study of parent—
offspring trio sequencing data from the 1000 Genomes Project
(Cartwright et al., 2012; Conrad et al., 2011). For considering chromo-
somal recombination, we give a probability on transition of tmk between
positions by:

P(tmk|tmk—1) = ‘L'I(t”'k7étmk-1)(1 _ T)I(tmk:tmk—1)’

where ‘L’ is chromosomal recombination rate. We set ‘L’ to 10‘s, as 1 cM is
on average~106 bp in human genome (Collins et al., 1996). For prior
probabilities of founders’ genotypes Gmf and Gfk, we assume the following
factorization:

P(Gm ) = P(A11nk)P (2)

P(A,1nk) is a prior distribution for allele frequency, and we use a distri-
bution considering reference allele and an empirical distribution from
aligned reads given by:

: 18.12802... k) + 13.10}... = A21) + ﬁu/IAmki
IBr + 18d + ,8u ’

where Pek is an empirical distribution for allele from aligned reads to
position k and A}:f is a reference allele at position k. 139, ,8, and ,8“ are
non-negative parameters for adjustment. For alleles in neither reference
allele nor aligned reads, uniform distribution 1 /|Amk| is considered. We
deal with ,8, as a position-dependent value and set it to the read depth at
each position, whereas ,8, is set to the coverage of data. Because 1/1000
homologous positions are different between two chromosomes in empir-
ical rough estimate, we set ,8“ to 0.001 x 13,.

 

P(A11nk)

2.3 Haplotype selection part

Haplotyping part links allele likelihood part and pedigree part by select-
ing a haplotype from which read is generated. Given a genotype
ka = (Aik,Aik) at position k for individual x, haplotype selection
part selects an allele, from which each read is generated, by using
binary variable hi,- in the following manner:

k _ k 2
H Phi-IA}...bqii)"”xi‘”P(&.iAik.bay“: 2’P(h§.-), (3)
1'6ka

where ka is a set of indexes of reads for individual x that contain aligned
reads at position k. In a simple setting, the allocation of each read to

haplotypes is equally probable and independent of positions, i.e.
P02;- 2 1) and P02;- 2 2) are 0.5. Here, instead of P(hx,-), we consider
a conditional probability P(h§i|zxk) given by:

k phxi  = 1&Zxk :1
P(hxi|Zxk) = 1 —phxi  : 2&Zxk : 1 
 Zxk : 0

where phxi is a rate for the assignment of read Rx,- to a haplotype and zxk is
a binary variable that determines zygosity at position k for individual x
and takes value 1 for heterozygote and 0 for homozygote. For paired-end
data, phxi is shared in each read pair.

To represent zygosity with zxk, we introduce a conditional probability
P(zxk|A)lck,Aik) that is given by:

1 2 1.0 01"
P(Zxk|Axk’Axk) : Alk 7E Azk & Zxk = 1
x x
() otherwise

The role of zxk is to ﬁlter out highly probably homozygous positions
from data for read assignment Via Equation (4), and hence only highly
probably heterozygous positions are used for haplotyping.

phxi represents one of the two chromosomes from which read Rx,
comes. Because each read comes from one of the two homologous
chromosomes equally probably in an ideal condition, we represent this

property with the following formula:
P( 2 p1,.) = N( 2 p1,; Ikal/Z, L'ikaI/4)

1'6ka 1'6ka

where N represents normal distribution and Z is the average read length.
Zidxk phxi is considered as the number of reads from the same chromo-
some at position k. Because Zidxk phxi is a continuous value, normal
approximation of a binomial distribution with parameter 0.5 is used.
Although the mean and variance of the normal distribution approximat-
ing a binomial distribution with parameter 0.5 are |ka|/2 and llxkl/4,
respectively, we set the variance to 112ku /4 to normalize the effect with
the average read length.

2.4 Parameter estimation and genotype inference

By using allele likelihood part, pedigree part and haplotype selection
part, the complete likelihood of our model is given in the following
formula:

..ph...)]P(tmo)P(rfo)
X H P(Imk|1mk—1)P(tfk|t/k—1)P(Gck, Gmk, G/kltmk, 11k)

k
X H P(ZXk|A)1ck9A)2ck) H P(h];ilzxk§17hxi)

xe{c, m,f} 1'6ka

[ H P(phx1,..

xe{c, ml}

(5)

2
XP(pml;i  l—I  bq:i; pmii)1(hl;i:S),

s=1

where Ix is a set of indexes of reads for individual x and
P(phx1, ...,phxl1x|) is the joint probability of phxi and proportional to
Hk ﬁzz-61x]: phxi). In Equation (5), observed variables are rid, bqii and
MA Qxi, latent variables are 1,, , Aik, Aik, zxk and hit. and parameters are
pmjck and phxi°

Figure 1 gives a graphical representation of our proposed model,
where observed variables are in gray and latent variables and parameters
are in white. We use an EM algorithm for parameter estimation, as the
model contains many latent variables and the model structure of these
variables is complicated. In E-step, the calculation of the marginal prob-
abilities on latent variables such as hi,- and zxk is required. However,
unlike usual hidden Markov models, exact probabilistic inference requires

 

2837

112 [glO'SIBILInO[p.IOJXO'SODBIIIJOJIIIOIQ/ﬂ(11111 IIIOJJ pepcolumoq

910K ‘09 lsnﬁnV no 22

K.Kojima et al.

 

 

 

 

 

 

 

 

 

 

Mother’s reads: Rm

“9%

 

 

/ XI Willi—1"  ll I

 

/i 1; '\ '\;\\ I

 

 

 

 

 

 

\

 

‘

 

 

 

 

\\ \\ |
@ Fathelr’sreadszRf\\ \\ I
a E E
pmgk I  l4/ I
' I ' i @

 

Child’s reads: RC

Fig. 1. Agraphical representation of our proposed model, where latent variables and parameters are in white and observed variables are in gray

high computational time when the pedigree size is large and its structure
is complicated. To address this type of computational issue, we use loopy
belief propagation to calculate the approximated marginal probabilities
required in M-step (Murphy et al., 1999; Yedidia et al., 2005). In M-step,
pmk_ and phxi are updated by using the marginal probabilities calculated in
E-step. For details of parameter estimation by the EM algorithm, see
Section 1 in the Supplementary Material.

Genotype inference is performed at each position independently.
For genotype inference on position k, we search a conﬁguration of
latent variables Aik, Aik, AEnk, Afnk, A}k and Afk that maximizes their
marginal probability. We again use loopy belief propagation to cal-
culate the approximated marginal probability of these variables and
then apply the max-product algorithm to obtain the conﬁguration
maximizing the approximated marginal probability Weiss and
Freeman, 2001).

2.5 Suppression of variant calling at positions next to
homopolymer regions and indels

In the base calling on Illumina reads, the position next to a homopolymer
region tends to be called as the base comprising the homopolymer be-
cause phasing accumulated in synthesis during the Illumina sequencing
process affects the base calling result. Thus, if there exists a homopolymer
left side of a position in the reference genome, reads from the forward
strand tend to have the base comprising the homopolymer at the position,
whereas reads from negative strand do not. From this observation, our
approach suppresses variant calling at positions satisfying the following
three conditions for Illumina reads:

0 A position is next to homopolymer whose length is more than two.

0 The majority of alternative alleles is the same as the base comprising
the homopolymer.

o More than 90% of the aligned reads have the same strand.

In addition, to avoid false positive (FP) variant calling around indels,
we use base alignment quality BAQ from SAMtools (Li, 2011) as base
quality score.

3 PERFORMANCE EVALUATION

3.1 Simulation data analysis

We evaluated our proposed approach, which hereafter we call
PedigreeCaller, by using synthetically generated parent—offspring
trio sequence data. We ﬁrst generated genome sequences of
chromosome 21 for two Utah residents with Northern and
Western European ancestry (CEU) individuals NA12286 and
NA12287 according to the variant calling and phasing results
in a VCF ﬁle released on November 23, 2010, by the 1000
Genomes Project. We then synthetically generated genome
sequences of their child by randomly choosing one of the
genome sequences for each individuals and recombining them
with recombination rate of 1.0 x 10‘s. The number of variants
for these three individuals is 149 947.

From these genome sequences, we generated paired-end
sequence reads and put 0.1% bases substitution errors. As base
quality scores for the reads, we uniformly gave Q30 to each base,
which corresponds to 0.1% error. We generated three types of
datasets with the following conditions:

0 Read length is 100 bp, and insert size is normally distributed
with mean 400 bp and standard deviation 50 bp.

0 Read length is 500 bp, and insert size is normally distributed
with mean 2000 bp and standard deviation 250 bp.

0 Read length is 1000 bp, and insert size is normally distribu-
ted with mean 4000 bp and standard deviation 500 bp.

 

2838

112 [3.10811211an[plOJXO'SODBIIIJOJIIIOIQ/[idllq 111011 pepcolumoq

910K ‘09 lsnﬁnV no 22

Variant caller with pedigree information and local haplotyping

 

The BAM ﬁles for these datasets were obtained by mapping
the sequence reads to UCSC hg19 reference genome for chromo-
some 21 with BWA—MEM (Li, 2013). To evaluate the perform-
ance of our proposed approach with various read coverage, we
downsampled the BAM ﬁles with Picard DownsampleSam
(http://picard.sourceforge.net/) and obtained BAM ﬁles with
read coverage of 5, 10, 20 and 40x for each individual. These
downsampled BAM ﬁles were realigned with Genome Analysis
Toolkit(GATK) Indel Realigner (DePristo et al., 2011).

For the comparison with existing approaches, we used the
following four methods: GATK Uniﬁed Genotyper (DePristo
et al., 2011; McKenna et al., 2010), BCFtools with SAMtools
mpileup (Li et al., 2009), TrioCaller (Chen et al., 2013)and
PolyMutt (Li et al., 2012). In Uniﬁed Genotyper and
SAMtools, variant calling is performed for each individual inde-
pendently, i.e. no pedigree information is considered. TrioCaller
takes variant calling results from other callers as input data, and
re—estimates variants by considering pedigree information and

linkage disequilibrium. Note that linkage disequilibrium infor-
mation is limited in this experiment, as only three individuals
are considered. For the input of TrioCaller, we used results
from SAMtools as is in the instruction of TrioCaller users’
example. PolyMutt takes genotype likelihood information from
other variant callers as its input data, and estimates variants by
considering pedigree information. As is instructed in PolyMutt
web page, we obtained likelihood information from SAMtools in
Genotype Likelihood Format (GLF) and used it as the input
data of PolyMutt. We used Uniﬁed Genotyper and PolyMutt
with default options. For SAMtools/BCF tools, we used the com-
mands described in SAMtools Web site without variant ﬁltering
with depth (http://samtools.sourceforge.net/mpileup.shtml). For
TrioCaller, we set ‘—round’ option to 100 and used default setting
for other options.

Table 1 summarizes the performance of variant detection on
our proposed approach and these four methods: the numbers of
true positives (TPs), FPs, accuracy, recall, precision and F -

Table 1. Comparison on the variant detection performance of PedigreeCaller, PolyMutt, TrioCaller, SAMtools and GATK-Uniﬁed Genotyper for
simulation datasets with read coverage of 5 and 10x and read length of 100, 500 and 1000 bp

 

 

 

 

 

 

 

 

 

 

 

 

 

Read coverage Read length (bp) Method Number of TPs Number of FPs Recall Precision F-measure
PedigreeCaller 137 206 654 0.9150 0.9953 0.9535
PolyMutt 136 383 781 0.9095 0.9943 0.9500
100 TrioCaller 135 162 1076 0.9014 0.9921 0.9446
GATK 104 231 E 0.6951 0.9972 0.8192
SAMtools 118 661 2202 0.7914 0.9818 0.8763
PedigreeCaller 138 040 504 0.9206 0.9964 0.9570
PolyMutt 137 506 781 0.9170 0.9944 0.9541
5 X 500 TrioCaller 136 303 1282 0.9090 0.9907 0.9481
GATK 104 406 y 0.6963 0.9970 0.8199
SAMtools 120 514 2292 0.8037 0.9813 0.8837
PedigreeCaller 137 638 357 0.9179 0.9974 0.9560
PolyMutt 137 602 810 0.9177 0.9941 0.9544
1000 TrioCaller 135 863 1524 0.9061 0.9889 0.9457
GATK 104 406 m 0.6963 0.9970 0.8199
SAMtools 120 751 2314 0.8053 0.9812 0.8846
PedigreeCaller 146 738 291 0.9786 0.9980 0.9882
PolyMutt 146 122 E 0.9745 0.9984 0.9863
100 TrioCaller 145 718 441 0.9718 0.9970 0.9842
GATK 137 984 401 0.9202 0.9971 0.9571
SAMtools 141 308 406 0.9424 0.9971 0.9690
PedigreeCaller 147 207 @ 0.9817 0.9988 0.9902
PolyMutt 146 590 207 0.9776 0.9986 0.9880
10X 500 TrioCaller 146 089 586 0.9743 0.9960 0.9850
GATK 138 087 387 0.9209 0.9972 0.9575
SAMtools 142 326 422 0.9492 0.9970 0.9725
PedigreeCaller 147 349 @ 0.9827 0.9991 0.9908
PolyMutt 146 734 198 0.9786 0.9987 0.9885
1000 TrioCaller 146 511 251 0.9771 0.9983 0.9876
GATK 138 580 383 0.9242 0.9972 0.9593
SAMtools 142 854 373 0.9527 0.9974 0.9745

 

Note: The best result on each condition is underlined.

 

2839

112 ﬁle'slcumo[pJOJXO'sor112u1101urorq/ﬁd11q 111011 pepcolumoq

910K ‘09 lsnﬁnV uo 22

K.Kojima et al.

 

measure for the sequencing data with read coverage of 5 and
10x. Results for 20 and 40x are summarized in Section 2 of
the Supplementary Material. In variant detection, if a genotype
estimated at a position and true genotype at the position are not
homozygous for the reference allele, the estimated genotype is
counted as TP. On the other hand, if true genotype is homozy-
gous for the reference allele, the estimated genotype is counted as
F P. Note that TPs could contain estimated genotypes that are
different from their corresponding true genotypes, e. g. if an esti-
mated genotype and true genotype at a position with reference
allele A are (A, B) and (B, B), respectively, the estimated geno-
type is counted as TP. Recall and precision are given by j Jul);
and m, respectively. F -measure is giveln by the har-
monic mean of recall and precision as 2 x W, and
achieves overall performance by capturing the trade-off of
recall and precision. These measures are valued between 0 and
1, and larger value is better.

In all scenarios in Table 1, PedigreeCaller outperforms other
methods in recall and F -measure. For the datasets with read
coverage of 10x and read length of 100 bp, PolyMutt outper-
forms other methods including PedigreeCaller in precision. Also,
for the datasets with read coverage of 5x and read length of 100
and 500 bp, GATK outperforms other methods including
PedigreeCaller in precision. However, recalls of GATK in these
conditions are low and hence its F -measures are worse than those
of other methods. In the datasets, except for the conditions with
5x and 100 and 500 bp, precisions of PedigreeCaller are higher
than those of other methods.

To see the effect of read length to PedigreeCaller, we focus on
the difference on the performance between PedigreeCaller and
PolyMutt. For dataset with read coverage of 10x and read
length of 100 bp, the number of TPs on PedigreeCaller is 616
more than that on PolyMutt, but the number of FPs on
PedigreeCaller is 46 more than that on PolyMutt. On the other
hand, for dataset with read coverage of 10x and read length of
500 bp, the number of TPs on PedigreeCaller is 617 more than
that on PolyMutt and the number of F Ps on PedigreeCaller is 27
less than that on PolyMutt. In addition, in the dataset with read
length of 1000 bp, the number of TPs on PedigreeCaller is 615
more than that on PolyMutt and the number of FPs on
PedigreeCaller is 65 less than that on PolyMutt.

Table 2 summarizes the performance of genotype concordance
on our proposed approach and four existing methods for the
sequencing data with read coverages of 5 and 10x. Results for
20 and 40x are summarized in Section 2 of the Supplementary
Material. In genotype concordance, if a genotype estimated at a
position and true genotype at the position are the same and not
homozygous for the reference allele, the estimated genotype is
counted as TP. On the other hand, if the genotype of the esti-
mated variant is different from the true genotype, the estimated
variant is counted as FP. Note that the recall and precision for
genotype concordance are respectively the same as sensitivity and
PPV used for evaluation of variant callers in You et al. (2012).
Also, note that the number of trues is not equal to the sum of the
number of TPs and the number of false negatives (FNs) because
some trues can be in FPs.

Similar to variant detection, all the conditions in Table 2,
PedigreeCaller outperforms other methods in recall and
F -measure.

 

3.2 Real data analysis

To evaluate performance on real sequencing data, we use 100-bp
paired-end sequencing data of HapMap CEU parent—offspring
trio comprising NA12878 (child), NA12891 (father) and
NA12892 (mother) (Conrad et al., 2011). The data were
sequenced with Illumina HiSeq 2000 with read coverage of
45x for each individual, and stored as BAM ﬁles after mapping
to UCSC hg19 with Burrows—Wheeler Aligner (Li and Durbin,
2009). The average insert size is ~300 bp.

We downsampled the sequencing datasets to 5, 10, 20 and 40x
for each individual with Picard DownsampleSam. These down-
sampled BAM ﬁles were realigned with GATK Indel Realigner,
and base quality scores are recalibrated with GATK Base
Quality Score Recalibration. We evaluate the performance by
assessing the concordance of estimated variants from these vari-
ant callers for datasets with various read coverages with SNP
array genotyping results from Illumina OMNI 2.5 BeadChip.
The number of SNP sites considered is 2310 349, and the
number of variants for these three individuals is 2122147.

We also assessed the concordance with the 1000 Genomes
Project and commonly estimated variants by the ﬁve callers for
the dataset of 40x. Results for those cases are given in the
Supplementary Material.

Table 3 summarizes the performance of variant detection on
PedigreeCaller and four existing methods for NA12878,
NA12 891 and NA12 892 from the real datasets with read cover-
ages of 5, 10, 20 and 40x.

PedigreeCaller outperforms other four variant callers in
F -measure for all the read coverages. Also, PedigreeCaller
achieves the best performance on the number of TPs and recall
rate except for the dataset of 40x. Although Uniﬁed Genotyper
produces better recall rate than that of PedigreeCaller in the 40x
data, the result of Uniﬁed Genotyper contains four times as many
FPs than PedigreeCaller, and hence its F -measure is worse than
that of PedigreeCaller. Although recall of SAMtools is low for all
the datasets, the results of SAMtools contain the least FPs for all
the datasets. In precision, SAMtools outperforms other variant
callers including PedigreeCaller except for the datasets with read
coverages of 5, 10, 20x, and gives the same performance as
PedigreeCaller for the dataset with read coverage of 40x. The
performance gaps between PedigreeCaller and other variant call-
ers are larger in lower coverage data, e. g. the maximum gap on
F-measure in the 40x data is 0.0025, whereas that in the 5 x is
>0.1. Because read data is insufﬁcient for accurate variant calling
in low coverage data such as the 5 x data, the effects from pedigree
information and haplotyping are high, and the larger performance
gaps can be obtained in lower coverage data. This is also observed
in the results between TrioCaller and SAMtools. The results of
TrioCaller contain more TPs and less F Ps than those of SAMtools
in the 5 and 10x data, whereas SAMtools achieves better per-
formance in the numbers of TPs and FPs than TrioCaller in the
20x data.

Table 4 summarizes the performance of genotype concordance
on PedigreeCaller and four existing methods for NA12878,
NA12891 and NA12892: the numbers of TPs, F Ps, true negatives
(TNs), FNs, accuracy, recall, precision and F -measure for the
sequencing data with read coverages of 5, 10, 20 and 40x.

- - # of TPs+# of TNs
Accuracy 13 glven by # of TPs + # of FPs + # of TNs + # of FNs'

 

 

2840

112 ﬁre‘slcumo[pJOJXO'sor112u1101urorq/ﬁd11q 111011 pepcolumoq

910K ‘09 lsnﬁnV uo 22

Variant caller with pedigree information and local haplotyping

 

Table 2. Comparisonon genotype concordance of PedigreeCaller, PolyMutt, TrioCaller, SAMtools, and GATK Uniﬁed Genotyper for simulation
datasets with read coverages of 5 and 10x and read length 100, 500, and 1000 bp

 

 

 

 

 

 

 

 

 

 

 

 

 

Read coverage Read length (bp) Method Number of TPs Number of FPs Recall Precision F-measure
PedigreeCaller 132 465 E 0.8834 0.9609 0.9205
PolyMutt 131 606 5558 0.8777 0.9595 0.9168
100 TrioCaller 128 073 8165 0.8541 0.9401 0.8950
GATK 98 791 5737 0.6588 0.9451 0.7764
SAMtools 112 068 8795 0.7474 0.9272 0.8277
PedigreeCaller 133 741 & 0.8919 0.9653 0.9272
PolyMutt 132 892 5395 0.8863 0.9610 0.9221
5 x 500 TrioCaller 129 307 8278 0.8624 0.9398 0.8994
GATK 99 054 5664 0.6606 0.9459 0.7779
SAMtools 114 023 8783 0.7604 0.9285 0.8361
PedigreeCaller 133 456 @ 0.8900 0.9671 0.9270
PolyMutt 133 068 5344 0.8874 0.9614 0.9229
1000 TrioCaller 129 140 8247 0.8612 0.9400 0.8989
GATK 99 135 5587 0.6611 0.9466 0.7785
SAMtools 114225 8840 0.7618 0.9282 0.8368
10x PedigreeCaller 146 103 926 0.9744 0.9937 0.9839
PolyMutt 145 479 w 0.9702 0.9940 0.9820
100 TrioCaller 144 059 2100 0.9607 0.9856 0.9730
GATK 137114 1271 0.9144 0.9908 0.9511
SAMtools 140 439 1275 0.9366 0.9910 0.9630
PedigreeCaller 146 746 E 0.9787 0.9957 0.9871
PolyMutt 146 038 759 0.9739 0.9948 0.9843
500 TrioCaller 144 523 2152 0.9638 0.9853 0.9745
GATK 137283 1191 0.9155 0.9914 0.9520
SAMtools 141 510 1238 0.9437 0.9913 0.9669
PedigreeCaller 146 971 E 0.9802 0.9965 0.9883
PolyMutt 146 215 717 0.9751 0.9951 0.9850
1000 TrioCaller 144 984 1778 0.9669 0.9879 0.9773
GATK 137852 1111 0.9193 0.9920 0.9543
SAMtools 142 086 1141 0.9476 0.9920 0.9693

 

Note: The best result on each condition is underlined.

Similar to the case of variant detection, PedigreeCaller outper-
forms these three variant callers in accuracy and F -measure on
genotype concordance for all the coverages. The performance gaps
between PedigreeCaller and other variant callers are larger in
lower coverage data, e. g. the maximum gaps on F -measure and
accuracy for the datasets of 40x are 0.002 and 0.001, respectively,
whereas gaps on F -measure and accuracy for the dataset of 5 x are
>01 and 0.05, respectively. Because read data is insufﬁcient for
accurate variant calling in low coverage data such as the 5x data,
the effects from pedigree information and haplotyping are high,
and the larger performance gaps can be obtained in lower cover-
age data. This is also observed in the results between TrioCaller
and SAMtools. The results of TrioCaller contain more TPs and
less FPs than those of SAMtools in the 5 and 10x data, whereas
SAMtools achieves better performance in the numbers of TPs and
FPs than TrioCaller in the 20x data.

Figure 2 shows relationship between the physical distance of
variants and the performance gap of PedigreeCaller and other
existing variant callers in the 5x data. The x-axis indicates the

distance between positions in base pairs. The y-axis indicates the
F -measure difference given by the F -measure of PedigreeCaller
subtracted by that of other variant caller for the SNP positions
from which there exists a position with heterozygous genotype
call within a distance indicated by the x-axis. Here, we restrict the
position with heterozygous genotype call to the position where
at least two heterozygous genotypes are estimated by
PedigreeCaller among the trio members. As shown in Figure 2,
PedigreeCaller shows the strong performance for the SNP pos-
itions distant from other variants within 100 bp. Because the read
length in our data is 100 bp, this result implies that phase-inform-
ative reads effectively work for haplotyping and consequently
improve the performance of variant calling. Also, we can observe
a slow decline of the performance gap for the SNPs >100 bp
away from other variants. PedigreeCaller uses paired-end reads
for phase-informative reads as well, and less paired-end reads are
available as phase-informative reads for more distant positions.
Therefore, this slow decline of the performance gap is due to the
decrease of the haplotyping effect by paired-end reads.

 

2841

112 ﬁre‘slcumo[pJOJXO'sor112u1101urorq/ﬁd11q 111011 pepcolumoq

910K ‘09 lsnﬁnV uo 22

K.Kojima et al.

 

Table 3. Comparison on variant detection performance of PedigreeCaller, PolyMutt, TrioCaller, SAMtools, and GATK based on SNP array

genotyping results for real datasets

 

 

 

 

 

 

 

 

 

Read coverage Method Number of TPs Number of FPs Recall Precision F-measure
PedigreeCaller 1867 118 8247 0.8798 0.9956 0.9341
PolyMutt 1818 625 11437 0.8570 0.9938 0.9203
5 X TrioCaller 1788 512 21 692 0.8428 0.98 80 0.9096
GATK 1524138 3021 0.7182 0.9980 0.8353
SAMtools 1516 241 w 0.7145 0.9990 0.8331
PedigreeCaller 2014 055 4259 0.9491 0.9979 0.9729
PolyMutt 1987 388 4365 0.9365 0.9978 0.9662
10x TrioCaller 1975 516 7627 0.9309 0.9962 0.9624
GATK 1900 812 6024 0.8957 0.9968 0.9436
SAMtools 1875413 m 0.8837 0.9988 0.9377
PedigreeCaller 2043 875 3373 0.9631 0.9984 0.9804
PolyMutt 2036 495 3899 0.9596 0.9981 0.9785
20 x TrioCaller 2031 028 4593 0.9571 0.9977 0.9770
GATK 2039 673 9859 0.9611 0.9952 0.9779
SAMtools 2014 731 M 0.9494 0.9986 0.9734
PedigreeCaller 2045 752 3035 0.9640 0.9985 0.9810
PolyMutt 2045 021 3390 0.9637 0.9983 0.9807
40X TrioCaller 2038 818 4205 0.9607 0.9979 0.9790
GATK 2052441 14153 0.9672 0.9932 0.9800
SAMtools 2035 897 m 0.9594 0.9985 0.9785

 

Note: The best result on each condition is underlined.

Table 4. Comparison on genotype concordance of PedigreeCaller, PolyMutt, TrioCaller, SAMtools and GATK based on SNP array genotyping results

for real datasets

 

 

 

 

 

 

 

Read Method Number Number Number Number Recall Precision F-measure Accuracy
coverage of TPs of FPs of TNs of FNs
PedigreeCaller 1 795 123 80 242 4 800 654 255 029    
PolyMutt 1 747 830 82 232 4 797 464 303 522 0.824 0.955 0.884 0.944
5X TrioCaller 1 683 205 126 999 4 787 209 333 635 0.793 0.930 0.856 0.934
GATK 1 440 989 86 170 4 805 880 598 009 0.679 0.944 0.790 0.901
SAMtools 1 428 057 89 651 4 807 434 605 906 0.673 0.941 0.785 0.900
PedigreeCaller 2 001 903 16 41 1 4 804 642 108 092    
PolyMutt 1 976 330 15 423 4 804 536 134 759 0.931 0.992 0.961 0.978
10x TrioCaller 1 953 026 30 117 4 801 274 146 631 0.920 0.985 0.951 0.974
GATK 1 884 099 22 737 4 802 877 221 335 0.888 0.988 0.935 0.965
SAMtools 1 859 807 17 894 4 806 613 246 734 0.876 0.990 0.930 0.962
PedigreeCaller 2 040 441 6807 4 805 528 78 272    
PolyMutt 2 033 754 6640 4 805 002 85 652 0.958 0.997 0.977 0.987
20X TrioCaller 2 022 855 12 766 4 804 308 91 119 0.953 0.994 0.973 0.985
GATK 2035 619 13 913 4799042 82 474 0.959 0.993 0.976 0.986
SAMtools 2 012 134 ﬂ 4 806 022 107 416 0.948 0.997 0.972 0.984
PedigreeCaller 2 043 075 5712 4 805 866 76 395 0.963 0.997  
PolyMutt 2 042 700 5711 4 805 511 77 126 0.963 0.997 0.980 0.988
40X TrioCaller 2 031 073 11 950 4 804 696 83 329 0.957 0.994 0.975 0.986
GATK 2 049 088 17 506 4 794 748 69 706  0.992 0.978 0.987
SAMtools 2 033 955 w 4 805 893 86 250 0.958 0.998 0.978 0.987

 

Note: The best result on each condition is underlined.

 

2842

112 ﬁre‘slcumo[pJOJXO'sor112u1101urorq/ﬁd11q 111011 pepcolumoq

910K ‘09 lsnﬁnV uo 22

Variant caller with pedigree information and local haplotyping

 

 

 

 

 

 

8 _

o ------ -- PedigreeCaller — PolyMutt
- -- - PedigreeCaller — TrioCaller
— PedigreeCaller — SAMtools
------ -- PedigreeCaller — GATK

:9 _

o'

 

F—measure difference
0 10
I

0.05
|

~.

 

 

0.00
|

 

O 1 00 200 300 400 500
Distance from other variants (bp)

Fig. 2. A plot representing performance gaps between PedigreeCaller and
other existing variant callers with respect to distance between target SNP
positions and other closest variants in the 5x data. The x-axis indicates
distance in base pairs between target SNP positions and other variants.
The y-axis indicates the performance gap between PedigreeCaller and
other variant callers in F-measure

4 DISCUSSION AND CONCLUSION

We proposed a new statistical variant calling approach that con-
siders pedigree information and haplotyping based on phase-
informative reads. In a naive way, modeling of haplotyping
based on phase-informative reads may fail to estimate accurate
results owing to undesirable inﬂuence from homozygous positions
in the estimation of the assignment of each read to a haplotype. To
address this issue, we introduced latent variables that determine
zygosity, and avoided the undesirable inﬂuence from homozygous
positions by using the estimated zygosity in the latent variables.

Through variant calling in the practical NGS data and the com-
parison of the estimated variants with the SNP array genotyping
results, we showed that our approach outperforms existing variant
callers, including variant callers that consider pedigree informa-
tion. Also, the analysis of the performance on the positions located
close to other heterozygous variants showed that our approach is
more powerful in such positions than other variant callers, espe-
cially for SNPs distant from other variants within 100 bp. Because
read length in the data used for the evaluation is 100 bp, the result
of the analysis implies that haplotyping based on phase-inform-
ative reads with these variants effectively works for the improve-
ment of the performance in our approach. We also observed the
performance improvement by the effect of haplotyping based on
paired-end reads through the slow decline of the performance gap
between our approach and other variant callers on the SNP pos-
itions distant >100 bp from other variant positions.

Owing to the rapid progress of NGS technologies, read length
is extending in the current sequencing platforms. In addition,
systematically new technologies such as the Nanopore technol-
ogy (http://www.nanoporetech.com/) and the Moleculo technol-
ogy (http://www.moleculo.com/) are now under development,
and these technologies are considered to enable the production

of more accurate and longer sequencing data. Therefore, further
accurate variant calling is expected in our approach by using
longer reads available in the near future.

ACKNOWLEDGEMENTS

The authors thank the anonymous referees for their constructive
suggestions and comments, which improved the quality of this
paper. Illumina HiSeq 2000 sequencing data and OMNI 2.5 SNP
array genotyping results for the CEU parent-offspring trio were
kindly provided by Illumina, Inc. The super-computing resource
was provided by Human Genome Center, Institute of Medical
Science, University of Tokyo.

Funding: This work was supported (in part) by MEXT Tohoku
Medical Megabank Project.

Conflict of Interest: none declared.

REFERENCES

Cartwright,R.A. et al. (2012) A family-based probabilistic method for capturing de
novo mutations from high-throughput short-read sequencing data. Stat. Appl
Genet. Mol Biol, 11.

Chen,W. et al. (2013) Genotype calling and haplotyping in parent-offspring trios.
Genome Res., 23, 142—151.

Collins,A. et al. (1996) A metric map of humans: 23,500 loci in 850 bands. Proc.
Natl Acad. Sci. USA, 93, 14771—14775.

Conrad,D.F. et al. (2011) Variation in genome-wide mutation rates within and
between human families. Nat Genet, 43, 712—714.

Danecek,P. et al. (2011) The variant call format and VCFtools. Bioinformatics, 27,
2156—2158.

DePristo,M.A. et al. (2011) A framework for variation discovery and genotyping
using next-generation DNA sequencing data. Nat Genet, 43, 491—498.

He,D. et al. (2012) Hap-seq: an optimal algorithm for haplotype phasing with
imputation using sequencing data. Lect. Notes Comput Sci., 7262, 64—78.
Li,H. (2011) Improving SNP discovery by base alignment quality. Bioinformatics,

27, 1157—1158.

Li,B. et al. (2012) A likelihood-based framework for variant calling and de novo
mutation detection in families. PLoS Genet, 8, 61002944.

Li,H. (2013) Aligning sequence reads, clone sequences and assembly contigs with
BWA-MEM. arXiv:1303.3997.

Li,H. and Durbin,R. (2009) Fast and accurate short-read alignment with Burrows-
Wheeler Transform. Bioinformatics, 25, 1754—1760.

Li,H. et al. (2009) The sequence alignment/map format and SAMtools.
Bioinformatics, 25, 2078—2079.

Li,R. et al. (2009) SNP detection for massively parallel whole-genome resequencing.
Genome Res., 19, 1124—1132.

McKenna,A. et al. (2010) The genome analysis toolkit: a MapReduce framework for
analyzing next-generation DNA sequencing data. Genome Res, 20, 1297—1303.

Menelaou,A. and Marchini,]. (2013) Genotype calling and phasing using next-
generation sequencing reads and a haplotype scaffold. Bioinformatics, 29, 84—91.

Murphy,K.P. et al. (1999) Loopy belief propagation for approximate inference: an
empirical study. In: Proceedings of the 15th Conference on Uncertainty in
Artiﬁcial Intelligence. Stockholm, Sweden, pp. 467—475.

Quail,M.A. et al. (2012) A tale of three next generation sequencing platforms: com-
parison of Ion Torrent, Paciﬁc Biosciences and Illumina MiSeq sequencers.
BMC Genomics, 13, 341.

Treangen,T.J. and Salzberg,S.L. (2012) Repetitive DNA and next-generation sequen-
cing: computational challenges and solutions. Nat Rev. Genet, 13, 36—46.

Weiss,Y. and Freeman,W.T. (2001) On the optimality of solutions of the max-prod-
uct belief-propagation algorithm in arbitrary graphs. IEEE Trans. Inf. Theory,
47, 736—744.

Yedidia,J.S. et al. (2005) Constructing free-energy approximations and generalized
belief propagation algorithms. IEEE Trans. Inf. Theory, 51, 2282—2312.

You,N. et al. (2012) SNP calling using genotype model selection on high-through-
put sequencing data. Bioinformatics, 28, 643—650.

 

2843

112 /810'S112umo[pJOJXO'sor112u1101urorq/ﬁd11q 111011 pepcolumoq

910K ‘09 lsnﬁnV uo 22

