ORIGINAL PAPER

Vol. 30 no. 18 2014, pages 2584—2591
doi:10. 1093/bioinformatics/btu337

 

Structural bioinformatics

Advance Access publication May 14, 2014

Memory-efficient RNA energy landscape exploration

Martin Mann”, Marcel Kuchan’k2, Christoph Flamm2 and Michael T. Wolfinger

2,3,4

1Bioinformatics Group, Department of Computer Science, University of Freiburg, 79110 Freiburg, Germany, 2Institute for
Theoretical Chemistry, University of Vienna, 1090 Vienna, 3Center for Integrative Bioinformatics Vienna, Max F. Perutz
Laboratories, University of Vienna, Medical University of Vienna, and 4Department of Biochemistry and Molecular Cell

Biology, Max F. Perutz Laboratories, University of Vienna, A—1030 Vienna, Austria

Associate Editor: Anna Tramontano

 

ABSTRACT

Motivation: Energy landscapes provide a valuable means for studying
the folding dynamics of short RNA molecules in detail by modeling all
possible structures and their transitions. Higher abstraction levels
based on a macro-state decomposition of the landscape enable the
study of larger systems; however, they are still restricted by huge
memory requirements of exact approaches.

Results: We present a highly parallelizable local enumeration scheme
that enables the computation of exact macro-state transition models
with highly reduced memory requirements. The approach is evaluated
on RNA secondary structure landscapes using a gradient basin def-
inition for macro-states. Furthermore, we demonstrate the need for
exact transition models by comparing two barrier-based approaches,
and perform a detailed investigation of gradient basins in RNA energy
landscapes.

Availability and implementation: Source code is part of the C++
Energy Landscape Library available at http://www.bioinf.uni-freiburg.
de/Softwarel.

Contact: mmann@informatik.uni-freiburg.de

Supplementary information: Supplementary data are available at
Bioinformatics online.

Received on March 31, 2014; revised on April 25, 2014; accepted on
May 8, 2014

1 INTRODUCTION

The driving force of disordered systems in physics, chemistry and
biology is characterized by coupling and competing interaction
of microscopic components. At a qualitative level, this is
reﬂected by the potential energy function and often results in
complex topological properties induced by individual con-
formational degrees of freedom. It seems fair to say that it is
practically impossible to compute dynamic and thermodynamic
properties directly from the Hamiltonian of such a complex
system. However, analyzing the underlying energy landscape
and its features directly provides a valuable alternative.

Here, we focus on RNA molecules and their folding kinetics.
RNAs are key players in cells acting as regulators, messengers,
enzymes and many more roles. In many cases, a speciﬁc structure
is crucial for biological speciﬁcity and functionality. The forma-
tion of these functional structures, i.e. the folding process, can be

 

*To whom correspondence should be addressed.

studied at the level of RNA energy landscapes (F lamm and
Hofacker, 2008; Geis et al., 2008).

RNA is composed of the biophysical alphabet {A,C,G,U}
and has the ability to fold back onto itself by formation of dis-
crete base pairs, thus forming secondary structures. The latter
provide a natural coarse-graining for the description of the
thermodynamic and kinetic properties of RNA because, in con-
trast to proteins, the secondary structure of RNA captures most
of the folding free energy. This is accommodated by novel
approaches for predicting 3D RNA structures from secondary
structures (Popenda et al., 2012).

Formally, an RNA secondary structure is deﬁned as a set of
base pairs between the nuclear bases complying with the rules: (i)
only A—U, G—C and G—U pairings are allowed, (ii) any base is
involved in maximal one base pair and (iii) the structure is
nested, i.e. there are no two base pairs with indices (1', j), (k,l)
with i < k< j < l. Summation over the individual base pair bind-
ing energies and entropic contributions for unpaired bases de-
ﬁnes the energy function E (Freier et al., 1986; Hofacker et al.,
1994; Tinoco et al., 1971). The degeneracy of this energy deﬁn-
ition is countered via a structure ordering based on their string
encoding (F lamm et al., 2002). We refer to the literature (Chen,
2008; Flamm and Hofacker, 2008) for more details.

In this work, we study the folding kinetics of RNA molecules
by means of a discrete energy landscape approach. While sto-
chastic folding simulations based on solving the Master equation
are limited to relatively short sequence lengths (Aviram et al.,
2012; Flamm et al., 2000b), a common approach to studying
biopolymer folding dynamics is using a coarse-grained model
that partitions the energy landscape into distinct basins of attrac-
tion, thus assigning macro-states to each basin WV olf1nger et al.,
2004). The basin decomposition and computation has been
described in different contexts, including potential energy
landscapes (Heuer, 2008), RNA kinetics (F lamm and
Hofacker, 2008) and lattice protein folding (Tang and Zhou,
2012; Wolﬁnger et al., 2006). Given appropriate transition
rates between macro-states (optionally composed of rates
among micro-states that form a macro-state), the dynamics can
be modeled as continuous-time Markov process and solved dir-
ectly by numerical integration (Wolflnger et al., 2004).
While suitable for system sizes up to ~10 000 states, improve-
ments to this approach are currently subject to our research,
allowing investigation of up to a few hundred thousand
states by incorporating sparsity information and additional
approximations.

 

© The Author 2014. Published by Oxford University Press.

This is an Open Access article distributed under the terms of the Creative Commons Attribution License (http://creativecommons.org/licenses/by/3.0/), which
permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.

112 ﬁle'slcumo[pJOJXO'sopchogutotq/ﬁd11q IIIOJJ popcolumoq

910K ‘09 lsnﬁnV no :2

Memory-efﬁcient RNA energy landscape exploration

 

The crucial step in the procedure sketched above is to obtain
the transition rates between macro-states. Global methods for
complete (F lamm et al., 2002) or partial (Kubota and Hagiya,
2005; Sibani et al., 1999; Wolﬁnger et al., 2006) enumeration of
the energy landscape are not applicable to large systems because
of memory restrictions. On the other side, sampling with high
precision requires long sampling times (Mann and Klemm,
2011). Therefore, approximating the energy landscape by a
subset of important local minima, gained via sampling
approaches or spectroscopic methods (Aleman et al., 2008;
Fiirtig et al., 2007; Rinnenthal et al., 2011), and transition
paths between them (Noé and Fischer, 2008) has been investi-
gated in the past (Kucharik et al., 2014; Tang et al., 2005, 2008).

We propose a novel, highly parallelizable and memory-
efﬁcient local enumeration approach for computing exact tran-
sition probabilities. While the method is intrinsically generic and
can be readily applied to other discrete systems, we exemplify the
concept in the context of energy landscapes of RNA secondary
structures, based on the Turner energy model OCia et al., 1998),
as implemented in the Vienna RNA Package (Hofacker et al.,
1994; Lorenz et al., 2011) and the Energy Landscape Library
(ELL; Mann et al., 2007). We evaluate the memory efﬁciency
and dynamics quality for different RNA molecules and report
features of gradient basin macro-states in RNA energy
landscapes.

2 DISCRETE ENERGY LANDSCAPES

In the following, we will deﬁne energy landscapes for two levels
of abstraction: the microscopic level covers all possible (micro-)
states of a system and its dynamics, whereas the macroscopic level
enables a more coarse-grained model of the system’s dynamics,
based on a partitioning of all micro-states into macro-states. The
macroscopic view is required when studying the dynamics of
larger systems.

2.1 Microscopic level

Discrete energy landscapes are deﬁned by a triple (X, E, M)
given a ﬁnite set of (micro-)states X, an appropriate energy
function E: X —> IR, and a symmetric neighborhood relation
M : X —> 73(X) (also known as move set), where 73(X) is the
power set of X. The neighborhood M(x) is the set of all neigh-
boring states that can be directly reached from state x by a simple
move set operation.

Consequently, RNA energy (folding) landscapes can be
deﬁned at the level of secondary structures, which represent the
micro-states x e X. An RNA structure y is neighbored to a struc-
ture x (y e M(x)), if they differ in one base pair only. Although
alternative move set deﬁnitions are possible (Flamm et al.,
2000b), they are not considered in this work for simplicity.

Within this work, we consider time-discrete stochastic dy-
namics based on Metropolis transition probabilities P at inverse
temperature ,6:

12Hy = A‘lmin{exp(-ﬁ[E(V) — E(x)]), 1}

_1 _ (1)
=A m1n{w(y)/w(x),l}

with w(x) = exp(—,BE(x)) (2)

and A: max |M(x)|. (3)
xeX

w(x) is the Boltzmann weight of x. Normalization is performed
via the constant A, which is the maximally possible number of
neighbors/transitions of any state. The transition probability
px_)y is only deﬁned for neighboring states, i.e. y e M (x).

2.2 Macroscopic level

Although desirable, studying dynamic properties at the micro-
scopic level is often not feasible because of the vastness of the
state space X, even for relatively small systems. An alternative
approach is coarse graining, i.e. lumping many micro-states into
fewer macro-states, such that the microscopic dynamics is
resembled as closely as possible Molﬁnger et al., 2004).

This can be achieved by partitioning of the state space X with a
mapping function F: X —> B that uniquely assigns any micro-
state in X to a macro-state in B. With F‘1(b) we denote the
inverse function that gives the set of all F—assigned states for a
macro-state b e B. Following (Flamm and Hofacker, 2008;
Kramers, 1940; Mann and Klemm, 2011; Wolﬁnger et al.,
2004), we will use the simplifying assumption that the probability
of the system to be in micro-state x while it is in macro-state
b e B is given by

—1 - 1
Pb(x) = I w(x)Zb 1f x e F‘- (b) (4)
0 otherw1se
with z, = Z w(y). (5)
yeFWb)

Based on this, we can deﬁne the macroscopic transition prob-
abilities qb_,c between macro-states b, c e B by means of the
microscopic probabilities P from Equation (1) as follows:

qb—>c = Z Pb(x) Z px—>y
xeF—1(b) yeM(x)ﬂF—1(c)

= ZPb(x)px—>y

(my)

2 E %:0 A‘1min{w0/)/W(x)’ 1}

(my)

= 2,71 2 ATImin{w(y), w(x)} = 2,;1 2%,} and thus (6)
(My)

ge—>b = Zc—IZ{b,c}- 

Equation (6) considers all microscopic transitions x —> y from
a micro-state x in b to a micro-state y in c, based on the prob-
ability of x (Pb(x)) and the transition probability pxny. The en-
ergetically higher micro-state of each such transition contributes
to the partition function of all transition states between b and c,
Z{b,c} [Equations (6 and 7)]. Consequently, Z{b,c} E Z{c,b}, i.e. the
transition state partition function is direction-independent.

Within this work, we use the common gradient basin parti-
tioning of X following (Doye, 2002; Flamm et al., 2002; Flamm

 

2585

112 [3.10811211an[plOJXO'SODBIIIJOJIIIOIQ/[idllq IIIOJJ pepeolumoq

910K ‘09 isnﬁnV no :2

M.Mann et al.

 

and Hofacker, 2008; Mann and Klemm, 2011). A gradient basin
is deﬁned as the set of all states who have a steepest descent
(gradient) walk ending in the same local minimum, where )5 is
a local minimum if VyeMm : E(x)<E(y). In this context, the set
of macro-states B is given by the set of all local minima of the
landscape, whose number is drastically smaller than that of all
micro-states (Lorenz and Clote, 2011). The mapping function
F(x) applies a gradient walk starting in x, thus assigning it a
local minimum x and a macro-state b. Here, the minimum is
used as a representative for the macro-state composed of the
gradient basin.

A coarse abstraction of the macro-state transition probabilities
can be obtained by an Arrhenius-like transition model
Molﬁnger et al., 2004). Here, the transition probability is domi-
nated by the minimal energy barrier that needs to be traversed to
go from one state to another. Formally, given two states x and y,
one has to identify the path p=(x1, ...,x1) e X’, l >1 with
x1 =x, x1 = y and Vi<l : xi+1 e M(x,-), with lowest energy max-
imum. Arrhenius barrier-based transition probabilities are thus
deﬁned by

amy = A exp(—ﬁ(E(x, y) — E(x))) with (8)
E(x, y) = 332 gliggwm» (9)

where A is an intrinsically unknown pre-exponential factor. For
macro-state transitions based on a gradient basin partitioning,
transition probabilities can be approximated by Arrhenius prob-
abilities among local minima of macro-states. In this context, it is
important to note that this transition model does not enforce
neighborhood of the macro-states. The impact on modeling
quality of such an Arrhenius-based model is evaluated in
Section 4. We will now present approaches for the exact deter-
mination of the macro-state transition probabilities for a given
landscape and partitioning.

3 MACRO-STATE TRANSITION PROBABILITIES

Following the rationale presented above, all macroscopic transi-
tion rates need to be determined to study the coarse-grained dy-
namics. Given Equation (6), the partition function Z, [Equation
(5)] and adjunct partition functions of transition states Z{b,c} to
adjacent c 75 b have to be computed for each macro-state b.

A direct approach is brute-force enumeration of X, computing
F(x) for each micro-state x e X and updating Z Fm accordingly.
Subsequently, all neighbors y e M(x) are enumerated to update
Z{F(x),p(y)} if F(x) 75 F02). Although this is the simplest and most
general approach, it is not efﬁcient for the majority of deﬁnitions
of F. It can, however, be replaced with more efﬁcient dedicated
ﬂooding algorithms and can be even more tuned for gradient
basin deﬁnitions of F as we will discuss now.

3.1 Standard approach via global ﬂooding

The lid method (Sch6n and Sibani, 1998; Sibani et al., 1999)
performs a ‘spreading’ enumeration starting from a local min-
imum with an upper energy bound for micro-states to consider,
the lid. Internally, two lists are hashed: the set D containing all
micro-states that have been processed so far and the ‘to-do-list’ T

composed of states neighbored to D but not handled yet.
Each processed micro-state x is assigned to its corresponding
macro-state b =F(x) during the enumeration process. b is
stored along with x in D and T, and the partition function Zb
is updated by w(x) accordingly. Subsequently, all neighbors y e
M (x) of x with E(y)< lid-threshold are enumerated and either
found in D or T (thus saving F(x) computation) or added to T. If
the macro-state assignment for x and y differs, i.e. F(x) 75 F02),
the corresponding transition state partition function Z{F(x),p(y)} is
increased by A“min(w(x), w(y)). The method was reformulated
by Kubota and Hagiya (2005) for DNA energy landscapes and
Wolﬁnger et al. (2006) in the context of lattice proteins.

The barriers approach by Flamm et al. (2002) performs a
‘bottom—up’ evaluation of energy landscape topology based on
an energy-sorted list of all micro-states in X above the ground
state up to a predeﬁned energy threshold. Here, the macro-state
assignment F can be handled more efﬁciently compared with the
lid-method, if gradient basins are applied: given that the stee-
pest descent walk used for a gradient mapping F is recursive, i.e.
the assignment F(x) of a state x is known as soon as the assign-
ment F(mmin) of its steepest descent neighbor mmin e M (x) is
known, the macro-state assignment is accomplished by a single
hash lookup: because the processed set of states D already con-
tains all states with energy less than E(x), looking up mmin and its
corresponding macro-state F(mmin) in D yields F(x) E F(mmin).
The energy of the micro-state currently processed marks the
‘ﬂood level’, i.e. all states in X with energy below have been
processed. Consequently, the macro-state partition functions
Z, are collected as soon as the ﬂood level reaches the according
local minimum deﬁning b.

Both methods perform a massive hashing of processed states
and are thus restricted by memory, i.e. the number of micro-
states that can be stored in D and T is constrained to the avail-
able memory resources. Considering the exponential growth, e. g.
of the RNA structure space X (Hofacker et al., 1998), the
memory is easily exhausted for relatively short sequence lengths.
As the memory limit is approached, both methods result in in-
complete macro-state transition data.

The barriers approach ensures a ‘global picture’ of the
landscape because it covers the lower parts of all macro-states
up to the reached ﬂood level exhaustively, missing all macro-
states above the limit. In case the transition states connecting
the macro-states are above the ﬂood level, no transition infor-
mation is available. This can be approached by heuristics
approximating the transition barrier (Bogomolov et al., 2010;
Flamm et al., 2000a; Morgan and Higgs, 1998; Richter et al.,
2008; Wolﬁnger et al., 2004); however, the outcome is still not
reﬂecting the true targeted macro-state dynamics. In contrast,
the lid method will always result in connected macro-states
but only a restricted part of the landscape is covered.
Furthermore, each macro-state is enumerated up to different
(energy) heights resulting in varying quality of the collected par-
tition function estimates, which further distorts the dynamics.

3.2 Memory-efﬁcient local ﬂooding

To overcome the memory limitation of global ﬂooding
approaches, we introduce a local ﬂooding scheme. It enables
parallel identiﬁcation of the partition function Zb and all

 

2586

112 ﬁlm'sleumo[pJOJXO'sot1emJOJutotw/2d11q IIIOJJ pepeolumoq

910K ‘09 isnﬁnV no 22

Memory-efﬁcient RNA energy landscape exploration

 

transition state partitions Z{b,c} for a macro-state b without the
need of full landscape enumeration.

Similar to global ﬂooding, the local approach uses a set D of
already processed micro-states that are part of b, i.e.
Vxel) : F(x) =b, and a set T of micro-states that might be part
of b or adjacent to it.

The algorithm starts in the local minimum le X of b, i.e.
F(l) = b and VX¢IEF—l(b) : E(x)>E(l), and does a local enumer-
ation of micro-states in increasing energy order starting from
b. Thus, Zb is initialized with Zb = w(l), all neighbors m e M(l)
of the minimum are pushed to T, and l is added to D.
Afterwards, the following procedure is applied until T is empty.

1. Get energy minimal micro-state x from T with
Vxx¢xeT : E(x)<E(x’)

2. Identify steepest descent neighbor mmin e M (x) with
quémmjneMbc) 3 E(mmin) < E(m)

3. If mmin E D —> F(x)=b:

o x is added to D,

O 21, = Zb + W(X),

o All neighbors m e M (x) with E(m) > E(x) are added to
T, and

o Descending transitions leaving b are handled:

x is transition state for all m e M (x) with E(m) < E(x) and
m e D:

Z1b.F(m)} = Z1b.F(m)} + 4“ w(x)

else —> F(x) 75 b:

o Descending transitions entering b are handled:

x is transition state for all m e M (x) with E(m) < E(x) and
m e D:

Z{F(x),b} = Z{F(x),b} + A“ w(x)

We use a data structure for T that is automatically sorted by
increasing energy to boost performance of Step 1.

The algorithm computes Z, and Z{b,c}, which are required for
deriving the macro-state transition rates qb_,c [Equation (6)]
from one macro-state b to adjacent macro-states c 75 b. It is in-
dividually applied to all macro-states to get the full transition
rate information of the energy landscape. Evidently, the transi-
tion state partition function Z{b,F(x)}, covering states between two
macro-states b and c, has to be computed only once for each pair
[see Equations (6 and 7)].

The major advantage of the local ﬂooding method compared
with global ﬂooding approaches is an extremely reduced memory
consumption. This is achieved by only storing the micro-states
part of the current macro-state b (set D) plus all member and
transition state candidates (set T). The reduction effect is studied
in detail in the next section, and an implementation of the
presented local ﬂooding has been added to the Energy
Landscape Library (ELL; Mann et al., 2007). The ELL provides
a generic platform for an independent implementation of algo-
rithms and energy landscape models to be freely combined
(Mann et al., 2008; Mann and Klemm, 2011). Within this
work, we tested our new method using the ELL-provided

RNA secondary structure model, as discussed in the following
section.

The reduced memory consumption of the local ﬂooding
scheme comes at the cost of increased computational efforts
for the assignment of states that are not part of macro-state b.
The above workﬂow does an explicit computation of F for all
these states. Here, more sophisticated methods can be applied
that either do a full or partial hashing of states partaking in
steepest descent walks to increase the performance.

Another advantage is the inherent option for distributed com-
puting, as the local ﬂooding is performed independently for each
macro-state. As such, we can yield a highly parallelized transition
rate computation not possible in the global ﬂooding scheme.
This can be combined with an automatic landscape exploration
approach where each local ﬂooding instance identiﬁes neighbor-
ing, yet unexplored, macro-states that will be automatically dis-
tributed for processing until the entire energy landscape is
discovered.

We will now investigate the requirement and impact of our
local ﬂooding approach in the context of folding landscapes of
RNA molecules.

4 FOLDING LANDSCAPES OF RNA MOLECULES

In the following, we will study the energy landscapes for the
bistable RNA d33 from (Mann and Klemm, 2011) and the
iron response element (IRE) of the Homo sapiens L-ferritin
gene (GenBank ID: KC153429.1) in detail. The sequences are
GGGAAUUAUUGUUCCCUGAGAGCGGUAGUUCUC and CUGUCUCUU
GCUUCAACAGUGUUUGGACGGAACAG, respectively. In addition,
and to evaluate the general character of our results, we generated
110 random RNA sequences with uniform base composition, 10
for each length from 25 to 35 nt. For this set average values are
reported. The length restriction was a requirement for compari-
son with exhaustive methods.

4.1 Exact versus approximated transition models

We will ﬁrst investigate whether exact macro-state transition
probabilities are essentially required for computing a coarse-
grained dynamics or whether an approximated model is provid-
ing similar results. To address this question, we performed an
exhaustive enumeration of the RNA energy landscapes for d33
and IRE, resulting in ~30 and 21 million micro-states, respect-
ively, that are clustered into ~2900 gradient basin macro-states
for each sequence. These basins are connected by ~60 000
macro-state transitions, representing only a fraction of 1.5% of
all possible pairwise transitions.

The concept of barrier trees (Flamm et al., 2002; Flamm and
Hofacker, 2008) represents a straightforward approach for
modeling the coarse-grained folding dynamics of an RNA mol-
ecule without explicit knowledge of the exact pairwise micro-
scopic transition probabilities. In this context, transition
probabilities between any two gradient basin macro-states b
and c are deﬁned via an Arrhenius-like equation. The latter is
given in Equation (8), considering the energy difference AE be-
tween the local minimum of macro-state b and the lowest saddle
point of any path to the target macro state c (which may traverse
some other macro-states). The saddle point can be identiﬁed

 

2587

112 /810'S112umo[p101x0'sot112u1101u101qﬂ2d11q 111011 pepeolumoq

910K ‘09 isnﬁnV no 22

M.Mann et al.

 

either via exhaustive enumeration (F lamm et al., 2002) or esti-
mated by path sampling techniques (Bogomolov et al., 2010;
Kucharik et al., 2014; Li and Zhang, 2012; Lorenz et al., 2009;
Richter et al., 2008). Energy barriers can be visualized in a tree-
like hierarchical data structure, the barrier tree, resulting in all n2
pairwise transition probabilities for n macro-states. Coarse-
grained folding kinetics based on this framework has been
shown to resemble visual characteristics of the exact macro-
state kinetics (F lamm et al., 2002; Wolﬁnger et al., 2004).

The Supplementary Material provides a visual comparison of
coarse-grained folding dynamics for RNA d33, based on two
different transition models. While the pure barrier tree dynamics
resembles the overall dynamics of the two energetically lowest
macro-states of the exact model well, it shows signiﬁcant differ-
ences for states populated at lower extent. Given these visual
discrepancies, we are interested in measuring the modeling qual-
ity of the barrier tree-based transition model versus the exact
conﬁguration. To this end, we will analyze mean ﬁrst passage
times (F PT) and their correlations. The F PT t(b, i), also termed
exit time (F reier et al., 1986), is the expected number of steps to
reach the target state i e B from a start state b e B for the ﬁrst
time (Grinstead and Snell, 1997). The ﬁrst passage time for a
state to itself is 0 per deﬁnition, i.e. t(b, b)=0. For all other
cases, it is deﬁned by the recursion

1(1), t)= 1+ 2 qb_)ct.'(c, t). (10)

ceB

We are focused on folding kinetics, i.e. we compute the FPT
from the unfolded state to all other macro-states using (i) the
exact macro-state transition probabilities [Equation (6)] obsolete
and (ii) the barrier tree-based transition probabilities based on
the Arrhenius equation [Equation (8), barrier model].

First passage time values depend on the intrinsically unknown
Arrhenius prefactor. As such, we will compare the two models
using a Spearman rank correlation of the FPT, i.e. we compare
the relation between F PTs rather than ﬁnal values.

For d33 and IRE, the Spearman rank correlation coefﬁcients
are 0.28 and —0.12, respectively, indicating no correlation. The
random sequence set shows a mean coefﬁcient of 0.2, indicating
no correlation either. No length-dependent bias was found (see
Supplementary Material). Results are summarized in Table 1.

The barrier model is a simpliﬁcation of the full model in two
aspects: (i) loss of precision—the computation of transition rates
based on Arrhenius-like equations is less accurate and (ii) loss of

Table 1. Spearman rank correlation of different macro-state transition

 

 

models

Sequence(s) Spearman correlation Spearman correlation
exact—barrier exact—merged

d33 0.28 0.85

IRE —0.12 0.64

Random 0.20 0.71

 

Note: Comparison of the Arrhenius barrier-based and the exact model shows almost
no correlation, while the merged model of both is highly correlated to the exact
model.

topology—the barrier model allows for all possible pairwise tran-
sitions, which may lead to an overestimation of transitions. To
further distinguish between these two transition approaches, we
have derived a merged transition model with modiﬁed transition
probabilities q’. Within this merged model, quc is given by the
Arrhenius-like equation [Equation (8)] for all exact macro-state
transitions [qbkc 75 0, Equation (6)] and zero otherwise.
Investigating the Spearman rank correlation of the merged
model’s FPTs with the exact F PTs, an increased correlation co-
efﬁcient (0.85 for d33 and 0.64 for IRE) is observed. This is
supported by a robust average coefﬁcient of 0.71 for the set of
random sequences (see Supplementary Material).

These results clearly show two key aspects of reduced folding
dynamics: First, importance of the underlying topology of the
landscape, i.e. the necessity to identify sparse exact transitions
between macro-states, and second the reduced modeling quality
when restricting the computation of transition probabilities to
energy barrier-based (Arrhenius-like) approximations. The im-
portance of the topology information for kinetics is partly stu-
died in the Supplementary Material of Kucharik et al. (2014).

4.2 Reduction of memory requirement

Given the need for an exact computation of macro-state transi-
tion probabilities, we will now evaluate the impact of a local
ﬂooding scheme compared with the standard global ﬂooding
approach. In this context, we will investigate the memory foot-
print, which is the central bottleneck of global ﬂooding methods.

As outlined above, global ﬂooding schemes keep track of all
micro-states x e X within the energy landscape. As such, the
global ﬂooding memory consumption is dominated by
mem(G) = |X|.

In contrast to that, all micro-states x e F‘1(b) of b in the local
ﬂooding scheme have to be stored to compute Zb [Equation (5)]
as well as the set of all micro-state transitions leaving macro-state
b, denoted T (b), for computing Z{b,*} [Equation (6)]. The
memory consumption of local ﬂooding of b is thus ruled by
m€>111(L)=l1-’*L1(b)l+lT(b)l-

Investigating the ratio of mem(L)/mem(G) for all macro-
states, we ﬁnd a mean value of 0.0015 and a median of
<0.0001 for both the d33 and the IRE landscape. In other
words, the memory footprint of local ﬂooding comprises
<0.005 (0.5%) compared with global ﬂooding for almost all
macro-states (99%). For ~80% of the macro-states, the foot-
print drops even lower to <0.01%. Similar numbers are observed
within the random set for sequences of same lengths. Most not-
ably, we see a logarithmic decrease of the average memory re-
duction with growing sequence length (Fig. 1). We ﬁnd only
three large macro-states with mem(L)/mem(G) > 10% in both
landscapes.

These numbers give evidence for the memory efﬁciency of a
local ﬂooding scheme. Within the context of extensive parallel-
ization, such a scheme can be applied to large energy landscapes,
as the individual memory consumption is several orders of mag-
nitudes lower compared with a global ﬂooding scheme. The re-
maining set of few large macro-states can be handled at the cost
of longer runtimes by using the efﬁcient local sampling scheme
for macro-state transition probabilities presented in (Mann and
Klemm, 2011).

 

2588

112 /810'S112umo[p101x0'sot112u1101u101qﬂ2d11q 111011 pepeolumoq

910K ‘09 isnﬁnV no 22

Memory-efﬁcient RNA energy landscape exploration

 

4.3 Properties of gradient basins

In the following, we will work out various properties of gradient
basins because they are commonly used as macro-state abstrac-
tion in RNA energy landscapes. We will give examples for RNA
d33; however, the results can be generalized to other RNAs as
shown for the random sequence set.

We have shown in the context of local ﬂooding memory con-
sumption that the overwhelming majority of gradient basins is
small, whereas there are only a few densely populated gradient
basins. Most importantly, the basin of the open, unstructured
state, which is a local minimum according to the Turner energy
model OCia et al., 1998) and the selected neighborhood relation
M allows for the largest neighborhoods. Consequently, its gra-
dient basin is the largest for all RNAs studied and wraps ~20—
30% of the state space. In the random dataset, the open state
covers on average ~40% of the landscape, and we see a decrease
of this fraction with increasing sequence length. The same ten-
dency applies to the average relative basin size (Fig. 1). Other
large gradient basins are usually centered at energetically low
local minima, and their basin size is in general highly speciﬁc
for the underlying sequence. We do observe a correlation of
basin size with the energy of its local minimum (Spearman
correlation —0.73), which is in accordance to the ﬁndings of
Doye et al. (1998) for Lennard—J ones clusters.

When investigating the distribution of the energetically lowest
micro-states in each gradient basin, i.e. the local minima, we ﬁnd
that most minima have positive energies (see histogram in Fig. 2).
Minima are distributed over the lower 40—50% of the energy
range for all sequences studied. The number of minima with
negative energy, i.e. stable secondary structures, is ~100 for
d33 and IRE and is in the range of ~5% in general for the
random set studied here. The majority of the state space of
RNA energy landscapes shows positive energies, resulting from
destabilizing energy terms for unstacked base pairs in the Turner
energy model OCia et al., 1998). This is in accordance with the

Memory Reduction Local vs. Global Flooding

 

 

 

_,_
o\° :
.2 oo_
9
(U
.D
2
9
8 ©_ 0
O
:l’ O
0
er- 0 °
9
E2 o
E T
a: N_ ' o
E ig°+ T
§ igaégﬁreoo
_|_
Eo_ * 03:55
|

 

RNA sequence length

Fig. 1. Memory consumption comparison of local versus global ﬂooding
for the random sequence set. For each RNA sequence length, 10 mean
ratios of local versus global ﬂooding memory requirement are measured
and visualized in a box plot. The box covers 50% of the values and shows
the median as horizontal bar. A similar picture is obtained when plotting
the mean gradient basin size for each sequence

results from Cupal et al. (1997) who found that only ~106 of
~1016 structures of a tRNA show an energy of less than zero.

The energy range of most gradient basins, i.e. minimal to max-
imal energy of any micro-state in the basin as plotted in Figure 3,
covers almost the entire range above a local minimum. This is
generally independent of the basin size (compare Fig. 2 and 3);
only for energetically high basins a lower maximal energy is
observed. This might be a result of the accompanying basin
size decrease or an artifact of the energy model. The gradient
basin of the unstructured state covers the energetically highest
states.

As mentioned above, only few of the possible |B|2 macro-state
transitions are observed. We ﬁnd that >50% of the basins show
<10 neighboring basins and almost all (98%) have transitions to
<2% of the basins. The gradient basin of the unstructured state

Minimal Energy vs. Basin Sizes (d33)

 

 

 

 

 

 

'-O_ _o
O OBasinsize '9
Frequency

‘2. _o
O E=0 <1- o\°
C
2 2
9 0°- -0 "<7:
: o 0 ‘° 2
.5 u—
m 0
.E N o >‘
g .5— —N a
CD
m :3
O 5'
CD
‘— I.
d— —e m

. O
o-—. w —
O - o

 

| | | | | |
0.0 0.2 0.4 0.6 0.8 1.0

Minimal energy in basin (rel.)

Fig. 2. Distribution of basin sizes (dots) and frequency histogram of basins
(bars) over the energy range within the energy landscape of RNA d33.
Relative energies are given by Erel(x) = (E(x) — Emil, )/(Emax — min )
where Emil, /Emax denote the energy boundaries over X. The dotted line
marks the position of the unstructured state with energy 0

 

Energy vs. basin energy range (d33)

0.6 0.8 1.0
|

Energy range (rel.)
0.4

 

0.2

 

 

 

 

0.0
|

 

I I ‘ I I I I
0.0 0.2 0.4 0.6 0.8 1.0

Minimal energy in basin (rel.)

Fig. 3. The energy range covered by each basin (Y-axis) sorted by the
minimal energy within the basin (X-axis) over the whole energy
range of the energy landscape of RNA d33. Relative energies are given
by Erel(x) =  _ Emin (Emax _ min ) Where Emin /Emax denOte the
energy boundaries over X. The dotted lines mark the position of the
unstructured state with energy 0

 

2589

112 [3.10811211an[plOJXO'SODBIILIOJIIIOIQ/ﬂ(11111 111011 pepeolumoq

910K ‘09 isnﬁnV no 22

M.Mann et al.

 

shows the highest number of macro-state transitions and is con-
nected to >20% of the macro-states. We ﬁnd that few large
basins serve as hub nodes with high connectivity. This is in ac-
cordance to ﬁndings of Doye (2002) for Lennard—J ones poly-
mers. Consequently, the number of transitions is highly
correlated to the basin size, as one would expect. This is sup-
ported by a Spearman rank correlation coefﬁcient of ~ 0.8 for all
RNAs studied. The correlation to the basin’s minimal energy, as
found by Doye (2002), is not as signiﬁcant (Spearman correla-
tion —0.6).

5 CONCLUSION

We have introduced a local ﬂooding scheme for computing the
exact macro-state transition rates for arbitrary discrete energy
landscapes, provided some macro-state assignment is available.
The approach has been evaluated on RNA secondary structure
energy landscapes in the context of modeling coarse-grained
RNA folding kinetics based on gradient basins. We have demon-
strated the need for exact macro-state transition models via com-
parison with a simpler barrier tree-based Arrhenius-like model.
The latter resulted in signiﬁcantly different dynamics measured
by mean F PT.

We showed that the local ﬂooding scheme requires several
orders of magnitude less memory compared with the standard
global ﬂooding scheme. Furthermore, it is intrinsically open to
vast parallelization, which should also result in signiﬁcant run-
time reduction, given that the global ﬂooding can not be easily
parallelized.

Finally, we performed a thorough investigation of gradient
basins in RNA energy landscapes because they are commonly
used as macro-state abstraction in the ﬁeld. Gradient basins have
been shown to be generally small, which is the reason for the
tremendously reduced memory requirement of the local ﬂooding
scheme. The basin of the unstructured state has been shown to be
special, as it is the largest, most connected macro-state and
covers the energetically highest micro-states. Independent of
their size, most basins contain micro-states of almost the entire
energy range above their respective local minimum. The majority
of the gradient basins covers only states with positive energy. We
found a low average connectivity between gradient basins, the
existence of few highly connected hub nodes and a high correl-
ation of connectivity with basin size.

Funding: This work was partly funded by the Austrian Science
Fund (FW F) project ‘RNA regulation of the transcriptome’
(F43), the EU-FET grant RiboNets 323987, the COST Action
CM1304 ‘Emergence and Evolution of Complex Chemical
Systems’ and by the IK Computational Science funded by the
University of Vienna.

Conflicts of Interest: none declared.

REFERENCES

Aleman,E.A. et al. (2008) Exploring RNA folding one molecule at a time. Curr.
Opin. Chem. Biol., 12, 647—654.

Aviram,I. et al. (2012) Efﬁcient procedures for the numerical simulation of mid-size
RNA kinetics. Algorithms Mol. Biol., 7, 24.

Bogomolov,S. et al. (2010) Shape-based barrier estimation for RNAs. In:
Proceedings of German Conference on Bioinformatics GCB’IO, Braunschweig,
Germany. Vol. 173 of LNI, pp. 42—51. GI.

Chen,S.J. (2008) RNA folding: conformational statistics, folding kinetics, and ion
electrostatics. Ann. Rev. Biophys., 37, 197—214.

Cupal,J. et al. (1997) Density of states, metastable states, and saddle points explor-
ing the energy landscape of an RNA molecule. In: Proceedings of the
International Conference on Intelligent Systems for Molecular Biology,
Halkidiki, Greece. Vol. 5, AAAI Press, pp. 88—91.

Doye,J.P.K. (2002) Network topology of a potential energy landscape: a static
scale-free network. Phys. Rev. Lett., 88, 238701.

Doye,J.P.K. et al. (1998) Thermodynamics and the global optimization of Lennard-
Jones clusters. J. Chem. Phys., 109, 8143—8153.

Flarnm,C. and Hofacker,I.L. (2008) Beyond energy minimization: approaches to
the kinetic folding of RNA. Chem. Monthly, 139, 447—457.

Flamm,C. et al. (2000a) Design of multi-stable RNA molecules. RNA, 7, 254—265.

Flamm,C. et al. (2000b) RNA folding kinetics at elementary step resolution. RNA,
6, 325—338.

Flamm,C. et al. (2002) Barrier trees of degenerate landscapes. Z. Phys. Chem, 216,
155—173.

Freier,S.M. et al. (1986) Improved free-energy parameters for predictions of RNA
duplex stability. Proc. Natl Acad. Sci. USA, 83, 9373—9377.

Fﬁrtig,B. et al. (2007) Time-resolved NMR studies of RNA folding. Biopolymers,
86, 360—383.

Geis,M. et al. (2008) Folding kinetics of large RNAs. J. Mol. Biol., 379, 160—173.

Grinstead,C.M. and Snell,J.L. (1997) Introduction to Probability. American
Mathematical Society. http://www.amazon.com/Introduction-Probability-
Charles-M-Grinstead/dp/0821807498.

Heuer,A. (2008) Exploring the potential energy landscape of glass-forming systems:
from inherent structures via metabasins to macroscopic transport. J. Phys.
Condens. Matter, 20, 373101.

Hofacker,I.L. et al. (1994) Fast folding and comparison of RNA secondary struc-
tures. Chem. Monthly, 125, 167—188.

Hofacker,I.L. et al. (1998) Combinatorics of RNA secondary structures. Discr.
Appl. Math., 88, 207—237.

Kramers,H.A. (1940) Brownian motion in a ﬁeld of force and the diffusion model of
chemical reactions. Physica, 7, 284—304.

Kubota,M. and Hagiya,M. (2005) Minimum basin algorithm: an effective analysis
technique for DNA energy landscapes. In: DNA Computing. Vol. 3384, of
LNCS. Springer, Berlin, Heidelberg, pp. 202—214.

Kucharik,M. et al. (2014) Basin hopping graph: a computational framework
to characterize RNA folding landscapes. Bioinformatics, 30, 2009—2017.

Li,Y. and Zhang,S. (2012) Predicting folding pathways between RNA con-
formational structures guided by RNA stacks. BMC Bioinformatics, 13
(Suppl. 3), S5.

Lorenz,R. et al. (2009) 2D projections of RNA folding landscapes. In: German
Conference on Bioinformatics 2009, Halle, Germany. Vol. 157 of Lecture Notes
in Informatics, pp ll—20.

Lorenz,R. et al. (2011) ViennaRNA package 2.0. Algorithms Mol. Biol., 6, 26.

Lorenz,W.A. and Clote,P. (2011) Computing the partition function for kinetically
trapped RNA secondary structures. PLoS One, 6, el6l78.

Mann,M. and Klemm,K. (2011) Efficient exploration of discrete energy landscapes.
Phys. Rev. E. Stat. Nonlin. Soft. Matter Phys., 83, 011113.

Mann,M. et al. (2007) The energy landscape library—a platform for generic algo-
rithms. In: Proceedings of BIRD ’07, Berlin, Germany. Vol. 217, OCG, pp. 83—86.

Mann,M. et al. (2008) Classifying protein-like sequences in arbitrary lattice protein
models using latpack. HFSP J., 2, 396.

Morgan,S.R. and Higgs,P.G. (1998) Barrier heights between ground states in a
model of RNA secondary structure. J. Phys. A Math. Gen., 31, 3153—3170.
Noé,F. and Fischer,S. (2008) Transition networks for modeling the kinetics
of conformational change in macromolecules. Curr. Opin. Struc. Biol., 18,

154—162.

Popenda,M. et al. (2012) Automated 3D structure composition for large RNAs.
Nucleic Acids Res., 40, 6112.

Richter,A.S. et al. (2008) A sampling approach for the exploration of biopolymer
energy landscapes. In: Proceedings of the European Conference on
Metallobiolomics (HMI Berlin, Germany, 2007). Herbert Utz Verlag,
Mﬁnchen, pp. 27—38.

Rinnenthal,J. et al. (2011) Mapping the landscape of RNA dynamics with NMR
spectroscopy. Acc. Chem. Res., 44, 1292—1301.

Sch6n,J.C. and Sibani,P. (1998) Properties of the energy landscape of network
models for covalent glasses. J. Phys. A: Math Gen., 31, 8165—8178.

 

2590

112 [glO'SIBILInO[plOJXO'SODBIILIOJIIIOIQ/ﬂ(11111 urorr pepeolumoq

910K ‘09 isnﬁnV no 22

Memory-efﬁcient RNA energy landscape exploration

 

Sibani,P. et al. (1999) The lid method for exhaustive exploration of metastable states
of complex systems. Comput. Phys. Commun., 116, 17—27.

Tang,W. and Zhou,Q. (2012) Finding multiple minimum-energy conformations of
the hydrophobic-polar protein model via multidomain sampling. Phys. Rev. E.
Stat. Nonlin. Soft. Matter. Phys., 86 (3 Pt 1), 031909.

Tang,X. et al. (2005) Using motion planning to study RNA folding kinetics.
J. Comp. Biol., 12, 862—881.

Tang,X. et al. (2008) Simulating RNA folding kinetics on approximated energy
landscapes. J. Mol. Biol., 381, 1055—1067.

Tinoco,I. et al. (1971) Estimation of secondary structure in ribonucleic acids.
Nature, 230, 362—367.

Wolﬁnger,M.T. et al. (2004) Efﬁcient computation of RNA folding dynamics.
J. Phys. A. Math. Gen., 37, 4731—4741.

Wolﬁnger,M.T. et al. (2006) Exploring the lower part of discrete polymer model
energy landscapes. Europhys. Lett., 74, 726—732.

Xia,T. et al. (1998) Thermodynamic parameters for an expanded nearest-neighbor
model for formation of RNA duplexes with Watson-Crick base pairs.
Biochemistry, 37, 14719—14735.

 

2591

112 [glO'SIBILInO[plOJXO'SODBIILIOJIIIOIQ/ﬂ(11111 urorr pepeolumoq

910K ‘09 isnﬁnV no 22

