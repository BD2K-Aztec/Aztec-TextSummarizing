APPLICATIONS NOTE V°" 23073b.’1%§§/355?§$§Z§};§33§

 

Structural bioinformatics

Advance Access publication July 17, 2013

deltaGseg: macrostate estimation via molecular dynamics
simulations and multiscale time series analysis

Diana H. P. Low1 and Efthymios Motakisz’*

1Institute of Molecular and Cell Biology, Epigenetics, Chromatin and Differentiation, 61 Biopolis Street, Proteos #03—06,
Singapore 138673 and 2Bioinformatics Institute, Genome and Gene Expression Data Analysis, 30 Biopolis Street, Matrix

#07—01, Singapore 138671

Associate Editor: Alfonso Valencia

 

ABSTRACT

Summary: Binding free energy calculations obtained through molecu-
lar dynamics simulations reflect intermolecular interaction states
through a series of independent snapshots. Typically, the free energies
of multiple simulated series (each with slightly different starting condi-
tions) need to be estimated. Previous approaches carry out this task
by moving averages at certain decorrelation times, assuming that the
system comes from a single conformation description of binding
events. Here, we discuss a more general approach that uses statistical
modeling, wavelets denoising and hierarchical clustering to estimate
the significance of multiple statistically distinct subpopulations, reflect-
ing potential macrostates of the system. We present the deltaGseg R
package that performs macrostate estimation from multiple replicated
series and allows molecular biologists/chemists to gain physical
insight into the molecular details that are not easily accessible by
experimental techniques.

Availability: deltaGseg is a Bioconductor R package available at
http://bioconductor.org/packages/release/bioc/htmI/deltaGseg.html.
Contact: emotakis@hotmail.com

Received on April 9, 2013; revised on June 27, 2013; accepted on
July 15, 2013

1 INTRODUCTION

Free energy calculations are extensively used to understand inter-
molecular interactions. Among the several free energy estimation
methods (Bash et al., 1987), the MMGBG’B)SA (molecular mech-
anics with generalized Born and surface area solvation) has
gained popularity because of its fast performance and its ability
to predict trends in afﬁnities (Kollman et al., 2000). Traditionally
in MMGB(PB)SA, one performs molecular dynamics simulations
(MDs) and selects a set of representative snapshots from a stretch
of the trajectory that is deemed to be at equilibrium (or con-
verged). The MDs are often replicated multiple times (typically
from 3 to 6), each time with slightly different starting conditions.
Of primary interest is the calculation of the relative free binding
energy AG 2 Gcomplex— Grecepm, — Ggigand, which is estimated from
the replicated MDs of the complex, receptor and ligand terms.
The average AG across the set of selected snapshots is then re-
ported as the net free energy, which is subject to large variation.

All average-based methods assume that the AG series origin-
ates from a single conformation description of binding events.

 

*To whom correspondence should be addressed.

They are designed to minimize autocorrelation and estimate the
series on appropriate (de)correlation times (otherwise the statis-
tical error would be underestimated) Via the method of statistical
inefﬁciency or block-averaging (Flyvbjerg and Petersen, 1989).
It has been discovered that this approach is sensitive to the
drift during the course of the simulation and, especially in long
simulations, gives exponentially increased correlation times
(Genheden and Ryde, 2011). The unappealing consequence of
the monotonic relationship between the correlation and the simu-
lation times is that longer simulations lead to less data points for
reliable inference.

Our new deltaGseg methodology relaxes the restrictive ‘single
conformation’ assumption and estimates multiple distinct subpo-
pulations, reﬂecting potential macrostates upon experimental val-
idation, within a series and its replicates (Zhou et al., 2012).
Rigorous statistical modeling avoids the correlation time estima-
tion without compromising the statistical validity of the estimates.

2 APPROACH

We present the main functions of the deltaGseg R package that
implements and enriches with alternative options our original
MMPBSA_segmentation algorithm (Zhou et al., 2012) for macro-
state estimation in these steps: (i) data Visualization and adjust-
ment for preprocessing, (ii) data segmentation Via change-point
analysis for initial subpopulations estimation, followed by wave-
lets denoising for series estimation and (iii) hierarchical clustering
for the macrostates estimation. Theoretical results (Nason, 2008)
and deltaGseg diagnostic plots (function diagnosticPlots)
show the estimated series and its insigniﬁcant autocorrelation co-
efﬁcients. Our approach is not only limited to binding energies
between protein-ligand systems, but can be also used to analyze
different conformational spaces in the folding of peptides or pro-
tein by identifying different energetic states along the simulation.

3 METHODS

3.1 Visualization and preprocessing

This task is carried out by the parseTraj function. We load each time
series X’,‘(t = 1,  T; r = 1, ...R)—t denotes the time and r the repli-
cate—and, initially, we test whether each X”; is weakly (trend) stationary
by estimating the augmented Dickey—Fuller P-Value (Dickey and Fuller,
1979). If the assumption is not satisﬁed, we Visualize and split the series.
Each generated subseries is once again tested for stationarity and, if passes,
it is further analyzed independently (see next steps). Our experience with

 

© The Author 2013. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com 2501

112 ﬂJO'slcumo[pJOJXO'sopchogutoiq/ﬁd11q mm; popcolumoq

910K ‘09 lsnﬁnV no :2

D.H.P.Low and E.Motakis

 

MD simulation data indicates that weak stationarity holds for splitted
series. If the problem persists, series differentiation is suggested by calcu-
lating of the ﬁrst differences, X" [t] — X" [t — 1]. Differentiation is appropri-
ate for subseries with an apparent trend, which will be effectively removed.

3.2 Series segmentation and denoising

These tasks are performed by the denoiseSegments function. Each
subseries X: of Section 3.1 undergoes statistical multiple change-point
analysis by the Binary Segmentation method of Auger and Lawrence
(1989). Binary Segmentation automatically splits X”; into Q" segments,
Q’ e [2,maxQ]. The user sets the initial parameter maxQ (e.g.
maxQ = 15 for a series of T = 5,000; case study below), and the algo-
rithm estimates the signiﬁcant Q" segments at level a = 0.01.
Subsequently, the X; q data of each segment q", q" = 1, ..., Q’, is mod-
eled and smoothed by 1D wavelets via wavethresh Mason, 2008). The
user may adjust various modeling and smoothing parameters such as the
degree of smoothness, the wavelet family (default is the Haar wavelet with
step smoothing function) and the minimum length, Lq, for a segment q to
be accepted (LI 5 0.5 x Lg).

3.3 Data summarization and macrostate identiﬁcation
Final estimation is carried out by the function clusterSegments.
Here, the wavelet smoothed  q are summarized into a vector of quan-
tiles V; (‘identity’ vectors). All 2 Q’ segments are simultaneously
analyzed by feeding the Euclidean distances among the Vqr into hierarch-
ical clustering. The clustering can be performed either by the pvclust al-
gorithm (Shirnodaira, 2004) that assesses the signiﬁcance of each cluster /
subpopulation where potential macrostates can be derived from (see case
study below) or by simple average linkage clustering and a user-deﬁned
number of subpopulation to be identiﬁed. Both options imply manual
(subjective) selection of the ﬁnal subpopulations but the deltaGseg inter-
active plots aid the user in this decision. The pvclust provides an add-
itional statistical assessment measure.

4 CASE STU DY

We applied deltaGseg to the interaction data of the ErbB2 recep-
tor, a member of the growth factor receptor tyrosine kinase
family, and adenosine triphosphate, a natural ligand to ErbB2
(Pereira et al., submitted for publication). Snapshots from three
replicates (5000 time points each) were used (Fig. 1A). The data
preprocessing algorithm suggested splitting the third replicate at
t: 2775 (vertical dotted line). Segmentation, denoising and sum-
marization were performed for each of the four subseries. The
pvclust was used to estimate the signiﬁcance of each cluster at
each tree node (Fig. 1B).

We estimated six distinct subpopulations at signiﬁcance level
a = 0.01. Structural characterization of these ensembles can de-
termine if they represent few different binding modes between
ErBB2 and adenosine triphosphate that could arise from the
exploration of different conformational spaces as it has been
observed for an inhibitor of these kinases (Huang and Rizzo,
2012). Ideally, every single population should be characterized
by speciﬁc structural determinants which might be difﬁcult to
prove experimentally. Our approach has the advantage of apply-
ing statistical methods to identify subpopulations in the bound
state of a system, providing a more efﬁcient manner to charac-
terize quantitatively residues that contribute either in a transient
fashion or permanently in a given conformational space.

The analysis carried out here suggests the existence of two
apparent binding modes with a difference of ~36 kcal/mol

A Identified subpopulations

o_ rep1 E rep2  rep3.1 EAA‘repae
. . ‘

 
    
    

5 Subpopulations
2
LE, 0 1
IE —60- A 2
I 3
+ 4
‘90' a 5
9K 6
—120 - I i * i : _
o 5000 10000 15000
snapshots extracted from replicates
B Hierarchical clustering with P—values

 

 

 

9.2331 .... ..‘3-999 2.211-941: _______ - i
I I I
I I

 

I I.

I .I H I.O
i: RINK 5'3 ,‘Z 93 In 00:: . “g
I” "’"m m "’ "I '17; 13:: '

 

 

Fig. 1. (A) Three replicates of 5000 time points each grouped into six
subpopulations. (B) The hierarchical clustering result with P-values

between them. Of the three replicates, the ﬁrst extensively ex-
plores the looser conformation, the second preferentially ex-
plores the tighter binding mode and the third appears to
oscillate between the two modes. When these different binding
modes can be detected with experimental methods, they will be
assigned to different macrostates that can be observed at the
macroscopic level.

ACKNOWLEDGEMENT

We thank Dr Gloria Fuentes for providing the data and offering
valuable advice and suggestions.

Conﬂict of Interest: none declared.

REFERENCES

Auger,I. and Lawrence,C. (1989) Algorithms for the optimal identiﬁcation of seg-
ment neighborhoods. Bull. Math. Biol., 51, 39—54.

Bash,P.A. et al. (1987) Free energy calculations by computer simulation. Science,
236, 564—568.

Dickey,D. and Fuller,W. (1979) Distribution of the estimators for autoregressive
time series with a unit root. J. Am. Stat. Assoc., 74, 427—431.

Flyvbjerg,H. and Petersen,H.G. (1989) Error estimates on averages of correlated
data. J. Chem. Phys., 91, 461—466.

Genheden,S. and Ryde,U. (2011) Comparison of the efﬁciency of the lie and mm/
gbsa methods to calculate ligand-binding energies. J. Chem. Theory Comput, 7,
3768—3778.

Huang,Y. and Rizzo,R.C. (2012) A water-based mechanism of speciﬁcity
and resistance for lapatinib with erbb family kinases. Biochemistry, 51,
2390—2406.

Kollman,P.A. et al. (2000) Calculating structures and free energies of complex
molecules: combining molecular mechanics and continuum models aoc. Acc.
Chem. Res, 33, 889—897.

Nason,G. (2008) Wavelet Methods in Statistics with R. Springer, New York.

Shimodaira,H. (2004) Approximately unbiased tests of regions using multistep-
multiscale bootstrap resampling. Ann. Stat., 32, 2616—2641.

Zhou,W. et al. (2012) Macrostate identiﬁcation from biomolecular simulations
through time series analysis. J. Chem. Inf. Model, 52, 2319—2324.

 

2502

112 ﬁhO'smumo[pJOJXO'sot1emJOJutotw/2d11q IIIOJJ papeolumoq

910K ‘09 isnﬁnV no :2

