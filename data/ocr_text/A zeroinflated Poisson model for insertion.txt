Bioinformatics, 32(11), 2016, 1701—1708

doi: 10.1093/bioinformatics/btw061

Advance Access Publication Date: 1 February 2016
Original Paper

 

Genome analysis

A zero-inflated Poisson model for insertion
tolerance analysis of genes based on
Tn-seq data

Fangfang Liu1, Chong Wang1'2, Zuowei Wu3, Qijing Zhang3 and
Peng Liu1'*

1Department of Statistics, Iowa State University, 2Department of Veterinary Diagnostic and Production Animal
Medicine and 3Department of Veterinary Microbiology and Preventive Medicine, Iowa State University, Ames, IA
50010, USA

*To whom correspondence should be addressed.
Associate Editor: John Hancock

Received on 21 May 2015; revised on 17 January 2016; accepted on 25 January 2016

Abstract

Motivation: Transposon insertion sequencing (Tn-seq) is an emerging technology that combines
transposon mutagenesis with next-generation sequencing technologies for the identification of
genes related to bacterial survival. The resulting data from Tn-seq experiments consist of sequence
reads mapped to millions of potential transposon insertion sites and a large portion of insertion
sites have zero mapped reads. Novel statistical method for Tn-seq data analysis is needed to infer
functions of genes on bacterial growth.

Results: In this article, we propose a zero-inflated Poisson model for analyzing the Tn-seq data that
are high-dimensional and with an excess of zeros. Maximum likelihood estimates of model param-
eters are obtained using an expectation—maximization (EM) algorithm, and pseudogenes are uti-
lized to construct appropriate statistical tests for the transposon insertion tolerance of normal
genes of interest. We propose a multiple testing procedure that categorizes genes into each of the
three states, hypo-tolerant, tolerant and hyper-tolerant, while controlling the false discovery rate.
We evaluate the proposed method with simulation studies and apply the proposed method to a
real Tn-seq data from an experiment that studied the bacterial pathogen, Campy/obacterjejuni.
Availability and implementation: We provide R code for implementing our proposed method at
http://github.com/ffliu/TnSeq. A user’s guide with example data analysis is also available there.
Contact: pliu@iastate.edu

Supplementary information: Supplementary data are available at Bioinformatics online.

 

OXFORD

 

1 Introduction

Transposons are genetic elements that can be inserted into genomes
mediated by enzymes called transponsases. An application of trans-
posons in genomic studies is insertional mutagenesis which refers to
the construction of a library of bacterial strains, each being a mutant
generated by random insertion of a transposon. Transposon muta-
genesis has facilitated our understanding of gene functions through
identifying the phenotypes of the corresponding mutants. With the
recent advent of next-generation sequencing (NGS) technologies, it

is possible to sequence many transposon insertional mutants simul-
taneously, and the resulting technique that combines transposon
mutagenesis with NGS technologies has been referred to as trans-
poson sequencing (Tn-seq). The Tn-seq technique generates huge
amount of data and allows genome-wide analysis of gene functions
through mutagenesis.

Four different transposon sequencing technologies were proposed
independently in 2009 and have been reviewed in van Opijnen and
Camilli (2014). They all share similar ideas of sequencing the DNA

©The Author 2016. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com 1701

9mg ‘09 isnﬁnV uo seleﬁuV sorl ‘erulomeg JO AirSJQAru [1 112 ﬂJO'sleumo[pJOJXO'sopeuuogurorq/ﬁdnq IIIOJJ pepeolumoq

1702

F.Liu et al.

 

sequences ﬂanking the transposon insertion site. We conducted a Tn-
seq experiment to identify genes involved in the growth of a highly
virulent strain (IA3902) of the bacteria Campylobacter iejuni, which
has been reported to be the major cause of sheep abortion and impli-
cated in human gastroenteritis in the United States (Sahin et al., 2008,
2012). By randomly inserting Tn5 transposons into locations within
the genome, we generated a library of mutant bacterial strains.
Details of our Tn—seq experimental procedure are described in Section
S-1 of the online supplementary material. In summary, the genomic
DNA was extracted from the library of mutants after growth in a li-
quid medium. After shearing the extracted DNA into fragments and
amplifying the fragments with transposon-specific primers, we
applied Illumina sequencing to obtain sequence reads flanking the
transposon insertion sites. By mapping the sequence reads to the gen-
ome of Cieiuni IA3902, we identified locations of transposon inser-
tions and measured the relative abundance of mutants containing a
transposon at each possible insertion site by enumerating the sequence
reads mapped to the corresponding site. The transposon used in our
experiment, Tn5, can randomly insert into any locations of the target
DNA, but was reported to insert at the 3’ end of the sequence
A-GNTYWRANC—T with a slight bias (Gerdes et al., 2003; Goryshin
et al., 1998; Langridge, 2009). Other transposons may have different
sequence preferences of the insertion sites. For example, the Himar1
transposon (Lampe et al., 1996) inserts randomly between T and A in
TA dinucleotides.

An important research objective in a Tn—seq experiment such as
ours is to classify genes according to their tolerance to transposon
insertion mutagenesis, or equivalently, to classify genes with respect
to their effects on bacteria fitness/growth. A gene can be tolerant of
disruption if the transposon insertion into the gene does not affect
the growth of bacteria. On the other hand, a gene is hypo-tolerant
of transposon insertion if the inactivation of the gene by transposon
insertion suppresses the growth of bacteria. Such a gene may provide
an ‘essential’ or ‘core’ function in bacteria survival. A gene can also
be hyper-tolerant of transposon insertion, suggesting that the inacti-
vation of the gene may provide a growth advantage. A successful
antimicrobial treatment needs to avoid inactivation of such hyper-
tolerant genes. The above classification has been discussed in Wiles
et al. (2013) and is adopted throughout our article.

In Tn—seq data, the count of reads corresponding to each possible
insertion site provides a measurement of the abundance of mutants
containing a transposon at that location. A gene may have zero
counts of sequence reads either because the gene is hypo-tolerant to
transposon insertion and essential in bacteria survival, or because no
transposons were inserted into any location in this gene just by
chance. An appropriate statistical model should take into consider-
ation both the probability of transposon insertion and the abun-
dance of bacterial mutants in case that a transposon insertion
happens. Another challenge in Tn—seq data analysis is the high
dimensionality. Usually, thousands of genes are simultaneously
studied in one Tn-seq experiment, whereas each gene contains up to
thousands of locations for potential transposon insertions. The out-
comes of Tn-seq experiments, the read counts, are measured at the
level of insertion locations, which suggests the development of statis-
tical models at the same level to avoid loss of information. Besides,
statistical models need to take into account of the variation among
insertion locations within a gene, as well as variation among genes.

There have been a few statistical methods proposed for the ana-
lysis of Tn—seq data and they deal with different levels of data sum-
mary. Some researchers proposed to first reduce the data from the
level of locations to the level of genes using the count of locations

with zero mapped reads for each gene, and then model such counts
using discrete distributions such as Poisson distributions (Deng
et al., 2013) or negative-binomial distributions (Zomer et al., 2012).
Such models ignore the magnitudes of the read counts for locations
with non-zero counts, which measures the abundance of the corres-
ponding mutants and hence contains important information about
gene tolerance status. Zhang et al. (2012) divided the genome into
contiguous overlapping windows (with width 400—600 base pair)
and then employed a non-parametric test to assess tolerance status
to bacterial growth for each of these windows. Dejesus and Loerger
(2013) described a four-state hidden Markov model and used geo-
metric distributions for the count data at each location to model the
conditional distribution of read counts given different states, and
then each gene was assigned to a tolerance state according to the
most frequent state found within the boundaries of the gene se-
quence. Pritchard et al. (2014) presented a Tn-seq data analysis
pipeline named ARTIST. One arm of ARTIST, EL-ARTIST, imple-
ments the method proposed by Chao et al. (2013) that uses the re-
sults from the method proposed by Zhang et al. (2012) as training
set for the HMM algorithm and reports the estimate of state of
genes as essential, domain essential, sick or neutral. All of these
methods (Chao et al., 2013; Dejesus and Loerger, 2013; Zhang
et al., 2012) are applicable to Tn-seq data with transposons inserted
only into specific target locations (such as transposon Himar1 that
only inserts into TA dinucleotides). When using transposons (say,
EZ::TN) that could insert into any genome locations, the resulting
Tn—seq datasets typically are unsaturated and contain excess zeros.
These methods have difficulty in dealing with such Tn-seq datasets
because they do not model the possibilities that no transposons are
inserted into certain locations of genes during the construction of
transposon mutant libraries.

In this article, we propose a zero-inflated Poisson (ZIP) model to
deal with the excess of zeros for the analysis of Tn—seq data at the
level of locations. To account for the two possible reasons that give
rise to zero read counts at a given location, we apply a mixture
model with a point mass at zero and a Poisson distribution. The
component of point mass at zero corresponds to the case when there
is no transposon inserted at the location, and hence there should be
zero reads mapped to the corresponding location. This component is
associated with a mixing probability that models the chance of not
having a transposon insertion at a location, and this probability may
vary across different locations depending on the genomic sequence
or potentially other covariates that may affect the chance of inser-
tion. The Poisson distribution component models the count of reads
mapped to the given location when a transposon is inserted there,
and the mean of the Poisson distribution provides a measurement of
the abundance of mutants for the corresponding gene. This model
reﬂects how the count data of Tn-seq are generated at the location
level, and allows us to estimate the chance of having transposon in-
sertion and the abundance of mutants corresponding to different
genes, and the latter allows us to identify genes involved in bacterial
growth.

Our Tn-seq experiment studied one specific growth condition of
the mutant library. To classify genes with respect to their effects on
bacterial growth, we utilize data of pseudogenes observed in the
same experiment. Pseudogenes are dysfunctional relatives of genes
that have lost their protein-coding abilities. Pseudogenes are still im-
portant in genomic studies because they provide a record of how the
genomic DNA has been changed without evolutionary pressure and
can be used as a model for determining the underlying rates of nu-
cleotide substitution, insertion and deletion in the genome. In our

9mg ‘09 isnﬁnV uo sejeﬁuV SO’I ‘erulomeg JO AirSJQAru [1 112 [3.10811211an[plOJXO'SODBIILIOJIIIOIQ/ﬂ(11111 IIIOJJ pepeolumoq

A ZIP model for Tn-seq data analysis

1703

 

model, we consider pseudogenes to be tolerant of disruption as they
have already lost their protein coding abilities before mutagenesis.
Thus comparing the normal (non-pseudo) genes with pseudogenes
provides information about the tolerance status of the normal genes.
More specifically, the genes with mean abundance of mutants not
significantly different from the mean abundance of pseudogenes’
mutants will be classified as tolerant, and those genes with mean
abundance of mutants significantly below (above) the mean abun-
dance of mutants for pseudogenes are hypo-tolerant (hyper-
tolerant).

We apply an expectation—maximization (EM) algorithm to esti-
mate parameters of the ZIP model, including the mixing probability
of insertion and mean abundance of mutants for thousands of genes.
Then we estimate the asymptotic variance—covariance matrix of all
estimated parameters and perform a Wald test for each gene to as-
sess whether each gene is tolerant of transposon insertion or not by
comparing the mean abundance of mutants of this gene with that of
the pseudogenes. The method by Benjamini and Hochberg (1995) is
applied to control the false discovery rate (FDR) as an error criterion
in the multiple testing problem. At the end, we classify all normal
genes into three different classes: ‘hypo-tolerant’, ‘tolerant’ and
‘hyper-tolerant’, which reﬂects their tolerance to transposon
insertion.

The remainder of the article is organized as follows. Section 2
presents our ZIP model for Tn-seq data, our method to estimate
model parameters and our procedure for the multiple hypothesis
testing to identify the tolerance status for genes. In Section 3 and
Section 4, we present a simulation study and a real data analysis, re-
spectively. Section 5 concludes the article with discussions.

2 Method

2.1 Tn-seq data at the level of locations

To study the gene functions on bacterial growth using Tn-seq ex-
periments, we analyze the count of reads at each possible insertion
site within all gene-coding regions. A read is mapped to a location if
the corresponding transposon is inserted right before the 5’-end of
the nucleotide at that location along the genome. Suppose there are
G genes in total, without loss of generality, the genes are ordered so
that the first N (N < G) genes are normal genes, the last (G — N)
genes are pseudogenes. For the gth gene, g = 1, ..., G, the number of
possible transposon insertion sites is 11g, and the gene length is lg. For
transposons without specific recognition of target sequences, such as
the EZ::TN transposon, any location within the genome can be a
potential transposon insertion site, and thus 11g: lg. For transposons
that recognize specific sequences, only locations satisfying the se-
quence requirement would be potential insertion sites and hence
ng< lg. Let Yg, denote the count of sequence reads mapped to the ith
location in gene g where i = 1, ..., mg.

2.2 The ZIP model

The transposon mutagenesis is viewed as a process that transposons
are randomly inserted into the genome. Let Zg, denote whether there
is a transposon inserted for the ith location within gene g for g = 1,
..., G and i: 1, ...,ng. That is, Zgiz 1 if there are transposons in-
serted at the it,” location of the gth gene, and Zg, = 0 if no transposons
are inserted at this location. Obviously, if Zgiz 0, then Ygiz 0, and
we refer to this state as the perfect zero state as in Lambert (1992).
When Zgiz 1, i.e. transposon insertion occurs at the corresponding
location, we model the count of reads mapped to the location with a

Poisson distribution with mean ug, where ug can be interpreted as
the mean abundance of the mutants for gene g. The state of Zgiz 1
will be referred to as the Poisson state.

We model the insertion indicators Zgi’s with independent
Bernoulli distribution with probability of insertion pgi. The param-
eter pg,- models the chance of having a transposon insertion at the ith
location of the gth gene, and this probability may vary across differ-
ent locations depending on the genomic sequence or potentially
other covariates that may affect the chance of insertion. Let
xéi = (xgio, ..., xg,(m_1))' denote the covariates for the ith location of
gth gene that may affect pg,- and [i = (ﬁo, [$1, ..., ﬁm_1)' denote the
corresponding coefficients, we apply a logistic regression to model
pg,- through xéi. In summary, our hierarchical model is:

logit(pgz-) = Xgiﬁ, (1)
zg, ~ Bernoulli(pg,-), (2)

and
Yg,|zg,- ~ (1 — zg,) - 5m} + zg, - Poisson(ug), (3)

where 5m} denotes the point mass at 0. Although Zg,=0 implies
Ygiz 0, the reverse statement is not true. When we observe Ygiz 0,
it could be the result of no transposon insertion (Zgiz 0), or, it is
also possible that the gene is essential to bacterial growth and dis-
ruption of this gene by having a transposon insertion is not tolerated
and such bacteria cannot grow. Hence, the probability mass func-
tion of Yg, can be written as:

f(Y p ) 1 _ pgi + pgiexp(_aug) Ygi : 0’ (4)
i; 1".“ =
g g g sz' ' fpois<Ygi;Hg) Ygi > 0’

where fpois('; ,ug) denotes the probability mass function for Poisson
distribution with the mean parameter ug.

Because pseudogenes are not functional, we expect their disrup-
tion have no effect on bacterial growth, i.e. they are tolerant of
transposon insertion. Hence we expect the same level of growth for
mutants of pseudogenes, and the same level of abundance for all
pseudogenes. We denote the common mean abundance of pseudo-
gene mutants with 110, that is,

A
HN+1 ="'=HG=H0- (5)

Therefore we have (N + 1) mean parameters y = (M1, . . . ,uN, u0)' in
total.

The goal of our experiment is to determine the status of toler-
ance of each normal gene, and we compare the mean abundance of
mutants for each normal gene with that of the pseudogenes. So after
our estimation of model parameters, we will test the following
hypotheses for each gene g:

H0g : Mg 2 yo versus H1g : Mg 75 yo. (6)

2.3 Parameter estimation

In this subsection, we describe how we obtain the maximum likeli-
hood estimates for the parameters [i = (ﬁo, [$1, . . . ,ﬁm_1)' and
u 2 (,ul, . . . , ,uN, ,uo)’. Provided that the resource for bacterial growth
is enough, the measurements of mutant abundance, Ygi’s, are inde-
pendent of each other. For notational convenience, we have Y =
(Y11, ..., Y1n1, ..., YG1, ..., YGnG)I, and Z = (Z11, ...,Z1n1, ...,ZG1, ...,
ZGnG)'. Based on (4) and assuming independence between locations

9mg ‘09 1sn8nV uo sejeﬁuV SO’I ‘121u10111123 10 A11819Aruf1 112 /810'S{12umo[p101x0'831112u1101u101q/ﬁd11q 111011 pepeolumoq

1704

F.Liu et al.

 

and genes, the log-likelihood function with observable data Y is
given by

G "g
L(paﬂlY) = Zzlogf(ygi;pgiaaug)

g=1 i=1
G
= Z Zlogu — pg,- + pgiexp(—ug)l (7)
g=1 iESg
G
+2 Zlog[pgi-fpois(Ygi;Hg)l 1
g=1 i¢Sg

where pg,- 2 exp(x"g,-[i)/(1 + exp(x"g,-[i)), and the set Sg = {i: Yg, = 0}
is defined as the set of indices corresponding to those locations with
zero read count for gene g.

For our ZIP model, we have N + 1 mean parameters and m co-
efficients in the logistic regression for pgi’s. In total, there are
(N + m + 1) parameters to be estimated. For Tn-seq data, N is in
thousands and hence, it is a high-dimensional estimation problem.
Commonly used numerical optimization procedures such as
Newton—Raphson and gradient conjugate method can be computa-
tionally complicated and burdensome to maximize the log-likeli-
hood L([i, y|Y) in terms of the high-dimensional parameter space.
Instead, we develop an EM algorithm (Dempster et al., 1977) using
the complete data denoted as (Y, Z), where Z is an unobserved vec-
tor of latent variables that store the transposon insertion states. As
explained below, given Z, the likelihood function can be written
into two parts and then allows separate maximization with respect
to [f and )1 which results in an efficient way to estimate the MLEs.

The distribution of Yg, conditional on Zgz- is

f (Ygz'lzgz') = l5{0}(Ygi)l1—ZgilfPois<Ygii Mg)lZg"-
And the joint distribution of (Ygi, Zgi) is
f(Ygi Zgz') = [(1 — pgi)6{0}(Ygi)l1—Zgi[pgifpois(Ygi;.ug)lzgia (3)

where Zgi|pgi ~ Bernoulli(pg,-), and logit(pg,-) = xéiﬁ.

Suppose we know which zeros come from the perfect zero state
and which come from the Poisson state. In other words, we could
observe Zgiz 0 when Yg, is from the perfect zero state and Zgiz 1
when Yg, is from the Poisson state. Then the log-likelihood with the
complete data (Y, Z) would be written as

G "g
Law, #1le Z) = Z ZOOgﬂzgingi) +1ng(Ygi|Zgi,Hg)), (9)
g=1 i=1
where

108 f(zgi|Pgi) = Zgixéiﬂ — 108(1 + “Pkg/m,

log f(Ygi|Zgia Hg» 2 Zgi(Ygilog.ug _ Hg) _ Zgilog(Ygi!)'
This implies that
Lew, MIY,Z) = LCWIY, Z) + Lc(”|YaZ)a (10)

where
"g

G
Leonel) = Z (Zgixfgm — logo + exp(xfg,-Ii))),
:1 '=1

0Q

On:

Me

Lew, 2) = (znggz-logug — Mg) — zgilogwgz-I».

i=1

W
H

Hence, the complete log-likelihood function in (10) can be writ-
ten into two parts, Lc([i|Y, Z) and Lc(y|Y, Z) that could be maxi-
mized separately. Therefore the complete log-likelihood is easier to
maximize than simultaneously maximizing all model parameters
with marginal likelihood based on Y.

The EM algorithm used to maximize L([i, u|Y) alternates between
an expectation (E) step in which the latent variables Z are calculated
as their expectations under the current estimates of parameters (13,”),
and a maximization (M) step in which the complete log-likelihood LC
([3, y|Y, Z) at values of Z from the E step is maximized with respect to
both [i and y. The EM algorithm begins with starting values (BO, yo)
and proceeds iteratively between the E step and the M step. At the
(k + 1)th iteration, the E step and M step are as follows.

(1) The E step Compute the conditional expectation of Zg,

4:“) = E(Zgz-|Y, pk, up
= P(Zgi = 1|Ygi7pkiﬂk)
1 Yg,‘ > 0
{(1 + CXPWS — xgiﬁk))—1 Ygi = 0’

This indicates that the conditional distribution of Zgi| Ygi, ﬁk, pk is
511} Km > 0

z - Y - pk, uk ~
gll g1, Bernoulli(z:i+1) Ygz- = 0,
where 5m denotes the point mass at 1.

(2) The M step The ﬁkH that maximizes Lc(ﬁ|Y, Zk+1),

G "g

Lc(l‘|Y, Z) = Z 2(Zgz'XQZ-l‘ — 108(1 + 6XP(X;iﬁ))),

g=1 i=1

can be obtained by performing an unweighted binomial logistic re-

Zk+1 on the design matrix X using a binomial denomin-

gression of
ator of one for each observation, where the column vectors of X
from left to right are x11, ..., x1nl, ..., xG1, ..., xGnG respectively.

The yk+1 that maximizes Lc(y|Y, Zk+1) has closed-form expres-

sion. The estimate for pg where g = 1, 2, - - - ,N, is
"g , +1
k+1 _ Z2g=1 Yg’zéi
'ug _ ng zkj—l
g g1

And we also get the estimate

G n k
“H1 _ Zg=N+1 22:1 Ygizgz+1
0 _ G n
Zg=N+1 21:1 
As shown in Lambert (1992), the EM algorithm converges for

the ZIP model. Good initial values for the EM algorithm can facili-
tate convergence. In this article, we use the MLE for the positive

 

Poisson log-likelihood as the initial value for parameters )1. The posi-
tive Poisson distribution is the ordinary Poisson distribution with
zero truncated from the support. The log-likelihood of positive
Poisson model for the Tn—seq data is

G
L-I- OC 2 Z [Ygilogaug _ Hg _  _ exp(_aug))l7
g=1 i:Ygi>0

For each g = 1, ..., N, the score equation is

3L+/3Hg= 2 (ﬁ_ )_Zwéo_

i;Yg,->0 g Ygi>0 _exp(_“g)

9mg ‘09 1sn8nV uo sejeﬁuV SO’I ‘121u10111123 10 A11819Aruf1 112 /810'S{12umo[p101x0'831112u1101u101q/ﬁd11q 111011 pepeolumoq

A ZIP model for Tn-seq data analysis

1705

 

Equivalently, the equation can be written as

E , Y" "8

Z:Ygi>0 gt 1

—— 1+—- IY,>0=0,
‘ug ( exp(‘ug)_1)  ( g )

where I denotes the indicator function. Solving this equation
(using ‘uniroot’ function in R) leads to the MLE for the positive
Poisson log-likelihood and our initial value for ,ug. Similarly, solving
the following equation gives the initial value for yo.

"8

M. f: 1(Yg,>0)= 2G: 2 Yg,.
1

exp(au'0) — 1 g=N+1 i: g=N+1i:Yg,->0

The initial values of elements in [l are set to be zeros except for
the intercept. The intercept is initialized as the estimated log odds of
transposon insertion. The probability of having a transposon inser-
tion is calculated by considering the two possible reasons to have 10-
cations with zero reads counts:

 

G "g G ﬁg
2; y 11%: o) — z; y 1 exp(—ug)
A _ g: 2: g: 1:
P0 — 1 — G .
Eng
g=1

And then the estimated log odds is calculated as log(130 / (1 — 130)).

2.4 Hypothesis testing to classify the tolerance

status of bacterial genes

We apply multiple testing procedure to classify genes into different
groups of transposon insertion tolerance. Let dg 2 ug — 110. For each
g = 1, ..., N, we test the null hypothesis H0g : dg = 0. For notational
convenience, set 0' = (B', u’)’. In large samples, the distribution of
the MLE 0 is approximately normal with means 0 and variance—co-
variance matrix equal to the inverse of the observed Fisher informa-
tion matrix I (Y, 0)_1. The observed Fisher information matrix can
be directly computed by

immun- <11)

Although the Fisher matrix is of extremely high dimension, it
contains a big block of diagonal matrix and we are able to obtain its
inverse using the block matrix inversion formula. The derivation of
the Fisher information matrix as a block matrix is given in Section
S-3 of the online supplementary material.

For large samples as in Tn—seq data at the level of locations, the
MLE’s and regular functions of the MLE’s are consistent. Let the es-
timate for dg be dg 2 ﬁg — 110 and the estimated variance be

Greg) = Wang) + Woo) — mowing).

Then, for each g = 1, ..,N, we apply the Wald test to test the
null hypothesis, and calculate the p-value by

pg = 2<I> , (12)

 

1/U&r(62 g)
where  denotes the cumulative distribution function for the
standard normal distribution.

A Tn-seq experiment simultaneously examines thousands of
genes. Hence, we need to control the multiple testing error. The false
discovery rate (FDR) proposed by Benjamini and Hochberg (1995 )
has been argued to be a reasonable error rate to control in different

genomic studies (Storey and Tibshirani, 2003). In this article, we
apply the procedure of Benjamini and Hochberg (1995 ) to the set of
p-values to control FDR. Other FDR controlling procedures such as
the q-value method (Storey and Tibshirani, 2003) can also be
applied.

We use a two-step procedure to identify the transposon tolerance
status of genes. The first step is to perform multiple testing proced-
ure while controlling FDR as described above. Genes whose corres-
ponding null hypotheses are not rejected are classified to the group
of genes tolerant to transposon insertion. In the second step, we
examine the estimates of dg for genes whose corresponding null
hypotheses are rejected. If the estimate of dg is smaller than zero for
gene g, it is classified as hypo-tolerant to transposon insertion. That
is, the impairment of such genes negatively impact the bacterial
growth and may serve as anti-bacterial target. If the estimate of dg is
larger than zero for gene g, it is classified as hyper-tolerant.

3 A simulation study

A simulation study is conducted to evaluate the performance of our
proposed method as described in Section 2. In this simulation study,
we set the transposon insertion rate P to be 0.01 and not affected by
covariates. There were a total of 1820 genes, among which 20 were
pseudogenes. The number of possible insertion sites ng was simu-
lated from discrete Uniform distribution U(5 00, 2000) for each gene
g. The mean abundance of mutants for pseudogenes was set be to
yo = 8, and the means (ug’s) for the 1800 normal genes were set as

f0110WS= H1,...,200 = 0-5,H201,...,400 = 1:“401,...,600 = 2’H601,...,800 = 4’

H801,...,1000 = 3aH1001,...,1200 = 16,.111201,...,1400 = 32:“1401,...,1600 = 64
and M1601,___,1800 = 128. The response Ywas obtained by first gener-

ating a Uniform(0, 1) random vector U and then simulating Yg, from
Poisson (pg) if Hg 3 p or assigning Ygiz 0 otherwise. A total of 100
datasets were simulated.

After applying our method with B = [30 while controlling FDR at
5%, we categorized each simulated normal gene into the three
groups: tolerant, hypo-tolerant and hyper-tolerant. For each ug
value, the proportion of genes classified into each of the three groups
was calculated for each simulated dataset and then averaged over
100 simulated datasets. Such proportions are plotted against the
true values of Hg for normal genes in Figure 1. This figure demon-
strates that our proposed method in Section 2 correctly identified
the tolerance status for most genes. The estimation of d 2 ug — 110,
the mean difference between normal genes and pseudogenes, is eval-
uated in Table 1. The estimates are very close to the corresponding
true values.

4 Analysis of real datasets

We conducted a Tn-seq experiment that studied a highly virulent
strain (IA3902) of C.iejuni, which was reported to be the major
cause of sheep abortion in the United States and could zoonotically
transmit to humans (Sahin et al., 2008, 2012). The strain IA3902 is
resistant to tetracyclines, the only antibiotic currently approved in
the United States for the treatment of Campylobacter abortion in
sheep (Delong et al., 1996). The rise of antibiotic resistance calls for
knowledge-led approaches to identify new interventions and preven-
tion strategies. A library of Tn5 transposon insertion mutagenesis
was prepared according to the experimental procedure described in
Section S-1 of the online supplementary file. There are 1631 genes in
total, among which 18 are known pseudogenes. In total, we have
data for 1 544 034 possible locations within the gene-coding

9mg ‘09 1sn8nV uo sejeﬁuV SO’I ‘121u10111123 10 A11819Aruf1 112 /810'S{12umo[pJOJXO'sopeIIJJOJHrorq/ﬁd11q 111011 pepeolumoq

1706

F.Liu et al.

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

‘— hypo—tolerant

0 1:1 tolerant
s!— E hyper—tolerant
o 100 100 100 100 957 100 100 100 100
S." . T —‘ T
- \ \ S \
§ \ \ \
z \ \ \ \
  s h x s
3 \ \ \ \
5 8 - \ \ \ \

as \ \ \
.2 \ S \ \
E x \ h
*' \ \ i \
\ \ \ \
\ \ \
o- \ \ \ \
N \ \ \ \
s h s
o_ 00 00 00 003212 g; g: mi £5
1 2 4 8 6 32 64 128
“9

Fig. 1. Proportions of genes that were classified into each of the three differ-
ent groups (tolerant; hypo-tolerant and hyper-tolerant). These proportions
were averaged over the 100 simulated datasets for each true level of ,ug. The
numbers above each of the bars are the averaged percentage value. The
mean for pseudogenes (,uo) was set to be 8

Table 1. Summary statistics for the simulation study)." Est Diff" is
the estimated difference averaged over the 100 simulated datasets,
and" SE" is the corresponding standard error

 

 

True diff Est diff SE

—7.5 —7.5123 0.3031
—7 —7.0363 0.4314
—6 —6.0588 0.5824
—4 —4.0279 0.7353
0 —0.0155 0.9634
8 7.9988 1.3635
24 23.9986 1.9623
56 55.9530 2.9852
120 119.9082 4.3193

 

‘True Diff’ is the true difference between mean abundance of normal genes
and pseudogenes (dg = pig — pro). ‘Est Diff’ is the estimated difference aver-
aged over the 100 simulated datasets, and ‘SE’ is the corresponding standard
error.

regions. Summary statistics are presented in Table 2 for the IA3902
dataset in terms of (1) gene length (lg: for Tn5, the number of pos-
sible transposon insertion locations 11g: lg) and (2) the proportion of
locations with zero read count in a gene. Averaged over all genes,
the proportion of locations with zero read count is 97.03%, which
indicates that zero-inflation is common among genes. The summary
statistics also indicates large variability of gene length among the
genes.

Although Tn5 transposon can be inserted into any location, as
seen in our dataset, it is also reported that Tn5 has a target consen-
sus sequence, A-GNTYWRANC-T (Goryshin et al., 1998). This sug-
gests that the transposon insertion rate tends to be higher for sites
matching the sequence A-GNTYWRANC-T. In addition, Herron
et al. (2004) and Green et al. (2012) mentioned there is bias in trans-
poson insertions towards genes with richer GC content. We thus
included two covariates in the logistic regression model for the inser-
tion rate pgi. One is named ‘MATCHING’, which takes value 1 if

Table 2. Summary of the IA3902 Tn-seq data in terms of gene
length and the proportion of locations with zero read count within
a gene

 

 

Gene length (lg) Proportion of 0
Min 93 0.6000
lst Quartile 528 0.9709
Median 808.5 0.9804
3rd Quartile 1209 0.9865
Max 4554 1.0000
Mean 946.1 0.9703

 

Table 3. Statistical analysis results for the regression coefficients
(13's) in the logistic regression model for the insertion rate

 

Variable MLE SE P—value 95% CI

 

Intercept ([30) —6.904 0.051 0.000
Matching (Bl) 1.565 0.286 4.65e—8
GC percentage ([32) 0.108 0.002 0.000

(—7.004, —6.803)
(1003,2126)
(0105,0111)

 

P-values were obtained by testing the null hypothesis that the correspond-
ing regression coefﬁcient equals zero.

the site matches the target sequence A-GNTYWRANC-T, and takes
value 0 otherwise. The other is the percentage of GC content within
each gene sequence. Table 3 presents the MLEs and their standard
errors of the estimated parameters involved in the logistic regression
model for the insertion rate, and P-values for testing the inclusion of
the corresponding coefficient in the model based on the analysis of
the IA3902 dataset. Table 3 shows that the covariate ‘MATCHING’
and ‘GC percentage’ are both important factors that inﬂuenced the
probability of insertions. Within a gene, the odds of having trans-
poson insertion for sites with ’ matching’ 2 1 over the odds of having
transposon insertion for sites with ’ matching’ 2 0 is
exp(1.5 65) = 4.78. For one percent increase in the GC percentage
of a gene, the odds of transposon insertion is expected to increase
about 11.4%. The above results indicate that although Tn5 could be
inserted into locations not matching the target sequence, the inser-
tion rate was much lower than that for the sites matching the target
sequence. And also there is preference for Tn5 insertion into GC-
rich DNA. Such quantification of insertion rate is useful in under-
standing the performance of transposons and the Tn—seq
experiment.

The major goal of our Tn-seq experiment is to identify genes
involved in bacterial growth. Applying the method we describe in
Section 2 resulted in estimates of the mean abundances for all genes,
and P-values for testing gene tolerance of transposon insertion. The
volcano plot in Figure 2 shows the relationship between P-values
and cfg’s, the estimated differences in mean abundance of mutants
between normal genes and pseudogenes. As expected, there is a
positive relationship between the absolute value of rig and the
significance of the test, which is indicated by the value of
—log(P-value + 2 T 20) plotted as y-coordinate in Figure 2. We cate-
gorized all normal genes into three different states: hypo-tolerant,
tolerant and hyper-tolerant while controlling FDR, and the results at
different levels of FDR are presented in Table 4. When FDR was
controlled at 5%, about 22% of the normal genes were classified as
hypo-tolerant, and about 46% of genes were classified as hyper-tol-
erant. Figure 3 shows the estimated mean abundance of mutants for
all normal genes (ﬂg’s). The estimated mean abundance of mutants
for pseudogenes is 120 = 7.0552, which provides a reference for

9mg ‘09 1sn8nV uo sejeﬁuV SO’I ‘121u10111123 10 A11819Atuf1 112 /810'S{12umo[pJOJXO'sopeIIJJOJHtotq/ﬁd11q 111011 pepeolumoq

A ZIP model for Tn-seq data analysis

 

 

 

 

 

 

 

 

 

V _
1— W (9 V o 00
0 0‘9 0 00 0 o O
O Q) o o O
oq’o°°%°o 020° o ° o
g T 0 9e 80 a: o
°° o 0
080° Q 0 o o
0% 08 o
o o o o oo o o
1— _ Q)
o edge 0:8): 0 °
A o
8
‘I‘ 0° -
(<\l
i o
g
5 to _
<_3
I
<- _
N _
pval(0.0338),qval(.0494)
o _ pval(0.0708),qval(.0986)
I I I I I I I
—10 —5 0 5 A 10 15 20 25
d9

Fig. 2. Volcano plot for the relationship between P—values for testing the toler-
ance status of normal genes and the corresponding dg’s, the estimated differ-
ences in mean abundance of mutants between normal genes and
pseudogenes. The y axis corresponds to —Iog(P—value +240) while the x
axis corresponds to estimated dg’s

Table 4. The number of genes classified into each tolerance group
at different FDR levels

 

FDR level a: Hypo-tolerant Tolerant Hyper-tolerant Total

 

0.001 192 765 656 1613
0.01 265 652 696 1613
0.05 361 507 745 1613
0.1 395 454 764 1613

 

classifying the normal genes. The classification of genes is presented
with the results when FDR was controlled at 5%.

We also applied EL-ARTIST (Chao et al., 2013; Pritchard et al.,
2014) to this IA3902 dataset. Detailed comparison between results
obtained from EL-ARTIST and our proposed methods are described
in Section S-2.2 of the online supplementary material. In summary,
the two methods agreed on the classifications of tolerance status for
75% of genes. For those genes whose tolerance status differed be-
tween our proposed method and the EL-ARTIST method, a closer
investigation of the read count distribution across gene-coding re-
gions indicated that our classifications of tolerance status were more
consistent with the raw data observed at the insertion site level.

In addition, we implemented our method for the M.tuberculosis
dataset (Zhang et al., 2013) that was obtained from an experiment
using Himar1 transposon that can only insert into TA dinucleotides.
The comparison between EL-ARTIST and our proposed method is
described in Section S-2.3 of the online supplementary material.
Similar conclusions were obtained as those for IA3902 data analysis.

5 Discussion

A ZIP model is proposed in this article to model the excess of zeros
observed in the Tn-seq data. The mixture model of point mass at zero
and a Poisson distribution are constructed specifically according to the
way Tn-seq data are generated. Multiple testing procedures are
applied to classify genes into different categories with respect to

 

 

 

 

 

   

 

 

 

 

    
   

 

 

 
     

 

 

 

 

1707
a f
( ) :  hypo—tolerant
E- ; hyper—tolerant
I III tolerant
> O :
8 $2 ‘ I
a) I
 i
o _ I
to .
o _ I I u. uu\ a . wt. “\ s I up... .. I . . . . a . I
o 50 1,90 150 200
“g
(b) ,
8 _ % hypo—tolerant
N hyper—tolerant
III tolerant
O
B _
5‘
3
 8—
g
a- s
s
10 2 14 16 18 20
“9

Fig. 3. The histogram of the estimated ,ug’s for the normal genes. The upper
panel is for all normal genes, and the lower panel is for the subset of normal
genes with estimated mean less than 20. The vertical dotted line in both plots
denotes the estimated mean abundance for mutants of pseudogenes (7.0552)

transposon insertion tolerance, hence identify genes whose functions
are closely related to bacterial growth. We evaluated the proposed
method using both simulation studies and analysis of two real data-
sets. Simulation studies in Section 3 demonstrates that our proposed
method performs well in terms of both the estimation of parameters
and the classification of genes. In the main text, we discuss an applica-
tion of our proposed model to the Tn-seq data with the Tn5 trans-
posons which could be inserted possibly into any site within the
genome. Our model can also be used in the analysis of Tn-seq data
from experiments where transposon insertions are restricted, for ex-
ample, experiments using Himar 1 transposons that insert into TA di-
nucleotides only. An application of our method to a Himar 1 dataset
is presented in Section S-2.3 of the online supplementary material.
Investigation of the distributions of read counts across gene-coding re-
gions indicates that the resulting tolerance statuses classified by the
proposed method are reasonable for both datasets. To validate the re-
sults, experiments with knock-out genes can be conducted. If a gene is
truly hypo-tolerant or even essential, disruption of this gene would re-
duce growth fitness or even cause death of the strain. Similarly,

9mg ‘09 1sn8nV uo sejeﬁuV SO’I ‘121u10111123 10 A11819Atuf1 112 /810'S{12umo[pJOJXO'sopeIIJJOJHtotq/ﬁd11q 111011 pepeolumoq

1708

F.Liu et al.

 

knockout of a hyper-tolerant gene would induce advantages for cor-
responding bacterial growth.

The real data we obtained only studied one growth condition, and
we propose to use pseudogenes as an internal standard to set the
threshold that classifies normal genes into hypo-tolerant, tolerant and
hyper-tolerant categories. The threshold depends on the reliability of
the list of pseudo-genes and gene annotations. Pseudogenes are a regu-
lar feature of bacterial genomes, which are DNA sequences that are
closely related to functional genes but have mutations that destroy the
function (Kuo and Ochman, 2010; Lerat and Ochman, 2005). They
are usually identified by comparison with the functional sequence in a
close relative (‘allele’ if in the same species, ‘homlog’ if in another spe-
cies; Lerat and Ochman, 2005 ). The mutations in pseudogenes intro-
duce premature stop codon or frame-shift, and then prevent normal
translation of a functional protein. In terms of nucleotide composition
and length, they are similar to other genes in their genomes. Among
different strains of C. jejuni, we found that the number of pseudogenes
ranges from 18 (i.e. in IA3902) to a few hundreds, which account for
about 1—10% of the open reading frames of their genomes. In other
taxa, pseudogenes were commonly found to be at the similar ratio, as
revealed in Staphylococcus pyogenes, Vibrio vulnificus, Vibrio para-
haemolyticus, Yersinia pestis and Salmonella (Kuo and Ochman,
2010; Lerat and Ochman, 2005). In experiments where several
growth conditions are included, our method can be easily generated to
those applications by involving growth conditions as factors in model-
ing the insertion probability and the Poisson mean.

Our proposed method allows incorporation of covariates into
the ZIP model and accommodates factors that might affect the inser-
tion rate. In the real data analysis, we quantified the increased inser-
tion probability for the insertion sites matching the target sequence
of the Tn5 transposon. Such quantification provides insights into
the mechanism of transposon insertion. Besides matching with tar-
get sequence, other factors that may potentially affect the trans-
poson insertion rate can also be fit into the ZIP model and tested for
significance. Factors that may affect the mean abundance (ug) may
also be incorporated into the model through Poisson regression.

Large sample theory is implemented in our method while applying
the Wald test. In our Tn-seq data, we have more than one million loca-
tions, which justifies the large sample assumption is satisfied. The esti-
mated values of mean abundance have been used to classify normal
genes into the three tolerance groups. In addition, the magnitude of
the estimated values of mean abundance measures how important the
corresponding genes are with respect to bacterial growth. If the esti-
mated mean mutants abundance of a normal gene is far above that of
pseudogenes, this suggests that the inactivation of this normal gene by
transposon insertion provides an obvious growth advantage. On the
other hand, if the estimated mean mutants abundance of a normal
gene is far below that of pseudogenes or even close to zero, this normal
gene may have essential function on bacterial growth.

To test for finite sample behavior of our method, we also tried a
simulation study in which only several genes were simulated and we
varied the number of possible insertion locations for each gene to
check when our method is applicable, and it turns out that the result
is good enough as long as the number of possible insertion locations
is 50 or more.

Conﬂict of Interest: none declared.

References

Benjamini,Y. and Hochberg,Y. ( 1995 ) Controlling the false discovery rate: a
practical and powerful approach to multiple testing. ]. R. Stat. Soc. Ser. B,
57, 289—300.

Chao,M.C. et al. (2013) High resolution deﬁnition of the Vibrio cholerae es-
sential gene set with hidden Markov model-based analyses of transposon-in-
sertion sequencing data. Nucleic Acids Res., 41, 9033—9048.

Dempster,A.P. et al. (1977) Maximum likelihood estimation from incomplete
data via the EM Algorithm (with discussion). ]. R. Stat. Soc. Ser. B, 9, 1—38.

Dejesus,M.A. and Loerger,T.R. (2013) A Hidden Markov Model for identify-
ing essential and growth-defect regions in bacterial genomes from trans-
poson insertion sequencing data. BMC Bioinf., 14, 303.

Delong,W.J. et al. (1996) Antigenic and restriction enzyme analysis of
Campylobacter spp. associated with abortion in sheep. Am. ]. Vet. Res., 5 7,
163—167.

Deng,]. et al. (2013) A statistical framework for improving genomic annota-
tions of prokaryotic essential genes. Plos One, 8, e58178.

Gerdes,S.Y. et al. (2003) Experimental determination and system level analysis
of essential genes in Escherichia coli MG1655. ]. Bacteriol., 185,
5673—56 84.

Goryshin,I. et al. (1998) Tn5/1550 target recognition. Proc. Natl. Acad. Sci.,
95, 10716—10721.

Green,B. et al. (2012) Insertion site preference of Mu, Tn5, and Tn7 trans-
posons. Mob. DNA, 3.

Herron,P.R. et al. (2004) Transposon Express, a software application to report
the identity of insertions obtained by comprehensive transposon mutagen-
esis of sequenced genomes: analysis of the preference for in vitroTn5 trans-
position into GC-rich DNA. Nucleic Acids Res., 32, e113.

Kuo,C.H. and Ochman, H. (2010) The extinction dynamics of bacterial
pseudogenes. PLOS Genet., 6.

Lambert,D. (1992) Zero-inﬂated Poisson regression, with an application to de-
fects in manufacturing. Technometrics, 34, 1—14.

Lampe,D.]. et al. ( 1996 ) A puriﬁed mariner transposase is sufﬁcient to mediate
transposition in vitro. Eur. Mol. Biol. Organ. ]., 15, 5470—5479.

Langridge,G.C. et al. (2009) Simultaneous assay of every Salmonella typhi
gene using one million transposon mutants. Genome Res., 19, 2308—2316.

Lerat,E. and Ochman, H. (2005) Recognizing the pseudogenes in bacterial
genomes. Nucl. Acids Res., 33, 3125—3132.

Pritchard,].R. et al. (2014) ARTIST: high-resolution genome-wide assessment
of ﬁtness using transposon-insertion sequencing. PLOS Genet., 10,
e1004782.

van Opijnen,T. and Camilli,A. (2014) Transposon insertion sequencing: a new
tool for systems-level analysis of microorganisms. Nat. Rev. Microbiol., 11,
435—442.

Sahin,O. et al. (2012) Molecular evidence for zoonotic transmission of an
emergent, highly pathogenic Campylobacter jejuni clone in the United
States. ]. Clin. Microbiol., 50, 680—687.

Sahin,O. et al. (2008) Emergence of a tetracycline-resistant Campylobacter
jejuni clone associated with outbreaks of ovine abortion in the United
States. ]. Clin. Microbiol., 46, 1663—1671.

Storey,J.D. and Tibshirani,R. (2003) Statistical signiﬁcance for genomewide
studies. Proc. Natl. Acad. Sci., 100, 9440—9445.

Wiles,T.J. et al. (2013) Combining quantitative genetic footprinting and trait
enrichment analysis to identify ﬁtness determinants of a bacterial pathogen.
PLOS Genet., 9, e1003716.

Zhang,Y.]. et al. (2012) Global assessment of genomic regions required for
growth in Mycobacterium tuberculosis. PLOS Pathog., 8, e1002946.

Zhang,Y.]. et al. (2013) Tryptophan biosynthesis protects mycobacteria from
CD4 T-cell-mediated killing. Cell, 155, 1296—1308.

Zomer,A. et al. (2012) ESSENTIALS: software for rapid analysis of high
throughput transposon insertion sequencing data. Plos One, 7, e43012.

9mg ‘09 1sn8nV uo sejeﬁuV SO’I ‘121u10111123 10 A11819Atuf1 112 /810'S{12umo[pJOJXO'sot112u1101utotq//:d11q 111011 pepeolumoq

