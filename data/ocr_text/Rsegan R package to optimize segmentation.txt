APPLICATIONS NOTE

Vol. 27 no. 3 2011, pages 419-420
doi: 1 0. 1 093/bioinformatics/btq668

 

Genome analysis

Advance Access publication December 5, 2010

Rseg—an R package to optimize segmentation of SNP array data
Philippe Lamy1’2’*, Carsten Wiuf2 , Torben F. @rntoft1 and Claus L. Andersen1

1Department of Molecular Medicine, Aarhus University Hospital Skejby, Aarhus N and 2Bioinformatics Research

Center, Aarhus University, Aarhus, Denmark
Associate Editor: Dmitrij Frishman

 

ABSTRACT

Summary: The use of high-density SNP arrays for investigating
copy number alterations in clinical tumor samples, with intra tumor
heterogeneity and varying degrees of normal cell contamination,
imposes several problems for commonly used segmentation
algorithms. This calls for flexibility when setting thresholds for calling
gains and losses. In addition, sample normalization can induce
artifacts in the copy-number ratios for the non-changed genomic
elements in the tumor samples.

Results: We present an open source R package, Rseg, which allows
the user to define sample-specific thresholds to call gains and losses.
It also allows the user to correct for normalization artifacts.
Availability: The R package, Rseg, is available at: http://www.cs.au
.dk/~plamy/Rseg/ and runs on Linux and MS-Windows.

Contact: plamy@cs.au.dk

Supplementary information: Supplementary data are available at
Bioinformatics online.

Received on August 12, 2010; revised on November 24, 2010;
accepted on November 25, 2010

1 INTRODUCTION

Affymetrix SNP arrays have been used to estimate genomic copy
numbers in tumor samples (Beroukhim et al., 2010). Different
methods have been developed to segment the genome into
contiguous regions that share the same copy number on average.
These include CBS, GLAD and more recently Ultrasome (Nilsson
et al, 2009; Venkatraman and Olshen, 2007). Ultrasome is the fastest
method and gives similar output as CBS. However, Ultrasome does
not allow to correct for artifacts induced by the normalization of the
arrays. In fact, when there is an imbalance between gains and losses,
commonly used normalization methods like quantile and invariant
set normalization introduce a systematic shift in the copy numbers
estimated for normal regions so that they appear as if they have an
altered copy number. That is, if a sample contains only two different
copy numbers, then normalization will make the regions with no
change in copy number appear as being slightly lost or gained
(cf patient A in Fig. 1). While this problem could potentially be
overcome using a different normalization procedure, an alternative
would be to use the intensities distribution to correct for it.
Generally, segmentation algorithms apply a common threshold for
calling gains and losses for all investigated samples. However, when
applied to tumor samples this often imposes a problem, as several

 

*To whom correspondence should be addressed.

sample speciﬁc factors like the level of normal cell contamination,
intra tumor heterogeneity, and technical noise affects the resolution
with which different copy number levels can be discerned. This calls
for an option to set sample speciﬁc thresholds.

In this article, we describe an R package that guides the user
through the segmentation of each sample. Histograms of the log
ratio copy number between a tumor and its matched germline sample
can distinguish between different copy numbers (represented by
different peaks—cf Fig. 1). Therefore, by modeling each peak and
by selecting the peak representing segments with no copy number
change and its neighbors, correction for the normalization induced
copy number and optimal thresholds for calling gains and losses can
be statistically deﬁned.

2 DESCRIPTION

The Rseg package provides different tools to efﬁciently optimize
the segmentation of copy number data produced using SNP arrays
(cf Supplementary Figure SI for an overview). It takes as an input a
copy—number ﬁle (.cn), for example produced by aroma.affymetrix
(Bengtsson et al., 2009). This ﬁle contains for each probe and for
each array the log ratio of the intensity between a tumor sample and
a matched germline sample (or an average germline sample).

First Ultrasome is applied to segment the data with parameter
1:0.001 (other algorithms can be used as well, e. g. CBS). Then, a
multi—step protocol is applied to each sample:

0 The segmented data is plotted as a histogram of weighted
segment values (the weight is the number of markers in the
segment).

0 The user inputs the number of peaks and marks them manually.
This step is difﬁcult to automate due to often noisy nature of
the data (cf patient B in Fig. 1).

0 The program models each peak using a Laplace or a Gaussian
distribution (Fig. 1, center section).

0 The user selects the peak representing the segments with no—
copy—number change and the two peaks surrounding it.

0 The program uses a rigorous statistical procedure to deﬁne the
shift (difference from the log—ratio = 0 to the mean of the log—
ratios of the no—change peak) and the thresholds for calling
gains and losses (deﬁned by minimizing the false negative and
false positive call rate).

The last step produce the ﬁnal segmentation taking into account
shift and thresholds determined for each sample (Fig.1, right
section). The output ﬁle is a segmentation ﬁle (.seg) and can be

 

© The Author 2010. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oup.com 419

112 /§.IO'SIBUJHOprOJXO'SOTlBIIIJOJUTOTQ/ﬁdnq 11101; prBOIUAAOG

9IOZ ‘09 lsnﬁnv uo ::

RLamy et aI.

 

 

 

Deﬁning the shift and the threshold

Raw data: difference in log copy number

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

Histogram of difference tumor/germline , ,  o .
for calling losses and gain E In tumor/germline
:— o
_. uncorrected no Chan e 2 _ Shift:O_075 Ev; "" Chromosome3 Chromosome4
O I I I :— g Thres.=_0.O4/O'Ig o 0. ._.========nchrgggo£%t§I-=======
o Chromosome 3 Thres. 0.07/0.07 E h- a
o _ I I I I w 3 O noc ange uncorrecte
>8 Chromosome4 I I I I IThres.=—O.15/O.15 4; _
o
U ‘— I I I I I U ,_- _
< a: _ I I I I I ‘0 — E; I I I I I
I_ g I I I I I g 30:1 0 1e+08 2e+08 3e+08 4e+08
b q- _ .—
2 LI- 0 I I I I I O 0
LE 8 _ I I I I I II Segment copy number
I— 8 l I I N — I I Ultrasomethres:0.15
E I I I III II II I I
o —- I I I I I o — Ultrasomethres:0.07
I I I I I I I I I I | |
—1 .0 —0.5 0.0 0.5 1.0 —1.0 —0.5 0.0 0.5 1 .0 Rseg
Difference tumor/germline Difference tumor/germline I I
a) loss no change gain
c
E o
m I\ Shift:0_02 811—" _ Chromosome3  Chromosome4
lUncorrected no change 1 Thres _ 0 02/0 06 E !
.—— . . O
8 Chromosome3 I I 'Thres.=—0.07/0.07 \o E O _ . . _ _ _ _ __“°_CII;.arEe COL“??? . _ _ _ _ _ _
o _ I I I 3 O DOC ange uncorre e
>8 Chromosome4 I I I I IThres.=—O.15/0.15 In _ Z —
0
U '— I | I | I U I. _ _
m 5 _ I I I I I ><r — E; I I I I I I
I_ 0% I I I I I  m _ In; 0 1e+08 2e+08 3e+08 4e+08
Z II o I I I I I ‘1’ I Q
E g“ I I I I I Q N _ I Segment copy number
I_ In I l I l L Ultrasomethres:0.15
< I I F ‘ I III I l I I
r' I"'
D- 0 an —-- ‘- I o u—- r- -“IJ i"- I'--‘ I'- 1' '1- Ultrasome thres:0.07
I l I

I
I | I I | |
—1 .0 —0.5 0.0 0.5 1.0 —1.0 —0.5

Difference tumor/germline

Difference tumor/germline I

I | | l I
0.0 0.5 I .0 Rseg

 

 

Fig. 1. Optimization of genomic segmentation for two tumor samples using Rseg. Initially data were segmented using Ultrasome with minimal threshold for
calling gains and losses. On the left are shown histograms of the initial segment copy numbers (in grey) for all chromosomes, in blue and red are overlain
the segment copy number for chromosome 3 and 4, respectively. The histograms distinguish different copy numbers in the sample as different peaks. To
understand the effect of choosing a non—sample—speciﬁc threshold for calling abnormalities, the uncorrected no—change line and two different thresholds were
plotted. In the middle part of the ﬁgure, the same histograms were plotted together with the shift of the no—change peak (in red) and the sample—speciﬁc
thresholds (in green). Each peak was modeled as a Laplace distribution (in blue). The right part of the ﬁgure shows the raw data for chromosomes 3 and 4,
and the ﬁnal segmentation using Ultrasome (with two different thresholds: 0.15 and 0.07) and Rseg.

visualized using the Integrative Genomics Viewer (IGV) software
(http://www.broadinstitute.org/igv).

3 METHODS

Prerequisites Ultrasome (can be downloaded from the Broad Institute web
pages).

Input: Rseg contains different methods. Some requires a segmentation
ﬁle (.seg) that can be produced by Ultrasome or some other segmentation
algorithm and others requires a copy—number ﬁle (.cn).

Functions: Before the segmentation, noise reduction e. g. by smoothening
the copy—number ﬁle (.cn) can be performed using the function
smooth_CNﬁle. The segmentation can be done in R by using the function
run_ultras0me where the arguments are the same as required by Ultrasome.
The deﬁnition of the sample—speciﬁc shift and threshold for calling gains or
losses is done by using the function segment_all or the function modelGL
for a single sample using Laplace functions and/0r Gaussian functions. The
ﬁnal segmentation is done using the function apply_coef or the function
modify_seg for a single sample. Finally, you can run all these steps in one
go by using the function runRseg (see the help ﬁles for more information).

Output: The main output is the ﬁnal segmentation ﬁle where a combination
of sample—speciﬁc shift correction and threshold for calling gains and losses
has been used. This ﬁle can be visualized using IGV. Other outputs include a
pdf ﬁle for each sample showing the distribution of the weighted segments,

its modelization and the shift and thresholds applied and a txt ﬁle containing
information about the parameters and some statistics.

Funding: This work was supported by the Nordic Center of
Excellence, the EU project GENICA, The John and Birthe Meyer
Foundation, The Danish Council for Independent Research Medical
Sciences, the Lundbeck Foundation, the Danish Cancer Society and
The Danish Ministry of the Interior and Health.

Conﬂict of Interest: none declared.

REFERENCES

Bengtsson,H. et al. (2009) A single-array preprocessing method for estimating full-
resolution raw copy numbers from all Affymetrix genotyping arrays including
GenomeWideSNP 5 & 6. Bioinformatics, 25, 2149—2156.

Beroukhim,R. et al. (2010) The landscape of somatic copy-number alteration across
human cancers. Nature, 463, 899—905.

Integrative Genomics Viewer (IGV). Available at http://www.broadinstitute.0rg/igv.

Nilsson,B. et al. (2009) Ultrasome: efﬁcient aberration caller for copy number studies
of ultra-high resolution. Bioinformatics, 25, 1078—1079.

Venkatraman,E.S. and Olshen,A.B. (2007) A faster circular binary segmentation
algorithm for the analysis of array CGH data. Bioinformatics, 23, 657—663.

 

420

112 /§JO'SIBUJROIPJOJXO'SOIlBIHJOJUIOICI/ﬁdnq 11101; prBOIUAAOG

9IOZ ‘09 lsnﬁnv uo ::

