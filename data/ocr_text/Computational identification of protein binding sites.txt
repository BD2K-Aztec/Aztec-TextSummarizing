ORIGINAL PAPER

Vol. 30 no. 8 2014, pages 1049—1055
doi:10. 1 093/bioinformatics/btt75 7

 

Genome analysis

Advance Access publication December 27, 2013

Computational identification of protein binding sites on RNAs
using high-throughput RNA structure-probing data
Xihao Hui, Thomas K. F. Wongz’s, Zhi John Lu4, Ting Fung Chan5’6,

Terrence Chi Kong Lau7, Siu Ming Yiu3 and Kevin Y. Yip

1,5,*

1Department of Computer Science and Engineering, The Chinese University of Hong Kong, Shatin, New Territories,
Hong Kong, 2Department of Computer Science, The University of Hong Kong, Pokfulam Road, Hong Kong, 3CSIRO
Ecosystem Sciences, Canberra, ACT 2601, Australia, 4MOE Key Laboratory of Bioinformatics, School of Life Sciences,
Tsinghua University, Beijing, China 100084, 5School of Life Sciences, 6Hong Kong Bioinformatics Centre, The Chinese
University of Hong Kong, Shatin, New Territories, Hong Kong and 7Department of Biology and Chemistry, City University

of Hong Kong, Tat Chee Avenue, Kowloon, Hong Kong
Associate Editor: Inanc Birol

 

ABSTRACT

Motivation: High-throughput sequencing has been used to probe
RNA structures, by treating RNAs with reagents that preferentially
cleave or mark certain nucleotides according to their local structures,
followed by sequencing of the resulting fragments. The data produced
contain valuable information for studying various RNA properties.
Results: We developed methods for statistically modeling these struc-
ture-probing data and extracting structural features from them. We
show that the extracted features can be used to predict RNA ‘zip-
codes’ in yeast, regions bound by the She complex in asymmetric
localization. The prediction accuracy was better than using raw RNA
probing data or sequence features. We further demonstrate the use
of the extracted features in identifying binding sites of RNA binding
proteins from whole-transcriptome global photoactivatable—
ribonucleoside—enhanced cross-linking and immunopurification
(gPAR-CLIP) data.

Availability: The source code of our implemented methods is available
at http://yiplab.cse.cuhk.edu.hk/probrna/.

Contact: kevinyip@cse.cuhk.edu.hk

Supplementary information: Supplementary data are available at
Bioinformatics online.

Received on November 5, 2013; revised on December 8, 2013;
accepted on December 13, 2013

1 INTRODUCTION

Next-generation sequencing technologies have created opportu-
nities for studying many diverse properties of nucleic acids in a
high-throughput manner. Recently, it has been used to probe
RNA structures, which reveals interesting properties of RNA,
including the largely unexplored mRNA structures (Kertesz
et al., 2010; Lucks et al., 2011; Underwood et al., 2010). One
method involves treating RNAs with an enzyme that preferen-
tially cleaves either double-stranded (such as RNase V1) or
single-stranded (such as S1 nuclease and P1 nuclease) nucleic
acids, and sequencing the resulting fragments (Kertesz et al.,
2010; Underwood et al., 2010). Paired and unpaired nucleotides

 

*To whom correspondence should be addressed.

can then be deduced by comparing the distributions of read
counts under the two different enzymatic treatments or by com-
paring with a control. Another method is based on Selective
2’-Hydroxyl Acylation analyzed by Primer Extension (SHAPE)
chemistry (Mortimer and Weeks, 2007). RNAs are treated with a
SHAPE reagent, which chemically modiﬁes the 2’-hydroxyl
groups with reactivity at individual nucleotides depending
on their local spatial disorder. The treated RNAs are then re-
verse-transcribed and subsequently sequenced. Because reverse
transcription is blocked by the SHAPE adducts, the distribution
of read counts can serve as an indicator of local structures
(Lucks et al., 2011).

For both methods, specialized algorithms have been proposed
for processing the sequencing reads and analyzing the read
counts (Aviran et al., 2011; Kertesz et al., 2010; Lucks et al.,
2011; Underwood et al., 2010). These algorithms were designed
to consider special properties of the corresponding experiments.
For example, in SHAPE sequencing, reverse transcription could
be stopped either by a SHAPE adduct or due to natural poly-
merase drop off. Different statistical models were designed for
these processes for estimating the reactivity of the SHAPE
reagent at each nucleotide.

In addition to these method-speciﬁc factors, read counts may
also be affected by biases common to many sequencing proto-
cols. For example, GC-rich regions may have more reads than
AT—rich regions (Dohm et al., 2008). Primer binding and ampli-
ﬁcation efﬁciency also depend on local sequences (Li et al.,
2010).

Here we show that statistical models that explicitly consider
potential sequence-speciﬁc biases can be used to ﬁt these high-
throughput structure-probing data. The effectiveness of our
models is demonstrated by a better goodness of ﬁt to the data
than some other models based on a cross-validation procedure.

To further explore the utility of our models, we show that
features of structure-probing data extracted by our models can
be used to locate zipcodes on yeast mRNAs, which are regions
bound by the She complex in asymmetric localization (Shepard
et al., 2003). Previous studies have shown that localization activ-
ity depends on secondary structure (Chartrand et al., 1999;
Gonzalez et al., 1999). A short sequence motif involving a

 

© The Author 2013. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com 1049

112 ﬁle'slcumo[pJOJXO'sopchOJuioiq/ﬁd11q IIIOJJ pepcolumoq

910K ‘09 lsnﬁnV no :2

X.Hu et al.

 

CGA triplet in a loop and a conserved cytosine six bases away in
another loop has also been shown to be necessary for bud local-
ization of several RNAs (Olivier et al., 2005). Nonetheless, these
criteria are not sufﬁcient to identify all zipcodes (Shepard et al.,
2003). It has been suggested that recognition and transport
depend not only on the zipcodes but also on adjacent sequence
and structural features (J ambhekar et al., 2005). We show that
our extracted features could help distinguish zipcodes from other
regions on the same mRNAs with good accuracy.

There exist experimental methods for transcriptome-wide
identiﬁcation of RNA regions bound by a speciﬁc RNA binding
protein (RBP). The main idea is to crosslink RBPs with RNAs,
followed by immunoprecipitation (CLIP) and microarray ana-
lysis or sequencing. The latter includes methods known as HITS-
CLIP (Licatalosi et al., 2008), CLIP-seq (Sanford et al., 2009),
PAR-CLIP (Hafner et al., 2010) and RIP-seq (Zhao et al., 2010).

As these large-scale datasets become available for more RBPs,
it is interesting to ask whether different RBPs recognize similar
features at their binding sites. It has recently been shown that a
common set of features can be used to identify RNAs targeted by
a group of different RBPs (Pancaldi and Bahler, 2011), although
in the same study it is also shown that if the training set lacks any
known targets of an RBP, the resulting statistical model is less
capable of identifying its targets, indicating that the model may
not have captured the binding site signals recognized by all
RBPs. Here we use our extracted features from RNA struc-
ture-probing data to study this question in a different way, and
ask if it is possible to build statistical models that can distinguish
general RBP binding sites from other regions. Using a whole-
transcriptome dataset of RBP binding sites, we show that such a
model can be constructed with high distinguishing power using a
small set of features, which supports the idea that different RBPs
may share similar recognition signals of their targets.

2 MATERIALS AND METHODS

The overall workﬂow is illustrated in Supplementary Figure S1. The
following sections provide details of different parts of the workﬂow.

2.1 RNA structure-probing data

We used a published transcriptome—wide structure-probing dataset in
yeast (Kertesz et al., 2010) for our study, as we also had access to
other types of yeast data needed for our study. The experiments that
produced the data involved treatments of two enzymes, namely RNase
V1 and S1 nuclease, which preferentially cleave phosphodiester bonds
3’ of double-stranded RNA and single-stranded RNA, respectively. The
sequencing data from each enzymatic treatment were individually nor-
malized, and the log ratio between the normalized V1 and S1 read counts
at each nucleotide was deﬁned as the PARS (Parallel Analysis of RNA
Structure) score of the 5’ adjacent nucleotide (Kertesz et al., 2010).
Strongly positive and negative PARS scores indicate a high chance for
the nucleotide to be base-paired and single-based, respectively. For sim-
plicity, we will call the number of reads attributed to the structure of a
certain nucleotide its ‘read count’, although these reads start at its
3’ adjacent nucleotide.

2.2 Statistical models

For each enzymatic treatment, we propose a mixture of Poisson linear
model to relate properties of each nucleotide and its observed read count.
Our model is based on a Poisson linear model previously proposed for

counting sequencing reads that start at a particular nucleotide (Li et al.,
2010), which matches the situation of our data:

nij ~ Poisson(,u,-j), where

K

(1)

1n Mij =1nMi+ 0! + Z Z ,Bthbijk = h)
k=1 he{A, C, G}

In the equation, nij is the observed read count of nucleotide j of tran-
script i (i.e. the number of reads starting at the nucleotide), which is
distributed according to a Poisson distribution with mean ,uij. ,uij in
turn depends on la, the unknown expression level of transcript i, and
biases due to the local sequence within a window of size K centered on
nucleotide j. Both the identity and position of the nucleotides within the
window affect how they inﬂuence the read count of nucleotide j, and their
total inﬂuence is assumed to take on a linear form with offset a and
coefﬁcients ,Bkh (no variables are deﬁned for Uracils, as their values can
be ﬁxed at 0), where 1(ka = h) is 1 if the k-th nucleotide within the
window is h, and 0 otherwise. The model is general enough to capture
many types of biases due to local sequence features. The values of the
parameters 0 = {,ui, a, 1%,} are to be determined such that the following
log-likelihood function is maximized:

e‘mf 
L(0) =ln1_[Pr(n,-j|0) = ZmT (2)
M Li ’1 '

For the structure-probing data we used, as an enzyme could have
different probabilities of cleavage for different groups of nucleotides
(such as paired versus unpaired bases), we extend the model by introdu-
cing a mixture of components, with each component representing a group
of nucleotides. The resulting log-likelihood function is as follows:

L(0) = ZanPﬂziLg = 1)Pr(n,-,-|z,-j,g = 1,9)

i, j geG 

e—l/«ij,g [Lg-jg

= In ‘L’ —’

where G represents the different components of the mixture model, 2,]; g is

a group membership variable, which equals 1 if nucleotide j of transcript i

belongs to group g and 0 otherwise, tg (i=EfPr(z,-j,g = 1) is the prior prob-

ability that a nucleotide belongs to group g and ,uiLg is the average read

count of nucleotides of transcript i that belong to group g.

Correspondingly, there is a separate set of parameters, ag and ,Bkhg for

each group. In this work we consider only two-component models, i.e.

G = {1,2}, as they correspond to some natural assumptions to be dis-
cussed below.

To check the need for considering local sequence biases and for a
mixture model, we also considered two simpler models for comparison
purposes. The ﬁrst one is the original Poisson linear model with only one
component [Equation (1)]. The second one is a Poisson mixture model
that does not consider local sequences, which is equivalent to our model
with org and ,Bkh,g all set to zero.

2.3 Optimization algorithms for data ﬁtting

2.3.1 Fitting data from one enzymatic treatment Given a sequen-
cing dataset with a particular enzymatic treatment, we used optimization
algorithms to (locally) maximize the data likelihood of the different
models. For the single-component Poisson linear model, we implemented
the method described in Li et al. (2010). For our mixture model, we
developed an algorithm based on the expectation-maximization (EM)
framework (Dempster et al., 1977). EM considers three types of data,
which in our case include the observed read counts (X = {nij}), hidden
group membership variables (Z = {ziJ-,g}) and model parameters
(0 = {ai,g,06g, ,Bkh,g, tg}). If the values of the hidden variables were
observed, it would be easier to compute data likelihood and ﬁnd

 

1 050

112 ﬁle'sleumo[pJOJXO'sonemJOJuioiq/ﬁd11q IIIOJJ pepeolumoq

910K ‘09 lsnﬁnV no :2

Computational identification of protein binding sites on RNAs

 

parameter values that maximize it. Because these values are actually
unobserved, the EM procedure instead iteratively maximizes the
expectation of the log-likelihood of the full data,
EZIX,9(t_1)[ln Pr(X, Z|0)] = :2 [Pr(le, 0(t_1))lnPr(X,z|0)], where 00—1) is
the estimated parameter values in the (t — 1)-th iteration. The procedure
repeatedly derives the expression of this expected log-likelihood in the
E—step and ﬁnds values of the parameters that maximize it in the M-step,
until a certain stopping criterion is reached.

For our mixture model, it is possible to derive closed-form formulas
for at g and tg that maximize the expected log-likelihood, but it is difﬁcult
for org and 13km. Following Li et al. (2010), we searched for the optimal
values of these two sets of parameters in turn, using closed-form formulas
and numerical methods, respectively. A summary of the whole algorithm
is given below. Detailed derivations can be found in the Supplementary
Materials.

(1) Deﬁne variables 2%?) and initialize each of them with a random
value from (0, 1) such that deG Egg 2 1.
XII-1:1 217$an
li
2215331;

the length of transcript i. For each iteration t: 1,2,..., repeat

’1' -<.9>
(2) Initialize MS); to and 1'?) t0  Where 11' iS

steps 3—8:

(3) Viewing agfg—l) as offsets and 2%?) as weights, ﬁt the generalized
linear model with a log link function in the Poisson family to get

(t) (0

Gig and  1(t—1)Pr(n_.lz_. :1 90—1))

(4) Redeﬁne 21.]. g as g ‘1 ‘J’g ’ .

i Z [iii—1)Pr("vlzi.g'=1a9(’_l))]

’1 22.. 

 iii—gm exp [ag)+2:=1 Zhem, C, G} ﬂirt/)IeKb’jkzhil

(6) If  >  for a transcript i, swap their values as well as those of

Egg—11) and Egg—21) for all nucleotides j on i.

22:: 553—1)
 Update T1?) t0 

 

 

(5) Update air; to

(8) Go to step 3 unless the deviance (deﬁned in the Section 2.4) de-
creases by <0.01%.

In the algorithm, we ﬁrst initialize variables 2,]; g to random values, and
[Li’g and ‘L’g to corresponding weighted means of them (steps 1—2). The
algorithm then repeats steps 3—8 for iterations. In step 3, we ﬁx the values
of at g and 2,7, g using the estimates from the previous iteration, and solve
the resulting Poisson regression problem by iterative reweighting least-
square (Li et al., 2010) to get ag and ﬁlm, g. In step 4, the variables 2,]; g are
formally deﬁned as the expected group membership of nucleotide j of
transcript i based on the parameter estimates in the previous iteration. In
step 5, the values of at g are updated to ones that maximize the expected
log-likelihood expression obtained in the E-step. In step 6, we deﬁne the
group with a smaller mean as group 1, and swap the related parameters if
necessary. In step 7, we update the values of tg to the ones that maximize
the expected log-likelihood. Finally, in step 8, we check if the change of
deviance is smaller than a threshold, to determine whether to stop the
execution or to enter the next iteration. In practice, the deviance value
converges quickly and the algorithm requires only a small number of
iterations (Supplementary Tables S1 and S2).

For the mixture of Poisson model that does not consider local se-
quences, we estimated its parameters by modifying our algorithm with
org and ,Bkhg ﬁxed to zero.

2.3.2 Fitting data from both enzymatic treatments In the algo-
rithm above, we compute an expected group membership value, 2mg,
for each nucleotide j. These variables were later used to derive structural
features for our applications in two different ways. The ﬁrst way was to
ﬁt each dataset (V1 and S1) independently and treat the variable from
each as a separate feature. Another way was to coordinately estimate the

parameters for both datasets, with additional constraints imposed on the
variables. The details are given in the Supplementary Materials. Here we
outline the high-level ideas.

We tested two constraints based on two corresponding assumptions.
The ﬁrst assumption is that the two mixture components correspond to
unpaired and paired bases, respectively. Because RNase V1 and S1 nu-
clease have opposite preferences for these two types of bases, we would
expect paired bases to have higher V1 and lower S1 read counts than
unpaired bases. If we deﬁne g = 1 and g = 2 as the groups of unpaired and
paired bases, respectively, we would expect for any transcript i, a“ < at 2
for the V1 dataset and a“ > at 2 for the S1 dataset. In any EM iteration,
we imposed these two conditions as a constraint by swapping the mem-
bership values of the two groups in a dataset if it was violated. We call
this approach coordinated model ﬁtting with opposite group
memberships.

We also tested a different assumption, that in general nucleotides with
more reads in one dataset would also have more reads in the other. This
could be caused by the accessibility of nucleotides in the 3D structure. In
this case, if g=1 and g=2 represent the groups of less accessible and
more accessible nucleotides, respectively, a“ should be smaller than at 2
in both datasets for any transcript i. Again, we set these as a constraint
and swapped group memberships if violated. We call this approach coor-
dinated model ﬁtting with consistent group memberships.

For the mixture of Poisson model not considering local sequences, we
ﬁtted the models for the V1 and S1 datasets independently, and used their
2,]; g variables as two separate features. We compared these features with
those from our mixture of Poisson linear models in predicting RNA
zipcodes (see below). As the one-component Poisson linear model does
not have group membership variables, we did not use it to predict RBP
binding sites.

Table 1 summarizes the models we compare in this study.

2.4 Evaluation of ﬁtness to the sequencing data

We measured the goodness-of—ﬁt of a model by its R2, which is deﬁned as
1 — 0%, where d and do are the deviance of the model and the correspond-
ing null model, respectively (Cameron and Windmeijer, 1996). The devi-
ance compares the likelihood of a model with a full model where each
observation has its own set of parameters. The formulas of R2 for the
various models and their derivations are given in the Supplementary
Materials.

To compare the data ﬁtness resulted from the different models, we
used a 5-fold cross-validation procedure as follows. Each time, we used
the sequences and observed read counts of four-ﬁfth of the genes in our
dataset to perform model ﬁtting and get the optimized parameter values.
We then used the model with these ﬁtted values to predict the read counts
of the remaining one-ﬁfth of genes based on their sequences only. The
predicted and actual read counts were then compared to compute the R2
values. The cross-validation procedure ensures that the reported average
accuracy reﬂects the ability of a model in capturing the general properties
of RNA structures rather than over-ﬁtting the training data, as the latter
would result in low testing accuracy. With 94 962 nt from 119 genes, the
dataset was large enough to ensure the robustness of the 5-fold cross-
validation procedure. For the mixture of Poisson model that does not
consider local sequences, we report the total R2 from cross-validation by
taking the sums of d and do as the total deviances of the model and the
corresponding null model from the ﬁve testing sets, respectively. Our
algorithms in general return models that locally maximize the corres-
ponding likelihood functions, which are related to, but are not equivalent
to, the goodness-of—ﬁt function.

2.5 List of RNA zipcodes

To compare the effectiveness of different types of features in predicting
RNA zipcodes, we collected experimentally veriﬁed zipcodes from two

 

1051

112 ﬁle'sleumo[pJOJXO'sor1emJOJurorw/2d11q IIIOJJ pepeolumoq

910K ‘09 lsnﬁnV no 22

X.Hu et al.

 

Table 1. List of statistical models for ﬁtting structure-probing data

 

 

Abbreviation Description

PL One-component Poisson linear model (Li et al., 2010)

MP Mixture of Poisson model not considering local
sequences

MPLa Mixture of Poisson linear model, ﬁtting V1 and S1
independently

MPLC samea Mixture of Poisson linear model, ﬁtting V1 and S1
coordinately with consistent group memberships

MPLC oppoa Mixture of Poisson linear model, ﬁtting V1 and S1

coordinately with opposite group memberships

 

aModels proposed in this work.

published studies (J ambhekar et al., 2005; Olivier et al., 2005). After
quality control and intersecting with our structure-probing data
(Supplementary Materials), we obtained a list of 10 zipcodes on 6
genes (Table 2).

2.6 List of protein-RNA binding sites

We further checked if our features can be used to predict general RBP
binding sites. We obtained a whole-transcriptome dataset of RBP-binding
regions in yeast (Freeberg et al., 2013), produced by global photoactiva-
table-ribonucleoside-enhanced cross-linking and immunopuriﬁcation.
We ﬁltered out fragmented regions and focused on those between 10
and 40 bases, which is a range shown to include the majority of binding
sites (Freeberg et al., 2013). The resulting list contains 42 344 RBP-bind-
ing regions on 2972 genes. The nucleotide composition of these regions is
shown in Supplementary Table S3. Because small read counts are more
affected by noise, we considered only transcripts with RPM (reads per
million) >1000 when training and testing the prediction models
(Supplementary Table S4). We also obtained a set of regions bound by
the Puf3p protein from the same study, with 831 binding regions on
668 genes.

2.7 Machine learning and prediction procedures

For the prediction of RNA zipcodes, we deﬁned positive examples as nu-
cleotides within these zipcodes, and negative examples as all other nucleo-
tides from the same RNAs. For each nucleotide, we derived various types
of features of it (Table 3). PARS is the log ratio of V1 and S1 read counts
(Kertesz et al., 2010). PARS2 is the square of PARS, which indicates
whether a nucleotide is clearly single-based or base-paired. LogVS includes
the logarithm of the V1 and S1 read counts as two separate features.
ProbVS contains the expected group membership variables from one of
our Poisson linear models (to be speciﬁed below). For both the one-com-
ponent model and two-component models that ﬁt V1 and S1 either inde-
pendently or coordinately, there are two features per nucleotide. PredSS2 is
the probability for a nucleotide to be base-paired according to RNAfold
(Hofacker et al., 1994). PredSS3 is an extended version of PredSS2, with
two different labels for bases at the 5’ end and 3’ end of a base pair.
Squinary contains 4 binary features that correspond to whether the nu-
cleotide is A, C, G or U. In addition to the features deﬁned per nucleotide,
we also considered some aggregated features for the whole window, includ-
ing the nucleotide frequencies (SeqRatio), dinucleotide frequencies
(SquiNu) and GC content (SquC).

When producing the ProbVS features using the Poisson linear models,
there is a user parameter, K, that describes the number of nucleotides to
consider around the current nucleotide during model ﬁtting. We tried
multiple values of it and compared the corresponding results.

Table 2. List of zipcodes used in our prediction task

 

Zipcode Gene Location Length Source
in gene

 

Elmin Ashl 635—683 49
E2A Ashl 1109—1185 77
E2Bmin Ashl 1279—1314 36
Umin Ashl 1766—1819 54
EARl-l Earl 1572—1621 50
ERG2N Erg2 180—250 71

(J ambhekar et al., 2005)
(Olivier et al., 2005)
(J ambhekar et al., 2005)
(J ambhekar et al., 2005)
(Olivier et al., 2005)
(J ambhekar et al., 2005)

SRLlC Srll 419—596 178 (Jambhekar et al., 2005)
TPOlN Tpol 2—178 177 (Jambhekar et al., 2005)
wsczc WSC2 1354—1384 31 (Jambhekar et al., 2005)
WSC2N WSC2 418—471 54 (Jambhekar et al., 2005)

 

Table 3. List of features used in our prediction tasks

 

Feature type Description Number of features

 

PARS PARS score 1 per nucleotide

PARS2 Square of PARS score 1 per nucleotide

LogVS Logarithm of V1 and S1 counts 2 per nucleotide

ProbVSa Expected group membership 2 per nucleotide
variables

PredSS2 Predicted base-pair probability 2 per nucleotide (1 d.f.)

PredSS3 Predicted base-pair probabilities 3 per nucleotide (2 d.f.)
(with directions)

Squinary Binary encoding of the RNA
sequence

4 per nucleotide (3 d.f.)

SeqRatio Nucleotide frequencies 4 per window (3 d.f.)
SquiNu Dinucleotide frequencies 16 per window (15 d.f.)
SquC GC content 1 per window

 

aFeatures extracted by our proposed models; d.f.: degree of freedom.

For general RBP binding sites, due to the experimental procedure used
to produce the dataset we used, the identiﬁed binding sites tend to contain
a large fraction of Uracils (Ting Han, personal communication; see also
the ‘Results’ section). Using a negative training set uniformly sampled
from non-binding regions would result in models that use the enrichment
of Uracils as a core predictor, which is not useful in distinguishing RBP
binding sites from other regions with similar Uracil contents. To over-
come this issue, we constructed the negative set by random permutations
of the nucleotides of the positive examples, with a 1:5 ratio of positive to
negative examples.

When predicting whether a nucleotide is within a RBP binding site, we
used not only its features but also features of the nucleotides around it, to
capture any local feature patterns. We denote by w the total number of
nucleotides the features of which were considered when making predic-
tions for a nucleotide. We tested multiple values of this window size w.
When w = 10, we had 783, 8881 and 19 725 nt as positive examples in the
prediction of RNA zipcodes, general RBP binding sites and binding sites
of Puf3p, respectively.

We used Random Forest (Breiman, 2001) to perform training and pre-
dictions, based on the implementation in the R package randomForest
(http://cran.r-project.org/web/packages/randomForest/index.html). We
used the default values of all parameters, except that we set parameter

 

1 052

112 /810'S112umo[p101x0'sor112u1101u101q/ﬁd11q 111011 pepeolumoq

910K ‘09 lsnﬁnV no 22

Computational identification of protein binding sites on RNAs

 

‘sampsize’ to 5000 when there were >5000 training data points, to reduce
model training time.

Prediction performance was evaluated by cross-validation procedures
and quantiﬁed by the area under the receiver operator characteristics
(AUC), calculated by the R package ROCR (http://cran.r-project.
org/web/packages/ROCR/index.html). For zipcodes, each time we kept
the zipcodes of one gene for testing and used all the others to perform
model training. The testing results were then combined to compute an
overall AUC of the model. For transcriptome—wide protein binding sites,
we performed 5-fold cross-validation with four-ﬁfth data used as training
and one-ﬁfth for testing, for ﬁve disjoint random left-out sets of genes.

3 RESULTS
3.1 Goodness of ﬁt of different models

To check if our proposed models are appropriate for structure-
probing data, we computed R2 at different values of K, the
number of nucleotides around the target nucleotide considered
by the models when predicting the read count of it. The results
(Fig. 1 and Supplementary Fig. S2) show that for both V1 and S1
read counts, mixture models ﬁt the data much better than the
single-component Poisson linear models, even though the single-
component Poisson linear models (PL) contain more parameters
than the mixture models without considering local sequence
biases (MP). Considering local sequences (MPL) provides some
additional goodness of ﬁt. The R2 value of all models did not
change much over a wide range of values of K. Comparing the
two-component Poisson linear models when V1 and S1 data
were ﬁtted either independently or coordinately, the R2 value
was highest when the two sets of data were ﬁtted independently
(MPL), which is expected because there were no additional con-
straints imposed on the parameter values of the two models.
Importantly, the R2 value was only slightly dropped when the
models were ﬁtted coordinately with consistent group member-
ships (MPLC same). In contrast, the R2 value was much lower
when the membership variables of the two models were set to be
opposite (MPLC oppo). These results suggest that besides ex-
pression levels, the most dominant factor that governs the read
count of a nucleotide is likely something that stays the same in
the two settings.

We hypothesized that one such factor is the accessibility of a
nucleotide, which is related to the 3D structure of the RNA.
Because 3D structures of mRNAs were largely unavailable in
databases of molecular structures such as PDB (Berman et al.,
2000), we could not comprehensively test this hypothesis. Here
we illustrate its possibility using tRNAs. We aligned all tRNAs
with data in the structure-probing dataset to the full alignment of
tRNAs in Rfam (Gardner et al., 2011) (ID:RF00005). One of the
sequences in our set had an exact match with the sequence in a
structure in PDB (ID2486D—E). We took this structure, and
calculated the solvent accessible surface area of each nucleotide
using the POPS web server (Cavallo et al., 2003). We found that
the read counts from the V1 and S1 datasets were highly corre-
lated (Fig. 2). In contrast, paired and unpaired nucleotides in
general do not have signiﬁcantly larger V1 and S1 read counts,
respectively.

This example alone cannot prove that in general our extracted
features are related to RNA 3D structures. Nonetheless, regard-
less of their exact biological interpretations, we found that our

0-7- m

+MPL
A0.5-
5 04 _ +MPLC same
a .
1: _ +MP
0.2 _ + MPLC oppo
0.1 - +M-
2 4 6 8101214161820

K

 

 

Fig. 1. Goodness of ﬁt of the different models to the V1 read counts

1000 -
A A
o A
100 +
a - o +
g + 5
+
.3 Q1. 00 6 I; + +
5 + 10 6
" O
w 10 ' 'I' oUnpaired
O 1- Paired
AAnti-codon
1

 

 

1 1'0 100 1000

V1 read count
Fig. 2. Relationships between read counts and tertiary structures of
tRNA. Positions with zero read counts due to non-unique read mapping
are omitted

features are practically useful in predicting RBP binding sites, as
shown below.

3.2 Using extracted features to predict RNA zipcodes

3.2.] Number of bases required to capture sequence biases We
ﬁrst tested the use of our features in predicting RNA zipcodes.
Our prediction framework involves two user parameters, namely
K, the number of nucleotides considered in modeling read count
biases due to local sequences, and w, the number of nucleotides
the features of which to be considered in zipcode prediction. We
ﬁrst ﬁxed w to two particular values (40 and 100), and compared
the accuracy of our three two-component Poisson linear models
at different values of K (Supplementary Fig. S3 and Fig. 3). For
all three models, prediction accuracies were between AUC = 0.6
and 0.8, which are substantially higher than random predictions
(AUC = 0.5). Consistent with the data ﬁtting results, the models
that ﬁt V1 and S1 independently (MPL) or coordinately with
consistent group memberships (MPLC same) were better than
the one with opposite group memberships (MPLC oppo) in iden-
tifying zipcode regions. As the accuracy did not change much
with different values of K, we ﬁxed K: 2 for the remaining tests
to minimize program execution time.

3.2.2 Number of features required to predict zipcodes In
Supplementary Figure S3 and Figure 3, we see that prediction
accuracies were higher for w: 100 than w=40. To see if it is
generally true that a large value of w is needed for accurate pre-
diction of zipcodes, we compared the performance of our two-
component Poisson linear model with separate V1 and S1 ﬁttings
at various values of w. We observed increasing prediction accur-
acy until around w: 80 (the ProbVS curve in Fig. 4), which

 

1 053

112 ﬁre‘sleumofpinXO'sor112u1101urorq//2d11q 111011 pepeolumoq

910K ‘09 lsnﬁnV no 22

X.Hu et al.

 

.0
on

.0
\1
01

_ +MPL
+MPLC same

—x— MPLC oppo

AUC (w=100)
o

.0 a) .0

c) 01 \1

.0
01
01

 

.0
01

 

2 4 6 8 10 12 14 16 18 20
K

Fig. 3. Accuracy of the features extracted from our two-component
Poisson linear models in predicting RNA zipcodes with respect to differ-
ent values of K, number of nucleotides considered in modeling read count
biases due to local sequences when w is ﬁxed to 100

+ ProbVS

—O— SquiNu

—B— SeqRatio
PARSZ

- - - - PARS

+ LogVS

—|— Squinary

— - PredSS3

 

—o— SquC

 

 

----- -- PredSSZ

Fig. 4. Accuracy of various types of features in predicting RNA zipcodes,
at different values of w, the number of neighboring nucleotides to be
considered when classifying a target nucleotide

matches the average length of the zipcodes in our set of examples
(Table 2).

3.2.3 Comparing different types of features We next compared
the ability of different types of features in identifying zipcodes
(Fig. 4). Among the structural features compared, those obtained
from structure-probing sequencing data (ProbVS, LogVS, PARS
and PARS2) achieved higher accuracy than those from compu-
tational predictions alone (PredSS2 and PredSS3). Within the
former group, the features extracted by our two-component
Poisson linear model (ProbVS) produced the highest accuracy
for almost all values of w tested. Nucleotide and dinucleotide
frequencies (SeqRatio and SquiNu) worked fairly well with
large w values, but were not as strong as our structural features
(ProbVS). The other sequence features (Squinary and SquC)
performed poorly. We have also devised a method to formally
quantify the amount of uncertainty reduced from random pre-
dictions by each set of features, and observed the same trend as
these AUC values (Supplementary Fig. S4).

As an example, Supplementary Figure S5 shows the V1 and S1
read counts along the SRL1 RNA, and the probability for each
nucleotide to be within a zipcode as predicted by three models. It
is seen that the actual zipcode region SRLlC is not particularly
single-stranded or double-stranded according to the V1 and S1
read counts, but has a high count of both in general. Our struc-
tural features were able to capture this trend and identify the
zipcode with high accuracy.

3.3 Whole-genome prediction of RBP binding sites

We then further tested if the same approach could predict gen-
eral RBP binding sites on RNAs. We ﬁrst checked the nucleotide

+ ProbVS+Se

qBinary
+ ProbVS

—1— Squinary

AUC (K=2)

— - PARS+Seq

Binary
- - - - PARS

 

 

 

Fig. 5. Cross-validation accuracy of sequence and structural features in
predicting general protein binding sites on highly expressed RNAs.
ProbVS was based on independent ﬁtting of V1 and S1 data

composition of the RBP-bound regions in our dataset, and as
expected found a higher fraction of Uracils in the bound regions
as compared with the overall composition of the RNAs
(Supplementary Table S3), which supports our use of the nega-
tive set with the same nucleotide composition as the positive
examples (see ‘Materials and Methods’ section).

Figure 5 shows the cross-validation results of sequence fea-
tures and the two of the best structural features in zipcode pre-
dictions. The positive and negative examples could well be
separated by our features extracted from structure-probing
data, with a top AUC of 0.8. PARS also achieved an AUC of
close to 0.75. Interestingly, the accuracy of the model with se-
quence features alone increased steadily as w increased, until
reaching a peak AUC of ~0.8 at w: 140. It thus appears that
general RBP binding sites may contain some complex sequence
patterns at the ﬂanking regions. We retrained our prediction
models using both sequence and structural features at the same
time, and found that the resulting accuracy was improved for
both our extracted features and the PARS scores, reaching a top
AUC of ~0.85 for ProbVS + Squinary. We also predicted bind-
ing sites of Puf3p, an RBP with data available from the same
study, and observed similar trends (Supplementary Fig. S6).

4 DISCUSSION

4.1 Information contained in structure-probing data

In this study, we have shown that read counts and derived quan-
tities obtained from structure-probing data are affected by a
number of factors, including expression levels, cleavage prefer-
ence of the enzymes involved and biases due to local sequences.

We found that a mixture model provided substantially better
goodness-of—ﬁt to the structure-probing data we studied than a
single-component model. The components we identiﬁed did not
correspond well to paired and unpaired bases, as indicated by a
smaller R2 value when group memberships were set to be oppos-
ite for the two sets of data than when they were set to be con-
sistent. Instead, we hypothesize that the components may better
reﬂect local accessibility of individual bases in the 3D structure.
New experimental data and analyses are required to prove this
hypothesis.

We have also shown there is a clear difference in terms of both
data ﬁtness and prediction accuracy of zipcodes between models
that consider local sequences and those that do not.

 

1 054

112 ﬁre‘sleumofpinXO'sor112u1101urorq//2d11q 111011 pepeolumoq

910K ‘09 lsnﬁnV no 22

Computational identification of protein binding sites on RNAs

 

Taking these results together, we conclude that structure-
probing data need to be carefully processed to extract useful
features. Taking simple ratios of the read counts from two dif-
ferent enzymatic treatments or between an experiment with the
corresponding control in a nucleotide-by-nucleotide manner
could eliminate factors that stay largely the same in the experi-
ments being compared, but at the same time some useful infor-
mation may also be removed, such as the solvent accessibility of
each nucleotide.

4.2 Signals for recognizing RNA zipcodes

We have shown that structural features were able to identify
RNA zipcodes with high accuracy. The prediction models were
most accurate when the features of a large number of (~80)
nucleotides were used. Unlike transcription factors that bind
DNA with strong sequence motifs, sequence signatures proposed
for RNA zipcodes have not been able to provide a complete
model (Shepard et al., 2003). Our results suggest that the recog-
nition of RNA zipcodes by the She complex may involve more
complex features from the secondary and tertiary structures
of RNAs. The large number of nucleotides needed for strong
prediction suggests that recognition may be mediated by a
large amount of weak signals.

4.3 General features of protein-RNA binding sites

The encouraging performance of our models in identifying general
protein binding sites suggests that there are some general features
recognized by different RBPs. A next step is to test whether a small
set of common features is shared by most RBPs, or there exist
different classes of RBPs each recognizing different features.

We found that both sequence and structural features could
predict general protein binding sites with high accuracy. The
exact relationship between these two types of features is still
not clear. New insights are needed to elucidate how proteins
interact with both RNA sequences and structures.

ACKNOWLEDGEMENTS

We would like to thank John Kim, Mallory Freeberg and Ting
Han for sharing their unpublished data with us and for their
helpful comments on our work.

Funding: X.H. and K.Y.Y. are partially supported by the Direct
Grant for Research 2050479 of The Chinese University of Hong
Kong.

Conﬂict of Interest: none declared.

REFERENCES

Aviran,S. et al. (2011) Modeling and automation of sequencing-based characteriza-
tion of RNA structure. Proc. Natl Acad. Sci. USA, 108, 11069—11074.

Berman,H.M. et al. (2000) The protein data bank. Nucleic Acids Res., 28, 235—242.

Breiman,L. (2001) Random forests. Mach. Leam., 45, 5—32.

Cameron,A.C. and Windmeijer,F.A.G. (1996) R-squared measures for count data
regression models with applications to healthcare utilization. J. Bus. Econ. Stat,
14, 209—220.

Cavallo,L. et al. (2003) POPS: A fast algorithm for solvent accessible surface areas
at atomic and residue level. Nucleic Acids Res., 31, 3364—3366.

Chartrand,P. et al. (1999) Structural elements required for the localization of ASHI
mRNA and of a green ﬂuorescent protein reporter particle in vivo. Curr. Biol., 9,
333—338.

Dempster,A.P. et al. (1977) Maximum likelihood from incomplete data via the EM
algorithm. J. R. Stat. Soc., 39, 1—38.

Dohm,J.C. et al. (2008) Substantial biases in ultra-short read data sets from high-
throughput DNA sequencing. Nucleic Acids Res., 36, e105.

Freeberg,M.A. et al. (2013) Pervasive and dynamic protein binding sites of the mma
transcriptome in Saccharomyces cerevisiae. Genome Biol., 14, R13.

Gardner,P.P. et al. (2011) Rfam: Wikipedia, clans and the “decimal” release.
Nucleic Acids Res., 39, D141—D145.

Gonzalez,I. et al. (1999) ASHl mRNA localization in yeast involves multiple sec-
ondary structural elements and Ashl protein translation. Curr. Biol., 9, 337—340.

Hafner,M. et al. (2010) Transcriptome-wide identiﬁcation of RNA-binding protein
and MicroRNA target sites by PAR-CLIP. Cell, 141, 129—141.

Hofacker,I.L. et al. (1994) Fast folding and comparison of RNA secondary struc-
tures. Monatsheftefu'r Chemie, 125, 167—188.

J ambhekar,A. et al. (2005) Unbiased selection of localization elements reveals cis-
acting determinants of mRNA bud localization in Saccharomyces cerevisiae.
Proc. Natl Acad. Sci. USA, 102, 18005—18010.

Kertesz,M. et al. (2010) Genome-wide measurement of RNA secondary structure in
yeast. Nature, 467, 103—107.

Li,J. et al. (2010) Modeling non-uniformity in short-read rates in RNA-seq data.
Genome Biol., 11, R50.

Licatalosi,D.D. et al. (2008) HITS-CLIP yields genome-wide insights into brain
alternative RNA processing. Nature, 456, 464—469.

Lucks,J.B. et al. (2011) Multiplexed RNA structure characterization with selective
2’ -hydroxyl acylation analyzed by primer extension sequencing (SHAPE-seq).
Proc. Natl Acad. Sci. USA, 108, 11063—11068.

Mortirner,S.A. and Weeks,K.M. (2007) A fast-acting reagent for accurate analysis
of RNA secondary and tertiary structure by SHAPE chemistry. J. Am. Chem.
Soc., 129, 4144—4145.

Olivier,C. et al. (2005) Identiﬁcation of a conserved RNA motif essential for She2p
recognition and mRNA localization to the yeast bud. Mol. Cell. Biol., 25,
4752—4766.

Pancaldi,V. and Bahler,J. (2011) In silico characterization and prediction of global
protein-mRNA interactions in yeast. Nucleic Acids Res., 39, 5826—5836.

Sanford,J.R. et al. (2009) Splicing factor SFRSI recognizes a functionally diverse
landscape of RNA transcripts. Genome Res., 19, 381—394.

Shepard,K.A. et al. (2003) Widespread cytoplasmic mRNA transport in yeast:
Identiﬁcation of 22 bud-localized transcripts using DNA microarray analysis.
Proc. Natl Acad. Sci. USA, 100, 11429—11434.

Underwood,J.G. et al. (2010) FragSeq: Transcriptome-wide RNA structure probing
using high-throughput sequencing. Nat. Mehtods, 7, 995—1001.

Zhao,J. et al. (2010) Genome-wide identiﬁcation of polycomb-associated RNAs by
RIP-seq. Mol. Cell, 40, 939—953.

 

1 055

112 ﬁre‘sleumofpinXO'sor112u1101urorq//2d11q 111011 pepeolumoq

910K ‘09 lsnﬁnV no 22

