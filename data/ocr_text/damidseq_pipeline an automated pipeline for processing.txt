Bioinformatics, 31 (20), 2015, 3371—3373

doi: 10.1093/bioinformatics/btv386

Advance Access Publication Date: 25 June 2015
Applications Note

 

 

Sequence analysis

damidseq_pipeline: an automated pipeline for
processing DamID sequencing datasets

Owen J. Marshall* and Andrea H. Brand

Wellcome Trust/Cancer Research UK Gurdon Institute, Cambridge, CBZ 1(1N, UK

*To whom correspondence should be addressed.
Associate Editor: lnanc Birol

Received on January 21, 2015; revised on May 31, 2015; accepted on June 20, 2015

Abstract

Summary: DamID is a powerful technique for identifying regions of the genome bound by a DNA-
binding (or DNA-associated) protein. Currently, no method exists for automatically processing
next-generation sequencing DamID (DamID-seq) data, and the use of DamID-seq datasets with nor-
malization based on read-counts alone can lead to high background and the loss of bound signal.
DamID-seq thus presents novel challenges in terms of normalization and background minimiza-
tion. We describe here damidseq_pipeline, a software pipeline that performs automatic normaliza-
tion and background reduction on multiple DamID-seq FASTO datasets.

Availability and implementation: Open-source and freely available from http://owenjm.github.io/
damidseq_pipeline. The damidseq_pipeline is implemented in Perl and is compatible with any

Unix-based operating system (e.g. Linux, Mac OSX).
Contact: o.marshall@gurdon.cam.ac.uk

Supplementary information: Supplementary data are available at Bioinformatics online.

 

1 Introduction

DamID is a well-established technique for discovering regions of
DNA bound by or associated with proteins (van Steensel and
Henikoff, 2000). It has been used to map the genome-wide binding
of transcription factors, chromatin proteins, nuclear complexes
associated with DNA and RNA pol II (for e.g. Choksi et al., 2006;
Filion et al., 2010; Singer et al., 2014; Southall et al., 2013). The
technique can be performed in cell culture, whole organisms (van
Steensel and Henikoff, 2000) or with cell-type specificity (Southall
et al., 2013), and requires no fixation or antibody purification.
DamID involves the fusion of a bacterial DNA adenine methyl-
ase (Dam) to any DNA-associated protein of interest. The bacterial
Dam protein methylates adenine in the sequence GATC and, given
that higher eukaryotes lack native adenine methylation, the DNA-
binding footprint of the protein of interest is uniquely detectable
through isolating sequences flanked by methylated GATC sites.
However, a major consideration with DamID is that any Dam pro-
tein within the nucleus will non-specifically methylate adenines in
GATC sequences at accessible regions of the genome. For this rea-
son, DamID is always performed concurrently with a Dam-only

©The Author 2015. Published by Oxford University Press.

control, and the final DNA-binding profile is typically presented as
a log2(Dam-fusion/Dam-only) ratio.

Although the majority of published DamID experiments have used
tiling microarrays for data analysis, next-generation sequencing
(NGS) allows greater sensitivity and higher accuracy. Although sev-
eral recent studies have used NGS with DamID (Carl and Russell,
2015; Clough et al., 2014; Lie-A-Ling et al., 2014; Wu and Yao,
2013), these have relied upon a comparison of peak binding intensities
between read-count-normalized Dam-fusion and Dam samples.
Depending on the characteristics of the Dam-fusion protein (see later)
this approach may lead to real signal being lost, and correct normal-
ization of the datasets is required to detect all binding by many Dam-
fusion proteins. Here, we describe a software pipeline for the auto-
mated processing of DamID-sequencing (DamID-seq) data, including
normalization and background reduction algorithms.

2 Algorithms

Although DamID-seq data can be aligned and binned as per all NGS
data, two issues arise that are specific to DamID. The first major

3371

This is an Open Access article distributed under the terms of the Creative Commons Attribution License (http://creativecommons.org/licenses/by/4.0/), which permits
unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.

112 ﬁhO'sIeumo[pJOJXO'soriemJOJurorw/zdnq wort pepeolumoq

910K ‘09 lsnﬁnV no :2

3372

0.J.Marshall and A.H.Brand

 

consideration is the correct normalization of the Dam-fusion and
Dam-control samples. The greatest contribution to many Dam-fu-
sion protein datasets is the non-specific methylation of accessible
genomic regions (e.g. Fig. 1B), with a mean correlation between
Dam alone and Dam-fusion datasets of 0.70 (n = 4, Spearman’s cor-
relation). Representing the data as a (Dam-fusion/Dam) ratio in the-
ory negates such non-specific methylation. However, strong
methylation signals at highly bound regions in the Dam-fusion data-
set will reduce the relative numbers of reads present at accessible
genomic regions in this dataset (see, for example, the occupancy of
Dam-RNA Pol II over the eyeless gene in Fig. 1), and normalizing
the data based on read counts alone can therefore produce a strong
negative bias to the ratio file [Fig. 1B (iii), Supplementary Fig. SSA].
Depending on the characteristics of the fusion protein, this negative
bias can lead to real signal being lost (Fig. 1). Although microarray
data inadvertently overcame this bias through the manual
adjustment of laser intensities during microarray scanning, until
now no method has existed for correctly normalizing DamID-seq
datasets.

In order to correct for this negative bias we use the read
counts from accessible genomic regions—as determined from
the Dam-only dataset—as the basis for normalization, while avoid-
ing regions likely to contain real signal in the Dam-fusion
sample. We use the following algorithm to adjust the Dam-fusion
dataset.

1. Given the GATC-site resolution of DamID, we divide the read
counts into GATC fragments.

chrl: T0110} - T5110]
If I

2. All GATC fragments lacking read counts are excluded. The re-
maining GATC fragments are divided into deciles.

3. Given the high probability that the highest 10% of Dam-
fusion read counts represent bound signal rather than back-
ground signal, we exclude fragments that have scores in this
decile.

4. The ﬁrst three deciles of the Dam sample can generate inconsist-
ent normalization values if included (Supplementary Table 52),
so we exclude fragments that lie within this range.

5. The distribution of the log2(Dam-fusion/Dam) ratio (x1,x2, . . . ,
x”) for all remaining fragments is determined via the Gaussian

 

kernel density estimate f], = ﬁZJLZ—nexm— (“22:03, where h
i=1

is the bandwidth, estimated via the method of Silverman (1986):
h = 0.9%11—1/5 (where a is the standard deviation of
the sample and IQR the interquartile range). For speed consider-
ations, we estimate kernel density over 300 equally spaced
points within the interval [max(—5, min(x)), min(5, max(x))] .

6. The point of maximum kernel density represents the point of
maximum correspondence between Dam-fusion and Dam val-
ues; if both samples are correctly normalized this value should
equal 0. We therefore normalize all Dam-fusion values by
1/(2argmax(f.(x>>).

In addition to ensuring correct normalization, a second important
consideration is the reduction of background noise. Regions without
specific methylation will have randomly distributed background
counts that, when a ratio file is generated, will generate a large

 

 

 

 

‘ ' 31in: ' ' 12in: ' 1 : ' Tam: : mini: 15in: '
[511350 :3; bl:
:— —:W mm
5 NW“
2 m n W WW
‘2? w W
m
A i E RNA pal II [microarray data from Southall at al.,. 21113}
5.
E 5:...PL4I-ullnnh—h4eml
E _
ﬂ :
E -5:
B I 1DD:Dam«HHﬂ. pnlu ___.,...
II I
ii Darn
IDEI: """"
E 5&-
‘r i
:15
iii nun. pal II [ratio of nm read counts}
5.

 

IogﬁDaIn-Folllmarnl

I
U1

iv 5 RNA pal II [damidseq_plpalina processed?!

I
U1

Ioglearn-Pnlllfﬂanﬁ

 
   

Fig. 1. Results of the damidseq_pipeline. (A) The gene eye/ass (ey) (highlighted) is expressed in D. melanogasterlaval neural stem cells (Southall et al., 2013) and
previously published microarray DamID in these cells (i) shows RNA polymerase II occupancy (Southall et al., 2013). (B) Performing DamID-seq in the same cell
type illustrates the high correlation between Dam-Pol H (i) and Dam alone (ii) in terms of RPM (read counts/million mapped reads). Taking the ratio of the two
RPM-normalized datasets fails to show significant RNA pol || occupancy at ey(iii); however, processing via the damidseq_pipeline software successfully recovers
the RNA pol ll occupancy profile while minimizing background (iv). See Supplementary Methods for experimental details

112 ﬁrosleumo[pJOJXO'soriemJOJurorw/zdnq wort pepeolumoq

910K ‘09 lsnﬁnV no :2

An automated pipeline for DamID-seq processing

3373

 

degree of noise. Such noise can potentially obscure peak detection.
In order to mitigate this effect we add pseudocounts to both data-
sets. In order to maintain equivalence between replicates with differ-
ing numbers of reads (assuming that genomebound << genomeunbound)

the number of pseudocounts added is proportional to the sequencing

reads
blns ’

for a comparison of gene calls with different read-depths). Adding

 

coverage, thus c where c is a constant. (Supplementary Table S1
pseudocounts increases the number and the total genomic coverage
of detected peaks and increases the signalznoise ratio
(Supplementary Figs 51—54).

The combination of these two methods compares favorably with
previously published microarray data [Fig. 1B (iv)] or DamID-seq
data (Supplementary Figs 51—54; Supplementary Fig. SS).

3 Implementation

The damidseq_pipeline software is implemented in Perl, and will
process multiple single-end read sequencing files in FASTQ or BAM
format. The pipeline can match sequencing adaptors to sam-
ple names, automatically identifies the Dam-only control, and per-
forms alignment, read-length extension, normalization, background
reduction and ratio file generation. (Supplementary Methods for
details).

A large number of user-configurable options are provided,
including the ability to adjust the normalization algorithm param-
eters, generate read-count normalized files and add a user-specified
number of pseudocounts. Parameters specified on the command-line
can be saved as defaults if the user desires.

The damidseq_pipeline software is open-source and freely avail-
able at http://owenjm.github.io/damidseq_pipeline. A detailed set of
installation and usage instructions are provided at the above web-
site, along with a small example dataset.

Acknowledgements

We thank Charles Bradshaw for helpful comments on the software. This
work was funded by a BBSRC Project Grant (BB/L00786X/1) and a
Wellcome Trust Programme Grant (092545) to A.H.B. A.H.B acknowledges
core funding to the Gurdon Institute from the Wellcome Trust (092096) and
CRUK (C6946/A14492).

Conﬂict of Interest: none declared.

References

Carl,S.H. and Russell,S. (2015) Common binding by redundant group B Sox
proteins is evolutionarily conserved in Drosophila. BMC Genomics, 16,
1—22.

Choksi,S.P. et al. (2006) Prospero acts as a binary switch between self-renewal
and differentiation in Drosophila neural stem cells. Dev. Cell, 11, 775—789.

Clough,E. et al. (2014) Sex- and tissue-speciﬁc functions of drosophila double-
sex transcription factor target genes. Dev. Cell, 31, 761—773.

Filion,G.]. et al. (2010) Systematic protein location mapping reveals ﬁve prin-
cipal chromatin types in Drosophila cells. Cell, 143, 212—224.

Lie-A-Ling,M. et al. (2014) RUNX1 positively regulates a cell adhesion and
migration program in murine hemogenic endothelium prior to blood emer-
gence. Blood, 124, e11—e20.

Silverman,B.W. (1986) Density Estimation for Statistics and Data Analysis.
Chapman and Hall, London.

Singer,R. et al. (2014) Drosophila COP9 signalosome subunit 7 interacts with
multiple genomic loci to regulate development. Nucleic Acids Res., 42,
9761—9770.

Southall,T.D. et al. (2013) Cell-type-speciﬁc proﬁling of gene expression and
chromatin binding without cell isolation: assaying RNA Pol II occupancy in
neural stem cells. Dev. Cell, 26, 101—112.

van Steensel,B. and Henikoff,S. (2000) Identiﬁcation of in vivo DNA targets of
chromatin proteins using tethered dam methyltransferase. Nat. Biotechnol,
18, 424—428.

Wu,F. and Yao,]. (2013) Spatial compartmentalization at the nuclear periph-
ery characterized by genome-wide mapping. BMC Genomics, 14, 591.

112 /810'S{12umo[pJOJXO'soriemJOJurorw/2dnq wort pepeolumoq

910K ‘09 lsnﬁnV no 22

