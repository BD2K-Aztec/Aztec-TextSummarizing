Advance Access Publication Date: 21 January 2016

Bioinformatics, 32(10), 2016, 1555—1556
doi: 10.1093/bioinformatics/btw024

Applications Note

 

 

Genome analysis

TFBSTooIs: an R/bioconductor package for
transcription factor binding site analysis

Ge Tan and Boris Lenhard*

Computational Regulatory Genomics, MRC Clinical Sciences Centre, Imperial College London, London W12 ONN, UK

*To whom correspondence should be addressed.
Associate Editor: Alfonso Valencia

Received and revised on 10 November 2015; accepted on 13 January 2016

Abstract

Summary: The ability to efficiently investigate transcription factor binding sites (TFBSs) genome—
wide is central to computational studies of gene regulation. TFBSTooIs is an R/Bioconductor package
for the analysis and manipulation of TFBSs and their associated transcription factor profile matrices.
TFBStoo/s provides a toolkit for handling TFBS profile matrices, scanning sequences and alignments
including whole genomes, and querying the JASPAR database. The functionality of the package can
be easily extended to include advanced statistical analysis, data visualization and data integration.
Availability and implementation: The package is implemented in R and available under GPL—2
license from the Bioconductor website (http://bioconductor.org/packages/TFBST00ls/).

Contact: ge.tan09@imperial.ac.uk

Supplementary information: Supplementary data are available at Bioinformatics online.

 

1 Introduction

Transcription factor binding sites (TFBSs) on DNA play a central
role in gene regulation via their sequence—specific interaction with
transcription factor (TF) proteins (Wasserman and Sandelin, 2004).
Most individual TFBSs are 4—30 base—pairs (bp) wide, but are gener—
ally located in larger cis—regulatory regions of 5 0—200 bp. Analysis
and identification of TFBSs is crucial for understanding the regula—
tory mechanisms of gene regulation.

At present, the TFBS analysis functionality in IUBioconductor
(Gentleman et 61]., 2004) is limited and scattered across multiple pack—
ages. Here we introduce an R package TFBSTools, which provides a
unified and efficiently implemented suite of TFBS analysis tools. The
package provides a number of functions for manipulating TFBS pro-
file matrices and searching DNA sequence and pairwise alignments
using them. We have ported all of the functionality of our popular
TFBS Perl modules (Lenhard and Wasserman, 2002), retaining the
equivalent class structure where possible, and expanded the function—
ality to provide efficient genome—wide analysis of TFBSs. Our imple-
mentation is tightly integrated with the existing Bioconductor core
packages, enabling high—performance sequence and interval manipu—
lation. A database interface for JASPAR2014 (Mathelier et al., 2014),
JASPAR2016 (Mathelier et 61]., 2015) and wrapper function for
de novo motif discovery software are also provided.

©The Author 2016. Published by Oxford University Press.

2 Methods
2.1 $4 classes defined in TFBSTools

To provide easy data storage, manipulation and exchange, we cre—
ated several novel S4 classes (Fig. 1), and also defined an aggregate
version of each class (e.g. PFMatrixList) to help manipulate sets of
the corresponding objects. The design of these classes corresponds
to classes in TFBS Perl modules, while remaining extensible in an
object—oriented manner, adding new functionality and taking advan—
tage of functional programming capabilities of R.

2.2 Operations with TFBS matrix profiles

To characterize the binding preference of a TF, the aligned se—
quences bound by the TF are aggregated into a position frequency
matrix (PFM). From this matrix, another two matrices can be
derived: position weight matrix (PWM, the most commonly used
kind of position-specific scoring matrix) and information content
matrix (ICM). PWM is a matrix of positional log-likelihoods nor-
mally used for sequence scanning and scoring against the motif,
while ICM is mostly used in motif visualization, e.g. for drawing
sequence logos which can be easily done by the package seqLogo
(Fig. 1A). As a novel feature, in addition to matrix profiles,
TFBSTools also supports the manipulation of transcription factor

1555

This is an Open Access article distributed underthe terms of the Creative Commons Attribution License (http://creativecommons.org/licenses/by/4.0/), which permits
unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.

112 /§JO'S{eumo [p.IOJXO'SOTlBIIHOJUTOTQ/ﬁdllq 11101; popeoIII/vxoq

9IOZ ‘09 lsnﬁnv uo ::

G. Tan and B.Lenhard

 

A
PFMatrix ICMatrix
1 2 3  15 1 2 3  15
A 159 225 135  242 A 4.7e—63 3.9e—62 3.3e—62  7.3e—62
c 159 91 54  89 c 4.5e—93 1.6e—92 1.3e—92  2.4e—92
G 195 133 151  155 G 3.1e—e3 2.3e—62 3.7e—62  4.7e—62 1
T 139 194 213  76 T 4.1e—93 1.8e—92 5.1e—92  2.3e—92 T C
0 , mic: 2 TCQ___ _ :71,
. l_l_l_l_l_l_l_l_l_l_l_l_l_l_l
PWMatrlx 12 3 4 5 6 7 B 9101112131415
1 3  15 S.“ I n m,
A 9.29 9.79 —9.93  9.89 ' geseque 09
c 9.11 —9.69 —1.35  —9.7s BSgenome Siteset/Sitepairset
G 939 —9.95 9.12  9.16 n -
T 9.91 —9.41 9.62  —9.s6 tallgnment
Position Probabilities C  .
B . . c
A 9.21 9.29 9.16  9.38 L
TFFM c 9.33 9.27 9.22  9.29
G 9.22 9.26 9.29  9.23 T
T 9.23 9.16 9.49  9.18
r 2091; c-

12 3 4 5 6 7 8 9101112131415
Position

Fig. 1. A common workflow and classes in TFBSTools. (A) PFMatrix can be
converted into PWMatrix, ICMatriX. ICMatriX produces the sequence logos.
PWMatrix scans the single sequence or alignment to produce SiteSet object
that holds transcription factor binding sites. (B) TFFM: A virtual class for
TFFM; TFFMFirst and TFFMDetail are derived from this virtual class. They can
produce the position probabilities and the novel graphics representation of
TFFM

ﬂexible model (TFFM) profiles (Mathelier and Wasserman, 2013),
which capture the dinucleotide dependence (Fig. 1B).

TFBSTools provides methods to perform the conversion between
different types of matrices, providing a range of options and custom—
izations. The highlights include: (i) a default pseudocount of 0.8
(Nishida et al., 2009) is used to eliminate the small or zero counts
before log transformation, although a different pseudocount, or
pseudocount function, for each column is possible; (ii) Schneider
correction for ICM is available; (iii) Unequal background nucleotide
frequencies can also be specified.

TFBSTools provides tools for comparing pairs of PFMs, or a
PFM with IUPAC strings, using a modified Needleman—Wunsch al—
gorithm (Sandelin et al., 2003). Quantification of the similarity be—
tween PFMs is commonly used for comparing a newly discovered
matrix with existing matrices in the motif database, such as
JASPAR, to determine whether the motif is related to known anno—
tated motifs.

The similarity between two PWMs can be quantified using several
metrics (e.g. normalized Euclidian distance, Pearson correlation coef—
ficient and Kullback—Leibler divergence). In addition, TFBSTools also
allows random profile generation by: (i) sampling the posterior distri—
bution of Dirichlet multinomial mixture models trained on all avail—
able JASPAR matrices; (ii) permutation of columns from selected
PFMs. The availability of random matrices with the same statistical
properties as selected profiles is particularly useful for computational]
simulation studies, such as matrix—matrix comparison.

2.3 Sequence/alignment scanning with PWM profiles
TFBSTools includes facilities for screening potential TFBSs present
in a DNA sequence (searchSeq), or conserved in a pairwise
alignment.

When a pairwise alignment is available, it can be used to combine
the TFBSs prediction with phylogenetic footprinting, which can in
many cases reduce the false discovery rate whilst retaining a sufficient
level of sensitivity (Wasserman and Sandelin, 2004). Alternatively, it
can be used in combination with other data (e.g. ChIP—seq) to study
the cross—species conservation properties of TF binding.

For genome—wide phylogenetic footprinting, TFBSTools can ac—
cept two BSgenome objects, and a chain file for liftoz/er from one
genome to another (searchPairBSgenome) or a novel S4 class
Axt from our CNEr package (available from the Bioconductor

website) for representing the axt alignments (searchAln). It can
take up to 50 CPU hours to run searchAln on human—mouse pair-
wise alignment with the possibility of parallel computation, while
searchSeq or searchPairBSgenome only needs several minutes.
The computationally predicted putative TFBSs can be returned in
GFF format or GRanges for downstream analysis.

2.4 JASPAR database interface

Since the release of JASPAR2014 (Mathelier et al., 2014), we have
provided Bioconductor data packages, ]ASPAR2014 and
]ASPAR2016, holding the profile matrices and associated metadata.
To accompany the use of this data package for TFBS analysis,
TFBSTools provides functions to enable efficient database querying
and manipulation.

2.5 Use of de novo motif discovery software

TFBSTools provides wrapper functions for de novo motif discovery
softwares and seamlessly integrates the results back into R objects.
Currently, support for MEME is implemented and reported motifs
are stored in MotifSet object.

3 Conclusions and further information

The Bioconductor TFBSTools package provides a full suite of TFBS
analysis tools. The package allows the efficient and reproducible
identification and analysis of TFBSs. In combination with other
functionality in Bioconductor, it provides a powerful way to analyze
TF binding motifs on genome—wide scale. Further development will
include an efficient implementation of scanning sequence/alignment
with TFFM. A tutorial and additional use cases are available at
Bioconductor website.

Acknowledgement

We thank Nathan Harmston for his comments on the manuscript.

Funding

GT. is funded by the EU FP7 grant 242048 (ZF-HEALTH). BL. is funded by
Medical Research Council UK.

Conﬂict of Interest: none declared.

References

Gentleman,R.C. et al. (2004) Bioconductor: open software development for
computational biology and bioinformatics. Genome B iol., 5, R80.

Lenhard,B. and Wasserman,W.W. (2002) TFBS: computational framework for
transcription factor binding site analysis. Bioinformatics, 18, 1 135—1 136.

Mathelier,A. and Wasserman,W.W. (2013) The next generation of transcrip-
tion factor binding site prediction. PLOS Comput. Biol., 9, e1003214.

Mathelier,A. et al. (2014) JASPAR 2014: an extensively expanded and
updated open-access database of transcription factor binding proﬁles.
Nucleic Acids Res., 42, D142—D147.

Mathelier,A. et al. (2015) JASPAR 2016: a major expansion and update of the
open-access database of transcription factor binding proﬁles. Nucleic Acids
Res., ng1 176.

Nishida,K. et al. (2009) Pseudocounts for transcription factor binding sites.
Nucleic Acids Res., 37, 939—944.

Sandelin,A. et al. (2003) Integrated analysis of yeast regulatory sequences for
biologically linked clusters of genes. Funct. Integr. Genomics, 3, 125—134.
Wasserman,W.W. and Sandelin,A. (2004) Applied bioinformatics for the iden-

tiﬁcation of regulatory elements. Nat. Rev. Genet., 5, 276—287.

112 /§JO'Sjeumo [p.IOJXO'SOTlBIIIJOJUTOTQ/ﬁ(11111 11101; popeoIII/vxoq

9IOZ ‘09 lsnﬁnv uo ::

