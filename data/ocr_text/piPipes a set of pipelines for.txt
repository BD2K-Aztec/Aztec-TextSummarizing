APPLICATIONS NOTE

Vol. 31 no. 4 2015, pages 593—595
doi: 10. 1 093/bioinformatics/btu64 7

 

Sequence analysis

Advance Access publication October 17, 2014

piPipes: a set of pipelines for piRNA and transposon analysis via
small RNA-seq, RNA-seq, degradome- and CAGE-seq, ChlP-seq

and genomic DNA sequencing

Bo w. Han1’2’3’l, Wei Wangl’2’3’4’l, Phillip D. Zamore1’2’3’* and Zhiping Weng3’4’*

1RNA Therapeutics Institute, 2Howard Hughes Medical Institute, 3Department of Biochemistry & Molecular
Pharmacology and 4Program in Bioinformatics and Integrative Biology, University of Massachusetts Medical School,

368 Plantation Street, Worcester, MA 01605, USA

Associate Editor: Ivo Hofacker

 

ABSTRACT

Motivation: PlWl-interacting RNAs (piRNAs), 23—36 nt small silencing
RNAs, repress transposon expression in the metazoan germ line,
thereby protecting the genome. Although high-throughput sequencing
has made it possible to examine the genome and transcriptome at
unprecedented resolution, extracting useful information from giga-
bytes of sequencing data still requires substantial computational
skills. Additionally, researchers may analyze and interpret the same
data differently, generating results that are difficult to reconcile. To
address these issues, we developed a coordinated set of pipelines,
‘piPipes’, to analyze piRNA and transposon-derived RNAs from a var-
iety of high-throughput sequencing libraries, including small RNA,
RNA, degradome or 7-methyl guanosine cap analysis of gene expres-
sion (CAGE), chromatin immunoprecipitation (ChlP) and genomic
DNA-seq. piPipes can also produce figures and tables suitable for
publication. By facilitating data analysis, piPipes provides an oppor-
tunity to standardize computational methods in the piRNA field.
Supplementary information: Supplementary information, including
flowcharts and example figures for each pipeline, are available at
Bioinformatics online.

Availability and implementation: piPipes is implemented in Bash,
C++, Python, Perl and R. piPipes is free, open-source software
distributed under the GPLv3 license and is available at http://
bowhan.github.io/piPipes/.

Contact: Phillip.Zamore@umassmed.edu or Zhiping.Weng@umass
med.edu

Supplementary information: Supplementary data are available at
Bioinformatics online.

Received on April 25, 2014; revised on August 19, 2014; accepted on
September 28, 2014

1 INTRODUCTION

piRNAs, a class of 23—36 nt long small silencing RNAs, suppress
transposon expression in the metazoan germ line and, in some
animals, the adjacent gonadal somatic cells (Luteijn and Ketting,
2013). By preventing transposition, the piRNA pathway ensures

 

*To whom correspondence should be addressed.
TThe authors wish it to be known that, in their opinion, the ﬁrst two
authors should be regarded as Joint First Authors

that genetic information passes faithfully to the next generation.
Disruption of the piRNA pathway typically leads to transposon
mobilization, double-stranded DNA breaks and sterility.
High-throughput sequencing technologies have been widely
deployed in the study of piRNAs. Small RNA-seq reveals the
identity and abundance of piRNAs (Brennecke et al., 2007);
RNA-seq detects and quantiﬁes mRNA and transposon tran-
scripts (Reuter et al., 2011); degradome-seq (also termed
RACE-seq) detects the cleavage products of PIWI-proteins
guided by piRNAs (Reuter et al., 2011); chromatin immunopre-
cipitation (ChIP)—seq detects chromatin modiﬁcations directed
by piRNAs or transcription factor-binding events that regulate
piRNA precursor or target transcription (Sienski et al., 2012);
and genomic DNA sequencing detects new transposition events
caused by transposons that escape piRNA repression or
background differences between experimental strains and the
assembled genome (Khurana et al., 2011; Sienski et al., 2012).
Correctly extracting biological knowledge from such voluminous
data requires signiﬁcant computational expertise and effort.
The repetitive nature of transposon sequences lays another
layer of complexity. Moreover, different laboratories use diverse
methods to analyze and interpret data (e. g. the way of treating
reads that map to multiple locations in a reference genome). To
provide a standardized set of tools to analyze these diverse data
types, we developed piPipes, a collection of integrated pipelines
for small RNA-seq, RNA-seq, degradome— and cap analysis of
gene expression-seq (CAGE-seq), ChIP—seq and genome-seq
analyses.

2 METHODS

piPipes comprises ﬁve pipelines designed to analyze small RNA-seq,
RNA-seq, degradome— and CAGE-seq, ChIP-seq or genome-seq data.
The small RNA-seq pipeline reports the abundance, length distribution,
nucleotide composition and 5’ -to-5’ distance (‘Ping-Pong’ signature) of
piRNAs assigned to genomic annotations, including individual trans-
poson families and piRNA clusters, the initial sources of piRNA precur-
sor transcripts. The RNA-seq pipeline reports the normalized abundance
of transcripts from both genes and transposons. The degradome-seq pipe-
line offers methods to identify piRNA-directed cleavage products. This
pipeline can also be used to analyze any long RNA sequencing method
designed to deﬁne RNA 5’ ends, e.g. CAGE-seq. The ChIP-seq pipeline
uses the widely used peak-calling algorithm MACS2 (Zhang et al., 2008),
focusing on piRNA clusters and transposons. The genome-seq pipeline

 

© The Author 2014. Published by Oxford University Press.

This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (http://creativecommons.org/Iicenses/
by-nc/4.0/), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial
re-use, please contact journals.permissions@oup.com

112 [3.10811211an[p.IOJXO'SODBIIIJOJIIlOTQ/ﬂ(11111 IIIOJJ pepcolumoq

910K ‘09 lsnﬁnV no :2

B. W.Han et al.

 

      

    

 

 

 

 

 

A Small RNA length distribution B RNA-seq reads C piRNA cluster
NM , ’
1 8 104g  . 9 I 10 _ I
60.000 - 15) .’ o I  Fold-enrichment
2 Transposon  . logLR
30,000 - ‘0: 1o8 ' ' O a P . I
I .0 C 75_ cisson p-va ue
o _ I-l ._ 8 
I I ..  .L
s o E
m 80,000 - a O 5 -
1E '0 co
160,000 - g 10' “E’
C o:
- “‘ x . _
240,000 g 1 GI) 25
2
320.000 - Th
3
(U 10'1 0 -
4°°'°°° ' Ill 19 20 21 22 23 24 25 26 27 28 29 30 31 32 as 134 ' i ' 1B1 ' 132 ' 133 ' 1‘04 40'00 5 10'00 20"“)
Length (nt) w1 number of reads (log10) Position (bp)

“m clélﬁtsigrgg § E I _h

 

Us er
52kg? [DEED
Us er

 

3RHetI I éé

W 1‘
main:
992.2%
0
QWEEEEE reﬁt.

 

Fig. 1. Gallery of piPipes Figures (A) Barplot representing length distribution of Drosophila w] ovary small RNAs assigned to sense (blue) and antisense
(red) strands of transposons. a3) Scatterplot comparing w] to aubHNZ/QC42 Drosophila ovary RNA-seq reads assigned to mRNA (NM; red), non-coding
RNA (NR; green) and transposons (blue). (C) Metagene plot of H3K9me3 ChIP-seq of piRNA clusters from ﬂies in which piwi mRNA was depleted by
double-stranded RNA-triggered RNA driven by a triple Gal4 driver (SRX215630). (D) Circos plot representing the locations of, from the periphery to
the center, cytological position, piRNA clusters, SV discovered by TEMP (tiles), retroSeq (tiles) and VariationHunter (links) using genomic sequencing
of 2—4—day-old ovaries

 

594

112 [3.10811211an[p.IOJXO'SODBIIIJOJIIlOTQ/ﬂ(11111 IIIOJJ pepcolumoq

910K ‘09 lsnﬁnV no :2

piPipes

 

detects novel transposition events as well as structural variation.
Supplementary Figure S1 illustrates the general piPipes workﬁow, using
the small RNA-seq pipeline as an example. First, all reads aligned to
ribosomal RNA (rRNA) sequences are removed. The remaining reads
are then mapped to microRNA (miRNA) hairpin sequences to quantify
the abundance and 5’ - and 3’ -end heterogeneity of mature miRNAs.
Reads that do not match rRNAs or miRNAs are then mapped to the
reference genome. piPipes next assigns reads to different genomic features
(e.g., transposons, piRNA clusters and genes) by their coordinates. To
achieve maximal speed, piPipes parallelizes this step on multiple threads
using ParaFly software from the Trinity package (Grabherr et al., 2011).
For the reads assigned to each genomic feature, piPipes draws publica-
tion-quality graphs of length distribution and nucleotide composition, as
well as the distance between the 5’ ends of two small RNAs from opposite
strands of the same locus, a standard method for detecting piRNA ‘Ping-
Pong’ ampliﬁcation or siRNA phasing (Fig. 1A and Supplementary Fig.
SIB). Furthermore, piPipes generates a table that summarizes the number
of unique and multiple mappers counted as species (distinct sequences) or
reads. The RNA-seq pipeline also starts with rRNA removal. The re-
maining reads are then mapped to the genome using STAR (Dobin et al.,
2013). piPipes quantiﬁes transcript abundance from genomic alignment
by both Cufﬁinks (Trapnell et al., 2010) and HTSeq-count (Anders et al.,
2014). In addition, direct mapping of the reads to the transcriptome is
performed using Bowtie2 followed by eXpress quantiﬁcation (Roberts
and Pachter, 2013). Degradome—seq and CAGE-seq share the same pipe-
line because both methods aim to characterize the 5’ ends of RNAs. This
pipeline discards reads that can only be mapped to the genome via soft
clipping of their 5’ ends (i.e. the preﬁxes of these reads do not map to the
genome). The alignment procedure is otherwise similar to that used for
RNA-seq data. The nucleotide composition for each genomic feature is
calculated as in the small RNA pipeline (Supplementary Fig. S3B). The
ChIP-seq pipeline aligns the ChIP and input libraries to the genome using
Bowtie2. piPipes calls peaks using MACS2 (Zhang et al., 2008), which
supports both narrow (such as transcription factors) and broad (such as
histone 3 trimethyl lysine 9, H3K9me3) peaks. Transcription start site,
transcription end site and metagene analyses of different genomic features
are implemented by bwtool (Pohl and Beato, 2014). The genome-seq
pipeline applies different algorithms, including BreakDancer (Chen
et al., 2009), RetroSeq Giormozdiari et al., 2010; Keane et al., 2013)
and TEMP (Zhuang et al., 2014), to discover transposon insertion,
deletion and other structural variation events (Supplementary Fig. S5).
piPipes uses a Circos plot (Zhang et al., 2013) to represent the variant
loci discovered by each algorithm across different chromosomes
(Fig. 1D).

The small RNA-seq, RNA-seq and ChIP-seq pipelines can each be run
in two modes, allowing analysis of a single sample or a pair of samples.
The dual-sample mode uses the output from the single-sample mode and
performs pair-wise comparison as illustrated by balloonplots and
scatterplots (Supplementary Fig. SlC and D). The comparison can be
performed on miRNA, piRNA or mRNA. Figure 1B illustrates a
scatterplot showing the mRNA abundance in an RNA-seq dataset ana-
lyzed by the RNA-seq pipeline in the dual-sample mode. The dual-sample
mode of the RNA-seq pipeline also uses Cuffdiff (Trapnell et al., 2013) to

perform differential analysis on genie transcripts. In the dual-sample
mode, the ChIP-seq pipeline uses MACS2 to identify differentially
enriched loci (Supplementary Fig. S4).

ACKNOWLEDGEMENTS

The authors thank the members of the Zamore and Weng
laboratories for helpful discussions, and Jia Xu, Jui-Hung
Hung and S00 Lee for their initial work.

Funding: This work was funded by National Institutes of Health
grants [GM62862 and GM65236] to P.D.Z. and [U41HG007000]
to Z.W.

Conﬂicts of interest: none declared.

REFERENCES

Anders,S. et al. (2014) HTSeq - A Python framework to work with high-
throughput sequencing data. Bioinformatics, 31, 166—169.

Brennecke,J. et al. (2007) Discrete small RNA-generating loci as master regulators
of transposon activity in Drosophila. Cell, 6, 1089—1103.

Chen,K. et al. (2009) BreakDancer: an algorithm for high-resolution mapping of
genomic structural variation. Nat. Methods, 9, 677—681.

Dobin,A. et al. (2013) STAR: ultrafast universal RNA-seq aligner. Bioinformatics,
1, 15—21.

Grabherr,M.G. et al. (2011) Full-length transcriptome assembly from RNA-Seq
data without a reference genome. Nat. Biotechnol., 7, 644—652.

Hormozdiari,F. et al. (2010) Next-generation VariationHunter: combinatorial algo-
rithms for transposon insertion discovery. Bioinformatics, 12, i350—i357.

Keane,T.M. et al. (2013) RetroSeq: transposable element discovery from next-gen-
eration sequencing data. Bioinformatics, 3, 389—390.

Khurana,J.S. et al. (2011) Adaptation to P element transposon invasion in
Drosophila melanogaster. Cell, 7, 1551—1563.

Luteijn,M.J. and Ketting,R.F. (2013) PIWI-interacting RNAs: from generation to
transgenerational epigenetics. Nat. Rev. Genet, 8, 523—534.

Pohl,A. and Beato,M. (2014) bwtool: a tool for bigWig ﬁles. Bioinformatics, 11,
1618—1619.

Reuter,M. et al. (2011) Miwi catalysis is required for piRNA ampliﬁcation-inde-
pendent LINEl transposon silencing. Nature, 7376, 264—267.

Roberts,A. and Pachter,L. (2013) Streaming fragment assignment for real-time ana-
lysis of sequencing experiments. Nat. Methods, 1, 71—73.

Sienski,G. et al. (2012) Transcriptional silencing of transposons by Piwi and
maelstrom and its impact on chromatin state and gene expression. Cell, 5,
964—980.

Trapnell,C. et al. (2010) Transcript assembly and quantiﬁcation by RNA-Seq re-
veals unannotated transcripts and isoforrn switching during cell differentiation.
Nat. Biotechnol., 5, 511—515.

Trapnell,C. et al. (2013) Differential analysis of gene regulation at transcript reso-
lution with RNA-seq. Nat. Biotechnol., 1, 46—53.

Zhang,H. et al. (2013) RCircos: an R package for Circos 2D track plots. BMC
Bioinformatics, 14, 244.

Zhang,Y. et al. (2008) Model-based analysis of ChIP-Seq (MACS). Genome Biol., 9,
R137.

Zhuang,J. et al. (2014) TEMP: a computational method for analyzing transposable
element polymorphism in populations. Nucleic Acids Res., 11, 6826—6838.

 

595

112 /810's112umo[pJOJXO'sot112u1101utotq//2d11q 111011 pepeolumoq

910K ‘09 lsnﬁnV no 22

