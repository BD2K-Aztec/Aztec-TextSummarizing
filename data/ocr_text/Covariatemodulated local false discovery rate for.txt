ORIGINAL PAPER

Vol. 30 no. 15 2014, pages 2098—2104
doi:10. 1093/bioinformatics/btu145

 

Genome analysis

Advance Access publication April 7, 2014

Covariate-modulated local false discovery rate for genome-wide

association studies

Rong W. Zablockil, Andrew J. Schork2, Richard A. Levine3, Ole A. Andreassen4,

Anders M. Dale2’5’6 and Wesley K. Thompson6’*

1Computational Science Research Center, San Diego State University, San Diego, CA 92182, USA, 2Cognitive Sciences
Graduate Program, University of California at San Diego, La Jolla, CA 92093, USA, 3Department of Mathematics and

Statistics, San Diego State University, San Diego, CA 92182, USA, 4Institute of Clinical Medicine, University of Oslo, Oslo,
0424, Norway, 5Multimodal Imaging Laboratory and 6Department of Psychiatry, University of California at San Diego, La

Jolla, CA 92093, USA

Associate Editor: John Hancock

 

ABSTRACT

Motivation: Genome-wide association studies (GWAS) have largely
failed to identify most of the genetic basis of highly heritable diseases
and complex traits. Recent work has suggested this could be because
many genetic variants, each with individually small effects, compose
their genetic architecture, limiting the power of GWAS, given currently
obtainable sample sizes. In this scenario, Bonferroni-derived thresh-
olds are severely underpowered to detect the vast majority of associ-
ations. Local false discovery rate (fdr) methods provide more power to
detect non-null associations, but implicit assumptions about the ex-
changeability of single nucleotide polymorphisms (SNPs) limit their
ability to discover non-null loci.

Methods: We propose a novel covariate—modulated local false dis-
covery rate (cmfdr) that incorporates prior information about gene
element—based functional annotations of SNPs, so that SNPs from
categories enriched for non-null associations have a lower fdr for a
given value of a test statistic than SNPs in unenriched categories. This
readjustment of fdr based on functional annotations is achieved em-
pirically by fitting a covariate—modulated parametric two-group mixture
model. The proposed cmfdr methodology is applied to a large Crohn’s
disease GWAS.

Results: Use of cmfdr dramatically improves power, e.g. increasing
the number of loci declared significant at the 0.05 fdr level by a factor
of 5.4. We also demonstrate that SNPs were declared significant using
cmfdr compared with usual fdr replicate in much higher numbers,
while maintaining similar replication rates for a given fdr cutoff in de
novo samples, using the eight Crohn’s disease substudies as inde-
pendent training and test datasets.

Availability an implementation: https://sites.google.com/site/covmo
dfdr/

Contact: wes.stat@gmail.com

Supplementary information: Supplementary data are available at
Bioinformatics online.

Received on May 8, 2013; revised on March 3, 2014; accepted on
March 5, 2014

 

*To whom correspondence should be addressed

1 INTRODUCTION

Large-scale hypothesis testing has emerged as a critical compo-
nent of genetic analysis with the advent of high-throughput
microarrays (Efron and Tibshirani, 2002). For example, it is
now possible to survey a large number of single nucleotide poly-
morphisms (SNPs) across the entire genome in an attempt to
locate genetic variations associated with trait variability or dis-
ease risk. An advantage of large-scale genome-wide association
studies (GWAS) is the ability to discover the potential effect of
any number of variants across the genome, without making
strong a priori hypotheses about the subset of the genome to
consider (Risch and Merikangas, 1996). A disadvantage is that
a large number of false positives may occur when many hypoth-
esis tests are conducted simultaneously (Devlin and Roeder,
1999). Consequently, modern GWAS have adopted a stringent
Bonferroni-derived multiple testing threshold of P 5 5 x 10—8
for declaring individual SNP associations signiﬁcant.
Unfortunately, these GWAS have largely failed to identify sub-
stantial portions of the genetic basis of highly heritable diseases
and complex traits (Collins, 2010; Manolio et al., 2009). Recent
work has strongly suggested this could be because many genetic
variants, each with individually small effects, compose their gen-
etic architecture, limiting the power of GWAS to detect true
associations, given currently obtainable sample sizes (Yang
et al., 2010). This scenario is especially damaging to power if
all SNPs are treated as a priori exchangeable and hence equally
likely to be related to the phenotype of interest, an implicit as-
sumption of Bonferroni thresholds and false discovery rate
(FDR) control (Benjamini and Hochberg, 1995).

Other work has placed an emphasis on characterizing the bio-
logical function of genetic variants across the genome
(Torkamani et al., 2011). Typically, this work has focused on
understanding how differences in the protein-coding region of
genes may damage or alter the corresponding protein structure.
However, recent efforts have attempted to characterize the po-
tential effect of variants within non-coding elements, which may
alter the timing, amount or location of gene expression
(ENCODE Consortium, 2012). Emerging from this research is
a picture of widespread heterogeneity in the potential biological
functionality of variants across the genome. A number of re-
searchers have suggested that this heterogeneity of function

 

2098 © The Author 2014. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com

112 [3.1081120an[plOJXO'SODBIILIOJIIlOIQ/[i(11111 IIIOJJ pepeolumoq

910K ‘09 lsnﬁnV no :2

cmfdr

 

translates to association studies, with certain genetic elements or
categories of variants containing more or less trait-associated
variants (Hindorff et al., 2009; Schork et al., 2013; Smith et al.,
2011; Yang et al., 2011). Given this, it is potentially of use to
leverage functional annotations or other locus-speciﬁc covariates
to improve gene discovery and replication of associations in de
novo samples.

Classical multiple-comparison procedures, such as the
Bonferroni correction, control the family-wise error rate
(FWER) or the probability of committing one or more Type I
errors in a family of hypothesis tests. These procedures tend to be
underpowered in large-scale testing paradigms (Efron, 2007). In
other words, FWER procedures can be excessively conservative
when thousands or millions of cases are tested. Benjamini and
Hochberg (1995) proposed an alternative approach to Type I
error control termed the FDR, deﬁned as the expected propor-
tion of errors among the rejected hypotheses. Variants of their
algorithm are applied to P-Values of test statistics (null hypoth-
esis tail probabilities) from many tests to control FDR to a
speciﬁed level under various conditions. Efron and Tibshirani
(2002) developed an extension of FDR called the local false dis-
covery rate (fdr) from an empirical Bayes point of View, deﬁning
fdr as the posterior probability that the null hypothesis is true,
given the observed test statistic. The empirical Bayes approach to
fdr is closely related to the Benjamini and Hochberg (1995) al-
gorithm for FDR control (Efron and Tibshirani, 2002).

These groundbreaking methodologies for controlling multipli-
city under large-scale hypothesis testing have received
widespread attention and development (Brown et al., 2005;
Efron, 2007; Ferkingstad et al., 2008; Genovese et al., 2002;
Lawyer et al., 2009; Lewinger et al., 2007; Miller et al., 2001;
Ploner et al., 2006; Sun et al., 2006; Tusher et al., 2001). Lewinger
et al. (2007) proposed a mixture model of non-central x2 test
statistics, where the probability of being associated with a pheno-
type (having a non-centrality parameter different from zero) de-
pends on multiple covariates. Ferkingstad et al. (2008) proposed
an estimator that allows for modulating the fdr of each null
hypothesis based on external covariates. If fdr depends on
levels of a measured covariate, then the exchangeability assump-
tion implicit in the deﬁnition of fdr is not optimal, and sizeable
gains in power can be realized by accounting for this dependence
(Efron, 2010; Sun et al., 2006). The key technique to account for
the dependence of fdr on the covariate x in the approach of
F erkingstad et al. (2008) was to bin the data into B sets according
to ordered values of x. The assumption was that the inﬂuence of
x on the posterior probability is nearly constant in each bin if
bins are small enough (in practice, B = 10 to 20). The fdr is then
estimated in each bin, possibly with smoothing across the bins.
This approach works best for one covariate and becomes imprac-
tical as the number of covariates increases. It has been applied to
large-scale testing of neuroimaging data (Lawyer et al., 2009).

In prior work, we have developed a scheme to assign gene
element—based functional annotations for SNPs genome-wide,
which takes into account the locus—locus correlations [linkage
disequilibrium (LD)] that GWAS depend on for whole genome
coverage (Schork et al., 2013). This LD-weighted annotation
scheme provides multiple scores for each SNP in several genic
categories, including exon, intron, 5’ untranslated regions
(5’UTR) and 3’ untranslated region (3’UTR). Scores incorporate

not only the category of a given variant but also the categories of
all variants for which it is in LD (correlated with). Intergenic
SNPs are deﬁned as having zero scores in all functional cate-
gories and being >100 kb away from a protein-coding gene, pro-
viding a hypothesized ‘null’ collection. Using these functional
annotations and summary statistics from 14 large GWAS, we
showed that test statistics resulting from SNPs that are in LD
with the 5’UTR of genes show the largest abundance of associ-
ations, while SNPs in LD with exons and the 3’UTR are also
enriched. SNPs in LD with introns are modestly enriched and
intergenic SNPs show a depletion of associations, relative to the
average SNP (Schork et al., 2013). A more detailed description of
how the LD-weighted genic annotations were produced is given
in the Supplementary Materials.

This situation is illustrated in Fig. 1, which displays Q—Q plots
of — loglo transformed P—Values from a GWAS of Crohn’s
Disease (CD) of 51109 subjects, obtained through a publicly
accessible database (Franke et al., 2010). Enrichment for true
associations is expressed as a leftward deﬂection of the Q—Q
plots stratiﬁed by genic category, representing an overabundance
of low P-Values compared with that expected under the global
null hypothesis of no associations. Leftward deﬂections are dir-
ectly related to decreased fdr for a given P-Value threshold. The
5’UTR SNPs are most enriched, followed by exons, 3’UTR and
introns. Intergenic SNPs are impoverished for true effects. These
results were consistent across all assessed phenotypes (Schork
et al., 2013) and strongly suggest that all SNPs should not be
treated as a priori exchangeable for purposes of hypothesis test-
ing but that certain categories are much more likely to show an
association.

The current article leverages the information available in genic
annotation categories for large-scale GWAS hypothesis testing

 

 

 

 

 

 

 

~- l
o_ I
I
I
I
I-\ LD- ’
Q. I
‘6 I
‘— I
3 v— I
I I
— I
(U
I
 W i
o I
Z I
I
N' 0 AllSNPs
0 Intergenic
0 5’UTR
F- 0 Exon
Intron
0 3’UTR
O I I I I I I
0 1 2 3 4 5 6

Empirical -log1o(q)

Fig. 1. Q—Q plot of enrichment by functional annotation category for
CD. The x-axis displays —log10 transformed empirical P—Values, and the
y-axis the -log10 transformed nominal P—Values

 

2099

112 [3.1081120an[plOJXO'SODBIILIOJIIlOIQ/[i(11111 IIIOJJ pepeolumoq

910K ‘09 lsnﬁnV no :2

R. W.Zablocki et al.

 

by presenting a novel, fully Bayesian approach for generalized
covariate-modulated local false discovery rate (cmfdr) estima-
tion, implemented using a Markov chain Monte Carlo
(MCMC) sampling algorithm. Through this approach, we are
able to model the inﬂuence of a vector of covariates on the dis-
tribution of the test statistics and hence on the fdr. Section 2
gives a brief review of fdr (Efron and Tibshirani, 2002) and
introduces cmfdr, constructed from a Bayesian two-group mix-
ture model that incorporates covariates. Section 3 presents the
MCMC algorithm for ﬁtting the model and drawing inferences
and applies cmfdr to examples involving both simulated and real
data. The last section is devoted to a discussion of results and
future work.

2 METHODS

Review of fdr

Efron and Tibshirani (2002) made the assumption that the test statistic 2,,
1 5 i 5 n, has a different distribution based on whether the null hypoth-
esis Ho,,- is true or false, where n is the total number of tests (SNPs). The
non-null distribution will tend to have more extreme values of the test
statistic. Hence, 2, follows a two-group mixture model

f(Zi) = Nofo(Zz-) + 711M219, (1)

where no is the proportion of true null hypotheses, n1 = 1 — no is the
proportion of true non-null hypotheses, fo is the probability density func-
tion if Ho is true and fl is the probability density function if Ho is false.
Local false discovery rate (fdr) is the posterior probability that the ith test
is null given 2,, which by Bayes rule is given by

7TQf0(Zi) : 7TQf0(Zi)
ﬂZi) 7TQf0(Zi) + 7T1f1(Zi)'

The null density was assumed to be standard normal (theoretical null)
or normal with mean and variance estimated from the data (empirical
null). The mixture density nofo(z) + n1f1(z) was estimated by ﬁtting a
high-degree polynomial to histogram counts (Efron, 2010). If a set of
SNPs are selected with an estimated fdr 5 or for some or 6 (0,1), then
we expect that on average (1 — or) x 100% of these will be true non-null
SNPs.

 

fdr(z,-) = (2)

Covariate-modulated fdr

A set of external covariates observed for each hypothesis test may inﬂu-
ence the distribution of the test statistic (Efron, 2010; Sun et al., 2006).
Under this scenario, incorporating the covariate effects into fdr estima-
tion can dramatically increase power for gene discovery. For example, the
distribution of GWAS Z-scores may depend on SNP-level functional an-
notations (Schork et al., 2013), pleiotropic relationships with related
phenotypes (Andreassen et al., 2013a, b), gene expression levels in certain
tissues, evolutionary conservation scores and so forth. These external
covariates can be used to break the exchangeability assumption implicit
in Equation (1) and potentially increase the power for gene discovery over
using standard fdr given in Equation (2).

Let x,- = (1, xli, x2,-, ..., xmi)T, where x,- denotes an (m + 1)-dimensional
vector of covariates (including intercept) for the ith SNP. The cmfdr is
deﬁned as

cmfdr(z,-) — 770 (xi)f0(Zi)

ﬂZi Ixi)
_ nun-roe» (3)

7T0(xi)fo(Zi)+7T1(xi)f1(Zilxi)
where n1(x,-) = 1 — no(x,-) is the prior probability that the ith test is non-
null given x,- and f1(z,-|x,-) is the non-null density of 2, given xi. By
Bayes’ rule, cmfdr is the posterior probability that the ith test is null

given both 2, and xi. We assume that the density under the null hypothesis
does not depend on covariates. Both the probability of null status and the
non-null density are allowed to depend on covariates, as described below.

Central to the estimation of the null proportion is the assumption that
no is large (say>0.90) and that the vast majority of SNPs with test stat-
istics close to 0 are in fact null. These assumptions are reasonable for
GWA data (Hon-Cheong et al., 2010).

A Bayesian Two-group model

Summary statistics from GWAS are often made publicly available only as
2-tailed P—values, and hence, the magnitude of the z score is recoverable
but not the sign. Moreover, the sign of the z score is a result of arbitrary
allele coding. Hence, we formulate the mixture model for the absolute
z—scores. The extension of our method to signed z—scores is
straightforward.

Folded normal-gamma mixture model The distribution of 2 under
Ho is assumed to have the folded normal distribution, with null density
fo(z) = 2¢00(2)Izzo, where 45(2) is the normal density with mean 0 and
standard deviation 0’0, and Izzo is an indicator function that takes the
value 1 when Z Z 0 and 0 otherwise. The density of Z under the alternative
hypothesis H1 is assumed to have a gamma distribution with shape par-
ameter u(x) and rate parameter ,8. Figure 2 gives a graphic presentation
of these distributions. We chose a parametric non-null density for com-
putational efﬁciency in modeling the effects of covariates. Parametric
estimates of the non-null density also potentially provide more power
than non-parametric estimates. We chose the gamma density because
of its ﬂexible shape and ability to model right-skewed heavy-tailed
distributions.

Covariates x are allowed to modulate the shape parameter of the
gamma distribution

u(x) = exp{xTa}

where or = {ao, a1, a2, ..., am}T is an unknown parameter vector. The rate
parameter ,8 is an unknown scalar not depending on x. While it is possible
to model the rate parameter as a function of x, we have found that this
leads to poor model convergence in the sampling algorithm, perhaps
because of the lack of identiﬁability with other model parameters.

 

 

 

 

 

Q _
‘_
— Z1: Gamma Distribution
- - - ZO: Folded Normal (theoretical or empirical)
°°. _ -
O \
\
\
\
I
I
I
(o I
c5 _ ‘i
I
I
I
I
I
I
V: _
O
“I _
O
0. _
O
| | | | |
O 2 4 6 8
|Z Score|

Fig. 2. Null and non-null distibutions. Mixture model Equation (1) con-
sists of weighted mixture of folded normal (dotted line) and gamma
densities (solid line)

 

2100

112 [3.1081120an[plOJXO'SODBIILIOJHIOlQ/[l(11111 IIIOJJ pepeorumoq

910K ‘09 isnﬁnV no 22

cmfdr

 

Additionally, we specify a location parameter ,u>0 to bind the non-
null gamma densities away from zero. The ‘zero assumption’ of Efron
(2007) states that the central peak of the z—scores consists primarily of null
cases. Such an assumption is necessary to make the non-null distribution
identiﬁable and for the MCMC sampling algorithm to converge. The
assumption that the vast majority of SNPs with z—scores close to 0 are
null is already commonly made in GWAS. Hence, we set the location
parameter ,u = 0.68 in the gamma distribution, corresponding to the
median of the null density fo. All SNPs with absolute z—scores <0.68
are thus a priori considered null.

We complete the mixture model formulation by positing a latent indi-
cator vector 6 = (61, . . . , 6”), where 6,- : 1 if the ith SNP is non-null and 0
otherwise. Then n1(x,-) is the prior probability that 6,- : 1 given covariates
x,-. The dependence of n1 on x is modeled via a logistic regression

eXp(x,-TV)
1 + exp(xiTy) ’
where y = {yo, y1, y2, ..., ym}T is a vector of unknown parameters. The
augmented likelihood function is then given by

n1(x,-) = PI'(8,' = 1|x,-) =

L(13,ot, V, 03w, 2, X) = H ([ﬁ)(zilog)ﬂo(xily)]1_ai

i=1 (4)
x [f1(Zz-ll3, a)7r1(xilr)]‘3"),
where z = (21, ...,zn)T is the vector of test statistics and X is the

n x (m + 1) design matrix. Integrating out the latent indicators 6 gives
the mixture model corresponding to Equation (3).

Prior distributions We apply weakly informative priors to unknown
parameters {,8, or, y, 03}:

01 ~ N(0, 20,),
y N  2y): 
.3 N Gammaﬂlo, bo),

03 ~ InverseGamma(u,,0 , by0 ),

where 20, and 2,, have large values on the diagonal, do and bo are shape
and rate parameters of gamma distribution and ago and boo are shape and
scale parameters of inverse gamma distribution, respectively.
Hyperparameters are ﬁxed by the user. In the applications below, we
set the dispersion matrices 2a and 2,, to be diagonal with variance
10000; (uo, bo) and (ago, boo) were both set to (0001,0001).

Sampling scheme We sample the parameters or, ,8, y and 03 in turn
from their full conditional distributions via a Gibbs sampler using
Metroplis—Hastings (M-H) steps. Combining (4) and (5), the full condi-
tional distributions are given as follows:

 

 

IZi _ ,u/Ia(xi) a(Xi) WTEJIOt
ﬂOtI . .  OC [ii—[1  ,8 exp{— 2 }
" exp{xTr}"" r9311 r
ao—l+ Z a(xi)

 oc ,8 i:5,-=1

x eXp{-.3(bo + 2 I2,- — m) 
i:8,-=1

n
Zloi=o>
'=1 2 +aa0 +1

 

flail-u) 0C (03)(

Z Z?
1 i28i=0 b
xexp a—g(T+ a.)

where [(ozo) is an indicator function, and f(-| . . .) denotes the probability
density of a parameter conditional on all other parameters and the data.
The full conditional posteriors for or and y in (6) do not take standard
forms and are sampled using a multiple-try M-H sampler (Givens and
Hoeting, 2005) with a multivariate t-distribution candidate. The full con-
ditional for ,8 has a gamma distribution and for 03 an inverse gamma
distribution, so that both can be sampled directly. Each iteration of the
Gibbs sampler also includes generation of 8, with a Bernoulli full condi-
tional distribution. For k E {0, 1}

T k
6_:km _21—k _ _, k eXP(xiV) '
p( . l ) oc M2100) flow.) 13) 1 + expat,”
We can obtain an a posteriori estimate of cmfdr(z,-) for each 2,- as
follows. Assume we have L draws {090,050, WAGS”) : 1 5 l 5 L} from
the posterior distribution of the parameters. For each draw I,

no(xilr(”)ﬁ)(Zz-|0§w) .
no(x.-Iy<’))ﬁ)(z.-Ia§(”) + n1(xi|1/(’))f1(Zz-Il3(’), a(xila(’)))

Then, for example, the posterior median of cmfdr(z,-) can be estimated
by taking the median of cmfdr(’)(z,-) across all L posterior draws. The
algorithm has been implemented in the R statistical package and is avail-
able at https.'//Sites.g00gle.com/site/covmoafdrl

cmfdr(l)(z,-) =

 

3 RESULTS

Simulation

We simulated phenotypes under different settings of generative
parameters from real genotype data available for n: 3719
healthy individuals. For each permutation of simulation settings,
we generated 100 unique phenotypes. We restricted our simula-
tions to chromosome 1 (N: 191 128 SNPs) for computational
efﬁciency, assuming it was representative of the whole genome.
These simulations allow us to evaluate the performance of our
method in scenarios that approximate realistic GWAS condi-
tions, including correlated SNPs according to true LD patterns.
A detailed description of the simulations and an expanded table
including comparisons with the methods of Efron (2007) and
Lewinger et al. (2007) are given in the Supplementary Materials.

Table 1 displays the median number of SNPs rejected and the
false discovery proportion (F DP), or the proportion of rejected
SNPs not in LD with a causal SNP. The cmfdr performs rea-
sonably well across enrichment settings for more highly poly-
genic phenotypes, rejected SNPs conservatively for n1 2 0.05,
but becoming progressively worse at controlling the FDP for
phenotypes with low n1. The fdr of Efron (2007) controls the
F DP at similar levels but also has less power than cmfdr
(Supplementary Table S5). The x2 mixture model of Lewinger
et al. (2007) rejects more SNPs than either fdr or cmfdr, but also
exhibits considerably higher FDP across the range of polygeni-
city levels. In particular, their model is unstable for null GWAS.

Real data application

The data consist of 112942 772 SNP summary test statistics
(SNP z—scores) from a GWAS meta-analysis of eight substudies
of CD on n = 21 389 subjects (6333 cases), obtained through a

 

2101

112 ﬂJO'sreumo[pJOJXO'sopeuuogutotq/ﬁdnq IIIOJJ popcorn/hog

910K ‘09 isnﬁnV no 22

R. W.Zablocki et al.

 

Tablel. Simulation study results

 

 

n1 Enr. Strat. Rejected FDP

0.00 None None 1 [0,5] 1.00 [0.00,1.00]
0.00 None Low 4 [0,15] 1.00 [0.00,1.00]
0.001 None None 79 [45,137] 0.25 [011,042]
0.001 None Low 19 [4,70] 0.55 [019,079]
0.001 Low None 92 [62,149] 0.30 [000,046]
0.001 Low Low 17 [4,77] 0.44 [000,070]
0.001 High None 90 [63,132] 0.28 [013,041]
0.001 High Low 17 [5,47] 0.46 [021,067]
0.01 None None 7 [1,19] 0.00 [000,017]
0.01 None Low 6 [1,18] 0.25 [000,085]
0.01 Low None 43 [17,101] 0.10 [000,020]
0.01 Low Low 9 [1,38] 0.23 [000,067]
0.01 High None 60 [16,124] 0.11 [000,023]
0.01 High Low 8 [1,28] 0.14 [0.00,1.00]
0.05 None None 4 [0,17] 0.00 [000,017]
0.05 None Low 4 [0,15] 0.00 [0.00,1.00]
0.05 Low None 39 [8,106] 0.00 [000,007]
0.05 Low Low 8 [2,25] 0.00 [059,023]
0.05 High None 47 [18,101] 0.00 [000,007]
0.05 High Low 8 [1,27] 0.00 [000,023]

 

Note: Median number of SNPS rejected (Rejected) and FDP for the proposed cmfdr
methodology. Settings include level of polygenicity (n1), level of covariate enrich-
ment (Enr.) and level of population stratiﬁcation (Strat.). Numbers in brackets give
middle 95% of distributions across 100 simulations for each setting. A SNP was
rejected if its cmfdr was 5 0.05. Details of simulation settings and more extended
comparisons are given in the Supplementary Materials.

publicly accessible database (Franke et al., 2010). CD is a type of
inﬂammatory bowel disease that is caused by multiple factors in
genetically susceptible individuals. For this example, we selected
the ﬁve SNP annotations from Schork et al. (2013) displayed in
Fig. 1 to serve as covariates: intron, exon, 3’UTR, 5’UTR and
intergenic; all annotation scores with the exception of Intergenic
were ﬁrst log transformed. These were entered together into the
covariate-modulated mixture model, with the empirical null
setting. The MCMC algorithm was run for 25 000 iterations
with 20 000 retained draws. Plots of posterior draws showed con-
vergence to stable posterior distributions for all parameters.
Figure 3 shows the histogram of z—scores (all cases), the null
subdensity nofo and the posterior median ﬁt of the mixture dens-
ity. The estimated overall non-null proportion n1 is 0.014. The
fdr for each z—score is given by the height of the null subdensity
at that score divided by the height of the mixture density. The
parameter estimates are shown in Table 2. The 3’UTR and
5’UTR categories are associated with higher values of the
shape parameter (and hence higher variance). Intron, exon,
3’UTR and 5’UTR are all associated with higher probability of
non-null status. In contrast, intergenic SNPS are associated with
higher values of the shape parameter and much lower probability
of non-null status (0.001 non-null proportion for intergenic SNPS
compared with the overall n1 2 0.014). The positive 0? coefﬁcient
for intergenic SNPS is a reﬂection of this sparsity because inter-
genic SNPS require more extreme z—scores than genic SNPS to
obtain a high-posterior probability of being non-null.

Density

 

 

 

 

 

 

 

 

 

 

 

All SNPS

Fig. 3. Histogram of CD absolute z—scores. Solid line gives estimated null
subdensity no(x)fo(z), where x was set to the sample mean. Dashed
line gives estimated overall mixture model f(2) = no(x)fo(z) +
n1(x)f1(z|(x)). The fdr for each 2 score is given by the height of the
null subdensity at that score, divided by the height of the mixture density.
Local FDR 5 0.05 for z—scores >4.05 (vertical bar)

Table 2. Parameter estimates with 95% posterior credible intervals from
CD GWAS

 

 

Parameters 61 17

Intercept 0.33 [045,057] —4.58 [—4.81,—4.35]
Intron —0.04 [—0.01,0.01] 0.22 [017,027]
Exon —0.13 [—0.16,—0.10] 0.82 [076,089]
3’UTR 0.05 [002,008] 0.27 [021,034]
5’UTR 0.23 [017,028] 0.40 [031,050]
Intergenic 0.77 [056,098] —2.4 [—2.83,—1.97]

Rate parameter (3) 1.50 [1.48,1.53]

 

Note: All estimates are presented in the form of median [95% credible interval].

Figure 4 compares the number of non-null SNPS rejected using
usual fdr (Efron, 2007), and cmfdr with the ﬁve annotation cate-
gories. cmfdr rejected far more SNPS than fdr (Efron, 2007). For
example, for a 0.05 cutoff, cmfdr rejects 3194 SNPS, whereas fdr
rejects only 592, a factor of 5.4 times as many rejected SNPS.
These 3194 SNPS consisted of 108 independent loci (leading SNP
cmfdr 5 0.05 and >1 Mb apart from each other). Of these 108
independent loci, 66 had been previously described in Franke
et al. (2010). Franke et al. (2010) described an additional ﬁve
loci that were not discovered using a 0.05 cutoff; however, in our
analysis, each of these loci had a cmfdr <0.06. We found 42
novel loci where the leading SNP had a cmfdr 5 0.05. Reporting
these ﬁndings as discoveries in accordance with the best practices
in GWAS would require replication in an independent sample
and a detailed characterization of their biological signiﬁcance,

 

2102

112 /810's112umo[p101x0'sot112u1101utotq/ﬁd11q 111011 pepeolumoq

910K ‘09 isnﬁnV no 22

cmfdr

 

 

 

— Efron fdr
- - cmfdr , o ’

 

 

 

rejection count
1000 2000 3000 4000 5000
I

0
|
_ ___~‘
\
\
\
x
\
\
— \
1
\
1
\

 

 

 

 

0.00 0.05 0.10 0.15 0.20

alpha

Fig. 4. Power of fdr versus cmfdr. The x-axis is the cutoff to declare
SNPs signiﬁcant; the y-axis is number of rejected SNPs times 1-nominal
fdr. The solid line indicates the number of SNPs rejected for usual fdr
(Efron, 2007) using empirical null. The dashed line indicates the number
of SNPS rejected using cmfdr with empirical null. SNPS not pruned
for LD

both of which are beyond the scope of this article. However, to
demonstrate that our proposed method identiﬁes plausible can-
didate SNPS that might warrant this further investigation, we
undertook a pleiotropy analysis. Given that CD is known to
share etiology, including pleiotropic genetic factors (Cho and
Brant, 2011) with ulcerative colitis, it is likely that causal SNPS
would show joint associations. We found signiﬁcant enrichment
for nominal associations (p<0.05) with ulcerative colitis
(Anderson et al., 2011) for both the 71 previously discovered
loci (Bonferroni adjusted hypergeometric P—Value =
1.33 x 10‘36) and the 42 novel loci (Bonferroni adjusted hyper-
geometric P—value = 6.24 x 10‘s). A complete list of previously
discovered and novel gene names is given in the Supplementary
Materials.

We performed further analyses on CD substudies to determine
whether this observed increase in the number of loci declared
signiﬁcant translates to increased number of replicating SNPS
in de novo samples. The CD meta-analysis was composed of
summary statistics from eight substudies (Franke et al., 2010).
We computed z—scores from each of the 70 possible combinations
of four substudies, leaving the z—scores computed from the re-
maining four independent substudies as test samples. We then
estimated fdr and cmfdr for each training sample. For a given fdr
cutoff, we determined the number of SNPS that replicated in the
test sample. Replication was deﬁned as one-sided P 5 0.05 and
with the same sign as the corresponding z score in the training
sample.

Number of replicated SNPS was much higher using cmfdr
compared with fdr. For example, for usual fdr there was an
average of 365 replicated SNPS (94.6% of SNPS declared signiﬁ-
cant) with an fdr cutoff of 0.05 in the training sample. In con-
trast, with the same cutoff using cmfdr, there was an average of
2956 SNPS (92.5% of declared signiﬁcant SNPS) that replicated
according to this deﬁnition, or almost 8.1 times as many SNPS.

Similar increases in the number of replicated SNPS was observed
for other cutoffs in the range. The larger number of SNPS
declared signiﬁcant for cmfdr compared with usual fdr largely
remained when matched with empirical replication rates rather
than nominal fdr threshold. For example, there was an average
of 339 SNPS declared signiﬁcant using usual fdr with an empir-
ical replication rate of 0.95, compared with 2769 using cmfdr, or
8.2 times as many SNPS. In general, and in contrast to some of
the simulation settings, replication rates were close to nominal
for both usual fdr and cmfdr, across a range of cutoffs.

4 DISCUSSION

Methods for large-scale hypothesis testing that control Type I
error rates without being overly conservative are crucial in
GWAS (Efron, 2007; Franke et al., 2010). It has become increas-
ingly evident that many complex phenotypes and diseases have
many genetic determinants, each with small effect Wang et al.,
2010). Hence, traditional FWER correction is too conservative
and severely underpowered. FDR (Benjamini and Hochberg,
1995) and fdr (Efron and Tibshirani, 2002) have come to be
accepted broadly as routine techniques to control for the rate
of false positive in large-scale hypothesis testing settings in a
number of ﬁelds. However, even these methods do not account
for the vast majority of phenotypic variance explained by
common variants (Andreassen et al., 2013b). A problem with
these and other multiple testing methods is that all SNPS are
treated as exchangeable. In particular, each SNP is given the
same a priori probability of being non-null. On the contrary,
we (Schork et al., 2013) and others (Hindorff et al., 2009;
Smith et al., 2011; Yang et al., 2011) have shown that the func-
tional role of SNPS has a strong impact on the probability of
association across a broad array of complex phenotypes and
diseases.

This work proposes a novel Bayesian approach (cmfdr) to
incorporate a set of important covariates into the fdr under a
heteroscedastic model, where the probability of non-null status
and the distribution of the test statistic under the non-null hy-
pothesis are both modulated by covariates. The primary advan-
tage of our methodology over traditional fdr methods is that two
SNPS with the same z score can have different values of cmfdr if
one is in a more enriched category than the other. Hence, by
using SNP annotations to modulate fdr, more SNPS can be dis-
covered for a given level of fdr control. In other words, methods
such as cmfdr that break the exchangeability assumption are
potentially more powerful than traditional fdr methods that
assume exchangeability. In the CD example, we discovered 5.4
times as many SNPS (unpruned) using cmfdr compared with
usual fdr for an identical 0.05 cutoff. The increase in number
of replicated SNPS in de novo subsamples from fdr to cmfdr was
even more dramatic. Parameter estimates of covariates can also
be biologically informative about the relative functionality of
different biological classiﬁcations of variants.

It is crucial to note that our LD—weighted SNP annotations
were computed independently of the phenotypes investigated.
Thus, modifying the fdr based on information from genic cate-
gories does not bias results toward rejecting more null hypoth-
eses. Moreover, the cmfdr methodology is capable of handling
any relevant source of information, including, for example,

 

2103

112 /810's112umo[p101x0'sot112u1101utotq/ﬁd11q 111011 papeolumoq

910K ‘09 isnﬁnV no 22

R. W.Zablocki et al.

 

pleiotropic relationships of SNPS with multiple phenotpyes
(Andreassen et al., 2013a, b), gene expression levels in various
tissues and evolutionary conservation scores, among others.

The proposed methodology has some drawbacks. First, as
currently formulated, it assumes all hypothesis tests are inde-
pendent. This is not true for SNPs in LD, and our 95% credible
intervals are probably too small. Moreover, it remains unclear
what impact LD has on F DP control because it may be the case
that all or almost all ‘tag SNPs’ are in partial LD with causal
SNPS but are not themselves causal. Correlation across SNPS
can be handled, for example, by repeatedly and randomly prun-
ing SNPS for independence before running the MCMC algo-
rithm, by using a discrete Markov random ﬁeld formulation
(Li et al., 2010) or by modeling SNPS simultaneously using, for
example, a multivariate mixed-effects model framework
(Carbonetto and Stephens, 2013). We have implemented a
random pruning option available with the R code distribution.
Second, it may be the case for some applications that the gamma
distribution does not ﬁt the tail probabilities of the non-null
distribution well. We have used other distributions (e. g. the
skewed generalized normal) and are currently developing a
non-parametric alternative that produces ﬂexible ﬁts to tail prob-
abilities. Although non-parametric estimates of the non-null
density avoid bias from lack of model ﬁt, parametric alternatives
can be more powerful if the ﬁt is adequate. Finally, it appears
from simulations that the cmfdr methodology can be overly lib-
eral in scenarios where n1 is close to 0. Care must therefore be
taken when applying cmfdr in these circumstances.

ACKNOWLEDGEMENTS

The authors thank Dr Verena Zuber for her comments. The
authors would also like to thank the anonymous reviewers for
their valuable suggestions.

Funding: This work was supported by NIH grants
R01DE019656, R01HD061414, R01MH100351, and
RGM104400-01A1.

Conflict of Interest: none declared.

REFERENCES

Anderson,C.A. et al. (2011) Meta-analysis identiﬁes 29 additional ulcerative colitis
risk loci, increasing the number of conﬁrmed associations to 47. Nat Genet, 43,
246—252.

Andreassen,O.A. et al. (2013a) Improved detection of common variants associated
with schizophrenia by leveraging pleiotropy with cardiovascular disease risk
factors. Am. J. Hum. Genet, 7, 197—209.

Andreassen,O.A. et al. (2013b) Improved detection of common variants associated
with schizophrenia and bipolar disorder using pleiotropy-informed conditional
False Discovery Rate method. PLoS Genet, 9, e1003455.

Benjamini,Y. and Hochberg,Y. (1995) Controlling the false discovery rate: a prac-
tical and powerful approach to multiple testing. J. R. Stat. Soc. Ser. B, 57,
289—300.

Brown,L. et al. (2005) Statistical analysis of a telephone call center: a queueing-
science perspective. J. Am. Stat. Assoc., 100, 36—50.

Carbonetto,P. and Stephens,M. (2013) Integrated enrichment analysis of variants
and pathways in genome-wide association studies indicates central role for IL-2
signaling genes in type 1 diabetes, and cytokine signaling genes in Crohn’s
Disease. PLoS Genet, 9, e1003770.

Cho,J.H. and Brant,S.R. (2011) Recent insights into the genetics of inﬂammatory
bowel disease. Gastroenterology, 140, 1704—1712.

Collins,F. (2010) Has the revolution arrived? Nature, 464, 674—675.

Devlin,B. and Roeder,K. (1999) Genomic control for association studies.
Biometrics, 55, 997—1004.

Efron,B. (2007) Size, power and false discovery rates. Ann. Stat, 35, 1351—1377.

Efron,B. (2010) Large-Scale Inference: Empirical Bayes Methods for Estimation,
Testing, and Prediction. Cambridge:Cambridge University Press.

Efron,B. and Tibshirani,R. (2002) Empirical bayes methods and false discovery
rates for microarrays. Genet. Epidemiol, 23, 70—86.

The ENCODE Consortium. (2012) An integrated encyclopedia of DNA elements in
the human genome, Nature, 489, 57—74.

Ferkingstad,E. et al. (2008) Unsupervised empirical bayesian multiple testing with
external covariates. Ann. Appl. Stat, 2, 714—735.

Franke,A. et al. (2010) Genome-wide meta-analysis increases to 71 the number of
conﬁrmed Crohn’s disease susceptibility loci. Nat Genet, 42, 1118—1125.

Genovese,C.R. et al. (2002) Thresholding of statistical maps in functional neuroi-
maging using the false discovery rate. Neuroimage, 15, 870—878.

Givens,G.H. and Hoeting,J.A. (2005) Computational Statistics. Vol. 483. Wiley-
Interscience Press, Hoboken, NJ, USA.

Hindorff,L.A. et al. (2009) Potential etiologic and functional implications of
genome-wide association loci for human diseases and traits. Proc. Natl Acad.
Sci. USA, 106, 9362—9367.

Hon-Cheong,H. et al. (2010) Estimating the total number of susceptibility variants
underlying complex diseases from genome-wide association studies. PloS One, 5,
e13898.

Lawyer,G. et al. (2009) Local and covariate-modulated false discovery rates applied
in neuroimaging. Neuroimage, 47, 213—219.

Lewinger,J.P. et al. (2007) Hierarchical Bayes prioritization of marker associations
from a genome-wide association scan for further investigation. Genet.
Epidemiol., 31, 871—883.

Li,H. et al. (2010) A hidden Markov random ﬁeld model for genome-wide associ-
ation studies. Biostatistics, 11, 139—150.

Manolio,T.A. et al. (2009) Finding the missing heritability of complex diseases.
Nature, 461, 747—753.

Miller,C.J. et al. (2001) Controlling the false discovery rate in astrophysical data
analysis. Astron. J., 122, 3492—3505.

Ploner,A. et al. (2006) Multidimensional local false discovery rate for microarray
studies. Bioinformatics, 22, 556—565.

Risch,N. and Merikangas,K. (1996) The future of genetic studies of complex human
diseases. Science, 255, 1516—1517.

Schork,A.J . et al. (2013) Genetic architecture of the missing heritability for complex
human traits and diseases. PLoS Genet, 9, e1003449.

Smith,E.N. et al. (2011) Genome-wide association of bipolar disorder suggests an
enrichment of replicable associations in regions near genes. PLoS Genet, 7,
e1002134.

Sun,L. et al. (2006) Stratiﬁed false discovery control for large-scale hypothesis test-
ing with application to genome-wide association studies. Genet. Epidemiol., 30,
519—530.

Torkamani,A. et al. (2011) Annotating individual human genomes. Genomics, 98,
233—241.

Tusher,V.G. et al. (2001) Signiﬁcance analyses of microarrays applied to the ioniz-
ing radiation response. Proc. Natl Acad. Sci. USA, 98, 5116—5121.

Yang,B. et al. (2010) Common SNPS explain a large proportion of the heritability
for human height. Nat Genet, 42, 565—569.

Yang,J. et al. (2011) Genome partitioning of genetic variation for complex traits
using common SNPS. Nat Genet, 43, 519—525.

 

2104

112 /810's112umo[p101x0'sot112u1101utotq/ﬁd11q 111011 papeolumoq

910K ‘09 lsnﬁnV no 22

