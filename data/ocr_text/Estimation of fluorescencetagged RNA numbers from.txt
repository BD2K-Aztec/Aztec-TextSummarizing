ORIGINAL PAPER

Vol. 30 no. 8 2014, pages 1146-1153
doi: 1 0. 1093/bioinformatics/btt7 66

 

Gene expression

Advance Access publication January 2, 2014

Estimation of fluorescence-tagged RNA numbers from

spot intensities

Antti Hakkinen, Meenakshisundaram Kandhavelu, Stefania Garasto and Andre S. Ribeiro*
Department of Signal Processing, Laboratory of Biosystem Dynamics, Computational Systems Biology Research Group,

Tampere University of Technology, Tampere, Finland
Associate Editor: Martin Bishop

 

ABSTRACT

Motivation: Present research on gene expression using live cell ima-
ging and fluorescent proteins or tagged RNA requires accurate auto-
mated methods of quantification of these molecules from the images.
Here, we propose a novel automated method for classifying pixel
intensities of fluorescent spots to RNA numbers.

Results: The method relies on a new model of intensity distributions of
tagged RNAs, for which we estimated parameter values in maximum
likelihood sense from measurement data, and constructed a maximum
a posteriori classifier to estimate RNA numbers in fluorescent RNA
spots. We applied the method to estimate the number of tagged
RNAs in individual live Escherichia coli cells containing a gene
coding for an RNA with MSZ-GFP binding sites. We tested the
method using two constructs, coding for either 96 or 48 binding
sites, and obtained similar distributions of RNA numbers, showing
that the method is adaptive. We further show that the results agree
with a method that uses time series data and with quantitative poly-
merase chain reaction measurements. Lastly, using simulated data,
we show that the method is accurate in realistic parameter ranges.
This method should, in general, be applicable to live single-cell meas-
urements of low-copy number fluorescence-tagged molecules.
Availability and implementation: MATLAB extensions written in C for
parameter estimation and finding decision boundaries are available
under Mozilla public license at http://www.cs.tut.fi/%7ehakkin22/
estrna/.

Contact: andre.ribeiro@tut.fi

Received on October 28, 2013; revised on December 9, 2013;
accepted on December 25, 2013

1 INTRODUCTION

The processes of production and degradation of RNA and pro-
tein numbers are stochastic, which causes these numbers to differ
between individuals (Elowitz et al., 2002; Kaern et al., 2005;
Ozbudak et al., 2002; Taniguchi et al., 2010; Yu et al., 2006)
and to vary over time in individual cells, even under optimal
stable conditions (Golding et al., 2005; Kandhavelu et al.,
2012b). Present measurement techniques to study these processes
in live cells rely on the usage of ﬂuorescent proteins (Montero
Llopis et al., 2010; Raj et al., 2008), and consequently on

 

*To whom correspondence should be addressed.

ﬂuorescent microscopy and image processing methods, to extract
the relevant statistical data.

One of the most accurate techniques to quantify gene expres-
sion dynamics in viva consists of tagging target RNA molecules
with multiple MS2d-GFP proteins, which makes the target
RNA transcripts visible as bright spots (Golding and Cox,
2004), as soon as these are transcribed (Golding and Cox,
2004; Peabody, 1993). The present method of quantifying the
RNA numbers in cells or in the ﬂuorescent RNA spots relies
on a manual selection of the intensity of a single-tagged RNA
using the histogram of ﬂuorescence intensities (Golding et al.,
2005). Following this selection, this method assumes that the
peaks of spots intensities are concentrated at multiples of the
expected intensity of a single RNA (Golding et al., 2005), so as
to quantify the number of RNA molecules in spots of varying
ﬂuorescence intensities.

This method of quantiﬁcation is not optimal for several rea-
sons. First, it relies on human intervention, and the manual se-
lection can have a major effect in the results of the process
of counting the RNA molecules. This hampers comparison
between results because the selection of the intensity of the
first peak varies between users. Second, the distribution of
the number of RNA molecules composing the spots is not
uniform, and thus the optimal quantiﬁcation of these numbers
is not achieved by simple rounding. Third, the variance in
intensities of the spots is expected to increase with the num-
ber of tagged RNAs composing the spot. Fourth, the tagged
RNA molecules tend to accumulate at the poles of the cells,
and one cannot rely on spatial separation between them
(Golding and Cox, 2004; Lloyd-Price et al., 2012). Lastly,
for large datasets, manually assisted quantiﬁcation can be
excessively laborious.

Here, we propose an automatic method that improves on the
RNA quantiﬁcation from ﬂuorescence images. For this, we es-
tablish a mathematical model of the intensities, which is free
from any assumption on the shape of the distribution of the
RNAs, as this distribution is the subject of the study. Also, we
propose methods to estimate the parameters of the model and
construct a classiﬁer. We then exemplify the usage of the method
in determining the number of RNAs in clusters of MS2—GFP-
tagged RNA molecules in Escherichia coli under various condi-
tions. In particular, we compare results of analyzing cells with
one of two target RNA constructs that differ in the number of
binding sites for MS2—GFP proteins. In addition, the results are
compared with a method that uses temporal information for the
RNA quantiﬁcation, and results from cells subject to different

 

1146 © The Author 2014. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com

112 /§.IO'S[BU.IHO[p.IOJXO'SOTlBIHJOJUTOTQ/ﬁ(1111] uIOJj pepBOIUAAOG

9IOZ ‘091sn3nv uo ::

Estimating RNA numbers from spot intensities

 

levels of induction of target RNA are compared with quantita-
tive polymerase chain reaction (qPCR) measurements. Lastly, we
study the performance of the classiﬁer on simulated data, whose
ground truth is known, and compare it with that of the previous
method.

2 SYSTEM AND METHODS

2.1 Cells and plasmids

Escherichia coli strain DHSa-PRO was provided by I. Golding
(University of Illinois) and contains two constructs: a PROTET-K133
medium-copy vector carrying a MS2d-GFP reporter, controlled by
PLteto_1, and the pIG—BAC single-copy vector coding for mRFPl-MS2—
96bs RNA, whose expression is controlled by Plac/ara_1 (Golding and
Cox, 2004).

The second construct was engineered by us, and it was designed to
contain 48 binding sites (bs) for MS2—GFP. The target-gene vector pMK-
BAC, containing Plac/ara_1 with a 48 MS2—GFP binding site array in a
single-copy bacterial artiﬁcial chromosome (BAC), was constructed using
standard molecular biology methods. Plac/ara_1-48bs was ampliﬁed with
smaI restriction endonuclease from a BAC clone carrying a target gene
Plac/ara_1-mRFP1-96bs. The primers (forward: 5’
CCCGGGGAAGACATGAGGATCA 3’ and reverse: 5’ CCCGG
GTCAATTCTGTGTGAAATTG 3’) were designed to amplify the
Plac/ara_1-48bs with smaI restriction site ﬂanking regions. The amplicon
and the BAC vector were subjected to smaI restriction digestion, followed
by ligation of the ampliﬁed product. We obtained a single-copy F-based
plasmid carrying the target region Plac/ara_1 with a 48bs array. This prod-
uct was transformed into the competent E.coli strain DHSa-PRO. The
recombinants were selected with antibiotic screening and conﬁrmed with
sequence analysis.

2.2 Microscopy measurements

Cells were grown in Miller lysogeny broth (LB) medium, supplemented
with antibiotics according to the speciﬁc plasmids. Cells were grown
overnight at 37°C with aeration, diluted into fresh medium and allowed
to grow at 37°C until an optical density of OD600 of 0.3—0.5 was reached.
To attain full induction of the MS2d-GFP reporter, cells were incubated
with 100 ng/ml of anhydrotetracycline (aTc, from IBA GmbH). In all,
0.1% of L-arabinose (Sigma-Aldrich) and 1 mM of isopropyl—ﬁ-D-thioga-
lactopyranoside (IPTG, Fermentas) were used to fully induce the target
RNA. In one case, IPTG was not added, so that the target gene remains
only weakly induced. Cells were preincubated with arabinose at the same
time as aTc. IPTG was added (if added) 1h after aTc, and cells were
incubated for 5 min.

Microscopy was performed using a Nikon Eclipse (TE-2000-U,
Nikon, Tokyo, Japan) inverted confocal laser-scanning microscope.
Cells were imaged in a thermal chamber set to 37°C. Single time-point
images were taken 1h after induction by IPTG (if induced). For time
series, images were taken 5 min after induction by IPTG, for 2 h, once per
minute.

For imaging, a few microliter of culture were placed between a
coverslip and a slab of 1% agarose containing LB along with the appro-
priate concentrations of inducers. When both the reporter and the target
RNA are present in the cells, MS2d-GFP proteins bind to the target
RNA, forming a bright ﬂuorescent spot (Golding et al., 2005).
The RNA becomes visible during or shortly after elongation (Golding
and Cox, 2004).

2.3 The qPCR analysis of the target RNA

The target RNA was induced as described earlier in the text. Following
induction, the cells were immediately ﬁxed with RNAprotect bacteria

reagent, followed by enzymatic lysis with Tris-EDTA lysozyme buffer
(pH 8.3). From the lysed cells, total RNA was isolated with RNeasy
RNA puriﬁcation kit (Qiagen), according to the manufacturer’s instruc-
tions. DNaseI treatment was performed to avoid DNA contamination.
The complementary DNA (cDNA) was synthesized (Fermentas, Finland)
from 1 ug of RNA with iScript Reverse Transcription Supermix, accord-
ing to the manufacturer’s instructions. The cDNA templates with ﬁnal
concentration of 10 ng/ul were added to the qPCR master mix, which
contained iQ SYBR Green supermix (Fermentas, Finland) with primers
for the target and reference genes at a ﬁnal concentration of 200 nM.

We used the 16S ribosomal RNA housekeeping gene for internal
reference. The primers for the target mRNA (forward: 5’
TACGACGCCGAGGTCAAG 3’ and reverse: 5’ TTGTGGGA
GGTGATGTCCA 3’) target the mRFPl coding region and the reference
gene 16S ribosomal RNA (forward: 5’ CGTCAGCTCGTGTTGTGAA
3’ and reverse: 5’ GGACCGCTGGCAACAAAG 3’). The experiment
was performed using a Biorad MiniOpticon real-time PCR system
(Biorad, Finland) with the following thermal cycling protocol: 40 cycles
of 95°C for 10 s, 52°C for 30 s and 72°C for 30 s for each cDNA replicate.
Reactions were performed in two experiments, each with two
replicates per condition with a ﬁnal reaction volume of 50 ul.
Nonspeciﬁc signals and contamination were crosschecked using no
reverse transcriptase and no template controls. PCR efﬁciencies of the
reactions were >95%. The CFX Manager Software was used to calculate
relative expression, whereas standard errors were calculated as in Livak
and Schmittgen (2001).

2.4 Image processing

The individual frames of cells were analyzed as follows. First, the cells in
the images were segmented using an automatic method (Chowdhury
et al., 2013). Next, the each cell intensity is ﬁt to a surface, which is a
quadratic polynomial of the distance from the cell border, in least-devia-
tions sense, which is subtracted to obtain the foreground intensity. The
foreground intensity is ﬁt with a set of Gaussian surfaces, in least-devi-
ations sense, with decreasing heights until the heights are in the 99%
conﬁdence interval of the background noise (estimated assuming a
normal distribution and using median absolute deviation). The
Gaussians are taken to represent spots, the volume under each
representing the total spot intensity. Meanwhile, the volume under the
whole foreground surface is taken to represent the total cell intensity. The
time series analysis was performed as described in Kandhavelu et al.
(2012b), from segmentation to spot intensity calculation and RNA esti-
mation. The new procedure was found to perform similar but had lower
noise in spot intensities than the method from Kandhavelu et al. (2012b).

3 ALGORITHM

3.1 Model of RNA spot intensities

The target RNA contains either 96 or 48 bs (earlier in the text)
for MS2d-GFP molecules (Golding et al., 2005). Not necessarily
are all the binding sites occupied by GFPs at all moments, but it
is reasonable to assume that a large number of the binding
sites are occupied, as the MS2—GFP is highly abundant in the
cells, and the spots are easily visible at almost all time. The
observed intensity can also vary because of other reasons, such
as variations of the molecule locations with respect to the focal
plane.

If the amounts of light detected from a single GFP are
independent and identically distributed, and the binding of
MS2—GFP molecules are independent, occurring with a constant
probability, the amount of light detected from a single-tagged

 

1147

112 /§.IO'S[BU.IHO[p.IOJXO'SOIlBIHJOJUIOIQ/ﬁ(1111] uIOJj peptaoIHAAoq

9IOZ ‘091sn3nv uo ::

A.Hakkinen et aI.

 

RNA should follow a binomially weighted mixture of sums of
the amounts of lights detected from single MS2—GFPs.
Regardless, if this is strictly true, given a large number of
independent sources of light, the light detected from a single-
tagged RNA can be well approximated by a normal distribution
(central limit theorem), if the signal-to-noise ratio is low. If the
signal-to-noise ratio was high, it would be possible to estimate
the GFP numbers instead.

Letting the light detected from a single-tagged RNA to follow
normal distribution N(,u., 02) with mean of ,u. and variance of 02,
the light emitted by k-tagged RNAs will be distributed according
to N (k ,u.,k02), if the light emitted by the tagged RNAs are
independent of one another. If the probability for ﬁnding a clus-
ter of k-tagged RNAs is given by oak, the mixture density takes
the form as follows:

fM(xI/’L9029a19  
[6:1

°° 05k (x — k 102)
gvznkaz ( 21w2
where f N(x | 11,02) is the density of a normal distribution with a
mean of ,u. and variance of 02.
We do not wish to impose any constraints (model) on the

distribution deﬁned by oak, which represents the RNA
distribution, as this distribution is the subject of the study.

3.2 Parameter estimation

The form of the density of Equation (1) makes ﬁnding closed-
form estimates for the parameters hard. We solve the problem
by applying expectation maximization (EM) algorithm
(Dempster et al., 1977). The EM algorithm iteratively estimates
new parameters 0’ using the ‘incomplete’ (observed) data y, the
‘complete’ data x and the current parameter estimates 0 by
maximizing:

Q(0’ l 0) = [E[10gf(x l 0’) ly, 0] (3)

where f(x | 0) is the complete data density.

We denote the parameters by 0 i (11,02, a1, - - - , cm). The log-
likelihood function for 0 given the intensity observations
y i (yl, ---,yM) and the RNA numbers k t (k1, ---,kM) is as
follows:

M
1(0 1 x) = Zlog{ 01k, fN(y, | k, 11, k, 02) } (4)
i=1
M 1 0’1 — k1 W2
: gIOgOlki —  — IOgU —  

where x = (y, k) is the complete data. The distribution of the
missing parameter K,- under the parameters 0 is given by the
following equation:
. 05 - i k1 ,kiaz
W. = P119 =k,-1y,01 = N @me ” ) (6)
Z ak’fNO’i | k’ M91502)

k’zl

 

which yields the following form for Q(0’ | 0):

M N
Q(0’ l 0) = Z 2 Wk. 6(0’ l 011,169) (7)

i=1 kizl

The parameters 0’ maximizing Equation (7) can be found by
ﬁnding the roots of the partial derivatives and verifying that the
obtained point is a global maximum. The estimators are as
follows:

1 M
a}. =MZWI. (8)
i=1

N ‘1 1 M
[1’ =  MZJ’i (9)
[(21 i=1

M N

N —1
6’2=(k2_1)k&;.) ﬁZwai—kmz (10)

1:1 k:1

where the variance estimator involves the true parameter ,u. If
the estimator ,11’ is substituted for ,u, Bessel’s correction should be
applied (or the variance will be underestimated on average).

Lastly, we note that in our case the EM iteration is guaranteed
to converge to a maximum of the likelihood function (\Nu, 1983).
However, this maximum is not guaranteed to be the global max-
imum (Wu, 1983). For this reason, it is required that either the
initial parameter values for the EM algorithm are close to the
optimal values or multiple initializations are used.

An alternative iterative algorithm with reduced complexity can
be derived by assuming some values of k,- estimating
the parameters and by assigning new k,- by classifying the data
under new estimate of the parameters. This algorithm is similar
to the k-means clustering algorithm and is referred here as ‘hard’
EM, as opposed to the previous being ‘soft’ EM. Assuming k,,
the parameter estimates become (by letting wk, 2 [|{ k,- = k }):

-, 1 M
Otk=MZII{ki=k} (11)
i=0

N ‘11 M 2
6”: k0? — ,-—k, 12
(I; k) Mgo M) <)

and for ,12’ as in Equation (9). In these, ll{-} is the indicator func-
tion (unity if the condition is true, and zero otherwise), i.e. the
estimator 0?;C is the fraction of items with k,- equal to k. With
these, only (9(M +N) work is required per iteration, instead
of (9(MN) of the soft EM algorithm, which is signiﬁcant for
large N.

Regardless of the algorithm used, an initial parameter estimate
is required. We found the following scheme to be appropriate: (i)
sort the observed data y,- and partition it into N bins, (ii) assign
k,- = j if y,- is in the jth bin and (iii) estimate initial parameters
using Equations (9), (l l) and (12). A good partitioning depends
on the true values of oak. We found that equidistant partitioning
in y,- is simple, parameter-free and appeared to yield results
equivalent to more complicated schemes (e.g. multiclass Otsu’s
method). It is noted that hard boundaries (as in the above
scheme) cause the variance to be initially underestimated, if the
overlapping of the clusters is large.

 

1148

112 /§JO'S{12umo [p.IOJXO'SOIlBIIIJOJUIOIQ/ﬁdllq uIOJj pep1201umoq

9IOZ ‘091sn3nv uo ::

Estimating RNA numbers from spot intensities

 

The parameter N can be found by ﬁnding the parameter
estimates for several values of N and by selecting the model
with least order that does ﬁt signiﬁcantly better than the
lower-order models. To determine the signiﬁcance, we use a like-
lihood ratio test, where the log-likelihoods 6,, and 6;, of models of
orders a and b are obtained, respectively, and the statistic
—2(£a — 61,) is computed. For M —> 00, this statistic follows a
X2 distribution, with b — a degrees of freedom (W ilks, 1938), from
which a P—value can be computed. If the P—value is smaller than a
given signiﬁcance level, the higher-order model should be
favored over the lower-order one. We note that this procedure
rarely selects a model of too high order (as determined by the
signiﬁcance level), but for small sample sizes it might lack
evidence to select the appropriate high-order model.

3.3 Spot classiﬁcation

Next, we construct a classiﬁer that is used to estimate the number
of RNAs in a cluster based on the intensity of the cluster. We use
maximum a posteriori decision rule, i.e a class k, which is the
most probable, is to be associated with an intensity value x:

C(x) = arg max [F’[K = k | x] (13)
k

= argmaxorka(x | ku,k02) (14)
k

where [F’[K = kl x] represents the posterior probability, and oak
the priors and fN(x | ku,k02) the likelihood functions of each
class (the equality owing to the Bayes rule).

The classiﬁcation can be performed by evaluating the term to
be maximized for each k. Alternatively, a range of intensity
values can be associated with each k. Possible decision bound-
aries can be obtained from the equation:

aafN(x* let/1,6102) = abe(x* le, 1902) (15)

 

=> 36* = :l: ab (,u.2 —l— 0210g(a—1 b053, 051:2» (16)

If the decision boundaries x* do not exist, the density of the
higher order envelopes the density of the lower-order one. If so,
the lower-order class must not be associated with any intensity.
Alternatively, even though the decision boundaries exist, it might
be that a lower-order density is enveloped by multiple higher-
order ones. A procedure starting from the highest-order density
and proceeding to the lowest can determine the decision bound-
aries in (9(N) time, which enables the lower complexity of the
hard EM algorithm. The decision boundaries are symmetric
around zero, so the classiﬁcation can be performed on lxl,
rather than x.

For the purposes of evaluating the classiﬁer performance, the
expected accuracy (ACC) can be computed:

[EIU{C(X) = K}] (17)

N
= Zak] fjv(x | ku,k02)6x (18)
k:1

[x]?!  :1 _x/::I

where x; and x; are such that Vx, 0 g x; g x<x,j : C(x) = k.
The integral does not have a closed form solution, but it is the

Gauss error function, and can be evaluated numerically. Lastly,
we note that this quantity applies asymptotically if the model is
true and the estimated parameters are correct. Nevertheless, it is
likely useful to evaluate how hard the estimation problem is.

3.4 Means of comparison with the previous method

The previous method of RNA quantiﬁcation from the spot
intensity histogram, here called rounding method, relied on
manual inspection of the intensity distribution (Golding et al.,
2005). Namely, the location of the ﬁrst peak in the distribution of
intensities is selected by an expert, after which the intensities are
divided by this value to obtain the RNA numbers in each spot
and cell (Golding et al., 2005). The discretization is achieved by
rounding, which can result in suboptimal choice of thresholds for
the classiﬁer accuracy.

Given our model of spot intensities, the expected accuracy of
the rounding classiﬁer can be computed using Equation (17) with
x]? = (k :l: %) A (with the exception that xf = 0 and x39 2 00),
where A is the location of the ﬁrst peak. For comparison, we
ﬁnd A such that the accuracy is maximized. This classiﬁer is not
realizable, as the true parameters must be known, but it serves as
the upper limit of performance of the classiﬁer. Alternatively, it is
possible to use the parameter estimation procedure proposed
with the classiﬁcation of the rounding method, which has the
advantage that ﬁnding A can be automated. However, on
average, such an automated method cannot perform better
than the method proposed.

4 RESULTS

4.1 Estimating the number of MSZ-GFP-tagged RNAs

We ﬁrst used our method to estimate the number of MS2—GFP-
tagged RNA molecules in live E.c0[i cells. In one case, cells con-
tained an RNA coding for 96 bs for MS2—GFP (Golding et al.,
2005). In the other case, cells contained a different construct,
with only 48 bs. In both cases, cells were induced with 1 mM
of IPTG and 0.1% of arabinose, and images were taken 60 min
after induction. In theory, we expect the intensity of tagged
RNAs to be halved in the second set of measurements.

From both sets of images, we extracted the total pixel intensity
of each cell and of each spot. This procedure yielded 269 and 155
samples of spot and cell intensities, respectively, from cells with
the 96 bs construct, and 443 and 242 from cells with the 48 bs
construct.

For each construct, we assumed that all tagged RNAs exhibit
the same ﬂuorescence level when measured from either spot or
cell intensities and can be represented by a distribution with the
same mean and variance (,u. and 02). Such mean and variance
only differ between the two constructs. With this constraint, one
can use both datasets (cell and spot intensities), to jointly
estimate the parameters of the model, for each construct. For
this, we modiﬁed the estimator to account the joint estimation of
the two sets of data and estimated the parameters in each case.
The distribution of measured intensities along with the estimated
distributions is shown in Figure l, and the values of the
parameter estimates are given in Table 1.

First, one would expect the mean of intensities detected from
the 48 bs RNAs to be half of the one detected from the 96 bs

 

1149

112 /§JO'S{12umo [p.IOJXO'SOIlBIIIJOJUIOIQ/ﬁdllq uIOJj pep1201umoq

9IOZ ‘091sn3nv uo ::

A.Hakkinen et aI.

 

RNAs. However, from Table l, the estimated ratio of their
means of intensities is 0.83, rather than one half. One likely
explanation for this is that the number of functional binding
sites in the two RNA constructs differs from the intended num-
bers (particularly in the case of the longer construct). Meanwhile,
the ratio between the variances is expected to be similar to the
ratio between the means. Instead, it equals 0.69, which deviates
from the measured value, likely due to deviations in noise levels
arising from non-linear changes in intensities with the number of
binding sites. Nevertheless, we kept the estimated parameters
values (Table 1), rather than imposing the constraint on the
values, as they allow a signiﬁcantly better ﬁt than would be
achieved by constraining the ratios to one half, as determined
by a likelihood-ratio test (P<2.1 x 104).

Because the induction level of the target gene is the same in the
two cases (96 and 48 bs constructs), one also expects similar
RNA-per-spot (ﬁrst and third row of Table 1) and RNA-per-
cell distributions (second and fourth row) in both cases. The
obtained values of 6? suggest that this expectation appears to be
correct. In agreement, we found no evidence that the parameters
in Table 1 ﬁt signiﬁcantly better than in a case where each of the
RNA-per-spot and RNA-per—cell distributions are constrained
to be equivalent, as determined by a likelihood ratio test
(P>0.54).

Next, we used the parameters obtained from the spot
intensities and cell intensities to estimate the number of RNAs
in each cell. Results are shown in Table 2. We note that the
procedure of estimating the RNA numbers using the
classiﬁcation of intensities of each spot is expected to yield
better results than estimating the RNA numbers from the total
intensities of each cell (cf. accuracy in Table 2), as the problem is
easier and the sample size is larger, but it requires an accurate
detection of the spots inside the cells.

As expected (and necessary if the methods are appropriate),
the RNA statistics (Table 2) are similar in the four cases (even
though classifying spots are expected to yield better results
than classifying cells). Also, the results are in agreement with
previous measurements using the RNA target for 96 bs
(Kandhavelu et al., 2012b) in terms of mean and variance of
RNA numbers.

4.2 Comparison with a time series method

To validate our results, we compared our method with a
previously introduced method (Kandhavelu et al., 2012b) to
extract RNA statistics from time series data (Kandhavelu
et al., 2012a, b; Muthukrishnan et al., 2012). Unlike our
method, this method uses temporal information, i.e. time series
of intensities in the cells, which allows better accuracy of RNA
counting, but makes it unsuitable for analysis of individual
frames of cell populations.

We collected images taken for 2h, separated by 1 min
intervals, of cells subject to the same media and induction as in
the previous cases. Then, we made use of the method
from Kandhavelu et al. (2012b) to extract the RNA statistics
at ~60 min. The results are shown in Table 3. Visibly,
these results are similar to those obtained by our method
(cf. Table 2).

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

0.5 0.6 0.7
> 5m -
#5, l1
:
(I)
U 0
E 0 0.1 0.2 0.3 0.4 0.5 0.6 0.7
g g . . .
g 58188 
Q.
0 II I | I
0 0.1 0.2 0.3 0.4 0.5 0.6 0.7
5L - _
cm W
0 0.1 0.2 0.3 0.4 0.5 0.6 0.7

 

 

 

intensity (a.u.)

Fig. 1. Distribution of intensities from MS2—GFP-tagged RNA measure-
ments. Panels from top to bottom: spots (96), cells (96), spots (48) and
cells (48). The gray bars represent the measured intensity histograms, the
solid black lines the estimated distributions, the dashed black lines their
components and the dashed gray lines the decision boundaries

Table 1. Estimated model parameters from the MS2—GFP—tagged RNA
measurements

 

 

Case M N 12 6 6?

Spots (96) 269 4 0.101 0.053 (062, 0.30, 0.07, 000)
Cells (96) 155 4 0.101 0.053 (015, 0.46, 0.12, 026)
Spots (48) 443 4 0.084 0.044 (070, 0.26, 0.03, 001)
Cells (48) 242 4 0.084 0.044 (019, 0.52, 0.00, 029)

 

Note: The table shows the number of samples M, the estimated model order N
(Section 2), the estimated parameters mean 12 and standard deviation 8 of the
intensity of one RNA and the vector of probabilities 3?. The value of 61;, is the
estimated probability that one has k RNA molecules in a spot or cell (depending
on the case).

Table 2. Estimated distribution of RNAs per cell from the MS2-GFP-
tagged RNA measurements

 

 

Symbol Case M’ u, 0,2 ACC
A Spots (96) 182 1.97 1.55 0.78
B Cells (96) 182 2.07 1.68 0.68
C Spots (48) 270 2.02 1.46 0.82
D Cells (48) 270 2.10 1.48 0.77

 

Note: The table shows number of cells M’, mean pt, and variance of of RNA
numbers per cell and the expected accuracy (ACC).

To verify the agreement between the results using the two
methods, we performed two-sample Kolmogorov—Smirnov per-
mutation tests with the null hypothesis of the RNA numbers
extracted from different methods and/or cases (A through F in
Tables 2 and 3) are generated by an equal distribution, which
assesses if the distributions are signiﬁcantly different. All tests
were done with 106 permutations, and the results are shown in
Table 4.

 

1150

112 /§JO'S{12umo [p.IOJXO'SOIlBIIIJOJUIOIQ/ﬁdllq uIOJj pep1201umoq

9IOZ ‘091Sm3nv uo ::

Estimating RNA numbers from spot intensities

 

From Table 4, we ﬁnd that the results obtained from the
images of cell populations using the spot intensities provided
similar results to those extracted from time series (i.e. the null
hypothesis cannot be rejected when comparing cases A, C, E and
F). This indicates that our method performs consistently with the
time series method. The same does not hold for the results ex-
tracted from the cell populations using cell intensities in all cases,
where statistical differences are detected with higher sample sizes
(B or D versus C or E). This further suggests that the spot
intensities should be used in favor of the cell intensities for
more accurate quantiﬁcation of the RNA numbers. Generally,
and conﬁrming the results of the previous section, we found no
evidence that the results extracted from the 96 and 48 bs con-
structs are statistically different.

4.3 Comparison with qPCR measurements

We compared the fold-change in RNA numbers estimated
using our method with those obtained by qPCR. For this, we
used the 96 bs construct with induction levels of 1 mM (Table 2)
and of 0 mM of IPTG (not shown), the former resulting in a
higher expression rate. The estimated mean RNA numbers in the
case of 0 mM of IPTG using our method were 0.68 and 0.63,
using the spot and cell intensities, respectively. These result in
expression ratios of 0.345 and 0.303. The expression ratio
obtained by qPCR is 0.305 with a standard deviation of 0.024.
Both numbers estimated using our method are within the 90%
conﬁdence interval of the qPCR measurement, indicating a
strong agreement.

Table 3. RNA statistics estimated using time series method (Kandhavelu
et al., 2012b) at 60 min after induction

 

 

Symbol Case M’ M, 0,2
E Cells (96), time series 252 2.09 1.51
F Cells (48), time series 107 2.02 1.41

 

Note: The table shows number of cells M’ and the mean u, and variance of of RNA
numbers per cell.

Table 4. Comparison between the RNA distributions extracted different
methods and/or data

 

 

Symbol B C D E F

A 0.027 0.632 0.022 0.696 0.952
B — 0.00991 0.547 0.00457 0.022
C — — 0.00911 0.501 0.872
D — — — 0.00375 0.029
E — — — — 0.913

 

Note: P—values of the Kolmogorov—Smirnov permutation test under the null hypoth-
esis that a pair of samples of RNA numbers from different cases (A through F)
come from the same distribution. A low P—value (i.e. less than 0:01) indicates that
the RNA distributions are likely inequal.

4.4 Applying the method on simulated data

Lastly, we assessed the performance of the parameter estimation
and classiﬁcation using data from Monte Carlo (MC) simula-
tions of our model [Equation (1)] so that the ground truth is
known.

First, we computed the expected accuracy of the classiﬁca-
tion procedure for different parameters values, which assesses
the asymptotic performance of the classiﬁer if the parameters
are well estimated. This is shown in Figure 2. The accuracy
can be good for either low-mean levels, where the problem is
simpler, as most of time the number of RNAs is equal to
unity, or for low-noise levels, as in this case the distribution
consists of distinct peaks. More importantly, for typical RNA
levels in E.coli [i.e. l—10 (Bernstein er al., 2002)], the accuracy is
>0.8 for noise levels < 0.25 (which are in agreement with our
results in Table 1). For high RNA levels and/or high noise levels,
the accuracy deteriorates, as the distribution no longer exhibits
distinct peaks.

We found that the expected accuracy is similar with slightly
non-Poissonian data (not shown) but generally better with sub-
Possonian and worse with super-Poissonian. For typical RNA
levels and low-noise levels (<0.l), the accuracy remains >0.9
even for geometric distributed RNA numbers. The rounding
method has comparable performance only for limited noise
levels, and its performance is more sensitive to the RNA
distribution.

With a ﬁnite sample, the parameter estimates are not neces-
sarily correct, which causes errors in the classiﬁcation. We tested
the method for various samples sizes, and the results for noise
level of a ,u_1 = 0.25 and Poissonian RNA numbers with a mean
of A = 2.5 are shown in the top panel of Figure 3. For small
samples (e.g. 10), the performance is not comparable with the
asymptotic performance, whereas for sample sizes >103 the mean
accuracy exceeds the theoretical accuracy of the rounding
method (0.8049).

We also used noise level 011—1 = 0.5 and a bimodal RNA
distribution of or = (030,0.01,0.01,0.66,0.01,001) (these are
observed e.g. in the case of genes integrated into circuits such

mean log 10 it

 

 

 

—2 —1:5 —1 —o:5 6 0:5 1 1:5 2
coefﬁcient of variation log 1 o 0' 11'1

Fig. 2. Expected accuracy of the classiﬁcation problem for Poisson-

distributed RNA numbers. Surface plot of the expected accuracy of the

classiﬁer for Poisson-distributed RNA numbers, as a function of noise

a 1171 (coefﬁcient of variation) and RNA mean level A. Light shades of

gray represent high accuracy, whereas dark shades represent low

 

1151

112 /§JO'S{12umo [progxo'sor1nu1101urorq//:d11q uIOJj pep1201umoq

9IOZ ‘091Sm3nv uo ::

A.Hakkinen et aI.

 

 

 

accuracy ACC

AA».

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

1o3 10
number of samples M

2

10

Fig. 3. Distributions of accuracies for various samples sizes M obtained
using MC simulations. Top panel: Poisson distributed or, with )t = 2.5
and 011—1 = 0.25. Bottom panel: bimodal distribution of or and
011—1 = 0.5. Circles represent means, pluses medians and whiskers
upper and lower standard deviations from the mean. The dashed lines
are the expected accuracy for our method (higher value) and for the
rounding method (lower value)

as a toggle switch), shown in the bottom panel of Figure 3. The
expected accuracies are 0.9394 and 0.5457, suggesting that our
method is appropriate, but the rounding method is not.

Lastly, we note that our method is likely biased for ﬁnite
samples. We found that for sample sizes <100, it generally over-
estimates the mean and the variance, which primarily results
from underestimation of the order due to lack of evidence for
selecting a high—order model with small samples. Regardless,
even if the order was known, the maximum likelihood estimator
is likely biased. However, these effects are negligible for larger
sample sizes (>102), and e.g. the standard deviation of the
parameter estimates exceeds the bias (Fig. 4).

5 DISCUSSION

We have presented a fully automatic method of quantiﬁcation of
RNA numbers from the intensities of the either ﬂuorescent spots
or cells. The method consists of a numerical maximum likelihood
parameter estimation step (with one of the two proposed meth-
ods) followed by a maximum a posteriori classiﬁcation.

We showed that the method proposed has several advantages.
First, by being automated, it will allow an objective comparison
of results from independent measurements. Second, our method
is expected to have better accuracy than the previous method
(Golding et al., 2005), when the distribution of RNAs is non-
uniform and/ or, when the measurement noise is high. When the
distribution is uniform and/or the noise-level is low, the solution
converges to that of the previous method. Third, our method
allows the estimation of its own accuracy. The theoretical
analysis indicates that the ﬁnite sample biases of the maximum
likelihood estimators are negligible and that the method is
expected to perform well (~80% accuracy or above) in a typical
setting, when the sample size is few hundred samples or more,
which is typical for a single-cell study.

The method can be applied on various intensity distributions.
We demonstrated its applicability on both the spot intensities
and cell intensities extracted from live E.c0li cells. The choice

 

 

 

 

 

 

 

 

 

 

 

 

 

a 2.5-
16 2-
g 1.5
a 17,
b 1.5
'0
.9 1-
E
:5 0.5
0.)
number of samples M
as“ 0-6 o M=50 0-3 éé o M=500
g 0.4 ¥ 0.25 g
N
g 0.2 6 0.1 5
8 o ¥§5$555 o 599355

 

 

 

 

 

 

12345678910 12345678910
number of RNAs k

Fig. 4. Distributions of parameter estimates for various sample sizes M
obtained using MC simulations. Estimated parameters 12 (top panel, true
value a = 1) and 6 (middle panel, true value a = 0.25) for various sam-
ples sizes. Also shown is the distribution of estimated parameters 02k, for
M = 50 (bottom left panel) and M = 500 (bottom right). Circles repre-
sent means, pluses represent medians and whiskers represent upper and
lower standard deviations. The dashed lines are true parameter values

of the input is two-fold: spot intensities result in more accurate
classiﬁcation, but the detection of spots is required in addition to
cell segmentation.

In theory, the method is applicable to any ﬂuorescent or ﬂuor-
escence-tagged molecules present in low-copy numbers, such as
low-expression level ﬂuorescent proteins. However, a proper
counting requires a certain degree of separation between bright-
ness levels (not much smaller than the one between e.g. the
RNAs with 48 bs). In this regard, our tests showed that the
method fails if the data are too noisy or the degree of clustering
of the spots is too high. For example, we tested the method
on confocal microscopy measurements of tsr-venus proteins
coded in E.c0li, but the signal-to-noise ratio was found to be
too low, except for rare cases, where all cells would have
one or two proteins. Overall, we expect that, as the methods of
ﬂuorescent tagging and microscope improve, our method will
become more widely applicable, as it is automatic and allows
comparing data from different sources, which is currently not
possible.

Funding: Tampere City Science Foundation [to A.H.]; Academy
of Finland [257603 to A.S.R.]; Tekes [1386/31/2012 to A.S.R.];
and Fundacao para a Ciencia e Tecnologia [PTDC/BBB-MET/
1084/2012 to A.S.R.].

Conﬂict of Interest: none declared.

REFERENCES

Bernstein,J.A. et al. (2002) Global analysis of mRNA decay and abundance in
Escherichia coli at single-gene resolution using two-color ﬂuorescent DNA
microarrays. Proc. Natl Acad. Sci. USA, 99, 9697—9702.

Chowdhury,S. et al. (2013) Cell segmentation by multi-resolution analysis and max-
imum likelihood estimation (MAMLE). BM C Bioinformatics, 14, S8.

Dempster,A.P. et al. (1977) Maximum likelihood from incomplete data via the EM
algorithm. J. Roy. Stat. Soc. B Met., 39, 1—38.

Elowitz,M.B. et al. (2002) Stochastic gene expression in a single cell. Science, 297,
1 183—1 186.

Golding,I. et al. (2005) Real-time kinetics of gene activity in individual bacteria.
Cell, 123, 1025—1036.

 

1152

112 /§JO'S{12umo [progxo'sor1eu1101urorq//:d11q uIOJj pep1201umoq

9IOZ ‘091Sm3nv uo ::

Estimating RNA numbers from spot intensities

 

Golding,I. and Cox,E.C. (2004) RNA dynamics in live Escherichia coli cells. Proc.
Natl Acad. Sci. USA, 101, 11310—11315.

Kaern,M. et al. (2005) Stochasticity in gene expression: from theories to phenotypes.
Nat. Rev. Genet, 6, 451—464.

Kandhavelu,M. et al. (2012a) Regulation of mean and noise of the in vivo kinetics of
transcription under the control of the lac/ara-l promoter. FEBS Lett., 586,
3870—3875.

Kandhavelu,M. et al. (2012b) Single-molecule dynamics of transcription of the lar
promoter. Phys. Biol., 9, 026004.

Livak,K.J. and Schrnittgen,T.D. (2001) Analysis of relative gene expression
data using real-time quantitative PCR and the 2TAACT method. Methods, 25,
402—408.

Lloyd-Price,J. et al. (2012) Asymmetric disposal of individual protein
aggregates in Escherichia coli, one aggregate at a time. J. Bacteriol, 194,
1747—1752.

Montero Llopis,P. et al. (2010) Spatial organization of the ﬂow of genetic informa-
tion in bacteria. Nature, 466, 77—81.

Muthukrishnan,A.B. et al. (2012) Dynamics of transcription driven by the tetA
promoter, one event at a time, in live Escherichia coli cells. Nucleic Acids Res,
40, 8472—8483.

Ozbudak,E.M. et al. (2002) Regulation of noise in the expression of a single gene.
Nat. Genet, 31, 69—73.

Peabody,D.S. (1993) The RNA binding site of bacteriophage MS2 coat protein.
EMBO J., 12, 595—600.

Raj,A. et al. (2008) Imaging individual mRNA molecules using multiple singly
labeled probes. Nat. Methods, 5, 877—879.

Taniguchi,Y. et al. (2010) Quantifying E. coli proteome and transcriptome with
single-molecule sensitivity in single cells. Science, 329, 533—538.

Wilks,S.S. (1938) The large-sample distribution of the likelihood ratio for testing
composite hypotheses. Ann. Math. Satist., 9, 60—62.

Wu,C.F.J. (1983) On the convergence properties of the EM algorithm. Ann. Stat.,
11, 95—103.

Yu,J. et al. (2006) Probing gene expression in live cells, one protein molecule at a
time. Science, 311, 1600—1603.

 

1153

112 /810'spaumo [progxo'sor1eu1101urorq//:d11q uIOJj pep1201umoq

9IOZ ‘091sn8nv uo ::

