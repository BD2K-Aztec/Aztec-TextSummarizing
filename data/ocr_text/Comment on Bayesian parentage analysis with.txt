V l. 30 . 5 2014, 743-745
LE 1 IER TO THE EDITOR Zoi:10T093/bioinfgggﬁcs/btt588

 

Genetics and population analysis

Advance Access publication October 15, 2013

Comment on ‘Bayesian parentage analysis with systematic
accountability of genotyping error, missing data and false

matching’
Eric C. Anderson1’2’* and Thomas C. N93

1Fisheries Ecology Division, Southwest Fisheries Science Center, National Marine Fisheries Service, NOAA, 110 Shaffer
Road, Santa Cruz, CA 95060, 2Department of Applied Math and Statistics and 3Department of Biomolecular

Engineering, University of California, Santa Cruz, CA, USA

Associate Editor: Jeffrey Barrett

 

Summary: We show the software SOLOMON is improved by using
the likelihood ratio instead of an ad hoc statistic.

Code: github.com/eriqande/solidmon/releases/tag/VO.1-bioinformatics
Contact: eric.anderson@noaa.gov

Received on August 7, 2013; revised on September 23, 2013;
accepted on October 4, 2013

1 INTRODUCTION

In a recent Bioinformatics article, Christie, Tennessen and Blouin
(hereafter CTB) present the software SOLOMON for parentage
inference from genotype data (Christie et al., 2013). They pro-
pose a method of estimating the number of true parent-offspring
pairs amongst all the candidate pairs in a dataset and show it
provides better results than the program CERVUS (Marshall
et al., 1998) when the fraction of sampled candidates (an input
to CERVUS) is misspeciﬁed.

Here we show that the performance of SOLOMON can be
improved by making full use of the genotype data, replacing
CTB’s statistic with the likelihood ratio as prescribed by a
well-established literature (Marshall et al., 1998; Meagher and
Thompson, 1987). This is particularly beneﬁcial when using
single nucleotide polymorphisms (SNPs) chosen to have minor
allele frequency near 0.5, as desired for SNP-based pedigree
reconstruction (Anderson and Garza, 2006).

2 METHODS

We start with an overview of SOLOMON’S methodology, adopting new
notation where it permits a more complete succinct description.

2.1 SOLOMON’S methodology

Assume L unlinked loci used to identify the true parents of 112 diploid
offspring from amongst n1 diploid candidate parents. CTB focus ﬁrst on
the case where all candidate parents are of the same sex and the goal is to
identify true parent—offspring pairs from amongst the nlnz candidate
pairs. Let zj count the number of loci not compatible with Mendelian
inheritance (barring a genotyping error) between the candidate parent
and offspring of pair j. The method of CTB then proceeds in four steps.

 

*To whom correspondence should be addressed.

Step 1: Partition all nlnz pairs into disjoint sets 730, .. . , 7%, where 73,-
includes all pairs j such that zj = i. Denote by #{73,-} the cardinality of 73,-.

Step 2: Estimate m, the unknown fraction of pairs in each set 73,-
that are unrelated pairs (i.e. the two members of the pair are unrelated),
with

 

in : min{1, n1n2P(zj = i|pair j is unrelated)} (1)

#{Pi}

The probability in the numerator is computed by simulation from the
estimated allele frequencies in the population. CTB denote ft,- by Pr(¢),
and refer to it as the prior probability that a pair in 73,- is unrelated.

CTB deﬁne a statistic A to describe allele sharing between a pair of
individuals. Let ys, g and yk, g be genotypes at locus K in the putative sire s
and the putative kid k, respectively. Then,

0 if s and k share no alleles at locus Z,

My, 5, yk, g) = h ifs and k share at least one allele and h is the
index of the least frequent of the shared alleles,

i.e. if a single allele is shared, h is its index, if two alleles are shared, then h
is the index of the shared allele that is the least frequent (in the popula-
tion) of the two shared alleles.

Step 3: Calculate for each pair j in 73,- with It,- <1 the quantities:

Tl’ = HPO‘O’SJaJ’kJNRs = U) (2)
ZEL

71m = HﬂAO’slaykJ» (3)
ZEL

where s and k are the members of the pair, Rsk denotes the assumed
relationship between s and k, U and PO denote ‘unrelated’ and
‘parent—offspring’, respectively, £ is the set of loci at which s and k
share at least one allele, and foxy“, yk,g)) is the relative frequency in
the population of the allele with index Mys, g, yk, 5). To compute  , CTB
approximate P(A(ys, g, yk, g)|RSk = U) by Monte Carlo simulation.

Step 4: Combine ft,- and A to compute a ‘posterior probability’ of
parentage for each pair in each 73,- with m< 1. Let X? represent a
random variable deﬁned as the product in (2) when s and k are unrelated
individuals simulated conditional on sharing at least one allele at every
locus, and £ is a randomly chosen set of L—i loci at which s and k share
alleles. Let 0 be a random variable that is the product in (3) when s and
k are a simulated true parent and offspring. CTB deﬁne the ‘posterior
probability of parentage’ for a pair j in 73,-, with observed values of 
and O, as:

(1 — Ni)P(Xi)O Z T1130)
max? 2 231mm — m)P(X%’0 2 Troy

 

Q(POIA) = (4)

 

Published by Oxford University Press 2013. This work is written by US Government employees and is in the public domain in the US. 743

112 /810's112umo[pJOJXO'sot1BmJOJutotw/2d11q moi; popcolumoq

910K ‘09 lsnﬁnV no :2

E.C.Anderson and T.C.Ng

 

Q(PO|A), more a P-value than a posterior probability, is computed by
simulation and used to accept or reject pairs as being parent—offspring pairs.

2.2 Analysis

The statistics 0 and  reﬂect the fact that ‘pairs sharing rare alleles
are much more likely to be true parent—offspring pairs’ (Christie et al.,
2013, p. 726); however, they do not reﬂect the fact that ‘a homozygous
male that is compatible with a given offspring really does have a higher
likelihood of producing it than a heterozygous male Sharing one allele
with the offspring’ (Jones and Ardren, 2003, p. 2512). As such,
SOLOMON is not making full use of the data; 0 and  are not
sufﬁcient statistics.

An example demonstrates this. Consider L = 60 biallelic loci, each with
one allele at frequency of 0.501 and the other at 0.499. Clearly, little
information is gained by knowing whether the ﬁrst or the second allele
is shared in a candidate parent—offspring pair, so, in effect, the statistic
My, 5, yk, g) is merely recording whether or not at least one allele is shared.
An unrelated pair shares at least one allele at every locus with probability
close to (1 — $60 = 3.3 x 10‘4. Imagine that n1 2 n2 2 500 and
#{730} = 165. By (1) we have fro = (3.3 x 10-4 x 5002)/165 = 0.5, so
we expect that half of the pairs in 730 are true parent—offspring pairs.
Those true pairs cannot, however, be identiﬁed by CTB’S method because
the observed values  and O are effectively identical for every pair j in
730, whether it is a true parent—offspring pair or not.

We implemented CTB’S approach, but based it on the likelihood ratio:

HEEL P(ys,£ayr,£|Rs,k 2 PO))
Heec P(ys,£:yr,£|Rs,k = U)

Kids are assigned to the candidate sire with highest LR(yS, yk).
Conﬁdence in those assignments can still be assessed with a P-value,
Q*(PO|yS, yk), like that in (4), by substituting LR(yS, yk) for both 0
and  in (4) and redeﬁning  and O to be the random variable
LR(yS, yk) for an s and k drawn randomly from the population condi-
tional on s and k being either unrelated or parental, respectively, and
sharing at least one allele at a randomly determined L—i loci. We call
this the ‘likelihood ratio (LR) approach’.

To compare the performance of the LR approach to SOLOMON, we
simulated 20 datasets under two different scenarios with no genotyping
error: (i) n1 2 n2 2 500, number of true pairs: 83 and L: 60 biallelic
loci with equifrequent alleles; and (ii) n1 2 n2 2 200 with 50 true pairs,
and L: 10 loci each with 10 alleles and with the frequency of allele
v = 1, ..., 10, proportional to l/v. no is expected to be 0.50 and 0.48
for the scenarios, respectively. Each dataset was analyzed using the LR
approach and SOLOMON, and accuracy was compared graphically by
plotting the receiver-operating characteristic (ROC) curve (Green and
Swets, 1966) for each dataset.

 

moon) = log(

3 RESULTS AND CONCLUSIONS

Figure 1a shows that, as predicted, SOLOMON’S criterion for
parentage contains no extra information beyond Mendelian in-
compatibility in data scenario 1, with equifrequent alleles. The
ROC curves indicate SOLOMON does not rank true pairs any
higher than false pairs in 730. The LR approach performs con-
siderably better. Figure lb Shows that on data with 10 alleles at
frequencies that are far from equal (scenario 2), the LR approach
still outperforms SOLOMON, as expected.

Our implementation of the LR approach, using 105 Simulation
replicates to approximate Q* (POlys, yk), requires roughly 0.1 and
1 min for each dataset from scenarios 1 and 2, respectively, on a
Single core from a Mac Pro running at 2.8GHz. SOLOMON,
using the default 1000 replicates, requires 16.6 and 225 min.

 

   

  

 

 

 

 

 

 

(a) 10 —
g -:F.':'.--—.-'—-
E 0.3 —
§
a: I -' '-
E as — 
E - -.-
:E E"
m. =
51-3 0.4 — I
"E s‘
g I
g 0.2 — I
II — LFlApproaoh
SOLOMON
0.0 —
| | | | |
(bl 1.o —
E
E 0.8 —
E
I: 0.6 —
m
E
2’2
,2 0.4- —
“a
C
E
“g 0.2 —
.1 : I — LFt Approach
1 i SOLOMON
0.0 —
| l | | l |
D 0.2 0.4 0.5 0.8 1

Fraction of Total False Positives

Fig. 1. ROC curves for the LR approach and SOLOMON. (a) Data
scenario 1 (SNPS). 0)) Data scenario 2 (microsatellites)—because individ-
ual ROC curves are overlapping, we plot the median as black and gray
lines and depict variability with boxplots (white: LR approach;
gray = SOLOMON)

CTB propose an interesting way of accounting for the un-
known sampling fraction of parents, and we appreciate their ef-
forts to make approachable software. We recommend
SOLOMON be updated to use the likelihood instead of A, so
as to make it more accurate, faster and better suited for general
use. In the future it will be interesting to compare how
SOLOMON performs against methods that estimate the sam-
pling fraction directly from the genotype probabilities (Koch
et al., 2008; Nielsen et al., 2001), rather than formulating a ‘prior’
based on Mendelian incompatibilities.

ACKNOWLEDGEMENTS

The authors acknowledge helpful comments from Mark Christie
and two anonymous referees.

Funding: T.N. was partially supported with funds from the US
Section of the Chinook Technical Committee of the
International Paciﬁc Salmon Commission.

Conﬂict of Interest: none declared.

REFERENCES

Anderson,E.C. et a]. (2006) The power of single nucleotide polymorphisms for
large-scale parentage inference. Genetics, 172, 2567—2582.

 

744

112 /810's112umo[pJOJXO'sottemJOJutotw/zdnq won popeolumoq

910K ‘09 tsnﬁnV uo ::

Comment on Christie et al. (2013)

 

Christie,M.R. et al. (2013) Bayesian parentage analysis with systematic accountabil-
ity of genotyping error, missing data and false matching. Bioinformatics, 29,
725—732.

Green,D.M. et al. (1966) Signal Detection Theory and Psychophysics. John Wiley &
Sons Inc., New York.

Jones,A.G. et al. (2003) Methods of parentage analysis in natural populations.
Mol. Ecol., 12, 2511—2523.

Koch,M. et al. (2008) Pedigree reconstruction in wild cichlid fish populations. Mol.
Ecol., 17, 4500—4511.

Marshall,T.C. et al. (1998) Statistical conﬁdence for likelihood-based paternity
inference in natural populations. M01. Ecol., 7, 639—655.

Meagher,T.R. et al. (1987) Analysis of parentage for naturally established seedlings
within a population of Chamaelirium luteum (Liliaceae). Ecology, 68, 803—812.

Nielsen,R. et al. (2001) Statistical approaches to paternity analysis in natural popu-
lations and applications to the North Atlantic humpback whale. Genetics, 157,
1673—1682.

 

745

112 /810's112umo[p101x0'sot112u1101utotq/ﬁd11q 111011 popeolumoq

910K ‘09 tsnﬁnV no 22

