ORIGINAL PAPER

Vol. 28 no. 24 2012, pages 325 7—3264
doi: 10. 1093/bioinformatics/bts550

 

Structural bioinformatics

Advance Access publication September 8, 2012

RAPHAEL: recognition, periodicity and insertion assignment of

solenoid protein structures

Ian Walshl, Francesco G. Sirocco”, Giovanni Minervinil, Tomas Di Domenicol,

Carlo Ferrari2 and Silvio c. E. Tosatto“

1Department of Biology, University of Padua, Viale G. Colombo 3, 35131 Padova and 2Department of Information
Engineering, University of Padua, Via Gradenigo 6, 35121 Padova, Italy

Associate Editor: Alfonso Valencia

 

ABSTRACT

Motivation: Repeat proteins form a distinct class of structures where
folding is greatly simplified. Several classes have been defined, with
solenoid repeats of periodicity between ca. 5 and 40 being the most
challenging to detect. Such proteins evolve quickly and their period-
icity may be rapidly hidden at sequence level. From a structural point
of view, finding solenoids may be complicated by the presence of
insertions or multiple domains. To the best of our knowledge, no auto-
mated methods are available to characterize solenoid repeats from
structure.

Results: Here we introduce RAPHAEL, a novel method for the detec-
tion of solenoids in protein structures. It reliably solves three problems
of increasing difficulty: (1) recognition of solenoid domains, (2) deter-
mination of their periodicity and (3) assignment of insertions.
RAPHAEL uses a geometric approach mimicking manual classifica-
tion, producing several numeric parameters that are optimized for
maximum performance. The resulting method is very accurate, with
89.5% of solenoid proteins and 97.2% of non-solenoid proteins cor-
rectly classified. RAPHAEL periodicities have a Spearman correlation
coefficient of 0.877 against the manually established ones. A baseline
algorithm for insertion detection in identified solenoids has a 02 value
of 79.8%, suggesting room for further improvement. RAPHAEL finds
1931 highly confident repeat structures not previously annotated as
solenoids in the Protein Data Bank records.

Availability: The RAPHAEL web server is available with additional data
at http://protein.bio.unipd.it/raphael/

Contact: silvio.tosatto@unipd.it

Supplementary information: Supplementary data are available at
Bioinformatics online

Received on June 9, 2012; revised on August 24, 2012; accepted on
September 2, 2012

1 INTRODUCTION

Protein repeats contain tandem arrays of smaller structural
motifs where, unlike most globular domains, folding is reduced
to simple coiling and long-range interactions are greatly reduced
(Andrade et al., 2001; Kajava, 2011; Kobe and Kajava, 2000).
Repetitive proteins evolve quicker due to the intrinsically

 

*To whom correspondence should be addressed.
TPresent address: Unit of Experimental Oncology 1, CR0 National
Cancer Institute, Via Franco Gallini 2, 33081 Aviano, Italy.

error-prone process connected with the formation of repeating
sequences (Buard and Vergnaud, 1994). Fourteen percent of all
known protein sequences are strictly periodic and it was hypothe-
sized that repeating sequences occur more frequently in eukary-
otic proteins (Marcotte et al., 1999). Repeating sequences were
estimated to occur in around one in three human proteins
(Jorda and Kajava, 2010; Kajava, 2011).

Classification of repeating proteins is usually achieved in terms
of repeat unit length (Kajava, 2001, 2011). The length of the
repeating unit can be as small as one or two residues for different
types of crystallites of unlimited size. At the other extreme are
repeating units of entire domains (beads on a string) with a typ-
ical repeating unit of over 50 residues. The middle ground com-
prises solenoid repeats with units of 5—40 residues. These are
elongated structures containing oz-helices and/or ,8—strands with
a large distance between the N and C termini (Kobe and Kajava,
2000). There has been increasing interest in solenoid proteins
over the years, especially their relevance in health (de Wit
et al., 2011; Kajava et al., 2006) and for protein engineering
applications (Main et al., 2005; Stefan et al., 2011). Solenoid
proteins have also been shown to fold sequentially, one unit at
a time, suggesting that the sequence contains all necessary infor-
mation to determine the local fold (Kajander et al., 2005).
Understanding solenoid function and evolution passes through
their classification from sequence and structural information,
which are two different problems. Solenoid sequences evolve
quickly while maintaining their fold, thereby hampering detec-
tion (Andrade et al., 2001). Several sequence-based methods pre-
dicting tandem repeats from self-alignments have been developed
over the years, including RADAR (Heger and Holm, 2000),
TRUST (Szklarczyk and Heringa, 2004) and HHrepID
(Biegert and Soding, 2008). Our previous work REPETITA
uses a fast Fourier transform to specifically detect solenoids
(Marsella et al., 2009). In all cases there is still room for improve-
ment, with the best methods still missing out many solenoids,
especially with insertions. Generally speaking, solenoid repeats
tend to be easy to spot through visual inspection in a molecular
viewer. However, the manual search of hundreds or thousands of
structures to determine if they are solenoid repeats or not is eX-
tremely time-consuming and inefﬁcient. Moreover, the deﬁnition
of repeat length, i.e. repeating blocks containing similar residue
numbers, and detection of breaks in the periodicity require
objective measures.

 

© The Author 2012. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com 3257

112 /310's113umo [p.IOJXO'SOIlBIHJOJUIOICI/ﬁdllq U101} prBOIIIAAOG

9IOZ ‘09 lsnﬁnv uo ::

I. Walsh et aI.

 

Available structural databases such as Protein Data Bank
(PDB) (Berman et al., 2007) and CATH (Pearl et al., 2003)
store solenoid structures but do not provide feasible means for
extracting them. Tools for discriminating protein repeat struc-
tures from globular proteins are rare in the literature. DAVROS
(Murray et al., 2002, 2004) is perhaps the ﬁrst method developed
for this purpose. Unfortunately, it is no longer maintained.
ProSTRIP (Sabarinathan et al., 2010) is designed to ﬁnd all simi-
lar structural repeats. It requires the selection of the repeat length
and alignments from a set of alternatives, making it impractical
for large-scale analysis. The Propeat database was designed by
extracting recurring protein sub-structures, including internal re-
peats, but most of the structures contain only two repeating units
(Shih and Hwang, 2004). A similar self-alignment approach is
used by Swelfe to detect internal repeats in structures (Abraham
et al., 2008). When developing REPETITA, we had to manually
derive a dataset of 105 solenoids (Marsella et al., 2009). Other
sequence repeat prediction methods had similar problems in
deﬁning the dataset, e. g. in HHrepID the authors resort to struc-
tural self-alignment due to the lack of available tools for un-
biased detection of solenoid repeats from structure (Biegert
and Soding, 2008).

This study aims to detect solenoid repeat structures using dis-
tance and periodic features extracted from the structural coord-
inates. The algorithm is efﬁcient, has high discrimination power,
can determine the repeat unit length and can ﬁnd insertions that
break the periodicity temporarily. The consequences of the algo-
rithm are vast and here we tackle the large-scale extraction of
repeats from CATH and the PDB. In addition to the novel data
produced, a server is available (URL: http://protein.bio.unipd.it/
raphael/) which can determine how periodic a structure is, the
repeat length, periodicity and insertion plots.

2 METHODS

Periodicity and distance measures are both important factors when con-
sidering a particular protein visually. The aim of our algorithm is to
mimic the intuitive deﬁnition used by a manual curator, extracting
these two factors from the three-dimensional coordinates of the structure.
A set of parameters and ﬁlters are then derived to capture the essence of
periodic spatial patterns. It should be noted that while signal processing
methods such as fast Fourier transform can be used for repeat proteins,
our previous experience suggests that they do not excel on biological data
with intermittent insertions (Marsella et al., 2009).

2.1 Periodicity

For each C-alpha coordinate (i.e. x, y and z), a proﬁle/wave is generated,
ﬁltering by averaging the proﬁle twice over a window for each coordinate
proﬁle. The ﬁrst pass window size is 6 and the second pass window size
is 3. Figure lb shows an example of a coordinate proﬁle derived from
C-alpha coordinates. In order to avoid bias due to the initial orientation
of the structure, the protein is anchored at a reference point by random
translation and rotation. Anchoring is performed 200 times in order to
build stable periodicity values, thus producing 3 X 200 proﬁles (i.e. 200
for each coordinate proﬁle). A period is deﬁned as the distance between
consecutive local maxima on the proﬁle curve (consecutive minima are
also considered); Figure lb. In order to score the periodicity, two obser-
vations are made: (1) frequent adjacent periods, termed window score,
indicate solenoid proteins and (2) frequent periods separated by rarely
occurring periods, termed bridge score, indicate solenoid proteins.

{a}

 

 — WlﬁdOw

Averaged X
Period =21 Coordinate
H 1? Minimum
Coordinate
1 Maximum
Coordinate

  
 
  

Average Coordinate

Residue

(cl

Periudl 3 |5 |4r|19|1a|20 '21 '2n|21|19|21I19|19|1sizu|19|20

Lab-elﬂﬂ122222222!222222
||l||l lllllllll

 

 

Fig. 1. Tagging the periods for the x-coordinate of Leucine—rich effector
protein YopM-a from Yersinia pestis (PDB code 1] L5). (a) The structure
is shown colored from N—terminus (blue) to C—terminus (red). (b) The
period as calculated from two consecutive local maxima on the averaged
x-coordinate proﬁle. (c) The period sequence for the proﬁle from (b) with
the tagged label sequence below it. Notice how similar periods are as-
signed to the same tag. As this is clearly a solenoid protein, there are
many identical tag labels adjacent to each other

Let 0,: max,“ — max,- Vi= 1,. . . ,M — I be the period calculated be-
tween adjacent local maxima on the coordinate proﬁle (similarly for
minima) where M is the total number of local maxima. A labeled se-
quence is constructed from the sequence of periods 01,. . . ,0M_1 where
6,- e N. A period 0,- is labeled with k e N where k is the position of the ﬁrst
occurrence, i.e. 6,- 6 [6k — T, 0k + I], when scanning the periods from N— to
C—terminus. T is the acceptable difference in residues between two periods
that allows assignment of the same label. Otherwise a new label is at-
tached. This labeling procedure results in a sequence of labels
Li, . . . ,LM_1 representing periodicities found in the structure, which is
the only information supplied to the window and bridge scoring functions
described below. We found that T =5 produces optimal results, see
Figure 1c for an example of period sequence and the corresponding
label sequence.

2.2 Functions

Let C(L,-) be the number of times L,- appears in the label sequence. The
window score is deﬁned as:

2C(L,-) if |i —j| 2 land L, = L]-
0 otherwise

We. L» = { <1)
The window score is positive only for identical adjacent labels

(i.e. li—jl =1), see Figure 2a. Assuming we have two identical labels

 

3258

112 /310's113umo [p.IOJXO'SOIlBIIIJOJUIOIQ/ﬁdllq uIOJj prBOIIIAAOG

9IOZ ‘09 lsnﬁnv uo ::

RAPHAEL

 

 

 

 

 

 

 

 

{3} Example label sequence: [Calculaljon IWin-cow Score
l}_l] ﬂ 1 I1 I i l 2 ﬂ 2 fl I 2H0] 12
l} III—III 1 ii I i i 3 Ill 2 H I BIC-{ﬂ} 12
ll“ [J Hi i! zilliil 0 ﬂ
Hilﬂ L3 1 ll 2112 HI 0 U
I} ll 1'! l U l l 3 ﬂ 2 ll I '3' '3
UUHIULIZUJUI 25“: 1'3
oiei=e oiii=5 13121::
{'3} Example label EIBEIUEHGE'. lCaloulalion Bl'idgﬂ
scare-
[in ul Jill II Elilfjlgﬂpﬁgg 2

 

 

Fig. 2. Example for the window and bridge scores. The positions being
considered are shown bold faced in red and underlined. (a) The window
score considers identical neighboring labels toward the total score.
0)) The bridge score looks for identical labels separated by an insertion,
here i = 4 and j = 7. See text for details

separated by an insertion of other labels, the bridge score penalizes the
periods between them as follows:

. . _ 2C(L.-) — ’3 , C(Lj) if L,- = L,- 2
B<Ll ’ L1) _ { 0 J> otherwise ( )

Figure 2b shows an example of the bridge score labeled sequence. The
total periodic score for one coordinate and one random rotation and
translation is:

1.
Totalscore = W (3)
N

where W* and B* are the ﬁnal window and bridge scores (respectively)
when processing the entire labeled sequence and N is the sequence length.
Using a linear grid search on the training set, P: 0.49 was found to be
the optimal balance parameter. The total score for the entire protein is the
average of the three coordinate proﬁles and the 200 random rotations and
translations.

2.3 Parameters and optimization

The variance among all the periods found within a structure should in-
tuitively be another important factor for discriminating solenoids. Let
P 2 {0’1}, 03,02, ...,0’,§j,0§j,0§j} be the set of periods for residuej for
all R rotations and translations along each coordinate frame x, y and 2.
On this set, let ij be the frequency of period k found in P for residue j.
We deﬁne the period matrix PM to be a 2D matrix of dimension 60*N
with elements ij, Vk=0,...,60 and j=0,...,N—I, where N is the
length of the protein and j is the index over residues. The cutoff was
chosen to be the maximum allowed period since repeating units rarely
exceed 60 residues for solenoid structures. Figure 3 shows the period
matrix for a typical solenoid and non-solenoid protein. In order to meas-
ure the variation of periodicity within the entire protein, the standard
deviation over all residues is calculated as:

_ N—l 60 Vg
SD _ 1:0 k=0 (F? _ F kj) (4)

where Png is average frequency of column j in the period matrix. To
complete the periodic information, we use the average period. Before
calculating the average, set P is ﬁltered by removing all outliers such
that each period must be part of the interval [Pan—0(P)/2,
Pan+o(P)/2], where PaVg and 0(P) are the average and standard devi-
ation of all periods in P. This value is used to determine the solenoid
periodicity length (termed P* throughout the remaining sections).

(a) Frequen :23:

Period

|_

"Emmi

Residue

Frequency

('3) .T

Pened

 

 

Residue

Fig. 3. The period matrix for (a) solenoid protein YopM-a leucine-rich
effector protein from Yersinia pestis (PDB code lJL5, as in Fig. l) and 0))
sulfhydryl protease from the latex of the papaya fruit (PDB code 9PAP).
Notice the variation of period frequency for 9PAP while 1] L5 periodicity
appears regular

Some observations about distance may be made through visual inspec-
tion of solenoid proteins: (1) solenoids, are usually elongated, (2) contact-
ing residues in solenoids should have low sequence separation relative to
globular proteins and (3) there should be regularity in sequence among
the contacting residues (conversely, there should be large variance for
non-solenoids). Two residues are in contact if the distance between the
C-alpha coordinates of both residues is less than a pre-deﬁned threshold.
To measure the distance in 3D space between the N— and C—terminus, the
following distance is used:

MD 2 min[d(i,j)] Vi g 40, j z N — 40 (5)

where d(i,j) is the distance between C-alpha atoms of residue 1' and j and N
is the length of the protein. MD calculates the minimum distance between
the ﬁrst 40 residues and the last 40 residues. This value should give a good
measure of protein elongation. Next, the number of contacting residues at
a sequence separation >55 are calculated as follows:

N—l N—l
_ 21:0 Zi—55>j>i+55 Ci}

NC
N

 

(6)

where Ci]- : 1 if the distance between iand j is <6 A, a value chosen because
it closely resembles the hydrogen bond distance. The sequence separation
cutoff at 55 was chosen since solenoid unit length rarely exceeds this value
for solenoids and contacts between repeating units can therefore be
counted by NC. In contrast, long-range contacts are often present in
globular protein structures (Kajander et al., 2005; Main 61 al., 2003).

Finally, the regularity of contacting residues in the sequence is mea-
sured by the variance of the residue-wise contact order (RWCO) (Kinjo
and Nishikawa, 2005), which for residue 1' is deﬁned as:

N—1
i—3 >j > 1+3

1 . .
cho, 2 NZ |z — 1| C, (7)

 

3259

112 /810's112umo [p.IOJXO'SOIlBIIlJOJUIOIQ/ﬂdllq uIOJj pop1201umoq

9IOZ ‘09 lsnﬁnv uo ::

I. Walsh et aI.

 

where Cijzl if the distance between i and j is <15A. This cutoff was
chosen to relax the distance strength and thus allow a sufﬁcient count at
all sequence separations. RWCO, is the sum of sequence separations be-
tween the ith residue Vi: 0,. . . ,N— l and all contacting residues. The
variance of this property will give a measure of how regular the sequence
separation is for contacting residues. Let RWCOaVg be the average and
0(RWCO) be the standard deviation of RWCO. The ﬁnal value used for
discrimination of solenoids is the standard deviation of the set deﬁned by:

{RWCO : RWCO, e [RWCOaVg — 0.6o(RWCO), RWCOaVg

(8)
+ 0.60(RWCO)]}

This gives a measure of the variance of the sequence separation be-
tween the contacts while ignoring extreme outliers.

The previously described periodic and distance features were combined
using a support vector machine (SVM). The SVM C parameter was set to
0.02 and a simple linear kernel was used. The SVM produces a real
number score with positive values indicating predicted solenoids and
negative values indicating non-solenoids. The more positive the SVM
score, the more solenoid the protein should be.

2.4 Finding insertions

A simple baseline method is used to discriminate non-periodic residues or
insertions in a structure from the core solenoid repeat. The main source of
data is the variation of distances between residue j and j :l: P* where P* is
the calculated period. For each residue j, we deﬁne the minimum periodic
distance toward the N and C termini:

PDJN = min[d(j, j — P* :l: A)]

PDf = minldv',j+ P* j: m] VA = 1» ---»w (9)

d(.,.) is the Euclidean distance between C-alpha atoms on residue pairs.
PDNJ- and PDCJ- are used as a double-pointed probe on the structure
at residue j. First, it is important to determine the representative distance
of a given period since proteins with the similar period do not necessarily
repeat at the same distance. Given a protein of length L, the raw set of
periodic distances D = {PDC,PD]1V, ...,PDE,PD§} is reduced to the
subset Df g D using the following conditions:

PDjV/C<T

10
PD?” 6 [Davg — 6(D)/2, Davg + 3(1)) /2] ( )

where DaVg and 0(D) are the average and standard deviation of D, re-
spectively. These conditions ensure the removal of extreme outliers and
large non-meaningful distances (i.e. non chemical bonds). Let me
denote the median of the set Df. It is in fact the variation from me,
which will measure the potential for non-periodicity. This variance proﬁle
is deﬁned as follows:

L 1 if PDN/C<me:l:).

VP _  { 0 dtherwise (11)

when calculating distances boundary conditions, ]j+P*:l:A| 5L and
]j+P*:l:A| 31, were implemented. The parameters w, T and A were
determined using a grid search on the training folds of the leave one
out procedure. Values for the parameters were found to range
we [9,10], A e[l.5, 2.0] and Te [12,15] depending on the training fold.
Intuitively, the idea is to capture the maximum deviation of each residue
from the median periodicity. This is a simple algorithm, which may be
further improved with more parameters and machine learning but should
nevertheless provide a valid baseline for detecting insertions and repeat
boundaries. Throughout this article, we will refer to insertions as
non-repeated residues surrounded by solenoid repeats. Only the ﬁnal ex-
periment is shown in this article, with results for the two partial optimiza-
tions shown in the Supplementary Material. All thresholds were found by
maximizing Q2 on the training sets.

2.5 Datasets

The training and test sets are based on publicly available data from the
REPETITA article (Marsella et al., 2009). Brieﬂy put, an initial set of 32
solenoid repeat proteins was taken from a previous review (Kobe and
Kajava, 2000) and expanded using TESE (Sirocco and Tosatto, 2008)
to ﬁnd more protein domains in CATH (Pearl et al., 2003) belonging to
the same solenoid folds as the initial set. Choosing representatives with at
most 35% pairwise sequence identity (i.e. CATH ‘S’ level) yielded a set of
105 solenoid domains. The set of non-solenoid protein domains was gen-
erated with TESE by randomly choosing X-ray structures with different
topologies and no detectable sequence similarity (i.e. CATH ‘T’ level) for
a total of 247 domains. The sets of solenoid and non-solenoid protein
domains were randomly split into training and test sets, with the con-
straint that solenoid structures of low similarity fall in the same partition.
It is worth mentioning that closed repeating structures such as beta-barrels
or propellers are not included in the set and our algorithm does not con-
sider these toroidal structures, but may still ﬁnd their periodic signal.

In addition to the training and test sets, RAPHAEL was also bench-
marked on CATH and PDB. The ‘S’ and ‘0’ level classiﬁcations, with a
maximum sequence identity of 35% and 60% were downloaded from the
CATH website for the current version (v3.4). The PDB was downloaded
as of July 1, 2011. DNA, RNA and protein chains with length <30 amino
acids were removed. Each structure was separated into chains and reduced
to 40% sequence identity using CD-HIT (Li and Godzik, 2006) with
options -c 0.4 —n 2, creating a diverse set of 16226 unique chains.

2.6 Performance measures

Throughout this article, TP, FP, TN and FN are used for true positives,
false positives, true negatives and false negatives, respectively. Sensitivity
and precision values are calculated for both periodic (P, positive class)
and non-periodic residues/structures (N, negative class). The following
measures are used: sensitivity (P)=TP/(TP+FN), precision (P)=TP/
(TP+FP), sensitivity (N)=TN/(TN+FP) and precision (N)=TN/
(TN+FN). Accuracy is used as synonymous to sensitivity and Q2 is
the fraction of correctly predicted residues, i.e. (TP+TN)/
(TP+FP+TN+ FN). The receiver operator characteristic (ROC)
curve describing the overall performance at variable thresholds is plotted
as TP rate versus FP rate.

To compare RAPHAEL to existing methods, we chose the
structure-based method Swelfe (Abraham et al., 2008) and three
sequence-based methods: REPETITA (Marsella et al., 2009), TRUST
(Szklarczyk and Heringa, 2004) and RADAR (Heger and Holm, 2000).
Since Swelfe returns several alternative predictions, the best was con-
sidered in order to overestimate rather than underestimate its perform-
ance. The results for the sequence-based methods are taken from our
previous publication (Marsella et al., 2009). The comparison should be
considered a baseline only, given that all of these tools (except
REPETITA) are not explicitly designed for solenoid detection.

3 RESULTS

3.1 Solenoid identiﬁcation

In order to identify possible solenoids, RAPHAEL transforms
the coordinates of the protein structure into a period matrix. An
example for the transformation of a solenoid and a clearly
non-repetitive structure can be seen in Figure 3. The solenoid
structure produces a compressed signal of higher intensity,
which can be used for detection. Several parameters were derived
to take advantage of this information (see Section 2). The per-
formance at discriminating solenoids with the combined SVM
score on the training set is shown in Table 1, while the individual

 

3260

112 /310's112umo [p.IOJXO'SOllBIIHOJUIOIQ/ﬁdllq uIOJj pop1201umoq

9IOZ ‘09 lsnﬁnv uo ::

RAPHAEL

 

Table 1. Accuracy on the training set and test set combining all six fea-
tures through an SVM

 

TP FP TN FN Solenoids Non-solenoids

 

Training 49 2 117 1 98.0 98.3
Testing 48 6 122 7 87.3 95.3
Leave one out> 0 94 7 240 11 89.5 97.2
Leave one out>1 91 1 246 14 86.7 99.6

 

Results are shown for the method optimized on the training set (first two rows) and
on the leave one out split (last two row), respectively. The latter are further reported
at an SVM threshold of 0 and 1.

parameters are reported in Supplementary Table S1. Although
the window function is the most discriminating feature, the SVM
combination improves performance by ca. 4% for solenoids and
ca. 7% for non-solenoids, suggesting that different information is
captured. Due to the limited number of training data and to be
more statistically robust, we also tested the performance of a
leave one out cross-validation. Here, training is performed with
N-l protein chains and testing with the remaining chain, while
counting the results for all the testing examples (n: 351). This
produces results somewhere between the training and test sets,
with only 7 false solenoids and 11 false non-solenoids for the
entire dataset. Table 1 also shows how a stricter SVM threshold
of 1.0 produces just 1 false solenoid, at the expense of losing 14
solenoids, thereby increasing positive precision to 98.9% com-
pared with 93.1% for an SVM score of 0. In other words, an
SVM threshold of 1.0 corresponds to very conﬁdent solenoid
assignments.

A full ROC curve for the leave one out cross-validation is
shown in Figure 4, also comparing with Swelfe and three
sequence-based methods. Swelfe is not speciﬁcally designed for
solenoids, but rather tries to detect internal repeats in proteins. It
should also be emphasized that solenoid detection from sequence
is more difﬁcult and hence such methods can be expected to
perform less well. The difference in ROC curve is nevertheless
remarkable, with RAPHAEL detecting three times more solen-
oids than the other methods at low FP rates and the most difﬁ-
cult solenoid at an FP rate of ca. 20%. Table 2 shows the
distribution of correct and incorrect classiﬁcations for leave
one out training split in terms of CATH class. Interestingly,
it is the alpha-beta class which produces the most errors on so-
lenoids (i.e. 7), suggesting that it may be somewhat more difﬁcult
to ﬁnd solenoids when they have an alpha-beta mix. The datasets
do not take into account Class 4 (few secondary structures) as
either negative or positive examples.

3.2 Periodicity estimation

Once the presence of a solenoid has been established, it is im-
portant to deﬁne its periodicity, i.e. the length of the repeating
unit. Supplementary Figure S1 shows a comparison of the per-
iods determined from the period matrix (see Section 2) to a
manual derivation from our previous work (Marsella
et al., 2009). The relationship is clearly linear, with an overall
Spearman correlation coefﬁcient of 0.877 indicating a strong re-
lationship between RAPHAEL and the manually extracted

 

   
 

 

 

0.9 ' F.4-l
0.0 -
0.? ‘-
I
E ill} -
E 0.5
E
'1 0'14- »? S'Ul'u'leoorEeﬂ
S‘u'l'u'l score 3* '1
E
'— ﬂj ‘ _HF'.F'HFIEL
Ewell-e
0.2 - Trust
—Repetila
0.1 ' —Hadar
n I I I I I I I I
0 0.05 0.1 0.15 0.2 0.25 0.3 0.35 0.11

False- Pusiﬁuie Rate

Fig. 4. ROC curve on the combined training and test set. RAPHAEL
trained using the leave one out split is compared with four other methods.
The curve ends when a method does not produce further output, i.e. be-
lieves to have found all solenoids. Two SVM score thresholds are shown
at 0 (orange circle) and 1 (yellow square), respectively

Table 2. Precision as a function of CATH class

 

 

Class TP FP TN FN Solenoids Non-solenoids
Mainly oz 40 0 59 2 100.0 96.7
Mainly ,8 31 0 16 9 100.0 64.0
Mixed 01—,8 23 7 165 0 76.7 100.0

 

Results calculated on the leave one out split. Precision results on solenoids and
non-solenoids.

repeat lengths. Upon inspection, the small number of outliers
exhibit period matrices which are highly variable and contain
insertions and/or deletions. As expected, it is difﬁcult to deter-
mine the repeat length when insertions or deletions are present in
the structure. Looking in more detail at the difﬁculty level of the
solenoids, the hard (i.e. solenoids containing many insertions)
cases have a Spearman correlation coefﬁcient of 0.753 compared
with 0.934 for the easy ones (i.e. solenoids with few or no inser-
tions). Figure 5 shows a comparison of RAPHAEL to Swelfe
and three sequence-based methods in terms of detecting the cor-
rect periodicity. Since the exact period in solenoids with inser-
tions can be somewhat arbitrary, we allow two distinct levels of
correctness. In analogy to our previous work (Marsella et al.,
2009), we consider one residue around the manually curated
periodicity correct for all predictions. For sequence-based meth-
ods, we also consider half or double the structural repeat as
correct within tolerance. As structure-based methods
(RAPHAEL and Swelfe) may be sensitive to insertions, we
allow ﬁve residues around the exact period as correct within
tolerance. The effect of the window size on RAPHAEL predic-
tions is shown in Supplementary Figure S2. As can be seen in
Figure 5, RAPHAEL and the more accurate sequence-based
methods have similar performances in recognizing correct peri-
ods. This is somewhat unexpected, but likely due to correct clas-
siﬁcation of solenoids without insertions where a clear sequence
signal corresponds to the structural unit.

 

3261

112 /810's112umo [p.IOJXO'SOTlBIHJOJUTOTQ/ﬁdllq uIOJj pop1201umoq

9IOZ ‘09 lsnﬁnv uo ::

I. Walsh et aI.

 

0.5 - |:| within tolerance
m 0.5 - loorreet

 

 j
Smite RAPHAEL Repetila Trust Radar
Fig. 5. Detection of repeat periodicity for RAPHAEL and four other

methods. See main text for details on the thresholds used to deﬁne the
two levels of correctness

3.3 Insertions

Given the performance in detecting solenoid proteins, the next
question becomes whether the method is able to detect insertions
for these proteins. To test this, every residue in each solenoid
structure was annotated as either repeated or not. The Q2,
sensitivity and precision measures for the dataset are shown in
Table 3. It should be emphasized that we are proposing a simple
baseline algorithm with a few caveats. First of all, several solen-
oid structures are rather degenerate, prompting a somewhat ar-
bitrary distinction between approximately repeated and inserted
residues. Second, RAPHAEL tends to ﬁnd clear insertions but
ﬁnds it difﬁcult to determine less obvious cases, as clear inser-
tions disrupt the regular spatial pattern at the basis of our algo-
rithm. Hence, smaller insertions can be underpredicted, whereas
longer insertions are found but often reported as more disruptive
than necessary. An example can be seen in Figure 6. To the best
of our knowledge, this is the ﬁrst time that an automatic classi-
ﬁcation of structural repeat insertions is attempted in the litera-
ture. It certainly also expands our view on the previously released
REPETITA dataset (Marsella et al., 2009).

3.4 Large-scale extraction of periodicity data

In order to test RAPHAEL, we decided to process large sets such
as the PDB and CATH to generate datasets for future use. For
this large-scale search, we trained the SVM on the combined
datasets (105 solenoids and 247 non-solenoid domains).
RAPHAEL was used to detect solenoids on the entire CATH
database at the S(35) and C(60) levels corresponding, respect-
ively, to 35% and 60% maximum sequence identity. Supplemen-
tary Figure S3 shows the SVM score for all domains at S(35).
Choosing this identity cutoff guarantees that solenoid domains
are diverse at least at the sequence level but it can also be
assumed to be true at the structural level. In total the algorithm
considered 748 domains to be solenoids at this sequence identity
cutoff (Table 4 and Supplementary Fig. S4). Obviously, the
higher the score, the more expressed the periodicity should
become. Upon visual inspection, the better solenoids are repre-
sented by an SVM score >1 (221 domains; see inset in Supple-
mentary Fig. S4). In order to ﬁnd more solenoid domains which
may be useful, we also processed CATH with no sequence pair
sharing 60% sequence identity. Using this less stringent cutoff,
the algorithm detected 1156 CATH domains, with the distri-
bution of SVM scores shown in Supplementary Figure S5.

Table 3. Performance of simple insertion ﬁnding algorithm on leave one
out cross-validation

 

 

Measure All Easy Hard
Q2 79.8 83.4 74.1
Sensitivity (P) 95.5 95.7 95.1
Precision (P) 79.5 84.9 69.6
Sensitivity (N) 44.2 40.3 47.4
Precision (N) 81.2 72.7 88.5

 

The Q2, sensitivity and precision measures are shown after leave one out optimiza-
tion for maximum Q2.

'III'EI

 

 

 

 

 

 

 

 

0.5 - l
‘ j I
 | | | I. .

liq-hIcLLIL' pm II I-::-I1

Fig. 6. Example of insertions found for a ,B-solenoid. The variance plot
(left) shows the score VP used to determine the location of insertions for
endopolygalacturonase (PDB code 1HG8 chain A). The yellow area in-
dicates the true positions of the periodic residues (periodicity at 0.5, in-
sertion 0).The same structure (right) is colored in red for residues assumed
to be repeated and in blue for insertions. Notice how the algorithm
identiﬁes the core solenoid domain, while mispredicting some C—terminal
residues

A list of CATH domains ranked by the solenoid score produced
by the SVM can be found on the RAPHAEL website.

Of course the extracted CATH domains will intersect with the
set used for algorithm construction. Using a 50% sequence iden-
tity cutoff, we identify 696 proteins on S(35) and 1089 on O(60)
which are not homologous to our training data. At the more
stringent SVM score >1, the number of newly mined domains
is 172 for S(35) and 245 for O(60). This has to be compared with
the currently available list of 105 solenoid repeats (Marsella
et al., 2009).

In addition to CATH domains, we also processed PDB chains
with RAPHAEL, ﬁnding 1131 chains to be considered solenoids
at 40% maximum sequence identity. A more conﬁdent set of 551
solenoid chains with SVM score >1 was also generated. These
numbers increase to 5419 and 2478 for the full PDB (Table 5).
It is interesting to note how the PDB analysis contains a com-
paratively higher number of conﬁdently predicted solenoid struc-
tures than CATH. This might suggest the existence of solenoid
structures outside the already known CATH superfamilies, al-
though further analysis will have to be carried out to verify this
hypothesis.

To validate the results and verify the extent to which
RAPHAEL detects previously unknown solenoid proteins, we

 

3262

112 /810's112umo [p.IOJXO'SOTlBIHJOJUTOTQ/ﬁdllq uIOJj pop1201umoq

9IOZ ‘09 lsnﬁnv uo ::

RAPHAEL

 

Table 4. Solenoid frequency in CATH

 

 

S(35) O(60)
Class % n % n
Mainly oz 7.3 141 6.6 200
Mainly ,8 15.1 301 15.2 492
Mixed ot—,B 6.4 302 5.6 456
Few sec. struct. 5.2 4 7.3 8

 

The frequency (%) and absolute number (n) of solenoids found in each CATH class
are shown for the S and 0 levels at 35% and 60% maximum sequence identity,
respectively.

Table 5. Number of solenoids found in CATH and the PDB

 

 

Structures SVM > 0 SVM > 1
CATH S(35) 11,330 748 221
CATH O(60) 15,778 1156 308
PDB 40 16,226 1131 551
PDB full 74,020 5419 2,478

 

The number of structures found with an SVM score >0 and l is shown for the
CATH S and 0 levels (i.e. 35% and 60% maximum sequence identity) as well as for
the PDB dataset made non-redundant at 40% sequence identity and the full PDB.

RHHNHEI SGWE 3 D Raphael score .'- 1

PDB "repeat keyword FIT-IE ‘repeet' keyword

Fig. 7. Venn diagram of RAPHAEL predictions and PDB repeat anno-
tations. The predictions are shown at the SVM score cutoffs of 0 (left)
and 1 (right) on the entire PDB. The PDB headers were scanned for the
‘repeat’ keyword

have calculated the overlap of our predictions with PDB entries
of proteins having the ‘repeat’ (or ‘repeats’) keyword in their
respective header records. The results are drawn as a Venn dia-
gram in Figure 7. It should be noted that PDB entries with the
‘repeat’ keyword contain proteins that are not true solenoid re-
peats, e.g. the repeated spectrin or ﬁbronectin domains.
Nevertheless, RAPHAEL overlaps well with the PDB annota-
tion but provides an even greater amount of novel automatic
annotations. These can be useful for the automatic annotation
of proteins by structural genomics consortia or the PDB itself.

4 CONCLUSIONS

In this article, we have presented a novel method, RAPHAEL,
for the accurate determination of solenoid repeats from PDB
structures. The method quantiﬁes repeat structures by mimicking
visual interpretation by experts through various parameters.
Combination in a SVM provides exceptionally accurate predic-
tions, as tested on a previously published dataset. To the best of

our knowledge, we show for the ﬁrst time that our method is also
able to broadly recognize insertions and repeat boundaries.
Scanning the entire CATH and PDB databases provides
hundreds or thousands of additional solenoid repeats, with auto-
matic annotation for repeat regions. RAPHAEL was imple-
mented in a new web server-based application for automatic
repeat protein recognition. Due to the importance of repeat pro-
teins in both design and human diseases, we plan to use this
method for systematic large-scale analysis of protein structures,
in order to improve our understanding of these peculiar proteins
and their impact on organism evolution.

ACKNOWLEDGEMENTS

The authors are grateful to members of the BioComputing UP
laboratory for insightful discussions.

Funding: University of Padova grant CPDA098382 and FIRB
Futuro in Ricerca grant RBFROSZSXY (to S.T.). GM. is an
AIRC research fellow.

Conﬂict of Interest: none declared.

REFERENCES

Abraham,A.L. et al. (2008) Swelfe: a detector of internal repeats in sequences and
structures. Bioinformatics, 24, 1536—1537.

Andrade,M.A. et al. (2001) Protein repeats: structures, functions, and evolution.
J. Struct. Biol, 134, 117—131.

Berman,H. et al. (2007) The worldwide Protein Data Bank (waDB): ensuring a
single, uniform archive of PDB data. Nucleic Acids Res., 35, D301—D303.
Biegert,A. and Soding,J. (2008) De novo identiﬁcation of highly diverged protein

repeats by probabilistic consistency. Bioinformatics, 24, 807—814.

Buard,J. and Vergnaud,G. (1994) Complex recombination events at the hypermut—
able minisatellite CEBl (D2890). EMBO J., 13, 3203—3210.

de Wit,J. et al. (2011) Role of leucine-rich repeat proteins in the development and
function of neural circuits. Annu. Rev. Cell Dev. Biol, 27, 697—729.

Heger,A. and Holm,L. (2000) Rapid automatic detection and alignment of repeats
in protein sequences. Proteins, 41, 224—237.

J orda,J . and Kajava,A.V. (2010) Protein homorepeats sequences, structures, evolu-
tion, and functions. Adv. Protein Chem. Struct. Biol, 79, 59—88.

Kajander,T. et al (2005) A new folding paradigm for repeat proteins. J. Am. Chem.
Soc., 127, 10188—10190.

Kajava,A.V. (2001) Review: proteins with repeated sequenceistructural prediction
and modeling. J. Struct. Biol, 134, 132—144.

Kajava,A.V. (2011) Tandem repeats in proteins: from sequence to structure.
J. Struct. Biol, 179, 279—288.

Kajava,A.V. et al. (2006) Beta-structures in ﬁbrous proteins. Adv. Protein Chem.,
73, 1—15.

Kinjo,A.R. and Nishikawa,K. (2005) Recoverable one-dimensional encoding of
three-dimensional protein structures. Bioinformatics, 21, 2167—2170.

Kobe,B. and Kajava,A.V. (2000) When protein folding is simpliﬁed to protein
coiling: the continuum of solenoid protein structures. Trends Biochem. Sci,
25, 509—515.

Li,W. and Godzik,A. (2006) Cd-hit: a fast program for clustering and comparing
large sets of protein or nucleotide sequences. Bioinformatics, 22, 1658—1659.
Main,E.R. et al (2003) The folding and design of repeat proteins: reaching a con-

sensus. Curr. Opin. Struct. Biol, 13, 482—489.

Main,E.R. et al (2005) A recurring theme in protein engineering: the design, sta-
bility and folding of repeat proteins. Curr. Opin. Struct. Biol, 15, 464—471.
Marcotte,E.M. et al. (1999) A census of protein repeats. J. Mol. Biol, 293, 151—160.
Marsella,L. et al. (2009) REPETITA: detection and discrimination of the periodicity
of protein solenoid repeats by discrete Fourier transform. Bioinformatics, 25,

i289—i295.

Murray,K.B. et al. (2002) Wavelet transforms for the characterization and detection
of repeating motifs. J. Mol. Biol, 316, 341—363.

 

3263

112 /810's112umo [p.IOJXO'SOIlBIHJOJUIOIQ/ﬁdllq uIOJj pop1201umoq

9IOZ ‘09 lsnﬁnv uo ::

LWbbhetaL

 

Murray,K.B. et al. (2004) Toward the detection and validation of repeats in protein
structure. Proteins, 57, 365—380.

Pearl,F.M. et al. (2003) The CATH database: an extended protein family resource
for structural and functional genomics. Nucleic Acids Res., 31, 452—455.

Sabarinathan,R. et al (2010) ProSTRIP: a method to ﬁnd similar structural repeats
in three-dimensional protein structures. Comput. Biol. Chem., 34, 126—130.

Shih,E.S. and Hwang,M.J. (2004) Alternative alignments from comparison of pro-
tein structures. Proteins, 56, 519—527.

Sirocco,F. and Tosatto,S.C. (2008) TESE: generating speciﬁc protein structure test
set ensembles. Bioinformatics, 24, 2632—2633.

Stefan,N. et al (2011) DARPins recognizing the tumor-associated antigen EpCAM
selected by phage and ribosome display and engineered for multivalency. J. M ol.
Biol, 413, 826—843.

Szklarczyk,R. and Heringa,J. (2004) Tracking repeats using signiﬁcance and tran-
sitivity. Bioinformatics, 20 (Suppl. 1), 1311—1317.

 

3264

112 /810's112umo [prejxo'sor112u1101urorq//:d11q uIOJj pop1201umoq

9IOZ ‘09 lsnﬁnv uo ::

