ORIGINAL PAPER

Vol. 29 no. 15 2013, pages 1851—1857
doi:10. 1093/bioinformatics/btt31 1

 

Genome analysis

Advance Access publication June 3, 2013

Gene-set analysis is severely biased when applied to

genome-wide methylation data

Paul Geeleher1’2, Lori Hartnett3, Laurance J. Egan3, Aaron Golden4, Raja Affendi Raja Ali3

and Cathal Seoighe2’*

1Section of Hematology/Oncology, Department of Medicine, University of Chicago, Chicago, IL 60637 USA,
2Department of Mathematics, Statistics and Applied Mathematics and 3Department of Pharmacology and Therapeutics,
National University of Ireland, Galway, Ireland and 4Department of Genetics, Albert Einstein College of Medicine, 1300

Morris Park Ave, Bronx, NY 10461, USA

Associate Editor: lnanc Birol

 

ABSTRACT

Motivation: DNA methylation is an epigenetic mark that can stably
repress gene expression. Because of its biological and clinical signifi-
cance, several methods have been developed to compare genome-
wide patterns of methylation between groups of samples. The appli-
cation of gene set analysis to identify relevant groups of genes that are
enriched for differentially methylated genes is often a major compo-
nent of the analysis of these data. This can be used, for example, to
identify processes or pathways that are perturbed in disease devel-
opment. We show that gene-set analysis, as it is typically applied to
genome-wide methylation assays, is severely biased as a result of
differences in the numbers of CpG sites associated with different
classes of genes and gene promoters.

Results: We demonstrate this bias using published data from a study
of differential CpG island methylation in lung cancer and a dataset we
generated to study methylation changes in patients with long-standing
ulcerative colitis. We show that several of the gene sets that seem
enriched would also be identified with randomized data. We suggest
two existing approaches that can be adapted to correct the bias.
Accounting for the bias in the lung cancer and ulcerative colitis data-
sets provides novel biological insights into the role of methylation in
cancer development and chronic inflammation, respectively. Our re-
sults have significant implications for many previous genome-wide
methylation studies that have drawn conclusions on the basis of
such strongly biased analysis.

Contact: cathal.seoighe@nuigalway.ie

Supplementary information: Supplementary data are available at
Bioinformatics online.

Received on March 26, 2013; revised on April 29, 2013; accepted on
May 24, 2013

1 INTRODUCTION

Microarrays and high-throughput sequencing are frequently
used to assess the methylation status of CpG sites and CpG
islands genome-wide. Array platforms for this purpose have
been developed by Agilent, Illumina and NimbleGen, and sev-
eral high-throughput sequencing-based methods have also been
developed, such as genome-wide bisulphate sequencing, meDIP-

 

*To whom correspondence should be addressed.

seq Weber et al., 2005) and HELP-seq (Oda et al., 2009).
Gene-set analysis (GSA) is frequently used to discover meaning-
ful biological patterns from lists of genes generated from high-
throughput experiments, including genome-wide DNA methyla-
tion studies. The objective is typically to identify similarities be-
tween the genes, with respect to annotations available from
sources such as the Gene Ontology (GO) (Ashburner et al.,
2000) or Kyoto Encyclopedia of Genes and Genomes (KEGG)
(Kanehisa and Goto, 2000). Popular tools for this purpose in-
clude GOStats (Falcon and Gentleman, 2007) and DAVID
(Huang et al., 2009a, b). A signiﬁcant result for a gene set is
interpreted as evidence that the corresponding biological func-
tion or process is affected in the experimental condition or treat-
ment. A key assumption of GSA methods is that all genes have,
a priori, the same probability of appearing in the list. If this is not
true, that is, if certain classes of genes are more likely to appear in
the list, regardless of the treatments or conditions being investi-
gated, this has the potential to cause misleading results from
GSA.

The application of GSA to lists of genes found to be differen-
tially expressed between groups of samples using RNA-seq is
known to be affected by such a bias (Oshlack and Wakeﬁeld,
2009). This is because there is more power to detect changes in
expression for genes with higher numbers of mapped sequence
reads. Consequently, longer and more highly expressed genes
(which tend to have more mapped reads) are more likely to be
identiﬁed as differentially expressed. The lengths and expression
levels of genes frequently differ between gene sets, resulting in
some gene sets wrongly appearing to be enriched among the
differentially expressed genes. A method to correct this bias
has already been developed Woung et al., 2010). However, the
application of GSA is not restricted to the results of high-
throughput gene expression measurements; the same approach
is used for many other high-throughput experiments. A similar
issue has also been highlighted in ChIP—Seq data, when distal
binding sites are included in the analysis. In this case, GSA
may be confounded when genes in different gene sets are repre-
sented by different proportions of the genome. McLean et al.
(2010) developed GREAT, a tool that can take account of
these differences by using a binomial test over a user-deﬁned
set of genomic regions. However, GREAT is not suitable for
analysis of methylation data, as it cannot differentiate between

 

© The Author 2013. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com 1851

112 [glO'SIBILInO[p.IOJXO'SODBIIIJOJIITOTQ/ﬂdllq IIIOJJ pepeolumoq

910K ‘09 lsnﬁnV no :2

P. Geeleher et al.

 

one gene in a set with many highly differentially methylated CpG
sites or many genes in the same set with one highly differentially
methylated CpG site each. This distinction is important in stu-
dies of DNA methylation because there are many cases where
methylation of only one CpG site has been shown to perturb
expression (for example, Claus et al., 2012; Deng et al., 1999;
Sohn et al., 2010; Zou et al., 2006); hence, GREAT has not been
applied to data of this type. Here, we focus on the application of
GSA to the results of high-throughput DNA methylation experi-
ments. We show that GSA, as it is typically applied to DNA
methylation data, is severely biased and show that methods that
have previously been applied to RNA-seq data can be adapted to
correct this bias.

2 RESULTS AND DISCUSSION

2.1 Bias in GSA applied to the results of genome-wide
differential methylation studies

Microarray platforms designed to proﬁle DNA methylation
across the genome are typically designed such that some genes
are associated with a large number of probes, whereas others
have few associated probes. These differences stem from the
fact that different genes and gene promoters contain different
numbers of CpG sites. On the Agilent Human CpG Island
array, for example, the number of probes per gene promoter
ranges from 1 to 285 (Supplementary Fig. S1). Similar platforms
by NimbleGen (Human DNA Methylation 385 K Promoter Plus
CpG Island Array) and Illumina (Inﬁnium HumanMethy-
lation450 BeadChip) contain from 1 to 80 and 1 to 1288
probes per gene, respectively (Supplementary Fig. S2). The
reason that these differences are problematic for GSA becomes
clear when we consider the methods currently used to identify
differentially methylated genes. For example, comparing tumor
and normal lung samples, Helman et al. (2012) called a gene
differentially methylated when two nearby probes (allowing
one intervening probe) both showed at least a 2-fold difference
in methylation between the sample groups. Given this criterion,
genes (for example, SOCS4) that have only two associated
probes will be tested just once for differential methylation. By
contrast, PPP2R3B, which has 197 associated probes, is tested
nearly 400 times. It is clear that PPPZRSB is far more likely to
give false-positive results (resulting from probes exceeding these
ﬁxed thresholds by chance). Indeed, there is also more power to
detect a real differential methylation signal for genes with many
associated probes.

Many other ad hoc criteria have been applied to deﬁne differ-
entially methylated genes. For example, Dunwell et al. (2010)
classed genes as differentially methylated if one associated
probe reached a fold change of >3. Other authors have used
more complex experimental designs and data analysis methodol-
ogies, but these do not eliminate the bias. For example, Kalari
et al. (2012) used a peak calling method to identify regions that
appeared enriched for methylation; however, because of the dif-
ferent numbers of probes associated with each gene, it is clearly
more likely to call peaks on genes with many associated probes.
In all cases, where some genes are tested many more times than
others (as is typical in methylation analysis), genes with more
associated probes (in the case of microarrays) or more associated

CpG sites (in the case of high-throughput sequencing) are more
likely to fulﬁll whatever criteria is used, Violating a key assump-
tion of GSA. The reason that this causes such a strong bias in
GSA is because there are also large differences between gene sets
in the mean numbers of associated probes per gene. For example,
on the Agilent Human CpG Island microarray, genes annotated
to the Gene Ontology term ‘Embryonic organ development’
(GO:OO48568) have, on average, 22.7 associated probes, more
than twice the average of 9.8 probes for all genes.
Consequently, if the methodology used to identify differentially
methylated promoters is sensitive to the number of probes in the
promoter, this gene set is likely to contain a disproportionate
number of signiﬁcant genes, and thus is more likely to appear
to be signiﬁcantly enriched in the subsequent GSA.

2.2 Reanalysis of a published dataset

Many published studies have applied GSA to high-throughput
methylation data (for example, Booth et al., 2012; Deng et al.,
2009; Doi et al., 2009; Elango et al., 2009; Irizarry et al., 2009;
Liu et al., 2010; Schroeder et al., 2011; Sen et al., 2010; Sproul
et al., 2012; Takeshima et al., 2009; Zhu et al., 2012). In all of
these studies, regardless of the platform used, gene sets relating
to development, transcription or differentiation were reported to
be enriched for differentially methylated genes; however, these
gene sets are typically associated with large numbers of probes
per gene (the precise number depending on platform; Fig. 1a).
We now consider one such study in detail. Rauch et al. (2008)
used the Agilent Human CpG Island microarray to assess methy-
lation in ﬁve lung cancer samples compared with normal lung
tissue and Helman et al. (2012) applied GSA to identify hyper-
methylated gene sets in this dataset. CpG islands were called as
hypermethylated in a sample ‘when at least two adjacent probes,
allowing a one-probe gap, within the CpG island scored a fold-
difference factor of >2 when comparing tumor and normal tissue
DNA’ (Rauch et al., 2008). Genes were considered hypermethy-
lated in lung cancer if any associated CpG island met this criter-
ion in four out of the ﬁve samples. The R package GOStats was
then used to assess aberrant methylation of GO biological pro-
cesses (BP) containing between 100 and 1000 genes (Rauch et al.,
2008). We followed the original methodology and obtained
results similar to Helman et al. (2012) (Table 1). The most
signiﬁcantly enriched gene sets (including differentiation/
developmental and transcription factor activity related gene
sets) all consisted of genes that were associated with far more
microarray probes than average (Fig. 1b). Furthermore, the en-
richment P-Value for each gene set was strongly correlated with
the mean number of probes per gene (Fig. 10). This suggests that
these results may be attributable, at least in part, to differences
between gene sets in the number of probes per gene.

2.3 Demonstration of bias using randomized probe
locations

As an additional line of evidence, we show that signiﬁcant results
can be achieved from this dataset using randomized data. To do
this, we carried out 100 random permutations of the probe log-
intensity values within each sample and repeated the inference of
differential methylation followed by GSA. To ensure that the
results were comparable with the original data, we modiﬁed

 

1852

112 [3.10811211an[p.IOJXO'SODBIIIJOJIIIOIQ/[Z(11111 IIIOJJ pepeolumoq

910K ‘09 lsnﬁnV uo :2

Bias in methylation GSA

 

the fold change cut-off for differential methylation so that the
average number of hypermethylated genes was the same as in the
original data. Altering the fold change cut-off was necessary be-
cause the methylation status of adjacent CpG sites is correlated
in the real data (Bell et al., 2011), resulting in a higher probability

 

 

A B m _
 - ....... ..   T l  i 
 hi1IIIIIIIIIIIIIIIIIIII   i i I

 

 

 

 

D_ : F—

_ J.

 

 

ID O O N m leﬂ N w h h N M w h O m N D I‘m

F m O M N m N m m m h w m Q m Q h F I‘I‘ NZ

mahnhmmmwmhhmhmmarmwcd-o O 0) w I!) U) 03 IN Q ‘0 ('3 ‘0

g M O O C M  O 3 g C) D O 3 D O O I.”

9009000 00 0 0° OOOOOO D D O O O O D (D

99999999i999i999i999999i999i99_l 9 9. 9. 9 9. 9 9. 9. 9. 9. _.

oooooooooooooooooooooooooa 8 8 8
A A A A A A A A A A
V V V V V V V V V ._

(

 

 

—Iog1aP value from GOsfats
10
I
—Iog1o (p —value)
8
I
III:I
.{
-|oo
_ _____.| m

.|
CD

 

 

 

 

 

 

' _|_
Q...- J. _. 4—

"""" ",r-r-s'rw"  2 .. .. .. t .2. 2. t J. .2.
ﬁli'. Ln m m m m no to in o (D
o— (D In In N w ('3 In ('3 c M
m m w m m F Q w U) (D
I I I I 8 3 3 8 8 8 3 8 8 8
1° 15 2° 25 o o o o o o o o o o
0 <9 0 0 <9 0 0 <9 0 o

AAAAAAAAAA

Mean numberofassociated probes ‘- N n v in <9 h as a: o

vvvvvvvvv‘.

I

Fig. 1. (A) The 25 GO BPs (of size >100 and <1000) with the largest
numbers of associated probes per genes on average (on the Agilent
Human CpG Island array). All of these 25 gene sets are related to devel-
opment, differentiation or transcription factor activity. 03) The average
numbers of probes associated with the top 10 gene sets from the uncor-
rected GSA on the lung cancer data. In all cases, these gene sets have
many more associated probes than average (P< 2.2 x 10‘16 in all cases).
(C) —log10 P—values for gene sets in the lung cancer study plotted against
average number of associated probes per gene in the gene set.
(D) Boxplots of —log10 P—values for the top 10 GO BPs in the lung
cancer dataset obtained from 100 random permutations of probe loca-
tions. The dashed line shows the P: 0.05 threshold

of adjacent CpG sites showing differential methylation between
groups. If the application of GSA to this dataset was valid, it
should not reveal any signiﬁcant results because in the permuted
data, each gene was associated with a random set of probes. Yet,
when we applied GSA to the genes found to be differentially
methylated in this random dataset, many of the same gene sets
that were reported in the original analysis were found to be
highly signiﬁcant (Fig. 1d and Supplementary Table S1) in the
vast majority of the random permutations.

2.4 Demonstration of bias using sample randomization

An alternative way to test the validity of results obtained using
GSA is through permutation of sample labels (Barry et al., 2005;
Efron and Tibshirani, 2007). If similar GSA results are obtained
from random groupings of the samples, then the GSA results do
not reﬂect real biological differences between the sample groups
(e. g. tumor versus normal), but rather are an artifact of the ana-
lysis. High-throughput methylation experiments typically do not
admit straightforward label permutation because different sam-
ples are often hybridized to different channels of the same micro-
array. This is the case for the data of Helman et al. (2012) that
was generated by hybridizing tumor and normal tissue to dual
channel arrays. However, it is possible to reproduce the effect of
sample label permutation by inverting the fold change values for
each pair of samples. The data consisted of ﬁve pairs of samples,
resulting in 32 possible conﬁgurations when probe intensities are
inverted in this way. For each permutation, we ranked genes by
methylation fold change of the most differentially methylated
probe and applied GSA to the same number of genes as in the
original analysis. Again we found that the same gene sets that
were reported in the original analysis also seem to be enriched for
the inverted datasets (Fig. 2a). In fact 6 of the 10 most signiﬁcant
gene sets were signiﬁcant for all of the conﬁgurations.

2.5 GSA applied to differential methylation in ulcerative
colitis

As a further demonstration of the bias, we analyzed data gener-

ated again using the Agilent CpG Island microarray, this time

applied to sigmoid colon biopsies from ﬁve patients with long

standing (>25 years) ulcerative colitis (UC), and ﬁve healthy

age-matched controls (manuscript under review). This is a

Table 1. Top 10 GO BP categories for uncorrected GSA on the lung cancer dataset

 

Term

 

GOBPID Count Expected count P—value FDR

GO:0009653 35 7.40 7.48 x 10‘17 1.18 x 10‘14
GO:0048598 21 1.94 8.07 x 10‘17 1.18 x 10‘14
GO:0048568 17 1.10 2.98 x 10‘16 2.59 x 10‘14
GO:0009790 25 3.36 3.74 x 10‘16 2.59 x 10‘14
GO:0009887 25 3.38 4.42 x 10‘16 2.59 x 10‘14
GO:0007389 19 1.63 7.88 x 10‘16 3.85 x 10‘14
GO:0048562 15 0.85 2.56 x 10‘15 1.07 x 10‘13
GO:0006357 24 4.15 4.84 x 10‘13 1.77 x 10‘11
GO:0003002 15 1.29 1.34 x 10‘12 4.36 x 10‘11
GO:0006366 25 5.15 6.79 x 10‘12 1.99 x 10‘10

Anatomical structure morphogenesis

Embryonic morphogenesis

Embryonic organ development

Embryonic development
Organ morphogenesis
Pattern speciﬁcation process

Embryonic organ morphogenesis

Regulation of transcription from RNA polymerase ii promoter

Regionalization

Transcription from RNA polymerase II promoter

 

 

112 ﬂJO'spaumoprOJXO'soi1emJOJuroiw/2d11q IIIOJJ pepeolumoq

910K ‘09 lsnﬁnV uo 22

P. Geeleher et al.

 

 

20— —I—

>
I

_I_ I
. . _ . _ _ _ . _ _ . _ _ _ . _ _ __ _-..I.._-

 

 

 

GO 0006366 -
GO:0048598 —
GO:0009887 —
GO:0007389 — I-
GO:0048568 - l- Dj- - - - - - .I
GO:0045165 -  - - .l
GO:0001501 — 
I
I

— Iogm (p —va|ue)
I I
- II:I:I"I
: II:I]-
GO:0009790 - 

GO 0009653 -
GO 0006357 -

 

W


—|og1o (p—value)
E3
I


"1.
jj- I
'1.

I.
I
I
|
|
I
I
I
I
|
I
|
I.
|
I
I
I
|
I
|
I
I

 

 

 

In]
(2) GO:0048562 - IE- - .l

(1) GO:0003002 —
(3) GO:0009790 - |-
(4) GO:0009952 — |-
(5) GO:0048568 - |-
(6) GO:0007389 - |-
(7) GO:0048598 — |-
(9) GO:0016055 - |-

(a) GO:0009887 -
(10) GO:0031589 — III a

 

Estimated probability of hypermethylation

 

 

 

 

Number of associated probes

Fig. 2. (A) Boxplot of P-values from sample label inversions on the lung
cancer data. (B) Boxplot of P-values from all possible sample label per-
mutations on the UC data. (C) Fit of GOseq’s six knot monotonic spline
function to the lung cancer data. The spline is shown as the solid black
line. The points show the proportion of hypermethylated genes, in bins of
minimum size 100 genes. The 95% conﬁdence intervals for the bins are
shown as vertical lines

different experimental design to the dataset discussed earlier in
the text, as cases and control samples were hybridized to differ-
ent microarrays. The Cy3 channels were hybridized with immu-
noprecipitated methylated DNA [isolated using the MeDIP
(Mohn et al., 2009) approach], and the Cy5 channels were hybri-
dized with input DNA (see Section 4). Thus, the log intensity
ratio of a probe is, in this case, indicative of the extent of methy-
lation of a probe in a given sample, rather than a log ratio of two
different samples (as in the lung cancer experiment). This experi-
mental design allows conventional label permutations. To select
a candidate list of differentially methylated genes in this dataset,
we used the Bioconductor package limma (Smyth, 2005) and
identiﬁed probes that were hypermethylated in the UC samples
(P < 0.05). All genes associated with at least one hypermethylated
probe were considered hypermethylated (see Section 4). This ap-
proach identiﬁed a foreground list of 380 genes for gene set ana-
lysis, which was carried out using GOstats (also for GO BPs with
between 100 and 1000 associated genes). Once again, the results

contain a large number of biological processes related to devel-
opment and differentiation (Table 2).

Interestingly, the GSA results obtained for this dataset were
highly correlated with the results of the lung cancer dataset
(Pearson r: 0.69, P<2.2 x 10‘16). This could suggest that simi-
lar biological processes are perturbed in the two cases, which
would be of interest, as long-standing UC may be associated
with the development of colon cancer (Eaden et al., 2001).
However, because of the bias we have identiﬁed, this interpret-
ation could be misleading, and the correlation may simply be the
result of a shared artifact. Indeed, for the UC dataset we found
that a large majority the same gene sets identiﬁed earlier in the
text remained highly signiﬁcant when sample labels were rando-
mized, with in many cases P-values more extreme than 10—20
generated from arbitrary arrangements of the samples
(Fig. 2B). This shows that even when using a different experi-
mental design and different criteria to deﬁne methylation, highly
signiﬁcant results can again be achieved from random data.

2.6 Bias correction

We applied the Bioconductor package GOseq Woung et al.,
2010) to control for the fact that different genes have, a priori,
different probabilities of appearing in the foreground list. This
package was developed to control for bias in GSA applied to
RNA-seq data. The package uses (by default) a six knot mono-
tonic spline function to model the association between the odds
of a gene appearing in the foreground list (i.e. being detected as
differentially expressed, or in our case hypermethylated) and the
value of the confounding variable (in our case the number of
CpG probes associated with the gene; (Fig. 2C). The model
can be used to predict the probability of a gene appearing in
the foreground list, as a function of the number of associated
probes. Given these probabilities, empirical P-values are
calculated by simulation.

In the lung cancer dataset, the number of GO BP categories
that were signiﬁcantly enriched (FDR<0.05) after correction
was much smaller than previously (9, compared with 72). After
correction (Table 3), ‘Embryonic organ morphogenesis’ was the
most signiﬁcant category (P:4.9 x 104‘, compared with
P: 8.1 x 10‘”, before correction). The expected number of
hypermethylated genes for ‘Embryonic organ morphogenesis’
rose from 1.9 to 3.4, but this is still considerably fewer than
the observed number of hypermethylated genes for this category,
which is 15. This suggests that the reported hypermethylation of
developmental associated genes in this lung cancer dataset is not
an artifact of the higher numbers of associated probes. However,
several of the gene sets identiﬁed in the original analysis are no
longer signiﬁcant. These include gene sets related to transcription
factor activity and, perhaps importantly, the gene sets related
directly to differentiation. The P-value for ‘Regulation of cell
differentiation’ increased from P:3.0 x 10‘4 to P:0.38 and
‘Cell morphogenesis involved in differentiation’ from
P: 8.8 x 10‘3 to P : 0.48. This brings into question the validity
of the original conclusions of Helman et al. that hypermethyla-
tion silences genes required for maintenance of the differentiated
state. Results for all GO BP terms evaluated are provided as
Supplementary Table S2.

 

1854

112 /810's112umofp101x0'soi112u1101u101qﬂ2d11q 111011 pep1201umoq

910K ‘09 tsnﬁnV uo 22

Bias in methylation GSA

 

Table 2. Top 10 GO BP categories for uncorrected GSA on the UC dataset

 

 

GOBPID Count Expected count P-value Term

GO:0003002 14 4.23 8.52 x 10‘05 Regionalization

GO:0048562 11 2.79 1.04 x 10‘04 Embryonic organ morphogenesis
GO:0009790 25 11.30 1.57 x 10‘04 Embryonic development
GO:0009952 11 3.06 2.37 x 10‘04 Anterior/posterior pattern formation
GO:0048568 11 3.59 9.44 x 10‘04 Embryonic organ development
GO:0007389 14 5.43 1.10 x 10‘03 Pattern speciﬁcation process
GO:0048598 15 6.38 1.86 x 10‘03 Embryonic morphogenesis
GO:0009887 21 11.03 3.45 x 10‘03 Organ morphogenesis
GO:0016055 10 3.67 3.73 x 10‘03 Wnt receptor signaling pathway
GO:0031589 8 2.54 3.90 x 10‘03 Cell-substrate adhesion

 

Table 3. GO BP categories with FDR<0.05 from a GSA corrected using GOseq on the lung cancer dataset

 

 

GOBPID Count Expected count P-value FDR Term

GO:0048562 15 3.38 1.67 x 10‘06 4.90 x 10‘04 Embryonic organ morphogenesis
GO:0048568 17 4.14 4.21 x 10‘06 6.16 x 10‘04 Embryonic organ development
GO:0003002 15 4.49 4.40 X IOTOS 3.63 X IOTO3 Regionalization

GO:0009887 25 10.38 6.00 x 10‘05 3.63 x 10‘03 Organ morphogenesis

GO:0048598 21 6.27 6.20 x 10‘05 3.63 x 10‘03 Embryonic morphogenesis
GO:0009790 25 11.01 1.18 x 10‘04 5.40 x 10‘03 Embryonic development
GO:0007423 13 3.86 1.29 x 10‘04 5.40 x 10‘03 Sensory organ development
GO:0007389 19 5.31 2.81 x 10‘04 1.03 x 10‘02 Pattern speciﬁcation process
GO:0009952 11 3.39 5.06 x 10‘04 1.65 x 10‘02 Anterior/posterior pattern formation

 

2.7 Validation of bias-corrected GSA by comparison with
label permutation

Several authors have previously suggested correcting the results
of GSA using sample label permutations (Barry et al., 2005;
Efron and Tibshirani, 2007). For example, the popular tool
GSEA (Subramanian et al., 2005) uses this approach. In many
cases (for example, the lung cancer study discussed earlier in the
text), this is not possible, and in many other cases, it may be
highly computationally intensive, there may be a limited number
of samples (meaning that it will be impossible to achieve statis-
tical signiﬁcance), or it may be difﬁcult because of the complexity
of the analysis pipelines sometimes applied to methylation data-
sets. However, in the case of our UC dataset, it is straightfor-
ward. Thus, we used this dataset to compare the results of the
GOseq-corrected GSA method to the results obtained from
sample label permutations.

Applying an uncorrected GSA to the UC dataset identiﬁes
many highly signiﬁcant gene sets (Table 2). After correction
using sample label permutations, 19 gene sets were identiﬁed
with P<0.05 (Table 4). GSA corrected by GOseq identiﬁed 12
gene sets (Table 5; Supplementary Fig. S3) compared with 262
when using an uncorrected approach (suggesting that a large
proportion of the results from the original analysis were arti-
facts). Of the 12 gene sets identiﬁed using the corrected GSA,
11 were also identiﬁed by label permutation. The similarity to the

results of a robust permutation-based approach provides good
evidence that the corrected GSA performs well and is a suitable
method of accounting for bias in methylation data. By compari-
son, only 12 of the 19 gene sets identiﬁed using label permutation
were detected using the uncorrected GSA, despite an order of
magnitude more processes reported signiﬁcant in the latter ana-
lysis. When a corrected analysis is applied, results in the UC
dataset are not signiﬁcant after correction for multiple testing.
Where label permutation is possible (e. g. in the UC experimental
design), it can be used to perform GSA in a way that is robust to
the differences in the number of probes per gene. However, it is
likely that GOseq provides better power to detect gene sets that
are enriched for differentially methylated genes, as the statistical
signiﬁcance that can be achieved by a permutation method can
be limited because of the relatively small sample sizes that are
often encountered in genome-wide methylation experiments.

In the previous section, we showed that the results of an un-
corrected GSA applied to the lung cancer and UC datasets were
similar, a result that could potentially provide insight into UC-
associated carcinogenesis. However, when we corrected for the
number of probes per gene, the Pearson correlation between the
P-values in the UC and lung cancer datasets is dramatically
lower than for the uncorrected results (r: 0.17, compared with
r : 0.69), suggesting that the similar results were largely
artifactual.

 

112 /810's112umofp101x0'soi112u1101u101qﬂ2d11q 111011 pep1201umoq

910K ‘09 tsnﬁnV uo 22

P. Geeleher et al.

 

3 CONCLUSIONS

In general, when different genes and gene sets are associated with
different a priori probabilities of appearing in the foreground list
as a consequence of factors other than those that are of biolo-
gical interest there is the potential for bias. This arises in many
GSA applications. It is common in GSA to associate multiple
and different numbers of features with each gene; typically, mul-
tiple features are collapsed onto single-gene identiﬁers. For in-
stance, the popular web-based GSA tool, DAVID (Huang et al.,
2009a, b) offers the option to use microarray probe IDs (e.g.
from methylation or gene expression arrays) as foreground and
background lists. These are converted to unique gene IDs before
statistical analysis. When there is a difference in the number of
probes associated with each gene, this can give rise to the bias
that we have outlined. In this article, we have demonstrated that
this causes severely biased results when GSA is applied to high-
throughput methylation data, typically leading to false-positive
results for gene sets related to development, differentiation and
transcription. This bias can be corrected by applying a GSA

Table 4. Top 10 GO BPs from a GSA corrected using label permutation
(UC dataset)

 

GOBPID Count P-value Term

 

GO:0009952 11 7.94 x 10‘03 Anterior/posterior pattern
formation

7.94 x 10‘03 Lipid biosynthetic process

7.94 x 10‘03 Lipid metabolic process

1.59 x 10‘02 Cell-substrate adhesion

2.38 x 10‘02 Positive regulation of catalytic
activity

2.38 x 10‘02 Cellular lipid metabolic process

3.17 x 10‘02 Regionalization

3.17 x 10‘02 Wnt receptor signaling pathway

3.17 x 10‘02 Phospholipid metabolic process

3.17 x 10‘02 Organophosphate metabolic
process

3.17 x 10‘02 Cellular cation homeostasis

GO:0008610 12
GO:0006629 20
GO:0031589 8
GO:0043085 17

GO:0044255 14
GO:0003002 14
GO:0016055 10
GO:0006644 7
GO:0019637 7

GO:0030003 8

 

method, such as GOseq, that models the relationship between
the number of features (e.g. CpG probes in the case of micro-
arrays or CpG sites in the case of high-throughput sequencing)
associated with a gene and its probability of appearing in the
foreground list, or where applicable, by using sample label
permutations.

4 METHODS

4.1 Gene-set analysis using label permutation

Sample labels were rearranged in all possible combinations. As there were
a total of 10 samples, split equally between UC and control phenotypes,
this yielded 126 distinct arrangements of the samples. For each of these
arrangements, the enrichment odds ratio test statistic was re-calculated
for each gene set, using the same pipeline as the original analysis and
selecting the same number of hypermethylated genes (so that the GSA is
comparable between the observed and permuted data). P-values were
calculated as the proportion of the test statistics that were as extreme,
or more extreme, than the test statistic corresponding to the observed
data.

4.2 UC microarray data

MeDIP was performed to capture methylated DNA sequence as previ-
ously described by Weber et al. with slight modiﬁcations. Brieﬂy, 10 ug of
5-methylcytosine antibody was incubated with 50 ul of Dynabeads M-28
Sheep anti-mouse IgG for 5h in immunoprecipitate (1P) buffer at 4° C.
Genomic DNA was sonicated using the Branson digital soniﬁer, and 4 ug
of genomic DNA was incubated with the antibody-beads complex over-
night at 4°C. Then, the DNA-antibody-dynabeads complex was washed
three times with IP buffer and incubated with 5 ul of proteinase K for 2 h
at 55°C. In our experiment, we labeled the IP DNA with ﬂuorescent dye,
cyanine 3 and reference (R) DNA with cyanine 5 and co-hybridized to the
Agilent microarrays. The MeDIP followed by CpG island microarray
analysis enables us to identify the methylated and unmethylated CpG
islands between long-standing UC patients and age-matched control pa-
tients. Puriﬁcation of labeled products, array hybridization and scanning
were performed at the functional genomics and high-throughput screen-
ing facility at the National Centre for Biomedical Engineering Science,
NUI Galway.

Data were quantile normalized and analyzed using the Bioconductor
library limma. Genes with at least one associated hypermethylated probe
in UC (P< 0.05) were selected for GSA. These data have been uploaded
to GEO and are available under accession number GSE39188.

Table 5. Top 10 GO BPs from a GSA corrected using GOseq on the UC dataset

 

 

GOBPID Count Expected count P-value Term

GO:0008610 12 5.39 7.70 x 10‘03 Lipid biosynthetic process
GO:0031589 8 3.27 1.38 x 10‘02 Cell-substrate adhesion

GO:0006644 7 2.82 2.41 x 10‘02 Phospholipid metabolic process
GO:0019637 7 2.96 2.95 x 10‘02 Organophosphate metabolic process
GO:0043085 16 9.88 3.59 x 10‘02 Positive regulation of catalytic activity
GO:0048562 11 6.07 3.70 x 10‘02 Embryonic organ morphogenesis
GO:0044087 7 3.28 4.00 x 10‘02 Regulation of cellular component biogenesis
GO:0016053 6 2.56 4.02 x 10‘02 Organic acid biosynthetic process
GO:0046394 6 2.56 4.02 x 10‘02 Carboxylic acid biosynthetic process
GO:0006629 20 13.12 4.29 x 10‘02 Lipid metabolic process

 

 

112 /810's112umofp101x0'soi112u1101u101qﬂ2d11q 111011 pep1201umoq

910K ‘09 tsnﬁnV uo 22

Bias in methylation GSA

 

ACKNOWLEDGEMENT

The authors thank Dr John Newell for advice on statistical
analysis.

Funding: P.G. was supported by the Irish Research Council for
Science, Engineering and Technology (IRCSET) Embark
Initiative’s Enterprise Partnership Scheme. CS. is supported by
Science Foundation Ireland (07/SK/M1211b).

Conflict of Interest: none declared.

REFERENCES

Ashbumer,M. et al. (2000) Gene ontology: tool for the uniﬁcation of biology. the
gene ontology consortium. Nat Genet, 25, 25—29.

Barry,W. et al. (2005) Signiﬁcance analysis of functional categories in gene expres-
sion studies: a structured permutation approach. Bioinformatics, 21, 1943—1949.

Bell,J. et al. (2011) DNA methylation patterns associate with genetic and gene
expression variation in HapMap cell lines. Genome Biol., 12, R10.

Booth,M.J. et al. (2012) Quantitative sequencing of 5-methylcytosine and 5-hydro-
xymethylcytosine at single-base resolution. Science, 336, 934—937.

Claus,R. et al. (2012) Quantitative DNA methylation analysis identiﬁes a single
CpG dinucleotide important for ZAP-70 expression and predictive of prognosis
in chronic lymphocytic leukemia. J. Clin. Oncol., 30, 2483—2491.

Deng,G. et al. (1999) Methylation of CpG in a small region of the hMLHl pro-
moter invariably correlates with the absence of gene expression. Cancer Res., 59,
2029—2033.

Deng,J. et al. (2009) Targeted bisulﬁte sequencing reveals changes in DNA methy-
lation associated with nuclear reprogramming. Nat Biotechnol., 27, 353—360.

Doi,A. et al. (2009) Differential methylation of tissue- and cancer-speciﬁc CpG
island shores distinguishes human induced pluripotent stem cells, embryonic
stem cells and ﬁbroblasts. Nat Genet, 41, 1350—1353.

Dunwell,T. et al. (2010) A genome-wide screen identiﬁes frequently methylated
genes in haematological and epithelial cancers. Mol. Cancer, 9, 44.

Eaden,J. et al. (2001) The risk of colorectal cancer in ulcerative colitis: a meta-
analysis. Gut, 48, 526—535.

Efron,B. and Tibshirani,R. (2007) On testing the signiﬁcance of sets of genes. Ann.
Appl. Stat, 1, 107—129.

Elango,N. et al. (2009) DNA methylation is widespread and associated with differ-
ential gene expression in castes of the honeybee, Apis mellifera. Proc. Natl Acad.
Sci. USA, 106, 11206—11211.

Falcon,S. and Gentleman,R. (2007) Using gostats to test gene lists for go term
association. Bioinformatics, 23, 257—258.

Helman,E. et al. (2012) DNA hypermethylation in lung cancer is targeted at differ-
entiation-associated genes. Oncogene, 31, 1181—1188.

Huang,D.W. et al. (2009a) Bioinformatics enrichment tools: paths toward the com-
prehensive functional analysis of large gene lists. Nucleic Acids Res., 37, 1—13.

Huang,D.W. et al. (2009b) Systematic and integrative analysis of large gene lists
using david bioinforrnatics resources. Nat Protoc., 4, 44—57.

Irizarry,R.A. et al. (2009) The human colon cancer methylome shows similar hypo-
and hypermethylation at conserved tissue-speciﬁc CpG island shores. Nat
Genet, 41, 178—186.

Kalari,S. et al. (2012) The DNA methylation landscape of small cell lung cancer
suggests a differentiation defect of neuroendocrine cells. Oncogene [Epub ahead
of print, doi: 10.1038/onc.2012.362, August 20, 2012].

Kanehisa,M. and Goto,S. (2000) KEGG: kyoto encyclopedia of genes and gen-
omes. Nucleic Acids Res, 28, 27—30.

Liu,J. et al. (2010) A study of the inﬂuence of sex on genome wide methylation.
PLoS One, 5, 610028.

McLean,C.Y. et al. (2010) Great improves functional interpretation of cis-regula-
tory regions. Nat Biotechnol., 28, 495—501.

Mohn,F. et al. (2009) Methylated DNA immunoprecipitation (medip). Methods
Mol. Biol., 507, 55—64.

Oda,M. et al. (2009) High-resolution genome-wide cytosine methylation proﬁling
with simultaneous copy number analysis and optimization for limited cell num-
bers. Nucleic Acids Res, 37, 3829—3839.

Oshlack,A. and Wakeﬁeld,M.J. (2009) Transcript length bias in RNA-seq data
confounds systems biology. Biol. Direct, 4, 14.

Rauch,T.A. et al. (2008) High-resolution mapping of DNA hypermethylation and
hypomethylation in lung cancer. Proc. Natl Acad. Sci. USA, 105, 252—257.
Schroeder,D.I. et al. (2011) Large-scale methylation domains mark a functional

subset of neuronally expressed genes. Genome Res., 21, 1583—1591.

Sen,G.L. et al. (2010) DNMTI maintains progenitor function in self-renewing
somatic tissue. Nature, 463, 563—567.

Smyth,G.K. (2005) Limma: Linear Models for Microarray Data. Springer,
New York, pp. 397—420.

Sohn,B.H. et al. (2010) Functional switching of TGF-betal signaling in liver cancer
via epigenetic modulation of a single CpG site in TTP promoter.
Gastroenterology, 138, 1898—1908.

Sproul,D. et al. (2012) Tissue of origin determines cancer-associated CpG island
promoter hypermethylation patterns. Genome Biol., 13, R84.

Subramanian,A. et al. (2005) Gene set enrichment analysis: a knowledge-based ap-
proach for interpreting genome-wide expression proﬁles. Proc. Natl Acad. Sci.
USA, 102, 15545—15550.

Takeshima,H. et al. (2009) The presence of RNA polymerase II, active or
stalled, predicts epigenetic fate of promoter CpG islands. Genome Res., 19,
1974—1982.

Weber,M. et al. (2005) Chromosome-wide and promoter-speciﬁc analyses identify
sites of differential DNA methylation in normal and transformed human cells.
Nat Genet, 37, 853—862.

Young,M.D. et al. (2010) Gene ontology analysis for RNA-seq: accounting for
selection bias. Genome Biol., 11, R14.

Zhu,J.G. et al. (2012) Differential DNA methylation status between human prea-
dipocytes and mature adipocytes. Cell Biochem. Biophys., 63, 1—15.

Zou,B. et al. (2006) Correlation between the single-site CpG methylation and ex-
pression silencing of the XAFl gene in human gastric and colon cancers.
Gastroenterology, 131, 1835—1843.

 

112 /810's112umofp101x0'sot112u1101utotq/ﬁd11q 111011 pep1201umoq

910K ‘09 tsnﬁnV uo 22

