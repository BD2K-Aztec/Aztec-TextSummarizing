Bioinformatics, 31 (24), 2015, 3890—3896

doi: 10.1093/bioinformatics/btv496

Advance Access Publication Date: 30 August 2015
Original Paper

 

Genome analysis

A hybrid bayesian approach for genome-wide
association studies on related individuals

A. Yazdani1'* and D. B. Dunson2

1Human Genetic Center, University of Texas at Houston Health Science Center, Houston, USA and 2Department of
Statistical Science, Duke University, Durham, North Carolina USA

*To whom correspondence should be addressed.
Associate Editor: John Hancock

Received on April 14, 2015; revised on August 15, 2015; accepted on August 18, 2015

Abstract

Motivation: Both single marker and simultaneous analysis face challenges in GWAS due to the
large number of markers genotyped for a small number of subjects. This large p small n problem is
particularly challenging when the trait under investigation has low heritability.

Method: In this article, we propose a two—stage approach that is a hybrid method of single and sim—
ultaneous analysis designed to improve genomic prediction of complex traits. In the first stage, we
use a Bayesian independent screening method to select the most promising SNPs. In the second
stage, we rely on a hierarchical model to analyze the joint impact of the selected markers. The
model is designed to take into account familial dependence in the different subjects, while using
local—global shrinkage priors on the marker effects.

Results: We evaluate the performance in simulation studies, and consider an application to animal
breeding data. The illustrative data analysis reveals an encouraging result in terms of prediction

 

performance and computational cost.
Contact: Akram.Yazdani@uth.tmc.edu

Supplementary information: Supplementary data are available at Bioinformatics online.

 

1 Introduction

Genome—wide association studies (GWAS) have been widely con—
ducted in humans with the goal of identifying genetic factors pre—
dictive of disease. GWAS chips collect data on single nucleotide
polymorphisms (SNPs) across the genome, focusing on common
variants in which the minor allele frequency is at least 5%. The
dominant focus in GWAS has been on independent screening meth—
ods, which consider the association between disease and each SNP
separately while adjusting for false discoveries. This strategy tends
to produce a small number of SNPs having modest effect sizes, fail—
ing to explain a substantial proportion of the known heritability in
disease. Given the size of the multiple testing problems in which the
number of SNPs (p) is dramatically larger than the number of indi-
viduals under study (11), it is not surprising that independent screen—
ing has failed to identify much signal in the data. As the identified
SNPs typically eXplain a small proportion of the variability in the
phenotype, GWAS has been unsuccessful at producing accurate

predictive models in humans (see, e.g. Buckler et 61]., 2009; Hoggart,
2008; Diabetes Genetics Initiative of Broad Institute of Harvard
et 61]., 2007; Wellcome Trust Case Control Consortium, 2007;
Weedon et 61]., 2008).

Dramatic reduction in cost has driven the increased use
of GWAS beyond humans to animal breeding studies. In animal
breeding a major focus is on prediction of genetic merit (breeding
value) when the pedigree structure is taken into account. Based on
predictions early in life, animals having a high probability of de-
veloping desired traits will be differentially selected. When the focus
is on prediction of traits instead of identification of the top individ—
ual variants, it has been suggested that all markers should be
included instead of attempting variable selection (Meuwissen et 61].,
2001)

Because in GWAS the number of SNPs exceeds the number of
samples, simultaneous analysis requires using penalized or shrinkage
approaches. The most popular approach is the Lasso (Tibshirani,

©The Author 2015. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com 3890

9mg ‘09 1sn3nv uo sopﬁuv s01 ‘ETUJOJTIBQ aIo Amie/xtqu 112 /§.IO'S[BU.IHO[p.IOJXO'SOTlBIHJOJUTOTQ/ﬁ(1111] 11101; popeommoq

A Hybrid Bayesian Approach for G WAS

3891

 

1996), which includes an L1 penalty on the coefficients to induce
simultaneous variable selection and shrinkage. However, a rich var—
iety of alternative penalties have been proposed (Fan and Li, 2001;
Zhang, 2010; Zou and Hastie, 2005) to provide desirable shrinkage
behavior. Most of the point penalization estimates of marker effects
correspond with the mode of a posterior distribution obtained under
shrinkage priors. These priors typically can be expressed as local—
global scale mixtures of normal distributions (see, e.g. Armagan et
61]., 2013; Carvalho et 61]., 2009; Griffin and Brown, 2011; Park and
Casella, 2008). Carefully designed priors in this class shrink small
signals towards zero while limiting shrinkage of larger signals.
Compared with variable selection, such methods have computa—
tional advantages (avoid an intractable search over all possible sub—
sets) and better accommodate lots of small but non—zero
coefficients. In Bayesian analyses of animal breeding, it has been
common to rely on mixture priors that include a mass at zero for
zero coefficients (see, e.g. Gianola et 61]., 2009). Such priors are tabu—
lated in Supplementary Appendix A, Table 1.

Although the aforementioned simultaneous approaches have
been applied to 1) >> 11 problems, there are some clear limitations in
scaling computation to very large p, as well as issues in obtaining re—
liable results when n is too small relative to p. In sparse signal pro—
cessing problems involving large p small 11 linear regression, it has
been discovered that there is often a phase transition that depends
on the relative values of n and p and the true sparsity level. When n
is too small, so that one is on the wrong side of the phase transition,
results are very unreliable. Such transitions have been characterized
only in idealized cases, making assumptions on the design matrix
that are not appropriate in genomic studies due to strong correl—
ations that arise given the linkage disequilibrium (LD) structure. We
hope to push back the phase transition by using a carefully struc—
tured Bayesian approach.

To combat the computational intractability of variable selection
in massive dimensions, multistage approaches are recommended
(see, e.g. Beattie et 61]., 2002; Fan and LV, 2008; Huanga et 61].,
2010; Li et al., 2011; Paul at al., 2008; Shariati et al., 2012). For
family based studies, Kessler et al. (2014) proposed two—stage
screening based on a Bayesian non—parametric regression model.
Here, we instead propose a two—stage approach for a polygenic
mixed model to predict phenotypic variation in the trait of interest
from genomic information for data collected on genetically related
individuals. In the first stage, we apply a Bayesian independent
screening method, which takes into account familial dependence
while examining SNPs one at a time. This Bayesian screening
method has better performance than competitors in our experience,
and is expected to select a superset of the important predictors (Ball,
2011; Stephens and Balding, 2009). In the second stage, we imple—
ment a Bayesian hierarchical model to control the level of sparsity
and amount of shrinkage relative to the size of signals. We use the
generalized double Pareto (GDP) prior (Armagan et 61]., 2013)
within a polygenic mixed model, extending previous implementa—
tions of the GDP to problems in which the samples are related. We
evaluate the predictive performance and computational efficiency of
the proposed approach called two—stage—GDP by conducting a simu—
lation and real data analysis.

2 Model

The overwhelming majority of the literature on analysis of GWAS
data focuses on unrelated individuals, while our interest is in animal
breeding data from pedigrees. It is important to take the familial de—
pendence structure into account in the analysis to avoid finding

spurious associations (see for e.g. Kang et 61]., 2010). A common
model—based approach to incorporate familial dependence is ran-
dom effects modeling. In particular, we let

y=X ﬂ+u+e, eNN(0,t_1R). (1)

Here, y is an n vector of a quantitative trait measured on 11 subjects
(animals), ﬂ is a p vector of additive genetic effects and X is an n X p
matrix of genotypes measured at genetic markers, such that each
SNP is coded as

2 if the genotype of the SNP is BB
1 if the genotype of the SNP is Bb
0 if the genotype of the SNP is bb,

where B represents the allele with lower frequency. In model (1), R
is an n x 11 diagonal matrix accommodating heterogenous residual
variance, which is estimated in a preliminary data preprocessing
step, and u is an 11 random vector such that

u N N(0, 1,7110,

where K is an n x n relatedness matrix. Entries of K are in (0, 1) and
correspond to the degree of relationship between pairs of subjects,
ranging from 0 for unrelated individuals to 1 for self-kinship. This
matrix is calculated based on the pedigree measuring genetic similar-
ity between subjects as Z], (.5 )L(b), with the sum being over all paths
Io connecting two subjects with unique common ancestors and L(/o)
is the length of path 19. If the pedigree is incomplete or not available,
K can be estimated based on genotype data (see for e.g. Oliehoek et
aL,2006)

2.1 First—stage

In this stage, we select a set of promising SNPs by testing the ef—
fect of each marker individually. By far the most common approach
used in the literature relies on independent testing for association be—
tween each SNP and the phenotype using frequentist methods.
This produces P—values for each SNP, and the set of significant SNPs
can be obtained by choosing a small threshold on these P—values.
This threshold is often chosen to maintain a desired false discovery
rate (FDR). We instead rely on Bayes factors (BFs) measuring
the weight of evidence in the data against the local null hypothesis
H0,- of no association between a given SNP and the phenotype. In
this initial screening stage, we rely on Bayes factors in favor of the
model with only the jth SNP included against the global null model
that has no SNPs included. These BFs can be defined under model
(1) as

ij(Y7u|H1/'a 01))“(01jIH1,-) du d611,-
BF,- 2

 

ij(Yau)H0/'a 00))7I(00,'|Ho,-) du d610,-

where 0k,- : (kﬂi, 1,1“) is the set of parameters under H k,- for
k E {0,1}, 7t(0k,-|Hk,-) is its prior density, and f(y,u|Hk,-, Bki) is the
probability density of (y, u) given 0k).

The separate analysis of each SNPs makes it appropriate to spe—
cify the usual conjugate prior on the set of parameters 0k). In particu—
lar, we consider

ﬂi|t N N(0,‘E_1),j : 1,  ,p,

‘E N Gamma(a1, b1), 1,, N Gamma(az, (92).

9mg ‘09 1sn3nv uo sojoﬁuv s01 ‘BTUJOJTIBD aIo Amie/xtqu 112 /§.IO'S[BU.IHO[p.IOJXO'SOTlBIHJOJUTOTQ/ﬁ(1111] 11101; popeommoq

3892

A. Yazdani and D. B.Dunson

 

To calculate the BF,-s, we first integrate out the parameters ﬂjs and
the random effects 11 and obtain

 

 

balbaz A K —1/2
J J (270-11/2 1 2 Tal—lraZ—l _k _
r I“ FWUFWZ) u T Tu
1 A K ‘1
><exp(—tb1 — tub2)exp [ EyT (7k + T—> y drudt,

 

where Ak : R —l— [€(XI'XIT) corresponding to H k,- for la : 0, 1 in the de—
nominator and numerator, respectively. These integrals are analytic—
ally intractable. Hence, we approximate the integrals by applying
Laplace transformation. To avoid having the mode on the boundary
due to the constraints ‘5 > 0 and Tu > 0, the precision parameters are
reparameterized with log transformation.

The calculated BFl-s provide a list of ranked SNPs for select—
ing the most promising markers. In the screening stage, our goal is
to reduce the number of SNPs under consideration to a manageable
number, while erring on the side of including too many SNPs.
Usual thresholds on BFs, such as the common value of 10 recom—
mended in (Jeffreys, 1961), are too small due to the massive mul—
tiple comparisons problem. On the other hand, thresholds that
are fully adjusted for multiple comparisons, such as those recom—
mended by Ball (2011) and Stephens and Balding (2009), will tend
to select too few SNPs. Motivated by our goal of building a model
for prediction, we instead rely on cross validation for threshold
choice.

2.2 Second—stage

In this stage, we simultaneously include all SNPs selected in the first
stage, while incorporating a shrinkage prior on their coefficients. In
building a predictive model, it is necessary to characterize the simul—
taneous impact of the different SNPs on the phenotype. We find that
including the first stage instead of incorporating all the SNPs in the
simultaneous analysis improves performance in two respects. The
first is a considerable computational speedup as the number of SNPs
grows. The second is an improvement in accuracy of the resulting
predictive model. This second improvement is due to the fact that
most shrinkage priors are insufficiently flexible to handle truly mas—
sive—dimensional predictors that are not highly sparse in their effects.
Shrinkage priors are designed to have separate parameters control—
ling concentration around zero and tail heaviness, but such control
is insufficient in GWAS.

In the second stage, model (1) is rewritten as

y=Xﬁ+u+a é~Nmn*m, (a

where vector 8 represents the effects of 1), selected SNPs and X is the
corresponding design matrix.

2.2.1 Prior specification
We incorporate a local—global shrinkage prior into polygenic mixed
model (3) as

ﬁ~NmJ4%L (e

where 2,} : diag{nl-}. The variance of each coefficient, 87-, includes
two parameters, ‘5 and 17,-, representing global and local shrinkage ef—
fects, respectively. In GWAS settings, 1‘1 is expected to be close to
zero, corresponding to a high degree of overall shrinkage to stabilize
estimation and incorporate the expectation that most coefficients
are close to zero. To avoid over—shrinkage of the most influential
SNPs, the prior on 17,- is designed to have heavy tails. To obtain a

ﬂexible prior with the desired behavior, which also leads to compu—
tational advantages, we let

’7) N eXP(§,-2/2)-

Instead of presetting values for @s, it is appealing to assign a prior
distribution to these parameters as

f,- N Gamma(c, d),

which induces a heavy—tailed marginal on 17,-.

The above hierarchical shrinkage prior on the SNP coefficients
corresponds to a representation of the GDP introduced by Armagan
et al. (2013). To complete a specification of the prior, the precision
parameters ‘5 and 1,, are given gamma priors as in (2). The GDP has
substantial advantages over simpler shrinkage priors, such as ridge
and Bayesian Lasso, in terms of limiting over-shrinkage of the larger
coefficients.

2.2.2 Posterior interpretation
Under the proposed model, the total phenotypic variance for the
trait can be decomposed as

P5 P5
Vy : Z 203% “WWW/7) + 51—1 + Surf, (5)
i=1 {/21
where s and 5,, are the mean of diagonal elements in R and K, re-
spectively; i.e. s : £22121 1'),- and 5,, : £22121 13,-,- where 17,- and 13,-,- are
the ijth elements of matrices R and K. In the case that K is calculated
from a pedigree, 5,, is one. The proportion of the phenotypic vari—
ance explained by total genetic variance is called heritability,
denoted by 192. As is clear from (5), [92 accounts for the covariance
between markers as well. If we ignore the contribution from the co—
variance (Cai et al., 2011), the proportion of the phenotypic vari-
ance explained by each marker is approximately

2 _ ﬂivarﬁi)
lo]- —  (6)

By relying on MCMC samples from the posterior for the parameters
in our model, we can obtain posterior summaries for both total her—
itability 192 and individual [of-2 contributions.

2.2.3 MCMC algorithm

The joint posterior distribution is

“(0711:1717  7171757517  afpsararu)Y) QC  ‘)
17. ~
><H7I(/3,-|17,-,I)7I(m|fi)7r(€;|6ad)
i=1

><7'E(u|‘Eu)TE(T|a1,b1)7‘£(‘€u|az,b2),

where 1t(y|.) is the probability density of y given all parameters in
the model. From this joint posterior, we obtained full conditional
posterior densities for Gibbs sampling as

E)Y7uarN MALE?

ulyaiinnu ~ N(ﬂ{iazﬁ),

t|y, if, u, y, 2,} N Gamma(a(1’, (911)),
tu|u N Gamma(az + 11/2, uTK_1u + b2),
57-min N Gamma(c —l— 1, tl/Zmlj —l— d),
2 1/2

~ 5,
ni—llﬂi, if, ‘E N IN — Gaussian ~72 751.2
W

i

 

9mg ‘09 1sn3nv uo sojoﬁuv s01 ‘BTUJOJTIBD aIo Amie/gun 112 /§.IO'S[BU.IHO[p.IOJXO'SOTlBIHJOJUTOTQ/ﬁ(1111] 11101; popeommoq

A Hybrid Bayesian Approach for G WAS

3893

 

where
a; = (RTE-1X + 2,;1>—1>”<TR-1<y — u).
it: = We + rR-1>‘1R-1<y — xi).
2% = r—1(xTR—1x + 2;)4,

_ _ —1
252(K 1t,,—l—tR 1) ,

 

qunZPS‘l—ala
1 ~~ _ ~~ ~T —~
bl:§((y—Xﬁ—U)TR1(Y—Xﬁ—“)+/’ 211mm-

Gibbs sampling alternates sampling from these simple conditional
distributions, with the draws converging to samples from the joint
posterior. From these samples, posterior summaries for any mar-
ginal of interest can be calculated; e.g. the posterior mean provides
the optimal point estimate under squared error loss.

3 Simulation study

To evaluate the prediction performance of two—stage—GDP, we con—
ducted a simulation study. We first generated a pedigree based on a
non-random mating scheme using the R package synbreed. This
pedigree structure was then utilized in simuPOP (Peng and Amos,
2008), which generated genotype data for each individual taking
into account their relatedness. To mimic our motivating real data,
we selected the subset of individuals having the same gender for ana-
lysis. We then applied Rpackage kinship2 to calculate the related—
ness matrix based on the pedigree.
We considered four different scenarios for the effect sizes:

Model-1: 300 SNPs with non—zero regression coefﬁcients generated
from U(—1, 1) for 100 individuals with 300 SNPs in total.

Model-2: 500 SNPs with non—zero regression coefﬁcients generated
from U(—1, 1) for 100 individuals with 500 SNPs in total.

Model-3: 100 SNPs with non—zero regression coefﬁcients generated
from U(1, 1.5)and U(—1.5,—1) for 200 individuals with 2000
SNPs in total.

Model-4: 400 SNPs with non—zero regression coefﬁcients generated
from U(1, 1.5)and U(—1.5,—1) for 200 individuals with 4000
SNPs in total.

The first two models are designed for dense problems in which
most of the predictors have small effects on the complex trait. The
last two models are designed for sparse problems with different level
of sparsity. We used cross validation (CV) to assess performance.
CV is intrinsically a frequentist idea, but has become routinely used
in assessing the frequentist operating characteristics of Bayesian
methods (Ghosh et al., 2007). For each scenario, we generated 20
datasets as training sets and 20 as validation sets. Evaluation is
based on mean square prediction errors, MSPEs and correlations be—
tween observed values and predictive values. The predictions of fu—
ture values are obtained from

E (yflxmo) = X) E my.) + K),ng E (nova),

l::l~N(lSlaru1 )-

Index f and 0 denote the future data and observed data, respectively.

where
I(0,0 Kof
Kno Krr

 

 

To evaluate the predictive performance of the model and its

computational efficiency, we made a comparison between two—
stage—GDP and the widely applied method, SSVS, as well as some
well-known shrinkage priors on 8/- including Bayesian Lasso,
Student—t and one—stage GDP.

SSVS places a mixture of two normals on 8/- as (1 — 1),)
N(0,  —l— ViN(0,Cl-2Vi2), where y,- E {0,1}. Bayesian Lasso (BL) as—
signs a double—exponential prior to 17,- in (4) as 17/- N exp(f2 / 2), with
52 / 2 N Gamma(c’, d’) following Park and Casella (2008). The stu—
dent—t can be expressed as a scale mixture of normal distributions
8 N N(0, 23), with EB : diag{nl-} and 17,- N Inv—gamma(c”, d”).

To set the hyperparameters for SSVS, we let (VI-2, Gill/i2) :
(001,10), with [)(yl- : 1) = 0.5 in Model-1 and Model-2 and to 0.1
in Model-3 and Model-4. In BL, the posterior is relatively insensitive
to the prior on 52 as long as c’ and d] are small (Park and Casella,
2008), and we set these hyperparameters to 0.1. For the student—t
prior, we fixed 6” = 3 as a small value greater than 2 as suggested by
Fruhwirth—Schnatter and Wagner (2011). We considered different
values for d” as 0.001; 0.01; 0.1 and found 0.01 as the best choice.
For GDP hyperparameters, we considered d : x/c—P—l, since this
choice ensures the continuity property and creates a trade—off be—
tween sparsity and tail—robustness. We increased 6 from 1 in Model-
1 and Model-2 to 3 in Model-3 and Model-4 in order to allow more
shrinkage for sparse models. We sent hyperparameters of ‘E and 1,,
equal to 10—3 .

Table 1 represents the average MSPEs of 20 simulated validation
subsets for each model. The index numbers are the average of stand—
ard errors of MSPEs across 200 bootstrap samples of 20 standard
errors. The correlation between predicted and observed values in
validation sets are also represented in the table. The correlation
gives insight into the accuracy of performance comparing different
shrinkage approaches.

Table 1 shows that the t—prior performs better than the other
approaches in dense problems, Model-1 and Model-2. For the sparse
cases, Model-3 and Model-4, two—stage—GDP outperforms the other
competitors. Although in Model-3 two—stage—GDP is slightly better
than SSVS, by increasing the sparsity level in Model-4, two—stage—
GDP shows noticeably better predictive performance. In addition,
its computational cost makes feasible the use of two—stage—GDP in
GWAS.

The effect of sparsity level on prediction performance is pre—
sented in Figure 1. The figure shows mean of correlation between
observed values and predicted values in 20 validation sets versus
number of predictors in the model, while the number of predictors
with non—zero effects in the model is 100 and n = 100. The perform-
ance of one—stage approaches are highly related to the p/n ratio. The
correlations among observed values and predicted values are less
than 0.7 for p22000. The computational time of these
approaches versus the number of predictors in the model is pre-
sented in Figure 2 . Our programming code for t-priors, BL, GDP
and two—stage—GDP is based on C—l——l— in order to speed up the
MCMC algorithm. The SSVS implemented in JAGS is also based on
C—l——l— programming.

Figures 1 and 2 represent one line corresponding to t—prior, BL
and GDP since they almost have the same performance or running
time with comparison to SSVS and two—stage—GDP. This line that is
depicted using the average point of t—prior, BL and GDP quantities,
provides better visualization for the comparison.

Available packages using frequentist approaches for linear mixed
model with p > n are restricted to specific cases, such as group struc—
ture. As those packages do not allow general linear mixed effect
structure, such as that induced by familial dependence, we could not
provide comparison with frequentist approaches.

91% ‘09 1sn3nv uo sojoﬁuv s01 ‘1211110111123 310 Amie/gun 112 /§.IO'S[BU.IHO[p.IOJXO'SOTmIHJOJUTOTQﬂIdllq 11101; pop1201umoq

3894

A. Yazdani and D. B.Dunson

 

Table 1. Average of MSPEs and average of correlation between
predicted and observed values over 20 validation sets for SSVS,
t—priors, BL, GDP and Two-stage-GDP

 

Model SSVS t—prior BL GDP Two—stage—

GDP

 

1 MSPE 0.644(029) 0.616(035) 0692,03,) 0.691(036) 0.655(0380)
Cor 0.805 0.863 0.711 0.713 0.789

2 MSPE 0.604(_0277) 0.567(050) 0.7111041) 0.718(_035) 0.623(_037)
Cor 0.786 0.819 0.640 0.643 0.757

3 MSPE 0.5721018) 0.9231024) 0.7911029) 0.7421032) 0.526(_030)
Cor 0.884 0.631 0.742 0.780 0.9020

4 MSPE 0.9951019) 1.0451032) 0.9921035) 0.9351041) 0.610(_034)
Cor 0.544 0.501 0.511 0.567 0.827

 

EEL- GDP — t—priors I z-stage-GDP

1.0

 

g._--—---—II--|—________IIn a

Cnrrelatmn
0.0 0 E 0.0
|

0.2

 

 

 

0 2000 4000 0000 0000 10000
p

Fig. 1. Mean of correlation between observed values and predicted values
versus number of predictors in 20 validation sets while the number of pre-
dictors with nonzero effects in the model is 100 and n=100. Green line: t-
prior/BL/GDP and Red line: two-stage-GDP

- SSVS BL-GDP—r—priors - 2~stage-GDP

 

 

 

 

 

1::
a _
a:
(:1
D _
(I?
I1:
E
I:
(:1-
D _
‘El'
Eu
3 — ﬂuff-n
W a_—-—-""
0 of“
D EODD dﬂﬂﬂ 6000 8000 1UDDD
p

Fig. 2. Computational time versus the number of predictors or SNP in the
model where n=100. Blue line: SSVS, Green line: tprior/BL/GDP and Red
line: two-stage-GDP

4 Application to real data

We applied two—stage—GDP on a GWAS dataset from an animal
breeding study. The aim of study is to improve quantity and quality
of milk production through investigating milk protein yield. The
data contain 707, 962 SNPs genotyped for 607 Holstein Bulls. After
quality control, excluding SNPs with minor allele frequency below

5%, samples with low genotyping efficiency, and violating Hardy-
Weinberg Equilibrium test, the dataset contains 555, 651 SNPs. We
further reduced the dimensionality of the set of SNPs by considering
the fact that SNPs in the genome have groups of neighbors such that
they are all nearly perfectly correlated with each other. Hence, the
genotype of one SNP can perfectly predict those of correlated neigh—
boring SNPs; i.e. one SNP can thereby serve as proxy for many
others in the analysis. As the segments of SNPs in high linkage dis-
equilibrium in cattle is longer than human because of inbreeding, we
reduced the number of SNPs down to 135, 545 via a hierarchical
clustering approach. In this agglomerative clustering, we defined the
distance between two SNPs as 1 — r2, where r2, the square of correl—
ation between two SNPs, is 0.85.

After the preliminary analysis, we first evaluated the impact of
each SNP by BF and selected 878 top—ranking SNPs using the algo—
rithm in Supplementary Appendix B. In the second—stage, we first
ran a 5 —fold cross validation in order to set the hyperparameters. For
hyperparameters of marker effects, we considered 61 = m, since
this choice ensures the continuity property and creates a trade—off
between sparsity and tail—robustness (Armagan et 611., 2013). We ran
5—fold cross validation for different values of c: 1, 2.5, 3, 3.5.
Generally, the rate of shrinkage increases along this path. For the
other hyperparameters of the model, we set (a1,b1) : (az,b2) as
(0.001, 0.001), (0.01, 0.01), (0.1, 0.1), (0.3, 0.3). Table 2 pre-
sents average of MSPEs for different sets of hyperparameters for 5—
fold cross validation and the standard deviation from 50 bootstrap
samples in subscript. It shows 6: 3 and (41, b1) : (612, b2) : (0.01
, 0.01) provides smallest MSPE.

In addition, we considered two other prior specifications for the
second—stage analysis, t—priors and BL, in order to compare their pre-
dictive performance. The hyperparameters of t—priors and BL were
chosen the same as in the simulation study.

Table 3 represents average of MSPEs of 10—fold cross validation.
The index numbers are the average standard errors of MSPEs ob—
tained by averaging 100 bootstrap samples of 10 MSPEs. We also
calculated average of correlation between predicted and observed
values in 10—fold cross validation. Although two—stage GDP shows
slightly better predictive performance in terms of mean of MSPEs in
10—fold cross validation shown in Figure 3, the variation of 10—fold
cross validation result based on two—stage—GDP is smaller than two—
stage—BL and two—stage—t—priors.

The calculated total phenotypic variance from (5) for two—stage—
GDP is 1.700. The total genetic variance contributed by the additive
effects of the markers calculated from the first term of the right
hand side in (5 ) is 0.483. Although the aim of this study is predic—
tion, if one is interested in selecting the set of SNPs with the most
contribution, heritability is a good criteria. To select a set SNPs
based on heritability, Hoti and Sillanpaa (2006) suggested present—
ing a threshold value, t, such that one SNP is included in the final
model if the heritability explained by this SNP is greater than t.
Under such an approach, the heritability for milk protein yield is ex-
pected to be small based on previous studies. Hence, instead of set—
ting a threshold on heritability of each SNP, we considered a
threshold on total heritability of a set of top SNPs ranked based on
calculated lol-Zs. To this end, we first calculated heritability for each
SNP by substituting the mean of posterior samples of ﬂjs in (5 ). This
provided a list of ranked SNPs. We then selected a set of top SNPs
with total heritability above 0.2. The estimated effect sizes and mar—
ginal heritabilities of 32 selected SNPs as well as their chromosomes’
numbers are tabulated in Table 4.

Among these selected SNPs, 19 SNPs out of 32 have been found
in known genes or nearby them. Figure 4 shows pieces of

91% ‘09 1sn§nv uo sojoﬁuv soq 0211110111123 310 [01819111qu 112 /§.IO'SIBU.IHO[p.IOJXO'SOTlBIHJOJUTOTCI/ﬁdllq 11101; pop1201umoq

A Hybrid Bayesian Approach for G WAS

3895

 

Table 2. Average of MSPEs for different values of hyperparameters
for 5-fold cross validation and the standard deviation from 50 boot-
strap samples in subscript

 

 

(d1,b1) = 1  3 
(a2) b2)

 

0.001,0.001) 0.698(0018) 0.539(0012) 0.526(0013) 0.529(0010)

(

(0.01, 0.01) 0.686(0019) 0.528(0011) 0.519(0011) 0.523(0015)
(0.1,0.1) 0.736(028) 0.564(0018) 0.551(022) 0.557(0023)
(0.3,0.3) 0.845(0028) 0.576(0018) 0.572(0058) 0.569(0023)

 

Table 3. Average of 10-fold cross validation MSPEs and correlation
of observed values and predicted values using two-stage meth-
ods, GDP, t—priors and BL. The subscripts are standard deviations
based on 100 bootstrap samples

 

Model Two—stage—GDP Two—stage—t—priors Two—stage—BL

 

MSPE 0.518(00276) 0.551(00362) 0.568(00344)
Cor 0.751 0.712 0.703

 

Table 4. Position of selected SNPs with their effect sizes and
heritabilities

 

 

Chr [3,- Ia§(%) Chr [3,- b§(%)
1 —0.0562 0.131 13 —0.0578 0.150
1 0.0617 0.192 13 0.0585 0.173
1 —0.0983 2.930 13 0.0569 0.138
3 —0.0580 0.120 14 —0.0595 0.232
3 —0.0572 0.156 17 0.0905 2.552
3 —0.0572 0.138 18 0.0569 0.140
4 —0.0595 0.204 18 0.0790 1.584
4 —0.0591 0.206 22 0.0586 0.179
4 0.0796 1.529 25 0.0715 0.976
6 0.0707 0.906 25 —0.0753 1.091
7 —0.0726 0.950 25 —0.0553 0.110
8 0.0571 0.136 28 —0.0503 0.100
8 0.0606 0.798 28 0.0617 0.741
9 0.0636 0.821 28 0.0691 0.880
10 0.0566 0.140 28 0.0589 0.197
12 —0.0581 0.182 29 0.0580 0.200

 

chromosome 1 and 10 as examples. The red regions in these pictures
indicate the locations of the genes associated with milk protein yield
that have been found through previous studies. The two vertical red
lines represent the locations of two selected markers in our study. As
it shows, the selected SNP in Chromosome 1 is in gene PPP2R3A
and the one in Chromosome 10 is between genes SAVl and NIN.

We further examined the correlations between the SNPs that are
selected from the same chromosome. The correlation matrices of
these markers presented in Supplementary Appendix C reveal de—
tected SNPs in most of the Chromosomes are weakly correlated.
Although, the correlation matrix for chromosome 3 shows two
markers closely link to each other. Hence, selecting those two
markers might be due to linkage disequilibrium.

5 Discussion

In 1) >> 71 problems, current variable selection and mixture priors
face problems in scaling to very large p when n in small relative to p.

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

In —I—
LIJ h T i
e C” — I =
In 4 I
E HZ! — : ' :
:= C” _ :
E In —I'| —
E 4::
I __‘I —
E In I
~=r. — 1 I
| i I
BEE—GDP 2~5—N|G 2-S-EL
E E — | I I'
 C“) l I
.H
E _
'11)
t —
a :5: _ I
9 c; l
2:: _ I
t.) l i :
E c, _ _l_ l :
D u: ' I
E _ _l_

 

 

 

I I I
2—S—GDP 2540116 2-5-BL

Fig. 3. Top: box plot of MSPE obtained through 10-fold cross validation, bot-
tom: box plot of correlation between predicted and observed values in 10-
fold cross validation

CI'II'DI'I'IDEICI'HE' 1: 13‘JT-33U5-13ILET'12'DT
.‘ﬁ-Eiﬂ ﬁnial: rrIIdIII-IH'EEI Wu
— . 'h — I-l-II'J III-I '-
Illi:ll- IF=II I-='I. ' I I J 5"! I I 9 r II.

:'...I.I. MN" -—-' "-----'- ---'-I -' "-I-I-"I- I - — "ﬂu-"H " '- -'
mm Curran —

 

 

h'.J_' h-
e 1r-:II'rI.I:-I.I:Irne II :I: 41.011.111.141!!! 3. FBI

 

 

 

Fig. 4. Location of two selected markers from chromosome 1 and 10

These problems include computational bottlenecks and insufficient
ﬂexibility. To solve these problems, multistage approaches have
been proposed, but not yet in the case in which the subjects under
study are related. We address this gap via new two—stage Bayesian
approaches that account for familial dependence. The method is a
hybrid of single marker and simultaneous analyses. In the first—stage,
we select a superset of the most promising SNPs by evaluating the
impact of each SNP individually while accounting for related sam—
ples. In the second stage, we simultaneously select and estimate the
parameters of the model by placing a GDP prior on the SNP coeffi-
cients, again accounting for relatedness.

Our simulation analyses revealed that two—stage—GDP improves
predictive performance in comparison to one—stage analysis when n
is too small relative to p. The computational cost of this proposed
approach also makes it feasible for large scale problems like GWAS.

In the real data analysis, we made a comparison among different
prior specifications in the second stage of analysis. This comparison
represented that two—stage—GDP performs better than two—stage—
t—priors and two—stage—BL. We then estimated breeding value for
protein yield based on two—stage—GDP. Although the prediction
accuracy was sufficient for the small sample size that we had, a
small proportion of phenotypic variation is explained by SNPs. In
problems that the sample size is not severely limited, splitting the
data in two subsets and applying each stage on a subset of data

91% ‘09 1sn§nv uo sojoﬁuv soq 0211110111123 310 [01819111qu 112 /3.IO'S[BII.IHO[p.IOJXO'SOTlBIIIJOJUTOTQ/ﬂClllq 11101; pop1201umoq

3896

A. Yazdani and D. B.Dunson

 

(see for e.g. Wasserman and Roeder, 2009) may better recover this
missing heritability, which may also arise from interactions.

Acknowledgements

This makes use of data generated by INN OVAGEN Project. More informa-
tion about this project is available from http://centridiricerca.nnicatt.it/dicdr—
centridiricerca/hiodna_205 7. html?rdeLocaleAttr=en. First author thanks
Mohammad Shariati for his comments on this manuscript.

Conﬂict of Interest: none declared.

References

Armagan,A. et al. (2013) Generalized double pareto shrinkage. Statistica
Sinica, 23, 119—143.

Ball,R.D. (2011) Experimental designs for robust detection of effects in gen-
ome-Wide casecontrol studies. Genetics, 189, 1497—1514.

Beattie,S.D. et al. (2002) A two-stage Bayesian model selection strategy for
supersaturated designs. Technometrics, 44, 5 5—63.

Buckler,E.S. et al. (2009) The genetic architecture of maize ﬂowering time.
Science, 325, 714—718.

Cai,X. et al. (201 1) Fast empirical Bayesian lasso for multiple quantitative trait
locus mapping. BMC Bioinformatics, 12, 21 1.

Carvalho,C.M. et al. (2009) Handling sparsity Via the horseshoe. ]. Mach.
Learn. Res., 5, 73—80.

Diabetes Genetics Initiative of Broad Institute of Harvard, MIT LUND
University, Novartis Institutes for BioMedical Research. (2007) Genome-
Wide association analysis identiﬁes loci for type 2 diabetes and triglyceride
levels. Science, 316, 1331—136.

Fan,]. and Li,R. (2001) Variable selection Via nonconcave penalized likelihood
and its oracle properties. ]. Amer. Statist. Assoc., 96, 1348—1360.

Fan,]. and LV,]. (2008) Sure independence screening for ultrahigh dimensional
feature space]. R. Stat. Soc. Ser. B, 70, 849—8911.

Fruhwirth-Schnatter,S. and Wagner,H. (2011) Bayesian variable selection for
random intercept modeling of Gaussian and non-Gaussian data. In:
Bernardo,].M. et al. Bayesian Statistics, 9, 165—200. Oxford University
Press, London.

Ghosh,].K. et al. (2007) An introduction to Bayesian analysis: theory and
methods. Springer Science 85 Business Media, LLC, New York.

Gianola,D. et al. (2009) Additive genetic variability and the Bayesian alpha-
bet. Genetics, 183, 347—363.

Grifﬁn,].E. and Brown,P.]. (201 1) Bayesian Hyper-lasso with non-convex pen-
alization. Anst. NZ]. Stat., 5 3, 423—442.

Hoggart,C.]. (2008) Simultaneous analysis of all snps in genome-Wide and
resequencing association studies. PLoS Genet., 4, e1000130.

Hoti,F. and Sillanpaa,M.]. (2006) Bayesian mapping of genotype >< expression
interactions in quantitative and qualitative traits. Heredity, 97, 4—1 8.

Huanga,H. et al. (2010) Bayesian approach to transforming public gene expres-
sion repositories into disease diagnosis databases. PNAS, 107, 6823—6828.

Jeffreys,H. (1961) Theory ofProhahility. Oxford University Press, New York.

Kang,H.M. et al. (2010) Variance component model to account for sample
structure in genome-Wide association studies. Nat. Genet., 42, 348—354.

Kessler,D.C. et al. (2014) Learning phenotype densities conditional on many
interacting predictors. B ioinformatics, 30, 15 62—156 8.

Li,]. et al. (2011) The Bayesian lasso for genome-Wide association studies.
Bioinformatics, 27, 516—523.

MeuWissen,T.H.E. et al. (2001) Prediction of total genetic value using
genomewide dense marker maps. Genetics, 157, 1819—1829.

Oliehoek,P.A. et al. (2006) Estimating relatedness between individuals in gen-
eral populations with a focus on their use in conservation programs.
Genetics, 173, 483—496.

Park,T. and Casella,G. (2008) The Bayesian lasso. ]. Am. Stat. Assoc., 103,
681—686.

Paul,D. et al. (2008) Preconditioning for feature selection and regression in
high-dimensional problems. Ann. Stat., 36, 1595—1618.

Peng,B. and Amos,C.I. (2008) Forward-time simulations of nonrandom mat-
ing populations using simupop. Bioinformatics, 24, 1408—1409.

Shariati,M.M. et al. (2012) A two step bayesian approach for genomic predic-
tion of breeding values. BMC Proceedings, 6, 812. BioMed Central Ltd.

Stephens,M. and Balding,D.]. (2009) Bayesian statistical methods for genetic
association studies. Nat. Rev. Genet., 10, 681—690.

Tibshirani,R. (1996) Regression shrinkage and selection Via the lasso. ]. R.
Stat. Soc. Ser.B, 58, 267—288.

Wasserman,L. and Roeder,K. (2009) High dimensional variable selection.
Ann. Stat., 37, 2178.

Weedon,M.N. et al. (2008) Genome-Wide association analysis identiﬁes 20
loci that inﬂuence adult height. Nat. Genet., 40, 5 75—5 83.

Wellcome Trust Case Control Consortium. (2007) Genome-Wide association
study of 14 000 cases of seven common diseases and 3 000 shared controls.
Nature, 447, 661—678.

Zhang,C.H. (2010) Nearly unbiased variable selection under minimax con-
cave penalty. Ann. Stat, 38, 894—942.

Zou,H. and Hastie,T. (2005) Regularization and variable selection Via the
elastic net. ]. R. Stat. Soc. Ser. B, 67, 301—320.

91% ‘09 1sn8nv uo sojoﬁuv soq 0211110111123 310 101819111qu 112 /§.IO'SIBU.IHO[p.IOJXO'SOTlBIHJOJUTOTCI/ﬁdllq 11101; pop1201umoq

