APPLICATIONS NOTE V°" 3533533.lggi‘ili‘aiﬁéiﬁqilffiﬁii

 

Sequence analysis

Advance Access publication March 10, 2014

Genome-wide quantitative analysis of DNA methylation from

bisulfite sequencing data

Kemal Akman”, Thomas Haafz, Silvia Gravina3, Jan Vijg3 and Achim Tresch1

1Tresch Group, Max Planck Institute for Plant Breeding Research, 50829 Cologne, Germany, 2AG Haaf, Institute of
Human Genetics, Julius Maximilians University, 97070 Wuerzburg, Germany and 3Department of Genetics, Albert

Einstein College of Medicine, Bronx, NY 10461, USA

Associate Editor: John Hancock

 

ABSTRACT

Summary: Here we present the open-source R/Bioconductor
software package BEAT (BS-Seq Epimutation Analysis Toolkit). lt
implements all bioinformatics steps required for the quantitative
high-resolution analysis of DNA methylation patterns from bisulfite
sequencing data, including the detection of regional epimutation
events, i.e. loss or gain of DNA methylation at CG positions relative
to a reference. Using a binomial mixture model, the BEAT package
aggregates methylation counts per genomic position, thereby com-
pensating for low coverage, incomplete conversion and sequencing
errors.

Availability and implementation: BEAT is freely available as part of
Bioconductor at www.bioconductor.org/packages/devel/bioc/html/
BEAT.html. The package is distributed under the GNU Lesser
General Public License 3.0.

Contact: akman@mpipz.mpg.de

Supplementary information: Supplementary data are available at
Bioinformatics online.

Received on December 26, 2013; revised on February 16, 2014;
accepted on March 4, 2014

1 INTRODUCTION

Bisulﬁte sequencing (BS-Seq) is a sequence-based method to ac-
curately detect DNA methylation at speciﬁc loci, which involves
treating DNA with sodium bisulﬁte (Frommer et al., 1992). The
method is based on bisulﬁte conversion of unmethylated cyto-
sines into uracil and has become a standard in DNA methylation
proﬁling. Its advantage is accuracy, as the degree of methylation
at each cytosine can be quantiﬁed with great precision (Fraga
and Esteller, 2002). More recently, bisulﬁte sequencing has been
applied in a genome-wide manner, which requires advanced com-
putational analysis for determining DNA methylation patterns
and changes therein. Thus far, such analysis has been limited to
the comparison of individual CpG sites between samples.
However, because of the bisulﬁte conversion of cytosines into
uracils, and eventually thymines, sequence complexity is much
reduced, with no account for incomplete conversion and/or
sequencing errors. Bisulﬁte sequencing also often suffers from
low coverage. Here, we present BS—Seq Epimutation Analysis

 

*To whom correspondence should be addressed.

Toolkit (BEAT), a novel tool for analyzing bisulﬁte-converted
DNA sequences. To overcome the aforementioned limitations in
the estimation of methylation rates, BEAT aggregates data from
consecutive cytosines into regions by using a Bayesian binomial-
beta mixture model. The model is derived, described in detail and
evaluated in our Supplementary Material. For each region, it
calculates a posterior methylation probability distribution that
can be used for the comparison of DNA methylation between
samples. Anticipating technological progress in the DNA methy-
lation ﬁeld, BEAT includes an error model adapted to single-cell
BS-Seq data.

2 USAGE AND APPLICATION

The BEAT package can be used for estimating the true methy-
lation levels of BS-Seq samples and for the calling of epimuta-
tions, which are differences in methylation states of a region in
the genome. Pooling single CG counts into regions can be done
with the function positions_to_regions, which reads a
comma separated ﬁle and outputs a data.frame. The latter is
the input to the BEAT model, which can be easily accessed Via
the core function generate_resu1ts.

We assume that all counts at a single CG position were ob-
tained from pairwise different bisulﬁte-converted DNA tem-
plates, representing independent observations. Some of the
most important parameters of our model are the false-positive
and false-negative conversion rates. Let the false-positive rate p+
be the global rate of false methylation counts, which is identical
to the non-conversion rate of non-methylated cytosines.
Conversely, the false-negative rate p_ is the global rate of false
non-methylation counts, which is identical to the inappropriate
conversion rate of methylated cytosines. One can ﬁnd an upper
bound for p+ by considering all methylation counts at non-CG
positions as false-positive results (resulting from non-conversion
of presumably unmethylated cytosines). In the literature, false-
negative rates were not described, therefore we recommend a
conservative estimate of p_ = 0.01.

With the resulting estimates of methylation levels and methy-
lation status from the model, which are returned as a data.frame,
the function epimutati0n_calls can then determine epimutation
differences between two samples and compute rates for demethy-
lating and methylating epimutations. A sample use of BEAT
follows. For a more detailed explanation of the required objects,
we refer to the package Vignette. Figure l graphically illustrates

 

© The Author 2014. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com 1933

112 ﬂJO'slcumo[pJOJXO'sopcuuogutotq/ﬁd11q wort popcolumoq

910K ‘09 lsnﬁnV no :2

K.Akman et al.

 

 

 

 

 

(2'):
  AM. AAA/\AAmMﬂf/LAAI
 vVWlVWVVU 1V W “W

 

 

 

I I I l I I I I
311M017 I8367I 43 33614286 4838I429 64l38571 79395714 94651357 109910000

Position on Chromosome 2

 

 
    
 

 

 

 

 

(b) 2 .
F9: :g"I3.;.:-i ', 3
.o...-“., :8.. o0 . ' 4'...
Q ‘ o .0 o . 0 e. "
«a _ ' 1' '
g o . . ‘ o o
m I
E - I. .
'4: . O.
u, a
cu w . § '
g d _ I I ‘ .
E : m . ' Reference: k=1, "=7
E. ,, .o , .‘ 5amp|e; k=s, n=11 Reference: k=5,n=5
40-; II. I‘- 0 0 ' ‘I - ' Sample' k=8 n=15
E g _ to. as O o o 0 0 . ° I I .
2 -- 0 0 :'
g- ,0' I . g o .
m C... O I. ' . : ..
m N _ o. '
o ‘I ' .'
0". .. 0 g 0 3. ° 0
.II’.‘. ' I g .{g ' i . . . .
~ . z o 'o a . . "'0'. ' g r g .'
.. 3.12m...  .- .- - -° -
d _ I | I | I
0.0 0.2 0.4 0.6 0.8

Reference methylation estimate

Fig. 1. (a) Methylation estimates and epimutation calls on a DNA seg-
ment. For all regions with sufﬁcient read coverage, the black curves show
the methylation estimates for a single cell sample (top), a reference sample
(bottom) and their difference (middle). Regions with methylating epimu-
tations are marked in red, while regions with demethylating epimutations
are marked in blue. Samples used for our analysis in this article were
obtained from neuronal cells of young mice (data unpublished).
at) Scatterplot of methylation estimates of a multi-cell reference sample
(x-axis) versus those of a sample (y-axis) for all common regions with
sufﬁcient coverage. Each dot represents a single region that is covered by
both samples. Red dots indicate methylating epimutations in the sample,
while blue dots indicate demethylating epimutations in the sample. Four
dots representing exemplary regions with epimutations at the correspond-
ing boundary value ranges for demethylating and methylating epimuta-
tions have been annotated with their values of methylated (k) and total
(n) counts. Note that there exists no boundary line separating the red and
the blue region because our Bayesian model assigns different methylation
estimates to tuples (k1, n1), (k2, n2) with equal empirical methylation
level kl/nl = k2/n2

the output of BEAT. The R-objects required for this analysis are
included in the BEAT package.

The most important step is the setting of the user-deﬁned
parameters.

it Load sample data

data(BEAT)

# Initialize working path

localpath <— system. file( ’ extdatal , package

2 ’ BEAT ’ )

# Set sample names and prefix of data files

> sampNames <— c ( ’reference’ , ’ sample’)

# Set reference vs . non—ref status per sample

> is .reference <— c (TRUE, FALSE)

# Set BS—conversion rate per sample

>pplus <— c(0.2, 0.5)

> convrates <— l — pplus

# Create parameter object

> params <— makeParams ( localpath, sampNames,
convrates, is .reference, pminus = 0 . 2 ,
regionSize = 10 000, minCounts = 5)

it Pool CG positions into genomic regions

> positions_to_regions (params)

it Model methylation levels and —status

> generate_results (params)

# Call epimutations

> epiCalls <— epimutation_calls (params)

3 CONCLUSION

The BEAT package delivers methods for the estimation of
methylation levels, methylation status and for calling epimuta-
tion events in a two-sample comparison. To our knowledge, it is
the ﬁrst tool providing a rigid statistical model for handling BS-
Seq samples. It has an in-built correction for conversion errors
and is therefore tailored to the analysis of BS-Seq samples with
possibly different BS-conversion rates.

Funding: NIH grants (AG17242, AG034421, AG032117 and
SENS Foundation to J .V. and S.G.). Jeff Schell professorship
for Computational Biology grant (SFB680) from the Deutsche
F orschungsgemeinschaft (to AT). BMBF e:Bio grant (to K.A.).

Conﬂict of Interest: none declared

REFERENCES

Fraga,M. and Esteller,M. (2002) DNA methylation: a proﬁle of methods and ap-
plications. Biotechniques, 33, 632, 634, 636—649.

Frommer,M. et al. (1992) A genomic sequencing protocol that yields a positive
display of 5-methylcytosine residues in individual DNA strands. Proc. Natl
Acad. Sci. USA, 89, 1827—1831.

Gu,H. et al. (2010) Genome-scale DNA methylation mapping of clinical samples at
single-nucleotide resolution. Nat. Methods, 7, 133—136.

 

1 934

112 [BJO'SIBILIHO[plOJXO'SODBIILIOJHTOTQ/[ldllq won pepeolumoq

910K ‘09 lsnﬁnV no :2

