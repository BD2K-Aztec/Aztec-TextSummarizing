APPLICA TIONS NOTE V°"23011?alééé’iﬁsﬁifﬁﬁiéigﬁéi

 

Gene expression

Advance Access publication July 3, 2013

CellMix: a comprehensive toolbox for gene expression

deconvolution
Renaud Gaujoux1’*’l and Cathal Seoighe2

1Computational Biology Group, Institute of Infectious Diseases and Molecular Medicine, University of Cape Town, South
Africa and 2School of Mathematics, Statistics and Applied Mathematics, National University of Ireland Galway, Ireland

Associate Editor: Ziv Bar-Joseph

 

ABSTRACT

Summary: Gene expression data are typically generated from hetero-
geneous biological samples that are composed of multiple cell or
tissue types, in varying proportions, each contributing to global gene
expression. This heterogeneity is a major confounder in standard ana-
lysis such as differential expression analysis, where differences in the
relative proportions of the constituent cells may prevent or bias the
detection of cell-specific differences. Computational deconvolution of
global gene expression is an appealing alternative to costly physical
sample separation techniques and enables a more detailed analysis of
the underlying biological processes at the cell-type level. To facilitate
and popularize the application of such methods, we developed
Gel/Mix, an R package that incorporates most state-of—the-art
deconvolution methods, into an intuitive and extendible framework,
providing a single entry point to explore, assess and disentangle
gene expression data from heterogeneous samples.

Availability and Implementation: The Gel/Mix package builds on
R/BioConductor and is available from http://web.cbio.uct.ac.za/
~renaud/CRAN/web/CellMix. It is currently being submitted to
BioConductor. The package’s vignettes notably contain additional
information, examples and references.

Contact: renaud@cbio.uct.ac.za

Received on March 29, 2013; revised on June 5, 2013; accepted on
June 17, 2013

1 GENE EXPRESSION DECONVOLUTION

The vast majority of gene expression data is generated from
biological samples that are composed of multiple cell or tissue
types that contribute to different extents to the global gene
expression, according to their relative proportions. Heterogeneity
in sample composition is commonly acknowledged as a major
confounder in classical gene expression analysis such as differen-
tial expression analysis, specially in clinical studies (Zhao and
Simon, 2010). In this context, being able to disentangle the effects
due to cell-speciﬁc expression and/or varying proportions pro-
vides finer insights into the biological processes of interest, by
enabling the data to be explored at the cell-type level.

Gene expression deconvolution receives constant interest in
bioinformatics research, with new methodologies published

 

*To whom correspondence should be addressed.

TPresent address: Department of Immunology, Faculty of Medicine,
Technion-Israel Institute of Technology, Haifa, Israel, 1 Efron Street,
Haifa, 31096, Israel.

regularly (Zhao and Simon, 2010). Although all methods apply
to global expression data, they differ in the type of auxiliary data
they required, such as cell proportion measurements/estimates,
cell-speciﬁc signatures or sets of marker genes. Having a
standardized and uniﬁed interface for running a variety of
deconvolution methods that can adapt to most common data
settings would therefore be useful and help popularize computa-
tional deconvolution.

To facilitate the application and development of gene expres-
sion deconvolution methods, we developed an R package called
CellMix, whose principal objectives are to provide (i) implemen-
tations of some common methods; (ii) easy access to real
auxiliary and benchmark data, and especially marker gene lists;
(iii) utilities for assessing results and developing new methods.

This article brieﬂy describes the main features of the CellMix
package and illustrates its capability with some concrete
examples. More examples, as well as thorough documentation,
references and implementation details are available in the
package’s vignettes.

2 THE CellMiX PACKAGE: OVERVIEW

The CellMix package builds on the Bioconductor project (Gentleman
et al., 2004) and the NMF package (Gaujoux and Seoighe, 2010) to pro-
vide a ﬂexible general framework for gene expression deconvolution
methods. It deﬁnes a rich programming interface around three internal
extendible registries dedicated to deconvolution methods, marker gene
lists and benchmark datasets, respectively.

2.1 Deconvolution methods

CellMix provides access to a range of seven gene expression
deconvolution methods, in such a way that they can easily be applied
to commonly available data, via a unique interface function called ged.
In particular, we implemented a default method selection scheme, which
chooses a sensible deconvolution method based on the type of input and
auxiliary data that are provided (See section “Algorithms” on the pack-
age’s webpage for details on each available method).

2.2 Cell signatures and marker gene sets

In the context of gene expression deconvolution and sample heterogeneity
in general, marker genes constitute a critical asset. For example, they can
provide cell-speciﬁc signals that can be used to estimate cell-speciﬁc sig-
natures and/or cell proportions or detect cell-type—related differential ex-
pression (Bolen et al., 2011; Gaujoux and Seoighe, 2012; Kuhn et al.,
2011). The CellMix package includes a set of eight marker gene lists,
compiled from previous studies and public databases, and provides
many convenient filtering or plotting functions for such type of data.

 

© The Author 2013. Published by Oxford University Press. All rights reserved. For Permissions, please e—mail: journals.permissions@oup.com 2211

112 /310's113umo [p.IOJXO'SOIlBIHJOJUIOIQ/ﬁdllq 11101; prBOIIIAAOG

9IOZ ‘091sn3nv uo ::

R. Gaujoux and C.Seoighe

 

Moreover, it implements a ﬂexible general pipeline to convert gene iden-
tifiers, including across platform or species, which greatly simplifies the
use of both marker genes and datasets from one study in another.

2.3 Benchmark datasets

CellMix ships with a curated repository of 11 public datasets compiled
from a variety of published studies on cell/tissue-speciﬁc gene expression
or deconvolution methods. These datasets were chosen because they con-
tain not only global gene expression from mixed samples but also data
such as cell-type—speciﬁc signatures and/or measured mixture proportions
for each sample, making them ideal for developing and validating decon-
volution approaches. Each dataset can be loaded in a single call, which
applies a pro-processing pipeline to the original—normalized—data,
downloaded from public repositories. In particular, data relevant for de-
convolution are extracted from sample annotations and processed into
single data objects, from which mixed/pure sample expression profiles
and/or cell proportions can be easily retrieved.

3 EXAMPLE: BLOOD SAMPLE DECONVOLUTION

The dataset GSE20300 contains gene expression data
(on Affymetrix HGUl33Plus2) of whole-blood samples from
stable and acute rejection pediatric kidney transplant, for
which Complete Blood Count (CBC) data are available
(Shen-Orr et al., 2010). The following code estimates these pro-
portions using an optimized set of immune cell-type signatures
(on Affymetrix HGUl33A/B) (Abbas et al., 2009) and produces
the scatter plot in Figure 1. Both these data are available in the
CellMix package. Importantly, sensible probeset mapping or
joint data transformation and normalization are transparently
handled via a—customisable—pre—processing pipeline. To our
knowledge, this is the first time these data have been used in
this way. The ease with which the results are generated highlights
the usefulness of the CellMix package.

acr <— ExpressionMix( )

res <— gedBlood (acr)

profplot(acr, asCBC(res))

4 EXAMPLE: WORKING WITH MARKER GENES

In this example, we illustrate how CellMix simplifies working
with marker genes lists. The consistency of expression profiles
from four transformed immune cell lines contained in dataset
GSEI 1058 (on Affymetrix HGUl33Plus2) (Abbas et al., 2009)
is graphically assessed using the marker gene list from

Mixture coefficient profile correlations

 

' Neutrophils (0.39 | 0.82 | 0.66 +/- 0.18)
- Lymphocytes (0.62 | 0.85 | 0.72 +lr 0.17)
0 Monocytes (0.52 | 0.68 | 0.46 +/- 0.25)

—
' '5 4 9

my gm-

o? 2 ‘°

22: a

Em g

..

 

0
Illlllll II II
III lllll II I

Estimated proportions

 

 

 

a: meal p = 0.92 I F12 = 0.84 +/7 0.06

 

 

 

 

I I I I I I
0.0 0.2 0.4 0.6 0.8 1.0 2

E
('n

Raji THP-1 Jurkat
Measured CBC proportions

Fig. 1. Blood sample deconvolution: estimated versus measured propor-
tions (CBC) (left). Heatmap of average marker gene expression in pure
cell lines (right)

HaemAtlas, which contains markers for eight immune cell
types derived by Watkins et al. (2009) in an independent study
(on Illumina Human V2). The following code generates the heat-
map in Figure 1. This shows the expression profiles of the
HaemAtlas marker genes that are most highly expressed in the
cell lines on the columns (50 marker genes per cell type). Rows
are scaled into relative expression separately (i.e. sum up to one).
The row annotation columns on the left-hand side highlight the
cell line in which each marker is expressed at the highest level.
They show that some markers are highly expressed by cell types
other than their own, which suggests either an altered expression
profile of these cell lines or an inadequacy of these markers for
this particular dataset.

pure <— pureSamples(ExpressionMix( ))
m <— convertIDs(cellMarkers( ), pure)

avg <— rowMeansBy(pure, pure$LType)
m <— reorder(m, avg, fun = max)
basismarkermap(m[, 1:50], avg)

5 CONCLUSION

The CellM ix package provides a comprehensive set of function-
alities that together facilitate the exploration, assessment and
deconvolution of gene expression data generated from heteroge-
neous biological samples. It integrates multiple tissue/cell-speciﬂc
gene databases, a set of curated benchmark public gene expres-
sion datasets and most of the state-of-the-art deconvolution
algorithms into a single unified framework. The package is de-
signed to be intuitive and extendible, as well as to integrate well
with standard R/BioConductor packages. Being suitable for both
data analysis and algorithm implementation, such a toolbox will
hopefully help and encourage researchers to explore gene expres-
sion data at the cell-type level, as well as to develop new decon-
volution methodologies.

Funding: CS. is funded by Science Foundation Ireland
(grant number 07/SK/Ml2llb). R.G.’s work at the Technion
is supported by the Lady Davis fellowship.

Conﬂict of Interest: none declared.

REFERENCES

Abbas,A.R. et al. (2009) Deconvolution of blood microarray data identiﬁes cellular
activation patterns in systemic lupus erythematosus. PLoS One, 4, e6098.

Bolen,C.R. et al. (2011) Cell subset prediction for blood genomic studies. BM C
Bioinformatics, 12, 258.

Gaujoux,R. and Seoighe,C. (2010) A ﬂexible R package for nonnegative matrix
factorization. BMC bioinformatics, 11, 367.

Gaujoux,R. and Seoighe,C. (2012) Semi-supervised nonnegative matrix factorization
for gene expression deconvolution: a case study. Infect. Genet. Evol., 12, 913—921.

Gentleman,R.C. et al. (2004) Bioconductor: open software development for com-
putational biology and bioinformatics. Genome Biol., 5, R80.

Kuhn,A. et al. (2011) Population-speciﬁc expression analysis (PSEA) reveals
molecular changes in diseased brain. Nat. Methods, 8, 945—947.

Shen—Orr,S.S. et al. (2010) Cell type-speciﬁc gene expression differences in complex
tissues. Nat. Methods, 7, 287—289.

Watkins,N.A. et al. (2009) A HaemAtlas: characterizing gene expression in differ-
entiated human blood cells. Blood, 113, el—9.

Zhao,Y. and Simon,R. (2010) Gene expression deconvolution in clinical samples.
Genome Med, 2, 93.

 

2212

112 /310's113umo [p.IOJXO'SOIlBIHJOJUIOIQ/ﬁdllq 11101; popeoIII/noq

9IOZ ‘091sn3nv uo ::

