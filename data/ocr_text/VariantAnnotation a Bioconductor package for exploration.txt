APPLICA TIONS NOTE W 312,-? 133. 13923321355313.2333;

 

Sequence analysis

Advance Access publication March 28, 2014

VariantAnnotation: a Bioconductor package for exploration
and annotation of genetic variants
Valerie Obenchain”, Michael Lawrence2, Vincent Careyg, Stephanie Gogarten“,

Paul Shannon1 and Martin Morgan1

1Program in Computational Biology, Fred Hutchinson Cancer Research Center, Seattle, WA 98109, 2Bioinformatics and
Computational Biology, Genentech, South San Francisco, CA 94080, 3Brigham and Women’s Hospital, Harvard Medical
School, Boston, MA 02115 and 4Department of Biostatistics, University of Washington, Seattle, WA 98195, USA

Associate Editor: Alfonso Valencia

 

ABSTRACT

Summary: VariantAnnotation is an R / Bioconductor package
for the exploration and annotation of genetic variants. Capabilities exist
for reading, writing and filtering variant call format (VCF) files.
VariantAnnotation allows ready access to additional R /
Bioconductor facilities for advanced statistical analysis, data trans-
formation, visualization and integration with diverse genomic resources.
Availability and implementation: This package is implemented in R
and available for download at the Bioconductor Web site (http://
bioconductor.org/packages/2.13/bioc/hthariantAnnotation.
html). The package contains extensive help pages for individual func-
tions and a ‘vignette’ outlining typical work flows; it is made available
under the open source ‘Artistic-2.0’ license. Version 1.9.38 was used
in this article.

Contact: vobencha@fhcrc.org

Received on May 2, 2013; revised on February 20, 2014; accepted on
March 25, 2014

Major products of DNASeq and other high-throughput experi-
ments are catalogs of called variants [e. g. single-nucleotide poly-
morphisms (SNPs), indels] saved in variant call format (VCF)
(The 1000 Genomes Project Consortium, 2012) ﬁles. VCF ﬁles
contain data lines with position and genotype information on
samples. VariantAnnotation enables users to explore these
data in R.

1 AVAILABLE FUNCTIONALITY

Important operations available with the VariantAnnotation
package are summarized in Table 1; we illustrate these oper-
ations using a subset of chr7 breast cancer variants for a
tumor/normal pair (Drmanac and Sparks, 2010).

1.1 Reading, writing and ﬁltering

reachf reads data from a VCF ﬁle into a VCF R object.
Genomic locations are stored as a GRanges object, with REF,
ALT, FILTER, QUALITY and INFO ﬁelds as metadata
columns. The GRanges object is a convenient format for
manipulating range data and is compatible with extensive and
well-developed Bioconductor (Gentleman et al., 2004) tools

 

*To whom correspondence should be addressed.

for discovering overlaps and matching between ranges (Lawrence
et al., 2013). Genotype data are parsed into arrays and stored in
reference classes to avoid multiple data copies. A VCF object can
be written out as a tabix-indexed (Heng, 2010) VCF ﬁle with
writchf.

One strategy for processing large tabix-indexed ﬁles is to use
scanVc fHeader to identify INFO or FORMAT ﬁelds of inter-
est, formulate range-based queries and load the data with
reach f. Memory use can be tuned by setting a yieldSize
and iterating over the data in chunks.

> library (Varian tAnnota ti on)

> fl <— system.file(“extdata", “Chr7—
sub.vcf.gz",

+ package: "VariantAnnotation ’ ’)

> hdr <— info (scanchHeader (fl)) ##’info’
fields

Table 1. Example functions available in VariantAnnotation

 

Function Description

 

Reading, writing and ﬁltering

scanVc fHeader Retrieve information about ﬁle content
ScanchParam Select ﬁelds to input
reachf Read a VCF ﬁle into an R object

readGeno, readInfo, readGT
Read a single ﬁeld into an R object

writchf Write an R object to a VCF ﬁle
filteerf Filter one VCF ﬁle to another
Annotation
locateVari ants Identify variants overlapping ranges
predictCoding Predict amino acid consequences
summarizeVariants By range and sample
SNPs

genotypeToSanatrix Genotypes as Sanatrix objects

snpSummary Counts and distribution statistics
Manipulation
expand Convert R VCF representations

cbind, rbind Combine variants or samples

 

 

2076 © The Author 2014. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com

112 ﬂJO'slcumo[pJOJXO'sor1chOJurorw/2d11q IIIOJJ popcolumoq

910K ‘09 lsnﬁnV no :2

Bioconductor VariantAnnotation

 

> param <— ScanVCfParam (info: "CGA_BF",
geno: "AD’ ’ )
> tabiX<— TabixFile(fl, yieldSize=lOO 000)

> vcf <— readVCf(tabix, ‘ ‘hgl9", param) ##
Chunk 1

readInfo, readGeno and readGT retrieve individual ﬁelds
as standard R objects. f ilteerf identiﬁes records satisfying
predeﬁned and ad hoc criteria, creating a new VCF ﬁle.

1.2 Annotating and transforming variants

locateVariants associates variants with coding, intron,
splice site, promoter, UTR or intergenic regions.

> library (TxDb . Hsapi ens . UCS'C . hgl9 . known
Gene)

> txdb <— TxDb . Hsapi ens . UCS'C. hgl9 . known
Gene

> vcf <—
’Chr7 ’) )

> loc <— locateVariants (vcf, txdb, Intron
Variants () )

renameS’eqlevels (vcf, c ( ’ 7 ’=

The gene, transcript and coding region identiﬁers provided in
the output can be used with other Bioconduc tor resources to
map to additional identiﬁers such as protein families database
(PFAM) or gene ontology project (GO).

> library (org.Hs. eg. db)

> select (org. Hs . eg. db, loc$GENEID, c

(IIPFAMII, IIGOII))

predictCoding computes amino acid coding changes for
non-synonymous variants that overlap coding regions.
Reference sequences are retrieved from a BSgenome package
or F ASTA ﬁle. Variant sequences are constructed by substituting
or inserting variant alleles into the reference sequence. Custom
genomes can be imported as a Trans cr iptdb object with one
of the makeTranscriptDb functions available in the
GenomicFeatures package.

> library (BSgenome . Hsapi ens . UCS'C . hgl 9 )
> predictCoding (vcf, txdb, Hsapiens)

geno typeToSanatr ix performs probability-based encod-
ing of the genotype calls in a VCF object to create an
Sanatrix object for use in downstream packages.
snpSummary provides counts and distribution statistics.

1.3 Integration and comparison with other resources

VariantAnnotation offers highly ﬂexible tools to interrogate
and transform VCF ﬁles into R objects for exploration and ana-
lysis. In contrast to programs such as VCFtools (Danecek et al.,
2011) or PLINK/ SEQ, VariantAnnotation provides an
interactive environment for integrated portable analysis and
methods development. The ensemblVEP package is an interface
to the VEP (McLaren et al., 2010) tool, while functions in
VariantAnnotation allow close integration with SNP

Table 2. VariantAnnotation and Rplinkseq runtirnes (min)

 

 

Function Range (All ﬁelds) Range (Select ﬁelds) Iterate
Rplinkseq
load.vcf 359.8 NA NA
var.fetch 291.8 NA NA
meta.fetch NA 120.9 NA
var.iterate NA NA 1583.1
VariantAnnotation
scanch 359.1 35.5 50.3

 

analysis routines in packages such as snpS tats. I/O capabilities
are compatible with upstream alignment and variant calling R
packages such as gmapR and VariantTools, as well as VCFs
produced by VarScan (Koboldt et al., 2012), GATK (McKenna
et al., 2010), etc. The ability to transform and output VCF sub-
sets enables creation of ﬁles for use in tools such as ANNOVAR
WVang et al., 2010). R VCF objects can be Visualized with pack-
ages such as ggbio OK in et al., 2012).

VariantAnno tat i on has good performance relative to other
R tools operating on VCF ﬁles, e. g. Rpl inkseq (http://atgu.mgh.
harvard.edu/plinkseq/r-intro.shtml), as illustrated using a com-
pressed indexed VCF (ftp: / /ftp-trace.ncbi.nih. gov/ 1000genomes/
ftp/release/20110521/ALL.chr22.phase1_release_V3.20101123.
snps_indels_svs.genotypes.vcf.gz) (494 328 records, 1092 samples
and 22 INFO and 3 genotype ﬁelds). Testing was done on a 64-bit
387 Gb 2.90 GHz Linux server; test script is available in inst/ scripts /
of the built tarball or scripts / of the installed package. Runtimes for
four Rpl inks eq functions and s canVc f from
VariantAnnotation are summarized in Table 2. NA values
indicate the function could not perform the abstraction.

A range of 63 088 records and two INFO and two genotype ﬁelds
were arbitrarily chosen for testing. VariantAnnotation out-
performed load . vc f when reading the range with all ﬁelds and
meta . f etch when reading in speciﬁc INFO and genotype ﬁelds.
Vari antAnno tat i on was ~30 X faster than Rpl inks eq when
iterating over all records in the ﬁle. Input times for scanVc f scale
linearly with the number of variants or samples.

2 CONCLUSIONS

This Note introduces the VariantAnnotation package to
ﬂexibly interrogate, annotate and transform VCF ﬁles.
The package integrates with Bioconductor packages for
advanced SNP and variant analysis, gene and genome annota-
tion and rich tools for range-based queries.
VariantAnnotation is performant compared with other R
solutions and scales to handle large ﬁles with reasonable
memory requirements. Read/write capabilities allow ready inte-
gration with third party software.

Funding: National Human Genome Research Institute of the
National Institutes of Health (U41HG004059 to M.M.).

Conﬂict of Interest: none declared.

 

2077

112 ﬂJO'smumo[pJOJXO'sot1nmJOJutotw/2d11q won pepnolumoq

910K ‘09 lsnﬁnV no :2

V.Obenchain et al.

 

REFERENCES

Danecek,P. et al. (2011) The variant call format and VCFtools. Bioinformatics, 27,
2156—2158.

Drmanac,R. and Sparks,A.B. (2010) Human genome sequencing using unchained
base reads on self-assembling DNA nanoarrays. Science, 327, 78—81.

Gentleman,R.C. et al. (2004) Bioconductor: open software development for com-
putational biology and bioinforrnatics. Genome Biol., 5, R80.

Heng,L. (2010) Tabix: fast retrieval of sequence features from generic TAB-
delimited ﬁles. Bioinformatics, 27, 718—719.

Koboldt,D. et al. (2012) VarScan 2: somatic mutation and copy number alteration
discovery in cancer by exome sequencing. Genome Res., 22, 568—576.

Lawrence,M. et al. (2013) Software for computing and annotating genomic ranges.
PLoS Comput. Biol., 9, 61003118.

McKenna,A. et al. (2010) The Genome Analysis Toolkit: a MapReduce framework
for analyzing next-generation DNA sequencing data. Genome Res., 20,
1297—1303.

McLaren,W. et al. (2010) Deriving the consequences of genomic variants
with the Ensembl API and SNP Effect Predictor. BM C Bioinformatics, 26,
2069—2070.

The 1000 Genomes Project Consortium. (2012) An integrated map of genetic vari-
ation from 1,092 human genomes. Nature, 491, 56—65.

Wang,K. et al. (2010) ANNOVAR: functional annotation of genetic variants from
high-throughput sequencing data. Nucleic Acids Res., 38, e164.

Yin,T. et al. (2012) ggbio: an R package for extending the grammar of graphics for
genomic data. Genome Biol., 13, R77.

 

2078

112 ﬂJO'smumo[p101x0'sot112u1101u101q//2d11q 111011 pepeolumoq

910K ‘09 lsnﬁnV uo 22

