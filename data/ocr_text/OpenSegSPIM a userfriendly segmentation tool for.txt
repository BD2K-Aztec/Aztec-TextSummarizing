Bioinformatics, 32( 13), 2016, 2075—2077

doi: 10.1093/bioinformatics/btw093

Advance Access Publication Date: 22 February 2016
Applications Note

 

Bioimage informatics

OpenSegSPlM: a user-friendly segmentation
tool for SPIM data

Laurent Gole1'*, Kok Haur Ongz, Thomas Boudier3, Weimiao Yu2'* and
Sohail Ahmed1'*

1Institute of Medical Biology, Agency for Science, Technology and Research (A*STAR), 2Institute of Molecular and
Cell Biology, Agency for Science, Technology and Research (A*STAR) and 3IPAL UMI 2955 (CNRS, UPMC, UJF,
IMT, |2R, NUS), Biolnformatics Institute (BII), Agency for Science, Technology and Research (A*STAR), 13867,
Singapore

*To whom correspondence should be addressed.
Associate Editor: Robert Murphy

Received on September 8, 2015; revised on January 29, 2016; accepted on February 14, 2016

Abstract

Summary: OpenSegSPIM is an open access and user friendly 3D automatic quantitative analysis
tool for Single Plane Illumination Microscopy data. The software is designed to extract, in a user—
friendly way, quantitative relevant information from SPIM image stacks, such as the number of nu—
clei or cells. It provides quantitative measurement (volume, sphericity, distance, intensity) on Light
Sheet Fluorescent Microscopy images.

Availability and implementation: freely available from http://vaw.opensegspim.weebly.com.

 

Source code and binaries under BSD License.

Contact: Igole@imcb.a—star.edu.sg or wmyu@imcb.a—star.edu.sg or sohaiI.ahmed@imb.a—star.edu.sg
Supplementary information: Supplementary data are available at Bioinformatics online.

 

1 Introduction

Single Plane Illumination Microscopy (SPIM) was developed in
2004 by Stelzer and colleagues (Huisken et 61]., 2004) to image 4D
live developing embryos. Further improvements have been made by
(Keller et 61]., 2008) and more recently (Chhetri et 61]., 2015).
Intrinsic to the concept of SPIM was low phototoxicity and photo—
damage. Development on SPIM technology over the last 10 years
has led to the more general term of Light Sheet Fluorescent
Microscopy (LSFM) to describe this imaging technique. The advent
of OpenSPIM (Pitrone et 61]., 2013) and OpenSPIN (Gualda et 61].,
2013) has opened a new era in LSFM. These two projects provide
detailed information and resources to allow any scientist to build
and start LSFM. Importantly, these Open projects, are associated
with websites and the ability to interact with the developers.

Here, we provide details of an image processing tool,
OpenSegSPIM, which is made available on the same basis as
OpenSPIN and OpenSPIM. The combination of OpenSPIN/
OpenSPIM and OpenSegSPIM allows image generation to be con—
nected to image processing, allowing the automated extraction of

quantitative information from LSFM images. LSFM generates large
numbers of raw image stacks (Gigabytes, going to Terabytes in a
time series) that require initial processing steps such as registration
of multiple view and deconvolution to reconstruct the data
(Preibisch et 61]., 2010). Acquisition, visualization and quantitative
analysis are the 3 milestones to go from a biological sample to quan—
titative results. We propose OpenSegSPIM here as a user—friendly
tool to perform the quantitative analysis step. To obtain the infor—
mation on a cell—by—cell basis, the objects in the 3D stacks should be
separated from each other, i.e. segmented, before further quantita—
tive analysis.

A variety of algorithms (Eliceiri et 61]., 2012; Jug et 61]., 2014; Yu
et 61]., 2009) are available for segmentation of nuclei, including:
watershed, iterative voting methods, level set approach based on
gradient ﬂow and ﬂexible contour model. However the implementa—
tion of these algorithms to segment LSFM data is not straightfor—
ward, due to complex installation procedures, or difficulty in tuning
the parameters for individual biological samples. Moreover, a good
segmentation result relies not only on an efficient segmentation algo—
rithm but also on a sequence of steps preparing the image so that the

©The Author 2016. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com 2075

9mg ‘09 1sn3nv uo sojoﬁuv s01 ‘BTUJOJTIBD aIo Amie/nun 112 /§.IO'S[BU.IHO[p.IOJXO'SOTlBIHJOJUTOTQ/ﬁdllq 11101; popeommoq

2076

L.Gole et al.

 

Data Loading

    
    

Foreground

Manual Seeds

Results

Fig. 1. OpenSegSPIM flowchart. (Red arrow) Main process: load a 3D image
and process it semi-automatically. (Black arrow) Automatic batch process of
a list of images. (Blue arrow) Load and process cell channel after nuclei ana-
lysis. (Green arrow) Reload a processed image and manually correct detec-
tion errors

segmentation algorithm can perform efficiently. Therefore, putting
all these steps together requires a systematic design of the pipeline
and the interface.

Currently, few graphical user interfaces are specifically designed
for nuclei segmentation in 3D especially cell aggregates. Modular
Interactive Nuclei Segmentation was developed as a user interface to
segment early mouse embryo (Lou et al., 2014) but it is only avail—
able for Matlab License owner. Dedicated effort is urgently needed
to build user friendly interface for LSFM users.

2 OpenSegSPIM

OpenSegSPIM is a user—friendly interface dedicated to segmentation
and analysis of LSFM data that assumes no prior knowledge of
image processing or programming. The OpenSegSPIM workﬂow
(Fig. 1) consists of a succession of simple steps to segment and ana—
lyse nuclei (loading, enhance, foreground, detection, segmentation
and analysis).

In general, the quality of segmentation depends greatly on the ac—
curacy of the algorithm input parameters. Therefore the number of
input parameters as well as the complexity to find the right value is
critical for an accurate quantitative analysis.

In OpenSegSPIM, the number of parameters is reduced to only
a few essential ones. Only a few manual nuclei diameter measure—
ments and an intuitive interactive intensity adjustment on the
image are required from the user to fine tune the necessary param—
eters. The software provides an interactive interface and a direct
visual feedback for each step. Other features of OpenSegSPIM in—
clude, (i) a simple manual nuclei editing tool, (ii) an automatic
batch process of time series facilitating the further use of tracking
algorithms and (iii) a cell membrane segmentation and analyses
tool.

3

:- .3
:.

-- r
r P

I." I "

 

Fig. 2. Segmentation by OpenSegSPIM. (a) Neurosphere, (b) C. elegans em-
bryo, (c) Drosophila embryo. 3D view of original image (grayscale) and seg-
mented result (color coded, blue to red correspond at small to large volume).
Scale bars 30 mm

Table 1. Accuracy of OpenSegSPIM semi-automated segmentation
before any manual editing for the sample displayed in Figure 2

 

 

Samples Neurosphere C. elegans Drosophila
Segmentation embryo embryo
Ground truth 52 3 39 28 1 8
Detected 5 1 327 2884

True positives 51 326 2806

False positives 0 1 78

False negatives 1 13 12
Precision % 100 99.7 97

Recall 0.98 0.96 1
Computation time 2 min 7 min 25 min

 

We evaluated the segmentation accuracy of OpenSegSPIM on
LSFM data by visually comparing raw and segmented data and
manually counting all differences.

The number of nuclei in the original image (NGroundtruth), num-
ber of segmented nuclei (Ndetected), number of true 86 false segmen-
tation (Ntmepositive and Nfalsepositive) and number of missing nuclei
(Nfalsenegative) allow us to measure the precision (P : Ntmepositive/
(Ntruepositive+Nfalsepositive) and recall (R : Ntruepositive/NGroundtruth) 0f
OpenSegSPIM. The software successfully segment Neurospheres,
Caenorhabditis elegans and Drosophila embryo with minimal error
(Accuracy > 92% before manual editing) (Fig. 2 and Table 1).

We did a comparative study of OpenSegSPIM performance against
other existing segmentation tools showing OpenSegSPIM to have bet—
ter or equal segmentation accuracy (see Supplementary Materials).

In line with OpenSPIN and OpenSPIM we include a website to
promote easy access and use of the software. We provide a complete
user guide and tutorial to guide the user through the segmentation
of their data and provide detailed explanation of the algorithms
used for each steps. Software executable and source code are freely
available at (http://opensegspim.weebly.com).

Acknowledgments

We thank Tim Saunders for the Drosophila dataset, and Hari Shroff (diSPIM
data) for C. elegans dataset.

Funding

This work has been supported by the Agency for Science, Technology and
Research.

91% ‘09 1sn8nv uo sojoﬁuv s01 ‘BTUJOJTIBD aIo Amie/nun 112 /3.IO'S[BUJHO[p.IOJXO'SODBIHJOJUTOTQ/ﬂdllq 11101; popeommoq

OpenSegSPlM: a user friendly segmentation tool

2077

 

Conﬂict of Interest: none declared.

References

Chhetri,R.K. et al. (2015) Whole-animal functional and developmental imag-
ing with isotropic spatial resolution. Nat. Methods, 12, 1 171—1 178.

Eliceiri,K. et al. (2012) Biological imaging software tools. Nat. Methods, 9,
697—710.

Gualda,E. et al. (2013) OpenSpinMicroscopy: an open-source integrated
microscopyplatform. Nat. Methods, 10, 5 99—600.

Huisken,]. et al. (2004) Optical sectioning deep inside live embryos by select-
ive plane illumination microscopy. Science, 305, 1007—1009.

Jug,F. et al. (2014) Bioimage Informatics in the context of Drosophila re-
search. Methods, 68, 60—73.

Keller,P.]. et al. (2008) Reconstruction of zebraﬁsh early embryonic develop-
ment by scanned light sheet microscopy. Science, 322, 1065—1069.

Lou,X. et al. (2014) A rapid and efﬁcient 2D/3D segmentation method for
analysis of early mouse embryo and stem cell image data. Stem Cell Rep., 2,
382—397.

Pitrone,P. et al. (2013) OpenSPIM: an open access light sheet microscopy plat-
form. Nat Methods, 10, 598—599.

Preibisch,S. et al. (2010) Software for bead-based registration of selective
plane illumination microscopy data. Nat. Methods, 7, 418—419.

Yu,W. et al. (2009) Segmentation of neural stem/progenitor cells nuclei within
3D neurospheres. International symposium on Visual computing. Lect.
Notes Comput. Sci., 5875, 531—543.

91% ‘09 1sn8nv uo sojoﬁuv s01 ‘eguJoggjeQ go Amie/nun 112 /810'Sjeumo[pJogxosoneuuogutotq//:d11q uIOJg popeogumoq

