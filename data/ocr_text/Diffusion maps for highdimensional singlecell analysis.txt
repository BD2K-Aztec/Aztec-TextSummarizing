Bioinformatics, 31 (18), 2015, 2989—2998

doi: 10.1093/bioinformatics/btv325

Advance Access Publication Date: 21 May 2015
UngmalPaper

 

Gene expression

Diffusion maps for high-dimensional single-cell
analysis of differentiation data

Laleh Haghverdi1'2, Florian Buettner1'*'T and Fabian J. Theis1'2'*

1Institute of Computational Biology, Helmholtz Zentrum Miinchen 85764 Neuherberg, Germany and 2Department of
Mathematics, Technische Universitéit Miinchen 85748 Garching, Germany

*To whom correspondence should be addressed.

TPresent address: European Molecular Biology Laboratory, European Bioinformatics Institute (EMBL-EBI), Wellcome
Trust Genome Campus, Cambridge C310 13D, UK

Associate Editor: Ziv Bar-Joseph

Received on July 31, 2014; revised on March 25,2015; accepted on May 18,2015

Abstract

Motivation: Single—cell technologies have recently gained popularity in cellular differentiation stud—
ies regarding their ability to resolve potential heterogeneities in cell populations. Analyzing such
high—dimensional single—cell data has its own statistical and computational challenges. Popular multi—
variate approaches are based on data normalization, followed by dimension reduction and clustering
to identify subgroups. However, in the case of cellular differentiation, we would not expect clear clus—
ters to be present but instead expect the cells to follow continuous branching lineages.

Results: Here, we propose the use of diffusion maps to deal with the problem of defining differenti—
ation trajectories. We adapt this method to single—cell data by adequate choice of kernel width and
inclusion of uncertainties or missing measurement values, which enables the establishment of a
pseudotemporal ordering of single cells in a high—dimensional gene expression space. We expect
this output to reflect cell differentiation trajectories, where the data originates from intrinsic
diffusion—like dynamics. Starting from a pluripotent stage, cells move smoothly within the tran—
scriptional landscape towards more differentiated states with some stochasticity along their path.
We demonstrate the robustness of our method with respect to extrinsic noise (e.g. measurement
noise) and sampling density heterogeneities on simulated toy data as well as two single—cell
quantitative polymerase chain reaction datasets (i.e. mouse haematopoietic stem cells and mouse
embryonic stem cells) and an RNA—Seq data of human pre—implantation embryos. We show that
diffusion maps perform considerably better than Principal Component Analysis and are advanta—
geous over other techniques for non—linear dimension reduction such as t—distributed Stochastic
Neighbour Embedding for preserving the global structures and pseudotemporal ordering of cells.
Availability and implementation: The Matlab implementation of diffusion maps for single—cell data
is available at https://VW\AN.helmholtz—muenchen.de/icb/single—cell—diffusion—map.

Contact: fbuettner.phys@gmail.com, fabian.theis@helmholtz—muenchen.de

Supplementary information: Supplementary data are available at Bioinformatics online.

 

1 Introduction

The advantages of single—cell measurements to various biological re—
search fields have become obvious in recent years. One example is
the stem cell studies for which population measurements fail to

©The Author 2015. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com

 

OXFORD

reveal the properties of the heterogeneous population of cells at vari—
ous stages of development. Purifying for a certain cell type or syn-
chronizing cells is experimentally challenging. Moreover, stem cell
populations that have been functionally characterized often show

2989

9mg ‘09 1sn3nv uo sopﬁuv $01 111110;th JO Amie/xtqu 112 /§.IO'S[BU.IHO[p.IOJXO'SODBIHJOJUIOIQ/ﬁdllq 11101; popeommoq

2990

L.Haghverdi et al.

 

heterogeneity in their cellular and molecular properties (Dykstra
et al., 2007; Huang, 2009; Stingl et al., 2006). To overcome these
barriers, on the one hand researchers conduct continuous single—cell
observation using time—lapse microscopy (Park et al., 2014; Rieger
et al., 2009; Schroeder, 2011), accompanied by single-cell tracking
and analysis tools. However, this approach is still limited as the ex—
pression of very few genes (typically one to three) could be observed.
On the other hand, with the advent of new technologies, such as sin—
gle-cell qPCR (Wilhelm and Pingoud, 2003) or RNA—Seq (Chu and
Corey, 2012) and ﬂow or mass cytometry (Bandura et al., 2009;
Chattopadhyay et al., 2006), it is now possible to measure hundreds
to thousands of genes from thousands of single cells at different spe—
cific experimental time points (time—course experiments). However,
several single cells measured at the same experimental time point
may be at different developmental stages. Therefore, there is a need
for computational methods which resolve the hidden temporal order
that reﬂects the ordering of developmental stages of differentiating
cells.

While differentiation has to be regarded as a non—linear continu—
ous process (Bendall et al., 2014; Buettner and Theis, 2012), stand-
ard methods used for the analysis of high-dimensional gene
expression data are either based on linear methods such as principal
component analysis (PCA) and independent components analysis
(ICA) [e.g. used as part of the monocle algorithm (Trapnell et al.,
2014)] or they use clustering techniques that groups cells according
to specific properties. Hierarchical clustering methods as used in
SPADE (Qiu et al., 2011) and t—SNE (Van der Maaten and Hinton,
2008) as used in viSNE (Amir et al., 2013) are examples of cluster—
ing methods. However, as these methods are designed to detect dis—
crete subpopulations, they usually do not preserve the continuous
trajectories of differentiation data. A more recently proposed
algorithm Wanderlust (Bendall et al., 2014) incorporates the non—
linearity and continuity concepts but provides a pseudotemporal
ordering of cells only if the data comprise a single branch.
Furthermore, in gene expression measurement techniques, there is
usually a detection limit at which lower expression levels and non-
expressed genes are all reported at the same value. Buettner et al.
(2014) suggested the use of a censoring noise model for PCA,
whereas for the other methods it is unclear how these uncertain or
missing values are to be treated. A variety of other manifold learning
methods including (Hessian) locally linear embedding (HLLE)
(Donoho and Grimes, 2003) and Isomap (Tenenbaum et al., 2000)
exist in the machine-learning community and are discussed in detail
in the discussion and conclusion section.

Here, we propose diffusion maps (Coifman et al., 2005) as a tool
for analyzing single-cell differentiation data. Diffusion maps use a
distance metric (usually referred to as diffusion distance) conceptu—
ally relevant to how differentiation data is generated biologically, as
cells follow noisy diffusion—like dynamics in the course of taking sev—
eral differentiation lineage paths. Diffusion maps preserve the non—
linear structure of data as a continuum and are robust to noise.
Furthermore, with density normalization, diffusion maps are resist—
ant to sampling density heterogeneities and can capture rare as well
as abundant populations. As a non—linear dimension—reduction tool,
diffusion maps can be applied on single—cell omics data to perform
dimension—reduction and ordering of cells along the differentiation
path in a single step, thus providing insight to the dynamics of differ-
entiation (or any other concept with continuous dynamics). In this
article, we

° propose an adaptation of diffusion maps for the analysis of
single—cell data which is less affected by sampling density

heterogeneities and addresses the issues relating to missing values
and uncertainties of measurement,

° propose a criterion for selecting the scale parameter in a diffusion
map,

° evaluate the performance of the diffusion map and its robustness
to noise and density heterogeneities using a toy model that
mimics the dynamics of differentiation,

° apply the adapted diffusion map algorithm to two typical qPCR
and one RNA—Seq datasets and show that it captures the differ—
entiation dynamics more accurately than other algorithms.

2 Methods

2.1 Diffusion maps

Let n be the number of cells and let G be the number of genes meas—
ured for each cell. Denote the set of all measured cells by Q. We
allow each cell X to diffuse around its measured position x E RC
through an isotropic Gaussian wave function,

2 1/4 ,_ 2
Yx(x’)=(@> exp<W) <1)

The normalization of YX(x’) is such that (3000 Y§(x’)dx’ : 1. The
Gaussian width 0'2 determines the length scale over which each cell
can randomly diffuse. The transition probability from cell X to cell y
is then defined by the interference of the two wave functions YX and
Yy. One can easily show that this interference product is another
Gaussian (all prefactors cancel out):

00 _ 2
( Yx(x’)Yy(x’)dx’ =exp  (2)

Hence, we can construct the n X n Markovian transition probability
matrix P for all pairs of cells in Q as follows:

P _ 1 ex _||x—y||2 (3)
xy—Z(x) p

20'2

 

2
Z(x) : Zexp  > (4)

yEQ

At the position of each cell, Z (x) is the partition function which pro-
vides an estimate of the number of neighbours of X in a certain vol-
ume defined by 0'. Hence, it can be interpreted as the density of cells
at that proximity. Consequently, we redefine the density normalized
transition probability matrix 13 as:

ex _M
Z(x) : Z M (6)

Because we are only interested in the transition probabilities be—
tween cells and not the on—cell potentials imposed by local densities,
we set the diagonal of 13 to zero and exclude y : x from the sum in
the partition function 2. For a large enough 0', the matrix 13 defines
an ergodic Markovian diffusion process on the data and has 11
ordered eigenvalues 20 = 1 > 212...22n_1 with corresponding right
eigenvectors 1/10 . . .l/ln_1.

The t-th power of 13 will present the transition probabilities be—
tween cells in a diffusion (random walk) process of length t. Noting

9mg ‘09 1sn3nv uo sopﬁuv soq 111110;th aIo Amie/xtqu 112 /§.IO'S[BU.IHO[p.IOJXO'SODBIHJOJUIOIQ/ﬁdllq 11101; popeommoq

Diffusion maps for high-dimensional single-cell analysis

2991

 

that 13‘ has the same eigenvectors as 13, one can show that this transi—
tion probability can be represented as follows:

n—1
13,; = gift/IAXNIIAWZO’) (7)

Each row of 13‘ can be viewed as a vector, which we represent as
pt(X,  and consider as the feature representation (Shawe—Taylor
and Cristianini, 2004) for each cell X. By computing the weighted L2
distance in the feature space, the diffusion distance D? between two
cells X and y is defined as follows:

(13:2 _ Piaf

Z(z) (8)

2
D3(X,Y) = IIP‘(X, -> —pt<y, -)||1/z = Z
Z
This diffusion distance can be expressed in terms of the eigenvectors
of 13 such that:

n—1
Dax, y) = 2 WW) — nixynz <9)
i=1

The corresponding eigenvector to the largest eigenvalue 20 is a con—
stant vector 1/10 : 1]. Therefore, it only contributes a zero term to D3
and is excluded from the spectral decomposition of D? in
Equation (9). That means the Euclidean distance of the cells in the
firstleigenvector space represents an approximation of their diffu-
sion distance D%. Moreover, the eigenvalues of 13 determine the dif—
fusion coefficients in the direction of the corresponding eigenvector.
As real data usually lie on a lower dimensional manifold than the en-
tire dimensions of space G, these diffusion coefficients drop to a
noise level other than a few first (I) prominent directions. Therefore,
if there is a significant gap between the l—th and (l —l— 1)—th eigen—
value, the sum up to the l—th term usually determines a good ap—
proximation for diffusion distances. Thus, for data visualization we
select these eigenvectors and instead of the mathematical notation
III, we call them diffusion components (DCs).

Figure 1 presents a summary of diffusion map embedding.
Each cell is represented by a Gaussian wave function in the G—
dimensional gene space. On an adequate Gaussian width, the wave
functions of neighbouring cells interfere with each other and form
the diffusion paths along the (non-linear) data manifold in the high-
dimensional space. Hence, we construct the Markovian transition
probability matrix, the elements of which are the transition proba—
bilities between all pairs of cells. The eigenfunctions of the

53an 1.........gEne IE
cell 1 i

I
nwmw

    

High r, .'-' High FDF
Impression I

cell 11

 

_ lexpmalan

cell 1

ILu-w F'Df “(I "

 

Markovian transition probability matrix (DC1 and DC2) are then
used for low—dimensional representation and visualization of data.

2.2 Accounting for missing and uncertain values

The data generated from qPCR, RNA—Seq or cytometry experiments
are very often prone to imperfections such as missing values or de—
tection limit thresholds. It is important to properly treat such uncer—
tainties of data (Buettner et al., 2014; McDavid et al., 2013). Our
probabilistic interpretation of diffusion maps allows a straightfor—
ward mechanism of handling missing and uncertain data measure—
ments. First, we have to decompose the kernel into G components.
Then, instead of a Gaussian, we can use any other wave function
that best represents our prior knowledge on the probability distribu—
tion of the missing or uncertain values, which then should be
square—normalized to ensure equal contribution of the G compo—
nents. For example, for missing values and non—detects (measure—
ments below the limit of detection), one might choose a uniform
distribution over the whole range of possible values.

In the following, we describe how to account for the uncertainty
of non—detect measurements in qPCR data. The statistical subtleties
of non—detect values in qPCR experiments have been systematically
studied by McDavid et al. (2013) for univariate models. In addition,
for a multivariate PCA analysis, Buettner et al. (2014) proposed that
different kernels be allowed in each dimension. For the diffusion
map implementation, we assume any value between the detection
limit (M0) and a completely non—expressed (off) state of genes valued
as M1, is equally possible for the non—detect measurements.
Considering the kernel width formulated in the diffusion map wave
functions, we assume an indicator wave function between M0 — 0'
and M1 —1— 0' normalized by (M1 — M0 —1— 20)_1/2
calculate three different kinds of interference of wave functions:

. Thus, we have to

The interference of two cells with definite measured values for
gene g is the standard Gaussian kernel (see Section 2.1):

00
2
/ / / _ (xg _ yg)
J Yx(xg)Yy(xg)dxg — exp —2—0_2 ,
—00
the interference of two cells both with non—detect values for gene g
is 1 (due to the square—normalization constraint):

00

J vxocjg)v,(xjg)dxjg = 1,
—00
D
cell 1...  ...r.ell n
C THE 1
type 2
type 3
true 4

N
H I “Hi-Mn...“ "

'Htgh PDF

D131
ILn-w FDF

Fig. 1. Schematic overview of diffusion maps embedding. (A) The n x G matrix representation of single-cell data consisting of four different cell types. The last
column on the right side of the matrix (colour band) indicates the cell type for each cell. (B) Representation of each cell by a Gaussian in the G—dimensional gene
space. Diffusion paths (continuous paths with relatively high-probability density) form on the data manifold as a result of interference of the Gaussians. The
Probability density function is shown in the heat map. (C) The n x n Markovian transition probability matrix. (D) Data embedding on the first two eigenvectors of
the Markovian transition matrix (DC1 and DC2) which correspond to the largest diffusion coefficients of the data manifold. The embedding shows the continuous
flow of cells across four cell types; however, it does not suggest the putative time direction

91% ‘09 1sn3nv uo sopﬁuv soq 111110;th aIo Amie/xtqu 112 /§.IO'S[BU.IHO[p.IOJXO'SOTlBIIIJOJUTOTQ/ﬁdllq 11101; popeommoq

2992

L.Haghverdi et al.

 

the interference of a missing (non—detect) value to a definite meas—
ured value xg is:

MW 1 2 (x/ —x)
l M——M+2(2)1/4€Xp<g2g dx’g
Mo—a 1 0 0' 7T0" 0'

1 n02 1/4
: 1/M1 — M0 + 20— 

.(erfc  _ erfc  
0 0

For data with missing or uncertain values, we need to check the pair—
wise interference of the wave functions for each gene. The computa—
tion time is thus proportional to the number of genes G for a fixed
number of cells 11. Therefore, it might be preferable (especially in the
case of large G) to choose the wave function of the missing (or un-
certain) value also in the form of a Gaussian such that the multipli—
cation of the G components of interference can be expressed as the
sum of the exponents and the exponentiation step can be performed
only once at the end of the algorithm for computation of the transi—
tion matrix. An implementation of this fast version of the censoring
algorithm is also provided in the codes package. Supplementary
Figure Sl provides an illustration of our approach for accounting
for missing and uncertain values.

2.3 Determination of Gaussian kernel width

The parameter 0' in Equation (1) determines the scale at which we
visualize the data. If 0' is extremely small, most elements of the tran—
sition probability matrix P will tend to be zero and we do not get an
overall view of a connected graph structure. In fact, when 0' is too
small, the number of degenerate eigenvectors with eigenvalue equal
to one, indicates the number of disconnected segments that P defines
on the data. For too large 0' however, the transition probability sen—
sitivity on the distance between the cells blurs. There is a certain
range of 0' variations for which P defines an ergodic diffusion pro-
cess on the data as a connected graph and still the diffusion distances
between the cells are informative.

The un-normalized density at each cell (Z(x) in Equation (3)) is
proportional to the number of cells in a fixed volume in its neigh-
bourhood and depends on a. At scales of 0' close to zero, cells do not
have any neighbours and their average density is 1 (because of the ls
on the diagonal of P). By increasing 0', the average density gradually
increases as more cells find other cells in their neighbourhood. There
is a density saturation point where 0' reaches the system size and all
cells form part of one neighbourhood. At this point, for every cell
X E Q, the density Z(x) will be equal to the entire system size 11.

Assuming that the density gradient is not extremely sharp along
the data manifold, the number of neighbours of cell X in the neigh-
bourhood 0' will be proportional to the volume of a hypersphere of

radius 0', hence:
Z(x) o< Calm”) (10)

where d(x, 0') is the dimensionality of data manifold at the position
of cell X and at the scale a. By differentiating both sides with respect
to log (a), we find that the average dimensionality of the manifold
can be estimated by the slope of the log—log plot of the number of
neighbours versus the length scale:

W». = —8<l‘gg10§((:(»x (11)

where we compute the average of log (Z(x)) with consideration of
density heterogeneities such that:

2003 (Z(x)) ‘ (1/Z(x)))
lo Z = x
< g1 1x)», BUM

x

 

(12)

It is worth noting that this average density underestimates the real
dimensionality of the structure due to the contribution of the cells
lying on the surface of the manifold. However, this does not affect
our heuristic since the variation of (d) is our main interest rather
than (d) itself.

Each time (d) reaches its maximum and starts to decrease, one
can deduce that an intrinsically lower dimensional structure is
emerging from the noise-enriched distributed cells in the original
high-dimensional space. Therefore several characteristic length
scales of the data manifold (i.e. width of its linear parts, radius of its
curves, etc.) give rise to several local maxima in  Such character—
istic scales indeed make our choice for the Gaussian width 0' since
they indicate the scale at which the Euclidean distances used in the
Gaussian kernel are sensible in an assumed Euclidean tangent space
to the manifold. Although Euclidean distances are also valid for
smaller as than the characteristic length scale, they are not recom—
mended because smaller kernel width would mean less connectivity
in the cells graph which in turn results in an increased sensitivity to
noise. Supplementary Figures S2 and S3 illustrate the resulting diffu—
sion map on optimal kernel width and several other kernel widths
values for a U—shaped toy data. Also the performance of diffusion
map at the optimal kernel width when there is no distinguishable
pattern in the data (e.g. normally distributed data in all dimensions
or sparse data) is illustrated in the Supplementary Figure S4.

2.4 Toy model for differentiation

As toggle switches are known to play a role in differentiation
branching processes (Orkin and Zon, 2008), we designed a regula—
tory network of three pairs of toggle genes to evaluate the perform—
ance of our method on a toy dataset that mimics a differentiation
tree (Krumsiek et al., 2011). Assuming a genetic regulatory module
as presented in Figure 2A, we simulated the stochastic differenti—
ation process by the Gillespie algorithm (Gillespie, 1977) with the
reactions as shown in Figure 2B and C (Strasser et al., 2012). More
details about the chemical reactions and the reaction rates used in
the Gillespie algorithm model can be found in the supplement
(Supplementary Figs SSA and B). Genes G1 and G2 are antagonistic
to each other through an inhibiting Hill function. Therefore, starting
from an initial undifferentiated state where G1 and G2 are both in a
very low expression level, single samples may end up in either of the
states where G1 or G2 is exclusively expressed. At this stage, the
next pair of toggle genes in the differentiation hierarchy is activated
(through an activating binding Hill function), which are again an-
tagonistic to each other. This model generates four different types of
fully differentiated cells in the six—dimensional space of genes.

To establish a steady state in the cell population, once a cell hits
the end of each branch, we remove it from the population and initi-
ate a new cell at the original undifferentiated state. This approach
maintains the population size of cells. After an extended simulation
run, the steady state of the population is established and resembles
the haemostatic state of (e.g. hematopoietic) stem cells in natural
organisms.

We sampled cells from this toy model in two different sets, a bal—
anced toy dataset, wherein 600 samples serve as a snapshot of the
steady state of the system with no additional extrinsic noise, and an

91% ‘09 1sn3nv uo sopﬁuv soq ‘1211110111123 10 Amie/xtqu 112 /§.IO'SIBU.IT10[p.IOJXO'SOTlBIIIJOJUTOTCI/ﬁdllq 111011 pop1201umoq

Diffusion maps for high-dimensional single-cell analysis

2993

 

A B

'1‘; . “'r'
:95 ‘4.- Protem; —> ET

1 1

 

—' _ .
(31 I—  flig' — Ike, {Ill-r_1t§_li11r._.}hul
1;. _
c  m . '1'
I Q —> Protem, 4.1 121
c3. —'._ 64 Ga e.— G. / {,1 1 1
fir; = " E. 1 _
Gi '— Gr 11+  1+ {—,.,,f;:_.’;,,.,, 

Fig. 2. (A) Toy model of a differentiation regulatory network consisting of three pairs of antagonistic genes simulated by the Gillespie algorithm. The arrows
show activation or inhibition interactions between genes. The toy model employs two classes of gene regulation: (B) G,- is connected to an inhibitor, its production
rate or; is proportional to a Hill function of the concentration of the inhibitor Proteinp (C) G,- is connected to an inhibitor G,-/ and an activator Gin, its production rate
or; is proportional to product of an inhibiting and an activating Hill function. The degradation rate 12 is constant for all proteins

imbalanced toy dataset, wherein 1800 sample are derived from a
non—steady—state density distribution with heavier sampling density
on the GTG;r branch. We also added an extrinsic Gaussian noise
with a variance of 25% maximum expression to each gene. The
gene expression plot for a simulated single cell as it proceeds from
the initial pluripotent state to a fully differentiated state is presented
in the supplement (Supplementary Figs S5 C and D).

2.5 Experimental data

2.5.1 qPCR data of mouse haematopoietic stem cells.

We calculated a diffusion map embedding for the haematopoietic
and progenitor stem cells dataset from Moignard et al. (2013). In this
experiment, 597 cells from five different haematopoietic cell types,
namely, haematopoietic stem cell (HSC), lymphoid-primed multipo-
tent progenitor (LMPP), megakaryocyte—erythroid progenitor
(PreMegE), common lymphoid progenitor (CLP) and granulocyte—
monocyte progenitor (GMP) were gated by Fluorescence—activated
cell sorting (FACS) sorting. Single—cell qPCR expression level meas—
urement was then performed for 24 genes. Housekeeping genes were
only used for cell—cycle normalization, where for each cell, all expres—
sion values were divided by the average expression of its housekeep—
ing genes. Furthermore we excluded the five housekeeping genes, as
well as c-Kit, which is a stem—cell receptor factor expressed on the
surface of all analyzed cells, from the diffusion map analysis.

2.5.2 qPCR data of mouse stem cells from zygote to blastocyst

To understand the earliest cell fate decision in a developing mouse
embryo, Guo et al. (2010) conducted a qPCR experiment for
48 genes in seven different developmental time points. The gene ex—
pression levels were normalized to the endogenous controls Actb
and Gapd/o. The authors also identified four cell types, namely,
inner cell mass (ICM), trophectoderm (TE), primitive endoderm
(PE) and epiblast (EPI) using characteristic markers. The total num—
ber of single cells used in the diffusion map analysis was 429.

2.5.3 RNA-Seq of human preimplantation embryos

For the dataset published by Yan et al. (2013), RNA—Seq analysis
was performed on 90 individual cells from 20 oocytes and embryos.
The sequenced embryos were picked at seven crucial stages of pre—
implantation: metaphase II oocyte, zygote, 2—cell, 4—cell, 8—cell, mor—
ula and late blastocyst at the hatching stage.

3 Results

In this section, we evaluate the performance of the diffusion map on
each of the datasets described in the Methods section and compare it

to the performance of two other dimension—reduction methods PCA
and t—SNE. Data embeddings with several other methods including
ICA, SPADE, kernel-PCA (Scholkopf et al., 1998), isomap and
Hessian Locally linear embedding (HLLE) are provided in the
Supplementary Figures S16—S20.

3.1 Diffusion maps cope with high noise level and
sampling density heterogeneity for toy data

3.1.1 Gaussian width determination of the toy data

We demonstrate the heuristic determination of 0' on balanced and
imbalanced toy datasets. The average dimensionality of the structure
of some chosen characteristic length scale can be estimated by
Equation (11). Figure 3 shows the average dimensionality (d) for
balanced toy data (red) and imbalanced toy data (black) as a func—
tion of log (a). The balanced set exhibits two maxima. The first one
arises at the length scale of the thickness of the differentiation
branches which include only a few cells. At this 0' several subpopula—
tions form at the more densely populated stages of the steady state.
The second maximum appears at a larger length scale when several
subpopulations become visible to each other and the continuous
branches form. We picked the 0' at the second maximum for visual—
ization (data visualization at the first maximum is provided in the
Supplementary Fig. S6). For the imbalanced set, however, due to the
high noise level, the first maximum vanished and we only detected
one maximum which we then used for the visualization.

3.1.2 Performance of the diffusion map on the toy data as compared
to the other methods

Definition of diffusion distance (Equation (8)) based on probability
of transition between cells through several paths renders diffusion
maps very robust to noise. Figure 4 presents a comparison between
the performance of the diffusion map and the other two methods
PCA and t—SNE on the balanced toy dataset. The eigenvalues of the
diffusion map (Fig. 4D) suggest that there are four leading dimen—
sions that explain the data structure and the higher dimensions pre-
sent noise rather than the intrinsic structure of the data manifold.
The complete set of two—by—two projections up to the fourth eigen—
vector can be found in the supplementary Figure S7. PCA of this
dataset generated results that were similar to the diffusion map,
where all four branches of the data could be distinguished.
However, standard t—SNE did not preserve the data structure con—
tinuity. Visualization using t—SNE with non—standard perplexity val—
ues are also provided in the Supplementary Figure S8. To determine
how additional extrinsic noise and density heterogeneities affect
each method, we also applied the three methods on imbalanced toy

9mg ‘09 1sn8nv uo sopﬁuv soq ‘1211110111123 10 Amie/xtqu 112 /§.IO'SIBU.IHO[p.IOJXO'SOTlBIIIJOJUTOTCI/ﬁdllq 111011 pop1201umoq

2994

L.Haghverdi et al.

 

data (Fig. 5). The eigenvalues plot of the diffusion map in this figure
suggests the same order of significance for the third and fourth
eigenvectors as 24 almost equals 23 and that the higher order eigen-
functions mostly present noise. We chose two projections
(DC, DC2, and DC3) and (DC1, DC2, and DC4) for illustration
in Figure 5. The complete set of two—by—two projection can be found
in the Supplementary Figure S9. From Figure 5A, one can infer the
same size for all four branches of differentiation despite different
sampling densities. This figure also suggests that the diffusion map
clearly shows four branches of the imbalanced toy data, whereas
PCA and t—SNE produce noisier visualization and represent the two
rarer branches as smaller. For additional t—SNE visualizations with
non-standard perplexity values for the imbalanced toy data see
Supplementary Figure S10.

3.1.3 Refinement of the transition matrix by density normalization,
zero diagonal and accounting for missing values

In order to adapt the standard diffusion map algorithm to the prop-
erties of single—cell gene expression parameters, we refined the tran—
sition matrix in different ways. First, we set the diagonal of the
transition matrix to zero (Equation (5)) since the (non—zero version)
diagonal carries information about local sampling densities. Unlike
many other applications where the information about local densities
has some value, the sampling density in the context of single-cell
data is somewhat arbitrary (e.g. only specific cell types are moni-
tored, different proliferation rates in several stages of differentiation
alters the sampling density, outlier cells show lower density, etc.).
For a demonstration of how zero diagonal improves the quality of
the diffusion map see Supplementary Figure S11. Second, we refined
the Markovian transition matrix by density normalization
(Equation (5 )) since the number of diffusion paths between two cells
depends on the density of cells connecting them and more densely
sampled regions of the data would seem to have smaller diffusion
distance to each other on a diffusion map without density

 

5

—o— balanced to}; data

_._ imbalanced my data

<d>

 

 

 

 

Iog10(o)

Fig. 3. The average dimensionality of the data (d) as a function of |og10(0') for
the balanced and imbalanced toy datasets

A B
. - EVE-i '
GE GE 13113.1! 432' '33. I.
‘1 I, i 1
M __._..... m -
rap" U :-
a a .. ME:
I Ed'GB'
EE‘IGE. i.
_ :32‘65‘
DEE pg:   _' _..
Dcl F'C'l

normalization. Supplementary Figure S12 demonstrates how density
normalization improves the quality of the diffusion map. The third
refinement that we used in our implementation of diffusion maps is
accounting for missing and non—detect values (Section 2.2).
Generally speaking as the proportion of missing and non—detect val—
ues increases, there is a decrease in the quality of the diffusion map.
However the magnitude of this effect depends highly on the archi-
tecture of the gene regulatory network and the role of the corres—
ponding gene in the network. For example, for a toggle switch, low
expression of a gene would always imply high expression of the
other gene. Therefore, increasing the detection threshold (i.e.
increasing number of non—detects) does not have a major inﬂuence
on the analysis, as the information is still present in the other gene
with high expression. We evaluate the performance of diffusion map
in several proportions of missing values for the balanced toy data in
Supplementary Figure S13.

3.2 Diffusion map allows identification of differentiation
trajectories on experimental data

3.2.1 Performance on haematopoietic stem cells qPCR data as
compared to the other methods

The diffusion map embedding for the haematopoietic stem cells
(Fig. 6A) indicates a major branching of HSCs to PreMegE and
LMPP cell types and a further branching of LMPPs to CLP and GMP
cells. The branching structures are less clear in the PCA plot (Fig. 6B).
Moreover, PCA produces artificial planes of data in the embedding
because of the non—detect measurements in the qPCR data. The t—SNE
plot (Fig. 6C) almost separated the cell types (except for LMPPs) into
different clusters. However, the notion of temporal progress is less
clear compared to the diffusion map embedding. In addition, since
uncertainties in the values of non—detects were not considered, a wid—
ening within the clusters is observed. Detailed visualization using the
three methods and the Gaussian width determination for diffusion
map embedding are provided in the Supplementary Figure S14. The
ordered eigenvalues plot for the diffusion map and PCA are shown in
Figures 6D and E. The ordered eigenvalues plot of the diffusion map
suggests that there is no clear separation between the eigenvectors of
the diffusion map that captures the intrinsic low—dimensional data
manifold and those characterizing noise for this dataset. However,
what makes the diffusion map embedding of this dataset more plaus—
ible is the concordance between the branching structure as suggested
by the diffusion map and the recently established hierarchy of haem-
atopoietic cell types (Arinobu et al., 2007; Moignard et al., 2013)
illustrated in Figure 6F.

3.2.2 Performance of the diffusion map on mouse embryonic stem
cells qPCR data as compared to the other methods

For the mouse embryonic stem cells, diffusion map visualization
using the first three eigenvectors indicated a branching at the early

 

131*133'
11;
m .
Z .
eras H? 5:“ 1‘"
“"' 131m
3...
I I.I.I’ ? I'-.
1 GE'EB' 1*
Ian '3 - a
L-SNE2 I-SHEI I

Fig. 4. Visualization of the balanced toy data on (A) the first three eigenvectors of the diffusion map, (B) PCA and (C) t-SNE. The colours (heat map of blue to red)
indicate the maximum expression among all genes. Eigenvalues sorted in decreasing order for (D) diffusion map and (E) PCA

9mg ‘09 1sn8nv uo sojoﬁuv s01 ‘1211110111123 10 Amie/xtqu 112 /§.IO'SIBU.IHO[p.IOJXO'SOTlBIIIJOJUTOTCI/ﬁdllq 111011 pop1201umoq

Diffusion maps for high-dimensional single-cell analysis

2995

 

A G
'3'? ever
‘n
L} I '_ All!
.' 1 "- ' P]
I - I. IL I 1'
Fr .d. I- an E
S t: r ' 1.‘ 1.?"
a .-’
G1+m+ .f
2 [11:2  .g
P132
DCI
B D
GE‘GS‘

FE.“

 

DCl

 

t-SHE3

 

Pm t-SNEE "  t-SHEI

 

Fig. 5. Visualization of the imbalanced toy data on (A) the first three eigenvectors of the diffusion map, (B) the first, second and fourth eigenvectors of the diffusion
map, (C) the first three components of the PCA (D) the first, second and fourth components of PCA and (E) t-SNE. The colours (heat map of blue to red) indicate

the maximum expression among all genes. Eigenvalues sorted in a decreasing order for (F) diffusion map and (G) PCA

A B

or;
._
1.1m”
_£-.I_. .
-.: 4;“
.1."
tat-j“
‘1- "'
In: I'-
: ﬂ
. I "II. - -
P133
I.

 

C

339" 1* .. :11
m  rag-11.1
E: ' H'fﬂ': I I5;

LMPP
PreMegE

Fig. 6. Visualization of haematopoietic stem cells data on the first three eigenvectors of (A) diffusion map, (B) PCA and (C) t-SNE. Eigenvalues sorted in a decreas-
ing order for (D) diffusion map and (E) PCA. (F) The hierarchy of haematopoietic cell types

16—cell stage to the ICM and TE cell types, and further branching of
the ICM at the late 32—cell stage into the EPI and PE (Fig. 7A). The
branching structure is unclear in the PCA and t—SNE plots (Figs 7B
and C). The ordered eigenvalues plot for the diffusion map and PCA
are shown in Figures 7D and 7E. The branching structure indicated
by the diffusion map is in agreement with the results of previous
studies on this dataset (Buettner and Theis, 2012; Guo et al., 2010),
which suggests a branching into the two cell types, ICM and TE,
after the 8—cell stage and further branching of the ICM into EPI and
PE cells (Fig. 7F). More information on Gaussian width determin—
ation and two—dimensional projections of data on each pair of the
first to fourth eigenvectors of the diffusion map are provided in the
Supplementary Figure S15.

3.2.3 Performance on human pre-implantation embryos RNA-Seq
data compared with other methods

The performance of the diffusion map on this RNA—Seq dataset is
comparable (although slightly sharper with respect to pseudotime
ordering) to the other two methods, PCA and t—SNE (Fig. 8). The
number of single cells measured in RNA—Seq is currently limited due

to high sequencing costs. A low number of sampled cells could not
meaningfully indicate a complex structure. Hence, PCA and t—SNE
performance is almost as good as that of the diffusion map.
However, with the expected development of new and cheaper RNA
sequencing technologies, we propose a diffusion map that could be
used as a powerful dimension—reduction tool the computation time
of which is only linear with respect to the number of genes.

4 Discussion and conclusion

In this manuscript, we have demonstrated the capabilities of diffu—
sion maps for the analysis of continuous dynamic processes, in par—
ticular, differentiation data in a toy dataset and a few experimental
datasets. Using a biologically relevant distance metric (i.e. diffusion
distance), the adapted diffusion map method outperforms other di—
mension—reduction methods in pseudotemporal ordering of cells
along the differentiation paths and could capture the expected dif—
ferentiation structure in all cases. Table 1 provides a general com—
parison of several dimension—reduction methods, detailing
capabilities and limitations in application to single—cell omics data.

91% ‘09 1sn8nv uo sojoﬁuv s01 ‘1211110111123 10 Amie/xtqu 112 /§.IO'SIBU.IHO[p.IOJXO'SOTlBIIIJOJUTOTCI/ﬁdllq 111011 pop1201umoq

 

2996 L.Haghverdi et al.
A it” B c are
E- rm. ' "_'=" ‘-: _.

III‘I -r _.‘I 1 'ru. ['3 '- ‘I I “II-‘_ ' .lh. .
“H is E -  :  .1? - m 1. am-
I'lil‘: '— I :1 I 11. i Z
‘1‘ rink: ' ‘ r'. t “a: '5‘?
r: " 1 "7"
13:1 : a .
_ _ __—— T“  '--———________ _ t-SNEI
——— - P132 5‘ - Pm ——-_____._.
131:2 ‘ * t—surz
' 2- cell
D E F 9
* 4- cell 1 anti
B_ CE" uJ“ 15:: 6
16— cell A" ‘15 a
0.1 ' cal:
"‘ — m
32 cell a m 20 on m m
' 134- cell i

Fig. 7 Visualization of mouse embryonic stem cells on (A) the first three eigenvectors of diffusion map, (B) PCA and (C) t-SNE. Eigenvalues sorted in a decreasing
order for (D) diffusion map and (E) PCA. (F) The hierarchy of cells for mouse embryonic stem cells

A B

[JCS

or: -._._.._——-—-  ——_______
121:1 F'Cl

.7 PC:

c I _ Dmﬂe D M
"1 ' Zygate '1' M A.
{I
g 'I 2— cell E l, 5 1D
|
13 q“ 4- cell ,9“.
El— call
+ Morulae “I m
aﬁ‘t
'- ‘I _ _ - Late.l:i| .,
t—SNE]. '— — — U 5 “1
t—SNE2 I

Fig. 8. Visualization of human preimplantation embryos data on (A) the first three eigenvectors of the diffusion map, (B) PCA and (C) t-SNE. Eigenvalues sorted in

a decreasing order for (D) the diffusion map and (E) PCA

Among these methods, isomap and (H)LLE have not been applied
for the analysis of single—cell differentiation data and pseudotime
ordering so far, mainly because they do not meet the specific re—
quirements for the analysis of such data including capability to han—
dle high levels of technical noise, sampling density heterogeneities,
detection limits and missing values. Supplementary Figures S19 and
S20 in the supplement demonstrate the poor performance of these
methods for finding the differentiation manifold in presence of noise
and density heterogeneity for our toy dataset as well as the three ex—
perimental single—cell datasets. For any dataset, it is important to
consider the advantages and disadvantages of each method with re—
spect to the data properties and the purpose of the analysis, in order
to make a suitable choice for applying to that dataset.

In our diffusion maps implementation, by performing density
normalization and setting the diagonal of the transition probability
matrix to zero, we propose a mapping technique wherein the close—
ness of cells in the diffusion metric is unaffected by density heteroge—
neities in data sampling (see Supplementary Figs S9 and S10). This
feature can be crucial for the detection of rare populations, which is
one of the main challenges in the analysis of differentiation data.

By breaking the diffusion kernel (Mohri et al., 2012) to its multi-
plicand wave functions, we also propose a method in accommodat—
ing the uncertainties of measurement and missing values into the
wave function. Consequently, we have successfully addressed uncer—
tainties in the value of non—detects in qPCR data.

Tuning the scale parameter 0' is also important for generating in-
sights into the structure of the data, for which we proposed a criter—
ion on the basis of the characteristic length scales of the data
manifold. Because of computational limitations, for our criterion we

compute the average intrinsic dimensionality and hence the average
characteristic length scale. However, when density heterogeneities
are extremely large, or the data manifold has many sharp changes
and several scales, a single 0' may not provide a globally optimal
scale for data embedding. Therefore, implementation of an efficient
and cost—effective method for several locally valid as determinations,
instead of a single global value is of interest.

It is worth noting that the mathematical ergodicity in diffusion
maps reached by adequate kernel width selection does not necessar—
ily imply biological ergodicity. If there appears a trace of transitory
cells between two clusters, we conclude the two clusters are also bio—
logically connected to each other in an ergodic sense. However this
trace might be not present if the transition is too fast or switch—like
abrupt, so that no transitory cells have been caught in the finite set
of sampled cells of snapshot data. Thus it has to be proven with
dedicated biological experiments (e.g. as used by Buganim et al.
(2012) and Takahashi and Yamanaka (2006)) whether the data is
biologically ergodic or not.

A possible strategy for enhancing the capacity of capturing de—
tails of the structure of rare populations using diffusion maps is to
limit the transition possibility of each cell only to its closest neigh—
bours. In this scenario, we could render the diffusion map more local
by building the transition matrix P in Equation (6) for k nearest
neighbours only. This method, however, might end up with several
disconnected sub—graphs of cells when the sampling density along
the intrinsic data manifold is extremely heterogeneous.
Furthermore, P (without the row normalization) will not be sym—
metric any more and we cannot ensure real eigenvalues for the tran—
sition probability matrix. However, as long as the graph is

91% ‘09 1sn8nv uo sojoﬁuv s01 ‘1211110111123 10 Amie/xtqu 112 /§.IO'SIBU.IHO[p.IOJXO'SOTlBIIIJOJUTOTCI/ﬁdllq 111011 pop1201umoq

2997

Diffusion maps for high-dimensional single-cell analysis

 

00:50:00: 002 38n30024320380004320:H:Bm.0mm\ 2 C0722? 04 0:50:55. Pom >238 0: >522 mo. N05

220222: 220 033 wo 52222022 06202 033 2 3a

 

56:36:82
58:20 32w
020: 30 00:0

 

-moa n320222: 2202520322 $222020 8:223 :08223 Good 92:
320 20:20:00 3223 REoM +\| + 20v + :0 2:250 +\++ R320 Ro::-:0 Z $23320 Rhoon R R 22200 :22:th
m232wm 2503320:
202:: A020: “323:
B2 n320222: 2503320: 30 :2R2320o AMQONV $220
320 20:20:00 “323: 30 .02 +\| + I 22232: |\| R320 Ro::-:0 Z 23:: 38320? 02w 030:0Q MAAAEV
moﬁowoom
250:2 22:: 2503320: 3222020 8:223 2830% 800$
w :0 020: 304 “$23: 30 .02 +\| + l :0 2:250 +\| R320 Ro::-:0 Z $23320 Rhoon R R 2:33:02; 92:02
22:8: 22:8: was :28 $3288? $3: <0:
“29,20: 2R2w~2m 03: :0 220909 +\+ + 9N: R 3:325: + :0 220909 |\+ R320 23:23:02 20033:: 30::0M R E 202032 RaoM
w220:0w0:803
>2
2:20 32w 020:
30 00:08:: AmOONv
£m:0:w ERR oo:wR3 :82E 32w
.92 0: m2:8m20 b22393 |\+ + | Qm :0 N ++ E. R0: 2323:073 :225mo:\:2822< 5sz :20 :w> mZWH
20320 30:: m2:
ANVNVOM 30 .0: 302$Q- R32m -22? 25:22::
20320 30 .0: 58:20 333% CREE $222220 23::
30233 A020: 304 58:20 3:20- +\+ | | QN +\| 32w R004 23:23:02 30232020323: 3 HONV .3 .3 20 mQ<mm
$028 30 .0:
250:2 noowmm :2R2:0wm:w:
-33 82 23:5 0:02 +\| + I 22232: |\+ R320 23:5 R:0m03::0 Snood 0:0Hm <03
oowmm3sm AEQN $222020 :2R2:0wm:wb
220 23:5 0:073 +\| + 9N: R 3:325: + :0 220909 |\+ R320 23:5 R:0m03::0 Amway m2RﬁoE <0m
32:23:00 220208: m2200320 w22o:ow0:803
280::me w2moo2 200-2w2m mmosR> 22:00 :03 32000: 52222020: 0: 2023322 Ro::-:0:
0022:0223 “mom w2::rw \m2bum20 300M -::\m2m22 32:23 223 30 .0 Z mmo::w:30m Baosbm 2324 32200332 00:0:20m

 

co_Ro__qu $20 82:0 __oo-o_mc_m US 303 of E mEchmR co_Ho:UoL-co_mcoE_0 _Eo>om U6 c0mtquoU .F 230...

2998

L.Haghverdi et al.

 

connected and eigenvalues are real, we can benefit from a more lo-
cally detailed map.

One caveat in the current version of diffusion map is the n2 x G
computation time which can be prohibitive for large cell numbers
(> 104) as generated from cytometry experiments. Choosing the la
nearest neighbours version of diffusion map can therefore be a solu—
tion to this problem. Diffusion distances are based on a robust con—
nectivity measure between cells which is calculated over all possible
paths of a certain length between the cells. Thus, a diffusion mapping
obtained by accounting for a smaller fraction of all possible paths
(namely those going through each cells’ nearest neighbours) can still
provide a good approximation of the diffusion distance between the
cells and yet avoid computing all n2 elements of the transition prob-
ability matrix. With such modifications, diffusion maps prevail as a
promising method for the analysis of large cell numbers omics data.

Another issue is the number of embedding dimensions. The num-
ber of significant dimensions of the diffusion map is determined
where a remarkable gap occurs in its sorted eigenvalues plot. This is
not intrinsically bound to the conventional visualizable dimensions
two or three. In contrast, for some other methods such as t—SNE,
one can pre—determine the number of visualization dimensions for
the embedding optimization to two or three dimensions.

We conclude that diffusion maps are appropriate and powerful
for the dimension—reduction of single—cell qPCR and RNA-Seq cell dif-
ferentiation data as they are able to handle high noise levels, sampling
density heterogeneities, and missing and uncertain values. As a result
diffusion maps can organize single cells along the non—linear and com-
plex branches of differentiation, maintain the global structure of the
differentiation dynamics and detect rare populations as well.

Acknowledgements

We thank Michael Strasser (Institute for Computational Biology, Helmholtz
Centre Munich), Victoria Moignard (Cambridge Institute of Medical
Research), Berthold Goettgens (Cambridge Institute of Medical Research)
and Mauro Maggioni (Department of Mathematics, Duke University) for
helpful advice and discussions.

Funding

This study has been funded by The Bavarian Research Network for
Molecular Biosystems (BioSysNet) and the European Research Council (ERC
starting grant LatentCauses).

Conﬂict of Interest: none declared.

References

Amir,E.-a. D. et al. (2013). viSNE enables Visualization of high dimensional
single-cell data and reveals phenotypic heterogeneity of leukemia. Nat.
Biotechnol., 31, 545—552.

Arinobu,Y. et al. (2007). Reciprocal activation of GATA-l and PU. 1 marks
initial speciﬁcation of hematopoietic stem cells into myeloerythroid and
myelolymphoid lineages. Cell Stem Cell, 1, 416—427.

Bandura,D.R. et al. (2009). Mass cytometry: technique for real time single cell
multitarget immunoassay based on inductively coupled plasma time-of-
ﬂight mass spectrometry. Anal. Chem, 81, 6 813—6 822.

Bendall,S.C. et al. (2014). Single-cell trajectory detection uncovers progression
and regulatory coordination in human B cell development. Cell, 157, 714—
725.

Buettner,F. and Theis,F.]. (2012). A novel approach for resolving differences
in single-cell gene expression patterns from zygote to blastocyst.
Bioinformatics, 28, i626—i632.

Buettner,F. et al. (2014). Probabilistic PCA of censored data: accounting for
uncertainties in the Visualisation of high-throughput single-cell qPCR data.
Bioinformatics.

Buganim,Y. et al. (2012). Single-cell expression analyses during cellular
reprogramming reveal an early stochastic and a late hierarchic phase. Cell,
150, 1209—1222.

Chattopadhyay,P.K. et al. (2006). Quantum dot semiconductor nanocrystals
for immunophenotyping by polychromatic ﬂow cytometry. Nat. Med., 12,
972—977.

Chu,Y. and Corey,D.R. (2012). RNA sequencing: platform selection, experi-
mental design, and data interpretation. Nucleic Acid Therapeutics, 22, 271—
274.

Coifman,R.R. et al. (2005). Geometric diffusions as a tool for harmonic ana-
lysis and structure deﬁnition of data: Diffusion maps. Proc. Natl. Acad. Sci.
USA, 102, 7426—7431.

Donoho,D.L. and Grimes,C. (2003). Hessian eigenmaps: Locally linear
embedding techniques for high-dimensional data. Proc. Natl. Acad. Sci.
USA, 100, 5591—5596.

Dykstra,B. et al. (2007). Long-term propagation of distinct hematopoietic dif-
ferentiation programs in Vivo. Cell Stem Cell, 1, 218—229.

Gillespie,D.T. (1977). Exact stochastic simulation of coupled chemical reac-
tions.]. Phys. Chem., 81, 2340—2361.

Guo,G. et al. (2010). Resolution of cell fate decisions revealed by single-cell
gene expression analysis from zygote to blastocyst. Dev. Cell, 18, 675—6 85 .
Huang,S. (2009). Non-genetic heterogeneity of cells in development: more

than just noise. Development, 136, 385 3—3862.

Krumsiek,]. et al. (2011). Hierarchical differentiation of myeloid progenitors
is encoded in the transcription factor network. PloS One, 6, e22649.

McDavid,A. et al. (2013). Data exploration, quality control and testing in single-
cell qPCR-based gene expression experiments. Bioinformatics, 29, 461—467.

Mohri,M. et al. (2012). Foundations of Machine Learning. MIT Press,
Cambridge, MA, USA.

Moignard,V. et al. (2013). Characterization of transcriptional networks in
blood stem and progenitor cells using high-throughput single-cell gene ex-
pression analysis. Nature Cell Biol., 15, 363—372.

Orkin,S.H. and Zon,L.I. (2008). Hematopoiesis: an evolving paradigm for
stem cell biology. Cell, 132, 631—644.

Park,H.Y. et al. (2014). Visualization of dynamics of single endogenous mrna
labeled in live mouse. Science, 343, 422—424.

Qiu,P. et al. (2011). Extracting a cellular hierarchy from high-dimensional
cytometry data with SPADE. Nat. B iotechnol., 29, 886—891.

Rieger,M.A. et al. (2009). Hematopoietic cytokines can instruct lineage
choice. Science, 325, 217—218.

Scholkopf,B. et al. (1998). Nonlinear component analysis as a kernel eigen-
value problem. Neural Comput., 10, 1299—1319.

Schroeder,T. (2011). Long-term single-cell imaging of mammalian stem cells.
Nat. Methods, 8, 830—835.

Shawe-Taylor,]. and Cristianini,N. (2004). Kernel Methods for Pattern
Analysis. Cambridge University Press.

Stingl,]. et al. (2006). Puriﬁcation and unique properties of mammary epithe-
lial stem cells. Nature, 439, 993—997.

Strasser,M. et al. (2012). Stability and multiattractor dynamics of a toggle
switch based on a two-stage model of stochastic gene expression. Biophys.
]., 102, 19—29.

Takahashi,K. and Yamanaka,S. (2006). Induction of pluripotent stem cells
from mouse embryonic and adult ﬁbroblast cultures by deﬁned factors. Cell,
126, 663—676.

Tenenbaum,].B. et al. (2000). A global geometric framework for nonlinear
dimensionality reduction. Science, 290, 2319—2323.

Trapnell,C. et al. (2014). The dynamics and regulators of cell fate decisions
are revealed by pseudotemporal ordering of single cells. Nature Biotechnol.,
32, 381—386.

Van der Maaten,L. and Hinton,G. (2008). Visualizing data using t-SNE. ].
Mach. Learn. Res., 9, 25 79—2605 .

Wilhelm,]. and Pingoud,A. (2003). Real-time polymerase chain reaction.
Chemhiochem, 4, 1 120—1 128.

Yan,L. et al. (2013). Single-cell RNA-Seq proﬁling of human preimplantation
embryos and embryonic stem cells. Nat. Struct. Mol. Biol., 20, 1 131—1139.

91% ‘09 1sn3nv uo sopﬁuv s01 ‘nrulomng aIo Amie/nun 112 /§.IO'S[BU.IHO[p.IOJXO'SODBIHJOJUIOIQ/ﬁdllq 11101; popnommoq

