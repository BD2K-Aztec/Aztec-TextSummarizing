ORIGINAL PAPER

Vol. 29 no. 2 2013, pages 182-188
doi: 10. 1 093/bioinformatics/bts6 72

 

Gene expression

Advance Access publication November 19, 2012

An empirical Bayes approach for analysis of diverse periodic
trends in time-course gene expression data

Mehmet Kocak1’2’*, E. Olusegun GeorgeS, Saumyadipta Pyne4’5 and Stanley Pounds2

1Department of Preventive Medicine, University of Tennessee Health Sciences Center, Memphis, TN 38105, USA,
2Department of Biostatistics, St Jude Children’s Research Hospital, Memphis, TN 38105, USA, 8Department of
Mathematical Sciences, University of Memphis, Memphis, TN 38152, USA, 4C.R. Rao Advanced Institute of
Mathematics, Statistics and Computer Science, Hyderabad, Andhra Pradesh 500046, India and 5Broad Institute of MIT

and Harvard University, Cambridge, MA 02142, USA
Associate Editor: Martin Bishop

 

ABSTRACT

Motivation: There is a substantial body of works in the biology litera-
ture that seeks to characterize the cyclic behavior of genes during cell
division. Gene expression microarrays made it possible to measure
the expression profiles of thousands of genes simultaneously in
time-course experiments to assess changes in the expression levels
of genes over time. In this context, the commonly used procedures for
testing include the permutation test by de Lichtenberg et al. and the
Fisher’s G-test, both of which are designed to evaluate periodicity
against noise. However, it is possible that a gene of interest may
have expression that is neither cyclic nor just noise. Thus, there is a
need for a new test for periodicity that can identify cyclic patterns
against not only noise but also other non-cyclic patterns such as
linear, quadratic or higher order polynomial patterns.

Results: To address this weakness, we have introduced an empirical
Bayes approach to test for periodicity and compare its performance
in terms of sensitivity and specificity with that of the permutation test
and Fisher’s G-test through extensive simulations and by application
to a set of time-course experiments on the Schizosaccharomyces
pombe cell-cycle gene expression. We use ‘conserved’ and ‘cycling’
genes by Lu et al. to assess the sensitivity and CESR genes by
Chen et al. to assess the specificity of our new empirical Bayes
method.

Availability and implementation: The SAS Macro for our empirical
Bayes test for periodicity is included in the supplementary materials
along with a sample run of the MACRO program.

Contact: mkocak1@uthsc.edu

Supplementary information: Supplementary data are available at
Bioinformatics online.

Received on July 20, 2012; revised on October 31, 2012; accepted on
November 12, 2012

1 INTRODUCTION

There is a substantial body of works in the biology literature that
seeks to characterize the cyclic behavior of genes during cell div-
ision. In cancer cells, genomic instability can arise when cell

 

*To whom correspondence should be addressed.

division becomes irregular and identifying genes that have
cyclic behavior during cell division may add to the understanding
of the biological process of these cells and open doors to targeted
therapies. Gene expression microarray technology made it
possible to measure the expression levels of thousands of genes
simultaneously and open ways to conducting time-course experi-
ments which aim at describing the change in the expression levels
of genes during successive phases of cell division. Of the several
methods proposed for testing periodicity in time-course gene ex-
pression proﬁles, the two most commonly used methods are
Fisher’s G-test by Fisher (1929) and the permutation test
described by de Lichtenberg et al. (2005a, b), both of which we
brieﬂy describe in Sections 2.1 and 2.2.

Futschik and Herzel (2008) provide comparative analysis of
methods for assessing periodicity on time-course gene expression
data on yeast cells. They argue that analyses based on commonly
used methods might have resulted in an overestimation of the
number of cyclic genes as quite a large number of genes were
identified as periodic by these methods and the overlap among
the resulting list of genes is poor. This ﬁnding motivates our
investigation to construct a new periodicity test that can more
accurately distinguish periodicity from not only noise but also
from other ‘non—periodic’ patterns.

Toward this, we present a new test for periodicity that uses a
polynomial mode as the null hypothesis against a pattern of ex-
pression modeled by a flexible family of periodic functions. We
use an empirical Bayes approach to estimate the parameters of
the periodic mode. We then compare the performance of our
approach with that of the Fisher’s G-test and the permutation
test through extensive simulations. We apply our method to 10
publicly available gene expression time-course experiments
(Supplementary Table S1) conducted by Rustici, Olivia and
Peng on the fission yeast, Schizosaccharomyces pombe (Oliva
et al. 2005; Peng et al. 2005; Rustici et al. 2004).

In Section 2, we describe the Fisher’s G- and the permutation
tests followed in Section 3 by an introduction to our empirical
Bayes procedure for testing for periodicity and its algorithm. In
Section 4, we describe simulation setups to compare the three
methods and present the results of these simulations in Section 5.
In Section 6, we apply our method to the Spombe time-course
gene expression. We end in Section 1 with a conclusion and some
discussions in Section 7.

 

182 © The Author 2012. Published by Oxford University Press. For Permissions, please email: journals.permissions@oup.com

112 /310's113umo [p.IOJXO'SOllBIHJOJUIOIQ/ﬁdllq 11101; prBOIIIAAOG

9IOZ ‘091sn3nv uo ::

Empirical Bayes periodicity test

 

2 METHODS

2.1 The Fisher’s G—test

A detailed description of Fisher’s G-test proposed by Fisher in 1929 was
given by Wichert et al. in 2004. The method is based on the periodogram
spectral estimator deﬁned as

N 2 2

E y" e—zwkn _

1
11:1 N

 

 

 

1 N .
[(Wk) 2 N "2:1: yn[cos(wkn) + i s1n(wkn)]
where N is the time series length, y,, is the gene expression level at time n,
n=l,...,N, wk =271k/N,k= l, ...,a and 0t is the integer part of
(N — l)/2. Based on the periodogram evaluated at wk’s, the Fisher’s
G-statistic for periodicity is given by

_ maxlfkfa [(Wk)

G a
2 [(Wk)
k=1

for which Fisher also provided an expression for calculating the exact
distribution as follows:
a(l — a)
2
I

b a a—l
+(—1)—b!(a _ b)!(1— bx)

P(G>x) = a(l —x)“_1 (1 —2x)a-1+...

where b is the largest integer less than l/x and x is the observed value of
the G-statistic. Small P—Values indicate evidence for a periodic pattern.
The ‘fishengjest’ function in GeneCycle or GeneT S libraries developed by
Ahdesmaki, Fokianos and Strimmer (2009) in R is a very efﬁcient tool for
computing the exact P—Values for Fisher’s G-test provided in the
Supplementary Materials. We have also written a SAS macro to perform
the Fisher’s G-test.

Despite its popularity and computational efﬁciency, Fisher’s G-test has
the following deﬁciencies:

— It tests for periodic pattern against noise.

— It ignores the actual experimentation time points and uses the rank
order of the times which reduces its sensitivity when experiment
times are not equally spaced. This is shown through simulations in
Section 5.

— It ignores information on interdivision times and is evaluated at
Fourier frequencies; thus, if the time-course data are not close to
complete cycles, the sensitivity of Fisher’s G-test to periodicity de-
creases as we show through simulations in this article.

2.2 The permutation test

de Lichtenberg et al. (2005a) gives details for the following permutation
test. Speciﬁcally, let

ng 2 "g
Fg = \J  sin(2ﬁ%>yg(tk)) +<kzl: cos(2nt]—k,)yg(tk))

denote the Fourier score at time tk for a gene g, where tk is the time at
which the gene expression yg(tk) is measured, k = 1,2, . . . , ng, and T is the
estimated interdivision time. To test whether or not gene g has a periodic
pattern of expression over time, the Fourier score Fg calculated from the
actual time-course data for gene g is compared with Fourier scores cal-
culated based on N artiﬁcial proﬁles, say N = 100 000, generated by ran-
domly shufﬂing the time points while keeping the expression values intact
or Vice versa. As can be expected, de Lichtenberg’s permutation test is not
as computationally efﬁcient as the Fisher’s G-test. In this article, we shall
refer to de Lichtenberg’s permutation test as the permutation test.

 

2

Similar to the Fisher’s G-test, the permutation test is designed to test
for periodicity against noise. Thus, when a time-course data results in a
signiﬁcantly small P-Value from the Fisher’s G-test or from the
permutation test, it suggests that there may exist in the data expression
proﬁles white noise. However, periodicity is just one of the possible pat-
terns of gene expression and it should be distinguished from other ex-
pression proﬁles. This observation motivates us to seek a novel method
for testing for periodicity using an empirical Bayes approach.

3 AN EMPIRICAL BAYES APPROACH FOR
TESTING FOR PERIODICITY

A real-valued function ﬁt) is a periodic function with period T if
f(t) =f(t+kT) for all real I and for any integer k.

In the microarray literature, the most commonly referred peri-
odic functions are trigonometric functions, speciﬁcally sine or
cosine functions, as these functions are deﬁned on a unit circle.
The most commonly used tests, the Fisher’s G- and the
permutation tests, are constructed based on these trigonometric
functions. In this article, we build a more ﬂexible class of periodic
functions for modeling periodic expressions by using these trig-
onometric functions as building blocks. Any continuous function
f(-) deﬁned on the interval [0,7], with period T, can be used as a
periodic function by extending its range beyond [0,7] for any x
by requiring f(x) =f(x mod T). In our approach, we construct
periodic functions with the sine function as the building block.

Let yaal, yaaz, ..., ya," denote the observed gene expression
values for a given gene at experimentation time points
16,51, 16,52, . . . , ta)", respectively. Let T denote the interdivision
time. In the interest of notational and computational ease, we
transform the experimentation times to ‘cycle times’ by
tj = ta, j/ T, j = l, 2, . . . ,n and the corresponding gene expression
values to y], where

_ya,j_min(ya,laya,2a "'9ya,i’l) 1 2
rangewa,19ya,29 "'9ya,n) , 9 ,

 

yj . . , 72
With I; = tj mod T, j = 1,2, ...,n, this process converts data
values to triplets (yj, 11,111).

We start by assuming a periodic model based on the sin(+)
function:

32,- = 010 -I— 0.5 sin(2jr(tj —I— 011)) —I— sj,j = 1,2, ...,n, (1)

where I], j = l, 2, . . . ,n are cycle times, deﬁned above, and {SJ-E721
are independent and identically normally distributed with
mean=0 and variance 03. As the range of sin() is [—1,1], with
the length of 2 units, we multiply the sin(+) term in (l) by 0.5 to
reduce the range to 1 unit as yj’s are deﬁned on the interval [0,1]
with a length of 1 unit. The parameter 011 in (1) represents the zero
of the sin(+) function in (l). The intercept parameter is
self-explanatory.

To expand the family of periodic patterns formed by the model
(1), we introduce a modiﬁcation inside the sin(+) function as

yj = 060(1 -I—  + 0.5 Sln(27T(lj -I— 051  -I- 8j,j =1, 2, . . . , n, 

where 1* = 1 mod 1. The addition of 011 I; in (2) changes the under-
lying period ‘within’ each cycle, creating multiple peaks by redu-
cing the period or ﬂattening the underlying shape of the periodic
function through increasing the period. When the effect of
a0(l +111) is added to the model, the periodic structure within

 

183

112 /310's113umo [p.IOJXO'SOllBIIHOJUIOIQ/ﬁdllq 11101; popeoplmoq

9IOZ ‘091sn3nv uo ::

M.Kocak et al.

 

each cycle is broken again as a0(l + 1]") changes the amplitude
of each sub-cycle differently at a given value of 1;, thus
preserving the underlying period as shown in Supplementary
Figures S1 and S2.

Further gain in horizontal and vertical ﬂexibility of the regres-
sion model in (2) can be obtained by introducing another multi-
plicative term to the model as

y]. = [a0(1 + If) 4— 0.5 sin(271(tj + aitj’l‘))](1 -I— 0625*) + 81',

3
j=l,2,...,n, ()

where the multiplicative term (1 + 0121;) stretches the extrema of
the periodic function vertically as necessary within each cycle.
Supplementary Figures S1 and S2 illustrate the increase ﬂexibil-
ity introduced by the two modiﬁcations proposed above.

For estimation of the parameters in the models introduced
above, we use an empirical Bayes procedure. This facilitates de-
velopment of tests for periodicity against an alternative that does
not represent just noise, as has been customarily done in existing
publications based on the Fisher’s G-test and the permutation
test for periodicity.

To generate a family of models under which the distribution of
gene expression will be assumed to be non-periodic, we limit all
models under consideration to those that can be embedded into a
power series regression model of the form

yj:ﬂ0+ﬂ1tj+ﬂ2l§+ﬂ3tf+ﬂ4tj+"'+8j. (4)

Considering the data limitations, the number of parameters that
can be ﬁtted with a polynomial regression model is limited.
However, polynomial functions contain white noise as a trivial
case and belong to a much wider class of non-periodic functions
for comparison against the periodic model speciﬁed by (3). In
utilizing such models, higher order polynomials can be selected
as more and more cycles of data become available.

We have two competing models; the periodic model described
in Equation (3), which is ﬂexible enough to capture a wide range
of periodic patterns, and the polynomial regression model shown
in (4) which includes constant (i.e. white noise), linear, quadratic,
cubic and higher order patterns that are not periodic will be
generated.

For constructing a test procedure, one possible approach is to
use a likelihood ratio test. This is possible with a family of para-
meterized non-periodic and periodic functions. Non-parametric
alternatives would involve the use of splines. However, to in-
crease the utility of the periodic model, we do not want to
treat the interdivision time as ﬁxed since it is just an estimate
with some expected variability. Instead, we reconstruct the above
periodic model in an empirical Bayes setting where we can deﬁne
a prior distribution for the interdivision time using its estimate.
We then assess the goodness-of—ﬁt of the periodic model based
on posterior realizations of the model parameters and assess the
goodness-of—ﬁt of the polynomial regression model based on the
least-squares estimates of its parameters. The algorithm for this
procedure is outlined below.

3.1 Algorithm for the empirical Bayes test of periodicity

Step 1 (Data transformation): Without loss of generality, trans-
form the original data as described above to obtain the data

triplets (yj,tj,t;<),j=1,2, ...,n, where 32,- is the transformed
gene expression values onto [0,1] interval, 11- is the cycle time
based on the estimated interdivision time and I}k is the remainder
Of lj/ T.

Step 2 (Prior speciﬁcation and construction of the Bayesian
model): Assume that 32,- ~ N(,u.(tj), 03), where

11(9) = (050(1 + 1;)1— 0-5 Sin(27T(lj 1‘ 051 17)/051DT))(1 1‘ 0521;)

For each of the parameters in this periodic model, we introduce
the following prior distributions:

— oak ~ N(07k, 6,3), k = 0, l, 2, where (61k,6,%) is the non-linear
least squares estimate of oak, k = 0, l, 2, and its variance mul-
tiplied by 100, using the nonlinear periodic regression model
by ﬁxing the interdivision time in the model as 1.0 as
yj = (050(1 -I—  -I— 0.5 Sln(27T(lj -I- 051  -I— 0621;) + 8j,

— aIDT ~ Gamma(1/0.0001+ 1, 0.0001),

— 03 ~ InverseGamma(100/6§ + l, 100), where 6% is the mean
squared error obtained from the non-linear ﬁt of the peri-
odic model, yj = (a0(l —I— If) —I— 0.5 sin (27T(tj + amp/1))
(l + 0121;) + 8], where j = 1,2, . . . ,n, using least-squares ap-
proach for the gene under investigation.

We note that we have used a highly informative prior for aIDT
because the experimentation times have been converted into
‘cycle times’ using the estimated interdivision time. For this pur-
pose, we assume a small variance for the interdivision time and
express this by assigning a small variance to the prior aIDT.
Speciﬁcally, we assign a gamma prior with the mode 1.0. We
show through simulations as illustrated in Supplementary
Figure S3, where we compared the sensitivity and speciﬁcity
under randomly generated time-course samples from ﬁve periodic
and ﬁve non-periodic patterns which will be discussed in detail in
Section 5, and using a given choice of the scale parameters of
0.000001, 0.0001, 0.01 and 1.0, that the above choice of 0.0001
for the scale parameters for the gamma distribution for aIDT has
excellent operating characteristics. However, if prior information
regarding the variability of the estimated interdivision time is
available, then the researcher is encouraged to deﬁne the prior
distribution of aIDT based on this prior information accordingly.

For the prior distribution for 03, an inverse gamma distribu-
tion with parameters estimated by the least square ﬁt of the
periodic model was used. Speciﬁcally, it was found that a prior
with mode equal to the variance of the residuals obtained from
the non-linear ﬁt of the periodic model using least-squares ap-
proach which is inﬂated by 100 has excellent convergence char-
acteristics as shown in Supplementary Figure S4, where we
compare the sensitivity and speciﬁcity under randomly generated
time-course samples from ﬁve periodic and ﬁve non-periodic
patterns, which will be discussed in details in Section 5 and
using a set of scale parameters of l, 10, 100 and 1000.

Using the likelihood function

1

. /27w§
1

= (MUS—"ﬂ 6X11; 2 (yj — M(tj))2)
8 J 1

 

L(yl9) = H mpg—71,0. — 11(9)?)
i=1 8

 

184

112 /310's112umo [p.IOJXO'SOIlBIHJOJUIOICI/ﬁdllq 1110131 pop1201umoq

9IOZ ‘091sn3nv uo ::

Empirical Bayes periodicity test

 

where 9 = {050,051,052,051DT,O‘§} and ,u.(t,-) = (0500 -I—  + 0.5
sin(2jr(t,- + 011 tj’l‘)/oz1DT))(l + 0121;), and the prior distributions as-
signed above and under the independence assumption, the joint
posterior distribution can be expressed as

H(9Iy) o< (ob—’1’ exp 2 (y,- — war]
8 ,:1

X ﬁexp(—(ak _ CA¥']€)2)
k=0 26,3

(alDT)10 000

X r(10001) >1 0.000110001
100100/&§+1(02)—(100/&§+2)

r(100/5§ + 1)

 

exp(—a1DT/0.0001)

exp(—100/6§)

 

Closed form fully conditional posterior distributions of the par-
ameters were obtained when possible and presented in the
Appendix in the Supplementary Materials. Since two of the par-
ameters, 0c, and ochT, in the Bayesian periodic model do not have
fully conditional conjugate posteriors, we used an MCMC pro-
cedure in SAS® Version 9.2 which utilizes an adaptive blocked
random-walk Metropolis algorithm with target acceptance rate
equal to 0.20 and acceptance tolerance 0.075. A t-distribution
(degrees of freedom=3) was used as a proposal distribution.
This approach allows for computational convenience.

Step 3 (Obtaining samples from the posterior distribution):
Generate 10000 posterior realizations of the set of parameters
in the Bayesian periodic model following 100 000 burn-in runs
and using a thinning parameter of 10 to reduce the correlation
between successive samples. This posterior sample can be repre-
sented by the matrix {010%,615m,a25m,a1Dij,62 $320100, where

8,m
Jim is a posterior realization of the error variance which will
be used to compare the performance of the Bayesian periodic
model with that of the polynomial model as discussed in Step-5
below.
Step 4 (Constructing the null space): Using the data pairs (12,, 1,),
j = 1,2, . . . ,n, obtain the least-squares estimates of the parameters
of the polynomial model of the form y,- = ,80 + ,811, + ,thf + - - -
+,8th —I— 8,, wheres, ~ N(0, 028). The degree of the polynomial,
K, is recommended as follows: Starting with the constant (a zero
degree polynomial, i.e. the white noise case) for one cycle of data,
an additional term is added to the model for each half cycle of
data; that is, if there is only one cycle of data, only the intercept
term, ,80, is used any given pattern including a linear pattern may
be repeated in later cycles in the same fashion and thus cannot be
eliminated as ‘non—periodic’. As the amount of data in cycles in-
crease, the null space can be expended to include any linear, quad-
ratic, cubic and other higher order polynomial patterns by adding
an additional term to the polynomial model for each half-cycle of
data. So, the number of terms used in the polynomial model
representing the null space can be considered as a function of
the number of cycles of data and can be summarized as follows:

— l.0 cycle—> constant, which is ,80

— 1.5 cycles —> linear polynomial model with ,80 as intercept

— 2.0 cycles—> quadratic polynomial model with ,80 as
intercept

— 2.5 cycles —> cubic polynomial model with ,80 as intercept

— 3.0 cycles—>polynomial model of degree 4 with ,80 as
intercept

Obtain the least squares estimates of the parameters of the
polynomial model and compute the mean squared errors
(MSEO).

Step 5 (Summarizing the evidence for periodicity): Estimate
the empirical probability that posterior realization of the error
variance, 63, from the Bayesian periodic model is larger than the
mean squared errors (MSEO) from the polynomial model repre-
senting the null space, by P3,,es = 2,5330 I(MSE0 3 0‘? m)/
10000 . Small PM},es represents empirical evidence against, the
non-periodic model and the null hypothesis is rejected
accordingly.

4 IMPLEMENTATION OF THE ALGORITHM AND
SIMULATION DESIGN

For the Bayesian computations, we have written a SAS macro
which utilizes the MCMC procedure in SAS® Version 9.2. The
MCMC procedure in SAS is dedicated to Bayesian computations
and has several built-in diagnostic tools, including Geweke diag-
nostic and Heidelberger-Welch diagnostics, examples of which
are presented in the Supplementary Materials. The macro pro-
gram also optionally performs the Fisher’s G-test and the
permutation test.

In Supplementary Figures S5 and S6, we present a sample
model ﬁt and diagnostic graph for one of the parameters of
interest, respectively, to show that the algorithm has desirable
operating characteristics. Diagnostic graphs for the other param-
eters in the Bayesian model have similar attributes. In addition to
the diagnostic plots, the Bayesian periodicity test procedure has
desirable diagnostic characteristics based on the Geweke diag-
nostic test by Geweke (1992) and Heidelberger-Welch
diagnostics tests by Heidelberger and Welch (1981, 1983),
which include the Stationarity and Half-width tests.

The performance of the empirical Bayes test for periodicity
was compared with that of the Fisher’s G- and the permutation
tests using randomly generated time-course data from ﬁve peri-
odic (sine, spike, double spike, beta and double beta) and ﬁve
non-periodic (noise, linear, low-plato, high-plato and random
spikes) patterns for which examples are shown in
Supplementary Figure S7. These patterns were identiﬁed by re-
viewing the time-course proﬁles of hundreds of genes in the
Spombe experiments.

Using each of these 10 patterns, we generated 500 random
samples (a total of 5000 time-course samples under each
sample size), where the sample sizes ranged from 1.5 cycles to
3.0 complete cycles with 10 observation per cycle. We then
applied the three methods of periodicity testing on each sample
and compared the empirical cumulative distribution functions
(CDFs) of P—Values from the three methods in pairs of patterns
with one periodic and one non-periodic patterns. The CDF of P-
values under the periodic pattern was plotted agains the CDF of
P—Values under the non-periodic pattern (CDF-CDF graph) and
the area under the curve formed by the CDF-CDF graph.

We also compared the performances of three methods under
missing data where 20% of the observation were randomly

 

185

112 /810's112umo [p.IOJXO'SOIlBIHJOJUIOICI/ﬁdllq 1110131 pop1201umoq

9IOZ ‘091sn8nv uo ::

M.Kocak et al.

 

removed in each sample and the test results were obtained based
on the remaining observations. All simulation data were gener-
ated and all computations were performed in SAS® (Version 9.2)
environment.

5 RESULTS

In Figure 1, we compare the permutation, Fisher’s G and
empirical Bayes tests using a plot of the empirical CDF of P-
values under a given periodic pattern versus the empirical CDF
of P—Values under a given non-periodic pattern. We call this plot
a ‘CDF-CDF curve’.

The empirical CDF is computed by CDF(or) = ZHNLI
(PH 3 or)/N,, for a sample of P—Values {Pn}nN;1. As in the receiver
operating characteristics (ROC) curves with sensitivity and spe-
ciﬁcity, the closer the curve to the upper left corner, the better
operating characteristics it has in terms of correctly distinguish-
ing periodic patterns from non-periodic ones and Vice versa.

Clearly, none of the methods is uniformly best under various
pairing of a periodic and a non-periodic setting. However, under
the ‘sinusoidal’ pattern, the permutation test seems to be better
against ‘noise’ and ‘random spikes’, where the Fisher’s G-test
fails against ‘linear’ and ‘high plateau’ patterns. This is because
any linear or high plateau patterns can be ﬁt easily to a small
part of a sine function and the Fisher’s G-test is sensitive to such
patterns and falsely accepts them as periodic without considering
the period. Under the ‘spike’ and ‘double spike’ patterns, the
Bayesian periodic model seems to be the best against any of
the ﬁve non-periodic patterns. Under the ‘beta’ pattern, all
three methods had high performance. However, the Fisher’s G-
test did not differentiate a periodic pattern from a ‘high plateau’
pattern as expected. Under the ‘bi-modal’ pattern, the Bayesian
approach and the Fisher’s G-test had similar performance while
the permutation test did not perform well against any of the ﬁve
non-periodic patterns. For each combination of a periodic and
non-periodic pattern as depicted in Supplementary Figure S7, we
present the area under curve in Supplementary Table S2.

To compare the performance of the three methods under the
case of irregularly spaced experimentation times, as is commonly
encountered in real experiments, we randomly removed 20% of
the data points. Under this ‘missingness’, the performance of the
Bayesian approach is superior to that of the Fisher’s G-test and
the permutation test as illustrated by Figure 2. For each com-
bination of a periodic and non-periodic pattern, we present the
AUC of any given CDF-CDF curve in Supplementary Table S3.

The results when the data were drawn from 1.5, 2.5 and 3
cycles were very similar to the above results both with full data
and when some data were randomly missing. (Simulation results
for 1.5 cycles of data are presented in Supplementary Fig. S8.)

6 APPLICATION TO S.POMBE CELL-CYCLE GENE
EXPRESSION EXPERIMENTS

We used 10 microarray experiments (Supplementary Table S1)
measuring genome-wide time-course gene expression during the
cell division cycles of the ﬁssion yeast Spombe based on two
synchronization protocols—elutriation (Elut on the ﬁgures)
and Cdc25 block-release (Cdc25 on the ﬁgures) (Oliva et al.

2 f'IrIzlu. anTI-ala will} Nun- Mix-sinner".

 

 

EIIIIIII-In-Inl ﬁnk: Uncut-I: ISHIW LI-tla III-Moml l-JIIIIII. III-nice
].|.|- .—-.-——— ._ .. . ,— I. _ _ ._
II" I "’ ' . ' 3" r . "
|

.I' .- _.—
r’ I -_l' K I_ l .d'

 

 

 

I;
II.
I

-?'E- u
=I.- :
II I
’I.
III"

 

 

_,
'21..
"I.

f
f :-u- ----—-

 

m.—

""E|F Id'1II-e E‘IIII'IIIIIII. P'HI
I.- n c I.-
: '= In. - a II:
-I1
I
I I
I
I I
I
I
I
I
I III
I N.
I
1' _
I I
I
I I
| I
a.“ I
I I
I I
'. I \_ l
I III. _I ".
I 'I :  I
I
I ' -.
_ __ __ I . ' - . _
II FII I'IJIII ram I-"I.-IIII I IIII.'. 'IIIIII

 

I:-I,I-
'III- ....—-

. .._- . .
._. . . __
E"- I' "' .' "' .-' I .f
.- . -
-I.

 

._.._ - .- .-
I:I.I- ' _.' _ .- _.
IJJ— L' _’ 5 I" '

- I .-'
m.“ -_ .- .I

I I I I I I r I I I I 1 r I I I I I
ﬁll Ila I'IFI I'III II-I- I'Iﬁ C-II I}: I'Iﬁ I'II'l ll-I- I'Iﬁ -I.'-I1 I2--1 I'III III'I II-I- I'IFI‘

 

 

 

 

 

 

 

 

Rand-Jul {IIIILL'I-I

 

I'HF I'I-1' l||I.I I'H'IIII-I'urLII'IL' I'.I'l.'|-||
,—

- "II'ETHI: .II'IS ' RI‘I mull — — - PII'I'IILIIJJJIIIIII ' ' FlallL'rau I

 

 

Fig. 1. CDF-CDF graph of P—Values from the three tests for periodicity
in a given pair of a periodic and a non-periodic pattern with no
missingness

li'yLII-JI II'II'IIIQIIIII III-illl HIMII'IIIIM.

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

HIIIIIsIII-Inl Huh: [III-Jane link.» LI-II: Evan-III l- :I-IIIII. Huh:

LU- _. . —_J,_—..-- __ __-_-_.—I II__ - w-  '_ __ . ——;I- 'I—II-
"11' {_n’ If It..- " _l- I {I t I a_.--' __,- |
ll-I_ I. E if -.-.I' . If.- IE.
III.- .' F; I i
I|]— I L." J.
I” . ..a-F
I'" I'— " I" . '— .-' — K —
IIII— | a 7 I f I r I
"II— ' #2 x ..- E
ll+- | ,2 If“ -’ _=
uu_ ,. _,. .r

E- IIII— ' — —'~ '- ' -

5 III- —..- — — — — _ — — —

.— _ " -' I"

 IJH— [I r .I r f ' =

.E IIII _::’r | . 

_ r

g IHI— __-.# If  g

3 II:- '3' I I 2

 III-l_ !- _ _

'-L|.I—— __ _ -— ———— — —————

D _ . — I— ,_ I

'_r IIII- Ir ,.- I .-r l q:
I'II'I— {I .I' K‘- I E
II*_ .r r r ..r I i
II]- I is" ' E
II.|.|- "
l-"- .—..—.—-I-— _----. — — —.-' |l_'—- -——— —' _ —.—'—'T-' -—— -

--_ — _-— - - .2 I .4- -' "
II’I— {a  “r ,- I' I ___-' i
Ir.— I I Jr I I I {Jr I 
III.- | -' -" i ..- I .5
u:—  r“ I J E
IIII- -" -'- r L
I

I I I I ' I I I I I I I I I I I
II' II III. u u II-:I III -'II‘ on II a II_II II II u-I. II! "'II H II II II II II I. II 5
C'EJli rill.” .‘I'r-II-I'IJnIrI-rh: l'rrI-enl

TIIETIII'IIJEi. Fir-mull I‘I'I'IIIUITIHII III-4m": I

 

Fig. 2. CDF-CDF plot of the three tests for periodicity using the six
periodic patterns against the ﬁve non-periodic patterns where the time
increments between the experimentation times were not the same

2005; Peng et al. 2005; Rustici et al. 2004). The data were nor-
malized and median centered by the original experimenters.

We have estimated the interdivision time (IDT) using the 35
genes which are known to be periodic (Rustici et al. 2004) and
obtained the mean estimate for IDT along with its variance as
presented in Supplementary Table S3. For the Rustici experi-
ments, 29—33 genes of those 35 genes were used in the estimation
process. For the other ﬁve experiments, we had the time-course
data for only 11 of those 35 genes. Overall, inter-division time
estimate provided by the experimenters are close to what we
estimated based on the Fourier score approach with varying
degree of variation.

We then applied the empirical Bayes test to the time-course
gene expression data from the 10 experiments, using the variance
estimates of IDT in deﬁning the prior distribution of mm, to test
the null hypothesis that a given gene is not cell-cycle regulated
(i.e. not periodically expressed). Similarly, P—Values for each gene

 

186

112 /810's112umo [progxo'sor1nu1101quIq//:d11q 1110131 pop1201umoq

9IOZ ‘091sn8nv uo ::

Empirical Bayes periodicity test

 

I:-

 

Empirical Bayes Test —- versus Permutation Test
- - 1Inert-Ills Fisher's CI—test

.3“ .3“ 13'
n4- 3: II:

13'
:n

.3
.I.II.

Empirical CDF of" Mela P-Baymt
5::- :3-
Lu ..n

53'
Ig._I

Ill

 

 

 

[1.0
0.32 0.34 {1.36 0.33 0.90 0.92 0.94 [1.96 0.93 LIIIEI
Empirical CDF of" Pertmutatien Test and Fisher's CI—test

 

Fig. 3. CDF-CDF graph comparing the Meta P—Values from the empirical
Bayes test for periodicity versus the permutation test and Fisher’s G—test

in each experiment were obtained using the Fisher’s G-test and
the permutation test. We then applied the logit method by
George and Mudholkar (1983) to pool the P—Values across the
10 experiments. In Figure 3, we present the CDF-CDF graph
comparing the Meta P—Values from the empirical Bayes test for
periodicity versus the permutation test and Fisher’s G-test.

Clearly, the empirical CDF of Meta PBayes is much lower
compared with the empirical CDF of the Meta P—Values of the
other two methods at a given threshold, which results in over-
whelmingly more ‘periodic’ gene calls in the permutation test and
Fisher’s G-test than in the empirical Bayes test for periodicity.
For example, at signiﬁcance threshold of 0.05, the Bayesian ap-
proach calls 797 (16%) genes as ‘periodic’ while the permutation
test and Fisher’s G-test calls 4700 (95%) and 4789 (97%) genes as
‘periodic’ (Supplementary Fig. S9).

We used a benchmark set of 40 periodic genes reported by
Marguerat et al. (2006) to assess the sensitivity and speciﬁcity
of the three approaches. Twenty-ﬁve, 27 and 27 of these 40 genes
were ranked within the top 100 genes by the empirical Bayes test
for periodicity, the permutation test and Fisher’s G-test, respect-
ively. Similarly, 28, 31 and 30 of these 40 genes were ranked
within the top 200 of the genes by the empirical Bayes test for
periodicity, the permutation test and Fisher’s G-test, respectively.
We present the expression proﬁles of the lowest ranked gene
among the 40 benchmark genes by the empirical Bayes test for
periodicity in Supplementary Figure S10.

We have also compared the three methods using a set of 52
‘conserved’ genes and a set of 235 ‘cycling’ genes reported by Lu
et al. (2007). Among the top 100 genes, l2, l4 and 14 conserved
genes were identiﬁed by the Bayesian approach, the permutation
test and Fisher’s G-test, respectively. Similarly, 36, 39 and 38
‘cycling’ genes were identiﬁed by the Bayesian approach, the
permutation test and Fisher’s G-test, respectively, among the
top 100 genes. We present the gene expression proﬁles for
the lowest ranked ‘conserved’ gene by the Bayesian approach
in Supplementary Figure S1 1, where we observe that the period-
icity of these genes is not consistently supported by the independ-
ent experiments. Similarly, we present the gene expression

Table 1. Ranks for the CESR genes by the three periodicity tests

 

 

 

Tests Ranks for the CESR genes (N = 126)

Min. Q1 Median Q3 Max.
Empirical Bayes 82 1837 2795 4255 4920
Permutation 79 876 1819 2988 4682
Fisher’s G 46 710 1512 2668 4829

 

proﬁles for the lowest ranked ‘cycling’ gene by the Bayesian ap-
proach in Supplementary Figure S12.

Based on the ‘benchmark’, ‘conserved’ and ‘cycling’ gene lists
described above, we have looked into the Gene Ontology (GO)
terms for biological processes in the genes that were ranked
within the top 1000 by the permutation test and Fisher’s G-test
while ranked at 2000 and higher by the empirical Bayes test.
Based on the reported GO terms in biological processes, we
argue that most of these genes, although ranked within the top
1000 by the permutation test and Fisher’s G-test, do not have
convincing evidence of being part of cell-cycle as shown in
Supplementary Tables S4—S6.

We have also compared the ranks of Core Environmental
Stress Response (CESR) genes (Chen et al. 2003) which are ex-
pected to be expressed or repressed as a response to environmen-
tal stress and are not expected to be periodic. We had
time-course data for 126 CESR genes and the median rank by
the Bayesian approach was 2795 while the median ranks were
1819 and 1512 for the permutation test and Fisher’s G-test, re-
spectively, as shown in Table 1.

Along the same lines, only 20 CESR genes were ranked within
the top 1000 by the empirical Bayes test while 36 and 41 genes
were ranked within the top 1000 by the permutation test and
Fisher’s G-test, respectively. The counts for the top 2000 genes
were 37, 70 and 78, respectively. These results show the more
desirable sensitivity and speciﬁcity of the empirical Bayes
periodicity test compared with its counterparts.

We have also performed gene enrichment analysis on biolo-
gical processes for the top 1000 genes by each method
(Supplementary Table S7). Based on the hyper-geometric test,
we see that for most biological processes, the top 1000 genes
by the Bayesian approach has much more genes than the other
two methods. For example, for DNA replication, while the
Bayesian method has 10 genes in the top 1000, permutation
test and Fisher’s G-test have only three genes.

7 DISCUSSION

We have demonstrated through simulations that a goodness-
of—ﬁt comparison of the Bayesian periodic model and the poly-
nomial regression model has better sensitivity to distinguish
periodic patterns from non-periodic patterns when compared
with the permutation test and Fisher’s G-test. This property ex-
tends to the case where there are data missing at random. The
property is also observed when there are deviations of the inter-
division time from the true interdivision time. The Bayesian ap-
proach seems to be able to distinguish periodic patterns from
pure noise as well as from any linear, quadratic, cubic and

 

187

112 /810's112umo [progxo'sot1nu1101utotq//:d11q 1110131 pop1201umoq

9IOZ ‘091sn8nv uo ::

M.Kocak et al.

 

higher order polynomial patterns. As a result of its superior spe-
ciﬁcity, the Bayesian approach identiﬁed only 797 (16%) of the
4940 genes as ‘periodic’ at the signiﬁcance threshold of 0.05,
which we believe is much closer to the percentage of genes that
are periodic in ﬁssion yeast, while the permutation test and the
Fisher’s exact test identiﬁed >95% of the genes as ‘periodic’,
which is not realistic and shows that these two tests are not suf-
ﬁciently speciﬁc as they erroneously show evidence of periodicity
if the time-course data show something different than noise. This
point was also eloquently raised by Futschik and Herzel (2008)
as discussed in Section 1.

Our G0 review of the genes that were ranked 22000 by the
Bayesian approach while ranked within the top 1000 by the per-
mutation test and Fisher’s G-test shows that most of these genes
are not reported being involved in the cell division process.
Therefore, it is highly critical to have a testing procedure that
has high sensitivity in recognizing any periodic pattern as well as
high speciﬁcity in eliminating patterns (or no patterns) that are
not periodic, including noise, from the ﬁnal list of genes. Using
extensive simulation studies and application to 10 cell-cycle gene
expression experiments as well as evaluating the ranks of CESR
genes by each periodicity test, we have shown that the Bayesian
test of periodicity has such desirable sensitivity and speciﬁcity
characteristics.

However, we feel that computational efﬁciency of the
empirical Bayes approach can be improved. In its current
form, a high level of computations is required to obtain the pos-
terior realizations of the model parameters and perform further
calculations. For example, obtaining the Bayesian probabilities
for each gene in each cell-cycle experiment by Rustici may take
about 4 hours in SAS® Version 9.2 on a 3.00 GHz PC with Intel®
CoreTM2 Duo CPU and 3.25 GM of RAM PC; however, ﬁrst,
considering the limited resources both in terms of ﬁnancial and
human resources, a more sensitive and speciﬁc gene list for fur-
ther small-scale studies should not be sacriﬁced for obtaining
such a list rapidly. Second, we believe that the implementation
of the Bayesian test of periodicity on a different platform such as
OpenBugs can deﬁnitely help reduce the computation time which
makes such an issue less and less relevant.

Although the main application area for the empirical Bayes
Periodicity test is the time-course gene expression data, it can
also be used for the inventory management of consumer
goods. Bensoussan et al. (2011) describes the need of using cyc-
lical demand signals to maximize the proﬁt. Thus, our testing
approach for periodicity can be applied to time series demand

data on a given product over a time period and identify the
products among tens of thousands of products which have peri-
odic consumer demand. The empirical Bayes periodicity test can
also be used to identify ‘cyclical’ stocks which may potentially
provide valuable information for investors. As an example, Akar
and Baskaya (2011) use univariate spectral analysis to identify
cyclic behavior of the Turkish stock market. Our method can
also be used to test for cyclic behavior of stock markets at given
inter-cycle times.

Conﬂict of Interest: none declared.

REFERENCES

Akar,C. and Baskaya,Z. (2011) Detecting the long term cyclical behaviour of the
Turkish stock market by means of spectral analysis. Int. Res. J Finance Econ.,
67, 160—167.

Bensoussan,A. et al. (2011) Achieving a long-term service target with periodic
demand signals: a newsvendor framework. Manaf Serv. Oper. Manag., 13,
73—88.

Chen,D. et al. (2003) Global transcriptional responses of ﬁssion yeast to environ-
mental stress. Mol. Biol. Cell, 14, 214—229.

de Lichtenberg,U. et al. (2005a) Comparison of computational methods for the
identiﬁcation of cell-cycle-regulated genes. Bioinformatics, 21, 1164—1 171.

de Lichtenberg,U. et al. (2005b) New weakly expressed cell-cycle regulated genes in
yeast. Yeast, 22, 1191—1201.

Fisher,R.A. (1929) Tests of signiﬁcance in harmonic analysis. Proc. R. Soc. Lond.,
125, 54—59.

Futschik,M.E. and Herzel,H. (2008) Are we overestimating the number of
cell-cycling genes? The impact of background models on time-series analysis.
Bioinformatics, 24, 1063—1069.

George,E.O. and Mudholkar,G.S. (1983) On the convolution of logistic random
variables. Metrika, 30, 1—14.

Geweke,J. (1992) Evaluating the accuracy of sampling-based approaches to calcu-
lating posterior moments. In Bayesian Statistics 4. Clarendon Press, Oxford,
UK, pp. 169—193.

Heidelberger,P. and Welch,P.D. (1981) A spectral method for conﬁdence interval
generation and run length control in simulations. Comman. ACM, 24, 233—245.

Heidelberger,P. and Welch,P.D. (1983) Simulation run length control in the pres-
ence of an initial transient. Oper. Res., 31, 1109—1144.

Lu,Y. et al. (2007) Combined analysis reveals a core set of cycling genes. Genome
Biol, 8, R146.

Marguerat,S. et al. (2006) The more the merrier: comparative analysis of microarray
studies on cell cycle-regulated genes in ﬁssion yeast. Yeast, 23, 261—277.

Oliva,A. et al. (2005) The cell-cycle regulated genes of Schizosaccharomyces pombe.
PLoS Biol, 3, e225.

Peng,X. et al. (2005) Identiﬁcation of cell-cycle-regulated genes in ﬁssion yeast. M ol.
Biol. Cell, 16, 1026—1042.

Rustici,G. et al. (2004) Periodic gene expression program of the ﬁssion yeast
cell-cycle. Nat. Genet, 36, 809—817.

 

188

112 /810's112umo [progxo'sot1eu1101utotq//:d11q 1110131 pop1201umoq

9IOZ ‘091sn8nv uo ::

