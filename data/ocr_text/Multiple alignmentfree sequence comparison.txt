ORIGINAL PAPER

Vol. 29 no. 21 2013, pages 2690—2698
doi:10. 1093/bioinformatics/btt462

 

Sequence analysis

Advance Access publication August 29, 2013

Multiple alignment-free sequence comparison

Jie Renl, Kai Songl, Fengzhu Sun2’3, Minghua Deng1 and Gesine Reinert“

1School of Mathematics, Peking University, Beijing 100871, PR China, 2Molecular and Computational Biology, University
of Southern California, Los Angeles, CA 90089—2910, USA, 3MOE Key Laboratory of Bioinformatics and Bioinformatics
Division, TNLIST/Department of Automation, Tsinghua University, Beijing 100084, PR China and 4Department of
Statistics, University of Oxford, 1 South Parks Road, Oxford OX1 3TG, UK

Associate Editor: Alfonso Valencia

 

ABSTRACT

Motivation: Recently, a range of new statistics have become available
for the alignment-free comparison of two sequences based on k—tuple
word content. Here, we extend these statistics to the simultaneous
comparison of more than two sequences. Our suite of statistics con-
tains, first, C7 and Cf, extensions of statistics for pairwise comparison
of the joint k—tuple content of all the sequences, and second, W, C—§
and Cg“, averages of sums of pairwise comparison statistics. The two
tasks we consider are, first, to identify sequences that are similar to a
set of target sequences, and, second, to measure the similarity within
a set of sequences.

Results: Our investigation uses both simulated data as well as cis-
regulatory module data where the task is to identify cis-regulatory
modules with similar transcription factor binding sites. We find that
although for real data, all of our statistics show a similar performance,
on simulated data the Shepp—type statistics are in some instances
outperformed by star-type statistics. The multiple alignment-free stat-
istics are more sensitive to contamination in the data than the pairwise
average statistics.

Availability: Our implementation of the five statistics is available as
R package named ‘multiAlignFree’ at be http://www-rcf.usc.edu/
~fsun/Programs/multiAlignFree/multiAlignFreemain.html.

Contact: reinert@stats.ox.ac.uk

Supplementary information: Supplementary data are available at
Bioinformatics online.

 

Received on April 18, 2013; revised on July 12, 2013; accepted on
August 5, 2013

1 INTRODUCTION

A cis-regulatory module (CRM) is a stretch of DNA in charge of
regulating expression of some nearby genes (Davidson, 2006).
CRMs typically consist of a few hundred base pairs, and they
contain multiple transcription factor binding sites (TF BS). As
CRMs with similar TFBSs may show similar regulatory patterns,
a pertinent question is how to classify CRM sequences and how
to measure the similarity within a set of CRM sequences.
Usually, the similarity between two CRM sequences is as-
sessed by either global (Needleman et al., 1970) or local align-
ment (Smith and Waterman, 1981). A main issue with applying
alignment-based methods for this problem is that TFBSs are
normally much shorter than the CRM, and hence the alignment
score of two CRMs may be dominated by the content of their

 

*To whom correspondence should be addressed.

background sequences. Therefore, a high alignment score be-
tween two CRMs may arise without them containing similar
TFBSs regulatory patterns. Moreover, especially in distantly
related species, the CRM sequences may simply not be alignable
(Arunachalam et al., 2010; Wolff et al., 1999). Finally, align-
ment-based methods are time-consuming. Hence, CRMs provide
a challenging test case for sequence comparison; see also
Hardison and Taylor (2012).

In contrast, alignment-free methods, first proposed by
Blaisdell (1986), have been developed at a fast pace during the
past two decades. Here, we focus on alignment-free sequence
comparison based on the joint k—tuple content of sequences.
For two sequences A = A1A2...A,,1 and B = B1B2 . . .an oflet-
ters from a finite alphabet A of size d, and for a k—tuple word
w e A", let X53) denote the frequency of w in sequence A, and
similarly X(W2) denote its frequency in sequence B. We centralize
the word counts based on a probabilistic model. Let Pg) denote
the probability of occurrence of the word w = wl,wz, ...,wk
in the ith sequence, i: 1, 2. For example, when the letters in
the underlying sequence are assumed to be drawn independently
at random from the identical distribution (the i.i.d. model), then
P? 2 11:1 pg, where  is the probability of letter wj in the ith
sequence; in practice,  is estimated by the frequency of letter w]-
in the ith sequence.

For a word w, the centralized count variables

X<3=Xg>—(n,—k+1)19g9, i= 1,2, (1)
and their approximate standardization,

W ,/(n,- — k+1)P§1)

measure the deviation of the word frequencies in the sequence
from the word occurrence expectation in the so-called back-
ground sequences. The statistics D3 and D59 for alignment-free
comparison of two sequences are now deﬁned by

Data = 2 was

weAk

i: 1,2,

 

and

2 may)

weAk («25,152 + (221,252

see Reinert et al. (2009) and Wan et al. (2010). In Reinert et al.
(2009), it has been shown that these statistics are powerful in

 

2690 © The Author 2013. Published by Oxford University Press. All rights reserved. For Permissions, please e—mail: journals.permissions@oup.com

112 /810's112umo[pJOJXO'sopemJogurorq/ﬁd11q IIIOJJ pepeolumoq

910K ‘09 lsnﬁnV no :2

Multiple alignment-free sequence comparison

 

distinguishing two sequences related by a common motif. We
refer to the first statistic as star-type and to the second statistic
as Shepp-type; according to Shepp (1964), if the counts were
independent mean zero normal variables, then the self-standar-
dized statistic D59 would again be normally distributed.

To eliminate the effect of the length of the sequences, two
renormalized versions, 3 and Cg, of D; and D59 are introduced
in Liu et al. (2011) by applying the Cauchy—Schwarz inequality;

 

 

 

 

w B) = D3<AaB>
2 ’ Z (232“)? 2(13'3‘252
weAk weAk
and, with
<1“): —’?‘i’ .
(will)? + (214352)“
for i = 1,2,
C§(A B): D§(A’B) .
Z (23%“)? 2 (89(2)?
weAk weAk

Both C; and C59 range from —1 to 1, with a value close to 1 when
the sequences are closely related. For sequences that do not have
the same length, the total number of k—tuple words could have a
large inﬂuence on the value of D-type statistics, and hence for
such sequences, we use the C—type statistics to measure the simi-
larity. As CRM sequences vary by a few hundred base pairs in
length, we only use the C—type statistics in our applications.
Variants of our D—type statistics have been considered in the
literature; a main issue with them is that they may be dominated
by single-sequence noise. In Lippert et al. (2002), it has been
shown that the straightforward non-centred statistic
D2(A, B) = Ewe/1;, X(W1)X(w2) may be dominated either by noise
in the single sequences or by difference in sequence backgrounds.
Thus, it has weak power in detecting relationship between two
sequences; see also Kantorovitz et al. (2007); Reinert et al.
(2009); Wan et al. (2010). In Kantorovitz et al. (2007), a stan-

, . . _ D —E(D
dard1zed stat1stlcs D22 — —§d(D2

)2) was proposed, where E(D2)
and sd(D2) are the mean and standard deviation of D2 under a
given model of the sequence. It was shown that D22 outperforms
D2. Yet, the noise in the single sequence may still dominate the
statistics D22 when the background sequence is not uniform
(Reinert et al., 2009). Standardizing the count vectors themselves,
as in D; and D59, resolves this issue.

In the work of Géke et al. (2012), the background sequence
model is generalized from i.i.d to a ﬁrst-order Markov chain
model, showing that a ﬁrst-order Markov chain model improves
the ability of detecting similarity between regulatory sequences
compared with the i.i.d model. Higher order Markov chain
models could be considered, but owing to the limited length of
CRM sequences, estimating the higher order Markov chain
model parameters leads to an overﬁtting problem and results
in poor performance (Géke et al., 2012). Géke et al. (2012)
also showed that including the reverse complement of a word
could increase the prediction accuracy.

Although the statistics 3 and Cg perform well for pairwise
alignment-free sequence comparison, in applications, the

similarity within a set of more than two sequences may be of
interest. There are two main types of problems to tackle. The
ﬁrst problem is an identification problem. Suppose that we have
already classiﬁed 1i — 1 sequences according to whether they are
CRMs of a particular type, and we are presented with a new
sequence. How should we classify this sequence? The second
problem is how to assess the similarity within a set of sequences.
Both problems are motivated by the task of predicting sets of
related CRMs, given a set of co-regulated genes.

In Kantorovitz et al. (2007), the overall similarity within a set
of CRM sequences is addressed as follows. A set of CRMs,
known to regulate expression in the same tissue and/or develop-
ment stage, is taken as the so-called positive set. A set of equally
many randomly chosen sequences, with lengths matching the
CRMs, is taken as the so-called negative set. The positive set is
randomly partitioned into two disjoint subsets of equal size, and
each subset of sequences is concatenated to produce one long
sequence. The similarity between these sequences can then be
assessed using an alignment-free statistic for pairwise sequence
comparison; Kantorovitz et al. (2007) recommend D22. As this
method requires many repeats of the random partitioning, it is
time-intensive, and hence alternative methods are of interest.

Here, we extend the renormalized pairwise alignment-free se-
quence comparison statistics 02" and Cg to two families of mul-
tiple statistics, denoted by 7 and Cf. We also introduce three
families of averag pairwise statistics for the identiﬁcation prob-
lem, called 6;, C59 and C560, and their veLsiorgfor measuring
similarity within a set of sequences, called a, Cg and C527“.

We evaluate these families of statistics by testing them on the
identiﬁcation problem described earlier in the text, both through
a simulation study and through analysing real data, by using
each of our statistics as a score; the higher the score, the more
similar the sequences should be. In the simulation study, we
follow the common motif model in Reinert et al. (2009) and
Wan et al. (2010) but under a ﬁrst-order Markov chain model
for the background sequence. Then, we apply our statistics to the
data from Blow et al. (2010) of tissue-speciﬁc enhancer CRMs
identiﬁed in vivo in mouse embryos. We also evaluate these
families for the task of assessing the similarity within sets of
sequences, again using both the simulated sequences as men-
tioned previously and the CRM data from Blow et al. (2010).

Our evaluation is based on 90% conﬁdence intervals (CI) for
the area under the receiver operational characteristic (ROC) curve
( A UC ), which is implemented by the R package ROCR in Sing
et al. (2005). In Hardison and Taylor (2012), it is emphasized
that it is often the number of false positives that make CRM
prediction not very successful. Hence, we also assess the perform-
ance of our statistics through 90% CIs for the false-positive rate
at 20% sensitivity. We say that a statistic outperforms the other
if the 90% CIs of the former statistic is smaller than the lower
bound of the 90% CI of the latter statistic.

We ﬁnd that although for real data all of our statistics show a
similar performance, on simulated data, the Shepp-type statistics
are in some instances outperformed by star-type statistics. The
multiple alignment-free statistics are more sensitive to contamin-
ation in the data than the pairwise average statistics.

The article is organized as follows. In Section 2, we introduce
two families of multiple alignment-free statistics, called C7 and
Cf, for l > 2. Moreover, three families of average pairwise

 

 

 

 

2691

112 /810's112umo[pJOJXO'sopemJogurorq/pd11q IIIOJJ pepeolumoq

910K ‘09 lsnﬁnV no :2

J.Ren et al.

 

alignment-free statistics, called Oi, Cg and C560, are introduced
with the identiﬁcati_on prcﬂm in mind, as well as their
generalizations —3, C59 and f for measuring similarity within
a set of sequences. Section 3 contains the evaluation and compari-
son of these statistics for the CRM identiﬁcation problem.
Section 4 addresses the problem of measuring the similarity
within a set of sequences. In Section 5, we assess the effect of

contamination in the data. We summarize our results in Section 6.

2 METHODS

2.1 Multiple alignment-free statistics

Let {A(1),A(2), ...,A(’)} be a set of sequences, where AU‘) has length nk.
Assume that the sequences follow a ﬁrst order time-homogeneous irre-
ducible aperiodic Markov chain with transition matrix T and stationary
distribution It. For a word w = W1, wz, .. . , wk, the probability of word
w in the ith sequence is then P9 = 7r(i)(w1) ﬁll-{:2 £4, wj. We extend w to
include its reverse complement v71. Then in our deﬁnition,

29 = (ngj + X9) — (n,- — k + 1)(P<,;'> + 109),

where XE? is the number of occurrence of word w in the sequence A“).

Our proposed statistics use the absolute centralized word count vari-
able |A~’(,? l; we call these the absolute statistics. We deﬁne our absolute star-
type multiple alignment-free sequence comparison statistic by

I -
2k _1_11 IX(,?I
(3704(1), ...,Aw) : L (2)

l ~l l %
 Lg. (WI) } -

Similarly, following Quine (1994), our absolute Shepp-type multiple
alignment-free sequence comparison statistic is deﬁned as

I
2 Hi?”
CﬂAur ...,Aw) : L1 (3)

1 ~ 1 l 7
H{ 2 (X520) 
I234 2i[and
{Z}; (ﬂy—152}
22,—» = 29> . . 21—0215“) . . 

For measuring the similarity within a set of sequences, we directly
apply these statistics to a set of sequences as a measurement of similarity.
Larger values indicate higher similarity among the sequences, and thus
higher conservation of regulatory patterns for these sequences. We also
use these multiple alignment-free statistics for the CRM identiﬁcation
problem, by measuring the similarity within a set of sequences containing
one candidate sequence and the known CRM sets. Higher values of the
statistics indicate higher similarity among the candidate sequence and
the known CRM sequences, and a higher likelihood that the candidate
sequence has a similar regulatory pattern as the given CRMs.

Although it would be tempting to use as extension of D3 and Dig, the
statistics based on the products of the centred counts A71? , these extensions
do not work well when the number of sequences is odd. Indeed, for
pairwise D2 type statistics, for closely related sequences, the centralized
counts should often have the same signs so that the product AXWDAXWZ)
would often be positive. However, for the multiple alignment-free statis-
tics with an odd number of sequences, when all the centralized counts
have a negative sign, their product will give a negative contribution to
the similarity score. Therefore, instead of using A79, we use the absolute
centralized word count variable If? I; in the supplementary material, we

where [170) 2

also report on the statistics corresponding to (2) and (3) using the original
centralized word count variables XE? and the squared centralized word
count variables X 9 2 (X9)?

2.2 Average pairwise alignment-free statistics

2.2.1 Identification of CRMS Here, we consider what we call the
CRM identiﬁcation problem: Given a set of CRM sequences with similar
TFBSs regulatory pattern, how can we identify new CRMs in the genome
that belong to a similar regulatory pattern as the given CRMs? Suppose
that we have a set of identiﬁed CRM sequences S0 2 {S1, S2, .. . , s,} with
a similar regulatory pattern, and we have a set S1 = {C1, 62, ..., ck} of
candidate sequences. We want to pick CRMs from the candidate set that
have a similar regulatory pattern as sequences in S0.

There are two possible approaches to this problem. On the one hand,
we can use C7+1(s1, ...,sl; 6,) and Cir1(s1, ...,sl; 6,) as the similarity
score. On the other hand, we can measure the similarity by averaging
over the pairwise alignment-free statistics D; or DS, respectively; the
length-adjusted versions are

— 1 1
C331, ---,S1; Ci) = 7: C30), Ci) and (4)
j=1
— 1 1
C501. ...,.w; c.) = 72 630,-, c2). (5)
j=1

A closer look reveals that C§(s1, ...,sl; c,) is the inner product be-
tween the standardized and normalized k—tuple vector of sequence c,
and the arithmetic mean of the standardized and normalized k-tuple
vector of sequence s1, . . . ,sl. By taking the geometric mean of the stan-
dardized and normalized k—tuple vectors of sequences s1, ...,s1 instead
of arithmetic mean, we create another length-adjusted statistic
C§90(s1, ...,sl; 6,) based on livid,

C§eO(s1, ...,sl; 6,) = Z

a
weAk Z<|yh<ci>|>l+1 ’
k W

I}??? (cal

 

weA

l A7361")
x: 1‘1—' ' . (6)

weAk 1:1 ~ - l U]
(2 (lXii’(s’)l))

weAk

Instead of taking the geometric mean based on the absolute centralized
counts, we could have based it on the squared centralized counts. In
simulations, we ﬁnd that calculating the squared statistics requires
more computations than the absolute version without considerable gain
in precision, see Supplementary Materials 1.2.

2.2.2 Measuring similarity within sets of sequences Now, we
consider the task of assessing the similarity within sets of sequences. For
a set S 2 {S1, S2, .. . , St}, the multiple alignment-free statistics (2)—(3)
can be used to measure the similarity within a set of sequences, but the
average pairwise statistics need to be extended. Let S_,- 2 {S1, ...,si_1,
si+1, .. . , s1}. We deﬁne three average pairwise alignment-free statistics

 

_ 1
3(3) = i2 C§(S_z-; s2), (7)
i=1
1
62(3) = §Z C§(S_.-; s2). and (8)
i=1
— 1
6590(3) =§Zcé“(s_.-;s.-). (9)
i=1

 

2692

112 /810's112umo[pJOJXO'sor112u1101urorq//2d11q 111011 pepeolumoq

910K ‘09 isnﬁnV no 22

Multiple alignment-free sequence comparison

 

2.3 A simple example

We illustrate the methods with a simple example of the following ﬁve
sequences, (i) ‘ATGCATAT’, (ii) ‘ATATATGC’, (iii) ‘ATGCATGT’,
(iv) ‘ATATGCAT’, (v) ‘CTCGGAGA’, where the second sequence is
the ﬁrst one with the ﬁrst and second half transposed; the third sequence
is the ﬁrst one with the second-to-last position changed from ‘A’ to ‘G’;
the fourth sequence is the complement of the ﬁrst one; and the last one
has no 2-tuples in common with the other sequences. With k = 2, and all
letters equally likely and independent (so PW = 1 / 16), the 5 by 5 matrices
calculated based on C3 and C“; are

1.00 0.93 0.84 1.00 —0.44
0.93 1.00 0.61 0.93 —0.41
C: = 0.84 0.61 1.00 0.84 —0.52
1.00 0.93 0.84 1.00 —0.44
—0.44 —0.41 —0.52 —0.44 1.00

and

1.00 0.89 0.76 1.00 —0.39
0.89 1.00 0.59 0.89 —0.30
Cg: 0.76 0.59 1.00 0.76 —0.43
1.00 0.89 0.76 1.00 —0.39
—0.39 —0.30 —0.43 —0.39 1.00

As our statistics include the reverse complement, sequences 1 and 4
have a pairwise similarity of 1. Both of these pairwise statistics consider
transposition as closer to the original sequence than the change of one
letter; C; gives a higher score than C; for comparisons between the ﬁrst
four sequences, which are similar, and a lower score to comparison with
the last sequence, which is different from the other sequences.

We also calculate the multiple statistics for comparing all 10 combin-
ations of three sequences, see Table 1. Note that the valu_es of the statistics
cannot be compared acrog methods, and C*, Cf and 03’“ range between

 

0 and 1, whereas G; and C—§ and take values in the range between —1 and

+1. For pairs of triplets that only differ in whether sequence 1 or se-
quence 4 is included (such as {1, 2, 3} and {2, 3,4}), the similarity scores
are the same; for such pairs, we only report the results when 1 is included.
The scores for triplets involving both sequence 1 and 4 differ from the
pairwise scores; adding the sequence 4 increases all scores except the Cf
score for {1,2, 4}.

We would expect that the statistics pick up that sequence 5 is dis-
similar to sequences 1—4. The pairwise similarity score between the
sequences 1—4 and sequence 5 are all negative, indicating the strong
dissimilarity between them. Similarly, the triplets including the sequence
5 have signiﬁcantly smaller values of the similarity score than the
others. C7 and the three pairwise average statistics give the highest
score for {1,2,4}, whereas Cf gives its highest score for {1,3,4}, by
considering the transposition as a more severe change than the change

Table 1. The multiple statistics for comparing three sequences from
the ﬁve sequences, (i) ‘ATGCATAT’, (ii) ‘ATATATGC’,
(iii) ‘ATGCATGT’, (iv) ‘ATATGCAT’, (v) ‘CTCGGAGA’

 

 

 

 

Triplets C? C? C—3 C3 C3790
{1, 2, 3} 0.82 0.60 0.79 0.75 0.83
{1, 2, 4} 0.95 0.80 0.95 0.93 0.94
{1, 2, 5} 0.40 0.49 0.03 0.07 0.65
{1, 3, 4} 0.89 0.81 0.89 0.84 0.92
{1, 3, 5} 0.44 0.52 —0.04 —0.02 0.70
{1, 4, 5} 0.42 0.62 0.04 0.07 0.70
{2, 3, 5} 0.38 0.38 —0.11 —0.05 0.61

 

of one letter. All ﬁve statistics give the lowest score to {2, 3, 5}. The

 

multiple statistics as well as @ assign the second-lowest scores
to {1,2, 5}, whereas the averaging statistics C; and C—§ assign their
second-lowest scores to {1, 3, 5}.

When replacing sequence 3 to be ‘ATACATAT’, that is, we replace
the third letter ‘G’ by ‘A’ instead of replacing the second-to-last letter ‘A’
by ‘G’, then all ﬁve statistics assign the lowest score to {1,3,5} (data
not shown).

3 PERFORMANCE ON CRM IDENTIFICATION

First, we evaluate and compare the proposed statistics (2)—(6) on
the CRM identiﬁcation problem. Given a set of known
CRM sequences S0 = {s1,s2, ...,s;} that have a similar TFBS
regulatory pattern, and a set of candidate sequences
S1={c1,c2,...,ck}, which contains both CRMs and back-
ground sequences, we group So with each candidate sequence
c,- separately, where c,- 6 S1. Then, we ﬁnd the similarity score
for each set of sequences {S0; c,} and predict that groups with
higher score have the higher similarity.

3.1 Simulation study

To simulate the data for the CRM identiﬁcation problem, we
generate two types of sequences: the ﬁrst type are to resemble
CRM sequences, with common binding motifs inserted, and the
second type are background sequences, without any motifs. For
simplicity, we refer to the ﬁrst type as CRM sequences in this
subsection. We generate the simulated sequences following the
‘common motif” model proposed in Reinert et al. (2009) but
under the ﬁrst-order Markov chain sequence background
model instead of an i.i.d model.

Let A = {A, C, G, T} denote the nucleotide alphabet. For a
background sequence A1, . . . ,An of length n consisting of letters
from A, each letter A k is generated sequentially under an irredu-
cible aperiodic ﬁrst-order Markov chain model, parameterized
by a transition probability matrix T, where T i, J- = Prob(Ak+1 =
lek = i), i, j e A. Based on the transition matrix, we derive the
stationary distribution 7r. Then, the letter A1 of the ﬁrst position
is randomly chosen according to 7t, and subsequent letters Ak+1
are randomly generated depending on the previous letter Ak fol-
lowing the Afch row of the transition matrix T. Here, we use the
Markov transition matrix estimated from the real CRM
sequences in mouse forebrain.

To generate CRM sequences, we insert the motif word
m = AGCCA of length L = 5 randomly into the background
sequence at rate 1 — A. That is, for a background sequence
A1, ...,An with length n, where Ak e A,k =1, ...,n, we gener-
ate Bernoulli random variables Z1, Z2, . . . ,Zn_L+1 with
Prob(Zk = 1) = 1 — A. If for position k, Zk = 1, and no motif
has been inserted which overlaps position k, then we replace
AkAk+1...Ak+L_1 by the word m. Motif insertions are not
allowed to overlap.

This toy model is clearly overly simplistic; CRMs are often
deﬁned by their functional output rather than their motif con-
tent. Hence, the shared motif content of similar CRMs can be
rather complicated. Yet, the model picks up on one mechanism
that may relate CRMs, see Hardison and Taylor (2012), and it is
useful as a model to assess the performance of the ﬁve statistics.

 

2693

112 /810's112umo[pJOJXO'sor112u1101urorq//2d11q won pep1201umoq

910K ‘09 isnﬁnV uo 22

J.Ren et al.

 

Table 2. (a) The 90% CI of AUC scores and (b) the 90% CI of false-positive rate at 20% sensitivity for the CRM identiﬁcation problem on simulated
data over 100 repeats under a ﬁrst-order Markov chain, N = 1000, k = 5, |So| = 10, |SCRM| = 100, |Sbkg| = 100; 1 — A is the motif density

 

 

A C7 Cf C3 C229 C59”

(a) The 90% CI of AUC scores
0.95 [1 .00,1 .00] [065,083] [100,100] [1 001.00] [1 .00,1 .00]
0.97 [1 .00,1 .00] [057,075] [100,100] [1 001.00] [1 .00,1 .00]
0.99 [099,1.00] [048,063] [098,100] [093,098] [098,100]
0.991 [098,1.00] [046,062] [097,099] [091,097] [097,100]
0.993 [096,099] [046,062] [091,097] [082,092] [092,098]
0.995 [088,095] [045,059] [078,089] [069,082] [075,089]

(b) the 90% CI of the false positive rate at 20% sensitivity
0.95 [000,000] [000,006] [000,000] [000,000] [000,000]
0.97 [000,000] [001,012] [000,000] [000,000] [000,000]
0.99 [000,000] [007,024] [000,000] [000,000] [000,000]
0.991 [000,000] [007,026] [000,000] [000,001] [000,000]
0.993 [000,000] [008,025] [000,000] [000,002] [000,000]
0.995 [000,000] [010,027] [000,003] [000,008] [000,002]

 

Moreover, we can relate the results to previous studies such as
Reinert et al. (2009), which used the same toy model.

We set the length of sequences in both the positive and the
negative sets to N: 1000 base pairs. We consider A e {0.95,
0.97, 0.99, 0.991, 0.993, 0.995}. For each value of A, we ﬁrst gen-
erate 10 CRMs as the known CRM set S0. Then, for the candi-
date set Sl, we generate 200 sequences in total—a set SCRM of
100 CRMs with the same motif word m and the same insertion
rate A as for S0, and a set Sbkg of 100 background sequences. For
each of the following experiments, we simulate 100 repeats.

Table 2 shows (a) the 90% CI of AUC score and (b) the 90%
CI of false-positive rate at 20% sensitivity of the ﬁve similarity
measures (2)—(6) over 100 repeats under the ﬁrst-order Markov
chain sequence model, when N = 1000, k = 5, |S0| = 10,
|SCRM| = 100, |Sbkg| = 100, A e {095,097,0.99,0.991,0.993,
0.995}.

For the 90% CI of AUC scores, most of the statistics show a
good performance and, based on a 90% CI, are not statistically
signiﬁcantly different, with the exception of CS, which is outper-
formed by the other statistics. As Reinert et al. (2009) and Song
et al. (2013) ﬁnd that Shepp-type statistics are worse than star-
type statistics in their simulation studies, the poor perfomance of
C? is not a surprise.

When A is larger than 0.995, the values of the AUC score for
our statistics become close to 0.5 (data not shown), which is the
AUC expected from random guesses. The reason behind this
deterioration is simply that the higher A is, the fewer motifs are
inserted in the generated CRM sequences. For example, when
A = 0.997, there are 30% of CRM sequences having at most one
instance of the motif inserted. When A = 0.999, then 65% of
CRM sequences have at most one instance of the motif inserted.
The 5% precision values give similar results, with much larger
standard deviations due to smaller numbers; they can be found in
the Supplementary Table S1.

The false-positive rates at 20% sensitivity are fairly low with
the exception of CS, which is outperformed by all other statistics
for large A.

3.2 Mouse tissue data

Although the results from the simulation study are encouraging,
we need to test the statistics on real data, and we use CRM data
as our test case. Tissue-speciﬁc enhancers in mouse embryos have
been identiﬁed in Blow et al. (2010) using ChIP-Seq technology
with the enhancer-associated protein p300. There are four tissues
under study, namely, forebrain, midbrain, limb and heart. We
take the four datasets one by one as our experimental data.

We ﬁlter out the CRM sequences that are too long or too
short because our statistics may not work well when there is
considerable heterogeneity in sequence length in conjunction
with a possible model mis-speciﬁcation. Therefore, we take se-
quences with length between 1000 and 1100 base pairs and
ensure a maximum of 30% of repetitive region, as our CRM
sequences. There are 106 of 2759 sequences meeting the criteria
in forebrain dataset, 142 of 2786 in midbrain, 102 of 3839 in limb
and 78 of 3597 in heart. Supplementary Table S4 of the supple-
mentary materials shows the results for the full dataset; they are
qualitatively similar.

As an indication of the strength of the regulatory patterns in
CRM, we use the QuEST Scores as provided in the supplemen-
tary table of Blow et al. (2010). We use the CRMs with the 15
highest QuEST scores as the candidate sequences for S0 and
denote them as S1300]; the set S12?ng of the remaining CRMs is
taken as set of candidate sequences for SCRM. For the set Sbkg,
we randomly select a set S22: of sequences with the same length
as the sequences in S’g’l‘éjl from the mouse genome.

We randomly choose 10 sequences from S3001 to form the set
S0, and 30 sequences from S’g’lggl as well as 30 sequences from
S22: to form the candidate sequences set S1. Assuming that the
sequences come from a ﬁrst-order Markov chain model, we cal-
culate the ﬁve statistics (2)—(6) to score the similarity within each
set {S0; c,}, where c,- 6 S1, and evaluate their prediction accuracy
by the AUC. We repeat the experiment 30 times. Table 3 shows
(a) the 90% CI of AUC scores and (b) the 90% CI of false-
positive rate at 20% sensitivity of each of the ﬁve statistics in
mouse forebrain, midbrain, limb and heart tissue enhancers

 

2694

112 /810's112umo[pJOJXO'sor112u1101urorq//2d11q won pep1201umoq

910K ‘09 isnﬁnV uo 22

Multiple alignment-free sequence comparison

 

Table 3. (a) The 90% CI of AUC scores and (b) the 90% CI of false-positive rate at 20% sensitivity for the CRM identiﬁcation on four mouse tissue-

speciﬁc enhancer datasets, under a ﬁrst-order Markov chain; N = 1000 — 1100 bp, k = 5, |So| = 10, |SCRM| = 30, |Sbkg| = 30

 

 

Tissue C7 Cf C3 C229 C5590

(a) The 90% CI of AUC scores
Forebrain [052,069] [067,085] [058,077] [055,074] [051,071]
Midbrain [051,071] [055,071] [064,081] [061,079] [053,074]
Limb [068,082] [058,083] [069,086] [064,081] [062,083]
Heart [041,062] [052,077] [057,079] [058,078] [051,067]

(b) The 90% CI of the false-positive rate at 20% sensitivity
Forebrain [000,019] [000,007] [000,014] [002,019] [002,017]
Midbrain [007,025] [000,020] [000,015] [000,015] [007,027]
Limb [000,008] [000,010] [000,005] [000,013] [000,012]
Heart [007,027] [000,017] [000,022] [003,017] [007,029]

 

datasets, under the ﬁrst-order Markov chain model and k = 5.
The average values are located fairly in the middle of the inter-
vals (data not shown).

For the AUC scores, all of the 90% CIs for each tissue type
overlap, indicating that the statistics perform similarly. It is not-
able that the 90% AUC CIs for the limb dataset are on average
higher than those in the other three datasets. This ﬁnding is
consistent with the fact that the sequences in limb dataset have
relatively high QuEST scores, indicating that the limb dataset has
a strong regulatory signal. Most of the 90% CIs for the false-
positive rate at 20% sensitivity contain 0, and they all overlap,
indicating again that the statistics perform similarly.

Summarizing our results from the simulation study and the
mouse tissue data, while all the statistics perform similarly on the
real data, in the simulation study the combined Shepp-type stat-
istic C? is outperformed by the other statistics for large A.

4 PERFORMANCE ON MEASURING SIMILARITY

To assess whether a set of regulatory sequences such as the set of
CRMs are scored higher by our proposed statistics (2)—(3) and
(7)—(9) than a set of unrelated sequences randomly chosen from
the genome, we construct the evaluation model as follows. We
make up two sets of sequences: the so-called positive set contain-
ing CRM sequences with a similar regulatory pattern and the so-
called negative set containing unrelated sequences randomly
chosen from the genome. The two sets are constructed to contain
the same number of sequences and have the same lengths. Each
triplet of three sequences from the positive set is measured for
their similarity by the proposed ﬁve statistics, and so is each
triplet in the negative set. We assess the statistics by ﬁrst ranking
all triplets from both positive and negative sets by their scores.
Triplets from the positive set are treated as ‘+’ and triplets from
the negative set are treated as ‘—’. For a given threshold, if the
value of a statistic for a triplet is above the threshold, the triplet is
predicted as ‘+’; otherwise the triplet is predicted as ‘—’.

4.1 Simulation study

Following the simulation methods detailed in Section 3.1, we
generate 50 CRM-like sequences for the positive set, and 50

background sequences for the negative set, all of length
N = 1000 base pairs. We carry out the experiment for motif in-
sertion rate A e {0.95, 0.97, 0.99, 0.991, 0.993, 0.995}. For each A,
we repeat the experiment 30 times and calculate the 90% CI of
AUCs together with that of the false-positive rate at 20% sensi-
tivity. Table 4 shows (a) the 90% CI of AUC score and (b) the
90% CI of false-positive rate at 20% sensitivity of the ﬁve simi-
larity measures on simulated data, under the ﬁrst-order Markov
chain sequence model. =

In this simulation study, the Shepp-type statistics C? and C59

 

are outperformed by the other statistics when A is large, and w
is outperformed by the star-type statistics for A = 0.993. This
conclusion is consistent with the simulation results for the
CRM identiﬁcation problem.

4.2 Mouse tissue data

In this section, we use the tissue-speciﬁc enhancers in mouse
embryos (Blow et al., 2010) again. Four tissues, forebrain, mid-
brain, limb and heart, are studied as separate datasets. Again,
we take the CRM sequences with 1000—1100 bp as our CRM
sequences pool. For the background sequences pool, we ran-
domly select sequences from the mouse genome, of the same
length as that of the CRM sequences.

For each tissue, we randomly choose 20 CRMs from the CRM
pool as the positive set, and we choose 20 background sequences
from the background sequences pool as the negative set. Then
we calculate statistics (2)—(3) and (7)—(9) for the triplets from the
positive set and from the negative set, and we compute the AUC;
again we run 30 repetitions. Table 5 presents (a) the 90% CI of
AUC scores and (b) the 90% CI of false-positive rate at 20%
sensitivity for the ﬁve statistics on each of mouse four tissue-
speciﬁc enhancer datasets under the ﬁrst-order Markov chain
model, and k = 5; again the average AUC scores lie in the
middle of the intervals, and the 5% precision scores can be
found in the appendix.

For each tissue type, all of the 90% CIs overlap, showing that
the statistics perform similarly.

We repeated the experiment on the full dataset, without
restricting the sequence length, giving similar results, see

 

2695

112 /810's112umo[pJOJXO'sor112u1101urorq//2d11q won pep1201umoq

910K ‘09 isnﬁnV uo 22

J.Ren et al.

 

Table 4. (a) The 90% CI of AUC scores and (b) the 90% CI of false-positive rate at 20% sensitivity for measuring similarity within a set of sequences on
simulated data, under the ﬁrst-order Markov chain sequence model, N = 1000, k = 5, |positive set| = 50, Inegative set| = 50; 1 — A is the motif density

 

 

A C7 C79 C7 C229 C59”

(a) The 90% CI of AUC scores
0.95 [1 .00,1 .00] [099,1 .00] [1 .00,1 .00] [1 .00,1.00] [1 001.00]
0.97 [1.00,1.00] [088,095] [1.00,1.00] [1.00,1.00] [1001.00]
0.99 [089,099] [056,069] [095,099] [085,091] [077,091]
0.991 [083,098] [051,070] [093,097] [082,088] [069,089]
0.993 [067,088] [048,065] [083,091] [072,081] [057,078]
0.995 [053,076] [048,070] [070,081] [063,073] [051,072]

(b) The 90% CI of false-positive rate at 20% sensitivity
0.95 [000,000] [000,000] [000,000] [000,000] [000,000]
0.97 [000,000] [000,000] [000,000] [000,000] [000,000]
0.99 [000,000] [005,014] [000,000] [000,001] [000,001]
0.991 [000,000] [004,019] [000,000] [001,001] [000,003]
0.993 [000,001] [007,023] [000,001] [001,005] [001,012]
0.995 [001,016] [005,023] [001,005] [004,009] [003,021]

 

Table 5. (a) The 90% CI of AUC scores and (b) the 90% CI of false-positive rate at 20% sensitivity for measuring similarity within a set of sequences
based on four mouse tissue-speciﬁc enhancer datasets, under ﬁrst-order Markov chain background sequences, N = 1000 — 1100 bp, k = 5,

|positive set| = 20, Inegative set| = 20

 

 

Tissues C7 of C7 0; w

(a) The 90% CI of AUC scores
Forebrain [062,096] [060,087] [057,080] [051,079] [069,097]
Midbrain [065,093] [054,086] [058,083] [052,080] [068,094]
Limb [075,097] [051,083] [064,089] [055,083] [077,099]
Heart [049,087] [047,074] [058,078] [050,072] [061,088]

(b) The 90% CI of the false-positive rate at 20% sensitivity
Forebrain [000,0. 10] [000,013] [002,013] [003,022] [000,006]
Midbrain [000,011] [001,021] [001,014] [002,022] [000,010]
Limb [000,007] [001,016] [000,009] [001,015] [000,005]
Heart [001,016] [004,025] [002,012] [005,020] [000,012]

 

Supplementary Tables S11 and S12. Again the AUC scores have
relatively large deviations, and the differences between the AUC
scores of the different statistics are not statistically signiﬁcant.

5 THE EFFECT OF CONTAMINATION

To study the sensitivities of the statistics to the contamination of
S0 with random sequences, we carry out a simulation experi-
ment; we concentrate on the CRM identiﬁcation problem. For
the simulation with |S0| = 10, |S1| = 100, |S2| = 100, k = 5 and
N = 1000, we randomly replace 10, 20 and 30% of sequences in
S0 with background sequences, to model the contamination of
sequences in S0. Figure 1 shows the results of this simulation.
We ﬁnd that both multiple alignment-free statistics 7 and C7
are relatively more sensitive to the contamination because
for A = 0.95, the AUC scores of C7 begins to drop at
10% random sequences mixed into S0, and the AUC scores
of C7 drops at the 20% contamination of S0, whereas the

other three pairwise average statistics —7, C59 and C560 keep
their AUC scores to be 1. When A = 0.993, the statistics 7,
C? and Cg“ have the Ewest lower bounds, whereas the
performance of C7 and Cg is relatively stable. As the AUC
scores of C? have already been ~05 (near to random guess),
they do not decrease further.

The simulation study indicates that the multiple alignment-free
statistics perform well when the sequences in So have a strong
regulatory pattern, but the mixture of random sequences in So
could largely reduce the performance of the multiple alignment-
free statistics, compared with the pairwise average ones. In real
data, our results in Table 3 show the similar trend. Blow et al.
(2010) states that the forebrain CRM dataset is the most con-
served in the four datasets, indicating most of the forebrain
CRM sequences are real, and the fraction of random sequences
is low. In our results, Cf gives the best performance in forebrain
dataset at the average values. The fact is consistent with the
ﬁndings in Blow et al. (2010).

 

 

2696

112 /810's112umo[pJOJXO'sor112u1101urorq//2d11q won pep1201umoq

910K ‘09 isnﬁnV uo 22

Multiple alignment-free sequence comparison

 

0% 10% 20% 30% 0% 10% 20% 30% 0% 10% 20% 30%

 

 

 

 

 ‘— — 0561096232530“,
3 _
e g ' T
o N 0%
8 o i
O ‘0. _ 10%20%3°%
:3 ° i
.:<_ m. - ii
o
0
ﬂ 2;- -
U
s: 8'-
05 N. _
o
g _
o _
I I I I I
S —’ —3 gen
c:I CI C2 C2 C2
 ‘— _ “hm-I— -- —.— "'T
o 10% "' o
g _ 20%T _I__,_2_Ol_:ﬁ)l:6 ET 4.1096210;
J_1o% T i
q _ 30% J_ZO% 30% 30%
9 o J_J_ J
O n
O o' -
(I)
s 9- T
< u, o%1o%2°%3o%
“5 ° J—J-J_J.
U) V: _
6 o
as 8 -
C
CD N. _
D
g _
o _
I I I I I
‘ s _' _s W
0| CI 02 C2 C2

Fig. 1. The 90% CI of AUC score (the bar) and average AUC scores (the
position of the number) of the ﬁve statistics for the CRM identiﬁcation
on 0, 10, 20 and 30% contaminated So sequences, under a ﬁrst-order
Markov chain, N: 1000, k = 5, |So| = 10, |SCRM| = 100, |Sbkg| = 100;
1 — A is the motif density, and 0% refers to the results in Table 2, for
comparison with the case of no contamination of S0. The parameter
values are (a) A = 0.95 and (b) A = 0.993.

Further, to assess whether less contaminated data can improve
the performance of the multiple alignment-free statistics, we use
a more restricted criterion to construct So. In every experiment of
the 30 repeats, we randomly pick up ﬁve sequences from the
CRMs with the 10 highest QuEST scores to construct S0, 30
sequences from the remaining CRMs with 50 highest scores to
construct SCRM and 30 sequences from the background se-
quences generated in the same way as before. In this setting
the average values of AUC score of the multiple alignment-free
statistics increase more than those of the pairwise average statis-
tics, although their CIs overlap.

6 DISCUSSION

The success of the alignment-free sequence comparison statistics
D7 and D59 as studied in Reinert et al. (2009) and Wan et al.
(2010) inspired us to deﬁne natural extensions for multiple
alignment-free sequence comparison. We propose two
families of multiple alignment-free statistics, C7 and CS, which
involve products of more than two vectors, and we compare
these families to three families of average pairwise alignmen_t-
free statistics, —7, Cg and W, with generalizations —7, Cg
and C527“.

Our statistics are tested on two problems, namely, the CRM
identiﬁcation problem (given a set of CRMs, identify new CRMs
belonging to similar regulatory patterns as the given CRMs) and
measuring the similarity within a set of CRM sequences. We

 

evaluate the statistics both on simulated data and on mouse
tissue data.

For both the CRM identiﬁcation and measurement of the
similarity within a set of CRM sequences, in simulations, the
Shepp-type statistics are outperformed by other statistics when
A is large, whereas on real data, all of the 90% CIs overlap. The
false-positive rate at 20% sensitivity is encouragingly small not
only in simulations but also in real data. Contamination has a
stronger effect on the multiple statistics than on the pairwise
average statistics.

While Song et al. (2013) and Jiang et al. (2012) observed that
the Shepp-type statistics outperform the star-type statistics for
the comparison of whole-genome sequences and metagenomic
communities, respectively, based on NGS reads data, here our
data do not conﬁrm this ﬁnding. Our data are consistent with the
simulation results in Reinert et al. (2009); Wan et al. (2010),
which show that for short sequences the star-type statistics per-
form better, whereas for long sequences, the Shepp-type statistics
perform better; the CRM sequences in this article are of length
of order 1000 bp and can hence be considered as short.

Our results on the real dataset when restricted to sequences
of length 1000—1100 bp do not differ signiﬁcantly from those
on the full real dataset, indicating that our statistics control for
sequence length.

Although on the CRM data we use, there is no signiﬁcant
difference between all ﬁve statistics, we conjecture that on
high-quality data, the multiple statistics may outperform the
average pairwise statistics. With the impending arrival of more
high-quality data, our suite of statistics provides a toolbox ready
to be used.

Pairwise alignment-free statistics have been generalized to
allow for k-tuple word mismatches, see Burden et al. (2008)
and G6ke et al. (2012). It would be straightforward to extend
our multiple alignment-free statistics to allow for word mis-
matches; the choice of mismatch weights is however not obvious,
see G6ke et al. (2012).

ACKNOWLEDGEMENTS

The authors would like to thank the referees for very helpful
comments, which improved the article.

Funding: G.R. was supported in part by the Oxford Martin
School. F .S. is partially supported by US NIH R21HGOO6199;
and NSF DMS—1043075 and OCE 1136818. MD. is supported
by the National Natural Science Foundation of China
(31171262, 11021463), and the National Key Basic Research
Project of China (2009CB918503).

Conflict of Interest: none declared.

REFERENCES

Arunachalam,M. et al. (2010) An alignment-free method to identify candidate
orthologous enhancers in multiple drosophila genomes. Bioinformatics, 26,
2109—2115.

Blaisdell,B. (1986) A measure of the similarity of sets of sequences not requiring
sequence alignment. Proc. Natl Acad. Sci. USA, 83, 5155—5159.

Blow,M. et al. (2010) Chip-seq identiﬁcation of weakly conserved heart enhancers.
Nat. Genet, 42, 806—810.

 

2697

112 /810's112umo[pJOJXO'sor112u1101urorq//2d11q won pep1201umoq

910K ‘09 isnﬁnV uo 22

J.Ren et al.

 

Burden,C. et al. (2008) Approximate word matches between two random sequences.
Ann. Appl. Probab., 18, 1—21.

Davidson,E. (2006) The Regulatory Genome: Gene Regulatory Networks In
Development and Evolution. Elsevier, Burlington, MA.

G6ke,J. et al. (2012) Estimation of pairwise sequence similarity of mammalian
enhancers with word neighbourhood counts. Bioinformatics, 28, 656—663.

Hardison,R.C. and Taylor,J. (2012) Genomic approaches towards ﬁnding cis-
regulatory modules in animals. Nat. Rev. Genet, 13, 469—483.

Jiang,B. et al. (2012) Comparison of metagenomic samples using sequence signa-
tures. BMC Genomics, 13, 730.

Kantorovitz,M. et al. (2007) A statistical method for alignment-free comparison of
regulatory sequences. Bioinformatics, 23, i249—i255.

Lippert,R. et al. (2002) Distributional regimes for the number of k-word
matches between two random sequences. Proc. Natl Acad. Sci. USA, 99,
13980—13989.

Liu,X. et al. (2011) New powerful statistics for alignment-free sequence comparison
under a pattern transfer model. J. T heor. Biol., 284 (1), 106—116.

Needleman,S. et al. (1970) A general method applicable to the search for similarities
in the amino acid sequence of two proteins. J. Mol. Biol., 48, 443—453.

Quine,M. (1994) A result of Shepp. Appl. Math. Lett., 7, 27—32.

Reinert,G. et al. (2009) Alignment-free sequence comparison (i): statistics and
power. J. Comput. Biol., 16, 1615—1634.

Shepp,L. (1964) Normal functions of normal random variables. SIAM Rev., 6,
459—460.

Sing,T. et al. (2005) ROCR: visualizing classiﬁer performance in R. Bioinformatics,
21, 3940—3941.

Smith,T. and Waterman,M. (1981) Identiﬁcation of common molecular subse-
quences. J. Mol. Biol., 147, 195—197.

Song,K. et al. (2013) Alignment-free sequence comparison based on next generation
sequencing reads. J. Comput. Biol., 20, 64—79.

Wan,L. et al. (2010) Alignment-free sequence comparison (ii): theoretical power of
comparison statistics. J. Comput. Biol., 17 (11), 1467—1490.

Wolff,C. et al. (1999) Structure and evolution of a pair-rule interaction element: runt
regulatory sequences in D. melanogaster and D. virilis. Mech. Dev., 80, 87—99.

 

2698

112 /810's112umo[pJOJXO'sor112u1101urorq//2d11q won pep1201umoq

910K ‘09 isnﬁnV uo 22

