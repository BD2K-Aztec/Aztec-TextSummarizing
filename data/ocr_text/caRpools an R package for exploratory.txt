Bioinformatics, 32(4), 2016, 632—634

doi: 10.1093/bioinformatics/btv617

Advance Access Publication Date: 27 October 2015
Applications Note

 

 

Systems biology

caRpools: an R package for exploratory data
analysis and documentation of pooled

CRISPR/Cas9 screens

Jan Winter”, Marco Breinig”, Florian Heigwer1, Dirk Brﬁgemann‘,

Svenja Leible1, Oliver Pelz1, Tianzuo Zhan1

'2 and Michael Boutros1'*

1German Cancer Research Center (DKFZ), Division Signaling and Functional Genomics and Heidelberg University,
Heidelberg, Germany and 2Department of Medicine II, University Hospital Mannheim, Medical Faculty Mannheim,

Heidelberg University, Mannheim, Germany

*To whom correspondence should be addressed.

TThe authors wish it to be known that, in their opinion, the first two authors should be regarded as Joint First Authors.

Associate Editor: Jonathan Wren

Received on August 19, 2015; revised on October 13, 2015; accepted on October 16, 2015

Abstract

Motivation: Genetic screens by CRISPR/Cas9—mediated genome engineering have become a
powerful tool for functional genomics. However, there is currently a lack of end—to—end software
pipelines to analyze CRISPR/Cas9 screens based on next generation sequencing.

Results: The CRISPR—AnalyzeR for pooled screens (caRpools) is an R package for exploratory data
analysis that provides a complete workflow to analyze CRISPR/Cas9 screens. To further support
the analysis of large—scale screens, caRpools integrates screening documentation and generation

of standardized analysis reports.

Availability and implementation: caRpools, manuals and an open virtual appliance are available at

http://github.com/boutroslab/caRpools.
Contact: m.boutros@dkfz.de

 

1 Introduction

CRISPIUCas9—mediated genome engineering can be leveraged for
high-throughput functional genomic screens in vertebrate cells
(Koike—Yusa et 61]., 2014; Shalem et 61]., 2014; Wang et 61]., 2014).
For such screens, Cas9—expressing cells are infected with lentiviral
short guide (sg) RNA libraries. After phenotypic selection, ngNA
sequences serve as barcodes to identify enriched or depleted mutant
clones by next generation sequencing (NGS). Inter—experimental
variations in sequencing quality and depth, variable ngNA cover—
age per gene, on—target efficiency and off—target effects represent
challenges for analysis and hit identification (Diaz et 61]., 2015; Li
et 61]., 2014). The software package CRISPR—AnalyzeR for Pooled
Screens (caRpools) performs exploratory data analysis of CRISPIU
Cas9 screens combined with detailed screening documentation to
enable reproducibility of analyses workﬂows (Boutros et 61]., 2006;
Pelz et 61]., 2010).

2 The caRpools package

The R package caRpools is available as Source code and an open vir—
tual appliance from a public Github repository at http://github.com/
boutroslab/caRpools, which provides a convenient way to analyze
screens without much prior R knowledge. Parameters relevant to
caRpools’ analysis options are adjusted via an Excel file. We provide
a manual to guide users through the installation and running steps.
To showcase caRpools’ functionalities, we supply example datasets
and reports for an unpublished CRISPIUCas9 screen and caRpools re—
ports for two published screens (Shalem et 61]., 2014; Wang et 61].,
2014) (see http://github.com/b0utroslab/caRpools). caRpools is based
on an end—to—end workﬂow composed of four modules (Fig. 1).

2.1 Data handling and quality control
caRpools requires a FASTA file with ngNA identifiers and se—
quences, FASTQ or processed ngNA readcount files of samples,

©The Author 2015. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com 632

91% ‘09 1sn3nv uo sopﬁuv s01 111110;th aIo Amie/xtqu 112 /§.IO'S[BLLIHO[p.IOJXO'SODBIHJOJUIOIQ/ﬁdllq 11101; popeommoq

CRISPR/CasQ screen analysis

633

 

MIARE-File. lirnd Templates, TASTE) r Head-Count Files
T

SETUP fillilALIT'l'r EDHTR'DL

IIATA HAHDIJII DATA ’J'ISHAIJIATIIIH

 

1r “III:

Data Extraction, Mapping, Autornatic Annotation Data Statistics, Readcount Distribution,

Sequencing Depth, Replicate Quality
'1'

4

howtiel mapping; Tables. Bar Plots, Scatter Plots

FASTQ I ngt HA

 

— —
— —
- —r

- —

_ —
— —

 

biomaRt:

l» |iiene_ID 4h ENSEMDLJD
Ir tie-Term annotation
Hinlt to ENSEMEL

HinI-cto Genetards ‘ “.J

 

 

 

 

 

Tables. 'Irenn Diagrams. Scatter Plots. Ear Plots. iiiolin Plots

 

HIT ANALYSIS REFGRT

DATA VISUALIIATIDH DATA SUIIHAI'I'

 

T T

Different Hit Calling Methods. Analysis Comparison, HTML pup Lam
{anciiciate 1risualiiation. ngtNA Deconvolution
1" 1"

Descriptions. Figures. Tables

 

 

I BAH!

Bu.
ENSEHBLJDtllnhmEnwn-Ihl: I H ~:.c-::-'II-:Ir'-:.-'::.~e
" HEM: strramLcunt-Mmserieur-m um:

GENE DESEIHP'I'IDH
Elicia-associated a: promeln

 

 

 

 

EO'I'ERM
mgulal'um uf apo-pmti: FII'EIIIHH

EHSEHBL PROTEIN ID
ENSWUWDEIE?“

 

em: BERNAS

unrest peanut o.o1 Mia-ion
DES-m2 p-tralun: 15-53-551r25
MAGEK p-Hahrecﬂ.m155

 

 

 

 

 

 

Fig. 1. caRpools workflow and functionalities. Schematic representation of main analysis steps for the analysis of CRISPR/CasQ screens using caRpools are

shown

template files for report generation, and a parameter and screen
description file.

caRpools retrieves analysis parameters from a configuration file,
which has been adapted from MIARE (http://miare.sourceforge.net/)
and supports documentation of screens and analysis steps. File paths
for datasets, and parameters required for ngNA target sequence re—
trieval from FASTQ files and hit calling must be entered. Further,
this file includes general information about screening protocols and
settings to e.g. adjust visualizations or to annotate genes with infor-
mation retrieved from biomaRt. Upon execution, caRpools provides
diagnostic plots to evaluate screening performance, including read-
count distribution and sequencing depth plots for each sample,
as well as ngNA coverage and evaluation of included control
ngNAs.

2.2 Hit calling and report generation

caRpools offers three methods to rank candidate genes based on the
phenotypic effect of all ngNAs per gene with orthogonal approaches
(see CaRpools—Manual.pdf). For the ‘Wilcox’ approach, read counts
are median normalized. The fold change of each population of
ngNAs for a gene is tested against the population of non—targeting
control ngNAs or randomly picked ngNAs, using a two—sided
Mann—Whitney test. For the ‘DESeq2’—approach, read counts of all
ngNAs for a given gene are aggregated to generate gene—level read
counts. DESeq2 analysis includes size—factor estimations, variance sta—
bilization using a parametric fit and a Wald—Test to determine the dif—
ference in logz fold changes between the untreated and treated data,
essentially as described (Li et al., 2014; Love et al., 2014). For the
‘MAGeCK’—approach, a rank—based model is used to test for a change
in ngNA abundance after median normalization of the dataset (Li
et al., 2014). Users are asked to familiarize themselves with the specifi-
cations and parameter settings of each method by consulting the
caRpools user manual and the original literature (Love et al., 2014;
Li et al., 2014).

Venn diagrams containing enriched or depleted genes are gener—
ated for direct comparison and can reveal differences between hit
calling methods. Potential pitfalls, e.g. no identified hits with a
defined threshold, or no overlap between methods are reported. Hits
are visualized with annotations as well as links to external

databases. Since ngNA efficiency can vary (Diaz et al., 2015; Li
et al., 2014; Shalem et al., 2014; Wang et al., 2014), caRpools visu—
alizes the performance of all ngNAs/gene and lists respective target
sequences for all candidates so that users can choose efficient
ngNAs. caRpools supports standardized report generation includ—
ing ready—to—use plots and tables in a single step.

2.3 Summary and outlook

caRpools is designed to be user—friendly for novice and expert
users: caRpools’ open virtual appliance allows analysis without prior
programming knowledge. For every hit, caRpools provides biological
information and links to external databases. Finally, caRpools incorp—
orates detailed screening documentation into the analysis process
and generates comprehensive reports. caRpools can be extended to
e.g. include novel hit calling algorithms or to export efficient ngNA
designs to external databases such as Protospacer Workbench
(MacPherson and Scherf, 2015). caRpools’ transparent analysis re—
ports support the establishment of repositories for CRISPR/Cas9
screens and will facilitate meta—analyses of datasets.

Acknowledgement
We thank F. Zhang and T. Wang for reagents and data.

Funding

This work was supported in part by an ERC Advanced Grant, an iMED grant
and a DKFZ Postdoc Fellowship to T.Z.

Conﬂict of Interest: none declared.

References

B0utr0s,M. et al. (2006) Analysis of cell-based RNAi screens. Genome Biol.,
7, R66.

Diaz,A.A. et al. (2015) HiTSelect: a comprehensive tool for high-complexity-
pooled screen analysis. Nucleic Acids Res., 43, e16.

K0ike-Yusa,H. et al. (2014) Genome-Wide recessive genetic screening in mam-
malian cells with a lentiviral CRISPR-guide RNA library. Nat. Biotechnol.,
32, 267—73.

9mg ‘Og 1snﬁnv uo sereﬁuv s01 621111031123 JO A1TSJQATUH 112 /3.IO'S[BUJTIO[p.IOJXO'SOTlBIHJOJUTOTQ/ﬂdllq 11101; pepeorumoq

634

J. Winter at al.

 

Li,W. et al. (2014) MAGeCK enables robust identiﬁcation of essential genes
from genome-scale CRISPR/Cas9 knockout screens. Genome B iol., 15, 554.

Love,M.I. et al. (2014) Moderated estimation of fold change and dispersion
for RNA-seq data with DESeq2. Genome Biol., 15, 550.

MacPherson,C.R. and Scherf,A. (2015) Flexible guide-RNA design for CRISPR
applications using Protospacer Workbench. Nat. Biotechnol., 33, 805—806.

Pelz,O. et al. (2010) web cellHTSZ: a web-application for the analysis of high-
throughput screening data. BMC Bioinformatics, 11, 185.

Shalem,O. et al. (2014) Genome-scale CRISPR-Cas9 knockout screening in
human cells. Science, 343, 84—87.

Wang,T. et al. (2014) Genetic screens in human cells using the CRISPR-Cas9
system. Science, 343, 80—84.

91% ‘09 1sn3nv uo soroﬁuv s01 ‘ETUJOJTIBQ aIo A1TSJQATUH 112 /§.IO'S[BLLIT10[p.IOJXO'SOTlBIHJOJUTOTQ/ﬁdllq 11101; popeorumoq

