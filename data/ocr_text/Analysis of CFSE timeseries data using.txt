Bioinformatics, 32(15), 2016, 2321—2329

doi: 10.1093/bioinformatics/btw131

Advance Access Publication Date: 8 March 2016
Original Paper

 

Systems biology

Analysis of CFSE time-series data using
division-, age- and label-structured population
models

Sabrina Hross1'2 and Jan Hasenauer1'2'*

1Helmholtz Zentrum Miinchen—German Research Center for Environmental Health, Institute of Computational
Biology, Neuherberg 85764, Germany and 2Department of Mathematical Modeling of Biological Systems, Center
for Mathematics, Technische Universitat Miinchen, Garching 85748, Germany

*To whom correspondence should be addressed.
Associate Editor: Janet Kelso

Received on September 28, 2015; revised on February 20, 2016; accepted on March 1, 2016

Abstract

Motivation: In vitro and in vivo cell proliferation is often studied using the dye carboxyfluorescein
succinimidyl ester (CFSE). The CFSE time—series data provide information about the proliferation
history of populations of cells. While the experimental procedures are well established and widely
used, the analysis of CFSE time—series data is still challenging. Many available analysis tools do not
account for cell age and employ optimization methods that are inefficient (or even unreliable).
Results: We present a new model—based analysis method for CFSE time—series data. This method
uses a flexible description of proliferating cell populations, namely, a division—, age— and label—
structured population model. Efficient maximum likelihood and Bayesian estimation algorithms
are introduced to infer the model parameters and their uncertainties. These methods exploit the
forward sensitivity equations of the underlying partial differential equation model for efficient and
accurate gradient calculation, thereby improving computational efficiency and reliability compared
with alternative approaches and accelerating uncertainty analysis. The performance of the method
is assessed by studying a dataset for immune cell proliferation. This revealed the importance of dif—
ferent factors on the proliferation rates of individual cells. Among others, the predominate effect of
cell age on the division rate is found, which was not revealed by available computational methods.
Availability and implementation: The MATLAB source code implementing the models and algo—
rithms is available from http://janhasenauer.github.io/ShAPE—DALSP/.

Contact: jan.hasenauer@helmholtz—muenchen.de

Supplementary information: Supplementary data are available at Bioinformatics online.

 

1 Introduction

 

Proliferation is essential in many biological processes, ranging from
development to wound healing, immune response and stem cell
renewal. Due to this eminent role, a key challenge in cell biology is
to quantify proliferation dynamics. Nowadays, there are different
experimental methods available to assess cell proliferation, e.g.
time—lapse microscopy (Schroeder, 2011) and proliferation assays
based upon carboxyﬂuorescein succinimidyl ester (CFSE) labeling

(Lyons and Parish, 1994). While time-lapse microscopy is highly in-
formative, it is difficult to apply in vivo. CFSE—based proliferation
assays can be employed in vivo and in vitro, but the data analysis is
more intricate and no single—cell time courses are available.

To study proliferation using CFSE, cells are incubated with car—
boxyfluorescein diacetate succinimidyl ester (CFDA-SE). CFDA-SE
can diffuse across the cell membrane and once in the cytoplasm is
converted to CFSE, which binds covalently to intracellular proteins.

©The Author 2016. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com 2321

9mg ‘09 1sn3nv uo sopﬁuv soq 111110;th aIo Amie/xtqu 112 /§.IO'S[BU.IHO[p.IOJXO'SOTlBIHJOJUTOTQ/ﬁ(1111] 11101; pepeommoq

2322

S.Hross and J. Hasenauer

 

CFSE is a ﬂuorescent dye and its concentration is reduced by protein
degradation as well as cell division. During cell division, CFSE is dis-
tributed approximately equally among daughter cells (Lyons and
Parish, 1994); hence, proliferation results in a progressive dilution
of the dye (Fig. 1A), which can be recorded using flow cytometry.
As the individual cells do not, in general, divide with the same rates,
an initially unimodal distribution (Fig. 1B) becomes multi—modal as
time progresses (Fig. 1C). The modes are related to different num—
bers of cell divisions (Hawkins et al., 2007a); however, often the
cells with different numbers of divisions are not strictly separated.
For this reason, the calculation of the number of cells with a certain
division number using peak detection and deconvolution methods
(Hawkins et al., 2007a; Luzyanina et al., 2007a) is error—prone.
Furthermore, even knowledge about the number of cells with a par—
ticular division number does not enable the comparison of different
hypotheses regarding, e.g. the proliferation rates.

The need for quantitative data analysis and hypothesis testing
inspired the development of a multitude of model—based approaches.
Nowadays, age—structured population (ASP) models (Bernard et al.,
2003; Hawkins et al., 2007b), division—structured population (DSP)
models (De Boer et al., 2006), label—structured population (LSP)
models (Banks et al., 2010; Luzyanina et al., 2007b), age— and div—
ision—structured population (ADSP) models (Hawkins et al., 2007b),
and division— and label—structured population (DLSP) models
(Hasenauer et al., 2012; Schittler et al., 2011) are used to study
CFSE data. These classes of population balance models account for
up to two properties of individual cells:

° number of divisions i (—> DSP and DLSP model)
° CFSE concentration x (—> LSP and DLSP model)
° cell’s age a (—> ASP and ADSP model)

and are mostly written as systems of ordinary differential equa—
tions (ODEs) or partial differential equations (PDEs). Population

A

0—;

XTH
<2} 5
<2<ng

0

Q1
@1—<
(E)

 \ cl /

Ah, 

CFSE concentration, x CFSE concentration, :1:

 

\
I

—>

I

I

I

I

I

I

I

I
—I—>

I

I

:

T

Fig. 1. Illustration of proliferation assay showing (A) one labeled cell and its
descendants, (B) the frequency of different CFSE concentration in the cell
population at t=0 and (C) the frequency of different CFSE concentration in
the cell population at t: T. Shades from dark to light gray correspond to high
and low CFSE concentration, respectively

balance models which account for the cell age—the time passed
since cell division—, i.e. ASP and ADSP, can also be formulated as
sets of nested integrals (De Boer and Perelson, 2013). This alterna-
tive formulation is employed for the Smith—Martin model (Smith
and Martin, 1973) and the cyton model (Hawkins et al., 2007b).
For the Smith—Martin model and cyton model (with progression
fraction equal to zero), equivalent PDE formulations are available
(Bernard et al., 2003; De Boer and Perelson, 2013). For a compre—
hensive introduction to structured population models, we refer to
the review by De Boer and Perelson (2013).

As the population models available in the literature did not cap—
ture the complexity of the process, we recently introduced the div—
ision—, age— and label—structured population (DALSP) model (Metzger
et al., 2012). The DALSP model, a system of coupled PDEs, provides
a ﬂexible description of proliferation dynamics (Metzger et al., 2012),
but it has never been used to analyse CFSE data. Accordingly, no par—
ameter estimation, model selection and uncertainty analysis methods
have been available for this type of model until now.

In this manuscript, we introduce methods to infer the parameters
of DALSP models from CFSE distribution time—series data and to as—
sess the dependency of the proliferation rates on factors such as cell
age. For this we introduce a statistical model linking predictions of
the DALSP model to measure CFSE data and formulate the corres—
ponding inverse problem. As the optimization problem is nonlinear,
we compare different optimization procedures. Furthermore, we im-
plement the first identifiability and uncertainty analysis methods for
DALSP models. Combined with model selection methods, these
methods facilitate an in—depth analysis of CFSE time—series data,
which we illustrate for a published dataset.

2 Methods

To analyse CFSE data, we combine mechanistic and statistical mod—
els of the biological process and the measurement process. In the fol—
lowing we present the different ingredients as well as the inference
methods. A more detailed description is provided in the
Supplementary Information.

Notation: We denote the set of non—negative real numbers by
R+ :2 [0, 00) and the set of natural numbers with zero by
N0 2: {0, 1,2, . .  The units used in the following equations are
number of cells (cells), unit of concentration (UC), unit of fluores—
cence intensity (UFI) and unit of time (UT). For simplicity, we as—
sume that age and time are measured in the same units,

generalizations are straight forward.

2.1 DALSP model

The state variable of the DALSP model is the joint number density
of age, label concentration and cell division number, n(a,x, i|t) (in
cells/UC/UT). Its dynamics are governed by a system of coupled 2D
PDES,

8n(a,x,i|t) 8n(a,x,i|t) 8(V(t,x)n(a,x,i|t))
+
at 8a 8x
: —(o¢,-(t,a) + ﬂ,(t,a))n(a,x, i|t) (1)

 

with initial conditions (ICs)

i = 0: n(a,x, 0|0) E n0(a)p0(x),

Vi 2 1 : n(a,x,i|0) E o, (2)

91% ‘09 1sn3nv uo sopﬁuv soq 111110;th aIo Amie/xtqu 112 /§.IO'S[BU.IHO[p.IOJXO'SOIlBIHJOJUIOIQ/ﬁ(1111] 11101; pepeommoq

Analysis of CFSE time-series data

2323

 

and boundary conditions (BCs)

i: 0: n(0,x,0|t) E 0,

1'2 1 : n(0,x, i|t) 2 4J oci_1(t,a)n(a,2x, i — 1|t)da. (3)
R+

The i—th PDE describes the dynamics of cells with i divisions. The
factorization of the initial condition, n(a,x,0|0) E n0(a)p0(x), in
initial age distribution n0(a) (in cells/UT) and initial label density
p0(x) (in 1/UC), is biologically plausible as the labeling efficiency
should not depend on the cell age. This factorization will allow for
an efficient numerical solution algorithm.

In (1)—(3), oci(t, a) and ﬂi(t,a) denote the rates (in 1/UT) of cell
division and cell death for cells with i divisions. The rate of cellular
label degradation is denoted by V(t, x) : —le(t)x (in 1/UT), with rate
constant le(t) (in 1/UT/UC). Accordingly, the following terms con-
tribute to the temporal change of the density n(a, x, i |t):

° 8(1/(t, x)n(a, x, i|t))/8x, change of label x with rate V(t, x),

° 8(n(a, x, i|t))/8a, increase of cell age a, and

° —(oc,-(t, a) —l— ﬂi(t, a))n(a,x, i|t), loss of cells from the ith subpopu—
lation due to cell division and due to cell death,

and possess units cells/UC/UTZ. The loss of cells from the (i — 1)-
th subpopulation due to cell division results in the birth of cells in
the ith subpopulation with age a = 0, defining the BCs (3). The BCs
are obtained by integrating oci_1(t, a)n(a, 2x, i — 1|t) over the age. As
the cells double (factor 2) and the label distribution is rescaled due
to the halving of the label concentration (factor 2), this integral is
multiplied by a factor 4.

The rates as well as the initial conditions are usually unknown
and have to be estimated from experimental data. Therefore, rates
and initial conditions are parameterized in terms of a parameter vec—
tor 0 E R” (see Application section). For a more detailed statement
of the model we refer to the Supplementary Information, Section
1.1.1.

2.2 Modeled and measured quantities

The number density n(a, x, i |t) encodes the properties of the prolifer—
ating cell population. By marginalizing n(a,x, i|t) over all cell ages
and label concentrations, the number of cells which underwent i

divisions,
N(i|t):J J n(a,x,i|t)dxda,
R+ R+

is obtained. The subsequent summation over the division number i
yields the overall number of cells, N (t) : SEND N (i|t).
Marginalization over label concentrations and division number and
subsequent normalization with the number of cells yields the age
distribution,

p(a|t) =  JR+n(a,x, i|t)dx.

The label distribution, p(x|t), is obtained by marginalizing over cell
age and division number and normalizing with the overall cell number,

p(x|t) =  JR+n(a,x, mad.

Proliferation assays provide information about the overall num—
ber of cells as well as the sum of label—induced fluorescence (Fig. 1B

and C) and cellular background ﬂuorescence. The label induced
ﬂuorescence, y (in UFI), is proportional to the label concentration, 3)
: cx with x N p(x|t)and proportionality constant c> 0 (UFI/UC).
The background fluorescence 3);, is a random variable, 3)), N pb(yb)
(in UFI), whose distribution (in) depends potentially on the biolo—
gical system, the measurement procedure and technical factors. The
distribution of the total measured ﬂuorescence, ym :y—l—yb (in
UFI), obeys the convolution integral,

P(ym|0 ==j:"p<yv>pb<ym-—aoav.

. 1
wul pma=gmx=gm

(see Supplementary Information, Section 1.1.2). In the presence
of outliers, p(ym|t) can be mixed with an outlier distribution,
pouthcrswo) (see Supplementary Information, Section 2.1). The meas—
urement of the fluorescence distribution p(ym|t) does not provide in—
formation about the absolute values of the concentration x. Any
changes in c can be compensated by changes in the initial label dis—
tribution p0(x) and le(t) (Hasenauer, 2013), rendering c: 1 (UPI!
UC) a valid parameterization.

Commonly used measurement devices possess a finite resolution
and collect interval censored samples from p(ym|t). The resulting
binned snapshot data provides the number of cells H2 observed in a
bin j with intensity range I,- at time tk. These counts {IT—IéJVJ-Z1 along
with intervals {II-Ll:1 provide a histogram. The probability
[)(ym E Ii|tk) of observing an individual cell at time point tk in bin j
is the integral of p(ym|tk) over If. The overall cell count measured at
time point tk is denoted by Nk : 211:1 H2.

2.3 Numerical simulation

To compute the number density n(a, x, i|t) and further model prop—
erties, the DALSP model (1)—(3) is solved numerically. For this we
exploit that the solution of the system of coupled 2D PDEs (1)—(3) is
factorable (Metzger et al., 2012). The first factor is the solution to a
system of coupled 1D PDEs describing an ADSP. This solution is
computed using an efficient iterative numerical scheme. The second
factor is the solution to a set of decoupled 1D PDEs describing the
label distribution in cellular subpopulations with similar div-
ision number. This solution can be determined analytically. The fac—
torization accelerates the numerical evaluation by several orders of
magnitude compared to naive numerical methods. A similar decom—
position approach is used to compute the sensitivities of n(a,x, i|t)
with respect to the parameters 0,, 8n(a,x, i|t)/80). Given n(a,x, i|t)
and its sensitivities, the model properties and their derivatives are
determined via numerical integration. The convolution integral
defining the measured ﬂuorescence intensity is evaluated using
Fenton’s approximation (Fenton, 1960). For further details we refer
to the Supplementary Information, Sections 1.2—1.5.

2.4 Parameter estimation and uncertainty analysis

We employed maximum likelihood and Bayesian parameter estima—
tion to determine the unknown model parameters 0, with
0 E ® Q R”, from the collection of binned snapshot data
D : {{H2}{:1,N $521. To account for measurement noise in the
measured overall cell number and the histograms, the likelihood

function

91% ‘09 1sn3nv uo sopﬁuv soq ‘1211110111123 310 Amie/xtqu 112 /§.IO'S[BU.IHO[p.IOJXO'SOIlBIHJOJUIOIQ/ﬁ(1111] 11101; pep1201umoq

2324

S.Hross and J. Hasenauer

 

K
111916) = 1111(th },]-=1|0)1P(Nk|9)

[2:1
is used (Hasenauer, 2013). The likelihood lP({H 1k }l]-:1|0) of observ—
ing the histogram {H :76 )1121 follows a multinomial distribution with
category probabilities {p(xm E Ii|tk)}l]-:1. The likelihood lP(I\_Ik|0) of
observing the overall population size N k assumes a log-normally
distributed measurement error. A detailed statement of the likelihood
functions is provided in the Supplementary Information, Section
2.1. Prior and posterior distribution for Bayesian parameter estima—
tion are denoted by n(B) and n(0|D), with n(0|D) oc lP(D|0)1t(0). A
log-uniform prior n(B) is employed.

HML and maximum a posteri-

The maximum likelihood estimates
ori parameter estimates HMAP are obtained by maximizing the re-
spective objective functions. To improve the numerical evaluation
and the optimizer convergence, we maximize the logarithms of the
objective functions, e.g.

HML : arg max log lP(D|0).
066)

These nonlinear optimization problems are solved using stochas—
tic global optimization (Weise, 2009) and multi—start local optimiza—
tion (Raue et al., 2013). For stochastic global optimization the
particle—swarm pattern search method PSwarm (Vaz and Vicente,
2007) is employed. For multi—start local optimization, parameters
are drawn from the parameter domain ® and used as starting points
for the local optimizer. For local optimization the MATLAB routine
fmincon.m is used with and without user—supplied gradients. The
user—supplied gradients are computed using the forward sensitivity
equations of the DALSP model (see Supplementary Information,
Sections 1.2 and 2.1.)

The estimated parameter values reveal properties of the prolifer-
ation dynamics. To assess parameter identifiabilities and uncertain-
ties we calculate profile likelihoods (Raue et al., 2009) using our in—
house Parameter EStimation TOolbox (PESTO) and sample the pos—
terior distribution using the Delayed Rejection Adaptive Metropolis
sampler developed by Haario et al. (2006). The posterior sample is
employed to study parameter correlations and prediction uncertain-
ties (Hug et al., 2013). For details on the optimizer and sampler set—
tings we refer to the Supplementary Information, Sections 2.2—2.4.

2.5 Hypothesis testing

Competing hypotheses regarding the mode of proliferation can be
encoded in the rates oc(t, a) and 6 (t, a). Each of the resulting models
is assessed using the Akaike information criterion (AIC),

AIC = —2l0g now“) + 2719,
and the Bayesian information criterion (BIC)
BIC : —210glP(D|0ML) —1— log (np)n9,

in which the maximum likelihood estimate and the number of par—
ameters for the model of interest are denoted by HML and n9. The
number of independent data points is denoted by np. AIC and BIC
account for the likelihood of the data and penalize model complex—
ity. Low AIC and BIC values are favorable. We consider a differ—
ence >10 between AIC/BIC values of different models as substantial
(Burnham and Anderson, 2002).

2.61mplementation
All implementations are available as MATLAB toolbox from GitHub
(http://janhasenauer.github.io/ShAPE-DALSP/). As the MATLAB

Symbolic Math Toolbox is used to construct the models and sensitiv—
ity equations, a variety of alternative rates oci(t, a), ﬂi(t, a) and V(t, x)
: —le(t)x can be analysed easily.

3 Application

We illustrate the proposed model—based quantification method by
studying T lymphocyte proliferation. T lymphocytes are part of the
adaptive immune system and their pool expands upon pathogen rec—
ognition. This expansion is frequently monitored using CFSE label—
ing (Hawkins et al., 2007a).

3.1 Experimental data and mechanistic model

We considered T lymphocyte proliferation upon treatment with
antibodies against CD3 and CD28 receptors. Experimental data for
this setting have been collected by Luzyanina et al. (2007b) and ana—
lysed in a series of studies (Banks et al., 2010, 2011; Hasenauer,
2013; Luzyanina et al., 2007b; Thompson, 2012). This multitude of
preceding studies underlines the importance of the dataset and ren—
ders it ideal for the evaluation of our approach.

In this study, an ensemble of DALSP models is used to study the
CFSE data collected on Days 1—5 post treatment. To capture the
observed heterogeneity, the initial CFSE distribution (on Day 1),
[)0 (x), is modeled by a weighted sum of two log—normal distributions
and the distribution of the autofluorescence, pa(xa) is modeled by a
single log-normal distribution. After considering different alterna—
tives, we set initial cell age to zero, such that the initial condition is
given by no (a) : N05(a). N0 is the initial number of cells and (3 de—
notes the Dirac delta distribution. We considered rates of cell div—
ision which are constant, age— and/or division number—dependent,

i.e.
lea, —> constant
lea),- —> division number dependent
. _ la an“
“((4) _ na— —> age dependent
Kora ‘1‘ 61"“
kmiana

W —> division number and age dependent,
and the same holds for the rate of cell death, ﬂi(a). The age—depend—
ence is modeled by Hill—type functions with maximal rates led),- and
lap),- which can depend on the division number i. Similar to previous
publications the intracellular CFSE degradation is described using
Gompertz decay, le(t) : —kdegexp(—cdegt) (Banks et al., 2013b).
The constants used to model the rates, e.g. lea), law, kdeg and cdeg,
and the parameters of the initial conditions are part of the parameter
vector 0 and estimated from the data. Lower and upper bounds for
these parameters are reported and discussed in the Supplementary
Information, Section 3 . 1.

The combinations of different hypotheses regarding oci(a) and
ﬂ,(a) give rise to 16 model alternatives with 12—29 parameters. We
denote these models with M1—M16 and their properties are sum—
marized in Table 1. In the following sections, these model alterna—
tives are compared and used to interpret the CFSE time—series data.

3.2 Comparison of optimization methods

We estimated the parameters of all 16 model alternatives using the
particle—swarm optimization algorithm implemented in PSwarm and
the multi—start local optimization method implemented in PESTO.
The latter performs individual deterministic optimizations using gra—
dients obtained by finite differences or sensitivity equations. For all

91% ‘09 1sn3nv uo sojeﬁuv 80’] ‘1211110111123 310 Amie/xtqu 112 /§.IO'S[BU.IHO[p.IOJXO'SOIlBIHJOJUIOIQ/ﬁ(1111] 11101; pep1201umoq

Analysis of CFSE time-series data

2325

 

Table 1. Number of parameters, negative log-likelihood, AIC and BIC for the 16 model alternatives

 

M1 M2 M3 M4 M5 M6 M7

M8 M9 M10 M11 M12 M13 M14 M15 M16

 

or : fnc(a) — >< — >< — >< —
or : fnc(i) — — x x — — x
[i : fnc(a) — — — — x x x
[3 : fnc(i) — — — — — — —
na 12 14 18 20 14 16 20

—loglP(><104) 2.242 1.521 2.185 1.476 2.089 1.521 2.016
AIC(><104) 4.486 3.044 4.374 2.956 4.180 3.045 4.036
BIC(><104) 4.497 3.058 4.391 2.974 4.194 3.060 4.056

X — X — X — X — X
X — — X X — — X X
X — — — — X X X X
— X X X X X X X X

22 19 21 25 27 21 23 27 29

1.476 2.176 1.508 2.138 1.350 2.033 1.497 1.987 1.345
2.956 4.356 3.021 4.281 2.705 4.070 2.998 3.980 2.696
2.977 4.374 3.041 4.305 2.730 4.090 3.020 4.006 2.723

 

Rows two to ﬁve indicate the dependencies considered in the different models. Dependencies are indicated using fnc, e.g. or = fnc(a) indicates that or depends on a.

The values for AIC and BIC are for the maximum likelihood estimate found after 250 runs of a deterministic local optimizer exploiting forward sensitivity equations

 

 

1o°'°“ —°— random sampling
stochastic optimisation
(particle—swarm)
deterministic optimisation
(finite differences)
deterministic optimisation
(sensitivity equations)

 

 

   
    
   

10 WW

 

0 2O 40 60
sorted optimiser run

     
   
 

negative log—likelihood + constant
8

increasing
goodness of fit

statistical threshold

 

 

 

 

10 " . . . . . -
0 50 100 150 200 250
sorted optimiser runs
B C
stochastic optimisation _ 4 O
(particle—swarm)

deterministic optimisation
(finite differences)

deterministic optimisation O
(sensitivity equations)
10‘2 10‘1 10° 101 100 101 102
computation time average computation time
for individual start [hr] per converged start [hr]

 

 

 

 

 

Fig. 2. Performance of different optimization methods for model M2.
(A) Negative log-likelihoods for 250 runs of deterministic local and global opti-
mizers and 250 randomly sampled parameter values. Missing points indicate
failed objective function evaluations and optimization runs. The dashed line indi-
cates the significance threshold for converged starts. (B) Box plot of the compu-
tation time per optimization run. (C) Average computation time per converged
start (Color version of this figure is available at Bioinformatics online.)

optimization methods we assessed the percentage of converged
starts using the likelihood ratio test with a significance level of 0.05
(see Supplementary Information, Section 2.4). This is a weak, statis—
tically motivated measure of convergence and can be checked easily
also for complex problems. Beyond converged starts, we considered
the distribution of computation times for individual starts as well as
the average computation time per converged start. The latter is com—
puted by dividing the overall computation time by the number of
converged starts (see Supplementary Information, Section 2.4). This
yields a measure for the overall optimizer efficiency.

The results for 250 runs of PSwarm, 250 runs of the determinis—
tic optimizers used in multi—start local optimization and 250 random
parameter samples for different model alternatives are depicted in
Figure 2 and Supplementary Figure S2. For M2 all optimizers
achieve a significant improvement compared to random samples.
For M2 the percentages of converged starts were for all optimizers
comparable (Fig. 2A), but deterministic optimizers using sensitivity
equations were two orders of magnitude faster than PSwarm (Fig.
2B and C) and the only algorithms able to reproduce the global opti—
mum. For model alternatives with more parameters, the difference

in the performance of multi—start methods and PSwarm becomes
even more apparent (Supplementary Fig. S2). Hence, although
PSwarm is known to outperform most available global optimization
algorithms (Vaz and Vicente, 2007), we found that multi—start local
optimization yields better results for DALSP models.

3.3 Evaluation of age—dependent proliferation rates
Model M1—M16 describe different dependencies of the proliferation
rates on cell age and division number. A comparison of the meas—
ured distributions and cell counts (Fig. 3A) with the best fits for
these model hypotheses is provided in Figure 3, Supplementary
Figures S4 and SS. We found that already the model M1, which as-
sumes constant rates of cell division and cell death, fits a large frac-
tion of the data well (Fig. 3B). Model M2, which accounts for age—
dependence of the division rate, already provides a good visual
agreement of model and data (Fig. 3C). The fit tends to improve fur—
ther as additional degrees of freedom (i.e. model parameters) are
introduced (Fig. 3D). To our surprise, we found only a weak correl—
ation between the log—likelihood and the number of parameters of a
model (Fig. 4A). In contrast, age—dependence of the division rate sep—
arates the models in those with high log—likelihood values (—> good
fits) and those with low log—likelihood values (—> bad fits). Taken to—
gether, this indicates that missing age—dependence of the rates of cell
division cannot be compensated by increasing the number of param—
eters and the model complexity.

To assess the importance of individual dependencies of prolifer-
ation rates we computed the AIC and BIC values (Table 1). Both in-
formation criteria provided identical rankings and revealed the
model hierarchy visualized in Figure 4B and C. The best eight mod—
els were those with age—dependence of the rates of cell division,
including M2. The best four models were those with age— and div—
ision—dependent rates of cell division. The best two models were
those possessing in addition a dependence of the rates of cell death
on the division number. In the best model the rates of cell division
and cell death depend on cell age and division number.

Previous studies relying on LSP and DLSP models assumed time—
and/or CFSE concentration—dependent division rates. The estimates
of these division rates were multi—modal, difficult to interpret and
possessed many unknowns [see, e.g. (Banks et al., 2010, Fig. 8) and
(Thompson, 2012, Fig. 3.10)]. The DALSP models proposed here
possess fewer parameters and the age—dependent rates of cell div—
ision are interpretable, e.g. in terms of inter—division times (Metzger
et al., 2012). Furthermore, age—dependent rates provide a direct link
to the cell cycle—dependent gene expression during T lymphocyte
proliferation and differentiation (Bird et al., 1998). Accordingly,

9mg ‘09 1sn3nv uo sojeﬁuv 80’] ‘1211110111123 310 AltSJQAIUn 112 /§.IO'S[BU.IHO[p.IOJXO'SODBIHJOJUIOIQ/ﬁdllq 11101; pep1201umoq

2326

S.Hross and J. Hasenauer

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

CFSE distribution Population size
day 1 day 2 day 3 day 4 day 5 X 104
A (7)) E150 '_'6
.1. .1.
m .5 E
“a E 100 8 4 ’
<1) 0
D Q. =
H (D
C
§ 50 %2
= 
8 o _ h o 0‘
x 104
B (M1) I150 E 6
.E E
‘3 100 g 4 I
(D O
Q. =
E (D
§ 50 %2
= g. ‘
8 0 ° 0
1 x104
0 (14.) I 50 I 6
.5 E
‘3 100 8 4 '
(D 0
D. =
.g 8
= is ‘
8 0 ° 0
D (M ) 150 6X104
16 I —data g . data
3% —model 5, model .
g 100 -background 8 4
- B
C
§ 5o %2
= E .
8 o o 0
1o0 101 102 10:100 101 102 10C 100 101 102 10:100 101 102 10: 10° 101 102 10C 1 2 3 4 5
fluorescence [UI] fluorescence [UI] fluorescence [UI] fluorescence [UI] fluorescence [UI] time [days]

Fig. 3. Comparison of measured CFSE distributions (A, left) and measured overall cell counts (A, right) with the best fits of model M1 (B), M2 (C) and M15 (D).
The region in between the fine lines (2) indicates the 90% confidence interval (5th—95th percentile) of the bin counts for the particular number of measured cells.

A coverage/overplotting of the experimental data by the confidence interval indicates a good fit

 

 

 

 

 

 

 

or = fnc(a)

WK

 

 

 

 

 

 

A increasing goodness of ﬁt B
32 ' ' ' ' 45-
or is independent of a (or :1: fnc(a)) '
30 or depends on a (or = fnc(a))
M16 4_
Q: 28' <1”—
:2 M15 M12 3
B 26- _
4; M11 2 3.5
a 24- _ m
9 M14 3
a 22— M8 -
E M13 M10 0'4
F3 20' M7 M4 ' 25
8 M9
L5 18— M3 ' or = fnc(a)
5.1
"do; 16— M6 or = fnc(i)
5 _
C:  M5 M2 ﬂ : fnc(a)
12' M1 . .
POO”: 0.36352 ﬂ = 111100)
10 - ' ' ' ' -
—2.2 —2 —1.8 —1.6 —1.4 —1.2

M16

log-likelihood, IP(D | 0)

M12

or = fnc(a, 

a = fnc(a, i)

hierarchy of minimal dependencies

ﬁ=ﬁ10(i)

a=fnc(a,i)

v o m m H H ,8=fnc(a,i)
§§§§§§§§§§§§§§

Fig. 4. Model selection results for proliferation models M1—M15. (A) Optimal log-likelihood value versus number of parameter for the individual models. (B)
Ordering of models implied by BIC values, starting with the best model. Crosses in the table indicate dependencies of the rate of cell division, 01 and cell death, [1.
(C) Visualization of the hierarchy of models according to the minimal set of dependencies, which are color-coded consistently across all subplots. (A—C)
Visualization of AIC instead of BIC yields the same results as AIC and BIC values differ merely in the third significant digit

DALSP models facilitated an accurate description and a meaningful
interpretation of CFSE time—series data in terms of model
parameters.

3.4 Analysis of parameter and prediction uncertainties

As estimated parameters and predicted model properties are poten—
tially non-identifiable from available CFSE time—series data, we as—
sessed their uncertainties using profile likelihoods and Markov chain
Monte Carlo (MCMC) sampling. We evaluated the optimization pro—
cedures and found that only deterministic optimization with

sensitivity equations yields accurate profile likelihoods. Furthermore,
despite the use of state—of—the—art adaptive MCMC sampling proced—
ures, random initialization of the starting point did not yield a sample
within 30 CPU days that passes the Geweke test (Brooks and Roberts,
1998), a convergence diagnostic. In contrast, initialization at the
MAP estimate resulted after only 2 CPU days in a sample that passes
the Geweke test. This demonstrated the importance of reliable and ef—
ficient optimization methods for uncertainty analysis. The results of
the uncertainty analysis for M1, M2 and M16 are visualized in
Supplementary Figures S7—S12.

9mg ‘09 1sn3nv uo sojeﬁuv 80’] ‘1211110111123 310 AltSJQAIUn 112 /§.IO'S[BU.IHO[p.IOJXO'SODBIHJOJUIOIQ/ﬁdllq 11101; pep1201umoq

Analysis of CFSE time-series data

2327

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

  
    

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

L 3 1.5 -
o ._.
.: co
nor (D “" 1
04.0) = —.’f°“”  
K a“ —I— and - - - - jg '
1.46 1.48 1.5 1.52 1.54 "6 00 0'5 1 1'5 2
k [1/d] ' '
a K cell age [d]
a
__ ‘_ 3.1.5 -
o o '5
'C C C
.9 9 a, 1 _
8 g statistical 
Q- 0. threshold .8 0.5 _
_ _ _ _ _ _ _ _ E.
0.4 0.405 0.41 0.415 0.42 0 20 40 60 80 100 00 0 5 1 1 5 2
Kg [d] “a ['1 inter-divison time [d]
0.3
' a?
8 g 0.2
a:
u 'o
a : k U) ,
(M ) B 3 8 0.1
_ _ _ " _ _ '5.
0.19 0.2 0.21 0.22 00 5 10 15 20
k). [W] time to cell death [d]
6 x104 G
4' l ' no division
1-6 X10 \ 1 division 1'6 _ / '1_12
g 1.5 zoom \ 2 divisions /
5 - a) - . . . 1 4 _ / 1.1
3 1 4 \ 3 lelSlonS - / b
0 ' \ 4divisions 171 1-08
5 13 ' ' ' 1 2 — / C
B 4 _ n - \ 5dIvIsIons - / g me
— E — 6 lelSlonS >~ -
8 g 1.2 \ . . . t 8 1.04
H_ 1.1 \ —7 dIVISIOI'IS g 1 — \ a
8 3 _ 4.8 4.82 4.84 4.86 4.88 4.9 a" g \ 1'02
a) 2 time [d] \ . 0 8 \ \ 1
E T \ 8 ‘
:— o.35 0.37 0.39 0.41 0.43 0.45
E 2 \ \ - 0.0.6 - cell age [d] ‘
\ \ \ \ h 0.4 -
1 ‘ 1
~ j 02 _
0 \\ I 0 I I
1 2 3 4 5 O 0.5 1 1.5 2
time [d] K cell age [d]

Fig. 5. Parameter and prediction uncertainties for model M2. Parameterization of (A) age-dependent division rate and (D) death rates along with the uncertainty of
the corresponding model parameters. Histograms of the MCMC samples (boxes) and profile likelihoods the individual parameters (line) are depicted along with the
statistical threshold for the 95% confidence intervals (dashed black line). Median (lines) and 99% credible interval (semitransparent areas) for (B) the age-dependent
rate of cell division, (C) the distribution of the inter-division time (in the absence of cell death), (E) the distribution of the time to cell death (in the absence of cell div-
ision), (F) the size of the subpopulations and the overall population and (G) the age distribution on Day 5. Uncertainty assessment reveals that parameter and predic-
tion uncertainties are small. (F, G) Zooms are provided to visualize the uncertainties (Color version of this figure is available at Bioinformatics online.)

For M2, the simplest model which provides a good visual agree—
ment of model and data, we found that most parameters are practic—
ally identifiable (Supplementary Fig. S8). The maximum rate of cell
division, lea, as well as the age at which the half maximum value of
the division rates is reached, K0,, were tightly constrained (Fig. 5A).
For the Hill coefficient, no), we considered the range of 10_6 to 102
and found a lower bound of 45.4. Accordingly, the age—dependent
division rates, 011(a), is close to the scaled Heaviside step function lea
h(a — K0,) which would be reached for no, —> 00 (Fig. 5B). This indi-
cates that the upper bound for no, chosen in the study, no, 3 102,
does not inﬂuence the estimation results significantly. For the esti—
mated division rate, the inter—division time (in the absence of cell
death) is similar to a shifted exponential distribution (Fig. 5 C). This
is the distribution assumed in the Smith—Martin model (Smith and
Martin, 1973). The rate of cell death, ﬂ(a) : lap, was significantly
smaller than the maximal rate of cell division, lea (Fig. 5D). As the
rate of cell death is constant, the time to cell death (in the absence of
cell division) is exponentially distributed (Fig. 5D). The estimated
parameters of the rates of cell division and cell death are correlated
(Supplementary Fig. S11). The good agreement of profile likelihoods
and histograms obtained using MCMC sampling underpin the func-
tioning of the methods. Confidence intervals for all parameters of
model M2 are provided in Table 2.

Table 2. Parameter estimates and confidence intervals for model
M2

 

 

Name ML estimate 95% confidence interval Unit
k0, 1.499 (1.474, 1.524) c1-1
11,, 100.0 (45.39, 2100) —
K0, 0.410 (0.406, 0.414) d

12;; 0.204 (0.197, 0.211) d"1
kdeg 0.190 (0.184, 0.196) d"1
edeg 0.076 (0.057, 0.095) d-1
unoise 2.150 (2.132, 2.169) —
anoise 0.333 (0.321, 0.344) —
N0 7012 6902, 7123 Cells
rX71 0.746 (0.735, 0.757) —
11,91 6.402 (6.396, 6.407) —
11,92 7.302 (7.270, 7.335) —
0X71 0.177 (0.174, 0.179) —
0X72 0.741 (0.724, 0.758) —

 

Beyond the quantification of parameter uncertainties, we as—
sessed model predictions. As CFSE time—series data are most fre—
quently used to determine the number of cells with a certain number
of divisions, N (i |t), we used samples from the posterior distribution

91% ‘09 1sn3nv uo sejeﬁuv 80’] ‘1211110111123 310 Amie/xtqu 112 /§.IO'S[BU.IHO[p.IOJXO'SODBIHJOJUIOIQ/ﬁdllq 11101; pep1201umoq

2328

S.Hross and J. Hasenauer

 

n(0|D) obtained by MCMC to quantify this property and its uncer—
tainty. The results for M2 (Fig. 5 C) revealed that the uncertainties
are relatively small. A second property providing insight into the
proliferation dynamics is the age distribution. While this property
could not be assessed with LSP and DLSP models, the DALSP model
revealed its structure. Due to the continuous renewal, cells tended
to be young with a maximum at a = 0d. Between a = 0d and
a = 0.41 d the density slowly decreases, mostly due to cell death.
At a : 0.41 d m K, cell division sets in and results in an accelerated
decline. Although CFSE time—series data do not directly provide in—
formation about the cell age distribution, DALSP models could be
used to quantify it accurately, which is indicated by narrow credible
intervals. This is also true for other properties such as intracellular
CFSE degradation.

4 Conclusion

In vivo and in vitro proliferation assays using CFSE require accurate
tools for quantifying biologically meaningful parameters (Hawkins
et al., 2007a). To meet this requirement, we propose to use DALSP
models which account for the age of individual cells. In contrast to
the frequently used LSP and DLSP models, DALSP models allow for
non-exponential inter-division time. To exploit DALSP models for
the analysis of CFSE time—series data, we derived sensitivity equa—
tions for gradient calculation, and we developed a tailored numer—
ical scheme exploiting the hierarchical structure of DALSP models.

As an accurate model—based analysis of experimental data re—
quires reliable inference, we compared different optimization algo—
rithms with respect to convergence and computation time. Our
comparison, which is to the best of our knowledge the first compari—
son of this kind for structured population models, revealed that
multi—start local optimization outperforms stochastic global opti—
mization for this class of PDE models. This confirms results by Raue
et al. (2013) for ODE models. Indeed, for some DALSP models the
evaluated stochastic global optimizers did not even converge if a
large number of function evaluations (> 105) was allowed. For the
same models, multi—start local optimization with accurate gradients
provided reproducible results. This underpined the importance of
using sensitivity equations, which have so far not been described for
LSP and DLSP models. The latter raising questions regarding the re—
liability of previous estimation results.

The efficient deterministic optimizers were used to maximize a
likelihood function which accounts for the stochasticity of the acqui—
sition process. This likelihood function is statistically more meaning-
ful than least—squares type objective functions (Banks et al., 2010,
2011). We employed the proposed likelihood function for model se—
lection and found evidence for a dependence of the division rate on
the cell age. More precisely, the Hill—type division rate with a high
degree, no, >> 1, indicated a lower bound for the inter—division time,
which could be interpreted as a minimal length of the cell cycle. This
seems biologically more plausible than the time— and CFSE concen—
tration—dependent division rates proposed in previous publications
(Banks et al., 2010, 2011; Luzyanina et al., 2007b). Furthermore,
age—dependent rates of cell division have been reported for similar
biological systems using time—lapse microscopy data (Duffy et al.,
2012; Shokhirev et al., 2015).

Beyond model selection, we provided the first detailed Bayesian
uncertainty analysis for structured population models. This was
challenging due to the computational complexity of PDE models
and the number of unknown parameters. We established computa—
tional feasibility by exploiting tailored numerical methods and an

initialization using optimization results. The posterior samples ob—
tained using MCMC methods revealed a low level of uncertainties
for latent properties, such as the age distribution and the parameters
of the cell division rate. In addition, the marginal distribution of par-
ameters are consistent with the profile likelihoods, which substanti—
ated the results further.

All the modeling, simulation, parameter estimation and model
selection methods used in this publication are implemented in the
open—source MATLAB toolbox ShAPE-DALSP. The availability of
the code will facilitate the application of the method and simplify
the development of extensions, e.g. toward multiple cell—types
(Schittler et al., 2012), asymmetric cell division (Banks et al., 2015;
Bocharov et al., 2013;Kapraun, 2014; Luzyanina et al., 2014) and
alternative DALSP models (Banks et al., 2013a, 2014, 2015;
Kapraun, 2014; Luzyanina et al., 2014). In particular the implemen-
tation of a cyton—based model (Banks et al., 2013a, 2014, 2015;
Kapraun, 2014) would be interesting as these models allow for a
fraction of non-dividing cells. In addition to extensions, alternative
parameterizations can be included, e.g. a parameterization of the
probability density functions for a cell to divide and die at age a as
used in the cyton models) in contrast to a parameterization of the
age—dependent rate of cell division and cell death. The incorporation
of the features in ShAPE—DALSP would allow for an even broader
spectrum of applications and improve user—friendliness.

In summary, this study presents a novel model—based analysis
method for CFSE time—series data. Besides a statistical model, we
present findings regarding optimizer performance and uncertainty
analysis. These findings and the methods we developed can be easily
transferred to other structured population models and might also be
applicable to other types of population balance models.
Accordingly, this study will help to make the most of CFSE time—ser—
ies data and other data requiring cell—cycle corrections.

Funding

The authors acknowledge financial support from the German Federal
Ministry of Education and Research (BMBF) Within the SYS-Stomach project
(Grant No. 012K1310B) and the Postdoctoral Fellowship Program (PFP) of
the Helmholtz Zentrum Miinchen.

Conﬂict of Interest: none declared.

References

Banks,H.T. et al. (2010) Estimation of cell proliferation dynamics using CFSE
data. Bull. Mat/7. Biol., 73, 116—150.

Banks,H.T. et al. (2011) A new model for the estimation of cell proliferation
dynamics using CFSE data. ]. Immunol. Met/rods, 373, 143—160.

Banks,H.T. et al. (2013a) A novel statistical analysis and interpretation of
ﬂow cytometry data. ]. Biol. Dyn., 7, 96—132.

Banks,H.T. et al. (2013b) Quantifying CFSE label decay in ﬂow cytometry
data. App]. Mat/7. Lett., 26, 5 71—5 77.

Banks,H.T. et al. (2014) Analysis of variability in estimates of cell prolifer-
ation parameters for cyton-based models using CFSE-based ﬂow cytometry
data.]. Inverse Ill—Posed Probl., 23, 135—171.

Banks,H.T. et al. (2015) Evaluating the importance of mitotic asymmetry in
cyton-based models for CFSE-based ﬂow cytometry data. Int. ]. Pure Appl.
Mat/7., 100, 131—156.

Bernard,S. et al. (2003) Analysis of cell kinetics using a cell division marker:
mathematical modeling of experimental data. Biopbys. ]., 84, 3414—3424.
Bird,].]. et al. (1998) Helper T cell differentiation is controlled by the cell

cycle. Immunity, 9, 229—23 7.

Bocharov,G. et al. (2013) Asymmetry of cell division in CFSE-based lympho-

cyte proliferation analysis. Front. Immunol, 4, 264.

91% ‘09 1sn3nv uo sejeﬁuv 80’] ‘1211110111123 310 mime/tron 112 /§.IO'S[BU.IHO[p.IOJXO'SOIlBIHJOJUIOIQ/ﬁdllq 11101; pep1201umoq

Analysis of CFSE time-series data

2329

 

Brooks,S.P. and Roberts,G.O. (1998) Assessing convergence of Markov chain
Monte Carlo algorithms. Stat. Comp., 8, 319—335.

Burnham,K.P. and Anderson,D.R. (2002). Model Selection and Multimodel
Inference: A Practical Information—Theoretic Approach. 2nd edn.Springer,
New York.

De Boer,R.]. and Perelson,A.S. (2013) Quantifying t lymphocyte turnover.
]. Theor. Biol., 327, 45—87.

De Boer,R.]. et al. (2006) Estimating lymphocyte division and death rates
from CFSE data. Bull. Math. Biol., 68, 1011—1031.

Duffy,K.R. et al. (2012) Activation-induced B cell fates are selected by intra-
cellular stochastic competition. Science, 335, 33 8—341.

Fenton,L.F. (1960) The sum of lognormal probability distributions in scatter
transmission systems. IRE Trans. Commun. Syst., 8, 5 7—67.

Haario,H. et al. (2006) DRAM: efﬁcient adaptive MCMC. Stat. Comp., 16,
339—354.

Hasenauer,]. (2013) Modeling and parameter estimation for heterogeneous
cell populations. Logos Verlag, Berlin.

Hasenauer,]. et al. (2012) Analysis and simulation of division- and label-struc-
tured population models: A new tool to analyze proliferation assays. Bull.
Math. Biol., 74, 2692—2732.

Hawkins,E.D. et al. (2007a) Measuring lymphocyte proliferation, survival and
differentiation using CFSE time-series data. Nat. Protoc., 2, 205 7—2067.

Hawkins,E.D. et al. (2007b) A model of immune regulation as a consequence
of randomized lymphocyte division and death times. Proc. Natl. Acad. Sci.
U S A, 104, 5032—5037.

Hug,S. et al. (2013) High-dimensional Bayesian parameter estimation: Case
study for a model of JAK2/STAT5 signaling. Math. Biosci., 246, 293—304.
Kapraun,D.F. (2014). Cell proliferation models, CFSE-based ﬂow cytometry
data, and quantiﬁcation of uncertainty. PhD thesis, North Carolina State

University, Raleigh, NC, USA.

Luzyanina,T. et al. (2007a) Computational analysis of CFSE proliferation
assay. ]. Math. Biol., 54, 57—89.

Luzyanina,T. et al. (2007b) Numerical modelling of label-structured cell
population growth using CFSE distribution data. Theor. Biol. Med. Model,
4, 26.

Luzyanina,T. et al. (2014) Mathematical models for CFSE labelled lympho-
cyte dynamics: asymmetry and time-lag in division. ]. Math. Biol., 69,
1547—15 83.

Lyons,A. and Parish,C. (1994) Determination of lymphocyte division by ﬂow
cytometry.]. Immunol. Methods., 171, 131—137.

Metzger,P. et al. (2012) Modeling and analysis of division-, age-, and label-
structured cell populations. In: Proceedings of 9th International Workshop
on Computational Systems Biology, pp. 55—58. Ulm, Germany. http://
www.cs.tut.ﬁ/WCSb12/\WCSB2012.pdf.

Raue,A. et al. (2009) Structural and practical identiﬁability analysis of par-
tially observed dynamical models by exploiting the proﬁle likelihood.
Bioinformatics, 25, 1923—1929.

Raue,A. et al. (2013) Lessons learned from quantitative dynamical modeling
in systems biology. PLoS One, 8, e74335.

Schittler,D. et al. (201 1) A generalized population model for cell proliferation:
integrating division numbers and label dynamics. In: Proceedings of 8th
International Workshop on Computational Systems Biology, pp. 165—168.
Ziirich, Switzerland. http://WWW.Wcsb201 1.ethz.ch/proc_wcsb201 1.pdf.

Schittler,D. et al. (2012) A model for proliferating cell populations that ac-
counts for cell types. In: Proceedings of 9th International Workshop on
Computational Systems Biology, pp. 79—82. Ulm, Germany.

Schroeder,T. (2011) Long-term single-cell imaging of mammalian stem cells.
Nat. Methods, 8, 30—35.

ShokhireV,M.N. et al. (2015 ) A multi-scale approach reveals that NF-KB cRel
enforces a B-cell decision to divide. Mol. Syst. Biol., 11, 783.

Smith,].A. and Martin,L. (1973) Do cells cycle? Proc. Natl. Acad. Sci. U S A,
70, 1263—1267.

Thompson,W.C. (2012). Partial differential equation modeling of ﬂow
cytometry data from CFSE-based proliferation assays. PhD thesis, North
Carolina State University. http://repository.lib.ncsu.edu/ir/handle/1840.16/
7434.

Vaz,A. and Vicente,L. (2007) A particle swarm pattern search method for
bound constrained global optimization. ]. Global Optim., 39, 197—219.

Weise,T. (2009) Global Optimization Algorithms: Theory and Application.
ebook, Nature Inspired Computation and Applications Laboratory
(NICAL), University of Science and Technology, China.

91% ‘09 1sn3nv uo sejeﬁuv 80’] ‘1211110111123 310 Amie/xtqu 112 /§.IO'S[BU.IHO[p.IOJXO'SOIlBIHJOJUIOIQ/ﬁdllq 11101; pep1201umoq

