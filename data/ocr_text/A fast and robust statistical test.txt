Vol. 26 no. 18 2010, pages 2349-2351
APP N doi:10.1093/bioinformatics/btq427

 

Systems biology

Advance Access publication July 21, 2010

A fast and robust statistical test based on likelihood ratio with
Bartlett correction to identify Granger causality between

gene sets

Andr Fujitalﬁk, Kaname Kojima2, Alexandre G. Patriota3, JO 0 R. Sato4,

Patricia Severino5 and Satoru Miyanol’2

1Computational Science Research Program, RIKEN, 2—1 Hirosawa, Wako, Saitama 351—0198, 2Human Genome
Center, Institute of Medical Science, University of Tokyo, 4—6—1 Shirokanedai, Minato—ku, Tokyo 108—8639, Japan,
3Institute of Mathematics and Statistics, University of S o Paulo, Rua do Mat 0, 1010, S o Paulo 05508—090,
4Center of Mathematics, Computation and Cognition, Universidade Federal do ABC, Rua Santa Ad Iia 166, Santo
Andr 09210—170 and 5Center for Experimental Research, Albert Einstein Research and Education Institute, Av.
Albert Einstein, 627 — S o Paulo, S o Paulo 05652—000, Brazil

Associate Editor: Joaquin Dopazo

 

ABSTRACT

Summary: We propose a likelihood ratio test (LRT) with Bartlett
correction in order to identify Granger causality between sets
of time series gene expression data. The performance of the
proposed test is compared to a previously published bootstrap-
based approach. LRT is shown to be significantly faster and
statistically powerful even within non-Normal distributions. An R
package named gGranger containing an implementation for both
Granger causality identification tests is also provided.

Availability: http://dnagarden.ims.u-tolqo.ac.jp/afujita/en/doku.php?id=
ggranger.

Contact: andrefujita@riken.jp

Supplementary information: Supplementary data are available at
Bioinformatics online.

Received on April 5, 2010; revised on July 4, 2010; accepted on July
18, 2010

1 INTRODUCTION

Temporal association between genes in time series expression data
can be studied through the identiﬁcation of Granger causality (Fujita
et al., 2009; Guo et al., 2008; Mukhopadhyay and Chatterjee, 2007).
Granger causality in time series data was mathematically formalized
by Granger (1969) and later implemented to a multivariate
framework by Geweke (1984), allowing the identiﬁcation of
conditional relationships.

Recently, Fujita et al. (2010) proposed the application of Granger
causality to identify relationships between sets of genes, i.e. to
identify if a set containing n genes Granger causes another set
with m genes. Their main goal is to create networks representing
pathway—level connections that could help the understanding of
molecular mechanisms underlying biological processes. In the
above—mentioned work, the authors propose a bootstrap procedure
to test and identify Granger causality. Despite the usefulness
of the bootstrap method to identify/test Granger causality, it

 

*To whom correspondence should be addressed.

is computationally intensive, becoming particularly slow when
accurate P—values are required.

To overcome this drawback, here we propose an analytical
approach based on likelihood ratio test (LRT). For time series
experiments containing less than 100 points, we also propose a
Bartlett correction in order to improve the asymptotic approximation
of the statistics.

Two simulations were carried out in order to evaluate the
performance of the proposed LRT with Bartlett correction—based test.
First, since the Granger causality between sets of gene expression
time series data is a generalization of the multivariate version
proposed by Geweke (1984), it is necessary to know if the proposed
LRT is as good as the classic Wald’s test in terms of statistical power
in a multivariate context by using the vector autoregressive (VAR)
model (Simulation 1). The second simulation consists in comparing
the performance of the proposed test with the previously published
bootstrap—based method (Fujita et al., 2010) in a context where one
would like to identify Granger causality between sets of time series
data.

The results show that: (i) the LRT is equivalent to Wald’s test
in the multivariate model in terms of statistical power; (ii) the
LRT is much faster and has a higher statistical power than the
bootstrap method (when analyzing sets of time series data); and
(iii) both the LRT and bootstrap can control the rate of false positives
even under non—Normal noises. An R package named gGranger
containing the identiﬁcation method for Granger causalities, the
bootstrap procedure and the LRT with Bartlett correction is provided.

2 METHODS

2.1 Granger causality for sets of time series

For the linear case of Granger causality between sets of genes, let Y; (m—
dimensional) and Y], (n—dimensional) be two disjoint subsets of Yr, where Y;
is a k—dimensional set of stationary gene expression time series-(k 2 m+n)
with length T. Then, in an autoregressive process of order one, Y], is Granger
non—causal for Y; partialized by X = Y, \YJI_1 if the following condition holds
(Fujita er al., 2010): I

CCA(Y§,YJ,_1|X)=0 (1)

where CCA is the canonical correlation analysis.

 

© The Author 2010. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oxfordjournals.org 2349

112 /BJO'SIBUJHO[p.IOJXO'SOllBIHJOJUTOTQ/ﬁdnq mm; popaommoq

9IOZ ‘Ig1sn8nv I102:

A.Fujita et aI.

 

2.2 LRT

Testing Equation (1) is equivalent to test a/ E b =0, where E

YlYJtil IX YlYl‘Iil IX
is the covariance between Y; and YJ,_1 partialized by X and a and b are
the coefﬁcient vectors that maximize the correlation between a/Y; and
b/YJI;1 given X. Therefore, the Granger causality test for sets of time series

experiments may be set as H0 : E = 0 (Granger non—causality) versus

Y§Y{71|X
H1 : Ely-Y,- IX #0 (Granger causality) for the following statistics:
t til
_21nA=(T— 1 —(k—n))1h(|ﬁY;-Y§|X||ﬁYLlYLIIX|/|ﬁ|)
A ﬁYiYi X i i 
where 2') = A I II A Y‘YH IX is the block matrix of the unbiased

. _ 2 . .
J J J
YtilYélX YtilYtillX

estimator of E (Johnson and Wichem, 2002). For large T, the statistic test is
approximately distributed as a X2 random variable.

For relatively small T, we suggest the use of Bartlett correction (Bartlett,
1939). Timm and Carlson (1976) showed that the Bartlett correction under
our problem arises by replacing the multiplicative factor T — 1 — (k — n) in the
likelihood ratio statistic with the factor r = T — 2 — (k — n) — % (m + n + 1) to
improve the X2 approximation to the sampling distribution of —2lnA. Thus,
we reject H0 at signiﬁcance level 06 if

A . . A . . A 2
rln(IzyéyglxIIZYJilYJiIIXI/IZI)> an(05)

where xgmax) is the upper (100a)th percentile of a X2 distribution with mn
degrees of freedom.

2.3 Experimental set-up

Two simulations were carried out in order to evaluate the performance of the
proposed LRT with Bartlett correction.

2.3.] Simulation I—Multivariate model Description of the comparison
between the proposed approach and the multivariate VAR model with Wald’s
test in the case where n = 9 time series (predictors) Granger cause m = 1 time
series (target) (Supplementary Fig. 1).

yt = _0-1yt—1+0-2x1,t—1_0-3x2,t—1+0-4~x3,t—l
—0.SX4,;_1+0.6)C5,;_1 —0.7X6,z—1+0.8X7J_1
_0-9x8,t—l +0x9,t—l +8t

0-2xi,t—l +8i,t

xi,t

for t=1,...,T, where the noises 8,-J~N(0, 1) (i=1,...,9). The time series
length is set to 75, i.e. T275.

2.3.2 Simulation 2—Module—module model Comparison between the
proposed LRT and the bootstrap—based test proposed by Fujita et al. (2010).
The structure of the artiﬁcial network is similar to Simulation 1 described
in Fujita et al. (2010), where the Granger causality from one gene set to
another gene set is tested (Supplementary Fig. 2). To evaluate the robustness
of LRT under different noise distributions, gene time series are generated with
residues following both Normal and non—Normal distributions (Exponential,
Uniform, Gamma, half—Normal and t—Student). The time series length is set
to T = 75.

3 RESULTS AND DISCUSSIONS

To evaluate the performance of the proposed likelihood ratio—based
test to identify Granger causality in both a multivariate condition
and between sets of time series data, two simulations were carried
out (see Section 2.3).

Figure 1a and b show the ROC curves of LRT versus Wald’s
test in Simulation 1 and the LRT versus bootstrap—based test in
Simulation 2, respectively. The ROC curves show that the LRT

E
E

 

 

if

0.0 0.2 0.4 0.6 0.8 1.0
False positive rate

 

True positive rate
0.0 0.2 0.4 0.6 0.8 1.0
True positive rate
0.0 012 0:4 0:6 0:8 1:0

 

 

 

 

 

 

0.0 0.2 0.4 0.6 0.8 1.0
False positive rate

§

Frequency
0 100 200 300 400 500

E

Frequency
0 100 200 300 400 500

l—l—l—l—l—I l—l—l—l—l—l
0.0 0.2 0.4 0.6 0.8 1.0 0.0 0.2 0.4 0.6 0.8 1.0

p—value p—value

Fig. 1. (a) and (b): ROC curves obtained by running Simulations 1 and 2,
respectively. Solid line represents the LRT. Dashed line is the Wald’s test
of the VAR model. (c) and (d): LRT P—values histograms under the null
hypothesis obtained by running Simulations 1 and 2, respectively. LRT and
Wald’s test are equivalent in the multivariate model. In the module—module
model, LRT performs better than the bootstrap approach.

and Wald’s test are equivalent in the multivariate model (the solid
and dashed lines coincide), and the LRT performs better than the
bootstrap procedure in terms of statistical power in the module—
module model (the solid line is above the dashed line). The fact that
the LRT and Wald’s test are equivalent in the multivariate model
is an expected result since the identiﬁcation of Granger causality
between sets of genes in time series experiments is a generalization
of the multivariate Granger causality proposed by Geweke (1984).

Figure 1c and d illustrate the P—value distributions under the null
hypothesis obtained by running 10000 times Simulations 1 and 2,
respectively, with Normal residues. Notice that the rate of false
positives is effectively controlled since the histograms are close to
Uniform distributions.

Simulation 2 was also performed with residues following
non—Normal distributions namely, (i) Exponential, (ii) Uniform,
(iii) Gamma, (iv) half—Normal and (v) t—Student in order to evaluate
the robustness of the tests. LRT was able to control the rate of false
positives in the majority of the non—Normal residues even when
the residues followed t—Student distribution with three degrees of
freedom (i.e. time series with outliers due to heavy tails in the
t—Student distribution if compared to Normal distribution). In the
case of noise following multivariate t—Student distribution (when
there are outliers and time series are contemporaneously correlated),
the Type I error was controlled but not as well when compared
to the simulations performed with other noise distributions. In the
multinormal distribution case (contemporaneously correlated time
series without outliers), both bootstrap and LRT controlled the rate
of false positives (refer to Supplementary Section ‘Simulation 2 with
different noise distribution’ for more information about P—values’
distributions and ROC curves in these simulations).

To verify how Type I error is controlled in actual biological data
when noise distribution is unknown, we used the dataset of genes
originally published by Whitﬁeld et al. (2000) and used to construct
networks in Fujita et al. (2010). The points of the time series were
permuted to eliminate any presence of Granger causality. LRT was

 

2350

112 /B.IO'SIBUJHOIPJOJXO'SOIlBIHJOJUIOICI/ﬁdnq 11101; popeommoq

9IOZ ‘lg lsnﬁnv (10::

Testing Granger causality between sets of genes

 

Table 1. LRT and bootstrap procedures (with 1000, 5000 and 10000
bootstrap samples) processing time in 1000 simulations

 

Minimum 25% quantile Median 75% quantile Maximum

 

LRT 0.039 0.046 0.048 0.050 0.079
1000 36.586 41.698 41.802 41.937 67.949
5000 248.525 249.691 250.132 250.723 397.618
10000 347.584 414.948 415.991 416.961 708.712

 

All processing times were calculated by using 21 Intel Quad Core Xeon E5450 3.0 GHz.
The results are presented in seconds.

applied to this permuted time series and the process was re—done
10000 times. The results (Supplementary Section ‘Verifying the
control of Type I error in actual biological data’) show P—values
histograms close to Uniform distributions under the null hypothesis,
conﬁrming that even in real biological data, LRT is able to control
the rate of false positives. In addition, the method we propose
here was applied to the same dataset (Whitﬁeld et al., 2000) in
order to exemplify its application in the context of microarray data
interpretation (Supplementary Section ‘Application to biological
data’).

For comparative purposes, the processing times of both the
LRT and the bootstrap test were measured by running 1000 times
Simulation 2. Table 1 shows that as the number of bootstrap samples
increases in order to improve the P—value estimation, it becomes
slower than the LRT. A fast statistical test such as the proposed LRT
is of extreme importance nowadays due to the enormous amount
of data generated by microarray experiments and, consequently,
the increasing number of hypothesis to be tested. Bonferroni or
FDR correction are usually used for multiple tests correction and
when using bootstrap approaches, more accurate P—values must be
calculated by increasing the number of bootstrap samples.

In summary, the advantages of the LRT with Bartlett correction
over the bootstrap approach are: (i) the statistical power of the
LRT is greater than the bootstrap procedure; (ii) the LRT can

control the rate of false positives on both Normal and even
in non—Normal (Exponential, Uniform, Gamma, half—Normal and
t—Student) residues; and (iii) the LRT is much faster than the
bootstrap test. As a ﬁnal consideration, despite the advantages
presented for LRT, we recommend the use of the bootstrap
procedure, which is non—parametric, if one cannot guarantee that
the residues follow one of the studied distributions.

ACKNOWLEDGEMENTS

Computational time was provided by the Super Computer System,
Human Genome Center, Institute of Medical Science, University of
Tokyo.

F unding: Grant of RIKEN, Japan; Grant of FAPESP, Brazil.

Conﬂict of Interest: none declared.

REFERENCES

Bartlett,M.S. (1939) A note on tests of signiﬁcance in multivariate regression. Proc.
Camb. Phil. Soc, 35, 180—185.

Fujita,A. et al. (2009) The impact of measurement errors in the identiﬁcation of
regulatory networks. BMC Bioinformatics, 10, 412.
Fujita,A. et al. (2010) Identiﬁcation and quantiﬁcation of Granger causality between
gene sets. J. Bioinform. Comput. Biol, 8, DOI:10.1142/S0219720010004860.
Geweke,J. (1984) Measures of conditional linear dependence and feedback between
time series. J. Am. Stat. Assoc, 79, 907—915.

Granger,C.W.J. ( 1969) Investigating causal relationships by econometric models and
cross-spectral methods. Econometrica, 37, 424—438.

Gu0,S. et al. (2008) Uncovering interactions in the frequency domain. PLoS Comput.
Biol, 4, e1000087.

Johnson,R.A. and Wichern,D.W. (2002) Applied Multivariate Statistical Analysis.
Prentice Hall, New Jersey.

Mukhopadhyay,N.D. and Chatterjee,S. (2007) Causality and pathway search in
microarray time series experiment. Bioinformatics, 23, 4424149.

Timm,N.H. and Carlson,J.E. ( 1976) Part and bipartial canonical correlation analysis.
Psychometrika, 41, 159—176.

Whitﬁeld,M.L. et al. (2000) Identiﬁcation of genes periodically expressed in the human
cell cycle and their expression in tumors. Mol. Biol. Cell, 13, 1977—2000.

 

2351

112 /B.IO'SIBUJHOIPJOJXO'SOIlBIHJOJUIOICI/ﬁdnq 11101; popeommoq

9IOZ ‘lg lsnr‘o’nv uo ::

