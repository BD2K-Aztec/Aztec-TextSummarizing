ORIGINAL PAPER

Vol. 28 no. 24 2012, pages 3218—3224
doi: 10. 1093/bioinformatics/bts612

 

Sequence analysis

Advance Access publication October 11, 2012

DAFS: simultaneous aligning and folding of RNA sequences via

dual decomposition

Kengo Sat01’2’*, Yuki Katos, Tatsuya Akutsu4, Kiyoshi Asai2’5 and Yasubumi Sakakibara“2

1Department of Biosciences and Informatics, Keio University, 3—14—1 Hiyoshi, Kohoku—ku, Yokohama 223—8522, Japan,
2Computational Biology Research Center (CBRC), National Institute of Advanced Industrial Science and Technology
(AIST), 2—41—6 Aomi, Koto—ku, Tokyo 135—0064, Japan, 3Graduate School of Information Science, Nara Institute of
Science and Technology, 8916—5 Takayama, Ikoma, Nara 630—0192, Japan, 4Bioinformatics Center, Institute for
Chemical Research, Kyoto University, Gokasho, Uji, Kyoto 611—0011, Japan and 5Graduate School of Frontier Sciences,
University of Tokyo, Kashiwa, 5—1—5 Kashiwanoha, Chiba 277—8561, Japan

Associate Editor: Ivo Hofacker

 

ABSTRACT

Motivation: It is well known that the accuracy of RNA secondary
structure prediction from a single sequence is limited, and thus a
comparative approach that predicts a common secondary structure
from aligned sequences is a better choice if homologous sequences
with reliable alignments are available. However, correct secondary
structure information is needed to produce reliable alignments of
RNA sequences. To tackle this dilemma, we require a fast and accur-
ate aligner that takes structural information into consideration to yield
reliable structural alignments, which are suitable for common second-
ary structure prediction.

Results: We develop DAFS, a novel algorithm that simultaneously
aligns and folds RNA sequences based on maximizing expected
accuracy of a predicted common secondary structure and its align-
ment. DAFS decomposes the pairwise structural alignment problem
into two independent secondary structure prediction problems and
one pairwise (non-structural) alignment problem by the dual decom-
position technique, and maintains the consistency of a pairwise struc-
tural alignment by imposing penalties on inconsistent base pairs and
alignment columns that are iteratively updated. Furthermore, we
extend DAFS to consider pseudoknots in RNA structural alignments
by integrating IPknot for predicting a pseudoknotted structure. The
experiments on publicly available datasets showed that DAFS can
produce reliable structural alignments from unaligned sequences in
terms of accuracy of common secondary structure prediction.
Availability: The program of DAFS and the datasets are available at
http://www.ncrna.org/software/dafs/.

Contact: satoken@bio.keio.ac.jp

Supplementary information: Supplementary data are available at
Bioinformatics online.

Received on May 23, 2012; revised on September 18, 2012; accepted
on October 9, 2012

1 INTRODUCTION

Many functional RNAs form secondary structures that are
related to their functions such as gene regulation and maturation
of mRNAs, rRNAs and tRNAs. Therefore, analysis of RNA

 

*To whom correspondence should be addressed.

secondary structures can lead to unraveling their potential func-
tions. Since experimental determination of RNA secondary
structures is expensive and time consuming, computational
prediction of RNA secondary structures has been frequently
used. The most successful methods for predicting RNA second-
ary structures from a single sequence are based on minimizing
free energy, such as Mfold (Zuker and Stiegler, 1981) and
RNAf old (Hofacker, 2003). Alternative methods are based on
probabilistic frameworks including stochastic context-free gram-
mars that can model RNA secondary structures without pseu-
doknots (crossing base pairs on primary sequences). Several
computational methods based on stochastic context-free gram-
mars have been developed for modeling and analyzing
non-coding RNAs (Do et al., 2006; Eddy and Durbin, 1994;
Rivas et al., 2012; Sakakibara et al., 1994; Sato et al., 2010).

Nonetheless, the accuracy of RNA secondary structure predic-
tion from a single sequence is known to be limited, and thus, a
comparative approach that predicts a common secondary
structure from aligned sequences is a better choice if homologous
sequences with reliable alignments are available. Comparative
methods based on alignment folding include RNAalif old
(Bernhart et al., 2008), Pf old (Knudsen and Hein, 2003),
PETfold (Seemann et al., 2008) and CentroidAlifold
(Hamada et al., 2011). However, we require correct secondary
structure information to produce reliable alignments of RNA
sequences in turn, which is a ‘chicken-and-egg’ problem.

To tackle this dilemma, Sankoff (1985) has proposed a
dynamic programing (DP) algorithm for simultaneously aligning
and folding RNA sequences whose computational complexity is
0(L3N) time and 0(L2N) space for N sequences of length L. Since
a naive implementation of the Sankoff algorithm is impractical
because of unrealistic computational complexity, various algo-
rithms have been developed to reduce the computational com-
plexity of the Sankoff algorithm. Several pioneering studies
including the ﬁrst versions of FOLDALIGN (Gorodkin et al.,
1997) and Dynalign (Mathews and Turner, 2002) have imple-
mented restricted Sankoff algorithms; FOLDALIGN disallows
bifurcated structures, and Dynal ign assumes the maximum dis-
tance of aligned nucleotides (note that later versions of both
methods do not have such restrictions). Several succeeding meth-
ods have reduced the search space of the Sankoff algorithm by

 

3218 © The Author 2012. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com

112 ﬁhO'smumo[pJOJXO'sopchogurorq/ﬁd11q wort pepcolumoq

910K ‘09 lsnﬁnV no :2

DAFS

 

using precomputed posterior probabilities of base pairs and/or
aligned columns (Do et al., 2008; Hofacker et al., 2004; Holmes,
2005; Kiryu et al., 2007; Will et al., 2007). Sampling-based
approaches, instead of reducing the search space, have also
been developed (Lindgreen et al., 2007; Meyer and Miklos,
2007; Xu et al., 2007). Ziv-Ukelson et al. (2010) have proposed
a sparsiﬁcation technique for the Sankoff algorithm that speeds
up computation by a linear factor. Although various techniques
for reducing the computation time have been developed, the
Sankoff-style algorithms are still computationally expensive.
Alternatively, several heuristic-based algorithms that do not
strictly perform simultaneous aligning and folding of RNA
sequences have been proposed such as sequence alignment with
a structural scoring function (Dalli et al., 2006; Hamada et al.,
2009a) and stem-based alignment (Perriquet et al., 2003; Tabei
et al., 2008). LARA proposed by Bauer et al. (2007) formulates
the problem of RNA structural alignment as a graph theoretical
model for sequence alignment with additional simple structure
information. Lagrangian relaxation is applied to relax the
constraints for the structure information, then the problem is
solved as sequence alignment with iterative updates of penalty
scores. Note that LARA was not designed to predict com-
mon secondary structures since no folding model is explicitly
considered.

In this article, we present a novel algorithm DAFS that per-
forms Dual decomposition for Aligning and Folding RNA
sequences Simultaneously. First, on the basis of the maximizing
expected accuracy (MEA) principle, we design an objective func-
tion for a pairwise structural alignment as the expectation of the
sum of the numbers of correctly predicted base pairs in a
common secondary structure and those of correctly aligned col-
umns in its pairwise alignment. Then, to maximize the objective
function under several constraints for consistent pairwise struc-
tural alignment, we use the dual decomposition technique, which
decomposes the pairwise structural alignment problem into two
independent secondary structure prediction problems and one
pairwise (non-structural) alignment problem. The algorithm
maintains the consistency of a pairwise structural alignment by
imposing penalties on inconsistent base pairs and alignment col-
umns, and updates them iteratively by performing the
Nussinov-style secondary structure prediction and the
Needleman—Wunsch—style pairwise alignment with the penalized
scoring function. We easily extend the algorithm to perform mul-
tiple alignment by applying a standard progressive alignment
technique. Furthermore, we integrate the IPknot model (Sato
et al., 2011) instead of the Nussinov model so that DAFS can
simultaneously align and fold RNA sequences with pseudoknots.
Major advantages of DAFS are summarized as follows: (i) DAFS
is a fast and accurate implementation that simultaneously aligns
and folds RNA sequences. Compared with the other
Sankoff-style algorithms, DAFS achieves comparable accuracy,
and even more importantly, runs much faster. Compared with
the heuristic-based approaches such as sequence alignment with
structural scores, DAFS is more accurate, especially in terms of
common secondary structure prediction; (ii) DAFS is ﬂexible and
extensible because of the dual decomposition, which enables us
to integrate state-of-the-art folding models such as the IPknot
model for pseudoknotted secondary structures.

 

 

 

 

 

 

 

 

 

 

 

 

.......... ..
. .
v. .x
O. ...... ._ ,
, . ~ ‘ ( I )
, g x “ Px a
a
........... _. o o o o o o
’ ~
.
n’ .... 7’.
0 v‘ '-
, . ~ ‘
l 0' .s ‘
.
a—(HHHHHQ— b—()—()—()—()—()—()—<)—
I I I ‘ \ ‘ ‘ ‘ I l
‘ ‘ \ ‘ i I
. . . , . ‘ .
. . . x . . P(0|a,b) x ..  ,. P b
b \ § ~ T ‘ - - . . - - " ”
‘0—0—0—0—0—p—O— . .
.
I 7 ~ ~ _ _ _ _ n’
I ‘ '0 '1 - - . . . . .-
.
\ N. ,e '0
X _________ -‘ o
. .
. . ~ ~ _ _ ﬂ ‘ ,.
a-O-O-O-Q-Q-Q-
. . . ‘ ‘ .
- - - x x x P(z|ab)
I I I \ \ \‘ ’

 

 

 

Fig. 1. An illustration of factorization of a probability distribution over a
space of RNA structural alignments

2 METHODS

We present a novel method DAFS for simultaneous aligning and folding
of RNA sequences by dual decomposition by which an integer pro gram-
ing (IP) problem for this task is solved. DAFS calculates a pairwise struc-
tural alignment, that is, a pairwise alignment that considers RNA
secondary structures, by the following two steps when two unaligned
sequences are given: (i) compute two base-pairing probability matrices
and an alignment-matching probability matrix for the two sequences to
factorize a probability distribution of structural alignments (Section 2.2,
Fig. 1), and (ii) solve the IP problem (Section 2.3) of simultaneously
aligning and folding the given sequences by dual decomposition
(Section 2.4) to maximize the expected accuracy of the prediction.
Then, the pairwise alignment algorithm is extended to compute a multiple
alignment by a progressive alignment approach (Section 2.5).
Furthermore, we describe an extension of our algorithm to perform
RNA structural alignment that can consider pseudoknots (Section 2.6).

2.1 Preliminaries

Let 2 = {A,C,G,U} and 2* denote the set of all ﬁnite RNA sequences
consisting of bases in 2. For a sequence a = alaz...a,, e 2*, let |a|
denote the number of symbols appearing in a, which is called the
length of a. Given two RNA sequences a, b e 2*, let A(a, b) be a set of
all possible alignments of a and b, and 8(a) be a set of all possible sec-
ondary structures of a. An alignment 2 e A(a, b) is represented as a
|a| x |b| binary-valued matrix 2 = (2,7,), where 2,], = 1 if and only if the
base a,- is aligned with bk. A secondary structure x e 8(a) is represented
as a |a| x |a| binary-valued triangular matrix x = (xij), <1, where xi]- : 1 if
and only if bases a,- and aj form a base pair. Let SA(a, b) be a set of all
possible structural alignments of a and b. We write 0 = (x, y, 2), which
means that a structural alignment 0 e SA(a, b) consists of an alignment
2 e A(a, b), and two secondary structures x e 8(a) and y e 8(b).

2.2 MEA-based scoring function

One of the most promising techniques to solve discrete high-dimensional
problems on sequences such as RNA secondary structure prediction and
RNA structural alignment is the MEA-based approach including cen-
troid estimation (Carvalho and Lawrence, 2008; Hamada et al., 2009b).

Given unaligned RNA sequences, the goal of RNA structural align-
ment is to produce a reliable alignment, as well as to predict a reliable
common secondary structure. To this end, we deﬁne a gain function of a
structural alignment 0 2 (fr, jg?) with regard to the correct structural
alignment 0 = (x, y, 2) as the weighted sum of gain functions Gs(x,)2)
and Gs(y, j?) of respective secondary structures and a gain function
Ga(z,2) of the alignment as follows:

0(9, 9‘) = a{G,(x, )2) + G,(y, f0} + 0,,(2, 2) (1)

where a>0 is a parameter that controls the weight of the secondary
structures and the alignment. The gain function Gs(x, fr) of the secondary
structure )2 is deﬁned as follows:

Gs(x, 9?) = (1 — T) TPs(x, 9?) + t TNS(X: 56)

 

321 9

112 /810's112umo[pJOJXO'soiiemJOJuroiw/zdnq moi; pepeolumoq

910K ‘09 lsnﬁnV no :2

K.Sato et al.

 

where T Ps(x, )2) = 2,- <1. I(x,-j = 1)](561'1' = 1) is the number of true positive
predictions, T Ns(x, fr) = 2,- <1. I(x,-j = 0)I()‘c,-j = 0) is the number of true
negative predictions and ‘L’ e [0, 1] is a balancing parameter between true
positives and true negatives. Here, I(c0nditi0n) is the indicator function that
takes a value of 1 or 0 depending on whether the condition is true or false.
The gain function Gs(x, fr) can be regarded as a kind of ‘accuracy’ that
represents the weighted sum of the number of true predictions in )2, which is
correlated to balanced accuracy measures such as Matthews correlation
coefﬁcient (MCC) and F-measure. Note that Gs(x, fr) is equivalent to the
gain function of the y-centroid estimator used in CentroidFold
mamada et al., 2009b) for ‘L’ = 1/(1 + y). Similarly, the gain function
Ga(z,2) of the alignment 2 is deﬁned as the number of true predictions
in 2 as follows:

042,3) = (1 — 0) TPa(Z,3) + 0 TNa(Z,§)

where T Pa(z, 2) = 2,, k [(2,]C = 1)I(2,-k = 1) is the number of true positive
predictions and T Na(z, 2) = 21-, k [(2,]C = 0)I(2,-k = 0) is the number of
true negative predictions. Here, a e [0, 1] is a balancing parameter
between true positives and true negatives.

In accordance with the MEA principle, we ﬁnd a structural alignment
9 that maximizes the expectation of the gain function (1) under a
given probability distribution over the space SA(a, b) of structural
alignments:

resume. 0)] = 2,684,, P(ela. b)G(0, 0‘) (2)

where P(0Ia, b) is a probability distribution of RNA structural
alignments.

Unfortunately, computation of Equation (2) requires 0(|a|3|b|3) time
and 0(|a|2|b|2) space even if we assume only pseudoknot-free secondary
structures. Therefore, we assume independence of structure and align-
ment, and factorize the probability distribution of the structural align-
ments as follows:

P(9la, 19) N P(xla)P(y|b)P(Z|a, 19) (3)

where P(xla) and P(y|b) are probability distributions of RNA secondary
structures over 8(a) and 8(b), respectively, and P(zla, b) is a probability
distribution of alignments over A(a, b) (Fig. 1). We can then approximate

the expected gain function (2) by the following:
[Emma 6)] e Z, , [pf-2’”) — a]2.-k ( )
’ 4

( ) A (b) A
+ a<Zi<j [1’qu _ zjij + Zk<l [ka _ T]ykl) + C

where

121;?) = Z P(xla)I(Xz-j=1),

xeS(a)
pi? = Z P(y|b)I(yk,=1)
y68(b)

are base-pairing posterior probability distributions,

125;.” b) = Z P(zla.b)I(z.-k =1)
ZEA(a, b)

is an alignment-matching posterior probability distribution and C is a
constant independent of 0 = (2,12,?) (see Section S1 in Supplementary
Material for the derivation). If we assume pseudoknot-free structures for
a and b, calculation of the posterior probabilities 12%;), p)? and b)
requires 0(|a|3),0(|b|3) and 0(|a||b|) in time and 0(|a|2),0(|b|2) and

0(|a||b|) in space, respectively.

2.3 [P formulation

Our objective is to ﬁnd an RNA structural alignment that maximizes the
approximate expected gain (4), satisfying the consistency of the RNA

structural alignment. This optimization problem can be formulated as
the following IP problem that maximizes:

S(x, y, z;a, b) = 2 b) — a]z,-k
i,k

(5)
+ 01(31):? —  + 2 [p22 — 4y...)
i<j k<l
subject to:
iji + inj S 1 (1 5 W S 1611), (6)
j<i j>i
x,- + x,,,-, 5 1 (1 5 Vi<Vi’ <Vj<Vj’ 5 |a|), (7)
Zylk + 21%! S 1 (1 S Vk S Ibl), (8)
l<k l>k
ya +yk/l/ s 1 (1 s Vk<Vl€<Vl<Vl’ s lbl), (9)
22,-]. s 1 (1 5 Vi s Ial), (10)
k
22,-]. 51 (1 s vk s Ibl), (11)
i
Zil+ij 51 (15Vi<VjsIaI; lsvk<vls Ibl), (12)
x,- = 2 WW (1 s Vi<Vj s lal), (13)
k<l
ykl = Zwijkl (1 S Vk<Vl S Ibl), (14)
i<j

2,-1.2 2 Wjizk+ Z Wijkl (15ViS|a|;15VkS|/9|) (15)

j<i,l<k j>i,l>k

where wijkl is a binary-valued variable such that WW 2 1 if and only if a
base pair (a,,aj) is aligned with a base pair (bk,b,). The constraint (6)
means that each base a,- can be paired with at most one base (Fig. 2a), and
the constraint (7) allows no pseudoknots in the secondary structure
x e 8(a) (Fig. 2b). Similarly, the constraints (8) and (9) maintain the
consistency of the secondary structure y e 8(b). The constraints (10)
and (11) state that each base in a and b can be aligned with at most
one base (Fig. 2c and d), and the constraint (12) allows no crossing
match in the alignment 2 e A(a, b) (Fig. 2e). The constraints (13)—(15)
represent agreement between x, y and Z that must be satisﬁed by the
common secondary structure 0 = (x, y, z) e SA(a, b). If we can drop
the constraints (13)—(15), each component x, y and z of the structural
alignment can be solved separately and efﬁciently. This means that the
constraints (13)—(15) make the problem of RNA structural alignment
extremely complex.

Consider the condition for WW 2 1. Because of the constraints
(13)—(15), WW 2 1 implies xij = ykl = Zik = 211 = 1. Therefore, to maxi-
mize the objective function (5), the contribution of Wijk] = 1 should be
positive:

1p)?” — 01+ [pl-z“) - 01+ “(1195? - 11+ [115? — ‘1)>0 (16)

Furthermore, since the contribution of the base pair match, wijkl [the
left-hand side of Equation (16)] should be larger than that of two loop
matches 2,7C and 21-), that is, b) — a] + b) — a], the following condi-
tion should be satisﬁed:

pg?) — e] + [12)? — :1 >0 (17)

 

3220

112 /810's112umo[pJOJXO'soi112u1101uioiq/ﬁd11q 111011 pepeolumoq

910K ‘09 lsnﬁnV no 22

DAFS

 

(a) (b) x x
x] xii “£'~’~:""J~
a—o—d—o— a —O—O—o—o—
J l J i l J J
(C) (d) . _, (e) _
l l l l J
a —Q— ‘1 —Q—,O— a —O«—,O—
Ziki \\ Zik, ziki “2’2” 211‘}: ij
b : § b : ’l b ’ﬁ’ 5
k k’ k k I

Fig. 2. An illustration of the constraints of the IP formulation. The dia-
grams (a) and (b) correspond to the constraints (6) and (7), respectively.
Note that at most one variable shown by a broken curved line can take a
value 1. The diagrams (c), (d) and (e) correspond to the constraints (10),
(11) and (12), respectively

Therefore, it is no longer necessary to consider wijkl that does not satisfy
the conditions (16) and (17). We call this the threshold cut technique,
which accelerates our algorithm as we will describe in the next section.

2.4 Dual decomposition

Recall that the main difﬁculty of solving the IP problem of RNA struc-
tural alignment arises from the constraints (13)—(15). To circumvent this
difﬁculty, we deal with these constraints using Lagrangian relaxation
(Korte and Vygen, 2008). First, we deﬁne the Lagrangian dual by
moving the constraints (13)—(15) to the objective function (5):

L0», ,u, v) = max
x E S(a),y E 8(b),
2 E A(a, b), w

+ Z Aij  Wijkl — xij) + Z Mk, WW _ ykl) (18)
k<l

i<j k<l i<j

+ Z Vik (Zik — Z Wjilk — Z Wijkl) }
i,k

j<i,l<k j>i,l>k

{S(x, y, z; a, b)

where A = {Ay|i<j}, ,a = {,akllk<l} and v = {viklvik Z 0} are Lagrangian
multipliers. We can then rewrite Equarion (18) as:

_ (a)_ _ .. ..
Lem-tatglwv 2) Alev

+ max [05072]) — T) — Mkl]ykl

376507)
+ max [ .a’ — a + v- ]z-
zeA(a,b) ik p”‘ ’k 'k

+ max 2 [Al-j + ,U/kl — vik — le] Wijkl
i<j,k<l

meaning that we can calculate each term of Equation (19) independently
and efﬁciently by using the DP techniques: the Nussinov-style algorithm
(Nussinov et al., 1978) for the ﬁrst and second terms and the Needleman—
Wunsch—style algorithm (Needleman and Wunsch, 1970) for the third
term; and by simply ﬁnding positive coefﬁcients for the last term. This
technique is called dual decomposition (Wainwright et al., 2005).

Since the dual objective function LO», ,u, 1)) gives an upper bound of the
primal objective function (5), we aim to minimize Equation (19) with re-
spect to the multipliers to obtain a better upper bound. The Lagrangian
function LO», ,u, v) is convex, but not differentiable (Korte and Vygen,
2008). Thus, to minimize the dual objective function (19), we can apply
the subgradient optimization in which the Lagrangian multipliers Aij, ,uk,
and 1),), are iteratively updated by using their subgradients
Zk<l Wijkl _ xi]: Zi<j Wijkl _ ykl and Zik _ Zj<i,l<k Wﬁlk _ Zj>i,l>k Wijkl’
respectively. As a result, we can obtain an algorithm similar to the gradient
descent as shown in Figure 3, where n“) > 0 is a step size at each update. It

1: Calculate the posterior probabilities pg?) , pg? and pEZ’b).

2: Set AS.) = 0, 11:1,) = 0 and 1111,? = 0.
32f0rt=1tono t
4: m“) <— arg maxmesm) 2K3. [a(p§;‘) — 7') — A29] 33,-,-

51 y“) <— arg maxyesw) Zk<z [9005? — 7') — (1%)] yij
6: 2“) (— arg maxz€A(a,b) Zak [19],?!» — a + V212] 22k
7: w“) <— arg Inan Zi<j,k<l[)‘7(;;) + Mitt) _ Vii? _ Vaginwijkl
8: if 0“) 2 (mm , y“), z(t)) satisﬁes the constraints (13)—(15) then
9: return 19“) = (x(t),y(t), 205))
1°: “(‘13) ( ) < ) ( >
t t t t
11: Aij <— Aij — 77m (Zk<l wijkl _ mij )

. t+1 t t t
12- Niel ) ‘— l‘iel) _ 77“) (Zi<j wiij _ 9121))
13: Vg-H) <— max{0,1/z.(,:) — 7705) 

t t
_ zj<i,l<k  — Zj>i,l>k wijiez)}
14: end for
15: return 0(T) = (m(T),y(T),z(T))

Fig. 3. The algorithm for predicting RNA structural alignments using
DD. T is the maximum number of iterations

has been proven that if limHoo n“) = 0 and 2:1 1;“) 2 co, the Lagrangian
dual L0», ,a, 1)) always converges to the optimal value. The update is iter-
ated until the solution is found or the number of iterations reaches the
predeﬁned maximum number of iterations T, which is sufﬁciently large.

The Lagrange multipliers can be regarded as penalty scores against
inconsistency between alignments and secondary structures for the con-
straints (13)—(15).

The computational complexity of the algorithm in Figure 3 is domi-
nated by that of the subproblems and the number of WW, which is at
most |a| |b|(|a| + IbI)/2‘L’ by using the threshold cut technique described in
Section 2.3. If we approximate |a| % L and |b| % L, the time and space
complexities of the algorithm are 0(TL3/T) and 0(L3/T), respectively.
See Section S2 in Supplementary Material for details.

2.5 Extension to multiple alignment

We can easily extend pairwise alignment described in Section 2.4 to mul-
tiple alignment by the progressive approach (Feng and Doolittle, 1987)
with the average base-pairing probability matrix and the average
alignment-matching probability matrix.

Let A and B be two alignments of RNA sequences. We deﬁne the
average base-pairing probabilities pg!) to be the average of pg?) over all
sequences a e A, remapped to the coordinates of the alignment A.

Similarly, we deﬁne the average alignment-matching probabilities pglf’B)

to be the average of b) over all pairs of sequences a e A and b e B,
remapped to the coordinates of the alignments A and B. We can predict
the optimal structural alignment of two alignments A and B by the dual

decomposition algorithm (Fig. 3) with [if-Jamil?) and pgl’j’B) instead of

1,91) par) and pga. b)
y ’ kl 1k

Given a set of unaligned sequences, we ﬁrst build a guide tree by clus-
tering the sequences with a UPGMA using the expected accuracy simi-
larity measure (Do et al., 2005). We then perform progressive alignment

by aligning alignments of the sequences according to the guide tree.

2.6 Extension to structural alignment with pseudoknots

As described in Section 2.4, our algorithm decomposes the master prob-
lem of RNA structural alignment into the three slave problems: two sec-
ondary structure prediction problems and one pairwise (non-structural)
alignment problem, each of which can be solved independently. This
allows us to easily take pseudoknots into account by replacing the
Nussinov-style DP algorithm with the IPknot model (Sato et al.,

 

3221

112 /810's112umofpinXO'soi112u1101uroiq//2d11q 111011 pepeolumoq

910K ‘09 lsnﬁnV uo 22

K.Sato et al.

 

2011) for predicting secondary structures with pseudoknots. To the au-
thors’ knowledge, this is the ﬁrst implementation that can simultaneously
align and fold RNA sequences considering pseudoknotted secondary
structures, except for SimulFold (Meyer and Miklos, 2007) and
RNASampler O(u et al., 2007), which are based on a sampling algorithm.
See Section S3 in Supplementary Material for details.

3 RESULTS

3.1 Implementation

Our algorithm was implemented as a program called DAFS. To
calculate base-pairing probabilities, we used the McCaskill
model (McCaskill, 1990) in the Vienna RNA package
(Hofacker, 2003), using the free energy parameters estimated
by the Boltzmann likelihood-based method (Andronescu et al.,
2010). To calculate alignment-matching probabilities, we used
the ProbCons model (Do et al., 2005). We implemented DAFS
with two decoding algorithms for Lines 4 and 5 in Figure 3: the
Nussinov decoding and the IPknot decoding. DAFS with the
IPknot decoding can handle pseudoknotted secondary struc-
tures, whereas DAFS with the Nussinov decoding cannot.

Part of the IPknot decoding in DAFS was implemented using
the CPLEX IP solver (http://www-01.ibm.com/software/integra—
tion/optimization/cplex-optimizer/). In this study, we used em-
pirically determined parameters: a = 4.0, ‘L' = 0.2, a = 0.01 and
T: 600.

3.2 Datasets

For the benchmark, we created new datasets from Rfam 11.0
(Gardner et al., 2011). Only manually curated seed alignments
with consensus structures published in literature were used. We
produced 691 pseudoknot—free alignments (PKfree dataset) and
82 pseudoknotted alignments (PK dataset). Each alignment con-
tains 10 sequences from the Rfam families. Furthermore, to
avoid selective bias in evaluation, we also used four datasets of
RNA sequences that have been established in previous studies
(Gardner et al., 2005; Kiryu et al., 2007; Lindgreen et al., 2007;
Tabei et al., 2008). See Section S4 in Supplementary Material for
more details.

3.3 Evaluation metrics

We evaluated the accuracy of predicted structural alignments
through two measures for alignments and three measures for
common secondary structures. To evaluate produced alignments,
the following measures were used: (i) sum-of-pairs score (SPS)
(Thompson et al., 1999), which is deﬁned as the proportion of
correctly aligned matches in the predicted alignment, and (ii)
structure conservation index (SCI) WVashietl et al., 2005),
which is deﬁned as SCI 2 E A / E, where E A is the consensus min-
imum free energy computed by RNAalif old (Bernhart et al.,
2008) and E is the average minimum free energy over all RNA
sequences in the predicted alignment. These measures can be
calculated directly from produced alignments.

To evaluate predicted common secondary structures, we ﬁrst
mapped a predicted (reference, respectively) common secondary
structure to each sequence according to the predicted (reference)
alignment. Then, the predicted secondary structure mapped to
each sequence was evaluated by the following three measures:

(iii) sensitivity (SEN), which is deﬁned as the proportion of cor-
rectly predicted base pairs in the reference secondary structure,
i.e. SEN = TP/(TP + FN), (iv) positive predictive value
(PPV), which is deﬁned as the proportion of the correctly pre-
dicted base pairs in the predicted secondary structure, i.e.
PPV = TP/(TP + FF), and (v) MCC, which is deﬁned as:

TP-TN—FN-FP

MCC =
\/(TP + FN)(TN + FP)(TP + FP)(TN + FN)

 

 

where TP is the number of base pairs appearing in both the
reference and predicted structures, FP is the number of base
pairs that appear in the predicted structure but not in the refer-
ence, TN is the number of base pairs that appear in neither
structure and FN is the number of base pairs that appear in
the reference but not in the predicted structure. Note that there
exists a trade-off between SEN and PPV, and MCC is a balanced
evaluation measure between them.

3.4 Effectiveness of dual decomposition

We ﬁrst validated on the Murlet dataset (Kiryu et al., 2007) that
our algorithm can yield the optimal solution or a good approxi-
mation close to the optimal solution. Figure 4a shows the aver-
age number of constraints that are not satisﬁed at the maximum
number of the iteration, T in Figure 3, ranging from 1 to 1000,
indicating that satisﬁable solutions can be achieved at T Z 600.
Figure 4b and 0 show elapsed time to process all the sequences in
the dataset and accuracy, including SPS, SCI and MCC, at the
maximum number of the iteration, respectively, comparing the
results of the dual decomposition with the counterparts achieved
by the CPLEX IP solver. These results clearly indicate that SPS,
SCI and MCC sufﬁciently converged to the optimal at T Z 600
even though the dual decomposition with T: 600 performed
extremely faster than CPLEX. Therefore, we set T: 600 in sub-
sequent experiments.

3.5 Structural alignments Without pseudoknots

We conducted several computational experiments of predicting
RNA structural alignments on the PKfree dataset, comparing
DAFS with the following state-of-art aligners for structural align-
ment: (i) CentroidAl ign version 1.00 (Hamada et al., 2009a),
(ii) RAF version 1.0 (Do et al., 2008), (iii) LARA version 1.3.2a
(Bauer et al., 2007), and (iv) LocARNA version 1.6.1 WVill et al.,
2007). RAF and LocARNA, as well as DAFS, perform
simultaneous aligning and folding of RNA sequences.
CentroidAlign and LARA perform sequence alignment with
structural scores. We also used the following standard alignment
tool that does not consider any secondary structure as baselines
in the comparison: (v) ProbConsRNA version 1.1 (Do et al.,
2005).

Table l and Supplementary Tables S2—S6 in Supplementary
Material show the results on the datasets that do not contain
pseudoknotted reference structures. These results indicate that
DAFS achieved high accuracy in the measures for common sec-
ondary structures, especially in MCC that is a balanced measure
between SEN and PPV, and is much faster than RAF, one of the
most accurate competitors, although the accuracy of DAFS in the
measures for alignments is not remarkable. Since accurate

 

3222

112 /810's112umofpinXO'soi112u1101uroiq//2d11q 111011 pepeolumoq

910K ‘09 lsnﬁnV uo 22

DAFS

 

(a) (b)

 

(c)

 

 

 

1 00
I
1 500
I

 

 

 

 

 

 

 

 

I
1
1

 

 

 

 

 

 

 

.9
E
E
173
s 3 §—
2 o _ m F
22 ‘° 2
g I— 1.0
.CS’ :5 T
1.6 g _ A A A A A A A A A A A A A A A
:12: 8 _
LO
W V. _
o _ o
N
— Time (DD) -6— SPS (DD) -A— SCI (DD) —I— MCC (DD)
0 _ o _ ---- -- Time (IP)  _ ---- SPS(IP) ------ -- SCI (IP) ------ MCC(IP)
I I I I I I I I I I I I
0 200 400 600 800 1000 0 200 400 600 800 1000 0 200 400 600 800 1000
T T T

Fig. 4. The behavior of the dual decomposition algorithm as the maximum number of the iteration T is varied (DD = Dual Decomposition, IP = Integer
Programming). (a) The mean and the standard deviation of the number of violated constraints over all the predictions at T. (b) The total execution time
of DD and IP for all the alignments at T measured on a Linux workstation with Intel Xeon E5450 (3.0 GHz). (c) The accuracy of DD and IP at T

Table 1. The results on the PKfree dataset

 

 

Aligner SPS SCI SEN PPV MCC TIME
DAFS 0.82 0.61 0.76 0.77 0.76 2 275
CentroidAl ign 0.84 0.61 0.68 0.82 0.73 1 010
RAF 0.82 0.58 0.73 0.79 0.75 11 693
LARA 0.81 0.62 0.69 0.80 0.73 29 734
LocARNA 0.79 0.69 0.70 0.79 0.73 63 935
ProbConsRNA 0.83 0.52 0.62 0.80 0.69 532

 

TIME means the total computation time in seconds measured on a Linux worksta-
tion with Intel Xeon E5450 (3.0GHz). The bold values indicate the best score in
each evaluation measure. For all the methods except DAFS, SEN, PPV and MCC,
are calculated using common secondary structures predicted by
CentroidAlif old with default parameters from produced alignments. See
Section S4 in Supplementary Material for the results using RNAalifold and intrinsic
predictions.

prediction of RNA secondary structures is crucial for unraveling
potential functions of non-coding RNAs as mentioned in Section
1, fast and accurate structural alignments of DAFS shown in the
results are preferable.

3.6 Structural alignments with pseudoknots

We conducted the experiment of predicting RNA structural
alignments with pseudoknots on the PK dataset that contains
pseudoknots in the reference structures, comparing DAFS with
RNASampl er version 1.3 Oiu et al., 2007) with the option of ‘-X
1’ that allows us to consider simple pseudoknots. Note that there
is no existing practical structural aligner that can consider pseu-
doknots, except for RNASampler. Since RNASampler cannot
recover common secondary structures with pseudoknots, we
used IPknot with default parameters to predict common sec-
ondary structures from produced alignments. Table 2 clearly
shows the advantage of DAFS with the IPknot decoding that
can simultaneously align and fold RNA sequences with pseudo-
knots. Furthermore, the comparison between the Nussinov
decoding and the IPknot decoding indicates that IPknot is

Table 2. The results on the PK dataset

 

 

Aligner SPS SCI SEN PPV MCC TIME
DAF S
IPknot decoding 0.80 0.57 0.61 0.70 0.64 4 580
Nussinov decoding 0.80 0.56 0.54 0.67 0.60 674
RNASampler 0.70 0.55 0.52 0.69 0.59 164 206

 

TIME means the total computation time in seconds measured on a Linux worksta-
tion with Intel Xeon E5450 (3.0GHz). The bold values indicate the best score in
each evaluation measure. See Section S4 in Supplementary Material for the results
using IPknot for DAFS with Nussinov decoding.

successfully integrated into DAFS, meaning that DAFS is ﬂexible
and extensible because of the dual decomposition.

4 DISCUSSION

We developed a fast and accurate RNA structural aligner called
DAFS that simultaneously aligns and folds RNA sequences by
dual decomposition. Speciﬁcally, our method decomposes the
RNA structural alignment problem into three subproblems,
then respective problems are solved by simple and efﬁcient algo-
rithms such as the Nussinov-style DP and the Needleman—
Wunsch-style DP. This means that DAFS can explicitly take
the folding model into account, whereas LARA that has also
used Lagrangian relaxation cannot. In fact, we showed that the
dual decomposition technique enables us to integrate
state-of-the-art folding models such as the IPknot model for
pseudoknotted structures. This ﬂexibility to adapt the folding
models to our algorithm would lead us to further improvement
by using an extended secondary structure model such as
RNAwol f (zu Siederdissen et al., 2011), where base-pairing prob-
abilities for extended secondary structures are used.

One of the other differences between DAFS and LARA is the
scoring system in the objective function. The scoring system of
DAFS is based on the MEA principle, which has been successfully
applied to various problems in bioinformatics (Do et al., 2005,

 

3223

112 /810's112umofpinXO'soi112u1101uroiq//2d11q 111011 pepcolumoq

910K ‘09 lsnﬁnV uo 22

K.Sato et al.

 

2006; Hamada et al., 2009b; Hamada et al., 2011; Kato et al.,
2010; Sato et al., 2011). The MEA-based scoring function not
only improves accuracy in prediction but also makes DAFS run
fast by the threshold cut technique, which is derived from the IP
formulation based on the MEA-based scoring function described
in Section 2.3. The threshold cut technique has also been applied
to RactIP (Kato et al., 2010) and IPknot (Sato et al., 2011),
and has contributed to their accuracy and efﬁciency.

Prediction accuracy of DAFS depends mainly on its scoring
functions even though the method uses the approximate prob-
ability distribution for RNA structural alignments that assumes
independence of alignment and structure. In fact, experimental
results shown in Section S5 in Supplementary Material revealed
that when we adopted the exact posterior probabilities for RNA
structural alignments, a signiﬁcant improvement was conﬁrmed,
though much computation time was spent on the predictions.
Considering these results, there is room for further investigation
into reﬁnement of the scoring functions that make prediction
accuracy compatible with practical running time.

ACKNOWLEDGEMENTS

The authors thank Dr Michiaki Hamada and our colleagues
from the RNA Informatics Team at the Computational
Biology Research Center (CBRC) for fruitful discussions. The
super-computing resource was provided by Human Genome
Center, Institute of Medical Science, University of Tokyo.

Funding: Grant-in-Aid for Young Scientists (B) (KAKENHI)
from Japan Society for the Promotion of Science (22700305 to
KS. and 22700313 to Y.K.).

Conflict of Interest: none declared.

REFERENCES

Andronescu,M. et al. (2010) Computational approaches for RNA energy parameter
estimation. RNA, 16, 2304—2318.

Bauer,M. et al. (2007) Accurate multiple sequence-structure alignment of RNA
sequences using combinatorial optimization. BM C Bioinform., 8, 271.

Bemhart,S.H. et al. (2008) RNAalif old: improved consensus structure prediction
for RNA alignments. BM C Bioinform., 9, 474.

Carvalho,L.E. and Lawrence,C.E. (2008) Centroid estimation in discrete
high-dimensional spaces with applications in biology. Proc. Natl Acad. Sci.
USA, 105, 3209—3214.

Dalli,D. et al. (2006) STRAL: progressive alignment of non-coding RNA using base
pairing probability vectors in quadratic time. Bioinformatics, 22, 1593—1599.
Do,C.B. et al. (2005) ProbCons: probabilistic consistency-based multiple sequence

alignment. Genome Res, 15, 330—340.

Do,C.B. et al. (2006) CONTRAfold: RNA secondary structure prediction without
physics-based models. Bioinformatics, 22, e90—e98.

Do,C.B. et al. (2008) A max-margin model for efficient simultaneous alignment and
folding of RNA sequences. Bioinformatics, 24, 68—76.

Eddy,S.R. and Durbin,R. (1994) RNA sequence analysis using covariance models.
Nucleic Acids Res, 22, 2079—2088.

Feng,D.F. and Doolittle,R.F. (1987) Progressive sequence alignment as a prerequis-
ite to correct phylogenetic trees. J. Mol. Evol., 25, 351—360.

Gardner,P.P. et al. (2005) A benchmark of multiple sequence alignment programs
upon structural RNAs. Nucleic Acids Res, 33, 2433—2439.

Gardner,P.P. et al. (2011) Rfam: Wikipedia, clans and the ‘decimal’ release. Nucleic
Acids Res, 39, D141—D145.

Gorodkin,J. et al. (1997) Finding the most signiﬁcant common sequence and struc-
ture motifs in a set of RNA sequences. Nucleic Acids Res, 25, 3724—3732.

Hamada,M. et al. (2009a) CentroidAlign: fast and accurate aligner for struc-
tured RNAs by maximizing expected sum-of-pairs score. Bioinformatics, 25,
3236—3243.

Hamada,M. et al. (2009b) Prediction of RNA secondary structure using generalized
centroid estimators. Bioinformatics, 25, 465—473.

Hamada,M. et al. (2011) Improving the accuracy of predicting secondary structure
for aligned RNA sequences. Nucleic Acids Res, 39, 393—402.

Hofacker,I.L. (2003) Vienna RNA secondary structure server. Nucleic Acids Res,
31, 3429—3431.

Hofacker,I.L. et al. (2004) Alignment of RNA base pairing probability matrices.
Bioinformatics, 20, 2222—2227.

Holmes,I. (2005) Accelerated probabilistic inference of RNA structure evolution.
BMC Bioinform., 6, 73.

Kato,Y. et al. (2010) RactIP: fast and accurate prediction of RNA-RNA interaction
using integer programming. Bioinformatics, 26, i460—466.

Kiryu,H. et al. (2007) Murlet: a practical multiple alignment tool for structural
RNA sequences. Bioinformatics, 23, 1588—1598.

Knudsen,B. and Hein,J. (2003) Pfold: RNA secondary structure prediction using
stochastic context-free grammars. Nucleic Acids Res, 31, 3423—3428.

Korte,B. and Vygen,J. (2008) Combinatorial Optimization: Theory and Algorithms.
Springer Verlag, Berlin, Germany.

Lindgreen,S. et al. (2007) MASTR: multiple alignment and structure prediction of
non-coding RNAs using simulated annealing. Bioinformatics, 23, 3304—3311.

Mathews,D.H. and Tumer,D.H. (2002) Dynalign: an algorithm for ﬁnding the
secondary structure common to two RNA sequences. J. Mol Biol, 317,
191—203.

McCaskill,J.S. (1990) The equilibrium partition function and base pair binding
probabilities for RNA secondary structure. Biopolymers, 29, 1105—1119.

Meyer,I.M. and Miklos,I. (2007) SimulFold: simultaneously inferring RNA struc-
tures including pseudoknots, alignments, and trees using a Bayesian MCMC
framework. PLoS Comput. Biol, 3, e149.

Needleman,S.B. and Wunsch,C.D. (1970) A general method applicable to the
search for similarities in the amino acid sequence of two proteins. J. Mol
Biol, 48, 443—453.

Nussinov,R. et al. (1978) Algorithms for loop matching. SIAM J. Appl. Math., 35,
68—82.

Perriquet,0. et al. (2003) Finding the common structure shared by two homologous
RNAs. Bioinformatics, 19, 108—116.

Rivas,E. et al. (2012) A range of complex probabilistic models for RNA secondary
structure prediction that includes the nearest-neighbor model and more. RNA,
18, 193—212.

Sakakibara,Y. et al. (1994) Stochastic context-free grammars for tRNA modeling.
Nucleic Acids Res, 22, 5112—5120.

Sankoff,D. (1985) Simultaneous solution of the RNA folding, alignment and pro-
tosequence problems. SIAM J. Appl. Math., 45, 810—825.

Sato,K. et al. (2010) A non-parametric Bayesian approach for predicting RNA
secondary structures. J. Bioinform. Comput. Biol, 8, 727—742.

Sato,K. et al. (2011) IPknot: fast and accurate prediction of RNA secondary
structures with pseudoknots using integer programming. Bioinformatics, 27,
85—93.

Seemann,S.E. et al. (2008) Unifying evolutionary and thermodynamic information
for RNA folding of multiple alignments. Nucleic Acids Res, 36, 6355—6362.
Tabei,Y. et al. (2008) A fast structural multiple alignment method for long RNA

sequences. BMC Bioinform., 9, 33.

Thompson,J.D. et al. (1999) A comprehensive comparison of multiple sequence
alignment programs. Nucleic Acids Res, 27, 2682—2690.

Wainwright,M. et al. (2005) MAP estimation via agreement on trees: message-
passing and linear programming. IEEE Trans. Inf. Theory, 51, 3697—3717.
Washietl,S. et al. (2005) Fast and reliable prediction of noncoding RNAs.

Proc. Natl Acad. Sci. USA, 102, 2454—2459.

Will,S. et al. (2007) Inferring noncoding RNA families and classes by means of
genome-scale structure-based clustering. PLoS Comput. Biol, 3, e65.

Xu,X. et al. (2007) RNA Sampler: a new sampling based algorithm for common
RNA secondary structure prediction and structural alignment. Bioinformatics,
23, 1883—1891.

Ziv-Ukelson,M. et al. (2010) A faster algorithm for simultaneous alignment and
folding of RNA. J. Comput. Biol, 17, 1051—1065.

zu Siederdissen,C.H. et al. (2011) A folding algorithm for extended RNA secondary
structures. Bioinformatics, 27, il29—l 36.

Zuker,M. and Stiegler,P. (1981) Optimal computer folding of large RNA sequences
using thermodynamics and auxiliary information. Nucleic Acids Res, 9,
133—148.

 

3224

112 /810's112umofpinXO'soi112u1101uroiq//2d11q IIIOJJ pepcolumoq

910K ‘09 lsnﬁnV uo 22

