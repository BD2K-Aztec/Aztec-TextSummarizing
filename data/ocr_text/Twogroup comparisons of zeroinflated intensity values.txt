Bioinformatics, 31 (14), 2015, 2310—2317

doi: 10.1093/bioinformatics/btv154

Advance Access Publication Date: 18 March 2015
Original Paper

 

Gene expression

Two-group comparisons of zero-inflated
intensity values: the choice of test statistic
matters

Andreas Gleiss‘, Mohammed Daknaz, Harald Mischakz and
Georg Heinze1'*

1Center for Medical Statistics, Informatics and Intelligent Systems, Medical University Vienna, Austria, Vienna,
Austria and 2Mosaiques Diagnostics and Therapeutics AG, Hannover, Germany

*To whom correspondence should be addressed.
Associate Editor: Janet Kelso

Received on April 8, 2014; revised on November 20, 2014; accepted on March 16, 2015

Abstract

Motivation: A special characteristic of data from molecular biology is the frequent occurrence of
zero intensity values which can arise either by true absence of a compound or by a signal that is
below a technical limit of detection.

Results: While so-called two-part tests compare mixture distributions between groups, one-part
tests treat the zero-inflated distributions as left-censored. The left-inflated mixture model combines
these two approaches. Both types of distributional assumptions and combinations of both are con-
sidered in a simulation study to compare power and estimation of log fold change. We discuss
issues of application using an example from peptidomics.

The considered tests generally perform best in scenarios satisfying their respective distributional
assumptions. In the absence of distributional assumptions, the two-part Wilcoxon test or the em-
pirical likelihood ratio test is recommended. Assuming a log-normal subdistribution the left-
inflated mixture model provides estimates for the proportions of the two considered types of zero
intensities.

Availability: R code is available at http://cemsiis.meduniwien.ac.at/en/kb/science-research/software/
Contact: georg.heinze@meduniwien.ac.at

Supplementary information: Supplementary data are available at Bioinformatics online.

 

1 Introduction

 

The appropriateness of a statistical test for detecting differential
expression in omics experiments, e.g. microRNA, metabolomics or
peptidomics, is primarily determined by the data distribution.
After pre-processing steps intensity values of such experiments
typically show a distribution consisting of a certain proportion of
values at a point-mass at zero (point-mass values, PMVs) and a
continuous component. Dakna et al. (2010) distinguish between
two types of PMVs: biological PMVs (BPMVs), meaning that the
compound’s intensity is absent; and technical PMVs (TPMVs)
where a compound is present but its signal is below the limit of
detection (LOD).

Data taken from http://mosaiques-diagnostics.de/diapatpcms/
mosaiquescms/front_content.phpPidcat=25 7 will be used to demon-
strate the occurrence of PMVs (see Coon et al., 2008; Siwy et al.,
2011). Urine samples from 100 patients with chronic kidney disease
(CKD; estimated glomerular filtration rate < 45) and 100 samples
from control patients (estimated glomerular filtration rate > 60) are
available. The dataset comprises 5,616 peptides of 25 randomly se-
lected CKD and 25 control patients. Across all peptides the median
PMV proportion amounts to 96% (quartiles 80%, 100%) in the
control and 92% (quartiles 80%, 100%) in the CKD group. For the
majority of peptides the PMV proportions in the two groups are

©The Author 2015. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com 2310

112 [3.10811211an[plOJXO'SODBIILIOJIITOTQ/ﬂ(11111 wort pepeolumoq

910K ‘09 lsnﬁnV no :2

Two-group comparisons of zero-inflated intensity values

2311

 

close to each other (quartiles of the intra-compound difference of
the number of PMVs are —1 and +2). Figure 1 shows histograms for
two selected peptides.

Similarly to the definition of biological and technical PMVs,
Taylor and Pollard (2009) distinguish between ‘true zeros’ and
‘truncated values’ where the truncation results either from signals
below the LCD or from a ‘lower bound on meaningful signal set by
the researcher’. Examples of such lower bounds are given in
Neuhauser et al. (2005) for microarray data. The same authors also
discuss DNA methylation data where negative results due to only
partially or un-methylated test regions would correspond to BPMVs
in our nomenclature. BPMVs are also comparable to the ‘rancid
part of the sample’ in Hallstrom (2010).

In typical omics experiments, both, biological and technical,
PMVs may occur. A biological phenomenon may lead to highly ex-
pressed compounds in one part of the samples, but to low or absent
signals in another part, where different compounds are activated in-
stead. This could be caused by sporadic posttranslational modifica-
tions which do not directly connect to the investigated experimental
condition. As a result, for many compounds the observed distribution
of intensities will be bimodal, with a lower mode exactly at the point
mass and an upper mode characterizing the location of the continu-
ous, i.e. highly expressed, part of the distribution. TPMVs may have
two reasons: first, in some compounds, the distribution of intensities
may be characterized by a high variance and a low mean but without
bimodality. In these compounds we will find a high proportion of
values below detection limit. Second, it is also plausible that the true
intensity of a compound is just above the detection limit, but is not
correctly detected because of technical reasons such as interference
(e.g. adsorption of the compound or signal suppression) or misinter-
pretation of the signal (e.g. caused by incorrect charge assignment or
error in monoisotopic mass determination). Therefore, statistical test
procedures for comparing omics data between groups have to accom-
modate the information contained not only in the continuous part of
the distribution but also the information present in the biological as

 

 

 

 

 

 

 

 

 

 

 

 

 

 

[L Frat 123T5|J [Control] h Pro-t 1011341- (Control)
Ci _ d _
Iii3! .. 1'5! ..
E G
“'1. - “'1: _
3" :I 3!. a
U- 1.1
 a -  a -
a .. E ..
i :i ' _- 1:: '
E E
W. _ “I _
GI G
i " r‘l I L1 ‘3' ‘ IIII-II
I: _ I:- _ n
a I l T I a r I I I
I} 5 1|} 15 CI 5 1D 15
h Prat 1231'50 (CKD) h Prat 1W3“ [GKIJ]
Ci - d - —
l“3! _ “5! _
CI G
5 E - 5‘ g -
 :- —  3 ~
tl' I3"
E. E - E. E -
E T'E
“I _ “I _
D G
3' IIHI 5" ' r) h1
=! _ H c: _
a I I | I a I I I I
I} 5- ‘IEII 15 D 5 Ill] 15
Iraqi-Infamy logiilnlenslty

Fig. 1. Histograms of two selected peptides from example dataset (shaded
bars represent PMV proportions). Peptide 123750 (left): consonant; Peptide
100 344 (right): dissonant

well as in the TPMVs. Depending on whether the PMVs are con-
sidered as technical or biological the distribution of the continuous
part is more adequately described by a left-censored or by a fully
observed (uncensored) distribution.

According to the observed distributions of compounds in two
groups, Taylor and Pollard (2009) as well as Dakna et al. (2010)
have distinguished between consonant and dissonant compounds.
The former are characterized by exhibiting the higher PMV propor-
tion in the group with the lower mean in the continuous part, while
in the latter case the group with the higher PMV proportion also has
the higher mean. This definition does not distinguish between tech-
nical and biological PMVs. However, the occurrence of TPMVs
naturally corresponds to consonant compounds whereas BPMVs
generally allow for both types. In our dataset we found 2942 (52%)
consonant and 1153 (21%) dissonant peptides (27% have equal
PMV proportions). An example of each type is shown in Figure 1.

There is extensive literature, independent of the context of omics
data, on two-group comparisons for data including values below a
LCD. A thorough overview is given by Zhang et al. (2009), who in-
vestigate the following test statistics (among others): various ad-hoc
approaches to impute PMVs before applying a T—test; Tobit models
for an explicit modeling of left-censored distributions; and log-rank
type tests applied to the ‘ﬂipped’ and thus right-censored data (see
also Helsel, 2012). In all these tests, in some way or another, the
PMVs are seen as being an implicit part of the full distribution in-
stead of as one of two independent components of a mixture distri-
bution. In this sense we will denote these tests as one-part tests and
view them as primarily targeting distributions that contain TPMVs.

Up to now the test statistics explicitly proposed for omics data com-
prise only two-part tests. These contain two independent components
that contribute to a pooled test statistic, one measuring differences in
the PMV proportion and the other one in the continuous subdistribu-
tion. Two-part test statistics are by construction adequate for cases
where PMVs are primarily assumed as biological. Furthermore, the
non-parametric empirical likelihood ratio test (ELRT) proposed by
Taylor and Pollard (2009) is implicitly of a two-part nature. The only
two one-part tests investigated as competitors by these authors are the
t-test and Wilcoxon’s rank—sum test. The same holds for other compari-
son studies such as that of Dakna et al. (2010).

The goal of this paper is to evaluate the various statistical tests
proposed for comparing distributions with zero-inﬂation under
scenarios allowing for both types of PMVs. To our best knowledge
no simulation study has yet been performed that directly compares
two-part and one-part tests for the setting of omics data controlling
for biological as well as technical PMVs simultaneously.

The following section gives an overview of the test statistics con-
sidered for comparison in this paper. The subsequent two sections
present the results of a comprehensive simulation study and of the
application to the above mentioned real peptidomics data. The final
section will discuss strengths and limitations of our study and draw
some conclusions.

2 Methods

We consider experiments where the expressions of K compounds are
compared between two groups. The corresponding logz-transformed
expression values are denoted by Xk, for i: 1,. . ., nx and Yk, for
i = 1,. . . , ny, where nx and ny denote the number of samples in the
two groups, and la 2 1,. . . , K. In the following, we will describe, for
each test, the way to obtain a p-value and a corresponding estimator
of the log fold change (LFC), i.e. of the location shift between the

112 ﬂJO'sleumo[pJOJXO'soueuuoguroIq/ﬁdnq wort pepeolumoq

910K ‘09 lsnﬁnV no :2

2312

A.Gleiss et al.

 

groups. This shift concerns the full distributions in the case of one-
part tests and the continuous subdistributions for two-part tests.
Thus, one-part tests correspond to a null hypothesis on the full-
distribution LFC between the groups, including the PMVs at the
lower end of the distributions. Conversely, two-part tests test a com-
posite null hypothesis on the subdistribution LFC and the difference
in PMV proportions. Thus, estimates of the LFC obtained from the
data can either correspond to the full distributions or to the continu-
ous subdistributions.

In the following we omit the index la in this section for simplicity
and set X,: TC, a value selected to represent PMVs (e.g. TC: 0), for
i: 1,. . ., mx and Yizn for i: 1,. . . , my, assuming mxSmy without
restricting generality.

2.1 One-part tests
Wilcoxon’s rank-sum test (W): The normalized and continuity cor-
rected test statistic is given by
W — HWI — 0-5
0W

W =

where U = nxny + nx(nx + 1) / 2 — Rx With RX =  7(Xila the

sum of group independent ranks in the first group, ow =

 

\/nxny (nx + ny + 1) / 12 and my: nx ny/2. The p-value is obtained

by comparing W with standard normal quantiles. An estimator of
the LFC is calculated as the Hodges—Lehmann estimator of location

shift:
AW 2 median{Y,~ — Xi|i = 1, ...,nx,j = 1, ...,n,,}

Note that this estimate might depend on the choice for TC if the
PMV proportions are large. In applications appropriate pre-filtering
to discard such compounds beforehand will circumvent this prob-
lem. For the simulation studies we use appropriately robust meas-
ures to summarize LFC estimates.

Adapted T—test (T): To make the standard T—test more competi-
tive for point-mass data we impute PMVs separately in each of the
two groups and for each compound in the following way. If the
observed proportion mx/nx of PMVs in the first group is below
30% then we impute the quantile corresponding to (mx/nx)/2 from
a normal distribution N(median{X,~ | i: 1,. . ., nx}, 1.4826
MAD{X,~ | i: 1, . . . , nx}) where MAD denotes the median absolute
deviation from the median (1.4826 being the inverse of the MAD
of a standard normally distributed random variable and thus a ro-
bust estimate of the standard deviation in case of PMVs).
Otherwise a value of log2(LOD/2) is imputed (cf. the ‘Imputed
(LOD/2)’ method in Zhang et al., 2009). If a LCD is not given a
priori then a LCD could be defined as the minimum of all ex-
pressed values in the dataset. The same type of imputation is done
independently for the second group. By denoting the imputed val-
ues as X: for i: 1,. . ., mx and Y1?" for i: 1,. . ., my, respectively,
an estimator of the LFC is given as the mean difference after

imputation:
A 1 my * "y 1 "‘x * "2
AT=,,— 22+ 2 Y.- —,,—(:X.-+ Z X.)
3’ i=1 i=my+1 x i=1 i=mx+1

The T—statistic for independent samples with unequal variances

T 2 AT/ @(AT)

is compared to a T—distribution with Satterthwaite’s approximate
degrees of freedom (d.f.) to obtain a p-value.

Truncated Wilcoxon-test (tW): Hallstrom (2010) defined the trun-
cated Wilcoxon rank—sum test as Wilcoxon’s rank—sum test applied
to the data after removing a maximum common number of PMVs
from the two groups. Since we assumed mx 3 my this leaves X,- for
i=mx+1,..., nx and Y,- for i=mx+1,..., ny. The p-value is com-
puted by the asymptotic Wilcoxon’s rank—sum test (based on normal
approximation) applied to the truncated data. An estimator of the
LFC is calculated as

Atw = median{Y,- — Xi|i = mx + 1, ...,nx,j = mx + 1, ...,ny}.

Moderated T-test (mT): As a standard approach that ignores PMVs
we include the moderated T—test using the limma package in R (Smyth,
2005) with all PMVs set to missing. The estimator of the subdistribu-
tion LFC is equivalent to that of the two-part T—test (see below).

Tobit-model (Tob): Following Zhang et al. (2009) a parametric
model based on a left-censored normal distribution is estimated
using maximum likelihood (e.g. as implemented in the R-function
survreg with option dist = ‘gaussian’). The model is given by

Zi = ﬁO  > nx)ﬁ1 TITS/'77.: 17"'7nx +71)!

where Z,- denotes the elements of the stacked vector
(X1, ...,an, Y1, ..., Yny) and I(.) is the indicator function. 8,- follows
the left-censored normal distribution max
{N(0, 02), 2 — [$0 — I(j > nx)ﬁl} where 2 denotes the log-
transformed LCD. The p-value results from a likelihood ratio test
of [$1 = 0. The model returns a direct estimate ATOI, = [$1 of the LFC,
i.e. of the difference of the means corresponding to the underlying
but left-censored normal distributions of the two samples.

2.2 Two-part tests
Following Taylor and Pollard (2009) two-part statistics are defined as
the sum of two independent test statistics as first proposed by
Lachenbruch (1976). The two parts correspond to the mx + my PMVs
on the one hand and to the continuous parts X,- for i = mx + 1,. . . , nx
and Y,- for i: my + 1,... , ny on the other hand. The first test statistic is
the continuity-corrected version of Pearson’s Chi-square test statistic to
compare the PMV proportions between the two groups. The second
statistic for comparing the continuous parts either results from a T—test
or from Wilcoxon’s rank—sum test. In the first case the T—statistic for in-
dependent samples with unequal variances and in the second case a nor-
malized and continuity-corrected version of Wilcoxon’s U—statistic is
employed (see Taylor and Pollard, 2009). Both, the test statistic for the
binomial part and the square of the test statistic for the continuous part,
asymptotically follow a chi-square distribution with 1 d.f. If both com-
ponents of the two-part test statistic are well defined (i.e. the PMV pro-
portion is not 0 and not 1 in both samples), then an asymptotic p-value
can be derived from a chi-square distribution with 2 d.f. Otherwise, the
undefined component is set to zero, and the resulting two-part statistic
is assumed to follow a chi-square distribution with 1 d.f.

For the Two-part T—test (2T) and the Two-part Wilcoxon-test
(2W) estimators of the subdistribution LFC are calculated as the dif-
ference of means and the Hodges—Lehmann estimator, respectively:

ﬂy "at
An = Z Yz- — Z X,-
i=my+1 i=mx+1
AZW = median{Y,- — Xi|i = mx + 1, ...,nx,j = 1113, + 1, ...,ny}

For the ELRT the test statistic is derived from a likelihood ratio
statistic by plugging in the empirical subdistributions of the two
groups (see Taylor and Pollard, 2009). Following Lachenbruch

112 /810'S{12umo[pJOJXO'soI112u1101quIq//2d11q 111011 pepeolumoq

910K ‘09 lsnﬁnV no 22

Two-group comparisons of zero-inflated intensity values

2313

 

(1976) the likelihoods are constructed such that the binomial parts
are explicitly taken into account. In this way the ELRT operates in
the manner of a two-part test. No estimate of the subdistribution
LFC is directly available for the ELRT due to its non-parametric
character with respect to the continuous part. As for the two-part
Wilcoxon test the Hodges—Lehmann estimator might be used.

2.3 Left-inflated mixture likelihood ratio test
Finally, we combine the Tobit and the two-part approach by con-
structing a likelihood that allows for BPMVs and, additionally,
models the continuous part with a left-censored distribution. Such a
model class is presented by Yang and Simpson (2010) as left-inflated
mixture (LIM) models originally proposed in an econometric con-
text. The same model was termed ‘Bernoulli/Lognormal mixture
model’ by Moulton and Halsey (1995).

For the first group with observed values X,- for i = 1,. . . , nx the
density for the ith observation is given as

{p36 + (1 _ px)q)(llauxa 0x)
(1 — Px)<p(Xilux, 0x)

for X,- a PMV

fL1M(Xi|Mx,0x,Px;/l) = .
otherw1$e

where px denotes the proportion of BPMVs, ux and ax denote the
mean and standard deviation of a (underlying but left-censored) nor-
mal subdistribution. (I)() and (p () denote the cumulative distribution
and the density function, respectively, of the normal distribution. An
analogous definition is assumed for the second group. Based on these
densities we propose a LIM-likelihood ratio test (LIM-LRT) with
ux = u), and px = py (but allowing ax aé 0),) under the null hypothesis.
This test is a special case of the one proposed by Moulton and Halsey
(1995). The detection limit 2 is the same for both groups under the
null as well as under the alternative hypothesis and is set to min
(X1, ..., an, Y1, ..., Yny) — a for a small 6. The log-transformed likeli-
hood ratio is optimized numerically using the optim() function in R

with option method 2 ‘L-BFGS-B’ which offers constrained optimiza-

0

tion based on a quasi-Newton method. The starting values 112, M3, ax

and 03 (group-wise under the alternative and ignoring groups
under the null hypothesis) can either be set by a Tobit model opti-
mization or in a two-part manner by selecting median and 1.4826
MAD of the non-PMV observations. The starting values for px and
py are then set to their respective maximum likelihood estimates
132 = 1 — (nx — mx)/[nx(1 — (I)(/i|ug, 02») and 13:) analogously. We
propose to start with the Tobit based pre-estimates and, in case of
non-convergence, have a second try with the two-part pre-estimates.
The LIM-LRT also delivers direct estimates for ux, ,uy, ox, 0y, px and
py resulting in the subdistribution LFC estimate ALIM 2 ﬂy — fix. The
proportion of TPMVs is estimated by (1 — 13x)<1)(/i|fix, 6x) and analo-
gously for the second group.

Some of the test statistics mentioned in previous investigations
are not considered in the present study. While the Kolmogorov-
Smirnov test has been reported as being anticonservative
(Lachenbruch, 2001), Zhang et al. (2009) showed that Gehan’s
test, the Log-rank and the Peto-Peto test are equivalent to
Wilcoxon’s rank—sum test in the case of identical LODs in the two
groups and no ties in the continuous part. Further proposals of test
statistics that employ other than log-normal distributions (log-
gamma, log-skew-normal) have been treated in Taylor and Pollard
(2009)

In all numerical calculations below we calculate two-sided tests
using R 2.13.0 (R Development Core Team, 2011, R: A language
and environment for statistical computing. R Foundation for
Statistical Computing, Vienna, Austria. ISBN 3-900051-07-0, URL
http://www.R-project.org/).

3 Results

3.1 Simulations

In the following, we conduct a simulation study to evaluate the stat-
istical methods presented above. Two concepts of generating PMVs
are considered: (i) First, a left-censored distribution is considered, re-
sulting from a continuous distribution (e.g. log-normal) of which all
values below a given LOD are set to zero (or another appropriate
PMV outside the range of the continuous part), see, e.g. Zhang et al.
(2009). (ii) In contrast, one could generate the two parts as two in-
dependent components of a mixture distribution. A binomial ran-
dom variable decides whether a signal is not present at all and thus
set at the PMV, or this signal’s value is independently drawn from
some (fully observed) continuous distribution such as the log-normal
or gamma (Taylor and Pollard, 2009). An interpretation of the com-
pound null hypothesis for practical use is often difficult. However,
simulations can be controlled more directly.

A priori, both concepts do not distinguish between biological
and technical PMVs beforehand. However, concept (i) is obviously
more naturally linked to TPMVs and concept (ii) to biological ones.
Furthermore note that, by construction, the philosophy of using the
one-part tests corresponds to concept (i), while the two-part tests
naturally correspond to concept (ii). Finally, under concept (ii) con-
sonant and dissonant group differences are equally plausible while
under concept (i) dissonant differences are assumed to occur either
by chance or as a consequence of a higher variance in the group
with the higher location parameter.

In designing a simulation study, the choice of one of the two con-
cepts for data generation will affect its results and conclusions. To
our knowledge, the simulation studies presented in papers on newly
proposed methods for the two-group problem in omics data are ex-
clusively based on that concept which corresponds to the construc-
tion of the respective new test statistic. Neuhauser et al. (2005)
compared the two-part Wilcoxon test in two separate types of simu-
lation scenarios, one corresponding to biological, the other to tech-
nical zeros but did not offer scenarios including both types at the
same time. In practice it is hard to decide which of the two concepts
best describes the distributions in a real dataset at hand. In the fol-
lowing we will therefore present a more general simulation setup
which allows generating both PMV types simultaneously and covers
both concepts as special cases.

We directly simulate on the binary logarithmic (logz) scale.
Thus, results for the log-normal distribution are based on simulated
normal distributions. The standard deviations of the underlying nor-
mally distributed variables are set to 1 in both groups and for all
compounds, making moot the use of moderated test statistics in the
simulation (cf. Tusher et al., 2001; Smyth, 2005).

In each simulation run we simulate expression values of K com-
pounds from nx + ny samples. For ease of notation K is assumed to
be an even number. The simulation parameters comprise 2, the logz-
transformed LOD 2 0, the proportions px and py of BPMVs in the
two groups and the subdistribution LFC 6.

For the first group (e.g. the control group) pairs (in, C2,.) are
generated where inzmax(Uk,-, 2), C21. =1 (Uh-<2 v C)“: 1) with
Cki~Bernoulli(px) and Uki~N(0, 1) if Ck,=0 for la: 1,..., K/2,
i= 1,. . ., nx and with Claw Bernoulli((px+py)/2) and Uki~N(0, 1)
ika,=0fork=K/2+1,...,K,i=1,...,nx.

For the second group (e.g. the diseased group) we generate pairs
(Yki, D21.) where Ykizmax(Vk,-, 2), D21. :1 (Wu-<2 v Dkiz 1) with
Dki~Bernoulli(py), Vki~N(6, 1) if Dkiz 0 for la 2 1,. . . , K/2,
i: 1,. . ., ny, and with DkirvBernoulli((px+py)/2), Vk,~N(0, 1) if
Dk,=0fork=K/2+1,...,K,i=1,...,ny.

112 ﬁhO'sleumo[pJOJXO'soI112u1101quIq//2d11q 111011 pepeolumoq

910K ‘09 lsnﬁnV no 22

2314

A.Gleiss et al.

 

All pairs with C2,. = 1 or D2,. = 1, respectively, are referred to as
PMVs (the corresponding Xk, and Yki, respectively, are not in-
terpreted then). To obtain the most stable estimates of true and
false-positive rates half of the compounds exhibit a difference in the
proportion of biological zeros and a subdistribution LFC by a value
of 5 while the remaining half is drawn from equal distributions in
both groups.

Note that this general model reduces to concept (i) if px = py = 0
(excluding BPMVs) and to concept (ii) if 2: —oo (excluding
TPMVs). All other cases allow for a mixture of concepts (i) and (ii)
with biological as well as technical PMVs.

The simulation setup for nx=ny=25, is defined by factorial
combinations of shift 5 = 0, 1, 2, proportions px, p3,: 0.0, 0.2, 0.5
and 2: —00, —0.5, 0.0. For nx=ny= 10 only 5: 1 was evaluated.
Note that the 5 and 2 both refer to the logz-scale. The three chosen
values for 2 correspond to 0%, 31% and 50%, respectively, of
TPMVs if the mean log expression is 0 and to 0%, 7% and 16%, re-
spectively, of TPMVs if the mean log expression is 1. We simulate
K = 500 independent compounds of which 250 are differentially ex-
pressed so that true and false-positive rates (FPR, TPR) can be esti-
mated. There are 500 simulation runs for each scenario. The test
statistics are employed as presented in the previous section including
the choice of starting values for the LIM-LRT.

For the sake of a compact presentation of results we select eight
representative scenarios (Table 1). There are three scenarios without
TPMVs (B1 to B3 with decreasing proportion of consonant com-
pounds), one scenario (P) without any mean shift between the
groups, one scenario without BPMVs (T) and three mixed scenarios
(M1 to M3 again with decreasing proportion of consonant com-
pounds). Note that, compared to the B scenarios, there are fewer
BPMVs in the M scenarios. However, the finite 2 produces TPMVs
in both groups, thus resulting in a lower proportion of dissonant
compounds. Scenario T is the prototypic constellation for the Tobit
model.

The results for the eight selected scenarios are presented in
Figure 2 and Supplementary Figures 51A and 51B depicting TPRs
for a FPR of 0.005, as well as the median and the inter-quartile
range of the bias in the estimate of the (subdistribution) LFC. The
detailed results for all scenarios are summarized in Supplementary
Table S1.

Figure 2 demonstrates the strong dependence of TPR on the
underlying data-generating model. In general, power is highest with
concordant proportions of BPMVs and TPMVs (scenario M1), and
lowest when there are differences only in BPMVs (P) or with dis-
cordant TPMVs and BPMVs (M3). The investigated tests cluster
into two distinct shapes of TPR profiles, one typical for two-part
tests, and one for one-part tests. The moderated T—test ignoring
PMVs does not fit either type. Naturally, it outperforms all other
tests if the proportion of PMVs is equal between groups (B2 and

Table 1. Overview of eight representative scenarios (nxz ny= 25)

 

 

Scenario 5 px py 2 % Cons. % Equal prop. % Diss.
B1 1 0.5 0.2 —00 98.0 0.9 1.1
B2 1 0.2 0.2 —oo 43.1 14.1 42.8
B3 1 0.2 0.5 —00 1.1 0.9 98.0
P 0 0.2 0.5 —00 49.7 0.9 49.4
T 1 0.0 0.0 —0.5 97.8 1.0 1.1
M1 1 0.2 0.0 —0.5 99.0 0.1 0.9
M2 1 0.2 0.2 —0.5 89.4 4.2 6.4
M3 1 0.0 0.2 —0.5 60.6 11.4 28.1

 

M3), but yields severely lower TPRs in all other scenarios.
Generally, the two-part tests, including the ELRT, are more robust
to dissonant constellations (B2, B3; cf. also Lachenbruch, 2001), but
this advantage is lost with the occurrence of TPMVs (M2, M3).
Still, two-part tests have adequate TPRs in most scenarios and gen-
erally give the most stable estimates of the subdistribution LFC. By
construction, the bias of their estimate depends on the amount of
TPMVs and thus on 2 and 5. For the two-part T—test the average
amount of bias is (p(ocy)/(1 — <1>(oc,,)) — (p(ocx)/(1 — @(ax)) where
(xx = (2 — ux)/ox with ux and ax as the parameters of the (left-
censored) normal subdistribution and analogously for cry. In scen-
arios T and M1 to M3 we have 2=—0.5, ux=0, M2521 and
ox = 0), = 1 such that the average bias is —0.37.

In the absence of TPMVs the estimates of the subdistribution
LFC associated with the two-part tests are unbiased. If linked with a
Hodges—Lehmann estimator the same holds for the ELRT. The trun-
cated version of Wilcoxon’s rank—sum test shows little improvement
over the original version, and only for dissonant cases. For the one-
part tests excluding the moderated T—test the bias in the estimate of
the subdistribution LFC is minimal and least variable for equal pro-
portions of BPMVs (senarios B2, T and M2), since the correspond-
ing subdistribution LFC estimates are essentially full-distribution
estimates but negative effects level out if BPMVs are equally likely in
both groups.

Similar results are observed at other FPRs, as demonstrated for
scenario B2 in Supplementary Figure 52 where the TPRs run more
or less in parallel when the FPR varies. Supplementary Table S1
shows that the conclusions drawn above also hold for 5 = 2 and for
(nx, ny) = (10, 10).

For the LIM-LRT we finally compare estimated proportions of
biological and technical PMVs for the differentially expressed peptides
with each scenario’s simulation parameters (see Supplementary
Fig. S3). For the second (shifted) group the median bias is below 5 %
points in all scenarios. For the first (control) group the median bias in
the P and B scenarios is only slightly larger. However, in the T and M
scenarios the proportions of TPMVs in this group are considerably
underestimated and, correspondingly, the proportions of BPMVs are
overestimated. Thus in the control group, scenarios involving TPMVs
appear ‘more biological’ than they are due to a lower location param-
eter which induces more values below the LOD.

 

 

 

 

ﬁr.

'- --- W — 2w
- T — 2T
-- Mr -I- ELRT
- - mT — LIM

g. + Tab

 

TPR at FPR: 13.1105
[1.5

1.1.4

[3.2

   

 

 

{LEI

 

3'1 5'2 5'3 P f hi1 III: HIE
Scenario
Fig. 2. True-positive rates (TPR) at false positive rate (FPR)=0.005 for the
scenarios described in Table 1. B1 to BB: only BPMVs (consonant to disson-
ant), P: only BPMVs and 5:0, T: only TPMVs, M1 to M3: mixed (consonant to

dissonant)

112 ﬁhO'sleumo[pJOJXO'soI112u1101quIq//2d11q 111011 pepeolumoq

910K ‘09 lsnﬁnV no 22

Two-group comparisons of zero-inflated intensity values

2315

 

To sum up, if there is no prior knowledge about the presence or
absence of technical and biological PMVs then the two-part
Wilcoxon test and the ELRT seem to be good compromises. The ad-
vantage over the two-part T—test and the LIM-LRT is their inde-
pendence from distributional assumptions for the continuous
subdistribution. The two-part Wilcoxon test and the ELRT are the
most robust tests in dissonant situations and show good perform-
ance also in the other scenarios. The bias of the Hodges—Lehmann
estimates of the subdistribution LFC is generally low. The LIM-LRT
generally has low bias in all scenarios and has higher TPRs in tech-
nical and consonant mixed scenarios than the two-part Wilcoxon
test. If the assumption of a (left-censored) log-normal subdistribu-
tion is reasonable and some technical PMVs cannot be excluded
then the LIM-LRT might be preferred.

3.2 Application

In this section the previously introduced and evaluated statistical
tests are applied to the motivating dataset presented in the introduc-
tion. For this purpose we first restrict the dataset to peptides with a
PMV proportion below 70% ignoring group labels. The restricted
dataset contains 787 peptides with a median PMV proportion at
52% (quartiles 32% to 62%) including 408 (51.8%) consonant and
322 (40.9%) dissonant peptides and 57 (7.3%) with equal PMV
proportions. Table 2 shows the pair-wise correlations between the
(uncorrected) p-values of the discussed tests. Spearman correlation
coefficients of at least 0.80 are observed within the group of one-
part tests with a few exceptions as well as within the group of all
two-part tests and the LIM-LRT.

The following method for controlling the False Discovery Rate
(FDR) is used to adjust for multiple testing among the 1093 pep-
tides: for various thresholds or we estimated false discovery rates
(Benjamini and Hochberg, 1995) using

ﬁpocxmo
Pp (a)

where 1517(0) and Fp0(o) are the empirical cumulative distribution

FEM) =

functions of all p-values across all peptides in the restricted original
dataset and across all peptides and all permutations, respectively,
and no is the estimated proportion of genes for which the null hy-
pothesis applies. This procedure resembles the one outlined in Kerr
(2009) except of using Fp0(oc)Ainstead of 0c in the numerator. Finally,
30 was estimated by (F, (131:0 (0.75)) — F, (131:0 (0.25))] /0.5.
q-values based on these estimates of the FDR are given.

Table 3 presents the numbers of compounds declared significant
based on a FDR of 0.05. As expected from our simulations the two-

Table 2. Upper triangle: pair-wise Spearman correlation coeffi-
cients between p—values (bold: 20.80); lower triangle (italic type):
kappa coefficients with respect to significance defined as
FDR g 0.05 (bold: 20.70)

 

part tests and the LIM-LRT show a higher proportion of dissonant
peptides among those declared significant than the other tests. As
seen from the kappa coefficients in Table 2 there is a lower overlap
of significant compounds between the LIM-LRT and the group of
two-part tests than within the two-part tests.

To assess whether technical or biological PMVs play a larger
role in the set of 787 peptides we use the PMV proportion estimates
from the LIM models. The median number of technical and biolo-
gical PMVs is 0.1 (quartiles <0.1, 0.5) and 12.9 (quartiles 8.6,
16.6), respectively, in the CKD group and 0.3 (quartiles <0.1, 1.0)
and 9.4 (quartiles 4.1, 13.4), respectively, in the control group.
Across all 787 peptides, the median of the proportion of biological
among all PMVs within a given peptide is 98.9% (quartiles 95.6%,
99.9%) in the CKD and 95.7% (quartiles 84.9%, 98.9%) in the
control group. However, we have learned from Supplementary
Figure S3 that the proportion of BPMVs might be overestimated in
the respective group with the lower location parameter.

In addition to the prevailing, but not exclusive biological nature
of the PMVs in this dataset the continuous parts largely exhibit an
approximate (left-censored) log-normal distribution (graphical in-
spection, results not shown). Thus, the LIM-LRT and the two-part
tests (including the ELRT) seem most appropriate for analysis.

The detailed results for the two example peptides presented in
Figure 1 are shown in Table 4. There are striking discrepancies
between the two-part tests and the LIM-LRT on the one hand and
the one-part tests on the other. For the consonant peptide the Tobit

Table 3. Results of all tests for example dataset (significance
defined as: q—value g 0.05)

 

Test No. significant compounds Total rel. to 2 X 100

 

Cons. Equal Diss. Total Sens.(%) Spec.(%)

 

One-part W 1 78 4 3 8 220 40 8 7
tests T 209 4 88 301 51 83
tW 1 85 2 26 213 39 88
mT 61 6 17 84 25 88
Tob 148 0 55 203 38 88
Two-part 2W 158 10 78 246 35 85
tests 2T 145 9 67 221 31 84
ELRT 152 4 83 239 34 84
LIM 126 3 62 191 29 85

Total 408 57 322

 

Sensitivity (Speciﬁcity): percent of peptides declared signiﬁcant (non-signiﬁ-
cant) in 2 x 100 samples that are also signiﬁcant (non-signiﬁcant) in the pre-
sented 2 x 25 samples (see text)

Table 4. p—values, q—values and (subdistribution) log fold change
(LFC) for example peptides (see introduction section)

 

Test Peptide 123 750 (cons) Peptide 100 344 (diss.)

 

 

 

w T tW mT Tob 2w 2T ELRT LIM p q LFC p q LFC
w 0.88 0.92 0.22 0.88 0.75 0.70 0.73 0.65 One-part w 0.012 0.030 2.21 0.281 0.262 0.00
T 0.72 0.77 0.14 0.88 0.68 0.64 0.69 0.63 tests T 0.029 0.040 3.06 0.204 0.167 —1.62
tW 0.79 0.57 0.36 0.74 0.78 0.75 0.75 0.65 tW <0.001 0.004 3.75 0.419 0.433 —0.87
mT 0.20 0.09 0.32 0.06 0.59 0.67 0.60 0.49 mT <0.001 0.006 2.39 0.081 0.214 1.15
Tob 0.77 0.72 0.61 0.03 0.65 0.62 0.70 0.62 Tob 0.049 0.090 4.89 0.139 0.180 —3.83
2w 0.67 0.52 0.69 0.38 0.58 0.96 0.94 0.81 Two-part 2w 0.003 0.006 2.66 0.100 0.096 1.28
2T 0.59 0.44 0.65 0.48 0.50 0.83 0.97 0.82 tests 2T <0.001 0.005 2.39 0.046 0.073 1.15
ELRT 0.60 0.49 0.64 0.38 0.56 0.84 0.86 0.86 ELRT <0.001 0.012 2.66 0.028 0.063 1.28

LIM 0.57 0.44 0.57 0.37 0.53 0.71 0.74 0.76

LIM <0.001 0.009 2.90 0.007 0.029 2.30

 

 

112 ﬁhO'smumo[p101x0'801112u1101u101qﬂ2d11q 111011 pepeolumoq

910K ‘09 lsnﬁnV no 22

2316

A.Gleiss et al.

 

Table 5. Differences of (subdistribution) LFC estimates (row minus
column). Upper triangle: medians; lower triangle (italic): interquar-
tile ranges

 

W T tW mT Tob 2W 2T ELRT LIM

 

W —1.0 0.0 —0.5 0.9 —0.5 —0.5 —0.5 —0.6
T 3.8 1.3 0.7 2.6 0.7 0.7 0.7 0.7
Tw 2.0 7.1 —0.5 0.7 —0.5 —0.5 —0.5 —0.6
mT 1.4 4.1 2.2 2.0 0.0 0.0 0.0 0.0
Tob 4.4 8.9 2.2 4.7 —2.0 —2.0 —2.0 —2.0
2W 1.3 4.1 2.1 0.2 4.7 0.0 0.0 —0.1
2T 1.4 4.0 2.2 0.0 4.6 0.2 0.0 0.0
ELRT 1.3 4.1 2.1 0.2 4.7 0.0 0.2 —0.1

LIM 1.7 4.5 2.2 0.2 4.6 0.4 0.2 0.4

 

model shows the only q-value above 0.05. Except for the one-part
Wilcoxon test the one-part tests give higher estimates of the (subdis-
tribution) LFC than the two-part tests. For the dissonant peptide the
results are highly inconsistent, most of the estimates associated with
one-part tests even give opposite signs due to the high PMV propor-
tion in the CKD group. For the dissonant case we clearly see that the
two-part tests are aiming for measuring different features of the data
than the remaining tests do.

The LIM-LRT tries to differentiate between biological and tech-
nical PMVs. In the CKD group the 10 PMVs for peptide 123 750
and the 17 PMVs for peptide 100 344 are all estimated biological.
However, in the control group the 15 PMVs for peptide 123 750 are
divided into 13 biological and 2 technical PMVs and the 11 PMVs
for peptide 100344 into 5 biological and 6 technical ones. This
results in lower location parameter estimates in the control group
and explains the higher estimate of the subdistribution LFC for both
peptides compared to the two-part tests. Table 5 shows that the
agreement between (subdistribution) LFC estimates is generally high
among the two-part tests whereas there are large discrepancies with
and among one-part tests (by construction the estimates of mT and
2T and those of 2W and ELRT are identical). The results for the top
25 peptides selected by the LIM-LRT are summarized in
Supplementary Figure S4. It can be seen that the proportion of
TPMVs among the selected peptides is disproportionately high, 21
of the top 25 peptides exhibit TPMVs in at least one group.
Furthermore, 10 of these peptides are dissonant.

Finally, we re-examined the same set of peptides with the same
methods in larger groups of 100 CKD cases and 100 controls which
contains the 2 X 25 samples investigated so far as a subsample. As
seen in the last two columns of Table 3 the internal consistency in
terms of sensitivity relative to the larger groups is generally higher
for one-part tests and is smallest for the LIM-LRT. This pattern is
quite similar in three other randomly selected 2 X 25 samples (results
not shown). Specificity is generally around 85%.

4 Discussion

This paper tries to fill the gap between proposals for handling PMVs
in the context of omics data and those for general or other specific
types of data showing a zero-inﬂation phenomenon. We applied sev-
eral test statistics in an extensive simulation study and to a real data-
set. We observed large differences between the results from one-part
and two-part tests. This is a direct consequence of their respective
construction.

In the simulation study we generated data simultaneously ex-
hibiting biological and technical PMVs since it is plausible that a

(known or unknown) underlying mechanism controls the binomial
part independently from the continuous part and from the mechan-
ism producing the TPMVs. In contrast, the ‘dependency model’ by
Hallstrom (2010) tends to produce only consonant distributions
despite two independent sources of PMVs.

It is clear from our investigations that the two considered types
of PMVs have different implications for the operation characteristics
of the considered tests. All tests of the one-part or the two-part types
explicitly serve only one type of PMV but may be more or less
robust to the other. Our results show that one-part tests give accept-
able results for equal proportions of BPMVs. Generally, two-part
tests show higher TPRs and the corresponding estimates have low
bias depending on the proportion of TPMVs. For a particu-
lar data analysis it may often be difficult to judge whether the
observed PMVs are technical or biological. The LIM-LRT offers a
way to circumvent a decision between one-part and two-part tests
by allowing for and explicitly estimating the proportion of both
types of PMVs.

The interpretation of the measures of location corresponding to
one-part and two-part tests is quite different. For one-part tests loca-
tion measures, and differences between groups calculated from
them, are based on the full distribution of values, including the
unobserved signals, which are generally assumed as being left-
censored. By contrast, two-part tests supply two separate estimates
of group difference, one for the PMV proportion and one corres-
ponding to the difference between the group-specific subdistribu-
tions of continuous values. In estimating these group differences,
none of the two-part tests distinguishes between technical and biolo-
gical PMVs unlike the LIM-LRT. By making a distributional as-
sumption on the continuous subdistribution, the LIM-LRT can
provide such a distinction, which can be useful in situations where
both technical and biological PMVs occur. The group difference in
the PMV proportions estimated by the LIM-LRT only incorporates
those PMVs that have been classified as biological.

We showed that the distinction between consonant and disson-
ant compounds has a large impact on test performance. It is, how-
ever, unclear if investigators are at all interested in detecting
dissonant compounds by rejecting a compound two-part null hy-
pothesis. As described in the introduction dissonant compounds of
scientific interest could arise if several compounds are alternatively
activated by the same biological phenomenon. This aspect, however,
is more appropriately covered by testing whole sets of compounds
instead of a single compound at a time. Further investigations are
needed to see whether the likelihood ratio nature of the LIM-LRT
allows for a useful extension along those lines.

This study did not consider other continuous distributions than
the normal distribution (on the logz scale). Extensions in this
direction have been investigated by Taylor and Pollard (2009) for
two-part tests and by Zhang et al. (2009) for the Tobit model. These
authors observed that parametric test statistics were fairly robust to
other distributions. We also did not consider different variability in
the two groups and across compounds and set all variances in the
simulations equal to one. Neither did we vary the LOD across com-
pounds or samples. In analogy to tW we also investigated a trun-
cated version of the T—test (see Supplement) with a performance
close to that of tW (results not shown).

In conclusion, the two-part Wilcoxon test and the ELRT show
good overall properties without any distributional assumptions for
the continuous part. They are recommendable if technical PMVs
can be ruled out beforehand. If the assumption of a (left-censored)
log-normal subdistribution is reasonable and technical PMVs are
possible then the LIM-LRT is an interesting alternative.

112 ﬁhO'smumo[p101x0'801112u1101u101qﬂ2d11q 111011 pepeolumoq

910K ‘09 lsnﬁnV no 22

Two-group comparisons of zero-inflated intensity values

2317

 

Funding

This work was partly supported by the EU’s Seventh Framework Programme
for Research (FP7), grant HEALTH-F2-2009-241544.

Conﬂict of Interest: none declared.

References

Benjamini,Y. and Hochberg,Y. ( 1995 ) Controlling the false discovery rate: a
practical and powerful approach to multiple testing. ]. R. Stat. Soc. Ser. B,
57, 289—300.

Coon,].]. et al. (2008) CE-MS analysis of the human urinary proteome for bio-
marker discovery and disease diagnostics. Proteom. Clin. Appl, 2, 964—973.
Dakna,M. et al. (2010): Addressing the challenge of deﬁning valid proteomic

biomarkers and classiﬁers. BMC Bioinformatics, 11, 5 94—609.

Hallstrom,A.P. (2010) A modiﬁed Wilcoxon test for non-negative distribu-
tions with a clump of zeros. Stat. Med., 29, 391—400.

Helsel,D.R. (2012) Statistics for Censored Environmental Data Using
Minitab® and R. 2nd edn. Wiley, Hoboken.

Kerr,K.F. (2009) Comments on the analysis of unbalanced microarray data.
Bioinformatics, 25, 2035—2041.

Lachenbruch,P.A. (1976 ) Analysis of data with clumping at zero. Biometr. Z.,
18, 35 1—35 6.

Lachenbruch,P.A. (2001) Comparison of two-part models with competitors.
Stat. Med., 20, 1215—1234.

Moulton,L.U. and Halsey,N.A. (1995 ) A mixture model with detection limits
for regression analyses of antibody response to vaccine. Biometrics, 51,
1570—15 78.

Neuhauser,M. et al. (2005) Two-part permutation tests for DNA methylation
and microarray data. BMC Bioinformatics, 6, 35—41.

Siwy,]. et al. (2011) Human urinary peptide database for multiple disease bio-
marker discovery. Proteom. Clin. Appl, 5, 367—374.

Smyth,G.K. (2005 ) Limma: linear models for microarray data. In:
Gentleman,R. et al. (eds.) Bioinformatics and Computational Biology
Solutions using R and Bioconductor. Springer, New York, pp. 397—420.

Taylor,S. and Pollard,K. (2009) Hypothesis tests for point-mass mixture data
with application to’omics data with many zero values. Stat. Appl. Genet.
Mo. B., 8, 1—43.

Tusher,V. et al. (2001) Signiﬁcance analysis of microarrays applied to tran-
scriptional responses to ionizing radiation. Proc. Natl. Acad. Sci. USA, 98,
5116—121.

Yang,Y. and Simpson,D.G. (2010) Conditional decomposition diagnostics for
regression analysis of zero-inﬂated and left-censored data. Stat.Metbods
Med. Res., 21, 393—408.

Zhang, D. et al. (2009) Nonparametric methods for measurements below de-
tection limit. Stat. Med., 28, 700—715.

112 /810'8112umo[p101x0'801112u1101u101qﬂ2d11q 111011 pepeolumoq

910K ‘09 lsnﬁnV no 22

