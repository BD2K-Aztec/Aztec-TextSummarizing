ORIGINAL PAPER

Vol. 28 no. 3 2012, pages 381-387
doi: 10. 1093/bioinformatics/btr6 74

 

Systems biology

Advance Access publication December 21, 2011

Minimal cut sets in a metabolic network are elementary modes in

a dual network

Kathrin Ballerstein H, Axel von Kamp 24, Steffen Klamt2’*’i and Utz-Uwe Haus‘f’i

1Institute for Operations Research, Department of Mathematics, ETH Z rich, R mistrasse 101, 8092 Z rich,
Switzerland and 2Max Planck Institute for Dynamics of Complex Technical Systems, Sandtorstrasse 1, 39106

Magdeburg, Germany
Associate Editor: Mario Albrecht

 

ABSTRACT

Motivation: Elementary modes (EMs) and minimal cut sets (MCSs)
provide important techniques for metabolic network modeling.
Whereas EMs describe minimal subnetworks that can function in
steady state, MCSs are sets of reactions whose removal will disable
certain network functions. Effective algorithms were developed for
EM computation while calculation of MCSs is typically addressed by
indirect methods requiring the computation of EMs as initial step.
Results: In this contribution, we provide a method that determines
MCSs directly without calculating the EMs. We introduce a duality
framework for metabolic networks where the enumeration of MCSs
in the original network is reduced to identifying the EMs in a
dual network. As a further extension, we propose a generalization
of MCSs in metabolic networks by allowing the combination
of inhomogeneous constraints on reaction rates. This framework
provides a promising tool to open the concept of EMs and MCSs
to a wider class of applications.

Contact: utz-uwe.haus@math.ethz.ch;
klamt@mpi-magdeburg.mpg.de

Supplementary information: Supplementary data are available at
Bioinformatics online.

Received on July 20, 2011; revised on November 22, 2011; accepted
on November 30, 2011

1 INTRODUCTION

Modeling and analysis of complex metabolic networks is a central
area of research in systems biology. Stoichiometric or constraint—
based modeling relying on the assumption of steady state in the
metabolites has become a key methodology to analyze functional
properties of large— or even genome—scale metabolic networks (Price
et al., 2004). One of these approaches is ﬂux balance analysis
(FBA), which uses Linear Programming in conjunction with a linear
objective function to compute particular stationary ﬂux vectors,
corresponding e. g. to optimal growth (Edwards et al., 2002). Another
approach for metabolic network and pathway analysis is based
on Elementary Modes (EMs), which are steady—state ﬂux vectors
involving a minimal set of reactions (Schuster et al., 2000). EMs
analysis allows identiﬁcation of balanced metabolic pathways and
cycles and to study a multitude of functional network properties

 

*To whom correspondence should be addressed.

TThe authors wish it to be known that, in their opinion, the ﬁrst two authors
should be regarded as joint First Authors.

iCo—Senior Authors.

[for a review see Trinh et al. (2009)]. One important application
of EMs is the computation of intervention strategies, e. g. for
metabolic engineering (Trinh et al., 2008). A particular approach
for rational (re)design of metabolic networks built upon EMs is
the computation of Minimal Cat Sets (MCSs). In the original
work (Klamt and Gilles, 2004), MCSs were introduced as minimal
sets of reactions whose deletion will block the operation of a given
objective or target reaction; i.e. removal of an MCS implies a zero
ﬂux for the target reaction in steady state. Generalizations of this
deﬁnition were presented afterwards, e.g. for blocking the operation
of arbitrary sets of EMs (Klamt, 2006) or/and for accounting for side
constraints (H'adicke and Klamt, 2011). The problem of computing
EMs results in the computation of extreme rays of convex polyhedral
cones and is well studied in systems biology. Although a full
enumeration is still not possible for most genome—scale models,
considerable algorithmic improvements could be achieved over the
last years (Gagneur and Klamt, 2004; Terzer and Stelling, 2008;
Urbanczik and Wagner, 2005), and the computation of tens of
millions of EMs is now, in principle, possible.

Regarding the enumeration of MCSs, three different approaches
have been proposed so far (Fig. 1; upper half). The ﬁrst
is based on an a priori calculation of EMs with subsequent
calculation of the minimal hitting sets of the (target) EMs.
This approach is also known as computing a hypergraph’s
transversals: the support patterns of the target EMs give rise
to an undirected hypergraph and the minimal hitting sets
(which are then the MCSs) correspond to those transversals
whose entire set spans another hypergraph, the transversal
hypergraph. The algorithm introduced in Klamt and Gilles (2004)
represents one variant for computing all transversals of the
hypergraph of a given set of EMs. However, this algorithm
requires the enumeration of many partial solutions, which leads
to an extensive running time and memory usage. As shown
in Haus et al. (2008), the computation of MCSs as minimal
hitting sets from a set of EMs can signiﬁcantly be accelerated
by using Berge’s Algorithm (Berge, 1989), which is a fast
method to compute hypergraph transversals. Haus et al. (2008)
presented also a completely different approach to compute MCSs,
which is based on the Joint—Generation Algorithm (Fredman
and Khachiyan, 1996) and generates both the EMs and the
MCSs simultaneously. However, both techniques—hypergraph
transversal (minimal hitting sets) as well as Joint—Generation
Algorithm—either need the EMs of the metabolic network or
generate them as a byproduct although they might not be of
interest.

 

© The Author 2011. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oup.com 381

112 /§.IO'SIBU.IHO[p.IOJXO'SOllBIHJOJUTOTQ/ﬁdnq 11101; prBOIUAAOG

9IOZ ‘09 lsnﬁnv uo ::

K.BaIIerstein et al.

 

 

Extreme rays
of convex cones

Elementary Modes
(minimal functional units)

Minimal Cut Sets
(minimal failure modes)

   
    

Dualization

Fig. 1. Relation of primal and dual network with respect to EMs and MCSs.

Here we propose a method to compute MCSs directly without
knowing the EMs. A brute—force procedure to achieve this could
be to use FBA to test systematically all 1—,2—,3—,.... combinations
of knock—outs for their ability to imply the desired blocking of
targeted ﬂux vectors (Fig. 1). However, such an approach again
becomes quickly prohibitive for MCSs with larger cardinalities. A
slightly different concept are Minimal Direction Cuts introduced
by Larhlimi and Bockmayr (2007). These cuts allow to cancel
only one direction of reversible reactions, which can also be
embedded in the model of MCSs by splitting reversible directions
and target one of them. However, the concept of minimal direction
cuts allows for a direct computation by means of the Farkas
Lemma (Farkas, 1902). The enumeration of all minimal cuts is
accomplished by solving iteratively (general) Mixed Integer Linear
Programs.

In contrast, our approach relies on the notion of a dual network
whose stoichiometric matrix is basically given by the transposed
stoichiometric matrix of the original system. Based on the Farkas
Lemma, we will show that the computation of MCSs is equivalent to
ﬁnding the EMs in the dual network (Fig. 1). In particular, the duality
implies also the other way around: EMs in the original metabolic
network correspond to MCSs in the dual.

Additionally, our duality framework enables us to expand the
concept of EMs and MCSs (originally deﬁned for homogeneous
constraints only) for systems with inhomogeneous constraints that
can model e.g. boundaries for the reaction rates or for linear
combinations of ﬂuxes. The computation of EMs and MCSs remain
the same in this generalization while the expressive power highly
increases.

Biochemical Network

    
   

Target Functionality

Joint Generation

  

minimal hitting sets

minimal hitting sets

Systematic
testing of
knock—out set - -
Jomt Generation
by FBA Algorithm

Dual Network

 
 

Target Functionality

]‘ Dualization

Systematic testing
of knock—out sets
by FBA

Algorithm

Minimal Cut Sets
(minimal failure modes)

Elementary Modes
(minimal functional units)

Extreme rays
of convex cones

For reasons of representation, we will initially restrict ourselves
to the MCS problem for a given set of target reactions which will
be generalized in a later step. The duality theory, which enables
direct computation of MCSs as EMs of a dual network, is presented
in Section 2.2. Implementation details and computational results
for benchmark problems are provided in Sections 2.3 and 3.1.
Generalizations together with an application example are described
in the Section 3.2.

2 METHODS

2.1 Basic concepts

A metabolic reaction network consists of m metabolites and n biochemical
reactions for which we denote the index sets by M and N, respectively.
We model such a network via the mxn stoichiometric matrix N where
each column encodes one reaction by storing the respective stoichiometric
coefﬁcients of the metabolites consumed and produced. Each reaction may
operate with a certain rate and the full set of n reaction rates is collected in
the (ﬂux) vector r. The reactions usually divide into a set of reversible and a
set of irreversible reactions, denoted by Rev and Irrev = N \Rev, respectively.
Irreversible reactions can only proceed in the forward direction, hence, r,- 2 0
for all reactions ie I rrev.

Given such a metabolic network we say that it is in steady state if each
metabolite is equally consumed and produced by the reactions. The set of
ﬂux vectors keeping the network in steady state is described as the following
convex polyhedral cone, also called ﬂux cone,

.7:={reR” | Nr=0,r,-ZO for ielrrev}.

The EMs are, up to scaling, the support—minimal non—zero points of .73,
where the support of a vector x is deﬁned as the index set {i EN : x1750}.

 

382

112 /§JO'SIBUJHOIPJOJXO'SOIlBIHJOJUIOIQ/ﬁdnq 11101; prBOIUAAOG

9IOZ ‘09 lsnﬁnv uo ::

Minimal cut sets and elementary modes

 

Thus, they are determined by the binary support pattern of which we will
make use. Note that EMs correspond to the extreme rays of the steady—state
ﬂux cone if all reactions are irreversible. Generally this is not true. However,
one may split the reversible reactions into its two irreversible parts to make
use of algorithms known for the extreme ray generation problem. A more
detailed discussion about the computation and geometric interpretation of
EMs can be found in Gagneur and Klamt (2004).

One is often interested in combinations of reaction knock—outs (cuts) that
block the operation of certain target reactions in steady state. If we denote
the set of target reactions by 0 75 T glrrev, assuming for simplicity that they
are all irreversible, these sets are called cut sets for T. Speaking algebraically,
a out set C EN is a set of reactions such that for all solutions to the system

{reR” | Nr=0, rq :0 for qelrrev, r,- =0 for ie C}
it holds true that rj=0 Vj e T. An MCS is an inclusion—wise smallest out
set, i.e. no subset of an MCS C fulﬁlls the latter condition. Note that the
restriction of T glrrev is not a loss of generality as each reversible reaction
can be split into two irreversible parts.

It will be convenient to denote the target reaction set by a target reaction
vector te{0,1}” which is a column vector indicating the targets by 1.

2.2 Computing MCSs as elementary modes in a dual
network

In the following, we derive a method that detects all MCSs without the
necessity to generate the EMs. The idea is to use the same polyhedral methods
as for calculating EMs but for a dual stoichiometric network. It is obtained
by polyhedral duality. First, we review the basic concept and notation.

Let A be a m x n, and C be a p x n real matrix, M and P the respective
index sets of their rows, N the index set of columns (and thus also of the
variables) and let b e R’", d 6 RP . For J g M, we denote by A J. the submatrix
of A consisting of the rows corresponding to the index set J EM and all
columns. Accordingly, A. J describes the submatrix with columns from J QN
and all rows. We abbreviate the polyhedron S = {x e R” : Ax 5b, Cx=d}
by displaying the deﬁning system {Ax 5 b, Cx = d}, and a subsystem of S by
{AJ.x§bJ, CK.x=dK}, with J QM, K gP. The concept we make use of is
the one of irreducible inconsistent subsystems (IIS) of a system of equalities
and inequalities.

DEFINITION 1 (Irreducible inconsistent subsystems). Suppose the system S =
{AX g b, CX = d} is inconsistent, i. e. S = 0. A subsystem {AJ.X S b], CK.X =
dK}, J QM, K QP, is an irreducible inconsistent subsystem (IIS) of S if it is
inconsistent and it has no proper inconsistent subsystem.

In particular, we can relate the set of MCSs to the IISs of a certain system.

LEMMA 1. Each M CS C for given stoichiometric matrix N e R’"” and target
reaction vector t7£0 can be identiﬁed with an IIS of the system

Nr=0
Ir=0
_ (1)
erO Jelrrev
tTrzl, reR”

where I denotes the n-dimensional identity matrix.

PROOF. First, note that the system ( 1) is obviously infeasible, which
justiﬁes the consideration of its IISs. To prove the claim, we have to show
that any MCS C corresponds to an IIS of the system (1), and no other MCS
C/ corresponds to the same subsystem. To this end consider the system

Nr=0
17:0 lEC
_ (2)
erO Jelrrev
tTrzl, reR”

Since C is an MCS, this system is an inconsistent subsystem of (1).
Otherwise, it is not true that rj =0 Vj e T and thus C is not a out set.

But clearly (2) is not necessarily irreducible. Thus, it remains to argue that (2)
has an IIS that contains all equalities r,- =0, ie C. As C is an MCS, we
know that {Nr =0, rC 2 00mm 2 0} g {r e R” : rj =0 Vj e T}. Thus, there
exist minimal sets J g M and K Elrrev\ C such that {NJr = 01,1'C 2 0C, rK 3
0K} g {r 6R” : rj =0 Vj e T}. Hence, the system

{NJ-1'=01, l'C=Oc, tTI'ZL I'KZOK}=®

is irreducible. By construction, all MCSs relate to distinct IISs. CI

The relation between MCSs and IISs of ( 1) is clearly not one—to—one but
one MCS corresponds to many IISs. The choice of J and K is, a priori,
not necessarily unique, but imposing preferences on indices (use e.g. a
lexicographic order on the set J x K) yields uniqueness. Furthermore, some
IIS refer to supersets of MCSs. For example, {rT =0, tTrZ 1} is always
an IIS whereas blocking all target reactions T is always a out set but not
necessarily a minimal one. Therefore, we compute MCSs by ﬁnding all IISs
of ( 1) and select those minimal with respect to the variables ﬁxed to 0.

In Parker and Ryan (1996), the computation of all 118s of an inconsistent
system {Ax§b,Cx=d,x30} is reduced to enumerating all vertices of a
certain polyhedron. It is shown that the support of each vertex of this
polyhedron identiﬁes exactly the index set of one IIS of the original system.
The auxiliary polyhedron is obtained by means of the Farkas Lemma,
which characterizes the infeasibility of an arbitrary system of linear equality
and inequality systems [for detailed illustration see Schrijver ( 1986)]. For
completeness, we state here one version of the famous result.

THEOREM 2 [Farkas Lemma (Farkas, 1902)]. For matrices A,B, C,D and
vectors a,b of matching dimensions exactly one of the following statements

is true:
there exist x,y s.t. there exist s,w,z s.t.

Ax+By=a ATs+CTW—z=0
Cx+Dy§b BTs+DTW —z=0
x30 S,WZO

aT s + bT W < 0
Since system (1) is inconsistent, we can apply the Theorem. In our case,

1: . Matrix A contains the
columns corresponding to irreversible reactions, and B the columns referring
to reversible reactions. Accordingly, x=r1rrev and y=rRev. The right—hand
side a is 0. We also split the vector s of the dual system into a u (associated
with N) and a v (associated with 1) part. In the next row, [C, D] correspond
to the vector —t (note that we had to rewrite tTr Z 1 to —tTr 5 —1). Again,
C refers to the irreversible and D to the reversible part. By deﬁnition of t,
D is 0. The right—hand side of this equation is b: —1. Since C and D are
(row) vectors in our particular case, the vector W reduces to a scalar. Thus,
we know that the following system is consistent

the matrices [A,B] together correspond to

u
— v

Ndualrdual:=(NT I _IIrrev _t) Z :0
W

I (3)

ueR’", veR”, zeR' "WI, weR

2:0,w30

—w<0,

where I e Rm is the identity matrix and 11..., e Rnx llrrevl is the identity
matrix for irreversible reactions ﬁlled with n — |Irrev| 0 rows at the position of
reversible reactions. To obtain the standard form of a steady—state description
of a reaction network we relax w > 0 to w 2 0, which leads to the dual
stoichiometric network with stoichiometric matrix Ndual.

Ndualrdual = 0
ueR’", veR”, zeR'IrreV', weR (4)

2:0,w30

 

383

112 /§.IO'SIBUJHOIPJOJXO'SOIlBIHJOJUIOIQ/ﬁdnq 111011 pop1201umoq

9IOZ ‘09 lsnﬁnv uo ::

K.BaIIerstein et al.

 

Primal Network

R3
R2 A R5

R1 W

R1 R2 R3 R4 R5
—1 1 —1 —1 0]A
N=

 

0011—1B

 

 

 

Reversible reaction: R1

Target reaction: R5

T _

TargetEMs (with R5): Ndual_(N I I
EM1={R1,R3,R5}
EM2={R1,R4,R5}
EM3={R2,R3,R5}
EM4={R2,R4,R5}

MCSs for target reaction R5
MCS1={R1,R2}
MCSZ={R3,R4}
MCS3={R5}

 

irrev

Dual Network

 

 

NQN; I 1m —t
ul uz v1 V2 V3 V4 V5 Z2 Z3 Z4 Z5 w
—1 100000 0 0 0 0R1
1001000—10 0 0 0R2
—t)=—11001000—1000R3
—11000100 0—10 0R4
0—1000010 0 0—1 R5

 

 

 

 

 

 

 

Reversible reactions: v1  v5 and u1,u2 (originating from metabolites A and B in NT)

EMs with support in w and minimal support with respect to reactions v1  v5:
EM1={V1IV27U1IUZ!W}
EM2={v3,v4,u2,w}

EM3={v5,w}
\ MCSs hitting the three EMs above by cutting only V1,...,V5I

MCS1={v1lv3,v5}
MCSZ={v1,v4,v5}
MCSB={v2,v3,v5}
MCS4={v2,v4,v5}

Fig. 2. Example of a metabolic network and its dual illustrating the correspondence of their EMs and MCSs.

Comparing primal (1) and dual (4) system one can see that the latter
is basically the transposed version of the original system except that the
matrices related to the inequality constraints were multiplied by —1. Thus,
reactions in this dual framework stem from metabolites of the original
network while primal reactions became metabolites in the dual (see also
the example at the end of this section). Furthermore, the variables w and
2 correspond to irreversible reactions, whereas u and v are associated with
reversible reactions.

As proved in Gleeson and Ryan (1990) and Parker and Ryan (1996), the
IISs of (1) correspond to the support of those extreme rays of the cone (4)
with w > 0. Thus, the extreme rays that determine the MCSs are those with
minimal support of v and a strictly positive w. From the Farkas Lemma, it
is clear that all relevant solutions of (4) must satisfy w > 0 since system (1)
without the inequality tTr Z 1 is feasible.

We also remark that the dual of the dual network (4) yields:

Nr =0
Ir =0
rIrrev Z 07 r e Rn

tTr=k, k>0

which is upto a trivial projection of k and scaling of the remaining inequality
the original metabolic network transformed to its IIS form (1).

To conclude the section, we illustrate the approach by the small example
in Figure 2. The network on the left—hand side shows the primal network with
ﬁve reactions and two metabolites A and B. The intervention goal is to block
the ﬂux through the target reaction r5. The network has ﬁve EMs, and the
four relevant EMs involving target reaction r5 are given by their support. The
conventional way to obtain the MCSs is to compute the minimal hitting sets of
the target EMs. As an alternative, our new approach suggests to build the dual
network instead (right—hand side in Fig. 2) and to compute the MCSs of the
primal network as EMs of the dual. As can be seen in Figure 2, the reactions of
the primal network become metabolites in the dual and the primal metabolites
are now reactions. In addition, each metabolite (formerly reaction) gets an

associated reversible exchange reaction (v1, ...,V5) and, if the metabolite
originates from an irreversible reaction in the primal network, an irreversible
outﬂow (zz, ...,z5). Finally, all species in the dual network originating from
a target reaction are virtually excreted by one reaction w; in the example this
affects only r5. Generally, the conversion of the primal to the dual network
can be performed instantly without computational effort. One then computes
the EMs in the dual network and selects those which are minimal with respect
to v1, ...,V5 and where w > 0 (i.e. reaction w is involved). These EMs are the
desired MCSs for the primal network. If we compute the MCSs (as minimal
hitting sets) of the dual EMs (focusing again only on MCSs comprising
exclusively v1 , . . . , V5), we get the EMs of the primal network (Figs 1 and 2).
The fact that only particular EMs of the dual network are relevant in this
procedure suggests a particular design of the algorithm to compute them
which is brieﬂy outlined in the following section.

2.3 Implementation details

Generally, the enumeration of EMs can be a demanding problem due to a
possible combinatorial explosion during the generation of new candidate
modes. As described above, we are interested in those EMs of the dual
system (3), which are minimal with respect to reactions v and fulﬁll w > 0.
For small systems, it is possible to calculate all EMs and then to select those
that fulﬁll these properties. For larger systems, this turns out to be impractical.
Therefore, we devised an enumeration scheme which effectively calculates
the desired subset of EMs. Details of this implementation can be found
in the Supplementary Material. Brieﬂy, certain redundancies and particular
structures of the dual system (3) can be exploited to simplify the procedure
and to reduce the computational effort. For example, reactions 2 can be seen
as parallel reactions (isozymes) to the backward direction of the reversible
reactions v (Fig. 2). This means that for EM computation reactions 2 can at
ﬁrst be ignored and taken into account by a postprocessing step. Furthermore,
as we are only interested in EMs of the dual system that are minimal with
respect to the reactions v, columns corresponding to reactions u need not be
processed during the EM calculation procedure.

 

384

112 /§.IO'SIBUJHOIPJOJXO'SOIlBIHJOJUIOIQ/ﬁdnq 111011 pop1201umoq

9IOZ ‘09 lsnﬁnv uo ::

Minimal cut sets and elementary modes

 

Table 1. Benchmark problem: MCSs for E. coli ’s central metabolism blocking growth separately for the four different substrate uptake scenarios

 

 

 

Substrate Classical approach via minimal hitting sets Dual network approach
No. of No. of No. of Comp. Total

EMs primal Comp. time (s) target EMs MCSs time (s) time (s) Comp. time (s)

acetate 599 0.3 363 309 0.3 0.6 0.42

succinate 4250 0.8 3421 1623 5.6 6.4 7.02

glycerol 11333 1.5 9479 3733 35.3 36.8 37.4

glucose 27100 3.6 21592 4960 177.7 181.3 188.7

 

Comp. time, computation time.

3 RESULTS

3.1 Computational results

In order to test our implementation of the dual approach described
above, we applied it to the benchmark problem of calculating MCSs
in a model of the central metabolism of Escherichia coli [cf. Haus
et al. (2008); note that we did not consider multifunctional enzymes
leading to slightly different numbers of MCSs]. Concretely, the
task is to calculate MCSs that disable growth under four different
substrate uptake scenarios. To increase the performance of EM
computation, the metabolic network (N) is compressed beforehand
as usual and the same reduction is also used before dualizing the
system. After calculating the (primal) MCSs as EMs of the dual
network, they can be readily mapped back to the original reactions.

Computation times are shown in Table 1. For the conventional
MCS computation procedure, the calculation time splits into the
computation of EMs and minimal hitting set computation (cf. Fig. 1).
The former was done with Metatool (von Kamp and Schuster,
2006) while for the latter, API functions of CellNetAnalyzer were
used (Klamt and von Kamp, 2011). In the dual network, Metatool is
used for processing the rows and Matlab scripts have been written
for ﬁltering intermediate modes and for selection of support—minimal
and superseded vectors (Supplementary Material). All in all both
methods show similar computation times. However, during row
iterations of the dual network method we observed that the number
of intermediate modes can considerably exceed the number of ﬁnal
MCSs, which can lead to high memory requirements, at least as far as
our prototypical implementation is concerned. Therefore, in future
work we will address a more dedicated implementation of the dual
network method, e.g. reduce memory demand which should also
improve its runtime performance.

Furthermore, although the dual approach did not outperform the
conventional method to compute the MCSs in the example, other
problem instances may exist where the circumvention of the minimal
hitting set calculation may become highly beneﬁcial. Moreover, the
enormous recent improvements in the EM calculation procedure
including parallelized variants (Terzer and Stelling, 2008) may favor
the computation of MCSs as EMs from the dual network in the near
future. As we had to use our own implementation (Metatool) to
encode the dual approach and its enhancements (as described in the
Supplementary Material), we did not yet fully beneﬁt from these
latest developments.

3.2 Generalizations

The procedure of computing MCSs as EMs in a dual network
outlined above can be further generalized to increase the scope

of applications and to allow for a more precise speciﬁcation of
intervention problems. First of all, it is straightforward to relax the
notion of target reactions to target ﬂux vectors which need to be
blocked. In case of target ﬂux vectors, the goal is to block all ﬂux
vectors where at least one of the target reactions is active. In the
primal system (1), this was expressed by the vector t which occurs
after dualization as column in the dual stoichiometric matrix (3).

Another design strategy relevant e.g. for metabolic engineering is
to block all ﬂux vectors where the yield Y1D / S = rp /rS (rp: product
excretion rate; r5: substrate uptake rate) of a certain product falls
below a given threshold h, i.e. where rp/rS <h. These target ﬂux
vectors can be speciﬁed by hrs — rp Z 1 and the target reaction vector
t is thus constructed with zeros except for the —1 for the product
excretion and h for the substrate uptake reaction.

However, for some applications we need more inhomogeneous
constraints to specify target ﬂux vectors properly. To this end, we
move away from the ﬂux cone to the ﬂux polyhedron of a metabolic
network.

DEFINITION 2 [(Target) ﬂux polyhedron]. Given a stoichiometric
matrix N E Rm X” and a matrix T E Rt X” that models inhomogeneous
constraints on the reaction rates in connection with certain lower
and upper bounds B={[bl.L,blU]|1§i§t}, then the (target) ﬂux
polyhedron is given by

73={I’€Rn INI’ZO, bLETrEbUarIrrevZO}'

The double inequalities can be written as two separate systems
which read Tr 5 bU, —Tr 5 —bL. For ease of notation, we will from
now on put all constraints into one matrix T and the combined
right—hand side is denoted by b:

73={I’€Rn INFZO, Trfbarlrrev20}-

The original formulation with the target reaction vector t can be
easily embedded within this description with T: —tT and b: —1.
Matrix T allows us to express complex sets of (target) ﬂux
vectors in a ﬂexible way, not only by specifying target reactions
but also by other homogeneous or inhomogeneous constraints, e. g.
on boundaries or certain ratios of reaction rates. Moreover, by
moving a row from N to T and providing suitable lower and upper
bounds, the steady—state assumption on certain metabolites can be
relaxed to certain boundaries of accumulation/degradation rates of
the corresponding metabolite. [This generalization also covers the
reaction simplex as introduced by Horn and Jackson (1972), more
appropriately called concentration polyhedra, see Clarke (1980)].

Example 1. For illustration of potential application scenarios,
we return to the example network of Figure 2 and assume the system

 

385

112 /§.IO'SIBUJHOIPJOJXO'SOIlBUIJOJUIOIQ/ﬁdnq 111011 pop1201umoq

9IOZ ‘09 lsnﬁnv uo ::

K.BaIIerstein et al.

 

to be in steady state as usual. Additionally, we limit the rate of
reaction r1 within the range [—2, 10] which is expressed by Tr5b,

with:
—1 0 0 0 0 2
T=( 10000)’ b=(10)' (5)
We can ﬁx certain reaction rates to a single value (which could
represent, for example, the non-growth associated ATP maintenance

demand) in combination with boundaries for others, e. g. r5 = 5, 0 5
r3 5 3, 0 5 r4 5 3 which can be encoded by

(6)

000000
000000

Another possibility is to drop steady-state assumptions for certain
(e.g. external) metabolites and to consider accumulation or/and
degradation for these metabolites within certain boundaries. For
example, accumulation of metabolite A at a rate between I and 2
and steady state for B is modeled by moving the row of A from N to
T and deﬁning a suitable b

(J Li _18)rs( i) <0
It is well known that polyhedra can alternatively be represented
by an outer description as intersection of hyperplanes (as it is the
case for 79) or by an inner description, as a Minkowski sum 73:
coan—l—coneE, using the vertices V and the extreme rays E of 73.
The ﬂux polyhedron 79, therefore, decomposes into a cone and a
polytopal part, whose vertices characterize the extremal operating
states of the network for the prescribed ranges of reaction rates or
their linear combinations. Each vertex v E V is determined by some
combination of simultaneously tight constraints of the inequality
description. The vertices hence show whether the ranges required
are in fact limiting, and how their limiting effects are intertwined.

Example 2 (Example 1 cont.). System (5) describes a limit on
reaction rate I. The rays of this ﬂux polyhedron are all EMs in
Figure 2 that do not contain r1, as this is limited by 10 and cannot be
applied with arbitrary values. Additionally, the polyhedron consists
of four vertices to be read row-wise starting with r1 up to r5:

P1: 0 0000
P221010000

P3: —2 0 0 2 2
P4: —2 0 2 0 2
While P2 attains the upper bound on the reaction rate, P3 and P4
fulﬁll the lower bound with equality. Thus, we know which minimal
combination of reactions yields which reaction rate of r1. P1 satisﬁes
the sign constraints of r2, r3, r4 and r5 with equality.

With the (target) ﬂux polyhedron 79 at hand, we wish again
to ﬁnd minimal knock—out sets that block all its ﬂux vectors.
The generalized deﬁnition of MCSs for 79 is straightforward.

DEFINITION 3 (MCSs of ﬂux polyhedra). Let 73 be a ﬂux polyhedron.
A cut set C is a set of reactions such that no non-zero point r in
73 satisﬁes ri=0 for i E C. A minimal out set is an inclusion-wise
smallest cut set.

Note that setting r,- =0 for i E C in ﬂux polyhedra may lead to
an empty solution space while in the homogeneous case at least the
trivial solution r =0 always remains.

In accordance with the case of a ﬂux cone, by applying again
Theorem 2 one can compute the MCSs of a given (target) ﬂux
polyhedron 79 as the vertices of the following dual polyhedron:

(NT I —iIrrev TT)

€N<§

8
bTw=—q ( )

ueRm, VER”, weRt, zeRllmvl, qER

w30, 2:0, 6120

with 1 e RHX" the identity matrix and TM, 6 R"X '1 ml the identity
matrix ﬁlled with 0 rows for reversible reactions. Again the MCSs
correspond to those vertices with q>0, i.e. with bTw<0, and
minimal support of V. As before, we determine the vertices by
computing the EMs (rays) for c120 and selecting afterwards the
ones with support in q and minimal support in V.

This generalization of MCSs in ﬂux polyhedra yields a highly
general modeling framework. Returning to scenario (6) for the
network in Figure 2, it becomes clear that the capacity constraints on
reaction rates r3 , r4 and r5 imply different MCSs blocking all (steady
state) ﬂux vectors obeying the inhomogeneous constraints (6): it is
now sufﬁcient to remove either r3 or r4 because then the constraint
for r5 cannot be fulﬁlled anymore. This does not obviously hold
when neglecting the inhomogeneous constraints.

Combinations of inhomogeneous constraints can conveniently be
integrated in the dual system (8) but are difﬁcult to treat via the
conventional way, i.e. by deﬁning a set of target EMs and then
computing the minimal hitting sets: whether an EM is a target EM
or not is not a local property anymore; in general, only certain
(conic) combinations of EMs fulﬁll a given set of inhomogeneous
constraints. The following example illustrates the use of the dual
description for a realistic application scenario where the classical
way of MCSs computation cannot directly be used.

Example 3. As in Table I, we consider again the stoichiometric
model of E.coli’s central metabolism with the intervention goal
to block growth. For sake of simplicity, we focus on growth on
succinate. In addition to the scenario in Table I, it is reasonable
to assume that there is a maximal substrate uptake rate [a realistic
value is I 0mmol/(gDW-h)] and that we want to block all ﬂux vectors
with a minimum growth rate of ,U. 2 0.001. Furthermore, non-growth-
associated ATP maintenance demand was not considered in the
previous example but obviously consumes resources (ATP) that
can then not be used for biomass synthesis. We therefore ﬁx the
rate rmaintATp of the ATP maintenance demand to a speciﬁc value
and consider three cases: ﬁrst, we set rmaintATp=0 This directly
corresponds to the scenario considered in Table I and leads to the
same set of MCSs. Second, we set rmaintATp = 8.4 which is a typical
value used in other studies (Suthers et al., 2009). Third, to simulate
a higher ATP maintenance demand (caused e.g. by environmental
stress) we set rmaintATp =30. When moving from the ﬁrst over the
second to the third scenario, we expect the MCSs to get smaller
since more substrate must be directed to ATP synthesis rendering
the system less robust for growth (i. e. less knock-outs suﬁice to inhibit
growth). In fact, as can be seen in Figure 3, the size distribution of
M CSs shows a shift from larger to smaller M CSs when increasing the

 

386

112 /EJO'S[BUJHO[pJOJXO'SOIlBIHJOJUIOIQ/ﬁdnq 111011 pop1201umoq

9IOZ ‘09 lsnﬁnv uo ::

Minimal cut sets and elementary modes

 

EDI} -

l ATPrrIaint=0
55”} n ATPmaint=34
. HTPmaint=3EI .

 

 

400

 

EDE-

 

 

 

 

 

Fig. 3. Size distribution of MCSs (blocking growth of E. coli when growing
on succinate) for different ATP maintenance demands.

ATP maintenance demand. Hence, the cells become more vulnerable
against random failures or targeted removal of certain combinations
of reactions.

4 DISCUSSION AND CONCLUSION

We presented a novel method that allows the computation of
MCSs without knowing beforehand or producing simultaneously
the EMs of a stoichiometric network. Our computational approach
is based on a duality framework, which completes the picture of
dual relationships between EMs and MCSs (Fig. 1). Interestingly,
both EMs and MCSs can be computed with the same algorithm,
which enumerates extreme rays of a polyhedral cone. In addition
to computational aspects, this duality offers a new perspective
on function and dysfunction in biochemical networks: minimal
functional units imply minimal failure modes and vice versa and
their role can be interchanged in a dual network. It depends
on the application which path of calculation the most effective
one is.

As a further extension, we proposed a generalization of the
classical steady—state analysis in metabolic networks that permits to
model arbitrary combinations of homogeneous and inhomogeneous
conditions on reaction rates or even accumulation/exhaustion of
certain metabolites. As computations can still be performed by the
same method, this expansion is a promising tool to open the concept
of EMs and MCSs to a wider class of applications.

Funding: German Federal Ministry of Education and Research
(FORSYS—Center MaCS and ERASysBio); Ministry of Education

and Research of Saxony—Anhalt (Research Center ‘Dynamic
Systems’) in part.

Conﬂict of Interest: none declared.

REFERENCES

Berge,C. ( 1989) Hypergraphs. Combinatorics of Finite Sets. Translated from the French.
North-Holland Mathematical Library, 43. Amsterdam, North-Holland, x, 255 p.
Clarke,B.L. (1980) Advances in Chemical Physics, vol. 43. Stability of Complex

Reaction Networks. John Wiley & Sons, Inc., New York, USA, pp. 1—215.

Edwards,J.S. et al. (2002) Metabolic modelling of microbes: the ﬂux-balance approach.
Environ. Microbiol, 4, 133—140.

Farkas,J. (1902) Theorie der einfachen Ungleichungen. J. Reine Angew. Math, 124,
1—27.

Fredman,M.L. and Khachiyan,L. (1996) On the complexity of dualization of monotone
disjunctive normal forms. J. Algorithms, 21, 618—628.

Gagneur,J. and Klamt,S. (2004) Computation of elementary modes: a unifying
framework and the new binary appraoch. BMC Bioinformatics, 5.

Gleeson,J. and Ryan,J. (1990) Identifying minimally infeasible subsystems of
inequalities. ORSA J. Comput, 2, 61—63.

H'adicke,O. and Klamt,S. (2011) Computing complex metabolic intervention strategies
using constrained minimal cut sets. Metab. Eng, 13, 204—213.

Haus,U.-U. et al. (2008) Computing knockout strategies in metabolic networks.
J. Comput. Biol, 15, 259—268.

Horn,F. and Jackson,R. (1972) General mass action kinetics. Arch. Rational Mech.
Anal, 47, 81—116.

Klamt,S. and Gilles,E.D. (2004) Minimal cut sets in biochemical reaction networks.
Bioinformatics, 20, 226—234.

Klamt,S. and von Kamp,A. (2011) An application programming interface for
CellNetAnalyzer. BioSystems, 105, 162—168.

Klamt,S. (2006) Generalized concept of minimal cut sets in biochemical networks.
BioSystems, 83, 233—247.

Larhlimi,A. and Bockmayr,A. (2007) Minimal direction cuts in metabolic networks.
In Siebes,A.P.J.M. et al. (eds) COMPLIFE 2007: The Third International
Symposium on Computational Life Science, Vol. 940, American Institute of Physics,
New York, USA, pp. 73—86.

Parker,M. and Ryan,J. (1996) Finding the minimum weight IIS cover of an infeasible
system of linear inequalities. Ann. Math. Artif. Intell, 17, 107—126.

Price,N.D. et al. (2004) Genome-scale models of microbial cells: evaluating the
consequences of constraints. Nat. Rev. Microbiol, 2, 886—897.

Schrijver,A. (1986) Theory of Linear and Integer Programming. Wiley, New York, NY.

Schuster,S. et al. (2000) A general deﬁnition of metabolic pathways useful for systematic
organization and analysis of complex metabolic networks. Nat. Biotechnol, 18,
326—332.

Suthers,P.F. et al. (2009) A genome-scale metabolic reconstruction of mycoplasma
genitalium, ipsl89. PloS Comput. Biol, 5, e1000285.

Terzer,M. and Stelling,]. (2008) Large-scale computation of elementary ﬂux modes
with bit pattern trees. Bioinformatics, 24, 2229—2235.

Trinh,C.T. et al. (2008) Minimal escherichia coli cell for the most efﬁcient production
of ethanol from hexoses and pentoses. Appl. Environ. Microbiol, 74, 3634—3643.

Trinh,C. et al. (2009) Elementary mode analysis: a useful metabolic pathway analysis
tool for characterizing cellular metabolism. Appl. Microbiol Biotechnol, 81,
813—826.

Urbanczik,R. and Wagner,C. (2005) An improved algorithm for stoichiometric network
analysis: theory and applications. Bioinformatics, 21, 1203—1210.

von Kamp,A. and Schuster,S. (2006) Metatool 5.0: fast and ﬂexible elementary modes
analysis. Bioinformatics, 22, 1930—1931.

 

387

112 /B.IO'SIBUJHOIPJOJXO'SOIlBIIIJOJUIOIQ/ﬁdnq 111011 pop1201umoq

9IOZ ‘09 lsnﬁnv uo ::

