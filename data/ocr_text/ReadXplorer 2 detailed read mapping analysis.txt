Bioinformatics Advance Access published August 18, 2016

 

Genome Analysis

Reaprlorer 2 - detailed read mapping analysis and
visualization from one single source

Rolf Hilker1’*’+, Kai Bernd Stadermann2’+, Oliver Schwengers1’+, Evgeny Anisifo-
rovl, Sebastian J aenickel, Bernd Weisshaarz, Tobias Zimmermann1 and Alexander
Goesmann1

1Bioinformatics and Systems Biology, Faculty of Biology and Chemistry, Justus-Liebig-University, 35392
Giessen, Germany

2Faculty of Biology, Chair of Genome Research, Bielefeld University, 33615 Bielefeld, Germany
*To whom correspondence should be addressed.

+ Contributed equally to this work

Associate Editor: Prof. Bonnie Berger

Abstract

Motivation: The vast amount of already available and currently generated read mapping data re-
quires comprehensive visualization, and should benefit from bioinformatics tools offering a wide spec-
trum of analysis functionality from just one source. Appropriate handling of multiple mapped reads
during mapping analyses remains an issue that demands improvement.

Results: The capabilities of the read mapping analysis and visualization tool Reaprlorer were vast-
ly enhanced. Here, we present an even finer granulated read mapping classification, improving the
level of detail for analyses and visualizations. The spectrum of automatic analysis functions has been
broadened to include genome rearrangement detection as well as correlation analysis between two
mapping data sets. Existing functions were refined and enhanced, namely the computation of differ-
entially expressed genes, the read count and normalization analysis and the transcription start site
(TSS) detection. Additionally, Reaprlorer 2 features a highly improved support for large eukaryotic
data sets and a command line version, enabling its integration into workflows. Finally, the new ver-
sion is now able to display any kind of tabular results from other bioinformatics tools.

Availability: http://www.readxplorer.org

Contact: readxplorer@computational.bio.uni-giessen.de

Supplementary information: supplementary data are available at Bioinformatics online.

 

During the last years next-generation sequencing (NGS) technologies
(Bentley et al., 2008; Margulies et al., 2005) vastly changed the field of
DNA and RNA sequencing by drastically reducing the costs while
increasing the sequencing yield per run at the same time (Reuter et al.,
2015). Nowadays NGS has a broader scope as ever and is currently
entering the ﬁeld of clinical microbiology for infectious disease diagnos-
tics and epidemiology (Goldberg et al., 2015; Buchan and Ledeboer,
2014).

Whole genome sequencing (W GS) and transcriptome sequencing (RNA-
Seq) data sets are huge and comprise millions of reads, requiring proper
and scalable data handling. A typical analysis workﬂow requires map-

© The Author(s) 2016. Published by Oxford University Press.

ping of the reads to a reference genome followed by the respective
analyses. This requires easily applicable automatic analyses and compre-
hensive visualization for read mapping data as implemented in the
ﬂexible Reaprlorer software (Hilker et al., 2014). The software is
based on a quality classification of the read mappings and offers single
nucleotide polymorphism and deletion—insertion polymorphism detec-
tion, genomic feature and general coverage analysis, RNA secondary
structure prediction, differential gene ex-

This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License
(http://creativecommons.org/licenses/by-nc/4.0/), which permits non-commercial re-use, distribution, and reproduction in any
medium, provided the original work is properly cited. For commercial re-use, please contact joumals.permissions@oup.com

112 [3.10'SIBIIJHO[p.IOJXO'SODBIIIJOJIIlOTQ/ﬂ(11111 IIIOJJ pepeolumoq

910K ‘09 lsnﬁnV uo ::

 

pression analysis, transcription start site detection, operon detection and
RPKM value and read count calculations. Although not optimal, it is still
common practice to exclude reads mapping to more than a single posi-
tion from downstream analyses (Li et al., 2015) and many read mapping
analysis tools do not address multiple mapped reads (e.g. TSSPredator
(Dugar et al., 2013), TSSer (Jorjani and Zavolan, 2014) and TSSAR
(Amman et al., 2014) for TSS detection or VarScan 2 (Koboldt et al.,
2012) for single nucleotide polymorphism (SNP) detection). For the
latter tools, we assume that they incorporate all reads present in the data
set provided by the user. A notable exception is the RNA-Seq analysis
tool Rockhopper (McClure et al., 2013). It uses all optimal alignments of
a read, but it remains unclear how multiple mapped reads are taken into
account when measuring the read count for a gene.

In contrast to common practice, various publications (Treangen and
Salzberg, 2012; Robert and Watson, 2015) have shown the importance of
properly handling multiple mapped reads instead of discarding them.
Generally, relying on a single randomly chosen mapping position for a
read leads to a possibly erroneous choice about read placement
(Treangen and Salzberg, 2012), while in RNA-Seq experiments the
exclusion of multiple mapped reads leads to underestimation of the data
(Robert and Watson, 2015).

To accommodate these issues, the ﬁrst version of Reaprlorer already
featured a read mapping classification unique among read mapping
visualization tools. For the current work, we focused on a further reﬁne-
ment of this read classification. Hereby, an even more detailed View on
the mapping data is enabled and allows for easy configuration of the
mapping classes included in all downstream analyses.

Besides the classiﬁcation, the analysis capabilities of the software have
been largely enhanced to offer both more detailed (differential gene
expression, read count and normalization analysis and transcription start
site (TSS) detection) and new automatic analysis functions (genome
rearrangement detection and correlation analysis). Further, we introduce
technical improvements enabling integration of Reaprlorer 2 into
larger pipelines or workﬂow systems such as our Galaxy server, improv-
ing speed, broaden the support of large eukaryotic data sets and simplify-
ing the connection between GNU R (R Core Team, 2014) and Java.

In the following, we present the enhanced read mapping classiﬁcation,
newly implemented analysis functions and substantial enhancements of
existing analysis functions.

2.1. Extended Read Classification

For a more detailed distinction of the reads in comparison to the ﬁrst
Reaprlorer version, two additional read mapping classes have been
added to the three existing ones (Perfect Match — a mapping without
mismatches, Best Match — a mapping with less deviations than all other
mappings of the read, and Common Match — a mapping of a multiple
mapped read with better mappings with less deviations elsewhere) (see
Table l):
o The Single Perfect Match class contains all reads with exactly
one (single) perfect match.
0 The Single Best Match class contains all mappings that can-
not be allocated to another position in the reference with the

El Best Mahdi El Single Best Match

Table 1: Read mapping classification in Reaprlorer 2.

 

 

 

 

 

Read Ma in .
Classiﬁcaptiilng Pmpertles
Read has only one mapping without
Single Perfect Match mismatches, may have additional Com-
mon Match mappings
Read has one mapping with less devia-
Single Best Match tions than all other mappings, may have
additional Common Match mappings
Perfect Match Read has multiple mappings without
m1smatches
Read has multiple mappings with the
Best Match same number of deviations from the

reference

 

5% Legend V Opﬁons
I Perfect Match I Single Perfect Mabdt

  
  
  
 

 

I Common Matd'1 El Lndude multiple mapped reads

Figure 1: The five read mapping classifications in the coverage
plot. Read counts per base of input sequence are shown separat-
ed by strand and colored by mapping classification. Reads align-
ing at the borders of the figure have a distinctive best mapping
(Single Perfect and Single Best Match classes in rich green and
yellow),while the light green (Perfect Match), light yellow (Best
Match) and red (Common Match) mappings display a repetitive
reglon.

same number or fewer mismatches than at the current posi-

tion - they exactly have one (single) best match.
The Perfect and Best Match mapping classes contain multiple mapped
reads with equally good mapping positions, e.g. two perfect mappings
without mismatches at different genomic positions. In contrast, the
Single Perfect Match and Single Best Match class contain both uniquely
mapped reads and the distinctive best mapping of multiple mapped
reads. This extended classiﬁcation enables quick discrimination of reads
with only one distinctive best mapping from mappings with multiple
equally scoring mappings, while not requiring the read to be uniquely
mapped. Reads from both Single Match classes can have more mappings
with lower quality, falling in the Common Match class. Thus, this classi-
ﬁcation is not as strict as only considering uniquely mapped reads with
exactly one valid mapping to the reference. The extended read classiﬁca-
tion is not only used for visualization (Figure l) but also for read selec-
tion during the wizard based setup of all analysis tools offered by
Reaprlorer 2. Hereby, additional use cases are enabled for the automat-
ic analysis of read mapping data. As one example, the “Coverage Analy-
sis” can now be used to identify almost identical repetitive regions. By
only selecting the Perfect, Best and Common Match mapping classes,
only genomic intervals covered by multiple mapped reads — representing
repetitive regions in the genome - are returned by the analysis. Such a
region is depicted in Figure l by the light yellow, red and light green
areas.

113 /310'smumofplogxosoparulogurorq/ﬁdnq 11101; papaommoq

91oz ‘Og isnﬁnv uo ::

 

“Ell-1w

5.325—

Null‘bv {IIFEB'LUIEL Ilng LIHIEJ

In 1. w

3"

ﬂit-i
[I

FIR-GEE

'l:

I}
I“!
.'.iT' E:

i
HE E!

i

#1955

ELS‘. ﬁle".
El: Ell

DIQ‘. -lh‘.
EE'E'ﬂ'E?
TFWETT'ﬂﬁ

8956?? re: I
(arrears-32955:! I

TPMVaMe Ranges

 

Cl Framqu Vail:

Figure 2: The histogram comfortably visualizes the frequency of
TPM values observed within the data set at log scale. The actual
number of features belonging to one bar is shown in the tooltip. It
can be switched to show RPKM values.

2.2. Read Count Normalization

The ﬁrst Reaprlorer version featured an RPKM (total exon reads per
million mapped read per kilobase of exon model) (Mortazavi et al.,
2008) based read count analysis. This analysis has been enhanced by two
additions: the model for assigning reads to a genomic feature was im-
proved to allow for a more accurate way of read assignment to a feature
and the TPM (Transcripts per million) (Li et al., 2010) normalization
method was added to the analysis.

RPKM is meant to reﬂect relative molar concentrations of transcripts by
normalizing for transcript length and library size. This type of normaliza-
tion is necessary for reasonable comparisons of transcript abundances
both within one and among multiple samples. TPM was proposed as an
improvement to RPKM, because TPM has the advantage of being invari-
ant between samples and species (Li et al., 2010) while RPKM values
may change when the mean expressed transcript length changes due to
different sets of active genes in two samples.

TPM is defined according to (B. Li et al., 2010) as

TPM, =106>< % x 1
ll. 
j I;

where c is the number of mappable reads for genomic feature 1' and j is
an integer ranging from 1 to the number of genomic features of the same
type (e.g. genes).

To take into account that reads of a given length cannot start at each
position in a transcript, the effective length of transcripts I can optionally
be used for the normalization instead of the whole transcript length l.
The effective length of transcript i was ﬁrst defined by (Trapnell et al.,
2010) as

Z=ZZF(x)xli —x+l

xSll-

where x is one of the observed read length values in transcript i of length
l,, and AF is the fraction of reads for i with length x.

The model for assigning reads to a transcript needs to be as precise as
possible, because the normalization outcome is determined by the chosen

transcript boundaries and the inclusion model for the reads. Our analysis
offers to either use the given boundaries of genomic features or define a
ﬁxed offset for start and stop positions, separately. Using an offset can
be useﬁJl when most of the 5’UTRs and 3’UTRs are not taken into
account by the genomic features of the reference. Additionally, automat-
ically annotated gene start and stop positions might be incorrect, leading
to data loss.

The implemented read assignment model for read mappings overlapping
multiple genomic features (e.g. genes or CD8) is similar to the union
model of HTSeq-count (Anders et al., 2014) with one difference: we
include read mappings of the two cases marked as ambiguous by HTSeq-
count’s union model instead of discarding them (Supplementary Fig.
81). In the ﬁrst case, reads fully contained in the ﬁrst feature and over-
lapping the start of a second feature are associated to the ﬁrst feature. In
the second case, reads fully contained in two overlapping feature are
counted proportionally for each of the overlapped features.

In addition to the general export functionality, the TPM or RPKM-value
distribution of the analyzed data set can be visualized in a log-scaled
histogram (see Figure 2). All bin borders are dynamically calculated
according to the percentage they contribute to the result.

2.3. TSS Analysis

The transcription start site (TSS) detection has been substantially en-
hanced towards a more detailed analysis of TSS properties. In some
cases the coverage increases in steps at a TSS. To consider this case, an
option was implemented to associate all predicted TSSs within a small
user-deﬁned bp window to the statistically most signiﬁcant TSS. Hereby,
neither several predicted TSS appear for one gene, nor is any of them
lost.

To identify at a glance if evidence for alternative TSSs exist, all identi-
ﬁed TSSs within a user deﬁned window are classiﬁed. The statistically
most signiﬁcant position is designated as "primary" TSS, while all other
TSSs on the same strand are marked as "secondary". In many microbial
organisms the majority of transcripts contains a leader, but transcripts
can also be leaderless (Pfeifer-Sancar et al., 2013). To distinguish both
cases easily, leaderless transcripts are ﬂagged in the result and can thus
be retrieved instantly. The maximum distance of a TSS to the actual
translation start site can be adjusted in the wizard. To offer a deeper
insight into novel transcripts identiﬁed by the analysis, the T88 detection
further computes the next start codon on the respective strand, the leader
length and the next in-frame stop codon. The novel transcript length is
deduced from the assigned start and stop codons. Another new feature is
the option to conﬁgure the length of exported upstream and downstream
regions for promoter analysis.

2.4. Differential Gene Expression with DESeq2

To offer easy access to one of the most recent analysis tools for differen-
tial gene expression analysis, we added DESeq2 (Love at al., 2014) to
the set of integrated tools. With baySeq (Hardcastle and Kelly, 2010) and
the original DESeq (Anders and Huber, 2010) already integrated,
Reaprlorer 2 offers three widely used analysis tools for identifying
differentially expressed genes. The settings for the analysis can be easily
speciﬁed by a step-by-step wizard in the same fashion as for the already
integrated tools (Supplementary Fig. 82-86).

113 /310'smumofplogxosoparulogurorq/ﬁdnq 11101; papaommoq

91oz ‘Og isnﬁnv uo ::

 

 

 

 

4 III

g r
M Legend

 

I
386500

iPAOS‘IQ -1
— — —-2

 

M Legend M Options
lUU

 

100

L.
'

 

100 100

 

 

 

Dad'boa'd st Pseudomonas aemginosa PADl: 2014 ncbi gbk Bi  E I Delaﬂed'ﬂewer W
r

 

 

 

 

ColoIHishg'am

Widoonj'iZD-on-Pﬁﬂljokjirhendedbam Bi  Rnferamefaafum'ﬂlirﬂm I El
1 m r TYPE
B Locus: PA0343
wand : Gene:
, , , , , , , , i am:
33550:: 335150 335000 386250 386500 Stop:
——-
——-
————- acme:
——-

 

 

 

 

 

 

 

 

P‘I'OdJCt: hypoliieh'al protein A

 

 

 

 

v

sum

Parents: PA0343

 

 

llllllllliiil

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

—

—

_

—

—

—

—

—

—

| —

I —

I—

I —

I —

I —

I —

I —

I —

I —

I —

I —

I —

I —

I _

I —

= —

E Read Pa'r Delis

: I res: No children
: Read Par 1
I u ' '
I Type. Unique Enlarged Pair
I hes: 1
E Dis' lance: 1131
-
= Mapping 1. —Type. Single Best Match, — Start. 385392,r —Stop. 3854911,r —Clnenlahon. Forward
= Mapping 2: —Type: Single Best Match, — Start: 385423, —Stop: 385523, —Clnenlahon: Reverse elntenral Window I El
-
-
- __
- — ——_ I
- — —_ Laﬁ' 
- — ——_
= — ——

— ——- - I
- — ——
= — ——
- — —— WEE SI:
- — —— p0
- — ——
- — ———
- — —-
- —
—— .

- — — — “Side feat-res-
- — ——
- — — —
- — —— ms; 2 A
- — ——
- — ——_ 7
- — _—
- — ——
- — — — Wm M
- — ——
- — — — 513.13.
- — _— '
- — —_
- — —— — Il— G .I— CTG .r' ATG
_ _ —— _
_ — ——_
— — ——— Stops:
_ _ ——
_ — —
_ — — —
_ — V

 

 

 

- GASV GASV Window 3

Imported fable From: 0?_B420—on—PAO1.jok_eirl:ended.bam.gasu.in.dusters x

musherJD: LePtCi'ir: LeftBreald’ointSfart: LeftBreald’oinﬂEnd:

   
 

 

i
31
E.“

 

1'

Figure 3: Visualization of genome rearrangement events using GASV (Sindi ef al., 2009). Reaprlorer 2 offers an effortless exploration of
the data underlying the genome rearrangements detected by GASV (table at the bottom). The region of the deletion selected in the table
is centered simultaneously in the reference, track and read pair viewer. In the example, the hypothetical protein PA0343 is deleted in P.
aeruginosa strain B420 from the study by (Hilker ef al., 2015). No reads map to the corresponding region of P. aeruginosa PAO1 and
many read pairs are observed in B420 with an enlarged distance of about 1200bp instead of the expected 300bp.

2.5. Genome Rearrangement Detection

Genome rearrangements or structural variations (SVs) are associated to
many diseases including cancer (Iafrate et al., 2004). In addition, ge-
nome rearrangement detection is useful for the phylogenetic analysis of
eukaryotic and prokaryotic organisms.

In general, the tools for SV detection are command-line based. Integrat-
ing an established SV detection tool into Reaprlorer 2 makes genome
rearrangement detection accessible for researchers unfamiliar with
command-line tools and enables immediate visual inspection of read pair
conﬁgurations in genomic regions with predicted SVs (see Figure 3).

We chose GASV 2.0 (Sindi et al. , 2009,
http://compbio.cs.brown.edu/projects/gasvl) for integration. Its develop-
ment focused on the human genome, but it has also been tested success-
fully on other genomes like yeast (Zeitouni et al., 2010). GASV supports
a broad range of rearrangements: insertions, deletions, inversions, trans-
locations and can handle more divergent rearrangement events i.e.
resulting from multiple rearrangements at the same locus.

To guarantee ﬂexibility for the user, the GASV wizard in Reaprlorer 2
offers all options available for the command line version of GASV.

Note that only Single Perfect Match and Single Best Match mappings are
allowed for the GASV analysis. Testing different mapping classiﬁcations
with different example data sets showed that it is inevitable to use only
these two classes to produce reasonable results. Otherwise, repeat re-

gions lead to many false positive rearrangement predictions obscuring
the correct predictions.

2.6. Correlation Analysis

A correlation coefficient can be used to identify regions of two tracks
mapped to the same reference showing very similar or completely differ-
ent coverage to identify similarities and differences in the data sets
automatically. Two exemplary applications are: The comparison of 2
RNA-Seq data sets (e.g. a whole transcriptome and a 5’ enriched one) to
identify all TSS regions correlating in both tracks or retrieval of all
genomic regions with correlating expression patterns. To compare 2
tracks, we divide the genome into intervals of user defined length and
perform statistical correlation analysis of the coverage value pairs for
each position within each interval. The options are conﬁgured on a single
wizard page, where the user can choose the correlation method and
additional parameters. The two implemented methods to calculate the
correlation coefﬁcient are (i) the Bravais-Pearson (Pearson, 1895) prod-
uct-moment and (ii) the Spearman’s rank (Spearrnan, 1904) correlation
coefﬁcient.

Spearman’s rank correlation coefﬁcient has the advantage that no as-
sumptions on the underlying probability distribution have to be made and
no linear relationship is required between the random variables.

2.7. Visualization of Split Read Mappings

113 /310'sraumofplogxosogarulogurorq/ﬁdnq 11101; papaorumoq

9mg ‘05 isnﬁnv uo ::

For a correct visualization of eukaryotic RNA-Seq reads spanning an
exon-intron boundary, the user interface was enhanced to display split
read mappings in the Track Viewer, the Alignment Viewer and the
Histogram Viewer. Analysis functions also take the mapped blocks of
split read mappings into account.

2.8. Other Analysis Enhancements

Minor, but notable new features include: (i) Each analysis now offers the
option to select the strand on which the reads are mapped in relation to
genomic features (same, opposite or combine reads of both strands). (ii)
The read classes of the reads used for an analysis can be selected and a
minimum mapping quality threshold (PHRED scale) can be set. (iii) All
analysis results that are displayed in a tabular form can be exported as a
CSV ﬁle in addition to the XLS export. (iv) The SNP detection was
enhanced by base quality filter options (minimum average and minimum
PHRED scaled base quality) and a minimum average mapping quality
option. (v) The coverage analysis offers a button to export the underlying
sequences of the intervals identified by the analysis to use them for
downstream analyses (e.g. motif search, BLAST). (vi) The feature
coverage analysis additionally lists the mean interval coverage. (vii) For
reproducibility, each exported analysis table contains the Reaprlorer
version number it was created with. Reaprlorer 2 is now based on Java
1.8 and Netbeans Platform 8. For an easy installation we offer stand-
alone installers with an integrated Java Runtime Environment for Win-
dows, Linux and Mac OS X.

3.1. Command Line Interface

In order to cope with data sets consisting of many tracks and to enable
the integration of Reaprlorer 2 into automatic analysis pipelines, the
software now provides a command line interface (CLI).

Via this new interface it is possible to concurrently import reference and
mapping ﬁles, perform analyses and export results by providing corre-
sponding parameters without the need for user interaction. Thus, execut-
ing a whole workﬂow is less time consuming than before. For the sake of
usability all import and analyses preferences can be set in a separate
conﬁguration ﬁle which can be reused for future analyses.

This new feature allows command line users an easy and ﬂexible inte-
gration of Reaprlorer 2 in any command line pipeline or automatic
analysis scripts.

3.2. Rserve Integration

For the differential gene expression analysis Reaprlorer 2 primarily
relies on established tools only available for GNU R (R Core Team,
2014). In order to use these tools a Java to GNU R interface is needed. In
Reaprlorer 2 we changed this interface to Rserve (Urbanek, 2003),
offering an easier setup and a more stable execution of the analysis tasks.
On Windows machines an automatic setup is offered, for Linux and Mac
OS X the connection to an Rserve instance can easily be conﬁgured via
the options menu.

3.3. Other Implementation Enhancements

Reaprlorer 2 can import tabular results (CSV, XLS, VCF) either
created by itself or any other tool. This enables comparisons of ReadX-
plorer 2 generated results with the results created by other established
tools and offers ﬂexible visualization of analysis results from command-
line tools.

A link was added for cross-linking genomic features with an EC-number
to a user configurable enzyme database (default: ExPASy,
http://www.exnasv.org/).

 

The graphical user interface now offers a detailed viewer for combined
tracks. Additionally, the alignment view of the detailed viewer is now
zoomable and the bases are colored based on quality. The track viewer
supports additional feature types for displaying (ncRNA, 5'UTR, 3'UTR,
RES, -3 5_signal, -10_signal) and offers a new option to display all reads
from both strands on the forward or reverse strand only. This is especial-
ly useful for visualizing data sets originating from non-strand-speciﬁc
RNA-Seq experiments.

The complete mapping statistics of all tracks can now be exported from
the database.

3.4. Web Service

To ease the use of Reaprlorer 2, we added it to the toolbox of our
Galaxy server at https://www.computationalbio.uni-giessen.de/galmﬁ
The server is available for registered users only, but registration is free of
charge. Here, we use the CLI to automatically create a Reaprlorer
database for the user data and allow downloading the full data package
after project calculation.

112 Bro'sreulnoprOJxo'soiiemJOJuioiw/zdnq IIIOJJ pepeorumoq

9IOZ ‘09 lsnﬁnV uo ::

 

 

 

 

 

 

 

 

 

 

 

 

 

 

  
 

 

+3 — — — — — — — — — — — — — — — — — — — — — — — _+3 +3 — — — — — — — — — — — — — — — — — — — — — +3
+2 — — — — — — — — — — — — — — — — — — — — — — — —+2 +2 — — — — — — — — — — — — — — — — — — — — — +2
+1 — — — — — — — — — — — — — — — — — — — — — — — —+1 +1 — — — — — — — — — — — — — — — — — — — — — +1
r411?an 1 1413:1110 r 1411400 I 14155011 I 14136111: I 14151011 ‘ 1411731111 madam I 1m ' 1911-13251:
-1————- .—-1 -1 — — — — — — — — — — — — — — — — — — — — —-1
-2 — — — — — — _ _ _ _ _ _AI46.1251D _ _ _ _ _ _ _ _-2 .2_ a L _ -2
-3 _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _-3 .3 _ _ _ _ _ _ _ _ $15046900 _ _ _ _ _ _ _ _ -3
2m Col0-1, unique reads onlyr m m Colo-1, unique reads only 1m
1:10 1110 1110 101:1
mo  !m1 1 ' Ff 1110 1110 TR“ 100
2110 2110 2110 ‘ 1 ' zoo

 

 

2m Colo-1, extended classiﬁcation Col0-1. extended classiﬁcation

1.00 100 11111 100

 m. a.
200 I 200 200
Figure 4: The difference of the read coverage between only uniquely mapped reads (middle row) and using the “Single Perfect Match” and
“Single Best Match” mapping classes is shown for the genes AT5G46900 and AT4G12510 (upper row). In total numbers 144 and 78 more

 

 

 

 

 

 

    
 

"7'1 2011

‘Lr._,_

reads can be included in the analysis respectively when using the extended read mapping classification.

Resuhs

We used Reaprlorer 2 for the evaluation of an Arabidopsis thaliana
RNA-Seq test data set that was generated for this purpose. Several of the
aspects described above were addressed, namely extended read classifi-
cation, improved handling of eukaryotic data and the DESeq2 integra-
tion. The experiment focused on differential gene expression analysis
between the A. thaliana Col-0 wild-type and a myb11-12-111 triple-
mutant line (Supplementary methods); array-based data for this biologi-
cal material are available (Stracke et al., 2007). Three biological repli-
cates, each of them consisting of two technical replicates, were created
from wild-type and mutant each. The 12 samples produced ~183 million
usable reads that were mapped to the TAIR 10 A. thaliana Col-0 refer-
ence. Besides visual inspection, we started the analysis with a “read
count and normalization calculation”, to check the integrity of the bio-
logical and technical replicates. This was achieved by plotting their TPM
values against each other to check for correlation (Supplementary Fig.
S7). For all except one technical replicate, the resulting expression
values corresponded to each other (were located close to the 450 diago-
nal). Thus, the problematic technical replicate was excluded from further
analysis. Further investigation showed that in the problematic sample
rRNA removal was incomplete. This experimental complication occurs
at low frequency with the RNA-Seq kits from Illumina.

To identify differentially expressed genes between the wild type and the
mutant and simultaneously monitor the effect of employing the extended
read mapping classiﬁcation, we applied DESeq2 via Reaprlorer 2
twice with different included read mapping classes. Once, we only used
the uniquely mapped reads and in the second case, we used the Single
Perfect and Single Best Match mapping classes — also including reads
with a distinctive best mapping. The latter selection enabled us to include
on average 1,400,000 more reads per data set in the analysis (Supple-
mental Table Sl), leading to more accurate gene expression values and
minimizing underestimation of expression levels. This effect can be
observed even in the most differentially expressed genes (Figure 4). Two
examples are the genes AT5G46900 and AT4G12510. Their mean ex-
pression is increased from 299 to 379 reads in the ﬁrst case and from 135
to 189 reads in the second case. These and other examples (Supplemen-
tary Table S2) convincingly show that the level of differential gene
expression is underestimated if only uniquely mapped reads are used. In
total, the expression of 13,850 of all 28,775 annotated genes is underes-
timated. Of these, 1896 genes can be assigned > 100 and 153 genes >

1000 additional mappings when applying the extended read classiﬁca-
tion. The comparison of the DESeq2 results between only incorporating
uniquely mapped reads and using the Single Perfect and Single Best
Match mapping classes is shown in Supplementary Table S3.

Additionally, we show in Supplementary Table S4 that Reaprlorer 2
offers several unique features and combines many useful features that are
not present in this composition in one of the other commonly used read
mapping visualization tools like Savant (Fiume et al., 2012), IGB (Nicol
et al., 2009), Artemis (Carver et al., 2012), IGV (Robinson et al., 2011)
and GenomeView (Abeel et al., 2012).

Finally, we assessed the performance of analysis functions offered by
Reaprlorer 2. We benchmarked the performance on small (~6 mb),
medium (~120 mb) and large (~3 gb) reference genomes (Supplementary
Table SS). This assessment also includes a comparative runtime bench-
mark between Reaprlorer 1 and Reaprlorer 2 (Supplementary Table
S6). The results show that on the same hardware the new version of our
software signiﬁcantly outperforms the older release when the same tasks
are executed.

Discussion

The comprehensive read mapping data visualization and automatic
analysis tool Reaprlorer 2 features substantially enhanced capabilities
from one source. The major improvement presented here is the extended
read mapping classiﬁcation which leads to more speciﬁc analysis results
as shown in the results section. Further, the extended classiﬁcation
enables meaningful integration of multiple mapped reads and creates
awareness for the different types of multiple mapped reads, e. g. to identi-
fy repetitive regions (Figure 1). Moreover, two newly implemented
analysis functions and substantial improvement of existing analyses
widen the spectrum covered by Reaprlorer 2 and enable the user to
screen for genome rearrangements and correlation between two data sets
without the need to install additional software. The read count normali-
zation can now be compared between different samples as the added
TPM normalization is invariant between samples. With DESeq2 another
widely used differential gene expression analysis package is available
from within the software. The enhanced TSS detection allows deeper
insights into the T88 landscape by analyzing additional properties of the
T88 and presenting them to the user. The application range of ReadX-
plorer 2 is further broadened by improving the handling of eukaryotic
data.

113 /310'sraumofploixosoiiawloiuroiqj/zdnq 11101; papaorumoq

9mg ‘05 isnﬁnv uo ::

Using our A. thaliana RNA-Seq data set, we were able to successfully
evaluate the new features and could show that the enhanced read classi-
ﬁcation helps to improve the analysis results. With the new command
line interface, integration into automatic analysis pipelines is enabled.
This allows handling experiments with many samples more efﬁciently
than in the graphical user interface as only a single command is needed
to import all data and subsequently run all desired analyses. Finally,
integration of results from multiple tools and viewing the read mapping
data along with analysis results is important for researchers. Therefore,
the new possibility to import arbitrary data tables starting with a genomic
position column aids this need.

Acknowledgements

The authors thank the members of the Bioinformatics Core Facility
(BCF) of the Justus-Liebig University Giessen, the members of the
Genome Research Team and the Bioinformatics Resource Facility (BRF)
at the Bielefeld University for their excellent assistance and support.

Funding

This work has been supported by the German Center for Infection Re-
search (DZIF) project ‘DZIF Bioinformatics Platform’ 8000 701-3
(HZI), by the BMBF grant FKZ 031A533 within the de.NBI network, by
the CLIB-Graduate Cluster Industrial Biotechnology co-ﬁnanced by the
Ministry of Innovation of North Rhine-Westphalia and by the LOEWE
focus group Medical RNomics (State of Hessen, Germany).

Conﬂict of Interest: none declared.

References

Abeel,T. et al. (2012) GenomeView: a next-generation genome browser.
Nucleic Acids Res., 40, e12—e12.

Amman,F. et al. (2014) TSSAR: TSS annotation regime for dRNA-seq
data. BMC Bioinformatics, 15, 89.

Anders,S. and Huber,W. (2010) Differential expression analysis for
sequence count data. Genome Biol, 11, R106.

Bentley,D.R. et al. (2008) Accurate whole human genome sequencing
using reversible terminator chemistry. Nature, 456, 53—9.

Buchan,B.W. and Ledeboer,N.A. (2014) Emerging Technologies for the
Clinical Microbiology Laboratory. Clin. Microbiol Rev., 27,
7 83—822.

Carver,T. et al. (2012) Artemis: an integrated platform for visualization
and analysis of high-throughput sequence-based experimental
data. Bioinformatics, 28, 464—469.

Dugar,G. et al. (2013) High-resolution transcriptome maps reveal strain-
speciﬁc regulatory features of multiple Campylobacter jejuni
isolates. PLoS Genet, 9, e1003495.

Fiume,M. et al. (2012) Savant Genome Browser 2: visualization and
analysis for population-scale genornics. Nucleic Acids Res. ,
40, W615-621.

Goldberg,B. et al. (2015) Making the Leap from Research Laboratory to
Clinic: Challenges and Opportunities for Next-Generation
Sequencing in Infectious Disease Diagnostics. mBio, 6.

Hardcastle,T.J. and Kelly,K.A. (2010) baySeq: empirical Bayesian
methods for identifying differential expression in sequence
count data. BMC Bioinformatics, 11, 422.

Hilker,R. et al. (2015) Interclonal gradient of virulence in the Pseudo-
monas aeruginosa pangenome from disease and environment.
Environ. Microbiol, 17, 29—46.

Hilker,R. et al. (2014) Reaprlorer - Visualization and Analysis of
Mapped Sequences. Bioinformatics, 30, btu205.

Iafrate,A.J. et al. (2004) Detection of large-scale variation in the human
genome. Nat. Genet, 36, 949—51.

J orj ani,H. and Zavolan,M. (2014) TSSer: an automated method to identi-
fy transcription start sites in prokaryotic genomes from dif-
ferential RNA sequencing data. Bioinforma. Oxf Engl, 30,
97 1—97 4.

Koboldt,D.C. et al. (2012) VarScan 2: somatic mutation and copy num-
ber alteration discovery in cancer by exome sequencing. Ge-
nome Res., 22, 568—576.

Li,B. et al. (2010) RNA-Seq gene expression estimation with read
mapping uncertainty. Bioinforma. Oxf Engl, 26, 493—500.

Li,J. et al. (2015) Global mapping transcriptional start sites revealed both
transcriptional and post-transcriptional regulation of cold ad-
aptation in the methanogenic archaeon Methanolobus psy-
chrophilus. Sci. Rep., 5, 9209.

Love,M.I. et al. (2014) Moderated estimation of fold change and disper-
sion for RNA-seq data with DESeq2. Genome Biol, 15, 550.

Margulies,M. et al. (2005) Genome sequencing in rnicrofabricated high-
density picolitre reactors. Nature, 437, 376—80.

McClure,R. et al. (2013) Computational analysis of bacterial RNA-Seq
data. Nucleic Acids Res., 41, e140—e140.

Mortazavi,A. et al. (2008) Mapping and quantifying mammalian tran-
scriptomes by RNA-Seq. Nat. Methods, 5, 621—8.

Nicol,J.W. et al. (2009) The Integrated Genome Browser: free software
for distribution and exploration of genome-scale datasets. Bi-
oinformatics, 25, 2730—2731.

Pearson,K. (1895) Notes on regression and inheritance in the case of two
parents. In, Proceedings of the Royal Society of London, pp.
240—242.

Pfeifer-Sancar,K. et al. (2013) Comprehensive analysis of the Coryne-
bacterium glutamicum transcriptome using an improved
RNAseq technique. BMC Genomics, 14, 888.

R Core Team (2014) R: A Language and Environment for Statistical
Computing.

Reuter,J.A. et al. (2015) High-Throughput Sequencing Technologies.
Mol. Cell, 58, 586—597.

Robert,C. and Watson,M. (2015) Errors in RNA-Seq quantiﬁcation
affect genes of relevance to human disease. Genome Biol, 16,
177.

Robinson,J.T. et al. (2011) Integrative genornics viewer. Nat. Biotech-
nol, 29, 24—26.

Sindi,S. et al. (2009) A geometric approach for classiﬁcation and com-
parison of structural variants. Bioinforma. Oxf Engl, 25,
1222-30.

Spearman,C. (1904) The Proof and Measurement of Association between
Two Things. Am. J. Psychol, 15, 72—101.

112 Bio'sreumofpmJXO'sogeuuoiuioiq/ﬁd11q 111011 pepeorumoq

9IOZ ‘09 lsnﬁnV uo ::

 

Stracke,R. et al. (2007) Differential regulation of closely related R2R3-
MYB transcription factors controls ﬂavonol accumulation in
different parts of the Arabidopsis thaliana seedling. Plant J.,
50.

Trapnell,C. et al. (2010) Transcript assembly and quantiﬁcation by
RNA-Seq reveals unannotated transcripts and isoform switch-
ing during cell differentiation. Nat. Biotechnol, 28, 511—5.

Treangen,T.J. and Salzberg,S.L. (2012) Repetitive DNA and next-
generation sequencing: computational challenges and solu-
tions. Nat. Rev. Genet, 13, 36—46.

Urbanek,S. (2003) Rserve - A Fast Way to Provide R Functionality to
Applications. Proc. DSC.

Zeitouni,B. et al. (2010) SVDetect: a tool to identify genomic structural
variations from paired-end and mate-pair sequencing data.
Bioinforma. Oxf Engl, 26, 1895—6.

112 Bio'sreumofpmJXO'soi112u1101uioiq”:d11q 111011 pepeorumoq

9IOZ ‘09 lsnﬁnV uo ::

