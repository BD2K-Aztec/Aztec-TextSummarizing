ORIGINAL PAPER

Vol. 30 no. 13 2014, pages 1858-1866
doi: 1 0. 1093/bioinformatics/btu128

 

Gene expression

Advance Access publication March 10, 2014

A personalized committee classification approach to improving
prediction of breast cancer metastasis

Md Jamiul Jahid‘, Tim H. Huan92’3 and Jianhua Ruan1’3’*

1Department of Computer Science, University of Texas at San Antonio, San Antonio, TX 78249, USA, 2Department of
Molecular Medicine and 8Cancer Therapy & Research Center, University of Texas Health Science Center, San Antonio,

TX 78229, USA

Associate Editor: Janet Kelso

 

ABSTRACT

Motivation: Metastasis prediction is a well-known problem in breast
cancer research. As breast cancer is a complex and heterogeneous
disease with many molecular subtypes, predictive models trained for
one cohort often perform poorly on other cohorts, and a combined
model may be suboptimal for individual patients. Furthermore, at-
tempting to develop subtype-specific models is hindered by the am-
biguity and stereotypical definitions of subtypes.

Results: Here, we propose a personalized approach by relaxing the
definition of breast cancer subtypes. We assume that each patient
belongs to a distinct subtype, defined implicitly by a set of patients
with similar molecular characteristics, and construct a different
predictive model for each patient, using as training data, only the
patients defining the subtype. To increase robustness, we also
develop a committee-based prediction method by pooling together
multiple personalized models. Using both intra- and inter-dataset
validations, we show that our approach can significantly improve the
prediction accuracy of breast cancer metastasis compared with
several popular approaches, especially on those hard-to-learn
cases. Furthermore, we find that breast cancer patients belonging to
different canonical subtypes tend to have different predictive models
and gene signatures, suggesting that metastasis in different canonical
subtypes are likely governed by different molecular mechanisms.
Availability and implementation: Source code implemented in
MATLAB and Java available at www.cs.utsa.edu/~jruan/PCC/.
Contact: jianhua.ruan@utsa.edu

Supplementary information: Supplementary data are available at
Bioinformatics online.

Received on August 30, 2013; revised on February 13, 2014; accepted
on March 1, 2014

1 INTRODUCTION

Recently, large-scale proﬁling techniques such as microarray and
next-generation sequencing have enabled systematic screening of
genomic, epigenomic and transcriptomic changes associated with
cancer. These data have been used for disease prognosis and
outcome prediction with an accuracy comparable or superior
to conventional histological grading-based methods (Chang
et al., 2004; Sorlie et al., 2001; Sotiriou et al., 2006; van de
Vijver et al., 2002; Wang et al., 2005). However, it is well
known that cancer is a heterogeneity disease and that cancers

 

*To whom correspondence should be addressed.

occurring at the same tissue or organ can have multiple subtypes
with distinct molecular signatures and likely have different
prognosis and treatment responses (Bianchini et al., 2010;
Heiser et al., 2011; Prat et al., 2010; Sorlie et al., 2001; Sotiriou
et al., 2006). Therefore, the overall performance of such prog-
nostic models is still poor.

An intuitive solution to address the aforementioned problem is
to design prognostic models separately for each cancer subtype.
This simple solution poses two problems. Firstly, the number of
available training samples becomes smaller, especially for
relatively rare subtypes, which unavoidably reduces the reliability
and stability of the classiﬁcation models. Secondly and more
importantly, this solution depends on well establishment of pre-
deﬁned cancer subtypes and unambiguous assignment of each
patient to some subtype. However, the deﬁnition of subtypes
may be ambiguous and evolve with time. For example, in a
series of studies, Perou and colleagues analyzed gene expression
proﬁles of primary breast tumors and deﬁned the subtypes of
breast cancer, termed luminal A, luminal B, normal breast-like,
basal, ErbB2 and more recently, Claudia-low, which have differ-
ent survival rates and responses to hormone treatment (Hennessy
et al., 2009; Sorlie et al., 2001, 2003). Studies on other datasets
have conﬁrmed some of the subtypes such as the basal-like and
ErbB2, but the deﬁnitions of the other subtypes are not always
consistent and are sensitive to the set of genes used and the set of
samples analyzed (Kapp et al., 2006; Mackay et al., 2011). It was
suggested that the “molecular subtypes’ of cancer may be a con-
tinuum (Lusa et al., 2007). Hence, attempting to identify distinct
subtypes may not be always appropriate.

In this article, we propose a generalization of the subtype-
based classiﬁcation idea. Instead of relying on explicit deﬁnition
of subtypes, we simply treat each patient as if he/ she belongs to a
different subtype and then construct multiple, personalized,
predictive models for each patient. These models are evaluated
for their performance in predicting the outcomes of the speciﬁc
patient, and only the good models are retained. When a new
patient comes, a set of patients of similar molecular characteris-
tics are chosen, so are their predictive models. The ﬁnal decision
is made by considering the predictions from all the selected
models.

Applying our method to three publicly available microarray
datasets of breast cancer for prediction of metastasis, we found
that our proposed personalized classiﬁcation method has much
better prediction accuracy than standard methods that either do

 

1858 © The Author 2014. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com

112 /310's113umo [p.IOJXO'SOllBIIHOJUTOTQ/ﬁdllq 11101; prBOIIIAAOG

910Z ‘091sn3nv uo ::

Personalized classification of breast cancer metastasis

 

not use cancer subtype information or use only the predeﬁned
cancer subtypes. Importantly, we found that our proposed
method signiﬁcantly improves cross-dataset prediction accuracy,
which is critical in clinical practice to predict disease outcomes.
Furthermore, our results show that different breast cancer
subtypes require different metastatic classiﬁcation models,
suggesting that the metastasis process in these different subtypes
are governed by different molecular mechanisms.

2 MATERIALS AND METHODS

2.1 Breast cancer datasets

In this study, we used three breast cancer microarray datasets
(see Supplementary Table S1 for cohort information). The ﬁrst dataset,
downloaded from the Netherland Cancer Institute (NKI) website
(http: //bioinformatics.nki.n1/index.php), (van de Vijver et al., 2002), con-
tains 295 primary breast carcinoma patients, where all patients were <53
years old and had stage I or II breast cancer. Among them, 151 had
lymph node—negative disease and the rest had lymph node—positive dis-
ease. In this dataset, 78 patients had metastasis within 5 years of follow-
up Visit. Therefore, we considered these 78 patients as metastatic patients
and the remaining ones as non-metastatic patients. The microarray plat-
form used for this dataset was Agilent Hu25K. To make the NKI dataset
compatible with the other two datasets, we used Entrez gene ID to map
different gene entries among the three datasets. In the NKI dataset, gene
expression values represent the log ratios between the signal intensities in
each patient relative to the average signal intensities of all patients. Table
1 shows the number of patients in each subtype deﬁned in Chang et al.
(2005) and Sorlie et al. (2003), with the total number of metastatic and
non-metastatic patients in each subtype. It is important to note that this
subtype information was never used in our model; rather, it was used only
for evaluation purposes. We only considered the top 1500 genes that had
the highest variances in NKI dataset among samples; however, increasing
the number of genes did not change the results signiﬁcantly.

The second dataset, referred to as Wang dataset, contains 286 lymph
node—negative breast cancer patients who had not received any adjuvant
systemic treatment (Wang et al., 2005). Among them, 106 patients had
distant metastasis within 5 years of follow-up checkup and were
considered as metastatic patients in our analysis, whereas the rest were
considered as non-metastatic patients. The microarray platform used was
Affymetrix HG—U133a. This dataset was obtained from Gene Expression
Omnibus with the accession number GSE2034 (Edgar et al., 2002).
To make the dataset compatible with the NKI dataset, the signal inten-
sities in the Wang dataset were converted to log ratios, where the ratio
was calculated between the signal intensity of a gene in a particular
patient to the average intensity of that gene in all patients.
Then z-score transformation was performed for each patient for both
datasets, so that the mean log ratio for each patient was 0 and the
standard deviation was 1.

The last dataset was downloaded from the University of North
Carolina (UNC) Microarray Database, and contains 337 samples, but

Table 1. Subtype information for NKI dataset

 

 

Subtype Number of patients Metastatic Non-metastatic
Normal 31 3 28
Basal 46 16 30
Luminal A 88 15 73
Luminal B 81 24 57
ErbB2 49 20 29

 

we only used 116 patient samples that had at least 5-year follow-up clin-
ical data (Prat et al., 2010). Similar to the previous two datasets, we
considered 5-year follow-up disease status to distinguish between meta-
static and non-metastatic patients and obtained 75 metastatic and 41 non-
metastatic patients. The microarray platform used for this dataset was
Agilent oligo microarray and was downloaded from Gene Expression
Omnibus with the accession number GSE18229 (Edgar et al., 2002).
Similar to the NKI and Wang datasets, a z-score transformation was
performed to each patient in the dataset. The Wang and UNC datasets
were used to evaluate models learned from the NKI dataset.

2.2 Personalized committee classiﬁcation algorithm

Figure 1 shows an overview of our approach. For each patient (PTmm) in
the training dataset (NKI), we constructed a set of classiﬁers, known as
base classifiers, using only patients whose gene expression proﬁles were
similar to that of PTmm as training samples. We call PTmm a representing
patient for these base classiﬁers. To select training samples, we created a
patient—patient network based on co-expression, and used a well-known
graph algorithm to identify patients that are topologically close to the
representing patient in the network. Each base classiﬁer was then
evaluated for its prediction accuracy on its representing patient and
was discarded if the prediction was incorrect. This procedure was
repeated for all patients in the training dataset, resulting in a rich pool
of classiﬁers that could be used for predictions in the test dataset. New
patients were classiﬁed by a subset of these base classiﬁers chosen based
on the similarity between the target patient and the representing patients
of the base classiﬁers, and predictions from individual base classiﬁers
were combined to form the ﬁnal decision. We call the whole classiﬁcation
model as personalized committee classiﬁer or PC—classifier for short.
Details of our method are described below.

2.2.] Training sample selection We believe that patients with similar
genetic characteristics may share common molecular mechanisms in dis-
ease development and progression, and can provide more accurate
models to predict disease outcomes of other similar patients, rather
than using all patients. Therefore, we only selected the most similar
patients to a target patient to construct its base classiﬁer. To retrieve
the most relevant patients to construct the classiﬁers, we constructed a
patient—patient network, where each patient is connected to its nearest
three patients based on Euclidean distance between patients’ gene expres-
sion proﬁles (Supplementary Fig. S1). Patient—patient co-expression net-
works have been shown capable of preserving the topological relationship
among patients and capturing cancer subtype information well (Ruan
et al., 2010). Given the network, we used a well-known graph algorithm,
random walk with restart, to calculate the similarity between every pair of
patients, measured by the probability for a random walker starting from
one node to reach another node in the network (Tong et al., 2006).
Formally, let A be the adjacency matrix of the patient—patient net-
work, where A,-J- = 1 if there is an edge between patient i and j, and let

P be the row normalized adjacency matrix, i.e. Pi]- = 21A“. Assume that a
,- y

 

random walker starts from node v with a uniform probability to Visit each
of its neighboring nodes, and with a ﬁxed probability c to revisit the
starting node v at any time point during the walk. The random walk
with restart algorithm can be applied to all patients simultaneously,
with a matrix form F = (1 — c)FP + cI, where I is an identity matrix.
On convergence, the element F,-]- of the square matrix F represents the
probability for a patient i randomly walking on the network to reach
patient j, given sufﬁcient amount of time (Tong et al., 2006). A higher
probability means topologically higher similarity between the two
patients.

After calculating the similarity scores between all patients, we used a
set of user-deﬁned cutoffs (o = 0.001, 0.0005, 0.0002, 0.0001 and 0.00005
in this study) to select ﬁve sets of neighbors for each patient

 

1859

112 /810's113umo [p.IOJXO'SSUBUHOJUIOIQ/ﬁdllq 11101; popeoIII/noq

9IOZ ‘091sn8nv uo ::

M.J.Jahid et aI.

 

  
 

 

(a) 5
I Training sample
I m
: selectlon
I Patient-patient network
 I PTest
I P Test
E PTest
I output . PTest
I PTest

page 7/ 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 
  

Testing

- Most similar patients in
training dataset for test patient
Ptest are sequentially

P2, PS’P7, P1  PN_1

I
I
I
I
I
:
I
I
I
I
I
I
l
I
' Base classiﬁers are ranked :
according to the similarity of :
I

I

I

I

I

I

I

I

I

I

I

I

I

I

I

I

I

I

{(1 s12 Aem

U3
9:
m
(D
O
,_.
m
m
m
,_..
Ch
(D
H
U:

test patient Ptest
- Here top ﬁve classiﬁers are
used for prediction of Ptest

O
O
S
3
0
PP
(D
G‘
_.
d
(I)
a.
5.
z
a

I’m-I -
PN- .-

 

Fig. 1. Overview of our approach. (a) Steps to construct PC-classiﬁer for patient P1 are shown. The classiﬁers for the remaining patients are constructed
similarly. (b) An external patient PR,” is classiﬁed based on top ranked ﬁve base classiﬁers. Note that PR,” is never included in the construction of any

classiﬁers in (a)

(see Supplementary Materials for rationale and supporting data on
parameter selection). A smaller cutoff will result in more neighbors
being selected (see Supplementary Figs S2 and S3 for example and
Supplementary Table S2 for statistics). Note that even with the same
cutoff, each patient may end up with different number of neighbors,
depending on the topology of the network (Supplementary Fig. S4).
Also, the only information used in this step is gene expression proﬁles,
without considering the predeﬁned cancer subtypes and the metastatic
status.

2.2.2 Base classifier COnSIruction As mentioned above, our method
established a pool of base classiﬁers, each of which was trained from a
subset of similar patients from the training dataset and personalized for a
speciﬁc patient. To improve robustness of the models, for each patient,
we identiﬁed several sets of similar patients using different cutoffs in the
training sample selection step and constructed one base classiﬁer from
each set of training samples. For example, with 020.001, we built 295
such classiﬁers, where each classiﬁer was built using a different number of
patients depending on the number of training samples a patient had in the
training sample selection step (Supplementary Fig. S4). Therefore, we
built (295 X 5 =) 1475 such classiﬁers with ﬁve cutoffs. Next, we removed
those base classiﬁers that failed to predict the metastatic status of the
representing patient. Finally, to make better use of all data points, we
retrained each of the remaining correct base classiﬁers using both, the
representing patient and the previously selected training samples. This
gives us a pool of validated base classiﬁers for future classiﬁcation of
new patients.

For example, as illustrated in Figure 1, for patient P1, we collected ﬁve
sets of training samples that can be reached from P1 with certain prob-
abilities. These samples were used to construct ﬁve base classiﬁers for P1.
As the classiﬁer resulted from 0‘2-S616Ct6d samples had incorrect classiﬁ-
cation result for P1, it was removed from further consideration. We then
retrained the four remaining classiﬁers after adding P1 to the original
training data and stored the new classiﬁers for future uses. We repeated
this procedure for every patient in the training dataset. In this work, we
used NKI dataset as training dataset and established 991 base classiﬁers.

Support vector machine (SVM) was used as the underlying base clas-
siﬁer. We used the SMO implementation of SVM in WEKA (version
3.6.3; Hall et al., 2009) and used its linear kernel with all default param-
eter settings. Classiﬁcation output was ﬁtted using a logistic regression
model, which is included in the WEKA implementation, to predict the
probability of metastasis (Hall et al., 2009).

2.2.3 Committee-based classification To use the pool of base clas-
siﬁers to classify new patients, we developed a committee classiﬁcation
approach. As illustrated in Figure 1, to classify a new patient (PTest), we
ranked all the available base classiﬁers based on the similarity between
PR,” and the representing patients used to construct these base classiﬁers.
Ties were broken according to the decision probability to make a correct
prediction for the representing patient. Then we used the top-ranked N
models to classify PR,” and used the average decision probability to
predict its metastatic status. Note that using weighted average does not
change the results signiﬁcantly.

2.3 Performance evaluation and comparison with com-
peting methods

To measure the intra—data classiﬁcation performance for PC-classiﬁers,
we used the leave-one—out evaluation technique. Brieﬂy, we took out one
patient (Ptest) from the NKI dataset and constructed a PC-classiﬁer with
the remaining patients as training samples, and used the classiﬁer to
predict the probability for Pres, to develop metastasis. This step was re-
peated for all patients in the NKI dataset, and the predictions for all
patients were pooled to measure the performance. It is worth mentioning
that in this evaluation, Pm, was never used in any step for constructing
the PC-classiﬁer. For comparison, standard SVM classiﬁers and subtype-
based SVM classiﬁers were also constructed. For standard classiﬁers, we
constructed a SVM classiﬁer for each Ptes, patient using the remaining K
—1 patients as training data, where K is the total number of patients in
NKI dataset. For subtype-based classiﬁers, we constructed an SVM clas-
siﬁer for Ptes, by using only the patients of the same subtype as Pm, as
training samples. In other words, if Ptes, is a basal type patient, then for

 

1860

112 /810's112umo [p.IOJXO'SOIlBIIIJOJUIOIQ/ﬂdllq 1110131 pop1201umoq

9IOZ ‘091sn8nv uo ::

Personalized classification of breast cancer metastasis

 

subtype-based classiﬁer, we constructed an SVM classiﬁer with the other
basal type patients except Ptest.

To evaluate the performance of PC-classiﬁer in cross-data scenario, we
constructed base classiﬁers using the whole NKI dataset, and later used
them to classify patients in the Wang and UNC datasets based on the
committee classiﬁcation approach. To compare, we also constructed a
single standard SVM classiﬁer using the entire NKI dataset and tested its
performance on the Wang and UNC datasets. The subtype-based classi-
ﬁers were not tested here as subtype information for the Wang cohort,
and some patients in the UNC cohort are not available.

Several ensemble classiﬁers were also constructed and evaluated both
for intra-data and inter-data classiﬁcation. We tested four popular en-
semble classiﬁerszBagging, Dagging, AdaBoost and Random Forest
(Beriman, 1996; Freund and Robert, 1996; Ting and Witten, 1997).
Both Bagging and Dagging work by randomly selecting a subset of sam-
ples to construct base classiﬁers. The difference between the two is that
Bagging allows sampling with replacement, whereas Dagging only per-
mits sampling without replacement, and as a result, the latter creates a
number of disjoint partitions from the data. AdaBoost builds multiple
base classiﬁers by iteratively giving priority to previously misclassiﬁed
samples. Random Forest constructs a multitude of decision trees and
outputs the class label predicted by these trees. To have a fair comparison
with our method, we used SVM as the underline base classiﬁer for these
ensemble classiﬁers except for random forest, which uses decision tree as
underlying base classiﬁer by design. For Dagging, we used 10 partitions
to ensure having enough number of training samples in each base classi-
ﬁer. For AdaBoost, we used 500 classiﬁers, as the performance seems to
be independent of the number of classiﬁers after some initial burn-in
period. For all other ensemble classiﬁers, we varied the number of base
classiﬁers from 1 to 900 and compared the performance of the algorithms
as the number of base classiﬁers increased. Similarly, as for the standard
SVM classiﬁer, leave-one-out cross-validation was used for the NKI
dataset, whereas Wang and UNC datasets were tested using models
developed from the NKI dataset.

Classiﬁcation performance was measured using several commonly
used evaluation methods including positive predictive value, negative
predictive value, kappa statistic and area under receiver operating charac-
teristic (ROC) curve (area under curve, AUC). Let N be the total number
of patients, and T P, TN, FP and FN be the numbers of true-positive
(metastatic patient), true-negative (non-metastatic patient), false-positive
and false-negative predictions, respectively, made by a classiﬁer at a cer-
tain threshold of the decision probability. Positive predictive value (PPV)
is deﬁned as PPV = T P/ (T P + FP), and negative predictive value (NPV)
deﬁned as NPV = T N / (T N + FN). To enable a straightforward compari-
son among all methods, the decision probability was set differently for
each classiﬁer so that the positive predictive rate (ijtFP) is approximately
the percentage of metastatic patients in the three datasets combined
(37%). The kappa statistic (Landis and Koch, 1977) is a ‘corrected’ ver-
sion of accuracy, deﬁned as K = (A — C) / (1 — C), where A = w is the
overall accuracy, and C is the expected accuracy that a classiﬁer can
achieve by chance and can be calculated by
C = (THFPXTP‘LFMXéTN+FN)(TN+FP). Finally, the ROC curve plots the
true-positive rate (%V) versus false-positive rate ($) at various
threshold settings of the decision probability and shows the trade-off
between sensitivity and speciﬁcity. The AUC is a widely used statistic
for model comparison. A perfect model will have an AUC of 1 and
random guessing will score an AUC around 0.5. For each classiﬁer, we
repeated the experiment 100 times and measured the mean AUC and
standard error of the mean.

 

 

2.4 Biological signiﬁcance analysis

To reveal the biological signiﬁcance of PC-classiﬁers, we clustered the
base classiﬁers based on the similarity of their normalized SVM coefﬁ-
cients. For this analysis we used the correct base classiﬁers with

o = 0.0005. The SVM coefﬁcients for each base classiﬁer were normalized
to z-scores. For clustering, we used the hierarchical clustering algorithm
implemented in the MATLAB 8.0 Bioinformatics Toolbox (The
MathWorks, Inc.). For literature mining, we searched the PubMed ab-
stracts with the gene name together with the term ‘metastasis’ or ‘meta-
static’ and reported the number of published articles retrieved.

3 RESULTS AND DISCUSSION

3.1 Performance of PC-classiﬁer on NKI dataset

We ﬁrst compared PC-classiﬁer with standard SVM classiﬁer
and subtype-based SVM classiﬁer for their performance on the
NKI dataset using the leave-one—out evaluation technique
(see Section 2). Figure 2a shows the AUC scores for these clas-
siﬁers. As shown, PC-classiﬁer with as few as two base classiﬁers
in the committee had similar performance as the standard or
subtype-based classiﬁers, and signiﬁcantly outperformed them
when at least ﬁve base classiﬁers were present in the committee.
The best performance of our method was achieved with 150—600
base classiﬁers. Compared with the standard SVM classiﬁer, the
PC-classiﬁer achieved an 11.4% performance improvement
(AUC 0.78 versus 0.70). Using other evaluation methods includ-
ing kappa static, PPV, NPV and ROC curves, we found similar
trends that conﬁrmed the superior performance of PC-classiﬁer
(Supplementary Table S3 and Supplementary Fig. S5).

Next, we investigated how these classiﬁers performed for
patients falling in each of the ﬁve predeﬁned breast cancer sub-
types (Sorlie et al., 2003). To this end, we calculated the AUC
scores by considering the patients in each predeﬁned subtype
separately. Figure 2b shows the classiﬁcation performance for
the ﬁve subtypes. It can be seen that PC-classiﬁer signiﬁcantly
outperformed the other methods for all subtypes, but especially
for basal and normal breast-like subtypes, two of the most dif-
ﬁcult subtypes to be predicted by the standard classiﬁer. On the
other hand, although the subtype-based classiﬁer performed
slightly better than the standard classiﬁer for luminal B and
ErbB2 subtypes, its performance on normal breast-like and
basal subtypes was much worse. The subtype-based classiﬁer
performed poorly for the normal-like subtype probably because
of the small number of training samples for this subtype
(Table 1) and the intrinsic difﬁculty in deﬁning the subtype
(Supplementary Fig. S1). Intriguingly, basal subtype is the
most coherent subtype among all studies (Hennessy et al.,
2009; Kapp et al., 2006; Mackay et al., 2011; Sorlie et al.,
2001, 2003) (as also suggested by the patient—patient network
shown in Supplementary Fig. S1). Consequently, the patients
selected to construct the base classiﬁers for patients in the
basal subtype were mostly of basal subtype as well
(Supplementary Figs S2 and S4). Therefore, the dramatic
performance difference between the subtype-based classiﬁer
and the PC-classiﬁer for the basal subtype indicates that the
basal subtype is also heterogeneous, as our model only used a
subset of all basal patients to construct each base classiﬁer but
had better accuracy than the subtype-based classiﬁer that used all
basal patients. Overall, by dynamically controlling the number of
training samples for each patient, regardless of its subtype
designation, and combining decisions from multiple base
classiﬁers learned on similar patients, our method is able to
improve performance signiﬁcantly for all subtypes.

 

112 /810's112umo [p.IOJXO'SOIlBIIIJOJUIOIQ/ﬁdllq 1110131 pop1201umoq

9IOZ ‘091sn8nv uo ::

M.J.Jahid et al.

 

 

 

 

+ PC—classifier

052 - - - Standard SVM classrfrer

 

 

 

-)

 

 

0.6

 

Subtype—based SVM classiﬁer '

 

10° 101 102

Number of Classifiers

10

 

3

 

 

- Standard SVM classifier
. - I:I Subtype based SVM classifier — -
I:I PC—classifier _

 

 

 

 

 

 

 

 

 

 

 

 

 

Normal Basal LuminalA LuminalB ErbBZ

Fig. 2. Performance of different classiﬁers on NKI dataset. (a) AUC scores for the whole dataset. (b) AUC scores for each subtype separately

 

 

!
0-58 ' + PC—classifier '
— - - Standard SVM classifier

1o1

 

 

 

162
Number of Classifiers

Fig. 3. Performance of PC-classiﬁer and standard classiﬁer on (a) Wang

It is worth noting that PC-classiﬁer may improve breast
cancer treatment by restraining unnecessary adjuvant system-
atic therapies. According to previous studies, 70—80% lymph
node—negative breast cancer patients may undergo adjuvant
chemotherapy, which is in fact unnecessary and these patients
may potentially suffer from lethal side effects (van’t Veer
et al., 2002). For example, the Luminal subtype is known to
be the least lethal, and yet, many patients still go through
advanced treatments while they would not have developed
distant metastasis. Therefore, to minimize the degree of
secondary damage to Luminal subtype patients, an ideal
classiﬁer should have a low false-positive rate. Further analy-
sis revealed that for Luminal subtype (including both Luminal
A and Luminal B), at a fixed 75% sensitivity level, our method
achieved a false-positive rate of 31.5%, as compared with
43.1% for the standard SVM classifier (41 versus 56 incor-
rectly classified patients, respectively). Therefore, 15 (11.6%)
additional Luminal patients are correctly classiﬁed into non-
metastatic group by our method and may not be going
through unnecessary adjuvant chemotherapy.

3.2 Validation of PC-classiﬁer using two additional
datasets

A more challenging and yet realistic task in cancer outcome

prediction is to use the models developed in one cohort to classify

patients in other cohorts. Because of the differences in patient

 

 0.a

0.85 -

 

0'6; + PC—classifier -
— - — Standard SVM classifier
0.55

10 1O 1O 10
Number of Classifiers

 

 

 

0 1 2 8

and (b) UNC datasets

characteristics, sample collection protocols, microarray platforms
and data preprocessing steps, microarray gene expression data
obtained from different studies for the same disease are often
not directly comparable. For example, the three datasets used in
this study consist of patients of different age groups, pretreat-
ments, lymph node status and metastatic potentials
(Supplementary Table S1). When conducting cross-dataset valid-
ations, the existing studies in breast cancer metastasis prediction
usually avoid these issues by reusing only the features rather than
the classification models across datasets (Chuang et al., 2007; J ahid
and Ruan, 2012; Su et al., 2010). More speciﬁcally, with two data-
sets, A and B, the existing methods attempt to ﬁnd informative
genes from dataset A in a supervised way (i.e. considering the
disease outcomes), and then build a new model using dataset B
ﬁltered to have only the list of genes selected from A. Cross-data
classiﬁcation accuracy was then measured using 10-fold cross-val-
idation or leave-one-out within dataset B. This is in contrast to our
study, where the model constructed from dataset A was directly
used to classify the patients in dataset B. Our evaluation proced-
ure is more realistic, as it reﬂects how well a model is expected to
perform in a clinical setting where every new patient needs to be
classiﬁed by the same existing model.

Here we report the performance of the PC-classiﬁer developed
on the NKI dataset and tested on Wang and UNC datasets.
Figure 3a shows the results for Wang dataset. It can be seen
that the cross-data AUC score for standard SVM classiﬁer is
0.60 for this dataset. In contrast, PC-classiﬁer with as few as

 

1862

112 /810's112umo [p.IOJXO'SOIlBIIIJOJUIOIQ/ﬁdllq 1110131 pep1201umoq

9IOZ ‘091sn8nv uo ::

Personalized classification of breast cancer metastasis

 

 

AUC

 

 

: — PC—classifier
0.62 -  ~41 -- Bagging
: - - ‘ - ‘ -- Random Forest

 

 

 

 

 

 

0.6 I I 2 I I I I I I I I I I I I
1 5 20 40 100 200 400 600 800
Number of Classifiers

 

       
     
    

 

 

 

 

 

 

 

(b) 0.7
0.68-
0.66- 
 
0.64_  I I I
.I I
O I. ‘,.‘I _.
2 0.62- ~‘  
0.6- 
0.58-
 — PC—classifier
0.56- I """ " Bagging
. . r . r -- Random Forest
0.54 I I I I

1 5 20 40 100 200 400 600 800
Number of Classifiers

 

(C)

0.8 -

0.6 -

 

 

 

— PC—classifier

----- -- Bagging
. . r . r -- Random Forest

 

 

 

 

 

0.5 I I I I I I
1 5 20 40

100 200 400 600 800

Number of Classifiers

Fig. 4. Performance of PC-classiﬁer and different ensemble classiﬁers on (a) NKI (b) Wang and (c) UNC datasets. Error bars represent one standard

error of the mean

two base classiﬁers performed similarly as standard SVM classi-
ﬁer and signiﬁcantly outperformed standard SVM classiﬁer with
ﬁve or more base classiﬁers in the committee. PC-classiﬁer had
the highest accuracy with ~100 classiﬁers in the committee and
outperformed the standard SVM classiﬁer signiﬁcantly with
14.28% performance improvement. Figure 3b shows the AUC
scores for PC-classiﬁer and standard SVM classiﬁer for UNC
dataset. The standard SVM classiﬁer had an AUC score of 0.67,
while the PC-classiﬁer with 20 base classiﬁers had similar accur-
acy. The highest classiﬁcation accuracy was achieved with ~400
base classiﬁers, which outperformed the standard SVM classiﬁer
by 17.3%. Also, from Kappa static and ROC curves, we can
validate again that the performance improvement by PC-classi-
ﬁer in both datasets is genuine (Supplementary Figs S6 and S7
and Supplementary Tables S4 and S5).

It is interesting to note that the number of base classiﬁers
needed to achieve the best accuracy is much larger in the UNC
dataset than in the other two datasets. This is likely because of
the fact that the ratio of metastatic patients in the UNC
dataset is much higher than that in the NKI and Wang datasets
(64.6, 26.4 and 37.1%, respectively) and that the pretreatments
received by patients in the UNC cohorts are much more hetero-
geneous than those in the other two data sets (Supplementary
Table S1). In fact, one of the advantages that PC-classiﬁer
has over the standard methods that use the whole dataset to

construct a single model is its relative insensitivity to overall
sample characteristics. In PC-classiﬁer, as only the most relevant
patients in the training cohort will be used to classify a target
patient, the difference in sample characteristics between the
training and test cohorts does not necessarily cause as much
degradation of performance as in other methods, as long as
the training dataset itself contains a sufﬁcient number of samples
that are similar to the target patients.

3.3 Performance comparison with other ensemble
classiﬁcation approaches

We also compared the performance of PC-classiﬁer with four
popular ensemble classiﬁcation approaches: Bagging, Dagging,
AdaBoost and Random Forest (see Section 2). Similar as in the
above results, leave-one-out cross-validation was used for the
NKI dataset, whereas Wang and UNC datasets were tested
using models developed from the NKI dataset. Figure 4 shows
the AUC scores of PC-classiﬁer, Bagging, Random Forest with
different numbers of base classiﬁers. From the ﬁgure it can be
seen that for all the datasets, PC-classiﬁer signiﬁcantly outper-
formed Bagging and Random Forest. For Wang dataset, with
only <20 base classiﬁers, PC-classiﬁer had 9% performance im-
provement compared with Bagging and Random Forest. For
NKI and UNC dataset, the performance of PC-classiﬁer was

 

1863

112 /810's112umo [p.IOJXO'SOIlBIIIJOJUIOIQ/ﬁdllq 1110131 pep1201umoq

9IOZ ‘091sn8nv uo ::

M.J.Jahid et al.

 

 

     

.ltlrllll

   

 

Normal
Basal

LuminalB I I I
ErbBZ

a J-r— .1

l
. ll

 

l

  

I I
Luminal A I III IIII
II II II

I

 

 

  

   

 

‘ lr

 

l

-m; .. .'..._.-.-.-,.

        

(a)
MelaSI-asis II II l_l_-T IIIII II III III-I

Ill IIIII IIIIIIII| “-

 

(C)

Fig. 5. Hierarchical clustering of PC-classiﬁer models from NKI dataset. (a) Dendrogram and heatmap of the base classiﬁers, where each column
corresponds to a patient and each row to a gene. Each pixel in the heatmap corresponds to SVM coefﬁcient value of the gene in the base classiﬁer model
for a particular representing patient. Low values are in green, and high values are in red. (b) Metastasis status of the corresponding patients. (c) Cancer

subtype for each patient deﬁned by van de Vijver et al. (2002)

similar to Bagging and Random Forest with <100 base classiﬁers
but improved signiﬁcantly when the number of base classiﬁer
increased from 100 to 400. We also report the kappa, PPV and
NPV for these classiﬁers (Supplementary Tables S3, S4 and S5)
and ﬁnd that PC-classiﬁer shows the most promising results
compared with other ensemble classiﬁers. The performance of
two other competing ensemble classiﬁers, Dagging and
AdaBoost, are much worse than Bagging and Random Forest
as well as PC-classiﬁer (Supplementary Table S6). Bagging and
Random Forest performed comparatively better than standard
SVM because some of the base classiﬁers by chance may have
subtype-speciﬁc samples. Interestingly, despite the large number
of classiﬁers created, AdaBoost actually had even worse
performance than the standard SVM classiﬁer. As AdaBoost
gives additional weights to previously misclassiﬁed samples in
each new iteration (see Section 2), the results suggest that the
additional focus by AdaBoost on the hard-to-classify examples
actually had an adverse effect to the overall model performance.
In contrast, in our algorithm, because these patients are probably
the ones without enough representations in the training cohort,
they have had a lower probability to be selected as training
samples for other patients; in addition, the base classiﬁers con-
structed for them may also have had a higher probability to be

deleted from the pool due to incorrect classiﬁcations.
Consequently, these patients were relatively discounted in our
model, which resulted in the improved performance of our
algorithm on the overall population.

3.4 Biological signiﬁcance of PC-classiﬁers

To reveal the biological signiﬁcance of PC-classiﬁers and inves-
tigate the relationship among the base classiﬁers for different
patients, we clustered the base classiﬁers based on the similarity
of their normalized SVM coefﬁcients. Because we used linear
kernel SVM, each classiﬁer is deﬁned by a vector of coefﬁcients,
or weights, for the selected features (genes). A higher weight
means that the expression level of that gene is positively corre-
lated with metastatic potentials. Figure 5 shows the hierarchical
clustering result of the validated base classiﬁers constructed at
o = 0.005. Also shown in the ﬁgure are the subtype designation
of each patient given by Chanrion et al. (2007) and Sorlie et al.
(2003) and the 5-year metastatic status of each patient.
Remarkably, ﬁve major clusters can be easily identiﬁed from
the patient dendrogram. Cluster 1 contains almost exclusively
and all of the basal subtype patients. Cluster 3 contains only
ErbB2 and luminal B patients, whereas cluster 4 contains
mostly luminal A and luminal B patients. Cluster 5 contains

 

1864

112 /810'S[12umo prOJXO'SOIlBIIlJOJUIOIQ/ﬂdllq 11101; pap1201um0q

9IOZ ‘OE lsnﬁnv uo ::

Personalized classification of breast cancer metastasis

 

Table 2. Comparison of top ranked genes in different classiﬁers

 

 

 

Gene PubMed Rank in clas siﬁersa
name hits
Standard Basal LumB/ LumA/
SVM ErbB2 LumB

ID1 38 878 19 770 686
ATPlBl 5 88 22 459 1182
CCL19 33 252 10 704 696
HEY1 4 372 8 368 680
MST1R 3 783 6 741 1456
ANOl 3 490 9 528 652
FABP7 3 358 30 371 380
KLK7 6 990 6 916 144
KLK6 9 645 29 229 759
NDRG1 56 414 1383 22 33
FLT3 48 395 873 199 26
SPPl 26 324 334 47 18
TFFl 24 99 181 30 231
HOXB13 7 89 659 21 1214
ITGA2 5 64 247 12 12
PEG10 5 97 745 28 53
CKB 5 286 16 27 1254
IGFBP2 6 774 25 545 29
PDGFRA 144 43 26 82 1131
GP5 12 23 18 120 31 1
PBXl 8 28 407 134 21
NUPRl 6 15 348 18 20
ANXA3 4 18 1519 51 3
BMPRl B 2 30 1086 24 6
MMP9 323 7 572 29 4
ADAMS 15 24 160 3 2
CYPlBl 14 26 43 34 170
IGFBP5 1 1 33 23 11 104
PRAME 9 35 20 4 409
CCL21 58 20 227 519 79

 

aBasal, LumB/ErbB2 and LumA/LumB represent the models displayed in cluster 1,
3 and 4, respectively, in Figure 5. Bold values indicate ranks less than 50.

mostly normal breast-like and luminal A patients. Cluster 2 is the
largest and most complex, with members from all ﬁve subtypes,
despite a relative overrepresentation of normal breast-like and
luminal A patients. The partial overlap between the clusters and
the subtype designations suggests that the molecular proﬁles in
the luminal/ErbB2 breast cancer is a continuum rather than dis-
crete distribution, as demonstrated in several recent studies (Lusa
et al., 2007; Mackay et al., 2011).

Most of the metastatic patients are distributed in clusters 1, 3
and 4. The overrepresentation of metastatic patients in cluster 1
and 3 is mainly because of basal and ErbB2 patients, respect-
ively, and is expected. Interestingly, while cluster 2 and cluster 4
both have mostly luminal A/B patients, cluster 4 has the highest
ratio of metastatic patients, whereas only a small number of
patients in cluster 2 are metastatic.

Our results suggest that different breast cancer subtypes need
different metastatic classiﬁcation models. For patients in cluster 1

(basal subtype), metastasis is driven by group B genes while sup-
pressed by group C genes. The pattern is almost the opposite for
cluster 3/4 patients (luminal A, B and ErbB2 subtypes), where
group A genes promote metastasis. The main difference between
cluster 2 and cluster 4 patients, both of which contain mainly
luminal subtypes but cluster 4 is much more aggressive, is that
group A genes promote metastasis in cluster 4 but not in cluster
2. These results suggest that the metastasis processes in different
subtypes are likely governed by different molecular mechanisms,
especially between the patients in cluster 1 and the other four
clusters. We therefore performed a functional enrichment ana-
lysis for the three groups of genes that seem to make up the
difference between the clusters (Supplementary Table S7).
Interestingly, while all three groups of genes are enriched in de-
fense response and response to wounding, group B genes are
more speciﬁcally enriched in cell proliferation (P<2.6E-07) and
migration (P< 7.8E-06), whereas group C genes are more specif-
ically enriched in response to estrogen stimulus (P < 2.8E- 10), cell
proliferation (P<4.4E-07), anti-apoptosis (P< 5.1E-04) and cell
adhesion (P< 3.6E-04).

To further investigate the signiﬁcance of PC-classiﬁers, we ana-
lyzed the top-ranked genes in different clusters. We identiﬁed top
30 ranked genes (disregarding their signs) in cluster 1, 3 and 4
based on their average SVM weights and searched their associ-
ation with disease recurrence using literature mining (see Section
2). Table 2 lists genes that are top ranked in the standard or PC-
classiﬁers and with at least three PubMed hits. (A complete list of
all genes used by the classiﬁers and their ranks in different models
are included in Supplementary Table S8.) As shown in Table 2,
many of the top-ranked genes are already known to be metasta-
sis-related. For example, MMP9, PDGFRA and CCL21 are well
known to be involved in breast cancer recurrence. Remarkably,
our results identiﬁed many genes with subtype-speciﬁc roles in
metastasis development, which are difﬁcult to be discovered with
the standard classiﬁers. For example, ID1, HEY1 and MSTlR
have high ranks in cluster 1 (basal) models but low ranks in the
other clusters and standard SVM models. IDl is a well-known
mediator of breast cancer lung metastasis for basal subtype pa-
tients (Gupta et al., 2007). HEY1 is a target gene for Notch sig-
naling inhibitor for basal group (Debeb et al., 2012).
Overexpression of MSTlR is a strong indicator of metastasis in
breast cancer patients (\Nelm et al., 2007). Similarly, NDRG1 is
top ranked in cluster 3 and 4 but not so in cluster 1 models and is
known to be related to luminal subtype (Nagai et al., 2011); TFFl
is top ranked only in cluster 3 and is known to be associated and
responsible for luminal stability (Yamachika et al., 2002). We also
identiﬁed some genes that show subtype speciﬁcity with high
ranks in standard SVM classiﬁers, including PDGFRA, which
is a drug target for basal-like tumor (Koboldt et al., 2012), and
BMPRlB, which is known to be associated with ER-positive
breast cancer subtype (Bianchini et al., 2010). Our results con-
ﬁrmed the speciﬁcity for BMPRlB as a target for ER-positive
breast cancer and suggested that PDGFRA can also be an effect-
ive target for LuminalB/ErbB2 patients.

4 CONCLUSION

In this article, we proposed a personalized committee classiﬁca-
tion approach for disease outcome prediction that was based on

 

1865

112 /810's112umo [p.IOJXO'SOIlBIIIJOJUIOIQ/ﬁdllq 1110131 pep1201umoq

9IOZ ‘091sn8nv uo ::

M.J.Jahid et al.

 

the decisions from multiple base classiﬁers, where each base
classiﬁer was developed from training patients with similar
molecular characteristics. We applied our method to predict
the metastatic risk of breast cancer patients for three publicly
available breast cancer datasets. For all three datasets, our
method signiﬁcantly outperformed other methods that either
do not use subtype information (standard SVM classiﬁer) or
only use predeﬁned subtypes (subtype speciﬁc SVM classiﬁer).
Our method has superior cross-dataset prediction accuracy,
which shows a clear distinction that our method will perform
well in actual clinical setup. Furthermore, our method has
better prediction performance compared with other popular
ensemble classiﬁcation approaches. Finally, analysis of the
models showed that the personalized committee classiﬁers are
consistent with the current knowledge of breast cancer subtypes
and identiﬁed difference between the metastatic processes under-
lying different subtypes. Therefore, the classiﬁcation approach
proposed in this article shows that we can better design classiﬁers
based on personalized training samples, and those classiﬁers
could be used for developing better prediction models that can
be used for better disease prognosis and treatment. Although our
method is only used to predict metastasis in breast cancer
patients in this article, we believe it is general and can be applied
to other cancer types and other molecularly heterogeneous
diseases.

ACKNOWLEDGEMENTS

The authors would like to thank Dr Rong Li at UTHSCSA for
fruitful discussions and the anonymous reviewers for their in-
sightful comments that have signiﬁcantly improved this
manuscript.

Funding: National Science Foundation (HS-1218201); National
Institutes of Health (SC3GM086305, U54CAll3001,
ULlTR001120 and G12MD007591); UTSA Tenure-track
Research Award.

Conﬂict of Interest: none declared.

REFERENCES

Beriman,L. (1996) Bagging predictors. Mach. Learn, 24, 123—140.

Bianchini,G. et al. (2010) Prognostic and therapeutic implications of distinct kinase
expression patterns in different subtypes of breast cancer. Cancer Res., 70,
8852—8862.

Chang,H. et al. (2004) Gene expression signature of a ﬁbroblast serum response
predicts cancer progression. PLoS Biol., 2, e39.

Chang,H. et al. (2005) Robustness, scalability, and integration of a wound-response
gene expression signature in predicting breast cancer survival. Proc. Natl Acad.
Sci. USA, 102, 3738—3743.

Chanrion,M. et al. (2007) A new molecular breast cancer subclass deﬁned from a
large scale real-time quantitative RT-PCR study. BM C Cancer, 7, 39.

Chuang,H. et al. (2007) Network-based classiﬁcation of breast cancer metastasis.
Mol. Syst. Biol., 3, 140.

Debeb,B. et al. (2012) Pre-clinical studies of notch signaling inhibitor ro4929097 in
inﬂammatory breast cancer cells. Breast Cancer Res. Treat, 134, 495—510.
Edgar,R. et al. (2002) Gene expression omnibus: Ncbi gene expression and hybrid-

ization array data repository. Nucleic Acids Res., 30, 207—210.

Freund,Y. and Robert,E.S. (1996) Experiments with a new boosting algorithm. In:
International Conference on Machine Learning. pp. 148—156.

Gupta,G.P. et al. (2007) ID genes mediate tumor reinitiation during breast cancer
lung metastasis. Proc. Natl Acad. Sci. USA, 104, 19506—19511.

Hall,M. et al. (2009) The WEKA data mining software: an update. SIGKDD
Explor. Newsl., 11, 10—18.

Heiser,L.M. et al. (2011) Subtype and pathway speciﬁc responses to anticancer
compounds in breast cancer. Proc. Natl Acad. Sci. USA, 109, 2724—2729.

Hennessy,B. et al. (2009) Characterization of a naturally occurring breast cancer
subset enriched in epithelial-to-mesenchymal transition and stem cell character-
istics. Cancer Res., 69, 4116—4124.

J ahid,M.J . and Ruan,J . (2012) A Steiner tree-based method for biomarker discovery
and classiﬁcation in breast cancer metastasis. BM C Genomics, 13 (Suppl. 5),
S6—S8.

Kapp,A. et al. (2006) Discovery and validation of breast cancer subtypes. BM C
Genomics, 7, 231.

Koboldt,D.C. et al. (2012) Comprehensive molecular portraits of human breast
tumours. Nature, 490, 61—70.

Landis,J. and Koch,G. (1977) The measurement of observer agreement for categor-
ical data. Biometrics, 33, 159—174.

Lusa,L. et al. (2007) Challenges in projecting clustering results across gene expres-
sion proﬁling data sets. J. Natl Cancer Inst., 99, 1715—1723.

Mackay,A. et al. (2011) Microarray-based class discovery for molecular classiﬁca-
tion of breast cancer: analysis of interobserver agreement. J. Natl Cancer Inst.,
103, 662—673.

Nagai,M. et al. (2011) Prognostic value of ndrgl and spare protein expression in
breast cancer patients. Breast Cancer Res. Treat, 126, 1—14.

Prat,A. et al. (2010) Phenotypic and molecular characterization of the claudin-low
intrinsic subtype of breast cancer. Breast Cancer Res. Treat, 12, R68.

Ruan,J. et al. (2010) A general co-expression network-based approach to gene ex-
pression analysis: comparison and applications. BM C Syst. Biol., 4, 8.

Sorlie,T. et al. (2001) Gene expression patterns of breast carcinomas distinguish
tumor subclasses with clinical implications. Proc. Natl Acad. Sci. USA, 98,
10869—10874.

Sorlie,T. et al. (2003) Repeated observation of breast tumor subtypes in independent
gene expression data sets. Proc. Natl Acad. Sci. USA, 100, 8418—8423.

Sotiriou,C. et al. (2006) Gene expression proﬁling in breast cancer: understanding
the molecular basis of histologic grade to improve prognosis. J. Natl Cancer
Inst., 98, 262—272.

Su,J. et al. (2010) Identiﬁcation of diagonostic subnetwork markers for cancer
in human protein-protein interaction network. BM C Bioinformatics, 11
(Suppl. 6), S8.

Ting,K.M. and Witten,I.H. (1997) Stacking bagged and dagged models. In:
International Conference on Machine Learning. pp. 367—375.

Tong,H. et al. (2006) Fast random walk with restart and its applications. In:
Proceedings of the Sixth International Conference on Data Mining, ICDM’06.
IEEE Computer Society, Washington, DC, pp. 613—622.

van de Vijver,M.J. et al. (2002) A gene-expression signature as a predictor of sur-
vival in breast cancer. N. Engl. J. Med, 347, 1999—2009.

van’t Veer,L.J. et al. (2002) Gene expression proﬁling predicts clinical outcome of
breast cancer. Nature, 415, 530—536.

Wang,Y. et al. (2005) Gene-expression proﬁles to predict distant metastasis of
lymph-node-negative primary breast cancer. Lancet, 365, 671—679.

Welm,A.L. et al. (2007) The macrophage-stimulating protein pathway promotes
metastasis in a mouse model for breast cancer and predicts poor prognosis in
humans. Proc. Natl Acad. Sci. USA, 104, 7570—7575.

Yamachika,T. et al. (2002) Intestinal trefoil factor: a marker of poor prognosis in
gastric carcinoma. Clin. Cancer Res., 8, 1092—1099.

 

112 /810's112umo [progxo'sor1eu1101urorq//:d11q 1110131 pep1201umoq

9IOZ ‘091sn8nv uo ::

