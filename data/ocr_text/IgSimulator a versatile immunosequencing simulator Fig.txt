Bioinformatics, 31 (19), 2015, 3213—321 5

doi: 10.1093/bioinformatics/btv326

Advance Access Publication Date: 25 May 2015
Applications Note

 

 

Sequence analysis

lgSimulator: a versatile immunosequencing

simulator

Yana Safonova1'2'*, Alla Lapidus1'2 and Jennie Lill3

1Center of Algorithmic biotechnology, Institute of Translational Biomedicine, St. Petersburg State University,
Russia, 2Algorithmic Biology Laboratory, St. Petersburg Academic University, St. Petersburg, Russia and
3Department of Protein Chemistry, Genentech,1 DNA Way, South San Francisco, CA 94080, USA

*To whom correspondence should be addressed.
Associate Editor: John Hancock

Received on October 11,2014; revised on May 18,2015; accepted on May 19,2015

Abstract

Motivation: The recent introduction of next—generation sequencing technologies to antibody stud—
ies have resulted in a growing number of immunoinformatics tools for antibody repertoire ana—
lysis. However, benchmarking these newly emerging tools remains problematic since the gold
standard datasets that are needed to validate these tools are typically not available.

Results: Since simulating antibody repertoires is often the only feasible way to benchmark new
immunoinformatics tools, we developed the lgSimulator tool that addresses various complications
in generating realistic antibody repertoires. lgSimulator’s code has modular structure and can be

easily adapted to new requirements to simulation.

Availability and implementation: lgSimulator is open source and freely available as a C++ and
Python program running on all Unix—compatible platforms. The source code is available from

ya na—safonova.github.io/ig_simulator.
Contact: safonova.yana@gmail.com

Supplementary information: Supplementary data are available at Bioinformatics online.

 

1 Introduction

The recent introduction of next—generation sequencing (NGS) tech—
nologies to antibody studies have resulted in a growing number of
immunoinformatics tools for antibody repertoire analysis (Boyd
et 61]., 2009; Weinstein et 61]., 2009; Shugay et 61]., 2014). However,
benchmarking these newly emerging tools remains problematic since
the gold standard datasets that are needed to validate these tools are
typically not available. Since simulating antibody repertoires is often
the only feasible way to benchmark new immunoinformatics tools,
many immunoinformatics groups have developed their own anti—
body repertoire simulators of various complexity (Bonissone and
Pevzner, 2015; Weinstein et 61]., 2009). Lack of a publicly available
immunoinformatics simulator makes it difficult to benchmark mul—
tiple antibody analysis tools and forces every new immunoinfor-
matics researcher to invest efforts into development of a yet another
simulator. We argue that the time has come to develop a compre—
hensive publicly available immunoinformatics simulator, similar to

the widely used ART (Huang et 61]., 2012) read simulator for NGS
studies. Developing an immunoinformatics simulator is a more
complex task than developing ART since it should reflect a
complex process of forming antibody repertoires in a realistic statis—
tical setting. These complications are further amplified by the fact
that similar but distinct antibodies within a repertoire often dif—
fer from each other by only a small number of mutations, thus, mak—
ing it difficult to distinguish them from sequencing errors.
Moreover, antibody repertoires often feature a few large
clusters (occurring as a result of in vivo clonal selection)
accompanied by a large number of smaller clusters, presenting a
challenge for the repertoire analysis algorithms that attempt to sep—
arate small clusters from often similar large clusters. Below we de—
scribe the IgSimulator tool that addresses various complications in
generating realistic antibody repertoires. IgSimulator simulates rep—
ertoires and uses ART to simulate reads resulting from this
repertoire.

©The Author 2015. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com 3213

9mg ‘09 1sn3nv uo sopﬁuv s01 ‘BTUJOJTIBD aIo Amie/nun 112 /§.IO'S[BU.IHO[p.IOJXO'SOTlBIHJOJUTOTQ/ﬁ(1111] 11101; prEOIUAAOG

3214

Y.Safonova et al.

 

2 Methods

2.1 Simulating individual antibodies

Antibody repertoires are generated by complex processes: V(D)J re—
combination, intergenic insertions and somatic hypermutations.
IgSimulator models all these processes and generates repertoires
based on the following features (Murphy, 2012). Distribution of the
clone frequencies contains few overrepresented clones and plenty of
low abundant clones. The lengths of exonuclease removals do not
exceed 10 nt and are distributed uniformly. The lengths of N nucleo—
tides, or non—genomic intergenic insertions, do not exceed 10 nt and
are distributed uniformly. The lengths of P nucleotides, or inverted
palindromic intergenic insertions, do not exceed 4 nt and are distrib—
uted uniformly. Frequencies of SHM in CDRs (per nucleotide) are
higher than frequencies of SHM in FRs. SHMs are generated as a
mix of motif based (Rogozin and Kolchanov, 1992) and random
changes.

2.2 Simulating antibody repertoires

The repertoire simulation proceeds in the following five steps illus—
trated in Figure 1. IgSimulator generates a set of the base antibody
sequences using simulation of the V(D)J recombination mechanisms,
somatic deletions of start and end of the gene segments and inser—
tions of the non—genomic P and N nucleotides (step 1 in Fig. 1). By
default, IgSimulator uses the IMGT database of human Ig germline
genes (Brochet et al., 2008; user can provide different set of germline
genes if necessary) and selects among equally likely V/D/J gene seg—
ments candidates to simulate the V(D)J recombination. IgSimulator

_—I—'—_—_—‘—I—_
Data-ase
Ig germline genes

1 || I II | I II I
1. Simulation o-F 0(0)] recombination

 

 

_.
_.

 

I:I:I:I
2. Base antibody sequences

 

 

 

 

5. Ig-Seq library

Fig. 1. lgSimulator pipeline for simulating an antibody repertoire

randomly assigns the frequency to each base antibody sequence
using the power law distribution (step 2 in Fig. 1). Evidence of this
distribution was shown recently (Weinstein et al., 2009).
IgSimulator introduces the somatic mutations into each base anti—
body sequences resulting in mutated antibody sequences (step 3 in
Fig. 1). To generate an antibody repertoire, IgSimulator randomly
assigns the frequency to each mutated antibody sequence using the
power law distribution (step 4 in Fig. 1). The frequencies represent
the number of times each mutated antibody sequence will be present
in the antibody repertoire. The resulting antibody repertoire is
further subjected to an NGS read simulation using ART (step 5 on
Fig. 1). To configure the diversity rate, IgSimulator uses the follow—
ing parameters: # base sequences, # mutated sequences and reper-
toire size. A small difference between # mutated sequences and #
base sequences leads to simulation of low abundant families of
mutated antibodies. In contrast, big difference between # mutated se-
quences and # base sequences leads to simulation of highly repetitive
repertoires that include large mutated groups (see Supplementary).

2.3 Simulating lg—seq library

IgSimulator uses a simulated repertoire as a reference and runs ART
to simulate an Ig—seq library with reads featuring realistic and tech—
nology-specific error profiles. The user has an option to generate
reads with errors that follow the specifics of Illumina. IgSimulator
selects parameters of ART in such a way that the following condi-
tions hold: (i) reads (or read—pairs) in the simulated library cover the
variable region of the antibody (in the case of Illumina reads,
IgSimulator generates paired—end overlapping reads with insert size
similar to the length of the variable region), and (ii) the coverage of
antibody sequences is uniform. As a result, IgSimulator creates an
idealized repertoire for simulated library that can be used for further
repertoire studies and benchmarking various repertoire analysis tools.

3 Conclusions

Many immunoinformatics algorithms have been developed for the
challenging problem of antibody repertoire analysis. Our antibody
repertoire simulator IgSimulator will help scientists to assess various
immunoinformatics software tools and to choose the best pipeline
for their research. The initial version of IgSimulator addresses most
but not all aspects of modeling the antibody repertoires. In the fu—
ture, it will be extended to address the following issues: (i) a data—
driven modeling of the distribution of mutation across CDRs and
FRs based on analyzing multiple immunoinformatics datasets, (ii)
probabilistic model for modeling SHM motifs (Bonissone and
Pevzner, 2015), (iii) statistical inference methods for generating rep—
ertoires (Murugan et al., 2012), (iv) addition of insertions and dele—
tions to the set of SHMs (Klien et al., 1998) and (v) biases in N
addition such as the GC preference (Briney et al., 2012).

Acknowledgements

The authors thank Dr. Pavel A. Pevzner and SPAdes team (Bankevich et al.,
2012) for productive collaboration, helpful comments and feedback on using
our software.

Funding

Y.S. and AL. are supported by Russian Science Foundation (grant No 14-50-
00069).

Conﬂict of Interest: none declared.

9mg ‘09 1sn3nv uo sopﬁuv s01 ‘BTUJOJTIBD aIo Amie/trqu 112 /§.IO'S[BU.IHO[p.IOJXO'SOTlBIHJOJUTOTQ/ﬁ(1111] 11101; popeorumoq

IgSimulator

3215

 

References

Bankevich,A. et al. (2012) SPAdes: A new genome assembly algorithm and its
applications to single-cell sequencing. ]. Comput. Biol., 19, 455—477.

Bonissone,S. and Pevzner,P.A. (2015) Immunoglobulin classiﬁcation using
the colored antibody graph. In: Przytycka,T.M. (ed.), Research in
Computational Molecular Biology (RECOMB), Lecture Notes in Computer
Science, Vol. 9029, pp. 44—59.

Boyd,S. et al. (2009) Measurement and clinical monitoring of human lympho-
cyte clonality by massively parallel VD] pyrosequencing. Sci. Transl. Med.,
1, 12—23.

Briney,B.S. et al. (2012) Frequency and genetic characterization of V(dd)j re-
combinants in the human peripheral blood antibody repertoire.
Immunology, 137, 56—64.

Brochet,X. et al. (2008) IMGT/V-QUEST: the highly customized and inte-
grated system for 1G and TR standardized V-] and V-D-J sequence analysis.
Nucleic Acids Res, 36, W503—W508.

Huang,W. et al. (2012) ART: a next-generation sequencing read simulator.
Bioinformatics, 28, 593—594.

Klien,U. et al. (1998) Somatic hypermutation in normal and transformed
human B cells. Immunol. Reu, 162, 261—280.

Murphy,K.P. (2012) janeu/ay’s immunobiology. 8th edn. Garland Science,
London.

Murugan,A. et al. (2012) Statistical inference of the generation probability of
T-cell receptors from sequence repertoires. Proc. Natl. Acad. Sci. USA, 109,
161616.

Rogozin,I. and Kolchanov,N. (1992) Somatic hypermutagenesis in immuno-
globulin genes. 11. inﬂuence of neighbouring base sequences on mutagenesis.
Biocbim. Biopbys. Acta, 1171, 11—18.

Shugay,M. et al. (2014) Towards error-free proﬁling of immune repertoires.
Nat. Methods, 11, 653—655.

Weinstein,]. et al. (2009) High-throughput sequencing of the zebraﬁsh anti-
body repertoire. Science, 324, 807—810.

91% ‘09 1sn8nv uo sopﬁuv s01 ‘1211110111123 310 Amie/nun 112 /§.IO'S[BU.IHO[p.IOJXO'SOTlBIIIJOJUTOTQ/ﬁdllq 11101; popeorumoq

