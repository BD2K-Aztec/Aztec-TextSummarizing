Vol. 30 ISMB 2014, pages i1 13-i120
doi: 10. 1093/bioinformatics/btu2 74

 

Methods for time series analysis of RNA-seq data with application

to human Th17 cell differentiation

Tarmo Aijo”, Vincent Butty2, Zhi Chen3, Verna $8103, Subhash Tripathi3,
Christopher B. Burge2, Riitta Lahesmaa3 and Harri Lahdesmaki1’3’*

1Department of Information and Computer Science, Aalto University, FI—OOO76 Aalto, Finland, 2Department of Biology,
Massachusetts Institute of Technology, Cambridge, MA 02139, USA and 8Turku Centre for Biotechnology, University of

Turku and Abo Akademi University, FI—20520 Turku, Finland

 

ABSTRACT

Motivation: Gene expression profiling using RNA-seq is a powerful
technique for screening RNA species’ landscapes and their dynamics
in an unbiased way. While several advanced methods exist for differ-
ential expression analysis of RNA-seq data, proper tools to anal.yze
RNA-seq time-course have not been proposed.

Results: In this study, we use RNA-seq to measure gene expression
during the early human T helper 17 (T h1 7) cell differentiation and T-cell
activation (Th0). To quantify Th17-specific gene expression dynamics,
we present a novel statistical methodology, DyNB, for analyzing time-
course RNA-seq data. We use non-parametric Gaussian processes to
model temporal correlation in gene expression and combine that with
negative binomial likelihood for the count data. To account for experi-
ment-specific biases in gene expression dynamics, such as differ-
ences in cell differentiation efficiencies, we propose a method to
rescale the dynamics between replicated measurements. We develop
an MCMC sampling method to make inference of differential expres-
sion dynamics between conditions. DyNB identifies several known
and novel genes involved in Th17 differentiation. Analysis of differen-
tiation efficiencies revealed consistent patterns in gene expression
dynamics between different cultures. We use qRT-PCR to validate
differential expression and differentiation efficiencies for selected
genes. Comparison of the results with those obtained via traditional
timepoint-wise analysis shows that time-course analysis together with
time rescaling between cultures identifies differentially expressed
genes which would not otherwise be detected.

Availability: An implementation of the proposed computational meth-
ods will be available at http://research.ics.aalto.fi/csb/software/
Contact: tarmo.aijo@aalto.fi or harri.Iahdesmaki@aalto.fi
Supplementary information: Supplementary data are available at
Bioinformatics online.

1 INTRODUCTION

A RNA-seq experiment provides a snapshot of RNA content
within a cell population. The observed data is in a form of
millions of short nucleotide sequences, which can be used to
construct a de novo transcriptome or aligned against known ref-
erence genome and transcriptome. To quantify expressions of
known genes, a common approach is to count the reads which
are aligned to different genes. The discrete nature of count data
led researchers to model the sequencing data using Poisson dis-
tribution (see e.g. Marioni et a]. 2008). Recently, it has been
shown that the Poisson distribution is insufﬁcient for modeling

 

*To whom correspondence should be addressed

sequencing data because it tends to underestimate the variance
for highly expressed genes. An extension of the Poisson distribu-
tion, the negative binomial distribution, has gained popularity
in modeling gene expression data from RNA-seq (or other
sequencing-based count data) because it can account for this
over-dispersion. Two commonly used approaches which use
the negative binomial distribution to detect differential expres-
sion are DESeq (Anders and Huber, 2010) and edgeR (Robinson
et al., 2010). Another method called baySeq uses an empirical
Bayesian method to estimate the posterior probabilities that a
gene is, or is not, differentially expressed (Hardcastle and Kelly,
2010).

Profiling gene expression over time provides information
about the dynamical behavior of the genes. Storey et a]. (2005)
presented a method that can analyze time series microarray data
in order to assess the differential expression from whole time
series as opposed to the traditional methods, which analyze time-
points independently. More recently, Stegle et a]. (2010) pre-
sented a methodology that uses Gaussian processes (GPs) to
model gene expression over time and to identify the time inter-
vals when each gene is differentially expressed. We have further
extended the GP approach to quantify condition-speciﬁc differ-
ential expression among multiple time-course experiments (Aijo
et al., 2012). These methodologies are not optimal for analyzing
count data due to the different statistical characteristics and, to
our knowledge, next-maSigPro (Conesa and Nueda, 2013) is the
only methodology capable of taking into account the temporal
dimension of RNA-seq time series. In addition, by taking into
account temporal correlation makes it possible to carry out more
detailed analysis of the observed dynamics, e.g. to quantify simi-
larities and differences between the observed kinetics. To that
end, GPs have been used for modeling temporally or spatially
varying likelihood parameters in other fields, e.g. to model the
rate parameter of the Poisson distribution temporally and the
stochastic process that is produced is called as the Gaussian
Cox process (Adams et al., 2009). Similar approaches have
also been popular in geostatistics (Diggle et al., 1998).

Since the discovery of an interleukin 17 producing T-cell
subset, this T helper 17 (Th17) cell lineage has been a focus of
great research interest (Dong, 2008; Park et al., 2005). Th17 cells
have been shown to play an important role in autoimmune dis-
eases and inflammation. Recent studies have identified transcrip-
tion factor genes Rorc and Stat3 as the key regulators of the early
Th17 differentiation in murine (see a review in Ivanov et al.,
2007). Naive human T cells are activated through the T-cell re-
ceptor (TCR) by ozCD3 and ozCD28 and Th17 cells are polarized

 

© The Author 2014. Published by Oxford University Press.

This is an Open Access article distributed under the terms of the Creative Commons Attribution Non—Commercial License (http://creativecommons.org/Iicenses/by/
3.0/), which permits non—commercial re—use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re—use,

please contact journals.permissions@oup.com.

112 /810's113um0 [p.IOJXO'SOilBIIHOJUTOTQ/ﬁdllq 11101; prBOIIIAAOG

9IOZ ‘09 lsnﬁnv uo ::

7.21.75 et al.

 

from the activated T cells by exposing the cells to TGF-ﬂ, IL—1,B
and IL—23. The goal of gene expression proﬁling in the early
phase of Th17 differentiation is to gain insight into the process
of differentiation by unraveling dependencies between key fac-
tors and to understand how the differentiation signal propagates
through various pathways and gene regulatory networks. This
knowledge could potentially prove useful in identifying bio-
markers for immune-related diseases and in design of therapeutic
interventions.

We present a methodology, DyNB that is built on the negative
binomial likelihood and GPs. Non-parametric GP regression is
used to model gene expression over time and the model inference
is carried using the Bayesian reasoning. We demonstrate the ap-
plicability of DyNB by analyzing RNA-seq time-series datasets.
We also show how DyNB can be used to study relative differ-
entiation efﬁciencies between biological samples. The differen-
tially expressed genes detected by DyNB as well as estimated
differences in differentiation efﬁciencies for selected genes are
validated using qRT-PCR.

2 METHODS
2.1 GPs

The GP prior for functions is a collection of random variables such that
distribution for any ﬁnite subset (index set) X is deﬁned as

FlX, 6 ~ N(m, K), (1)

where F represents the process at X, 6 is the set of hyperparameters, m is
the mean of the process, and K is the covariance matrix. In our applica-
tion, the index set X of the random variables is time. We deﬁne the
covariances between pairs of random variables as follows

Cov(F(tp), F(tq)) = k(tp, 1,): 616xp(— 2%2 |tp — 1,, P), (2)

where k(-, -) is the squared exponential covariance function and
6: (61, 62)T. The (i,j)th element in the matrix K is given by k(t,-, tj).

2.2 A time-varying negative binomial distribution

Read count data are commonly modeled using the negative binomial
distribution (Anders and Huber, 2010; Robinson et al., 2010)

Y ~ NB(r, p), (3)

where r is a predeﬁned number of failures and the probability of success
is p. We will parameterize the negative binomial distribution with mean
u = E{Y} =pr/(1 —p) and variance 02 =Var{Y} =pr/(1 —p)2. Thus, we

solve p as a function of u and 02 as

 

p: (4)

and similarly r

 

r_ 02 _ M v 
hence we can write Y ~ NB ()1, 02). We assume to have M repli-
cates (j: 1, . . . , M) in N timepoints (i=1, ...,N),
i.e., YJ-(ti) ~ NB(u(t,), 0(t,)2). Observed read count data yj(t,)(j= 1, . . . ,
M, 1': 1, .. . , N) is collectively denoted as y. We omit the index of a gene
for notational simplicity.

Let us write the mean of the negative binomial distribution as a func-
tion of a random process F, i.e. Y ~ NB(g1(f), 02), where f is a realiza-
tion of a GP. In the case of a GP, we deﬁne g1(f(t,-)) = f(t,-), where f(t,-) is a

value of the random process at the i—th timepoint. Then we can write the
likelihood of the data as follows (see Supplementary Equations S2
and S3)

PW, X 9)   x (1 — z(f<r.-)))S“<’i”«maxim. (6)
where 

sac.» =  (7)
and

cam» =  (8)

a(t,)2

2.3 A time-varying negative binomial distribution with
time scaling

We also consider a situation where we possess a priori knowledge that the
biological replicates are differentiating in different time scales. In this
study, we assume that the different time scales between biological repli-
cates can be modeled as [j = t/kj. The different time scales are taken into
account via the GP realizations f(tj), j= 1, .. . , M

F0000 + 5601/ ’9'»)

p(ylf, Xa 9a 19 2 H M1,)! F(a§(f(ti/kj)))

je{1,...,M}
ie{1,...,N}

(9)
X — €(f(ti/kj)))§(f(li/kj)) €(f(ti/kj))yj(li),

where k= (k1, . . . , kM) are the replicate-speciﬁc time-scaling factors.
Often one wants to analyze time scaling with respect to one of the rep-
licates, e.g., i—th replicate, which can be achieved by constraining k, = 1.
This also makes the model identiﬁable.

The statistical dependencies of the variables in our model are depicted
in Supplementary Figure S1 using the plate notation.

2.4 Variance estimation and normalization

The variance for the negative binomial distribution is estimated using the
approach described in Anders and Huber (2010), i.e. we model the vari-
ance as a function of the read count using a smooth function. The idea
behind the variance estimation is that genes expressed in a similar level
have a similar variance and sharing information between genes improves
variance estimation (Anders and Huber, 2010). In other words, (7(a)2 in
Equations (7) and (8) are obtained from a polynomial of degree 2 giving a
robust variance estimate as a function of the read count. The second
order polynomial is ﬁtted to the observed read counts and variances
across timepoints and genes.

To account for different sequence depths of the samples (over all
the replicates and timepoints), we make the read counts between
different RNA-seq runs comparable by scaling factors, which are esti-
mated using the procedure presented in Anders and Huber (2010).
Instead of scaling the discrete read counts, the scaling is performed on
the GPs samples f.

2.5 Bayesian inference for transcriptome dynamics

By using the likelihood in Equation (9), we can write the marginal like-
hhood

p(yIX, e, k) = [mm X, e, k) p (ﬁx a, k)d f. (10)
where we have marginalized over the possible realizations of F. In this

case, the integral in Equation (10) is not analytically tractable and we
resort to Markov chain Monte Carlo (MCMC) methods. A common

 

i114

112 /810's113um0 [p.IOJXO'SOilBIIHOJUIOIQ/ﬁdllq 11101; prBOIIIAAOG

9IOZ ‘09 lsnﬁnv uo ::

Methods for time series analysis of RNA-seq data

 

practice is to marginalize over all the parameters, which in our case
include f, k and 6

NB distribution

r—Aq
p(ylf, X)

Gaussian distribution prior prior

r—’— A A
p(le)= / p(f|X, e, k) p(6)d6 p(k)dk df.

 

=17(fIX)
(11)
For the integration in Equation (11), we construct a Metropolis—
Hasting algorithm presented in Algorithm 1.

 

Algorithm 1 A Metropolis—Hastings algorithm for posterior sampling of
parameters 6, k and f.

 

Require: y, X
Initialize: (9(0), 160), i<°>
fori=0toN—1d0
Sample: it ~ “[0,1]
Sample: 6* ~ q9(6*|6(i))
Sample: k* ~ qk(k*|k(i))
Sample: 1* ~ qf(f*|f(i), X, 6*)

- - p9(6*)pk(k*)pi(t*)p(ylt*.k*,X) c1916”16*)q11k“)Ik*)qi(t<”|t*.X,6*) }
If u < mmi 1’ p.160))pk(k(i))pi(t®)p(ylt<0MAX) 09(9*|9(i))qk(k* 1160mm 11011.6(”)

then
6041) (_ 6*, k(i+1) (_ k>l<, f(i+1) (_f*
else
6041) (_ 6(1), k(i+1) (_ kn), f(i+1) (_ 1(1)
end if
end for

 

We assign the uniform prior distribution for the hyperparameter 62, i.e.
179(6) = U[0.5, 1], to favor smooth GP realizations and a symmetric prior
pk(-) for time-scaling factors k-, j = 1, . . . , M, which is centered around
identity scaling (Fig. 5A). The parameter 61 is set empirically to account
for large differences in gene expression counts y between low- and high-
expressed genes (from 1 to approx. 5 X 105 in our case). Thus, 61 is ﬁxed
to a gene-speciﬁc and data-dependent value 10 Stdev{y}. The GP prior
per gene (pf) is deﬁned by the mean vector and covariance matrix, which
is parameterized by the parameters 01 and 02 (which have a similar role as
61 and 62). Again, in deﬁning the mean m and 01, we should take into
account the large range of different read count magnitudes; thus they are
deﬁned separately for each of the genes. The mean vector is deﬁned as
in:  and m = 500W and 02 =0.75.

In our implementation, we use a truncated normal distribution as the
proposal distribution qg, where the last accepted sample 6?) is the mean and
the variance and the boundaries are predeﬁned, i.e. NW5, 11(6g), 0.012). Our
choice of the proposal distribution for the time-scaling factors k is an
uniform distribution, where the probabilities for the three allowed transi-
tions, i.e. + 4h, —4h and 0h, are 1/3. For the proposal distribution qf we
use the GP prior whose mean is the last accepted sample f“) and the co-
variance matrix K is deﬁned by the inputs X and the hyperparameters 6*.

Using the accepted samples f“) we estimate the posterior mean and
(co)variance of the distribution using the standard sample estimators. The
marginal likelihood is estimated using the harmonic mean of the likeli-
hoods of the samples from the posterior distribution as presented in
Newton and Raftery (1994), where the idea is to use the parameter pos-
terior as the importance sampling function

—1
1 m . . .

~ —§:p X,1"),6(’),k(’)‘1 ,
p(yIX) (mil (yI )

where l"), 6(1), k“) ~ p(f, 6, kly).

(12)

Another variable whose posterior distribution we are interested in is k
whose posterior we also get directly from the MCMC chain. Moreover,

the estimated marginal likelihoods are used for model selection purposes
as we will see in next section. The convergence of the chains was assessed
using the potential scale reduction factors as described in Gelman and
Rubin (1992), and the results conﬁrming the convergence are depicted in
Supplementary Figure S2.

2.6 Quantiﬁcation of differential dynamics

In this study we want to answer the question whether a gene is differen-
tially expressed between different conditions, namely Th0 and Th17 lin-
eages, and we assume to have replicated time series measurements from
these two lineages. From now on we consider only two conditions but the
same methodology can be easily generalized for any number of conditions
(Hardcastle and Kelly, 2010; Aijo et al., 2012). The null model, M0,
denotes that the Th0 and Th17 lineages behave similarly, which we im-
plement by ﬁtting a single DyNB model to Th0 and Th17 measurements.
The alternative model, M1, denotes that the two lineages behave differ-
ently, which we implement by ﬁtting one DyNB model to Th0 and an-
other DyNB model to Th17. Assuming equal prior probabilities for both
models, the evidence for the alternative model is quantiﬁed by the Bayes
factor (BF)

F: p(yIX, M1)
p(yIX, Mo)°

By following the BF interpretation chart described in Jeffreys (1998), a
BF 2 10 should be thought as strong evidence for the model M1 over the
model M0. BFs were recently used for model selection purposes in the
context of identifying alternative splicing events between biological sam-
ples (Katz et al., 2010).

(13)

2.7 Human-activated T and Th17 cells

CD4+ T cells were isolated from the umbilical cord blood collected from
healthy neonates born in Turku University Hospital; Hospital District of
Southwest Finland with approval from the Finnish Ethics Committee.
CD4+ T cells were isolated from umbilical cord blood samples using
Ficoll-Paque and anti-CD4 magnetic beads. For activating CD4+ T
cells and inducing polarization of Th17 phenotype the cells were activated
and stimulated as indicated in Figure 1A and as previously described
(Tuomela et al., 2012). The polarization was conﬁrmed as described by
Tuomela et al. (2012). Strand-speciﬁc RNA-seq libraries were prepared
from 2—5 ug of total RNA (Parkhomchuk et al., 2009), bar-coded and
multiplexed (3 to 4 samples per lane) and 40—nt paired-end reads were
obtained on an Illumina HiSeq2000. The gene expressions were proﬁled
from Th0 and Th17 cells at the ﬁve timepoints, 0, 12, 24, 48 and 72 h with
three biological replicates. The Ensembl gene models were used in the
gene expression estimation.

3 RESULTS
3.1 Temporal modeling of RNA-seq data

Using the model described in Section 2, our ﬁrst goal is to esti-
mate a smooth representation of gene expression dynamics based
on the measured read counts. Smoothness of expression dy-
namics is enforced by the GP prior, and agreement of expression
dynamics with the read count data is quantiﬁed using the nega-
tive binomial likelihood. To avoid overﬁtting, the inference is
done using the Bayesian analysis, and thus the ﬁnal model ﬁtting
estimate is obtained by integrating over parameters using an
MCMC sampling technique.

Applying the aforementioned methodology without the time-
scaling option to RNA-seq data, we estimated the smooth rep-
resentations of the underlying gene expression in Th0 and Th17
lineages. The posterior means (solid curves) of the speciﬁc Th0

 

i115

112 /810's112um0 [p.IOJXO'SOIlBIHJOJUIOICI/ﬁdllq 111011 pop1201um0q

9IOZ ‘09 lsnﬁnv uo ::

7.11.75 et al.

 

A
Activation @ —>

Th0

CD4+ T cells Adm ©>
—>

Polarization
Th17

| I I I I

0 12 24 48 72

 

 

 

 

 

 

 

 

 

 

 

 

 

 

Time,t(h)
B | | | |
i; 400 _ IL17A O _
E 0 1st replicate
8 300 — 0 2nd replicate _
U 0 3rd replicate
(U Q“
9 _ ‘QN _
U 200 58
ﬁ
ﬁ 100 — <> 0 _
g O
0
Z 0 _ A ; A 4' _ _
| | | I I
C 1200 | | | i .
“i IL17F _
E“ 0
§ 800 - —
"C
(u _
2
8 400 _
.N
E
g _
0
Z 0 _
D | | | | |
£1 RORC O
E“ 1500 - <> _
:5
O
0
8 1000 -
9
'C
(D
E 500 ‘
(U
E
0
Z 0 _ 1 I l l I
0 12 24 48 72
Time,t(h)

Fig. 1. Transcriptome dynamics of Th17 marker genes. (A) T helper
precursor cells isolated from cord blood are activated using plate-
bound ozCD3 and soluble ozCD28 in the presence of ozIFN-y and ozIL-4
yielding the cells to follow the Th0 lineage. Th17 commitment is achieved
by activation and polarization condition, including IL-6, IL-1,B and TGF-
,8. Cells were harvested at 0, 12, 24, 48, and 72 h. From the harvested cells
the RNA was extracted and used for preparation an RNA-seq library.
(B) The estimated smooth representation of IL] 7A dynamics without
time scaling. The read counts are on the y-axis. Circles and diamonds
mark the measurements from Th0 and Th17 cells, respectively, and the
replicates are distinguish with different colors. The solid curves are the
posterior means of the speciﬁc Th0 and Th17 models (M1) with corres-
ponding 95% CIs (shaded areas around means). (C and D) Same as (B),
but the depicted results are for the IL] 7F and RORC genes

and Th17 models (M1) together with corresponding 95% CIs
(shaded areas around means) for IL] 7A, IL] 7F and RORC are
depicted in Figures lB—D.

For example, the cytokine IL17A is known to be highly ex-
pressed in Th17 cells and its expression is commonly used to

assess the Th17 polarization efﬁciency (Brucklacher-Waldert
et al., 2009). The strong induction of IL] 7A and IL] 7F in the
Th17 differentiation is apparent by the data. Based on visual
assessment, however, the induction of IL] 7A and IL] 7F behaves
differently among the replicates.

3.2 Modeling of variable differentiation efficiency

To study variable differentiation efﬁciencies in IL17 genes in an
unbiased manner, we repeated the analysis but now taking into
account the possibility of different time scales between the repli-
cates. The model with time scaling allows the samples to be
decelerated/accelerated relatively to each other, so that their
scaled behavior is similar. We ﬁxed the time scale of the
second sample and allowed the other two samples to be acceler-
ated or decelerated independently of each other using the trans-
formation t/kj. Another choice could have been a time shift,
t+sj, which moves linearly the whole time series together with
the start point. Because in our case the cells are activated and
polarized exactly at the same time, we wished to keep the start
point ﬁxed across the samples. The transformation is illustrated
in Figure 2A, where the axis in the center corresponds to the case
without time scaling and the top and bottom axes correspond the
cases of 32 and —32h time differences at 72h due to the time
scaling (corresponding to k = 5/9 and k = 13/9), respectively.
We constrained the effects of scaling to be discrete, i.e. from
—32 to +32h at the end of the time series (72 h) in 4h steps.
To demonstrate the methods applicability for estimating differ-
entiation efﬁciencies, we carried out a simulation study. Using
IL] 7A as a template proﬁle, we generated two time series (2nd
and 3rd replicate) with a similar behavior and third one (the ﬁrst
replicate) which is a delayed version of the two, i.e. the timepoint
72h corresponds to 48 h. The method correctly inferred that the
ﬁrst replicate is delayed compared with the other two replicates
as depicted in Figure 2B. Finally, the estimated posterior distri-
butions of time differences depicted in Figure 2C demonstrated
the method’s accuracy in estimating differences in differentiation
efﬁciency.

The results with time scaling for the marker genes IL] 7A, IL] 7F
and RORC are depicted in Figures 3B—D, respectively. The effect
of time scaling is visualized by transforming the measurements
based on the time-scaling parameter posterior mean: e.g. IL] 7A
is delayed over 24h at 72h in the ﬁrst Th17 sample. As expected,
uncertainty of the estimates, especially at the end of time series,
increases due to the time scaling. For the marker genes IL] 7A and
IL] 7F, however, we notice that the time scaling is able to improve
the model ﬁt. To validate our observation of different time scaling,
we performed a kinetic assay of IL] 7A, IL] 7F and RORC mRNA
levels throughout the early Th17 differentiation using qRT-PCR
in the same biological samples as the RNA-seq (Fig. 4;
Supplementary Table S1). Note that because time scaling (i.e. dif-
ferentiation efﬁciency) is a replicate-speciﬁc random effect we need
to use the same samples for qRT-PCR validation. These con-
ﬁrmed our conclusions: expression of IL] 7F and IL] 7A was
delayed in the ﬁrst and third series, while expression of RORC
behaved similarly across the samples.

Next we wanted to conﬁrm the presence of different time
scaling by studying the posterior distribution of the time-scaling
genome wide by repeating the analysis for all expressed genes

 

i116

112 /810's112um0 [p.IOJXO'SOIlBIHJOJUIOICI/ﬁdllq 111011 pop1201um0q

9IOZ ‘09 lsnﬁnv uo ::

Methods for time series analysis of RNA-seq data

 

 

 

A
Deaccelaration I I | I |
k=9/5 0 12 24 48 72
NoscaHng I I I I II I II I II I II II I II
k=1 0 12 24 48 72
<—
Acceleration I_I_I—I—I
k=9/13 0 12 24 48 72
Time, t/k (h)

Simulate data with noise such that the
2nd and 3rd replicate are behaving similar but
the 1st replicate is delayed 24 hours at 72 hours.

 

| | | | I

  
    

_ 0 1st replicate
400 0 2nd replicate
0 3rd replicate

300 — — Posterior mean estimate

200 —

100 —

 

Normalized read count, y(t)

 

 

 

 

 

 

0 12 24 48 72
Time,t(h)

C 0-6 I I I I I I I I I I I I I I I
3 — 0 1st replicate —
i 0 3rd replicate
g 0.4 — —
.Q
(U
.C) _ _
O
a
g 0.2 — _
.9.
U)
o _ _
0.

00 I I I I I I I I I I I I I I I

-32 -16 0 16 32

Time difference at 72 h (72/k-72) (h)

Fig. 2. Modeling differentiation dynamics. (A) An illustration showing
the effects of the time scaling. The axis in the center panel shows the
unsealed time axis. The axes in the top and bottom panels show the
maximum allowed deceleration (—32h at 72 h) and acceleration (32h at
72 h) relative to the unsealed case, respectively. (B) The estimated smooth
representation of the simulated data with the time scaling. The ﬁrst rep-
licate is a delayed version of the second and third replicates. The red
arrows illustrate how much the measurements are effectively moved
due to the time scaling. (C) The posterior distribution of the time differ-
ences at timepoint 72h

(i.e. at least one read in Th0 and Th17 samples). To detect dif-
ferentially expressed genes between the Th0 and Th17 lineages,
we used the following criteria: (i) BF > 10, i.e. strong evidence for
M1 over M0, and (ii) fold-change>2 in at least one timepoint.
These criteria gave us 698 differentially expressed genes. Then we
studied how presence and absence of estimated time-scaling par-
ameters differ between the Th0 and Th17 lineages for each of the
differentially expressed genes. The results are depicted as 2D
histograms in Figure 5A where the ﬁrst (top panel) and third
replicate (bottom panel) are analyzed separately. In both repli-
cates, there are many genes with no time scaling effect, and thus
they behave similarly to the second replicate. In the ﬁrst repli-
cate, the probability mass is partly distributed to the left lower
quadrant, which corresponds to cases where a gene is decelerated
in both lineages in the ﬁrst replicate relative to the second repli-
cate. We can conclude that in terms of genome-wide expression

 

400 _ IL17Awith scaling O _

 
    

0 1st replicate

300 — O §2nd replicate

0 3rd replicate
Q /\

200 —

100 —

Normalized read count, y(t) >

 

 

 

1200 I I I
_ IL17F with scaling _

800 —

400 —

Normalized read count, y(t) w
|

 

 

 

 

1200 —

1000 —

500 —

Normalized read count, y(t) O

 

 

 

I l | | |

 

0 12 24 48 72
Time, t (h)
Fig. 3. Perturbated differentiation dynamics. (A) The estimated smooth
representation of IL] 7A dynamics with the time scaling. The red arrows
illustrate how much the measurements are effectively moved due to the
time scaling. (B and C) Same as (A), but the depicted results are for the
IL] 7F and RORC genes

dynamics the ﬁrst and third replicates are different from each
other and that the third and second replicates are similar to each
other since the mass in Figure 5A (bottom panel) is centered
strongly around the point (0, 0).

Figure 5B and C shows the distributions of time differences
between the replicates over all the differentially expressed genes
for Th0 and Th17 lineages, respectively. Histograms in Figure 5B
and C suggests that both the activation (Th0) and differentiation
(Th17) are delayed in the ﬁrst replicate. We did not observe a
difference in differentiation efﬁciencies for all differentially ex-
pressed genes but there is clear shift of the probability mass to-
wards deceleration. Whereas, for the third replicate the posterior
distribution is centered around the region corresponding to no
time scaling. We conclude that the ﬁrst replicate differs from the
other replicates in its differentiation kinetics.

3.3 Comparison of temporal and timepoint-wise analysis

In order to study advantages and disadvantages of our temporal
analysis, we carried out a differential expression analysis at the
individual timepoints using DESeq tool for comparison

 

i117

112 /810's112um0 [p.IOJXO'SOIlBIHJOJUIOICI/ﬁdllq 111011 popeorumoq

9IOZ ‘09 lsnﬁnv uo ::

7.21:in et al.

 

 

A 20 I I I |
1 st replicate IL 1 7A
— § 2nd replicate 3%:—
... 3rd replicate
3 10 — Q *—

 

 

 

 

02:44

#11?--<H> 14>
—|

 

 

 

 

B 20 IL17F%
3 1° ‘ as i *—
_ 1 _
0 ii: I I I I—

C 20 I I I I RORCI

10— i ﬁ * *—

AACt

 

 

0&1: I I I I—

 

 

 

 

 

 

 

 

 

 

 

0 12 24 48 72
Time,t(h)
D Th0 E Th17
r=0.47, p=0.08 r=0.96, p=3e-8
| I I I | I I I
3.0 —IL17A — -IL17A —
2.0 — — — - —
1.0 — — — —
§  3" I I I ‘” I | |
g r=0.78, p=5e-4 r=0.90, p=4e-6
«‘é’ 3_o —IL17F — -IL17F —
3 _ _ _ _
8 2.0 - - - , -
‘0 _ _ _ _
(U
2 1.0 3 - 3 . -
U _ _ _ _
 O_O ‘9 I I I ‘I I I I
g r=0.64, p=1e-2 r=0.99, p=4e-13
<zD 3.0 -RORC — -RORC /' —
2.0 - . - - -
_ . _ _ _
1.0 -* - -' -
 _| | | _| I I I

 

 

 

 

 

 

O 5 10 15 20
M01

0 5101520

Fig. 4. Validation of marker gene expression. (A) qRT-PCR time-series
measurements of IL] 7A mRNA levels in the same samples where RNA-
seq was performed. The error bars are depicting the SDs. The colors
distinguish the different samples. (B and C) Same as (A) but for IL] 7F
and RORC, respectively. (D) The scatter plots illustrating the replicate-
speciﬁc correspondence between the qRT-PCR and RNA-seq gene ex-
pression estimates of the IL] 7A (top panel), IL] 7F (middle panel) and
RORC genes (bottom panel) over time in Th0 cells. The correlation is
quantiﬁed using the Pearson correlation coefﬁcient (r). (E) Same as in (D)
but for Th17 cells

purposes. For each timepoint we call a gene differentially ex-
pressed if multiple testing corrected (Benjamini—Hochberg
method) padj<0.01 and the absolute value of the log 2 fold-
change is >1. Combining differentially expressed genes from dif-
ferent timepoints, timepoint-wise analysis gives a total of 823
genes, which is in agreement with the number detected by

 

    

 

 

 

A  + l I | | l I | | I I | | I I | 1< B
3 1st replicate : 20
16 ‘ — 16 8 0'20 Th0 1st replicate
: 0:, 3rd replicate
' 12 ,E’  Prior
E 0 g 3 010
[x
E —16 “ g
I— ' Z 2
E P _ 0 0.00
a)  I I I I I I I I I I I I I I I 1-
§  : l I | | l I I | | l I | | I I |
Ina; :3rd repIIcate 80 m C 0.20
'6 16: 8
“g - 60 a z
I: 0 ’ 40 2 5:10-10
8
-16 20 E
I Z 0 0.00
 + I I I I I I I I I I I I I I I 1- -32 -16 0  

 

 

 

-32 -16 0 16 32
Time difference in Th0 (h)

Time difference at 72 h (72/k-72) (h)

Fig. 5. The replicate-speciﬁc differentiation efﬁciencies. (A) Density plots
representing the distribution of estimated time differences in gene level in
the Th0 and Th17 lineages. A gene is on diagonal if the estimated time
differences in the Th0 and Th17 cells are the same. The results for the ﬁrst
and third replicate are depicted in top panel and bottom panel, respect-
ively. (B) Presence of time scaling in Th0 lineage among the 698 differ-
entially expressed genes. The dashed line represents the prior distribution
of the amount of time scaling at 72 h. The red area shows the posterior
distribution of the time scaling for the ﬁrst replicate and the purple shows
the posterior distribution for the third replicate. (C) Same as (B) but here
the focus is on Th17 lineage. The focus is on the differentially expressed
genes in (B and C)

DyNB. Comparing directly the numbers of genes detected by
the frequentist DESeq and our Bayesian DyNB may not be
exactly meaningful due to differences in deﬁning the detection
thresholds, and simply because timepoint-wise analysis has four
times more differential expression tests. Instead, results from the
two methods need more careful investigation. Overlap of the
differentially expressed genes identiﬁed by the two approaches,
DyNB and DESeq, are depicted in Figure 6A (top panel). Out of
698 differentially expressed genes identiﬁed by DyNB, 546 are
also detected by the DESeq. Figure 6A (bottom panel) shows a
similar Venn diagram but now using only the top 698 genes from
the timepoint-wise analysis (ranked according to the adjusted
P—values). In this case, 500 genes overlap between temporal
and timepoint-wise analysis. The overall agreement between
the two methods is demonstrated by the hypergeometric test of
gene set overlap (P< 1 e—16).

Next we wanted to see how the overlap between temporal and
timepoint-wise analysis changes when we consider separately the
top 698 genes that are identiﬁed by DESeq exactly at one, two,
three, or four timepoints. The number of genes belonging to each
class is shown in Figure 6B. The agreement between the two
methods for different gene classes was quantiﬁed using the preci-
sion—recall metric as a function of the statistical signiﬁcance from
DyNB analysis (Fig. 6C). As expected, the level of agreement be-
tween the presented method and DESeq correlates with the
number of timepoints where DESeq identiﬁed genes to be differ-
entially expressed. For example, the genes differentially expressed
in all four timepoints based on the DESeq analysis are all detected
by DyNB as well. We conclude that, on average, both the tem-
poral and timepoint-wise analysis detect largely the same genes,
which have a strong differential expression, as expected. However,

 

i118

112 /810's112um0 [p.IOJXO'SOIlBIHJOJUIOICI/ﬁdllq 111011 popeorumoq

9IOZ ‘09 lsnﬁnv uo ::

Methods for time series analysis of RNA-seq data

 

 
  

A B
DESeq DyNB 2
N=823 N=698 N=206 V

277 546 152

Number of of time points
where detected

 

 

 

 

 

C
9 1.0 -—1: ' ' ' '-
DESeq DyNB E
N=698 N=698 g g
a) > _
198 500 198 (>3 2 0'5 Number ofoftime points
C :1: _ where detected _
g 3 —1 — 3
g _ 2 — 4 _
L 0.0 . . . .

0.0 0.5 1.0
Fraction of genes

Fig. 6. A comparison of the results with DESeq. (A) The overlap between
the sets of differentially expressed genes identiﬁed by DyNB and DESeq
(top panel). In the bottom panel we take into account only the top 698
hits from DESeq analysis to make the gene sets equal in size. (B) The
number of the top 698 DESeq hits that are found to be differentially
expressed exactly at one, two, three or four timepoints in the DESeq
analysis. (C) A quantiﬁcation of how the genes belonging to the classes
presented in (B) are found by the presented method using the precision
metric. The DESeq hits are taken into account in the order of descending
signiﬁcance (x-axis), which are used to evaluate precisions. For example,
precision is one when all the considered genes are found in the set given
by DyNB

the overlap is not perfect and different results are reported for
genes whose differential expression is weaker or noise level
higher and for genes which are affected by variable differentiation
efﬁciency. Additionally, DyNB provides insights into differenti-
ation efﬁciencies between biological replicates, which is not pos-
sible with timepoint-wise or traditional temporal methodologies.

DyNB allows each gene to have its own time scalings between
replicates. Thus, we studied the effect of the assumption that all
genes would be affected similarly by the differential differenti-
ation efﬁciency. This was done by introducing informative delay
priors (Supplementary Fig. S3A), which closely resembles the
posterior distribution of time-scaling parameters obtained from
the application of DyNB (Fig. 6C). After applying DyNB with
the strong time-scaling prior, we noticed that the distributions of
the estimated time differences of the differentially expressed
genes (the same criteria as before) resembled the informative
prior distributions as depicted in Supplementary Figure S3B,
indicating that the time differences can be estimated even without
strong regularization. Consequently, we believe that it is more
beneﬁcial to apply DyNB without the informative prior distri-
bution because, e.g. in the context of Th17 differentiation only a
fraction of genes respond to the differentiation.

We also compared DyNB (with and without the informative
delay prior) with the next-maSigPro (Conesa and Nueda, 2013).
Interestingly, next-maSigPro (Benjamini-Hochberg—corrected P-
value <0.01 with the negative binomial model) showed the weak-
est level of agreement with the other methods as depicted in
Supplementary Figure S3C.

Three representative examples detected by DyNB, but not
identiﬁed by DESeq from timepoint-wise analysis with the afore-
mentioned criteria, are shown in Figure 7. These genes illustrate
the beneﬁts of the time-scaling parameter. The gene ISG20 has

 

 

A
I I I

S 400 _ [8620 with scaling ‘

>2 8 123tdrep|i|catetz O

E _ n rep Ice 9 _

8 300 0 3rd replicate

O

'o «94‘

g 200 —

'C

3

ﬁ 100 _

E

0

Z 0 _

E 300

‘2 _

E

§ 200 —

'C

(U _

2

'0

g 100 —

E

E _

o

2 0 — O . —
| |

 

 

 

 

   

 

 

 

C I I I
q: 2000 — TIAM1 with scaling —
5. ¢>
g 1500 — o . _
O
'0
g 1000 — '
O
E 500 .
"r; — O i o
E
O
z o — —
I I I I I
0 12 24 48 72

Time, t (h)

Fig. 7. Examples of differentially expressed genes detected exclusively by
DyNB. (A) The estimated smooth representation of ISG20 dynamics with
the time scaling. (B and C) Same as (A), but the depicted results are for
the RABIS’ and TIAM1 genes

similar behavior as the IL] 7A gene, i.e. it is induced between the
last two timepoints (48 and 72 h) but the activation is delayed in
the ﬁrst replicate. ISG20 has been reported to have a role in Th17
cells (Pan et al., 2013). The members of the RAB protein family,
e.g. RAB3, are known to play a major role in protein-mediated
transport and in fusion of intracellular structures and are highly
expressed in various cells of immune system, especially after ac-
tivation (Pei et al., 2012). TIAM1 (T lymphoma invasion and
metastasis protein 1) has shown to have a role in T-cell trafﬁck-
ing through Rac activation (Gerard et al., 2009). On the con-
trary, Supplementary Figure S4 shows two representative genes,
KIF]] and MAPIB, which are detected by the timepoint-wise
analysis, but not by the temporal analysis implemented in
DyNB. Temporal analysis together with the possibility to ac-
count for variable differentiation efﬁciencies can ﬁlter out
those genes for which the replicated Th0 and Th17 proﬁles are
seemingly similar and thus likely false positives.

4 DISCUSSION AND CONCLUSIONS

We presented the ﬁrst statistical method, DyNB, to study RNA-
seq dynamics together with a method to correct for, or detect,

 

i119

112 /810's112um0 [p.IOJXO'SOIlBIHJOJUIOICI/ﬁdllq 111011 popeorumoq

9IOZ ‘09 lsnﬁnv uo ::

7.217in at al.

 

different time scales between RNA-seq time-series datasets.
DyNB is compared with a commonly used method, DESeq
that relies on the same statistical assumptions but analyzes
data from each timepoints separately and, therefore, ignores cor-
relations between timepoints. As expected, the comparison
showed that the agreement between the methods is high but at
the same time temporal modeling approach has some beneﬁts.
The most notable advantage is the possibility to take into ac-
count different differentiation efﬁciencies between biological rep-
licates. Indeed, many experimental systems in cell development
and differentiation display subtle kinetic differences between rep-
licates, which are not necessarily apparent until large-scale tran-
scriptomics data are obtained. This method might critically help
improve the interpretation of such experiments. Concerning
future improvements, the proposed straightforward MCMC
sampling scheme might lead to inefﬁcient sampling if more par-
ameters are marginalized. In those cases, sampling could be im-
proved by using more elegant samplers, such as elliptical
sampling (Murray et al., 2009).

Our results show that a temporal analysis can bring insights
into analysis of differentiation processes and help in the analysis
of time-series datasets. We demonstrated applicability of DyNB
by applying it to time series RNA-seq data from Th17 and Th0
lineages and identiﬁed novel Th17-speciﬁc genes. We used qRT-
PCR to validate our computational predictions of sample-spe-
ciﬁc time scales. For example, by taking into account differences
in differentiation efﬁciencies, we can identify a more complete set
of differentially expressed genes. In turn, this improves our abil-
ity to discern subtle changes in regulatory pathways and broaden
the scope of targets available for intervention.

ACKNOWLEDGEMENTS

We thank the donors and the personnel of Turku University
Hospital Department of Obstetrics and Gynaecology,
Maternity Ward (Hospital District of Southwest Finland) for
the cord blood collection. We would like to thank Sarita
Heinonen, Marjo Hakkarainen and the staff of the Finnish
Microarray and Sequencing Centre, Turku, Finland for excellent
technical assistance.

Funding: The Academy of Finland [Centre of Excellence in
Molecular Systems Immunology and Physiology Research
(2012—2017); grant 135320]; EU FP7 grant (EC-FP7-
SYBILLA—201106); EU ERASysBio ERA-NET; the Sigrid
Jusélius Foundation; FICS graduate school.

Conﬂict of Interest: none declared.

REFERENCES

Adams,R.P. et al. (2009) Tractable nonparametric Bayesian inference in Poisson
processes with Gaussian process intensities. In: Proceedings of the 26th Annual
International Conference on Machine Learning. ICML ’09. ACM, New York,
NY, pp. 9—16.

Aij0,T. et al. (2012) An integrative computational systems biology approach iden-
tiﬁes differentially regulated dynamic transcriptome signatures which drive the
initiation of human T helper cell differentiation. BM C Genomics, 13, 572.

Anders,S. and Huber,W. (2010) Differential expression analysis for sequence count
data. Genome Biol, 11, R106.

Brucklacher-Waldert,V. et al. (2009) Phenotypical characterization of human Th17
cells unambiguously identiﬁed by surface IL-17A expression. J. Immunol, 183,
5494—5501.

Conesa,A. and Nueda,M.J. (2013) Next-masigpro: dealing with RNA-seq time
series. EMBnet J., 19, 42—43.

Diggle,P.J. et al. (1998) Model-based geostatistics. J. R. Stat. Soc. C Appl. Stat., 47,
299—350.

Dong,C. (2008) TH17 cells in development: an updated view of their molecular
identity and genetic programming. Nat. Rev. Immunol, 8, 337—348.

Gelman,A. and Rubin,D.B. (1992) Inference from iterative simulation using mul-
tiple sequences. Stat. Sci., 7, 457—472.

Gérard,A. et al. (2009) The Rae activator Tiaml controls efﬁcient T-cell trafﬁcking
and route of transendothelial migration. Blood, 113, 6138—6147.

Hardcastle,T.J. and Kelly,K.A. (2010) baySeq: empirical Bayesian methods for
identifying differential expression in sequence count data. BM C
Bioinformatics, 11, 422.

Ivanov,I.I. et al. (2007) Transcriptional regulation of Th17 cell differentiation.
Semin. Immunol, 19, 409—417.

Jeffreys,H. (1998) Theory of Probability. 3rd edn. Oxford University Press, New
York, USA.

Katz,Y. et al. (2010) Analysis and design of RNA sequencing experiments for iden-
tifying isoform regulation. Nat. Methods, 7, 1009—1015.

Marioni,J.C. et al. (2008) RNA-seq: an assessment of technical reproducibility and
comparison with gene expression arrays. Genome Res., 18, 1509—1517.

Murray,I. et al. (2009) Elliptical slice sampling. Proceedings of the 13th International
Conference on Artificial Intelligence and Statistics ( AIST AT S ), JMLR W&CP,
9, 541—548.

Newton,M.A. and Raftery,A.E. (1994) Approximate Bayesian inference with the
weighted likelihood bootstrap. J. R. Stat. Soc. B Methodol, 56, 3—48.

Pan,H.-F. et al. (2013) Expression proﬁles of Th17 pathway related genes in human
systemic lupus erythematosus. Mol. Biol. Rep, 40, 391—399.

Park,H. et al. (2005) A distinct lineage of cd4 t cells regulates tissue inﬂammation by
producing interleukin 17. Nat. Immunol, 6, 1133—1 141.

Parkhomchuk,D. et al. (2009) Transcriptome analysis by strand-speciﬁc sequencing
of complementary DNA. Nucleic Acids Res., 37, e123.

Pei,G. et al. (2012) Immune regulation of Rab proteins expression and intracellular
transport. J. Leukoc. Biol., 92, 41—50.

Robinson,M.D. et al. (2010) edgeR: a Bioconductor package for differential expres-
sion analysis of digital gene expression data. Bioinformatics, 26, 139—140.

Stegle,O. et al. (2010) A robust Bayesian two-sample test for detecting intervals of
differential gene expression in microarray time series. J. Comput. Biol., 17,
355—367.

Storey,J.D. et al. (2005) Signiﬁcance analysis of time course microarray experi-
ments. Proc. Natl Acad. Sci. USA, 102, 12837—12842.

Tuomela,S. et al. (2012) Identiﬁcation of early gene expression changes during
human Th17 cell differentiation. Blood, 119, e151—el60.

 

i120

112 /810's112um0 [p.IOJXO'SOIlBIHJOJUIOIQ/ﬁ(1111] 111011 popcorumoq

9IOZ ‘09 lsnﬁnv uo ::

