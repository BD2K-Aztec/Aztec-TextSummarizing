Vol. 28 ECCB 2012, pages i333-i339
doi: 10. 1093/bioinformatics/bts3 78

 

DELLY: structural variant discovery by integrated

paired-end and split-read analysis

Tobias Rausch,1’3’*, Thomas Zichner‘, Andreas Schlattl‘, Adrian M. St tz‘,

Vladimir Benes3 and Jan O. Korbell’2

1European Molecular Biology Laboratory (EMBL), Genome Biology, Meyerhofstr. 1, 69117 Heidelberg, Germany and
2EMBL European Bioinformatics Institute, Wellcome Trust Genome Campus, Hinxton, Cambridge CB10 18D, UK
and 3European Molecular Biology Laboratory (EMBL), Core Facilities and Services, Meyerhofstr. 1, 69117

Heidelberg, Germany

 

ABSTRACT

Motivation: The discovery of genomic structural variants (SVs)
at high sensitivity and specificity is an essential requirement for
characterizing naturally occurring variation and for understanding
pathological somatic rearrangements in personal genome
sequencing data. Of particular interest are integrated methods
that accurately identify simple and complex rearrangements in
heterogeneous sequencing datasets at single-nucleotide resolution,
as an optimal basis for investigating the formation mechanisms and
functional consequences of SVs.

Results: We have developed an SV discovery method, called
DELLY, that integrates short insert paired-ends, long-range mate-
pairs and split-read alignments to accurately delineate genomic
rearrangements at single-nucleotide resolution. DELLY is suitable
for detecting copy-number variable deletion and tandem duplication
events as well as balanced rearrangements such as inversions or
reciprocal translocations. DELLY, thus, enables to ascertain the full
spectrum of genomic rearrangements, including complex events. On
simulated data, DELLY compares favorably to other SV prediction
methods across a wide range of sequencing parameters. On real
data, DELLY reliably uncovers SVs from the 1000 Genomes Project
and cancer genomes, and validation experiments of randomly
selected deletion loci show a high specificity.

Availability: DELLY is available at www.korbel.emb|.de/software.htm|
Contact: tobias.rausch@embl.de

1 INTRODUCTION

Genomic structural variants (SVs), including gains and losses
of DNA segments and balanced rearrangements, are a major
form of variation in the human genome (Conrad et al., 2010;
Mills et al., 2011; Sudmant et al., 2010). Polymorphic SVs
are a major contributor to common traits, including common
diseases (McCarroll et al., 2008; Stranger et al., 2007) whereas rare
SVs present in the germline are the cause of many rare genomic
disorders (Korbel et al., 2009b; Zhang et al., 2009). Furthermore,
somatic structural rearrangements, often highly complex, play a
pivotal role in the development of aggressive cancers (Rausch et al.,
2012; Stephens et al., 2011). A critical ﬁrst step in associating SVs
with phenotypes is the discovery and precise mapping of these DNA
sequence variants.

 

*To whom correspondence should be addressed.

The introduction of massively parallel sequencing (MPS)
technologies has led to considerable advances in the discovery and
genotyping of structural variants in the germline and in somatic
cells (Campbell et al., 2008; Korbel et al., 2007; Sudmant et al.,
2010). Several complementary approaches have been developed to
leverage MPS data for SV discovery. These include methods using
the analysis of abnormally mapping pairs of MP8 fragments, so—
called paired—end mapping methods (Chen et al., 2009; Korbel et al.,
2007, 2009a), read—depth analysis that detects SVs by analyzing
the read depth—of—coverage (Abyzov et al., 2011; Campbell et al.,
2008; Chiang et al., 2009), split—read analysis that evaluates gapped
sequence alignments to detect SVs (Abyzov and Gerstein, 2011;
Wang et al., 2011; Ye et al., 2009) and sequence assembly that
enables the discovery of novel sequence insertions (Hajirasouliha
et al., 2010). A recent survey of SVs in 185 human genomes by
the 1000 Genomes Project’s (1000GP) SV Analysis Group reported
over 28 000 SVs based on these four SV discovery approaches in
the 1000GP pilot phase (Mills et al., 2011). Paired—end mapping
made the comparably largest contribution to this list of reported
SVs. However, only approaches that combined two complementary
signatures for SV discovery by integrating paired—end mapping and
read—depth analysis met the prespeciﬁed speciﬁcity threshold of a
false—discovery rate (FDR) 310% (Handsaker et al., 2011; Mills
et al., 2011).

Recently, the parameters at which genomes are sequenced by MPS
have considerably changed. Although most reads in the 1000GP
pilot phase had a length of ~36 bp, the average read length used
in the project’s main phase and in current cancer genome projects
has increased by 3—fold (@105 bp). At the same time, the number of
reads is reduced by 3—fold to yield comparable sequence coverage.
Furthermore, several large—scale genome studies have begun to
generate paired—end sequencing libraries with two different insert
sizes (Pleasance et al., 2010; Rausch et al., 2012). One library is
usually smaller than 500 bp, and the other, commonly referred to as
a mate—pair library, is typically larger than 2kb and up to 5 kb, to
facilitate sensitive SV detection across a widened SV size—spectrum
and in repetitive areas of the genome. These changes in sequencing
parameters and strategy signiﬁcantly affect SV discovery. Split—
read analysis methods should beneﬁt from relatively long reads
whereas read counting methods are expected to suffer from a 3—fold
reduction in the number of sequenced reads. Compared to read—
depth and paired—end analysis, split—read analysis has so far been
limited to the detection of small SVs (Ye et al., 2009) as well as
SVs in ‘unique’ genomic regions, devoid of repeats and segmental
duplications (Wang et al., 2011). Most importantly, certain classes

 

© The Author(s) 2012. Published by Oxford University Press.

This is an Open Access article distributed under the terms of the Creative Commons Attribution License (http://creativecommons.org/licenses/by/3.0), which
permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.

112 /§.IO'SIBUJHOprOJXO'SOTlBIHJOJUTOTQ/ﬁdnq 11101; prBOIUAAOG

9IOZ ‘09 lsnﬁnv uo ::

I Rausch et aI.

 

 

Library1 Library2 Libraryn
Mean 3510 bp Mean 280 bp  Mean Xbp
Sd 400 Sd 3o Sd Y

Layout <—-> Layout —> <— Layout -> <-

i l i

Paired-end mapping analysis
Paired-end outlier detection
Structural rearrangement graph creation

Paired-end clustering *
Split-Read Analysis
Reference extraction and indexing

Split-read identification
Consensus computation and alignment

l

Results

Structural Variants at
Single Nucleotide Breakpoint Resolution

Fig. 1. DELLY design: short—range and long—range paired—end libraries are
analyzed for discordantly mapped read pairs. Paired—end predicted structural
variants are then reﬁned using split—reads and reported at single—nucleotide
breakpoint resolution

of SVs, including tandem duplications, inversions, translocations
and particularly highly complex events, are not yet sensitively
ascertained in split—read—based analyses.

Herein, we report a new integrative approach, called DELLY, that
combines short—range and long—range paired—end mapping and split—
read analysis for the discovery—at single nucleotide resolution—of
balanced and unbalanced forms of structural variation, i.e. deletions,
tandem duplications, inversions and translocations, achieving high
sensitivity and speciﬁcity throughout the genome and for SVs falling
into a wide size spectrum. Thereby, DELLY has been speciﬁcally
geared towards enabling SV calling in the presence of different
paired—end sequencing libraries with distinct insert sizes (Fig. 1).
To our knowledge, no single SV detection approach presently offers
such integrative SV calling at nucleotide resolution in MPS data,
which is of relevance for assessing the origin and functional impact
of SVs in individual genome sequencing efforts focused on germline
or somatic genome variation.

2 METHODS

The input of DELLY is a set of aligned MPS reads in SAM/BAM
format (Barnett et al., 2011; Li et al., 2009), where each input ﬁle is
assumed to be a separate library with a distinct insert size median and
standard deviation. All input libraries are analyzed jointly to achieve optimal
sensitivity. The method consists of two separate components, a paired—end
mapping analysis component and a split—read analysis component (Fig. 1).

2.1 Paired-end mapping analysis

For each input BAM ﬁle, DELLY computes the default read—pair orientation
and the paired—end insert size distribution characterized by the median and
standard deviation of the library. Based on these parameters, DELLY then
identiﬁes all discordantly mapped read—pairs that either have an abnormal
orientation or an insert size greater than the expected range. DELLY hereby
focuses on uniquely mapping paired—ends and the default insert size cutoff
is three standard deviations from the median insert size. All SV types induce
a characteristic mapping pattern (Fig. 2) that is leveraged by DELLY in the
following way:

0 ‘Deletions’ are detected as paired—end outliers at the far end of the
insert size distribution but at default library orientation.

0 ‘Inversions’ are detected as abnormally oriented paired—ends where an
orientation change of one read leads to the default library orientation.
Left— spanning and right—spanning paired—ends are differentiated as
outlined in Figure 2.

‘Tandem duplications’ are detected as paired—ends where the ﬁrst and
second read changed their relative order but kept the alignment strand
induced by the default library orientation.

‘Translocations’ are detected as paired—ends mapping to different
chromosomes. Four possible types of translocations are differentiated,
whether the two chromosomes are in sorted order and whether the two
chromosomes are inverted relative to each other (Fig. 4).

All discordantly mapped paired—ends are binned by chromosome and sorted
according to the left—most alignment position. For translocations, DELLY
sorts all paired ends according to the lexicographically smaller chromosome.
This sorted vector of discordantly mapped paired ends is subsequently used
to build an undirected, weighted graph G( V, E) that indicates which paired—
ends support the same structural rearrangement. For each paired—end pi, the
graph G contains one node v,- e V. An edge em]. = {Vi,Vj} GE indicates that
both paired ends support the same SV. This demands that p,- and pj have
the same orientation (change) with respect to their library orientation and
that the absolute difference between the left and right ends of p,- and pj are
within the expected insert size range. The weight of edge evivj, denoted as
w(evivj ), is the absolute difference between the predicted SV sizes induced by
the mapping locations of the paired—ends p,- and pj, respectively. Since this
is not possible for translocations, DELLY takes in this case the sum of the
absolute differences in the left—most alignment position of both read—pairs. To
achieve maximum speciﬁcity, we only cluster paired—ends that show the same
mapping pattern. In particular, we cluster left— and right—spanning paired—
ends separately for inversions and we cluster the four types of translocations
separately. The algorithm to build the graph is a simple line—sweep algorithm
with worst—case running time 0(n2), where n is the number of discordantly
mapped paired—ends for a given chromosome. However, we only need to
traverse the sorted vector from a given paired—end p,- until we reach the ﬁrst
pj, where the distance between the ﬁrst read of p,- and pj is greater than the
expected range. Hence, in practice, the graph G( V, E) can be build very fast,
an example graph is shown in Figure 3.

Assuming ideal conditions, the graph G contains one fully connected
component for each structural rearrangement. Each variant could thus be
identiﬁed by computing the connected components C,- of the graph. Due to
inadequate fragment shearing, sequencing errors, ambiguous read mapping
locations and incomplete reference sequences, most components C,- are not
fully connected. In other words, the subgraph induced by the component,
denoted as Gcl. (Vci , EC, ), is not a clique. We do not discard such components
but rather sort the edges of each component by weight and identify a maximal
clique M,- heuristically in the component C,- using the edge of smallest weight
as the seed of the clique.

emin = evjvk = argminw(e).
eEECi
We then extend this clique M[={Vj,Vk} from the seed—edge by means of
searching for the next best edge es such that

eS = argminw(evlvm) where {vl,vm} e Vci, |M,- ﬂ {vl,vm}| =1
eEECi

and requiring that the subgraph induced by M,- U {121, vm} is a clique. If no such
edge eS exists, the clique is maximal for the seed—edge emin and reported as
the paired—end cluster of size |M,-| for this SV. This procedure by deﬁnition
implies that singleton nodes in G are discarded. The maximal clique M,- is
also used to estimate the start and end coordinate of the SV. In case of a
deletion, for instance, the start and end position is estimated as the maximal
begin position of all paired—ends of the cluster and the minimal end position
of all paired—ends of the cluster, respectively.

Each rearrangement type is analyzed separately and consequently,
deletions, inversions, tandem duplications and translocations can be

 

i334

112 /§JO'S{BUJHO[pJOJXO'SOIlBIHJOJUIOIQ/ﬁdnq 11101; pap1201umoq

9IOZ ‘09 lsnﬁnv uo ::

DELLY: integrated structural variant discovery

 

 

 

 

 

 

 

 

 

 

_) _ _ _ _ _ _ _ "(—
'0 on —> - - - - - - - -—
ac, .E  Target Genome
| L ‘.‘ r
'0 o  
ad 4‘7;  Deletion ‘
E 7:) ' Reference Genome
c1. —)3 ___ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ __ E
Paired-end
Deletion
Call
3 2 
8 a \ /
.11: To _) . , ‘(—
5 C l !
Ig- ‘0 
Deletion
c v on —I>—-(_-—<—
C C . . Target Genome
0.) GE) Tandemb—“l- _ 
E 46,, A  up cations
'5 3 "  Reference Genome
n_ U '<— —>—-
Paired-end
(_Tandem
Duplication

Call

 

analySIS
‘ \.
/.

Split-read

Tandem duplication

 

 

 

 

 

 

 

 

 

 

 

a _ _ _ e
'0 on —>- - - <—
8 c   Target Genome
| .E h 
J: g  Inversmn 
m U _ _ _ Reference Genome
“- —>’ —>’— — —
Left-spanning PE call _
Paired-end
Inversion
Call
3 ‘2 
_41, a —)' _ _ ‘(—
a g I 1c
m l r
D Inversion
—>- - -<—
'2 on —>- - - <—
a) .E . , ,7” Target Genome
I L I '. y‘ ‘.
U a) I v" .'.
E t; I ’3‘: _6"...
“a 7:, l     chrB
n- !X‘ i Reference Genome
—> -  chrA 5
*5 .
 Paired-end—>§
 Translocation 
' Call
8 2 
a) m
+ 3 , \ / (
+3 (U x |
5 C | I
Q .......................................... .._(
U) m f .......................................... 
Translocation

Fig. 2. Paired—end clustering and split—read detection for a deletion (A), inversion (B), tandem duplication (C) and translocation (D)

 

 

 

 

 

 

 

 

Reference _ Deletiqnl D.el.e.ti9r.‘2_(
C jag D .D
C (p. D .3—
: pk D

C P1 D

 

Fig. 3. Graph—based paired—end clustering: a graph G of structural
rearrangements with two connected components C1 and C2 and two maximal
cliques (pi,pj,pk) and (pm,pn). The non—clique edges are in gray. For
simplicity, edge weights have been omitted

overlapping or nested. For rearrangements of the same type that share a
common beginning or end (such as two deletions d1[a,b] and d2[a,c]) the
method currently identiﬁes only a single event, where a possible extension
of the method would be a full enumeration of all maximal cliques in each
connected component.

2.2 Split-read analysis

The paired—end clusters identiﬁed in the previous mapping analysis
are interpreted as breakpoint—containing genomic intervals, which are
subsequently screened for split—read support to ﬁne map the genomic
rearrangements at single—nucleotide resolution and to investigate the
breakpoints for potential microhomologies and microinsertions. The split—
read analysis is a multi—step process, including (i) candidate split—read search,
(ii) SV reference extraction, (iii) indexing and k—mer counting, (iv) detecting
the best supported breakpoint, (v) split—read consensus computation and (vi)
an alignment of the split—read consensus sequence to the SV reference region.

For each putative SV interval SVi, DELLY searches for the local presence
of single—anchored paired ends. A single—anchored paired—end is a read pair
where one read maps to the reference and the other read is unmapped. The

non—mapped read is a likely candidate for a split—read (Fig. 2). Optionally,
DELLY can also use all mapped reads in the breakpoint region to take
into account soft—clipped reads or reads mapped with ‘sloppy’ ends. To
gain maximum speciﬁcity, DELLY records and later enforces for each non—
mapped read one alignment direction (forward or reverse strand), which
can be inferred from the mapped read and the default library orientation.
This default orientation can also be used to infer whether a structural variant
breakpoint of a mapped single—anchored read should be expected to the right
or to the left of the given mapped read. The split—reads are collected efﬁciently
using the following algorithm:

1. Sort all SV start and end breakpoints by chromosome and position.

2. Search bam ﬁles once for single—anchored reads (or optionally all
reads).

3. For each read, use the mapped partner and the default library
orientation to determine the search direction (increasing/decreasing
genomic coordinates) and binary search to detect the closest SV
breakpoint.

4. If a read maps within two standard deviations of a breakpoint, assign
this read to the set of putative split—reads RSV, where ie 1, ...,m and
m is the number of paired—end called SVs.

In centro— and telomeric regions, we frequently observed huge pile—ups
of reads and many SV predictions, indicative of extensive inter—individual
variability and possibly unﬁnished reference genome sequence assemblies
present in these repeat—rich regions. This led to thousands of putative split—
reads for some SV calls that would be prohibitively expensive to align.
However, we also did not intend to a priori exclude such regions, some of
which are known SV hotspots (Mills et al., 2011) and of clinical importance.
As a result, we decided to limit the maximum number of split—reads per SV
interval to |R5Vi| 5L, where the default for L is 1000.

For deletions, the build—up of the split—read alignment reference demands a
simple extraction of the paired—end SV interval from the genome. The preﬁx
and sufﬁx alignments of a split—read are by deﬁnition in the same orientation

 

i335

112 /810's12u1nofp101x0'sor112u1101urorq//zd11q 111011 pap1201umoq

9IOZ ‘09 lsnﬁnv uo ::

I Rausch et aI.

 

Paired-end Call Split-read Alignment Reference

 

 

 

 

 

 

 

C
_o : : :
+3 ; ; ;
E _> _________ - - _ ( 
D Paired-ends Split-reads
8
E 1;: Midpoint : _ _

g «s = :  
c .2 <— —>—' _' ............. 
m E- 6 9- . e ................. .._

l— :5

D
g Left-spanning P_E call
 —> - -= —>- - -=
g Right-spanning PE call
5 :- — —E :- -E
In order, not inverted
ch_rA : = gr:
9 _ ; _ _ _ _ _ _'_ _ _ e
In order, inverted
chrA : A : ChrB
;-_____‘_—_-____E

 

Reverse order not inverted
chrB : : chrA

 

Translocation

a _ _- _ _ _ _ _ _ -_ _ _
Reverse order, Inverted
chrB : :

 

 

chrB 4-—--§-

 ..... 

Fig. 4. The build—up of the split—read alignment reference depends on
the type of paired—end call. For tandem duplications, inversions and
translocations, we modify the reference in such a way that a standard
‘deletion—type’ split—read alignment can be carried out

and in the expected order for deletions. For inversions, tandem duplications
and translocations, a direct alignment to the reference would demand either
a change in the orientation (inversions) or a change in the preﬁx—sufﬁx order
(tandem duplications) or potentially both changes for translocations (Fig. 2).
To simplify the subsequent split—read alignment, we decided to modify the
SV reference depending on the paired—end SV call to then carry out a standard
‘deletion—type’ split—read search for all SV types, as shown in Figure 4 for
the different classes of paired—end SV calls.

A split—read alignment by dynamic programming is prohibitively
expensive for the full set of putative split—reads and hence, DELLY uses
a fast k—mer—based ﬁltering technique to identify candidate split—reads. The
default k—mer—index of the SV containing reference region for SVl- uses
k =7. k adjusts the sensitivity and speciﬁcity of DELLY’s split—read search.
Simulated SVs showed that a small value of k provides the best recall, in
particular for short reads (@36 bp) and low coverage (55x). Due to the
small, paired—end guided reference region, speciﬁcity remained high even
for small k. Given this index for SW, DELLY now maps each k—mer of a
read r eRsvi against the index and normalizes each k—mer hit by the offset
of the k—mer in the read. Thus, in terms of the alignment matrix of a given
read against the SV region we count the k—mer hits by alignment diagonal
(Fig. 5). To increase speciﬁcity, DELLY only applies this k—mer counting to
one alignment direction, forward or reverse strand, depending on the paired—
end induced alignment direction. During this k—mer counting, we ignore any
N s in the read or the reference. Any sequencing error can destroy up to k
k—mer hits. For instance, the second boxed ‘A’ in Figure 5 causes a loss of
seven k—mer hits. Due to repeats, a given read k—mer can have multiple hits
in the SV region. Because of that DELLY post—processes the diagonals in
decreasing order according to the number of k—mer hits. In this procedure,
each read k—mer is ﬂagged as ‘used’ once one of its diagonals has been
processed. This ensures that every read k—mer is assigned only once to the
best supported diagonal. Finally, we discard all diagonals that have less than
kmin hits, the default for kmin is 3. If in the end a read r e RSV, has less than two
diagonals above this threshold the read r is discarded from the set of putative
split—reads Rsvi. We further require that the two diagonals with the most hits
account in total for at least half of the k—mers of the read, otherwise the read
is also discarded. This implies that any non—template reference insertion
(see below) can only be found if it is smaller than half the read—length.
All candidate split—reads with at least two diagonals above the k—mer hit
threshold are further processed by means of sorting the diagonals of a given

read by their diagonal index and recording the offset between two consecutive
diagonals. This offset between consecutive diagonals corresponds for a true
SV event to the size of the SV. For instance, in the small example shown in
Figure 5 all three reads support an offset of 65 bp.

This single read k—mer search is still unbiased and not guided by the paired—
end predicted SV length to avoid false positives. Only after having collected
all predicted offsets from all putative split—reads, we extract the maximum
supported offset for each structural variant SVi. By default, DELLY requires
at least two split—reads but this value can be increased on the command—
line to enforce speciﬁcity. We then take the subset of reads R’svi QRSV,
that supported this offset and build the consensus sequence 020102 ' ' -cn of
length n, where we apply a simple majority vote in each consensus column
(Fig. 5)

ci=argmax|ri,j:r,-,j=oz|
0562
where E is the set of nucleotides {A, C, G, T}, c,- is the consensus nucleotide
for column i and j is the read index (or row index in the consensus alignment).
At the moment, DELLY constructs only a gapless consensus sequence, which
can be extended in the future using a realignment method (Anson and Myers,
1997) that accounts for insertion and deletion sequencing errors.

The ﬁnal consensus sequence 0 is now aligned to the reference region
of SVl- using a sensitive double dynamic programming. DELLY computes
two scoring matrices SF and SR, one for the forward and one for the
reverse alignment using the Gotoh algorithm with afﬁne gap penalties
from the Squn library (Dering et 01., 2008; Rausch et 01., 2008). Both
scoring matrices are then used to deﬁne the optimal split, allowing for
potential non—template insertions. This method resembles an algorithm
proposed for assembled contig alignment to a reference genome, called
AGE (Abyzov and Gerstein, 2011). DELLY follows the AGE approach that
allows microinsertions at the breakpoint with two important changes. First,
DELLY uses afﬁne gap penalties to avoid alignment regions interspersed with
gaps and second, DELLY uses a global instead of a local alignment algorithm
since the consensus sequence was derived from the read data and should thus
be alignable across the full length. In brief, the forward scoring matrix SF
is used to compute a forward scoring vector f = 61,102, ' ~ ,fn). Element f,- is
the maximum score of the best preﬁx consensus alignment 0102 ' ' -c,- to the
reference. Likewise, a reverse scoring vector r: (r1, r2, m,r,,) is computed
from the reverse scoring alignment matrix SR where rj is the maximum score
of the best sufﬁx consensus alignment CnCn_1"'Cj to the reverse reference.
The optimal ‘left’ and ‘right’ breakpoint of the structural variant in the read
is then deﬁned as the maximum total alignment score using the two scoring
vectors f and r.

(left,right) =argmaxf,- +rj : i,j 5 n and i<j
iaj

We do not require j 21' +1 to accommodate non—template microinsertions at
the breakpoint, which are thought to be commonly introduced by DNA repair
mechanisms. The exact breakpoint in the reference can be calculated from
the scoring matrices S F and SR, the maximum alignment score giving rise to
f,- and rj and translating back the coordinates from the ‘deletion—type’ split—
read alignment reference to the original SV region. In a ﬁnal step, DELLY
checks whether the split—read predicted SV length conﬁrms the paired—end
estimated SV length allowing for a difference of up to 0 percent in length,
with c: 10% as the default.

2.3 Call annotation and call merging

Paired—end calls are annotated by the number of supporting pairs and their
average mapping quality. Split—read reﬁned calls are annotated by the number
of split—reads and the split—read consensus alignment quality against the
reference. For inversions and translocated segments, DELLY is able to merge
the left— and right—spanning paired—end or split—read calls. For paired—end
inversion calls, DELLY merges only complementing left— and right— spanning
calls that have a reciprocal overlap of at least 80%. If multiple calls could be
merged, DELLY takes a best ﬁrst approach, by merging those calls ﬁrst that

 

i336

112 /810's12u1nofp101x0'sor112u1101urorq//zd11q 111011 pap1201umoq

9IOZ ‘09 lsnﬁnv uo ::

DELLY: integrated structural variant discovery

 

Consensus TCACGCGTCCCAACTTC
RealeCACGCGTCCCAACTTC
Readz GCGTCCCAACTTC
kw1@CCCAACTTC

CCTCCCGAAGTGCTGGGATTACAGA
CCTCCCGAAGTGCTGGGA
CCTCCCGAAGTGCTGGGATTAC
CCTCCCGAAG®GCTGGGATTACAGA

ATATCACGCGTCCCAACTTC CCTCCCGAAGTGCTGGGATTACAGAT

Reference / Consensus

 

’

012 456 8910111213141516171819

   

 

as as 37 as 39 9o .......... ..
s4\\

7-mer Decomposition 
muamammalian-anyb-oonoaoonaaovwonoaooo Readz

IWQQQHOQHQWWQOOOHOOOHHOWFOOOHQOOOWOH Read3

‘

 

 

 

RPM wmwniuo-Jn-Jwoman-106)wavmnnoannnaenwvonnv\

l
‘

Fig. 5. Using an index of the SV reference, DELLY records the number
of seven—mer hits per diagonal for each read. In the above example, Readl
induces three hits on diagonal 10 and 12 on diagonal 75. Readz induces
seven hits on diagonal 7 and 16 hits on diagonal 72. Read3 induces 11 hits
on diagonal 3 and 12 hits on diagonal 68. For all the reads the offset between
the two most supported diagonals is 65 bp suggesting an SV length of 65 bp.
The consensus sequence of the three reads is shown at the top

have the smallest absolute distance in their predicted breakpoint position.
For translocated segments, DELLY veriﬁes that both paired—end/split—read
calls support the same relative orientation (Fig. 4) and that the predicted
breakpoints on the chromosome where the segment is inserted are less than
z bp apart, where z is by default 300 bp. If there are multiple translocation
calls that could be merged, DELLY ﬁrst merges calls where the absolute
difference in the predicted insertion position is minimal.

3 RESULTS
3.1 Benchmarking DELLY 0n simulated data

DELLY was benchmarked on simulated data to estimate the
sensitivity (S) and the positive—predictive value (PPV) under
different sequencing parameter settings, and to compare DELLY
to other structural variant calling algorithms that are suitable for
detecting SVs in the germline and in somatic tissues, namely Pindel
version 0.2.4 (Ye et al., 2009), Breakdancer version 1.1 (Chen et al.,
2009), GASV version 1.4 (Sindi et al., 2009) and HYDRA version
0.5.3 (Quinlan et al., 2010). The source sequence was derived
from a randomly selected 10 Mbp region of chr16 from the latest
human genome reference (th 9). SVs were randomly simulated
and integrated into the source sequence in a non—overlapping
manner. The wgsim (Li et al., 2009) read simulator was used to
sample reads from the modiﬁed source sequence assuming a 1%
sequencing error rate under different insert size, coverage and read
length assumptions (Table 1). All simulated reads were mapped to
the original 10 Mbp source sequence using the Burrows—Wheeler
Aligner (BWA) (Li et al., 2008) with default parameters. For
translocations, we simulated translocated segments, where random
regions of the 10 Mbp source sequence were extracted and removed
after the read simulation and then added as separate chromosomes
during alignment. The ﬁnal BWA alignment ﬁle was used for calling

structural variants. The predicted SVs were then compared to the
simulated events and each of these simulations was repeated ﬁve
times for each ﬁxed parameter setting, where the median results
across these ﬁve simulations are reported and summarized in Table 1.
In paired—end mode, DELLY (PE) recovers more than 90% of the
simulated SVs on almost all tested settings. Integrating paired—
end and split—read mapping, denoted as DELLY (SR), achieves a
very high—positive predictive value, unmet by most of the other
methods, at the cost of only a slight decrease in sensitivity compared
to DELLY (PE). The sensitivity of DELLY (SR) depends on the
coverage and read—length, suggesting that for short—reads and low
coverage genomes paired—end methods are a better choice, with
Breakdancer offering the best trade—off between sensitivity and
speciﬁcity. Given a sufﬁcient coverage, Pindel is a very good choice
for inversions at the size range where it operates (1—10 kbp). Across
all SV types, the performance of DELLY is robust across the
simulated sequencing parameter space.

3.2 Benchmarking DELLY 0n 1000GP data

DELLY was also used on population—scale sequencing data of the
1000GP (1000 Genomes Project Consortium, 2010). The input
alignments used by DELLY were publicly released BAM ﬁles
generated by the 1000GP using hg19 as the reference genome.
We tested DELLY on 921 illumina sequenced samples from the
1000GP Phase I, which included the 1000GP pilot phase samples,
sequenced at low coverage. To assess correlations between the
read length and insert size distribution with DELLY’s ability to
recover SVs, we focused initially on 635 samples, where only one
library was sequenced and for which DELLY reported at least one
split—read deletion call. The mean insert size of these libraries was
332 bp (range 108—5 12 bp) with a standard deviation of 33 bp (range
11—120bp) and a mean read length of 72 bp (range 27—106bp).
There was a signiﬁcant correlation between the number of split—
read deletion calls (e.g. with a median of 442 calls per 1000GP
pilot sample) and the read length (Pearson correlation, c = 0.25; P <
2.8 x10T10) as well as the insert size (c=0.46,P <2.2><10_16).
For increasing insert size variability relative to the mean, we
observed a signiﬁcant anti—correlation (c = —0.26, P < 6.1 X 10‘ 1 1 ).
These correlation coefﬁcients could be conﬁrmed by a quality—
ﬁltered set of paired—end calls (23 supporting pairs, avg. mapping
quality :20) with regard to insert size (c:0.24,P=7.2>< 10‘10)
and increasing insert size variability (c: —0.19,P 27.5 X 10‘7).
We carried out polymerase chain reaction (PCR) validation
experiments on ﬁve pilot samples (NA07347, NA10847, NA11831,
NA11992 and NA12003) to assess the accuracy of SVs discovered
by DELLY Out of 44 randomly selected deletion loci with split—read
support, we could unambiguously assign a true—positive outcome to
40 calls (Fig. 6). Four calls were unclear due to a PCR failure or
a band outside of the expected SV size range. This gives rise to
a conservative estimated PCR—based FDR of 59.1% for DELLY,
which underlines the high speciﬁcity of DELLY (SR) and conﬁrms
the results obtained from the simulations. We further compared the
DELLY calls to the recently released set of 8384 assembled deletions
(lifted from th8 to hg19) of the 1000GP’s SV group pilot project
analyses (Mills et al., 2011). While this set was generated by 19
different SV prediction methods, DELLY alone recovered 76% of
the joint SV group’s calls (using a 90% reciprocal overlap). In the
size—range where DELLY operates, i.e. deletions 2200 bp, DELLY

 

i337

112 /810'smumofproatxosor112u1101urorq//zd11q 111011 pap1201umoq

9IOZ ‘09 lsnﬁnv uo ::

I Rausch et aI.

 

Table 1. Sensitivity and positive predictive value of the methods to predict 100 non—overlapping, randomly simulated deletions, tandem duplications and
inversions of length 500 bp 5x 5 5000 bp in a target sequence of 10 Mbp that was randomly sampled from chr16 of the th9 human genome reference

 

Coverage Insert size, N (11,0 = 0.1 11) Insert size SD, N (300,0) Read length (bp)

 

T001 5 10 15 30 N(200, 20) N(400, 40) N(600, 60) N(300, 10) N(300, 40) N(300, 70) 35 55 105

 

Deletions
DELLY (PE) 0.95/095 0.99/085 0.98/067 1.00/042 0.97/089 1.00/064 1.00/049 0.99/079 1.00/069 0.98/056 1.00/032 1.00/054 0.98/088
DELLY (SR) 074/1.00 096/099 0.98/098 LOO/1.00 0.97/1.00 099/1.00 096/098 098/099 099/1.00 0.98/099 086/099 0.99/ 1.00 0.98/1.00

Pindel 0.45/ 1.00 085/099 094/095 099/093 092/098 095/097 091/087 094/099 095/096 0.90/094 072/089 0.93/099 093/095
Breakdancer 0.89/ 1.00 0.97/ 1.00 0.94/ 1.00 098/099 0.88/ 1.00 0.96/ 1.00 088/097 0.97/ 1.00 0.99/ 1.00 0.94/ 1.00 0.97/ 1.00 0.98/ 1.00 0.94/ 1.00
GASV 044/001 0.44/001 039/003 028/012 051/001 031/007 0.13/004 046/002 041/003 036/004 023/008 036/007 046/001
HYDRA 034/077 0.46/073 052/072 068/086 049/080 049/060 034/026 047/065 056/084 055/057 047/015 054/047 046/088
Tandem Dupl.

DELLY (PE) 096/099 096/091 1.00/096 1.00/099 0.88/093 1.00/099 1.00/097 0.98/092 1.00/099 0.96/076 0.99/094 0.99/088 0.99/0.99
DELLY (SR) 071/1.00 089/099 097/099 LOO/1.00 087/099 LOO/1.00 099/099 0.94/095 LOO/1.00 094/094 086/1.00 0.96/099 097/099

Pindel 0.49/ 1.00 0.73/ 1.00 0.95/ 1.00 0.99/099 0.85/ 1.00 0.93/099 0.97/099 084/099 0.97/ 1.00 084/099 0.76/ 1.00 0.87/ 1.00 0.97/ 1.00
Breakdancer 0.93/099 0.83/ 1.00 095/099 0.99/ 1.00 0.77/ 1.00 097/098 0.98/ 1.00 085/099 0.99/ 1.00 083/097 0.97/ 1.00 0.93/ 1.00 0.95/ 1.00
GASV 051/052 038/044 039/039 031/031 0.40/047 030/031 013/015 041/046 043/043 036/041 027/027 029/031 050/051
HYDRA 026/079 032/043 030/046 033/052 033/072 019/032 012/016 022/037 029/059 029/037 032/012 027/028 030/075
Inversions

DELLY (PE) LOO/1.00 0.99/097 1.00/094 1.00/096 0.99/097 1.00/097 1.00/093 1.00/093 1.00/096 1.00/097 1.00/079 1.00/091 LOO/1.00
DELLY (SR) 062/1.00 082/096 089/098 092/1.00 090/1.00 0.92/1.00 0.90/098 0.91/095 091/099 092/099 068/1.00 0.92/098 085/099

Pindel 0.87/ 1.00 0.97/ 1.00 097/099 0.99/097 0.97/ 1.00 0.99/099 098/0.99 0.99/ 1.00 0.98/ 1.00 099/0.99 091/098 0.98/ 1.00 1.00/ 1.00
Breakdancer 086/067 080/078 083/086 075/076 095/055 069/069 0.43/043 084/084 079/081 0.75/075 0.76/077 0.78/078 098/051
GASV 081/080 0.73/071 075/069 0.74/070 086/081 061/059 037/034 0.77/071 0.73/070 067/065 072/055 0.78/070 0.77/077
HYDRA 027/061 038/031 038/032 041/033 0.46/061 029/037 015/014 035/034 039/046 034/047 022/007 031/020 0.44/072
Translocations

DELLY (PE) 1.00/ 1.00 0.99/097 1.00/095 1.00/089 0.99/098 1.00/095 0.95/089 1.00/094 1.00/094 1.00/095 0.99/072 1.00/089 1.00/ 1.00
DELLY (SR) 0.85/ 1.00 095/099 LOO/0.99 1.00/097 0.98/098 099/0.99 091/095 1.00/098 0.99/0.99 099/0.99 092/097 099/0.98 1.00/ 1.00
Breakdancer 097/1.00 0.98/ 1.00 0.99/0.99 LOO/0.99 0.99/1.00 0.97/051 0.61/025 LOO/1.00 099/0.98 098/088 094/078 099/097 098/1.00
GASV LOO/1.00 0.99/097 1.00/095 098/077 0.98/092 1.00/094 088/082 1.00/093 1.00/090 090/059 065/030 1.00/089 LOO/1.00

S/PPV S/PPV S/PP V S/PPV S/PP V S/PP V S/PPV S/PP V S/PP V S/PPV S/PPV S/PP V S/PP V

 

Reads were simulated under various settings that are detailed in the header of the table. The four variables are coverage, insert size, insert size standard deviation and read length,
and only one variable was changed in each experiment. The default values were selected as coverage 2 15x, read length = 75 bp, insert size = 300 bp and insert size standard
deviation 2 30 bp. Each parameter setting was repeated ﬁve times and the median of these ﬁve values is reported for each method, the best one is in bold. Pindel and HYDRA do
not call translocations or reported less than 10% of the simulated events.

identiﬁed 86% of the calls previously released by the 1000GP
Including the DELLY calls from the additional Phase I samples
with longer reads, DELLY recovered 86% of all reported deletions
and 92% for deletions 2200 bp, out of which 69% and 82% were
supported by split—reads.

3.3 Complex genomic rearrangements

DELLY was also used in a recent study focusing on pediatric
brain tumors in the context of the International Cancer Genome
Consortium (ICGC) (Hudson et al., 2010; Rausch et al., 2012).
DELLY identiﬁed a multitude of complex rearrangements, which
created ‘deletion—type’, ‘tandem—duplication—type’ or ‘inversion—
type’ paired—end mapping signatures but differed from such simple
events by means of spanning megabases of sequences and lacking
read—depth support. This complex SV landscape could be explained
by a set of presumed circular minichromosomes (double minute
chromosomes) in which distal genomic segments were rejoined in
a seemingly random manner during a single, catastrophic molecular
event, termed chromothripsis (Rausch et al., 2012). All tested inter—
and intrachromosomal connections on these minichromosomes
could be validated by PCR, including 8 interchromosomal, 13
‘inversion—type’, 3 ‘tandem—duplication—type’ and 3 ‘deletion—type’

connections. Taking these PCR—veriﬁed rearrangements as the
gold standard set, both DELLY and Breakdancer recovered all
rearrangements, whereas Pindel detected none, which may not be
surprising since those rearrangements are beyond the size range
(1—10kbp) that Pindel is most suited for. An evaluation of the
computational requirements of DELLY using a single CPU (Intel
Xeon X5472, 3 GHz) shows that DELLY can be used in routine
analyses (Fig. 7), where a further speed—up can be achieved
by a naive parallelization on the chromosome level, except for
translocations.

4 DISCUSSION

The ability to integrate paired—end data from different insert size
libraries with split—read data makes DELLY a versatile tool for
analyzing SVs in MPS data from various sources, including
deep whole—genome sequencing data and low—pass mate—pair
sequencing data with longer inserts, with another possible future
application area being exome capture data sequenced with paired—
ends. Our analyses showed that DELLY (PE) provides excellent
sensitivity, whereas DELLY (SR) greatly increases speciﬁcity
(at nucleotide resolution). Nonetheless, neither DELLY (PE) nor
DELLY (SR) alone are optimal across all sequencing parameters.

 

i338

112 /810'smumofproatxosor112u1101urorq//zd11q 111011 pap1201umoq

9IOZ ‘09 lsnﬁnv uo ::

DELLY: integrated structural variant discovery

 

 

A '\ '\ N x '5
g§3hgs°%:»~":€qq§° 9*"

PCR #Events

Tested 44

Positive 40

False O

Ambiguous 4

 

 

PCR Summary

Polymorphic Deletion

Fig. 6. (A) PCR results for 44 randomly selected split—read deletion calls
in 5 samples. (B) A polymorphic deletion site (chr5:60001704—60003666)
that is homozygous alternative in NA10847 and NA11992, heterozygous in
NA07347 and NA11831, and homozygous reference in NA12003

  
 

 

8000 a
E
10 E
E 6000 a,
E 8 g
a: 4 g
E 5 _ - __________________ -- 000 g
g E
m 4 2000 "E’
— Runtime 7!“
2 ‘‘‘‘ -- Memory 0 do

I | I I I I

5 10 15 20 25 30

Median coverage of hg19

Fig. 7. Computational requirements of DELLY for a human resequenced
short—read dataset across different coverage levels for deletion discovery

The speciﬁcity of DELLY (PE) deteriorates with increasing
sequencing coverage due to spurious paired—end calls with low
support. The sensitivity of DELLY (SR), however, depends on
a sufﬁcient read length and coverage, limitations that call for
further research. In particular, population scale sequencing data
will enable the genotyping of SVs across cohorts and read—depth
distribution modeling the inference of exact copy—number states
for unbalanced rearrangements (Handsaker et al., 2011). Third—
generation sequencing technologies including nanopore sequencing
will additionally facilitate the discovery, and possibly phasing, of
SVs in population—scale and cancer genome studies. These types of
data should be particularly suited for split—read alignment methods
and assembly—based approaches, owing to the increased read length.

ACKNOWLEDGEMENT

We thank the 1000GP for data access and members of the
SV Analysis Group, EMBL Genecore and ICGC for valuable
discussions.

Funding: The European Commission (i.e. the EurocanPlatform
project, Health—F2—2010—26079 1), the German Cancer Aid (109252)
and the BMBF (ICGC ‘PedBrain’ Tumor Project, 01KU1201C).

Conﬂict of Interest: none declared.

REFERENCES

1000 Genomes Project Consortium (2010) A map of human genome variation from
population-scale sequencing. Nature, 467, 1061—1073.

Abyzov,A. and Gerstein,M. (2011) Age: deﬁning breakpoints of genomic structural
variants at single-nucleotide resolution, through optimal alignments with gap
excision. Bioinformatics, 27, 595—603.

Abyzov,A. et al. (2011) CNVnator: an approach to discover, genotype, and characterize
typical and atypical CNVs from family and population genome sequencing. Genome
Res., 21, 974—984.

Anson,E.L. and Myers,E.W. (1997) Realigner: a program for reﬁning DNA sequence
multi-alignments. In: Proc. 1 st Annual International Conference on Research in
Computational Molecular Biology, ACM Press, New York, pp. 9—16.

Barnett,D.W. et al. (2011) BamTools: a C++ API and toolkit for analyzing and managing
BAM ﬁles, Bioinformatics, 27, 1691—1692.

Campbell,P.J. et al. (2008) Identiﬁcation of somatically acquired rearrangements in
cancer using genome-wide massively parallel paired-end sequencing. Nat Genet,
40, 722—729.

Chen,K. et al. (2009) BreakDancer: an algorithm for high-resolution mapping of
genomic structural variation. Nat Methods, 6, 677—681.

Chiang,D.Y. et al. (2009) High-resolution mapping of copy-number alterations with
massively parallel sequencing. Nat Methods, 6, 99—103.

Conrad,D.F. et al. (2010) Origins and functional impact of copy number variation in
the human genome. Nature, 464, 704—712.

Doring,A. et al. (2008) Squn—an efﬁcient, generic C++ library for sequence analysis.
BMC Bioinformatics, 9, 11.

Hajirasouliha,1. et al. (2010) Detection and characterization of novel sequence insertions
using paired-end next-generation sequencing. Bioinformatics, 26, 1277—1283.
Handsaker,R.E. et al. (2011) Discovery and genotyping of genome structural
polymorphism by sequencing on a population scale. Nat Genet, 43, 269—276.
Hudson,T.J. et al. (2010) International network of cancer genome projects, Nature, 464,

993—998.

Korbel,J.O. et al. (2009a) PEMer: a computational framework with simulation-based
error models for inferring genomic structural variants from massive paired-end
sequencing data. Genome Biology, 10, R23.

Korbel,J.O. et al. (2007) Paired-end mapping reveals extensive structural variation in
the human genome. Science, 318, 420—426.

Korbel,J.O. et al. (2009b) The genetic architecture of down syndrome phenotypes
revealed by high-resolution analysis of human segmental trisomies. Proc. Natl Acad.
Sci., 106, 12 031—12036.

Li,H. et al. (2008) Mapping short DNA sequencing reads and calling variants using
mapping quality scores. Genome Res., 18, 1851—1858.

Li,H. et al. (2009) The Sequence Alignment/Map format and SAMtools. Bioinformatics,
25, 2078—2079.

McCarroll,S.A. et al. (2008) Deletion polymorphism upstream of IRGM associated
with altered IRGM expression and Crohn’s disease. Nat Genet, 40, 1107—1112.

Mills,R.E. et al. (2011) Mapping copy number variation by population-scale genome
sequencing. Nature, 470, 59—65.

Pleasance,E.D. et al. (2010) A small-cell lung cancer genome with complex signatures
of tobacco exposure. Nature, 463, 184—190.

Quinlan,A.R. et al. (2010) Genome-wide mapping and assembly of structural variant
breakpoints in the mouse genome. Genome Res., 20, 623—635.

Rausch,T. et al. (2008) Segment-based multiple sequence alignment. Bioinformatics,
24, i187—i192.

Rausch,T. et al. (2012) Genome sequencing of pediatric medulloblastoma links
catastrophic DNA rearrangements with TP53 mutations. Cell, 148, 59—71.

Sindi,S. et al. (2009) A geometric approach for classiﬁcation and comparison of
structural variants. Bioinformatics, 25, i222—i230

Stephens,P.J. et al. (2011) Massive genomic rearrangement acquired in a single
catastrophic event during cancer development. Cell, 144, 27410

Stranger,B.E. et al. (2007) Relative impact of nucleotide and copy number variation on
gene expression phenotypes. Science, 315, 848—853.

Sudmant,P.H. et al. (2010) Diversity of human copy number variation and multicopy
gene. Science, 330, 641—646.

Wang,J. et al. (2011) CREST maps somatic structural variation in cancer genomes with
base-pair resolution. Nat Methods, 8, 652—654.

Ye,K. et al. (2009) Pindel: a pattern growth approach to detect break points of large
deletions and medium sized insertions from paired-end short reads. Bioinformatics,
25, 2865—2871.

Zhang,F. et al. (2009) Copy number variation in human health, disease, and evolution.
Annu. Rev. Genom. Hum. Genet, 10, 451—481.

 

i339

112 /§.IO'SIBUJHinJOJXO'SOIlBIHJOJUIOIQ/ﬁdnq 111011 pap1201umoq

9IOZ ‘09 lsnﬁnv uo ::

