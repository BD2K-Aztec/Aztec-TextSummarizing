Bioinformatics, 32(2), 2016, 286—288

doi: 10.1093/bioinformatics/btv560

Advance Access Publication Date: 30 September 2015
Applications Note

 

Genome analysis

missMethyl: an R package for analyzing data
from lllumina’s HumanMethylation450 platform

Belinda Phipson“, Jovana Maksimovic“ and Alicia Oshlack*

Bioinformatics Group, Murdoch Childrens Research Institute, Royal Children's Hospital, 50 Flemington Road,
Parkville, Victoria, 3052, Australia

*To whom correspondence should be addressed.
TThe authors wish it to be known that, in their opinion, the first two authors should be regarded as joint First Authors.
Associate Editor: John Hancock

Received on April 17, 2015; revised on June 23, 2015; accepted on September 18, 2015

Abstract

Summary: DNA methylation is one of the most commonly studied epigenetic modifications due to
its role in both disease and development. The lllumina HumanMethylation450 BeadChip is a cost-
effective way to profile >450 000 Cst across the human genome, making it a popular platform for
profiling DNA methylation. Here we introduce missMethyl, an R package with a suite of tools for
performing normalization, removal of unwanted variation in differential methylation analysis, dif-
ferential variability testing and gene set analysis for the 450K array.

Availability and implementation: missMethyl is an R package available from the Bioconductor pro-

 

ject at www.bioconductor.org.
Contact: alicia.oshlack@mcri.edu.au

Supplementary information: Supplementary data are available at Bioinformatics online.

 

1 Introduction

DNA methylation, one of the most widely studied epigenetic modifi-
cations, is crucial for normal embryonic development and is often
disrupted in disease. Epigenetic marks can be modified by environ-
mental exposures and are dramatically altered in cancer. Since epi-
genetic changes are potentially reversible, DNA methylation is an
attractive therapeutic target and remains an important area of
research.

There are several array and sequencing-based technologies available
for profiling DNA methylation. While sequencing costs have declined, it
remains expensive for large DNA methylation studies, making arrays a
cost-effective alternative. Illumina’s HumanMethylation450 (45 OK)
BeadChip is currently the most popular platform, having been used in
many large studies such as The Cancer Genome Atlas, as well as in
many epigenome-wide association studies.

Here, we present the missMethyl R package, which contains
dedicated tools for performing a range of analyses primarily targeted
at 450K arrays. These methods include normalization, removal
of unwanted variation (RUV) such as batch effects in a differential
methylation analysis, differential variability testing and gene set ana-
lysis. Software packages for reading in raw data, pre-processing and

differential methylation analysis include minfi (Aryee et al., 2014),
methleit (Akalin et al., 2012) and methylumi. However,
missMethyl provides more specialized analysis methods not avail-
able elsewhere.

2 Methods

2.1 SWAN: subset-quantile within array normalization
SWAN (Maksimovic et al., 2012) is a within-array normalization
method specifically designed for the 45 OK platform. The 45 OK array
uses a combination of two distinct probe types, Infinium I and II,
which are known to display technical differences. The underlying as-
sumption of SWAN is that probes with the same number of Cst in
their probe bodies share similar biology. Thus, their overall intensity
distributions should be similar regardless of design type.

The SWAN function takes an object of class MethylSet,
RGChannelSet or MethyLumiSet and performs normalization in
two steps. First, a subset of Infinium I and II probes that have one,
two and three underlying Cst are randomly selected and quantile
normalized, keeping the methylated and unmethylated channels

©The Author 2015. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com 286

9mg ‘09 isnﬁnV uo seleﬁuV socl ‘erulomeg JO AirSJQAru [1 112 [3.10811211an[plOJXO'SODBIILIOJIIIOIQ/ﬂ(11111 wort pepeolumoq

missMethyl

287

 

 

 

 

 

 

 

 

 

 

 

 

0.2

 

Proportion Differential Methylation
0 4
|

 

 

 

o
o

0.0
I

 

[x
— All probes - —
A - - lnﬁniuml o B
- - lnﬁniumll
or: — _
(D
g _
’5 N - a
g >
D (u _
q—a
CD
to
N ' o 1
o .05“.
o _
| | | | | | |
0.0 0.2 0.4 0.6 0.8 1.0 NewBorn

Beta values

 

| | | | | |
Old 0 50 100 150 200

Number of Cst per gene

Fig. 1. Analysis of a publicly available aging methylation dataset. (A) (3 value distributions for Infinium | and II probes after SWAN, generated using the
densityByProbeType function. (B) Bvalues for newborns versus centenarians for a differentially variable CpG (0900807871) identified using DiffVar. (C) Bias due
to differing numbers of Cst per gene, generated by specifying plot.bias=TRUE in the gometh function

separate. Second, the intensities of the remaining probes are adjusted
for each probe type separately using linear interpolation procedures.

The SWAN function outputs a MethylSet object of normalized
intensities. Figure 1A, generated using the densityByProbeType
function, shows the SWAN-normalized Infinium I and II B value dis-
tributions of a single array from a publicly available ageing dataset
(Heyn et al., 2012).

2.2 RUVm: remove unwanted variation

Since 45 OK arrays are relatively inexpensive, they are widely used in
large differential methylation studies. However, large studies tend to
be susceptible to batch effects, as well as other unknown sources of
technical and biological variation. The missMethyl package offers
RUVm as a solution for removing batch effects and unknown un-
wanted variation from the data (Maksimovic et al., 2015).

To accurately estimate the components of unwanted variation,
the two-stage RUVm method relies on negative control probes that
are assumed not to be associated with the biological factor of inter-
est. First, a differential methylation analysis using the 613 Illumina
negative control probes with RUVinverse is performed. The red and
green channel intensities for the 613 negative control probes can be
extracted using the getIN Cs function. From the results of this first
analysis, empirical controls are identified, which are then used by
the RUVinverse function in the second stage.

The RUsz't function runs this method and takes as input a ma-
trix of M-values, a design matrix, the coefficient to be tested and a
vector indicating the negative control probes. The RUVadi function
adjusts the variance estimates using empirical Bayes shrinkage and
the topR UV function displays the top 10 significantly differentially
methylated CpG sites, after adjusting for the unwanted variation.

2.3 DiffVar: differential variability testing

Thus far, the main focus of many methylation studies has been on
detecting CpG sites or regions that are differentially methylated be-
tween groups. However, identifying features that differ in terms of
variability may also be relevant to understanding disease phenotypes
(Hansen et al., 2011). Previously, methods for detecting differential
variability in genomics data were not well established or had no
dedicated software.

The missMethyl package contains functions to test differential
variability in methylation and RNA-Seq data from our previous
work (Phipson and Oshlack, 2014). For methylation data, the vaer't
function takes as input a matrix of M values, (3 values or a

MethylSet object, a design matrix and the coefficients of interest to
be tested. If the input is in the form of (3 values, a logit transform-
ation is applied. For RNA-Seq data, if a DGEList object is supplied,
a voom transformation is used (Law et al., 2014), which takes into
account the mean-variance relationship observed in count data.

The test is based on Levene’s test for differences in variances and
employs the empirical Bayes modelling framework of the limma
package (Ritchie et al., 2015). The topVar function outputs the top
10 differentially variable Cst or genes. Figure 1B shows an ex-
ample of a significantly differentially variable CpG using DiffVar in
the aging dataset.

2.4 gometh: gene set analysis

A differential methylation or differential variability analysis could
result in a long list of significant Cst to interpret. One popular ap-
proach to understanding potential gene pathways that are affected is
to perform gene set analysis. Although gene set analysis is well es-
tablished for gene expression experiments, the methodology is ad
hoc at best for methylation data. One issue is that the numbers of
Cst associated with each gene on the 45 OK array ranges from 1 to
1299. Genes with larger numbers of probes are more likely to have
significantly differentially methylated Cst, biasing gene set ana-
lysis (Geeleher et al., 2013) (Fig. 1C).

The gometh function modifies the goseq method (Young et al.,
2010) specifically for the 45 OK array by adjusting for the number of
Cst associated with each gene. It takes as input a vector of signifi-
cant Cst and calculates the probability of a gene being selected
given the number of associated Cst. A test based on Wallenius’
noncentral hypergeometric distribution is then performed for each
gene ontology (GO) category (see Supplementary Material).

The gometh function outputs a dataframe with rows for each
GO category tested and various statistics of interest. The topGO
function in limma can then be called, which outputs the top 20 GO
categories, ranked by p-value.

3 Conclusion

The missMethyl R package contains a suite of functions to perform
novel analyses for 45 OK array data, with new functions likely to be
added as they are developed. The functions have been written to
complement the limma package and are compatible with data ob-
jects from minfi, methylumi and edgeR. In addition, missMethyl is
well documented and freely available from Bioconductor.

9mg ‘09 isnﬁnV uo sejeﬁuV SO’I ‘erulomeg JO AirSJQAru [1 112 ﬁhO'sIeumo[pJOJXO'sopemJogurorq/ﬁdnq wort pepeolumoq

288

B. Phipson et al.

 

Funding

This work was supported by Victorian State Government Operational
Infrastructure Support and National Health and Medical Research Council grants
APP1051481 and APP1051402 to AD.

Conﬂict of Interest: none declared.

References

Akalin,A. et al. (2012) methleit: a comprehensive R package for the analysis
of genome-wide DNA methylation proﬁles. Genome Biol., 13, R87.

Aryee,M.]. et al. (2014) Minﬁ: a ﬂexible and comprehensive Bioconductor
package for the analysis of inﬁnium DNA methylation microarrays.
Bioinformatics, 30, 1363—1369.

Geeleher,P. et al. (2013) Gene-set analysis is severely biased when applied to
genome-wide methylation data. Bioinformatics, 29, 1851—1857.

Hansen,K.D. et al. (2011) Increased methylation variation in epigenetic do-
mains across cancer types. Nat. Genet., 43, 768—775.

Heyn,H. et al. (2012) Distinct DNA methylomes of newborns and centenar-
ians. Proc. Natl. Acad. Sci. USA, 109, 10522—10527.

Law,C.W. et al. (2014) Voom: precision weights unlock linear model analysis
tools for RNA-seq read counts. Genome Biol., 15, R29.

Maksimovic,]. et al. (2012) SWAN: Subset-quantile within array normaliza-
tion for illumina inﬁnium HumanMethylation450 BeadChips. Genome
Biol., 13, R44.

Maksimovic,]. et al. (2015) Removing unwanted variation in a differential
methylation analysis of illumina humanmethylation450 array data. Nucleic
Acids Res., 43, e106.

Phipson,B. and Oshlack,A. (2014) DiffVar: a new method for detecting differ-
ential variability with application to methylation in cancer and aging.
Genome Biol., 15, 465.

Ritchie,M.E. et al. (2015) Limma powers differential expression analyses for
RNA-sequencing and microarray studies. Nucleic Acids Res., 43, e47.

Young,M.D. et al. (2010) Gene ontology analysis for RNA-seq: accounting
for selection bias. Genome Biol., 11, R14.

9mg ‘09 1sn8nV uo sejeﬁuV SO’I ‘121u10111123 10 A11819Aruf1 112 /810'S{12umo[p101x0'831112u1101u101q/ﬁd11q 111011 pepeolumoq

