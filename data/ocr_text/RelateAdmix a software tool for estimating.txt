APPLICATIONS NOTE

Vol. 30 no. 7 2014, pages 1027—1028
doi:10. 1093/bioinformatics/btt652

 

Genetics and population analysis

Advance Access publication November 8, 2013

RelateAdmix: a software tool for estimating relatedness

between admixed individuals
Ida Moltke1 ’2 and Anders Albrechtsen“

1Department of Human Genetics, University of Chicago, Chicago, IL 60637, USA and 2Department of Biology,
The Bioinformatics Centre, University of Copenhagen, 2200 Copenhagen N, Denmark

Associate Editor: Martin Bishop

 

ABSTRACT

Motivation: Pain/vise relatedness plays an important role in a range of
genetic research fields. However, currently only few estimators exist
for individuals that are admixed, i.e. have ancestry from more than one
population, and these estimators fail in some situations.

Results: We present a new software tool, RelateAdmix, for obtaining
maximum likelihood estimates of pain/vise relatedness from genetic
data between admixed individuals. We show using simulated data
that it gives rise to better estimates than three state-of—the-art soft-
ware tools, REAP, KING and Plink, while still being fast enough to be
applicable to large datasets.

Availability and implementation: The software tool, implemented in
C and R, is freely available from www.popgen.dk/software.

Contact: albrecht@binf.ku.dk

Supplementary information: Supplementary data are available at
Bioinformatics online.

Received on August 16, 2013; revised on November 4, 2013;
accepted on November 5, 2013

1 INTRODUCTION

Genetic relatedness between pairs of individuals plays an import-
ant role within several ﬁelds of genetic research including foren-
sic and medical genetics. For example, most genome-wide
association studies are based on the assumption that all individ-
uals analyzed are unrelated and if related individuals are not
removed or controlled for they can lead to highly inﬂated
false-positive rates. Relatedness between a pair of individuals is
usually described using the concept of identity-by—descent (IBD),
which is genetic identity due to recent common ancestry. More
speciﬁcally relatedness between two non-inbred individuals is
often described by the fractions, k0, k1 and k2, of the genome
in which the two individuals share 0, 1 or 2 alleles IBD, respect-
ively. Further, relatedness is sometimes summarized as the coef-
ﬁcient of relatedness r or the kinship coefﬁcient 9 = r/ 2, which
can both be calculated from k0, k1 and k2 as r 2 k1 / 2 + k2.
There are numerous estimators for k0, k1, k2, r and 9 based on
genetic data from individuals whose potential family relations
are unknown, both method of moments estimators (Purcell
et al., 2007; Ritland, 1996) and maximum likelihood (ML) esti-
mators (Milligan, 2003; Thompson, 1975). Additionally, there
are several hidden Markov model-based methods that estimate

 

*To whom correspondence should be addressed

IBD sharing locally along the genome (e.g. Albrechtsen et al.,
2009), which if applied to whole genomes also provide related-
ness estimates. However, all of these estimators are based on an
assumption that the analyzed individuals are from a homoge-
neous population, and it has been shown that when this assump-
tion is violated it can lead to a marked misestimation of their
relatedness (Rohlfs et al., 2012; Thornton et al., 2012). Motivated
by this, Thornton et al. (2012) recently proposed a method of
moments estimator for pairwise relatedness in admixed popula-
tions, implemented in the software REAP and an estimator for
the kinship coefﬁcient in structured populations was included in
the software KING (Manichaikul et al., 2010). Here we present a
new ML—based software tool, RelateAdmix, for estimating k0, k1
and k2 from single nucleotide polymorphism data, estimated ad-
mixture proportions and allele frequencies assuming no inbreed-
ing. We obtain more accurate results than both REAP, KING
and the often used software Plink (Purcell et al., 2007), which
does not take admixture into account.

2 METHOD

Assuming we have genotype data from M diallelic loci from two non-
inbred individuals, indl and ind2, with ancestry from K source popula-
tions, we let G1 2 (G1,  , G11”) and G2 2 (G2, . . . , Gil) denote the two
individuals’ genotypes, Q1 = (Q1, ..., Qk) and Q2 = (Q2, ..., Qi)
denote their ancestry/admixture proportions and R 2 (k0, k1, k2) denote
the fractions in which indl and ind2 share 0, 1 and 2 alleles IBD. Using
this notation, our goal is to estimate R from G1, G2, assuming Q, Q2 and
the allele frequencies in each of the K populations are known.

Allele 1 Allele 2

Z I I Z 21:1 22:0

1 I I 2

Fig. 1. Left: diagram of the unobserved variables, 21, 22 and a in a locus i.
The circles represent the ancestral population of each allele, and lines
indicate whether two alleles are IBD. Right: example conﬁguration
where the two individuals share one allele IBD originating from popula-
tion 1, and the two other alleles originate from population 1 and 2,
respectively, and are not IBD

Allele 1 Allele 2

 

© The Author 2013. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com 1027

112 [3.10811211an[p.IOJXO'SODBIIHOJIITOTQ/ﬂ(11111 IIIOJJ pepeolumoq

910K ‘09 lsnﬁnV no :2

l.MoItke and A.Albrechtsen

 

 

 

 

 

 

 

 

 

 

 

 

 

 

RelateAdmix REAP Plink
(“Q _ ﬁ 3 _ E 3 _ ‘g
C O O
O O 1. O
N _ (\I _ (\I _
O O O
O Unrelated
:2 _ 2 _ 2 _ O Parent-offspring
N o N 5 N 0' 0 Full siblings
x x x 0 Half siblings
o o o O Cousins
3 - E _ 3 ‘ 0 Second cousins
\ I '-
8 _ 8 _  :I 8 _ ..
o o 'p 7 O o: ‘
e. ‘5 ' ‘e ‘
' a ." ° '2

8 _ L's A .3. . 8 _ L It. *9. 8 _  'I
O O O

I I I I I I I I I I I I I I I I I I

0.0 0.2 0.4 0.6 0.8 1.0 0.0 0.2 0.4 0.6 0 8 1 0 0 0 0.2 0 4 0 6 0 8 1 0

k1 k1 k1

Fig. 2. Estimates of k1 and k2 from RelateAdmix, REAP and Plink, respectively. The true value of (k1,k2) is (0,0) for unrelated pairs, (1,0) for parent-
offspring, (05,025) for full siblings, (0.5,0) for half siblings, (025,0) for ﬁrst cousins and (0.0625,0) for second cousins

Assuming independence between loci we write the likelihood as
M
12(01. GZIR, Q1, Q) = HAG}, GEIR. Q1, Q2)
i=1

M
= H 2 Zp(G},G§|Zi = (21,22):Ai = 61)

i=1 21,22 a
P(Ai = alzi = (21,22), Q1: Q2)P(Zi = (21922)IR)

where for each locus 21 indicates whether allele 1 in indl and ind2 are
IBD, 22 indicates whether allele 2 in indl and ind2 are IBD and
a = (a1, aé, (1%, (1%) represents the unobserved ancestral populations of
the two individuals’ two alleles, see Figure 1. Note that for convenience,
we have restricted the IBD sharing patterns in the sense that allele 1 of
indl can only be IBD with allele 1 of ind2, and allele 2 of indl can only be
IBD with allele 2 of ind2. Because we sum over all values of a and we do
not ﬁx the allelic values of the speciﬁc alleles, this leads to the same
likelihood as if we had not restricted the IBD sharing patterns. The
three terms in the aforementioned likelihood are given in the supplemen-
tary data. The ML solution is found using an Expectation-Maximization
algorithm (see Supplementary Data) which is accelerated using the
squared iterative method S3 Waradhan and Roland, 2008).

3 RESULTS AND DISCUSSION

To assess RelateAdmix, we simulated data and applied the tools
RelateAdmix, REAP, KING and Plink. Using allele frequencies
from 104 290 single nucleotide polymorphisms from a HapMap
phase 3 European and African population, we simulated 1600
individuals with different relationships and varying degree of
admixture (see Supplementary Data for details). We then used
the software Admixture (Alexander et at, 2009) to estimate ad-
mixture proportions for all the individuals and allele frequencies
for the two populations and used these estimates and the genetic
data as input to RelateAdmix and REAP. For Plink and KING,
we only used the genetic data as input. Finally, we used
RelateAdmix, REAP and Plink to estimate R between all pairs
of individuals, in total 1279 200 pairs, see Figure 2. Additional

plots of the kinship coefﬁcient, also including a plot for KING,
which provides estimates of the kinship coefﬁcient but not R, are
shown in the Supplementary Material. The results show that
based on R all the methods can identify the closely related indi-
viduals, but that Plink and REAP have problems separating the
unrelated individuals from the more distantly related individuals.
Based on the kinship estimates both REAP and RelateAdmix
can distinguish all relationships, whereas Plink and KING still
have problems. The results also show that RelateAdmix gives
more accurate R estimates for all relationships.

Funding: The Danish Council of independent research and the
Villum Foundation.

Conﬂict of Interest: none declared.

REFERENCES

Albrechtsen,A. et al. (2009) Relatedness mapping and tracts of relatedness for
genome-wide data in the presence of linkage disequilibrium. Genet.
Epidemiol., 33, 266—274.

Alexander,D.H. et a]. (2009) Fast model-based estimation of ancestry in unrelated
individuals. Genome Res., 19, 1655—1664.

Manichaikul,A. et al. (2010) Robust relationship inference in genome-wide associ-
ation studies. Bioinformatics, 26, 2867—2873.

Milligan,B.G. (2003) Maxirnum-likelihood estimation of relatedness. Genetics, 163,
1153—1167.

Purcell,S. et al. (2007) PLINK: a tool set for whole-genome association and popu-
lation-based linkage analyses. Am. J. Hum. Genet, 81, 559—575.

Ritland,K. (1996) Estimators for pairwise relatedness and individual inbreeding
coefﬁcients. Genet. Res., 67, 175—185.

Rohlfs,R.V. et al. (2012) Familial identiﬁcation: population structure and relation-
ship distinguishability. PLoS Genet, 8, e1002469.

Thompson,E.A. (1975) The estimation of pairwise relationships. Ann. Hum. Genet,
39, 173—188.

Thornton,T. et a]. (2012) Estimating kinship in admixed populations. Am. J. Hum.
Genet, 91, 122—138.

Varadhan,R. and Roland,C. (2008) Simple and globally convergent methods for
accelerating the convergence of any EM algorithm. Scand. J. Stat, 35, 33 5—353.

 

1 028

112 [3.1081120an[plOJXO'SODBIIIJOJHIOIQ/[ldllq won pepeolumoq

910K ‘09 lsnﬁnV no :2

