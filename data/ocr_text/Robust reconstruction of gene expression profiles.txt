Bioinformatics, 31, 2015, i71—i79
doi: 10.1093/bioinformatics/btv246
ISMB/ECCB 2015

 

Robust reconstruction of gene expression
profiles from reporter gene data using linear
inversion

Valentin Zulkower1, Michel Page1'2, Delphine Ropers‘,
Johannes Geiselmann1'3 and Hidde de Jong1'*

1INRIA Grenoble—Rhone-Alpes, 655 Avenue de I’Europe, Montbonnot, 38334 Saint-Ismier Cedex, France, 2IAE
Grenoble, Université Pierre-Mendes-France, Domaine universitaire BP 47, Grenoble Cedex 9, 38040 Saint Martin
d'Heres, France and 3Laboratoire Interdisciplinaire de Physique (CNRS UMR 5588), Université Joseph Fourier, 140
Avenue de la physique BP 87, 38402 Saint Martin d'Heres, France

*To whom correspondence should be addressed.

Abstract

Motivation: Time—series observations from reporter gene experiments are commonly used for
inferring and analyzing dynamical models of regulatory networks. The robust estimation of pro—
moter activities and protein concentrations from primary data is a difficult problem due to meas—
urement noise and the indirect relation between the measurements and quantities of biological
interest.

Results: We propose a general approach based on regularized linear inversion to solve a range of
estimation problems in the analysis of reporter gene data, notably the inference of growth rate,
promoter activity, and protein concentration profiles. We evaluate the validity of the approach
using in silico simulation studies, and observe that the methods are more robust and less biased
than indirect approaches usually encountered in the experimental literature based on smoothing
and subsequent processing of the primary data. We apply the methods to the analysis of fluores—
cent reporter gene data acquired in kinetic experiments with Escherichia coli. The methods are cap—
able of reliably reconstructing time—course profiles of growth rate, promoter activity and protein
concentration from weak and noisy signals at low population volumes. Moreover, they capture crit—
ical features of those profiles, notably rapid changes in gene expression during growth transitions.
Availability and implementation: The methods described in this article are made available as a
Python package (LGPL license) and also accessible through a web interface. For more information,
see https://team.inria.fr/ibis/we|linverter.

Contact: Hidde.de—Jong@inria.fr

Supplementary information: Supplementary data are available at Bioinformatics online.

 

 

1 Introduction

Over the past decade, a variety of new experimental technologies
have become available for measuring gene expression over time.
They provide valuable information for the construction and valid—
ation of models of gene regulatory networks, involving tasks like
parameter estimation, hypothesis testing and model selection
(Bansal et 61]., 2007; de Smet and Marchal, 2010; Villaverde and
Banga, 2014). A critical step in the exploitation of the experimental
data is the estimation of biologically relevant quantities, in particu—
lar promoter activities (the rate of transcription of a gene as a frac—
tion of the maximum rate), mRNA concentrations and protein

©The Author 2015. Published by Oxford University Press.

concentrations, from the primary data provided by the measurement
instruments. This requires data analysis procedures that are un—
biased and robust to measurement noise.

Fluorescent reporter genes have become widely used for monitor—
ing gene expression in bacteria at high temporal resolution in a non—
intrusive way (Chudakov et 61]., 2010; Giepmans et 61]., 2006). The
underlying principle is the fusion of a gene of interest and/or the
promoter region driving its expression with a gene encoding a ﬂuores—
cent protein (Fig. 1). A bacterial strain carrying the resulting reporter
gene, on the chromosome or on a plasmid, emits a ﬂuorescence
signal proportional to the amount of reporter protein in the cell.

i71

This is an Open Access article distributed underthe terms of the Creative Commons Attribution Non-Commercial License (http://creativecommons.org/licenses/by-nc/4.0/),
which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact

journals.permissions@oup.com

112 /§.IO'S[BU.IT10[p.IOJXO'SOTZIBIHJOJUTOTQ/ﬁ(1111] 11101; pepBOIUAAOG

9IOZ ‘09 lsnﬁnv uo ::

i72

V.Zulkower et al.

 

acs mRNA ACS

E»e;‘s>’—»
Pyrcws Ive) .Paxpe)

Ga) gfp mRNA GFP

 

mature GFP

 

W08 gfp M(t) Ru(t)

Fig. 1. Expression of the gene acs in Escherichia coli and the associated re-
porter gene pacs-gfp. acs and gfp mRNA are transcribed, and translated into
the proteins Acs and GFP, respectively. Both mRNA and protein are
degraded. Moreover, GFP is converted into a mature form in which it emits
fluorescence when excited. Because acs and its reporter have the same pro-
moter region, the transcriptional regulation of the two genes is identical. The
variables are as defined in Equations (16) and (17)

When reporter strains are grown in a microplate, the ﬂuorescence
and the absorbance (optical density) of the culture can be automatic—
ally measured every few minutes in a highly parallelized way. The
resulting data contain information on population—level gene expres—
sion that is highly valuable for such applications as the inference and
analysis of regulatory networks in bacterial cells (Berthoumieux
et al., 2013; Gerosa et al., 2013; Keren et al., 2013; Ronen et al.,
2002; Stefan et al., 2015).

The extraction of useful information from reporter gene data is
not easy to achieve though, since it is often buried in noise, espe—
cially at low population densities. Moreover, the fluorescence and
absorbance measurements are only indirectly related to promoter
activities and protein concentrations, requiring dynamical models of
the expression of reporter genes for their interpretation. Several
methods have been proposed to process the ﬂuorescence and absorb—
ance signals and estimate time—varying promoter activities and pro—
tein concentrations from the data (A'ichaoui et al., 2012; Bansal
et al., 2012; de Jong et al., 2010; Finkenstadt et al., 2008; Leveau
and Lindow, 2001; Lichten et al., 2014; Porreca et al., 2010; Ronen
et al., 2002; Wang et al., 2008). The methods differ in the scope of
the estimation problems considered, some being restricted to the in—
ference of promoter activities and others also considering mRNA
and protein concentrations. In addition, the approaches used to esti—
mate these quantities from the primary data are quite different.
Some methods are indirect, in the sense that they smoothen the data
first and reconstruct the profiles of interest via the measurement
model only in a second step. This results in a propagation of estima—
tion errors that is difficult to control. Other methods state a regular—
ized data fitting problem directly in terms of the quantities of
interest, thus, proceeding in a single and better controlled optimiza—
tion step.

In this article, we propose a general, comprehensive approach to—
ward the reconstruction of gene expression profiles from reporter
gene data and solve the estimation problems it comprises in a math-
ematically sound and practical manner. We formulate the estimation
problems in the classical framework of regularized linear inversion
(Bertero, 1989; de Nicolao et al., 1997; Wahba, 1990), which gives
access to a range of powerful tools for robust estimation. Contrary
to the related work of Bansal et al. (2012) and Porreca et al. (2010),
we consider not only the inference of promoter activities, but also of
growth rates and protein concentrations. Moreover, no restrictions
are imposed that limit the practical applicability of the approach.
We propose efficient procedures for the implementation of the

methods and show by means of an in silico simulation study under
realistic conditions that they perform better than the indirect
approaches usually encountered in the experimental literature. The
algorithms have been implemented in a Python package and are also
accessible through a web application.

Our linear inversion methods have been tested on ﬂuorescent re—
porter gene data acquired in experiments with the model bacterium
Escherichia coli. These experiments aim at quantifying the dynamics
of gene expression during growth transitions induced by carbon up—
shift or depletion. We show that linear inversion succeeds in ro—
bustly reconstructing growth rate, promoter activity and protein
concentration over the entire duration of the experiment, in particu-
lar in the beginning when the population density and thus the signal—
to—noise ratio are low. Moreover, we show that our methods reliably
capture rapid changes in gene expression during growth transitions,
when promoter activities may change 10— to 100—fold within a dozen
of minutes (Baptist et al., 2013; Enjalbert et al., 2013; Kao et al.,
2005). Reconstructing these transient gene expression profiles from
the data is highly important for increasing our understanding of the
functioning of the underlying regulatory networks, but is difficult to
achieve.

To the best of our knowledge, the methods and computer tools
presented in this paper provide the most comprehensive solution for
analyzing reporter gene data available to date. Although the applica—
tion has focused on ﬂuorescent reporter gene data, the methods are
directly applicable to the analysis of luminescent reporter gene data
or other time—series gene expression datasets. In addition, the gene
expression models underlying the methods are valid not only for
bacteria but also for higher organisms.

2 Linear inversion methods

In this section, we review properties of linear ordinary differential
equations (ODEs) and linear relationships between different outputs
driven by the same input. This theoretical framework enables us to
estimate growth rate, promoter activity and reporter concentration
using simple linear inversions in Section 3.

2.1 Inversion of a linear ODE system
We consider the following linear ODE model with input u(t) E R
and output y(t) E R:

in» = Amxm + W >,
3’0) = C(t)x(t), (1)
X0» = X0

In this system, X(t) E R" is a vector of state variables, and A(t),
B(t), C(t) are known time—varying matrices with dimensions n x n,
n x 1, 1 x n, respectively. Given a set of noisy observations
(3~/(t,-))1S,-SNy of y(t,-), we wish to estimate the unknown input u(t) and
initial conditions X0. The solution of Equation (1) at time t with input
a and initial conditions X0 can be formulated explicitly as:

y(t, 14, X0) : C(t) (@(t, 0) X0 —1— J; @(t, t) B(t) 14(1) d1), (2)

where @(t, t) is known as the state transition matrix in linear sys—
tems theory, and depends on the values of A between ‘E and t (Chen,
1970). Notice that in this equation y(t, 14, X0) depends linearly on the
signal it and the initial conditions X0, making the estimation of these
variables from (37(2))19-SNy a linear inversion problem (Bertero,
1989; de Nicolao et al., 1997; Wahba, 1990).

112 /§JO'S{eu1no [p.IOJXO'SOTlBIHJOJUTOTQ/ﬁdllq 11101; prBOIIIAAOG

9IOZ ‘09 lsnﬁnv uo ::

Robust reconstruction of gene expression profiles

i73

 

Under the classical assumption of Gaussian i.i.d. measurement
noise, the maximum likelihood solution of this problem can equiva—
lently be written as

Find (12,120) : argmin Err(u,x0), (3)
(u,X0)

where

22

Err(u,X0) = (3)013“, X0) — 37(tillz-

i

I)
H

Without further assumptions on u(t) this problem is ill—posed,
i.e. there are infinitely many equivalent solutions (u(t), 320), many of
which will be unrealistic from a biological point of view. The prob—
lem must therefore be regularized by formulating additional as—
sumptions that lead to a unique, acceptable solution.

To this end, we discretize the time space of the input into Nu
intervals [1,, 174.1), of equal length (3t. We assume that on this grid of
time intervals the input u(t) is sufficiently well approximated by a
piecewise—constant input  13EN“:

Nu

u(t) = Z “(anmwm (4)

i=1

Because the output y(t) depends linearly on u, the values
(y(t,-, u, X0))1SiSNy depend linearly on (u(t,-))1 <1. SN“. If we define the
following vectors:

“(11) y(t1.u.xo) W1)
u(tz) y(t2.u.xo) ~ 902)

ll 2 z 7 y 2 z ’ y : z 7
u(TNM) WNyauaxo) WM}

and W : (X0 11 )T, then there exists an observation matrix HW with
dimension (NM —1— n) X Ny, such that

HW W = y. (5)
The matrix HW is composed of two matrices:
HW : (HX0 Hu ),

where HX0 is a N), x n matrix describing the influence of the
initial conditions on y, and HH a N), x Nu matrix describing the
inﬂuence of u on y. The computation of HW can be generally
performed using a numerical ODE solver, as explained in
Supplementary Section S3. However, for the cases of interest
described in Section 3, we provide more effective formulas for the
computation of HW.

Our inversion problem now writes as a multivariate linear re—
gression problem:

A

. £0 A . z 2
F1nd : W : argm1n HHWW — y||2. (6)
1.1 W

This problem may also be ill—posed, in particular when NM > Ny.
Tile/oonov regularization on the first derivative (Hansen, 1992) con—
sists in introducing a penalty on the successive variations of u,
modulated by a regularization parameter 120:

NM—I
Find W : argmin Hwa —  + i Z (uj+1 — 11;")27 (7)
W i=1

where 11,- and u,-+1 denote the jth and (j —1— 1)th element of u, respect—
ively. Practically, this penalty is implemented by introducing a new

(Nu —1— n) X 1—vector V : LWW and a new (Ny) >< (NM —1— n)-matrix
HV : HWL‘Tvl, where LW is a matrix of the form

(01,, 0
LW 2 .
0 Lu

In the formulation above, In is the n x n identity matrix, and
a) E R a small but non-zero number ensuring that the values of X0
contribute negligibly to the penalty term while keeping LW
invertible. Lu is the NM >< Nu discrete differentiation matrix

6 0

0 —11

In Bansal et al. (2012), the parameter 6 is chosen equal to 1, but
this results in a biased estimation of no as 6 represents a penalty on
this parameter. Supplementary Section Sl discusses how to find an
appropriate value for e, typically 0 < 6 << 1.

The inversion problem of Equation (7) can be reformulated in
matrix form as

A

ll

320
Find < > :Lv—Vlv, where (8)

v =argmin IIva—rlliwllvlli. <9)
V
For A large enough, this problem admits a unique solution
(Hoerl and Kennard, 1970):

5;
< ,0) = w =L;V1(HVTHV +iI)—1HVTy. (10)
u

The regularization parameter A can be set arbitrarily. However,
i too large will lead to over—smoothed estimates of u(t), whereas 1
too small will lead to under—smoothed (unstable) estimates of u(t).
Many techniques have been proposed to automatically select a
proper i to regularize a given problem. In this article, the choice of i
will always be based on generalized cross-validation (GCV) (Golub
et al., 1979), a fast procedure which aims at maximizing the predict-
ive power of the resulting estimate of u. It is also straightforward to
deal with additional linear constraints in the problem of Equations
(8) and (9), for instance to ensure that the estimated input 11 is al—
ways positive (Supplementary Section S2 for technical details).

2.2 Linear inversion involving ODE systems with
identical input

We now consider two linear ODE systems, defined as in Equation
(1), sharing the same input u(t), but having different variables X1(t)
and X2(t), possibly different parameters, different initial conditions
X071 and X02, and different outputs 321 and y2. The goal is to estimate
the profile 321 from observations of y2. This case will be found useful
in Section 3.4 for computing protein concentrations. We have seen
in the previous section that there is a linear relationship between u
and 321 on one hand, and between u and y2 on the other hand. This
gives rise to linear inversion problems defined by the observation
matrices le and HW2 , respectively (Fig. 2):

X0,1 X0,2
HW1 : Y1 and sz : 3'2-
ll 11

When le is invertible (which can be enforced in many cases since
the length (SI of the discretization intervals of u can be chosen

1e /§JO'S{eu1no [p.IOJXO'SOTlBIHJOJUTOTQ/ﬁdllq 11101; popeommoq

9IOZ ‘09 lsnﬁnv uo ::

i74

V.Zulkower et al.

 

Y1 X0,2

Kody
u
H
X0,2 j/ y
R
Y2

Fig. 2. Schematic representation of the linear relationships between vari-
ables u, x03, xog, y1 and y2. Arrows indicate the linear relationships derived
in Section 2.2

arbitrarily), it is possible to relate y1 to yz through a chain of linear
transformations:

X0,2
(X0,2 > H1 H2 (X072 > sz
—> X071 ——> —> yz7
Y1 ‘1
u
where matrices H1 and H2 are defined as follows:

1712 0 1112 0112 X111 0
H1 2 _1 7 H2 2 7
0 HW1 0 0Flu ><7’11 INu

and n1, n2 are the lengths of vectors X1 (t), X2(t).
By lumping this chain into a single transformation matrix
Hy : HW2 H2H1 we obtain

X0,2
HY : YZ7
Y1

and y1 can be estimated from observations of y2 using Tikhonov
regularization with GCV, as explained in the previous section.

3 Estimation of gene expression profiles from
fluorescent reporter gene data

In this section, we will show how recurring problems in the analysis
of reporter gene data, the estimation of growth rate, promoter activ—
ity and protein concentration, can be mapped to the linear inversion
problems formulated above. We apply the resulting methods to the
analysis of ﬂuorescent and absorbance signals measured in popula—
tion—level experiments in E. coli, in conditions involving time—vary—
ing changes in growth rate and gene expression.

3.1 Fluorescent reporter gene experiments in E. coli
Changes in the environment trigger a variety of responses in bacter—
ial cells, affecting intracellular metabolite pools within seconds and,
on a longer time—scale, protein concentrations and physical param—
eters like cell size. The regulatory networks controlling these adapta—
tions are complex and only partially understood.

In this article, we consider four genes playing a key role in the
adaptation of E. coli to perturbations due to the sudden availability
or depletion of carbon sources in the medium. These genes are fis,
encoding a global regulator responsible in particular for activating
ribosomal RNA transcription (Bradley et al., 2007); gyrA, coding
for DNA gyrase which negatively supercoils DNA (Travers and
Muskhelishvili, 2005 ); crp, whose product regulates the transcrip—
tion of hundred of genes when activated by the secondary messenger
cyclic adenosine monophosphate (cAMP) (Gosset et al., 2004) and
acs, encoding an enzyme required for acetate consumption (Wolfe,
2005). We used reporter strains obtained by transforming the E. coli

wild—type strain with reporter plasmids carrying a transcriptional fu-
sion of the promoter region of the above genes with a gfp reporter
gene. The reporter genes for acs and crp code for GFPmut2, a re—
porter with a long half—live (19 h), whereas the other reporter genes
code for GFPmut3, with a short half—live of 1h (Supplementary
Section S4 for details on the plasmids and strains used in this study).

Overnight stationary—phase cultures of the reporter strains were
diluted into the wells of a microplate containing minimal medium
with glucose. The bacteria were observed in a microplate reader up
until a few hours after glucose exhaustion (Supplementary Section
S4 for details on the experimental conditions). The carbon upshift
provokes a strong activation of the expression of many genes, while
growth arrest following glucose exhaustion triggers the activation of
so—called catabolite genes, responsible for the assimilation of second—
ary carbon sources, such as acetate secreted during rapid growth on
glucose (Baptist et al., 2013; Enjalbert et al., 2013; Kao et al.,
2005). The absorbance (600nm) and fluorescence (485/520 nm) of
the growing bacterial cultures was measured for each of the 96
wells, typically one measurement per minute per well.

The absorbance (optical density) measurements are usually
assumed proportional to the volume V(t) E R+ of the growing cell
population. More precisely, for measurements made at time—points
t,-, we have the following measurement model:

V(t)) = ocV(t,-) + a, (11)
where V(t)) represents the absorbance measurement at t,-, or E R+ an
unknown proportionality coefficient, and v,- measurement noise. We
assume that the ﬂuorescence measurements have been corrected for
autofluorescence of the bacteria. Here, we simply subtracted the
ﬂuorescence time—course profile of a control strain carrying no re-
porter plasmid, but in other situations more sophisticated methods
for background correction may need to be used, so as to avoid bias
(Lichten et al., 2014; Stefan et al., 2015). The resulting ﬂuorescence
signal can be assumed proportional to the total quantity of active
(mature) fluorescent protein R(t) in the growing cell population:

Rm) 2 mm) + :4, (12)

where E(t,-) represents the ﬂuorescence measurement at t,-, ﬂ E R+
an unknown proportionality coefficient, and v:- measurement noise.
The absorbance and ﬂuorescent measurements that will be used
hereafter are shown in the top row of Figure 3. The data illustrate
some of the difficulties encountered in the analysis, namely weak
signals in the beginning of the experiment, when the volume of the
cell population is low, and rapid changes during growth transitions.

3.2 Estimation of growth rate

The exhaustion of glucose in the medium around 500 min is fol-
lowed by growth arrest, causing a break in the absorbance curves
(Fig. 3). In order to sharply distinguish the growth phases, it is im—
portant to precisely estimate the growth rate of the population,

defined by

W) = ﬁgvm = $10M)- (13)

It is possible to compute u(t) from the absorbance measurements
V(t)) of the volume V(t), by smoothing interpolation, subsequent
differentiation and numerical resolution of Equation (13). However,
this method is unstable when the signal—to—noise ratio is low, espe—
cially in the early stages of the experiment. Moreover, measurements
of V(t) can exhibit a high noise—to—signal ratio and even be negative

at times, which prohibits the use of log V as an input variable.

12 /§JO'S{eu1no [p.IOJXO'SOTlBIHJOJUTOTQ/ﬁdllq 11101; popeommoq

9IOZ ‘09 lsnﬁnv uo ::

Robust reconstruction of gene expression profiles

i75

 

ﬁs gyrA

crp acs

 

Normalized
fluorescence

  

 
    

 

0.006 —

0.000 —

u(t) (min—1)

 

 

 

 

0 — l

 

 

 

 

0 500 O

t (min) 75 (min)

500 0 500 0 500

25 (min) 25 (min)

Fig. 3. Fluorescence and absorbance data obtained from reporter gene experiments in E. coli and estimations of growth rate, promoter activity and protein
concentration from these data. The measured fluorescence and absorbance signals are shown in the top row. The estimations of growth rate, promoter activity
and protein concentration are denoted by u(t), an) and p(t), respectively. The fluorescence signal, an), and p(t) have been divided by their mean as they have
different orders of magnitude for genes fis, gyrA, crp and acs. For each signal, four replicates are shown, corresponding to different wells of the microplate

As an alternative approach, we formulate the problem as a linear
inversion problem. We first rewrite Equation (13) as

$61 V)(t) = or V(t) u(t) 2 V(t) u(t), <14)

where  is an interpolated version of the measurements V(t)).
Replacing the volume by the experimentally measured absorbance
signal has the advantage of bringing the equation into the form of
Equation (1) (we use scalars to represent 1D vectors and matrices in
order to simplify the notation):

“(0 = #0): X0) = 06 V(t): 3’0) = 06 V(t)
A(t) = 0, B(t) = V(t), C(t) = 1.

That is, the growth rate is the input and the volume the output of
a linear system, so that the growth rate can be estimated by linear in—
version from the absorbance measurements.

The observation matrix HW for this system can be computed as
explained in Supplementary Section 83.1. Solving the problem of
Equations (8) and (9) by regularization, we obtain the estimates it
and V0 of the growth rate and the initial volume, respectively.
The growth rate estimations u(t) are shown in the second row of
Figure 3. As can be seen, upon glucose exhaustion the growth rate
drops from its maximum value to 0. Growth arrest is abrupt in the
conditions under which the data for acs and crp were acquired
(Supplementary Section S4).

As our method relies on penalizing successive variations of u(t),
the question arises whether this entails a strong bias. In particular,
how well estimated are the timing of the transition between the two
growth phases, and the values of the growth rate during each phase?
We tested the method on simulated data similar to the measure—
ments in Figure 3, notably with equivalent sampling densities and
signal—to—noise ratios. The results are presented in Supplementary

Section S5. They show that our estimation method is able to recover
different growth—rate profiles, with very low bias and moderate
variance.

For comparison we also estimated the growth rate with the indir—
ect method described after Equation (13). In particular, we
smoothed the absorbance measurements V(t)) by means of smooth—
ing splines in order to estimate the volume and its derivative, and
computed an estimate of u(t) by means of Equation (13). For simu-
lated data shown in Figure 4A, the results in panel B show that at
the beginning of the experiment, when the absorbance signal is low,
the growth rate estimation is highly unstable. Additional numerical
experiments, shown in Supplementary Section S5, indicate that
increasing the smoothing parameter to reduce the variance of the es—
timates introduces a strong bias on the estimate, reﬂecting the well—
known variance—bias trade—off. We conclude that the proposed lin—
ear inversion method performs better than this indirect approach.

Notice that the estimation of growth rate and initial volume also
leads to a denoised estimation of the population volume by
Equation (5):

ﬁsz(ﬁzo 3), (15)

which will be used in the next sections for the estimation of pro—
moter activity and protein concentration.

3.3 Estimation of promoter activity

The interest of the use of reporter genes is that, by construction,
they provide information on the expression of a gene of interest. We
will focus on transcriptional fusions here, where the reporter gene
and the gene of interest share the same promoter region and their
promoter activities can be considered identical, possibly up to a
multiplicative constant (Fig. 1).

1e /§JO'S{eu1no [p.IOJXO'SOTlBIHJOJUTOTQ/ﬁdllq 11101; popeommoq

9IOZ ‘09 lsnﬁnv uo ::

 

 

 

 

    

 

 

 

i76 V.Zulkower et al.
A dimensionless quantity scaled between 0 and 1, the promoter activ-
8 ity. This quantity is the net effect of the different regulatory mechan-
EJ  _ isms driving the transcription of the gene, involving RNA
23 -  polymerase, transcription factors and other regulators. With the
g constants dM,leU,dR,leR E R+ (min—1), characterizing the degrad—
E ation, translation and maturation steps, we obtain the following
0 _....h._.. . “A — - n- . 0.0 ODE system:
B  truth
E indirect d
<1 -—- direct EMU) = (QM a(t) V(t) — dM M0),
2 A A 6:1 d
2. @190) = kuM(t> — (dR + be) Rue). <16)
1 d

 

 

 

 

Normalized

 
  

indirect
l—l direct

0 400 800

 

 

 

 

 

 

Fig. 4. Comparison of different methods for the estimation of growth rate
and promoter activity from reporter gene data. We compare indirect
approaches based on plugging empirically smoothed data into measurement
models with the direct linear inversion methods proposed here (including a
variant in which 6 is set to 1). Additional examples can be found in
Supplementary Section 85. (A) Simulated noisy absorbance data (gray) and
fluorescence data (green). (B) Estimates of the growth rate u(t) obtained with
the different methods. (C) Estimates of promoter activity a(t). (D) Estimates of
protein concentration p(t), using the direct method developed in this article,
and an indirect method consisting in the estimation of a(t), followed by nu-
merical solution of Equation (17). Solid lines and shaded regions represent
the mean i one standard deviation over 100 simulations. The direct methods
perform better than the indirect methods in that they yield estimates with less
bias and lower variance. The use of 621 may introduce a bias

The relation between promoter activity and observed fluores—
cence and absorbance signals is indirect and models of gene expres—
sion are needed to interpret the primary data. Several models have
been proposed in the literature (see the references in the introduc—
tion), but here we follow with some modifications the model used in
de Jong et al. (2010). The expression of a ﬂuorescent reporter gene
is modeled as a three—step process involving transcription, transla-
tion and maturation of the ﬂuorescent protein (Fig. 1). The variables
of the model are M (t), Ru(t), R(t) E R+, denoting the total quantity
of gfp mRNA in a growing cell population and the total quantity of
immature and mature Green Fluorescent Protein (GFP), respectively
(in mmol). In comparison with other models, we consider total
amounts of molecules and not concentrations. This has the advan—
tage of simplifying the estimation of promoter activities, since terms
due to growth dilution drop from the equations.

The rate of transcription drives the dynamics of gene expression
and is defined as lem a(t) V(t), representing the total amount of
mRNA produced per time unit in the growing cell population
(mmol min—1). Parameter lem E R+ represents the maximum tran-
scription rate per unit volume, and we will call a(t) E R+, which is a

aR(t) = leR Ru(t) — dR R(t).

Notice that the transcription rate is modulated by the volume of
the growing cell population, which can be replaced by its estimate
from Equation (15). As a consequence, the first equation of the
model writes

d , A

EMU) = leM a(t) oc V(t) — dM M(t),
where la),I : leM/oc. The resulting gene expression model can be eas—
ily brought into the form of Equation (1 ):

M(t) —dM 0 0

R0) 0 la: —ClR
(NT/(t) 0
B(t)= 0 , C(t)= 0 , u(t)=a(t),
0 ﬂ
W) = ﬁlm)-

This allows the promoter activity a(t) as well as the initial condi—
tions M0, Ruo, R0 to be estimated from the measured ﬂuorescence
signal R(t,-). Whereas the degradation constants dR, dM and the mat—
uration constant leR can usually be measured with high precision
(de Jong et al., 2010), this is generally not the case for the other
parameters. However, we prove in Supplementary Section S6 that
setting ﬂ, lay, (VI to 1 still allows the time—varying profile of a(t) to
be estimated, up to some unknown multiplicative coefficient (as
usual in the literature).

Section 3.2 provides an efficient procedure for computing the ob—
servation matrix HW for the above system. The efficiency and accur—
acy of the computation of the observation matrix can be further
increased when gfp mRNA is unstable and the maturation time is
fast (i.e. for 13R and dM large compared with dR), which is the case
for the reporter genes used in this study (de Jong et al., 2010). This
makes it possible to lump the gene expression model of Equation
(16) into a single step and thus simplify the regularized regression
problem.

The linear inversion method for computing the promoter activity
was applied to the reporter gene data in Figure 3, resulting in the
estimates shown in the third row. We notice a sharp peak in the pro—
moter activity of fis right after the nutrient upshift, which is consist—
ent with previous reports (Azam et al., 1999), and the same
behavior is observed for gyrA. Whereas the activity of the crp pro—
moter shows little variation, consistent with the observation that the
Crp concentration does not change much across growth phases
(Kuhlman et al., 2007), upon glucose exhaustion the activity of acs

1e /§JO'S{eu1no [p.IOJXO'SOTlBIHJOJUTOTQ/ﬁdllq 11101; popeommoq

9IOZ ‘09 lsnﬁnv uo ::

Robust reconstruction of gene expression profiles

i77

 

shows a dramatic increase, in large part due to sudden accumulation
of cAMP in the cell (Berthoumieux et al., 2013; Wolfe, 2005 ). These
examples illustrate that the method correctly infers known fast
changes in gene expression from the data, while avoiding overfitting
outside the transition region.

Like in Section 3.2, we used in silico benchmarks resembling the
actual data to further evaluate the ability of the method to recon—
struct promoter activities, in particular the timing of the peak
and its amplitude. The results in Figure 4C and Supplementary
Section S5 show that the method is stable even when the signal—
to—noise ratio is low, and captures the rapid variations in promoter
activity with high precision. Like in Section 3.2, we remark that
the method is robust, although it introduces some bias in extreme
cases. However, this bias is much smaller than that obtained by an
indirect method analogous to that outlined in the previous section
(Fig. 4C).

The estimation of the promoter activity is interesting in its own
right, as it gives insight into changes in the transcriptional activity of
specific genes during growth transitions. However, it can also be the
first step toward the estimation of the concentration of the regula—
tors of a gene (Bansal et al., 2012; Finkenstadt et al., 2008) or of the
concentration of the protein encoded by the gene of interest (de Jong
et al., 2010). In the next section, we will develop a direct linear in-
version method for addressing the latter problem.

3.4 Estimation of protein concentration

The expression of a gene of interest involves the same steps as the ex—
pression of the reporter gene, without the maturation step (Fig. 1).
As explained in the previous section, in the case of transcriptional
fusions the promoter activities a(t) of the two genes are the same.
However, the other parameters describing mRNA and protein syn-
thesis and degradation may be different.

In order to model the expression of the gene of interest, we intro—
duce new variables describing the total amount of mRNA and pro-
tein for the gene of interest, denoted by N(t) and P(t) (mmol),
respectively, and new kinetic constants leN, dN, lap, dp (min—1) repre-
senting the production and degradation rate of the mRNA and pro—
tein of interest. The protein concentration is given by
p(t) : P(t)/ V(t). This results in the following ODE system:

%N(t) = leN V(t) a(t) — dN N(t),
%P(t) =l€pN(t)—dPP(tl7 (17)

W) = P(t)/V(t)-

Introducing the variables N’ (t) : ocN (t) and P’ (t) : ocP(t), the
system of Equation (17) becomes

iN’m = Im a W) a(t) — dN NW
gP’U) =kpN’(t) —dPP’(t) (18)

W) = P’(t)/(0< V(t))-

Like in the previous section, ocV(t) can be replaced by the experi—
mentally measured absorbance signal or V(t), yielding:

N’(t) —dN 0

x(t)= , A(t)= , u(t)=a(t),
P’(t) lap —dp
kNaT/(t) 0

B(t)= , C(t)= , y(t)=p(t)

For the estimation of the protein concentration p(t), the scheme
outlined in Figure 2 applies, with u(t) : a(t), y1(t) : p(t), and
372(t) :  This allows an estimate of p(t) to be obtained from the
experimental measurement of R(t) as explained in Section 2.2.
When the gene expression model in Equation (18) can be reduced to
a single step, the observation matrix of the problem can be com—
puted in an efficient way as explained in Supplementary Section
83.4.

The protein concentrations estimated from the E. coli reporter
gene data by means of the above method are shown in the bottom
row of Figure 3. The degradation constant of Fis was measured
[dp = 0.0065 min—1; de Jong et al. (2010)], whereas the other pro—
teins were assumed to be long—lived (dp = 0.001 min—1), like most
proteins in E. coli (Larrabee et al., 1980). We observe that the Fis
concentration transiently increases after the nutrient upshift, which
is consistent with the role of Fis in activating the synthesis of stable
RNAs necessary for growth (Dennis et al., 2004). The concentration
of Crp is stable during growth on glucose and somewhat increases
after glucose exhaustion, as expected from the fact that Crp acti—
vates catabolic genes needed for growth on poor carbon sources
(Gosset et al., 2004). Interestingly, this accumulation cannot be sim-
ply inferred by looking at the ﬂuorescence data, which show no in—
crease after glucose exhaustion. It illustrates the importance of
taking into account different half—lives for reporter proteins and pro—
teins of interest.

We also tested this method on the simulated data. The results are
reported in Figure 4D and show that linear inversion is more stable
and introduces less bias than other approaches, notably indirect
approaches based on the estimation of a(t) and numerical integra-
tion of Equation (18) using this estimate. Another advantage of the
linear inversion method is that it does not need an estimate of the
initial conditions, which are often unknown. In conclusion, our dir—
ect method allows rich information on gene expression to be
inferred from the absorbance and ﬂuorescence data under reason—
able assumptions.

4 Software for applying linear inversion methods

As they rely on few assumptions and require virtually no hand—tun—
ing, the linear inversion methods presented above are suitable for
routine treatment of reporter gene data obtained in microplate ex—
periments, which generate a huge quantity of measurements (typic—
ally 104 — 105 data points). The linear inversion methods were
implemented in the Python package WellFARE, relying on the scien-
tific libraries NumPy and SciPy (Jones et al., 2001). In addition, the
package provides utilities for parsing data files and removing out—
liers from the absorbance and fluorescence signals. The WellFARE
package is available under an LGPL license, but has also been inte—
grated into a web application called WellInverter, which provides a
user—friendly access to the linear inversion methods through a web
browser (Fig. 5). The user can upload data files by means of
WellInverter, remove outliers and subtract background, and launch
the procedures for computing growth rates, promoter activities, and
protein concentrations (Supplementary Section S7).

5 Discussion

The inference of meaningful gene expression profiles from indirect
experimental data is a key step in the analysis of dynamical models
in systems biology. As reporter genes tend to become ubiquitous, it
is important to develop reliable methods for the automated

1e /810'S{eu1no [p.IOJXO'SOTlBIHJOJUTOTQ/ﬁdllq 11101; popeommoq

9IOZ ‘09 lsnﬁnv uo ::

i78

V.Zulkower et al.

 

39111101! [IV 5411
I 35'1111lJ-II'I‘IIELI-EIEHUIJJ ideal :
I _:E'1U.E‘|:H-
I If“)
Pi]an
.- ‘Eauimmd
JMHDHCQ
minim-manhunt
ll IH'iilllllrlu _-:| o._-

3311120?
_ 15-1112“? nlmillrnSIJ
35111212 Lil-Full

DOC) DOD
110888300
DDDDDDUDDD
:.'I III! llulﬁlm
“ii-Lim 2 C::-.'1EIJ dull mk- Hﬂ Ell

mClIerrIn: Pr-tmater arm:

1-

IGT'I'HCIIWEIII-

.u-mumn numnomlmmr ff. ‘7' -
mfhrrrylhlnlnnnre- 

 

I‘JI|;§-q.- W113i} ‘l' ' ‘pwﬁ' -'". ' I inn-.1 l}
WHEﬁﬁg . mama-msg#11111

W51

 

Fig. 5. Screenshot of the web application Welllnverter. Welllnverter allows reporter gene experiments to be analyzed online through a web-based platform. The
screenshot shows background-corrected absorbance data and estimated promoter activities for three different wells (G7, G8 and G9)

treatment of the large amounts of data becoming available. We have
shown that the estimation of growth rate, promoter activity, and
protein concentration from reporter gene data can be expressed as
linear inversion problems using ODE—based measurement models
and we proposed efficient procedures to compute the observation
matrices solving these problems. The methods thus obtained were
used to study the expression dynamics of several genes of E. coli
during growth transitions, where they confirmed their ability to han-
dle critical issues in reporter gene data analysis: low signal—to—noise
ratios and rapid changes in gene expression in response to environ—
mental perturbations. The validity of these estimation procedures
was reinforced by tests on simulated data, which showed that the
methods are robust and little biased.

Several methods for the analysis of reporter gene data have been
proposed in the literature, all of which are implicitly or explicitly
based on the same or very similar measurement models for interpret-
ing the data. The major differences between the approaches lie in
the information they extract from the data and in the way the pro—
files are computed from the primary data. The basic idea underlying
the linear inversion methods presented here is that they are direct, in
the sense that they perform regularization on the quantity to be esti—
mated, rather than by plugging empirically smoothed versions of the
data into the measurement models (de Jong et al., 2010; Ronen
et al., 2002). Our results show that this improves the robustness of
the estimation process. In comparison with Bansal et al. (2012), we
extend the linear inversion methods to growth rates and protein con—
centrations, thus more fully exploiting the information contained in
reporter gene data. Moreover, we improve the practical applicability
of the approach in that we do not need to make assumptions that
are often not realistic, such as zero initial promoter activities, con—
stant growth rate and direct measurements of reporter concentra—
tions. The linear inversion methods remain tractable when
improving estimation through the addition of linear constraints (e.g.
to ensure positive promoter activities and protein concentrations),
the consideration of uncertainty on the data, or the use of different
regularizations (L1 regularization or regularization on the second
derivative) (de Nicolao et al., 1997).

The methods described in this article are made available as a
Python package and can also be accessed through a user—friendly
web application. Other tools for the analysis of reporter gene data
are WellReader (Boyer et al., 2010) and BasyLICA (A'ichaoui et al.,
2012). Although the Matlab program WellReader uses the indirect
approaches from de Jong et al. (2010), BasyLICA is based on the use

of Kalman filters, which also directly estimate quantities of interest
from the reporter gene data by a Bayesian approach. In comparison
with BasyLICA, WellInverter estimates not only promoter activities
but also protein concentrations from the data, and bases the infer—
ence of these quantities at a given time t not only on past data, at
time—points preceding t, but on the entire dataset. In addition,
WellInverter uses regularization based on GCV to avoid hand—
tuning.

The generality of the techniques used in this paper suggests that
they could be applied to a much wider range of problems. A neces—
sary condition for the application of the methods is that the meas—
ured data is linearly related to the biological quantity of interest.
Notice that this does not exclude time—varying parameters in
Equations (16 ) or (17), for instance a time—varying degradation con—
stant of the protein, due to a change in half—live after a growth tran-
sition (Hengge-Aronis, 2002). As long as the time—varying
parameters are known, for example when their profile has been
measured, the inversion problem remains linear. To some extent,
this even allows non—linear estimation problems to be handled in
our framework, as illustrated by the growth—rate estimation in
Section 3.2.

The methods proposed in this article provide the most general
and comprehensive treatment of the reconstruction of gene expres—
sion profiles form reporter gene data available today, based on a
solid mathematical foundation and supported by user—friendly com—
puter tools. The approach directly carry over to luminescent re—
porter genes and may also apply to time—series data obtained by
completely different experimental technologies, like DNA micro-
arrays, RNA—Seq or quantitative proteomics. Although we validated
and illustrated the methods by means of reporter gene data from
bacterial kinetics, the measurement models of Equations (16) and
(17) are sufficiently general to apply to higher organisms as well.

Acknowledgements

The authors would like to thank Eugenio Cinquemani and Alain Viari for

comments and assistance.

Funding

This work was supported by the Programme d’Investissement d’Avenir under
project Reset (ANR-11-BINF-0005).

Conﬂict of Interest: none declared.

1e /810'S{eu1no [p.IOJXO'SOTlBIHJOJUTOTQ/ﬁdllq 1110131 popeommoq

9IOZ ‘09 lsnﬁnv uo ::

Robust reconstruction of gene expression profiles

i79

 

References

Aichaoui,L. et al. (2012) BasyLiCA: a tool for automatic processing of a bac-
terial live cell array. Bioinformatics, 28, 2705—2706.

Azam,T.A. et al. (1999). Growth phase-dependent variation in protein com-
position of the Escherichia coli nucleoid. ]. Bacteriol, 181, 6361—6370.

Bansal,L. et al. (2012) Determining transcription factor proﬁles from ﬂuores-
cent reporter systems involving regularization of inverse problems. In
Proceedings of 2012 American Control Conference (ACC 2012), Fairmont
Queen Elizabeth, Montreal, Canada, pp. 2725—2730.

Bansal,M. et al. (2007) How to infer gene networks from expression proﬁles.
Mol. Syst. Biol, 3, 78.

Baptist,G. et al. (2013) A genome-wide screen for identifying all regulators of
a target gene. Nucleic Acids Res., 41, e164.

Bertero,M. (1989) Linear inverse and ill-posed problems. Adv. Electron.
Electron Phys., 75, 1—120.

BerthoumieuX,S. et al. (2013) Shared control of gene expression in bacteria by
transcription factors and global physiology of the cell. Mol. Syst. Biol, 9,
634.

Boyer,F. et al. (2010) WellReader: a MATLAB program for the analysis of
ﬂuorescence and luminescence reporter gene data. Bioinformatics, 26,
1262—1263.

Bradley,M. et al. (2007) Effects of Fis on Escherichia coli gene expression dur-
ing different growth stages. Microbiology, 153, 2922—2940.

Chen,C. (1970) Introduction to Linear System Theory. Holt, Rinehart and
Winston, New York.

Chudakov,D. et al. (2010) Fluorescent proteins and their applications in imag-
ing living cells and tissues. Physiol. Rev., 90, 1103—1 163.

de Jong,H. et al. (2010) Experimental and computational validation of models
of ﬂuorescent and luminescent reporter genes in bacteria. BMC Syst. Biol,
4, 55.

de Nicolao,G. et al. (1997) Nonparametric input estimation in physio-
logical systems: problems, methods, and case studies. Automatica, 33,
85 1—8 70.

de Smet,R. and Marchal,K. (2010) Advantages and limitations of current net-
work inference methods. Nat. Rev. Microbiol, 8, 717—729.

Dennis,P. et al. (2004) Control of rRNA synthesis in Escherichia coli: a sys-
tems biology approach. Microbiol. Mol. Biol. Rev., 68, 639—668.

Enjalbert,B. et al. (2013) Physiological and molecular timing of the glucose to
acetate transition in Escherichia Coli. Metabolites, 3, 820—837.

Finkenstadt,B. et al. (2008) Reconstruction of transcriptional dynamics from
gene reporter data using differential equations. Bioinformatics, 24, 2901—
2907.

Gerosa,L. et al. (2013) Dissecting speciﬁc and global transcriptional regulation
of bacterial gene expression. Mol. Syst. Biol, 9, 658.

Giepmans,B. et al. (2006) The ﬂuorescent toolbox for assessing protein loca-
tion and function. Science, 312, 217—224.

Golub,G.H. et al. (1979) Generalized cross-validation as a method for choos-
ing a good Ridge parameter. Technometrics, 21, 215—223.

Gosset,G. et al. (2004) Transcriptome analysis of Crp-dependent catabolite
control of gene expression in Escherichia coli. ]. Bacteriol, 186, 3516—
3524.

Hansen,P. (1992) Analysis of discrete ill-posed problems by means of the L-
curve. SIAM Rev., 34, 561—580.

Hengge-Aronis,R. (2002) Signal transduction and regulatory mechanisms
involved in control of the as (RpoS) subunit of RNA polymerase. Microbiol.
Mol. Biol. Rev., 66, 373—395.

Hoerl,A. and Kennard,R. (1970) Ridge regression: biased estimation for non-
orthogonal problems. Technometrics, 12, 55—67.

Jones,E. et al. (2001) SciPy: Open Source Scientiﬁc Tools for Python. http:/l
www.scipy.org/ (6 May 2015, date last accessed).

Kao,K. et al. (2005) A global regulatory role of gluconeogenic genes in
Escherichia coli revealed by transcriptome network analysis. ]. Biol. Chem.,
280, 36079—36087.

Keren,L. et al. (2013) Promoters maintain their relative activity levels under
different growth conditions. Mol. Syst. Biol, 9, 701.

Kuhlman,T. et al. (2007) Combinatorial transcriptional control of the lactose
operon of Escherichia coli. Proc. Natl. Acad. Sci. USA, 104, 6043—6048.
Larrabee,K. et al. (1980) The relative rates of protein synthesis and degrad-
ation in a growing culture of Escherichia coli. ]. Biol. Chem., 255, 4125—

4130.

Leveau,]. and Lindow,S. (2001) Predictive and interpretive simulation of green
ﬂuorescent protein expression in reporter bacteria. ]. Bacteriol, 183, 6752—
6762.

Lichten,C. et al. (2014) Unmixing of ﬂuorescence spectra to resolve quantita-
tive time-series measurements of gene expression in plate readers. BMC
Biotechnol, 14, 11.

Porreca,R. et al. (2010) Structural identiﬁcation of unate-like genetic network
models from time-lapse protein concentration measurements. In:
Proceedings of 49th IEEE Conference on Decision and Control (CDC
2010), Atlanta, GA, USA. IEEE, pp. 2529—2534.

Ronen,M. et al. (2002) Assigning numbers to the arrows: parameterizing a
gene regulation network by using accurate expression kinetics. Proc. Natl.
Acad. Sci. USA, 99, 10555—10560.

Stefan,D. et al. (2015) Inference of quantitative models of bacterial promoters
from time-series reporter gene data. PLoS Comput. Biol, 11, e1004028.

Travers,A. and Muskhelishvili,G. (2005) DNA supercoiling: a global tran-
scriptional regulator for enterobacterial growth? Nat. Rev. Microbiol, 3,
157—169.

Villaverde,A. and Banga,]. (2014) Reverse engineering and identiﬁcation in
systems biology: strategies, perspectives and challenges. ]. R. Soc. Interface,
11, 20130505.

Wahba,G. (1990) Spline Models for Observational Data. SIAM, Philadelphia,
PA.

Wang,X. et al. (2008) Mathematical analysis and quantiﬁcation of ﬂuorescent
proteins as transcriptional reporters. B iophys. ]., 94, 2017—2026.

Wolfe,A.J. (2005) The acetate switch. Microbiol. Mol. Biol. Rev., 69, 12—50.

112 /810'S{eu1no [p.IOJXO'SOTlBIHJOJUTOTQ/ﬁdllq 1110131 popeommoq

9IOZ ‘09 lsnﬁnv uo ::

