Bioinformatics, 31 (24), 2015, 4009—4011

doi: 10.1093/bioinformatics/btv509

Advance Access Publication Date: 30 August 2015
Applications Note

 

 

Sequence analysis

NgsRelate: a software tool for estimating
pairwise relatedness from next-generation

sequencing data

Thorfinn Sand Korneliussen1 and Ida Moltke2'*

1Center for GeoGenetics and 2Department of Biology, University of Copenhagen, 2200 Copenhagen, Denmark

*To whom correspondence should be addressed.
Associate Editor: John Hancock

Received on June 23, 2015; revised on August 6, 2015; accepted on August 24, 2015

Abstract

Motivation: Pairwise relatedness estimation is important in many contexts such as disease
mapping and population genetics. However, all existing estimation methods are based on called
genotypes, which is not ideal for next-generation sequencing (NGS) data of low depth from which

genotypes cannot be called with high certainty.

Results: We present a software tool, NgsRelate, for estimating pairwise relatedness from NGS
data. It provides maximum likelihood estimates that are based on genotype likelihoods instead of
genotypes and thereby takes the inherent uncertainty of the genotypes into account. Using both
simulated and real data, we show that NgsRelate provides markedly better estimates for low-depth
NGS data than two state-of—the-art genotype-based methods.

Availability: NgsRelate is implemented in C++ and is available under the GNU license at www.pop

gen.dk/software.
Contact: ida@binf.ku.dk

Supplementary information: Supplementary data are available at Bioinformatics online.

 

1 Introduction

Estimation of how related two individuals are from genetic data
plays a key role in several research areas, including medical genetics
and population genetics. For example, in medical genetics it is used
for excluding closely related individuals from association studies
and thereby to avoid inﬂated false positive rates. How related two
individuals are is usually described through the concept of identity-
by-descent (IBD), i.e. genetic identity due to a recent common ances-
tor. Historically, several summary statistics have been used, such as
the kinship coefficient 0, however almost all of these statistics can be
calculated from R = (180,181,182), where km is the fraction of genome
in which the two individuals share m alleles IBD. For example
0 = 1% + [272. We will therefore here focus on R.

Many estimators for R have been proposed, both method of mo-
ments (Purcell et al., 2007; Ritland, 1996) and maximum likelihood
(ML) estimators (Thompson, 1975). Common to them all is that
they are based on genotype data and it has been shown that they
work well on single nucleotide polymorphism (SNP) chip data.

©The Author 2015. Published by Oxford University Press.

However, next-generation sequencing (NGS) is becoming increas-
ingly common and often NGS data are only of low depth, which
means that genotypes can only be called with high uncertainty
(O’Rawe et al., 2015). For such data it has been shown that it can
be an advantage to take the uncertainty of the genotypes into ac-
count by basing statistical methods on so-called genotype likeli-
hoods (GLs), instead of genotypes (Skotte et al., 2013). Motivated
by this we developed NgsRelate; a ML method for estimating the
pairwise relatedness parameter R from NGS data based on GLs. In
the following, we present this method and show that for low-depth
NGS data it performs markedly better than two state-of—the-art
genotype-based methods.

2 Methods

To estimate R for two non-inbred individuals 2' and i we use the fol-
lowing probabilistic' framework: Let Di=(D"1,D§,  ,Di) and
Di 2 (D71,D’2, . . . ,D’L) denote the observed NGS data for i and j at
L diallelic loci and Gi=(G"1,G§,  ,GiL) and Gi=(G’1,G’2,  ,

4009

This is an Open Access article distributed under the terms of the Creative Commons Attribution License (http://creativecommons.org/licenses/by/4.0/), which permits
unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.

112 [3.10811211an[plOJXO'SODBIILIOJIIlOlQ/ﬂ(11111 wort popcorn/hog

910K ‘09 lsnﬁnV no :2

4010

T.S.Korneliussen and I.Moltke

 

 denote the true unobserved genotypes at the L loci. Further, let
X16 {0,1,2} denote the unobserved number of alleles i and 7'
share IBD at locus 1. Finally, let the two alleles at each locus be
denoted A and a and the frequencies of the A alleles be denoted
f4: (ff‘,ff‘,  ,ff‘). Then, assuming the loci are independent and
that f"X is known the likelihood function for R, can be written:

L
L(R|D17Dlva) = H E  = mvflA)P(Xl = 
[=1 m€{0,1,2}

with P(Xl = m|R) 2 km and
 = maflA)

= Z P(D§|G1)P(Dl|Gl)P(G1IIGA)P(Gl|ﬁA,X1=m,G1)
G;',G§e{0,1,2}2

Here P(D;|G;) and P(D’l'|G’l') are GLs, which can be estimated
using ANGSD (Korneliussen et al., 2014) and P(Gf|flA) and
P(G’,|f‘lA,Xl=m, are given in Supplementary Table S1—52. ["4
and major and minor alleles can be precalculated from NGS data
using ANGSD or from SNP chip data. NgsRelate provides ML
estimates of R by finding the value of R that maximizes this likeli-
hood function with an Expectation Maximization algorithm
(Supplementary Data). Like all other ML estimators, this estimator
is consistent and we note that this is also true if the assumption of in-
dependence between loci is violated, since the function that is opti-
mized then becomes a composite likelihood function. We also note
that if the genotypes are known with certainty the GLs will be 0 for
all but the true genotype and in that case the method reduces to the
ML method in Choi et al. (2009). In all other cases the uncertainty
is taken into account by summing over all possible true genotypes
and weighing each according to their GLs.

3 Results and discussion

To test NgsRelate we used both simulated and real data. We first
simulated NGS data for 100 000 diallelic loci from 100 pairs of indi-
viduals from each of the relationships: parent—child, full siblings,
half-siblings, first cousins and unrelated individuals. To make it pos-
sible to assess how NgsRelate’s performance depends on average
sequencing depth we simulated such data for five different average
depths ranging from low (1, 2 and 4X) over medium (8X) to rela-
tively high depth (16 X ). From the simulated data we calculated GLs,
which we applied NgsRelate to. We also called genotypes based on
the maximum GLs and applied the genotype-based ML method
from Choi et al. (2009) and PLINK (Purcell et al., 2007) to these
called genotypes. See Supplementary Data for details. The simula-
tions showed that all three methods perform well on high-depth
data, but that the two genotype-based methods did not provide ac-
curate estimates of R for the related pairs based on low- and me-
dium-depth data (Fig. 1). Further inspection of the results revealed
that for all the related pairs these two methods tend to overestimate
[co and thereby make the pairs look less related (Supplementary Figs
51—55 ). NgsRelate on the other hand performs well on medium and
low-depth data down to 4X (Fig. 1). Even for 2>< data it is only
slightly biased (Supplementary Figs 51—55) and for 1>< it has large
variance, yet it still performs markedly better than the other two
methods (Fig. 1). Hence, the simulations suggest that for low-depth
NGS data NgsRelate outperforms the two genotype-based methods.

To assess if this holds true for real data we then applied the three
methods to low-depth (~4><) NGS data from six genomes from the
1000 Genomes Project Consortium (2012). These individuals have

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

Parent—child Full siblings
0.9 - 0.9 -
'¥' +
0 6 ? 0 6 -
n n * —
(I) (I)
E E
n: n: _._ --
-I- -1-
0.3 - 0.3 -
. 3 '1'
T *T- T 1 -I-
00-9 é & ..-. uni-"‘- 00-5 g I:- i‘ -'- A3—
1 x 2x 4x 8x 1 6x 1x 2x 4x 8x 1 6x
Half siblings First cousins
0.9 - 0.9 -
0.6 - 0.6 -
D D
(D (I)
a — 4 - a
_ -o-
0.3 - 0.3 -
-I- +— ..."' —
l i .1 i- e
' 8 i : B
0.0-5 % i- J- ‘- é—E 0.0-; % ;- ﬁ-i " i;
1x 2x 4x 8x 16x 1x 2x 4x 8x 16x
Average depth Average depth

Fig. 1. Root mean square deviation (RMSD) between estimated and simulated
R for 100 of each combination of four relationship types and five average
sequencing depths 1, 2, 4, 8 and 16 (see Supplementary Fig. 85 for results for
unrelated pairs). For each combination estimates were obtained with
NgsRelate (left), genotype-based ML (middle) and PLINK (right). RMSD will
be zero if the estimate is equal to the simulated R

 

 

 

 

 

 

Real data
0'4' O NgsRelate
<> Genotype based ML
121 PLINK
as
0
n O D U n
g 0.2
m D O
m- a] D 0
0
O O
0.0 - O o 0 0
233 5%3 22$ 9%? 8%g 85E
  Vl'ﬁ': VV'E (GOO: FIG")—
220 22° 22= 22o 22= 22%
<<é <<é <<% <<§ <<% <<8
22“, 22a, 22= 225 zz..__ 22v
5 a .2 v m
e e V 5

Fig. 2. RMSD between the estimated and the true R for six pairs of ~4>< gen-
omes. RMSD will be 0 if the estimate is equal to the true R

also been SNP chip genotyped (International HapMap 3 Consortium,
2010), and six of the pairs have been reported to be related. We
applied NgsRelate to GLs calculated from the low-depth NGS data
using ANGSD and applied the two other methods to genotypes called
from these GLs. To limit the amount of genotype calling errors only
data from sites with depth above 2 in both genomes and a minor allele
frequency above 0.05 were included in the genotype-based analyses.
Next, we estimated R from the high-quality SNP chip genotypes using
a state-of—the-art genotype-based method to achieve accurate estimates
of R, which we used as a proxy for the true values when assessing the
NGS data-based estimates. For all six-related pairs the estimates from
NgsRelate differed markedly less from the ‘true’ values (Fig. 2 and
Supplementary Fig. S6), e.g. the difference in k0 ranged from 0.002 to
0.031 for NGSrelate, whereas they ranged from 0.081 to 0.31 for
genotype-based ML estimator and from 0.096 to 0.25 for PLINK. In
all cases kg was overestimated, though, note that the opposite was
observed for PLINK when we changed the quality filtering of the geno-
types (Supplementary Data), suggesting that estimates from the

112 ﬁhO'sIeumo[pJOJXO'sopeuuogurorq/ﬁdnq wort popcorn/hog

910K ‘09 lsnﬁnV no :2

NgsRelate

4011

 

genotype-based methods depend highly on filtering choices. However,
all the real data results supported the conclusion from the simulations:
for low-depth NGS data NgsRelate provides more accurate estimates.

Funding

TSK was funded by the Danish National Research Foundation (DNRF94),
and IM was funded by the Danish Council for Independent Research (DFF-
YDUN).

Conﬂict of Interest: none declared.

References

1000 Genomes Project Consortium. (2012) An integrated map of genetic vari-
ation from 1 092 human genomes. Nature, 491, 5 6—65 .

Choi,Y. et al. (2009) Case-control association testing in the presence of un-
known relationships. Genet. Epidemiol., 33, 668—678.

International HapMap 3 Consortium. (2010) Integrating common and rare
genetic variation in diverse human populations. Nature, 467, 52—5 8.

Korneliussen,T.S. et al. (2014) ANGSD: analysis of next generation sequenc-
ing data. BMC Bioinformatics, 15, 356.

O’Rawe,].A. et al. (2015) Accounting for uncertainty in DNA sequencing
data. Trends Genet., 31, 61—66.

Purcell,S. et al. (2007) PLINK: a toolset for whole-genome association and
population-based linkage analysis. Am. ]. Hum. Genet., 81, 559—75.

Ritland,K. (1996) Estimators for pairwise relatedness and individual inbreed-
ing coefﬁcients. Genet. Res., 67, 175—185.

Skotte,L. et al. (2013) Estimating individual admixture proportions from next
generation sequencing data. Genetics, 195, 693—702.

Thompson,E.A. (1975) The estimation of pairwise relationships. Ann. Hum.
Genet., 39(2), 173—188.

112 ﬁrosleumo[pJOJXO'soriemJOJurorw/2dnq wort pepeolumoq

910K ‘09 lsnﬁnV no 22

