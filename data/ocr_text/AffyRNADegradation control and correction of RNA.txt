APPLICATIONS NOTE

Vol. 29 no. 1 2013, pages 129—131
doi: 10. 1093/bioinformatics/bts629

 

Gene expression

Advance Access publication October 24, 2012

AffyRNADegradation: control and correction of RNA quality
effects in GeneChip expression data

Mario Fasold1’2’* and Hans Binder1 ’2

1Interdisciplinary Center for Bioinformatics, Universitat Leipzig, D—4107 Leipzig, Haertelstr. 16—18, Germany and 2Leipzig
Research Center for Civilization Diseases, Universitat Leipzig, Leipzig, Germany

Associate Editor: lvo Hofacker

 

ABSTRACT

Motivation: Gene expression experiments aim to accurately quantify
thousands of transcripts in parallel. Factors posterior to RNA extrac-
tion can, however, impair their accurate representation. RNA degrad-
ation and differences in the efficiency of amplification affect raw
intensity measurements using Affymetrix expression arrays. The pos-
itional intensity decay of specifically hybridized probes along the tran-
script they intend to interrogate is used to estimate the RNA quality in
a sample and to correct probe intensities for the degradation bias. This
functionality, for which no previous software solution is available, is
implemented in the R/Bioconductor package AffyRNADegradation
presented here.

Availability: The package is available via Bioconductor at the URL
http://bioconductor.org/packages/release/bioc/html/AfiyRNA
Degradation.html

Contact: Fasold@izbi.uni—Leipzig.de

Supplementary information: Supplementary data are available at
Bioinformatics online.

Received on July 27, 2012; revised on September 26, 2012; accepted
on October 16, 2012

1 INTRODUCTION

A basic assumption in gene expression experiments is that the ob-
tained data represent a snapshot of transcript abundances within
the original sample. However, several effects can distort the
amount of RNA during sample extraction and preparation, and
thereby impair the reliability of those measurements. RNases
introduced by improper puriﬁcation or incautious sample hand-
ling can degrade the rather unstable RNAs during storage (F leige
and Pfafﬁ, 2006). Also, the ampliﬁcation of RNA mandatory to
most RNA analytics differs in its efﬁciency and can therefore lead
to variation in transcript yield and lengths (Ma et al., 2006).

Gene expression experiments are frequently conducted using
high-density microarrays. Because of the importance of RNA
quality for the reliability of the results, it is advised to check
the integrity of the RNA before hybridization to the array.
RNA integrity (RIN) values (Schroeder et al., 2006) that are
determined on the basis of an electropherogram trace have
become the standard measure of RNA quality. Samples with
RIN values >7 should be discarded.

Researchers increasingly conduct large-scale meta-analysis on
the plethora of publicly available microarray data. For these data,

 

*To whom correspondence should be addressed.

RNA quality measures are mostly not available. However, it is
strongly advised to identify and to remove low RNA-quality ex-
periments, as they can lead to erroneous results. Methods to esti-
mate RNA quality directly from microarray data are thus required.
Existing options are the use of 3’ / 5’ intensity ratios of control probe
sets included on the microarray, as well as 3’ / 5’ -summary degrad-
ation measures as provided by software tools such as the affy
package (Gautier et al., 2004). Both methods have been shown to
have drawbacks under circumstances that are relevant in
large-scale studies (Fasold and Binder, 2012). Particularly, 3’ /5’
control probes might be affected by saturation, whereas affyslope
estimates are affected by background hybridization. Both methods
are prone to systematically overestimating RNA quality.

Beyond strict quality control and the removal of bad-quality
samples, the continuous levels of RNA quality transform into a
gray area of biased expression results with questionable reliabil-
ity. It has been previously found that, although moderate levels
of RNA degradation are tolerated by differential expression ana-
lysis, especially long targets provide erroneous results.

In this work, we present an R package that assesses RNA
quality of Affymetrix expression data. It provides a RNA quality
measure that overcomes the drawbacks of existing methods by
strictly referring to speciﬁc hybridization. Furthermore, it en-
ables correction of the 3’ probe intensity bias for improved down-
stream analysis.

F or illustration, we here use data from an experiment done by
Archer et al. (2006) where the same cell extract has been used for
multiple microarray hybridizations, however, either prepared
with RNeasy to remove RNA degrading enzymes, or not.

2 FUNCTIONALITY

On Affymetrix 3’, expression arrays up to 16 probes of length
25 nt interrogate each transcript. Most of these probes cover a
speciﬁc region located within 600 nt distance to the 3’ end of the
transcripts. RNA samples are usually prepared using an in vitro
transcription labeling and ampliﬁcation assay with primers start-
ing at the 3’ poly-A tail of the source mRNA. Both degradation of
mRNA as well as effectiveness of the ampliﬁcation assay are thus
captured by multiple probe measurements for each transcript.

2.1 Analyzing RNA degradation and ampliﬁcation

Limited RNA quality of a given sample leads to intensity differ-
ences between probes located at the 3’ end and those located
closer toward the 5’ end of the mRNA. The so-called

 

© The Author 2012. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com
This is an Open Access article distributed under the terms of the Creative Commons Attribution License (http://creativecommons.org/licenses/by/3.0/), which
permits non-commercial reuse, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact

joumals.permissions@oup.com.

112 ﬂJO'slcumo[pJOJXO'sopchogutotq/ﬁd11q IIIOJJ popcolumoq

910K ‘09 lsnﬁnV no :2

M.Fasold and H.Binder

 

 

 

   
 
   
 

 

{a} degradation hunk [ha‘lurn mmcﬁﬁn} [b] degradation hunk {after correction} [:5] intensity decay
cu
‘ ‘ I I good RNA duality I gdud RNA duality -' T I good RNA quaim'
; _ no 3 I5 gradient I had RNA quality  — I had Rhlhmaliiy 3 _ 1 had RNA quellin-
formn-speciﬁc E :5 :19»... '
a bind' e - ‘:‘c a-
E m mg E 4'1 g “*1 I. L." "- 4
e e— _._ E .i— a a.  “nu
E g 3'15'ialas remved after 3 5-, # ah ‘ -...H_"L
*5 N '13 ﬂ correcliun ElffﬁWlIl‘l'U-DE E “' t4 ‘1-1-..
3' 1:5 ‘  :1 " intensitie5 ‘E ce ,4 ~ I _ '
E '= '5 9 " *-
2 E a ‘  a -
 "j IImDI‘CI-IJE about 611% IBSE ——-—"""'
E _ unmasked 315 gradient 3 d E g _. intense than 19‘ one on average
for specific binding

 

 

 

 

 

 

 

 

I I I I I I
2.13 2.5 H.B- El.5 2.0 2.5

expression degree

expression UBQTEE

 

I: | 1 1 1 1 I
an 3.5 E 4 E E I'D

probe index it

Fig. 1. Degradation hook plots referring to strongly and weakly degraded RNA taken from Archer et al. (2006) before [panel (a)] and after [panel 01)]
correction using Af fyRNADegr adat ion. The height of the hook curve increases with increasing degradation level. Panel (c) shows the respective probe
positional decays d(x) as plotted by the AffyRNADegradation package: the worse the RNA quality, the steeper is the respective decay

degradation hook-plot, shown in Figure la and b, displays this
3’ / 5’ intensity difference in dependence on the mean logged probe
intensity approximating the expression degree of the respective
gene. Cross-hybridization of partly matching targets of other
genes causes nearly equal intensities for weakly expressed genes
(Binder, 2006). With increasing expression competitive binding
of speciﬁc targets progressively unmasks their actual 3’ / 5’ gradi-
ent, until probe saturation sets in. Desirable would be equal
intensities for 3’ and 5’ probes for all expression levels. The max-
imum height of the hook-plot reﬂects the relevant 3’ / 5’ -intensity
gradient of the selected array enabling the unbiased comparison
of differentially expressed genes under variable RNA quality.

The hook-plot is accessible using the P1 otDegradation
Hook function in the package. A complementary representation
is the Tongs Plot shown in the Supplementary Material and ac-
cessible using the PlotTongs function.

2.2 Estimation of the RNA quality of a sample

One should only use speciﬁcally hybridized probes for estimation
of RNA quality because of the 3’ / 5’ gradient of the intensity as a
function of the expression degree. For these probes, we compute
the mean probe intensity separately for each probe index
k: l. . .11 starting from the 3’ end of the target transcript.
Figure 10 shows the resulting probe positional intensity decay
after normalization with respect to the mean intensity for the ﬁrst
probe k = 1. Alternatively, the intensity decay can be calculated
as a function of the distance L of the probes given in units of
nucleotides from the 3’ -transcript end (not shown).

We determine the decay-length parameter d from the mean
intensity decays of all speciﬁcally hybridized probes. It provides
an accurate estimate for the RNA quality of a particular array
hybridization improving other array-based metrices (F asold and
Binder, 2012). The d(x=k,L) plot is available via the P10th
function, and the RNA quality estimate is available via the 61
function in the AffyRNADegradation package.

2.3 Correcting the RNA quality bias

Differences in RNA quality and the resulting probe positional
intensity decay are technical artifacts that can affect expression
measures and the results of differential expression analysis.

Microarray experiments are often subject to such RNA quality
variation (Upton et al., 2009).

We here aim at removing the systematic differences in probe
positional intensities between different conditions. Figure la
shows two such conditions in the example data relating to
degraded transcripts due to increased presence of RNases not
removed by RNeasy treatment. AffyRNADegradation ﬁrst
estimates speciﬁc probes based on the degradation hook-plot
described above. It then uses a correction function that reverses
the probe positional intensity decay d(x) after applying the ex-
pression level dependency of the hybridization mode (details are
given in the Supplementary Material). Optionally, the correction
can be performed based on probe indices k as well as probe
distances L. Differences between both options are discussed in
the Supplementary Material and in (F asold and Binder, 2012).
Figure lb shows the degradation hook after correction using
probe indices k: The 3’ /5’ bias is almost completely removed.
Corrected probe intensities are available via the afbatch
function.

2.4 Package usability

The Af f yRNADegradati on package extends the Bioconductor
package a f f y and integrates well in a typical microarray analysis
workﬁow. All calculations are performed directly on the
AffyBatch object and carried out separately for each particular
microarray hybridization in a single-chip approach. Our approach
corrects the 3’ / 5’ -bias on the level of raw probe intensities, which
can afterward be processed with any method. The runtime is about
2min and 3 min per sample for index and distance based correc-
tions, respectively. Because each chip is processed independently,
arbitrarily large data sets can be processed.

ACKNOWLEDGEMENTS

This publication is supported by LIFE—Leipzig Research
Center for Civilization Diseases, Universitat Leipzig.

Funding: This project was funded by means of the European
Social Fund and the Free State of Saxony.

Conﬂict of Interest: none declared.

 

130

112 [glO'SIBILInO[plOJXO'SODBIILIOJHTOTQ/[ldllq IIIOJJ popcolumoq

910K ‘09 lsnﬁnV no :2

AffyRNADegradation

 

REFERENCES

Archer,K.J. et a]. (2006) Assessing quality of hybridized RNA in Affymetrix
GeneChip experiments using mixed-effects models. Biostatistics, 7, 198—212.
Binder,H. (2006) Thermodynamics of competitive surface adsorption on DNA

microarrays—theoretical aspects. J. Phys. Cond. Mat, 18, S49 l—S523.
Fasold,M. and Binder,H. (2012) Estimating RNA-quality using GeneChip micro-
arrays. BMC Genomics, 13, 186.
Fleige,S. and Pfafﬂ,M.W. (2006) RNA integrity and the effect on the real-time
qRT-PCR performance. M01. Aspects Med., 27, 126—139.

Gautier,L. et a]. (2004) affy-Analysis of Affymetrix GeneChip data at the probe
level. Bioinformatics, 20, 307—315.

Ma,C. et a]. (2006) In vitro transcription ampliﬁcation and labeling methods
contribute to the variability of gene expression proﬁling with DNA microarrays.
J. Mol. Diagn, 8, 183—192.

Schroeder,A. et a]. (2006) The RIN: an RNA integrity number for assigning integ-
rity values to RNA measurements. BM C M01. Biol., 7, 3.

Upton,G.J. et a]. (2009) On the causes of outliers in Affymetrix GeneChip data.
Brief. Funct. Genomic. Proteomic., 8, 199—212.

 

131

112 /810's112umo[pJOJXO'sot112u1101u101q/ﬁd11q 111011 popcolumoq

910K ‘09 lsnﬁnV no 22

