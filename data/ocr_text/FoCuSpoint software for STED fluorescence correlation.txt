Bioinformatics, 32(6), 2016, 958—960

doi: 10.1093/bioinformatics/btv687

Advance Access Publication Date: 20 November 2015
Applications Note

 

Bioimage informatics

FoCuS-point: software for STED fluorescence
correlation and time-gated single photon
counﬁng

Dominic Waithe1'*, Mathias P. Clausenz, Erdinc Sezgin2
and Christian Eggeling1'2

1Wolfson Imaging Centre and 2MRC Human Immunology Unit, Weatherall Institute of Molecular Medicine,
University of Oxford, Headley Way, Oxford, 0X3 9DS, UK

*To whom correspondence should be addressed.
Associate Editor: Robert Murphy

Received on September 1, 2015; revised on November 6, 2015; accepted on November 14, 2015

Abstract

Motivation: Fluorescence Correlation Spectroscopy (FCS) is a popular tool for measuring molecular
mobility and how mobility relates to molecular interaction dynamics and bioactivity in living cells.
The FCS technique has been significantly advanced by its combination with super—resolution
STED microscopy (STED—FCS). Specifically, the use of gated detection has shown great potential
for enhancing STED—FCS, but has also created a demand for software which is efficient and also
implements the latest algorithms. Prior to this study, no open software has been available which
would allow practical time—gating and correlation of point data derived from STED—FCS experiments.
Results: The product of this study is a piece of stand—alone software called FoCuS—point. FoCuS—
point utilizes advanced time—correlated single—photon counting (TCSPC) correlation algorithms
along with time—gated filtering and innovative data visualization. The software has been designed
to be highly user—friendly and is tailored to handle batches of data with tools designed to process
files in bulk. FoCuS—point also includes advanced fitting algorithms which allow the parameters of
the correlation curves and thus the kinetics of diffusion to be established quickly and efficiently.
Availability and implementation: FoCuS—point is written in python and is available through the
github repository: https://github.com/dwaithe/FCS_point_correlator. Furthermore, compiled versions
of the code are available as executables which can be run directly in Linux, Windows and Mac OSX
operating systems.

Contact: dominic.waithe@imm.ox.ac.uk

 

1 Introduction

 

Fluorescence Correlation Spectroscopy (FCS) is a well established stat—
istical technique for characterizing diffusion and kinetics of ﬂuores—
cently labelled molecules in solution (Ehrenberg and Rigler, 1974;
Magde et 61]., 1972). Through the advent of confocal microscopes,
which allow detection to within small femtoliter volumes, it was
then possible to apply FCS techniques to study kinetics of a broad
range of biological molecules at the surface or within the cytoplasm of
biological cells. (Schwille et 61]., 1999; Widengren and Rigler, 1998).
More recently, super—resolution techniques have opened up a new vista

©The Author 2015. Published by Oxford University Press.

in biological imaging, and one of these techniques known as
STimulated Emission Depletion (STED) microscopy (Hell and
Wichmann, 1994) has been combined with FCS to study diffusion of
molecules below the diffraction limit of light (Kastrup et 61]., 2005).
Truly capable of studying membranes at the nanoscale <200 nm, the
application of STED-FCS to biological imaging has illuminated the kin-
etics of proteins and lipids whose mechanisms have until now remained
elusive (Eggeling et 61]., 2009). Until recently, the STED—FCS technique
has only been applied to study a few select mechanisms due to the tech—
nically demanding and specialist nature of the STED—FCS acquisition

958

This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (http://creativecommons.org/Iicenses/by-nc/4.0/),
which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact

journals.permissions@oup.com

112 /§JO'S{eumo [p.IOJXO'SOTlBIHJOJUTOTCI/ﬁdllq 11101; popeoIII/vxoq

9IOZ ‘09 lsnﬁnv uo ::

FOCUS-point

 

systems. Commercial systems are now available which are both reliable
and have the sensitivity required to perform STED—FCS on cells
(Clausen et al., 2015). The use of continuous wave (CW) STED lasers
which, although highly functional and suitable for deployment in com—
mercial systems, has the caveat that the output ﬂuorescence is contami—
nated with a non—negligible amount of light derived from outside the
confined effective ﬂuorescence observation volume. Fortunately, this
artefact can be removed through employing a time-gating filtering
scheme (Moffitt et al., 2011; Vicidomini et al., 2011; 2015). Time—gat—
ing is a technique made possible through Time—Correlated Single
Photon Counting (TCSPC) and allows individual photons to be filtered
based on their arrival times at the detector. Time—gating of TCSPC data
generated during STED laser illumination allows photons which are
derived from outside the confined effective ﬂuorescence observation to
be filtered out, restoring the effective observation volume size when
using CW lasers. Furthermore, TCSPC derived data is rich in informa-
tion and many of its properties can be utilized for characterization of
the system under investigation, such as ﬂuorescence lifetime informa-
tion (Enderlein and Gregor, 2005).

Given the recent availability of commercial STED microscopes
and applicability of FCS techniques for studying biological systems
there is a real demand for software solutions which can harness the
power of these techniques in a way which is user—friendly and prac-
tical. Some generalizable software solutions do exist which enable
robust and practical analysis of FCS data from a variety of source
microscopes (Muller et al., 2014; Wachsmuth et al., 2015), but no
software solution yet exists which allow full utilization of STED-
FCS derived data. FoCuS—point is a tool which successfully addresses
the requirements of STED—FCS and uniquely facilitates the applica—
tion of this technique in the field of cell biology.

2 Implementation

FoCuS—point is a compiled application written in python and makes
use of the lmfit, numpy and matplotlib python libraries. When a file is
processed using FoCuS—point, auto—correlation is performed on each in-
put channel and cross—correlation is additionally performed in the case
of two—channel data. FoCuS—point was intially designed to work with
‘.pt3’ files which are the output format from PicoQuant PicoHarp
hardware, however correlation and time—gating can be applied to any
file which contains TCSPC time—tag data if it is correctly parsed. In
addition, FoCuS—point can also take already processed data in a variety
of different formats. Correlation is a numerically intensive discipline
and so algorithms have evolved which can efficiently perform this com-
putation. For FoCuS—point an existing advanced correlation algorithm
known as the Time—tag—to—correlation algorithm was implemented
(Wahl et al., 2003) and was adapted to include normalization and to
run efficiently in a python environment. From the TCSPC time—tag
data, collected during an experiment, it is possible to visualize photons
based on their macro and micro—scopic arrival times. Macro—scopic ar—
rival times represent the arrival time of the photons from the beginning
of the experiment, visualized as a time—series plot. Conversely, the
micro—scopic arrival scheme represents the photon collection times sub—
sequent to each pulse of the excitation laser. Micro—scopic arrival times
for a population of photons are visualized as a life—time decay profile
(Fig. 1A). Time-gating involves specifying a specific temporal window
[tg1, tgz] on the micro time—scale and excluding from the subsequent
analysis those photons which were outside of the gates. This process is
performed in FoCuS—point by the user selecting the temporal window
interactively, before applying the selected time—gate to a single file or
multiple files and then correlating. FoCuS—point features a dedicated
interface for the fitting of correlation functions which encompasses 2D

 

 

  

 

959

h 1&4  _ T '

1' ml -:
f5: ‘5  0.3
E 3 i g :16
E 3 i K) E [1'4 "'-?e~--.;..
E 2 ( I i a U2 whim 
Z 1 . . “Fl-1......

. _._ _... __ __  .::'_ . .:..._. .  
D o 100 200 3m we hit2 It!" 10"
time channele =Elﬂfﬁ n5} tau (ms)

Fig. 1. (A) The fluorescence lifetime decay (blue line) is generated by the
histogram over the micro-scopic arrival times of the detected photons (ns
time scale), and a time gate is selected (green). (B) FCS data is calculated
from the selected time-gated window and fitted by a selected model (green
line), here compared to the FCS data generated from all (ungated) photons
(blue line) indicating a decrease in decay (and thus transit time) as well as in-
crease in amplitude upon gating, as expected (Clausen et al., 2015;
Vicidomini et al., 2011)

and 3D diffusion, anomalous factor and also triplet states (Fig. 1B).
Average transit times through the effective observation volume (and
diffusion coefficients if diameters of the volume are supplied) as well as
other parameters such as average particle numbers in the observation
volume or anomaly factors in diffusion characteristics are extracted
from FCS data through fitting of auto and cross—correlation functions.
The user interface facility also encompasses data visualization using
histogram and scatter plots for comparing parameters across large data
collections. FoCuS—point facilitates data export through button—click
copying to the clipboard and also the option of saving to a. csv file
the fit parameters and correlated data. For further reference material
relating to the software and the algorithms which it employs see the
website: https://github.com/dwaithe/FCS_point_correlator.

3 Conclusion

FoCuS—point represents a computationally efficient user-friendly
and easily deployable means of analyzing (gated) STED-FCS point
source data.

Funding

Alfred Benzon Foundation, Medical Research Council (grant ref
MC_UU_12010/unit programmes G0902418 and MC_UU_12025), MRC/
BBSRC/EPSRC (grant ref MR/K01577)Ul), Wolfson Foundation and
Wellcome Trust (grant ref 104924/ 14/Z/ 14).

Conﬂict of Interest: none declared.

References

Clausen,M.P. et al. (2015) A straightforward approach for gated sted-fcs to in-
vestigate lipid membrane dynamics. Methods, 88, 67—75.

Eggeling,C. et al. (2009) Direct observation of the nanoscale dynamics of
membrane lipids in a living cell. Nature, 457, 1 159—1 162.

Ehrenberg,M. and Rigler,R. (1974) Rotational Brownian motion and ﬂuores-
cence intensify ﬂuctuations. Chem. Phys, 4, 390—401.

Enderlein,]. and Gregor,I. (2005) Using ﬂuorescence lifetime for discriminat-
ing detector afterpulsing in ﬂuorescence-correlation spectroscopy. Rev. Sci.
Instrum., 76, 033102.

Hell,S.W. and Wichmann,]. (1994) Breaking the diffraction resolution limit
by stimulated emission: stimulated-emission-depletion ﬂuorescence micros-
copy. Opt. Lett., 19, 780—782.

Kastrup,L. et al. (2005 ) Fluorescence ﬂuctuation spectroscopy in subdiffrac-
tion focal volumes. Phys. Rev. Lett., 94, 178104.

112 /§JO'S{eumo [p.IOJXO'SOTlBIHJOJUTOTCI/ﬁdllq 11101; popeoIII/vxoq

9IOZ ‘09 lsnﬁnv uo ::

960

D. Waithe et al.

 

Magde,D. et al. (1972) Thermodynamic ﬂuctuations in a reacting system—
measurement by ﬂuorescence correlation spectroscopy. Phys. Rev. Lett., 29, 705.

Mofﬁtt,].R. et al. (2011) Time-gating improves the spatial resolution of sted
microscopy. Opt. Express, 19, 4242—4254.

Mﬁller,P. et al. (2014) Pycorrﬁt—generic data evaluation for ﬂuorescence cor-
relation spectroscopy. Bioinformatics, btu328.

Schwille,P. et al. (1999) Fluorescence correlation spectroscopy with sin-
gle-molecule sensitivity on cell and model membranes. Cytometry, 36,
176—182.

Vicidomini,G. et al. (201 1) Sharper low-power sted nanoscopy by time gating.
Nat. Methods, 8, 571—573.

Vicidomini,G. et al. (2015) Sted-ﬂcs: An advanced tool to reveal spatiotemporal
heterogeneity of molecular membrane dynamics. Nano Lett., 15, 5 912—5918.

Wachsmuth,M. et al. (2015 ) High-throughput ﬂuorescence correlation spec-
troscopy enables analysis of proteome dynamics in living cells. Nat.
Biotechnol, 33, 384—389.

Wahl,M. et al. (2003) Fast calculation of ﬂuorescence correlation data with
asynchronous time-correlated single-photon counting. Opt. Express, 11,
35 83—35 91.

Widengren,]. and Rigler,R. (1998) Fluorescence correlation spectroscopy as a
tool to investigate chemical reactions in solutions and on cell surfaces. Cell.
Mol. Biol. (Noisy—le—Grand, France), 44, 857—879.

112 /810'sreumo [p.IOJXO'SOTlBIHJOJUTOTCI/ﬁdllq 11101; popeoIII/vxoq

9IOZ ‘09 lsnﬁnv uo ::

