Motivation: In many situations, genome wide association studies are performed in populations presenting stratification. Mixed models including a kinship matrix accounting for genetic relatedness among individuals have been shown to correct for population and or family structure. Here we extend this methodology to generalized linear mixed models which properly model data under various distributions. In addition we perform association with ancestral haplotypes inferred using a hidden Markov model. Results: The method was shown to properly account for stratification under various simulated scenari presenting population and or family structure. Use of ancestral haplotypes resulted in higher power than SNPs on simulated datasets. Application to real data demonstrates the usefulness of the developed model. Full analysis of a dataset with 4600 individuals and 500 000 SNPs was performed in 2 h 36 min and required 2.28 Gb of RAM. Availability: The software glasco w can be freely downloaded from

introduction genome wide association studies gw ass identify genetic variants (e.g. SNPs, CNV or indels) affecting traits of interest such as those related to human health or of agronomic al importance. With the development of high throughput genotyping and next generation sequencing, these studies have been particularly successful. Hundreds of loci associated with diseases were detected through g was (e.g.). Association studies proved equally valuable in other organisms such as Arabidopsis thaliana (), mice (), dog, crops () or livestock species. Although very effective, genetic association studies still face a number of potential pitfalls. One major problem in g was comes from the spurious associations that may occur as a result of relatedness between individuals (e.g. familial relationships or population structure). Another issue is that, especially for complex traits, non genetic factors (e.g. sex, age, etc.) may have profound impact on the scrutinized phenotype, raising the need for proper modeling of these effects. An appealing solution to these problems is to use a mixed model framework. Indeed, this methodology makes it possible to include covariates in the model and to account for the average genomic relatedness among individuals (population or family structure). Such models have been used for many years for QTL mapping especially in animal breeding (). Recent studies () have demonstrated that inclusion of such effects in mixed models properly corrects for stratification and that the use of mixed models to control for stratification resulted in fewer false positives and or higher power than other techniques such as genomic control (), structured association () or principal components analysis (). In addition, mixed models were able to capture the multiple levels of population structure and genetic relatedness. All these features make mixed models a very promising tool to perform association analyses while controlling for relatedness structure. Linear mixed models l mms assume that traits are normally distributed. Use of generalized linear mixed models gl mms allows extension of the mixed model approach to other types of traits, such as binary traits for example. With these models, a linear function of different covariates including polygenic and local genomic effects is used to describe the expected value of the observed phenotype through a so called link function. Tzeng and Zhang (2007) developed a variance components score test for association studies which can be used in the gl mm framework. Analyses can be performed using single SNP or haplotypes of multiple SNPs. Haplotypes are specific combinations of alleles on the same chromosome. They extract more information on the relation between DNA variation and phenotypes than single SNPs and may present higher correlation with underlying mutations [depending on the marker density and the linkage disequilibrium (LD) pattern in the population]. Furthermore, haplotype tests can model allelic heterogeneity or find several (interacting) mutations at different tightly linked sites. However, the power of haplotype based tests is potentially reduced due to the extra *To whom correspondence should be addressed.
