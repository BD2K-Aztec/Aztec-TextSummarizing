Motivation: In recent years, there has been an increasing interest in using common single nucleotide polymorphisms (SNPs) amassed in genome wide association studies to investigate rare haplotype effects on complex diseases. Evidence has suggested that rare haplotypes may tag rare causal single nucleotide variants, making snp based rare haplotype analysis not only cost effective, but also more valuable for detecting causal variants. Although a number of methods for detecting rare haplotype association have been proposed in recent years, they are population based and thus susceptible to population stratification. Results: We propose family triad based logistic Bayesian Lasso fam lbl for estimating effects of haplotypes on complex diseases using SNP data. By choosing appropriate prior distribution, effect sizes of unassociated haplotypes can be shrunk toward zero, allowing for more precise estimation of associated haplotypes, especially those that are rare, thereby achieving greater detection power. We evaluate fam lbl using simulation to gauge its type I error and power. Compared with its population counterpart, LBL, highlights fa mlb ls robustness property in the presence of population substructure. Further investigation by comparing fam lbl with family based Association Test fb at reveals its advantage for detecting rare haplotype association. Availability and implementation: fam lbl is implemented as an R

introduction genome wide association studies g was have identified 41500 common variants that are associated with common diseases with genome wide significance. However, g was failed to explain a majority of the heritability, and hence, it is hypothesized that rare single nucleotide variants rsn vs which can not be detected by g was platforms, are responsible for at least part of the missing heritability (). With the next generation sequencing (NGS) technology, it becomes possible to investigate the role of rsn vs. However, the extremely low frequencies and high dimensionality render the tests developed for g was powerless when applied to rare variants. Numerous methods aiming at detecting rsn vs for case control studies have been developed in recent years. One class of tests, 'burden tests', focus on aggregating rare variants and then using the collapsed super variant for the test. Tests of this category include the combined multivariate and collapsing method () and the weighted sum method (). Collapsing multiple variants into a single variant can indeed effectively reduce the dimension of the data and increase the frequency of the super variant however, power can be diminished when the rare variants being collapsed are of opposite effects on the trait of interest. Other tests, like c alpha (), Sequence Kernel Association Test (SKAT) () and a hierarchical modeling approach (), are more powerful if there exist different directionality and variability in the coefficients of the regression parameters. Most of the methods proposed thus far can only detect regions of interests. To identify the combination of causal variants responsible for the disease, it is advantageous to investigate haplotypes within each region. While association between common haplotypes and diseases is well studied in g was those methods typically fail to detect individual effects of rare haplotypes. Traditionally, rare haplotypes are either ignored, combined into a super variant or grouped with common haplotypes of similar sequence variation. Such a practice is clearly deficient, as causal rare haplotypes can result from common single nucleotide polymorphisms (SNPs) (). Further, rare haplotypes that are disease associated may tag rsn vs that are causal (), and can even lead to greater power for detecting association (Supplementary Tables S1 and S2 and). To remedy this situation so that rare haplotypes can be investigated proposed a LASSO regularization of logistic regression model for case control data that effectively combat the problem of non convergence of the EM algorithm due to estimation instability. Although methods are available for selecting optimal penalty parameters for lasso type regularization methods, they are typically computationally intensive. Moreover, uncertainty resulted from setting the tuning parameters is hard to be investigated and be accounted for. To avoid the need for specifying tuning parameters proposed a Bayesian model in which Laplace distribution is used as prior distribution for effect size, effectively shrinking the coefficient toward zero. This approach also allows for testing individual haplotype effects and constructing confidence intervals for effect sizes. Further, in their model, a retrospective likelihood is used, which is more appropriate than a prospective formulation for case control data given the data collection process. *To whom correspondence should be addressed It has been argued recently that linkage peaks detected by family based methods can potentially be caused by rare variants (), and that using family data can avoid heterogeneity and be more fruitful for detecting such rare variant association (). Further, family based design should provide an increase in power compared with population based designs for rare variants, as such variants are enriched in a family if it does exist (). Most importantly, family based design will not be affected by population stratification, whereas case control design may see an increase in type I error rate if left unadjusted. The stage is therefore set for detecting associated rare (and common) haplotypes using family data. Commonly used family based methods for detecting common haplotypes such as fb at () may suffer from loss of power if used for detection of rare haplotypes, because the estimated variance of rare haplotype effects could be large. Recent extension of fb at does provide a way to analyze rsn vs by collapsing and optionally weighting each variant (), but the method is not amenable to haplotypes. In this article, we propose a family based method aiming to detect both rare and common haplotype associations using common SNP data on case parent trios. Our retrospective likelihood correctly reflects the ascertainment procedure, and its factorization resembles a match pair design as we will see in Section 2. To shrink the coefficients of unassociated haplotypes so that the effects of rare associated haplotypes can be more precisely estimated to increase the statistical power of detection, we adopted the Logistic Bayesian Lasso (LBL) methodology for parameter estimation and statistical inference (), leading to the fam lbl algorithm. The proposed fam lbl method is thoroughly investigated to gauge its power and type I error rate. We also compare fam lbl with LBL and fb at in terms of robustness to population stratification and effectiveness in detecting rare haplotype association. Finally, we apply fam lbl to the Framingham Heart Study (FHS) data to illustrate its utility.
