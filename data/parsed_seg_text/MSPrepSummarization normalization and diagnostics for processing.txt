Motivation: Although R packages exist for the pre-processing of meta bolo mic data, they currently do not incorporate additional analysis steps of summarization, filtering and normalization of aligned data. We developed the ms prep R package to complement other packages by providing these additional steps, implementing a selection of popular normalization algorithms and generating diagnostics to help guide investigators in their analyses. Availability: http://www.sourceforge.net/projects/msprep

introduction the primary goal of the ms prep package is to prepare metabolomics data for advanced statistical analysis by automating the processing of datasets and generating diagnostic graphs. The initial processing of Liquid Chromatography coupled with Mass Spectrometry (LCMS) data is covered by a variety of software packages provided by instrument manufacturers and a number of open source packages such as xms analyzer (), x cms () and mz mine (). While these manage the initial data pre-processing steps of peak detection, chromatogram building, alignment and quantification, they often lack functions for further processing. We designed the ms prep package to complement existing software by providing additional processing tools and statistical and graphical tools for evaluation of different methods. As there are no universally accepted procedures, the package provides implementation of a variety of novel and previously published methods. The primary functions of the ms prep package are summarization of replicates, filtering, imputation of missing data, normalization and or batch effect adjustment and dataset diagnostics.

conclusion the ms prep package is designed to help investigators prepare their datasets for analysis, while reducing the amount of manual processing of datasets and generating useful diagnostic aids. Our package complements existing pre-processing methods such as xms analyzer (), and the output is in a format ready for input to leading software such as metabo analyst () to perform clustering and other downstream analyses. The SVA routine provided the best performance when applied to the dataset presented, but it is important to note the strengths and weaknesses of each routine, and, in our experience, no single method is best in all circumstances. We encourage users to examine the diagnostic plots generated by the package to compare different methods for their datasets.
