Pyrosequencing of 16S rDNA is widely used to study microbial communities, and a rich set of software tools support this analysis. Pyrosequencing of protein coding genes, which can help elucidate functional differences among microbial communities, significantly lags behind 16S rDNA in availability of sequence analysis software. In both settings, frequent homopolymer read errors inflate the estimation of microbial diversity, and de-noising is required to reduce that bias. Here we describe fun frame an r based data analysis pipeline that uses recently described algorithms to de noise functional gene pyro sequences and performs ecological analysis on de noised sequence data. The novelty of this pipeline is that it provides users a unified set of tools, adapted from disparate sources and designed for different applications, that can be used to examine a particular protein coding gene of interest. We evaluated fun frame on functional genes from four pcr amplified clones with sequence depths ranging from 9084 to 14 494 sequences. fun frame produced from one to nine Operational tax anomic Units for each clone, resulting in an error rate ranging from 0 to 0.18%. Importantly, fun frame reduced spurious diversity while retaining more sequences than a commonly used de-noising method that discards sequences with frameshift errors. Availability: Software, documentation and a complete set of sample data files are available at

introduction pyrosequencing of 16S rDNA is commonly used to study microbial community structure, and existing bioinformatics pipelines are primarily designed for the analysis of 16S rDNA (). Noise from DNA sequencing errors upwardly biases the estimates of microbial diversity (). Substantial progress has been made to remove noise artifacts from 16S rDNA sequence datasets (). Targeted meta genomics of protein coding genes offers the possibility of focusing on the diversity, abundance and expression of specific genes, particularly those genes that encode enzymes critical to biogeochemical cycling. protein coding sequences fundamentally differ from non-coding 16S rDNA in that the genetic code implicitly constrains the sequences to the 61 amino coding triplets. This distinction is particularly relevant with pyrosequencing, as the technology is prone to misread the lengths of long homopolymers, thereby creating the appearance of frameshift mutations. To reduce the inflated diversity bias with protein coding genes, a commonly used approach discards sequences containing unexpected stop codons (). A more nuanced error detection algorithm, hmm frame was recently introduced (). In hmm frame a hidden Markov model (HMM) of the target protein, combined with a probabilistic model of homopolymer errors, detects and corrects the frame shifts caused by homopolymer read errors. In addition, the algorithm reports HMM alignment scores, which can be used in downstream quality filtering. To facilitate targeted meta genomics using pcr amplified protein coding genes, we produced fun frame a complete bioinformatics pipeline that uses hmm frame followed by chimera detection, Operational tax anomic Unit (OTU) clustering, rarefaction and diversity estimation (Supplementary). Additionally, fun frame performs clustering and ordination using uni frac and bray curtis metrics (Supplementary Figs S2 and S3). Contrasting with the 16S rDNA pipelines q ii me () and mo thur (), fun frame centers around the R Project for Statistical Computing (R Core), which facilitates analysis with a rich set of ecological, statistical and visualization tools ().
