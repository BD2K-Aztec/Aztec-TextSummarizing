Motivation: Genetic variation in cis regulatory elements is an important cause of variation in gene expression. cis regulatory variation can be detected by using high throughput RNA sequencing rnase q to identify differences in the expression of the two alleles of a gene. This requires that reads from the two alleles are equally likely to map to a reference genome(s), and that single nucleotide polymorphisms (SNPs) are accurately called, so that reads derived from the different alleles can be identified. Both of these prerequisites can be achieved by sequencing the genomes of the parents of the individual being studied, but this is often prohibitively costly. Results: In Drosophila, we demonstrate that biases during read mapping can be avoided by mapping reads to two alternative genomes that incorporate SNPs called from the rnase q data. The SNPs can be reliably called from the rnase q data itself, provided any variants not found in high quality SNP databases are filtered out. Finally, we suggest a way of measuring allele specific expression (ASE) by crossing the line of interest to a reference line with a high quality genome sequence. Combined with our bioinformatic methods, this approach minimizes mapping biases, allows poor quality data to be identified and removed and aides in the biological interpretation of the data as the parent of origin of each allele is known. In conclusion, our results suggest that accurate estimates of ASE do not require the parental genomes of the individual being studied to be sequenced. Availability and implementation: Scripts used to perform our analysis are available at https://github.com/d-quinn/bio_quinn2013.

introduction recently high throughput RNA sequencing rnase q in which a library of millions of short cDNA fragments are sequenced in parallel, has emerged as the preferred method for genome wide studies of gene expression (). Gene expression polymorphism is the result of differences in either cis or trans regulatory elements. As trans regulatory changes affect the expression of both alleles equally, the role of cis regulatory variation can be determined by examining differences in expression between alleles, termed allele specific expression (ASE) (). Detection of ASE from rnase q data involves mapping sequence reads to their region of origin and assigning them to separate alleles. Both of these steps are non-trivial and in need of further development. Reads can be mapped to a single reference genome; however, this method is inherently biased (). Reads representing reference alleles are more likely to map correctly than those representing non reference alleles because they contain fewer mismatches, yielding estimates of ASE that favor the reference ().illustrated this problem by generating a simulated human rnase q dataset that contained an equal number of reference and non reference reads. The authors found that reads carrying the single nucleotide polymorphism (SNP) allele found in the reference genome were significantly more likely to be mapped. Increasing the error rate in the sequence reads increases the bias by introducing additional mismatches to the reference genome (). In both humans and Drosophila, the degree of bias is unequal across genes (), with loci containing clusters of SNPs showing a strong bias toward the reference sequence. Therefore, even if the average bias across all genes toward mapping reads matching the reference genome is just a few percent, individual loci may have far greater biases (). The importance of clusters of SNPs also means that the problem is expected to be greater in species like Drosophila melanogaster that have a far greater density of SNPs than humans (). One way in which researchers have attempted to overcome the bias is by aligning reads separately to maternal and paternal genomes () or to transcriptome s (). These methods are effective, but are not useful in cases in which parental genotypes can not be readily or cost effectively obtained (). Another strategy involves aligning reads to a reference genome supplemented with all possible haplotypes within one read length (). Again, this technique has been shown to reduce the reference bias; however, it is impractical for use in systems that contain many polymorphisms, as the number of haplotypes increases exponentially with the number of polymorphic sites (). This problem can be reduced by phasing the data using population genetic data, provided that genotypes are available from multiple individuals (). A third solution has been proposed by, in which analysis of ASE is restricted to genomic regions with fewer differentiating *To whom correspondence should be addressed. sites than the number of mismatches allowed. This solution is not ideal, however, as it requires one to discard useful data, ultimately decreasing statistical power. Finally, altering the alignment parameters can reduce the bias but does not eliminate it, while a comparison of different alignment software packages revealed little difference among them (). Once reads have been mapped to the reference sequence, they are assigned to separate alleles and counted. This can be accomplished by identifying SNPs between alleles. Unfortunately, SNP calls from rnase q data are not reliable because of the fact that there is no a priori expectation regarding read frequencies for each SNP allele, as there is when sequencing genomic DNA from a diploid individual (). Therefore, it is unclear whether unequal frequencies of reads from the two alleles are because of strong ASE or an incorrect SNP call. Furthermore, RNA editing can alter the sequence of RNA after transcription, and these changes can be mistaken for SNPs (). Accurate SNP calls are important for obtaining reliable estimates of ASE because errors in SNP calling, like mapping errors, will introduce bias toward one allele. Thus, SNPs are typically called from genomic data (). Although this method is generally effective, there are situations in which one would want to determine ASE without the extra time and cost associated with acquiring genomic sequences. Here we present a protocol for obtaining accurate ASE estimates in d melanogaster which involves creating an alternate reference sequence featuring SNPs called directly from an rnase q dataset after filtering out SNPs not observed in a high quality SNP database. Our methodology is advantageous in that it only requires a single reference sequence, can be used in systems that contain many polymorphisms and does not involve discarding data based on the number of mismatches in a region.

conclusion we have developed a protocol for obtaining accurate per snp and per gene estimates of ASE from rnase q data. The main advantage of this protocol is that it does not require parental genomic sequences; SNPs used to get allele counts are called directly from the rnase q data. This can significantly reduce the time and cost associated with measuring ASE. Unexpectedly, it does not appear that phased data are required for getting unbiased per snp measures of ASE using our datasets. We found that our estimates were nearly the same with and without phasing. However, phased data are required for combining SNPs to obtain per gene measures of ASE, and this also allows us to remove unreliable reads and SNPs. We show that the data can be phased if genotype of interest is crossed to the homozygous strain used to generate the reference genome, although this will only be possible in Drosophila and other model organisms. The main drawback to our method is that it requires knowledge of variation in the population of the organism of study, as this allows filtering to remove SNP calling errors. In Drosophila this data is readily available. As new sequencing technologies mean that comprehensive SNP databases are available from increasing numbers of species, this approach will become viable in even more species, especially those with short generations.
