k top Scoring Pairs k tsp is a classification method for prediction from high throughput data based on a set of the paired measurements. Each of the two possible orderings of a pair of measurements (e.g. a reversal in the expression of two genes) is associated with one of two classes. The k tsp prediction rule is the aggregation of voting among such individual two feature decision rules based on order switching. k tsp like its predecessor, Top Scoring Pair (TSP), is a parameter free classifier relying only on ranking of a small subset of features, rendering it robust to noise and potentially easy to interpret in biological terms. In contrast to TSP, k tsp has comparable accuracy to standard genomics classification techniques, including Support Vector Machines and Prediction Analysis for Microarrays. Here, we describe switchBox, an R package for k tsp based prediction. Availability: The switchBox package is freely available from Bioconductor: http://www.bioconductor.org.

introduction finding omics based biomarkers for clinical use has been extensively studied in numerous diseases. However, mature clinical applications of these biomarkers are scarce due to technological, mathematical and translational barriers (). Basing the prediction solely on the ordering of a small number of features (e.g. gene expression ranks within profiles) may overcome such barriers to clinical translation (). rank based classifiers are robust to data normalization and yield transparent decision rules (). The first and simplest of these rank based methods, the Top Scoring Pair (TSP) classifier, in which the decision rule is entirely determined by the ordering of two features (i.e. the relative expression of two genes), was introduced in. Multiple extensions to TSP were proposed eg and some have been successfully applied to human cancer such as simplifying clinical biomarkers (). A theoretical analysis, R implementation and description of the TSP algorithm can be found in http://hal.archives-ouvertes.fr/docs/00/78/48/69/PDF/Article.pdf), Leek (2009) and Leek (2014), respectively. One powerful successor of TSP is k top Scoring Pairs k tsp which applies majority voting among multiple pairs of features. k tsp has outperformed Support Vector Machines in an open challenge for cancer classification () and yielded comparable accuracy to the mamma print breast cancer assay (). Here, we introduce an R package, 'switchBox', for k tsp. This package selects the gene pairs for the k tsp decision rule. The package also implements a new approach to choose the number of pairs, k, based on the analysis of variance introduced in, which is less computationally intensive and less prone to overfitting than the original method introduced in and implemented in the R kts pair package (). In addition, 'switchBox' provides more flexibility in the selection of candidate ranges of k, as well as alternative strategies for pair votes aggregation compared with the previous R implementation (). Finally, 'switchBox' has a method for calculating sample specific scores based on the pairs (see Methods), which can be extended beyond classification to class discovery problems where I is the logical indicator function. The k tsp classification decision is based on thresholding , i.e. ^ Y=If4g provided the labels Y 2 f0; 1g. The standard threshold is = k 2 , equivalent to majority voting. The only parameters required for calculating are the number and choice of feature pairs. In the introductory paper to TSP (), the authors proposed a score for each pair of features, which measures the discriminative power of a two feature comparison. The score assigned to genes i and j was defined as s ij =jP X i 5X j jY=1  P X i 5X j jY=0j:

conclusion we introduced 'switchBox', an R package for k tsp classifier with a robust procedure for pair selection as previously described in, the procedure requires less computation and is less prone to overfitting than the one described in and implemented in kts pair package (). Moreover, we provide functions for calculating auxiliary statistics as well as any user defined combination of the comparisons.. The comparisons votes (y-axis) versus samples x axis. The samples are labeled either good prognosis or bad prognosis for breast cancer. Truth and falsehood of the comparisons are indicated by blue (lighter shade) and red (darker shade), respectively. The combination of the votes can be used to classify, illustrated by requiring at least three votes for declaring bad prognosis. More explanation and code for this figure can be found in the Supplementary Document
