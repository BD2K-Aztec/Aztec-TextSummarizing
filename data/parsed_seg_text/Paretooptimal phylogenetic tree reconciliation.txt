Motivation: Phylogenetic tree reconciliation is a widely used method for reconstructing the evolutionary histories of gene families and species , hosts and parasites and other dependent pairs of entities. Reconciliation is typically performed using maximum parsimony, in which each evolutionary event type is assigned a cost and the objective is to find a reconciliation of minimum total cost. It is generally understood that reconciliations are sensitive to event costs, but little is understood about the relationship between event costs and solutions. Moreover, choosing appropriate event costs is a notoriously difficult problem. Results: We address this problem by giving an efficient algorithm for computing pareto optimal sets of reconciliations, thus providing the first systematic method for understanding the relationship between event costs and reconciliations. This, in turn, results in new techniques for computing event support values and, for co phylogenetic analyses, performing robust statistical tests. We provide new software tools and demonstrate their use on a number of datasets from evolutionary gen-omic and co phylogenetic studies.

introduction phylogenetic tree reconciliation is a fundamental technique for studying the evolution of pairs of entities such as gene families and species, parasites and hosts and species and geographical regions. Recent algorithmic advances in tree reconciliation have led to seminal biological discoveries. Among these are the finding that 426% of extant gene families arose during the Archaean period between 3.33 and 2.85 billion years ago (), a study showing that interactions of species and their ecological niches are strongly conserved across the entire tree of life (G), and new insights into the relationship between pathogenic RNA viruses and their hosts (). The reconciliation problem takes as input two trees and the associations between their leaves and seeks a mapping of one tree onto the other such that incongruence between the two trees is accounted for by a set of evolutionary events. In the context of gene family evolution, the two trees are the gene tree and the species tree, and in the well studied duplication transfer loss model (DTL), the events are speciation, duplication, transfer and loss. Unlike the simpler duplication loss (DL) reconciliation model (), DTL accounts for transfer events and is thus broadly applicable across the tree of life. In the context of parasites and their hosts, the corresponding events are co speciation independent speciation, host switch and loss, respectively. In the context of species and area cladograms, these four events correspond to vicari ance sympatric speciation, dispersal and loss, respectively (). Henceforth, we refer to this set of events as the DTL model and use the DTL event names. dtl reconciliation is generally performed in a maximum parsimony framework in which each event type has an associated user defined cost and the objective is to find a reconciliation of minimum total cost. Probabilistic approaches for DTL reconciliation, which do not require event cost assignments, also exist (), but these require estimates of other parameters, such as species divergence times, and are prohibitively slow for trees with more than a few leaves. If the species trees are fully dated, then maximum parsimony reconciliations can be found in polynomial time (). However, accurately dating the internal nodes of a phylogenetic tree is generally difficult (). In the absence of dates, reconciliations may be time inconsistent in the sense that they can induce contradictory constraints on the relative order of the internal nodes. The problem of finding optimal time consistent dtl reconciliations in undated trees is known to be np hard (). Therefore, a common approach, and the one followed in this article, is to relax the time consistency requirement (), which permits an optimal (although not necessarily time consistent solution to be found in O(mn) time (), where m and n denote the number of nodes in the gene (parasite) and species (host) trees, respectively. Experimental evidence suggests that the solutions found using this approach are generally time consistent (); but see also. Maximum parsimony reconciliations depend on the event costs. In the DTL model, speciation s are considered 'null events' and are therefore typically assigned a cost of 0 while duplications, transfers and losses are assigned positive costs shows a species (host) tree in black and a gene (parasite) tree in gray along with associations between their leaves. If duplication, transfer and loss each cost 1, then the reconciliation in is optimal, comprises one speciation and one transfer and has total cost 1. However, if duplication and loss cost 1 and transfer costs 5, then the maximum parsimony reconciliation in is optimal, comprises one speciation, one duplication and three losses and has total cost 4. Even small differences in event costs *To whom correspondence should be addressed.  The Author 2014. Published by Oxford University Press. This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (http://creativecommons.org/licenses/by/3.0/), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals permission soup com. can induce different solutions when the trees are larger. For example, we have found that in many datasets, the default costs used in TreeMap () and Jane () give rise to different reconciliations than those using the default costs in AnGST () and ranger dtl (). Despite great advances in the efficiency and accuracy of dtl reconciliation little is understood about the relationship between event costs and the resulting maximum parsimony reconciliations. A systematic way to handle the difficulty in determining appropriate event costs is to optimize for event counts rather than total numerical cost. We define an event count vector for a reconciliation to be a triple h; ; 'i, denoting the number of duplications, transfers and losses, respectively. These vectors do not explicitly count the number of speciation events because the number of speciation s is implicit (it is m    1). An event count vector v=h; ; 'i is strictly better than an event count vector v 0 =h 0 ; 0 ; ' 0 i if each entry of v is less than or equal to the corresponding entry in v 0 and at least one entry of v is less than its corresponding entry in v 0. A reconciliation is pareto optimal if there is no reconciliation with a strictly better event count vector. We use the term pareto optimal for both reconciliations and their corresponding event count vectors. Given the set of all pareto optimal event count vectors, we can partition the space of possible event cost assignments into equivalence classes, or 'regions', such that any two event cost assignments within the same region lead to the same optimal reconciliations. These regions provide insights into the relationships between event costs and maximum parsimony reconciliations and have numerous applications, including new definitions and algorithms for computing event consensus support.
