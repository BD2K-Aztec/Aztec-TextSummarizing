Motivation: The imperfect sequence data produced by next generation sequencing technologies have motivated the development of a number of short read error correctors in recent years. The majority of methods focus on the correction of substitution errors, which are the dominant error source in data produced by Illumina sequencing technology. Existing tools either score high in terms of recall or precision but not consistently high in terms of both measures. Results: In this article, we present Musket, an efficient multistage km er based correct or for Illumina short read data. We use the km er spectrum approach and introduce three correction techniques in a multistage workflow: two sided conservative correction, one sided aggressive correction and voting based refinement. Our performance evaluation results, in terms of correction quality and de novo genome assembly measures, reveal that Musket is consistently one of the top performing correctors. In addition, Musket is multi-threaded using a master slave model and demonstrates superior parallel scalability compared with all other evaluated correctors as well as a highly competitive overall execution time. Availability: Musket is available at http://musket.

introduction the emergence and rapid progress of next generation sequencing (NGS) technologies has enabled the high throughput production of short DNA sequences (reads) at low cost. The ever increasing throughput and decreasing cost has significantly altered the landscape of whole genome sequencing, providing an opportunity for scientists to initiate whole genome sequencing projects for almost any organism, including those whose genomes span billions of base pairs, such as the giant panda () and humans (). Many NGS sequencing technologies have been developed, among which Illumina is most widely used. However, reads produced from NGS platforms are never perfect and can contain various types of sequencing errors, including substitutions and indels (insertions or deletions). These sequencing errors complicate data processing for many biological applications such as de novo genome assembly () and short read mapping (). To improve data quality, one frequently used approach is to trim reads from the more error prone 3 0 ends, which unfortunately results in loss of information (). This has ignited the interest of researchers in conceiving more sophisticated algorithms to detect and correct sequencing errors in NGS data, for example, Schroder. As substitution is the dominant error type for data produced by Illumina sequencing technology, most approaches focus on correcting this type of errors (). The core of substitution error based methods is to compute consensus bases using the highly redundant coverage information. When a sequencing error occurs in a read that originated from a certain position on the genome, all reads covering the erroneous position could be piled up to compute the consensus base. Considering that sequencing errors are generally random and infrequent, this consensus base is likely to be correct. However, as we assume that the source genome is unknown beforehand, we can neither determine the read locations on the genome nor the correctness of reads directly. Instead, reads that cover overlapping genomic positions can be inferred by assuming that they typically share common substrings. Furthermore, we can approximate the source genome using a km er spectrum, which was first introduced by. Given a dataset with sufficient coverage of a genome, the km er spectrum is defined as the set of all km ers in the dataset, where the km ers whose multiplicity exceeds a coverage cut off are deemed to be trusted and otherwise, untrusted. The first km er spectrum based correct or was proposed by, using an iterative spectral alignment problem approach. cuda ec () and dec gpu () accelerated this spectral alignment problem approach using graphics processing unit computing. To further improve correcting quality introduced a dynamic programming approach that corrects errors by minimizing edit distances. The SOAP correct or () adopted a similar approach. Quake () introduced a probabilistic model derived from base quality scores of reads. For a km er Quake accumulates the correctness probability of all its occurrences and defines this sum as the multiplicity of the km er instead of just the number of occurrences. Reptile () relies on a Hamming graph to resolve ambiguities for a tile based correction, whereas Hammer () combines the Hamming graph with a probabilistic model to deal with datasets with non-uniform coverage. HiTEC () supports multiple km er sizes in a single launch *To whom correspondence should be addressed. and relies on witness clusters that are constructed from suffix arrays. SGA () uses a memory efficient Burrows Wheeler transform () and an fm index () to represent the km er spectrum. In addition to km er spectrum based approaches, some correctors based on other techniques have been developed. sh rec () uses a generalized suffix trie to detect and correct substitution errors, which is further extended by Hybrid sh rec () to additionally correct indels. Coral () and ECHO () are two correctors that use the concept of multiple sequence alignment, using km ers as seeds. Coral corrects errors by constructing consensus sequences from multiple alignments, and ECHO by computing consensus bases using a maximum a posterior estimate over position specific substitution matrices. In this article, we present Musket (multistage km er spectrum based correct or an efficient substitution error based correct or for Illumina sequence data based on a km er spectrum approach (). We introduce three techniques, namely, two sided conservative correction, one sided aggressive correction and voting based refinement, to form a multistage correction workflow. The performance of Musket is evaluated using both simulated and real datasets for short read data originating from small sized (Escherichia coli), medium sized (human chromosome 21) and large sized (human chromosome 1) genomes. In terms of correction quality, Musket is consistently one of the top performing correctors compared with HiTEC, SGA, sh rec Coral, Quake, Reptile and dec gpu. In terms of de novo genome assembly using the SGA assembler (), Musket yields better performance than all other evaluated correctors with respect to some commonly used metrics. In addition, Musket provides support for multithreading using a master slave model and demonstrates superior scalability on a shared memory multi cpu workstation, as well as highly competitive overall execution speed.

discussion we have presented Musket, an efficient substitution error based error correct or for short DNA reads produced by Illumina sequencing technology. This reference free error correct or uses the km er spectrum approach and aims at correcting as many errors as possible while introducing few new errors. Three correction techniques, including two sided conservative correction, one sided aggressive correction and voting based refinement, have been introduced to form a multistage correction workflow. We have assessed the performance of Musket in comparison with several established error correctors: HiTEC, SGA, sh rec Coral, Quake, Reptile and dec gpu. The assessment is conducted using both simulated and real reads in terms of correction quality and de novo genome assembly measures. In terms of correction quality, Musket is consistently one of the top performing correctors for reads simulated from the small sized E.coli genome as well as large sized human chromosomes. The best performance of Musket is obtained using simulated reads from the human chromosomes, which suggests that Musket can perform well on genomic sequences with complex repeat structures. In terms of de novo genome assembly, Musket is superior to all other evaluated correctors in terms of the following metrics: N50 contig size, error corrected N50 contig size, number of contig errors and genome coverage. Through this study, we have found that pre assembly error correction does not always guarantee to yield better assembly quality in terms of all metrics, but have demonstrated the capability of improving contig conti gui ties and reducing mis assemblies. Besides de novo genome assembly, short read error correctors can also be used before short read alignment. As many state of the art short read aligners tolerate multiple sequencing errors in the full read length, substitution error based error correctors might not be able to make significant impact on the improvement of alignment performance. Hence, the use of Musket might be more valuable before de novo genome assembly than short read alignment. In addition, Musket uses multi-threading, based on a master slave model, to leverage the compute power of common shared memory multi cpu platforms. This approach results in superior parallel scalability compared with all other evaluated correctors in terms of the number of CPU threads as well as in overall execution time. All existing standalone correctors target haploid genome sequencing ().showed that error correction can benefit single nucleotide polymorphism calling in haploid genomes. However, the effect of error correction on diploid genomes has not been explored yet. A heterozygous site results in a percentage of km ers supporting alternative alleles. In a moderate or high coverage dataset, we would expect these km ers to be within the distribution of trusted km ers. However, this might not be the case when the coverage is low or allelic distribution is imbalanced. In such cases, diploid single nucleotide polymorphisms could be lost as a result of false positive corrections. Up to date, almost all correctors based on km er spectrum use a single coverage cut off to differentiate trusted km ers from the untrusted ones. This static coverage cut off ignores the confidence difference in the correctness of bases that is represented as base quality scores in NGS reads. Hence, a dynamic coverage cut off as in Coral (Salmela and schroder schroder 2011) might be advantageous to further improve correction quality of correctors based on km er spectrums. A possible solution might be the use of a position specific cut off matrix derived from base quality scores for a single read. Conflicts of Interest: none declared.
