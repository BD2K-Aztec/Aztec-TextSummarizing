Motivation: time course gene expression datasets provide important insights into dynamic aspects of biological processes, such as circadian rhythms, cell cycle and organ development. In a typical microarray time course experiment, measurements are obtained at each time point from multiple replicate samples. Accurately recovering the gene expression patterns from experimental observations is made challenging by both measurement noise and variation among replicates rates of development. Prior work on this topic has focused on inference of expression patterns assuming that the replicate times are synchronized. We develop a statistical approach that simultaneously infers both (i) the underlying (hidden) expression profile for each gene, as well as (ii) the biological time for each individual replicate. Our approach is based on Gaussian process regression (GPR) combined with a probabilistic model that accounts for uncertainty about the biological development time of each replicate. Results: We apply GPR with uncertain measurement times to a microarray dataset of mRNA expression for the hair growth cycle in mouse back skin, predicting both profile shapes and biological times for each replicate. The predicted time shifts show high consistency with independently obtained morphological estimates of relative development. We also show that the method systematically reduces prediction error on out of sample data, significantly reducing the mean squared error in a cross validation study. Availability: Matlab code for GPR with uncertain time shifts is available at

introduction a typical microarray time course expression dataset consists of measurements taken at a relatively small number of time points (e.g. 5 to 10), where at each time point microarray measurements are obtained on a small number (e.g. 3) of replicate samples. There has been considerable work in recent years in bioinformatics on the development of statistical techniques for accurately inferring expression profiles from such data, in the face of both measurement noise and biological variation across replicates (). In this article, we focus on a different source of variation that has received little attention to date, namely uncertainty about the precise biological time at which measurements were taken. We are specifically interested in the case where replicates that were measured at the same time point are in fact developing at different rates and correspond to different developmental times. The general intuition we pursue is that even though the underlying true expression profiles for each gene are masked by considerable noise, we can nonetheless infer time shifts for each replicate by analyzing all genes simultaneously. As a motivating example, in this article, we use a time series dataset of mRNA expression for the hair growth cycle in the mouse, with microarray measurements for 6333 hair cycle related genes from 2 or 3 replicates at each of 9 time points, resulting in a total of 24 individual mice (); see. Hair follicles grow in repeated cycles, each of which can be coarsely broken down into three phases: anagen, ca tagen and telogen. These cycles have been well characterized morphologically, but are understood in completely at the molecular level. time course microarray data have been shown to be useful for automated, reliable identification of hair cycle associated genes (). However, in addition to the usual measurement noise, a significant source of variability arises from the fact that each sample in the time course is taken from a different individual, or replicate, and since each replicate develops at a slightly different rate, we can never obtain truly synchronous time points. From morphological observation, we find that after a few weeks, replicates which are of the same age (time since birth) may differ in the stage of hair follicle development by as much as 23 days. If the expression profile is changing rapidly over time, these developmental differences can result in major discrepancies among the replicates' observations, leading to poor estimates of the underlying expression patterns. Moreover, if the time interval between successive samples is relatively small, it is even possible for two replicates measured at successive time points to be in reverse order, i.e. the replicate measured at the later time point may be less developed than the earlier measurement illustrates this point with images from two pairs of replicates at. Histological sections from the back skin of mice taken at different number of days since birth. 23-2 indicates a mouse that is 23 days old, and second in the set of replicates. The darker (somewhat vertically oriented) parts of the image correspond to hair follicles. For the pair of images in each row, the younger mouse (left image) appears to be developmentally ahead of the older mouse (right image), i.e. the mice have reversed orders of morphological development with respect to calender time. (a) and (b) show that 25-1 (which is in the Anagen I stage) is at an earlier stage (less follicle development) than 23-2 (in Anagen I/II). (c) and (d) show that the follicles in 39-3 (which is in the ca tagen I/II stage) are less regressed (i.e. are less developed) compared with 37-2 (in ca tagen iii ii. successive time points. If the estimated profiles are disturbed by such desynchronization, analysis tasks, such as estimating the underlying expression profiles and identifying periodically expressed genes, become more inherently difficult. These desynchronization effects have been previously discussed but not addressed in a systematic manner in existing literature (). For datasets measuring multiple modalities (transcriptome and proteome, for example) or relatively short transient responses, we may expect timing and de syncronization effects to be more pronounced and methods of coping with these effects may become critical to analysis. In this article, we describe a Gaussian process regression (GPR) approach that explicitly models desynchronization effects among replicates. GPR is a Bayesian non-linear regression technique, and has been previously applied in several contexts in bioinformatics (). Rather than specifying predetermined shapes or other parametric assumptions, such as linear or polynomial regression, GPR is a semi-parametric method that uses the data themselves to represent the function, smoothed by an assumed covariance structure. Since we have little if any prior knowledge to determine what expression patterns to expect for different genes, it is reasonable to use GPR to automatically discover the shapes. We note in passing that our general approach for modeling desynchronization among replicates should be generally applicable to other statistical profile modeling methods such as splines (e.g.). To consider replicate desynchronization, we assume that each replicate has an 'ideal' physiological age, and that the expression profile viewed with respect to the physiological age is shared across replicates. The observed age is then the ideal physiological age plus a time shift due to developmental drift. We model the time shift using a Gaussian prior, and use a maximum a posteriori (MAP) approach to estimate the time shifts and expression patterns simultaneously. We evaluate our method using the aforementioned hair cycle dataset, comparing our predicted time shifts with morphological observations, and also using cross validation to measure the predictive accuracy of the model. Our experiments indicate that the time-shift estimates from our model both agree with independent morphological evidence and provide more accurate prediction of expression profiles for out of sample replicates and genes. Our approach should be generally useful for reducing uncertainty and improving the quality of inferred profiles for time course microarray data, as well as more specific tasks such as analysis of differential expression in time course data (). Our method is substantially different from work on 'aligning' time course datasets using techniques, such as dynamic time warping algorithms (), continuous time modeling of expression data by b splines () and discriminative hidden Markov models (). Those approaches focus on finding an optimal matching between two sequences by aligning the time points, provided that there are enough time points for matching to occur. Such methods, however, are not directly applicable to situations where each replicate is measured at only one time point, as in the aforementioned hair cycle dataset. In contrast, the methodology we propose in this article can be applied whether each replicate is observed at a single time or at many. Like any method of estimating expression profiles, we assume that the signals are sufficiently smooth to be estimated from the measurements. Furthermore, we assume that at least some signals are smooth compared with the temporal uncertainty, to allow the direction and magnitude of shifts to be estimated. Finally, we also assume that all genes are affected jointly by the time shift, which could be violated if some genes are influenced by external timing effects; in theory the model could be extended to include such effects. Our method is most similar to the general framework of total least squares (TLS) or error in variables (EIV) modeling in regression (), which minimizes the weighted sum of errors on both dependent and independent variables; our model can be viewed as a Gaussian process (GP) version of TLS or EIV.
