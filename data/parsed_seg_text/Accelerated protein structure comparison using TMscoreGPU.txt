Motivation: Accurate comparisons of different protein structures play important roles in structural biology, structure prediction and functional annotation. The root mean square deviation (RMSD) after optimal superposition is the predominant measure of similarity due to the ease and speed of computation. However, global RMSD is dependent on the length of the protein and can be dominated by divergent loops that can obscure local regions of similarity. A more sophisticated measure of structure similarity, Template Modeling tm score avoids these problems, and it is one of the measures used by the community wide experiments of critical assessment of protein structure prediction to compare predicted models with experimental structures. tm score calculations are, however, much slower than RMSD calculations. We have therefore implemented a very fast version of tm score for Graphical Processing Units tm score gpu using a new and novel hybrid kab sch quaternion method for calculating the optimal superposition and RMSD that is designed for parallel applications. This acceleration in speed allows tm score to be used efficiently in computationally intensive applications such as for clustering of protein models and genome wide comparisons of structure. Results: tm score gpu was applied to six sets of models from Nutritious Rice for the World for a total of 3 million comparisons. tm score gpu is 68 times faster on an ATI 5870 GPU, on average, than the original CPU single threaded implementation on an AMD Phenom II 810 quad core processor. Availability and implementation: The complete source, including the GPU code and the hybrid RMSD subroutine, can be downloaded and used without restriction at

introduction for protein structure comparisons, the simplest method is to calculate a transformation that superimposes corresponding atoms from one structure onto a second structure and minimizes the root mean square deviation (RMSD) between the coordinates of the superimposed structures. This can be obtained from the single value decomposition of the covariance matrix () or from the solution of the eigenvalue equation of a quaternion * To whom correspondence should be addressed. derived matrix (). Although RMSD is a fast and easily calculated metric of structural similarity, a globally optimal transformation that minimizes the distances between all superimposed atom pairs can be dominated by a small set of divergent atoms in loop regions. Furthermore, RMSD is not only dependent on the overall goodness of fit but also dependent on the length of the proteins. tm score () uses a variant of the levitt gerstein (LG) metric () that provides a length independent measure and limits the impact of divergent pairs of atoms in superimposed structures, an implementation of tm score using qc prot () (red) and the CPU and GPU versions of our implementation (green and yellow). tm score gpu is on average 68  3 times faster than the original implementation run on an AMD Phenom II 810 quad core processor. When comparing single threaded CPU implementations, our hybrid RMSD algorithm gives rise to a 45  0.4% speed up over the original code and 58  1% speed up over an implementation using qc prot rotations in the kab sch method and avoids the iterative methods used to solve for the eigenvalues of the S matrix used in quaternion methods. The resulting algorithm has a non divergent code path, has no iteration and is significantly faster. The single threaded tm score implementation using the hybrid method is 45% faster than the original kab sch based implementation and 58% faster than qc prot (see).
