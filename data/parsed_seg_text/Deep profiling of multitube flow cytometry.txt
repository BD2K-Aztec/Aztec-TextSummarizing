Motivation: Deep profiling the phenotypic landscape of tissues using high throughput flow cytom-etry (FCM) can provide important new insights into the interplay of cells in both healthy and diseased tissue. But often, especially in clinical settings, the cytometer can not measure all the desired markers in a single aliquot. In these cases, tissue is separated into independently analysed samples , leaving a need to electronically recombine these to increase dimensionality. nearest neighbour (NN) based imputation fulfils this need but can produce artificial subpopulations. clustering based NNs can reduce these, but requires prior domain knowledge to be able to parameterize the clustering, so is unsuited to discovery settings. Results: We present flow bin a parameterization free method for combining multi tube FCM data into a higher dimensional form suitable for deep profiling and discovery. flow bin allocates cells to bins defined by the common markers across tubes in a multi tube experiment, then computes aggregate expression for each bin within each tube, to create a matrix of expression of all markers assayed in each tube. We show, using simulated multi tube data, that flow type analysis of flow bin output reproduces the results of that same analysis on the original data for cell types of 10% abundance. We used flow bin in conjunction with classifiers to distinguish normal from cancerous cells. We used flow bin together with flow type and RchyOptimyx to profile the immuno phenotypic landscape of npm1 mutated acute myeloid leukemia, and present a series of novel cell types associated with that mutation.

introduction flow cytometry (FCM) immunophenotyping is a powerful and high throughput analytical technique allowing the rapid quantification of proteins on cells in suspension on a per cell basis (). Today, it is a critical step in both research and clinical decision making for leukemias (), human immunodeficiency virus (HIV;) and a host of other diseases. However, a major limitation is that data are typically analysed manually. Although the combinatorial space in FCM data are often vast, investigators rely primarily on intuition to guide their analysis, which may be error prone and difficult to reproduce (). In answer, the bioinformatics community has developed tools for computational deep profiling of high dimensional FCM data (). One example is flow type (), which exhaustively st ratifies all combinations of markers, and its sister package RchyOptimyx (), which finds those cell types most important to external outcomes such as disease state or patient survival, and distills these to their simplest possible form. Another example is spanning tree Progression Analysis of density normalized Events (SPADE), which clusters cells multi dimensionally then maps those clusters into a 2D representation using a minimum spanning tree algorithm (). These and other approaches have recently been compared and found to be extremely effective as part of a classification pipeline predicting acute myeloid leukemia (AML) from healthy patients based on FCM data (). However, in many cases, the number of proteins needing to be assayed exceeds the number that the cytometer available can measure in a single run. Furthermore, it is often essential, especially in clinical testing, to use negative controls (either unstained or isotype) to counteract technical variation across samples (). As a solution to this problem, standard practice is to aliquot a sample into multiple tubes, each of which is run to assay overlapping subsets of the total set of desired of proteins. This process is common for modern clinical diagnostic FCM data; especially, when immunophenotyping leukemias, where the standard method is to include the pan leukocyte marker (CD45) in each tube, and use this in combination with right angle scattered light side scattered light; SSC) to identify leukemic blasts in each tube separately (). For example, the current standard for leukemia diagnosis established by the euro flow consortium recommends an 8 colour multi tube panel of overlapping reagents (van). Without some means of combining tubes together, existing techniques for deep profiling can only be applied serially to each tube in a multi tube FCM assay, which results in a substantial loss in depth. This can be illustrated with an example: consider an assay with six tubes containing six markers each, with two of those markers overlapping (being present) in every tube. The complete number of distinct markers will be 2  4  6  26. When examining a binary division of each marker into positive and negative expression, the total number of possible cell types present is 3 26 % 2:5  10 12 (). However, working one tube at a time, only 3 6 cell types can be elucidated in each tube, for a total of 3 6  6  4374. For this example, serial analysis can only explore approximately one hundred millionth of the complexity of the phenotype space. per cell nearest neighbour (NN) merging of tubes attempts to address this. This method is founded on making the assumption that a cell in one tube is identical to its NN in another tube in terms of the common population markers (). The expression vectors of all the NNs across tubes are merged, creating a single, high colour matrix of cellular expression across all tubes. NN merging has proven effective as part of classification pipelines (da). However, as others have shown (), and we show later in this article, populations defined in terms of population markers are frequently made up of a mixture of cell types, and NN consequently tends to produce spurious combinations of markers. This makes the merged output from NN poorly suited for applying the deep profiling techniques, such as flow type and SPADE, as it tends to skew the counts of cell types. One proposed solution to this is to constrain the NNs mapping with clustering incorporating domain knowledge (). However, this latter method requires that all cell types expected to be present be prespecified in order to parameterize the clustering step. So, although well suited to diagnostic pipelines where the goal is to quantify known cell types, it is poorly suited for discovery of new cell types. There remains a need for a multi tube combination method for FCM data that produces conservative, non imputed data suitable for deep profiling. In this article, we describe flow bin an r bioconductor package that we developed to fulfil this need.

Discussion

conclusion flow bin is a complete pipeline for combining multi tube FCM data via markers shared across tubes. Quantile normalization of those markers to reduce technical variation is included. Of the two forms of binning included, flow fp is most suitable for later flow type analysis, while k means fits the contours of the data better. Compared with NNs merging of tubes, flow bin produces cleaner data, with far fewer false double positive marker combinations. flow bin with flow type can reproduce true data for more abundant cell types, and this data are suitable for statistical testing, albeit with lowered statistical power (increased Type II error). Also, importantly, this is only true for cell types of 10% abundance, suggesting that flow bin and potentially recombining of multi tube FCM in general, is not suitable for analyses involving rarer cell types. We have found a series of cell types associated with NPM1 mutation in AML. Although many of these cell types fit with previously reported trends, most represent new, previously unreported cell types associated with NPM1 mutation. Importantly, we have also demonstrated that flow bin output can be used for downstream discovery analysis using tools such as flow type and RchyOptimyx.Deep profiling of multi tube flow cytometry data
