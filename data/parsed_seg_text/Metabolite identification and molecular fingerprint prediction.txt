Motivation: Metabolite identification from tandem mass spectra is an important problem in metabolomics, underpinning subsequent metabolic modelling and network analysis. Yet, currently this task requires matching the observed spectrum against a database of reference spectra originating from similar equipment and closely matching operating parameters, a condition that is rarely satisfied in public repositories. Furthermore, the computational support for identification of molecules not present in reference databases is lacking. Recent efforts in assembling large public mass spectral databases such as mass bank have opened the door for the development of a new genre of metabolite identification methods. Results: We introduce a novel framework for prediction of molecular characteristics and identification of metabolites from tandem mass spectra using machine learning with the support vector machine. Our approach is to first predict a large set of molecular properties of the unknown metabolite from salient tandem mass spectral signals, and in the second step to use the predicted properties for matching against large molecule databases, such as PubChem. We demonstrate that several molecular properties can be predicted to high accuracy and that they are useful in de novo metabolite identification, where the reference database does not contain any spectra of the same molecule.

introduction in metabolomics, mass spectrometry (MS) provides the key measurement technology for quantifying and qualifying chemical signals to provide biological knowledge of cellular processes (). An MS measurement of a biological sample results in a set of peaks representing the mass to charge ratios and intensities of the different compounds of the sample. Identification of these molecules through mass spectra is a prerequisite for further biological interpretation and is the most time consuming and laborious step in metabolomics experiments (). The identification process is still mostly not automatized, thus requiring extensive manual analysis and expert knowledge (). Some structural information on a given compound can be obtained by tandem mass spectrometry (MS/MS) through ionization or collision induced dissociation fragmentation experiments. Tandem mass spectrum contains peaks representing various fragmentation products of the unknown compound, including the difficulty to predict rearrangement reaction products. A compound fragments in specific patterns according to its structure, the collision energy and the experimental configuration (). Elucidation of tandem spectra is at the core of molecular identification (). The standard method of performing compound identification is to measure the tandem mass spectrum of the unknown compound and to query the spectrum against annotated reference libraries of standardized spectra (NIST, mass bank Wiley Registry) (), followed by extensive domain expert analysis. In practice, the reference database requires a closely matching type of equipment and operational parameters for reliable matching (). Machine learning approaches for metabolite identification from MS/MS data have not been widely studied. Early related work includes STIRS () that uses a nearest neighbor approach to model the statistical relationships between spectral features and molecular substructures, the neural network work of, and the decision tree approach by. However, the impact of these methods has remained dormant perhaps due to predating the era of systems biology and limited available data. In contrast, current state of the art methods are based on combinatorial algorithms and database searches. The met frag software identifies metabolites by matching candidate metabolites with closest combinatorially simulated spectrum to the observed one (). Analysis of isotopic patterns can give additional clues on the metabolite's elemental composition (). We introduce a novel two step pattern recognition approach (see) to the metabolite identification problem. Instead of directly learning a mapping between the spectrum and the metabolite, we first predict a set of characterizing fingerprints of the metabolite from its tandem mass spectrum using a kernel based approach. We learn our fingerprint prediction model from a large set of tandem mass spectra obtained from public mass spectral database mass bank (step, we match the predicted fingerprints against a large molecular database to obtain a list of candidate metabolites. The metabolite identification model generalizes to metabolites not present in reference spectral databases. Due to the machine learning approach, data from any type of mass spectrometer are supported. In Section 2, we review the basics of mass spectrometry and the current state of the art of metabolite identification through reference databases. We introduce three classes of mass spectral features and a probability product kernel over the spectral features in Section 3. We also discuss the use of multiple measurements from the same metabolite. We propose a statistical approach to retrieve candidate metabolites using the predicted properties in Section 4. In Section 5, we experiment with the proposed finger id method in fingerprint prediction and metabolite identification. We conclude this article with discussion in Section 6.

discussion we presented a novel approach for de novo metabolite identification through intermediate fingerprint prediction based on tandem mass spectra. Our results indicate that it is possible to learn the statistical dependencies between tandem mass spectral signals and molecular properties, which can be used to score and rank metabolites, with good identification performance. Moreover, a sufficiently large set of fingerprint predictions can give useful clues to the actual metabolite identity to the human expert, even if exact automatic identification remains elusive. The machine learning approach widens the utility of mass spectral databases such as mass bank. Due to the nature of the the upper part of the table shows performance of reference queries in general, while the lower part indicates the performance when utilizing spectra only from the four different cases (Section 2). By definition, the (d) case gives no identifications method any type of tandem mass spectral data is applicable. This also allows us to handle, for example, the rearrangement reactions, which result in exceptional and difficult to predict fragment products (). Utilizing multiple measurements increases the prediction accuracies through kernel based data fusion. Our method can be easily complemented by inferring additional information about the metabolites, such as sum formulas from isotopic patterns () or by performing fragmentation analysis () in addition to fingerprint prediction. Further research is obviously necessary to bring the machine learning based approach towards a practical tool for metabolomics. In de novo metabolite identification, the identification performance depends, on one hand, on the uniqueness of the fingerprints to particular sets of metabolites, and on the other hand, the ability to predict these fingerprints from tandem mass spectra. It is an interesting future research direction to develop computational methods to identify sets of fingerprints that strike a good balance between these two qualities. An interesting machine learning approach for representing the molecular properties would be to use structured prediction () to model the statistical dependencies between the fingerprints and the input spectrum.
