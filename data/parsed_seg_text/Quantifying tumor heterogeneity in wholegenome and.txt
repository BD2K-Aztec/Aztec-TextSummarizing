Motivation: Most tumor samples are a heterogeneous mixture of cells, including admixture by normal (non-cancerous) cells and sub-populations of cancerous cells with different complements of somatic aberrations. This intra tumor heterogeneity complicates the analysis of somatic aberrations in DNA sequencing data from tumor samples. Results: We describe an algorithm called the ta2 that infers the composition of a tumor sample including not only tumor purity but also the number and content of tumor subpopulations directly from both whole genome (WGS) and whole exo me (WXS) high throughput DNA sequencing data. This algorithm builds on our earlier Tumor Heterogeneity Analysis (THetA) algorithm in several important directions. These include improved ability to analyze highly rearranged gen-omes using a variety of data types: both WGS sequencing (including low $7Ã‚ coverage) and WXS sequencing. We apply our improved the ta2 algorithm to WGS (including low pass and WXS sequence data from 18 samples from The Cancer Genome Atlas (TCGA). We find that the improved algorithm is substantially faster and identifies numerous tumor samples containing sub clonal populations in the TCGA data, including in one highly rearranged sample for which other tumor purity estimation algorithms were unable to estimate tumor purity. Availability and implementation: An implementation of the ta2 is available at

introduction several recent studies indicate that most tumor samples are a heterogeneous mixture of cells, including admixture by normal (non-cancerous) cells and subpopulations of cancerous cells with different complements of somatic aberrations (). Characterizing this intra tumor heterogeneity is essential for several reasons. First, an estimate of tumor purity, the fraction of cancerous cells in a tumor, is necessary for accurate identification of somatic aberrations of all types in the sample. Most cancer genome sequencing studies use a re-sequencing approach to detect somatic aberrations. Reads from a tumor sample (and usually a matched normal sample) are aligned to the human reference genome. Differences in the sequence of aligned reads, the number of aligned reads or the configuration of aligned reads (e.g. split reads or discordant pairs) are used to infer the presence of single nucleotide or other small variants, copy number aberrations or structural aberrations, respectively (). However, the presence of intra tumor heterogeneity can dilute the signals required to identify somatic aberrations. Second, estimates of the composition of a tumor sample including not only the tumor purity, but also the number and fractions of subpopulations of tumor cells provide useful for understanding tumor progression and determining possible treatment strategies (). In particular, clonal somatic aberrations that exist in all tumor cells are likely early mutational events and their identification sheds light on the early stages of cancer. Conversely, sub clonal somatic aberrations might reveal properties shared by a subset of tumor cells, such as drug resistance or ability to metastasize. Identification of such aberrations and subpopulations of tumor cells might inform treatment strategies, and or help predict metastasis relapse. In the past few years, several methods to infer tumor purity and or tumor composition have been developed. These methods generally fall into two categories: (i) methods that use somatic single nucleotide variants sn vs and (ii) methods that use somatic copy number aberrations. snv based methods such as EXPANDS (), py clone () and many others () use clustering of variant allele frequencies to determine tumor populations and frequencies. While these types of methods are able to derive multiple tumor subpopulations, they often require estimates of copy number for each region containing sn vs. Deriving such estimates for highly rearranged aneuploid tumors is as difficult as the estimation of intra tumor heterogeneity itself. Moreover, these approaches require high coverage sequencing to overcome the high variance in read counts at individual sn vs. For example, both py clone () and phylo sub () explicitly require deeply sequenced data. Thus, less expensive low coverage sequence data as generated in TCGA () is not amenable to these approaches. Copy number based methods such as ABSOLUTE () and cna norm () use observed shifts in read depth due to copy number aberrations to predict *To whom correspondence should be addressed. y The authors wish it to be known that, in their opinion, the first two authors should be regarded as Joint First Authors. tumor purity, but do not explicitly consider multiple tumor subpopulations, and therefore may return purity estimates that only reflect a single subpopulation of tumor cells in a sample. In, we introduced the Tumor Heterogeneity Analysis (THetA) algorithm to infer the composition of a tumor sample including both the percentage of normal admixture and the fraction and content of one or more tumor subpopulations that differ by copy number aberrations. In this article, we present the ta2 which extends the THetA algorithm in several important directions. First, we substantially improve the computation for the case of multiple distinct tumor subpopulations in a sample. Second, we extend THetA to infer tumor composition for highly rearranged genomes using a two step procedure where initial estimates are made using high confidence regions of the genome, and then are extended to the entire genome. Third, we devise a probabilistic model of b allele frequencies b afs which can be used to solve the identifiability issue when read depth alone is consistent with multiple possible tumor compositions. Finally, we extend THetA to analyze whole exo me (WXS) sequencing data. We apply our new algorithm to both whole genome (WGS) (including low pass and WXS sequence data from 18 samples from The Cancer Genome Atlas (TCGA). We find that the improved algorithm is substantially faster and able to analyze highly rearranged genomes identifying numerous tumors with sub clonal tumor populations in the TCGA data. Where available, we compare our purity estimates to published values for ABSOLUTE (). While the purity estimates are largely in agreement for higher purity samples, we find cases where ABSOLUTE fails or underestimates purity, but the ta2 identifies multiple tumor subpopulations. These improvements greatly expand the range of sequencing data and tumors for which we can infer tumor composition.

discussion we introduced an algorithm to infer tumor composition  of highly rearranged genomes from WGS (high or low coverage) or WXS DNA sequencing data. These are implemented as improvements to our THetA algorithm. The the ta2 algorithm is able to analyze highly rearranged, aneuploid samples that are beyond the scope of existing algorithms that infer tumor heterogeneity. A recently published comparison of algorithms for inferring tumor purity () showed that our original THetA algorithm () performed well, but sometimes underestimated tumor purity when run to only consider normal cells and one tumor subpopulation. We argue that this purity underestimation is likely a result of not directly considering all tumor subpopulations in the sample. In every sample that we analyzed with the new algorithm, tumor purity was higher when considering multiple tumor subpopulations. Although the improved the ta2 presented here is useful on a wide range of sequencing data from different tumors, some limitations remain. First, the ta2 is unable to distinguish tumor subpopulations that are not differentiated by copy number aberrations. As copy number aberrations are ubiquitous in most solid tumors (), we expect that the ta2 will be applicable to many genomes. However, for some diploid tumors, SNV analysis is preferable. Incorporation of additional ji wgs jj i wxs j where I WGS and I WXS are the interval partitions for the WGS and whole exo me data, respectively, and I  is the set of intervals longer than 100 kb contained in both I WGS and I WXS. CNA Sim is the fraction of I  where the copy number estimates are the same between the two data types. *Indicates that the sample did not pass the criteria to be considered for multiple tumor populations (see Supplemental Material). a For sample TCGA-06-0214, WGS data were aligned to hg18 and WXS data aligned to hg19. See supplementary for purity estimates across all genomes analyzed and results using an additional similarity metric. Bolding indicates the sample for which the ta2 can estimate purity, but ABSOLUTE reports as highly non clonal and is unable to estimate purity. information, such as b afs for somatic and germ line SNPs, into the model () may also increase the scope of samples for which the ta2 is applicable. Second, while the improvements presented here greatly decrease the computational burden of the algorithm when considering multiple tumor populations, the algorithm remains exponential in the size of the interval partition of the reference genome making it impractical to infer tumor composition with more than a handful of subpopulations in many cases. Identification of further mathematical restrictions to the domain of interval count matrices, or use of sampling techniques in place of complete enumeration are future avenues of investigation, which may prove useful in this respect. Additionally, when considering multiple tumor subpopulations, the quality of the results is limited by features of the data including the presence of copy number aberrations that distinguish subpopulations as well as the number of sequence reads available to identify these aberrations. The later is a function of sequencing coverage, aberration length and proportion of cells that have the aberration. While the limited number of tumor subpopulations that the ta2 analyzes may not be sufficient to fully analyze tumor progression, the ta2s ability to recover subpopulations with relatively low coverage sequencing data can provide some insight into tumor subpopulations in cases where methods that rely on high coverage data () can not. Combining the ta2s output with other methods that do explicitly consider the phylogenetic history of a tumor such as may prove a useful avenue of exploration. The two step procedure introduced here allows us to infer sub clonal copy number aberrations at much smaller scales. However, some care is required to avoid overfitting the data particularly for small, sub clonal copy number aberrations where GC bias or other sequencing artifacts may lead to incorrect inferences. Incorporating more sophisticated segmentation procedures that account for such effects and appropriately scale read counts () are useful directions for future research. Finally, this work focuses on the important first step of quantifying intra tumor heterogeneity from a single mixed tumor sample. Downstream analysis including the clinical and functional impact of the inferred tumor composition is an important area for future work.

conclusion we present a new algorithm, the ta2 to infer the composition of a tumor sample including both the percentage of normal admixture and the fraction and content of one or more of tumor subpopulations that differ by copy number aberrations. The new algorithm builds on our THetA algorithm (), and includes several improvements that allow us to analyze highly rearranged genomes from WGS (high and low coverage) or WXS sequencing data. In addition, the new algorithm is orders of magnitude faster and allows us to use b afs to distinguish between different reconstructions.
