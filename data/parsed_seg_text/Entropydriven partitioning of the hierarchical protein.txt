Motivation: Modern protein sequencing techniques have led to the determination of 450 million protein sequences. ProtoNet is a clustering system that provides a continuous hierarchical agglomerative clustering tree for all proteins. While ProtoNet performs unsupervised classification of all included proteins, finding an optimal level of granu-larity for the purpose of focusing on protein functional groups remain elusive. Here, we ask whether knowledge based annotations on protein families can support the automatic unsupervised methods for identifying high quality protein families. We present a method that yields within the ProtoNet hierarchy an optimal partition of clusters, relative to manual annotation schemes. The methods principle is to minimize the entropy derived distance between annotation based partitions and all available hierarchical partitions. We describe the best front (BF) partition of 2 478 328 proteins from UniRef50. Of 4 929 553 ProtoNet tree clusters, BF based on Pfam annotations contain 26 891 clusters. The high quality of the partition is validated by the close correspondence with the set of clusters that best describe thousands of keywords of Pfam. The BF is shown to be superior to na€ ıve cut in the ProtoNet tree that yields a similar number of clusters. Finally, we used parameters intrinsic to the clustering process to enrich a priori the BFs clusters. We present the entropy based methods benefit in overcoming the unavoidable limitations of nested clusters in ProtoNet. We suggest that this automatic information based cluster selection can be useful for other large scale annotation schemes, as well as for systematically testing and comparing putative families derived from alternative clustering methods. Availability and implementation: A catalog of BF clusters for thousands of Pfam keywords is provided at

introduction the explosive growth in the number of sequenced proteins is mostly a result of the breakthroughs in sequencing technologies and the corresponding sequencing of hundreds of organisms. Despite these advances, the structure and function of most of these proteins remains unknown. The most successful method for functional annotation of proteins is by sequence alignment, homology detection and inference techniques. Generalization of such approaches calls for charting the protein space by clustering or classification (). If successful, each such group of proteins would represent a 'family'. Classification into families is a critical component in structural and functional genomics. No accepted consensus exists for how many of these protein families might comprise the entire protein space (). There are $30 000 main orthologous groups () in addition to rare and peculiar single proteins. With the increased number of complete proteomes, a phyletic partition shows that thousands of families are associated with each multicellular organism. Various expert based databases provide a good description of protein families (). For example, InterPro (IPR) is composed of 25 000 models for families and domains and from a structural perspective, there are $2600 superfamilies according to CATH classification (). Classifying the entire protein space into families serves not only as a method for large scale protein annotations but also to support functional and structural genomic initiatives (). Some prominent examples for protein classification are syste rs (), CluSTr () and ProtoNet (). The shared theme of all these resources is the hierarchical nature of the protein families. Furthermore, while all use blast based statistical distance metrics for the clustering, the implementation, sensitivity, the notion of the distance metrics and consequently the depth of the hierarchical representations are different for each of the underlying algorithm and resource (). An important differentiating factor between various classification systems is the level of granularity. More often than not, definitions regarding the granularity are made arbitrarily, not based on natural or systematic considerations. The importance of granularity stems from the inherent diversity of the protein space. While some families are well defined by their sequence (e.g. Rubisco, Ribosomal proteins), the boundaries of many other protein families are blurred. To complicate things even further, some families may be best defined by a composition of several subfamilies, while others are part of large and multifunctional superfamilies (e.g. AAA superfamily, G protein coupled receptors, protein kinases). Gene Ontology database (GO) () and to some extent IPR () incorporate the notion of parent child relationships for gene protein family in cases where such relationships are accepted. For example, the neurotransmitter gated ion channel (IPR006201)' is a parent of 5 hydroxytryptamine we choose for this purpose Pfam, an extensive documentation of domains and families that represents one of the most reliable sources for protein families (). Pfam is a semiautomatic family database with a strict quality control. It contains $14 000 models for protein families and covers almost 80% of known protein sequences with $50% coverage of amino acids. As such, Pfam is an extremely valuable resource for addressing questions concerning the quality of structural and functional protein families. The classification provided by ProtoNet is based on a bottom up unsupervised agglomerative hierarchical clustering (). Specifically, it provides a full range of cluster granularity; from single proteins to huge clusters that carry minimal biological coherence (the root clusters). It is possible to match the majority of Pfam families to specific clusters within the ProtoNet clustering. Moreover, we search for 'natural' clustering partitions, from which the optimal granularity can be inferred. The intuition for such a natural partition is for it to be en tropically close' to a partition based on Pfam annotations of the proteins. In this article, we describe the theoretical basis for a novel entropy based procedure for best front (BF) searching. To allow for a priori prediction of the BF, we introduce additional intrinsic clustering parameters that partially separate the entire set of clusters present and those that are included in the BF. We show that a combination of two such parameters is enough to strongly enrich the BF from all clusters. Our method to identify optimal granularity allows for automatic and systematic definition of the set of proteins that correspond to an orthologous family. Such automatic definition could supplement current techniques in genome wide annotation projects, which are mostly based on expert annotation (). Furthermore, it will serve to define families using the matching of a large number of classification systems such as meta fam (), Superfamily () and more. We show that the automatic information based cluster selection of the BF is extremely useful for a systematic comparing of clustering methods. Furthermore, the supervised approach can be applied to biochemical functions (such as enzyme classification), as well as for structural superfamilies. We provide a complete catalog of the BF clusters for 410 000 IPR keywords.

discussion the novel method described here offers a systematic framework to address the quality of protein classification systems. While we use ProtoNet as our test bed, it is important to note that the tools and methods presented here are by no means limited in their scope to ProtoNet. These can be tailored to other hierarchical classification systems. The procedure is valid and expandable to other types of annotations. It can possibly serve to suggest the BF for structural and functional annotations (such as SCOP, CATH). However, it must be noted that the procedure is currently only suited to annotation types with approximately one level of granularity. Application of the method to a notably hierarchical annotation type, such as GO protein annotations, has determined (unpublished results) that the BF is the root containing all the proteins. This is due to the fact that many GO annotations are not separable; i.e. there is a large, inherent, minimal level of 'entropy' within the GO annotations [see discussion in (. Our work shows that application of the annotation based optimal partitioning procedure to the ProtoNet tree yielded a highly compressed number of protein clusters, which are often highly correlated with individual IPR keywords. In addition, we showed that an inherent property of clustering, the LT, could be used to remove clusters that will probably not be part of the BF partition. The combination of these two results suggests the possibility of an automatic classification method that would be capable of reconstructing the vast majority of pfam ipr knowledge (in terms of family boundaries). An example for such automatic support could be submission of novel unannotated sequences to the ProtoNet BF partition, and assigning (with a certain probability) the sequence to one of the BF clusters (each essentially equivalent to a certain protein family). An issue not yet addressed is the application of the method to a general set of protein annotations. The distance measure defined here has a theoretical minimum of 0; however, this value will not be the true lower bound for most annotation systems, as even having 1 protein with 2 different annotations (perhaps due to its being composed of multiple non-overlapping domains) will not allow the hk jcf term to go to 0, for any partition of the proteins. Allowing the splitting of a protein into its domains could address this problem. Additionally, calculation of the minimal theoretical value of the distance could be used to put the BF score in the context of its feasible values, implicitly part of the annotation system used. This theoretical lower bound essentially defines the 'entropy' inherent in an annotation system the ProtoNet tree that is the basis for the information theoretic approach is based on UniRef50. This implies that each cluster may be weighted by hundreds of sequences. For example, in mammals there are 1036 protein sequences named 'hemoglobin' and 3625 named 'hydrolase'. These sets in UniRef50 are compressed to 62 and 840 representatives, respectively. Therefore, the current analysis for ProtoNet that is composed of 2.5 million representatives is challenging with respect to the task in this study. However, extending the analysis for the expanded version of UniProtKB meets the limitation of computation feasibility (not shown). The current UniProtKB release 3_2014 already contains 54 million sequences and $10 million in UniRef50. The statistical and information driven method presented allowing a rational navigating in such large resource. In future work we will further validate BF hierarchies using statistical learning methods. Such tests are meant to reflect how well the BF would perform in an unsupervised setting. Preliminary results (not shown) indicate that the BF method is both robust and valid. The main drawback of the approach described above is its need for externally defined protein annotations. Therefore, we would like to be able to learn the intrinsic parameters of a given system that predict, with minimal error, the clusters in a characteristic BF. Fortunately, the amount (and quality) of protein annotation is rapidly increasing, with Pfam already including $14 200 annotations. The information theoretic approach developed here can only benefit from such trends, without sacrificing computational efficiency or accuracy.
