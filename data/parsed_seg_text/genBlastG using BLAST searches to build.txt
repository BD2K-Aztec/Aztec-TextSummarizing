Motivation: BLAST users frequently expect to obtain homologous genes with certain similarity to their query genes. But what they get from BLAST searches are often collections of local alignments called high scoring segment pairs (HSPs). On the other hand, most homology based gene finders have been built using computation intensive algorithms, without taking full advantage of BLAST searches that have been perfected over the last decades. Results: Here we report an efficient algorithm, gen blast g that directly uses the HSPs reported by BLAST to define high quality gene models.

introduction basic Local Alignment Search Tool (BLAST;) is one of the most popular and efficient bioinformatics tools ever developed. Frequently, BLAST users expect to identify homologous genes for comparative analysis. For example, following the discovery of a previously unknown gene in a human genome, a biologist will typically perform a BLAST search of the publicly accessible databases such as the mouse genome database to see if another species carries a similar gene, hoping to gain insights into the function and regulatory signals of the newly found gene. BLAST, however, presents the user a (usually large) collection of local alignments called high scoring segment pairs (HSPs). Such HSPs provide no indication how they are structured into the gene model because they are usually only isolated regions of similarity with some being simply noises. In the last decade, many homology based gene predictors have been developed including GeneWise (), Projector (), TwinScan () and Exonerate (). These algorithms either are independent of BLAST or use BLAST only as a preprocessing * To whom correspondence should be addressed.  The authors wish it to be known that, in their opinion, the first two authors should be regarded as joint First Authors. tool to narrow down gene search space (). Our work is motivated by the following question: can we construct gene structures directly from the HSPs found by BLAST, which represent high quality local alignments? The rationale is to delegate the expensive local alignment search to the well developed BLAST and focus on extracting and defining the best gene structure that such HSPs represent. Here we present a novel homology based algorithm, gen blast g which takes local similarity alignments (HSPs) identified by homologous searches as input and defines gene models by examining alignments and neighboring genomic regions for start stop codons and splicing signals. Compared to previous homology based gene finding algorithms, gen blast g is able to leverage the vast improvement in speed and search quality of BLAST made in last 20 years since its first publication and benefit from the wide acceptance and availability of the program. This hypothesis has been evaluated in nematode, plant and human genomes. Our tests show that gen blast g is extremely fast while providing better performance than previous algorithms in terms of specificity and sensitivity ().

description each gene is composed of one or more exons separated by introns, which are flanked by splicing signals () and has a start codon and a stop codon. In a recent project, we have developed a program gen blast a to define homologous genomic regions based on HSPs retrieved by BLAST (). These homologous genomic regions potentially contain candidate genes, but they do not manifest the exact gene structures. Here, we take advantage of the homologous genomic regions returned by gen blast a to further define homologous gene models. Given a query gene (e.g. a protein), gen blast g finds the gene models in a target genome in two steps: (1) parsing the output of BLAST searches into groups of HSPs with each group representing a genomic region that contains a candidate homologous gene (), and (2) examining the HSPs within each group and exploits sequence signals in the homologous genomic region to define introns and gene start and stop signals. The Step 1 is done by running gen blast a while the Step 2 must address the following challenges. First, there is no simple one to one correspondence between HSPs and exons: one HSP can correspond to multiple exons and multiple HSPs can correspond to one exon. Secondly, some exons may not be represented by any HSP at all, whereas some HSPs are simply noises and do not correspond to any exon. Thirdly, even when HSPs correspond to an exon region, the structure of introns and exons has to be resolved because HSPs carry no information of such structures. Numerous possible combinations of splicing sites surrounding the HSPs could delimit introns and exons. Determining the best combination from these alternatives is not an arbitrary decision and is challenging. These issues are not considered in gen blast a. gen blast g builds gene models by maximizing the similarity to their corresponding queries. First, putative intronic regions are detected by examining gaps between adjacent HSPs, as well as mismatches within HSPs. Secondly, candidate splice sites are detected. Consider an intron region I, which is associated with its own set of predicted splice donors (d1, , dn) and acceptors (a1, , an). For a pair of donor and accept or to be considered a valid pairing, the donor and accept or must be in frame with each other and there is no in frame stop codon in the corresponding spliced sequence S, which is formed by connecting the subject segment of the HSP at the upstream side of a donor site (called donor side subject segment') with the subject segment of the HSP at the downstream side of an accept or site (called acceptor side subject segment'). The best donor accept or pair is the one that results in the highest alignment identity between the spliced sequence S and its corresponding query segment (at the amino acid level). It is possible that there exists no valid pair of donor and accept or in an intron region, in which case no intron will be predicted and consequently the genomic region will be accepted as an exon. After selecting the best pair of donor and accept or for each intron region, an initial gene structure is obtained. However, gene models could still be incomplete for missing one or more exons because BLAST may fail to pick up weak and short similarities. gen blast g retrieves missing alignments to maximize the similarity between the predicted gene model and corresponding query gene. For each region that is subject to repair, a local alignment algorithm () is used to find the possible missing alignment in the genomic region between two adjacent exons, or the upstream region before the first exon or the downstream region after the last exon.

conclusion blast has been extremely successful as a tool for finding local alignments with both high sensitivity and speed. However, the large number of isolated local alignments, in the form of HSPs, can not be readily and effectively interpreted due to the lack of obvious organization that describes the gene structure from which HSPs are extracted. gen blast g which builds on the success of gen blast a presents an approach that constructs the gene models directly from the HSPs returned by BLAST, with the intention of leveraging the wide success of BLAST. Our study shows that gen blast g can find gene models much faster than existing homology based gene finders including GeneWise and Exonerate, while providing better performance than these programs.
