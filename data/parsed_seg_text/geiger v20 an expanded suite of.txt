Phylogenetic comparative methods are essential for addressing evolutionary hypotheses with interspecific data. The scale and scope of such data have increased dramatically in the past few years. Many existing approaches are either computationally infeasible or inappropriate for data of this size. To address both of these problems , we present geiger v2.0, a complete overhaul of the popular R package geiger. We have reimplemented existing methods with more efficient algorithms and have developed several new approaches for accomodating heterogeneous models and data types. Availability and implementation: This R package is available on the CRAN repository http://cran.r-project.org/web/packages/geiger/. All source code is also available on git hub http://github.com/mwpen-nell/geiger-v2. geiger v2.0 depends on the ape package. Contact:

introduction in the past few decades, phylogenetic trees have become a key component of evolutionary research. This development has been fueled by the increased availability of robust time calibrated phylogenies for many groups, in addition to an expanding number of statistical techniques for inferring patterns and processes from comparative data (reviewed in). Among the many R packages developed for phylogenetic and comparative data (e.g.,), geiger () has been a primary utility for making macro evolutionary inferences from phylogenetic trees. However, in the 6 years since the initial release of geiger, the data available for comparative biology have changed substantially. For some groups, we now have phylogenies and corresponding trait data with thousands (and even tens of thousands) of species (e.g.). geiger v2.0 is a complete overhaul of the previous release (), designed to scale up comparative methods to large datasets. To do so, we have taken two complementary tacks. The first is to improve algorithms and implementations to increase computational efficiency of existing methods. The second is to expand the suite of statistical approaches to allow for heterogeneity in both models and data types across the phylogeny. In this applications note, we briefly describe the methods now in geiger, with a particular focus on novel implementations and algorithms. Most of these methods have been previously published elsewhere in some form, and we refer readers to the relevant publications for full explanations (for an overview of the main features of the package, see Appendix 1 in Supplementary Material). the function fit discrete. We have rewritten this function for geiger v2.0, again using an alternative, more efficient algorithm for calculating the likelihood of observing trait values under a model (). In the new version of fit discrete the computational time required for the likelihood calculation scales approximately linearly with the number of character states, whereas the previous version scaled super linearly (see Appendix 2 in Supplementary Material for details). This improvement allows for more complex models to be efficiently fit to large phylogenies.

conclusion in this note we provide a broad overview of the methods now available in geiger. We have not discussed some methods implemented in geiger (e.g. congr u ification for time scaling large trees;) and many of the nuances of the methods described here have been left out. We refer readers to associated publications and the package documentation for more information. It is an exciting time for macro evolutionary research. We now have access to datasets of unparalleled size and a wide variety of new statistical approaches with which to analyze them. We hope that the software presented here will help researchers address some fundamental and long-standing questions in macroevolution.
