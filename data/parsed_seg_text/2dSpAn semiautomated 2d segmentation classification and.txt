Motivation: Accurate and effective dendritic spine segmentation from the dendrites remains as a challenge for current neuroimaging research community. In this article, we present a new method (2dSpAn) for 2-d segmentation, classification and analysis of structural plastic changes of hippo-campal dendritic spines. A user interactive segmentation method with convolution kernels is designed to segment the spines from the dendrites. Formal morphological definitions are presented to describe key attributes related to the shape of segmented spines. Spines are automatically classified into one of four classes: Stubby, Filopodia, Mushroom and spine head Protrusions. Results: The developed method is validated using confocal light microscopy images of dendritic spines from dissociated hippocampal cultures for: (i) quantitative analysis of spine morphological changes, (ii) reproducibility analysis for assessment of user independence of the developed software and (iii) accuracy analysis with respect to the manually labeled ground truth images, and also with respect to the available state of the art. The developed method is monitored and used to precisely describe the morphology of individual spines in real time experiments, i.e. consequent images of the same dendritic fragment. Availability and Implementation: The software and the source code are available at https://sites. googlecom site 2dspan under open source license for non-commercial use.

introduction neuronal cells in different brain regions are covered with dendritic spines (), which are small membranous protrusions having a length of around few microns. They form the postsynaptic compartment of most excitatory synapses in the central nervous system (). Dendritic spine is usually composed of a spine head and a spine neck that connects the spine head to the dendritic shaft (). More specifically, a spine head, where the excitatory synapse is located, is separated from the parent dendrite by a thin neck, isolating the spine cytoplasm from the dendrite (). Spines are likely to play an essential role in neural circuits but their exact function is still a matter of debate ().Because of their morphology, dendritic spines are assumed to play a role in electrical and biochemical compartmentalization (). Synaptic plasticity is essential for brain development and higher brain functions (). Changes in dendritic spine morphology are believed to associate synaptic plasticity (), which seem to be critical for synaptic function (). However, the understanding of the relationship between the changes in dendritic spine structure and synapse functions remains inadequate. The quantitative contribution of spine morphology to biochemical compartmentalization is still unknown, in spite of being a long-standing hypothesis (). Therefore, the important question is, whether or how much the synaptic strength may be adjusted through structural changes in spine necks (or the complete spine) (). Effective solution to this problem is particularly difficult due the complex morphology of the dendritic spines. The problem gets compounded with the limited resolution of optical microscopic images (). In many situations, the spines are difficult to be segmented from the images of dendritic segments having hundreds of these protrusions. Identification of true spine boundaries is difficult and time consuming (). Accurate quantitative analyses of the spines depend on the question, 'how easily and effectively the spines can be segmented from the dendrite?' Recently, some researchers have tried to address the earlier issue. A Patent Cooperation Treaty (PCT) application () presents a method for characterizing one or more neurons comprising dendritic spines utilizing a grass fire process. The technique is particularly efficient for detecting separated spine heads. However, no detailed description is provided on how to precisely detect the contours of the spine. The work by) presents a method for segmentation and analysis of every spine separately using a contour tracing algorithm. Two points are marked for each spine, one at the bottom of the neck and the other at the head [the farthest point (FP) on the spine from the neck]. Then a parameterized contour tracing algorithm detects the spine boundary and the morphological attributes. This process requires extensive user intervention. In images with hundreds of spines, marking two end-points and choosing appropriate segmentation parameters for every spine is a rigorous job. This makes segmentation of dendritic spines both times consuming and error prone. In one of the recent developments proposed an advanced 3D approach for segmentation of the spines, however, that kind of approach requires many optimization steps and extensive manual supervision. Apart from the works mentioned earlier, several neuro morphological tracing tools are also available (). Many of these techniques use the commercial reconstruction software neuro lucida (). Existing tracing tools like, Filament Tracer (http://www.bitplane.com/imaris/filamenttracer), Amira (http://www.fei.com/software/amira-3d-for-life-sciences/), Eutectic NTS (http://neuronland.org/NLMorphologyConverter/ morphology formats eutectic s spec html 3dma neuron (http:// wwwamssunysbedulindquis3 dma3dmaneuron3dma neuron. html), neuron j (http://www.imagescience.org/meijering/software/neu ron j neuron studio (https://en.wikipedia.org/wiki/NeuronStudio), neuron morpho (http://www.southampton.ac.uk/$dales/morpho/), etc. require extensive manual annotations and parameter selection for automated semi automated reconstructions. For example, Filament Tracer (a module of the commercial i mar is software) incorporates visualization and editing utilities and performs morphometric calculations by fitting the objects from the finite list of shapes (such as, cone, ball and cylinder). Similarly, neuron morpho an open source tool for semiautomatic digital tracing of neurons from image stacks, generates outline of the neurite or soma by drawing straight lines across the width of the section. None of these applications provides formal morphological definitions of spines. Some applications like neuron j are developed as image j () plugins and are slow in analyzing images. These tools are often applicable on specific types of images, like, 8-bit grayscale or indexed color images. The proposed 2dSpAn method significantly reduces human involvement and allows the operators to quantitatively assess dendritic spine plasticity. Users need to mark a specific dendritic segment, automatically segment the spines using the designed convolution kernels and finally mark the spines of interest to extract relevant features with high accuracy and minimal intervention. Moreover, the proposed 2dSpAn method allows morphological analysis of spines from different type of images including those acquired by super resolution confocal and wide field microscopy images. The overall method is divided in two steps: (i) segmentation of the dendritic spines and (ii) quantitative assessment of spine morphology. In the article, we briefly describe the theory behind the developed segmentation algorithm and highlight the main features of the 2dSpAn interface and software architecture. The performed experimental validation is done with respect to the confocal images of dendritic spines from dissociated hippocampal cultures. Finally, we conclude with a discussion on open source software development, limitations and future plans.

Description

discussion in this work, we present a new tool for fast and accurate annotation of dendritic spines from confocal microscopy images. However, the 2dSpAn method allows determining the morphology of spines from super resolution microscopy and is not limited only to confocal images. Please note that, the applied confocal imaging technique provides sufficient resolution to detect the changes of dendritic spines morphology (). We also define and extract several morphological features from the segmented spine images for quantitative assessment of spine structural plasticity. Although there are some tools that serve somewhat similar purposes, like the one developed by), they do not provide the formal morphological definitions to different spine compartments. For example, there were no formal morphological characterizations to base, neck and head of a spine, in the prior works. There are plenty of biological discussions in contemporary literature but most of them are subjective with respect to digital image segmentation and analysis. We also provide an automatic spine classification framework based on the features extracted from the segmented spines. The proposed spine classification model works on a rule based decision tree framework and may be improved further in future versions of the software. The performance of the classifier is assessed by comparing the manual annotations from experimental biologists. The developed spine segmentation methodology is based on a novel convolution kernel based approach. This methodology is effective in isolating the dendritic segment in between two manually embedded seed points on the image, using the 2D graphical user interface of the developed software. The spines on either side of the dendritic segment are marked by the user by placing a single inside seed, leading to segmentation of the spine from the dendritic segment. The morphological features like area and length of the spine are computed immediately. Other features like neck length neck width and head width are also estimated for each segmented spine. The segmentation and classification steps in the 2dSpAn tool are extremely fast and almost instantaneous on a standard desktop computer. The segmentation task takes $1 s and the classification of individual spines takes several milliseconds computation time on the desktop computer used in our experiment. To assess the efficacy of the developed tool, we first analyzed dendritic spine structural changes with respect to two image datasets, before and after c ltp. We have quantitatively assessed the transitions between the spine categories Stubby, Filopodia, Mushroom and spine head Protrusions. The changes in spine area and length are observed over all segmented spines. For all non stubby spines, the changes in neck length and neck width values are analyzed. We have also assessed the changes in head width in all Mushroom type spines. Please note that the objective of this study is to demonstrate the capabilities of the developed 2dSpAn tool and therefore we are not inferring any biological significance from the experimental observations. For stability and robustness study, a three user reproducibility analysis has been performed. Both qualitative and quantitative analysis show exciting results on the T0 and T10 image sets. The accuracy analysis is performed with respect to the manually annotated GT dataset and also with respect to the prior works available in this domain. There are still scopes for improvement especially with respect to the design of the user interface and also with respect to the preprocessing steps for the image sets. The complete work depends on the bin a rization algorithm applied on the ROI marked by the user. At this moment, we use a global bin a rization on the complete region. This process may some time inflict noise in the data, leading to inappropriate segmentation of the spines. We are currently working on that issue and hope to improve the same in the upcoming version of the software. The basic software architecture, along with a representative screenshot (Supplementary) is discussed in supplementary and also in the user manual. Finally, on the availability of the developed software, we would like to mention that the complete open source platform independent package is available at https:// sites googlecom site 2dspan for non-commercial use by the research community.
