Motivation: Finding functionally analogous enzymes based on the local structures of active sites is an important problem. Conventional methods use templates of local structures to search for analogous sites, but their performance depends on the selection of atoms for inclusion in the templates. Results: The automatic selection of atoms so that site matches can be discriminated from mismatches. The algorithm provides not only good predictions, but also some insights into which atoms are important for the prediction. Our experimental results suggest that the metric learning automatically provides more effective templates than those whose atoms are selected manually.

introduction the influx of newly sequenced genomes has sparked the development of function prediction methods that use global sequence structure comparison for the annotation of genes and proteins (). For enzyme proteins, many such methods attempt to predict functions from protein sequences and structures based on the Enzyme Commission (EC) classification scheme (). The EC classification scheme, which has been used worldwide for many years, is based mainly on the whole chemical structures of substrates and products, and on the cofactors involved (). However, because the EC classification scheme neglects protein sequence and structure information, it is sometimes difficult to detect a correlation between an enzyme sequence structure and functions based on it. For instance, some homologous enzymes that are a result of divergent evolution from the same ancestral enzyme might catalyze different reactions, whereas some non-homologous enzymes from different superfamilies might catalyze the same reaction because of the convergent evolution. The enzyme pair trypsin and subtilisin, which shares the ser his asp catalytic triad, is a typical example of 'analogous enzymes' produced by convergent evolution ().analyzed the catalytic * To whom correspondence should be addressed. mechanisms of 270 enzymes (mainly hydrolases and transferases) from 131 superfamilies, which are manually compiled in the enzyme reaction database, ezc at db. Analysis of the enzyme reactions has revealed several analogous reactions that are observed in nonhomologous enzymes (). ezc at db also provides a hierarchic classification of enzyme reactions, r lcp which clusters the same reaction types together based on basic Reaction (R), Ligand group involved in catalysis (L), type of Catalytic mechanism (C), and residue cofactors located on Proteins (P) (). Consequently, both the homologous reaction and the analogous reaction can be clustered together in the r lcp classification if they share the same catalytic mechanism and the same type of catalytic site (). Results of a recent study also suggest that such cases of active sites shared by analogous enzymes are not rare (). Consequently, for enzyme function prediction, it is necessary to examine the specific local structures of the active sites that might reflect enzyme functions, rather than the global structures, such as the domain level or the chain level (). Regarding local structure comparison methods to detect similar active sites, several template based methods have been reported (). Those template based methods search for the occurrence of a predefined template structure that consists of active site residue atoms, within target protein structures. However, some questions and problems remain in relation to the template based methods: (i) the prediction accuracy might be dependent on the number and types of atoms in the templates. Because it is sometimes very difficult to determine which atoms in the catalytic site should be included in the templates, even experts on enzyme structure and function might have to create the best template through trial and error. (ii) Some atoms in the catalytic site might be more important for the catalytic reaction than other atoms are. According to a previous report, the side chain of catalytic residues is used (92%) much more frequently than the main chain (only 8%) (). Moreover, charged and or polar residues tend to be involved in catalysis (). Are such catalytically necessary atoms also important for the templates? (iii) These template based methods also yield a huge number of mismatches along with site matches. Is it possible to reduce the number of mismatches? In this study, we developed a new metric learning algorithm to detect catalytic sites effectively in terms of search accuracy of r lcp classification (). One famous template based method, TESS () uses geometric hashing to
