Motivation: In chromatin immunoprecipitation followed by high throughput sequencing chips eq and other short read sequencing experiments, a considerable fraction of the short reads align to multiple locations on the reference genome multi reads. Inferring the origin of multi reads is critical for accurately mapping reads to repetitive regions. Current state of the art multi read allocation algorithms rely on the read counts in the local neighborhood of the alignment locations and ignore the variation in the copy numbers of these regions. copy number variation (CNV) can directly affect the read densities and, therefore, bias allocation of multi reads. Results: We propose cnv csem cnv guided chips eq by expectation -maximization algorithm), a flexible framework that incorporates CNV in multi read allocation. cnv csem eliminates the CNV bias in multi read allocation by initializing the read allocation algorithm with cnv aware initial values. Our data driven simulations illustrate that cnv csem leads to higher read coverage with satisfactory accuracy and lower loss in read depth recovery (estimation). We evaluate the biological relevance of the cnv csem allocated reads and the resultant peaks with the analysis of several ENCODE chips eq datasets.

introduction chromatin immunoprecipitation followed by sequencing chips eq is currently the dominant high throughput assay in functional genomics and epi genomic research, especially for mapping transcription factor dna tf dna interactions and histone modifications. In a typical chips eq experiment, tens of millions of DNA fragments (usually 1001000 bp) are sequenced directly from one or both ends, and short reads (usually 25100 bp) are recorded. The analysis of chips eq data starts with the mapping of the short reads to a reference genome with a short read aligner, e.g. Bowtie () and BWA (). Because of repetitiveness of the genomes, errors in reads and the short read lengths, 1030% of the reads can map to multiple locations (). Common practice in chips eq analysis is to use only uniquely mapping reads uni reads and discard the reads that map to multiple locations multi reads (). Although using uni reads alone is adequate in many cases, it makes any inference about the repetitive regions challenging, if not impossible. In addition, recently developed multi read allocation methods have successfully argued that use of such reads leads to identification of many novel protein dna interactions in chips eq experiments (). Furthermore, they illustrated that the effective increase in the coverage of the highly repetitive regions owing to multi reads can not be simply achieved by adjusting for low mapp ability during peak calling (). Although there are some specific modeling differences among different chips eq aligners, they predominantly operate by allocating multi reads to their mapping locations based on the read counts of the local neighborhoods of the mapping locations, which largely relies on the uni read counts. Regions of high sequence similarity tend to have low uni read counts, making it challenging for the algorithms to distinguish between different mapping locations. Furthermore, none of them take into account copy number variations cn vs which are structural variations of a genome that reflect the differences between the sample genome and the reference genome in the number of copies of DNA segments. CNV has a direct effect on read depths of the sequencing samples. In the literature, this effect has been appreciated in peak calling () and in differential epi genome chips eq and rnase q analyses (). As of today, none of the multi read mapping methods has considered the potential effect of CNV on multi read allocation and the power it might provide for discriminating the mapping locations of multi reads. The former methods () estimate CNV from the mapped ChIP or control samples and incorporate this information during peak identification. However, if the reads are allocated without taking into account the CNV, CNV estimated from such mapped reads will be biased, especially in the repetitive regions (e.g.). Furthermore, even if the reads are mapped correctly, their genome wide coverage is not uniform (), and the high copy number regions identified from such data may be confounded with the open chromatin regions. This motivates us to correct the CNV bias at the stage of read allocation by using external CNV data instead of estimating it from the ChIP or control samples. We refer to for a similar discussion in a different setting. To investigate the impact cn vs might have on multi read allocation, we extracted all the reads that align to exactly two locations of the reference genome in a Ctcf chips eq sample from GM12878 cells (such two locations are referred to as an alignment pair from here on. We found that for 15.2% of reads that map two locations, the copy numbers of the alignment pairs differed by at least one supplementary and Supplementary); and therefore, we expect the cn vs to inform the multi read allocation for such reads. Even for the alignment pairs with the same copy number, cn vs may still have an indirect impact by affecting the allocation of other reads in the neighborhoods of these alignment locations. For multi reads with more than two alignments, the copy numbers are more likely to vary among the alignment locations, and a larger impact of CNV is expected. In this article, we develop cnv csem cnv guided chips eq by expectation maximization algorithm), a flexible framework that guides multi read allocation by cn vs. The cnv csem takes advantage of the state of the art multi read allocation algorithms and incorporates CNV information parsimonious ly. We use the fact that various array and sequence based CNV detection algorithms have been developed (), and large consortia such as 1000 Genomes () have produced high throughput sequencing data for CNV detection. Combining these efforts, detecting CNV and estimating copy number with a reasonable accuracy is possible. Our data driven simulation results show that (i) cnv csem increases multi read allocation coverage and significantly reduces allocation ambiguity in the segmental duplication regions (SDR) with only a marginal loss in accuracy, and (ii) cnv csem also improves the accuracy of the read depth recovery, especially in the highly repetitive regions with low copy numbers. Our study of several ENCODE TF chips eq experiments demonstrate the biological relevance of the cnv csem allocated reads and the chips eq peaks identified in the downstream analysis.

discussion in chips eq experiments and other short read sequencing experiments, a significant fraction of the reads map to multiple locations. Processing of multi reads can impact the downstream analysis of peak calling significantly. None of the currently available multi read allocation methods take into account cn vs in the sample genomes. We showed in this article that using CNV provides additional information for discriminating mapping locations of a multi read with similar uni read counts. Our data driven simulations revealed significant improvements in multi read allocation accuracy and better read depth recovery when using CNV information. Analysis of multiple ENCODE datasets indicated that peaks identifiable only when using copy number information in multi read allocation have biologically meaningful characteristics. In our framework, we incorporated CNV in the initialization of the EMS algorithm instead of explicitly including it in the model because of the nature of the CNV information. Intuitively, copy numbers should influence the elements of the read density as multipliers. If the copy numbers are already encoded in 0 during the initialization step, their influence will be preserved in the updates of the iterations, except at the locations around the break points of the CNV regions. However, the typical numbers of break points are small. For GM12878 and GM12891 experiments, cnv nator detects 55000 CNV regions, and consequently 510000 break points. The array based CNV annotation of HepG2 includes 5600 break points. Compared with the length of the whole genome, this additional effect of the deletion regions include both heterozygous and homozygous deletions. In all, 96.5% of the uni only peaks are captured in both the extended lists of CSEM and cnv csem however, only 44.1% of the multi common are identified in the extended peak list of uni reads notes (1)and(2) in the first column denote GM12878 and GM12891 cells, respectively
