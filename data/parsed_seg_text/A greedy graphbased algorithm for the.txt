Motivation: Many comparative genomics studies rely on the correct identification of homologous genomic regions using accurate alignment tools. In such case, the alphabet of the input sequences consists of complete genes, rather than nucleotides or amino acids. As optimal multiple sequence alignment is computationally impractical, a progressive alignment strategy is often employed. However, such an approach is susceptible to the propagation of alignment errors in early pairwise alignment steps, especially when dealing with strongly diverged genomic regions. In this article, we present a novel accurate and efficient greedy, graph based algorithm for the alignment of multiple homologous genomic segments, represented as ordered gene lists. Results: Based on provable properties of the graph structure, several heuristics are developed to resolve local alignment conflicts that occur due to gene duplication and or rearrangement events on the different genomic segments. The performance of the algorithm is assessed by comparing the alignment results of homologous genomic segments in Arabidopsis thaliana to those obtained by using both a progressive alignment method and an earlier graph based implementation. Especially for datasets that contain strongly diverged segments, the proposed method achieves a substantially higher alignment accuracy, and proves to be sufficiently fast for large datasets including a few dozens of eukaryotic genomes. Availability: http://bioinformatics.psb.ugent.be/software. The algorithm is implemented as a part of the iad hore 3.0 package.

introduction in the past decades, considerable effort has been devoted to the development of algorithms for the alignment of biological sequences at the nucleotide or amino acid level. Using dynamic programming techniques, optimal pairwise global () and local () alignments can be obtained in O(l 2 ) time, where l denotes the length of the sequences. A straightforward extension of these algorithms to N  2 sequences results in a computational complexity of O(l N ), which renders the handling of sequences of realistic length impractical. Therefore, most multiple sequence alignment (MSA) tools are based on progressive alignment, in which N sequences are aligned through N 1 applications of a pairwise alignment algorithm, usually guided by a tree that determines the order in which the sequences are combined. Many MSA tools that build on this principle have been implemented such as the well known programs CLUSTAL(W) (), t coffee (), MUSCLE () and maff t (). Almost without exception, MSA tools target the alignment of amino acid or nucleotide sequences. In this article, we focus on the alignment of multiple, mutually homologous (i.e. derived from a common ancestor) genomic segments, represented as gene lists. This means that the alphabet of the input sequences consists of individual genes, rather than nucleotides or amino acids. Similarly to MSA at the nucleotide or amino acid level, the goal is to align homologous genes, i.e. place genes that belong to the same gene family in the same column. The homology relationships between the individual genes have been established in a preprocessing step using sequence similarity searches and protein clustering (). Whereas ancestral gene order reconstruction (see e.g.) starts from homologous genomic segments to infer ancestral genome states and quantify genome dynamics, the objective of our graph based approach is to create accurate alignments of homologous segments, in order to facilitate the detection of additional homologous genomic segments. The multiple sequence alignment of gene lists differs significantly from the alignment of sequences at the nucleotide or amino acid level. First, the size of the alphabet of different nucleotides (4) or amino acids (20) is much smaller than the typical number of different gene families that occur in the genome of an organism. This means that a certain gene only has a very limited number of homologous genes in other gene lists. Second, through evolution, nucleotide and amino acid sequences mainly undergo character substitutions, whereas chromosomes mainly undergo gene loss insertion inversion and other types of rearrangements (e.g. reciprocal translocation). These two major differences allow for the development of a graph based alignment approach, which will be demonstrated to have a higher accuracy than a progressive approach, in terms of the number of correctly aligned homologous genes. We propose an algorithm similar to the so called segment based alignment approach that is used in e.g. di align (). The first step in di align consists of the identification of corresponding gap free local alignments or 'fragments' between pairs of sequences. The alignment of some of these fragments can prohibit the alignment of others. Finding the largest (weighted) subset of fragments that can be incorporated into a multiple alignment is a difficult task, often referred to as the consistency problem (). In the context of the gene list alignment problem, the 'fragments' correspond to homologous genes. The consistency problem then is to find the maximal number of homologous genes that can be included in a multiple alignment. Optimal solution methods to this consistency problem exist (), but are np hard and therefore in general computationally impractical. Here, fast heuristic methods are developed to remove inconsistent or conflicting homology relationships between genes, from a graph theoretic perspective. Similar ideas have been developed by. The proposed alignment algorithm is part of the iterative automatic detection of homologous regions iad hore software (), a map based method to detect homologous genomic segments within or between the genomes of related organisms. Rather than identifying primary sequence similarity, map based methods look for statistically significant conservation of gene content and gene order (collinearity). One of the key features of iad hore is the capability to uncover segmental homology, even between highly diverged segments. When two homologous segments have been identified, a so called profile is constructed by aligning both segments, hence combining the gene order and content of both homologous segments. This genomic profile can then be used by iad hore as a more sensitive probe to scan the genome, in order to identify additional homologous segments (). This iterative process of alignment and detection continues, until no additional statistically significant genomic segments can be found. It is clear that a high quality alignment of the homologous gene lists within a profile is imperative for a sensitive detection of additional homologous genomic segments within the iad hore software. The original iad hore () implementation relied on profile construction using a progressive application of the needleman wunsch (pNW) aligner. Especially when dealing with strongly diverged segments, one of the biggest problems with the pNW method is that erroneous alignment decisions in early pairwise steps propagate to the final alignment, causing the alignment quality to degrade significantly when more segments are added. This problem was already partially addressed in iad hore 2.0, through the introduction of a greedy, graph based (GG) aligner (). Rather than relying on a progressive adding of segments, the gg aligner considers the N segments 'simultaneously'. Although this gg aligner has its merits compared with the pnw aligner (e.g. it avoids the 'once a gap, always a gap' problem), it was unable to outperform the latter in terms of the number of correctly aligned genes. This article introduces a new greedy, graph based algorithm (called GG2) that builds on the original gg aligner. First, the basic graph based alignment algorithm will be explained, followed by the development of a heuristic to resolve consistency problems in this graph, so called conflicts. In later sections, we demonstrate that the new gg2 aligner outperforms both the pNW method and the original gg aligner in terms of alignment accuracy. The new gg2 aligner has been implemented in the latest 3.0 version of iad hore and its C++ source code can be downloaded for academic purposes (http://bioinformatics.psb.ugent.be/software).

conclusion we have developed a greedy, graph based algorithm for the alignment of multiple, homologous gene lists. Several properties of conflicts within the alignment graph have been derived and proved. Three heuristics for conflict resolution were developed on these theoretical grounds, and have been demonstrated to be able to outperform an older graph based algorithm and a progressive approach in terms of alignment accuracy. As is often the case, a tradeoff between computational requirements and alignment accuracy can be observed. The algorithm has been implemented in the latest version of iad hore 3.0.
