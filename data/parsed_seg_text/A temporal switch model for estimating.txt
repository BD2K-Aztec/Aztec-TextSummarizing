Motivation: The analysis and mechanistic modelling of time series gene expression data provided by techniques such as microarrays, nano string reverse transcription polymerase chain reaction and advanced sequencing are invaluable for developing an understanding of the variation in key biological processes. We address this by proposing the estimation of a flexible dynamic model, which decouples temporal synthesis and degradation of mRNA and, hence, allows for transcriptional activity to switch between different states. Results: The model is flexible enough to capture a variety of observed transcriptional dynamics, including oscillatory behaviour, in a way that is compatible with the demands imposed by the quality, time resolution and quantity of the data. We show that the timing and number of switch events in transcriptional activity can be estimated alongside individual gene mRNA stability with the help of a Bayesian reversible jump Markov chain Monte Carlo algorithm. To demonstrate the methodology , we focus on modelling the wild type behaviour of a selection of 200 circadian genes of the model plant Arabidopsis thaliana. The results support the idea that using a mechanistic model to identify transcriptional switch points is likely to strongly contribute to efforts in elucidating and understanding key biological processes, such as transcription and degradation.

introduction one of the archetypal challenges of systems biology is the task of uncovering the network of interactions between genes and proteins using data such as that coming from high throughput genome wide technologies or multi-parameter imaging. Time series gene expression data from techniques such as nano string reverse transcription polymerase chain reaction, microarrays or advanced sequencing are particularly valuable for addressing such tasks especially if the system can be perturbed in an informative way. Such data can also be used to get genome wide understanding of the variation in key biological processes, such as transcription and degradation. In many cases, one is concerned with better understood systems, such as the circadian clock or cell cycle, where relatively sophisticated models exist. In these cases, it is of interest to uncover both new connections and deeper details of the regulatory interactions. However, when studying systems where there is a much lower density of understanding, one is relatively satisfied with gaining information on the likelihood of the existence of a regulatory interaction or the importance of a regulatory mechanism. Almost all examples studying the response dynamics when systems are subjected to perturbations, such as drug dosing () or stress (), or where the progression of disease is studied () fall into this latter category. Analysis of genome wide time series gene expression data typically involves a number of tasks to parse the time series into groups using various criteria, identify differential expression, select smaller sets of genes for comparative analysis, identify molecular signatures and common regulatory elements, sort the data to identify processes active at certain times and apply network reconstruction algorithms to identify regulatory interactions. One is, therefore, interested in computational approaches to check the similarity or difference in time series expression between genes and conditions. Many techniques for analysing expression profiles have been used for overviews], such as hidden Markov models (), spline functions () and clustering (). Unfortunately, however, it is relatively rare that, in terms of specific molecular mechanisms, there is much common regulation found across the clusters produced by such methods. This is perhaps less surprising when one notes that the temporal profile of gene expression depends on several processes, such as transcription, degradation and splicing, and that similar profiles can be produced from different combinations of these processes. In particular, the amount of mRNA for a particular gene is the balance between its synthesis and degradation at any point in time. It would, therefore, be helpful if one could identify the effect of these different processes from the data. This requires the development of algorithms to provide more mechanistic insight by combining time course expression data with parametric models of gene expression, and there has been some progress in this direction. Relatively sophisticated methods often using stochastic simulation have been developed for extracting parameter estimates from high resolution time series data (). However, these approaches are geared towards modelling the intrinsic noise associated with the birth and death *To whom correspondence should be addressed y The authors wish it to be known that, in their opinion, the first two authors should be regarded as joint First Authors. processes of molecules in single cells and are less suitable for aggregate mRNA data arising from microarray and sequencing experiments. Recently, a flexible parametric model for the response of gene expression to environmental perturbations has been introduced in Chechik and Koller (2009) and can be used in this context. Applying it to gene expression time courses in Saccharomyces cerevisiae after diverse environmental perturbations they show that their model, which is based on the product of two sigmoid functions and thus can capture exactly two transitions in the response dynamics, constitutes an improvement over other general functional forms, i.e. polynomials. However, although the magnitude and the timing of the response arise as meaningful parameters, their model is not directly connected to mechanism and is still not general enough to explain a wider range of possible dynamic pattern observed in gene expression, including oscillations. Consequently, there is a need not only to decouple transcriptional from degradation processes but also to model general forms of transcription in a way that is compatible with the demands imposed by the quality, time resolution and quantity of the data. In particular, the ability to handle an arbitrary number of transitions where the transcription rate is changed and to infer the number and types of these transitions from such data would clearly be an extremely desirable feature. In this article, we propose an ordinary differential equation model (ODE) model that addresses these issues and at the same time can be effectively fitted to data with sufficient computational efficiency to enable one to handle many genes. It is based on a simple dynamical model of mRNA synthesis and degradation, where transcriptional activity can 'switch' between an arbitrary number of states. The timing and number of transitions, or 'switches', can be estimated efficiently alongside mRNA stability with the help of a reversible jump Markov chain Monte Carlo rj mcmc estimation algorithm (). Multiple change point or switching models have previously been applied to biological systems, such as inferring transcription factor interactions (), modelling negative feedback in circadian clocks () and reconstructing unobserved gene expression dynamics (). However, these models have so far only supported binary expression dynamics, which are not general enough to capture expression dynamics with multiple steady state expression levels. The structure of the article is as follows. We first introduce the modelling approach and estimation algorithm. The performance of the algorithm has been studied extensively for artificial data (Supplementary Section 'Simulation study'). To demonstrate the methodology and its potential further uses, we focus on modelling the wild type behaviour of a set of 200 chosen oscillatory expressed genes of the model plant Arabidopsis thaliana. The approach allows us to investigate whether genes with similar switch event times also have correlated promoter motifs. Furthermore, we introduce a Bayesian hierarchical approach to pool data from several experiments and present results for estimation of mRNA stability. The example datasets consist of time series from three experiments (called E1, E2 and E3) of varying timescales and sampling regimes under some mock treatment conditions (see Supplementary. Here, we focus on a subset of 200 oscillatory genes (chosen according to their correlation to a sine function for the expression data from E1). The set includes a number of 'core' circadian clock genes (such as LHY, AT1G01060; CCA1, AT2G46830; to c1 AT5G61380). A list of the 200 genes can be found in Supplementary Table S1.

discussion the aim of this article is to present a novel approach for identifying timing of transcriptional activity from time series mRNA expression data. The model introduced here consists of a piecewise linear simple ODE model of mRNA dynamics, which can be fitted efficiently with a rj mcmc sampler to estimate gene specific parameters, i.e. mRNA stability and number and times of switches in transcriptional activity. Estimation and performance of the algorithm is investigated for synthetic data of varying sampling frequencies and noise levels in a simulation study. With the example of time series microarray data from 200 circadian genes, further directions are explored exploiting different aspects of the model output. Namely, using the timing of the switches as a basis for clustering, which, when combined with promoter motif data, seems to identify more significant groups of motifs than simple profile clustering with promoter motif data, potentially implying a stronger correlation with regulatory mechanisms. We also explore the potential for the estimation of mRNA degradation rates. Usually, degradation rate studies involve treatment with a transcriptional inhibitor, such as actinomycin D, or translational inhibitor, such as cycloheximide. It is not clear whether such inhibition is ever achieved fully and whether such treatments have undesired side effects on degradation, and may, therefore, impact on estimated rates in unpredictable ways. The model introduced in this study has several advantages over a transcription inhibition study. The primary advantage is that a specific experiment does not have to be designed and performed, often at great cost in time and resources, to produce a suitable dataset for degradation estimation, effectively allowing recycling of existing datasets further increasing their potential scientific value. As only free running mRNA expression dynamics are required, potential side effects introduced by using a chemical inhibitor can be avoided. We demonstrate how to pool data from several experiments in a theoretically rigorous way with a Bayesian hierarchical model. Degradation estimates can easily be obtained for suitably resolved time series and can be compared between different experimental conditions. As the number of large high resolution gene expression time series datasets publicly available is likely to increase with the development of cheaper and faster high throughput technologies, new methods are required to analyse these data. The model proposed here is mechanistic yet is flexible and rich enough to capture a wide range of expression dynamics observed in mRNA time series data, from steady state behaviour to oscillatory expression. At the same time, it is simple enough to be estimated with feasible computational time for thousands of genes. Using a mechanistic model to identify transcriptional switch points is likely to strongly contribute to efforts in elucidating and understanding regulatory interactions within transcriptional networks.
