Motivation: Tandem mass spectrometry (MS/MS) is a dominant approach for large scale high throughput post-translational modification (PTM) profiling. Although current state of the art blind PTM spectral analysis algorithms can predict thousands of modified peptides (PTM predictions) in an MS/MS experiment, a significant percentage of these predictions have inaccurate modification mass estimates and false modification site assignments. This problem can be addressed by post-processing the PTM predictions with a PTM refinement algorithm. We developed a novel PTM refinement algorithm, ip tmc lust which extends a recently introduced PTM refinement algorithm ptmc lust and uses a non-parametric Bayesian model to better account for uncertainties in the quantity and identity of PTMs in the input data. The use of this new modeling approach enables ip tmc lust to provide a confidence score per modification site that allows fine tuning and interpreting resulting PTM predictions. Results: The primary goal behind ip tmc lust is to improve the quality of the PTM predictions. First, to demonstrate that ip tmc lust produces sensible and accurate cluster assignments, we compare it with k means clustering, mixtures of Gaussians (MOG) and ptmc lust on a synthetically generated PTM dataset. Second, in two separate benchmark experiments using PTM data taken from a phosphopeptide and a yeast proteome study, we show that ip tmc lust outperforms state of the art PTM prediction and refinement algorithms, including ptmc lust. Finally, we illustrate the general applicability of our new approach on a set of human chromatin protein complex data, where we are able to identify putative novel modified peptides and modification sites that may be involved in the formation and regulation of protein complexes. Our method facilitates accurate PTM profiling, which is an important step in understanding the mechanisms behind many biological processes and should be an integral part of any proteomic study. Availability: Our algorithm is implemented in Java and is freely available for academic use from http://genes.

introduction posttranslational modifications (PTMs) are known to play a vital role in the cell and are instrumental in many disease related studies (). A core task in studies involving PTMs is PTM prediction, i.e. identification of peptide sequences and PTMs associated with each modified peptide within a biological sample. A preferred experimental procedure for PTM prediction is tandem mass spectrometry (MS/MS) followed by an analysis with a 'blind' PTM search engine. [See () for reviews]. Blind PTM search engines are commonly used because they can detect both known and novel PTMs. However, PTM predictions produced by blind PTM search engines contain inaccurate modification masses and incorrect modification positions (). The fragmentation process is often incomplete and the presence of labile PTMs may interfere with this process (). These issues result in spectra missing peaks that in turn may lead to ambiguous or erroneous modification predictions. Naturally occurring stable isotopes, such as carbon 13 and electronic noise contribute to inaccurate mass measurements. These issues are more prominent in spectra generated from low mass resolution spectrometers (e.g. ion trap mass spectrometers), which are still commonly used in to days MS studies. Therefore, it is prudent to incorporate PTM refinement as part of a PTM prediction pipeline, as it can significantly improve the quality of PTM predictions. Previous studies demonstrate that post-processing greatly improves the number of positive predictions while reducing the amount of false PTM assignments (). PTM refinement can be classified into two types of approach: one that scores the localization of PTMs and one that refines observed modification masses and modification positions. The first type provides a way to evaluate the quality of predicted modification sites from PTM search engines. The two main strategies for scoring the reliability of modification site localizations are: (i) to calculate the probability that a peak responsible for the site determination is matched at random and (ii) to compute the search engine score difference between predictions with varying site localizations. Methods that use the former strategy include a score (), PTM Score (embedded in max quant and Andromeda) (), the *To whom correspondence should be addressed.  The Author 2013. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals permission soup com Phosphorylation Localization Score (PLS) in InsPecT (), s lomo (), phos phin at or (), PhosphoRS (). Examples of the latter scoring strategy are Mascot Delta Score (), the site localization in peptide (SLIP) score in Protein Prospector () and the variable modification localization score in Spectrum Mill (). A review of the different modification site scoring localization methods is provided in (). PTM refinement using a modification site localization scoring algorithm can be achieved by reassigning the modification position to the highest scoring position for each modified peptide. However, modification site localization scoring methods are limited when used for general PTM refinement owing to the following three reasons. First, a predefined list of PTMs is required for these scoring methods. Second, these scoring methods assume that input predicted modification masses are error free and are mapped precisely to one of the PTMs in the predefined list. Lastly, most of these scoring methods are designed to score only phosphorylated predictions. Consequently, modification site localization scoring methods are ill suited to analyze PTM datasets generated from blind PTM search engines. The second type of PTM refinement approach is to refine both observed modification masses and modification positions. Two recently published algorithms that use this type of PTM refinement method are ptm finder () and our previous algorithm, ptmc lust (). ptm finder takes a peptide level approach to PTM refinement, where it groups and re analyzes spectra mapping to the same modified peptide sequence to produce for each spectrum a final peptide sequence with a modification mass and a modification position. Hence, refinement using this method is limited to modified peptides that occur multiple times in the same dataset. As shown in a recent study, a modified peptide is rarely found more than three times even for a large scale genome wide experiment (). Furthermore, ptm finder suffers from favoring high abundance modified peptides and discretizing observed modification masses. In contrast, ptmc lust accounts for errors of the observed modification masses and modification positions at the PTM level, and overcomes several issues that ptm finder has. The principle behind, and the distinguishing feature of, ptmc lust is modeling modifications at the PTM level instead of at the peptide level. While peptide level modeling can benefit from correcting low level errors, the ptmc lust approach has the advantage of accounting for low abundance modified peptides because other peptides with the same underlying PTM can help identify the correct but unknown modification mass and modified amino acid. ptmc lust uses a generative model to capture the hidden relationship between factors influencing the PTM mapping process. It uses the expectation maximization (EM) algorithm and a modified version of the split and merge model selection method to learn and infer an optimal parameter setting for the model. As part of the model selection procedure, a range of models are learned by adjusting a model complexity parameter, and the final model is selected by weighting the trade-off between false positives (determined using decoy peptides) and correct (real) peptides detected. The resulting PTM predictions are of higher quality than those taken from existing blind PTM search engines alone and those post analyzed with ptm finder (). Here, we address some limitations of ptmc lust (i) the use of a greedy method for selecting the number of PTM clusters, (ii) the need for manual parameter tuning, and (iii) the lack of a confidence score per modification position. We overcame these limitations by extending the ptmc lust model to allow for an unbounded number of mixture components that can account for uncertainties in the quantity and identity of PTMs in the input data. The model makes use of an infinite non-parametric mixture model, so we refer to it as infinite ptmc lust or ip tmc lust. This extension parallels the conversion from a finite to an infinite standard mixture model (IMM), but the complex nature of the underlying ptmc lust model makes this extension non-trivial. We derived and implemented a Gibbs sampling algorithm () and a split and merge metropolis hastings algorithm (), which enable ip tmc lust to efficiently infer the groupings of input modified peptides and refine the peptides' modification masses and modification positions. ip tmc lust achieves the following benefits: (i) it outperforms ptmc lust and other PTM refinement algorithms, (ii) it provides a more highly automated model selection method that does not require manual parameter tuning, and (iii) it outputs modification position level confidence scores that users can use to assess the quality of the result and further refine their analyses. In a series of benchmark experiments on both synthetic and real world phosphopeptide datasets, we show that ip tmc lust outperforms ptmc lust and other state of the art PTM prediction and PTM refinement algorithms. To ensure broad applicability, we have designed and optimized ip tmc lust to analyze PTM data generated from both low and high resolution MS/MS spectra processed by popular blind PTM search engines. As with ptmc lust the input to ip tmc lust is a list of PTM predictions consisting of the peptide sequence, modification position and modification mass.

conclusion accurately identifying PTMs and their potential roles in clinical studies such as biomarker discovery and drug development is an important task. Although thousands of PTM candidates have been reported using blind PTM search engines (), these blind PTM search algorithms suffer from mass measurement inaccuracy and uncertainty in predicting modification positions, making the findings error prone. The importance of post-processing PTM predictions using a PTM refinement algorithm have been established in (). The previous state of the art algorithm, ptmc lust achieves a significantly higher PTM prediction accuracy over blind PTM search engines alone and outperforms existing PTM refinement algorithm, ptm finder. Despite significant improvements in PTM prediction, ptmc lust has three main drawbacks of particular interest: (i) it uses of a greedy based non automatic model selection algorithm, (ii) it requires manual parameterization on the maximum number of PTM groups and (iii) it does not provide a confidence score per modification position. To address these issues, we introduce ip tmc lust. ip tmc lust extends ptmc lust by using an infinite mixture model approach that achieves the following three benefits: (i) outperforming ptmc lust and other PTM refinement algorithms, (ii) providing a fully automated model selection method without the need for any manual parameterization, and (iii) offering modification position level confidence scores that users can use to assess the quality of the results and to greater refine their analyses. Through a series of benchmark experiments using both synthetic and real (phosphopeptides and yeast proteome) data, we demonstrated that ip tmc lust better models the PTM generative process and outperforms ptmc lust ptm finder and other blind PTM search engines. In addition, we analyzed data generated from a yeast proteome study using ip tmc lust in which we reported an improvement over the base blind PTM search algorithm SIMS in detecting annotated PTMs. Thousands of putative PTMs were found in this analysis. Moreover, in our in depth look at PTM predictions for three human protein complexes, MED, POL2 and PRC1, ip tmc lust identified numerous validated and putative phosphorylated and acetylated peptides that may be involved in the formation and regulation of protein protein interactions. Further investigations are warranted, but we believe a number of these putative predictions are valid PTMs and can serve to further our understanding of the complexities involved in protein protein interactions. To summarize, our new algorithm ip tmc lust is easy to use, achieves overall greater performance than the state of the art provides confidence scores at the modification position level that allow for a higher flexibility when evaluating potential PTMs and is designed to be broadly applicable to PTM predictions generated from any blind PTM search engine. Given the rapid advancement of mass spectrometer technology, how applicable is ip tmc lust going forward? We explore this question by analyzing data generated from high mass resolution mass spectrometers, e.g. from an orbit rap. Although mass accuracy has improved with the use of high mass resolution mass spectrometers, the presence of isotopes, for example, can result in deviations in observed modification masses. In addition, higher mass accuracy does not necessarily equate to errorless modification site determination. We have shown in our analysis of the human protein complex data that problems with mass measurement inaccuracy and uncertainty predicting modification positions continue to exist for data generated from high mass resolution mass spectrometers, such as an orbit rap used in the experiment. Our results demonstrate that ip tmc lust can improve on PTM predictions taken from data with high mass accuracy, and continue to be a vital component of a genome wide PTM study. In designing ip tmc lust we have developed two different inference algorithms, the split merge metropolis hastings and the Gibbs sampling algorithm. While the Gibbs sampling method is the standard inference algorithm for Bayesian mixture models and IMMs, the split merge method is shown to perform better when dealing with complex datasets (). Results of our synthetic data experiments also exhibit this trend. ip tmc lust using the Gibbs sampling method displays a performance drop, while its counterpart using the split merge sampling algorithm perform consistently well as the data used gets more complex. It is important to note that when there are few PTMs within a small modification mass window, say 12 Da (e.g. when two or three PTM groups added in our experiment with the synthetic data), our algorithm using the Gibbs sampling performs at par with or slightly worse than its counterpart using the split merge method. Furthermore, ip tmc lust using the Gibbs sampling runs faster per iteration ($ 50% quicker) than ip tmc lust using the split merge method. Hence, for large datasets, where running time can be overwhelmingly long, we recommend running ip tmc lust with the Gibbs sampling method as it provides a good trade-off between quality of the result and computational cost. Despite outperforming its competitors, ip tmc lust has a number of limitations. Similar to ptmc lust it is unable to handle more than one modification per input peptide sequence, and PTM groups identified can contain multiple PTMs if their modification masses are similar. The latter problem is less of an issue when working with high mass resolution data. Moreover, ip tmc lust does not consider the underlying spectrum when refining a PTM prediction. The presence of certain peaks in the spectrum can add to support to a residue along the peptide sequence as being the modification position. Its limitations notwithstanding, ip tmc lust is shown to outperform both ptmc lust and previous state of the art in our benchmark tests using both synthetic and real world PTM data.
