Motivation: A number of statistical phylogenetic methods have been developed to infer conserved functional sites or regions in proteins. Many methods, e.g. rate 4 site apply the standard phylogenetic models to infer site specific substitution rates and totally ignore the spatial correlation of substitution rates in protein tertiary structures, which may reduce their power to identify conserved functional patches in protein tertiary structures when the sequences used in the analysis are highly similar. The 3D sliding window method has been proposed to infer conserved functional patches in protein tertiary structures, but the window size, which reflects the strength of the spatial correlation, must be predefined and is not inferred from data. We recently developed gp4 rate to solve these problems under the Bayesian framework. Unfortunately, gp4 rate is computationally slow. Here, we present an intuitive web server, func patch to perform a fast approximate Bayesian inference of conserved functional patches in protein tertiary structures. Results: Both simulations and four case studies based on empirical data suggest that func patch is a good approximation to gp4 rate. However, func patch is orders of magnitudes faster than gp4 rate. In addition, simulations suggest that func patch is potentially a useful tool complementary to rate 4 site but the 3D sliding window method is less powerful than func patch and rate 4 site. The functional patches predicted by func patch in the four case studies are supported by experimental evidence, which corroborates the usefulness of func patch. Availability and implementation: The software func patch is freely available at the web site, http://info.mcmaster.ca/yifei/FuncPatch

introduction because of the fast development of sequencing techniques, the amount of sequence data is increasing exponentially. The best ways to extract biological insights from massive sequence data have become important questions in biology. Comparisons between homologous sequences from different species are very common strategies to analyze biological sequences. For example, given a set of homologous protein sequences from different species, we can compare these sequences to identify conserved amino acid sites. These conserved amino acid sites are more likely to be functionally important, since mutations at these sites are more likely to be deleterious. To infer the conservation levels of amino acid sites, we need evolutionary models to describe the substitution process of amino acids in the evolutionary history. The simplest idea is to use the standard statistical phylogenetic models () to infer the site specific substitution rates and the sites with low substitution rates may be considered to be functional. For example, a widely used web server, con surf (), uses the site specific substitution rates estimated by the rate 4 site program () to infer the conservation levels of amino acid sites. Then, the conservation scores are mapped onto the protein tertiary structure to get insights on the possible functions of the highly conserved sites (). While the standard phylogenetic models are useful tools for inferring conserved sites in proteins, they typically model the substitution rate variation by some discretized distributions, e.g. the discretized Gamma distribution (), and ignore the spatial correlation of substitution rates in protein tertiary structures. However, it is well known that functional amino acids are clustered together in protein tertiary structures in many proteins and modeling the spatial clustering can improve the prediction of functional sites (). The independence assumption of site specific substitution rates in the standard phylogenetic methods may make it difficult to infer conserved functional patches in protein tertiary structures. The problem is especially acute when the sequences used in the analysis are very similar to each other, because it is difficult to estimate site specific substitution rates accurately in this scenario due to the limited information at each amino acid site. A few methods have been proposed to relax the independence assumption of site specific substitution rates to predict conserved protein patches in protein tertiary structures (). These methods are useful tools for inferring conserved protein patches, especially when the sequences in the dataset are highly similar. However, most of these methods are based on the 3D sliding window framework () or other heuristic algorithms (). The common problem of these methods is that they can not infer the strength of the spatial correlation of substitution rates, which in turn makes the inference of site specific substitution rates unreliable. For example, the window *To whom correspondence should be addressed.

discussion recently we developed gp4 rate a phylogenetic Gaussian process model which combines statistical phylogenetics and Gaussian processes to infer conserved functional regions in protein tertiary structures (). Our previous study has already shown that gp4 rate is a powerful method to infer conserved functional regions and is potentially a useful complementary to rate 4 site but gp4 rate is a slow MCMC program. In this study, we present a new statistical method, func patch which is designed as a fast approximation to gp4 rate. While it takes from hours to days for gp4 rate to analyze a protein family, func patch can finish a similar analysis within a few minutes. An intuitive web based graphical interface of func patch is available and makes it more accessible to experimental biologists. Both simulations and four case studies suggest that func patch is an accurate approximation to gp4 rate. The simulations also show that func patch may be a useful complementary to rate 4 site but the 3D sliding window method typically leads to bad results. The conserved patches predicted by func patch in the four case studies are supported by experimental evidence. Therefore, we believe func patch is a useful tool for analyzing protein families and guiding mutagenesis experiments. Unlike many other alternative methods, e.g. the 3D sliding window method, func patch uses a Gaussian prior distribution which naturally captures the spatial correlation of substitution rates in protein tertiary structures. Therefore, it can infer the strength of the spatial correlation of substitution rates. In addition, a Bayesian model comparison method has been implemented in func patch to test whether the spatial correlation of substitution rates is significant in a dataset. The four case studies of empirical data suggest that the strength of the spatial correlation may vary in different protein families and our preliminary analyses on a few other protein families also suggest that the spatial correlation of substitution rates may be insignificant in some protein families (data not shown). We believe that the ability of inferring the strength and significance of the spatial correlation of substitution rates is a significant advantage of func patch over the 3D sliding window method. Our case studies in this work focus on four empirical datasets in which the divergence levels of sequences are relatively low. However, it is by no means the case that func patch can not be used to analyze datasets in which the sequence divergence level is high. As shown in the Supplementary Material, the site specific substitution rates estimated by func patch are strongly correlated with the rates estimated by rate 4 site in two large gene families each of which consists of highly diverged sequences. Together with the results in simulations, it seems that func patch and rate 4 site typically give similar results when the sequence divergence levels are high. In practice, it is always helpful to include more sequences in the analyses, if it is believed that the sequences share the same conserved patches. However, functional divergence may happen after gene duplication (). Therefore, including remote homologs may reduce the power of detecting functional patches unique to an orthologous family. If researchers believe that a family of orthologous genes has distinct biological functions from its remote homologs, it is beneficial to infer conserved patches solely based on the family itself. The traditional methods, e.g. rate 4 site may not be very powerful in this scenario because of the limited information about the substitution rate at each site. func patch may alleviate the problem, because the Gaussian process prior used in func patch can let an amino acid site to borrow statistical strength from neighboring sites with similar substitution rates. Therefore, func patch is particularly useful for analyzing small gene families or gene subfamilies derived from recent gene duplication events.
