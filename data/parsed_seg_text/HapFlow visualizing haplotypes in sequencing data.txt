hap flow is a python application for visualizing haplotypes present in sequencing data. It identifies variant profiles present and reads and creates an abstract visual representation of these profiles to make haplotypes easier to identify. Availability and implementation: hap flow is freely available (under a GPL license) for download (for Mac OS X, Unix and Microsoft Windows) from git hub
introduction the emergence of high throughput sequencing has enabled new experimental approaches such as the sequencing of populations of bacteria. Infections frequently contain multiple strains of the same species (). This has important implications for detecting transmission events () and determining treatment outcomes (). Several methods have been developed to analyze mixed strain populations. shor ah () reconstructs a minimal set of global haplotypes and estimates the frequency of inferred haplotypes. It requires variants be dense enough to be linked by overlapping reads. A two step maximum likelihood approach has also been described to identify the portion of infection rising from dominant and minor strains (). This approach does not rely on variant density but is unable to infer local or global haplotypes. A tool that visualizes haplotypes in sequencing data is needed to identify the best strategy for genomic analysis of multiple strains of the same bacteria within a sample. Many excellent read alignment visualization tools exist including Savant (), Tablet () and cons ed (). These tools arrange reads in a linear fashion with each read represented as a line, or row of bases. This layout is satisfactory for identifying variants or misaligned reads, however, is not ideal for identifying haplotypes present in reads. Reads are packed tightly together making it difficult to determine whether distant variants are located on the same read pair. Additionally, reads are not grouped by haplotype making it difficult to identify how frequently a haplotype is represented in the sequencing data. hap flow addresses these problem by abstracting read alignment data to make the haplotypes present easier to identify. hap flow can be used to help identify sequencing artifacts, identify the minimum number of strains present in a sample and determine whether defining local or global haplotypes is possible using sequence data alone. file, where each 'flow' is a unique allele profile and a count of the reads with that profile. Flows are then assigned to groups. If all overlapping alleles of a flow are in consensus with a previously defined group, it is assigned to that group. Otherwise, it is assigned a new group number. These groups are used to colour flows when visualized. When multiple chromosomes are present in a BAM file, the user is prompted to select which chromosome to create a flow file for. A complete description of the flow file is included in the manual. hap flow viewer displays the created flow file on the canvas of the GUI. A blue bar at the top of the screen represents the genome, an orange rectangle within the blue bar represents the portion of the genome currently being displayed. Underneath, an orange bar with vertical lines represents where the variants are located within the displayed section of the genome. These lines are extended below and spaced an equal distance apart in the area where the flows are viewed. At each variant, each flow covering the given variant is represented by an arrow, with the width of the arrow representing the number of reads the flow contains. The arrows representing each flow at adjacent variants are joined by lines, with solid lines representing variants covered by the same read of the flow and dashed lines representing variants covered by different reads in the pair. Arrows grouped at the top of the canvas represent the most frequently observed allele, the second group of flows represents the second most common allele and so on. The last group represents alleles not identified in the VCF file. This can be caused by potential sequencing, alignment or variant calling errors. All flows in a group are coloured using the same hue; saturation and lightness are randomly assigned. Information about the sequence of each variant is represented underneath the flows. The canvas is scrollable and zoomable allowing the user to easily navigate through whole genomes. Reads can then be separated into individual BAM files by selecting individual flows or group of flows, or by selecting all reads that conform to a user defined haplotype profile.
