Motivation: A knowledge of the dynamics of transcription factors is fundamental to understand the transcriptional regulation mechanism. Nowadays, an experimental measure of transcription factor activities in vivo represents a challenge. Several methods have been developed to infer these activities from easily measurable quantities such as mRNA expression of target genes. A limitation of these methods is represented by the fact that they rely on very simple single layer structures, typically consisting of one or more transcription factors regulating a number of target genes. Results: We present a novel statistical inference methodology to reverse engineer the dynamics of transcription factors in hierarchical network motifs such as feed-forward loops. The approach we present is based on a continuous time representation of the system where the high level master transcription factor is represented as a two state Markov jump process driving a system of differential equations. We solve the inference problem using an efficient variational approach and demonstrate our method on simulated data and two real datasets. The results on real data show that the predictions of our approach can capture biological behaviours in a more effective way than single layer models of transcription, and can lead to novel biological insights.

introduction unraveling the regulation mechanisms of gene expression is a fundamental problem in systems biology. Recent years have seen tremendous advances towards this goal, driven by technological advances in experimental techniques as well as a systematic application of mathematical modelling. high throughput techniques, such as microarrays and chromatin immunoprecipitation (ChIP), have uncovered much important information on gene expression profiles and the architecture of biological transcriptional networks. Combining this information in predictive mathematical models can yield precious insights in the way biological systems work. Nonetheless, in order to understand and predict mechanistically the behaviour of a transcriptional control system, * To whom correspondence should be addressed. an understanding of the dynamics of transcription factors' (TFs) response to environmental signals is essential. Nowadays, an experimental measure of TFs activities represents a challenge, since TFs are often present at very low concentrations and they are frequently post transcriptionally regulated through allosteric changes. This motivated many groups to develop quantitative statistical models in order to infer activities of TFs by combining mRNA expression measurements of their target genes with data about the architecture of the regulatory network, usually obtained from chip on chip experiments. Broadly speaking, two different classes of approach have been proposed: simplified models of large transcriptional networks and detailed kinetic models of small subnetworks. The first type of models are usually discrete time models that use log linear approximations to infer the activities of hundreds of TFs from thousands of target genes (). While recent advances () can model non-linear interactions between transcription factors on a genome wide scale, these models are still unable to capture the dynamics of gene expression, and rely on steady state assumptions. While these models do provide useful insights in biological processes (), their simplified nature means that many of the subtleties of regulation will inevitably be lost. The other class of approaches, to which this work belongs, adopts a more realistic model of the dynamics of transcriptional regulation based on ordinary differential equations (ODEs) and then infers the profile of the TFs directly from a continuous time representation of the system. This more faithful representation of the regulatory mechanism, however, comes at a higher computational cost so that inference in this class of models has so far been possible only on restricted transcriptional networks with simple single layer architectures. In particular, all methods we are aware of consider simple networks with a single layer of unobserved TFs. In most cases, inference is restricted to the single input module (SIM) network motif, which is composed of a number of target genes regulated by a single TF () or at most a few TFs that jointly regulate a number of target genes (). While these simple models constitute a strong proof of principle of the methodology, and may indeed be useful in specific situations (), many important information processing functions in cells are carried out through hierarchical motifs which entail multiple stages of transcriptional regulation. In this article, we present an ode based inference methodology for the most fundamental hierarchical transcriptional network
