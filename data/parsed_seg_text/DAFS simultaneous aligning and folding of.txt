Motivation: It is well known that the accuracy of RNA secondary structure prediction from a single sequence is limited, and thus a comparative approach that predicts a common secondary structure from aligned sequences is a better choice if homologous sequences with reliable alignments are available. However, correct secondary structure information is needed to produce reliable alignments of RNA sequences. To tackle this dilemma, we require a fast and accurate aligner that takes structural information into consideration to yield reliable structural alignments, which are suitable for common secondary structure prediction. Results: We develop DAFS, a novel algorithm that simultaneously aligns and folds RNA sequences based on maximizing expected accuracy of a predicted common secondary structure and its alignment. DAFS decomposes the pairwise structural alignment problem into two independent secondary structure prediction problems and one pairwise (non-structural) alignment problem by the dual decomposition technique, and maintains the consistency of a pairwise structural alignment by imposing penalties on inconsistent base pairs and alignment columns that are iteratively updated. Furthermore, we extend DAFS to consider pseudo knots in RNA structural alignments by integrating ip knot for predicting a pseudo knotted structure. The experiments on publicly available datasets showed that DAFS can produce reliable structural alignments from unaligned sequences in terms of accuracy of common secondary structure prediction. Availability: The program of DAFS and the datasets are available at

introduction many functional RNAs form secondary structures that are related to their functions such as gene regulation and maturation of mRNAs, rRNAs and tRNAs. Therefore, analysis of RNA secondary structures can lead to unraveling their potential functions. Since experimental determination of RNA secondary structures is expensive and time consuming, computational prediction of RNA secondary structures has been frequently used. The most successful methods for predicting RNA secondary structures from a single sequence are based on minimizing free energy, such as m fold () and rna fold (). Alternative methods are based on probabilistic frameworks including stochastic context free grammars that can model RNA secondary structures without pseudo knots (crossing base pairs on primary sequences). Several computational methods based on stochastic context free grammars have been developed for modeling and analyzing non-coding RNAs (). Nonetheless, the accuracy of RNA secondary structure prediction from a single sequence is known to be limited, and thus, a comparative approach that predicts a common secondary structure from aligned sequences is a better choice if homologous sequences with reliable alignments are available. Comparative methods based on alignment folding include rna ali fold (), p fold (), pet fold () and centroid ali fold (). However, we require correct secondary structure information to produce reliable alignments of RNA sequences in turn, which is a chicken and egg problem. To tackle this dilemma, Sankoff (1985) has proposed a dynamic programing (DP) algorithm for simultaneously aligning and folding RNA sequences whose computational complexity is OL 3N  time and OL 2N  space for N sequences of length L. Since a nave nave implementation of the Sankoff algorithm is impractical because of unrealistic computational complexity, various algorithms have been developed to reduce the computational complexity of the Sankoff algorithm. Several pioneering studies including the first versions of fold align () and dyn align () have implemented restricted Sankoff algorithms; fold align disallows bifurcated structures, and dyn align assumes the maximum distance of aligned nucleotides (note that later versions of both methods do not have such restrictions). Several succeeding methods have reduced the search space of the Sankoff algorithm by *To whom correspondence should be addressed. using precomputed posterior probabilities of base pairs and or aligned columns (). sampling based approaches, instead of reducing the search space, have also been developed (). ziv have proposed a spar sification technique for the Sankoff algorithm that speeds up computation by a linear factor. Although various techniques for reducing the computation time have been developed, the sankoff style algorithms are still computationally expensive. Alternatively, several heuristic based algorithms that do not strictly perform simultaneous aligning and folding of RNA sequences have been proposed such as sequence alignment with a structural scoring function () and stem based alignment (). LARA proposed by formulates the problem of RNA structural alignment as a graph theoretical model for sequence alignment with additional simple structure information. Lagrangian relaxation is applied to relax the constraints for the structure information, then the problem is solved as sequence alignment with iterative updates of penalty scores. Note that LARA was not designed to predict common secondary structures since no folding model is explicitly considered. In this article, we present a novel algorithm DAFS that performs Dual decomposition for Aligning and Folding RNA sequences Simultaneously. First, on the basis of the maximizing expected accuracy me a principle, we design an objective function for a pairwise structural alignment as the expectation of the sum of the numbers of correctly predicted base pairs in a common secondary structure and those of correctly aligned columns in its pairwise alignment. Then, to maximize the objective function under several constraints for consistent pairwise structural alignment, we use the dual decomposition technique, which decomposes the pairwise structural alignment problem into two independent secondary structure prediction problems and one pairwise (non-structural) alignment problem. The algorithm maintains the consistency of a pairwise structural alignment by imposing penalties on inconsistent base pairs and alignment columns, and updates them iteratively by performing the nuss i nov style secondary structure prediction and the needleman wunsch style pairwise alignment with the penalized scoring function. We easily extend the algorithm to perform multiple alignment by applying a standard progressive alignment technique. Furthermore, we integrate the ip knot model () instead of the nuss i nov model so that DAFS can simultaneously align and fold RNA sequences with pseudo knots. Major advantages of DAFS are summarized as follows: (i) DAFS is a fast and accurate implementation that simultaneously aligns and folds RNA sequences. Compared with the other sankoff style algorithms, DAFS achieves comparable accuracy, and even more importantly, runs much faster. Compared with the heuristic based approaches such as sequence alignment with structural scores, DAFS is more accurate, especially in terms of common secondary structure prediction; (ii) DAFS is flexible and extensible because of the dual decomposition, which enables us to integrate state of the art folding models such as the ip knot model for pseudo knotted secondary structures.

discussion we developed a fast and accurate RNA structural aligner called DAFS that simultaneously aligns and folds RNA sequences by dual decomposition. Specifically, our method decomposes the RNA structural alignment problem into three subproblems, then respective problems are solved by simple and efficient algorithms such as the nuss i nov style DP and the Needleman wunsch style DP. This means that DAFS can explicitly take the folding model into account, whereas LARA that has also used Lagrangian relaxation can not. In fact, we showed that the dual decomposition technique enables us to integrate state of the art folding models such as the ip knot model for pseudo knotted structures. This flexibility to adapt the folding models to our algorithm would lead us to further improvement by using an extended secondary structure model such as rna wolf (zu), where base pairing probabilities for extended secondary structures are used. One of the other differences between DAFS and LARA is the scoring system in the objective function. The scoring system of DAFS is based on the me a principle, which has been successfully applied to various problems in bioinformatics (,TIME means the total computation time in seconds measured on a Linux workstation with Intel Xeon E5450 (3.0 GHz). The bold values indicate the best score in each evaluation measure. For all the methods except DAFS, SEN, PPV and MCC, are calculated using common secondary structures predicted by centroid ali fold with default parameters from produced alignments. See Section S4 in Supplementary Material for the results using rna ali fold and intrinsic predictions.). The me a based scoring function not only improves accuracy in prediction but also makes DAFS run fast by the threshold cut technique, which is derived from the IP formulation based on the me a based scoring function described in Section 2.3. The threshold cut technique has also been applied to rac tip () and ip knot (), and has contributed to their accuracy and efficiency. Prediction accuracy of DAFS depends mainly on its scoring functions even though the method uses the approximate probability distribution for RNA structural alignments that assumes independence of alignment and structure. In fact, experimental results shown in Section S5 in Supplementary Material revealed that when we adopted the exact posterior probabilities for RNA structural alignments, a significant improvement was confirmed, though much computation time was spent on the predictions. Considering these results, there is room for further investigation into refinement of the scoring functions that make prediction accuracy compatible with practical running time.
