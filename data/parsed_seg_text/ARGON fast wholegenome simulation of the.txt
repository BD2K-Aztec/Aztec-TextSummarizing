Motivation: Simulation under the coalescent model is ubiquitous in the analysis of genetic data. The rapid growth of real data sets from multiple human populations led to increasing interest in simulating very large sample sizes at whole chromosome scales. When the sample size is large, the coales-cent model becomes an increasingly inaccurate approximation of the discrete time wright fisher model dtw f. Analytical and computational treatment of the dtw f however, is generally harder. Results: We present a simulator (ARGON) for the dtw f process that scales up to hundreds of thousands of samples and whole chromosome lengths, with a time memory performance comparable or superior to currently available methods for coalescent simulation. The simulator supports arbitrary demographic history, migration, Newick tree output, variable mutation recombination rates and gene conversion, and efficiently outputs pairwise identical by descent sharing data.

introduction the coalescent () can be constructed as an approximation of the discrete time wright fisher process dtw f and leads to simplified analytical and computational treatment. Simulators based on the coalescent process (e.g.) have been extensively adopted in computational methods. The coalescent approximation, however, relies on the assumption that the sample size is small compared with the effective population size, and violations of this assumption may result in substantial distortions of key genealogical properties (). Until very recently, coalescent simulators did not scale up to long chromosomes and the very large sample sizes of modern day data sets, which now comprise hundreds of thousands of individuals. The recently developed simulators COSI2 () and s crm () enable fast simulation under approximate coalescent models. The COSI algorithm uses a standard backwards in time approach, while s crm adopts a 'sequential' approach (). Both can be also used to simulate large sample sizes and chromosome long regions under the 'exact' coalescent process with reasonable time and memory requirements. Here, we present ARGON, an efficient simulator of the dtw f process that scales up to very large chromosomes, and hundreds of thou d sands of samples. The simulator offers substantially improved performance compared with recent dtw f simulators, e.g. GENOME (), and is comparable or superior to current coalescent simulators in terms of speed and memory usage. population structure and migration. Each individual is represented as a list of regions for which not all samples have found a common ancestor. Crossover and non crossover recombination events are sampled in genetic space and rounded to the closest phys is cal base pair position based on the desired uniform or variable recombination rate. Whenever a coalescence occurs, regions within individuals are annotated with links to descendant nodes in the ancestral recombination graph (ARG). When compared with other dtw f implementations (e.g. GENOME), ARGON offers substantially improved speed and memory usage (see Supplementary Materials). In ARGON, large regions are represented as intervals with arbitrary boundary values, and hash map data structures are extensively used to take advantage of sparsity, avoiding explicit representation of all individuals. ARGON can run in approximate mode, so that recombinations breakpoints are rounded to blocks of a user specified genetic length, as implemented in the GENOME simulator. This reduces the granularity of the recombination process, improving speed and memory usage, at the cost of slightly inflated correlation of nearby markers. ARGON can efficiently output a list of identical by descent (IBD) segments, which are delimited by the occurrence of recombination events that change the most recent common ancestor for pairs of samples. In ARGON, these events are detected by visiting internal ARG nodes, while previous approaches to output simulated IBD sharing data (e.g.) required comparing recent ancestry for all pairs of individual at each marginal tree.
