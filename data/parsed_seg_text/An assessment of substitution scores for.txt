Motivation: Pairwise protein sequence alignments are generally evaluated using scores defined as the sum of substitution scores for aligning amino acids to one another, and gap scores for aligning runs of amino acids in one sequence to null characters inserted into the other. Protein profiles may be abstracted from multiple alignments of protein sequences, and substitution and gap scores have been generalized to the alignment of such profiles either to single sequences or to other profiles. Although there is widespread agreement on the general form substitution scores should take for profile sequence alignment, little consensus has been reached on how best to construct profileâ€“profile substitution scores, and a large number of these scoring systems have been proposed. Here, we assess a variety of such substitution scores. For this evaluation, given a gold standard set of multiple alignments, we calculate the probability that a profile column yields a higher substitution score when aligned to a related than to an unrelated column. We also generalize this measure to sets of two or three adjacent columns. This simple approach has the advantages that it does not depend primarily upon the gold standard alignment columns with the weakest empirical support, and that it does not need to fit gap and offset costs for use with each substitution score studied. Results: A simple symmetrization of mean profile sequence scores usually performed the best. These were followed closely by several specific scoring systems constructed using a variety of rationales.

introduction protein sequence comparison is fundamental to computational molecular biology. Early work in this field focussed on pairwise sequence alignment, and was then inevitably extended to multiple alignment. Approaches to multiple alignment that generalize dynamic programming to more than two dimensions () are necessarily confined to a small number of sequences, and have therefore found limited applications. Most multiple alignment * To whom correspondence should be addressed. algorithms proceed, in either a progressive or iterative manner, by performing pairwise alignments either between single sequences and multiple alignments or between two multiple alignments (). Closely related subfields concern the extraction of protein 'profiles', or position specific score matrices, from multiple alignments and their comparison either to single sequences () or to one another (;). Central to any protein alignment method is the scoring system; it uses to distinguish among the exponentially large number of alternative alignments. For pairwise sequence comparison, alignment scores are usually constructed as the sum of 'substitution scores' for aligning pairs of letters, and 'gap scores' for aligning runs of letters in one sequence to null characters inserted into the other. In the context of un gapped local alignment, an analytic statistical theory () characterizes all substitution scores as log odds scores, and most popular pairwise substitution scores have been explicitly constructed using the log odds formalism (). Similarly, most extensions of substitution scores to profile sequence comparison now involve log odds scores as well, mediated by position specific amino acid frequencies estimated from a multiple alignment column (). However, for profile profile comparison, there is no consensus on how the alignment of positions or columns from two profiles should be scored, and a large variety of such substitution scores have been proposed. There have been a variety of comparative evaluations of profile profile scoring systems (), some quite systematic and comprehensive. Most of these studies have assessed scoring systems by how well they were able to distinguish by score alignments of related and unrelated profiles, or by how accurately they were able to align related profiles. Several studies () faced the issue of how to choose profileprofile gap scores to use in conjunction with the various substitution scores considered. In addition, they had to 'offset' raw substitution scores so they could be used with equal footing in a local alignment algorithm. They addressed this problem by attempting to optimize, for each scoring system, gap and offset score parameters over a multidimensional space. Here, we take up again the question of comparing profileprofile substitution scores, but propose a new evaluation methodology that avoids the question of how best to select gap and offset parameters. In brief, given a 'gold standard' multiple alignment, we first choose two subsets of sequences from the alignment, and construct a profile from each aligned set. We then simply calculate the probability that a column from one of the profiles has a higher substitution score when aligned to the correct column of the other profile than when aligned to an incorrect column. We generalize this measure by considering two or three adjacent columns from one profile aligned to adjacent columns of the other. We argue below that these measures of scoring system quality are appropriate, and have several advantages to previous measures. Our approach is related to one suggested by Edgar (2004b), but differs in several ways, e.g. in that it does not compare column column scores from different profile pairs. As described below, our approach requires a set of accurate multiple alignments involving fairly large numbers of distantly related proteins. Several multiple alignments sets have been developed for evaluating multiple alignment methodologies, but not all are well suited to our approach, often because their alignments involve too few sequences, or sequences that are on average too closely related. Accordingly, we based our evaluation set of multiple alignments upon a standard database, but supplemented it with carefully curated multiple alignments from several recent publications. We applied our measures of alignment quality to 39 profile profile substitution scoring systems, most of which have previously been proposed in the literature. Although no single scoring system emerged as best in all our tests, variations on the approach of constructing scores as an average of profile sequence scores () consistently outperformed most others. Fairly close behind were 'BILD scores', constructed as a generalization to multiple alignments of pairwise log odds scores (), a weighted and symmetrized form of relative entropy based scores () and co emission based scores (). Incorporating any of these substitution scores into a profileprofile or a multiple alignment program will generally require the introduction of gap scores and perhaps of offset scores. Our evaluation method purposely avoids the consideration of such scores, and the best way to define them may depend upon the substitution scores with which they will be used.
