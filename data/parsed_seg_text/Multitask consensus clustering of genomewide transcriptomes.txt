Motivation: Identifying the shared and pathogen specific components of host transcriptional regulatory programs is important for understanding the principles of regulation of immune response. Recent efforts in systems biology studies of infectious diseases have resulted in a large collection of datasets measuring host transcriptional response to various pathogens. Computational methods to identify and compare gene expression modules across different infections offer a powerful way to identify strain specific and shared components of the regulatory program. An important challenge is to identify statistically robust gene expression modules as well as to reliably detect genes that change their module memberships between infections. Results: We present mul cch (MULti-task spectral Consensus Clustering for Hierarchically related tasks), a consensus extension of a multi-task clustering algorithm to infer high confidence strain specific host response modules under infections from multiple virus strains. On simulated data, mul cch more accurately identifies genes exhibiting pathogen specific patterns compared to non consensus and non multitask clustering approaches. Application of mul cch to mammalian tran-scriptional response to a panel of influenza viruses showed that our method identifies clusters with greater coherence compared to non consensus methods. Further, mul cch derived clusters are enriched for several immune system related processes and regulators. In summary, mul cch provides a reliable module based approach to identify molecular pathways and gene sets characterizing commonality and specificity of host response to viruses of different pathogen i cities. Availability and implementation: The source code is available at https://bitbucket.org/roygroup/

introduction transcriptional regulatory networks play an important role in driving genome wide mRNA levels in dynamic biological processes, such as response to stress or pathogenic infections. Identification of unique and shared components of transcriptional regulatory networks can be useful for designing more sensitive therapeutics or to exploit shared vulnerabilities of the immune system. Recently, compendia of genome wide mRNA levels measuring mammalian host response have become available for multiple related conditions that represent responses to similar types of infections (e.g. different influenza viruses) or from similar diseases (e.g. different respiratory diseases;). Such datasets can be computationally interrogated to identify common and pathogen specific components of transcriptional regulatory networks. Transcriptional regulatory networks exhibit a modular organization, defined by sets of genes that are co-expressed under different environmental conditions (). Thus a module based analysis for each condition, followed by a comparison of module patterns across conditions, can provide a systematic identification of the major patterns of conserved and condition specific transcriptional response between different conditions. Differentially responding genes can be identified as those genes that change their module assignments between conditions. To study condition specific modules and identify genes that switch module assignments, we need a correspondence between modules across multiple conditions, and, be able to identify statistically robust changes in module assignments between conditions. Consensus clustering is an established procedure for improving the robustness of clustering algorithms (), which are typically used for module identification. However, consensus clustering has thus far not been applied to module identification across multiple conditions. A second challenge is that the individual conditions themselves might be related, which if exploited can improve the confidence in detecting shared and context specific patterns (). A third related challenge is that identification of differentially responding genes using module based analysis have typically focused on two conditions (), however, as the number of conditions increase, it is important to find sets of genes that might be induced in a subset of conditions but repressed in another subset. To reliably identify condition specific and common patterns of expression across multiple conditions, such as infection to multiple viruses, we propose MULti-task spectral Consensus Clustering for Hierarchically related tasks mul cch a new consensus clustering extension for existing multi-task clustering algorithms. Multi-task clustering provides a principled machine learning framework to cluster multiple datasets, one from each condition, simultaneously (). Each dataset from a condition is viewed as a separate task, and is clustered separately while information is shared between the tasks. Multi-task extensions have been developed for specific clustering algorithms, including k means () and mixture models (). Multi-task clustering frameworks can provide a correspondence between the clusters across the datasets, making it straightforward to identify gene sets that respond in a conserved manner across the conditions. Here we provide a consensus clustering extension to an existing multi-task clustering algorithm Arboretum, (), which additionally exploits hierarchical relationships among the clustering tasks (Section 2). Arboretum is a Gaussian mixture model based multi-task clustering approach that infers modules of co-expressed genes from multiple gene expression datasets, while incorporating the hierarchical relationships across different conditions. The Arboretum algorithm was originally applied to expression datasets from different species in a phylogeny, but is broadly applicable to multi-task clustering problems that are related by a hierarchy. The consensus clustering component of our approach relies on spectral clustering (), which is applicable for clustering entities related by a graph. We represent an ensemble of multiple clusterings of the same dataset as a weighted graph of genes, with edge weights representing the confidence of gene pairs that are in the same cluster. We compared our method to other existing clustering algorithms using simulated and real expression data. We evaluated the algorithms based on well established measures of cluster quality, as well as new criteria that are important for identifying condition specific (e.g. virus specific and strain specific genes. Based on simulations, we found that mul cch and consensus versions of tested clustering algorithms dominated most other clustering algorithms in terms of cluster quality and ability to accurately detect genes that change module assignments. We applied our approach to measurements of host transcriptional response to influenza virus infections in human Calu-3 cell line and mouse lung samples (). Our results identified modules with common and pathogenicity specific patterns that are associated with various immune response processes. Taken together, our approach provides a systematic way to detect common and condition specific patterns of transcriptional response across multiple conditions, while exploiting known relationships among the conditions.

discussion with our ever increasing ability to profile transcriptional responses from multiple diverse biological contexts different diseases, cell types, or infections the need to identify common and context specific regulatory network components is becoming increasingly important. This is especially a challenge in systems biology studies of infectious disease research where such shared and unique network components can guide common treatment regimens, as well as identify host response aspects that are triggered as a function of strain virulence. To address this challenge, we proposed mul cch a multi-task consensus clustering approach to identify sets of host genes that are co-expressed in a similar manner under infection with multiple viruses, as well as to identify genes that exhibit differential patterns of expression between subsets of virus infections. Application of our approach to human and mouse transcript omic data enabled us to find genes and processes that responded in a virus or pathogenicity specific manner. module based analysis of transcriptional responses is a powerful approach to identify the major patterns of expression during a dynamic process and several approaches have been developed to identify these modules from one condition (). However, when considering multiple labeled conditions, such as the different viruses in our problem, methods that can use existing condition labels while finding gene groups within each condition are needed (). The benefit of multi-task clustering is that it is more likely to find commonalities in cases where an independent clustering might not. A global correlation of profiles of human Calu-3 cell response to different influenza infections showed that one medium pathogenicity virus, NS1trunc124, was not correlated with the other similarly pathogenic viruses (Supplementary). However, using our approach, we were still able to find modules in this virus that significantly overlapped with modules exhibiting the same pattern from other viruses. This suggests that there can be subsets of genes that are correlated despite there being little correlation between genome wide profiles. The ability to reliably detect module transitions for individual genes is extremely important. Because clustering approaches in general are known to be prone to reaching local optima, we used a consensus clustering approach to extract high confidence cluster assignments and cluster transitions. The choice of the consensus clustering algorithm was important and influenced the quality of results. In particular, the spectral method produced better clusters than the hierarchical method as measured by silhouette index. While consensus GMM was able to learn stable clusters, it was not able to identify module transitions reliably, likely because it does not solve the matching problem across strains, which we had to do as a post clustering step. Incorporating the pathogenicity relationships using the hierarchical relatedness approach of the Arboretum framework was useful to identify genes exhibiting patterns of pathogen specificity. Instead of considering all possible types of transitions, we applied our rule based pattern extraction procedure on virus groups defined by pathogenicity subtrees to identify genes that exhibited the same module assignment between the same group of pathogenicity, but differed in module assignment between pathogenicity groups. Most genes that exhibit such patterns are similar among the medium and high pathogen i cities. In this work, we relied on the accuracy of the pathogenicity tree to relate the viruses. One direction of future research is to explore simultaneous learning of modules as well as the tree topologies to relate the different viruses. An alternate route would be to use multitask feature learning approaches (), that do not assume any structure on the tasks and aim to learn most informative features across all tasks simultaneously. Another promising extension to the model would be to integrate different types of omic measurements (e.g. proteomics, transcript omics metabolomics), with appropriate data specific generative models. In conclusion, our consensus based multi clustering approach is a novel and robust approach to identify common and context specific sets of co-expressed genes that can be applied to large numbers of related viruses. As systems biology studies expand to additional viruses, approaches such as ours will be increasingly useful for guiding targeted therapeutics the numbers in each row specify the module in which the process was enriched. Only processes that were enriched in both viruses of a pathogenicity group were considered.
