Motivation: Pathway enrichment analysis has become a key tool for biomedical researchers to gain insight into the underlying biology of differentially expressed genes, proteins and metabolites. It reduces complexity and provides a system level view of changes in cellular activity in response to treatments and or in disease states. Methods that use existing pathway network information have been shown to outperform simpler methods that only take into account pathway membership. However, despite significant progress in understanding the association amongst members of biological pathways, and expansion of data bases containing information about interactions of bio-molecules, the existing network information may be incomplete or inaccurate and is not cell type or disease condition specific. Results: We propose a constrained network estimation framework that combines network estimation based on cell and condition specific high dimensional Omics data with interaction information from existing data bases. The resulting pathway topology information is subsequently used to provide a framework for simultaneous testing of differences in expression levels of pathway members , as well as their interactions. We study the asymptotic properties of the proposed network esti-mator and the test for pathway enrichment, and investigate its small sample performance in simulated and real data settings. Availability and Implementation: The proposed method has been implemented in the r package net gsa available on CRAN.

introduction recent advances in high throughput technologies have transformed biomedical research by enabling comprehensive monitoring of complex biological systems. By profiling the activity of different molecular compartments (genomic, proteomic, meta bolo mic one can delineate complex mechanisms that play key roles in biological processes or the development of distinct phenotypes. These technological advances have thus motivated new methodological developments, most notably the adaptation of systems perspectives to analyze biological systems. Pathway analysis represents a key component in the analysis process and has been used successfully in generating new biological hypotheses, as well as in determining whether specific pathways are associated with particular phenotypes. Examples include analysis of pathways involved in initiation and progression of cancer and other complex diseases (), discovering novel transcriptional effects and co regulated genes (), and understanding the basic biological processes in model organisms (). see for additional examples of applications pathway analysis methods have evolved since the seminal work by. As pointed out in the review article by, earlier techniques such as over-representation analysis (), and gene set analysis (GSA) () treat each pathway as a set of biomolecules. These methods assess whether members of a given pathway have higher than expected levels of activity, either by counting the number of differentially active members, or by also accounting for the relative rankings of pathway members and or the magnitude of their associations with the phenotype. On the other hand, more recent and statistically powerful methods also account for interactions between biomolecules. These interactions are increasingly available from carefully curated biological databases, such as Kyoto Encyclopedia of Genes and Genomes (KEGG,), Reactome (), regulon db () and BioCarta (). A network topology based method that exhibits superior statistical power in identifying differential activity of pathways was proposed in). The network based Gene Set Analysis net gsa method also allows testing for potential changes in the network structure under different experimental or disease conditions. However, it requires a priori knowledge of interactions among pathway members, which, despite rapid progress, remains highly incomplete and occasionally unreliable (see eg and references therein). Moreover, existing network information often determine molecular interactions in the normal state of the cell, and do not provide any insight into condition/ disease specific alterations in interactions amongst components of biological systems. The increased availability of large sets of high dimensional Omics data [e.g. from The Cancer Genome Atlas (TCGA), http://can cer genome nih gov coupled with the development of network estimation techniques based on graphical models () offers the possibility to validate and complement existing network information, and to obtain condition specific estimates of molecular interactions. Such an approach for leveraging existing knowledge to enhance the analysis of low signal to noise biological datasets was advocated in. The first contribution of this article is the development of a method for constrained network estimation from high dimensional data, together with establishing the consistency of the resulting estimate. Estimation of high dimensional networks subject to hard (or soft) constraints on conditional dependence relationships amongst random variables represents a canonical problem in the context of graphical models, and the proposed method for addressing this problem is of independent interest. By incorporating the condition specific network estimates from the proposed method into the net gsa framework, we also provide a rigorous statistical framework for assessing alterations in biological pathways, referred to as differential network biology (). The proposed framework accounts for two sources of uncertainty: the first concerns the reliability of the external information used for constructing the network estimate from data. The second is the variability of the network estimate, which can impact the pathway enrichment testing procedure. We establish that, under certain regularity conditions, consistent estimates of the network can be obtained, leading, in turn, to an asymptotically most power unbiased test for pathway enrichment analysis. Our theoretical analysis also sheds light into the potential improvements in accuracy and power by directly accounting for the amount of reliable external network information. A second objective of this study is to scale up the net gsa estimation algorithm to very large size networks. The main bottleneck in applying the net gsa methodology arises from the estimation of mixed effects linear parameters specifically the variance components for thousands of variables. We develop efficient and stable computational methods for estimation of these parameters based on a profile likelihood approach. In particular, we employ a Cholesky factorization of the covariance matrices to speed up matrix inversions, and use it to develop a stable algorithm based on Newton's method with backtracking line search (: 487) for step size selection. To supply reliable starting points for this algorithm, we further develop an approximate method of moment type estimator. The proposed methods are illustrated on both metabolomics and gene expression data. For mass spectrometry metabolomics profiling one can obtain good quality measurements for a few hundred metabolites that do not provide complete coverage of the underlying biochemical pathways. The small number of metabolites in each pathway and the incomplete coverage of the metabolites particularly hinder the application of over-representation and GSA methods in this setting. In our experience, only topology based pathway enrichment analysis methods, such as net gsa are capable of reliably delineating pathway activity, as illustrated in Section 4. Further, our investigation of previously analyzed gene expression data set on lung and breast cancer provides new useful insights. The remainder of the article is organized as follows. Section 2.1 presents the new method for network estimation under external information constraints and establishes its consistency. Section 2.2 outlines the new computational algorithm for scaling up net gsa as well as the inference procedure for both pathway enrichment and differential network analysis. The performance of the developed methodology is evaluated in Section 3 and is examined on real data sets in Section 4.

discussion this article introduces a constrained partial correlation network estimation method that seamlessly incorporates externally available interaction information for genes and other biomolecules. The end product is a reliable condition specific estimate of the underlying networks. The resulting estimated network structures are then used for network based pathway enrichment analysis. For the purpose of constrained network estimation, one might also try the one step constrained maximum likelihood estimation (a functionality offered in the r package glass o to recover the underlying partial correlation network. However, this one step approach requires sophisticated specification of the tuning parameters at positions for which structural information is available, and can be challenging to implement in practice. Two sources of uncertainty can be identified in the proposed framework: one from the reliability of the external database information in the network estimation procedure and the other from the uncertainty regarding the estimated network itself, as well as how it propagates into the net gsa testing procedure. As discussed in Remark 1, the proposed method can conveniently accommodate the first source of uncertainty by incorporating a non-zero penalty on parameters that are uncertain. Further, as shown in Theorem 2, the proposed test via the extended net gsa framework is asymptotically unbiased and most powerful, given the consistency of the estimated network, and hence accounts for the second source of uncertainty. Nevertheless, in finite samples as the numerical work in the Supplementary Materials Section C illustrates, Type I errors may be slightly off in the presence of numerous errors in the estimated network (either due to misspecification of the external information or lack of samples for accurate estimation). The topic of dealing with network estimation errors and possible ways to address it is discussed in Narayan and Allen (2016). Finally, the current framework of net gsa uses the Cholesky decomposition of the covariance matrix of the underlying network. It is natural to ask whether the order of the variables affects the result of enrichment analysis. In simulations and the real data analyses, we find that the estimated powers p values from net gsa are comparable after permutation of the variables.
