Motivation: meta proteomic analysis allows studying the interplay of organisms or functional groups and has become increasingly popular also for diagnostic purposes. However, difficulties arise owing to the high sequence similarity between related organisms. Further, the state of conservation of proteins between species can be correlated with their expression level, which can lead to significant bias in results and interpretation. These challenges are similar but not identical to the challenges arising in the analysis of meta genomic samples and require specific solutions. Results: We introduce pip asic (peptide intensity weighted proteome abundance similarity correction) as a tool that corrects identification and spectral counting based quantification results using peptide similarity estimation and expression level weighting within a non-negative lasso framework. pip asic has distinct advantages over approaches only regarding unique peptides or aggregating results to the lowest common ancestor, as demonstrated on examples of viral diagnostics and an acid mine drainage dataset. Availability and implementation: pip asic source code is freely available from https://sourceforge.net/projects/pipasic/.

introduction in contrast to classical proteomic approaches, meta proteomics and environmental proteomics studies aim at deciphering the interplay of different organisms contained within an environmental sample (). Throughout the past years, this idea has seen increasing application primarily in three fields: aqueous ecosystems, terrestrial systems and eukaryotic host micro biomes (). In addition, meta proteomic approaches have become of interest also for clinical diagnostics, e.g. for characterizing the state of an infection () or for identifying and strain level typing of bacteria (). Similar to meta genomic approaches (), the analysis of environmental samples and the interplay of organisms offer an enormous potential to further the characterization and understanding of these systems. At the same time, challenges in meta proteomics are manifold and relate to all steps of the analysis. Particularly, this includes the handling of the resulting large and complex datasets of spectra derived from mass spectrometry (MS) experiments and their meaningful comparison with reference proteomes of organisms. It can by no means be generally assumed that this set of references in particular for bacteria or viruses is complete or representative for the given sample (). Depending on the sample of interest, the number of organisms of interest may vary significantly from tens to thousands and more. In all cases, it is non-trivial to identify the correct origin of a spectrum and thereby to allow either the identification of organisms or the quantification of either organisms or key biological processes. While many goals and strategies correlate for meta genomic and meta proteomic approaches, several distinct differences are noteworthy. In meta proteomic approaches, expression levels are analyzed and thus quantitative measures differ even for proteins from a single organism. This can be highly insightful for functional analyses (), but poses an additional challenge for data analysis. Further, while the method is designed to be unbiased, it can not be assumed that all proteins are extracted and captured by MS in a meta proteomics experiment. However, as it is an orthogonal technique to meta genomics meta proteomic and meta genomic approaches have differing error profiles and can jointly provide a much deeper insight than each method on its own (), even in cases such as the quantification of strains when meta genomics is usually preferable owing to lower demands on material and longer sequences. It should be noted that meta proteomic approaches require the availability of reference proteomes or genomes and can not assemble them from a given sample as in meta genome protocols [e.g.. While numerous tools have been introduced for meta genomic data analysis see for an overview), only comparatively few tools exist with focus on the specific difficulties arising in the analysis of meta proteomic data. These cover a broad field ranging from specialized approaches for visualization () to the scalability of database search algorithms () and to meta proteo genomics and the difficulty of identifying a suitable reference database (). One key difficulty that is hindering meta proteomic data analysis is the ambiguity of peptide identifications (). Even more *To whom correspondence should be addressed.

discussion the experiments indicate that pip asic allows the reliable separation of highly similar strains in meta proteomics experiments. It can be used for reliably identifying and quantifying the contributions of organisms and functional units even in cases when as in the cowpox virus data experiment 92 of all expressed tryptic peptides are identical. In particular, pip asic allows having a phylogenetic resolution down to the strain level, which is inherently not feasible for lowest common ancestor approaches for highly related species. This is also clearly visible in the comparison with MEGAN on the cowpox virus strain data (). Given its reliability, pip asic is preferable to approaches relying solely on the analysis of unique peptides indicates the risk of analyzing unique peptides for highly related strains. Even though the overall number of identified peptides per species is above 1000, which is high for a meta proteomic setting, the number of unique peptides remains low owing to the sequence similarity. Thus, only few peptide identifications out of a thousand decide on the identification of a species when relying on unique peptides. The example in highlights the risk: even in cases when the ground truth contains 0% spectra of the Kre strain, MEGAN finds 17 unique peptides; this effect was also observed when using the more conservative om ssa () search engine instead of InsPecT. These may incorrectly be interpreted as proof of the presence of the Kre strain. However, given that the original peptide identification search was conducted at a 5% FDR and given the large number of spectra searched, these identifications are incorrect. Because pip asic leverages the computed similarity and the shared. pip asic similarity matrix with data weighting for the AMD experiment. The matrix entries encode the probability that a peptide in a source proteome can be found in a target proteome, modulated by the meta proteomic data (see Section 2). Here we see that the intra-group matrix coefficients for the Fer and Lepto group are greater than the intergroup coefficients. This means in practice that pip asic corrects abundances within but not between the two groups. It is noteworthy that the matrix coefficients can be asymmetric, which has the effect that abundance can be shifted from one proteome to another rather than correcting both proteomes equally peptides into the analysis, it is less at risk to over value these incorrect identifications and correctly reduces the presence of the Kre strain in this example down to a level where it can not be distinguished from a 0% presence. This example also indicates that the statistical model behind pip asic contains and quantifies uncertainty. A bootstrapping strategy in the abundance estimation step allows us to obtain confidence statements for all estimates, and thereby the definition of cutoffs for diagnostic decisions can be supported by statistical statements. The reliability of an estimate obviously primarily depends on data abundance the number of supporting spectra as well as on the computed and weighted similarity of the species of interest. pip asic computes its similarity correction adjusted to the expression level of proteins. The cowpox virus data experiment clearly indicates the significance of this step for the results. This step highlights a major difference between meta proteomics and meta genomics although the main idea of the meta genomic method could be applied in meta proteomics the method itself must be tuned to the underlying difference in the biological data. The expression level correction should also be applicable and helpful in meta transcript omics settings where also expression level information can be confounded with the state of conservation. Here, we applied the correction only for complete proteomes of species because the number of spectra per species was limited. In large scale experiments, it should also be feasible to adjust for protein groups separately. With regard to quantification, pip asic currently relies exclusively on spectral counts. While we observe positive results for both the expression level correction and the quantification in the cowpox virus experiment, spectral counts have been shown to have limitations with regard to the quantitative range and precision that they cover. Methods combining the intensity of mass spectra with spectral counts, e.g., could in principle be integrated into the pip asic framework and further improve the quantification exactness. One general difficulty for meta proteomics is that all analyses depend on the completeness of the provided reference proteomes because purely de novo peptide identification approaches are not yet sufficiently reliable (). Thus, any quantification or identification by pip asic is also at risk of only reflecting the available reference proteomes. Using an error tolerant peptide search strategy such as BICEPS (), peptides containing up to two amino acid substitutions can be included and thereby this risk can be reduced. pip asic is currently not optimized for large scale datasets and can become computationally expensive because peptide identifications need to be performed separately against all reference proteomes and all pairwise string comparisons need to be computed and accounted for. To overcome this, a two step procedure may be helpful to first identify all species having unique identifications with existing methodology and then to run pip asic on those subsets that are expected to have a high sequence similarity to ensure specificity of results.

conclusion with this contribution, we introduced pip asic as a tool for identification and quantification in meta proteomics. pip asic focuses on correcting observed proteome abundances without having to exclusively assign ambiguous peptide spectrum matches to their correct origin among a potentially large number of reference proteomes. Its particular strength is that it computes the peptide level similarity between reference proteomes and thereby can reliably distinguish on the strain level. Further, pip asic includes the expression level in the analysis and thereby avoids bias resulting from the correlation of conservation and expression in meta proteomics. pip asic is implemented in Python and freely available as an open source project.
