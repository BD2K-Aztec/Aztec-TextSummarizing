Motivation: In high dimensional testing problems p 0 , the proportion of null hypotheses that are true is an important parameter. For discrete test statistics, the P values come from a discrete distribution with finite support and the null distribution may depend on an ancillary statistic such as a table margin that varies among the test statistics. Methods for estimating p 0 developed for continuous test statistics, which depend on a uniform or identical null distribution of P values, may not perform well when applied to discrete testing problems. Results: This article introduces a number of p 0 estimators, the regression and T methods that perform well with discrete test statistics and also assesses how well methods developed for or adapted from continuous tests perform with discrete tests. We demonstrate the usefulness of these estimators in the analysis of high throughput biological rnase q and single nucleotide polymorphism data.

introduction in multiple testing inferential problems, we want to select which among a large number of hypotheses are true. The proportion of truly null hypotheses, p 0 , plays a critical role in adjusting for multiple testing, gives a benchmark for the number of statistically significant tests which should be discovered and is an important measure of effect size (). We assume that m null hypotheses, H 01 ;. .. .. . ; H 0m , are being tested corresponding to m parameters or features. The ith hypothesis is associated with an observed test statistic X i and observed P value p i. A number of methods are available for estimating p 0 when X i and hence p i are continuous (). These methods rely on modeling the mixture distribution arising from the mix of truly null and non-null tests using various parametric and nonparametric approaches (). Let N be the set fi jh i0 is true g. In many cases with continuous response, such as gene expression microarray studies and pixel wise intensity analysis of images, it is reasonable to believe that the distribution of X i is the same for all i 2 N for example, we might perform a t test for each feature and expect the null distribution to be Student's t. Alternatively, we can use p i as the test statistic, in which case the null distribution is Uniform (0,1). Although it is not known which hypotheses are in N , the empirical distribution of the test statistics is a mixture of m 0 observations from the null and m 1  m  m 0 observations from an alternative distribution, so that deviations of the empirical distribution from the known null can be used to estimate p 0 (). For the discrete case, the situation is more complicated. Each X i can take on only a finite number of values, which often depend on an ancillary statistic which varies with i. For example, for Fisher's exact test and other tests of independence in two way tables, the ancillary is a table margin. As a result, even for i 2 N , the distribution with i and the empirical distribution of the observed statistics is a mixture. For example displays P values from simulated gene expression data with p 0  0:8. For each feature (gene), there are two treatments and the null hypothesis is no difference in mean expression level. The P values arising from the null distribution are displayed in gray and the P values arising from the non-null features are stacked in white. The two histograms look very different. In, the P values come from two sample t tests where 20% of the P values come from various non central t distributions. Note the relative uniformity of the null (gray) P values versus the non-null (white) P values, which are skewed toward small values. In contrast displays P values coming from Fisher's exact tests, where 20% of the P values come from various non central hypergeometric distributions. In this case, both the null and non-null P values are highly non-uniform and there is a non-zero probability of yielding a P value equal to 1 under the null and alternative distributions. The differences between continuous and discrete tests are apparent with real data shows P values from real studies differential expression analysis of the primate liver study using rnase q technology with three biological replicates (), used in Section 3.1 and the bovine iron single nucleotide polymorphism (SNP) study (), used in Section 3.2. In this article, we propose new methods for estimating p 0 for discrete tests and compare them to some popular methods developed for continuous data. We also apply these methods to determine the proportion of differentially expressing genes in primate livers and for selecting SNPs associated with bovine muscular iron levels.

discussion there is no clear 'winner' among the p 0 estimators. In part, this is because discrete tests for count data become closer to uniform as the size of the counts increase the regression method requires computing f 0d , the null distribution conditional on the observed values of the ancillary statistic A d for each d. These null distributions have more support points for larger values of A d , adding to the computational burden while providing fewer observations for computing ^ / jt. As well, it may be difficult to compute ^ / jt in studies in which the number of different values of the ancillary is large is also very computationally complex as the number of different null distributions increases. Thus, it also is not an ideal candidate when there is a large number of unique ancillary statistics. Finally, these methods do not extend readily to continuous tests. In contrast, the 'T' methods naturally adapt to higher counts because the filtered features are those with small counts. Hence, as frequencies increase and the P values are closer to continuous, fewer features are filtered and the 'T' method is closer to the continuous method on which it is based. The 'T' methods also adapt naturally to missing data features with missing data are naturally those with smaller counts. As well, in complex studies such as genome wide association studies with continuous response or rnase q studies with biological replication, it is still reasonable to assume that features with small counts will be associated with very low power tests. Hence, the 'T' methods are readily implemented. For these reasons, we recommend the use of 'T' methods except in simple studies with multiple tests with the same ancillary statistic, for which the regression method may be better. Of the three 'T' methods tested here, storey t appears to be most resilient to different types of data, ancillary distributions and sample sizes. It has become common practice in rnase q studies to filter out genes with low total counts; generally, the cut off is selected arbitrarily. For example, the edgeR software () recommends the total for genes retained should be about 100 reads per million detected, while the primate liver paper () dropped genes with median count per sample of 1 or less. The 'T' method suggests a more principled approach select the largest P value for which the investigator would be willing to declare significance and filter out features for which the test statistic has minimum achievable P value which is higher. For 2  2 tables with large margins in one direction such as those generated by rnase q studies, a simple rule of thumb is that the test has zero power at P 0:05 when the minimum margin (total reads for a gene) is 6. For 2  3 tables with large margins in one direction such as those generated by genome wide association studies using SNPs, a simple rule of thumb is that the test has zero power if the sum of the two smallest margins is 5. In many scenarios, tests are not independent. For the rnase q scenario, the primary simulation study was done using independently generated features. We also simulated 1000 runs of rnase q. The 25th percentile of ^ p0 for different estimators for the SNP simulations. (a) p 0 estimates for SNP study with 50 controls 50 treated, m  10 000. (b) p 0 estimates for SNP study with 80 controls 20 treated, m  10 000 data with correlated test statistics and m  1000 tests. The algorithm used to simulate the data is provided in the Supplementary Materials. We found little difference in the performance of the p 0 estimators between the independent tests and the dependent tests; the 'T' methods still performed well overall. For the SNP scenario, the SNPs were simulated in small correlated clusters in the primary study. The results suggest that the p 0 estimators do not require independence of the tests to work well.
