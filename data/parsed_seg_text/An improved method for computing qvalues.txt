Motivation: Asymmetry is frequently observed in the empirical distribution of test statistics that results from the analysis of gene expression experiments. This asymmetry indicates an asymmetry in the distribution of effect sizes. A common method for identifying differentially expressed (DE) genes in a gene expression experiment while controlling false discovery rate (FDR) is Storeys q value method. This method ranks genes based solely on the p values from each gene in the experiment. Results: We propose a method that alters and improves upon the q value method by taking the sign of the test statistics, in addition to the p values into account. Through two simulation studies (one involving independent normal data and one involving microarray data), we show that the proposed method, when compared with the traditional q value method, generally provides a better ranking for genes as well as a higher number of truly DE genes declared to be DE, while still adequately controlling FDR. We illustrate the proposed method by analyzing two microarray datasets, one from an experiment of thale cress seedlings and the other from an experiment of maize leaves. Availability and implementation: The R code and data files for the proposed method and examples are available at Bioinformatics online.

introduction performing tens of thousands of hypothesis tests for one experiment has become a commonplace as technologies for producing high dimensional data are becoming more prominent. This is especially the case in the field of statistical genomics, where technologies such as microarray and rnase q [see Brown and Botstein (1999) or metz ker (2010) for reviews of these measure the abundance of messenger RNA transcripts for thousands of genes in each subject of a gene expression study. Oftentimes, researchers are interested in comparing the gene expressions of subjects from two treatment groups. A major objective of such experiments is to identify genes that exhibit differential expression, i.e. a difference in the population treatment mean expression levels. Meaningful biological results depend on reliable detection of differentially expressed (DE) genes. Hence, the power of detecting differential expression for genes that are truly DE should be as high as possible, whereas genes that are equivalently expressed ee ie. genes that have no difference in the population treatment mean expression levels should have a minimal chance of being declared DE. Thus, we must find an appropriate method for testing multiple hypotheses that provides good power while controlling some multiple testing errors. When considering a traditional multiple testing problem, family wise error rate f wer is often the preferred error rate used to control multiple testing error. The Bonferroni method and Holm's (1979) method are commonly used for this purpose. These methods, however, are not appropriate for high dimensional gene expression data, as controlling f wer results in extremely low power for detection of differential expression. As a consequence, an alternative error rate known as false discovery rate (FDR;) is usually used. FDR is simply the expected proportion of EE genes among all genes declared to be DE, where the proportion is defined to be zero if no genes are declared to be DE. Although FDR allows for more Type I errors than f wer when controlling these different error rates at the same numeric level , the power for detecting differential expression is greatly increased, as discussed in Storey and Tibshirani (2003). A common method for identifying DE genes while controlling FDR in a gene expression experiment is the q value method, first proposed by. The q value for a given gene represents the estimated FDR if the given gene and all genes with smaller q values are declared to be DE. This method estimates FDR based on a set of p values corresponding to m hypothesis tests. As previously mentioned, researchers are often interested in studying gene expression differences between groups of subjects. This is most often accomplished by performing a hypothesis test for a difference in treatment expression means for each gene, converting the p values from the resulting tests to q values and then declaring genes with a q value less than an FDR threshold to be DE. Potentially relevant information that this method does not take into account is the signs of the test statistics shows a histogram of t test statistics from a microarray experiment described in. In this experiment, gene expressions from wild type cells in thale cress seedlings were compared with those from mutant cells shows the distribution of observed test statistics for 22 810 gene. Although it is not visually obvious, there is asymmetry in the distribution of test statistics, as more genes have negative test statistics than positive test statistics, which indicates asymmetry *To whom correspondence should be addressed. in the distribution of effects sizes (i.e. the true differences in gene expression treatment means) as well. We propose a new method for FDR estimation that alters the traditional q value method by separating the two sided p values from an experiment into two subsets of p values based on the sign of the test statistics, and then computing the q values separately for each subset to create a better ranking of the genes with respect to differential expression. Through simulation studies using both independent normally distributed data and real gene expression data, we demonstrate how the proposed method can result in an improved ranking of genes with respect to differential expression over the traditional q value method while still adequately controlling FDR. The rest of the article is organized as follows. Section 2 reviews Storey's (2002) q value method and introduces the proposed method for FDR estimation. Section 3 describes two simulation studies and uses the results of these studies to compare the performances of the proposed method and traditional q value method by looking at the ranking of genes with respect to differential expression, the number of truly DE genes declared to be DE and also how well each method controls FDR. Section 4 presents analysis of two real microarray datasets, both from two sample studies. Section 5 presents an analysis of a three treatment gene expression experiment to illustrate how the proposed method can be generalized. Finally, Section 6 concludes the article with some discussion.

discussion the proposed method for estimating FDR by first estimating 0 using all p values and then analyzing two subsets of p values separately based on the sign of the test statistics has advantages over the traditional q value method when effect sizes are asymmetric. The proposed method was never outperformed by the traditional method in terms of mean pau c or mean S in the two simulation studies, and ranked genes better with respect to differential expression in 17.5% of the simulation settings while adequately controlling FDR. The proposed method performed especially well for simulation settings with the smallest sample size (n = 4). Compared with the traditional method, the proposed method also declared more truly DE genes DE, on average, in 37.1% of simulation settings, and was never outperformed by the traditional method, even in simulation settings with symmetric effect sizes. Similar to the results for pau c the proposed method performed exceptionally well in simulation settings with n = 4. Therefore, we suggest that the proposed method be used to analyze datasets with small sample sizes (n 10) when the distribution of test statistics is asymmetric. Another advantage to the proposed method is that it can be generalized to analyze many gene expression experiments with more than two treatments, especially if the treatments in the experiment can be ordered by factors such as time or dose. Although the criteria used to partition the p values differs depending to the treatment structure, the analysis is very similar once the partitioning has been performed improved q values
