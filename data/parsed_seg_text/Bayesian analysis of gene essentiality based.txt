Motivation: next generation sequencing affords an efficient analysis of transposon insertion libraries, which can be used to identify essential genes in bacteria. To analyse this high resolution data, we present a formal Bayesian framework for estimating the posterior probability of essentiality for each gene, using the extreme value distribution to characterize the statistical significance of the longest region lacking insertions within a gene. We describe a sampling procedure based on the metropolis hastings algorithm to calculate posterior probabilities of essentiality while simultaneously integrating over unknown internal parameters. Results: Using a sequence dataset from a transposon library for Mycobacterium tuberculosis, we show that this Bayesian approach predicts essential genes that correspond well with genes shown to be essential in previous studies. Furthermore, we show that by using the extreme value distribution to characterize genomic regions lacking transposon insertions, this method is capable of identifying essential domains within genes. This approach can be used for analysing trans-poson libraries in other organisms and augmenting essentiality predictions with statistical confidence scores.

introduction transposon mutagenesis is a frequently used laboratory method for determining essential genes in bacterial organisms. Essential genes are those genes necessary for growth under a wide variety of environmental conditions. Knowledge of essential genes is important for the discovery of new antibacterial drugs because these genes are potential targets for inhibitors (). One way of determining essential genes is to identify regions of the genome in which insertional mutations produce non-viable cells. To do this, a high density library of transposon mutants is constructed. The synthetic transposons used in these studies are small fragments of DNA (typically 12 kb), which can be inserted into different locations in the chromosome through the action of a distally encoded transposase enzyme (). For example, derivatives of the Himar1 transposon are widely used and have been characterized to insert at arbitrary TA dinucleotides without any other obvious sequence specificity bias (). The total number of TA sites within a gene often varies $10100 sites depending on gene length and GC content. When a transposon inserts at one of these TA sites within a gene, it presumably disrupts the function of the gene. In a large library of transposon insertion mutants, genes harbouring insertions are presumed to be non-essential. Genes lacking insertions may be essential, as they can not tolerate disruption; however, this depends on the size of gene and degree of saturation of the library (). Typically, 1015% of open reading frames (ORFs) in a bacterial genome are found to be essential (), including genes involved in core metabolism, cell wall biosynthesis, protein translation and DNA replication (all of which are known targets of existing drugs). Differential analysis of essential genes in bacteria passaged through a host could be used to identify genes specifically required for infection (). In the original implementation, the location of transposon insertions in individual mutants was read out via microarray hybridization. A primer extension step, using a primer complimentary to one end of the transposon, was used to amplify the adjacent genomic region, and the relative abundance of these nucleic acid probes was quantified via hybridization to oligonucleotide representing each gene (). Both the resolution and the quantitative accuracy of this method were limited. More recently, use of hybridization to analyse transposon libraries has been replaced by deep sequencing using next generation sequencers, which yield millions of short reads (typically 50100 bp). Mapping of reads amplified from transposon boundaries can give precise coordinates of insertions within the genome (). The high resolution data afforded by deep sequencing present some unique challenges for analysis of gene essentiality. It has previously been observed that even essential genes can tolerate transposon insertions in the extreme N-and c termini of the *To whom correspondence should be addressed.  The Author 2013. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals permission soup com ORF (). Previous analyses have often used an ad hoc criterion, such as exclusion of insertions in the first last 520% of the coding region (). For similar reasons, insertions are sometimes tolerated in linker regions between domains, or one domain but not another of an essential protein (). For example, transposon insertions in the n terminus of Mmpl5 caused attenuation of infection in mouse lungs, whereas insertions in the c terminus did not (). Thus, it is inaccurate to assume that only genes completely lacking transposon insertions are essential. In previous work, we described a novel statistical method for analysing transposon insertion data to characterize the essentiality of genes within an organism (). The method was based on identifying the longest consecutive stretch of TA sites lacking insertions in a gene and estimating the likelihood of such an open region occurring by chance through the extreme value (Gumbel) distribution. This model was based on an analogy to runs of tails in a sequence of coin tosses, where each TA site is viewed as an independent Bernoulli trial given the background insertion frequency in non-essential genes. This analysis was shown to correlate well with previous characterizations of genes essential for in vitro growth of Mycobacterium tuberculosis. The primary advantage of this method is that essentiality is based on statistically significant stretches of TA sites lacking insertions, regardless of the presence of insertions at other regions within the gene. This is in contrast to other models, such as a multinomial model, where the order of insertions is not taken into consideration (), and it may miss regions characteristic of essential domains. One limitation of our previous method is that it depends on an a priori estimate of the insertion frequency in non-essential genes. Although this can be approximated (over all TA sites in the whole genome) or tuned iteratively (by separating out essential genes), a more rigorous statistical treatment is desirable. One possible way to approximate the parameters of this model and find estimates of essentiality is to use the expectation maximization (EM) algorithm. Although the EM algorithm converges relatively quickly, it depends on maximizing the likelihood of the given distribution. This is not feasible for the product of Gumbel distributions, as no closed form expression for the derivative exists. In this article, we present a formal Bayesian analysis of transposon insertion data that simultaneously estimates the likelihood of essentiality for each gene and the non insertion frequency for each class, given in the data. We develop a formula for the joint and conditional densities based on the likelihood for each gene. We describe how to use a metropolis hastings (MH) sampling procedure to estimate the parameters from the data, by sampling from the joint probability densities. This method produces a formal estimate of essentiality for each gene from the posterior probability given the observed insertion data, marginalizing over the unknown insertion frequencies in essential and non-essential genes.
