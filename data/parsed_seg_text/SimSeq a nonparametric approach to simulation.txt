Motivation: RNA sequencing analysis methods are often derived by relying on hypothetical paramet-ric models for read counts that are not likely to be precisely satisfied in practice. Methods are often tested by analyzing data that have been simulated according to the assumed model. This testing strategy can result in an overly optimistic view of the performance of an rnase q analysis method. Results: We develop a data based simulation algorithm for rnase q data. The vector of read counts simulated for a given experimental unit has a joint distribution that closely matches the distribution of a source rnase q dataset provided by the user. We conduct simulation experiments based on the negative binomial distribution and our proposed nonparametric simulation algorithm. We compare performance between the two simulation experiments over a small subset of statistical methods for rnase q analysis available in the literature. We use as a benchmark the ability of a method to control the false discovery rate. Not surprisingly, methods based on paramet-ric modeling assumptions seem to perform better with respect to false discovery rate control when data are simulated from parametric models rather than using our more realistic nonparametric simulation strategy.

introduction over the past decade, new high throughput next generation sequencing technology has become readily available for gene expression profiling of RNA samples. The new next generation sequencing technology has unseated the previous dominance of microarray technology, offering low sequencing costs, more detailed sequencing information and a wider range of signal detection. A main focus in the statistical analysis of an rnase q dataset is the detection of differential expression. A gene is considered to be differentially expressed (DE) across a set of conditions if the mean gene expression level (as measured by rnase q read count) differs among any of the conditions. Otherwise, we say the gene is equivalently expressed (EE) or is a null gene. For the sake of exposition, we assume that the statistical analysis under discussion is on the gene level, though our comments could apply equally well to count datasets involving other genomic features for which counts can be reliably obtained.

discussion the principal differences between the sims eq algorithm for simulating rnase q data and the NB simulations are that the sims eq algorithm makes no parametric distributional assumptions and preserves the complex gene dependence structure of the original dataset. In contrast, the NB method simulates data for each gene independently according to marginal NB distributions. Thus, we should expect methods that are more robust to varying distributional assumptions to be have more similarly between the two simulation methods. Conversely, methods that are less robust to departures from the parametric distributional assumptions on which they are based should perform worse when applied to the sims eq simulated data. Under the sam seq and Voom methods, which are not based on NB assumptions, there is little difference between the two simulation types in terms of average FDP. In contrast, we see substantial differences in FDR control properties across simulation types for the other analysis methods that rely on NB assumptions. The difference in the results between the two simulation approaches in terms of FDR control is important to point out. Some methods that appeared to control FDR or were slightly liberal with respect to FDR control under the NB simulations failed to control FDR under the sims eq simulations. Further, the ranking of each of the methods in terms of FDR control sometimes differed depending on whether NB or the sims eq simulation was used. It is also worth discussing the liberal ness of the DESeq2 and edgeR methods in general. Although other simulation studies have already indicated that both of these methods exhibit liberal ness in FDR control (), our simulation study shows even greater discrepancies between nominal and actual FDR control when these methods are applied to datasets simulated by sims eq from the heterogeneous k irc dataset. When we repeated the simulation study using the bottom ly et al. dataset as the source dataset (for which the NB assumption may be more reasonable), the liberal ness of the two methods decreased, although both methods still remained liberal. Using the additional Cook's distance filtering criteria as implemented in the DESeq2 package reduced the difference in average 4 (and Supplementary Figs. S1 and S2) is the larger variation in simulation results for sims eq compared with the NB simulation method. This larger variation is a consequence of the realistic dependence from gene to gene in data simulated by sims eq. Dependence among genes leads to dependence among P values within each analysis. This dependence among P values leads to greater variation in quantities computed from P values, such as estimates of FDR and sample quantiles of the P values from null genes. Results from NB simulations with independent genes may lead researchers to underestimate the uncertainty in simulation based estimates of FDR. sims eq creates a less optimistic but more accurate picture of the uncertainty that can be expected when analysis methods are applied to real rnase q data. We also compared the performance of the four statistical methods using partial area under the receiver operating characteristic curve pau rocc. pau rocc indicates how well an analysis method rank orders genes from most significant to least significant. The specific value of pau rocc utilized was calculated as the area under the receiver operating characteristic curve for specificity values !0.95. These specificity values correspond to type I error rates no larger than 0.05. pau rocc was neither systematically higher nor systematically lower under the NB simulations over the class of statistical analysis methods studied. A factor to consider when using the sims eq package is the choice of the source dataset. The source datasets used in this article were the k irc dataset from the Cancer Genome Atlas project and the bottom ly et al. dataset. For the k irc dataset, the samples stem from a heterogeneous population crossing diverse factors such as race, gender, age and ethnicity. This is in contrast to the bottom ly et al. dataset that contains homogeneous samples with genetically identical mice. The simulation experiments of Section 6 indicate that there are larger differences in average FDP minus target FDR level between the sims eq simulations and the NB simulations for our source datasets based on a heterogeneous population than for the source dataset based on a more homogeneous population. To investigate the performance of analysis methods on relatively homogeneous observational or experimental units, more homogeneous source datasets should be used. As more large rnase q datasets become publicly available, the number and variety of source dataset options will increase. In conclusion, important performance benchmarks such as average FDP relative to nominal FDR can change drastically between the two simulation procedures depending on the statistical method used. The sims eq algorithm simulates rnase q data that closely matches the marginal distributions and complex dependence structure of real rnase q data. Simulation studies using this method more accurately reflect average f dps likely to be obtained in practice. Simulation experiments that rely on parametric models may paint an overly optimistic picture for the efficacy of a given method. As such, in evaluating current and future statistical methodologies in gene expression analysis, we recommend using the sims eq algorithm because it more closely matches the complex structure of rnase q data.
