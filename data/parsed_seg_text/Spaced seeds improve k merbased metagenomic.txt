Motivation: meta genomics is a powerful approach to study genetic content of environmental samples , which has been strongly promoted by next generation sequencing technologies. To cope with massive data involved in modern meta genomic projects, recent tools rely on the analysis of km ers shared between the read to be classified and sampled reference genomes. Results: Within this general framework, we show that spaced seeds provide a significant improvement of classification accuracy, as opposed to traditional contiguous km ers. We support this thesis through a series of different computational experiments, including simulations of large scale meta genomic projects. Availability and implementation, Supplementary information: Scripts and programs used in this study, as well as supplementary material, are available from

introduction meta genomics is a powerful approach to study genetic material contained in environmental samples. The advent of high throughput sequencing technologies (known as next generation Sequencing, NGS) revolutionized this approach by avoiding the need of cloning the DNA and thus greatly facilitating the obtention of meta genomic samples, at the same time drastically decreasing its price. present day meta genomic studies focus on various bacterial, fungal or viral populations, exemplified by the Human microbio me project () that investigates microbial communities at different sites of human body. Modern meta genomics deals with vast sequence datasets. On the one hand, meta genomic samples meta genomes obtained through NGS are commonly measured by tens of billions of bp (). These sequences generally come from a number of different species, some of which either have a previously sequenced reference genome or have a related sequenced species sufficiently close phylogenetically to determine this relationship by sequence comparison. Other sequences, however, may come from organisms that have no sufficiently close relatives with sequenced genomes or from DNA fragments that show no significant similarity with any available genomic sequence. The meta genomic classification problem is to assign each sequence of the meta genome to a corresponding taxonomic unit or to classify it as 'novel'. A way to improve the accuracy of meta genomic classification is to match the meta genome against as large set of known genomic sequences as possible. This set, stored in a working reference database, may contain thousands of full microbial genomes (). alignment based classifiers () proceed by aligning meta genome sequences to each of the genomes in the reference database. This can be done with generic blast like alignment programs (). While this approach can be envisaged for small datasets (both meta genome and database) and is actually used in such software tools as MEGAN () or phy mm bl () (see () for V C The Author 2015. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals permission soup com more), it is unfeasible on the scale of modern meta genomic projects. On the other hand, there exists a multitude of specialized tools for aligning NGS reads bwa (), novo align (http://www.novocraft.com/), GEM (), BOWTIE (), just to mention a few popular ones which perform alignment at a higher speed and are adjusted to specificities of ngs produced sequences. Still, aligning multimillion read sets against thousands of genomes remains computationally difficult even with optimized tools. Furthermore, read alignment algorithms are usually designed to compute high scoring alignments only and are often unable to report low scoring alignments. As a result, a large fraction of reads may remain unmapped (). Several techniques exist to reduce the computational complexity of this approach. One direction is to pre assemble reads into longer contigs, potentially improving the accuracy of assignment. Assembly of meta genomic reads has been a subject of many works () and remains a fragile approach, due to its error proneness and high computational complexity. Overall, it appears feasible mostly for small size projects with relatively high read coverage. To cope with increasingly large meta genomic projects, alignment free methods have recently come into use. Those methods do not compute read alignments, thus do not come with benefits of these, such as gene identification. alignment free sequence comparison is in itself an established research area, reviewed in a recent dedicated special issue (). Most of alignment free comparison methods are based on the analysis of words, usually of fixed size km ers occurring in input sequences. A popular approach is to compute the distance between frequency vectors of all km ers in each of the sequences. In the context of meta genomics however, when one of the sequences is short (NGS read), the analysis is based on the shared km ers without taking into account their multiplicities in reference genomes. This is also dictated by the prohibitive computational cost of computing and storing km er multiplicities for meta genomics size data. Two recently released tools lm at () and KRAKEN ()perform meta genomic classification of NGS reads based on the analysis of shared km ers between an input read and each reference genome. Given a taxonomic tree involving the species of the database, those tools 'map' each read to a node of the tree, thus reporting the most specific tax on or clade the read is associated with. Mapping is done by sliding through all km ers occurring in the read and determining, for each of them, the genomes of the database containing the km er. Based on obtained counts and tree topology, lm at and KRAKEN algorithms assign the read to the tree node 'best explaining' the counts. Further similar tools have been published during last months (). The goal of this work is to show that the meta genomics classification based on the analysis of shared km ers can be improved by using spaced km ers rather than contiguous km ers. The idea of using spaced km ers goes back to the concept of spaced seeds for seed and extend sequence comparison (). There, the idea is to use as a seed (i.e. local match triggering an alignment) a sequence of matches interleaved with 'joker positions' holding either matches or mismatches. The pattern specifying the sequence of matches and jokers is called spaced seed. Remarkably, replacing contiguous seeds by spaced seeds in sequence alignment significantly improves the sensibility selectivity trade-off with almost no incurred computational overhead. This has been first observed by and then extended and formally analyzed in a series of further works, see Brown (2008) and) and references therein. Recently, it has been reported in several works that spaced seeds bring an improvement in alignment free comparison as well show that comparing frequency vectors of spaced km ers km ers obtained by sampling must match positions of one or several spaced seeds), as opposed to contiguous km ers leads to a more accurate estimation of phylogenetic distances and, as a consequence, to a more accurate phylogenetic reconstruction study another measure the number of pairs of matching (not necessarily aligned) spaced km ers between the input sequences and show that it provides an even better estimator of phylogenetic distance. In No and Martin (2014), it is shown that the number of hits of appropriately chosen spaced seeds (i.e. the number of pairs of matching aligned spaced km ers between the two sequences) and their coverage (i.e. the total number of matches covered by all hits) provides a much better estimator for the alignment distance than the same measures made with contiguous seeds. From a machine learning perspective and Onodera and Shibuya (2013) show that spaced seeds provide better string kernels for svm based classification, confirmed by experiments with protein classification (see also No and Martin, 2014). In this work, we show that using spaced km ers significantly improves the accuracy of meta genomic classification of NGS reads as well. To support this thesis, we consider different scenarios. As a test case, we first study the problem of discriminating a read between two genomes, i.e. determining which of the two genomes is 'phylogenetically closer' to the read. We then analyze the correlation between the score of an alignment of a read to a genome and the seed count for this read, defined either as the number of hits or as the coverage. This analysis provides an insight on how well one can estimate the similarity between a read and a genome out of km er occurrences. Finally, we make a series of large scale meta genomic classification experiments with KRAKEN software () extended by the possibility of dealing with spaced seeds. These experiments demonstrate an improved classification accuracy at the genus and family levels caused by the use of spaced seeds instead of contiguous ones.

discussion through a series of computational experiments, we showed that spaced seeds significantly improve the accuracy of meta genomic classification of short NGS reads. The superiority of spaced seeds for different variants of alignment free sequence comparison has been recently demonstrated by other authors as well (). In this work, we specifically focused on the meta genomics setting characterized by very large volumes of data, both in terms of the number of reads and the size of genomic database this quantity of data precludes using some alignment free comparison techniques and z leaves room only for highly time and space efficient approaches. Note also that in our setting, we have to compare short sequences (reads) with long ones (whole genomes), which makes an important difference with problems considered in is to use multiple seeds, i.e. several seeds simultaneously instead of a single one. This extension is known to bring an advantage in seed and extend sequence alignment () and () show that this improvement applies to alignment free comparison as well. However, each seed requires building a separate index for database genomic sequences, and therefore it appears computationally difficult to use multiple seeds in meta genomics unless some new indexing techniques are designed for this purpose. In our work, we studied three estimators: hit number, coverage and Jaccard index. Hit number and coverage be have similarly in classification (Section 3.1), but Jaccard index generally improves on them in the case of mapping to real genomes (Section 3.1.2), due to the correction with respect to the km er richness. Considered as an estimator of alignment quality (Sections 3.2 and 3.3), coverage provides a certain advantage over hit number. More subtle estimators can be considered as well, e.g. by taking into account the position of km er in the read (reflecting the sequencing error rate), and this provides an issue for further study. Designing efficient seeds for meta genomic classification is another important issue that goes beyond the present study. Note that optimal spaced seeds for seed and extend alignment are generally not optimal for alignment free km er based comparison (). In No and Martin (2014), the authors designed (sub-)optimal seeds maximizing the Pearson correlation between hit number coverage count and the alignment quality. Their solution is implemented in ieder a software (The latest version of ieder a performs design for Spearman correlation as well.) (http://bioinfo.lifl.fr/yass/iedera) (). On the other hand, recent work () introduces quadratic residue seeds qr seeds for seed and extend alignment, which present a good performance and have the advantage of easy design, avoiding the computationally expensive enumeration of ieder a. In our work, we used both ieder a and qr seeds adapted to our setting. We observed that in most cases, ieder a seeds are superior (being designed specifically for our task) but in a few cases, qr seeds demonstrated equal or even better performance (e.g. best results off or weights 14-18 were obtained with qr seeds. This may be due to their large span (cf. supplement material) for which applying ieder a is computationally costly. Real data experiments of Sections 3.1.2, 3.3 have been done using snake make (K ster and). Overall, all our experiments corroborate the thesis of better performance of spaced seeds for meta genomic classification. Experiments with KRAKEN (Section 3.4) give a strong evidence that spaced seeds can improve the classification accuracy in real life large scale meta genomic projects. One further improvement would be to implement coverage and Jaccard measures that showed, in general, a better performance compared with the hit number. Introducing spaced seeds rises new issues, such as the construction of an efficient index of the database or adapting the algorithm of computing the most likely node of the taxonomic tree from counts produced by individual genomes, i.e. leaves of the tree. These questions are a subject for future work.
