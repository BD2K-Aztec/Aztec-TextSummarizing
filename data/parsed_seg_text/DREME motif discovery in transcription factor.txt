Motivation: Transcription factor (TF) chips eq datasets have particular characteristics that provide unique challenges and opportunities for motif discovery. Most existing motif discovery algorithms do not scale well to such large datasets, or fail to report many motifs associated with cofactors of the chip ed TF. Results: We present dre me a motif discovery algorithm specifically designed to find the short, core dna binding motifs of eukaryotic TFs, and optimized to analyze very large chips eq datasets in minutes. Using dre me we discover the binding motifs of the the chip ed TF and many cofactors in mouse ES cell me sc mouse erythrocyte and human cell line chips eq datasets. For example, in me sc chips eq data for the TF esr rb we discover the binding motifs for eight cofactor TFs important in the maintenance of plur i potency. Several other commonly used algorithms find at most two cofactor motifs in this same dataset. dre me can also perform discriminative motif discovery, and we use this feature to provide evidence that Sox2 and Oct4 do not bind in mES cells as an obligate heterodimer. dre me is much faster than many commonly used algorithms, scales linearly in dataset size, finds multiple, non-redundant motifs and reports a reliable measure of statistical significance for each motif found. dre me is available as part of the MEME Suite of motif based sequence analysis tools (http://meme.nbcr.net).

introduction it is estimated that the human genome contains 1500 transcription factors (TFs) that play a key role in regulating transcription by binding to the genome alone or in protein complexes (). Chromatin immunoprecipitation (ChIP) followed by high throughput sequencing chips eq is the current method of choice for determining the genomic binding locations of a TF. The resolution of chips eq location data is such that the actual binding location is typically within 50 bp of the predicted location (). A TF chips eq experiment generally yields hundreds to tens of thousands of predicted locations (often called chips eq peaks'). In addition to providing evidence of direct regulation by the TF proximity to individual genes, the chips eq data provide a rich resource for exploring the in vivo dna binding affinity of the chip ed TF and cofactor TFs that bind DNA in complex or nearby, and for discovering the identities of these cofactors. Ab initio motif discovery algorithms applied to chips eq peak regions can usually discover the dna binding motif of the chip ed TF. However, most existing algorithms have limitations that make them less than ideal for discovering all the cofactor motifs in a chips eq dataset. One limitation of many popular algorithms is that they do not scale well to inputs containing thousands of sequences. As a result, many studies to date have used only a fraction (say 500 sequences) of the available chips eq peak regions for motif discovery, greatly decreasing the chances of discovering motifs for infrequent cofactors. A second limitation is that many algorithms do not provide reliable motif statistics to enable the biologist to discern functional motifs from statistical artifacts. This limitation can cause valid motifs to be ignored, or time to be wasted investigating random motifs. A third limitation is that most algorithms do not allow two chips eq datasets to be directly compared, finding motifs that are relatively enriched. This limitation makes it difficult to determine whether two TFs always bind as a heterodimer or even if the motif for the chip ed TF has been found at all. Other limitations possessed by some algorithms that make them unsatisfactory for chips eq data analysis include only finding a single motif or being 'hard-wired' to use a particular type of sequence (e.g. promoters). Here, we describe a novel motif discovery algorithm lacking the above limitations, and demonstrate how to use it to mine chips eq datasets for primary and cofactor motifs and for insights into cooperative or indirect binding by TFs. We show that the new algorithm is significantly faster than several algorithms that are commonly used for analyzing chips eq datasets, yet is able to discover substantially more cofactor motifs. The algorithm searches for motifs expressed as simplified 'regular expressions' (consensus sequences allowing wildcards but not variable length gaps). It achieves speed partly by limiting its search to short motifs (up to 8 bp wide), which turns out to be ideal for identifying and studying the dna binding motifs of monomeric eukaryotic TFs, but may cause it to miss some wider motifs due to binding by large TF complexes. Our new algorithm has some similarities with a few existing, word based algorithms such as Trawler () and Amadeus ()), but our approach is simpler and we demonstrate that it finds substantially more cofactor motifs. Consequently, our algorithm complements rather than replaces existing motif discovery tools for the analysis of chips eq data.

discussion focusing on short, core motifs in TF chips eq datasets appears to be a very profitable approach to understanding patterns of DNA binding by TFs. Additional insight can also be gained by searching for motifs that are relatively enriched in one chips eq dataset compared with another. The ab initio discovered motifs can often be associated with the probable TF that binds them by comparison to existing compendia of TF motifs, using expression in the chip ed tissue and prior knowledge as a filter. The large numbers of motifs discovered by dre me that can be reliably assigned to TFs suggests that unassigned motifs may represent binding by other TFs whose motifs are not yet known. Of course, because it is only designed to find short, core motifs, dre me is intended only to complement existing motif finders (such as those tested here). A complete analysis of a TF chips eq dataset should also include a search for longer, more complex motifs. Our motif discovery algorithm incorporates ideas from several existing algorithms (; Sinha and Tompa, 2003).uses the Fisher's Exact Test to measure the significance of enrichment of motifs in two sets of sequences. Their motifs are not regular expressions but '-balls': the set of words that are within a set Hamming distance from a given word. This motif definition treats variations from the consensus word the same, regardless of position within the motif. Real TF motifs are less tolerant of variation in certain positions (), and this is better captured by regular expressions, which explicitly list all the allowed variations (if any) at each motif position. Several algorithms including YMF () use regular expressions at some stage in the search for motifs, but differ from our algorithm in other respects. For example, YMF only allows a subset of the IUPAC wildcards and scores motifs using a different statistical test (Z-score). Counting the number of sequences (not occurrences) is equivalent to the 'Zero or One Occurrence Per Sequence' z oops model used by numerous motif discovery algorithms, and finding multiple motifs by erasing is reminiscent of MEME (). cis finder () also uses the idea of counting words and computing relative enrichment in two sets of sequences, is extremely fast, and can find many cofactor motifs in chips eq datasets. Unlike dre me however, it requires a motif clustering step to (partially) remove redundant motifs, and can not be restricted to finding short, core motifs. Also, in contrast with dre me cis finder reports a p value for each motif that is not a measure of the significance of the motif, but only of a single word (without wildcards) matching the motif.
