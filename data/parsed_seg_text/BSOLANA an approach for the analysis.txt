Bisulfite sequencing, a combination of bisulfite treatment and high throughput sequencing, has proved to be a valuable method for measuring DNA methylation at single base resolution. Here, we present b solana an approach for the analysis of two base encoding color space bisulfite sequencing data on the SOLiD platform of Life Technologies. It includes the alignment of bisulfite sequences and the determination of methylation levels in CpG as well as non cpg sequence contexts. b solana enables a fast and accurate analysis of large raw sequence datasets. Availability and implementation: The source code, released under the GNU GPLv3 licence, is freely available at

introduction methylation at position 5 of cytosine s is a major epigenetic modification, which has an important impact on transcriptional and regulatory processes of DNA (). It is a stable modification of the genome which can be inherited from one generation to the next, even though it can also be dynamically changed by environmental influences. There are several methods based on high throughput sequencing, such as methylated DNA immunoprecipitation sequencing me dip seq methylated DNA capture by affinity purification methyl cap seq and bs seq which can provide good quality genome wide DNA methylation data (). Methods that currently provide genome wide methylation patterns at single base resolution make use of bisulfite conversion and high throughput sequencing. The treatment of DNA with sodium bisulfite has no effect on methylated cytosine s but it specifically converts unmethylated cytosine s to uracil s which are converted to thymine s during subsequent polymerase chain reaction amplification. As a result of bisulfite conversion, the Watson and Crick strands of bisulfite treated DNA are no longer complementary to each other, they become essentially different genomes. This fact * To whom correspondence should be addressed. leads to an enlarged alignment reference space. The prevalence of T's that have replaced C's leads to reduced complexity in bisulfite sequences, which increases the bioinformatics challenge of bs seq analysis. Bioinformatics tools for bs seq have generally fallen into two categories: (i) methylation aware alignment tools, which consider cytosine s and thymine s as potential matches to genomic cytosine positions and (ii) tools which convert any residual cytosine s in bisulfite sequences and all cytosine s of the reference genomes into thymine s dinucleotides whereas the percentage of methylated CHG and CHH is always lower (). The approach of b solana reduces the number of bisulfite induced mismatches by considering the prevalence of methylated cytosine s in their different sequence contexts. In order to identify CpG and non cpg methylation sites, b solana aligns bisulfite sequences to two in silico conversions of the reference genome (Supplementary). In the first modified reference genome, all cytosine s in a non cpg context are converted to thymine s (Conversion I). In the second, all cytosine s irrespective of their sequence context, are converted to thymine s (Conversion II). After alignment to these converted genomes, b solana determines the best alignment for each bisulfite sequence in the following way: bisulfite sequences that are aligned to different genomic positions in Conversions I and II are assigned to the position with the lowest number of mismatches. Reads with the same number of mismatches at different positions are ignored. In its final step, b solana determines methylation levels. b solana is compatible with 50 bp directional single end libraries and allows a simple adjustment for the upcoming read lengths. b solana was designed to generate accurate results for methyl omes with a low percentage of methylation in non cpg sites (5%). This includes most eukaryotic organisms, with mammalian genomes typically having methylation levels of 3% in CHG and 1% in CHH context (). A detailed test of b solana was performed for genomic DNA extracted from a human lymphoma cell line. The library was prepared using a protocol for single end SOLiD bs seq () and sequencing of the bisulfite converted DNA was performed using SOLiD versions 3 Plus and 4. This generated 2.79 billion bisulfite reads of which 52% were mapped uniquely (genome build hg19/NCBI 37). The methylation results obtained by b solana were then compared to the Illumina Infinium human methylation 450 bead chip (450 k) assay, an established methylation analysis method, as a quality control (Supplementary). We observed high concordance between the results of the two independent methods (99% of 450 k sites were also represented in the b solana results) and the methylation levels of cytosine s which were assayed by both methods displayed a very high correlation (Pearson correlation r  0.93). As a proof of principle, we also generated different simulated datasets, reflecting varying CpG and non cpg methylation levels. Encouragingly, the results generated by b solana closely match the expected methylation degrees (Supplementary). A further approach for the analysis of color space bs seq was published with the tool methyl coder (). methyl coder applies a conversion of any residual bisulfite read cytosine s into thymine s which leads to erroneous alignments, as discussed above. Therefore, we compared b solana and methyl coder (one mismatch allowed) by analyzing 485 990 920 SOLiD bs seq reads (50 bp), taken from SRR204024 (Hansen, 2011). We found a high concordance between methylation calls of Hansen et al., analyzed by their yet unpublished and unavailable approach, and b solana. Moreover, b solana turns out to have a significantly higher mapping efficiency. As a platform independent benchmark, we demonstrate that the analysis of color space bs seq data of the fibroblast cell line IMR90 is comparable to methyl ome data published by, who used a bs seq approach on the Illumina platform (Supplementary Information 1).
