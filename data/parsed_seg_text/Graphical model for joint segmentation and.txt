Motivation: To gain fundamental insight into the development of embryos, biologists seek to understand the fate of each and every embryonic cell. For the generation of cell tracks in embryo-genesis, so called tracking by assignment methods are flexible approaches. However, as every two stage approach, they suffer from irrevocable errors propagated from the first stage to the second stage, here from segmentation to tracking. It is therefore desirable to model segmentation and tracking in a joint holistic assignment framework allowing the two stages to maximally benefit from each other. Results: We propose a probabilistic graphical model, which both automatically selects the best segments from a time series of over segmented images volumes and links them across time. This is realized by introducing intra frame and inter-frame constraints between conflicting segmentation and tracking hypotheses while at the same time allowing for cell division. We show the efficiency of our algorithm on a challenging 3Dþt cell tracking dataset from Drosophila embryogenesis and on a 2Dþt dataset of proliferating cells in a dense population with frequent overlaps. On the latter, we achieve results significantly better than state of the art tracking methods. Availability and implementation: Source code and the 3Dþt Drosophila dataset along with our manual annotations will be freely available on http://hci.iwr.uni-heidelberg.de/MIP/Research/ tracking/

introduction fueled by new microscopic techniques (e.g.), which allow to record in vivo multidimensional images in high spatial and temporal resolution, and by robotic high throughput setups, biology is developing a great hunger for robust and accurate automated cell tracking (). As an example, one major goal in developmental biology is the digitization of embryogenesis and its computational analysis, where cell tracking plays an important role. Great advances in this field have been reported most recently (), and one key feature in their study is that they do not strictly separate the cell detection and segmentation stage from the cell tracking stage (For brevity, we mostly refer to the combination of detection and segmentation as detection only instead propagate the cell centroids and their approximated Gaussian shape from the past time steps to the next while detecting cell divisions at the same time. Despite handling detection and tracking separately, tracking by assignment algorithms (), on the other hand, have proven to be most flexible in terms of modeling power when injecting prior knowledge: biological laws can be modeled as constraints (see Section 3.2) and prior beliefs about individual detections and assignments may be incorporated by utilizing local classifiers trained on a small subset of the data (see Section 3.3) rather than using heuristic rules. Furthermore, tracking by assignment models allow for global optimization, which will further improve accuracy, as the assignment problems are solved in a larger temporal context. Nevertheless, this modeling power in tracking by assignment approaches comes at the cost of propagating errors from the first stage (segmentation) to the second (tracking) and insight from the second stage can not be used to lift ambiguities arising in the first stage. In other words, the tracking result is highly dependent on the detection segmentation quality, and the overall achievable quality is limited by the lack of interaction between detection and assignment decisions. Our work aims at solving this particular problem by introducing a method for joint segmentation and tracking in one graphical model. Instead of a single fixed segmentation as used in previous tracking by assignment models, the detection phase generates super pixels voxels from which regions (possible cell segmentations) are extracted as sets of the original super pixels. In particular, these regions can be understood as a selection of possible segmentation hypotheses. Global temporal and spatial information guides the selection of those hypotheses that best fit the overall tracking. During inference, each super pixel is assigned either a cell track identifier or the identifier of the background (cf.). Put another way, our algorithm simultaneously produces both a valid cell segmentation and an assignment of each cell to its cell lineage. Our main contribution is the formulation of a probabilistic graphical model for joint segmentation and tracking for divisible and almost indistinguishable cells. This undirected graphical model incorporates prior beliefs from multiple local classifiers and guarantees consistency in time and space. We also present a method to generate an over segmentation which respects the borders between cells and generates an over complete set of super pixels even for cells in dense populations. Furthermore, the 3Dt Drosophila dataset we use for evaluation and our dense manual annotations are provided on our website. This is the first dataset of this size and kind for which manual annotations are freely available.

conclusion this work is motivated by the desire to overcome the propagation of errors from a separate segmentation phase to an independent tracking phase in a tracking by assignment framework. In response, we propose an undirected graphical model that couples decisions over all of space and all of time. This model simultaneously selects a. Segmentation quality after tracking (higher is better). Note that in our method, segmentation and tracking are optimized concurrently. The rat stem cells dataset contains a ground truth of 121 632 cells across all frames, whereas the Drosophila embryo data consists of 65 821 true cells bold values represents best performance results. subset of competing segmentation hypotheses and combines these into a tracking. All of these decisions are made to interact, so as to reach the overall most likely interpretation of the data. The benefits of this approach are borne out by experimental results that are a significant improvement over the state of the art. We present results on 2Dt and 3Dt datasets from biology that are very challenging due to, first, the division of targets due to cell mitosis; second, mutual overlap and poor signal to noise and third, the near indistinguishability of cells. The model is one of significant complexity but remains solvable to global optimality in practicable runtimes of less than an hour on the large datasets used. There are several immediately relevant avenues for future work, including structured learning of the classifiers or speed-ups in runtime. The latter may be achieved by domain decomposition, which needs to guarantee consistency in overlaps. Relaxations such as dual decomposition () will break the graphical model into smaller portions for each of which inference is fast while at the same time the individual components are forced to agree on the overlap. Also approximate solvers may be used to speed up inference. Furthermore, coupling the method of with our approach might yield significant speed-ups and high accuracy in terms of cell division detection.
