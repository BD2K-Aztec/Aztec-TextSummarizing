Motivation: The combined effect of a high replication rate and the low fidelity of the viral polymer-ase in most RNA viruses and some DNA viruses results in the formation of a viral quasispecies. Uncovering information about quasispecies populations significantly benefits the study of disease progression, antiviral drug design, vaccine design and viral pathogenesis. We present a new analysis pipeline called vi quas for viral quasispecies spectrum reconstruction using short next generation sequencing reads. vi quas is based on a novel reference assisted de novo assembly algorithm for constructing local haplotypes. A significantly extended version of an existing global strain reconstruction algorithm is also used. Results: Benchmarking results showed that vi quas outperformed three other previously published methods named shor ah qu re and predict haplo with improvements of at least 3.1–53.9% in recall , 0–12.1% in precision and 0–38.2% in f score in terms of strain sequence assembly and improvements of at least 0.006–0.143 in kl divergence and 0.001–0.035 in root mean squared error in terms of strain frequency estimation, over the next best algorithm under various simulation settings. We also applied vi quas on a real read set derived from an in vitro human immunodeficiency virus (HIV)-1 population, two independent datasets of foot and mouth disease virus derived from the same biological sample and a real HIV-1 dataset and demonstrated better results than other methods available. Availability and implementation: http://sourceforge.net/projects/viquas/

introduction inside an infected host, most RNA viruses such as human immunodeficiency virus (HIV), hepatitis C, foot and mouth disease virus (FMDV) and some DNA viruses like hepatitis B exhibit very high replication rates (). The low fidelity of the proof-reading function of the viral polymerase () coupled with this high replication rate results in the formation of a viral quasispecies population. More specifically, a quasispecies is a set of genetically related but non identical viral mutant types (which can also be referred to as strains) that are able to co-exist within the host (). As anti-viral vaccines and drugs make use of the knowledge on various stages of the host viral interaction process and viral replication process (), the presence of different viral strains in the population affects the natural host immune response as well as the antiviral drug therapy (). Therefore, information about these strains, or quasispecies spectra, is of critical importance to antiviral drug design and vaccine design. In particular, such information would enhance research into viral evolution, disease progression and provide insights into the biology and pathogenesis of viruses (). During the analysis of quasispecies, identifying the co occurrence of nucleotide level mutations is as important as identifying individual mutations. As such, there are two main challenges in this analysis: assembling nucleotide sequences of each individual strain to identify co occurring mutations and to estimate the relative frequency of each strain within the quasispecies. Collectively, these two challenges constitute Quasispecies Spectrum Reconstruction (QSR). The most similar problem to QSR is the meta genomic binning problem as applied to bacterial meta genomes (), but emphasizes the inability of binning methods based on sequence similarity and sequence composition to discriminate between strains of the same species due to high nucleotide compositional similarity. single genome de novo assembly is another similar problem to QSR (). These algorithms are optimized to overcome technical sequence errors assuming the existence of a single species in the sequenced sample (). Hence given a meta genomic dataset as input, most assemblers work towards generating a single assembly of reads misinterpreting genetic variability as potential technical sequencing errors. One of the earliest methods for viral population estimation using next generation sequencing (NGS) was proposed in. It uses a multiple read alignment and clustering strategy for read error correction, a combinatorial algorithm for strain reconstruction and a statistical model based expectation maximization strategy for strain frequency estimation. The method formulated in, named shor ah extends the method of and uses a Bayesian inference algorithm for read error correction and a probabilistic clustering algorithm for strain reconstruction (). Three other interesting approaches to solve the QSR problem are the combinatorial method proposed in, which was later published as a software named qu re (), the method proposed in named vi spa and the method proposed in) named predict haplo. Current methods that address the QSR problem rely on the fact that the NGS reads of a quasispecies sample can be assigned with a unique alignment position to a known reference genome or a consensus sequence. This has become possible due to the rarity of repeats in viral genomes (). Following read alignment, a typical quasispecies analysis pipeline consists of three major steps: (i) First, the genetic diversity is determined on either overlapping or non-overlapping local windows of the reference genome by clustering reads within each window together with strategies to eliminate or correct technical sequencing errors. This is also referred to as constructing local haplotypes. (ii) Second, the global diversity is inferred by connecting the local haplotypes to form the nucleotide sequences spanning the entire genomic region of interest (i.e. strain reconstruction). (iii) Third is the step of estimating the relative frequencies of the reconstructed strains. Comprehensive reviews on different techniques used within these main steps of an analysis pipeline are found in and beer en winkel and zagor di (2011). The most critical component within this pipeline is global diversity estimation, where previous studies have relied on one of two key concepts (). The most popular strategy of inferring global diversity is based on graph based methods, as has been implemented in. Alternatively, the problem has also been approached using probabilistic clustering methods (). Less common, but a very useful third approach for quasispecies identification based on de novo assembly has been published in. Even though does not address the QSR problem from strain assembly to frequency estimation, it provides an interesting initiation point for the total strain assembly problem using short NGS reads. We have further developed the idea of using a de novo assembly algorithms for quasispecies assembly in this work. An analysis of the effects of average read length, depth of coverage and technical sequencing errors on total strain reconstruction is presented in, and it highlights the fact that inferring quasispecies population diversity of larger genomic regions using short NGS reads remains a challenging problem. In this article, we present a new analysis pipeline named vi quas for viral QSR using short NGS reads. Our main focus is on inferring quasispecies spectrum within a certain genomic region of a viral sample using sequence reads that are several folds shorter in length compared with the region, in the presence of a moderate level of technical sequencing errors. The novelty of our method is 2-fold. (i) We propose a novel reference assisted de novo assembly algorithm for defining local haplotypes. (ii) We propose a significant extension to the global reconstruction algorithm presented in, based on relative coverage depths and overlap agreement of local haplotypes. Moreover, we present the first benchmark study of vi quas and three other existing methods named shor ah (), qu re () and predict haplo (), on a broad spectrum of simulated data allowing for a thorough comparison of performance between the four methods. The correctness of the nucleotide sequences reconstructed is primarily evaluated based on the measures Recall and Precision. Under different simulation conditions, the four methods used in the benchmark study outperformed each other in Recall and Precision without a particular pattern. Hence, the geometric mean of Recall and Precision termed as f score is used to measure the performance using a single measure. On the other hand, the accuracy of the estimated relative frequency distribution of the reconstructed strains is measured using kl divergence () and root mean squared error. vi quas outperformed shor ah qu re and predict haplo demonstrating improvements of at least 3.153.9% in Recall, 012.1% in Precision and 038.2% in f score in terms of strain sequence assembly and improvements of at least 0.0060.143 in kl divergence and 0.0010.035 in root vi quas mean squared error over the next best algorithm under various simulation settings.

discussion we present in this article, a novel method for QSR named vi quas. The main novelty is the proposed reference assisted de novo assembly algorithm constituted by the three consecutive steps de novo assembly, Mutation calling and Chimeric error correction. The greedy graph based de novo assembly algorithm and the subsequent mutation loci guided chimeric error correction algorithm provide vi quas with a significant advantage over shor ah qu re and predict haplo when it is used to analyse short NGS reads. Our method clearly outperformed shor ah qu re and predict haplo on the 6810 simulated datasets used in the benchmark study, demonstrating the capability of reconstructing quasispecies spectra using short NGS read samples (100 bp, 200 bp and 300 bp) with comparatively less susceptibility to the presence of sequencing errors and indels. Given a viral genomic region of interest, the average read length of the NGS read sample and the Diversity of the quasispecies population were identified as the two most critical factors affecting the performance of vi quas provided that the technical sequencing error rate is kept at a minimum level. It is evident that strain sequence assembly gets easier when the Diversity of a quasispecies population becomes higher, provided that read data are available covering the whole genomic region of lr  100 bp; e  0%, both SNPs and indels are present in strains T  P ; I; D, n total  30 000 and f min  1:4%). L r is the mean read length (read length $ N Lr; 25), e is the substitutional error probability of the reads, n total is the total number of reads and f min is the theoretically re constructible minimum relative frequency. Each point indicates mean value of the measure interest. This pattern of performance was common to all four methods considered in our study. Under all eight different simulation conditions, vi quas gave the highest average Recall values demonstrating the best total strain reconstruction capability. vi quas and shor ah performed at comparable levels in terms of strain frequency estimation, while clearly outperforming qu re and predict haplo. Due to the unavailability of real datasets with known quasispecies populations, the best alternative for validating these methods under real world conditions was to use simulated datasets such as SS9SS11 that can be assumed to resemble such conditions. Agreement between the performance patterns of entirely simulated data (SS1SS8) and data resembling real conditions (SS9SS11) further confirmed the enhanced performance of vi quas over shor ah qu re and predict haplo. Even though the correctness of the reconstructed strains can not be evaluated due to the unavailability of exact nucleotide content of the strains in the real FMDV samples (ERR180978 and ERR180979) and real HIV-1 dataset V11909 (), the consistency of results produced by vi quas on real FMDV samples and the higher degree of biological validity of the strains reconstructed from real HIV-1 data by vi quas indicate the applicability of vi quas on real sequence data and better performance over shor ah qu re and predict haplo. In addition, simulated samples with Illumina sequencing parameters further confirmed the superior performance of vi quas. In this study, we performed a comprehensive comparison of performance between vi quas shor ah qu re and predict haplo in a broad range of Diversity and N s values. Because of the requirement of vi spa () to have the Diversity of a sample as an input parameter, which is impractical for real data, and its poor performance under read lengths in the range of 100 bp and 200 bp, we did not use it in this study. Another method found in literature named quasi recomb () was also omitted from further analysis due to its poor performance even on SS2 (on which the other three method used in the analysis showed their best performance). Two of the most significant observations of the comparison study are the drastic drop of performance of shor ah and predict haplo under the presence of indels [refer(e) and h and of qu re under a shorter (100 bp) read length [. On the contrary, vi quas was much less susceptible against both indels and reduced read lengths. All four methods handled the sequencing error rate of 0.1% without a significant drop of performance. In particular, we observed a better performance of shor ah and predict haplo on SS9 in the presence of indels compared with their poor performance on SS7. This observation is due to the fact that some strains in SS9 do not have insertions (but SNPs and deletions), which are correctly reconstructed, while every strain in SS7 has both insertions and deletions. It was not evident that shor ah and predict haplo eliminates all insertion considering them as technical sequencing errors because some reconstructed strains in SS7 contain a few (but not all) correct insertions. This also explains the improved performance of shor ah on SS10 and SS11 compared with qu re (Supplementary), as the 10 real HIV strains used in SS10 and SS11 does not have any mutations in the form of insertions. On the other hand, qu re performed better than shor ah and predict haplo on SS9 (Supplementary) where some of the simulated HBV strains contain insertions. The second significant factor is that shor ah qu re and predict haplo define local analysis windows a priori. These window boundaries restrict the growth of the read clusters along the nucleotide space of the region of interest. In contrast, vi quas allows the contigs to extend as far as the reads provide information supporting the co occurrence of mutations. This unrestricted growth of contigs becomes advantageous in the total strain reconstruction stage. In shor ah each of the paths in the cover of the read graph contains a number of nodes equal to the number of windows (). In qu re the complexity of the global reconstruction algorithm is proportional to the number of windows (). The window length is typically set equal to the average read length in both shor ah and qu re. Hence, the algorithmic complexity of the global reconstruction methods of both shor ah and qu re increases in proportionate to the ratio between the genomic region of interest and the read length. These factors significantly affect the performance of the respective methods as been discussed in, takes advantage of the unrestricted de novo assembly algorithm and dynamically defines the local haplotype boundaries for each strain, at which the decisions for connecting local haplotypes are made. This dynamic definition of local haplotype boundaries significantly reduces the number of heuristic decisions to be made when connecting local haplotypes providing a clear advantage over qu re. This advantage becomes prominent especially under shorter read lengths. The third source of performance enhancement in vi quas is the improvement of estimated strain frequency values (demonstrated in terms of kl divergence and root mean squared error) resulted from the second and third major extensions to the algorithm in described under the subsection 2.2.6. Limitations of vi quas include the requirement of higher computational resources when analysing longer read lengths owing to the use of smith waterman algorithm in the pipeline. However, this computational complexity does not degrade the performance of the pipeline. A shorter read length compared with the genomic region of interest reduced coverage depth of the sequences and a higher rate of technical sequencing errors were identified as the factors influencing negatively on the performance of vi quas. In fact, these factors were common to all four methods in our study and vi quas was observed to be the least susceptible to them. Also, all four methods failed to reconstruct strains with a relative frequency less than f min, and the correctly re constructible minimum relative frequency increased with the presence of technical sequencing errors. We notice that the performance of the methods analyzed vary with different population characteristics and sequencing parameters. Therefore, it is a difficult task to define parameters within which a certain method performs at an acceptable level. In fact, the acceptable level of performance varies according to the needs of the individual user. Hence, the decision on choosing the best method of analysis and the appropriate sequencing parameters is left to the end user. Furthermore, the longest region that can be successfully reconstructed depends on both the read length and Diversity. For instance, when the region of interest and the Diversity are given, we observe that the performance increases with increasing read length. This does not imply that we can expect the same levels of performance with the same Diversity and read length over a larger genomic region. A thorough analysis of this fact is presented in. We anticipate the use of vi quas to extend beyond quasispecies spectra profiling with applications in other omics fields including vi quas cancer genomics, meta genomics and immuno genomics. For instance, applications such as estimating genetic diversity of tumour cells and understanding gene heterogeneity and diversity of micro biomes in various environments such as human gut or waste treatment plants may benefit from the underlying methodology.
