Motivation: An observed metabolic response is the result of the coordinated activation and interaction between multiple genetic pathways. However, the complex structure of metabolism has meant that a compete understanding of which pathways are required to produce an observed metabolic response is not fully understood. In this article, we propose an approach that can identify the genetic pathways which dictate the response of metabolic network to specific experimental conditions. Results: Our approach is a combination of probabilistic models for pathway ranking, clustering and classification. First, we use a non-parametric pathway extraction method to identify the most highly correlated paths through the metabolic network. We then extract the defining structure within these top ranked pathways using both Markov clustering and classification algorithms. Furthermore, we define detailed node and edge annotations, which enable us to track each pathway, not only with respect to its genetic dependencies, but also allow for an analysis of the interacting reactions, compounds and KEGG sub-networks. We show that our approach identifies biologically meaningful pathways within two microarray expression datasets using entire KEGG metabolic networks. Availability and implementation: An R package containing a full implementation of our proposed method is currently available from

introduction coordinated gene expression along specific pathways determines which metabolic compounds can be synthesized and, therefore, can be used to infer the function of an entire network. Much of the networked structure of metabolism has already been identified and is readily available through databases such as KEGG (). These databases reveal that even for simple organisms, the complete metabolic network is large and highly complex. This mixture of network size and complexity is sufficient to hide the key pathways, which define the response of the metabolic network to external stimuli. Consequently, models of global metabolic networks * To whom correspondence should be addressed are required to identify the specific pathways that are driving an observed metabolic response. Metabolism of specific models such as network expansion (), flux balance analysis (FBA;) and constraints based modeling () model the chemical properties of metabolic networks. The simplest of these, network expansion, uses the natural limits imposed by the stoichiometry of each reaction to identify the scope of a each compound within the network. The goal of network expansion is to determine a minimum set of compounds required to fully reproduce the entire network. FBA and constraint based models are explicit physical models of the chemistry that control metabolic networks. Physical models of metabolism explicitly model the flux through the reactions in order to predict the amount of each compound being produced during an experiment. Both physical models and network expansion approaches focus heavily on the chemical properties of the metabolic network and do not directly consider the genetic component of a metabolic network. Extensions to these approaches to include a genetic effect within model have been proposed (). However, these extensions are limited to binary representations of gene expression and do not consider relationships within the gene expression along pathways or within subnetworks. A considerable amount of research has been undertaken to identify the genetic factors, which dictate the function of metabolic networks (). Of particular note are methods relating to gene set enrichment analysis g sea which seek to identify known groups of genes that have a non-random response to an external stimulus. g sea methods identify important groups of genes by first ranking all genes using test statistics such as t tests or correlation coefficients, and then testing to see if specific groups are at the top or bottom of the ranked list. However, g sea methods rely on the structure of simple test statistics that do not explicitly use the known networked structure of genes. Furthermore, they can only indicate which large pre-specified groups of genes are important and do not allow for partial responses where only some genes within these known groups are related the observed response. Machine learning methods such as graph based kernels () or penalized approaches () overcome the limitations of g sea and use feature selection to identify functional network components. However, neither graph kernels nor penalized approaches can strictly enforce that the features identified are logically connected within the network, and therefore may produce results that are difficult to justify biologically. Probabilistic network models such as those described in we i and Li (2007) and can enforce these features
