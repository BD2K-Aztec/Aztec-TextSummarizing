Motivation: Many chips eq experiments are aimed at developing gold standards for determining the locations of various genomic features such as transcription start or transcription factor binding sites on the whole genome. Many such pioneering experiments lack rigorous testing methods and adequate gold standard annotations to compare against as they themselves are the most reliable source of empirical data available. To overcome this problem, we propose a self consistency test whereby a dataset is tested against itself. It relies on a supervised machine learning style protocol for in silico annotation of a genome and accuracy estimation to guarantee, at least, self consistency. Results: The main results use a novel performance metric (a calibrated precision) in order to assess and compare the robustness of the proposed supervised learning method across different test sets. As a proof of principle, we applied the whole protocol to two recent chips eq ENCODE datasets of STAT1 and poli i binding sites. STAT1 is benchmarked against in silico detection of binding sites using available position weight matrices. poli i the main focus of this paper, is benchmarked against 17 algorithms for the closely related and well studied problem of in silico transcription start site (TSS) prediction. Our results also demonstrate the feasibility of in silico genome annotation extension with encouraging results from a small portion of annotated genome to the remainder. Availability: Available from http://www.genomics.

introduction the recent advances in microarray technologies (tiling arrays, SNP arrays, etc.) and more recently in high throughput sequencing next generation sequencing (NGS)] allows for more complete genome wide annotation of functional sites. The rapid increase in the data volumes has put pressure on the development of data analysis techniques capable of coping with large volumes of data that can reliably extract relevant knowledge. This article analyses and benchmarks techniques introduced in based on supervised learning and the generalization capabilities of predictive models that are trained on part of the genome and tested * To whom correspondence should be addressed. on the remainder. Our approach consists of dividing the genome into small tiles and then allocating a binary label to each tile according to the observed phenomenon (e.g. the presence of a transcription factor binding site within the tile). A model is then trained on a portion of the genome to predict the labels from the DNA content of tiles and then tested on the whole genome. The prediction accuracy is then used to assess the properties of the assay. There are many interesting phenomena which can be analysed by this approach and we will now focus on two key examples 1 A quality test for chips eq experiment: we first discuss a quality test for chips eq experiments when there is no (independent) gold standard to assess the final results. In the paper by, we compared a few sets of putative peaks for STAT1 and poli i binding sites generated by various analysis methods applied to the chips eq experimental data of. As the 'gold standards' provided by the ENCODE project were extracted from the same experimental data and their putative peaks were a part of our comparative study, an independent and objective way of evaluating the various lists of peaks was required introduced a consistency benchmark: for each list of putative peaks ordered by the allocated p values a model was trained using only chromosome 22 to predict the overlap of a tile with a peak from the tile's DNA content. The model was then applied to the whole genome and its predictions compared with the list of putative peaks. The lists, and the peak calling algorithms generating them, that provided more consistent (accurate) predictions deemed to be more accurate. Significant differences in the peak calling algorithms were observed. The article is linked directly to those methods developed by, for both poli i and STAT1, but here the focus is mainly on predicting Pol-II.(2) An extension of annotation: a critical hurdle in the way to full 'mechanistic' interpretation of genetic data is extending the annotation of the human genome such that every regulatory sequence in the genome is identified along with known disease associated genetic variations and changes. The analysis of the transcriptome by NGS methods generates novel genomic expression landscapes, state specific expression, single nucleotide polymorphisms (SNPs), the transcriptional activity of repeat elements and both known and new alternative splicing events. These all have an impact on current models of key signalling pathways '... suggesting that page 1611 16101617

discussion in this article, we aimed to demonstrate that chips eq results can be used to develop robust predictors by training on a small part of the annotated genome and then testing on the remainder, primarily for the purpose of cross checking the consistency of the chips eq results and also for novel genome annotation. As a proof of principle, we have chosen two ENCODE chips eq datasets for binding of the transcription factor STAT1 and the poli i complex. STAT1 experiments have shown that RSV models are superior in learning global patterns compared with standard pwm based approaches. For poli i where pwm s are not applicable, we have compared against the best of class in silico TSS predictors ARTS as TSS is closely related to poli i binding. Though ARTS is our focus as a baseline, we also benchmarked against 16 other specialized algorithms using the methods of. Our predictors are created by a generic algorithm and not a TSS specific procedure Page: 1616 16101617 with customized problem specific input features; for instance, we do not take into account the directionality of the strands, which may improve performance, as such information is not available from empirical chips eq data. Nevertheless, we have demonstrated that the lack of such information does not prevent the development of accurate classifiers on par with dedicated tools such as ARTS at the 500 bp resolution. For our aim of developing a generic and robust technique for genome annotation, ARTS, originally intended for higher 50 bp resolution, is too specialized and overly complex; indeed, ARTS uses five different sophisticated kernel sie. custom developed techniques for feature extraction from DNA neighbourhood of 1000 bp around the site of interest. This includes two spectrum kernels comparing the km er composition of DNA upstream (the promoter region) and down stream of the TSS, the complicated weighted degree kernel to evaluate the neighbouring DNA composition, and two kernels capturing the spatial DNA configuration (twisting angles and stacking energies). Consequently, ARTS is very costly to train and run: it takes  350 CPU hours (, Sec. 3.1) to train and scan the whole genome. Furthermore, for training the labels are very carefully chosen and cross checked in order to avoid misleading clues (, Sec. 4.1). In contrast, our generic approach is intended to be applied to novel and less studied DNA properties, thus we do not assume the availability of prior knowledge. Consequently, our model uses only standard and generic genomic features and all available labelled examples in the training set. It uses only a 137 dimensional 4mer based vector of frequencies in a single 500 bp tile, which is further simplified using feature selection to  80 dimensions. This approach is generic and the training and evaluation is accomplished within 4 CPU hours (We stress again that as stated in Section 3.1, for the sake of fairness, we have used not only chips eq trained RSV models, but also two different models RSV RfG and RSV Ex , which are trained using ref gene annotations only, which were used for training ARTS. However, while ARTS used all ref gene annotations available in hg16 resulting in n + = 8.5K positive and n  = 85K negative examples, we have used a much smaller training set, namely the sites residing on chromosome 22. In the case of RSV Ex , which is by design the closest to the annotation used in the original ARTS publication (), this results in only n + = 1K positive and n  = 12K negative examples, which is more than seven times less than ARTS' training used. Yet, as we see in and 2, the performance of ARTS and RSV Ex tested against ref gene ex annotations are virtually equivalent. The same equivalent performance was seen testing RSV RfG on our ref gene annotation for hg18. Finally, note that model interpretation is very feasible as our RSV models are linear combinations of simple km er frequencies. This creates the potential for novel insights into the molecular mechanisms underpinning the phenomena of interest. We have not yet explored the utility of model interpretation but consider it an important area for future research. We have found that the ROC () do not discriminate well between the performance of different predictors with high precision, which inevitably occurs for low recall (0.5). Similar features are shown by the ROC curves in for the high specificity regions. Thus, ROC and a uroc are not informative for genome wide scans under highly unbalanced class sizes (). The same applies to enrichment scores () and consequently kolmogorov smirnov statistic (see the Section 6 in Supplementary Materials ). One curious point of note is the sharp decline in precision that can be observed as recall  0 in. This can only be caused by the most confidently predicted samples being negatively labelled. One hypothesis is that these are in fact incorrectly labelled true positives. Support for this may be that the decline is not observable when using the exon restricted negative examples in. This hypothesis has been confirmed by testing for human and mouse against annotations by un clustered CAGE tags and is the focus of a follow-up paper. One of the most intriguing outcomes is the very good performance of the RSV Po2 predictor in the tests on the ref gene and ref gene ex datasets and also on the benchmark of. After all, the RSV Po2 was trained on data derived from broad chips eq peak ranges on chromosome 22 only. This chips eq data roz ow sky Page: 1617 16101617) was derived from HeLa S3 cells (an immortalized cervical cancer derived cell line) which differ from normal human cells. Those peaks should cover most of the TSS regions but, presumably, are also subjected to other confounding phenomena [e.g. poli i stalling sites (. In spite of such confounding information, the training algorithm was capable of creating models distilling the positions of the carefully curated and reasonably localized TSS sites in ref gene. This warrants a follow-up investigation, which we intend to conduct in the near future.
