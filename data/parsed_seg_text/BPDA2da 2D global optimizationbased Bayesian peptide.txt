Motivation: Peptide detection is a crucial step in mass spectrometry (MS) based proteomics. Most existing algorithms are based upon greedy isotope template matching and thus may be prone to error propagation and ineffective to detect overlapping peptides. In addition, existing algorithms usually work at different charge states separately, isolating useful information that can be drawn from other charge states, which may lead to poor detection of low abundance peptides. Results: BPDA2d models spectra as a mixture of candidate peptide signals and systematically evaluates all possible combinations of possible peptide candidates to interpret the given spectra. For each candidate, BPDA2d takes into account its elution profile, charge state distribution and isotope pattern, and it combines all evidence to infer the candidates signal and existence probability. By piecing all evidence together especially by deriving information across charge states low abundance peptides can be better identified and peptide detection rates can be improved. Instead of local template matching, BPDA2d performs global optimization for all candidates and systematically optimizes their signals. Since BPDA2d looks for the optimal among all possible interpretations of the given spectra, it has the capability in handling complex spectra where features overlap. BPDA2d estimates the posterior existence probability of detected peptides, which can be directly used for probability based evaluation in subsequent processing steps. Our experiments indicate that BPDA2d outperforms state of the art detection methods on both simulated data and real liquid chromatography mass spectrometry data, according to sensitivity and detection accuracy. Availability: The BPDA2d software package is available at

introduction liquid chromatography coupled to mass spectrometry (LCMS) is widely used for large scale protein profiling of complex biological * To whom correspondence should be addressed. samples. In a typical LCMS experiment, peptides from digested protein mixture go through an LC column with different speeds depending on their physicochemical properties. Eluent from the chromatography is ionized and analyzed by mass spectrometer, which measures ions according to their mass to charge (m/z) ratios. The resulting LCMS dataset usually contains hundreds to thousands of mass spectra indexed by the LC retention time. Analysis of LCMS experiments by computational methods is challenged by the huge data size and rich information contained, and moreover complicated by several facts including: (i) proteins contained in complex samples such as plasma and tissue extracts have a wide dynamic concentration range (e.g. 10 orders of magnitude), plus peptides differ in ionization efficiencies, which means that the observed peptide signal from MS data may also have a wide dynamic range. While high abundance peptides are relatively easy to be identified, low abundance peptides proteins which are often of more biological importance, are likely to be buried under noise or interfering signals and thus hard to be detected (The shape of peptide chromatographic peaks is not well predicted (). Due to experiment settings and the nature of the analytes, asymmetric shape or plateaus of chromatographic peaks may be observed, which requires designed detection algorithms to be robust in tracking signals from various peptide species and be adaptable across experiments. (iii) One peptide can be multiply charged and can register a group of isotopic peaks at each charge state. Correctly identifying all the peaks and assigning them to the right peptide is a non-trivial task. (iv) The signal density can be very high even in high resolution LCMS data and overlapping peptide peaks are commonly observed, the detection of which is very challenging. Accurate identification and quantification of proteins is essential for biomarker discovery, drug development and disease classification (). Fragmentation spectra produced by tandem mass spectrometry (MS2) are frequently used by popular software such as se quest and Mascot () for database searching to give peptide identifications. However only a small percentage of peptides present in the sample get selected for fragmentation analysis and of these selected peptides even fewer can be correctly identified by database searching due to spectra matching ambiguity or co eluting precursor ions (). Furthermore, quantitation of peptide abundance based on MS2 spectra counting is very rough, and highly variable especially for low abundance peptides (). [Though by using well established stable isotope labeling approaches such as

conclusion we have presented BPDA2d, a global optimization based Bayesian peptide detection algorithm for LCMS data. Feature extraction
