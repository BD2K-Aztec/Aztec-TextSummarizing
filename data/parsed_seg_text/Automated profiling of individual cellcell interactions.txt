Motivation: There is a need for effective automated methods for profiling dynamic cell cell interactions with single cell resolution from high throughput time-lapse imaging data, especially, the interactions between immune effector cells and tumor cells in adoptive immunotherapy. Results: Fluorescently labeled human T cells, natural killer cells (NK), and various target cells (NALM6, K562, EL4) were co incubated on poly dimethyl siloxane arrays of sub nano liter wells nano wells and imaged using multi-channel time-lapse microscopy. The proposed cell segmenta-tion and tracking algorithms account for cell variability and exploit the nano well confinement property to increase the yield of correctly analyzed nano wells from 45% (existing algorithms) to 98% for wells containing one effector and a single target, enabling automated quantification of cell locations , morphologies, movements, interactions, and deaths without the need for manual proofreading. Automated analysis of recordings from 12 different experiments demonstrated automated nano well delineation accuracy 99%, automated cell segmentation accuracy 95%, and automated cell tracking accuracy of 90%, with default parameters, despite variations in illumination, staining, imaging noise, cell morphology, and cell clustering. An example analysis revealed that NK cells efficiently discriminate between live and dead targets by altering the duration of conjugation. The data also demonstrated that cytotoxic cells display higher motility than non killers both

introduction dynamic cell behaviors, especially cell cell interactions, are of vital interest in immunology (), cancer biology () and stem cell engineering (). Automated time-lapse microscopy of live cells in vitro is a well established method for spatiotemporal recording of cells and biomolecules, and tracking multi-cellular interactions. Unfortunately, most conventional methods assess limited numbers (10100) of manually sampled 'representative' cell pairs, leading to subjective bias and therefore lack the ability to quantify the behaviors of statistically under-represented cells reliably. This is significant since many biologically significant cellular subpopulations like tumor stem cells, multi killer immune cells and bio technologically relevant protein secreting cells, are rare. There is a need for methods to sample cell cell interaction events on a larger scale to investigate such cellular phenomena. Recent advances have enabled the fabrication of large arrays of sub nano liter wells nano wells cast onto transparent biocompatible poly dimethyl siloxane substrates (;). Small groups of living cells from clinical samples, and laboratory engineered cells can be confined to nano wells and imaged over extended durations by multi-channel time-lapse microscopy, allowing thousands of controlled cellular events to be recorded as an array of multi-channel movies (). We refer to this method as Time-lapse Imaging Microscopy In nano well Grids (TIMING). The spatial confinement can enable a rich sampling of localized cellular phenomena, including cell movements, cellular alterations, and cell cell interaction patterns, along with the relevant intra-cellular event markers (). TIMING is thus ideally suited for tracking cell migration and interactions at short distances but if cell migratory patterns over larger distances are of interest, arrays with larger wells can be fabricated. Similarly, if unconfined migratory behavior of cells is desired, other methods have been described (). The promise and challenge of nano well arrays, is high throughput, eliminating the need for user selection of events of interest, and the ability to repeatedly follow the same cell(s) over time illustrates a TIMING dataset consisting of 11 000 nano wells containing fluorescently tagged human CAR  t cells (red) and NALM-6 tumor cells (green) that were imaged by time-lapse microscopy over 80 time points at 5-min intervals to yield an array of 4 channel movies, one per nano well. The border nano wells from each block are discarded, yielding 25 usable nano wells block. TIMING datasets vary in size between 200 GB and 1.5 TB depending upon the array size, and the number of time points. A sample TIMING dataset corresponding to one block is provided as Supplementary Material A. Production datasets are often of lower quality than the example in, for example, see (4) and exhibit natural cellular variability, variations in signal to noise ratio (SNR), staining variations, focus drift, spectral overlap between fluorochromes and photobleaching. Our goal is to develop highly automated pipeline of algorithms that can reliably segment and track the cells in TIMING datasets with minimal parameter tuning, and yield a sufficiently rich set of cellular scale measurements for statistical profiling, without the need for manual proofreading (Supplementary Material B). A direct application of general purpose segmentation and tracking algorithms is not a viable strategy since their yield (the number of correctly analyzed nano wells is surprisingly low, and their parameter tuning needs are high. For example, a direct application of al segmentation algorithm with a reported accuracy 95% that is the core of the open source FARSIGHT toolkit farsight toolkit org to the dataset in produces an error free yield of only 43% of the nano wells for the basic case when a nano well contains one effector and one target (). The situation with tracking algorithms is similar. For example, in analyzing one sample block containing 36 nano wells out of which 21 contained at least one cell, a state of the art algorithm () accurately tracked only six nano wells with an array of 168  70 nano wells arranged in blocks of 7  7 (with 5  5 usable inner nano wells block. (B) Enlarged views of five blocks highlighted by the red box in Panel A. (C) time series data at 5-min intervals for the nano well highlighted by the red box in Panel B. (D) Enlargement of a single frame of the time-lapse series for the nano well shown in Panel C, showing 3 NALM-6 target cells (green), one cd19 specific CAR  t cell (red, lower right) in contact with a target cell (contact region appears yellow) and a red fluorescent debris particle that is rejected in the analysis (left edge) (Color version of this figure is available at Bioinformatics online.). Illustrating automated image analysis challenges. (AH) Sample image frames. The red arrows indicate unclear boundaries between adjacent cells. The yellow arrows highlight low intensity cells that are difficult to detect. The green arrows highlight cells that are difficult to segment due to non-uniform fluorescence. Panels A, B, D, E and F exemplify frames with low contrast and SNR. (I) Mean and standard deviation (error bars) of the background intensity (dark gray) and the foreground intensity (light gray) for the panels AH. (J) Variation in fluorescence distribution both across the pixels associated with one cell, and across cells. The red and blue histograms correspond to the cell indicated by the red and blue dots, respectively, in Panel H (Color version of this figure is available at Bioinformatics online.) zero errors (yield of 28%) (Supplementary Material C). When the yield falls below 90%, manual proofreading is essential to identify the nano wells that were tracked accurately. If on the other hand, when the automated accuracy exceeds 90%, the user can simply accept the automated results, and the modest error that they entail. general purpose segmentation and tracking algorithms are inadequate because they do not exploit the powerful constraints that are germane to TIMING datasets, specifically, the spatial confinement of cells and rarity of cell divisions. They also lack mechanisms to cope with the higher morphological variability and non-uniform fluorescence of cell bodies compared with cell nuclei that were heavily studied in the prior literature (). In this article, we present algorithms that exploit the confinement and cell cycle constraints, and utilize novel segmentation approaches to increase the yield to 98% for the basic case noted above (Results section, compare versus and deliver high tracking accuracies (). At this level of performance, the quantitative measurements derived from automated segmentation and tracking can be directly utilized for statistical studies without the need for manual proofreading. The following sections describe our methodology.
