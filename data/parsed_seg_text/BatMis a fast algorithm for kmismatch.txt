Motivation: second generation sequencing (SGS) generates millions of reads that need to be aligned to a reference genome allowing errors. Although current aligners can efficiently map reads allowing a small number of mismatches, they are not well suited for handling a large number of mismatches. The efficiency of aligners can be improved using various heuristics, but the sensitivity and accuracy of the alignments are sacrificed. In this article, we introduce Basic Alignment tool for Mismatches b atm is an efficient method to align short reads to a reference allowing k mismatches. bat mis is a burrows wheeler transformation based aligner that uses a seed and extend approach, and it is an exact method. Results: Benchmark tests show that bat mis performs better than competing aligners in solving the k mismatch problem. Furthermore, it can compete favorably even when compared with the heuristic modes of the other aligners. bat mis is a useful alternative for applications where fast k mismatch mappings, unique mappings or multiple mappings of SGS data are required.

introduction second generation sequencing (SGS) technologies generate a high volume of sequencing data economically and this abundance of data has introduced new possibilities to genomic studies. Applications such as whole genome sequencing (), gene expression profiling () and chips eq () have benefited from it. All these applications need to map the SGS reads to a reference genome. Due to the differences between the sampled genome and the reference genomes and the errors introduced during the sequencing process, the mapping needs to be done allowing a reasonable number of errors. Mapping SGS reads in general require the ability to map indels. However, for platforms like Illumina and SOLiD, most of the reads can be aligned allowing mismatches only. In fact, some popular aligners like Bowtie () only  The authors wish it to be known that, in their opinion, the first two authors should be regarded as joint First Authors. * To whom correspondence should be addressed. consider mismatches in alignment, while many others consider only mismatches by default (). There are many experiments where a large number of mismatches are allowed, sometimes along with indels (). Therefore, the k mismatch problem, i.e. mapping a short read allowing k mismatches to a reference genome, is an interesting problem in bioinformatics. Although the general k mismatch problem can be solved heuristically with generic aligners like BLAST () or exactly with aligners like bwt sw (), they are not practical solutions to handle tens of millions of reads produced by SGS. Therefore, specialized aligners for short read mapping are needed and the existing aligners can be broadly categorized into two classes. The first class uses a variety of hashing methods or the indexing data structure BWT to index the reference genome (). Others use hashing methods to index the reads (). Then, by enumerating possible mismatch patterns, the reads are aligned onto the genome. When the number of mismatches is not high, these aligners are very efficient. However, the running time will increase rapidly when the number of mismatches increases. The hashing based methods become slow since they need to look up many hash table entries as the number of allowed mismatches increases. bwt based aligners, since they simulate suffix prefix tree traversal, become slow due to the rapid increase of branches that needs to be traversed as the number of mismatches increases. As shown in Section 3, the current aligners are slow or inadequate to handle even moderate numbers of mismatches. To overcome the slow down with large mismatches, aligners use various heuristic methods. A common solution is to use seeding methods [e.g. BWA, Bowtie and el and (. In these methods, selected seed regions of a read are aligned to the reference allowing a small number of mismatches and these alignments are extended allowing k mismatches. Some specialized methods like razer s () can guarantee to find a given percentage of correct alignments. These methods cut down the alignment time dramatically. However, applying these heuristics to solve the k mismatch problem will result in a loss of sensitivity and accuracy. Different types of experiments require different types of mappings. The most basic type of alignment reports the first hit of a read satisfying a given mismatch threshold. However, in some experiments, hits are required to satisfy some form of a uniqueness criterion. For example, in chips eq experiments, scientists might prefer to map reads uniquely for better accuracy. Other situations require multiple hits for each read. For example, rnase q pipelines like top hat () need an external aligner to

discussion the solution for the k mismatch mapping is important to second generation sequencing. We introduced a new algorithm bat mis that can solve the k mismatch problem exactly and efficiently. We checked the ability to find least mismatch hits, unique hits and multiple hits of some of the current state of the art aligners. Our results show that some aligners can not reliably map reads with a large number of mismatches. On the other hand, bat mis was able to recover all the hits and was faster. Finally, bat mis is faster or has a comparable performance with the heuristic methods of other aligners. These results show that bat mis is a robust aligner that performs well at all mismatch thresholds. One limitation of bat mis is that it can not handle paired end reads and indels. We believe that bat mis is a useful alternative for mapping SGS reads when we want to perform multiple mapping, unique mapping or when we want to tolerate a large number of mismatches.
