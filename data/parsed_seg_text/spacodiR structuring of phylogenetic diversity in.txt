Motivation: spa co dir is a cross platform package, written for the R environment, for studying partitioning of diversity among natural communities in space and time. Complementing and extending existing software, spa co dir allows for hypothesis testing and parameter estimation in studying spatial structuring of species-, phylogenetic and trait diversities. Availability: Integrated with other software in the R environment and with well documented and demonstrated functions, spa co dir is an open source package and available at http://cran.r

introduction until recently, the formalized importance of historical processes in the development of communities had been largely neglected (see). With ongoing development in the field of community phylogenetics, time dependent processes can now be directly integrated into the study of community diversity and assembly. Yet, available software for such analyses is often idiosyncratic, requiring unique data formats or a particular platform (but see). Our aim here is to provide a cross platform package spa co dir that can inform the processes contributing to sorting of phylogenetic-, species and trait diversities among communities. To this end, we use the highly flexible and actively developed R environment (R Development Core), providing spa co dir as an adaptation and extension of the c coded software spa codi (Spatial and Phylogenetic Analysis of Community Diversity) developed by Hardy (2010). Here, we describe the central functionality of the spa co dir package. spa co dir is poised to study scale dependencies of diversity partitioning in space and time. Fast computation for the most demanding tasks is facilitated by compiled c coded functions.

description here we adopt the statistical framework of Hardy and senter re (2007) in testing pattern deviation of diversity partitioning in * To whom correspondence should be addressed. communities from null expectations. Relevant measures of diversity in spa co dir concern species identity, evolutionary relatedness and (or) trait similarity. The framework implements a variance decomposition approach of Rao's (1982) quadratic entropy (QE), which partitions total entropy into within and among sample components. The measure of diversity can be explicitly phylogenetic by considering the extent of co ancestry shared by two organisms in a community ecological sample. If evolutionary relatedness among organisms within a sub community is quite high (i.e. all sampled organisms descend from a recent ancestor), the sub community would be said to exhibit little phylogenetic diversity (). Hardy and senter re (2007) use a spatial decomposition of pairwise divergences among organisms sampled from within and between different sub communities to define a balance in diversity found within versus between samples. Diversity in spa co dir is thus measured in two primary manners: one index considers species composition (I ST ) and another considers evolutionary relatedness (P ST ) within and among samples. These indices of diversity partitioning, I ST and P ST , estimate parameters ranging from 0 to 1 and respectively correspond to the average deficit of species and phylogenetic diversity within versus among samples. I ST signifies the extent to which the average likelihood of species identity for two randomly drawn individuals in a local sample exceeds that at the regional scale; P ST expresses the local excess of phylogenetic relatedness relative to the mean phylogenetic relatedness of species pairs drawn from the regional sample (). If phylogenetic structure among species is completely lacking (i.e. as for a star phylogeny), P ST , as a generalized expression of the gini simpson index of diversity (), simply reduces to I ST. Unlike similar implementations of QE in community phylogenetics (e.g. see), we explicitly treat community data as statistical samples for parameter estimation, following Hardy and Jost (2008). A key parameter of interest in community phylogenetics and which we estimate in spa co dir is how phylogenetic diversity is partitioned among samples. Species occurrence data may be given as presence absence individual abundances by species, or as relative abundances. Insofar as P ST involves a measure of species diversity (the phylogenetic diversity of two samples drawn from the same species is null), we can consider extracting the component of P ST explained solely by phylogeny. For this purpose, hardy and constructed the index B ST , which isolates the balance of evolutionary relatedness at local and regional scales from P ST. The B ST index, then, is closely related to P ST I ST. Where B ST  0 or where P ST  I ST , distinct species within a local sample are more related on average than distinct species from different samples, a pattern referred to as spatial phylogenetic clustering (or under dispersion e.g.). Alternatively, where B ST  0 or I ST  P ST , distinct species within a local sample are less related on average than distinct species from different samples; phylogenetic diversity is thus spatially over dispersed (even) in distribution (e.g.). A fourth index, ST (), is equivalent to B ST but considers presence absence rather than relative abundances of species within samples, thereby reducing the relative weight of the most abundant species. (In spa co dir ST is termed 'PI ST ' owing to the difficulty displaying Greek letters.) Note that, as B ST , ST can not be estimated when a community has fewer than two species because the index considers only pairs of distinct species (a typographical error in the formula given in Hardy and is corrected in the R documentation of spa co dir. Significant departures from zero for these estimators may be used to inform processes of community assembly (), and several permutation tests (see Hardy 2008) are available within the software. spa co dir provides the capability to compute each of these four indices at the global scale (i.e. considering all data) as well as for all pairwise comparisons between samples. Partial tree randomization tests allow investigators to discern whether non-random patterns of structuring exhibit temporal or lineage dependency (see). Direct assessment of spatial structuring of trait diversity may be essential to distinguishing neutral from non neutral processes of assembly. We note that estimation of P ST , B ST and ST need not only involve phylogenetic distances also but is amenable to applications involving phenotypic dissimilarities between species. Indeed, QE can be appropriately used for all dissimilarity matrices constructed from ultrametric distances between species (). Structuring of phylogenetic diversity is often used as a surrogate to make inferences concerning trait based assembly, where hypotheses for which traits are assembly relevant are absent. In essence, the phylogeny expresses the expected covariance structure among species for an idealized phenotype (see Felsenstein, 1973). Spatial clustering of phylogenetic diversity is often interpreted as evidence for local environmental filtering of (these idealized and unknown) traits (e.g. Cavender). The contrast between structuring of phylogenetic and phenotypic diversities should provide substantial new insights into non neutral evolutionary and assembly processes. Beyond constructing tests to determine whether diversity partitioning departs significantly from null expectations, spa co dir can be readily applied to formal tests of which environmental or spatial correlates provide significant explanations of the indices of diversity partitioning. We refer readers elsewhere for examples of such tests (see).
