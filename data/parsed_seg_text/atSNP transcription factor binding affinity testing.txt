Motivation: genome wide association studies revealed that most disease associated single nucleotide polymorphisms (SNPs) are located in regulatory regions within introns or in regions between genes. Regulatory SNPs r snps are such SNPs that affect gene regulation by changing transcription factor (TF) binding affinities to genomic sequences. Identifying potential r snps is crucial for understanding disease mechanisms. In silico methods that evaluate the impact of SNPs on TF binding affinities are not scalable for large scale analysis. Results: We describe affinity testing for regulatory SNPs at snp a computationally efficient R package for identifying r snps in silico. at snp implements an importance sampling algorithm coupled with a first order Markov model for the background nucleotide sequences to test the significance of affinity scores and snp driven changes in these scores. Application of at snp with 20 K SNPs indicates that at snp is the only available tool for such a large scale task. at snp provides user friendly output in the form of both tables and composite logo plots for visualizing snp motif interactions. Evaluations of at snp with known rs nptf interactions indicate that at snp is able to prioritize motifs for a given set of SNPs with high accuracy. Availability and implementation: https://

introduction genome wide association studies have been instrumental in identifying single nucleotide polymorphisms (SNPs) associated with large numbers of phenotypes. The vast majority of association SNPs are in non-coding regions, suggesting that they may have regulatory roles in deriving the phenotype (). In particular, regulatory SNPs which alter binding affinity of transcription factors and affect gene expression constitute an important class of such SNPs (). A standard in silico approach for identifying r snps is by evaluating how the snp driven nucleotide change impacts binding affinity of TFs to the region surrounding the SNP (). Specifically, the DNA sequences around each SNP are scored against a library of TF motifs with both the reference and the SNP alleles using position weight matrices pwm s () of the motifs. SNPs with significantly different scores between the reference and SNP alleles are then hypothesized as r snps. We describe at snp an R package that carries out the following tasks for every snp motif combination of the input data after extracting genome sequences of small windows (630 bps) around the SNP positions: (i) computing affinity scores for both alleles; (ii) statistical testing for allele specific affinity scores; (iii) statistical testing for changes in affinity scores between alleles. A few existing tools can perform various subsets of these tasks (). The most distinctive feature of at snp is its ability to accommodate large scale analysis (e.g. over  20 K SNPs). is r snp has the most similar functionality to at snp however, is r snp (both 1.0 and 2.0) can only analyze at most 20 SNPs at a time. Similarly, TRAP takes as input only one SNP. Although r snp mapper can take as input larger number of SNPs, it lacks critical calculations such as the significance of snp driven affinity change. FIMO is not designed for evaluating SNP impact on affinity scores; however, it enables p value computation for affinity scores and can be used to compare scores under different alleles. However, due to computational reasons, FIMO can only accommodate outputting results thresholded by a small prespecified significance level for large SNP sets. In our hands with a 24 AMD Opteron 2.2 GHz processor, a FIMO run for 26 100 SNPs against a single PWM without thresholding could not finish within 24 hours whereas at snp required less than 5 minutes. The main computational burden of both FIMO and is r snp is the computation of the exact p values by enumerating all possible sequences and computing their scores under the null hypothesis. at snp utilizes an importance sampling technique to overcome this challenge (Supplementary Materials).
