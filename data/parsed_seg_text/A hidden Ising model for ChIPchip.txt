Motivation: Chromatin immunoprecipitation (ChIP) coupled with tiling microarray (chip) experiments have been used in a wide range of biological studies such as identification of transcription factor binding sites and investigation of DNA methylation and histone modification. Hidden Markov models are widely used to model the spatial dependency of chip chip data. However, parameter estimation for these models is typically either heuristic or suboptimal, leading to inconsistencies in their applications. To overcome this limitation and to develop an efficient software, we propose a hidden ferromagnetic Ising model for chip chip data analysis. Results: We have developed a simple, but powerful Bayesian hierarchical model for chip chip data via a hidden Ising model. Metropolis within Gibbs sampling algorithm is used to simulate from the posterior distribution of the model parameters. The proposed model naturally incorporates the spatial dependency of the data, and can be used to analyze data with various genomic resolutions and sample sizes. We illustrate the method using three publicly available datasets and various simulated datasets, and compare it with three closely related methods, namely tile map HMM, tile hmm and BAC. We find that our method performs as well as tile map HMM and BAC for the high resolution data from Affymetrix platform, but significantly outperforms the other three methods for the low resolution data from Agilent platform. Compared with the BAC method which also involves MCMC simulations, our method is computationally much more efficient. Availability: A software called i chip is freely available at

introduction identification of the sites of interactions between proteins and genomic DNA is one of the most important topics in biological research. The emergence of high density tiling microarrays has made it possible to create high resolution global maps of the in vivo interactions between specific proteins and genomes. Tiling arrays use millions of short oligonucleotide probes with various resolutions to interrogate genomic regions of interest. Chromatin immunoprecipitation chip chip analysis has become a powerful technique used to determine the binding sites of dna binding * To whom correspondence should be addressed proteins at a genome wide basis (). It is a challenge to analyze chip chip data, due to the huge amount of probes, the small number of replicates and various noises introduced in the experiments. The most important feature of chip chip data is the neighboring dependency of the probe intensities. Quite a few of existing methods in the literature make efforts to incorporate the dependence structure of chip chip data into various statistical models. Sliding window methods may be the most straightforward ones. These methods are to test a hypothesis for each probe or region using the statistic that is built based on all the probes' information within a sliding window of certain genomic distance. The test statistics used are varied. For example used wilcoxon s rank sum statistics used the moving average of classical t statistics Ji and used the moving average of empirical Bayesian t statistics and used the moving average of log2 ratios. Since a huge number of tests are performed and the test statistics are not independent, these approaches leave with a difficult problem for multiple hypothesis testing adjustment. Two significant variants of the sliding window methods are the joint binding deconvolution (JBD;) and the model based deconvolution (with the software medic hi (), which fit a local regression for each probe with the nearby probes within a sliding window used as explanatory variables, and the inference is made based on the fitted regression coefficients. Hidden Markov models (HMMs;) are appealing approaches to model the dependency of chip chip data. However, in most of the existing implementations of HMM methods, parameter estimation for the models is typically either ad hoc or suboptimal for chip chip data. For example estimated the model parameters using the results from a previous Affymetrix SNP array experiments estimated the model parameters using the baum welch algorithm ().used the baum welch algorithm () plus Viterbi training () to estimate the model parameters. The major limitation of these algorithms, as pointed out by, is that the baum welch algorithm tends to converge to a local maximum of the likelihood function and the Viterbi training algorithm even fails to converge to a local maximum of the likelihood in some cases. Therefore, the parameter estimates and followed inference are often suboptimal to the problem. Markov random fields is a natural generation of Markov processes in which a space index is used to replace the time index. Markov random field models are appealing alternative approaches for chip chip data because the spacial dependency can be naturally modeled page 778 777783

discussion in this article, we have presented a simple, but powerful Bayesian hierarchical method to model chip chip data through a hidden ferromagnetic Ising model. This approach naturally takes into account the intrinsic dependency of chip chip data, and can be used to analyze data with various genomic resolutions and sample sizes. We comparatively evaluated our method and three closely related methods using three real and various simulated datasets. The results showed that our method performed as well as tile map HMM and BAC in terms of sensitivity and specificity in detecting ip enriched regions for the high resolution data. However, our method significantly outperformed the alternatives for the low resolution data. The results showed that tile hmm did not work consistently. It essentially failed for the p53, Nanog and Oct4 data because it was not able to distinguish enriched and non enriched probes (see, 3 and). The regions detected by tile hmm are obviously dominated by false positives. However, it worked as well as the three alternative methods on the simulated high resolution data (, C and E). For the simulated low resolution data, tile hmm had extremely high false positive rates at various posterior probability cutoffs (, D and F). Since all the four methods essentially make efforts to estimate the state (enriched or non enriched of each probe, ideally it is expected that probe level posterior probabilities should be dichotomized, either close to 1 (for the enriched state) or 0 (for the non enriched state), which can be used as a criterion for evaluating the performance of these methods. In terms of dicho to mization our method performed the best, followed by tile map HMM and BAC, and tile hmm performed the worst. The three alternative methods used for comparison in this article are closely related to the Ising model we use. The Markov model is essentially a 1D Ising model (for details see). Vice versa, the model we proposed can also be treated as a HMM in which the transition matrix is determined by the interaction parameter , and the emission probabilities are determined by the Equation (9). In addition, the Gaussian intrinsic auto-regression model used by can also be viewed as a continuous extension of the Ising model. Since all the four methods basically use the same idea to model chip chip data, why does our method outperform the others for the low resolution data? This could be owed to the way we model the data and the algorithm used for parameter estimation. In our method, Metropolis within Gibbs sampling algorithm is used to estimate the model parameters, which is known to converge to their target distributions when the number of iterations becomes large.
