Motivation: Abundance profiling (also called phylogenetic profiling) is a crucial step in understanding the diversity of a meta genomic sample, and one of the basic techniques used for this is taxonomic identification of the meta genomic reads. Results: We present tax on identification and phylogenetic profiling (TIPP), a new marker based tax on identification and abundance profiling method. TIPP combines sate enabled phylogenetic placement a phylogenetic placement method, with statistical techniques to control the classification precision and recall, and results in improved abundance profiles. TIPP is highly accurate even in the presence of high in del errors and novel genomes, and matches or improves on previous approaches, including NBC, mOTU, phy mm bl meta phyl er and meta phl an. Availability and implementation: Software and supplementary materials are available at

introduction meta genomic studies of microbial communities commonly generate millions to hundreds of millions of sequencing reads the assignment of accurate taxonomic labels to these sequences is a critical component in many analyses but is complicated by the fact that the majority of the organisms found in environmental or host associated communities can not be easily cultured in a laboratory, and of the organisms that can be cultured, an even smaller number have been sequenced, even partially. Thus, these commonly encountered organisms are largely absent from existing databases of known genomes and genes. Providing taxonomic labels to meta genomic sequences requires extrapolating the knowledge contained in sequence databases to previously unseen deoxyribonucleic acid (DNA) strings. Simple similarity based approaches (e.g. picking the best database hit as the best 'guess' at the taxonomic label) have been shown to be insufficiently accurate (), leading to the development of new and more sophisticated methods. Recently developed methods improving on the simple similarity based approaches include (a) composition based approaches that rely on various machine learning techniques (Support Vector Machines in phylo pythia and phylo pythias (), Interpolated Markov Models in phy mm (), Bayesian models in NBC), or neural networks ()] to classify sequences based on their DNA composition (usually based on the frequency of short km ers (b) more sophisticated analyses of similarity search results [e.g. using lowest common ancestor aggregation in Megan (), or classifiers built from similarity search results as done in meta phyl er (), meta phl an () and mOTU () or protein profiles in Carma ()], and (c) combinations of multiple approaches (e.g., composition and similarity based approaches in phy mm bl (). Some of these approaches (e.g. most of the composition based approaches) can be applied to any DNA sequence. However, others are specific to a reference collection of carefully selected genes (e.g. meta phyl er meta phl an and mOTU use a collection of universal or clade specific marker genes), and so are called marker based methods. Abundance profiling, also called 'phylogenetic profiling', seeks to estimate the relative abundance of the species (or genera, or families, etc.) within a sequence dataset. While many methods produce these estimates by characterizing most (or all) of the sequences in the dataset, marker based methods produce these estimates by characterizing only those sequences that match the marker genes they rely on. The marker genes used by some of these methods (e.g. meta phyl er and mOTU) are supposed to be single copy and universal; thus, the estimates produced using such markers can be used for profiling without needing to correct for copy number or missing data. We present tax on identification and phylogenetic profiling (TIPP), a new marker based method for tax on identification and abundance profiling. We explore TIPP for abundance profiling using meta phyl ers collection of 30 marker genes, but TIPP can be used with any single copy gene for which a dense enough sample of full length sequences is available. TIPP is implemented in Python and can be run on Unix and Mac.

discussion the study compared four marker based methods (mOTU, TIPP, meta phyl er and meta phl an and two composition based methods phy mm bl and NBC) on a collection of datasets. On the easy datasets with only known genomes (Experiment 1), many methods produced highly accurate abundance profiles, although which method was the best depended on the read length. On the easy short read datasets the most accurate methods were mOTU, meta phl an and TIPP, while the most accurate methods on the easy long read datasets were TIPP and NBC, with meta phl an a close third. However, when datasets had novel genomes or high in del error rates, the performance of most methods degraded significantly. For example, while NBC had excellent accuracy on the easy long read datasets, it had poor accuracy in the presence of high in del rates. Similarly, although mOTU had excellent accuracy on easy short read datasets with known genomes, it had poor performance on short read datasets with novel genomes and terminated with an error message on the datasets with high in del rates. We also saw that meta phyl er had difficulties on datasets with long sequences and high indels (Experiments 2 and 3). TIPP did well on the easy datasets (known genomes with low sequencing error rates), where it tied for first with other methods. However, TIPP was the only method that was robust to all the tested model conditions (short versus long reads, novel versus known genomes, low in del versus high in del error rates), so that it was either first or tied for first under even very difficult conditions (novel genomes with high in del rates). Consequently, TIPP dominated the other methods in terms of overall performance. Thus, one of the main features of TIPP is its relative robustness to sequencing errors (both substitutions and indels) and its ability to perform well on novel genomes. We conjecture that the HMM Family technique within TIPP provides this robustness, which uses HMMs in a divide and conquer framework, and also benefits from the use of local alignment techniques. Therefore, the high error rates commonly encountered in single molecule sequencing technologies [up to 14% in del rate for Pacific Biosciences technologies (] that are likely to be increasingly used in the context of meta genomic data may not be particularly problematic for TIPP, even when the data contain novel genomes. Instead, our results indicate that TIPP may well continue to have good accuracy with new sequencing technologies that result in reduced data quality. One of the interesting observations in this study is that the marker based methods (TIPP, meta phl an mOTU and meta phyl er often gave more accurate abundance profiles than the composition based methods (NBC and phy mm bl even though marker based methods estimate abundance profiles by characterizing only those reads that map to their selected marker genes. These results show that accurate profiles can be obtained by taxonomic characterization of only a fraction of the query sequences. However, the choice of marker genes, and the technique used to bin the reads to the markers, has an impact on the resultant abundance profile. Thus, future research should investigate whether improved performance can be obtained using a different set of marker genes and different techniques to map reads to the marker genes. Also, our abundance profile estimates were based on combining all reads for all markers into one set, and using the distribution estimated for that set; more sophisticated techniques could be used to combine distributions estimated for each marker.
