Motivation: Alignment of medical images is a vital component of a large number of applications throughout the clinical track of events; not only within clinical diagnostic settings, but prominently so in the area of planning, consummation and evaluation of surgical and radio therapeutical procedures. However, image registration of medical images is challenging because of variations on data appearance, imaging artifacts and complex data deformation problems. Hence, the aim of this study is to develop a robust image alignment method for medical images. Results: An improved image registration method is proposed, and the method is evaluated with two types of medical data, including biological microscopic tissue images and dental X-ray images and compared with five state of the art image registration techniques. The experimental results show that the presented method consistently performs well on both types of medical images, achieving 88.44 and 88.93% averaged registration accuracies for biological tissue images and X-ray images, respectively, and outperforms the benchmark methods. Based on the tu keys honestly significant difference test and Fishers least square difference test tests, the presented method performs significantly better than all existing methods (P 0.001) for tissue image alignment, and for the X-ray image registration , the proposed method performs significantly better than the two benchmark b spline approaches (P50.001).

introduction image registration is the process of systematically placing separate images in a common coordinate system so that the information they contain can be optimally integrated or compared. This is becoming the central tool for image analysis, understanding and visualization in both medical and scientific applications (). Time series of images are acquired for various reasons, such as monitoring of bone growth in children, monitoring of tumor growth, post-operative monitoring of healing or observing the passing of an injected bolus trough a vessel tree, and image registration plays an important role for these medical applications. However, alignment of medical images is challenging because of variations on data appearance, imaging artifacts and complex data deformation problems, making existing registration approaches unstable and performs poor (); Section 2 shows the experimental results of four existing registration methods. Although there has also been substantial progress in non-rigid registration algorithms that can compensate for tissue deformation or align images from different subjects, many registration problems remain unsolved (). From literature review (), the raw data tends to be carefully prepared, showing little morphological distortions or stain variation, to simplify the registration task. In addition, they tend to work with low resolution images without dealing with high precision tissue or cell level registration. The aim of this work is to investigate a robust and fully automatic image registration method for medical images. Two types of medical data are included in this study. One is serial microscopic tissue images with conventional histopathological hematoxylin and eosin (HE) staining, and the other is dental X-ray images acquired using different radiation time from 0.04 to 2.5 s with slightly different capturing views illustrates challenges with respect to data variations in our experimental data for image alignment. There are various types of image registration techniques (), which can be categorized into area based methods and feature based methods. zito va and Flusser () suggested that feature based methods are recommended if the images contain enough distinctive and easily detectable objects, which is usually the case of applications in remote sensing and computer vision, and area based methods are usually used for medical images, which are not so rich in such details. In this study, we first evaluated five existing image registration techniques on the collected medical images. They are one feature based method, i.e. SURF (), which is popularly adopted for remote sensing and general computer vision applications, and four area based methods demonstrated to be useful for biological images, including a unidirectional elastic b spline model un war pj (), an improved bi-directional elastic b spline model bun war pj (), a state of the art 3D reconstruction system *To whom correspondence should be addressed trakem2 () and mutual information based image registration approach () using the MATLAB implementation (MathWorks). The five benchmark methods (SURF, un war pj bun war pj TrakEM2 and mutual information) are briefly described later in the text. SURF speeded up robust features) () is a scale and rotation n variant detector and descriptor based on sums of 2D Haar wavelet responses, and the method is a popularly adopted technique and widely applied to general computer vision applications such as remote sensing image alignment () and object recognition task (). However, as for medical images, local image features can appear confusing to one another; SURF does not perform well on corresponding feature identification. Thus, this method tends to fail in our experiment (see Section 2 shows the results of corresponding landmark detection by SURF in application to general computer vision images and in biological images. For general computer vision applications, SURF is able to identify corresponding features (), but for biological tissue images, SURF performs poor on corresponding landmark detection (). un war pj (unidirectional elastic b spline model) is introduced by by combining and extending some of the best techniques in the context of medical imaging. They use b splines to model the deformation field and solve the registration problem by minimizing a pixel wise mean square distance measure between the target image and the transformed source images with vector spline regularization constraints. This method is demonstrated to be effective on the elastic registration of images of electrophoretic gels and fly embryos. Later, based on un war pj arg and a developed an improved bi-directional elastic b spline model bun war pj to perform better registration of histopathological tissue images. However, quantitative evaluations of the method were not provided in () to show the performance of bun war pj on alignment of tissue images. TrakEM2 () is a recent development for 2D medical image registration and or 3D image reconstruction, but pointed out that 'TrakEM2 acknowledges that any automatic procedure (such as image registration and image segmentation) will eventually fail partially or fully and will require manual correction by a human operator'. Mutual information techniques () measure the statistical dependence or information redundancy between image intensities of corresponding voxels in both images and use mutual information or relative entropy as the matching criterion. The method has been validated for rigid body registration of computed tomography, magnetic resonance and photon emission tomography images. Here, recent MATLAB R2013a implementation (MathWorks) of the mutual information based method is adopted for evaluation. In our experiments (see Section 2), the five existing techniques do not deal with either tissue deformations or stain variation problems and perform poor, obtaining 565% registration accuracies on average for biological tissue images, and for X-ray images, the two b spline models produce poor results with accuracy 560%. Hence, a robust and fully automatic registration method is highly desirable. In this work, an improved image alignment approach that is a combination of feature based and area based elastic registration method and a tissue pattern extraction technique is introduced here, and the presented method is fully automatic and performs consistently well in our experiments for both biological tissue images and X-ray images. Detailed quantitative evaluations with statistical analysis were conducted, showing that the presented method achieves 88.44 and 88.9% averaged registration accuracies for biological tissue images and X-ray images, respectively, and outperforms the benchmark methods. Based on the tu keys honestly significant difference test (HSD) and Fisher's least square difference test (LSD) tests, the presented method performs significantly better than all existing methods (P 0.001) for tissue image alignment, and for the X-ray image registration, the proposed method performs significantly better than the two benchmark b spline approaches (P50.001). The outline of this article is as follows. The materials and results are presented in Section 2, and the proposed methods are described in Section 3. Information regarding the a For general computer vision applications, SURF is able to identify corresponding features, but (b) for biological tissue images where local features can be confusing, SURF performs poor on corresponding landmark detection implementation of the presented method is provided in Section 4 and a discussion is given in Section 5.

discussion image registration is the process of overlaying two or more images of the same scene taken at different times from different viewpoints or using different capturing modules, and a good image alignment method has to take a number of issues into consideration (), including imperfect inputs such as aberrations and artifacts, occlusion issues where many pixels in one image may not match with any pixel in another image and uniqueness issues where each pixel in an image has to uniquely map to a pixel of another image. Alignment of biological images is challenging as local image features may appear confusing to one another, and imperfect inputs are inevitable. In this article, a robust and fully automatic registration method has been presented and demonstrated to be promising for aligning biological tissue images and dental X-ray images. Moreover, for the tissue image alignment, the presented method outperforms five popularly adopted existing approaches (P 0.001) based on tu keys HSD and LSD tests and performs consistently well for both types of data in our experiments (88.44 and 88.93% averaged registration accuracies for biological tissue images and X-ray images, respectively). The presented image registration algorithm is not limited to tissue images or dental X-ray scans but can also be applied to other anatomically or histologically defined medical data. Moreover, as complex deformation problems are unavoidable in real life data, the presented technique will prove to be a substantial advantage for any application that requires image registration.
