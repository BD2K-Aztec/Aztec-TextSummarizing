Motivation: DNA methylation is an epigenetic modification with important roles in many biological processes and diseases. Bisulfite sequencing bs seq has emerged recently as the technology of choice to profile DNA methylation because of its accuracy, genome coverage and higher resolution. Current statistical methods to identify differential methylation mainly focus on comparing two treatment groups. With an increasing number of experiments performed under a general and multiple factor design, particularly in reduced representation bisulfite sequencing, there is a need to develop more flexible, powerful and computationally efficient methods. Results: We present a novel statistical model to detect differentially methylated loci from bs seq data under general experimental design, based on a beta binomial regression model with arcsine link function. Parameter estimation is based on transformed data with generalized least square approach without relying on iterative algorithm. Simulation and real data analyses demonstrate that our method is accurate, powerful, robust and computationally efficient.

introduction dna methylation is a covalent epigenetic modification of cytosine that plays a critical role in gene regulatory mechanism. It has been well characterized to involve in many biological processes such as cell differentiation, development and aging. It often shows abnormality in many diseases such as cancer (). Methylated cytosine s within promoter regions have been shown to repress gene expression by interfering with dna binding proteins that promote transcriptions (), subsequently leading to phenotypic changes. Studying the dynamics of DNA methylation and their influence has broadened and enhanced our knowledge on many biological mechanisms and disease etiologies, in additional to the genetic components discovered from studying DNA sequences alone. Technologies for quantifying DNA methylation have evolved rapidly in recent years. Sodium bisulfite treatment of DNA following next generation sequencing bs seq is a new technology that measures the methylation levels at single nucleotide resolution. Compared to earlier high throughput technologies such as methylation microarray () or capture based sequencing like me dip seq (), bs seq has improved accuracy, reduced background bias and higher spatial resolution. Thus it has quickly become the technology of choice to study DNA methylation. One of the most important questions in DNA methylation analysis is to identify genomic loci or regions with different methylation levels among distinct biological conditions. Differentially methylated loci (DML) or regions (DMRs) can be functionally associated with biological processes such as protein bindings and gene expressions to contribute to phenotypic changes. The dml dmrs could potentially be used as biomarkers for early stage disease diagnosis, V C The Author 2016. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals permission soup com and identifying progression and subtypes of certain disease. DML/ DMRs can also provide information for targeted therapies in precision medicine. Developing methods for dml dmr detection has been and still remains an active epi genomics research topic. Over the last several years, a number of statistical methods and software tools have been developed for identifying dml dmrs from bs seq data (). A comprehensive review of the existing methods is provided by. Most of available methods are specifically designed for comparing DNA methylation levels from two treatment groups, partially because most of the existing bs seq data are generated for two group comparison due to high cost of the experiment. With rapid advances of sequencing technology and continuous reduction of sequencing cost, an increasing number of experiments are now performed under general, multi-factor design, especially from the reduced representation bisulfite sequencing (RRBS) technology () and enhanced RRBS (). We expect this trend will continue and data with multiple factors/ groups and covariates will be common in foreseeable future, even from large scale population level studies. Flexible and efficient methods are in great demand to comprehensively decipher biological processes in current epi genomics research. The data from bs seq can be summarized as numbers of methylated and total reads at each CpG site. The methylated read counts are often modeled by a beta binomial distribution, which accounts for both the biological and sampling variations (). A straightforward method to call DML under general design is using a beta binomial generalized linear model (GLM) at each CpG site. There are currently two methods available for bs seq under general design: rad meth () and bi seq (). rad meth directly applies beta binomial GLM with log it link function. bi seq first performs a local smoothing within each sample, and then uses a beta regression with 'probit' link on the smoothed methylation levels. The hierarchical testing procedure used in bi seq primarily focuses on identifying DMRs. Another software methyl kit () does not explicitly provide any function for multi-factor DML calling. But it internally uses a binomial GLM function for replicated data, which can also be used for general experimental design. All these methods are based on GLM with or without over dispersion adjustment. Some drawbacks exist using such approach. First it is computationally intensive because model fitting is based on iterative procedure to maximize the likelihood. Given the size of a typical bs seq dataset (millions of CpG sites), such a procedure is very computationally demanding. This is evidenced by the poor computational performance from both rad meth and bi seq. Second, the GLM procedure is numerically unstable when separation or quasi separation happens in one or more covariates, which frequently occurs in many CpG sites, particularly when methylation levels are close to the boundaries (0 or 1). Such limitations sometimes lead to undesirable results from existing methods. In this paper, we propose a novel statistical method to detect DML for bs seq data under general experimental design. At each CpG site, the count data are modeled by a beta binomial regression with 'arcsine' link function. Model fitting is based on the transformed methylation levels by applying generalized least square (GLS) procedure, which provides estimates for regression coefficients and their covariance. Hypothesis testing is achieved using a Wald test at each CpG site, and the significance levels can be used for DML calling. We perform extensive simulation studies and real data analyses to show the advantages of our proposed method over existing ones. The method, termed dss general is now implemented as a part of the Bioconductor R package DSS.

discussion considering the large number of tests required, developing statistical method to analyze bs seq data with multiple factors or covariates is challenging due to complicated model settings and computationally demanding parameter estimation procedure. beta binomial model is commonly used for count data from bs seq experiment due to the possibility of considering both biological and sampling variations. Even though beta binomial GLM is a straightforward solution, computationally inefficient and numerically unstable estimation procedures are major obstacles for bs seq data analysis in practice. We developed a novel statistical method, termed dss general to detect DML from bs seq data under general experimental design. The method is based on transformation and approximation, which significantly improves computational efficiency. dss general characterizes the count data using a beta binomial regression with an 'arcsine' link function. The regression coefficients are estimated from transformed methylation levels using GLS, where the covariance matrices are determined by sequencing depth and biological variances. The estimator of covariance matrix for the parameter estimations is carefully derived. A Wald test procedure is then applied for hypothesis testing to identify DML. Similar approaches that operate on transformed data have been developed for other sequencing data such as rnase q () and chips eq (), and provide good performances. An important distinction of dss general is the use of 'arcsine' link function instead of the more frequently used log it or' probit'. This is mainly due to the statistical convenience because the stabilization of the variances after transformation makes the least square procedure possible. As shown from comparisons of computational performance with existing methods, dss general is 40 and 166 times more efficient than rad meth and bi seq respectively. Along with compatible or better accuracy and statistical property, dss general is a more desirable tool for the analyses of bs seq data under general experimental design. Although rad meth also provides similarly good results and computationally more efficient than bi seq unlike dss general and bi seq users can not apply continuous covariates or factors with more than two values. Compared with log it link, a disadvantage of the 'arcsine' link is that the coefficient is more difficult to interpret. However, since the main goal of DML detection is to detect and rank CpG sites and the detection rankings are often based on quantities such as test statistics, p values or FDR, the magnitudes of the coefficients are often not of interest. Thus the interpretability of regression coefficients will not be a major limitation of the method. The algorithm of dss general contains a step for dispersion estimation. We evaluated the performance of dispersion estimation on DML detection accuracy. We compared the results from dss general when using the estimated dispersions versus using the true dispersions. supplementary shows the TDR curves from the comparison. As expected, using true dispersions gives slightly better TDRs, particularly when sample sizes are small. However, the difference becomes very small when sample sizes increase to 10 replicates per group, indicating good performance of the proposed dispersion estimation procedure. It is also important to note that some dispersion estimation methods from other sequencing data are based on empirical Bayes (EB) procedure, which borrows information across all genes or CpG sites and achieves a 'shrinkage' effect (). Under our setting, the eb type of shrinkage method can not be easily adopted because of the complicated relationship between the dispersion and data distribution, i.e. it is difficult to express the data likelihood as a function of the dispersion. Furthermore, the shrinkage is often based on maximizing an objective function such as penalized likelihood. The computational efficiency becomes a major issue without closed form of shrinkage estimator. In dss general the bounded estimation of dispersions can be considered as a type of shrinkage that imposes some biological variance and stabilizes the results. Although the results shown in this paper are based on CpG methylation, our method can also be applied to CpH methylation from whole genome bs seq. In addition, other types of base resolution methylation sequencing data such as 5 hydroxymethyl cytosine (5hmC), 5formyl cytosine (5fC) and 5 carboxyl cytosine (5caC) () can also be compared using dss general. Though there is no such dataset under general experimental design so far, they could become popular with the continuous advances of technologies. dss general is specifically developed to test differential methylation at single CpG site level. It has been reported that the methylation levels are spatially correlated across the genome (), and smoothing based methods were developed to account for the correlation (). Although we considered spatial correlation when generating data in simulation study, we did not develop method to take into account this information to improve DML calling. This is partly because that all currently available data with general design are from RRBS, where the CpG coverage is sparse and spatial correlation is more difficult to be modeled. Nonetheless, incorporating the spatial information into our method will be a research topic in the near future. Furthermore, dss general is designed for data under linear model with fixed effects. The method can not be directly applied to analyzing data from more complexed designs such as paired or clustered, which has to be modeled by a mixed effects model. Developing method for analyzing such data is also in our short term plan.
