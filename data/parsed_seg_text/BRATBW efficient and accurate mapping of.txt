We introduce brat bw a fast, accurate and memory efficient tool that maps bisulfite treated short reads bs seq to a reference genome using the fm index burrows wheeler transform). brat bw is significantly more memory efficient and faster on longer reads than current state of the art tools for bs seq data, without compromising on accuracy. brat bw is a part of a software suite for genome wide single base resolution methylation data analysis that supports single and paired end reads and includes a tool for estimation of methylation level at each cytosine.

introduction bisulfite sequencing bs seq combined with next generation sequencing (NGS) instruments enables genome wide methylation analysis at a single base resolution. Bisulfite treatment of DNA followed by PCR converts unmethylated cyto cines to thymine s and leaves methylated cyto cines unchanged (). bisulfite treated sequenced reads have to be aligned to the reference genome, but the treatment introduces the computational challenge of mapping both Cs and Ts in a read to Cs in the genome. The most successful methods for mapping short reads either use hashing or data structures based on the burrows wheeler transform (where the latter approach is considered to yield more time efficient solutions than the former. Although several tools are available for bs seq data, most of them still use hashing (including rma pbs SOAP, MAQ and BRAT). The fastest tools for mapping bs seq reads are Bismark () and bs seeker (). Both employ the mapping tool Bowtie () that internally uses the fm index () based on the Burrows Wheeler transform. As a consequence, both tools are required to post process the output of Bowtie to remove ambiguous reads or reads with too many mismatches. Bismark synchronizes instances of fm indexes run in parallel, which takes a toll on time efficiency. bs seeker outputs the results of distinct instances into separate files * To whom correspondence should be addressed. during mapping and then post processes mapping results, which demands extra storage for intermediate results. Bismark and bs seeker can therefore require large amount of primary memory to complete the processing. Both tools support two distinct types of bisulfite libraries: the first type yields sequenced reads that are bisulfite converted versions of two original genomic strands (); the second type produces reads that correspond to four possible strands, as a by product of PCR step (). To support the second type of libraries, Bismark and bs seeker align reads to four distinct fm indexes. Even though a type 1 bisulfite library would require only two fm indexes Bismark builds four fm indexes in parallel requiring 16 GB of memory for human genome (Bowtie-2 with off rate 4). On the other hand, bs seekers memory footprint depends directly on the size of the input file: it may require up to 15 GB of memory for 30 M 32 bp long reads (the typical number of reads lane for the Illumina Genome Analyzer). Additionally, bs seeker currently does not support paired end reads and allows a limited number of mismatches per read, which makes it unsuitable for longer reads in the Supplementary Material summarizes the features of all the available tools for bs seq data. In this article we introduce brat bw a fast and accurate mapping tool that uses a very memory efficient implementation of the fm index. brat bw is an evolution of BRAT (), which uses about half as much memory compared with bs seeker and Bismark. Additionally, its memory footprint does not depend on the size of the input sequenced reads, likely to continue to increase with future sequencing technologies advances. brat bw supports both types of bisulfite libraries and handles single end and paired end reads. It has no limitation on the maximum length of the read or the number of allowed mismatches. brat bw guarantees to find all matches as long as they have at most one mismatch in a prefix of length 3264 bp (user defined) of the read. There are several advantages of designing a tool for bs seq data based on the fm index from the ground up instead of relying on a general purpose tool such as Bowtie. brat bw processes both fm indexes on a single processor, so no synchronization cost is required. In addition, the selection of correctly mapped unique reads is performed 'on the fly' during mapping, so no storage for intermediate results is necessary.
