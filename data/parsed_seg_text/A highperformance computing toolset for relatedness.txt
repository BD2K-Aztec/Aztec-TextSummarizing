genome wide association studies are widely used to investigate the genetic basis of diseases and traits, but they pose many computational challenges. We developed gd sfmt and snp relate (R packages for multi-core symmetric multiprocessing computer architectures) to accelerate two key computations on SNP data: principal component analysis pc a and relatedness analysis using identity by descent measures. The kernels of our algorithms are written in C/Cþþ and highly optimized. Benchmarks show the uniprocessor implementations of pc a and identity by descent are 8–50 times faster than the implementations provided in the popular eigen strat (v3.0) and PLINK (v1.07) programs, respectively, and can be sped up to 30–300-fold by using eight cores. snp relate can analyse tens of thousands of samples with millions of SNPs. For example, our package was used to perform pc a on 55 324 subjects from the gene environment Association Studies consortium studies. Availability and implementation: gd sfmt and snp relate are available from R CRAN (http://cran.r-project.org), including a vignette. A tutorial can be found at https://www.genevastudy.org/Accomplish ments software. Contact:

introduction genome wide association studies g was are widely used to investigate the genetic basis of many complex diseases and traits, but the large volumes of data generated in chip and sequencing based g was from thousands of study samples and millions of SNPs pose significant analytical and computational challenges. One important challenge is the inflated false positive associations that arise in g was results when population structure and cryptic relatedness exist (). These challenges can be addressed by using principal component analysis pc a to detect and correct for population structure () and identity by descent (IBD) methods to identify the degree of relatedness between each pair of study samples. For both methods, it is suggested to use a pruned set of SNPs, which are in approximate linkage equilibrium with each other to avoid the strong influence of SNP clusters (). However, the computational burden associated with these methods is especially evident with large sample and SNP sizes and requires efficient numerical implementation and memory management, especially as chip arrays increase in size and sequencing data is used to call variants. For example, the 1000 Genomes Project identified 15 million SNP loci from whole genome sequencing technologies recently (1000 Genomes Project Consortium, 2010). R is one of the most popular statistical programming environment, but it is not typically optimized for high performance or parallel computing, which would ease the burden of large scale snp based g was calculations. To overcome these limitations, we have initiated a project named core array (http://corearray. sourceforge net that includes two R packages: gd sfmt to provide efficient, platform independent memory and file management for genome wide numerical data, and snp relate to solve large scale numerically intensive g was calculations (i.e. pc a and IBD) on multi-core symmetric multiprocessing computer architectures the SNP eigenvectors can be used to calculate the sample eigenvectors of a new set of samples, which is useful in studies with substantial relatedness (). For relatedness analysis, IBD estimation in snp relate can be done by either the method of moments (MoM) () or maximum likelihood estimation (MLE) () through identity by state. Our experience shows that MLE is significantly more computationally intensive than MoM for large scale data analysis, although MLE estimates are usually more reliable than MoM. Additionally, the functions for linkage disequilibrium pruning generate a pruned subset of SNPs that are in approximate linkage equilibrium with each other, to avoid the strong influence of SNP clusters in pc a and IBD analysis. An actual kinship matrix of individuals can be estimated by either method, which could be used in downstream association analyses (). Both R packages are written in C/C, use the POSIX threads library for shared memory parallel computing on unix like systems and have an R interface in which the kernel has been highly optimized by blocking the computations to exploit the high speed cache memory. The algorithms are optimized to load genotypes block by block, with no limit to the number of SNPs. The algorithms are limited only by the size of the main memory, which is accessed by the parallel threads, and holds either the genetic covariance matrix or IBD coefficient matrix. GDS is also used by an r bioconductor package g was tools as one of its data storage formats (). g was tools provides many functions for quality control and analysis of g was including statistics by SNP or scan, batch quality, chromosome anomalies, association tests, etc.
