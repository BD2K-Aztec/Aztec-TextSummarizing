Motivation: Detecting single nucleotide polymorphism (SNP) in pooled sequencing data is more challenging than in individual sequen-cing because of sampling variations across pools. To effectively differentiate SNP signal from sequencing error, appropriate estimation of the sequencing error is necessary. In this article, we propose an empirical Bayes mixture (EBM) model for SNP detection and allele frequency estimation in pooled sequencing data. Results: The proposed model reliably learns the error distribution by pooling information across pools and genomic positions. In addition, the proposed EBM model builds in characteristics unique to the pooled sequencing data, boosting the sensitivity of SNP detection. For large scale inference in SNP detection, the EBM model provides a flexible and robust way for estimation and control of local false discovery rate. We demonstrate the performance of the proposed method through simulation studies and real data application.

introduction recent advances in next generation sequencing (NGS) technologies have significantly reduced the cost and time involved in sequencing the human genome in hundreds or thousands of individuals. The resulting comprehensive genomic analyses will provide powerful tools for discovering the genetic variations underlying complex phenotypic traits. NGS holds the promise of revolutionizing genetic studies due to its ability to detect rare variants that are not observed in array based genome wide association studies g was. The importance of rare variants underlying complex diseases has been discussed in a number of recent articles (). It is believed that rare variants account for a significant proportion of genetic heritability missed by previous g was (). Although the cost of NGS has dropped dramatically over the past few years, it is still prohibitively expensive to sequence individual genome at a sufficient read depth. An alternative approach to reduce the cost of sample preparation and sequencing is to pool genomic DNA from multiple individuals and sequence the pooled DNA samples (). The feasibility of pooled sequencing has been demonstrated in several studies ().used pooled sequencing to identify causal rare variants in candidate genes of Type I diabetes. When analyzing NGS data, the first step is to identify polymorphic sites in the genomic regions. A number of computational methods have been developed to identify single nucleotide polymorphisms (SNPs) in individual sequenced samples (). These methods use sequencing and mapping quality scores to distinguish true SNPs from sequencing and mapping errors. Some methods utilize cross sample information to estimate sequencing error at each genomic position (). In addition, incorporation of pedigree information and linkage disequilibrium (LD) has been demonstrated to significantly improve SNP calling accuracy in individual sequencing (). Methods for individual sequencing do not directly apply to SNP calling in pooled sequencing. Characteristics unique to pooled sequencing make SNP calling more challenging than in individual sequencing. First, because of sampling variation, the frequency of a variant allele will vary across the pools. Allele frequency in a pool is a function of the population allele frequency and pool size (number of individuals in a pool;). In cases in which there exists a rare variant with small pool size, the presence of the variant allele will be sporadic across pools. In contrast, in individual sequencing, the variant allele frequency for a diploid sample is 0, 0.5 or 1. Variation of allele frequency across pools makes it difficult to differentiate the true SNP signal from sequencing error. Second, external information, such as pedigree and LD information, is not available in pooled sequencing. Third, because of the small number of pools, it is almost impossible to get a good estimate of the sequencing error using only cross pool information. Therefore, sophisticated methods are needed to call SNPs in pooled sequencing. Recently, several SNP calling methods designed for pooled sequencing have been reported (). snp seeker (), derived from large deviation theory, requires negative control data to estimate error model. CRISP (Comprehensive Read analysis for Identification of Single Nucleotide Polymorphisms from Pooled sequencing,) models allele counts across multiple pools using contingency tables. It uses Fisher's exact test to detect uneven distributions of variant reads across pools and then uses Chernoff bound to compute an upper bound on the p value of the overabundance of alternate alleles within each *To whom correspondence should be addressed. pool against the sequencing error. This method builds on the assumption that the presence of a rare variant in a pool is likely to cause excess variant reads compared with the other pools. Such an assumption does not hold for less rare or common variant and is questionable when the pool size is large. Consequently, CRISP is not effective for detection of less rare and common SNPs. As an alternative approach, sn ver () models variant reads in a single pool using a binomial binomial model and combines p values from multiple pools to identify SNPs. Because it is difficult to simultaneously estimate the population allele frequency and sequencing error using the binomial binomial model, sn ver arbitrarily specifies the sequencing error to be 0.01 for all positions. As we show in the simulation studies, inaccurate specification of sequencing error will lead to high false positive rates and low sensitivity. In this article, we introduce an empirical Bayes mixture (EBM) model for detecting SNPs in pooled sequencing data. In contrast to the existing methods that detect SNPs one at a time, the EBM model learns error distribution by pooling information across multiple pools and genomic positions. It is well known that the sequencing error at each position is highly reproducible across samples or pools. cross sample information in individual sequencing has been gathered to estimate sequencing error. However, in pooled sequencing, direct estimation sequencing error has not been explored due to the small number of pools available and the variations of allele frequency across pools. Additional information is needed to obtain a good estimate of the sequencing error in pooled sequencing. Using the EBM model, data across genomic positions can be pooled to learn the error distribution. Since the density of a SNP is estimated to be approximately 1 of 1000 bases (), leveraging the information from a large number of null positions will allow fairly accurate estimation of the error distribution. The fundamental idea of pooling information to estimate null distribution in empirical Bayes methods has been applied to genomic data since the advent of microarray analysis (extended efron s empirical Bayes method to detect SNPs in individual sequencing. In this article, different from previous methods, we propose an EBM model that builds in characteristics unique to pooled sequencing for SNP detection. The EBM model blurs the line between hypothesis testing and parameter estimation. In addition to SNP detection, the proposed method produces empirical Bayes shrinkage estimation of allele frequency. Allele frequency estimation is important for downstream analyses, such as association studies or population genetic analysis. Yet, it is left unexplored by the current SNP detection methods. In the EBM model, SNP detection and allele frequency estimation are nicely integrated. In the following sections, we will present mathematical formulation of the EBM model and demonstrate its performance through simulation studies and a real data application.
