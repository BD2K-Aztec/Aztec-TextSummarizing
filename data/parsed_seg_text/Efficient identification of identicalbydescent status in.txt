Motivation: Inference of identical by descent (IBD) probabilities is the key in family based linkage analysis. Using high density single nucleotide polymorphism (SNP) markers, one can almost always infer haplotype configurations of each member in a family given all individuals being typed. Consequently, the IBD status can be obtained directly from haplotype configurations. However, in reality, many family members are not typed due to practical reasons. The problem of ibd haplotype inference is much harder when treating untyped individuals as missing. Results: We present a novel hidden Markov model (HMM) approach to infer the IBD status in a pedigree with many untyped members using high density SNP markers. We introduce the concept of inheritance generating function, defined for any pair of alleles in a descent graph based on a pedigree structure. We derive a recursive formula for efficient calculation of the inheritance generating function. By aggregating all possible inheritance patterns via an explicit representation of the number and lengths of all possible paths between two alleles, the inheritance generating function provides a convenient way to theoretically derive the transition probabilities of the HMM. We further extend the basic HMM to incorporate population linkage disequilibrium (LD). pedigree wise IBD sharing can be constructed based on pair-wise IBD relationships. Compared with traditional approaches for linkage analysis, our new model can efficiently infer IBD status without enumerating all possible genotypes and transmission patterns of untyped members in a family. Our approach can be reliably applied on large pedigrees with many untyped members, and the inferred IBD status can be used for non-parametric genome wide linkage analysis.

introduction as one important type of gene mapping approach, family based linkage analysis has shown tremendous success in identifying genes underlying Mendelian diseases. With the development of new genotyping technologies, there have been two distinct features arising in new datasets: both the number of genetic markers, mostly single nucleotide polymorphisms (SNPs), and the number of untyped individuals within a pedigree have increased drastically. Traditional linkage methods are exponential either in terms of the number of markers, or in terms of the size of a pedigree lander green (, therefore can not efficiently deal with new data. The problem is much harder for families with many untyped individuals. Even later approaches () relying on heuristic search or using various search space reduction techniques can not solve the problem. Furthermore, for tightly linked markers, the original assumption of linkage equilibrium between markers does not hold anymore. () address this problem by partitioning a chromosome into small segments, and assume that there is no recombination within each segment and SNPs in different segments are in linkage equilibrium. However, by uniformly partitioning chromosomes into segments with a fixed segment length, their approach can not handle segments with recombinations. In addition, they basically implement the lander green algorithm (), which enumerates all inheritance patterns; therefore, their approach can not handle large pedigrees also address linkage disequilibrium (LD) for tightly liked markers by modeling founder haplotypes as a Markov chain. However, their method is mainly for nuclear family data with two offsprings. Recently, we have demonstrated that with high density SNP data, (i) we can infer recombination breakpoints with high precision (); (ii) our algorithm () can efficiently infer haplotypes and inheritance patterns for large pedigrees; and (iii) in most cases, inheritance can be uniquely determined for large pedigrees with large number of SNPs. Experimental results show that our approach is highly efficient and can also tolerate high missing rates. However, if there are individuals in the pedigree that are completely untyped, our approach still needs to enumerate all transmission patterns and genotypes involving these untyped individuals, which may end up searching an exponentially large solution space. In this article, we address the key problem in linkage analysis using high density SNPs and large pedigrees with many untyped members: IBD inference between any pair of typed members within a pedigree, by proposing a novel hidden Markov model (HMM) based approach. Our approach is fundamentally different from the lander green algorithm, although both are based on HMMs. lander green algorithm only models the parent child relationship and it has to take into account every possible transmission pattern between a parent child pair. Instead, our approach can directly model relationships between any pair of relatives. In our model, the hidden states are the IBD number between the pair at each locus and the observable data are the numbers of alleles that are identical by state (IBS) between the pair. Unlike the lander green algorithm, the probability of identical by disc ent (IBD) change between two markers for a given pair not only depends on the marker interval distance, but also depends on the type of relationship of the pair. More precisely, the transition probabilities depend on all possible cases that how recombination events might occur between the two markers when the pair inherits their genes from their common ancestors within the pedigree. To derive the transition probabilities between any types of relationships, we introduce the inheritance generating function, which can conveniently aggregate all possible inheritance patterns between their common ancestors and this pair of individuals. Actually, our definition of the inheritance generating function can explicitly list the number of all possible inheritance paths and their lengths between a pair of alleles. We also propose an efficient recursive approach to calculate the function. The transition probabilities can then be theoretically derived based on the number and lengths of all inheritance paths. Emission probabilities can be derived based on their definitions. They only depend on population allele frequencies and genotyping error rates, but do not depend on the type of relationship between a pair. We first define our HMM for a pair of alleles. Based on this basic model, we build the model for a pair of individuals. We further extend the model to incorporate population LD or background sharing beyond a pedigree. Finally, pedigree wise IBD sharing can be constructed based on pairwise IBD relationships. Compared with traditional approaches for linkage analysis (i.e. elston stewart and lander green algorithms), our algorithm is essentially quadratic in terms of the number of typed individuals and linear in terms of the number of markers. More importantly, our new model can efficiently infer IBD status without enumerating all possible genotypes and transmission patterns of untyped members in a family. Given the fact that most existing family data using high density SNP chips consist of many untyped individuals, our approach provides an efficient alternative to perform genome wide linkage analysis. We evaluate our approach using small nuclear families, large multi generation pedigrees as well as simulated data. Experimental results show that for siblings with untyped parents, which corresponds to a saving of 50% of total genotyping costs, our approach has successfully recovered 90% of IBD changing points (i.e. recombination breakpoints) with 5% false positives. We also construct the IBD sharing map of seven typed members in a pedigree of size 15. Simulation using this pedigree structure shows that for different types of pairwise relationships, our approach can recover 84.087.7% IBD changing points with high precision, while at the same time, keeping the false positive rate low (4.26.8%). In experiments on two other big pedigrees (size 22 and 23), our method maintains a locus by locus IBD inference error rate 1%. Comparisons with MERLIN () show that our algorithm is both more accurate and more efficient in identifying IBD sharing.

discussion traditional linkage analysis models the transition of inheritance vectors from one locus to another as a complex multiple state Markov chain and derive the probability of IBD sharing. Given the current density of SNP markers, the inheritance pattern of a pedigree can usually be fixed by applying the Mendelian law of inheritance, which basically means that one can almost 'observe' IBD sharing states. However, the use of Mendelian law requires that all or most members of a family should be genotyped, which is not practical for studies involving large pedigrees. To avoid enumerating the genotypes of the untyped members, we extract the inheritance information between two individuals by tracing all possible inheritance paths between them. By doing so, we can directly model the IBD sharing status between any pair of individuals without considering the actual transmission across their ancestors. From the pairwise IBD relationship, we can build the global IBD sharing map of the whole pedigree for genotyped members. We use our method to infer the recombination positions in nuclear families with two siblings. Our method detects 90% of the recombination positions and has 5% false positive reports. Experiments on large pedigrees show that the method is accurate in identifying IBD and non ibd boundaries in both closely and distantly related individuals. We further incorporate the bg ibd state into our HMM model to deal with background LD between markers. By adjusting the background IBD level, we can tune the sensitivity and specificity of the method accordingly. Regardless, long segments of pedigree IBD sharing are always safely recovered in most cases. We also compare our algorithm with MERLIN and it shows that our method has both better accuracy and efficiency. By partitioning the chromosome into regions of different inheritance patterns, we can generate statistics for assessing the linkage of a chromosomal region with the disease. Based on the inferred IBD, we will further incorporate linkage analysis into our model.
