We present a method, lineage program that uses the developmental lineage relationship of observed gene expression measurements to improve the learning of developmentally relevant cellular states and expression programs. We find that incorporating lineage information allows us to significantly improve both the predictive power and interpretability of expression programs that are derived from expression measurements from in vitro differentiation experiments. The lineage tree of a differentiation experiment is a tree graph whose nodes describe all of the unique expression states in the input expression measurements, and edges describe the experimental perturbations applied to cells. Our method, lineage program is based on a log linear model with parameters that reflect changes along the lineage tree. Regularization with L 1 that based methods controls the parameters in three distinct ways: the number of genes change between two cellular states, the number of unique cellular states, and the number of underlying factors responsible for changes in cell state. The model is estimated with proximal operators to quickly discover a small number of key cell states and gene sets. Comparisons with existing factorization, techniques, such as singular value decomposition and non-negative matrix factorization show that our method provides higher predictive power in held, out tests while inducing sparse and biologically relevant gene sets.

introduction the directed differentiation of embryonic stem (ES) cells into therapeutically important cell types holds great potential for regenerative medicine. Identifying stage specific transcription factor candidates for the directed differentiation of ES cells has been difficult, and the computational identification of lineage associated transcription factor programs would significantly benefit this process. lineage program is a new method that identifies the experimental protocols that result in the same cellular states (). It further decomposes these states into interpretable expression programs, which we define to be sets of co varying genes. In contrast to analyzing the correlation between genes, we define a * To whom correspondence should be addressed lineage program attempts to identify salient cellular states and co varying gene sets. Different treatments may result in the same cell state (a 1 and a 3 after definitive endoderm), while some treatments may have no effect (a 3 at stem cell). Our goal is to merge and prune these types of treatments program to be sets of genes that co-vary during a differentiation event. Analysis of developmental expression data has revealed the existence of expression programs regulating plur i potency across many cell types as well as lineage specific programs. We provide a principled method that discovers both types of programs. lineage program is a log linear model that uses latent factors and L 1 regularization to obtain sparse parameters, structures and spectra. Our primary goal is to estimate expression programs that are informed and improved by lineage information. To our knowledge, lineage program is the first method to approach this problem. Prior work in the estimation of developmental expression programs has used bi clustering factor or topic decompositions, mixture models and self organizing maps, all of which simultaneously identify expression programs and sample clusters, but without incorporating information from the experimental lineage. As shown in studies of expression time series, treating dependent expression data as independent observations can lead to significant loss of information. Separate prior work has focused on estimating lineage trees and lineage states in the absence of expression programs. Differentiation has been modeled both as a time series without branching and de novo tree estimation. The remainder of this article presents the lineage program model (Section 2), a comparative analysis of lineage program with other methods on lineage associated expression data from motor neuron and pancreatic development (Section 3) and a conclusion about what we have learned about using lineage information (Section 4).

conclusion we have presented lineage program a log linear sparse regularized model and inference algorithm for lineage associated expression data that provide strong interpretability with no loss in predictive power. Existing flat modeling methods were unable to cope with the large number of leaves that occur at the ends of the differentiation experiment, and significant statistical power is lost re estimating the background cellular expression levels. Our biological metrics also suggest that flat factorization methods do not extract biologically meaningful expression programs, and modeling the differences between each differentiation state is necessary to estimating fine behaviors occuring during differentiation. Our analysis of the combined pancreas and motor neuron data provides a computational analysis of the pancreatic and motor neuron differentiation pathways that recapitulate known biological markers and states. The ability of the sparse regularization to remove spurious branches in the lineage tree suggests the use of this model to estimate novel cellular states in later stage differentiation experiments, where explicit cellular states are less characterized. Although we have restricted our model to expression based data, we hope to extend this framework of L 1 regularized branching models to sequencing data with similar structure. The penalty model presented here would allow a wide variety of log convex generative models to incorporate lineage associated structure.
