Motivation: Identification of expression Quantitative Trait Loci e qtl the genetic loci that contribute to heritable variation in gene expression , can be obstructed by factors that produce variation in expression profiles if these factors are unmeasured or hidden from direct analysis. Methods: We have developed a method for Hidden Expression Factor analysis (HEFT) that identifies individual and pleiotropic effects of e qtl in the presence of hidden factors. The HEFT model is a combined multivariate regression and factor analysis, where the complete likelihood of the model is used to derive a ridge estimator for simultaneous factor learning and detection of e qtl. HEFT requires no pre estimation of hidden factor effects; it provides p values and is extremely fast, requiring just a few hours to complete an e qtl analysis of thousands of expression variables when analyzing hundreds of thousands of single nucleotide polymorphisms on a standard 8 core 2.6 G desktop. Results: By analyzing simulated data, we demonstrate that HEFT can correct for an unknown number of hidden factors and significantly outperforms all related hidden factor methods for e qtl analysis when there are e qtl with univariate and multivariate (pleiotropic) effects. To demonstrate a real world application, we applied HEFT to identify e qtl affecting gene expression in the human lung for a study that included presumptive hidden factors. HEFT identified all of the cise qtl found by other hidden factor methods and 91 additional cise qtl. HEFT also identified a number of e qtls with direct relevance to lung disease that could not be found without a hidden factor analysis, including cise qtl for GTF2H1 and MTRR, genes that have been independently associated with lung cancer. Availability: Software is available at

introduction studies that have identified expression Quantitative Trait Loci e qtl the genetic loci that produce variation in cellular or tissue gene expression levels, have demonstrated that a considerable fraction of gene expression variation has a genetic basis (). Recently, more precise measurement of genome wide gene expression levels using rnase q technology (), combined with greater marker coverage of genomes, has increased the resolution of e qtl analyses and has allowed more precise dissection of e qtl effects (). A spectrum of new genome wide assays making use of next generation sequencing, such as meth lys eq () and dnase seq (), are providing quantitative data on other cellular profile variables that can be analyzed using an e qtl approach, opening the door for a broader ''x'' Quantitative Trait Loci x qtl framework (). This expanded capability and diversity of e qtl detection has also been accompanied by an appreciation that e qtl can provide useful insights into the genetic basis of disease (). For example, e qtl identification is now routinely incorporated into the analysis of disease risk and other complex aspects of physiology (). A consequence of these trends is a renewed interest in analysis methodologies used to identify e qtl from genome wide data (). For these new methods, there is a premium on the ability to identify as many e qtl as possible while simultaneously providing strict false positive control. High performing, fast and reliable methods will also be particularly valuable for analyzing the highly multivariate mixed data-type x qtl studies that are on the near horizon. For a typical e qtl study that includes genome wide data on both gene expression and genetic markers, identification of e qtl is generally accomplished using standard linear modeling approaches, where marker genotypes with a significant association with one or more expression variables are assumed to either indicate an e qtl or a marker that is in linkage disequilibrium (LD) with the e qtl polymorphism, i.e. the marker indicates the local genomic position of an e qtl (). Although such approaches are straightforward and successful, it is well appreciated that factors responsible for variation in gene expression, if unaccounted for in the statistical model, can dramatically affect both power and precision of genome wide e qtl detection (). This is particularly true in uncontrolled study designs, as is often the case with human e qtl studies, where unmeasured environmental and other factors can influence gene expression profiles and confound e qtl analysis (). More precisely, if *To whom correspondence should be addressed  The Author 2013. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals permission soup com the effects of unaccounted for factors on gene expression are orthogonal to effects of e qtl the factors contribute to the error term and this reduces the power to detect e qtl. If the effects of unaccounted for factors are non orthogonal to the effects of e qtl the result can be a false positive (). That unaccounted for factors can be a problem for e qtl identification is not surprising given the many studies demonstrating that gene expression levels are highly variable and depend on a host of genetic () and non genetic factors (). For statistical modeling purposes, we can categorize expression factors into three cases that require different analysis approaches: (i) a factor that is well represented by a variable that is directly measured in the study, (ii) a factor that can be inferred from the genotype data and (iii) a factor with effects that can be learned from gene expression data. The first includes cases where measured variables such as experimental batch, a disease state of an individual and so forth can be directly incorporated into the statistical model as a covariate. The second includes factors such as cryptic population structure () or relatedness among individuals that can produce variation in measured gene expression levels. For many of these cases, appropriate variables can be inferred directly from the genome wide genotype data, which can then be secondarily incorporated as fixed or random covariates to correct for factor effects (). The third case includes expression factors that can not be well modeled with covariates inferred from genotype data but have effects that can be learned from the covariance among expressed genes (). For this case, the assumption is that the expression factor effects are large enough that the effects of the factors, although not the factors themselves, can be learned using a factor analysis or related approach (). These learned factor effects can then be incorporated into the e qtl analysis as covariates () and the e qtl analysis can be conducted on the residuals of the expression variables after subtracting the learned factors (). The value of accounting for factors in an e qtl analysis that can be learned from expression covariance is just beginning to be appreciated and several recent methods have been proposed for this purpose (). We note that these publications variously refer to these expression factors as hidden confounders (), non genetic factors (), surrogate variables () and so forth, but here we refer to them as hidden factors. In this article, we introduce a new method for e qtl analysis that accounts for the effects of hidden factors: Hidden Expression Factor analysis (HEFT). The HEFT framework unifies a number of desirable goals when performing an e qtl analysis in the presence of hidden factors: p value identification of e qtl with individual or multivariate (pleiotropic) effects on expressed genes, the ability to learn both orthogonal and non orthogonal hidden factors that can inflate or deflate p values without pre learning these factors, and efficient scaling, such that an e qtl analysis of thousands of gene expression variables and hundreds of thousands of marker genotypes can be completed in a few hours on a standard desktop. Critically, inference in HEFT is accomplished using the complete likelihood to derive a ridge estimator for combined factor learning and detection of e qtl the value of which we illustrate by comparing the performance of HEFT with related hidden factor methods when analyzing simulated data (). For a combination of null and hidden factor e qtl scenarios, we show that at worst HEFT has equal performance to these other methods and for the most realistic scenarios, where there are hidden factors and a combination of univariate and multivariate (pleiotropic) e qtl effects, HEFT correctly identifies more e qtl than these other methods without an increase in false positives. We also demonstrate the real world discovery value of a hidden factor analysis by using HEFT to identify e qtl that affect gene expression in the human lung from a sample of smokers and non-smokers by assessing possible associations of 7575 expression variables with 191 959 genotypes. In this analysis, HEFT identified all of the cise qtl found by other hidden factor methods and 91 additional cise qtl. HEFT also identified a number of e qtls with direct relevance to lung disease that could not be found without a hidden factor analysis. Many of these newly discovered e qtl have clear connections to lung physiology and disease, including cise qtl for General Transcription Factor IIH, Polypeptide 1 (GTF2H1) and 5 methyl tetrahydrofolate homocysteine Methyltransferase Reductase (MTRR), two genes that have been independently associated with lung cancer ().
