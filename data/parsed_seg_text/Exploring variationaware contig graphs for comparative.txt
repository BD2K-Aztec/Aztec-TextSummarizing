Motivation: Although many tools are available to study variation and its impact in single genomes, there is a lack of algorithms for finding such variation in meta genomes. This hampers the interpretation of meta genomics sequencing datasets, which are increasingly acquired in research on the (human) microbio me in environmental studies and in the study of processes in the production of foods and beverages. Existing algorithms often depend on the use of reference genomes, which pose a problem when a meta genome of a priori unknown strain composition is studied. In this article, we develop a method to perform reference free detection and visual exploration of genomic variation, both within a single meta genome and between meta genomes. Results: We present the mary gold algorithm and its implementation, which efficiently detects bubble structures in contig graphs using graph decomposition. These bubbles represent variable genomic regions in closely related strains in meta genomic samples. The variation found is presented in a condensed circo s based visualization, which allows for easy exploration and interpretation of the found variation. We validated the algorithm on two simulated datasets containing three respectively seven Escherichia coli genomes and showed that finding allelic variation in these genomes improves assemblies. Additionally, we applied mary gold to publicly available real meta genomic datasets, enabling us to find within sample genomic variation in the meta genomes of a kimchi fermentation process, the microbio me of a premature infant and in microbial communities living on acid mine drainage. Moreover, we used mary gold for between sample variation detection and exploration by comparing sequencing data sampled at different time points for both of these datasets. Availability: mary gold has been written in Cþþ and Python and can be downloaded from http://bioinformatics.tudelft.nl/software Contact: d deridder tu delft nl
introduction recently large scale microbio me analyses, such as meta hit () and the National Institutes of Health Human microbio me Project (), have demonstrated the importance and the richness of our second genome: the microbes inhabiting many different sites of our bodies. To get the complete picture of all DNA present, its biological functions and the genetic variation, increasingly whole meta genome sequencing is performed (). large scale analysis of variation within and between the resulting meta genomes single nucleotide variants, short insertions and deletions (indels) and structural varia ton is essential to fully understand their genetic make up. However, relatively few studies have thus far ventured into such analyses combined data obtained from stool samples in the meta hit and HMP projects and a study comparing leanness and obesity (), taking a read mapping approach to detect millions of single nucleotide polymorphisms and other genetic variation in bacterial meta genomes studied the meta genome of stool samples of a premature infant using an assembly approach. Manual analysis of the assembly output resulted in a genetic variation found in Citrobacter strains. A major reason for this lack of meta genomic variation analysis is a shortage of available tools. Variation detectors have mainly been developed for the isolated genomes of single individuals and can be roughly divided in two categories: reference based and reference free. Several reference based methods that map reads to a pre constructed reference genome are available to detect single nucleotide variants and structural variants, as reviewed in, respectively. However, in meta genomics reference genomes are usually not available for all species. Moreover, many bacterial species are not cultivable in the laboratory, complicating construction of reference genomes. reference free methods, in contrast, detect variation between sequencing samples directly, without resorting to reference genomes showed that genomic regions with polymorphisms give rise to bubbles in the fragment assembly graph and presented an algorithm to find and smooth the bubbles, which was implemented in the Celera assembler. The Cortex assembler () was designed to co assemble multiple genomes and search for such bubbles in the de Bruijn graph that represent variation between the assembled genomes. Decomposition of a de Bruijn graph into biconnected components followed by bubble detection has been shown to be useful in detecting splicing variants in RNA sequencing data (). *To whom correspondence should be addressed. Similar to co assembly of individual genomes, meta genome assembly involves simultaneous assembly of multiple genomes. The presence of two closely related genomes in a sample leads to similar bubbles. The meta genome scaffold er Bambus 2 was designed to detect these bubbles and collapse them, thereby elongating scaffolds while preserving divergence in the data (). Bambus 2 finds bubbles by looking for subgraphs where multiple paths begin at a source node and collapse to one sink node. To keep computation tractable, the number of hops considered is limited to two. meta i dba similarly searches bubbles in a de Bruijn graph, but the search is limited to a maximum of 300 bp (). Here we set out to detect complex bubbles such as presented in, i.e. longer than can currently be detected by Bambus 2 and Cortex, typically found when 42 homologous sequences (closely related genomes) are present in a sample. We overcome the computational limitations in the aforementioned methods by developing an efficient way to find genome variation in assembly graphs, by introducing a graph decomposition into bi and tri connected components that allows us to select a subset of the nodes as source nodes for bubble finding. Identifying bubbles representing multi alleles has three applications. First, it can be used to detect sequence variation, i.e. multiple alleles, between strains within a single sample meta genome. Second, co assembling multiple meta genomes allows the detection of variation between samples. This latter application is particularly novel and is set to become more prominent as more meta genomics datasets will become available over the coming years. Third, although not the main focus in this article, it allows to simplify assemblies, generating longer scaffolds and contigs by collapsing bubbles into a single linear sequence instead of breaking into multiple contigs. co assembly has previously been used by to calculate global distances between meta genomes but here we aim to find sequence level differences. We demonstrate mary gold our algorithm to find bubbles and compare them across samples using co assembly by comparing meta genome samples obtained using 454 technology of different time points obtained from the stool sample of a premature infant () and a fermentation process of the traditional Korean food kimchi (). We also apply the algorithm on sequencing data of microbial populations found on acid mine drainage (), obtained using both 454 and Illumina technologies, and compare mary gold with Bambus 2. mary gold exports the variation detected in a format that can be visualized by circo s allowing for a rich visual exploration and interpretation of the genomic variation in meta genomes
conclusion we presented mary gold a tool to detect and explore genomic variation within and between meta genomic sequencing samples, not reliant on reference genomes. mary gold finds multi allelic regions that reflect sequence variation and improves the contiguity of assemblies by collapsing these. As input, it expects a contig graph, which makes it generic and applicable to any type of sequencing data; we demonstrated the algorithm both on 454 and Illumina data. Here we generated contig graphs using links from fragment assembly string graphs, but the graphs can be extended using edges derived from other sources such as paired end sequencing data, de Bruijn graphs or even reference genomes. multi allelic regions are efficiently detected by searching for bubble structures in the contig graph, enabled by its decomposition into bi and tri connected components. Although mary gold can detect local sequence variation, i.e. multiple alleles of a genomic locus, it ignores variation that not does not result in a detectable bubble, such as duplications and translocations, i.e. due to horizontal gene transfer. Sequence variation in meta genomes and in particular between meta genomes i.e. comparative meta genomics is still a largely unexplored field. Our algorithm not only finds sequence variation within a single meta genomic sample but also between samples, and it allows for convenient visualization and interpretation of variation of even multiple meta genomic sequencing samples. The importance of sequence variation detection in meta genomes was demonstrated by finding variability in ABC transporters that are involved in resistance to multiple drugs in the kimchi sample and variability in bacterial cell surface proteins that bind to human Ig in the infant's microbio me. Comparing data sampled at different time points in the infant's microbio me showed varying relative abundance during the early colonization of its gut, suggesting competition between closely related strains until a stable composition is reached. As sequencing gets cheaper, more assembly grade meta genomics sequencing datasets become available. It will soon be possible to compare cohorts of samples and detect sequence level difference in micro biomes or other environmental samples explaining specific phenotypes, and link the meta genotypes to disease. The development of tools, such as mary gold that find this sequence variation and allow further analysis and interpretation is essential for effectively mining the meta genomics sequencing data note The number of Bambus 2 and mary gold calls is the number of bubbles that mapped to the K12 genome.
