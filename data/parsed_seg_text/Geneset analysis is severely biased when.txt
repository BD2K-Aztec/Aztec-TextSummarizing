Motivation: DNA methylation is an epigenetic mark that can stably repress gene expression. Because of its biological and clinical significance , several methods have been developed to compare genome wide patterns of methylation between groups of samples. The application of gene set analysis to identify relevant groups of genes that are enriched for differentially methylated genes is often a major component of the analysis of these data. This can be used, for example, to identify processes or pathways that are perturbed in disease development. We show that gene set analysis, as it is typically applied to genome wide methylation assays, is severely biased as a result of differences in the numbers of CpG sites associated with different classes of genes and gene promoters. Results: We demonstrate this bias using published data from a study of differential CpG island methylation in lung cancer and a dataset we generated to study methylation changes in patients with long-standing ulcerative colitis. We show that several of the gene sets that seem enriched would also be identified with randomized data. We suggest two existing approaches that can be adapted to correct the bias. Accounting for the bias in the lung cancer and ulcerative colitis data-sets provides novel biological insights into the role of methylation in cancer development and chronic inflammation, respectively. Our results have significant implications for many previous genome wide methylation studies that have drawn conclusions on the basis of such strongly biased analysis.

introduction microarrays and high throughput sequencing are frequently used to assess the methylation status of CpG sites and CpG islands genome wide. Array platforms for this purpose have been developed by Agilent, Illumina and nimble gen and several high throughput sequencing based methods have also been developed, such as genome wide bi sulphate sequencing, me dip seq () and help seq (). gene set analysis (GSA) is frequently used to discover meaningful biological patterns from lists of genes generated from high throughput experiments, including genome wide DNA methylation studies. The objective is typically to identify similarities between the genes, with respect to annotations available from sources such as the Gene Ontology (GO) () or Kyoto Encyclopedia of Genes and Genomes (KEGG) (). Popular tools for this purpose include GOstats () and DAVID (). A significant result for a gene set is interpreted as evidence that the corresponding biological function or process is affected in the experimental condition or treatment. A key assumption of GSA methods is that all genes have, a priori, the same probability of appearing in the list. If this is not true, that is, if certain classes of genes are more likely to appear in the list, regardless of the treatments or conditions being investigated, this has the potential to cause misleading results from GSA. The application of GSA to lists of genes found to be differentially expressed between groups of samples using rnase q is known to be affected by such a bias (). This is because there is more power to detect changes in expression for genes with higher numbers of mapped sequence reads. Consequently, longer and more highly expressed genes (which tend to have more mapped reads) are more likely to be identified as differentially expressed. The lengths and expression levels of genes frequently differ between gene sets, resulting in some gene sets wrongly appearing to be enriched among the differentially expressed genes. A method to correct this bias has already been developed (). However, the application of GSA is not restricted to the results of high throughput gene expression measurements; the same approach is used for many other high throughput experiments. A similar issue has also been highlighted in chips eq data, when distal binding sites are included in the analysis. In this case, GSA may be confounded when genes in different gene sets are represented by different proportions of the genome developed GREAT, a tool that can take account of these differences by using a binomial test over a user defined set of genomic regions. However, GREAT is not suitable for analysis of methylation data, as it can not differentiate between *To whom correspondence should be addressed. one gene in a set with many highly differentially methylated CpG sites or many genes in the same set with one highly differentially methylated CpG site each. This distinction is important in studies of DNA methylation because there are many cases where methylation of only one CpG site has been shown to perturb expression (for example,); hence, GREAT has not been applied to data of this type. Here, we focus on the application of GSA to the results of high throughput DNA methylation experiments. We show that GSA, as it is typically applied to DNA methylation data, is severely biased and show that methods that have previously been applied to rnase q data can be adapted to correct this bias.
