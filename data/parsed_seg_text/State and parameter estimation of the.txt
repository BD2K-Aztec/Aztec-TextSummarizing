Motivation: Traditional models of systems biology describe dynamic biological phenomena as solutions to ordinary differential equations, which, when parameters in them are set to correct values, faithfully mimic observations. Often parameter values are tweaked by hand until desired results are achieved, or computed from biochemical experiments carried out in vitro. Of interest in this article, is the use of probabilistic modelling tools with which parameters and unobserved variables, modelled as hidden states, can be estimated from limited noisy observations of parts of a dynamical system. Results: Here we focus on sequential filtering methods and take a detailed look at the capabilities of three members of this family: (i) extended Kalman filter (EKF), (ii) unscented Kalman filter uk f and (iii) the particle filter, in estimating parameters and unobserved states of cellular response to sudden temperature elevation of the bacterium Escherichia coli. While previous literature has studied this system with the EKF, we show that parameter estimation is only possible with this method when the initial guesses are sufficiently close to the true values. The same turns out to be true for the uk f. In this thorough empirical exploration, we show that the non-parametric method of particle filtering is able to reliably estimate parameters and states, converging from initial distributions relatively far away from the underlying true values. Availability and implementation: Software implementation of the three filters on this problem can be freely downloaded from

introduction in systems biology, sets of ordinary differential equations (ODEs) are often used to characterize biochemical reactions. The differential equations capture our knowledge of the underlying interactions in a quantitative way and solutions to such systems of equations help explain behaviour at an overall systems level. Much of the work in the area deals with deterministic differential equations, often non-linear (e.g. Hill kinetics). Unknown parameter values in their specification, such as reaction rates, are obtained from biochemical * To whom correspondence should be addressed. experiments conducted in vitro, or are set to specific values by elaborate hand tuning so that a set of observations from the system under study are best explained. Sometimes, such parameters may not have direct biological interpretations and are used as approximations (). The yeast cell cycle model of () is a good example of this. The parameter estimation problem has often been posed as a search and optimization problem in the literature. For example, () have explored a range of optimization methods including steepest descent gradient search techniques and methods suitable for global optimization, such as simulated annealing and genetic programming, in the parameter estimation of metabolic systems. An alternate method using spline approximation of the solution, using linear and non-linear programming is described in a recent paper (). These authors consider an enzyme kinetic system and a subset of a cell cycle models how how parameters of a developmental gap gene circuit model may be estimated by extensive search methods. Such approaches to model based explanation of biological phenomena, often do not take into account system and measurement noise in the modelling process. They also do not explicitly seek to infer parameter values or unobserved states from noisy measurements. Techniques using Bayesian inference are alternatives to optimization based approaches, but having the added motivation of being able to capture uncertainties in parameter and state estimates. Examples of work along these lines include () who consider stochastic systems and vy she mirsky and address ode based systems for which parameter estimation is performed by Markov Chain Monte Carlo (MCMC) methods in a probabilistic inference framework. Some authors have recently studied the role of sequential estimation methods for state and parameter estimation from systems biology models, formulated as state space models. lilla cci and kham mash 2010f all into this category. The first three of these use parametric methods based on Kalman filtering, whereas the latter two use the non-parametric approach of particle filtering. The power of the tools we explore in this article have been demonstrated in other areas of application over many decades. These include the adaptive estimation of neural networks (), target tracking from bearing only measurements (), modelling futures contracts in computational finance () and to find global minima of artificial neural networks (). In the context of biology 2007 and Wilkinson (2009) are examples of using probabilistic dynamical systems models to characterize biological systems and to make parameter estimation and inferences from them. While most literature on the subject focuses on batch based models, in which parameter estimation and inference are performed on all the available data, our attention is on sequential, or online, methods. The Kalman filter and its variants, and the particle filter (PF) belong to this family. The formulation of jointly estimating state and parameters by an extended state representation we pursue is due to, who applied unscented Kalman filter uk f to analyze two dynamical systems: the lotka volterra system () and the Lorenz system (). Unknown parameters are treated as states with their time variation set to zero. To motivate non-parametric particle filtering, with the argument that computation is sufficiently cheap to be able to do this used an exceedingly large number of Monte Carlo samples to completely cover all the possible states and parameters space for a complex system such as the mammals circadian genetic control model () which has 45 unknown parameters. While this is an ambitious attempt, motivated under the term peta computing we do not believe the authors make a persuasive case for flooding the space with particles. Instead, as we find in this work, a modest number of particles, of the order of a few thousands, offer very attractive performance in parameter estimation. additionally applied extended Kalman filter (EKF) to simultaneously estimate the states and parameters of two real datasets [i.e. jak stat signal transduction pathway () and ras raf me kerk regulatory pathway (. The remainder of this article is organized as follows. In Section 2, we give the generic formulation of systems biology models cast in state space form, in Section 3, we describe the three algorithms, in Section 4, we define the heat shock response model we use as our test problem, and in Section 5 we present our results and discuss them. Typical results needed to support our conclusions are presented in the main body of this article, and more detailed results, covering the estimation of various parameter combinations being estimated, are given as online Supplementary Material accompanying this article in the journal's website.

conclusion this work demonstrates the effectiveness of the method of particle filtering in state and parameter estimation of deterministic systems biological models from noisy observations. We have shown this via a comparative study between extended Kalman, unscented Kalman and particle filtering applied to the heat shock response system using single and multiple parameter estimations. While previous authors have argued that the Kalman filter itself is capable of such estimations, our critical appraisal shows that this is only possible when the initial guess of the state and or state parameters are very close to the true values. Convergence is not achieved when the initial conditions differ significantly from the corresponding true values. The PF, on the other hand, is able to converge to true values even when all the particles are initially set to values far away from the underlying true values, providing a powerful, yet simple to implement, way of tackling difficult inference problems in systems biology. We further showed in this work that when the complexity of the problem is gradually increased (i.e. the number unknown parameters states to be inferred), the Kalman filter algorithms failed well before the PF did. Even in the extreme case of all parameters being unknown, the PF manages to find correct estimates of five of the six. This suggests that the non-parametric approach of the PF, by virtue of being able to systematically propagate uncertainties while exploring the space over a wide range, is a powerful methodology to tackle such difficult problems. Our current work concentrates on stretching such analyses to more difficult higher dimensional problems such as cell cycle regulation, circadian rhythm and sino-atrial pace making in heart tissues.
