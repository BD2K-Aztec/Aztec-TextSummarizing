Motivation: The field of phylo dynamics focuses on the problem of reconstructing population size dynamics over time using current genetic samples taken from the population of interest. This technique has been extensively used in many areas of biology but is particularly useful for studying the spread of quickly evolving infectious diseases agents, e.g. influenza virus. phylo dynamic inference uses a coalescent model that defines a probability density for the genealogy of randomly sampled individuals from the population. When we assume that such a genealogy is known, the coalescent model, equipped with a Gaussian process prior on population size trajectory, allows for nonpara-metric Bayesian estimation of population size dynamics. Although this approach is quite powerful, large datasets collected during infectious disease surveillance challenge the state of the art of Bayesian phylo dynamics and demand inferential methods with relatively low computational cost. Results: To satisfy this demand, we provide a computationally efficient Bayesian inference framework based on Hamiltonian Monte Carlo for coalescent process models. Moreover, we show that by splitting the Hamiltonian function, we can further improve the efficiency of this approach. Using several simulated and real datasets, we show that our method provides accurate estimates of population size dynamics and is substantially faster than alternative methods based on elliptical slice sampler and metropolis adjusted Langevin algorithm. Availability and implementation: The R code for all simulation studies and real data analysis conducted in this article are publicly available at

introduction population genetics theory states that changes in population size affect genetic diversity, leaving a trace of these changes in individuals' genomes. The field of phylo dynamics relies on this theory to reconstruct past population size dynamics from current genetic data. In recent years, phylo dynamic inference has become an essential tool in areas like ecology and epidemiology. For example, a study of human influenza A virus from sequences sampled in both hemispheres pointed to a sources ink dynamics of the influenza evolution phylo dynamic models connect population dynamics and genetic data using coalescent based methods (). Typically, such methods rely on kingman s coalescent model, which is a probability model that describes formation of genealogical relationships of a random sample of molecular sequences. The coalescent model is parameterized in terms of the effective population size, an indicator of genetic diversity (). While recent studies have shown promising results in alleviating computational difficulties of phylo dynamic inference (), existing methods still lack the level of computational efficiency required to realize the potential of phylo dynamics developing surveillance programs that can operate similarly to weather monitoring stations allowing public health workers to predict disease dynamics to optimally allocate limited resources in time and space. To achieve this goal, we present an accurate and computationally efficient inference method for modeling population dynamics given a genealogy. More specifically, we concentrate on a class of Bayesian nonparametric methods based on Gaussian processes (). Following Palacios and min in (2012) and, we assume a log gaussian process prior on the effective population size. As a result, the estimation of effective population size trajectory becomes similar to the estimation of intensity of a log gaussian Cox process lg cp which is extremely challenging since the likelihood evaluation becomes intractable: it involves integration over an in finite dimensional random function. We resolve the intractability in likelihood evaluation by discretizing the integration interval with a regular grid to approximate the likelihood and the corresponding score function. For phylo dynamic inference, we propose a computationally efficient Markov chain Monte Carlo (MCMC) algorithm using Hamiltonian Monte Carlo (HMC;) and one of its variants, called Split HMC (), which speeds up standard HMC's convergence. Our proposed algorithm has several advantages. First, it updates all model parameters jointly to avoid poor MCMC convergence and slow mixing rates when there are strong dependencies among model parameters (Knorr). Second, unlike a recently proposed Integrated Nested Laplace Approximation method in la which approximates the posterior distribution of model parameters given a fixed genealogy, our approach can be extended to more general settings where we observe genetic data (as opposed to the genealogy of sampled individuals) that provide information on genealogical relationships. Third, we show that our method is up to an order of magnitude more efficient than alternative MCMC algorithms, such as metropolis adjusted Langevin algorithm (MALA;), adaptive MALA (aMALA; Knorr) and Elliptical Slice Sampler (ES 2 ;) that are commonly used in the field of phylo dynamics. Finally, although in this article we focus on phylo dynamic studies, our proposed methodology can be easily applied to more general point process models. The remainder of the article is organized as follows. In Section 2, we provide a brief overview of coalescent models and HMC algorithms. Section 3 presents the details of our proposed sampling methods. Experimental results based on simulated and real data are provided in Section 4. Section 5 is devoted to discussion and future directions.

discussion phylo dynamic inference has become crucial in conservation biology, epidemiology and other areas. Bayesian nonparametric methods coupled with coalescent models provide a powerful framework to infer changes in effective population sizes with many advantages. One of the main advantages of Bayesian nonparametric methods over traditional parametric methods that assume fixed functional form of N e t, such as exponential growth (), is the ability of Bayesian nonparametric methods to recover any functional form without any prior knowledge about N e t. With the technological advance of powerful tools for genotyping individuals, it is crucial to develop efficient methodologies that can be applied to large number of samples and multiple genes. In this article, we have proposed new hmc based sampling algorithms for phylo dynamic inference. We have compared our methods to several alternative MCMC algorithms and showed that they substantially improve computational efficiency of gp based Bayesian phylo dynamics. (More results are provided in the Supplementary Document.) Further, our analysis shows that our results are not sensitive to the prior specification for the precision parameter j. This is inline with previously published results for similar models (see Supplementary Material of). To obtain the analytical solution of (14a) in split hmc we eigen decompose the precision matrix C 1 in , sacrificing sparsity. One can, however, use the Cholesky decomposition instead C 1 in  R T R and transform f   Rf. This way, the dynamics (14a) would be much simpler with the solution as a rotation (). Because R is also tridiagonal similar to C 1 in , in theory the computational cost of split hmc could be reduced to OD. In practice, however, we found that this approach would work well when the Hamiltonian (13) is mainly dominated by the middle term. This condition does not hold for the examples discussed in this article. Nevertheless, we have provided the corresponding split hmc method with Cholesky decomposition in the Supplementary File, since it can still be used for situations where the middle term does in fact dominate the overall Hamiltonian. There are several possible future directions. One possibility is to use ES 2 as a proposal generating mechanism in updating f as opposed to using it for sampling from the posterior distribution. Finding a good proposal for j (or s), however, remains challenging. Another possible direction it to allow j to be time dependent. When there is rapid fluctuation in the population, one single precision parameter j may not well capture the corresponding change in the latent vector f. Our future work will include time varying precision j t or more informative covariance structure in modeling Gaussian prior. Also, we can extend our existing work by allowing irregular grids, which may be more suitable for rapidly changing population dynamics. Another important extension of the methods presented here is to allow for multiple genes and genealogical uncertainty. The MCMC methods proposed here can be incorporated into a hierarchical framework to infer population size trajectories from sequence data directly. In contrast, in la can not be adapted easily to perform inference from sequence data. This greatly limits its generality.
