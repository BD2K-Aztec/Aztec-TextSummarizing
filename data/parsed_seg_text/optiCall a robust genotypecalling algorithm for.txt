Motivation: Existing microarray genotype calling algorithms adopt either snp by snp snp wise or sample by sample sample wise approaches to calling. We have developed a novel genotype calling algorithm for the Illumina platform, optic all that uses both snp wise and sample wise calling to more accurately ascertain genotypes at rare, low frequency and common variants. Results: Using data from 4537 individuals from the 1958 British Birth Cohort genotyped on the immuno chip we estimate the proportion of SNPs lost to downstream analysis due to false quality control failures, and rare variants misclassified as monomorphic, is only 1.38% with optic all in comparison to 3.87, 7.85 and 4.09% for il luminus geno snp and gen call respectively. We show that optic all accurately captures rare variants and can correctly account for SNPs where probe intensity clouds are shifted from their expected positions. Availability and implementation: optic all is implemented in C++ for use on UNIX operating systems and is available for download at

introduction burgeoning whole genome and whole exo me sequencing projects are likely to require large scale microarray based follow-up studies. Already, custom arrays, such as metabo chip and immuno chip utilize SNPs identified through population based sequencing efforts such as 1000 genomes to better survey loci known to underpin variation across related phenotypes (). Typically, the allelic probes on these custom arrays have undergone less stringent quality control (QC) compared to those that make it onto mass produced g was arrays. This drop in probe quality, in addition to a greater focus on low frequency and rare variants (those with minor allele frequencies 0.55% and 0.5%, respectively; The 1000) presents many problems for existing genotype calling algorithms. genotype calling algorithms use normalized measures of DNA binding to allele specific probes to ascertain the genotype of an individual at a given SNP. As an example, a wild type homozygous genotype at a particular SNP would have a high intensity value for the wild type allelic probe, and little or no intensity for * To whom correspondence should be addressed. the alternative allelic probe. A heterozygous sample would have intermediate intensities for both probes. Existing callers vary in both the statistical models they apply, and how they utilize the intensity data across individuals and SNPs. illumina s proprietary genotype calling software, gen call uses a custom clustering algorithm that encompasses several biological heuristics to determine genotypes from intensity clouds obtained by gathering all individuals at a single SNP. If less than three well defined genotype clusters are observed, gen call uses a neural network model to estimate the location and shape of the undefined clusters. gen call is designed to work on Illumina arrays and, being based on a pre trained neural network, its performance on a new dataset is dependent on how close the new data matches the data used to train the network. Another commonly used genotype calling algorithm, il luminus (), also designed for Illumina arrays, again clusters intensity data across samples on a per SNP basis, using an unsupervised clustering method based on a mixture model of Student's t distributions. This unsupervised approach removes the need for a called training set. However, low frequency SNPs and or small sample sizes can result in poorly defined clusters and inaccurate genotype calls due to the small number of rare allele observations discovered within sample intensity data also tended to cluster into three distinct genotype groups. On the basis of this observation, they created geno snp a within sample genotype calling algorithm. Clustering within sample can be advantageous for rare variants and small sample sizes, as three well defined clusters are always observed. A drawback of the approach is that intensity variation between SNPs is not accounted for, resulting in inaccurate genotype calls for SNPs where intensity clusters are shifted from their expected positions. We have developed optic all a novel genotype calling algorithm that uses both within and across sample intensity data to accurately ascertain genotypes from across the minor allele frequency spectrum. In the following sections, we describe optic all and compare its output to that from existing algorithms using 4537 samples from the 1958 British Birth Cohort () genotyped on the immuno chip an Illumina i select HD custom array ().
