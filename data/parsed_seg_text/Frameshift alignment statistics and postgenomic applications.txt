Motivation: The alignment of DNA sequences to proteins, allowing for frame shifts is a classic method in sequence analysis. It can help identify pseudogenes (which accumulate mutations), analyze raw DNA and RNA sequence data (which may have frameshift sequencing errors), investigate ribosomal frame shifts etc. Often, however, only ad hoc approximations or simulations are available to provide the statistical significance of a frameshift alignment score. Results: We describe a method to estimate statistical significance of frameshift alignments, similar to classic BLAST statistics. (BLAST presently does not permit its alignments to include frame shifts We also illustrate the continuing usefulness of frameshift alignment with two post genomic applications: (i) when finding pseudogenes within the human genome, frameshift alignments show that most anciently conserved non-coding human elements are recent pseudogenes with conserved ancestral genes; and (ii) when analyzing meta genomic DNA reads from polluted soil, frameshift alignments show that most align able meta genomic reads contain frame shifts suggesting that meta genomic analysis needs to use frameshift alignment to derive accurate results. Availability and implementation: The statistical calculation is available in f alp
introduction although the pairwise alignment of DNA and protein is a classical problem in bioinformatics (), it presents new challenges as next generation sequencing (NGS) of DNA supplants Sanger sequencing. The per base error of Sanger sequencing is as low as 0.001% (), but NGS can produce per base errors of $12% (). NGS can also make frequent insertion and deletion errors, e.g. 454 sequencing in HIV-1 produced occasional per base insertion and deletion error rates of almost 50% (). More recent sequencing methods such as pac bio also have high in del rates (). The insertion and deletion errors cause frequent frame shifts when DNA is annotated by electronic translation and alignment to proteins. This article studies the statistics of 'frameshift alignment', a pairwise alignment of translated DNA and a protein, with particular attention to frameshift errors. Frameshift alignment has been used for protein domain classification (), determining exact gene start position (), discovering distant protein homologies (), predicting exon intron structure () and so on. Large post genomic datasets require fast sequence comparison tools. There are several tools that can compare DNA sequences with proteins, including NCBI BLAST (), u search (), rap search (), p aud a () and ghost m (), but none of these consider frame shifts. The fast a package has excellent support for frame shifts but is not designed for large searches such as whole meta genomes versus all known proteins (). LAST has supported frameshift alignment since 2009, and is designed for large searches (). We should also mention hax at which accurately aligns Roche 454 DNA sequences to proteins allowing for frame shifts but is not designed for large scale searches (). Some studies have focused on developing frameshift alignment algorithms; few have focused on the accurate estimation of e values for frameshift alignment scores. In alignments without frame shifts errors in approximate e values can usually be controlled (); with frame shifts errors are rarely controlled. On one hand, fast xy calculates alignment p values with z scores (). On the other hand, BLAST tools comparing translated DNA to protein do not consider frame shifts. Rather, they consider six alignment reading frames, calculating their e values as though only one reading frame was explored (). With NGS supplanting Sanger sequencing, the need for accurate frameshift alignment p values has increased because users require an E-value accounting for frequent frame shifts to decide which sequences are true homologs. The Ascending Ladder Program (ALP) was developed for real time computation of the statistical parameters in BLAST (). It is based on an importance sampling method using a global alignment of two simulated sequences generated by a Markov chain (). Heuristic modeling of the ascending alignment scores of the global alignment as a Markov additive *To whom correspondence should be addressed.

discussion we presented a new program f alp that assesses the statistical significance of a frameshift alignment score. In the algorithm section, we assumed that a nucleotide insertion or deletion occurs only between two consecutive codons. However, f alp can easily handle general error models because f alp is based on a Markov chain. Simply we define insertion or deletion error events as Markov states and add the corresponding Markov states to the current seven states in the Markov state space. We suggested a simple way of roughly annotating pseudogenes in a genome by frameshift alignment search of a protein database. These annotations are highly informative, even without tackling the hard question of distinguishing pseudogenes from real genes. In particular, these annotations overlap, and explain, most apparently conserved non-coding elements. This enables us to focus on the remaining unexplained conserved elements, which are likely to have important biological roles, such as regulation. On the other hand, ultra conserved elements' () are not pseudogenes see the Supplement. We also analyzed one meta genomic DNA dataset by alignment to known proteins, and surprisingly found that most align able reads exhibit frame shifts. This fact testifies to the importance of analyzing such data with frameshift alignments. Some frame shifts might not be sequencing errors, but could indicate interesting evolutionary events. Since frameshift alignment is rarely used, we suspect that there is a lot to discover with it. Frameshift alignment may improve taxonomic identification of meta genomic sequences that lack close relatives in the database. This is because protein is typically more conserved than DNA, and so frameshift alignment should be able to find more distant relationships than the usual dna level alignment. It is also likely to improve gene prediction, where it is critical to get the correct reading frame. This study demonstrates that statistically rigorous large scale frameshift alignment can be done easily, and we hope it will encourage renewed interest in this powerful technique.
