Motivation: The evolution of proteins can not be fully understood without taking into account the coevolutionary linkages entangling them. From a practical point of view, coevolution between protein families has been used as a way of detecting protein interactions and functional relationships from genomic information. The most common approach to inferring protein coevolution involves the quantification of phylogenetic tree similarity using a family of methodologies termed mirror tree. In spite of their success, a fundamental problem of these approaches is the lack of an adequate statistical framework to assess the significance of a given coevolutionary score (tree similarity). As a consequence, a number of ad hoc filters and arbitrary thresholds are required in an attempt to obtain a final set of confident coevolutionary signals. Results: In this work, we developed a method for associating confidence estimators (P values) to the tree similarity scores, using a null model specifically designed for the tree comparison problem. We show how this approach largely improves the quality and coverage (number of pairs that can be evaluated) of the detected coevolution in all the stages of the mirror tree workflow, independently of the starting genomic information. This not only leads to a better understanding of protein coevolution and its biological implications, but also to obtain a highly reliable and comprehensive network of predicted interactions, as well as information on the substructure of macromol-ecular complexes using only genomic information. Availability and implementation: The software and datasets used in this work are freely available at

introduction coevolution is a widespread phenomenon with important implications at all biological levels. At the molecular level, coevolution plays a fundamental role in key cellular systems, allowing their components to change and evolve while maintaining their interactions (). Quantifying the ongoing coevolution between different molecular features has been proposed as a proxy to predict different types of interactions. Among the most successful approaches are those applied for detecting protein protein interactions and functional relationships and, more recently, for the accurate prediction of residue contacts in individual proteins (). The evolutionary histories of interacting protein partners are not independent but entangled in many different ways. coevolution based approaches benefit from this observation in order to detect protein interactions. As the predictions are only based on the vast amount of genomic and sequence information available nowadays, these methods are suitable for the systematic detection of interactions in a wide range of organisms, such as bacteria (), fungi () or human ().Protein coevolution is reflected in different genomic and sequence features (). A popular approach for inferring coevolution is to evaluate the similarity of phylogenetic trees. Phylogenetic trees represent the putative evolutionary histories of the corresponding protein families and, consequently, similar protein trees imply similar evolutionary histories. This is the basis of the mirror tree and related methods for detecting protein interactions using genomic information [see () for a recent review]. In its simplest form, mirror tree related approaches represent a phylogenetic tree of a family of orthologs as a distance matrix, and quantify the similarity between two trees as the Pearson's linear correlation between the sets of values of their corresponding matrices (). In spite of their success in detecting interactions, this approach has a number of 'methodological' and 'biological' problems, which were partially overcome with different variations of the original method. On the methodological side, it is well known that the internal co dependencies between the values of distances matrices burden the significance assessment of a given correlation coefficient. The tabulated P values, regularly used to assign correlation significances, assume the independence of the vectors' components. Since the distances in the phylogenetic trees can not freely change to adopt any possible value, strictly speaking, these P values are not adequate, in spite of having shown an improvement on the interaction prediction (). Another consequence of the incompleteness of this null model is that these methods required a minimum number of organisms in common between the two trees (generally around 15) in order to take into consideration a given correlation. This additional requisite drastically decreases the coverage of the methods: the number of protein pairs that can be evaluated. Moving into the biological problems, the distances within the matrices are also constrained by the evolutionary characteristics of the trees they come from. For example, the limits in the divergence between homologous sequences constrain the observed distances to certain values. Moreover, tree leaves corresponding to evolutionary close species will present a strong tendency to be close in all phylogenetic trees regardless of the proteins they represent, and vice versa for distant species. As a consequence, all trees of orthologs have a certain level of similarity, between them and with the canonical species tree. This 'background' similarity, reflected in correlation values relatively higher even for non-interacting pairs, has been corrected using external representations of the tree of life () or removing the common signal in a large collection of trees (). Another problem is related to the presence of redundant tax a on the sets of organisms used for constructing the trees. As the sequencing efforts are biased to certain organisms, phylogenetic trees become populated in an unbalanced way. Indeed, previous analyses have shown that using trees based on nonredundant sets of organisms increased the performance of the basic mirror tree approach (). Some of these problems are alleviated in the recent context based mirror tree variations. These approaches use all pairwise tree similarities of a given proteome to reassess a given coevolutionary signal, largely improving the predictions (). These context based approaches also help to disentangle direct coevolutionary signals from those due to third proteins (indirect), which is important since the latter are not always related to protein interactions. Indeed, in the case of residue residue coevolution, recent methods characterized by this capacity to filter indirect coevolution s are able to predict contacts in protein structures with very high reliability when fed with enough sequences ().Here we propose a new approach, p mirror tree (pMT), which aims at correcting, in a single shot, all these problems associated with the quantification of tree similarity and the assessment of its significance. pMT generates null distributions of tree similarities (correlation coefficients) obtained from large sets of shuffled phylogenetic trees from which empirical P values can be derived. We show that this approach overcomes previous mirror tree versions and produces predictions of high quality and coverage, the latest due to not requiring a threshold of minimum number of organisms in common to evaluate tree similarity. The improvement is particularly high when this approach is coupled to the modern context based methods. Moreover, pMT is largely insensitive to the characteristics of the set of organisms used to build the trees (number and taxonomic redundancy). In order to assess these improvements under different scenarios of available genomic information, we perform a retrospective analysis of the predictive power of several mirror tree based approaches when fed with the genomic information available at different time points in the past. Consequently, this work also evaluates, for the first time, how the non-homogeneous exploration of the bacterial taxonomy in terms of sequenced genomes affects the detection of coevolution, and which trends are expected for the future.

discussion coevolution takes place at all biological levels (species, proteins, amino acids. .. ) (). This evolutionary linkage between the biological entities is crucial for maintaining relationships and interactions while allowing the two partners to evolve and change. In this sense, coevolution is fundamental for evolutionary innovation. At the molecular level, protein coevolution has provided a wealth of information about different systems. Recent advances on the detection of residue contacts have joined the detection of protein interactions as some of the most popular applications based on coevolution. For a recent review see (). The maturity of coevolution based approaches, together with the increase in the genomic information that feeds them, has led in recent years to the quotidian application of these approaches to many protein families of interest, in many cases directing or combined with experimental approaches. See for example (), and () for a review. Nevertheless, the observed protein protein coevolution, quantified as the similarity of the corresponding phylogenetic trees, is influenced by many factors complicating the disentanglement of those more directly related to the interaction. The results presented here demonstrate that the prediction of protein interactions at different levels (pairs, complexes, and whole networks) is clearly improved when the statistical confidence of the pairwise tree similarity is evaluated based on a background distribution of tree similarities. Assessing the significance of a given tree similarity using this distribution of expected correlations corrects, in a natural way, many of the confounding factors that affect the performance of the original MT, including the background similarity due to the underlying speciation process, the redundancy of the set of organisms used for building the trees and the different range of organisms in which the two proteins are present. Previous attempts to correct these factors implied workarounds, pre and post filtering arbitrary thresholds and other ad hoc heuristic approaches. pMT intrinsically corrects all these factors producing an estimation of the likelihood of the co-evolution under a solid statistical framework. This is especially important taking into account that the genomic information used as input by these methods will change constantly due to the stream of newly sequencing genomes. Whereas heuristic approaches would have to change and adapt constantly to these new data, our results show how pMT is robust to this change in the input genomic information. The pMT method does not require an artificial threshold on the minimum number of organisms to evaluate a given pair of trees. Leaving apart the difficulty in deciding such a threshold (which depends on the characteristics of the dataset, as we show), not requiring it has two main advantages, both related with the increase in coverage (number of pairs that can be evaluated). On one hand, the results are not biased to 'central' proteins: these proteins involved in core cellular processes are present in many organisms and consequently pairs involving them would more probably pass that threshold of minimum number of organisms. On the other hand, that increase in coverage is crucial to the context based methods, which use the whole network of pair-wise tree similarities as input. With pMT this network is much more populated and that, together with the intrinsic better performance of pMT at the pair level, makes these context based approaches render better results when coupled with pMT. This new method is not only better for detecting interacting pairs, but can be used to get insight into the substructure and functioning of macromolecular complexes (as illustrated for the ATPase), as well as to obtain a highly reliable network of protein interactions at a genomic scale (as exemplified by the E.coli network generated here). In the latter case, the pMT method presented here is crucial since previous approaches were either highly reliable but presented a low coverage, or the other way around. pMT has a high performance, specially when coupled with context based methods, and can be applied to pairs of trees never explored before (e.g. those with a small number of species in common). These improvements and advantages come at no cost in terms of applicability, since no additional restrictions are required to run pMT, apart from the contextual information necessary to generate the null distributions ('background' set of trees). As presented in this work, this can be seen as a drawback since trees for the whole proteome of interest are required to be used as background. On one hand, this is common to previous context based approaches. On the other hand, it remains to be explored whether other more restricted sets of trees can eventually be used as background (e.g. trees for the membrane proteins or for those in a given biological process) with better results, as they could serve as a better background for representing the characteristics of the system of interest. As a side result, the historical perspective of our analysis allows to foresee a continuous increase in the performance of co-evolution based approaches as more genomes are sequenced, highlighting the value of the ongoing genome sequencing projects. There is a plethora of approaches based on the original mirror tree method (see () for a review). The results presented here indicate that the pMT approach, which touches the base of the methodology itself, could improve all of them. That was the case for the two context based mirror tree variations evaluated here. Although all the quantification of performances presented are based on the method's ability to detect interactions, we are confident that this approach goes beyond the 'practical' applicability in interaction prediction, and will serve to better understand the complex phenomenon of protein coevolution as well.
