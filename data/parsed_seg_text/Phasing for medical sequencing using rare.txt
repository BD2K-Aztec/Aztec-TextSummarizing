Motivation: There is growing recognition that estimating haplotypes from high coverage sequencing of single samples in clinical settings is an important problem. At the same time very large datasets consisting of tens and hundreds of thousands of high coverage sequenced samples will soon be available. We describe a method that takes advantage of these huge human genetic variation resources and rare variant sharing patterns to estimate haplotypes on single sequenced samples. Sharing rare variants between two individuals is more likely to arise from a recent common ancestor and, hence, also more likely to indicate similar shared haplotypes over a substantial flanking region of sequence. Results: Our method exploits this idea to select a small set of highly informative copying states within a Hidden Markov Model (HMM) phasing algorithm. Using rare variants in this way allows us to avoid iterative MCMC methods to infer haplotypes. Compared to other approaches that do not explicitly use rare variants we obtain significant gains in phasing accuracy, less variation over phasing runs and improvements in speed. For example, using a reference panel of 7420 haplotypes from the UK10K project, we are able to reduce switch error rates by up to 50% when phasing samples sequenced at high coverage. In addition, a single step re phasing of the UK10K panel, using rare variant information, has a downstream impact on phasing performance. These results represent a proof of concept that rare variant sharing patterns can be utilized to phase large high coverage sequencing studies such as the 100 000 Genomes Project dataset. Availability and implementation: A web server that includes an implementation of this new method and allows phasing of high coverage clinical samples is available at https://phasingserver.stats.ox.ac.uk/.

introduction information about the haplotypes underlying diploid genotypes is central to pipelines for a wide range of genetic analyses. Standard examples include inference of human demographic history (1000), detection of signatures of selection () and imputation of untyped genetic variation (). Estimation of haplotypes from genotype data, known as phasing, is typically treated as a problem of computational statistical inference for which there is an extensive literature (). Typically,

discussion we have shown that large haplotype reference panels can be exploited for phasing of single samples. We have done this by using the sharing of rare alleles between un phased genotypes and individuals in the reference panel to inform the selection of copying states for an hmm based phasing algorithm. This can already be potentially useful in many contexts in medical genetics, where genotypes have been obtained via high coverage sequencing one important feature of our method is that the selection of copying states depends only on the un phased genotypes. In any iterative extension, this means that the selection of states need be done only once. For existing methods which update copying states at each iteration based on matching of estimated haplotypes, this selection step becomes a computational bottleneck when the number of un phased samples is very large ( 15 000) and necessitates additional approximations (O', manuscript submitted). The general principle of using rare variants to pre calculate which samples are potentially informative for phase offers a potentially more accurate and computationally more tractable approach. We would expect the benefits of an iterative application of our method to be especially evident in the phasing of whole genome sequencing data on large cohorts of individuals such as the 100 000 samples being collected as part of the Genomics England project. The high coverage sequencing and large sample size will uncover a high number of very rare variants. An accurately phased set of haplotypes will be important for downstream analyses such as genotype imputation and demographic inference. We are working towards extending our method for application to such datasets. Our method relies on access to a large haplotype reference panel. The haplotype reference panels such as those produced by the Genomics England project and the Haplotype Reference Consortium will not be publicly available as has been the case with projects such as HapMap and the 1000 Genomes Project, due to the way in which the study individuals have consented for data release. To address these restrictions we have developed a phasing server that allows clinical samples sequenced at high coverage to be phased against the HRC reference panel or the UK10K reference panels https://phasingserver. stat sox ac uk. The method is primarily designed for application to high coverage sequencing data where SNP genotypes can be called very accurately and without using LD. The method could in principle be applied to low coverage sequencing data, but genotype calling without LD from such data will produce incorrect genotypes, which would affect downstream phasing accuracy. As we have described it, this approach does not permit the phasing of sites that are polymorphic in the un phased sample, but not represented in the reference panel. One possibility for phasing such sites is to use PIRs (). Our method complements this approach and, as we have shown, can be combined with it. However, in settings where we have a number of un phased samples which perhaps share some rare variants not represented in a reference panel, it would make sense to pool the un phased samples with the reference panel before selecting copying states and then to apply an iterative updating scheme. We are working towards extending our method to do this.. Properties of using rare variants for state selection. (a) Effect on switch error rate of varying the minimum minor allele count used for selecting individuals from whom to copy in shape it r. Horizontal axes: minimum minor allele count (bottom) and corresponding frequency in panel (top) used for selection. Solid lines: mean switch error rates for shape it r dashed (and dashdot) lines: mean switch error rates for shape it2 with (and without) MCMC. Colours indicate whether K  400 (red) or K  800 (blue) copying states were used. In both cases, errors refer to phasing the whole of chromosome 20 and were averaged over both trio parents and 20 runs. (b) Distribution of maximum allele counts used for matching in a single window when choosing K  400 copying states. Horizontal axis: maximum minor allele count (bottom) and corresponding frequency in the reference panel (top) of a site used for matching. Vertical axis: frequency averaged over both trio parents and 20 different runs. Each bar represents a bin of width ' 0:0027 corresponding to an allele count of 20 phasing for medical sequencing
