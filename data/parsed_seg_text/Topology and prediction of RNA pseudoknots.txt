Motivation: Several dynamic programming algorithms for predicting RNA structures with pseudo knots have been proposed that differ dramatically from one another in the classes of structures considered. Results: Here, we use the natural topological classification of RNA structures in terms of irreducible components that are embeddable in the surfaces of fixed genus. We add to the conventional secondary structures four building blocks of genus one in order to construct certain structures of arbitrarily high genus. A corresponding unambiguous multiple context free grammar provides an efficient dynamic programming approach for energy minimization, partition function and stochastic sampling. It admits a topology dependent parametrization of pseudoknot penalties that increases the sensitivity and positive predictive value of predicted base pairs by 10â€“20% compared with earlier approaches. More general models based on building blocks of higher genus are also discussed. Availability: The source code of g fold is freely available at

introduction the global conformation of RNA molecules is to a large extent determined by topological constraints encoded at the level of secondary structure, i.e. by the mutual arrangements of the base paired helices (). In this context, secondary structure is understood in a wider sense that includes pseudo knots. Although the vast majority of RNAs has simple, * To whom correspondence should be addressed. i.e. pseudoknot free secondary structure, pseudo base () lists more than 250 records of pseudo knots determined by a variety of experimental and computational techniques including crystallography, nuclear magnetic resonance, mutational experiments and comparative sequence analysis. In many cases, they are crucial for molecular function. Examples include the catalytic cores of several ribozymes (), programmed frameshifting () and telomerase activity (), reviewed in; Staple and Butcher (2005). Secondary structures can been interpreted as matchings in a graph of permissible base pairs (). The energy of RNA folding is dominated by the stacking of adjacent base pairs, not by the hydrogen bonds of the individual base pairs (). In contrast to maximum weighted matching, the general RNA folding problem with a stacking based energy function is np complete (). The most commonly used RNA secondary structure prediction tools, including m fold () and the Vienna RNA Package (), therefore exclude pseudo knots. polynomial time dynamic programming (DP) algorithms can be devised, however, for certain restricted classes of pseudo knots. In contrast to the O(N 2 ) space and O(N 3 ) time solution for simple secondary structures (), however, most of these approaches are computationally much more demanding. The design of pseudoknot folding algorithms thus has been governed more by the need to limit computational cost and achieve a manageable complexity of the recursion than the conscious choice of a particularly natural search space of RNA structures. As a case in point, the class of structures underlying the algorithm by Rivas and Eddy (1999) (REstructures, pk notre was characterized only in a subsequent publication (). The following references provide a certainly incomplete list of DP approaches to RNA structure prediction using different structure classes characterized in terms of recursion equations and or stochastic grammars: akutsu page 1077 10761085

discussion combinatorial models of pseudo knotted RNA structures are limited in two ways: on the one hand, exact algorithmic folding can be constructed only for certain types of structures; on the other hand, the larger the structure sets are, the more base pairing patterns are contained in them that can not be realized in nature due to steric constraints. Algorithm design so far has been mostly driven by the desire to reduce computational complexity. The idea behind g fold in contrast, is to define a more suitable class of structures that can be generated by nesting and concatenating a small number of elementary building blocks. This recursive structure is captured by a fairly simple unambiguous multiple context free grammar that translates in a canonical way to DP algorithms for computing the minimum energy structure and the partition function in O(N 6 ) time and O(N 4 ) space. In addition to MFE folding, we have implemented the computation of base pairing probabilities and a stochastic back tracing recursion, thus providing the major functionalities of RNA secondary structure prediction software for a very natural class of pseudo knotted structures. The 1 structures considered here strike a balance between the generality necessary to cover almost all known pseudo knotted structures and the restriction to topologically elementary structures that have a good chance to actually correspond to a feasible spatial structure. From a mathematical point of view, the characterization of structures in terms of irreducible components with given topological genus appears particularly natural and promises to reflect closely the ease with which a structure can be embedded in three dimensions. In addition, the grammar underlying g fold naturally distinguishes different types of pseudo knots and admits different energy parameters for them. We observe that this additional freedom of the parametrization leads to a substantial increase of sensitivity of type (K) pseudo knots (0.63  0.889) and PPV (0.73  0.899) compared wit the usage of a common penalty for each crossing of gap matrices. In terms of prediction accuracy, g fold thus compares favorably also with the leading alternative DP approaches to pseudo knotted structures.
