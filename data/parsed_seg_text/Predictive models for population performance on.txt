Motivation: Directed evolution, in addition to its principal application of obtaining novel biomolecules, offers significant potential as a vehicle for obtaining useful information about the topologies of biomolecular fitness landscapes. In this article, we make use of a special type of model of fitness landscapes based on finite state machines which can be inferred from directed evolution experiments. Importantly, the model is constructed only from the fitness data and phylogeny, not sequence or structural information, which is often absent. The model, called a landscape state machine (LSM), has already been used successfully in the evolutionary computation literature to model the landscapes of artificial optimization problems. Here, we use the method for the first time to simulate a biological fitness landscape based on experimental evaluation. Results: We demonstrate in this study that LSMs are capable not only of representing the structure of model fitness landscapes such as nk landscapes but also the fitness landscape of real DNA oligomers binding to a protein allo phy co cyan in data we derived from experimental evaluations on microarrays. The LSMs prove adept at modelling the progress of evolution as a function of various controlling parameters, as validated by evaluations on the real landscapes. Specifically, the ability of the model to predict optimal mutation rates and other parameters of the evolution is demonstrated. A modification to the standard LSM also proves accurate at predicting the effects of recombination on the evolution.

introduction a fitness landscape is a conceptual visualization of the topographic relationship between a genotype and a static fitness function, a property that will determine reproductive rate (). The properties of the fitness landscape relate to the behaviour of evolving populations and as such they have become integral tools in both * To whom correspondence should be addressed.  The authors wish it to be known that, in their opinion, the first two authors should be regarded as joint First authors. evolutionary biology and evolutionary computation. Despite their long term and widespread use, the information pertaining to real biological fitness landscapes is currently limited. As a consequence, researchers interested in studying the dynamics of evolution are often forced to rely on in silico landscape models instead. Many artificial fitness landscapes have attempted to model the properties of real biomolecular fitness landscapes. These have ranged from John Maynard Smith's simple word game metaphor for protein space (), to more complex models, which incorporate properties such as ruggedness and neutrality (). The real fitness landscapes of proteins are poorly understood and so the accuracy of these simplistic models is unknown. At the molecular level adaptive evolution is routinely studied and exploited during the process of directed evolution. The steps within a directed evolution experiment mimic Darwinian processes within a lab and closely resemble the structure of many standard genetic algorithms, methods used widely in computer science for optimization. Iterative cycles of mutation and or recombination) and selection have led to the development of a plethora of novel or improved biological entities (). This has been achieved without any guidance from a molecular level understanding of protein function. Sequencing the intermediates produced during the course of a directed evolution experiment reveals the series of modifications that have led to the new functionality. This approach has provided new insights into the relationship between the sequence and function of proteins and how proteins may adapt during natural evolution (). Determining how properties such as selection pressure, mutation rate and library size (population) will affect the success of future experiments, however, would require extrapolation beyond these limited evaluations. Recently, a study was undertaken to map the complete interaction profile of every possible 10-base oligonucleotide with a fluorescent protein allo phy co cyan in using the ability to perform highly multiplexed assays afforded by microarrays (). Based on over one million evaluations the data set reveals a complete sequence fitness landscape. This still represents a simple biomolecular interaction; ideally, a resource is desired that represents more complex biological systems. No doubt, with the continuing). development and availability of high throughput sequencers and or microarrays, even more extensive datasets will emerge over the coming months and years. This potential development, while exciting, is only part of the battle, however. In order to understand something useful about the landscapes and the dynamics of evolution on them, appropriate models or abstractions from the raw data must be inferred. In computer science, in the field of evolutionary computation, characterizing fitness landscapes and how their features might affect evolutionary progress and dynamics is an area of intense study (). Grefenstette (1995) and Altenberg (1995) independently developed the idea of modelling predicting evolutionary progress from fitness distribution data using, respectively, simple regressions and 'search kernels' to represent these distributions. The Landscape Machine (LSM;) was developed independently, but is a concrete implementation of altenberg s search kernel. It models the fitness landscape of a particular abstract optimization problem as a finite state machine, representing landscapes purely as collections of phenotypic states and describes transitions between these states as a consequence of mutation. Consider S is the collection of all possible fitness values within a landscape, and s (s  S) represents a value associated with an individual (for simplicity a single sequence). When s (the parent's fitness) is transformed by mutation, a new value e (e  S, the child) is generated with a probability t se. The probabilities of transformation between all points within S can be stored within a transition matrix, T , and used to 'replace' the real landscape. In some cases, the LSM can model these transitions exactly represents a simple max ones problem. The states s 05 represent values of solutions to the problem, in which the aim is to optimize the number of 1 s within a binary string {0,1} of length L = 5 (the states match the number of 1 s within the string). Arcs indicate the transition probabilities between these states when a single random bit is flipped (0  1 or 1 0) within a string. Such a model can act as a substitute for the real problem when assessing the performance of a genetic algorithm, in which candidate solutions (variations of the string) have been replaced by these states. The success and speed of several different algorithms (meaning different population sizes, different methods of biased selection, different selection pressures and so forth) can then be assessed without the use of any genotypic information. For more complex landscapes, calculating these transitions or even storing a matrix of transitions between all points within S becomes intractable. If this is the case, points within S are pooled together into equally spaced fitness intervals (states) and transition probabilities are inferred from values generated by a sampling algorithm run on the real landscape. Using this approach, landscape state machines have shown a high degree of accuracy and specificity in predicting the performance of different evolutionary algorithms on a range of optimization problems studied in Computer Science (). LSMs were proposed not only for the study of computer science optimization problems, but also with the intention of future use in directed evolution (). In this article, we begin to examine, empirically, their potential in this area for the first time. Until now, no attempt has been made to model recombination events using LSMs. This task is not a trivial extension to the scheme since populating a three dimensional transition matrix (for the fitnesses of two parents and one child) would require a much greater number of evaluations on the real landscape. In other words, the sampling will be at an even greater order of sparseness than with the standard LSM. The LSM will also be limited in the algorithms it can assess because the sampling algorithm will only sample combinations of parents from a range dictated by the selection pressure employed and the properties of the fitness landscape. We attempt to correct for these problems using a simple heuristic, described in 'Methods' section. The performances of a range of genetic algorithms (including those that incorporate recombination) were assessed on both real landscapes and LSM abstractions of these landscapes. nk landscapes () with different levels of epistasis and a dna protein interaction landscape derived from real experimental evaluations were both investigated. The LSMs proved adept at modelling the features of the landscapes, with strong correlations between the relative performances of the LSMs and the corresponding real world algorithms. The ability to model real biological fitness landscapes with sufficient fidelity to allow predictions of the most appropriate near optimal parameters of evolution (mutation rates, recombination, selection pressures, etc.) using fitness information alone seems to be an encouraging prospect for future progress in this area.

discussion predicting the performance of genetic algorithms using limited sampling is not a new concept and a multitude of statistics have been developed to characterise the features of landscapes and the consequent effects on algorithm performance (). These statistics tend to be self validating in that they are correct only in their own terms and require prior knowledge of the landscape they are characterising. In practice these predictors of genetic algorithm hardness often underperform and are incapable even of determining whether a hill climber (an algorithm that accepts only beneficial changes) will be more effective than a genetic algorithm. Identifying whether a landscape is 'easy' or 'hard' to search using these measures gives almost no indication of how to tackle it. Currently, the only way to tune algorithms for optimal performance on a landscape is to assess the performance of these algorithms through trial and error. LSMs are abstractions of real landscapes based on limited sampling data, allowing genetic algorithm performance to be assessed as it would be on the real landscapes. The ability of the LSM to characterize the landscape of interest can be directly measured by comparison of the performance of the genetic algorithms on the landscapes and on the LSMs. The LSMs in this study are capable of closely replicating algorithm performance on the landscape from which they are derived. The cost of generating the models described here is high, with the number of evaluations sampled from the experimental landscape (1 050 000) similar to the number required to map the entire 10-mer landscape (1 048 576). In contrast no sequence information is required to construct the LSMs. This makes LSMs cheap to construct as by-products of directed evolution experiments, which are more than capable of producing quantities of data of this magnitude it has previously been shown that accurate LSMs can be constructed with far fewer real evaluations and an effective sampling algorithm can be beneficial to LSM accuracy (). In this study, a sampling algorithm with a low mutation rate was selected not for its performance on the landscape, but because from this low mutation rate a much greater range of mutation rates can be assessed by the LSM through matrix multiplication. This comes at a price: higher mutation rate transitions may not be sampled. The predictions made on the performance of algorithms with much higher mutation rates show only a small loss in accuracy, which is remarkable given that any error within the transition matrix is multiplied with every matrix multiplication. The most important finding of this study has been that the simple structure of the LSM is capable of mimicking the features of a real biological landscape derived from real experimental data, despite the noise that is inherent to such measurements and the complex sequence structural interactions. It would be interesting to determine to what extent LSMs can replicate real biological fitness landscapes, and whether they can be extended to model non static and multiple fitness functions. It may be necessary to modify the structure of the LSMs (as we have attempted here to model recombination). For instance higher order Markov models may be more appropriate for highly neutral and epistatic landscapes. Further, landscape state machines are not limited to studying static mutation rates but could also be applied to dynamic mutation rates and could feasibly be implemented in memetic algorithms (). Directed evolution experiments give an insight into the process of molecular evolution that is unobtainable at the level of whole organisms. Parent and child fitness values have previously been used to make quantitative assessments of biomolecular fitness landscapes through measures such as autocorrelation. LSMs go beyond simple landscape metrics, providing an abstraction of the real systems upon which further experiments can be performed (). With the onset of high throughput methodologies for the assessment of modified transformed peptides (), proteins and cells, LSMs can make use of this deluge of data in a tractable manner independent of any sequence or structural information. The resulting LSMs may serve as a resource to researchers studying molecular evolution, providing a platform beyond simplistic and often unrealistic model landscapes. In this study, we extended LSMs to generate 3D structures capable of modelling recombination in genetic algorithms (). Using several matrices representing different mutation rates serially can permit the assessment of algorithms with dynamic mutation rates and there is no reason to suggest that the structure of the LSMs could not be extended to model multiple fitness functions simultaneously. Experiments performed using nk landscapes and an experimental landscape indicates LSMs represent a promising tool in both evolutionary computation and evolutionary biology.
