The program sample trees is a Markov chain Monte Carlo sampler of gene genealogies conditional on either phased or un phased SNP genotype data. The companion program r sample trees is for pre and post-processing of sample trees files, including setting up the files for sample trees and storing and plotting the output of a sample trees run. Availability and implementation: sample trees is implemented in C þþ. The source code, documentation and test files are available at http://stat.sfu.ca/statgen/research/sampletrees.html. The R package r sample trees is available on CRAN http://cran.r-project.org/web/packages/ r sample trees index html
introduction the gene genealogy is a tree that describes the ancestral relationships among chromosomal segments sampled from individuals in a population. Knowledge of this ancestral tree has application in population genetic inference and for gene mapping (). As the true tree can not be known, the uncertainty can be handled with Markov chain Monte Carlo (MCMC) by sampling trees that are consistent with the observed data. The C  program sample trees is used to sample gene genealogies conditional on genetic data observed at present. The algorithm is based on the approach outlined in (Z l lner and). Letting s represent the genealogical tree, including branch times at a genomic location called the focal point, and G represent the SNP data, we wish to sample from the posterior distribution prs jg. This is achieved using an MCMC approach, where we sample from a distribution proportional to PR(G, s). This joint distribution is modelled by including additional latent variables representing the haplotype sequences of internal nodes of the tree, and the rates of mutation and recombination on the branches of the tree. To sample trees from the posterior distribution, at a step of the sampler, a proposal distribution that updates some components of the latent data (i.e. the mutation rate, recombination rate, internal node sequences, tree topology, or tip haplotypes) is selected and an update to the latent data is proposed. This update is either accepted or rejected according to the metropolis hastings ratio. For further statistical details on the algorithm, please see Burkett et al. (2013b) and references therein. In addition to the C  program, the R package r sample trees is available to assist users with creating the input files needed by sample trees and manipulate and display the results after sample trees has been run. We expect the two programs to be used as follows 1. With r sample trees generate the necessary input files for sample trees. 2. Run the sample trees executable at the command line, passing the name of the settings file generated in Step 1 to the program. 3. Read in and summarize the results of Step 2 in R, using
