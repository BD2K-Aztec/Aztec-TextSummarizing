Motivation: Recombined t and b cell receptor repertoires are increasingly being studied using next generation sequencing (NGS) in order to interrogate the repertoire composition as well as changes in the distribution of receptor clones under different physiological and disease states. This type of analysis requires efficient and unambiguous clo no type assignment to a large number of NGS read sequences, including the identification of the incorporated V and J gene segments and the CDR3 sequence. Current tools have deficits with respect to performance, accuracy and documentation of their underlying algorithms and usage. Results: We present im seq a method to derive clo no type repertoires from NGS data with sophisticated routines for handling errors stemming from PCR and sequencing artefacts. The application can handle different kinds of input data originating from single or paired end sequencing in different configurations and is generic regarding the species and gene of interest. We have carefully evaluated our method with simulated and real world data and show that im seq is superior to other tools with respect to its clo no typing as well as standalone error correction and runtime performance. Availability and implementation: im seq was implemented in Cþþ using the seq an library for efficient sequence analysis. It is freely available under the GPLv2 open source license and can be downloaded at www im tools org
introduction t and b cells are lymphocytes that form part of the adaptive or acquired immune system in vertebrates. These cells express an antigen receptor on their surface, the t cell receptor (TCR) or b cell receptor immunoglobulin (IG), which is responsible for the recognition of antigens. Due to the enormous number of potential antigens, a large diversity among these receptors is required. The key behind that diversity is that in the germline genome there is no functional TCR or IG gene. Instead, it is generated by recombination of germline encoded gene segments as well as random base additions and deletions upon differentiation of t and b cell precursors in the thymus and bone marrow. This somatic recombination process is referred to as vdj recombination and explained in more detail in the following section. The cells transmit their recombined receptor gene to daughter cells upon proliferation, allowing for a targeted immune response against antigens. Recently, methods have been developed to enrich these recombined genes in order to capture the repertoires of unique gene sequences using next generation sequencing (NGS). The derived data, i.e. populations of such unique gene sequences, referred to as clo no types can be used to better understand how the adaptive immune system works. The underlying samples for this analysis can be full T or B cell populations from blood, urine, biopsies or other sources or antigen specific subpopulations that have been exposed to antigen in vitro and subsequently selected for activation markers using methods such as flow cytometry. Also, specialized cells (e.g. regulatory, memory or effector T cells) can be sorted with immunophenotyping protocols. NGS based t and b cell clo no type analysis thus opens up new possibilities of qualitative and quantitative repertoire assessment. Recently, such methods were applied for TCR and IG repertoire analysis in healthy and diseased conditions. A number of data characteristics can be measured and are medically relevant, including repertoire size and diversity under different conditions or for different subpopulations as well as shared clo no types across different individuals and the tracking of particular clo no type subgroups. Applications in medical and clinical research include the identification and tracking of clo no types with known antigen specificities in vaccination studies (), differential diagnosis in transplant patients () or the usage of clo no types as biomarkers in patients with lymphoid malignancies (). Here, we present im seq a method to derive clo no types from NGS sequence data. It can recognize and correct likely sequencing or pcr errors can quickly process large datasets and was extensively tested on simulated and experimental data. We also show that it outperforms currently available software tools. im seq is open source and available online (http://www.imtools.org).

conclusion we have presented im seq a fast and flexible tool for tc rig repertoire analysis from NGS data. Our method is capable of handling SE as well as overlapping and SPE data. Apart from per read clo no typing it also features error correction methods to resolve false clo no type calls originating from PCR and sequencing errors as well as a method to correct for ambiguously assigned gene segments. The results produced by im seq were thoroughly validated using simulated data. The tools performance was compared with that of other state of the art standalone tc rig clo no type rs available, namely de combinator tcr klass mit cr and mig ecc dr blast. Our evaluations show that the clo no typing capabilities of im seq are superior to those of de combinator and mit cr while being comparable to those of mig ecc dr blast and tcr klass. However, im seq substantially outperformed the latter tools with respect to runtime. When it comes to the error correction performance, im seq could only be compared with mit cr and showed superior performance especially with regards to the precision of clo no type detection. mig ecc dr blast has additional requirements for the experimental setup, namely the incorporation of um is to be able to perform any kind of error correction. de combinator does not support error correction at all and was also excluded from the evaluation due to its poor clo no typing performance. The tcr klass error correction does not seem to include the CDR3 region and therefore does not effectively reduce the number of false clo no type calls due to errors. The evaluation of the impact of SPE sequencing showed a great improvement in V segment accuracy when compared with SE sequencing with the same overall read length. To conclude, im seq is a rapid, well tested, flexible and error aware clo no typing and repertoire generation tool that was shown to be superior to available tools with regard to clo no typing and standalone error correction capabilities.
