Motivation: A typical approach for the interpretation of high throughput experiments, such as gene expression microarrays, is to produce groups of genes based on certain criteria (e.g. genes that are differentially expressed). To gain more mechanistic insights into the underlying biology, overrepresentation analysis or a is often conducted to investigate whether gene sets associated with particular biological functions, for example, as represented by Gene Ontology (GO) annotations, are statistically overrepresented in the identified gene groups. However, the standard or a which is based on the hypergeometric test, analyzes each GO term in isolation and does not take into account the dependence structure of the go term hierarchy. Results: We have developed a Bayesian approach go bayes to measure overrepresentation of GO terms that incorporates the GO dependence structure by taking into account evidence not only from individual GO terms, but also from their related terms (i.e. parents, children, siblings, etc.). The Bayesian framework borrows information across related GO terms to strengthen the detection of overrepresentation signals. As a result, this method tends to identify sets of closely related GO terms rather than individual isolated GO terms. The advantage of the go bayes approach is demonstrated with a simulation study and an application example. Contact:

introduction in typical high throughput experiments, such as gene expression microarrays, the first step in the analysis of the results is often to produce groups of genes based on certain criteria (e.g. genes that are differentially expressed). To gain more mechanistic insights into the underlying biology, overrepresentation analysis or a is conducted to use the knowledge of the functional characteristics of the genes to investigate whether gene sets associated with particular biological functions are overrepresented in the identified gene groups. draghi ci is the first paper to discuss the overrepresentation * To whom correspondence should be addressed. problem and propose different statistical methods that can be used in this area. or a is based on the postulate that if a biological process has more identified genes than expected by chance alone, that biological process is probably linked to the experiment. One of the most popular gene description databases used in or a was developed by the Gene Ontology (GO) Consortium (). Each GO term annotates a set of genes, indicating their known molecular functions, involvement in biological processes and cellular component locations. GO terms are structured in a directed acyclic graph (DAG) of parent child relationship, where a child indicates a more specific biological classification than its parent(s). Based on the true path rule the annotation of a gene to a GO term implies automatic annotation to all the ancestors of that term. Another feature is that a GO term is allowed to have more than one parent nodes, a feature known as multiple inheritance. For example, immune response is not only a specific form of organismal movement but also a part of defense response. Furthermore, some genes might be annotated by a parent GO node but not by any of its children because less is known about that gene's specific function. For a rigorous analysis, these dependency characteristics of the GO DAG need to be considered when developing statistical methods to detect overrepresentation of GO annotations. In or a the most commonly used statistical test is based on the hypergeometric distribution or its binomial approximation (; among others). Let A denote a GO term or the set of genes annotated to A (with cardinality I A ), and let S denote the set of genes (with cardinality I S ) based on a certain criterion (i.e. differential expression) from a full gene list G (with cardinality I) in an experiment. The number of genes belonging to both S and A (S A), denoted by n A , indicates the representation of A in S. Under the null hypothesis that S and A are independent (i.e. the GO term is irrelevant to the gene cluster), n A follows a hypergeometric distribution. The p value measuring the significance of association is the tail probability of observing n A or more genes annotated by A in s gene merge func associate go tree Machine, etc.) have been developed based on the hypergeometric p value. Detailed review can be found in Khatri and draghi ci draghi ci (2005). The hypergeometric p value provides a straightforward measure of overrepresentation for each individual GO term. However, the major drawback of this approach is that it ignores the hierarchical structure in the GO DAG, which contains a substantial amount of information regarding the interactions among the GO terms. We use an artificial DAG () to illustrate this issue. It consists of 25 nodes A j ,j = 1,...,25 , each denoted by a circle. Let G = {a,b,...,z} denote the full list of genes, and 10 genes in S are marked in red. The rectangles contain the subset of genes annotated by each node, where (I A ,n A ) are listed under each rectangle includes some important features of the GO DAG, such as multiple inheritance (e.g. A 14 and A 23 have two parent nodes) and that a gene might be annotated at different specific level (eg. gene k is annotated by A 2 , but not by any of its children: A 5 , A 6 and A 7 ). Note that in this example S is overrepresented in the regions under A 2 , while underrepresented in the regions under A 3 and A 4. We report the hypergeometric p values estimated by (1) in blue. First, given I and I S , GO terms with the same (I A ,n A ) have exactly the same hypergeometric p values. For example, with (I A ,n A ) = (2,2), the p values for A 14 and A 24 are both 0.139. Based on, A 14 is more likely to be linked with S because of the stronger evidence of overrepresentation in its neighboring nodes (related biological functions). Using evidence only from individual terms, the hypergeometric p value does not differentiate between A 14 and A 24. Second, given I and I S , the hypergeometric p value has a lower limit determined by I A , which is denoted as L(I A ). Specifically, L(I A ) is achieved when n A = I A , i.e. the p value reaches its lower limit when all the genes annotated by A are in S. The smaller the I A , the larger the L(I A). For example, we have L(3) = 0.046 as in A 12 and L(2) = 0.139 as in A 14. This observation suggests that if we set the threshold for the p value at L(k), then the hypergeometric test could not identify any GO terms with I A  k. In or a detecting more specific GO terms, which usually have a relatively smaller I A , might be more desirable because they provide more detailed biological information. However, the hypergeometric test tends to identify less specific GO terms because of the constraint of L(I A ). In, the most significant term selected by the p value is A 2 , a term next to the root. The more specific terms that are associated with S (i.e. A 12 and A 14 ) are considered less significant compared with A 2. All of these issues essentially stem from the limitation of the hypergeometric test in treating the GO terms as independent entities and ignoring their interrelated structure. Recently some new methods have been proposed in or a. Lewin and propose to group closely related GO nodes together and then compute a hypergeometric p value for each group. In their approach, the graphical distance between nodes in the GO DAG is assumed to have some quantitative biological meaning calculate the overrepresentation of a GO term from leaf to root by down weighting the contribution of genes which are annotated by a child term that has been found to be significantly enriched measure the overrepresentation of each GO term relative to its parent(s). From root to leaf, their method computes the significance of overrepresentation for a GO term conditional on the representation at the parent term(s). The last Page: 907 905911

APPLICATION
