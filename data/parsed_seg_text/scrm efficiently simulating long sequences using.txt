Motivation: coalescent based simulation software for genomic sequences allows the efficient in silico generation of short and medium sized genetic sequences. However, the simulation of genome size datasets as produced by next generation sequencing is currently only possible using fairly crude approximations. Results: We present the sequential coalescent with recombination model s crm a new method that efficiently and accurately approximates the coalescent with recombination, closing the gap between current approximations and the exact model. We present an efficient implementation and show that it can simulate genomic scale datasets with an essentially correct linkage structure. Availability and implementation: The open source implementation s crm is freely available at https://scrm.github.io under the conditions of the GPLv3

introduction coalescent simulation is a valuable tool to investigate population genetic data and the demographic processes that shaped them. Simulation programs based on the coalescent with recombination (CWR) such as ms () support a wide range of evolutionary scenarios and are extremely efficient for short and medium sized sequences. As the number of recombination events grows exponentially with increasing sequence length, it is however infeasible to simulate whole chromosomes using these methods. This prevents many methods relying on simulations from being applicable to next generation sequencing datasets. In order to resolve this problem, mcve an and introduced the sequentially Markov coalescence (SMC) model, a method that approximates the CWR by partially ignoring genetic linkage between simulated sites. Subsequently, Marjoram and proposed a modification of this model, termed SMC', which improved accuracy. The simulation programs MaCS () and fast sim coal () implement SMC' and allow rapid simulation of chromosome sized datasets. however found that the decrease in genetic linkage depends on the simulated evolutionary model, which led them to conclude that SMC' might not be suitable under certain conditions, and suggested that the effect of the approximation needed to be investigated carefully in each application. We have developed a novel approximation of the CWR, called the sequential coalescent with recombination model s crm. Besides algorithmic optimization, it allows for user controlled arbitrary precision ranging continuously from SMC' to the full CWR. We here present an efficient implementation of this model, termed s crm and show that by using an intermediate approximation level it allows the simulation of sequences of arbitrary length with an essentially correct linkage structure.
