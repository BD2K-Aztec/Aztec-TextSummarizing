Motivation: likelihood based methods for placing short read sequences from meta genomic samples into reference phylogenies have been recently introduced. At present, it is unclear how to align those reads with respect to the reference alignment that was deployed to infer the reference phylogeny. Moreover, the adaptability of such alignment methods with respect to the underlying reference alignment strategies philosophies has not been explored. It has also not been assessed if the reference phylogeny can be deployed in conjunction with the reference alignment to improve alignment accuracy in this context. Results: We assess different strategies for short read alignment and propose a novel phylogeny aware alignment procedure. Our alignment method can improve the accuracy of subsequent phylogenetic placement of the reads into a reference phylogeny by up to 5.8 times compared with phylogeny agnostic methods. It can be deployed to align reads to alignments generated by using fundamentally different alignment strategies (e.g. PRANK +F versus MUSCLE). Availability: http://www.exelixis

introduction currently bioinformatics is facing two challenges: the many core revolution and the biological data avalanche that is driven by novel wet lab sequencing techniques. In a single run, these new sequencing techniques can generate between hundreds of thousands up to several millions of short DNA reads with a length ranging between 30 and 450 nt (). One important application of next generation sequencing methods is in vivo sampling of microbial communities [e.g. in the human gut () or on human hands (. For phylogenetic analysis of such meta genomic environmental samples, new likelihood based methods such as the Evolutionary Placement Algorithm (EPA) () and p placer () have recently become available. These new placement algorithms help to establish the provenance of the anonymous and diverse environmental sample of short reads by means of assigning the reads to a given fixed reference phylogeny. The reference phylogeny is a fully resolved (strictly bifurcating) * To whom correspondence should be addressed unrooted phylogenetic reference tree (RT) that is based on a fixed multiple reference alignment (RA) of the full length sequences in the RT (). Phylogenetic placement algorithms like the EPA or p placer work by inserting and removing again one short read at a time into different edges (branches) of the RT. Thereby, they strive to find the optimal score of the extended (by one tax on trees in order to individually determine the best insertion edge for each short read. The likelihood based scoring of alternative short read insertion positions in EPA and p placer is conducted under standard models of nucleotide substitution [e.g. generalized time reversible model using the model of rate heterogeneity (GTR+;. The accuracy of such a likelihood based placement of reads depend upon the multiple sequence alignment (MSA), that entails the RA and the short sequence reads [henceforth denoted as query sequences (QS)]. Therefore, a prerequisite for phylogenetic placement algorithms is, that the QS need to be aligned to the RA (), before conducting a placement run. We investigate the problem of aligning short reads to a given reference alignment and compare alignment quality of hmm align () to a new phylogeny aware short read alignment method by means of likelihood based phylogenetic QS placement accuracy. The most straightforward approach to align QS with the RA (containing full length reference sequences) is to simply compute a new MSA from scratch comprising the sequences in the RT and the QS [e.g. using MUSCLE (), maff t () or PRANK +F (. Because of the extremely large and continuously growing number of QS, this de novo alignment approach can be computationally prohibitive. Alternatively, one can keep the existing (potentially manually curated) RA fixed, and only align the QS with respect to this RA, using dedicated QS alignment methods. One such method
