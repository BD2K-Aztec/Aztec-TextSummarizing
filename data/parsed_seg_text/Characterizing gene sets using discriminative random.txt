Motivation: Analysis of co-expressed gene sets typically involves testing for enrichment of different annotations or properties such as biological processes, pathways, transcription factor binding sites, etc., one property at a time. This common approach ignores any known relationships among the properties or the genes themselves. It is believed that known biological relationships among genes and their many properties may be exploited to more accurately reveal commonalities of a gene set. Previous work has sought to achieve this by building biological networks that combine multiple types of gene gene or gene property relationships, and performing network analysis to identify other genes and properties most relevant to a given gene set. Most existing network based approaches for recognizing genes or annotations relevant to a given gene set collapse information about different properties to simplify (homogenize) the networks. Results: We present a network based method for ranking genes or properties related to a given gene set. Such related genes or properties are identified from among the nodes of a large, heterogeneous network of biological information. Our method involves a random walk with restarts, performed on an initial network with multiple node and edge types that preserve more of the original, specific property information than current methods that operate on homogeneous networks. In this first stage of our algorithm, we find the properties that are the most relevant to the given gene set and extract a subnetwork of the original network, comprising only these relevant properties. We then re rank genes by their similarity to the given gene set, based on a second random walk with restarts, performed on the above subnetwork. We demonstrate the effectiveness of this algorithm for ranking genes related to Drosophila embryonic development and aggressive responses in the brains of social animals.

introduction a common task in bioinformatics is to characterize co-expressed gene sets using enrichment methods, such as Hypergeometric tests or gene set enrichment analysis g sea (), associating the gene set with other previously annotated sets. These pre-existing gene sets may be defined from many diverse types of biological knowledge, such as shared protein domains, evolutionary origins, biological processes, etc. Public databases of curated annotations that enable this paradigm of gene set characterization are highly diverse and rapidly increasing. This work addresses the challenge of incorporating heterogeneous data from multiple public resources into the task of characterizing the shared properties of a given gene set and identifying additional genes that are important and related. One broad approach employed to perform gene set analysis with these different public resources is to represent the data as a biological network. Rather than using each data source one at a time to analyze a co-expressed gene set, sources may be integrated within a network and simultaneously leveraged to identify related genes. This idea was tested in the mouse func challenge (), where nine algorithms for integrating heterogeneous genomic evidence on mouse genes were evaluated for their ability to discover genes related to a set of co functional genes. network based algorithms have also been applied to other important bioinformatics tasks such as understanding causes of diseases and effects of therapies (;). network based analysis of gene sets in particular has been designed to extend and annotate gene functions and modules (), quantify gene set enrichment for functional molecular networks (), identify subnetworks affected in or shared across diseases (), or cluster and find signatures of cancer subtypes (). Most gene set analyses performed on a biological network encompassing heterogeneous data types lose a significant portion of the data during network construction. Frequently, the rich and diverse public datasets are converted to homogeneous gene gene networks containing only nodes representing genes of a single species and unweighted edges of a single type (). In these homogenous networks, an edge only represents a relationship between a pair of genes, but details about the different types of evidence for that relationship are lost. Algorithms that rely on these networks assume that all relationships in the network are as reliable as any other. Other algorithms rely on improved, weighted networks of gene gene interactions that estimate the confidence of each edge by integrating the strengths and types (i.e. source database or experimental assay) of the evidences for each relationship (). There are also some studies that utilize biological networks containing more than one edge or node type (). However, the networks in these studies usually have a structure specific to their system of interest, most often containing nodes of two different types and three types of edges capturing similarity within each type of node sets and the known relationships between them. Although they construct heterogeneous networks, these studies strictly rely on the structure of the problem and do not attempt to incorporate data from all possible sources. gene mania () is a popular, network based gene ranking algorithm that performed well in the mouse func evaluations. Its approach specifically integrates data from many different sources without sacrificing the edge source information. Data from each source informs the creation of its own 'affinity' network of gene gene interactions. Different affinity networks are up or down weighted based on their relevance to the original functional gene set before being combined into a single composite and homogeneous network (). While the gene mania approach works well and considers the types of sources that are most important to the ranking task, it still discards the specific details about the gene gene relationships when constructing each affinity network. For example, the edges within a Pfam protein domain affinity network indicate that a pair of genes share a protein domain sequence, but does not preserve which domain(s) it may have been. We developed the draw r ('Discriminative Random Walk with Restarts) method to rank genes for their relatedness to a given gene set, using biological networks that maintain detailed information from public data sources. Our algorithm is explicitly designed to work on heterogeneous networks with multiple node types that are able to represent a complete collection of public, genomic knowledge. We believe that draw r is the first method of its genre with this ability. We utilized the algorithm to perform the gene ranking task and simultaneously return the most relevant network features. Like many other network based algorithms that rely on guilt by association approaches (;), our algorithm implements a modified random walk with restart (RWR). However, unlike other methods, we employed two rounds of RWR: a first round of RWR on the large, noisy network of all public data, which reports the network nodes related to the given ('query') gene set, and a second stage RWR on a smaller network that includes only the query relevant nodes from the original network. We evaluated our method's ability to recover left out genes from the expression domain gene sets of Drosophila embryonic development. We showed that our gene ranking method improves when multiple data sources are combined and when data from additional species are added to the original network. We also found that the novel two round RWR approach performs better than the more common single round RWR. We finally applied the draw r algorithm to a multi-species study of intruder response in social animals () to identify subtle and shared genetic 'toolkits' that underlie aggressive behavior.

discussion we have developed the draw r method to rank genes for their relatedness to a given gene set in the context of extensive, heterogeneous information represented as a network. We showed that the rankings improve when more sources of information are incorporated into the network and when data from additional species are appended. Our algorithm applies a two stage RWR to rank related genes and, as a by product produces a list of features that are specifically related to the gene set. We have shown its application in characterizing embryonic expression domains in Drosophila and transcript omic responses to social intruders in a cross species study. With genome sequencing projects like the 10 000 Vertebrate Genomes (Genomes 10k) and 5000 Insect Genomes (i5k) underway and high throughput technologies becoming less expensive and more efficient, a biological network containing all public data would need to scale to thousands of species, covering tens of millions of genes and potentially billions of functional interactions. However, in runs with the 80 000 node, 13 million edge multi-species heterogeneous network above, representing the data required at least 4 GB of RAM and processing it took several hours using our R implementation. With these requirements, it becomes difficult to optimize the restart parameter or the number of selected features in the second stage subnetwork for each query set. Since all of our results suggest that we are able to produce the best rankings when given the largest, most diverse initial network, scalability of the algorithm is an important issue and one of the driving reasons for selecting a random walk with restart approach. One common approach to address computational scalability is the paradigm of data and computation distribution offered by map reduce (). The reliability and efficiency of this framework has led to its widespread adoption, and public instances (e.g. the Amazon Elastic Compute Cloud) provide a platform for users to store large networks and deploy analysis tools on them. A message passing version of the RWR algorithm maps easily to a map reduce framework. It has been implemented in the graph mining software PEGASUS () has been shown to scale to graphs with billions of nodes and edges. More recent software, B_LIN (), pre gel (), graph lab () and graph x (), are explicitly designed to improve performance in scalable graph processing by carefully distributing data and minimizing communication costs there are several limitations to the random walk based approach. First, we are only able to represent positive information. Edges are only able to convey how closely related two nodes are and nodes are only allowed to be annotated as belonging to the given gene set. However, proper use of negative information may perhaps create a more nuanced network and produce better outcomes. For example, we may want to add edges that represent mutual exclusivity or strong anti correlation between two nodes in the network. We may also have negative examples of a property of interest that we would like to incorporate to make rankings more accurate. Many of these properties may be addressed by remapping our random walk on a connectivity network algorithm into an application of belief propagation on probabilistic graphical models (). Additionally, although we normalize our edges by type, the RWR does specifically treat different types of edges in a distinguishable way. Some studies have attempted to control how information is passed through different edge types by defining specific meta paths () that dictate a sequence of node types that must be followed to inform a relationship between two nodes. Our simple, two stage RWR algorithm for gene ranking provides a solution to and highlights the challenges of performing analysis of experimental data on massive, heterogeneous networks of biological knowledge.
