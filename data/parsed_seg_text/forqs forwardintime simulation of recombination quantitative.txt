for qs is a forward in time simulation of recombination, quantitative traits and selection. It was designed to investigate haplo-type patterns resulting from scenarios where substantial evolutionary change has taken place in a small number of generations due to recombination and or selection on polygenic quantitative traits. Availability and implementation: for qs is implemented as a command line Cþþ program. Source code and binary executables for Linux, OSX and Windows are freely available under a permissive BSD license: https://bitbucket.org/dkessner/forqs.

introduction simulations have a long history in population genetics, both for verifying analytical results and for exploring population models that are mathematically intractable. Population genetics simulations can be broadly classified as forward in time (e.g. wright fisher or backward in time (e.g. coalescent). Coalescent simulations [e.g. ms (), MaCS (), fast sim coal ()] are efficient for simulating neutral sequence data because they only need to track lineages that are ancestral to the sample. Although it is possible to simulate certain selection scenarios within the coalescent framework (), one must turn to forward in time simulations to model selection in a flexible way. Many forward in time simulators are currently available. Most of these simulators use a mutation centric approach, implemented by storing the mutations carried by individuals in an array. To handle selection, the majority of these simulators assign selection coefficients to individual mutations [e.g. for w sim (), fre gene (), genome pop (Carvajal), sfs code (), trees i mj (O'), SLiM (, although a few also include support for quantitative traits [e.g. for sim (), quanti nemo (), simu pop (.are recent reviews providing a comprehensive comparison of these and other simulators. In many scenarios of biological interest, substantial evolutionary change has taken place in a small number of generations due to recombination and or selection on standing variation, rather than mutational input. For example, one may be interested in the genome wide haplotype patterns that emerge from admixture between historically isolated populations () or from artificial selection on a quantitative trait. Studying these haplotype patterns can be difficult with existing forward in time simulators because detailed information about the mosaic haplotype structure of individuals is not readily available, and must be inferred from the output sequences of the simulation and or stored recombination event data. In addition, forward in time simulators that store entire sequences incur a severe trade-off between the size of the genomic regions and the size of the populations simulated. Motivated by such examples, we have implemented a new forward in time simulation approach that, instead of tracking single site variants, tracks individual haplotype chunks as they recombine over multiple generations. Further, we have designed the simulator for fast simulation of quantitative traits under selection. We have labeled this software for qs forward in time simulation of Recombination, Quantitative Traits and Selection). Similar approaches have been implemented recently by and by for the simple selection models with per-mutation fitness effects. The haplotype based design allows for fast simulation of whole genomes, with efficient memory usage. For example, for qs can easily simulate two populations (size 10 000 each) selected for different optimal trait values, where individuals have human sized genomes (23 chromosome pairs, 100 Mb each), taking 2 s generation. For comparison, existing forward simulators are limited by the amount of sequence that can be stored in arrays in memory: for the aforementioned 20 000 individuals, 16 GB of memory would permit the storage of only 3.2 million base pairs of sequence per individual, which is an order of magnitude smaller than the smallest human chromosome. The for qs design also preserves information about the haplotype structure of individuals, which allows for immediate identification of genomic regions where individuals share identical by descent haplotype tracts. Our simulator uses a modular architecture to allow the user to flexibly specify recombination maps, mutation rates, demographic models, quantitative traits and fitness functions. This modular approach facilitates simulation of complicated scenarios and investigation of the resulting haplotype patterns. for qs is currently under active development to support ongoing projects. *To whom correspondence should be addressed.  The Author 2013. Published by Oxford University Press. This is an Open Access article distributed under the terms of the Creative Commons Attribution License (http://creativecommons.org/licenses/by/3.0/), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.
