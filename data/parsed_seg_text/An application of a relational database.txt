high accuracy mass values detected by high resolution mass spectrometry analysis enable prediction of elemental compositions , and thus are used for metabolite annotations in meta bolo mic studies. Here, we report an application of a relational database to significantly improve the rate of elemental composition predictions. By searching a database of pre-calculated elemental compositions with fixed kinds and numbers of atoms, the approach eliminates redundant evaluations of the same formula that occur in repeated calculations with other tools. When our approach is compared with HR2, which is one of the fastest tools available, our database search times were at least 109 times shorter than those of HR2. When a solid state drive (SSD) was applied, the search time was 488 times shorter at 5 ppm mass tolerance and 1833 times at 0.1 ppm. Even if the search by HR2 was performed with 8 threads in a high spec Windows 7 PC, the database search times were at least 26 and 115 times shorter without and with the SSD. These improvements were enhanced in a low spec Windows XP PC. We constructed a web service mf searcher to query the database in a RESTful manner. Availability and implementation: Available for free at http://webs2. kazusa or jp mf searcher. The web service is implemented in Java, MySQL, Apache and Tomcat, with all major browsers supported.

introduction identification or annotation of metabolite peaks detected by mass spectrometers (MSs) is one of the crucial steps in ms based meta bolo mic studies (). Accurate mass values measured by high resolution MS instruments, such as orbit rap MS and time of flight MS, are used in calculations of elemental compositions for the peaks and or the product ions generated in multistage MS (MS n ) analyses (), by which comprehensive identifications annotations of metabolites have been reported (). Several software tools are available for calculation of elemental compositions: HR2 (), auto mf calculator (), mass to formula function of the Chemistry Development Kit () and Molecular Weight Calculator (http://www.alchemistmatt.com/). These tools generate all possible formulae under the condition of user defined kinds and numbers of atoms (hereafter described as 'atom condition') and return elemental compositions that match the given mass value with the mass tolerance. An advantage of these tools is that users can change the atom conditions for each calculation. A disadvantage is that generations and evaluations of the same formulae can not be avoided when similar mass values are repeatedly examined. This latent redundancy causes a limitation of the calculation rate when the tools are applied for the large number of mass data detected in meta bolo mic studies. To raise the throughput of metabolite annotations and then meta bolo mic data productions, acceleration of the calculation rate of elemental compositions is required. We report here a database approach that remarkably improves the prediction of elemental compositions. Because the atom condition can be fixed for high throughput surveys, all possible elemental compositions under the atom conditions are calculated and stored in a relational database system. The elemental compositions that match the given mass values with the mass tolerances are searched from the database. Therefore, the latent redundancy occurring in other tools is eliminated.
