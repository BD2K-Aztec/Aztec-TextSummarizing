Motivation: We present a new feature of the maff t multiple alignment program for suppressing over alignment (aligning unrelated segments). Conventional maff t is highly sensitive in aligning conserved regions in remote homologs, but the risk of over alignment is recently becoming greater, as low quality or noisy sequences are increasing in protein sequence databases, due, for example, to sequencing errors and difficulty in gene prediction. Results: The proposed method utilizes a variable scoring matrix for different pairs of sequences (or groups) in a single multiple sequence alignment, based on the global similarity of each pair. This method significantly increases the correctly gapped sites in real examples and in simulations under various conditions. Regarding sensitivity, the effect of the proposed method is slightly negative in real protein based benchmarks, and mostly neutral in simulation based benchmarks. This approach is based on natural biological reasoning and should be compatible with many methods based on dynamic programming for multiple sequence alignment. Availability and implementation: The new feature is available in maff t versions 7.263 and higher.

introduction many comparative analyses of biological sequences utilize multiple sequence alignment (MSA), and the quality of an MSA can affect the results of downstream analyses. Therefore, even incremental improvements in MSA quality can have wide ranging effects. One area in MSA technology that can potentially be improved is robustness against noise in sequence data. As a result of large scale sequencing projects, we now have access to many amino acid and nucleotide sequences from widely divergent organisms. Unfortunately, the quality of the sequences is not always high, partly due to limitations in sequencing technologies. Moreover, at the amino acid sequence level, a number of errors can be introduced due to difficulty in gene prediction (). With incorrect reading frames, unrelated amino acid segments can appear in a set of homologous sequences. Even if such errors could be completely excluded, splice variants of a gene can be included in an MSA of a Eukaryotic gene family. Another source of difficulty is when small structural domains are surrounded by intrinsically disordered or low complexity regions (). Thus, the existence of unrelated segments, or noise, in an MSA is common, especially in large scale analyses of amino acid sequences, for which human inspection is difficult. Therefore robustness in such situations is an important feature for any MSA method used for large scale analysis most MSA methods assume that the input sequences are all homologous. When the input sequences have unrelated segments, these segments often end up being aligned. This results in over alignment i.e. sites that are aligned but are, in fact, non-homologous (). Some MSA methods, including PRANK and bali phy are aware of this problem (). However, these methods are not ranked highly in standard benchmarks based on protein structural alignments (). This is not surprising because the standard criterion is essentially based on sensitivity, a consequence of which is that the over alignment problem is not taken into account. Methods such as PRANK and bali phy usually utilize simulated input to test alignment accuracy. simulation based benchmarks generally have a limitation in that the simulation setting is inevitably oversimplified and the applicability to real world situations is unclear. On the other hand, the use of real data is problematic, when considering over alignment due to the arbitrariness of reference alignments (). More specifically, structural alignments can only provide information about sites that are structurally conserved, not sites that are unrelated. In simulation based benchmarks that take into consideration over alignment PRANK and bali phy consistently outperform other methods (L oy ty noja and). Thus there is a discrepancy between benchmarks based on real data and simulated data. To assess the over alignment problem, both types of benchmarks are necessary. Here, we describe a simple method to control over alignment directly and flexibly in a protein MSA. In brief, the proposed method utilizes agreement between the local segments and the entire sequence to determine which residues should be aligned; if there is a dissimilar segment in a globally highly similar pair of sequences, the dissimilar segment is gapped. This is accomplished by using a variable scoring matrix (VSM) that adapts to the global similarity between a pair of sequences (or groups) within an MSA given a single additional parameter that controls the risk of over alignment. This is not a novel idea since it is based on a combination of two techniques known for more than 20 years: (i) adjusting the overall average of a scoring matrix () by rescaling the matrix according to the similarity of the pair of sequences or groups to be aligned and (ii) use of different scoring matrices in an MSA, as originally proposed in ClustalW (), but probably not inherited by Clustal Omega (). We have implemented the VSM technique in the maff t program (), which is one of the most sensitive methods in terms of standard criteria ().
