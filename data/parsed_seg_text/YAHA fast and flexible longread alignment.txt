Motivation: With improved short read assembly algorithms and the recent development of long read sequencers, split mapping will soon be the preferred method for structural variant (SV) detection. Yet, current alignment tools are not well suited for this. Results: We present yah a a fast and flexible hash based aligner. yah a is as fast and accurate as b was w at finding the single best alignment per query and is dramatically faster and more sensitive than both SSAHA2 and mega blast at finding all possible alignments. Unlike other aligners that report all, or one, alignment per query, or that use simple heuristics to select alignments, yah a uses a directed acyclic graph to find the optimal set of alignments that cover a query using a biologically relevant breakpoint penalty. yah a can also report multiple mappings per defined segment of the query. We show that yah a detects more breakpoints in less time than b was w across all SV classes, and especially excels at complex SVs comprising multiple breakpoints. Availability: yah a is currently supported on 64-bit Linux systems. Binaries and sample data are freely available for download from

introduction structural variation (SV) is a major source of diversity in germline and cancer genomes, but is difficult to map relative to other forms of variation. Since 2008, most sequence based studies of SV have used paired end mapping (PEM), which relies upon clustering of discordant paired end reads that map to either side of an SV breakpoint. Now, with the rapid improvement of short read assembly algorithms and the development of third generation long read sequencing technologies, split read or split contig mapping (we refer to both as SRM) will soon be the preferred method. SRM is significantly more precise and less error prone than PEM. Yet, current read mappers are not well designed for aligning breakpoint containing query sequences. Here, we present yah a a flexible hash based aligner that is explicitly designed for optimal SV breakpoint detection from long query sequences. To accurately determine SV breakpoints using SRM, an aligner must do four things well. First, it must accurately determine the best set of alignments that cover the length of the query; the 'Optimal Coverage Set' (OCS). This is best accomplished by using an algorithm that provides provably optimal results given some objective function. Our use of a best path algorithm on a directed acyclic graph (DAG) of alignments does just that. The objective function is specifically tuned to finding SV events by taking into account the length and quality of alignments, the number of alignments in the OCS and the genomic distance between those alignments. Second, it must be able to report alignments similar to those in the OCS in order to allow for the use of combinatorial breakpoint detection algorithms that cluster multiple mappings per read (). ya has use of an optimal DAG algorithm for discovery of the OCS and its ability to find collections of alignments similar to the OCS are completely novel. Third, it must be able to generate a large number of viable alignments to feed the above two algorithms. long read aligners such as b was w () and AGILE () severely restrict the number of alignments under consideration early in query processing. While this improves speed, it reduces the likelihood of finding the OCS and precludes finding alignments similar to them. yah a can produce the required large number of alignments. Optionally, the user can choose to output all of them. Other aligners such as mega blast () and SSAHA2 () can also produce numerous alignments, but have no notion of an OCS. Fourth, the aligner must be able to run in a reasonable amount of time. yah a uses a unique combination of heuristics and optimizations to accomplish this. We use a hashing scheme similar to s saha but with a considerably faster approach for sorting hash table seeds. We use banded Smith Waterman (SW) and a modified version of mega blasts x drop off heuristic for extensions. Finally, we calculate the OCS without unduly impacting performance by using a time and space optimized DAG algorithm. yah a is the only aligner that does all four of these things well, and therefore is uniquely well suited to SV breakpoint detection. In addition, it is important to score alignments using a metric that is capable of accommodating a wide range of error profiles in order to perform well on queries from diverse sources, including existing () and future () long read sequencing technologies. To accomplish this, yah a utilizes Affine Gap Scoring (AGS) with user specified cost reward parameters. In the next section, we explain ya has algorithms in more detail. In Section 3, we show the efficacy of these algorithms in three comparison tests. First, we compare yah a with *To whom correspondence should be addressed.  The Author(s) 2012. Published by Oxford University Press. This is an Open Access article distributed under the terms of the Creative Commons Attribution License (http://creativecommons.org/licenses/by/3.0), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited mega blast and SSAHA2 in their capacity to generate a large number of accurate alignments in a reasonable amount of CPU time. Second, we compare yah a with b was w in their ability to find the single best alignment over a range of read lengths and error rates. Third, we compare yah a with b was w in their ability to accurately identify SV breakpoints over a range of SV event categories.

conclusion we have shown that yah a is a fast and effective all purpose aligner that outperforms best in class tools for very three different tasks: (i) reporting all mappings per query; (ii) reporting the single best mapping and (iii) identifying split mappings that define one or more SV breakpoints within a query. ya has main strength as a general alignment tool is that it simply. Shown are graphs of the percentage of queries with which each aligner correctly verified an SV breakpoint for various types of SV events versus the amount of CPU time consumed. Note the large improvement with the inclusion of ya has secondary alignments in the Alu dataset. Also note the marked improvement for both b was w and yah a in the CGR dataset with 4% error rate by changing the AGS parameters to lower the penalty for indels relative to replacements. Still, yah a outperforms b was w with both sets of AGS parameters. Graphs C and D are shown with the same axes to ease comparison.
