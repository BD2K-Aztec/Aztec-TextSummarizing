Motivation: Computation of steady state flux solutions in large metabolic models is routinely performed using Flux Balance Analysis based on a simple LP formulation. A minimal requirement for thermodynamic feasibility of the flux solution is the absence of internal loops, which are enforced using loop less constraints. The resulting loop less flux problem is a substantially harder MILP problem, which is computationally expensive for large metabolic models. Results: We developed a pre-processing algorithm that significantly reduces the size of the original loop less problem into an easier and equivalent MILP problem. The pre-processing step employs a fast matrix spar sification algorithm – fast snp – inspired by recent results on Sparse Null-space Pursuit (SNP). By finding a reduced feasible loop law matrix subject to known directional ities fast snp considerably improves the computational efficiency in several metabolic models running different loop less optimization problems. Furthermore, analysis of the topology encoded in the reduced loop matrix enabled identification of key directional constraints for the potential permanent elimination of infeasible loops in the underlying model. Overall, fast snp is an effective and simple algorithm for efficient formulation of loop law constraints, making loop less flux optimization feasible and numerically tractable at large scale. Availability: Source code for MATLAB including examples are freely available for download at

introduction constrained based methods are the most popular methods for exploring the capabilities of genome scale metabolic models (GEMs) (). GEMs have been reconstructed for many model organisms (), enabling comprehensive study of the genotype phenotype relationship, cellular physiology, metabolic capabilities, among others (). More recently, these reconstructions have included larger and more complex networks, describing different cellular interactions (), microbial communities (), and multi tissue organisms (). The increased complexity of current metabolic models demands efficient constrained based methods to compute possible network states, especially thermodynamically feasible ones. Computation of thermodynamically feasible states is computationally hard (), severely limiting its application to large scale models. Efficient computational methods are thus needed to interrogate the consequences of thermodynamic feasibility on these models.

discussion computation of loop less steady state flux solutions is an np hard MILP problem (). Recent approaches such as fast tf va () and cycle free flux () have exploited particular features of the problem and used LP formulations following alternative approaches to solve different loop less flux optimization problems. Although these approaches enabled fast computation of feasible fluxes (acceleration up to two orders of magnitude), they rely on post-processing methods for blocking unfeasible cycles after steady state flux computation. In the current study, we developed a preprocessing strategy where the conventional MILP problem is reformulated using a minimal set of loop law constraints, enabling efficient computation of loop less flux solutions as well as topological analysis of infeasible cycles in large metabolic models. All modern MILP solvers use preprocessing to recast MILP formulations into easier to solve yet equivalent representations (). It is often possible to develop superior preprocessing strategies using insights into the specific MILP problem. We have developed a fast preprocessing algorithm, fast snp which finds a minimal set of feasible loop laws taking into consideration the directional ities of the model. Once the reduced loop law matrix is found, a smaller loop less MILP problem can be formulated and solved efficiently. Speedups up to 50fold were achieved with preprocessing across diverse types of loop less flux optimization problems (Tables 2+3, Figs. 2-4). Although the computational improvement of fast snp is more modest than previous approaches (Supplementary Tables S2-S3), it is the only strategy capable of efficiently solving loop less related problems (i.e., ll fba llf va LD and LR) using a single optimization problem based on suitable LP, MILP or mi qp formulations subject to the loop less constraints (Eq. 5). Importantly, such constraints have recently been algebraically proven to always yield thermodynamically feasible flux solutions (Noor, et al., 2012 finally we highlight additional and distinctive features of fast snp for the analysis of metabolic models. As shown in the previous section, this approach enables a priori assessment of model complexity in the 'loop law sense', as it explicitly computes a minimal basis describing all the potentially infeasible cycles in the studied model. Formally, these loop laws represent elementary flux modes that do not exchange mass with the surroundings (). These internal cycles have previously been studied in the context of oriented matroid theory () and more recently, infeasible cycles have been enumerated in GEMs using sampling approaches (). However, efficient assessment of the impact of directionality constraints as well as topological analysis of these loop laws for their potential removal, has been lacking in the literature. fast snp aids comprehensive assessment, unravelling simple strategies for removing infeasible loops based on thermodynamic or practical considerations (see). Additionally, we note that the proposed matrix spar sification algorithm in fast snp can also be employed for other useful analyses. For example, this algorithm can readily be modified to explore alternative solutions by incorporating suitable additional constraints (e.g., vi  z * ) using an appropriate objective (e.g., l1-norm minimization). The resulting greedy algorithm would generate a set of linearly independent solutions or pathways (i.e., a basis) consistent with the previous constraints by solving only LP problems. This avoids the need of computing expensive MILP formulations. In conclusion, fast snp complements existing methods in the constrained based modelling toolbox for exploration and topological analysis of infeasible cycles and metabolic pathways.
