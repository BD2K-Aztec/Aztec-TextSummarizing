Motivation: Structural variation is common in human and cancer gen-omes. high throughput DNA sequencing has enabled genome scale surveys of structural variation. However, the short reads produced by these technologies limit the study of complex variants, particularly those involving repetitive regions. Recent third generation sequen-cing technologies provide single molecule templates and longer sequencing reads, but at the cost of higher per nucleotide error rates. Results: We present multi breaks v an algorithm to detect structural variants (SVs) from single molecule sequencing data, paired read sequencing data, or a combination of sequencing data from different platforms. We demonstrate that combining low coverage third generation data from Pacific Biosciences pac bio with high coverage paired read data is advantageous on simulated chromosomes. We apply multi breaks v to pac bio data from four human fos mids and show that it detects known SVs with high sensitivity and specificity. Finally, we perform a whole genome analysis on pac bio data from a complete hydatidiform mole cell line and predict 1002 high probability SVs, over half of which are confirmed by an illumina based assembly. Availability and implementation: multi breaks v is available at

introduction structural variation including duplications, deletions, insertions and translocations of genomic segments are an important source of variation in human and cancer genomes. Human genomes differ by thousands of inherited structural variants (SVs) (), many of which have been associated with genetic disorders and diseases (). SVs have long been recognized as a form of somatic mutations that drive the development and progression of cancer (). The continuing decline in sequencing costs for next generation DNA sequencing has made it the standard technique for structural variation detection, largely replacing microarrays and earlier cytogenetic techniques (). Most structural variation studies conducted on highly repetitive mammalian genomes use a resequencing approach, where reads from an individual genome are independently aligned to a reference genome. Discrepancies between the expected and observed alignments or the number of aligned reads suggest potential SVs in the individual genome compared with the reference. Identifying SVs from short read paired end sequencing data is complicated by a number of factors, including sequencing and alignment errors, as well as repetitive sequences near SV boundaries (). To handle these obstacles, most methods detect structural variation by clustering fragments and assigning a higher confidence or score to the cluster if many fragments support the variant. Early approaches for paired end data simplified the issue of repeats by either ignoring fragments that align to multiple locations in the reference or choosing a single 'best' alignment, breaking ties arbitrarily (). Methods that incorporate ambiguous alignments for paired reads improved SV detection (); however, these methods report a single set of predictions that usually involves minimizing the total number of SVs. More recently, gas vpro () demonstrated the effectiveness of a probabilistic model that considers many possible read mappings and incorporates both a paired end and a read depth signal to refine variant predictions. Additionally, some tools have the capacity to analyze split reads correctly mapping the read subsequences for reads spanning breakpoint junctions usually in the context of deletions or transcript omic data (). Despite these improvements, existing methods are inherently limited by the underlying sequencing technology; i.e. they often rely on explicit assumptions about fragment length, error rate, and the number of SVs that fragments imply. Emerging single molecule sequencing technologies coined third generation technologies from companies such as Pacific Biosciences pac bio and Oxford nano pore are capable of sequencing longer fragments than current sequencing technologies. For example, pac bios Single Molecule Real Time (SMRT) sequencing generates reads greater than 7 kb on average, with some reads exceeding 40Kb (). The benefits of longer reads come at a cost; per base error rates of such technologies are higher than next generation sequencing technologies ($15% for pac bio. While Oxford nano pore has not yet launched a commercial machine, early indications are that error rates will be higher than the 12% rates of current short read technologies. The properties of third generation technologies provide unique opportunities and challenges for SV detection. A single read may span multiple SVs in the sequenced genome, generalizing the concept of split reads. Thus, standard assumptions of observing a single breakpoint from a single read must be relaxed as SVs are no longer independent from one another. Additionally, protocols such as strobe sequencing which produced multiply linked reads from a single fragment of DNA (), generalize the concept of paired end sequencing. Both long reads and multiply linked reads provide increased power to detect complex rearrangements with multiple nearby SVs. However, higher error rates create ambiguity in assessing an optimal alignment, making it necessary to consider a large set of possible alignments. Accounting for both higher error rates and multiple SVs leads to more subtle algorithmic concerns. Previous work on SV prediction from single molecule sequencing data (in the context of strobe sequencing data) formulated an optimization problem that aimed to minimize the number of predicted SVs (). While strobes showed increased specificity in SV predictions compared to paired end sequencing, the method suffered from a large false positive rate and was never tested on real sequencing data. We propose a new algorithm, multi breaks v which directly addresses the challenges of high error rates and multiple SVs reported by a single read. Rather than trying to find a single solution and assignment for the data, multi breaks v employs a probabilistic approach that considers all possible solutions. multi breaks v is capable of predicting variants from paired end sequencing data, third generation data, and data from a combination of sequencing platforms. We benchmark multi breaks v on simulated, highly repetitive chromosomes using long read sequencing, strobe sequencing, paired end sequencing and a mixture of strobe and paired end data. We then demonstrate the accuracy of multi breaks v on pac bio strobe sequencing data from four fos mids containing known SVs. Finally, we perform a genome wide analysis on pac bio long read data to predict SVs from a cell line derived from a complete hydatidiform mole.

discussion as long read technologies become more practical for large scale genome sequencing, there is a clear need for methods that take advantage of these reads while allowing for the higher single nucleotide error rates in current long read technologies. In addition, methods that integrate these datasets with existing short read data are also a priority. multi breaks v helps address this need using a probabilistic model that considers many possible alternative alignments for each read. multi breaks v additionally provides a natural framework for identifying SVs across multiple platforms. We have benchmarked multi breaks v on multiple types of simulated sequencing data and compared it to other state of the art variant detection algorithms designed for paired read and multi read data. We have put forth a pipeline for identifying multi breakpoint mappings from long reads, enabling novel adjacency prediction from long read data. Here, we have shown that multi breaks v not only outperforms current approaches using data from a single platform, but also enables hybrid approaches that combine data from multiple sequencing platforms. We applied multi breaks v to whole genome sequencing data from CHM1TERT, a human cell line derived from a complete hydatidiform mole, which a target for a high quality 'platinum' genome assembly (). While probabilistic approaches such as multi breaks v are powerful, they are more time consuming than the parsimony based methods we compare to (). We have demonstrated that parallel processing of the data makes multi breaks v feasible the CHM1TERT analysis. To evaluate our resulting predictions, we compare them to novel adjacencies found in an illumina based CHM1TERT assembly. We acknowledge that this assembly may be incorrect and incomplete, thus we do not treat it as a gold standard. Identifying a subset of the high probability novel adjacencies that may be used to augment the existing assembly remains future work. Finally, since CHM1TERT is haploid, we suspect that it is considerably easier to identify variants since there should be no heterozygous events. It will be important to evaluate multi breaks v on pac bio long read data generated from a diploid human genome when the data becomes available. One of the challenges in single molecule sequencing technologies is dealing with a higher per nucleotide error rate. By considering many possible alignments for each read and constructing a model which incorporates the error rate, as well as the expected support for an adjacency, we are able to take advantage of the length of the read while mitigating false positives due to high error rates. This trade-off appears to be inherent to single molecule technologies. Upcoming technologies, such as Oxford nano pore have suggested they can achieve read lengths greater than 10 kb with per base costs similar to short read technologies (), and read lengths from pac bio continue to increase while maintaining similar error profiles. Detecting multiple breakpoints from the same DNA fragment is not a strategy limited to single molecule sequencing platforms. Recent advances, such as long fragment read (LFR) technology, allow short read sequencing platforms to mimic long reads (). The infini pair technique holds the potential of obtaining multiple linked short reads from a single sequence fragment by inducing an electrical field over Illumina flow cells (). These advances in short read platforms further motivate the need for designing algorithms for fragments with more than two sequenced reads multi reads with 42). Sensitive alignment procedures to find ambiguous alignments from long reads and multi reads are important for discovering high quality predictions. Many structural variation methods propose tiered alignment strategies to find ambiguous alignments (); however we found that these strategies drastically increased the total number of ambiguous alignments to consider effectively " drowning out " the signal from true variants (Supplementary Section 2.3). Ultimately, more sensitive alignment pipelines will improve SV prediction from multi breakpoint reads. The HMM for identifying breakpoints within completely spanning blas r alignments is one step towards this goal. Complex SVs with multiple, co-located breakpoints have been observed in both normal and cancer genomes (). Given the complexity of structural variation observed in humans, the ability to detect multiple breakpoints on a single read is becoming increasingly critical. In 23% of all cancer genomes (and up to 25% in some cancers) specific chromosomal regions are seen to be greatly enriched for nearby rearrangements via a process known as chromo thrips is (). As researchers delve into increasingly complex regions of the genome (with multiple co-located rearrangements and or dense repeat structure), probabilistic methods that can assign confidence to each call, while integrating orthogonal sequencing platforms, will become a necessity. Our method, multi breaks v provides a generalized framework for such approaches.
