Motivation: meta genomics characterizes microbial communities by random shotgun sequencing of DNA isolated directly from an environment of interest. An essential step in computational meta genome analysis is taxonomic sequence assignment, which allows identifying the sequenced community members and reconstructing taxonomic bins with sequence data for the individual tax a. For the massive datasets generated by next generation sequencing technologies, this can not be performed with de novo phylogenetic inference methods. We describe an algorithm and the accompanying software, taxa to rtk which performs taxonomic sequence assignment by fast approximate determination of evolutionary neighbors from sequence similarities. Results: taxa to rtk was precise in its taxonomic assignment across all ranks and tax a for a range of evolutionary distances and for short as well as for long sequences. In addition to the taxonomic binning of meta genomes it is well suited for profiling microbial communities from meta genome samples because it identifies bacterial, archaeal and eukaryotic community members without being affected by varying primer binding strengths, as in marker gene amplification, or copy number variations of marker genes across different tax a. taxa to rtk has an efficient, parallelized implementation that allows the assignment of 6 Gb of sequence data per day on a standard multi-processor system with 10 CPU cores and microbial RefSeq as the genomic reference data. Availability and implementation: taxa to rtk source and binary program files are publicly available at

introduction meta genomics allows us to study microbial communities from natural environments without the need to obtain pure cultures of the individual member species (). The shotgun sequencing of microbial community DNA with current techniques generates reads that range from less than 100 to several thousand nucleotides (Dr ge and). By computational analyses of meta genome sequence samples, we can estimate the abundances of different tax a for the sampled communities, known as taxonomic profiling, characterize their functional and metabolic potential based on the predicted proteins and resolve the contributions of individual tax a to the latter by reconstructing 'bins' of unassembled or assembled sequences that originate from the same tax on
discussion taxa to rtk is a taxonomic assignment software package which generates very precise taxonomic assignments with few errors for meta genome shotgun sequences. To provide a fair comparison, we invested extensive effort into ensuring that we evaluated all methods under identical conditions with the same reference sequences, test datasets and background taxonomies, using their recommended settings. We evaluated taxa to rtk on 16S gene sequences, on simulated short reads, with simulated assembled contigs and with 2 kb contig fragments from a real cow rumen meta genome. For each simulated sample, we evaluated a wide range of evolutionary distances between the query and reference sequences using leave one taxon out cross validation. taxa to rtk was the most precise of all tested methods with the most realistic number of identified tax a overall. This property was very pronounced for lower taxonomic ranks from species to family level. However, taxa to rtk assigned fewer data overall than other methods from species to family. For the small assembled simm c dataset, it assigned fewer data, particularly in comparison to the composition based classifier phylo pythias when 100 kb of data were provided for individual community members to train species level models. For the real cow rumen dataset, taxa to rtk was the most consistent in terms of classifying multiple pieces of one contig. Our results consistently indicate that tax at or tks strength is its high precision of assignments, which allows us to confidently assign a core of sample sequences and thereby to infer the taxonomic composition of the community. In comparison to assignments based on marker genes, it has the advantages that it makes assignments across all domains of life and that corresponding abundance estimates from shotgun sequences are less affected by copy number variations of individual genes. Such shotgun estimates are also unaffected by PCR primer amplification biases, unlike marker gene sequencing techniques, and do not require high quality reference gene phylogenies for marker genes. We confirmed this by in depth analysis of six 15 Gb shotgun samples from the barley rhizosphere, where we applied taxa to rtk to characterize the taxonomic composition of bacteria, archaea and eukaryotes, which correlated with results from 16S rRNA profiling and showed the most notable deviations for tax a known to be affected by primer biases or having multiple copies of the 16S rRNA gene bulgar elli et al., unpublished data). To target draft genome reconstructions, the data assigned to individual taxonomic bins by taxa to rtk can be used as training data for complementary approaches, such as composition based methods, or as independent information in combination with recently proposed clustering methods using the abundance of genes or contigs across multiple samples. From a methodological point of view, we have introduced a method for the fast approximation of the evolutionary neighborhood of a query sequence with a run-time that increases linearly with the number of homologs. In de novo phylogenetic inference methods, the run-time increases at least log linearly with the number of homologs or they rely on time consuming optimizations of parameter rich phylogenetic models, which generates excessive computational requirements for the analysis of gb sized NGS samples. Our software provides an easy to use and scalable alternative to taxonomic classification of marker genes that is applicable to any nucleotide fragment. Unlike other similarity based taxonomic classifiers for shotgun data, our algorithm handles different degrees of sequence conservation without preset or user specified parameters such as alignment scores (overall or per gene family) and without being restricted to the analysis of a number of high quality homologs with a minimal length. At the same time, the inferred evolutionary neighborhood is extended by the identification of an out group leading to more precise taxonomic assignments, while regions without detectable taxonomic signal are instantly discarded. We post process independent taxonomic assignments of query segments to infer an assignment for the entire query and do this using a majority vote algorithm with a few robust default parameters. This computationally lightweight step can be quickly repeated with other values for the majority and minimum support parameters, if required. In addition to the algorithmic considerations and other run-time optimizations, we implemented query sequence segmentation and program parallelization, which allow large scale data analysis with a taxa to rtk throughput of several Gbs per day on a standard multiprocessor system. The program's scope is also not limited to the taxonomic assignment of meta genomes It can be applied to any DNA or RNA sequence. For instance, another successful in house application is the detection of contaminations in isolate sequencing data. Furthermore, the program tax at or within taxa to rtk provides taxonomic information for individual query segments (Supplementary Figs S2 and S25), which could be used to identify assembly errors or regions acquired by lateral gene transfer.
