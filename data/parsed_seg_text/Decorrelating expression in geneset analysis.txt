Motivation: Group-wise pattern analysis of genes, known as gene set analysis (GSA), addresses the differential expression pattern of biologically pre-defined gene sets. GSA exhibits high statistical power and has revealed many novel biological processes associated with specific phenotypes. In most cases, however, GSA relies on the invalid assumption that the members of each gene set are sampled independently, which increases false predictions. Results: We propose an algorithm, termed DECO, to remove (or alleviate) the bias caused by the correlation of the expression data in GSAs. This is accomplished through the eigenvalue decomposition of covariance matrixes and a series of linear transformations of data. In particular, moderate de-correlation methods that truncate or re-scale eigenvalues were proposed for a more reliable analysis. Tests of simulated and real experimental data show that DECO effectively corrects the correlation structure of gene expression and improves the prediction accuracy (specificity and sensitivity) for both gene and sample randomizing GSA methods.

introduction the basic goal of high throughput gene expression profiling is to identify genes or groups of genes that are responsible for a phenotype of interest and elucidate their functional networks. Typical individual gene analyses () employ a cut off threshold to define differentially expressed genes (DEGs) and then search for the biologically predefined gene sets that are enriched with the DEGs. However, the use of a threshold value causes a significant loss of information and is far from sufficient for describing the functionality of genes and their modular expression patterns. On the other hand, the gene set analysis (GSA) methods assess the group-wise pattern of each pre-defined gene set by integrating the signals of all of its members, either strong or weak, without applying a cut off threshold to genes (). Such a group-wise approach of GSA covers a much larger spectrum of expression patterns and hence exhibits higher statistical power than an individual gene analysis: many genes with relatively weak signals as well as small number of genes with strong signals in a gene set could be significant. Moreover, predictions by GSA are highly reproducible among data sets from independent experiments. Due to such advantages, GSA is becoming a powerful alternative to individual gene analysis. According to, GSA methods can be classified into two categories depending on the null hypothesis tested as follows 1 Q1: The genes in a gene set have the same level of association with the phenotype compared with the rest of the gene set(2) Q2: None of the genes in a gene set is associated with the phenotype of interest these two categories can be characterized by how the significance of each gene set is assessed. After summarizing the signals in a gene set (gene set score), the significance of the summary statistic is assessed by randomizing gene labels (Q1) or sample labels (Q2), respectively. As the methods in the Q2 category hypothesize that no gene in a gene set is associated with the phenotype, they test the 'existence' of association signal in a gene set. For this reason, they can be termed association analyses. On the other hand, Q1 methods test the relative 'enrichment' of such association signal compared with the background genes; hence, they can be termed enrichment analyses. There are also hybrid type methods that take into account both the gene and sample randomization of the gene set scores (). The main problem with most of the q1 based GSA methods is that each gene set is assumed to be a collection of independent samples (from the entire list of genes). Because most biologically defined gene sets have some correlation structures in their expression profiles, this assumption mostly boosts some of the gene set scores and increases false positive predictions (). The recently developed re standardization method () is basically built on sample randomization, but induces the independence of gene statistics by incorporating the gene randomized gene set scores suggested a simple method that adjusts for the different gene set sizes, which still maintains the independence of genes in the random set model. In this article, an algorithm dubbed DECO is proposed that removes the correlation bias in the expression of each gene set in GSA. The method is based on the eigenvalue decomposition of the covariance matrix of each gene set and a series of linear transformations of data. This approach adjusts for the gene set specific correlation structures to improve the power of many gene or sample randomizing GSA methods. eigenvalue decomposition of covariance matrix has been widely applied to gene expression data analyses through principal component analysis pc a and its generalization, singular value decomposition (SVD) (). pc a and SVD are standard dimension reduction techniques and are mostly used for capturing global expression patterns of genes or arrays. Recently, pc a was combined with L 1 penalty to reduce noise effectively in identifying differentially expressed genes (). We present how to remove the correlation bias in GSA by rescaling the principal components of each gene set along the eigen axes. Because the accurate estimation of the covariance matrix of each gene set is critical in this method, we suggested using the shrinkage covariance estimator () instead of the unstable sample covariance. We might also consider. De-correlation process for gene set expression data Y and covariance matrix C. Let C = UDU 1 be the eigen decomposition of C; each step then represents (a) normalized correlated data, (b) rotating the data to the eigen axes (c) shrinking the data to a unit ball and (d) returning the data to the original axes. that there may still be errors in estimating covariance matrixes especially for large gene sets, and that decor relating itself does not transform data into independent samples except for multivariate normal distributions. For these reasons, we suggest applying some moderate de correlations for analyzing real experimental data to avoid overfitting. DECO is tested for two simulated data sets with different null hypotheses as well as two real expression data sets. The findings demonstrate that DECO overall improves the prediction of key pathways for both the gene and sample randomizing GSA methods.

discussion in this article, we devised an algorithm to remove (or reduce) the correlations in a gene set which perturb the inference of GSA considerably. By removing the correlations, we can transform the data into nearly independent samples. As uncorrelated ness does not necessarily imply the independence of samples, and the estimation of covariance matrices can be inaccurate, we recommended using a conservative de-correlation deco sqrt for real expression data to avoid overfitting. Indeed, in the real data analyses, deco sqrt showed favorable performances over dec ot as well as the uncorrected method. When we applied the original DECO to real expression data sets, it showed a rather unstable performance: its ROC for the prostate data was a little better than the curve for dec ot but was even worse than the uncorrected method for the p53 data. This instability may be caused by the inaccurate estimation of small eigenvalues. Ideally, it would be desirable to remove correlations of the full list of genes at once rather than decor relating individual gene sets, because correlations exist not only within pre-defined gene sets but among genes across different gene sets. However, it is mostly inaccurate and infeasible to estimate and decompose such a high dimensional covariance matrix. In this regard, DECO serves as a practical solution for the correlation issue by locally decor relating each gene set. In DECO, reducing the estimation error for the covariance matrix of a gene set was crucial. The use of the well known sample covariance yielded poor predictions in the analyses of real data sets. Therefore, the use of a shrinkage covariance estimator () is essential when applying DECO to GSA. For the same reason, DECO may perform better for over dozens of data samples. Note that in simulation tests, all the 100 gene sets had relatively strong correlations between 0.3 and 0.8. However, in real expression data, only a portion of gene sets have such strong correlations. This may be a reason why the de-correlation effect was clearer in simulation tests. A possible weakness with de-correlation analysis is that the members of decor related gene sets are the linearly transformed genes, which makes it hard to interpret the individual genes' behavior. However, gene sets, the basic analysis units of GSA remain the same and interpretation of gene sets is not interrupted by decorrelation. One may also apply the individual gene analysis on top of the GSA results to complement the analysis. The correlation bias is a commonly recognized problem in gene set analysis. Correlation in a gene set is known to increase the number of false positive predictions for the gene randomizing GSA methods; but we also found in this study that correlations can reduce the power of a sample randomizing GSA method. DECO provides an intuitive and effective solution to these problems.
