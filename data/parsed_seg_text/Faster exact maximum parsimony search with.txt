Motivation: Despite trends towards maximum likelihood and Bayesian criteria, maximum parsimony (MP) remains an important criterion for evaluating phylogenetic trees. Because exact MP search is np complete the computational effort needed to find provably optimal trees skyrockets with increasing numbers of tax a limiting analyses to around 25â€“30 tax a. This is, in part, because currently available programs fail to take advantage of parallelism. Results: We present XMP, a new program for finding exact MP trees that comes in both serial and parallel versions. The serial version is faster in nearly all tests than existing software. The parallel version uses a work stealing algorithm to scale to hundreds of CPUs on a distributed memory multiprocessor with high efficiency. An optimized SSE2 inner loop provides additional speed up for Pentium 4 and later CPUs. Availability: C source code and several binary versions are freely available from http://www.massey.ac.nz/ wt white xmp. The parallel version requires an MPI implementation, such as the freely available MPICH2.

introduction of all the criterion based approaches to evolutionary tree selection, the maximum parsimony (MP) criterion is the most intuitive: 'Select the tree or trees that require the fewest DNA substitutions'. The early popularity of MP was dampened by the discovery that it can be statistically inconsistent: in the 'Felsenstein Zone', increasing amounts of data will lead to increasingly certain recovery of the wrong tree (). Later, more general conditions leading to inconsistency were described (see schul meister 2004 for an extensive review). Elucidation of the assumptions made by MP led to the understanding that it is consistent when the expected number of changes per site, both across the tree and on any edge, are sufficiently small (, pp. 97102 chart the many variants of ML and their connections to MP. Of particular relevance is that MP is a most parsimonious likelihood estimator for 'ample' datasets in which all tax a can be connected by a tree with maximum edge length 1, which is of practical significance when dealing with population * To whom correspondence should be addressed intraspecies data where tax a are highly similar (). An often overlooked fact is that the primary criticism levelled at mp lack of statistical consistency in the general case can be rectified through Hadamard conjugation (). In particular, the Kimura three parameter model () and all its submodels can be corrected for directly using Hadamard conjugation, while any reversible model at all for which additive distances can be estimated can be dealt with via the Distance Hadamard transformation (). The resulting two step approach, called corrected parsimony, is statistically consistent. Although powerful heuristics for the MP problem have been developed (e.g.), they necessarily come without guarantees. We believe that a freely available, high performance implementation of exact MP search is conspicuously absent, and would benefit the phylogenetics community. Our program, XMP, fills this gap. XMP offers: @BULLET a parallelization strategy that is simultaneously highly portable across different computer architectures and highly efficient, scaling to hundreds of processors. This is the main new contribution; @BULLET a new lower bounding approach for pruning unpromising regions of the search space, inspired by the MinMax Squeeze (); @BULLET streamlined Fitch inner loop calculations using optimizations not published elsewhere; and @BULLET a hand optimized SSE2 assembly language implementation of the Fitch inner loop for Intel Pentium 4 and later CPUs, offering a potential 4-fold speed improvement the latter three improvements are also available in a single processor version. We compare this version with a popular exact MP program and find that XMP is much faster in almost every case.
