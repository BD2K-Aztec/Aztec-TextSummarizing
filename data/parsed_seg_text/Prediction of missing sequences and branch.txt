Motivation: The presence of missing data in large scale phylo genomic datasets has negative effects on the phylogenetic inference process. One effect that is caused by alignments with missing per gene or per partition sequences is that the inferred phylogenies may exhibit extremely long branch lengths. We investigate if statistically predicting missing sequences for organisms by using information from genes partitions that have data for these organisms alleviates the problem and improves phylogenetic accuracy. Results: We present several algorithms for correcting excessively long branch lengths induced by missing data. We also present methods for predicting imputing missing sequence data. We evaluate our algorithms by systematically removing sequence data from three empirical and 100 simulated alignments. We then compare the Maximum Likelihood trees inferred from the gap py alignments and on the alignments with predicted sequence data to the trees inferred from the original, complete datasets. The datasets with predicted sequences showed one to two orders of magnitude more accurate branch lengths compared to the branch lengths of the trees inferred from the alignments with missing data. However, prediction did not affect the RF distances between the trees. Availability and implementation: https://github.com/ddarriba/ForeSeqs

introduction at present, typical large scale phylo genomic datasets are assembled by concatenating several genes of the organisms under study. Such phylo genomic datasets often contain a high proportion of systematically missing data. This is because, specific gene sequences might not be available for certain tax a (e.g. PCR amplification failed for these genes, or tax a do not contain the specific gene). Such phylo genomic datasets are also called 'patchy' or gap py alignments. In likelihood based models, the missing per gene sequences are typically represented by undetermined characters. Throughout this manuscript, we refer to user defined subsets of alignment sites (e.g. genes) as 'partitions'. We further assume that all relevant likelihood model parameters (GTR rates, a, branch lengths) are estimated/ optimized independently (also known as unlinked parameters) for each partition. The presence of missing data has two notable effects on the phylogenetic inference process. First, depending on the structure of the missing data blocks and under certain model parameter configurations (most importantly unlinked branch lengths), gap py datasets can give rise to so called terraces in tree space (V C The Author 2016. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals permission soup com 2011). A terrace in tree space contains a set of distinct tree topologies that have exactly the same likelihood score. Second, entirely missing data for a subset of tax a in a partition can generate extremely long branch lengths. This effect is more pronounced when data is systematically (instead of randomly throughout the tree) missing for an entire subtree. Here, we address the latter problem. That is, we introduce and evaluate methods for correcting these artificially long branches, given a partitioned alignment and a fixed tree (e.g. the best scoring Maximum Likelihood tree). We present, assess, and make available two algorithms for this purpose: branch length stealing and sequence prediction imputation. Since there is no data available for inferring branch lengths in a subtree that only comprises missing data for a specific partition, we first need to estimate or approximate these branch lengths. We can do this by using information present in other partitions that have data for the specific subtree. We call this process branch length stealing (). Once we have stolen the branch lengths for a missing data subtree in a partition, we deploy a stochastic approach to map mutations to branches. Thereby, we can predict the missing sequence data by using the phylogenetic likelihood model as a predictive/ generating process based on marginal ancestral probability vectors map v (). Note that given an ancestral sequence a act cg and a simple jukes cantor model of nucleotide substitution (), a descendant sequence att ccg has exactly the same distance to the ancestral sequence as tact aa. Since sequence imputation is a randomized stochastic procedure, the simulation should ideally be carried out several times to obtain a sufficiently large sample of possible outcomes. We can determine the stability of the prediction and also detect potential outliers by comparing the trees inferred from the different predicted replicates to each other.

conclusion we presented a method and a tool for predicting missing data in partitioned datasets. We described two procedures for approximating (stealing) the branch lengths of bi partitions with missing data. Using empirical and synthetic datasets we designed realistic test scenarios to evaluate our methods. The stealing and prediction methods yield significant improvements in branch length accuracy of ML trees compared to trees inferred from MSAs with missing data. The BS differences calculated between the trees inferred from the predicted alignments and the reference trees were one to two orders of magnitude smaller than for the trees inferred from the alignments with missing data. We find that branch stealing contributes by far the most to improving branch length estimates. By example of the PTP species delimitation tool, we demonstrate that branch stealing can substantially improve the accuracy of a phylogenetic post analysis. Sequence prediction can be omitted when one only needs to correct branch lengths for missing data. As we show, sequence prediction can be useful for estimating statistical properties of the missing sequences, such as, for instance, their GC content. Overall, for small fractions of missing data predictions using map vs yielded slightly better results than predictions based on discrete ancestral sequences. Nevertheless, predictions based on discrete ancestral sequences outperformed the map v based strategy in most of our tests. Finally, we observed that predicting sequences is generally difficult for alignments that contain a high amount of 'true' alignment gaps that are treated as missing data in all standard likelihood implementations. While we observed an improvement in BS differences when using prediction compared to alignments with missing data, the average and the variance of the BS increased proportionally to the amount of 'true' alignment gaps in the reference alignments. Also note that prediction can not correct incorrect topologies that have been inferred from alignments with missing data. However, despite the fact that previous studies have suggested that missing data can strongly bias phylogenetic inferences (), there is an ongoing debate regarding the topological impact of missing data concluded for instance, that missing data might not be an issue for correctly placing tax a with incomplete data into a given reference tree.
