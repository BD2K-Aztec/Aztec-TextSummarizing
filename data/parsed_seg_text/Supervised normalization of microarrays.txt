Motivation: A major challenge in utilizing microarray technologies to measure nucleic acid abundances is normalization, the goal of which is to separate biologically meaningful signal from other confounding sources of signal, often due to unavoidable technical factors. It is intuitively clear that true biological signal and confounding factors need to be simultaneously considered when performing normalization. However, the most popular normalization approaches do not utilize what is known about the study, both in terms of the biological variables of interest and the known technical factors in the study, such as batch or array processing date. Results: We show here that failing to include all study specific biological and technical variables when performing normalization leads to biased downstream analyses. We propose a general normalization framework that fits a study specific model employing every known variable that is relevant to the expression study. The proposed method is generally applicable to the full range of existing probe designs, as well as to both single channel and dual channel arrays. We show through real and simulated examples that the method has favorable operating characteristics in comparison to some of the most highly used normalization methods. Availability: An R package called snm implementing the methodology will be made available from Bioconductor (http:// bioconductor org
introduction the microarray technology measures nucleic acid abundances, such as from mRNA, in biological samples by producing fluorescence intensities that reflect hybridization events between nucleotide sequences. Attached to the microarray are single stranded DNA probes, which represent a short segment of complementary DNA within a gene. Differences among current microarray technologies are typically in terms of probe design and the number of fluorescent dyes applied to any given array. Regardless of the technology, statistical analysis of these data usually attempts to * To whom correspondence should be addressed. infer the relationship between nucleic acid abundance variation and biological phenotype. One of the main challenges of this inference process is normalization, which addresses the fact that factors not of biological relevance can influence the observed intensities (), complicating approaches used to infer relationships from these data (). The major contribution of this paper is to provide a general 'supervised' framework for microarray normalization (). This approach is applicable to all major microarray technologies and performs the normalization in a manner supervised by all known variables relevant to the study. Some of the most highly used microarray normalization methods are what we call 'unsupervised' methods. These are normalization procedures that do not utilize the variables describing the study, specifically the biological variables of interest (). For example, suppose the goal of a microarray study is to identify genes differentially expressed with respect to an experimental treatment. Also, suppose that the arrays were processed in two separate batches. Unsupervised methods ignore the treatment and batch variables when performing the normalization. However, if the goal of normalization is to separate biologically meaningful signal from technical confounders, then it seems infeasible to do so without taking into account the signal explained by the study specific variables, such as treatment and batch in this example. While unsupervised methods may show favorable operating characteristics in specialized settings such as when biological variables contribute relatively negligible signal to the data it has been shown they make assumptions about data that are commonly invalidated in practice (). As a simple motivating example meant to illustrate how easily these assumptions are violated, we simulated microarray data (extensive details are given in following sections) with signal due to a dichotomous biological variable and intensity dependent array effects. We simulated 100 000 probes, 30% of which are differentially expressed shows the p value histograms corresponding to probes, which are not differentially expressed is the method we propose in this work, where the p values are correctly uniform 01 and E show the p values from the same probes when using invariant set normalization (ISN;) and quantile normalization (QN;), respectively. It can be seen that both sets of p values are anti conservatively biased of the main ideas behind supervised normalization of microarrays. (A) A hypothetical example to demonstrate the differences between supervised and unsupervised normalization strategies. The three boxes arranged across the top display different types of potential effects. Each of these potentially influences the unnormalized observed intensities, which are presented as densities in the middle panel. The blue and red lines describe the different biological conditions, while the dashed and dotted lines describe the different dates. The differences among the four arise either from the biology or study design. After normalization with a supervised approach that takes all three effects into account when normalizing the data, the differences between the blue and red lines are still present, while the differences between the dashed and dotted lines have been removed. However, for unsupervised approaches, such as quantile normalization, the resulting data have been transformed so that all arrays have the same distribution, a result that clearly violates the biological relationship of interest. (B) An example of the model we fit to the probe level data from a microarray study. The model has probe specific terms, intensity dependent terms and may include other terms such as probe composition effects or surface level spatial effects.

discussion in this article, we described a framework for the normalization of microarray data. The central premise of this work is that the study under investigation should inform the normalization process. The framework is intended to be general enough to address most microarray studies, regardless of platform or biological goal. The examples we explored were selected as they are commonly occurring in practice and clearly describe the effects on inference of ignoring relevant information from an analysis. We note that the study specific models utilized in this paper will not satisfy all studies. Rather, we view this work as a general supervised normalization framework based on a well defined goal, namely to remove the effects of adjustment variables without biasing inference, and the examples as a means to illustrate the benefit of this approach. A researcher would utilize this framework to build a study specific model and then apply the proposed algorithm, which is quite general. The results presented in this paper demonstrate some of the problems associated with unsupervised normalization methods. For example, the simulations show how such approaches can introduce signal in the presence of asymmetric biological variation. Similarly, the simulations and vascular development example make clear that unsupervised approaches ignore effects of study design on expression data. Finally, these approaches make the assumption that few genes are differentially expressed, an assumption that is clearly false in many settings. These and other limitations of unsupervised methods are the motivation for this work. The framework is designed to handle a variety of study designs. We presented a modeling strategy that is designed to model relevant study specific variables (e.g. probe specific biological effects, probe specific technical effects and intensity dependent effects). The flexibility of our modeling strategy is demonstrated by the fact that it straightforwardly derives previously described supervised normalization models for more specialized experimental designs and technologies (). Another benefit is that other terms Page: 1315 13081315
