Motivation: RNA sequencing rnase q is a powerful new technology for mapping and quantifying transcriptome s using ultra high throughput next generation sequencing technologies. Using deep sequencing, gene expression levels of all transcripts including novel ones can be quantified digitally. Although extremely promising, the massive amounts of data generated by rnase q substantial biases and uncertainty in short read alignment pose challenges for data analysis. In particular, large base specific variation and between base dependence make simple approaches, such as those that use averaging to normalize rnase q data and quantify gene expressions, ineffective. Results: In this study, we propose a Poisson mixed effects (POME) model to characterize base level read coverage within each transcript. The underlying expression level is included as a key parameter in this model. Since the proposed model is capable of incorporating base specific variation as well as between base dependence that affect read coverage profile throughout the transcript, it can lead to improved quantification of the true underlying expression level. Availability and implementation: POME can be freely downloaded at

introduction the transcriptome is the complete set of transcripts in a cell under any given developmental stage or physiological condition. Comprehensively cataloging all the components in the transcriptome is a grand challenge in the post genome era. In the past decade, microarray technology has played a prominent role in advancing our understanding of transcriptome complexity by allowing scientists to simultaneously monitor the expression of almost all the genes in the genome (). Despite its overwhelming success, microarray technology has its limitations. For example, designing probes on the chip requires knowledge of * To whom correspondence should be addressed. the genome sequence and annotation; hence, novel transcripts will be missed. Additionally, cross hybridization background signal and saturation result in a reduction of microarray's dynamic range and accuracy. A recently developed sequencing based technology for measuring gene expression, termed rnase q has the potential to overcome these limitations (). The ultra high throughput next generation sequencing technologies capable of producing millions of sequence reads dramatically increase the throughput in DNA sequencing compared with conventional Sanger technology and at a much lower cost. An array of studies has been published that successfully apply these new sequencing technologies to measure mRNA expression levels in cells from various species (). Since illumina s platforms have been widely adopted in rnase q experiments, we focused on short read rnase q data generated from the Illumina platform in this study. In rnase q experiments using the aforementioned sequencing technologies, RNA molecules are first converted to a library of cDNA fragments with adaptors attached to both ends. Each molecule, often after amplification, is then sequenced using one of the next generation sequencing technologies. Following sequencing, the resulting reads are aligned to known transcripts or de novo assembled together to produce a genome scale transcriptional profile. A fundamental question in rnase q data analysis is to derive expression level from raw sequencing output data. This is the basis of almost all further investigation such as detecting differentially expressed genes, alternative splicing events, etc. Sophisticated and tailor made data analysis methods are needed to fully realize the power of the new sequencing technologies. A natural idea is to use the total number of reads mapped inside each transcript, or region of interest (ROI), to represent the expression level proposed to use the number of reads per kilobase of a transcript per million mapped reads rp km as the transcript's expression level. The rp km method is easy to implement and takes into consideration the transcript length and the total number of uniquely mapped reads. However, the rp km method is oversimplified, as it ignores the variability of read coverage within an ROI demonstrated by real rnase q data. more page 64 6368

discussion in microarray data analysis, it is now widely accepted that estimates of the expression levels based on parametric models such as the model based expression index m be i () are more accurate in reflecting the underlying expression levels than summary statistics of raw intensity values. Inspired by the success of model based methods in microarray data analysis, in this study, we strived to develop a model based method for analyzing rnase q data. When exploring the properties of base level sequencing depth in rnase q data, we found substantial variation in sequencing depth within most transcripts, especially for those that are highly expressed. We also found that a large proportion of transcripts 25 shows over dispersion in base level sequencing depth (Supplementary), which is consistent with what has been reported in the literature (). Additionally, we found that base level sequencing depth displays substantial dependence between base pairs that are close to each other. This type of dependence resembles spatial correlation between neighboring areas considered in spatial statistics research (), and to the best of our knowledge, has not yet been reported in the literature on rnase q data analysis. Based on these observations, we believe that spatial models that can incorporate correlations such as POME have advantages over existing models in characterizing base level rnase q data. In this study, we used POME to estimate the expression level of an individual transcript. Two types of random effects are introduced to characterize two types of variation in read counts, which are between adjacent base pairs (i.e. spatial correlation) and specific to each base pair (i.e. non spatial variation), respectively. Analyses of both simulated and real rnase q data demonstrate that the expression indices estimated by POME reflect the underlying expression levels more accurately compared with existing methods. We believe that the improvement of estimation accuracy of POME comes from modeling the dependence between the read counts of base pairs adjacent to each other. The POME model can also be used for differential gene expression analysis by incorporating biological or experimental conditions or other covariates. We will pursue research in these directions in the future. POME model assumes over dispersion in the observed count data which is the case for a large proportion of transcripts in rnase q data, especially those highly expressed. For this reason, we focused on highly expressed transcripts in this study. From our experience, about one quarter of all transcripts belong to this category. For these transcripts, our analysis on simulated as well as real data demonstrated that POME offers more accurate expression measure than other methods that we compared. We have also performed small scale tests on transcripts with medium level expression, and found POME again outperforms rp km m seq and gps eq methods (data not shown). For lowly expressed transcripts, we do not recommend to use POME for inference because observed data may be under dispersed. Like many other model based methods, the POME method is more computationally intensive than read enumeration methods. For a 100 bp transcript without replicate, it takes 23 s for POME to complete 10 000 MCMC iterations on a Dell PowerEdge 1950 computing node (2.83 GHz CPU processors and 8 GB RAM). The computation time increases almost linearly with the length of transcripts. However, since model fitting of individual transcript is independent of each other and thus can be performed simultaneously, the computational intensity of the POME method can be much mitigated by parallel computing. The power of modern cluster computers will also help in this regard. After all, we believe that accuracy in statistical inference outweighs computation cost as long as the latter is affordable. Although we only applied the POME method to rnase q data obtained from the Illumina platform in this study, we believe it can also be applied to rnase q data collected from other sequencing platforms such as SOLiD with little or no modification, because these data possess similar data structures.
