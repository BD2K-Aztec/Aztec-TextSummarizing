Motivation: Aligning RNAs is useful to search for homologous genes, study evolutionary relationships, detect conserved regions and identify any patterns that may be of biological relevance. Poor levels of conservation among homologs, however, make it difficult to compare RNA sequences, even when considering closely evolutionary related sequences. Results: We describe sara coffee a tertiary structure based multiple RNA aligner, which has been validated using bra lid arts a new benchmark framework designed for evaluating tertiary structureâ€“ based multiple RNA aligners. We provide two methods to measure the capacity of alignments to match corresponding secondary and tertiary structure features. On this benchmark, sara coffee outper-forms both regular aligners and those using secondary structure information. Furthermore, we show that on sequences in which 560% of the nucleotides form base pairs, primary sequence methods usually perform better than secondary structure aware aligners. Availability and implementation: The package and the datasets are available from http://www.tcoffee.org/Projects/saracoffee and http://

introduction recent reports of a large number of previously unknown RNA genes () have prompted a renewed interest in the field of non-coding RNA analysis. This shows well in the growing number of scientific reports uncovering a rapidly expanding range of new functions, and it now appears that non-coding RNAs are involved in most parts of the cell machinery, including X inactivation, genome integrity maintenance piwi interacting RNA (, transcript knockdown and cell differentiation [miRNA ()] as well as nuclear trafficking nr on (, among others. From a functional standpoint, the main consequence of high throughput sequencing has certainly been the discovery of a large number of long non-coding RNAs ln crnas simultaneously identified as un-reported non-coding ENCODE transcripts () and as conserved genomic regions with active promoter chromatin signatures (). The exact function of this new class remains a matter of debate, although mounting bodies of evidence suggest their involvement in gene regulation, either through trans-() or cis acting () mechanisms. Other reports are also suggesting the potential usage of ln crnas as biomarkers (). In humans only, the latest ENCODE catalog lists 417 000 l ncrna genes, and probably more have to come as a wider range of tissues get deep sequenced. It remains a matter of debate whether these ln crnas have evolutionary conserved secondary structure. A difficulty when looking for such structures is the fast evolutionary pace of these molecules, a property that makes it hard to produce structurally informative sequence alignments. This limitation is rather serious, as our capacity to make sense of so much new information will significantly depend on our ability to build accurate homology based models (). In the present work, we borrow some concepts developed for protein sequence comparison and show that RNA structural information can be used to derive more informative multiple sequence alignment (MSA) models. This approach amounts to defining a perfect RNA alignment as the one maximizing the matching of structurally equivalent elements. Such accurate alignments are critical for various modeling applications, including evolutionary reconstruction, database search using improved context free stochastic grammar model and fine grain structural modeling of novel family members. We show that even a small amount of three dimensional (3D) or two dimensional (2D) experimental structure can help improve these models. Alignment methods rely on the notion that key features are usually preserved by evolution through purifying selection. Multiple comparison models can therefore reveal functional *To whom correspondence should be addressed. y The authors wish it to be known that, in their opinion, the first two authors should be regarded as joint First Authors. elements that would otherwise be difficult to identify on a single sequence. This is especially true for structured RNA molecules where compensated mutations are frequent signatures for evolutionarily maintained stem loops. This strategy has been extensively used for the successful elucidation of ribosomal RNA secondary structures (). Unfortunately, producing alignments accurate enough to be used for secondary structure prediction is a challenging task, especially when dealing with distantly related sequences. Two main obstacles exist that prevent the computation of informative homology based models. First of all, RNA sequences are composed of a four letter alphabet, with no higher order meta alphabet (like proteins' amino acid code) that would help powering statistical analysis. As a consequence, structure similarity becomes hard to infer when sequences have 560% identity (). Second, for many RNAs, sequence evolution is mostly constrained by the maintenance of secondary structure elements stabilized through a combination of canonical and non-canonical base pairings. Under such constraints, it has been shown that sequences can evolve rapidly while exploring so called neutral networks (). The combination of a small alphabet with rapid evolution makes it difficult to use standard alignment tools like Basic Local Alignment Search tool based approaches (). To address these limitations, one can tap into the evolutionary signal contained in di-nucleotides that results from the co-evolution of adjacent bases. This approach has been recently shown to be effective enough for the improvement of database search accuracy (). Unfortunately, the signal thus uncovered is modest and unlikely to result in significantly improved alignments. A more suitable solution involves the simultaneous estimation of sequence and structural conservation using Sankoff algorithm (). As effective as it may be in theory, this approach is hampered by prohibitive memory and CPU requirements, a limitation that has prompted the development of a large number of faster approximate heuristics for the inclusion of secondary structure information when aligning RNA. Some of the most popular tools include r coffee (), loca rna () and cons an (). cons an combines expectation maximization with a sophisticated banded dynamic programming strategy, which results in a heuristic approximation of Sankoff algorithm. The cons an algorithm that only aligns two sequences at a time can easily be combined with a consistency based multiple sequence aligner like t coffee () or r coffee () to assemble highly accurate RNA MSAs. consistency based aligners () rely on the compilation of an exhaustive library of all against all pairwise alignments. This library is extended to derive a position specific scoring scheme, used to compute a standard progressive alignment. The main strength of multiple aligners like t coffee is to allow any third party pairwise aligner to be used for the library generation. This property was previously used to generate structure based protein alignments (O') by combining structural pairwise aligners like SAP (). We show here how this approach, originally developed for proteins, can easily be extended to RNA sequence alignments, provided suitable pairwise tools are used to build the pairwise library. structure based RNA alignment algorithms include SARA (), DIAL (), ARTS (), LaJolla (), R3D Align () and sars a (). These tools belong to a recently described class of aligners that make use of experimentally derived 3D structures. In this study, we chose the SARA structural aligner that estimates series of unit vectors between consecutive C3 0 atoms (shown by the authors to be the most suitable for this task) and aligns them using dynamic programming, to minimize the root mean square deviation between superimposed atoms. As a stand-alone pairwise structural aligner, SARA is directly usable within the t coffee framework, and we describe in this article, a framework suitable for validating the effectiveness of combining these two tools for the generation of 3D structure based RNA MSAs. The benchmarking of an RNA 3D structure based method like sara coffee is not an easy task. First of all, one needs reference datasets of sequences with known 3D structures. When it comes to benchmarking RNA alignments, br ali base () is usually referred to as the reference collection of choice. However, it can not be used in the context of this work, as 57.2% of the sequences that make up the datasets match a known 3D structure (!95% identity), thus making it an impractical reference dataset for the benchmark of tertiary structure aligners. This limitation prompted us to assemble bra lid arts a new reference dataset that only contains DARTS clusters () of structurally homologous sequences, further filtered for their suitability (see Section 2). The second issue relates to the nature of the reference. Our goal being the evaluation of a structural aligner, any reliance on a structure based reference alignment would have turned our approach into the de facto comparison of two alternative structural alignment strategies (ours and the one used for the reference). We therefore decided to do an alignment free assessment of our method by evaluating sara coffees ability to match structurally equivalent features such as pairs of paired residues, or internal structural distances. This comparison of internal structures was carried out by adapting the ni rmsd (), a method designed to estimate the structural accuracy of protein MSAs (see Section 2), to use distances between the C3 0 atoms of the aligned RNA sequences. sara coffee is heavily dependent on available RNA 3D structure, an information source only available in small quantities. For instance, the latest PDB release () contains 54100 chains longer than eight nucleotides (a minimum for the SARA algorithm), with a mere 2325 mapping onto the 6 million or so sequences in rf am. This shortage severely restricts the scope of a method like sara coffee and we therefore decided to broaden the scope of this work by going beyond a mere pure structure based validation. We also tried to estimate the usefulness of 3D structural information when computing MSAs so as to provide the community with guidelines on how these data may be used as efficiently as possible, and also to determine when these data are critically needed. We were especially interested in determining the usefulness of 3D data when doing 2D modeling. This question is relevant in a context where it may soon be relatively easy to use next generation sequencing to do massive secondary structure estimation at minimal cost (), even though the reliability of such techniques remains to be established.
