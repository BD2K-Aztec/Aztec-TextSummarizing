Motivation: The estimation of species phylogenies requires multiple loci, since different loci can have different trees due to incomplete lineage sorting, modeled by the multi-species coalescent model. We recently developed a coalescent based method, ASTRAL, which is statistically consistent under the multi-species coalescent model and which is more accurate than other coalescent based methods on the datasets we examined. ASTRAL runs in polynomial time, by constraining the search space using a set of allowed bi partitions. Despite the limitation to allowed bi partitions ASTRAL is statistically consistent. Results: We present a new version of ASTRAL, which we call astral ii. We show that astral ii has substantial advantages over ASTRAL: it is faster, can analyze much larger datasets (up to 1000 species and 1000 genes) and has substantially better accuracy under some conditions. astral s running time is Oðn 2 kj x j 2 Þ, and astral iis running time is on kj x j 2 Þ, where n is the number of species, k is the number of loci and X is the set of allowed bi partitions for the search space. Availability and implementation: astral ii is available in open source at https

introduction the estimation of species trees is complicated by the fact that different parts of the genome have different evolutionary histories; therefore, the different 'gene trees' obtained on different loci are often in conflict with each other and with the true species tree. Gene tree discord due to incomplete lineage sorting (ILS) is a major challenge to species tree estimation () and is a particular problem for rapid radiations (where several speciation events occur in a relatively short amount of time). Because of the possibility of gene tree conflict, species tree estimations are increasingly based on multiple loci. One approach to estimating the species tree simply concatenates the sequence alignments for the different loci together and estimates a tree on the concatenated alignment. However, concatenation based analyses can be statistically inconsistent under the multi-species coalescent () and can result in incorrect trees with high support (). Because of this potential for concatenation analyses to produce incorrect species trees, many methods have been developed that are designed to address gene tree incongruence due to ILS. Some of these methods have been proven statistically consistent under the multi-species coalescent (), which means that they will return the true species tree with high probability, given a large enough number of true gene trees. Some of these coalescent based methods [e.g. m pest by and nj st by] are now in widespread use. Despite the availability of coalescent based methods, many biological datasets are too large for the available methods; for example, m pest can not be used on large datasets due to computational reasons (). Other coalescent based methods are even more limited; for example, *BEAST (), a method that co estimates gene trees and the species tree, can not be used with more than about 25 species (). Computational challenges in real dataset analyses have required the development of coalescent based methods that could analyze larger V C The Author 2015. Published by Oxford University Press.
