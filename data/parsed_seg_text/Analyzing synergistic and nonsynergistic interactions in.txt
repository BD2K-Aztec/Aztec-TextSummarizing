Motivation: Understanding the structure and interplay of cellular signalling pathways is one of the great challenges in molecular biology. Boolean Networks can infer signalling networks from observations of protein activation. In situations where it is difficult to assess protein activation directly, Nested Effect Models are an alternative. They derive the network structure indirectly from downstream effects of pathway perturbations. To date, Nested Effect Models can not resolve signalling details like the formation of signalling complexes or the activation of proteins by multiple alternative input signals. Here we introduce Boolean Nested Effect Models b nem. b nems combine the use of downstream effects with the higher resolution of signalling pathway structures in Boolean Networks. Results: We show that b nems accurately reconstruct signal flows in simulated data. Using b nem we then resolve BCR signalling via PI3K and TAK1 kinases in BL2 lymphoma cell lines.

introduction cells process input signals to output signals using a network of cellular signalling pathways. For example, a small molecule binds a membrane receptor. The signal is brought into the cell via structural modification of the receptor. A set of kinases and other signalling molecules propagate the signal through the cytosol. This involves both activation and repression of proteins. Often complexes of multiple proteins must form before a signal propagates. Some of the molecules are also part of different pathways linking multiple pathways together. Eventually, the signal enters the nucleus where transcription factors and chromatin remodelling enzymes become activated. Finally, the combination of activated transcription factors and regulatory co-factors leads to the transcription of a large set of genes changing the phenotype of the cell. Understanding the structure and the interplay of pathways is crucial both for understanding the cellular mechanism and for designing novel therapies that target specific pathways. Inferring networks from molecular profiles is a well developed field in bioinformatics. Transcriptional data can be generated more easily compared with protein activation data. Consequently, many algorithms were developed that focus on the reconstruction of regulatory networks. For example, Gaussian graphical models (Sch fer and), Bayesian networks (), the pc algorithm () or the Algorithm for the Reconstruction of Accurate Cellular Networks (). All these methods use observational gene expression data to construct regulatory networks based on different association scores between genes. It is no problem to quantify the expression of any gene using standard methods like qPCR, microarrays or rnase q. Observing signalling networks is more complicated. Protein activation can operate on the levels of protein expression, cellular protein localization or protein modifications like phosphorylation, ubiquitination etc. Although there are assays to assess activation on any of these levels, those assays are more elaborate, more expensive and less generic. Moreover, for every protein a priori information on which type of modification mediates signal transduction is necessary. Molecular biologists have been inferring pathways without formal computations for many years. Typically functional interventional data are used. Pathways are perturbed by activation or inhibition of genes and the consequences of the interventions are observed, organized and interpreted. Also a range of algorithms have been described that formalize these types of arguments and make them accessible to bigger and more complex pathway models use flow cytometry data from perturbation experiments to infer protein signalling pathways with a Bayesian network approach. They test for conditional independence between proteins' states using protein inhibition experiments and direct measurement of these states introduced Nested Effects Models (NEMs) (). NEMs infer non transcriptional signalling pathways by transcriptional downstream effects of pathway perturbation. A pathway is activated in a set of cellular assays where specific pathway components are silenced. The silencing of a specific component blocks the flow of information in a specific branch of the pathway. As a consequence, genes that normally change expression in response to the stimulus no longer react in inhibition assays. NEMs infer the pathway structure from the nesting of these sets: if the effected genes of perturbing gene B are a noisy subset of the effected genes of gene A, then A is upstream of B. This concept has been extended to time series data (), evolving networks (), and network inference with hidden confounders (). To date NEMs can infer the upstream downstream relations of genes in a pathway (), they can distinguish activation from repression () and they can resolve the flow of information (). However they can not model the role of complex formation in signalling pathways. If a protein X is activated by a complex, all members of the complex must be present and in the correct activation state. The proteins in the complex operate concerted ly and are linked to X by an AND gate. In another scenario, X can be activated independently by several proteins. In this case the proteins are linked by an OR gate. Boolean Networks () model logical gates. They have been used to simulate signalling pathways () and to reconstruct them from interventional data (). Allowing for logical gates lead to identifiability problems of network structures. To resolve these ambiguities, prior knowledge on the pathway structures is used. saez describe an algorithm called cellnet optimizer to construct signalling pathways from directly observed activation states of proteins in the Boolean Network framework. They combine prior knowledge networks pk ns with protein phosphorylation data from interventional assays. Here we describe Boolean Nested Effect Models b nem. This method combines advantages from Boolean Network Models and Nested Effect Models. Like Boolean Networks b nems distinguish between the alternative and cooperative activation of a protein, and like normal NEMs, b nems do not need direct observations of protein activity. Moreover, b nems can use data from assays where several pathway genes are perturbed simultaneously. In the following, we will describe the model formalism and define a pathway score together with a genetic algorithm to search for high scoring networks. We will then validate our algorithm on simulated data and use it to analyze b cell receptor (BCR) signalling in lymphoma cells.

discussion we have introduced b nem a novel method to infer signalling network structures. b nem extends the framework of standard NEMs. Standard models infer upstream downstream relations of signalling genes. b nems in addition resolve the Boolean logic of signal propagation. They distinguishing between the independent activation of a protein by multiple upstream proteins and the joint activation by a complex formed from the upstream proteins. Moreover, b nems distinguish between activating and inhibiting interactions. Due to identifiability problems associated with the estimation of Boolean networks, b nem modelling must build on strong prior assumptions on the network structure. Networks can not be constructed from scratch, but unknown features of existing networks can be resolved. We demonstrated this idea by resolving the role of PI3K and TAK1 as mediators of BCR signalling. In our cancer derived cell lines signalling was perturbed. Such cancer derived changes in signalling mechanisms can be further characterized in a comparative b nem analysis of signalling in primary healthy cells and tumor derived cell lines. b nem exploits combinatorial perturbations of multiple genes. Because it is in general not feasible to perform all possible combinations, a subset needs to be chosen. We suggest an iterative procedure. First a b nem is learned from single gene perturbations. In case high scoring networks are incoherent with respect to an important pathway feature, one can simulate combinatorial perturbation data from these high scoring networks aiming at identifying those combinations that resolve the incoherence. In simulations we showed that b nems identify the correct score equivalence class of a signalling pathway with high accuracy. Identifying the correct signalling topology is harder. The most critical step here is the use of prior knowledge. We implement prior knowledge by excluding hyper edges. A full Bayesian framework allows using softer priors that specify prior distributions on the full space of network topologies. However, for large networks these are not practical with b nem because a reduction of the search space is needed for computational reasons. The a priori restriction of the search space is needed for at least three independent reasons. First, the search space needs to be reduced in order to achieve practical running times of the algorithm. Second, together with the regularizing penalty for overly complex networks the PKN is used to limit over-fitting. Third, pk ns limit network ambiguities due to score equivalence of multiple networks. Fortunately, these goals are not opposing. The stronger the prior assumptions, the faster the algorithm, the less over-fitting we have, and the fewer the ambiguities due to score equivalence. On the other side, incorrect a priori assumptions can be disastrous as well. They lead to biased and under fitted network models. Therefore one must find a good balance between belief in prior knowledge from literature and the data.
