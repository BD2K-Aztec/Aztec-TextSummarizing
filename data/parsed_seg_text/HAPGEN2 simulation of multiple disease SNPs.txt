Motivation: Performing experiments with simulated data is an inexpensive approach to evaluating competing experimental designs and analysis methods in genome wide association studies. Simulation based on resampling known haplotypes is fast and efficient and can produce samples with patterns of linkage disequilibrium (LD), which mimic those in real data. However, the inability of current methods to simulate multiple nearby disease SNPs on the same chromosome can limit their application. Results: We introduce a new simulation algorithm based on a successful resampling method, hap gen that can simulate multiple nearby disease SNPs on the same chromosome. The new method, HAPGEN2, retains many advantages of resampling methods and expands the range of disease models that current simulators offer. Availability: HAPGEN2 is freely available from

introduction genome wide association studies have become a powerful approach for uncovering the genetic variants that impact human phenotypes. Simulation studies are a popular and inexpensive approach to evaluate new methods for statistical analysis () and to examine the power of different experimental designs (). The traditional approach of simulating a population forwards () or backwards () in time ignore the large amount of observed genetic data that are available, can be computationally intensive and can struggle to match real LD patterns. To overcome these problems introduced a novel simulation approach, hap gen which uses an alternative resampling approach. Given a reference panel of haplotypes, this method produces a sample of haplotypes with patterns of LD similar to those in the reference panel. Using the HapMap3 and 1000G haplotype data as reference panels, hap gen is able to simulate data for many populations. In addition, it is fast and can simulate a single disease SNP under a general disease model, allowing the user to specify the risk allele and heterozygote and * To whom correspondence should be addressed.  The authors wish it to be known that, in their opinion, the last two authors should be regarded as joint Last Authors. homozygote relative risks. Other resampling methods also exist (), but they and hap gen can only simulate a single disease SNP on the same haplotype. There are many complex diseases with multiple associated loci on the same chromosome, some of them in close proximity (e.g.), so the ability to simulate multiple disease SNPs on the same chromosome would be desirable. To address this issue, we have devised a new approach, extending hap gen to simulate multiple nearby disease SNPs on the same chromosome.
