Background: It has long been intriguing scientists to effectively compare different microbial communities (also referred as meta genomic samples here) in a large scale: given a set of unknown samples, find similar meta genomic samples from a large repository and examine how similar these samples are. With the current meta genomic samples accumulated, it is possible to build a database of meta genomic samples of interests. Any meta genomic samples could then be searched against this database to find the most similar meta genomic sample(s). However, on one hand, current databases with a large number of meta genomic samples mostly serve as data repositories that offer few functionalities for analysis; and on the other hand, methods to measure the similarity of meta genomic data work well only for small set of samples by pairwise comparison. It is not yet clear, how to efficiently search for meta genomic samples against a large meta genomic database. Results: In this study, we have proposed a novel method, meta storms that could systematically and efficiently organize and search meta genomic data. It includes the following components: (i) creating a database of meta genomic samples based on their taxonomical annotations , (ii) efficient indexing of samples in the database based on a hierarchical taxonomy indexing strategy, (iii) searching for a meta genomic sample against the database by a fast scoring function based on quantitative phylogeny and (iv) managing database by index export, index import, data insertion, data deletion and database merging. We have collected more than 1300 meta genomic data from the public domain and in house facilities, and tested the meta storms method on these datasets. Our experimental results show that meta storms is capable of database creation and effective searching for a large number of meta genomic samples, and it could achieve similar accuracies compared with the current popular significance testing based methods. Conclusion: meta storms method would serve as a suitable database management and search system to quickly identify similar meta genomic samples from a large pool of samples.

introduction microbes are everywhere around us on the planet, and the total number of microbial cells on earth is huge: a rough estimation of their number is 10 30 (). Microbes usually live in communities, and each of these communities has different community structures and functions. As such, microbial communities would serve as the largest reservoir of genes and genetic functions for a vast number of applications in bio related disciplines, including biomedicine in healthcare, bioenergy, bioremediation and biodefense (National Research Council (U.S.). Committee on meta genomics Challenges and Functional Applications. and National Academies Press (U.S.), 2007). Because 490% of the strains in a microbial community could not be isolated and cultivated (), the meta genomic methods have been used to analyze the microbial community as a whole. Understanding the taxonomical structure of a microbial community (alpha diversity) and the differences in tax a among microbial communities (beta diversity) have been two of the most important problems in meta genomic research. In contrast to alpha diversity, which measures how many kinds of microorganisms are there in a single community, beta diversity measures how community membership varies over time and space, and is especially important for finding the complex relationships among a large numbers of samples. Understanding the beta diversity is critical for studying microbial ecology. For example, Human microbio me Projects () and related efforts to study microbial communities occupying various human body habitats have shown a surprising amount of diversity among individuals in skin (), gut () and mouth ecosystems (). Furthermore, the microbial communities would differ significantly even for those from types of similar environment (). next generation sequencing techniques have enabled the fast profiling of a large number of meta genomic data. Thus, a rapidly increasing number of meta genomic profiles of microbial communities have been archived in public repositories and research labs around the world. As such, it is becoming more and more important to compare microbial communities in large scale. *To whom correspondence should be addressed.

conclusion with the fast accumulation of meta genomic samples and sequencing data, their comparison becomes very important to illustrate their similarities and differences. As such, the database search for meta genomic samples is becoming more and more important. However, current meta genomic data are not organized well (thus they are only data repositories, but not yet modernized and manageable database), and current meta genomic sample comparison methods are generally based on pairwise comparisons (thus, only comparable in small scale and difficult with large scale analysis) without efficient index supporting. Therefore, we have designed the meta storms system as a system for database creation, indexing and searching for similar meta genomic samples. meta storms is not only a database builder and searcher, but a search engine based meta genomic sample comparison system that could organize the database well, and could perform quick and accurate search. Although it is one of the first systems of its kind, meta storms has already been proved to perform well in similarity search for a large numbers of samples. Its main advantages include: ability to handle large number of samples in an integrated system, fast indexing and candidate retrieval, accurate scoring function for comparison, etc. First, meta storms has advantages in system integrity: it can take input of the 16 s rRNA pyro-sequencing data or WGS data, thus is independent of any other method to retrieve the community structure of the meta genomic samples. Additionally, the database could be built based on more than 10 000 meta genomic samples, making it one of the first systems that could handle such a large number of samples. Second, its index is simple, yet quite fast and accurate in clustering different samples. The fast speed comes out of the simple categorization by only using phyla with high abundance as the index key. Therefore, such indexing scheme would be useful, especially when there are many samples, for organizing samples in a meta genomic database. Third, for sample comparison, it was noted that significance tests such as the p test () and the Fast uni frac replicated permutation become decreasingly useful as the depth of coverage and the number of samples increase (). However, although our methods based on scoring b Phylogenetic tree of human microbio me samples and query results, which were matched to the right body sites. Numbers on left part are samples that were matched to the body sites indicated by the corresponding arrows. function does not need complex computation, it is as accurate as those based on significance tests with fast speed. Therefore, our scoring function might be a better alternative to the traditional time consuming significance test. Functional comparison of different meta genomic samples have also shown the ability of meta storms to accurately and efficiently identify microbial communities of similar functions, and also help to shed new light onto the functional diversity of the microbial communities. With the advance of WGS of meta genomic samples, it is anticipated that the functional profiling and comparison of meta genomic samples would become more and more important, for which meta storms would be of greater importance. In conclusion, meta storms would provide key methods for meta genomic projects to facilitate the research in meta genomics and more broadly, microbial communities, including Human microbio me Projects, earth microbio me Project, etc. Current meta storms method could be updated in index efficiency and consistence. First, current indexing strategy is suitable for searching samples with dominant genomes (which are always the case) against large database. For query samples without dominant phyla, or when samples in the database are quite similar to each other (e.g. from the same source), we recommend the exhaustive search for high reliability rather than indexed query. Second, the statistical model for the database search could be improved by integrating a mixture model. By these refinements, it is expected that the overall performance of meta storms could improve further. All of these issues are expected to be addressed in our future work.
