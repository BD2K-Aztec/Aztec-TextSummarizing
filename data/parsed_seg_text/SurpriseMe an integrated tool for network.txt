Detecting communities and densely connected groups may contribute to unravel the underlying relationships among the units present in diverse biological networks (e.g. interactome s coexpression networks, ecological networks). We recently showed that communities can be precisely characterized by maximizing Surprise, a global network parameter. Here, we present surprise me a tool that integrates the outputs of seven of the best algorithms available to estimate the maximum Surprise value. surprise me also generates distance matrices that allow visualizing the relationships among the solutions generated by the algorithms. We show that the communities present in small and medium sized networks, with up to 10 000 nodes, can be easily characterized: on standard PC computers, these analyses take less than an hour. Also, four of the algorithms may rapidly analyze networks with up to 100 000 nodes, given enough memory resources. Because of its performance and simplicity, surprise me is a reference tool for community structure characterization. Availability and implementation: surprise me is implemented in Perl and C/Cþþ. It compiles and runs on any unix based operating system, including Linux and Mac OS/X, using standard libraries. The source code is freely and publicly available under the GPL 3.0 license at

introduction complex networks are extensively used for representing interactions among elements of a system. This approach is particularly useful in biology; analyzing networks provides relevant information in fields such as genetics (), ecology (), neuroscience (), systems biology (Barabasi) or proteomics (), among others. An interesting property of these networks is the fact that related units of the network tend to create tightly knit groups, usually known as communities. By unraveling the close relationships among certain units, community structure characterization improves our understanding of the system as a whole. Recently, many strategies have been devised to detect the optimal division of a network into communities. However, none of them alone is able to achieve high quality solutions in all kinds of networks (; al deco a and marn marn 2013a, b). In recent works, we demonstrated that Surprise (S) () is an effective measure to evaluate the quality of a partition of a network into communities al deco a and marn marn 2011, 2013a, b). Given such a partition, S calculates the un likeliness of finding the observed number of intra community links in a totally random network, according to a cumulative hypergeometric distribution here F is the maximum possible number of links of the network, n is the actual number of links, M is the maximum possible number of intra community links and p is the actual number of links within communities. In several complex benchmarks, composed of networks with very different structures, it was shown that the partition of maximum S corresponds to the real community structure, with a minimal null degree of error (, b). We also showed that S outperforms modularity (Q;), the most commonly used criterion to define communities, in all benchmarks (). Although a simple algorithm to maximize S has not yet been devised, we found that choosing among the output of seven high quality algorithms, the one that provided the maximum S value solved the structure of all networks tested. These algorithms are called CPM (), info map (), RB (), RN (), rns c (), s cluster al deco a and marn marn 2010) and uv cluster (). The particular performances of each algorithm are detailed in al deco a and marn marn (2013a, b). Here, we present surprise me a tool integrating those seven algorithms. surprise me accelerates the research process by simply accepting a network as input, internally running all the algorithms and outputting their solutions and their Surprise values. surprise me also calculates distances among the solutions provided by the algorithms, allowing understanding of how congruent they are ().names of two connected nodes, separated by a tab or space character. From this text file, the software automatically generates the required input formats and runs the algorithms (either all or a subset chosen by the user). Finally, the algorithm that generates the maximum S value is established. For info map RN and rns c the unique partitions generated are evaluated, while for RB, CPM, uv cluster and s cluster which provide several alternative partitions, the ones with the highest S value are considered. surprise me also compares the solutions of each algorithm, using either the Variation of Information (VI) () or the [1  NMI] value, where NMI stands for Normalized Mutual Information (). In both cases, the greater the value, the more two partitions are different (see al deco a and marn marn 2012, 2013a, b). The program also estimates the distances to two additional solutions called One (all units of the network are in one community) and Singles (each node belongs to a different community). The distances to these two solutions provide further clues of the behavior of the algorithms al deco a and marn marn 2013b). All distances are saved into two distance matrix files (for VI and for 1  NMI) that can be directly imported into MEGA5 (), a popular free software that allows easily visualizing the hierarchical relationships among the different solutions (see al deco a and marn marn 2013b).
