Motivation: Copy number variations cn vs are increasingly recognized as an substantial source of individual genetic variation, and hence there is a growing interest in investigating the evolutionary history of cn vs as well as their impact on complex disease susceptibility. cnv snp haplotypes are critical for this research, but although many methods have been proposed for inferring integer copy number, few have been designed for inferring CNV haplo typic phase and none of these are applicable at genome wide scale. Here, we present a method for inferring missing CNV genotypes, predicting CNV allelic configuration and for inferring CNV haplo typic phase from snp cnv genotype data. Our method, implemented in the software poly hap v2.0, is based on a hidden Markov model, which models the joint haplotype structure between cn vs and SNPs. Thus, haplo typic phase of cn vs and SNPs are inferred simultaneously. A sampling algorithm is employed to obtain a measure of confidence credibility of each estimate. Results: We generated diploid phase known cnv snp genotype datasets by pairing male X chromosome cnv snp haplotypes. We show that poly hap provides accurate estimates of missing CNV genotypes, allelic configuration and CNV haplo typic phase on these datasets. We applied our method to a non simulated data set a region on Chromosome 2 encompassing a short deletion. The results confirm that poly haps accuracy extends to real life datasets. Availability: Our method is implemented in version 2.0 of the poly hap software package and can be downloaded from

introduction copy number variations cn vs are pervasive in the human genome () and could play a key role * To whom correspondence should be addressed. in human diversity and disease susceptibility (). Despite this, the population genetics of cn vs and particularly so for duplications remain relatively poorly understood. Several analytical tools, such as haplotype analysis, which are standard for snp based population genetics have yet to be modified to be applicable to complex multi allelic cn vs. Several technologies enable high throughput CNV detection, including array comparative genomic hybridization a cgh and SNP genotyping arrays. Many algorithms have been proposed to detect CNV regions and to estimate the integer copy number (CN) genotypes in each region using these technologies (). In particular, using SNP genotyping arrays to simultaneously produce estimates of integer CN and SNP genotype has become popular, particularly as a means to identify both SNPs and cn vs associated with disease. CNV association analyses are conducted either on estimates of integer CN genotype (), or using normalized continuous intensity data measurements (). As a result of intensive genotyping efforts worldwide for genome wide association studies, there are many datasets containing inferred CNV regions, CNV genotypes in these regions, as well as SNP genotypes. However, cnv snp haplotypes are rarely determined in these datasets, due largely to a lack of algorithmic development in this area. Hence, haplotype based approaches that have been shown to be more powerful than single marker analyses () are not fully exploited in CNV association studies. Apart from improving the sensitivity of association studies, CNV SNP haplotypes are also invaluable for studying the evolutionary history of cn vs. In particular, many techniques for detecting positive selection rely on accurate phasing (). Similarly, cnv snp phasing will improve accuracy of estimates of linkage disequilibrium (LD) between SNPs and cn vs (), particularly for multi allelic cn vs. Identification of the haplo typic background(s) of a given CNV, will also help to distinguish single versus recurrent deletion amplification events and will also shed light on the age of the CNV (from the size of the extended haplotype containing the CNV).

discussion we have presented a method for inferring haplo typic phase for cnv snp genotype data among unrelated individuals. Our method allows CNV regions and ploidy to vary along the sequence and between the individuals. Our program accommodates both CNV and SNP genotype data and infers missing genotypes and haplo typic phase for both types of data. Our method allows uncertainty in the CN assignment by representing the CNV genotype as a probability distribution over multiple CNV genotypes. It is necessary to first calculate CNV genotypes prior to running our program. In particular, poly hap does not accommodate a continuous measurement in place of the integer CN genotypes. poly hap can include in principle an arbitrary maximum number the error bar of each switch error rate is based on a 95% equal tailed Bayesian interval given the prior Beta(1/2,1/2). The number on the top of each cell graph represents CNs at a pair of heterozygous sites (first digit is the CN at the first site and second is the CN at the second site). of copies. However, as the computational complexity scales roughly as # copies 2 for non internal phasing, and as e # copies for internal phasing, meaning that internal phasing is feasible for up to 6 copies, and non internal for up to 20 copies. Similarly, poly hap can not model complicated structural rearrangements, including inversions and translocations. poly hap requires a pre-defined number of ancestral haplotypes. In this study, we use eight ancestral haplotype states for internal phasing (two CN = 0 and six CN = 1 states) and nine haplotype states for non internal phasing (one CN = 0, four CN = 1 and four CN = 2 states). We have also tried different numbers of ancestral haplotypes and found that the results are comparable. Here, we would suggest using higher number of ancestral haplotypes when dealing with rare variants. The choice of ancestral haplotype number usually does not the results from the simulation study demonstrate that our program provides accurate estimates of missing genotypes, allele configuration and haplo typic phase for both CNV and SNP data. Our method gives an imputation error rate 0.09 for imputing missing genotypes with one to four copies of alleles. Also, our method provides accurate estimates of allele configurations on a pair of haplotypes, with an error rate 0.19. Furthermore, poly hap successfully identified a haplotype comprising a short deletion on chromosome 2. Our method gives encouraging results for inferring CNV haplo typic phase over different CNs at heterozygous sites. Although there are several situations where the switch error rate is 0.3, this might result from rare haplotypes in the dataset, and the accuracy here would be improved by using a larger population sample. Also, reliable phase inferences can be distinguished using the uncertainty estimates. In general, a higher certainty rate indicates higher accuracy of the estimate. poly hap outperforms two existing methods for phasing cnv snp haplotypes cnv phaser and mocs phaser in terms of accuracy and capacity of dealing with large scale datasets. Comparing our method with fast phase beagle for phasing bi allelic CNV, poly hap is comparable to fast phase and gives more accurate estimates than Beagle in most cases of CN transitions. One advantage of our new method over fast phase beagle for phasing cnv snp haplotypes is that poly hap is designed for inferring cnv snp haplotypes and is able to accommodate some properties of CNV that differ from SNPs and to deal with multi allelic CNV. Our program provides two different levels of CNV phasing non internal and internal. With internal phasing, the individual is considered as polyploid, and thus the phasing process is similar to that described for poly hap (). Internal phasing enables inference of the duplicated and original haplotype, but does not say which chromosome copy contains the amplification. non internal phasing, on the other hand provides information about which chromosome copy contains the CNV, but not the internal structure of duplications. By providing both options, our program enables the researcher to choose a suitable level of phasing for the specific purposes of the study. Our method is faster than cnv phaser and is feasible for genome wide analyses using a computing cluster. The computing time for the French dataset with nine ancestral haplotype states and 10 repetitions of the em training algorithm (containing 1106 markers on each of 24 individuals) was 0.8 h on a 8 GB computer, while the Finnish dataset (containing 2149 markers on each of 347 individuals) took 1.5 h on a 16 GB computer. The computing time increases linearly with the number of markers and individuals. Modelling the haplo typic background of cn vs will provide a better understanding of the evolutionary processes affecting cn vs. Moreover, it will help us to better model cnv phenotype associations to make cnv disease associations more robust by simultaneously identifying the underlying haplotype harbouring the CNV and to disentangle associations between cn vs and phenotype from associations with flanking SNPs.
