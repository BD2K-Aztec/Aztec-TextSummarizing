Motivation: Multivariate tests derived from the logistic regression model are widely used to assess the joint effect of multiple predictors on a disease outcome in case control studies. These tests become less optimal if the joint effect can not be approximated adequately by the additive model. The tree structure model is an attractive alternative, as it is more apt to capture non additive effects. However, the tree model is used most commonly for prediction and seldom for hypothesis testing, mainly because of the computational burden associated with the resampling based procedure required for estimating the significance level. Results: We designed a fast algorithm for building the tree structure model and proposed a robust tree based Association Test (TREAT) that incorporates an adaptive model selection procedure to identify the optimal tree model representing the joint effect. We applied TREAT as a multilocus association test on420 000 genes regions in a study of esophageal squamous cell carcinoma (ESCC) and detected a highly significant novel association between the gene CDKN2B and ESCC (P ¼ 6:0 Â 10 À8). We also demonstrated, through simulation studies, the power advantage of TREAT over other commonly used tests.

introduction the logistic regression model is the most widely used approach for studying the relationship between a binary outcome and a set of explanatory variables. Under the logistic regression model, the cumulative effect of all the considered explanatory variables is assumed to be additive on the log it scale. In situations where the summation of the main effects from all considered variables is not adequate, the addition of interaction terms, each of which is a product of two chosen main effects, can be considered. The logistic regression model is a convenient tool for studying the joint effect of multiple risk factors if their effects are nearly additive, but it can be less efficient if the joint effect is more complicated and can not be approximated adequately by the additive model, even with the inclusion of interaction terms. The tree structure model (), which hierarchically partitions the data into multiple exclusive subsets and models each subset individually, can be an attractive alternative to the linear model approach, especially in the situation where the joint effect of multiple risk factors (predictors) is non additive. tree structure models are used most often for outcome prediction but seldom for hypothesis testing. When building a tree model, a predictor is chosen to split each subset (a node of a tree) according to certain criteria. Also, the tree size is decided through a model selection procedure, such as cross validation. Thus, there are extensive model and variable selections in the tree model building process. As a result, it is hard to obtain the asymptotic distribution for the test statistic derived from the final tree model. Instead, we have to resort to a computationally intensive resampling based procedure to evaluate the statistical significance (). This greatly limits the application of the tree structure model in the setting of hypothesis testing. Our goal is to develop a robust hypothesis testing procedure based on the tree structure model that is computationally efficient, even with the resampling based procedure. The procedure is for testing the null hypothesis that none of the considered risk factors is associated with the outcome. One motivated application is to conduct a gene level association test on a genome wide association (GWA) study. GWA studies typically measure genotypes on 200 0002 million single nucleotide polymorphisms (SNPs) on a group of cases and controls. One way to identify loci that are associated with the disease condition is to perform an association test on each SNP separately. Another strategy is to conduct a gene level analysis by treating each chromosomal region as a testing unit and testing whether all SNPs in the considered region are associated with the disease condition. A considered region can contain a few to a few hundred SNPs measured by a commercial genotype array. When conducting an agnostic screen over the genome, we usually need to test 420 000 genes or annotated regions. When the Bonferroni correction for multiple comparisons is used, the p value threshold for declaring the global genome wide significance at the family wise type I error rate of 0.05 is about 2:5  10 6 ( 0:05=20 000). This creates a huge computational burden on existing gene based *To whom correspondence should be addressed. tests that rely on a resampling based procedure to estimate their significance levels. For example, it requires about 10 8 iterations for a resampling based procedure to achieve a reliable estimate for a p value at the level of 1:0  10 6 , which would normally occur when 420 000 tests are performed. Our proposed method is a general testing procedure that can be used as a multivariate test for the association between a set of predictors and a binary outcome. The test statistic is derived from a tree structure model that approximates the joint effect of a set of predictors on the disease risk and relies on a permutation procedure to evaluate its significance level. We reduce the computational burden considerably by developing memory and cpu efficient algorithms for evaluating splitting rules in the tree building process. We further speed up the testing procedure by deriving closed form score test statistics for assessing the joint effect summarized by the tree structure model. We use this new procedure to perform a genome wide gene based analysis on 420 000 genes regions in a GWA study of esophageal squamous cell carcinoma (ESCC) based on about 2000 cases and 2000 controls. We also demonstrate the advantage of the proposed procedure over existing ones through extensive simulation studies.

discussion the linear regression model, such as the logistic regression model, has been the dominant tool for assessing the joint effect of multiple predictors. The following three factors contribute to its popularity. First, the linear regression is convenient to use, as the asymptotic distributions have been established for derived test statistics. Second, it is generally accepted that the linear model is usually adequate for depicting the joint effect. Third, there are not many alternative options available. There is clearly a demand for more robust testing procedures, especially in situations when the cumulative effect from multiple predictors is non additive. Here, we have proposed a general testing procedure based on the tree structure model. Leveraging a computationally efficient tree building algorithm, the procedure has limited requirements for CPU time and memory. For a gene with 20 SNPs in a study of 2000 cases and 2000 controls, it takes 45 s to run the procedure with 10 5 permutation steps on a Linux machine with a 2.8-GHz Xeon CPU. We have demonstrated the power advantage for the proposed procedure in the setting of gene based association analysis through real and simulated datasets. The proposed testing procedure is general and can be used for testing the association between a set of risk factors and a binary outcome. It can adjust the covariates' effects by treating them as a categorical variable with multiple levels. It has two major tuning parameters that have to be set by the user: the maximum tree sizes K 0 (the number of leaf nodes) and the minimum sample size N 0 required for each leaf node to be split. In practice, the maximum tree size depends on the sample size of the study, the number of risk factors and the prior knowledge on the complexity of the underlying risk model. For the purpose of hypothesis testing, we favor a relatively small tree size, as we want to limit the number of considered candidate risk models, which are subtrees of the full tree with the maximum number of leaf nodes, to control multiple comparison effects. On the other hand, the maximum tree size has to be large enough to allow the searching space to be sufficiently broad to cover a model that adequately approximates the true risk model. In the setting of gene based analysis, we recommend choosing K 0 in the range of 5 to 10, under the assumption that the number of true disease associated loci within a gene tends to be relatively small. The choice of the minimum sample size N 0 required in each leaf node is driven mainly by the total sample size. Because each leaf node represents a candidate risk group, we suggest N 0 ! 50 for robust testing results. The computational burden associated with the tree structure model is one major barrier to its use for hypothesis testing. We overcame this obstacle by combining several strategies to speed up the proposed procedure, including the derivation of closed form formulas for evaluating splitting rules and score test statistics for assessing the joint effect summarized by the tree structure model, the use of Ge's one layer permutation algorithm () for the evaluation of the p value and the adaptation of the BOO method () for swift scanning over candidate splitting rules. We demonstrated that it is feasible to apply the proposed procedure as a multilocus association test in large scale gene based association studies with 420 000 candidate genes or annotated regions. The tree building algorithm can be accelerated further by noticing that the evaluation of splitting rules at each given tree node is parallelizable. We are currently working on a GPU (graphic processing unit) implementation to take advantage of the parallel iz ability (). We developed a general testing procedure based on the tree structure model and presented a fast algorithm for building the tree structure model by adopting the computationally efficient Boolean operator for swift evaluation of the splitting rule. This procedure has broad applications, and it is a valuable tool that can be run routinely in conjunction with other tests that target an additive joint effect. We have created an R package implementing the procedure (http://www.hanzhang.name/softwares/treat).
