Motivation: As there exists no cure or vaccine for the infection with human immunodeficiency virus (HIV), the standard approach to treating HIV patients is to repeatedly administer different combinations of several antiretroviral drugs. Because of the large number of possible drug combinations, manually finding a successful regimen becomes practically impossible. This presents a major challenge for HIV treatment. The application of machine learning methods for predicting virological responses to potential therapies is a possible approach to solving this problem. However, due to evolving trends in treating HIV patients the available clinical datasets have a highly unbalanced representation, which might negatively affect the usefulness of derived statistical models. Results: This article presents an approach that tackles the problem of predicting virological response to combination therapies by learning a separate logistic regression model for each therapy. The models are fitted by using not only the data from the target therapy but also the information from similar therapies. For this purpose, we introduce and evaluate two different measures of therapy similarity. The models are also able to incorporate phenotypic knowledge on the therapy outcomes through a Gaussian prior. With our approach we balance the uneven therapy representation in the datasets and produce higher quality models for therapies with very few training samples. According to the results from the computational experiments our therapy similarity model performs significantly better than training separate models for each therapy by using solely their examples. Furthermore, the models performance is as good as an approach that encodes therapy information in the input feature space with the advantage of delivering better results for therapies with very few training samples. Availability: Code of the efficient logistic regression is available from

introduction the human immunodeficiency virus (HIV) targets the human immune system and leads to the acquired immunodeficiency syndrome (AIDS) that has a high mortality rate. Being a disease that * To whom correspondence should be addressed. claimed more than 25 million lives since its discovery in 1981, AIDS is highly ranked on the chart of most destructive world epidemics. Currently, there is no vaccine against HIV and there is no way of ridding HIV patients of the virus. Therapy administration to patients is hampered by the high evolutionary dynamics of the virus which eventually escapes to resistance against any drug therapy. In order to prolong the time for which a therapy is effective, combinations of drugs are administered to patients. According to the WHO unaids who 2009) more than 30 million people were infected and approximately 4 million people were receiving antiretroviral therapy at the end of 2008. Since every therapy eventually fails, finding a successful regimen remains a major challenge for HIV treatment. Whenever a therapy regimen fails a physician decides on a new regimen based on the presence of a set of resistance relevant mutations in the viral strands sampled from the patient's blood serum. The large number of available drugs renders the number of potential therapy combinations too large for manual assessment. Thus, in recent years statistical models for therapy outcome prediction have been developed on the basis of clinical data. These data comprise samples of many different drug combination therapies taken from many patients over a couple of decades. Different therapies are represented in different abundance of samples: while for some therapies many samples exist, for others there are very few. Furthermore, due to the large number of possible combination therapies and the introduction of new antiretroviral agents, for many combinations no samples are available at all. In a medical setting, we strive for every therapy to be effective. Thus, it is important to improve the quality of the prediction on these difficult to assess therapies that have very few training samples. The work we present in this article is inspired by the uneven therapy representation in the clinical datasets. We propose a method that tackles the problem of predicting the outcome of HIV drug combination therapies as follows. A separate model is trained for each distinct therapy combination by using not only the samples from the target therapy but also the available samples from similar therapies with appropriate sample weights. In order to quantify therapy similarity, we introduce two different similarity measures: the drugs kernel and the groups additivity kernel. Utilizing knowledge from similar therapies is particulary important for the therapy models that have very few or no examples in the available dataset. Since we learn separate models for each drug combination in order to provide efficient model fitting and model selection, we choose the trust region Newton method for training linear logistic regression () that takes advantage of the sparsity of the data. Furthermore, our method has the facility of integrating prior knowledge on therapy outcomes through a Gaussian prior.
