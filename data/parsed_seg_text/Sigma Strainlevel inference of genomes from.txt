Motivation: meta genomic sequencing of clinical samples provides a promising technique for direct pathogen detection and characterization in bio surveillance. Taxonomic analysis at the strain level can be used to resolve serotypes of a pathogen in bio surveillance. Sigma was developed for strain level identification and quantification of pathogens using their reference genomes based on meta genomic analysis. Results: Sigma provides not only accurate strain level inferences, but also three unique capabilities: (i) Sigma quantifies the statistical uncertainty of its inferences, which includes hypothesis testing of identified genomes and confidence interval estimation of their relative abundances ; (ii) Sigma enables strain variant calling by assigning meta genomic reads to their most likely reference genomes; and (iii) Sigma supports parallel computing for fast analysis of large datasets. The algorithm performance was evaluated using simulated mock communities and fecal samples with spike in pathogen strains. Availability and Implementation: Sigma was implemented in C++ with source codes and binaries freely available at

introduction it is a public health and national security imperative to prepare for a broad range of biological threats, including infectious diseases and food-borne illnesses (). bio surveillance will provide early detection of disease outbreaks and rapid characterization of pathogens. Conventional methods for bio surveillance include laboratory culture, immunoassays, and genotyping (). meta genomic sequencing, developed in environmental microbiology, is a promising new method for bio surveillance. For example, fecal samples of suspected patients in food-borne disease outbreaks can be sequenced directly to identify responsible pathogens, bypassing the steps of strain isolation and culturing for pathogen identification. In the 2011 German Shiga toxin producing E.coli (STEC) O104:H4 outbreak, the pathogen was identified by the standard epidemiology procedure of isolation, culturing, and genotyping (). Multiple isolate cultures of this pathogen from different patients were subsequently sequenced, which generated whole genome sequences for pathophysiology analysis. In the future, meta genomics could be used to sequence fecal samples of patients in the early stage of such an outbreak, potentially allowing more rapid and unambiguous identification of the pathogen. It is a computational challenge to achieve sensitive and specific identification of pathogens in a complex meta genome background. Many algorithms have been developed to infer the taxonomic composition of a microbial community using meta genomic sequencing data. The algorithms generally used the following three approaches. (i) The km er statistics approach compares km er frequency profiles of meta genomic reads with those of organisms representing a wide range of clades. This approach is used by Na ve Bayes Classifier (), phy mm bl (), and phylo pythias (In the marker gene approach, meta genomic reads are aligned with a set of preselected clade specific marker genes, and taxonomic classification is inferred from phylogenetic distances to these marker genes. This approach is used by meta phl an () and amphora 2 (). Both of the two approaches can produce high quality classification results at the species level or above without using a significant amount of computation. However, these two approaches may not be adequate for taxonomic classification at the strain level. Genome identification for meta genomic bio surveillance needs to resolve different strains (or serotypes) of the same species. For example, pathogenic E.coli strains need to be unambiguously differentiated from coexisting non-pathogenic E.coli strains in the meta genome. Alternatively, (iii) the read mapping approach infers the taxonomic composition of a community by searching meta genomic reads against a database of reference genomes. This approach is used by MEGAN (), sort items (), meta phyl er (), Grammy (), gas ic (), and patho scope (). This approach can provide accurate high resolution taxonomic classification for clades well represented by reference genomes. It is suitable for meta genomic bio surveillance of known pathogens, which generally have reference genomes available for a variety of strains. However, it is difficult for this approach to detect novel pathogens. When a new strain is present in a sample, its closely related strains in a reference genome database need to be identified and their sequence variations be determined. Here, we present the Sigma algorithm strain level inference of genomes from meta genomic analysis) for meta genomic bio surveillance. A novel probabilistic model was developed to identify and quantify genomes using the read mapping approach. Our benchmarks showed that Sigma provided more accurate *To whom correspondence should be addressed.  The Author 2014. Published by Oxford University Press. This is an Open Access article distributed under the terms of the Creative Commons Attribution License (http://creativecommons.org/licenses/by/4.0/), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited. strain level and species level classification than an established read mapping algorithm megan a representative marker gene algorithm meta phl an and a recent pathogen detection algorithm patho scope. Sigma was scaled from desktops to supercomputers to achieve a short turnaround time for large meta genomic datasets. This allows a prompt response of a meta genomic bio surveillance network to disease outbreaks using supercomputers. The existing taxonomic analysis algorithms generally do not provide statistical confidence assessment of their results. It is difficult to make a bio surveillance decision based on the inference of an algorithm on a pathogen's presence without knowing the uncertainty on such inferences or to use the estimated relative abundance of a genome without knowing the confidence intervals of such estimates. After the identification and quantification of genomes, Sigma can rigorously evaluate the statistical confidence of its findings. Hypothesis testing based on the likelihood ratio test was used to calculate p values for the detection of relevant genomes. Bootstrapping was used to estimate the confidence intervals of the relative abundances of identified genomes. When an outbreak spreads or a pathogen re emerges it is important to determine the sequence variations between the genomes of this pathogen in the field collected samples and its reference genomes in the database. This allows accurate reconstruction of the transmission sources of the outbreak and the evolutionary history of the pathogen. Thus, bio surveillance further requires information on the single nucleotide polymorphisms (SNPs) of a detected pathogen to distinguish different variant populations. Identification of variants is straightforward for isolate genome sequencing by mapping all reads to a reference genome. However, in meta genome sequencing, one can not simply map all meta genomic reads to a reference genome, because some of the aligned reads may originate from different microorganisms, which could introduce false variations. Sigma solves this problem by assigning each read to its most likely originating genome based on the Sigma probabilistic model, which allows subsequent variant calling by variants calling software such as sam tools ().shows an overview of the Sigma algorithm. Sigma starts with mapping all reads in a meta genomic dataset onto a user defined database of reference genomes. A parallelization wrapper is provided as an option for users to speed up the read alignment using computer clusters. A read can be aligned to many genomes with up to a given number of mismatches. The foundation of all statistical inferences in Sigma is a simple probabilistic model for sampling reads with mismatches from genomes at unknown abundances. The Sigma probabilistic model permits maximum likelihood estimation (MLE) of the relative abundances of all genomes measured by the percentages of reads sampled from these genomes. Importantly, we proved the convexity of the objective function of the MLE so that Sigma can guarantee to attain a global optimum solution using interior point non-linear programming (NLP) provided in the ip opt library (). The Sigma probabilistic model further provides the statistical framework for hypothesis testing and confidence interval estimation. Sigma calculates the p value for identification of a genome using a likelihood ratio test of the null hypothesis that this genome is not present in the sample. To account for the quantification uncertainty from the stochastic sampling process of meta genomic sequencing, bootstrapping is used to estimate confidence intervals of relative abundances of identified genomes. As both bootstrapping and likelihood ratio tests entail solving the nontrivial NLP optimization problem for many times, the NLP solver of Sigma is multithreaded and parallelized to computer clusters. Finally, given the MLE of genome relative abundances, Sigma can calculate the probabilities of sampling a read from its mapped genomes, which allows assigning meta genomic reads to their most likely originating genomes for variant calling. For a selected genome, Sigma provides the alignment of its assigned reads on the genome sequence as the input for variant calling with sam tools. Sigma filters the variant calling output to identify high confidence sequence variations.

discussion a number of taxonomic classification algorithms have been developed for meta genomic data with different advantages. For example, the LCA algorithm used by MEGAN can provide classification at a higher taxonomic rank for a novel microorganism without a reference genome from a closely related strain or species in the database. The marker gene approach used by meta phl an only requires a small amount of computing resources for large meta genomic datasets. The general purpose taxonomic classification algorithms () typically provide comprehensive phylogenetic coverage and identifications at proper taxonomic ranks for complex microbial communities, which is important for many microbial ecology studies. Conversely, patho scope and Sigma both are designed for detecting pathogens in meta genomic samples. However, patho scope did not provide accurate resolution of different strains in a sample, which is required for bio surveillance to distinguish pathogenic strains from non-pathogenic strains and to pinpoint the serotype of a pathogen from a complex meta genome background. This is probably because the EM algorithm used by patho scope can only provide a local optimum solution for genome abundance estimation. The local optimum solution may deviate significantly from the global optimum solution for meta genomes that are complicated by multiple different strains. However, the NLP algorithm used by Sigma mathematically guarantee a global optimum solution for genome abundance estimation, due to the convexity of the objective function for the MLE. Furthermore, Sigma provides three unique capabilities needed for meta genomic bio surveillance. First, Sigma can evaluate the statistical confidence of genome identification and quantification with hypothesis testing and confidence interval estimation. The uncertainty quantification will support more informed decision making in bio surveillance. Second, Sigma can determine the divergence of the actual genomes in the sample from the reference genomes in the database by variant calling. By assigning meta genomic reads to their most likely originating genomes, Sigma makes the meta genomic SNP analysis amenable to the existing variant calling algorithms designed for isolate genomes. Strain variations can be used to track the divergence of a pathogen during its spread. Finally, Sigma users can optionally use high performance computing to achieve fast analysis with short turnaround time. The computation is scalable to very large meta genomic datasets.
