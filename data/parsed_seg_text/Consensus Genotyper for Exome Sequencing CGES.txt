Motivation: The development of cost effective next generation sequencing methods has spurred the development of high throughput bioinformatics tools for detection of sequence variation. With many disparate variant calling algorithms available, investigators must ask, Which method is best for my data? Machine learning research has shown that so called ensemble methods that combine the output of multiple models can dramatically improve classifier performance. Here we describe a novel variant calling approach based on an ensemble of variant calling algorithms, which we term the Consensus genotype r for exo me Sequencing c ges. c ges uses a two stage voting scheme among four algorithm implementations. While our ensemble method can accept variants generated by any variant calling algorithm , we used GATK2.8, sam tools free bayes and atlas snp2 in building c ges because of their performance, widespread adoption and diverse but complementary algorithms. Results: We apply c ges to 132 samples sequenced at the Hudson Alpha Institute for Biotechnology hai b Huntsville, AL) using the nimble gen exo me Capture and Illumina sequencing technology. Our sample set consisted of 40 complete trios, two families of four, one parent child duo and two unrelated individuals. c ges yielded the fewest total variant calls (N c ges =139 897), the highest ts tv ratio (3.02), the lowest Mendelian error rate across all genotypes (0.028%), the highest rediscovery rate from the exo me Variant Server (EVS; 89.3%) and 1000 Genomes (1KG; 84.1%) and the highest positive predictive value (PPV; 96.1%) for a random sample of previously validated de novo variants. We describe these and other quality control (QC) metrics from consensus data and explain how the c ges pipeline can be used to generate call sets of varying quality stringency, including consensus calls present across all four algorithms , calls that are consistent across any three out of four algorithms , calls that are consistent across any two out of four algorithms or a more liberal set of all calls made by any algorithm. Availability and implementation: To enable accessible, efficient and reproducible analysis, we implement c ges both as a stand-alone command line tool available for download in git hub and as a set of Galaxy tools and workflows configured to execute on parallel computers.

introduction whole exo me sequencing (WES) has quickly become an affordable approach to identifying rare variants contributing to disease. Over the past 5 years the number of published papers that were indexed in PubMed with the key words exo me sequencing' has increased 200-fold, representing a clear trend in human genetics. The utility of WES for revealing biological mechanisms depends on the genetic architecture of the phenotype in question, the quality of the sequencing technology and, to a significant extent, the analytic methods used to identify and genotype variations in sequence. In recent years, several methods have been developed to analyze raw WES data, including atlas snp2 (), g atk (), seq em (), free bayes (), sam tools (), din del soap snp () and Varscan2 (), among others. These methods represent substantial effort and expertise in the analysis of next generation sequencing (NGS) data, including both whole exo me and whole genome sequencing. Here we present a natural extension of these individual algorithms that integrates their relative strengths into a consensus calling approach, which we call c ges. This algorithm, developed as a collaborative effort between the Department of Medicine and the Computation Institute at the University of Chicago, takes advantage of the diverse variant calling strategies of four existing algorithms (GATKv2.8, atlas snp2 sam tools and free bayes in an open source freely available and user friendly analysis platform. While all variant calling programs seek to optimize performance relative to some core properties of sequencing data (such as read depth and allele count), they often differ along other dimensions. We chose to base our consensus based pipeline on GATKv2.8, sam tools Altas-SNP2 and free bayes as these *To whom correspondence should be addressed.  The Author 2014. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals permission soup com four algorithms use complementary approaches. For example, all algorithms include genotype and in del likelihood models, but the models themselves differ with respect to information used and weights given to such information [see o and Yu and Sun (2013) for complete comparison]. Furthermore, free bayes allows explicit parameterization if there are known copy number variants in a sample, while GATKv2.8 provides sophisticated filtering options that can be trained on a given dataset. Together, these programs constitute a suite of algorithms that attempt to integrate as much information as possible, including prior variant observations, linkage disequilibrium structure and structural variation, to reduce both type I and type II errors. In brief, c ges first runs each algorithm separately and then combines the resulting four collections of genotype calls to create three possible output sets, typically of increasing size but lower average quality: consensus calls (i.e. calls made by all four algorithms), partial consensus calls (e.g. those made by three or more algorithms) and the union of all calls (calls made by one or more algorithms). c ges also harmonizes quality scores from each algorithm to provide QC reports and publication quality plots cg esq c tool). c ges and cg esq c together form a multi-step pipeline and must perform multiple program invocations, as shown in. We use the Galaxy platform () to combine implementations for each branch of the pipeline and for c ges itself. Our use of Galaxy has the benefit of democratizing NGS data analysis, as Galaxy reduces the computational expertise needed to run an NGS pipeline and can run on public clouds such as those operated by Amazon Web Services, Google and Microsoft. The links to the Galaxy workflows can be found in Supplementary Table S4. We have applied the c ges consensus calling approach to real world exo me data collected on subjects with autism and their family members. We use the results of this study to demonstrate the power of the c ges approach and provide project level variant level sample level and family based quality metrics across all algorithms. Additionally, we provide known rare variant rediscovery rates, and an estimate of the PPV of each algorithm based on previously identified and lab validated de novo variation.

discussion we have presented a novel variant calling approach based on an ensemble of variant calling algorithms, which we call c ges. c ges uses a two stage voting scheme among four algorithm implementations to identify variant sites and determine genotypes. In addition to presenting the consensus approach, we have described its application to real world exo me data collected on a sample of autism trios and singletons. We provide project based sample based and variant based quality metrics across all algorithms, as well as an estimate of the PPV of each algorithm and c ges. Finally, we provide a galaxy based implementation of c ges and its constituent parts. Taken together, the results show that galaxy c ges provides a robust, flexible and user friendly approach to exo me sequence variant calling. Additionally, these results provide a strong rationale for further development of ensemble methodology in the analysis of NGS data. c ges is not limited to exo me data and could in principle be used for whole genome sequencing, although this application has not yet been tested. The full c ges consensus calling algorithm produced the highest quality output but the smallest number of genotypes: 139 897 sn vs in total in our example data. Leveraging the strengths of all callers produced a dataset with the highest ts tv ratio (3.02), the lowest v mer (0.92%), the lowest g mer (0.028%), the highest EVS rediscovery percentage (89.3%), the highest 1KG rediscovery percentage (84.1%), the highest gia b rediscovery rate (16.9%) and the highest de novo PPV (96.1%). Consensus approaches for NGS variant detection can be particularly useful when the downstream analysis (i.e. rare variant transmission distortion test (TDT), pathway analysis or de novo filtering) is reliant on a low false positive rate. However, there may be scenarios in which the preferred strategy is to maximize the rate of true positives even at the expense of a higher false positive rate: for example, when performing segregation analysis in large extended families. In that case, it may be more fruitful to use the union of all calls from all branches. Additionally, when identifying de novo variants one may wish to use the consensus of all calls in probands and the union of all calls in parents as an added stringency filter to reduce false positives. It is important to stress that there is no 'one size fits all' approach to sequencing analysis. The shift in the balance between type I and type II errors is inherent in the stringency with which a consensus dataset is created. Therefore, investigators are given the option of requiring any level of caller overlap (i.e. union of all calls, two caller consensus, three caller consensus or full consensus) simultaneously providing the lowest possible false positive and lowest possible false negative datasets. The best approach for variant calling depends entirely on the type of data and the downstream analytic plans. As new methods are continually being developed, it is our hope that this report, in conjunction with other consensus efforts (), will help set the tone for an open discussion on the importance of unifying different approaches. It is important to note the limitations of the analyses presented here. One important limitation is that the quality metrics from each branch are not directly comparable, as their optimization strategies differed. We optimized calling for each branch of c ges to reflect reasonable real world parameter decisions and not for the sake of a comparison among methods, which has been recently published (O'). For example, free bayes allowed us to set many parameters (Supplementary Methods) based on the raw data descriptive statistics and our previous sequencing experience. atlas snp2 on the other hand, offered relatively fewer parameter options (Supplementary Methods). As best practices have been published for GATKv2.8, we used these guidelines verbatim. Ultimately, the performance of each branch can differ dramatically based on parameters set by the user. Of course, the better the branch calls, the higher quality the final consensus calls will be. Additionally, it may be possible to use concordance between callers as a guiding metric when iterating to the optimal parameters for each branch. In addition to providing the description of the pipeline and the resultant data, we have provided multiple accessibility modalities. The code for the c ges and cg esq c algorithms is open source and available through git hub (Supplementary). For investigators who do not wish to invoke the command line, we have provided c ges and its constituent branches in a user friendly Galaxy environment. Finally, for researchers without institutional computational infrastructure, or simply for those who wish to outsource the computing but retain control over the scientific aspects of analysis, the pipeline is available and will be sustained through Globus Genomics (http://www.globus. org genomics. of Illinois, Chicago). The authors also wish to thank Steve Guter (UIC) for assistance with data management, Bo Lui for early work on Galaxy wrappers, Kelley Moore (UIC) and Kathleen Hennessy (UIC) for expert technical assistance, Braden Boone hai b Jack Wimbish hai b and Shawn Levey (HAI) for sequencing and expert advice. The authors are grateful to Erik Garrison for intellectual contributions on review of this manuscript and for technical advice pertaining to free bayes. L.K.D. also wishes to posthumously thank George Stephen kara theodor is for intellectual contributions to this work. The content is solely the responsibility of the authors and does not necessarily represent the official views of the National Institute of Health. The authors are grateful to Amazon Web Services, Inc., for an award of Amazon Web Services time that facilitated early experiments.
