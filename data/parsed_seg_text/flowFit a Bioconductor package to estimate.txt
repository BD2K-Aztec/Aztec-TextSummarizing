Herein we introduce flow fit a Bioconductor package designed to perform quantitative analysis of cell proliferation in tracking dye based experiments. The software, distributed as an R Bioconductor library, is based on a mathematical model that takes into account the height of each peak, the size and position of the parental population (labeled but not proliferating) and the estimated distance between the brightness of a cell and the brightness of its daughter (in which the dye is assumed to undergo a 2-fold dilution). Although the algorithm does not make any inference on cell types, rates of cell divisions or rates of cell death, it de convolute s the actual collected data into a set of peaks, whereby each peak corresponds to a subpopulation of cells that have divided N times. We validated flow fit by retrospective analysis of published proliferation tracking experiments and demonstrated that the algorithm predicts the same percentage of cells generation either in samples with discernible peaks (in which the peaks are visible in the collected raw data) or in samples with non discernible peaks (in which the peaks are fused together). To the best of our knowledge, flow fit represents the first open source algorithm in its category and might be applied to numerous areas of cell biology in which quantitative deconvolution of tracking dye based experiments is desired, including stem cell research. Availability and implementation:

introduction in cell proliferation tracking experiments, cells are stained before being cultured under various conditions with a fluorescent dye to follow proliferation kinetics. At each mitosis, the dye is roughly equally divided between daughter cells, so that each daughter is about half as fluorescent as the mother. At any given moment, therefore, the fluorescence intensity of a cell bears witness to its divisional history when compared with the intensity of the parental population in a typical experimental pipeline, cells are first labeled with a tracking dye, then allowed to proliferate (frequently in the presence of specific stimuli) and finally analyzed by flow cytometry by collecting data for (i) unlabeled cells (used as a negative control), (ii) unstimulated labeled cells (the non proliferating population) and (iii) sample(s) of labeled and stimulated cells (the proliferating populations). If the characteristics of the logarithmic amplifier on the flow cytometer are known, it is possible to derive, from a histogram of fluorescence intensity, the proportion of cells that have undergone any particular number of divisions (. Generally, a flow cytometer with 1024 channels (channels range) represents a nominal range of 4 log decades. Several fluorochromes have been used to track cell proliferation (), including dna binding fluorescent dyes (Hoechst 33342, thiazole orange), cytoplasmic ally distributed fluorescent dyes (calcein, 2 0 ,7 0bis2carboxyethyl56 carboxy fluorescein covalent coupling fluorescent dyes carboxy fluorescein succ in imi dyl ester, fluorescein isothiocyanate) and membrane inserting fluorescent dyes (PKH26, cell vue Lavander). Although each dye displays advantages and disadvantages for individual experimental purposes [reviewed in (, a common problem is represented by the quantification of the fluorescence signal: under optimal conditions some dyes [e.g. carboxy fluorescein diacetate succ in imi dyl ester (CFSE)] form separate peaks defining different proliferative generations, whereas others (e.g. PKH26) do not (). A good proliferation tracking algorithm should be able to give similar results in both cases. Here we introduce flow fit an R (R Development Core Team, 2012) Bioconductor library () that fits a set of peaks (corresponding to different generations of cells) to the histogram of fluorescence intensity acquired during a fluorescence activated cell sorting (FACS) experiment. The package is integrated with the Bioconductor libraries used for the analysis of flow cytometry datasets: flow core () and flow viz (). The performance of flow fit was evaluated by the retrospective analysis of a published dataset of dye tracking experiments (), in which lymphocytes were stained with three different proliferation tracking dyes: CFSE, cell proliferation dye e fluor 670 (CPD) and cell trace Violet (CTV). In particular, we meta analyzed a subpopulation of CD4 lymphocytes labeled with the three different staining reagents. The three samples were allowed to proliferate under identical growth conditions; however, differences in the characteristics of the dyes yielded rather different *To whom correspondence should be addressed. fluorescence histograms with different peak definitions (). flow fit was able to de convolute equally well in all situations and to estimate the same percentage of cells per generation under all conditions.

discussion the objective of this work was to provide an open source algorithm to quantify the proliferation of cells in tracking dye experiments. Of note, although the proliferation fitting algorithms currently available for this type of analyses mod fit LT TM , FCS Express and flow jo are commercial software, flow fit is already publicly available and published with the Artistic 2.0 License in the Bioconductor R framework. We provided statistical demonstration of the quality of the fitting with both in silico analysis and real dataset analysis. In particular, we demonstrated the intrinsic versatility of flow fit in providing reliable results in the analysis of samples with both discernible and non discernible peaks. At variance with mod fit LT TM , which uses a statistical analysis of the fluorescence histogram to identify potential peaks and a Gaussian model for the single peak, flow fit uses a levenberg mar quad t algorithm to minimize the difference between the observed data and the model, and uses a non gaussian formula (1) to define a peak. In addition, flow fit is fully integrated in the Bioconductor R framework. In recent years, several approaches, based on dye tracking, have been developed to identify and isolate adult stem cells (SCs) from normal and tumor tissues (e.g.). These methodologies rely on the fact that in the normal adult SC compartments cs divide asymmetrically to generate two daughter cells with opposite proliferative and different i ative fates: one of the two daughter cells retains the SC fate and withdraws into quiescence, whereas the other becomes a progenitor and enters a tumultuous phase of repeated symmetric divisions, required to expand the progenitor compartment, followed by terminal lineage differentiation. One characteristic of the SC compartment in cancer is that the cancer SCs tend to skip rounds of asymmetric division, in favor of symmetric divisions, after which both daughters divide again (). This leads to an expansion of the SC compartment. The 'rate of skipping' seems to be higher in poorly differentiated more aggressive tumors (). Methodologies to follow the kinetics of SC division in vitro and to compare the rate of symmetric versus asymmetric divisions are needed if we want to understand the biological bases of homeostasis of normal SC compartments and of how expansion of the SC compartment drives cancer growth and aggressiveness. We envision this as one of the major areas of application for flow fit. To this aim, the integration of flow fit with a stochastic model of cell proliferation based on a Gillespie algorithm will likely be required to analyze in real tumor tissues the proliferation kinetics of cancer SCs compared with that of their tumor progeny, and to compare proliferation data from these populations with relevant theoretical models of proliferation (for instance, models of asymmetric versus symmetric mode of division in the cancer SC versus the transient amplifying compartment of progenitors). This approach will probably be instrumental to identifying parameters in the stochastic model able to yield the best overlap between real data and simulations note Summary of in silico analysis: random samples with different levels of division peak quality (Supplementary Section 2.1). The maximum peak width that gives reliable results (Column: varying peak size, 017) correspond to a parent population with 75% of the events distributed across 25.7 channels (in a FACS with 1024 channels and 4 log decades), a 'peak size' of 0.4 corresponds to a parent population peak with 75% of the events distributed across 61.7 channels (in a FACS with 1024 channels and 4 log decades); random samples with different distribution of cells per generation (Supplementary Section 2.2): the percentage of samples that gives reliable results is depicted (Column: random samples).
