Motivation: Large phylogenies are being built today to study virus evolution, trace the origin of epidemics, establish the mode of transmission and survey the appearance of drug resistance. However, no tool is available to quickly inspect these phylogenies and combine them with extrinsic traits (e.g. geographic location, risk group, presence of a given resistance mutation), seeking to extract strain groups of specific interest or requiring surveillance. Results: We propose a new method for obtaining such groups, which we call phylo types from a phylogeny having tax a (strains) annotated with extrinsic traits. phylo types are subsets of tax a with close phylo-genetic relationships and common trait values. The method combines ancestral trait reconstruction using parsimony, with combinatorial and numerical criteria measuring tree shape characteristics and the diversity and separation of the potential phylo types. A shuffling procedure is used to assess the statistical significance of phylo types. All algorithms have linear time complexity. This results in low computing times, typically a few minutes for the larger data sets with a number of shuffling steps. Two HIV-1 data sets are analyzed, one of which is large, containing 43000 strains of HIV-1 subtype C collected worldwide , where the method shows its ability to recover known clusters and transmission routes, and to detect new ones. Availability: This method and companion tools are implemented in an interactive Web interface www phylo type org which provides a wide choice of graphical views and output formats, and allows for exploratory analyses of large data sets.

introduction phylogenetic tools are commonly used to study virus evolution (), trace the origin of epidemics (), establish the mode of transmission (), survey the apparition of drug resistances () or determine virus origin in different body compartments (). The process involves the construction of phylogenetic trees, their visualization (e.g.) and their interpretation. Ancestral character reconstruction methods aid the interpretation, as extrinsic traits and their evolution can be mapped on the tree. Parsimony has been one of the first approaches to reconstruct ancestral characters. This method is remarkably fast, does not require any model assumption and is implemented in several popular phylogenetic programs (e.g. mac clade. More sophisticated, model based maximum likelihood (ML) and Bayesian methods were developed for reconstructing ancestral characters (e.g. sim map. These methods are generally accepted to be more accurate than parsimony and account for various sources of uncertainty. However, they are time consuming with large data sets and require a realistic evolutionary model to be available for the trait being considered. This is not an easy step, even with standard traits such as geographic location or morphological characters. Despite the number of methods available for the inference of ancestral traits, there is little development for the interpretation of trait annotated phylogenies. Most of the programs display the reconstructed ancestral states but do not allow for tests on ancestry and tax on clustering. For example, mac clade reconstructs ancestral characters and maps them in the phylogeny, but the resulting annotated tree needs to be interpreted visually. Other ML and Bayesian programs, such as BEAST (), simultaneously reconstruct ancestral states and the phylogeny, and allow for testing. However, because of this simultaneous reconstruction, they need to be re-launched entirely when new traits are analyzed, which, combined with their computational heaviness, renders it difficult in the exploratory stages to select relevant traits for the data at hand. Moreover, model based programs are mostly intended to specific trait types (e.g. geographical location, leme y et al., 2009, or molecular characters with sim map. Finally, most (if not all) of ML and Bayesian programs are not able to deal with the huge amount of virus sequences available today, with data sets commonly comprising several thousand strains. There is a need for a fast easy to use exploratory tool that can use phylogenies constructed with any of the most popular methods, while providing fast inference of ancestral traits and enabling hypothesis testing and visual data interpretation of evolutionary scenarios. In this article, we use and formally define, the concept of ''viral phylo type. Commonly, a phylo type is a biological type that classifies an organism by its phylogenetic *To whom correspondence should be addressed.  The Author 2013. Published by Oxford University Press. This is an Open Access article distributed under the terms of the Creative Commons Attribution License (http://creativecommons.org/licenses/by/3.0/), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited. relationship to other organisms. The term phylo type is tax on neutral thus one can choose the phylogenetic level at which the phylo type is described, depending on the question being examined. The term is commonly used in microbiology, and several tools have been developed to infer bacteria phylo types (e.g. RAMI,) or to study them from an ecological perspective (e.g. Picante,, for analyzing the phylogenetic and trait diversity of ecological communities). Here we adopt a more specific virus view, combining (ancestral) traits with combinatorial and numerical criteria measuring tree shape characteristics and the diversity and separation of the phylo types. Traits of extant and ancestral nodes are used to assess the relevance of phylo types for the question being addressed. Numerical criteria are analogous to those used to define and study bacteria phylo types. This method is implemented in phylo type a user friendly Web interface that uses parsimony to reconstruct ancestral traits and a number of criteria to select phylo types. A shuffling procedure is used to assess the significance of this selection process. The method is fast, allowing for the analysis of phylogenies comprising several thousands of tax a (strains). In the following, we describe the method and the Web interface, then show its application on two data sets, dealing with the epidemiological history of HIV-1 subtype A (HIV-1A) in Albania (), and the global epidemic of HIV-1 subtype C (HIV-1C) using a large data set comprising $3000 strains collected worldwide ().
