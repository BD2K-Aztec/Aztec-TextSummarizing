Motivation: During the past decade, new classes of non-coding RNAs nc rnas and their unexpected functions were discovered. Stable secondary structure is the key feature of many non-coding RNAs. Taking into account huge amounts of genomic data, development of computational methods to survey genomes for structured RNAs remains an actual problem, especially when homologous sequences are not available for comparative analysis. Existing programs scan gen-omes with a fixed window by efficiently constructing a matrix of RNA minimum free energies. A wide range of lengths of structured RNAs necessitates the use of many different window lengths that substantially increases the output size and computational efforts. Results: In this article, we present an algorithm rna surface to efficiently scan genomes by constructing a matrix of significance of RNA secondary structures and to identify all locally optimal structured RNA segments up to a predefined size. rna surface significantly improves precision of identification of known ncRNA in Bacillus subtilis. Availability and implementation: rna surface C source code is available from

introduction rnas perform diverse enzymatic, regulatory and structural functions in living cells and are involved in nearly all housekeeping cellular processes. Numerous new classes of non-coding and regulatory RNAs were discovered during past decades. For example, microRNAs regulate gene expression through post-transcriptional repression of messenger RNA (). Other prominent examples include the RNA role in translation (), messenger RNA localization (), alternative splicing (), epigenetic states (), virus replication () and so forth. Moreover, according to recent studies of the human genome, up to 90% of the genome may be transcribed, and a substantial fraction of transcripts may represent functional non-coding RNAs (). Biological function of the majority of functional RNAs crucially depends on its tertiary structure. RNA molecules fold hierarchically and sequentially, therefore the tertiary structure is largely determined by the secondary structure scaffold (). For example, ribo switches regulate gene expression by switching between two specific secondary structures (). There exist numerous methods to predict secondary structure computationally (for a review see), among which free energy minimization () based on nearest neighbor thermodynamic parameters () is the most prevalent approach. Generally, RNA sequences have numerous suboptimal structures, which have energies close to the optimal one (). In addition to this, inaccuracies of the energy parameters, base modifications and dependence on cell conditions yield a moderate quality of the structure prediction by energy minimization with the average sensitivity of 75% and selectivity of 79% (). However, the optimal energy could be a good measure to define propensity of a sequence to fold in a stable structure, the minimum free energy (MFE) of functional RNAs can be distinguished from that of random sequences (). On the other hand, there exist RNA regions actively bound by protein factors. Relatively low MFE, due to selection against formation of stable secondary structure, may represent a signal of an accessible site (). Structural potential of an RNA sequence reflects significance of its secondary structure MFE. next generation sequencing technologies produce vast amounts of genomic data. Hence, identification in genomes of segments with unusual structural potential is of special interest. This problem has two sides: to efficiently scan genomes and to assess significance of output hits. There are several programs that efficiently scan genomes. rn all () and rna slider () use a window based approach to calculate the MFE and structure of each local sequence of a predefined size. rnal fold () slightly diminishes the output size by considering only structures with paired first and last nucleotides, so called closed structures. These programs focus on efficient computing and ignore significance of output hits. The only discriminator in these programs is MFE. However, MFE strongly depends on the length and dinucleotide composition of a sequence (). Comprehensive comparison of RNA structure scores (shows that *To whom correspondence should be addressed.  The Author 2013. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals permission soup com Z-score () can be used as a suitable measure of the structural potential. The Z-score of a sequence is calculated as where E is the MFE of a biological sequence, and are the average and standard deviation of the energy distribution of shuffled sequences with preserved length and average dinucleotide composition. There also exists a less common approach, which uses uniqueness of secondary structure instead of thermodynamic stability to assess its significance (). An early attempt to detect significant structures was based on a Monte Carlo simulation (). This approach becomes impractical for sequences of moderate (several thousand of nucleotides) size. Further studies introduced look-up tables to eliminate bias of nucleotide composition, combined with regression on sequence length () or the notion of asymptotic Z-score (). The current state of the art program rnal fold z () extends rnal fold by calculating Z-score using SVR. To our knowledge, the implementation of rnal fold z is now embedded in rnal fold. Approaches, that analyze RNA segments of a fixed size, suffer from an inability to detect structured elements of varying sizes, whereas functional RNAs fall into a wide range of sizes. Here, we circumvent this limitation. To that end, we define the surface of the structural potential as the surface of z scores for all genome subsequences shorter than a predefined size visualizes this concept. The line at the bottom represents a segment of the genome, each point on the heat map represents a subsequence and color represents structural potential of this subsequence (from highly structured dark blue to highly non structured dark red). We introduce the program rna surface that efficiently reconstructs the surface of structural potential using a new fast algorithm for Z-score evaluation. This approach introduces an intuitively clear definition of locally optimal segments as peaks in the surface of structural potential. Besides identification of structured regions, the surface usage allows one to identify structured domains comprising the region. We apply our method to the genome of Bacillus subtilis and identify genome regions with high structural potential. A highly accurate determination of structured intervals or regions of accessibility is useful for several purposes: preprocessing during de novo search for regulatory and noncoding RNAs; accurate definition of ncRNA boundaries; and correlation of genome scale structural potential with other genomic features (gene boundaries, ribosome profiling, transcriptome data, binding sites of protein factors etc.).
