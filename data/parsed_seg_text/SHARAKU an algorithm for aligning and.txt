Motivation: Deep sequencing of the transcripts of regulatory non-coding RNA generates footprints of post-transcriptional processes. After obtaining sequence reads, the short reads are mapped to a reference genome, and specific mapping patterns can be detected called read mapping profiles, which are distinct from random non-functional degradation patterns. These patterns reflect the maturation processes that lead to the production of shorter RNA sequences. Recent next generation sequencing studies have revealed not only the typical maturation process of miRNAs but also the various processing mechanisms of small RNAs derived from tRNAs and snoRNAs. Results: We developed an algorithm termed sha raku to align two read mapping profiles of next generation sequencing outputs for non-coding RNAs. In contrast with previous work, sha raku incorporates the primary and secondary sequence structures into an alignment of read mapping profiles to allow for the detection of common processing patterns. Using a benchmark simulated dataset, sha raku exhibited superior performance to previous methods for correctly clustering the read mapping profiles with respect to 5 0-end processing and 3 0-end processing from degradation patterns and in detecting similar processing patterns in deriving the shorter RNAs. Further, using experimental data of small RNA sequencing for the common marmoset brain, sha raku succeeded in identifying the significant clusters of read mapping profiles for similar processing patterns of small derived RNA families expressed in the brain. Availability and Implementation: The source code of our program sha raku is available at http:// www.dna.bio.keio.ac.jp/sharaku/, and the simulated dataset used in this work is available at the same link. Accession code: The sequence data from the whole RNA transcripts in the hippocampus of the left brain used in this work is available from the DNA DataBank of Japan (DDBJ) Sequence Read Archive (DRA) under the accession number DRA004502.

introduction since high throughput sequencing allows for deep sequencing with high sensitivity, RNA sequencing with a next generation sequencer rnase q can detect not only the complete expression patterns of transcribed RNAs but also fragments derived due to the splicing, maturation processing, or non-functional degradation of the RNAs. rnase q studies targeting microRNAs (miRNAs) have revealed the existence of many different RNA fragments derived from small RNA species other than microRNA, providing further proof that derived RNA fragments are not simply random degradation products but are rather stable entities, which might have functional activity (). The evidence accumulating about shorter sequences or fragments derived from non-coding RNAs indicates that post-transcriptional processes are relatively common mechanisms to derive functional smaller molecules from various RNA families such as tRNAs and snoRNAs. For example, the so called trna derived RNA fragments tr fs are derived from processing at the 5 0 or 3 0-end of mature or precursor tRNAs (). These sequences constitute a class of short RNAs that are the second most abundant type of RNA after miRNAs. Since the discovery of small RNAs derived from tRNAs, a variety of names have been used to refer to similar entities, such as trna derived RNA fragments tr fs (), stress induced small RNAs ti rnas () and trna derived small RNAs ts rnas (). Their uniform start and stop sites of cleavage in tRNA, together with their nonrandom size property, strongly suggest that tr fs are derived from tRNA cleavage in a specific and regulated manner (). In addition, several studies have identified a class of small fragments derived from snoRNAs (called sd rnas some of which may regulate splicing or translation (). The biological roles of such sno derived RNA and trna derived small RNAs have primarily been investigated in cancer cells (). trna derived fragments participate in several types of biological processes, including as signal molecules in a stress induced response and as regulators of gene expression. sd rnas can function as miRNAs, regulators of alternative splicing, and tumor suppressors and oncogenes. The reads for such short derived RNAs are relatively abundant, i.e. greater than background levels, in small rnase q datasets. Chen and Heard (2013) pointed out that 'these reads are precisely mapped to specific regions of primary or secondary structures, and might contain special motifs or base biases, reflecting the involvement of special enzymes involved in their generation'. Hence, mapping a large amount of sequence reads onto a reference sequence can reveal specific forms of mapping patterns for the maturation process or random patterns for non-functional degradations see a. These mapping patterns of rnase q short reads constitute the so called read mapping profiles see b ().also pointed out that the non-specific degradation products include RNA fragments that are rapidly digested by the surveillance machinery from RNA molecules, which are defective in processing, folding and functions. Thus, it is crucial to reliably distinguish the true shorter RNAs from their non-functional degradation products to clearly identify derived and functional small RNAs and fragments. Therefore, the aim of the present study was to develop a computational tool for the comprehensive analysis and rapid identification of the post-transcriptional processing patterns of non-coding RNAs based on high throughput rnase q data. The algorithm developed in this study was designed to capture specific forms of read mapping patterns mapped to specific regions of primary or secondary structures reflecting the functional activities of enzymes, and to distinguish them from non-functional degradation products. There are only a few existing tools () to analyze such read mapping profiles of rnase q data and detect footprints of the post-transcriptional processes or degradations of RNAs. fla i mapper () predicts and annotates non-coding rna derived fragments by determining the start and stop positions from read mapping profiles. fla i mapper can predict miRNA boundaries with high accuracy. deep block align (), which our present study takes quite a similar approach to, is an alignment based method for alignments of read mapping profiles to find non-coding derived RNAs that share similar post-transcriptional processing. ALPS () is also alignment based but is not designed for the purpose of identification of short derived RNA fragments. block clust () computes a similarity score between read mapping profiles to detect similar processing patterns and cluster read mapping profiles. block clust includes a high dimensional feature representation to encode read mapping profiles and calculates the similarity scores based on a graph kernel. Therefore, block clust does not rely on alignment based techniques and is not designed for the purpose of calculating the alignment of read profiles. However, all of these methods are computed based only on the information of read mapping profiles and do not take the RNA sequence and secondary structure information into account. Further, those methods did not address the reliable distinguish ability of processing patterns from the random degradation. Constructing an alignment for a pair of biological sequences such as DNA, RNA and protein sequences is a fundamental and robust method of sequence analysis (). The pairwise alignment of biological sequences is achieved according to insertions, deletions and match operations so that the two sequences are aligned with the same column length. The similarity score of an alignment is calculated according to the predefined scores for insertions, deletions and matches. Similarly, one can define the alignment between a pair of read mapping profiles see can alignment of two read mapping profiles for SNORD14 and SNORD21 output by sha raku using the small rnase q data for the common marmoset brain with the annotations of RNA sequence alignment and the predicted secondary structure. The solid line represents the read coverages of SNORD14, and the dashed line represents the read coverages of SNORD21. (d) Schematic illustration of the necessity of incorporating the primary and secondary structures of RNA sequences into an alignment in previous work with the deep block align algorithm (), the alignment program was designed to compare and align any read mapping profiles regardless of the RNA family to which they belong. The alignment program was also applied to the comparison of read mapping profiles of the same RNA gene across different samples that might be expected to induce different read mapping profiles (). This method is effective for the differential processing analysis of read mapping profiles of each non-coding RNA gene. In contrast with previous work, our primary goal was to detect specific forms among similar read mapping patterns mapped to specific regions of primary or secondary structures reflecting the functional activities of enzymes by alignments of read mapping profiles, and to distinguish these from non-functional degradation products. We developed a new read mapping profile alignment program named sha raku which incorporates the primary and secondary structures of RNA sequences into an alignment of read mapping profiles. This is accomplished in combination with DAFS, a program for the simultaneous aligning and folding of RNA sequences (). As a result, the most advanced feature of sha raku is that it simultaneously aligns the read mapping profiles and RNA sequences with the folding RNA secondary structures. Since each type of derived RNA fragments is cleaved from its precursor with a specific context of primary sequence and secondary structure, we can expect that the simultaneous alignment of read mapping profiles with the primary and secondary structures contributes to precise identifications of the type of derived RNAs. Thus, application of sha raku to the mixture of different RNA families would enable the accurate clustering of read mapping profiles with respect to 5 0-end processing or 3 0-end processing of each RNA family, and facilitate the detection of common processing patterns shared among different RNA families (see(d)). Note that sha raku was not designed for classification of RNA sequences into different RNA families. Further, sha raku produces an alignment of read mapping profiles at the nucleotide level resolution, as(c) displays. In contrast, deep block align uses blockbuster () to generate block groups and aligns any read mapping profiles at the level of individual blocks and block groups, including those in unannotated regions or unknown RNA genes. On the other hand, the current version of sha raku can only be applied to the annotated non-coding RNA regions. Several previous studies () have explored the similarities and evolutionary relationships between snoRNAs and miRNA precursors. These similarity features represent molecules involved in the same processing pathways with a similar set of processing enzymes and the same RNAi targets. These similarity features are often confirmed based on the conservation of their primary and secondary structures, such as structural characteristics of typical H/ACA or C/D boxes. We hypothesized that in addition to sequence structure conservation, determining the similarity among read mapping profiles might help to identify the functional or processing similarities between snoRNAs and miRNA precursors.

discussion several previous studies () have explored the similarities and evolutionary relationships between snoRNAs and miRNA precursors. As a result, various relationships between snoRNAs and miRNAs have been identified, from 'snoRNAs with miRNA features' to 'dual function sno mirnas and 'miRNAs with snoRNA features'. These similarity features represent molecules involved in the same processing pathways with a similar set of processing enzymes and the same RNAi targets. These similarity features are often confirmed based on the conservation of their primary and secondary structures, such as structural characteristics of typical H/ACA or C/D boxes. We hypothesized that in addition to sequence structure conservation, determining the similarity among read mapping profiles might help were added to the hybridization chamber and incubated with the blots. The membrane was then exposed to a phospho imager and scanned. The largest band appearing at a distance just short of the 100-nt marker indicates the expression of the origin tRNA from which the short fragment RNA was derived sha raku i375 to identify the functional or processing similarities between snoRNAs and miRNA precursors. An interesting small cluster in the clustering tree shown in highlighted with an arrow and asterisk) consisted of a mixture of snoRNAs, miRNAs and tRNAs. In particular, we found that the snoRNA 'HBII-52' and the miRNA 'let-7a' have quite similar features in their secondary structures and read mapping profiles, indicating a similar processing mechanism to produce the derived shorter fragments at 3 0ends shows these features. Indeed, small derived RNAs from HBII-52 were previously reported to resemble miRNAs (). Another interesting cluster is cluster (6) of the 5 0-end processing of miRNAs. The cluster contained two tRNAs. prot gg trna has the typical mirna like secondary structure and miRNA/ miRNA* duplex, shown in. Supporting this result, previous work has indicated possible cross-talk between trna derived RNA fragments and the canonical pathway of miRNAs (). Thus, the alignments and clustering of read mapping profiles using sha raku can give insight into revealing the common processing patterns in different families of non-coding RNAs and their derived fragments, which could help to clarify the processing pathways and biological functions of derived RNA fragments. One of the merits of sha raku is to calculate the optimal alignment based on not only the pattern of read mapping profiles, but also primary and secondary structures of RNA sequences. Since each type of derived RNA fragments is cleaved from its precursor with a specific context of primary sequence and secondary structure, we can expect that the simultaneous alignment of read mapping profiles with the primary and secondary structures contributes to precise identifications of the type of derived RNAs. To combine the pattern of read mapping profiles and the primary and secondary structures of RNAs, a sankoff type algorithm is required to be implemented. We implemented sha raku with DAFS framework, which enabled to efficiently combine the pattern of read mapping profiles and the primary and secondary structures of RNAs by the dual decomposition technique. In the present study, we have only dealt with annotated noncoding RNAs. However, sha raku can also be applied to the alignment and clustering of novel and unannotated regions by employing tools such as blockbuster () in order to determine the expressed block regions on the reference genome that are obtained from rnase q reads. As non-functional degradation products, we only considered the degradation of RNA from the 3 0-end in the simulated dataset. Therefore, performance evaluations of sha raku to determine the tolerance for the other two classes of rna degradations endonucleases and 5 0 exonuclease s are required. These issues will be addressed in our future work.) and annotations with lines indicating the predicted locations of deriving fragments for a snoRNA 'HBII-52' and a miRNA 'let-7a' found in the clusters. The line for miRNA secondary structure indicate the predicted locations of the mature miRNA. The secondary structures predicted by rna fold and annotations, with lines indicating the locations of derived fragments for a tRNA prot gg trna and an miRNA 'let-7b' found in the cluster of the 5 0-end processing of miRNAs. The line for miRNA secondary structure indicates the predicted locations of the mature miRNA i376 m tsuchiya et al.

conclusion with the aim of offering computational tools for comprehensively analyzing the post-transcriptional processing patterns of non-coding RNAs and detecting their common processing patterns, based on rnase q we developed a new algorithm called sha raku to align two read mapping profiles of next generation sequencing data for non-coding RNAs. sha raku incorporates the primary and secondary structures of RNA sequences into an alignment of read mapping profiles by combining with DAFS, which constructs reliable structural alignments that maximize the expected accuracy of a predicted common secondary structure and its sequence alignment. sha raku could simultaneously align the read mapping profiles and RNA sequences with information of the folded RNA secondary structures. In an experiment using a simulated dataset, sha raku achieved an almost perfect clustering result, and exhibited higher accuracy than deep block align. In an experiment with real data of small RNA sequencing for the common marmoset brain, sha raku succeeded in identifying the five major clusters plus four scattered clusters representing typical processing patterns. This method also revealed some interesting clusters consisting of mixtures of several RNA families that predicted common processing patterns among different RNA families. These results demonstrate that sha raku can be an indispensable tool for analyses of the processing patterns and functions of regulatory non-coding RNAs with deep sequencing data.
