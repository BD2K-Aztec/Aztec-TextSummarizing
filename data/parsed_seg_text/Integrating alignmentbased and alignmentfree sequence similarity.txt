Motivation: alignment based sequence similarity searches, while accurate for some type of sequences, can produce incorrect results when used on more divergent but functionally related sequences that have undergone the sequence rearrangements observed in many bacterial and viral genomes. Here, we propose a classification model that exploits the complementary nature of alignment based and alignment free similarity measures with the aim to improve the accuracy with which DNA and protein sequences are characterized. Results: Our model classifies sequences using a combined sequence similarity score calculated by adaptively weighting the contribution of different sequence similarity measures. Weights are determined independently for each sequence in the test set and reflect the discriminatory ability of individual similarity measures in the training set. Because the similarity between some sequences is determined more accurately with one type of measure rather than another, our classifier allows different sets of weights to be associated with different sequences. Using five different similarity measures, we show that our model significantly improves the classification accuracy over the current composition and alignment based models, when predicting the taxonomic lineage for both short viral sequence fragments and complete viral sequences. We also show that our model can be used effectively for the classification of reads from a real meta genome dataset as well as protein sequences. Availability and implementation: All the datasets and the code used in this study are freely available at https://collaborators.oicr.on.ca/vferretti/borozan_csss/csss.html.

introduction sequence comparison of genetic material between known and unknown organisms plays a crucial role in meta genomic and phylogenetic analysis. Sequence similarity search is a method of sequence analysis that is extensively used for characterizing unannotated sequences (). It consists of aligning a query sequence to a sequence database with the aim of determining those sequences that have statistically significant matches to that of the query. In this way, for example, a known biological function or taxonomic category of the closest match can be assigned to the query for its characterization. alignment based methods, however, can produce incorrect results when applied to more divergent but functionally related sequences that have undergone sequence rearrangements. Sequence rearrangements such as genetic recombination and shuffling or horizontal gene transfer are observed in a variety of organisms including V C The Author 2015. Published by Oxford University Press.

discussion sequence comparison is at the core of many bioinformatics applications such as meta genomic classification, protein sequence and function characterization and phylogenetic studies to name a few. In many of these applications, the alignment based sequence comparison is widely used, but this does not come without some limitations. One important limitation is that the alignment based similarity measure might give erroneous information when used with sequences that have undergone some type of sequence rearrangement. alignment free similarity measures offer an alternative to the alignment based ones in that they are unaffected by such genetic processes. In this study, we propose a model that combines similarity scores obtained with alignment based and alignment free sequence similarity measures] to gain additional discriminatory information about sequences and to improve their characterization. In Tables 1 and 2, we present that our approach performs better than most of the other methods used in this study when predicting genera of unknown viral sequences (i.e. sequences that are not part of the training set as described in Dataset I) or when predicting phyla of meta genomic sequences. The main conceptual difference between the CSSS model and the other classification methods used in this study, at the exception of phy mm bl is that the CSSS model combines similarity scores obtained with both the alignment based and the alignment free sequence similarity measures, while the other models rely on either one of these two approaches. Thus, NBC (), rai phy () and phylo pythias () rely on the alignment free composition based approaches (using km er frequencies or km er counts) and p aud a () relies on the alignment based approach and Kraken () on the exact alignment of km ers. Although in some respects, our approach is similar to that of phy mm bl since both methods combine scores calculated using different types of similarity measures phy mm bl uses BLAST scores and IMMs scores (, there are two main differences that can explain the results obtained with Dataset I shown in. First, the CSSS model uses four different similarity measures, so that if sufficiently independent one from another, their combined additive effect could confer a greater discriminatory power than the two similarity scores combined by phy mm bl. In supplementary in Supplementary Data, we show the classification accuracy of individual similarity measures used by CSSS and phy mm bl models as a function of the viral fragment length. Although the classification performance of the ED [see equation 3 and JSD] measures are very similar, the classification performance of the CB [see] measure drops rapidly below 10% as the length of viral fragments decreases. If, however, we perform the classification on full length viral genomes (see Section 2.3.1) we find that the CB measure improves the performance by as much as 5.79% when combined with the other three measures (ED, JSD and BLAST). This shows that the CB measure contains significant additional information, only for sequences that are similar in length to those in the training set, that is complementary to the information contained by the other three measures. This drop in performance of the CB measure as a function of the fragment length, relative to the length of the genomes in the training set, explains also the smaller difference in performances observed between the CSSS and phy mm bl models when classifying longueur reads in Dataset II (see Section 2) shown in. Since the ED and JSD measures show similar classification performances, we investigated the degree of independence of these two measures by performing a principal components analysis pc a of the similarity scores obtained using viral genomes from Dataset I. We found that the first component (i.e. PCA1) is strongly associated with the ED measure in test samples, while the second component (i.e. PCA2) is strongly associated with the JSD measure, a result that is independent of the viral fragment length as shown in supplementary in Supplementary Data. These results indicate that these two measures can be considered as orthogonal and thus not correlated, with the ED measure accounting for most of the variation across viral genomes in test samples. To further determine the effect of these two measures on the classification performance, we removed each measure from the model one at the time and then recalculated the accuracy scores. We found that for full viral genomes, the effect of removing the ED measure reduced the classification performance significantly by 5%, while removing the JSD measure reduced it only slightly (0.25%). However, in the case of shorter viral fragments, dropping either one of these two measures from the model did not produce any significant change to the performance, while removing both produced a significant drop in performance (up to 3% for 1000 bp reads). In the light of these results, we conclude that both of these measures contain complementary information that is useful for characterizing viral sequences. The second important difference between our model and phy mm bl is in the weighting scheme used. In the phy mm bl model, the weights assigned to each similarity measure (i.e. combined score  IMM  1.2(4-log(E)), where IMM is the score of the best matching IMM and E the smallest E-value returned by BLAST) have the same value for all test examples, in the CSSS model weights are determined independently for each test example based on the discriminatory ability of each measure using the training set [see Equation (9)]. Having different sets of weights for different test, samples (i.e. test sequences) should improve the classification performance since some sequences will be better characterized with one type of similarity measure than another. Another important difference between these two methods is in the classification performance using BLAST results alone. As shown in Supplementary Tables S4S6 in Supplementary Data, we found that a significant improvement in classification is obtained when the BLASTN algorithm is used instead of mega blast the algorithm used by phy mm bl. BLASTN is more sensitive than mega blast because it uses a shorter word size (default value of 11) that makes it better at finding related nucleotide sequences between more divergent biologically sequences since the initial exact match can be shorter. We found that for very short viral fragments (100 bp in length), the CSSS model performs better than phy mm bl and achieves slightly better accuracy (but not significant P value  0.13, using the two sample t test than the NBC model, as shown in. By examining the individual performance of the sequence similarity measures used by the CSSS model, we found that the composition based and CB similarity measures are more affected by the shorter fragment size than the alignment based one, as shown in Supplementary Table S6 in Supplementary Data. Despite this drop in performance (of the composition based and the CB similarity measures) for short 100 bp viral fragments, by virtue of combining different similarity measures the CSSS model still achieves better performance than the alignment based method p aud a (P value  0.008, using the two sample t test or the hybrid phy mm bl phy mm  BLAST) (P value  0.0001, using the two sample t test and performs equally well as the best composition based model used in this study, namely NBC. In Section 3, we have shown that our approach can also be used effectively for protein sequence classification. In, we show that our model outperforms a similar but simpler lzw blast 1NN model (). The main differences between these two approaches are the number of similarity measures used frequency based measures such as those given in Equations (3) and 5 were not used in, a different method with which similarity measures are combined and SW scores (P values) instead of BLAST scores. Without using a weighting scheme, the lzw blast method uses a simple multiplication rule to combine the LZW and BLAST scores (). We found that the multiplication rule used in performs significantly better in combination with an SVM rather than a NN classifier. The model proposed in this study performs better than the SVM lzw blast model reported in and slightly better than the 1-NN (SW P value) as shown in. We attribute this smaller gain in classification performance to the short protein sequences in Dataset III, which pose a greater challenge to the three alignment free similarity measures examined in this study. As shown in Equation (9), our model combines similarity scores using a linear combination of vectors (equivalent to calculating a weighed arithmetic mean of scores obtained with each individual similarity measure). We did explore combining similarity scores using a different multiplicative model which we found to significantly under-perform (in combination with the NN classifier) when used on datasets presented in this study. Finally, our approach can be easily extended to any number of additional similarity measures (such as the IMMs used by phy mm bl that might produce additional gain in discriminatory information about sequences and thus improve the overall classification performance. Therefore, future work will include assessing the performance of additional similarity measures that could be integrated into our model.
