Motivation: Functional mapping that embeds the developmental mechanisms of complex traits shows great power to study the dynamic pattern of genetic effects triggered by individual quantitative trait loci (QTLs). A full sib family, produced by crossing two heterozygous parents, is characteristic of uncertainties about cross type at a locus and linkage phase between different loci. Integrating functional mapping into a full sib family requires a model selection procedure capable of addressing these uncertainties. 3FunMap, written in VC++ 6.0, provides a flexible and extensible platform to perform full sib functional mapping of dynamic traits. Functions in the package encompass linkage phase determination, marker map construction and the pattern identification of QTL segregation, dynamic tests of QTL effects, permutation tests and numerical simulation. We demonstrate the features of 3FunMap through real data analysis and computer simulation.

introduction many traits important in agriculture, biology and medicine change with time or other independent variables. The genetic control of these dynamic complex traits should be accordingly expressed as a function of the independent and continuous variable (). A new breakthrough in mapping the dynamic change of quantitative trait locus (QTL) effects has been recently made through the invention of a series of statistical models, called functional mapping (). Functional mapping integrates mathematical aspects of trait development into a QTL mapping framework, enabling geneticists to test the interplay between gene action and development packed functional mapping into a web based platform, fun map for a mapping population derived from inbred lines. fun map can not be applied directly to a full sib family produced by crossing heterozygous parents. Inevitably, such a single full sib family that may generate an almost unlimited number of progeny has been commonly used for QTL mapping in outcrossing species, like forest trees and wildlife species (). Since several assumptions essential for linkage mapping, including a fixed marker cross type known linkage phase and known parental origin * To whom correspondence should be addressed. of QTL alleles, do not exist in outcrossing populations, a model selection procedure should be implemented to make an inference about these uncertainties from observed marker and phenotypic data. Here, we report a new package of Windows software, 3FunMap, which conducts functional mapping of dynamic QTLs segregating in a full sib family derived from two heterozygous parents. Since the genotypes of the two parents are unknown, the segregation of a QTL in a full sib family may obey the following possible types: full cross (segregating 1:1:1:1), pseudo f 2 cross (segregating 1:2:1) and pseudo backcross (segregating 1:1). By incorporating model selection criteria, such as Akaike Information criterion (AIC) and Bayesian information criterion (BIC), 3FunMap can discern an optimal segregation type based on a given dataset, thus meeting the urgent need for analysis tools of functional mapping capable of handling the complexities of genetic segregation associated with crossed heterozygous parents. The software integrates a comprehensive suite of biological merits of functional mapping in terms of testing and estimating the developmental pattern of genetic effects triggered by dynamic QTLs. The software enables users to test when a QTL is switched on to perform its function, when the QTL is switched off to cease the function, how long it is expressed in a time course and with which temporal pattern is the QTL effect operational? Wu and Lin (2006) classified four temporal patterns of genetic expression for a QTL, i.e. long, early, late and inverse. By asking and addressing biologically meaningful questions, 3FunMap will help to better understand the genetic and developmental architecture of complex traits.

discussion we described a Windows software, 3FunMap, to perform functional mapping in a full sib family by considering unique outcrossing characteristics of heterozygous parents. With 3FunMap, users can construct an integrative linkage map by using all types of molecular markers (), map specific QTLs that govern dynamic changes of a complex trait, select an optimal type of QTL segregation and estimate the temporal pattern of genetic effects triggered by individual QTLs. To our best knowledge, this is a first package of software that can handle dynamic QTL segregation in a full sib family in a comprehensive way. It equips breeders and geneticists for outcrossing species with a powerful tool to dissect the genetics of dynamic complex traits. 3FunMap has incorporated a function to run simulation studies to investigate the statistical behavior of functional mapping for a full sib family. Results from computer simulation under different heritability levels and sample sizes (Supplementary Material 4) suggest that a modest heritability (H 2 = 0.1) would provide a reasonably accurate estimate of the genetic control of trait trajectories when a sample size n = 400 is used. It is important to emphasize that a better management of plants that minimizes environmental and phenotyping errors may be more useful for the enhancement of QTL mapping precision than augmenting the size of roughly managed samples. We also tested model misspecification by simulating and analyzing data reciprocally using different segregation models. Under H 2 = 0.1 and n = 400, 3FunMap has full power to identify a correct model. We recognize the importance of epistasis in trait control. Epistasis has been incorporated into our software. For a single QTL model, 3FunMap uses 20 min on a PC desktop to draw the LR profiles for the Populus example shown in. Yet, computing time on for epistatic detection for a full sib family increases exponentially because there are many combinations of segregation types between any two QTLs. Also, two full cross QTLs produce 16 genotypes,
