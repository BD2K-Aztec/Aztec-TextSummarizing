Motivation: In recent years, there has been an increasing interest in the potential of codon substitution models for a variety of applications. However, the computational demands of these models have sometimes lead to the adoption of oversimplified assumptions, questionable statistical methods or a limited focus on small data sets. Results: Here, we offer a scalable, message passing interface based Bayesian implementation of site heterogeneous codon models in the mutation selection framework. Our software jointly infers the global mutational parameters at the nucleotide level, the branch lengths of the tree and a Dirichlet process governing across site variation at the amino acid level. We focus on an example estimation of the distribution of selection coefficients from an alignment of several hundred sequences of the influenza PB2 gene, and highlight the site specific characterization enabled by such a modeling approach. Finally, we discuss future potential applications of the software for conducting evolutionary inferences. Availability and implementation: The models are implemented within the phylo bayes mpi package, (available at phylo bayes org along with usage details in the accompanying manual.

introduction there is growing interest for the use of codon substitution models in several contexts, including phylogenetic inference (), ancestral sequence reconstruction () and the characterization of the selective effects of specific nonsynonymous mutations (). Focusing on the latter, Halpern and Bruno (1998) first showed how to devise a model that accounts for both global mutational features at the nucleotide level and site specific selective constraints at the amino acid level. Although their approach was directed to the estimation of evolutionary distances, it was later recognized as enabling the estimation of distributions of selection coefficients from phylogenetic data (see, for a review of these developments). However, a serious issue with the Halpern and Bruno model, and some of the subsequent re implementations (e.g.), lies in the use of site specific parameters optimized to maximum likelihood estimates; such an approach induces the 'infinitely many parameters trap', in which each additional observation changes the form of the overall model (see Rodrigue, 2013). Yang and Nielsen (2008) devised some simpler homogeneous mutation selection models, along with a likelihood ratio test aimed at evaluating the significance of codon usage bias. While statistically well justified the homogeneity of their mutation selection models makes them biologically unsatisfying for the purpose of estimating distributions of selection coefficients. Subsequently, we proposed the use of a nonparametric approach based on the Dirichlet process, providing a flexible and statistically well founded method to accommodating across site heterogeneity of amino acid constraints (). However, our proof of concept implementation only allowed for its application on very small data sets, and its rate limiting Markov chain Monte Carlo (MCMC) updates on the Dirichlet process, based on a chinese restaurant approach, were not amendable to parallelization. Working with nucleotide and amino acid level substitution models, we recently developed phylo bayes mpi which, among other speed up strategies, uses message passing interface (MPI) and a truncated stick breaking representation of the Dirichlet process for parallelized updating (). Here, we have expanded phylo bayes mpi for the implementation of several types of codon substitution models, including the Dirichlet process based site heterogeneous mutation selection approach. We illustrate how the software can now be used for efficient estimation of distributions of selection coefficients (scaled by the effective chromosomal population size), and discuss several future avenues that it enables.
