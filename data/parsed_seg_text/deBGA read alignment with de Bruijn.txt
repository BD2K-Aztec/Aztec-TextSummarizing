Motivation: As high throughput sequencing (HTS) technology becomes ubiquitous and the volume of data continues to rise, HTS read alignment is becoming increasingly rate limiting which keeps pressing the development of novel read alignment approaches. Moreover, promising novel applications of HTS technology require aligning reads to multiple genomes instead of a single reference; however, it is still not viable for the state of the art aligners to align large numbers of reads to multiple genomes. Results: We propose de Bruijn graph based Aligner de bga an innovative graph based seed and extension algorithm to align HTS reads to a reference genome that is organized and indexed using a de Bruijn graph. With its well handling of repeats, de bga is substantially faster than state of the art approaches while maintaining similar or higher sensitivity and accuracy. This makes it particularly well suited to handle the rapidly growing volumes of sequencing data. Furthermore, it provides a promising solution for aligning reads to multiple genomes and graph based references in HTS applications.

introduction a fundamental challenge of high throughput sequencing (HTS) technology is the quick and accurate alignment of sequencing reads to one or more reference genomes (). Read alignment is one of the most compute intensive steps of HTS analysis (), and is becoming increasingly rate limiting as HTS technology becomes ubiquitous and the volume of data from each sequencing run continues to rise. Moreover, as more genomes are available (), promising new applications of HTS technology require aligning reads to multiple genomes instead of a single reference. For example, the genomes of the typical strains of a species are used as gold standard reference points (), and species or pathogens can be precisely identified and characterized by simultaneously aligning reads from isolated or meta genomic samples to these reference genomes (), which has enormous potentials. Similarly, reads from mouse xenograft models typically need to be aligned to both the human and the mouse genome. However, it is still not viable to align large numbers of HTS reads to multiple divergent genomes of various strains or species simultaneously, primarily due to two limitations. Firstly, most state of the art aligners are optimized for a single genome reference. Although they can support almost any reference sequence, appending genomes together to make a longer reference typically degrades performance and decreases accuracy, as many reads have multiple, equally good matches. Secondly, efforts have been made to support pan genome indexing (); however, most of the proposed methods organize genomes through collinear multiple sequence alignment (MSA). These approaches are useful for highly similar genomes, such as multiple human genomes (1000 Genomes), but not the genomes of more distant strains or species. Such distant homologues often have significant structural variants (SVs) () (such as inversions, translocations and duplications), and collinear MSA could be not suitable for representing these non collinear events (). In this situation, these approaches may not be applicable to align reads against multiple divergent genomes, e.g. a reference composed by a set of microbial genomes. Moreover, proposed pan genome indexing methods also have additional limitations. genome mapper () and bwb ble () can only integrate relatively small variants (such as SNPs and small indels). The size of generalized compressed suffix array index () could exponentially increase, which could not be suited to handle the variants in repetitive regions ().proposed an augmented msa based graph (named as population reference graph, PRG) to better support diverse kinds of variants. In this approach, the de Bruijn graph of the reads is aligned with PRG to infer the donor genome. This approach falls between de novo assembly and the alignment of genome sequences. It is suited to the inference of the complex genomic regions, such as the MHC region. However, it is mainly designed for local regions, and due to the lack of effective approach to index the PRG of whole genome, it is still non-trivial to extend this approach to the read alignment against whole genome. Besides the aforementioned limitations, msa based aligners also have lower speed, e.g. 10100 times slower than state of the art aligners (). Meanwhile, the MSA itself may also affect the result of read alignment, as there is still not a standard method to implement the MSA of genomes (). Most of the state of the art generic aligners are based on seed and extend approach (). They are superior to backtracking suffix tries [utilized, e.g. BWA (for the increasing read length of HTS technologies, which requires large edit distance. Generally, seed and extend aligners consist of two steps: (i) seeding: the inference of putative read positions (PRPs) from the matches (hits) of tokens (seeds) between the read and reference genome; and (ii) extension: alignment of the read to the region surrounding each PRP to determine the most likely read position(s). One of the major bottlenecks faced by this approach is how to handle repetitive genomic regions, even in the context of a single genome, for example, over 50% of the human genome comprised repeats (). Because of repeats, many seeds have numerous hits, and the cost of extending all of them is prohibitively high. This problem is even more serious for a reference consisting of multiple genomes, as it will be even more repetitive due to the homologous sequences. Various strategies have been developed to handle hits more effectively, including heuristically filtering the hits (), limiting the number of hits per seed () or merging hits before extension (). However, as all of these strategies process each hit independently, it could be also expensive to evaluate, sort and prioritize the numerous hits. After these steps, however, there could be still a number of candidates left for extension due to the repeats, and the cost of separate alignment of the read to each of them could still be prohibitive. To improve the alignment of reads to multiple references, as well as the handling of repeats within a single genome, we propose the de Bruijn graph based Aligner de bga which uses a graph based seed and extension algorithm to align reads to one or more genomes that have been organized and indexed by a Reference de Bruijn graph rd bg. de Bruijn graph and a bruijn graph were used for the alignment of genomes (); however, they have not been fully utilized for HTS read alignment. de bga takes the advantage of the non branched paths of rd bg (i.e. uni paths to recognize similar seeds and identical local sequences, which enables it to simultaneously evaluate multiple PRPs located in the same uni path regardless of the repetitiveness of the corresponding seeds. This greatly reduces the computational burden caused by repeats. Due to its handling of repeats, de bga is substantially faster than other state of the art aligners. Furthermore, to our knowledge, de bga is the first viable solution which can align reads to multiple genomes with high throughput and without restriction on the types of variants.

discussion results on various datasets demonstrated that de bga can align reads to one or more genomes quickly and sensitively, making it particularly well suited to handle the rapidly growing volumes of genomics and meta genomics data. This advantage originates from its de Bruijn graph based organization of references and specifically designed seed and extension process, which enables to well handle the repeats. de bga is suited to be integrated into many re-sequencing pipelines. Moreover, this method could be further extended to solve other important problems, which are also future works for us. One of the potential works is to extend the approach to better align reads spanning the breakpoints of large or non colinear events, such as the dna seq reads spanning SVs, or rnase q reads which usually have splicing events. The alignment of such reads is difficult, and critical to many downstream analyses. graph based approach may have its own advantage to this task, as the non colinear events could be better modeled under the de Bruijn graph framework, comparing to the linear representation of the reference. However, the alignment method still needs to be well designed to fully take the advantages of the graph representation. Another potential extension is to use the de bga method to align reads against other data structures which can also be split into km ers such as msa based graphs. This will make de bga an important step toward rapidly aligning reads to variation aware references representing a population of genomes, such as the 1000 Genomes Project or the UK100K (http://www.genomicsengland.co.uk/) datasets.
