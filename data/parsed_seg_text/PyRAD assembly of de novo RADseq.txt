Motivation: restriction site associated genomic markers are a powerful tool for investigating evolutionary questions at the population level, but are limited in their utility at deeper phylogenetic scales where fewer orthologous loci are typically recovered across disparate tax a. While this limitation stems in part from mutations to restriction recognition sites that disrupt data generation, an additional source of data loss comes from the failure to identify homology during bioinformatic analyses. Clustering methods that allow for lower similarity thresholds and the inclusion of in del variation will perform better at assembling rad seq loci at the phylogenetic scale. Results: pyra d is a pipeline to assemble de novo rad seq loci with the aim of optimizing coverage across phylogenetic datasets. It uses a wrapper around an alignment clustering algorithm, which allows for in del variation within and between samples, as well as for incomplete overlap among reads (e.g. paired end. Here I compare pyra d with the program Stacks in their performance analyzing a simulated rad seq dataset that includes in del variation. Indels disrupt clustering of homologous loci in Stacks but not in pyra d such that the latter recovers more shared loci across disparate tax a. I show through re-analysis of an empirical rad seq dataset that indels are a common feature of such data, even at shallow phylogenetic scales. pyra d uses parallel processing as well as an optional hierarchical clustering method, which allows it to rapidly assemble phylogenetic datasets with hundreds of sampled individuals. Availability: Software is written in Python and freely available at

introduction restriction site associated DNA libraries () and related genotyping by sequencing approaches (e.g. GBS,) take advantage of next generation sequencing platforms to generate short reads from thousands of potentially homologous loci, across multiple individuals, by targeting genomic regions adjacent to restriction enzyme cut sites. In contrast to whole genome shotgun data, this provides a more efficient and economical source for performing comparisons across many sampled individuals, making it a popular tool for population genetic analyses (reviewed in). The problem of efficiently obtaining sequence data across many individuals is also relevant to studies at deeper evolutionary time scales, such as genus or family level phylogenetics, and it is at this scale that rad seq is now receiving increased attention. RAD sequences generated in silico from multi-species genome alignments have been shown to retain accurate phylogenetic information over evolutionary divergences as deep as 60 million years (); however, to date, all empirical rad seq studies conducted above the species level were done at much shallower scales (). Still, these studies confirm theoretical expectations by demonstrating that concatenated, genome aligned or even individual rad seq loci are capable of recovering well supported gene trees and species trees. Yet, these studies also demonstrate that large amounts of missing data are a common feature of rad seq which may limit its applications. Theoretically, the ultimate scale over which rad seq data will be recovered, and thus phylogenetically useful, is inherently limited by mutations that disrupt restriction recognition sites, causing 'locus dropout manifest as more missing data between more distantly related samples. However, empirically such limits are approached much sooner owing to the loss of data to other technical factors related to data generation and analysis. For example, the choice of restriction enzyme, the size of selected fragments and variation in sequencing coverage across samples all affect the number of loci recovered. Moreover, bioinformatic analyses used to assemble rad seq datasets recover different amounts of data depending on the parameters used to identify and cluster orthologs as well as filter for paralogs (or repetitive DNA regions.) In this article, I focus mainly on the latter aspect of locus dropout: factors limiting the identification (recovery) of orthologous loci when they are present in a dataset. Few programs are currently available to assemble rad seq data, which currently includes Stacks (), Rainbow () and rtd (). Here I describe a new software pipeline called pyra d which assembles de novo aligned rad seq loci for population level or phylogenetic analyses, with a particular focus on the analysis of highly divergent samples. pyra d differs from both Stacks and Rainbow through its use of a global alignment clustering algorithm performed with a wrapper around the program u search ()which allows for incorporation of in del variation while identifying homology. In this way, pyra d is more similar to rtd, which uses a graph clustering algorithm that also allows for indels. pyra d stands apart from these programs in its speed, flexibility for analyzing multiple rad seq data types, its scalability to extremely large and divergent datasets and its ease of use. Below I describe the pyra d pipeline in detail. I then demonstrate its performance on simulated and empirical datasets and compare the results with those of Stacks, which is currently the most commonly used alternative software.

DISCUSSION

conclusion pyra d performs de novo assembly of rad seq datasets, including RAD, GBS, ddr ads eq and paired end options. It is designed to perform equally well from population to phylogenetic scales and is currently being implemented across this range, from linkage analyses among siblings to clade level phylogenies with hundreds of tips. A major goal of this software was ease of use, and for this reason, it uses common file formats familiar to those working in phylogenetics and offers a variety of output formats for downstream analyses, from SNP and allelic data to individual or concatenated loci. Because the software does not need to be compiled, pyra d is easy to install on any desktop or computing cluster. It does not require large memory usage, and an analysis can be easily split into multiple shorter length jobs through its step-wise execution.
