Motivation: next generation sequencing technologies generate millions of short sequence reads, which are usually aligned to a reference genome. In many applications, the key information required for downstream analysis is the number of reads mapping to each genomic feature, for example to each exon or each gene. The process of counting reads is called read summarization. Read summarization is required for a great variety of genomic analyses but has so far received relatively little attention in the literature. Results: We present feature counts a read summarization program suitable for counting reads generated from either RNA or gen-omic DNA sequencing experiments. feature counts implements highly efficient chromosome hashing and feature blocking techniques. It is considerably faster than existing methods (by an order of magnitude for gene level summarization) and requires far less computer memory. It works with either single or paired end reads and provides a wide range of options appropriate for different sequencing applications.

introduction next generation (next-gen) sequencing technologies are revolutionizing biology by providing the ability to sequence DNA at unprecedented speed (). The computational problem of mapping short sequence reads to a reference genome has received enormous attention in the past few years (), and the rapid development of fast and reliable aligners is one of the success stories of bioinformatics. Raw aligner output, however, is not usually sufficient for biological interpretation. Read mapping results have to be summarized in terms of read coverage for genomic features of interest before they can be interpreted biologically. One of the most ubiquitous operations that forms part of many next-gen analysis pipelines is to count the number of reads overlapping predetermined genomic features of interest. Depending on the next-gen application, the genomic features might be exons, genes, promotor regions, gene bodies or other genomic intervals. Read counts are required for a wide range of count based statistical methods for differential expression or differential binding analysis (). Despite its importance in genomic research, the read counting problem has received little specific attention in the literature. The problem may appear superficially simple but in practice has many subtleties. Read count programs need to accommodate both DNA and RNA sequencing as well as single and paired end reads. The reads or paired end fragments to be counted may incorporate insertions, deletions or fusions relative to the reference genome, and these complications need to be accounted for when comparing the location of each read or fragment to each possible target genomic feature. When the number of features is large, the computational cost of read counting can be comparable with that of the read alignment step. DNA sequence reads arise from a variety of technologies including chips eq for transcription factor binding sites (), chips eq for histone marks () and assays that detect DNA methylation (). The genomic features of interest for DNA reads can usually be specified in terms of simple genomic intervals. For example counted reads associated with histone marks by gene promotor regions and by whole gene bodies. ross counted reads overlapping with intervals identified by a peak caller (). Counting rnase q reads is somewhat more complex because of the need to accommodate exon splicing. One way is to count reads overlapping each annotated exon, an approach that can be used to test for alternative splicing between experimental conditions (). Another common approach is to summarize counts at the gene level, by counting all reads that overlap any exon for each gene (). Gene annotation from RefSeq () or Ensembl () is often used for this purpose. Read counts provide an overall summary of the coverage for the genomic feature of interest. In particular, gene level counts from rnase q provide an overall summary of the expression level of the gene but do not distinguish between isoforms when *To whom correspondence should be addressed.  The Author 2013. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals permission soup com multiple transcripts are being expressed from the same gene. Reads can generally be assigned to genes with good confidence, but estimating the expression levels of individual isoforms is intrinsically more difficult because different isoforms of the gene typically have a high proportion of genomic overlap. A number of model based methods have been developed that attempt to de convolve the expression levels of individual transcripts for each gene from rnase q data, essentially by leveraging information from reads unambiguously assigned to regions where isoforms differ (). This article concentrates on the read count problem, which is generally applicable even when the sequencing depth is not sufficient to make transcript level analysis reliable. Many statistical analysis methods have been developed to detect differential expression or differential binding on the basis of read counts (). Recent comparisons have concluded that the read count methods perform well relative to model based methods for the purposes of gene level differential expression () or detection of splice variation (). Only a handful of general purpose read count software tools are currently available. The software packages genomic ranges () and i ranges (), developed by the core team of the Bioconductor project (), include functions for counting reads that overlap genomic features. The count overlaps function of i ranges is designed for counting reads overlapping exons or other simple genomic regions, whereas the summarize overlaps function of genomic ranges is designed for counting reads at the gene level. Another tool is the ht seq count script distributed with the ht seq Python framework for processing rnase q or dna seq data (). All of these are popular and well tested software tools, but all make extensive use of programming in the interpreted computer languages R or Python and none are fully optimized for efficiency and speed. bed tools is a popular tool for finding overlaps between genomic features that can be used to count overlaps between reads and features (). It is fully implemented in the compiled language C, making it faster than the aforementioned tools. It is, however, not specifically designed for rnase q data, so can count reads for exons or interval features only, similar to count overlaps. This article presents a highly optimized read count program called feature counts. feature counts can be used to quantify reads generated from either RNA or DNA sequencing technologies in terms of any type of genomic feature. It implements chromosome hashing, feature blocking and other strategies to assign reads to features with high efficiency. It supports multithreading, which provides further speed improvements on large data problems. It is available either as a Unix command or as a function in the R package r sub read. In either case, all the core functionality is written in the C programming language. The R function is a wrapper for the compiled C code that provides the convenience of the R programming environment without sacrificing any of the efficiency of the C implementation.

discussion read summarization is an important step in many next-gen sequencing data analyses. In this study, we developed a new read summarization program called feature counts and compared it with existing methods in terms of efficiency and accuracy. Our results showed a high concordance between alternative methods in summarization accuracy. However, there was a large difference observed in their computational cost. The feature counts method was found to be an order of magnitude faster on average and far more memory efficient than other methods. The high computational efficiency of feature counts is due to its ultrafast feature search algorithm and its highly efficient implementation entirely using the C programming language. All results presented in this article were produced using a single thread, but features counts also supports multithreaded processing, making it particularly useful for summarizing data generated in large sequencing studies. It is the only existing read count method that supports multithreading. This program provides a wide range of options to allow users to fully control how their read data can be best summarized. Users can choose whether they should count the reads that overlap with more than one feature or meta feature. This choice is often determined by the experiment type. Reads overlapping with more than one gene (a meta feature should not be counted in a rnase q experiment because such reads can only originate from one gene, but usually they should be counted in a gdna seq experiment such as a histone chips eq experiment. This program also allows users to filter out reads before summarization using a number of metrics such as mapping quality scores, fragment mapp ability (whether two ends from the same fragment are both successfully mapped or not), fragment length, strand ness chimerism and so on. It can automatically detect either SAM or BAM format read input and sort reads by name if paired reads are not in consecutive positions in the input. It also allows users to specify whether those reads that were reported with more than one mapping location multi mapping should be counted or not. Many of these useful features are not supported by other programs. The feature counts program has been implemented in both SourceForge sub read package () and Bioconductor r sub read package (). The R function provides users with an R interface so that they can access this program from their familiar R environment. It calls the underlying compiled C program to perform all the read summarization operations, and hence has the same speed and memory usage as that of the SourceForge sub read package, which is written entirely in C. The implementation of feature counts in R enables complete pipelines to be established for analyzing next-gen sequencing data using Bioconductor software programs. For example, functions included in Bioconductor packages r sub read limma and edgeR can be used to perform complete rnase q and histone chips eq analyses, starting from read mapping, to read summarization and finally to differential expression analyses or differential histone modification analyses. Owing to its high efficiency and accuracy, we believe the feature counts program will be a useful tool in the bioinformatics toolbox for analyzing next-gen sequencing data.
