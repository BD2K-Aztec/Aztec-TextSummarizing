Motivation: A common difficulty in large scale microarray studies is the presence of confounding factors, which may significantly skew estimates of statistical significance, cause unreliable feature selection and high false negative rates. To deal with these difficulties, an algorithmic framework known as Surrogate Variable Analysis (SVA) was recently proposed. Results: Based on the notion that data can be viewed as an interference pattern, reflecting the superposition of independent effects and random noise, we present a modified SVA, called Independent Surrogate Variable Analysis is va to identify features correlating with a phenotype of interest in the presence of potential confounding factors. Using simulated data, we show that is va performs well in identifying confounders as well as outperforming methods which do not adjust for confounding. Using four large scale Illumina Infinium DNA methylation datasets subject to low signal to noise ratios and substantial confounding by bead chip effects and variable bisulfite conversion efficiency, we show that is va improves the identifiability of confounders and that this enables a framework for feature selection that is more robust to model misspecification and heterogeneous phenotypes. Finally, we demonstrate similar improvements of is va across four mRNA expression datasets. Thus, is va should be useful as a feature selection tool in studies that are subject to confounding. Availability: An r package is va is available from www cran r project .org.

introduction confounding is a common problem in large scale microarray profiling studies (). For example, a study profiling hundreds of samples over a relatively large number of chips is vulnerable to confounding by chip effects. Even if the study is well designed and balanced in relation to the phenotype of interest, logistical or sample quality issues may induce confounding. Moreover, inter chip variation can not always be corrected for, even * To whom correspondence should be addressed. with powerful inter array normalization techniques such as quantile normalization (). Global normalization methods such as quantile normalization may also not be desirable if they obscure biologically important global differences between samples, as it may happen for example in DNA methylation studies (). A further difficulty is that often the confounding factors (CFs) are unknown to the experimentalist () or, if known, may be subject to substantial uncertainty or measurement error. In these scenarios, techniques that have been used to explicitly adjust for known and error free confounding factors () can not be used. CFs may affect estimates of statistical significance in various ways. Given a phenotype of interest, one of the most important measures of statistical significance is the false discovery rate (FDR), which can be thought of as the posterior probability that a feature declared to be positive is a true null (). A common assumption in estimating the FDR is the statistical independence of the multiple tests. This independence condition is, however, frequently violated as features often exhibit strong correlations. These correlations could be biological, or they could be due to experimental factors such as chip effects. Not taking these correlations into account can lead to instability of ranked gene lists, skew estimates of statistical significance and affect the power of a study (). Confounding may also increase the variability within phenotypes, thus turning true positives into false negatives, and hence leading to unacceptably large miss rates. To deal with these issues, an algorithm known as Surrogate Variable Analysis (SVA) was proposed (), and shown to lead to improved estimates of statistical significance, biological accuracy and reproducibility. The main concept behind SVA is to model the potential confounding factors, which may or may not be known, as singular vectors (so called 'surrogate variables') derived from a singular value decomposition (SVD). By definition, these surrogate variables are linearly uncorrelated, leading to an SVA model in which the residual noise is effectively white (). We propose that CFs would be better modeled as statistically independent surrogate variables, as modeling them as such better reflects the way the confounding noise is generated. For example, given a gene expression study where the phenotype of interest is clinical outcome, it is clear that two confounders such as bead chip and age are statistically independent variables. It, therefore, seems natural to model the effect of these factors on the data as statistically
