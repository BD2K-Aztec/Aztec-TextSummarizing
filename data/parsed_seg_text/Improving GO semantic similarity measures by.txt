Motivation: Several measures have been recently proposed for quantifying the functional similarity between gene products according to well structured controlled vocabularies where biological terms are organized in a tree or in a directed acyclic graph (DAG) structure. However, existing semantic similarity measures ignore two important facts. First, when calculating the similarity between two terms, they disregard the descendants of these terms. While this makes no difference when the ontology is a tree, we shall show that it has important consequences when the ontology is a dag this is the case, for example, with the Gene Ontology (GO). Second, existing similarity measures do not model the inherent uncertainty which comes from the fact that our current knowledge of the gene annotation and of the ontology structure is incomplete. Here, we propose a novel approach based on downward random walks that can be used to improve any of the existing similarity measures to exhibit these two properties. The approach is computationally efficient random walks do not need to be simulated as we provide formulas to calculate their stationary distributions. Results: To show that our approach can potentially improve any semantic similarity measure, we test it on six different semantic similarity measures: three commonly used measures by Resnik (1999), Lin (1998), and Jiang and Conrath (1997); and three recently proposed measures: simu i sim gic by pes quita et al. (2008); gras m by Couto et al. (2007); and Couto and Silva (2011). We applied these improved measures to the GO annotations of the yeast Saccharomyces cerevisiae, and tested how they correlate with sequence similarity, mRNA co-expression and protein protein interaction data. Our results consistently show that the use of downward random walks leads to more reliable similarity measures. Availability: We have developed a suite of tools that implement existing semantic similarity measures and our improved measures based on random walks.

introduction the introduction of ontologies for gene functional annotation allows us to compare genes by quantifying the similarity of the terms * To whom correspondence should be addressed with which they are annotated. These comparisons are important as they contribute to the inference of functional relationships between gene products by providing a perspective that complements both experimental information and sequence based approaches. Standard ontologies usually have a structure that can be modelled by a rooted and oriented tree [e.g. MIPS (), gen protec (, or more generally by a directed acyclic graph (DAG), like the Gene Ontology (GO;) which has become a standard and is the focus of this article. In general, given two terms, comparisons are not straightforward due to the complex structure of the ontologies discuss in detail the issues related to such comparisons, here we only mention a few of them. For instance, comparisons should take into account the position of the terms in the ontology structure as terms in higher levels (i.e. closer to a root term) are less specific and likely to be less informative. At the same time, the depth of the term may not be an exact indicator of its specificity as some edges (relations) in the ontology may cover a larger conceptual distance, whereas others may cover shorter distances. Calculating the depth of a term becomes even more problematic in DAG structures, as a term may have multiple parent terms and thus multiple paths of different lengths leading to the root term (see column 1 in). Finally, ontologies and annotations are constantly refined and one should not neglect the possibility of new annotations or new terms being added later to the ontologies.
