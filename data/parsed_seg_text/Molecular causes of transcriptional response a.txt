Motivation: The abundance of many transcripts changes significantly in response to a variety of molecular and environmental perturbations. A key question in this setting is as follows: what intermediate molecular perturbations gave rise to the observed transcriptional changes? Regulatory programs are not exclusively governed by transcriptional changes but also by protein abundance and post-translational modifications making direct causal inference from data difficult. However, biomedical research over the last decades has uncovered a plethora of causal signaling cascades that can be used to identify good candidates explaining a specific set of transcriptional changes. Methods: We take a Bayesian approach to integrate gene expression profiling with a causal graph of molecular interactions constructed from prior biological knowledge. In addition, we define the biological context of a specific interaction by the corresponding Medical Subject Headings terms. The Bayesian network can be queried to suggest upstream regulators that can be causally linked to the altered expression profile. Results: Our approach will treat candidate regulators in the right biological context preferentially, enables hierarchical exploration of resulting hypotheses and takes the complete network of causal relationships into account to arrive at the best set of upstream regulators. We demonstrate the power of our method on distinct biological datasets, namely response to dexamethasone treatment, stem cell differentiation and a neuropathic pain model. In all cases relevant biological insights could be validated. Availability and implementation: Source code for the method is available upon request.

introduction the abundance of many transcripts changes significantly in response to a variety of molecular and environmental perturbations. To understand the details of the transcriptional response, it is often useful to annotate the biological function of the changed transcripts using gene set enrichment methods. Ackermann and Strimmer (2009) give a comprehensive overview and provide a recent performance assessment of many methods. However, a key question often remains: what intermediate molecular perturbations gave rise to the observed transcriptional changes? The situation is complicated by the fact that regulatory programs are not necessarily governed by transcriptional changes but also by protein abundance and post-translational modifications. As changes beyond the transcriptional level are rarely measured, direct inference of causal relationships is difficult and an active field of research. A number of statistical and network reconstruction methods have been used to identify potential gene regulatory networks directly from the gene expression profiles and large scale datasets (). Although these methods demonstrate great potential for deciphering mechanisms of regulation, they require a large number of expression profiles and genetic data. Moreover, determining the sign and direction of the causality can be challenging. Over the last decades, biomedical research has uncovered a plethora of causal signaling cascades. Such prior knowledge can be used to identify good candidates to explain a specific set of transcriptional changes and point to others that can not be explained satisfactorily by current knowledge. The use of prior network or pathway knowledge has received considerable attention in recent years. emmert streib and provide a recent review. More closely related to our method developed an approach based on reasoning on structured collection of causal relationships to analyze the most likely regulators of expression changes derived from type 2 diabetes patients and recovered known key genes in diabetes and proposed new regulators constructed a causal graph from a set of causal relationships extracted from the biomedical literature and introduced a scoring scheme to identify putative upstream regulators for any given input dataset based on the set of causal relationships encoded as the causal graph. Essentially, for each putative upstream regulator, the method makes predictions of the downstream transcriptional effects (upregulation or downregulation) using the causal relationships. The predictions are then compared with the observed data and based on the number of correct and incorrect predictions, a score is assigned to the upstream *To whom correspondence should be addressed.  The Author 2013. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals permission soup com regulator. The statistical significance of the scores is measured using an analog of the Fisher's exact test. Although this method is able to distinguish the upstream regulator whose associated transcripts have significantly different distribution form the background, it does not take the full topology of the network into consideration. More precisely, each regulator is considered in isolation and the joint distribution of the network is not taken into consideration. Moreover, the model makes no assumption on the applicability of the causal relations in the context under which the experiment is performed. In this work, we construct a Bayesian network from the same knowledgebase as in, consisting of a set of nearly 450 000 causal relations extracted from nearly 65 000 peer review PubMed full articles. The Bayesian network can be queried to suggest upstream regulators (hypotheses) that can be causally linked to the altered expression profile in a manner that takes the entire topology of the network as well as the context under which the experiment is performed into consideration. The noise in the observation is also taken into consideration directly. Most methods integrating network data into the analysis process differ in at least one key point from our Bayesian approach, namely (i) the use of non causal non signed protein protein interaction networks, (ii) the use of non bayesian approaches, (iii) a focus on identifying active subnetworks or enriched gene sets, but not the contextual prediction of upstream regulators active in a given experiment. A potential problem with our and related approaches is the availability of a suitable knowledgebase of causal relationships. Fortunately, public repositories are starting to appear. For our purposes, the open bel portal www open bel. org) is the most relevant example. It provides an open source framework to specify, parse and manipulate causal relationships and also offers a test corpus under a Creative Commons license of $70 000 causal statements manually extracted from 16 000 PubMed articles. The biological examples in this work rely on a licensed extended knowledgebase from commercial vendors, i.e. Ingenuity www ingenuity com and sel venta www sel venta. com) that consists of about 450 000 statements. sel venta makes a subset of their knowledge base available at the open bel site.

discussion in this article, we present a Bayesian methodology capable of identifying specific, plausible and testable biological hypothesis consistent with the observed gene expression data. We do this by reasoning over a massive knowledge base of prior biological knowledge extracted from the literature. Our method is an extension of the approach developed by. There, the statistical significance of upstream regulators is tested in isolation, i.e. the existence of alternative regulators is not taken into consideration when assessing the significance. Our method generalizes this by constructing a Bayesian network from the knowledge base and considering the joint probability distribution of the possible molecular drivers of the observed expression profile (see Supplementary Material for benchmark results). Additionally, our new method models the context of the experiment by introducing the enriched MeSH terms of the network of differentially expressed genes as nodes in the Bayesian network. This will significantly remove the noise and redundancy in the network. In conclusion, we find that our new method is well able to identify the key regulators in simulated and actual biological data. The nature of the output is well suited for the direct proposal of novel testable hypotheses, such as a role for IL6 of endocrine pancreas development or the causal aspect of if ng in a system as noisy as a surgical in vivo model of pain. We are currently pursuing an extension of our method that will integrate higher level causal drivers in the network. Finally, our method provides a natural framework for integrating omic scale dataset with prior biological knowledge to identify concise, coherent and testable biological hypothesis.
