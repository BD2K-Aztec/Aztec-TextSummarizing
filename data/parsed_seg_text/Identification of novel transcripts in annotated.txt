We describe a new reference annotation based transcript assembly problem for rnase q data that involves assembling novel transcripts in the context of an existing annotation. This problem arises in the analysis of expression in model organisms, where it is desirable to leverage existing annotations for discovering novel transcripts. We present an algorithm for reference annotation based transcript assembly and show how it can be used to rapidly investigate novel transcripts revealed by rnase q in comparison with a reference annotation.

introduction whole transcriptome sequencing, known as rnase q (), leverages high throughput sequencing technology to investigate the RNA content from a sample via the sequencing of cDNA. This technology has been the focus of numerous recent studies that demonstrate high resolution and accuracy in transcript abundance estimation, and it is being heralded as a possible replacement for microarray based gene expression technology. This exciting development has partially eclipsed another important application of rnase q the improvement of existing genome annotations () and even the possibility of complete de novo genome annotation based on multiple experiments, as is being demonstrated by the r gasp consortium (http://www.gencodegenes.org/rgasp/). In the context of genome annotation, rnase q reads can be viewed as next generation expressed sequence tags (ESTs) (). rnase q offers the promise of rapid, comprehensive discovery of novel genes and transcripts in considerably less time and at lower cost than ESTs from conventional Sanger sequencing. * To whom correspondence should be addressed.. Histogram showing the percent of bases covered in annotated reference transcripts. The low coverage transcripts would not be properly assembled using sequencing reads alone. In genomes with extensive annotations, there is clearly room for improvement by taking advantage of the information contained in the annotated transcripts when assembling and calculating expression values. However, a problem with using rnase q for annotation is that genes that are expressed at a low level will be represented by few reads and may be only partially covered. To illustrate this point, we show in the coverage of RefSeq annotated transcripts in a typical rnase q experiment (see Section 3 for details of the experiment). The histogram shows that 29.1% of the transcripts are not covered at all, which will happen because they are not expressed or are at levels undetectable in the experiment. The remaining transcripts have varying levels of coverage (based on their expression level and length), and although many transcripts are completely covered, we found that of the transcripts with partial coverage, 64.4% are in completely covered (95% coverage). This means that nave assembly methods will fail to reconstruct the majority of full length transcripts. One approach to predicting complete transcripts from partial coverage is to incorporate rnase q data in a gene finding system. Such approaches have been successful, but they rely on models of genes structures that may limit predictions based on prior biases. Other approaches, such as Scripture () may be able to close gaps in coverage, but fail to incorporate existing annotation information are mapped to the genome using a spliced read mapper that can map reads across junctions (shown in dotted lines). The reference annotation (blue) is used to generate faux read alignments that tile the transcripts (green). The faux read alignments are used together with the spliced read alignments to generate a reference genome based assembly (black). This assembly is merged with the reference annotation, and 'noisy' read mappings are filtered resulting in all reference annotation transcripts in the output (blue) as well as novel transcripts (light blue). during prediction. In the case of model organisms where gene annotations are based on years of effort, large consortia have combined state of the art computational predictions () with careful human curated annotations (). We have organized existing assembly strategies into three categories, and as far as we are aware, none of the programs in any of these categories can explicitly use existing annotations during assembly: @BULLET De novo transcript assembly the direct assembly of sequenced reads into transcripts without mapping to a reference genome. Examples include. @BULLET Genome reference based transcript assembly assembly of transcripts by first mapping to a reference genome. These methods build on previous work using ESTs () or mapped pyrosequencing reads ()We address the need for a reference annotation based assembler by developing a novel approach through modification of an existing assembler that we term reference annotation based transcript assembly r abt assembly). We adopt the approach of () which is to identify transcripts only based on read alignments (i.e. without regard to prior information about protein coding gene structure), and we employ the parsimony approach to find the fewest number of transcripts explaining the data (in this case, the aligned sequenced reads together with the reference annotation). A key feature of our approach is that it rapidly identifies novel transcripts (with respect to the reference annotation).

discussion rnase q is being increasingly adopted as the technology of choice for gene expression studies (), and with large numbers of experiments producing partial transcripts of genes, it is expected that there will be rapid progress in the coming years in annotating genomes. As more complete genome annotations are produced, it is increasingly desirable to include them in analyses rather than assembling transcripts 'from scratch' with every new experiment. The reference annotation based transcript assembly approach we have introduced addresses this problem, and allows for the incremental improvement of annotations with rnase q experiments. It is also convenient in that novel genes and transcripts (with respect to an existing annotation) are easily extracted from the output of our assembler. It is important to note that accurate genome annotation is crucial for accurate gene expression estimation. In previous work, it has been shown that incomplete annotations can bias gene expression estimates (). The current practice of using rnase q to estimate expression using known annotations when they are available is therefore liable to yield inaccurate results, especially in cases where genes have multiple isoforms, some of which may not yet be annotated. We, therefore, believe that r abt assembly is essential until annotations are improved and completed. A key feature of r abt is that it is a 'pure' assembler. This means that it does not utilize information about the structure and content of coding genes or other external input (e.g. ESTs) during the assembly. We believe this is a feature (rather than a weakness of the method) because it means that r abt can assemble non-coding RNA transcripts. It is an interesting problem to extend r abt to allow for other external input, and we believe that similar approaches (based on faux reads may be fruitful. Along with this method, we present several open problems in r abt assembly. For example, deciding the optimal length and spacing of tiling reads that will connect trans frags while minimizing reorganizations of annotated transcripts is non-trivial and will vary depending on the properties of the experiment as well as the organism under investigation. The same is true for the parameters used in matching assembled transcripts with those in the annotation for filtering. While we believe we have chosen good parameters for this experiment, we do not believe there to be a one size fits all' approach and it should be interesting to develop a statistically sound approach to automatically determine the best tiling method. We also note that using more complete annotations as references with r abt can lead to a larger number of false positives as portions of annotated transcripts can be re-assembled in new combinations. For example, we estimate through faux read only assembly that using the more complete UCSC annotation as opposed to the RefSeq annotation would lead to 5 times the number of false positives. Therefore, we recommend this method for use on organisms where deep annotations do not already exist. Continuing improvements in rnase q technology will eventually result in the ability to sequence complete transcripts using long reads and fragments. Furthermore, large scale surveys of transcripts in multiple developmental stages and tissues should be able to yield complete annotations of genomes solely based on rnase q. However, until that time, it is imperative that genome
