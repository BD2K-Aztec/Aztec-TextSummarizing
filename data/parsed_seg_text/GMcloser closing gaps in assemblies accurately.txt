Motivation: Genome assemblies generated with next generation sequencing (NGS) reads usually contain a number of gaps. Several tools have recently been developed to close the gaps in these assemblies with NGS reads. Although these gap closing tools efficiently close the gaps, they entail a high rate of mis assembly at gap closing sites. Results: We have found that the assembly error rates caused by these tools are 20–500-fold higher than the rate of errors introduced into contigs by de novo assemblers. We here describe gm closer a tool that accurately closes these gaps with a preassembled contig set or a long read set (i.e. error corrected pac bio reads). gm closer uses likelihood based classifiers calculated from the alignment statistics between scaffolds, contigs and paired end reads to correctly assign contigs or long reads to gap regions of scaffolds, thereby achieving accurate and efficient gap closure. We demonstrate with sequencing data from various organisms that the gap closing accuracy of gm closer is 3–100-fold higher than those of other available tools, with similar efficiency. Availability and implementation: gm closer and an accompanying tool gm value for evaluating the assembly and correcting mis assemblies except SNPs and short indels in the assembly are available at https://sourceforge.net/projects/gmcloser/.

introduction next generation sequencing (NGS) technologies allow the low cost and high speed construction of unknown genome sequences by de novo assembly. The assembly of reads produces contigs, but the extension of these contigs frequently stops at sites with repetitive regions, heterozygous alleles, sequencing errors or low read coverage, causing assembly fragmentation (). Hence, for large eukaryotic genomes with highly repetitive and or polymorphic sequences, the lengths of the contigs generated by short read assembly are generally short. Contig fragments are then further linked with paired end (PE) or mate pair (MP) reads, which are generated by sequencing both ends of DNA fragments with a range of sizes, to form scaffolds. Scaffolds contain many gaps, with a range of sizes, which are estimated from the fragment sizes of PE or MP reads. Closing the gaps in scaffolds is an important finishing process in assembly construction. Because the gap regions correspond not only to repeat sequences, which are often found in intergenic regions, but also to gene encoding regions, which could not be assembled because of low read coverage or heterologous sites, the effectiveness and accuracy of gap closing significantly affects downstream analyses, including gene annotations for the constructed assemblies. Connecting the contigs non gapped DNA segments split by gaps in scaffolds and hereafter referred to as sub contig encompassing a V C The Author 2015. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals permission soup com gap in a scaffold by closing the gaps increases the length of the sub contigs and its capacity to include the encoded genes to be annotated. Gap closing has traditionally been performed by manually or semi automatically sequencing pcr products generated with primers that encompass the gaps (). However, recently developed gap closing tools that use NGS reads, gap closer (, b), IMAGE (), gap filler () and FinIS (), have replaced the laborious manual gap closing process. The former three tools use a similar strategy to close gaps: (i) alignment of PE reads to the contig regions of the scaffolds; (ii) collection of unmapped mates when the other read of a pair is aligned to a region neighboring a gap; (iii) local assembly of collected unmapped reads based on de Bruijn graphs; and (iv) the iteration of processes (iiii). IMAGE is usually only applicable to assemblies of small genomes (). gap closer is designed for use as a finishing process of a soap de novo assembler, but can be used as an independent tool. gap filler is unique in that it assembles only reads that are partially aligned to span a gap, and considers the consistency between the gap lengths and the lengths of the sequences used to fill the gaps to increase the accuracy. FinIS closes gaps by constructing local assembly graphs using reads that were not used for the assemblies and pre-built contig graph information. FinIS can only be applied to assemblies from some specific assemblers (i.e. Velvet and soap de novo. Another tool to close the gaps in assemblies is pb jelly (), which use pac bio long reads instead of short NGS reads. pb jelly closes gaps and corrects errors in the closed sequences that are derived from pac bio reads by adopting consensus sequences of the multiple reads aligned to the gap regions. Additionally, assembly merging tools, pc a prep (), gam ngs (), GAA (), GARM (), CISA (), f gap (), MAIA (), Minimus2 () and Mix () can potentially close the gaps by merging the assemblies, although they are intended for assembly extension rather than gap closure. In this study, we demonstrated that all the existing gap closing tools cause a high rate of mis assembly at gap closing sites. To develop a gap closing tool with a lower error rate, we adopted a strategy with which gaps are closed with a set of preassembled contigs or long reads. Our strategy involves the selection of the correct alignments between scaffolds and contigs (or long reads by measuring the likelihood ratios of the true alignments. We demonstrate that this likelihood based method allows the efficient and accurate connection of contigs and is applicable to other technologies that involve the merging or assembly of contigs or long reads.

discussion current gap closing tools use a strategy that aligns pe reads followed by the km er based local assembly of the reads aligned around the gap regions. Although this strategy efficiently closes gaps, it gap closing in c elegans s space scaffolds. For S.cerevisiae S288c and c elegans simulated pac bio reads were generated with pbs im and error correction was conducted using pac bio to ca and pro ov read respectively. gap closing results for gap closer and gm closer with a real contig set (FM  e or SP e) are shown for comparison. Results of successive treatments using gm closer with a real contig set and pac bio reads are also shown (FM  e:14). The bars are as in. The data are from the assembly results of gm closer at iteration 3. The minimum alignment overlap identity to measure mis assembly events with gm value was set to 92%, because the pac bio reads could be in completely error corrected gap closing with gm closer introduces a large number of errors (). The high mis assembly rates of the km er based gap closing tools probably arise because the gap closing process involves assembly at genomic sites that are difficult to assemble with de novo assemblers. Because the current gap closing tools use only PE reads that are mapped to gap flanking regions for local assembly, mis assembly could occur frequently at repeated regions in which reads can be incorrectly aligned. These hard to assemble sites include repetitive regions and regions of highly polymorphic sequences that are attributable to sequencing errors or heterozygosity. Nevertheless, assembly tools are likely to generate many contigs that cover gaps in the scaffolds, because the gaps present in scaffolds generated with an assembler can be efficiently closed with a contig set generated with the same assembler. Therefore, our gap closing strategy, based on the alignment of a preassembled contig set, allows accurate and efficient gap closing. The assemblies in which the gaps were closed with gm closer and with an intact contig set still contained a number of errors. However, most of these errors were derived from mis assembly errors contained in the preassembled input contigs. Thus, the use of preassembled contig sets generated with accurate assemblers, such as SOAPdenovo2, should ensure accurate gap closing with gm closer. The high accuracy and high effectiveness of gm closer for gap closing are also due to the likelihood based selection of the correct alignment between a contig and a sub contig of a scaffold. This selection method uses likelihood ratios for three alignment factors: the alignment overlap length, the alignment overlap identity and the mapping rate of PE reads, which are determined statistically from true and false alignment datasets. Although likelihood based algorithms or Bayesian probabilistic approaches have been adapted to estimate genotypes, short read alignments and assembly errors (), no likelihood based method has been developed to select the correct alignment of DNA fragments such as contigs. Our selection method of contig alignment should be applicable to the development of tools involving the alignment of DNA sequence sets, such as assemblers of long reads or contigs. After a successive treatment of different contig sets with gm closer a number of gap regions are still barely filled, and these gap regions seem to correspond to genomic regions with low read coverage. Sequencing reads generated with the pac bio RS platform have long read lengths (mean: 10 kb, max: 50 kb) and relatively constant coverage across the sequenced genome, although the sequencing error rate is high ($15%;). The errors in pac bio RS reads can be effectively corrected with short reads () or with a multiple alignment strategy between the pac bio reads (). In this study, we have demonstrated that the gaps in assemblies can be efficiently and accurately closed with a low coverage of error corrected pac bio reads using gm closer and that the gap closing accuracy of gm closer is better than that of another gap closing tool with pac bio reads, pb jelly (). This feature of gm closer should also offer economical benefits, especially for assemblies of large genomes. However, the accuracy of the gap closing with pac bio reads is lower than that with preassembled contig sets, and many of the mis assemblies are attributable to incomplete error correction of pac bio reads (Supplementary Tables S8 and S12). Thus, the future development of more complete methods for error correction of pac bio reads would allow a more accurate gap closure with gm closer
