Motivation: Normalization is critical in DNA copy number analysis. We propose a new method to correctly identify two copy probes from the genome to obtain representative references for normalization in single nucleotide polymorphism arrays. The method is based on a two state Hidden Markov Model. Unlike most currently available methods in the literature, the proposed method does not need to assume that the percentage of two copy state probes is dominant in the genome, as long as there do exist two copy probes. Results: The real data analysis and simulation study show that the proposed algorithm is successful in that (i) it performs as well as the current methods (e.g. cgh normal iter and pop lowess for samples with dominant two copy states and outperforms these methods for samples with less dominant two copy states; (ii) it can identify the copy neutral loss of heterozygosity; and (iii) it is efficient in terms of the computational time used.

introduction copy number alterations (CNAs) have been associated with many genomic disorders (). Insertion or deletion of DNA sequences can directly alter the gene expression levels, and thus potentially cause genetic diseases (). For example, in a St. Jude study of 4200 b progenitor and t lineage acute lymphoblastic leukemia (ALL) patients, 450 recurring regions of CNAs were identified. In addition, many of these recurring CNAs were specific to different subtypes of ALL, associated with prognosis, indicating that resistance to therapy in ALL might be caused by specific genetic changes (). In another St. Jude study, deletion, amplification and other types of CNAs were found to be in 40% of b progenitor ALL cases (). Facilitated by the Human Genome Project, the development in comparative genomic hybridization (CGH) array technology has made it indispensable for CNA study. Among many types of CGH arrays, the single nucleotide polymorphism cgh snp cgh array is widely used because of its high resolution and its ability to provide genotype estimates (). Although advances in next generation sequencing are rapidly changing the landscape of genetics, the snp cgh array offers a cost effective way in CNA studies, complementary to next generation sequencing (). In addition, the snp cgh array has advantages in voluminous, publicly available data and a wealth of data analysis tools. Integrative analysis of genomic data generated from different platforms requires snp cgh data of high quality. The raw signals from the snp cgh array are inherently noisy because of sampling and or technical variation. To reduce such noise, the logarithms of signal intensity ratios between tumor and normal samples from the same individual are usually used for CNAs detection (). A large portion of the sampling variation may be removed this way because of strong similarities between paired tumor and normal samples. In addition, tumor normal pairs are expected to be run in the same laboratory and in the same batch to remove experimental variations as much as possible. Loss of heterozygosity (LOH) describes the loss of normal function of one allele in a gene, and LOH detection plays an important role in discovering DNA segments that harbor tumor suppression genes (). copy neutral LOH cnl oh refers to duplication of one of the two alleles and concurrently loss of the other allele, so that there is no change in a DNA copy number. As a result, it is difficult to detect cnl oh by conventional copy number measurements. On the other hand, the methods for accurate cnl oh detection often require both tumor and control samples from the same patient. Many statistical models and algorithms have been proposed for CGH array based CNA analysis (). Normalization is critical for obtaining biologically meaningful results. An appropriate normalization method should be able to substantially remove systematic variations, while signal changes because of biological alterations are preserved. Some of the early CGH data normalization methods directly adopt those developed for microarray gene expression, such as Quantile normalization, rank invariant set normalization, Lowess normalization and so forth (). A fundamental assumption in these algorithms is *To whom correspondence should be addressed.  The Author 2012. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals permission soup com that the distributions of the log signal intensities from all samples are the same. However, this assumption may not hold in a CNA study. For example, nearly all solid tumor cancers exhibit whole chromosome gains losses (), and the proportion of gain loss probes in the tumor genome can vary substantially from sample to sample. These translate into substantial differences in distributions of log signal intensities of different tumor samples. Therefore, directly applying normalization algorithms developed for gene expression data might result in over normalization of segments of CNAs (van). To address this problem, several methods have been proposed specifically for CGH array normalization. For example, based on genotype calls and log ratio of signal intensities, a reference alignment method identifies chromosomes in two copy state, which are then used as internal references in normalization alignment (). One problem in this method is that the number of reference chromosomes identified is usually small, and thus they might not represent the two copy probes well. Another method, pop lowess identifies probes in two copy state using k means clustering on the segmented mean values, and subsequently normalizes the data by Lowess regression using probes identified as references (). The weakness of this approach lies in that only coarse separation can be achieved because of probe pre-selection, and that k means clustering requires a pre-determined number of clusters. The ridge tracing normalization method normalizes CGH data by applying ridgeline regression on the highest ridgeline of a 2D log intensity distribution and then using the expectation maximization algorithm to centralize the copy number ratio. This method assumes that the most frequently occurring copy number probes correspond to the two copy states (). More recently, iterative normalization strategies, such as ITALICS (for one channel array) and cgh normal iter (for two-channel array), have been proposed (). In both cases, segmentation is the key step, and the subsequent normalization depends on the results of segmentation. tumor boost () was developed to normalize the allele B fraction in tumor, whereas total copy number signals are not normalized. In this article, we propose a new normalization procedure for SNP array data. This is motivated by the following reasons i Although applying paired samples in experimental design could substantially reduce noise in data, estimating the true copy number is often complicated by other experimental and biological factors, such as imperfect dissection of the primary tumors, the existence of the multiple clones in the tumor cell population, ploidy of a sample, the spatial signal variation and so forth. These factors can reduce the expected signal noise ratio (SNR) and make it difficult to accurately estimate the true underlying copy number (). As a result, the conventional segmentation methods such as circular binary segmentation (CBS) (), which works well in partitioning a SNP sequence into segments of the same underlying copy number, do not provide estimation of the underlying copy number for each segment. (ii) Almost all current normalization methods do not take into consideration the existence of cnl oh. Since the mean value of probes in a cnl oh segment may be slightly different (but not significantly) from the mean value of probes in segments with true normal two copy state, it is difficult to identify and subsequently remove them from the reference probe set. Therefore, it is necessary to develop new strategies that have strong statistical power in distinguishing probes in two copy state from those having CNAs and simultaneously take into account the existence of cnl oh. We will briefly present Affymetrix SNP arrays in the next section, and then describe the proposed algorithm in two parts. The first part is to partition probes into the segments of UMS (uni-modal state, defined in Section 2) or BMS (bi-modal state) using a Hidden Markov Model (HMM). The second part is to apply the CBS segmentation method on the piecewise average log ratio pa log ratio defined in Section 2.3) to separate probes in two copy state and other even number copy number states. The application of our method on a publicly available dataset, followed by a comparison of our method with two currently available methods, is presented in Section 3. At the end of the article, we discuss the advantages and limitations of our method and possible improvements.

discussion correctly identifying reference probes in two copy state from the SNP array is not trivial. We propose an algorithm, PAIR, that can accurately distinguish two copy state probes from those with CNAs. The proposed PAIR algorithm first partitions the whole genome into segments of UMS or BMS. The normal two copy probes, if they exist, can then be narrowed down to the segments of UMS. This algorithm does not assume that two copy probes dominate the whole genome. This is an advantage compared with the methods that require this assumption. In contrast to the conventional methods, PAIR has the advantage of being able to identify segments of cnl oh. This is preferable, as the mean log ratio values of probes in some cnl oh segments can be different from those in normal two copy segments, and this could cause a bias in the step of centralization should the cnl oh segment be large. Furthermore, with the optional allelic normalization, we are able to equalize the log intensities of A and B alleles, and thus remove one source of false discovery. We did not integrate log ratio and da log r analyses into the HMM model, but instead, we adopted a two step process. In Part II, we applied CBS segmentation to pa log ratios instead of the raw log ratios. By doing so, we could substantially reduce the computational time. Meanwhile, comparing with the methods using log ratio the risk of false detection can be reduced if signal drift and uncorrected genomic wave exist (). We obtained the monotone relationship between log ratio and da log ratio and proposed to use da log ratio instead of BAF in cnl oh detection and underlying copy number estimation to avoid unnecessary data manipulation. The proposed method reduced the computation time when comparing with cgh normal iter. For the samples with a large number of segments, it takes only 35 min to complete the normalization process using our method, but usually 2030 min using cgh normal iter when the algorithms were run on Lenovo T400 laptop. CNAs are different from sample to sample, and sometimes can be complicated. It may be difficult to fully specify all CNA forms by a HMM model. Bearing this in mind, the proposed two state model, although it might miss some focal CNAs, can greatly reduce the risk of misclassification of large segments of CNAs. This, in our opinion, is sufficient for a normalization method to be acceptable. One of the assumptions of the PAIR algorithm is that there are at least some normal two copy heterozygous probes in the genome that need not to be dominated. The simulation result shows that the PAIR algorithm has almost 100% power for correctly detecting the normal two copy states when the proportion of two copy state probes are as low as 10%. In the extreme cases where virtually no two copy probes exist, that is, the whole genome is in the same state, we could still determine whether the whole genome is in one copy gain loss from two copy. It will be more challenging to accurately centralize the probes. However, this is not the focus of this article.
