Motivation: Genomic studies have revealed a substantial heritable component of the transcriptional state of the cell. To fully understand the genetic regulation of gene expression variability, it is important to study the effect of genotype in the context of external factors such as alternative environmental conditions. In model systems, explicit environmental perturbations have been considered for this purpose, allowing to directly test for environment specific genetic effects. However, such experiments are limited to species that can be profiled in controlled environments, hampering their use in important systems such as human. Moreover, even in seemingly tightly regulated experimental conditions, subtle environmental perturbations can not be ruled out, and hence unknown environmental influences are frequent. Here, we propose a model based approach to simultaneously infer unmeasured environmental factors from gene expression profiles and use them in genetic analyses, identifying environment specific associations between polymorphic loci and individual gene expression traits. Results: In extensive simulation studies, we show that our method is able to accurately reconstruct environmental factors and their interactions with genotype in a variety of settings. We further illustrate the use of our model in a real world dataset in which one environmental factor has been explicitly experimentally controlled. Our method is able to accurately reconstruct the true underlying environmental factor even if it is not given as an input, allowing to detect genuine genotype environment interactions. In addition to the known environmental factor, we find unmeasured factors involved in novel genotypeâ€“ environment interactions. Our results suggest that interactions with both known and unknown environmental factors significantly contribute to gene expression variability. Availability: and implementation: Software available at http://pmbio.

introduction large scale genotyping and expression profiling initiatives have fostered expression quantitative trait loci e qtl analyses, investigating the genetic component of gene expression variability. e qtl studies in human (), segregating yeast strains (), mouse () and Arabidopsis thaliana () have revealed an abundance of associations between genetic polym opr his ms and the expression levels of individual genes. While building this compendium of e qtls in different genetic systems and species, it has become clear that the cellular and environmental context needs to be taken into account to fully understand the genetic architecture of gene expression (). One route toward investigating such context dependency is explicit experimental stratification. In human, expression profiling in different tissue types, both in unrelated individuals () and families (), has shown that e qtls frequently have tissue specific effect sizes, and in some cases exhibit opposite effects. Analogously, also different environmental backgrounds and cellular contexts may modulate the genetic control of molecular traits (), suggesting that environment specific genetic effects, also called genotype environment interactions, are the rule rather than the exception. Despite their relevance, molecular studies with explicit environmental perturbations are difficult to carry out in population scale studies. Precise control of the environmental state can not be achieved for many important organisms. For example in human, the relevant environment could be of climatological or social nature, and hence is either completely unknown () or can only be indirectly influenced via targeted sample selection (). Furthermore, the most relevant factors for molecular regulation may not be a global external condition but rather cellular factors, which are in turn driven by genetic or external factors (). In all of these settings, the most relevant context and environment are not directly measurable; hence, statistical inference of these factors is needed to study their implications on the transcriptional state. *To whom correspondence should be addressed recently several methods have been proposed to account for unknown confounding in e qtl studies, a substantial proportion of which can be attributed to subtle environmental effects (). While these methods have been shown to substantially increase power in detecting true e qtls the potential of using such recovered factors to identify genotype environment interactions has largely been overlooked. Here, we present an integrated probabilistic model, LInear Mixed Model Interaction lim mi which allows for recovering unknown environmental or cellular factors from gene expression profiles and detecting genotype environment interactions. lim mi allows for a flexible class of environmental and genetic effects that act on gene expression, including direct effects and interactions between them (). At the same time, the model enforces that the estimated factors are truly environmental and not themselves under genetic control. We evaluate lim mi on synthetic data, where we assess the ability of lim mi to (i) recover the true simulated environmental state, (ii) better detect direct genetic effects and, in particular, (iii) identify genotype environment interactions with unmeasured environmental factors. We then revisit an e qtl study on yeast (), where we compare the inference of lim mi with a measured environmental variable. Beyond accurately recovering this known environmental effect, lim mi retrieves an additional 14 factors that are orthogonal to the genetic state. When using these factors to test for environment specific genetic effects, we find hotspots of genotype environment interactions, some of which are enriched for known response processes to environmental stimuli. Finally, we demonstrate that including interactions between genotype and learnt factors in a mixed model improves both detection power as well as calibration of test statistics for direct genetic effects in an e qtl scan.

discussion here we have presented a novel approach to detect genotype environment interactions with unmeasured environmental factors. lim mi is able to recover the unmeasured environmental state solely from gene expression data. Once learnt, these variables can be used in genetic analyses to investigate interactions between environmental factors and genotype with a regulatory effect on gene expression traits. Approaches like lim mi are relevant for virtually any genetic study of high dimensional molecular traits, in particular if the environmental state is only partially measured or remains entirely unknown (). Here, we illustrated and assessed lim mi in simulated examples and in retrospective analyses of data from yeast genetics. We compared genotype environment interactions with learnt environments with interactions found when using explicit environmental measurements. First, lim mi was able to accurately detect previously known interactions. Second, we found novel genotype environment interactions beyond what can be detected when relying on the measured environmental state. These additional effects were predominantly trans-acting, with some loci having widespread effects on large fractions of the expression traits. In the case of the largest hotspot, the interacting locus overlapped with a group of genes involved in temperature sensitivity, providing a plausible explanation of the mechanistic underpinning of this finding. Finally, we have shown how the recovered interactions can be used to refine statistical testing procedures. Accounting for the effect of genotype environment interactions within a lim mi e qtl scan resulted in increased power to detect true associations in simulations and yielded improved test statistics on real data. lim mi is related to a range of existing factor models, in particular techniques that model hidden expression determinants to correct for their confounding effect. These methods can be broadly grouped in two classes: models that are aimed at retrieving a set of confounding factors explicitly () and models that account for the variance introduced by confounding factors (). In principle, any of the models that retrieve an explicit representation of factors can be used for interaction analyses like the one presented here. Specifically, in this article, we implemented a version of our method that was using SVA for this purpose. lim mi is most closely related and builds on PANAMA (); however, we propose a new route toward understanding the role of the environment in a genetic context rather than merely 'correcting it away'. For this purpose, we extend PANAMA in several ways. First, we introduce a systematic approach to use inferred environments to test for genotype environment interactions while accounting for the effect of unknown environments. Second, we show how the detected genotype environment interactions can be used to further refine the statistical testing of e qtls. Other methods like SVA (), PEER () and the method by list garten et al. () do not focus on recovering interactions per se, although we have created a modified variant of SVA for the purpose of comparison. The main shortcoming of these techniques is the lack of an effective mechanism to ensure that the learnt factors are not driven by genotype, which leads to the inferior performance of lim mis va in our experiments. In conclusion, lim mi is a methodological advance that allows for refined inference of environmental factors from molecular profiling data. When used in genetic analyses, these learnt variables help to improve the mechanistic understanding of molecular traits, thereby increasing the fraction of phenotype variability that can be explained. Approaches as the one presented here will become even more useful when dataset sizes increase further, providing sufficient power to estimate even more complex models and effect types between the genetic state, known and hidden environments and the transcriptional state of the cell.
