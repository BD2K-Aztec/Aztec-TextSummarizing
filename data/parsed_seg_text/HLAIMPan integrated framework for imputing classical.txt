Motivation: Genetic variation at classical HLA alleles influences many phenotypes, including susceptibility to autoimmune disease, resistance to pathogens and the risk of adverse drug reactions. However, classical HLA typing methods are often prohibitively expensive for large scale studies. We previously described a method for imputing classical alleles from linked SNP genotype data. Here, we present a modification of the original algorithm implemented in a freely available software suite that combines local data preparation and QC with probabilistic imputation through a remote server. Results: We introduce two modifications to the original algorithm. First, we present a novel SNP selection function that leads to pronounced increases (up by 40% in some scenarios) in call rate. Second, we develop a parallelized model building algorithm that allows us to process a reference set of over 2500 individuals. In a validation experiment, we show that our framework produces highly accurate HLA type imputations at class I and class II loci for independent datasets: at call rates of 95â€“99%, imputation accuracy is between 92% and 98% at the four digit level and over 97% at the two digit level. We demonstrate utility of the method through analysis of a genome wide association study for psoriasis where there is a known classical HLA risk allele (HLA-C*06:02). We show that the imputed allele shows stronger association with disease than any single SNP within the region. The imputation framework, hla imp provides a powerful tool for dissecting the architecture of genetic risk within the HLA. Availability: hla imp implemented in C++ and Perl, is available from http://oxfordhla.well.ox.ac.uk and is free for academic use.

introduction an individual's Human Leukocyte Antigen (HLA) type, which describes the primary structure of the antigen presenting classical HLA proteins, is an essential immuno genetic parameter, which influences susceptibility to many autoimmune and infectious diseases (), the risk of certain types of cancer (; Wang * To whom correspondence should be addressed), transplant compatibility () and the likelihood of adverse drug reactions (). In many autoimmune diseases, the HLA contributes the major fraction of genetic risk (). It is generally believed that this is related to variation in the HLA proteins' binding affinities, but the exact nature of the underlying mechanisms has remained elusive in most cases. Because of the functional importance of the proteins, there is a considerable need for HLA type data in biomedical research, either as an explanatory variable (for example, in searching for factors influencing adverse drug reactions) or a covariate (for example, in looking for secondary risk factors in the HLA where there is a well characterized primary classical risk allele). HLA type information can be useful in interpreting results from genome wide association studies g was. For example, a recent g was on psoriasis identified a SNP at the ERAP1 locus, which is associated with a significant increase in disease risk, but only in HLA-C*06:02 positive individuals (). However, lab based HLA genotyping (through either direct sequencing, allele specific amplification or hybridization) is typically slow and relatively expensive (costs are several hundred dollars per individual for high quality allelic information at key class I and class II loci). In contrast, imputation of classical alleles from linked SNP data, while it can never achieve the degree of certainty of lab based methods, is fast and inexpensive. This is particularly true for samples for which genome wide SNP data have been collected as part of a g was. In such situations, imputation can be performed at no additional cost and with sufficient accuracy to enable the analysis of large scale datasets (). Imputation of classical HLA alleles is complicated by the genomic features of the HLA including extensive polymorphism (e.g. h lab with 1600 alleles), long range haplotype backgrounds and the influence of natural selection (). de have shown that while some classical alleles can be tagged by single SNPs, this is not generally true and experience has shown that standard SNP tagging approaches do not perform consistently well. To overcome these problems, we previously developed a probabilistic approach to classical HLA allele imputation (), here referred to as the ld mhc algorithm, which assesses the degree of relatedness between a chromosome with unknown HLA type but known SNP types in the region and a reference set of both SNP and hla typed chromosomes, based on SNP genotypes alone. Prior to the actual imputation procedure, the employed statistical model is constructed by iteratively selecting informative SNPs in the reference set from
