Motivation: Rapid development in sequencing technologies has dramatically improved our ability to detect genetic variants in human genome. However, current methods have variable sensitivities in detecting different types of genetic variants. One type of such genetic variants that is especially hard to detect is inversions. Analysis of public databases showed that few short inversions have been reported so far. Unlike reads that contain small insertions or deletions, which will be considered through gap alignment, reads carrying short inversions often have poor mapping quality or are unmapped, thus are often not further considered. As a result, the majority of short inversions might have been overlooked and require special algorithms for their detection. Results: Here, we introduce sr inversion a framework to analyze poorly mapped or unmapped reads by splitting and realigning them for the purpose of inversion detection. sr inversion is very sensitive to small inversions and can detect those less than 10 bp in size. We applied sr inversion to both simulated data and high coverage sequencing data from the 1000 Genomes Project and compared the results with those from pin del break dancer DELLY, Gustaf and MID. A better performance of sr inversion was achieved for both datasets for the detection of small inversions. Availability and Implementation: sr inversion is implemented in Perl and is publicly available at

introduction inversions are a type of structural variations (SVs) that may play an important role in human genetic diversity and disease susceptibility (). Nevertheless, unlike other SVs such as deletions, insertions and cn vs detection of inversions has been lagging behind. Analysis of sequencing data was reported to be able to find around 80% of known deletions, but for inversions the fraction of detection is still insignificant so far (). As shown in Supplementary, summary of all records on SVs to date from public databases such as db var () and dg va () demonstrated an obvious lack of documentation of inversions, especially for small inversions (1 bp to around 100 bp). This is inconsistent with previous suggestions that small SVs are much more frequent in the genome than large SVs (), suggesting that the majority of inversions might remain to be identified. Several computational methods are available to detect SVs based on short read sequencing data, most of which have the function for inversion detection (). But only one () of these tools was designed specifically for detecting short inversions. Most of these tools rely on signals of inconsistent mapping directions of the reads in a read pair in paired end sequencing (), which requires both reads of the pair to be mappable to the reference genome and one read to almost entirely overlap with the inversion. As a consequence, this limits the minimum length of inversions that can be detected to at least longer than the read length. Software such as pin del () tries to solve this problem by combining paired end method with split read method, which makes it possible to detect inversions that are shorter than the read length. However, by requiring at least one end of the read to be mapped to the reference genome to serve as an anchor, it loses power in detecting certain inversions such as those adjacent to other complex SVs or repeat regions, which are common for inversions as reported previously () and in this study. Here we introduce sr inversion a framework that applies a split read method on next generation sequencing (NGS) data to detect inversions smaller than 1kb. Instead of relying only on mapped reads as anchors, sr inversion also makes use of poorly mapped or unmapped reads, splits or inverts them, and then re-aligns them to the reference genome to detect inversions (). By considering the unmapped reads, which are overlooked for inversion detection by other tools, the sensitivity of inversion detection is improved significantly. This is because for short inversions, especially those shorter than the read length, most of the reads covering them are usually poorly mapped or unmapped. Gustaf () and MID () also try to use poorly mapped reads to generate split map contigs for short inversion detection. However, the sensitivities of these methods are affected by their pre-requisites such as requiring both ends of each read be mapped to the reference genome with high confidence. We applied sr inversion to both simulated data and real data from a parent child trio from the 1000 Genomes Project. pin del break dancer DELLY, Gustaf and MID were also applied on both datasets and the results were compared. A better performance for sr inversion was achieved on both datasets, especially for small inversions step 1: Extract poorly mapped reads. In scenario 1, reads partially covering inversion region and marked as soft clipped by BWA are extracted, and in scenario 2, reads covering the whole inversion region and considered unmapped are extracted. Step 2: Split reads. In scenario 1, each extracted read will be split into two segments at different split sites, and in scenario 2, for each read, sequence within windows of different sizes at different sites will be changed into reverse complement sequence. Step 3: Re-map reads. Segment generated from step 2 are aligned back to the reference and only segment pairs or segments that are exactly matched are selected for step 4. Step 4: Inversion region detection. Each matched segment or segment pair from step 3 produces a start and end position of the inversion it covers, and by merging those positions from different reads, inversion region can be determined
