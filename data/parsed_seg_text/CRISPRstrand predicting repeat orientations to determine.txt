Motivation: The discovery of crisp rcas systems almost 20 years ago rapidly changed our perception of the bacterial and archaeal immune systems. crisp r loci consist of several repetitive DNA sequences called repeats, inter spaced by stretches of variable length sequences called spacers. This crisp r array is transcribed and processed into multiple mature RNA species c rrnas. A single c rrna is integrated into an interference complex, together with crisp r associated (Cas) proteins, to bind and degrade invading nucleic acids. Although existing bioinformatics tools can recognize crisp r loci by their characteristic repeat spacer architecture, they generally output crisp r arrays of ambiguous orientation and thus do not determine the strand from which c rrnas are processed. Knowledge of the correct orientation is crucial for many tasks, including the classification of crisp r conservation, the detection of leader regions, the identification of target sites proto spacers on invading genetic elements and the characterization of proto spacer adjacent motifs. Results: We present a fast and accurate tool to determine the c rrna encoding strand at crisp r loci by predicting the correct orientation of repeats based on an advanced machine learning approach. Both the repeat sequence and mutation information were encoded and processed by an efficient graph kernel to learn higher order correlations. The model was trained and tested on curated data comprising 44500 crisp rs and yielded a remarkable performance of 0.95 AUC ROC (area under the curve of the receiver operator characteristic). In addition, we show that accurate orientation information greatly improved detection of conserved repeat sequence families and structure motifs. We integrated crisp r strand predictions into our crisp r map web server of crisp r conservation and updated the latter to version 2.0. Availability: crisp r map and crisp r strand are available at http://

introduction crisp rcas immune systems of bacteria and archaea provide adaptive defence against a variety of invading genetic elements. They have been classified into three major classes: Types I, II and III, where Type II systems are confined to bacteria (). The adaptive immune response of all types is divided into three major phases: (i) adaptation, the uptake of DNA fragments from genetic elements and their insertion between consecutive repeats of a crisp r array, generally adjacent to a leader sequence; (ii) processing of the crisp r array transcripts within the repeats to generate small c rrnas that derive from part or all of each spacer region and (iii) interference involving targeting and cleavage of an invading genetic element, or its transcripts, by Cas protein c rrna complexes barran gou and van der Oost, 2013, and). Whereas the adaptation phase is relatively conserved in the different crisp rcas systems, significant differences occur in the processing and interference mechanisms. Thus, where Type I and III systems employ a Cas6 processing endonuclease to cleave within the repeats, the bacterial Type II system uses the host encoded RNase III, together with a crisp r associated trans encoded trac rrna (). Furthermore, the various interference complexes exhibit considerable diversity (). We developed an efficient tool for determining the strand from which mature c rrnas are derived by focussing on the repeats at crisp r loci. The repeats are unique within the crisp rcas system because they are the only element to play a vital role in all phases of immunity (). Thus, despite their relatively short lengths, each repeat carries essential structural parameters or sequence motifs that are recognized by enzymes or structural proteins involved in adaptation, c rrna biogenesis and interference. Paradoxically, however, the repeats are very heterogeneous, occurring in a range of lengths, 1948 nt, and display considerable sequence diversity. An early comparative study of crisp r diversity yielded 12 main clusters with specific sequence characteristics; only a subset folded into characteristic hairpin structure motifs (). More recently, a major reevaluation of crisp r conservation was executed by, on a much larger data set of 3527 crisp rs where 40 conserved repeat sequence families were identified together with a total of 33 potential structural motifs. The repeat clusters were further classified into six superclasses, some of which showed strong biases to specific crisp r subtypes and to certain bacterial or archaeal phyla (). crisp r loci are generally identified by their characteristic repeat spacer architecture. For example CRT () and crisp r finder () provide sensitive predictions of crisp r arrays, but do not provide unambiguous orientation information. In the literature, orientation is derived *To whom correspondence should be addressed. mainly by characteristic sequence motifs in the repeat, the detection of a conserved leader region in closely related crisp r loci or by transcriptome experiments where the dominantly transcribed strand is determined. However, to date very few systems have been studied experimentally, and many large scale studies require accurate orientation information for all available crisp r arrays. recently has presented the first tool to predict the orientation of crisp r arrays. Their model is essentially a linear predictor based on a number of features which comprise the presence of the a ttgaa an motif in repeats, a higher A or T content in the flanking regions of crisp r arrays, nucleotide composition within the crisp r array, the presence of mutations in specific parts of the array and the tendency to fold into a secondary structure. Each feature is considered as an independent predictor and is given a weight proportional to its estimated precision. The final prediction is computed as the weighted combination of each predictor. Knowledge of the correct repeat orientation is crucial for accurate characterization of crisp r conservation and for subsequently studying mechanisms of adaptation, crisp r RNA processing and interference. In particular, it can help to (i) detect leader regions, currently poorly described in the literature; (ii) identify signals of transcription initiation and termination; (iii) determine the orientation of proto spacers on invading genetic elements; and finally, (iv) characterize cognate proto spacer adjacent motifs (PAMs). Thus, we consider that the repeat orientation tool presented here will be of critical importance for future crisp r based experimental studies.

conclusion we presented a highly flexible approach to accurately predict the transcribed strand of crisp r loci. The method is motivated by recent findings and encodes the most relevant information in the form of a graph structure that can be efficiently processed with graph kernel methods. Our tool compares favourably against a recent approach proposed in in terms of accuracy (0.95 compared to 0.88 AUC ROC), runtimes (59 s rather than 37 min on a 1K sequences dataset) and coverage (we achieve 0.89 AUC ROC on the 10% sequences that the Biswas tool fails to classify). Our approach was integrated in crisp r map () to improve the accuracy of the previously published classification of crisp rs and resulted in: (i) a comprehensive dataset with 44500 consensus repeats; (ii) the most recent classification of Cas subtypes based on cas protein occurrences for archaea (); and (iii) an improved annotation of Makarova Cas subtypes for bacteria respecting the rules published in. The orientation prediction approach that we have presented is fast, accurate and can be easily integrated in existing pipelines. In future work, we will employ it to ease the identification of novel targets proto spacers PAM motifs and the investigation of regulatory motifs in the leader sequences of crisp r arrays.
