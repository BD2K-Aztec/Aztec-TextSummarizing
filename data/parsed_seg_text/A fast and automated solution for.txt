Motivation: Accurate prediction of the domain content and arrangement in multi-domain proteins (which make up 65% of the large scale protein databases) provides a valuable tool for function prediction, comparative genomics and studies of molecular evolution. However, scanning a multi-domain protein against a database of domain sequence profiles can often produce conflicting and overlapping matches. We have developed a novel method that employs heaviest weighted clique finding (HCF), which we show significantly outperforms standard published approaches based on successively assigning the best non-overlapping match (Best Match Cascade, BMC). Results: We created benchmark data set of structural domain assignments in the CATH database and a corresponding set of Hidden Markov model based domain predictions. Using these, we demonstrate that by considering all possible combinations of matches using the HCF approach, we achieve much higher prediction accuracy than the standard BMC method. We also show that it is essential to allow overlapping domain matches to a query in order to identify correct domain assignments. Furthermore, we introduce a straightforward and effective protocol for resolving any overlapping assignments, and producing a single set of non-overlapping predicted domains. Availability and implementation: The new approach will be used to determine md as for UniProt and Ensembl, and made available via the Gene3D website

introduction an active field of bioinformatics pursues the identification and classification of protein domain families. This is critical to our understanding of how proteins evolve new functions and how domain family content can explain phenotypic variation between organisms. From an annotation perspective, newly * To whom correspondence should be addressed.  The authors wish it to be known that, in their opinion, the first two authors should be regarded as joint First Authors. sequence genomes can be scanned against libraries of domain families in order to predict the function of novel genes (). However, due to both the huge number of sequences in the protein databases, and also the large number of domain families, it is essential to use fast robust sequence analysis and comparison techniques. Furthermore, unless manual validation is used when building profiles of families, a given query sequence can generate many conflicting and overlapping matches. These are the result of complex structural rearrangements and gene fusion events that have occurred throughout evolutionary history. Resources such as InterPro and Pfam () apply extensive curation of their family models and the resulting predictions. In contrast, fully automated protocols remain useful in helping identify novel families that are then fed into the manual curation pipelines, rather than directly used for biological analyses (i.e. pfam b add a and CHOP;). However, using manual verification is very expensive and time consuming, and will become increasingly so in the era of high throughput sequencing. Gene3D (), a member of the InterPro consortium, provides domain annotations based on the CATH structural domain classification (). CATH provides a manually validated set of domains derived from structures in the PDB (), and these domains are grouped into superfamilies where there is evidence of common evolutionary ancestry from shared sequence, structural and functional features. Gene3D uses a similar approach to the SUPERFAMILY resource (), which is based on the SCOP structural classification (). A set of structural representatives are chosen from each superfamily in CATH and used to seed an automatic iterative search process (SAM target 2k. The resulting multiple sequence alignment is then converted into a Hidden Markov Model (HMM). Each superfamily may be represented by more than one model, with an average of four per superfamily. These models are then used to identify probable homologous domains in protein sequences, and the resulting predictions merged into a final set of assignments. Gene3D aims to provide high quality structural domain annotations for the major genome and protein sequence databases, including Ensembl (), UniProt () and RefSeq ()see Supplementary Data for example genome coverage. The annotation pipeline for determining a multi-domain architecture of a given query sequence () can be considered to consist of three main steps 1 Generate a HMM model library to represent structural domains in CATH.(2) Scan the query against the model library using hmm sequence search software (e.g. HMMER2).

discussion accurate prediction of multi-domain architectures can be extremely useful for many function and network prediction methods, including phylogenetic profiling, gene fusion detection, protein protein interaction inheritance, and annotation by homology transfer. However, current automated approaches are of unknown accuracy or are compared with Pfam or InterPro, where manual curation requires substantial investment. Both resources also contain many families that are not based on single domains, which in turn creates problems when benchmarking domain related methods, such as ab initio domain prediction algorithms. Gene3D aims to be a gold standard provider of domain family assignments, of equivalent accuracy to the manually curated resources. So we set out in the first instance to define a useful measure of our accuracy in predicting multidomain architectures, and then to improve on those predictions. Since it is not possible to accurately estimate performance over UniProt, we have generated a pdb based benchmark that provides a means of comparing different algorithms (i.e. BMC versus HCF). Furthermore, we show that the results are likely to hold true for scanning large protein sequence repositories, by simulating cases of un characterised domain superfamilies and the absence of close relatives. The benchmarks suggest that using DF3HCF and 30 residue allowed overlap leads to a 35% increase in accuracy compared to the old DF protocol for predicting multi-domain architecture from a list of matches to a HMM model library. Including single domain proteins, the overall accuracy is 95%, with many of the errors due to erroneous structures and assignments in the PDB and CATH. Most of the increase in multi-domain prediction accuracy is due to the loss of false negatives, and so would be expected to translate into an increased number of domains found in the sequence databases. As expected, the number of domains found in UniProt and Ensembl increased by 1520%. As of Gene3D version 8 all annotations have been generated using DF3. There remains some room for improvement on the specific failures, and many common MDA archetypes, especially transmembrane proteins, are simply not present in the PDB.
