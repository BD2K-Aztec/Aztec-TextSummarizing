Motivation: Over the recent years, the field of whole meta genome shotgun sequencing has witnessed significant growth owing to the high throughput sequencing technologies that allow sequencing genomic samples cheaper, faster and with better coverage than before. This technical advancement has initiated the trend of sequen-cing multiple samples in different conditions or environments to explore the similarities and dissimilarities of the microbial communities. Examples include the human microbio me project and various studies of the human intestinal tract. With the availability of ever larger databases of such measurements, finding samples similar to a given query sample is becoming a central operation. Results: In this article, we develop a content based exploration and retrieval method for whole meta genome sequencing samples. We apply a distributed string mining framework to efficiently extract all informative sequence km ers from a pool of meta genomic samples and use them to measure the dissimilarity between two samples. We evaluate the performance of the proposed approach on two human gut meta genome datasets as well as human microbio me project meta genomic samples. We observe significant enrichment for diseased gut samples in results of queries with another diseased sample and high accuracy in discriminating between different body sites even though the method is unsupervised. Availability and implementation: A software implementation of the DSM framework is available at https://github.com/HIITMetagenomics/

introduction meta genomics is the study of microbial communities in their natural habitat using genomics techniques (). It is undergoing a boom owing to the proliferation of high throughput sequencing technologies. Many studies focus at targeted sequencing of specific marker genes such as the 16S rRNA gene in bacteria, but recently there has been a growing interest in whole meta genome sequencing (e.g. Human microbio me. Although targeted studies provide data for phylogenetic profiling at a lower cost, whole meta genomes provide much more information, for example, about the collective metabolism () and the population genetics of the community (). Recent studies have also found associations between features of whole human gut meta genomes and type II diabetes (). New data are accumulating rapidly, with a popular web based mgr ast server () listing almost 3000 public whole meta genomes. Analyzing whole meta genome shotgun (WMS) sequencing data is very challenging. The original sample typically contains genetic material from hundreds to thousands of bacterial species of different abundances (), most of which have not been fully sequenced previously. After sequencing, we obtain a huge collection of short sequence reads whose species of origin is unknown. Although significant progress has been made, analysis relying on either the limited previously annotated genomes, or assembling the reads into novel more complete genomes, remains difficult and inefficient, and potentially susceptible to annotation biases. In this article, we introduce an efficient purely data driven feature extraction and selection method as well as similarity measures for WMS sequencing datasets, and apply them in retrieval of similar datasets. Such content based retrieval is an extremely powerful tool for exploration of the data and generating hypotheses of disease associations, as previously demonstrated with gene expression data (). Retrieval from existing databases makes it possible to automatically explore a much greater variety of hypotheses than relying solely on the more common specifically designed focused studies. content based similarity measures and retrieval of similar meta genomic datasets have been suggested previously (), based on quantifying abundances over a relatively small number of predetermined features requiring existing annotation. Up to some thousands of known tax a genes or metabolic pathways have been used. We introduce similarity measures that are based solely on raw sequencing reads, and hence, unbiased and insensitive to the quality of the existing annotation. A similar measure has been previously suggested by, but only for pairwise comparisons using a method that is computationally too expensive to scale to even modestly large *To whom correspondence should be addressed.  The Author 2014. Published by Oxford University Press. This is an Open Access article distributed under the terms of the Creative Commons Attribution License (http://creativecommons.org/licenses/by/3.0/), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited. datasets. Furthermore, instead of considering all sequences of particular length, also known as km ers as has been done earlier for other tasks and by, we employ an efficient distributed string mining (DSM) algorithm to find informative subsequences that can be of any length. To deal with the large number of features, some feature selection is necessary. Previous approaches for detecting relevant features in meta genomic data have been based on direct comparison of two classes of samples. Again, most of these methods work on up to some thousands of features (), with the notable exception of one study () where quantification and association testing was done for 44.3 million predefined genes. Without feature selection, one can use short km ers () or limit to a set of km ers that are likely to be informative, such as km ers associated with well characterised protein families (). Although there are no previous examples of unsupervised feature selection for meta genomics it is a common practice in information retrieval with text documents (); a particularly relevant method assesses the entropy of the distribution of documents in which a specific term occurs (). We evaluate the performance of the proposed unsupervised, unconstrained retrieval method on synthetic data, as well as meta genomic samples from human body sites (). To evaluate the performance of the retrieval engine, we use external validation based on a ground truth similarity between two samples. To simplify this process, we consider a binary similarity, which is crude but easily accessible. The human gut samples in () come from studies exploring the change in bacterial species composition between healthy persons and either inflammatory bowel disease (IBD) or type II diabetes. We utilize disease state to construct a binary ground truth. Thus, we study if, given the meta genomic sample of a person with a disease, the retrieval finds meta genomic samples related by having the same disease. In the body site data (Human microbio me we use the body sites as ground truth to investigate whether it is possible to identify the bacterial communities at different body sites in an unsupervised setting without the need of reference genomes. It should be noted that especially for the gut data, two samples may be related in other ways too. The external validation with one simple ground truth nonetheless provides an objective platform for comparing different methods. Given that the method is unsupervised and hence completely oblivious of the disease labels, if such retrieval is successful, it is a promising starting point for developing methods for leveraging data from earlier patients in early detection of disease and personalized medicine. of a retrieval task, (iii) compute a distance metric using the filtered km er frequencies, and (iv) execute these steps fast without explicitly storing the frequency values summarizes the method.

conclusion in the wake of collecting multiple samples from similar environments, information retrieval for meta genomic samples is expected to become a handy tool in meta genomics research. In this article, we have addressed the problem of retrieving relevant meta genomic samples given a query sample from the same collection. The novelty of the proposed approach is that it is unsupervised, and does not rely on the availability of reference databases. We, for proposed approach 'All', individual ks as well as fig fam based distance metric. The metrics are optimized averaged over 101 equally spaced threshold values between 0 and 1. Each error bar line shows the MAP value along with the standard error. The grey horizontal line shows retrieval by chance: MAP computed over zero dissimilarity metric. An arrow (if present) over a method implies whether the performance of the corresponding method (top: 'average metric', bottom: 'optimized metric') is better (") or worse (#) than when entropy filtering is employed: The stars denote significance level: 05***50.0015**50.015*50.05. We observe that filtering has a positive impact on the retrieval performance. Comparison of best performances for different km er lengths. The figures show the performance over queries by all positive samples as a violin plot. All methods use the 'optimized metric' chosen over 101 equally spaced threshold values between 0 and 1: the box denotes the MAP value. The horizontal lines show retrieval by chance: ave p computed over zero dissimilarity metric. Straight line is the mean, and dotted lines are 5 and 95% quantiles, respectively, when number of relevant samples differ for different queries. An arrow (if present) over a method implies whether the corresponding method performs significantly better (") or worse (#) than 'All': The stars denote significance level: 05***50.0015**50.015*50.05. We observe that the considering all km ers usually perform equally well with respect to considering a single k
