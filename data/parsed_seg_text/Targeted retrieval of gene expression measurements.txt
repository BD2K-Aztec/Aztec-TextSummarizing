Motivation: Large public repositories of gene expression measurements offer the opportunity to position a new experiment into the context of earlier studies. While previous methods rely on experimental annotation or global similarity of expression profiles across genes or gene sets, we compare experiments by measuring similarity based on an unsupervised, data driven regulatory model around pre-specified genes of interest. Our experiment retrieval approach is novel in two conceptual respects: (i) target able focus and interpret-ability: the analysis is targeted at regulatory relationships of genes that are relevant to the analyst or come from prior knowledge; (ii) regulatory model based similarity measure: related experiments are retrieved based on the strength of inferred regulatory links between genes. Results: We learn a model for the regulation of specific genes from a data repository and exploit it to construct a similarity metric for an information retrieval task. We use the Fisher kernel, a rigorous similarity measure that typically has been applied to use generative models in discriminative classifiers. Results on human and plant microarray collections indicate that our method is able to substantially improve the retrieval of related experiments against standard methods. Furthermore, it allows the user to interpret biological conditions in terms of changes in link activity patterns. Our study of the osmotic stress network for Arabidopsis thaliana shows that the method successfully identifies relevant relationships around given key genes. Availability: The code (R) is available at

introduction considerable effort has been spent on collecting gene expression measurements into huge public repositories. This has opened up the door to large scale comparisons and meta analysis of data from different experiments. A crucial question is how to find datasets that are biologically relevant for a certain phenomenon under study. The common way to obtain relevant data from repositories is keyword search (for instance,); however, the reliability and usefulness of this approach fully depend on the availability and quality of data annotation, and on the existence of good standardized keywords. Therefore, content based retrieval methods have received attention recently. In addition to detecting other relevant datasets, such methods can assist in automatic prediction of annotations and in discovering previously unknown relationships between different biological conditions. Previous data driven approaches for relating gene expression profiles can be grouped by two criteria: the representation of gene expression profiles and the similarity measure for comparing profiles. Regarding the representation, there exist three common alternatives: (i) activity profiles over genes, often differential rather than absolute values if control measurements are available, or simply rankings of genes (); (ii) activity profiles over known gene sets (also called pathways or signatures;) and (iii) activity profiles over gene modules predicted from other data sources (e.g. protein protein interactions;). The most widely used similarity measures are Pearson and Spearman correlation (); other search tools take signatures of up and down-regulated genes as a query and compute rank based scores against the measurements in a database (); neither approach is fitted in any way to the database. In contrast, several approaches derive features from the database or learn a model of it; the results are then used when computing the similarity of the query to database entries. In the simplest case, variances of gene or gene set activity values are determined from the data compendium, and then exploited for calculating a weighted correlation coefficient (); beyond that, one can apply dimensionality reduction techniques to learn low dimensional feature spaces that represent the data appropriately ().) proposed probabilistic generative *To whom correspondence should be addressed. latent variable models that inherently yield probabilistic similarity measures between gene expression profiles. In addition to these purely unsupervised methods, also supervised approaches have been proposed to relate gene expression experiments with each other (). The novelty of our approach lies in the fact that the model learned from the data compendium focuses on inferring the local regulatory network neighborhood of specific user defined genes of interest. As a well defined and intuitive model based retrieval criterion, we use the Fisher kernel (FK) (), which derives a similarity measure between data points from a generative model. Consequently, the comparison of biological samples is based on the differential activity of particular cellular processes only. The alternative of using global transcript omic models and hence global similarities between data would easily obscure the interesting local processes shared between measurements. The alternative of using known ontologies, on the other hand, would miss unknown regulatory patterns. In practice, the user can focus the modeling by providing known key genes involved in the biological process under study or genes whose connection to known pathways and experimental conditions is yet unclear. Our model driven targeted retrieval approach is intended to complement earlier tools for experiment retrieval targeted by query genes retrieve experiments where the query genes are differentially expressed retrieve datasets where the query genes are correlated, and Greene and troyan s kaya (2011) identify experimental conditions discriminating positive and negative query genes. As our approach models relationships of biological samples with respect to only a subset of genes, it shares some aspects with bi cluster detection methods, which are very popular in gene expression analysis (); defining genes of interest and a query sample can be seen as providing a seed bi cluster. However, in contrast to bi cluster approaches, we bring the structure of gene networks into the similarity criterion. A related approach has been proposed by, but it assumes a given network whereas we infer the network around the target genes. Furthermore, none of the earlier bi clustering type approaches has been designed for retrieval. In a nutshell, our approach consists of the following components, which will be described in detail in Section 2. First, a regulatory model of gene expression is learned from the database; to allow for more user interaction and better individual interpretability, the model focuses on relationships around user defined genes of interest; here, we use a set of local dependency models learned by sparse linear regression as a simple regulatory model (). Second, the model serves as a basis for comparing measurements: given a query measurement, the method ranks the measurements in the repository according to a model based similarity criterion, here a variant of the FK (). In Section 3, we show the effectiveness of our approach in a leukemia case study with a human microarray compendium and in an osmotic stress study with a collection of plant stress datasets. Section 4 discusses the work and describes future extensions.

discussion we introduced a novel approach for targeted model based retrieval of gene expression measurements. The model we proposed is suitable for efficient retrieval; due to the decomposition into gene specific submodels, learning can be done offline, prior to the queries. Although we used l1 regularized regression to learn a simple regulatory model in this work, the approach is not limited to a specific type of probabilistic models. For instance, it is straightforward to use the elastic net approach (), and it is also possible to exploit additional data (e.g. protein protein interactions) or prior knowledge during learning. If the user specified genes are modeled jointly (e.g. by common predictors), more computational effort is required at query time; alternatively, the model may be provided directly by the user. In contrast to condition specific regulatory models (), our method does not rely on annotation of samples. The current modeling approach requires that data are comparable. To apply it in cross platform analysis, previous methods to achieve comparability can be used (). An interesting direction for future work is retrieval across different platforms or species using an integrated model. Besides allowing for unsupervised data based retrieval of related measurements, the proposed method assists in investigating relationships among genes. As illustrated in the osmotic stress example, measurements with curated annotation can help to assess the quality of models and to detect condition dependent activity changes. When applying targeted modeling, an important question is how to choose the target list for a biological process of interest. If it is too narrow, it might not have sufficient discriminative power; if it is too wide, the performance might suffer due to irrelevant genes. The retrieval framework allows the user to check different possibilities and to interactively improve the target list for her purposes. It also makes possible exploration of the types of retrieval results a particular target list yields, exploiting different kinds of annotations that are available for the database content. This can be useful if the user is interested in specific genes, but uncertain about the processes they are involved in. Finally, the targeted modeling and retrieval approach can be a useful analysis tool also for other omics type high throughput data with respect to the networks in; columns represent network links. The horizontal line separates osmotic stress samples from the other samples, the vertical lines separate the networks. The RD29A network is highly activated in osmotic stress samples. The DREB2A network is activated in UV-B samples and some osmotic stress samples. The AT2G46140 network is induced by pathogen infection and treatment with pathogen elicitors. Annotation of each sample can be found in Supplementary
