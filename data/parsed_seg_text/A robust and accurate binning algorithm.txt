Motivation: With the rapid development of next generation sequencing techniques, meta genomics also known as environmental genomics, has emerged as an exciting research area that enables us to analyze the microbial environment in which we live. An important step for meta genomic data analysis is the identification and taxonomic characterization of DNA fragments (reads or contigs) resulting from sequencing a sample of mixed species. This step is referred to as binning. Binning algorithms that are based on sequence similarity and sequence composition markers rely heavily on the reference genomes of known microorganisms or phylogenetic markers. Due to the limited availability of reference genomes and the bias and low availability of markers, these algorithms may not be applicable in all cases. Unsupervised binning algorithms which can handle fragments from unknown species provide an alternative approach. However, existing unsupervised binning algorithms only work on datasets either with balanced species abundance ratios or rather different abundance ratios, but not both. Results: In this article, we present meta cluster 3.0, an integrated binning method based on the unsupervised top down separation and bottom up merging strategy, which can bin meta genomic fragments of species with very balanced abundance ratios (say 1:1) to very different abundance ratios (e.g. 1:24) with consistently higher accuracy than existing methods. Availability: meta cluster 3.0 can be downloaded at

introduction traditional microbial genomic studies usually focus on one single individual bacterial strain due to experimental limitations. In fact, all microorganisms in a habitat have various functional effects on one another and their hosts. For example, the diversity of microbes in humans is shown to be associated with common diseases such as inflammatory bowel disease (IBD) () and gastrointestinal disturbance (). Genomic analysis on the collective genomes of all microorganisms from * To whom correspondence should be addressed. an environmental sample (known as meta genomics environmental genomics or community genomics) becomes essential. One major difficulty of meta genomics lies in the fact that most bacteria (up to 99%) found in environmental samples are unknown and can not be cultivated and isolated under laboratory conditions (). With high throughput sequencing technology, one possible solution is to directly sequence DNA fragments of multiple species obtained from the mixed environmental DNA sample (). Some well known meta genomics projects, including the Acid Mine Drainage Biofilm (AMD) project that analyzes dozens of species () and the Human Gut microbio me (HGM) project that involves thousands of species (), study fragments obtained from this sequencing approach. DNA fragments of a meta genomics project are usually from multiple genomes and most of the genome sequences are unknown. An important step in meta genomic analysis is to group DNA fragments from similar species together (referred to as binning) () to obtain the microbe distribution of the sample and identify species (including unknown species) within the sample. Depending on different research needs, the binning process could be performed on different taxonomic levels from Kingdom (the highest level) to Species (the lowest level). Traditional binning methods can be roughly classified as similarity based and composition based. similarity based methods () align each DNA fragment to known reference genomes. Based on the alignment results [e.g. BLAST hits or selected phylogenetic specific marker genes (, each fragment is assigned to the taxonomic class of the similar reference genomes. similarity based methods are usually limited by the availability of known microorganism genomes given that 1% of microorganisms have been cultured and sequenced. On the other hand, composition based methods group DNA fragments in a supervised or semi supervised manner using generic features such as genome structure or composition. Structural features, such as composition features of reference genomes or taxonomic marker regions [e.g. 16S rRNA (), recA and rpoB are commonly accepted fingerprint genes], are extracted and used to construct classifiers () for determining DNA fragments from different species or constraints for semi supervised clustering. These composition based methods usually suffer from the low availability and reliability of taxonomic markers. For example, studies on the enhanced biological phosphorus removing ebp r sludge (), Sargasso Sea () and the Minnesota soil samples() indicate that only 0.17, 0.06 and 0.017% of the DNA fragments, respectively, are known to carry 16S rRNA markers, and the figures are still 1% even if more markers such as recA and rpoB are included. Moreover, the reliability of taxonomic markers has also been challenged () as some species may share multiple markers with other species or multiple kinds of 16S rRNA molecules exist in a single bacterium due to the high mutation and gene exchange ratio of microbes, which might lead to incorrect classifications. A more promising direction is to use unsupervised binning algorithms based on the occurrence frequencies of l mers (short DNA substrings of length l) of the DNA fragments (). In these approaches, each fragment can be regarded as a vector containing the occurrence frequencies of all possible l mers in the fragment. The rationale behind these approaches is based on the observation that the l mer distributions of the fragments in the same genome are more similar than those l mer distributions of two unrelated species (). Based on this feature, many algorithms [e.g. TETRA (), meta cluster (), meta cluster 2.0 () and likely bin (have applied different unsupervised clustering methods on fragments based on the l mer distributions with great success when the abundance ratios of the species in the sample are almost the same. These algorithms tend to cluster fragments into clusters with similar size, and the binning performance of these algorithms will significantly be degraded when the abundance ratios of species are very different, e.g. 1:8 or 1:10. To tackle this problem, another unsupervised clustering method called abundance bin () has been introduced recently, which models the distribution of fragments from each species by different Poisson distributions. Fragments from species with high abundance ratios are usually sampled more while fragments from species with low abundance ratios are usually sampled less. Thus, fragments from species with different abundance ratios can be separated by their sampling rates. However, when the species have similar abundance ratios, say 1:1 or 1:2, the sampling rates of fragments from different species are similar and abundance bin fails to separate the fragments from these species. abundance bin also considers the case when the number of species k is unknown and determines k automatically. The estimation method seems not very effective and can not predict the correct value when k  3 in our experiments. None of the above algorithms can handle datasets from balanced species abundance ratios to very different species abundance ratios. In real situations, the abundance ratios are usually unknown and it is desirable to have an algorithm handles datasets with arbitrary abundance ratios. abundance bin takes advantage of the differences in abundance ratio of the species to separate the fragments and it is not obvious how to extend abundance bin to handle datasets with very balanced abundance ratio. On the other hand, approaches that handle datasets with balanced abundance ratio usually try to cluster fragments into k equal sized clusters by assuming the number of species in the dataset is k. Thus, species with low abundance ratio are forced to group wrongly with other species. In this article, we present meta cluster 3.0, an integrated binning algorithm with two phases: top down clustering (Phase 1) and bottom up merging (Phase 2). In Phase 1, we separate fragments into small groups (clusters) with similar sizes and try to guarantee that the majority of the fragments belong to the same species. After Phase 1, it is possible that fragments from the same species are grouped into different clusters, so in Phase 2, we try to combine these clusters together outlines the two phases of meta cluster 3.0. This two phase strategy relies on the following key observations. First, the difference (we capture this difference using the Spearman distance measure) between two l mer distributions of fragments from the same species follows a normal distributions. The same is true for the two l mer distributions of fragments from species of different families. This observation is supported by an empirical study (Section 2.2). Second, the differences in the two normal distributions allow us to derive a probabilistic model to determine how many clusters (k ) we should use in order to guarantee that most of the fragments in the same cluster belong to the same species in Phase 1 and when to merge the clusters to make sure that there will not be too many fragments from other species being merged together. Based on our probabilistic model, if the abundance ratios of the species are more or less the same, the value of k will be similar to the number of species. If the species have very different abundance ratios, k tends to be large and the clusters will be small so that fragments from minority species could be assigned to separate clusters without mixing with fragments from other species. Although fragments of majority species may then be put in different clusters, Phase 2 will try to merge them back. Thus, the issue of varying species abundance ratio is handled. To summarize, meta cluster 3.0 can (i) determine automatically the number of different species in the sample, which is required as page 1491 14891495
