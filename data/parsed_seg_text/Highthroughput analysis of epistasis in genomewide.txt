Motivation: gene gene interactions (epistasis) are thought to be important in shaping complex traits, but they have been under explored in genome wide association studies g was due to the computational challenge of enumerating billions of single nucleotide polymorphism (SNP) combinations. Fast screening tools are needed to make epistasis analysis routinely available in g was. Results: We present bi force to support high throughput analysis of epistasis in g was for either quantitative or binary disease (caseâ€“ control) traits. bi force achieves great computational efficiency by using memory efficient data structures, Boolean bitwise operations and multithreaded parallelization. It performs a full pair-wise genome scan to detect interactions involving SNPs with or without significant marginal effects using appropriate bonferroni corrected significance thresholds. We show that bi force is more powerful and significantly faster than published tools for both binary and quantitative traits in a series of performance tests on simulated and real datasets. We demonstrate bi force in analysing eight metabolic traits in a g was cohort (323 697 SNPs, 4500 individuals) and two disease traits in another (340 000 SNPs, 1750 cases and 1500 controls) on a 32-node computing cluster. bi force completed analyses of the eight metabolic traits within 1 day, identified nine epistatic pairs of SNPs in five metabolic traits and 18 SNP pairs in two disease traits. bi force can make the analysis of epistasis a routine exercise in g was and thus improve our understanding of the role of epistasis in the genetic regulation of complex traits. Availability and implementation: The software is free and can be downloaded from

introduction genome wide association studies g was have been successful in identifying a large number of trait associated genetic loci (), but are less successful in identifying much of the genetic variation (). gene gene interactions (epistasis)  Both authors contributed equally to this work. * To whom correspondence should be addressed are thought to be a potential source of unexplained genetic variation (), but they remain largely unexplored in g was conducted so far. A major hurdle for studying epistasis in g was is the lack of widely accepted algorithms that are fast enough to effectively handle high density single nucleotide polymorphism (SNPs) and can map different forms of epistasis while keeping false positive rates f prs under control (). high throughput tools are needed to make epistasis analyses routinely available in g was and ultimately improve our understanding of the role of epistasis in the genetic regulation of complex traits. Significant efforts have been made to develop new tools and algorithms for epistasis detection in g was () using either deterministic or stochastic methods, such as regression (), machine learning () and bayesian based approaches (). Most of these algorithms concern only g was for case control (binary) disorders and still require substantial computing time to analyse epistasis in one trait in real g was data (). Partial search strategies, based on biological knowledge () or filtering unimportant SNPs prior to analysis (), are adopted in some studies in order to reduce excessive computing burden but risk missing some types of variation. Fast but comprehensive methods to analyse epistasis in g was conducted for many complex (i.e. continuous and quantitative) traits are lacking. Previously, we showed that high throughput analysis of epistasis in quantitative traits in g was was feasible using computers with general purpose graphics processing units (). We also suggested a search algorithm using the information of pre identified loci in a full pair-wise genome scan to increase the power of detection of epistasis (), which was applied successfully in recent studies for binary () and complex traits (). These ideas are combined in a unique tool, bi force to support high throughput epistasis analysis for either binary or quantitative traits on commonly used computer systems. Herein, we describe the algorithm and essential features of bi force and compare the performance of bi force with that of BOOST () in binary traits and PLINK () in quantitative traits through simulation, both of which perform exhaustive pair-wise search based on regression based statistics over commonly used computer systems as bi force. We also demonstrate bi force analysis of epistasis in real g was data, i.e. eight metabolic traits in the Northern Finland Birth Cohort 1966 (NFBC1966) () provided by db gap (http://www.ncbi.nlm.nih.gov/gap) and two disease traits provided by the Wellcome Trust Case Control Consortium wtc cc (https://www.wtccc.org.uk/ccc1/). It is hoped that with bi force the analysis of epistasis in g was will become a routine exercise thus facilitating accumulation of information on epistasis hence improving our understanding its role in the genetic regulation of complex traits.

discussion we have shown that bi force is a unique tool that can support high throughput analysis of epistasis in g was for either binary or quantitative traits. bi force achieves great computational efficiency by integrating three major advances in computing (i.e. bitwise data structures, Boolean bitwise operations and multithreaded parallelization) with fast calculation of pair-wise interactions. The implementation of the combined search algorithm (i.e. using a less stringent threshold to detect marginal SNP interactions) increases the power of the strategy of using a less stringent threshold for marginal SNP interactions is statistically justifiable and has been validated in simulations elsewhere () and successfully applied in real data analyses (). Our simulation results support the strategy and justify that bi force is working as expected. bi force differs from BOOST mainly in the strategy of detection of marginal SNP interactions, thus in binary traits the power of detection by bi force should be higher than or equal to that from BOOST as shown in our simulation results (). bi force differs from PLINK in the strategy of detection of marginal SNP interactions as well as the use of genotype models, and hence it is not straightforward to assess the individual impact of the strategy on the bi force power gains in quantitative traits, especially when the power of detection was generally low (). However, with reference to the simulation results in the BOOST study () comparing BOOST (genotype models) against PLINK (allelic models), it is clear that the power advantage in bi force over PLINK in scenarios using Model 1 with MAF of 0.2 and 0.4 () can be mostly attributed to the strategy of detection of marginal SNP interactions because the model simulated favours the allelic models in these scenarios. Whereas in the scenario using Model 4 with MAF of 0.4, the bi force power advantage () can be attributed to the use of genotype models because as MAF increases towards 0.5 the model simulated generates less marginal effects and thus marginal SNP interactions are more difficult to be detected. Nevertheless, the power gains in bi force are not surprising because all the four interaction models favour marginal effects to some extent. It is worth noting that allelic models implemented in PLINK may have some advantage over bi force in situations where empty cells (i.e. no samples available in certain genotypes) in the nine cell contingency table (Supplementary Note 1) are prevalent.
