Constraint network analysis (CNA) is a graph theory based rigidity analysis approach for linking a biomolecules structure, flexibility, (thermo)stability and function. Results from CNA are highly information rich and require intuitive, synchronized and interactive visualization for a comprehensive analysis. We developed visual cna an easy to use PyMOL plug-in that allows setup of CNA runs and analysis of CNA results linking plots with molecular graphics representations. From a practical viewpoint, the most striking feature of visual cna is that it facilitates interactive protein engineering aimed at improving thermostability. Availability and Implementation: visual cna and its dependencies (CNA and FIRST software) are available free of charge under GPL and academic licenses, respectively. visual cna and CNA are available at

introduction structural flexibility (and rigidity) is important for a protein's function and stability. Being able to accurately predict protein flexibility is thus instrumental in protein science and engineering as well as drug design. Our group developed the python based software package Constraint Network Analysis (CNA) (,b) for characterizing biomolecular flexibility both at the global and residue level. CNA functions as a front and back-end to the graph theory based rigidity analysis software Floppy Inclusions and Rigid Substructure Topography (FIRST) () and has been used to predict protein thermostability, identify structural weak spots (), and link protein flexibility and function, including allosteric regulation (C. Pfleger and H. Gohlke, unpublished results). CNA models a protein as a body and bar constraint network in which bodies (atoms) are connected by bars (covalent and non-covalent interactions). A rigidity analysis is then performed using the pebble game algorithm (), resulting in a decomposition of the network into rigid and flexible regions. By removing non-covalent constraints from the network in the order of increasing strength, CNA simulates thermal unfolding. From the unfolding trajectory, CNA calculates several global and local flexibility indices (). From the global indices, phase transition points are identified at which the network switches from rigid to flexible. These points are used to predict the thermostability of a protein and identify structural weak spots. Local indices describe intrinsic biomolecular flexibility at the level of bonds and can be compared with quantitative data from experiments on biomolecular mobility. The output from CNA is highly information rich. For a comprehensive analysis, the data needs to be visualized as plots (showing global and local flexibility indices) as well as 3D graphics representations of the biomolecule, the constraint network, and the decomposition into rigid and flexible regions. Furthermore, the speed of CNA allows performing real time rigidity analyses on biomolecules thus interactive structural modifications and or editing of the constraint network followed by a re-analysis of the biomolecule's flexibility can be performed iteratively. With this in mind, we developed visual cna an intuitive, easy to use graphical interface for CNA built as a plug-in for the molecular viewer PyMOL (The PyMOL Molecular Graphics System, Version 1.5.0.3 Schr dinger, LLC). visual cna supports scientists interested in the rigidity analysis of biomolecules by a synchronized and interactive visualization of the CNA output. It also enables interactive protein engineering for improving thermostability by iteratively mutating identified weak spots, performing a subsequent rigidity analysis, and automatically comparing CNA output from wild type and mutant structures.

description the visual cna GUI consists of four panels: Setup, Analyze, Modify and Mutate. The Setup panel allows preparing variations of thermal unfolding simulations, i.e. based on a single network derived from a single input structure (), an ensemble of networks derived from a single structure using definitions of fuzzy non-covalent constraints () or a structural ensemble (). In the Analyze panel (), CNA output from multiple thermal unfolding simulations can be shown simultaneously, which helps comparing wild type and mutants. CNA results are shown as interactive plots of global and local flexibility indices and weak spots. In parallel, an interactive 3D protein structure () is visualized in PyMOL in terms of states corresponding to the steps of the thermal unfolding trajectory. The trajectory can be played as an interactive movie and is linked with the flexibility indices by annotations in the plots. Clicking either the plots or the structure changes the appearance of both to focus on the selected residue and or the corresponding unfolding state. Constraints are grouped by their associated rigid cluster or flexible region to aid visualization and selection. Constraints about to break in a given state are grouped, too, facilitating the identification of residues that could be mutated to stabilize these. The Modify panel contains several ways to modify the constraint network of the protein, which is useful when modeling the effect of ligands, ions or non-standard residues. An interactive table of constraints uses check boxes to enable or disable constraints, and a search box allows navigation. User defined constraints can be added by specifying atom pairs in text fields or the 3D structure. The Mutate panel is central to the interactive protein engineering capability of visual cna. After loading an alignment of multiple sequences, the residue conservation and substitution frequencies are calculated for each residue. Clicking a bar in the conservation plot and a mutation in the substitution frequency plot then mutates the corresponding residue and updates the constraint network. The mutation is done using the PyMOL mutation tool, which allows the user to select an appropriate rotamer for the mutant. The new structure can be automatically submitted for unfolding simulation and compared with the wild type. In this way, the effect of point mutations can be iteratively analyzed to optimize the protein structure toward increased thermostability (). In summary, the CNA approach derives maximal advantage from information on biomolecular flexibility by linking results from rigidity analyses to relevant structural characteristics. With visual cna an intuitive, easy to use graphical interface is available that makes CNA studies amenable to non bioinformatic ians interested in rigidity analysis of biomolecules and interactive protein engineering.
