Motivation: Capillary electrophoresis (CE) is a powerful approach for structural analysis of nucleic acids, with recent high throughput variants enabling three dimensional RNA modeling and the discovery of new rules for RNA structure design. Among the steps composing CE analysis, the process of finding each band in an electrophoretic trace and mapping it to a position in the nucleic acid sequence has required significant manual inspection and remains the most time consuming and error prone step. The few available tools seeking to automate this band annotation have achieved limited accuracy and have not taken advantage of information across dozens of profiles routinely acquired in high throughput measurements. Results: We present a dynamic programming based approach to automate band annotation for high throughput capillary electrophoresis. The approach is uniquely able to define and optimize a robust target function that takes into account multiple CE profiles (sequencing ladders, different chemical probes, different mutants) collected for the RNA. Over a large benchmark of multi profile datasets for biological RNAs and designed RNAs from the EteRNA project, the method outper-forms prior tools qu shape and FAST) significantly in terms of accuracy compared with gold standard manual annotations. The amount of computation required is reasonable at a few seconds per dataset. We also introduce an e score metric to automatically assess the reliability of the band annotation and show it to be practically useful in flagging uncertainties in band annotation for further inspection. Availability and implementation: The implementation of the proposed algorithm is included in the hit race software, freely available as an online server and for download at http://

introduction rna molecules play diverse roles in encoding and regulating genetic information, and much of this versatility can be traced to the formation of intricate RNA structures. To this end, chemical probing methodologies provide a general and rapid means to mapping RNA secondary and tertiary structure at single nucleotide resolution (). There exist many chemical probing techniques, most of which have common experimental procedures, as follows. Given an RNA of interest folded in solution, a chemical reagent modifies the RNA, either cleaving it or forming a covalent adduct with it at a rate correlated with the accessibility of particular moieties at each nucleotide or the frequency at which each nucleotide fluctuates into a conformation activated for chemical reaction. Examples of such chemical reagents, all with distinct mechanisms, include hydroxyl radicals, 2 0-OH acyl ating chemicals (SHAPE), dimethyl sulfate (DMS) and 1cyclohexyl32 morpholino ethyl car bodi imide met hop toluene sulfonate cm ct (). Subsequent reverse transcription detects the modification sites as stops to primer extension at nucleotide resolution. The resulting complementary DNA fragments are resolved in sequencing gels followed by individually quantifying band intensities. Prior to the mid-2000 s, the bottlenecks were the final steps (gel running and band quantification). To resolve fragments in a more high throughput fashion, capillary electrophoresis (CE) was developed and is reaching wide use (). ce based chemical probing can produce hundreds of electrophoretic profiles exhibiting tens of thousands of individual electrophoretic bands from a single experiment, leading to recent developments in two dimensional mapping of complex RNA structures () and their excited states () and extension to large complexes such as entire viruses () and to RNA design problems (). Further developments in next generation sequencing readouts are promising but still show biases compared with CE measurements (). Analyzing a large number of electrophoretic traces from a high throughput structure mapping experiment is time consuming and poses a significant informatic challenge, requiring a set of robust signal processing algorithms for accurate quantification of the bands embedded in these traces. Software methods for CE analysis include capillary automated footprinting analysis (CAFA;), shape finder (), high throughput robust analysis for CE (), fast analysis of SHAPE traces (FAST;) and qu shape (). A typical high throughput CE analysis pipeline consists of the following steps (): preprocessing such as normalization and baseline adjustment, alignment, peak detection, band annotation and peak fitting. Among these, band annotation refers to the process of mapping each band in an electrophoretic trace to a position in the nucleic acid sequence. For verification, visual inspection in this phase is inevitable to some extent. However, in practice, this band annotation step often takes significant manual efforts in CAFA and shape finder for they were designed to focus more on alignment and peak fitting. hit race qu shape and FAST have provided improved levels of band annotation support, but band annotation remains still the most time consuming and error prone step for large datasets. This article describes a dynamic programming based approach to automated band annotation for large CE datasets. These datasets involve at least four and up to hundreds of multiple traces that are aligned for each RNA, based on sequencing ladders for the four different nucleotide types, different chemical modifiers, and or chemical modification under different solution conditions or with different mutations. The central innovations herein are (i) an accurate and well tested procedure to integrate information across these multiple traces into a single consensus band annotation with accuracy approaching that of manual annotation and (ii) a reliability estimator for this procedure shows the overview of the proposed methodology.

discussion the proposed method for band annotation is unique in its ability to take into account all available CE profiles; prior methods (such as those available in qu shape and FAST) have focused on a single profile at a time with a reference profile if needed. The distinctive robustness of the proposed method is primarily attributed to this capability to integrate information across profiles. The method does require an accurate alignment of all profiles prior to band annotation. Our prior work () described a different dynamic programming algorithm to accomplish this preceding alignment based on standards co loaded with each sample. In well over 100 datasets analyzed here, we saw only one case where inter profile alignment was problematic (Tetrahymena ribozyme) and required manual intervention. Therefore, our alignment and annotation results herein confirm that all steps, including alignment and annotation, of RNA structure mapping CE analysis can now be routinely achieved through automated algorithms. To flag cases with uncertain automated band annotation, we have introduced the e score for reliability estimation. According to our results, given any dataset for CE analysis, the band annotations with E  0:97 are almost always reliable and can be safely adopted for final steps of band quantitation, whereas the results with E 0:97 are less likely to reliable. Informally, we have encountered datasets in which even expert annotation is ambiguous and has required special additional experiments (such as co loading sequencing ladders in the same color as the sample) to resolve (). This suggests that automated band annotation can not improve much further; a valuable development would be reliability estimates for specific subsets of bands rather than a global number. An additional useful development would be use of known band intensities based on prior experiments () or on base pair probability estimates, rather than coarse predictions for profiles based on sequence, modifier and a single secondary structure. The proposed algorithm has order of NK time and space complexity, and the practical time demand of band annotation was reasonable in our experiments. The proposed method was implemented in the MATLAB programming environment (The MathWorks, http://www.mathworks.com), and under the experimental setup used (sequential execution on a Intel core i5 4570 processor with 8-GB main memory), the total time demand of annotating bands in all the 95 datasets did not exceed 4 min (for each dataset, mean 2.2837 s; median 2.2707 s).

conclusion in the analysis of CE profiles, band annotation has remained the most time consuming and error prone step, due to the lack of robust computational tools for automating the process. Using a dynamic programming approach, the proposed algorithm can find an optimal arrangement of bands in a given CE profile, under a scoring scheme suitable for high throughput CE experiments with multiple profiles. On over 100 CE datasets including designed and biological RNAs, the proposed method identified the band positions matching the reference positions with accuracy sufficiently high as to obviate or significantly reduce manual correction. Finally, the quality of the band positions are well predicted by e score flagging unreliable annotations to the user.
