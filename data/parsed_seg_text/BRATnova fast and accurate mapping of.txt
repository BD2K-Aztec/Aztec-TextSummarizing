In response to increasing amounts of sequencing data, faster and faster aligners need to become available. Here, we introduce brat nova a completely rewritten and improved implementation of the mapping tool brat bw for bisulfite treated reads bs seq. brat nova is very fast and accurate. On the human genome, brat nova is 2–7 times faster than state of the art aligners, while maintaining the same percentage of uniquely mapped reads and space usage. On synthetic reads, brat nova is 2–8 times faster than state of the art aligners while maintaining similar mapping accuracy, methylation call accuracy, methylation level accuracy and space efficiency. Availability and implementation: The software is available in the public domain at

introduction whole genome bisulfite sequencing bs seq allows genome wide studies of DNA methylation at single base pair resolution. Sodium bisulfite treatment of DNA () followed by PCR and sequencing enables the detection of the methylation status of individual cytosine s. The first step in bs seq analysis is to map bisulfite treated reads to the reference genome. Since sodium bisulfite converts unmethylated cytosine s to thymine s the criteria for mapping bs seq reads requires one to allow a T in a read to match a C in the reference genome. Various indexes have been used to accelerate the mapping of bs seq reads to a reference genome. In practice, tools that employ the fm index () achieve the best balance between space requirements, mapping accuracy and speed. Among these, Bismark () and BS-Seeker/BSSeeker2 () are arguably the most commonly used tools for bs seq data. Here, we introduce brat nova a completely rewritten and improved implementation of brat bw () for aligning bs seq reads. brat nova employs a novel space efficient representation of the genome and supports local alignment by allowing one in del per read. brat nova is 211 times faster on the human genome than Bismark, BS-Seeker2 and bs map () while demonstrating comparable results in terms of the proportion of mapped unique reads, mapping accuracy, methylation level and methylation call accuracy and RAM usage. negative strands with Cs converted to Ts, and each read with Cs converted to Ts is aligned only once to a single index, which speeds up the mapping step. For large genomes such as the human genome, the concatenation of positive and negative strands is longer than 2 32 bases, which is the current genome size limit for brat bw. To handle this, brat nova uses an additional bit per base to track the strand identity. After mapping bisulfite treated reads, brat nova determines the methylation level of each cytosine. The methylation level of a cytosine is defined as the fraction of mapped reads that have a C (i.e. methylated, thus not converted to a T) in that genomic location, to the total number of reads mapped to that location (i.e. with a C or a T). brat nova supports a single variable length in del in the middle of a read by using two exactly matched seeds surrounding the in del followed by the linear time dynamic programming algorithm described in the Supplemental Notes.
