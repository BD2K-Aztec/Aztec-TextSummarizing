Motivation: Current methods in diagnostic microbiology typically focus on the detection of a single genomic locus or protein in a candidate agent. The presence of the entire microbe is then inferred from this isolated result. Problematically, the presence of recombination in microbial genomes would go undetected unless other genomic loci or protein components were specifically assayed. Microarrays lend themselves well to the detection of multiple loci from a given microbe; furthermore, the inherent nature of microarrays facilitates highly parallel interrogation of multiple microbes. However, none of the existing methods for analyzing diagnostic microarray data has the capacity to specifically identify recombinant microbes. In previous work, we developed a novel algorithm, vip r for analyzing diagnostic microarray data. Results: We have expanded upon our previous implementation of vip r by incorporating a hidden Markov model (HMM) to detect recombinant genomes. We trained our HMM on a set of non recombinant parental viruses and applied our method to 11 recom-binant alpha viruses and 4 recombinant flaviviruses hybridized to a diagnostic microarray in order to evaluate performance of the HMM. vip r HMM correctly identified 95% of the 62 inter-species recombin-ation breakpoints in the validation set and only two false positive breakpoints were predicted. This study represents the first description and validation of an algorithm capable of detecting recombinant viruses based on diagnostic microarray hybridization patterns. Availability: vip r HMM is freely available for academic use and can be downloaded from http://ibridgenetwork.org/wustl/vipr.

introduction recombination constitutes an important source of genetic variation among viruses. As an evolutionary mechanism, recombination leads to new viral genotypes with potentially novel biological properties and or clinical manifestations. vaccine derived poliovirus is one example of a virus for which recombination may play an important role in the progression of disease. Recombination between vaccine derived poliovirus and coxsackie virus has been shown to increase neuro virulence of recombinant progeny and may be responsible for the emergence of pathogenic vaccine derived poliovirus (). In addition, H1N1 influenza and n gari viruses provide examples in which novel genotypes consisting of genomic segments derived from multiple different parental viruses have led to disease outbreaks. H1N1, the influenza virus responsible for the 2009 outbreak of pandemic flu, is thought to have arisen from the successive reassortment of four different strains of influenza A (). n gari virus, a hemorrhagic fever causing bunya virus is thought to have resulted from the natural reassortment of two viruses, bunya mw era and bata i viruses, neither of which is known to cause hemorrhagic fever (). Given that recombination and reassortment can play important roles in producing novel variations that are implicated in pathological outcomes, the ability for clinicians to identify novel recombinant and re as sort ant viruses in diagnostic laboratories is highly desirable. In addition to occurring naturally through evolution, recombinant and re as sort ant viruses can also be deliberately created in the laboratory. In vitro recombination has proven to be a useful tool for engineering novel viruses with properties desirable for the development of vaccines (). However, this also means that recombination and reassortment have the potential to be used maliciously to develop novel agents of bioterrorism. Such agents could be engineered as highly pathogenic new viral genotypes consisting of the components of previously described viruses including nonpathogenic viruses. Anticipating the possible use of recombinant re as sort ant based bioweapons should guide our efforts in preparing to respond to such attacks. In such cases, the ability to detect novel agents quickly and accurately would be critical. Thus, it is imperative that any assay used to detect agents of bioterrorism include novel recombinants and re as sort ants as possible outcomes. Microarrays are well suited to detecting recombination and reassortment and have an important advantage over traditional diagnostic methods because they allow for the interrogation of multiple loci from multiple viruses in parallel. Traditional methods for microbial detection, such as polymerase chain reaction *To whom correspondence should be addressed pcr and antibody based methods, are generally limited to detecting only one genome segment or one protein per assay. The inference is then made that the entire genome is present given that a small part of the genome (or proteome) was detected. Unless other loci are specifically assayed, this diagnostic paradigm does not account for the possibility that a recombinant or re as sort ant virus is present. There have been many reports of the efficacy of microarrays as a tool for viral diagnosis and discovery (). Although many different probe design strategies and platforms have been proposed for diagnostic microarrays, all approaches require an objective method for interpreting the raw hybridization patterns. The method must be able to make diagnostic calls in the presence of technical noise, biological noise (i.e. cross hybridization to host) and probe saturation. Published examples of such methods with downloadable or web accessible software include e predict (), detect iv (), phylo detect (), CLiMax () and vip r (). Although these methods have been shown to perform with high accuracy, none of them was designed to be able to identify novel recombinant or re as sort ant viruses from a hybridization pattern. One feature of vip r which stands for Viral Identification with a PRobabilistic algorithm, is that it relies on an empirical training set of positive and negative control hybridizations to leverage diagnostic predictions. In this article, we describe the expansion of vip r to accommodate the possibility of recombination between candidate viruses included in the training set. We accomplished this by incorporating a hidden Markov model (HMM) into our method in order to define recombinant paths when calculating probabilities for candidate viruses ().shows the details of constructing the HMM. The Viterbi algorithm was used to determine the optimal path from which recombination breakpoints could be inferred. As with vip r our HMM allows us to take advantage of training data consisting of hybridizations of known viruses to a microarray to make predictions for unknown infections. The incorporation of an HMM into vip r now provides a probabilistic framework for assessing the presence of recombination between candidate parental viruses. To validate our approach, we applied our HMM to a set of 15 recombinant viruses consisting of members of the alpha virus and Flavivirus genera, each of which was hybridized in duplicate to a custom microarray. A set of microarrays to which non recombinant alpha viruses and flaviviruses were hybridized constituted the training data for the HMM. Although our test focused on the validation of a set of recombinant alpha viruses and flaviviruses, the strategy should be generalizable to detecting recombination among members of a given viral family.

discussion the ability of DNA microarrays to simultaneously assess the presence of multiple loci in microbial genomes is highly advantageous for detecting recombination between virus species in a diagnostic setting. Despite this, none of the existing methods for analyzing diagnostic microarrays is designed to accommodate the detection of recombinant viruses. In previous work, we developed vip r a method for objectively interpreting diagnostic microarrays. One of the advantages of vip r relative to other methods is that it relies on a training set of empirical hybridizations of virally infected and uninfected samples to leverage diagnostic predictions. We anticipated that relying on a training set of hybridizations from known viral infections would also help us predict recombination between virus species. In this study, we developed an HMM parameterized with vip r probability distributions to detect recombination in unknown infections. vip r HMM performed with high accuracy when identifying recombination breakpoints between viral species (59/62 such breakpoints were identified and the correct virus species 5 0 and 3 0 to the breakpoint were identified in each case). Of the eight intra-species breakpoints in our dataset, two were identified by vip r HMM. Given that a much higher percentage of inter-species breakpoints were detected than were intra-species breakpoints (95 versus 25%), these results demonstrate that vip r HMM is more effective at detecting recombination between species than between strains belonging to the same species. The ability of vip r HMM to distinguish between strains of the same species involved in recombination is likely influenced by the degree of sequence divergence between the two strains. vip r HMM correctly identified the intra-species breakpoint in both hybridizations of R12 (). The two strains comprising the intra-species breakpoint for R12 are 23% divergent on the nucleotide level. However, vip r HMM was not able to identify the intra-species breakpoint in either hybridization of R14 (), whose recombinant regions 5 0 and 3 0 to the intra-species breakpoint were similar in size to those of R12, but whose strains comprising the intra-species breakpoint are only 4% divergent on the nucleotide level. The ability of vip r HMM to distinguish between strains of the same species may also be influenced by the size of the recombinant segment. The four other intra-species breakpoints that vip r HMM failed to detect had greater dissimilarity between flanking strains (25%) but were proximal to other breakpoints (within 200 nt). Given the cost in probability. vip r HMM results for a subset of recombinants tested. (A) vip r HMM results for three recombinants that gave expected results. For each recombinant, the expected output based on sequence is shown, followed by the vip r HMM output for the two hybridizations performed. (B) vip r HMM results for three recombinants that gave unexpected results. R06 is a double recombinant for which an additional false positive recombination breakpoint was identified at the 3 0 end in one hybridization, and for which a 3 0 inter-species recombination breakpoint was not identified in the other hybridization. R14 is a double recombinant for which a 3 0 inter-species recombination breakpoint was identified in one of the hybridizations, but not the other. Additionally, an intra-species recombination breakpoint was not identified in either hybridization. R15 is a triple recombinant for which all three inter-species recombination breakpoints were identified in both hybridizations, but for which an intra-species recombination breakpoint was not identified in either associated with following a recombinant transition in the HMM, our results suggest that Viterbi may opt to bypass small recombinant regions. Although we have not specifically tested vip r HMM for higher order recombinants (more than three breakpoints), we anticipate that the identification of higher order recombinants will only be hindered inasmuch as additional recombination events within a fixed size genome yield smaller recombinant segments to be identified. Given that vip r HMM was shown to identify recombinant regions as small as $300 nt where there was sufficient divergence between recombining species, we expect vip r HMM would be able to detect similar regions in higher order recombinants. Since microarray probes are mapped to their position in an alignment of candidate genomes, vip r HMM can use the probes located at the boundary of a predicted recombination event to estimate nucleotide positions of recombination breakpoints. Although it was not expected that using a microarray tiling scheme wherein probes were non-overlapping and spaced 63 nt apart would give the precise nucleotide positions of recombination breakpoints, we compared the estimates given by vip r HMM with the nucleotide positions known from sequence. For the 61 correctly identified breakpoints (59 inter-species, 2 intra-species), the differences between microarray estimates and actual positions ranged from 0 to 90 nt. Therefore, the maximum distance observed falls within the span of about a two probe tiling (i.e. 90560mer  3 nt spacing  60mer). We expect that using higher density tiling strategies would result in higher resolution mapping of the breakpoints. Only two false positive recombination breakpoints were predicted by vip r HMM, both near the 3 0 ends of their respective genomes. One bypassed the final 254 nt of dengue virus 4 in favor of null states. The other bypassed the final 191 nt of Sindbis virus in favor of vee v states. From analysis of the training data, it was observed that the mean of the On distributions approach the mean of the Off distributions for probes near the 3 0 end of each genome, due to lower intensities for On probes in the training set for that region. This trend was observed in the training data universally for all genomes. The tendency for On probes to give lower intensities when approaching the 3 0 end may be attributable to the fact that random PCR amplification, which was used in the preparation of each sample for hybridization, is less efficient at the ends of a linear genome. This could also explain why vip r failed to detect three inter-species recombination breakpoints, all of which are localized near the 3 0 end of a genome. A similar pattern of lower intensities was also observed for On probes approaching the 5 0 end, although there appeared to be more probes in those regions that behaved as expected based on G compared with the 3 0 end. Despite the observed decrease in hybridization intensity proximal to the 3 0 and 5 0 termini, vip r HMM was still able to make accurate predictions in those regions in most cases. Although we did not specifically validate vip r HMM for re as sort ant viruses, we anticipate that viral re as sort ants would be readily detected. Reassortment can occur during co-infection when virus progeny inherit genome segments from two or more parental viruses with multi segmented genomes. The resulting chimeric genotypes associated with reassortment are similar to those generated through recombination except that the exchange of genetic material occurs at discrete, predictable points in the genome, i.e. at the boundary between genome segments. vip r HMM could also be applied to the analysis of bacterial genomes and for the detection of the loss of transposons, integr ons and plasmids, assuming those elements are represented in members of the training set. One challenge in building an HMM for detecting recombination is finding an appropriate value for pre comb a user inputted probability of recombination parameter used to calculate different transition probabilities in the model. Our choice of pre comb was based on minimizing false positive recombinations in non recombinant samples. If pre comb is increased by five logs, i.e. pre comb  10 20 , the number of correctly called breakpoints is increased to from 59/62 to 60/62. However, there are an additional three false positive breakpoints called near genome ends. Nonetheless, in some cases, it may be advantageous to increase pre comb in order to increase detection sensitivity. If pre comb is decreased by five logs, i.e. pre comb  10 30 , there is no change in the results. vip r HMM relies on a multiple alignment of candidate genomes to order microarray probes. One limitation of this approach is that only recombination between members of the same family will be considered as candidates since it is not generally feasible to globally align members of different families. In addition, because paths through the HMM follow a specific 5 0 3 0 ordering, only recombination at homologous sites is detect ible by vip r HMM as currently implemented. In future versions of vip r recombinants composed of viruses from different families could be detected by running multiple iterations of Viterbi, one for each HMM representing a different virus family. For a hypothetical recombinant between members of two different virus families, we anticipate that the HMM for each family would predict the presence of only a portion of the viral genome from its family (with the rest of the prediction being the null genome). With respect to selecting an appropriate pre comb for detecting inter family recombination, there are several different approaches that could be taken. One would be to use the same pre comb for inter family events as is used for intra family events. Another would be to lower pre comb for inter family events. The choice of strategy would likely depend on what was known a priori about the possibility of certain families recombining. The time complexity for the vip r HMM algorithm is n  m, where n is the number of probes and m is the number of genomes. The 22 alpha virus recombinant samples were analyzed in under 30 s on a single processor PC with 4 GB RAM. Thus, if the number of candidate genomes were increased to 1000 while the number of probes remained the same, it would take $150 s or 2.5 min to analyze one sample on a similar machine.
