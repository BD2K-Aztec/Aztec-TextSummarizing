com bp is a command line tool and a python library that manipulates BED files of possibly irregularly spaced p values and (1) calculates auto-correlation, (2) combines adjacent p values (3) performs false discovery adjustment, (4) finds regions of enrichment (i.e. series of adjacent low p values and (5) assigns significance to those regions. In addition, tools are provided for visualization and assessment. We provide validation and example uses on bisulfite seq with p values from Fishers exact test, tiled methylation probes using a linear model and da mid for chromatin binding using moderated t statistics. Because the library accepts input in a simple, standardized format and is unaffected by the origin of the p values it can be used for a wide variety of applications.

introduction a variety of high throughput technologies generate genome wide data used to study processes such as dna binding methylation status and histone modifications. These technologies, including tiling arrays and sequence based assays, generate data that are often auto-correlated across the genome, making inferences difficult. The significance of individual regions may be dampened after multiple testing correction on potentially millions of sites. In such studies, hypotheses tests can be performed at each location to generate p values for evaluating the effects of interest. For this purpose developed a method for combining p values in sliding windows and accounting for spatial correlations across the genome. Here, we build on this approach with software that allows for uneven data structure across the genome, more general auto-correlation calculations and multiple testing corrections for peaks (i.e. genomic regions of enrichment) with applications to a variety of different technologies.

application we extend three previously published analyses to demonstrate the utility and breadth of use of com bp and to validate against the published data. The full set of commands used to run each of these analyses is available in the corresponding subdirectory at: https://github.com/brentp/combined-pvalues/tree/ master examples. Comprehensive, high throughput array for relative methylation is a tiling array used to quantify methylation at cpg rich sites (). Adjacent probes are correlated due to the regional nature of methylation and to the overlapping probes on the tiling array. The CHARM study reported in contains probe data for tumor and normal samples from a variety of tissues. Using these data, we fit a linear model in R (http://www.R-project.org) to obtain p values for the significance of tumor or tissue specific effects on methylation status at each probe. We then run com bp which finds 85% of the tumor specific differentially methylated regions cd mrs reported by and 75% of the tissue specific td mrs reported. While these overlaps depend on the parameter choice, we show that the Irizarry DMRs that overlap with the com bp DMRs have significantly t test P  1.296e145) lower FDR values (as reported by Irizarry) than those that do not, indicating that com bp is reporting the best regions. We also show that our method yields only 39 false positive DMRs on 20 runs of shuffled of CHARM data (33 of those come from two of the sets, because those shuffles of the clinical data happen to coincide well with the case control status of the original data). This gives a FDR rate of 0.0008 for reasonable cutoffs. We found that com bp recovers more significant probes than a simple FDR correction on the original p values. We also found that the process of segmenting the genome into smaller chunks and calling regions independently in each chunk generates similar regions to those derived using the auto-correlation structure for the entire genome (the default). da mid technology followed by tiling arrays can be used to map genomic regions bound by dna binding proteins (van). We recreate an analysis of the da mid tiling array data for the Ci transcription factor in Drosophila melanogaster ().calculated the mean log ratios of intensities between Ci experimental and control samples to obtain p values from a one sided moderated t test. Of the original 878 regions, 695 (79%) are represented in the com bp predicted peaks. To score each peak, the authors report  log 10 of the smallest raw p value for each peak. The published peaks overlapping the com bp regions have a higher score than those that do not t test P  2.98e59), indicating that com bp is finding the best regions among those previously reported. In addition, com bp regions also yield a higher target enrichment score based on proximity to known Ci genes, indicating that com bp is selecting for known targets. The corrected p value reported by com bp can be used as a filter to extract regions of interest; we calculated the enrichment ratio of the number of observed to expected Ci target genes at various com bp corrected p value cutoffs. For a cut off of 0.1, the enrichment is 2.41, this enrichment increases to 3.46 and 5.29 for more stringent cutoffs of 1e3 and 1e4, respectively. bisulfite sequencing bs seq is also used to measure methylation across the genome. As another example of the flexibility of our method, we demonstrate a possible analysis on data described in from Arabidopsis thaliana using methyl coder () to map the bisulfite treated reads to the genome. At each site, we use Fisher's exact test to obtain p values for the counts of converted and un-converted cytosine s between endosperm and embryo. We find DMRs between these two tissues associated with genes enriched for gene ontologies related to the ribosome (P  1e3).

conclusion the com bp software is useful in contexts where auto-correlated p values are generated across the genome. We have outlined our implementation and demonstrated the utility on data from three different technologies each from a different statistical test. We have also validated our method using previously published results from those studies. Future work could extend this framework to address applications with a more segmented structure such as DNA copy number and chips eq. Currently, we recommend the use of com bp for technologies with a more regular autocorrelation structure. In addition, we note that this method will have a sensitivity and specificity that will depend on each dataset and we recommend that users explore these tradeoffs on shuffled versions of their own data as demonstrated in the CHARM example.
