Motivation: Protein sequence searching and alignment are fundamental tools of modern biology. Alignments are assessed using their similarity scores, essentially the sum of substitution matrix scores over all pairs of aligned amino acids. We previously proposed a generative probabilistic method that yields scores that take the sequence context around each aligned residue into account. This method showed drastically improved sensitivity and alignment quality compared with standard substitution matrix based alignment. Results: Here, we develop an alternative discriminative approach to predict sequence context specific substitution scores. We applied our approach to compute context specific sequence profiles for Basic Local Alignment Search Tool (BLAST) and compared the new tool csb last dis to BLAST and the previous context specific version csb last gen. On a dataset filtered to 20% maximum sequence identity, csb last dis is was 51% more sensitive than BLAST and 17% more sensitive than csb last gen in detecting remote homo-logues at 10% false discovery rate. At 30% maximum sequence identity , its alignments contain 21 and 12% more correct residue pairs than those of BLAST and csb last gen respectively. Clear improvements are also seen when the approach is combined with PSI-BLAST and hh blits. We believe the context specific approach should replace substitution matrices wherever sensitivity and alignment quality are critical.

introduction inferring the functions and the structures of proteins from those of homologous proteins has proven to be an extremely powerful approach in biology. To predict a homologous relationship between two proteins, their sequences are aligned such as to maximize the sum of scores over all aligned pairs of amino acid residues minus penalties for gaps. A sufficiently high score indicates a homologous relationship. The standard method for calculating scores for pairs of amino acids is the substitution matrix method (). The substitution score for amino acids a and b can be written as Sa, b  const  log paj bpa where pa jb is the probability of amino acid b mutating into a, and P(a) is the background probability of a. The probabilities P(a) and pa jb are derived by counting the numbers of amino acids a and of aligned pairs (a, b) in a large set of trusted sequence alignments. As protein sequences of folded domains are constrained by the necessity to maintain a stable structure, the substitution probabilities for a given residue are largely determined by the structural context within which it resides. Substitution matrices have, therefore, been trained for particular structural contexts, for example, depending on the residue's secondary structure, solvent accessibility or polarity (). Methods that infer substitution probabilities of amino acids solely from their local sequence context have the advantage that they do not require the structure of the query protein to be known (). In biege rt and so ding so ding (2009), we formulated a general approach to predict substitution probabilities from sequence context; for each residue in the query sequence, we compared the 13 residue window centred around it with a precomputed library of 13 column sequence profiles that represent all known sequence contexts. The substitution probabilities are computed as the weighted mixture of the central columns in these context profiles, with weights proportional to the similarity between the context profile and the 13 residue sequence context. The approach was based on a generative model for learning context specific substitution probabilities. The goal of this work is to further improve the prediction accuracy by developing a discriminative machine learning method for the prediction of substitution probabilities. As in our previous work, we apply the method to enhance Basic Local Alignment Search Tool (BLAST) by storing the predicted substitution probabilities for the query sequence in a sequence profile and jump starting PSI-BLAST with it. We also apply the new method to generate context specific pseudo counts for PSI-BLAST () and hh blits (), our highly sensitive iterative sequence search software based on the pairwise comparison of hidden Markov models (HMMs). In all cases, we observe significant improvements over the generative version. *To whom correspondence should be addressed.

DISCUSSION
