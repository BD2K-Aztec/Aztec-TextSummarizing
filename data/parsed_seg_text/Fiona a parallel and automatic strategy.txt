Motivation: Automatic error correction of high throughput sequencing data can have a dramatic impact on the amount of usable base pairs and their quality. It has been shown that the performance of tasks such as de novo genome assembly and SNP calling can be dramatically improved after read error correction. While a large number of methods specialized for correcting substitution errors as found in Illumina data exist, few methods for the correction of in del errors, common to technologies like 454 or Ion Torrent, have been proposed. Results: We present Fiona, a new stand-alone read error correction method. Fiona provides a new statistical approach for sequencing error detection and optimal error correction and estimates its parameters automatically. Fiona is able to correct substitution, insertion and deletion errors and can be applied to any sequencing technology. It uses an efficient implementation of the partial suffix array to detect read overlaps with different seed lengths in parallel. We tested Fiona on several real datasets from a variety of organisms with different read lengths and compared its performance with state of the art methods. Fiona shows a constantly higher correction accuracy over a broad range of datasets from 454 and Ion Torrent sequencers, without compromise in speed. Conclusion: Fiona is an accurate parameter free read error correction method that can be run on inexpensive hardware and can make use of multicore parallelization whenever available. Fiona was implemented using the seq an library for sequence analysis and is publicly available for download at http://www.seqan.de/projects/

introduction next generation DNA sequencing (NGS) technologies have revolutionized genomics and produce billions of base pairs per day in the form of reads of length !100 bp. In this article, we focus on NGS reads produced by genome sequencing. Owing to the large range of applications of genome sequencing, the correction of errors introduced by the sequencer, substitution as well as insertion or deletion (indels), has recently attracted attention. Previous studies showed that error correction can improve de novo genome assembly performance () and SNP detection (). Depending on the technology, the most prevalent error type differs. Illumina technology produces mostly substitution errors (), whereas 454 sequencers are prone to produce runs of larger insertions of the same nucleotide. Ion Torrent sequencers were shown to have a large amount of in del errors and a high sequencing error rate (). However, current error correction methods suffer a number of limitations as highlighted in a recent review ().(i) Most methods can not correct in del errors because they are tailored to correct only substitution errors and are therefore only applicable to Illumina reads. (ii) Most approaches need to be parameterized depending on the dataset, otherwise their performance is suboptimal. This either requires in depth knowledge by the user or parameter optimization using downstream analysis, which often leads to longer running times in practice iii Because the throughput of NGS technologies is growing steadily, many approaches are not applicable to larger datasets because of running time or memory limitations. These caveats make it hard for users to choose the optimal tool for their dataset and NGS technology. Here we introduce a new approach to read error correction, called Fiona, which addresses all the above mentioned limitations. Fiona provides an accurate and highly parallelized method for correction, with the ability to correct in del errors, while it automatically adjusts its parameters. All read error correction methods have to perform essential tasks: (i) computation of read overlaps, (ii) error detection in reads and (iii) error correction. In a recent review by, the methods have been classified into k spectrum based, suffix tree array based and multiple sequence alignment (MSA) based. We will briefly explain the differences and weaknesses of these approaches but refer the reader to (): k spectrum based. k spectrum based read error correction was introduced in the Euler assembler (). There exist many variations on the k spectrum based error corrections for NGS reads (), for example, approaches that were designed to select the necessary parameters using mixture models (). Popular methods are Quake (), Reptile () and the error correction module from the all paths lg assembler (), all of which use base quality values. To our knowledge, only all paths lg in this category can correct short in del errors. *To whom correspondence should be addressed. y The authors wish it to be known that, in their opinion, the first three authors and the last author should be regarded as Joint First Authors.  The Author 2014. Published by Oxford University Press. This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (http://creativecommons.org/licenses/by-nc/3.0/), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals permission soup com the general disadvantage for most of these methods is their inability to correct in del errors, a severe limitation for 454 or Ion Torrent sequencers. In addition, for most of these approaches, parameters need to be optimized by the user to obtain good performance, for example, Reptile. Suffix tree array based. sh rec () was the first approach that uses a variable seed length for read overlap and error detection computation. It considers for each erroneous read a set of correcting reads such that all reads share a k  1-mer left of the error and the set of correcting reads share a km er that ends with the correct base, which out votes the erroneous base. To efficiently find erroneous reads and correcting candidates, sh rec traverses a generalized suffix tree of all reads, in which erroneous and correcting reads occur as children of branching nodes with string depth k  1. Building on a suffix tree representation, the hybrids hrec algorithm extended the ideas to correct in del errors and sequences in color space (). In both methods, potentially correcting reads are compared with erroneous reads using hamming distance, seeded by the shared k  1-mers between reads. Further, both methods are sensitive to the input parameters and therefore show variable performance when compared in other studies (), and the full suffix tree data structure needs large memory resources. The HiTEC algorithm introduced automatic parameter selection using coverage statistics (). Seed lengths and coverage threshold are set automatically, given the genome length and the average error rate. HiTEC uses the suffix array instead of a suffix tree to save memory. However, HiTEC can only correct substitution errors and the automatic parameter selection works only for reads of same length as found for Illumina data. Note that these methods do not define explicitly which correction for an erroneous position is applied when the same error is encountered multiple times through different seed lengths in the tree, and in which order errors in a read are corrected. MSA based. Among the two existing multiple alignment based methods ECHO () and Coral (Salmela and Schr oder, 2011), only Coral can correct in del errors. Coral computes initial read overlaps with hash tables for a fixed km er length and then uses dynamic programming to form multiple read alignments. This alignment is costly for long reads but has a clear optimization function, as read errors are corrected by the best voting correction in the MSA.

discussion in this study, we introduced Fiona, a new algorithm for the correction of sequencing errors without the need for a reference sequence. Fiona builds over existing strategies to accurately correct errors, accounting for indels with automatic parameter selection. One of the main advantages of Fiona is the use of variable seed lengths, combined with a global optimization criterion to choose the best correction for a read. Our experiments show that Fiona outperforms other methods on datasets from different sequencing technologies time gain454
