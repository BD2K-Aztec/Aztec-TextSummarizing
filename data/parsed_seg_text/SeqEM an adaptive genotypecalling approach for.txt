Motivation: next generation sequencing presents several statistical challenges, with one of the most fundamental being determining an individuals genotype from multiple aligned short read sequences at a position. Some simple approaches for genotype calling apply fixed filters, such as calling a heterozygote if more than a specified percentage of the reads have variant nucleotide calls. Other genotype calling methods, such as MAQ and soap snp are implementations of Bayes classifiers in that they classify genotypes using posterior genotype probabilities. Results: Here, we propose a novel genotype calling algorithm that, in contrast to the other methods, estimates parameters underlying the posterior probabilities in an adaptive way rather than arbitrarily specifying them a priori. The algorithm, which we call seq em applies the well known expectation maximization algorithm to an appropriate likelihood for a sample of unrelated individuals with next generation sequence data, leveraging information from the sample to estimate genotype probabilities and the nucleotide read error rate. We demonstrate using analytic calculations and simulations that seq em results in genotype call error rates as small as or smaller than filtering approaches and MAQ. We also apply seq em to exo me sequence data in eight related individuals and compare the results to genotypes from an Illumina SNP array, showing that seq em behaves well in real data that deviates from idealized assumptions. Conclusion: seq em offers an improved, robust and flexible genotype calling approach that can be widely applied in the next generation sequencing studies. Availability and implementation: Software for seq em is freely available from our website: www hi hg org under Software Download.

introduction recent technological advances in massively parallel, high throughput DNA sequencing, commonly called next generation sequencing, are producing an unprecedented volume of sequence data. The next few years are likely to see public databases, such as the Short Read Archive at the National Center for Biotechnology * To whom correspondence should be addressed information filled with hundreds of thousands of tera bases of human sequence data. next generation sequencing promises to be a powerful tool for discovery of genetic variation contributing to risk of complex diseases by providing rapid and complete sequencing of a set of candidate genes, the entire exo me or even the whole genome (). Current next generation sequencing technologies are shotgun approaches that produce base sequences for multiple, individual DNA molecules which, depending upon the sequencing technology, range from 30 to 350 bp in average length. Once aligned to a reference genome, the number of reference nucleotides and the number of variant non reference nucleotides among multiple sequences overlapping a given DNA site can be counted. Apart from sequencing error, an individual homozygous at the site would yield either all reference or all variant nucleotides. However, because of random sampling of homologous base pairs in heterozygotes and sequencing or alignment errors, the raw counts do not directly identify the genotype at that site. This uncertainty requires a genotype calling algorithm to determine the latent genotype of an individual from multiple aligned sequence reads. Two primary methods are currently implemented for genotype calling: (i) a filtering method based on a fixed number of observed variant nucleotides and (ii) a probabilistic method based on posterior genotype probabilities. Commercial software (e.g. Roche gs mapper CLC and laser gene employs simple filters to distinguish heterozygotes from reference homozygotes by calling an individual heterozygous if more than a prespecified number or proportion of variant reads are seen at a position. The difficulty with an arbitrary threshold for determining genotypes is that it does not explicitly take into account the number of aligned sequences (read depth) or information about allele frequency or nucleotide read error. It also does not quantify the uncertainty of the call. A related approach determines filter thresholds for genotype calls empirically using results from known genotypes (). Probabilistic approaches, which assign genotype calls based on the maximum posterior genotype probability given the read data, have been implemented in programs such as MAQ and soap snp (). These use fixed prior values for heterozygote probabilities and nucleotide read error probabilities, which may not be representative for a given sample, in calculating posterior probabilities. These approaches make genotype calls for a single individual at a time, and thus do not utilize information from additional individuals in the sample. Anticipating that most resequencing studies will produce data for multiple individuals, we recognized that there page 2804 28032810
