Counting all the km ers (substrings of length k) in dna rna sequencing reads is the preliminary step of many bioinformatics applications. However, state of the art km er counting methods require that a large data structure resides in memory. Such structure typically grows with the number of distinct km ers to count. We present a new streaming algorithm for km er counting, called DSK (disk streaming of km ers which only requires a fixed user defined amount of memory and disk space. This approach realizes a memory, time and disk trade-off. The multi-set of all km ers present in the reads is partitioned, and partitions are saved to disk. Then, each partition is separately loaded in memory in a temporary hash table. The km er counts are returned by traversing each hash table. low abundance km ers are optionally filtered. DSK is the first approach that is able to count all the 27-mers of a human genome dataset using only 4.0 GB of memory and moderate disk space (160 GB), in 17.9 h. DSK can replace a popular km er counting software (Jellyfish) on small memory servers. Availability: http://minia.

introduction determining the abundance of each distinct km er in a set of sequencing reads is a conceptually simple yet fundamental task. It is used in many bioinformatics applications related to sequencing, e.g. genome and transcriptome assembly, variants detection and read error correction. For de novo assembly, one is often interested in counting km ers to discard those with low abundance, which likely stem from sequencing errors. State of the art methods for km er counting rely on hash tables (Jellyfish; marca is marca is and) and or Bloom filters bf counter. These structures need to reside in memory for random access. Sequencing errors induce erroneous km ers in a volume typically greater or comparable with that of correct km ers. Hence, counting km ers for a human dataset with either a single hash table or a Bloom filter is a task that requires tens of gigabytes of memory. In Section 2, we describe a fixed memory and fixed disk space streaming algorithm, DSK (disk streaming of km ers and its worst case complexity is analysed in function of the desired memory and disk usage. In Section 3, DSK is used to count all the 27-mers of a whole genome human dataset. The trade-off between memory and disk space is analysed on two smaller datasets. We conclude with a discussion of the advantages of DSK over related methods.
