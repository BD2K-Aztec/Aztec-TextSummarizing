Motivation: next generation sequencing techniques allow us to generate reads from a microbial environment in order to analyze the microbial community. However, assembling of a set of mixed reads from different species to form contigs is a bottleneck of meta genomic research. Although there are many assemblers for assembling reads from a single genome, there are no assemblers for assembling reads in meta genomic data without reference genome sequences. Moreover, the performances of these assemblers on meta genomic data are far from satisfactory, because of the existence of common regions in the genomes of subspecies and species, which make the assembly problem much more complicated. Results: We introduce the meta i dba algorithm for assembling reads in meta genomic data, which contain multiple genomes from different species. There are two core steps in meta i dba. It first tries to partition the de Bruijn graph into isolated components of different species based on an important observation. Then, for each component, it captures the slight variants of the genomes of subspecies from the same species by multiple alignments and represents the genome of one species, using a consensus sequence. Comparison of the performances of meta i dba and existing assemblers, such as Velvet and Abyss for different meta genomic datasets shows that meta i dba can reconstruct longer contigs with similar accuracy. Availability: meta i dba toolkit is available at our website

introduction meta genomic research studies the genetic information in an entire microbial community. It plays an important role in microbiology because over 99% of microbes can neither be isolated nor cultured (). Recent advances in next generation sequencing technology allow us to generate reads from genomes of multiple species in these samples in an effective manner. The set of reads obtained is very complicated which makes the assembling of genomes of species that exist in the sample extremely difficult. There are two main approaches to study reads from these samples. One is to group (called binning) the reads according to some biological markers or structural features (). Then, reads belonging to different species are studied. The other is to deduce the potential biological functions of the whole community by studying the reads directly using gene prediction or function annotation (). Since the reads from the next generation sequencing technologies are still relatively short, it * To whom correspondence should be addressed. is more effective if longer contigs can be constructed from the reads before conducting the study even though we are not able to assemble the genome of every species. High quality assembly results of the contigs are desirable in both approaches. If the assembled contigs are short and erroneous, the accuracy of binning, gene prediction, function annotation, etc. will be impaired. Thus, assemblers that can generate longer and more accurate contigs will definitely facilitate the study of meta genomic data. If similar reference genomes exist in the database, one can assemble reads by first aligning them to the reference genomes (). However, as over 90% of microbes in meta genomic data are unknown (), de novo assemblers are needed to assemble reads without any reference genomes. To our knowledge, currently there are no de novo meta genome specific assemblers available. Assemblers such as EULER (), Velvet (), Abyss (), soap de novo () are for single genome, but are used in meta genomic study (). All these assemblers are based on the de Bruijn graph (), which is a common approach to perform de novo assembly. In the de Bruijn graph, a vertex represents a length k substring called km er and an edge connecting vertices u and v represents u and v appearing consecutively in a read. All these assemblers generate the de Bruijn graph from reads, and then apply some error removal methods (), e.g. removing tips and merging bubbles, to modify the graph based on its topological structure. Simple paths in the graph are outputted as contigs and paired end information might be applied to further merge the contigs. These existing assemblers do not work well for meta genomic datasets, except for some very small datasets containing specific species (). Two main properties of a reasonably complicated meta genomic dataset make these assemblers fail to produce long contigs: (i) polymorphisms among similar subspecies and common genomic regions shared by different species; and (ii) uneven abundance ratios of species in a sample. The polymorphism of similar subspecies, especially subspecies of the same species, consists of very similar sequences with few variations (single nucleotide variation, short insertion or deletion or genomic rearrangements, etc.) and each variation introduces a branch in the de Bruijn graph (we call these branches sp branches. Another source of branches is due to the common or similar genomic regions, say housekeeping genes, shared by different species (we call these branches cr branches. These two types of branches, which do not exist when assembling single genomes, would make the de Bruijn graph for meta genomic data very complicated. Since existing assemblers output simple paths in the graph as contigs, these extra branches caused by common regions in different species prevent the construction of long contigs some assemblers resolve branches by merging similar sequences as bubbles into one sequence. A bubble is defined as several similar paths with the same start vertex and the same end vertex () in the de Bruijn graph. Bubble merging helps to merge similar regions and reduce complexity of the de Bruijn graph. An important assumption used by assemblers to remove bubbles for single genome assembly is that the bubble is caused by a few single nucleotide polymorphisms (SNP) or errors in reads; thus, the simple paths inside a bubble are very similar, except for a few nucleotides. However, the 'bubbles' found in the graph for meta genomic dataset do not follow this assumption. Different bubbles mix together to make the start vertex and the end vertex very difficult to be identified. Some of these bubbles are formed by a mixture of sp and cr branches shows an example of this phenomenon in which every simple path is contracted into a vertex for visualization. All branches at a vertex in this graph normally lead to some other vertex in the same component, but it is uncertain that these are bubbles for merging. If we look closer at these bubbles, even if the bubble is formed only by sp branches (because of variations in subspecies), the multiple paths inside the bubble may differ a lot may be with larger insertion deletion. Existing approaches for merging bubbles for single genome assembly do not work for this case; thus, they will fail to resolve these 'bubbles' and are unable to construct long contigs. Even if all bubbles can be identified, it is not easy to merge them together to form a consensus. To resolve branches in a de Bruijn graph, existing assemblers also try to use paired end information to help find paths with paired end reads support so as to eliminate those branches caused by erroneous reads and to construct longer contigs. In the case of multiple subspecies, each path will have a lot of support since they are not caused by erroneous reads, but variations in subspecies and the assemblers are not able to resolve these branches easily. Moreover, since the contigs are short, applying paired end information becomes difficult, because usually paired end information can only be applied to connect long contigs. To show the complexity of a de Bruijn graph for meta genomic dataset compares graphs and assembly results of simulated reads sampled from a single genome (Escherichia coli 536) and from five different E.coli subspecies genomes shows that the five E.coli subspecies contain about twice the number of km ers as that of a single E.coli subspecies, but 150 times more branches as that of single subspecies. This makes the graph complicated and genome assembly difficult. In fact, the performance of all the assemblers is poor when there are a lot of subspecies. The N50 values of Velvet , Abyss and soap de novo drop from 178 914, 32 440 and 125 404 bp for single genome data to 875, 849 and 713 bp, respectively, for meta genomic data with five subspecies. Uneven abundance ratios in meta genomic data introduce another problem in assembly, because existing assemblers can not distinguish error one ous reads sampled from genomes with high abundance ratios and reads from genomes simulated length 75 reads are sampled randomly from references with 1% error and 250 insert distance with a depth of 30. The value of k is set to 50 for all assemblers.
