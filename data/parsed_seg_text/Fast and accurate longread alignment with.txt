Motivation: Many programs for aligning short sequencing reads to a reference genome have been developed in the last 2 years. Most of them are very efficient for short reads but inefficient or not applicable for reads 200 bp because the algorithms are heavily and specifically tuned for short queries with low sequencing error rate. However, some sequencing platforms already produce longer reads and others are expected to become available soon. For longer reads, hashing based software such as BLAT and SSAHA2 remain the only choices. Nonetheless, these methods are substantially slower than short read aligners in terms of aligned bases per unit time. Results: We designed and implemented a new algorithm, burrows wheeler Aligners smith waterman Alignment b was w to align long sequences up to 1 Mb against a large sequence database (e.g. the human genome) with a few gigabytes of memory. The algorithm is as accurate as SSAHA2, more accurate than BLAT, and is several to tens of times faster than both. Availability: http://bio

introduction following the development of sensitive local alignment software, such as fast a () and BLAST () around 1990, a new generation of faster methods to find DNA sequence matches was developed since 2000, including mega blast (), SSAHA2 (), BLAT () and pattern hunter (), greatly speeding up matching capillary sequencing reads against a large reference genome. When new sequencing technologies arrived that generated millions of short (100 bp) reads, a variety of new algorithms were developed which were 101000 times faster, including SOAP (), MAQ (), Bowtie () and BWA (). However, Roche/454 sequencing technology has already produced reads 400 bp in production, Illumina gradually increases read length 100 bp, and Pacific Bioscience generates 1000 bp reads in early testing (). Reads coming from the new sequencing technologies are not short any more, which effectively rules out many of the new aligners exclusively designed for reads * To whom correspondence should be addressed. no longer than 100 bp. Efficiently aligning long reads against a long reference sequence like the human genome poses a new challenge to the development of alignment tools. long read alignment has different objectives from short read alignment. First, in short read alignment, we would usually like to align the full length read to reduce the reference bias caused by the mismatches toward the ends of the read. Given this requirement, we can design spaced seed templates () spanning the entire read (), or quickly filter out poor matches, for example, by applying q gram filtration () or by bounding the search process (), and thus accelerate the alignment. In long read alignment, however, we would prefer to find local matches because a long read is more fragile to structural variations and mis assemblies in the reference but is less affected by the mismatches close to the ends of a read. Secondly, many short read aligners are only efficient when doing un gapped alignment or allowing limited gaps, e.g. a maximum of one gap. They can not find more gaps or the performance quickly degrades when they are tuned for this task. long read aligners, however, must be permissive about alignment gaps because indels occur more frequently in long reads and may be the dominant source of sequencing errors for some technologies such as 454 and Pacific Bioscience. When considering algorithms to speed up long read alignment, hash table indexing as is used in most current software is not the only choice found a smith waterman like dynamic programming that can be applied between a query sequence and the suffix tree of the reference, effectively aligning the query against each subsequence sampled from the suffix tree via a top down traversal. As on a suffix tree identical sequences are collapsed on a single path, time is saved by avoiding repeated alignment of identical subsequences furthered this idea by implicitly representing the suffix tree with an fm index (), which is based on the burrows wheeler Transform (BWT;), to achieve a small memory footprint. Their new algorithm, bwt sw is able to deliver identical results to the standard smith waterman alignment, but thousands of times faster when aligning against the human genome sequence. While bwt sw is still slower than BLAST on long query sequences, it finds all matches without heuristics. One can imagine that introducing heuristics would further accelerate bwt sw. Our b was w algorithm follows this route. To some extent, b was w as well as bwt sw also follows the seed and extend paradigm. But different from BLAT and ssaha2 page 590 589595
