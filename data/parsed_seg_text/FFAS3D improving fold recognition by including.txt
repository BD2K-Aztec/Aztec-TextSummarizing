Motivation: Homology detection enables grouping proteins into families and prediction of their structure and function. The range of application of homology based predictions can be significantly extended by using sequence profiles and incorporation of local structural features. However, incorporation of the latter terms varies a lot between existing methods, and together with many examples of distant relations not recognized even by the best methods, suggests that further improvements are still possible. Results: Here we describe recent improvements to the fold and function assignment system ff as method, including adding optimized structural features (experimental or predicted), symmetrical Z-score calculation and re ranking the templates with a neural network. The alignment accuracy in the new FFAS-3D is now 11% higher than the original and comparable with the most accurate template based structure prediction algorithms. At the same time, FFAS-3D has high success rate at the Structural Classification of Proteins (SCOP) family, superfamily and fold levels. Importantly, FFAS-3D results are not highly correlated with other programs suggesting that it may significantly improve meta predictions. FFAS-3D does not require 3D structures of the templates, as using predicted features instead of structure derived does not lead to the decrease of accuracy. Because of that, FFAS-3D can be used for databases other than Protein Data Bank (PDB) such as Protein families database or Clusters of orthologous groups thus extending its applications to functional annotations of genomes and protein families. Availability and implementation: FFAS-3D is available at http://ffas.

introduction one of the most intriguing problems in molecular biology is the extent of homology between genes and proteins. With sequences evolving quickly, many homologs become unrecognizable by simple sequence sequence comparisons. More sophisticated methods, including sequence profile and profile-profile methods allow us to recognize statistically significant similarities even between distant homologs. The fold and function assignment system ff as is one of the first programs that introduced using profile-profile alignment () for protein homology detection, and since its inception it is publicly available on the http://ffas.godziklab.org server. Profileprofile methods have been proved to be more accurate and more sensitive than sequence sequence alignment and sequence profile alignment methods (), and such methods are now widely used in various types of applications, such as protein structure prediction (), function assignment (), new domain annotation() and aiding molecular replacement method of protein crystallography (). The performance of the profile-profile comparison depends critically on the diversity of sequences included in the profiles. With low diversity, the performance of profile-profile alignment becomes similar to that of the sequence sequence alignment. Continuous growth of the protein sequence databases partly alleviates this problem. In addition, accuracy of profile-profile algorithms can be improved by using additional information to add more sequences to the profile or by adding other features/ descriptors to it. In the former category, one can include sequence fragments with similar structure in the profile calculation, as done in the SP 3 method (), or incorporate more distant homologs in the profile calculation by using a higher Evalue cut off in position specific Iterated Basic Local Alignment Search Tool (PSI-BLAST) () searches as done by multi sources ThreadER (MUSTER) (). In the latter category, one can expand scoring by including real or predicted structural features such as secondary structure (SS) type, solvent accessibility (SA) and torsion angles (). This strategy recently became increasingly effective because of the improving accuracy of methods for predicting local structural features. It is important to note that using local structural features predicted from sequence allows comparison of profiles of proteins neither of which has an experimentally determined structure. In this study, we tested various predicted local structural features in the context of the ff as scoring, including SS, residue type independent SA and residue depth (RD). Besides testing *To whom correspondence should be addressed. y The authors wish it to be known that, in their opinion, the first two authors should be regarded as joint First Authors. the new composite score, we predict the accuracy of each alignment by neural network trained on various parameters of the alignment. All new features were tested on benchmarks independent from the training set.
