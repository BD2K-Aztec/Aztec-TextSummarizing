Motivation: Sequence databases are growing fast, challenging existing analysis pipelines. Reducing the redundancy of sequence databases by similarity clustering improves speed and sensitivity of iterative searches. But existing tools can not efficiently cluster databases of the size of UniProt to 50% maximum pairwise sequence identity or below. Furthermore, in meta genomics experiments typically large fractions of reads can not be matched to any known sequence anymore because searching with sensitive but relatively slow tools (e.g. BLAST or HMMER3) through comprehensive databases such as UniProt is becoming too costly. Results: mm seqs many against many sequence searching) is a software suite for fast and deep clustering and searching of large datasets, such as UniProt, or 6 frame translated meta genomics sequencing reads. mm seqs contains three core modules: a fast and sensitive pre filtering module that sums up the scores of similar km ers between query and target sequences, an sse2 and multicore parallelized local alignment module, and a clustering module. In our homology detection benchmarks, mm seqs is much more sensitive and 4â€“30 times faster than u blast and rap search respectively, although it does not reach BLAST sensitivity yet. Using its cascaded clustering workflow, mm seqs can cluster large databases down to $30% sequence identity at hundreds of times the speed of blast clust and much deeper than cd hit and u search. mm seqs can also update a database clustering in linear instead of quadratic time. Its much improved sensitivity speed trade-off should make mm seqs attractive for a wide range of large scale sequence analysis tasks. Availability and implementation: mm seqs is open source software available under GPL at https:// githubcomsoedinglabmmseq s
introduction during the last 8 years, sequencing costs have come down from 10 000 000$ to less than 1000$ for a human genome at 30 times coverage (http://www.genome.gov/sequencingcosts). As a consequence, protein sequence databases such as the UniProt () database have been growing by a factor of 2 every two V C The Author 2016. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals permission soup com years (), leading to longer search times, inflated and redundant results list, large memory requirements and saturating or decreasing sensitivities for informative sequence matches (). A solution is to compute a representative subset of sequences by clustering them by their similarity and selecting one representative per cluster. Such clustering schemes achieve a more even sampling, leading to better sensitivities in sequence searches (). UniRef provides representative subsets of UniProtKB clustered at 100%, 90% and 50% sequence identity (). Clustering schemes are also used in meta genomics projects to reduce the size and redundancy of the ever larger amounts of sequence data (). Several tools for clustering protein sequence databases have been developed. blast clust from the NCBI BLAST package is sensitive but slow. It uses greedy single linkage clustering based on all versus all blastp searches (). The fast tools cd hit (), u search () and kc lust () share several similarities. First, they employ the same incremental, greedy clustering scheme, in which each database sequence (the 'query') is compared with the representative sequences of already established clusters. If one of the representative sequences is sufficiently similar, the query is added to this cluster or otherwise becomes the representative of a new cluster. Second, all three tools employ a km er word based similarity prefilter that drastically reduces the number of slow but accurate smith waterman alignments. The pre filters in cd hit and u search count the number of common, identical km er words between sequences, with k  5 or 6 for u search and k between 2 and 5 for cd hit. To obtain a sufficient number of common km ers between sequences with only 50% residue wise sequence identity, cd hit has to lower k to 2. But this leads to a high probability $ 1=20 k for chance km er matches. Therefore, the number of chance matches in an all against all comparison of N sequences of average length L is around NL 2 =20 k , which becomes huge for small k. Since each chance match costs a constant amount of time to process, short words lead to an enormous slow down. kc lust employs a km er based prefilter that can even detect pairs at 2030% sequence identity at high speed. To keep the probability for chance matches low and speed high, it uses long words with k  6 or 7. But to increase sensitivity at the same time, it detects similar instead of just identical km ers. For each km er in the query sequence, it computes a list of all km ers with a BLOSUM62 bit score above a certain cut off and finds identical matches to these similar km ers in the database sequences. The prefilter then scores each database sequence by the sum of similarity scores of similar km ers. A further challenge arising from the rapid progress in high throughput sequencing is the need for sensitive but fast protein sequence search methods. A large fraction of meta genomics reads can not be mapped to any known sequence from a cultivated organism anymore, because it has become too costly to search through the entire UniProt database using a sensitive but slow tool such as BLASTX (): It would take approximately 2398 CPU years to search with all 6 frame translated sequences from 2 10 9 reads of length 150 nucleotides through the current UniProt database using BLASTX. Instead, in most projects, much smaller databases are searched, such as KEGG GENOME (), a collection of high quality genome sequences, or the meta phl an () database of unique clade specific marker genes (). This carries the risk of missing some of the most interesting matches, which do not conform to prior expectations. To address this challenge, a number of fast protein sequence search tools have been developed: Tachyon (), p aud a (), p sims can (), rap search 2 (), Lambda (), u blast () and DIAMOND (). The latter five, which are the most sensitive in this list, find exact matches of (spaced) km ers and extend the alignment around them. mm seqs addresses the need for a clustering and search tool that is both fast and sensitive enough to be able to detect sequence matches down to $30% residue wise sequence identity. While it uses the same core pre filtering algorithm as kc lust it has various important advantages: (i) Its organization into modules pre filtering alignment, clustering) and workflows increases flexibility and facilitates future extensions. (ii) Its search workflow can perform sequence searches. With a speed 1000 times faster than BLAST it finds similarities down to 30% sequence identity and is much more sensitive than similarly fast search tools. (iii) Its cascaded clustering workflow achieves much deeper clustering than kc lust in a shorter time. (iv) Its database updating workflow adds sequences to a previously clustered set in linear time, obviating the need for frequent re clustering in quadratic time. (v) mm seqs is implemented highly efficiently, using SIMD single instruction multiple data instructions to vectorize time critical loops. (vi) It is parallelized using OpenMP to run on multi-core CPUs (vii) To save memory, the database can be divided into several parts and processed consecutively. (viii) Its prefilter uses a novel Z-score statistic for higher sensitivity and a score correction for compositionally biased sequence regions. (ix) It offers the greedy set cover algorithm for clustering, in addition to the simple, incremental algorithm used by kc lust u search and cd hit enabling deeper clusterings. (x) It performs exact smith waterman alignment based on the striped SIMD algorithm () instead of the approximate km er dynamic programming algorithm developed for kc lust
