Motivation: High Throughput Sequencing (HTS) has enabled researchers to probe the human T cell receptor (TCR) repertoire, which consists of many rare sequences. Distinguishing between true but rare TCR sequences and variants generated by polymerase chain reaction (PCR) and sequenc-ing errors remains a formidable challenge. The conventional approach to handle errors is to remove low quality reads, and or rare TCR sequences. Such filtering discards a large number of true and often rare TCR sequences. However, accurate identification and quantification of rare TCR sequences is essential for repertoire diversity estimation. Results: We devised a pipeline, called Recover TCR rtc r that accurately recovers TCR sequences , including rare TCR sequences, from HTS data (including barcoded data) even at low coverage. rtc r employs a data driven statistical model to rectify PCR and sequencing errors in an adaptive manner. Using simulations, we demonstrate that rtc r can easily adapt to the error profiles of different types of sequencers and exhibits consistently high recall and high precision even at low coverages where other pipelines perform poorly. Using published real data, we show that rtc r accurately resolves sequencing errors and outperforms all other pipelines. Availability and Implementation: The rtc r pipeline is implemented in Python (v2.7) and C and is freely available at http://uubram.github.io/RTCR/along with documentation and examples of typical usage.

introduction t cells are crucial to the adaptive immune system, enabling it to recognize almost any pathogen that infects the host while remaining tolerant to many self antigens. The recognition of antigens by T cells is mediated by the T cell receptor (TCR). Through random genetic recombination, the immune system can potentially equip every T cell with a different TCR, allowing it to bind different antigens than other T cells. The different T cells together form a T cell repertoire, which due to its pivotal role in the immune response, is studied extensively in areas such as infectious diseases, cancer, autoimmunity and ageing (). Classical TCRs are heterodimers, consisting of ab protein chains. The genes encoding the a and b chains are generated via somatic stochastic DNA rearrangements, in which germline variable (V), diversity (D) and joining (J) gene segments recombine (). Random deletions and non templated nucleotide insertions occur at the V(D)J junctions, which together with the random selection of gene segments is responsible for generating a full repertoire of TCRs. Theoretically, $5  10 11 different TCR b chains are possible (), which together with the tcr a chains can result in more than 10 15 distinct TCRs (). Because humans have $10 12 T cells (), every individual harbors at most only a small but diverse () fraction of this potential repertoire. High throughput sequencing (HTS) (;) is often used to probe the TCR repertoire (). Analysing the repertoire is challenging because of its high diversity and many rare clo no types pushing the boundaries of sequencing technologies. Some of the important confounding factors in quantification and identification of the repertoire are: short read length (e.g. 150 bp reads whereas the VDJ region of the TCR is $500 bp), unequal polymerase chain reaction (PCR) amplification, sequencing errors and sampling biases (). Despite the improvements in sequencing technologies, quantification of true TCR repertoire diversity remains elusive, because the repertoire is heavily under sampled and sequencing errors artificially skew the repertoire. To analyse HTS data from TCR repertoires, multiple pipelines have been developed. Some of these are: IMGT (), which provides a web interface and detailed annotations, is sake (), which assembles immune receptors from very short reads, ir map (), designed for 454 sequencing data, de combinator (), designed for fast annotation, mit cr (), mix cr () and im seq () focusing on error correction, Presto van der and mig ec () handling reads with unique molecular identifiers ('barcoded' data) and tcr klass () annotating all reads including those that lack the complementarity determining region 3 (CDR3) of the TCR. Most of these pipelines filter out low quality reads and or remove rare TCR sequences. Since most unique TCR sequences are rare, such filtering can cause a massive loss of true TCR sequences. We developed a pipeline, called Recover TCR rtc r that attempts to accurately recover TCR sequences at varying coverage, including rare TCR sequences while maintaining high precision and high recall. Accurate quantification of TCR repertoires is especially important in clinical settings, where low coverage TCR sequencing can be used for cost effectiveness. There are multiple ways to identify sequence errors in HTS data. Some of these are: (i) base quality, i.e. a low quality base is more likely to be false than a high quality base, and (ii) similarity, i.e. true TCR sequences tend to be surrounded by similar erroneous variants due to PCR and sequencing errors. In rtc r these strategies are translated into a simple binomial model () together with several heuristics to rationally eliminate PCR and sequencing errors. rtc r automatically sets its parameters based on the data, relieving the user from setting arbitrary parameters. rtc r supports 'barcoded' HTS data, combining barcode based error correction with its regular error correction. To measure the performance of rtc r we compared it to tcr klass mit cr mix cr im seq and mig ec using simulated and real HTS datasets. We demonstrate that rtc r can easily adapt to error profiles of different types of sequencers and exhibits consistently high recall and high precision even at low coverage. We benchmark different pipelines using several synthetic TCR HTS datasets generated via realistic PCR and sequencing simulations. We find that rtc r outperforms all other pipelines on recall and matches the high precision of mit cr mix cr and im seq. Using real data we then show that rtc r can accurately resolve apparent sequencing errors which are in completely resolved by other pipelines.

conclusion tcrs exhibit enormous diversity due to somatic recombination. The advent of HTS has enabled us to sequence large number of TCR sequences from an individual. However, HTS is marred by errors and given the TCR diversity it becomes difficult to distinguish between true TCR sequence and erroneous variants. We here present rtc r a pipeline designed to accurately recover TCR sequences from error prone HTS data. rtc r performs error correction using a statistical model and estimates the model parameters from the data, relieving the user from setting arbitrary parameters. Using simulations and experimental data, we demonstrate that rtc r can identify, and correct PCR and sequencing errors exhibiting consistently high precision and recall. The high accuracy of rtc r makes it well suited for estimation of repertoire diversity and for disease profiling. Especially in the lower coverage (1 and 10) simulated datasets, rtc r outperformed all other pipelines. This means that rtc r has the potential to make the analysis of repertoire sequencing data more cost effective conflict of Interest: none declared.
