Motivation: Recent advances in high throughput sequencing (HTS) have made it possible to monitor genomes in great detail. New experiments not only use HTS to measure genomic features at one time point but also monitor them changing over time with the aim of identifying significant changes in their abundance. In population genetics, for example, allele frequencies are monitored over time to detect significant frequency changes that indicate selection pressures. Previous attempts at analyzing data from HTS experiments have been limited as they could not simultaneously include data at intermediate time points, replicate experiments and sources of uncertainty specific to HTS such as sequencing depth. Results: We present the beta binomial Gaussian process model for ranking features with significant non-random variation in abundance over time. The features are assumed to represent proportions , such as proportion of an alternative allele in a population. We use the beta binomial model to capture the uncertainty arising from finite sequencing depth and combine it with a Gaussian process model over the time series. In simulations that mimic the features of experimental evolution data, the proposed method clearly outperforms classical testing in average precision of finding selected alleles. We also present simulations exploring different experimental design choices and results on real data from Drosophila experimental evolution experiment in temperature adaptation.

introduction most biological processes are dynamic and analysis of time series data is necessary to understand them. Recent advances in high throughput sequencing (HTS) technologies have provided new experimental approaches to collect genome wide time series. For example, experimental evolution now uses a new evolve and resequencing (ER) approach to understand which genes are targeted by selection and how (). Such experiments enable phenotypic divergence to be forced in response to changes in only few environmental conditions in the laboratory while other conditions are kept constant. The evolved populations are then subjected to HTS. Experimental evolution in microorganisms has focused on the fate new mutations. For example, in Escherichia coli () and Saccharomyces cerevis ae () new mutations were studied. In contrast, ER experiments with sexually reproducing multicellular organisms address selection on standing variation and allele frequency changes (AFCs) in small populations where drift plays an important role. For example, for Drosophila melanogaster (Dmel), several phenotypic traits, such as accelerated development (), body size variation (), hypoxia tolerance () and temperature adaptation () have been investigated. Motivated by these experimental studies, we believe that experimental evolution combined with HTS supplies a good basis for studying AFC through time series molecular data. To perform allele frequency comparisons, pairwise statistical tests between base and evolved populations were typically carried out combined Fisher's exact tests with a sliding window approach to identify genomic regions that show allele frequency differences between populations selected for accelerated development and controls without direct selection developed a pairwise summary statistic, called 'diff-Stat' to estimate the observed distribution of allele frequency differences and compared this to the expected distribution without selection identify single nucleotide polymorphisms (SNPs) with a consistent AFC among replicates by performing a cochran mantel haenszel test (CMH) (). The latter is an extension of the Fisher's exact test to multiple replicates. All aforementioned statistical methods are based on pairwise comparisons between the base and evolved populations and they do not take full advantage of the time series data now available developed a method to analyze time series data based on population genetic models and estimated the effective population size N e of a bacteriophage from a single locus derived a model for time series data from large populations of microorganisms (N e % 10 8 ) where drift can be ignored and the population allele frequencies evolve quasi deterministically. Here, we propose an alternative Gaussian process (GP) based approach to study AFCs over the entire time series experiment genome wide for small populations (N e % 10 2  10 3 ). GP is a non-parametric statistical model that is extremely well suited for modelling HTS time series data, which usually have relatively few time points that may be irregularly sampled. Recently, there have been some works applying GP models with parameters describing the process of evolution (e.g. Jones and Moriarty, 2013 account for phylogenetic relationships, Palacios and min in 2013 for effective population size). GPs have also recently been applied to gene expression time series by a number of authors (A ). In differential analysis, GPs have been applied to detect differences in gene expression time series in a two sample setting by and for detecting significant changes by kala itz is and Lawrence (2011). Although these methods provide a sensible basis for detecting the changing alleles, they fail to properly take into account all aspects of the available HTS data, such as differences in sequencing depth between different alleles and time points. These differences can have a huge impact in the reliability of different measured allele frequencies and taking them into account is vital for achieving good accuracy with the available short time series.

discussion our results in detecting SNPs that are evolving under selection using a GP model clearly demonstrate the importance of careful modelling of the measurement uncertainty through a good noise model, in our case using the beta binomial model of sequencing data. Especially when data are scarce, the b bgp approach leads to much higher accuracy than standard maximum likelihood estimation of noise variances. Incorporating the non gaussian likelihood directly to the GP would also be possible, but it would lead to computationally more demanding inference. In terms of experimental design, the most effective way to improve performance is to use a larger population (N) and a larger number of founder haplotypes (H). As expected, alleles under moderate to strong selection (s  0.050.1) are easier to detect than alleles changing under weak selection (s 0:01). However, for very strong selection (s ! 0:2), it is again hard to detect the causal SNPs. In a real experiment, the strength of selection might also not be known and often can not be changed for the trait of interest. Adding more replicates can also help improve performance up to some point. Compared with the CMH test, the b bgp is clearly superior in utilizing additional replicates. We suspect this is because CMH assumes all replicates should have similar odds ratios between the two time points and this is not sufficiently satisfied by the noisy data. Longer experiments can help significantly (Supplementary), but the benefit of adding more intermediate time points seems smaller. This may be because the shape of selected trajectories is a simple sigmoid, and adding more points provides limited help in estimating them. The presented gp based test is sensitive to SNPs with a consistent time varying profile. A statistically more accurate model could be derived by assuming each replicate to follow an independent GP, but this would require different kind of constraints to differentiate between selection and drift, which may be difficult to formulate for multiple interacting SNPs. Exploring hierarchical GP models to capture the correct dependence structure is an interesting avenue of future research. In a whole genome experiment, LD between nearby markers and interactions between nearby selected SNPs are important confounders in identifying the selected markers. Especially for moderate sized populations, the interactions can be problematic, leading to very large segments in the genome raising together in frequency (Supplementary). The issue does not appear when simulating only a single selected SNP (Supplementary), which strongly suggests it is caused by the interactions. The issue can be most effectively mitigated by using larger populations (Supplementary). An artificially high recombination rate supplementary and b) could also break the interactions. Working with larger fixed window sizes might not improve the performance as a substantial number of hitchhikers can still be found hundreds of kilobases from the selected SNPs (See Supplementary: The removal of nearby hitchhikers did not improve the AP noticeably). It is possible to extend the GP models for joint analysis of multiple SNPs, and this is clearly an important avenue of future research. This is potentially a further advantage of the GP, because it is much more difficult to similarly extend the frequentist tests.
