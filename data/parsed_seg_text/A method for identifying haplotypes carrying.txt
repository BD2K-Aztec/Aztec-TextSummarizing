Motivation: Methods for detecting positive selection relied on finding evidence of long haplotypes to identify candidate regions under selection. However, these methods generally do not identify the length and form of the selected haplotype. Results: We present hap finder a method which can find the common longest haplotype under three different settings from a database, which is relevant in the analysis of positive selection in population genetics and also in medical genetics for finding the likely haplotype form carrying the causal allele at the functional polymorphism. Availability: A java program, implementing the methods described in hap finder together with R scripts and datasets for producing the figures presented in this article are publicly available at

introduction haplotypes refer to the specific combinations of alleles at different locations on a chromosome. Diploid organisms such as humans carry two copies of chromosomes, and thus two haplotypes are present for each individual when considering the chromosomal arrangement of the alleles at several variant sites, such as single nucleotide polymorphisms (SNPs). At the fundamental level, the haplotype carries most of the genetic information, particularly for the assessment of allelic correlation in the genome and in situations where the exact sequence arrangement on the chromosome is important. However, the technical ease of as saying a single base position in the genome means it is more common to obtain the aggregate information across the two chromosomes of an individual, also known as the genotype. The advent of affordable large scale genotyping technologies has permitted the genotypes of up to a million positions across the human genome to be assayed simultaneously, facilitating the studies on the genetic etiology of * To whom correspondence should be addressed. common diseases and complex traits across thousands of samples (). When only genotype information is available, resolving the exact arrangements of the alleles on the two haplotypes for an individual requires sophisticated statistical machinery in a process known as haplotype phasing. A number of statistical procedures have been formulated for inferring the haplotype phases from genotype data, such as PHASE (), fast phase () and Beagle (). Public databases like the International HapMap Project (), Human Genome Diversity Project () and Singapore Genome Variation Project () have generated reference genotypes for a considerable number of populations globally, with statistically inferred haplotypes also available for a number of these populations. Generally, the lengths of common shared ancestral segments of chromosomes in a population are short since recombination acts over time to break down long haplotypes. An exception is in genomic regions experiencing positive evolutionary pressure of natural selection (), where greater fitness in survival and procreation results in a higher propensity that offsprings in subsequent generations will increasingly carry the advantageous mutations. This can increase the frequency of an advantageous allele and, due to the hitch-hiking effects of neighbouring alleles and insufficient time for recombination to occur, result in haplotypes that are uncharacteristically long for a given haplotype frequency. A number of sophisticated statistical methods, for example, xp ehh () and iHS (), have relied on finding such genomic signatures of long haplotypes for identifying candidate regions that are experiencing positive selection. However, these methods generally do not identify the length and form of the selected haplotype. The presence of linkage disequilibrium (LD) in the human genome implies that there will be numerous SNPs that are correlated with each other. In large scale genotype phenotype association studies, the discovery of a trait associated region is often accompanied by a list of neighbouring SNPs displaying similar degrees of statistical evidence. Due to the nature of LD, most, if not all of the identified alleles carried on these SNPs are likely to be found on a haplotype that also carries the functional allele at the unknown causal variant. This would be useful for narrowing the likely candidate region where the functional variant may be located, particularly when evidence from multiple page 823 822828

discussion we have introduced a strategy for finding haplotypes under three scenarios that are relevant to the analysis of positive natural selection and g was. The classical example of the sickle cell locus was also used to highlight the utility of the method, both in finding the selected haplotype and at estimating the likely frequency of the selected allele. By simulating case control data around an artificial causal SNP for each of the three HapMap panels, the method is able to identify the haplotype forms that carry the detrimental alleles at the associated SNPs that had emerged from the association analysis in each population separately. All three haplotype forms identified from the respective HapMap populations correctly carried the functional allele at the simulated causal variant. Further simulations indicate at least 80% power in identifying the haplotype form which the functional allele resides on. Our method is able to identify the longest haplotype at a specified core frequency around a focal position. Theoretically, this can be applied across the genome at every available SNP and across a range of core haplotype frequencies. For a particular core frequency, one may expect the lengths of the identified haplotypes to be distributed within a specific range, and haplotypes that are uncharacteristically long for a particular core frequency could be the result of positive natural selection happening within those genomic regions. This may provide another strategy in searching for candidate signals of positive selection, although there is a need to account for local effects of LD that may potentially bias the analysis (work in progress). The field of medical genetics is now focusing its attention towards the fine mapping of the functional polymorphisms that explain the biological mechanisms and underpin the genotype phenotype association signals emerging from g was. However, while LD has benefitted the initial examination for implicated regions in the genome, long stretches of high LD have paradoxically confounded the fine mapping process by yielding numerous near perfect surrogates of the unknown causal variant. This complicates the process of distinguishing the causal variant from neighbouring correlated markers. When g was data and high resolution haplotypes (e.g. those from the 1000 Genomes Project, http://www.1000genomes.org) for multiple populations are available, our method can identify the haplotype forms that are carrying most of the implicated detrimental alleles in the different populations. By framing such trans population analysis within a rigorous statistical framework, it may be possible to identify the genomic regions that are consistent with the association findings and the population specific reference haplotype structure. This could subsequently be developed to localize the candidate positions of the functional polymorphism () (work in progress). The popularity of genome wide studies coupled with fast haplotype phasing software like fast phase () and Beagle () means it is realistically possible to statistically construct the haplotypes from the genotype data of thousands of samples. This is likely to be extremely useful in both population and medical genetics, as second order information involving the arrangement of alleles on a chromosome can be more informative than first order information like the allele frequencies from genotypes of individual SNPs, particularly in understanding genomic diversity across multiple populations. In fact, several major population genetics studies have relied on the haplotype diversity plots as empirical evidence on the extent of inter population dissimilarities (). We thus introduce hap finder a novel methodological development specifically designed to find haplotypes within a population setting, which complements statistical tools for detecting positive natural selection and facilitates progress in medical genetics by locating the likely haplotype structure that the functional allele will sit on. This method has been implemented in a Java program which is packaged together with scripts for producing graphical displays in R and is freely available from http://www.nuscme.org.sg/sgvp/software/hapfinder.html. This URL also contains an interactive application for submitting online queries to find haplotypes from populations in Phase 2 of the HapMap and the Singapore Genome Variation Project.
