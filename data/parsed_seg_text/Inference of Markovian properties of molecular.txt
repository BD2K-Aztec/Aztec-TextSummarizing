Motivation: next generation sequencing (NGS) technologies generate large amounts of short read data for many different organisms. The fact that NGS reads are generally short makes it challenging to assemble the reads and reconstruct the original genome sequence. For clustering genomes using such NGS data, word count based alignment free sequence comparison is a promising approach, but for this approach, the underlying expected word counts are essential. A plausible model for this underlying distribution of word counts is given through modeling the DNA sequence as a Markov chain (MC). For single long sequences, efficient statistics are available to estimate the order of MCs and the transition probability matrix for the sequences. As NGS data do not provide a single long sequence, inference methods on Markovian properties of sequences based on single long sequences can not be directly used for NGS short read data. Results: Here we derive a normal approximation for such word counts. We also show that the traditional Chi-square statistic has an approximate gamma distribution, using the lander waterman model for physical mapping. We propose several methods to estimate the order of the MC based on NGS reads and evaluate those using simulations. We illustrate the applications of our results by clustering genomic sequences of several vertebrate and tree species based on NGS reads using alignment free sequence dissimilarity measures. We find that the estimated order of the MC has a considerable effect on the clustering results, and that the clustering results that use an MC of the estimated order give a plausible clustering of the species. Availability and implementation: Our implementation of the statistics developed here is available as R package NGS.

introduction next generation sequencing (NGS) technologies generate large amounts of overlapping short read data for many different organisms; for example a read is a subsequence of 400 bps for Illumina and 700 bps for 454 sequencing technologies, and can sometimes be much shorter. The fact that NGS reads are generally short makes it challenging to reconstruct the original genome sequence. Recently several word count based alignment free sequence comparison methods have been applied to infer the relationship among different species () and meta genomic samples () based on NGS reads without assembly. Our alignment free sequence dissimilarity measures, d  2 and d S 2 (), and their variants () have shown promise. These methods require the knowledge about the approximate distribution of word counts in the underlying sequences. Although a model which assumes that all letters in the sequence are equally likely is relatively straightforward to analyze, see, a Markov model for the underlying sequences is more realistic. Markov chains (MCs) have been widely used to model molecular sequences () with many applications including the study of dependencies between the bases (), the enrichment and depletion of certain word patterns (), prediction of occurrences of long word patterns from short patterns (), and the detection of signals in introns ().studied the effect of the order of MCs on several biological problems including phylogenetic analysis, assignment of sequence fragments to different genomes in me tag nomic studies, motif discovery and functional classification of promoters. These applications showed the importance of accurate specification of the order of MCs. Reliable estimators for the order of the MC and the transition probability matrix based on the sequence data are crucial. Suppose a relatively long molecular sequence can be modelled as a general finite state MC sequence of letters from a finite alphabet A  f1; 2;    ; Lg of size L. Consider testing the null hypothesis that the long sequence follows a k  2th order MC. With some mild assumptions showed that, under this null hypothesis, twice the log likelihood ratio of the probability of the sequence under a k  1th order MC versus that under the k  2th order MC model follows approximately a v 2 distribution with df k  L  1 2 L k2 degrees of freedom. He also approximated the log likelihood ratio by the pearson type statistic which is also approximately v 2 distributed with the same degrees of freedom. Here, w  w 1 w 2    w k denotes a k-word formed of letters the count of the word w in the sequence, and E w  N w N w  =N w  is the estimated expected count of w if the sequence is generated by an MC of order k  2. Here k!3; see also a very and Henderson (1999) for a detailed study, Billingsley (1961a,b) for an excellent exposition of statistical issues related to MCs, as well as for applications to sequence analysis. The Chi-square statistic (1) and the log likelihood ratio statistics can be used to test the order of an MC, using all k words w 2 A k. When a particular order of MC is rejected, we can identify particular word patterns that are exceptional, through the approximate distribution of N w. The approximate distributions of N w in long sequences is well understood, see for example;). In particular, suppose that the sequence follows a stationary (k  2)th order MC and let theorem 6.4.2 in gives that, as sequence length goes to infinity, for all real values x, PZ w x ! Ux; where U denotes the cumulative distribution function of a standard normal variable. We also say that Z w converges to the standard normal distribution N(0, 1) in distribution. This asymptotic result can then be used to find exceptional words in long sequences. Given an NGS short read sample, it is tempting to use the test statistic S k defined in (1) to test the order of an MC by simply counting the number of the occurrences of words in short read data. However, as the short reads from NGS data are sampled randomly from the genome, some parts of the genome are possibly not sampled and some parts are possibly sampled extensively. The sampling process introduces additional randomness to the statistic, and makes S k deviate from its traditional v 2 distribution. Similarly, the approximate distribution of Z w given in (2) will be different from the standard normal distribution. In this article, we study these approximate distributions, both theoretically and by simulations. First we extend the statistics S k and Z w for an MC sequence to S R k and Z R w for the NGS read data. Our underlying model for the distribution of reads along the genome is the potentially inhomogeneous lander waterman model for physical mapping (). We discover that for a set of short reads sampled from a k  2th order MC sequence, the statistic S R k follows approximately a gamma distribution with shape parameter df k =2 and scale parameter 2d, where d is a factor related to the distribution of the reads along the genome. We also show that, with the same factor d, the distribution of the single word statistic Z R w = ffi ffi ffi d p tends to the standard normal distribution. Based on the theoretical results, we introduce an estimator for the order of the MC using NGS data. For practical purposes, we also give an estimator for the factor d when the underlying reads sampling distribution is unknown. To the best of our knowledge, this is the first study of the Markovian properties of molecular sequences based on NGS read data. To illustrate our theoretical results and our estimators, we first carry out a simulation study based on transition probability matrices which are estimated from cis regulatory module (CRM) DNA sequences, and insert repeats. We simulate different read lengths, numbers of reads, inhomogeneous sampling, as well as sequencing errors, and we include a regime where the sampling rate depends on the GC content. If the GC bias is not very strong or the sequencing depth is not very low, then the simulation results agree with our theoretical predictions despite the theoretical assumptions being slightly violated. Next we apply our methods to cluster 28 vertebrate species using our alignment free dissimilarity measures d  2 and d S 2 under different MC models which are estimated from NGS read samples. The estimated orders based on NGS data without assembly are found to be consistent with those inferred directly from the long genome sequences. The clustering performs best when using MCs around the estimated order. Applying the same analysis to 13 tropical tree species whose genomes are unknown, based on their NGS read samples, the most plausible clustering is achieved when using an MC model of order close to the one estimated from the NGS reads. The article is organized as follows. The 'Methods' section contains the probabilistic models of generating the MC sequence and sampling the short reads, as well as the theorem for the approximate distributions of S R k and Z R w for NGS data. This theorem is used to derive our estimators for the order of the MC and for the factor d. In the 'Results' section, we first provide extensive simulation studies including the comparison of the theoretical approximate distributions and the simulated results for S R k and Z R w , the effect of inhomogeneous sampling and sequencing errors, the efficiency of the estimator of the factor d, and the evaluations of the methods for estimating the MC order. Second, we estimate the orders of the MCs for 28 vertebrate species based on the simulated whole genome NGS samples. We then use our dissimilarity measures d  2 and d S 2 to cluster the NGS samples of the 28 species under different MC orders to see the effect on the performance of the clustering. The applications show that our new methods are effective for the inference of relationships among sequences based on NGS reads. Finally, we use our methods to study the relationships among 13 tree species whose complete genomic sequences as well as their phylogenetic relationships are unknown. Our clustering results are consistent with the physical characteristics of the tree species. The article concludes with some discussion of the study.

discussion ngs technologies provide large amount of data in the form of short reads. Assembly of the millions of short reads to recover the long sequence is challenging, because the relative short length of the reads makes it difficult to resolve the repeat regions, not all regions may be covered, and assembly is time consuming. Although multiple sequence alignment may be prohibitive, we can use word count based dissimilarity measures to cluster the underlying species. These measures require an underlying probability model for the sequences; MCs are a reasonable model for such sequences. Although transition probabilities can be estimated directly from count data, estimating the order of an MC here is not straightforward. Methods for estimating the order of an MC of a long sequence have been developed since the 1950s, but estimating the order of an MC directly from a set of short reads without assembly has not been studied yet. In this article, we develop two statistics S R k and Z R w and show that both S R k and Z R w have surprisingly simple approximate distributions with only two parameters, one of them depending on the order of the original long MC sequence, and the other one depending on the distribution of the reads along the sequence. Intriguingly, one of these parameters is d  c  1 under homogeneous sampling, where c is the coverage of the reads along the genome based on the first b  k  1 positions of each read on the basis of the property of S R k and Z R w , we develop an estimator for the order of an MC as well as an estimator for the parameter d based on NGS data. Extensive simulation studies are carried out to verify the theorem and evaluate the estimator. Finally, we apply the estimation methods to two NGS datasets. Because the real genome sequences consist of coding, non-coding and various regulatory regions, single standard MC models do not fit the data well. Moreover, some enriched patterns, such as the motif sequences, are widespread throughout the genomes and violate the simple MC model for the whole genome sequence. Hence studying the fraction of k words whose occurrences can be explained using the statistic Z R w  2 =d by comparison to a v 2 1 distribution is a more realistic way to determine the order of the MC for a real genome sequence. The estimated orders are consistent with the orders estimated directly from the full genome sequences using BIC methods. Our primary motivation for this study is alignment free genome comparison using NGS data. Further, we cluster the 28 species based on the NGS data using MC models with various orders. The results show that the clustering performs best and gives stable results when using an MC model with order on and above the estimated order. In addition, we apply the same analysis to 13 tropical tree species whose reference genomes are unknown; again the best clustering is achieved under an MC with the order within the estimated range. When the sequence length is short or the sequencing depth is low, the numbers of occurrences of some k words become small or even zero. Then the assumption of non-zero variance for all word counts which underlies the gamma approximation for S R k no longer holds and the gamma approximation may not work well. In such a situation an exact test for the order of MCs in the spirit of be sag and Mondal (2013) could be very helpful. In this article, we have only made a start on the MC modeling of NGS data. An exhaustive study of errors in the data, in the form of power studies, could help to further understand the application range of our results. Finally, in this work we take the estimation of the transition probabilities for granted, once the order of the MC is determined. Although the estimation of the transition probabilities of the MC model of a long sequence has been studied by Anderson and Goodman (1957) and, it would be interesting to extend these methods to NGS data.
