Motivation: Identifying the target genes regulated by transcription factors (TFs) is the most basic step in understanding gene regulation. Recent advances in high throughput sequencing technology, together with chromatin immunoprecipitation (ChIP), enable mapping TF binding sites genome wide, but it is not possible to infer function from binding alone. This is especially true in mammalian systems, where regulation often occurs through long range enhancers in generic h neighborhoods, rather than proximal promoters, preventing straightforward assignment of a binding site to a target gene. Results: We present EMBER (Expectation Maximization of Binding and Expression pRofiles), a method that integrates high throughput binding data (e.g. chip chip or chips eq with gene expression data (e.g. DNA microarray) via an unsupervised machine learning algorithm for inferring the gene targets of sets of TF binding sites. Genes selected are those that match overrepresented expression patterns, which can be used to provide information about multiple TF regulatory modes. We apply the method to genome wide human breast cancer data and demonstrate that EMBER confirms a role for the TFs estrogen receptor alpha, retinoic acid receptors alpha and gamma in breast cancer development, whereas the conventional approach of assigning regulatory targets based on proximity does not. Additionally, we compare several predicted target genes from EMBER to interactions inferred previously, examine combinatorial effects of TFs on gene regulation and illustrate the ability of EMBER to discover multiple modes of regulation. Availability: All code used for this work is available at

introduction the fundamental step in gene regulation is a transcription factor (TF) binding DNA. Recent advances in DNA sequencing and microarray technologies have led to huge increases in the amount of information that biologists can accumulate about this process (; * To whom correspondence should be addressed.). In particular, chip chip and chips eq experiments have enabled genome wide mapping of TF binding sites in a single experiment. Knowledge of these binding sites is one of the key steps in determining which genes are regulated by a TF, but the binding sites alone are not sufficient to infer regulation. In simple organisms, such as bacteria or yeast, most transcriptional regulation occurs by a TF binding in a promoter region, near the transcription start site (TSS) of a gene (). However, as organisms increase in complexity, more regulation occurs through long range enhancers, often spanning many tens of thousands of base pairs (). In fact, these enhancer interactions become the principal form of gene regulation in more complex species. For example, in the human chip chip data () that we discuss later in this article, only 510% of the binding sites are in promoters (defined as 2 kb from a TSS). In this case, it is not obvious which gene a particular binding site may be regulating: enhancer regulation is independent of the binding site orientation relative to the regulated gene (), and even transcription factors bound to a particular gene may regulate a different gene through an enhancer (). Additionally, binding sites in generic h locations of the genome have a large number of potential targets nearby. Although we may have some idea of the maximum range at which an enhancer is likely to function (), any gene within that distance must be considered a potential target. A common approach to assigning gene targets to TF binding sites is simply to use proximity: regulation is inferred by the presence of a binding site close to a gene, most often by assignment to the nearest gene (). This approach is clearly an over simplification, as it is not clear that a gene 30 kb from a gene is significantly more likely to be regulated than a gene 40 kb away, for example. More importantly, this approach can miss important long range interactions and is unable to distinguish functional from non-functional binding sites. In situations where enhancer regulation is predominant, more information is needed to properly pair binding sites with their regulatory targets. We propose using gene expression information to assign TF binding sites to gene targets. Namely, we assume that genes regulated by a TF should be have in some measurably consistent manner. That is, there should be some subset of true targets within the many potential targets surrounding each binding site, and we should
