Motivation: Functional enrichment analysis using primary genomics datasets is an emerging approach to complement established methods for functional enrichment based on predefined lists of functionally related genes. Currently used methods depend on creating lists of significant and non-significant genes based on ad hoc significance cutoffs. This can lead to loss of statistical power and can introduce biases affecting the interpretation of experimental results. Results: We developed and validated a new statistical framework, generalized random set (GRS) analysis, for comparing the genomic signatures in two datasets without the need for gene categorization. In our tests, GRS produced correct measures of statistical significance, and it showed dramatic improvement in the statistical power over other methods currently used in this setting. We also developed a procedure for identifying genes driving the concordance of the genomics profiles and demonstrated a dramatic improvement in functional coherence of genes identified in such analysis. Availability: GRS can be downloaded as part of the R package CLEAN from http://ClusterAnalysis.org/. An online implementation is available at http://GenomicsPortals.org/. Contact:

introduction elucidating the functional significance of differences in gene expression, or of patterns of different gene expression regulatory events in the context of existing knowledge about gene function has not only become the most challenging, but also the most rewarding aspect of the genomics data analysis (). The most commonly used strategy relies on sets of reference lists containing functionally related genes, such as Gene Ontologies () and KEGG pathways (), to identify functional categories enriched by the differentially regulated genes. Statistical methods and computational procedures for identifying functionally related sets of genes that are associated with new * To whom correspondence should be addressed. experimental data have been studied in detail (). Two basic approaches are used to establish statistical significance of such enrichment. The first approach relies on counting the number of genes in a given functional category that are also differentially expressed, and using the Fisher's exact or chi squared tests to establish the statistical significance of such overlaps. The inherent limitation of this type of analysis is the requirement to choose statistical significance cut off levels for differential expression. This can reduce the statistical power of the analysis (), and different threshold choices may in some situations lead to different enriched categories (). The second approach uses the complete distribution of differential expressions of all genes to identify enriched gene lists, without categorizing them into differentially and non differentially expressed. Statistically, these methods use either rank based kolmogorov smirnov like tests (), or the traditional location shift tests () to identify lists of functionally related genes that are 'more differentially expressed' than a randomly drawn list of genes of the same length. Systematic performance assessments established that, in general, 'location shift' methods using all data outperform chi squared and kolmogorov smirnov like methods (). In a further refinement of this approach, the prob cd methodology () accommodates the use of the complete distribution of differential expression as well as the probabilistic rather than binary assignment of genes to functional categories such as GO by using a probabilistic categorical data analysis approach. Comparing a new, experimentally derived gene list to other, predefined lists of functionally related genes, while widely used, has its limitations. Despite the large number of such gene lists, they are often not adequate for precisely characterizing functional consequences of experimentally derived genomics profiles. First, functional relationship does not necessarily imply co-expression or co regulation. For example, only a fraction of genes associated with the same GO term also exhibit coordinated gene expression (). Consequently, a potentially large portion of genes belonging to a functional category or pathway will never be informative about the association between a genomics profile and the pathway. Second, gene lists associated with a biological concept or process are often incomplete ().Page: 71 7077

discussion we have developed a new method to assess the concordance of gene signatures. The new method was compared with other existing methods evaluating their ability to identify genomics datasets similar to a query dataset based on their respective gene signatures. The ultimate goal of such analysis is to use the phenotypic characteristics of the identified reference sets to elucidate underlying molecular functions of the genomic profile in the new dataset. Comparisons were made with methods specifically used in this context, as well as alternative statistical methods that are applicable in this setting. All of the currently used methods eps a EXALT, CS and lr path use a significance cut off to designate which genes are differentially expressed in the Query dataset. However, the a priori choice of the optimal cut off is a difficult problem. A too restrictive cut off leads to a low number of genes in the signature, particularly in experiments with small sample sizes. Choosing less restrictive) to compute the eps a score for two sets of Query and corresponding Reference signatures as described (N = 5) and compute the respective ROC curves. Query set 1 is a set of compound vehicle comparisons with a relatively large number of genes with low p values. Set 2 is a more 'difficult' set of comparisons where the number of differentially expressed genes for each signature and cut off is lower. For set 1, the FDR cut off results in a better ROC curve than for p value cut off (upper two curves) while for set 2, the less conservative p value cut off produces a better ROC curve than the FDR cut off (lower two curves). cutoffs, on the other hand, often leads to high numbers of genes in the signature which then results in reduced specificity when computing the concordance measures. To illustrate the impact of the cut off choice on subsequent concordance analyses, we used the Connectivity Map data () to first calculate the eps a score for two sets of Query and corresponding Reference signatures as described (N = 5) each time using (i) a stringent significance cut off (FDR  0.1) and (ii) a less conservative one (P  0.01). We then computed the respective ROC curves (). Query set 1 is a set of compound vehicle comparisons with a relatively large number of genes with low p values. Set 2 is a more 'difficult' set of comparisons where the overall number of significant p values is lower for each signature and cut off choice (Supplementary). In the former case, the FDR cut off was the better choice (i.e. the ROC curve for the FDR cut off is above the curve for the p value cut off as it resulted in Query signatures that were more informative for the concordance assessment compared with a larger signature based on a less conservative cut off containing many uninformative genes. In the latter case, however, FDR proved to be too restrictive not producing a sufficiently large gene signature and the p value based cut off was the better alternative still producing signatures with informative genes. That is, ROC curves for set 2 overall are worse than for the less 'difficult' set 1 but the curve for the p value cut off is above the non informative ROC curve for the FDR cut off in this case (). In an elegant theoretical analysis within their unifying RS framework showed that in certain situations (small number of very significant genes), methods based on categorizing genes can outperform methods that rely on the complete expression profiles in the traditional enrichment analysis by gene lists. While it is possible that this result holds in the context of enrichment by primary data, our procedure indicates that it is probably impossible to a priori define optimal significance cutoffs for assessing the concordance of gene signatures. Consequently, one may always be better off using methods that do not rely on defining such cutoffs. Alternative simple statistical methods that do not require specifying statistical significance cutoffs (correlation coefficients, Wilcoxon test) showed surprisingly strong performance in the breast cancer datasets analysis, but performed worse than other methods based on selecting differentially expressed genes eps a EXALT, CS and lr path in the more difficult Connectivity Map data. Our analysis in which we progressively remove the 'signal' by random re-labeling of genes indicates that simple methods perform well when most genes are differentially expressed, but their performance deteriorates when only a fraction of genes are concordant. This could be explained by the fact that if most genes are differentially expressed and concordant, using all genes is better than losing many informative ones due to imperfect statistical power of the differential expression analysis. The fact that our GRS method performs as well as, or better than, any other method in all settings implies that it is capable of correctly weighing the contribution of different genes based on the statistical significance of their differential expression. Our results indicate that simple methods utilizing complete gene expression profiles (correlation, Wilcoxon) and methods that rely on pre selecting differentially expressed genes eps a EXALT, CS and lr path both have domains of superiority. However, our procedure performs optimally in all settings and in difficult situations (such as the Connectivity Map data) clearly outperforms all tested alternatives. Our method provides additional means to functionally annotate newly generated genomics data exploiting the vast number of datasets publicly available through repositories such as GEO (). It is readily available as part of the add-on R package CLEAN () and through our web interface Genomics Portals (). The online version (http://GenomicsPortals.org) facilitates the use of datasets uploaded by the user as well as using any one of the 2000 primary genomics datasets currently deposited in the Genomics Portals as query and reference datasets.
