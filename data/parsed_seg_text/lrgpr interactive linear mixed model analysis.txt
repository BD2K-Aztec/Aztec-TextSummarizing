The linear mixed model is the state of the art method to account for the confounding effects of kinship and population structure in genome wide association studies g was. Current implementations test the effect of one or more genetic markers while including prespecified covariates such as sex. Here we develop an efficient implementation of the linear mixed model that allows composite hypothesis tests to consider genotype interactions with variables such as other genotypes, environment, sex or ancestry. Our R package, lrg pr allows interactive model fitting and examination of regression diagnos-tics to facilitate exploratory data analysis in the context of the linear mixed model. By leveraging parallel and out of core computing for datasets too large to fit in main memory, lrg pr is applicable to large g was datasets and next generation sequencing data. Availability and implementation: lrg pr is an R package available from

introduction genetic confounding owing to kinship and population structure is a common cause of inflation in genome wide association studies g was test statistics and can lead to a substantial increase in false positive results (). Linear mixed models have been widely adopted to correct for genetic confounding in g was analysis (), and the low rank linear mixed model has advantages in terms of power and computational efficiency (). Yet, current software uses a 'one size fits all' paradigm where the analyst selects covariates and a genetic similarity metric, and the program performs a standard analysis on each genetic marker. As g was datasets have become larger and more complex, there is great potential for a custom analysis to identify biologically relevant associations not found by a standard analysis.

application the main contribution of the lrg pr software is its flexibility and integration into the R environment while being scalable to large datasets. This framework facilitates integration of existing analyses in R and rapid prototyping of novel methods. To illustrate its efficiency and scalability, we applied lrg pr to two simulated datasets of 5000 samples with 500 000 markers and 10 000 samples with 1 million markers. Although lrg pr is more flexible than other software, we ran the full rank linear mixed model reusing variance component estimates from the null model to make a fair comparison between methods. All programs were run with default parameters using the same genetic similarity matrix. The runtimes required to fit a linear mixed model on this dataset are shown for lrg pr and six widely used programs, in addition to plink, which fits a fixed effects linear model (). [Running GEMMA and fast lmm with the same grid search for estimating variance components as lrg pr uses increases the runtime (Supplementary).] The runtimes indicate that lrg pr despite its flexible and user friendly interface, is competitive with existing software.

discussion as most analysis of g was datasets have been performed under the 'one size fits all' paradigm, there is great potential for a custom exploratory reanalysis to examine novel aspects of existing datasets to further elucidate the molecular mechanisms of complex traits. moreover emphasizes that the optimal analysis depends on the population stratification, kinship, sample size, genetic architecture, disease prevalence and study design of each dataset. The lrg pr package allows an analyst to apply multiple variations of existing methods to customize an analysis based on the empirical properties of a specific dataset. This description of the lrg pr software is necessarily brief, and we provide a detailed tutorial illustrating the functionality of the software on the package's Web site analysis was run with default settings on an 8 core Intel V R Xeon V R E5-2687W @ 3.10 GHz with 64 Gb RAM using R 3.1.0 compiled with the Intel V R Math Kernel Library. Overhead for file conversion is not included.
