Motivation: High mass accuracy is an important goal in liquid chromatography mass spectrometry experiments. Some manufacturers employ a mass calibration system that regularly switches between the analyte and a standard reference compound, and leads to gaps in the analyte data. We present a method for correction of such gaps in global molecular profiling applications such as metabolomics. We demonstrate that it improves peak detection and quantification, successfully recovering the expected number of peaks and intensity distribution in an example metabolomics dataset. Availability and implementation: Available in x cms versions 1.23.3 and higher. Distributed via Bioconductor under GNU General Public License.

introduction liquid chromatography mass spectrometry (LCMS) has become a widely used methodology in metabolomics. Profiles generated by this method are highly complex and many software packages have been designed to analyse this data [e.g. mz mine x cms (. These typically employ a peak picking algorithm for selection of peaks and removal of noise. Peaks are then matched between samples, correcting small drifts in retention time (RT) and the final result is a table of the integrated intensities of each peak in each sample. An important goal in LCMS experiments is the accurate measurement of the mass to charge ratio (m/z). Usually, a mass calibration method is used throughout the experiment to keep the m/z deviation within the desired range. MS manufacturers employ different methods to calibrate their instruments. Some manufacturers use a switching method, which regularly changes the MS input between the analyte and a standard reference (). Switching the flow in this way can avoid the problem of ionization suppression encountered with continuous flow methods. However, changing the flow to the lock mass spray temporarily stops the analyte from being detected, resulting in gaps in the analyte data. These lock mass gaps can cause a single peak to be split into several smaller peaks (), confusing the process of peak matching. * To whom correspondence should be addressed. Even if the peak is detected correctly, the true intensity will be underestimated due to the gap. The situation is further exacerbated by RT drifts across samples, which will cause the position of the gap within the peak to shift. The peak detection, multiplicity and loss in intensity will thus vary depending on where the gap is in the peak. This variability can lead to both false positives and false negatives in peak detection, and inaccurate intensity estimation. While most vendor software is presumed to take account of such elements of MS design, this is not true of widely used and community supported open source software for LCMS data processing. We have developed a method that recovers the lost intensity by filling in the gap. The method greatly reduces errors in peak detection, matching and intensity estimation and is freely available as a built in function 'stitch', for the x cms package.
