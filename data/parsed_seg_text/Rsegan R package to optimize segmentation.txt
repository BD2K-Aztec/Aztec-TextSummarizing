The use of high density SNP arrays for investigating copy number alterations in clinical tumor samples, with intra tumor heterogeneity and varying degrees of normal cell contamination, imposes several problems for commonly used segmentation algorithms. This calls for flexibility when setting thresholds for calling gains and losses. In addition, sample normalization can induce artifacts in the copy number ratios for the non changed genomic elements in the tumor samples. Results: We present an open source R package, rs eg which allows the user to define sample specific thresholds to call gains and losses. It also allows the user to correct for normalization artifacts.

introduction affymetrix SNP arrays have been used to estimate genomic copy numbers in tumor samples (). Different methods have been developed to segment the genome into contiguous regions that share the same copy number on average. These include CBS, GLAD and more recently ultra some (). ultra some is the fastest method and gives similar output as CBS. However, ultra some does not allow to correct for artifacts induced by the normalization of the arrays. In fact, when there is an imbalance between gains and losses, commonly used normalization methods like quantile and invariant set normalization introduce a systematic shift in the copy numbers estimated for normal regions so that they appear as if they have an altered copy number. That is, if a sample contains only two different copy numbers, then normalization will make the regions with no change in copy number appear as being slightly lost or gained (cf patient A in). While this problem could potentially be overcome using a different normalization procedure, an alternative would be to use the intensities distribution to correct for it. Generally, segmentation algorithms apply a common threshold for calling gains and losses for all investigated samples. However, when applied to tumor samples this often imposes a problem, as several * To whom correspondence should be addressed. sample specific factors like the level of normal cell contamination, intra tumor heterogeneity, and technical noise affects the resolution with which different copy number levels can be discerned. This calls for an option to set sample specific thresholds. In this article, we describe an R package that guides the user through the segmentation of each sample. Histograms of the log ratio copy number between a tumor and its matched germline sample can distinguish between different copy numbers (represented by different peaks cf. Therefore, by modeling each peak and by selecting the peak representing segments with no copy number change and its neighbors, correction for the normalization induced copy number and optimal thresholds for calling gains and losses can be statistically defined.

description the rs eg package provides different tools to efficiently optimize the segmentation of copy number data produced using SNP arrays (cf supplementary for an overview). It takes as an input a copy number file (.cn), for example produced by aroma affymetrix (). This file contains for each probe and for each array the log ratio of the intensity between a tumor sample and a matched germline sample (or an average germline sample). First ultra some is applied to segment the data with parameter t = 0.001 (other algorithms can be used as well, e.g. CBS). Then, a multi-step protocol is applied to each sample: @BULLET The segmented data is plotted as a histogram of weighted segment values (the weight is the number of markers in the segment). @BULLET The user inputs the number of peaks and marks them manually. This step is difficult to automate due to often noisy nature of the data (cf patient B in bullet The program models each peak using a Laplace or a Gaussian distribution (, center section). @BULLET The user selects the peak representing the segments with no copy number change and the two peaks surrounding it. @BULLET The program uses a rigorous statistical procedure to define the shift (difference from the log ratio = 0 to the mean of the log ratios of the no change peak) and the thresholds for calling gains and losses (defined by minimizing the false negative and false positive call rate the last step produce the final segmentation taking into account shift and thresholds determined for each sample (, right section). The output file is a segmentation file (.seg) and can be. Optimization of genomic segmentation for two tumor samples using rs eg. Initially data were segmented using ultra some with minimal threshold for calling gains and losses. On the left are shown histograms of the initial segment copy numbers (in grey) for all chromosomes, in blue and red are overlain the segment copy number for chromosome 3 and 4, respectively. The histograms distinguish different copy numbers in the sample as different peaks. To understand the effect of choosing a non sample specific threshold for calling abnormalities, the uncorrected no change line and two different thresholds were plotted. In the middle part of the figure, the same histograms were plotted together with the shift of the no change peak (in red) and the sample specific thresholds (in green). Each peak was modeled as a Laplace distribution (in blue). The right part of the figure shows the raw data for chromosomes 3 and 4, and the final segmentation using ultra some (with two different thresholds: 0.15 and 0.07) and rs eg. visualized using the Integrative Genomics Viewer (IGV) software (http://www.broadinstitute.org/igv).
