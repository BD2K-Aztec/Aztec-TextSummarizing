Motivation: rnase q technique has been demonstrated as a revolutionary means for exploring transcriptome because it provides deep coverage and base pair level resolution. rnase q quantification is proven to be an efficient alternative to Microarray technique in gene expression study, and it is a critical component in rnase q differential expression analysis. Most existing rnase q quantification tools require the alignments of fragments to either a genome or a tran-scriptome, entailing a time consuming and intricate alignment step. To improve the performance of rnase q quantification, an alignment free method, Sailfish, has been recently proposed to quantify transcript abundances using all km ers in the transcriptome, demonstrating the feasibility of designing an efficient alignment free method for transcriptome quantification. Even though Sailfish is substantially faster than alternative alignment dependent methods such as Cufflinks, using all km ers in the transcriptome quantification impedes the scalability of the method. Results: We propose a novel rnase q quantification method, rnas kim which partitions the transcriptome into disjoint transcript clusters based on sequence similarity, and introduces the notion of sig mers which are a special type of km ers uniquely associated with each cluster. We demonstrate that the sig mer counts within a cluster are sufficient for estimating transcript abundances with accuracy comparable with any state of the art method. This enables rnas kim to perform transcript quantification on each cluster independently , reducing a complex optimization problem into smaller optimization tasks that can be run in parallel. As a result, rnas kim uses 54% of the km ers and 510% of the CPU time required by Sailfish. It is able to finish transcriptome quantification in 510 min per sample by using just a single thread on a commodity computer, which represents 4100 speed up over the state of the art alignment based methods, while delivering comparable or higher accuracy. Availability and implementation: The software is available at http:// www cs bio
introduction rnase q technique has been demonstrated as a revolutionary means for examining transcriptome because it provides incomparable deep coverage and base pair level resolution (). Though rnase q sequencing exhibits itself as an efficient alternative to Microarray techniques in gene expression study (), it also brings unprecedented challenges, including (but not limited to) how to rapidly and effectively process the massive data produced by the proliferation of rnase q high throughput sequencing, how to build statistical model for accurate quantification of transcript abundances for transcriptome, etc. Most of current rnase q tools for rnase q quantification contain two main steps: an alignment step and a quantification step. Various aligners top hat (), splice map (), map splice (are devised to infer the origin of each rnase q fragment in the genome. The alignment step is usually time consuming requiring substantial computational resources and demanding hours to align even one individual's rnase q data. Because there are multiple variations of rnase q sequencing techniques, e.g. single end sequencing and paired end sequencing, to facilitate the discussion in this article, we simply refer to the read or the pair of reads from a rnase q fragment as a fragment. More importantly, a significant percentage of the fragments can not be aligned without ambiguity, which yields a complicated problem in the quantification step: how to assign the ambiguous fragments to compatible transcripts and to accurately estimate the transcript abundances. To tackle the fragment multiple assignment problem, an expectation maximization (EM) algorithm () is often used to probabilistically resolve the ambiguity of fragment assignments: at each iteration, it assigns fragments to their compatible transcripts with a probability proportional to the transcript abundances, and then updates the transcript abundances to be the total weights contributed from the assigned fragments, until a convergence is reached. The EM algorithm's simplicity in its formulation and implementation makes it a popular choice in several rnase q quantification methods), Scripture (), r sem (), eXpress (. Because all fragments and all transcripts are quantified at the same time in the EM algorithm, it usually requires considerable running time. Some studies), mm seq (reduced the scale of the problem by collapsing reads if they can be aligned to the same set of transcripts. It is also worth mentioning that rnase q quantification is an important first step for differential analysis on the transcript abundances among different samples (). The alignment step is a vital step in the rnase q assembly study () and has become the computational bottleneck for rnase q quantification tasks. If users are only interested in rnase q quantification of an annotated transcriptome, aligning rnase q fragments to the genome seems cumbersome: not only do the rnase q aligners take a long time to align fragments to the genome by exhaustively searching all *To whom correspondence should be addressed.  The Author 2014. Published by Oxford University Press. This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (http://creativecommons.org/licenses/by-nc/3.0/), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals permission soup com possible splice junctions in the fragments, they may also generate misaligned results owing to repetitive regions in the genome or sequencing errors, introducing errors in the quantification results (). From another perspective, the annotation databases of transcriptome, e.g. RefSeq () and Ensembl (), play an increasingly important role in rnase q quantification. For example, top hat cufflinks supports a mode that allows users to specify the transcriptome by supplying an annotation database (a GTF file). r sem () uses bowtie ()a DNA sequence aligner to align fragments directly to the transcriptome. Aligning rnase q fragments to transcriptome avoids the computation to detect novel splice junctions in fragments and eliminates the non transcriptome regions in the genome from further examination, and thus reduces the total running time of the quantification method and the number of erroneous alignments in the results. To further improve the performance, the utility of km ers was recently proposed. The concept of km ers short and consecutive sequences containing k nucleic acids has been widely used in bioinformatics, including genome and transcriptome assembly (), error correction in sequence reads (), etc. Because the number of km ers in the genome or transcriptome is enormous when k is large (e.g. k ! 25), the need to store all km ers impedes their counting. Most of existing methods save memory usage during the computation by using sophisticated algorithms and advanced data structures [bloom filter (), lock free memory efficient hash table (), suffix array (or relying on disk space to compensate memory space (). Thanks to the recent advances in both annotated transcriptome and algorithms to rapidly count km ers the transcriptome based alignment free method, Sailfish (), requires 20 times less running time and generates comparable results with alignment dependent quantification methods. Sailfish is a lightweight method: it first builds a unique index of all km ers that appear at least once in the transcriptome, counts the occurrences of the km ers in the rnase q fragments and quantifies the transcripts by the number of occurrences of the km ers through an EM algorithm. Regardless of being alignment dependent or alignment free all methods need to recover the fragment depth the number of fragments that cover a specific location across the whole transcriptome as one of the initial steps. However, none of the existing methods exploit the strong redundancy of the fragment depth in rnase q data. More specifically shows a strong correlation between the fragment depth of any two locations that are a certain distance apart on the transcriptome, varying the distance from 1 to 100 bp. Even when the two locations are 20 bp away from each other, the Pearson correlation score is still as high as 0.985. In other words, if an rnase q quantification method that is able to recover the fragment depths for every 20 bp and quantify the abundance levels based on such information, there should be no significant accuracy loss in the result. Recently, uziel a and hon kela (2013) developed a method that simply counts the number of alignments that covers the locations of hybridization probes used in the gene expression studies. Though these probes only represent a sparse sampling on every transcript in the transcriptome, the method still provides reasonably accurate results. The observation and the method inspire us to ask the following question: what is the minimum information we need to achieve comparable accuracy in rnase q quantification to the state of the art methods? More specifically, does there exist a subset of km ers that can provide accurate transcriptome quantification? And if so, how do we identify and use them to quantify transcriptome efficiently? To answer these questions, we introduced a special type of km ers called sig mers which only appear in a (small) subset of transcripts in the transcriptome. Based on these sig mers we developed a method, rnas kim which is much faster than Sailfish and also maintains the same level of accuracy in the results. rnas kim includes two stages, preparation and quantification. In the preparation stage, rnas kim first partitions transcripts into clusters and uses bloom filters to discover all sig mers for each transcript cluster, from which a small yet informative subset of sig mers is selected to be used in the quantification stage. In the quantification stage, a rolling hash method () is developed to rapidly count the occurrences of the selected sig mers and an EM algorithm is used to properly estimate the transcript abundance levels using the sig mer counts. Because no sig mer is shared by two transcript clusters, the task can be easily divided into many small quantification problems, which significantly reduces the scale of each EM process and also makes it trivial to be parallelized. While rnas kim provides similar results to those of alternative methods, it only consumes 10% of the computational resources required by Sailfish. In this article, we first describe the rnas kim method, then discuss how we compared rnas kim with other methods, followed by the experimental results using both simulated and real data.
