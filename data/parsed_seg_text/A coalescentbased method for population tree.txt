Motivation: Population trees represent past population divergence histories. The inference of population trees can be useful for the study of population evolution. With the size of data increases in large scale population genetic projects, such as the 1000 Genomes Project, there are new computational challenges for ancestral population inference, including population tree inference. Existing methods for population tree inference are mainly designed for unlinked genetic variants (e.g. single nucleotide polymorphisms or SNPs). There is a potential loss of information by not considering the haplotypes. Results: In this article, we propose a new population tree inference method (called s tells H) based on coalescent likelihood. The likelihood is for haplotypes over multiple SNPs within a non recombining region, not unlinked variants. Unlike many existing ancestral inference methods, s tells H does not use Monte Carlo approaches when computing the likelihood. For efficient computation, the likelihood model is approximated but still retains much information about population divergence history. s tells H can find the maximum likelihood population tree based on the approximate likelihood. We show through simulation data and the 1000 Genomes Project data that s tells H gives reasonably accurate inference results. s tells H is reasonably efficient for data of current interest and can scale to handle whole genome data. Availability and implementation: The population tree inference method s tells H has been implemented as part of the s tells program

introduction the inference of population demographic histories from population genetic data has recently become an active research subject. There are many aspects of demographic history. In this article, we focus on the inference of the population divergence history (including the order of divergence and the divergence time) of multiple populations. The population divergence history can be modeled by a tree, called the population tree. The leaves of a population tree represent extant populations, while internal nodes represent ancestral populations. Accurate inference of population trees can greatly facilitate the study of population demographic histories. To see this, we consider for example, the program IMa2 (), which performs inference under the isolation with migration model (). If a user wants to use IMa2 to study multiple populations, then a population tree needs to be provided before the demographic histories of multiple populations can be studied. However, there are no hints being offered by IMa2 on how the population tree should be inferred. Another example is the tree mix program developed in Pickrell and Pritchard (2012). tree mix aims to infer population split and admixture history. The first step of tree mix is inferring the population tree, which provides the foundation for the admixture inference in the following steps. On a high level, population tree inference is related to species tree inference which has been studied extensively in phylogenetics. However, there are significant differences between these two inference problems. First, the time scale of a population tree is much shorter than that of a species tree in most cases. Second, the sequence mutation models used in population tree inference can be different from those used in species tree inference. For example, the infinite sites model of mutations () is often used in population genetics, but rarely in phylogenetics. Moreover, population studies usually involve more individuals than what are typically found in phylogenetics studies. So methods that infer species trees from sequences (e.g.) may not be directly applicable to population tree inference. In this article, we develop a maximum likelihood population tree inference approach (called s tells H ). s tells H works with haplotypes from multiple unlinked loci from multiple populations. The main feature of s tells H is its use of haplotypes rather than individual genetic variations as used in existing population tree inference methods, eg and Pickrell and Pritchard (2012). The central computational problem is computing the likelihood of population haplotypes under certain models (such as coalescent models). A major challenge is that coalescent likelihood functions are often complicated and exact computation on these models is usually difficult. At present, Monte Carlo methods such as Markov chain Monte Carlo and importance sampling are often used for coalescent likelihood computation. While these methods are certainly very useful in practice, many existing Monte Carlo methods suffer from long computational time for large datasets. Conversely, many existing methods for analyzing large genetic data often do not fully use the information contained in the data. For example, many approaches do not use haplotypes (e.g.). There is a potential loss of information by not considering the haplotypes. In this article, we take a different approach by approximating the coalescent likelihood of haplotypes to allow faster computation while still maintaining the appeal of coalescent models. A limitation of s tells H is that its likelihood computation is still computationally more demanding than methods (e.g. tree mix that do not use haplotypes. Therefore, the data size that can be handled by s tells H is smaller than methods such as tree mix. We will show that, even with less data, s tells H still performs well when compared with existing methods using larger amount of data in population tree inference. The following lists the features and assumptions of s tells H. 1. The input of s tells H is a set of haplotypes at each of K unlinked loci. At a single locus, haplotypes from each population cover multiple strongly linked single nucleotide polymorphism (SNP) sites; haplotypes at two different loci are assumed to be independent. 2. s tells H finds the maximum likelihood estimate of the population tree. We will focus on inferring the topology of the population tree, although s tells H also infers the branch lengths in coalescent units (i.e. scaled by 2N generations where N is the diploid effective population size). 3. The computed likelihood is based on coalescent theory, and is computed in a deterministic way. That is, this is not a Monte Carlo method. The likelihood function is approximated to allow faster computation. 4. We assume the infinite sites model of mutations. 5. We assume that intra locus recombination within the haplotypes can be ignored. Note that sometimes this assumption may not hold in practice. In this case, we adopt a simple preprocessing approach to allow s tells H to work for data with some low level of intra locus recombination. 6. Similar to, we do not explicitly address the effect of migration on population tree inference in this article. We also do not consider other demographic events such as population size changes. Instead of including these processes (e.g. migration) in our model, we will show that s tells H is reasonably robust even for data that deviates from these ideal conditions.
