Motivation: A metabolic graph represents the connectivity patterns of a metabolic system, and provides a powerful framework within which the organization of metabolic reactions can be analyzed and elucidated. A common practice is to prune (i.e. remove nodes and edges) the metabolic graph prior to any analysis in order to eliminate confounding signals from the representation. Currently, this pruning process is carried out in an ad hoc fashion, resulting in discrepancies and ambiguities across studies. Results: We propose a biochemically informative criterion, the strength of chemical linkage (SCL), for a systematic pruning of metabolic graphs. By analyzing the metabolic graph of Escherichia coli, we show that thresholding SCL is powerful in selecting the conventional pathways connectivity out of the raw network connectivity when the network is restricted to the reactions collected from these pathways. Further, we argue that the root of ambiguity in pruning metabolic graphs is in the continuity of the amount of chemical content that can be conserved in reaction transformation patterns. Finally, we demonstrate how biochemical pathways can be inferred efficiently if the search procedure is guided by SCL.

introduction graph representation of a metabolic network connectivity map provides a simple representation of certain relationships among the network's entities. Analyses of such graphs have provided various insights into the properties of metabolic networks, yet not without controversy. For example, the finding of a short average path length in metabolic networks [e.g.;] has been challenged in that it was based on the 'raw' metabolic graphs, without first pruning them (). To illustrate the concept of 'pruning', consider the following reaction analyzed in Ma and Zeng (2003): n acetyl ornithine l glutamate  l ornithine n acetyl l glutamate in their network assembly, the authors only linked n acetyl ornithine to l ornithine and l glutamate to n acetyl l glutamate and omitted * To whom correspondence should be addressed. the link between l glutamate and l ornithine and the link between n acetyl ornithine and n acetyl l glutamate. Depending on the edge semantics of the network and the subsequent analyses, this pruning step may or may not make a difference. From the perspective of causality of biochemical transformation and pathway inference (), this pruning makes sense: no chemical content is conserved between l ornithine and l glutamate and the acetyl group that is conserved between n acetyl ornithine and n acetyl l glutamate is not sufficiently representative for linking the two chemical compounds. However, if one is modeling the propagation of perturbation in the concentration of metabolites [e.g.], then not removing these last two edges makes sense, since they do capture how a perturbation to certain metabolites may spread throughout the metabolic system. Under this semantics, metabolic graphs are built by connecting all the metabolites that participate in a reaction (), and subsequently analyzed, without post-processing the connectivity (), to elucidate properties on information transfer, network robustness and resilience, etc. In this article, we focus on the first of the edge semantics, namely causality of biochemical transformation. To build metabolic graphs for pathway inference, all metabolites participating in a reaction are connected to form the raw graph, and then, via connectivity pruning, edges that may result in the inference of biochemically implausible pathways [are pruned hypergraph based pathway inference techniques, such as the network expansion (), require different treatment and are beyond the scope of this article]. Several methods exist for pruning metabolic graphs including hub deletion (), removal of currency metabolites (), manual curation () and r pair typing (). However, the ambiguity inherent in these ad hoc methods, and the lack of a systematic one, may confound analyses of metabolic graphs (). Here, we propose a simple criterion, the strength of chemical linkage (SCL), for systematic pruning of metabolic graphs. By analyzing the metabolic graph of Escherichia coli, we demonstrate the power of this criterion in yielding biochemically meaningful pathways. Further, we characterize the commonly used pruning heuristics in terms of the strength of chemical linkage, and discuss the ambiguity in these methods and the superiority of using the SCL criterion. Finally, we demonstrate the utility of the criterion in pruning the search tree used in pathway inference methods to gain in accuracy and efficiency compared with other graph based search heuristics eg length is the number of reactions from the source to the target compound in the reference pathway. 'Rank' is the place of the reference pathway as identified by Algorithm infer pathway
discussion in this article, we introduced the strength of chemical linkage, or SCL, as a criterion for pruning metabolic graphs. The use of the conserved chemical content according to the actual reaction mechanism in this work is in contrast to the previous approach where only structural similarity between the two reactants is considered (). Although we also use the r pair database, unlike (), whose pruning depends on the presence absence of r pairs or the certain classes of reactant pairs annotated from KEGG based on the type of enzyme that catalyze the reaction (), we used only the information for molecule alignments. Such information can also be obtained from other sources, such as. We showed that the SCL criterion is biochemically intuitive and has power of selection for the conventional pathway connectivity when thresholded. False positive and false negative cases are caused mainly by improper quantification of chemical content as well as flaws in the data. The utility of using SCL on pruning the searching tree in pathway inference was evaluated. Biochemically meaningful pathways can be found by implementing a simple search program using the SCL criterion. Further, we compared several commonly used connectivity pruning heuristics and ad hoc methods, such as hub deletion and manual curation. We found that SCL values reflect the rationale behind these heuristics, yet the SCL is more objective, systematic and robust to annotation error. Many ambiguities of these heuristics are rooted in lacking an objective criterion and quantification of chemical content. Note that although, we focus here only on graphs whose nodes are compounds, SCL can also be adapted in the assembly of networks whose nodes are reactions or reaction derived entities such as enzyme class or genes. This is done by considering nodes for linking reactions, only ones that appear in sufficiently strong reactant pairs. One potential improvement to the quantification of chemical content is to partition every chemical compound into functionally independent groups. The amount of chemical content is measured in terms of the number of such functionally independent groups, instead of the absolute number of non hydrogen atoms. Further, the partition of a compound into functionally independent groups is flexible yet objective, relying on at most a delineation of a set of specific pathway related reactions. Two atoms in a compound are considered in the same group if they are linked by covalent bond(s) that does not break in all the chemical transformations under that delineation.
