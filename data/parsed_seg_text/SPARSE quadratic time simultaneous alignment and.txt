Motivation: rnase q experiments have revealed a multitude of novel nc rnas. The gold standard for their analysis based on simultaneous alignment and folding suffers from extreme time complexity of Oðn 6 Þ. Subsequently, numerous faster sankoff style approaches have been suggested. Commonly, the performance of such methods relies on sequence based heuristics that restrict the search space to optimal or near optimal sequence alignments; however, the accuracy of sequence based methods breaks down for RNAs with sequence identities below 60%. Alignment approaches like loca rna that do not require sequence based heuristics, have been limited to high complexity (! quartic time). Results: Breaking this barrier, we introduce the novel sankoff style algorithm spars ified prediction and alignment of RNAs based on their structure ensembles (SPARSE), which runs in quadratic time without sequence based heuristics. To achieve this low complexity, on par with sequence alignment algorithms, SPARSE features strong spar sification based on structural properties of the RNA ensembles. Following pm comp SPARSE gains further speed up from lightweight energy computation. Although all existing lightweight sankoff style methods restrict sankoff s original model by disallowing loop deletions and insertions, SPARSE transfers the Sankoff algorithm to the lightweight energy model completely for the first time. Compared with loca rna SPARSE achieves similar alignment and better folding quality in significantly less time speed up 3.7). At similar run-time, it aligns low sequence identity instances substantially more accurate than RAF, which uses sequence based heuristics. Availability and implementation: SPARSE is freely available at

introduction the majority of transcripts are non-coding RNAs nc rnas which unlike mRNAs do not code for proteins. nc rnas are associated with a large range of important cellular functions; furthermore, there is increasing evidence of pervasive transcription (e.g.). Particularly, up to 450 000 nc rnas have been predicted in the human genome alone (). Analyzing the huge amount of RNA sequences poses major challenges for bioinformatics; particularly, since the sequence of related nc rnas is often conserved only weakly, while the RNAs can still share a strongly conserved consensus structure. Therefore, taking sequence and structure similarity into account is indispensable for ncRNA analysis (). However, accurate methods for this purpose have extreme computational costs. The gold standard for RNA alignment has been introduced by. Because structure prediction and alignment of RNAs depend on each other, sankoff s approach solves the alignment and folding problem simultaneously. For two RNA sequences, it finds two energetically favorable structures of the same shape together with a good alignment that reflects the similarity of the structures. For this purpose, Sankoff composes its objective function from a sequence alignment score and the free energies of the two structures. Because of the extreme On 6  time complexity of this algorithm, numerous sankoff like strategies have been developed aiming to speed up sankoff s task, while preserving accuracy as much as possible. A major class of such methods utilizes information from sequence based alignment to reduce the search space for the computationally much more expensive alignment and folding algorithm. This idea was introduced in, and later refined by do well and Eddy (2006) and. The latter restricts the alignment space to an envelope around the base matches, whose sequence alignment probabilities exceed a fixed cut off. Generally, such approaches have to cope with the well known fact that sequence alignment fails for sequence identities below 60% (). Consequently, sequence alignments can provide hints at the optimal structure based alignment, but are potentially far off. Moreover, even with such improvements sankoff like methods remain too expensive for large analysis tasks like clustering putative nc rnas in large datasets, e.g. the entire human transcriptome or even meta genomics data. pm comp () suggested a fundamentally different route to faster RNA alignment. It introduced a new sankoff like scoring model that enables lightweight computation. For this purpose, it employs a base pair based energy model instead of the original loop based energy model. Furthermore, pm comp simplifies sankoff s model by predicting only a single consensus structure. Tools like loca rna (), fold align m () and lo carnap () build on the pm comp model, but additionally spar sify the folding spaces of both RNAs, resulting in On 4  time complexity. CARNA () extends the pm comp model to pseudoknot structures. RAF () combined the ideas of, resulting in a lightweight sankoff variant with sequence based speed up.

discussion we presented a novel method for simultaneous alignment and folding of RNAs. The relevance of this method is 2-fold. First, we developed the first full featured lightweight variant of the Sankoff model. This fundamentally improves over the lightweight model of pm comp. Because this model drastically lowered the computational burden of simultaneous alignment and folding, it has been adopted by many successful RNA alignment approaches. However, all of these methods lack the full flexibility of the Sankoff model; for the first time, SPARSE combines this flexibility with lightweight computation. Second, we present a novel method to speed up sankoff style alignment that is purely based on the structure ensemble of RNAs; in particular, it does not have to resort to sequence based heuristics, which could compromise the alignment quality. We showed that by spar sification based on ensemble probabilities of unpaired bases and base pairs in specific loops, simultaneous alignment and folding requires only quadratic time. Performing br ali base 2.1 benchmarks, we demonstrated that, also in practice, the method provides a profound speed up. At similar speed as one of the fastest known simultaneous alignment and folding tools RAF, SPARSE maintains high alignment and folding quality for the 'twilight' zone of RNAs with low sequence identity, which are particularly hard to align. Finally, these benchmarks (and concrete examples, see Appendix) suggest that the added expressivity of the novel lightweight model improves the folding accuracy.
