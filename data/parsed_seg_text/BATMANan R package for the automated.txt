Motivation: Nuclear Magnetic Resonance (NMR) spectra are widely used in metabolomics to obtain metabolite profiles in complex biological mixtures. Common methods used to assign and estimate concentrations of metabolites involve either an expert manual peak fitting or extra pre-processing steps, such as peak alignment and binning. Peak fitting is very time consuming and is subject to human error. Conversely, alignment and binning can introduce artefacts and limit immediate biological interpretation of models. Results: We present the Bayesian automated metabolite analyser for NMR spectra (BATMAN), an R package that de convolute s peaks from one dimensional NMR spectra, automatically assigns them to specific metabolites from a target list and obtains concentration estimates. The Bayesian model incorporates information on characteristic peak patterns of metabolites and is able to account for shifts in the position of peaks commonly seen in NMR spectra of biological samples. It applies a Markov chain Monte Carlo algorithm to sample from a joint posterior distribution of the model parameters and obtains concentration estimates with reduced error compared with conventional numerical integration and comparable to manual deconvolution by experienced spectrosc op ists. Availability and implementation

introduction nuclear Magnetic Resonance (NMR) spectroscopy is widely used in metabolomics to provide information on metabolite profiles of complex biological mixtures, such as bio fluids or tissue samples. These spectra commonly contain around a thousand peaks from possibly hundreds of metabolites. The concentrations of metabolites are useful in biomarker discovery, investigating the aetiology of disease and in understanding fundamental biological processes. Quantitative measurement of metabolite abundances from NMR spectra is complicated due to shifting peak positions, peak overlap, noise and effects of the biological matrix.
