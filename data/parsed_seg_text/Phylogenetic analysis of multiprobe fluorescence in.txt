Motivation: Development and progression of solid tumors can be attributed to a process of mutations, which typically includes changes in the number of copies of genes or genomic regions. Although comparisons of cells within single tumors show extensive heterogeneity, recurring features of their evolutionary process may be discerned by comparing multiple regions or cells of a tumor. A useful source of data for studying likely progression of individual tumors is fluorescence in situ hybridization (FISH), which allows one to count copy numbers of several genes in hundreds of single cells. Novel algorithms for interpreting such data phylogenetically are needed, however, to reconstruct likely evolutionary trajectories from states of single cells and facilitate analysis of tumor evolution. Results: In this article, we develop phylogenetic methods to infer likely models of tumor progression using FISH copy number data and apply them to a study of FISH data from two cancer types. Statistical analyses of topological characteristics of the tree based model provide insights into likely tumor progression pathways consistent with the prior literature. Furthermore, tree statistics from the resulting phyloge-nies can be used as features for prediction methods. This results in improved accuracy, relative to unstructured gene copy number data, at predicting tumor state and future metastasis. Availability: Source code for software that does FISH tree building fish trees and the data on cervical and breast cancer examined here

introduction recent studies of genetic variation in solid tumors have revealed massive intra tumor heterogeneity in the spectrum of genomic changes within single tumors (). These observations suggest the importance of understanding cell to cell variability, but profiling large numbers of single cells and building coherent models of their evolution remain challenging problems. fluores ence in situ hybridization (FISH) is a technique that can be used to count the copy number of DNA probes for specific genes or chromosomal regions that has proven useful in studying cancer. Gene gains and losses are common in solid tumors, and FISH provides a practical and reliable method for monitoring such changes in large numbers of individual cells from single tumors (). FISH is even more useful when one uses multiple colors to monitor multiple genes simultaneously (). In this article, we developed new methods to model and analyze the progression of copy number changes, as measured by multi-color FISH. Our methods include analysis of multiple samples from the same patient, typically from different cancer stages. We applied the new methods to published data on cervical cancer with four gene probes () and breast cancer with eight gene probes (). The data for each sample are presented as a matrix, where each column is one of the probes and each row is a 'cell count pattern' of four probe counts, such as 2,3,4,1 (or eight counts for breast cancer), and the number of cells matching that pattern. A normal cell has the count pattern of all 2's. Both datasets include paired samples from an earlier stage and a later stage in the same patient. It is of interest to study cervical and breast cancer, as we do, because the number of cases of cervical cancer and breast cancer diagnosed early has increased owing to Pap smears and mammograms, respectively. Early diagnosis is important because lymph node metastasis is one of the best predictors of poor outcome (). Paradoxically, it has been shown statistically that early diagnosis of breast cancer has not led to a substantial decrease in deaths because most of the cancers diagnosed early would not progress to be life threatening if left untreated (). These are large scale studies that do not address the benefits of early detection in individual cases. Therefore, a consistent explanation of these findings is that earlier detection could be of clinical value if there were a better understanding of tumor evolution to help identify the early stage cancers likely to progress to dangerous forms. The problem of modeling tumor progression has been studied by a variety of techniques and using different kinds of tumor data (). Several of these methods used techniques from the area of phylogenetics (reviewed by) because of the insight that tumor genomes *To whom correspondence should be addressed.  The Author 2013. Published by Oxford University Press. This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (http://creativecommons.org/licenses/ by-nc/3.0/), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals permission soup com evolve (). Most prior studies have used either comparative genome hybridization or sequencing of cell populations, which have the advantage that one can do genome wide analysis, but the disadvantage that the input data are explicitly or implicitly averaged over many cells of the same tumor. Other data types can offer distinct advantages, such as the microsatellite data used by, which can allow some inference of useful population genetic parameters generally difficult to assess with tumor data. FISH is the only currently available reliable technique that allows measurements on enough individual cells to model the evolution of substantial intra tumor heterogeneity. The disadvantage of FISH is that it uses only a small number of preselected markers. Only two of the previous studies analyzed FISH data (). These studies were limited either to two probes () or to three probes and coarsely distinguishing only loss (copy number 52), neutral (copy number 2) and gain (copy number 42) (). We address a need for new methods capable of handling the larger numbers of cells and probes in recent FISH datasets. More specifically, we aim to develop a theoretical foundation for efficient handling of large copy number datasets. Toward this goal, we develop theory and algorithms for a model of tumor progression driven by gains and losses associated with FISH probes. Our methods handle in principle any number of probes and any range of copy numbers 0 through max copy (default 9). The use of max copy limits the combinatorial search and hence running time of our methods on inputs where the measured copy numbers exceed this limit. The work is intended to establish a framework capable of giving useful tree inferences on state of the art FISH data, which might be extended in future work to handle even harder problem instances and more realistic models of tumor evolution. Our contributions include the following 1 Reducing a model of the problem of modeling progression of FISH probe cell count patterns to the Rectilinear Steiner Minimum Tree rs mt problem and thus bringing prior theory on the rs mt problem to bear on the FISH phylogeny problem 2 Design and implementation of an exponential time exact method and a polynomial time heuristic method to construct trees modeling the progression of cell count patterns 3 Mathematical proof and software implementation of a new inequality that speeds up the rs mt based computation 4 Definition and evaluation of new test statistics based on the trees computed by our methods. These test statistics give novel insight into the selective pressures in tumor progression, compared with test statistics derived from the cell count patterns alone 5 Definition and evaluation of 'features' based on the tree structures that can be used with machine learning to classify the tumors. For example, we show improved effectiveness at distinguishing the cervical tumors that metastasize from those that do not.
