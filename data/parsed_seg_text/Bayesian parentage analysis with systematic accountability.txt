Motivation: The goal of any parentage analysis is to identify as many parent offspring relationships as possible, while minimizing incorrect assignments. Existing methods can achieve these ends, but they require additional information in the form of demographic data, thousands of markers and or estimates of genotyping error rates. For many non model systems, it is simply not practical, cost effective or logistically feasible to obtain this information. Here, we develop a Bayesian parentage method that only requires the sampled genotypes to account for genotyping error, missing data and false matches. Results: Extensive testing with microsatellite and SNP datasets reveals that our Bayesian parentage method reliably controls for the number of false assignments, irrespective of the genotyping error rate. When the number of loci is limiting, our approach maximizes the number of correct assignments by accounting for the frequencies of shared alleles. Comparisons with exclusion and likelihood based methods on an empirical salmon dataset revealed that our Bayesian method had the highest ratio of correct to incorrect assignments. Availability: Our program SOLOMON is available as an R package from the CRAN website. SOLOMON comes with a fully functional graphical user interface, requiring no user knowledge about the R programming environment. In addition to performing Bayesian parent-age analysis, SOLOMON includes Mendelian exclusion and a priori power analysis modules. Further information and user support can be found at https://sites.google.com/site/parentagemethods/.

introduction accurate parentage assignment and pedigree reconstruction are required to make correct inferences for a broad array of study questions (). Parentage methods span a vast gamut of theoretical approaches from fractional to categorical allocation and simple exclusion to sophisticated likelihood based approaches (). One area of parentage analysis that has been largely overlooked is a general Bayesian method for categorical allocation. This void is unfortunate, as additional sampling or field information can be elegantly incorporated as priors into a Bayesian framework (). Furthermore, the information present within the genotypic data itself can be used to calculate a prior analogous to a false discovery rate, which can be useful for the challenges associated with parentage analysis. As an illustrative example, consider a typical kinship dataset consisting of seven microsatellite loci and 750 individuals (). In this dataset, a parent and an offspring would share at least one allele across all loci following Mendelian inheritance. However, the probability of two unrelated individuals sharing alleles by chance at all loci is not trivial considering that hundreds of thousands of pairwise comparisons are required. Thus, a primary challenge of parentage analysis in natural populations is to correctly identify the true parent offspring pairs within a dataset, while simultaneously excluding any pairs that share alleles by chance. The challenge of parentage analysis is further exacerbated by missing data and genotyping errors, which can erode the parent offspring 'signal' of sharing at least one allele at all loci (). Because errors can create an incorrect record of genotypes, true parent offspring pairs in an empirical dataset may not share an allele at all loci despite that being the Mendelian expectation. Here, we address the challenges associated with parentage analysis by first calculating the prior probability of a dyad sharing an allele across all numbers of mismatching loci. The calculation of this prior (analogous to a false discovery rate) creates a systematic framework for determining how many loci to let mismatch and does not require any estimates of genotyping error. For each putative pair, we next use Bayes' theorem to calculate the posterior probability of a parent offspring pair being false given the frequencies of shared alleles. Because the probability of sharing common rather than rare alleles is much greater for unrelated pairs, we can compare the frequencies of observed shared alleles to a distribution of alleles shared by unrelated individuals. By combining this information with Bayes' theorem, we can maximize the identification of true parents and offspring in a dataset, while minimizing the number of false assignments. Here, we overhaul the approach of Christie (2010) to (i) account for genotyping error and missing data, (ii) reduce the computational time by up to three orders of magnitude as measured in minutes and (iii) allow for one known parent or for known parent pairs (i.e. known matings), which can substantially increase assignment power. We extensively test this methodology with data drawn from three empirical studies and use an empirical salmon dataset to make comparisons with commonly implemented exclusion and likelihood based methods. *To whom correspondence should be addressed.  The Author 2013. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals permission soup com
discussion accurate parentage assignments are necessary to appropriately address a wide range of research questions (). Here, we provide a Bayesian method that can account for genotyping error, missing data and false matches without requiring estimates of any non genetic parameters (i.e. all analyses simply use the provided genotypic data). These methods can be applied to a broad array of datasets ranging from samples of large wild populations with unknown numbers of sampled parents to carefully controlled crosses with detailed pedigree records. To our knowledge, this is the first parentage program that does not require direct estimates of genotyping error. This solution represents a significant advance because choosing the appropriate method for estimating genotyping error rates can be ambiguous and is further obfuscated by the different types of genotyping errors that can occur (). Furthermore, the estimation of error rates typically involves the genotyping of additional (or duplicate) samples, which is costly from both a time and monetary standpoint. Because this method was designed with a null hypothesis of no relationship, it may not be ideally suited for datasets with large numbers of related individuals (e.g. full sibs. Future improvements could include specifying different null hypotheses of relationship and evaluating them in a likelihood based framework. Our analyses revealed that, for a given dataset, the Bayesian approach appropriately minimizes false assignments while maximizing the number of correct assignments. The number of true parent offspring relationships correctly identified depends on the sample sizes, the number of loci, the allele frequencies and the genotyping error rate. For a given marker set, larger sample sizes rapidly increase the number of pairs that share alleles by chance (), and increases in genotyping error can diminish power (). Furthermore, the number and frequency distribution of alleles at each locus contribute to the rate of false matching. Uniform allele frequencies result in the greatest power for parentage analysis, but they are rarely observed in genetic markers. On the other hand, SNPs with a minor allele frequency 51% will contribute little information to the elucidation of parent offspring pairs. Given the multitude of factors that contribute to false matching and reduced power, we suggest that researchers conduct a priori power analyses before designing a study that involves parentage analysis. Such power analyses can dictate precisely how many loci would be required for given sample sizes. We provide a module for a priori power analysis as part of our program SOLOMON, which is available as a freely distributable R package (R Development Core) from the CRAN website: http://cran.r-project.org/web/packages/. SOLOMON is run with a graphical user interface written with the TCL/TK package provided by R. SOLOMON performs the described Bayesian parentage analysis for datasets with no known parents, one known parent or known parent pairs. Using an Intel core i7 TM processor with 8 GB of random access memory, the average run-time was 11 min for the beech datasets, 8 min for the steelhead dataset and 13 min for the retriever dataset (with larger sample sizes resulting in increased run times). Furthermore, the program performs exclusion for the three types of parentage analysis, and the exclusion interfaces allow for user defined numbers of loci to mismatch. In summary, the Bayesian approach implemented in SOLOMON can be applied to a wide variety of datasets, resulting in robust parentage assignment.
