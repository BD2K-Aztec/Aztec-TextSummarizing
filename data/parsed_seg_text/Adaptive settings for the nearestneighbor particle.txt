Background: The performance of the single particle tracking (SPT) nearest neighbor algorithm is determined by parameters that need to be set according to the characteristics of the time series under study. Inhomogeneous systems, where these characteristics fluctuate spatially, are poorly tracked when parameters are set globally. Results: We present a novel SPT approach that adapts the well known nearest neighbor tracking algorithm to the local density of particles to overcome the problems of inhomogeneity. Conclusions: We demonstrate the performance improvement provided by the proposed method using numerical simulations and experimental data and compare its performance with state of the art SPT algorithms.

introduction single particle tracking (SPT) has become an essential tool to characterize movement in live cell imaging experiments (). Typical applications span the dynamics of single molecules within the cell membrane (), cell migration () and intracellular trafficking (). SPT methods extract the individual trajectories of objects registered in time-lapse images and provide information about both their individual and collective behavior. Although several studies track objects manually, the big leap for exploiting this technique has been brought by automatic multiple tracking algorithms, because they can process large number of objects simultaneously (). The vast majority of the implementations separate particle detection, i.e. the identification and location of particles in each image of the time series, from tracking. The latter assigns particle positions that result from detection, to individual trajectories. The simplest tracking approach, often named nearest neighbors, is based on minimizing the distance travelled globally by all particles. That is, object locations that are close enough in space and time are assigned to the same trajectory. However, the sole criterion of proximity is not enough under challenging experimental conditions. Tracking densely packed objects, and particles that merge, split or blink, requires additional information to uncover the real underlying tracks. In recent years, several methods have been proposed to address several of these shortcomings, which have been reviewed in detail (). Typically, these methods employ sophisticated image processing and statistical tools, as well as a priori knowledge about the systems, to overcome clutter, noisy detection and eventual particle disappearance. The downside of methods that assume specific dynamical models is that they can bias the tracking results if they are used early on systems where the dynamics is still unknown (Supplementary Note S5). In such cases a more secure procedure is to start the analysis with a conceptually simple tracking approach, such as the nearest neighbor algorithm. Regardless of how complex the method, its performance relies invariably on tuning accurately a set of parameters, which depend on the experimental details of the system (). If the features of the system fluctuate spatially it is unlikely that a unique set of parameters are optimal across the entire image. Systems such as, neutrophil migration assays, intracellular trafficking of vesicles, particles diffusing in media with heterogeneous viscosity, and tracking of receptors unevenly distributed on the cell membrane are examples where this problem is particularly important (). Typically, this is partially addressed by limiting the analysis to small regions of interest, where conditions are approximately homogeneous. However, if trajectories are long, this workaround cuts tracks and biases the description of the system's dynamics. In this work, we propose a new SPT method for inhomogeneous systems that adapts automatically to the local density of particles, based on the popular nearest neighbor tracking algorithm. One of the most cited and used nearest neighbor algorithms was proposed by Crocker and Grier (CG) 1996), and has a simple code and free open source implementations in IDL, Matlab, Phyton and image j (). Despite its simplicity, a method based on this algorithm () has shown to render a good performance in a recent study that makes a widespread and quantitative comparison of SPT techniques (). nearest neighbor algorithms minimize the global displacement of the particles, and thus need to consider all possible combinations of particle positions from one frame to the following, which can be computationally too expensive. Therefore, it is necessary to introduce a parameter called maximum displacement (mD), which represents the largest distance that a particle can move from one frame to the next one, to discard unlikely bonds and reduce the computation time. If this parameter is not carefully adjusted according to particles' speed and their density, either the trajectories are interrupted or the computation time is prohibitive. Therefore, in systems where particle density is inhomogeneous, there is no global value of mD that can be optimal everywhere. The method we propose is especially well suited for this kind of problem. We perform a systematic analysis of the problem, based on numerical simulations, as well as a thorough comparison of the proposed method with the standard nearest neighbor algorithm. We finally demonstrate the advantage of applying the adaptive method to the classic under agarose neutrophils migration assay ().

conclusion the field of particle tracking has evolved significantly during the last two decades, allowing to perform in very challenging conditions such as dense systems, blinking particles and low quality images. Several methods assume dynamic models of particle movement to face some of these challenges, but these assumptions may in certain cases bias results if the behavior of the system is not fully characterized a priori. In this work, we propose a novel approach for optimizing the performance of the popular nearest neighbor SPT algorithm by CG in systems with inhomogeneous particle density. This method adapts the parameter mD to the local density of the particles both in space and time, boosting the tracking performance dramatically. Furthermore, even in systems that are not manifestly inhomogeneous, the standard nearest neighbor algorithm is unstable due to slight variations of density that make the computation time to increase abruptly. Our improvement prevents these situations, providing the robustness needed for high content studies. Finally, this approach can be applied to more complex methods () and potentially other algorithms that depend on a parameter equivalent to mD (). We demonstrate quantitatively the advantages of the adaptive method by comparing it with the standard CG algorithm and other state of the art methods using numerical simulations and experimental data.
