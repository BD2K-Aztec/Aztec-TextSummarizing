Motivation: meta genomes are often characterized by high levels of unknown sequences. Reads derived from known microorganisms can easily be identified and analyzed using fast homology search algorithms and a suitable reference database, but the unknown sequences are often ignored in further analyses, biasing conclusions. Nevertheless, it is possible to use more data in a comparative meta genomic analysis by creating a cross assembly of all reads, i.e. a single assembly of reads from different samples. Comparative meta genomics studies the interrelationships between meta genomes from different samples. Using an assembly algorithm is a fast and intuitive way to link (partially) homologous reads without requiring a database of reference sequences. Results: Here, we introduce crAss, a novel bioinformatic tool that enables fast simple analysis of cross assembly files, yielding distances between all meta genomic sample pairs and an insightful image displaying the similarities. Availability and implementation: crAss is available as a web server at http://edwards.sdsu.edu/crass/, and the Perl source code can be downloaded to run as a stand-alone command line tool.

introduction the sequencing of environmental samples has disclosed a universe of novel microbial organisms. Microbiologists and virologists are sequencing DNA and RNA from environments ranging from coral reefs to the human gut and are discovering previously unknown microorganisms in all these samples (). The fraction of unknown sequences can be particularly high in viral meta genomes because (i) viruses exhibit relatively high mutation rates resulting in distant unrecognizable homology (), and (ii) this superkingdom has remained poorly explored, with relatively few sequences present in the databases. These properties hinder the comparison of meta genomic samples with high percentages (up to 6099%) of unknowns () by traditional methods that map sequencing reads to known annotated references (). In addition, the abundance and diversity of viruses in natural systems impede comparisons between meta genomic datasets, especially when comparing relatively short reads generated by some second generation sequencing platforms. A promising solution is to initially combine the different meta genomes and perform a de novo assembly of all sequence reads. If applied conservatively to avoid chime rization meta genome assembly can reliably link reads that are completely unknown to reads that have similarity to annotated sequences. The tool PHAge Communities from Contig Spectra ph accs assesses the biodiversity of uncultured viral communities by mathematically modeling the community structure using the contig spectrum of meta genome assemblies (). PHAge Communities from Contig Spectra was extended to assess cross assemblies in a tool called Maxi' (). Because they do not rely on a database with reference sequences, these tools provide an approach for comparing complete meta genomes even if they contain a high fraction of unknown sequences. Here, we present crAss, a novel more direct approach based on the same concept, i.e. using cross assembly of reads from different meta genomes to assess the degree of similarity between the sampled communities. Thus, cross meta genome assembly enables a sensitive comparison of entities that are shared between samples, including viruses with no homology to known sequences. Unlike previous methods, crAss calculates a pairwise distance score between meta genomes and creates an insightful image to display these distances graphically. Moreover, a cross assembly combines short sequencing reads into longer contigs that may be more suitable for annotation. For example, downstream analyses could include sensitive homology searches (), RNA structure detection () and prediction of alternative genetic codes (). *To whom correspondence should be addressed.  The Author(s) 2012. Published by Oxford University Press. This is an Open Access article distributed under the terms of the Creative Commons Attribution License (http://creativecommons.org/licenses/by/3.0), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.

discussion determining the interrelationships between meta genomes from different biomes or different time points is important to understand the microbial world around us. Mapping meta genomic sequences to a reference database of known genes is a feasible approach to transfer taxonomical and functional annotations to sequence reads. However, it can limit the amount of data that can be analyzed because the majority of the sequencing reads in difficult to annotate datasets, such as viral meta genomes from biomes other than the human microbio me lack known homologs (). A promising alternative is reference independent comparative meta genomics. We present crAss, an intuitive approach for comparative meta genomics that calculates a similarity signal using shared entities, which are identified by cross assembly. The tool does. In cladograms of nine simulated meta genomes those containing Actinobacteria (n  3) mostly form a separate cluster from those containing Firmicutes (n  6; Supplementary). The length of the separating internal branch is plotted with increasing Proteobacteria contamination, until the Actinobacteria and Firmicutes meta genomes no longer form separate clusters, and there is no internal branch. See text for details. The cladograms created by crAss are available in supplementary 3229 comparative meta genomics using cross assembly crAss not depend on homology of the sequenced reads to any known sequence in a reference database, or even on full length homology of the reads to one another. Assembly algorithms, such as those used to create the ACE files required for crAss analysis, identify shared subsequences (long or signature km ers between reads to assemble them (). Because it relies on a different similarity signal, this long km er approach is complementary to the use of short km er profiles (). We expect that Equations (1) and 2 can be applied for qualitative comparisons between environments because they only take the degree of shared entities cross contigs into account. Conversely, Equations (3) and (4) will be more suited for quantitative comparisons because they consider the read counts as a measure of abundance. Although limited in scope, our current results based on analyses of simulated meta genomic samples suggest that the distance formula wo otters may outperform the other formulas for detecting both qualitative and quantitative signals, with similar performance as the comparisons based on dinucleotide odds ratios (). Nevertheless, it is difficult to predict which of the distance formulas presented in this article will be the most suitable for which biological application. That is why we have created a user forum at seq answers (), available through the crAss web site, where we hope that users will share their experiences and any publications that use crAss. An additional advantage of using cross assembly is that the sequences of biological entities, which are shared between specific samples, are simultaneously assembled. Based on the results obtained using simulated data (Supplementary File 2), we expect that fragment assemblers developed for ESTs, such as MIRA, or specialized meta genome assemblers will be more suitable for cross meta genome assembly than assemblers like new bler which are optimized for single genome assembly. If the parameters of the assembly program are set to strict values to avoid chime rization tentative taxonomic annotations may be transferred between reads that are linked within one contig. We recommend using parameter settings that the user is comfortable with for meta genomic assembly, but it should be noted that the resulting crAss cladogram is based on a similarity score between entire meta genomes which limits the effect of possibly rare chimerical sequences. Moreover, chime rization may be problematic between closely related species, but less severe for more distant organisms. Thus, although they will add some noise to the similarity signal, chimeras are more likely to link reads from biomes that are already similar, alleviating errors in the final cladogram. To address the issue of potential chime rization we recommend creating separate cross assemblies and crAss cladograms with stringent and permissive assembly parameters, which will lead to fewer and more chimerical contigs, respectively. The resulting cladograms can then be compared to evaluate the effect of chime rization on the cross assembly analysis. In general, we have seen that the cladogram rarely changes with altered assembly parameters, indicating that crAss is a robust approach for comparative meta genomics antar cti c lake summe r H u m a n n a s a l F 1 H u m a n fe c a l N 4 Huma n fecal N2 H u m a n fe c a l N 5Hum an fecal N3 H u m a n fe c a l N 1 H u m a n n a s a l F 2Hum an nasa l F3. Cladogram representing the distance between meta genomes based on the fraction of cross assembled contigs between all sample pairs. crAss creates this cladogram from a distance matrix using bio nj () and visualizes it using draw tree (). This cladogram was based on Equation (1). The complete output for this dataset, including distance matrices and cladograms based on the other distance formulas, can be retrieved
