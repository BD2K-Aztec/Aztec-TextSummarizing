Motivation: A high quality assembly of reads generated from shotgun sequencing is a substantial step in meta genome projects. Although traditional assemblers have been employed in initial analysis of meta genomes they can not surmount the challenges created by the features of meta genomic data. Result: We present a de novo assembly approach and its implementation named MAP meta genomic assembly program). Based on an improved overlap layout consensus (OLC) strategy incorporated with several special algorithms, MAP uses the mate pair information, resulting in being more applicable to shotgun DNA reads (recommended as 200 bp) currently widely used in meta genome projects. Results of extensive tests on simulated data show that MAP can be superior to both Celera and ph rap for typical longer reads by Sanger sequencing, as well as has an evident advantage over Celera, new bler and the newest ge novo for typical shorter reads by 454 sequencing. Availability and implementation: The source code of MAP is distributed as open source under the GNU GPL license, the MAP program and all simulated datasets can be freely available at

introduction processing of shotgun meta genomic sequence data usually does not have a fixed end point to recover one or more complete genomes as for isolated microbial genomes, sometimes with the exception of finish able dominant populations (). Nevertheless, with the proliferation of meta genomic projects, the assembly tools, which aim to combine sequence reads into contiguous stretches of DNA called contigs, are still expected to play an important role in sequence processing, due to more valuable genomic content they can provide (). Recently, the comparative assembly approach such as AMOS comparative assembler, which uses a reference genome or closely related species to align reads, * To whom correspondence should be addressed. was applied to facilitate assembly of short reads (). However, because of the potential bias caused by phylogenetic complexity and diversity, the de novo assembly methods are still regarded as irreplaceable tools for accurately assembling the novel genomic sequences that broadly exist in the meta genomic sequencing data (). As the high throughput sequencing technologies by the next generation sequencing platforms such as Illumina (http://www. illumina com SOLiD (http://www.appliedbiosystems.com) and h elicos (http://www.helicosbio.com) are available in meta genomic projects, many efforts have been devoted to develop assembly tools such as s sake (), Velvet () and euler sr euler usr (). However, these methods are not targeting the meta genome sequencing. Moreover, compared with Sanger and 454 sequencing, the current limitation of shorter reads (200 bp, typically 25100 bp) and higher errors by the new sequencing platforms does not allow a significant utility for meta genomic analyses for the difficulty in phylogenetic study or gene function inference (). In fact, shorter reads technologies have not been widely used in meta genome sequencing, and meanwhile the sequencing technologies producing longer reads, such as Sanger (usually 7001000 bp) and 454 sequencing (usually 200500 bp), are still the overwhelming recommendation and thus remain the major source of meta genomic sequence data (). Therefore, it is never trivial to continue to emphasize the importance of longer reads to meta genomic analyses, clearly including the reads assembly tool designed specifically. To date, for such longer shotgun reads in many meta genome projects, the assembly still relies largely on the existing tools demonstrating high performance to manage for single genome, such as ph rap (http://www.phrap.org), Celera Assembler () and PCAP (). However, the assembly of a community of genomes is different from the assembly of a single genome. In the assembly of single genomes, the fundamental problem is the presence of repeated DNA fragments in the target sequence that often leads to assembly errors. However, meta genomic assembly has its particular difficulties due to two challenges (): the genomic repeats may originate from either the same genome or the different genomes, and the inhomogeneous coverage distribution and the low abundance of organisms provide limited information to handle repeats. Unfortunately, the design for the task of single genome assembly prevents the traditional de novo assembly software

discussion compared with other assemblers, several distinct features of MAP algorithm should be pointed out. First, MAP does not refer to any other information such as genome length or sequencing coverage that is often used in the assemblers targeting the isolated genomes, because such information is clearly not applicable to the situation of meta genomic assembly. What is more important is that MAP employs mate paired information different from other assemblers did. For example, the Celera Assembler () used mate paired information in the scaffold constructing. The Celera Assembler later developed a new pipeline cabo g which finds the best overlap graph in the uni tigger module (). In this algorithm, mate pairs are used to correct the mis assemblies by breaking the unit igs that are found violated with the mate pair constrains. PCAP () used mate paired information to correct contigs and to link contigs into scaffolds. Different from these assemblers, MAP uses mate pairs as a core measure to construct contigs when repeats hamper the assembly. Based on mate paired information, MAP designs a series of procedures to implement the layout stage. With respect to the OLC strategy, MAP uses the strategy similar to Celera. Thus in many cases, MAP generates contigs in similar size as Celera does. However, the former uses mate pair information to prevent error contigs from being formed, whereas the latter uses the information to correct and break wrong contigs. These two strategies are quite distinct, but both can avoid errors and in some cases have the similar results. However, the MAP strategy is more reasonable to avoid error when compared with Celera. For example, lacking sufficient mate pair information, Celera was not able to detect the potential errors, which generated through other operation (such as best overlap graph strategy in cabo g by its method, whereas MAP will sacrifice the size but avoid potential errors by leaving alone the conservative unit igs. In addition, MAP does not include the scaffold er module as Bambus 2 does. Bambus 2 uses the scaffold graph to report the regions of variation in closely related strains and to distinguish between them. The analysis of the strain variation among meta genomes could be carried out by a stand-alone software such as Strainer (). We have demonstrated that our strategy can achieve higher assembly accuracy in terms of both reads and nucleotide sites, while maintaining high assembly capacity. However, the application of MAP algorithm is sensitive to several factors such as the mate pair length and sequence coverage, which are the state of the art challenges in meta genomic assembly. As the MAP algorithm finds mate pair paths in the overlap graph, too long length of the mate pairs may lead to too many nodes traversed between them and complicating the process of finding mate pair paths. In addition, low sequence coverage may greatly reduce the number of overlaps, making the overlap graph being sparse. Thus, a deeper sequencing may increase the efficiency of MAP, especially in the short read data. It should be noted that without mate pair information, MAP assembles the reads into unit igs functioning similar to the assembler Minimus (). It is noted that unlike the meta genome projects sequencing on Sanger platform in early years, recently emerged meta genome projects using 454 sequencing platform were sometimes inclined not to take the mate pair approach to sequence the DNA fragments mainly due to the lower costs. However, robust mate pair protocols are increasingly regarded as essential to new sequencing technologies for their wider application in de novo sequencing, especially to meta genomic assembly process (). The study in this article demonstrates that using mate pair information to resolve the repeat in the overlap graph is the promising method for meta genomic assembly. Moreover, our attempt in this article provides valuable support for the mate pair approach in the trade-off in sequencing protocol selection for 454 sequencing platform or other next generate sequencing platform in meta genome projects. As we have clarified, our assembly method are designed to address the issue of longer meta genomic reads (recommended as 200 bp) from such as Sanger and 454 sequencing technologies. The strongest reason for this interest is that longer reads are
