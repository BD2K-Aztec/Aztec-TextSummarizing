Motivation: Quantification of the contribution of genetic variation to phenotypic variation for complex traits becomes increasingly compu-tationally demanding with increasing numbers of single nucleotide polymorphisms and individuals. To meet the challenges in making feasible large scale studies, we present the REgional heritability advanced complex trait analysis software. Adapted from advanced complex trait analysis (and, in turn, genome wide complex trait analysis), it is tailored to exploit the parallelism present in modern traditional and graphics processing unit gpu accelerated machines, from workstations to supercomputers. Results: We adapt the genetic relationship matrix estimation algorithm to remove limitations on memory, allowing the analysis of large data-sets. We build on this to develop a version of the code able to efficiently exploit gpu accelerated systems for both the genetic relationship matrix and REstricted maximum likelihood (REML) parts of the analysis, offering substantial speed up over the traditional central processing unit version. We develop the ability to analyze multiple small regions of the genome across multiple compute nodes in parallel, following the re-gional heritability approach. We demonstrate the new software using 1024 GPUs in parallel on one of the worlds fastest supercomputers. Availability: The code is freely available at http://www.epcc.ed.ac.uk/ software products Contact: a grayed ac uk
introduction the majority of traits of interest in relation to animal and human disease, livestock breeding and natural and artificial selection can be described as complex, in that they are determined by large numbers of genetic and environmental factors as well as their interactions. Statistical analysis techniques can be used to quantify the contribution of genetic variation to phenotypic variation for complex traits and genomic prediction. Large cohorts and dense single nucleotide polymorphism (SNP) panels, including millions of SNPs, are required to achieve sufficient statistical power for mapping and increased accuracy at the expense of increased computational demand. It is of vital importance to tailor algorithmic implementation as closely as possible to modern computational hardware, to make the desired studies feasible modern workstations, or nodes, typically contain one or a few central processing units (CPUs), each with multiple cores, and a memory of limited size. Larger systems can be built by interconnecting multiple nodes. Many systems now also feature augmentation with graphics processing units (GPUs); traditionally used for computer gaming, these contain typically hundreds or thousands of simplistic cores and can offer substantial computational advantages when used in conjunction with CPUs as compute accelerators. Thus, increased computational performance comes at the cost of increased architectural complexity. Traditional programming languages can target only a single core of a single CPU. To fully exploit modern resources, one must embrace parallel programming techniques. For each of the different types of parallelism described above, different techniques must be used, and these can be combined to form hybrid programs able to perform well on systems ranging from simple workstations to the largest of supercomputers. In (), we presented advanced complex trait analysis (ACTA), a software package for quantifying the contribution of genetic variation to phenotypic variation for complex traits using core functionality from the genome wide complex trait analysis gct a software () but with dramatically improved computational performance on modern multi-core CPUs. In this article, we introduce REgional heritability advanced complex trait analysis react a a derivative of ACTA offering several key advantages in addition to the preexisting functionality. First, as described in Section 2.1, the genetic relationship matrix (GRM) estimation algorithm has been adapted to remove memory size limitations and allow the analysis of large datasets. Building on this, we have developed a version able to exploit gpu accelerated architectures, as described in Section 2.2. In Section 2.3, we describe development of functionality allowing a regional heritability approach, in which multiple compute nodes can be used in parallel to automatically analyze multiple small regions of the genome. Finally, in Section 3, we present results comparing the performance of the CPU and GPU versions and showcase a demonstrative run using 1024 GPUs in parallel on one of the world's largest supercomputers. Note that, whether using the regional heritability approach or not, our developments preserve numerical consistency (for both GRM files and REML results) with the original gct a software. All our developments are thoroughly tested through use of an automated test suite containing a range of datasets and use cases (where, of course, gct a does not have the functionality to automatically analyze multiple regions, but one can compare single regions manually). *To whom correspondence should be addressed.  The Author 2014. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals permission soup com
