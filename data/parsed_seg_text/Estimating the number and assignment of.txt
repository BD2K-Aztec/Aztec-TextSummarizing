Motivation: molecular clock methods can be used to estimate evolutionary rates and timescales from DNA sequence data. However, different genes can display different patterns of rate variation across lineages, calling for the employment of multiple clock models. Selecting the optimal clock partitioning scheme for a multigene dataset can be computationally demanding, but clustering methods provide a feasible alternative. We investigated the performance of different clustering methods using data from chloroplast genomes and data generated by simulation. Results: Our results show that mixture models provide a useful alternative to traditional partitioning algorithms. We found only a small number of distinct patterns of among lineage rate variation among chloroplast genes, which were consistent across taxonomic scales. This suggests that the evolution of chloroplast genes has been governed by a small number of genomic pacemakers. Our study also demonstrates that clustering methods provide an efficient means of identifying clock partitioning schemes for genome scale datasets. Availability and implementation: The code and data sets used in this study are available online at https://github.com/sebastianduchene/pacemaker_clustering_methods.

introduction evolutionary rates and timescales can be estimated from nucleotide sequences using molecular clock models, which describe the pattern of rate variation among lineages. The various clock models share a reliance on age calibrations, but they differ in their assumptions about the number and distribution of distinct evolutionary rates (reviewed by). For example, the strict molecular clock assumes a single rate across all lineages (), whereas uncorrelated relaxed clocks allow branches to have distinct rates that are drawn from the same distribution (). There are various model selection methods for identifying the best fitting clock model for a dataset of interest (e.g. using marginal likelihoods;). The choice of clock model can have substantial impacts on phylogenetic estimates, particularly those of evolutionary rates and timescales. Rates of molecular evolution often vary among lineages, but this pattern of variation can differ across sites and across genes (). Therefore, when complex sequence data are being analyzed, the use of multiple clock models might provide a better fit (e.g. higher marginal likelihood) than a single clock model. For example, separate clock models might be applied to different genes or codon positions. In analyses of multigene datasets, there are usually many possible partitioning schemes. Identifying the best fitting schemes involves two components: determining the optimal number of clusters, and assigning the genes to these clusters. In Bayesian analyses, this can be done using Bayes factors to compare different clock partitioning schemes (). However, such an approach is impractical when there are many candidate schemes, as is often the case for multigene or genome scale datasets, because the statistical fit of every possible scheme would need to be assessed clustering methods provide a computationally feasible means of identifying appropriate clock partitioning schemes, by grouping subsets of the data according to their pattern of among lineage rate variation (). Similar approaches are available for selecting partitioning schemes for substitution models (). The software clock star which was designed to identify the best fitting clock partitioning scheme for multigene datasets (), employs a kme do ids clustering algorithm known as partitioning around me do ids (). However, other clustering methods, such as k means and Gaussian mixture modeling, have not been tested in the context of clock model selection. One advantage of Gaussian mixture models is that they can represent the shapes of clusters flexibly by using covariance matrices. For example, they can use a diagonal covariance matrix to identify clusters with ellipsoidal shapes, such that they might have higher accuracy than kme do ids. Here we test the performance of three different clustering methods for identifying the clusters of patterns of among lineage rate variation in multigene datasets: variational inference Gaussian mixture model vbg mm Dirichlet process Gaussian mixture model dpg mm and partitioning around me do ids (PAM). We evaluate these three methods using simulated data and apply them to chloroplast genome sequences from angiosperms. We find that the optimal number of clusters for these datasets range from one to three. Our results also reveal that mixture models, such as vbg mm and dpg mm tend to detect a larger number of clusters than methods based on partitioning, such as PAM. Mixture models also appear to be more robust than PAM in that they can detect the correct number of clusters in a broader range of simulation conditions.

discussion we investigated the performance of three different clustering methods for grouping genes according to their pattern among lineage rate variation. We have found that the vbg mm with a spherical covariance matrix provides the best fit among the mixture models to a range of chloroplast datasets, and our simulation study confirms the stability of this method. The PAM algorithm failed to recover the simulation conditions under vbg mm in most cases, probably because the shape of the clusters is difficult to capture using this method. In contrast, vbg mm frequently estimated the correct number of clusters irrespective of the simulation method. This differs from the results of previous studies of clustering methods for branch length patterns, which found that the PAM algorithm appeared to perform well (). However, we reanalyzed a mammalian genome dataset from our previous study () and found a similar number of clusters (Supplementary Material); the most stable mixture model dpg mm supported seven clusters, compared with 13 using PAM in the original study. This suggests that, in empirical studies, it is important to compare the inferences from different clustering algorithms. In this study, for example, the estimated numbers of clusters for the empirical data are very similar among clustering algorithms. We find that mixture models provide a powerful alternative that can flexibly accommodate different cluster shapes. The results from these models also appear more stable under different simulation conditions, at least for the datasets analyzed here. Another advantage of these methods is that their parametric nature offers a simple framework for conducting simulations, which should be done routinely to assess the robustness of the results. Importantly, the shape of the clusters and choice of covariance structure do not necessarily have biological implications. Rather, they provide a convenient mathematical description of the cluster shapes. The clusters identified in our analyses represent groups of genes that have similar patterns of among lineage rate variation. All of the clustering algorithms suggest that the evolution of chloroplast genomes in angiosperms and nuclear genomes in mammals has been governed by a small number of pacemakers, each of which leads to a distinct pattern of rate variation among lineages (). This is consistent with previous findings from prokaryotes (), Drosophila, and yeast (). Furthermore, comparing the gene clusters across our five angiosperm datasets reveals that there is some consistency in pacemakers across different taxonomic scales (). However, additional work will be needed to understand the biological bases of these pacemakers. Identifying genes with similar patterns of among lineage rate variation has important applications in phylogenetic analyses. Notably, in molecular dating studies, estimates of divergence times have been shown to be more accurate if a separate relaxed clock model is assigned to each cluster of genes (). Our results indicate that multigene datasets might only exhibit a small number of distinct patterns of rate variation among lineages. This has notable implications for analyses of genome scale datasets, for which only a small number of relaxed clock models might be sufficient to capture the key components of evolutionary rate variation. To this end, clustering methods provide a feasible and reliable alternative to more computationally demanding approaches to selecting clock partitioning schemes for molecular dating analyses. In particular, mixture models might have better performance than the kme do ids and k means algorithms for genomic data because they can model clusters of different shapes. Increasing the adoption of these methods will help to improve estimates of evolutionary rates and timescales from genome scale datasets results are based on analyses of 100 simulations under the model fitted to each of the five chloroplast datasets. In all cases, the most frequently chosen mixture model was the vgb mm with a spherical covariance matrix (frequency of 1.00). k mixture is the most frequent k for analyses of the data simulated using mixture models. k PAM is the most frequent k for the analyses using the PAM algorithm, with its corresponding frequency.
