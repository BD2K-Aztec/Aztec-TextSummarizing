Motivation: Researchers need general purpose methods for objectively evaluating the accuracy of single and meta genome assemblies and for automatically detecting any errors they may contain. Current methods do not fully meet this need because they require a reference, only consider one of the many aspects of assembly quality or lack statistical justification, and none are designed to evaluate meta genome assemblies. Results: In this article, we present an Assembly Likelihood Evaluation (ALE) framework that overcomes these limitations, systematically evaluating the accuracy of an assembly in a reference independent manner using rigorous statistical methods. This framework is comprehensive , and integrates read quality, mate pair orientation and insert length (for paired end reads), sequencing coverage, read alignment and km er frequency. ALE pinpoints synthetic errors in both single and meta genomic assemblies, including single base errors, insertions deletions genome rearrangements and chimeric assemblies presented in meta genomes. At the genome level with real world data, ALE identifies three large mis assemblies from the spi rocha eta smaragd in ae finished genome, which were all independently validated by Pacific Biosciences sequencing. At the single base level with Illumina data, ALE recovers 215 of 222 (97%) single nucleotide variants in a training set from a gc rich Rhodobacter sphaeroides genome. Using real Pacific Biosciences data, ALE identifies 12 of 12 synthetic errors in a Lambda Phage genome, surpassing even Pacific Biosciences own variant caller, ev icons. In summary, the ALE framework provides a comprehensive, reference independent and statistically rigorous measure of single genome and meta genome assembly accuracy, which can be used to identify mis assemblies or to optimize the assembly process. Availability: ALE is released as open source software under the uo i
introduction recent advances in next generation high throughput sequencing technologies have dramatically reduced the cost of sequencing (). With the development of genome assemblers able to use large volumes of sequence data, reference genomes are now rapidly produced using the whole genome shotgun strategy, from small, simple microbial genomes () to large, complex plant or mammalian genomes (). Meanwhile, genomes are also being generated directly from complex communities using culture independent approaches, including singe cell genome sequencing and meta genome sequencing (). The ability to assemble a meta genome is particularly important because resolving the genomes of individual species, or at least the most abundant, from a complex community is crucial to exploring inter-species interactions and understanding the community s structure, dynamics and function. Assembly of individual genomes from NGS datasets poses significant informatics challenges, including short read length, noisy data and large data volume (). Owing to these challenges, errors widely exist in single genome assemblies derived from NGS datasets, with different specific errors commonly associated with particular datasets, genomes and tools (). Beyond the challenges faced in assembling single genomes, meta genome assembly poses unique additional challenges. First, although the sequence depth of a single genome should be approximately uniform, the sequence depth of genomes in a meta genome varies greatly. Second, the difficulty of resolving repetitive regions within a single genome is exacerbated in meta genome assembly because conserved genomic regions and lateral gene transfer greatly increase the portion of falsely identified repetitive genomic regions. Despite these unique challenges, assemblers designed for single genomes are being applied to meta genome data without being significantly modified to systematically address errors introduced in this way (). Several tools have been developed to detect errors in single genome assemblies. If a reference genome for the targeted organism is available, or one is available from a closely related species, erroneous insertions, deletions or large gaps can be detected by *To whom correspondence should be addressed.  The Author 2013. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals permission soup com comparative analysis of the reference and the genome assembly in question (). If a reference is unavailable, the alignment of the raw reads with their assembly provides indirect measures of assembly quality such as coverage depth and mate pair consistency. This information can then be used to detect single base changes, repeat condensation or expansion, false segmental duplications and other mis assemblies (). Despite this progress, researchers still lack a method that integrates indirect measures of read alignment quality in a quantitative, comprehensive and statistically well founded manner to systematically detect errors in single genome assemblies. Moreover, metrics suitable for evaluating meta genome assembly accuracy, and associated quantitative methods for detecting errors in meta genome assemblies, have yet to be developed. In this work, we develop a novel statistical model for evaluating assembly accuracy in a reference independent manner. Using Bayesian statistics, we give an expression for the probability that an assembly is correct, and provide an automated software tool Assembly Likelihood Evaluation (ALE) based on this expression. The provided tool may be used in three ways. First, it allows examining the contribution to this probability of correctness from each base in the assembly, which can be used to identify specific errors and their locations. This is particularly useful for genome finishing. Second, it provides an overall score for different assemblies of the same genome or meta genome thereby enabling comparison of these assemblies and optimization of the assembly process. Third, when applying re-sequencing data to a reference genome, ALE can detect structural variations.

discussion ale facilitates the rapid discovery of many types of errors in genome assemblies including meta genomes. It does this by applying a rigorous statistical model, calculating the likelihood of observing a specific assembly, given the reads that were used to generate it, and calculating the contribution to this likelihood from each position in the assembly. This allows ALE to determine specific regions within a proposed assembly that are poorly supported by the reads. By integrating several aspects of the assembly and the reads, including km er composition, sequence depth, insert length and how well individual bases map, ALE is able to find errors as small as a single substitution error or in del as well as large copy number errors and chimeric meta genome assemblies. This framework can serve as a guide in optimizing genome assemblies in the following two ways. First, total ALE scores can be used to identify the best assembly from those generated by different assembly protocols. Second, by modifying the regions in which ALE reports low sub scores more accurate genomes can be constructed. The space of possible corrections to an input genome is too large to allow the current implementation of ALE to be used as an independent assembler, but it could be used to compare and combine the results from different assemblers and produce an assembly that is most likely to be correct. ALE could also be used to present an alternative method for ALE calculating assembly accuracy in local assembly algorithms such as ge novo (). When used with a reference genome and resequencing data, ALE can discover structural variations. As shown in the cases of spi rocha eta smaragd in ae and R. sphaeroides, ALE readily detects structural variations whose sizes vary from a single base to several hundred kilobases. ALE currently does not classify the type of assembly errors. Future work is needed to determine the profile of each type of assembly errors in a dataset specific manner. Once ALE has this capability, it could guide an auto correction algorithm to automatically fix problematic regions. The effectiveness of ALE is influenced by the quality of its input: the read data and the alignments of those reads onto the A B. ALE identifies regions with potential assembly errors. (A) Cumulative plots showing the percentage of assembly errors detected by ALE at different sensitivity thresholds. Detected assembly break points (break sensitivity), and novel calls (novel) at different ALE insert or placement thresholds (ALE Top Scores) for six assemblies of Staphylococcus using six different assemblers are shown. (B) A snapshot from Integrative Genomics Viewer for a scaffold from the velvet assembly of staph lo coccus. In the track Coverage, the height represents sequencing depth, and vertical colored bars represent potential SNPs. In the track Raw Reads, each gray horizontal bar represents a high quality aligned read, whereas horizontal color bars represent reads that may indicate problems (e.g. insert size is too big or too small). Vertical color bars are bases different from the reference sequence. More detailed description can be found at: http://www.broadinstitute.org/igv/AlignmentData
