Motivation: single particle cryo electron microscopy cry oem typically produces density maps of macromolecular assemblies at intermediate to low resolution (∼5–30 Å). By fitting high resolution structures of assembly components into these maps, pseudo atomic models can be obtained. Optimizing the quality of fit of all components simultaneously is challenging due to the large search space that makes the exhaustive search over all possible component configurations computationally unfeasible. Results: We developed an efficient mathematical programming algorithm that simultaneously fits all component structures into an assembly density map. The fitting is formulated as a point set matching problem involving several point sets that represent component and assembly densities at a reduced complexity level. In contrast to other point matching algorithms, our algorithm is able to match multiple point sets simultaneously and not only based on their geometrical equivalence, but also based on the similarity of the density in the immediate point neighborhood. In addition, we present an efficient refinement method based on the Iterative Closest Point registration algorithm. The integer quadratic programming method generates an assembly configuration in a few seconds. This efficiency allows the generation of an ensemble of candidate solutions that can be assessed by an independent scoring function. We benchmarked the method using simulated density maps of 11 protein assemblies at 20 Å, and an experimental cry oem map at 23.5 Å resolution. Our method was able to generate assembly structures with root mean square errors 6.5 Å, which have been further reduced to 1.8 Å by the local refinement procedure. Availability: The program is available upon request as a Matlab code package.

introduction to understand biological mechanisms of cellular processes, high resolution structures of macromolecular assemblies are needed (). single particle cryo electron microscopy cry oem and image processing typically produces 3D density maps of large assemblies at intermediate to low levels of resolution (530 ). Although the number of maps at sub nanometer resolution is increasing significantly in recent years, allowing the identification of secondary structure elements * To whom corresponding should be addressed. and even the tracing of the backbone (), for most cry oem maps the level of resolution is still not sufficient to directly determine the structure at atomic detail. However, a pseudo atomic picture of the entire macromolecule can be determined by integrating information about the atomic structures of the individual components with the density map of the assembly (). This integration is done via a process called density fitting, where structures are fitted into the density maps by optimizing a quality of fit measure between the cry oem map and the density of the probe structure at a corresponding level of resolution (). A considerable challenge is the fitting of multiple components into the density map of an assembly if no a priori knowledge about the location of the components is available. Sequential fitting of components often fails when they can not be unambiguously placed in the density map as is often the case for maps of 1030  resolution and for assemblies with a large number of components. In such cases, all components must be fitted simultaneously into the map to identify the global optimum of the quality of fit measure. The simultaneous fitting of components is difficult as the large search space makes an exhaustive search protocol that uniformly samples over all degrees of freedom computationally unfeasible. To overcome this problem uses discrete sampling in combination with an inference optimizer and expands the quality of fit measure by additional information such as shape complementarity between interacting components. Other fitting strategies simplify the search problem by reducing the complexity of the 3D volumetric density and structures. In one method, the initial density distribution of assembly and components are approximated by a small set of Gaussian functions to efficiently use gradient based optimization methods for the structural optimization of component orientations gmf it (). Other methods reduce the complexity of density maps to a small set of feature points so called codebook vectors) that are meant to best reproduce the density map's gross features, such as its shape and mass distribution (). The optimal positions of feature points can be determined by the vector quantization (VQ) technique (). The fitting problem then effectively reduces into a common point set matching problem. This matching has been achieved by an exhaustive search method
