Motivation: Many human genes express multiple transcript isoforms through alternative splicing, which greatly increases diversity of protein function. Although RNA sequencing rnase q technologies have been widely used in measuring amounts of transcribed mRNA, accurate estimation of transcript isoform abundances from rnase q data is challenging because reads often map to more than one transcript isoforms or paralogs whose sequences are similar to each other. Results: We propose a statistical method to estimate transcript iso-form abundances from rnase q data. Our method can handle gapped alignments of reads against reference sequences so that it allows insertion or deletion errors within reads. The proposed method optimizes the number of transcript isoforms by variational Bayesian inference through an iterative procedure, and its convergence is guaranteed under a stopping criterion. On simulated datasets, our method outperformed the comparable quantification methods in inferring transcript isoform abundances, and at the same time its rate of convergence was faster than that of the expectation maximization algorithm. We also applied our method to rnase q data of human cell line samples , and showed that our prediction result was more consistent among technical replicates than those of other methods. Availability: An implementation of our method is available at http://

introduction alternative splicing is a biological process in which an exon can be either included or excluded, or there can be several splice sites so that it allows a gene to have multiple forms of proteins. A recent study suggested that 490% of human genes undergo alternative splicing, and that many alternative splicing events vary among tissues (). It has also been reported that some aberrant splicing results in human diseases, such as cystic fibrosis and spinal muscular atrophy (). Hence, it is important to identify transcript isoforms that are expressed in particular tissues under some conditions, and not in others. To quantify transcription levels, rnase q that uses high throughput sequencing of cDNA has been widely used. Advantages of rnase q over other conventional methods, such as DNA microarrays, include precise measurements of levels of transcripts and splice patterns because the sequence based approach directly determines mRNA sequences (). Probabilistic approaches have been proposed to compute the relative frequencies of alternative splice isoforms for each gene, but these methods do not handle reads that map to multiple gene loci, and hence do not estimate global transcript abundances for each isoform (). In most cases, reads are often shorter than a full transcript, and sequences of alternatively spliced transcript isoforms and paralogs are often similar to each other (). Hence, short reads generated by rnase q do not always map uniquely to reference cDNAs, which lead to inaccurate estimation of transcript isoform abundances. Several approaches have been proposed to resolve ambiguous reads that map to multiple transcript isoforms (multi-map reads). One ad hoc approach is to allocate fractions of multi mapped reads to target transcript isoforms equally, which is implemented as the default option in Cufflinks (). Another approach is to allocate fractions of the reads in proportion to the coverage of uniquely mapped reads divided by the length of the transcript isoforms ('rescue' method) (), which is implemented as the '-u' option in the latest version of Cufflinks. Statistical methods that use a generative model of rnase q data have been proposed, in which the transcript isoform abundance is estimated as a latent random variable by the expectation maximization (EM) algorithm (). although showed that the statistical methods performed better than the rescue method (), their methods can not handle the gapped alignment of reads, i.e. an alignment with insertions into reference sequences or deletions from reference sequences. When reads generated from high throughput sequencers become longer with some insertion or deletion errors, it will be more difficult to map the reads to reference sequences without allowing gapped alignment. Hence, the limitation of methods that are unable to handle gapped alignments of reads is a huge drawback when more sophisticated mapping tools such as Bowtie2 *To whom correspondence should be addressed.() or novo align www novo craft com are considered. Also, the EM algorithm used in these statistical methods tends to over fit the model parameters to the rnase q data, i.e. the methods try to estimate as many transcript isoforms as possible, as long as the likelihood function increases. It is problematic, for example, when there are many transcript isoforms whose sequences are similar to the one that is actually expressed, and the read sequences contain base substitution, insertion and deletion errors. As a result of the maximum likelihood estimation, the method might predict false positives ('spurious' transcript isoforms), and hence, the transcript abundances estimated for true isoforms are affected. One strategy to avoid such overfitting is to consider a model selection framework based on the marginal likelihood (), where a tradeoff of matching of sequence reads and the number of isoforms can be considered. However, this involves integrating over all latent variables as well as model parameters, which is usually difficult and intractable to compute. In this article, we propose a statistical method named TIGAR, a transcript isoform abundance estimation method with gapped alignment of rnase q data by variational Bayesian (VB) inference. The proposed method can handle gapped alignment of reads to reference sequences, allowing mismatches, insertions and deletions. Our VB inference approach resolves the issue of overfitting by optimizing the number of transcript isoforms under the model selection framework (). The VB inference approximates full posterior distributions by assuming the factorization of latent variables and model parameters (). An approximation of the posterior distribution is obtained via an iterative em like algorithm with a closed form solution in each iteration, and its convergence is guaranteed (). We show from simulation experiments that the proposed method successfully predicts transcript isoform abundances more accurately than other comparable methods, and at the same time, its rate of convergence is faster than that of the EM algorithm. We also apply our method to rnase q data of human cell line samples, and show that the prediction result obtained by the proposed method is more consistent than those obtained by other methods.

discussion in this article, to estimate transcript isoform abundances from rnase q data, we proposed a statistical method, named TIGAR, which can handle gapped alignments of reads against reference sequences. To avoid overfitting, we also proposed VB inference that iteratively optimizes the number of transcript isoforms. We showed through simulation experiments that in quantifying transcript isoform abundances from rnase q data, TIGAR (VB) performed better than the popularly used Cufflinks and r sem especially when the length of reads became longer with some insertion and deletion errors. We also showed that the convergence speed of TIGAR (VB) was faster than those of TIGAR (EM) and r sem which is likely explained by the optimization of the number of transcript isoforms in the early iterations. We also applied our method to real data from human cell line samples and showed that the prediction result by our method was more consistent than those by other methods in estimating transcript abundances of technical replicates. Notably, TIGAR (VB) made fewer predictions of transcript isoforms whose fp km were small (e.g.51), in comparison with predictions by Cufflinks and r sem many of which we believe might be false positives. It is also important to consider experimental noise introduced during library preparation under different conditions. To handle such variations among multiple replicates or experimental conditions, methods such as cuff diff () or eb seq () can be considered in a downstream analysis. The performance of TIGAR will become more significant when it is applied to rnase q data produced with new types of sequencers, such as the Ion PGM and Pacific Biosciences' RS, whose reads are longer but with relatively many insertion and deletion errors (). Our TIGAR (VB) optimizes the number of transcript isoforms by maximizing the lower bound of log likelihood for rnase q data. On the contrary, other model selection methods such as the Bayesian information criterion (BIC) () or a sampling based approach can be considered. However, it has been reported that the variational lower bounds outperform the BIC in finding the correct model structure, while approaching the performance of the much more costly sampling procedure (). Hence, we believe that the proposed method offers the advantage of Bayesian inference to avoid overfitting but keeps the computational speed comparable with that of the EM algorithm. A useful application of TIGAR (VB) might be the quantification of novel alternative spliced isoforms or fusion transcripts from rnase q data by augmenting reference sequences to include novel splice junctions (). Another useful application might be fusion transcripts predicted from discordant ly mapped mate pairs (). In such cases, Because the number of possible splice junctions or combinations of exons increases dramatically, the proposed method will be helpful to select a set of plausible transcript isoforms so that predictions can be further validated. Alternatively, if we know in advance from other experiments that certain transcript isoforms expressed more than others, then the proposed method might be able to incorporate the prior information by setting the hyper parameter 0 as an effective read count. Hence, hyperparameters can be fixed according to prior knowledge or 0 can be chosen as a maximizer of the lower bound of the log marginal likelihood, as described in the article. The current model can not distinguish between sequencing errors and the alignment mismatches because of single nucleotide polymorphisms (SNPs) or structural variations inherent in samples. It will be useful to incorporate structural variation information in the dbSNP (http://www.ncbi.nlm.nih.gov/projects/SNP/). Our future work will include investigations of topics mentioned earlier in text.
