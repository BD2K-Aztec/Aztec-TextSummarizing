Motivation: high throughput sequencing of mRNA rnase q has led to tremendous improvements in the detection of expressed genes and reconstruction of RNA transcripts. However, the extensive dynamic range of gene expression, technical limitations and biases, as well as the observed complexity of the transcriptional landscape, pose profound computational challenges for transcriptome reconstruction. Results: We present the novel framework mit ie (Mixed Integer Transcript IdEntification) for simultaneous transcript reconstruction and quantification. We define a likelihood function based on the negative binomial distribution, use a regularization approach to select a few transcripts collectively explaining the observed read data and show how to find the optimal solution using Mixed Integer Programming. mit ie can (i) take advantage of known transcripts, (ii) reconstruct and quantify transcripts simultaneously in multiple samples, and (iii) resolve the location of multi mapping reads. It is designed for genome and assembly based transcriptome reconstruction. We present an extensive study based on realistic simulated rnase q data. When compared with state of the art approaches, mit ie proves to be significantly more sensitive and overall more accurate. Moreover, mit ie yields substantial performance gains when used with multiple samples. We applied our system to 38 Drosophila melanoga-ster mod encode rnase q libraries and estimated the sensitivity of reconstructing omitted transcript annotations and the specificity with respect to annotated transcripts. Our results corroborate that a well motivated objective paired with appropriate optimization techniques lead to significant improvements over the state of the art in transcrip-tome reconstruction. Availability: mit ie is implemented in Cþþ and is available from

introduction most of the complexity of higher eukaryotic transcriptome s can be attributed to the encoding of multiple transcripts at a single genic locus by means of alternative splicing, transcription start and termination (e.g.). A comprehensive catalog of all transcripts encoded by a genomic locus is essential for downstream analyses that aim at a more detailed understanding of gene expression and RNA processing regulation. rnase q is a method for parallel sequencing of a large number of RNA molecules based on high throughput sequencing technologies (ENCODE Project). Currently available sequencing platforms typically provide several 10100 millions of sequence fragments (reads) with a typical length of 50150 bases. By mapping these reads back to the genome, one can determine where gene products are encoded in the genome (e.g.) and collect evidence of RNA processing such as splicing () or rna editing (). In many cases, the rnase q reads are first aligned to a reference genome using an alignment tool that identifies possible read origins within the genome. Contiguous regions covered with read alignments (possibly with small gaps) are candidates for exonic segments. Alignment tools for rnase q reads, such as pal mapper (), top hat (), map splice (), Star () or g snap () are typically able to identify new exon exon junctions, which are candidates for introns. This information can be compiled into a segment or splicing graph, a directed acyclic graph, where the nodes correspond to exonic segments and the edges correspond to intron candidates cf for an illustration). Assuming complete coverage, an expressed transcript corresponds to a path in the graph. Similar graphs are produced during de novo transcript assembly with the difference that the graph can potentially be cyclic, and the segments are not explicitly associated with a genomic location. In genome and assembly based transcript reconstruction, tools such as Scripture (), Cufflinks (), trans abyss (), Trinity () and OASES () select a subset of paths through the graph as transcript predictions. For simplicity, we will focus on genome based transcript reconstruction when describing the approach and discuss de novo assembly whenever necessary. The Author 2013. Published by Oxford University Press. This is an Open Access article distributed under the terms of the Creative Commons Attribution License (http://creativecommons.org/licenses/by/3.0/), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited. Owing to the nature of the rnase q reads, the information obtained from the alignments is of local nature only, even when considering paired end sequencing (e.g.). The splicing graph representation implicitly assumes independence of local events. Hence, it will typically contain more paths than expressed transcripts. This is also true in the ideal case when the graph is (i) complete in the sense that it contains all vertexes and edges and (ii) accurate in the sense that it only contains expressed exonic segments as vertexes and edges that correspond to introns of expressed transcripts. For instance, the 183 807 splice variants annotated in any of the four human genome annotations (Ensembl, HAVANNA, ENCODE, Vega, see) define splicing graphs that encode 707 386 paths, with 55% of the loci contribute 460 of the paths. Thus, we encounter a few particularly complex cases that contribute most to transcriptome complexity. Defining splicing graphs based on rnase q data entails the additional difficulty that inaccurate or ambiguous read alignments can substantially increase the size of these graphs. Although this problem can be addressed by filtering the read alignments, we find that strict filtering often leads to a reduced sensitivity of transcript prediction and introduces artifacts, for instance, in the presence of unknown genomic variations. Based on a detailed analysis of the problem and of previous work, we identified three important requirements that a transcript inference algorithm based on rnase q data should meet. First, following the arguments in, we note that it is important to simultaneously identify and quantify transcripts to resolve long range dependencies. In Section 4.1, we illustrate how quantitative information can perfectly de convolve contributions from multiple transcripts, whereas ignoring quantitative information leads to inaccurate predictions. Second, enumeration of all paths defined by a splicing graph is often not tractable. For instance, for % 13% and % 3% of human genes, the number of paths in splicing graphs generated from the annotation and rnase q reads (see Section Supplementary Section C) is greater than 1000 and 1 000 000, respectively (see Supplementary). This large number is the result of a combinatorial explosion of possible combinations of alternative segments and edges (This is even larger in case of de novo assembly where several loci are merged into cluster of connected segments if sequence is repeated). Therefore, a generally applicable approach should avoid explicit enumeration, ideally still guaranteeing optimality. Third, we show that multiple rnase q samples help to solve the ill posed problem of transcript identification (see e.g.). By sharing information between samples, while still considering them separately, we can often exactly determine the correct set of expressed transcripts. We provide illustrative examples where neither merging data of multiple samples nor the independent analysis of data from each sample can solve the problem. We describe an approach called mit ie (Mixed Integer Transcript IdEntification) that meets the aforementioned requirements. The main idea of mit ie is to report a small optimal set of transcripts that can well explain the observed rnase q data in multiple samples. It does not require an explicit enumeration of all paths to find the optimal set of transcripts. This is achieved by using branch and bound algorithms that prune parts of the combinatorial search tree that can not yield the optimal solution. mit ie consists of two main parts: A data processing part generates a splicing graph from rnase q alignments in Binary Sequence alignment map bam format the annotation in Gene transfer format gtf format or both (Section 3.1). The second part solves the core optimization problem and starts with the graph decorated with quantitative information (Section 3.2). The design enables the flexible use of mit ie in existing rnase q pipelines. For example, we can use the output of trinity s inchworm tool () as input to the second part of mit ie and thereby solve the transcript reconstruction task, also solved by trinity s butterfly tool. In the following section, we relate mit ie with previous work and illustrate the idea of combining multiple samples in a simulation study in Section 4.1. We then apply mit ie to a larger set of simulated rnase q reads generated from the human genome annotation in Section 4.2. Finally, in Section 4.3 we analyze the performance of mit ie on a large set of rnase q data for Drosophila melanogaster generated within the mod encode project ().

conclusion the transcript prediction problem is typically under-determined. One important consequence of this observation is that deeper sequencing only helps to reduce the variance of abundance estimation and to close gaps in the splicing graph, but it does not solve the transcript identification problem as such. The proposed method reduces the set of solutions by leveraging quantitative information and multiple rnase q samples combined with mild biologically plausible assumptions. Furthermore, prior information can be taken into account in a direct way within a single optimization problem, which we think will turn out particularly advantageous for integrating long reads from third generation sequencing platforms with rnase q data. Our results highlight the importance of a well motivated loss function to penalize the read count deviation. The application of the g nb loss significantly improved our quantification and transcript recognition results, while it comes at nearly zero additional computational cost. The underlying assumption of previously published transcript calling strategies like Cufflinks and Trinity is correctness and completeness of the graphs. Achieving both at the same time is challenging and typically not possible. This results in either wrong transcript predictions that have to be filtered out heuristically or in fragmented transcript predictions. mit ie assumes completeness of the graph, but not correctness. Completeness can often be achieved by not filtering the input alignments or not pruning the assembly graph. The decision of filtering can be deferred to the optimization problem that may choose to discard information in a context dependent way. This is conceptually more attractive than global and uninformed filtering as a preprocessing step. mit ie finds a solution that is compatible to the overall observed read data. As observed on simulated and real world rnase q data, mit ie pushes the boundaries of what can be observed from rnase q data toward more complex mixtures of transcripts by leveraging variability between samples. These improvements come with the downside of higher computational costs; however, the vast majority of cases can be optimally computed within seconds, and our implementation provides options for approximations in cases where exact computations are too expensive. Furthermore, our experiments clearly show that we can obtain the same performance as competing methods with only a fraction of the data, which in turn can save the time, money and storage capacity of deeper sequencing. mit ie allows us to pool information from different samples in an effective way. This conceptual improvement will further future rnase q studies; rather than spending efforts into deep sequencing of a few samples, future studies will have the choice to investigate a larger variety of samples at a lower depth. The combination of these samples allows us to obtain more confident transcript predictions in each sample and more insights into the biological questions at the same time.
