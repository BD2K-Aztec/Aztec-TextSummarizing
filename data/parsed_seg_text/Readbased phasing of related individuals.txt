Motivation: read based phasing deduces the haplotypes of an individual from sequencing reads that cover multiple variants, while genetic phasing takes only genotypes as input and applies the rules of Mendelian inheritance to infer haplotypes within a pedigree of individuals. Combining both into an approach that uses these two independent sources of information reads and pedigree has the potential to deliver results better than each individually. Results: We provide a theoretical framework combining read based phasing with genetic haplo typing and describe a fixed parameter algorithm and its implementation for finding an optimal solution. We show that leveraging reads of related individuals jointly in this way yields more phased variants and at a higher accuracy than when phased separately, both in simulated and real data. Coverages as low as 2Â for each member of a trio yield haplotypes that are as accurate as when analyzed separately at 15Â coverage per individual. Availability and Implementation: https://bitbucket.org/whatshap/whatshap

introduction humans are diploid and determining the sequences of both homologous copies of each chromosome is desirable for many reasons. These two sequences per chromosome are known as haplotypes. The process of obtaining them is known as haplo typing or phasing, two terms that we will use interchangeably. haplotype resolved genetic data can be used, for instance, for population genetic analyses of admixture, migration and selection, but also to study allele specific gene regulation, compound heterozygosity and their roles in human disease. We refer the reader to for detailed reviews on the relevance of haplo typing. General Approaches for haplo typing. There are three major approaches to phasing. First, haplotypes can be inferred from genotype information of large cohorts based on the idea that common ancestry gives rise to shared haplotype tracts, as reviewed by. This approach is known as statistical or population based phasing. It can be applied to unrelated individuals and only requires genotype data, which can be measured at low cost. While very powerful for common variants, this technique is less accurate for phasing rare variants and can not be applied at all to private or de novo variants. Second, haplotypes can be determined based on genotype data of related individuals, known as genetic haplo typing (). To solve the phasing problem, one seeks to explain the observed genotypes under the constraints imposed by the Mendelian laws of inheritance, while being parsimonious in terms of recombination events. For larger pedigrees, such as parents with many children, this approach yields highly accurate phasing s (). On the other hand, it is less accurate for single mother father child trios and has the intrinsic limitation of not being able to phase variants that are heterozygous in all individuals. Third, the sequences of the two haplotypes can be determined experimentally, called molecular haplo typing. Many techniques do not resolve the full length haplotypes but yield blocks of varying sizes. Approaches furthermore largely differ in the amount of work, DNA and money they require. On one end of the scale, next generation sequencing (NGS) instruments generate local phase information of the length of a sequenced fragment at ever decreasing costs. Another approach consists in breaking both homologous chromosomes into (larger) fragments and separating them into a number of pools such that each pool is unlikely to contain fragments from the same locus of both haplotypes. This can, for instance, be achieved by dilution followed by bar-coded short read sequencing. To achieve molecular haplo typing over the range of a full chromosome, protocols have been invented to physically separate the two homologous chromosomes, for example by microscopy based chromosome isolation, fluorescence activated sorting, or microfluidics based sorting. These and other experimental techniques for molecular haplo typing have been surveyed by Snyder

discussion we have presented a unifying framework for integrated read based and genetic haplo typing. By generalizing the what shap algorithm (), we provide a fixed parameter tractable method for solving the resulting np hard optimization problem, which we call ped mec. When maximum coverage and number of individuals are bounded, the algorithm's runtime is linear in the number of phased variants and independent of the read length, making it well suited for current and future long read sequencing data. This is mirrored by the fact that the runtime is dwarfed by the time required for reading the input files in practice. ped mec can use any provided costs for correcting errors in reads as well as for recombination events. By using phred scaled probabilities as costs, minimizing the cost can be interpreted as finding a maximum likelihood phasing in a statistical model incorporating Mendelian inheritance, read error correction and recombination. Testing the implementation on simulated and real trio data, we could show that the method is notably more accurate than phasing individuals separately, especially at low coverages. Beyond enhanced accuracy, our method is also able to phase a greater fraction of heterozygous variants compared to single individual phasing. Being able to phase more variants is a key benefit of the integrative approach. Whereas read based phasing can in principle only phase variants connected by a path through the covering reads, adding pedigree information enables even phasing of variants that are not covered in all individuals since the algorithm can 'fall back' to using genotype information illustrates the increased connectivity while phasing a trio, resulting in more phased variants in practice. Genetic haplo typing alone can not phase variants that are heterozygous in all individuals, emphasizing the need for an integrative approach as introduced here. We demonstrate that such an approach indeed yields better result and recommend its use whenever both reads and pedigree information are available. Most remark ingly the presented approach is able to deliver outstanding performance even for coverages as low as 2 per individual, on par with performance delivered by single individual haplo typing at 15 coverage per individual. Future work. We plan to implement phasing of de novo variants observed in the child, which would be impossible with pure genetic haplo typing but is straightforward with our approach. Since runtime is exponential in the maximum physical coverage, pruning of datasets is required in practice. The read selection approach currently implemented in what shap () aims to retain reads that both cover and connect many variants at the same time, in particular for heterogeneous combinations of datasets such as paired end or mate pair reads together with long reads. For pedigrees, each dataset is currently pruned individually, but results would likely improve if pedigree structure was taken into account in this step. Finally, since we show that it is possible and beneficial to integrate both read based and genetic phasing, the next obvious question is whether it is possible to modify our unified theoretical framework to one that also includes statistical phasing.
