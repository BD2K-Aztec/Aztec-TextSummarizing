Relaxed molecular clocks allow the phylogenetic estimation of evolutionary timescales even when substitution rates vary among branches. In analyses of large multigene datasets, it is often appropriate to use multiple relaxed-clock models to accommodate differing patterns of rate variation among genes. We present ClockstaR, a method for selecting the number of relaxed clocks for multigene datasets.
INTRODUCTIONEstimating evolutionary timescales is a common aim of molecular phylogenetic analysis. This can be done using methods based on the molecular clock hypothesis, which postulates a constancy of substitution rates among lineages (). However, most datasets exhibit significant levels of rate variation among lineages. This can be caused by differences in population size, mutation rate or the strength of natural selection. The molecular clock can be relaxed to take into account such rate variation, usually by allowing a distinct substitution rate along each branch in the phylogenetic tree. Most relaxedclock models have been implemented in Bayesian frameworks (). It is now commonplace to estimate evolutionary timescales using multigene datasets. If the evolutionary process has been heterogeneous among subsets of the data (e.g. among different genes and codon positions), a distinct evolutionary model is needed for each data subset. This presents a challenge for model selection because of the large number of ways in which substitution models and relaxed-clock models can be assigned to the subsets of the data (). Determining the best way to assign relaxed-clock models to different subsets of the data is typically done using Bayes factors (e.g.). Performing large numbers of Bayes factor comparisons is often infeasible, especially using computationally intensive methods such as stepping-stone sampling (). We present ClockstaR, a method for selecting the optimal number of relaxed clocks for partitioned datasets. It combines a tree-distance metric with a clustering algorithm. Our treedistance metric compares trees based on their pattern of among-lineage rate variation. Consider a simple example in which we have two data subsets, perhaps representing independent loci. Phylogenetic branch lengths are estimated separately for each data subset. Our metric quantifies the differences in branchspecific rates between the two trees. If the score for the metric is low, the two trees have similar patterns of among-lineage rate variation and they can share a relaxed-clock model. Based on the pairwise scores for this metric, a discrete clustering algorithm can be used to infer the optimal partitioning strategy for relaxedclock models when there are multiple data subsets. The user provides sequence alignments of the individual data subsets and a single estimate of the phylogeny (without branch lengths). ClockstaR estimates the optimal number of partitions, representing the smallest number of relaxed-clock models that are needed to describe the data. ClockstaR also assigns the data subsets to these partitions. The output can be used to specify the configuration of relaxed-clock models when performing a molecular dating analysis in software such as BEAST (). ClockstaR is implemented in R (R Development Core).