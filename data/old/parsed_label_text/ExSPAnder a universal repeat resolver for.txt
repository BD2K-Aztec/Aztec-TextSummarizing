Next-generation sequencing (NGS) technologies have raised a challenging de novo genome assembly problem that is further amplified in recently emerged single-cell sequencing projects. While various NGS assemblers can use information from several libraries of read-pairs, most of them were originally developed for a single library and do not fully benefit from multiple libraries. Moreover, most assemblers assume uniform read coverage, condition that does not hold for single-cell projects where utilization of read-pairs is even more challenging. We have developed an exSPAnder algorithm that accurately resolves repeats in the case of both single and multiple libraries of read-pairs in both standard and single-cell assembly projects. Availability and implementation: http://bioinf.spbau.ru/en/spades Contact: ap@bioinf.spbau.ru
INTRODUCTIONMost of existing next-generation sequencing (NGS) platforms generate read-pairspairs of reads (called mates) that are sequenced from different ends of a genomic fragment with approximately known length (called the insert size). Because the insert size usually exceeds the length of a single read, readpairs may match up unique regions surrounding repeats that are longer than the read length. A combination of several libraries of read-pairs with different insert sizes is often used to produce high-quality assemblies (). Paired-end libraries usually have insert size 51 kb and are used for resolving relatively short repeats. Jumping libraries are characterized by an average insert size of anywhere from 1 to 20 kb and are helpful in resolving longer repeats and contig scaffolding (inferring the order of contigs in the genome). However, because of a high insert size variation, information from jumping libraries is rather difficult to use for the purpose of assembly. The problem of using multiple read-pair libraries was previously addressed by ALLPATHS-LG (), Ray (), Velvet () and some other assemblers. However, these tools are designed for standard (mutlicell) assemblies and do not perform well on single-cell datasets. On the other hand, the single-cell assemblers ESC (), IDBA-UD () and SPAdes () are designed for a single read-pair library. In addition, the recently proposed Paired de Bruijn Graph algorithms for repeat resolution () also focus on a single library and it remains unclear how to extend them to multiple libraries. We present EXSPANDER algorithm that works with both single and multiple libraries in standard and single-cell assembly projects. EXSPANDER uses a simple path extension approach for repeat resolution that was originally proposed in the Ray assembler [and later used in Telescoper (and combines it with some ideas from the Rectangle Graph approach (). Given a set of paths in the assembly graph () (i.e. simplified de Bruijn graph () of k-mers in reads after removal of bulges, tips and chimeric edges), EXSPANDER attempts to extend each path with the goal to generate longer paths. For a path P ending in a vertex v, we consider all edges starting at v (referred to as extension edges) and compute Score P (e) for each extension edge. To compute Score P (e) we analyze all reads that map to path P and whose mates map to e. Thus, Score P (e) reflects our confidence that an extension of the path P by the edge e is correct. We note that to properly map read-pairs and calculate Score P (e), the total length of path P and edge e should be longer than the insert size. In addition to function Score P (e), EXSPANDER uses a decision rule Extend(P) that either chooses one of the extension edges to extend the path P or makes the decision to stop growing this path beyond the ending vertex of P. The procedure is iterated over all the paths until no path can be further extended. To initiate this algorithm one can start with a set of single-edge paths formed by all sufficiently long edges in the assembly graph. The resulting paths are output as contigs after removing the paths that are contained within other paths as well as removing non-informative overlaps (i.e. suffixes of paths that represent prefixes of other paths). This simple approach is merely a framework and, depending on the specifics of the scoring function and the decision rule, it can be either efficient (like in the Ray assembler) or disastrous. The authors of Telescoper made an attempt to improve on Ray's scoring function and to substantiate it with rigorous statistical analysis. However, scoring functions in both Ray and Telescoper are not universal, e.g. they assume the uniform genome coverage by reads, condition that does not hold for single-cell data. We demonstrate that EXSPANDER works well on single-cell datasets with multiple libraries. We also show that EXSPANDER *To whom correspondence should be addressed.
CONCLUSIONWe have presented EXSPANDER algorithm for resolving repeats using either a single or multiple read-pair libraries with different insert sizes, which is applicable for both single-cell and isolate bacterial datasets. Benchmarks across eight popular assemblers demonstrate that EXSPANDER produces high-quality assemblies for datasets of different types. Additionally, as illustrated by recent integration of Illumina and PacBio reads in SPAdes 3.0, EXSPANDER is a flexible approach that can be easily modified to work with diverse types of sequencing data.Note: NG50 is given in kb; number of scaffolds is the total number of scaffolds 4500 bp; largest stands for the length (in kb) of the longest scaffold assembled; number of mis is the number of misassemblies; GF stands for the fraction of genome mapped given in percent. In each column, the best value is indicated in bold.