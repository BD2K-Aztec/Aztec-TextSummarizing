
INTRODUCTIONThe past 5 years have witnessed a strong interest in the problem of de novo assembly from sequence reads of short and moderate length due to the rapid adoption of high-throughput sequencing technologies. One critical application is the sequencing and assembly of complete bacterial genomes that has become a routine task for many research laboratories. Although, with these technologies comes the need for novel computational and technological approaches to complement the specificities of each platform (). One such example is the use of pairedend sequence reads for de novo assembly that is essential to overcome the shortness of the reads. By allowing the resolution of repeats larger than the read length, paired-end reads greatly improve de novo assembly contiguity (). However, current assembly strategies still result in fragmented draft genomes complicating downstream analysis. Thus, the ability to produce a finished genome is more than a psychological threshold: it is an invaluable resource for the community as it is the foundation for comparative and evolutionary studies (). Closing bacterial genomes in a fast semi-automatic way was reported (). This was done using a combination of Illumina generated short reads, with long reads obtained using Pacific Biosciences' PACBIO RS sequencer. Illumina paired-end reads obtained from short and long inserts distributions are first used to produce an accurate scaffold. Remaining gaps are then filled in with long reads. Here, we focus on obtaining finished genomes using reads from only the broadly adopted Illumina platform, on which paired-end 100 bp reads are routinely obtained. There exist several protocols for producing whole-genome libraries for Illumina sequencing with the most common resulting in either short paired-end libraries generally 5600 bases or long paired-end libraries ranging from 3 to 10 kb. Both such libraries are mandatory for assembly, as bacterial genomes usually contain repeats of several kilobases. Short paired-end reads are generally accurate in length with a standard deviation ranging between 2050 bp. However, the size of long paired-end is less accurate and may vary significantly. Using the information of short and long paired-end reads for de novo assembly is not straightforward with current approaches not fully exploiting their utility. As most assembler programs make use of short paired-end, only a few of them are able to properly handle long inserts. These approaches have mainly been developed for the purpose of large eukaryotic genomes assembly, though they can also cope with smaller bacterial projects. To date, several strategies exist with the majority using short and long inserts at separate stages of the process. Long paired-end reads are generally used at a later stage to produce scaffolds. ALLPATHS-LG () requires a minimum of two libraries, yielding linking information of short (200 bp) and long (45 kb) paired-end. It constructs scaffolds in an iterative manner by successively merging scaffolds obtained during the previous step. In SOAPdenovo (), paired-end is explicitly used at two stages: scaffolding *To whom correspondence should be addressed. and gap closure. During scaffolding, paired-end libraries are used in turn, starting from with the smallest and moving to long insert sizes. Only pairs displaying a unique unambiguous connection are used to join contigs into scaffold. During the second stage, gaps in the scaffold are filled by locally assembling the reads that may be located in the gap region. A related gap closure strategy has been reported in Boetzer and Pirovano (2012). ABYSS () looks for unambiguous pair connection in the graph using the long inserts at a post-processing scaffolding step. Another strategy consists in extending seeds by simultaneously using short and long inserts. Ray () exploits short and long paired-end reads to iteratively elongating paths through an assembly graph. Telescoper () leverages an alternate seed extension strategy, which works by only building a local graph at the extension region and assessing a statistical score for possible extension candidates. It was specifically developed for assembling telomeric regions and requires to be provided with set of strings to start from. The seed extension strategy has a significant advantage over other approaches in that it avoids the computation and storage of all possible routes between paired-reads, which rapidly become intractable as the distance between paired reads increases. We present a novel seed extension strategy that discovers paths through a condensed overlaps graph. The graph structure itself is left untouched while the paths are determined. Possible paths extensions are represented by a tree structure. As soon as an extension is confirmed, it is fixed and other paths are pruned from the tree. The approach simultaneously makes use of the information issued from both types of inserts, short and long to resolve complex tangles. The minimum overlaps size (similar to the k-mer size for DeBruijn graph based approaches) is the key parameter to optimize for a successful assembly. It is common to try a range of values and to choose the one that maximizes the assembly contiguity. The optimal setting is a trade-off between resolving short repeats and conserving the graph connectivity in weakly covered regions. We introduce a way to automatically determine suitable minimum overlap sizes according to the contextual sequencing coverage. Our method identifies and removes overlaps whose sizes are significantly smaller than what could be expected according to the local overlaps sizes distribution. This makes the assembly significantly less sensitive to the minimum overlaps parameter, which in turn simplify the parameterization task for the end users. The described approaches are implemented in the new version of our overlapsgraph-based de novo assembler Edena (). In addition, the program features an interactive shell that allows investigating an assembly at targeted regions. This mode provides a valuable assistance for many tasks such as resolving ambiguities, gap filling, assessing suspect assembly or designing primers. We demonstrate the efficiency of Edena by assembling two Staphylococcus aureus strains from experimental Illumina GA sequencing data. Using paired-end reads sequenced from short and long insert libraries, we produce a finished 2.82 Mbp circular genome of the strain SGH-10-168. The sequence is assessed against a phylogenetically related parent and by polymerase chain reaction (PCR) at targeted regions. We also resequence the strain MW2 with paired-end reads obtained from short and long insert libraries. This assembly yields nine contigs that fully covers the genome with perfect accuracy.
DISCUSSIONWe present a de novo assembly approach that succeeded in obtaining a finished genome sequence of a new S.aureus isolate, a public health implied pathogen. The assembly was performed using 100 bp paired-end reads obtained from the broadly available Illumina platform. Only minor human intervention was required. The presented approach is implemented in the publicly available Edena software application. Our method relies on simultaneously exploiting the information provided by short and long paired-end sequence reads to discover paths in the assembly graph. The process uses a search tree structure that is progressively pruned. Our approach works for inserts of potentially any length by constraining possible paths. Such long paired-end connections can be intractable to establish directly through the assembly graph, as the number of possible paths increases exponentially with the searched distance. We present the search tree structure in the context of an overlaps graph resulting from 100 bp reads. However, it is in all likelihood generalizable to other approaches as well, such as the DeBruijn graph or graphs resulting from longer sequence reads. The used statistics as well as the algorithm that integrates the paired-end connections to select the correct elongations can be further developed. For example, an avenue worth exploring would be to measure the distribution drift that can occur with false-positive paired-end connections. Sequence accuracy is a major concern and we developed Edena by prioritizing accuracy over contiguity. Being able to have confidence at the single nucleotide level of an assembly removes many of the downstream complications during analysis. Even if no de novo assembler can be claimed to be perfectly reliable in all situations, Edena achieved a high level of accuracy, as demonstrated by the assembly of S.aureus strain MW2 data. Moreover, all suspicious cases we checked with independent methods were finally settled in favor of the assembly produced by Edena. The contextual i-edges cleaning procedure significantly reduces the parameterization effort for the end users. A satisfactory, if not optimal, assembly can often be obtained with default parameters. By default, the minimum overlap size is set to half of the reads length, which is conservative. However, according to the achieved coverage, it is worth increasing this setting, which acts as a first rough-hewing and facilities further processing. For example, given the high coverage achieved for the SGH-10-168 and MW2 projects, we set the minimum overlaps value to be 60. However, the same or similar assemblies could also be obtained with default parameters, or with a larger value such as 80. This makes Edena particularly suited for batch automatic assembly of numerous bacterial genomes, for which individual parameterization is not feasible. Even if the required CPU-time and memory displays significant differences between the programs, this requirement was a limitation for none of them. It is important mentioning that these requirements may strongly depend on the parameterization and particularly on the k parameter. We did not optimize the programs settings regarding the hardware requirement, but only regarding the assemblies' contiguity. It is likely that not all bacterial genomes could be so easily assembled. Each sequencing project is an individual story. A recurrent issue is the tandem repeats that require sharp inserts distribution to be properly resolved. The quality of the sequencing data and particularly the accuracy of the inserts length are determinant parameters for a successful assembly. It is, however,Note: Contigs and scaffolds metrics as well as hardware usages are presented for each program. 'SOAP  GC' refers to SOAPdenovo scaffolds post-processed by the GapCloser module. Note that Edena scaffold metrics are not available (n/a), as it does currently not include a scaffolding step. 'Number of seq' is the number of contigs after the removal of non-bacterial contamination. 'Sum' and 'Max' are the total assembly size and the largest contig length, respectively. 'Number of large discr' reports the number of large structural discrepancies with the genome sequence of the closest isolate, which are likely to correspond to assembly error. 'CPU' and 'Mem' are the CPU-time (h) and the memory usage (Gb), respectively.Note: Assembly metrics as provided by QUAST. '% tot mis' is the number of local and extensive misasssemblies, 'Number of ext mis' is the number of extensive misassemblies only. NGA50 is the N50 metrics computed from the contigs broken at every misassembly '% ref' is the percentage of the genome that is covered by the contigs. Remaining columns are the same as in.possible provided human intervention, to manually solve many assembly ambiguities by investigating the paired-end mapping together with the node coverage and graph topology. The interactive shell of Edena was initially implemented for the development purpose but has shown to be an invaluable tool in the process of checking particular regions and in producing a finished genome.