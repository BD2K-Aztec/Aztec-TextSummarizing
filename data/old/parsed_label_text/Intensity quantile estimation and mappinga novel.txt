Motivation: Image non-uniformity (NU) refers to systematic, slowly varying spatial gradients in images that result in a bias that can affect all downstream image processing, quantification and statistical analysis steps. Image NU is poorly modeled in the field of high-content screening (HCS), however, such that current conventional correction algorithms may be either inappropriate for HCS or fail to take advantage of the information available in HCS image data. Results: A novel image NU bias correction algorithm, termed intensity quantile estimation and mapping (IQEM), is described. The algorithm estimates the full non-linear form of the image NU bias by mapping pixel intensities to a reference intensity quantile function. IQEM accounts for the variation in NU bias over broad cell intensity ranges and data acquisition times, both of which are characteristic of HCS image datasets. Validation of the method, using simulated and HCS microtubule polymerization screen images, is presented. Two requirements of IQEM are that the dataset consists of large numbers of images acquired under identical conditions and that cells are distributed with no within-image spatial preference. Availability and implementation: MATLAB function files are available at http://nadon
INTRODUCTIONThe effectiveness of high-content screening (HCS) depends critically on data processing and analysis techniques that are appropriate to its unique technologies and data formats (). In particular, image preprocessing, which represents a conditioning or preparation of the image data, is an often overlooked but essential step (). Image non-uniformity (NU) is a spatially varying bias that is intrinsic to all image-based biological datasets (). The quality of image NU bias correction, which occurs during the preprocessing stage, can affect the validity of all subsequent data analysis steps which include image quantification and statistical inference. In particular, the methods implemented in these steps usually presuppose that the incoming image data are free of bias. Image NU produces a bias in the pixel intensities across images, which causes objects of interest and their surrounding background to appear spuriously brighter or darker depending on their spatial location (e.g.;, Figures 45 and 51). This can create difficulties in the identification of consistent thresholds that distinguish objects of interest from background and, as a result, reduce the accuracy of their segmentation. Bias and variability are also induced in measured cell metrics which depend on both the pixel intensities and the segmentation step. Reduced quality in cell metric data reduces the sensitivity and specificity of hit identification which typically relies on treatment-control comparisons of cell-metric-derived statistics (). Cell classification accuracy (e.g.) will also be diminished if the classification criteria depend on pixel intensity in any way. The within-image spatial variation in cell intensity caused by image NU bias also introduces spurious heterogeneity between cells which can obscure the existence of real, biologically based cell subpopulations, a topic that has gained recent interest and pertinence (). In a particular, striking example of the impact of NU bias,show how the separation of the G1-and M-phase peaks in a cell-cycle classification analysis is obscured by the uncorrected image NU bias. Further discussion of the impact of image NU on image analysis and inference can be found in,the field of HCS, however, the nature of this bias, its impact on subsequent analyses and appropriate correction methods are often poorly understood or overlooked, which leads to the choice of suboptimal correction methods. For example, a large number of HCS studies make use of background subtraction type algorithms (such as the 'rolling ball') which, despite providing visually appealing results, does not correct the higher cell foreground intensities whose quantification is of paramount interest in HCS data analysis. Multiplicative correction and calibration-based methods also have limitations, since HCS assays typically comprise extreme ranges of cellular intensities (e.g.) and are also susceptible to instrumental drift effects. In general, various pre-existing NU bias correction methods and models developed for low-throughput microscopy, which may be either inappropriate for HCS or fail to take advantage of the additional information available in high-throughput contexts, have been the methods of choice for HCS studies. We present the intensity quantile estimation and mapping (IQEM) algorithm, a novel image NU correction method that makes use of the 'asymptotic spatial homogeneity' property found in large throughput (HCS) datasets (c.f. Section 3.1.1 and Supplementary Material Appendix B). (The method is not applicable to the correction of individual images acquired in a low throughput setting). The method accounts for characteristics and analysis objectives of HCS which include (1) large image datasets that comprise extremely diverse ranges of a priori unknown cell phenotypes and thus intensity levels; (2) image acquisition times that can extend over days and which lead to instrumental biases or drifts that can vary with experimental 'batch' and (3) the need for multiple inter-image and inter-plate statistical comparisons over large numbers of images, and the critical importance of controlling the error rates in the resultant hit detection. Concepts of image NU bias and limitations of existing correction methods used in HCS are first described, followed by a theoretical description and practical implementation of the IQEM method. Finally, validation tests using simulated image datasets as well as empirical HCS assay images acquired from a multiparametric assay on microtubule polymerization status (c.f. Supplementary Material Appendix A and) are shown.
DISCUSSIONThe IQEM algorithm represents an improvement over existing methods of image NU correction used in HCS, which are based on varying degrees of simplification to a linear model approximation of NU bias. By estimating the full non-linear form of the NU bias, the IQEM method essentially applies a correction factor that is appropriate to each intensity quantile in the measured image. The method is particularly pertinent for the quantification of extremely low-intensity cell phenotypes, where multiplicative correction provides an inaccurate fit to the low-intensity image NU, and where background subtraction does not adequately model the range of dim intensity levels. An additional positive feature of the IQEM algorithm is that it can be applied on a batch-specific basis such that a unique image NU correction is estimated for each batch. The IQEM method does require that cell placement and intensity are spatially homogeneous within images (i.e. that the asymptotic spatial homogeneity condition holds). Assays that have been properly calibrated, and for which there are no systematic within-image gradients caused by poor optical focus, non-uniform fluorophore or reagent concentrations or cell density gradients (c.f. Supplementary Materials Section B.5), for example, should satisfy this condition. The measurement of multiple fields within wells, a standard practice in HCS, further ensures that on average, the spatial homogeneity condition will hold. Although the IQEM algorithm may be more complex than other conventional methods of NU bias correction, it is readily automated, and its complexity will not be apparent from the user's perspective once integrated into an image-processing pipeline. The IQEM algorithm arose during the analysis of the multiparametric assay of microtubule status, in which a method of batch-specific NU bias correction effective for very low-intensity, depolymerized phenotypes was needed (). The development of IQEM provides an illustration that methods adopted from low-throughput science may not necessarily be optimal in a high-throughput context, which involves the analysis of large-scale image datasets, the testing of compound libraries that produce extremely diverse ranges of a priori unknown cell phenotypes/intensities and requires statistical comparisons of metrics taken across the dataset. It should further be noted that while high-throughput, high-content datasets provide challenges to analysis methods (), they also provide opportunities. In the present case for example, the enormous size of HCS image datasets, which consist of images that are effectively statistical replicates within each experimental batch, makes possible the existence and estimation of the inter-image IQF; estimation of this entity in turn makes possible the inversion of the non-linear NU bias function via a mapping of intensity quantiles. In general, HCS systems comprise and integrate many complex state-of-the-art subsystems, ranging over biological experimentation (cell cultures and immunofluorescence staining for example), automated image acquisition, imaging instrumentation and image processing, each of which acts to produce or condition the high-content data, and also to contribute bias and variability that determine the resultant statistical characteristics of the data (). By more fully understanding the technical and technological issues of each subsystem within an HCS workflow, it becomes possible to better model the statistical distribution of the data, and thus to improve the sensitivity and specificity of statistical inference methods used to draw scientific conclusions from HCS experiments. The current work represents a step in this direction, in the context of the image NU bias produced by HCS imaging instrumentation.