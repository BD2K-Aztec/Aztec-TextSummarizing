Here we describe discoal, a coalescent simulator able to generate population samples that include selective sweeps in a feature-rich, flexible manner. discoal can perform simulations conditioning on the fixation of an allele due to drift or either hard or soft sweepsâ€”even those occurring a large genetic distance away from the simulated locus. discoal can simulate sweeps with recurrent mutation to the adaptive allele, recombination, and gene conversion, under non-equilibrium demographic histories and without specifying an allele frequency trajectory in advance.
IntroductionThe coalescent process, which describes the stochastic genealogy of a sample of alleles from a natural population, has become the dominant paradigm for both theory and empirical analysis in population genetics over the past three decades (). Indeed the great efficiency of coalescent simulations, relative to forward-in-time population genetic simulations, allows researchers to perform statistical inference of population genetic parameters directly from simulations (e.g.). Such efforts have mostly focused on inferring demographic parameters such as population size histories or migration rates (e.g.), and accordingly the majority of coalescent simulation software has focused on being flexible with respect to the range of demographic histories they can model (). Increasingly, population genomics as a field has recognized the role that natural selection has played in shaping patterns of variation in natural populations (e.g.). The coalescent again provides a convenient framework for modeling the action of selection on population genetic samples. In particular good coalescent approximations to both selective sweeps () and balancing selection () have been described analytically. While that is so there are relatively few software packages that flexibly model the coalescent with selection; notable exceptions include msms () and mbs (). Here we introduce discoal, a coalescent simulator that incorporates genic selection in a flexible manner. discoal is able to simulate standard demographic events, such as population splits and mergers, instantaneous population size changes, admixture, and migration, along with selective sweeps that occur either at the locus sampled or in neighboring loci. discoal is further capable of simulating both hard and soft selective sweeps (), while conditioning on the fixation of the selected allele. In addition discoal simulates coalescent samples that are conditional on the fixation of a neutral mutation.