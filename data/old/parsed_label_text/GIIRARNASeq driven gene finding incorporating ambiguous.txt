Motivation: The reliable identification of genes is a major challenge in genome research, as further analysis depends on the correctness of this initial step. With high-throughput RNA-Seq data reflecting currently expressed genes, a particularly meaningful source of information has become commonly available for gene finding. However, practical application in automated gene identification is still not the standard case. A particular challenge in including RNA-Seq data is the difficult handling of ambiguously mapped reads. Results: We present GIIRA (Gene Identification Incorporating RNA-Seq data and Ambiguous reads), a novel prokaryotic and eukaryotic gene finder that is exclusively based on a RNA-Seq mapping and inherently includes ambiguously mapped reads. GIIRA extracts candidate regions supported by a sufficient number of mappings and reassigns ambiguous reads to their most likely origin using a maximum-flow approach. This avoids the exclusion of genes that are predominantly supported by ambiguous mappings. Evaluation on simulated and real data and comparison with existing methods incorporating RNA-Seq information highlight the accuracy of GIIRA in identifying the expressed genes.
INTRODUCTIONThe reliable annotation of genes as the regions encoding the basis for all processes in the cell is a key goal of genomic research. Hence, numerous studies focus on revealing the structure of genes and their controlling mechanisms to enhance the understanding of the functionality of proteins and their interactions (). Following the need for accurate gene prediction methods, various gene finders have been developed identifying genes either by genome sequence comparison, ab initio by using the genomic sequence alone, evidence based by integrating different kinds of additional external information (). Ab initio gene finders predict genes based on the presence of open reading frames (ORFs) in the genome and in case of eukaryotes identify intron-exon structures indicated by known splice sites (). Typically, these approaches are based on statistical or machine learning techniques such as Hidden Markov Models, and they require training data to evaluate the probability for each gene and gene structure (). In contrast to ab initio methods, evidence-based and comparative gene finders make use of additional external information to identify genes and their structures. Sources of information include EST libraries, messenger RNA or protein sequences. The external evidence is compared with the genome of interest to identify regions showing similarity to the given sequences (). Hybrid approaches, such as AUGUSTUS (), combine ab initio gene prediction with evidence from other sources to verify the predicted genes. For an overview on gene finding algorithms, the reader is referred to. Despite all efforts, gene identification still faces significant challenges handling complex gene structures, rare splice sites or mutations in genes (). These problems can be approached by using the knowledge available from high-throughput RNA-Seq experiments (). The transcriptome reflects the genes expressed in the current condition of the cell, which provides valuable information to identify novel genes or to confirm predicted genes. Although RNA-Seq experiments were included in several annotation studies (), so far only few gene finders directly incorporate RNA-Seq in gene prediction. Methods for gene expression analysis such as iReckon (), Cufflinks () and Erange () perform a transcript assembly on RNA-Seq reads and thereby allow the identification of exons and splice sites, but they do not predict reading frames and start and stop codon for genes. For an overview of transcriptome annotation, the reader is referred to. AUGUSTUS allows the integration of RNA-Seq experiments as an additional external source for eukaryotic gene identification (), whereas GeneMark () incorporates RNA-Seq evidence on prokaryotic gene predictions to identify operons. The gene finder G-Mo.R-Se () predicts gene models based on RNA-Seq reads, but does not identify mono-exonic genes and only incorporates non-ambiguous mappings. Because for instance repetitive or highly similar regions, or homologous genes lead to a substantial part of non-unique *To whom correspondence should be addressed. mappings, discarding ambiguously mapped reads from further analysis may result in a significant loss of prediction accuracy. To use the complete information contained in RNA-Seq experiments for gene identification, we developed a RNA-Seqbased de novo gene predictor called GIIRA (Gene Identification Incorporating RNA-Seq and Ambiguous reads) that works on a reference genome and reads derived in a RNA-Seq experiment. GIIRA is primarily focused on prokaryotic gene prediction and in particular resolves genes within the continuously expressed region of an operon. However, GIIRA can also be applied to predict genes and alternative transcripts for eukaryotes, and it leverages information from spliced reads for intron identification. Hence, it is also a useful addition to annotation pipelines, such as MAKER (), or a good complement to other eukaryotic gene finders. The identified transcripts are completed into gene models via a search for start and stop codons as well as reading frame and strand prediction. Based on the observed mapping coverage, GIIRA identifies candidate genes that are refined in further validating steps. Ambiguous reads are reassigned to their most likely origins using a maximum-flow approach formulated as a linear program. In contrast to other approaches to ambiguous read assignment, such as the expectation maximization-based strategy introduced in Chung et al. (2011) or ContextMap (), our approach can integrate information on the likelihood of a read alignment not only from a fixed context (interval of specified length) or a context solely based on the mapping. Instead, we directly incorporate the information gained in the process of identifying gene candidates and further the linear program ensures a convergence to an optimal solution. In principle, the general idea of the maximum-flow approach can also be applied to other questions related to ambiguity resolving. We validate the accuracy of GIIRA in three simulations and compare our approach with the widely used method Cufflinks as well as the gene finders GeneMark, GLIMMER3 () and AUGUSTUS. Finally, we apply GIIRA to two real datasets including $11 million reads from an Escherichia coli and $6 million reads from a Saccharomyces cerevisiae RNASeq experiment.
DISCUSSIONWe introduced GIIRA as a gene finder that identifies potential coding regions exclusively based on mapping of reads from an RNA-Seq experiment. Unlike other gene predictors, GIIRA also includes ambiguously mapped reads in the analysis, which improves on the prediction accuracy as demonstrated for various datasets with different levels of ambiguity. As shown in Section 4,Note: The highlighted numbers indicate the best results for each criterion for sensitivity and specificity for GIIRA with ambiguous reads, GIIRA without ambiguous reads (GIIRA_w/o), Cufflinks and AUGUSTUS. Note that in case of fuzzy sensitivity and specificity not only a perfect match but also a match in a range around the ground truth result is accepted.already a comparably small number of ambiguous reads can substantially contribute to the ambiguity of a mapping. Disregarding this information leads to a loss in sensitivity, e.g. for genes sharing homologous regions or present in high copy numbers (refer to Section 4.2, where including ambiguous reads enhanced the sensitivity of exon predictions by up to one-third). GIIRA accurately predicts the correct genes for prokaryotic transcripts as demonstrated in Section 4.1. It identifies the most likely set of genes explaining the expressed region using an alignment scoring adaptation coupled with a linear program formulation. In comparison with existing approaches capable of RNA-Seq integration, GIIRA has two major benefits: (i) it shows overall increased prediction accuracy and (ii) it predicts structural genes themselves rather than focusing on operons such as GeneMark or transcripts without indicating start and stop codons such as Cufflinks. Although GIIRA was primarily designed for prokaryotic gene prediction, it can also be applied to eukaryotic gene prediction as an addition to existing annotation pipelines or a complement to other gene finders. For eukaryotic genomes, the complexity of alternative splicing events poses a critical challenge because GIIRA does not work with splice graphs to combine exons, but evaluates each splice site independently from others. As illustrated in Section 4.2, compared with the other methods GIIRA is sensitive in predicting exons and transcripts. It also yields a high accuracy in predicting introns, but is less accurate in combining them to the correct intron-chain. For instance, a challenge arises for GIIRA if two alternative isoforms share an exon where one isoform ends with this exon and the other isoform proceeds with other exons. For GIIRA, both isoforms appear to be continued with other exons and it assigns an incorrect intronchain. Because Cufflinks uses a graph theory approach to evaluate splice sites, it is less affected by this phenomenon and on the intron-chain level it, hence, yields higher prediction accuracy than GIIRA. AUGUSTUS, as a hybrid gene predictor using non-ambiguous RNA-Seq mappings as external evidence, is less specific than the compared methods in regard to exon prediction but is superior in locus prediction. Because GIIRA is exclusively based on RNA-Seq information, it can only predict genes currently expressed in the organism of interest and thus does not necessarily provide a complete annotation of all encoded genes. GIIRA provides two frameworks to control the number of false-positive predictions: (i) to filter contaminants and sequencing artifacts and (ii) to verify the reported gene predictions. It can identify regions with an extremely large coverage compared with the average coverage to be sequencing artifacts or other errors such as contaminants. In case of the real E.coli dataset, this outlier identification filtered out most of the ribosomal RNA contaminants. Further, GIIRA reports additional information on coverage and ambiguous read support for each prediction. This enables an easy post-processing of the output allowing a trade-off of sensitivity and specificity adjusted to the intended follow-up analysis. Note that although GIIRA is independent from any a priori information, it is possible to use such information (if present) to improve the prediction accuracy. For instance, if a reference annotation is already available, different runs of GIIRA can be compared using the Cuffcompare framework to identify an optimal parameter setting.