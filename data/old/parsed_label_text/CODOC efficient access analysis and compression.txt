Current data formats for the representation of depth of coverage data (DOC), a central resource for interpreting, filtering or detecting novel features in high-throughput sequencing datasets, were primarily designed for visualization purposes. This limits their applicability in stand-alone analyses of these data, mainly owing to inaccurate representation or mediocre data compression. CODOC is a novel data format and comprehensive application programming interface for efficient representation, access and analysis of DOC data. CODOC compresses these data $4–32Â better than the best current comparable method by exploiting specific data characteristics while at the same time enabling more-exact signal recovery for lossy compression and very fast query answering times. Availability and implementation: Java source code and binaries are freely available for non-commercial use at http://purl.org/bgraph/codoc.
INTRODUCTIONDepth of coverage (DOC) data are one-dimensional discrete genomic signals describing the number of reads from a highthroughput sequencing (HTS) experiment covering each position in a reference genome. DOC is determined by traversing shortread alignments column-wise and counting the number of mapped reads overlapping with each individual position (i.e. its coverage). DOC is a primary source of information for the detection of structural variants where it is assumed that a gain/loss of genetic material results in increased/decreased coverage. The same fundamental assumption is exploited in RNA sequencing where estimated expression rates are calculated from normalized coverage signals. DOC also plays a central role in, e.g. identifying novel transcripts, characterizing the alternative splicing landscape of a sample or comparing multiple SNP-calling datasets where it is required to determine what genomic regions are sufficiently covered in all considered datasets to be comparable among each other (). Current data formatsBroad's tiled data file format, TDF, and UCSC's BigWig format ()were optimized for efficient display of DOC in genomic browsers but not for their stand-alone analysis. coverages) can be read from these external lists at decompression time (). This further reduces the number of required codewords while at the same time preserving (near-) exact DOC values at/close to variant positions. Blocked encoding and compression. Codewords are converted to byte representations using different encoders: chromosome identifiers are stored by standard RLE, position offsets by differential Golomb/Rice encoding (), and coverage values are stored unencoded. Eventually, all encoded bytes are additionally compressed by a general-purpose compression algorithm (gzip or bzip2). The data are then split into blocks (BITs) that contain a configurable maximum of codewords (100 000 by default), which enables efficient random access at decompression time. Decompression. Signal reconstruction is done by linear interpolation at neighboring key positions. Decompression starts by constructing an in-memory interval tree () of BITs and their byte offsets. When a particular genomic position is queried, CODOC consults this index and loads the BIT containing the queried position from disk, finds the key positions and their coverage values by binary search and reports the interpolated result. CODOC caches accessed BITs using a leastrecently used strategy to exploit spatial locality of queries to close genomic positions.