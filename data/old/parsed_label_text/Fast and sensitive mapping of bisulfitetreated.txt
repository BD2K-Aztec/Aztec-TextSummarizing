Motivation: Cytosine DNA methylation is one of the major epigenetic modifications and influences gene expression, developmental processes, X-chromosome inactivation, and genomic imprinting. Aberrant methylation is furthermore known to be associated with several diseases including cancer. The gold standard to determine DNA methylation on genome-wide scales is bisulfite sequencing: DNA fragments are treated with sodium bisulfite resulting in the conversion of unmethylated cytosines into uracils, whereas methylated cytosines remain unchanged. The resulting sequencing reads thus exhibit asymmetric bisulfite-related mismatches and suffer from an effective reduction of the alphabet size in the unmethylated regions, rendering the mapping of bisulfite sequencing reads computationally much more demanding. As a consequence, currently available read mapping software often fails to achieve high sensitivity and in many cases requires unrealistic computational resources to cope with large real-life datasets. Results: In this study, we present a seed-based approach based on enhanced suffix arrays in conjunction with Myers bit-vector algorithm to efficiently extend seeds to optimal semi-global alignments while allowing for bisulfite-related substitutions. It outperforms most current approaches in terms of sensitivity and performs time-competitive in mapping hundreds of millions of sequencing reads to vertebrate genomes. Availability: The software segemehl is freely available at
INTRODUCTIONCytosine DNA methylation is one of the major epigenetic modifications in eukaryotes (). The epigenetic modification pathways governing DNA methylation and histone modifications are strongly coupled with each other (). Hypermethylations in promotors of genes are associated with stable repression of its activity (as in case of * To whom correspondence should be addressed. X-chromosome inactivation) that can be maintained throughout cell divisions (). During mammalian development, methylation patterns are largely rearranged. In very early stages, methylation marks are erased to allow flexible short-term regulation by histone modifications, while wide-spread de novo methylations in later stages enable long-term silencing of pluripotency-related or imprinted genes (). In mammalian genomes, DNA methylation also ensures genomic integrity by inactivating and immobilizing transposable elements and hence preventing chromosomal instability, translocation, or gene disruption (). In cancer cells, this overall stable landscape of DNA methylations is heavily distorted by widespread and massive hypomethylations, e.g. in repetitive sequences, and by silencing of tumor-suppressor genes by hypermethylating their promotors (). Capturing DNA methylations on genome-wide scales in high resolution has become technically and economically feasible only with the advent of high-throughput sequencing (HTS) technologies. DNA methylations are commonly captured either by sequencing methylated DNA that was isolated by antibodies or proteins, as in methylated DNA immunoprecipitation () and methyl-CpG binding domain-based (MBD) isolated genome sequencing (), or by sequencing DNA reads treated with sodium bisulfite to selectively convert unmethylated cytosines to uracils (). Since the first approach merely enriches sequencing reads with methylation marks by pull down with antibodies or proteins, it is not possible to accurately pinpoint frequency, exact location, and sequence context of the modifications. The isolation procedure is further biased towards enrichment of highly methylated regions (). Sequencing techniques based on bisulfite treatment, on the other hand, facilitate single-base resolution, so that the methylation state of each single cytosine can be analyzed. Thus, they are capable of detecting intermediate methylation levels in heterogeneous samples or imprinted genes. One drawback of this method is the fact that hydroxymethylated cytosines, present in some mammalian cell types, cannot be distinguished from methylation marks after conversion with sodium bisulfite. The role of the hydroxymethylation is not yet known but it might be involved in demethylation or alterations of the chromatin structure (). Due to its high resolution and the possibility of unbiased genome coverage, bisulfite sequencing has been established as the 'gold. Possible read types (+FW, +RC, FW and RC) in bisulfite sequencing protocols. Methylated and unmethylated cytosines in the genomic sequence (left) are coloured in red and blue, respectively, and positions in the read sequences (right) derived from genomic cytosines are coloured correspondingly. Note that the intermediate conversion of unmethylated cytosines into uracils after bisulfite treatment is omitted standard' method to capture DNA methylation. In the earliest approach of this type, reduced representation bisulfite sequencing by, genomic regions with CpG dinucleotides are enriched by prior digestion with MspI. More recent protocols avoid this bias. Both methylC-seq () and BS-seq () are protocols for the construction of the bisulfitetreated libraries for HTS. They mainly differ in their amplification procedure: while methylC-seq involves only a single amplification, BS-seq uses two amplification steps to ensure only fully bisulfiteconverted sequences to be amplified and hence sequenced. In BS-seq, first, adapters containing unmethylated cytosines are ligated to the DNA fragment. After treatment with sodium bisulfite, the first amplification is performed using primers complementary to fully bisulfite-converted adapters, then digested with DnpI and again amplified using common Solexa adapters. This results in four different types of bisulfite reads: +FW and +RC from the plus strand and FW and RC from the minus strand (). In case of methylC-seq, only two of these read types (+FW and FW) may occur and are expected to be sequenced at similar rate. Beyond the extensive study ofas part of the UCSD Human Reference Epigenome Mapping Project, the methylomes of silkworm (), honey bee (); and Human peripheral blood mononuclear cells () have been analyzed by means of bisulfite sequencing. Moreover, this technology has been applied to identify methylation variations in epigenetic domains across cancer types (). Standard DNAseq mapping algorithms may run into problems when dealing with the potentially high number of converted cytosines in bisulfite sequencing reads: the bisulfite conversion causes a large number of mismatches between read and reference genome that should not be penalized. The asymmetry of the resulting matching rule, i.e. a genomic cytosine should match a thymine in the read but not vice versa, complicates the issue. Early bisulfite mapping methods used very time-consuming strategies. BSMAP (), for instance, iterates over all possible C/T conversions, CokusAlignment () uses an exhausting tree search with base probability vectors. More recent methods either allow for asymmetric bisulfite-related mismatches, typically implemented by means of hash-tables as in MAQ () and RMAP (), or use a collapsed alphabet so that the asymmetry is disregarded altogether. In the latter type of methods, each cytosine is converted to a thymine (or guanine to adenine to match the minus strand) in the reads and in the genomic sequence. Both BS Seeker () and Bismark () use Bowtie (to map the converted strings using different alignment policies. The resulting alignments are then post-processed to recover the methylated positions. None of the available tools can account for insertions and deletions (indels) in the read alignment. This is a major drawback since indels are known to be the predominant error type in 454 sequencing data and small indels contribute significantly to the genetic variation in human (). Overall, currently available bisulfite mappers may not be able to cope with higher error rates potentially caused by erroneous PCR clones, low-quality reference genomes, extensive allelic variations, or mapping to the genome of a closely related organism. For example, the amphioxus genome exhibits substantial allelic variation with 3.7% SNPs and 6.8% polymorphic indels (). In the Ciona intestinalis, another important model organism, the average SNP rate is 1.2% but the variations are not uniformly distributed and locally increase to 1015% within windows of 100 nt (). segemehl is an efficient read mapping tool based on suffix arrays that readily accommodates indels using an extended version of the matching statistics (). In this study, we demonstrate that the mapping of bisulfite sequencing data can be incorporated into the framework using a hybrid approach that combines seed searches in the suffix array on a collapsed alphabet with optimal semi-global alignments around seed matches using a specialized extension of Myers bit-vector algorithm.