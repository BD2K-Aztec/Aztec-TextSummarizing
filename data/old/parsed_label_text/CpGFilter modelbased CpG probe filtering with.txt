The development of the Infinium HumanMethylation450 BeadChip enables epigenome-wide association studies at a reduced cost. One observation of the 450K data is that many CpG sites the beadchip interrogates have very large measurement errors. Including these noisy CpGs will decrease the statistical power of detecting relevant associations due to multiple testing correction. We propose to use intra-class correlation coefficient (ICC), which characterizes the relative contribution of the biological variability to the total variability, to filter CpGs when technical repli-cates are available. We estimate the ICC based on a linear mixed effects model by pooling all the samples instead of using the technical replicates only. An ultra-fast algorithm has been developed to address the computational complexity and CpG filtering can be completed in minutes on a desktop computer for a 450K data set of over 1000 samples. Our method is very flexible and can accommodate any replicate design. Simulations and a real data application demonstrate that our whole-sample ICC method performs better than replicate-sample ICC or variance-based method. Availability and implementation: CpGFilter is implemented in R and publicly available under CRAN via the R package CpGFilter.
IntroductionRecent advances in genomic technologies have enabled researchers to conduct large-scale studies of human disease-associated epigenetic variation, specifically variation in DNA methylation. Such epigenome-wide association studies (EWAS) have helped elucidate the non-genetic determinants of human disease (). The Illumina Infinium HumanMethylation450 Beadchip, which interrogates the methylation level of more than 450K CpG sites throughout the human genome, has been increasingly popular in large-scale EWAS due to its good genome coverage, high reproducibility and lower cost (Sandoval). One observation of the 450K data is that many CpGs have relatively larger technical variability compared with their biological variability, which are results of either large absolute technical variability (the methylation level cannot be measured accurately) or lower biological variability (many CpGs are constitutively methylated or unmethylated). These CpGs are less informative and including these CpGs will reduce the statistical power to discover relevant CpG sites by unnecessarily increasing the number of statistical tests. Hence, CpG filtering could potentially boost statistical power for underpowered studies. Traditional variance-based CpG filter is based on the total variability, which is the sum of the biological variability (signal) and technical variability (noise). However, we are more interested in retaining CpGs with relatively large biological variability instead of total variability. As with any hybridization-based array technology, CpG probes differ in their technical variability, possibly due to inexact probe sequence match, crosshybridization and local secondary structures (). Therefore, large total variability does not necessarily reflect large biological variability. Without technical replicates, the assessment of technical variability is difficult and we can only rely on the total variability to filter CpGs. Fortunately, most EWAS have included some technical replicates to assess various sources of batch effects. We can therefore use these replicates to assess technical variability. We propose to use intra-class correlation coefficient (ICC), which is defined as the ratio of biological variability to total variability, to filter CpG probes ()the method using technical replicates only, our method can result in more efficient ICC estimate since the unreplicated samples provide significant amount of information about the biological variability. Our method can accommodate any type of replicate design including unbalanced design. We have implemented an ultra-fast algorithm to fit LMM in linear computational time and the algorithm is highly scalable.