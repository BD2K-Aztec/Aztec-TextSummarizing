The program package CopyMap identifies copy number variation from oligo-hybridization and CGH data. Using a time-dependent hidden Markov model to combine evidence of copy number variants (CNVs) across multiple carriers, CopyMap is substantially more accurate than standard hidden Markov methods in identifying CNVs and calling CNV-carriers. Moreover, CopyMap provides more precise estimates of CNV-boundaries. Availability: The C-source code and detailed documentation for the program CopyMap is available on the Internet at
INTRODUCTIONCopy number variants (CNVs) are segments of the genome that exist in different copy numbers in the population. About 90% of CNVs have two allelic states (), the remaining 10% have multiple states. As CNVs encompass genes as well as non-coding DNA, they are good candidates for functional variation (). Commonly used method for identifying copy number variable sites are Representational Oligonucleotide Microarray Analysis (), Agilent competitive genomic hybridization (CGH) () and tiling arrays (). These methods interrogate DNA using a dense set of probes covering the non-repetitive regions of the genome. However, the resolution of each individual probe is usually low. As CNVs often extend over multiple probes, resolution is improved by combining information across neighboring probes. Hidden Markov model (HMM) methods are among the most commonly applied tools to analyze such data. First proposed by, these methods exploit the local correlation of trait status and are computationally highly efficient. More complex versions of these algorithms specifically designed for CNVs have since been developed () and applied to large datasets (). However, most HMM algorithms analyze datasets one individual at a time. Thus, CNVs that are shared among individuals are only identified after comparing CNV calls between individuals. Conceptually, this approach has two disadvantages: first, no detection power is gained by the fact that multiple individuals carry the same CNV. In most regions of the genome, CNVs are rare or absent and therefore models assign a low probability of transitioning into the CNV state. However, at a locus known to have variable copy number in one individual, the probability that another individual has a variant copy number at the same locus should be higher. Jointly analyzing individuals results in a higher detection rate. Secondly, each time a CNV is identified, its borders will be estimated independently of all other individuals. Jointly estimating the borders from all carriers results in a more efficient use of information. This idea has been applied in several recent methods for mapping CNVs in selected regions from genotyping data (). I present the program CopyMap, an alternative HMM method for CNV detection and CNV calling that jointly analyzes genomewide data for all individuals in a sample. CopyMap is specifically designed for hybridization arrays, but it can also be applied to single nucleotide polymorphism genotyping arrays.
DESCRIPTIONCopyMap models a hidden Markov process, where the copy number at each probe has one of three hidden states (baseline, duplication and deletion) and the hybridization intensity of that probe is the observed signal. The program uses an expectation maximizationalgorithm similar to the classical BaumWelch algorithm to infer the location of CNVs. CopyMap has two novel features. Location-dependent transition rates: uniform transition rates used by classic HMMs model each locus in the genome to be equally likely as a starting and end point of a CNV. CopyMap models the process of generating CNVs in the sample as a time-dependent Markov process and each individual in the sample as a realization of this process. The rate of transitioning into CNV state is estimated between every consecutive pair of probes jointly from all individuals and can be considered as the population frequency of a CNV starting at that locus. Hence, regions that show evidence for CNVs in some individuals will be identified by a higher transition rate from the baseline to the CNV state, combining the evidence for that region to be copy variable across all individuals. Markov-k process: individual probes of most arrays do not provide sufficient information to call CNVs and short inferred CNVs are often false positives. Therefore, it is a common practice to filter all called CNVs, removing CNVs spanning less than k probes, with k between 5 and 10. These filters are usually applied post hoc after all modeling parameters were estimated. Hence, parameter estimates are including likely false signals. In contrast, I allow the user to initially set a minimum length k for CNV. Implementing a Markov-kmodel, the transition probabilities depend on the last k states rather than just on the present state. By restricting the transition matrix, the computation time for this process is designed to be linear with k, rather than quadratic as typical Markov-k models. The program implements two methods for calling CNVs. Either a Viterbi algorithm or a heuristic to identify regions with high overall evidence for variable copy number and to then estimate the posterior probability for copy number for each individual in that region. Technical details of this algorithm are described elsewhere ().