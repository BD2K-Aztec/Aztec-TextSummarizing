Motivation: The ability to accurately measure structural similarities among small molecules is important for many analysis routines in drug discovery and chemical genomics. Algorithms used for this purpose include fragment-based fingerprint and graph-based maximum common substructure (MCS) methods. MCS approaches provide one of the most accurate similarity measures. However, their rigid matching policies limit them to the identification of perfect MCSs. To eliminate this restriction, we introduce a new mismatch tolerant search method for identifying flexible MCSs (FMCSs) containing a user-defin-able number of atom and/or bond mismatches. Results: The fmcsR package provides an R interface, with the time-consuming steps of the FMCS algorithm implemented in Cþþ. It includes utilities for pairwise compound comparisons, structure similarity searching, clustering and visualization of MCSs. In comparison with an existing MCS tool, fmcsR shows better time performance over a wide range of compound sizes. When mismatching of atoms or bonds is turned on, the compute times increase as expected, and the resulting FMCSs are often substantially larger than their strict MCS counterparts. Based on extensive virtual screening (VS) tests, the flexible matching feature enhances the enrichment of active structures at the top of MCS-based similarity search results. With respect to overall and early enrichment performance, FMCS outperforms most of the seven other VS methods considered in these tests. Availability: fmcsR is freely available for all common operating systems from the Bioconductor site
INTRODUCTIONThe development of computational methods for detecting and quantifying structural similarities among small molecules is an area of intensive research in drug discovery and chemical genomics. The effort is largely driven by the observation that many structurally related compounds share similar bioactivity and physicochemical properties (). Maximum common substructure (MCS) approaches are commonly used to identify the largest substructure (subgraph) shared among two compounds (). MCS is a pairwise graph matching concept that differs fundamentally from the structural descriptor-based methods, but its results (e.g. size of MCS relative to source structures) can be used for the computation of related similarity coefficients. Compared with descriptor-based similarity methods, MCS approaches generate chemically more meaningful search results by pinpointing the common features within the structure of two compounds. They also provide the most efficient method for identifying local structural similarities and similarities among compounds with large size differences (). With the exception of bond mismatches, existing MCS search algorithms can only identify MCSs that are perfect substructure matches in two compounds of interest. Extending this strict matching scheme to one that tolerates mismatches among atoms and/or bonds facilitates the identification of larger flexible MCSs (FMCSs) than their strict MCS counterparts, resulting in a more complete description of the similarities among two compounds. Here we introduce such a FMCS algorithm that allows both mismatches of atoms and/or bonds in the identified MCSs. When the flexible matching feature is enabled, the user can identify more complex and subtle similarity patterns among two structures than is possible with strict MCS algorithms (). For instance, two molecules may share a larger imperfect MCS that is disrupted by a substitution of a small number of atoms. Strict MCS algorithms will identify in these cases only the largest invariant subcomponent(s), while the FMCS algorithm will often find a much larger, but partially imperfect MCS (). This has various advantages for practical applications in small molecule discovery, such as the prediction of bioactive compounds, scaffold identification in screening libraries or assignment of metabolic compounds to enzymatic steps in pathways.