Motivation: Genome-wide association studies revealed that most disease-associated single nucleotide polymorphisms (SNPs) are located in regulatory regions within introns or in regions between genes. Regulatory SNPs (rSNPs) are such SNPs that affect gene regulation by changing transcription factor (TF) binding affinities to genomic sequences. Identifying potential rSNPs is crucial for understanding disease mechanisms. In silico methods that evaluate the impact of SNPs on TF binding affinities are not scalable for large-scale analysis. Results: We describe affinity testing for regulatory SNPs (atSNP), a computationally efficient R package for identifying rSNPs in silico. atSNP implements an importance sampling algorithm coupled with a first-order Markov model for the background nucleotide sequences to test the significance of affinity scores and SNP-driven changes in these scores. Application of atSNP with 20 K SNPs indicates that atSNP is the only available tool for such a large-scale task. atSNP provides user-friendly output in the form of both tables and composite logo plots for visualizing SNP-motif interactions. Evaluations of atSNP with known rSNP-TF interactions indicate that atSNP is able to prioritize motifs for a given set of SNPs with high accuracy. Availability and implementation: https://
IntroductionGenome-wide association studies have been instrumental in identifying single nucleotide polymorphisms (SNPs) associated with large numbers of phenotypes. The vast majority of association SNPs are in non-coding regions, suggesting that they may have regulatory roles in deriving the phenotype (). In particular, regulatory SNPs which alter binding affinity of transcription factors and affect gene expression constitute an important class of such SNPs (). A standard in silico approach for identifying rSNPs is by evaluating how the SNP-driven nucleotide change impacts binding affinity of TFs to the region surrounding the SNP (). Specifically, the DNA sequences around each SNP are scored against a library of TF motifs with both the reference and the SNP alleles using position weight matrices (PWMs) () of the motifs. SNPs with significantly different scores between the reference and SNP alleles are then hypothesized as rSNPs. We describe atSNP, an R package that carries out the following tasks for every SNP-motif combination of the input data after extracting genome sequences of small windows (630 bps) around the SNP positions: (i) computing affinity scores for both alleles; (ii) statistical testing for allele-specific affinity scores; (iii) statistical testing for changes in affinity scores between alleles. A few existing tools can perform various subsets of these tasks (). The most distinctive feature of atSNP is its ability to accommodate large scale analysis (e.g. over  20 K SNPs). is-rSNP has the most similar functionality to atSNP; however, is-rSNP (both 1.0 and 2.0) can onlyanalyze at most 20 SNPs at a time. Similarly, TRAP takes as input only one SNP. Although rSNP-mapper can take as input larger number of SNPs, it lacks critical calculations such as the significance of SNP-driven affinity change. FIMO is not designed for evaluating SNP impact on affinity scores; however, it enables P-value computation for affinity scores and can be used to compare scores under different alleles. However, due to computational reasons, FIMO can only accommodate outputting results thresholded by a small prespecified significance level for large SNP sets. In our hands with a 24 AMD Opteron 2.2 GHz processor, a FIMO run for 26 100 SNPs against a single PWM without thresholding could not finish within 24 hours whereas atSNP required less than 5 minutes. The main computational burden of both FIMO and is-rSNP is the computation of the exact P-values by enumerating all possible sequences and computing their scores under the null hypothesis. atSNP utilizes an importance sampling technique to overcome this challenge (Supplementary Materials).