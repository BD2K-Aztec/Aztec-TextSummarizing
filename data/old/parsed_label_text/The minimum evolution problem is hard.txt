Motivation: Distance methods are well suited for constructing massive phylogenetic trees. However, the computational complexity for Rzhetsky and Neis minimum evolution (ME) approach, one of the earliest methods for constructing a phylogenetic tree from a distance matrix, remains open. Results: We show that Rzhetsky and Neis ME problem is NP-complete, and so probably computa-tionally intractable. We do this by linking the ME problem to a graph clustering problem called the quasi-clique decomposition problem, which has recently also been shown to be NP-complete. We also discuss how this link could potentially open up some useful new connections between phylo-genetics and graph clustering.
IntroductionOne of the earliest distance-based approaches introduced to construct a phylogenetic tree is the minimum evolution (ME) method. It was first suggested by Kidd and Sgaramella-Zonta (1971) and consists of two main steps: First branch lengths are assigned to tree topologies based on a distance matrix, and then a topology is selected which minimizes the sum of the branch lengths. There are several variants of this approach which are reviewed in e.g.and Desper and Gascuel (2005). Although model-based tree construction methods, such as likelihood and Bayesian approaches, are tending to supersede distance-based methods in the literature, ME methods still remain popular. This is in part due to the fact that large-scale sequencing applications such as metagenomics involve constructing massive trees for which distance-based methods are well suited (see e.g.. In this article, we are interested in the ME approach introduced by. This is based on ordinary least squares (OLS) estimates of branch lengths, served as a motivation for the neighbor-joining method (), and is implemented byin the popular FastME software. It is commonly believed that, just as the optimization problems arising from the parsimony () and the likelihood () approaches, this version of the ME method also leads to an NP-complete problem and, so, is probably computationally intractable. However, even though this has been stated to be the case in some of the literature (probably because tree construction based solely on OLS for integer branch lengths is), to our best knowledge this fact has not been formally proven. It should also be noted, however, that the closely related and more recently introduced balanced ME (BME) problem ()in which branch lengths are estimated by a special case of weighted least squares ()has been shown to be NP-complete ().Here, we shall show that the ME problem is NP-complete for trees with integer branch lengths. In particular, to prove our main result, we show that the ME problem is closely related to the so-called quasiclique decomposition problem, a special example of a graph clustering problem (see, e.g.) which has recently been shown to be NP-complete by. We believe that the link that we describe could open up some interesting and useful new connections between the fields of phylogenetics and graph clustering (), a burgeoning area with several applications including pedigree construction () and community structure detection (). The rest of the article is organized as follows. In the next section, we show that certain OLS weightings for trees relative to a distance matrix are related to clique properties in a graph that can be associated to the distance matrix. In the following section, we then show that a rooted version of the ME problem is NP-complete, and explain how a technique used in Day (1987) can be used to show that the ME problem is NP-complete (we provide the full proof for this in the Supplementary appendix as it is quite technical in nature). In the last section, we discuss a link between phylogenetics and graph clustering which arises from our approach to the ME problem, and some possible future directions.
DiscussionTo prove that the ME problem is NP-complete, we first showed that the UME problem is NP-complete by relating it to the semi-clique decomposition problem. Interestingly, this is a special example of a more general link between tree inference and graph clustering problems. In particular, we can link the following two types of problem for a set X:i. Given a distance matrix D on X and a tree scoring function r D on the set T X of all rooted X-trees, find a tree that optimizes r D. ii. Given a graph G with vertex set X and a cluster scoring function j G : P X ! R that assigns to each partition in the set P X of all partitions of X a real number j G , find a partition of X that optimizes j G .More specifically, this correspondence is obtained by restricting any given tree inference problem to the set of rooted trees in T X where every leaf is adjacent to a vertex that is adjacent to the root (the tree in, for example, has this structure), to edge weightings that assign to every edge weight 1 and to distance matrices that have only off-diagonal entries that are 2 or 4. In this restricted type of rooted tree, every vertex u adjacent to the root induces a cluster of elements in X (namely the leaves that are adjacent to u) and, clearly, for every partition P of X there exists a unique such tree T P that induces precisely the clusters in P. Thus, given any graph G with vertex set X and the distance matrix D  D G on X which is induced by G, we obtain the cluster scoring function j G from the scoring function r D by putting j G P  r D T P . To give another example of this correspondence, consider the L 1-fit problem (see, e.g.). In this problem, given a distance matrix D the aim is to find a rooted X-tree T which minimizes the score r D T  which is equal to the minimum of X x;y2X jDx; y  D x x; yj taken over all weightings x of T. For this example, the corresponding graph clustering problem is known as the correlation clustering problem () where the cluster scoring function j G assigns, for a given graph G with vertex set X, to any partition P in P X the number of 2-element subsets (i.e. edges)(a) A rooted graph theoretical tree T with root q and leaf set X  fx 1 ; x 2 ;. .. ; x 9 g. For the edge weighting x that assigns weight 1 to every edge of T , the shortest path distance Dxx2; x5  4. (b) A graph G with vertex set X  fx1; x2;. .. ; x9g that is partitioned into the clusters C 1 , C 2 and C 3 indicated by the shaded boxes e  fu; vg of X that violate P, that is, either e is an edge of G but u and v do not lie in the same cluster in P or e is not an edge of G but u and v both lie in the same cluster of P. For the partition P  fC 1 ; C 2 ; C 3 g of the graph G in, for example, this cluster scoring function yields a score of 4. It is not hard to check that the L 1-fit of the tree infor the distance matrix D G derived from the graph G is 4 too. Note that minimizing the cluster scoring function corresponding to the L 1-fit is equivalent to computing the minimum number of edge deletions and insertions that suffice to transform G into a disjoint union of complete graphs. When adopting this latter view, correlation clustering is usually referred to as cluster editing (see, e.g. B cker et al., 2011). It would be interesting to explore which tree inference problems are related in a similar way to other graph clustering problems, and conversely. This could yield useful new insights into these inference problems, and possibly new algorithms for their solution or approximation.