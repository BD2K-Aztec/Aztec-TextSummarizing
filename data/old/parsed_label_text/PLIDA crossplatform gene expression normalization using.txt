Motivation: Gene expression data are currently collected on a wide range of platforms. Differences between platforms make it challenging to combine and compare data collected on different platforms. We propose a new method of cross-platform normalization that uses topic models to summarize the expression patterns in each dataset before normalizing the topics learned from each dataset using per-gene multiplicative weights. Results: This method allows for cross-platform normalization even when samples profiled on different platforms have systematic differences , allows the simultaneous normalization of data from an arbitrary number of platforms and, after suitable training, allows for online nor-malization of expression data collected individually or in small batches. In addition, our method outperforms existing state-of-the-art platform normalization tools. Availability and implementation: MATLAB code is available at
INTRODUCTIONMicroarray platforms differ from one another in their manufacture, labeling methods, hybridization procedures, number of probes per gene, probe length and probe sequences. Although these characteristics can affect the dynamic range, precision and accuracy of the resulting gene expression measurements, the major modern probe-based microarrays (e.g. Affymetrix, Agilent, Applied Biosystems (ABI) and Illumina) provide data of similar quality, so long as they are normalized appropriately (). However, even microarrays from the same provider can differ in the probes used to target specific genes, and these differences can lead to systematic differences in the relationship between their target abundance and the measured probe intensity (). The presence of these platform effects is well known and often acknowledged by the admission that gene expression levels are measured in arbitrary units. However, because most comparisons in gene expression levels are done on a pergene basis among samples from the same platform, these platform-specific biases have limited impact and can be safely ignored. However, quantitative comparisons between gene expression datasets from different microarray platforms benefit from correcting these biases (). Given the significant cost of collecting and analyzing human tissue, there are significant benefits to attempting to combine gene expression measurements from multiple studies to increase statistical power or provide a broader overview of disease. The most straightforward method of cross-platform normalization is to standardize the expression of each gene to have the same center (using the median or the mean) and the same variance on the different platforms using a gene-specific affine transform. This method has the advantage of being fast, easy and having no parameters to tune, but it does not work as well as more complex normalization methods on supporting, for example, estrogen receptor (ER) status prediction by integrating data across platforms (). Of the many different cross-platform normalization methods that were compared in a recent review by, distanceweighted discrimination (DWD) and cross-platform normalization were identified as superior choices. Cross-platform normalization () consists of a two-step procedure. In the first step, k-means clustering is used to find blocks of similar genes and samples across the platforms. Then, within each block, cross-platform normalization fits a combination of additive and multiplicative weights to normalize the data between platforms within this block. This process is done multiple times and the results from each run are averaged together to account for various possible clustering patterns. Their article reported the ability of cross-platform normalization to significantly increase the ability to use data collected on one platform as training data to predict ER status in breast cancer samples collected on a second platform. DWD () consists of finding the direction that best separates the data from the two platforms in log-vector space and then translating data from each platform along that direction until the data from each platform overlaps. Implicit in DWD's formulation is the assumption that gene expression data are log-normally distributed [c.f. Rocke and] because it is based on linear discriminant analysis, and that platform differences are the only systematic differences between the two datasets are separated. *To whom correspondence should be addressed Despite this existing work, there are still unsolved problems in cross-platform normalization. One is normalizing data collected on more than two platforms. Although it is possible to chain cross-platform normalization steps together, it is not clear what effect multiple normalization steps will have on the data and what the preferred chaining strategy (tree-based or linear) should be. Another unaddressed problem in cross-platform normalization is 'online use'; in other words, normalizing data using a normalization function learned from a previously collected dataset. Online normalization would be useful, for example, for applying a gene signature derived from another platform to new gene expression profiles where the cross-platform normalization was previously defined using a calibration dataset. We are also interested in addressing use cases where crossplatform normalization is applied among heterogeneous datasets that differ in their sample composition. Many methods (including DWD but not cross-platform normalization) assume that systematic differences between datasets are because of platform effects and can 'over-normalize' by removing all systematic expression differences between the two datasets, including those due to differences in the samples represented. For example, breast cancer datasets can differ in their expression subtype composition and in these cases, over-normalization would interfere with gene signature construction on integrated datasets. Overnormalization can also interfere with the use of cross-platform normalization in computational purification in which expression profiles of normal tissue are used to try to remove the impact of normal tissue contamination in tumor expression profiles (). One way of dealing with heterogeneity between datasets is to assume that the variation is found in a low-dimensional subspace of the dataspace, using dimensionality reduction techniques such as Principal Components Analysis (PCA). Dimensionality reduction is often used when analyzing gene expression data from multiple platforms. For example,use dimensionality reduction to summarize gene expression measurements on multiple platforms of the same samples, but they do not attempt to make measurements on different platforms comparable. However, because gene expression analysis measures the quantity of messenger RNA transcripts for a particular gene, it is ultimately measuring a non-negative quantity. This makes topic models, such as the latent Dirichlet allocation (LDA) (), particularly appropriate. LDA models count observations as coming from a convex combination of multinomial distributions and has been used previously for analysis of gene expression data ().
DISCUSSIONGene expression data provide an inexpensive and high-resolution snapshot of cellular state, but comparison and use of gene expression profiles collected on different platforms and technologies remain difficult. Methods of cross-platform normalization have already been developed but have limitations that make them unsuitable for some desired uses of gene expression data. We developed PLIDA to provide a cross-platform normalization tool to overcome these limitations, allowing the greater use of platform-varied gene expression data. Specifically PLIDA is capable of normalizing gene expression data collected on different platforms even when there are systematic differences between the samples on each platform. It does this by finding a low-dimensional topic model representation of the data, and then normalizing this topic model across platforms. This allows for the integration of more datasets than cross-platform normalization methods that assume that all differences between experiments are solely due to the platform. PLIDA is also capable of online use, by learning platform adjustment weights using existing data and then applying these weights to data collected in the future. This allows data collected on different platforms to be used to train classifiers for data that have not been observed at the time of normalization, as when a biomarker signature is used in the clinic. Finally, PLIDA is capable of normalizing an arbitrary number of platforms simultaneously.