Motivation: RNA-seq technology has been widely adopted as an attractive alternative to microarray-based methods to study global gene expression. However, robust statistical tools to analyze these complex datasets are still lacking. By grouping genes with similar expression profiles across treatments, cluster analysis provides insight into gene functions and networks, and hence is an important technique for RNA-seq data analysis. Results: In this manuscript, we derive clustering algorithms based on appropriate probability models for RNA-seq data. An expectation-maximization algorithm and another two stochastic versions of expectation-maximization algorithms are described. In addition, a strategy for initialization based on likelihood is proposed to improve the clustering algorithms. Moreover, we present a model-based hybrid-hierarchical clustering method to generate a tree structure that allows visualization of relationships among clusters as well as flexibility of choosing the number of clusters. Results from both simulation studies and analysis of a maize RNA-seq dataset show that our proposed methods provide better clustering results than alternative methods such as the K-means algorithm and hierarchical clustering methods that are not based on probability models. Availability and implementation: An R package, MBCluster.Seq, has been developed to implement our proposed algorithms. This R package provides fast computation and is publicly available at http://www. r
INTRODUCTIONNext-generation sequencing (NGS) technologies have revolutionized studies of genome structure, gene expression and epigenetics (). One important application of NGS technologies is in the study of gene expression by measuring messenger RNA levels for all genes in a sample. This technology is called RNA-seq, and several reviews have described this nascent technology (). Here we briefly describe how RNA-seq data can be generated. The complete set of messenger RNA molecules are first extracted from a sample and converted to a library of short complementary DNA fragments. Then these fragments are sequenced simultaneously by NGS technology. The resulting millions of short sequences, which are commonly called reads, are then aligned to a reference genome or reference transcripts. Gene expression is measured by the enumeration of reads mapped to each gene where the gene can be defined as a collection of exons or other appropriate definitions given the context of a study (). The resulting RNA-seq data are essentially digital signals that can be used to quantify levels of gene expression (). This differs from microarray technologies that measure gene expression by fluorescence intensities detected from hybridized samples. Inescapable factors such as cross-hybridization, secondary structure of the DNA and technical challenges associated with fluorescent detection used in microarray analysis limit both the sensitivity and dynamic range. Compared with microarray technologies, NGS technologies permit quantitative measures of gene expression over a much larger dynamic. These advantages have rapidly accelerated the adoption of the NGS technologies in studies of gene expression and present new challenges to data analysis. In the pioneering studies using RNA-seq, only two treatment groups were analyzed (). More recently, RNA-seq experiments that examined multiple treatment groups have been published. For example,carefully selected a developing leaf from a corn plant that captures multiple stages of photosynthetic differentiation. They exploited Illumina sequencing technologies to profile gene expression from four representative sections of the leaf blade. One major goal of this study was to survey gene expression profiles along different developmental stages to gain understanding of the transcriptional network associated with the development of C4 photosynthesis. In this endeavor, cluster analysis is an important tool as it often reveals groups of genes with similar expression patterns, where genes within such groups tend to be functionally related.took a heuristic approach by applying the K-means algorithm to partition log-transformed data for the differentially expressed genes. The K-means algorithm starts from an initial partition of the objects (genes) and proceeds by iteratively calculating the centers (means) of clusters and reassigning each object to the closest cluster according to some measurement of distance such as Euclidean distance. This iteration continues until no more reassignments take place. Although this heuristic approach is easy to implement, its *To whom correspondence should be addressed  The Author 2013. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com performance was not evaluated for RNA-seq data analysis. Studies of clustering algorithms with microarray data revealed that heuristic algorithms performed worse than model-based algorithms (). Surprisingly, there has been few published statistical research to examine cluster analysis of RNA-seq data, although it is urgently needed due to the huge amount of data being generated. Model-based algorithms for microarray data are based on finite mixture of normal distributions and cannot be directly applied to RNA-seq data that are discrete counts and often skewed. RNA-seq data have been modeled using Poisson () or negative binomial (NB) distributions (). Witten (2011) describes a hierarchical clustering method to cluster samples (experimental units) based on the RNA-seq data of all genes within each sample using Poisson model and dissimilarity measure based on likelihood ratio statistics. Often the case, as in, clustering gene expression profiles is of interest. In this article, we aim to cluster genes based on the differential expression patterns across treatments using modelbased statistical methods. In other words, we are interested in grouping genes that share the same or similar expression foldchanges with respect to the mean expression level across all treatments. To do this, we derive model-based clustering algorithms for cluster genes based on either Poisson or NB models for RNA-seq data, and we evaluate the performance of the modelbased approach and heuristic algorithms including the K-means method to cluster genes. We describe the Poisson and NB distributions in Section 2 and show how our model-based clustering method handles both probability models in a unified fashion. We present an expectation-maximization (EM) algorithm for estimating the model parameters and cluster membership in Section 3.1. In addition, a model-based initialization algorithm is proposed in Section 3.2 to reduce the dependence on the initialization. We also describe two stochastic versions of EM algorithms in Section 3.3 that are intended to reduce the chance of being trapped at local solutions. A model-based hierarchical algorithm is proposed in Section 3.4 to generate a hierarchical structure of the clusters and allow more flexibility of choosing cluster numbers. In Section 4, we simulate data and compare the proposed method with others using three commonly used criteria: sensitivity, specificity and mutual information (MI) (). In Section 5, we apply the model-based method to the data fromand evaluate our results by comparing the clusters with gene annotations. We summarize in Section 6 that our results from extensive simulation studies and an analysis of an RNA-seq dataset all show that our proposed method outperforms alternative methods, namely, the K-means algorithm and self-organizing map (SOM) ().
DISCUSSIONIn this article, we derived clustering algorithms based on finite mixture of Poisson or NB models. We proposed an EM algorithm with model-based initialization, and show this initialization method greatly improves the performance of the EM clustering. Compared with heuristic algorithms such as K-means method, our method has the following advantages: First, we build our approach of clustering RNA-seq data based on more appropriate probabilistic models such as Poisson and NB distributions. Owing to the nature of RNA-seq technology, the observed count data are discrete and skewed. Poisson model has been shown to fit well to data without biological replicates () and NB model to data with biological replicates (Anders and(b)