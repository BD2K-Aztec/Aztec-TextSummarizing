Motivation: DNA methylation is a heritable modifiable chemical process that affects gene transcription and is associated with other molecular markers (e.g. gene expression) and biomarkers (e.g. cancer or other diseases). Current technology measures methylation in hundred of thousands, or millions of CpG sites throughout the genome. It is evident that neighboring CpG sites are often highly correlated with each other, and current literature suggests that clusters of adjacent CpG sites are co-regulated. Results: We develop the Adjacent Site Clustering (A-clustering) algorithm to detect sets of neighboring CpG sites that are correlated with each other. To detect methylation regions associated with exposure, we propose an analysis pipeline for high-dimensional methylation data in which CpG sites within regions identified by A-clustering are mod-eled as multivariate responses to environmental exposure using a generalized estimating equation approach that assumes exposure equally affects all sites in the cluster. We develop a correlation preserving simulation scheme, and study the proposed methodology via simulations. We study the clusters detected by the algorithm on high dimensional dataset of peripheral blood methylation of pesticide applicators. Availability: We provide the R package Aclust that efficiently implements the A-clustering and the analysis pipeline, and produces analysis reports. The package is found on
INTRODUCTIONMethylation is a heritable and modifiable chemical process by which, most often, a methyl group attaches to a cytosine base that is followed by guanine on the same DNA strand (CpG dinucleotide, or CpG site). It is sensitive to environmental exposure, such as smoking, air pollution and chemicals (). Modern arraybased platforms measure methylation in hundreds of thousands of CpG sites, and sequencing methods measure methylation in millions of sites. Methylation is often measured as a continuous variable known as a value, representing the proportion of methylated CpG sites out of the total in the measured tissue. Interestingly, sets of related-by-location CpG sites, whether associated with a gene or not, may be jointly affected by environmental exposure. It is of interest to identify such sets of CpG sites that are affected by an exposure in a computationally efficient and quick manner. Methylation occurs throughout the genome, and it differs between tissues and cell types. Although it is known that methylation is associated with the control of genes, the mechanisms are still debated (). The distribution of CpG sites varies across the genome. Areas densely populated with CpG sites are called CpG islands. CGIs are often found in the promoter area of genes, and they exhibit low methylation. Higher CGI methylation is associated with gene silencing. Within gene bodies, CpG sites are usually hypermethylated, and are found in lower density. However, there are many exceptions to these general rules, such as CGIs within gene bodies or promoter areas without CGIs. There are other, predefined, regions associated with CGIs. In addition to the island itself, there are north and south shores and shelves, located upand downstream from the island, respectively, and are defined according to their distance (in base pairs) from the island (). Shores are up to 2 kb of the island, and shelves are within 24 kb of the islands. We term the collection of shelves, shores and island associated with a single CGI by a 'resort' to eliminate confusion. The definition of these regions is independent of any actual observed behavior of the sets of associated CpG sites. Further,report finding clusters of methylated CpG sites within specific cell types, these clusters are not related to CGIs. In other words, these regions do not necessarily correspond to regions that are co-regulated. Therefore, it is useful to employ computational tools for discovery of regions with CpG sites *To whom correspondence should be addressed. exhibiting common behavior that are not necessarily restricted to the known predefined methylation domains. This article has three aspects: (i) automated identification of methylation regions based on the correlation between methylation sites, and independently of any exposure data; (ii) analysis of these regions to identify those affected by exposure; and (iii) development of a realistic correlation-preserving simulation scheme for methylation data.proposed a method to identify regions that are associated with exposure. Our proposed method differs from their work in that we perform general region detection, pose different modeling assumptions on the exposure effect on a region and, as a result, provide a simpler testing procedure. Others used the correlation for analysis of genetic data, more specifically, data from tiling arrays in which adjacent probes target overlapping sequences. For instance,developed a software package to correct the P-values associated with a probe using the estimated correlation between the probe and neighboring probes.developed a software package, applying methods to combine adjacent correlated P-values and detect regions of low P-value. These methods identify differentially methylation regions (DMRs) after testing for the exposure effect on the methylation sites, while we first cluster sites, and then test for the exposure effect on the clusters.proposed a method to detect CGIs using a Hidden Markov Model. However, their work focuses on redefining CGIs to alleviate limitations of the traditional definition based on CpG content in an interval, rather than on identifying regions of common behavior of CpG sites. In terms of simulation,did perform some simulations, but our proposed simulation scheme better imitates the reality, by preserving the correlation structure and methylation patterns of a real dataset. In what follows, we present an adjacent sites clustering method, dubbed A-clustering, to discover methylation regions by clustering together neighboring CpG sites according to their correlation, and under possible restrictions on their distance from each other on the DNA. The clustering can be preceded by a dbp-merge step, an algorithm that merges a set of methylation sites wedged between two highly correlated CpG sites, that are physically located close enough to each other along a chromosome. This combination of the dbp-merge and A-clustering detects regions of co-regulated CpG sites. We further provide a pipeline for analysis after normalization and batch correction are performed that first includes clustering CpG sites, and then tests the effect of exposure on each cluster. For testing, we assume that the exposure equally affects all CpG sites, while each site has its own baseline methylation level. We perform this analysis using generalized estimating equations (GEEs;) that are robust to the specification of data distribution. The clustering method and the following GEE analysis are implemented in the R package Aclust. The article is organized as follows: in Section 2, we present the model at the basis of this work. Section 3 describes the A-clustering and dbp-merge algorithms, the proposed analysis pipeline and an abbreviated description of the correlation-preserving simulation scheme (complete details may be found in the Supplementary Material). In Section 4, we first study the performance of the proposed analysis pipeline for finding regions associated with the exposure, via an extensive simulation study with different implementations of the A-clustering algorithm and a subsequent sensitivity analysis. We then compare the analysis pipeline with the Bump Hunting method ofas well as briefly review single-site analysis results. We then compare clustering results between two implementation options of the A-clustering and dbp-merge on a dataset of peripheral blood methylation of pesticide applicators. We conclude with discussion in Section 5.
DISCUSSIONWe present the A-clustering algorithm that clusters together adjacent methylation sites according to their distance, usually derived from the correlation between them, and provide a pipeline for analysis of methylation data when they are treated as outcomes. The clustering is used both to detect regions of sites that are co-regulated, and also to reduce dimension, by forming a smaller set of analysis units. We demonstrated the use of the algorithm on a methylation dataset, in which methylation was measured using the Illumina Infimum 450 K beadchip. The proposed method is also appropriate for sequencing data, possibly even more so than for array data, which tend to be sparser. The clustering and analysis methods are efficient, and they do not require resampling methods to compute the P-values. It is still an open question regarding what is the 'right' unit of analysis and for which purposes (e.g. CGIs, shores). Recent work bysuggests that the unit of analysis differs by regions (e.g. in promoter or intragenic areas), and possibly by cell type as well. A-clustering is useful tool in studying such units of differentially methylated regions and loci. Clusters of methylation sites will often have higher P-values then individual methylation sites. For instance, the cluster will likely have a smaller effect estimate and a larger P-value than the site within the cluster with the largest effect. However, there is a considerable dimension reduction when clusters are considered, and further, we believe that the fact that multiple sites exhibit similar behavior increases our certainty that the effect is 'real', rather than a FP discovery, because the probability to detect multiple adjacent sites is lower than the probability of detecting at least one single site. A-clustering uses correlation as the basis for clustering of CpG sites. This raises a few issues that are important to consider when analyzing data. First, the type of correlation to use. We explored the use of Pearson correlation, as well as the Spearman correlation, which is more robust to non-linearities in the association between two variables. In the dataset we used for data analysis, as well as the simulated data, we had 80 observations, a relatively low number, and, as was determined by simulations, Spearman correlation was slightly more appropriate for the detection of differentially methylated regions. When the number of observations is higher, it may be beneficial to use the Pearson correlation, especially because it reduces computation time compared with Spearman correlation. Second, one should consider redundant correlation due to covariates and batch effects. We recommend performing the entire analysis after normalization and batch effect removal, but one should also consider correcting for the effects of important covariates before A-clustering, by implementing Aclust on the partial residuals of the methylation measures, after regressing them on covariates. Note, however, that in our dataset, clustering results were nearly identical when we used the methylation values and when we used the partial residuals. Third, one can apply A-clustering based on a subset of the subjects. For instance, one can use only the highexposure group to define the clusters, rather than all subjects. This would be useful if one expects that high exposure will 'activate' a region, say, so that the signal is completely driven by the high-exposure group. As another example, it may be advantageous to cluster methylation sites based on the controls in a casecontrol study, if one expects that cases will exhibit an aberrant methylation pattern. We provide two options to extend and restrict the clustering algorithm. First, the dbp-merge that allows one to cluster a set of sites that are wedged between two correlated sites and are 'close enough' to each other, in terms of both correlation-based and physical distance. We also consider restricting adjacent CpG sites from clusters, if the base-pair distance between them (and without any CpG site measured between them) is smaller than a predetermined threshold. In the data analysis, we used 999 bp for the dbp merge and 1000 bp for the base-pair distance restriction. It is not entirely clear if these are the best numbers. The best distances would be such that the signal is maximized and yet not too much noise is added. More complex rules for merging and restrictions could also be devised, but that can lead to more complicated computation and less clear interpretation. Another possible extension to the clustering algorithm is the use of clustering indicators based on prior knowledge. For instance, one can decide that an island necessarily belongs to a certain cluster. Also, in validating the results of one study on a different dataset, one can use the clustering assignments from the first study. Another tuning parameter is the type of distance between clusters to be used. In the simulations, mimicking the sample size and two exposure group's design of our dataset, we found that the average distance is most appropriate for the goal of detecting differentially methylated regions. We use GEEs for the analysis of clusters, as they use marginal mean models that are robust to mis-specification of correlation structure. We use exchangeable working correlation, but other types of correlation can be explored. Also, we assumed that the exposure effect is constant across all sites in the cluster. Although it is likely that the direction of exposure effect (increases/decrease methylation) is the same across the cluster, it is not clear that the constant effect is correct and therefore, it may not be the most advantageous assumption. For instance, it may be that even after allowing for single-site intercept (i.e. we allowed for a different baseline level of methylation for each site), some sites may be more quickly modified by exposure than others. It is a topic for future work to extend the method using other assumptions on the effect of exposure on methylation in sites (e.g. increasing as the site is closer to the transcriptional start site). A drawback of the proposed GEE-based analysis is limited detection of large clusters (e.g. 50 sites) when the sample size is small. Allowing for different intercept for each site in a cluster may yield high standard errors for the exposure effect. Thus, in the case of a large cluster and small sample size, it is possible that methods such as Bump Hunting, or analysis of the mean methylation measure of probes in the cluster, may be more powerful.