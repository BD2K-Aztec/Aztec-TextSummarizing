Motivation: Isoform quantification is an important goal of RNA-seq experiments, yet it remains problematic for genes with low expression or several isoforms. These difficulties may in principle be ameliorated by exploiting correlated experimental designs, such as time series or dosage response experiments. Time series RNA-seq experiments, in particular, are becoming increasingly popular, yet there are no methods that explicitly leverage the experimental design to improve iso-form quantification. Results: Here, we present DICEseq, the first isoform quantification method tailored to correlated RNA-seq experiments. DICEseq explicitly models the correlations between different RNA-seq experiments to aid the quantification of isoforms across experiments. Numerical experiments on simulated datasets show that DICEseq yields more accurate results than state-of-the-art methods, an advantage that can become considerable at low coverage levels. On real datasets, our results show that DICEseq provides substantially more reproducible and robust quantifications, increasing the correlation of estimates from replicate datasets by up to 10% on genes with low or moderate expression levels (bottom third of all genes). Furthermore, DICEseq permits to quantify the trade-off between temporal sampling of RNA and depth of sequencing, frequently an important choice when planning experiments. Our results have strong implications for the design of RNA-seq experiments , and offer a novel tool for improved analysis of such datasets. Availability and Implementation: Python code is freely available at http://diceseq.sf.net.
IntroductionIn most eukaryotes, alternative splicing is an important posttranscriptional mechanism of regulation of gene expression, and largely increases the diversity of the proteome (). For example, over 90% of human genes have multiple isoforms (). Several lines of evidence indicate that alternative splicing plays a vital role in regulating biological processes (), and its failure often causes serious diseases (). The study of splicing has been revolutionized by the advent of high-throughput transcriptome sequencing (RNA-seq) techniques which enable unbiased sampling of the transcriptome and have greatly contributed to uncover novel biological functions for alternative splicing (). More recently, RNA-seq technologies have been combined with biotin labelling treatment to provide kinetic measurements of RNA transcription and splicing with high temporal resolution (), providing invaluable mechanistic insights in the dynamics of splicing. At the current stage of the technology, sequenced reads in RNA-seq experiments are much shorter than almost all eukaryotic transcripts. Thus, most reads from an RNA-seq experiment cannot be unambiguously aligned to a specific isoform. While in some cases a high level of coverage may obviate the problems, in many cases the number of reads that map to a single isoform is too low; when many isoforms are present, there may be no unambiguously assigned reads. To address this problem, several probabilistic methods were proposed to quantify the isoform proportion, for example IsoEM (), Cufflinks (), MISO () and BitSeq (). All of these methods introduce latent variables to model the identity of a read, i.e. which isoform it came from, and then reconstruct isoform proportions by maximum likelihood or by computing a posterior distribution from the observed read distribution. Most of these computational methods can quantify the isoform proportions accurately in many cases (), however for all methods isoform quantification at low coverages remains challenging. A natural approach in these cases is to exploit additional information, for example exploiting correlations across different experiments arising out of structured experimental designs such as time series or dosage response experiments. Time series RNA-seq designs, in particular, are becoming increasingly popular as an effective tool to investigate the dynamics of gene expression in a range of systems (). To our knowledge, no methods have been proposed that can exploit structured experimental designs in order to improve isoform estimation. This methodological gap also negatively affects the ability to design effectively experiments: for example, it is difficult to understand whether resources should be invested in gathering more time points, or in sequencing at a deeper level on a more limited number of samples. In this article, we present a new methodology, DICEseq (Dynamic Isoform spliCing Estimator via sequencing data) to jointly estimate the dynamics of isoform proportions from RNA-seq experiments with structured experimental designs. DICEseq is a Bayesian method based on a mixture model whose mixing proportions represent isoform ratios, as in (); however, DICEseq incorporates the correlations induced by the structured design by coupling the isoform proportions in different samples through a latent Gaussian process (GP). By doing so, DICEseq effectively transfers information between samples, borrowing strength which can aid to identify the isoform proportions. Our results show that DICEseq consistently improves in accuracy and reproducibility over the state of the art. This improvement can be very significant for a large fraction of genes: on one real dataset, the correlation between estimates from replicate datasets increased by over 10% across one third of the genes as a result of taking temporal information into account. Furthermore, simulation studies indicate that DICEseq can be an important tool in experimental design, enabling an effective trade-off of resources between sequencing depth and sample numbers. DICEseq therefore offers an effective way to maximize information extraction from complex high-throughput datasets.
DiscussionThe advent of RNA-seq technologies has revolutionized the study of mRNA splicing, and provided a powerful stimulus for the development of computational biology methods (). Recent years have seen a more wide-spread use of RNA-seq technology for the analysis of dynamical biological processes, resulting in a marked increase of biological studies adopting RNA-seq within a time series experimental design. In this article, we presented DICEseq, the first method to jointly estimate the dynamics of the splicing isoform proportions from time series RNA-seq data. A comparison of DICEseq to a selection of popular state-of-the-art methods shows that DICEseq has excellent accuracy and good computational performance; in particular, DICEseq can effectively pool information across time points to improve isoform quantification at low coverages, giving more accurate and confident predictions. Our analysis also points to the importance of coverage versus temporal sampling trade-offs in designing dynamic RNA-seq experiments; while our analysis focussed on time series experiments, we expect similar considerations to hold for other structured designs, such as dose response experiments. In this light, the use of methods which can capture structural information, such as DICEseq, may lead to a rethink of biological experimental designs for a broad class of experiments. Our application to two diverse biological datasets shows that DICEseq can be an effective tool on real biological investigations, leading to improved performance and more reproducible results. Methodologically, DICEseq builds on a fertile line of research using GPs to model transcriptional dynamics. GPs have been used to study the dynamical behaviour of gene expression in various contexts, from transcriptional regulation () to identifying the time intervals of differential expression with time series microarray data (). More recently,  Aij et al used a latent GP with negative binomial observation noise to study the profiles of gene expression during Th17 cell differentiation with time course RNA-seq ( ). To our knowledge, this is the first time GPs have been proposed within the context of isoform estimation. While we believe DICEseq offers a valuable new tool for the analysis of dynamic RNA-seq data, it also opens several novel lines of investigation. First, the Gaussian process prior, which is based on a general regression, could be extended to more general dynamic splicing modeling, e.g. a first-order linear dynamic system for RNA splicing kinetics, and an oscillatory system for circadian or cell-cycle studies. All of these could be incorporated in a straightforward way as parametric mean functions in a GP framework, however it would also be of interest to explicitly model the noise correlations they induce. DICEseq could be useful in elucidating RNA processing from biotin labelled RNA-seq, as attempted e.g. in de Pretis et al (). More generally, DICEseq could provide a flexible Bayesian framework for explaining RNA-seq data from other observations, and aid studies attempting to link splicing with other genetic and epigenetic factors.