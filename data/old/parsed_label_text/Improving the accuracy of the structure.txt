Motivation: Antibodies are able to recognize a wide range of antigens through their complementary determining regions formed by six hypervariable loops. Predicting the 3D structure of these loops is essential for the analysis and reengineering of novel antibodies with enhanced affinity and specificity. The canonical structure model allows high accuracy prediction for five of the loops. The third loop of the heavy chain, H3, is the hardest to predict because of its diversity in structure, length and sequence composition. Results: We describe a method, based on the Random Forest automatic learning technique, to select structural templates for H3 loops among a dataset of candidates. These can be used to predict the structure of the loop with a higher accuracy than that achieved by any of the presently available methods. The method also has the advantage of being extremely fast and returning a reliable estimate of the model quality. Availability and implementation: The source code is freely available at
INTRODUCTIONAntibodies are a class of Y-shaped proteins produced by B-cells that the immune system uses to identify and neutralize foreign pathogens such as bacteria and viruses. They have the remarkable ability to recognize virtually any foreign targets (the antigens) and bind to these with extraordinary affinity and specificity (). These characteristics make antibodies an ideal tool for the prevention and treatment of diseases such as cancer, infectious and cardiovascular diseases, arthritis, inflammation, immune disorders as well as for biotechnological applications (). Knowing the structure of antibodies is clearly instrumental for gaining insights into the biological phenomena of the antibodyantigen recognition as well as to interpret clinical data and rationally redesign the molecule for medical and biotechnological purposes (). Antibodies are composed of two identical heavy and light chain pairs. The antigen binding site, present on the upper tips of the Y shape, is formed by six hypervariable (HV) loops also referred to as the complementary determining regions (CDRs). Three of the loops belong to the variable domain of the light chain, (L1, L2 and L3) and three to the variable domain of the heavy chain (H1, H2 and H3). The variability in these CDR loops in terms of loop length and amino acid compositions is the main reason of the antibody capability to bind many different antigens. The framework regions of antibodies are fairly well conserved, while the structural variations occur mostly in the CDR loops. We and others have developed effective methods to predict the structure of antibodies (). The strategy consists of modeling the framework by homology while the prediction of five of the six loops is based on the canonical structure (CS) model that states that these loops (the light chains loops and the H1 and H2 loops of the heavy chain) can only assume a limited number of conformations and that these are determined by the presence of key residues in specific positions in the sequence of the antibody (). According to a recent blind assessment of the prediction accuracy of antibody modeling (), a good prediction can be obtained for non-H3 loops with an average root-mean square deviation (RMSD) of their C atoms close to 1 A . Only a partial CS model exists for the H3 loop, which allows the prediction of the structure of its four N-terminal and six C-terminal residues closer to the framework (). Accordingly, the prediction accuracy for H3 loops is not equally satisfactory as for the other loops, an important drawback because the H3 loop is central in the binding site and therefore often essential in determining the antibodyantigen interactions. In the above mentioned assessment (), none of the tested methods was able to provide sufficiently good predictions for H3; the average RMSD for the best methods was $3 A . The high variability in length, structure and sequence of this loop is usually invoked as the main reason behind the difficulty of predicting its structure. yThe authors wish it to be known that, in their opinion, the first three authors should be regarded as joint First Authors. *To whom correspondence should be addressed.  The Author 2014. Published by Oxford University Press. This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (http://creativecommons.org/licenses/ by-nc/3.0/), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial reuse, please contact journals.permissions@oup.comThere have been several attempts to develop methods for predicting the structure of H3 loops, both template-based () and template-free methods that try to predict the structure using ab initio conformation searches followed by ranking based on energy estimates and clash avoidance (). One of the most used approaches for antibody structure prediction is Rosetta Antibody (RA;), which combines template selections with ab initio CDR H3 loop modeling (using loop fragments) and simultaneous optimization of the CDR loop conformations and Variable Light (VL)-Variable Heavy (VH) orientations. Another interesting approach is FREAD (), which attempts to predict antibody loops using local similarities (local sequence and geometric matches). FREAD uses environment-specific substitution scores () to identify the best fragments for building the structure of the loops. Each of the previous approaches has its own disadvantages and limitations, and this prompted us to develop the method described here. One of the main limitations of ab initio approaches (e.g. RA) is due to our incomplete understanding of the physicochemical principles governing protein structures, which leads to the employment of pseudo-energy approximate functions that are not always accurate in distinguishing correct predictions. In addition ab initio approaches tend to have high computational cost. On the other hand, the available homologybased methods such as FREAD-S () suffer from being essentially dependent on the H3 sequence alone that has proven to be insufficient to provide accurate models, especially for longer loops. The ConFREAD method () tried to overcome this limitation by including contact profile information; however, this only led to minor improvements obtained at the expense of a much lower coverage. Given the central position of the H3 region in the antigenbinding site, there are several interactions with the other CDR loops, as well as with the framework, that could affect the conformation of H3 (). In line with this hypothesis, we developed a method that takes advantage of sequence similarity and structural related features [e.g. CS () as well as a score reflecting the likelihood of the presence/absence of specific interactions between the H3 residues and the rest of the modeled antibody structure (. We used a set of selected features to train a Random Forest (RF) machine learning algorithm to select the closest loop among a dataset of H3 loops present in immunoglobulins of known structure. The best predicted template(s) are used to build the structure of H3 that are subsequently ranked according to their intramolecular interactions. We tested our model on the RA benchmark () (we used 53 of the 54 structures in the benchmark excluding the PDB: 2AI0 case because in RA benchmark the H3 loop was uncorrectly reported as a six-residue loop) and our results are more accurate than those provided by RA, considered the best method available at present, on the same benchmark. We also tested our method on recently deposited structures of antibodies with equally satisfactory results. Last but not least the described method requires substantially less computing time with respect to the RA (on average 5 min).