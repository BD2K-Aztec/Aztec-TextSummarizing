Motivation: Dynamic simulation of genome-scale molecular interaction networks will enable the mechanistic prediction of geno-type–phenotype relationships. Despite advances in quantitative biology , full parameterization of whole-cell models is not yet possible. Simulation methods capable of using available qualitative data are required to develop dynamic whole-cell models through an iterative process of modelling and experimental validation. Results: We formulate quasi-steady state Petri nets (QSSPN), a novel method integrating Petri nets and constraint-based analysis to predict the feasibility of qualitative dynamic behaviours in qualitative models of gene regulation, signalling and whole-cell metabolism. We present the first dynamic simulations including regulatory mechanisms and a genome-scale metabolic network in human cell, using bile acid homeo-stasis in human hepatocytes as a case study. QSSPN simulations reproduce experimentally determined qualitative dynamic behaviours and permit mechanistic analysis of genotype–phenotype relationships. Availability and implementation: The model and simulation software implemented in Cþþ are available in supplementary material and at
INTRODUCTIONOne of the fundamental goals of molecular biology is to delineate the molecular mechanisms by which genetic information is expressed in response to environmental cues, giving rise to a specific phenotype. Given the number of molecular components of a cell and the dynamic non-linear nature of their interactions, mechanistic computational modelling is an indispensable tool. Mechanistic models formally represent the current knowledge about the molecular machinery of cells. The molecules and interactions included into such models reflect the extent of genome sequence annotation, with computer simulation used to predict system behaviour under particular environmental conditions. In systems biology, such unbiased representation of molecular interactions in mechanistic models is referred to as reconstruction (). In a sense, the ultimate goal of reconstruction is to reverse engineer the entire molecular machinery of the cell in a computer model capable of reproducing the responses of specific cells/tissues to any environmental perturbation. In particular, the ability to predict the consequences of genetic background on human cell behaviour is of practical importance in clinical settings (). Genetic and molecular profiling of individuals and diseased tissues is becoming increasingly important not only for the development of new therapies, but also in the design of patient-tailored treatment regimes. We believe that mechanistic prediction of genotypephenotype relationship through computer simulation of the genome-scale molecular interaction networks in human cells is indispensable to the development of personalized medicine (). Significant effort has already been dedicated to the formal representation of existing knowledge of the molecular machinery of the cell. The predominant framework is a bipartite graph where nodes representing molecules are connected to nodes representing interactions. This representation underlies established knowledge bases such as Reactome (), BioCyc (), KEGG () and dedicated large-scale reconstructions of cellular systems, including human cell networks relevant to major diseases (). It is also reflected in major data exchange standards such as systems biology markup language (SBML) () and graphical notations such as (systems biology graphical notation) SBGN (Le). A major roadblock in using this wealth of formally represented knowledge to predict cellular behaviour is the lack of quantitative data about molecular amounts and interaction rates, a prerequisite to constructing dynamic models. Despite the rapid development of quantitative methods in molecular biology, full parameterization of genome-scale dynamic models, particularly of human cell systems, is still prevented by the lack of data. On the other hand, both high-throughput methods of functional genomics and traditional molecular biology routinely generate timecourse data, where dynamic changes in relative molecular activity after perturbation are monitored. Thus, there is a need to develop dynamic mechanistic computer simulation methods, capable of generating qualitative predictions about system behaviour that can be compared with available experimental data. Qualitative simulation would facilitate the iterative refinement of whole-cell mechanistic models through both theoretical *To whom correspondence should be addressed.  The Author 2013. Published by Oxford University Press. This is an Open Access article distributed under the terms of the Creative Commons Attribution License (http://creativecommons.org/licenses/by/3.0/), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited. prediction and experimental validation. They would also make it possible to fully use currently available network connectivity reconstructions to provide insights into the molecular mechanisms of human disease. Although it is not yet possible to create a mechanistic model of the molecular interaction network involving all gene products, the metabolic capabilities of a whole cell can already be mechanistically simulated using constraint-based methods (CBM) (). Briefly, a set of metabolic reaction formulas is constructed according to the complement of enzymes/transporters inferred from genome annotation. Next, a linear model of flux distribution at steady state is constructed and linear programming used to identify maximal possible flux through selected reactions in the network. This basic flux balance analysis (FBA) method can identify metabolites that can be produced given the composition of available nutrients. Even at this purely qualitative level of network description, the consequences of varying genetic background can be studied through in silico gene inactivation experiments. The major limitation in extending this methodology to other classes of molecular interaction is the assumption of a steady state. Owing to this assumption, essential transient behaviours such as burst or oscillations cannot be studied. However, the timescale separation between fast metabolic reactions and slow gene regulatory processes means that constraint-based models can be combined with dynamic models of regulatory processes (). These quasi-steady state methods have been used for the simulation of model microorganisms, where relatively small-scale metabolic networks have been integrated with dynamic models of regulatory processes. However, none have yet been applied to the study of the clinically relevant cellular behaviours in human tissues. Petri net (PN) theory provides a general representation of interacting components in a network (). PNs are bipartite graphs comprising two node classes: places and transitions. The state of the system is represented by the number of tokens assigned to each place. Transitions represent interactions within the system by moving tokens between places. This formalism naturally lends itself to the representation of molecular interaction networks, with places representing molecules, transitions molecular interactions and tokens corresponding to numbers of molecules or discrete molecular activity levels. Molecular interaction networks represented as PNs can be analyzed using a variety of simulation and formal analysis methods developed in the PN field (). PNs have been applied in the modelling of molecular network dynamics (). However, of interest here is that PNs have also been shown to be advantageous for qualitative modelling of gene regulatory networks () and signalling pathways (, b), where network connectivity is analyzed without knowledge of quantitative molecular concentrations and interaction rate constants. Here, we describe quasi-steady state PNs (QSSPN), a novel algorithm capable of qualitative dynamic simulation of genomescale molecular interaction networks including all classes of molecular interactions. We apply the algorithm to simulation of the interplay between whole-cell metabolism and gene regulatory and signalling networks involved in bile acid (BA) homeostasis in human hepatocytes. To our knowledge, this is the first dynamic simulation of a molecular interaction network involving gene regulation, signalling and full genome-scale metabolic network (GSMN) in a human cell. The unique feature that enables QSSPN to perform this simulation is Monte Carlo sampling of the feasible dynamic sequences of molecular transitions in the qualitative quasi-steady state model. In the following sections, we introduce QSSPN method, demonstrate its application to human hepatocyte simulation and compare its features with other approaches.shows an overview of the QSSPN method. The molecular interactions are divided into two sets: quasi-steady state fluxes (QSSF), representing metabolic reactions; and dynamic transitions (DT), representing other classes of molecular interaction, such as signalling pathways and. Overview of quasi-steady state PN simulation. The DT component of the model is represented using the PN formalism. Circles denote places; dots within circles are tokens; squares are transitions; arrows are edges; open circle headed arrows are inhibitory edges; and full circle headed arrows are read edges.gene regulation. QSSF are interrogated through CBMs, whereas DTs are represented using extended PN formalism (). The activities of molecular species represented by PN places are given by an integer number of tokens. In most instances, tokens represent discrete levels of activity, but fully quantitative description is, in principle, possible, with node token status reflecting molecular quantities. QSSF and DT interaction sets are connected by two classes of PN places: constraint places set flux bounds in QSSF, translating place token status in to flux bounds; objective places represent metabolic outputs of the QSSF network. Each molecular interaction in a PN subset is represented by a transition connected to pre-places representing substrates, activators and inhibitors and post-places representing products. Substrates and products are connected to transitions by standard edges, whereas catalytic activators and inhibitors are connected to transitions by read and inhibitor edges, respectively. When a transition fires, tokens from substrate pre-places are consumed and tokens representing products fired to post-places; the states of pre-places connected to transitions by read or inhibitor edges are not changed. In the simplest definition of system dynamics, transitions can fire if each substrate and activator pre-place has at least one token and all inhibitory pre-places have no tokens. To allow formulation of general rules involving token number thresholds, we define transition propensity Equation (1):
DISCUSSIONWe present qualitative dynamic simulations of BA homeostasis in human hepatocytes incorporating gene regulation, signalling and whole-cell metabolism. This is the first dynamic simulation of molecular interaction networks describing gene regulation, signalling and whole-cell metabolism in human cells. We reproduce experimentally determined relative molecular activity timecourses and use the model to mechanistically investigate genotypephenotype relationship in a clinically relevant system, which yields novel mechanistic insight. The presented mechanistic computer simulations are performed with QSSPN, a novel algorithm formulated in this work. QSSPN performs quasisteady state simulation of genome-scale molecular interaction networks involving all classes of molecular interactions. Metabolic reactions are assumed to be much faster than other cellular processes and whole-cell, steady state, metabolic flux distribution is explored using well-established CBMs. Dynamic cellular processes are represented using extended PN formalism, and we introduce two new classes of PN node that integrate the steady state metabolic flux network and dynamic PN components of the model. Constraint nodes set the bounds of specified fluxes in the metabolic network according to a lookup table mapping its discrete token state to flux bounds. Objective nodes use predefined lookup tables to establish token state based on the evaluation of objective function in a whole-cell metabolic model. QSSPN is a stochastic simulation algorithm that generates a sample of dynamic trajectories permissible given the properties of the system under study and modelled stimuli. Thus, each trajectory represents a feasible sequence of molecular transitions. Trajectory sampling is used to study the effects of system perturbation (e.g. growth condition, gene knock-down, agonist/antagonist addition). Samples are generated for WT and perturbed states and the fraction of trajectories exhibiting a behaviour of interest is calculated for each state. QSSPN can be used to test not only simple reachability of a particular node of the network or the producibility of a particular metabolite, but also occurrence of dynamic behaviours (e.g. bursts and oscillations). We use piecewise linear definition of the stochastic transition propensity, where contribution of the pre-place (substrate, catalyst, inhibitor) to the propensity is determined by a lookup table with thresholds (Equations 1 and 2). This allows formulation of qualitative rules and enables simulations where complex qualitative dynamic behaviours can be generated in computationally efficient models representing molecular activities by a few discrete states. Taking into account the features discussed earlier in the text, we believe that QSSPN is substantially different to existing approaches and offers numerous advantages in the modelling of genome-scale molecular interaction networks in human cells. In Section 7 of the supplementary material, we present detailed comparison with existing approaches and the remaining part of this discussion summarizes its conclusions. First, the only simulation of human metabolism in a quasi-steady state framework published so far () did not include gene regulation or signalling. The CBM model used the dFBA approach () to integrate ODE models of drug concentration in physiological compartments. Currently, qualitative rule-based models of regulatory processes can be integrated with an FBA of metabolism using rFBA (). However, rFBA uses Boolean rules expressing relationships between network nodes representing genes. Importantly, transcription and translation processes are not distinguished and known mechanistic details about the nature of experimentally monitored or perturbed molecules cannot be expressed, both of which are achieved with QSSPN. We have created coarse-grained versions of our BA homeostasis model using the rFBA framework (Supplementary Material, Section 7). We show that to faithfully model human cell systems the original rFBA needs to be modified to remove reliance on maximization of biomass and simulation of cell culture growth. Furthermore, we show that even the best adaption of rFBA to simulation of human cell is still not able to achieve the predictive power of QSSPN (.) This is due to the fact that the rFBA gene regulatory network does not distinguish transcription and translation processes. As a result it fails to reproduce the qualitative behaviour of transcript activity in a negatively auto-regulated gene. QSSPN makes the correct prediction because of its representation of gene expression, which does not require quantitative parameters, but does resolve the two fundamental stages of gene expression. Detailed quasi-steady state models, resolving mechanistic details of gene expression process, can be constructed with iFBA () and idFBA () methods, where CBMs are coupled to ODE models through quasi-steady state assumption. Alternatively, detailed quantitative models have been coupled to CBMs through a 'diverse mathematics' approach (), where a tailored model for a particularly well-studied small model microorganism has been created. However, these methods require quantitative data to parameterize ODEs. For our test case study and other clinically relevant human systems such data are rarely available. Thus, the QSSPN is significantly better than other quasi-steady state methods in addressing the trade-off between detailed representation of molecular mechanisms and the requirement for quantitative data. We believe that this makes it ideally suited to modelling human systems, where accurate quantitative knowledge is more difficult to obtain, but qualitative molecular activity timecourses are readily measurable either by well-established qRT-PCR and western-blot assays or high-throughput 'omics' technologies. In Section 8 of the Supplementary Material, we analyze the computational efficiency of QSSPN and demonstrate that it is scalable to mechanistic modelling of GSMN in human cells. The quasi-steady state methods developed to date are synchronous and deterministic; they produce one trajectory where at every step all rules are synchronously evaluated. By comparison, QSSPN is the first method that enables asynchronous, stochastic and rule-based simulations of a quasi-steady state system involving whole-cell metabolism. In every iteration, only one stochastic transition is generated, resulting in multiple alternative sequences of molecular interactions. This is an important advantage as biological systems are fundamentally asynchronous, meaning that asynchronous algorithms should be used for qualitative rule-based simulations (). Moreover, as QSSPN allows incorporation of quantitative rates, it offers the exciting prospect of building semi-quantitative models where individual trajectories are interpreted as different cellular behaviours occurring in a population of genetically identical cells because of stochastic phenotypic switching (). PN trajectory sampling in wild-type and perturbed systems has previously been used in the signalling PN approach (). For the first time, QSSPN uses PN trajectory sampling in the context of quasi-steady state simulations involving GSMNs. As a result, it hugely extends the scale of models that can be qualitatively studied. Moreover, signalling PN is based on the comparison of average simulation timecourses; although this can be done within the QSSPN approach, we recommend the implementation of an alternative approach developed in the model-checking field of computer science. Here, the numbers of trajectories exhibiting the behaviour of interest in the reference and perturbed systems are statistically compared: binomial probability confidence interval statistics have already been used in statistical model-checking software such as Prism (). Finally, we use a piecewise-linear formulation of propensity functions. Piecewise-linear functions were previously used to provide a discrete qualitative equivalent of ODE models (). Here, we use them for the first time to define propensity functions in a stochastic simulation algorithm. The stochastic model-checking approach is capable of analyzing arbitrary large-scale models, whereas previous applications of piecewise-linear functions were limited by algorithms based on generation of full reachability graph, which is usually too large to be computed for genome-scale networks. In summary, we believe that QSSPN is a unique method for reconstruction and simulation of genome-scale molecular interaction network dynamics. It provides qualitative insight into system dynamics through qualitative simulation and enables mechanistic simulation of genotypephenotype relationships in human cells, where quantitative data are sparse and qualitative molecular biology data are readily available. It is therefore an ideal approach for the iterative cycle of reconstruction, simulation and measurement that will eventually lead to the prediction of genotypephenotype relationships in human tissues, through the mechanistic simulation of whole-cell molecular biology.