Motivation: RNA-sequencing technologies provide a powerful tool for expression analysis at gene and isoform level, but accurate estimation of isoform abundance is still a challenge. Standard assumption of uniform read intensity would yield biased estimates when the read intensity is in fact non-uniform. The problem is that, without strong assumptions, the read intensity pattern is not identifiable from data observed in a single sample. Results: We develop a joint statistical model that accounts for non-uniform isoform-specific read distribution and gene isoform expression estimation. The main challenge is in dealing with the large number of isoform-specific read distributions, which potentially are as many as the number of splice variants in the genome. A statistical regularization via a smoothing penalty is imposed to control the estimation. Also, for identifiability reasons, the method uses information across samples from the same region. We develop a fast and robust computational procedure based on the iterated-weighted least-squares algorithm, and apply it to simulated data and two real RNA-Seq datasets with reverse transcriptionâ€“polymerase chain reaction validation. Empirical tests show that our model performs better than existing methods in terms of increasing precision in isoform-level estimation. Availability and implementation: We have implemented our method in an R package called Sequgio as a pipeline for fast processing of RNA-Seq data.
INTRODUCTIONAlternative use of exons can form a number of combinations called splice variants, which can be used as templates for producing related but distinct proteins (). Alternative splicing has been observed among different tissue types in 90 95% of human genes () and greatly diversifies the transcriptome. Many splice variants have been found to be implicated in a wide range of human diseases and functional roles (). For this reason, it is important to develop the technologies and statistical methods to distinguish and quantify different isoforms of the same gene. To compute an absolute expression scorein reads per kilobase per million reads (RPKM) unitsread counts are normalized against the transcript length and the total number of mappable reads (). Typically, to estimate isoform abundance, read counts falling into a gene with multiple isoforms are modeled as a Poisson process with uniform sampling across each transcript (). But due to a number of factors, e.g. the 5 0 or 3 0 bias, local nucleotide composition effectssuch as priming or GC biasor other technical biases, read distribution might not be uniform (). Indeed, empirical goodness-of-fit test for the Poisson model fitted under the uniform assumption shows that a majority of these models have poor fit. This would lead to bias in the isoform expression estimates. Recent methods suggest estimating non-uniform read distribution from single-isoform genes (). These methods are rather limited, where either one distribution is used for all isoforms or a different distribution depending on length. In other words, all transcripts of the same length from all genes, regardless of what genes and whether the genes have single or multiple isoforms, are assumed to have the same read distribution. This ignores, for example, the local composition effect of the transcript. Furthermore, a recent study () did suggest that, as the method used for RNA library preparation introduces some amplification artifacts, the distribution of read coverage could be isoform-specific. In real data we do find that the distribution for different transcripts that share common length is not always the same. In addition, we observe that read distribution is highly correlated across samples. In Supplementary Report, Supplementary Figures S1 and S2 show typical examples of non-uniform read distributions with overabundance on the 3 0 region. Interestingly, across samples, we find similarities in the shape of the read distributions even between different tissues. There is evidence that the sample-to-sample similarity in nonuniform read distributions holds more generally across the genome; see Supplementaryin the Supplementary Report. The restriction imposed by the previous methods in estimating read distribution highlights one main difficulty: once we allow non-uniformity, in principle each transcripteven from the same *To whom correspondence should be addressed. y The authors wish it to be known that, in their opinion, the first two authors should be regarded as Joint First Authors. geneto have its own specific pattern, would lead to a large number of distribution patterns, potentially as many as the number of transcripts. This makes the estimation highly nontrivial. To account for local composition effect,adjusted for priming bias, where each read is reweighted based on its first few bases. If based on seven nucleotides (heptamer), they needed to calculate the proportion of reads starting with each specific heptamer, i.e. 4 7 frequencies. So reads beginning with a certain composition of seven nucleotides overrepresented in the heptamer distribution are down-weighted.modeled the read counts depending on the specific composition of nucleotides along a gene, and developed a more complex Poisson linear and non-linear model to estimate the effect of a certain nucleotide occurring in the k th nucleotides away from a given position j, by modeling the count of reads starting at position j. The gene-expression levels and the coefficients of the effect of surrounding nucleotide are optimized iteratively. Cufflinks (), one of the mostly commonly tools used to deal with sequence-specific biases problem in isoform expression estimation, assumes uniform read distribution in its basic model, but provides an ad hoc correction of bias step (). It also estimates positional bias, which measures whether fragments are preferentially located toward either ends of the transcripts. Unlike the base-level bias correction method, our idea is to model the isoform-specific read distribution and expression jointly. The observed sample-to-sample similarity suggests that combining data from different samples makes read distribution identifiable. Our approach automatically allows for the local composition effect without any need for explicit modeling. Such a joint model is more natural, so we expect it to lead to better performance. The algorithm of iteratively estimating isoform expression and read distribution has some similarity to the idea in a recent published program NURD (), where a global bias curve for all genes and a local bias curve for each gene is estimated using nonparametric models. In this study, we compare the estimation accuracy of our model against Cufflinks, NURD and the method under uniform read distribution assumption, using a set of simulated datasets, and also apply our proposed method to two real datasets. In summary, the purpose of this article is to describe a method for joint estimation of isoform-level expression and isoformspecific read distribution. Allowing for isoform specificity automatically deals with positional bias and local composition effects, but it is challenging, as we then have to estimate as many distributions as the number of isoforms in the genome. Regularization via a smoothing penalty is used to control the estimation of the read distributions. Primary results show that, our approach provides substantial improvement on the quality of model fitting and improves the sensitivity in isoform-level differential expression analysis, compared with the method based on uniform assumption, Cufflinks and NURD.
DISCUSSIONIn this article, we introduce a novel method using RNA-Seq data from multiple samples to estimate the isoforms expression, taking into account non-uniform read distribution. Through simulations that model read-count data from non-uniform distribution, we demonstrate that our method improves accuracy in the expression quantification. When read distribution deviates dramatically from uniform, there is a striking improvement in accuracy of the expression estimation. Furthermore, our method can be easily adapted for use with any next-generation sequencing technology and mapping program. Sequgio uses a fundamentally distinct method to estimate read distribution. First of all, it does not assume any relationship between sequencing bias and relative position of a certain nucleotide in a fragment. It uses an explicit and transparent model with isoform-specific read intensity to simultaneously correct different sources of bias. Second, Sequgio is able to estimate isoformspecific read distribution as long as count-level data are available for a single transcriptional unit. In contrast, to produce nucleotide-specific bias weights, Cufflinks requires the nucleotide-level information of all genes. The same global nucleotide distribution is then used for all fragments. But estimation of nucleotide bias weights might be sensitive to which and how many singleisoform genes are taken into calculation. The main assumption of the joint model is that non-uniform read distributions can be identified using information across samples, given that the read distribution is consistent across samples. In section A of the Supplementary Report, we have presented evidence that the sample-to-sample similarity holds generally in the genome even between different tissues. In practice, we recommend users to follow the procedure to check the consistency especially when pooling information from two biological groups, e.g. diseased versus healthy. If not consistent, the estimation should be done separately. In the application to human brain tissue data, although only three samples are available, we see Sequgio performs fairly well based on the correlation with Cufflinks' and RT-PCR estimates. When there are 510 samples, we would recommend using them all in estimation. On the other hand, if a large number of samples are available and the computational system is limited, it would be useful to consider a two-staged procedure: (i) in the first stage the readNote: The first row lists the percentage of DE isoforms. But genes with DE isoforms can be non-DE at gene level. Percentage is summarized in the second row. Last two rows show the number of transcripts with both FC410 and highly expressed; the number of transcripts upregulated in tissue (A). Br, L and M stands for brain, liver and muscle. intensities are estimated from a subsample, and (ii) in the second stage these intensities are fixed, so only expression levels need to be estimated. Gold standards for transcript-level expression are difficult to obtain experimentally. Improvement by our method is shown mostly by empirical means via the goodness-of-fit 2 statistics. We also rely on simulations and limited isoform-level RT-PCR data to assess the accuracy of our results. In the simulations, we consider both a non-uniform distribution and a slight deviation from uniformity, and all parameter values are those we estimate from the real data, so they are a fair testing procedure. One limitation of many current methods including our own is that all isoforms for a gene are assumed to be known. Because of the huge amount of information from different isoform-level annotation database and complex structure of transcriptome, the current annotation is incomplete. We suspect this might partially cause discrepancies in the RT-PCR validation. Most biological annotation databases may be updated almost every week. Some databases will be closed and merged with others, e.g ASTD are integrated in Ensembl database. There is a need to develop a reliable and comprehensive mega annotation database. But it is worth emphasizing that with the RNA-Seq mouse tissue data used in this article, mapped counts and $18 000 genes identified are comparable with results from those studies that use the same dataset ().