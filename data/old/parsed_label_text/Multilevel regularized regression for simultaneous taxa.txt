Motivation: Identifying disease associated taxa and constructing networks for bacteria interactions are two important tasks usually studied separately. In reality, differentiation of disease associated taxa and correlation among taxa may affect each other. One genus can be differentiated because it is highly correlated with another highly differentiated one. In addition, network structures may vary under different clinical conditions. Permutation tests are commonly used to detect differences between networks in distinct phenotypes, and they are time-consuming. Results: In this manuscript, we propose a multilevel regularized regression method to simultaneously identify taxa and construct networks. We also extend the framework to allow construction of a common network and differentiated network together. An efficient algorithm with dual formulation is developed to deal with the large-scale n (m problem with a large number of taxa (m) and a small number of samples (n) efficiently. The proposed method is regularized with a general L p (p 2 ½0; 2) penalty and models the effects of taxa abundance differentiation and correlation jointly. We demonstrate that it can identify both true and biologically significant genera and network structures. Availability and implementation: Software MLRR in MATLAB is available at
IntroductionMassive 16S rRNA and whole-metagenomic shortgun sequencing data have been generated due to advances in next-generation sequencing technologies. The goals of metagenomic research are to investigate the hostmicrobiota associations and bacteria interactions, and examine how changes in microbiota may affect metabolic functions and human disease. Two crucial research problems, disease associated taxa (genera, operational taxonomic units) selection and correlation network constructions, are usually studied separately. Both filter and model-based approaches have been proposed to detect differences in bacteria composition and relative abundance. Filter-based statistical tests select disease-associatedbacteria features one at a time () and suffer from multiple comparisons problem. Modelbased approaches, on the other hand, identify disease-associated taxa through building a sparse prediction model (), and are efficient for explicitly evaluating the predictive power of multiple taxa. However, these methods mainly focus on differences in abundance without considering the interactions among taxa. Biological and taxa association networks have been constructed with various methods (). Such networks investigate the interactions and causality among group of genes systematically. Metabolic networks have also been proven to be powerful tools for studying the physiological and biochemical characteristics of various functional and evolutionary properties of a cell (). A local Poisson graphical (loglinear) model and a Bayesian generalized graphical model have been proposed recently for constructing association networks based on RNA-seq data (). Among all the methods, various graphical models with L 1 regularization are perhaps the most common approach for graphical structure estimation (;). L 1 regularized approaches are based on neighborhood selection for each variable (gene) i. They build a L 1-based sparse regression model for each x i , with the remaining variables x i  fx j jj 6  ig, and determine the sparse graphical model with the collected regression coefficients. They have also been extended to dependency network construction with sparse Bayesian network structure learning (). L 1-based approaches automatically identify a number of dependent genes and are computationally efficient for large-scale network construction, but these approaches construct the network without considering differentiation of the genes across different clinical conditions. In addition, parameters estimated from L 1 penalized regression are asymptotically biased and L 1 does not always identify the true model consistently (). Therefore, elastic net with aL 1  1  aL 2 (0 a 1), which is equivalent to L p (1 p 2), was proposed for choosing highly correlated genes (), and L p (0  p  1) penalized regression was proposed for reducing the biases of estimates (). In this article, we develop sparse multilevel models for simultaneous gene selection and network construction, and simultaneous common and differentiated network construction under different clinical conditions. An efficient algorithm with duality and a general L p (p 2 0; 2) penalty is also developed to deal with the n ( m problem efficiently. We also propose a novel criteria entitled mean parameter difference (MPD) for k and p selection. Our methods will be evaluated with simulated and real metagenomic count data. Since the variance of metagenomic counts depends on the mean count, the data are first transformed to a normal distribution using the arcsin and log-ratio variance-stability methods (). We demonstrate that the proposed approaches successfully identify true and biological important taxa and network structures associated with the disease.