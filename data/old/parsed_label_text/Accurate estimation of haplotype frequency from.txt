Motivation: A variety of hypotheses have been proposed for finding the missing heritability of complex diseases in genome-wide association studies. Studies have focused on the value of haplotype to improve the power of detecting associations with disease. To facilitate haplotype-based association analysis, it is necessary to accurately estimate haplotype frequencies of pooled samples. Results: Taking advantage of databases that contain prior haplotypes, we present Ehapp based on the algorithm for solving the system of linear equations to estimate the frequencies of haplotypes from pooled sequencing data. Effects of various factors in sequencing on the performance are evaluated using simulated data. Our method could estimate the frequencies of haplotypes with only about 3% average relative difference for pooled sequencing of the mixture of 10 haplotypes with total coverage of 50Ã‚. When unknown haplotypes exist, our method maintains excellent performance for haplotypes with actual frequencies 40.05. Comparisons with present method on simulated data in conjunction with publicly available Illumina sequencing data indicate that our method is state of the art for many sequencing study designs. We also demonstrate the feasibility of applying overlapping pool sequencing to identify rare haplotype carriers cost-effectively. Availability and implementation: Ehapp (in Perl) for the Linux platforms is available online
INTRODUCTIONGenome-wide association studies have identified numerous genetic variants associated with complex diseases and traits, and have provided valuable insights into their genetic architecture. However, most variants identified so far confer relatively small increments in risk, and explain only a small proportion of heritability (). A variety of hypotheses have been proposed to explain the missing heritability, including rare variants, genegene and geneenvironment interaction (). In addition, studies have focused on the values of haplotypes and genome-wide haplotype association (GWHA) studies have been presented to find the association between haplotypes and diseases (). The combination of genetic marker alleles such as single nucleotide polymorphisms (SNPs) on a single chromosome is called a haplotype, which provides valuable information on evolutionary history and may lead to the development of more efficient strategies to identify genetic variants that increase susceptibility to diseases (). Rather than examining variants independent of each other, simultaneously considering the values of multiple variants within haplotypes can improve the power of detecting associations with disease (). Up to now, numerous haplotypes have been found associated with several diseases (). To facilitate GWHA studies, it is necessary to estimate haplotype frequencies accurately from deoxyribonucleic acid (DNA) pools of case and control samples.presented PoolHap to estimate haplotype frequencies from pooled samples by next-generation sequencing. On the basis of an expectation maximization algorithm,put forward Harp to calculate the frequencies of haplotypes from pooled sequencing data. However, both PoolHap and Harp required that the haplotypes for pooled samples were known for inferring the frequency which may conflict with real situation. Taking advantage of haplotype database information has been proved feasible and helpful for haplotype frequency estimation (). Under the plausible assumption that few haplotypes actually possess the vast majority of proportion or haplotype database is large enough, compressed sensing (CS) () could be used for the rapid and accurate reconstruction of the haplotype composition of pooled samples.utilized techniques from CS to reconstruct the composition of a mixture of bacteria by utilizing databases that contain all the possible species.translated the haplotype frequencies estimation as a joint constrained sparse optimization problem which has been studied in the CS literature. With the development of sequencing technology, a large number of haplotypes are rapidly gathered into public databases such as HapMap (), DGRP (The Drosophila Genetic Reference Panel,), and 1001 genomes (). The number of samples used in HapMap allows the project to find *To whom correspondence should be addressed.  The Author 2014. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com 99% of haplotypes with frequencies of 5% or greater in a population (). Since CS was proposed to recover sparse signals from incomplete and inaccurate measurements (), suppose the haplotypes for the samples in pooled sequencing are included in the database which is large enough, it is viable to infer the frequencies of haplotypes contained in the prior database by utilizing techniques from CS. However, for low-frequency haplotypes not contained in the database, it is hard to recover the frequency. Once a haplotype is confirmed that it has association with diseases, similar to genomic variants, screening for the haplotype carriers is of great value in practical application. Borrowing ideas from group testing theory (Ding), overlapping pool sequencing was presented for the purpose of identifying rare variant carriers cost-effectively (). On the basis that the frequencies of haplotypes could be estimated precisely from pooled sequencing data, clearly, overlapping pool sequencing can also be applied in the identification of rare haplotype carriers. Here, by means of prior haplotype information contained in the database, we present a method to estimate the haplotype frequencies from pooled sequencing data. The proposed method uses as inputs a database of haplotypes and pooled sequencing results, and returns estimated frequency for each haplotype contained in the database. A mathematical framework is first presented to translate haplotype frequency estimation as solving a system of linear equations. NNREG algorithm () is employed to calculate the frequencies of haplotypes. Effects of various factors in sequencing on the performance of our method were evaluated using simulated data. The effects of unknown haplotypes contained in the pooled samples were also demonstrated. Comparison with Harp on both simulated data and publicly available Illumina sequencing data showed that our method may be more preferable for current massive parallel sequencing. Finally, on the basis of accurate estimation of haplotype frequency from pooled sequencing data, we revealed that it is feasible to identify rare haplotype carriers cost-effectively by applying overlapping pool sequencing. We have implemented the method in an open-source software tool Ehapp (estimate haplotype frequency from pooled sequencing data, http://bioinfo.seu.edu.cn/Ehapp/).
DISCUSSIONTaking advantage of prior haplotype information contained in the database, we present Ehapp for inferring haplotype frequencies from pooled sequencing data. NNREG algorithm is employed to calculate the frequency, which achieves sparse recovery by means of a conventional non-negative least squares algorithm. And the optimal for NNREG could be obtained by conducting substantial simulations.(b) Comparison on simulated sequencing data with read length ranging from 76 to 800 bp. '76r' denotes the results for real Illumina sequencing reads with length 76 bp and '76s' denotes the results for simulated sequencing reads with length 76 bp. Outliners for box plots are not shown. Haplotype with true frequency lower than 0.02 is neglected in the statistics of R diffResults of experiments on simulated sequencing data showed that higher depth of coverage and lower error rate could improve the performance of our method. With 0.01 sequencing error rate, our method could estimate the frequencies of haplotypes with only about 3% average relative errors for pooled sequencing of the mixture of 10 haplotypes with total coverage of 50. Thanks to the simplification for M; our method could maintain excellent performance for haplotypes with actual frequencies higher than 0.05 when unknown haplotypes exist. Comparisons with Harp on simulated data in conjunction with real sequencing data showed that our method is more outstanding for short reads with respect to SNP density and preferable for current massive parallel sequencing. Analysis for Arabidopsis data also revealed that our method performed better in distinguishing similar haplotypes. Since only the proportions of A, T, C and G for each SNP are used to recover haplotype frequencies, our method is much faster and requires fewer memories compared with Harp which takes all the reads into calculation. At last, we proved that overlapping pool sequencing could be applied in screening for rare haplotype carriers as long as haplotype frequencies can be inferred accurately from pooled sequencing data. The number of samples used in HapMap allows the project to find 99% of haplotypes with frequencies of 5% or greater in a population (). However, haplotypes with low frequencies (55%) can also be observed for many populations (). Although substantial errors happened for estimating the frequency of haplotype with proportion lower than 0.05 when unknown haplotype exists, this drawback could be addressed by completing the database to include haplotypes as much as possible. Alternatively, the number of pooled individuals could be constrained to be smaller than a threshold to make the lowest haplotype frequency higher than 0.05; therefore, the frequency for known haplotype could still be inferred accurately even when unknown haplotypes exist. One major application of our method is in casecontrol studies for finding diseases associated with haplotypes. After estimating frequencies for case and control samples independently, haplotype with frequencies that differ statistically significantly could be ascertained as disease-associated haplotypes. If the diseaseassociated haplotype is rare, overlapping pool sequencing could be applied to identify the carriers among large-scale samples precisely with much lower cost. We hope that our methods could be applied in the GWHA and screening for rare haplotype carriers. Besides, our method could also be applicable in non-pool situations, such as inferring the frequency of variants of duplicated regions (e.g. transposable elements) (). The software implementing the method, Ehapp, is open source and available for download and can be easily integrated into existing analysis pipelines.Note: Two haplotypes are identical for homozygous individuals. Aedal-1 is assigned as the rare haplotype. The 40th and 60th samples are simulated as heterozygous carriers for haplotype Aedal-1.