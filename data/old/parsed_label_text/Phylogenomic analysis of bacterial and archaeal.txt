With the explosive growth of bacterial and archaeal sequence data, large-scale phylogenetic analyses present both opportunities and challenges. Here we describe AMPHORA2, an automated phylogenomic inference tool that can be used for high-throughput, high-quality genome tree reconstruction and metagenomic phylotyping. Compared with its predecessor, AMPHORA2 has several major enhancements and new functions: it has a greatly expanded phylogenetic marker database and can analyze both bacterial and archaeal sequences; it incorporates probability-based sequence alignment masks that improve the phylogenetic accuracy; it can analyze DNA as well as protein sequences and is more sensitive in marker identification; finally, it is over 100Ã— faster in metagenomic phylotyping.
INTRODUCTIONAlthough the small subunit rRNA (SSU rRNA) is the 'gold standard' in microbial diversity studies, it has its limitations. For one, it has been shown that the GC compositional bias in rRNA could cause misleading phylogenetic artifacts (). For another, rRNA makes up only a tiny fraction (0.1%) of any given genome. Therefore, the organismal phylogeny based on rRNA alone needs to be corroborated with the analyses of other phylogenetic markers. Thirdly, there are large variations in the rRNA copy number in different bacterial and archaeal species, which prevents the use of rRNA for accurate estimation of the relative abundance of species in a population. Protein-coding genes such as EF-Tu, rpoB, recA and HSP70 have been used as alternative phylogenetic markers to complement rRNA-based analyses (). Because their sequences are conserved at the amino acid level, protein-coding genes offer at least two advantages over rRNA: (i) their protein sequences are less sensitive to GC compositional bias (). (ii) Their fast-evolving nucleotide sequences have more power to resolve the relationships * To whom correspondence should be addressed.between closely related organisms. In the past, the use of proteincoding genes in phylogenetic analyses has been hindered largely by the lack of available protein sequences. Recent explosive growth of microbial genomic sequences, however, has transformed the way we study microbial diversity. For example, now many genes can be combined to make robust 'genome trees', which could serve as a framework for genome-based bacterial and archaeal classification (;). The use of dozens of protein marker genes in addition to rRNA also greatly increases the power of metagenomic phylotyping. Furthermore, many of the protein marker genes are single-copy gene in the genome. Therefore, the species composition estimated from these markers should be more accurate than that estimated based on rRNA (). The promise of phylogenomics comes with new challenges. First, we need to select a set of robust marker genes that are universally distributed and are relatively recalcitrant to lateral gene transfers. Second, we need an efficient way of identifying their orthologs (and not just homologs) from genomic-scale sequences and of rapidly aligning them with the reference sequences. Third, to make high-quality trees, we need to filter out the unreliable alignment regions prior to the phylogenetic inference. The original AMPHORA package was designed to overcome these bottlenecks for automated, high-throughput, high-quality phylogenomic analyses (). However, several issues remain (). To address these issues, we redesigned AMPHORA, made significant enhancements and incorporated new algorithms and functions. We named it AMPHORA2 and describe it below.