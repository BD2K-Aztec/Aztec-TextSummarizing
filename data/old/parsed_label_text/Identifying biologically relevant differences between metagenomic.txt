Motivation: Metagenomics is the study of genetic material recovered directly from environmental samples. Taxonomic and functional differences between metagenomic samples can highlight the influence of ecological factors on patterns of microbial life in a wide range of habitats. Statistical hypothesis tests can help us distinguish ecological influences from sampling artifacts, but knowledge of only the P-value from a statistical hypothesis test is insufficient to make inferences about biological relevance. Current reporting practices for pairwise comparative metagenomics are inadequate, and better tools are needed for comparative metagenomic analysis. Results: We have developed a new software package, STAMP, for comparative metagenomics that supports best practices in analysis and reporting. Examination of a pair of iron mine metagenomes demonstrates that deeper biological insights can be gained using statistical techniques available in our software. An analysis of the functional potential of Candidatus Accumulibacter phosphatis in two enhanced biological phosphorus removal metagenomes identified several subsystems that differ between the A.phosphatis stains in these related communities, including phosphate metabolism, secretion and metal transport. Availability: Python source code and binaries are freely available from our website at
INTRODUCTIONWith its focus on ecologically relevant assemblages of microorganisms, metagenomicsthe assessment of randomly collected DNA fragments from a microbial communityhas revealed a new world of microbial diversity and complexity. Metagenomic studies can be motivated by several goals, including the discovery of novel genes of interest (), validation of metabolic hypotheses (), profiling of the relationship between microbial community composition and variation in environmental * To whom correspondence should be addressed. or geographic parameters () and assessment and comparison of the global metabolic complement found in one or more habitats (). Detailed assessment of communities requires intensive sequencing effort and careful experimental design to ensure that experimental questions can be adequately addressed (). A common outcome of a metagenome project is a set of functional predictions for the collected and assembled DNA reads, assigned via homology search and classified using a scheme such as the SEED () or KEGG (). When multiple samples are collected, functional classes can be organized into contingency tables that allow the assessment of statistically significant differences in the relative abundance of these classes. For example,sampled communities from an oxidized and anoxic environment within the Soudan iron mines and found evidence that these two communities preferentially utilize different respiratory pathways. Several dedicated bioinformatics applications have been developed for the statistical analysis of metagenome pairs, including XIPE-TOTEC (), ShotgunFunctionalizeR () and MEGAN (). Packages focusing on the complementary problems of assessing differences between groups of metagenomes have also been developed (). While such comparisons are informative, it is vital to distinguish results that are biologically relevant (i.e. truly different in frequency between two or more sites, due to some underlying taxonomic or ecological phenomenon) from those that are merely statistically significant. Statistical significance is neither a necessary nor a sufficient criterion for biological relevance () but is typically used as a filter to remove uninteresting features where the observed difference can reasonably be attributed to being a sampling artifact. Reasoning about the biological relevance of a feature requires consideration of effect sizes and their associated confidence intervals. Interpretation of statistical results can also benefit from transforming raw P-values to alternative measures with possibly superior interpretations () and by allowing interactive filtering that permits focusing on features with specific statistical properties. Here, we present a discussion of the key statistical concerns in metagenomic data analysis and introduce a new application, STAMP (STatistical Analysis of Metagenomic Profiles), which provides a user-friendly graphical environment for performing the statistical techniques discussed in this article.
DISCUSSIONIt is essential to consider potential sources of error and how they can influence the results of statistical techniques when making inferences about biological relevance. Comparative metagenomics relies heavily on a 'guilt by association' paradigm where the function or taxonomic origin of reads is assigned according to similarity with sequencing from a reference databases. This leads to four notable sources of error in metagenomic profiles: (i) assuming sequence similarity implies functional similarity, (ii) database bias favoring certain functional subsystems or taxonomic units, (iii) misannotations resulting in reads being incorrectly associated with a specific functional or taxonomic category and (iv) reads with no reliable match in a database being effectively discarded. Investigating the seriousness of these sources of errors is an active area of research (). Knowledge of effect size, CI width and number of sequences assigned to a feature is essential when deciding if these sources of error have the potential to explain the observed enrichment or depletion of a statistically significant subsystem or taxonomic unit. For statistical techniques to aid biological inference, they must be interpreted and reported correctly. STAMP provides a graphical environment for performing statistical analyses and interactively exploring results through publication quality plots with sufficient information to inferring biological relevance. These capabilities make STAMP a valuable tool that will aid researchers in interpreting and communicating the results of their statistical analyses.