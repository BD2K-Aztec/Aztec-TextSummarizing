GWASTools is an R/Bioconductor package for quality control and analysis of genome-wide association studies (GWAS). GWASTools brings the interactive capability and extensive statistical libraries of R to GWAS. Data are stored in NetCDF format to accommodate extremely large datasets that cannot fit within Rs memory limits. The documentation includes instructions for converting data from multiple formats, including variants called from sequencing. GWASTools provides a convenient interface for linking genotypes and intensity data with sample and single nucleotide polymorphism annotation.
INTRODUCTIONDespite the increasing popularity of next-generation sequencing, the relatively low cost of chip arrays and the recent introduction of exome chips continue to make genome-wide association studies (GWAS) an attractive option for many investigators. The success of GWAS depends in large part on rigorous quality control (QC) and quality assurance (QA) to ensure that falsepositive signals are removed and that real signals are not masked by low-quality data (). We present GWASTools, an R/Bioconductor package to facilitate QC/QA of large single nucleotide polymorphism (SNP) datasets. As SNP arrays have increased in size (commonly 41 million SNPs), it is often impossible to store an entire dataset in R's virtual memory, even at maximum compression of one byte per genotype. Analysing floating-point values, such as allelic probe intensity, requires even more storage space. Existing R packages for GWAS, such as snpStats (), store genotype matrices in memory and do not include intensity data. We use the network common data form (NetCDF) format to store large genotype and intensity datasets on disk with efficient access to subsets of the data. For an example dataset of 5000 samples and 1 000 000 SNPs (which exceeds R's limit of 2 31 elements in a single array), iterative read time for a NetCDF file is up to 22 times faster than a PED file. The benefits of GWASTools include the interactive analysis provided by R's interface and the ability to include intensity data. Intensity data can be used to detect sex chromosome aneuploidies (which can be confused with sex mis-annotation), autosomal anomalies (which generate genotyping errors) and evaluation of clustering by genotype call. GWASTools supports the following format conversions: inputplain text, PLINK, Variant Call Format, imputed genotypes (IMPUTE2, BEAGLE, MaCH); outputPLINK, snpStats objects. SnpAnnotationDataFrame and scanID in a ScanAnnotation DataFrame), but any number of other variables of different types may also be included. An important component of GWAS analysis is ensuring that annotation is mapped correctly to its corresponding genotype data. The classes GenotypeData and IntensityData each contain a NetCDF reader object, a SNP annotation object and a scan annotation object. On object creation, validity methods ensure that the primary keys of the NetCDF and annotation objects match. Most functions in GWASTools take GenotypeData and IntensityData objects as arguments, such that all necessary information (e.g. genotype, chromosome and sex) is contained in a single object. Common methods are provided to access data across multiple classes, including getSnpID, getScanID, getChromosome, getPosition, getSex and getGenotype. In designing GWASTools, we took care to separate the application programming interface of the GenotypeData and IntensityData classes from the format in which the data are stored. This design allows for extension to other data formats without changing any of the functions that use GenotypeData and IntensityData objects. For example, GWASTools contains classes for storing SNP and scan annotation in SQLite format, and for storing genotype data in-memory as a matrix or on disk in the highly efficient genomic data structure (GDS) format used by SNPRelate (). A GenotypeData object can be constructed with these objects as well. In addition to the functionality already included in GWASTools, one could make use of the GenotypeData and IntensityData classes to apply the many statistical functions available in R to GWAS data.