Motivation: Methylation of cytosines in DNA is an important epigen-etic mechanism involved in transcriptional regulation and preservation of genome integrity in a wide range of eukaryotes. Immunoprecipita-tion of methylated DNA followed by hybridization to genomic tiling arrays (MeDIP-chip) is a cost-effective and sensitive method for methylome analyses. However, existing bioinformatics methods only enable a binary classification into unmethylated and methylated gen-omic regions, which limit biological interpretations. Indeed, DNA methylation levels can vary substantially within a given DNA fragment depending on the number and degree of methylated cytosines. Therefore , a method for the identification of more than two methylation states is highly desirable. Results: Here, we present a three-state hidden Markov model (MeDIP-HMM) for analyzing MeDIP-chip data. MeDIP-HMM uses a higher-order state-transition process improving modeling of spatial dependencies between chromosomal regions, allows a simultaneous analysis of replicates and enables a differentiation between unmethy-lated, methylated and highly methylated genomic regions. We train MeDIP-HMM using a Bayesian Baumâ€“Welch algorithm, integrating prior knowledge on methylation levels. We apply MeDIP-HMM to the analysis of the Arabidopsis root methylome and systematically investigate the benefit of using higher-order HMMs. Moreover, we also perform an in-depth comparison study with existing methods and demonstrate the value of using MeDIP-HMM by comparisons to current knowledge on the Arabidopsis methylome. We find that MeDIP-HMM is a fast and precise method for the analysis of methylome data, enabling the identification of distinct DNA methylation levels. Finally, we provide evidence for the general applicability of MeDIP-HMM by analyzing promoter DNA methylation data obtained for chicken.
INTRODUCTIONMethylation of genomic DNA is one of the best characterized epigenetic modifications catalyzed by DNA methyltransferases that methylate cytosines at their carbon-5 position (). In mammals, DNA methylation is found exclusively in the CpG dinucleotide context, except in embryonic stem cells, where a small proportion of cytosines in other contexts (CpA, CpT and CpC) are also methylated. In plants, DNA methylation is found in symmetric CpG and CpHpG and in asymmetric CpHpH contexts (H  A, T or C). Generally, DNA methylation plays important roles in regulation of gene expression () and silencing of transposons (;). Despite recent developments of next-generation sequencing approaches for determining methylomes at single base pair resolution (e.g.), methylomes of different organisms or cell tissues are also frequently analyzed using whole-genome tiling arrays (e.g.), which provide cost-effective alternatives. Most array-based studies are done based on methylated DNA immunoprecipitation coupled with hybridization to a tiling array (MeDIP-chip) (). MeDIP-chip enables to analyze the methylome of a genome at a resolution of few hundred base pairs, which in most applications is sufficient to draw biologically meaningful conclusions. The analysis of MeDIP-chip data puts similar challenges on bioinformatics methods, as identified for the analysis of closely related array-based chromatin immunoprecipitation data (ChIP-chip). Different methods for the analysis of ChIP-chip data were proposed over the last years. Especially, methods based on hidden Markov models (HMMs) (e.g.) and on mixture models (e.g.) were shown to enable reliable predictions of chromosomal target regions of transcription factors or histone modifications. A common characteristic of all these methods is the modeling of two different populations of measurements to differentiate non-enriched genomic regions from enriched ones. Main conceptual differences exist in the *To whom correspondence should be addressed. way of modeling dependencies between adjacent measurements on a chromosome, in handling of replicates and in training algorithms. From these methods, only approaches based on HMMs integrate dependencies between directly adjacent measurements on a chromosome. Some methods only enable a separate analysis of replicates (e.g.), whereas others try to improve the analysis by simultaneous modeling of replicates (e.g.). Mixture models are typically trained by specifically designed expectation maximization (EM) algorithms (). HMM-based methods except TileMAPHMM () and HMMs byuse a BaumWelch training (), representing a special case of an EM algorithm. TileMAPHMM is based on data-dependent ad hoc settings, and HMMs byenable the integration of prior knowledge on measurements using a Bayesian BaumWelch algorithm. All these methods are useful tools for the analysis of ChIP-chip data. Additionally, some methods like ChIPmix () and a mixture-model approach byhave already been applied to the analysis of MeDIP-chip data. One general limitation of all these methods in the context of MeDIP-chip data analyses is that they only enable a binary classification into unmethylated and methylated regions. MeDIP-chip data is known to be more complex, showing differences in methylation levels of individual chromosomal regions as, for example, revealed for Arabidopsis thaliana having moderately methylated genes and highly methylated transposons (). To address that, a three-state HMM specifically designed for the analysis of Arabidopsis MeDIP-chip data has been developed in a companion work by. This approach uses Arabidopsis-specific ad hoc settings and enabled a better interpretation of MeDIP-chip data using a classification of methylation states of genomic regions according to the underlying three states. Generally, organism-specific ad hoc settings can only be hardly transferred to MeDIP-chip data of other organisms. Thus, there is still a great demand of having a general method that is able to differentiate between different methylation levels without being dependent on a specific organism. Moreover, a systematic performance evaluation of different methods for analyzing DNA methylation data has not been carried out up to now, and current HMM-based methods only focus on standard first-order HMMs. Here, we present MeDIP-HMM, a method specifically designed for the analysis of MeDIP-chip data. MeDIP-HMM utilizes three states to differentiate between unmethylated, methylated and highly methylated regions overcoming limitations of typically used ChIP-chip methods only enabling a binary classification into unmethylated and methylated regions. Additionally, MeDIP-HMM can perform a simultaneous analysis of replicates and integrates prior knowledge on measurements to improve the identification of methylated genomic regions. Moreover, MeDIP-HMM can also take advantage of higher-order hidden Markov chains to improve spatial modeling of dependencies between neighboring regions. This has recently been found to improve the analysis of comparative genomics data () and provides a valuable option for improving the analysis of MeDIP-chip data. We apply our MeDIP-HMM to the analysis of the Arabidopsis root methylome and systematically evaluate the influence of using higher-order Markov chains on the identification of methylated genomic regions. We further perform an in-depth comparison study to widely used existing methods and demonstrate advantages of using MeDIP-HMM based on comparisons to current knowledge on the Arabidopsis methylome. We also show that MeDIP-HMM can be applied to non-Arabidopsis data by performing an additional study on promoter DNA methylation data obtained for chicken ().