We have developed a software package, Cortex, designed for the analysis of genetic variation by de novo assembly of multiple samples. This allows direct comparison of samples without using a reference genome as intermediate and incorporates discovery and genotyping of single-nucleotide polymorphisms, indels and larger events in a single framework. We introduce pipelines which simplify the analysis of microbial samples and increase discovery power; these also enable the construction of a graph of known sequence and variation in a species, against which new samples can be compared rapidly. We demonstrate the ease-of-use and power by reproducing the results of studies using both long and short reads.
INTRODUCTIONGenome sequencing of pathogens is of growing value to public health as a means of distinguishing genetic variants correlated with drug resistance () or virulence (den), for tracking of transmission chains, and for within-host evolution studies (). At the heart of all these applications is the requirement to be able to compare the genomes of different samples. Most current tools () are dependent on alignment to a reference genome, and cannot detect differences between genomes directly. It is known that alignment introduces a bias towards the reference () and has limited power for indel discovery. Furthermore, using a reference is inherently problematic as microbial strains can be highly diverged. We showed inthat the Cortex assembler has power to detect single-nucleotide polymorphisms (SNPs), indels and structural variants by simultaneously de novo assembling multiple samples (each corresponding to a 'colour' in a de Bruijn graph) and detecting variants as graph motifs. A limitation of a de Bruijn graph approach is the use of a single kmer size. There is in general no optimal kmer for variant discovery in a given datasetvariants near repeat sequence will only be discoverable at higher kmers, but lower coverage variants will need a lower kmer) Supplementary Information Section 1.3 onwards]. We have therefore introduced pipelines to do discovery on many samples at many kmer values, and then genotype all samples at all discovered sites. Discovery can be done jointly in all samples (with or without a reference), or per sample against a reference. We demonstrate by reproducing the results of two published studies. loaded into the graph for discovery/genotyping. Processing 1000 Staphylococcus aureus samples would require of the order of 106 Gb RAM (Supplementary Information, Section 5). Time complexity of each step is shown in; note the nonparallelizable steps scale linearly with number of samples.
CONCLUSIONWe have shown that the Cortex population assembler provides a method for rapid, high-quality variant discovery in microbial genomes and allows comparison of new samples with all previously known strains. We believe it will prove valuable in microbial population genomics.. Cartoon shows two samples (red and blue) and a diverged reference genome (black) in a de Bruijn graph; symbols indicate which workflows call sites. Brackets indicate flanking regions cannot be placed on reference, so the call is filtered from VCF. At SNP B, the independent workflow would call the red and blue versions of H and would implicitly find B. C is only called if the reference is excluded from discovery, as it confounds the red allele. D is called by workflows that include the reference in discovery