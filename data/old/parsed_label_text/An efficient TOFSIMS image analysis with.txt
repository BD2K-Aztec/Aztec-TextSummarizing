Motivation: Advances in analytical instrumentation towards acquiring high-resolution images of mass spectrometry constantly demand efficient approaches for data analysis. This is particularly true of time-of-flight secondary ion mass spectrometry imaging where recent advances enable acquisition of high-resolution data in multiple dimensions. In many applications, the distribution of different species from a sampled surface is spatially continuous in nature and a model that incorporates the spatial correlation across the surface would be preferable to estimations at discrete spatial locations. A key challenge here is the capability to analyse the high-resolution multidimen-sional data to extract relevant information reliably and efficiently. Results: We propose a framework based on alternating nonâ€“negativity-constrained least squares which accounts for the spatial correlation across the sample surface. The proposed method also decouples the computational complexity of the estimation procedure from the image resolution, which significantly reduces the processing time. We evaluate the performance of the algorithm with biochemical image datasets generated from mixture of metabolites.
IntroductionImaging mass spectrometry (IMS) is an increasingly popular approach in the characterization of biological samples (). It is a powerful tool to image surface structure with a mass spectrum measured at each pixel. One IMS technique is time-of-flight secondary ion mass spectrometry (TOF-SIMS) with applications in areas as varied as hair care (), medical implants () and drug delivery systems (). It is primarily applied in monitoring the distribution of targeted chemical species, but can also be employed for imaging surfaces in non-targeted analyses, when surface compositions are not well defined, in particular in the analysis of biological systems (). However, this latter extension poses several challenges with respect to data deconvolution. Multivariate analysis (MVA) methods have been used extensively to map large complex spatio-spectral TOF-SIMS data into factors of single components providing insights into the type and distribution of chemical species on a surface. Popular MVA techniques to describe spatiospectral TOF-SIMS data include principal component analysis (PCA) (), maximum auto-correlation factor (MAF) () and multivariate curve resolution (MCR) (). The PCA is perhaps the most commonly used technique, either as a main analysis step () or an initialization step() for MA approach. MAF is an alternative to PCA which is independent of pre-treatment scaling. The method is based on maximizing the autocorrelation between neighbouring pixels. A comparison of the two methods for TOF-SIMS data analysis is reported in, recommending the use of MAF when images with low spectral intensity are analysed. The presence of negative peaks in the spectrum computed using PCA or MAF makes it more difficult to interpret the resulting factorization. MCR optimized by alternating least squares (MCR-ALS) () overcomes this problem by imposing a non-negativity constraint in an iterative optimization process (). However, these methods can be computationally expensive when applied to large three-way datasets. The fast combinatorial nonnegativity-constrained least squares (FC-NNLS) algorithm (Van) is specifically designed to handle such datasets, allowing for significant gains in the speed and computational demands of the optimization process in ALS applications. Despite a substantial performance increase in FC-NNLS, the estimation of loadings and scores when decomposing large TOF-SIMS data in an MCR-ALS algorithm can still be problematic. One limitation is that the complexity of the scores estimation is coupled with the number of image pixels. Therefore, an increase in the image resolution of the sample surface leads to increases in the uncertainty and computational demands of the score and loading estimates. This is becoming increasingly important as sophisticated TOF-SIMS images with higher spatial resolution are becoming more widespread (). Even for a currently typical TOF-SIMS dataset with 128  128 pixels and a spectral mass range up to 1000 Da, the implementation of ALS algorithm with three spectral basis functions contains the estimation of 128  128 3 values in the scores estimation step. This emphasizes the benefit of decoupling the number of pixels in images and the number of parameters. In addition, the progress towards acquisition of image data in voxels as opposed to pixels confers further demand on the analysis time and efficiency of data processing (). Additionally, in cases where the spatial distribution of compounds in an image is continuous such as chemical samples or samples from a biological cell or a cellular environment, the characteristics at proximate/distant regions on the surface are expected to be highly/weakly correlated. This requires the inclusion of the spatial correlation across the surface in the estimation of scores and loadings from TOF-SIMS data. We propose an approach to MCR-ALS that incorporates a continuous-over-space formulation which accounts for spatial correlation across the sample surface. Additionally, the algorithm does not couple the complexity of the estimation procedure to the resolution of TOF-SIMS images, resulting in a significant reduction in the processing time. We exploit the method of a basis function decomposition of scores images which simplifies the estimation of individual pixel values into a set of weights. These weights scale the continuous basis functions and lie in a significantly lower dimensional space. We set out to examine the algorithm with biochemically relevant model image datasets that were generated from simple mixture of metabolites, as an example.