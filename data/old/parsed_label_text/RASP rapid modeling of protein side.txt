Motivation: Modeling of side chain conformations constitutes an indispensable effort in protein structure modeling, protein–protein docking and protein design. Thanks to an intensive attention to this field, many of the existing programs can achieve reasonably good and comparable prediction accuracy. Moreover, in our previous work on CIS-RR, we argued that the prediction with few atomic clashes can complement the current existing methods for subsequent analysis and refinement of protein structures. However, these recent efforts to enhance the quality of predicted side chains have been accompanied by a significant increase of computational cost. Results: In this study, by mainly focusing on improving the speed of side chain conformation prediction, we present a RApid Side-chain Predictor, called RASP. To achieve a much faster speed with a comparable accuracy to the best existing methods, we not only employ the clash elimination strategy of CIS-RR, but also carefully optimize energy terms and integrate different search algorithms. In comprehensive benchmark testings, RASP is over one order of magnitude faster (∼40 times over CIS-RR) than the recently developed methods, while achieving comparable or even better accuracy. Availability: RASP is available to non-commercial users at our website
INTRODUCTIONProtein side chain conformation prediction or side chain packing is a crucial step in both protein design () and protein structure modeling (). As such, during the last two decades, many efforts have been dedicated to the prediction of protein side chain conformations, leading to the development of many side chain packing programs (). In general, these side chain packing programs formulate the side chain conformation prediction problem as a combinatorial search problem based on discrete side * To whom correspondence should be addressed. chain conformations, called rotamers. The problem usually involves three key elements, summarized as follows:(i) A rotamer library of discrete side chain conformations (;). Although some approaches attempted to model the continuous side chain conformations (), most of the current methods rely on discrete rotamers, which can significantly reduce computational expense ().(ii) An energy function for rotamer selection. A number of energy functions for side chain packing have been proposed, ranging from simple van de Waals potential () to more complicated potentials by incorporating hydrogen bonding term (), solvation term () and statistical orientation term () to improve the prediction accuracy.(iii) A search algorithm. The use of rotamer library leads to the formulation of the side chain packing problem as a combinatorial problem, which finds the best solution from all the possible combinations constrained by side chain rotamers. Many search algorithms have been proposed to solve the combinatorial problem, including dead-end elimination (DEE) (), simulated annealing (), Monte Carlo (), A* (), integer programming (), self-consistent mean field () and graph theory-based approach (). The combining of these search algorithms is critical in side chain prediction. For example, to achieve a fast speed, SCWRL4 () and SCATD () combine DEE, branch-and-bound and tree-decomposition search.As summarized above, the appropriate consideration of the above three elements is critical in developing rotamer-based side chain packing programs. Thanks to the intensive previous efforts, the prediction of side chain conformations has become more and more accurate. However, the improvement of accuracy usually comes with the increase of computational time. For example, although the recently developed side chain packing program SCRWL4 from Dunbrack's laboratory and the program CIS-RR developed in our laboratory () have an improvement of 3% in  accuracy over SCRWL3, their speed is over 6 times slower than SCRWL3, indicating the challenge in achieving both high accuracy and high speed in the prediction of protein side chain conformations. In this study, by carefully considering the key elements summarizedPage: 3118 31173122
DISCUSSIONDetermination of side chain conformations on a fixed protein backbone plays an important role in protein structure prediction, protein design and molecular docking. In hitherto, many methods have been developed to predict protein side chain conformations (). Although the prediction has become more and more accurate, the gradual improvement of accuracy usually comes with the dramatic increase of computational cost. In this study, in order to improve speed without at expense of prediction accuracy, we have developed a more powerful program, called RASP. The tests showed that RASP achieves high prediction accuracy comparable to the best existing methods, but is much faster.The good performance of RASP lies in its elegant integration of the strategies used in the existing approaches, which is contributed by three critical points discussed as follows: One is the design of energy function to achieve both high accuracy and high speed. Previous studies have indicated that van der Waals potential alone is able to achieve a high accuracy in prediction of side chain conformations (), suggesting the dominant role it plays in side chain packing. Although the incorporation of other energy terms could improve the accuracy of side chain packing, the consideration of complicated energy terms would aggravate the computational expenses. Therefore, in developing an effective energy function for side chain packing, all the individual energy terms were carefully implemented for fast speed and high accuracy. To calculate van der Waals potential, the hydrogen atoms were not represented explicitly and their effects, through parameterization, could be captured in the heavy atoms that are linked to hydrogen atoms (Supplementary). As shown in Supplementary Table S2, among the heavy atoms of the same type, the ones with more hydrogen links have longer van de Waals radii. For simplicity and fast computation, the effect of dihedral CC SS is omitted in the disulfide term, and the hydrogen bonding term only depends on the orientation between the hydrogen donor and hydrogen acceptor. The careful consideration of these energy terms led us to develop an effective energy function for side chain packing. As demonstrated by our testing described above, RASP is not only much faster than CIS-RR, but also is slightly better than CIS-RR (with 0.2% improvement in both  1 and  1+2 accuracy) (Supplementary Table S6 and S7). The second is the use of clash detection-guided rotamer relaxation after side chain packing process. Further elimination of the atomic clashes in protein structures with modeled side chains can lead to more harmonic structures. Our recently developed CIS-RR coupled side chain packing process with the elimination of atomic clashes by using clash detection-guided iterative search in rotamer relaxation. Although in CIS-RR both the accuracy of side chain packing and removal of atomic clashes can be achieved, it is time consuming. In RASP, we uncoupled the side chain packing process and atomic clash elimination process. The rotamer relaxation was performed on the side chains that are involved in atomic clashes. By doing this, we found that rotamer relaxation process in RASP can effectivelyeliminate the atomic clashes without incurring the computation time significantly (, Supplementary). Moreover, the elimination of atomic clashes has led to a slight increase of prediction accuracy. The SCWRL4 test set was used for the evaluation. Total time for the prediction is evaluated. Clashes are those residue pairs whose distance is 60% the summation of their van de Waals radii.  dihedrals within 40 @BULLET are considered correct. The third is the implementation of effective search algorithms. To achieve a fast and convergent search, we designed a combinatorial search strategy involving graph theory-based approach which decomposed the graph of contact residue pairs to bi-connected components (see Section 2). For a bi-connected component of N residues, its time complexity is  O(m N ) (m is the average rotamer number in a residue) for an exhaustive search like branchand-terminate approach, while for Monte Carlo search the time complexity is O(mN). Therefore, in design of search algorithms, we used MC search instead of the exhaustive branch-and-terminate search for a large bi-connected component with over 20 residues. Indeed, we found use of MC search can significantly reduce the computation time for large proteins. Supplementarycompares the performance of RASP using MC or not on SCWRL4 test set. As can be seen from Supplementary Table S9, although the improvement by adding MC is general to nearly all proteins, it varies significantly for different proteins. Especially, for those proteins that tend to form highly connected graphs (often occurring in large proteins of over 300 residues), MC contributes significantly to the speed improvement. Taken together, RASP not only combines the advantages of the existing programs in both prediction accuracy and clash elimination, but also achieves a much faster speed. We believe RASP would be a very useful tool for fast side chain modeling that can complement the current existing methods in a wide range of applications.