Motivation: The arbor morphologies of brain microglia are important indicators of cell activation. This article fills the need for accurate, robust, adaptive and scalable methods for reconstructing 3-D microglial arbors and quantitatively mapping microglia activation states over extended brain tissue regions. Results: Thick rat brain sections (100–300 mm) were multiplex immunolabeled for IBA1 and Hoechst, and imaged by step-and-image confocal microscopy with automated 3-D image mosaic-ing, producing seamless images of extended brain regions (e.g. 5903 Â 9874 Â 229 voxels). An over-complete dictionary-based model was learned for the image-specific local structure of micro-glial processes. The microglial arbors were reconstructed seamlessly using an automated and scal-able algorithm that exploits microglia-specific constraints. This method detected 80.1 and 92.8% more centered arbor points, and 53.5 and 55.5% fewer spurious points than existing vesselness and LoG-based methods, respectively, and the traces were 13.1 and 15.5% more accurate based on the DIADEM metric. The arbor morphologies were quantified using Scorcionis L-measure. Coifmans harmonic co-clustering revealed four morphologically distinct classes that concord with known microglia activation patterns. This enabled us to map spatial distributions of microglial activation and cell abundances. Availability and implementation: Experimental protocols, sample datasets, scalable open-source multi-threaded software implementation (Cþþ, MATLAB) in the electronic supplement, and website (www.farsight-toolkit.org).
IntroductionMicroglia are immune cells of the mammalian central nervous system whose importance to brain function is receiving growing recognition (). Normally, these cells are distributed throughout the brain in non-overlapping territories, and comprise up to 20% of the glial cell population (). Their arbor morphologies are dynamic, informative of their internal state of activation and are related to tissue perturbations. Resting microglia exhibit motile and highly branched arbors that constantly screen for perturbations in their local environment. There is considerable heterogeneity in microglial populations, even in normal brain tissue. When perturbed by pathological stimuli, they undergo rapid changes in arbor morphology and migrate toward the lesion site (). The arbor morphologies are indicators of cell activation, and are valuable regardless of any molecular markers of activation. For these reasons, there is a need for methods to analyze individual microglial arbors, profile arbor alterations and map spatial distributions over extended tissue regions. Capturing these phenomena given the small dimensions of microglial processes (2 mm) requires high-resolution microscopy. Accurately capturing the asymmetrical arbors of non-resting microglia, requires three-dimensional (3-D) imaging of tissue samples that are thick enough to include entire cells. Capturing perturbations to spatial distributions of these cells requires high-extent imaging, especially when the lesions are much larger than the field of view of the microscope ().illustrates the use of step-and-image confocal microscopy and computational image mosaicing to record large 3-D images of brain tissue. Our goal is to describe automated methods for quantifying microglial arbor morphologies and spatial distributions of activation in such images. In considering arbor tracing methods, we note that there is a vast literature on tracing algorithms for neurons (). In contrast, the literature on microglial arbor analysis is much smaller (). Importantly, the prior efforts have tackled much smaller cell populations than reported here, cannot reconstruct microglia seamlessly and three-dimensionally across significant extents of brain tissue (multiple mmcm), and do not guarantee that the reconstructions have a tree topology. Finally, the prior literature does not address population-scale quantitative analysis of microglial arbors as a function of activation. The prior literature on automated neuron tracing provides a valuable basis for reconstructing microglia, but there are important limitations that are specific to microglia that remain unaddressed. Most of the methods are based on pre-defined analytical models of the tubularity ('vesselness') and continuity of neurites. For example,used the multi-scale curvelet transform to model neurites. Automated neurite tracing methods are generally based on modelbased sequential tracing (); probabilistic extraction of centerlines () or on segmentation (). The neurite centerlines are usually detected by variations of skeletonization (), or voxel coding (). For handling complex/dense neurite fields, various approaches have been proposed for negotiating branches and crossovers (). The tracing performance depends on the quality of seed points, effective modeling of the peculiarities of the images being processed, and tracing control criteria (stopping, branching, negotiating crossovers, etc.). Our method is designed to address the needs of large-scale microglia reconstruction by exploiting microglia-specific constraints (e.g. known topology), and using algorithms that are specifically designed for mosaiced high-extent imaging of brain tissue (). Specifically, we address the need to cope with biological and imaging variability within and across samples, without having to retune algorithm parameters. For this, we propose a machine learning approach for modeling the characteristics of microglia in actual images, rather than resorting to a pre-defined analytical model as in the prior work on neuron tracing. To overcome the difficulty of tuning parameters over large-extent images, we propose algorithms with very few parameters that are easy to interpret and adjust. Our method detects the microglial processes reliably using a machinelearning algorithm, and traces the arbors subject to a topological constraint. Appropriately designed cost terms guide our algorithm to exploit the fact that microglia, unlike neurons, are spatially localized (lacking long processes, e.g. axons). Whereas tight fiber crossovers are common for neurite fields, they are rare for microglia. Furthermore, microglia do not form inter-connections with neighboring cells. The more pressing challenge in our work to correctly reconstruct microglia that are split across the microscope fields to enable accurate spatial distribution analysis. Our method uses these same constraints to handle such cells. To achieve scalability, our method is designed to exploit parallel computers. This results in an array of arbor reconstructions, one per IBA1 microglial cell that can be visualized and proofread using 3-D visualization tools that are capable of handling thousands of cells at a time (). The overall pipeline is very usable and scalable. The few adjustable parameters of our method affect the results smoothly, permitting stable and objective analysis of microglia morphologies. The resulting reconstructions are directly amenable to quantitative analysis using Scorcioni's L-measure (). The quantitative arbor measurements are analyzed by Coifman's harmonic co-clustering to reveal morphologically distinct arbor classes that concord with the known microglia activation patterns. ApplicationThree-dimensional reconstruction and quantitative profiling of microglia populationsof these methods to brain tissue analysis will provide unprecedented measurements of microglia as a function of physiological and pathological stimuli.