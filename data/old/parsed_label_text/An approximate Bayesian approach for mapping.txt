Many high-throughput sequencing experiments produce paired DNA reads. Paired-end DNA reads provide extra positional information that is useful in reliable mapping of short reads to a reference genome, as well as in downstream analyses of structural variations. Given the importance of paired-end alignments, it is surprising that there have been no previous publications focusing on this topic. In this article, we present a new probabilistic framework to predict the alignment of paired-end reads to a reference genome. Using both simulated and real data, we compare the performance of our method with six other read-mapping tools that provide a paired-end option. We show that our method provides a good combination of accuracy, error rate and computation time, especially in more challenging and practical cases, such as when the reference genome is incomplete or unavailable for the sample, or when there are large variations between the reference genome and the source of the reads. An open-source implementation of our method is available as part of Last, a multipurpose alignment program freely available at
INTRODUCTIONMany high-throughput sequencers provide a paired-end option, in which each of the two opposite strands of a DNA fragment is read from the edge to the interior in the 5 0 3 0 direction, generating a pair of reads. Paired-end reads can be obtained by a simple modification to the standard single-end workflow; yet, they provide several benefits over single-end reads. They contain extra positional information that aids in accurate mapping of reads to a reference, for instance, by disambiguating alignments when one of the ends aligns to a repetitive region. They are also extremely useful in downstream analyses of structural variations, such as detection of indels or rearrangements. In this article, we focus on the former: the task of mapping a set of paired-end reads to a reference genome, which is often the first and fundamental step in inferring biological phenomena from high-throughput sequencing data. To motivate our work, we compare inthe results of mapping 1 million pairs of simulated human reads to the human reference using various alignment tools in their paired-end and single-end modes. For nearly all the aligners, the use of pairing information significantly improves mapping accuracy. Various read mapping tools support paired-end data, although not all provide adequate statistical treatment. Mappers such as Bowtie2 (), SOAP2 () and GSNAP () require the user to input the expected value and standard deviation of the genomic distance between the two ends. Based on this information, they flag a pair of mapped reads as being either 'concordant' or 'discordant', for possible use in analyses of structural variations. However, the user may not know before-hand the expected genomic distance, especially when relying on third-party datasetssome provide reliable information about the fragment size distribution, but not all do. BWA () does not rely on user-provided fragment size thresholds and estimates the fragment size distribution from uniquely mapped pairs. Another feature of the paired-end strategy of BWA is that if only one end is reliably mapped, it attempts to 'rescue' the other end by aligning it using the SmithWaterman algorithm in the area implied by the inferred fragment size. Like BWA, STAMPY (Lunter and) learns the fragment size distribution from the input data and also attempts to rescue mates for pairs whose ends do not map uniquely and at sufficiently close distance to each other. Additionally, it uses an elaborate probabilistic model that incorporates pairing information to compute for a pair of alignments of a read pair, the posterior probability of having predicted an incorrect alignment. Novoalign (www.novocraft. com) computes a similar mapping quality for each paired alignment, but it relies on the user to provide the fragment size distribution. We propose a new approach to apply pairing information for mapping paired-end reads. We first align each read independently to obtain candidate alignments. For each candidate, we apply our new probabilistic model to estimate the posterior probability that this alignment is incorrect by considering other candidate alignments of the read, those of its mate and the fragment size distribution. To allow for the possibility that paired reads may actually come from disjoint locations in the reference, our model includes a prior probability on the occurrence of such an event. One major departure from previous methods is that we calculate marginal posterior probabilities for each candidate alignment of a read (as opposed to associating this value to a read pair). Our method also benefits from using Last () in the alignment phase. Last, like BLAST, computes *To whom correspondence should be addressed.  The Author 2013. Published by Oxford University Press. This is an Open Access article distributed under the terms of the Creative Commons Attribution License (http://creativecommons.org/licenses/by/3.0/), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited. local alignments based on a seed-and-extend technique, but it is fast because of the use of adaptive seedsthus allowing the application of classic sequence alignment techniques to the problem of mapping giga-scale sized sets of reads generated by high-throughput sequencers. We describe our method in detail in Section 2. We compare the performance of our method with six other mapping tools in Section 3. For each mapping tool, the technique used to align individual reads hugely influences the final outcome, and as it is not feasible to isolate the pairing algorithm, we are comparing to some extent the performance of the alignment algorithms as well. Many articles that introduce new read mapping tools or survey them provide benchmarking tests that tend to be not very informativeonly ideal or easy cases are testedor even misleadingperformance is measured by counting the number of reads mapped, with complete disregard to the correctness of mapping. In this article, we conduct more rigorous tests that cover various practical scenarios.
DISCUSSION