Motivation: Advances in chromosome conformation capture and next-generation sequencing technologies are enabling genome-wide investigation of dynamic chromatin interactions. For example, Hi-C experiments generate genome-wide contact frequencies between pairs of loci by sequencing DNA segments ligated from loci in close spatial proximity. One essential task in such studies is peak calling, that is, detecting non-random interactions between loci from the two-dimensional contact frequency matrix. Successful fulfillment of this task has many important implications including identifying long-range interactions that assist interpreting a sizable fraction of the results from genome-wide association studies. The task – distinguishing biologically meaningful chromatin interactions from massive numbers of random interactions – poses great challenges both statistically and computationally. Model-based methods to address this challenge are still lacking. In particular, no statistical model exists that takes the underlying dependency structure into consideration. Results: In this paper, we propose a hidden Markov random field (HMRF) based Bayesian method to rigorously model interaction probabilities in the two-dimensional space based on the contact frequency matrix. By borrowing information from neighboring loci pairs, our method demonstrates superior reproducibility and statistical power in both simulation studies and real data analysis. Availability and implementation: The Source codes can be downloaded at:
IntroductionChromosomal DNA must be tightly packed to fit within the limited space of the nucleus. The intricate, highly compacted folding of the chromosomes, however, is by no means random. Chromatin architectures are closely linked to genomic functions by influencing how genetic information is accessed, read, and interpreted in a given cell and under certain local micro-environmental conditions via dynamic interactions among genes and their regulatory elements. For example, a long-range loop structure can be formed to link a distant enhancer with its target gene to regulate gene transcription. Hence, characterization of the three dimensional (3D) genome organizations is critical to understanding genomic function (). Recent advancements in chromosome conformation capture (3C) () and derived methods (such as 3C, 4C, 5C and Hi-C) allow the study of 3D chromosome organization with increasing resolution and throughput. These 3C-based methods quantify the interaction or contact frequency, how often any pair of loci in the genome is in close spatial proximity. For 3C, a locus is the unit of analysis and corresponds to one restriction enzyme fragment (hereafter termed fragment). Approaches to analyze interaction frequencies fall largely into two complementary categories: 3D model reconstruction and peak calling. The first set of methods simultaneously model contact frequencies of all pairs of loci in the genome to reconstruct 3D structure (). The second set of methods aim to identify interaction peaks, meaning pairs of loci where the observed contact frequency is higher than expected from non-random chromatin looping or co-location events (). To answer many important biological questions (e.g. pinpointing individual cis-regulatory elements), higher resolution for the contributing loci is highly desirable, if not indispensable. This paper focuses on peak calling. Identifying non-random contacts is of fundamental biological interest to researchers due to their relevance for functional regulation. For instance, it can shed light on the functional mechanisms of non-coding complex trait associations identified in genome-wide association studies (GWAS). GWAS have been resoundingly successful, identifying thousands of variants associated with complex traits. Only a small proportion (712%) fall in protein coding regions () making interpretation of non-coding variants imperative. Although a large number of regulatory elements have been annotated (), their target genes are largely unknown (). Recent 3C-based studies are generating an increasingly comprehensive catalog of interactions between genes and their regulatory elements in different cell types at varying resolution across multiple organisms including drosophila, yeast, mouse and human (). Such information will be fundamental to understanding functional mechanisms. For example, a recent study () used 4C data to identify longrange (at megabase distances) interactions between the obesityassociated intronic variants in FTO and the homeobox gene IRX3, with the expression of IRX3 rather than FTO being directly linked to body mass. This study showcased the value of interactions identified from the 3C-based studies for shedding light on the functional mechanisms of genetic variants implicated by GWAS. Several computational and statistical methods have been developed for this important peak calling task for data generated from 3C-based methods.developed a 5C peaking calling algorithm where they first estimated the null contact frequencies (average and standard deviation) using nonparametric lowess smoothing over genomic distance (using all pairs with the assumption that the vast majority of interactions are random collisions), then calculated standardized z-scores and raw P-values by fitting the z-scores to a Weibull distribution, followed finally by converting the raw P-values into q-values for FDR analysis.binned pairs of loci according to genomic distance, estimated null contact probabilities within each bin, and called peaks by assuming the contact frequency of every pair in each bin followed an identical binomial distribution.developed a pipeline to estimate the expected contact frequency accounting for locus length, inter-locus distance, mappability and GC content, and then tested for significant interaction by assuming the observed contact frequency followed a negative binomial distribution. Most recently,refined the binning method in Duan et al. (2010) and to develop Fit-Hi-C. Specifically, Fit-Hi-C provided more accurate estimates of the contact probabilities by fitting nonparametric spline curves across genomic distances (instead of discrete binning), re-fitting spline curves after filtering non-random collisions based on the initial spline, and modeling other Hi-C biases by incorporating locus-specific correction factors inferred from a previously published iterative correction and eigenvector decomposition method (). These existing methods have advanced the field by improving the accuracy in the estimation of the expected contact frequencies under the null (i.e. random collisions). All these methods take into account genomic distance between the pair of loci under inference during the estimation, with some () incorporating other genomic biases. However, all existing methods, by testing each individual pair of loci independently, ignore the potential correlation among pairs of loci. This was less of an issue with lower resolution data when multiple fragments combined into metafragments served as the units of analysis. When analyzing a fragment resolution Hi-C data, Jin et al.(2013) recognized this potential issue and developed the anchorfragment caller (AFC), an ad hoc approach to accommodate the correlation of peak status among neighboring fragment pairs. In AFC, one anchor was fixed (either a fragment or mega-fragment from consecutive smaller fragments) and one-dimensional peak calling was performed. For each anchor, the algorithm started with the identification of candidate peak regions. A candidate peak region could encompass multiple consecutive fragments with moderate marginal evidence for non-random interaction with the anchor and, importantly, AFC allows for small gaps. Peaks were called by aggregating information across the entire candidate peak region via assigning thresholds on read counts and P-values from contributing fragment pairs as well as from the entire region cumulatively. As an initial attempt to model the spatial dependency of the underlying peak status, AFC performed reasonably. We believe that the existing methods are not yet optimal, and that improvements in multiple aspects are needed. First, an improved analysis suite for data from 3C-derived methods should be based on an explicit model that yields clear and reproducible expectations for genome-wide interaction frequencies. Second, existing approaches choose anchor fragment(s) arbitrarily and also ignore any correlations between neighboring fragments or anchors. For example, we found that neighboring anchors often interact with the same target fragments, suggesting that these anchors are parts of a bigger region involved in the same DNA looping event. Therefore an ideal peak caller should consider correlations between neighboring A hidden Markov random field-based Hi-C peak callerfragments in the context of a two-dimensional (2D) contact matrix generated from 3C-derived technologies. Third, onedimensional calling approaches are not optimal, do not incorporate useful existing information, and considerable benefits can be gained using a 2D approach. For example, we observed AFC asymmetric peak calls (Supplementary Figs S1 and S2) and lower power in the identification of non-random interactions (details in Section 3). Thus, these observations motivated us to develop rigorous statistical models that efficiently use information from neighbors in the 2D space. Here we present a hidden Markov random field (HMRF) based Bayesian method for peak calling using Hi-C data. Our approach improves on prior methods by explicitly borrowing information from neighboring fragment pairs via modeling the dependency in the 2D space. Our results in real data and from extensive simulations indicate superior performance of our method over existing methods, across a range of underlying dependency structure.
DiscussionPeak calling from data generated by 3C-derived methods is a fundamental task for the identification of chromatin interactions in 3D space. However, model-based methods for this important task are still lacking. Existing methods focus on the calibration of expected count frequency distribution under random collision, accounting for multiple biases behind 3C analysis including but not limited to density of restriction enzyme sites, mappability and GC content. We have found existing methods rather mature for the purpose of calibrating expected counts (with results robust to different methods used). Establishing the expected count distribution is nevertheless a prerequisite, not peak calling itself. None of the existing methods consider the dependency underlying the peak status with statistical rigor. In this work, we propose a HMRF based Bayesian method that explicitly models the dependency of the underlying peak pattern. The true peak pattern is unknown and can take different forms in the presence of dependency. We simplify the problem by assuming an Ising distribution prior and learn the level of dependency from data in a Bayesian framework. Our extensive simulations indicate superior performance in terms of both the estimation of the extent of dependency and the statistical power to distinguish peaks from background, across a range of underlying dependency patterns. There are several aspects where the model can be further elaborated. First, our model has one h, one w and one /, thus assuming that peaks are of similar strength and clustering patterns, and that reads have similar levels of over-dispersion. While the first two are simplifying assumptions bypassing issues including model selection difficulty and parameter non-identifiability, the last has been shown to be reasonable (). Sensitivity analysis with the IMR90 combined dataset suggests these assumptions are reasonable: splitting each domain into two equal sub-domains resulted in highly consistent peak calls (Spearman correlation  0.9, detailed in Supplementary Material Section 4). Second, we use a one-parameter Ising prior, with the parameter controlling both the peak proportion and level of dependency. A two-parameter Ising prior would allow more flexibility, particularly when the underlying dependency is weak. Third, our method could allow incorporation of prior knowledge, when available, into the model. For instance, a hyper prior could be imposed on the inverse temperature parameter based on estimated distribution from similar existing datasets. Finally, the computational complexity of our Bayesian modeling is quadratic in terms of the number of fragments under consideration. Our JAVA implementation takes $13 minutes for a typical domain with 200 fragments and with parallel computing, genome-wide analysis can be easily accomplished within a few hours. In contrast, Fit-Hi-C and our R implementation of AFC take $4 seconds and $12 minutes, respectively. Therefore, for future work, computationally more efficient algorithms warrant consideration. We attempted to apply the iterative conditional mode algorithm (), but observed unsatisfactory performance with weak peak signals (data not shown). Despite these possible further model improvements, our method has demonstrated favorable performance over existing methods by borrowing information from neighboring fragment pairs via statistically modeling the potential dependency among the underlying peaks using a Bayesian framework. Our extensive simulation studies (Supplementary Material Section 2) show the advantage of our method across a range of dependency patterns and its ability to learn the level of dependency (as modeled by the inverse temperature parameter) from data. Both are valuable since we have limited, if any, prior knowledge regarding the extent of dependency in real data. Re-analysis of several published Hi-C datasets including the IMR90, H1-hESC and mESC data confirmed the value of dependency modeling as taking dependency into consideration resulted in better concordance (40% improvement as measured by Jaccard Index of peak sets across two IMR90 datasets) and lower false positive, false discovery rates and higher recovery rate. Our method is the first to model dependency in a statistically rigorous manner and to borrowinformation from neighboring fragment pairs through a probabilistic model, was able to call up to 11.3% more enhancer-TSS interactions than the ad hoc method given the same number of peak regions called. We acknowledge that there is currently no genomewide gold standard for real data (for example, from large scale genome-wide imaging-based experiments). We therefore made special efforts to benchmark the methods across multiple datasets and for each dataset, against the most reasonable silver standard. For example, for the IMR90 cell lines, we compared against results from the combined dataset with the highest sequencing depth, for H1 hESC and mESC, we used results from independent technologies (5C and ChIA-PET, respectively). With the continuing drop in sequencing costs and the intensive interest in chromatin structure as a way to understand GWAS results, we anticipate in the near future more high-resolution (fragment-level) Hi-C data where our method have demonstrated key advantage given the non-negligible dependency structure.