Motivation: In liquid chromatographyâ€“mass spectrometry/tandem mass spectrometry (LC-MS/MS), it is necessary to link tandem MS-identified peptide peaks so that protein expression changes between the two runs can be tracked. However, only a small number of pep-tides can be identified and linked by tandem MS in two runs, and it becomes necessary to link peptide peaks with tandem identification in one run to their corresponding ones in another run without identification. In the past, peptide peaks are linked based on similarities in retention time (rt), mass or peak shape after rt alignment, which corrects mean rt shifts between runs. However, the accuracy in linking is still limited especially for complex samples collected from different conditions. Consequently, large-scale proteomics studies that require comparison of protein expression profiles of hundreds of patients can not be carried out effectively. Method: In this article, we consider the problem of linking peptides from a pair of LC-MS/MS runs and propose a new method, PeakLink (PL), which uses information in both the time and frequency domain as inputs to a non-linear support vector machine (SVM) classifier. The PL algorithm first uses a threshold on an rt likelihood ratio score to remove candidate corresponding peaks with excessively large elution time shifts, then PL calculates the correlation between a pair of candidate peaks after reducing noise through wavelet transformation. After converting rt and peak shape correlation to statistical scores, an SVM classifier is trained and applied for differentiating corresponding and non-corresponding peptide peaks. Results: PL is tested in multiple challenging cases, in which LC-MS/ MS samples are collected from different disease states, different instruments and different laboratories. Testing results show significant improvement in linking accuracy compared with other algorithms. Availability and implementation: M files for the PL alignment method are available at
INTRODUCTIONLiquid chromatographymass spectrometry/tandem mass spectrometry (LC-MS/MS) is a well-known tool for analyzing complex protein samples both quantitatively and qualitatively (). An LC-MS/MS experiment begins with the enzymatic digestion of proteins into peptides, which are then injected to and separated in an elution column in the LC step. The retention time (rt) it takes for a peptide to pass through the LC column is determined by the physiochemical properties of the peptide. Subsequently, peptides are ionized and separated by their mass over charge (m/z) ratios. At a given charge state, a peptide registers its 12 C monoisotopic 2D peak at (rt, m/z), which is considered as the representing feature of the peptide (). In addition, peptide peak shape can also be treated as a feature (). Note that in this article, properties of peptide peaks are defined as features. After the LC-MS step, tandem MS may perform further fragmentation of some peptides that it picks up. The resulted spectrum can be submitted to search engines such as MASCOT (), SEQUEST () or X!tandem () for peptide identification. Compared with older peptide identification technologies such as the accurate mass and time tag () approach, tandem MS search provides more confident peptide sequence and rt information, based on which, peptide LC-MS peaks can be located for confident quantification. However, only a small portion of peptide precursors are sampled in tandem MS, and only a small number of commonly identified proteins/peptides can be compared across multiple LC-MS/MS runs (). This creates the need to link peptide peaks in runs with identification to their corresponding peaks in runs without tandem MS identification. In this article, feature linking or peak linking, are used interchangeably to describe the process of linking peptide peaks based on peak features. There are many algorithms, such as msInspect (), MZmine 2 (), MultiAlign (), SuperHirn (), ChromAlign (), OpenMS (), SIMA () and most recently SMFM/SMFM-g (), that consider the problem of linking corresponding peptide peaks in LC-MS/MS runs. Most of these algorithms are warping-based correspondence algorithm (WCA), in which, the elution time shifts between two LC-MS/MS runs are corrected by finding a warping (alignment) function, and peaks are linked based on their closeness in (rt, m/z). However, few of these algorithms use MS/MS information for generating warping functions () directly, which could provide good performance with little computing resource. For example, Polynomial-4 (P-4) is a simple WCA that uses commonly identified peptides as anchors, whose elution times in two LC-MS/MS runs are fitted to generate a simple P-4 warping function. P-4 has not been published as an algorithm separately. It has been described in (), which shows that P-4 performs similarly to SMFM/SMFM-g and MZMine 2 and significantly superior to msInspect and MultiAlign in four testing cases. In our own testing, P-4 is shown to have a performance that fluctuates around the reported accuracy of SMFM/SMFMg in 70 rounds of testing. This validates the results reported in () and confirms that P-4 is an easily implementable algorithm with comparable performance to the best of WCAs in the literature. Besides WCAs, a unique statistical corresponding feature identification algorithm (SCFIA) is proposed in (). SCFIA differs from WCA algorithms in two aspects. Firstly, after correcting the mean elution time shifts using a warping function, SCFIA uses peak shape correlation between candidate corresponding peaks as an additional feature for matching; secondly, it treats peak shape correlation and elution time shifts between candidate corresponding peaks as random variables, and statistical models are used for making maximum likelihood decisions. The statistical models are trained based on common tandem MS-identified peptides between two LC-MS/MS runs. We categorize SCFIA as a WCA with matching. Although WCAs can perform well for technical replicates and LC-MS/MS data collected from simple organisms, their performance deteriorates significantly when samples are collected on complex organisms or from different laboratories, as shown in our own tests and in (). The linking accuracy could be as low as 70%. This seriously limits the capability of comparing protein expression profiles across multiple samples required in biological and clinical applications. Although SCFIA improves the performance significantly over P-4 [which is called Gwarping in (, and consequently, other WCAs, there is still significant room for improvement beyond SCFIA. SCFIA calculates peak shape correlation directly based on peak shapes, which are affected by both signal and noise. To address this issue, we propose to use wavelet decomposition to reduce noise and calculate correlation scores after de-noising. Also, SCFIA assumes that rt shifts and peak shape correlations are independent statistically, which is not a verified assumption. To address these issues, we propose to treat peak shape correlations and rt shifts as correlated features and use the support vector machine (SVM) to perform classification. Our proposed algorithm is called PeakLink (PL). PL first uses a non-linear warping function generated based on tandem MS information to correct mean rt shifts between LCMS/MS runs. Then, it uses a threshold on an rt shift likelihood ratio score to eliminate candidate peak pairs with big time shifts. In the next step, wavelet transform is applied to remaining candidate corresponding peaks, and the correlation between lowfrequency coefficients of wavelet transformation is calculated. PL processing could terminate at this point by choosing the candidate pair with the highest correlation. Alternatively, PL continues the processing by converting rt shifts and peak shape correlations to probability scores and setting these scores as inputs to an SVM classifier (), so that corresponding features can be identified with high accuracy. Our requirement on tandem MS identification is not a limitation because tandem MS is widely available. Even without it, as long as reliable peptide identification is available, PL can be applied. To evaluate the performance of PL, two groups of publicly available datasets are selected. Group 1 contains super-SILAC datasets () collected from breast cancer and normal tissues. Group 2 contains two label-free datasets of yeast proteins from two different laboratories (). In Group 1, the data were collected from different tissues with large rt shift variations. If P-4 is used, the alignment accuracy is only 72.88% on average. In contrast, SCFIA and PL can align the dataset with 82.81 and 90.05% accuracy on average, respectively. In Group 2, PL achieves 92% accuracy on average, whereas P-4 and SMFM/SMFM-g are reported to have 79 and 82% accuracy, respectively, in (). These results show that PL consistently improves peak linking accuracy in the most challenging cases and could have wide applications in biological and clinical research based on LC-MS/MS. Note that we consider the problem of peak linking between two LC-MS/MS runs in this article. Although it is possible to extend the algorithm to multiple runs, special considerations are needed for selecting reference runs as pointed out in ().
CONCLUSIONIn this article, we propose a new method PL for linking corresponding features across two LC-MS/MS maps. The novel aspects of the algorithm include using wavelet transform to reduce noise and using an SVM classifier for linking corresponding features. Compared with other methods in the literature, PL offers the highest accuracy in various challenging test cases including complex samples from different tissues, different instruments and different laboratories. Our results are shown to be reproducible across many runs using different training and testing sizes. With the achieved good performance, the proposed method could have wide applications in biological and clinical studies when protein expression changes across different conditions need examination.