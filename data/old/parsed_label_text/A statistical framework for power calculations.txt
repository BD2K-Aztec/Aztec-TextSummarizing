Motivation: ChIP-seq technology enables investigators to study genome-wide binding of transcription factors and mapping of epige-nomic marks. Although the availability of basic analysis tools for ChIP-seq data is rapidly increasing, there has not been much progress on the related design issues. A challenging question for designing a ChIP-seq experiment is how deeply should the ChIP and the control samples be sequenced? The answer depends on multiple factors some of which can be set by the experimenter based on pilot/prelim-inary data. The sequencing depth of a ChIP-seq experiment is one of the key factors that determine whether all the underlying targets (e.g. binding locations or epigenomic profiles) can be identified with a targeted power. Results: We developed a statistical framework named CSSP (ChIP-seq Statistical Power) for power calculations in ChIP-seq experiments by considering a local Poisson model, which is commonly adopted by many peak callers. Evaluations with simulations and data-driven computational experiments demonstrate that this framework can reliably estimate the power of a ChIP-seq experiment at different sequencing depths based on pilot data. Furthermore, it provides an analytical approach for calculating the required depth for a targeted power while controlling the false discovery rate at a user-specified level. Hence, our results enable researchers to use their own or publicly available data for determining required sequencing depths of their ChIP-seq experiments and potentially make better use of the multiplexing functionality of the sequencers. Evaluation of power for multiple public ChIP-seq datasets indicate that, currently, typical ChIP-seq studies are powered well for detecting large fold changes of ChIP enrichment over the control sample, but they have considerably less power for detecting smaller fold changes.
INTRODUCTIONNext-generation sequencing technologies produce tens of millions of sequence reads during each instrument run and are used to answer questions central to human diseases. Multiple NIH consortia (ENCODE, modENCODE, 1000 Genomes, Roadmap Epigenome) are pursuing mapping of transcription factor (TF) binding and epigenome in multiple tissues and developmental stages with ChIP-seq applications (). Analysis of ChIP-seq experiments involves comparing sequence reads from a ChIP sample to an appropriate control sample (e.g. chromatin input) to identify genomic loci/regions that exhibit enrichment in the ChIP sample compared with the input sample. Although there are 430 algorithms for analyzing data from ChIP-seq experiments (reviewed in), there has been little and mostly empirically driven efforts on the design of these experiments (). Identification of biologically interesting genomic regions can be hindered by background noise. Detection of these regions can be improved by sequencing more reads. The total number of reads from a sequencing experiment is referred to as the sequencing depth. Sequencing depths so far have been set empirically because of lack of a formal statistical framework, e.g. the ENCODE Consortium suggested using a minimum sequencing depth of 20 million (M) mapped reads for sequence-specific TFs (); however,recently concluded with empirical studies that the regularly adopted sequencing depth of 1520 M reads in humans may not be high enough.explored the impact of sequencing depths of ChIP samples using saturation analysis. This analysis evaluated the effect of sequencing depth on the number of peaks discovered by identifying peaks from reads sub-sampled at varying proportions from the original ChIP sample. The proportion of sub-sample peaks that overlap the peaks from the full set is plotted against the sub-sample depth. When this curve reaches a horizontal asymptote, it indicates that the set of detected enrichment sites has stabilized at the current depth. Although this computational approach is useful for evaluating the available sequencing depth of a ChIP sample, it has three major drawbacks: (i) it is not suited for addressing how many more reads are needed if saturation has not been reached at the available depth [e.g. in a recent ENCODE publication (), RNA Pol II, which mainly interacts with DNA across genes, exhibited a nearly linear gain in the number of peaks through 50 M reads with no indication of how many more reads are needed for saturation]; (ii) it only evaluates saturation based on the ChIP sample and discards the control sample; and (iii) it only allows investigating saturation from the point of either a minimum fold-enrichment or false discovery rate (FDR), but not both. *To whom correspondence should be addressed.Addressing the question of sequencing depth requires (i) defining a statistical criterion that can quantify the information loss of an experiment because of its apparent sequencing depth and (ii) determining the sequencing depth needed to control the information loss based on a pilot, possibly undersequenced, dataset. From a statistical point of view, ChIP-seq peak calling procedures can be cast as multiple testing problems because they aim to assess whether data for each candidate locus is supported by the background noise distribution or the ChIP signal. Therefore, the information loss is naturally connected to the concept of the testing power. As a result, both of the aforementioned issues can be considered within a power calculation framework where the sequencing depth plays the role of sample size. Power computations require modeling distribution of both the background reads and ChIP signal in a way that reflects the stochastic nature of read accumulation at each genomic locus as a function of sequencing depth. Although a number of models were proposed for locus-specific read counts, none of them explicitly accounted for read accumulation.considered models with locally Poisson distributed background and did not model ChIP signal.proposed a flexible model taking into account the genome structure and overdispersion. However, this model used the input sample as a covariate and did not explicitly parametrize the model in terms of sequencing depths.proposed a hierarchical Bayesian t-mixture model to identify local concentration of directional reads, but did not consider the relationship between read accumulation and sequencing depth.adopted a signal-to-noise model, parameters of which followed some arbitrary prior distribution to account for intrinsic read bias. Although such a prior distribution, if estimated, could be utilized to model the background distribution at varying sequencing depths, the work ofexclusively focused on the normalization aspect of ChIP-seq analysis. We developed CSSP (ChIP-seq Statistical Power) framework for statistical power calculation by considering a local Poisson model for the read generation process. We assume that background reads in the ChIP and the input samples are generated by local Poisson processes with shared Gamma prior distributions. The corresponding Gamma parameters are modeled as functions of the local genome structure, including mappability and GC content. The local Poisson parameters for the enrichment signals follow convolution of Gamma distributions. This model preserves the local structure of themodel while keeping the negative binomial distribution as the marginal signal distribution as in. Such a local structure is key for capturing dynamics of the counting process for individual genomic locus as a result of increasing sequencing depths. We introduce a conditional power definition that uses the practically used notion of fold change of ChIP signal over the control input sample. We show with data-driven computational experiments that our approach can be used to determine (i) the apparent conditional power for a given sequencing depth; (ii) the required sequencing depth to achieve a target power while controlling the FDR at a specified level. Simulation experiments based on a deeply sequenced Escherichia coli dataset indicate that power predictions of our model agree well with the observed empirical power. Using data from pilot studies, we can reliably estimate power for larger sequencing depths; thus, the CSSP framework has significant implications for designing ChIP-seq experiments with the multiplexing functionality. Finally, we study the power of multiple ENCODE datasets with varying sequencing depths. Our results illustrate that, although the power varies considerably with the signal-to-noise ratios of the datasets, the current sequencing depths have high power for proteinDNA interactions with large effect sizes and are generally adequate for smaller effect sizes. Our calculations are further supported by the data quality metrics proposed by the ENCODE project ().
DISCUSSIONThe sequencing depths of most, if not all, initial published experiments have been limited by practical considerations, such as cost or instrument availability. With decreasing sequencing costs, considerations are shifting from how many sequences should be obtained for a single experiment, to how many experiments one can perform in a single lane. Therefore, power calculations are extremely important for ChIP-seq experiments. We have developed the CSSP framework to enable such power calculations. This framework can be applied to compute power at a wide range of sequencing depths with varying fold change and minimum intensity thresholds. Our extensive computational experiments demonstrated the consistency in predicting power from pilot data and its practical implications. To the best of our knowledge, this is the first model that enables power analysis for ChIP-seq data through an analytical approach. It is worth noting that although our calculations mostly emphasize the sequencing depth N y , other parameters including e 0 and j , which indicate the signal-to-noise ratio of the data, as well as the data quality are also important factors of the power analysis. These parameters are fixed when comparing datasets obtained under the same experimental conditions. However, for comparing datasets with different experimental conditions, such as TF and cell line, effects of data quality and strengths of enrichment signals should bear equal emphasis. Our limited investigation of the laboratory and batch effects indicated that laboratory effects are larger than batch effects within a laboratory, and that pilot data from the same laboratory would yield more unbiased power prediction than pilot data from another laboratory. Although the analytical calculations in the CSSP framework depend on the peak calling procedure implied by our model, theOverlap proportion was calculated as the proportion of SPP peaks that are among the CSSP peaks. The SPP peaks were constructed by extending each peak of SPP by the estimated 'half window size' () in both of the 5 0 and 3 0 directions.