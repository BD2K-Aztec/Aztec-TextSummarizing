Motivation: Differential transcript expression (DTE) analysis without predefined conditions is critical to biological studies. For example, it can be used to discover biomarkers to classify cancer samples into previously unknown subtypes such that better diagnosis and therapy methods can be developed for the subtypes. Although several DTE tools for population data, i.e., data without known biological conditions, have been published, these tools either assume binary conditions in the input population or require the number of conditions as a part of the input. Fixing the number of conditions to binary is unrealistic and may distort the results of a DTE analysis. Estimating the correct number of conditions in a population could also be challenging for a routine user. Moreover, the existing tools only provide differential usages of exons, which may be insufficient to interpret the patterns of alternative splicing across samples and restrains the applications of the tools from many biology studies. Results: We propose a novel DTE analysis algorithm, called SDEAP, that estimates the number of conditions directly from the input samples using a Dirichlet mixture model and discovers alternative splicing events using a new graph modular decomposition algorithm. By taking advantage of the above technical improvement, SDEAP was able to outperform the other DTE analysis methods in our extensive experiments on simulated data and real data with qPCR validation. The prediction of SDEAP also allowed us to classify the samples of cancer subtypes and cell-cycle phases more accurately.
IntroductionIn recent years, RNA-Seq has taken a major role in the quantitative analysis of transcript expression and variant discovery and become a vital component of genomic and transcriptomic research (). For case-control studies, several differential transcript expression (DTE) analysis methods such as Cuffdiff 2 (), DESeq2 (), edgeR (), and ALEXA-Seq () have been developed to discover genes that have differentially expressed transcripts whose abundance values alter between known biological conditions. In addition to the DTE methods, differential splicing (DS) analysis methods such as MISO (), FDM (), MATS (), DEXSeq (), and DiffSplice () are focused on identifying difference in relative abundance of transcripts. Note that a change in the absolute abundance of a transcript may result from a change in the basal expression level of the corresponding gene, its splicing ratio or both (). In other words, DTE methods should be able to discover DS events but not vice versa. Moreover, the DTE and DS analyses may also find many important applications in population based studies, where predefined conditions are unavailable a priori. For example, a recent population study to improve the diagnosis and prognosis for breast cancer shows that triple-negative breast cancer can be further classified into six subtypes based on the differential analysis of the expression profiles of patients (). Each of the six subtypes has different sensitivities to targeted therapies. To understand the functions and mechanisms during cell development or differentiation, differentially expressed transcripts are used to characterize cell types or specificity in a mixed population (). Due to the emergent demand for computational tools for DTE and DS analyses without known biological conditions, several methods have been proposed recently. SIBER and DEXUS test differential expression by looking at the numbers of reads mapped to individual genes or exons (). An extended protocol of DESeq2 has been published recently to identify differentially expressed genes for single-cell (SC) RNA-Seq data based on ERCC spike-in data (). SigFuge compares the areas under normalized read-depth curves to call DS genes (). In a DTE analysis, the expression of genes (or transcripts) is summarized by numerical features, called expression features (e.g., read counts of genes or exons in DEXUS and areas under normalized read-depth curves in SigFuge). The DTE of genes is assessed by calculating the variation of the expression features across the samples of different biological conditions. When the biological conditions of samples are not predefined, to test whether an expression feature has experienced differential expression, the input samples are usually clustered based on the expression levels of the feature across the samples. The clusters of the samples are then used as the biological conditions and the variation of the expression feature between the conditions is then measured statistically (). Clearly, the correctness of the clustering is critical to the DTE analysis when the biological conditions is not available. Both SIBER and SigFuge assume that the input population consists of only two conditions and always cluster the samples into two clusters. This assumption is unrealistic in many applications and an incorrect partition (or clustering) of samples may lead to unreliable conclusions of differential expression tests. Although DEXUS also assumes binary conditions by default, it allows the user to input the number of the biological conditions, which will be used as the number of clusters on all expression features. However, specifying the correct number of the biological conditions directly from samples is difficult for a routine user. Moreover, since some expression features may exhibit little variability on a subset of the biological conditions, the optimal numbers of clusters for individual expression features may differ and may not always be equal to the number of biological conditions defined by the user, even when the user-defined number is correctly specified. Hence, a computational method that can determine the numbers of clusters automatically from data is urgently needed to conduct reliable DTE analyses when the biological conditions are not available. In addition to the challenge in specifying the number of clusters, these tools only report changes in coverage of exons of genes by RNA-Seq reads which do not directly suggest how and where transcript expression diverges as a result of alternative splicing events (ASEs). Such ASE information could be valuable in down-stream applications in their own right, e.g. as biomarkers in several cancer studies (). To address these issues in the existing DTE analysis tools, several technical improvements have been made in a new DTE analysis algorithm, called SDEAP. In SDEAP, the number of clusters for expression feature is no longer fixed as two or required as a part of the input. Instead, a Dirichlet infinite mixture model is applied to determine the number of clusters for every expression feature by fitting the data optimally. To further discover ASEs, a graphical data structure, called the splice graph, is used in SDEAP to model the structures and abundance of all transcripts of a gene such that ASEs can be represented by decomposing the graph into alternative splicing modules (ASMs), as originally proposed in DiffSplice (). However, the graph modular decomposition algorithm employed in DiffSplice is not used here because we have found a counterexample to its correctness (see the Supplementary Materials for a detailed discussion). A corrected algorithm is described in this paper and implemented in SDEAP. Moreover, a method accounting for variability due to technical noise across biological or technical replicates has been adopted to reduce the number of false positives in SDEAP (). To assess the prediction accuracy of SDEAP, extensive experiments on both simulated and real data were conducted to compare SDEAP with DEXUS. SIBER was excluded from our comparisons because the performance of SIBER and DEXUS in detecting the variation of read coverage of genes and exons due to DTE has been compared in (). DEXUS was shown to constantly outperform SIBER and, moreover, SIBER can only be run on large datasets of more than 50 RNA-Seq samples (). In our simulation experiments, SDEAP outperformed DEXUS by at least 0.17 in the area under precision-recall curve (or AUCpr, which is used as the assessment of overall performance), on average. The numbers of conditions for at least 88% genes in the simulated data were correctly predicted by SDEAP. Although DS analysis is not the main purpose of SDEAP, we compared it with SigFuge in the detection of changes in relative abundance of transcripts by repeating the simulated experiments in (). SDEAP discovered more DS genes than SigFuge without producing any false positives. Furthermore, the performance of SDEAP is also compared to that of three state-of-theart DTE methods, namely DESeq2, Cuffdiff 2 and edgeR, that require known (binary) conditions as a part of the input using simulated datasets. When the numbers of individuals from each condition are not highly imbalanced, there is no noticeable difference between the prediction accuracy of SDEAP and that of the three methods. The time efficiency of SDEAP is discussed in the Supplementary Materials. To further demonstrate the utility of SDEAP in real biological applications, the DTE genes predicted by SDEAP were used as biomarkers to classify different cancer subtypes, cell types and cell-cycle phases on several recently published RNA-Seq datasets (). These applications are interesting because some critical diseases, e.g., breast cancer (BC), are known as heterogeneous diseases with a variety of transcriptomic alterations that severely affect the diagnosis and prognosis of the diseases (). Finding DTE genes that could be used as transcriptomic biomarkers to identify subtypes of such diseases could be important for the design of clinical trials to investigate targeted treatments. Moreover, the expression patterns of transcripts in individual cells of different cell types or cell-cycle phases, which can be revealed by the SC RNA-Seq technology nowadays, are fundamental to studies on alternative cellular functions during the development of a tissue or an organ (). Our real data experiments demonstrate that the classification of RNA-Seq samples using the ASEs from SDEAP is much more consistent with the real biological conditions (i.e., cancer subtypes, cell types and cell-cycle phases) than using the differentially expressed exons predicted by DEXUS. The prediction results of both methods were also compared with the qPCR validations of gene expression. More validated DTE genes were covered by the prediction of SDEAP. These results suggests that SDEAP also performs DTE analysis well on real population data.