Motivation: Next-generation sequencing coupled with metagenomics has led to the rapid growth of sequence databases and enabled a new branch of microbiology called comparative metagenomics. Comparative metagenomic analysis studies compositional patterns within and between different environments providing a deep insight into the structure and function of complex microbial communities. It is a fast growing field that requires the development of novel supervised learning techniques for addressing challenges associated with meta-genomic data, e.g. sensitivity to the choice of sequence similarity cutoff used to define operational taxonomic units (OTUs), high dimensionality and sparsity of the data and so forth. On the other hand, the natural properties of microbial community data may provide useful information about the structure of the data. For example, similarity between species encoded by a phylogenetic tree captures the relationship between OTUs and may be useful for the analysis of complex microbial datasets where the diversity patterns comprise features at multiple taxonomic levels. Even though some of the challenges have been addressed by learning algorithms in the literature, none of the available methods take advantage of the inherent properties of metagenomic data. Results: We proposed a novel supervised classification method for microbial community samples, where each sample is represented as a set of OTU frequencies, which takes advantage of the natural structure in microbial community data encoded by a phylogenetic tree. This model allows us to take advantage of environment-specific compositional patterns that may contain features at multiple granularity levels. Our method is based on the multinomial logistic regression model with a tree-guided penalty function. Additionally, we proposed a new simulation framework for generating 16S ribosomal RNA gene read counts that may be useful in comparative metagenomics research. Our experimental results on simulated and real data show that the phylogenetic information used in our method improves the classification accuracy. Availability and implementation:
INTRODUCTIONThe diversity of the microbial world had been hidden from the eyes of scientists until the advent of metagenomics. Despite the vital roles of microbes in our planet's ecology, evolution and human health, large populations of bacteria remain poorly characterized because the majority of bacterial species have not been successfully cultivated (). The metagenomics approach has offered a remedy: bypassing the need for isolation and cultivation, all the sequences present in an environmental sample are sequenced simultaneously, making it possible to access the genetic information of otherwise hidden organisms. The field of metagenomics has further been advanced by the recent improvements in DNA sequencing technologies () that allow millions of reads to be produced at a high speed and affordable costs. Deep sequencing allows for a high-resolution detection of rare species and provides an insight into phylogenetic composition and functional diversity of complex microbial populations with many lowabundance species. Along with the ability to access the genomes of rare species, next-generation sequencing technologies have also led to the rapid increase in the number and sizes of metagenomic sequencing projects. Exponential growth of sequence data has enabled comparative analysis of microbial communities, leading to a new branch of microbiology called comparative metagenomics. Comparative analysis extends insights into the structure and function of microbial communities: it may help to identify community-specific properties of different environments as well as discriminative properties between different conditions, and to determine how microbial community composition is affected by specific environmental changes. Comparative metagenomics has broad implications for various fields of environmental science and human biology. It may help to address the intriguing question of identifiability of a core human microbiome (), to understand the relationship between human microbiome and health and to study how microbial composition and function vary between distinct body sites and across the human population. Comparative analysis has already led to the discovery of three major enterotypes associated with the human gut microbiota () and the differences between lean and obese individuals (). Microbial communities can be compared at the levels of sequence composition, taxonomic diversity or functional potential. Taxonomic diversity provides detailed evolutionary information regarding the community composition and therefore has been a focus of many environmental and human studies (). To access the taxonomic composition of a microbial community genomic *To whom correspondence should be addressed.  The Author 2013. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com sample, both single marker gene sequencing and whole community shotgun sequencing are widely used (). The 16S ribosomal RNA gene [or 16S ribosomal DNA (rDNA)] is a commonly used marker for bacterial identification due to its universal distribution among all bacterial species and a slow rate of sequence evolution. To reduce the dimensionality of large sequence datasets generated by high-throughput sequencing of 16S rDNAs, the reads are clustered into operational taxonomic units (OTUs) () that roughly represent taxa at phylogenetic levels defined by a user-defined sequence similarity cutoff. The abundance of each OTU is defined as the number of sequences in the OTU. Representative sequences from each OTU are chosen and used to assign taxonomy to the OTUs and to construct phylogenetic trees. Packages such as QIIME () and Mothur () provide integrated pipelines for the analysis described earlier in the text. The whole genome shotgun sequencing (i.e. metagenomics) approach can also be used to study microbial community composition. It offers a more global view of the community, but may not be deep enough to detect rare species in a sample, and is sensitive to the DNA extraction and sequencing protocols. Even though the two approaches may not always lead to the same conclusions about the community structure (), they became standard tools in microbial community analysis. In this article, we will focus on samples based on the sequencing of 16S rDNAs although our proposed method can be easily extended to metagenomic samples based on whole genome sequencing. For 16S rDNA datasets, each sample is represented as a list of OTUs and their frequencies. We will refer to these lists as feature vectors. A feature vector corresponds to one microbial community sample, and the vector's elements (features) characterize OTU frequencies in the sample. The evolutionary relationship between all of the OTUs is captured by a phylogenetic tree. The downstream analysis may involve the identification of compositional patterns across samples from similar environments as well as discriminatory features between different communities, associations between human bacterial communities and disease phenotypes, prediction of unknown labels for new samples and so forth. These tasks require the development of new supervised learning techniques that would take into consideration challenges associated with microbial community data. For example, features defined by OTUs do not necessarily represent specific taxonomic units because taxonomic levels are hard to define due to the fact that only relatively a small number of bacteria have been cultured. Moreover, it is hard to determine which taxonomic resolution level provides features with the best discriminative or predictive properties (). The environment-specific patterns may even comprise different lineages at varying phylogenetic depth. Finally, a low overlap in species between samples results in sparse and high-dimensional feature vectors. The problem of classification of microbial communities is not well-studied, even though classification techniques have been widely used in the field of bioinformatics, including classification of microarray cancer samples (), gene expression profiles (), protein families () and so forth. Classification of metagenomic (or 16S rDNA) samples may have useful applications enabling efficient organization and search in rapidly growing metagenomic (or 16S rDNA) databases, detection of disease phenotypes in clinical samples and forensic identification. One of the first applications of supervised learning techniques to comparative metagenomics () was the classification of soil and sediment samples according to environment types using support vector machines (SVM) and K-nearest neighbors algorithms. Recently, the feasibility of applying standard supervised classification techniques to metagenomic/16S rDNA data was studied on several benchmark datasets of human microbiota (). MetaDistance () is the first dedicated algorithm for multiclass classification of human microbiota. The algorithm combines the advantages of instance-based and model-based methods, such as K-nearest neighbors and SVM. The aforementioned methods proved to be efficient learning techniques and address some of the challenges associated with the properties of metagenomic/16S rDNA data. However, none of the methods have yet taken advantage of the inherent properties of metagenomic data, although phylogenetic information contained in metagenomic samples has proved to be useful in comparative metagenomics. For example, similarity measures that take into account phylogeny, e.g. UniFrac () and its generalized versions (), outperform nonphylogenetic distance in their ability to recover natural clusters of microbial communities (). To incorporate phylogeny into the similarity measure, UniFrac-based methods calculate the degree to which the input samples share branch length on a phylogenetic tree. Another example of a phylogeny-based similarity measure is the parsimony test (), which uses Fitch's parsimony algorithm to compute the number of minimal changes along the phylogenetic tree necessary to explain all the labels of the sequences. A recursive phylogenetic distance was defined in Meta-Storms () for the purpose of fast indexing of metagenomic databases. Although phylogeny provides important information about the natural hierarchical grouping of features, it has not yet been adopted in classification algorithms for microbial communities. To incorporate the underlying structural information among the features in learning problems, several regularization methods have been proposed. For example, in the problem of tumor class prediction from gene expression measurements, functional groups of genes form the natural structure of data and the combination of L 1 and L 2 norms were used to encode the groups and variables within the groups (). The group lasso penalty coupled with logistic regression (LR) was applied for classification problems with feature groupings and proved to be useful in short DNA motif modeling and splice site detection (). Composite absolute penalty () extended the grouping approach to deal with overlapping groups and with hierarchical orderings of the input variables that reflect the order in which the variables should be included in the solution. The idea of hierarchical grouping was later used for the multitask regression learning problem where a tree encodes relationships between the elements of a multidimensional-dependent variable, and a balanced weighting scheme to weight the hierarchically overlapping groups was proposed (). Here, we show that the hierarchical grouping ideas () can be efficiently applied to the multiclass classification problem where information about the natural hierarchical grouping of features is available. In this article, we proposed a new multiclass classification method for 16S rDNA sequence (or metagenomic) samples that takes advantage of the natural structure of microbial community data encoded by a phylogenetic tree. The leaf nodes represent features corresponding to individual OTUs, and the internal nodes may be considered as super features. The hierarchical structure captures similarities and differences among the features and allows for the consideration of features at different granularity levels, which may be desirable given that the features do not necessarily correspond to specific taxonomic units and only represent groups of similar sequences. Thereby, some environment-specific patterns may comprise features at multiple granularity levels. We proposed a multinomial LR model with a tree-guided penalty that incorporates the hierarchy in the feature space and presented an efficient optimization algorithm to learn the model parameters. We applied our algorithm to several real datasets of 16S rDNA sequences from the human microbiota. We compared the classification performance of our method with several state-of-the-art learning algorithms, and showed that incorporating the natural structure of the microbial data results in a model with a better predictive power. We also performed a comprehensive analysis of the proposed method by applying it to simulated datasets of different complexity. Because the problem of classifying 16S rDNA sequence samples is relatively new, there are no simulated data generators that would generate the data appropriate for our goal. Current comparative studies use simulations where features are generated independently from each other rather than according to a phylogeny. Therefore, we introduced a new simulation approach that uses the phylogenetic structure of microbial communities to generate OTU count data and simulate scenarios where community-specific patterns may comprise features at multiple levels of granularity. We showed that by taking advantage of the phylogeny, our algorithm has a robust performance with respect to the choice of feature resolution, which corresponds to the selection of a similarity threshold when defining OTUs for the real data.
CONCLUSIONWe proposed a new classification method for 16S rDNA sequence samples that uses the natural structure of microbial community data encoded by a phylogenetic tree. We showed that using the phylogenetic information leads to an improved classification accuracy compared with the state-of-the-art classification algorithms. Unlike many popular classification methods, which consider features (or OTU frequencies) in isolation, our method takes advantage of the similarities between OTUs encoded by the phylogenetic tree. We applied the algorithm to classify samples obtained from 16S rDNA studies, but the approach can also be used to classify metagenomic samples obtained by whole genome sequencing. The algorithm only requires frequencies of taxonomic groups in each sample and a phylogenetic tree that relates these groups. Even though our model does take advantage of the natural hierarchical grouping of OTUs, features are still defined as individual OTUs (the leaves of the phylogenetic tree). Nevertheless, a microbial community may be characterized by several lineages of varying phylogenetic depth.gives an example of a hypothetical disease characterized by concurrent over-representation of a particular phylum, genus and species. Therefore, rather than defining features as tree leaves, a subset of intermediate nodes of the phylogenetic tree may lead to more powerful classification models for complex microbial