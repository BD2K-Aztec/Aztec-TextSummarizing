Motivation: There is growing momentum to develop statistical learning (SL) methods as an alternative to conventional genome-wide association studies (GWAS). Methods such as random forests (RF) and gradient boosting machine (GBM) result in variable importance measures that indicate how well each single-nucleotide polymorphism (SNP) predicts the phenotype. For RF, it has been shown that variable importance measures are systematically affected by minor allele frequency (MAF) and linkage disequilibrium (LD). To establish RF and GBM as viable alternatives for analyzing genome-wide data, it is necessary to address this potential bias and show that SL methods do not significantly under-perform conventional GWAS methods. Results: Both LD and MAF have a significant impact on the variable importance measures commonly used in RF and GBM. Dividing SNPs into overlapping subsets with approximate linkage equilibrium and applying SL methods to each subset successfully reduces the impact of LD. A welcome side effect of this approach is a dramatic reduction in parallel computing time, increasing the feasibility of applying SL methods to large datasets. The created subsets also facilitate a potential correction for the effect of MAF using pseudocovariates. Simulations using simulated SNPs embedded in empirical data— assessing varying effect sizes, minor allele frequencies and LD pat-terns—suggest that the sensitivity to detect effects is often improved by subsetting and does not significantly under-perform the Armitage trend test, even under ideal conditions for the trend test.
INTRODUCTIONGenome-wide association studies (GWAS) have successfully detected numerous single-nucleotide polymorphisms (SNPs) associated with a variety of phenotypes, but the identified loci at best explain a modest proportion of the heritable variance estimated by twin and family studies (). Recent estimates of the heritable variance explained by all SNPs, however, indicate that genome-wide SNP data does offer substantial explanatory power (). This gap of 'missing heritability' between heritability estimates and the SNPs detected by GWAS has led to increasing concern over the performance of GWAS, with attention focused on low power due to the multiple testing burden and small effect sizes, as well as the omission of rare disease alleles and epistatic effects, among other issues (). These shortcomings of GWAS have encouraged the application of statistical learning (SL) methods as an alternative for analyzing genome-wide data (). SL methods are designed specifically for the task of identifying meaningful predictors in high-dimensional data, relying on data-driven algorithms rather than conventional parametric modeling. Numerous SL methods have been proposed for use with SNP dataincluding random forests (RF;), multifactor dimensionality reduction () and the lasso ()generally with encouraging results. RF has received significant attention in the genetics literature () with surprisingly less attention given to gradient boosting machine (GBM;) despite its similarity to RF. Both RF and GBM build an ensemble of non-parametric prediction models, with each model constructed iteratively using all available SNPs. GBM additionally applies boosting to build each model with a focus of improving model fit for cases fit poorly in the previous iteration. Importantly, the iterative tree-building approach of RF and GBM accounts for conditional relationships and complex causal mechanisms, including epistasis and covariate effects, without a priori specification. Individual SNPs are then evaluated using variable importance measures, which quantify each SNP's total contribution to the prediction of the phenotype (). Such variable importance measures can be used to rank-order SNPs by importance, identifying potentially informative SNPs among genome-wide data. Studies of RF with SNP data have yielded promising results. Simulations suggest that RF's power to detect causal SNPs exceeds Fisher's exact test when epistasis is present and is still comparable with Fisher's exact test when detecting main effects only *To whom correspondence should be addressed.(). RF maintains this advantage even if many noise SNPs are present (). Applying RF to genome-wide data is feasible, though computationally burdensome. With empirical genome-wide data, RF is capable of replicating GWAS results and identifying additional candidate SNPs (). Although these results are encouraging, further study is necessary to establish RF and GBM as viable alternatives to GWAS methods. Few studies of SL methods account for linkage disequilibrium (LD), utilize realistic effect sizes or compare the sensitivity of the SL method to GWAS.considered more realistic LD and effect sizes but only focused on RF as a second-stage analysis. Meanwhile, GBM merits further consideration based on its strong performance relative to RF. Studies show GBM performs even better than RF for many data types () but evaluation of its performance with genome-wide SNP data is still needed. In addition, concerns have been raised about the impact of minor allele frequency (MAF) and LD on the variable importance measures used by RF and GBM to rank-order SNPs. With respect to LD, importance scores for correlated functional SNPs are inflated when using variable importance measures based on the Gini criterion (), whereas importance scores for functional SNPs correlated with uninformative predictors are deflated (). Correlated predictors do not induce bias in permutation-based importance measures, though the variability of importance scores is decreased (). MAF may also influence importance scores, with higher MAF being associated with higher Gini importance values for all SNPs, and higher permutation importance values for functional SNPs (). The influence of MAF may be attributed, at least in part, to the tendency of the RF algorithm to prefer predictors with higher variability (). Taken together, such effects may increase the difficulty of detecting disease-causing variants located in LD blocks or with low MAF, especially when using Gini-based importance measures. Methods for controlling the impact of MAF and LD on variable importance have been proposed. To address the effect of LD,introduced a modified RF algorithm and accompanying importance measure that account for the competition between correlated SNPs for inclusion in RF models.developed a conditional permutation scheme for the variable importance that successfully addresses the impact of correlated predictors. Alternatively, pseudocovariates (PCVs) may be added to the data to simultaneously address the effect of all structure in the data that are unrelated to the phenotype (). Although each of these methods have been demonstrated to potentially reduce the impact of LD and MAF, all three increase the computational burden beyond what is feasible for genome-wide data.specifically note that their method does not scale to be feasible with genome-wide data. The current implementation of the conditional methods proposed byalso have substantially larger memory requirements than conventional RF. Correction with PCVs is similarly infeasible, effectively doubling the size of the data and requiring a number of replications of the analysis to establish stable estimates. In sum, to establish RF and GBM as viable methods for genome-wide SNP data, it will be necessary (i) to address concerns over the impact of LD and MAF while maintaining computational feasibility and (ii) to provide a direct comparison with conventional GWAS methods under realistic conditions. In this study, we propose and evaluate a procedure designed to reduce the impact of LD on RF, GBM or related SL methods for genome-wide data. The proposed method creates overlapping subsets of SNPs from a genome-wide dataset under the constraints that SNPs within a set are not in LD, and that each SNPs is represented in at least a user-specified number of subsets (see Methods). The SL method of choice can then be performed on the subsets without concern for LD, followed by an aggregation of results over subsets. Next, we show that the proposed subsetting procedure is computationally feasible for genomewide data. Dividing the data into subsets makes analysis of each piece more manageable and facilitates parallel computation across multiple cores or on a high-performance grid for a drastic reduction of computing time. Third, we evaluate a correction for the impact of MAF adapted from the methods proposed by), which is computationally feasible in combination with the subsetting procedure. Specifically, in each subset, we generate a small set of independent PCVs with zero association with the phenotype, coded as SNPs with MAF ranging from 0.01 to 0.50. Variable importance estimates for the PCVs in each subset are aggregated to provide a stable estimate of variable importance attributable to MAF. This estimate can then be used to correct the importances of the empirical SNPs. Finally, we provide a rigorous direct comparison of the sensitivity of RF and GBM to the Armitage trend test (ATT;), the test utilized most frequently in conventional GWAS analyses (), under realistic data conditions. Using simulated SNPs embedded in empirical genetic data, we show that the sensitivity of RF and GBM is broadly consistent with the ATT for SNPs explaining as little as 1% of the phenotypic variance even under conditions that do not leverage the advantages of RF and GBM (i.e. a linear additive model without dominance or epistatic effects;).
DISCUSSIONSL methods such as RF and GBM are a viable alternative to conventional parametric testing of individual SNPs in a GWAS. However, there are valid concerns over the impact of LD and MAF on variable importance measures that must be addressed. In response, this study presents an integrated approach to meaningfully reduce the effect of LD and MAF on variable importance in RF and GBM. The results of this study show that the proposed subsetting algorithm can successfully reduce or eliminate the effect of LD on the variable importance measures of RF and GBM. The process of aggregating results over the subsets is not biased by the number of subsets containing a given SNP and, in many cases, may aid the detection of effect SNPs. In particular, the use of LD subsetting can be expected to aid RF and GBM is identifying effect SNPs within LD blocks. Since LD subsets are constructed prior to analysis, the procedure could also be applied to other SL methods. Importantly, GBM provides detection rates for the functional SNPs within sampling variation of detection rates for the ATT. This result for GBM is especially encouraging given that this study uses an additive genetic model that precisely matches the type of effect anticipated by the ATT. SL methods may be expected to provide substantial improvement over the ATT for detecting correlated effect SNPs and SNPs with non-additive and epistatic effects (). Alternatively, RF and GBM may act as an initial screen to reduce genome-wide data to a set of candidate SNPs small enough to make thorough modeling of their complex relationships feasible using penalized regression or other appropriate methods (). The LD subsetting approach also facilitates the introduction of PCVs, as proposed by, which may potentially be used to correct for the effect of MAF on variable importance measures. The proposed PCV correction evaluated in this study provides a marked reduction in the effect of MAF on non-effect SNPs. Caution is necessary in applying PCVs, however, given a moderate effect of MAF remains and the effect of MAF on the importance of functional SNPs may be magnified, with uncertain implications (Supplementary Information). Still, PCVs at minimum provide the option of emphasizing sensitivity to SNPs with low MAF, which may contain the majority of heritable variance for some phenotypes, such as high-density lipoprotein (HDL) cholesterol (), and can be difficult to detect with conventional methods (). Finally, in addition to PCVs numerous covariates for comorbid disorders, environmental factors and other influential variables may be included in the analysis with a much lower computational cost than for popular GWAS software (). A number of factors may be considered in seeking to improve the approaches evaluated by this study. More careful tuning of the metaparameters for the LD subsetting algorithm, including the selection of k, b and t, may enhance the effectiveness of the correction. Alternative methods to improve the use of PCVs to correct for the effect of MAF may also be explored. The correction proposed here is only one possible application of PCVs; other versions may improve the effectiveness of PCVs or carry different advantages tailored to the preferences of the researcher. Finally, these results show strong results for GBM that are consistent with the more widely known RF; additional work should be performed to evaluate GBM as a viable tool for analyzing genome-wide data, especially given its lighter computational burden. Although our approach does not fully eliminate the impact of LD and MAF on variable importance measures, the proposed corrections provide a satisfying improvement. Importantly, LD subsetting also facilitates analysis in a parallel environment, improving the computational feasibility of these methods for genome-wide data. Continuing efforts to establish the validity, reliability and feasibility of SL methods such as RF and GBM with genome-wide data will be crucial to establishing these methods as viable alternatives to conventional GWAS analyses.