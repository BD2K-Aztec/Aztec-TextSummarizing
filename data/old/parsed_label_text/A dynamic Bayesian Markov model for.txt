Motivation: Next-generation sequencing (NGS) technologies have enabled whole-genome discovery and analysis of genetic variants in many species of interest. Individuals are often sequenced at low coverage for detecting novel variants, phasing haplotypes and inferring population structures. Although several tools have been developed for SNP and genotype calling in NGS data, haplotype phasing is often done separately on the called genotypes. Results: We propose a dynamic Bayesian Markov model (DBM) for simultaneous genotype calling and haplotype phasing in low-coverage NGS data of unrelated individuals. Our method is fully probabilistic that produces consistent inference of genotypes, haplotypes and re-combination probabilities. Using data from the 1000 Genomes Project, we demonstrate that DBM not only yields more accurate results than some popular methods, but also provides novel characterization of haplotype structures at the individual level for visualization, interpretation and comparison in downstream analysis. DBM is a powerful and flexible tool that can be applied to many sequencing studies. Its statistical framework can also be extended to accommodate broader scopes of data.
INTRODUCTIONHaplotype phasing is a long-standing problem in population genetics. The task is to computationally infer the combination of alleles (haplotype) at multiple single nucleotide polymorphisms (SNPs) on a single copy of chromosome, while the data are collected in genotype format (combination of alleles per SNP on two copies of chromosomes) from diploid genomes. Haplotype phasing is important because haplotypes provide rich information about the evolution history of individuals. Haplotype phasing is challenging because its complexity grows exponentially with respect to the number of SNPs. Although SNP arrays have been routinely used to collect genotype data from individuals, they only quantify genetic variants at known SNPs. Nextgeneration sequencing (NGS), on the other hand, has the ability to detect all genetic variants in individuals' genomes. Sequencing machine reads out genomes as short DNA fragments called 'reads'. After aligning the reads to a reference genome or by de novo assembly, putative SNPs are called if reads aligned at the same position carry alternative alleles. Genotypes are further called at the putative SNPs by comparing the read counts of alternative alleles. For haplotype phasing, SNPs are sorted by their positions so that information of linkage disequilibrium (LD) can be used. In this study, we will focus on NGS data, because genotype data is just a special case. Many haplotype-phasing algorithms have been developed over the past decade (). Recent methods all use pairs of Markov chains per diploid individual to model LD among SNPs. The states in Markov chains correspond to haplotypes, and the transitions of states indicate recombination events. Most methods, however, are designed for genotype data only. Although NGS data can be converted to genotypes before haplotype phasing, such approach will produce poor results in low coverage sequencing studies. Some methods () also require genetic maps, which are unavailable in many studies. We identified three methods that can phase haplotypes in NGS data: THUNDER (), PPHS () and HapSeq (). THUNDER is a wrapper of MaCH (), where the latter works on genotype data and is among the most accurate methods in haplotype phasing (). We therefore used THUNDER as a benchmark in this study. PPHS uses perfect phylogeny to infer haplotypes. It, however, is designed for data in short regions without recombination, and relies on other methods to assemble short haplotypes into longer ones. We therefore did not include PPHS in this study. HapSeq is modified from THUNDER that improves on haplotype phasing if a read carries multiple alleles. We did not compare HapSeq, as it addresses a different problem. We included BEAGLE () as a second benchmark method. BEAGLE runs faster than THUNDER but performs as accurate (). Although BEAGLE does not directly work on NGS data, it takes genotype likelihoods as input, which can be generated from read counts. We introduce a Dynamic Bayesian Markov model (DBM) for phasing and characterizing haplotypes in NGS data of unrelated individuals. Three main reasons motivated this work. First, we want to design a coherent probabilistic model for haplotype phasing, such that inference consistency is theoretically justifiable. Some existing methods () use iterative conditional probabilities to infer haplotypes, for one individual at a time with the remaining individuals serving as donors. Such models do not have joint distributions corresponding to the conditionals used in iteration, and thus their results may not be consistent. Second, we want to develop a concise, but sufficient, representation of haplotypes for intuitive interpretation, visualization and comparison in downstream analysis. Existing methods only output strings of alleles as haplotypes, which neither reflect SNP dependencies nor suggest haplotype relationships among individuals. In many studies, haplotypes are not of direct interest. They are instead used as input in downstream studies such as association mapping and population inference. HaploView () is one example of haplotype characterization, which shows haplotype block structures and SNP correlation. HaploView, however, does not characterize haplotypes at the individual level. Our third motivation is to provide users with a flexible tool for NGS data analysis, which can be applied to any species of interest with minimum input from the users. A schematic view of our approach is shown in. The observed read counts () do not carry haplotype information across SNPs. DBM takes read counts as input and infers haplotypes via three key components (): an infinite-state hidden Markov model (HMM) modelling templates of haplotypes, with two Markov chains fitted to each individual; an emission probability of alleles from the state at each SNP; and an observation probability connecting alleles to the observed read counts. DBM is an example of non-parametric Bayes model () equipped with Markov structures, and is also a variant of infinite-state HMM (). We use Markov Chain Monte Carlo (MCMC) algorithms to estimate posterior distributions of model parameters of interest. Particularly, DBM outputs genotypes, haplotypes and recombination probabilities between SNPs. In addition, DBM produces segmentations of haplotypes at the individual level as mosaic combinations of states (). Haplotypes within the same states are similar across SNPs, but not necessarily identical due to random mutations. The state information produced by DBM can be directly visualized to evaluate the relationships of haplotypes among individuals at the SNP resolution. Haplotype blocks and recombination hotspots can also be easily identified. A challenging problem in HMM is to determine the number of states. Although too many states may reduce inference efficiency and over fit the data, too few states may not be sufficient to capture all the information in the data and thus loose power. In DBM, we allow the number of states to vary across SNPs. DBM uses a non-parametric Bayesian process to dynamically infer the number of states across SNPs. It has great flexibility to fit regions with either simple or complex structures. Simultaneously, DBM avoids over fitting the data via Bayesian regularization.
DISCUSSIONWe introduced a dynamic Bayesian Markov model for joint inference of genotypes and haplotypes in NGS data. The method is fully probabilistic and produces consistent inference results. A main feature of DBM is its infinite-state Markov chain that allows varying numbers of mixture components fitted to the data depending on the structural complexity of the data across regions, such that haplotype structures and SNP dependencies can be most efficiently and sufficiently captured by the states. Using data from the 1000 Genomes Project with individuals of different ethnicity, we compared DBM with two popular algorithms: THUNDER and BEAGLE, as they both have been used to phase haplotypes in the 1000 Genomes Project (the 1000). In all scenarios tested, DBM produced either similar or better results than the two benchmark programs. Particularly, for small sample datasets and/or low sequencing studies, DBM performed substantially better than the other two programs. DBM is thus desirable for exploratory sequencing studies that involve limited samples at low sequencing coverage. For large sample datasets, DBM performed similarly to the other two methods, and DBM had better runtime scalability with respect to the sample size. All three programs tested in this study call genotypes and phase haplotypes simultaneously, which is more powerful than the two-step approach. Consistent with previous reports (), we demonstrated that using LD information can substantially increase the accuracy of genotype calling. DBM is a flexible tool that can be applied to many sequencing projects with minimum input requirement from the user. DBM takes input of either read counts or genotypes (in form of pseudo read counts), and outputs genotypes, haplotypes and recombination probabilities. Additional information such as SNP quality scores and genetic maps can also be provided, but not mandatory. Missing genotypes can be easily accommodated and imputed by specifying zero read counts for both alleles in the input file. Although all examples shown in this article were generated from data in human genome, DBM can be directly applied to sequencing studies of any diploid species. To fully use LD information, SNPs should be ordered by their genomic positions. On the other hand, DBM can work on unsorted SNPs, in which case it reduces to a single SNP call method. DBM characterizes haplotypes via segmentation that captures the haplotype relationships among individuals and de-correlates alleles across SNPs. It also reveals the most likely recombination loci at the individual level. One can use DBM segmentation in downstream analysis for hypothesis testing and parameter inference, such as association mapping and population evolution studies. Most de novo population detection algorithms require independent SNPs, whereas our approach enables use of all SNPs in form of haplotype segments, which can potentially significantly increase the power for detecting subtle stratification. DBM reports summary statistics of a sample in form of haplotypes templates. The templates are identified as commonly shared haplotypes among individuals. The haplotype templates can be used to learn genetic relatedness and diversities within and between groups of samples at the SNP resolution. To compare groups of individuals, data from all groups of individuals should be input to DBM together, such that the state indices are matched across groups. Population NGS data are being increasingly generated in many species of interest, and the sequencing cost continues to drop. Although DBM only facilitates the first step in population sequencing studies, the DBM model itself has broader applications. For example, we can modify the observation and emission probability functions to take various types of data into account. We can also modify the DBM model for de novo detection of population stratification and admixture mapping, where we allow unknown numbers of populations to be admixed without requiring ancestral references.