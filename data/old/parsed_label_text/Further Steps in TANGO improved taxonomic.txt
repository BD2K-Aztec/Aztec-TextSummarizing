Motivation: TANGO is one of the most accurate tools for the taxo-nomic assignment of sequence reads. However, because of the differences in the taxonomy structures, performing a taxonomic assignment on different reference taxonomies will produce divergent results. Results: We have improved the TANGO pipeline to be able to perform the taxonomic assignment of a metagenomic sample using alternative reference taxonomies, coming from different sources. We highlight the novel pre-processing step, necessary to accomplish this task, and describe the improvements in the assignment process. We present the new TANGO pipeline in details, and, finally, we show its performance on four real metagenomic datasets and also on synthetic datasets. Availability: The new version of TANGO, including implementation improvements and novel developments to perform the assignment on different reference taxonomies, is freely available at http://source forge.net/projects/taxoassignment/.
INTRODUCTIONAnalysis of microbial communities has been until recently a complicated task because of the high diversity and the fact that a large number of these organisms cannot be cultured. Current next-generation sequencing technologies have provided an opportunity for doing this analysis routinely (). However, the unprecedented amount of generated data represents a major challenge for computational analysis, which has become an essential tool for microbial genomics. Indeed, computational methods for high-throughput genomic analysis have become the bottleneck of microbial genomics. A number of computational methods have been recently proposed to solve the issue of species identification within microbial communities, most of them based on sequence similarity and phylogeny (Droge). Nevertheless, with the growing number of sequenced samples, the improvement of sequencing technologies in terms of read-length, and the improvement of reference genome libraries, computational complexity of handling the metagenomic data lags behind the needs of current analyses. Hence, further reducing the computational complexity becomes a central challenge for metagenomic analysis methods. In this article, we improve on the previously proposed TANGO algorithm (). TANGO is among the most accurate of all the recently proposed tools for the assignment of reads to organisms based on the computation of the lowest common ancestor (LCA); see () for a recent survey. More precisely, the TANGO algorithm starts from a reference taxonomy and a set of sequence read alignments and looks for the assignment of sequence reads at the best possible taxonomic rank. This procedure allows one to better understand the composition of a metagenomic sample. TANGO is particularly suited to the taxonomic assignment of ambiguous sequence reads, that is, sequence reads with more than one candidate match to organisms; for instance, with the same E-value as the top BLAST hit. Starting with a set of sequence reads, it assigns each of them to ancestral taxons by computing the best suited of the least common taxonomic ancestors for all possible subsets of the set of sequence reads. It relies on an efficient evaluation of the number of mismatches between the sequence read and the reference taxonomy to balance the relevance of precision and recall in the assignment. Assignment of reads to reference sequences is a necessary step in 16S ribosomal RNA gene-based identification. The 16S gene is crucial in bacterial species identification because it is conserved among organisms within a species while diverging across species. The obtained matches are further used for microbial identification by relying on a specific taxonomic scheme, as taxonomic read assignment provides more accurate identification than comparing reads from 16S ribosomal RNA with known databases by using clustering methods (). Anyway, as different taxonomies can differ in both the topology and the adopted names (used to label the nodes), the taxonomic assignment process could produce divergent results when using different reference taxonomies. Moreover, to our knowledge, there is no tool that allows one to perform taxonomic assignments on different reference taxonomies. *To whom correspondence should be addressed.For this reason, we have designed a novel pipeline of the TANGO software that addresses specific issues in sequence read assignment because of characteristics of the input data, namely, taxonomies coming from different database sources. Contracting heterogeneous taxonomies to a common set of taxonomic ranks and then efficiently switching the sequence read assignment from one taxonomy (equalizing phase) to another one are two main novel features of TANGO. More precisely, we have realized a pre-processing of the input taxonomies, which makes the assignment of TANGO more flexible to process data. In this article, we address the aforementioned issues that are relevant for speeding up and improving the quality of sequence read assignment by two novel phases in the TANGO pipeline that aim to pre-process the input data: contraction and equalizing (). Contracting taxonomies means to reduce each tree from a collection of heterogeneous taxonomies to a standard set of common taxonomic ranks; that is, the number of levels of the tree are the same for all trees in the collection. As trees from the previous phase are still different in the number of nodes for each level, the equalizing phase produces a correspondence between leaves and nodes of the contracted taxonomies: the mapping will allow an automatic translation of the sequence read alignments (or matches) from one taxonomy to the other. One of the advantages of this new pipeline, and in particular of the pre-processing step, is that it is preformed only once, independently from the set of input reads. In this work, we have considered the most used reference taxonomies, that are NCBI (), RDP () and Greengenes (). As anticipated before, the differences among taxonomies have a direct impact on the bacterial identification results. For example, there are 43 phyla in the RDP database, 94 in NCBI and 110 in Greengenes, and a number of attempts at taxonomy reconciliation have been undertaken, such as by. However, no consensus taxonomy exists at this day. Consequently, being able to compare assignments based on different taxonomies is particularly interesting, as well as being able to switch between taxonomies. As a final remark, we want to observe that the first available implementation of the TANGO method was straightforward and did not aim at any particular data structure or computational optimizations. Therefore, the new version of the TANGO software, in addition to the novel functions mentioned before, provides an improvement in computational efficiency that is achieved thanks to the adoption of compact data structures and sound programmatic practices. In the rest of the article, we will also illustrate the contributions of these improvements on real and synthetic data on the aforementioned reference taxonomies.
DISCUSSIONAnalysis of microbial communities and the possibility of their characterization by the NGS metagenomic approaches depend on the availability of reference databases and taxonomies. Up to date, major efforts have been deployed for the development of algorithmic approaches for taxonomic assignment. The taxonomic information for this assignment can be obtained from various and often discordant sources. Further steps in TANGO method address this limitation by providing means for contracting heterogeneous taxonomies to a common set of taxonomic ranks and then efficiently switching the sequence read assignment from one taxonomy (equalizing phase) to another. Indeed, despite the tremendous effort spent in classifying bacteria and archaea, even today not enough is known about evolutionary relationships to establish clearly defined taxonomic classes and orders for many of them. Databases, such as the NCBI, RDP and Greengenes, provide access to sets of ribosomal RNA sequence databases necessary for the identification of microbes in a culture-independent analysis of microbial communities. However, one of the hurdles is the fact that these taxonomies do not contain all of the taxonomic levels attached to the published names of the bacterial and archaeal sequences, and, moreover, that there are major topological differences among them. Consequently, taxonomic assignment will produce divergent results when using different reference taxonomies, and there was no tool up to now to freely move between taxonomic assignments that rely on different reference taxonomies. In this article, we improve on our TANGO method for taxonomic classification of microbial communities. The pre-requisite to using TANGOas well as other taxonomic assignment toolsis to perform an alignment of the input sequence reads against reference 16S ribosomal RNA sequences and collecting positive hits. A metagenomic sequence read is then classified by computing the LCA of the species in the set of hits for this sequence read. TANGO improves classification accuracy by balancing the true and false positive assignments depending on different taxonomic levels. Furthermore, TANGO now allows freely moving between different taxonomies and enables easy comparison of taxonomic assignments that rely on competing classifications. The general problem of reconciling different reference taxonomies is still open, and we have only provided in this article a partial answer as LCA preserving mapping, which does not provide much information when the taxonomies have conflicting classifications. Future work also includes providing an efficient web service for taxonomic assignment of microbial communities with TANGO using heterogeneous reference taxonomies. The new version of TANGO including implementation improvements and taxonomy contraction and equalization, as well as the accompanying software, are freely available. TANGO can be downloaded from http://sourceforge.net/projects/taxoassignment/. Random taxonomy generator can be downloaded from http://sourceforge.net/projects/randomtaxonomy/.. Performance evaluation on synthetic datasets. Performance evaluation (execution time on an AMD operton 6134 running at 2.3 GHz) measured for 100 random instances. Random instances are generated by re-sampling to be Greengenes-, NCBI-and RDP-like. Time was measured separately for the pre-processing and taxonomic assignment steps of the pipeline. Reported times for TANGO 2 (BioPerl representation of taxonomies replaced by a hash-based representation of general trees) and TANGO 3 (final version with parameter partial evaluation)