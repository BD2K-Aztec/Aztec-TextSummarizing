Motivation: Most methods for estimating differential expression from RNA-seq are based on statistics that compare normalized read counts between treatment classes. Unfortunately, reads are in general too short to be mapped unambiguously to features of interest, such as genes, isoforms or haplotype-specific isoforms. There are methods for estimating expression levels that account for this source of ambiguity. However, the uncertainty is not generally accounted for in downstream analysis of gene expression experiments. Moreover, at the individual transcript level, it can sometimes be too large to allow useful comparisons between treatment groups. Results: In this article we make two proposals that improve the power, specificity and versatility of expression analysis using RNA-seq data. First, we present a Bayesian method for model selection that accounts for read mapping ambiguities using random effects. This polytomous model selection approach can be used to identify many interesting patterns of gene expression and is not confined to detecting differential expression between two groups. For illustration, we use our method to detect imprinting, different types of regulatory divergence in cis and in trans and differential isoform usage, but many other applications are possible. Second, we present a novel collapsing algorithm for grouping transcripts into inferential units that exploits the posterior correlation between transcript expression levels. The aggregate expression levels of these units can be estimated with useful levels of uncertainty. Our algorithm can improve the precision of expression estimates when uncertainty is large with only a small reduction in biological resolution. Availability and implementation: We have implemented our software in the mmdiff and mmcollapse multithreaded Cþþ programs as part of the open-source MMSEQ package, available on https:// github.com/eturro/mmseq.
INTRODUCTIONHigh-throughput sequencing of RNA (RNA-seq) is superseding microarrays as the standard technology for genome-wide profiling of RNA samples and for differential expression analysis. RNA-seq is a technique for generating millions of short subsequences called reads from a population of RNA transcripts in a biological sample. Roughly speaking, the number of reads generated by a transcript is proportional to its length and to the number of copies of the transcript in the sample. Consequently, given an accurate mapping of reads back to transcripts (e.g. from sequence alignments), it is possible to quantify transcript expression levels from read counts. Sequencing offers greater dynamic range than microarrays and, by providing direct observations of complementary DNA sequences, it allows improved discrimination among isoforms and haplotypes. Although the methodological literature for gene expression profiling with microarray data is mature, there remain aspects of RNA-seq data analysis that require further development. In particular, the principal approaches currently used for differential expression analysis with RNA-seq () make comparisons between treatment classes using statistics derived from sequence alignment counts. Such approaches are useful for assessing differential gene expression because, for most genes, an exact read count can be obtained that is proportional to its expression level. However, methods based on read counts are not robust to variability in the relative expression of isoforms because the length of each isoformnot only its expression levelinfluences the expected number of gene-level read counts. It can be more accurate to estimate expression at the gene level by adding up estimates made at the transcript level than by counting raw alignments as though each gene produced a single transcript of canonical length (). A distinct advantage of RNA-seq is that sequencing along splice junctions and heterozygous loci facilitates the estimation of expression levels for gene isoforms and even haplotype-specific isoforms in polyploid organisms. At the isoform level, raw counts are not available because the sharing of exons between isoforms of the same gene means that reads may align to multiple transcripts. Moreover, sequence homology between genes can result in reads that map to transcripts belonging to different genes. For haplotype-specific analysis, sequence-sharing is even more extreme as only reads mapping to heterozygous loci allow transcripts from different haplotypes to be distinguished. Deconvolution algorithms, which account for the read mapping ambiguity, can provide estimates of the expression levels of each transcript and estimates of the associated uncertainties (). Given the large amounts of *To whom correspondence should be addressed. sequence-sharing between transcripts in mammalian transcriptomes, these uncertainties can be considerable and highly variable. Consequently, it is important to account for differential uncertainty in any statistical analysis based on expression estimates, e.g. when comparing expression levels between treatment groups. This idea has been pursued previously in the context of microarray analysis (e.g.) but has received less attention in the context of RNA-seq analysis. The Cuffdiff 2 software () implements frequentist hypothesis tests to detect differential expression and regulation. The methods rely on a number of distributional approximations, are limited to two-class comparisons and cannot be used for haplotype-specific inference. Recently, a Bayesian model of Markov chain Monte Carlo (MCMC) traces for expression parameters has been proposed () that is attractive because it accounts for the shape of the posterior uncertainties in the parameters. However, it too is limited to a two-condition study design and relies on a computationally intensive read-level algorithm to generate the MCMC traces.
DISCUSSIONThe work we have presented can be applied to a wide range of problems in the study of gene expression thanks to two important features. First, due to the linear mixed regression framework, we are able to model many different patterns of expression. We have shown, for example, how the framework can be used to detect imprinting in mice. Second, by using posterior summaries of expression as the outcomes in our regression models rather than alignment counts, we are able to apply our methods in cases where counts are not readily available, such as haplotype-specific and isoform-specific analyses. We have described earlier in the text how transformation of expression proportion variables to the probit scale allows us to detect differential isoform usage. Crucially, having demonstrated that posterior uncertainty in expression estimates may be large and heteroscedastic, we have shown that accounting for this uncertainty can improve precision and sensitivity. Ordinarily, a different method would be applied to comparisons of expression intensities at different levels of granularity. For example, standard gene expression analyses might be based on comparisons of genome-alignment counts, allelespecific expression analyses might compare counts on a heterozygote-by-heterozygote basis and splicing analyses might compare counts on a splice junction by splice junction basis. It is difficult to integrate the results of such varied kinds of analyses to make inference. Returning to the mouse dataset mentioned earlier in the text, we have shown how our method can be used to perform a differential expression analysis between the two strains in the (pure-strain) parents together with a differential expression analysis between the two strains in the first-generation crosses (i.e. between haplotypes). Our model can straightforwardly accommodate both types of analysis, producing comparable posterior probabilities. More generally, our model selection method can be applied universally to any arbitrary collection of features through aggregation of joint posterior distributions. Analyses could be performed at the gene, haplo-gene, isoform, haplo-isoform, exon and 5 0-untranslated region (UTR) level, to name a few, applying a single method of inference across comparison types to an RNA-seq dataset. In the latter example, it would be possible to detect changes in 5 0 UTR usage between treatment groups simply by collapsing isoforms sharing the same 5 0 UTR start sites. Finally, we have shown how polytomous classification can be performed effectively when more than two models are postulated for the data, which is often the case in studies of gene expression.