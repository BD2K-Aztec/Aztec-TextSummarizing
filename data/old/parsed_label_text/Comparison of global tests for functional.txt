Motivation: An important object in the analysis of high-throughput genomic data is to find an association between the expression profile of functional gene sets and the different levels of a group response. Instead of multiple testing procedures which focus on single genes, global tests are usually used to detect a group effect in an entire gene set. In a simulation study, we compare the power and computation times of four different approaches for global testing. The applicability of one of these methods to gene expression data is demonstrated for the first time. In addition, we propose an algorithm for the detection of those genes which might be responsible for a group effect. Results: We could detect that the power of three of the approaches is comparable in many settings but considerable differences were detected in the computation times. Our proposed gene selection algorithm was able to detect potentially effect-causing genes in artificial sets with high power when many genes were altered with a small effect, while classical multiple testing was more powerful when few genes were altered with a large effect. Availability: An R-package called RepeatedHighDim which implements our new global test procedures is made available from http://cran.r
INTRODUCTIONA typical problem in genomic analysis is the comparison of gene expression levels recorded by DNA microarrays in two distinct groups of patients, for example therapy responders or non-responders. Usually, the comparison comprises the search for differentially expressed genes by means of multiple hypothesis testing (), potentially resulting in a list of significant genes. Multiple testing procedures conduct a statistical test for each single gene and adjust the resulting P-values for a desired error rate (e.g. the false discovery rate) to avoid too much false positives. The biological or medical interpretation of the resulting list of differentially expressed genes is, however, a difficult and tedious task. Furthermore, expression changes in single genes could easily be missed, for example, due to small sample size and limited power of the analysis. Therefore, it can be beneficial * To whom correspondence should be addressed. to search directly for significant group effects in gene sets, e.g. differential pathways or functional groups. Gene sets defined by signaling pathways (e.g. cell proliferation or apoptosis) or other certain functional groups (e.g. transcription factors, tyrosine kinase activity) are often in the special focus of disease research. This allows for a direct association between the particular gene set and the levels of the group response. This will not only make the biological interpretation of the data easier but also reduce the multiplicity problem to a more overseeable number of gene groups to test. Further, a global group effect might also become detectable via a group test when many genes within a group are just slightly differential but none of them is significant in an individual gene test by itself. Many approaches for gene set enrichment analysis exist. In principle, they can be grouped in two different categories: (i) approaches that perform the individual significance test for each gene first and then test for enriched gene sets based on either a cutoff () or on the gene order (Approaches that perform a global test for each gene set directly. In principle, these different categories test completely different null hypotheses and are appropriate for different biological questions. A more detailed categorization and discussions about the utility of these approaches can be found inand in). Here we will focus on the latter global test approaches. In particular, the purpose of this article is first to compare different global test methods for functional gene sets in two-group designs, and secondly to provide a method for detecting those genes (of a functional set) which might be responsible for a detected group effect. A first suggestion for global testing in microarray experiments was given bywho use a permutation-based approach in order to deal with the high dimensionality of gene expression data.developed a global test ('GlobalTest') using a logistic regression approach, where the dichotomous response Y {1,2} represents two clinical or biological groups and genes are the predictors. They study thus the hypothesis that the phenotype is independent from the gene expression X,d, is the matrix of normalized gene expression levels with d genes and n samples. The test statistic of this method employs the low-dimensional (nn) covariance matrix between samples instead of the large (d d) covariance matrix between the genes. Thus, the method avoids long computation times and does not require a large working space. Under the null hypothesis, the test statistic has, asymptotically, a normal distribution. However, for small sample sizes a permutation test is provided and recommended.proposed a test that is based on the distribution of gene-wise test statistics. At first, the two-sample t-test is performed per gene, and than either the one-sample t-test or the one-sample Wilcoxon test is applied on the set of gene-wise test statistics. The idea of this procedure is that the distribution of the test statistics is biased under a global group effect, and that this bias is detected by the one-sample tests. The authors called their procedure test of test-statistics ('ToTS'). Further, an ANCOVA model for global testing ('GlobalAncova') was proposed by Mansmann and Meister (2005) and was extended by. In this ANCOVA model, the null hypothesis is tested that the gene expression is independent of the group level, i.e. H 0 : P= P. In this method, the high dimensionality is handled by assembling the residual sums of squares (RSS) of gene-wise models to the RSS of a global model. The combined RSS are used in the test statistic which has, asymptotically, a  2-distribution under H 0. Like GlobelTest, GlobalAncova provides a permutation test for small sample sizes. Finally, Brunner (2009) presented a test for group effects in highdimensional repeated measures data, where the repeated measures factor is allowed to have more levels than the number of available samples. This approach allows the covariance matrices to be of an arbitrary structure. Here, we demonstrate for the first time the applicability of this approach in the setting of global tests for gene sets by regarding the genes as the levels of the repeated measures factor. Since this test is still unnamed, we call it 'RepeatedHighDim'. The test of Brunner (2009) does not use a permutation algorithm to assess the correlation between genes. Instead, the correlation information is incorporated using the representation theorem of a quadratic form () and Box's approximation (). Thus, it is likewise not necessary to estimate the large covariance matrix between genes. This new approach is further detailed in the Section 2. We compare the attained significance levels, the power and computation times of GlobalTest, ToTS, GlobalAncova and RepeatedHighDim in simulation studies, considering different settings of covariance matrices, sample sizes and dimensions. As described by, after global testing it can be important to step downwards to the level of individual features. Therefore, we additionally propose a procedure for detecting the relevant genes of a potential group effect. Lists of genes detected with this procedure are compared with lists resulting from of a classical procedure of multiple hypothesis testing. Furthermore, we apply the three tests to a functional gene set of 1747 genes associated with cell proliferation. The samples were taken from normal and tumor tissues of patients with colorectal cancer ().
DISCUSSIONWe have compared the attained level, the power and computation times of four different test procedures for global group comparisons in microarray experiments in the case of functional gene sets. Noticeable differences in the attained level and power were especially observed when the asymptotic results of GlobalAncova and GlobalTest were compared to RepeatedHighDim. Within this setting, GlobalTest becomes sometimes too conservative and GlobalAncova too liberal, whereas RepeatedHighDim maintains the preassigned significance level accurately. The permutation results of GlobalAncova and GlobalTest maintained the preassigned level very well, too. The ToTS approach clearly exceeded the prespecified significance level in all simulation settings. Here, we showed only the results of ToTS when applying the one-sample t-test on the set of test statistics. However, the simulated levels were very similar when using the one-sample Wilcoxon test. We have additionally studied some situations with non-normally distributed data and found that the RepeatedHighDim procedure is quite robust against deviations from the normal distribution, i.e. with regard to maintenance of the preassigned significance level (see Supplementary Material). Accordingly to the level simulations, the power was largest for the asymptotic result of GlobalAncova and smallest for the asymptotic result of GlobalTest. When using their permutation results, the power curves of these two methods nearly approached that of RepeatedHighDim. Differences in power were also observed for the different types of covariance matrices but neither for different numbers d of genes nor for the different numbers of samples sizes. The analysis of computation times of the latter three methods yielded that RepeatedHighDim is much faster than the permutation or asymptotic tests performed with GlobalAncova and GlobalTest. This plays a particular role in the proposed detection algorithm where a global test is carried out up to 2d times. Under this regard, and with the results of Section 3.5, one can conclude that the selection algorithm takes about 12 min in combination with RepeatedHighDim and several more minutes in combination with the two other global test approaches, depending on the size d of the gene set. The asymptotic result of GlobalTest is also obtained very fast but has the drawback of a rather low power. Therefore, RepeatedHighDim is preferable for being combined with the proposed algorithm. This speed comparison is of course only based on the available software. There may be faster implementations possible for each method. In principle, the introduced algorithm for the detection of effectcausing genes can be applied with all three testing approaches. Although, the average power rate of this new algorithm sometimes outperforms that of classical multiple testing, it has the drawback of too high FDR levels in these cases. We therefore intent, to work further on the improvement of this algorithm. With regard to the power rate of our selection algorithm, one can further argue that researchers perhaps tend to take adjusted P-values for the classical multiple testing approach from the whole dataset and not just from the functional set. In that case, our algorithm would even have a larger power rate in other situations than in those observed in our simulations. An alternative idea was given by Srivastava and Kubokawa (2008) who use Akaike's information criterion to select components of the mean vector in high-dimensional data. In this article, we have shown the applicability of the approach proposed byto microarray data in the two-group setting. GlobalAncova and GlobalTest provide also the possibility to test other experimental factors. In general, study designs with more than one group factor on two levels can also be tested with RepeatedHighDim by constructing an appropriate contrast matrix H. While in this article we focused on the comparison of the new models bywith three of the most popular global test methods, a certain number of other global test approaches exists, which were not included to our simulations.for example proposed the SAM-GS method which was also compared to GlobalAncova and GlobalTest bywith similar results for the latter two approaches than ours. Another approach, based on Hotelling's T 2-statistic, was proposed by