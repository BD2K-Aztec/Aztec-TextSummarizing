Motivation: Random effects models have recently been introduced as an approach for analyzing genome wide association studies (GWASs), which allows estimation of overall heritability of traits without explicitly identifying the genetic loci responsible. Using this approach, Yang et al. (2010) have demonstrated that the heritability of height is much higher than the âˆ¼10% associated with identified genetic factors. However, Yang et al. (2010) relied on a heuristic for performing estimation in this model. Results: We adopt the model framework of Yang et al. (2010) and develop a method for maximum-likelihood (ML) estimation in this framework. Our method is based on Monte-Carlo expectation-maximization (MCEM; Wei et al., 1990), an expectation-maximization algorithm wherein a Markov chain Monte Carlo approach is used in the E-step. We demonstrate that this method leads to more stable and accurate heritability estimation compared to the approach of Yang et al. (2010), and it also allows us to find ML estimates of the portion of markers which are causal, indicating whether the heritability stems from a small number of powerful genetic factors or a large number of less powerful ones.
INTRODUCTIONMany complex traits display a remarkable gap between the overall genetic variance estimated by population studies (such as twin studies) and the variance explained by specific genetic variants identified by genome wide association studies (GWASs). This gap has been coined the 'dark matter' of heritability (). Suggested explanations for this gap include genegene and gene-environment interactions (), unidentified by the univariate GWAS scheme, though some of these explanations have been refuted by studies (). Height, being a trait that is easy to measure but genetically complex, has attracted special attention. Heritability of height, defined as the portion of height variability due to genetic factors, was estimated at around 80% () while the tens of specific single nucleotide polymorphisms (SNPs) identified by large-scale GWASs account for only 10% of the heritability (). Extrapolating from these data, under specific statistical assumptions,estimated the number of causal SNPs affecting height at 93 000, which is at the high end of reasonable values.recently suggested the use of random effects models as a multivariate approach for estimating the heritability of * To whom correspondence should be addressed. height directly from GWAS data. In their model, each individual's height is affected by a genetic random effect, which is correlated across individuals by virtue of sharing some of the genetic variants affecting height, and an environmental random effect, which is uncorrelated across individuals. Consistent with the common definition, they define heritability as the ratio of the variance of the genetic random effect to the total variance. Using a straightforward maximum-likelihood approach for estimating heritability in this model requires knowledge of the identity of the causal SNPs, and hence the covariance matrix. This is of course not available, soapproximate the genetic correlation between every pair of individuals across the set of causal SNPs by the genetic correlation across the set of all genotyped SNPs. Using this approximation they estimate the heritability of height at 45%. By adding some further assumptions about the nature and distribution of the causative SNPs they obtain heritability estimates of 56% and 80%. While the random effects approach proposed byis innovative and appropriate, the concept of using an estimated correlation matrix instead of the actual correlation matrix is a questionable heuristic. The very large number of SNPs used for estimating the genetic correlationsmost of them likely not causativemight mask out the correlations on the set of causal SNPs. As we show below, this indeed leads to inaccurate and suboptimal estimation of heritability. Instead, we propose here to treat the identity of the causal SNPs as missing data, and find true maximum-likelihood estimates of our parameters of interest in this setting. Towards this end, we develop an expectation-maximization (EM) algorithm for this problem. Because of the exponentially large data space, we employ Markov chain Monte Carlo (MCMC) methods for the estimation of the E-step. This approach is known as Markov-chain expectationmaximization (MCEM;). We also develop an efficient optimization approach for the M-step, based on spectral decomposition of the estimated covariance matrix. The resulting algorithm is computationally intensive, yet tractable for reasonably sized problems, as we demonstrate. As a by-product of our approach, we also get maximum-likelihood estimates of the portion of genotyped SNPs that are causative in the random effect model. This represents independently useful information, as it indicates whether the estimated heritability is likely due to a small number of large genetic effects, or a large number of smaller effects. For example, this knowledge may be useful in planning further studies to identify these specific factors. We empirically demonstrate using simulations that our method, in addition to being theoretically sound, does indeed lead to significantly more accurate estimation of heritability than the heuristic approach of