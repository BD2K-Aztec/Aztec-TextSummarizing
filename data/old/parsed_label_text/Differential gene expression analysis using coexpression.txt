Motivation: RNA-Seq is increasingly being used for differential gene expression analysis, which was dominated by the microarray technology in the past decade. However, inferring differential gene expression based on the observed difference of RNA-Seq read counts has unique challenges that were not present in microarray-based analysis. The differential expression estimation may be biased against low read count values such that the differential expression of genes with high read counts is more easily detected. The estimation bias may further propagate in downstream analyses at the systems biology level if it is not corrected. Results: To obtain a better inference of differential gene expression, we propose a new efficient algorithm based on a Markov random field (MRF) model, called MRFSeq, that uses additional gene coexpression data to enhance the prediction power. Our main technical contribution is the careful selection of the clique potential functions in the MRF so its maximum a posteriori estimation can be reduced to the well-known maximum flow problem and thus solved in polynomial time. Our extensive experiments on simulated and real RNA-Seq datasets demonstrate that MRFSeq is more accurate and less biased against genes with low read counts than the existing methods based on RNA-Seq data alone. For example, on the well-studied MAQC dataset, MRFSeq improved the sensitivity from 11.6 to 38.8% for genes with low read counts. Availability: MRFSeq is implemented in C and available at
INTRODUCTIONNext-generation sequencing technologies have been widely used in genomics research. RNA-Seq, one of the most exciting applications of next-generation sequencing technologies, is used to reveal the complexity of tanscriptomes in biological systems (). Many unprecedented discoveries are being made by RNA-Seq, such as the inference of novel isoforms, characterization of the modes of antisense regulation and study of intergenic expression patterns (). In recent years, RNA-Seq has taken a major role in the quantitative analysis of gene expression and transcript variant discovery. In the past decade, most of these applications were dominated by microarray-based technologies. In these quantitative assays, RNA populations are partially sequenced and the obtained read sequences are aligned back to the reference genome. The aligned reads are then assigned to genes based on the common regions that they share in the alignment. The number of reads assigned to a gene is called the read count of the gene, which has been shown to be nearly linearly correlated with the expression level of a gene (). Differential gene expression analysis is to identify if genes express differently between biological conditions of interest. Given RNA-Seq read count data, detecting differentially expressed (DE) or equally expressed (EE) genes can be done by checking if the observed difference of the read counts is significant or not, i.e. greater than some natural random variation. To test the significance of the difference between RNA-Seq read counts, the distribution of read counts was first assumed to be Poisson in (). However, the Poisson distribution may underestimate the variance of read counts and cause unexpected false positives in differential gene expression analysis (). To solve the problem, negative binomial distributions were applied to RNA-Seq read data () and have become the state-of-the-art statistical model. Other than the methods based on the Poisson or negative binomial distributions, two data-driven probabilistic methods, baySeq () and NOISeq (), have also been proposed. Moreover, given annotated or inferred mRNA transcripts (or isoforms) of genes, some statistical methods for detecting differential expression at the transcript level have been published recently (). Because the expression level of a gene with known (or inferred) isoforms can be calculated by simply summing up the expression levels of its isoforms, these transcript-level methods can be used as alternative methods for detecting differential expression of isoforms (), although the accuracy of these methods clearly depends on the quality of the provided isoforms. Although the statistical properties of RNA-Seq data have been well studied and taken into account in the above statistical methods, these methods suffer from the following issues. First, it has been observed that statistical power increases with read count *To whom correspondence should be addressed. values (). Note that the read count of a gene is proportional to the gene expression level multiplied by the gene length. As a result, long or highly expressed genes are more likely to be detected as DE genes compared with their short and/or lowly expressed counterparts. This bias in DE gene detection is unavoidable even when normalization or rescaling is applied to read count data (). It is known that the selection bias on DE genes, if uncorrected, may lead to biased downstream analyses (). Second, the dependency among the expression of genes is not used in these methods. In gene expression analysis based on microarray data, the prior knowledge of gene coexpression patterns has been used to improve the performance of algorithms for detecting phenotype-related pathways (), searching for significant pathway regulators (), identifying differential gene expression patterns () and the classification of microarray data (). In particular, to obtain more accurate inference of DE genes, Wei and Li () proposed a Markov random field (MRF) model that integrates the gammagamma model based on microarray data () and gene coexpression networks extracted from KEGG pathways () such that DE genes can be determined by the maximum a posteriori (MAP) estimation of the MRF model. Their experimental results demonstrate that the additional gene coexpression information can help detect more subtle changes of gene expression (e.g. local disturbances within known pathways) and significantly improve the overall prediction accuracy of DE genes (). However, due to the difference between continuous microarray intensity values and discrete RNA-Seq read counts, The MRF model in () cannot be applied to RNA-Seq data immediately. Moreover, because the MAP estimation problem for an MRF model is generally NP-Hard (), the MRF model in () was solved by a heuristic method, iterated conditional modes, which provides an approximately optimal prediction with no confidence scores. In this work, we propose a novel MRF model, MRFSeq, combining RNA-Seq read counts with the prior knowledge of gene coexpression networks to infer DE genes. Different from the MRF model in (), we choose the clique potential functions of the MRF model carefully so that the MAP estimation of DE genes can be reduced to the wellknown maximum flow problem on flow networks based on the work of Kolmogorov and Zabih (). Because the maximum flow problem is polynomial-time solvable, our MRF model can be solved exactly in polynomial time. Moreover, we introduce a loopy belief propagation method () to calculate the confidence of each inferred DE or EE gene. Our extensive experiments on simulated and real RNA-Seq data demonstrate that MRFSeq achieves a much improved overall estimation performance by gaining considerable sensitivity without losing precision. A detailed analysis of the prediction results indicates that the DE genes predicted by MRFSeq are distributed more evenly across different values of read counts than those recovered by the existing methods using RNA-Seq data alone. Hence, MRFSeq can help alleviate the selection bias of DE genes against genes with low read counts. Our analysis further shows that most of the DE or EE genes that can be correctly predicted from RNA-Seq data alone are also correctly predicted by MRFSeq, implying that the use of the prior knowledge of gene coexpression does not introduce new biases in the differential analysis result. Moreover, we compare MRFSeq with a recently published transcript-level method, Cuffdiff 2 (), on the real RNA-Seq data using the annotated transcriptome from UCSC hg19 (). The comparison shows that MRFSeq is much more sensitive than Cuffdiff 2. The rest of this article is organized as follows. Section 2.1 defines the terms and notations used in our algorithms, while Section 2.2 provides the formulation of the MRF model and the design of its clique potential functions. The reduction to the maximum flow problem is shown in Section 2.3. The experimental results are described in Section 3, which also contains a comparison between MRFSeq and existing differential expression analysis methods including edgeR (), DESeq (), baySeq (Hardcastle and), NOISeq () and Cuffdiff 2 (). In particular, Section 3.4 compares the performance of the methods on genes with low read counts and shows that MRFSeq achieves not only an overall significantly higher accuracy but also provides a less biased prediction. A few concluding remarks are given in Section 4. The loopy belief propagation method for calculating the confidence level of each prediction as well as some figures and tables are omitted in the main text owing to page limit and are provided in the Supplementary Materials.