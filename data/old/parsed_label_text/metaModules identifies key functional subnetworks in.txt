Motivation: The human microbiome plays a key role in health and disease. Thanks to comparative metatranscriptomics, the cellular functions that are deregulated by the microbiome in disease can now be computationally explored. Unlike gene-centric approaches, pathway-based methods provide a systemic view of such functions; however, they typically consider each pathway in isolation and in its entirety. They can therefore overlook the key differences that (i) span multiple pathways, (ii) contain bidirectionally deregulated components, (iii) are confined to a pathway region. To capture these properties, computational methods that reach beyond the scope of predefined pathways are needed. Results: By integrating an existing module discovery algorithm into comparative metatranscrip-tomic analysis, we developed metaModules, a novel computational framework for automated identification of the key functional differences between health-and disease-associated communities. Using this framework, we recovered significantly deregulated subnetworks that were indeed recognized to be involved in two well-studied, microbiome-mediated oral diseases, such as butanoate production in periodontal disease and metabolism of sugar alcohols in dental caries. More importantly , our results indicate that our method can be used for hypothesis generation based on automated discovery of novel, disease-related functional subnetworks, which would otherwise require extensive and laborious manual assessment. Availability and implementation: metaModules is available at https://bitbucket.org/alimay/ metamodules/ Contact: a.may@vu.nl or s.abeln@vu.nl Supplementary information: Supplementary data are available at Bioinformatics online.
IntroductionThe human microbiome is a functional community that plays an important role in health and disease (). Disorders that have been previously linked to, for instance, the gut microbiome, include cardiovascular disease () and type 2 diabetes (). Because distinct populations of microbes from different patients can harbor remarkably similar functional capabilities (), the pathogeneses of these diseases may not necessarily be related to specific microbial population shifts from the health-associated microbiome. Phenotypic differences are therefore better explained by changes in the regulation of cellular mechanisms, for instance in the form of under-or overexpression of certain metabolic pathways or parts thereof. A prerequisite for this is the ability to identify differentially expressed functional systems using computational pipelines that can operate at the systems level. The availability of such pipelines is likely to lead to increased discovery of preventive and therapeutic targets in microbiome-related diseases. Metagenomics and metatranscriptomics are two powerful approaches for studying, respectively, the functional capability and activity of microorganisms in environmental and clinical samples. The latter provides a more direct view into disease-associated factors since microbial activity is often clinically more relevant than microbial genetic potential. Supporting this are recent observations of many metagenomically abundant gene families being consistently downregulated at the transcriptional level, for instance, in the human gut microbiome (). Comparative metatranscriptomics (meta-RNA-Seq) aims at identifying the functions that are significantly differentially expressed by microbial communities under different conditions. Because the number of active microbial genes can reach up to several millions, the functional profile of a sample is commonly constructed by mapping mRNA reads first to genes, and then to higher-level functional units such as KEGG Orthology groups (KOs,). KOs are organism-independent identifiers that group together proteins of similar biochemical functions. As with genes, they can be used to perform differential expression analysis using packages such as edgeR () and DESeq2 (). Since interpreting results at KO level is not straightforward, this is typically followed by pathway or gene set enrichment analysis () (as in). Another common approach is to use bioinformatics pipelines such as MEGAN () or HUMAnN () to map KOs to predefined functional modules and pathways, such as those in the KEGG and MetaCyc () databases, and then to identify the deregulated functional units (as in). Pathway-based approaches provide invaluable insights into disease biology; however, they have a number of shortcomings that are critical for the identification of functional markers. First, they consider each predefined pathway individually and therefore ignore the interactions between pathways that may be crucial for discovering causal biochemical mechanisms. Second, collapsing the expression levels of KOs into pathways or modules can have two undesired outcomes: non-differentially but highly expressed functions within a pathway can obfuscate significant differences of other parts of the same pathway. Moreover, pathways that contain up-and downregulated genes may be determined as non-differentially expressed overall. Finally, significantly deregulated pathway regions that are not covered by predefined module delineations cannot be identified.Methods that address the above limitations of pathway-based methods have been previously reported. By combining protein-protein interaction networks with gene expression data,introduced the concept of identifying connected subsets of regulatory genes that are responsible for changes in expression under different conditions. This concept has since been extended to other settings, including networks of enzymatic () and regulatory elements (). The central idea in these methods can be summarized in three main steps: (i) constructing a mathematical network (graph) that captures the core molecular interactions in biological pathways, (ii) assigning numerical scores that reflect biological activity (or response) to the components (edges/nodes) in the network and finally (iii) performing a search on the network to identify the highly scoring subnetworks that delineate the biological hotspots from the rest of the network [for a review, see. The current work introduces metaModules; a novel approach that focuses on comparative metatranscriptomic datasets for identifying metabolic subnetworks of significantly deregulated orthologous gene groups. An earlier work in this direction is MetaPath (), a method for finding differentially abundant enzymatic subnetworks in metagenomic datasets. The biological questions addressed by our method and MetaPath are fundamentally different: whereas MetaPath is specifically designed to find subnetworks of reactions that are either enriched or depleted as a whole in a given experimental condition, metaModules focuses on finding connected subsets of significantly deregulated ortholog gene groups. Note that the subnetworks discovered by MetaPath do not have to be composed of significantly differentially abundant or expressed elements. Instead, the statistical significance of these subnetworks is evaluated using a bootstrapping strategy. On the other hand, as it is designed with a metatranscriptomic focus, our approach uses statistics that are tailored to the properties of RNA-Seq data. Following the work by, our method specifically searches for connected subnetworks that predominantly contain significantly differentially expressed KOs, which can be either up-or downregulated in different experimental conditions. Finally, the exact search algorithm used by metaModules, Heinz (), guarantees to find the optimal maximum-scoring subnetwork within the input network. We applied metaModules to previously published metatranscriptomic datasets of two well-studied, oral microbiome-related diseases: periodontal disease and dental caries. Periodontal (gum) disease originates from an unbalanced host-microbiome interaction that leads to an enhanced host inflammatory response. If left untreated, it causes the destruction of tooth-supporting structures and may eventually result in tooth loss (). Dental caries (tooth decay) is one of the most common chronic diseases, where the main cause is a net overproduction of acids during microbial carbohydrate fermentation in the oral cavity, leading to the demineralization of dental hard tissues (). Using metaModules, we recovered significantly deregulated connected subnetworks of functions that are important in a number of mechanisms previously associated with these diseases, such as the production of metabolites that inhibit human cell growth in periodontal disease. Our results indicate that using high throughput data, our methodology can be used to generate new hypotheses automatically by uncovering novel disease-related metabolic mechanisms in microbial communities. Although we demonstrated it on microbiomerelated disease datasets in this study, metaModules can be used for datasets from any type of comparative metatranscriptomic studies.