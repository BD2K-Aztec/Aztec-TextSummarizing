Motivation: The advent of next-generation sequencing (NGS) has created unprecedented opportunities to examine viral populations within individual hosts, among infected individuals and over time. Comparing sequence variability across viral genomes allows for the construction of complex population structures, the analysis of which can yield powerful biological insights. However, the simultaneous display of sequence variation, coverage depth and quality scores across thousands of bases presents a unique visualization challenge that has not been fully met by current NGS analysis tools. Results: Here, we present LayerCake, a self-contained visualization tool that allows for the rapid analysis of variation in viral NGS data. LayerCake enables the user to simultaneously visualize variations in multiple viral populations across entire genomes within a highly customizable framework, drawing attention to pertinent and interesting patterns of variation. We have successfully deployed LayerCake to assist with a variety of different genomics datasets. Availability and implementation: Program downloads and detailed instructions are available at
IntroductionComparative sequence analysis can reveal evolutionary relationships that could otherwise not be discerned. Sequence comparisons can also identify signatures of natural selection and, when analyzed in conjunction with appropriate phenotypic data, can be used to infer the 'pressures' driving selection processes. Prior to the arrival of next-generation sequencing (NGS), comparative sequence analysis was largely restricted to the comparison of consensus sequences; i.e. sequences represented by the most abundant nucleotide at a given position in a particular sample. The limitations of consensus-level sequence analyses are particularly apparent when examining RNA viruses, as samples often contain a highly heterogeneous 'swarm of mutants'the diversity of which cannot be represented by a consensus sequence. NGS yields thousands of short 'reads' that together represent the full diversity of virus sequences in a sample. The assembly of these sequencing reads using either a pre-determined reference or a reference assembled de novo from the reads themselves allows for the reconstruction of coding-complete viral genomes with the detection of nucleotide variants that exist in as little as 1% of a viral population. With this paradigm, it is now possible to overlay useful information such as nucleotide polymorphisms, polymorphism frequencies and sequencing coverage depth onto every position of a whole-genome consensus sequence. Conveying the read depth at each position in conjunction with the above information creates a large multi-dimensional matrix, which can be difficult to display visually in a manner that) is compared, especially when the virus in question has a high degree of intra-sample sequence variability. However, it is in precisely these contexts that a visualization tool can be most useful for evaluating variation across genomes. Relevant to the discussion of genomic sequence variability is the notion of a sample. Rather than a sequence of nucleotides, an individual sample contains the population of nucleotides observed at different locations along a genome, derived from NGS data. These populations can be compared to a reference sequence (or 'reference population', see Section 2.2.2) to define a certain proportion of variability at each location. By visualizing different samples simultaneously, we can observe change in variability over time (if we take multiple samples from the same infected organisms but at different time points) or observe subgroups within a particular virus (if we take samples from multiple organisms and compare them). In both cases, the analyst compares multiple samples at once. We have therefore developed the LayerCake visualization tool to address the problem of visualizing sequence variability in viral populations. In LayerCake, samples are visualized as a colored row or layer in a single view, with variability and confidence information encoded as color. LayerCake automatically aggregates regions of the genome into discrete bins, the size of which can be controlled by the user. This design allows viewers to immediately receive an overview of the entire dataset and quickly locate regions of interest within or among samples. Zooming and side displays allow the user to retrieve detailed, nucleotide-level statistics with a single click. Interaction allows the user to adjust the aggregation, update the metrics used to define variation or update metrics related to data quality or importance. In this article, we describe the LayerCake system in detail, contextualizing its design with respect to other visual analytics tools for genomics and presenting case studies of how LayerCake has been used in multiple genomic analysis settings. We expand upon the initial LayerCake prototype detailed in, supporting a more robust model of sequencing data, the capacity to deal with multiple settings of 'references' and 'pseudo-references' and adaptation to more general datasets.
DiscussionThe LayerCake system has been widely deployed across a number of viral datasets. In this section, we highlight three case studies that highlight the benefits of the LayerCake system: the presentation of a genome-scale overview of data, the ability to interactively alter notions of reference and variation and the alignment and aggregation of many samples in a single, all-encompassing display. In addition to finding regions of high variation (as described in), LayerCake affords longitudinal comparison of variation (as in) and allows for the identification of subgroups with similar variation signatures (as in Section 3.1).