Motivation: Next-generation sequencing methods are generating increasingly massive datasets, yet still do not fully capture genetic diversity in the richest environments. To understand such complicated and elusive systems, effective tools are needed to assist with delineating the differences found in and between community datasets. Results: The Small Subunit Markov Modeler (SSuMMo) was developed to probabilistically assign SSU rRNA gene fragments from any sequence dataset to recognized taxonomic clades, producing consistent, comparable cladograms. Accuracy tests predicted 90% of genera correctly for sequences downloaded from public reference databases. Sequences from a next-generation sequence dataset, sampled from lean, overweight and obese individuals, were analysed to demonstrate parallel visualization of comparable datasets. SSuMMo shows potential as a valuable curatorial tool, as numerous incorrect and outdated taxonomic entries and annotations were identified in public databases. Availability and implementation: SSuMMo is GPLv3 open source Python software, available at
INTRODUCTIONA number of current research foci look to create a better understanding of the complexity of microbial communities and interactions within diverse environments (). The analysis of complex microbial communities with high-throughput sequencing (HTS) technologies can generate hundreds of thousands of SSU rRNA reads (). SSU rRNA sequences are commonly used to assess community complexity and have been used in such disparate sample regimes as soils (), the human gastrointestinal tract () and potential biofuel sources (). As an alternative to primer-targeted studies, whole genome shotgun (WGS) metagenomics has become increasingly popular over the past decade, as it provides additional insight into community * To whom correspondence should be addressed. function and is purported to reduce sampling bias (). Both whole genome and primer-targeted sequencing methods use the same sequencing platforms; technologies producing everenlarging datasets () and suffering similar sequence artefacts, including shorter sequence lengths and greater uncertainty in the prediction of nucleotide bases when compared with older methods (). Regardless of method, it is always desirable to identify those species that most significantly contribute to their environment. Powerful tools to visualize and identify differences or commonalities between datasets, at a number of hierarchical levels, are needed to help understand and model ecosystems and their dynamics in systems biology approaches (). We have developed the Small Subunit Markov Modeler (SSuMMo) in response to the growing computational demands of such large datasets. SSuMMo is based upon a database of profile hidden Markov models (HMMs), trained with the ARB Silva reference database of SSU rRNA sequences (). The hierarchy of HMMs () is arranged by EMBL taxonomy and acts as a decision tree to catalogue conserved gene fragments into known species names, one taxonomic rank at a time. This design minimizes the number of pairwise comparisons and bypasses the need to create operational taxonomic units (OTUs), species proxies based on percentage sequence similarity. SSuMMo only groups sequences into acknowledged species names, defined after pureculture, phenotypic characterizations (). SSuMMo has been built and optimized for UNIX multicore workstations running Python v2.6+ and is interfaced through a set of command line programs, which can read sequences in over 20 different file formats, as supported by BioPython. SSU rRNA sequences contained within any sequence dataset (genome, HTS gene fragment, etc.) are identified in the first pass of domainlevel classifications and retained for further taxonomic classification. Taxonomic assignments can be visualized in real-time, and results automatically saved into a Python object file (), which is optimized for fast conversion into a number of formats, including phyloxml, html, svg, jpeg, etc. Scripts are provided to calculate abundance and biodiversity information, and fast-track visualization of results using EMBL's IToL web application (), which can paint quantitative and comparative information onto inferred population structures (). SSuMMo can also save annotated sequences separately, for further downstream analyses, or plot any numeric, tabular data onto the ARB taxonomy (See, Supplementary Method 1.8, Supplementaryis created, a plain text tree showing quantitative information is printed to screen. Verbose mode also prints hmmsearch tabular results. The main output is a 'pickled file', saved with python's built-in cPickle module, but annotated sequences can be extracted in their original format for further downstream analyses. (B) Postanalyses scripts: pickled result files can be used by post-analysis programs to produce various figures and tabular data. Asterisksequences are scored against multiple HMMs simultaneously, provided there are spare processor cores. daggerSimpson and Shannon (H', Hmax) indices are available to choose from. double daggerrarefaction curves are plotted using python's matplotlib plotting library, and can be saved in raster or vector-based formats.(ftp://ftp.ncbi.nlm.nih.gov/genomes/TARGET/) and the Human Oral Microbiome Database () against SSuMMo assignments (Supplementary3,). Initial tests showed genus prediction accuracy to be 90% (), prompting development of tools to assist with visualization and comparison of multiple datasets. Functionality was demonstrated with SSU rRNA sequence datasets sampled from lean, overweight and obese individuals (; Supplementary Table S1 and). High-level analyses of pooled results show similar trends to those obtained by thorough analyses performed by, demonstrating SSuMMo's ability to identify trends in dynamic, complex populations. Further detailed analyses exploring the relative accuracy of assignment in each of nine 'hypervariable' regions in 16S rRNA (V1-9), excised from full and near full-length archaeal test sequences showed targeted sequences as short as 70 nt could identify 70% of genera correctly (Supplementary Figs S2 and 3). Simulations were designed to identify ubiquitously conserved sequence regions suitable for broad-spectrum primers. As HTS methods produce relatively short reads compared with the length of the SSU rRNA gene, we looked to identify those regions in Archaea that coincide with the highest percentage of correct genus predictions (). We note that no single region in SSU rRNA is conserved to an extent as to enable a single primer to cover the entire Archaea domain. Simulated studies could be used to predict those taxa that would be identified with a designed 16S rRNA primer by using the SSuMMo HMM database. To assist with modelling changes in population structure and diversity within and between datasets, programs were developed to perform rarefaction analyses, calculate biodiversity indices and export stochastic matrices representing taxon probability distributions. Each program can prune resultant taxonomies at any specified rank prior to performing analyses, an alternative to varying cluster sizes by sequence similarity. Results can be exported in tabular form or visualized using Python's matplotlib plotting library (see Supplementary Method 1.6). The provided scripts can apply resampling methods to SSuMMo results,enabling visual comparisons of estimated sampling depth, taxonomic diversity, species evenness and sampling bias within and between datasets. This is performed by 'rarefying', or randomly sampling an equal number of sequences, from result datasets and calculating Shannon and Simpson indices from the observed taxa. Supplementaryshows how these methods and metrics can be combined and compared within and between sequence datasets to distinguish high-level features of diversity and community structure. The ability to combine and visualize species distributions across multiple datasets is a unique feature of SSuMMo, and provides a far speedier alternative to predicting phylogenies, which is prone to human error and can be difficult to reproduce (). SSuMMo was shown to provide a robust framework for characterization and comparison of population structures, enabling fast access to an array of data dependent metrics. For annotation and inspection, the object-based model provides extensible tools to help compare and edit taxa and sequence annotations between databases.