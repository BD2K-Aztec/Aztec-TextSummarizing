Motivation: Single-cell DNA sequencing is necessary for examining genetic variation at the cellular level, which remains hidden in bulk sequencing experiments. But because they begin with such small amounts of starting material, the amount of information that is obtained from single-cell sequencing experiment is highly sensitive to the choice of protocol employed and variability in library preparation. In particular, the fraction of the genome represented in single-cell sequencing libraries exhibits extreme variability due to quantitative biases in amplification and loss of genetic material. Results: We propose a method to predict the genome coverage of a deep sequencing experiment using information from an initial shallow sequencing experiment mapped to a reference genome. The observed coverage statistics are used in a non-parametric empirical Bayes Poisson model to estimate the gain in coverage from deeper sequencing. This approach allows researchers to know statistical features of deep sequencing experiments without actually sequencing deeply, providing a basis for optimizing and comparing single-cell sequencing protocols or screening libraries. Availability and implementation: The method is available as part of the preseq software package. Source code is available at http://smith labresearch.org/preseq.
INTRODUCTIONThe capability to sequence the DNA of a single cell is essential to analyzing biological diversity in heterogeneous populations of cells. Single-cell DNA sequencing technology is also necessary in applications like preimplantation genetic diagnosis based on the genotype of an individual cell biopsied from a blastocyst (). Recent efforts have used single-cell sequencing to examine genotypic heterogeneity in tumors (), rates of somatic mutations (), recombination rates in the germ line () and probing of the genetic diversity in unculturable bacterial populations such as those naturally occurring in the ocean () or the human gut (). The challenges associated with single-cell genome sequencing are all due to the fact that the relevant DNA only exists in a single copy. For example, the nuclear DNA of a human cell weighs $80 picograms while most standard library preparations specify a minimum input in the nanogram range (). Special protocols are needed to prepare DNA sequencing libraries in single-cell applications. Whole-genome amplification (WGA) is conducted prior to PCR, with the goal of producing more copies of the genome in the form of long amplicons that uniformly cover the original genome. Biases in WGA can dramatically alter the representations of different parts of the genome in the sequencing library (). Methods have been developed to minimize WGA amplification bias by reducing the limiting volume for multiple displacement amplification (MDA) to avoid exponential preferential amplification () or looping of the amplicons to induce quasi-linear amplification. Despite these advances, whole genome amplification remains far from uniform. A major problem in single-cell and low-input sequencing is the loss of loci in the process of sequencing. There are multiple opportunities for portions of the genome to disappear in the library preparation, making them unavailable for sequencing and subsequent observation. This situation is known as locus dropout and creates significant problems for downstream analysis (). For diploid cells, locus dropout presents the additional difficulty that the dropout of one allele is easily mistaken for homozygosity. New single molecule sequencing technologies still require some form of whole-genome amplification prior to PCR amplification (), suggesting these problems will persist. It is our goal here to investigate for a single cell DNA sequencing library the genome coverage from deep sequencing, which we define as the expected number of bases in the reference genome covered by sequencing using high-throughput short-read technology. The traditional mathematical model of sequencing assumes that all parts of the genome are represented in the sequencing library in uniform abundance, resulting in a simple Poisson distribution for the number of reads covering each base (). The possibility of unknown dropout implies this model is inadequate for single-cell sequencing. Additionally the uniformity assumption is lost due to a myriad of biases inherent to high-throughput sequencing (). These problems still exist for single-cell sequencing experiments but are exacerbated by the low starting material, in addition to biases specific to WGA. One example is the observation that priming efficiency and extension rate of the DNA polymerase 29 used in MDA is dependent on nucleotide content, leading to uneven amplification (The highly non-uniform molecular abundances and unknown dropout in the sequencing library are not the only problems in specifying a model for the genome coverage in single-cell sequencing experiments. The coverage of local bases will be highly correlated. There is the natural correlation caused by nearby bases being covered by the same read. Additionally we expect broad correlations due correlated molecular abundances of nearby regions. One example is local correlations related to nucleotide content due to the uneven amplification of MDA. These all create problems in mathematically modeling the sequencing process, as misspecification can create significantly biased estimates. Our aim in this paper is to present a method for estimating the genome coverage of a reference genome in a deep sequencing experiment, based only on information from a shallow initial sequencing run. One key to our method is treating sequenced nucleotides as independent observations despite the fact that the true unit of sampling is the sequenced read. We show that the loss of information caused by this assumption is acceptable. We adapt the non-parametric empirical Bayes approach we developed previously for estimating library complexity (), which abstracts the sequencing process as a capturerecapture experiment. By applying our method to publicly available human single-cell sequencing data from a variety of sources and technologies, we demonstrate the method to be accurate and widely applicable. We then investigate practical considerations in applying the method, including methods to reduce the running time and ways to reduce the cost of initial experiments. Finally we apply our method to a broad swath of recent shallow single-cell sequencing experiments to show the variability of genome coverage for differing protocols.
DISCUSSIONWe described a method for predicting the genome coverage gained from deeper sequencing of a single-cell genome sequencing library based on a compound Poisson model of sequencing. By ignoring local dependence, we can approximate the number of bases covered by additional sequencing with a non-parametric empirical Bayes estimator. This estimator is extremely accurate for predicting additional coverage from relatively small amounts of additional sequencing but suffers from large instabilities for large amounts of additional sequencing. Applying rational function approximations removes the instability and allows us to make accurate long-range predictions. The running time of the algorithm may be unreasonably long for single base resolution estimates. To facilitate researchers in obtaining quick and accurate estimates, we introduced a strategy to reduce the running time of the algorithm significantly, with a small cost in accuracy, by randomly binning reads. By choosing the bin size, the researcher has the option to control how quickly estimates can be obtained, keeping in mind the trade-off of accuracy and variance. There is appreciable variability in genome coverage both for the deeply sequenced libraries and for the extrapolated lowcoverage libraries; this variability exists even for libraries originating in the same lab using the same protocol. In such cases our method can help for selection of the best libraries to sequence deep. This can help researchers in knowing the trade-off between sequencing depth and observed loci prior to committing resources for deep sequencing. This is particularly important for studies involving single nucleotide variation that require deep sequencing rather than broader variation such as copy number variation. One field where this is becoming increasingly important is full genome pre-implantation genetic diagnosis, which until recently was considered impossible due to technological constraints (). Finally, a major barrier to the development of new technologies or optimization of current protocols is the resources required to compare genome coverage across libraries. Naive use of shallow test sequencing runs to compare libraries is often misleading, as samples that initially appear to be high complexity may suffer from large locus dropout (Supplementary). The method we have presented can provide the information required for deep evaluation of libraries without deep sequencing. Though we presented our analysis to the problem of sequencing single human cells, the method is equally applicable to sequencing projects with a reference genome from low () or highly degraded (Pr  ufer et al., 2014) input, bacterial samples with a reference genome, or when mapping to a reference genome of a closely related species with unknown overlap ().