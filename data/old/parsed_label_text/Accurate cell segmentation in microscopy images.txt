Motivation: Identifying cells in an image (cell segmentation) is essential for quantitative single-cell biology via optical microscopy. Although a plethora of segmentation methods exists, accurate segmentation is challenging and usually requires problem-specific tailoring of algorithms. In addition, most current segmentation algorithms rely on a few basic approaches that use the gradient field of the image to detect cell boundaries. However, many microscopy protocols can generate images with characteristic intensity profiles at the cell membrane. This has not yet been algorithmically exploited to establish more general segmentation methods. Results: We present an automatic cell segmentation method that decodes the information across the cell membrane and guarantees optimal detection of the cell boundaries on a per-cell basis. Graph cuts account for the information of the cell boundaries through directional cross-correlations, and they automatically incorporate spatial constraints. The method accurately segments images of various cell types grown in dense cultures that are acquired with different micros-copy techniques. In quantitative benchmarks and comparisons with established methods on synthetic and real images, we demonstrate significantly improved segmentation performance despite cell-shape irregularity, cell-to-cell variability and image noise. As a proof of concept, we monitor the internalization of green fluorescent protein-tagged plasma membrane transporters in single yeast cells. Availability and implementation: Matlab code and examples are available at
INTRODUCTIONNowadays, optical microscopy is widely used to quantify singlecell features, such as cell size or intracellular densities of fluorescent markers. Accurate quantification of such features critically depends on the spatial detection of the cells in the image, that is, on cell segmentation (). Although there is a rapid development of imaging hardware and image analysis software platforms (), the development of cell segmentation algorithms is lagging behind. For good segmentation results, current approaches are typically applicable to narrowly defined image acquisition protocols () or cell types (). As summarized succintly by E. von Meijering: 'Rather than converging to a robust, unified solution, it thus seems that the field is diverging, and by now almost as many cell segmentation methods have been developed as there exist cell analysis problems. . .' (). Cell segmentation is challenging () for many reasons. First, segmenting cellular images requires the identification of multiple objects in the image. The objects have heterogeneous shapes that are typically subject to dynamic changes; mathematical shape models are therefore nearly impossible to define. Second, cell compartmentalization as well as intra-and intercell variability induces non-homogeneous marker distributions within and across cells, leading to undesirable image features such as intensity gradients. Third, growing cell populations usually result in dense cell regions; this makes it hard to assign image features to the correct cell, especially among sets of spatially close cells. Finally, different experimental configurations such as cell types or imaging protocols generate images with greatly varying morphological or intensity characteristics. Most current methods use a few basic algorithms for cell segmentation: intensity thresholding, filtering, morphological operations, region accumulation or deformable models (). In particular, region accumulation approaches such as Voronoi-based methods () or the watershed transform () can result in inaccurate cell boundaries by misspecifications of the cell region to be divided or by oversegmentation (and B). Similarly, popular deformable model approaches such as geodesic active contours (), which detect cell boundaries by minimizing a predefined energy functional, can result in poor boundary detection because they use local optimization algorithms that only guarantee to find a local minimum or use the gradient vector field of the image to decode the boundary information (). However, optical microscopy can generate distinctive intensity information across the cell membrane, which, so far, has been algorithmically used to only a small extent. For example, cell segmentation via ring filters () accounts crudely for the intensity profile across the cell membrane and imposes strict cell-shape requirements. Furthermore, certain combinatorial optimization algorithms can guarantee to find the global optimum of a defined energy functional, such as the combinatorial graph-cut algorithms. To segment microscopy images, previous *To whom correspondence should be addressed. y The authors wish it to be known that, in their opinion, the last two authors should be regarded as Joint Last Authors. applications of graph cuts in conjunction with the gradient vector field of the image () were limited to identify the image background () or to separate cell nuclei (). Graph cuts with automatic spatial constraints applied to the cellular segmentation of RNA interference (RNAi) screening images need an additional image (). Other graph-cut-based object detection approaches that do not use the gradient vector field of the image typically only work well when the intensity distributions of the cellular regions and the background are rather dissimilar (). Here, we present a method for cell segmentation that uses a single image, allows for image acquisition with different experimental techniques and copes with various cell shapes and densely populated areas. The method is based on the detection of membrane patterns, and we therefore term it membrane pattern-based cell segmentation (MPCS). The membrane pattern information is cast into a spatially constrained graph-cut framework, which allows us to address the typical challenges in the segmentation of microscopy images discussed above. We demonstrate the applicability and performance of MPCS for diverse synthetic and real biological examples, with significantly improved performance compared with established segmentation methods. Because accurate boundary detection is especially important in quantitative signaling studies, we quantify the internalization of plasma membrane transporters in yeast as a proof of concept.