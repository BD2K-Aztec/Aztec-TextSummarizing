It is difficult for current simulation tools to simulate sequence data in a pre-specified pedigree structure and pre-specified affection status. Previously, we developed a flexible tool, SeqSIMLA2, for simulating sequence data in either unrelated case-control or family samples with different disease and quantitative trait models. Here we extended the tool to efficiently simulate sequences with multiple disease sites in large pedigrees with a given disease status for each pedigree member, assuming that the disease prevalence is low. Availability and implementation: SeqSIMLA2_exact is implemented with Cþþ and is available at
IntroductionFamily studies based on next-generation sequencing (NGS) have become important in complex disease studies because a sufficient number of rare alleles that co-segregate with the disease can be observed in pedigrees (). To evaluate the statistical power for family-based disease studies using NGS, it is necessary to simulate sequencing data in a given family structure with disease status. Moreover, as multiple variants can contribute to the disease, it is crucial to simulate the joint effects of multiple variants on the disease. We searched the Genetic Simulation Resources website (), which provides a comprehensive catalog of simulation tools for genetics studies, and identified four tools, ForSIM (), Nemo (), simuPOP () and SeqSIMLA2 (), that can simulate sequence data in families with affection status. ForSIM, Nemo and simuPOP use forward-time algorithms, which dynamically determine pedigree structures during the simulation. Therefore, it may not be easy to obtain pre-specified pedigree structures from the simulation results. SeqSIMLA2 uses a genedropping algorithm to easily simulate pedigrees with pre-specified structures. However, it is very time consuming for the genedropping algorithm to simulate exactly the same affection status as the pre-specified status for every family member, particularly in large pedigrees and diseases with low prevalence. Another simulation tool, SimRare (), which shares some properties with SeqSIMLA2, can simulate multiple disease loci in sequence data; however, SimRare only simulates unrelated case-control data. In order to efficiently simulate genotypes conditional on the family structure and disease status, a retrospective likelihood, which is the probability of observing genotypes in each family member given the disease status, needs to be calculated. However, calculating the retrospective likelihood is typically based on computationally intensive algorithms such as ElstonStewart () and Markov Chain Monte Carlo (MCMC) algorithms. For example, tools such as FastSLINK (), SUP (), SimWalk2 () and MORGAN () have implemented or extended one of the aforementioned algorithms for simulating genotypes given the trait data. Due to the computational complexity, these tools can simulate only one disease locus. Moreover, although multiple markers not associated with the disease locus can be simulated, SimWalk2 and MORGAN assumeHere we extended SeqSIMLA2 to SeqSIMLA2_exact for simulating sequence data given the pedigree structures and disease status for all family members. When the disease prevalence is low, we show that the retrospective probability can be efficiently approximated without using computationally intensive algorithms.
DiscussionAn efficient algorithm to simulate sequence data given the family structure and affection status for every family member was developed and implemented. Our simulation results suggested that the tool properly simulated multiple disease variants with the desired odds ratios when the disease prevalence was less than 5%, which is the case for many complex diseases, such as schizophrenia, autism and age-related macular degeneration that have prevalences of 1.1%, 1.4% and 1.5% in Caucasians, respectively. As shown inand, the run time for SeqSIMLA2_ exact increased exponentially with either the number of disease loci or the number of recombination hotspots. This can be attributed to calculating the probabilities in Eqs. (3) and (4), which requires enumeration of all possible haplotypes for individuals who have not been simulated under all possible recombination patterns, and the number of possible haplotypes and the number of recombination patterns increase exponentially with the number of disease sites and recombination hotspots, respectively. However, these calculations are only required in the first batch of the simulations. The results can subsequently be saved in memory and used in the following batches of simulations. In our simulations, a logistic penetrance function was used to simulate multiple independent disease loci with additive effects on the disease. However, different disease models can also be simulated using SeqSIMLA2_exact. A penetrance table with penetrance functions for all possible combinations of genotypes at the disease sites can be provided to SeqSIMLA2_exact. These penetrance functions can be specified based on any type of disease model, including the incorporation of interacting loci. Moreover, different directions of effects of the disease loci can be simulated using the logistic penetrance function or the penetrance table. For example, specifying positive and negative values for the log odds ratios in the logistic penetrance function can simulate the risk and protective effects of the disease loci, respectively.At present, SeqSIMLA2_exact assumes that the affection statuses for all family members are given. To account for missing phenotypes, the probability in Eq. (1) can be extended to Ph; x u jx; c, where x u is a vector of the affection statuses of individuals whose affection statuses were not given. We hope to implement this function in SeqSIMLA2_exact in the near future. In conclusion, SeqSIMLA2_exact will be useful to simulate sequence data with multiple disease sites in large pedigrees when the disease prevalence is low. SeqSIMLA2_exact is implemented in SeqSIMLA2 with the-exact option, which is available from http:// seqsimla.sourceforge.net.persons' haplotypes such as h i (), each term in Eq. (A6) except the last term can be written as