Motivation: The accurate detection of copy number alterations (CNAs) in human genomes is important for understanding susceptibility to cancer and mechanisms of tumor progression. CNA detection in tumors from single nucleotide polymorphism (SNP) genotyping arrays is a challenging problem due to phenomena such as aneuploidy, stromal contamination, genomic waves and intra-tumor heterogeneity, issues that leading methods do not optimally address. Results: Here we introduce methods and software (PennCNV-tumor) for fast and accurate CNA detection using signal intensity data from SNP genotyping arrays. We estimate stromal contamination by applying a maximum likelihood approach over multiple discrete gen-omic intervals. By conditioning on signal intensity across the genome, our method accounts for both aneuploidy and genomic waves. Finally, our method uses a hidden Markov model to integrate multiple sources of information, including total and allele-specific signal intensity at each SNP, as well as physical maps to make posterior inferences of CNAs. Using real data from cancer cell-lines and patient tumors, we demonstrate substantial improvements in accuracy and computational efficiency compared with existing methods. Availability: Source code, documentation and example datasets are freely available at http://sourceforge.net/projects/penncnv-2.
INTRODUCTIONCopy number alterations (CNAs) refer to the copy number change of a chromosomal segment that is of somatic origin, often observed in tumor tissues (). In contrast to inherited copy number variants (CNVs) present in the germline, CNAs tend to be longer and occupy a significantly larger proportion of the genome. The recent application of single nucleotide polymorphism (SNP) genotyping arrays has led to the characterization of genomic aberrations associated with cancer development and prognosis (), and some studies have investigated CNAs in cancer cell lines () and tumor subtypes (). The comprehensive characterization of CNAs in cancer genomes is critical for understanding disease etiology and for advancing the development of targeted therapies for individual cancer patients (). A number of methods have been proposed to detect both CNVs and CNAs using SNP genotyping array-based technologies such as those from Affymetrix or Illumina. Compared with array-comparative genomic hybridization (CGH) platforms, which measure only the total intensity at each marker, SNP arrays report both the overall intensities of the probe hybridization reaction for each SNP, as well as the ratio of the intensities between the two alleles. Recent versions of high-density SNP arrays have incorporated non-polymorphic markers to better interrogate genomic regions for which SNP information is not adequate or not available. By leveraging signal intensity data from SNP arrays, statistical methods can measure both total copy number and allelic states with high resolution due to the high density of SNPs featured on these microarrays (typically ranging from 500 000 to 42.5 million markers across the genome). Dozens of computational algorithms have been developed for CNV detection on SNP arrays, and these methods have already been widely used in human genetics research (). However, the problem of CNA detection is considerably more difficult than CNV detection for several reasons. First, whereas germline CNVs can be inferred based on the assumption of a baseline copy number of two, calibration of the baseline in tumors is not obvious, as tumor cells may be aneuploid (i.e. have an abnormal number of chromosomes). A second complication, known as stromal contamination, arises from the fact that samples derived from malignant tissue are often contaminated with adjacent normal tissue. Simply modeling the copy number state of the tumors may lead to inaccurate estimates, as the true copy number state is distributed as a mixture of normal and one or more tumor cells populations. Third, intra-tumor heterogeneity is now appreciated as a common feature of cancer genomes (), and subpopulations of cancer cells may harbor distinct copy number changes. Fourth, although CNAs and CNVs can both be recurrent events, CNA boundaries may be more variable in a region across samples, so sensitivity may be an issue for CNA methods. Continuous time hidden Markov Models (HMMs) are traditionally favored for modeling the underlying state space (i.e. copy number and allelic state) for CNV/CNA *To whom correspondence should be addressed. inference, as they integrate over all parameters in the model, including the spatial relationship between SNPs along the genome, allowing one to obtain both point estimates and their confidence intervals for the parameters of interest. In the current study, we present an HMM-based solution to CNA detection that addresses each of the issues specific to tumor genomes. Because several previously published methods have also considered some of these complications, we compare these with our approach and highlight its advantages.
DISCUSSIONOver 10 software tools have now been published for identifying CNAs from SNP arrays. Most are based on HMMs, but several use segmentation algorithms. Our proposed algorithm uses SNP genotyping arrays to identify CNAs and estimate their magnitude in tumor samples, while accounting for intratumor heterogeneity, stromal contamination and aneuploidy. When compared against other popular methods, our approach performs comparably in terms of the detection and estimation of CNAs but shows marked improvements in the estimation of stromal contamination and runtime efficiency. Later in the text, we discuss the