Motivation: Alignment-free methods for sequence comparison are increasingly used for genome analysis and phylogeny reconstruction; they circumvent various difficulties of traditional alignment-based approaches. In particular, alignment-free methods are much faster than pairwise or multiple alignments. They are, however, less accurate than methods based on sequence alignment. Most alignment-free approaches work by comparing the word composition of sequences. A well-known problem with these methods is that neighbouring word matches are far from independent. Results: To reduce the statistical dependency between adjacent word matches, we propose to use spaced words, defined by patterns of match and dont care positions, for alignment-free sequence comparison. We describe a fast implementation of this approach using recursive hashing and bit operations, and we show that further improvements can be achieved by using multiple patterns instead of single patterns. To evaluate our approach, we use spaced-word frequencies as a basis for fast phylogeny reconstruction. Using real-world and simulated sequence data, we demonstrate that our multiple-pattern approach produces better phylogenies than approaches relying on contiguous words. Availability and implementation: Our program is freely available at
INTRODUCTIONTraditional methods for comparative sequence analysis and phylogeny reconstruction rely on pairwise and multiple sequence alignments (). A major problem with these methods is that they are relatively slow because aligning two sequences takes time proportional to the product of their lengths. With the huge amount of sequence data that are produced by new sequencing technologies, faster methods for sequence comparison are required. Alignment-free methods became popular in recent years, as their runtime is usually proportional to the total sequence length; see Vinga and Almeida (2003) for a review. Alignment-free methods are increasingly used for genome comparison, in particular for genome-based phylogeny reconstruction (), but also for fast protein clustering (). These approaches are not only much faster than conventional alignment-based methods, but they also overcome some notorious difficulties in phylogenomics, such as finding ortholog genes () or aligning large genomic sequences (). Other advantages of alignment-free genome comparison are that they can work with unassembled reads () and are not affected by genome rearrangements. Alignment-free methods are also used to construct guide trees for progressive multiple alignment (). This could crucially improve the runtime of multiple-alignment algorithms, as calculating guide trees becomes the most timeconsuming step in progressive alignment if the number of sequences grows. Most alignment-free methods are based on word frequencies. For a fixed word length k, they calculate a (relative) wordfrequency vector for each of the input sequences. Various distance measures on vector spaces can be used to calculate a pairwise distance matrix from these word-frequency vectors (). Phylogenetic trees can then be calculated from these distance matrices with standard methods such as UPGMA () or NeighbourJoining (). Other alignment-free approaches define the local context of sequence positions in terms of overlapping words containing a position (). Some methods do not rely on a fixed word length k but allow for matches of variable length (). A common feature of all these methods is, however, that they are based on exact word matches between the input sequences. Database searching is another traditional application of word matching in sequence analysis. Fast local alignment programs such as BLAST () originally relied on identifying word matches of a fixed length, so-called seeds. Rapid indexing methods can be used to identify such 'seeds', *To whom correspondence should be addressed.  The Author 2014. Published by Oxford University Press. This is an Open Access article distributed under the terms of the Creative Commons Attribution License (http://creativecommons.org/licenses/by/3.0/), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited. while, in a second phase of the algorithm, seeds are extended into both directions to find statistically relevant high-scoring segment pairs. In a pioneering paper,proposed to use spaced seeds instead of contiguous-word matches as a first step in homology searching. Here, a fixed pattern or 'mask' of match and don't care positions is defined, and two words of the corresponding length are considered to match if they coincide at the specified match positions, while mismatches are allowed at the don't care positions. An obvious advantage of this approach is that word matches at nearby positions are statistically less dependent on each other than contiguous-word matches are. Also spaced seeds are better able to identify homologue sequence regions in the presence of mismatches. Ma et al. showed that spaced seeds are superior to contiguous-word matches in terms of sensitivity and speed; see also Brown (2008) for an overview. Recently, we proposed to use spaced words, defined by patterns of match and don't care positions, as a basis for alignment-free sequence comparison (). Instead of using spaced-word matches to trigger local alignments, we compare the spaced-word composition of sequences to define a measure of global similarity between them. In the present article, we describe an efficient algorithm based on recursive hashing and bit operations to calculate and compare spaced-word frequencies and we extend our approach to distance measures defined by multiple patterns. We use these distance measures to construct phylogenetic trees for real-world and simulated DNA and protein sequence families, and we compare our method to established alignment-free methods using contiguous-word frequencies, as well as to a traditional alignment-based approach. Our results show that, for phylogeny reconstruction, spaced words based on multiple patterns are superior to existing alignment-free methods that rely on contiguous words. A user-friendly web interface for our program is described by).
DISCUSSIONAlignment-free methods are regularly used to estimate evolutionary distances between DNA and protein sequences and to construct phylogenetic trees. Most of these methods are based on word frequencies. Such approaches are usually less accurate than traditional phylogeny approaches that are based on multiple sequence alignments, but they are much faster. While aligning two sequences takes time proportional to the product of their lengths (), word frequencies can be calculated in linear time. A certain disadvantage of word-based methods is the fact that word occurrences at neighbouring sequence positions are far from independent. For this reason, some authors proposed to correct word statistics by taking overlapping word matches into account (Goke). In database searching, word matches have been replaced by so-called spaced seeds where string matches according to a nonperiodic pattern P of match and don't care positions are used (). Motivated by this approach, we proposed to use spaced words instead of the traditionally used contiguous words to estimate distances between sequences and to construct phylogenetic trees. While, under an i.i.d. sequence model, the expected number of occurrences of a spaced word is approximately the same as for the corresponding contiguous word (obtained by removing the don't care positions), spaced-word. Test results on simulated protein sequences; the spaced-word approach was used with a pattern weight of k  4. Notation as inFig. 7. Influence of the number of patterns on the results of Spaced words applied to a set of 125 simulated protein sequences of length 300 aa, generated with Rose. Sets P of patterns generated as in. Note that for short pattern lengths ', the set of all possible patterns is limited, so for '  9 and 14, only small values of m could be tested. Influence of the number of patterns on the results of our multiplepattern approach. The program was run on a set of 50 simulated DNA sequences of length 16 000 nt each, generated with Rose. For k  8, different values of ' and m  10,20,. .. ,150, we generated 100 sets P of patterns each, every set P containing m patterns. The quality of the produced trees, measured as the average RF distance of the 100 trees to the respective reference trees, is plotted against m