Motivation: Dynamic simulations of systems with biologically relevant sizes and time scales are critical for understanding macromolecular functioning. Coarse-grained representations combined with normal mode analysis (NMA) have been established as an alternative to atomistic simulations. The versatility and efficiency of current approaches normally based on Cartesian coordinates can be greatly enhanced with internal coordinates (IC). Results: Here, we present a new versatile tool chest to explore conformational flexibility of both protein and nucleic acid structures using NMA in IC. Consideration of dihedral angles as variables reduces the computational cost and non-physical distortions of classical Cartesian NMA methods. Our proposed framework operates at different coarse-grained levels and offers an efficient framework to conduct NMA-based conformational studies, including standard vibrational analysis, Monte-Carlo simulations or pathway exploration. Examples of these approaches are shown to demonstrate its applicability, robustness and efficiency.
INTRODUCTIONDynamic simulations of large molecules long enough to observe functional changes are challenging. Normal mode analysis (NMA) merged with coarse-grained (CG) models has proven to be a powerful and popular alternative to simulate collective motions of macromolecular complexes at extended timescales (). The CG-NMA application range includes: the prediction of biologically relevant motions of proteins and nucleic acids (), even with low-resolution structures (); X-ray refinement (); protein and ligand docking (); flexible fitting of atomic structures into electron microscopy density maps (); efficient generation of conformational pathways (); and identification * To whom correspondence should be addressed. of conserved dynamic patterns within protein families (). NMA describes the relevant collective motions based on the harmonic approximation around a local minimum, which allows for solving the Lagrangian equations of motion by diagonalizing the Hessian and kinetic energy matrices. The resulting eigenvectors are a set of orthogonal displacements or normal modes. The high-frequency modes represent localized displacements, whereas low-energy modes correspond to collective conformational changes. These collective motions are closely related to functional motions () and they have been correlated with essential motions extracted from molecular simulations (). These results and many others validate the use of NMA and CG modeling to describe molecular flexibility, serving as a powerful alternative to costly atomistic simulations. For relatively large systems, the main bottleneck of NMA is the diagonalization step that can easily go beyond standard computers. The vast majority of current NMA approaches have adopted Cartesian coordinates (CC) as variables. However, internal coordinate (IC) method requires at least one-third less degrees of freedom (DoF) and hence reduces both computational time and memory usage. Moreover, in CC the covalent bonding geometry is not implicitly preserved, thus allowing potential non-physical geometrical distortions. The mathematical simplicity (e.g. kinetic energy matrix is reduced to the identity) and its straightforward implementation are behind the CC preference. Nevertheless, several exceptions have shown the IC potential rewards. Early work by Go and others () led to the development of a complete mathematical framework using dihedral angles. This full atomic approximation has been extended to include even bond stretching and angle bending (). ProMode is a full-atom NMA repository where users can only explore pre-computed results of 3000 proteins (). The integration of CG approximations with IC also has been successfully explored. Pioneering work by Tirion with elastic network models in IC () has been continued by others (). However, the scope of these approaches is mainly theoretical and none of them are accessible as functional tool. Here, we present a new multipurpose tool chest, named iMod, to exploit the benefits of classical NMA formulations in IC while extending them to cover multiscale modeling. Ordinary torsion angles are maintained as variables, whereas different graining levels were incorporated to represent protein structure (e.g. with only  carbons). These atomic models can be easily combined with several elastic networks in a highly customizable framework, including user-defined potential or the immobilization of parts of the macromolecular system by removing their dihedral angle variables. iMod has been designed to be versatile and can handle also multiple chains, nucleic acids and rigid ligands. The versatility and efficiency of this new integrative framework expand the applicability range of NMA especially to very large systems. Here, we show its robustness describing several representative conformational transitions. We also illustrate its applicability in two simulation contexts: conformational sampling and pathway trajectory generation.