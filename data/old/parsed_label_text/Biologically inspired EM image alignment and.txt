Motivation: Three-dimensional reconstruction of consecutive serial-section transmission electron microscopy (ssTEM) images of neural tissue currently requires many hours of manual tracing and annotation. Several computational techniques have already been applied to ssTEM images to facilitate 3D reconstruction and ease this burden. Results: Here, we present an alternative computational approach for ssTEM image analysis. We have used biologically inspired receptive fields as a basis for a ridge detection algorithm to identify cell membranes, synaptic contacts and mitochondria. Detected line segments are used to improve alignment between consecutive images and we have joined small segments of membrane into cell surfaces using a dynamic programming algorithm similar to the Needleman–Wunsch and Smith–Waterman DNA sequence alignment procedures. A shortest path-based approach has been used to close edges and achieve image segmentation. Partial reconstructions were automatically generated and used as a basis for semi-automatic reconstruction of neural tissue. The accuracy of partial reconstructions was evaluated and 96% of membrane could be identified at the cost of 13% false positive detections.
INTRODUCTIONSerial-section transmission electron microscopy (ssTEM) can produce reconstructions of neuronal morphology at very high resolution, including synaptic organelles and the contacts between neurons that constitute circuits. Alignment and reconstruction of ssTEM images is currently performed manually or semiautomatically, with the aid of computer software, to generate a 3D model of the imaged neuron and, with other such neurons, of the synaptic circuits to which that neuron contributes (). In some * To whom correspondence should be addressed. cases, approximate alignment can be achieved automatically but, even so, high-quality circuit reconstructions still require many hours of manual tracing and annotation, and are highly dependent upon the interpretative skill of the human observer and the complexity of neuronal arborizations being reconstructed (). For example, neurites are simple and have been completely reconstructed by manual means in the nematode Caenorhabditis elegans () but are complex, highly branched and reconstructed only with great difficulty or incompletely in the fruit fly Drosophila melanogaster (). Existing methods of image alignment usually rely on a control point selection method. Semi-automatic alignment can be carried out by identifying control points manually and aligning these by means of a particular algorithm (). Automatic alignment can be carried out with control point detection algorithms (), and works best when image quality is consistent throughout the dataset, but performance can be degraded when artefacts such as gaps, noise, differing levels of brightness and/or contrast are present in the images being aligned. Such artefacts are unfortunately fairly common in ssTEM because of the complicated preparative procedures and increase as the series of images becomes longer. Most currently used systems for automatically annotating electron microscopy (EM) data rely on some variant of the watershed algorithm to detect boundaries between cells (). This method usually results in oversegmentation, and several methods have been identified to reunite incorrectly over-segmented areas after the watershed algorithm is run (). A commonly used method to detect membrane present in an image is to pre-process the image by a Gaussian blur combined with image derivative or Hessian matrix analysis. Also called Gaussian smoothed Hessian (GSH), this method is effective at filtering out noise while retaining membrane edges in the image (). Random forest classifiers have also been used to successfully combine outputs from a range of generic feature detectors (). GSH, and other generic feature detectors, are efficient to implement and make reasonable assumptions when membrane profiles are Gaussian, but when line profiles are predictable the construction of a specific filter may improve performance (). For this reason, we have customized a set of receptive fields to specific features visible in EM images.Page: 2217 22162223). Four categories have been annotated: sharp membranes that pass vertically through the section thickness (a), blurred images of obliquely sectioned membrane (b), synaptic profiles (c) and mitochondria (d). Each image patch is 227227 nm.
DISCUSSIONWe have presented a set of computational methods for EM image alignment and reconstruction, based on a set of receptive fields learnt from EM image data. The identification of many control points for aligning consecutive images can improve upon manual alignment methods and is robust to many types of noise encountered in EM images. Closing edges based on a shortest path algorithm can also achieve a full segmentation of images and additional receptive fields can be used to identify the profiles of synapses and other organelles present in ssTEM images. The ridge detection approach is complementary to existing regional or watershed-based methods, and achieves similar or superior results. Aligning points of membrane by the dynamic programming algorithm is also complementary to existing control point-based alignment methods and can improve upon these in some cases, especially at places where areas of noise or imaging artefacts affect control point properties. An open-source reference implementation of the ridge detection and alignment algorithms is available for download in Dataset S2. The manual alignment and segmentation of detailed ssTEM images is very time consuming, but information on synaptic connections obtained by these means is essential for research in systems neuroscience (). This reawakened need has recently received renewed recognition, identified in the recently designated field of connectomics (). Inspired by the example of tools used in biology for molecular alignment, the set of methods we report for improved alignment and detection of membrane is able to assist in the time-consuming process of manual annotation. Further information about likely membrane locations is also available from consecutive images in the stack. Areas where membrane alignment is poor between two images in the z-axis may indicate a false positive or false negative identification in either image. Utilization of this additional information and further improvements in both image processing techniques and image quality will help lead to the complete automation of neuronal reconstruction in 3D, and the complete identification and definition of circuits constituted by such reconstructed neurons. Approaches to image analysis based on receptive fields are inspired by research into the visual systems especially of mammals () and insects (O'), in which visual interneurons have been shown to respond to bars, lines or edges. That area of vision research is under constant evaluation, and advances in it can lead to improved accuracy for segmentation and feature detection. Future avenues of research include identifying additional useful receptive field types and combining outputs from different receptive fields into a layered system for more accurate detection of cell membranes and other organelles. Applying these techniques to ssTEM data offers for the future an improved understanding not only of visual systems but in turn also a further improvement of such computational techniques.