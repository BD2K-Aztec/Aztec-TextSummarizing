Motivation: To recognize remote relationships between RNA molecules, one must be able to align structures without regard to sequence similarity. We have implemented a method, which is swift [O(n 2)], sensitive and tolerant of large gaps and insertions. Molecules are broken into overlapping fragments, which are characterized by their memberships in a probabilistic classification based on local geometry and H-bonding descriptors. This leads to a probabilistic similarity measure that is used in a conventional dynamic programming method. Results: Examples are given of database searching, the detection of structural similarities, which would not be found using sequence based methods, and comparisons with a previously published approach. Availability and implementation: Source code (C and perl) and bin-aries for linux are freely available at www.zbh.uni-hamburg.de/
INTRODUCTIONRNA has diverse roles ranging from ligand binding/recognition to catalysis. These functions depend not just on sequence, but more on how a molecule positions groups in space (;). This means that if one wants to detect functional similarity, one must be able to align molecules structurally. We present a method for RNA-structure alignment, which seems to be sensitive, reliable and with a running time comparable with sequence alignment techniques. One could also claim that in evolutionary terms, structure is more conserved than sequence; therefore, structural searches and alignments will find relationships that would be missed at the sequence level (). If one allows for gaps and insertions, the problem of structurally aligning two biopolymers is NP-complete (). There is, however, an abundance of methods developed for proteins using various approximations that usually provide reasonable results (;). Typically, these methods rely on some structural property specific to proteins. For example, most proteins can be reasonably characterized by their classic secondary structure elements or their sequence of backbone ', angles or a contact map based on C atoms. In the case of RNA, there is far less prior art, presumably because it is harder to describe, and there is little consensus as to what constitutes a characteristic structural motif. In proteins, common structures are rather well described by neglecting the backbone ! dihedral angle and considering ', , perhaps with additional hydrogen bond information. In RNA, one could consider six backbone angles (,and perhaps the dihedral angle, which captures the orientation of the base. At the same time, not all these descriptors are necessary, as some of the angles are significantly correlated (). Duarte and Pyle took advantage of this fact and pointed out that it may be more effective to define dihedral angles based on atoms such as C4 0 and P atoms from successive bases even though they are not covalently connected (). Using these angles as descriptors, they defined 10 structural motifs with which they were able to reconstruct known RNA structures with surprisingly high accuracy. These descriptors also seemed to be sufficient for finding motifs in collections of known structures (). Although there are methods for aligning RNA based on secondary structures (), there is a distinct paucity of methods that use 3D properties. The approach implemented in ARTS uses the coordinates of phosphorus atoms and attempts to find and extend sets of atom pairs, which can be superimposed below some threshold (). The alignment calculation relies on the recognition of secondary structure elements. This means the method implicitly has some thresholds, but it has the advantage that the procedure is apparently fast enough to be used for searches of a structure against a database of known structures. Another approach is to label sites with some structural property or combined sequence/structure property. Sites from different molecules can be compared with each other giving a score, which can be used in a conventional dynamic programming algorithm. DIAL uses this approach and bases its score on sequence, nine dihedral angles and a measure *To whom correspondence should be addressed. of base pairing (). SARSA, by, used four dihedral angles to define a small structural alphabet. This approach was revisited in iPARTS (), with a similar structural alphabet limited to the pseudotorsion angles and as defined by Duarte and Pyle (1998). SARA () follows an approach inspired by the MAMMOTH programme for protein structure alignment (). The most recent approach, SETTER, divides RNA structures into non-overlapping secondary structure elements (). All of these methods are sensitive to the geometry of specific sites rather than larger pieces of structure. In this work, we have adapted a method from the protein literature, but one with little preconception as to what constitutes a structural motif (). Instead, one says that a structure is built from overlapping fragments of some length (k  5 in this work). Each fragment is described by a set of structural descriptors (angles, distances and a measure of likelihood to be in a base pair). A large set of fragments from the protein data bank (PDB) () was then subjected to a maximally parsimonious Bayesian classification yielding $10 2 classes. To use this for alignments, one can take a fragment from a new molecule and calculate the probability that it is in class 1, 2,.. ., N class. This vector of probabilities can be seen as a structural label for the site, but more importantly, the dot product of two such vectors is a direct measure of their similarity. These dot products can be used directly in a score matrix for a dynamic programming algorithm. The similarity measure is a continuous property ranging from 0 to 1; therefore, no thresholds are necessary. Calculating an optimal alignment has O(n 2 ) running time albeit with a larger pre-factor than in sequence alignments. As we show below, the method seems to produce rather high quality alignments.
DISCUSSIONBecause the structural alignment of biopolymers is fundamentally NP complete (), all methods use heuristics and approximations. The method in this work might be closest to those which rely on some kind of structural alphabet to label fragments. However, the method here is different in the type of labelling used. Firstly, each site in the chain is influenced by all overlapping fragments. This means that each pair of aligned residues reflects a region of nine bases. Next, the labels come from an unsupervised learning approach (); thus, there are few preconceptions as to what constitutes a structural element. This is a major difference compared with RNA secondary-structure aligners (locaRNA, RNAforrester), which cannot take advantage of other common structural motifs. Most importantly, the labels are not discrete as in a typical) or the much smaller alphabet (paired/unpaired) used by RNA secondary-structure aligners. In this work, the product of the probability vectors] leads to a smooth measure of similarity; therefore, the method works when confronted with a completely new structural element. One should also note that the classification of fragments is certainly not optimal and need not be. It must only serve to provide a fingerprint for recognizing similarity. This can be seen by a simple numerical argument. Imagine a class in the classification was incorrectly split into two classes, and a calculation is then faced with a fragment, which fits perfectly into this class. The calculated probability vector would have two entries with values of 0.5. When compared with a similar vector, the dot product would still be near 1.0. These might be technical aspects only relevant to this method, but there is a general technical problem with this kind of approach. Ultimately, most methods are based on some choice of atoms and structural properties. The classic statistical mixture model used in this work does impose one important restriction. It must be possible to approximate the distributions of the descriptors by the sums of simple distributions. For example, the quasi-electrostatic score of Equation (3) would not be a good model for physics, but it yields relatively well-separated sets for H-bonded and not H-bonded sites. Similarly, the distances and angles used here fit better to Gaussian distributions than examples from the literature (). It is also worth noting that the choice of descriptors can have a large influence on the kind of alignments generated. Most of the methods working with RNA structures are dominated or begin with local structural properties. In contrast, our method included a contribution from H-bonding, which is a distinctly non-local property in terms of sequence. This means that Equation (3) will yield a good score for local similarity, but there is a preference to align H-bonded sites with H-bonded sites and vice versa. One could also say that in an alignment calculation, one never requires a perfect match, and an optimal alignment may involve many less than optimal local matches. The underlying classification is entirely automatic and, although not perfect, a model for the most important features of RNA structure (given a set of descriptors). One could, for example, interpret the most populated classes in structural terms. Looking at, one would say that the single most common motif is a helix with well-described angles, but one can statistically justify splitting it into two classes based on H-bonding probability. The third class is also similar but is characterized by one particular distance and a particular value at one site. The results in this work highlight the ability to find remote structural similarities, but the comparisons suffer from a typical problem. It is often difficult to claim one alignment is better than another. Method 1 may truncate alignments and return results with a small rmsd value (structural similarity), whereas method 2 returns longer alignments, which will appear to have a larger rmsd value. It is completely arbitrary which method one prefers. The results do, however, suggest that our proposal often finds rather long alignments without a great cost in rmsd values. This is also related to a second problem. When searching a database for related structures, there are several reasonable ways to rank the hits. A navenave structural measure such as rmsd will certainly retrieve similar structures, but these will penalize longer and more interesting alignments. One can invent similarity measures based on multiple factors, although these will entail decisions as to the importance of different properties. When comparing methods, one can also see some differences in principle. If a method tries to optimize rmsd values, it will be sensitive to hinge movements within structures. In our approach, rmsd values are only calculated for comparisons. This means that the results are tolerant of hinge movements and, in particular, one has no problem with alignments in large structures such as ribosomes. To make comparison with literature methods easiest, the results here were based on Smith and Waterman (1981) style alignments, which emphasize core regions of similarity. Should one want to force globally optimal alignments, it is only a switch to choose Needleman and Wunsch (1970) style alignments. If one is interested in extending the method, there are a number of possibilities. The classification used here was based on fragments of length k  5. It is possible that one would capture more structural information with longer fragments, but the classification time does become prohibitively expensive. One should, in principle update the classification, as more structures become available. This can do no harm but will only make a difference with exotic and uncommon pieces of structure. At the moment, the largest 25 classes account for most of the probability density. If one doubled the amount of data, this would lead to a slightly better statistical model for the less commonly seen fragments. One could also say that the dataset used for the classification is biased. It includes too many tRNA structures because there are. Superposition of 1p5m and 1p5p based on alignment generated by RNAforester, rmsd of 13.4 A  (a) and locaRNA, rmsd of 3.1 A  (b). The structure alignment obtained from FRIEs is shown inso many structures in the PDB. It includes too many bases from ribosomes because ribosome structures are so large. If one removed these biases, it would change the prior probabilities associated with each class and yield a classification that was in some chemical sense better. It would not make a great deal of difference in this application where the aim is simply to apply unique labels to structural fragments. A more interesting extension would be to combine sequence and structure information. Statistically, this means one uses a multi-way Bernoulli description for the probability of base types at each site. This is technically possible and has been tested on proteins (), but it does raise a question that is difficult to answer. One is usually dealing with cases where sequence similarity is so small, that one has to use structural alignments. In this regime, it is not clear as to whether adding sequence information adds more noise or more information. Finally, one must make the obvious concession. Structurebased alignments can only complement sequence-based methods, as they can only be applied to the fraction of RNAs for which a structure has been determined. The method presented here seems to be swift, sensitive to remote similarities and capable of producing accurate structural alignments of RNA structures. The code is available for download and should prove useful as more RNA structures enter the databases and one is interested in remote relationships. Conflict of Interest: none declared.