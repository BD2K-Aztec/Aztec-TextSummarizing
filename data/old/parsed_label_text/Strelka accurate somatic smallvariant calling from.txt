Motivation: Whole genome and exome sequencing of matched tumor–normal sample pairs is becoming routine in cancer research. The consequent increased demand for somatic variant analysis of paired samples requires methods specialized to model this problem so as to sensitively call variants at any practical level of tumor impurity. Results: We describe Strelka, a method for somatic SNV and small indel detection from sequencing data of matched tumor– normal samples. The method uses a novel Bayesian approach which represents continuous allele frequencies for both tumor and normal samples, while leveraging the expected genotype structure of the normal. This is achieved by representing the normal sample as a mixture of germline variation with noise, and representing the tumor sample as a mixture of the normal sample with somatic variation. A natural consequence of the model structure is that sensitivity can be maintained at high tumor impurity without requiring purity estimates. We demonstrate that the method has superior accuracy and sensitivity on impure samples compared with approaches based on either diploid genotype likelihoods or general allele-frequency tests. Availability: The Strelka workflow source code is available at ftp://strelka@ftp.
INTRODUCTIONDriven by declining sequencing costs, human tumor sequencing has recently progressed from surveys of selected coding regions () to entire genomes (), and onwards to increasingly routine genome and exome sequencing of diverse tumor samples (). A principal goal of such experiments is the identification of somatic variants arising in the tumor, typically by comparing the tumor sequence to that of a matched normal sample. The increasing number of such paired tumornormal sequencing experiments has put greater demand on the accuracy and efficiency of somatic variant * To whom correspondence should be addressed. calling methods, particularly for SNVs and small indels where the number of somatic variants can easily overwhelm manual review. An additional challenge for somatic variant calling on matched tumor normal samples is robust handling of impurity and copy-number variation in the tumor sample, ideally without requiring external purity estimates. The somatic variant calling problem addressed in this study requires the identification of alleles in a tumor which do not occur in the host's germline. This apparently simple process is confounded by at least two factors. The first is that germline variants can outnumber somatic variants by several orders of magnitude [e.g., so any tendency to mistake germline variation as somatic can substantially contaminate the somatic variant predictions. A second complicating factor is variability in the somatic allele frequencies due to the presence of normal cells in the tumor sample, copy number variation and tumor heterogeneity. In earlier work somatic variants have been detected by independently genotyping both samples and subtracting the results, an approach which can provide reasonable predictions for cell lines because the aforementioned variability in somatic allele frequency is reduced for this case. For the general case, a joint analysis of both samples should improve results by facilitating tests for candidate somatic alleles in both samples (especially important for indels) and enabling better representation of sequencing noise and tumor impurity. Two prevalent approaches to joint sample analysis are (i) to use joint diploid genotype likelihoods for both samples and (ii) to disregard such genotype structure and test whether a shared allele frequency between the two samples can be rejected. An implementation of the first approach is available in the SomaticSniper package (), whereas the second approach is implemented in VarScan, which applies Fisher's exact test to the sample allele frequencies (). Note that these approaches to joint sample analysis stand in contrast to solutions addressing the related problem of independent tumor sample analysis, such as in SNVMix (), although both cases share the challenge of non-diploid tumor allele frequencies. In this study we describe Strelka, a somatic variant detection workflow designed to accurately and efficiently identify somatic SNVs and small indels from aligned sequencing reads of matched tumornormal samples. Strelka is based on a novel Bayesian approach wherein the tumor and normal allele frequencies are treated as continuous values, with the normal sample represented as a mixture of diploid germline variation with noise, and the tumorsample represented as a mixture of the normal sample with somatic variation. Beyond the core modeling scheme, the Strelka workflow is designed to improve accuracy by jointly performing indel search and read realignment in the context of both samples. The model is structured to account for any level of allele frequency variation in the tumor sample without requiring purity estimates. We test Strelka's somatic variant predictions together with alternate calling approaches to estimate accuracy and sensitivity on a tumor cell line and a mixture of tumor cell line and normal sequences designed to simulate an impure tumor sample. This analysis suggests that Strelka's results are comparable to or better than existing methods for both somatic SNV and indel prediction on the pure cell line, while demonstrating Strelka's distinguishing characteristic, per its design, of robust call sensitivity on the lowpurity sample. Strelka is designed for production use on very large sample sets, and thus achieves these results as a single workflow with reasonable computational efficiency: for the largest dataset analyzed in this study the method completes somatic variant analysis in 81 core-hours given roughly 180-fold human genome sequencing coverage from the combined tumor and normal samples.
DISCUSSIONIn the above analysis we demonstrate that the somatic calls made by Strelka (i) have a low fraction of population variants and thus are likely to contain few erroneous germline calls; (ii) are infrequent when the method is used to compare a normal sample against itself; and (iii) retain high sensitivity when the tumor sample is impure. We note that all Strelka results presented in this study use the same model and filtration parameters, and per Strelka's design the model parameters need not be adjusted based on the tumor or normal sequencing depth or expected tumor purity. The alternate methods we examine represent two families of somatic variant calling approaches, each of which has advantages and drawbacks compared with Strelka's. Methods which use a diploid genotype likelihood for both tumor and normal samples should perform well on high-purity samples. This is evident for SomaticSniper, which makes very few spurious somatic calls when run against a normal replicate sample. Any remaining performance differences on cell line data may be an artifact of using the ELAND read mapper and Strelka's extra post-call filtration steps. SomaticSniper is also extremely efficient, completing analyses in approximately one seventh of the time required by Strelka. The principal cost of this approach is apparent when testing sensitivity on low purity data, in which case SomaticSniper shows the greatest reduction in sensitivity between the impure and pure test data. The approach of applying a general statisical test against the tumor and normal allele frequencies, as implemented in VarScan, has the significant advantage of being robust to a variety of sample conditions such as contamination or alternate ploidy in the normal sample. An analogous approach using a uniform allele frequency prior for the normal sample was attempted in Strelka, but not pursued due to a relative lack of power in situations where the current model assumptions hold. This trend is also evident in the VarScan results showing that tumor purity has a relatively high impact on somatic call sensitivity. Nonetheless, the generality of VarScan's approach is a great advantage for many sample subtraction problems. Although not applied in this study, Strelka is designed to optionally accept contigs from a local de-novo assembly routine to enable detection of longer somatic indels and open breakends. Items for future work include extending the model to represent normal sample contamination and integrating the post-call filtration terms with the current somatic quality score. The latter improvement has recently been demonstrated for single-sample variant calls using a machine learning approach (), and would enable call selection based on a single score representing both the core somatic call probability and post-call filtration terms, improving selection of low-stringency variant calls.