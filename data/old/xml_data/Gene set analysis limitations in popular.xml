
<?xml version="1.0" encoding="UTF-8"?>
<TEI xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 /home/joey/Project/grobid/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<encodingDesc>
			<appInfo>
				<application version="0.4.2-SNAPSHOT" ident="GROBID" when="2017-08-10T23:41+0000">
					<ref target="https://github.com/kermitt2/grobid">GROBID - A machine learning software for extracting information from scholarly documents</ref>
				</application>
			</appInfo>
		</encodingDesc>
		<fileDesc>
			<titleStmt>
				<title level="a" type="main">Gene expression Gene set analysis: limitations in popular existing methods and proposed improvements</title>
			</titleStmt>
			<publicationStmt>
				<publisher/>
				<availability status="unknown"><licence/></availability>
				<date type="published" when="2014">19 2014</date>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author>
							<persName>
								<forename type="first">Pashupati</forename>
								<surname>Mishra</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department">Institute of Biotechnology</orgName>
								<orgName type="institution">University of Helsinki</orgName>
								<address>
									<settlement>Helsinki</settlement>
									<country key="FI">Finland</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Petri</forename>
								<forename type="middle">T</forename>
							</persName>
						</author>
						<author>
							<persName>
								<forename type="first">€</forename>
								<surname>Onen</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department">Institute of Biotechnology</orgName>
								<orgName type="institution">University of Helsinki</orgName>
								<address>
									<settlement>Helsinki</settlement>
									<country key="FI">Finland</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">€</forename>
								<forename type="middle">O</forename>
								<surname>Leino</surname>
							</persName>
							<affiliation key="aff1">
								<orgName type="institution">CSC -IT Center for Science, Ltd</orgName>
								<address>
									<settlement>Espoo</settlement>
									<country key="FI">Finland</country>
								</address>
							</affiliation>
							<affiliation key="aff2">
								<orgName type="institution">Associate Editor: Inanc Birol</orgName>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Liisa</forename>
								<surname>Holm</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department">Institute of Biotechnology</orgName>
								<orgName type="institution">University of Helsinki</orgName>
								<address>
									<settlement>Helsinki</settlement>
									<country key="FI">Finland</country>
								</address>
							</affiliation>
						</author>
						<title level="a" type="main">Gene expression Gene set analysis: limitations in popular existing methods and proposed improvements</title>
					</analytic>
					<monogr>
						<imprint>
							<biblScope unit="volume">30</biblScope>
							<biblScope unit="page" from="2747" to="2756"/>
							<date type="published" when="2014">19 2014</date>
						</imprint>
					</monogr>
					<idno type="DOI">10.1093/bioinformatics/btu374</idno>
					<note type="submission">Advance Access publication June 5, 2014 Received on November 19, 2013; revised on May 22, 2014; accepted on May 30, 2014</note>
					<note>BIOINFORMATICS ORIGINAL PAPER</note>
				</biblStruct>
			</sourceDesc>
		</fileDesc>
		<profileDesc>
			<abstract>
				<p>Motivation: Gene set analysis is the analysis of a set of genes that collectively contribute to a biological process. Most popular gene set analysis methods are based on empirical P-value that requires large number of permutations. Despite numerous gene set analysis methods developed in the past decade, the most popular methods still suffer from serious limitations. Results: We present a gene set analysis method (mGSZ) based on Gene Set Z-scoring function (GSZ) and asymptotic P-values. Asymptotic P-value calculation requires fewer permutations, and thus speeds up the gene set analysis process. We compare the GSZ-scoring function with seven popular gene set scoring functions and show that GSZ stands out as the best scoring function. In addition , we show improved performance of the GSA method when the max-mean statistics is replaced by the GSZ scoring function. We demonstrate the importance of both gene and sample permutations by showing the consequences in the absence of one or the other. A comparison of asymptotic and empirical methods of P-value estimation demonstrates a clear advantage of asymptotic P-value over empirical P-value. We show that mGSZ outperforms the state-of-the-art methods based on two different evaluations. We compared mGSZ results with permutation and rotation tests and show that rotation does not improve our asymptotic P-values. We also propose well-known asymptotic distribution models for three of the compared methods. Availability and implementation: mGSZ is available as R package from cran.r-project.org. Contact: pashupati.mishra@helsinki.fi Supplementary information: Available at</p>
			</abstract>
		</profileDesc>
	</teiHeader>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1">INTRODUCTION</head><p>Inferring biological pathways from high-throughput gene expression datasets that are altered in a biological or a medical test is one of the major challenges in biosciences. The analysis of gene sets instead of individual genes results in significant reduction of noise and dimension and in greater biological interpretability. Furthermore, it enhances the statistical power of tests of association of phenotype with genetic variants by pooling signals of a set of genes linked to the same biological process. Annotation libraries like Gene Ontology (<ref type="bibr" target="#b2">Ashburner et al., 2000</ref>), KEGG pathways (<ref type="bibr" target="#b10">Kanehisa and Goto, 2000</ref>) and MIPS functional Categories (<ref type="bibr" target="#b17">Ruepp et al., 2004</ref>) are some of the popular sources for gene sets. Several methods have been developed for gene set analysis. According to Goeman and B € uhlmann, 2007, gene set analysis methods can be categorized into two major categories, competitive and self-contained. Competitive methods focus on distinguishing the most significant gene sets among a dataset of gene sets (<ref type="bibr" target="#b4">Dørum et al., 2009;</ref><ref type="bibr" target="#b5">Efron and Tibshirani, 2006;</ref><ref type="bibr" target="#b13">Mootha et al., 2003;</ref><ref type="bibr" target="#b15">Newton et al., 2007;</ref><ref type="bibr" target="#b18">Subramanian et al., 2005</ref>; T € or € onen et al., 2009;<ref type="bibr" target="#b22">Wu and Smyth, 2012</ref>), whereas selfcontained methods focus on analysis of gene sets irrespective of other genes in the dataset (<ref type="bibr" target="#b3">Dinu et al., 2007;</ref><ref type="bibr" target="#b23">Wu et al., 2010</ref>). In this article, we focus on competitive gene set analysis methods. Recent research has addressed gene set analysis problems in datasets with fewer replicates and more than two sample groups (<ref type="bibr" target="#b22">Wu and Smyth, 2012;</ref><ref type="bibr" target="#b23">Wu et al., 2010</ref>). However, the fundamental problems in P-value calculation for gene set scores remain unaddressed. Most of the methods are still based on empirical P-value that requires a large number of permutations or rotations to be calculated accurately. In this article, we first evaluate various gene set scoring functions for their optimality and then propose improvements to empirical P-value calculation. We start with a rigorous assessment and evaluation of popular gene set analysis methods: Gene Set Analysis (GSA) (<ref type="bibr" target="#b5">Efron and Tibshirani, 2006</ref>), Gene Set Z-score (GSZ) (T € or € onen et al., 2009), Allez (<ref type="bibr" target="#b15">Newton et al., 2007</ref>), methods based on Kolmogorov–Smirnov (KS) (<ref type="bibr" target="#b13">Mootha et al., 2003</ref>) and weighted Kolmogorov–Smirnov (wKS) (<ref type="bibr" target="#b18">Subramanian et al., 2005</ref>), and methods based on Wilcoxon Rank Sum (WRS) (<ref type="bibr" target="#b14">Naeem et al., 2012</ref>), sum of scores (SUM) (<ref type="bibr" target="#b19">Tian et al., 2005</ref>) and sum of squared scores (SS) (<ref type="bibr" target="#b3">Dinu et al., 2007</ref>) based on empirical P-value obtained from hundred thousand sample permutations. The selection of the methods was based on earlier comparisons (<ref type="bibr" target="#b0">Ackermann and Strimmer, 2009;</ref><ref type="bibr" target="#b14">Naeem et al., 2012</ref>). We then test whether empirical null distribution (gene set scores from permuted data) obtained from the compared methods can be modeled by suitable asymptotic distribution models. We point out major limitations in some of the methods and propose improvements on scoring functions, permutation models and P-value estimation. We show that the efficiency of GSA can be significantly improved by replacing the *To whom correspondence should be addressed y</p><p>The authors wish it to be known that, in their opinion, the first two authors should be regarded as Joint First Authors. max-mean statistics with the GSZ scoring function and by implementing asymptotic P-value. Similarly, the performance of Allez can be significantly improved by implementing sample permutation and asymptotic P-value estimation. The improved versions of GSA and Allez are called mGSA and mAllez, respectively. We show that GSZ outperforms all the compared methods including the improved ones in our evaluation. We propose an asymptotic method of P-value estimation for GSZ, mGSA, mAllez and SUM. Asymptotic P-value estimation requires fewer permutations and significantly speeds up the gene set analysis process. Similar work that proposes asymptotic method for P-value calculation was done by<ref type="bibr" target="#b12">Knijnenburg et al., 2009</ref>. Our method is different in that it requires fewer permutations.<ref type="bibr" target="#b9">Irizarry et al., 2009 and</ref><ref type="bibr" target="#b11">Kim and</ref><ref type="bibr" target="#b11">Volsky, 2005</ref>proposed fully parametric gene set analysis methods based on normal approximation of the gene set scores (gene independence assumption). However, mGSZ is semi-parametric in the sense that we approximated the empirical null distributions of gene set scores with well-known asymptotic distribution models for asymptotic P-value estimation. The implementation resulted in significant improvement in efficiency of the methods. For gene set analysis methods with no known asymptotic model, we implement an improved version of P-value calculation based on Phipson and Smyth, 2010. P-value estimation in permutation-based gene set analysis methods uses either genes or samples or both as sampling unit. Despite its popularity, gene permutation can lead to flawed biological conclusion because of correlation among genes (Goeman and B € uhlmann,<ref type="bibr">2007</ref>). For the competitive gene set analysis methods, however, we show that it is crucial to consider the results from gene permutation. Similar to<ref type="bibr" target="#b5">Efron and Tibshirani, 2006</ref>, we show that the absence of gene permutation in competitive gene set analysis results in type I error. We argue in favor of using both gene and sample as sampling unit in competitive gene set analysis methods as proposed by Efron and<ref type="bibr" target="#b5">Tibshirani (2006)</ref>,<ref type="bibr" target="#b19">Tian et al. (2005)</ref>and T € or € onen et al. (2009). Once significant gene sets are reported, it is useful to evaluate a gene set in more detail to see the behavior of the gene set. This can be done by visualizing the gene set score profile across the gene list as shown in the original GSEA article (<ref type="bibr" target="#b18">Subramanian et al., 2005</ref>). In our opinion, it is even more relevant to compare gene set scores from original and permuted data. Original data correspond to differential gene expression test scores calculated from gene expression data with correct sample labels, and permuted data correspond to differential gene expression test scores calculated from gene expression data with permuted sample labels. Therefore, we represent an improvement on the visualization where we show the gene set scores from original data and a summary (e.g. percentiles) of the gene set scores from permuted data. This allows visualization of separation between gene set scores from original and permuted data. We compared mGSZ with program packages of GSA (<ref type="bibr" target="#b5">Efron and Tibshirani, 2006</ref>), Allez (<ref type="bibr" target="#b15">Newton et al., 2007</ref>) and CAMERA (<ref type="bibr" target="#b22">Wu and Smyth, 2012</ref>). We show that mGSZ clearly outperforms the other methods. ROAST (<ref type="bibr" target="#b23">Wu et al., 2010</ref>) is a state-of-the-art self-contained gene set analysis method. Even though in principle self-contained methods cannot be compared with competitive methods, we compared mGSZ with ROAST to point out the differences in gene set analysis results from the two different approaches.<ref type="bibr">Dørum et al., 2009</ref>proposed rotation test for estimation of P-values for gene set analysis of datasets with very small sample size. We show that asymptotic P-values estimated from permutation test were equally good as that of rotation test with a dataset consisting of only three replicates in each group. Finally, we present a R statistical package 'mGSZ' that implements mGSZ and the other compared methods.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2">METHODS</head><p>In this section, we describe (i) Gene set scoring functions of the compared gene set analysis methods, (ii) Permutation model used in this work, (iii) Asymptotic method for P-value calculation, (iv) Series expansion for P-value calculation with EVD and GEVD models, (v) Evaluation tests for gene set scoring functions based on applicability of asymptotic P-value estimation, (vi) Evaluation tests for gene set scores based on empirical P-values, (vii) Comparison of mGSZ with state-of-the-art program packages, (viii) Evaluation of mGSZ with gene expression dataset with small sample size and (ix) Biological datasets used for the evaluation tests.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.1">Gene set analysis methods</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.1.1">The</head><p>Gene Set Z-score GSZ is a gene set scoring function that combines features from overrepresentation and shifted expression-based approaches. This is done by using a hypergeometric enrichment score that is weighted with the differential expression test scores (T € or € onen et al., 2009). GSZ takes as an input a gene list ordered based on differential gene expression test scores and classification of genes as member (MG) and non-member (NG) genes of gene sets (Supplementary<ref type="figure" target="#fig_3">Fig. S1</ref>). Given an ordered gene list, a threshold is placed in between every consecutive pair of genes. GSZ score is then calculated for every subset of the ordered gene list taken at each of the threshold positions (Supplementary<ref type="figure" target="#fig_3">Fig. S1</ref>). Let M denote the total number of genes in the ordered gene list and X i ; i=1; ::::; M denote the differential gene expression test scores for i th gene in the list. Let T i denote the threshold position at i th gene in the list and S N be a subset of top N genes of the list taken at T N. Then, GSZ uses the following function to calculate the difference between the sum of differential gene expression test scores for MG and NG genes of the analyzed gene set within the subset,</p><formula>Diff N = X i2S N i2MG X i À X i2S N i2NG X i : ð1Þ</formula><p>The calculation is repeated for each threshold position, T i and the largest absolute value is selected as the GSZ score of the analyzed gene set based on upregulated member genes. The ordered gene list is then inverted and the whole process is repeated analogously starting from the most downregulated genes for the GSZ score of the analyzed gene set based on the downregulated member genes. The largest absolute value of the GSZ scores based on upregulated and downregulated member genes is selected as the GSZ score for the analyzed gene set. The difference calculated in Equation 1 is unstable due to the biases caused by differences in gene set sizes, subset sizes and variances of the gene set scores in different subsets. GSZ method solves this problem by Z-score normalization (<ref type="figure">Fig. 5</ref>),) and the size of the subset, N. For the calculation of prior variance, k, we use the medians of the variance estimates over the ordered gene list obtained with the analyzed gene set and a gene set of size 10 (Supplementary Section S7). GSZ is similar to the scoring function proposed by Efron and<ref type="bibr" target="#b5">Tibshirani, 2006</ref>. Efron and<ref type="bibr" target="#b5">Tibshirani, 2006</ref>proposed a max-mean statistics, where the analyzed gene set is divided into two parts at X = 0 (positive regulation and negative regulation). This corresponds to GSZ when the threshold N is placed at X N = 0 (Supplementary Section S8). The scoring function proposed by<ref type="bibr" target="#b15">Newton et al., 2007</ref>calculates the mean value (X) of the differential expression test scores for all the genes in the analyzed gene set followed by normalization. The calculation of the mean and variance estimates for X is practically the same equations as Equations 3 and 4 with the only difference caused by the absence of N. Thus, GSZ is identical to the scoring function proposed by<ref type="bibr" target="#b15">Newton et al., 2007</ref>if calculated using the whole gene list. GSZ is identical to mGSZ with the addition of asymptotic P-values. For simplicity, we use the notation 'mGSZ' in the following text.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.1.2">Modified methods Three</head><p>of the methods in our evaluation were modified versions of GSZ (T € or € onen et al., 2009), GSA (Efron and<ref type="bibr" target="#b5">Tibshirani, 2006</ref>) and Allez (<ref type="bibr" target="#b15">Newton et al., 2007</ref>). The modifications were—GSZ: implementation of asymptotic P-value, GSA: replacement of max-mean statistics with GSZ statistics and implementation of asymptotic P-value and Allez: addition of sample permutation for asymptotic P-value calculation. We call the modified methods mGSZ, mGSA and mAllez, respectively.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.1.3">Reference methods</head><p>We also included methods based on WRS, SUM, sum of squared scores (SS), KS and wKS scoring functions. WRS statistics is the sum of ranks of member genes of the analyzed gene set in the whole gene list. SUM statistics is the simple sum of the differential gene expression test scores of the member genes of the analyzed gene set with background subtraction. SS statistics is simply the squared version of SUM.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.3.1">Series expansion P-values for EVD and GEVD are based on</head><p>extraction which makes it difficult to calculate extremely small P-values. We solved this problem by deriving series expansions on the logarithm of a P-value for EVD and GEVD. Log P-values for EVD and GEVD are calculated as:where, x=ðz À Þ= ð8Þ z is absolute mGSZ or mGSA score value for the analyzed gene set, and , and a are the location, scale and shape parameters, respectively, for GEVD. Expressions on the right hand side of Equations 5 and 7 are readily evaluated by ordinary numerical software for relatively small absolute values of x. However, already for values of the order of jxj % 30 the outer exponentials become so small that the results are distorted by rounding errors. To achieve more precise results, we derived the following expansions of F(x) and G(x) (Supplementary Section S2):G s ðxÞ if x ! 5 and ð1+axÞ40:</p><formula>( ð12Þ</formula><p>The prespecification of the threshold was based on the number of terms picked from the series expansion and the amount of error allowed. The number of terms used in our analysis is four, and for F(x) this means that the approximation error is at most of the order 1:78 Ã 10 À15 .</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.4">Datasets</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.4.1">TF deletion and overexpression data</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.4.2">P53 cancer data Protein</head><p>p53 is a tumor suppressor protein that prevents development of cancer cells. The p53 dataset consists of 33 samples with mutated p53 gene and 17 samples with wild type p53 gene (<ref type="bibr" target="#b18">Subramanian et al., 2005</ref>).</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.4.3">Gender data</head><p>Gender data consist of mRNA expression profiles from lymphoblastoid cell lines derived from 15 males and 17 females (<ref type="bibr" target="#b18">Subramanian et al., 2005</ref>).</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.4.4">Leukemia data Leukemia dataset consists of gene expression</head><p>profiles of cells from 24 acute lymphoid leukemia patients and 24 acute myeloid leukemia patients (<ref type="bibr" target="#b1">Armstrong et al., 2002</ref>).and overexpression data were verified using p53 and gender data. Forty gene sets strongly relevant to protein p53 and 10 gene sets strongly relevant to gender were selected and considered as relevant gene sets (Supplementary Tables S4 and S5). Gene sets reported by each of the methods were ranked based on empirical P-values calculated with 100 000 sample permutations. Subset of top gene sets (50 in p53 data and 20 in gender data) was taken. Relevant gene sets in the subset were labeled as 1 and irrelevant gene sets were labeled as 0. The cumulative sum was calculated for the subset. False-positive signal test. The performance of the compared methods was further analyzed with real biological data but with null gene sets. The null gene sets were generated by randomly choosing the member genes while keeping the gene set sizes intact. The idea was to test if some of the methods have a tendency to create false-positive results when gene sets have no biological signal.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.5">Evaluation tests</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Stability</head><p>of gene set scores. GSZ scoring function is similar to KSbased scoring functions in that it calculates scores running across an ordered gene list. This allows us to compare mGSZ with KS and wKS based on the gene set score profile across an ordered gene list. Gene set score profiles of the top ranked gene set reported by wKS were calculated for original as well as 1000 sample permuted data with all the three methods. Instead of 1000 gene set score profiles, we plotted seven percentiles of gene set score profiles from permuted data.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.6">Comparison of mGSZ with program packages</head><p>The main objective of this comparison was to test the performance of mGSZ as compared with some of the state-of-the-art gene set analysis methods. We also included mGSA and mAllez in the comparison to show the improved performance as compared with their original versions, GSA (<ref type="bibr" target="#b5">Efron and Tibshirani, 2006</ref>) and Allez (<ref type="bibr" target="#b15">Newton et al., 2007</ref>). The comparison was based on three tests: (i) Evaluation of top gene sets, (ii) Falsepositive signal test and (iii) P-value test where we compare the log P-values reported by each of the compared methods.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.7">Evaluation of mGSZ on dataset with small sample size</head><p>Here, we tested the applicability of mGSZ to gene expression datasets with few replicates in each sample group. Gene set analysis methods based on empirical P-values are not suitable for datasets with few sample replicates (e.g. three), because the minimum obtainable P-value by empirical method is restricted by the small number of permutations that can be obtained from fewer sample replicates. Unlike permutation, number of rotations is not dependent on sample size (<ref type="bibr">Dørum et al., 2009</ref>). For this evaluation, we developed two versions of mGSZ: one that implements permutation for generating empirical null distribution and the other that implements rotation for the same. In both cases, P-value was estimated asymptotically by fitting suitable asymptotic model to the empirical null distribution. We refer the two versions of mGSZ as mGSZpermutation and mGSZrotation, respectively. The only difference between the two versions is the number of permutations/rotations that can be generated for the empirical null distribution. Both mGSZpermutation and mGSZrotation were implemented on a simulated gene expression datasets. For the simulated gene expression datasets, we generated data on 20 000 genes and six samples. The first three samples are the control group and the second three samples are the treatment group. Each consecutive non-overlapping block of 20 genes was considered to be a gene set with the total of 1000 gene sets. Each gene expression value was generated as i.i.d. N(0,1). Then, the constant 1.0 was added to the first 10 genes in the every 10th gene set starting from 1st until 490th gene set. Thus, we generated 50 positive gene sets in the simulated dataset. The comparison of the results was based on evaluation of the top gene sets and P-value test, where we compare the log P-values reported by each of the methods.<ref type="figure" target="#tab_1">Table 1</ref><ref type="figure" target="#tab_1">Table 1</ref>is based on approximate ranks. We use ties when the difference between methods is insignificant. Smaller ranks across the column denote good performance of a method, whereas bigger ranks denote the opposite. Stability test was relevant only to mGSZ, KS and wKS because the scoring functions of the other methods do not calculate running scores. mGSA leads mGSZ in the detection of TF activity with negligible difference. KS-based method showed surprisingly good empirical P-values leaving mGSZ as second best performer. However, KS lags behind in the other tests. Overall, mGSZ outperforms the other methods (<ref type="figure" target="#tab_1">Table 1</ref>).</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3">RESULTS</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.1">Summary of the results</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.2">Asymptotic approximation of empirical null distribution</head><p>We tested four distribution models—EVD, GEVD, NORM and GAMMA—with gene set scores from mGSZ of which EVD and GEVD turned out to be the optimal models based on the optimality criterion (Section 2.5.1) (<ref type="figure" target="#tab_2">Table 2</ref>). GAMMA and NORM did not pass the optimality criterion (Section 2.5.1) (<ref type="figure" target="#tab_2">Table 2</ref>). The same distribution models were tested with mGSA data and surprisingly, while EVD, GEVD and GAMMA turned out to be the optimal models, NORM did not pass the optimality criterion (Section 2.5.1) (<ref type="figure" target="#tab_2">Table 2</ref>). NORM was the best fitting model for SUM and mAllez data (Section 2.5.1) (<ref type="figure" target="#tab_2">Table 2</ref>). In case of mGSZ and mGSA, we selected the models that produced P-values with maximum cor and minimum mse with the reference of truth in both the whole data and the subset. In case ofmGSZ and mGSA, EV was selected as the model for asymptotic P-value calculation (<ref type="figure" target="#tab_2">Table 2</ref>),whereas NORM was the model of choice for asymptotic P-value calculation for mAllez and SUM (<ref type="figure" target="#tab_2">Table 2</ref>). Similar results were observed from the analysis with gender data (Supplementary Section S5).</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.3">P-value estimation methods: asymptotic and empirical</head><p>The results were highly in favor of asymptotic P-values for mGSZ, mGSA, mAllez and SUM with higher correlation and lower mean squared error, as compared with the empirical P-values (<ref type="figure" target="#tab_3">Table 3</ref>). As shown in<ref type="figure" target="#tab_3">Table 3</ref>, asymptotic P-values (EV) calculated against 500 permutations have very low mse and very high cor when compared with empirical P-values calculated against 100 000 permutations. This implies that 500 permutations are enough for asymptotic P-values.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.4">Evaluation of gene set scoring functions</head><p>3.4.1 Detection of TF activity mGSZ and mGSA were the top ranking methods in identifying correct TF activity (<ref type="figure" target="#tab_4">Table 4</ref>). Analysis of five quantiles of AUC scores across the experiments in TF dataset showed that mGSZ and mGSA had the highest AUC score in the lowest quantile (0 quantile) (<ref type="figure" target="#fig_3">Fig. 1</ref>).</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.4.2">Detection of relevant gene sets</head><p>Test on p53 cancer data. Top 50 gene sets reported by each of the compared methods were analyzed as described in section 2.5.3 (<ref type="figure" target="#fig_7">Fig. 2</ref>). mGSZ was the top ranking method, with SS being the closest competitor (<ref type="figure" target="#fig_7">Fig. 2</ref>). Test on gender data. Top 20 gene sets reported by each of the compared methods were analyzed as described in section 2.5.3. The results were similar to that of p53 data (<ref type="figure" target="#fig_8">Fig. 3</ref>).(<ref type="bibr" target="#b1">Armstrong et al., 2002</ref>) with the compared methods. Leukemia data are signal rich data and hence suitable to test methods that are sensitive to high signals. Surprisingly, SS identified 485% of the null gene sets as significant (<ref type="figure">Fig. 4</ref>). SUM is the second-worst performing method in this test (<ref type="figure">Fig. 4</ref>). In addition to the leukemia data, we also performed the analysis on randomized p53 dataset with Gene Ontology genesets (<ref type="bibr" target="#b2">Ashburner et al., 2000</ref>). Even though mGSZ, mGSA, wKS and KS are more conservative, the difference to the other methods is significantly smaller (Supplementary Section S10).</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.4.3">False-positive signal analysis</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.4.4">Stability of gene set scores Stability</head><p>of the gene set scores from mGSZ, KS and wKS was compared using p53 cancer data as described in Section 2.5.3. The stability plot for mGSZ, based on permuted data shows that the middle part of the seven percentiles of the gene set score profiles of the permuted data stay quite stable across gene list positions (<ref type="figure">Fig. 5a</ref>). The minimum percentile shows smaller deviation from zero than the maximum percentile (<ref type="figure">Fig. 5a</ref>). This indicates that gene set scores coming from overrepresentation show stronger signal than those coming from underrepresentation. The maximum of thegene set scores from original data comes quite early in the gene list, pointing that gene set members occur near the top of the ordered gene list (<ref type="figure">Fig. 5a</ref>). Notice that the separation between gene set score profile from original data and permuted data is quite clear across different threshold positions (<ref type="figure">Fig. 5a</ref>). The importance of our visualization is more highlighted when we analyze the behavior of wKS and KS with the same gene expression dataset and the same gene set. For wKS the gene set score profile from permuted data shows strange behavior with Sshaped profile (<ref type="figure">Fig. 5b</ref>) and for KS the middle area shows strong variation (<ref type="figure">Fig. 5c</ref>). The separation between gene set score profile from permuted data and original data is weak in both wKS and KS (<ref type="figure">Fig. 5c</ref>). This comparison is based on the strongest gene set reported by wKS. Stability plot for mGSZ, wKS and KS based on gender data is discussed in Supplementary Section S6.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.5">Comparison of mGSZ, mGSA and mAllez with program packages</head><p>We summarize the results of the comparison of mGSZ, mGSA and mAllez with program packages in<ref type="figure" target="#tab_5">Table 5</ref>. The notation used in<ref type="figure" target="#tab_5">Table 5</ref>is same as in the<ref type="figure" target="#tab_1">Table 1</ref>. The results are described in detail in Supplementary Section S11. Two datasets (p53 and gender) were used for all evaluation tests except for false-positive signal analysis. For false-positive signal analysis, leukemia dataset was used for similar reason as mentioned in Section 2.5.3. CAMERA showed the best results in false-positive signal analysis. However, in the remaining two evaluation tests, mGSZ outperformed the other methods.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.6">Evaluation of mGSZ on dataset with small sample size</head><p>No significant difference was observed between log P-values reported by mGSZrotation and mGSZpermutation with the simulated dataset (Supplementary Section S12, Supplementary<ref type="figure" target="#fig_3">Fig. 16a</ref>and b). We also evaluated the top gene sets reported by the two methods in both the simulated datasets, and the results were similar (Supplementary Section S12, Supplementary Figs 17a and b).<ref type="figure" target="#tab_6">Table 6</ref>demonstrates the effects of the use of gene or/and sample permutation methods in competitive gene set analysis methods. The table is the summary of the results from false-positive signal analysis of the compared gene set scoring functions (Section 3.4.3,<ref type="figure">Fig. 4</ref>) and comparison of mAllez with program package of Allez based on detection of relevant gene sets (Section 3.5,<ref type="figure" target="#tab_5">Table 5</ref>). The methods implementing only sample permutation<ref type="figure">5</ref>. Visualization of scoring function profiles for mGSZ, wKS and KS for gene set 'p53hypoxiaPathway' in p53 data. Figures also show seven percentiles (0, 10, 25, 50, 75, 90 and 100) of gene set score profiles obtained from the permuted data. Notice the clear separation of the gene set score profiles from original data with that of permuted data and stability of gene set score profiles from permuted data in case of GSZ-scoreNotes: Numbers indicate approximate rank of the methods based on the test results. *Sign indicates that a test is not applicable to a particular method. report high false-positive signal (<ref type="figure" target="#tab_6">Table 6</ref>). Note the ranks of mAllez and Allez based on detection of relevant gene sets in<ref type="figure" target="#tab_5">Table 5</ref>. The improved performance of mAllez as compared with Allez is clearly due to the addition of sample permutation (<ref type="figure" target="#tab_6">Table 6</ref>). Interestingly, GSA that explicitly implements both gene and sample permutations, ranks lower than mGSZ and mGSA (<ref type="figure" target="#tab_6">Table 6</ref>). This suggests that implicit implementation of gene permutation is at least as good as explicit implementation.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.7">Evaluation of permutation methods</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4">DISCUSSION</head><p>Gene set analysis methods aim to identify a priori defined gene sets associated with biological pathways that are altered in a biological or medical test. Despite the decade long research into the field, some of the most popular gene set analysis methods still suffer from serious limitations that need to be addressed and rectified. In this work, we have accessed and evaluated popular gene set analysis methods, pointed out limitations in the scoring functions, permutation methods and P-value calculation methods and proposed improvements. mGSZ and mGSA are the best performers in detection of TF activity in TF data (Section 3.4.1). However, in case of p53 and gender data, mGSZ detected the highest number of relevant gene sets, closely followed by SS (Section 3.4.2). Overall, mGSZ stands out as the best performer in detection of relevant gene sets. Note that the evaluation tests, detection of TF activity in TF data and relevant gene sets in p53 and gender data were based on empirical P-values estimated with 100 000 permutations. Only the gene set scoring functions were varied in the compared methods. So, the variations in results were direct consequences of the gene set scoring functions. Despite the good performance in detection of relevant gene sets with p53, gender and TF data, SS as well as SUM had significantly high type 1 error with randomized leukemia dataset (Section 3.4.3). SS and SUM are the only methods in our comparison that lack gene permutation. Because of that the methods do not compare the member and non-member genes of the analyzed gene set and thus lose the essence of competitive GSA. Note that self-contained gene set analysis methods do not require gene permutations as they calculate gene set scores with no reference to genes other than member genes of the analyzed gene sets. The remaining six methods have gene permutation included implicitly in their scoring functions and take into consideration the results from gene permutations implicitly. This clearly points to the importance of considering results from gene permutation in competitive gene set analysis methods (Section 3.7,<ref type="figure" target="#tab_6">Table 6</ref>EVD and GEVD turned out to be the best fitting models for mGSZ data which is quite natural considering that the mGSZ score is the highest absolute value in a profile. For mGSA, EVD, GEVD and GAMMA turned out to be the best fitting models. In case of mAllez and SUM, NORM was the best fitting model. Asymptotic P-values calculated for mGSZ, mGSA, mAllez and SUM scores with the best fitting models with 500 sample permutations were more accurate than empirical P-values calculated with 2000 sample permutations, clearly demonstrating the superiority of asymptotic P-value over empirical P-value (Section 3.3). Surprisingly, despite the poor performance on the other tests, empirical P-value estimation method for KS with 500 sample permutations shows exceptionally high accuracy (Section 3.3). Comparison of mGSZ with the state-of-the-art gene set analysis methods showed the best overall performance of mGSZ. mGSZ is the best method among the compared methods based on the results from the detection of relevant gene sets from p53 and gender datasets and comparison of resolution of the Pvalues assigned to the top gene sets from p53 and gender datasets (Section 3.5). The comparison of mGSZ with ROAST was included to illustrate the differences between self-contained and competitive methods with a suitable dataset. In a signal rich dataset like leukemia, self-contained methods like ROAST fail to provide biologically conclusive results. Randomization of gene sets in leukemia dataset randomizes the member genes of the gene sets. However, as 79.9% of the individual genes are differentially expressed in the leukemia data (<ref type="bibr" target="#b3">Dinu et al., 2007</ref>), ROAST identifies a significantly large number of null gene sets as significant. This effect is not seen in competitive methods as competitive methods compare the member genes with non<ref type="figure">Figure 4</ref>,<ref type="figure" target="#tab_5">Table 5</ref>WRS Present Present implicitly Low –<ref type="figure">Figure 4</ref>SS Present Absent High –<ref type="figure">Figure 4</ref>SUM Present Absent High –<ref type="figure">Figure 4</ref>wKS Present Present implicitly Low –<ref type="figure">Figure 4</ref>KS Present Present implicitly Low –<ref type="figure">Figure 4</ref>Allez Absent Present – Ranked as worst<ref type="figure" target="#tab_5">Table 5</ref>GSA Present Present – Ranked lower than mGSZ and mGSA<ref type="figure" target="#tab_5">Table 5</ref>member genes of the analyzed gene sets, and thus the results remain stable in datasets with varying level of biological signals. Interestingly, both mGSA and mAllez rank higher than GSA and Allez in detection of the relevant gene sets in p53 and gender dataset. Higher rank of mGSA as compared with GSA suggests that replacement of max-mean statistics in GSA with GSZ scoring function and implicit implementation of gene permutation improved the performance of the method. Note that GSA implements gene permutation explicitly. Whereas, higher rank of mAllez as compared with Allez suggests that implementation of sample permutation in addition to gene permutation in Allez improved the performance of the method, once again highlighting the importance of implementing both gene and sample permutations in competitive gene set analysis (Section 3.7,<ref type="figure" target="#tab_6">Table 6</ref>). Negligible difference was observed between the asymptotic P-values reported by mGSZ with rotation test and mGSZ with permutation test (Section 3.6) with simulated gene expression dataset with three replicates in each sample group. In addition, both the methods identified same number of positive gene sets in the simulated dataset. The results suggest that mGSZ with permutation test is applicable to gene expression datasets with sample size as small as three. Improved visualization of scoring function profiles of a gene set (the most significant gene set reported by wKS) in the case of mGSZ, KS and wKS revealed a major pitfall in KS based methods, not seen in the original visualization used by<ref type="bibr" target="#b18">Subramanian et al., 2005</ref>(Section 3.4.4). Based on the results of our evaluation, we therefore propose:</p><p>(i) use of GSZ scoring function instead of max-mean statistics in GSA (<ref type="bibr" target="#b5">Efron and Tibshirani, 2006</ref>), (ii) implementation of both gene and sample permutation in competitive gene set analysis methods and (iii) use of asymptotic P-values for the methods based on GSZ, mGSA, mAllez and SUM. These improvements are implemented in our R package, mGSZ. mGSZ takes about 10 min for a gene set data with 522 gene sets and p53 data with 500 permutations in Mac book Pro 10.7.5.</p></div><figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_0"><head>N</head><figDesc>= total number of genes in the subset, S N ; E(X) = mean of differential gene expression test scores for the subset; D 2 (X) = variance of differential gene expression test scores for the subset; E(N MG ) = mean of the hypergeometric distribution of N MG ; D 2 ðN MG Þ = variance of the hypergeometric distribution of N MG ; k = prior variance added to stabilize the scoring function behavior with small subsets. The estimate of the expected value of Diff N (Equation 3) is a simple function of the expected value for hypergeometric distribution EðN MG Þ, the expected value for the differential gene expression test scores in the analyzed subset E(X) and the size of the subset, N. The estimate of the variance of Diff N (Equation 4) is a function of the expected value and the variance of hypergeometric distribution ðEðN MG Þ; D 2 ðN MG ÞÞ, the mean and the variance for the differential gene expression test scores in the subset of the gene list (E(X),D 2 (X)</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_2"><head></head><figDesc>This dataset consists of 907 Escherichia coli microarrays taken from M3D Database (Faith et al., 2008). The preprocessed (log 2 fold-change) dataset was obtained from Naeem et al., 2012. The dataset has no biological replicates. The dataset consisted of knockout and overexpression experiments for 17 TFs targeting 949 genes.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_3"><head>2.5.1</head><figDesc>Asymptotic approximation of empirical null distribution This test was designed to test the applicability of asymptotic P-value calculation in the compared methods. Gene set scores were calculated with the compared scoring functions with 500 sample permutations. Asymptotic distribution models (Section 1) were fitted to the empirical null distributions of the gene set scores and asymptotic P-values were calculated. Similarly, gene set scores were also calculated with the compared scoring functions with 100 000 sample permutations and empirical P-values were calculated. Empirical P-values calculated from 100 000 sample permutations were used as a reference of truth for evaluation of asymptotic P-values. Pearson correlation (cor) between log asymptotic P-values calculated from 500 sample permutations and log empirical P-values calculated from 100 000 sample permutations was calculated. Also, mean squared error (mse) of log asymptotic P-values calculated from 500 sample permutations was calculated against log empirical P-values calculated from 100 000 sample permutations. Although correlation indicates the magnitude and direction of a linear relationship between test P-values and the reference of truth, mean squared error indicates a difference between test P-values and the reference of truth. In addition to the whole list, the analysis was repeated on the signal rich region of P-values by calculating cor and mse also for the subset of P-values 50.10. This emphasizes the biologically interesting regions of the gene list. An optimality criterion was defined for the tested asymptotic models. Asymptotic models with mse 50.10 and cor 40.97 in both the whole list and the signal rich regions were considered to be optimal models for asymptotic P-value estimation. 2.5.2 Comparison of P-value estimation methods A comparison of asymptotic and empirical P-values was done for methods for which the empirical null distribution could be approximated with suitable asymptotic models. Asymptotic P-values were calculated with 500 sample permutations and compared with empirical P-values calculated with 500, 1000 and 2000 sample permutations. Correlation and mean squared error of the P-values were calculated against empirical P-values obtained from 100 000 sample permutations. 2.5.3 Evaluation of gene set scoring functions The objective of this evaluation was to rank the gene set scoring functions of the compared methods based on their overall performance on four different evaluation tests. The evaluation was based on empirical P-values calculated from 100 000 sample permutations. Detection of TF activity. We evaluated the performance of the compared methods on a TF deletion and overexpression dataset. Targets of the TFs were treated as gene sets. The experimental perturbations of TFs provide the standard-of-truth for the evaluation. The experimentally perturbed TFs were considered positive gene sets. An ideal method should identify the perturbed TFs. The compared methods were run on TF dataset and TFs were assigned empirical P-values calculated from 100 000 gene permutations. Gene permutation was implemented because the dataset has no biological replicates. The TFs were ranked based on the empirical P-values. Area under curve (AUC) was calculated for each experiment. The compared methods were ranked based on the mean and standard deviation of the AUC. Detection of relevant gene sets. Results obtained from TF deletion</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_4"><head></head><figDesc>summarizes the results obtained from the evaluation of the compared gene set scoring functions and P-value estimation methods mentioned in Section 2. Sections 3.2–3.4 describe the results in detail.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_5"><head></head><figDesc>We randomized curated gene sets from Subramanian et al., 2005 as described in Section 2.5.3 and analyzed their enrichment in the leukemia dataset</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_6"><head></head><figDesc>Note: Note that asymptotic P-value calculation methods outperform empirical P-value calculation methods. The comparison was based on p53 data. Bold and italic values highlight the difference between the P-values calculated with empirical method with maximum number of permutations (2000) in the comparison and Pvalues calculated with asymptotic method with minimum number of permutations (500) in the comparison.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_7"><head>Fig.2.</head><figDesc>Fig. 2. Relevant gene sets identified by the compared methods. Figure represents cumulative count of biologically relevant gene sets (Supplementary Table S4) over the ranked list of top 50 gene sets reported by each of the compared methods. mGSZ (black) shows the best performance</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_8"><head>Fig.3.</head><figDesc>Fig. 3. Relevant gene sets identified by the compared methods. Figure represents cumulative count of biologically relevant gene sets (Supplementary Table S5) over the ranked list of top 20 gene sets reported by each of the compared methods. mGSZ (black) shows the best performance</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_9"><head>Fig.1.</head><figDesc>Fig. 1. Summary of AUCROC scores of the compared methods in TF dataset. The lines indicate five quantiles: black—0.00, red—0.25, blue– 0.50, green–0.75 and purple–1.00 Fig. 4. Evaluation of methods with randomized gene sets. mGSZ and most other methods show quite similar behavior. SS and SUM, however, show strong noise signal</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_10"><head>Fig.</head><figDesc>Fig. 5. Visualization of scoring function profiles for mGSZ, wKS and KS for gene set 'p53hypoxiaPathway' in p53 data. Figures also show seven percentiles (0, 10, 25, 50, 75, 90 and 100) of gene set score profiles obtained from the permuted data. Notice the clear separation of the gene set score profiles from original data with that of permuted data and stability of gene set score profiles from permuted data in case of GSZ-score</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_11"><head></head><figDesc>) as suggested by Efron and Tibshirani, 2006, Tian et al., 2005 and T € or € onen et al., 2009.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_0" validated="false"><figDesc>the variance, respectively, for Diff N (Equation 1) under the null hypothesis that the gene set members and non-members are distributed randomly across the gene list and k is a prior variance. The functions to calculate the estimates for the expectation value and the variance (Equations 3 and 4) are based on two types of functions: (i) the functions that define the expectation value (E(N MG )) and the variance (D 2 ðN MG Þ) of the number of gene set members in the analyzed subset, and (ii) the functions that define the expectation value (E(X)) and the variance (D 2 (X)) of the differential gene expression test scores in the selected subset of the gene list.</figDesc><table>Z= 
Diff N À EðDiff N Þ 
ffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffi ffi 
D 2 ðDiff N Þ+k 
p 
ð2Þ 

Where, E(Diff N ) and D 2 ðDiff N Þ are the estimates for the expectation 
value and EðDiff N Þ=2EðXÞEðN MG Þ À NEðXÞ 
ð 3Þ 

D 2 ðDiff N Þ=4 
D 2 ðXÞ 
N À 1 
ðEðN MG ÞðN À EðN MG ÞÞ À D 2 ðN MG ÞÞ+EðXÞ 2 D 2 ðN MG Þ 




ð4Þ 

where, 

X = differential gene expression test scores of the genes in the subset, S N ; 

N MG = number of gene set members in the subset, S N ; 

</table></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_2" validated="true"><figDesc>Table 1. Summary of results from various evaluation tests</figDesc><table>Evaluations 
Datasets 
mGSZ 
mGSA 
mAllez 
WRS 
SUM 
SS 
KS 
wKS 

P-value asymptotics 
P53, gender 
Yes 
Yes 
Yes 
No 
Yes 
No 
No 
No 
P-value estimation 
P53 
2 
4 
5 
6 
1 
8 
3 
7 
Detection of TF activity 
TF 
2 
1 
5 
8 
6 
3 
4 
7 
Detection of relevant gene sets 
P53 
1 
3 
6 
7 
4 
2 
8 
5 
G e n d e r 
1 
3 
6 
5 
8 
2 
4 
7</table></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_3" validated="true"><figDesc>Table 2. Asymptotic distribution models fitted on the empirical null distribution generated by the compared methods with p53 data and their results</figDesc><table>Methods 
Models 
mse 
mse(subset) 
cor 
Cor(subset) 
Comments 

mGSZ 
EVD 
0.005 
0.03 
0.99 
0.99 
EVD and GEVD are the optimal models (EVD selected) 
(Problem in parameter optimization for GAMMA 
distribution) 

GEVD 
0.02 
0.09 
0.99 
0.99 
GAMMA 
0.07 
0.36 
0.98 
0.98 
NORM 
1.68 
10.65 
0.89 
0.95 
mGSA 
EV 
0.007 
0.05 
0.99 
0.98 
EVD, GEVD and Gamma are the optimal models 
(EVD selected) 
GEVD 
0.02 
0.1 
0.99 
0.98 
GAMMA 
0.009 
0.06 
0.99 
0.98 
NORM 
0.27 
2.03 
0.98 
0.95 
mAllez 
NORM 
0.01 
0.03 
0.99 
0.98 
Optimal (selected) 
WRS 
NORM 
0.01 
0.04 
0.97 
0.95 
Not optimal 
SS 
GAMMA 
0.31 
1.11 
0.96 
0.95 
Problem in parameter optimization 
SUM 
NORM 
0.008 
0.02 
0.99 
0.99 
Optimal (selected) 
KS 
_ 
_ 
_ 
No suitable asymptotic model found 
wKS 
_ 
_ 
_ 
No suitable asymptotic model found 

Notes: Scores not meeting the criteria for optimal model are highlighted. 

</table></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_4" validated="true"><figDesc>Table 3. Comparison of P-value calculation methods</figDesc><table>Methods P-value methods 
mse 
mse 
(subset) 

cor 
cor 
(subset) 

mGSZ 
EV (500 perms) 
0.005 
0.03 
0.99 0.99 
EMP (500 perms) 
0.06 
0.31 
0.95 0.88 
EMP (1000 perms) 
0.04 
0.22 
0.97 0.93 
EMP (2000 perms) 
0.03 
0.15 
0.98 0.96 
mGSA 
EV (500 perms) 
0.007 
0.05 
0.99 0.98 
EMP (500 perms) 
0.02 
0.1 
0.98 0.96 
EMP (1000 perms) 
0.01 
0.06 
0.99 0.97 
EMP (2000 perms) 
0.007 
0.04 
0.99 0.98 
mAllez 
Gaussian (500 perms) 0.01 
0.03 
0.99 0.98 
EMP (500 perms) 
0.04 
0.13 
0.96 0.89 
EMP (1000 perms) 
0.02 
0.08 
0.98 0.94 
EMP (2000 perms) 
0.01 
0.05 
0.99 0.96 
SUM 
Gaussian (500 perms) 0.008 
0.02 
0.99 0.99 
EMP (500 perms) 
0.04 
0.14 
0.96 0.89 
EMP (1000 perms) 
0.03 
0.1 
0.97 0.93 
EMP (2000 perms) 
0.02 
0.06 
0.98 0.95 
WRS 
EMP (500 perms) 
0.01 
0.04 
0.98 0.92 
EMP (1000 perms) 
0.006 
0.02 
0.99 0.97 
EMP (2000 perms) 
0.003 
0.01 
0.99 0.98 
SS 
EMP (500 perms) 
0.11 
0.38 
0.95 0.91 
EMP (1000 perms) 
0.07 
0.26 
0.96 0.94 
EMP (2000 perms) 
0.05 
0.17 
0.98 0.95 
KS 
EMP (500 perms) 
0.004 
0.02 
0.99 0.95 
EMP (1000 perms) 
0.002 
0.01 
0.99 0.98 
EMP (2000 perms) 
0.0005 0.003 
0.99 0.99 
wKS 
EMP (500 perms) 
0.02 
0.18 
0.97 0.91 
EMP (1000 perms) 
0.01 
0.11 
0.98 0.95 
EMP (2000 perms) 
0.01 
0.08 
0.99 0.96 

</table></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_5" validated="true"><figDesc>Table 4. Table showing average and standard deviation AUC of eight methods across all the experiments in TF deletion and overexpression dataset</figDesc><table>No. 
Scoring functions 
AUC 
STD 

1 
mGSA 
0.9058 
0.0725 
2 
mGSZ 
0.9045 
0.0698 
3 
SS 
0.8843 
0.1454 
4 
KS 
0.8694 
0.1099 
5 
mAllez 
0.8683 
0.1232 
6 
SUM 
0.8593 
0.1273 
7 
wKS 
0.8562 
0.1644 
8 
WRS 
0.8138 
0.1591 </table></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_6" validated="false"><figDesc>Table 5.</figDesc><table>Summary of results from various evaluation tests performed for comparison of mGSZ, mGSA and mAllez with the program packages 
(Section 2.1.4) 

Evaluations 
Datasets 
mGSZ 
mGSA 
GSA 
mAllez 
Allez 
CAMERA 
ROAST 

Detection of relevant 
gene sets 

p53 
1 
2 
3 
6 
7 
4 
5 
Gender 
1 
4 
6 
5 
7 
2 
3 
P-value resolution 
p53 
1 
2 
6 
3 
* 
4 
5 
Gender 
1 
3 
4 
2 
* 
5 
6 
False-positive signal 
analysis 

Leukemia 
2 
2 
2 
2 
* 
1 
6 

</table></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_7" validated="true"><figDesc>Table 6. Comparison of gene and sample permutation methods based on false-positive signal analysis and detection of relevant gene sets</figDesc><table>Methods 
Permutation 
False-positive signal 
Detection of relevant gene sets 
Reference 

Sample 
Gene 

mGSZ 
Present 
Present implicitly 
Low 
– 
Figure 4 
mGSA 
Present 
Present implicitly 
Low 
– 
Figure 4 
mAllez 
Present 
Present implicitly 
Low 
Improved as compared with Allez 
</table></figure>

			<note place="foot">ß The Author 2014. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com</note>

			<note place="foot">at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>

			<note place="foot">P.Mishra et al. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>

			<note place="foot" n="2">.1.4 Program packages We compared mGSZ, mGSA and mAllez with R package programs of GSA (Efron and Tibshirani, 2006), Allez (Newton et al., 2007), CAMERA (Wu and Smyth, 2012) and ROAST (Wu et al., 2010). 2.2 Permutation Gene permutation involves permutation of the genes, whereas sample permutation involves permutation of the class labels. GSZ scoring function uses estimates of mean and standard deviation that takes into account the deviation in the gene expression data in both member and non-member genes. This feature of GSZ scoring function allows to compare the gene set scores calculated from the actual gene expression data with the gene set scores calculated from gene-wise permutations of the gene expression data implicitly without the need of separate runs of genewise permutations of the gene expression data. All the reference methods but SUM and SS implement gene permutation implicitly in their scoring functions. All the evaluations except detection of transcription factor (TF) activity in this article are based on sample permutation. 2.3 P-value calculation The minimal obtainable P-value by empirical method and its resolution is directly proportional to the number of permutations. Permutation-based gene set analysis involves small P-values that require a large number of permutations to be calculated accurately. This is often computationally infeasible. An alternative way to calculate small P-values accurately without the need of a large number of permutations is to fit a suitable asymptotic distribution model to the empirical null distribution of gene set scores from permuted data with fewer permutations, estimate parameters of the fitted asymptotic model and use the estimated parameters to calculate P-values from the assumed cumulative distribution function. Asymptotic P-value calculation in this work is based on Gaussian distribution (NORM), Gamma distribution (GAMMA), Extreme value type I distribution (EVD) (Supplementary Section S1) and General extreme value distribution (GEVD) (Supplementary Section S1). Asymptotic distribution models were fitted on the empirical null distribution using distribution fitting methods in R packages, MASS (Venables and Ripley, 2002) and ismev (Heffernan and Stephenson, 2012). We used NORM for modeling gene set scores from SUM and mAllez because sums of normally distributed values should be normally distributed. We used GAMMA for modeling gene set scores data with skewed distribution, for example, SS. EVD and GEVD were used to model gene set score data composed of extreme values, for example, mGSZ and mGSA.</note>

			<note place="foot">Gene set analysis at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>

			<note place="foot">False-positive signal analysis Leukemia 1 1 1 1 7 8 1 1 P 5 3 1 1 1 1 1 1 1 1 Stability of the scoring functions over gene list P53, gender 1 * * * * * 3 2 Notes: First row indicates either presence (Yes) or absence (No) of asymptotic models for the methods, whereas in the rest of the rows, numbers indicate approximate rank of the methods based on the test results. *Sign indicates that a test is not applicable to a particular method.</note>
		</body>
		<back>

			<div type="acknowledgement">
<div xmlns="http://www.tei-c.org/ns/1.0"><head>ACKNOWLEDGEMENT</head><p>We thank Robert K € uffner for providing preprocessed TF deletion and overexpression data.</p></div>
			</div>

			<div type="references">

				<listBibl>

<biblStruct   xml:id="b0">
	<analytic>
		<title level="a" type="main">A general modular framework for gene set enrichment analysis</title>
		<author>
			<persName>
				<forename type="first">M</forename>
				<surname>Ackermann</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">K</forename>
				<surname>Strimmer</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">BMC Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">10</biblScope>
			<biblScope unit="page">47</biblScope>
			<date type="published" when="2009" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b1">
	<analytic>
		<title level="a" type="main">Mll translocations specify a distinct gene expression profile that distinguishes a unique leukemia</title>
		<author>
			<persName>
				<forename type="first">S</forename>
				<forename type="middle">A</forename>
				<surname>Armstrong</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nat. Genet</title>
		<imprint>
			<biblScope unit="volume">30</biblScope>
			<biblScope unit="page" from="41" to="47" />
			<date type="published" when="2002" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b2">
	<analytic>
		<title level="a" type="main">Gene ontology: tool for the unification of biology. The gene ontology consortium</title>
		<author>
			<persName>
				<forename type="first">M</forename>
				<surname>Ashburner</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nat. Genet</title>
		<imprint>
			<biblScope unit="volume">25</biblScope>
			<biblScope unit="page" from="25" to="29" />
			<date type="published" when="2000" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b3">
	<analytic>
		<title level="a" type="main">Improving gene set analysis of microarray data by sam-gs</title>
		<author>
			<persName>
				<forename type="first">I</forename>
				<surname>Dinu</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">BMC Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">8</biblScope>
			<biblScope unit="page">242</biblScope>
			<date type="published" when="2007" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b4">
	<analytic>
		<title level="a" type="main">Rotation testing in gene set enrichment analysis for small direct comparison experiments</title>
		<author>
			<persName>
				<forename type="first">G</forename>
				<surname>Dørum</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Stat. Appl. Genet. Mol. Biol</title>
		<imprint>
			<biblScope unit="volume">8</biblScope>
			<biblScope unit="page">34</biblScope>
			<date type="published" when="2009" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b5">
	<analytic>
		<title level="a" type="main">On testing the significance of sets of genes</title>
		<author>
			<persName>
				<forename type="first">B</forename>
				<surname>Efron</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">R</forename>
				<surname>Tibshirani</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Ann. Appl. Stat</title>
		<imprint>
			<biblScope unit="volume">1</biblScope>
			<biblScope unit="page" from="107" to="129" />
			<date type="published" when="2006" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b6">
	<analytic>
		<title level="a" type="main">Many microbe microarrays database: uniformly normalized affymetrix compendia with structured experimental metadata</title>
		<author>
			<persName>
				<forename type="first">J</forename>
				<forename type="middle">J</forename>
				<surname>Faith</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nucleic Acids Res</title>
		<imprint>
			<biblScope unit="volume">36</biblScope>
			<biblScope unit="page" from="866" to="870" />
			<date type="published" when="2008" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b7">
	<analytic>
		<title level="a" type="main">Analyzing gene expression data in terms of gene sets: methodological issues</title>
		<author>
			<persName>
				<forename type="first">J</forename>
				<forename type="middle">J</forename>
				<surname>Goeman</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">B</forename>
				<surname>€ Uhlmann</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">P</forename>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">23</biblScope>
			<biblScope unit="page" from="980" to="987" />
			<date type="published" when="2007" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b8">
	<monogr>
		<title level="m" type="main">ismev: An Introduction to Statistical Modeling of Extreme Values. Vienna, Austria: R foundation for Statistical Computing</title>
		<author>
			<persName>
				<forename type="first">J</forename>
				<forename type="middle">E</forename>
				<surname>Heffernan</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">A</forename>
				<forename type="middle">G</forename>
				<surname>Stephenson</surname>
			</persName>
		</author>
		<imprint>
			<date type="published" when="2012" />
		</imprint>
	</monogr>
	<note>R. package version 1.39</note>
</biblStruct>

<biblStruct   xml:id="b9">
	<analytic>
		<title level="a" type="main">Gene set enrichment analysis made simple</title>
		<author>
			<persName>
				<forename type="first">R</forename>
				<forename type="middle">A</forename>
				<surname>Irizarry</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Stat. Methods Med. Res</title>
		<imprint>
			<biblScope unit="volume">18</biblScope>
			<biblScope unit="page" from="565" to="575" />
			<date type="published" when="2009" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b10">
	<analytic>
		<title level="a" type="main">Kegg: Kyoto encyclopedia of genes and genomes</title>
		<author>
			<persName>
				<forename type="first">M</forename>
				<surname>Kanehisa</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">S</forename>
				<surname>Goto</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nucleic Acids Res</title>
		<imprint>
			<biblScope unit="volume">28</biblScope>
			<biblScope unit="page" from="27" to="30" />
			<date type="published" when="2000" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b11">
	<analytic>
		<title level="a" type="main">Page: parametric analysis of gene set enrichment</title>
		<author>
			<persName>
				<forename type="first">S</forename>
				<forename type="middle">Y</forename>
				<surname>Kim</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">D</forename>
				<forename type="middle">J</forename>
				<surname>Volsky</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">BMC Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">6</biblScope>
			<biblScope unit="page">144</biblScope>
			<date type="published" when="2005" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b12">
	<analytic>
		<title level="a" type="main">Fewer permutations, more accurate p-values</title>
		<author>
			<persName>
				<forename type="first">T</forename>
				<forename type="middle">A</forename>
				<surname>Knijnenburg</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">25</biblScope>
			<biblScope unit="page" from="161" to="168" />
			<date type="published" when="2009" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b13">
	<analytic>
		<title level="a" type="main">Pgc-1alpha-responsive genesinvolved in oxidativephosphorylationarecoordinatelydownregulatedinhumandiabetes</title>
		<author>
			<persName>
				<forename type="first">V</forename>
				<forename type="middle">K</forename>
				<surname>Mootha</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nat.Genet</title>
		<imprint>
			<biblScope unit="volume">34</biblScope>
			<biblScope unit="page" from="267" to="273" />
			<date type="published" when="2003" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b14">
	<analytic>
		<title level="a" type="main">Rigorous assessment of gene set enrichment tests</title>
		<author>
			<persName>
				<forename type="first">H</forename>
				<surname>Naeem</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">28</biblScope>
			<biblScope unit="page" from="1" to="7" />
			<date type="published" when="2012" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b15">
	<analytic>
		<title level="a" type="main">Random-set methods identify distinct aspects of the enrichment signal in gene-set analysis</title>
		<author>
			<persName>
				<forename type="first">M</forename>
				<forename type="middle">A</forename>
				<surname>Newton</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Ann. Appl. Stat</title>
		<imprint>
			<biblScope unit="volume">1</biblScope>
			<biblScope unit="page" from="85" to="106" />
			<date type="published" when="2007" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b16">
	<analytic>
		<title level="a" type="main">Permutation p-values should never be zero: calculating exact p-values when permutations are randomly drawn</title>
		<author>
			<persName>
				<forename type="first">B</forename>
				<surname>Phipson</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">G</forename>
				<forename type="middle">K</forename>
				<surname>Smyth</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Stat. Appl. Genet. Mol. Biol</title>
		<imprint>
			<biblScope unit="volume">9</biblScope>
			<biblScope unit="page">39</biblScope>
			<date type="published" when="2010" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b17">
	<analytic>
		<title level="a" type="main">The funcat, a functional annotation scheme for systematic classification of proteins from whole genomes</title>
		<author>
			<persName>
				<forename type="first">A</forename>
				<surname>Ruepp</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nucleic Acids Res</title>
		<imprint>
			<biblScope unit="volume">32</biblScope>
			<biblScope unit="page" from="5539" to="5584" />
			<date type="published" when="2004" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b18">
	<analytic>
		<title level="a" type="main">Gene set enrichment analysis: A knowledge-based approach for interpreting genome-wide expression profiles</title>
		<author>
			<persName>
				<forename type="first">A</forename>
				<surname>Subramanian</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proc. Natl Acad. Sci. USA</title>
		<meeting>. Natl Acad. Sci. USA</meeting>
		<imprint>
			<date type="published" when="2005" />
			<biblScope unit="page" from="15545" to="15550" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b19">
	<analytic>
		<title level="a" type="main">Discovering statistically significant pathways in expression profiling studies</title>
		<author>
			<persName>
				<forename type="first">L</forename>
				<surname>Tian</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proc. Natl Acad. Sci. USA</title>
		<meeting>. Natl Acad. Sci. USA</meeting>
		<imprint>
			<date type="published" when="2005" />
			<biblScope unit="page" from="13544" to="13549" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b20">
	<analytic>
		<title level="a" type="main">Robust extraction of functional signals from gene set analysis using a generalized threshold free scoring function</title>
		<author>
			<persName>
				<forename type="first">T€</forename>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">€</forename>
				<surname>Onen</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">P</forename>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">BMC Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">10</biblScope>
			<biblScope unit="page">307</biblScope>
			<date type="published" when="2009" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b21">
	<monogr>
		<title level="m" type="main">Modern Applied Statistics with S-plus</title>
		<author>
			<persName>
				<forename type="first">W</forename>
				<forename type="middle">N</forename>
				<surname>Venables</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">B</forename>
				<forename type="middle">D</forename>
				<surname>Ripley</surname>
			</persName>
		</author>
		<imprint>
			<date type="published" when="2002" />
			<publisher>Springer</publisher>
			<pubPlace>New York</pubPlace>
		</imprint>
	</monogr>
	<note>4th. edn</note>
</biblStruct>

<biblStruct   xml:id="b22">
	<analytic>
		<title level="a" type="main">Camera: a competitive gene set test accounting for inter-gene correlation</title>
		<author>
			<persName>
				<forename type="first">D</forename>
				<surname>Wu</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">G</forename>
				<forename type="middle">K</forename>
				<surname>Smyth</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nucleic Acids Res</title>
		<imprint>
			<biblScope unit="volume">40</biblScope>
			<biblScope unit="page">133</biblScope>
			<date type="published" when="2012" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b23">
	<analytic>
		<title level="a" type="main">Roast: rotation gene set tests for complex microarray experiments</title>
		<author>
			<persName>
				<forename type="first">D</forename>
				<surname>Wu</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">26</biblScope>
			<biblScope unit="page" from="2176" to="2182" />
			<date type="published" when="2010" />
		</imprint>
	</monogr>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>