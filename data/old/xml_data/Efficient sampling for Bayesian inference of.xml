
<?xml version="1.0" encoding="UTF-8"?>
<TEI xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 /home/joey/Project/grobid/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<encodingDesc>
			<appInfo>
				<application version="0.4.2-SNAPSHOT" ident="GROBID" when="2017-08-10T23:41+0000">
					<ref target="https://github.com/kermitt2/grobid">GROBID - A machine learning software for extracting information from scholarly documents</ref>
				</application>
			</appInfo>
		</encodingDesc>
		<fileDesc>
			<titleStmt>
				<title level="a" type="main">Systems biology Efficient sampling for Bayesian inference of conjunctive Bayesian networks</title>
			</titleStmt>
			<publicationStmt>
				<publisher/>
				<availability status="unknown"><licence/></availability>
				<date type="published" when="2012">18 2012</date>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author>
							<persName>
								<forename type="first">Thomas</forename>
								<surname>Sakoparnig</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department">Department of Biosystems Science and Engineering</orgName>
								<orgName type="institution">ETH Zurich</orgName>
								<address>
									<addrLine>Mattenstrasse 26</addrLine>
									<postCode>4058</postCode>
									<settlement>Basel</settlement>
								</address>
							</affiliation>
							<affiliation key="aff1">
								<orgName type="institution" key="instit1">SIB Swiss Institute of Bioinformatics</orgName>
								<orgName type="institution" key="instit2">Supra-University</orgName>
								<address>
									<settlement>Basel</settlement>
									<country key="CH">Switzerland</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Niko</forename>
								<surname>Beerenwinkel</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department">Department of Biosystems Science and Engineering</orgName>
								<orgName type="institution">ETH Zurich</orgName>
								<address>
									<addrLine>Mattenstrasse 26</addrLine>
									<postCode>4058</postCode>
									<settlement>Basel</settlement>
								</address>
							</affiliation>
							<affiliation key="aff1">
								<orgName type="institution" key="instit1">SIB Swiss Institute of Bioinformatics</orgName>
								<orgName type="institution" key="instit2">Supra-University</orgName>
								<address>
									<settlement>Basel</settlement>
									<country key="CH">Switzerland</country>
								</address>
							</affiliation>
						</author>
						<title level="a" type="main">Systems biology Efficient sampling for Bayesian inference of conjunctive Bayesian networks</title>
					</analytic>
					<monogr>
						<imprint>
							<biblScope unit="volume">28</biblScope>
							<biblScope unit="page" from="2318" to="2324"/>
							<date type="published" when="2012">18 2012</date>
						</imprint>
					</monogr>
					<idno type="DOI">10.1093/bioinformatics/bts433</idno>
					<note type="submission">Received on May 21, 2012; revised on June 25, 2012; accepted on July 3, 2012</note>
					<note>BIOINFORMATICS ORIGINAL PAPER Associate Editor: Gunnar Ratsch</note>
				</biblStruct>
			</sourceDesc>
		</fileDesc>
		<profileDesc>
			<abstract>
				<p>Motivation: Cancer development is driven by the accumulation of advantageous mutations and subsequent clonal expansion of cells harbouring these mutations, but the order in which mutations occur remains poorly understood. Advances in genome sequencing and the soon-arriving flood of cancer genome data produced by large cancer sequencing consortia hold the promise to elucidate cancer progression. However, new computational methods are needed to analyse these large datasets. Results: We present a Bayesian inference scheme for Conjunctive Bayesian Networks, a probabilistic graphical model in which mutations accumulate according to partial order constraints and cancer genotypes are observed subject to measurement noise. We develop an efficient MCMC sampling scheme specifically designed to overcome local optima induced by dependency structures. We demonstrate the performance advantage of our sampler over traditional approaches on simulated data and show the advantages of adopting a Bayesian perspective when reanalyzing cancer datasets and comparing our results to previous maximum-likelihood-based approaches. Availability: An R package including the sampler and examples is available at</p>
			</abstract>
		</profileDesc>
	</teiHeader>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1">INTRODUCTION</head><p>Cancer progression is an evolutionary process characterized by the accumulation of somatic mutations, including singlenucleotide variants, copy number alterations and changes of DNA methylation. Cells with advantageous mutations that confer a proliferative fitness advantage will eventually dominate the cancerous tissue due to clonal expansion. Mutations in a number of genes are recurrent and it is therefore believed that they are essential for the development of specific cancer types. Mutations of those genes and the functional changes they induce are often referred to as the hallmarks of cancer (<ref type="bibr" target="#b13">Hanahan and Weinberg, 2011</ref>). The development and fixation of certain mutations in the tumour cell population seem to depend on the presence of other mutations (<ref type="bibr" target="#b7">Fearon and Vogelstein, 1990</ref>), but, in general, the order of occurrence of mutations is poorly understood. Recent advances in genome sequencing enable large-scale consortia such as The Cancer Genome Atlas (TCGA) or the International Cancer Genome Consortium (ICGC) to produce genomic and epigenomic profiles of cancer samples for a medium number of patients on the order of hundreds. For example, The Cancer Genome Atlas Research Network (2011) recently published exome sequencing, copy number variation, gene expression and DNA methylation data for over 300 ovarian cancer patients. Over the course of the last decade, researchers have applied probabilistic modelling in order to identify the dependency structure of driver mutations for various cancer types. The models include oncogenetic trees (<ref type="bibr" target="#b5">Desper et al., 1999</ref><ref type="bibr" target="#b6">Desper et al., , 2000</ref><ref type="bibr" target="#b25">von Heydebreck et al., 2004;</ref><ref type="bibr" target="#b15">Jiang et al., 2000;</ref><ref type="bibr" target="#b22">Szabo and Boucher, 2002</ref>), mixtures of oncogenetic trees (<ref type="bibr" target="#b1">Beerenwinkel et al., 2004;</ref><ref type="bibr">Rahnenfu¨hrernenfu¨hrer et al., 2005;</ref><ref type="bibr" target="#b26">Yin et al., 2006</ref>), probabilistic network models (<ref type="bibr" target="#b14">Hjelm et al., 2006;</ref><ref type="bibr" target="#b20">Radmacher et al., 2001</ref>) and Conjunctive Bayesian Networks (CBN) (<ref type="bibr" target="#b0">Beerenwinkel and Sullivant, 2009;</ref><ref type="bibr" target="#b2">Beerenwinkel et al., 2007;</ref><ref type="bibr" target="#b9">Gerstung et al., 2009</ref>). All these models are based on cross-sectional data where genotyping has been performed once on a cancer tissue sample per patient after diagnosis. CBNs jointly model a partial temporal order for the mutation accumulation process and the probabilities of acquiring these mutations based on this cross-sectional data. In contrast to ordinary Bayesian networks, CBNs assign probabilities of zero to genotypes that are not compatible with the partial temporal order modelled by the CBN. Inference of CBNs is usually done by maximum-likelihood (ML) estimation. Learning the structure of a CBN from observed data is difficult in the presence of observation error and simulated annealing has been used for this task, but assessing the confidence of the estimates is problematic. It has been proposed to derive confidence values from the change in likelihood when removing edges or from bootstrapping the data and refitting the model. However, these approaches have several caveats. (i) There is no a priori optimal strategy for parametrization of the simulated annealing scheme; (ii) proper convergence analysis (i.e. stopping) of the simulated annealing algorithm is difficult and (iii) confidence assessment of discrete structure estimates based on bootstrapping is difficult to interpret. Assessing the confidence of the graph component of probabilistic cancer progression models is particularly important, because the structure of the graph is interpreted as the set of possible mutational pathways. The concern about stability has been reinforced by ML-based simulation studies of mixture models of oncogeentic trees that have shown that the structure of these models can be *To whom correspondence should be addressed. estimated reliably only for fairly simple structures (<ref type="bibr" target="#b4">Bogojeska et al., 2008</ref>). Adopting a Bayesian perspective, one can get access to the full posterior distribution over all CBN models and hence the uncertainty of their inference and their intrinsic variability. However, application of standard structure sampling schemes is impractical for Bayesian networks as they suffer from very slow mixing and convergence (<ref type="bibr" target="#b11">Giudici and Castelo, 2003;</ref><ref type="bibr" target="#b17">Madigan and York, 1995</ref>). Introduction of more sophisticated versions of the basic structure space move types, including a 'reverse edge' move, has been demonstrated to improve mixing and convergence (<ref type="bibr" target="#b12">Grzegorczyk and Husmeier, 2008</ref>). However, the 'reverse edge' move cannot be expected to result in the same improvements for CBNs, because CBNs are specialized Bayesian networks with the property that each directed acyclic graph (DAG) defines a unique set of distributions, i.e. a unique equivalence class. For example, unlike for general Bayesian networks, the graphs A ! B and B ! A do not define equivalent CBNs. Reversing an edge is therefore a much more severe alteration in a CBN. In Section 2, we derive the model and describe an MCMC algorithm designed to overcome local optima induced by dependency structures. We validate the sampler on simulated data, compare our proposed algorithm to a more basic standard structure move-based sampler and finally reanalyze real-world cancer datasets in Section 3.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2">METHODS</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.1">Model</head><p>Let us consider a set of n driver loci, for example, genes, chromosome arms, CpG islands or other more complex entities such as pathways. We measure the genotype of m tumour samples from different patients. A binary random variable Z j indicates whether locus j is mutated (Z j ¼ 1) or not (Z j ¼ 0). The binary random vector Z ¼ (Z 1 ,.. .,Z n ) encodes the genotype, i.e. the state of all driver loci. Since measuring the mutation state of a gene is an error-prone process due to, for example, measurement noise or erroneous interpretation of genetic changes, we consider the observed genotype of a cancer sample as a separate binary random vector X ¼ (X 1 ,.. .,X n ). We assume that mutations accumulate according to a partial order 'a', where l a k means that locus l has to be mutated before a mutation at k can be manifested in a tumour. If l is a direct predecessor of k, then we call this relationship a cover relation. We define the parent set of l as the set of all loci directly preceding l in the partial order. Locus l will mutate with probability l , only if all parents have been mutated before. We say that a genotype Z is compatible with the poset a if (Z l ,Z k ) 6 ¼ (0,1) for all poset relations l a k. The exit set of a genotype Z, denoted Exit (Z), is the set of all loci that are not mutated yet but whose parent sets have been fully mutated. The (Discrete Time) Conjunctive Bayesian Network (<ref type="bibr" target="#b2">Beerenwinkel et al., 2007</ref>) is defined asif Z is compatible with a and zero otherwise. To account for measurement noise or misinterpretation of genetic changes and to avoid the deterministic impact of incompatible observations, we model observation errors by a simple Bernoulli process with parameter ", the error probability, that is assumed independent and identical across sites. The probability of observing genotype X given the true genotype Z iswhere the sum runs over all genotypes compatible with the partial order a. The marginal likelihood of the m measured genotypes, denoted D, can then be written asSince cancer progression and genotype measurement are assumed to be independent, applying Bayes' theorem we obtain Prð0; ; " j DÞ / PrðD j0; ; "Þ Prð0; Þ Prð"Þ ð 5Þ as the joint posterior distribution of model structure (partial order), mutation probabilities and error probability. We further assume the prior independence Pr(a,) ¼ Pr()Pr(a) and that mutation probabilities are independent of network structure. Then, the posterior becomes</p><formula>Prð0; ; " j DÞ / Y X2D X Z h PrðX j Z; "Þ Â PrðZ j0; Þ i Y n k¼1 Prð k Þ Prð0Þ Prð"Þ: ð6Þ</formula><p>For k , we choose a non-informative Beta prior with both shape parameters set to 10 À5. We use an improper uniform prior for the network structure, Pr(a) ¼ 1. The error process parameter " reflects a trade-off between little to no structure in the case of a too small " and arbitrary structures in case of a too high " as most of the genotype variability is explained by the error process. We use " $ Beta (5,30) as error prior.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.2">Sampler</head><p>We adopt a 'random scan Metropolis–Hastings within Gibbs' sampling scheme to sample from the posterior distribution. We use eight different move types for the construction of a hybrid sampler (<ref type="bibr" target="#b24">Tierney, 1994</ref>) to explore the joint discrete structure and continuous parameter space of CBNs. Each move type defines a specific neighbourhood around any point in the state space. All move types except 'relocate theta' and 'reincarnation' are designed such that the neighbourhoods they are considering for any point in the state space are disjoint. As relocate theta and reincarnation are both symmetric move types (see below) their overlap does not compromise the Metropolis–Hastings ratio. The acceptance probability of a proposal sample, denoted by ' * ', iswhere MSP stands for move selection probability. In each iteration, a move type is randomly selected with probability proportional to its MSP, and then a point in the move type neighbourhood of the current sample is selected. The neighbourhoods are equally weighted for all but the reincarnation move, as discussed below. TP stands for the transition probability (density) from the current sample to the proposal sample given that a certain move was selected. All moves, except the relocate theta and the 'event exchange' move, are combined with a double relocate theta move. In the following paragraphs, the move types are explained in detail.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.2.1">Relocate theta</head><p>The mutation probability of a random node is set to a new value which is sampled from a uniform distribution between 0 and 1. As the proposal value does not depend on the current value one can easily see that this move type is symmetric, i.e. P((a,,") * |(a,,")) ¼ P((a,,")|(a,,") * ). Symmetry of move types is desirable as the Hastings factor in Equation (7) becomes one and does not need to be computed. Additionally, the usage of a uniform proposal distribution is advantageous as structural modifications of the CBN usually require a substantial change of the mutation probabilities. The default move selection probability is 0.5.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.2.2">Relocate epsilon</head><p>The error probability " is set to a new value.</p><p>The new value is sampled from Beta(2,20). As in the relocate theta move, the proposal value does not depend on the current value and hence the move is symmetric. The default move selection probability is 0.1.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.2.3">New cover relation</head><p>A random cover relation that which is not resulting in an invalid poset, is inserted (<ref type="figure" target="#fig_4">Fig. 1A</ref>). Edges that result in an invalid poset are either causing cycles, are redundant edges or render an existing edge redundant. A redundant edge in the poset is one that is present in the transitive closure but not a cover relation. This move type is asymmetric, hence the transition probability and the reverse transition probability which is the transition probability of the corresponding 'delete cover relation' move have to be computed. This is done by complete enumeration. The default move selection probability is 0.2.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.2.4">Delete cover relation A random</head><p>edge is removed from the set of cover relations. This move is the asymmetric reverse move to the 'new cover relation' move. The default move selection probability is 0.1. The moves described so far are standard moves for structure sampling of Bayesian networks and are sufficient for ergodicity. Moves that alter the set of cover relations can induce severe alterations on the according transitive closures. On the other hand, small changes in the transitive closure can require a number of cover relation moves. This is a source of local optima and can compromise convergence and mixing of the MCMC scheme. Therefore, we introduce four new moves types, two of which operate directly on the transitive closure.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.2.5">New transitive closure relation</head><p>A random valid edge is inserted into the transitive closure of the poset (<ref type="figure" target="#fig_4">Fig. 1C</ref>). The set of valid new edges is computed as follows. The transitive closure of the poset is computed, all new edges in the transitive closure that do not trigger additional edges in the transitive closure other than the inserted one and cause at least three changed edges in the corresponding poset are valid. With the last condition, an overlap with the reincarnation move neighbourhood (see below) is avoided. This move type and its reverse counterpart 'delete transitive closure relation' are both asymmetric and their transition probabilities have to be computed. This is again done by enumeration. The default move selection probability is 0.01.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.2.6">Delete transitive closure relation</head><p>The set of valid edges to delete is computed as following (<ref type="figure" target="#fig_4">Fig. 1C</ref>). The transitive closure of the poset is computed, all edges in the transitive closure which can be deleted without corrupting the transitive closure integrity and causing at least three changed edges in the corresponding poset are valid. The default move selection probability is 0.01.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.2.7">Event exchange</head><p>The positions of two random nodes in the network topology are exchanged (<ref type="figure" target="#fig_4">Fig. 1B</ref>). The mutation probabilities of those two nodes are relocated as in the relocate theta move. This move type is symmetric. The default move selection probability is 0.03 .</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.2.8">Reincarnation</head><p>A delete cover relation move is followed by a new cover relation move (<ref type="figure" target="#fig_4">Fig. 1D</ref>). This move type is symmetric, which can be seen as follows. The transition probability of this move can be decomposed into the product of the transition probability of the initial delete cover relation move and the following 'new cover relation' move. As both, the current and the final proposal poset have the same number of edges it is easily seen that both delete cover relation moves (proposal and reverse) have the same transition probability. The following 'new cover relation' moves extend the same intermediate poset and hence have an identical neighbourhood and thus identical transition probability. The default move selection probability of the reincarnation move is 0.05.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.3">Implementation and convergence analysis</head><p>We have developed an R package for Bayesian CBNs using the move types described above. The MCMC scheme is implemented in C for performance reasons. As the chains are independent of each other they are ideal candidates for parallelization. The convergence analysis we use is based on the comparison of samples from multiple chains (<ref type="bibr" target="#b8">Gelman, 2004</ref>). This analysis conducts a comparison of the intra-and inter-chain variance for a series ofsimulation was continued indefinitely. Once the maximum ^ R over all parameters is51.1, we sample another round and use the samples derived from this final round for producing summary statistics. We use methods implemented in the CODA package for convergence analysis of the continuous parameters k and " and the log-posterior (<ref type="bibr" target="#b19">Plummer et al., 2006</ref>). As the mutation probabilities as well as the log-posterior are highly dependent on the underlying dependency structure, we use their convergence as proxies for the convergence of the structure.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3">RESULTS</head><p>First, we demonstrate the behaviour of our sampling scheme on simulated data. We then show the performance increase of our sampler over a standard structure move sampler. Finally, we reanalyze real-world cancer datasets in order to demonstrate the increase of interpretability.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.1">Simulation study</head><p>We simulated N 2 f100,400,800} measured genotypes from one network with 10 nodes and no edges, and another one with 8 edges displayed in<ref type="figure" target="#fig_6">Figure 2</ref>, assuming an error probability " 2 f0.01,0.1} (<ref type="figure">Table 1</ref>). Four chains were simulated and monitored for convergence. We thinned out our samples by keeping every 20th sample and produced 25 000 samples per chain and round, i.e. each sampling round consisted of 500 000 iterations per chain. The initial mutation probabilities for each chain were randomly chosen between 0 and 1, the initial error probability was set to 0.05 and the initial poset was set to the empty poset. Having access to the posterior distribution of the CBNs allows characterization of some properties of these models. Recovery of the structure with confidence first of all depends on the structure itself and the error probability. No structure, i.e. no edges or a high-error probability result in a flat posterior CBN distribution (<ref type="figure" target="#fig_8">Fig. 4</ref>). Furthermore, the amount of data used for inference is critical (<ref type="figure" target="#fig_8">Fig. 4</ref>). Nodes that are located in lower parts of the hierarchy and have one or more predecessors with a low mutation probability, also tend to have a flat posterior over their structural dependencies and mutation probabilities. The further down, a node is in the hierarchy, the higher the variance of the posterior mutation probability (<ref type="figure" target="#fig_7">Fig. 3A</ref>). Uncertainty in the structural environment of a node correlates with uncertainty in the estimation of the mutation probability.</p><p>The posterior marginal edge probabilities for the dataset, where an empty poset was used for simulation, ranged between 0 and $0.6 with the bulk being around 0.3 (<ref type="figure" target="#fig_8">Fig. 4</ref>bottom right). These numbers are similar for higher genotype numbers N. In order to obtain quasi-independent samples, further thinning is necessary as autocorrelation is still present. For example, in the N ¼ 100 and " ¼ 0.01 run, the lag-10 values for 4 and 9 are 0.07 and 0.05, respectively, while the lag-10 values for " and the log-posterior are 0.67 and 0.69, respectively. The lag-1000 values for " and the log-posterior are 0.007 and 0.05, respectively. The optimal thinning factor depends on the parameter of interest. Parameters with high-posterior variance show less autocorrelation than parameters with low posterior variance or the structure itself where we use the autocorrelation of the log-posterior (the worst autocorrelation of all quantities) as proxy.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.2">Performance increase over sampler with standard structure moves</head><p>We evaluated the performance increase of the sampling scheme including the new move types new transitive closure relation, delete transitive closure relation, event exchange and reincarnation by comparing it to the basic sampler using only standard structure moves. We changed the move selection probabilities as follows. The relocate theta MSP stays at 0.5, the new cover relation MSP is set to 0.25, the delete cover relation is set to MSP 0.15 and the relocate epsilon MSP stays at 0.1. Everything else is left identical to our proposed sampling scheme. We simulated data with the same setup as in Section 3.1 and tried to estimate the CBNs without using the new move types. The samplers completed different numbers of rounds within 5 days of running. Only one of the six standard-move runs converged within those 5 days, and this took 12 rounds of sampling. The runs with the newly introduced moves usually converged within two rounds, with the exception of one run, where it took five rounds (<ref type="figure">Table 1</ref>).</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.3">Application to real-world cancer data</head><p>We have analysed two cancer datasets. The first one consists of 251 renal cell carcinoma (RCC) cases, which have been analyzed by comparative genome hybridization (CGH), a method that detects chromosomal gains and losses (<ref type="bibr" target="#b15">Jiang et al., 2000</ref>mutagenetic trees and by<ref type="bibr" target="#b9">Gerstung et al. (2009)</ref>using ML estimation of Continuous Time CBNs resulted in a large disagreement between these two methods. We therefore reanalyzed this dataset and computed the marginal edge probabilities (<ref type="figure" target="#fig_9">Fig. 5A</ref>). Only three edges had posterior probabilities40.5, namely þ17q a þ17p (posterior 0.82), À4q a þ17q (0.73) and À4q a À6q (0.55). Furthermore, it is probable that À4q precedes À13q either directly or indirectly, because the marginal probability of this relation is 0.46, and for the relations À4q a À6q a À13q, we found the posterior probabilities 0.55 (as stated above) and 0.41, respectively. All four relationships have been identified by the two previous methods as either direct or indirect. However, both methods claim a number of additional dependencies which we found to have 50.5 posterior probability or they claim direct dependencies, as in the case with À4q and À13q, where there might only be an indirect one or vice versa. The second dataset we analyzed consists of 67 glioblastoma samples (<ref type="bibr" target="#b18">Parsons et al., 2008</ref>), in which 16 cancer genes have been DNA sequenced. Following<ref type="bibr" target="#b10">Gerstung et al. (2011)</ref>, we mapped mutated genes measured by sequencing to functional pathways, as defined by<ref type="bibr" target="#b16">Jones et al. (2008)</ref>, to infer order constraints on the level of pathways rather than genes. We did not filter out the secondary type cases as was done by<ref type="bibr" target="#b10">Gerstung et al. (2011).</ref>We identified eight cover relations with a posterior marginal edge probability 40.5 (<ref type="figure" target="#fig_9">Fig. 5B</ref>). Again, for some relations, it is unclear if they are indirect or direct dependencies. Therefore, we computed the marginal probabilities of all relations in the transitive closures of the posets (<ref type="figure" target="#fig_9">Fig. 5C</ref>). For example, the relation stating that mutation of the TGF-signalling pathway precedes mutation in the DNA damage control pathway has a posterior probability of 0.7. However, it is probably not a direct relation, but is mediated by either the Hedgehog signalling pathway or the JNK pathway.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4">DISCUSSION</head><p>In this work, we have presented a novel Bayesian inference scheme for CBNs, a probabilistic-graphical model of cancer progression that can be estimated from cross-sectional noisy genotype observations. We have developed an efficient MCMC sampling algorithm using a set of moves specifically designed to overcome local optima of dependency structures. The priors we used in our Bayesian approach are either non-informative or flat. Alternative priors can be used if one wants to introduce more prior biological knowledge, for example, about mutation probabilities, genotype calling errorsfor specific experimental setups or certain order relations that have been found independently. For practical purposes, our method is currently capable of handling up to $ 15 loci on a standard PC, where the actual run time depends critically on the number of compatible genotypes which are marginalized out Equation (3). Thus, the more closely the partial order dependency structure resembles a linear order, the smaller is the set of compatible genotypes and the faster can the marginal probability of the observed data be computed. In order to reduce the potentially large number of cancer driver mutations, one may apply filtering techniques based, for example, on marginal frequencies, on pairwise correlations or on more sophisticated methods for separating driver from passenger mutations. There is increasing evidence that rather than genewise, cancer progression may be more appropriately described on the level of functional pathways. The exact definition of these pathways is ongoing research, but initial studies suggest a small number of cancer-specific pathways on the order of a dozen (<ref type="bibr" target="#b13">Hanahan and Weinberg, 2011;</ref><ref type="bibr" target="#b16">Jones et al., 2008</ref>). The new move types introduced here can be applied to variations of the CBN model, including the Continuous Time CBN (<ref type="bibr" target="#b0">Beerenwinkel and Sullivant, 2009</ref>), which models waiting times of mutations and the Isotonic CBN (I-CBN) (<ref type="bibr" target="#b3">Beerenwinkel et al., 2011</ref>), which models monotonic progression along a continuous phenotype. We expect that the new move types we added for dealing with local optima of CBNs, especially the moves operating on the transitive closure, may also be useful for other types of Bayesian networks where the directions of all edges can be unambiguously assigned. Bayesian CBNs are more appropriate for predictive usage than their ML counterparts, since one can reliably assess the confidence of the inferred dependencies as well as the associated mutation probabilities. Drug development and treatment strategies that aim at blocking or hindering cancer progression by targeting certain mutation dependencies may benefit from increased interpretability of confidence assessments. For example, cancer genotypes are used for survival prediction and CBNs have been shown to significantly boost the performance of these predictions (<ref type="bibr" target="#b9">Gerstung et al., 2009;</ref><ref type="bibr" target="#b21">Rahnenfu¨hrerRahnenfu¨hrer et al., 2005</ref>). The reasonfor this improvement is that in predictions for individual patients, strength is borrowed from common features of cancer progression (such as order constraints) that can be learned by CBNs. Using the Bayesian CBN approach introduced here, one can account for model uncertainty in such predictions, for example, using Bayesian estimation of the Cox model. With international consortia such as TCGA or ICGC producing more and more whole cancer genome screens as well as next-generation sequencing moving into clinical diagnostics, the need for reliable and predictive modelling of genetic progression is growing. We anticipate that our sampling scheme will help to further advance the understanding of cancer progression.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>A B</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Conflict</head><p>of Interest: none declared.</p></div><figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_4"><head>Fig.1.</head><figDesc>Fig. 1. Move types used for sampling the structure space. (A) New/Delete cover relation exemplified between Nodes 2 and 3. (B) Event exchange move, performed on Nodes 2 and 3. (C) New/delete transitive closure relation. The center graph shows the transitive closure; the dotted edge between Nodes 2 and 3 is the one which is deleted/inserted. (D) Reincarnation move. The center graph is the intermediate poset.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_5"><head></head><figDesc>). Previous analyses of this dataset by Jiang et al. (2000) training Table 1. Summary of simulation runs for the poset displayed in Figure 2of sampling consists of 500 000 iterations per chain. (n.c. ¼ not converged). Details of the run from the fourth row are found in Figure 3.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_6"><head>Fig.2.</head><figDesc>Fig. 2. Poset used for generating data in the simulation study.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_7"><head>Fig.3.</head><figDesc>Fig. 3. Summary of sampled CBNs based on simulated data with N ¼ 100 cases and error probability " ¼ 0.01. (A) Top two rows present kernel density estimators for all mutation/error probabilities are shown. The dashed bar marks the mutation/error probabilities used for generating the data. The last density plot shows a kernel density estimator for the unnormalized log-posterior. Bottom two rows present trace plots of all mutation, error probabilities and the log-posterior for one of the four chains. Samples used for the trace plots are from the final sampling round. (B) The mode of the poset distribution and the posets with the second and third highest frequencies in the MCMC samples are show on the right.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_8"><head>Fig.4.</head><figDesc>Fig. 4. Marginal cover relation posterior probabilities based on simulated data from various runs. The incoming nodes on the Y-axis depend on the outgoing nodes on the X-axis.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_9"><head>Fig.5.</head><figDesc>Fig. 5. (A) Marginal cover relation posterior probabilities of renal cell carcinoma CGH data. (B) Marginal cover relation posterior probabilities of glioblastoma genotypes mapped to functional pathways. (C) Marginal posterior probabilities of transitive closure relations from glioblastoma genotypes mapped to functional pathways.</figDesc></figure>

			<note place="foot">ß The Author 2012. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oup.com. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>

			<note place="foot">Bayesian CBN at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>

			<note place="foot">T.Sakoparnig and N.Beerenwinkel at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>
		</body>
		<back>
			<div type="references">

				<listBibl>

<biblStruct   xml:id="b0">
	<analytic>
		<title level="a" type="main">Markov models for accumulating mutations</title>
		<author>
			<persName>
				<forename type="first">N</forename>
				<surname>Beerenwinkel</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">S</forename>
				<surname>Sullivant</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Biometrika</title>
		<imprint>
			<biblScope unit="volume">96</biblScope>
			<biblScope unit="page" from="1" to="7" />
			<date type="published" when="2009" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b1">
	<analytic>
		<title level="a" type="main">Learning multiple evolutionary pathways from cross-sectional data</title>
		<author>
			<persName>
				<forename type="first">N</forename>
				<surname>Beerenwinkel</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Comput. Biol</title>
		<imprint>
			<biblScope unit="volume">12</biblScope>
			<biblScope unit="page" from="584" to="598" />
			<date type="published" when="2004" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b2">
	<analytic>
		<title/>
		<author>
			<persName>
				<forename type="first">N</forename>
				<surname>Beerenwinkel</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Conjunctive Bayesian networks</title>
		<imprint>
			<date type="published" when="2007" />
			<biblScope unit="page" from="893" to="909" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b3">
	<analytic>
		<title level="a" type="main">Learning monotonic genotype-phenotype maps</title>
		<author>
			<persName>
				<forename type="first">N</forename>
				<surname>Beerenwinkel</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Stat. Appl. Genet. Molec. Biol</title>
		<imprint>
			<biblScope unit="volume">10</biblScope>
			<date type="published" when="2011" />
		</imprint>
	</monogr>
	<note>Article. 3</note>
</biblStruct>

<biblStruct   xml:id="b4">
	<analytic>
		<title level="a" type="main">Stability analysis of mixtures of mutagenetic trees</title>
		<author>
			<persName>
				<forename type="first">J</forename>
				<surname>Bogojeska</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">BMC Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">9</biblScope>
			<biblScope unit="page">165</biblScope>
			<date type="published" when="2008" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b5">
	<analytic>
		<title level="a" type="main">Inferring tree models for oncogenesis from comparative genome hybridization data</title>
		<author>
			<persName>
				<forename type="first">R</forename>
				<surname>Desper</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Comput. Biol</title>
		<imprint>
			<biblScope unit="volume">6</biblScope>
			<biblScope unit="page" from="37" to="51" />
			<date type="published" when="1999" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b6">
	<analytic>
		<title level="a" type="main">Distance-based reconstruction of tree models for oncogenesis</title>
		<author>
			<persName>
				<forename type="first">R</forename>
				<surname>Desper</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Comput. Biol</title>
		<imprint>
			<biblScope unit="volume">7</biblScope>
			<biblScope unit="page" from="789" to="803" />
			<date type="published" when="2000" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b7">
	<analytic>
		<title level="a" type="main">A genetic model for colorectal tumorigenesis</title>
		<author>
			<persName>
				<forename type="first">E</forename>
				<surname>Fearon</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">B</forename>
				<surname>Vogelstein</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Cell</title>
		<imprint>
			<biblScope unit="volume">61</biblScope>
			<biblScope unit="page" from="759" to="767" />
			<date type="published" when="1990" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b8">
	<monogr>
		<title level="m" type="main">Bayesian Data Analysis</title>
		<author>
			<persName>
				<forename type="first">A</forename>
				<surname>Gelman</surname>
			</persName>
		</author>
		<imprint>
			<date type="published" when="2004" />
			<pubPlace>Chapman &amp; Hall/CRC, Boca Raton, Florida</pubPlace>
		</imprint>
	</monogr>
	<note>2nd. edn</note>
</biblStruct>

<biblStruct   xml:id="b9">
	<analytic>
		<title level="a" type="main">Quantifying cancer progression with conjunctive Bayesian networks</title>
		<author>
			<persName>
				<forename type="first">M</forename>
				<surname>Gerstung</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">25</biblScope>
			<biblScope unit="page" from="2809" to="2815" />
			<date type="published" when="2009" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b10">
	<analytic>
		<title level="a" type="main">The temporal order of genetic and pathway alterations in tumorigenesis</title>
		<author>
			<persName>
				<forename type="first">M</forename>
				<surname>Gerstung</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">PLoS One</title>
		<imprint>
			<biblScope unit="volume">6</biblScope>
			<biblScope unit="page">27136</biblScope>
			<date type="published" when="2011" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b11">
	<analytic>
		<title level="a" type="main">Improving Markov chain Monte Carlo model search for data mining</title>
		<author>
			<persName>
				<forename type="first">P</forename>
				<surname>Giudici</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">R</forename>
				<surname>Castelo</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Mach. Learn</title>
		<imprint>
			<biblScope unit="volume">50</biblScope>
			<biblScope unit="page" from="127" to="158" />
			<date type="published" when="2003" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b12">
	<analytic>
		<title level="a" type="main">Improving the structure MCMC sampler for Bayesian networks by introducing a new edge reversal move</title>
		<author>
			<persName>
				<forename type="first">M</forename>
				<surname>Grzegorczyk</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">D</forename>
				<surname>Husmeier</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Mach. Learn</title>
		<imprint>
			<biblScope unit="volume">71</biblScope>
			<biblScope unit="page" from="265" to="305" />
			<date type="published" when="2008" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b13">
	<analytic>
		<title level="a" type="main">Hallmarks of cancer: the next generation</title>
		<author>
			<persName>
				<forename type="first">D</forename>
				<surname>Hanahan</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">R</forename>
				<forename type="middle">A</forename>
				<surname>Weinberg</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Cell</title>
		<imprint>
			<biblScope unit="volume">144</biblScope>
			<biblScope unit="page" from="646" to="674" />
			<date type="published" when="2011" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b14">
	<analytic>
		<title level="a" type="main">New probabilistic network models and algorithms for oncogenesis</title>
		<author>
			<persName>
				<forename type="first">M</forename>
				<surname>Hjelm</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Comput. Biol</title>
		<imprint>
			<biblScope unit="volume">13</biblScope>
			<biblScope unit="page" from="853" to="865" />
			<date type="published" when="2006" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b15">
	<analytic>
		<title level="a" type="main">Construction of evolutionary tree models for renal cell carcinoma from comparative genomic hybridization data</title>
		<author>
			<persName>
				<forename type="first">F</forename>
				<surname>Jiang</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Cancer Res</title>
		<imprint>
			<biblScope unit="volume">60</biblScope>
			<biblScope unit="page" from="6503" to="6509" />
			<date type="published" when="2000" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b16">
	<analytic>
		<title level="a" type="main">Core signaling pathways in human pancreatic cancers revealed by global genomic analyses</title>
		<author>
			<persName>
				<forename type="first">S</forename>
				<surname>Jones</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Science</title>
		<imprint>
			<biblScope unit="volume">321</biblScope>
			<biblScope unit="page" from="1801" to="1806" />
			<date type="published" when="2008" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b17">
	<analytic>
		<title level="a" type="main">Bayesian graphical models for discrete data</title>
		<author>
			<persName>
				<forename type="first">D</forename>
				<surname>Madigan</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">J</forename>
				<surname>York</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Int. Stat. Rev</title>
		<imprint>
			<biblScope unit="volume">63</biblScope>
			<biblScope unit="page" from="215" to="232" />
			<date type="published" when="1995" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b18">
	<analytic>
		<title level="a" type="main">An integrated genomic analysis of human glioblastoma multiforme</title>
		<author>
			<persName>
				<forename type="first">D</forename>
				<forename type="middle">W</forename>
				<surname>Parsons</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Science</title>
		<imprint>
			<biblScope unit="volume">321</biblScope>
			<biblScope unit="page" from="1807" to="1812" />
			<date type="published" when="2008" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b19">
	<analytic>
		<title level="a" type="main">Coda: convergence diagnosis and output analysis for mcmc</title>
		<author>
			<persName>
				<forename type="first">M</forename>
				<surname>Plummer</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">R News</title>
		<imprint>
			<biblScope unit="volume">6</biblScope>
			<biblScope unit="page" from="7" to="11" />
			<date type="published" when="2006" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b20">
	<analytic>
		<title level="a" type="main">Graph models of oncogenesis with an application to melanoma</title>
		<author>
			<persName>
				<forename type="first">M</forename>
				<forename type="middle">D</forename>
				<surname>Radmacher</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Theor. Biol</title>
		<imprint>
			<biblScope unit="volume">212</biblScope>
			<biblScope unit="page" from="535" to="548" />
			<date type="published" when="2001" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b21">
	<analytic>
		<title level="a" type="main">Estimating cancer survival and clinical outcome based on genetic tumor progression scores</title>
		<author>
			<persName>
				<forename type="first">J</forename>
				<surname>Rahnenfu¨hrerrahnenfu¨hrer</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">21</biblScope>
			<biblScope unit="page" from="2438" to="2446" />
			<date type="published" when="2005" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b22">
	<analytic>
		<title level="a" type="main">Estimating an oncogenetic tree when false negatives and positives are present</title>
		<author>
			<persName>
				<forename type="first">A</forename>
				<surname>Szabo</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">K</forename>
				<surname>Boucher</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Math. Biosci</title>
		<imprint>
			<biblScope unit="volume">176</biblScope>
			<biblScope unit="page" from="219" to="236" />
			<date type="published" when="2002" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b23">
	<analytic>
		<title level="a" type="main">The Cancer Genome Atlas Research Network (2011) Integrated genomic analyses of ovarian carcinoma</title>
	</analytic>
	<monogr>
		<title level="j">Nature</title>
		<imprint>
			<biblScope unit="volume">474</biblScope>
			<biblScope unit="page" from="609" to="615" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b24">
	<analytic>
		<title level="a" type="main">Markov chains for exploring posterior distributions</title>
		<author>
			<persName>
				<forename type="first">L</forename>
				<surname>Tierney</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Ann. Stat</title>
		<imprint>
			<biblScope unit="volume">22</biblScope>
			<biblScope unit="page" from="1701" to="1728" />
			<date type="published" when="1994" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b25">
	<analytic>
		<title level="a" type="main">Maximum likelihood estimation of oncogenetic tree models</title>
		<author>
			<persName>
				<forename type="first">A</forename>
				<surname>Von Heydebreck</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Biostatistics</title>
		<imprint>
			<biblScope unit="volume">5</biblScope>
			<biblScope unit="page" from="545" to="556" />
			<date type="published" when="2004" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b26">
	<analytic>
		<title level="a" type="main">Model selection for mixtures of mutagenetic trees</title>
		<author>
			<persName>
				<forename type="first">J</forename>
				<surname>Yin</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Stat. Appl. Genet. Molec. Biol</title>
		<imprint>
			<biblScope unit="volume">5</biblScope>
			<biblScope unit="page">17</biblScope>
			<date type="published" when="2006" />
		</imprint>
	</monogr>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>