
<?xml version="1.0" encoding="UTF-8"?>
<TEI xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 /home/joey/Project/grobid/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<encodingDesc>
			<appInfo>
				<application version="0.4.2-SNAPSHOT" ident="GROBID" when="2017-08-10T23:39+0000">
					<ref target="https://github.com/kermitt2/grobid">GROBID - A machine learning software for extracting information from scholarly documents</ref>
				</application>
			</appInfo>
		</encodingDesc>
		<fileDesc>
			<titleStmt>
				<title level="a" type="main">Sequence analysis SoDA2: a Hidden Markov Model approach for identification of immunoglobulin rearrangements</title>
			</titleStmt>
			<publicationStmt>
				<publisher/>
				<availability status="unknown"><licence/></availability>
				<date type="published" when="2010">2010</date>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author>
							<persName>
								<forename type="first">Supriya</forename>
								<surname>Munshaw</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department">Center for Computational Immunology</orgName>
							</affiliation>
							<affiliation key="aff1">
								<orgName type="department">Computational Biology and Bioinformatics Program</orgName>
								<orgName type="institution">Duke University</orgName>
								<address>
									<postBox>P.O. Box 90090</postBox>
								</address>
							</affiliation>
						</author>
						<author role="corresp">
							<persName>
								<forename type="first">Thomas</forename>
								<forename type="middle">B</forename>
								<surname>Kepler</surname>
							</persName>
							<email>kepler@duke.edu</email>
							<affiliation key="aff0">
								<orgName type="department">Center for Computational Immunology</orgName>
							</affiliation>
							<affiliation key="aff2">
								<orgName type="department">Department of Biostatistics and Bioinformatics</orgName>
								<address>
									<addrLine>2424 Erwin Road, Suite 1103</addrLine>
									<postCode>27705</postCode>
									<settlement>Durham</settlement>
									<region>NC</region>
									<country key="US">USA</country>
								</address>
							</affiliation>
						</author>
						<title level="a" type="main">Sequence analysis SoDA2: a Hidden Markov Model approach for identification of immunoglobulin rearrangements</title>
					</analytic>
					<monogr>
						<title level="j" type="main">BIOINFORMATICS ORIGINAL PAPER</title>
						<imprint>
							<biblScope unit="volume">26</biblScope>
							<biblScope unit="issue">7</biblScope>
							<biblScope unit="page" from="867" to="872"/>
							<date type="published" when="2010">2010</date>
						</imprint>
					</monogr>
					<idno type="DOI">10.1093/bioinformatics/btq056</idno>
					<note type="submission">Received on September 15, 2009; revised on February 3, 2010; accepted on February 4, 2010</note>
					<note>[14:32 17/3/2010 Bioinformatics-btq056.tex] Page: 867 867–872 Associate Editor: Limsoon Wong Contact:</note>
				</biblStruct>
			</sourceDesc>
		</fileDesc>
		<profileDesc>
			<abstract>
				<p>Motivation: The inference of pre-mutation immunoglobulin (Ig) rearrangements is essential in the study of the antibody repertoires produced in response to infection, in B-cell neoplasms and in autoimmune disease. Often, there are several rearrangements that are nearly equivalent as candidates for a given Ig gene, but have different consequences in an analysis. Our aim in this article is to develop a probabilistic model of the rearrangement process and a Bayesian method for estimating posterior probabilities for the comparison of multiple plausible rearrangements. Results: We have developed SoDA2, which is based on a Hidden Markov Model and used to compute the posterior probabilities of candidate rearrangements and to find those with the highest values among them. We validated the software on a set of simulated data, a set of clonally related sequences, and a group of randomly selected Ig heavy chains from Genbank. In most tests, SoDA2 performed better than other available software for the task. Furthermore, the output format has been redesigned, in part, to facilitate comparison of multiple solutions. Availability: SoDA2 is available online at https://hippocrates.duhs .duke.edu/soda. Simulated sequences are available upon request.</p>
			</abstract>
		</profileDesc>
	</teiHeader>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1">INTRODUCTION</head><p>B cells express immunoglobulin (Ig) molecules on their outer surface and secrete them into the extracellular space. Secreted Ig is known as antibody. The genes that encode for antibodies are generated by many diversifying mechanisms including combinatorial rearrangement of gene segments, addition of non-templated (n) nucleotides at the junctions, and somatic hypermutation. This circumstance presents the important challenge of inferring the components of the original rearrangement for any observed Ig gene. Because point mutations cause loss of information regarding the original rearrangement, there may be multiple plausible solutions. In this article, we present a Bayesian statistical method based on a Hidden Markov Model (HMM) that allows a complete statistical * To whom correspondence should be addressed. treatment of the problem by providing the posterior probability of each possible rearrangement. Antibodies serve as effector molecules that neutralize microbes by binding to exposed antigens and targeting them to other components of the immune system, such as phagocytic cells and complement, that effect clearance. Ig genes generate diversity in two stages: an antigen-independent and an antigen-dependent stage. Antigenindependent diversity is generated in the bone marrow, where B cells originate, by combinatorial rearrangement of gene segments and junctional diversity. Combinatorial diversity is created in a number of ways. First, each antibody molecule comprises one heavy-and one light-chain protein. Both the light-and heavy-chain genes are encoded by gene segments that are genetically rearranged during a process known as V(D)J recombination (<ref type="bibr" target="#b19">Sakano et al., 1980;</ref><ref type="bibr" target="#b23">Tonegawa, 1983</ref>). Heavy chains are made up of three gene segments—variable (VH), diversity (DH) and joining (JH) where as light chains only have a V and J segment. In humans, there are ∼50 known functional VH segments, 27 known functional DH segments, and six known functional JH segments (<ref type="bibr" target="#b13">LeFranc, 2001</ref>). This arrangement allows for ∼8100 combinations in the heavy chain alone. Humans also have two light-chain loci, κ (<ref type="bibr" target="#b14">Lorenz et al., 2001</ref>) and λ (<ref type="bibr" target="#b8">Frippiat et al., 1995</ref>). Only one of these loci is expressed per cell so that each antibody either has a κ light chain or a λ light chain. Humans have 44 functional Vκ, 5 Jκ, 33 Vλ genes and 5 Jλ (<ref type="bibr" target="#b13">LeFranc, 2001</ref>) resulting in 220 possible κ chains and 165 possible λ chains. Thus this combinatorial rearrangement alone allows for greater than 3 million antibodies. Junctional diversity is the result of multiple recombination site choices for each recombination event and the addition of n nucleotides. n nucleotides are sometimes added at the junction by terminal deoxynucleotidyl transferase (TdT) between adjoining gene segments (<ref type="bibr" target="#b4">Desiderio et al., 1984</ref>). Although TdT is believed to be expressed only in pro-B cells, the stage in which the heavy-chain rearrangement takes place (<ref type="bibr" target="#b4">Desiderio et al., 1984</ref>), the presence of n nucleotides in light chains has also been seen in a few studies (<ref type="bibr" target="#b2">Bridges, 1998</ref>). Antigen-dependent diversity is generated by somatic hypermutation in the periphery in a manner dependent on activationinduced cytidine deaminase (AID); during this process, mutations in the Ig genes are accumulated at rate of up to 10 6 times the normal background rate (<ref type="bibr" target="#b17">Muramatsu et al., 2000</ref>). B cells are subsequently selected for enhanced affinity for the eliciting antigen. It is estimated that these processes of diversification can generate ∼10 12 different antibodies making it challenging to correctly identify the underlying<ref type="bibr">[</ref></p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>S.Munshaw and T.B.Kepler</head><p>germline gene segments and subsequently the sequences of the complementarity determining regions (CDRs). The inference of the recombination and mutation events that produced a given Ig gene is of great importance in the study of humoral immunity and has been tackled in many different ways. The goal of such inference is to identify each of the component gene segments used as well as the recombination sites, point mutations and n nucleotides. The aligned gene segments usually overlap, which is why alignments of the target gene to the individual gene segments cannot be treated as independent. Somatic mutations, n nucleotide addition and recombination site choice make this task more challenging. The short length of the DH gene segment makes it especially difficult to identify the CDR3 region of the heavy chain, which is the most diverse region in the antibody sequence. This leads to many possible gene segment combinations that can result in a given antibody gene. Hence, it is necessary to report all such rearrangements and assign a probability to each of the combinations, making it easy to compare all possible rearrangements. Several algorithms have been developed for inferring Ig gene segment composition. IMGT/V-QUEST is one of the first and most complete of these tools and has the ability to analyze both Ig and TCR sequences for a variety of organisms including human and mouse (<ref type="bibr" target="#b10">Guidicelli et al., 2004</ref>). V-QUEST, however, is based on the BLAST algorithm; it does not guarantee finding the best alignment of two sequences (<ref type="bibr" target="#b0">Altschul et al., 1990</ref>). Additionally, the implementation of the algorithm only allows for running a maximum of 50 sequences at a time. Another tool, JOINSOLVER, is based on the identification of conserved motifs in the target gene (<ref type="bibr" target="#b22">Souto-Carneiro et al., 2004</ref>). Both JOINSOLVER and V-QUEST provide multiple gene segment possibilities but the implementation only provides junction analysis for the topmost choice. Somatic diversification analysis (SoDA) (<ref type="bibr" target="#b24">Volpe et al., 2006</ref>) uses a 3D alignment algorithm that allows for insertions and deletions. The algorithm uses dynamic programming and is an extension of the Smith–Waterman local alignment algorithm (<ref type="bibr" target="#b21">Smith and Waterman, 1981</ref>). The 3D alignment allows for a continuous alignment through all the states of the recombination. SoDA infers only a single highestscoring alignment, and ignores other solutions that may have equal or nearly equal scores. SoDA's guarantee of optimality in the inferred rearrangement is obtained at the cost of computational effort; SoDA takes more CPU time than either JOINSOLVER or V-QUEST. A major shortcoming for all the programs above is that they do not provide a meaningful comparison of the different possible rearrangements. iHMMune-align (<ref type="bibr" target="#b9">Gaeta et al., 2007</ref>) partially solves the problem and provides a probabilistic model using an HMM to infer the rearrangement. iHMMune-align uses the Viterbi algorithm (<ref type="bibr" target="#b18">Rabiner, 1989</ref>) to find the most probable path through the alignment matrix, but does not sum over paths or provide results on suboptimal alignments. This choice becomes an issue when selecting an appropriate DH gene segment for Ig heavy chains. The DH gene is the shortest of all gene segments, and is typically the most difficult to align. We have found Ig genes that present an equally good alignment with different DH genes (see Results section and<ref type="figure" target="#fig_5">Figure 5</ref>). iHMMune-align or SoDA gives only the solution with the highest score even if the highest score is not significantly better than the second highest score and so on (iHMMune-align does provide the option of viewing the top 10 VH gene alignments, but not DH). Among these four methods, only SoDA allows for gaps when performing alignments, although insertions and deletions are known to occur at non-negligible frequencies during somatic hypermutation (<ref type="bibr" target="#b20">Smith et al., 1996</ref>), and alignment without gaps when gaps are present leads to dramatically erroneous inferences. The method we are introducing here is an update of SoDA— we call it SoDA2. It employs a probability mass function-based alignment for determining gene segments and a probabilistic HMM for the inference of CDR3. The system calculates the posterior probability over all paths using a particular set of gene segments by the forward and backward algorithms. It then provides the alignment path with the highest posterior probability. If the sequence does not hold enough information to unambiguously select a gene segment, SoDA2 reports all alignments that do not differ significantly. We tested this method using a simulated dataset constructed from the statistics of observed rearrangements and compared these results with those obtained using existing methods. We also used two natural datasets, a set of clonally related Ig genes and a random set of sequences from NCBI. Each test indicates that SoDA2 provides the most thorough and accurate results among all programs in addition to providing the most statistically complete results.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2">METHODS</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.1">Determining the type of Ig</head><p>The first step consists of aligning the target sequence with a consensus-like sequence of the VH, Vκ and Vλ families to determine if the input sequence is a heavy, kappa or lambda chain. These consensus sequences are pre-created by separate alignments of the VH, Vκ and Vλ segments. We use the AHO numbering scheme (<ref type="bibr" target="#b11">Honegger and Plückthun, 2001</ref>) which is based on the spatial alignment of known 3D structures of Ig domains. The gaps are placed to minimize the average deviation from the averaged structure of the aligned domain so that the position of the CDRs remains consistent. The consensus is represented by a probability mass function (pmf), a L × 5 matrix where L is the length of the V genes in this case (<ref type="bibr">Kepler et al.,</ref>submitted for publication). For each nucleotide position in the gene, we determine the frequency of use for each nucleotide state (including 'gap') at that position in the family. For the target antibody, we create a similar pmf using the quality scores of the input sequence. The quality score is proportional to the log probability of the estimated sequencing error and is provided by the user's base-calling software (<ref type="bibr" target="#b6">Ewing and Green, 1998</ref>). If quality scores are not provided, we treat the input sequence as well-determined and all mismatches as due to somatic mutation. The pmf at each position of the target sequence depends on the quality score, which varies at each position, and a mutation frequency µ which is assumed to be constant over positions. For each position, we then have the probability of observing the five bases (including a gap) at that position given the quality score and the mutation frequency. We use the pmf of the target antibody gene and the pmf of the VH, Vκ and Vλ sequences as scores to create a local alignment (<ref type="bibr">Kepler et al.,</ref>submitted for publication;<ref type="bibr" target="#b21">Smith and Waterman, 1981</ref>).</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.2">V and J gene pre-alignment</head><p>Assume, for example, that our target sequence has been determined to be a heavy chain. We use the trace-back path generated by aligning the pmf of VH to our target and obtain the likelihood for each member of the VH family. The mutation frequency µ is recalculated after observing mismatches in the highest scoring alignment. All VH segments with equally high likelihood alignments are then submitted to the HMM. The position of the invariant cysteine is determined. The target sequence is then aligned past the invariant cysteine with all the appropriate JH segments, using the pmf-based alignment mentioned above. The JHs with the highest likelihood are selected for submission to the HMM. The target sequence is further trimmed at the invariantPage: 869 867–872tryptophan/phenylalanine, and only the remaining region, CDR3, is used as our target sequence for the HMM. The 3 ends (post-invariant cysteine) of all significant VH gene segments and the 5 ends (before invariant tryptophan/phenylalanine) of all JH segments from the pre-alignment are also chosen for the HMM. Since DH segments are most difficult to identify, we submit all DH segments to the HMM. The mutation frequency of the final trimmed target sequence to be considered for the HMM is set at 1.5 µ since the CDR3 region is subject to higher mutation than the VH region (<ref type="bibr" target="#b3">Cowell et al., 1999;</ref><ref type="bibr" target="#b9">Gaeta et al., 2007</ref>).<ref type="figure" target="#fig_1">Figure 1</ref>shows the basic set-up of the HMM for heavy chains (<ref type="figure" target="#fig_1">Fig. 1a</ref>) and light chains (<ref type="figure" target="#fig_1">Fig. 1b</ref>) with an overview of the states and allowed transitions.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>SoDA2: identification of immunoglobulin rearrangements</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.3">HMM</head><p>We implemented a pair HMM with 10 non-silent states—match/mistmatch state in V gene, insertion in V gene (Iv), deletion in V gene (Dv), V–D junction n nucleotides, match/mismatch in DH gene, insertion in the DH gene (Id), deletion in the DH gene (Dd), D–J junction n nucleotides, match/mismatch in the J gene, insertion in the J gene (Ij) and deletion in the J gene (Dj). Our HMM must begin in the match/mismatch state of the V gene since the invariant cysteine is encoded by the V. The end state must be match/mismatch in the J gene at the beginning of the invariant tryptophan/phenylalanine. The emission probabilities in every state are determined by the pmf calculated using the quality scores and the mutation rate µ. For target sequences with unknown quality scores, high-quality scores are assumed, making the probability of the observed base depend only on µ. Emission probabilities for the n nucleotide states are determined based on empirical data (<ref type="bibr" target="#b1">Basu et al., 1983</ref>). Transition probabilities between states are determined by fitting a negative binomial distribution to the recombination site choice for VH, DH and JH and number of n nucleotides in the junctions as determined in a set of 293 unmutated sequences rearranged sequences (<ref type="figure" target="#fig_2">Fig. 2</ref>,<ref type="bibr" target="#b12">Jackson et al., 2004</ref>).<ref type="figure" target="#fig_3">Figure 3</ref>shows a detailed implementation of the HMM with transition probabilities.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.4">Algorithm</head><p>Once we have the appropriately trimmed target and germline sequences, we calculate the log of the total probability of a proposed rearrangement using the forward and backward algorithms (<ref type="bibr" target="#b5">Durbin et al., 1998;</ref><ref type="bibr">Majoras, 2007</ref>). We select the gene segments that lead to the highest posterior probabilities, and perform a posterior Viterbi algorithm with traceback (<ref type="bibr" target="#b7">Fariselli et al., 2005</ref>) to select the path with the highest posterior probability for each possible rearrangement. We report the probability of the most probable path for each of the equally probable gene segment sets. For a heavy chain, a DH gene alignment of &lt;3 nt is flagged as 'unreliable D alignment'. The functionality of an antibody gene is determined as follows and reported with the results. A functional Ig chain must have no stop codons and the invariant cysteine<ref type="bibr" target="#b12">Jackson et al., 2004</ref>). The star denotes the start (third position of invariant cystiene) of the HMM and the + denotes the end (first position of invariant tryptophan/phenylalanine). The I and D in every state stand for insertions and deletions, respectively. at the start of CDR3 must be in-frame and intact. For heavy chains, the invariant tryptophan at the end of CDR3 must be in-frame and intact; for light chains, CDR3 must end with an in-frame and intact phenylalanine. We provide color-coded output in HTML, text and excel formats to allow the user to use the information in ways most convenient to his or her needs.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3">RESULTS</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.1">Simulated datasets</head><p>We created simulated datasets of 100 sequences each with mutation frequencies of 2.5, 5, 10 and 20%. Recombination site choice and number of n nucleotides for these simulations were drawn from a negative binomial distribution. To avoid any bias towards our HMM, the parameters for these simulations were estimated using a set of 662 sequences obtained from Genbank. Furthermore, rearrangements for these sequences were determined Page: 870 867–872using IMGT/VQuest (<ref type="bibr" target="#b10">Guidicelli et al., 2004</ref>) rather than SoDA or SoDA2. IMGT Junction Analysis was used to determine empirical data for deriving the distributions (<ref type="bibr" target="#b16">Monod et al., 2004</ref>). Mutations were introduced such that the average mutation frequency across the gene was 2.5, 5, 10 and 20%, and the mutation frequency in the CDRs was 2× than that in the framework. Each of these datasets was used to test SoDA2, SoDA, IMGT/VQuest, JOINSOLVER and iHMMune-align. Inverted D segments were omitted from the simulations because IMGT/VQuest and iHMMune-align do not allow for alignments against them.<ref type="figure" target="#tab_1">Table 1</ref>shows the results of running our simulated datasets using the various available software. The table shows the number of rearrangements (all VH, DH and JH with alleles) identified correctly at each mutation rate by each program out of the 100 sequences tested in each group. For all our tests, we only compare the highest scoring rearrangement provided by SoDA2 with the highest scoring ones provided by other programs. For our simulated data, we see that SoDA2 performs better in identifying the complete rearrangement (including correct alleles) than other programs under all mutation rates (<ref type="figure" target="#tab_1">Table 1</ref>). In particular, SoDA2 outperforms all other programs in DH segment identification (<ref type="figure" target="#tab_2">Table 2</ref>). SoDA2 falls slightly behind IMGT/V-Quest in VH and JH gene identification due to the trade-off between accuracy and efficiency. We employ a computationally efficient alignment algorithm that aligns the target gene to consensus sequences of alleles, which can lead to the identification of the incorrect allele in a very few cases. Aligning the target gene to every allele would decrease this error but increase computation time significantly. Such errors are seen rarely and do not change the overall superior performance of SoDA2 shown in<ref type="figure" target="#tab_1">Table 1</ref>. If the score for multiple rearrangements is equal for any of the programs, all rearrangements are considered. Although SoDA2s performance falls at the 20% mutation rate, it still performs better than other software. We only report all alignments that are equally probable and leave it up to the user to select and view any number of V, J or complete alignments he or she wants. For sequences where SoDA2 failed to identify the correct rearrangement as the most probable one, we found a median difference of 0.67 in the natural log of the probability between the highest scoring rearrangement and the correct one at the 5% mutation rate. Thus, if allowed to include rearrangements with low differences (&lt;1) in the natural log of the probability from the top scoring alignment, SoDA2 would have identified correct rearrangements for 22 additional sequences at the 5% mutation rate, yielding a possible 87% success rate.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>S.Munshaw and T.B.Kepler</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.2">Clonally related datasets</head><p>In order to test real biological data, we used two clonally related datasets that were used to test iHMMune-align (<ref type="bibr" target="#b9">Gaeta et al., 2007</ref>) derived from tonsilar IgD class-switched B cells (<ref type="bibr" target="#b25">Zheng et al., 2004</ref>). Because they are clonally related, sequences within a given set should have identical rearrangements and differ only by somatic mutation. We analyzed this dataset using VQuest, JOINSOLVER, SoDA and iHMMune-align to determine the number of times each of the programs resulted in the same rearrangement as was done by<ref type="bibr" target="#b9">Gaeta et al. (2007)</ref>. We ran the sequences through all the programs and found that iHMMune-align selected 47/57 identical rearrangements for the first group of sequences, while SoDA2 selected 34/57 identical rearrangements. IMGT/VQuest, JOINSOLVER and SoDA identified 37, 25 and 18 identical rearrangements, respectively. SoDA2 returned a minority DH gene segment in 17 cases, a minority JH allele in five cases, and a minority VH allele in four cases. In cases where SoDA2 failed to select the majority VH or JH gene segment, all the other programs, including iHMMune-align also failed to select the majority gene segment. It can be seen in these cases that mutation had obliterated the information necessary to make the correct inference. For the 17 cases where SoDA2 did not return the majority DH segment, the DH segment that was returned was typically judged more probable than the majority segment due to the balancing of n-nucleotide use and mutations. An example of this phenomenon is the inference for AF262199 (<ref type="figure" target="#fig_4">Fig. 4</ref>). In this case, the mutation frequency in the VH gene segment is ∼7%. SoDA2 selects IGHD1∼26*01 requiring three mutations (8.5% mutation frequency in CDR3) and seven n-nucleotides, while IGHD7∼27*01 requires two mutations (5.5% mutation frequency) and 10 n-nucleotides. For the second dataset of 99 sequences, both iHMMune-align and SoDA2 identified 68/99 identical rearrangements while IMGT/VQuest, JOINSOLVER and SoDA identified 56, 41 and 37 identical rearrangements, respectively.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.3">Sequences from Genbank</head><p>We tested a set of 662 sequences collected from Genbank and previously used for testing iHMMune-align and SoDA (Genbank accession nos Z68345-487 and Z80363-770). Out of 662 sequences, 113 produced inferences on which all five programs agreed. There was no agreement from any of the programs on 140 sequences. This means that they either could not infer a rearrangement at all or they all differed in their inference. From the rest, SoDA2 agreed with the majority of the programs on 300 rearrangements (<ref type="figure" target="#tab_3">Table 3</ref>). These did not include those where SoDA and SoDA2 were the only Page: 871 867–872two in agreement and the chosen rearrangement was the majority. SoDA2 performs considerably better than other programs in this test. We closely examined sequences for which SoDA2 failed to agree with two or more programs. We found a median difference of 1.05 between the top scoring rearrangement and the majority rearrangement. We also found that in all cases, SoDA2 selected an alternative rearrangement equally likely as the majority one.<ref type="figure" target="#fig_5">Figure 5</ref>shows an example of one such sequence where SoDA2 selected IGHD2∼21*01 to be the best fitting DH alignment with a score of −785.07 (<ref type="figure" target="#fig_5">Fig. 5a</ref>). On allowing alignments with a slightly higherprobability, we found both the rearrangement chosen by the majority of the programs (VQuest, JOINSOLVER and iHMMune-align,<ref type="figure" target="#fig_5">Fig. 5b</ref>) and also the rearrangement selected by SoDA (<ref type="figure" target="#fig_5">Fig. 5c</ref>). The difference in the natural log of the probability is 0.63 in the first case and 0.93 in the second. This shows that allowing rearrangements within a reasonable range of probabilities in SoDA2 would give an accurate and thorough picture of the various rearrangements possible for a given Ig sequence. It is important to note that SoDA2 considers factors such as recombination site choices for each gene segment and numbers of n nucleotides at both junctions derived from empirical data in inferring rearrangements while alignment algorithms used by SoDA, VQuest and JOINSOLVER base their results on sequence similarity matrices which may not accurately represent the process of V(D)J recombination.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>SoDA2: identification of immunoglobulin rearrangements</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4">CONCLUSION</head><p>The problem of inferring the correct rearrangement for antigen receptors is difficult due to the stochastic nature of the process, but the task is important for an increased understanding of the population somatic genetics of the immune response. In this paper we present a method based on an HMM that provides a statistical basis for identifying rearrangements of Ig genes. In addition to providing the posterior probability of the top rearrangement candidate, SoDA2 also provides the user with an option to see all rearrangements with sufficiently high posterior probabilities, thus giving the user a statistically complete picture of the observed sequence's origins. We tested SoDA2 against simulated datasets that were created using empirically observed recombination site choices for each of the gene segments and numbers of n nucleotides in the junctions. We also tested it on two clonally-related datasets as well as a set of Ig heavy chains chosen randomly from Genbank. Our software performed as well as or better than available software on two out of three validation tests. The one test where SoDA did not outperform all of the others involved a single rearrangement. On the identical test with a different rearrangement, SoDA did as well as its nearest competitor. It is important to realize that the key feature of this article is to provide a tool based entirely on a probability model, and that therefore returns results interpretable as posterior probabilities rather than arbitrary scores. As with other inferential procedures, it is important to not only identify the optimal solution, but to identify near-optimal solutions and have a</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>S.Munshaw and T.B.Kepler</head><p>method for the absolute comparison among these alternatives. This performance and thorough result reporting leads to a substantially longer computation time. SoDA2 takes ∼15 s of real user time per set of V and J segment for a given heavy target sequence on a 64 bit machine with a 2.19 GHz processor and 4 GB RAM, but the investment of computational effort seems worthwhile.</p></div><figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_0"><head></head><figDesc>[14:32 17/3/2010 Bioinformatics-btq056.tex]</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_1"><head>Fig.1.</head><figDesc>Fig. 1. The basic topology of the HMM for (a) heavy chains and (b) kappa and lambda chains. The HMM starts at the last base of the invariant cysteine of all high-likelihood V segments, runs through all DH segments in the case of heavy chains, and through all high-likelihood J segments till the first base of the invariant tryptophan or phenylalanine.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_2"><head>Fig.2.</head><figDesc>Fig. 2. Distributions for (a) VH gene recombination site choice, (b) n nucleotides in the VD junction, (c) 5 DH recombination site choice, (d) 3 DH recombination site choice, (e) n nucleotides in the DJ junction, (f) 5 JH recombination site choice. All the data is fit to negative binomial distributions with varying parameters derived from Jackson et al. (2004). These parameters are used for transition probabilities in the HMM.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_3"><head>Fig.3.</head><figDesc>Fig. 3. Shows a detailed topology of the HMM with all possible transitions. Each nucleotide in the observed sequence is treated as a separate state. The transition probabilities are derived from empirical data (Jackson et al., 2004). The star denotes the start (third position of invariant cystiene) of the HMM and the + denotes the end (first position of invariant tryptophan/phenylalanine). The I and D in every state stand for insertions and deletions, respectively.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_4"><head>Fig.4.</head><figDesc>Fig. 4. (a) Top rearrangement as chosen by SoDA2 with a higher mutation frequency than the alternative, shown in (b). The different rearrangements represent a trade-off between mutation frequency and number of n nucleotides.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_5"><head>Fig.5.</head><figDesc>Fig. 5. The alignment of CDR3H of sequence by 1154693 using IGHD1-21*01 by (a) SoDA2, (b) IMGT/V-QUEST, JOINSOLVER and iHHMune, (c) SoDA. Rearrangements (b) and (c) were also provided by SoDA2 at a slightly lower probability.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_1" validated="true"><figDesc>Table 1. Number of correct rearrangements (correct gene and allele for VH, DH and JH segments) identified by each software out of 100 sequences tested at each mutation rate</figDesc><table>2.50% 
5% 
10% 
20% 

SoDA2 
73 
65 
47 
28 
IMGT/V-QUEST 
52 
47 
42 
16 
JOINSOLVER 
59 
47 
34 
11 
iHMMune-align 
41 
31 
22 
12 
SoDA 
46 
30 
31 
6 

</table></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_2" validated="false"><figDesc>Table 2.</figDesc><table>Number of VH, DH and JH genes (with alleles) identified at each 
mutation rate for the simulated sequences 

2.5% 
5% 
10% 
20% 

V D J 
V D J 
V D J 
V D J 

SoDA2 
97 76 98 94 73 94 87 58 88 85 42 78 
JOINSOLVER 
90 65 98 83 61 92 81 42 85 72 20 76 
IMGT/Vquest 
99 52 94 97 49 93 93 45 89 88 23 82 
SoDA 
79 65 92 77 68 87 76 42 69 69 20 45 
iHMMune-align 87 48 90 86 42 87 78 32 86 69 21 61 

</table></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_3" validated="false"><figDesc>Table 3.</figDesc><table>Results from 662 sequences from Genbank, showing the 
performance of the five programs 

Number of 
rearrangements 

All programs agree 
113 
All programs disagree 
140 
SoDA2 agrees with two or more programs 
300 
VQuest agrees with two or more programs 
255 
iHMMune-align agrees with two or more 
programs 

137 

JOINSOLVER agrees with two or more 
programs 

272 

SoDA agrees with two or more programs 
244 
SoDA2 agrees only with SoDA (no other 
programs agree) 

11 

If two or more programs displayed the same rearrangement (including the alleles), it 
was believed to be the majority rearrangement. 

</table></figure>

			<note place="foot">at :: on August 31, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>

			<note place="foot" n="872"> at :: on August 31, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>
		</body>
		<back>

			<div type="acknowledgement">
<div xmlns="http://www.tei-c.org/ns/1.0"><head>ACKNOWLEDGEMENTS</head></div>
			</div>

			<div type="references">

				<listBibl>

<biblStruct   xml:id="b0">
	<analytic>
		<title level="a" type="main">Basic local alignment tool</title>
		<author>
			<persName>
				<forename type="first">S</forename>
				<forename type="middle">F</forename>
				<surname>Altschul</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Mol. Biol</title>
		<imprint>
			<biblScope unit="volume">215</biblScope>
			<biblScope unit="page" from="403" to="410" />
			<date type="published" when="1990" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b1">
	<analytic>
		<title level="a" type="main">Synthesis of compositionally unique DNA by terminal deoxynucleotidyl transferase</title>
		<author>
			<persName>
				<forename type="first">M</forename>
				<surname>Basu</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Biochem. Biophys. Res. Commun</title>
		<imprint>
			<biblScope unit="volume">111</biblScope>
			<biblScope unit="page" from="1105" to="1112" />
			<date type="published" when="1983" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b2">
	<analytic>
		<title level="a" type="main">Frequent N addition and clonal relatedness among immunoglobulin lambda light chains expressed in rheumatoid arthritis synovia and PBL, and the influence of V lambda gene segment utilization on CDR3 length</title>
		<author>
			<persName>
				<forename type="first">S</forename>
				<forename type="middle">L</forename>
				<surname>Bridges</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Mol. Med</title>
		<imprint>
			<biblScope unit="volume">4</biblScope>
			<biblScope unit="page" from="525" to="553" />
			<date type="published" when="1998" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b3">
	<analytic>
		<title level="a" type="main">Enhanced evolvability in immunoglobulin V genes under somatic hypermutation</title>
		<author>
			<persName>
				<forename type="first">L</forename>
				<forename type="middle">G</forename>
				<surname>Cowell</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Mol. Evol</title>
		<imprint>
			<biblScope unit="volume">49</biblScope>
			<biblScope unit="page" from="23" to="26" />
			<date type="published" when="1999" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b4">
	<analytic>
		<title level="a" type="main">Insertion of N regions into heavy-chain genes is correlated with the expression of terminal deoxytransferase in B-cells</title>
		<author>
			<persName>
				<forename type="first">S</forename>
				<forename type="middle">V</forename>
				<surname>Desiderio</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nature</title>
		<imprint>
			<biblScope unit="page" from="311" to="752" />
			<date type="published" when="1984" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b5">
	<monogr>
		<title level="m" type="main">Pairwise alignment using HMMs Biological Sequence Analysis: Probabilistic Models of Proteins and Nucleic Acids</title>
		<author>
			<persName>
				<forename type="first">R</forename>
				<surname>Durbin</surname>
			</persName>
		</author>
		<editor>Durbin,R.</editor>
		<imprint>
			<date type="published" when="1998" />
			<publisher>Cambridge University Press</publisher>
			<biblScope unit="page" from="80" to="99" />
			<pubPlace>Cambridge, UK</pubPlace>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b6">
	<analytic>
		<title level="a" type="main">Basecalling of automated sequencer traces using phred. II. Error probabilities</title>
		<author>
			<persName>
				<forename type="first">B</forename>
				<surname>Ewing</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">P</forename>
				<surname>Green</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Genome Res</title>
		<imprint>
			<biblScope unit="volume">8</biblScope>
			<biblScope unit="page" from="186" to="194" />
			<date type="published" when="1998" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b7">
	<analytic>
		<title level="a" type="main">A new decoding algorithm for hidden Markov models improves the prediction of the topology of all-beta membrane proteins</title>
		<author>
			<persName>
				<forename type="first">P</forename>
				<surname>Fariselli</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">BMC Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">6</biblScope>
			<biblScope unit="page">12</biblScope>
			<date type="published" when="2005" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b8">
	<analytic>
		<title level="a" type="main">Organization of the human immunoglobulin lambda lightchain locus on chromosome 22q11.2</title>
		<author>
			<persName>
				<forename type="first">J</forename>
				<forename type="middle">P</forename>
				<surname>Frippiat</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Human Mol. Genet</title>
		<imprint>
			<biblScope unit="volume">4</biblScope>
			<biblScope unit="page" from="983" to="991" />
			<date type="published" when="1995" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b9">
	<analytic>
		<title level="a" type="main">iHMMune-align: hidden Markov model-based alignment and identification of germline genes in rearranged immunoglobulin gene sequences</title>
		<author>
			<persName>
				<forename type="first">B</forename>
				<forename type="middle">A</forename>
				<surname>Gaeta</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">23</biblScope>
			<biblScope unit="page" from="1580" to="1587" />
			<date type="published" when="2007" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b10">
	<analytic>
		<title level="a" type="main">IMGT/V-QUEST, an integrated software program for immunoglobulin and T cell receptor V–J and V–D–J rearrangement analysis</title>
		<author>
			<persName>
				<forename type="first">V</forename>
				<surname>Guidicelli</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nucleic Acids Res</title>
		<imprint>
			<biblScope unit="volume">32</biblScope>
			<biblScope unit="page" from="435" to="440" />
			<date type="published" when="2004" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b11">
	<analytic>
		<title level="a" type="main">Yet another numbering scheme for immunoglobulin variable domains: an automatic modeling and analysis tool</title>
		<author>
			<persName>
				<forename type="first">A</forename>
				<surname>Honegger</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">A</forename>
				<surname>Plückthun</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Mol. Biol</title>
		<imprint>
			<biblScope unit="volume">309</biblScope>
			<biblScope unit="page" from="657" to="670" />
			<date type="published" when="2001" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b12">
	<analytic>
		<title level="a" type="main">Exonuclease activity and P nucleotide addition in the generation of the expressed immunoglobulin repertoire</title>
		<author>
			<persName>
				<forename type="first">K</forename>
				<forename type="middle">J</forename>
				<surname>Jackson</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">BMC Immunol</title>
		<imprint>
			<biblScope unit="volume">5</biblScope>
			<date type="published" when="2004" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b13">
	<analytic>
		<title level="a" type="main">IMGT, the international ImMunoGeneTics database</title>
		<author>
			<persName>
				<forename type="first">M</forename>
				<forename type="middle">P</forename>
				<surname>Lefranc</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nucleic Acids Res</title>
		<imprint>
			<biblScope unit="volume">29</biblScope>
			<biblScope unit="page" from="207" to="209" />
			<date type="published" when="2001" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b14">
	<analytic>
		<title level="a" type="main">Physical map of the immunoglobulin K locus and its implications for the mechanisms of VK-JK rearrangement</title>
		<author>
			<persName>
				<forename type="first">W</forename>
				<surname>Lorenz</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nucleic Acids Res</title>
		<imprint>
			<biblScope unit="volume">15</biblScope>
			<biblScope unit="page" from="9667" to="9676" />
			<date type="published" when="2001" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b15">
	<analytic>
		<title level="a" type="main">Hidden Markov Models</title>
		<author>
			<persName>
				<forename type="first">W</forename>
				<forename type="middle">H</forename>
				<surname>Majoros</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Methods for Computational Gene Prediction</title>
		<meeting><address><addrLine>Cambridge, UK</addrLine></address></meeting>
		<imprint>
			<publisher>Cambridge University Press</publisher>
			<date type="published" when="2007" />
			<biblScope unit="page" from="136" to="183" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b16">
	<analytic>
		<title level="a" type="main">IMGT/JunctionAnalysis: the first tool for the analysis of the immunoglobulin and T cell receptor complex V</title>
		<author>
			<persName>
				<forename type="first">M</forename>
				<forename type="middle">Y</forename>
				<surname>Monod</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">20</biblScope>
			<biblScope unit="page" from="379" to="385" />
			<date type="published" when="2004" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b17">
	<analytic>
		<title level="a" type="main">Class switch recombination and hypermutation require activation-induced cytidine deaminase (AID), a potential RNA editing enzyme</title>
		<author>
			<persName>
				<forename type="first">M</forename>
				<surname>Muramatsu</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Cell</title>
		<imprint>
			<biblScope unit="volume">102</biblScope>
			<biblScope unit="page" from="553" to="563" />
			<date type="published" when="2000" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b18">
	<analytic>
		<title level="a" type="main">A tutorial on hidden markov-models and selected applications in speech recognition</title>
		<author>
			<persName>
				<forename type="first">L</forename>
				<forename type="middle">R</forename>
				<surname>Rabiner</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proc. IEEE</title>
		<meeting>. IEEE</meeting>
		<imprint>
			<date type="published" when="1989" />
			<biblScope unit="page" from="257" to="286" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b19">
	<analytic>
		<title level="a" type="main">Two types of somatic recombination are necessary for the generation of complete immunoglobulin heavy-chain genes</title>
		<author>
			<persName>
				<forename type="first">H</forename>
				<surname>Sakano</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nature</title>
		<imprint>
			<biblScope unit="volume">286</biblScope>
			<biblScope unit="page" from="676" to="683" />
			<date type="published" when="1980" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b20">
	<analytic>
		<title level="a" type="main">Di-and trinucleotide target preferences of somatic mutagenesis in normal and autoreactive b cells</title>
		<author>
			<persName>
				<forename type="first">D</forename>
				<forename type="middle">S</forename>
				<surname>Smith</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Immunol</title>
		<imprint>
			<biblScope unit="volume">156</biblScope>
			<biblScope unit="page" from="2642" to="2652" />
			<date type="published" when="1996" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b21">
	<analytic>
		<title level="a" type="main">Identification of common molecular subsequences</title>
		<author>
			<persName>
				<forename type="first">T</forename>
				<forename type="middle">F</forename>
				<surname>Smith</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">M</forename>
				<forename type="middle">S</forename>
				<surname>Waterman</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Mol. Biol</title>
		<imprint>
			<biblScope unit="volume">147</biblScope>
			<biblScope unit="page" from="195" to="197" />
			<date type="published" when="1981" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b22">
	<analytic>
		<title level="a" type="main">Characterization of the human Ig heavy chain antigen binding complementarity determining region 3 using a newly developed software algorithm, JOINSOLVER</title>
		<author>
			<persName>
				<forename type="first">M</forename>
				<forename type="middle">M</forename>
				<surname>Souto-Carneiro</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Immunol</title>
		<imprint>
			<biblScope unit="volume">172</biblScope>
			<biblScope unit="page" from="6790" to="6802" />
			<date type="published" when="2004" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b23">
	<analytic>
		<title level="a" type="main">Somatic generation of antibody diversity</title>
		<author>
			<persName>
				<forename type="first">S</forename>
				<surname>Tonegawa</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nature</title>
		<imprint>
			<biblScope unit="volume">302</biblScope>
			<biblScope unit="page" from="575" to="581" />
			<date type="published" when="1983" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b24">
	<analytic>
		<title level="a" type="main">SoDA: implementation of a 3D alignment algorithm for inference of antigen receptor recombinations</title>
		<author>
			<persName>
				<forename type="first">J</forename>
				<forename type="middle">M</forename>
				<surname>Volpe</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">22</biblScope>
			<biblScope unit="page" from="438" to="444" />
			<date type="published" when="2006" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b25">
	<analytic>
		<title level="a" type="main">Human immunoglobulin selection associated with class switch and possible tolerogenic origins for C delta class-switched B cells</title>
		<author>
			<persName>
				<forename type="first">N</forename>
				<forename type="middle">Y</forename>
				<surname>Zheng</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Clin. Invest</title>
		<imprint>
			<biblScope unit="volume">113</biblScope>
			<biblScope unit="page" from="1188" to="1201" />
			<date type="published" when="2004" />
		</imprint>
	</monogr>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>