
<?xml version="1.0" encoding="UTF-8"?>
<TEI xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 /home/joey/Project/grobid/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<encodingDesc>
			<appInfo>
				<application version="0.4.2-SNAPSHOT" ident="GROBID" when="2017-08-10T23:44+0000">
					<ref target="https://github.com/kermitt2/grobid">GROBID - A machine learning software for extracting information from scholarly documents</ref>
				</application>
			</appInfo>
		</encodingDesc>
		<fileDesc>
			<titleStmt>
				<title level="a" type="main">Reconstruction of clonal trees and tumor composition from multi-sample sequencing data</title>
			</titleStmt>
			<publicationStmt>
				<publisher/>
				<availability status="unknown"><licence/></availability>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author>
							<persName>
								<forename type="first">Mohammed</forename>
								<surname>El-Kebir</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department">Center for Computational Molecular Biology and Department of Computer Science</orgName>
								<orgName type="institution">Brown University</orgName>
								<address>
									<postCode>02912</postCode>
									<settlement>Providence</settlement>
									<region>RI</region>
									<country key="US">USA</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Layla</forename>
								<surname>Oesper</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department">Center for Computational Molecular Biology and Department of Computer Science</orgName>
								<orgName type="institution">Brown University</orgName>
								<address>
									<postCode>02912</postCode>
									<settlement>Providence</settlement>
									<region>RI</region>
									<country key="US">USA</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Hannah</forename>
								<surname>Acheson-Field</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department">Center for Computational Molecular Biology and Department of Computer Science</orgName>
								<orgName type="institution">Brown University</orgName>
								<address>
									<postCode>02912</postCode>
									<settlement>Providence</settlement>
									<region>RI</region>
									<country key="US">USA</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Benjamin</forename>
								<forename type="middle">J</forename>
								<surname>Raphael</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department">Center for Computational Molecular Biology and Department of Computer Science</orgName>
								<orgName type="institution">Brown University</orgName>
								<address>
									<postCode>02912</postCode>
									<settlement>Providence</settlement>
									<region>RI</region>
									<country key="US">USA</country>
								</address>
							</affiliation>
						</author>
						<title level="a" type="main">Reconstruction of clonal trees and tumor composition from multi-sample sequencing data</title>
					</analytic>
					<monogr>
						<imprint>
							<date/>
						</imprint>
					</monogr>
					<idno type="DOI">10.1093/bioinformatics/btv261</idno>
					<note>*To whom correspondence should be addressed. † The authors wish it to be known that, in their opinion, the first two authors should be regarded as Joint First Authors. Availability and implementation: An implementation of AncesTree is available at: http://compbio. cs.brown.edu/software. Contact: braphael@brown.edu Supplementary information: Supplementary data are available at Bioinformatics online.</note>
				</biblStruct>
			</sourceDesc>
		</fileDesc>
		<profileDesc>
			<abstract>
				<p>Motivation: DNA sequencing of multiple samples from the same tumor provides data to analyze the process of clonal evolution in the population of cells that give rise to a tumor. Results: We formalize the problem of reconstructing the clonal evolution of a tumor using single-nucleotide mutations as the variant allele frequency (VAF) factorization problem. We derive a combinatorial characterization of the solutions to this problem and show that the problem is NP-complete. We derive an integer linear programming solution to the VAF factorization problem in the case of error-free data and extend this solution to real data with a probabilistic model for errors. The resulting AncesTree algorithm is better able to identify ancestral relationships between individual mutations than existing approaches, particularly in ultra-deep sequencing data when high read counts for mutations yield high confidence VAFs.</p>
			</abstract>
		</profileDesc>
	</teiHeader>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1">Introduction</head><p>Cancer is a disease resulting from somatic mutations that accumulate during an individual's lifetime and lead to uncontrolled growth of a collection of cells into a tumor. The clonal theory of cancer (<ref type="bibr" target="#b15">Nowell, 1976</ref>) predicts that all cells within a tumor have descended from a single founder cell and that subsequent clonal expansions occur from additional advantageous mutations. As a result, the cells within a tumor may differ in their complement of somatic mutations, with each cell being a descendant of a clone from a clonal expansion (<ref type="figure" target="#fig_2">Fig. 1A</ref>). High-coverage sequencing of tumor genomes allows one to study this intra-tumor heterogeneity by measuring the frequencies of mutations within a tumor (<ref type="bibr" target="#b1">Ding et al., 2012;</ref><ref type="bibr" target="#b14">Nik-Zainal et al., 2012;</ref><ref type="bibr" target="#b21">Shah et al., 2012</ref>). Characterization of intra-tumor heterogeneity and inference of the clonal evolutionary history of somatic mutations within a tumor provide useful insight in the tumor's development and may help inform treatment. Somatic mutations are typically measured in human solid tumors only at a single time point, when the patient undergoes surgery. Therefore, clonal evolution is not directly observed and one is faced with the problem of inferring the ancestral relationships between cells in a tumor from measurements at one time point. This is the problem of phylogenetic tree reconstruction, a well-studied problem. The direct application of phylogenetic methods requires that we measure mutations in individual cancer cells that correspond to the leaves (species) of the phylogenetic tree. However, because of technical limitations and financial considerations, single-cell sequencing of tumors remains uncommon (<ref type="bibr" target="#b12">Navin, 2014;</ref><ref type="bibr" target="#b23">Wang et al., 2014</ref>) with nearly all cancer sequencing studies—including studies such as TCGA and ICGC—sequencing a small number of samples from a bulk tumor, each containing potentially millions of cells. Thus, the data one obtains represent the mutations in a mixture of cells with potentially distinct evolutionary histories. Given sequencing data from a single sample, a number of methods have been developed to determine the set of clones and their frequencies in a tumor. Some methods analyze changes in the variant allele frequencies (VAFs) of single-nucleotide mutations; i.e. the fraction of tumor cells that contain each mutation (<ref type="bibr" target="#b11">Miller et al., 2014;</ref><ref type="bibr" target="#b19">Roth et al., 2014</ref>). Other approaches analyze differences in read depth due</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>i62</head><p>This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (http://creativecommons.org/licenses/by-nc/4.0/), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com<ref type="bibr">Bioinformatics, 31, 2015</ref>, i62–i70 doi: 10.1093/bioinformatics/btv261 ISMB/ECCB 2015 to copy number aberrations (<ref type="bibr" target="#b16">Oesper et al., 2013</ref><ref type="bibr" target="#b17">Oesper et al., , 2014</ref>). More detailed inference of clonal evolution from a single sample requires additional assumptions about the evolutionary process, such as parsimony (<ref type="bibr" target="#b6">Hajirasouliha et al., 2014;</ref><ref type="bibr" target="#b22">Strino et al., 2013</ref>). Recently, several studies have sequenced multiple samples from the same tumor. These studies measure somatic mutations in multiple spatially distinct regions from the same tumor at a single time point (<ref type="bibr" target="#b2">Gerlinger et al., 2012</ref><ref type="bibr" target="#b3">Gerlinger et al., , 2014</ref><ref type="bibr" target="#b13">Newburger et al., 2013;</ref><ref type="bibr" target="#b26">Zhang et al., 2014</ref>) or measure a tumor at multiple time points (<ref type="bibr" target="#b20">Schuh et al., 2012</ref>). Multi-sample data allow for the direct observation of branched evolution when mutations are present in only a subset of the sequenced samples. Although standard phylogenetic techniques have been used to construct trees that relate these samples, such trees do not directly show the relationships between mutations, as each sequenced sample may itself be a heterogeneous mixture of cells (<ref type="figure" target="#fig_2">Fig. 1B</ref>). Several methods have recently been introduced to infer tumor composition and evolution from VAFs of somatic mutations in multi-sample sequencing data. Clomial (<ref type="bibr" target="#b25">Zare et al., 2014</ref>) infers the set of clones present in the tumor and their frequencies in each sample but does not describe the evolutionary relationships between the clones. Three recent approaches infer a tree describing the evolutionary history of a tumor. PhyloSub uses a Bayesian approach to sample trees using a tree-structured process (<ref type="bibr" target="#b9">Jiao et al., 2014</ref>). CITUP (<ref type="bibr" target="#b10">Malikic et al., 2015</ref>) enumerates all rooted trees and for each one solves a quadratic program. LICHeE, which recently appeared on the arXiv preprint server (<ref type="bibr" target="#b18">Popic et al., 2014</ref>), uses a graph construction similar to one we describe below but does not provide a rigorous mathematical justification for it. All these approaches are data driven and focus on the construction and optimization of models that minimize the error between the observed and inferred mutation frequencies. However, they do not address the combinatorial structure of the problem. Stated more directly: given error-free VAF data, under what conditions is it possible to reconstruct the clonal evolution of a tumor? We formalize the problem of reconstructing the clonal evolution of a tumor as the VAF factorization problem (VAFFP). The input to this problem are the VAFs for individual somatic mutations from one or more samples. The problem is to determine the composition of each sample, including the number and proportion of clones in each, and a tree that describes the ancestral relationships between all clones under the infinite sites (perfect phylogeny) assumption.</p><p>We prove necessary and sufficient conditions for the VAFFP to have a solution in the case of error-free data. Using these conditions, we provide a combinatorial characterization of the space of all solutions. We show that the VAFFP is NP-complete and give an integer linear programming formulation. We extend the characterization and formulation to noisy data and use a graph clustering approach to cluster mutations by their putative ancestral relationships. We show that our resulting AncesTree algorithm is better able to identify ancestral relationships between individual mutations than existing approaches on simulated data. On real data, we highlight the advantages of our probabilistic model by comparing whole-exome and deep sequencing data from the same tumor, identifying successive clonal expansions and diverse mixing of clones within sequenced samples.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2">Methods</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.1">Model for clonal evolution and inference</head><p>In this section, we describe a model for the accumulation of singlenucleotide somatic mutations in a tumor and the generation of sequencing data from the tumor. This leads us to the definition of the VAFFP at the conclusion of the section. Following the clonal theory of cancer, we assume that all cancer cells in a tumor are descendants of a single founding clone; i.e. the tumor is monoclonal. In this work, we model only somatic singlenucleotide mutations and assume that these are unaffected by copy number aberrations or rearrangements in the cancer genome. We will use mutation to refer specifically to these events. We assume, as in previous work (<ref type="bibr" target="#b6">Hajirasouliha et al., 2014;</ref><ref type="bibr" target="#b9">Jiao et al., 2014;</ref><ref type="bibr" target="#b10">Malikic et al., 2015</ref>), that mutations satisfy the infinite sites assumption, which states that a mutation occurs at a single genomic position, or locus, at most once during the clonal evolution of the tumor. We encode the state of a specific locus in a clone as a binary value—where 1 indicates a somatic mutation at that position and 0 indicates no mutation. Thus, each clone corresponds to a binary vector in f0; 1g n , where n is the total number of loci affected by mutations. Under these assumptions, the ancestral relationships between clones are described by a phylogenetic tree where (i) vertices represent different tumor clones that have existed during the tumor's evolution and (ii) edges represent the direct ancestral relationships between clones and are labeled with the mutation(s) that<ref type="figure" target="#fig_2">Fig. 1</ref>. Model for clonal evolution and inference. (A) An example of the evolution of a tumor containing seven distinct clones. Passenger mutations (white) occurring before the first clonal expansion will be indistinguishable from mutations driving the growth of the founding clone (light blue). Each subsequent mutation (green, purple, dark blue, orange, red and tan) creates a new clone. (B) Three sequenced tumor samples. Some clones may no longer exist at the time of sequencing (orange). Samples 1 and 2 each contain a single clone (purple and blue respectively), whereas Sample 3 is a mixture of three clones (light blue, red and tan).</p><formula>A B C E F D</formula><formula>(C)</formula><p>The frequency matrix F observed for the three sequenced samples indicated in part B. (D) The usage matrix U and clonal matrix B that generate F. Even though some clones existing at the current time may not be contained within a sequenced sample (green), their existence in the evolutionary history of the tumor may be recovered. (E) Tree of the inferred tumor clones. Solid black edges are the clonal tree T corresponding to the clonal matrix B. Gray dashed edges indicate internal vertices used in the mixing of some sample. The number next to each clone in each sample indicates the fraction of cells in the sample from that clone. (F) The ancestry graph for the observed data. The bold arcs indicate the spanning arborescence corresponding to T Reconstruction of clonal trees and tumor composition i63 distinguishes the child from its parent (<ref type="figure" target="#fig_2">Fig. 1A</ref>). In practice, we will group individual mutations into sets that satisfy the second condition and consider these as individual mutations. Thus, we describe the mutational process that produced a tumor by an n-clonal tree T, which we define as follows.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>DEFINITION 1:</head><p>A rooted tree T on n vertices is an n-clonal tree for a mutation set ½n ¼ f1;. .. ; ng provided each edge is labeled with exactly one mutation from ½n and no mutation appears more than once in T. Let T n be the set of all n-clonal trees. We denote the root vertex of an n-clonal tree by v r where r 2 ½n is the mutation that does not label any edge in T. We denote the remaining vertices by v j where j 6 ¼ r is the mutation on the last edge of the path from v r to v j. Note that the set of mutations present in a clone v j is the set of mutations of all vertices on the path from v r to v j. The root vertex v r contains only mutation r and thus represents the founding clone. Alternatively, we may describe the n-clonal tree T by an n Â n binary matrix B. We label the vertices of T by binary row vectors indicating the mutations present in each vertex (clone). Each vertex v j corresponds to a binary row vector b j with 1's at the rth position and positions indicated by the edge labels of the unique path from v r to v j and 0's at the remaining positions. Let B be the n Â n binary matrix whose jth row is b j. As the mutations adhere to the infinite sites assumption, it follows that B is a perfect phylogeny matrix (<ref type="bibr" target="#b4">Gusfield, 1991</ref>). That is, for a column j of B, let I(j) be the positions of the 1 entries. Then for any pair of columns j and k of B either I(j) and I(k) are disjoint, or one contains the other. Not every n Â n perfect phylogeny matrix corresponds to a n-clonal tree T. For example, a perfect phylogeny matrix may have a row and/or column of all 0's or have duplicated rows and/or columns. We define a subset of n Â n perfect phylogeny matrices, which we call n-clonal matrices that are in 1-1 correspondence with n-clonal trees T.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>DEFINITION 2:</head><p>A matrix B 2 f0; 1g nÂn is an n-clonal matrix provided: 1. There exists exactly one r 2 ½n such that P n j¼1 b rj ¼ 1. 2. For each j 2 ½nnfrg there exists exactly one k 2 ½n such that b k b j and P n l¼1 ðb jl À b kl Þ ¼ 1. 3. b jj ¼ 1 for all j 2 ½n. Let B n be the set of all n-clonal matrices.</p><p>The second condition above ensures that every n-clonal matrix is a perfect phylogeny matrix. We have the following lemmas, which we prove in the Supplementary Appendix. LEMMA 1:</p><p>There is a one-to-one correspondence between T n and B n .</p><p>LEMMA 2:</p><p>Any B 2 B n has rank n.<ref type="figure" target="#fig_2">Figure 1D</ref>and E show a clonal matrix together with its corresponding clonal tree.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.1.1">Measurement of clonal trees</head><p>We do not directly observe the clonal tree T relating the clones in a tumor. Moreover, unless we perform single-cell sequencing, we do not directly measure the presence/absence of mutations in individual clones. Rather, each sequenced sample is a mixture of cancer cells (clones) and normal cells. We obtain VAFs or the fraction of reads covering a position that indicate the variant/mutation at each of the mutation sites in each of the samples. The VAF for a mutation is proportional to the cellular prevalence or fraction of cells in the sample that contain the mutation. Suppose we sequence m samples from a tumor with n mutations sites. Our observations are then described by an m Â n frequency matrix F ¼ ½f pi , where f pi indicates the observed VAF in sample p for the ith mutation (<ref type="figure" target="#fig_2">Fig. 1C</ref>). The observed mutation frequencies (entries of F) are related to the tree T by the proportions of normal cells and tumor clones that define the mixture in each sample. We define an m Â n usage matrix U ¼ ½u pi , where u pi indicates the fraction of cells in sample p that come from clone v i , as follows.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>DEFINITION 3:</head><p>An m Â n matrix U ¼ ½u pj  is a usage matrix provided u pj ! 0 and P n j¼1 u pj 1. Let U m;n be the set of all m Â n usage matrices U. Since each sequenced sample is a mixture of clones from T with proportions defined in the usage matrix U, the observed frequency matrix F ¼ ½f pj  satisfies F ¼ 1 2 UB:</p><formula>(1)</formula><p>The coefficient 1 2 arises because, by the infinite sites assumption, all mutations are heterozygous, and thus each f pj 2 ½0; 0:5. Assuming no errors in F, our goal is to find U and B satisfying (1). We define this problem as follows (<ref type="figure" target="#fig_2">Fig. 1D</ref>).</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>VARIANT ALLELE FREQUENCY FACTORIZATION PROBLEM:</head><p>Given an m Â n frequency matrix F, find a usage matrix U 2 U mn and a clonal matrix B 2 B n such that F ¼ 1 2 UB.</p><p>Without loss of generality, we assume that the rows and columns of any frequency matrix F are distinct, as duplicated rows or columns can be collapsed. The VAFFP formalizes and generalizes several problems that have previously been considered in the literature. In the case of m ¼ 1 sample,<ref type="bibr">Strino</ref><ref type="bibr">(2014)</ref>introduce the Perfect Phylogeny Mixture Problem, which can be described as a variant of the VAFFP where F is binary (a mutation is either observed or not) and additional constraints are placed on the usage matrix U. In the case of m &gt; 1 sample, PhyloSub (<ref type="bibr" target="#b9">Jiao et al., 2014</ref>) and CITUP (<ref type="bibr" target="#b10">Malikic et al., 2015</ref>) minimize the distance between the observed and inferred F while adhering to the VAFFP. Below we provide further details of the relationships between the various approaches.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.2">Solving the VAFFP</head><p>In this section, we derive a characterization of the solutions of the VAFFP (Theorem 1 below) as constrained spanning arborescences of a directed acyclic graph (DAG) called the ancestry graph (Definition 4 below). From this characterization, we prove that the VAFFP is NP-complete (Theorem 2 below) and give an exact algorithm for solving the problem.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.2.1">A necessary condition and the ancestry graph</head><p>We say that B (or T) generates F if and only if there exists a matrix U 2 U mn such that F ¼ 1 2 UB. To obtain a characterization of all solutions of the VAFFP, we first define several properties that relate the observed values of F to any clonal tree T that generates F. We start by observing that any T induces a partial ordering on the vertices. That is, for j; k 2 ½n; j0 T k if and only if vertex v j is an ancestor of vertex v k. Conversely, we say that j and k are incomparable if and only if neither v j nor v k is an ancestor to the other. Because B is a perfect phylogeny matrix, there is a partial order on the columns of B (<ref type="bibr" target="#b5">Gusfield, 1997</ref>). That is, for j; k 2 ½n, we have j0 B k if and only if IðjÞ IðkÞ. Similarly, j and k are incomparable if and only if IðjÞ = IðkÞ and IðkÞ = IðjÞ. From Lemma 1, it follows that j0 T k if and only if j0 B k for all j; k 2 ½n. Therefore, we will use 0 to denote either one. We now prove the following condition.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>ANCESTRY CONDITION:</head><p>If T generates F and j0 T k then f pj ! f pk for all samples p 2 ½m.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>PROOF:</head><p>Since j0 T k and j0 B k are equivalent, then IðjÞ IðkÞ. Moreover, because every entry in U is non-negative, we have the following for all samples p 2 ½m:</p><formula>f pj ¼ 1 2 X n i¼1 u pi Á b ij ¼ 1 2 X i2IðjÞ u pi ! 1 2 X i2IðkÞ u pi ¼ 1 2 X n i¼1 u pi Á b ik ¼ f pk :</formula><p>The contrapositive of the Ancestry Condition for two distinct samples yields the following corollary which is equivalent to the 'crossing rule' stated in<ref type="bibr">Jiao</ref>We summarize all possible ancestral relationships between mutations in F in a graph (<ref type="figure" target="#fig_2">Fig. 1F</ref>).</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>DEFINITION 4:</head><p>Given an m Â n frequency matrix F, the ancestry graph G ¼ ðV; AÞ is the directed graph with vertices V ¼ fv 1 ;. .. ; v n g and arcs A ¼ fðv j ; v k Þjf pj ! f pk ; for all p 2 ½mg.</p><p>The following observation which will be useful in the following section.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>OBSERVATION 1:</head><p>If all columns of a frequency matrix F are distinct then the ancestry graph G is a DAG.</p><p>A spanning arborescence of the ancestry graph G is a subgraph G 0 ¼ ðV; A 0 Þ with A 0 A, such that there exists a unique path from the root vertex v r to every vertex v 2 V.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>LEMMA 3:</head><p>If T generates F then T is a spanning arborescence of G. PROOF: Let T be a tree that generates F. Suppose for the sake of contradiction that T is not a spanning arborescence of G. Thus, there exists an edge (v j , v k ) in T with j 0 k such that ðv j ; v k Þ = 2 A. By definition of A there must exist p; q 2 ½m such that f pj &lt; f pk and f qj &gt; f qk. By Corollary 1, j and k are incomparable—a contradiction. Hence, T must be a spanning arborescence of G.</p><p>If an ancestry graph G ¼ ðV; AÞ does not have a spanning arborescence then there exists no tree T that generates F. Checking whether G has a spanning, arborescence can be done in OðjAjÞ time since by definition A contains all transitive arcs.<ref type="figure">Figure 2A</ref>shows an example of a frequency matrix whose ancestry graph has no spanning arborescence. Furthermore, not all spanning arborescences T of G generate F.<ref type="figure">Figure 2B</ref>shows such an example, where the matrix U obtained from T and F has negative entries and thus is not a usage matrix. Hence, the existence of a spanning arborescence in G is a necessary but not a sufficient condition for a solution to the VAFFP.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.2.2">The sum condition and sufficiency</head><p>In the previous section, we saw that the ancestry condition is not sufficient to produce a solution to the VAFFP. Sufficiency will be obtained through a second condition, which we refer to as the sum condition. This condition was stated as the 'sum rule' in<ref type="bibr">Jiao</ref>If T generates F then for all samples p 2 ½m and mutations j 2 ½n,</p><formula>f pj ! X v k 2dðvjÞ f pk : (2)</formula><p>See the Supplementary Appendix for the proof of the sum condition. For a clonal tree T, sample p and mutation j, we define the deficit d pj ¼ f pj À P v k 2dðvjÞ f pk. Thus, the Sum Condition states that if T generates F, then the deficit d pj is non-negative for all samples p and mutations j. It turns out that the deficits for all samples and mutations determine the matrix U. In particular, we have the following lemma. LEMMA 4:</p><p>Given an m Â n frequency matrix F and an n-clonal matrix B, the m Â n matrix U ¼ ½u pj  defined as</p><formula>u pj ¼ 2d pj ¼ 2 f pj À X v k 2dðvjÞ f pk 0 @ 1 A (3)</formula><p>is the unique matrix such that F ¼ 1 2 UB.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>PROOF:</head><p>Lemma 2 tells us that there is a unique U 2 R mÂn such that F ¼ 1 2 UB. It suffices to show that f pj ¼ 1 2 P n k¼1 u pk Á b kj for any sample p and mutation j. Let T be the corresponding clonal tree of B and j 2 ½n. Since b kj ¼ 1 for all k 2 IðjÞ, we have</p><formula>1 2 X n k¼1 u pk Á b kj ¼ 1 2 X k2IðjÞ u pk ¼ 1 2 X k2IðjÞ 2 f pk À X v l 2dðv k Þ f pl 0 @ 1 A ¼ X k2IðjÞ f pk À X k2IðjÞ X v l 2dðv k Þ f pl :</formula><p>Note that I(j) is the set of indices of all vertices in the subtree rooted at v j in T including v j itself. Since T is a tree, for any k; l 2 IðjÞ with k 6 ¼ l, we have dðv k Þ \ dðv l Þ ¼ ;. Thus, in the last line<ref type="figure">Fig. 2</ref>. Spanning arborescences of the ancestry graph. (A) F cannot be factorized as its ancestry graph does not admit a spanning arborescence. (B) Red arcs indicate a spanning arborescence T of the ancestry graph of F with corresponding matrix B. B does not generate F as the matrix U ¼ 2FB À1 = 2 Umn</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>A B</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Reconstruction of clonal trees and tumor composition i65</head><p>of the above derivation, we subtract f pl exactly once for all vertices v l 6 ¼ v j that are in the subtree rooted at v j. The set of such vertices is IðjÞnfjg. Hence,</p><formula>X k2IðjÞ f pk À X k2IðjÞ X v l 2dðv k Þ f pl ¼ X k2IðjÞ f pk À X k2IðjÞnfjg f pk ¼ f pj :</formula><p>Note that by Lemma 2, any B 2 B n is full rank and therefore invertible. Therefore, for any frequency matrix F, there is a unique U 2 R mÂn such that F ¼ 1 2 UB, namely U ¼ 2FB À1. Thus, the above lemma gives an explicit formula for the entries of U ¼ 2FB À1. For the single sample case, a similar formula was derived by<ref type="bibr">Strino</ref>We need only to show that U created according to Equation (3) is an element of U mn. Thus, we need to show that u pj ! 0 for all p, j and P n j¼1 u pj 1 for all p. The condition that u pj ! 0 follows directly from our assumption that f pj ! P v k 2dðvjÞ f pk for all p and j, as defined in Equation (2). By definition, column r of B consists of only 1-entries. Moreover, every entry f pj 0:5 and thus</p><formula>f pr ¼ 1 2 P n k¼1 u pk Á b kr ¼ 1 2 P n</formula><p>k¼1 u pk 0:5. Hence,</p><formula>P n k¼1 u pk 1.</formula><p>Using this lemma, we obtain the following characterization of those spanning arborescences of the ancestry graph G that generate F.</p><formula>THEOREM 1:</formula><p>T generates F ¼ ½f pj  if and only if T is a spanning arborescence of G such that Equation (2) holds for all f pj .</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>PROOF:</head><p>The forward direction follows from Lemma 3 and the sum condition<ref type="bibr">[Equation (2)]</ref>. For the reverse direction, we know that T spans all vertices of G and therefore is a valid clonal tree with corresponding clonal matrix B. Lemma 5 tells us that B, and hence also T, generate F. Thus, there is a 1-1 correspondence between spanning arborescences in G that satisfy the sum condition and solutions to the VAFFP. Note that this characterization allows us to focus on finding B (equivalently T) without considering U in solving the VAFFP. In contrast,<ref type="bibr" target="#b9">Jiao et al. (2014) and</ref><ref type="bibr" target="#b10">Malikic et al. (2015)</ref>try to identify the usage matrix and clonal tree simultaneously. Moreover,<ref type="bibr" target="#b10">Malikic et al. (2015)</ref>do not exploit the 1-1 correspondence between clonal trees and clonal matrices and instead optimize over both. Although a spanning arborescence can be found efficiently, deciding whether G admits a spanning arborescence satisfying the sum condition is NP-complete.In summary, the following procedure gives a solution to the VAFFP for a frequency matrix F: (i) Build the ancestry graph G for F. (ii) Find a spanning arborescence T of G that satisfies the sum condition. (iii) Compute U according to Equation (3).</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.2.3">An integer linear programming solution</head><p>We formulate an integer linear program (ILP) to find the largest arborescence in an ancestry graph G that adheres to the sum condition. If this is a spanning arborescence, then we have found a solution to the VAFFP. First, we introduce an artificial root vertex v r that has an outgoing arc to every other vertex in V. Let A 0 ¼ A [ fðv r ; wÞjw 2 Vg denote this extended arc set. For v 2 V [ fv r g, we define d þ ðvÞ ¼ fw 2 Vjðv; wÞ 2 A 0 g to be the set of vertices connected to v by an outgoing arc. Similarly, we define d À ðvÞ ¼ fw 2 Vjðw; vÞ 2 A 0 g to be the set of vertices connected to v by an incoming arc. Let variables x 2 f0; 1g jA 0 j be binary variables indicating the presence/absence of arcs in a solution.x jk 2 f0; 1g 8 ð v j ; v k Þ 2 A 0</p><formula>(9)</formula><p>Constraint (5) enforces that the arborescence T has only one root vertex. Constraint (6) states that for every outgoing arc (v k , v l ) in T, there is an incoming arc (v j , v k ) in T. The arborescence constraint (7) enforces that every vertex v k has at most one incoming arc (v j , v k ) in T. Constraint (8) is the sum condition<ref type="bibr">[Equation (2)]</ref>. Thus, these constraints encode that any arborescence satisfying the sum condition is a feasible solution and vice versa. The objective function (4) maximizes the number of edges in the arborescence. Note that because G is a DAG (Observation 1), our formulation of the ILP does not have to consider cycles. Lastly, note that this ILP only allows us to determine whether a solution to the VAFFP exists but provides no way to discriminate between multiple solutions— something we consider in the following section.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.3">VAFFP with errors</head><p>Thus far, we have assumed that the observed frequency matrix F is error-free. That is, there exists some B 2 B n and U 2 U mn such that F ¼ 1 2 UB. However, this may not be the case for real sequencing data where the entries of F are obtained from integer read counts and thus are approximations of the true frequencies. We address this uncertainty in the frequencies by relaxing both the ancestry condition and the sum condition.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.3.1">Approximate ancestry graph</head><p>We use a probabilistic model for the observed read counts. Let X pj be a random variable describing the VAF for a sample p and mutation j. For any pair of mutations j, k and sample p, let Pr½X pj ! X pk  denote the posterior probability that X pj ! X pk. The sample p with the smallest such probability represents the weakest evidence that mutation j preceded mutation k in the evolutionary history of the tumor. Thus, we define the posterior probability Pr½ j 0 k as min p Pr½X pj ! X pk . If this probability is close to 1 then mutation j is likely to be ancestral to mutation k. We build the approximate ancestry graph G ¼ ðV; AÞ in two steps: (i) cluster mutations whose posterior probabilities indicate that they likely occurred together. The groups of mutations form the set of vertices V. (ii) Retain high-confidence ancestral relationships among the clusters of mutations. The retained relationships form the set of arcs A. Specifically, in the first step, we want to cluster mutations whose posterior probability distributions are similar across all samples. If mutations j and k have identical posterior probability distributions across all samples, then Pr½j 0 k ¼ Pr½k 0 j ¼ 0:5. Thus, given a parameter a 2 ½0; 0:5, we define the directed graph H ¼ ð½n; A H Þ whose vertices are the mutations and whose arcs are given by A H ¼ fðj; kÞj0:5 À a Pr½j 0 k 0:5 þ ag. The arcs in A H correspond to ancestry relationships where the posterior probability that j 0 k and k 0 j is within a of 0.5. We group such mutations into clusters by computing strongly connected components in H. Thus, the parameter a controls how much we cluster, with a ¼ 0 having very little clustering and a ¼ 0:5 clustering all mutations together. Then, in the second step, we determine ancestry between clusters/ components by including an arc between two components only if there exist mutations k and l in the corresponding clusters such that Pr½k 0 l ! b for some specified parameter b 2 ½0:5; 1. Formally, let S ¼ fS 1 ;. .. ; S t g be the set of strongly connected components in H. We define the approximate ancestry graph G ¼ ðV; AÞ whose vertices V ¼ S and whose arcs A ¼ fði; jÞj 9k 2 S i ; l 2 S j s:t: Pr½k 0 l ! bg. We note there is no theoretical guarantee that the resulting graph G is a DAG because cycles may exist containing one or more arcs with a posterior probability of at least 0:5 þ a. However, as increasing b reduces the number of arcs in G, we find in practice that setting b sufficiently large generally produces a DAG. We compute the distribution of X pj for a sample p and mutation j as the posterior probability of the VAF given the observed read counts. The observed VAF ~</p><formula>f pj ¼ ~ cpj ð~ cpjþ ~ dpjÞ</formula><p>, where ~ c pj and ~ d pj are the number of reads from sample p that cover mutation j and that contain the variant and reference alleles, respectively. The distribution of X pj is the posterior distribution of the binomial proportion when one observes ~ c pj 'successes' on ~ c pj þ ~ d pj trials. Assuming a flat prior on the proportion, we have X pj $ Betað~ c pj þ 1; ~ d pj þ 1Þ. In other words, we use a generative model for VAFs with ~ c pj $ Binomialð~ c pj þ ~ d pj ; qÞ and q $ Betað1; 1Þ. For j; k 2 ½n, we use the method described in<ref type="bibr" target="#b0">Cook (2005)</ref>to compute Pr½X pj ! X pk . Finally, as the vertices in the approximate ancestry graph G correspond to strongly connected components that typically include more than one mutation, we compute the frequency matrix F ¼ ½f pj  for the approximate ancestry graph G by combining read counts for all mutations in the same component. That is, for a vertex v j 2 V and sample p 2 ½m, we define</p><formula>c pj ¼ P k2Sj ~ c pk and d pj ¼ P k2Sj ~ d pk. We set f pj ¼ cpj ðcpjþdpjÞ .</formula><p>We emphasize that our approach clusters mutations according to the uncertainty in their ancestry as determined by the uncertainty in the frequency of individual mutations. We compute the latter from the overlap between the posterior distributions of the binomial parameters. This is very different from existing approaches such as CITUP (<ref type="bibr" target="#b10">Malikic et al., 2015</ref>) and SciClone (<ref type="bibr" target="#b11">Miller et al., 2014</ref>) that cluster mutations according to VAFs alone. Moreover, in some methods, the uncertainty in the VAF of each mutation is considered to be fixed, rather than a function of the observed read counts. Our approach allows us to distinguish mutations whose observed VAFs may be similar, but which are likely contained within distinct clones, according to their relationships to other mutations in different samples.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.3.2">An MILP for arborescence with errors</head><p>Our construction of the approximate ancestry graph relaxes the ancestral relationships in the case of errors in VAFs. However, errors in the observed VAFs may also result in violations of the sum condition. Thus, we formulate a mixed ILP (MILP) that finds the largest arborescence on the approximate ancestry graph while allowing for the inferred frequencies to differ slightly from the observed frequency values. We create a confidence interval ½f À pj ; f þ pj  as the ð1 À cÞ equal-tailed posterior probability interval of the Beta distribution with parameters ðc pj þ 1; d pj þ 1Þ where c is a fixed parameter. This interval will provide lower and upper bounds on the inferred frequency values in the MILP. It is possible that G may not contain any spanning arborescence that satisfies the sum condition since G only consists of high confidence arcs. Therefore, we choose to return a partial solution to the VAFFP by returning the largest arborescence T in G that adheres to the sum condition. This arborescence represents a subset of mutations for which we can confidently infer the ancestral relationships. We note that this is a departure from other methods such as CITUP (<ref type="bibr" target="#b10">Malikic et al., 2015</ref>) and PhyloSub (<ref type="bibr" target="#b9">Jiao et al., 2014</ref>) that require that all mutations be placed on a single tree. There may be multiple such maximal trees T in G. Rather than considering all such trees, we return the clonal tree T (corresponding to a clonal matrix B) and associated usage matrix U that minimize the average deviation between entries in the inferred frequency matrix F ¼ 1 2 UB and the observed frequency matrix ~ F. As we have clustered mutations, we need to define a map r which relates individual mutations to their respective cluster. That is, rðjÞ ¼ k when mutation j occurs in cluster k. The MILP is as follows.</p><formula>max X ðvj;v k Þ2A 0 x jk À 1 mn X m p¼1 X n j¼1 j ~ f pj À f p;rðjÞ j (10)</formula><p>s:t: ð5Þ; ð6Þ; ð7Þ; ð8Þ and ð9Þ</p><formula>(11) f pj 2 ½f À pj ; f þ pj  for all p 2 ½m; v j 2 V (12)</formula><p>We model the absolute value in ð10Þ and the product f pk x jk in (8) using standard linearization techniques (<ref type="bibr" target="#b24">Wolsey, 1998</ref>). We call the resulting algorithm AncesTree.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3">Results</head><p>We implemented AncesTree in Cþþ using CPLEX v12.6. We analyze 90 simulated datasets and 22 real tumor datasets. The real data consist of chronic lymphocytic leukemia (CLL) (<ref type="bibr" target="#b20">Schuh et al., 2012</ref>), lung adenocarcinoma (<ref type="bibr" target="#b26">Zhang et al., 2014</ref>) and renal cell carcinoma tumors (<ref type="bibr" target="#b3">Gerlinger et al., 2014</ref>). The lung and renal tumors have undergone multi-section sequencing, whereas the CLL tumors were sequenced over multiple time points. For 14 of the 22 tumors, we have both whole-genome/whole-exome sequencing data and targeted deep resequencing data of either the same or a subset of mutations for all sections of the tumor (Supplementary<ref type="figure" target="#tab_1">Table A1</ref>). For all analyses, we set a ¼ 0:3; b ¼ 0:8 and c ¼ 0:01. See the Supplementary Appendix for results as a and b are varied.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Reconstruction of clonal trees and tumor composition i67</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.1">Comparison of AncesTree to PhyloSub and CITUP</head><p>We compare AncesTree to two other recent algorithms that infer trees from multi-sample sequencing data: PhyloSub (<ref type="bibr" target="#b9">Jiao et al., 2014</ref>) and CITUP (<ref type="bibr" target="#b10">Malikic et al., 2015</ref>). We were unable to compare to LICHeE (<ref type="bibr" target="#b18">Popic et al., 2014</ref>) as the software only provides a graphical user interface with no way to easily export results. We created 90 synthetic tumor datasets. Each dataset contains 100 mutations grouped into 10 clones that accumulated following the infinite sites assumption. For each dataset, we simulated between four and six samples sequenced at a coverage of 50X, 100X or 1000X. Further details of the simulated data are contained in the Supplementary Appendix. We ran AncesTree, PhyloSub and CITUP on each dataset and compared the results using five measures: (i) the fraction of ancestral relationships between pairs of mutations that were correctly identified (<ref type="figure">Fig. 3A</ref>); (ii) the fraction of clustered relationships between pairs of mutations that were correctly identified (<ref type="figure">Fig. 3B</ref>); (iii) the fraction of incomparable relationships (i.e. neither ancestral nor clustered) between pairs of mutations that were correctly identified (Supplementary<ref type="figure">Fig. A2</ref>); (iv) the average error 1 mn jj ~ F À Fjj 1 between the simulated ~ F and inferred frequency matrix F (<ref type="figure">Fig. 3C</ref>) and (v) the error between the simulated usage matrix ~ U and the inferred usage U using the same metric as Malikic et al.<ref type="figure">Fig. 3D</ref>). We note that we compute these measures only on the set of mutations that are included in the output of all methods, which equates to the set of mutations output by AncesTree (median of 69 of the 100 total mutations) since CITUP and PhyloSub include all mutations. We find that AncesTree has higher accuracy in determining ancestral, clustered and incomparable relationships with median accuracy more than 0.05, 0.03 and 0.08, respectively, higher than the median accuracy of the other methods. Further, we find that AncesTree achieves a median error on F and U that is 0.01 and 0.03 lower than the median error of the other methods. See Supplementary Appendix for further details on all five metrics. We also compare the output of AncesTree, CITUP and PhyloSub on the sequencing data from 22 tumor samples and find that AncesTree produces results that are more consistent with the input data in terms of our probabilistic model (see Supplementary Appendix).</p><formula>(2015) (</formula></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.2">Whole-exome versus deep sequencing</head><p>A key difference between AncesTree and other approaches is that we use a graph clustering approach to group mutations by their putative ancestral relationships across all samples, rather than clustering VAFs directly. We demonstrate the advantages of this approach on a lung tumor<ref type="bibr">[patient 330 in Zhang et al. (2014)</ref>] that had multiple samples sequenced using both whole-exome and targeted deep sequencing (higher coverage) data. One would expect that deep sequencing data should provide a more accurate measurements of the VAF for each mutation due to the higher read counts. However, in aggregate, there is very little difference between the VAF histograms for whole-exome versus deep sequencing (<ref type="figure">Fig. 4A</ref>). Thus, methods that first cluster mutations according to their VAF without considering the variance in the VAFs of individual mutations from the observed read counts, including CITUP (<ref type="bibr" target="#b10">Malikic et al., 2015</ref>) and LICHeE (<ref type="bibr" target="#b18">Popic et al., 2014</ref>), will not recognize differences in clustering between the low and high coverage data. Examining the posterior probabilities of ancestral relationships between individual mutations (<ref type="figure">Fig. 4B</ref>) reveals a striking difference between the low and high coverage datasets. The higher coverage targeted sequencing data have a much clearer distinction in ancestral relationships with many more pairs of mutations having posterior probability Pr½i 0 j, the probability that mutation i precedes mutation j, close to 1 or 0, indicating high confidence in the ancestral relationships. The approach used by AncesTree exploits this higher confidence in individual ancestral relationships, both in grouping mutations and in determining the tree. For example,<ref type="figure">Figure 4C</ref>shows the posterior probabilities of the VAF for three mutations. With lower coverage whole-exome sequencing, the distributions overlap, and there is no clear ancestral or grouping relationship between the mutations. With deep sequencing data, the variance of VAF for each mutation is smaller and relationships between the mutations become apparent. The red mutation has a strong probability to be ancestral to both the blue and green mutations as Pr½red 0 green] ¼ 1:0 and Pr½red 0 blue] ¼ 1:0. In contrast, the blue and green mutations overlap significantly suggesting that these mutations should be clustered together. We find Pr½blue 0 green] ¼ 0:45 and Pr½green 0 blue] ¼ 0:22, both of which are within the interval 0:5 À a; 0:5 þ a ½  that we use for clustering. Thus, these mutations will be found in the same strongly connected component when building the approximate ancestry graph.<ref type="figure">Fig. 4</ref>. Comparison of whole-exome (top) and deep sequencing data (bottom) for lung patient 330. (A) Histogram of observed VAFs for all mutations for both datatypes does not reveal a significant difference between lower (201X) coverage (top) and higher (674X) coverage (bottom) sequencing data. (B) A heat map showing the posterior probability Pr ½i 0 j for all pairs of mutations i and j. The asymmetry in the matrix reveals high confidence ancestral relationships, which become much clearer with higher coverage. (C) The posterior distribution of the VAF for three mutations given the observed read counts. In higher coverage data, the distributions become much tighter, revealing that the red mutation is ancestral to the blue and green mutations i68 M.El-Kebir et al.<ref type="figure">Figure 5A</ref>shows the clonal tree inferred by AncesTree for CLL patient 077 previously analyzed with both PhyloSub and CITUP. The structure of our clonal tree closely resembles the trees reported by the other algorithms (<ref type="figure">Fig. 5C</ref>); in particular, both trees have two branching lineages containing mutations in the same genes. Furthermore, AncesTree returns purity estimates within 0.04 and 0.05, respectively, of those reported by PhyloSub and CITUP across all five tumor samples. However, there are also important differences between the trees. PhyloSub and CITUP group together multiple pairs of mutations that AncesTree separates into successive clones. For instance, PhyloSub and CITUP cluster MAP2K1, HMCN1 and NOD1 into a single clone, whereas the tree produced by AncesTree shows these mutations as the result of three successive clonal expansions. The extremely high read counts (&gt;450 K) for these three mutations across all five samples give high confidence in the posterior probability of the ancestral relationships: the minimum posterior probabilities over all samples are 0.86 and 1 for the two edges. Similarly, Pr½PLA2G16 0 EXOC6B ¼ 1 as is reported in AncesTree's clonal tree (<ref type="figure">Fig. 5B</ref>). In addition to the differences in ancestry, the clonal tree output by AncesTree contains only a subset of the mutations, whereas the tree output by PhyloSub contains all mutations. We find that three of the missing mutations (in genes BCL2L13, NAMPTL and SAMHD1) have VAFs that are significantly higher than 0.5. Indeed the 1 À c confidence interval used by our ILP implementation is strictly larger than 0.5. It is likely that these mutations occur in regions affected by copy number aberrations, thus violating the assumptions of our model. We examined the approximate ancestry graph for this sample (Supplementary<ref type="figure">Fig. A7</ref>) to determine why other mutations were missing from the tree output by AncesTree. We find that mutations in SLC12A1 and GPR158 only have incoming arcs from the three genes listed above whose VAFs exceed 0.5. Thus, there is no subtree of the ancestry graph that contains both SLC12A1 and GPR158. The other missing mutations (KLHDC2, COL24A1, DAZAP1, GHDC and OCA2) are all descendants of SLC12A in the ancestry graph. Of these missing mutations, all except for GHDC are also descendants of GPR158, but each violates the sum condition if added to the tree output by AncesTree.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>A B</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.3">Uncovering high-confidence ancestral relationships</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.4">Heterogeneity within samples</head><p>As AncesTree directly computes the usage matrix U, we obtain estimates of the amount of mixing, or intra-tumor heterogeneity, of clones within each analyzed sample. Specifically, for a given sample, the number of clones that are inferred to be mixed in a sample is the number of non-zero entries in the corresponding row of U. For each tumor, we compute its mixing proportion to be the fraction of entries in U that are non-zero (see Supplementary<ref type="figure" target="#tab_1">Table A1</ref>). Using the deep sequencing data, we find that the CLL tumors have on average a mixing proportion of 1.0. This is much higher than the renal and lung tumors which have on average mixing proportions of 0.22 and 0.5, respectively. The higher mixing proportions for CLL are consistent with it being a liquid tumor, where mixing between clones is likely to be more common than in solid tumors. We further analyzed one renal tumor, EV006, for which we obtained a relatively low mixing proportion of 0.21 (<ref type="figure">Fig. 6</ref>). Samples R6 and R7 from this tumor were found to be the mixture of two and three distinct clones, respectively, that do not appear in other samples. This shows that AncesTree can infer the composition of individual samples containing clones distinct from all other samples. The remaining samples in this tumor all include a clone that appears in at least one other sample. Notably, the two lymph node samples, LN1a and LN1b, are inferred to be mixtures of the same two clones. The only difference between these two samples appears to be that LN1b contains a higher admixture with normal cells (0.45) than LN1a (&lt; 0.01), and indeed the two lymph node samples are grouped together in the original analysis of this tumor by<ref type="bibr" target="#b3">Gerlinger et al. (2014).</ref></p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4">Discussion</head><p>Reconstructing the evolutionary history of a tumor given VAFs measured in multiple sequenced samples for a single tumor is a A B C<ref type="figure">Fig. 5</ref>. Analysis of CLL patient 077 shows AncesTree's ability to infer successive clonal expansions. (A) The clonal tree output by AncesTree is indicated by the black solid edges whose weights correspond to the posterior probability of the ancestral relationship. Dashed edges are used to indicate ancestral clones which exist at the time of sequencing. The blocks labeled 'a' through 'e' each represent a sequenced sample, with colored edges indicating the inferred composition of clones and their fraction in each sample (only edges with usage at least 0.05 are shown). (B) The 1 À 10 À6 confidence intervals of VAF for the sample with the weakest ancestral evidence for each of the edges connecting gene GPR158 to LRRC16A. (C) The tree reported by PhyloSub, which is identical to the tree reported by CITUP except for the addition of SAMHD1. Mutations indicated in blue are those present in part A. Mutations indicated in red likely occur in regions affected by copy number aberrations</p><p>Reconstruction of clonal trees and tumor composition i69 challenging task. In this work, we formalize this problem as the VAFFP. We derive a combinatorial characterization of the solutions to this problem and prove the problem is NP-complete. We present the AncesTree algorithm for solving an approximate version of the problem which allows errors and demonstrate the advantages of AncesTree relative to existing approaches. There are a number of avenues for further investigation. First, we have ignored the effect of copy number aberrations on VAFs, meaning that AncesTree may not currently be applicable to some datasets. Second, AncesTree only outputs the single largest rooted subtree of the approximate ancestry graph that satisfies the sum condition. The algorithm may be applied iteratively by removing the clonal tree found at each step from the ancestry graph and rerunning, thus returning a forest. However, it is unclear how the trees in this forest relate to each other or if there is an approach for joining them. Third, the theoretical results may be strengthened. For example, as the number m of samples is much smaller than the number n of mutations, it would be interesting to see if the problem is fixedparameter tractable. Finally, our use of the binomial distribution to model read counts may underestimate the variance; e.g. due to factors such as PCR artifacts. More realistic models of read counts may improve the performance of AncesTree. Finally, we note that the kidney and lung datasets analyzed here contain multiple sections of a solid tumor obtained at a single time point, whereas the CLL datasets contain samples obtained at different times. Future work will include handling multi-section samples and multi-time-point samples separately to account for time related dependencies.<ref type="figure">Fig. 6</ref>. Analysis of renal patient EV006 reveals distinctive sample composition. The clonal tree output by AncesTree. Some sequenced sections (R6, R7) are mixtures of clones appearing only in those sections. In contrast, other sequenced sections (LN1a, LN1b and R3) are mixtures of clones that each appear in more than one section. In particular, both lymph node samples (LN1a and LN1b) are mixtures of the same two clones but in different proportions</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Funding</head></div><figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_0"><head></head><figDesc>et al. (2013) and Hajirasouliha et al. (2014) address the problem of minimizing the number of non-zero entries in U, with Strino et al. (2013) breaking ties in favor of solutions whose clonal trees have minimum depth. Hajirasouliha and Raphael</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_1"><head></head><figDesc>et al. (2014).</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_2"><head>COROLLARY1:</head><figDesc>If T generates F and there exist samples p; q 2 ½m and mutations j; k 2 ½n such that f pj &gt; f pk and f qj &lt; f qk then j and k are incomparable.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_3"><head></head><figDesc>et al. (2014), also appears in Strino et al. (2013) and Malikic et al. (2015), and a special case was called the 'children sum to parents' condition in Hajirasouliha et al. (2014). Given a clonal tree T, let dðv j Þ denote the children of a vertex v j in T.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_4"><head></head><figDesc>SUM CONDITION:</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_5"><head></head><figDesc>et al. (2013). However, instead of using this formula to infer the usage vector, the authors use back substitution. Jiao et al. (2014) and Malikic et al. (2015) also describe a recursive formula relating the frequencies and usages. Moreover, d pj ¼ 0 is equivalent to the 'children sum to parents' condition in Hajirasouliha et al. (2014) and the 'non-populated clone' condition in Strino et al. (2013). In this case u pj ¼ 0, which implies that the clone v j is not present (or mixed) in sample p. The matrix U defined by Equation (3) has non-negative entries whose rows sum to at most 1 and thus is a valid usage matrix precisely when the deficits are non-negative. This in turn happens when F satisfies the sum condition [Equation (2)]. Combining these results, we obtain the following lemma. LEMMA 5: If an m Â n frequency matrix F ¼ ½f pj  satisfies Equation (2) for the tree T corresponding to B 2 B n , then B generates F. PROOF:</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_7"><head></head><figDesc>This work was supported by a National Science Foundation (NSF) CAREER Award CCF-1053753 and NIH RO1HG005690. B.J.R. was also supported by a Career Award at the Scientific Interface from the Burroughs Wellcome Fund, an Alfred P Sloan Research Fellowship. Conflict of Interest: none declared.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_0" validated="false"><figDesc>V C The Author 2015. Published by Oxford University Press.</figDesc><table></table></figure>

			<note place="foot">at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>

			<note place="foot">M.El-Kebir et al. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>
		</body>
		<back>
			<div type="references">

				<listBibl>

<biblStruct   xml:id="b0">
	<monogr>
		<title level="m" type="main">Exact calculation of beta inequalities</title>
		<author>
			<persName>
				<forename type="first">J</forename>
				<surname>Cook</surname>
			</persName>
		</author>
		<imprint>
			<date type="published" when="2005" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b1">
	<analytic>
		<title level="a" type="main">Clonal evolution in relapsed acute myeloid leukaemia revealed by whole-genome sequencing</title>
		<author>
			<persName>
				<forename type="first">L</forename>
				<surname>Ding</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nature</title>
		<imprint>
			<biblScope unit="volume">481</biblScope>
			<biblScope unit="page" from="506" to="510" />
			<date type="published" when="2012" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b2">
	<analytic>
		<title level="a" type="main">Intratumor heterogeneity and branched evolution revealed by multiregion sequencing</title>
		<author>
			<persName>
				<forename type="first">M</forename>
				<surname>Gerlinger</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">N. Engl. J. Med</title>
		<imprint>
			<biblScope unit="volume">366</biblScope>
			<biblScope unit="page" from="883" to="892" />
			<date type="published" when="2012" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b3">
	<analytic>
		<title level="a" type="main">Genomic architecture and evolution of clear cell renal cell carcinomas defined by multiregion sequencing</title>
		<author>
			<persName>
				<forename type="first">M</forename>
				<surname>Gerlinger</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nat. Genet</title>
		<imprint>
			<biblScope unit="volume">46</biblScope>
			<biblScope unit="page" from="225" to="233" />
			<date type="published" when="2014" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b4">
	<monogr>
		<title level="m" type="main">Efficient algorithms for inferring evolutionary trees. Networks</title>
		<author>
			<persName>
				<forename type="first">D</forename>
				<surname>Gusfield</surname>
			</persName>
		</author>
		<imprint>
			<date type="published" when="1991" />
			<biblScope unit="page" from="19" to="28" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b5">
	<monogr>
		<title level="m" type="main">Algorithms on Strings, Trees, and Sequences—Computer Science and Computational Biology</title>
		<author>
			<persName>
				<forename type="first">D</forename>
				<surname>Gusfield</surname>
			</persName>
		</author>
		<imprint>
			<date type="published" when="1997" />
			<publisher>Cambridge University Press</publisher>
			<pubPlace>Cambridge, UK</pubPlace>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b6">
	<analytic>
		<title level="a" type="main">Reconstructing mutational history in multiply sampled tumors using perfect phylogeny mixtures</title>
		<author>
			<persName>
				<forename type="first">I</forename>
				<surname>Hajirasouliha</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">B</forename>
				<forename type="middle">J</forename>
				<surname>Raphael</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Algorithms in Bioinformatics—14th International Workshop, WABI 2014</title>
		<editor>Brown,D. and Morgenstern,B.</editor>
		<imprint>
			<publisher>Springer</publisher>
			<date type="published" when="2014" />
			<biblScope unit="page" from="354" to="367" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b7">
	<monogr>
		<title level="m" type="main">A combinatorial approach for analyzing intratumor heterogeneity from high-throughput sequencing data</title>
		<author>
			<persName>
				<forename type="first">I</forename>
				<surname>Hajirasouliha</surname>
			</persName>
		</author>
		<imprint>
			<date type="published" when="2014" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b8">
	<analytic>
		<title/>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">30</biblScope>
			<biblScope unit="page" from="78" to="86" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b9">
	<analytic>
		<title level="a" type="main">Inferring clonal evolution of tumors from single nucleotide somatic mutations</title>
		<author>
			<persName>
				<forename type="first">W</forename>
				<surname>Jiao</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">BMC Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">15</biblScope>
			<biblScope unit="page">35</biblScope>
			<date type="published" when="2014" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b10">
	<analytic>
		<title level="a" type="main">Clonality inference in multiple tumor samples using phylogeny</title>
		<author>
			<persName>
				<forename type="first">S</forename>
				<surname>Malikic</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">31</biblScope>
			<biblScope unit="page" from="1349" to="1356" />
			<date type="published" when="2015" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b11">
	<analytic>
		<title level="a" type="main">Sciclone: inferring clonal architecture and tracking the spatial and temporal patterns of tumor evolution</title>
		<author>
			<persName>
				<forename type="first">C</forename>
				<forename type="middle">A</forename>
				<surname>Miller</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">PLoS Comput. Biol</title>
		<imprint>
			<biblScope unit="volume">10</biblScope>
			<biblScope unit="page">1003665</biblScope>
			<date type="published" when="2014" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b12">
	<analytic>
		<title level="a" type="main">Cancer genomics: one cell at a time</title>
		<author>
			<persName>
				<forename type="first">N</forename>
				<forename type="middle">E</forename>
				<surname>Navin</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Genome Biol</title>
		<imprint>
			<biblScope unit="volume">15</biblScope>
			<biblScope unit="page">452</biblScope>
			<date type="published" when="2014" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b13">
	<analytic>
		<title level="a" type="main">Genome evolution during progression to breast cancer</title>
		<author>
			<persName>
				<forename type="first">D</forename>
				<forename type="middle">E</forename>
				<surname>Newburger</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Genome Res</title>
		<imprint>
			<biblScope unit="volume">23</biblScope>
			<biblScope unit="page" from="1097" to="1108" />
			<date type="published" when="2013" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b14">
	<analytic>
		<title level="a" type="main">The life history of 21 breast cancers</title>
		<author>
			<persName>
				<forename type="first">S</forename>
				<surname>Nik-Zainal</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Cell</title>
		<imprint>
			<biblScope unit="volume">149</biblScope>
			<biblScope unit="page" from="994" to="1007" />
			<date type="published" when="2012" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b15">
	<analytic>
		<title level="a" type="main">The clonal evolution of tumor cell populations</title>
		<author>
			<persName>
				<forename type="first">P</forename>
				<forename type="middle">C</forename>
				<surname>Nowell</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Science</title>
		<imprint>
			<biblScope unit="volume">194</biblScope>
			<biblScope unit="page" from="23" to="28" />
			<date type="published" when="1976" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b16">
	<analytic>
		<title level="a" type="main">Theta: inferring intra-tumor heterogeneity from highthroughput DNA sequencing data</title>
		<author>
			<persName>
				<forename type="first">L</forename>
				<surname>Oesper</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Genome Biol</title>
		<imprint>
			<biblScope unit="volume">14</biblScope>
			<biblScope unit="page">80</biblScope>
			<date type="published" when="2013" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b17">
	<analytic>
		<title level="a" type="main">Quantifying tumor heterogeneity in whole-genome and whole-exome sequencing data</title>
		<author>
			<persName>
				<forename type="first">L</forename>
				<surname>Oesper</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">30</biblScope>
			<biblScope unit="page" from="3532" to="3540" />
			<date type="published" when="2014" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b18">
	<monogr>
		<title level="m" type="main">Fast and scalable inference of multi-sample cancer lineages. CoRR, abs/1412</title>
		<author>
			<persName>
				<forename type="first">V</forename>
				<surname>Popic</surname>
			</persName>
		</author>
		<imprint>
			<date type="published" when="2014" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b19">
	<analytic>
		<title level="a" type="main">Pyclone: statistical inference of clonal population structure in cancer</title>
		<author>
			<persName>
				<forename type="first">A</forename>
				<surname>Roth</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nat. Methods</title>
		<imprint>
			<biblScope unit="volume">11</biblScope>
			<biblScope unit="page" from="396" to="398" />
			<date type="published" when="2014" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b20">
	<analytic>
		<title level="a" type="main">Monitoring chronic lymphocytic leukemia progression by whole genome sequencing reveals heterogeneous clonal evolution patterns</title>
		<author>
			<persName>
				<forename type="first">A</forename>
				<surname>Schuh</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Blood</title>
		<imprint>
			<biblScope unit="volume">120</biblScope>
			<biblScope unit="page" from="4191" to="4196" />
			<date type="published" when="2012" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b21">
	<analytic>
		<title level="a" type="main">The clonal and mutational evolution spectrum of primary triple-negative breast cancers</title>
		<author>
			<persName>
				<forename type="first">S</forename>
				<forename type="middle">P</forename>
				<surname>Shah</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nature</title>
		<imprint>
			<biblScope unit="volume">486</biblScope>
			<biblScope unit="page" from="395" to="399" />
			<date type="published" when="2012" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b22">
	<analytic>
		<title level="a" type="main">Trap: a tree approach for fingerprinting subclonal tumor composition</title>
		<author>
			<persName>
				<forename type="first">F</forename>
				<surname>Strino</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nucleic Acids Res</title>
		<imprint>
			<biblScope unit="volume">41</biblScope>
			<biblScope unit="page">165</biblScope>
			<date type="published" when="2013" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b23">
	<analytic>
		<title level="a" type="main">Clonal evolution in breast cancer revealed by single nucleus genome sequencing</title>
		<author>
			<persName>
				<forename type="first">Y</forename>
				<surname>Wang</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nature</title>
		<imprint>
			<biblScope unit="volume">512</biblScope>
			<biblScope unit="page" from="155" to="160" />
			<date type="published" when="2014" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b24">
	<monogr>
		<title level="m" type="main">Integer Programming. Wiley-Interscience series in discrete mathematics and optimization</title>
		<author>
			<persName>
				<forename type="first">L</forename>
				<surname>Wolsey</surname>
			</persName>
		</author>
		<imprint>
			<date type="published" when="1998" />
			<publisher>Wiley</publisher>
			<pubPlace>New York</pubPlace>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b25">
	<analytic>
		<title level="a" type="main">Inferring clonal composition from multiple sections of a breast cancer</title>
		<author>
			<persName>
				<forename type="first">H</forename>
				<surname>Zare</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">PLoS Comput. Biol</title>
		<imprint>
			<biblScope unit="volume">10</biblScope>
			<biblScope unit="page">1003703</biblScope>
			<date type="published" when="2014" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b26">
	<analytic>
		<title level="a" type="main">Intratumor heterogeneity in localized lung adenocarcinomas delineated by multiregion sequencing</title>
		<author>
			<persName>
				<forename type="first">J</forename>
				<surname>Zhang</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Science</title>
		<imprint>
			<biblScope unit="volume">346</biblScope>
			<biblScope unit="page" from="256" to="259" />
			<date type="published" when="2014" />
		</imprint>
	</monogr>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>