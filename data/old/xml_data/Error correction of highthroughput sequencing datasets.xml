
<?xml version="1.0" encoding="UTF-8"?>
<TEI xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 /home/joey/Project/grobid/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<encodingDesc>
			<appInfo>
				<application version="0.4.2-SNAPSHOT" ident="GROBID" when="2017-08-10T23:42+0000">
					<ref target="https://github.com/kermitt2/grobid">GROBID - A machine learning software for extracting information from scholarly documents</ref>
				</application>
			</appInfo>
		</encodingDesc>
		<fileDesc>
			<titleStmt>
				<title level="a" type="main">Error correction of high-throughput sequencing datasets with non-uniform coverage</title>
			</titleStmt>
			<publicationStmt>
				<publisher/>
				<availability status="unknown"><licence/></availability>
				<date type="published" when="2011">2011</date>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author>
							<persName>
								<forename type="first">Paul</forename>
								<surname>Medvedev</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department">Department of Computer Science and Engineering</orgName>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Eric</forename>
								<surname>Scott</surname>
							</persName>
							<affiliation key="aff1">
								<orgName type="department">Bioinformatics Program</orgName>
								<orgName type="institution">University of California</orgName>
								<address>
									<settlement>San Diego</settlement>
									<region>CA</region>
									<country key="US">USA</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Boyko</forename>
								<surname>Kakaradov</surname>
							</persName>
							<affiliation key="aff1">
								<orgName type="department">Bioinformatics Program</orgName>
								<orgName type="institution">University of California</orgName>
								<address>
									<settlement>San Diego</settlement>
									<region>CA</region>
									<country key="US">USA</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Pavel</forename>
								<surname>Pevzner</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department">Department of Computer Science and Engineering</orgName>
							</affiliation>
						</author>
						<title level="a" type="main">Error correction of high-throughput sequencing datasets with non-uniform coverage</title>
					</analytic>
					<monogr>
						<imprint>
							<biblScope unit="volume">27</biblScope>
							<biblScope unit="page" from="137" to="141"/>
							<date type="published" when="2011">2011</date>
						</imprint>
					</monogr>
					<idno type="DOI">10.1093/bioinformatics/btr208</idno>
					<note>[19:57 6/6/2011 Bioinformatics-btr208.tex] Page: i137 i137–i141 BIOINFORMATICS Availability: http://www.cs.toronto.edu/~pashadag. Contact: pmedvedev@cs.ucsd.edu</note>
				</biblStruct>
			</sourceDesc>
		</fileDesc>
		<profileDesc>
			<abstract>
				<p>Motivation: The continuing improvements to high-throughput sequencing (HTS) platforms have begun to unfold a myriad of new applications. As a result, error correction of sequencing reads remains an important problem. Though several tools do an excellent job of correcting datasets where the reads are sampled close to uniformly, the problem of correcting reads coming from drastically non-uniform datasets, such as those from single-cell sequencing, remains open. Results: In this article, we develop the method Hammer for error correction without any uniformity assumptions. Hammer is based on a combination of a Hamming graph and a simple probabilistic model for sequencing errors. It is a simple and adaptable algorithm that improves on other tools on non-uniform single-cell data, while achieving comparable results on normal multi-cell data.</p>
			</abstract>
		</profileDesc>
	</teiHeader>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1">INTRODUCTION</head><p>The continuing improvements to high-throughput sequencing (HTS) platforms have begun to unfold a myriad of new and exciting applications such as transcriptome analysis, metagenomics, singlecell assembly and variation detection. In addition, classical problems such as assembly are becoming feasible for large-scale endeavours, such as the Genome 10K project which seeks to assemble the genomes of 10 000 novel species (Genome 10K Community of<ref type="bibr">Scientists, 2009</ref>). All these projects face the same difficulty of handling the base errors that are inevitably prevalent in HTS datasets. Error correction of reads has thus come to the forefront as an essential problem, with a slew of publications in the last 2 years (<ref type="bibr" target="#b4">Ilie et al., 2010;</ref><ref type="bibr" target="#b6">Kelley et al., 2010;</ref><ref type="bibr" target="#b14">Qu et al., 2009;</ref><ref type="bibr" target="#b17">Salmela, 2010;</ref><ref type="bibr" target="#b18">Schroder et al., 2009;</ref><ref type="bibr" target="#b19">Shi et al., 2010;</ref><ref type="bibr" target="#b20">Wijaya et al., 2009;</ref><ref type="bibr" target="#b21">Yang et al., 2010;</ref><ref type="bibr" target="#b24">Zhao et al., 2010</ref>). A common approach of error correction of reads is to determine a threshold and correct k-mers whose multiplicities fall below the threshold (<ref type="bibr" target="#b0">Chaisson and Pevzner, 2008;</ref><ref type="bibr" target="#b6">Kelley et al., 2010;</ref><ref type="bibr" target="#b13">Pevzner et al., 2001;</ref><ref type="bibr" target="#b19">Shi et al., 2010;</ref><ref type="bibr" target="#b24">Zhao et al., 2010</ref>). Choosing the correct threshold is crucial since a low threshold will result in too many uncorrected errors, while a high threshold will result in the loss of correct k-mers. The histogram of the multiplicities of k-mers will show a mixture of two distributions—that of the error-free k-mers, and that of the erroneous k-mers. When the coverage is high and uniform, these distributions are centered far apart and can be * To whom correspondence should be addressed. separated without much loss using a cutoff threshold; such methods therefore achieve excellent results (<ref type="bibr" target="#b6">Kelley et al., 2010</ref>). Though HTS platforms provide relatively uniform coverage in many standard sequencing experiments, in some of the more challenging applications, such as transcriptome sequencing, the coverage remains drastically uneven (<ref type="bibr" target="#b9">Li et al., 2010;</ref><ref type="bibr" target="#b14">Qu et al., 2009</ref>). Another prominent emerging example is that of singlecell sequencing, which has enabled the investigation (<ref type="bibr" target="#b7">Kvist et al., 2007;</ref><ref type="bibr" target="#b12">Mussmann et al., 2007</ref>) of a diverse range of uncultivated bacteria, from the surface ocean environment (<ref type="bibr" target="#b22">Yooseph et al., 2007</ref>) to the human body (<ref type="bibr" target="#b3">Gill et al., 2006</ref>). Though these bacteria are not amenable to normal sequencing, recent advances in DNA amplification technology have enabled genome sequencing directly from individual cells without requiring growth in culture (<ref type="bibr" target="#b15">Raghunathan et al., 2005;</ref><ref type="bibr" target="#b16">Rodrigue et al., 2009</ref>). The read datasets thus obtained from single-cells suffer from amplification bias, resulting in orders of magnitude difference in coverage (<ref type="bibr" target="#b15">Raghunathan et al., 2005</ref>) and the complete absence of coverage in some regions. Previous, single-cell studies have used error correction tools (<ref type="bibr" target="#b11">Margulies et al., 2005;</ref><ref type="bibr" target="#b23">Zerbino and Birney, 2008</ref>) that assume near-uniform coverage. However, such approaches are not as effective and result in decreased quality of assemblies when the two multiplicity distributions of erroneous and error-free k-mers are not separable using a simple threshold. Thus, despite the initial technological difficulties, the challenges facing single-cell genomics are increasingly computational rather than experimental (<ref type="bibr" target="#b16">Rodrigue et al., 2009</ref>). For applications such as these, it becomes paramount to develop better error-correction algorithms that do not assume uniformity of coverage. Recent papers have introduced a powerful idea that has the potential to remove uniformity assumptions (<ref type="bibr" target="#b4">Ilie et al., 2010;</ref><ref type="bibr" target="#b14">Qu et al., 2009;</ref><ref type="bibr" target="#b17">Salmela, 2010;</ref><ref type="bibr" target="#b18">Schroder et al., 2009;</ref><ref type="bibr" target="#b20">Wijaya et al., 2009;</ref><ref type="bibr" target="#b21">Yang et al., 2010</ref>). Consider two k-mers x and y that are within a small Hamming distance and present in the read dataset. If our genome does not contain many non-exact repeats, then it is likely that both x and y were generated by the k-mer among them that has higher multiplicity. In this way, we can correct the lower multiplicity k-mer to the higher multiplicity one, without relying on uniformity. This can be further generalized by considering the notion of the Hamming graph, whose vertices are the distinct k-mers (annotated with their multiplicities) and edges connect k-mers with a Hamming distance less than or equal to a parameter τ (<ref type="bibr" target="#b21">Yang et al., 2010</ref>). In this article, we develop the method Hammer for error correction without any uniformity assumptions. Hammer is based on a combination of the Hamming graph and a simple probabilistic model. It is a simple and adaptable algorithm that improves onPage: i138 i137–i141</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>P.Medvedev et al.</head><p>other tools on non-uniform single-cell Escherichia coli data, while achieving comparable results on normal multi-cell data.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2">METHODS</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>We will first</head><p>present the simple probabilistic model on which Hammer is based, and then present the algorithm.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.1">Model</head><p>We model sequencing as a process that repeatedly identifies a genomic position at random with an arbitrary (not necessarily uniform) distribution. Then for each position of u, it introduces a mutation with probabilty , and generates the resulting k-mer for the dataset. We denote G(u) as the set of all k-mers that were generated by u, and we call u a generating k-mer. Let us assume for the moment that we are given a multi-set C = G(u) of all the k-mers that were generated by u, but we do not know the identity of u. We wish to find the k-mer x that maximizes the likelihood of being the generator for C. The likelihood that x generates C is given by</p><formula>L(x) = y∈C (1−) k−d(x,y) d(x,y)</formula><p>where d(x,y) is the Hamming distance between x and y. It follows that maximizing L(x) is equivalent to minimizing</p><formula>S(x) = y∈C d(x,y) (1)</formula><p>which we call the score. Define the consensus of C as a k-mer that at position i contains the most frequent nucleotide at that position in C, with ties broken arbitrarily. Finding the k-mer x that minimizes S(x) turns out to be easy (<ref type="bibr" target="#b5">Jones and Pevzner, 2004</ref>):This observation is at the basis of the Hammer algorithm. In reality, we do not know the multi-sets C = G(u); however, we can use the connected components of the Hamming graph to approximate the multi-sets C. We now present the steps of the algorithm.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.2">Algorithm</head><p>Hammer first uses a sort to identify the set K of distinct k-mers in the reads as well as a table m(x) storing the multiplicity of each k-mer. Next, it finds the connected components of the Hamming graph. It is computationally prohibitive to do an all-pairs comparison between the k-mers; however, this is a classical problem from combinatorial pattern matching for which there exist well-studied solutions that rely on spaced seeds (<ref type="bibr" target="#b5">Jones and Pevzner, 2004</ref>):</p><formula>Observation 2. Let s 1 ,...</formula><formula>) = y(s j ).</formula><p>Based on this observation, we create τ +1 spaced seeds s j ={j,j +τ + 1,j +2(τ +1),...}. Then we make τ +1 copies of the k-mer set K with the j-th copy containing the restriction of K to the indices s j. Each copy is then lexicographically sorted. In order to account for double-strandedness, we include the reverse complements of every k-mer in our set. Next, we linearly scan through each copy, and identify equivalence blocks, i.e. sets of k-mers that are equal when restricted to s j. For every equivalence block, we compute the Hamming distances of all pairs of corresponding full-length k-mers. If a pair of k-mers is within a Hamming distance τ, their components are joined. The components are implemented using a union-find data structure (see<ref type="bibr" target="#b1">Cormen et al., 2001</ref>for details).There are five k-mers clustered together, with five loci having misalignments. We compute the consensus string (taking multiplicities into account), which we find is already in the cluster (boxed in). All the k-mers are then corrected to the consenus. On the right is an example of a common cluster in low coverage regions. The generating k-mer was sequenced three times but each time with a single error. There are three k-mers in the cluster, but the consensus (boxed in) has not been sequenced and therefore is not in the cluster. Nevertheless, we correct all the k-mers to the consensus, allowing Hammer to reconstruct new k-mers that are not present in the original data. This algorithm finds the connected components of the Hamming graph, which for simplicity we will refer to as clusters. It is similar to the algorithm of Reptile (<ref type="bibr" target="#b21">Yang et al., 2010</ref>), however, an important difference is that Reptile uses seeds that are consecutive blocks. It is known from sequence alignment (<ref type="bibr" target="#b10">Ma et al., 2002</ref>) that using spaced rather than consecutive seeds make it less likely for two k-mers to be equal. Because our index sets are spaced out across the whole range of k, the equivalence blocks should be smaller, allowing for a faster running time in practice. Finally, we process the clusters one at a time. Let C be the current cluster. If the cluster does not have size one and the consensus string is unique, we correct every k-mer in the cluster to the consensus string (<ref type="figure" target="#fig_1">Fig. 1</ref>). We refer to clusters which consist of only a single k-mer as singletons.</p><p>This k-mer is trivially the consensus. It must either be the only element in the generating set of its generating k-mer, or it simply contains more than τ errors than the other members of the set. In another case, there are multiple consensus strings. which typically occurs in small clusters of size two or three. We refer to such clusters as ambiguous. In both of these cases, the Hamming graph does not provide good information regarding the correctness of the k-mers of C. We therefore make a decision solely based on the multiplicity of each k-mer x ∈ C, weighed by the quality values (<ref type="bibr" target="#b6">Kelley et al., 2010</ref>). If it is greater than a threshold singletonCutoff, we keep x in the dataset; otherwise we remove it. The choice of singletonCutoff should be based on minimum coverage—if we expect certain regions to have low coverage, singletonCutoff should be around one (we use one in our single-cell experiment). We also have a parameter saveCutoff, which makes sure that k-mers with a weighed multiplicity greater than or equal to saveCutoff are never removed, even if they are not the consensus of their cluster. This helps to address a shortcoming of our model, namely, that it supposes that there is only one correct k-mer in a cluster.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.3">Time/space analysis and parameters</head><p>Hammer's running time and memory requirements are asymptotically (and in practice) dominated by the initial sorting of distinct k-mers. The sorting is done by storing the reads in memory and representing each k-mer as a pointer to its location in the reads. When n r is the number of reads, is the read length, and n k = n r (−k +1) is the number of k-mers, the sort takes O(n k logn k ) time and O(n k logn r ) memory (here we treat and k as constants). There are more efficient alternatives for sorting k-mers, including map-reduce (<ref type="bibr" target="#b6">Kelley et al., 2010</ref>), hash functions and Graphical Processing Unit (GPU)-based methods (<ref type="bibr" target="#b19">Shi et al., 2010</ref>). However, for the purposes of the bacterial genomes we study in this article, we found that a sort sufficed.Page: i139 i137–i141After building the set of distinct k-mers K, we no longer need to deal with all the n k k-mers, but instead only with the distinct k-mers and their multiplicities. The second step of sorting the τ +1 copies of the k-mers therefore takes time O(n * k logn * k ), where n * k =|K| is the number of distinct k-mers in the dataset. Finding the connected components requires us to maintain a union find structure of size O(n * k ). Scanning through the sorted sets requires an all-pair comparison within each equivalence block, which in worst case can take O((n * k ) 2 ) time; in practice, though, the size of the blocks is small. Finally, computing the consensuses of the clusters can be done in O(n * k ) time. Note that the steps of finding the connected components and their consensus are easily parallelizable, with almost no shared memory requirement. The three parameters of Hammer are: τ, the joining distance for k-mers, singletonCutoff, the threshold for singleton and ambiguous clusters, saveCutoff, the threshold above which k-mers are never removed, and the k-mer size. The trade-offs with the k-mer size are similar to those in assembly. Too small of a k results in reads being chopped up too much, with important information about the genome being lost. However, setting k too large results in low k-mer coverage and lowers the accuracy of the algorithm. The value of τ should be large enough as to connect most of the generating set of a k-mer into one connected component. Varying the value of singletonCutoff or saveCutoff represents a direct trade-off between sensitivity and specificity.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>i138</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Error correction of HTS datasets</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3">RESULTS</head><p>To test the effectiveness of Hammer on non-uniform datasets, we used reads generated from a single-cell of E.coli K-12 strain, using one lane of the Illumina GAII pipeline (<ref type="bibr">Chitsaz,H. et al., 2011</ref>, submitted for publication). They total 600× coverage mostly by 100 bp long reads. We mapped the reads to the E.coli genome using bowtie (<ref type="bibr" target="#b8">Langmead et al., 2009</ref>) and found extremely non-uniform coverage (<ref type="figure" target="#fig_2">Fig. 2</ref>). There were 94K positions that are not covered by any read, with an additional 116K being covered by less than six reads. In contrast, in an alternate dataset that was generated on a normal multi-cell sample with the same coverage and read length, there were no uncovered regions. Prior to working with this dataset, we trimmed the first three bases and any trailing bases with a quality value of 2; we then removed any remaining reads with ambiguous bases. We use a value of k = 55 to run Hammer on this dataset, motivated by the fact that it was found to work best for assemblers on this data (<ref type="bibr">Chitsaz,H. et al.,</ref>2011, submitted for publication). The distance τ used in building the Hamming graph was set to two, since we found larger values did not significantly decrease the number of singleton clusters. For the singletonCutoff, we used the default value of 1, which, roughly speaking, means that any singleton k-mer that appears at least twice with decent quality values is kept. However, to demonstrate that Hammer can be made super-sensitive if needed, we also ran Hammer with a singletonCutoff of 0.5. For the saveCutoff, we used a value of 10. The results are shown in<ref type="figure" target="#fig_3">Figure 3</ref>and<ref type="figure" target="#tab_1">Table 1</ref>. To measure the quality of a set of reads, we measure its sensitivity and positive predictive value (PPV) with respect to the source genome. Let K be the set of distinct k-mers present in the reads, and let S be the kspectrum of E.coli (i.e. the set of all distinct k-mers). The sensitivity is measured as |K∩S| |S| and reflects the percentage of k-mers from the genome that are present in the reads. The positive predictive value is |K∩S| |K| and reflects the fraction of k-mers in the dataset that do not contain errors. Note that we do not measure the quality of the corrected reads against the quality of uncorrected reads directly, but by measuring the quality of each separately against the E.coli genome.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.1">Comparison to other tools</head><p>We compared our results against Quake, which is a cutoff thresholdbased method that was recently shown to have superior performance i139on normal (multi-cell) sequencing data (<ref type="bibr" target="#b6">Kelley et al., 2010</ref>). Quake works by modeling the weighted multiplicity histogram of k-mers as a combination of two separate distributions (one from erroneous reads, one from accurate reads), and using that model to determine the best cutoff threshold. It could not find any cutoff on the single-cell data, likely because the distribution model is based on uniformity assumptions that do not hold. However, we could manually try different values, and we plot the results in<ref type="figure" target="#fig_3">Figure 3</ref>and show the raw numbers in<ref type="figure" target="#tab_1">Table 1</ref>. Hammer improves on Quake, retaining about 19K more genomic reads while reducing the number of erroneous reads by ∼ 390 K. Though Quake was designed with uniformity in mind, an alternate method called HiTEC was recently published, which does not strongly rely on uniformity assumptions (<ref type="bibr" target="#b4">Ilie et al., 2010</ref>). HiTEC is based on a similar idea of using clusters to identify correct reads, albeit using suffix trees instead of the Hamming graph. Since HiTEC currently does not support ambiguous bases or variable length reads, in order to run it on our data we had to trim our reads down to 70 bp and remove all reads containing ambiguous bases. We then ran Hammer on the same altered dataset, with the results shown in<ref type="figure" target="#tab_1">Table 1</ref>. HiTEC sensitivity was nearly the same (a difference of 0.06%, or ∼3 K reads, in favor of Hammer), but its PPV was significantly lower (only 53% compared to 90% by Hammer).</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>P.Medvedev et al.</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.2">Analysis of Results</head><p>Out of all the correct distinct k-mers present in the data, 10% were in singletons. The distribution of their weighted multiplicities is shown in<ref type="figure" target="#fig_4">Figure 4</ref>. Most of the incorrect k-mers have weights &lt;1, however, there is also ∼53K correct k-mers that weigh between 0.5 and 1. This difference is apparent when we ran Hammer with a singletonCutoff of 0.5 (<ref type="figure" target="#tab_1">Table 1</ref>), allowing us to increase 1.2% in sensitivity. We categorize each non-singleton and non-ambiguous cluster according to whether the consensus is correct (i.e. exists in E.coli) and the number of correct k-mers present in the cluster prior to correction (<ref type="figure" target="#tab_2">Table 2</ref>). In 90% of the clusters, the consensus is accurate, and in 99% of those cases the consensus was present and was the only correct k-mer in the cluster. The second largest category of clusters (10%) was where no correct k-mer was present and the chosen consensus was also incorrect. When the consensus is not present in the cluster, it is usually very small. However, in 3% of cases where the consensus is not present, it turned out to be correct, representing an importantClassification of non-singleton and non-ambiguous clusters for both single-cell and normal data. Each cluster will have a consensus that is either correct or not, and will have a number of k-mers that were correct prior to correcion. We show the number of such clusters in Hammer's run on single-cell and on normal E.coli. gain in sensitivity. These cases allow us to reconstruct k-mers that were not present in the original genome. It remains an outstanding problem to find a way to accurately distinguish whether the consensus of a cluster is correct or not, when it is not present in the cluster. Another category of interest is where the consensus was correct but there was more than one correct k-mer in the cluster. These cases occur when the genome has non-identical repeats, and hence there are correct k-mers with a small Hamming distance. Because this is a bacteria dataset, there were only 13K such cases, with a large fraction of them retained because of the saveCutoff. In eukaryotic genomes, however, this will represent a more serious problem, and thus extending Hammer for eukaryotic genomes is important continuing work.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.3">Multi-cell normal data</head><p>We also tested Hammer on data generated from a normal multi-cell lane of E.coli with 600× coverage and 100 bp long reads (accession number ERX002508). We applied the same pre-filtering as for the single-cell data. The coverage of this dataset was close to uniform, with every single base covered by at least one read. As expected, Quake performed extremely well (<ref type="figure" target="#tab_1">Table 1</ref>), achieving 98% PPV and 99.98% sensitivity. Hammer did nearly as well, with 95% PPV and 99.56% sensitivity. There were still 242K consensus k-mers chosen when there were no correct k-mers in the cluster at all (<ref type="figure" target="#tab_1">Table 1</ref>). Again, it will be important to develop a way to detect these clusters without assuming uniformity. Though Hammer's results are comparable, Quake currently remains a better choice when it is known that the dataset is uniform.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.4">Computational requirements</head><p>We used a single Intel Xeon 1.8 GHz machine with four dual-cores and 32 G of RAM. For our dataset, the run took approximately 4 h and needed 20 G of RAM. The longest step was the initial sorting of the k-mers, which took about 2 h.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4">DISCUSSION</head><p>Despite the success of many error-correction tools, emerging areas such as single-cell sequencing fuel the need to develop better algorithms for situations of non-uniform coverage. Recent approaches have taken steps in the right direction by looking together i140</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Error correction of HTS datasets</head><p>at all k-mers within a small Hamming neighborhood. Some rely on maximum likelihood estimation (<ref type="bibr" target="#b20">Wijaya et al., 2009</ref>), some on complex sets of rules (<ref type="bibr" target="#b21">Yang et al., 2010</ref>), and some on greedy local heuristics (<ref type="bibr" target="#b14">Qu et al., 2009</ref>). With the notable exception of<ref type="bibr" target="#b14">Qu et al. (2009)</ref>, these algorithms still rely on uniformity of coverage. Moreover, most of these algorithms make decisions about k-mers independent of the decisions made about other k-mers in the same cluster. In this article, we have developed an algorithm that makes a decision about all the k-mers with a cluster in a unified but simple manner, allowing us to handle non-uniform single-cell datasets. In Hammer, we proposed the simple choice of the consensus string as a way to correct the k-mers within a cluster. However, this step is easily customizable with whatever choice may best suit the data, and we believe that this is a strength of our approach. In particular, one of Hammer's limitations is that it assumes that there is at most one correct k-mer in a cluster. Though this assumption results in relatively small losses in E.coli, and is furthermore offset by the use of the saveCutoff, it becomes a more serious problem in highly repetitive eukaryotic genomes. It is possible, however, to develop a more sophisticated approach that allows the identification of multiple correct k-mers within a cluster (<ref type="bibr" target="#b20">Wijaya et al., 2009</ref>). Another shortcoming is that Hammer chops the reads up into k-mers—while this is not be a problem for many downstream assemblers who do this anyway, it may be for other tools that require mapping. There are numerous existing techniques for reconstructing reads from the set of corrected k-mers (<ref type="bibr" target="#b0">Chaisson and Pevzner, 2008;</ref><ref type="bibr" target="#b6">Kelley et al., 2010;</ref><ref type="bibr" target="#b21">Yang et al., 2010</ref>), and these may be incorporated into Hammer in the future. Newer platforms, such as the PacBio sequencer that has a large amount of indel errors, will also undoubtedly challenge Hammer's current approach; however, we believe that the idea of looking at all the k-mers within a single cluster jointly is a powerful one and will continue to be useful.</p></div><figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_0"><head></head><figDesc>[19:57 6/6/2011 Bioinformatics-btr208.tex]</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_1"><head>Fig.1.</head><figDesc>Fig. 1. On the left is an example of a typical cluster with good coverage. There are five k-mers clustered together, with five loci having misalignments. We compute the consensus string (taking multiplicities into account), which we find is already in the cluster (boxed in). All the k-mers are then corrected to the consenus. On the right is an example of a common cluster in low coverage regions. The generating k-mer was sequenced three times but each time with a single error. There are three k-mers in the cluster, but the consensus (boxed in) has not been sequenced and therefore is not in the cluster. Nevertheless, we correct all the k-mers to the consensus, allowing Hammer to reconstruct new k-mers that are not present in the original data.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_2"><head>Fig.2.</head><figDesc>Fig. 2. The coverage of E.coli by single-cell reads. There are 210K positions with coverage by less than six reads, while the average coverage is 600.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_3"><head>Fig.3.</head><figDesc>Fig. 3. Sensitivity and positive predictive values for single-cell reads. We show the results of varying the singletonCutoff in Hammer (0.5 and 1.0) and the cutoff in Quake (0.3–4.0). We also show the uncorrected dataset and the effect of simply trimming the reads down to 90 or 70 bases.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_4"><head>Fig.4.</head><figDesc>Fig. 4. The histogram showing the number of singletons with the given weighted multiplicity, on a vertical log scale.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_3" validated="true"><figDesc>Table 1. Sensitivity and positive predictive values for our experiments</figDesc><table>E.coli 
Method 
Total distinct Total correct PPV Sensitivity 
dataset 
k-mers 
k-mers 
(%) (%) 

single-cell Uncorrected 
87 579 268 4 422 073 
5 96.86 
Hammer (cutoff = 1) 
5 732 025 4 345 536 
76 95.18 
Quake (cutoff = 4) 
6 122 140 4 326 126 
71 94.76 
Hammer (cutoff = 0.5) 17 790 512 4 398 487 
25 96.34 
HiTEC (trimmed) 
8 047 103 4 241 039 
53 92.90 
Hammer (trimmed) 
4 727 996 4 244 005 
90 92.96 
Normal 
Uncorrected 
77 421 925 4 564 319 
6 99.98 
Hammer 
4 787 644 4 545 158 
95 99.56 
Quake 
4 661 707 4 563 956 
98 99.97 

</table></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_4" validated="true"><figDesc>Table 2. Cluster classification</figDesc><table>Cluster category 
Number of clusters 

Consensus 
Num. correct 
Single-cell 
Normal 
accurate? 
k-mers in cluster 
E.coli 
E.coli 

Yes 
&gt;1 
12 717 
13 056 
Yes 
1 
3924 955 
4 530 503 
Yes 
0 
14 603 
8427 
No 
&gt;0 
643 
816 
No 
0 
425 948 
241 628 

</table></figure>

			<note place="foot">at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>

			<note place="foot">i141 at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>
		</body>
		<back>

			<div type="acknowledgement">
<div xmlns="http://www.tei-c.org/ns/1.0"><head>ACKNOWLEDGEMENTS</head></div>
			</div>

			<div type="references">

				<listBibl>

<biblStruct   xml:id="b0">
	<analytic>
		<title level="a" type="main">Short read fragment assembly of bacterial genomes</title>
		<author>
			<persName>
				<forename type="first">M</forename>
				<forename type="middle">J</forename>
				<surname>Chaisson</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">P</forename>
				<forename type="middle">A</forename>
				<surname>Pevzner</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Genome Res</title>
		<imprint>
			<biblScope unit="volume">18</biblScope>
			<biblScope unit="page" from="324" to="330" />
			<date type="published" when="2008" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b1">
	<monogr>
		<title level="m" type="main">Introduction to Algorithms</title>
		<author>
			<persName>
				<forename type="first">T</forename>
				<forename type="middle">H</forename>
				<surname>Cormen</surname>
			</persName>
		</author>
		<imprint>
			<date type="published" when="2001" />
			<publisher>MIT PressMcGrawHill Book Company</publisher>
			<biblScope unit="page" from="505" to="509" />
		</imprint>
	</monogr>
	<note>2nd. edn. The</note>
</biblStruct>

<biblStruct   xml:id="b2">
	<analytic>
		<title level="a" type="main">Genome 10K: a proposal to obtain wholegenome sequence for 10 000 vertebrate species</title>
	</analytic>
	<monogr>
		<title level="j">Genome 10K Community of Scientists J. Heredity</title>
		<imprint>
			<biblScope unit="volume">100</biblScope>
			<biblScope unit="page" from="659" to="674" />
			<date type="published" when="2009" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b3">
	<analytic>
		<title level="a" type="main">Metagenomic analysis of the human distal gut microbiome</title>
		<author>
			<persName>
				<forename type="first">S</forename>
				<forename type="middle">R</forename>
				<surname>Gill</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Science</title>
		<imprint>
			<biblScope unit="volume">312</biblScope>
			<biblScope unit="page" from="1355" to="1359" />
			<date type="published" when="2006" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b4">
	<analytic>
		<title level="a" type="main">HiTEC: accurate error correction in high-throughput sequencing data</title>
		<author>
			<persName>
				<forename type="first">L</forename>
				<surname>Ilie</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">27</biblScope>
			<biblScope unit="page" from="295" to="302" />
			<date type="published" when="2010" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b5">
	<analytic>
		<title level="a" type="main">An Introduction to</title>
		<author>
			<persName>
				<forename type="first">N</forename>
				<forename type="middle">C</forename>
				<surname>Jones</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">P</forename>
				<forename type="middle">A</forename>
				<surname>Pevzner</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics Algorithms (Computational Molecular Biology</title>
		<imprint>
			<publisher>The MIT Press</publisher>
			<biblScope unit="page">329</biblScope>
			<date type="published" when="2004" />
			<publisher>The MIT Press</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b6">
	<analytic>
		<title level="a" type="main">Quake: quality-aware detection and correction of sequencing errors</title>
		<author>
			<persName>
				<forename type="first">D</forename>
				<surname>Kelley</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Genome Biol</title>
		<imprint>
			<biblScope unit="volume">11</biblScope>
			<biblScope unit="page">116</biblScope>
			<date type="published" when="2010" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b7">
	<analytic>
		<title level="a" type="main">Specific single-cell isolation and genomic amplification of uncultured microorganisms</title>
		<author>
			<persName>
				<forename type="first">T</forename>
				<surname>Kvist</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Appl. Microbiol. Biotechnol</title>
		<imprint>
			<biblScope unit="volume">74</biblScope>
			<biblScope unit="page" from="926" to="935" />
			<date type="published" when="2007" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b8">
	<analytic>
		<title level="a" type="main">Ultrafast and memory-efficient alignment of short DNA sequences to the human genome</title>
		<author>
			<persName>
				<forename type="first">B</forename>
				<surname>Langmead</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Genome Biol</title>
		<imprint>
			<biblScope unit="volume">10</biblScope>
			<biblScope unit="page">25</biblScope>
			<date type="published" when="2009" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b9">
	<analytic>
		<title level="a" type="main">Modeling non-uniformity in short-read rates in rna-seq data</title>
		<author>
			<persName>
				<forename type="first">J</forename>
				<surname>Li</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Genome Biol</title>
		<imprint>
			<biblScope unit="volume">11</biblScope>
			<biblScope unit="page">50</biblScope>
			<date type="published" when="2010" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b10">
	<analytic>
		<title level="a" type="main">PatternHunter: faster and more sensitive homology search</title>
		<author>
			<persName>
				<forename type="first">B</forename>
				<surname>Ma</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">18</biblScope>
			<biblScope unit="page" from="440" to="445" />
			<date type="published" when="2002" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b11">
	<analytic>
		<title level="a" type="main">Genome sequencing in microfabricated high-density picolitre reactors</title>
		<author>
			<persName>
				<forename type="first">M</forename>
				<surname>Margulies</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nature</title>
		<imprint>
			<biblScope unit="volume">437</biblScope>
			<biblScope unit="page" from="376" to="80" />
			<date type="published" when="2005" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b12">
	<analytic>
		<title level="a" type="main">Insights into the genome of large sulfur bacteria revealed by analysis of single filaments</title>
		<author>
			<persName>
				<forename type="first">M</forename>
				<surname>Mussmann</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">PLoS Biol</title>
		<imprint>
			<biblScope unit="volume">5</biblScope>
			<biblScope unit="page">230</biblScope>
			<date type="published" when="2007" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b13">
	<analytic>
		<title level="a" type="main">An Eulerian path approach to DNA fragment assembly</title>
		<author>
			<persName>
				<forename type="first">P</forename>
				<forename type="middle">A</forename>
				<surname>Pevzner</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proc. Natl Acad. Sci. USA, 98</title>
		<meeting>. Natl Acad. Sci. USA, 98</meeting>
		<imprint>
			<date type="published" when="2001" />
			<biblScope unit="page" from="9748" to="9753" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b14">
	<analytic>
		<title level="a" type="main">Efficient frequency-based de novo short-read clustering for error trimming in next-generation sequencing</title>
		<author>
			<persName>
				<forename type="first">W</forename>
				<surname>Qu</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Genome Res</title>
		<imprint>
			<biblScope unit="volume">19</biblScope>
			<biblScope unit="page" from="1309" to="1315" />
			<date type="published" when="2009" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b15">
	<analytic>
		<title level="a" type="main">Genomic DNA amplification from a single bacterium</title>
		<author>
			<persName>
				<forename type="first">A</forename>
				<surname>Raghunathan</surname>
			</persName>
		</author>
		<author>
			<persName>
				<surname>Jr</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Appl. Environ. Microbiol</title>
		<imprint>
			<biblScope unit="volume">71</biblScope>
			<biblScope unit="page" from="3342" to="3347" />
			<date type="published" when="2005" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b16">
	<analytic>
		<title level="a" type="main">Whole genome amplification and de novo assembly of single bacterial cells</title>
		<author>
			<persName>
				<forename type="first">S</forename>
				<surname>Rodrigue</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">PLoS ONE</title>
		<imprint>
			<date type="published" when="2009" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b17">
	<analytic>
		<title level="a" type="main">Correction of sequencing errors in a mixed set of reads</title>
		<author>
			<persName>
				<forename type="first">L</forename>
				<surname>Salmela</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">26</biblScope>
			<biblScope unit="page" from="1284" to="1290" />
			<date type="published" when="2010" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b18">
	<analytic>
		<title level="a" type="main">SHREC: a short-read error correction method</title>
		<author>
			<persName>
				<forename type="first">J</forename>
				<surname>Schroder</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">25</biblScope>
			<biblScope unit="page" from="2157" to="2163" />
			<date type="published" when="2009" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b19">
	<analytic>
		<title level="a" type="main">A parallel algorithm for error correction in high-throughput shortread data on cuda-enabled graphics hardware</title>
		<author>
			<persName>
				<forename type="first">H</forename>
				<surname>Shi</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Comput. Biol</title>
		<imprint>
			<biblScope unit="volume">17</biblScope>
			<biblScope unit="page" from="603" to="615" />
			<date type="published" when="2010" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b20">
	<analytic>
		<title level="a" type="main">Recount: expectation maximization based error correction tool for next generation sequencing data</title>
		<author>
			<persName>
				<forename type="first">E</forename>
				<surname>Wijaya</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Genome Inform. Ser</title>
		<imprint>
			<biblScope unit="volume">23</biblScope>
			<biblScope unit="page" from="189" to="201" />
			<date type="published" when="2009" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b21">
	<analytic>
		<title level="a" type="main">Reptile: representative tiling for short read error correction</title>
		<author>
			<persName>
				<forename type="first">X</forename>
				<surname>Yang</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">26</biblScope>
			<biblScope unit="page" from="2526" to="2533" />
			<date type="published" when="2010" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b22">
	<analytic>
		<title level="a" type="main">The sorcerer ii global ocean sampling expedition: Expanding the universe of protein families</title>
		<author>
			<persName>
				<forename type="first">S</forename>
				<surname>Yooseph</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">PLoS Biol</title>
		<imprint>
			<biblScope unit="volume">5</biblScope>
			<biblScope unit="page">16</biblScope>
			<date type="published" when="2007" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b23">
	<analytic>
		<title level="a" type="main">Velvet: algorithms for de novo short read assembly using de Bruijn graphs</title>
		<author>
			<persName>
				<forename type="first">D</forename>
				<forename type="middle">R</forename>
				<surname>Zerbino</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">E</forename>
				<surname>Birney</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Genome Res</title>
		<imprint>
			<biblScope unit="volume">18</biblScope>
			<biblScope unit="page" from="821" to="829" />
			<date type="published" when="2008" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b24">
	<analytic>
		<title level="a" type="main">Edar: an efficient error detection and removal algorithm for next generation sequencing data</title>
		<author>
			<persName>
				<forename type="first">X</forename>
				<surname>Zhao</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Comput. Biol</title>
		<imprint>
			<biblScope unit="volume">17</biblScope>
			<biblScope unit="page" from="1549" to="1560" />
			<date type="published" when="2010" />
		</imprint>
	</monogr>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>