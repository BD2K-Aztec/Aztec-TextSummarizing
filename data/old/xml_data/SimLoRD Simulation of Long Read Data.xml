
<?xml version="1.0" encoding="UTF-8"?>
<TEI xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 /home/joey/Project/grobid/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<encodingDesc>
			<appInfo>
				<application version="0.4.2-SNAPSHOT" ident="GROBID" when="2017-08-10T23:39+0000">
					<ref target="https://github.com/kermitt2/grobid">GROBID - A machine learning software for extracting information from scholarly documents</ref>
				</application>
			</appInfo>
		</encodingDesc>
		<fileDesc>
			<titleStmt>
				<title level="a" type="main">SimLoRD: Simulation of Long Read Data</title>
			</titleStmt>
			<publicationStmt>
				<publisher/>
				<availability status="unknown"><licence/></availability>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author>
							<persName>
								<forename type="first">Bianca</forename>
								<forename type="middle">K</forename>
								<surname>Stö Cker</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department" key="dep1">Genome Informatics</orgName>
								<orgName type="department" key="dep2">Institute of Human Genetics</orgName>
								<orgName type="institution">University of Duisburg-Essen</orgName>
								<address>
									<postCode>45147</postCode>
									<settlement>Essen, Germany</settlement>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Johannes</forename>
								<surname>Kö Ster</surname>
							</persName>
							<affiliation key="aff1">
								<orgName type="department">Life Sciences</orgName>
								<orgName type="institution">Centrum Wiskunde &amp; Informatica (CWI)</orgName>
								<address>
									<postCode>1098 XG</postCode>
									<settlement>Amsterdam</settlement>
									<country key="NL">The Netherlands</country>
								</address>
							</affiliation>
							<affiliation key="aff2">
								<orgName type="department" key="dep1">Medical Oncology</orgName>
								<orgName type="department" key="dep2">Dana-Farber Cancer Institute</orgName>
								<orgName type="department" key="dep3">Harvard Medical School</orgName>
								<address>
									<postCode>02215</postCode>
									<settlement>Boston</settlement>
									<region>MA</region>
									<country key="US">USA</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Sven</forename>
								<surname>Rahmann</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department" key="dep1">Genome Informatics</orgName>
								<orgName type="department" key="dep2">Institute of Human Genetics</orgName>
								<orgName type="institution">University of Duisburg-Essen</orgName>
								<address>
									<postCode>45147</postCode>
									<settlement>Essen, Germany</settlement>
								</address>
							</affiliation>
						</author>
						<title level="a" type="main">SimLoRD: Simulation of Long Read Data</title>
					</analytic>
					<monogr>
						<imprint>
							<date/>
						</imprint>
					</monogr>
					<idno type="DOI">10.1093/bioinformatics/btw286</idno>
					<note type="submission">Received on January 26, 2016; revised on April 11, 2016; accepted on April 25, 2016</note>
					<note>Sequence analysis *To whom correspondence should be addressed. Contact: Bianca.Stoecker@uni-due.de or Sven.Rahmann@uni-due.de. Supplementary information: Supplementary data are available at Bioinformatics online.</note>
				</biblStruct>
			</sourceDesc>
		</fileDesc>
		<profileDesc>
			<abstract>
				<p>Motivation: Third generation sequencing methods provide longer reads than second generation methods and have distinct error characteristics. While there exist many read simulators for second generation data, there is a very limited choice for third generation data. Results: We analyzed public data from Pacific Biosciences (PacBio) SMRT sequencing, developed an error model and implemented it in a new read simulator called SimLoRD. It offers options to choose the read length distribution and to model error probabilities depending on the number of passes through the sequencer. The new error model makes SimLoRD the most realistic SMRT read simulator available. Availability and Implementation: SimLoRD is available open source at</p>
			</abstract>
		</profileDesc>
	</teiHeader>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1">Introduction</head><p>Third generation sequencing technologies like SMRT (single molecule real time) sequencing are increasingly used because they yield considerably longer reads than second generation methods. The error characteristics of SMRT are fundamentally different from previous technologies: The basic error rates are higher (10–15%), but errors are considered unbiased and uniformly distributed (<ref type="bibr" target="#b1">Eid et al., 2009</ref>), which means that they can be reduced by sequencing a molecule several times. As more bioinformatics applications are developed for sequence analysis tasks from SMRT data or hybrid data, e.g. genome assembly, SNP calling, structural variant discovery, authors of such tools will benefit from read simulators that take into account the specifics of the SMRT technology. The existing manifold simulators for second generation technologies, such as ART for 454, Illumina and SOLiD reads (<ref type="bibr" target="#b2">Huang et al., 2012</ref>), do not do this. There are few simulators designed for SMRT reads, e.g. PBSIM (<ref type="bibr" target="#b3">Ono et al., 2013</ref>), FASTQSim (<ref type="bibr" target="#b4">Shcherbina, 2014</ref>) and Alchemy from the BLASR package (<ref type="bibr" target="#b0">Chaisson and Tesler, 2012</ref>), the latter now being deprecated along with the .bas.h5 format. PBSIM's defaults are based on now outdated chemistry and cannot be completely re-configured. Even if the read length is adapted, the conditional read quality distribution does not match well existing data (<ref type="figure" target="#fig_0">Fig. 1</ref>and Supplement). Also, PBSIM does not provide SAM-formatted alignments between the reference and the simulated reads. FASTQSim is a general-purpose tool for both read analysis and simulation. In particular, it provides pre-set parameters for SMRT simulation, but also allows to analyze an existing dataset with regard to its properties and simulate accordingly. However, it is unable to provide mapping information or alignments of simulated reads and it simulates reads rather slowly (8700 N. crassa reads with 30 cores took 90 min). The simulated length/quality distributions do not agree well with data (<ref type="figure" target="#fig_0">Fig. 1</ref>and Supplement), and it is difficult to change parameters directly. To improve upon the existing solutions, we developed a new read simulator called 'SimLoRD – Simulation of Long Read Data' that is convenient to use and easily re-configured when technical specifications change. The default values provide realistic simulation results according to the current state of the SMRT technology (<ref type="bibr">March 2016</ref>); see<ref type="figure" target="#fig_0">Figure 1</ref>.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2">Methods</head><p>Because the sequenced DNA fragments in a SMRT library are circular with adapter sequences between forward and backward strand, a V C The Author 2016. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com fragment may be sequenced multiple times in a single run. For a single pass through the sequence (subread), the error rate is high, but it is possible to calculate a consensus after multiple passes (circular consensus sequence read, CCS). Thus the error rate of CCSs decreases with the number of passes. Each CCS is simulated as follows from a given (or randomly generated) reference genome. First, a random chromosome of the reference and a random start position are chosen. Next, a read length is chosen according to the user-specified model, usually a log-normal distribution for genomic data and an empirical distribution corresponding to library size selection for RNA-seq data. If the reference contains Ns in the relevant part, those Ns are replaced randomly in the read. This yields an error-free simulated read. To determine base qualities and error probabilities, we first draw the (fractional) number of passes over the fragment, depending on the read length, from a v 2 distribution (details below). For example, 2.37 passes means that the whole read is read at least twice and a part (0.37 of the read) is read three times. The number of passes is used to determine final error probabilities for each base, starting from given baseline error probabilities (different for substitutions, insertions and deletion) for subreads. The read is traversed, and changes are applied for each base according to the final error probabilities. In the process, the true alignment to the reference is tracked. With probability 1/2, the completed read is reverse-complemented. To determine appropriate distributions and parameters for the simulation, we analyzed the properties of two freely available datasets from Pacific Biosciences (D1, D2;<ref type="figure">Table 1</ref>). The identified models and parameters were then validated with two different datasets (D3, D4). We found that the length of CCS reads has a log-normal distribution with certain parameters that are now the defaults in SimLoRD, while RNA reads are usually size selected, so their lengths should be drawn from a given empirical distribution. We also found that the number of passes p, given the read length ', can be modeled by a scaled chi-squared distribution with parameters nð'Þ (degrees of freedom) and scale parameter sð'Þ, both of which depend on the read length '. The exact dependency of n and s on ' is documented in the Supplement. If f n ðxÞ :¼ 1=ð2 n=2 Cðn=2ÞÞ Á x n=2À1 e Àx=2 is the chi-squared density with n degrees of freedom, then p has scaled density g n;s ðpÞ :¼ f n ðp=sÞ=s. With increasing p, basepair error probabilities decrease. We found that this dependency can be modeled by a noisy square root function: When e is a basepair error probability in a subread, in a CCS it becomes becomes e sðpÞ with sðpÞ ¼ ffiffiffiffiffiffiffiffiffiffiffi p þ a p Àb þ N with parameters a, b and normally distributed noise N (with additional parameters; see Supplement).</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3">The SimLoRD tool</head><p>SimLoRD is a command line tool implemented in Python 3 that uses the observations above to simulate SMRT CCS reads. The only required positional argument is the path prefix of the simulated reads. The parameter-n determines the number of simulated reads. The true alignments of the simulated reads to the reference are stored in SAM format (using .sam instead of .fastq as file extension; this can be customized). The reference can be either read from a FASTA file (-rr PATH) or randomly generated (-gr GC LEN) with given GC content and length and stored. Many parameters controlling the properties of the generated reads exist (see the Supplement for details). For choosing the read length distribution, there are four possibilities: (i) providing parameters for a log-normal distribution (-ln SIGMA LOC SCALE); (ii) setting a fixed read length (-fl LEN); (iii) sampling the read length from an existing FASTQ file (-sf PATH); (iv) sampling the read length from a file containing one integer per line (-st PATH). The baseline error probabilities for subreads can be specified individually for substitutions (-ps), insertions (-pi) and deletions (pd). Consider the following example, where 10 000 reads are simulated, sampled from random positions of the reference ref.fa and written to reads.fastq. Error probabilities for subreads are 1, 12 and 2% for substitutions, insertions and deletions, respectively, on average (15% total error probability). Alignments are written to reads.sam. With the Neurospora crassa reference, this example takes 2:10 min.(Fungus)-Genome,-Epigenome,-and-Transcriptome simlord-n 10000-rr ref.fa-pi .12-pd .02-ps</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>.01 reads</head><p>To conclude, we have presented a Python-based read simulator (SimLoRD) whose error model corresponds to third-generation SMRT error characteristics, with default parameters based on public datasets. Relevant parameters are easily adjustable via command line arguments, so the simulator can be quickly adapted to new chemistries as they are developed. SimLoRD is convenient to install with standard Python tools and runs on all standard platforms. We hope that many researchers will benefit from the ability to generate simulated SMRT data when developing novel analysis applications. Conflict of Interest: none declared.</p></div><figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_0"><head>Fig.1.</head><figDesc>Fig. 1. Joint distribution of read length and average base quality per read on a real dataset (D1 in Table 1), in a SimLoRD simulation, in a PBSIM simulation (-length-mean ¼ 7000 and-length-sd ¼ 3000) and in a FASTQSim simulation (parameters estimated from D1)</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_0" validated="true"><figDesc>Table 1. Datasets; see References for URLs</figDesc><table>ID type 
organism 
CCSs 
subreads URL 

D1 DNA Neurospora crassa 
103 Mbp 982 Mbp a 
D2 RNA Homo sapiens 
481 Mbp 6 Gbp 

b 

D3 RNA Homo sapiens, MCF-7 line 1.9 Gbp 
15 Gbp 

c 

D4 DNA Caenorhabditis elegans 
350 Mbp 5 Gbp 

d 

a 

https://github.com/PacificBiosciences/DevNet/wiki/Neurospora-Crassa-
</table></figure>

			<note place="foot">b http://blog.pacificbiosciences.com/2014/10/data-release-whole-humantranscriptome.html c http://blog.pacificbiosciences.com/2013/12/data-release-human-mcf-7transcriptome.html d https://github.com/PacificBiosciences/DevNet/wiki/C.-elegans-data-set</note>

			<note place="foot">at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>
		</body>
		<back>
			<div type="references">

				<listBibl>

<biblStruct   xml:id="b0">
	<analytic>
		<title level="a" type="main">Mapping single molecule sequencing reads using basic local alignment with successive refinement (BLASR): application and theory</title>
		<author>
			<persName>
				<forename type="first">M</forename>
				<forename type="middle">J</forename>
				<surname>Chaisson</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">G</forename>
				<surname>Tesler</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">BMC Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">13</biblScope>
			<biblScope unit="page">238</biblScope>
			<date type="published" when="2012" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b1">
	<analytic>
		<title level="a" type="main">Real-time DNA sequencing from single polymerase molecules</title>
		<author>
			<persName>
				<forename type="first">J</forename>
				<surname>Eid</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Science</title>
		<imprint>
			<biblScope unit="volume">323</biblScope>
			<biblScope unit="page" from="133" to="138" />
			<date type="published" when="2009" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b2">
	<analytic>
		<title level="a" type="main">ART: a next-generation sequencing read simulator</title>
		<author>
			<persName>
				<forename type="first">W</forename>
				<surname>Huang</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">28</biblScope>
			<biblScope unit="page" from="593" to="594" />
			<date type="published" when="2012" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b3">
	<analytic>
		<title level="a" type="main">PBSIM: PacBio reads simulator – toward accurate genome assembly</title>
		<author>
			<persName>
				<forename type="first">Y</forename>
				<surname>Ono</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">29</biblScope>
			<biblScope unit="page" from="119" to="121" />
			<date type="published" when="2013" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b4">
	<analytic>
		<title level="a" type="main">FASTQSim: platform-independent data characterization and in silico read generation for NGS datasets</title>
		<author>
			<persName>
				<forename type="first">A</forename>
				<surname>Shcherbina</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">BMC Res Notes</title>
		<imprint>
			<biblScope unit="volume">7</biblScope>
			<biblScope unit="page">533</biblScope>
			<date type="published" when="2014" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b5">
	<monogr>
		<title level="m" type="main">SimLoRD: Simulation of Long Read Data</title>
		<imprint/>
	</monogr>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>