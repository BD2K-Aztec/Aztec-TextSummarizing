
<?xml version="1.0" encoding="UTF-8"?>
<TEI xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 /home/joey/Project/grobid/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<encodingDesc>
			<appInfo>
				<application version="0.4.2-SNAPSHOT" ident="GROBID" when="2017-08-10T23:28+0000">
					<ref target="https://github.com/kermitt2/grobid">GROBID - A machine learning software for extracting information from scholarly documents</ref>
				</application>
			</appInfo>
		</encodingDesc>
		<fileDesc>
			<titleStmt>
				<title level="a" type="main">Systems biology HAMMER: automated operation of mass frontier to construct in silico mass spectral fragmentation libraries</title>
			</titleStmt>
			<publicationStmt>
				<publisher/>
				<availability status="unknown"><licence/></availability>
				<date type="published" when="2014">2014</date>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author>
							<persName>
								<forename type="first">Jiarui</forename>
								<surname>Zhou</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department">College of Biomedical Engineering and Instrument Science</orgName>
								<orgName type="institution">Zhejiang University</orgName>
								<address>
									<postCode>310027</postCode>
									<settlement>Hangzhou</settlement>
									<country key="CN">China</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Ralf</forename>
								<forename type="middle">J M</forename>
								<surname>Weber</surname>
							</persName>
							<affiliation key="aff1">
								<orgName type="department">School of Biosciences</orgName>
								<orgName type="institution">University of Birmingham</orgName>
								<address>
									<postCode>B15 2TT</postCode>
									<settlement>Birmingham</settlement>
									<country key="GB">UK</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">J</forename>
								<forename type="middle">William</forename>
								<surname>Allwood</surname>
							</persName>
							<affiliation key="aff1">
								<orgName type="department">School of Biosciences</orgName>
								<orgName type="institution">University of Birmingham</orgName>
								<address>
									<postCode>B15 2TT</postCode>
									<settlement>Birmingham</settlement>
									<country key="GB">UK</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Robert</forename>
								<surname>Mistrik</surname>
							</persName>
							<affiliation key="aff2">
								<orgName type="institution">HighChem, Ltd</orgName>
								<address>
									<addrLine>Leskova 11</addrLine>
									<postCode>81104</postCode>
									<settlement>Bratislava</settlement>
									<country key="SK">Slovakia</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Zexuan</forename>
								<surname>Zhu</surname>
							</persName>
							<affiliation key="aff3">
								<orgName type="department">College of Computer Science and Software Engineering</orgName>
								<orgName type="laboratory">Shenzhen City Key Laboratory of Embedded System Design</orgName>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Zhen</forename>
								<surname>Ji</surname>
							</persName>
							<affiliation key="aff3">
								<orgName type="department">College of Computer Science and Software Engineering</orgName>
								<orgName type="laboratory">Shenzhen City Key Laboratory of Embedded System Design</orgName>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Siping</forename>
								<surname>Chen</surname>
							</persName>
							<affiliation key="aff4">
								<orgName type="department">School of Medicine</orgName>
								<orgName type="institution">Shenzhen University</orgName>
								<address>
									<postCode>518060</postCode>
									<settlement>Shenzhen</settlement>
									<country key="CN">China</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Warwick</forename>
								<forename type="middle">B</forename>
								<surname>Dunn</surname>
							</persName>
							<affiliation key="aff1">
								<orgName type="department">School of Biosciences</orgName>
								<orgName type="institution">University of Birmingham</orgName>
								<address>
									<postCode>B15 2TT</postCode>
									<settlement>Birmingham</settlement>
									<country key="GB">UK</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Shan</forename>
								<surname>He</surname>
							</persName>
							<affiliation key="aff5">
								<orgName type="department">School of Computer Science</orgName>
								<orgName type="institution">University of Birmingham</orgName>
								<address>
									<postCode>B15 2TT</postCode>
									<settlement>Birmingham</settlement>
									<country key="GB">UK</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Mark</forename>
								<forename type="middle">R</forename>
								<surname>Viant</surname>
							</persName>
							<affiliation key="aff1">
								<orgName type="department">School of Biosciences</orgName>
								<orgName type="institution">University of Birmingham</orgName>
								<address>
									<postCode>B15 2TT</postCode>
									<settlement>Birmingham</settlement>
									<country key="GB">UK</country>
								</address>
							</affiliation>
						</author>
						<title level="a" type="main">Systems biology HAMMER: automated operation of mass frontier to construct in silico mass spectral fragmentation libraries</title>
					</analytic>
					<monogr>
						<imprint>
							<biblScope unit="volume">30</biblScope>
							<biblScope unit="issue">4</biblScope>
							<biblScope unit="page" from="581" to="583"/>
							<date type="published" when="2014">2014</date>
						</imprint>
					</monogr>
					<idno type="DOI">10.1093/bioinformatics/btt711</idno>
					<note type="submission">Received on June 30, 2013; revised on December 2, 2013; accepted on December 3, 2013</note>
					<note>Associate Editor: Martin Bishop Supplementary information: Supplementary data are available at Bioinformatics online.</note>
				</biblStruct>
			</sourceDesc>
		</fileDesc>
		<profileDesc>
			<abstract>
				<p>Experimental MS n mass spectral libraries currently do not adequately cover chemical space. This limits the robust annotation of metabolites in metabolomics studies of complex biological samples. In silico fragmentation libraries would improve the identification of compounds from experimental multistage fragmentation data when experimental reference data are unavailable. Here, we present a freely available software package to automatically control Mass Frontier software to construct in silico mass spectral libraries and to perform spectral matching. Based on two case studies, we have demonstrated that high-throughput automation of Mass Frontier allows researchers to generate in silico mass spectral libraries in an automated and high-throughput fashion with little or no human intervention required. Availability and implementation: Documentation, examples, results and source code are available at</p>
			</abstract>
		</profileDesc>
	</teiHeader>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1">INTRODUCTION</head><p>Mass spectrometry (MS)-based metabolomics is a rapidly developing field that aims to detect and measure a variety of small biological molecules (metabolites) over a wide dynamic range (<ref type="bibr" target="#b0">Dettmer et al., 2007</ref>). Although thousands of metabolites are typically detected in an untargeted metabolomics study of a biological sample, their subsequent identification represents the most significant bottleneck in the discovery of new biochemical knowledge (<ref type="bibr" target="#b1">Dunn et al., 2013;</ref><ref type="bibr" target="#b3">Kind and Fiehn, 2010;</ref><ref type="bibr" target="#b8">Wishart, 2011</ref>). In many cases, multiple empirical formulae and/or putative chemical structures are reported for each observed mass feature (or more strictly mass-to-charge ratio, m/z). Multistage (MS n ) mass spectrometry, which is an experimental technique to collect in-depth fragmentation data related to the chemical structure of metabolites, is often applied to increase accuracy and specificity in metabolite annotation and identification. However, experimental MS n mass spectral libraries currently do not adequately cover the search space for all metabolites present in complex biological samples, as authentic chemical standards are not available for all metabolites. The generation of in silico MS n libraries is anticipated to greatly improve the success rate of annotation of metabolites detected in metabolomics studies, when experimentally acquired MS n data of authentic chemical standards are unavailable. Commercial software packages such as Mass Frontier and ACD/MS Fragmenter predict in silico fragmentation patterns to assist the interpretation of experimental MS n data (<ref type="bibr" target="#b4">Krauss et al., 2010;</ref><ref type="bibr" target="#b6">Oppermann et al., 2012</ref>). Additionally, a freely available tool named MetFrag has been developed previously (<ref type="bibr" target="#b9">Wolf et al., 2010</ref>). This tool selects candidate structures from a compound library based on the molecular ion m/z and generates in silico substructures to subsequently annotate fragment peaks. MetFrag does not provide the ability to create in silico patterns or libraries independent of the use of experimental data; however, it has been proven to be an efficient approach to annotate fragmentation mass spectra derived from MS experiments. Mass Frontier is a well-known software package that has been used by more than a thousand academic institutions and companies throughout the world for the management, evaluation and interpretation of mass spectra. It includes three resources that assist the user to robustly predict in silico fragmentation patterns: a set of general fragmentation rules, a fragmentation library comprising 150 000 fragmentation mechanisms collected from the scientific literature and user-specified mechanisms. However, Mass Frontier cannot readily perform batch processing on the scale required to generate comprehensive in silico libraries for thousands of metabolites. Here, we present a freely available software package, named HAMMER (High-throughput AutoMation of Mass frontiER), to automatically control Mass Frontier software to perform in silico fragmentation in an automated and high-throughput matter. This package allows the user to readily generate *To whom correspondence should be addressed.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>y</head><p>The authors wish it to be known that, in their opinion, the first two authors should be regarded as joint First Authors. large-scale in silico fragmentation libraries and perform mass spectral matching to mass spectrometry-derived data.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2">METHODS AND IMPLEMENTATION</head><p>HAMMER is developed under the Python language and supports Windows 7 and XP (both 32 bit and 64 bit). Its software requirements include Java 6/7, Open Babel (O'<ref type="bibr">Boyle et al., 2011</ref>), Sikuli (<ref type="bibr" target="#b11">Yeh et al., 2009</ref>) and Mass Frontier 7. A desktop PC with 2.66 GHz CPU and 4 GB memory was used as the operating platform. As shown in<ref type="figure" target="#fig_0">Figure 1</ref>, HAMMER consists of four modules:</p><p>(1) RetrieveStructures retrieves chemical structures from a compound database of interest such as ChemSpider, Kyoto Encyclopedia of Genes and Genomes (KEGG) and PubChem. The retrieval is based on a submitted plain text file that includes a list of compounds or chemicals (with specific names, database identifier or chemical formula). Additionally, metabolites within specific KEGG pathways can be downloaded based on a KEGG pathway identifier. Candidate entries found in the databases of interest are automatically downloaded, verified and converted into .mol format (required by Mass Frontier) or other formats such as SMILES, InChI or empirical formula. Open Babel is used to perform structure verification and conversion. A report is generated to summarize the information retrieved for each compound (e.g. number of candidates, database IDs and URL to the specific database entry).</p><p>(2) InSilicoFragmentation automatically controls the operation of Mass Frontier by using the open-source visual scripting software Sikuli. Sikuli allows control of software when no application programming interface is available, which is the case for many commercial software packages. It readily uses image recognition of graphical user interface (GUI) elements to operate software. HAMMER contains a Sikuli standalone runtime. As a result, the InSilicoFragmentation module works without any setup, otherwise simple configuration is required. Two versions of InSilicoFragmentation are provided: Windows 7 and Windows XP. We have separated the GUI images (or patterns) and search regions from the source code itself. This allows the user to modify the script more easily if required (e.g. applying a different version of Mass Frontier, see online manual for details). The structure file (.mol) of each compound is separately imported into Mass Frontier, and in silico fragmentation is performed applying user-defined fragmentation settings (see online manual for details). Structural and m/z information for each fragment is collected for each in silico reaction and if required (i.e. for MS n ) is used for the next fragmentation step. This use allows closed-loop operation of Mass Frontier to perform 'multistage' in silico fragmentation. In silico fragments, their corresponding unique m/z values, chemical structures (in each stage) and fragmentation mechanisms are exported for further analysis and visualization.</p><p>(4) SpectralMatching computes a score, using the pMatch algorithm, to evaluate the probability of a match between anexperimental fragmentation spectrum and an in silico fragmentation pattern in a library (<ref type="bibr" target="#b10">Ye et al., 2010</ref>). The pMatch algorithm is a spectral matching algorithm originally developed for mass spectrometry-based protein identification (see Supplementary Information for details of the algorithm). The SpectralMatching module uses MSP files (see previous module), experimental and in silico, as its input. For each experimental fragmentation spectrum, a report is generated, which includes detailed information on the matching and annotation.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3">CASE STUDIES</head><p>HAMMER was used to generate in silico fragmentation data for two distinct groups of compounds:</p><p>(i) all 72 metabolites within the 'phenylalanine metabolism' KEGG pathway (i.e. map00360) and (ii) the top 200 most prescribed drugs in the USA in 2011 (<ref type="bibr">RxList, 2011</ref>). These were selected to demonstrate the applicability and capability of HAMMER across diverse compound sets. Some drugs are composed of multiple compounds, and each compound was separately parsed and imported into Mass Frontier. Additionally, lower mass neutral and charged molecules/atoms (e.g. water and sodium) within these separated drug compounds were excluded from this demonstration dataset (see Supplementary Information for details). This resulted in 151 unique structures for the drugs dataset. See Supplementary<ref type="figure">Table  S1</ref>for specific settings used for both case studies. The run times for the phenylalanine and drug datasets were 8.5 and 14.5 h, respectively. On average, 3200 fragments were predicted for each compound (see Supplementary Tables S2–S4). Applying the defined Mass Frontier parameter settings, it is expected that MS n data are reported, where n42. This relatively high number of fragments illustrates the complexity and diversity of the fragmentation mechanisms. Although, these in silico fragments are predicted based on a set of general fragmentation rules and a fragmentation library comprising 150 000 fragmentation mechanisms collected from the scientific literature, the numbers of fragments produced are highly dependent on the complexity of the chemical structures and the parameter settings defined by the user (see Supplementary Information and online manual for details). In silico fragments may be reported, which are false positives; these fragments are not actually created in the MS fragmentation process, or are created but their low stabilities ensure that further and complete fragmentation or decomposition is observed before the ions are detected. To assess the applicability of each in silico fragmentation library, five experimental fragmentation mass spectra were retrieved from MassBank to perform spectral matching [Supplementary<ref type="figure">Table S5</ref>, Case Study I: acetyl-CoA (KNA00207), capsaicin (WA001605), isobutyryl-CoA (PR100154), N-acetyl-Lphenylalanine (KO002200) and succinic acid (KZ000074). Case study II: amoxicillin (WA001751), digoxin (WA000563), meloxicam (WA002576), naproxen (WA000359) and prednisone (CO000368)] (<ref type="bibr" target="#b2">Horai et al., 2010</ref>). All of the 10 real fragmentation spectra were correctly identified based on the data present in these small in silico mass spectral libraries (Supplementary<ref type="figure">Table S6</ref>). It is important to highlight that the parameter settings used in Mass Frontier to perform in silico fragmentation play an important role in the correct prediction of in silico fragments and mechanisms. Additionally, understanding the experimental parameters used to collect experimental data (e.g. difference in collision energy or type of fragmentation) is also important to maximize metabolite annotation. However, these two challenges are outside the scope of the work presented here. Both case studies show that HAMMER allows researchers to readily generate in silico MS n libraries and perform batch spectral matching of in silico mass spectral data to MS-derived data in an automated high-throughput fashion with minimal or no human intervention. In addition, we have shown with both case studies the value and applicability of visual scripting in the field of computational biology. We anticipate this software package will be used across a wide range of disciplines including metabolomics, organic synthetic chemistry and pharmaceutical research.</p></div><figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_0"><head>Fig.1.</head><figDesc>Fig. 1. Workflow for HAMMER</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_1"><head></head><figDesc>Funding: Royal Society International Exchanges 2011 NSFC funding (61211130120), National Natural Science Foundation of China (NSFC) Joint Fund with Guangdong (U1201256), NSFC funding (61171125 and 61001185), the UK Natural Environment Research Council (NE/I008314/1) and the Systems Science for Health initiative at The University of Birmingham. Conflict of Interest: R.M. derives income from Mass Frontier sales.</figDesc></figure>

			<note place="foot">ß The Author 2013. Published by Oxford University Press. This is an Open Access article distributed under the terms of the Creative Commons Attribution License (http://creativecommons.org/licenses/by/3.0/), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>

			<note place="foot">J.Zhou et al. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>

			<note place="foot" n="583"> HAMMER at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>
		</body>
		<back>
			<div type="references">

				<listBibl>

<biblStruct   xml:id="b0">
	<analytic>
		<title level="a" type="main">Mass spectrometry-based metabolomics</title>
		<author>
			<persName>
				<forename type="first">K</forename>
				<surname>Dettmer</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Mass Spectrom. Rev</title>
		<imprint>
			<biblScope unit="volume">26</biblScope>
			<biblScope unit="page" from="51" to="78" />
			<date type="published" when="2007" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b1">
	<analytic>
		<title level="a" type="main">Mass appeal: metabolite identification in mass spectrometryfocused untargeted metabolomics</title>
		<author>
			<persName>
				<forename type="first">W</forename>
				<surname>Dunn</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Metabolomics</title>
		<imprint>
			<biblScope unit="volume">9</biblScope>
			<biblScope unit="page" from="44" to="66" />
			<date type="published" when="2013" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b2">
	<analytic>
		<title level="a" type="main">MassBank: a public repository for sharing mass spectral data for life sciences</title>
		<author>
			<persName>
				<forename type="first">H</forename>
				<surname>Horai</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Mass Spectrom</title>
		<imprint>
			<biblScope unit="volume">45</biblScope>
			<biblScope unit="page" from="703" to="714" />
			<date type="published" when="2010" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b3">
	<analytic>
		<title level="a" type="main">Advances in structure elucidation of small molecules using mass spectrometry</title>
		<author>
			<persName>
				<forename type="first">T</forename>
				<surname>Kind</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">O</forename>
				<surname>Fiehn</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioanal. Rev</title>
		<imprint>
			<biblScope unit="volume">2</biblScope>
			<biblScope unit="page" from="23" to="60" />
			<date type="published" when="2010" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b4">
	<analytic>
		<title level="a" type="main">LC–high resolution MS in environmental analysis: from target screening to the identification of unknowns</title>
		<author>
			<persName>
				<forename type="first">M</forename>
				<surname>Krauss</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Anal. Bioanal. Chem</title>
		<imprint>
			<biblScope unit="volume">397</biblScope>
			<biblScope unit="page" from="943" to="951" />
			<date type="published" when="2010" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b5">
	<analytic>
		<title level="a" type="main">Open babel: an open chemical toolbox</title>
		<author>
			<persName>
				<forename type="first">O &apos;</forename>
				<surname>Boyle</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">N</forename>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Cheminform</title>
		<imprint>
			<biblScope unit="volume">3</biblScope>
			<biblScope unit="page">33</biblScope>
			<date type="published" when="2011" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b6">
	<analytic>
		<title level="a" type="main">High precision measurement and fragmentation analysis for metabolite identification</title>
		<author>
			<persName>
				<forename type="first">M</forename>
				<surname>Oppermann</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Methods Mol. Biol</title>
		<imprint>
			<biblScope unit="volume">860</biblScope>
			<biblScope unit="page" from="145" to="156" />
			<date type="published" when="2012" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b7">
	<analytic>
		<title level="a" type="main">The Internet Drug Index Top 200 Drugs U.S. Only</title>
	</analytic>
	<monogr>
		<title level="j">RxList</title>
		<imprint>
			<date type="published" when="2011-12-23" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b8">
	<analytic>
		<title level="a" type="main">Advances in metabolite identification</title>
		<author>
			<persName>
				<forename type="first">D</forename>
				<forename type="middle">S</forename>
				<surname>Wishart</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioanalysis</title>
		<imprint>
			<biblScope unit="volume">3</biblScope>
			<biblScope unit="page" from="1769" to="1782" />
			<date type="published" when="2011" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b9">
	<analytic>
		<title level="a" type="main">In silico fragmentation for computer assisted identification of metabolite mass spectra</title>
		<author>
			<persName>
				<forename type="first">S</forename>
				<surname>Wolf</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">BMC Bioinformatics</title>
		<imprint>
			<biblScope unit="issue">11</biblScope>
			<biblScope unit="page">148</biblScope>
			<date type="published" when="2010" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b10">
	<analytic>
		<title level="a" type="main">Open MS/MS spectral library search to identify unanticipated post-translational modifications and increase spectral identification rate</title>
		<author>
			<persName>
				<forename type="first">D</forename>
				<surname>Ye</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">26</biblScope>
			<biblScope unit="page" from="399" to="406" />
			<date type="published" when="2010" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b11">
	<analytic>
		<title level="a" type="main">Sikuli: using GUI screenshots for search and automation</title>
		<author>
			<persName>
				<forename type="first">T</forename>
				<surname>Yeh</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proceedings of the 22nd annual ACM symposium on User interface software and technology</title>
		<meeting>the 22nd annual ACM symposium on User interface software and technology<address><addrLine>Victoria, BC, Canada</addrLine></address></meeting>
		<imprint>
			<publisher>ACM</publisher>
			<date type="published" when="2009" />
			<biblScope unit="page" from="183" to="192" />
		</imprint>
	</monogr>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>