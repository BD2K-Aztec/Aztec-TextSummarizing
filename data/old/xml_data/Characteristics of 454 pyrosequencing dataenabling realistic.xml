
<?xml version="1.0" encoding="UTF-8"?>
<TEI xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 /home/joey/Project/grobid/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<encodingDesc>
			<appInfo>
				<application version="0.4.2-SNAPSHOT" ident="GROBID" when="2017-08-10T23:38+0000">
					<ref target="https://github.com/kermitt2/grobid">GROBID - A machine learning software for extracting information from scholarly documents</ref>
				</application>
			</appInfo>
		</encodingDesc>
		<fileDesc>
			<titleStmt>
				<title level="a" type="main">Characteristics of 454 pyrosequencing data—enabling realistic simulation with flowsim</title>
			</titleStmt>
			<publicationStmt>
				<publisher/>
				<availability status="unknown"><licence/></availability>
				<date type="published" when="2010">2010</date>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author>
							<persName>
								<forename type="first">Susanne</forename>
								<surname>Balzer</surname>
							</persName>
							<email>Contact: susanne.balzer@imr.no</email>
							<affiliation key="aff0">
								<orgName type="department">Institute of Marine Research</orgName>
								<address>
									<postBox>PO Box 1870</postBox>
									<postCode>N-5817</postCode>
								</address>
							</affiliation>
							<affiliation key="aff1">
								<orgName type="department">Department of Informatics</orgName>
								<orgName type="institution">University of Bergen</orgName>
								<address>
									<postBox>PO Box 7803</postBox>
									<postCode>N-5020</postCode>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Ketil</forename>
								<surname>Malde</surname>
							</persName>
							<email>ketil.malde@imr.no</email>
							<affiliation key="aff0">
								<orgName type="department">Institute of Marine Research</orgName>
								<address>
									<postBox>PO Box 1870</postBox>
									<postCode>N-5817</postCode>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Anders</forename>
								<surname>Lanzén</surname>
							</persName>
							<affiliation key="aff2">
								<orgName type="department">Computational Biology Unit</orgName>
								<orgName type="institution">Bergen Center for Computational Science</orgName>
								<address>
									<addrLine>Thormøhlensgate 55</addrLine>
									<postCode>N-5008</postCode>
								</address>
							</affiliation>
							<affiliation key="aff3">
								<orgName type="department">Department of Biology</orgName>
								<orgName type="institution">University of Bergen</orgName>
								<address>
									<postBox>PO Box 7803</postBox>
									<postCode>N-5020</postCode>
									<settlement>Bergen</settlement>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Animesh</forename>
								<surname>Sharma</surname>
							</persName>
							<affiliation key="aff1">
								<orgName type="department">Department of Informatics</orgName>
								<orgName type="institution">University of Bergen</orgName>
								<address>
									<postBox>PO Box 7803</postBox>
									<postCode>N-5020</postCode>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Inge</forename>
								<surname>Jonassen</surname>
							</persName>
							<affiliation key="aff1">
								<orgName type="department">Department of Informatics</orgName>
								<orgName type="institution">University of Bergen</orgName>
								<address>
									<postBox>PO Box 7803</postBox>
									<postCode>N-5020</postCode>
								</address>
							</affiliation>
							<affiliation key="aff2">
								<orgName type="department">Computational Biology Unit</orgName>
								<orgName type="institution">Bergen Center for Computational Science</orgName>
								<address>
									<addrLine>Thormøhlensgate 55</addrLine>
									<postCode>N-5008</postCode>
								</address>
							</affiliation>
						</author>
						<title level="a" type="main">Characteristics of 454 pyrosequencing data—enabling realistic simulation with flowsim</title>
					</analytic>
					<monogr>
						<imprint>
							<biblScope unit="volume">26</biblScope>
							<biblScope unit="page" from="420" to="425"/>
							<date type="published" when="2010">2010</date>
						</imprint>
					</monogr>
					<idno type="DOI">10.1093/bioinformatics/btq365</idno>
					<note>[10:32 28/8/2010 Bioinformatics-btq365.tex] Page: i420 i420–i425 BIOINFORMATICS Availability: Flowsim is freely available under the General Public License from</note>
				</biblStruct>
			</sourceDesc>
		</fileDesc>
		<profileDesc>
			<abstract>
				<p>Motivation: The commercial launch of 454 pyrosequencing in 2005 was a milestone in genome sequencing in terms of performance and cost. Throughout the three available releases, average read lengths have increased to ∼500 base pairs and are thus approaching read lengths obtained from traditional Sanger sequencing. Study design of sequencing projects would benefit from being able to simulate experiments. Results: We explore 454 raw data to investigate its characteristics and derive empirical distributions for the flow values generated by pyrosequencing. Based on our findings, we implement Flowsim, a simulator that generates realistic pyrosequencing data files of arbitrary size from a given set of input DNA sequences. We finally use our simulator to examine the impact of sequence lengths on the results of concrete whole-genome assemblies, and we suggest its use in planning of sequencing projects, benchmarking of assembly methods and other fields.</p>
			</abstract>
		</profileDesc>
	</teiHeader>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1">INTRODUCTION</head><p>During the last few years novel sequencing technologies have been introduced. The platforms that are currently commercially available are marketed by Roche (454), Illumina (Solexa/Genome Analyzer), and Applied Biosystems (SOLiD), and they give new challenges for bioinformatics due to data volumes, short read lengths, and difference in errors and quality compared to traditional Sanger sequencing. So far, most bioinformatics methods available have been developed for Sanger sequencing data. In this article, we characterize the data produced by the 454 system and in particular by its latest version named GS FLX Titanium (referred to as Titanium in the rest of the article). We analyze Titanium data sets from genomes for which the sequence has been determined. Specifically, we map each Titanium read to the reference and derive empirical distributions for the flowgram data obtained (see below;<ref type="figure" target="#tab_1">Table 1</ref>). This provides an improved basis for analysis and algorithm design, e.g. for base calling and alignment. In this article, we present a simulator that generates realistic flowgram data for any chosen DNA sequence. The article is structured as follows: in the rest of Section 1, we briefly summarize pyrosequencing, specialized methods for analyzing pyrosequencing data (operating in 'flowspace', see * To whom correspondence should be addressed. Section 1.2), and simulations. Section 2 follows the results obtained from characterizing pyrosequencing data at the flow level, and in Section 3, we present the Flowsim simulator and some results obtained from comparing simulated and real data sets. Finally, in Section 4 a discussion is given.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1.1">Pyrosequencing</head><p>The 454 pyrosequencing technology is based on sequencing-bysynthesis and consists in the cyclic flowing of nucleotide reagents (repeatedly flowing T, A, C, G) over a PicoTiterPlate™. The plate consists of approximately one million wells, and each well contains at most one bead carrying a copy of a unique single-stranded DNA fragment to be sequenced. When the flowed nucleotide is complementary to the template strand in a well, the existing DNA strand in this well is extended with additional nucleotide(s) by a polymerase. This hybridization results in a reaction that generates an observable light signal which is recorded by a camera. The light intensity is converted into a 'flow value', a two-decimal nonnegative number that is proportional to the length of a homopolymer run, i.e. it designates the number of nucleotides included in the flow, estimated by simply rounding the number to the closest integer (<ref type="bibr" target="#b8">Margulies et al., 2005</ref>). The term 'noise flow values' (in literature sometimes referred to as 'negative flow values', in practical terms being between 0 and 0.49) means that the light signal—although existing—is weak and judged not to result from a chemical reaction. A 'positive flow value' thus indicates incorporation of at least one base, and the number of bases (the homopolymer length) is determined from the flow value. Flow values for one bead (one read) can be used to plot a flowgram (<ref type="figure" target="#fig_1">Fig. 1a</ref>) from which the associated sequence can be determined. The cyclically flowed nucleotides and the corresponding flow values build the basis for not only base calling, but also per-base quality score calculation (integrated in Titanium output). Obviously, the key to a correct base calling lies in the accuracy of the light signals. The 454 methodology differs from traditional Sanger sequencing in that substitution errors are a lot less frequent than insertions or deletions. Data properties have slightly changed over the three 454 generations (Roche Applied Science, 2008). We focus on the Titanium technology for all further calculations.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1.2">Use of flow values in data analysis</head><p>Although 454 sequences can be analyzed as Fasta files with standard bioinformatics tools, the flow values contain information that is not available in the pure nucleotide sequence. Consequently, severalPage: i421 i420–i425</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Characteristics of 454 pyrosequencing data</head><p>(a) (b)groups have proposed algorithms to utilize flow values directly. This approach is referred to as operating in 'flowspace' as opposed to 'nucleotide space' and inhibits information loss. For example, the PyroNoise method (<ref type="bibr" target="#b11">Quince et al., 2009</ref>) uses a maximum likelihood approach to decide whether a set of flowgrams is likely to result from one or several distinct underlying biological sequences. In an analogous manner, using Bayesian statistics, the PyroBayes method (<ref type="bibr" target="#b12">Quinlan et al., 2008</ref>) determines the length of each homopolymer run as the most likely number of bases given the observed flow value. If the probability for an extra base exceeds a certain threshold, the extra base is added to the homopolymer run. This increases the number of insertion errors, but decreases the number of deletions and substitutions since it is intrinsic to 454 pyrosequencing that substitution errors can only arise from coherent over-and undercalls. This tendency to call more bases in homopolymer runs thus enables a higher SNP identification rate. For small RNA discovery, direct mapping of flowgrams against a target genome ('FLAT', flowgram alignment tool) has been proved to be an efficient method (<ref type="bibr" target="#b15">Vacic et al., 2008</ref>). It is also possible to achieve higher per-base accuracy rates in sequence assembly by building consensus sequences in flowspace from highly oversampled data (<ref type="bibr" target="#b5">Huse et al., 2007;</ref><ref type="bibr" target="#b8">Margulies et al., 2005</ref>). Metagenomics is another field where the quality of 454-pyrosequenced data has received much attention (<ref type="bibr" target="#b4">Gomez-Alvarez et al., 2009;</ref><ref type="bibr" target="#b6">Huson et al., 2007;</ref><ref type="bibr" target="#b11">Quince et al., 2009</ref>). Studies have shown that there are several artifacts that heavily influence the processing of data for different purposes (<ref type="bibr">GomezAlvarez et al., 2009;</ref><ref type="bibr" target="#b5">Huse et al., 2007</ref>), and especially methods that do not directly use flow values are sensitive to the characteristics of pyrosequencing data. For example, when matching 454 sequences with an indexing approach one can collapse all homopolymer subsequences to length one since pyrosequencing is likely to introduce errors in homopolymer lengths (<ref type="bibr" target="#b9">Miller et al., 2008</ref>). Especially for long homopolymers, many errors are caused by broad and overlapping signal distributions leading to ambiguous base calls, although there has also been work on improving 454 sequencing from the chemical aspect (<ref type="bibr" target="#b8">Margulies et al., 2005</ref>). In addition to the correct determination of homopolymer lengths, the under-or over-calling of bases is especially critical for weak light signals (i.e. noise flow values). A flow value of 0.49 is treated as noise by the 454 base caller although it is almost as likely to originate from a single base call.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1.3">Simulating shotgun data</head><p>With Genfrag (<ref type="bibr" target="#b3">Engle and Burks, 1994</ref>) and celsim (<ref type="bibr" target="#b10">Myers, 1999</ref>), there have been earlier attempts to simulate shotgun read data, but, to the best of our knowledge, MetaSIM (<ref type="bibr" target="#b13">Richter et al., 2008</ref>) is the only simulator that allows for generating 454 pyrosequencing data. MetaSIM targets Metagenomics. Internally, it uses parametric models for simulating flow values, but its output is Fasta files, and thus it is of limited use for applications that operate in flowspace.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2">FLOW VALUE DISTRIBUTIONS</head><p>One of the main challenges in 454 pyrosequencing is the correct determination of homopolymer lengths from flow values. The latter originate from a mixture of overlapping distributions. This is illustrated in<ref type="figure" target="#fig_1">Figures 1b and 3</ref>, where each distribution is assigned to one homopolymer length and one distribution to noise values. Incorrect homopolymer lengths lead to insertions and deletions during base calling (relative to the underlying biological sequence), i421and, when an over-call follows an under-call or vice versa, to a perceived substitution error. Therefore, if the distributions did not overlap, this would mean an error-free sequencing. An improved understanding of these distributions also improves the basis for designing algorithms that target the analysis of 454 pyrosequencing data.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>S.Balzer et al.</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.1">Parametric versus empirical approaches</head><p>In earlier studies one has approximated flow values by normal, log-normal (<ref type="bibr" target="#b8">Margulies et al., 2005</ref>) or non-central student's t distributions (<ref type="bibr" target="#b12">Quinlan et al., 2008</ref>). However, for our data the fit of these distributions is not satisfying (<ref type="figure" target="#fig_4">Fig. 3</ref>). An alternative is to use non-parametric empirical distributions estimated from real Titanium data for which reference sequences are available. By mapping 454 data to the originating genome, we characterize the distributions of flow values coming from each homopolymer length.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.2">Sequence comparisons</head><p>After having compared Titanium raw data from two different species, Escherichia coli and seabass (Dicentrarchus labrax, referred to as E.coli and D.labrax, respectively in the rest of the article), we decided to combine them—equally weighted—into one empirical distribution per homopolymer length. However, we also decided to include the four different nucleotide types in the same distributions since they appear to give rise to very similar distributions. In order to find the distribution of flow values that arises from one particular homopolymer length, we mapped Titanium flowgrams to a reference genome for the same organism, based on one Titanium plate each for an E.coli K-12 strain (<ref type="bibr" target="#b1">Blattner et al., 1997</ref>) and D.labrax (<ref type="bibr" target="#b7">Kuhl et al., 2010</ref>). We used BLAST (<ref type="bibr" target="#b0">Altschul et al., 1990</ref>) to identify the location of reads that could be aligned unambiguously to one location on the genome, with default BLAST parameters, except for gap open and extend penalties, which were set to 1.To distinguish sequencing errors from true biological variation, we used a bit score threshold of 200 and only the best match for each sequence. Furthermore, we discarded all those matches that had a corresponding second best match with a bit score &lt;5% worse than the best match, i.e. two matches with bit scores that were approximately equally high. For E.coli, there were uncertainties in terms of which reference genome to choose, as none of the available reference genomes gave us &gt;97% identity with the pyrosequencing data, but the match filtering mentioned above should account for these problems.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.3">Calculation of empirical distributions</head><p>We aligned the flowgrams to the matching genomic region, assigning each flow value to the corresponding true homopolymer length as known from the reference genome. Thus, we collected the flow values assigned to each homopolymer length distribution from 0 to 5, as shown in<ref type="figure" target="#fig_4">Figure 3</ref>. For homopolymer lengths greater than 5, our data is sparse, and it is therefore better to approximate the real distributions by extrapolating parametric distributions from the shorter homopolymer lengths.<ref type="figure" target="#tab_2">Table 2</ref>shows the observed mean and standard deviation of the empirical distributions for homopolymer lengths 0 to 5, and the linear regression for these parameters based on normal distributions fitted to homopolymer lengths 1 to 5.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.4">Degradation and Noise</head><p>We find our resulting empirical distributions to be almost symmetrical around the corresponding integers, with relatively low standard deviation for short homopolymer runs. However, when analyzing data from the three 454 generations, we also found that the degree of symmetry varies between them.<ref type="bibr" target="#b12">Quinlan et al. (2008)</ref>report a significantly higher insertion than deletion rate, which is consistent with an asymmetry in the tails of the distributions, but we found the asymmetry to decrease towards newer generation data. Nevertheless, we can clearly observe two kinds of degradation: since standard deviation increases for increasing homopolymer lengths, these belong to broader distributions with overlapping tails, where the latter generally means a higher risk of over-and under-calls. Second, analysis of the flow values associated with sequence parts that have been trimmed off (during standard 454 qualitytrimming) indicates that 454 quality-filtering and-trimming calibrates discrepancies between the four nucleotides and increases the separations of the distributions, involving deeper valleys i422Page: i423 i420–i425</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Characteristics of 454 pyrosequencing data</head><p>(a) (b)between them (Figs 1b and 2a). We therefore use only the subsequences retained after quality-trimming to estimate the empirical distributions, thus being able to treat the nucleotides equally. Also for quality-trimmed raw data, we can see that both read and flow position of a base have a remarkable influence on the accuracy of flow values. We have observed a clear degradation in accuracy over the length of a run, i.e. when comparing earlier to later flow cycles, by measuring for each flow cycle how much the difference between a flow value and its ideal counterpart (i.e. the closest integer) varies (<ref type="figure" target="#fig_3">Fig. 2b</ref>).</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.5">Read lengths</head><p>The length of un-trimmed reads in 454 pyrosequencing is limited by either the number of flows (168 in GS20, 400 in GS FLX and 800 in GS FLX Titanium) or the length of the clones. The longest reads are thus obtained when the clone length exceeds the number of flows, such that the DNA strands in the well are extended until the very last flow cycle. As quality decreases towards the end of a read, several filters are applied on the reads, which again gives a different read length distribution. We can thus distinguish between the distribution of clone lengths, the distribution of read lengths before filtering and quality-trimming and that after application of those filters. A detailed description of the filtering algorithms is given in the 454 manual (<ref type="bibr">Roche Applied Science, 2008</ref>). As visible in<ref type="figure" target="#fig_1">Figure 1b</ref>, they eliminate (some of the) artifacts in the distributions by trimming low-quality flow values from the end of each read.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.2">Quality scores</head><p>It is crucial to assign a quality score to each called base, since sequenced bases are not filtered individually during quality-filtering and-trimming, but rather in the context of their reads. Quality scores are e.g. useful for assembly projects, although some assemblers do not use them. If they do, however, they might rely on them for incorporating Sanger reads since 454 quality scores are expressed as a phred equivalent (<ref type="bibr" target="#b8">Margulies et al., 2005;</ref><ref type="bibr">Roche Applied Science, 2008</ref>). On the other hand, scores can also be used by assemblers built for Sanger sequences when assembling 454 sequences. Although the method for determining quality has been described both for GS20 (<ref type="bibr" target="#b8">Margulies et al., 2005</ref>) and Titanium (<ref type="bibr" target="#b2">Brockman et al., 2008</ref>), the exact parameters are not known. Instead, Flowsimcalculates the error probability ('the base in question is an overcall'), using Bayes'Theorem, and transfers it into a phred equivalent. Thus, the quality score corresponds to the true quality of the simulated base call, rather than to the quality the 454 software would produce for the same flowgram. Flowsim currently supports two quality calling methods based on Bayesian statistics. One produces decreasing quality scores for the bases in a homopolymer, similar to GS20. The second produces a series of identical values for each base in a homopolymer, as in Titanium, but otherwise builds on the same Bayesian approach as the GS20 algorithm. Compared to the quality scores assigned to Titanium by the Roche analysis pipeline, our quality scores are lower. As GS20 appears to use a fixed table mapping each flow value to a set of qualities, there is also a third option of assigning qualities from a table derived from GS20 data. Bayes' theorem requires both the prior probability for each homopolymer length and the conditional probability for a flow value given a certain homopolymer length. In contrast to<ref type="bibr">Margulies et al.,</ref>we use both empirical priors (from the input Fasta file) and empirical conditional probabilities (from our empirical distributions). This allows us to assess the quality of our simulated data as accurately as possible. When position-specific empirical distributions are used in Flowsim, we also use these for quality score calculation.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>i423</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>S.Balzer et al.</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.3">Simulating data sets</head><p>We used Flowsim to generate synthetic data sets, using our empirical distributions as the flow model. Each of the 20 distributions was used for 10 flow cycles (40 flows), giving a realistic degradation of quality along the sequence. We also simulated data sets using 400 flow cycles, simulating a hypothetical 454 generation with twice the read length of the current Titanium generation. The E.coli genome (K-12 strain, GenBank ID: 49175990) was used as the input genome.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.4">Simulation results</head><p>We have performed both de-novo and reference-based assembly using Newbler assembler version 2.3 (Roche), approximating various coverage (1×, 5×, 10×, 15×, 20×, 25× and 30×). A simulation with 200 flow cycles shows ∼1% inferred error, while 400 flow cycles result in an error rate of ∼0.8%, which is the same as for the real data (Titanium, i.e. 200 flow cycles). Our results indicate that Flowsim can be useful to estimate the quality of an assembly that can be expected from using Titanium to shotgun sequence a genome. However, the assemblies resulting from our simulations were consistently better in terms of contig sizes (through the N50 summarizing statistic, see<ref type="figure">Table 3</ref>) for the simulated data sets than for the real ones. This may partly be due to all simulated reads coming from the reference genome and thus avoiding strain-specific discrepancies, which leads to the fact that 100% of the reads for 200 and 400 flow cycle simulations can be mapped back to genome, while real data reach only ∼98.7% for all studied coverage values. There may also be other factors such as possible biases in terms of genome coverage in the experimental protocols used to generate the shotgun libraries for Titanium sequencing. Further work will include exploring such biases and other sources of variability as well as characterizing their influence on the simulation accuracy of Flowsim. Also Flowsim will be extended to include simulation of paired-reads, which will be of high value for simulation and planning of projects for de-novo whole-genome sequencing.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4">DISCUSSION</head><p>This study aims to sketch the opportunities that arise from analyzing pyrosequencing raw data, culminating in the use of empirical distributions. The empirical distributions give us a very realistic picture of the underlying characteristics of the light signal values that are later translated into DNA sequences. In contrast, earlier approaches to modeling flow data have built on parametric i424Page: i425 i420–i425distributions, and the same distributions were used for whole reads, without respect to flow or read positions. Our findings and the empirical distributions are based on large amounts of data from three different species (E.coli, D.labrax, Gadus morhua), four sequencing labs, both shotgun and pairedend reads with different gap sizes. The empirical flow value distributions are very similar, and we have not observed any factors which influence the shape of the distributions apart from the 454 generation. Thus, we have a good reason to believe that the distributions used in Flowsim are representative. The flow values that result from 454 sequencing exhibit many interesting characteristics and artifacts, and we do not address them all here. Some of these are generation-specific, some of them have remained stable over the years, and some of them only appear on one certain plate, for one certain species or in one lab. One known artifact, exact or almost-exact duplicates, has been not only described for metagenomics in the literature (<ref type="bibr" target="#b4">Gomez-Alvarez et al., 2009</ref>), but we also observed them in shotgun sequences for E.coli and D.labrax. We do emulate the degradation in empirical flow distributions, and we also calculate the corresponding quality scores. In contrast, we neglect some of the artifacts that we have observed in the empirical distributions, but are not able to interpret properly yet, such as for example: shifts in peaks that lead to systematic over-or under-calls, jumps, neighboring peaks, i.e. subpeaks around the next or preceding integer. These are particularly strong for the noise distribution (with a neighboring peak around 1) and the 1-distribution (with neighboring peaks around 0.1 and 2), but the values causing these peaks are not many in number. Analyzing the corresponding data including the related alignments we found that the subpeaks are likely to be caused by real biological differences. This will be explored further in a separate study. In this context, we also performed a weak smoothing process that helped to reduce subpeaks and jumps. Furthermore, the 454 image analysis software implements a set of quality filters that sets trimming coordinates to identify the high-quality part of each read. In addition, some reads are eliminated entirely based on quality metrics. Although these filters are documented (Roche Applied Science, 2008), the documentation is not sufficient to re-implement them, and the current version of Flowsim does not attempt to simulate them. We hope to address this in a future release (<ref type="figure" target="#fig_6">Fig. 4</ref>). In conclusion, our simulator produces sufficiently realistic 454 files as we model all important phenomena that we have observed. Furthermore, Flowsim allows the user to specify many of its parameters, making it adaptable to new real or hypothetical 454 generations.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Characteristics of 454 pyrosequencing data</head></div><figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_0"><head></head><figDesc>[10:32 28/8/2010 Bioinformatics-btq365.tex]</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_1"><head>Fig.1.</head><figDesc>Fig. 1. (a) A 454 flowgram: cyclic flowing during one read. The light signal strengths (flow values) are directly translated into homopolymer runs. (b) Absolute frequencies of flow values (E.coli). Left: original data, no quality-trimming; right: quality-trimmed. The trimming algorithm enhances the separation of the homopolymer length distributions and levels out discrepancies between the nucleotides such that the curves for the four nucleotides are nearly identical.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_2"><head></head><figDesc>[10:32 28/8/2010 Bioinformatics-btq365.tex]</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_3"><head>Fig.2.</head><figDesc>Fig. 2. (a) Absolute frequencies of flow values by flow cycle. A total of 200 flow cycles of a Titanium run correspond to 200×4 = 800 flows. The first two flow cycles contain the TCAG tag and are omitted here. Towards the end of a run, flow values tend to lie further away from their ideal values (integers), but are obviously less in number because many values from later flow cycles have been trimmed away. (b) Standard deviation of flow values (difference in relation to their closest integer), by flow cycle. Standard deviation increases almost linearly. Only flow values &lt;5.5 were included.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_4"><head>Fig.3.</head><figDesc>Fig. 3. Empirical distributions (smoothed average of E.coli and D.labrax) on logarithmic scale. In gray: fitted (log-) normal distributions.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_5"><head></head><figDesc>[10:32 28/8/2010 Bioinformatics-btq365.tex]</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_6"><head>Fig.4.</head><figDesc>Fig. 4. De novo and reference-based N50 for E.coli. Both real and simulated 454 data were assembled using Newbler v2.3.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_0" validated="true"><figDesc>Table 1. Data basis for building the empirical distributions SFF files Escherichia coli Dicentrarchus labrax Total</figDesc><table>Number of reads a 
1 176 344 
1 270 325 
2 446 669 
Average read length a 
534.1 
532.8 
533.4 
Number of bases a 
92 924 311 
85 822 587 
178 746 898 
Number of flow values a 
142 361 278 
130 621 280 
272 982 558 

Reference Genome 
Escherichia coli Dicentrarchus 
labrax 

Total 

Number of bases b 
4 639 675 
13 213 695 
– 

Empirical distributions 
Escherichia coli Dicentrarchus 
labrax 

Total 

Number of flow values in 
noise distributions 

280 763 949 
285 227 582 
565 991 531 

Number of flow values in 
homopolymer 
distributions c 

314 495 947 
278 127 101 
592 623 048 

a After 454 quality-trimming; b without N's; c homopolymer lengths 1–5, equals to 

number of homopolymer runs in BLAST results. 

</table></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_1" validated="false"><figDesc>Table 2.</figDesc><table>Parameters of the empirical distributions 

Homopolymer length 
Mean 
Standard deviation 

0 
0.1230 
0.0737 
1 
1.0193 
0.1227 
2 
2.0006 
0.1585 
3 
2.9934 
0.2188 
4 
3.9962 
0.3168 
5 
4.9550 
0.3863 
Linear regression for n ≥ 6 
n a 
0.03494 + n · 0.06856 a 

a Normal distribution. Mean and standard deviation of normal distribution around 

homopolymer lengths of 6, 7 etc. 

</table></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_2" validated="false"><figDesc>Table 3. De novo-based and reference-based N50 for E. coli Coverage</figDesc><table>Real 
200 cycles 
400 cycles 
(simulated) 
(simulated) 

De novo-based N50 for E.coli 
1 
649 
651 
995 
5 
2406 
7045 
7623 
10 
23 613 
132 913 
104 012 
15 
67 231 
173 592 
178 129 
20 
86 902 
172 127 
203 060 
25 
95 348 
176 747 
207 011 
30 
97 821 
171 819 
207 011 

Reference-based N50 for E. coli 

1 
895 
1093 
1681 
5 
8305 
31 730 
40 321 
10 
76 687 
207 827 
2 343 849 
15 
110 013 
207 856 
2 496 857 
20 
118 387 
207 740 
2 497 013 
25 
161 266 
207 899 
2 497 058 
30 
177 489 
207 845 
2 724 990 

</table></figure>

			<note place="foot">at :: on August 31, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from [10:32 28/8/2010 Bioinformatics-btq365.tex] Page: i422 i420–i425</note>

			<note place="foot">at :: on August 31, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>

			<note place="foot" n="3"> FLOWSIM—A SIMULATOR FOR 454 DATA To take advantage of the empirical distributions, we implemented Flowsim, a simulator for pyrosequencing data. 3.1 Implementation of Flowsim Given an input sequence in Fasta format, Flowsim selects substrings of this sequence with random position and strand, and generates a flowgram by converting the nucleotide sequences to sequences of homopolymer lengths. Each homopolymer length is then altered according to its flow distribution, where the latter is allowed to vary (degrade) with the flow position in the simulated read. To emulate degradation, we derived 20 different sets of empirical distributions from our mapping results (Fig. 3), where each of them represents 10 consecutive Titanium flow cycles, which sums up to 800 flow values. The simulated flowgram is then analyzed to call nucleotide sequence and quality scores. Finally, all generated information is stored in an SFF file, similar to the ones produced by the 454 software. One can further specify the number of desired output reads and also incorporate user-defined empirical distributions, either positionspecific (degrading) or not.</note>

			<note place="foot">i425 at :: on August 31, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>
		</body>
		<back>

			<div type="acknowledgement">
<div xmlns="http://www.tei-c.org/ns/1.0"><head>ACKNOWLEDGEMENTS</head><p>The authors wish to thank Dr Alexander Sczyrba, DOE Joint Genome Institute, Dr Richard Reinhardt, Max Planck Institute for Molecular Genetics, Berlin, for kindly providing us with Titanium raw data and Dr Christopher Quince, University of Glasgow, for the fruitful discussions. Notur is acknowledged for access to the Titan cluster in Oslo.</p></div>
			</div>

			<div type="references">

				<listBibl>

<biblStruct   xml:id="b0">
	<analytic>
		<title level="a" type="main">Basic local alignment search tool</title>
		<author>
			<persName>
				<forename type="first">S</forename>
				<forename type="middle">F</forename>
				<surname>Altschul</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Mol. Biol</title>
		<imprint>
			<biblScope unit="volume">215</biblScope>
			<biblScope unit="page" from="403" to="410" />
			<date type="published" when="1990" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b1">
	<analytic>
		<title level="a" type="main">The complete genome sequence of Escherichia coli K-12</title>
		<author>
			<persName>
				<forename type="first">F</forename>
				<forename type="middle">R</forename>
				<surname>Blattner</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Science</title>
		<imprint>
			<biblScope unit="volume">277</biblScope>
			<biblScope unit="page" from="1453" to="1462" />
			<date type="published" when="1997" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b2">
	<analytic>
		<title level="a" type="main">Quality scores and SNP detection in sequencing-by-synthesis systems</title>
		<author>
			<persName>
				<forename type="first">W</forename>
				<surname>Brockman</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Genome Res</title>
		<imprint>
			<biblScope unit="volume">18</biblScope>
			<biblScope unit="page" from="763" to="770" />
			<date type="published" when="2008" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b3">
	<analytic>
		<title level="a" type="main">GenFrag 2.1: new features for more robust fragment assembly benchmarks</title>
		<author>
			<persName>
				<forename type="first">M</forename>
				<forename type="middle">L</forename>
				<surname>Engle</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">C</forename>
				<surname>Burks</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Comput. Appl. Biosci</title>
		<imprint>
			<biblScope unit="volume">10</biblScope>
			<biblScope unit="page" from="567" to="568" />
			<date type="published" when="1994" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b4">
	<analytic>
		<title level="a" type="main">Systematic artifacts in metagenomes from complex microbial communities</title>
		<author>
			<persName>
				<forename type="first">V</forename>
				<surname>Gomez-Alvarez</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">ISME J</title>
		<imprint>
			<biblScope unit="volume">3</biblScope>
			<biblScope unit="page" from="1314" to="1317" />
			<date type="published" when="2009" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b5">
	<analytic>
		<title level="a" type="main">Accuracy and quality of massively parallel DNA pyrosequencing</title>
		<author>
			<persName>
				<forename type="first">S</forename>
				<forename type="middle">M</forename>
				<surname>Huse</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Genome Biol</title>
		<imprint>
			<biblScope unit="volume">8</biblScope>
			<biblScope unit="page">143</biblScope>
			<date type="published" when="2007" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b6">
	<analytic>
		<title level="a" type="main">MEGAN analysis of metagenomic data</title>
		<author>
			<persName>
				<forename type="first">D</forename>
				<forename type="middle">H</forename>
				<surname>Huson</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Genome Res</title>
		<imprint>
			<biblScope unit="volume">17</biblScope>
			<biblScope unit="page" from="377" to="386" />
			<date type="published" when="2007" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b7">
	<analytic>
		<title level="a" type="main">The European sea bass Dicentrarchus labrax genome puzzle: comparative BAC-mapping and low coverage shotgun sequencing</title>
		<author>
			<persName>
				<forename type="first">H</forename>
				<surname>Kuhl</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">BMC Genomics</title>
		<imprint>
			<biblScope unit="volume">11</biblScope>
			<biblScope unit="page">68</biblScope>
			<date type="published" when="2010" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b8">
	<analytic>
		<title level="a" type="main">Genome sequencing in microfabricated high-density picolitre reactors</title>
		<author>
			<persName>
				<forename type="first">M</forename>
				<surname>Margulies</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nature</title>
		<imprint>
			<biblScope unit="volume">437</biblScope>
			<biblScope unit="page" from="376" to="380" />
			<date type="published" when="2005" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b9">
	<analytic>
		<title level="a" type="main">Aggressive assembly of pyrosequencing reads with mates</title>
		<author>
			<persName>
				<forename type="first">J</forename>
				<forename type="middle">R</forename>
				<surname>Miller</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">24</biblScope>
			<biblScope unit="page" from="2818" to="2824" />
			<date type="published" when="2008" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b10">
	<analytic>
		<title level="a" type="main">A dataset generator for whole genome shotgun sequencing</title>
		<author>
			<persName>
				<forename type="first">G</forename>
				<surname>Myers</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proceedings of International Conference on Intelligent Systems of Molecular Biology</title>
		<meeting>International Conference on Intelligent Systems of Molecular Biology</meeting>
		<imprint>
			<date type="published" when="1999" />
			<biblScope unit="page" from="202" to="210" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b11">
	<analytic>
		<title level="a" type="main">Accurate determination of microbial diversity from 454 pyrosequencing data</title>
		<author>
			<persName>
				<forename type="first">C</forename>
				<surname>Quince</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nat. Methods</title>
		<imprint>
			<biblScope unit="volume">6</biblScope>
			<biblScope unit="page" from="639" to="641" />
			<date type="published" when="2009" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b12">
	<analytic>
		<title level="a" type="main">Pyrobayes: an improved base caller for SNP discovery in pyrosequences</title>
		<author>
			<persName>
				<forename type="first">A</forename>
				<forename type="middle">R</forename>
				<surname>Quinlan</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nat. Methods</title>
		<imprint>
			<biblScope unit="volume">5</biblScope>
			<biblScope unit="page" from="179" to="181" />
			<date type="published" when="2008" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b13">
	<analytic>
		<title level="a" type="main">MetaSim: a sequencing simulator for genomics and metagenomics</title>
		<author>
			<persName>
				<forename type="first">D</forename>
				<forename type="middle">C</forename>
				<surname>Richter</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">PLoS One</title>
		<imprint>
			<biblScope unit="volume">3</biblScope>
			<biblScope unit="page">3373</biblScope>
			<date type="published" when="2008" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b14">
	<analytic>
		<title level="a" type="main">Genome Sequencer Data Analysis Software Manual, Software Version 2</title>
	</analytic>
	<monogr>
		<title level="j">Roche Applied Science</title>
		<imprint>
			<publisher>Roche Diagnostics GmbH</publisher>
			<date type="published" when="2008" />
			<publisher>Roche Diagnostics GmbH</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b15">
	<analytic>
		<title level="a" type="main">A probabilistic method for small RNA flowgram matching</title>
		<author>
			<persName>
				<forename type="first">V</forename>
				<surname>Vacic</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Pacific Symposium on Biocomputing</title>
		<imprint>
			<date type="published" when="2008" />
			<biblScope unit="page" from="75" to="86" />
		</imprint>
	</monogr>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>