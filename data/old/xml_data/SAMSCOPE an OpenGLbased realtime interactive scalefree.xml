
<?xml version="1.0" encoding="UTF-8"?>
<TEI xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 /home/joey/Project/grobid/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<encodingDesc>
			<appInfo>
				<application version="0.4.2-SNAPSHOT" ident="GROBID" when="2017-08-10T23:53+0000">
					<ref target="https://github.com/kermitt2/grobid">GROBID - A machine learning software for extracting information from scholarly documents</ref>
				</application>
			</appInfo>
		</encodingDesc>
		<fileDesc>
			<titleStmt>
				<title level="a" type="main">Sequence analysis SAMSCOPE: an OpenGL-based real-time interactive scale-free SAM viewer</title>
			</titleStmt>
			<publicationStmt>
				<publisher/>
				<availability status="unknown"><licence/></availability>
				<date type="published" when="2012">2012</date>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author>
							<persName>
								<forename type="first">Kris</forename>
								<surname>Popendorf</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department">Biosciences and Informatics</orgName>
								<orgName type="institution">Keio University</orgName>
								<address>
									<addrLine>3-14-1 Hiyoshi</addrLine>
									<postCode>223-8522</postCode>
									<settlement>Yokohama</settlement>
									<country key="JP">Japan</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Yasubumi</forename>
								<surname>Sakakibara</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department">Biosciences and Informatics</orgName>
								<orgName type="institution">Keio University</orgName>
								<address>
									<addrLine>3-14-1 Hiyoshi</addrLine>
									<postCode>223-8522</postCode>
									<settlement>Yokohama</settlement>
									<country key="JP">Japan</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Alex</forename>
								<surname>Bateman</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department">Biosciences and Informatics</orgName>
								<orgName type="institution">Keio University</orgName>
								<address>
									<addrLine>3-14-1 Hiyoshi</addrLine>
									<postCode>223-8522</postCode>
									<settlement>Yokohama</settlement>
									<country key="JP">Japan</country>
								</address>
							</affiliation>
						</author>
						<title level="a" type="main">Sequence analysis SAMSCOPE: an OpenGL-based real-time interactive scale-free SAM viewer</title>
					</analytic>
					<monogr>
						<title level="j" type="main">BIOINFORMATICS APPLICATIONS NOTE</title>
						<imprint>
							<biblScope unit="volume">28</biblScope>
							<biblScope unit="issue">9</biblScope>
							<biblScope unit="page" from="1276" to="1277"/>
							<date type="published" when="2012">2012</date>
						</imprint>
					</monogr>
					<idno type="DOI">10.1093/bioinformatics/bts122</idno>
					<note type="submission">Received on October 17, 2011; revised on January 28, 2012; accepted on March 7, 2012</note>
					<note>Copyedited by: TRJ MANUSCRIPT CATEGORY: APPLICATIONS NOTE [12:54 9/4/2012 Bioinformatics-bts122.tex] Page: 1276 1276–1277 Associate Editor:</note>
				</biblStruct>
			</sourceDesc>
		</fileDesc>
		<profileDesc>
			<abstract>
				<p>Existing SAM visualization tools like &apos;samtools tview&apos; (Li et al., 2009) are limited to a small region of the genome, and tools like Tablet (Milne et al., 2010) are limited to a relatively small number of reads and may fail outright on large datasets. We need to visualize complex ChIP-Seq and RNA-Seq features such as polarity as well as coverage across whole 3 Gbp genomes such as Human. We have addressed these problems in a lightweight visualization system called SAMSCOPE accelerated by OpenGL. The extensive pre-processing and fast OpenGL interface of SAMSCOPE provides instantaneous and intuitive browsing of complex data at all levels of detail across multiple experiments. Availability and implementation: The SAMSCOPE software, implemented in C++ for Linux, with source code, binary packages and documentation are freely available from</p>
			</abstract>
		</profileDesc>
	</teiHeader>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1">INTRODUCTION</head><p>Next-generation sequencing (NGS) workflows often involve mapping reads onto reference genomes using tools such as SHRiMP2 (<ref type="bibr" target="#b0">David et al., 2011</ref>), Bowtie (<ref type="bibr" target="#b2">Langmead et al., 2009</ref>) and others. Mapping determines the likely point of origin (or origins) of a given read. Despite the multitude of different mapping methods and software, the SAM (Sequence Alignment/Map) format (<ref type="bibr" target="#b4">Li et al., 2009</ref>) and the associated binary encoding (BAM) have emerged as the lingua franca of NGS mapping file formats. For many projects using SAM data, it is desirable to visually inspect the results of mapping for quality control and exploration. However, because a single NGS run can provide millions of reads from billions of bases of genome sequence, simply opening up a SAM file and making sense of the content is a non-trivial problem. The two main problems in visualization of a SAM dataset are:</p><p>(1) Sam files are structured in terms of reads. To calculate coverage of a given base, we have to look at each read and see which bases it maps to, then count how many times that base has been mapped.</p><p>(As visualization is a common need, a variety of tools have been introduced to view SAM data in different ways. For example 'samtools tview' (<ref type="bibr" target="#b4">Li et al., 2009</ref>) provides an interactive textbased viewer which shows each base of each read and reference genome as a character in a text terminal. This can be useful for inspecting narrow regions (∼100 bases) with fewer reads than terminal rows (∼30), but not helpful for examining larger regions or deeper coverage. 'Tablet' (<ref type="bibr" target="#b5">Milne et al., 2010</ref>) and its close cousin 'IGB' (<ref type="bibr" target="#b6">Nicol et al., 2009</ref>) both provide Java-based graphical interfaces for drawing reads against a reference sequence where each base is represented as a colored rectangle. Both can summarize overall coverage with a secondary visualization track. However, both Tablet and IGB draw each read similar to 'samtools tview', limiting their speed and effectiveness when a large number of reads would be in view. 'Integrative Genomics Viewer' (IGV;<ref type="bibr" target="#b8">Robinson et al., 2011</ref>) can load SAM/BAM files providing detailed inspection capabilities, and provides a 'mean coverage' track given proper pre-processing, which can scale to arbitrary genome sizes. For applications like ChIP-Seq (<ref type="bibr" target="#b7">Pepke et al., 2009</ref>) or RNA-Seq however, 'mean coverage' is not necessarily helpful and hard to use at large scales, as most coverage values are at zero or near zero. We needed a flexible method to visualize and interactively inspect various features from large numbers of reads across mammalianscale genomes while addressing the problems above, so we developed our own approach in SAMSCOPE. 3D computer graphics addresses a similar problem when drawing textures on distant 3D objects: how to efficiently generate a reasonable approximation of millions of points of color data into one screen pixel. A solution known as MIP mapping (<ref type="bibr" target="#b10">Williams, 1983</ref>) has become a mainstay of modern 3D rendering; in it a series of filtered copies of each texture are pre-calculated at exponentially decreasing resolutions. Thus, when a distant object is rendered, rather than sampling millions of points to calculate the combined contribution to one screen pixel, an approximation is achieved with just a few samples from a lower resolution copy. We apply the MIP map concept to genome visualization in SAMSCOPE.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2">METHODS AND IMPLEMENTATION</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>SAMSCOPE</head><p>for different applications. For example, in ChIP-Seq the difference in number of reads mapped to the forward strand compared with the reverse strand (what we term 'polarity') results in a characteristic zero-crossing invertedpeak pair which, in conjunction with coverage, often reflects protein binding sites (<ref type="bibr" target="#b7">Pepke et al., 2009</ref>). SAMSCOPE allows easy composition of data layers into compound data layers, such as polarity; 'forward' and 'reverse' count layers are generated, from which overall 'coverage' (the sum) and 'polarity' (the difference) are derived (shown in<ref type="figure" target="#fig_1">Fig. 1B</ref>). This design allows for fast and memory efficient pre-processing of huge datasets, as data primitives can be stored on disk and accessed at random as needed. To generate BIPs we adapt the traditional graphics MIP map approach to sampling 1D data series. The pre-processing algorithm is as follows:</p><p>(1) Calculate the full resolution series with one value for each base of reference genome, forming a series of columns with one value each.</p><p>(2) Merge data from adjacent columns generating half the number of composite columns. To merge two columns, combine values from each column as value/frequency tuples. For example, if the value '3' occurred twice in each column, a single tuple {3,4} would be retained.</p><p>(3) If the number of value/frequency tuples in the current column exceeds a user adjustable maximum, retain a subset; the most frequent values are prioritized, along with the extreme maximum and minimum values.</p><p>(4) The merged column data and an index reference for fast random lookup are stored to disk.</p><p>(5) Steps 2–4 are repeated until only one column remains.</p><p>To render a given region of data, a set of columns is selected to match the pixel width of the display window. For example, if rendering a 50 Mbp region in a 1024 pixel wide window, data from the 16th 'column merge' iteration is selected, such that each column represents a sample from the underlying 2 16 = 65 536 bases. Thus, the display can be rendered with data from 763 precomputed columns. This approach has some practical benefits: @BULLET To draw one screen of P pixels, at most O(P) values must be read and drawn. Fast rendering allows us to abandon scroll bars, and adopt an intuitive mouse-based 'pan and zoom' interface familiar to users of Google Maps (http://maps.google.com). @BULLET The pre-processed data retains multiple values per column, allows SAMSCOPE to change the rendering style at runtime to a representative spectrum of values at each column, or an average value, or maxima and minima or other arbitrary effects.</p><p>@BULLET Complex features (such as peaks in ChIP-Seq and RNA-Seq) are visible at genome-scale, and not obscured by techniques like averaging as used in previous tools like IGV and MAQ (<ref type="bibr" target="#b3">Li et al., 2008</ref>). @BULLET Just as BIP display only needs a few columns in memory at a time, BIP generation only needs the values of two pairs of columns. Thus SAMSCOPE can run perfectly well on an average laptop computer. @BULLET Finally, because empty columns do not need to store any data values, and because BIP files are stored as 'sparse files' on disk, BIP files are well suited for sparse data like exomes or ChIP-Seq.</p><p>Sequence parameters (such as chromosome name and length) are obtained from the source SAM/BAM file itself, eliminating any additional sequence setup steps as are required in programs like IGV. Annotation data from GFF/GTF files are displayed if available (<ref type="figure" target="#fig_1">Fig. 1A</ref>). As a practical benchmark on human reference, a coverage BIP file can be generated from 54 M 120 bp mapped reads on a server with 96 GB of RAM in 12 min, or on an ordinary desktop with 6 GB of RAM in 19 min.<ref type="bibr" target="#b9">Shang et al., 2010</ref>).</p></div><figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_0"><head></head><figDesc>SAMSCOPE adopts a layer-based display model, where each layer reflects a SAM mapping feature, such as coverage. Layers are stored as BAM MIP Maps ('BIPs') on disk in a binary format allowing instantaneous navigation with minimal memory requirements. Multiple layers can be displayed simultaneously as different colors, and in multiple synchronized windows. This layer-based design makes it simple to display results from multiple SAM files as different layers, and visually compare results from different experiments. SAMSCOPE supports a variety of feature calculations Copyedited by: TRJ MANUSCRIPT CATEGORY: APPLICATIONS NOTE [12:54 9/4/2012 Bioinformatics-bts122.tex] Page: 1277 1276–1277</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_1"><head>Fig.1.</head><figDesc>Fig. 1. (A) Shows coverage from an RNA-Seq experiment on a 7072 bp region of Bacillus subtilis subsp. natto BEST195. Gene annotations are shown as green bars below the X-axis. (B) Shows 'forward, reverse and polarity' layers from a ChIP-Seq analysis of CENPA focusing on a 500 bp region at in Z chromosome centromere of chicken (Shang et al., 2010).</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_0" validated="false"><figDesc>2) Most computers only have 1000–2000 pixel wide displays with which to visualize billions of data points. * To whom correspondence should be addressed.</figDesc><table></table></figure>

			<note place="foot">© The Author 2012. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oup.com at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>

			<note place="foot" n="3"> DISCUSSION SAMSCOPE&apos;s BIP format is similar in its goal to the BigBed and BigWig (Kent et al., 2010). However where BigBed/BigWig use B-trees and a complex data layout suitable for remote access over HTTP, SAMSCOPE uses a much simpler flat file format designed for local access through the POSIX mmap function. This design allows the entire process to run efficiently on commodity hardware. SAMSCOPE can be more efficient for its purpose because where BigBed is designed to contain any arbitrary annotation (e.g. scores from overlapping alignments etc.), SAMSCOPE focuses on per base aggregate statistics (e.g. coverage, polarity etc.). We find the BigBed and BIP formats to be complementary in this sense.</note>

			<note place="foot">at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>
		</body>
		<back>
			<div type="annex">
			</div>
			<div type="references">

				<listBibl>

<biblStruct   xml:id="b0">
	<analytic>
		<title level="a" type="main">SHRiMP2: sensitive yet practical SHort Read Mapping</title>
		<author>
			<persName>
				<forename type="first">M</forename>
				<surname>David</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">27</biblScope>
			<biblScope unit="page" from="1011" to="1012" />
			<date type="published" when="2011" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b1">
	<analytic>
		<title level="a" type="main">BigWig and BigBed: enabling browsing of large distributed datasets</title>
		<author>
			<persName>
				<forename type="first">W</forename>
				<forename type="middle">J</forename>
				<surname>Kent</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">26</biblScope>
			<biblScope unit="page" from="2204" to="2207" />
			<date type="published" when="2010" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b2">
	<analytic>
		<title level="a" type="main">Ultrafast and memory-efficient alignment of short DNA sequences to the human genome</title>
		<author>
			<persName>
				<forename type="first">B</forename>
				<surname>Langmead</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Genome Biol</title>
		<imprint>
			<biblScope unit="volume">10</biblScope>
			<biblScope unit="page">25</biblScope>
			<date type="published" when="2009" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b3">
	<analytic>
		<title level="a" type="main">Mapping short DNA sequencing reads and calling variants using mapping quality scores</title>
		<author>
			<persName>
				<forename type="first">H</forename>
				<surname>Li</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Genome Res</title>
		<imprint>
			<biblScope unit="volume">18</biblScope>
			<biblScope unit="page" from="1851" to="1858" />
			<date type="published" when="2008" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b4">
	<analytic>
		<title level="a" type="main">The Sequence Alignment/Map format and SAMtools</title>
		<author>
			<persName>
				<forename type="first">H</forename>
				<surname>Li</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">25</biblScope>
			<biblScope unit="page" from="2078" to="2079" />
			<date type="published" when="2009" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b5">
	<analytic>
		<title level="a" type="main">Tablet–next generation sequence assembly visualization</title>
		<author>
			<persName>
				<forename type="first">I</forename>
				<surname>Milne</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">26</biblScope>
			<biblScope unit="page" from="401" to="402" />
			<date type="published" when="2010" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b6">
	<analytic>
		<title level="a" type="main">The Integrated Genome Browser: free software for distribution and exploration of genome-scale datasets</title>
		<author>
			<persName>
				<forename type="first">J</forename>
				<forename type="middle">W</forename>
				<surname>Nicol</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">25</biblScope>
			<biblScope unit="page" from="2730" to="2731" />
			<date type="published" when="2009" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b7">
	<analytic>
		<title level="a" type="main">Computation for ChIP-seq and RNA-seq studies</title>
		<author>
			<persName>
				<forename type="first">S</forename>
				<surname>Pepke</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nat. Methods</title>
		<imprint>
			<biblScope unit="volume">6</biblScope>
			<biblScope unit="page" from="22" to="32" />
			<date type="published" when="2009" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b8">
	<analytic>
		<title level="a" type="main">Integrative genomics viewer</title>
		<author>
			<persName>
				<forename type="first">J</forename>
				<forename type="middle">T</forename>
				<surname>Robinson</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nat. Biotechnol</title>
		<imprint>
			<biblScope unit="volume">29</biblScope>
			<biblScope unit="page" from="24" to="26" />
			<date type="published" when="2011" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b9">
	<analytic>
		<title level="a" type="main">Chickens possess centromeres with both extended tandem repeats and short non-tandem-repetitive sequences</title>
		<author>
			<persName>
				<forename type="first">W</forename>
				<forename type="middle">H</forename>
				<surname>Shang</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Genome Res</title>
		<imprint>
			<biblScope unit="volume">20</biblScope>
			<biblScope unit="page" from="1219" to="1228" />
			<date type="published" when="2010" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b10">
	<analytic>
		<title level="a" type="main">Pyramidal parametrics</title>
		<author>
			<persName>
				<forename type="first">L</forename>
				<surname>Williams</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Comp. Graph</title>
		<imprint>
			<biblScope unit="volume">17</biblScope>
			<biblScope unit="page" from="1" to="11" />
			<date type="published" when="1983" />
		</imprint>
	</monogr>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>