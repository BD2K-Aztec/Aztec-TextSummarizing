
<?xml version="1.0" encoding="UTF-8"?>
<TEI xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 /home/joey/Project/grobid/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<encodingDesc>
			<appInfo>
				<application version="0.4.2-SNAPSHOT" ident="GROBID" when="2017-08-10T23:29+0000">
					<ref target="https://github.com/kermitt2/grobid">GROBID - A machine learning software for extracting information from scholarly documents</ref>
				</application>
			</appInfo>
		</encodingDesc>
		<fileDesc>
			<titleStmt>
				<title level="a" type="main">Genetics and population analysis SELAM: simulation of epistasis and local adaptation during admixture with mate choice</title>
			</titleStmt>
			<publicationStmt>
				<publisher/>
				<availability status="unknown"><licence/></availability>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author>
							<persName>
								<forename type="first">Russell</forename>
								<surname>Corbett-Detig</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department">Department of Integrative Biology</orgName>
								<orgName type="institution">University of California Berkeley</orgName>
								<address>
									<settlement>Berkeley</settlement>
									<region>CA</region>
									<country key="US">USA</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Matt</forename>
								<surname>Jones</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department">Department of Integrative Biology</orgName>
								<orgName type="institution">University of California Berkeley</orgName>
								<address>
									<settlement>Berkeley</settlement>
									<region>CA</region>
									<country key="US">USA</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Oliver</forename>
								<surname>Stegle</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department">Department of Integrative Biology</orgName>
								<orgName type="institution">University of California Berkeley</orgName>
								<address>
									<settlement>Berkeley</settlement>
									<region>CA</region>
									<country key="US">USA</country>
								</address>
							</affiliation>
						</author>
						<title level="a" type="main">Genetics and population analysis SELAM: simulation of epistasis and local adaptation during admixture with mate choice</title>
					</analytic>
					<monogr>
						<imprint>
							<date/>
						</imprint>
					</monogr>
					<idno type="DOI">10.1093/bioinformatics/btw365</idno>
					<note type="submission">Received on February 22, 2016; revised on May 16, 2016; accepted on June 6, 2016</note>
					<note>*To whom correspondence should be addressed. Associate Editor:</note>
				</biblStruct>
			</sourceDesc>
		</fileDesc>
		<profileDesc>
			<textClass>
				<keywords>Contact: russcd@gmailcom</keywords>
			</textClass>
			<abstract>
				<p>SELAM is a forward time population genetic simulation program that provides a flexible framework for simulating admixture between any number of ancestral populations. The program can be used to simulate complex demographic and selection models, including dioecious or mon-oecious populations, autosomal or sex chromosomes, local adaptation, dominance, epistasis, and mate choice. Availability and Implementation: The SELAM package (C þþ source code, examples and manuals) is available via github at https://github.com/russcd/SELAM. This package is distributed under version 3 of the GNU general public license.</p>
			</abstract>
		</profileDesc>
	</teiHeader>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1">Introduction</head><p>There is a growing appreciation for the importance of admixture in a variety of evolutionary processes. Admixture has played a critical role in the evolutionary histories of non-African modern humans (<ref type="bibr" target="#b10">Sankararaman et al. 2014</ref>), Drosophila melanogaster (<ref type="bibr" target="#b8">Pool et al., 2012</ref>), and numerous other species. Admixture has the potential to influence a wide variety of evolutionary processes including shaping patterns of neutral genetic variation, introducing adaptive (<ref type="bibr">PardoDiaz et al., 2012</ref>) and deleterious alleles (<ref type="bibr" target="#b10">Sankararaman et al., 2014</ref>), and producing novel ecologically and reproductively isolated lineages (<ref type="bibr" target="#b9">Rieseberg, 2003</ref>). In order to study patterns of local ancestry across the genome and to develop novel theoretical predictions, an efficient and a flexible simulation framework that can track complete ancestry information and incorporate an array of selective and demographic functions is essential. Previous studies have used coalescent approaches to study the distributions of haplotype structure resulting from relatively ancient admixture events (<ref type="bibr" target="#b10">Sankararaman et al., 2014</ref>). Though efficient, the coalescent has limited utility for studies that focus on natural selection, which is of central interest for many admixed populations (although see e.g. Ewing and Hermisson 2010). For this reason, forward in time simulations are appealing, and recently a number of efficient forward-time simulation programs have been released (<ref type="bibr" target="#b11">Thornton, 2014;</ref><ref type="bibr" target="#b6">Messer, 2013;</ref><ref type="bibr" target="#b4">Hernandez, 2008</ref>). The majority of these software packages are designed to simulate the evolution and inheritance of mutations distributed along a chromosome. Although this approach is capable of simulating admixture (see<ref type="bibr" target="#b1">Cui et al. 2015</ref>for one implementation), by design these programs do not retain full ancestral information and many require substantive burn-in periods to achieve genetic equilibrium. If the process and consequences of admixture are the primary interest, and not the evolutionary factors that generate the genetic diversity present in ancestral populations, an efficient simulation framework can be achieved by tracking local ancestry, rather than specific mutations, along chromosomes. Similar methods have been used previously in the context of studying relatively short evolutionary processes such as artificial selection (<ref type="bibr" target="#b5">Kessner and Novembre, 2014;</ref><ref type="bibr" target="#b3">Haiminen et al., 2013</ref>), and more generally for long term population genetic inference (<ref type="bibr" target="#b0">Aberer and Stamatakis, 2013)</ref>). As the number of generations increases, this approach often performs poorly due to the rapid accumulation of recombination events that must be tracked in all descendent individuals. Here, we propose mitigating these issues by tracking local ancestry in genomic segments that can be accessed and inherited as a group. We implement this solution in SELAM, a forward-time population genetic simulator that is designed to efficiently handle both short and long-term admixture simulations while retaining complete local ancestry information. Furthermore, this program incorporates a broad spectrum of</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Bioinformatics Advance Access published July 13, 2016</head><p>biologically realistic aspects of admixture which are, to our knowledge, not available within any existing simulation framework; among other things, SELAM can simulate local adaptation, separate sexes (with distinct migration rates, selection coefficients and sex chromosomes), pairwise epistasis, and mate choice.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2">Methods and features</head><p>SELAM is based on the extended Wright-Fisher model. Each generation consists of migration between subpopulations, mating based on individuals' fitness and mate choice loci, and offspring production. Once all the offspring are created, the parent generation dies. In the beginning of the simulation, all subpopulations are composed of proportions of individuals from any number of ancestral populations. Each subsequent generation consists of migration between subpopulations, as well as migration from non-admixed ancestral populations into admixed subpopulations. All demographic parameters can be modified during simulation. SELAM therefore supports simulations of complex evolutionary processes. SELAM also supports a variety of selection models. Users may specify a single locus selection, pairwise epistatic selection, population-specific selection and loci influencing mate choice. The user must also supply SELAM with an input file, which specifies how many individuals to output from a given subpopulation at a given generation during the simulation. SELAM's ability to output individuals at multiple time points throughout the simulation makes this software applicable for studies where samples are distributed across many generations (e.g. ancient DNA, artificial selection and time series experiments). The SELAM package also includes a basic statistics program that enables users to obtain linkage disequilibria, ancestry frequencies and haplotype structure information across the genome. Forward time simulations must account for all individuals within a simulation, which can pose a substantial computational burden, especially for longer simulations. SELAM's primary data structure, the ancestry block, stores all relevant genetic information for a genomic region. A chromosome is then represented as a vector of pointers to ancestry blocks (<ref type="figure">Fig. 1</ref>). Instead of copying all genetic information to the offspring chromosome, an ancestry block is retrieved only when it is needed (i.e. during recombination with another ancestry block), otherwise a pointer to the ancestry block is passed to the child chromosome without modification. The data structure within each ancestry block, a list of positions where ancestry switches, resembles that of other haplotype-based simulators (<ref type="bibr" target="#b3">Haiminen et al., 2013;</ref><ref type="bibr" target="#b5">Kessner and Novembre, 2014</ref>; Aberer and Stamatakis, 2013,<ref type="figure">Fig. 1</ref>), but also contains a list of selected and mate choice alleles that are present within the ancestry block. By varying the frequency of extinct ancestry block deletion as well as ancestry block length, both run time and memory usage can be optimized for a given set of simulation parameters and available computational resources (described in detail in the SELAM manual). These features enable SELAM to perform long simulations efficiently. As with other haplotype-based simulations (<ref type="bibr" target="#b3">Haiminen et al., 2013;</ref><ref type="bibr" target="#b5">Kessner and Novembre, 2014;</ref><ref type="bibr" target="#b0">Aberer and Stamatakis, 2013</ref>), it is straightforward to place neutral mutations onto ancestral haplotypes once the simulation has finished. If the sample is small relative to the size of the simulated population, it is sufficient to record the local population ancestry because there is little risk of sampling individuals who share segments of their genome that are identical be descent. However, if the simulated population is relatively small, or the simulation time is very long, the probability of sampling individuals who share genetic ancestors is non-negligible. In this case, it may be desirable to track each unique ancestral haplotype individually. SELAM can support this as well—see, e.g., example 6 in the SELAM package. We have found that SELAM reproduces the expected ancestry tract length distribution via comparisons to coalescent-based simulations (<ref type="figure">Fig. 1</ref>, additional validations are reported in the SELAM manual). Furthermore, simulating the full human genome with a demographic history approximating that of modern Europeans in the time since admixture with Neanderthal populations—i.e. 2000 generations and including a maximum population size of 20,000 diploid individuals—took 51 minutes and had a peak memory usage of approximately 3.4 gigabytes on a personal computer using SELAM's default parameters (see example 3 of the SELAM package). SELAM is therefore capable of performing complex and biologically realistic simulations of long-term admixture using modest computational resources.<ref type="figure">Fig. 1</ref>. In SELAM, a chromosome is a vector of pointers to ancestry blocks, which contain lists of pairs of start positions and ancestry types in the subsequent tract (A). In comparisons between SELAM (solid) and a coalescent simulation (dotted), SELAM produced an indistinguishable and correct distribution of ancestry tracts (P ¼ 0.78, Kolmogorov-Smirnov Test, B)</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>A B</head></div><figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_0" validated="false"><figDesc>V C The Author 2016. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com 1 Bioinformatics, 2016, 1–3 doi: 10.1093/bioinformatics/btw365 Advance Access Publication Date: 17 June 2016 Applications note</figDesc><table></table></figure>

			<note place="foot">at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>

			<note place="foot">R.Corbett-Detig and M.Jones at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>
		</body>
		<back>

			<div type="acknowledgement">
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Acknowledgements</head><p>The authors thank Shelbi Russell, Tyler Linderoth, Rasmus Nielsen, and two anonymous reviewers for helpful discussion and comments on the manuscript.</p></div>
			</div>

			<div type="references">

				<listBibl>

<biblStruct   xml:id="b0">
	<analytic>
		<title level="a" type="main">Rapid forward-in-time simulation at the chromosome and genome level</title>
		<author>
			<persName>
				<forename type="first">A</forename>
				<forename type="middle">J</forename>
				<surname>Aberer</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">A</forename>
				<surname>Stamatakis</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">BMC Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">14</biblScope>
			<biblScope unit="page">216</biblScope>
			<date type="published" when="2013" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b1">
	<analytic>
		<title level="a" type="main">Admix&apos;em: a flexible framework for forward-time simulations of hybrid populations with selection and mate choice</title>
		<author>
			<persName>
				<forename type="first">R</forename>
				<surname>Cui</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioninformatics</title>
		<imprint>
			<biblScope unit="volume">32</biblScope>
			<biblScope unit="page" from="1103" to="1105" />
			<date type="published" when="2015" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b2">
	<analytic>
		<title level="a" type="main">MSMS: a coalescent simulation program including in recombintion, demographic structure and selection at a single locus</title>
		<author>
			<persName>
				<forename type="first">G</forename>
				<surname>Ewing</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">J</forename>
				<surname>Hermisson</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">26</biblScope>
			<biblScope unit="page" from="2064" to="2065" />
			<date type="published" when="2010" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b3">
	<analytic>
		<title level="a" type="main">Efficient in silico Chromosomal Representation of Populations via Indexing Ancestral Genomes</title>
		<author>
			<persName>
				<forename type="first">N</forename>
				<surname>Haiminen</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Algorithms</title>
		<imprint>
			<biblScope unit="volume">6</biblScope>
			<biblScope unit="page" from="430" to="441" />
			<date type="published" when="2013" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b4">
	<analytic>
		<title level="a" type="main">A flexible forward simulator for populations subject to selection and demography</title>
		<author>
			<persName>
				<forename type="first">R</forename>
				<forename type="middle">D</forename>
				<surname>Hernandez</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">24</biblScope>
			<biblScope unit="page" from="2786" to="2787" />
			<date type="published" when="2008" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b5">
	<analytic>
		<title level="a" type="main">forqs: forward-in-time simulation of recombination, quantitative traits and selection</title>
		<author>
			<persName>
				<forename type="first">D</forename>
				<surname>Kessner</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">J</forename>
				<surname>Novembre</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">30</biblScope>
			<biblScope unit="page" from="576" to="577" />
			<date type="published" when="2014" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b6">
	<analytic>
		<title level="a" type="main">SLiM: simulating evolution with selection and linkage</title>
		<author>
			<persName>
				<forename type="first">P</forename>
				<forename type="middle">W</forename>
				<surname>Messer</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Genetics</title>
		<imprint>
			<biblScope unit="volume">194</biblScope>
			<biblScope unit="page" from="1037" to="1039" />
			<date type="published" when="2013" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b7">
	<analytic>
		<title level="a" type="main">Adaptive Introgression across Species Boundaries in Heliconius Butterflies</title>
		<author>
			<persName>
				<forename type="first">C</forename>
				<surname>Pardo-Diaz</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">PLoS Genet</title>
		<imprint>
			<biblScope unit="volume">8</biblScope>
			<biblScope unit="page" from="1002752" to="1002713" />
			<date type="published" when="2012" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b8">
	<analytic>
		<title level="a" type="main">Population Genomics of Sub-Saharan Drosophila melanogaster: African Diversity and Non-African Admixture</title>
		<author>
			<persName>
				<forename type="first">J</forename>
				<forename type="middle">E</forename>
				<surname>Pool</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">PLoS Genet</title>
		<imprint>
			<biblScope unit="volume">8</biblScope>
			<biblScope unit="page" from="1003080" to="1003024" />
			<date type="published" when="2012" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b9">
	<analytic>
		<title level="a" type="main">Major Ecological Transitions in Wild Sunflowers Facilitated by Hybridization</title>
		<author>
			<persName>
				<forename type="first">L</forename>
				<forename type="middle">H</forename>
				<surname>Rieseberg</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Science</title>
		<imprint>
			<biblScope unit="volume">301</biblScope>
			<biblScope unit="page" from="1211" to="1216" />
			<date type="published" when="2003" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b10">
	<analytic>
		<title level="a" type="main">The genomic landscape of Neanderthal ancestry in present-day humans</title>
		<author>
			<persName>
				<forename type="first">S</forename>
				<surname>Sankararaman</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nature</title>
		<imprint>
			<biblScope unit="volume">507</biblScope>
			<biblScope unit="page" from="354" to="357" />
			<date type="published" when="2014" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b11">
	<analytic>
		<title level="a" type="main">A C þþ template library for efficient forward-time population genetic simulation of large populations</title>
		<author>
			<persName>
				<forename type="first">K</forename>
				<forename type="middle">R</forename>
				<surname>Thornton</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Genetics</title>
		<imprint>
			<biblScope unit="page" from="157" to="166" />
			<date type="published" when="0198" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b12">
	<monogr>
		<title level="m" type="main">Simulation of epistasis and local adaptation during admixture with mate choice</title>
		<imprint/>
	</monogr>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>