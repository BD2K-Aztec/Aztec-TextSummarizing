
<?xml version="1.0" encoding="UTF-8"?>
<TEI xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 /home/joey/Project/grobid/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<encodingDesc>
			<appInfo>
				<application version="0.4.2-SNAPSHOT" ident="GROBID" when="2017-08-10T23:48+0000">
					<ref target="https://github.com/kermitt2/grobid">GROBID - A machine learning software for extracting information from scholarly documents</ref>
				</application>
			</appInfo>
		</encodingDesc>
		<fileDesc>
			<titleStmt>
				<title level="a" type="main">Gene expression Updating RNA-Seq analyses after re-annotation</title>
			</titleStmt>
			<publicationStmt>
				<publisher/>
				<availability status="unknown"><licence/></availability>
				<date type="published" when="2013">2013</date>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author>
							<persName>
								<forename type="first">Adam</forename>
								<surname>Roberts</surname>
							</persName>
						</author>
						<author>
							<persName>
								<forename type="first">Lorian</forename>
								<surname>Schaeffer</surname>
							</persName>
							<affiliation key="aff1">
								<orgName type="department">Department of Molecular and Cell Biology</orgName>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Lior</forename>
								<surname>Pachter</surname>
							</persName>
							<affiliation key="aff1">
								<orgName type="department">Department of Molecular and Cell Biology</orgName>
							</affiliation>
							<affiliation key="aff2">
								<orgName type="department">Department of Mathematics</orgName>
								<orgName type="institution">University of Calofornia Berkeley</orgName>
								<address>
									<postCode>94720</postCode>
									<settlement>Berkeley</settlement>
									<region>CA</region>
									<country key="US">USA</country>
								</address>
							</affiliation>
						</author>
						<author>
							<affiliation key="aff0">
								<orgName type="department">Department of Computer Science</orgName>
							</affiliation>
						</author>
						<title level="a" type="main">Gene expression Updating RNA-Seq analyses after re-annotation</title>
					</analytic>
					<monogr>
						<imprint>
							<biblScope unit="volume">29</biblScope>
							<biblScope unit="issue">13</biblScope>
							<biblScope unit="page" from="1631" to="1637"/>
							<date type="published" when="2013">2013</date>
						</imprint>
					</monogr>
					<idno type="DOI">10.1093/bioinformatics/btt197</idno>
					<note type="submission">Received and revised on April 11, 2013; accepted on April 21, 2013</note>
					<note>BIOINFORMATICS ORIGINAL PAPER Associate Editor: Ivo Hofacker Supplementary information: Supplementary data are available at Bioinformatics online.</note>
				</biblStruct>
			</sourceDesc>
		</fileDesc>
		<profileDesc>
			<abstract>
				<p>The estimation of isoform abundances from RNA-Seq data requires a time-intensive step of mapping reads to either an assembled or previously annotated transcriptome, followed by an optimization procedure for deconvolution of multi-mapping reads. These procedures are essential for downstream analysis such as differential expression. In cases where it is desirable to adjust the underlying annotation, for example, on the discovery of novel isoforms or errors in existing annotations , current pipelines must be rerun from scratch. This makes it difficult to update abundance estimates after re-annotation, or to explore the effect of changes in the transcriptome on analyses. We present a novel efficient algorithm for updating abundance estimates from RNA-Seq experiments on re-annotation that does not require re-analysis of the entire dataset. Our approach is based on a fast partitioning algorithm for identifying transcripts whose abundances may depend on the added or deleted isoforms, and on a fast follow-up approach to re-estimating abundances for all transcripts. We demonstrate the effectiveness of our methods by showing how to synchronize RNA-Seq abundance estimates with the daily RefSeq incremental updates. Thus, we provide a practical approach to maintaining relevant databases of RNA-Seq derived abundance estimates even as annotations are being constantly revised. Availability and implementation: Our methods are implemented in software called ReXpress and are freely available, together with source code, at http://bio.</p>
			</abstract>
		</profileDesc>
	</teiHeader>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1">INTRODUCTION</head><p>Two major bottlenecks in RNA-Seq analysis are the mapping of reads to transcripts, which is a prerequisite for quantification and differential analysis, and abundance estimation following mapping. The latter step is particularly complex when multimapping reads need to be resolved, which is necessary for estimating isoform-level abundances, or when genes have been duplicated (<ref type="bibr" target="#b17">Trapnell et al., 2012</ref>). Popular programs for multiread assignment, such as Cufflinks (<ref type="bibr" target="#b16">Trapnell et al., 2010</ref>) and RSEM (<ref type="bibr" target="#b4">Li and Dewey, 2011</ref>), have large memory and time requirements [see<ref type="figure">Fig. 1</ref>of (<ref type="bibr" target="#b12">Roberts and Pachter, 2013)]</ref>. Alternative approaches, such as eXpress (<ref type="bibr" target="#b12">Roberts and Pachter, 2013</ref>), which uses a streaming algorithm for assignment, are faster with a low-memory footprint but must still re-process all the data from scratch when the underlying annotation is adjusted. For large datasets, such as the 3.5 billion reads of (<ref type="bibr" target="#b2">Graveley et al., 2010</ref>), a complete run of read mapping with Bowtie, followed by abundance estimation with eXpress, takes 11 days (with 44 cores used for the mapping). In cases where an annotation of transcripts in a genome may change after mapping, current analysis pipelines require re-mapping of all reads followed by a complete recomputation of abundances (<ref type="bibr" target="#b15">Schultheiss et al., 2011;</ref><ref type="bibr" target="#b18">Trapnell et al., 2013</ref>). This has made it time-consuming and impractical to determine the effects of the addition of possibly novel transcripts on results or the impact of removal of transcripts that appear to be incorrect. Moreover, in cases of model organisms, it has resulted in the 'freezing' of analyses with respect to specific annotation sets, even though re-annotation efforts are resulting in continuous changes to 'reference' transcriptomes (<ref type="bibr" target="#b9">Ouzouonis and Karp, 2002</ref>). The problem we solve in this article is how to update quantification of transcript abundances in cases where annotations change, without remapping all reads to all transcripts and running abundance estimation procedures from scratch. This problem is non-trivial for two reasons:</p><p>(1) Multi-mapping: Frequently reads map to multiple transcripts, and therefore the removal or addition of transcripts may change the posterior probabilities associated to read mappings. In particular, the addition of a single transcript may require re-quantification of many other related transcripts.</p><p>(2) Abundance estimates from RNA-Seq are relative and not absolute: Because RNA-Seq abundance estimates are relative, a change in the abundance estimate of a single transcript affects all other transcripts.</p><p>Given a change in the underlying transcripts, we show that abundance estimates can be updated by a procedure that only involves mapping reads to a small subset of the transcripts and re-computing assignment probabilities of multi-mapping reads for a similarly small set (<ref type="figure">Fig. 1</ref>). This is made possible by isolating a small relevant set of transcripts using a partitioning algorithm on a graph constructed from read alignments. When abundance estimation is subsequently performed using a fast online algorithm, the updating of estimates is particularly fast when the change to the underlying annotation is small. An implication of this result is that it is possible to easily update RNA-Seq abundance estimates for annotations that are continuously updated, as is the case with the nightly Reference Sequence (RefSeq) updates. RefSeq is a large database of sequences that includes widely used reference transcripts for *To whom correspondence should be addressed. ß The Author 2013. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com<ref type="figure">Fig. 1</ref>. Overview of the approach: Reads are initially aligned to a set of known transcript sequences and these alignments are used to probabilistically assign multi-mapping reads and to estimate abundances of the transcripts. The result is a set of relative abundances, for example, in fragments per kilobase per million mapped (FPKM) units. When a new annotation is given, differences are identified. Reads are mapped to any added transcripts, and the ambiguity graph, where vertices correspond to transcripts and edges correspond to pairs of transcripts to which reads have mapped ambiguously, is updated (deleted transcripts in red and added transcripts in blue). The 'affected' transcripts whose abundance must be re-computed are obtained from a partitioning in the graph. Finally, the subset of affected transcripts have their abundances re-computed using the relevant reads, and abundances for the transcriptome are re-computed many organisms. RefSeq is updated nightly to reflect improvements in annotations, and although the changes are small, we show that they can affect abundance estimates in RNA-Seq analyses. Our results demonstrate that it is possible, with our algorithm, to analyze an RNA-Seq dataset by building up the annotation one transcript at a time. In particular, our tool ReXpress allows scientists to routinely update abundance estimates for RNA-Seq analyses to reflect best possible results at any time. Although ReXpress is designed to work with formats produced by the eXpress RNA-Seq quantification tool, the program is general and suitable for use with many mapping and abundance estimation methods.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2">APPROACH AND RESULTS</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.1">The ambiguity graph</head><p>RNA-Seq quantification consists of estimating abundances for a fixed set of transcripts from sequenced reads, i.e. given a set of transcripts T , quantification is an estimate of abundances ^ ¼ f ^ t g t2T , where t ! 0 and P t2T t ¼ 1 from alignments of a set of fragments F to T. A widely used method for quantifying abundances is by statistical inference using the Expectation Maximization (EM) algorithm (<ref type="bibr" target="#b4">Li and Dewey, 2011;</ref><ref type="bibr" target="#b12">Roberts and Pachter, 2013;</ref><ref type="bibr" target="#b16">Trapnell et al., 2010</ref>). In these methods, the likelihood function for a generative model is maximized over the t values given F and T. To make the optimization tractable, a read aligner is used to remove unlikely alignments from consideration, thus providing, for each fragment f 2 F, a subset of likely transcripts the fragment is derived from. We denote the mapping by L F !T , where L F !T ð f Þ is the set of transcripts that fragment f 2 F is aligned to. The approximation based on these alignments introduces sparsity to the inference, and allows the likelihood function to be factorized. This factorization can then be used to reduce the computation necessary to update abundance estimates after re-annotation.</p><p>To algorithmically leverage the sparsity of alignments, we make use of an 'ambiguity graph'. In this graph, vertices represent transcripts, and two vertices are connected by an edge when there is at least one ambiguous fragment aligning to the two transcripts. The ambiguity graph is defined formally as follows: It is the undirected graph G ¼ ðT , EÞ, where E ¼ S f2F ffu, vgju, v 2 L F !T ð f Þ ^ u 6 ¼ vg. It is easy to show that each of the components of G define a factorization of the likelihood functions used in most RNA-Seq inference algorithms (<ref type="bibr" target="#b10">Pachter, 2011</ref>). Specifically, the set of transcripts in each component can be considered independently when assigning ambiguous fragments and computing abundances. An example of an ambiguity graph obtained for a dataset of 60 million reads (see Methods) is shown in Supplementary<ref type="figure">Figure S1</ref>and summarized in<ref type="figure" target="#fig_0">Figure 2</ref>. The graph is highly structured, and in what follows we show how this can be used to allow for rapid updates of abundance estimates upon re-annotation without extensive read mapping or numerical optimization to estimate abundances.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.2">Incremental adjustment of abundance estimates</head><p>We begin by describing the adjustments that are required to update an RNA-Seq analysis with respect to a re-annotation. An outline of the algorithm is provided in<ref type="figure">Figure 1</ref>. We will assume that there already exists an initial annotation, alignments, abundances and ambiguity graph. In our software implementation, we assume that the files are in eXpress format (<ref type="bibr" target="#b12">Roberts and Pachter, 2013</ref>), but eXpress itself does not have to be used to generate the output. Given an updated FASTA file containing a re-annotation, the newly added and deleted transcripts are detected. In some cases, re-annotation can involve simply renaming existing transcripts, and this case is checked for and ignored if detected (after names/ identifiers are correctly updated). A modified transcript can always be described in terms of a transcript deletion followed<ref type="bibr" target="#b16">Trapnell et al., 2010</ref>) using $30 million mapped 75 bp paired-end reads. The largest component (shown in Supplementary<ref type="figure">Fig. S1</ref>) exhibits substantial structure and the existence of many small clusters within it is the reason for the effectiveness of the partitioning algorithm we describe to reduce the complexity of the update algorithm by an addition. For each difference between annotations, the nature of the edit is recorded. The set of reads are then aligned to the added transcripts, and the ambiguity graph is updated with new nodes representing these transcripts and edges induced by the new alignments. The transcripts and alignments associated with independent components of the ambiguity graph containing added and deleted transcripts are extracted. The abundances for all transcripts in these components are then re-quantified separately using the updated annotation. Finally, the new annotation, alignments, abundances (for all transcripts) and ambiguity graph are output to be used with the next re-annotation update. Below is a more formal description that explains in detail the steps. Proofs of correctness follow trivially from the factorization of the standard likelihood function used in RNA-Seq, and are omitted. We require two fields from the output of an RNA-Seq quantification program after it has been used to estimate abundances for a set of transcripts T : the estimates ^ T and the 'ambiguity graph' (defined in Section 2.1) of T , which we denote by G ¼ ðT , EÞ. We assume that T 0 consists of T with the addition of a set of transcripts A and the deletion of a set of transcripts D so that T 0 ¼ ðT [ AÞnD. Finally, we will need the stored alignments from F to T , which we denote by L F !T ¼ ff ! ftjt 2 T and f aligns to tgg. To simplify the presentation, we explain separately the case of adding transcripts (T 0 ¼ T [ A) and the case of deletion (T 0 ¼ T n D). Additions and deletions can be handled in two stages or in a single, combined pass (details omitted). For simplicity, we restrict the exposition to the case of addition/deletion of a single transcript in the description below. Given a set of transcripts T , let t 0 be a transcript with t 0 = 2 T. The updating of estimates when t 0 is added to the annotation is performed as follows:</p><p>(1) Align the reads in F to t 0 and denote the subset of reads of F that align to t 0 by F 0 F. Denote the alignments of</p><formula>F 0 as L F !t 0 .</formula><p>(2) Extract the read alignments for the reads in F 0 from L F !T and denote as L F 0 !T ¼ f f ! L F !T ð fÞ for all f 2 F 0 g. In addition, denote by S ¼ S f2F 0 L F !T ð fÞ the set of transcripts in T that appear in L F 0 !T .(Deletion is performed via a similar procedure. Let t 0 be a transcript with t 0 2 T .</p><formula>(3) Create the updated ambiguity graph G 0 ¼ ðT [ t 0 , E [ fft 0 , vg for all v 2 SgÞ.</formula><p>(1) Let B be the component in G that contains t 0 .</p><p>(Note that in the rare case when there is a change in the total number of aligned fragments after the addition or deletion of a target, an additional step is required to renormalize the relative abundances between components. This step is trivial and fast, and the details are omitted.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.3">Improving performance by approximating the affected set</head><p>There is another issue that can hurt performance in practice: the affected component B can be large (<ref type="figure" target="#fig_0">Fig. 2</ref>and Supplementary<ref type="figure">Fig. S1</ref>). In typical RNA-Seq experiments, as much as one-fifth of all transcripts can lie in a single component of the ambiguity graph (<ref type="bibr" target="#b12">Roberts and Pachter, 2013</ref>). This component typically consists of large gene families and multiple isoform genes that share common sequence. To improve performance, it is therefore desirable to restrict the re-quantification to a smaller subset without sacrificing important information in the form of fragment alignments. We do this by partitioning a weighted generalization of the ambiguity graph, obtained by the addition of edge weights representing the number of ambiguous alignments between each pair of transcripts. For a given mapping L F !T and induced ambiguity graph G, we let the weight between two transcripts u, v be wðfu, vgÞ ¼ P f2F 1ðfu, vg L F !T ð f ÞÞ. Given these weights, we wish to partition around t 0 such that the total weight of edges crossing the partition cut is small compared with the weight of edges inside the block. Moreover, it is desirable that the block containing t 0 is small. Many sophisticated objective functions and algorithms exist for partitioning graphs (<ref type="bibr" target="#b1">Bichot and Siarry, 2011</ref>). A detailed exploration of the applications of these methods to our problem is outside the scope of this article. Instead, to demonstrate the feasibility of a partitioning scheme for improving the performance of our method with large components, we chose to use the greedy approach outlined below, which is motivated by the objective of removing edges that correspond to the 'least informative' alignments. First, we define the density of a block S, d(S), as the total weight of edges incident to a node in the block and a node outside of the block divided by the total weight of edges incident to the nodes in the block. Intuitively, this is the ratio of edges crossing the cut to all of the edges incident to nodes in the block. Formally,</p><formula>dðSÞ ¼ P u2S, v2 S wðu, vÞ P u2S, v2 S wðu, vÞ þ P u2S;v2S wðu, vÞ :</formula><p>Our objective is to find, for a given transcript t 0 , a block S that contains t such that d ðSÞ5 for a given threshold 05 1. We do so using the following greedy update.</p><p>(1) Begin with S ¼ ft 0 g.</p><p>(2) Iteratively add node u ¼ argmax u2T wðft 0 , ugÞ to S until dðSÞ5. It is easy to show that for any valid , this algorithm will terminate. As we show below in Section 2.4, the method is empirically both fast and accurate.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.4">Accuracy of partitioning approximation</head><p>To validate the performance of our greedy partitioning algorithm, we randomly selected with replacement 250 transcripts from the largest partition (3898 transcripts) in the RefSeq annotation and simulated their addition at some earlier date. We used the set of reads produced for (<ref type="bibr" target="#b16">Trapnell et al., 2010</ref>), which consisted of RNA-Seq performed on C212, a mouse moblast cell line. Each selected transcript was removed from the FASTA, alignment file and ambiguity graph, and was then re-added using a single step of our algorithm. We show the results of this update using 20 different values of in Supplementary<ref type="figure" target="#fig_0">Figure S2</ref>. There is a clear tradeoff between the accuracy of the approximation and the size of the resulting block selected by different values of. We note that for 50:1, the correlation is already reasonably close to the accuracy of the eXpress algorithm demonstrated in (<ref type="bibr" target="#b12">Roberts and Pachter, 2013</ref>).</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.5">Application to RefSeq incremental update</head><p>To demonstrate the effectiveness of our approach, we applied it to the same large C2C12 RNA-Seq dataset as used above. These data were first analyzed in 2010, but since then the mouse RefSeq annotation has been updated numerous times. Specifically, as a proof-of-concept, we applied ReXpress (our implementation of the methods above) to 34 days of the RefSeq incremental update (RIU), which is a daily update of the RefSeq annotation database (see Methods,<ref type="figure" target="#fig_2">Fig. 3a</ref>). Using 24 free cores, 644 min were required for the initial Bowtie2 alignment, 505 min for 20 repetitions of abundance estimation with eXpress and 11 min for building the ambiguity graph. Across the entire month of RefSeq updates, a size 3910 component was affected seven times, while components of size 15 or less were affected 37 times. Each subsequent update required, on average, 55 min to complete our re-annotation pipeline. This is compared with the $644 þ 505 ¼ 1149 min that would be required for alignment and abundance estimation from scratch with Bowtie2 and eXpress after each re-annotation. The abundance estimates for the final time point had a Spearman rank correlation of R 2 ¼ 0:994 with those calculated from scratch (Supplementary<ref type="figure" target="#fig_2">Fig. S3</ref>). The small discrepancy is due to the fact that the online EM method in eXpress approximates the maximum likelihood solution, and therefore is not expected to be exact. Because some of the transcripts added and deleted over the time period affected the large components in the ambiguity graph, we also ran the analysis using the greedy partitioning scheme described above ( ¼ 0:1). While the speed of the updates was greatly improved by the partitioning by reducing the size of the (approximate) affected components (<ref type="figure" target="#fig_2">Fig. 3b</ref>), the results were nearly identical (Supplementary<ref type="figure" target="#fig_1">Fig. S4</ref>).</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3">METHODS</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.1">Datasets</head><p>The annotations used for mouse were based on RefSeq. The RefSeq database is updated incrementally every night at 3:30 EST. All updates over the 34-day period between November 9 and December 13, 2012 were used for this analysis. The RNA-Seq data used was based on (<ref type="bibr" target="#b16">Trapnell et al., 2010</ref>). We restricted ourselves to analysis of the 60 hour time point, for which 60 million reads were available.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.2">Read mapping</head><p>Reads were mapped with Bowtie2 version 2.1.0 (<ref type="bibr" target="#b3">Langmead and Salzberg, 2012</ref>) using the parameters-k 1000, –rdg 6,5, –rfg 6,5, –score-min L,-0.6,-0.4, –no-discordant and –no-mixed. With these options, 47% of the reads were mapped concordantly.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.3">Abundance estimation</head><p>Abundances were estimated with eXpress version 1.3.0 (<ref type="bibr" target="#b12">Roberts and Pachter, 2013</ref>), initially using no optional parameters and then the –aux-param-file for re-estimation using previously computed auxiliary parameters after editing of the annotation. A forgetting factor of 0.85 (the default) was used for the full dataset and 0.75 used for the smaller update datasets.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.4">Software</head><p>The methods have been implemented in a software program called ReXpress. ReXpress is a Python script that takes as input an annotation and its update, reads, their alignments to the initial annotation, abundance estimates and the ambiguity graph. It outputs updated versions of all of the input (<ref type="figure">Fig. 1</ref>for exact files input and output). ReXpress makes heavy use of pySAM (pySAM, 2012;<ref type="bibr" target="#b5">Li et al., 2009</ref>) and is based on Bowtie2 and eXpress for quantification (<ref type="bibr" target="#b12">Roberts and Pachter, 2013</ref>), although many alignment and quantification tools can be substituted.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4">CONCLUSION</head><p>Despite the difficulties in storing, processing and distribution of high-throughput sequence data (<ref type="bibr" target="#b14">Sboner et al., 2011</ref>), repositories such as the Gene Expression Omnibus have led to an explosion in publicly available genome-wide expression data. However, numerous technical challenges that arise in re-using data have limited the utility of publicly archived RNA-Seq reads (<ref type="bibr" target="#b13">Rung and Brazma, 2013</ref>). Our results show that it is possible to efficiently update RNASeq abundance estimates on re-annotation, thus removing a major obstacle to re-using publicly available data. This should prove to be particularly useful in newly sequenced organisms whose annotations are not stable and undergo periodic revision, and also in human cancer transcriptomics where structural alterations can be tumor specific (<ref type="bibr" target="#b0">Asmann et al., 2012;</ref><ref type="bibr" target="#b19">Yorukoglu et al., 2012</ref>). We also believe that ReXpress will be particularly useful for sequencing centers providing analysis services. Instead of producing one-time output, it should now be possible to refresh analyses as annotations improve, without expensive hardware or compute time needed as user bases and datasets grow.</p><p>Other applications of our work include a randomized approach to optimization of transcriptome assembly in conjunction with abundance estimation (<ref type="bibr" target="#b7">Li and Jiang, 2012;</ref><ref type="bibr" target="#b4">Li et al., 2011;</ref><ref type="bibr" target="#b8">Mezlini et al., 2013</ref>), and the development of an RNA-Seq quantification database for publicly available datasets that is automatically updated as annotations improve. Moreover, our work on component identification in and partitioning of the ambiguity graph can be used to develop more efficient batch methods for abundance estimation. A recurring issue in the commonly used batch EM solutions (<ref type="bibr" target="#b4">Li and Dewey, 2011;</ref><ref type="bibr" target="#b16">Trapnell et al., 2010</ref>) is the necessity of iterating over a large number of reads, which has a memory bottleneck as shown in (<ref type="bibr" target="#b12">Roberts and Pachter, 2013</ref>).<ref type="bibr" target="#b16">Trapnell et al. (2010)</ref>attempts to avoid the bottleneck by treating all genomic loci as independent blocks and using a heuristic 'rescue method' to partially correct for the approximation. A better solution for the memory bottleneck in the batch method is to iterate over approximately independent partitions of the ambiguity graph whose associated reads can be fit into memory. Because most components are often small, only the largest will need to be partitioned as in our method above. The blocks can then be processed in parallel only a single machine or distributed over a cluster. Finally, in conjunction with the streaming algorithm for quantification in (<ref type="bibr" target="#b12">Roberts and Pachter, 2013</ref>), the present method</p><formula>(a)</formula><p>(b)provides an online algorithm in both the reads and the targets in any setting where probabilistic assignment of multi-mapping reads is a bottleneck in analysis of high-throughput sequencing data.</p></div><figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_0"><head>Fig.2.</head><figDesc>Fig. 2. The distribution of component sizes in the ambiguity graph for the 60 hour time point in (Trapnell et al., 2010) using $30 million mapped 75 bp paired-end reads. The largest component (shown in Supplementary Fig. S1) exhibits substantial structure and the existence of many small clusters within it is the reason for the effectiveness of the partitioning algorithm we describe to reduce the complexity of the update algorithm</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_1"><head>(4)</head><figDesc>Let B ¼ ft : f is in the same component as t 0 ; t 6 ¼ t 0 }. Extract the alignments in L F !T that consist of a read mapping to a transcript in B as L F !B ¼ ff ! L F !T ð f Þ for all f 2 FjL F !T ð f Þ Bg. (5) Merge the alignments to create L F !B[t 0 ¼ L F !B [ L F !t 0 .</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_2"><head>Fig.3.</head><figDesc>Fig. 3. (a) Updates to the mouse RefSeq transcriptome over the course of 34 days. Transcripts that kept the same name but changed sequence were treated as an addition and a deletion. (b) ReXpress run time, in minutes, on each RefSeq update, with and without partitioning. Initial run time consists of Bowtie2 alignment time (24 cores) and eXpress abundance estimation time (3 cores), without ReXpress. Partitioning was done when a changed transcript was part of a component larger than 300 transcripts, which occurred seven times over the 34-day period</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_1" validated="false"><figDesc>2) Extract the alignments from L F !T that contain reads mapping to transcripts in B, denoted by L F !B ¼ ff ! L F !T ð f Þ for all f 2 FjL F !T ð f Þ Bg.</figDesc><table>(3) Remove the alignments of reads to t 0 from L F !B as 
L F !Bnt 0 ¼ ff ! L F !B ð f Þnt 0 for all f 2 Fg. 

(4) Perform quantification on the set of transcripts Bnt 0 using 
the alignment file L F !Bnt 0 . This produces a set of estimates 
f ^ 
0 
t g t2Bnt 0 . 
(5) Compute ^ 
T 
B ¼ 
P 
t2B ^ 
T 
t . Set ^ 
T 0 
t ¼ ^ 
T 
B Â ^ 
0 
t for all t 2 Bnt 0 . 
(6) Create the updated ambiguity graph G 0 ¼ ðT nt 0 , Enfft 0 , vg 
for all v 2 BgÞ. 

</table></figure>

			<note place="foot">at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>

			<note place="foot">A.Roberts et al. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>

			<note place="foot">Updating RNA-Seq analyses after re-annotation at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>
		</body>
		<back>

			<div type="acknowledgement">
<div xmlns="http://www.tei-c.org/ns/1.0"><head>ACKNOWLEDGEMENTS</head><p>We thank Isabelle Stanton for her advice on graph partitioning. Funding: AR was partly funded by an NSF graduate fellowship. AR and LP were partially funded by NIH R01 HG006129.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Conflict</head><p>of Interest: none declared.</p></div>
			</div>

			<div type="references">

				<listBibl>

<biblStruct   xml:id="b0">
	<analytic>
		<title level="a" type="main">Detection of redundant fusion transcripts as biomarkers or disease-specific therapeutic targets in breast cancer</title>
		<author>
			<persName>
				<forename type="first">Y</forename>
				<forename type="middle">W</forename>
				<surname>Asmann</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Cancer Res</title>
		<imprint>
			<biblScope unit="volume">72</biblScope>
			<biblScope unit="page" from="1921" to="1928" />
			<date type="published" when="2012" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b1">
	<monogr>
		<title/>
		<author>
			<persName>
				<forename type="first">C</forename>
				<forename type="middle">E</forename>
				<surname>Bichot</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">P</forename>
				<surname>Siarry</surname>
			</persName>
		</author>
		<imprint>
			<date type="published" when="2011" />
			<publisher>Graph Partitioning. Wiley</publisher>
			<pubPlace>Hoboken, NJ, USA</pubPlace>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b2">
	<analytic>
		<title level="a" type="main">The developmental transcriptome of Drosophila melanogaster</title>
		<author>
			<persName>
				<forename type="first">B</forename>
				<forename type="middle">R</forename>
				<surname>Graveley</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nature</title>
		<imprint>
			<biblScope unit="volume">471</biblScope>
			<biblScope unit="page" from="473" to="479" />
			<date type="published" when="2010" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b3">
	<analytic>
		<title level="a" type="main">Fast gapped-read alignment with Bowtie2</title>
		<author>
			<persName>
				<forename type="first">B</forename>
				<surname>Langmead</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">S</forename>
				<forename type="middle">L</forename>
				<surname>Salzberg</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nat. Methods</title>
		<imprint>
			<biblScope unit="volume">9</biblScope>
			<biblScope unit="page" from="357" to="359" />
			<date type="published" when="2012" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b4">
	<analytic>
		<title level="a" type="main">RSEM: accurate transcript quantification from RNASeq data with or without a reference genome</title>
		<author>
			<persName>
				<forename type="first">B</forename>
				<surname>Li</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">C</forename>
				<surname>Dewey</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">BMC Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">12</biblScope>
			<biblScope unit="page">323</biblScope>
			<date type="published" when="2011" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b5">
	<analytic>
		<title level="a" type="main">The Sequence Alignment/Map format and SAMtools</title>
		<author>
			<persName>
				<forename type="first">H</forename>
				<surname>Li</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">25</biblScope>
			<biblScope unit="page" from="2078" to="2079" />
			<date type="published" when="2009" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b6">
	<analytic>
		<title level="a" type="main">IsoLasso: a LASSO regression approach to RNA-Seq based transcriptome assembly</title>
		<author>
			<persName>
				<forename type="first">W</forename>
				<surname>Li</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Comput. Biol</title>
		<imprint>
			<biblScope unit="volume">18</biblScope>
			<biblScope unit="page" from="1693" to="1707" />
			<date type="published" when="2011" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b7">
	<analytic>
		<title level="a" type="main">Transcriptome assembly and isoform expression level estimation from biased RNA-Seq reads</title>
		<author>
			<persName>
				<forename type="first">W</forename>
				<surname>Li</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">T</forename>
				<surname>Jiang</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">28</biblScope>
			<biblScope unit="page" from="2914" to="2921" />
			<date type="published" when="2012" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b8">
	<analytic>
		<title level="a" type="main">iReckon: simultaneous isoform discovery and abundance estimation from RNA-seq data</title>
		<author>
			<persName>
				<forename type="first">A</forename>
				<forename type="middle">M</forename>
				<surname>Mezlini</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Genome Res</title>
		<imprint>
			<biblScope unit="volume">23</biblScope>
			<biblScope unit="page" from="519" to="529" />
			<date type="published" when="2013" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b9">
	<analytic>
		<title level="a" type="main">The past, present and future of genome-wide re-annotation</title>
		<author>
			<persName>
				<forename type="first">C</forename>
				<forename type="middle">A</forename>
				<surname>Ouzouonis</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">P</forename>
				<forename type="middle">D</forename>
				<surname>Karp</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Genome Biol</title>
		<imprint>
			<biblScope unit="volume">3</biblScope>
			<biblScope unit="page" from="2001" to="2002" />
			<date type="published" when="2002" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b10">
	<monogr>
		<title level="m" type="main">Models for Transcript Quantification from RNA-Seq</title>
		<author>
			<persName>
				<forename type="first">L</forename>
				<surname>Pachter</surname>
			</persName>
		</author>
		<imprint>
			<date type="published" when="2011" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b11">
	<analytic>
		<title level="a" type="main">NCBI Reference Sequences (RefSeq): current status, new features and genome annotation policy</title>
		<author>
			<persName>
				<forename type="first">K</forename>
				<forename type="middle">D</forename>
				<surname>Pruitt</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nucleic Acids Res</title>
		<imprint>
			<biblScope unit="volume">40</biblScope>
			<biblScope unit="page" from="130" to="135" />
			<date type="published" when="2012-12" />
		</imprint>
	</monogr>
	<note>date. last accessed</note>
</biblStruct>

<biblStruct   xml:id="b12">
	<analytic>
		<title level="a" type="main">Streaming fragment assignment for real-time analysis of sequencing experiments</title>
		<author>
			<persName>
				<forename type="first">A</forename>
				<surname>Roberts</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">L</forename>
				<surname>Pachter</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nat. Methods</title>
		<imprint>
			<biblScope unit="volume">10</biblScope>
			<biblScope unit="page" from="71" to="73" />
			<date type="published" when="2013" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b13">
	<analytic>
		<title level="a" type="main">Reuse of public genome-wide gene expression data</title>
		<author>
			<persName>
				<forename type="first">J</forename>
				<surname>Rung</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">A</forename>
				<surname>Brazma</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nat. Rev. Genet</title>
		<imprint>
			<biblScope unit="volume">14</biblScope>
			<biblScope unit="page" from="89" to="99" />
			<date type="published" when="2013" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b14">
	<analytic>
		<title level="a" type="main">The real cost of sequencing: higher than you think</title>
		<author>
			<persName>
				<forename type="first">A</forename>
				<surname>Sboner</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Genome Biol</title>
		<imprint>
			<biblScope unit="volume">12</biblScope>
			<biblScope unit="page">125</biblScope>
			<date type="published" when="2011" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b15">
	<analytic>
		<title level="a" type="main">Oqtans: a Galaxy-integrated workflow for quantitative transcriptome analysis from NGS Data</title>
		<author>
			<persName>
				<forename type="first">S</forename>
				<forename type="middle">J</forename>
				<surname>Schultheiss</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">BMC Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">12</biblScope>
			<biblScope unit="page">7</biblScope>
			<date type="published" when="2011" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b16">
	<analytic>
		<title level="a" type="main">Transcript assembly and quantification by RNA-Seq reveals unannotated transcripts and isoform switching during cell differentiation</title>
		<author>
			<persName>
				<forename type="first">C</forename>
				<surname>Trapnell</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nat. Biotechnol</title>
		<imprint>
			<biblScope unit="volume">28</biblScope>
			<biblScope unit="page" from="511" to="515" />
			<date type="published" when="2010" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b17">
	<analytic>
		<title level="a" type="main">Differential gene and transcript expression analysis of RNA-seq experiments with TopHat and Cufflinks</title>
		<author>
			<persName>
				<forename type="first">C</forename>
				<surname>Trapnell</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nat. Protoc</title>
		<imprint>
			<biblScope unit="volume">7</biblScope>
			<biblScope unit="page" from="562" to="578" />
			<date type="published" when="2012" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b18">
	<analytic>
		<title level="a" type="main">Differential analysis of gene regulation at transcript resolution with RNA-seq</title>
		<author>
			<persName>
				<forename type="first">C</forename>
				<surname>Trapnell</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nat. Biotechnol</title>
		<imprint>
			<biblScope unit="volume">31</biblScope>
			<biblScope unit="page" from="46" to="53" />
			<date type="published" when="2013" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b19">
	<analytic>
		<title level="a" type="main">Dissect: detection and characterization of novel structural alterations in transcribed sequences</title>
		<author>
			<persName>
				<forename type="first">D</forename>
				<surname>Yorukoglu</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">28</biblScope>
			<biblScope unit="page" from="179" to="187" />
			<date type="published" when="2012" />
		</imprint>
	</monogr>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>