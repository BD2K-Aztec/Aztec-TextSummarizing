
<?xml version="1.0" encoding="UTF-8"?>
<TEI xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 /home/joey/Project/grobid/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<encodingDesc>
			<appInfo>
				<application version="0.4.2-SNAPSHOT" ident="GROBID" when="2017-08-10T23:31+0000">
					<ref target="https://github.com/kermitt2/grobid">GROBID - A machine learning software for extracting information from scholarly documents</ref>
				</application>
			</appInfo>
		</encodingDesc>
		<fileDesc>
			<titleStmt>
				<title level="a" type="main">Genome analysis WiggleTools: parallel processing of large collections of genome-wide datasets for visualization and statistical analysis</title>
			</titleStmt>
			<publicationStmt>
				<publisher/>
				<availability status="unknown"><licence/></availability>
				<date type="published" when="2014">7 2014</date>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author role="corresp">
							<persName>
								<forename type="first">Daniel</forename>
								<forename type="middle">R</forename>
								<surname>Zerbino</surname>
							</persName>
							<email>zerbino@ebi.ac.uk or flicek@ebi.ac.uk</email>
							<affiliation key="aff0">
								<orgName type="laboratory">European Molecular Biology Laboratory</orgName>
								<orgName type="institution" key="instit1">European Bioinformatics Institute (EMBL-EBI)</orgName>
								<orgName type="institution" key="instit2">Wellcome Trust Genome Campus</orgName>
								<address>
									<postCode>CB10 1SD</postCode>
									<settlement>Hinxton, Cambridge</settlement>
									<country key="GB">UK</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Nathan</forename>
								<surname>Johnson</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="laboratory">European Molecular Biology Laboratory</orgName>
								<orgName type="institution" key="instit1">European Bioinformatics Institute (EMBL-EBI)</orgName>
								<orgName type="institution" key="instit2">Wellcome Trust Genome Campus</orgName>
								<address>
									<postCode>CB10 1SD</postCode>
									<settlement>Hinxton, Cambridge</settlement>
									<country key="GB">UK</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Thomas</forename>
								<surname>Juettemann</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="laboratory">European Molecular Biology Laboratory</orgName>
								<orgName type="institution" key="instit1">European Bioinformatics Institute (EMBL-EBI)</orgName>
								<orgName type="institution" key="instit2">Wellcome Trust Genome Campus</orgName>
								<address>
									<postCode>CB10 1SD</postCode>
									<settlement>Hinxton, Cambridge</settlement>
									<country key="GB">UK</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Steven</forename>
								<forename type="middle">P</forename>
								<surname>Wilder</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="laboratory">European Molecular Biology Laboratory</orgName>
								<orgName type="institution" key="instit1">European Bioinformatics Institute (EMBL-EBI)</orgName>
								<orgName type="institution" key="instit2">Wellcome Trust Genome Campus</orgName>
								<address>
									<postCode>CB10 1SD</postCode>
									<settlement>Hinxton, Cambridge</settlement>
									<country key="GB">UK</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Paul</forename>
								<surname>Flicek</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="laboratory">European Molecular Biology Laboratory</orgName>
								<orgName type="institution" key="instit1">European Bioinformatics Institute (EMBL-EBI)</orgName>
								<orgName type="institution" key="instit2">Wellcome Trust Genome Campus</orgName>
								<address>
									<postCode>CB10 1SD</postCode>
									<settlement>Hinxton, Cambridge</settlement>
									<country key="GB">UK</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Alfonso</forename>
								<surname>Valencia</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="laboratory">European Molecular Biology Laboratory</orgName>
								<orgName type="institution" key="instit1">European Bioinformatics Institute (EMBL-EBI)</orgName>
								<orgName type="institution" key="instit2">Wellcome Trust Genome Campus</orgName>
								<address>
									<postCode>CB10 1SD</postCode>
									<settlement>Hinxton, Cambridge</settlement>
									<country key="GB">UK</country>
								</address>
							</affiliation>
						</author>
						<title level="a" type="main">Genome analysis WiggleTools: parallel processing of large collections of genome-wide datasets for visualization and statistical analysis</title>
					</analytic>
					<monogr>
						<imprint>
							<biblScope unit="volume">30</biblScope>
							<biblScope unit="page" from="1008" to="1009"/>
							<date type="published" when="2014">7 2014</date>
						</imprint>
					</monogr>
					<idno type="DOI">10.1093/bioinformatics/btt737</idno>
					<note type="submission">Received and revised on November 26, 2013; accepted on December 13, 2013</note>
					<note>Availability and Implementation: The code is freely available under Apache 2.0 license at www.github.com/Ensembl/Wiggletools Contact:</note>
				</biblStruct>
			</sourceDesc>
		</fileDesc>
		<profileDesc>
			<abstract>
				<p>Motivation: Using high-throughput sequencing, researchers are now generating hundreds of whole-genome assays to measure various features such as transcription factor binding, histone marks, DNA methylation or RNA transcription. Displaying so much data generally leads to a confusing accumulation of plots. We describe here a multi-threaded library that computes statistics on large numbers of datasets (Wiggle, BigWig, Bed, BigBed and BAM), generating statistical summaries within minutes with limited memory requirements, whether on the whole genome or on selected regions.</p>
			</abstract>
		</profileDesc>
	</teiHeader>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1">INTRODUCTION</head><p>With the advent of high-throughput sequencing, research teams and consortia are generating large numbers of datasets that are projected onto the same reference genome (<ref type="bibr" target="#b0">Adams et al., 2012;</ref><ref type="bibr" target="#b1">Bernstein et al., 2010;</ref><ref type="bibr" target="#b8">The ENCODE Project Consortium, 2012</ref>). In particular, epigenomic assays quantify many continuous variables across the genome, e.g. transcription factor binding, histone marks, DNA methylation, chromatin structure or RNA transcription. Although they differ in their protocols, all the above assays include a sequencing step that generates a huge number of sequencing reads. These reads, or tags, are then aligned against the human genome. This placement information is normally stored in the BAM file format (<ref type="bibr" target="#b4">Li et al., 2009</ref>). Because the BAM files are generally large and information rich, they are often summarized into BigWig files that describe a numerical variable such as read depth across the genome (<ref type="bibr" target="#b3">Kent et al., 2010</ref>). These BAM and BigWig files can then readily be displayed on most genome browsers (<ref type="bibr" target="#b2">Flicek et al., 2013;</ref><ref type="bibr" target="#b5">Meyer et al., 2013</ref>). In the current context, where researchers are testing many measurements across many samples, displaying all these data creates confusing graphics: either the plots are placed sideby-side and an observer is forced to continually shift their attention from one plot to another, or the plots are superimposed, blurring the information content.</p><p>Instead, one could summarize all these datasets for each position in the genome. Similarly, one could display the difference between case and control datasets. Fundamentally, all of these datasets are simply vectors of numbers, and statistics, such as mean, variance, median, etc., can be generated from any such collection, producing a meaningful summary of the data. Common statistical tools such as R (R Core<ref type="bibr" target="#b7">Team, 2013</ref>) do not scale well to such large datasets, especially with respect to memory requirements. Therefore, we developed a tool that can perform rigorous statistical tests across the whole genome and detect regions of interest without practical memory constraints. We drew inspiration from the popular BEDTools package (<ref type="bibr" target="#b6">Quinlan and Hall, 2010</ref>), which computes overlaps and derived statistics between sets of regions. Converting numerical measurements into genomic regions (generally referred to as peak calling or segmentation, depending on the context) is a convenient and common approach to handling genome-wide data. However, it does imply an inevitable loss of information, as continuous variables are discretized and often binarized. Therefore, we wanted a tool that natively reads the numerical data contained in genomic files and computes statistics on it.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2">FEATURES AND METHODS</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.1">Composable iterators</head><p>WiggleTools is centered on the use of iterators. This approach ensures scalability and reduces memory requirements: instead of loading entire files in memory, an iterator simply stores local information, allowing a program to simultaneously process dozens, even hundreds of files. This simultaneous handling of multiple files is particularly useful to compute statistics such as medians, which require storing all possible values before evaluation. The only exceptions to the use of iterators are the input/ output operations, which are run on separate threads that read/write, compress/decompress and parse/print data files independently. The basic iterators simply read the data from files, whether BAM, Wiggle, BigWig, Bed, BigBed or BedGraph. A range of iterators can be built on top of those. There are basic unary operators (multiplication by a constant scalar, absolute value, logarithm, exponential, exponentiation and filter), binary operators (sum, product, ratio and difference), statistics on sets (mean, median, standard deviation, variance, minimum, maximum) and statistics on pairs of sets (Welch's t test, Mann– Whitney U). In turn, all these iterators can be combined or *To whom correspondence should be addressed. ß The Author 2013. Published by Oxford University Press. This is an Open Access article distributed under the terms of the Creative Commons Attribution License (http://creativecommons.org/licenses/by/3.0/), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited. composed to create more complex operators. Iterators can either traverse the entire genome or a slice of the genome.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.2">Functionalities</head><p>The primary intent of the library is to compute statistics across a large number of datasets, so that the users need only display one curve on their genome browser instead of a multitude. For example, they can compress a collection of datasets into a median, as well as compare datasets (e.g. cases versus controls) and generate a track that denotes the differences between the two sets. In addition, the WiggleTools library can compute statistics across genomic positions for a single iterator (area under the curve, variance) or a pair of iterators (Pearson correlation). These statistics can be computed across the entire genome or on regions of interest. For example, it can compute the read coverage at known promoter regions. Similarly, WiggleTools can be used to compute a scaled summary profile of the data on a set of regions. The WiggleTools library can be used as a C library but also as a standalone command-line tool. The user has complete access to the richness of the framework using a simple Polish Notation language. For example, to generate the sum of a collection of BigWig files and write the result into a new Wiggle file, the command would look like: wiggletools write sum.wig sum data/*.bw</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.3">Performance</head><p>The WiggleTools library has been specifically designed to handle many files simultaneously, allowing complex statistics to be computed as directly as possible, with low memory requirements. The limiting factor of this approach is the I/O access to the files, meaning that it requires the input files to be in the local network of the computation CPUs. However, because of the efficient indexing of BigWig files, the output can be directly displayed on a remote server, such as a genome browser. It is trivial to accelerate computations by slicing the genome into regions and assigning each region to a different CPU. A wrapper script is available to do this automatically. However, one obstacle to this approach is merging the final files, as the tools provided in the original Kent library quickly become a performance bottleneck. Therefore, we developed modified functions that parallelize the computation of summary tables (which are crucial to accelerate display at large scales), which we contributed to the Kent library. To evaluate the performance of our tool, we downloaded all the DNAseI hypersensitivity wiggle tracks contained on the ENCODE January 2011 data freeze (The ENCODE<ref type="bibr" target="#b8">Project Consortium, 2012</ref>) and computed the sum of all these signals through three pipelines. We first ran the WiggleTools library in parallel on 116 sections of the genome (up to 30-Mbp long), producing as many output BigWig files that were merged with our new bigWigCat utility. Second, we ran WiggleTools but merged the output files with the default bigWigMerge utility (<ref type="bibr" target="#b3">Kent et al., 2010</ref>). Finally, we used bigWigMerge to directly sum the 126 BigWig files. The bigWigMerge tool only creates flat files; therefore, a compression and indexing stage, performed by the wigToBigWig tool, must also be done. The results in<ref type="figure">Table 1</ref>clearly show that the first pipeline, which took 1090s to run, is 12 and 19 times faster than the other approaches, while requiring a fraction of the memory.Note: Several pipelines are compared; hence some components appear multiple times.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>1009</head><p>WiggleTools</p></div><figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_0" validated="true"><figDesc>Table 1. Benchmarking CPU and memory requirements to compute the sum of 126 BigWig files (121 GB of data in total)</figDesc><table>Pipeline Stage 
CPUs Time/CPU (s) RAM/CPU (GB) 

1 
wiggletools 
116 
351 mean 
0.22 mean 
739 maximum 0.32 maximum 
bigWigCat 
1 
378 
5.23 
Overall 
116 
1090 
5.23 

2 
wiggletools 
116 
351 mean 
0.22 mean 
739 maximum 0.32 maximum 
bigWigMerge 1 
3441 
6.93 
wigToBigWig 1 
8887 
68.85 
Overall 
116 
13 067 
68.85 

3 
bigWigMerge 1 
11 036 
43.73 
wigToBigWig 1 
9423 
75.12 
Overall 
1 
20 459 
75.12 

</table></figure>

			<note place="foot">at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>
		</body>
		<back>

			<div type="acknowledgement">
<div xmlns="http://www.tei-c.org/ns/1.0"><head>ACKNOWLEDGEMENTS</head><p>The authors thank Jim Kent, Petr Danecek and John Marshall for their advice on using their respective libraries.</p></div>
			</div>

			<div type="references">

				<listBibl>

<biblStruct   xml:id="b0">
	<analytic>
		<title level="a" type="main">BLUEPRINT to decode the epigenetic signature written in blood</title>
		<author>
			<persName>
				<forename type="first">D</forename>
				<surname>Adams</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nat. Biotech</title>
		<imprint>
			<biblScope unit="volume">30</biblScope>
			<biblScope unit="page" from="224" to="226" />
			<date type="published" when="2012" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b1">
	<analytic>
		<title level="a" type="main">The NIH roadmap epigenomics mapping consortium</title>
		<author>
			<persName>
				<forename type="first">B</forename>
				<forename type="middle">E</forename>
				<surname>Bernstein</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nat. Biotech</title>
		<imprint>
			<biblScope unit="volume">28</biblScope>
			<biblScope unit="page" from="1045" to="1048" />
			<date type="published" when="2010" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b2">
	<analytic>
		<title/>
		<author>
			<persName>
				<forename type="first">P</forename>
				<surname>Flicek</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nucleic Acids Res</title>
		<imprint>
			<biblScope unit="volume">41</biblScope>
			<biblScope unit="page" from="48" to="55" />
			<date type="published" when="2013" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b3">
	<analytic>
		<title level="a" type="main">BigWig and BigBed: enabling browsing of large distributed datasets</title>
		<author>
			<persName>
				<forename type="first">W</forename>
				<forename type="middle">J</forename>
				<surname>Kent</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">26</biblScope>
			<biblScope unit="page" from="2204" to="2207" />
			<date type="published" when="2010" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b4">
	<analytic>
		<title level="a" type="main">The sequence alignment/map format and SAMtools</title>
		<author>
			<persName>
				<forename type="first">H</forename>
				<surname>Li</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">25</biblScope>
			<biblScope unit="page" from="2078" to="2079" />
			<date type="published" when="2009" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b5">
	<analytic>
		<title level="a" type="main">The UCSC genome browser database: extensions and updates 2013</title>
		<author>
			<persName>
				<forename type="first">L</forename>
				<forename type="middle">R</forename>
				<surname>Meyer</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nucleic Acids Res</title>
		<imprint>
			<biblScope unit="volume">41</biblScope>
			<biblScope unit="page" from="64" to="69" />
			<date type="published" when="2013" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b6">
	<analytic>
		<title level="a" type="main">BEDTools: a flexible suite of utilities for comparing genomic features</title>
		<author>
			<persName>
				<forename type="first">A</forename>
				<surname>Quinlan</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">I</forename>
				<surname>Hall</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">26</biblScope>
			<biblScope unit="page" from="841" to="842" />
			<date type="published" when="2010" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b7">
	<monogr>
		<title level="m" type="main">R: A Language and Environment for Statistical Computing. R Foundation for Statistical Computing</title>
		<author>
			<persName>
				<forename type="first">R</forename>
				<surname>Core Team</surname>
			</persName>
		</author>
		<imprint>
			<date type="published" when="2013" />
			<pubPlace>Vienna, Austria</pubPlace>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b8">
	<analytic>
		<title level="a" type="main">An integrated encyclopedia of DNA elements in the human genome</title>
		<author>
			<persName>
				<forename type="first">Encode</forename>
				<surname>The</surname>
			</persName>
		</author>
		<author>
			<persName>
				<surname>Consortium</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nature</title>
		<imprint>
			<biblScope unit="volume">489</biblScope>
			<biblScope unit="page" from="54" to="74" />
			<date type="published" when="2012" />
		</imprint>
	</monogr>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>