
<?xml version="1.0" encoding="UTF-8"?>
<TEI xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 /home/joey/Project/grobid/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<encodingDesc>
			<appInfo>
				<application version="0.4.2-SNAPSHOT" ident="GROBID" when="2017-08-10T23:42+0000">
					<ref target="https://github.com/kermitt2/grobid">GROBID - A machine learning software for extracting information from scholarly documents</ref>
				</application>
			</appInfo>
		</encodingDesc>
		<fileDesc>
			<titleStmt>
				<title level="a" type="main">Genetics and population analysis Exact coalescent simulation of new haplotype data from existing reference haplotypes</title>
			</titleStmt>
			<publicationStmt>
				<publisher/>
				<availability status="unknown"><licence/></availability>
				<date type="published" when="2012">2012</date>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author>
							<persName>
								<forename type="first">Joo</forename>
								<surname>Chul</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department" key="dep1">Department of Preventive Medicine</orgName>
								<orgName type="department" key="dep2">Keck School of Medicine</orgName>
								<orgName type="institution">University of Southern California</orgName>
								<address>
									<postCode>90089</postCode>
									<settlement>Los Angeles</settlement>
									<region>CA</region>
									<country key="US">USA</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<surname>Kang</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department" key="dep1">Department of Preventive Medicine</orgName>
								<orgName type="department" key="dep2">Keck School of Medicine</orgName>
								<orgName type="institution">University of Southern California</orgName>
								<address>
									<postCode>90089</postCode>
									<settlement>Los Angeles</settlement>
									<region>CA</region>
									<country key="US">USA</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Paul</forename>
								<surname>Marjoram</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department" key="dep1">Department of Preventive Medicine</orgName>
								<orgName type="department" key="dep2">Keck School of Medicine</orgName>
								<orgName type="institution">University of Southern California</orgName>
								<address>
									<postCode>90089</postCode>
									<settlement>Los Angeles</settlement>
									<region>CA</region>
									<country key="US">USA</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Alex</forename>
								<surname>Bateman</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department" key="dep1">Department of Preventive Medicine</orgName>
								<orgName type="department" key="dep2">Keck School of Medicine</orgName>
								<orgName type="institution">University of Southern California</orgName>
								<address>
									<postCode>90089</postCode>
									<settlement>Los Angeles</settlement>
									<region>CA</region>
									<country key="US">USA</country>
								</address>
							</affiliation>
						</author>
						<title level="a" type="main">Genetics and population analysis Exact coalescent simulation of new haplotype data from existing reference haplotypes</title>
					</analytic>
					<monogr>
						<title level="j" type="main">BIOINFORMATICS ORIGINAL PAPER</title>
						<imprint>
							<biblScope unit="volume">28</biblScope>
							<biblScope unit="issue">6</biblScope>
							<biblScope unit="page" from="838" to="844"/>
							<date type="published" when="2012">2012</date>
						</imprint>
					</monogr>
					<idno type="DOI">10.1093/bioinformatics/bts033</idno>
					<note type="submission">Received on June 17, 2011; revised on December 21, 2011; accepted on January 11, 2012</note>
					<note>Copyedited by: ES MANUSCRIPT CATEGORY: ORIGINAL PAPER [19:03 25/2/2012 Bioinformatics-bts033.tex] Page: 838 838–844 Associate Editor: Results: We demonstrate the performance of our method using a variety of data simulated under a coalescent model, before applying it to data from the 1000 Genomes project. Availability: The source code is freely available for download at ftp://popgen.usc.edu Contact: chulkang@usc.edu Supplementary information: Supplementary data are available at Bioinformatics online.</note>
				</biblStruct>
			</sourceDesc>
		</fileDesc>
		<profileDesc>
			<abstract>
				<p>Motivation: We introduce a coalescent-based method (RECOAL) for the simulation of new haplotype data from a reference population of haplotypes. A coalescent genealogy for the reference haplotype data is sampled from the appropriate posterior probability distribution, then a coalescent genealogy is simulated which extends the sampled genealogy to include new haplotype data. The new haplotype data will, therefore, contain both some of the existing polymorphic sites and new polymorphisms added based on the structure of the simulated coalescent genealogy. This allows exact coalescent simulation of new haplotype data, compared with other methods which are more approximate in nature.</p>
			</abstract>
		</profileDesc>
	</teiHeader>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1">INTRODUCTION</head><p>We live in an era in which the genome-wide association study (GWAS) is one of the standard tools by which we interrogate the genome for polymorphisms that relate to phenotype. There is also a growing use of next-generation sequence (NGS) data. A large number of new methodological approaches are being developed and published in both areas. There is much discussion about the degree to which the GWAS approach has been successful, for example, see<ref type="bibr" target="#b2">Eichler et al. (2010);</ref><ref type="bibr" target="#b4">Heard et al. (2010)</ref>;<ref type="bibr" target="#b15">Vineis and Pearce (2010)</ref>, but in humans many new associations between genotype and disease status have been discovered. An important part of the process of methods development in the GWAS era is the testing of those methods on both real and simulated test data. Frequently investigators have a single, smaller set of data from a given population, the features of which they wish to mimic when producing multiple, larger datasets for testing purposes. A common example is the HapMap data (<ref type="bibr">The International HapMap 3 Consortium, 2010</ref>) or 1000 Genome Project (1000GP) data (1000<ref type="bibr" target="#b0">Genomes Project Consortium, 2010</ref>). In this article, we present an * To whom correspondence should be addressed. exact coalescent method for simulating test sets of new haplotype (or genotype) data, based upon such an existing, smaller, initial sample. The goal is to sample new datasets, D , consisting of n (say) haplotypes, conditional upon some observed, existing data, D, which contains n o &lt;&lt; n haplotypes. Under the assumption that the popular coalescent model is a reasonable approximation to the evolution of the data, the goal here is to produce new data, D , conditional on the unobserved genealogy, G, of the existing data, D (since it is through G that the dependence of D on D is expressed). Note that in the presence of recombination G will be a graph, the so-called ancestral recombination graph (ARG), rather than a tree. The problem of sampling G conditional on D is computationally challenging, and for that reason several approximate methods have been proposed, the most relevant here being HAPGEN (<ref type="bibr" target="#b11">Spencer et al., 2009</ref>) and HAP-SAMPLE (<ref type="bibr" target="#b17">Wright et al., 2007</ref>), which are based-upon the PAC-likelihood method of (<ref type="bibr" target="#b8">Li and Stephens, 2003</ref>). The algorithm of Li and Stephens is an appealing way to reduce the computational burden involved in calculating probabilities under a full coalescent model. Instead, it uses an approximation scheme, based upon a model in which haplotypes are explained as mosaics of other existing haplotypes. This scheme is shown to (i) reduce computational burden significantly, and (ii) provide a good approximation to probabilities that would be obtained under the full coalescent model. However, it remains the case that one would prefer to sample from the exact coalescent model when such a thing is tractable. In this article, we present software that makes this practical for regions of length up to 500 kb, using as many as about n o = 100 reference haplotypes.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2">METHODS</head><p>Let D denote an existing sample of haplotype data, assumed to evolve under an unstructured, neutral coalescent model. The evolutionary parameters for this model, assuming the underlying population has effective size N e , are the per site mutation rate ( = 4N e μ), per site recombination rate (ρ = 4N e r) and exponential population growth rate g, where μ(r) is the mutation(recombination) rate per generation per site. We refer to these parameters collectively as. We simulate new haplotype data D from the conditional distribution P(D | D,,) using the coalescent model. This process can be written as</p><formula>P(D | D,,) = G G P(D | G ,D)P(G | G,,)P(G | D,,)</formula><p>where G is the (unobserved) ARG underlying D, and G is the new ARG that underpins the newly generated haplotypes (so G ⊂ G ).</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Coalescent simulation from reference haplotypes</head><p>Our method, RECOAL (REference haplotype simulation using a COALescent approach), proceeds in several steps, each of which we detail below. First we sample an unobserved G, underlying D. Then, using a coalescent prior, we generate a new G that contains G but adds n new tips, each of which will correspond to a new haplotype. The n o original haplotypes are then discarded. The general scheme of RECOAL is represented in<ref type="figure" target="#fig_0">Figure 1</ref>. Specifically, we proceed as follows.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.1">Sampling of coalescent genealogy for reference haplotypes</head><p>An ancestral recombination graph G for n 0 reference haplotypes is sampled from the conditional distribution P(G | D,,). We use the Metropolis-Hastings Markov chain Monte Carlo method of C.J.Kang and J.Felsenstein (submitted for publication) to sample graphs from this distribution.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.2">Simulation of coalescent genealogy for new haplotypes</head><p>After sampling G, we propose a larger ancestral recombination graph G , containing G and also including n new tips that will lead to the new data D. We let G * denote the newly simulated ancestry, so that G = G∪G * . G * is sampled using the usual coalescent prior, conditional on G and .</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.3">Simulation of data for new haplotypes</head><p>For each site, i, types for the new haplotype data at those sites, denoted by D i , are simulated conditional on the types at the same sites in the reference haplotypes, denoted by D i , as well as on G and the mutation rate. We let G i denote the genealogy (a tree in this case) defined by G at site i. We do this using the following procedure. First, the type of the node I a i , corresponding to the root of G i , is sampled from P(I a i | G i ,D i ). We then work our way from top-to-bottom (i.e. root-toleaf) through G i , generating the type of each internal node. Let b denote such an internal node and denote its type by I b i. We sample I b i from P(</p><formula>I b i | d b i ,I c i ,G i ,,</formula><p>), where I c i is the (already sampled) type of the parental (higher) node, c, directly connected to b, and d b i is the types of the subset of haplotypes that are descendants of node b. After sampling the types of the all internal nodes, the types for the new haplotype data are sampled. The type of a new haplotype d x i is sampled from P(</p><formula>d x i | I c i ,G i ,,)</formula><p>, where x is the tree tip representing this new haplotype and c is the internal node directly connected to x (and which has type I c i ). Note that RECOAL uses the finite sites model for mutations—allowing for multiple mutation events at each site. In particular, we used the Hasegawa-Kishino-Yano model (HKY85) (<ref type="bibr" target="#b3">Hasegawa et al., 1985</ref>) as the DNA substitution model.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.4">Ascertained SNPs</head><p>Many SNP datasets are collected using an ascertainment process in which some kind of bias is likely to be present. An example is the use of a so-called SNP-chip, in which SNPs are often selected to be included on the platform only if they are common. Another example is data from NGS technologies, in which, under a variety of calling schemes, the more copies of a mutant allele that are present, the easier the polymorphism is to call (See Supplementary Material for a full discussion.) This leads to an ascertainment bias in that rarer SNPs are preferentially missing from the reference haplotypes, and the number of polymorphisms is thereby decreased. Applying our algorithm without respecting this ascertainment bias would lead to incorrect performance. For example, we would tend to sample graphs that were shorter, on average, than is correct (since the method would be ignorant of the ascertainment process). Ascertainment is a difficult problem to deal with, but we present an ascertainment-corrected version of our algorithm that allows for ascertainment schemes in which the probability of detecting an SNP is dependent upon its frequency. We give theoretical details of the ascertainment correction in the Supplementary Material.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3">RESULTS</head><p>We demonstrate performance of the proposed method using both data simulated under the coalescent model and data drawn from the 1000 Genomes Project. We begin with examples using simulated data.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.1">Coalescent data</head><p>We used Hudson's coalescent-based simulation program (called ms) (<ref type="bibr" target="#b5">Hudson, 2002</ref>) to simulate 1040 haplotypes for a given parameter combination. We then randomly selected 40 haplotypes from those 1040 haplotypes. Using the selected 40 samples as the reference haplotypes, referred to as H ref , we applied our method to simulate 1000 new haplotypes using the same. We refer to these as H new. We then compare properties of H new to the 1000 unsampled haplotypes in the initial coalescent data (referred to as H coal ).<ref type="figure" target="#fig_1">Figure 2</ref>plots the the MAF of each polymorphic locus in H coal against the frequency of the same locus in H ref. We then make the same comparison between H new and H ref. The correlation between MAFs is r 2 = 0.905 in the former case and r 2 = 0.903 in the latter, indicating very similar behavior in the actual and generated 1000 haplotypes. We show aggregate results from 100 replicate analyses. In Table 1, we present the results of applying our algorithm to data generated under a range of different mutation rates, and no recombination, across 100 replicates. We show the average number of SNPs over a 10 kb region in H ref , H coal and H new. We also show the results of applying Watterson's estimate of the mutation rate to each dataset (<ref type="bibr" target="#b16">Watterson, 1975</ref>). This shows that the ability of RECOAL to both reproduce SNPs in the reference haplotypes, as well as add new SNPs, leads to a good agreement between the overall polymorphism level in H new and H coal. Tables 2 presents the results of similar analyses, but with recombination included, fora number of different region lengths. In all cases, we see an excellent agreement between the degree of polymorphism in H new and H coal. In<ref type="figure" target="#fig_2">Figure 3</ref>, we compare the MAF distribution at polymorphic loci in H coal and H new across 100 datasets. We show this for a variety of population growth rates. We see a good agreement between the MAF spectrum patterns simulated by ms and by RECOAL.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.1.1">SNP frequency and allele frequency spectrum</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.1.2">Pattern of linkage disequilibrium</head><p>As well as preserving the distribution of the number of polymorphic loci and their MAFs,Here = 0.001 and ρ = 0.0005.it is also important to preserve patterns of linkage disequilibrium (LD). In<ref type="figure" target="#fig_3">Figure 4</ref>, we show the pairwise r 2 values between adjacent markers in H ref , H coal and H new across 100 replicate analyses in which data were simulated over a 10 kb region with = 0.001, ρ = 0.0005. In<ref type="figure" target="#fig_3">Figure 4A</ref>, the comparison is between each adjacent pair of markers in H ref and the same pair of markers in H coal , and in<ref type="figure" target="#fig_3">Figure 4B</ref>the comparison is between pairs in H ref and H new. Again, we see a good agreement between the figures. RECOAL reproduces the LD values from the reference haplotypes with similar variation(an r 2 of 0.93 compared with r 2 = 0.95 for the actual coalescent data), suggesting that data produced by RECOAL are good proxies for the unobserved data in this context. Next, to illustrate the behavior in a single dataset,<ref type="figure" target="#fig_4">Figure 5</ref>shows an example of LD patterns, plotted by Haploview (<ref type="bibr" target="#b1">Barrett et al., 2005</ref>), for data simulated with ms using an overall recombination rate of ρ = 0.0005 but with the presence of a single hotspot in the middle at which the rate of recombination is 100 × greater than in the rest of the region. The LD patterns are well preserved.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>0.002</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.1.3">Application to ascertained SNPs</head><p>We now give an example of applying RECOAL to ascertained data. Here, we simulate a situation in which the probability of an SNP being reported as polymorphic is a function of the frequency of the mutant allele in the sample at that position, such as might be appropriate for datafrom NGS. We denote the number of SNPs present in H new that were also observed in H ref by S O. S H denotes new SNPs present in H new that will also be present in H ref —these are the SNPs added to reflect the ascertainment scheme (Supplementary Material). Finally, S N denotes SNPs which are present in H new as the result of new mutation in G * and which are non-polymorphic in H ref .<ref type="figure" target="#tab_3">Table 3</ref>shows the number of SNPs in the newly simulated haplotypes from the reference haplotypes ascertained with the different SNP calling threshold λ, in each of these categories, both with and without the ascertainment correction scheme. Without application of the ascertainment correction, the new haplotypes have fewer SNPs than they should. (The results for λ = 0 give the correct null behavior, since there the ascertainment has no effect.) When ascertainment correction is used, the new haplotypes have a number of SNPs that is close to the correct value, although we see a slight tendency to introduce too many new SNPs as λ increases.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.2">Comparison with other methods</head><p>Next, we compare RECOAL to another haplotype simulation method that creates new haplotype data by resampling existing reference haplotypes. There are two such methods: HAPGEN (<ref type="bibr" target="#b11">Spencer et al., 2009</ref>) and HAP-SAMPLE, (<ref type="bibr" target="#b17">Wright et al., 2007</ref>). Both these methods simulate new haplotypes using schemes based upon Li and Stephen's elegant PAC likelihood algorithm (<ref type="bibr" target="#b8">Li and Stephens, 2003</ref>). Both methods also perform well in terms of reproducing the pattern of LD in the region considered (results not shown). However, the models do differ in how they treat the mutation process. There is no mechanism for introducing new polymorphic sites in HAP-SAMPLE. As such, HAP-SAMPLE will necessarily under-represent the degree of polymorphism in the newly generatedhaplotypes. For this reason, we focus our comparison on HAPGEN, which introduces new mutations using a mutation rate that decreases as each new haplotype is produced (reflecting the intuition that as more haplotypes are sampled, the probability of detecting new polymorphism will decrease). As before, we examine the number of SNPs that are observed on the haplotypes generated by each algorithm. We show results for a range of sizes for H ref .<ref type="figure" target="#fig_6">Figure 6</ref>shows the relationship between the number of SNPs in H ref and the number of SNPs in H new , using both methods. For reference, we also include a comparison between H ref and H coal in the initial data, which were simulated using ms, with = 0.001. We show results across 50 replicates. As a summary, we fit a regression line in each case. We see a good agreement between H coal and H new when using RECOAL, and a good agreement between the regression line for results from RECOAL and those from ms. The agreement is also quite good when using HAPGEN, but there appears to be a systematic tendency to add slightly too few SNPs when using HAPGEN. Tables 4 and 5 show the number of SNPs simulated by HAPGEN and RECOAL for a variety of sizes of H ref. While the 95% confidence interval for RECOAL includes the mean number of SNPs in the simulated population data in each case, and appears to show no systematic dependency upon the size of H ref , we observe that the average number of SNPs in haplotypes simulated by HAPGEN appears to be dependent on the size of both H ref and H new. In defense of the latter algorithm, we recall that it is an approximation designed to improve computational tractability, thereby allowing application of such a resampling scheme in a range of contexts that is broader than is permissible using our own method. Our point in this article is to present an exact coalescent method that can be used when the region of interest is reasonably small (less than ∼500 kb).</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.3">Simulation with 1000 Genome Project data</head><p>We close by showing an example application of RECOAL aimed at simulating new haplotypes from the low-coverageForty reference haplotypes were used. For comparison, we also show results obtained when using ms to simulate a population of the same size in each case (MS).1000GP data. We simulated 1000 haplotypes for a 500 kb region (21–21.5 MB) of Chromosome 21 using haplotypes constructed from the 4× coverage 1000GP CEU data. Since the data are low coverage, some SNPs are not called. The rate at which this occurs (i.e. the ascertainment bias), is reported as a function of allele frequency (in the sample) in (1000 Genomes Project Consortium, 2010) (<ref type="figure" target="#fig_1">Fig. 2</ref>). When applying RECOAL, we used fine-scale recombination rates estimated by the HapMap consortium (<ref type="bibr">The International HapMap 3 Consortium, 2010</ref>). for that region is ∼0.001 per site (<ref type="bibr" target="#b6">Kang and Marjoram, 2011</ref>). We summarize the simulation results in<ref type="figure" target="#tab_6">Table 6</ref>. Again, we report SNPs in three classes: S O , SNPs which are also observed in the reference haplotypes; S N , SNPs which appear only on the simulated haplotypes; and S H , SNPs present in H new that will also be present, but were not observed due to ascertainment, in H ref. We see that the ascertainment correction adds 98.4 SNPs on average to correct for the estimated ascertainment probabilities.We also show an example of the LD pattern observed in H new and H ref in<ref type="figure" target="#fig_9">Figure 7</ref>. The pattern of LD of the simulated haplotypes shows high agreement.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Coalescent simulation from reference haplotypes</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4">DISCUSSION</head><p>In this article, we introduce an exact coalescent method for the simulation of new haplotype data from an existing set of reference haplotypes. Our method, RECOAL, simulates data from the distribution P(D | D,,) using the full coalescent model rather than using an approximation to that model. In addition to the replication of SNPs present in the reference haplotypes, RECOAL also simulates new SNPs using a coalescent prior. It preserves LD structure well, and we demonstrate that new polymorphism is added at an appropriate level. Because of its exact nature, RECOAL is less computationally tractable than the approximation underpinning HAPGEN, but it is produces data under the full coalescent model rather than the approximation to the coalescent model exploited by HAPGEN. As such, we argue that it is appropriate to use RECOAL when computational considerations permit. Nonetheless, we believe HAPGEN remains an excellent alternative approach. It should be noted that Step 1 of our approach is based on an MCMC method. As such the user must allow the MCMC chain to converge to the stationary distribution of P(G | D,,). The time taken to reach convergence increases with both overall recombination rate and number of reference haplotypes. Thus, the combination of recombination rate and the number of reference haplotypes determine the limits of computational tractability of RECOAL. As an example, the simulation used in this article, which includes 40 reference haplotypes over a 100 kb region with human population parameters, takes ∼4 h to simulate 1000 new haplotypes on a typical desktop machine. As such, RECOAL is intractable for simulation of regions larger than ∼500 kb. However, in the context of followup of a GWAS, for example, in which the area being investigated may be quite short, our software allows for the exact coalescent simulation of new haplotypes conditional on the existing data, under the coalescent model, rather than using a more approximate method. When larger regions are desired, or much larger reference samples exist, we recommend the approximate method HAPGEN still be used. Of course, our method is model-based and, as such, is exact in the sense that it samples from exactly the correct distributions conditional on that model. This, then, is a good time to remind the reader of a quote attributed to George Box: 'All models are wrong; some are useful'. The coalescent has proven itself to be widely useful, but it is still, of course, 'wrong'. One example of its 'wrong-ness' in the present context is that we use a neutral model of molecular evolution, ignoring natural selection. There is a literature about the coalescent with selection included (<ref type="bibr" target="#b7">Kaplan et al., 1988;</ref><ref type="bibr" target="#b9">Neuhauser and Krone, 1997</ref>), and some programs (<ref type="bibr" target="#b10">Spencer and Coop, 2004;</ref><ref type="bibr" target="#b13">Teshima and Innan, 2009</ref>) can simulate data with the presence of the selective mutation. But those models are not tractable when one wishes to condition upon the existing data, so, like most other coalescent simulators, RECOAL simulates data under neutrality. Another area in which our model is wrong is that it is based upon an unstructured coalescent. In other words, we assume random mating. While this has proven to be a robust approximation to the behavior of single populations, it has proven necessary to introduce extensions to the coalescent when population structure is present. As such we would recommend caution when applying our method to datasets in which multiple populations are present, or selection is expected to have occurred. In the former context, for example, it might be more appropriate to produce new haplotypes for each subpopulation separately, by dividing the data into its subpopulations and applying RECOAL to each subpopulation in turn. The existing version of RECOAL allows for fine-scale variation of recombination rates and for exponential growth of population size. Extensions to other more complex demographic scenarios such as bottlenecks and population admixture are also possible, and are currently under development. Finally, we also presented an extension of our method to ascertained data in which the probability of ascertainment is a function of allele frequency. Admixture is an extremely challenging problem in coalescent methods and we note in passing that our correction illustrates how sampling of an underlying coalescent genealogy, condition upon observed polymorphism data, can be adapted to respect such an ascertainment scheme. Funding: National Institutes of Health (MH084678) and National Science Foundation (HG005927), as well as improvements due to comments received from the reviewers.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Conflict of Interest: none declared.</head></div><figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_0"><head>Fig.1.</head><figDesc>Fig. 1. The simulated coalescent genealogy G for one site. The solid line represents the sampled coalescent genealogy (G) for the reference haplotypes. (For simplicity sake, we illustrate this as a tree, but it will in general be a graph.) The dotted line represents the newly simulated component G * , which shows the ancestry of the new haplotypes (indicated in italics). G is the union of G and G * .</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_1"><head>Fig.2.</head><figDesc>Fig. 2. Comparison of minor allele frequencies (MAFs) between H coal and H ref (A) and between H new and H ref (B).</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_2"><head>Fig.3.</head><figDesc>Fig. 3. The MAF spectrum for datasets simulated by ms (A) and RECOAL (B) with different growth rates.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_3"><head>Fig.4.</head><figDesc>Fig. 4. Changes of pair-wise r 2 values between pairs of adjacent loci in H ref and H coal (A) and in H ref and H new (B).</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_4"><head>Fig.5.</head><figDesc>Fig. 5. LD patterns in a single, representative example dataset for H coal (top), H ref (middle) and H new (bottom).</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_6"><head>Fig.6.</head><figDesc>Fig. 6. The relationship between the number of SNPs in the reference haplotypes (x-axis) and the number of SNPs in simulated haplotypes (y-axis). We simulated 1000 haplotypes from 40 reference haplotypes with RECOAL (cross) and HAPGEN (filled triangle) using = 0.001. For comparison, we plot the number of SNPs in the reference and original populations (y-axis) in the initial data [simulated by ms (circle)]. We also drew linear regression lines (RL) for three cases.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_7"><head>For</head><figDesc>sake of comparison, an average of 72.07 SNPs (69.54–74.88) were simulated by ms when generating 1000 haplotypes with the same parameter values.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_8"><head></head><figDesc>Copyedited by: ES MANUSCRIPT CATEGORY: ORIGINAL PAPER [19:03 25/2/2012 Bioinformatics-bts033.tex] Page: 843 838–844</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_9"><head>Fig.7.</head><figDesc>Fig. 7. The LD patterns of the 1000 Genome Project reference haplotypes (top) and of new haplotypes simulated by RECOAL (bottom).</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_1" validated="true"><figDesc>Table 1. The average number of SNPs (with 95% confidence interval), and Watterson's estimate of mutation rate ( ˆ ), for H coal , H ref and H new</figDesc><table>10 −4 
10 −3 
10 −2 

SNPs 
7.51 
73.34 
737.6 
H coal 
(6.97–8.06) 
(70.69–76.07) 
(706.5–770.4) 
ˆ 

1.003×10 −4 
0.9799×10 −3 
0.9856×10 −2 

SNPs 
4.25 
39.87 
419.4 
H ref 
(3.80–4.71) 
(37.55–42.26) 
(390.1–452.2) 
ˆ 

0.9992×10 −4 
0.9373×10 −3 
0.9861×10 −2 

SNPs 
7.78 
74.40 
733.4 
H new 
(7.18–8.38) 
(72.01–76.88) 
(703.7–764.2) 
ˆ 

1.039×10 −4 
0.9941×10 −3 
0.9799×10 −2 

</table></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_2" validated="true"><figDesc>Table 2. The average number of SNPs (with 95% confidence interval) and Watterson's estimate of mutation rate ( ˆ ), for H coal , H ref and H new</figDesc><table>Region 
10 kb 
50 kb 
100 kb 
size 

SNPs 
74.13 
374.7 
783.6 
H coal 
(71.26–77.17) 
(357.8–392.7) 
(739.0–832.1) 
ˆ 

0.9177×10 −3 
1.001.×10 −3 
1.047×10 −3 

SNPs 
39.87 
214.8 
456.2 
H ref 
(37.55–42.26) 
(199.4–231.8) 
(412.6–503.2) 
ˆ 

0.9373×10 −3 
1.010×10 −3 
1.073×10 −3 

SNPs 
74.40 
385.8 
787.8 
H new 
(72.01–76.88) 
(368.1–405.1) 
(71.14–76.72) 
ˆ 

0.9941×10 −3 
1.031×10 −3 
1.053×10 −3 

</table></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_3" validated="true"><figDesc>Table 3. The number of observed SNPs in H ref and H new without ascertainment correction (no asc.) and with ascertainment correction (asc)</figDesc><table>λ 
0 
0.1 
0.2 
H ref 
41.16 
23.20 
16.96 
(37.42–45.28) 
(19.68–27.24) 
(13.44–21.00) 

S O 
40.70 
23.20 
16.96 
(36.75–44.65) 
(19.68–27.24) 
(13.44–21.00) 
no asc 
S H 
0 
0 
0 
(0–0) 
(0–0) 
(0–0) 
S N 
35.42 
40.66 
45.08 
(33.51–37.33) 
(37.86–43.74) 
(41.84–48.32) 
H new 
76.12 
63.86 
61.04 
(72.20–80.26) 
(59.54–68.68) 
(56.87–66.42) 

S O 
40.70 
23.20 
16.96 
(36.75–44.65) 
(19.68–27.24) 
(13.44–21.00) 
S H 
0 
17.92 
24.76 
(0–0) 
(15.84–20.00) 
(22.22–27.30) 
asc 
S O +S H 
40.70 
41.12 
41.72 
(36.75–44.65) 
(37.01–45.31) 
(37.48–46.32) 
S N 
35.42 
36.60 
37.16 
(33.51–37.33) 
(34.44–38.76) 
(35.38–39.02) 
H new 
76.12 
77.72 
78.88 
(72.20–80.26) 
(73.41–82.61) 
(73.98–84.20) 

The 95% confidence intervals are also shown. We simulated 100 replicates of 1000 
new haplotypes over a 10 kb region with = 0.001 and ρ = 0.0005 using 40 reference 
haplotypes. 

</table></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_4" validated="true"><figDesc>Table 4. The average number of SNPs (with 95% confidence interval) when simulating 1000 haplotypes using RECOAL (RC) and HAPGEN (HG) from reference haplotype sets of differing sizes</figDesc><table>Ref. size 
10 
40 
100 
H ref 
29.75 
41.83 
51.55 
(26.00–34.08) 
(37.30–46.70) 
(47.20–56.40) 

RC 
72.98 
73.05 
69.88 
(68.72–77.53) 
(67.20–78.90) 
(65.10–75.15) 
HG 
56.15 
61.68 
78.53 
(52.18–60.58) 
(57.02–66.58) 
(74.00–83.67) 

</table></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_5" validated="false"><figDesc>Table 5.</figDesc><table>The average number of SNPs (with 95% confidence interval) when 
simulating datasets of new haplotypes of differing sizes using RECOAL (RC) 
and HAPGEN (HG) 

Sample 100 
500 
1000 
5000 
size 

MS 
50.45 
66.55 
72.07 
93.3 
(46.75–54.30) (62.25–70.92) (69.54–74.88) (88.60–98.05) 
RC 
53.75 
64.45 
72.43 
92.23 
(48.83–58.70) (60.23–68.92) (66.54–73.31) (87.67–97.22) 
HG 
51.43 
58.85 
61.68 
72.65 
(46.58–57.90) (53.75–62.12) (57.02–66.58) (67.60–78.88) 

</table></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_6" validated="false"><figDesc>Table 6. The number of SNPs and mean MAFs of those SNPs in data simulated using reference haplotypes drawn from 1000GP</figDesc><table>Total 
S O 
S H 
S N 

1000 GP 
SNPs 
3536.5 
1669.78 
98.36 
1767.98 
MAF 
0.055 
0.106 
0.033 
0.009 

</table></figure>

			<note place="foot">© The Author 2012. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oup.com at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>

			<note place="foot">at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>
		</body>
		<back>
			<div type="references">

				<listBibl>

<biblStruct   xml:id="b0">
	<analytic>
		<title level="a" type="main">A map of human genome variation from population-scale sequencing</title>
		<author>
			<persName>
				<forename type="first">Consortium</forename>
				<surname>Genomes Project</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nature</title>
		<imprint>
			<biblScope unit="volume">467</biblScope>
			<biblScope unit="page" from="1061" to="1073" />
			<date type="published" when="2010" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b1">
	<analytic>
		<title level="a" type="main">Haploview: analysis and visualization of ld and haplotype maps</title>
		<author>
			<persName>
				<forename type="first">J</forename>
				<forename type="middle">C</forename>
				<surname>Barrett</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">21</biblScope>
			<biblScope unit="page" from="263" to="265" />
			<date type="published" when="2005" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b2">
	<analytic>
		<title level="a" type="main">Missing heritability and strategies for finding the underlying causes of complex disease</title>
		<author>
			<persName>
				<forename type="first">E</forename>
				<forename type="middle">E</forename>
				<surname>Eichler</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nat. Rev. Genet</title>
		<imprint>
			<biblScope unit="volume">11</biblScope>
			<biblScope unit="page" from="446" to="450" />
			<date type="published" when="2010" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b3">
	<analytic>
		<title level="a" type="main">Dating of the human-ape splitting by a molecular clock of mitochondrial dna</title>
		<author>
			<persName>
				<forename type="first">M</forename>
				<surname>Hasegawa</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Mol. Evol</title>
		<imprint>
			<biblScope unit="volume">22</biblScope>
			<biblScope unit="page" from="160" to="174" />
			<date type="published" when="1985" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b4">
	<analytic>
		<title level="a" type="main">Ten years of genetics and genomics: what have we achieved and where are we heading?</title>
		<author>
			<persName>
				<forename type="first">E</forename>
				<surname>Heard</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nat. Rev. Genet</title>
		<imprint>
			<biblScope unit="volume">11</biblScope>
			<biblScope unit="page" from="723" to="733" />
			<date type="published" when="2010" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b5">
	<analytic>
		<title level="a" type="main">Generating samples under a Wright-Fisher neutral model</title>
		<author>
			<persName>
				<forename type="first">R</forename>
				<surname>Hudson</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">18</biblScope>
			<biblScope unit="page" from="337" to="338" />
			<date type="published" when="2002" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b6">
	<analytic>
		<title level="a" type="main">Inference of population mutation rate and detection of segregating sites from next-generation sequence data</title>
		<author>
			<persName>
				<forename type="first">C</forename>
				<forename type="middle">J</forename>
				<surname>Kang</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">P</forename>
				<surname>Marjoram</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Genetics</title>
		<imprint>
			<biblScope unit="volume">189</biblScope>
			<biblScope unit="page" from="595" to="605" />
			<date type="published" when="2011" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b7">
	<analytic>
		<title level="a" type="main">The coalescent process in models with selection</title>
		<author>
			<persName>
				<forename type="first">N</forename>
				<forename type="middle">L</forename>
				<surname>Kaplan</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Genetics</title>
		<imprint>
			<biblScope unit="volume">120</biblScope>
			<biblScope unit="page" from="819" to="829" />
			<date type="published" when="1988" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b8">
	<analytic>
		<title level="a" type="main">Modelling linkage disequilibrium, and identifying recombination hotspots using SNP data</title>
		<author>
			<persName>
				<forename type="first">N</forename>
				<surname>Li</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">M</forename>
				<surname>Stephens</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Genetics</title>
		<imprint>
			<biblScope unit="volume">165</biblScope>
			<biblScope unit="page" from="2213" to="2233" />
			<date type="published" when="2003" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b9">
	<analytic>
		<title level="a" type="main">The genealogy of samples in models with selection</title>
		<author>
			<persName>
				<forename type="first">C</forename>
				<surname>Neuhauser</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">S</forename>
				<forename type="middle">M</forename>
				<surname>Krone</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Genetics</title>
		<imprint>
			<biblScope unit="volume">145</biblScope>
			<biblScope unit="page" from="519" to="534" />
			<date type="published" when="1997" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b10">
	<analytic>
		<title level="a" type="main">Selsim: a program to simulate population genetic data with natural selection and recombination</title>
		<author>
			<persName>
				<forename type="first">C</forename>
				<forename type="middle">C A</forename>
				<surname>Spencer</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">G</forename>
				<surname>Coop</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">20</biblScope>
			<biblScope unit="page" from="3673" to="3675" />
			<date type="published" when="2004" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b11">
	<analytic>
		<title level="a" type="main">Designing genome-wide association studies: sample size, power, imputation, and the choice of genotyping chip</title>
		<author>
			<persName>
				<forename type="first">C</forename>
				<forename type="middle">C A</forename>
				<surname>Spencer</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">PLoS Genet</title>
		<imprint>
			<biblScope unit="volume">5</biblScope>
			<biblScope unit="page">1000477</biblScope>
			<date type="published" when="2009" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b12">
	<analytic>
		<title/>
	</analytic>
	<monogr>
		<title level="m">Bioinformatics-bts033.tex] Page</title>
		<imprint>
			<date type="published" when="2012" />
			<biblScope unit="page" from="3" to="25" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b13">
	<analytic>
		<title level="a" type="main">mbs: modifying hudson&apos;s ms software to generate samples of dna sequences with a biallelic site under selection</title>
		<author>
			<persName>
				<forename type="first">J</forename>
				<surname>Kang</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">P</forename>
				<surname>Marjoram Teshima</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">K</forename>
				<surname>Innan</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">H</forename>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">BMC Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">10</biblScope>
			<biblScope unit="page">166</biblScope>
			<date type="published" when="2009" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b14">
	<analytic>
		<title level="a" type="main">Integrating common and rare genetic variation in diverse human populations</title>
	</analytic>
	<monogr>
		<title level="m">The International HapMap 3 Consortium</title>
		<imprint>
			<date type="published" when="2010" />
			<biblScope unit="page" from="52" to="58" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b15">
	<analytic>
		<title level="a" type="main">Missing heritability in genome-wide association study research</title>
		<author>
			<persName>
				<forename type="first">P</forename>
				<surname>Vineis</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">N</forename>
				<surname>Pearce</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nat. Rev. Genet</title>
		<imprint>
			<biblScope unit="volume">11</biblScope>
			<biblScope unit="page">589</biblScope>
			<date type="published" when="2010" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b16">
	<analytic>
		<title level="a" type="main">On the number of segregating sites in genetical models without recombination</title>
		<author>
			<persName>
				<forename type="first">G</forename>
				<forename type="middle">A</forename>
				<surname>Watterson</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Theor. Popn. Biol</title>
		<imprint>
			<biblScope unit="volume">7</biblScope>
			<biblScope unit="page" from="256" to="276" />
			<date type="published" when="1975" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b17">
	<analytic>
		<title level="a" type="main">Simulating association studies: a data-based resampling method for candidate regions or whole genome scans</title>
		<author>
			<persName>
				<forename type="first">F</forename>
				<forename type="middle">A</forename>
				<surname>Wright</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">23</biblScope>
			<biblScope unit="page" from="2581" to="2588" />
			<date type="published" when="2007" />
		</imprint>
	</monogr>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>