
<?xml version="1.0" encoding="UTF-8"?>
<TEI xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 /home/joey/Project/grobid/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<encodingDesc>
			<appInfo>
				<application version="0.4.2-SNAPSHOT" ident="GROBID" when="2017-08-10T23:33+0000">
					<ref target="https://github.com/kermitt2/grobid">GROBID - A machine learning software for extracting information from scholarly documents</ref>
				</application>
			</appInfo>
		</encodingDesc>
		<fileDesc>
			<titleStmt>
				<title level="a" type="main">Genome analysis Making whole genome multiple alignments usable for biologists</title>
			</titleStmt>
			<publicationStmt>
				<publisher/>
				<availability status="unknown"><licence/></availability>
				<date type="published" when="2011">2011</date>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author>
							<persName>
								<forename type="first">Daniel</forename>
								<surname>Blankenberg</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department">Sciences and Department of Biochemistry and Molecular Biology</orgName>
								<orgName type="laboratory">The Huck Institutes for the Life</orgName>
								<orgName type="institution">Penn State University</orgName>
								<address>
									<addrLine>University Park</addrLine>
									<region>PA</region>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">James</forename>
								<surname>Taylor</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department">Sciences and Department of Biochemistry and Molecular Biology</orgName>
								<orgName type="laboratory">The Huck Institutes for the Life</orgName>
								<orgName type="institution">Penn State University</orgName>
								<address>
									<addrLine>University Park</addrLine>
									<region>PA</region>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Anton</forename>
								<surname>Nekrutenko</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department">Sciences and Department of Biochemistry and Molecular Biology</orgName>
								<orgName type="laboratory">The Huck Institutes for the Life</orgName>
								<orgName type="institution">Penn State University</orgName>
								<address>
									<addrLine>University Park</addrLine>
									<region>PA</region>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">The</forename>
								<forename type="middle">Galaxy</forename>
								<surname>Team</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department">Sciences and Department of Biochemistry and Molecular Biology</orgName>
								<orgName type="laboratory">The Huck Institutes for the Life</orgName>
								<orgName type="institution">Penn State University</orgName>
								<address>
									<addrLine>University Park</addrLine>
									<region>PA</region>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Alfonso</forename>
								<surname>Valencia</surname>
							</persName>
							<affiliation key="aff1">
								<orgName type="department">Department of Biology and Department of Mathematics and Computer Science</orgName>
								<orgName type="institution">Emory University</orgName>
								<address>
									<settlement>Atlanta</settlement>
									<region>GA</region>
									<country key="US">USA</country>
								</address>
							</affiliation>
						</author>
						<title level="a" type="main">Genome analysis Making whole genome multiple alignments usable for biologists</title>
					</analytic>
					<monogr>
						<title level="j" type="main">BIOINFORMATICS APPLICATIONS NOTE</title>
						<imprint>
							<biblScope unit="volume">27</biblScope>
							<biblScope unit="issue">17</biblScope>
							<biblScope unit="page" from="2426" to="2428"/>
							<date type="published" when="2011">2011</date>
						</imprint>
					</monogr>
					<idno type="DOI">10.1093/bioinformatics/btr398</idno>
					<note type="submission">Received on March 22, 2011; revised on May 18, 2011; accepted on June 27, 2011</note>
					<note>[12:47 30/7/2011 Bioinformatics-btr398.tex] Page: 2426 2426–2428 Associate Editor: Supplementary information: Supplementary data are available at Bioinformatics online.</note>
				</biblStruct>
			</sourceDesc>
		</fileDesc>
		<profileDesc>
			<abstract>
				<p>Here we describe a set of tools implemented within the Galaxy platform designed to make analysis of multiple genome alignments truly accessible for biologists. These tools are available through both a web-based graphical user interface and a command-line interface. Availability and Implementation: This open-source toolset was implemented in Python and has been integrated into the online data analysis platform Galaxy (public web access:</p>
			</abstract>
		</profileDesc>
	</teiHeader>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1">INTRODUCTION</head><p>With the emergence and rapid proliferation of new sequencing technologies, data generation is no longer a major challenge in genomics. Unfortunately, the relative ease of genome sequencing does not automatically translate into the expanding of biological knowledge—it is still quite difficult to decipher the functional significance of genomic DNA. One reason for this is that the vast majority of functional studies have focused on annotating the genomes of human and model organisms. Whole genome alignments offer a solution to this challenge. By aligning newly sequenced genomes against well-annotated sequences, one can obtain a variety of functional, structural and evolutionary insights. Yet there are still two formidable barriers preventing biomedical scientists, the ultimate 'consumers' of whole genome alignments, from effectively utilizing them in their research. First, whole genome alignments are very large. For example, the existing alignment sets of 28 mammalian species (<ref type="bibr" target="#b7">Miller et al., 2007</ref>) and 46 vertebrate species (<ref type="bibr" target="#b3">Fujita et al., 2011</ref>) occupy several hundred gigabytes of disk space and contain millions of alignment blocks. Handling data at this scale presents challenges even for researchers with extensive programming experience, while for most experimental biologists they are simply beyond reach. Second, the data exists * To whom correspondence should be addressed. † http://usegalaxy.org. in a specialized format, the Multiple Alignment Format (MAF; Supplementary<ref type="figure">Fig. S1</ref>). Although the MAF format is versatile and contains the information necessary for interpreting the alignments, it is currently not readily accepted or processed by downstream applications. Here we describe a set of tools, available through both a webbased graphical user interface (GUI) and a command-line interface, designed to address challenges faced when working with these data. No downloads are required in order to use the GUI version of the tools, as they have been implemented into the web-based genome analysis platform Galaxy (<ref type="bibr" target="#b2">Blankenberg et al., 2007</ref><ref type="bibr" target="#b1">Blankenberg et al., , 2010</ref><ref type="bibr" target="#b4">Goecks et al., 2010;</ref><ref type="bibr" target="#b8">Taylor et al., 2007</ref>). Galaxy aims to bridge the gap between the data and successful analysis. Available freely as a public service (http://usegalaxy.org) and as an open source software project (http://getgalaxy.org), Galaxy can be deployed in individual labs and on Cloud resources (<ref type="bibr" target="#b0">Afgan et al., 2010</ref>). Galaxy features a history system that tracks user inputs and parameter settings, ensuring that analyses can be reproduced precisely, as well as a seamless workflow system that allows reusable multiple tool pipelines to be created by extracting from an existing analysis history or through using an interactive drag and drop interface. Not only are researchers able to share their analysis histories and workflows with colleagues or the greater scientific community, but they can also compose complete analysis protocols (Pages) using a web-based word processor style (i.e. WYSIWYG) editor with built-in history and workflow embedding capabilities. Supplementary information for this manuscript is available as one of these Galaxy Pages (http://usegalaxy.org/u/dan/p/maf). MAF format in brief: the MAF format has emerged as a de facto standard for storing and exchanging whole genome multiple alignments. Alignments stored in this format retain the sequence and genomic position information for the aligning sequence ranges. As a convention in Galaxy, sequences are named according to the source species genome build and sequence identifier within that build (generally a chromosome or contig); the genome build and sequence identifier are separated by a period. For example, the sequence of chromosome 21 from a March 2006 human genome reference assembly, known as hg18, would be named 'hg18.chr21'. Alignments are arranged in blocks separated by a blank line, where each block constitutes an individual set of sequence ranges (e.g. a single local alignment involving some set of species). These ranges need not be unique as a MAF set can contain overlapping blocks. In the MAF format, the genomic coordinates of alignments on the '-' strand are numbered relative to the reverse complement of the source sequence (unlike other common formats for genome annotation, such as GFF and BED). Though often an obstacle to biologists tryingPage: 2427 2426–2428</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Making alignments usable</head><p>to work with these files, this important difference in coordinate systems is resolved internally within this toolset and requires no additional effort or consideration on the part of users.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2">A SUITE OF TOOLS FOR MULTIPLE ALIGNMENT ANALYSIS</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.1">Alignment extractors</head><p>Commonly, using all of an alignment of entire genomes is neither practical nor desired. A frequent first step in an analysis utilizing a whole genome alignment is to extract a specific subset of interest, such as those corresponding to genes or other genomic elements. Thus, it is critical to be able to quickly and efficiently identify a set of alignment blocks that overlap a given set of genomic intervals. This presents the need for the first set of tools, known as alignment extractors (Supplementary<ref type="figure">Fig. S2</ref>). Within the public web server implementation, users can extract from a collection of alignments locally cached on the Galaxy server, from alignments provided via uploading from a computer or by copy and pasting a URL, or from alignments acquired directly from an external data source. Blocks that have start and end positions exceeding the requested region boundaries are trimmed. Additionally, blocks are automatically output in the strand-orientation of the provided genomic intervals.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.2">Format converters</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.2.1">MAF to FASTA</head><p>Most current alignment analysis programs are unable to recognize MAF alignment files, which presents the need for the second set of tools: format converters. Two approaches of MAF to FASTA conversion (Supplementary<ref type="figure">Fig. S3</ref>) are provided: one that creates a block-by-block multiple alignment FASTA file and another that creates a single alignment block. The tool that creates a multiple alignment FASTA file additionally allows the user to exclude blocks that are missing a requested species. The latter tool concatenates the sequences for all blocks, resulting in one large alignment block, where each species has exactly one sequence and blocks that lack a particular species will have the unaligned regions filled with gaps.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.2.2">MAF to interval</head><p>The MAF to interval converter allows users to extract genomic interval information from an alignment. This tool creates a tabular file containing the aligned sequence data and converts the included genomic region information into a zero-based half-open (BED-like) format.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.3">Stitchers</head><p>In addition to the alignment extractors and format converters, there is a type of tool that acts as a hybrid of these two concepts. These tools, known as MAF 'stitchers' (Supplementary<ref type="figure">Fig. S4</ref>), produce exactly one alignment for each user-provided interval by resolving overlaps and 'stitching' adjacent blocks together. Two forms of stitching are provided here: one that works on standard genomic intervals and another that works on genomic intervals having additional fields that define protein-coding exons (i.e. BED12). BED12 files can be retrieved, for example, directly from the UCSC Table browser (<ref type="bibr" target="#b5">Karolchik et al., 2004</ref>) by selecting a gene track (e.g. RefSeq Genes) and selecting the option to create one BED record per 'Whole gene'. For each genomic interval that is specified, a single FASTA alignment block is created. This alignment block contains only the genomic positions that appear within the genome to which the genomic intervals belong; insertions in aligning species, relative to this reference species, are discarded. Overlapping blocks, allowed within MAF alignments, must be taken into account. Conceptually, these blocks are split at the boundaries of the overlap, and the original score for the alignment block is used to determine which aligning sequences are used on a per species basis; if a sequence is present for a species in a lower scoring alignment block but not in any higher-scoring block, then the sequence for that species is taken from the lower scoring alignment block. When performing this operation on a gene basis, only the positions, which are part of the protein-coding sequence for the reference species are included in the output; individual coding exons are processed as separate genomic intervals, as above, and these exons are concatenated together for each requested gene.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.4">Tools for MAF manipulation</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.4.1">Species restriction</head><p>The number of species included in publicly available pre-computed multiple alignments continues to increase, which makes these alignments more useful, but also more difficult to analyze, as more species results in more fragmented alignments. Extra gaps, such as those left over from an insertion found only in the genome of a removed species, should be eliminated. The limiting of an alignment to only desired species (Supplementary<ref type="figure">Fig. S5</ref>) is available as a separate tool or can be accomplished directly within the Extract MAF blocks tool interface.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.4.2">Block Joiner A variant</head><p>of the filter species tool is the Join MAF blocks by Species tool (Supplementary<ref type="figure">Fig. S6</ref>), which not only removes undesired species, but also concatenates adjacent MAF blocks. When the species that caused a block to be divided are removed, the split blocks can be joined together to create a single MAF alignment block. This requires the genomic positions of each species in the blocks-to-be-joined to have genomic positions that start and end directly adjacent to each other. When joining, the strand of each sequence is important, as positions listed in opposing orientations are considered different even if they are equivalent locations.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.4.3">MAF Filter</head><p>Many times there is no need to modify the contents of alignment blocks, but instead it is desirable to apply a set of filters that remove blocks that do not match a set of conditions. The Filter MAF by specified attributes tool allows users to build complex, multiple step filters that are applied to each alignment block. Examples of this include removing blocks, which lack species, removing blocks which have aligned species occurring between non-syntenic chromosomes or strands, removing blocks which are missing desired species and removing blocks which fall outside of a desired size range (Supplementary<ref type="figure">Fig. S7</ref>).</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.5">Alignment coverage</head><p>After modifying or filtering an alignment (or without modification), the MAF Coverage Stats tool allows viewing coverage information about the remaining blocks in reference to a particular set of intervals. There are two different types of output: one that provides information on a per interval basis and another that provides a Page: 2428 2426–2428</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>D.Blankenberg et al.</head><p>summary over all intervals provided. Only positions that exist in the genome of the supplied genomic intervals are included in the output.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3">CONCLUSIONS</head><p>Due to the size of multiple species whole genome alignments, searching through the entirety of their contents to locate desired blocks is not practical; this has led to the utilization of a compressioncapable indexing implementation that is a variation of the positional binning approach (<ref type="bibr" target="#b6">Kent et al., 2002;</ref><ref type="bibr" target="#b7">Miller et al., 2007</ref>) stored on disk. The indexes for MAFs appearing in a user's history are generated during history item creation; when an index is not available, the command-line tools will create temporary index files on the fly. For larger locally cached alignments, the source MAF files are compressed and an associated lookup table is created to allow the interoperability of the indexes with the compressed data. It is worth mentioning that each of the alignment sets locally cached by the public Galaxy server are actually composed of several individual MAF files. These files tend to be split by and named for the chromosomes of the reference (projected) genome of the alignment. For example, the 28-way alignment is divided according to the human chromosome found within each alignment block. This results in 49 individual compressed MAF files, indexes and lookup tables; this number is larger than the number of human chromosomes due to the 'random' chromosomal regions, several chromosomal haplotypes and the mitochondrial genome. It is not required that MAF sets be divided in this (or any) fashion, as the indices indicate which blocks are found in a particular MAF file, but this is a common release practice of the research groups creating the alignments and can allow greater flexibility with hardware and system concerns. While all of the tools are designed to work directly out-of-thebox for personal Galaxy installations, additional steps are required to provide a collection of pre-cached source alignments to the extraction tools. These steps include obtaining source alignments, generating indexes and compressing the source MAF files (when desired); the steps required to perform these actions are outlined at the Galaxy wiki, with direct links provided in the Supplementary Material. Setting up these locally cached alignment sources is not required, as users are able to directly upload and use their own alignment files in any of the tools. The tools described here are implemented in Python, allowing seamless cross-platform compatibility, and utilize the bx-python package (https://bitbucket.org/james_taylor/bx-python/). The GUI version of this toolset has been made available through the public Galaxy server (http://usegalaxy.org) allowing users to access not only the tools detailed above, but also additional genome analysis tools and data sources, all within one unified interface. The command-line tools and the graphical configuration files are distributed as part of the standard Galaxy distribution (http://getgalaxy.org). These tools and the entire Galaxy framework are released as open-source under the academic free license— allowing developers to modify and redistribute the applications with few restrictions.</p></div><figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_0"><head></head><figDesc>[12:47 30/7/2011 Bioinformatics-btr398.tex]</figDesc></figure>

			<note place="foot">© The Author(s) 2011. Published by Oxford University Press. This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (http://creativecommons.org/licenses/ by-nc/2.5), which permits unrestricted non-commercial use, distribution, and reproduction in any medium, provided the original work is properly cited. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>

			<note place="foot">at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>
		</body>
		<back>

			<div type="acknowledgement">
<div xmlns="http://www.tei-c.org/ns/1.0"><head>ACKNOWLEDGEMENTS</head><p>We would like to thank UCSC Genome Biology group (and especially Jim Kent and David Haussler) for generating, maintaining and providing access to alignments. Efforts of the Galaxy Team (Enis Afgan, Dannon Baker, Dan Blankenberg, Nate Coraor, Jeremy Goecks, Greg Von Kuster, Ross Lazarus, Kanwei Li, Kelly Vincent) were instrumental for making this work happen.</p></div>
			</div>

			<div type="references">

				<listBibl>

<biblStruct   xml:id="b0">
	<analytic>
		<title level="a" type="main">Galaxy CloudMan: delivering cloud compute clusters</title>
		<author>
			<persName>
				<forename type="first">E</forename>
				<surname>Afgan</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">BMC Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">11</biblScope>
			<biblScope unit="page">4</biblScope>
			<date type="published" when="2010" />
		</imprint>
	</monogr>
	<note>Suppl. . 12</note>
</biblStruct>

<biblStruct   xml:id="b1">
	<analytic>
		<title level="a" type="main">Galaxy: a web-based genome analysis tool for experimentalists</title>
		<author>
			<persName>
				<forename type="first">D</forename>
				<surname>Blankenberg</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Curr. Protoc. Mol. Biol., Chapter</title>
		<imprint>
			<biblScope unit="volume">19</biblScope>
			<date type="published" when="2010" />
		</imprint>
	</monogr>
	<note>Unit. 19.10.1–19.10.21</note>
</biblStruct>

<biblStruct   xml:id="b2">
	<analytic>
		<title level="a" type="main">A framework for collaborative analysis of ENCODE data: making large-scale analyses biologist-friendly</title>
		<author>
			<persName>
				<forename type="first">D</forename>
				<surname>Blankenberg</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Genome Res</title>
		<imprint>
			<biblScope unit="volume">17</biblScope>
			<biblScope unit="page" from="960" to="964" />
			<date type="published" when="2007" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b3">
	<analytic>
		<title level="a" type="main">The UCSC Genome Browser database: update 2011</title>
		<author>
			<persName>
				<forename type="first">P</forename>
				<forename type="middle">A</forename>
				<surname>Fujita</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nucleic Acids Res</title>
		<imprint>
			<biblScope unit="volume">39</biblScope>
			<biblScope unit="page" from="876" to="882" />
			<date type="published" when="2011" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b4">
	<analytic>
		<title level="a" type="main">Galaxy: a comprehensive approach for supporting accessible, reproducible, and transparent computational research in the life sciences</title>
		<author>
			<persName>
				<forename type="first">J</forename>
				<surname>Goecks</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Genome Biol</title>
		<imprint>
			<biblScope unit="volume">11</biblScope>
			<biblScope unit="page">86</biblScope>
			<date type="published" when="2010" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b5">
	<analytic>
		<title level="a" type="main">The UCSC Table Browser data retrieval tool</title>
		<author>
			<persName>
				<forename type="first">D</forename>
				<surname>Karolchik</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nucleic Acids Res</title>
		<imprint>
			<biblScope unit="volume">32</biblScope>
			<biblScope unit="page" from="493" to="496" />
			<date type="published" when="2004" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b6">
	<analytic>
		<title level="a" type="main">The human genome browser at UCSC</title>
		<author>
			<persName>
				<forename type="first">W</forename>
				<forename type="middle">J</forename>
				<surname>Kent</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Genome Res</title>
		<imprint>
			<biblScope unit="volume">12</biblScope>
			<biblScope unit="page" from="996" to="1006" />
			<date type="published" when="2002" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b7">
	<analytic>
		<title level="a" type="main">28-way vertebrate alignment and conservation track in the UCSC Genome Browser</title>
		<author>
			<persName>
				<forename type="first">W</forename>
				<surname>Miller</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Genome Res</title>
		<imprint>
			<biblScope unit="volume">17</biblScope>
			<biblScope unit="page" from="1797" to="1808" />
			<date type="published" when="2007" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b8">
	<analytic>
		<title level="a" type="main">Using galaxy to perform large-scale interactive data analysis</title>
		<author>
			<persName>
				<forename type="first">J</forename>
				<surname>Taylor</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Curr. Protoc. Bioinform</title>
		<imprint>
			<biblScope unit="volume">19</biblScope>
			<date type="published" when="2007" />
		</imprint>
	</monogr>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>