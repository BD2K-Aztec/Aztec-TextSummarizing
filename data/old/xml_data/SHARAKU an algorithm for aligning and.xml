
<?xml version="1.0" encoding="UTF-8"?>
<TEI xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 /home/joey/Project/grobid/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<encodingDesc>
			<appInfo>
				<application version="0.4.2-SNAPSHOT" ident="GROBID" when="2017-08-10T23:46+0000">
					<ref target="https://github.com/kermitt2/grobid">GROBID - A machine learning software for extracting information from scholarly documents</ref>
				</application>
			</appInfo>
		</encodingDesc>
		<fileDesc>
			<titleStmt>
				<title level="a" type="main">SHARAKU: an algorithm for aligning and clustering read mapping profiles of deep sequencing in non-coding RNA processing</title>
			</titleStmt>
			<publicationStmt>
				<publisher/>
				<availability status="unknown"><licence/></availability>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author>
							<persName>
								<forename type="first">Mariko</forename>
								<surname>Tsuchiya</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department">Department of Biosciences and Informatics</orgName>
								<orgName type="institution">Keio University</orgName>
								<address>
									<postCode>161-0031</postCode>
									<settlement>Yokohama</settlement>
									<country key="JP">Japan</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Kojiro</forename>
								<surname>Amano</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department">Department of Biosciences and Informatics</orgName>
								<orgName type="institution">Keio University</orgName>
								<address>
									<postCode>161-0031</postCode>
									<settlement>Yokohama</settlement>
									<country key="JP">Japan</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Masaya</forename>
								<surname>Abe</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department">Department of Biosciences and Informatics</orgName>
								<orgName type="institution">Keio University</orgName>
								<address>
									<postCode>161-0031</postCode>
									<settlement>Yokohama</settlement>
									<country key="JP">Japan</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Misato</forename>
								<surname>Seki</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department">Department of Biosciences and Informatics</orgName>
								<orgName type="institution">Keio University</orgName>
								<address>
									<postCode>161-0031</postCode>
									<settlement>Yokohama</settlement>
									<country key="JP">Japan</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Sumitaka</forename>
								<surname>Hase</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department">Department of Biosciences and Informatics</orgName>
								<orgName type="institution">Keio University</orgName>
								<address>
									<postCode>161-0031</postCode>
									<settlement>Yokohama</settlement>
									<country key="JP">Japan</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Kengo</forename>
								<surname>Sato</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department">Department of Biosciences and Informatics</orgName>
								<orgName type="institution">Keio University</orgName>
								<address>
									<postCode>161-0031</postCode>
									<settlement>Yokohama</settlement>
									<country key="JP">Japan</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Yasubumi</forename>
								<surname>Sakakibara</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department">Department of Biosciences and Informatics</orgName>
								<orgName type="institution">Keio University</orgName>
								<address>
									<postCode>161-0031</postCode>
									<settlement>Yokohama</settlement>
									<country key="JP">Japan</country>
								</address>
							</affiliation>
						</author>
						<title level="a" type="main">SHARAKU: an algorithm for aligning and clustering read mapping profiles of deep sequencing in non-coding RNA processing</title>
					</analytic>
					<monogr>
						<imprint>
							<date/>
						</imprint>
					</monogr>
					<idno type="DOI">10.1093/bioinformatics/btw273</idno>
					<note>*To whom correspondence should be addressed. † These authors contributed equally to this work. Contact: yasu@bio.keio.ac.jp Supplementary information: Supplementary data are available at Bioinformatics online.</note>
				</biblStruct>
			</sourceDesc>
		</fileDesc>
		<profileDesc>
			<abstract>
				<p>Motivation: Deep sequencing of the transcripts of regulatory non-coding RNA generates footprints of post-transcriptional processes. After obtaining sequence reads, the short reads are mapped to a reference genome, and specific mapping patterns can be detected called read mapping profiles, which are distinct from random non-functional degradation patterns. These patterns reflect the maturation processes that lead to the production of shorter RNA sequences. Recent next-generation sequencing studies have revealed not only the typical maturation process of miRNAs but also the various processing mechanisms of small RNAs derived from tRNAs and snoRNAs. Results: We developed an algorithm termed SHARAKU to align two read mapping profiles of next-generation sequencing outputs for non-coding RNAs. In contrast with previous work, SHARAKU incorporates the primary and secondary sequence structures into an alignment of read mapping profiles to allow for the detection of common processing patterns. Using a benchmark simulated dataset, SHARAKU exhibited superior performance to previous methods for correctly clustering the read mapping profiles with respect to 5 0-end processing and 3 0-end processing from degradation patterns and in detecting similar processing patterns in deriving the shorter RNAs. Further, using experimental data of small RNA sequencing for the common marmoset brain, SHARAKU succeeded in identifying the significant clusters of read mapping profiles for similar processing patterns of small derived RNA families expressed in the brain. Availability and Implementation: The source code of our program SHARAKU is available at http:// www.dna.bio.keio.ac.jp/sharaku/, and the simulated dataset used in this work is available at the same link. Accession code: The sequence data from the whole RNA transcripts in the hippocampus of the left brain used in this work is available from the DNA DataBank of Japan (DDBJ) Sequence Read Archive (DRA) under the accession number DRA004502.</p>
			</abstract>
		</profileDesc>
	</teiHeader>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1">Introduction</head><p>Since high-throughput sequencing allows for deep sequencing with high sensitivity, RNA sequencing with a next-generation sequencer (RNA-seq) can detect not only the complete expression patterns of transcribed RNAs but also fragments derived due to the splicing, maturation processing, or non-functional degradation of the RNAs. RNA-seq studies targeting microRNAs (miRNAs) have revealed the existence of many different RNA fragments derived from small RNA species other than microRNA, providing further proof that derived RNA fragments are not simply random degradation products but are rather stable entities, which might have functional activity (<ref type="bibr" target="#b14">Martens-Uzunova et al., 2013</ref>). The evidence accumulating about shorter sequences or fragments derived from non-coding RNAs indicates that post-transcriptional processes are relatively common mechanisms to derive functional smaller molecules from various RNA families such as tRNAs and snoRNAs. For example, the so-called tRNA-derived RNA fragments (tRFs) are derived from processing at the 5 0 or 3 0-end of mature or precursor tRNAs (<ref type="bibr" target="#b10">Lee et al., 2009</ref>). These sequences constitute a class of short RNAs that are the second most abundant type of RNA after miRNAs. Since the discovery of small RNAs derived from tRNAs, a variety of names have been used to refer to similar entities, such as tRNA-derived RNA fragments (tRFs) (<ref type="bibr" target="#b10">Lee et al., 2009</ref>), stress-induced small RNAs (tiRNAs) (<ref type="bibr" target="#b28">Yamasaki et al., 2009</ref>) and tRNA-derived small RNAs (tsRNAs) (<ref type="bibr" target="#b3">Haussecker et al., 2010</ref>). Their uniform start and stop sites of cleavage in tRNA, together with their nonrandom size property, strongly suggest that tRFs are derived from tRNA cleavage in a specific and regulated manner (<ref type="bibr" target="#b10">Lee et al., 2009</ref>). In addition, several studies have identified a class of small fragments derived from snoRNAs (called sdRNAs), some of which may regulate splicing or translation (<ref type="bibr" target="#b0">Chen and Heard, 2013;</ref><ref type="bibr" target="#b25">Taft et al., 2009</ref>). The biological roles of such sno-derived RNA and tRNA-derived small RNAs have primarily been investigated in cancer cells (<ref type="bibr" target="#b14">Martens-Uzunova et al., 2013</ref>). tRNA-derived fragments participate in several types of biological processes, including as signal molecules in a stress-induced response and as regulators of gene expression. sdRNAs can function as miRNAs, regulators of alternative splicing, and tumor suppressors and oncogenes. The reads for such short derived RNAs are relatively abundant, i.e. greater than background levels, in small RNA-seq datasets. Chen and Heard (2013) pointed out that 'these reads are precisely mapped to specific regions of primary or secondary structures, and might contain special motifs or base biases, reflecting the involvement of special enzymes involved in their generation'. Hence, mapping a large amount of sequence reads onto a reference sequence can reveal specific forms of mapping patterns for the maturation process or random patterns for non-functional degradations (see<ref type="figure" target="#fig_0">Fig. 1</ref>(a)). These mapping patterns of RNA-seq short reads constitute the socalled read mapping profiles (see<ref type="figure" target="#fig_0">Fig. 1</ref>(b)) (<ref type="bibr" target="#b18">Pundhir et al., 2015</ref>).<ref type="bibr" target="#b0">Chen and Heard (2013)</ref>also pointed out that the non-specific degradation products include RNA fragments that are rapidly digested by the surveillance machinery from RNA molecules, which are defective in processing, folding and functions. Thus, it is crucial to reliably distinguish the true shorter RNAs from their non-functional degradation products to clearly identify derived and functional small RNAs and fragments. Therefore, the aim of the present study was to develop a computational tool for the comprehensive analysis and rapid identification of the post-transcriptional processing patterns of non-coding RNAs based on high-throughput RNA-seq data. The algorithm developed in this study was designed to capture specific forms of read mapping patterns mapped to specific regions of primary or secondary structures reflecting the functional activities of enzymes, and to distinguish them from non-functional degradation products. There are only a few existing tools (<ref type="bibr" target="#b2">Erhard and Zimmer, 2010;</ref><ref type="bibr" target="#b5">Hoogstrate et al., 2015;</ref><ref type="bibr" target="#b9">Langenberger et al., 2012;</ref><ref type="bibr" target="#b26">Videm et al., 2014</ref>) to analyze such read mapping profiles of RNA-seq data and detect footprints of the post-transcriptional processes or degradations of RNAs. FlaiMapper (<ref type="bibr" target="#b5">Hoogstrate et al., 2015</ref>) predicts and annotates non-coding RNA-derived fragments by determining the start and stop positions from read mapping profiles. FlaiMapper can predict miRNA boundaries with high accuracy. deepBlockAlign (<ref type="bibr" target="#b9">Langenberger et al., 2012</ref>), which our present study takes quite a similar approach to, is an alignment-based method for alignments of read mapping profiles to find non-coding derived RNAs that share similar post-transcriptional processing. ALPS (<ref type="bibr" target="#b2">Erhard and Zimmer, 2010</ref>) is also alignment-based, but is not designed for the purpose of identification of short derived RNA fragments. BlockClust (<ref type="bibr" target="#b26">Videm et al., 2014</ref>) computes a similarity score between read mapping profiles to detect similar processing patterns and cluster read mapping profiles. BlockClust includes a high-dimensional feature representation to encode read mapping profiles and calculates the similarity scores based on a graph kernel. Therefore, BlockClust does not rely on alignment-based techniques and is not designed for the purpose of calculating the alignment of read profiles. However, all of these methods are computed based only on the information of read mapping profiles and do not take the RNA sequence and secondary structure information into account. Further, those methods did not address the reliable distinguishability of processing patterns from the random degradation. Constructing an alignment for a pair of biological sequences such as DNA, RNA and protein sequences is a fundamental and robust method of sequence analysis (<ref type="bibr" target="#b1">Durbin et al., 1998</ref>). The pairwise alignment of biological sequences is achieved according to insertions, deletions and match operations so that the two sequences are aligned with the same column length. The similarity score of an alignment is calculated according to the predefined scores for insertions, deletions and matches. Similarly, one can define the alignment between a pair of read mapping profiles (see<ref type="figure" target="#fig_0">Fig. 1</ref>(c)).An alignment of two read mapping profiles for SNORD14 and SNORD21 output by SHARAKU, using the small RNA-seq data for the common marmoset brain with the annotations of RNA sequence alignment and the predicted secondary structure. The solid line represents the read coverages of SNORD14, and the dashed line represents the read coverages of SNORD21. (d) Schematic illustration of the necessity of incorporating the primary and secondary structures of RNA sequences into an alignment</p><p>In previous work with the deepBlockAlign algorithm (<ref type="bibr" target="#b9">Langenberger et al., 2012</ref>), the alignment program was designed to compare and align any read mapping profiles regardless of the RNA family to which they belong. The alignment program was also applied to the comparison of read mapping profiles of the same RNA gene across different samples that might be expected to induce different read mapping profiles (<ref type="bibr" target="#b18">Pundhir and Gorodkin, 2015</ref>). This method is effective for the differential processing analysis of read mapping profiles of each non-coding RNA gene. In contrast with previous work, our primary goal was to detect specific forms among similar read mapping patterns mapped to specific regions of primary or secondary structures reflecting the functional activities of enzymes by alignments of read mapping profiles, and to distinguish these from non-functional degradation products. We developed a new read mapping profile alignment program named SHARAKU, which incorporates the primary and secondary structures of RNA sequences into an alignment of read mapping profiles. This is accomplished in combination with DAFS, a program for the simultaneous aligning and folding of RNA sequences (<ref type="bibr" target="#b21">Sato et al., 2012</ref>). As a result, the most advanced feature of SHARAKU is that it simultaneously aligns the read mapping profiles and RNA sequences with the folding RNA secondary structures. Since each type of derived RNA fragments is cleaved from its precursor with a specific context of primary sequence and secondary structure, we can expect that the simultaneous alignment of read mapping profiles with the primary and secondary structures contributes to precise identifications of the type of derived RNAs. Thus, application of SHARAKU to the mixture of different RNA families would enable the accurate clustering of read mapping profiles with respect to 5 0-end processing or 3 0-end processing of each RNA family, and facilitate the detection of common processing patterns shared among different RNA families (see<ref type="figure" target="#fig_0">Fig. 1</ref>(d)). Note that SHARAKU was not designed for classification of RNA sequences into different RNA families. Further, SHARAKU produces an alignment of read mapping profiles at the nucleotidelevel resolution, as<ref type="figure" target="#fig_0">Figure 1</ref>(c) displays. In contrast, deepBlockAlign uses blockbuster (<ref type="bibr" target="#b8">Langenberger et al., 2009</ref>) to generate block groups and aligns any read mapping profiles at the level of individual blocks and block groups, including those in unannotated regions or unknown RNA genes. On the other hand, the current version of SHARAKU can only be applied to the annotated non-coding RNA regions. Several previous studies (<ref type="bibr" target="#b17">Ono et al., 2011;</ref><ref type="bibr" target="#b22">Scott and Ono, 2011</ref>) have explored the similarities and evolutionary relationships between snoRNAs and miRNA precursors. These similarity features represent molecules involved in the same processing pathways with a similar set of processing enzymes and the same RNAi targets. These similarity features are often confirmed based on the conservation of their primary and secondary structures, such as structural characteristics of typical H/ACA or C/D boxes. We hypothesized that in addition to sequence structure conservation, determining the similarity among read mapping profiles might help to identify the functional or processing similarities between snoRNAs and miRNA precursors.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2">Methods</head><p>When read mapping profiles for a pair of non-coding RNAs are obtained, SHARAKU fundamentally aligns two read mapping profiles by inserting gaps so that the sum of the differences of coverages at all positions between the two profiles is minimized. Simultaneously, SHARAKU takes information on the sequence and secondary structures of RNAs into account when aligning read mapping profiles by integration with DAFS, which calculates reliable structural alignments that maximize the expected accuracy of a predicted common secondary structure and its sequence alignment. The algorithm can be efficiently implemented by using dynamic programming. Second, SHARAKU calculates a similarity score (correlation coefficient) between two read mapping profiles based on the alignment. Third, SHARAKU produces a similarity score matrix for all pairs of read mapping profiles of non-coding RNAs in the target reference genome. Subsequently, the agglomerative hierarchical clustering is constructed based on the similarity score matrix.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.1">Construction of read mapping profiles</head><p>Let R ¼ fA; C; G; Ug denotes the four nucleotides and R Ã denotes the set of all finite RNA sequences consisting of bases in R. A set of sequence reads generated by RNA-seq data for noncoding RNAs are mapped against the reference genome using standard mapping tools such as BWA (<ref type="bibr" target="#b11">Li and Durbin, 2009</ref>) (i.e. alignment programs) for a huge number of short reads. The read coverage, i.e. the number (count) of mapped reads, at each position in an annotated RNA gene-coding region is calculated from the output of the mapping tool in BAM format. In an RNA gene-coding region, the read coverage c i at each position i is normalized so that every normalized value of read coverage is between 0 and 1. For an RNA sequence, denoted a ¼ a 1 ;. .. ; a m , of an annotated RNA genecoding sequence, we refer to the sequence of normalized coverages, c a ¼ c a 1 ;. .. ; c a m , as the read mapping profile of the RNA sequence (see<ref type="figure" target="#fig_0">Fig. 1</ref>(a)). Note that SHARAKU only deals with the read mapping profile within the annotated RNA-gene sequence and calculates the secondary structure within the annotated RNA-gene sequence.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.2">Alignment algorithm for a pair of read mapping profiles</head><p>Let a ¼ a 1 ;. .. ; a m and b ¼ b 1 ;. .. ; b n denote a pair of RNA sequences, c a ¼ c a 1 ;. .. ; c a m and c b ¼ c b 1 ;. .. ; c b n denote the normalized read mapping profiles. The optimal alignment of a pair of two normalized read mapping profiles c a and c b is calculated by the following recursive formula to minimize the sum of the differences of coverages at all positions. The mismatch score at a position of an alignment between c a and c b is simply defined as the absolute difference of the two coverage values c a i and c b j. To define the gap score, first, the coverage value at a gap inserted between j and j þ 1 is defined as ðc x j þ c x jþ1 Þ=2 (i.e. the average of c x j and c x jþ1 ). Second, the gap score between position i of c a and the gap inserted between j and j þ 1 of c b is defined as the absolute difference of c a i and ðc b j þ c b jþ1 Þ=2.r gapði; 0Þ ¼ jc a i À c b 1 j r gapði; nÞ ¼ jc a i À c b n j l gapð0; jÞ ¼ jc a 1 À c b j j l gapðm; jÞ ¼ jc a m À c b j j</p><p>In order to avoid an unnecessary number of gaps inserted, which could cause artificial alignments, the number of gaps inserted into the alignment is restricted by the predefined parameter c. This can be implemented by dynamic programming to control the number of inserted gaps.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.3">Alignment of read mapping profiles</head><p>incorporating sequence structures binary-valued triangular matrix x ¼ ðx ij Þ i &lt; j , where x ij 1 ¼ if and only if bases a i and a j form a base pair. Let A s ða; bÞ denote a set of all possible structural alignments of a and b, that is, simultaneous alignment of RNA sequences and their secondary structures. We write h ¼ ðx; y; tÞ, which means that a structural alignment h 2 A s ða; bÞ consists of an alignment t 2 Aða; bÞ, and two secondary structures x 2 SðaÞ and y 2 SðbÞ. First, in DAFS, a gain function Gðh; b hÞ of a structural alignment b h ¼ ðb x; b y; b tÞ with regard to the correct structural alignment h ¼ ðx; y; tÞ is defined as the weighted sum of gain functions G ss ðx; b xÞ and G ss ðy; b yÞ of the respective secondary structures and a gain function G aln ðt; b tÞ of the alignment: Gðh; b hÞ ¼ afG ss ðx; b xÞ þ G ss ðy; b yÞg þ G aln ðt; b tÞ</p><formula>(1)</formula><p>where a &gt; 0 is a parameter that controls the weight of the secondary structures and the sequence alignment. Intuitively, the gain function Gðv; b vÞ can be regarded as a kind of 'accuracy' that represents the weighted sum of the number of true positive predictions and true negative predictions in b v, which is correlated to balanced accuracy measures such as Matthews correlation coefficient (MCC) and F-measure. In the case of the gain function G ss ðx; b xÞ for the secondary structure, a true prediction in b x is a pair of bases a i and a j such that b x ij ¼ x ij. In the case of G aln ðt; b tÞ for the sequence alignment, a true prediction in b t is a pair of bases a i and b k such that b t ik ¼ t ik. Second, when we calculate a structural alignment for a pair of RNA sequences, their correct structural alignment is unknown. In such case, we compute the expectation of a gain function under the distribution over all possible structural alignments of the pair of RNA sequences. The expectation E hja;b ½Gðh; b hÞ of the gain function Gðh; b hÞ under a given probability distribution over the space A s ða; bÞ of structural alignments is maximized to find a structural alignment b h:where Pðhja; bÞ is a probability distribution of the RNA structural alignments. To reduce the computational complexity of Equation (2), the probability distribution Pðhja; bÞ of the structural alignments is factorized as follows by assuming the independence of the structures and alignment: Pðhja; bÞ % PðxjaÞPðyjbÞPðtja; bÞ;</p><p>where PðxjaÞ and PðyjbÞ are the probability distributions of RNA secondary structures over SðaÞ and SðbÞ, respectively, and Pðtja; bÞ is a probability distribution of alignments over Aða; bÞ. The expected gain function (2) can then be approximated as follows:</p><formula>À r h i b t ik þ a X i &lt; j p ðaÞ ij À s h i b x ij þ X k &lt; l p ðbÞ kl À s h i b y k;l ! þ C</formula><p>where p ðaÞ ij denotes a base-pairing posterior probability, p ða::bÞ ik denotes an alignment-matching posterior probability, r and s ð0 r; s 1Þ are balancing parameters between true positives and true negatives, and C is a constant independent of b h (see Sato et al., 2012 and its Supplementary Material for the derivation). In order to incorporate the DAFS framework of the simultaneous aligning and folding of RNA sequences into the alignment of read mapping profiles on the basis of the MEA principle, we need to define the expectation of the gain function for alignments of read mapping profiles. First, we define the partition function (<ref type="bibr" target="#b15">McCaskill, 1990</ref>) for alignments of read mapping profiles. The partition function is equal to the alignment kernel K(a, b) (<ref type="bibr" target="#b16">Morita et al., 2009;</ref><ref type="bibr" target="#b20">Saigo et al., 2004</ref>) that measures the similarity between two sequences a and b by summing the scores obtained from all possible alignments with the gaps of the sequences. The partition functionwhere two variables rg and lg are used for controlling the number of inserted gaps. The 'backward' algorithm to compute Bði; j; rg; lgÞ can also be defined in a similar manner. Now, we can define a posterior probability of positions i and j to be aligned in the alignments of read mapping profiles:</p><formula>% X i;k w rmp p ðc a ::c b Þ ik þ ð1 À w rmp Þ p ða::bÞ ik À r h i b t ik þ w ss X i &lt; j p ðaÞ ij À s h i b x ij þ X k &lt; l p ðbÞ kl À s h i b y k;l ! þ C</formula><p>where A ssrmp ða; b; c a ; c b Þ denotes the set of all possible alignments between a pair of read mapping profiles c a and c b , taking the primary and secondary sequence structures between a pair of RNA sequences a and b into account, and w rmp ð0 w rmp 1Þ is a parameter that controls the weight of the read mapping profile alignment and the sequence alignment. The 'optimal' alignment b h can be obtained by maximizing the expected gain function E hja;b;c a ;c b ½Gðh; b hÞ on the basis of the MEA principle. Further, the maximization of the expected gain function can be efficiently implemented using the techniques such as 'dual decomposition', 'subgradient optimization' and 'dynamic programming' (see<ref type="bibr" target="#b21">Sato et al., 2012</ref>for more details).</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.4">Similarity score calculation between read mapping profiles</head><formula>c a i þ c a iþ1 2 2 v u u u u t Á ffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffi X b</formula><formula>2 ! 2 v u u u u t</formula><p>The similarity score Smðc a ; c b Þ is exactly equal to the normalized inner product (cosine coefficient) of two gap-inserted read mapping profiles in the alignment b h. Therefore, Smðc a ; c b Þ represents the correlation coefficient between two read mapping profiles c a and c b based on the alignment b h.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3">Results</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.1">Datasets</head><p>In order to evaluate the performance of our method, we generated simulated read data in the form of typical next-generation sequencing output (based on an Illumina-type of short sequence reads). To evaluate the clustering ability to detect similar processing patterns, the labeled data of various classes of different processing patterns are required, such as 5 0-end processing, 3 0-end processing and nonprocessing. However, comprehensive annotations of such labels for all small non-coding RNAs are not available in existing real data such as the sequence read archive. The only exception is the miRNA family, for which the mature miRNA annotations are accessible in the NCBI Reference Sequence Database. First, we obtained the small RNA annotation and sequence data for miRNAs (24 genes), snoRNAs (37 genes) and tRNAs (41 genes) with a length less than 120 nt from the Ensembl genome browser for the mouse genome (GRCm38). Second, according to the results of previous studies that analyzed and identified the existence of various types of small RNA-derived fragments (<ref type="bibr" target="#b0">Chen and Heard, 2013;</ref><ref type="bibr" target="#b7">Kawaji et al., 2008;</ref><ref type="bibr" target="#b17">Ono et al., 2011;</ref><ref type="bibr" target="#b23">Scott et al., 2012</ref>), we determined the start or end sites of derived fragments that simulated 5 0end processing or 3 0-end processing in snoRNAs and tRNAs to be within a few bases from the 5 0-end or 3 0-end, respectively. Further, we set the length of the derived fragments to 20 nt for snoRNAs and to 30 nt for tRNAs. For miRNAs, we used the annotations for mature miRNAs in the NCBI Reference Sequence Database. Third, we generated 88 324 simulated sequence reads that contain the fulllength transcripts of snoRNAs and tRNAs (that is, the complete sequence reads exactly identical to the annotated snoRNA and tRNA sequences), mature miRNAs and their derived fragments. In addition, the set of 'degradation reads' was artificially constructed from the simulated complete reads of snoRNAs and tRNAs. In general, there are three major classes of RNA-degrading enzymes (<ref type="bibr" target="#b6">Houseley and Tollervey, 2009</ref>): endonucleases that cut RNA internally, 5 0 exonucleases that hydrolyze RNA from the 5 0-end and 3 0 exonucleases that degrade RNA from the 3 0-end. In our study, we only considered the degradation of RNA from the 3 0-end, which is more reflective of non-functional degradation for unstable RNAs. Thus, the set of degradation reads was obtained by eliminating 40–60% of the nucleotides from the 3 0-end in order to simulate the degradation process. The degradation reads constituted 20% of the set of simulated complete reads. In total, the simulated read dataset consisted of the complete reads of snoRNAs and tRNAs, the derived fragment reads for 5 0-end processing of miRNAs, snoRNAs and tRNAs, the derived fragment reads for 3 0-end processing of miRNAs, snoRNAs and tRNAs, and the degradation reads. Each of the 102 small RNAs SHARAKU i373 used for the simulated data was labeled according to one of the above-mentioned classes as follows:</p><p>(<ref type="figure" target="#fig_0">Figure S1</ref>that displays all read mapping profiles obtained by mapping the simulated read data to the 102 annotated small RNA sequences.) To demonstrate the practical usefulness of SHARAKU, we used a real dataset obtained from an RNA-seq experiment of the hippocampus of the left brain of a 2-year-old male common marmoset that was being bred at the Central Institute for Experimental Animals (CIEA). The total RNA was extracted and was subject to removal of rRNA and 5 0 Cap, and then the cDNA library of small RNA was prepared using the TruSeq Small RNA Sample Prep Kit (Illumina). The small RNA transcripts were sequenced with the next-generation sequencer MiSeq (Illumina) for a sequence read length of 270 bp, which enabled generating the complete sequences of most small RNA families. The short reads were subject to cutting adapters and quality filtering. The qualified reads were then mapped to the common marmoset (Callithrix jacchus) draft genome caljac3.2 (<ref type="bibr">MGSAC, 2014</ref>) by BWA (<ref type="bibr" target="#b11">Li and Durbin, 2009</ref>). The tRNA annotation was predicted by tRNAscan-SE (<ref type="bibr" target="#b12">Lowe and Eddy, 1997</ref>). In total, the annotation and sequence data for 619 non-coding small RNAs were obtained (194 miRNAs, 316 snoRNAs, 109 tRNAs) from the Ensembl genome browser (Ensembl 73 version; 'Callithrix_jacchus.C_jacchus3.2.1.73.gtf' file) for the common marmoset genome (C_jacchus3.2.1).</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.2">Validation of clustering accuracy with the simulated dataset</head><p>We validated the clustering performance based on our alignment method for all pairs of read mapping profiles using the simulated dataset. First, the similarity score matrix for all pairs of read mapping profiles was calculated by SHARAKU. We used empirically determined parameters: b ¼ À3:0; w rmp ¼ 1:0; w ss ¼ 4:0; r ¼ 0:0; s ¼ 0:2. Second, the (agglomerative) hierarchical clustering method with group averaging was applied based on the similarity matrix. The agglomerative method of hierarchical clustering hclust implemented in the R-package was used for subsequent analysis. We evaluated how well each processing pattern and RNA family in the simulated dataset was separated into a distinct cluster according to the hierarchical clustering. Furthermore, we compared the clustering performance based on SHARAKU with that of the alignmentbased method deepBlockAlign (<ref type="bibr" target="#b9">Langenberger et al., 2012</ref>) using the default parameters. As the input to deepBlockAlign, the output of blockbuster executed on the input of the simulated dataset was given together with the sequence annotation information. In the case of the simulated dataset, this does not affect the result of performance evaluation, because the sequence reads (except for shorter derived RNAs) in the simulated dataset are identical to the complete RNA sequences annotated in the Ensembl genome browser, so that every block that is output by blockbuster with the input of the simulated dataset is identical to one of the annotated RNA sequences. Note that since another alignment-based scoring system ALPS (<ref type="bibr" target="#b2">Erhard and Zimmer, 2010</ref>) was not publicly available, we did not compare the performance with ALPS. In the validation experiment using the simulated read dataset, the simulated reads were mapped to the mouse genome (GRCm38) by BWA (<ref type="bibr" target="#b11">Li and Durbin, 2009</ref>) with the default parameters, except that-a bwtsw was set as the bwa index. From the output in BAM format, the normalized read mapping profiles for non-coding RNAs were obtained and fed to the alignment programs. We evaluated the overall quality of the clustering tree using the receiver operating characteristic (ROC) analysis proposed in (<ref type="bibr" target="#b27">Will et al., 2007</ref>). (Note that we can obtain different resultant clusters from a clustering tree depending on a distance threshold to cut the branches.) Given a distance threshold, the number of true positives (TP) was defined as the number of read mapping profile pairs that have the same class label and are correctly assigned to the same resultant cluster. In the same manner, the numbers of false positives (FP), true negatives (TN) and false negatives (FN) are defined by counting the pairs from different class labels but the same resultant cluster, the pairs from different class labels and different resultant clusters, and the pairs from the same class label but different resultant clusters, respectively. The ROC analysis was performed by plotting the true positive rates TP/(TP þ FN) versus the false positive rates FP/(TN þ FP) for different distance thresholds. The quality of the clustering was measured by the area under the ROC curve (AUC).<ref type="figure" target="#tab_1">Table 1</ref>shows the results of AUC scores obtained with the three methods, and<ref type="figure" target="#fig_8">Figure 2</ref>(left) shows the ROC curves generated by SHARAKU and deepBlockAlign. The AUC scores to indicate the clustering abilities of three methods were calculated for the dataset of all read mapping profiles (the mixture of read mapping profiles of miRNAs, snoRNAs and tRNAs) and for the dataset of read mapping profiles of each family, tRNA, snoRNA and miRNA. For the dataset of all read mapping profiles, SHARAKU achieved an almost perfect AUC score, and hence an almost perfect clustering result, and exhibited higher accuracy than deepBlockAlign. SHARAKU also succeeded in completely discriminating the degradation pattern from post-transcriptional processing such as 5 0 or 3 0-end processing. The alignment obtained by SHARAKU without considering the primary and secondary sequence structures ('SHARAKU without DAFS') presented lower AUC scores, which implied that incorporation of the sequence structure information is required to achieve highthe dataset of read mapping profiles of each family, both SHARAKU and deepBlockAlign achieved an AUC score of 1.0, which indicates a perfect clustering result. This result, together with that obtained for all read mapping profiles, clearly indicates that the alignment incorporating the secondary structures is indispensable for the accurate clustering of read mapping profiles generated from the mixture of different RNA families.<ref type="figure" target="#fig_8">Figure 2</ref>(right) shows an alignment produced by SHARAKU for a pair of RNAs (Mir92-1 and SNORD63) in the simulated dataset that could be successfully separated into two different clusters by SHARAKU, but were clustered together by deepBlockAlign, thereby highlighting the importance of taking the secondary structures into account for alignments of read mapping profiles. (More alignments are also shown in Supplemental Figs S2 and S3.)<ref type="figure" target="#tab_2">Table 2</ref>shows the computational times required by the three methods for each simulated dataset.<ref type="figure" target="#tab_2">Table 2</ref>indicates that SHARAKU needs a large amount of additional computational time compared with deepBlockAlign and SHARAKU without DAFS to simultaneously align the read mapping profiles and RNA sequences and calculate the secondary structures.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.3">Clustering a real dataset of RNA transcripts in the marmoset brain</head><p>A total of 33.8 million (M) sequence reads with a length of 270 bp for small non-coding RNAs was generated using an Illumina MiSeq sequencer. After quality filtering, 30.5 M reads were mapped to the common marmoset (Callithrix jacchus) draft genome caljac-3.2 using BWA. From the output in BAM format, the normalized read mapping profiles for 619 non-coding RNAs were obtained and fed to the alignment programs. The dendrogram of clustering tree of hierarchical clustering based on the SHARAKU alignments of read mapping profiles of the 619 non-coding RNAs is shown in<ref type="figure" target="#fig_9">Figure 4</ref>. Most of the read mapping profiles were clustered and well separated into five major clusters, representing (1) 3 0-end processing of miRNAs (containing 80 miRNAs); (2) 5 0-end processing of snoRNAs and tRNAs (containing 25 snoRNAs, 62 tRNAs and 5 miRNAs); (3) non-processing and non-degradation of snoRNAs and tRNAs (containing 210 snoRNAs, 10 tRNAs and 1 miRNA); (4) degradation of snoRNAs and tRNAs (containing 42 snoRNAs, 20 tRNAs and 1 miRNA); and (5) 5 0-end processing of miRNAs (containing 81 miRNAs and 2 tRNAs). In addition, the read mapping profiles representing 3 0-end processing of snoRNAs and tRNAs (containing 26 snoRNAs, 3 tRNAs and 3miRNAs) were scattered into four different clusters (6-1), (6-2), (6-3) and (6-4). These 4 clusters could be defined as the complement of the clusters (3) and (4), which might provide a clear interpretation. A representative read mapping profile in each cluster is shown below the clustering tree. Interestingly, 60% of the tRNAs were processed for deriving shorter fragments mostly at the 5 0-ends, whereas 80% of the snoRNAs were non-processed. A few other interesting small clusters were obtained and will be discussed below. In addition to confirming the utility of the new algorithm, this experiment revealed the post-transcriptional processing and the expression patterns of small derived RNAs in the marmoset brain. To the best of our knowledge, this represents the first identification of the processing patterns of derived RNAs expressed in the brain. The result of hierarchical clustering based on the deepBlockAlign alignments is shown in Supplemental<ref type="figure" target="#fig_9">Figure S4</ref>.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.4">Verification of small derived RNA transcripts by northern blotting</head><p>In order to verify that a derived RNA fragment predicted by the clustering method based on SHARAKU is truly derived and expressed and not an experimental artifact, we performed northern blotting analysis with a sample of the marmoset spleen. A small RNA-seq analysis for the total RNAs extracted from the marmoset spleen was executed and northern blotting for Leu-CAA-tRNA was performed. The read mapping profile of this Leu-CAA-tRNA belonged to a cluster representing 5 0-end processing of tRNAs in the hierarchical clustering tree generated by SHARAKU.<ref type="figure">Figure 3</ref>shows the read mapping profile for Leu-CAA-tRNA obtained from the RNA-seq reads (left), as well as the northern blots for Leu-CAAtRNA (lenght: 105 nt) and the derived fragment (expected length: 35 nt) from the tRNA (right). The results clearly proved the actual presence of the derived RNA fragment.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4">Discussion</head><p>Several previous studies (<ref type="bibr" target="#b17">Ono et al., 2011;</ref><ref type="bibr" target="#b22">Scott and Ono, 2011</ref>) have explored the similarities and evolutionary relationships between snoRNAs and miRNA precursors. As a result, various relationships between snoRNAs and miRNAs have been identified, from 'snoRNAs with miRNA features' to 'dual function snomiRNAs' and 'miRNAs with snoRNA features'. These similarity features represent molecules involved in the same processing pathways with a similar set of processing enzymes and the same RNAi targets. These similarity features are often confirmed based on the conservation of their primary and secondary structures, such as structural characteristics of typical H/ACA or C/D boxes. We hypothesized that in addition to sequence structure conservation, determining the similarity among read mapping profiles might helpwere added to the hybridization chamber and incubated with the blots. The membrane was then exposed to a phosphoimager and scanned. The largest band appearing at a distance just short of the 100-nt marker indicates the expression of the origin tRNA from which the short fragment RNA was derived SHARAKU i375 to identify the functional or processing similarities between snoRNAs and miRNA precursors. An interesting small cluster in the clustering tree shown in<ref type="figure" target="#fig_9">Figure 4</ref>(highlighted with an arrow and asterisk) consisted of a mixture of snoRNAs, miRNAs and tRNAs. In particular, we found that the snoRNA 'HBII-52' and the miRNA 'let-7a' have quite similar features in their secondary structures and read mapping profiles, indicating a similar processing mechanism to produce the derived shorter fragments at 3 0-ends.<ref type="figure" target="#fig_10">Figure 5</ref>shows these features. Indeed, small derived RNAs from HBII-52 were previously reported to resemble miRNAs (<ref type="bibr" target="#b0">Chen and Heard, 2013</ref>). Another interesting cluster is cluster (6) of the 5 0-end processing of miRNAs. The cluster contained two tRNAs. 'Pro-TGG-tRNA' has the typical miRNA-like secondary structure and miRNA/ miRNA* duplex, shown in<ref type="figure">Figure 6</ref>. Supporting this result, previous work has indicated possible cross-talk between tRNA-derived RNA fragments and the canonical pathway of miRNAs (<ref type="bibr" target="#b24">Sobala and Hutvagner, 2011</ref>). Thus, the alignments and clustering of read mapping profiles using SHARAKU can give insight into revealing the common processing patterns in different families of non-coding RNAs and their derived fragments, which could help to clarify the processing pathways and biological functions of derived RNA fragments. One of the merits of SHARAKU is to calculate the optimal alignment based on not only the pattern of read mapping profiles, but also primary and secondary structures of RNA sequences. Since each type of derived RNA fragments is cleaved from its precursor with a specific context of primary sequence and secondary structure, we can expect that the simultaneous alignment of read mapping profiles with the primary and secondary structures contributes to precise identifications of the type of derived RNAs. To combine the pattern of read mapping profiles and the primary and secondary structures of RNAs, a Sankoff-type algorithm is required to be implemented. We implemented SHARAKU with DAFS framework, which enabled to efficiently combine the pattern of read mapping profiles and the primary and secondary structures of RNAs by the dual decomposition technique. In the present study, we have only dealt with annotated noncoding RNAs. However, SHARAKU can also be applied to the alignment and clustering of novel and unannotated regions by employing tools such as blockbuster (<ref type="bibr" target="#b8">Langenberger et al., 2009</ref>) in order to determine the expressed block regions on the reference genome that are obtained from RNA-seq reads. As non-functional degradation products, we only considered the degradation of RNA from the 3 0-end in the simulated dataset. Therefore, performance evaluations of SHARAKU to determine the tolerance for the other two classes of RNA-degradations, endonucleases and 5 0 exonucleases, are required. These issues will be addressed in our future work.<ref type="bibr" target="#b4">Hofacker, 2003</ref>) and annotations with lines indicating the predicted locations of deriving fragments for a snoRNA 'HBII-52' and a miRNA 'let-7a' found in the clusters. The line for miRNA secondary structure indicate the predicted locations of the mature miRNA<ref type="figure">Fig. 6</ref>. The secondary structures predicted by RNAfold and annotations, with lines indicating the locations of derived fragments for a tRNA 'Pro-TGG-tRNA' and an miRNA 'let-7b' found in the cluster of the 5 0-end processing of miRNAs. The line for miRNA secondary structure indicates the predicted locations of the mature miRNA i376 M.Tsuchiya et al.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5">Conclusion</head><p>With the aim of offering computational tools for comprehensively analyzing the post-transcriptional processing patterns of non-coding RNAs and detecting their common processing patterns, based on RNA-seq, we developed a new algorithm called SHARAKU to align two read mapping profiles of next-generation sequencing data for non-coding RNAs. SHARAKU incorporates the primary and secondary structures of RNA sequences into an alignment of read mapping profiles by combining with DAFS, which constructs reliable structural alignments that maximize the expected accuracy of a predicted common secondary structure and its sequence alignment. SHARAKU could simultaneously align the read mapping profiles and RNA sequences with information of the folded RNA secondary structures. In an experiment using a simulated dataset, SHARAKU achieved an almost perfect clustering result, and exhibited higher accuracy than deepBlockAlign. In an experiment with real data of small RNA sequencing for the common marmoset brain, SHARAKU succeeded in identifying the five major clusters plus four scattered clusters representing typical processing patterns. This method also revealed some interesting clusters consisting of mixtures of several RNA families that predicted common processing patterns among different RNA families. These results demonstrate that SHARAKU can be an indispensable tool for analyses of the processing patterns and functions of regulatory non-coding RNAs with deep-sequencing data.</p></div><figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_0"><head>Fig.1.</head><figDesc>Fig. 1. (a) Schematic illustration of a derived RNA fragment and the mapping pattern obtained from sequencing. (b) Read mapping profile and calculation of coverage. (c) An alignment of two read mapping profiles for SNORD14 and SNORD21 output by SHARAKU, using the small RNA-seq data for the common marmoset brain with the annotations of RNA sequence alignment and the predicted secondary structure. The solid line represents the read coverages of SNORD14, and the dashed line represents the read coverages of SNORD21. (d) Schematic illustration of the necessity of incorporating the primary and secondary structures of RNA sequences into an alignment</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_4"><head>where</head><figDesc>A rmp ðc a ; c b Þ denotes the set of all possible alignments between a pair of read mapping profiles c a and c b , and sðc a ; c b ; tÞ denotes the score of an alignment t 2 A rmp ðc a ; c b Þ between c a and c b :</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_5"><head>where</head><figDesc>c r and c l define the maximum number of gaps inserted at a row and column in the alignment, respectively. The expectation E hja;b;c a ;c b ½Gðh; b hÞ of the gain function Gðh; b hÞ for the correct alignment of read mapping profiles, correct sequence alignments and correct secondary structures under a given probability distribution over the space A ssrmp ða; b; c a ; c b Þ of simultaneous alignments of read mapping profiles, RNA primary sequences and secondary structures is defined and approximated as follows:</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_6"><head></head><figDesc>Let b h be the alignment for a pair of read mapping profiles, c a and c b , obtained by maximizing the expected gain function E hja;b;c a ;c b ½Gðh; b hÞ. We define the similarity score function denoted Smðc a ; c b Þ between c a and c b based on the alignment b h as follows:</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_8"><head>Fig.2.</head><figDesc>Fig. 2. (Left.) ROC curves representing the true positive rates versus false positive rates based on clustering trees generated by SHARAKU and deepBlockAlign. The solid line represents the ROC curve of SHARAKU, and the dashed line represents the ROC curve of deepBlockAlign. (Right.) An alignment produced by SHARAKU for a pair of RNAs (Mir92-1 and SNORD63) in the simulated dataset with the annotations of RNA sequence alignment and the predicted secondary structure. The solid line represents the read coverages of Mir92-1, and the dashed line represents the read coverages of SNORD63</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_9"><head>Fig.4.</head><figDesc>Fig. 4. Dendrogram of hierarchical clustering based on SHARAKU alignments for the read mapping profiles of 619 non-coding RNAs. Annotations of 5 major clusters plus 4 scattered clusters and a representative read mapping profile in each cluster are shown below the clustering tree</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_10"><head>Fig.5.</head><figDesc>Fig. 5. The secondary structures predicted by RNAfold (Hofacker, 2003) and annotations with lines indicating the predicted locations of deriving fragments for a snoRNA 'HBII-52' and a miRNA 'let-7a' found in the clusters. The line for miRNA secondary structure indicate the predicted locations of the mature miRNA</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_1" validated="false"><figDesc>Table 1.</figDesc><table>AUC scores of the discrimination accuracy based on clus-
tering trees constructed by three methods 

SHARAKU 
deepBlockAlign 
SHARAKU without 
DAFS 

ALL 
0.985 
0.921 
0.930 
tRNA 
1.0 
1.0 
1.0 
snoRNA 
1.0 
1.0 
1.0 
miRNA 
1.0 
1.0 
0.497 </table></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_2" validated="false"><figDesc>Table 2. CPU times (seconds) required by the three methods for each simulated dataset. The CPU time was measured per alignment of a pair of read mapping profiles</figDesc><table>SHARAKU 
deepBlockAlign 
SHARAKU without 
DAFS 

ALL 
0.832 
0.054 
0.067 
tRNA 
0.495 
0.036 
0.036 
snoRNA 
0.683 
0.039 
0.047 
miRNA 
0.554 
0.029 
0.051 

0 
2 0 
4 0 
6 0 
8 0 
100 

0 
500 1000 1500 2000 2500 

Base 

coverage 

Fig. 3. (Left) Read mapping profile of Leu-CAA-tRNA from RNA-seq for the 
marmoset spleen. (Right) Northern blots for Leu-CAA-tRNA (lenght 105 nt) 
and the derived fragments. The band indicated with the arrow represents the 
expected size (35 nt) of the predicted derived RNA fragment. Blots were pre-
hybridized, then probes which had been end-labeled with [c À32 P] ATP </table></figure>

			<note place="foot">V C The Author 2016. Published by Oxford University Press. i369 This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (http://creativecommons.org/licenses/by-nc/4.0/), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com Bioinformatics, 32, 2016, i369–i377 doi: 10.1093/bioinformatics/btw273 ISMB 2016 at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>

			<note place="foot">M.Tsuchiya et al. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>

			<note place="foot">at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>

			<note place="foot">Previously, we developed DAFS (Sato et al., 2012), an algorithm that simultaneously aligns and folds RNA sequences on the basis of maximizing the expected accuracy (MEA) of a predicted common secondary structure and its alignment. That is, DAFS calculates the maximization of the expected accuracy over all possible structural alignments of a pair of RNA sequences. Then, DAFS finds one optimal structural alignment, i.e. the most accurate structural alignment with the most plausible secondary structure of each input RNA sequence. Here, we combine the alignment algorithm for read mapping profiles with DAFS according to the same MEA principle in order to incorporate the primary and secondary sequence structures into the alignment of read mapping profiles. For an RNA sequence a ¼ a 1 a 2 Á Á Á a m 2 R Ã , let jaj denote the number of bases appearing in a, which is called the length of a. Given two RNA sequences a; b 2 R Ã , let Aða; bÞ denote the set of all possible alignments of a and b, that is, RNA sequence alignments without considering the secondary structures. Let SðaÞ and SðbÞ denote the set of all possible secondary structures of a and the set of all possible secondary structures of b, respectively. An alignment t 2 Aða; bÞ is represented as a jaj Â jbj binary-valued matrix t ¼ ðt ik Þ, where t ik ¼ 1 if and only if the base a i is aligned (matched) with b k. A secondary structure x 2 SðaÞ is represented as a jaj Â jaj</note>
		</body>
		<back>

			<div type="acknowledgement">
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Acknowledgements</head><p>We thank Dr. Erika Sasaki and Takashi Inoue (CIEA, Japan) for providing the common Marmoset sample.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Funding</head><p>This work was supported by a Grant-in-Aid for Scientific Research in Innovative Areas<ref type="bibr">[No. 221S0002]</ref>from the Ministry of Education, Culture, Sports, Science and Technology of Japan (MEXT) to Y.S., and a Grant-in-Aid for Scientific Research (A) (KAKENHI)<ref type="bibr">[No. 23241066]</ref>from the JSPS to Y.S. and K.S., and supported by a Grant-in-Aid for Scientific Research (C) (KAKENHI)<ref type="bibr">[No. 25330348]</ref></p></div>
			</div>

			<div type="references">

				<listBibl>

<biblStruct   xml:id="b0">
	<analytic>
		<title level="a" type="main">Small RNAs derived from structural noncoding RNAs</title>
		<author>
			<persName>
				<forename type="first">C</forename>
				<forename type="middle">J</forename>
				<surname>Chen</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">E</forename>
				<surname>Heard</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Methods</title>
		<imprint>
			<biblScope unit="volume">63</biblScope>
			<biblScope unit="page" from="76" to="84" />
			<date type="published" when="2013" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b1">
	<monogr>
		<title level="m" type="main">Biological Sequence Analysis: Probabilistic Models of Proteins and Nucleic Acids</title>
		<author>
			<persName>
				<forename type="first">R</forename>
				<surname>Durbin</surname>
			</persName>
		</author>
		<imprint>
			<date type="published" when="1998" />
			<publisher>Cambridge University Press</publisher>
			<pubPlace>Cambridge, UK</pubPlace>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b2">
	<analytic>
		<title level="a" type="main">Classification of ncRNAs using position and size information in deep sequencing data</title>
		<author>
			<persName>
				<forename type="first">F</forename>
				<surname>Erhard</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">R</forename>
				<surname>Zimmer</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">26</biblScope>
			<biblScope unit="page" from="426" to="432" />
			<date type="published" when="2010" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b3">
	<analytic>
		<title level="a" type="main">Human tRNA-derived small RNAs in the global regulation of RNA silencing</title>
		<author>
			<persName>
				<forename type="first">D</forename>
				<surname>Haussecker</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">RNA</title>
		<imprint>
			<biblScope unit="volume">16</biblScope>
			<biblScope unit="page" from="673" to="695" />
			<date type="published" when="2010" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b4">
	<analytic>
		<title level="a" type="main">Vienna RNA secondary structure server</title>
		<author>
			<persName>
				<forename type="first">I</forename>
				<forename type="middle">L</forename>
				<surname>Hofacker</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nucleic Acids Res</title>
		<imprint>
			<biblScope unit="volume">25</biblScope>
			<biblScope unit="page" from="955" to="964" />
			<date type="published" when="2003" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b5">
	<analytic>
		<title level="a" type="main">FlaiMapper: computational annotation of small ncRNA-derived fragments using RNA-seq high-throughput data</title>
		<author>
			<persName>
				<forename type="first">Y</forename>
				<surname>Hoogstrate</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="page" from="31" to="665" />
			<date type="published" when="2015" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b6">
	<analytic>
		<title level="a" type="main">The many pathways of RNA degradation</title>
		<author>
			<persName>
				<forename type="first">J</forename>
				<surname>Houseley</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">D</forename>
				<surname>Tollervey</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Cell</title>
		<imprint>
			<biblScope unit="volume">136</biblScope>
			<biblScope unit="page" from="763" to="776" />
			<date type="published" when="2009" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b7">
	<analytic>
		<title level="a" type="main">Hidden layers of human small RNAs</title>
		<author>
			<persName>
				<forename type="first">H</forename>
				<surname>Kawaji</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">BMC Genomics</title>
		<imprint>
			<biblScope unit="volume">9</biblScope>
			<biblScope unit="page">157</biblScope>
			<date type="published" when="2008" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b8">
	<analytic>
		<title level="a" type="main">Evidence for human microRNA-offset RNAs in small RNA sequencing data</title>
		<author>
			<persName>
				<forename type="first">D</forename>
				<surname>Langenberger</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">25</biblScope>
			<biblScope unit="page" from="2298" to="2301" />
			<date type="published" when="2009" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b9">
	<analytic>
		<title level="a" type="main">deepBlockAlign: a tool for aligning RNA-seq profiles of read block patterns</title>
		<author>
			<persName>
				<forename type="first">D</forename>
				<surname>Langenberger</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">28</biblScope>
			<biblScope unit="page" from="17" to="24" />
			<date type="published" when="2012" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b10">
	<analytic>
		<title level="a" type="main">A novel class of small RNAs: tRNA-derived RNA fragments (tRFs)</title>
		<author>
			<persName>
				<forename type="first">Y</forename>
				<forename type="middle">S</forename>
				<surname>Lee</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Genes Dev</title>
		<imprint>
			<biblScope unit="volume">23</biblScope>
			<biblScope unit="page" from="2639" to="2649" />
			<date type="published" when="2009" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b11">
	<analytic>
		<title level="a" type="main">Fast and accurate short read alignment with Burrows-Wheeler transform</title>
		<author>
			<persName>
				<forename type="first">H</forename>
				<surname>Li</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">R</forename>
				<surname>Durbin</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">25</biblScope>
			<biblScope unit="page" from="1754" to="1760" />
			<date type="published" when="2009" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b12">
	<analytic>
		<title level="a" type="main">tRNAscan-SE: a program for improved detection of transfer RNA genes in genomic sequence</title>
		<author>
			<persName>
				<forename type="first">T</forename>
				<forename type="middle">M</forename>
				<surname>Lowe</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">S</forename>
				<forename type="middle">R</forename>
				<surname>Eddy</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nucleic Acids Res</title>
		<imprint>
			<biblScope unit="volume">25</biblScope>
			<biblScope unit="page" from="955" to="964" />
			<date type="published" when="1997" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b13">
	<analytic>
		<title level="a" type="main">The common Marmoset genome provides insight into primate biology and evolution</title>
	</analytic>
	<monogr>
		<title level="j">Marmoset Genome Sequencing and Analysis Consortium. Nat. Genet</title>
		<imprint>
			<biblScope unit="volume">5</biblScope>
			<biblScope unit="page">12062</biblScope>
			<date type="published" when="2014" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b14">
	<analytic>
		<title level="a" type="main">Beyond microRNA–novel RNAs derived from small non-coding RNA and their implication in cancer</title>
		<author>
			<persName>
				<forename type="first">E</forename>
				<forename type="middle">S</forename>
				<surname>Martens-Uzunova</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Cancer Lett</title>
		<imprint>
			<biblScope unit="volume">340</biblScope>
			<biblScope unit="page" from="201" to="211" />
			<date type="published" when="2013" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b15">
	<analytic>
		<title level="a" type="main">The equilibrium partition function and base pair binding probabilities for RNA secondary structure</title>
		<author>
			<persName>
				<forename type="first">J</forename>
				<forename type="middle">S</forename>
				<surname>Mccaskill</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Biopolymers</title>
		<imprint>
			<biblScope unit="volume">29</biblScope>
			<biblScope unit="page" from="1105" to="1119" />
			<date type="published" when="1990" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b16">
	<analytic>
		<title level="a" type="main">Genome-wide searching with base-pairing kernel functions for noncoding RNAs: computational and expression analysis of snoRNA families in Caenorhabditis elegans</title>
		<author>
			<persName>
				<forename type="first">K</forename>
				<surname>Morita</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nucleic Acids Res</title>
		<imprint>
			<biblScope unit="volume">37</biblScope>
			<biblScope unit="page" from="999" to="1009" />
			<date type="published" when="2009" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b17">
	<analytic>
		<title level="a" type="main">Identification of human miRNA precursors that resemble box C/D snoRNAs</title>
		<author>
			<persName>
				<forename type="first">M</forename>
				<surname>Ono</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nucleic Acids Res</title>
		<imprint>
			<biblScope unit="volume">39</biblScope>
			<biblScope unit="page" from="3879" to="3891" />
			<date type="published" when="2011" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b18">
	<analytic>
		<title level="a" type="main">Differential and coherent processing patterns from small RNAs</title>
		<author>
			<persName>
				<forename type="first">S</forename>
				<surname>Pundhir</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">J</forename>
				<surname>Gorodkin</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Sci. Rep</title>
		<imprint>
			<biblScope unit="volume">5</biblScope>
			<biblScope unit="page">12062</biblScope>
			<date type="published" when="2015" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b19">
	<analytic>
		<title level="a" type="main">Emerging applications of read profiles towards the functional annotation of the genome</title>
		<author>
			<persName>
				<forename type="first">S</forename>
				<surname>Pundhir</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Front. Genet</title>
		<imprint>
			<biblScope unit="volume">6</biblScope>
			<biblScope unit="page">188</biblScope>
			<date type="published" when="2015" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b20">
	<analytic>
		<title level="a" type="main">Protein homology detection using string alignment kernels</title>
		<author>
			<persName>
				<forename type="first">H</forename>
				<surname>Saigo</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">20</biblScope>
			<biblScope unit="page" from="1682" to="1689" />
			<date type="published" when="2004" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b21">
	<analytic>
		<title level="a" type="main">DAFS: simultaneous aligning and folding of RNA sequences via dual decomposition</title>
		<author>
			<persName>
				<forename type="first">K</forename>
				<surname>Sato</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">28</biblScope>
			<biblScope unit="page" from="3218" to="3224" />
			<date type="published" when="2012" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b22">
	<analytic>
		<title level="a" type="main">From snoRNA to miRNA: Dual function regulatory non-coding RNAs</title>
		<author>
			<persName>
				<forename type="first">M</forename>
				<forename type="middle">S</forename>
				<surname>Scott</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">M</forename>
				<surname>Ono</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Biochimie</title>
		<imprint>
			<biblScope unit="volume">93</biblScope>
			<biblScope unit="page" from="1987" to="1992" />
			<date type="published" when="2011" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b23">
	<analytic>
		<title level="a" type="main">Human box C/D snoRNA processing conservation across multiple cell types</title>
		<author>
			<persName>
				<forename type="first">M</forename>
				<forename type="middle">S</forename>
				<surname>Scott</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nucleic Acids Res</title>
		<imprint>
			<biblScope unit="volume">40</biblScope>
			<biblScope unit="page" from="3676" to="3688" />
			<date type="published" when="2012" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b24">
	<analytic>
		<title level="a" type="main">Transfer RNA-derived fragments: origins, processing, and functions</title>
		<author>
			<persName>
				<forename type="first">A</forename>
				<surname>Sobala</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">G</forename>
				<surname>Hutvagner</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Wiley Interdiscip. Rev. RNA</title>
		<imprint>
			<biblScope unit="volume">93</biblScope>
			<biblScope unit="page" from="1987" to="1992" />
			<date type="published" when="2011" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b25">
	<analytic>
		<title level="a" type="main">Small RNAs derived from snoRNAs</title>
		<author>
			<persName>
				<forename type="first">R</forename>
				<forename type="middle">J</forename>
				<surname>Taft</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">RNA</title>
		<imprint>
			<biblScope unit="volume">15</biblScope>
			<biblScope unit="page" from="1233" to="1240" />
			<date type="published" when="2009" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b26">
	<analytic>
		<title level="a" type="main">BlockClust: efficient clustering and classification of non-coding RNAs from short read RNA-seq profiles</title>
		<author>
			<persName>
				<forename type="first">P</forename>
				<surname>Videm</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">30</biblScope>
			<biblScope unit="page" from="274" to="282" />
			<date type="published" when="2014" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b27">
	<analytic>
		<title level="a" type="main">Inferring noncoding RNA families and classes by means of genome-scale structure-based clustering</title>
		<author>
			<persName>
				<forename type="first">S</forename>
				<surname>Will</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">PLoS Comput. Biol</title>
		<imprint>
			<biblScope unit="volume">3</biblScope>
			<biblScope unit="page">65</biblScope>
			<date type="published" when="2007" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b28">
	<analytic>
		<title level="a" type="main">Angiogenin cleaves tRNA and promotes stressinduced translational repression</title>
		<author>
			<persName>
				<forename type="first">S</forename>
				<surname>Yamasaki</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Cell. Biol</title>
		<imprint>
			<biblScope unit="volume">185</biblScope>
			<biblScope unit="page" from="35" to="42" />
			<date type="published" when="2009" />
		</imprint>
	</monogr>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>