
<?xml version="1.0" encoding="UTF-8"?>
<TEI xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 /home/joey/Project/grobid/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<encodingDesc>
			<appInfo>
				<application version="0.4.2-SNAPSHOT" ident="GROBID" when="2017-08-10T23:47+0000">
					<ref target="https://github.com/kermitt2/grobid">GROBID - A machine learning software for extracting information from scholarly documents</ref>
				</application>
			</appInfo>
		</encodingDesc>
		<fileDesc>
			<titleStmt>
				<title level="a" type="main">VariantBam: filtering and profiling of next-generational sequencing data using region-specific rules</title>
			</titleStmt>
			<publicationStmt>
				<publisher/>
				<availability status="unknown"><licence/></availability>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author>
							<persName>
								<forename type="first">Jeremiah</forename>
								<surname>Wala</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="institution">The Broad Institute of Harvard and MIT</orgName>
								<address>
									<postCode>02142</postCode>
									<settlement>Cambridge</settlement>
									<region>MA</region>
									<country key="US">USA</country>
								</address>
							</affiliation>
							<affiliation key="aff1">
								<orgName type="department">Bioinformatics and Integrative Genomics</orgName>
								<orgName type="institution">Harvard University</orgName>
								<address>
									<postCode>02138</postCode>
									<settlement>Cambridge</settlement>
									<region>MA</region>
									<country key="US">USA</country>
								</address>
							</affiliation>
							<affiliation key="aff2">
								<orgName type="department" key="dep1">Department of Cancer Biology</orgName>
								<orgName type="department" key="dep2">Dana-Farber Cancer Institute</orgName>
								<address>
									<postCode>02115</postCode>
									<settlement>Boston</settlement>
									<region>MA</region>
									<country key="US">USA</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Cheng-Zhong</forename>
								<surname>Zhang</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="institution">The Broad Institute of Harvard and MIT</orgName>
								<address>
									<postCode>02142</postCode>
									<settlement>Cambridge</settlement>
									<region>MA</region>
									<country key="US">USA</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Matthew</forename>
								<surname>Meyerson</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="institution">The Broad Institute of Harvard and MIT</orgName>
								<address>
									<postCode>02142</postCode>
									<settlement>Cambridge</settlement>
									<region>MA</region>
									<country key="US">USA</country>
								</address>
							</affiliation>
							<affiliation key="aff2">
								<orgName type="department" key="dep1">Department of Cancer Biology</orgName>
								<orgName type="department" key="dep2">Dana-Farber Cancer Institute</orgName>
								<address>
									<postCode>02115</postCode>
									<settlement>Boston</settlement>
									<region>MA</region>
									<country key="US">USA</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Rameen</forename>
								<surname>Beroukhim</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="institution">The Broad Institute of Harvard and MIT</orgName>
								<address>
									<postCode>02142</postCode>
									<settlement>Cambridge</settlement>
									<region>MA</region>
									<country key="US">USA</country>
								</address>
							</affiliation>
							<affiliation key="aff2">
								<orgName type="department" key="dep1">Department of Cancer Biology</orgName>
								<orgName type="department" key="dep2">Dana-Farber Cancer Institute</orgName>
								<address>
									<postCode>02115</postCode>
									<settlement>Boston</settlement>
									<region>MA</region>
									<country key="US">USA</country>
								</address>
							</affiliation>
						</author>
						<title level="a" type="main">VariantBam: filtering and profiling of next-generational sequencing data using region-specific rules</title>
					</analytic>
					<monogr>
						<imprint>
							<date/>
						</imprint>
					</monogr>
					<idno type="DOI">10.1093/bioinformatics/btw111</idno>
					<note type="submission">Received on December 15, 2015; revised on February 19, 2016; accepted on February 22, 2016</note>
					<note>Genome analysis *To whom correspondence should be addressed. Associate Editor: John Hancock Availability and implementation: VariantBam and full documentation are available at github.com/ jwalabroad/VariantBam. Contact: rameen@broadinstitute.org Supplementary information: Supplementary data are available at Bioinformatics online.</note>
				</biblStruct>
			</sourceDesc>
		</fileDesc>
		<profileDesc>
			<abstract>
				<p>We developed VariantBam, a C þþ read filtering and profiling tool for use with BAM, CRAM and SAM sequencing files. VariantBam provides a flexible framework for extracting sequencing reads or read-pairs that satisfy combinations of rules, defined by any number of genomic intervals or variant sites. We have implemented filters based on alignment data, sequence motifs, regional coverage and base quality. For example, VariantBam achieved a median size reduction ratio of 3.1:1 when applied to 10 lung cancer whole genome BAMs by removing large tags and selecting for only high-quality variant-supporting reads and reads matching a large dictionary of sequence motifs. Thus VariantBam enables efficient storage of sequencing data while preserving the most relevant information for downstream analysis.</p>
			</abstract>
		</profileDesc>
	</teiHeader>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1">Introduction</head><p>As the cost of genome sequencing decreases, the storage and computational burden of handling large sequencing datasets is an increasing concern. Whole genome sequencing of a human genome to 30Â coverage can result in approximately 1 billion reads, requiring more than 100 GB of disk space even in the compressed BAM format (<ref type="bibr" target="#b5">Li et al., 2009</ref>). To mitigate this, the CRAM format was established to provide reference-based compression of BAM files, resulting in a 2–3Â reduction in file size (<ref type="bibr" target="#b4">Hsi-Yang Fritz et al., 2011</ref>). However, the CRAM format is not currently supported by many analysis tools, and can still leave whole-genome files at 30Â coverage at &gt; 30 GB. An alternative is to create trimmed BAM files that contain only the sequence information relevant for a particular set of scientific questions. For instance, one group may be interested in only mutations in exons, while another may be interested in only reads that support structural variants. Furthermore, depending on the quality of the sequencing library, a large fraction of the low-quality reads can be removed with little effect on downstream analyses. Even further reductions in size can be achieved by removing alignment tags or subsampling reads in areas of high coverage. Read filtering that meets all of these needs could reduce the data footprint while preserving the most relevant information in a compact file. The original BAMs could then be moved to low-cost archival storage, or retained on an external server (e.g. dbGaP) and filtered during retrieval. Read filtering can also be used directly in analysis pipelines that operate only on a subset of reads. Research questions in different fields (e.g. epigenomics, metagenomics, etc.) will tend to focus onthese issues, we developed VariantBam, a scriptable BAM/CRAM/SAM filtering tool designed to provide a robust and flexible method for retrieving custom sets of reads. VariantBam uses a hierarchical system of filtering rules to determine if a given read should be included in the output. Unique combinations of filtering rules can be applied to different genomic intervals, allowing for the needs of various analyses (e.g. SNPs, exon variants) to be met with a single pass through the sequencing file. VariantBam provides advanced filtering options not available through other filtering tools, including motif matching to a dictionary of sequences, CIGAR parsing, considerations for base-quality scores, and the ability to subsample to a maximum sequence coverage. VariantBam is written in C þþ and utilizes the rapid C htslib (github.com/samtools/htslib) to perform I/O with high efficiency. Output to BAM, CRAM, SAM and standard output is supported.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2">Methods</head><p>To be included in the final output, a read must satisfy one of a set of user-defined rules constructed from the filters listed in<ref type="figure" target="#tab_1">Table 1</ref>. VariantBam allows the construction of logic statements by combining these filters with logical AND, OR and NOT operations. VariantBam can extract reads containing an arbitrarily large dictionary of specified sequence motifs. It uses an implementation of the Aho-Corasick string-matching algorithm to find exact substrings in the sequences (sourceforge.net/projects/multifast). This enables efficient queries for dictionaries containing even hundreds of thousands of motifs (see Section 3). VariantBam can apply these rules for read profiling, keeping track of the number of reads satisfying a given rule. Read-group specific profiles can be plotted with the included R script (Supplementary<ref type="figure">Fig. S1</ref>).</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.1">Regions and mate-linking</head><p>VariantBam allows users to specify unique sets of rules on genomic intervals, input as a coordinate string, a VCF or a BED file. A read that belongs to a region and satisfies any single rule will be included in the output. Intervals can be padded to expand to the surrounding region. Regions can also be inverted, such that a read satisfying a rule in an inverted region will be excluded from the final output (e.g. remove reads in centromeres). To extract reads whose pair-mate (but not the read itself) intersects a region, we introduce the concept of 'mate-linked' regions. A read is considered a member of a mate-linked region if either itself or its pair-mate intersects the region. Coordinate queries against matelinked regions are accomplished efficiently with an interval tree. An example of using mate-linking to extract all read-pairs intersecting SNV sites is provided in<ref type="figure">Figure 1A</ref>and Supplementary<ref type="figure">Figure S2</ref>.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.2">Quality handling</head><p>Poor optical quality (Phred scores) can lead to incorrect base-pair calls in reads, which in turn will decrease the accuracy of the read alignment (<ref type="bibr" target="#b2">Ewing et al., 1998</ref>). VariantBam can apply minimum Phred score thresholds before applying rules involving read length, number of clipped bases and existence of a subsequence. For instance, using the Phred filter, a read with n soft-clipped bases containing k low-quality bases will be considered as having only n–k clipped bases (<ref type="figure">Fig. 1B</ref>). This is useful when enriching for high-quality variant supporting reads, where reads with mismatches to the reference due to their low sequence quality should be excluded.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.3">Subsampling</head><p>Sequence alignment artifacts can result in massive pileups of thousands of reads at certain low-complexity regions of the genome (<ref type="bibr" target="#b6">Ross et al., 2013</ref>). For most genome analysis applications, these low-information reads can be ignored. To remove them, VariantBam can enforce a maximum or minimum coverage for its output, randomly sub-sampling reads aligned to regions with higher coverage. To ensure that read-pairs are not separated by this subsampling, they are subsampled using a random number generated by hashing the query name. VariantBam also supports subsampling of reads at region-specific rates (e.g. subsample non-SNP sites).</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3">Results and discussion</head><p>We filtered reads for 10 BAMs, each containing reads representing a lung cancer whole genome at 60Â coverage. After completing a first pass analysis with MuTect (<ref type="bibr" target="#b1">Cibulskis et al., 2013</ref>), we used VariantBam to keep smaller BAM and CRAM files containing all read-pairs intersecting candidate variant sites, all reads with high quality soft-clips, and all reads containing any one of 700 000 twenty base-pair motifs. We also removed the large original (before recalibration) base-score tag (OQ) for further size reduction. The CPU time to apply these filters was 286 6 62 (s.d.) min per BAM. The mean size reduction ratio was 3.1:1 (Supplementary<ref type="figure">Fig. S3</ref>). We re-genotyped the full BAMs with FreeBayes v0.9.21 (<ref type="bibr" target="#b3">Garrison and Marth, 2012</ref>) in 2531 6 1175 min, and the filtered BAMs in 873 6 422 min. We further compared the performance of VariantBam to BamTools filter (<ref type="bibr" target="#b0">Barnett et al., 2011</ref>) on the 10 lung cancer tumor BAMs, using asimple filter to extract reads with mapping qualities greater than 30 and with 4 or more mismatches. VariantBam completed in 184 6 19 min and BamTools completed in 477 6 61 min. We have developed an efficient, flexible and robust filtering tool for next-generation sequencing files. The wide-array of filtering options we have described make VariantBam appropriate for filtering and profiling data across a range of bioinformatics needs. VariantBam is easy to compile and run, and is extensively documented with a number of use cases and examples.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Funding</head><p>JW receives support from the National Institutes of Health (T32 HG002295/ HG/NHGRI, U54CA143798) and the DFCI-Novartis Drug Discovery Program. JW and RB receive support from the Pediatric Low-Grade Astrocytoma Foundation. RB is also supported by the Sontag Foundation. Conflict of Interest: none declared.</p></div><figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_0" validated="false"><figDesc>V C The Author 2016. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com 2029 Bioinformatics, 32(13), 2016, 2029–2031 doi: 10.1093/bioinformatics/btw111 Advance Access Publication Date: 26 February 2016 Applications Note different subsets of the data. Efficient and accurate retrieval of those sequences would facilitate development of such analyses. To address</figDesc><table></table></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_1" validated="true"><figDesc>Table 1. VariantBam filtering options</figDesc><table>Filter 
Command 

Insert size 
isize[min,max] 
Mapping quality 
mapq[min,max] 
Phred-trimmed length 
phred[min];length[min,max] 
Alignment flags 
e.g.! qcfail 
Alignment tags 
e.g. nm[min,max], xp[min,max] 
Motif matching 
motif[dictionary file] 
CIGAR parsing 
ins[min,max]/del[min,max]/clip[min,max] 
Number of N bases 
nbases[min,max] 
Subsampling 
subsample[percentage] 
Read-pair orientation 
e.g. FR 
Retrieve all reads 
all 

Fig. 1. Example applications of two VariantBam rules. (A) A mate-linked re-
gion cov ering a SNP site. All reads and their pair-mates that intersect this re-
gion are extracted. (B) Genome-wide rule to extract high-quality clipped 
reads. Bases with low-quality Phred scores do not count as clipped bases </table></figure>

			<note place="foot">at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>

			<note place="foot">J.Wala et al. at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>
		</body>
		<back>
			<div type="references">

				<listBibl>

<biblStruct   xml:id="b0">
	<analytic>
		<title level="a" type="main">BamTools: a C þþ API and toolkit for analyzing and managing BAM files</title>
		<author>
			<persName>
				<forename type="first">D</forename>
				<forename type="middle">W</forename>
				<surname>Barnett</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">27</biblScope>
			<biblScope unit="page" from="1691" to="1692" />
			<date type="published" when="2011" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b1">
	<analytic>
		<title level="a" type="main">Sensitive detection of somatic point mutations in impure and heterogeneous cancer samples</title>
		<author>
			<persName>
				<forename type="first">K</forename>
				<surname>Cibulskis</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nat. Biotechnol</title>
		<imprint>
			<biblScope unit="volume">31</biblScope>
			<biblScope unit="page" from="213" to="219" />
			<date type="published" when="2013" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b2">
	<analytic>
		<title level="a" type="main">Base-calling of automated sequencer traces using phred. I. Accuracy assessment</title>
		<author>
			<persName>
				<forename type="first">B</forename>
				<surname>Ewing</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Genome Res</title>
		<imprint>
			<biblScope unit="volume">8</biblScope>
			<biblScope unit="page" from="175" to="185" />
			<date type="published" when="1998" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b3">
	<monogr>
		<title level="m" type="main">Haplotype-based variant detection from short-read sequencing. arXiv preprint arXiv: 1207</title>
		<author>
			<persName>
				<forename type="first">E</forename>
				<surname>Garrison</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">G</forename>
				<surname>Marth</surname>
			</persName>
		</author>
		<imprint>
			<date type="published" when="2012" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b4">
	<analytic>
		<title level="a" type="main">Efficient storage of high throughput DNA sequencing data using reference-based compression</title>
		<author>
			<persName>
				<forename type="first">Hsi-Yang</forename>
				<surname>Fritz</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">M</forename>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Genome Res</title>
		<imprint>
			<biblScope unit="volume">21</biblScope>
			<biblScope unit="page" from="734" to="740" />
			<date type="published" when="2011" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b5">
	<analytic>
		<title level="a" type="main">The Sequence Alignment/Map format and SAMtools</title>
		<author>
			<persName>
				<forename type="first">H</forename>
				<surname>Li</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">25</biblScope>
			<biblScope unit="page" from="2078" to="2079" />
			<date type="published" when="2009" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b6">
	<analytic>
		<title level="a" type="main">Characterizing and measuring bias in sequence data</title>
		<author>
			<persName>
				<forename type="first">M</forename>
				<surname>Ross</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Genome Biol</title>
		<imprint>
			<biblScope unit="volume">14</biblScope>
			<biblScope unit="page">51</biblScope>
			<date type="published" when="2013" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b7">
	<analytic>
		<title/>
	</analytic>
	<monogr>
		<title level="j">VariantBam</title>
		<imprint/>
	</monogr>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>