
<?xml version="1.0" encoding="UTF-8"?>
<TEI xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 /home/joey/Project/grobid/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<encodingDesc>
			<appInfo>
				<application version="0.4.2-SNAPSHOT" ident="GROBID" when="2017-08-10T23:51+0000">
					<ref target="https://github.com/kermitt2/grobid">GROBID - A machine learning software for extracting information from scholarly documents</ref>
				</application>
			</appInfo>
		</encodingDesc>
		<fileDesc>
			<titleStmt>
				<title level="a" type="main">Complex heatmaps reveal patterns and correlations in multidimensional genomic data</title>
			</titleStmt>
			<publicationStmt>
				<publisher/>
				<availability status="unknown"><licence/></availability>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author>
							<persName>
								<forename type="first">Zuguang</forename>
								<surname>Gu</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department">Division of Theoretical Bioinformatics</orgName>
							</affiliation>
							<affiliation key="aff1">
								<orgName type="department">German Cancer Research Center (DKFZ)</orgName>
								<orgName type="laboratory">Heidelberg Center for Personalized Oncology (DKFZ-HIPO)</orgName>
								<address>
									<settlement>Heidelberg</settlement>
									<country key="DE">Germany</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Roland</forename>
								<surname>Eils</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department">Division of Theoretical Bioinformatics</orgName>
							</affiliation>
							<affiliation key="aff1">
								<orgName type="department">German Cancer Research Center (DKFZ)</orgName>
								<orgName type="laboratory">Heidelberg Center for Personalized Oncology (DKFZ-HIPO)</orgName>
								<address>
									<settlement>Heidelberg</settlement>
									<country key="DE">Germany</country>
								</address>
							</affiliation>
							<affiliation key="aff2">
								<orgName type="department" key="dep1">Department for Bioinformatics and Functional Genomics</orgName>
								<orgName type="department" key="dep2">Institute for Pharmacy and Molecular Biotechnology (IPMB) and BioQuant</orgName>
								<orgName type="institution">Heidelberg University</orgName>
								<address>
									<settlement>Heidelberg</settlement>
									<country key="DE">Germany</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Matthias</forename>
								<surname>Schlesner</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department">Division of Theoretical Bioinformatics</orgName>
							</affiliation>
						</author>
						<title level="a" type="main">Complex heatmaps reveal patterns and correlations in multidimensional genomic data</title>
					</analytic>
					<monogr>
						<imprint>
							<date/>
						</imprint>
					</monogr>
					<idno type="DOI">10.1093/bioinformatics/btw313</idno>
					<note type="submission">Received on December 27, 2015; revised on May 12, 2016; accepted on May 13, 2016</note>
					<note>Genome analysis *To whom correspondence should be addressed. Associate Editor: John Hancock Supplementary information: Supplementary data are available at Bioinformatics online.</note>
				</biblStruct>
			</sourceDesc>
		</fileDesc>
		<profileDesc>
			<abstract>
				<p>Parallel heatmaps with carefully designed annotation graphics are powerful for efficient visualization of patterns and relationships among high dimensional genomic data. Here we present the ComplexHeatmap package that provides rich functionalities for customizing heatmaps, arranging multiple parallel heatmaps and including user-defined annotation graphics. We demonstrate the power of ComplexHeatmap to easily reveal patterns and correlations among multiple sources of information with four real-world datasets. Availability and Implementation: The ComplexHeatmap package and documentation are freely available from the Bioconductor project</p>
			</abstract>
		</profileDesc>
	</teiHeader>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1">Introduction</head><p>Heatmaps are a fundamental visualization method that is broadly used to unravel patterns hidden in genomic data. They are especially popular for gene expression analysis (<ref type="bibr" target="#b2">Eisen et al., 1998</ref>) and methylation profiling (<ref type="bibr" target="#b5">Sturm et al., 2012</ref>). With the increasing availability of genomic datasets, visualization methods that effectively show relations within multidimensional data are urgently needed. In this paper, we demonstrate how heatmaps with carefully designed annotation graphics can give great enhancement for revealing underlying data structure and how utilization of parallel heatmaps which focus on different sources of information gives a quick and comprehensive overview of the data. In the R programming environment, traditional tools for drawing heatmaps, like the basic heatmap function or add-on packages such as pheatmap or heatmapplus, only provide limited functionality to display annotation graphics and do not support plotting of multiple parallel heatmaps. The ComplexHeatmap package has been designed to overcome these limitations. It provides a general solution to juxtapose different sources of information in multiple parallel heatmaps. Each heatmap can be enhanced by multiple annotation graphics to complete the portrayal of the dataset. Both column and row annotation graphics supported in ComplexHeatmap can either be predefined graphics, e.g. points, bar plots or boxplots or more general user-defined graphics. Other features of ComplexHeatmap include: (i) flexible support for clustering. For example, rendered dendrograms (<ref type="bibr" target="#b3">Galili, 2015</ref>) or a user-defined distance function that accepts two paired vectors are supported; (ii) separating of heatmap rows into slices to support visualization of subgroups, where splitting on rows can be done either by a partitioning method, e.g. k-means clustering or a data frame that contains classifications; (iii) user-customization of the heatmap grids for more advanced visualization of complex information, e.g. the enhanced OncoPrint (<ref type="bibr" target="#b4">Gao et al., 2013</ref>) in<ref type="figure" target="#fig_0">Figure 1A</ref>; (iv) interactive selection on heatmaps to obtain subset of rows and columns if heatmaps are drawn on an interactive device (e.g. X11) and (v) the ability to add more customized graphics after heatmaps are generated. ComplexHeatmap has a modular design with a user-friendly application programming interface (API). The flexibility and extensibility of the package enables fast and easy generation of novel views of multidimensional datasets and greatly facilitates discoveries from genomic and other omics data.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2">Implementation</head><p>ComplexHeatmap is implemented in an object-oriented way. The main classes are: Heatmap: Representation of a single heatmap. The class processes the data matrix and provides methods for drawing heatmap components, i.e. the heatmap body, row/column names, titles, dendrograms and column annotations. HeatmapList: Representation of a list of heatmaps. The class adjusts graphical settings for the list of heatmaps, creates the layout and provides methods for drawing components like the heatmap legends. The 'þ' operator is used to concatenate parallel heatmaps (i.e. heatmaps in which corresponding rows in all matrices corresponds to the same object): Heatmap(matrix1,. . .) þ Heatmap(matrix2, .</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>. .)</head><p>HeatmapAnnotation: Heatmap annotation is a general and flexible concept. The only requirement for heatmap annotations is that the graphics should be aligned to columns or rows in the heatmap, respectively. The most commonly used annotation graphics are a list of grids that show different groups of the data. However, other types of graphics can also be used, e.g. it can be boxplots which visualize data distribution in corresponding rows or columns. ComplexHeatmap provides several fixed types of annotation graphics, e.g. points, bar plots and boxplots. The package also provides an API that allows users to design their own annotation graphics. Column annotations and row annotations are both encapsulated by HeatmapAnnotation class. Column annotations are components of a single heatmap: ha ¼ HeatmapAnnotation(.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>. .)</head><p>Heatmap(matrix, top_annotation ¼ ha, .</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>. .)</head><p>Row annotations are concatenated to the heatmap list by the 'þ' operator and can correspond to multiple parallel heatmaps: ha ¼ HeatmapAnnotation(.. ., which ¼ 'row') Heatmap(matrix, .</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>. .) þ ha</head><p>There is no limitation for the amount and order of heatmap annotations in the list of heatmaps.<ref type="figure" target="#fig_0">Figure 1A</ref>visualizes genomic alterations for 38 selected genes in 134 patients from the TCGA lung adenocarcinoma cohort (<ref type="bibr" target="#b1">Collisson et al., 2014</ref>) as an enhanced OncoPrint. Genes are split into two groups based on the amplification rate among patients. Bar plots are added to rows and columns to show the numbers of alterations across patients and genes, respectively. An additional heatmap on the right indicates the biological functions of the mutated genes. The combination of OncoPrint and this heatmap reveals that highly amplified genes are relatively enriched in cellular response processes, while mutated genes are enriched in processes related to development and metabolism.<ref type="figure" target="#fig_0">Figure 1B</ref>illustrates heterogeneity of mouse T-cells analyzed by single cell RNA-Seq data (<ref type="bibr" target="#b0">Buettner et al., 2015</ref>). Expression profiles of 721 selected genes classify the cells into two subpopulations. The left subpopulation (highlighted in light red in the column dendrogram) is characterized by relatively high expression of a subset of cell cycle genes, however, the absolute expression level is low. The subpopulation on the right side exhibits relatively low expression of this subset of cell cycle genes, while the other selected genes, including other cell cycle genes, are expressed at high levels. A group of ribonucleoprotein genes show very strong coexpression. Gene names of highly expressed cell cycle genes are indicated. The heatmap on the right visualizes pairwise correlations between the 721 genes. The correlation values were hierarchically clustered and the resulting row order used to define the row order of all parallel heatmaps. Supplementary File S3 visualizes correlations between methylation, gene expression, enhancers and gene-related information. The data is randomly generated based on patterns found in an unpublished work. In the heatmaps, each row corresponds to a differentially methylated region (DMR) or other objects that are associated with the DMR. These objects are, for example, the nearest gene with expression negatively correlating to the methylation level in the associated DMR, or enhancers that overlap with the DMR. The complex heatmaps reveal that highly methylated DMRs are enriched in intergenic and intragenic regions and rarely overlap with, one visualizing the distance between CpG sites and the nearest TSS, and the second visualizing annotations to CpG Islands (CGI). The heatmap is split according to the CGI annotation, revealing that the CpG sites that are in CGI Shelf and open sea have higher methylation levels and higher distance to the nearest TSS.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3">Application</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Funding</head><p>This work was supported by the German Cancer Research Center-Heidelberg Center for Personalized Oncology (DKFZ-HIPO) and the BMBF-funded de.NBI HD-HuB network (#031A537A, #031A537C). Conflict of Interest: none declared.</p></div><figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_0"><head>Fig.1.</head><figDesc>Fig. 1. Examples by ComplexHeatmap. (A) Genomic alterations and biological functions of the associated mutated genes. (B) Heterogeneity of mouse T-cells from single cell RNA-Seq data. Data sources and R code for the plots can be found at Supplementary S1 and S2</figDesc></figure>

			<note place="foot">Bioinformatics, 2016, 1–3 doi: 10.1093/bioinformatics/btw313 Advance Access Publication Date: 20 May 2016 Applications Note Bioinformatics Advance Access published June 22, 2016 at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>

			<note place="foot">Z.Gu et al. at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>

			<note place="foot">at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>
		</body>
		<back>
			<div type="references">

				<listBibl>

<biblStruct   xml:id="b0">
	<analytic>
		<title level="a" type="main">Computational analysis of cell-to-cell heterogeneity in single-cell RNA-sequencing data reveals hidden subpopulations of cells</title>
		<author>
			<persName>
				<forename type="first">F</forename>
				<surname>Buettner</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nat. Biotechnol</title>
		<imprint>
			<biblScope unit="volume">33</biblScope>
			<biblScope unit="page" from="155" to="160" />
			<date type="published" when="2015" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b1">
	<analytic>
		<title level="a" type="main">Comprehensive molecular profiling of lung adenocarcinoma</title>
		<author>
			<persName>
				<forename type="first">E</forename>
				<forename type="middle">A</forename>
				<surname>Collisson</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nature</title>
		<imprint>
			<biblScope unit="volume">511</biblScope>
			<biblScope unit="page" from="543" to="550" />
			<date type="published" when="2014" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b2">
	<analytic>
		<title level="a" type="main">Cluster analysis and display of genome-wide expression patterns</title>
		<author>
			<persName>
				<forename type="first">M</forename>
				<forename type="middle">B</forename>
				<surname>Eisen</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proc. Natl. Acad. Sci</title>
		<meeting>. Natl. Acad. Sci</meeting>
		<imprint>
			<date type="published" when="1998" />
			<biblScope unit="page" from="14863" to="14868" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b3">
	<analytic>
		<title level="a" type="main">dendextend: an R package for visualizing, adjusting, and comparing trees of hierarchical clustering</title>
		<author>
			<persName>
				<forename type="first">T</forename>
				<surname>Galili</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="page" from="31" to="3718" />
			<date type="published" when="2015" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b4">
	<analytic>
		<title level="a" type="main">Integrative analysis of complex cancer genomics and clinical profiles using the cBioPortal</title>
		<author>
			<persName>
				<forename type="first">J</forename>
				<surname>Gao</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Sci. Signal</title>
		<imprint>
			<biblScope unit="volume">6</biblScope>
			<biblScope unit="page">1</biblScope>
			<date type="published" when="2013" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b5">
	<analytic>
		<title level="a" type="main">Hotspot mutations in H3F3A and IDH1 define distinct epigenetic and biological subgroups of glioblastoma</title>
		<author>
			<persName>
				<forename type="first">D</forename>
				<surname>Sturm</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Cancer Cell</title>
		<imprint>
			<biblScope unit="volume">22</biblScope>
			<biblScope unit="page" from="425" to="437" />
			<date type="published" when="2012" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b6">
	<monogr>
		<title level="m" type="main">Complex heatmaps reveal patterns and correlations</title>
		<imprint/>
	</monogr>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>