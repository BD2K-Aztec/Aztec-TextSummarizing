
<?xml version="1.0" encoding="UTF-8"?>
<TEI xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 /home/joey/Project/grobid/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<encodingDesc>
			<appInfo>
				<application version="0.4.2-SNAPSHOT" ident="GROBID" when="2017-08-10T23:39+0000">
					<ref target="https://github.com/kermitt2/grobid">GROBID - A machine learning software for extracting information from scholarly documents</ref>
				</application>
			</appInfo>
		</encodingDesc>
		<fileDesc>
			<titleStmt>
				<title level="a" type="main">Higher classification sensitivity of short metagenomic reads with CLARK-S</title>
			</titleStmt>
			<publicationStmt>
				<publisher/>
				<availability status="unknown"><licence/></availability>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author>
							<persName>
								<forename type="first">Rachid</forename>
								<surname>Ounit</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department">Department of Computer Science and Engineering</orgName>
								<orgName type="institution">University of California</orgName>
								<address>
									<postCode>92521</postCode>
									<settlement>Riverside</settlement>
									<region>CA</region>
									<country key="US">USA</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Stefano</forename>
								<surname>Lonardi</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department">Department of Computer Science and Engineering</orgName>
								<orgName type="institution">University of California</orgName>
								<address>
									<postCode>92521</postCode>
									<settlement>Riverside</settlement>
									<region>CA</region>
									<country key="US">USA</country>
								</address>
							</affiliation>
						</author>
						<title level="a" type="main">Higher classification sensitivity of short metagenomic reads with CLARK-S</title>
					</analytic>
					<monogr>
						<imprint>
							<date/>
						</imprint>
					</monogr>
					<note>Sequence Analysis * To whom correspondence should be addressed. Supplementary information: Supplementary data are available at Bioinformatics online.</note>
				</biblStruct>
			</sourceDesc>
		</fileDesc>
		<profileDesc>
			<abstract>
				<p>The growing number of metagenomic studies in medicine and environmental sciences is creating increasing demands on the computational infrastructure designed to analyze these very large datasets. Often, the construction of ultra-fast and precise taxonomic classifiers can compromise on their sensitivity (i.e., the number of reads correctly classified). Here we introduce CLARK-S, a new software tool that can classify short reads with high precision, high sensitivity and high speed. Availability: CLARK-S is freely available at</p>
			</abstract>
		</profileDesc>
	</teiHeader>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1">Introduction</head><p>One of the primary goals of metagenomic studies is to determine the taxonomical identity of bacteria and viruses in a heterogenous microbial sample (e.g., soil, water, urban environment, human microbiome). This analysis can reveal the presence of unexpected bacteria and viruses in a newly explored microbial habitat, or in the case of the human body, elucidate relationships between diseases and imbalances in the microbiome. Arguably, the most effective and unbiased methods to study these microbial samples is via high-throughput sequencing. The associated computational problem is to assign sequenced (short) reads to a taxonomic unit. Several methods and software tools are available, but faster and more accurate algorithms are needed to keep pace with the increasing throughput of modern sequencing instruments. In<ref type="bibr" target="#b7">Ounit et al., 2015</ref>we introduced CLARK, a taxonomy-dependent binning method whose classification speed is currently unmatched. A recent independent evaluation of fourteen taxonomic binning/profiling methods (Kraken by Wood and Salzberg, 2014, MEGAN by<ref type="bibr" target="#b3">Huson et al., 2007</ref>, and many others) showed that the classification precision of CLARK is comparable (sometimes better) than the state-of-the-art classifiers (<ref type="bibr" target="#b5">Lindgreen et al., 2016</ref>). While CLARK's speed and precision are very high, its classification sensitivity (i.e., the fraction of reads that it correctly classifies) can be significantly improved with the methods described next. We recall that CLARK is a k-mer based method. Briefly, it assigns a read r to a reference genome G if r and G share more discriminative k-mers (i.e., k-mers that appear exclusively in one reference genome) than other genomes in the database. Here we show that the classification sensitivity can be increased by allowing mismatches between shared kmers in a limited number of (carefully predetermined) positions, while maintaining the requirement for k-mers to be discriminative. The idea of allowing mismatches to improve the sensitivity of seed-and-extend alignment methods was pioneered in<ref type="bibr" target="#b6">Ma et al., 2002</ref>with the notion of spaced seed. While spaced seeds have been used in some metagenomic binning/profiling methods (e.g., MEGAN), the use of discriminative spaced k-mers is novel. Here we describe an extension of the algorithmic infrastructure of CLARK based on spaced seed, called CLARK-S.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2">Methods</head><p>Given an integer k and m reference genomes {g 1 , g 2 ,. .. , gm}, the discriminative k-mers D i for genome g i is the set of all k-mers in g i that do not occur (exactly) in any other genome (<ref type="bibr" target="#b7">Ounit et al., 2015</ref>). A spaced seed s of length k and weight w &lt; k is a string over the alphabet {1,*} that contains w '1' and (k − w) '*'. Matches are required at a '1' positions, while mismatches are allowed at the '*' locations. The set of discriminative spaced k-mers E i,s is the set of all k-mers of D i that do not occur in any other set D j (j = i) when mismatches are allowed at '*' positions in s. The common model to align a short (Illumina) read r of fixed length to a reference genome G is not to allow gaps and assume that mismatches (due to genomic variations or sequencing errors) follow a Bernoulli distribution with parameter p (the similarity level between r and G) (<ref type="bibr" target="#b1">Brown et al., 2004</ref>). In such a model, the structure of the spaced seed (or multiple spaced seeds) is critical to achieve the highest possible precision and sensitivity (<ref type="bibr" target="#b6">Ma et al., 2002;</ref><ref type="bibr" target="#b1">Brown et al., 2004</ref>). Finding an optimal set of spaced seeds through w, k and p is computationally difficult (<ref type="bibr" target="#b1">Brown et al., 2004</ref>), thus we decided to reduce the space search by judiciously setting w, k and p. Since CLARK is more precise for long contiguous k-mers (e.g., k = 31), but its highest sensitivity occurs for k ∈<ref type="bibr">[19,</ref><ref type="bibr">22]</ref>, we considered spaced seeds of length k = 31 and weight w = 22. We set p = 0.95 to reflect the expected high similarity between genomic sequences at the species rank. Through an exhaustive search of all spaced seeds (with parameters k = 31, w = 22, p = 0.95) and using the dynamic programming method implemented by Ilie et al., 2011 on a region of 100bp, we selected the three spaced seeds with the highest " hit probability " (<ref type="bibr" target="#b6">Ma et al., 2002</ref>), namely 1111*111*111**1*111**1*11*11111 (hit probability 0.99811), 11111*1**111*1*11*11**111*11111 (0.998099), and 11111*1*111**1*11*111**11*11111 (0.998093). In the preprocessing stage, CLARK-S stores on disk, for each genome i and each spaced seed s, the set of discriminative spaced k-mers E i,s. Compared to CLARK's classification phase, CLARK-S requires three look-ups for each k-mer in a read (one look-up per spaced seed).</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3">Experimental Setup</head><p>As said, a recent independent evaluation of several published taxonomic binning methods showed that CLARK and Kraken are the two most accurate tools at the genus and phylum level (<ref type="bibr" target="#b5">Lindgreen et al., 2016</ref>). Instead of comparing CLARK-S to all published binning methods, it is therefore sufficient to compare it against CLARK and Kraken. To guarantee a consistent and fair evaluation, we ran CLARK-S, CLARK and Kraken on the same set of reference genomes, namely all microbial genomes in the NCBI RefSeq database (total of 5,747 species: 1,335 bacteria, 123 archaea and 4,289 viruses). Evaluations were carried out on simulated datasets and real metagenomic data, as explained next. We created six synthetic datasets, each representing a distinct microbial habitat and containing reads from the related dominant organisms (see Suppl. Note 1 for full details). We included samples from the human mouth (characterized by 12 dominant species), city parks (48 species), human gut (20 species), household (two datasets, 31 and 21 species) and soil (50 species). A seventh dataset included reads from 525 randomly chosen bacterial/archaeal species (see Suppl. Note 1). All these datasets are composed of 100bp reads generated by ART (<ref type="bibr" target="#b2">Huang et al., 2012</ref>) using the Illumina error model with default settings. Since two distinct species i and j can have sequence similarity as high as 98.8% (<ref type="bibr" target="#b7">Stackebrandt and Goebel, 1994</ref>), a short read r generated from genome g i may appear in another genome g j for a given error rate or number of mismatches. Ignoring he possibility of ambiguity in reads classification is likely to lead to incorrect conclusions on precision and sensitivity. In order to carry out an unbiased evaluation, we created additional datasets (called " unambiguous " , see Suppl. Note 2 for details) in which no read can be mapped to more than one species with the same error rate or number of mismatches. We tested the three tools on fourteen datasets containing a total of 23.5M reads from 647 species (see Suppl.<ref type="figure">Table 1</ref>). We also added three negative control samples containing short reads that do not exist in any genome in the NCBI/RefSeq database (see Suppl. Note 1). We used the precision and sensitivity metrics defined in<ref type="bibr" target="#b7">Ounit et al., 2015</ref>to evaluate the classification performance. For experiments on real metagenomes, we chose a large dataset from a recent study on the microbial profile of the NY City subway system, the Gowanus canal and public parks (<ref type="bibr" target="#b0">Afshinnekoo et al., 2015</ref>). We selected twelve datasets containing a total of 105M reads from various microbial habitat (e.g., bench, garbage can, kiosk, stairway rail, water, etc.), subway stations and riders usage (see Suppl.<ref type="figure">Table 3</ref>). While the ground truth for these data is unknown, the abundance of bacteria, eukaryotes and viruses present in these samples were provided in Afshinnekoo et al., 2015. We trimmed raw reads as it was done in Afshinnekoo et al., 2015 (see Suppl.<ref type="figure">Table 3</ref>), then compared the results of CLARK-S with the findings in Afshinnekoo et al., 2015 (see Suppl.<ref type="figure">Table 4</ref>and 5).</p></div>
			<note place="foot" n="1"> Associate Editor: Dr. Inanc Birol © The Author (2016). Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oup.com Bioinformatics Advance Access published August 18, 2016 at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>

			<note place="foot" n="4"> Results and Discussion Observe in Supplemental Table 2 that the sensitivity achieved by CLARKS on the fourteen simulated datasets is consistently higher than other tools, while maintaining high precision (the increase in sensitivity is even higher on unambiguous datasets). Also, note that CLARK-S did not classify any reads from the negative control samples. Supplemental Table 7 shows that CLARK-S classifies about 200 thousand short reads per minute (using one CPU), while CLARK classifies about 3.5M short reads per minute. If one can take advantage of eight cores, CLARK-S classifies about 1M short read per minute, which is sufficiently fast to process large metagenomic datasets in few minutes (see Suppl. Note 3). CLARK-S requires more time to build the database than CLARK or Kraken, but its RAM usage is comparable to the other tools (see Suppl. Table 8). Observe in Supplemental Table 6 (real datasets) that CLARK-S classifies more reads than CLARK or Kraken. On average, CLARKS classifies 10% more reads than Kraken, and 27% more reads than CLARK. Supplementary Table 5 indicates the reads count assigned by each tool to each species listed in Afshinnekoo et al., 2015 and present in the database. CLARK-S achieves consistently the highest agreement with Afshinnekoo et al., 2015 on all samples. For instance, in P00589 and P00720, CLARK-S detected the presence of the virus Enterobacter phage HK97 but CLARK/Kraken did not; in sample P01136, CLARK-S detected Brucella ovis but CLARK/Kraken failed to do so. In general, CLARK-S identified more relevant organisms than the other tested tools, as observed by a recent study focusing on water samples (Thompson et al., 2016).</note>

			<note place="foot">at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>
		</body>
		<back>

			<div type="acknowledgement">
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Acknowledgements</head><p>We thank Dr. Christopher E. Mason (Weill Cornell Medicine) for valuable discussions on the tools' evaluation.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Funding</head><p>Supported in part by the US National Science Foundation<ref type="bibr">[IIS-1302134, IIS-1526742]</ref>. Conflict of interest: None.</p></div>
			</div>

			<div type="references">

				<listBibl>

<biblStruct   xml:id="b0">
	<analytic>
		<title level="a" type="main">Geospatial resolution of human and bacterial diversity with city-scale metagenomics</title>
		<author>
			<persName>
				<forename type="first">E</forename>
				<surname>Afshinnekoo</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">C</forename>
				<surname>Meydan</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Cell Systems</title>
		<imprint>
			<biblScope unit="volume">1</biblScope>
			<biblScope unit="issue">1</biblScope>
			<biblScope unit="page" from="72" to="87" />
			<date type="published" when="2015" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b1">
	<analytic>
		<title level="a" type="main">A tutorial of recent developments in the seeding of local alignment</title>
		<author>
			<persName>
				<forename type="first">D</forename>
				<forename type="middle">G</forename>
				<surname>Brown</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">M</forename>
				<surname>Li</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Journal of Bioinformatics and Computational Biology</title>
		<imprint>
			<biblScope unit="volume">2</biblScope>
			<biblScope unit="issue">04</biblScope>
			<biblScope unit="page" from="819" to="842" />
			<date type="published" when="2004" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b2">
	<analytic>
		<title level="a" type="main">ART: a next-generation sequencing read simulator</title>
		<author>
			<persName>
				<forename type="first">W</forename>
				<surname>Huang</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">L</forename>
				<surname>Li</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">28</biblScope>
			<biblScope unit="issue">4</biblScope>
			<biblScope unit="page" from="593" to="594" />
			<date type="published" when="2012" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b3">
	<analytic>
		<title level="a" type="main">MEGAN analysis of metagenomic data</title>
		<author>
			<persName>
				<forename type="first">D</forename>
				<forename type="middle">H</forename>
				<surname>Huson</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">A</forename>
				<forename type="middle">F</forename>
				<surname>Auch</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Genome Research</title>
		<imprint>
			<biblScope unit="volume">17</biblScope>
			<biblScope unit="issue">3</biblScope>
			<biblScope unit="page" from="377" to="386" />
			<date type="published" when="2007" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b4">
	<analytic>
		<title level="a" type="main">SpEED: fast computation of sensitive spaced seeds</title>
		<author>
			<persName>
				<forename type="first">L</forename>
				<surname>Ilie</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">S</forename>
				<surname>Ilie</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="issue">17</biblScope>
			<biblScope unit="page" from="27" to="2433" />
			<date type="published" when="2011" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b5">
	<monogr>
		<title level="m" type="main">An evaluation of the accuracy and speed of metagenome analysis tools. Scientific reports</title>
		<author>
			<persName>
				<forename type="first">S</forename>
				<surname>Lindgreen</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">K</forename>
				<forename type="middle">L</forename>
				<surname>Adair</surname>
			</persName>
		</author>
		<imprint>
			<date type="published" when="2016" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b6">
	<analytic>
		<title level="a" type="main">PatternHunter: faster and more sensitive homology search</title>
		<author>
			<persName>
				<forename type="first">B</forename>
				<surname>Ma</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">J</forename>
				<surname>Tromp</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">18</biblScope>
			<biblScope unit="issue">3</biblScope>
			<biblScope unit="page" from="440" to="445" />
			<date type="published" when="2002" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b7">
	<analytic>
		<title level="a" type="main">CLARK: fast and accurate classification of metagenomic and genomic sequences using discriminative k-mers Taxonomic note: a place for DNA-DNA reassociation and 16s rRNA sequence analysis in the present species definition in bacteriology</title>
		<author>
			<persName>
				<forename type="first">R</forename>
				<surname>Ounit</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">S</forename>
				<surname>Wanamaker</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">BMC Genomics Journal of Systematic and Evolutionary Microbiology</title>
		<imprint>
			<biblScope unit="volume">16</biblScope>
			<biblScope unit="issue">444</biblScope>
			<biblScope unit="page" from="846" to="849" />
			<date type="published" when="1994" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b8">
	<analytic>
		<title level="a" type="main">Metagenomic covariation along densely sampled environmental gradients in the red sea</title>
		<author>
			<persName>
				<forename type="first">L</forename>
				<forename type="middle">R</forename>
				<surname>Thompson</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">G</forename>
				<forename type="middle">J</forename>
				<surname>Williams</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">The ISME journal</title>
		<imprint>
			<date type="published" when="2016" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b9">
	<analytic>
		<title level="a" type="main">Kraken: ultrafast metagenomic sequence classification using exact alignments</title>
		<author>
			<persName>
				<forename type="first">D</forename>
				<surname>Wood</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">S</forename>
				<surname>Salzberg</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Genome Biol</title>
		<imprint>
			<biblScope unit="volume">15</biblScope>
			<biblScope unit="issue">3</biblScope>
			<biblScope unit="page">46</biblScope>
			<date type="published" when="2014" />
		</imprint>
	</monogr>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>