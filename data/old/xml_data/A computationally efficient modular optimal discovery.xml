
<?xml version="1.0" encoding="UTF-8"?>
<TEI xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 /home/joey/Project/grobid/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<encodingDesc>
			<appInfo>
				<application version="0.4.2-SNAPSHOT" ident="GROBID" when="2017-08-10T23:47+0000">
					<ref target="https://github.com/kermitt2/grobid">GROBID - A machine learning software for extracting information from scholarly documents</ref>
				</application>
			</appInfo>
		</encodingDesc>
		<fileDesc>
			<titleStmt>
				<title level="a" type="main">Gene expression A computationally efficient modular optimal discovery procedure</title>
			</titleStmt>
			<publicationStmt>
				<publisher/>
				<availability status="unknown"><licence/></availability>
				<date type="published" when="2011">2011</date>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author>
							<persName>
								<forename type="first">Sangsoon</forename>
								<surname>Woo</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department">Department of Biostatistics</orgName>
								<orgName type="institution">University of Washington</orgName>
								<address>
									<postCode>98195</postCode>
									<settlement>Seattle</settlement>
									<region>WA</region>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Jeffrey</forename>
								<forename type="middle">T</forename>
								<surname>Leek</surname>
							</persName>
							<affiliation key="aff1">
								<orgName type="department">Department of Biostatistics</orgName>
								<orgName type="institution">Johns Hopkins Bloomberg School of Public Health</orgName>
								<address>
									<postCode>21205</postCode>
									<settlement>Baltimore</settlement>
									<region>MD</region>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">John</forename>
								<forename type="middle">D</forename>
								<surname>Storey</surname>
							</persName>
							<affiliation key="aff2">
								<orgName type="department">Lewis-Sigler Institute for Integrative Genomics and Department of Molecular Biology</orgName>
								<orgName type="institution">Princeton University</orgName>
								<address>
									<postCode>08544</postCode>
									<settlement>Princeton</settlement>
									<region>NJ</region>
									<country key="US">USA</country>
								</address>
							</affiliation>
						</author>
						<title level="a" type="main">Gene expression A computationally efficient modular optimal discovery procedure</title>
					</analytic>
					<monogr>
						<title level="j" type="main">BIOINFORMATICS ORIGINAL PAPER</title>
						<imprint>
							<biblScope unit="volume">27</biblScope>
							<biblScope unit="issue">4</biblScope>
							<biblScope unit="page" from="509" to="515"/>
							<date type="published" when="2011">2011</date>
						</imprint>
					</monogr>
					<idno type="DOI">10.1093/bioinformatics/btq701</idno>
					<note type="submission">Received on August 12, 2010; revised on November 10, 2010; accepted on December 15, 2010</note>
					<note>[12:50 22/1/2011 Bioinformatics-btq701.tex] Page: 509 509–515 Associate Editor: Trey Ideker Contact: jstorey@princeton.edu Supplementary information: Supplementary data are available at Bioinformatics online.</note>
				</biblStruct>
			</sourceDesc>
		</fileDesc>
		<profileDesc>
			<abstract>
				<p>Motivation: It is well known that patterns of differential gene expression across biological conditions are often shared by many genes, particularly those within functional groups. Taking advantage of these patterns can lead to increased statistical power and biological clarity when testing for differential expression in a microarray experiment. The optimal discovery procedure (ODP), which maximizes the expected number of true positives for each fixed number of expected false positives, is a framework aimed at this goal. Storey et al. introduced an estimator of the ODP for identifying differentially expressed genes. However, their ODP estimator grows quadratically in computational time with respect to the number of genes. Reducing this computational burden is a key step in making the ODP practical for usage in a variety of high-throughput problems. Results: Here, we propose a new estimate of the ODP called the modular ODP (mODP). The existing &apos;full ODP&apos; requires that the likelihood function for each gene be evaluated according to the parameter estimates for all genes. The mODP assigns genes to modules according to a Kullback–Leibler distance, and then evaluates the statistic only at the module-averaged parameter estimates. We show that the mODP is relatively insensitive to the choice of the number of modules, but dramatically reduces the computational complexity from quadratic to linear in the number of genes. We compare the full ODP algorithm and mODP on simulated data and gene expression data from a recent study of Morrocan Amazighs. The mODP and full ODP algorithm perform very similarly across a range of comparisons. Availability: The mODP methodology has been implemented into EDGE, a comprehensive gene expression analysis software package in R, available at http://genomine.org/edge/.</p>
			</abstract>
		</profileDesc>
	</teiHeader>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1">INTRODUCTION</head><p>Since the development of microarrays, a large number of methods have been proposed to identify genes that are differentially expressed across biological conditions. Methods exist that borrow strength across genes to shrink variances, apply data-adaptive thresholds to traditional statistics or calculate hierarchical Bayesian posterior * To whom correspondence should be addressed. probabilities (<ref type="bibr" target="#b0">Cui et al., 2005;</ref><ref type="bibr" target="#b1">Efron et al., 2001;</ref><ref type="bibr" target="#b9">Lonnstedt and Speed, 2002;</ref><ref type="bibr" target="#b10">Newton et al., 2004;</ref><ref type="bibr" target="#b12">Smyth, 2004;</ref><ref type="bibr" target="#b17">Tusher et al., 2001</ref>). Recently,proposed an approach called the optimal discovery procedure (ODP) that borrows strength across genes with similar expression patterns when testing them for differential expression. The ODP, which must be estimated in practice, maximizes the expected number of true discoveries for a fixed expected number of false discoveries. This optimality property makes the ODP an attractive choice for use in analyzing gene expression and other high-throughput data. Conceptually, the ODP uses information about differential expression patterns across all genes to inform the decision about any specific gene.<ref type="figure">Figure 1</ref>shows a simple simulated dataset that illustrates the ODP concept. The black box highlights the genes that are differentially expressed among groups. The first set of differentially expressed genes are upregulated in the first two groups and downregulated in the third. The second set of differentially expressed genes are downregulated in the second group and upregulated in the first and third. The third set is upregulated in the second group and downregulated in the others. In this example, each pattern of differential expression is shared across genes. The number of genes sharing each pattern is different, and only three of the six possible differential expression patterns are present. The ODP directly utilizes this information, stemming from the idea that if a gene shares an expression pattern with other genes that have been identified as differentially expressed, then it is more likely to be differentially expressed as well. It has been shown that the ODP is more powerful for detecting differential expression than existing methods such as the traditional t-test (or F-test), a shrunken t-test, SAM and empirical Bayes methods (<ref type="bibr" target="#b14">Storey et al., 2005</ref>). The ODP statistic is related to the commonly used likelihood ratio (LR) test statistics, also known as the Neyman–Pearson statistic (<ref type="bibr" target="#b8">Lehmann, 1986</ref>). Suppose we have observed an n×1 vector of expression data x i for the i-th gene. The traditional LR statistic, which is optimal when testing a single hypothesis, evaluates the likelihood under the null hypothesis of no differential expression for that gene L i0 and the alternative hypothesis L iA , and forms their ratio L iA (x i )/L i0 (x i ) as the test statistic. If the ratio is large enough, then the gene is called differentially expressed. The ODP has a similar structure, except the ratio is taken of all alternative likelihoods to all null likelihoods given the gene's data x i , where these likelihoods are evaluated across all genes. The ODP statistic is the ratio alt L jA (x i )/ null L j0 (x i ). As with the LR statistics, the ODP statistic for a test also captures evidence against the null hypothesis in favor of the alternative hypothesis.<ref type="figure">1</ref>. A heatmap of simulated gene expression data for a study comparing three groups. The genes inside the black box show three common gene expression patterns; the first pattern is downregulated for groups 1 and 2 and upregulated for group 3. The second pattern is downregulated for groups 1 and 3 and upregulated for group 2. The third pattern is downregulated for group 2 and upregulated for groups 1 and 3. The number of genes sharing each pattern is different, and only three of the six possible differential expression patterns are present. The ODP is designed to utilize these expression patterns to improve inference of differential expression. But in contrast to the univariate LR test, the ODP summarizes the evidence against the null taking into account the information from the other (possibly related) tests being performed. When another gene is uninformative, it contributes essentially nothing to the above ODP statistic because its likelihood is very low. Although the ODP statistic is more powerful than traditional statistics developed for testing single hypotheses, it requires the evaluation of a large number of likelihoods for each dataset. For each gene, the number of terms to calculate in the ODP statistic is on the order of the total number of genes, resulting in a computational cost that grows quadratically in the number of genes when doing a genome-wide analysis. The original ODP estimator introduced inperforms this exhaustive set of calculations. However, if groups of genes share common expression patterns, they will have similar probability distributions, and therefore their calculations can be compressed into a single computational step. Here, we propose to identify modules of genes based on similarity of probability distributions using a clustering scheme based on the Kullback–Leibler distance. The ODP statistic can then be calculated using only the distributions derived from the centroids of these modules and weighted by the number of genes in that module. Since the number of modules is much smaller than the number of genes, the ODP computation will be substantially reduced. However, the performance of and results from the modular ODP approach are very similar to the full ODP approach. In addition to a substantial reduction of computation, the unknown parameters for each centroid can be accurately estimated because multiple genes are used.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>S.Woo et al.</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2">THE OPTIMAL DISCOVERY PROCEDURE</head><p>Gene expression and other high-throughput data can be thought of as a set of related experiments performed simultaneously. Suppose there are m genes in an experiment; then for each gene there is an n×1 vector of data x i corresponding to the gene expression measurements, for each of n individuals for that gene. A usual goal in high-throughput data analysis is to test a statistical hypothesis for each gene, for example, testing the hypotheses that each gene has constant expression across some groups of interest versus the hypotheses that some genes mean expression varies by group. In other words, testing the hypotheses: H 0 :</p><formula>µ i = µ 0 i 1 versus H 1 : µ i = µ 1 i where µ 1</formula><p>i parameterizes difference in means across samples. For simplicity, in the remainder of the discussion we will assume that the data x i are sample of n independent observations from a Normal distribution with mean vector µ i and common variance σ 2 i. However, any other data generating distribution can be substituted in the discussion and methods that follow. For Normal distributed data, the likelihood is</p><formula>L(µ i ,σ i |x i ) = 1 2πσ 2 i e n j=1 −(x ij −µ ij ) 2 2σ 2 i .</formula><p>The so-called generalized LR test is an approximation to the most powerful test given a fixed type one error rate. Using the Normal model, the generalized LR test statistic is given by</p><formula>S LR (x i ) = L( µ 1 i , σ 1 i |x i ) L( µ 0 i , σ 0 i |x i ) , where ( µ 1 i , σ 1 i ) and</formula><p>( µ 0 i , σ 0 i ) are the maximum likelihood parameter estimates under the alternative and the null hypotheses, respectively (<ref type="bibr" target="#b8">Lehmann, 1986</ref>). In the case of Normal data for a two sample comparison, the generalized LR statistic is equivalent to the standard two-sided t-test. However, the LR statistic is far more general and can be fit to a wide range of data types. The ODP uses a concept similar to the Neyman–Pearson approach, except the ODP approach was developed for testing multiple hypotheses. Rather than maximizing the power for a fixed false positive rate of a single test, the ODP maximizes the overall number of expected true positives (ETP) for a fixed level of expected false positives (EFP) among multiple hypothesis tests. The ETP is simply the sum of the power across all truly alternative tests and the EFP is the sum of the false positive rates across all truly null tests. The ODP, like the LR test, is optimal when the null and alternative distributions are known. The ODP can be estimated by using the same principles for forming the generalized LR statistics, which is an estimate of the theoretical optimal Neyman–Pearson LR statistic. For identifying differentially expressed genes in a microarray study, a simple estimate of the full ODP has been developed (). The first step is to calculate the maximum likelihood estimates for each gene under the alternative and null hypotheses,</p><formula>( µ 1 i , σ 1 i ) and ( µ 0 i , σ 0 i ) for i = 1</formula><p>,...,m. To calculate the estimated full ODP statistic for a given gene, the gene's likelihood function is evaluated at all of these fitted maximum likelihood estimates, summed over all tests, and the ratio between the alternative likelihood sum to the null likelihood sum is formed. In mathematical notation, the estimated ODP statistic for gene i can be written as follows:</p><formula>S ODP (x i ) = m j=1 L( µ 1 j , σ 1 j |x i ) m j=1 L( µ 0 j , σ 0 j |x i ) .</formula><formula>(1)</formula><p>[m i=1 L( µ j |x 5 ), implying that the ODP statistic for test 13 would be larger than that for test 5. This makes sense in that there are many more positive µ j than negative, so we should attribute stronger evidence against the null hypothesis to those tests with positive estimates. In more complex situations such as those encountered in gene expression studies, this aggregation of information becomes even more useful.</p><p>An intuitive understanding of the ODP statistic and how it relates to the traditional LR statistic is explained in<ref type="figure">Figure 2</ref>.presented a more general form of (1) as well as some steps one may take to remove ancillary information, which may be incorporated into our proposed method (see Supplementary Material). Evaluating (1) requires 2m likelihood calculations for each of the m tests, resulting in 2m 2 likelihood calculations. The statistical significance for this full ODP statistic is evaluated using a bootstrap procedure. Because the ODP statistic is estimated for each bootstrapped dataset, this can lead to substantial computational costs. In most experiments, the data for many features will follow a common pattern of variation. The pattern of variation that is relevant to the inference is that captured by the probability distribution used to model each gene's data, parameterized by the (µ i ,σ i ). If genes a and b have similar relevant patterns of variation, then (µ a ,σ a ) ≈ (µ b ,σ b ), as well as their likelihood values L(µ a ,σ a |x i ) ≈ L(µ b ,σ b |x i ) for any given gene i. Thus, it is not necessary to do each calculation individually in (1), but rather approximate them with a single 'average' calculation. There may be many more than two genes with common patterns of variation, thereby allowing us to reduce the computation even further. A key problem is how to decide if (µ a ,σ a ) ≈ (µ b ,σ b ), and how to identify larger sets of genes with this similarity. Even more so, we want L(µ a ,σ a |x) ≈ L(µ b ,σ b |x i ) for all genes i = 1,...,m, because agglomerating genes a and b in the ODP statistic will be applied in the calculation of every gene's ODP statistic. To this end, we use a modified Kullback–Leibler divergence (<ref type="bibr" target="#b6">Kullback and Leibler, 1961</ref>), which indeed quantifies the probabilistic distance between L( µ a , σ a |x) and L( µ b , σ b |x) over all x ∈ R n. The Kullback–Leibler divergence measures the discrepancy between two distributions. Because the Kullback–Leibler divergence is asymmetric, we use a symmetric version that is sometimes called the Kullback–Leibler distance. We assign each gene to one of K modules by utilizing a clustering algorithm based on the Kullback–Leibler distance (<ref type="bibr" target="#b11">Nielsen and Nock, 2009</ref>). This creates K centroid estimates of the parameters for the alternative model fits and the null model fits. Then for each gene, we only evaluate its likelihood function at the centroid parameters and weight it by the number of genes in that module. Since the number of modules is much smaller than the number of genes, this approach substantially reduces the computational burden of the approach. We reduce 2m 2 calculations to 2Km, where K m. If K stays approximately fixed, then the computational cost of the proposed modular ODP (mODP) algorithm grows linearly in the number of genes. At the same time, we show that the mODP gives nearly identical inference results to the original full ODP estimate.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3">METHODS</head><p>Our approach to calculating the ODP statistics has three steps: (i) cluster genes into K modules based on similarity of expression variation captured by the Kullback–Leibler distance; (ii) evaluate each gene's likelihood function at each module centroid model fit, weighted by the number of genes assigned to that module; and (iii) aggregate these weighted centroid likelihood calculations into modular ODP (mODP) statistics. For the first step, we use a modification of the well-known Kullback– Leibler (KL) divergence as our metric for measuring how similar two genes' estimated probability distributions are. Let F a and F b be two continuous probability distributions with a common support and corresponding probability density functions, f a and f b. The KL divergence between these two distributions is given by</p><formula>KL F a ,F b = E Fa log f a (x)/f b (x) = log f a (x)/f b (x) f a (x)dx.</formula><p>The KL divergence is not a symmetric measure, so we use the following KL distance:</p><formula>d F a ,F b = KL F a ,F b +KL F b ,F a .</formula><p>The KL distance between two of the Normal distributions that we consider here is calculated to be:</p><formula>d N(µ a ,σ 2 a ),N(µ b ,σ 2 b ) = 1 2 (µ a −µ b ) T (µ a −µ b ) 1 σ 2 a + 1 σ 2 b + n 2 σ 2 a σ 2 b + σ 2 b σ 2 a −n.</formula><p>We construct modules by extending K-means clustering (<ref type="bibr" target="#b11">Nielsen and Nock, 2009</ref>), which is typically based on Euclidean distance of a gene's expression vector to that of K cluster centroids, to a KL distance-based Page: 512 509–515</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>S.Woo et al.</head><p>approach. The distance between a gene and a module is based on the KL distance between the gene's estimated probability distribution and the 'average distribution' of the genes within a module. The mODP estimation algorithm proceeds as shown below. We represent the gene's estimated probability distribution by its maximum likelihood parameters under the alternative hypothesis, ( µ 1 i , σ 1 i ). The 'average distribution' of the module is simply based on the average of the parameter estimates for every gene in that module. Therefore, the approach by which we construct clusters is derived from K-means clustering, except we replace Euclidean distance with KL distance, and we replace expression vectors and centroids with parameter estimates and averaged parameter estimates. In constructing modules, we use the alternative hypothesis estimates rather than the null hypothesis estimates because the former is fit under the unconstrained model, thereby allowing for each gene to be truly null or truly alternative without having to introduce an extra estimation step. Also, when incorporating data transformations to remove ancillary information, as proposed by(see Supplementary Material), we get µ 0 i = 0 for all i making them uninformative for module construction. Once the module construction is completed [step (i) above], then steps (ii) and (iii) become straightforward. Our proposed method is summarized in the following algorithm.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Algorithm. The Modular Optimal Discovery Procedure (mODP)</head><p>1. For a user-chosen number of modules K, initiate the module parameter estimates by randomly selecting K of the m genes and setting their alternative hypothesis estimates to be the module parameter estimates. Specifically, for k = 1,...,K, the module k is parameterized by˜µby˜ by˜µ k</p><formula>= µ 1 i(k)</formula><p>and˜σand˜ and˜σ k = σ 1 i(k) , where i(k) is a randomly chosen gene index among the m.</p><p>2. For each gene i = 1,...,m and each module k = 1,...,K, calculate their KL distance using the formula:</p><formula>d ik = 1 2 ( ˜ µ k − µ 1 i ) T ( ˜ µ k − µ 1 i ) 1 ˜ σ 2 k + 1 σ 1 i 2 + n 2 ˜ σ 2 k σ 1 i 2 + σ 1 i 2 ˜ σ 2 k −n.</formula><p>3. Assign gene i to the closest module in terms of KL distance, calculated by argmin 1≤k≤K d ik. 4. For these new module assignments, calculate their updated parameters. Let R k be the set of indices of genes assigned to module k and |R k | be the number of genes in that module.</p><formula>˜ µ k = 1 |R k | j∈R k µ 1 j ˜ σ 2 k = 1 |R k | j∈R k σ 1 j 2 .</formula><p>5. Repeat Steps 2–4 until the centroids are fixed in the sense that˜µthat˜ that˜µ k and˜σ and˜ and˜σ 2 k differ less than a user chosen between two consecutive iterations. Calculate the final module estimates under the alternative and null hypotheses as follows:</p><formula>˜ µ 1 k = ˜ µ k ˜ σ 1 k = ˜ σ k ˜ µ 0 k = 1 |R k | j∈R k µ 0 j ˜ σ 0 k = 1 |R k | j∈R k σ 0 j 2 6</formula><p>. For each gene i = 1,2,...,m, calculate the mODP statistics according to the following formula:</p><formula>S mODP (x i ) = K k=1 L( ˜ µ 1 k , ˜ σ 1 k |x i )·|R k | K k=1 L( ˜ µ 0 k , ˜ σ 0 k |x i )·|R k | .</formula><formula>(2)</formula><p>7. From the mODP formula above, obtain P-values and FDR q-values by using the bootstrap, exactly as proposed in Storey et al.</p><formula>(2007).</formula><p>The mODP algorithm requires the user to choose the number of modules K in advance. Estimating the number of clusters in data is a notoriously difficult problem, because much biological interpretation is made of the genes contained in each cluster. However, in our setting, the clustering may be used simply as a numerical tool, making this choice much less crucial in that one is not required to make any biological interpretation of the clusters. The rule of thumb we propose is to set K large enough so that K is greater than the number of distinct patterns of expression variation, but not so large that the gain in computational speed is diminished. In the numerical results below, we have observed that K = 50 seems to be a well behaved choice. This may be data dependent, but one may always compare the results for different values of K, as we do below, before making a final choice. On the other hand, embedded in our mODP method is a potentially useful new clustering algorithm. Whereas clustering is typically performed in an unsupervised manner, our algorithm allows one to cluster genes based on how the model of interest fits the data. In such a case, the choice of K becomes more important and exploring a data-driven choice of the number of clusters may be more relevant. It is also possible that this clustering algorithm driven by study design could be incorporated with more sophisticated modular clustering frameworks (<ref type="bibr" target="#b18">Zhang and Horvath, 2005</ref>). While this is potentially a very interesting direction, it is beyond the scope of this work.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4">RESULTS</head><p>The mODP estimator (2) has two advantages over the full ODP estimator (1). First, the number of modules is generally much smaller than the number genes (K m), thereby dramatically reducing the computational burden. The second advantage is that the averaged parameter fits within each module will be more stable than individual gene's parameter estimates. We now compare the behavior of the mODP estimator to the full ODP estimator both on simulated gene expression data and on data from a study comparing gene expression levels in human leukocytes from individuals living in three different environments. We show below that the mODP algorithm offers nearly identical results as the full ODP, while indeed requiring substantially less computing time.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.1">Simulation results</head><p>We compared the mODP to the full ODP on a range of simulated examples; the R code and details of the simulations appear in the Supplementary Material. First, we compared the computational time for the full ODP approach versus the mODP approach with K = 50.<ref type="figure" target="#fig_1">Figure 3</ref>shows the relative CPU times required to calculate the mODP and full ODP statistics for a set of genes under one of the simulation scenarios, as the number of genes increases from 100 to 10 000. (The other scenarios show equivalent results.) The computational time for the mODP, which includes the time required for clustering, grows nearly linearly in the number of genes, while the full ODP is closer to quadratic growth. Given that the ODP statistics must be recomputed for all genes for each null bootstrap Page: 513 509–515sample, the computational savings can be substantial in practice. To make this comparison, we used an Apple Mac Pro machine with OS X version 10.5.8, 2.66 GHz Intel Core 2 Duo processor and 4 GB of RAM. Next we examined whether the mODP statistics produce similar results to the full ODP statistics. Our simulations followed the structure from the simulation study into provide comparable results. The full ODP has already been compared to a number of other popular methods (<ref type="bibr" target="#b0">Cui et al., 2005;</ref><ref type="bibr" target="#b1">Efron et al., 2001;</ref><ref type="bibr" target="#b9">Lonnstedt and Speed, 2002;</ref><ref type="bibr" target="#b12">Smyth, 2004;</ref><ref type="bibr" target="#b17">Tusher et al., 2001</ref>) in, as well as a Bayesian version of the full ODP in<ref type="bibr" target="#b2">Guindani et al. (2009)</ref>. Since our results show that the mODP provides nearly identical significance results to the full ODP, we do not repeat these comparisons here. We simulated eight different types of gene expression studies, each corresponding to a particular set of parameters and experimental design. Four simulated studies correspond to two group comparisons and four correspond to three group comparisons. Within each of these two sets, the same signal structure is used, but we vary the variance structure. For both the two and three sample studies, the simplest case is a constant variance across all genes, followed by variances simulated from a Uniform distribution, from a Gamma distribution and from a more heterogeneous mixture of Uniform distributions. R scripts for simulating these datasets can be found in the Supplementary Material. In each case, we plot the number of significant genes across a range of estimated q-value cutoffs (<ref type="bibr" target="#b13">Storey and Tibshirani, 2003</ref>), averaged over 100 simulated studies (<ref type="figure" target="#fig_4">Fig. 4</ref>). We also compared the estimators in terms of the true EFP and ETP (Supplementary Figs S1 and S2), showing similar results to the above comparison. For simple variance structures, the mODP provides nearly identical performance to the more computationally intensive full ODP regardless of the number of modules K and no matter how many groups are compared. As the variance structure becomes more complex, it appears that more modules are required for the mODP to achieve the same performance as the full ODP, especially in the three group comparison. The mODP is more likely sensitive to the choice of the number of modules in a three-group comparison because the parameter structure is more complicated. However, in all simulated scenarios K = 50 modules or more leads to results that are nearly identical to the full ODP. We compared the numerical values of the mODP and full ODP statistics and the gene significance rankings for K = 50 and K = 200 (Supplementary Figs S3–S5). It can be seen that the mODP and full ODP again produce similar results. We also verified that the random initial cluster centers do not heavily influence the mODP values nor the relative rankings that they produce (Supplementary Figs S7 and S8).<ref type="figure" target="#fig_5">Figure 5</ref>. Again we considered the performance over a range of module numbers K for the mODP approach. As the plots show, the mODP and full ODP perform nearly identically when K ≥ 50. We also compared the gene rankings produced by the full ODP to the mODP for K = 50 (Supplementary<ref type="figure">Fig. S6</ref>). It can be seen that the two methods produce similar gene rankings, meaning that they identify nearly the exact same genes as being differentially expressed.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>A computationally efficient modular ODP</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.2">Environmental differential expression</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5">DISCUSSION</head><p>The optimal discovery procedure (ODP) is a powerful approach for the analysis of high-throughput gene expression data (). However, the full ODP requires the computation of a large number of likelihoods to evaluate the statistic for any specific gene. This leads to computational costs that grow quadratically in the number of genes. Since significance of these statistics is typically evaluated by a non-parametric bootstrap approach requiring many sets of ODP statistics to be calculated, there is a strong need for methods that reduce the computational cost of evaluating these statistics. Here, we have introduced a new approach for calculating ODP statistics, based on forming probabilistic gene modules using the Kullback–Leibler distance and greatly reducing the number of likelihood calculations making up each statistic. The mODP statistics are formed from a small number of likelihood calculations, making the computation grow nearly linearly in the number of genes. Even though the mODP statistics are substantially faster to calculate, we have shown that they produce nearly identicalresults to the full ODP statistics in both simulated and real data examples. Even though the mODP requires the user to decide the number of modules in advance, we have shown that the mODP statistics are relatively robust to the choice of the number of modules. In both the simulated and real data examples, it was observed that 50 modules or more were sufficient to match the performance of the full ODP. Also because the mODP method borrows strength across multiple genes, the averaged parameter estimates defining each module form more stable estimates of gene expression variation relevant to the study and may contribute important information beyond unsupervised clustering. Although we have used the Normal likelihood in the formulation of our method, justified because the data are continuous and can be shown to be approximately Normal, the ODP approach may be utilized with other probability distributions. The methodology presented in this article has been implemented in the EDGE software package (<ref type="bibr" target="#b7">Leek et al., 2006</ref>), freely available at http://genomine.org/edge/.</p></div><figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_0"><head>Fig.</head><figDesc>Fig. 1. A heatmap of simulated gene expression data for a study comparing three groups. The genes inside the black box show three common gene expression patterns; the first pattern is downregulated for groups 1 and 2 and upregulated for group 3. The second pattern is downregulated for groups 1 and 3 and upregulated for group 2. The third pattern is downregulated for group 2 and upregulated for groups 1 and 3. The number of genes sharing each pattern is different, and only three of the six possible differential expression patterns are present. The ODP is designed to utilize these expression patterns to improve inference of differential expression.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_1"><head>Fig.3.</head><figDesc>Fig. 3. A plot of relative CPU time for increasing numbers of genes for the mODP and the full ODP estimators under one of the simulation scenarios. The full ODP grows approximately quadratically in the number of genes while the mODP grows nearly linearly.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_2"><head></head><figDesc>Idaghdour et al. (2008) measured gene expression from a human population of Moroccan Amazighs composed of three different lifestyles. They collected leukocyte samples from peripheral blood to profile gene expression in 16 Bedouin, 18 Anza and 12 Sebt-Nabor individuals. The Bedouin individuals have traditional nomadic lives on the fringe of the Sahara desert near the town of Errachidia, the Anza individuals are from the coastal city of Anza near Agadir and the Sebt-Nabor individuals come from a rural mountainous region in Agadir. In total, 10 177 transcripts were expressed across the 46 samples. Details of the gene expression profiling process are described in Idaghdour et al. (2008). We refer to samples from Bedouin as 'Desert', samples from Sebt-Nabor as 'Village' and samples from Anza as 'Agadir'. We conducted pairwise comparisons for all pairs of the Agadir, Village and Desert groups and also looked for differential expression across all three groups simultaneously. The plots of the number of significant genes for each q-value for both the mODP and the full ODP are shown in</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_4"><head>Fig.4.</head><figDesc>Fig. 4. A comparison of the mODP and the full ODP method based on simulated data. Each panel is the average number of genes called significant for each q-value cutoff over 100 simulated datasets. Solid colored lines are the proposed mODP method for different numbers of modules K and the black dashed line is the full ODP. The simulations correspond to (A) two group comparison, fixed equal variances, (B) two group comparison, variances Uniform sampled, (C) two group comparison, variances Gamma sampled and (D) two group comparison, variances Uniform mixture sampled, (E) three group comparison, fixed equal variances, (F) three group comparison, variances Uniform sampled, (G) three group comparison, variances Gamma sampled and (H) three group comparison, variances Uniform mixture sampled.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_5"><head>Fig.5.</head><figDesc>Fig. 5. A comparison of the mODP and the full ODP approaches on the Morrocan data from Idaghdour et al. (2008). In each plot, the number of significant genes is plotted versus the corresponding q-value cutoff. (A) Agadir versus Village, (B) Agadir versus Desert, (C) Desert versus Village and (D) Agadir versus Desert versus Village (three group comparison). The mODP performs nearly identically to the full ODP, particularly when K ≥ 50.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_6"><head></head><figDesc>Funding: This research was supported in part by NIH grant HG002913. Conflict of Interest: none declared.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_0" validated="false"><figDesc>0 : µ = 0 versus H 1 : µ = 0 are performed on µ 1 ,µ 2 ,...,µ m based on respective datasets x 1 ,x 2</figDesc><table>12:50 22/1/2011 Bioinformatics-btq701.tex] 

Page: 511 509–515 

A computationally efficient modular ODP 

Fig. 2. A demonstration of the difference between the ODP approach and 
LR statistic. Suppose that hypothesis tests H ,...,x m . 
Shown are the likelihood functions for test 5, L(µ|x 5 ) in red, and test 
13, L(µ|x 13 ) in blue. Their maximum likelihood estimates are such that 
L( µ 5 |x 5 ) = L( µ 13 |x 13 ), implying that they would produce equal LR statistics. 
The ODP utilizes information from all of the maximum likelihood estimates 
µ 1 , µ 2 ,..., µ m , shown at the top of the plot. These tend to be more similar 

to µ 13 than µ 5 , lending greater evidence against the null hypothesis for test 
13. The ODP quantifies this evidence by calculating the likelihood functions 
over all maximum likelihood estimates, shown as red dots for test 5 and in 
blue dots for test 13. It can be seen that 
m 
i=1 L( µ j |x 13 ) 

</table></figure>

			<note place="foot">© The Author 2010. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oup.com</note>

			<note place="foot">at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from [12:50 22/1/2011 Bioinformatics-btq701.tex]</note>

			<note place="foot">at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>
		</body>
		<back>
			<div type="references">

				<listBibl>

<biblStruct   xml:id="b0">
	<analytic>
		<title level="a" type="main">Improved statistical tests for differential gene expression by shrinking variance components estimates</title>
		<author>
			<persName>
				<forename type="first">X</forename>
				<surname>Cui</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Biostatistics</title>
		<imprint>
			<biblScope unit="volume">6</biblScope>
			<biblScope unit="page" from="59" to="75" />
			<date type="published" when="2005" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b1">
	<analytic>
		<title level="a" type="main">Empirical bayes analysis of a microarray experiment</title>
		<author>
			<persName>
				<forename type="first">B</forename>
				<surname>Efron</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Am. Stat. Assoc</title>
		<imprint>
			<biblScope unit="volume">96</biblScope>
			<biblScope unit="page" from="1151" to="1160" />
			<date type="published" when="2001" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b2">
	<analytic>
		<title level="a" type="main">A bayesian discovery procedure</title>
		<author>
			<persName>
				<forename type="first">M</forename>
				<surname>Guindani</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Roy. Stat. Soc. Ser. B</title>
		<imprint>
			<biblScope unit="volume">71</biblScope>
			<biblScope unit="page" from="905" to="925" />
			<date type="published" when="2009" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b3">
	<analytic>
		<title/>
	</analytic>
	<monogr>
		<title level="m">Bioinformatics-btq701.tex] Page</title>
		<imprint>
			<date type="published" when="2011" />
			<biblScope unit="page" from="50" to="72" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b4">
	<monogr>
		<title level="m" type="main">A computationally efficient modular ODP</title>
		<imprint/>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b5">
	<analytic>
		<title level="a" type="main">A gemone-wide gene expression signature of environmental geography in leukocytes of moroccan amazighs</title>
		<author>
			<persName>
				<forename type="first">Y</forename>
				<surname>Idaghdour</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">PLoS Genet</title>
		<imprint>
			<biblScope unit="volume">4</biblScope>
			<date type="published" when="2008" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b6">
	<analytic>
		<title level="a" type="main">On information and sufficiency</title>
		<author>
			<persName>
				<forename type="first">S</forename>
				<surname>Kullback</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">R</forename>
				<forename type="middle">A</forename>
				<surname>Leibler</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Ann. Math. Stat</title>
		<imprint>
			<biblScope unit="volume">22</biblScope>
			<biblScope unit="page" from="79" to="86" />
			<date type="published" when="1961" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b7">
	<analytic>
		<title level="a" type="main">EDGE: extraction and analysis of differential gene expression</title>
		<author>
			<persName>
				<forename type="first">J</forename>
				<forename type="middle">T</forename>
				<surname>Leek</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">22</biblScope>
			<biblScope unit="page" from="507" to="508" />
			<date type="published" when="2006" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b8">
	<monogr>
		<title level="m" type="main">Testing Statistical Hypotheses</title>
		<author>
			<persName>
				<forename type="first">E</forename>
				<forename type="middle">L</forename>
				<surname>Lehmann</surname>
			</persName>
		</author>
		<imprint>
			<date type="published" when="1986" />
			<publisher>Springer</publisher>
			<pubPlace>Berlin</pubPlace>
		</imprint>
	</monogr>
	<note>2nd. edn</note>
</biblStruct>

<biblStruct   xml:id="b9">
	<analytic>
		<title level="a" type="main">Replicated microarray data</title>
		<author>
			<persName>
				<forename type="first">I</forename>
				<surname>Lonnstedt</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">T</forename>
				<surname>Speed</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Stat. Sin</title>
		<imprint>
			<biblScope unit="volume">12</biblScope>
			<biblScope unit="page" from="31" to="46" />
			<date type="published" when="2002" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b10">
	<analytic>
		<title level="a" type="main">Detecting differential gene expression with a semiparametric hierarchical mixture method</title>
		<author>
			<persName>
				<forename type="first">M</forename>
				<forename type="middle">A</forename>
				<surname>Newton</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Biostatistics</title>
		<imprint>
			<biblScope unit="volume">5</biblScope>
			<biblScope unit="page" from="155" to="176" />
			<date type="published" when="2004" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b11">
	<monogr>
		<title level="m" type="main">Clustering multivariate normal distributions Emerging Trends in Visual Computing</title>
		<author>
			<persName>
				<forename type="first">F</forename>
				<surname>Nielsen</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">R</forename>
				<surname>Nock</surname>
			</persName>
		</author>
		<editor>Nielsen,F.</editor>
		<imprint>
			<date type="published" when="2009" />
			<publisher>Springer</publisher>
			<biblScope unit="page" from="164" to="174" />
			<pubPlace>Berlin/Heidelberg</pubPlace>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b12">
	<analytic>
		<title level="a" type="main">Linear models and empirical bayes methods for assessing differential expression in microarray experiments</title>
		<author>
			<persName>
				<forename type="first">G</forename>
				<forename type="middle">K</forename>
				<surname>Smyth</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Stat. Appl. Genet. Mol. Biol</title>
		<imprint>
			<biblScope unit="volume">3</biblScope>
			<biblScope unit="issue">3</biblScope>
			<date type="published" when="2004" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b13">
	<analytic>
		<title level="a" type="main">Statistical significance for genome-wide studies</title>
		<author>
			<persName>
				<forename type="first">J</forename>
				<forename type="middle">D</forename>
				<surname>Storey</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">R</forename>
				<surname>Tibshirani</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proc. Natl Acad. Sci. USA</title>
		<meeting>. Natl Acad. Sci. USA</meeting>
		<imprint>
			<date type="published" when="2003" />
			<biblScope unit="page" from="9440" to="9445" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b14">
	<analytic>
		<title level="a" type="main">Significance analysis of time course microarray experiments</title>
		<author>
			<persName>
				<forename type="first">J</forename>
				<forename type="middle">D</forename>
				<surname>Storey</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proc. Natl Acad. Sci. USA</title>
		<meeting>. Natl Acad. Sci. USA</meeting>
		<imprint>
			<date type="published" when="2005" />
			<biblScope unit="page" from="12837" to="12842" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b15">
	<analytic>
		<title level="a" type="main">The optimal discovery procedure for large significance testing, with applications to comparative microarray experiments</title>
		<author>
			<persName>
				<forename type="first">J</forename>
				<forename type="middle">D</forename>
				<surname>Storey</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Biostatistics</title>
		<imprint>
			<biblScope unit="volume">8</biblScope>
			<biblScope unit="page" from="414" to="432" />
			<date type="published" when="2007" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b16">
	<analytic>
		<title level="a" type="main">The optimal discovery procedure: A new approach to simultaneous significance testing</title>
		<author>
			<persName>
				<forename type="first">J</forename>
				<forename type="middle">D</forename>
				<surname>Storey</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Roy. Stat. Soc. Ser. B</title>
		<imprint>
			<biblScope unit="volume">69</biblScope>
			<biblScope unit="page" from="347" to="368" />
			<date type="published" when="2007" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b17">
	<analytic>
		<title level="a" type="main">Significance analysis of microarrays applied to the ionizing radiation response</title>
		<author>
			<persName>
				<forename type="first">V</forename>
				<forename type="middle">G</forename>
				<surname>Tusher</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proc. Natl Acad. Sci. USA, 98</title>
		<meeting>. Natl Acad. Sci. USA, 98</meeting>
		<imprint>
			<date type="published" when="2001" />
			<biblScope unit="page" from="5116" to="5121" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b18">
	<analytic>
		<title level="a" type="main">A general framework for weighted gene co-expression network analysis</title>
		<author>
			<persName>
				<forename type="first">B</forename>
				<surname>Zhang</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">S</forename>
				<surname>Horvath</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Stat. Appl. Genet. Mol. Biol</title>
		<imprint>
			<biblScope unit="volume">4</biblScope>
			<biblScope unit="page">17</biblScope>
			<date type="published" when="2005" />
		</imprint>
	</monogr>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>