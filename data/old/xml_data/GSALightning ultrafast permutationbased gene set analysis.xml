
<?xml version="1.0" encoding="UTF-8"?>
<TEI xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 /home/joey/Project/grobid/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<encodingDesc>
			<appInfo>
				<application version="0.4.2-SNAPSHOT" ident="GROBID" when="2017-08-10T23:44+0000">
					<ref target="https://github.com/kermitt2/grobid">GROBID - A machine learning software for extracting information from scholarly documents</ref>
				</application>
			</appInfo>
		</encodingDesc>
		<fileDesc>
			<titleStmt>
				<title level="a" type="main">GSA-Lightning: ultra-fast permutation-based gene set analysis</title>
			</titleStmt>
			<publicationStmt>
				<publisher/>
				<availability status="unknown"><licence/></availability>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author>
							<persName>
								<forename type="first">Billy</forename>
								<surname>Heung</surname>
							</persName>
						</author>
						<author>
							<persName>
								<forename type="first">Wing</forename>
								<surname>Chang</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department" key="dep1">Department of Biostatistics and Computational Biology</orgName>
								<orgName type="department" key="dep2">School of Life Sciences</orgName>
								<orgName type="laboratory">State Key Laboratory of Genetic Engineering and Collaborative Innovation Center for Genetics and Development</orgName>
								<orgName type="institution">Fudan University</orgName>
								<address>
									<postCode>200436</postCode>
									<settlement>Shanghai</settlement>
									<country>People&apos;s Republic of China</country>
								</address>
							</affiliation>
							<affiliation key="aff1">
								<orgName type="institution" key="instit1">Jockey Club School of Public Health and Primary Care</orgName>
								<orgName type="institution" key="instit2">Chinese University of Hong Kong</orgName>
								<address>
									<settlement>Shatin, Hong Kong SAR</settlement>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Weidong</forename>
								<surname>Tian</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department" key="dep1">Department of Biostatistics and Computational Biology</orgName>
								<orgName type="department" key="dep2">School of Life Sciences</orgName>
								<orgName type="laboratory">State Key Laboratory of Genetic Engineering and Collaborative Innovation Center for Genetics and Development</orgName>
								<orgName type="institution">Fudan University</orgName>
								<address>
									<postCode>200436</postCode>
									<settlement>Shanghai</settlement>
									<country>People&apos;s Republic of China</country>
								</address>
							</affiliation>
						</author>
						<title level="a" type="main">GSA-Lightning: ultra-fast permutation-based gene set analysis</title>
					</analytic>
					<monogr>
						<imprint>
							<date/>
						</imprint>
					</monogr>
					<idno type="DOI">10.1093/bioinformatics/btw349</idno>
					<note type="submission">Received on October 27, 2015; revised on May 2, 2016; accepted on May 30, 2016</note>
					<note>Gene expression *To whom correspondence should be addressed. Associate Editor: Janet Kelso Contact: weidong.tian@fudan.edu.cn Supplementary information: Supplementary data are available at Bioinformatics online.</note>
				</biblStruct>
			</sourceDesc>
		</fileDesc>
		<profileDesc>
			<abstract>
				<p>The computational speed of many gene set analysis methods can be slow due to the com-putationally demanding permutation step. This article introduces GSA-Lightning, a fast implementation of permutation-based gene set analysis. GSA-Lightning achieves significant speedup compared with existing methods, particularly when the number of gene sets and permutations are large. Availability and implementation: The GSA-Lightning R package is available on Github at https:// github.com/billyhw/GSALightning and on R Bioconductor. The package also contains a comprehensive user&apos;s guide with a step-by-step tutorial vignette.</p>
			</abstract>
		</profileDesc>
	</teiHeader>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1">Introduction</head><p>Gene set analysis embodies a range of techniques for analyzing the functional and biological properties of differentially-expressed genes. One common type of gene set analysis method, termed selfcontained method (<ref type="bibr" target="#b6">Goeman and Bü hlmann, 2007</ref>), tests whether genes within a predefined gene-set are collectively differentially expressed across two different experimental conditions. The gene set's significance is typically assessed through permutation testing. Due to the computationally-demanding permutation tests, the speed of permutation-based gene set analysis methods is often compromised. There is a need to address this computation issue, particularly when performing large-scale analysis. As an example, for a genome-wide expression analysis of target genes of regulatory elements (<ref type="bibr" target="#b12">Yao et al., 2015</ref>), the number of gene sets, each set being the target genes of a regulatory element, can reach tens of thousands. If there areexpression measurements, and the gene set statistics are functions of the mean of the individual statistics. All these quantities can be computed efficiently using matrix products. Also, it is actually possible to perform the permutations using matrix products. The online Supplementary Materials provide details on how this can be done. Speed and memory efficiency are further increased by using sparse matrix computations whenever possible. When the number of permutations is large, GSA-Lightning breaks the permutations into batches. Each batch is handled separately and then combined to obtain the final results. The online Supplementary Materials provide further details, and also contain a justification of the equivalence between GSA-Lightning and GSA by comparing the two methods' program outputs. This justifies that GSA-Lightning does not sacrifice GSA's accuracy in order to achieve the speedup.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3">Results</head><p>Only methods with R implementations were compared to ensure hardware-independent results. Focusing on permutation-based twosample testing, non-permutation-based methods were not compared. GSA-Lightning (with the 'maxmean' option and restandardization) was compared with six other methods using their default options unless stated otherwise. These methods were GSA (with the 'maxmean' option and restandardization) (<ref type="bibr" target="#b5">Efron and Tibshirani, 2007</ref>), gseattperm from the R Bioconductor package Category, the self-contained version of SigPathway (<ref type="bibr" target="#b11">Tian et al., 2005</ref>), SAFE (<ref type="bibr" target="#b4">Barry et al., 2005</ref>), Globaltest (<ref type="bibr" target="#b7">Goeman et al., 2004</ref>) and PADOG (<ref type="bibr" target="#b9">Tarca et al., 2012</ref>). All analyses were performed using a MacBook Pro with a 2.3 GHz Intel Core i7 processor and 16 GB RAM. The gene sets used were the target genes of 36 381 distal regulatory elements from (<ref type="bibr" target="#b8">Lu et al., 2013</ref>) with three or more target genes. The breast cancer data set from The Cancer Genome Atlas (The Cancer Genome Atlas Research<ref type="bibr">Network, 2013</ref>) downloaded using the ELMER R Bioconductor package (<ref type="bibr" target="#b12">Yao et al., 2015</ref>) was used as the gene expression data. The data set contained gene expression measures for 114 controls and 1104 patients. After removing genes without matching gene symbols and/or with 0 sample variance, 20 038 genes remained for further analysis. Three speed trials were performed to examine the speed of the various methods. First, the number of gene sets was fixed at 500, and the number of permutations varied from 500 to 10 6. Second, the number of permutations was fixed at 1000, and the number of gene sets varied from 500 to 30 000. The third trial mimics a more realistic scenario: the numbers of gene sets were the same as in the second trial, but the number of permutations varied according to 2 Â (no. genesets)/0.05. This number of permutations ensured accurate P-value estimation even after multiple correction at significance level 0.05. Only GSA-Lightning, SigPathway, and Globaltest were tested in this trial as the other methods were too slow here.<ref type="figure" target="#fig_0">Figure 1</ref>presents the results. GSA, SAFE and PADOG were not run for number of permutations &gt;10 000, and gseattperm was not run for &gt;50 000 permutations since these methods were too slow. Also, SigPathway and Globaltest encountered memory issues when the numbers of permutations were respectively &gt;10 6 and 10 5 in the first trial, and when the number of gene sets was &gt;5000 in the third trial, and hence were not performed there. GSA-Lightning was faster than all other methods. In particular,<ref type="figure" target="#fig_0">Figure 1c</ref>suggests that GSALightning was the only method that could analyze large amounts of gene sets with a large number of permutations within reasonable time. In the experiments above, the maximum RAM usage for GSALightning was 4 GB. A speed comparison between the different gene set statistics, with or without restandardization, for GSA-Lightning and GSA is provided in the online Supplementary Materials. Note that all the methods compared earlier are based on different test statistics. The results and sensitivity of these methods will therefore be different, depending on the data set and the methods' assumptions. Nevertheless, a recent review considered GSA with the 'maxmean' statistics one of the better gene set analysis methods (<ref type="bibr" target="#b9">Tarca et al., 2013</ref>). By virtue of GSA's strengths, a fast version of GSA is worth developing. Also, a detailed speed comparison would involve comparing separately the speed for calculating the individual gene statistics, the gene set statistics, and the permutation. Such comparison is beyond the scope of this article. Still, for large-scale gene set analysis, the results above suggest that GSA-Lightning is the only possible option among the methods compared. Altogether, GSALightning is a tool capable of performing large-scale gene set analysis with statistical power guarantee.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Funding</head></div><figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_0"><head>Fig.1.</head><figDesc>Fig. 1. Speed trial results. (a) Varying number of permutations when the number of gene sets is fixed at 500. (b) Varying number of gene sets when the number of permutations is fixed at 1000. (c) Varying number of gene sets and number of permutations. See body text for details. Note the x-axis of all three plots are on the log-scale</figDesc></figure>

			<note place="foot" n="30"> 000 gene sets, the significance level of 0.05 becomes 1.67 Â 10 –6 after Bonferroni correction. One million permutations are now required for accurate P-values estimation. Most existing methods are computationally infeasible in this case, due to the large number of gene sets and number of permutations required. This article introduces GSA-Lightning, a fast and memory-efficient implementation of permutation-based gene set analysis. Through a speed comparison of GSA-Lightning and other existing permutation-based gene set analysis methods, we demonstrate that GSA-Lightning is computationally much more efficient, particularly when the number of gene sets and permutations are large. 2 Implementation GSA-Lightning is based on the GSA method (Efron and Tibshirani, 2007). GSA-Lightning computes the student-T statistics for each individual gene, and provides the &apos;maxmean&apos;, &apos;mean&apos; and &apos;absolutemean&apos; options for combining the individual gene statistics into gene set statistics. Similar to GSA, GSA-Lightning provides the restandardization procedure and further supports independent and paired two-sample tests. GSA-Lightning takes advantage of R&apos;s efficiency in matrix computations, and achieves substantial speedup by calculating the gene set statistics and their permutation distributions through matrix computations. Indeed, the student-T statistics mainly depends only on the mean and standard deviation of the V C The Author 2016. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com 1 Bioinformatics, 2016, 1–3 doi: 10.1093/bioinformatics/btw349 Advance Access Publication Date: 13 June 2016 Applications Note Bioinformatics Advance Access published July 6, 2016 at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>

			<note place="foot">B.H.W.Chang and W.Tian at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>

			<note place="foot">at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>
		</body>
		<back>

			<div type="acknowledgement">
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Acknowledgements</head><p>We thank Xinran Dong for providing earlier speed benchmarking results, and the anonymous reviewers for helpful comments on the article and the R package.</p></div>
			</div>

			<div type="references">

				<listBibl>

<biblStruct   xml:id="b0">
	<analytic>
		<title/>
	</analytic>
	<monogr>
		<title level="m">the Innovation Program of Shanghai Municipal Education Commission</title>
		<imprint>
			<date>20120071110018</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b1">
	<analytic>
		<title/>
	</analytic>
	<monogr>
		<title level="j">Shanghai Municipal Science and Technology Commission</title>
		<imprint>
			<date>12431900100</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b2">
	<monogr>
		<title level="m" type="main">Conflict of Interest: none declared</title>
		<imprint/>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b3">
	<analytic>
		<title/>
	</analytic>
	<monogr>
		<title level="j">References</title>
		<imprint/>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b4">
	<analytic>
		<title level="a" type="main">Significance analysis of functional categories in gene expression studies: a structured permutation approach</title>
		<author>
			<persName>
				<forename type="first">W</forename>
				<surname>Barry</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">21</biblScope>
			<biblScope unit="page" from="1943" to="1949" />
			<date type="published" when="2005" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b5">
	<analytic>
		<title level="a" type="main">On testing the significance of sets of genes</title>
		<author>
			<persName>
				<forename type="first">B</forename>
				<surname>Efron</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">R</forename>
				<surname>Tibshirani</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Ann. Appl. Stat</title>
		<imprint>
			<biblScope unit="volume">1</biblScope>
			<biblScope unit="page" from="107" to="129" />
			<date type="published" when="2007" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b6">
	<analytic>
		<title level="a" type="main">Analyzing gene expression data in terms of gene sets: methodological issues</title>
		<author>
			<persName>
				<forename type="first">J</forename>
				<surname>Goeman</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">P</forename>
				<surname>Bü Hlmann</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">23</biblScope>
			<biblScope unit="page" from="980" to="987" />
			<date type="published" when="2007" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b7">
	<analytic>
		<title level="a" type="main">A global test for groups of genes: testing association with a clinical outcome</title>
		<author>
			<persName>
				<forename type="first">J</forename>
				<surname>Goeman</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">20</biblScope>
			<biblScope unit="page" from="93" to="99" />
			<date type="published" when="2004" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b8">
	<analytic>
		<title level="a" type="main">Combining Hi-C data with phylogenetic correlation to predict the target genes of distal regulatory elements in human genome</title>
		<author>
			<persName>
				<forename type="first">Y</forename>
				<surname>Lu</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nucleic Acid Res</title>
		<imprint>
			<biblScope unit="volume">41</biblScope>
			<biblScope unit="page" from="10391" to="10402" />
			<date type="published" when="2013" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b9">
	<analytic>
		<title level="a" type="main">Down-weighting overlapping genes improves gene set analysis A comparison of gene set analysis methods in terms of sensitivity, prioritization and specificity</title>
		<author>
			<persName>
				<forename type="first">A</forename>
				<surname>Tarca</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">BMC Bioinformatics PLoS One</title>
		<imprint>
			<biblScope unit="volume">13</biblScope>
			<biblScope unit="issue">8</biblScope>
			<biblScope unit="page">79217</biblScope>
			<date type="published" when="2012" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b10">
	<analytic>
		<title level="a" type="main">The Cancer Genome Atlas Research Network. (2013) The Cancer Genome Atlas Pan-Cancer analysis project</title>
	</analytic>
	<monogr>
		<title level="j">Nat. Genet</title>
		<imprint>
			<biblScope unit="volume">45</biblScope>
			<biblScope unit="page" from="1113" to="1120" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b11">
	<analytic>
		<title level="a" type="main">Discovering statistically significant pathways in expression profiling studies</title>
		<author>
			<persName>
				<forename type="first">L</forename>
				<surname>Tian</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proc. Natl. Acad. Sci. USA</title>
		<meeting>. Natl. Acad. Sci. USA</meeting>
		<imprint>
			<date type="published" when="2005" />
			<biblScope unit="page" from="13544" to="13549" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b12">
	<analytic>
		<title level="a" type="main">Inferring regulatory element landscapes and transcription factor networks from cancer methylomes</title>
		<author>
			<persName>
				<forename type="first">L</forename>
				<surname>Yao</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Genome Biol</title>
		<imprint>
			<biblScope unit="volume">16</biblScope>
			<biblScope unit="page">105</biblScope>
			<date type="published" when="2015" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b13">
	<monogr>
		<title level="m" type="main">Ultra-fast permutation-based gene set analysis</title>
		<imprint/>
	</monogr>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>