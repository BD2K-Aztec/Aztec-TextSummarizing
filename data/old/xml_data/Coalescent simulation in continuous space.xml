
<?xml version="1.0" encoding="UTF-8"?>
<TEI xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 /home/joey/Project/grobid/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<encodingDesc>
			<appInfo>
				<application version="0.4.2-SNAPSHOT" ident="GROBID" when="2017-08-10T23:55+0000">
					<ref target="https://github.com/kermitt2/grobid">GROBID - A machine learning software for extracting information from scholarly documents</ref>
				</application>
			</appInfo>
		</encodingDesc>
		<fileDesc>
			<titleStmt>
				<title level="a" type="main">Genetics and population analysis Coalescent simulation in continuous space</title>
			</titleStmt>
			<publicationStmt>
				<publisher/>
				<availability status="unknown"><licence/></availability>
				<date type="published" when="2013">7 2013</date>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author>
							<persName>
								<forename type="first">Jerome</forename>
								<surname>Kelleher</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department">Institute of Evolutionary Biology</orgName>
								<orgName type="institution">University of Edinburgh</orgName>
								<address>
									<addrLine>King&apos;s Buildings, West Mains Road</addrLine>
									<postCode>EH9 3JT</postCode>
									<country key="GB">UK</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Nicholas</forename>
								<forename type="middle">H</forename>
								<surname>Barton</surname>
							</persName>
							<affiliation key="aff1">
								<orgName type="department">Institute of Science and Technology</orgName>
								<address>
									<addrLine>Am Campus I</addrLine>
									<postCode>A-3400</postCode>
									<settlement>Klosterneuberg</settlement>
									<country key="AT">Austria</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Alison</forename>
								<forename type="middle">M</forename>
								<surname>Etheridge</surname>
							</persName>
							<affiliation key="aff2">
								<orgName type="department">Department of Statistics</orgName>
								<orgName type="institution">University of Oxford</orgName>
								<address>
									<addrLine>1 South Parks Road</addrLine>
									<postCode>OX1 3TG</postCode>
									<settlement>Oxford</settlement>
									<country key="GB">UK</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Jeffrey</forename>
								<surname>Barrett</surname>
							</persName>
						</author>
						<title level="a" type="main">Genetics and population analysis Coalescent simulation in continuous space</title>
					</analytic>
					<monogr>
						<imprint>
							<biblScope unit="volume">29</biblScope>
							<biblScope unit="page" from="955" to="956"/>
							<date type="published" when="2013">7 2013</date>
						</imprint>
					</monogr>
					<idno type="DOI">10.1093/bioinformatics/btt067</idno>
					<note type="submission">Received on November 16, 2012; revised on January 30, 2013; accepted on February 5, 2013</note>
					<note>Package available at http://pypi.python.org/pypi/ercs Contact: jerome.kelleher@ed.ac.uk Supplementary information: Supplementary data are available at Bioinformatics online.</note>
				</biblStruct>
			</sourceDesc>
		</fileDesc>
		<profileDesc>
			<abstract>
				<p>Coalescent simulation has become an indispensable tool in population genetics, and many complex evolutionary scenarios have been incorporated into the basic algorithm. Despite many years of intense interest in spatial structure, however, there are no available methods to simulate the ancestry of a sample of genes that occupy a spatial continuum. This is mainly due to the severe technical problems encountered by the classical model of isolation by distance. A recently introduced model solves these technical problems and provides a solid theoretical basis for the study of populations evolving in continuous space. We present a detailed algorithm to simulate the coalescent process in this model, and provide an efficient implementation of a generalized version of this algorithm as a freely available Python module. Availability:</p>
			</abstract>
		</profileDesc>
	</teiHeader>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1">INTRODUCTION</head><p>The extinction/recolonization model (or spatial Ã-Fleming-Viot process) is a recently introduced model (<ref type="bibr" target="#b3">Etheridge, 2008</ref>) that captures the dynamics of populations evolving in a spatial continuum (<ref type="bibr">Barton et al., 2010a,b</ref>). The model solves long-standing problems (<ref type="bibr" target="#b5">Felsenstein, 1975)</ref>with the classical models of isolation by distance (<ref type="bibr" target="#b9">Wright, 1943;</ref><ref type="bibr" target="#b8">Male´cotMale´cot, 1948</ref>) and has the potential to explain key biological facts that cannot be captured by simple diffusion (<ref type="bibr" target="#b1">Barton et al., 2010b</ref>). In this model, each individual occupies a fixed location in continuous space and all movement and reproduction happen as the consequence of extinction/recolonization events. Events fall randomly throughout space, independent (crucially) of the location of extant individuals. At an event, some fraction of the individuals nearby die, to be replaced by the offspring of a small number of parents chosen from the nearby population immediately before the event. Events at different scales model the effects of life history and demography. For example, the regular reproduction of individuals may be modelled by means of small and frequent events in which a few individuals in a local area die and are replaced by the progeny of nearby parents. On the other hand, broad-scale mortality events can affect a substantial fraction of the population over the entire species range. See<ref type="bibr" target="#b2">Barton et al. (2013)</ref>for an extensive review of the model, its applications and background.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2">SINGLE LOCUS ALGORITHM</head><p>The coalescent process for the extinction/recolonization model at a single locus is straightforward (<ref type="bibr" target="#b1">Barton et al., 2010b</ref>), and we describe a detailed algorithm to simulate this process in this section. In the interest of simplicity, here we restrict ourselves to a single class of event from the disc model (<ref type="bibr" target="#b0">Barton et al., 2010a</ref>) in which events have a fixed radius r; within these discs, a single parent is chosen uniformly and individuals die with probability u. The algorithm is described in terms of oriented trees (Knuth, 2011, p. 461). In an oriented tree, parent–child relationships are important but the order of children at a node is not. This information is encoded as a sequence 1. .. n , where j is the parent of node j and node j is a root if j ¼ 0. Oriented trees have several advantages over more traditional approaches to encoding genealogies such as nested parentheses or linked structures. They provide a concise and elegant means of describing genealogies, are trivial to store and parse, and can be annotated with additional information without effort. Finally, as oriented trees are simple lists of integers, we can describe coalescent algorithms precisely and without ambiguity. Let R U ðAÞ be an element of the set A chosen uniformly at random, and let R E ðÞ be an exponentially distributed random value with rate. Also, let Bðz, r, LÞ define a disc of radius r centred at z on a 2D torus of diameter L, and let ? denote the null point. Algorithm S (Single locus coalescent). Simulate the ancestry ð, Þ of individuals sampled at locations x 1. .. x n at time t ¼ 0 under a model in which events with radius r and impact u occur at rate on a 2D torus of diameter L. S1<ref type="bibr">[Initialization.]</ref>Set j 0, j 0 and j ? for 1 j52n. Then set j x j for 1 j n and set S f j j1 j ng. Finally, set n þ 1 and t 0. S2<ref type="bibr">[Event.]</ref>Set t t þ R E ðÞ and z R U ð½0, LÞ 2 Þ. S3<ref type="bibr">[Birth.]</ref>Set C ;. For each j 2 S, if j 2 Bðz, r, LÞ and R U ð½0, 1ÞÞ5u, set C C [ fjg. Afterwards, if jCj ¼ 0, go to S2; else, if jCj ¼ 1, go to S4; otherwise, go to S5. S4 [One lineage jumps.] Let C ¼ fjg, set j R U ðBðz, r, LÞÞ and go back to S2. S5<ref type="bibr">[Coalescence.]</ref>For each j 2 C, set j . Then, set t, R U ðBðz, r, LÞÞ, S ðS n CÞ [ fg and þ 1. Finally, if jSj41, go back to S2. *To whom correspondence should be addressed.Algorithm S operates by mapping individuals in the sample to the integers 1 j n and those ancestral to the sample to integers greater than n. The set S contains the lineages ancestral to the sample at time t, and we proceed backwards in time event-by-event. Because most events will not hit any lineages, the majority of the time spent in the algorithm is looping quickly around steps S2 and S3. Occasionally, a single lineage will be hit, we execute step S4 and move the lineage to a new location. Very rarely, an event hits more than one lineage, and C is the set of lineages born from a single parent. Thus, in step S5 we set the parent of each lineage in C to be and the location of to a random point within the ball defining the event. We then record that lineage entered the sample at time t by setting to t. Finally, we remove the children born in this event from the sample (as we are no longer interested in them) and insert into the sample (as we are interested in its further history). This process continues until there is one individual in the sample, and ð, Þ describes the full history of the sample.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3">MULTILOCUS ALGORITHM</head><p>The single locus model is extended to incorporate recombination by letting each individual in the sample consist of multiple loci and allowing for multiple parents in events, so that a given individual may descend from different parents at different loci. Specifically, we consider a model in which each individual has m linearly arranged loci and there are parents at each event. (In sexually reproducing species, ¼ 2 in small-scale reproduction events. We must consider the possibility of more than two parents in large-scale events, as several generations may elapse before the local area is repopulated.) For each child in an event, there is a probability ' that loci ' and ' þ 1 are inherited from different parents. See Etheridge and Ve´berVe´ber (2012) for more details. Simulating this multilocus coalescent follows the same pattern as Algorithm S: we begin with a sample of n lineages and proceed event-by-event until the ancestry of the sample is complete, and we have a pair ð, Þ describing the history at each locus. The sample S is most conveniently represented as a set of (location, ancestry) tuples ðx, a 1. .. a m Þ. Each sequence a 1. .. a m represents the ancestry of a lineage such that a ' 6 ¼ 0 if there is genetic material ancestral to the sample present in this lineage at locus ' and a ' ¼ 0 otherwise (<ref type="bibr" target="#b6">Hudson, 1983</ref>). Termination of the algorithm is controlled by maintaining the invariant</p><formula>¼ X ðx, aÞ2S X 1'm ½a ' 6 ¼ 0:</formula><p>Thus ¼ nm initially, and the algorithm terminates when ¼ m, indicating that all loci have coalesced. Suppose that C is the set of lineages born in an event. We must first decide which children descend from which parent at each locus. To do this, we first set k, ' ; for 1 k and 1 ' m. Then, for each child lineage a 1. .. a m 2 C we choose a parent for the first locus by setting k R U ðf1,. .. , gÞ. We then iterate over each locus 1 ' m, and if a ' 6 ¼ 0 (that is, there is ancestral material at this locus), we set k, '</p><formula>k, ' [ fa ' g.</formula><p>Then, with probability ' , a recombination event occurs and we choose a new parent for the next locus by setting k R U ðf1,. .. , g n fkgÞ. Having completed the task of deciding which children have descended from which parents, we must generate the new parental ancestry sequences and update the genealogies and node times. This is accomplished by examining the sets of descendants k, ' for each parent k at locus ' and proceeding in the same manner as algorithm S, updating , and for each locus as appropriate. This algorithm is far from optimal and can be improved in many ways to improve performance, particularly in special cases. It does provide a useful starting point for these special cases, however, and is easily adapted and analysed. A straightforward implementation of the algorithm in Python is included as Supplementary Material for reference.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4">IMPLEMENTATION</head><p>The multilocus coalescent algorithm described in the previous section is implemented as a Python module, ercs. The implementation supports an arbitrary number of event classes, including events from the Gaussian model (<ref type="bibr" target="#b1">Barton et al., 2010b</ref>), and incorporates spatial indexing to improve performance over the basic algorithm outlined here. The module is written primarily in C in the interest of efficiency and is distributed freely under the terms of the GNU General Public License.</p></div><figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_0"><head></head><figDesc>Funding: N.H.B. is supported by European Research Council grant 250152; A.M.E. is supported in part by EPSRC grant EP/I01361X/1 and J.K. is supported by EPSRC grant EP/I013091/1. Conflict of Interest: none declared.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_0" validated="false"><figDesc>ß The Author 2013. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com</figDesc><table></table></figure>

			<note place="foot">at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>

			<note place="foot">J.Kelleher et al. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>
		</body>
		<back>
			<div type="references">

				<listBibl>

<biblStruct   xml:id="b0">
	<analytic>
		<title level="a" type="main">A new model for evolution in a spatial continuum</title>
		<author>
			<persName>
				<forename type="first">N</forename>
				<forename type="middle">H</forename>
				<surname>Barton</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Electron. J. Probab</title>
		<imprint>
			<biblScope unit="volume">15</biblScope>
			<biblScope unit="page">7</biblScope>
			<date type="published" when="2010" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b1">
	<analytic>
		<title level="a" type="main">A new model for extinction and recolonisation in two dimensions: quantifying phylogeography</title>
		<author>
			<persName>
				<forename type="first">N</forename>
				<forename type="middle">H</forename>
				<surname>Barton</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Evolution</title>
		<imprint>
			<biblScope unit="volume">64</biblScope>
			<biblScope unit="page" from="2701" to="2715" />
			<date type="published" when="2010" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b2">
	<analytic>
		<title level="a" type="main">Modelling evolution in a spatial continuum</title>
		<author>
			<persName>
				<forename type="first">N</forename>
				<forename type="middle">H</forename>
				<surname>Barton</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Stat. Mech</title>
		<imprint>
			<biblScope unit="page">1002</biblScope>
			<date type="published" when="2013" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b3">
	<monogr>
		<title level="m" type="main">Drift, draft and structure: some mathematical models of evolution</title>
		<author>
			<persName>
				<forename type="first">A</forename>
				<forename type="middle">M</forename>
				<surname>Etheridge</surname>
			</persName>
		</author>
		<imprint>
			<date type="published" when="2008" />
			<publisher>Banach Center Publ</publisher>
			<biblScope unit="page" from="121" to="144" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b4">
	<analytic>
		<title level="a" type="main">The spatial Ã-Fleming-Viot process on a large torus: genealogies in the presence of recombination</title>
		<author>
			<persName>
				<forename type="first">A</forename>
				<forename type="middle">M</forename>
				<surname>Etheridge</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">A</forename>
				<surname>Ve´berve´ber</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Ann. Appl. Probab</title>
		<imprint>
			<biblScope unit="volume">22</biblScope>
			<biblScope unit="page" from="2165" to="2209" />
			<date type="published" when="2012" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b5">
	<analytic>
		<title level="a" type="main">A pain in the torus: some difficulties with the model of isolation by distance</title>
		<author>
			<persName>
				<forename type="first">J</forename>
				<surname>Felsenstein</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Am. Nat</title>
		<imprint>
			<biblScope unit="volume">109</biblScope>
			<biblScope unit="page" from="359" to="368" />
			<date type="published" when="1975" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b6">
	<analytic>
		<title level="a" type="main">Properties of a neutral allele model with intragenic recombination</title>
		<author>
			<persName>
				<forename type="first">R</forename>
				<forename type="middle">R</forename>
				<surname>Hudson</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Theor. Popul. Biol</title>
		<imprint>
			<biblScope unit="volume">23</biblScope>
			<biblScope unit="page" from="183" to="201" />
			<date type="published" when="1983" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b7">
	<analytic>
		<title level="a" type="main">Combinatorial algorithms</title>
		<author>
			<persName>
				<forename type="first">D</forename>
				<forename type="middle">E</forename>
				<surname>Knuth</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">The Art of Computer Programming</title>
		<meeting><address><addrLine>Upper Saddle River, New Jersey</addrLine></address></meeting>
		<imprint>
			<publisher>Addison Wesley</publisher>
			<date type="published" when="2011" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b8">
	<analytic>
		<title level="a" type="main">Les mathe´matiques de l&apos;he´re´dite´</title>
		<author>
			<persName>
				<forename type="first">G</forename>
				<surname>Male´cotmale´cot</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Masson et Cie</title>
		<imprint>
			<date type="published" when="1948" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b9">
	<analytic>
		<title level="a" type="main">Isolation by distance</title>
		<author>
			<persName>
				<forename type="first">S</forename>
				<surname>Wright</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Genetics</title>
		<imprint>
			<biblScope unit="volume">28</biblScope>
			<biblScope unit="page" from="114" to="138" />
			<date type="published" when="1943" />
		</imprint>
	</monogr>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>