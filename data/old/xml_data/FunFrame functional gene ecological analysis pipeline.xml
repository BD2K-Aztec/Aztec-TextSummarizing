
<?xml version="1.0" encoding="UTF-8"?>
<TEI xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 /home/joey/Project/grobid/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<encodingDesc>
			<appInfo>
				<application version="0.4.2-SNAPSHOT" ident="GROBID" when="2017-08-10T23:36+0000">
					<ref target="https://github.com/kermitt2/grobid">GROBID - A machine learning software for extracting information from scholarly documents</ref>
				</application>
			</appInfo>
		</encodingDesc>
		<fileDesc>
			<titleStmt>
				<title level="a" type="main">Sequence analysis FunFrame: functional gene ecological analysis pipeline</title>
			</titleStmt>
			<publicationStmt>
				<publisher/>
				<availability status="unknown"><licence/></availability>
				<date type="published" when="2013">2013</date>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author>
							<persName>
								<forename type="first">David</forename>
								<surname>Weisman</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department">Department of Biology</orgName>
								<orgName type="institution">University of Massachusetts Boston</orgName>
								<address>
									<postCode>02125</postCode>
									<settlement>Boston</settlement>
									<region>MA</region>
									<country key="US">USA</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Michie</forename>
								<surname>Yasuda</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department">Department of Biology</orgName>
								<orgName type="institution">University of Massachusetts Boston</orgName>
								<address>
									<postCode>02125</postCode>
									<settlement>Boston</settlement>
									<region>MA</region>
									<country key="US">USA</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Jennifer</forename>
								<forename type="middle">L</forename>
								<surname>Bowen</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department">Department of Biology</orgName>
								<orgName type="institution">University of Massachusetts Boston</orgName>
								<address>
									<postCode>02125</postCode>
									<settlement>Boston</settlement>
									<region>MA</region>
									<country key="US">USA</country>
								</address>
							</affiliation>
						</author>
						<title level="a" type="main">Sequence analysis FunFrame: functional gene ecological analysis pipeline</title>
					</analytic>
					<monogr>
						<imprint>
							<biblScope unit="volume">29</biblScope>
							<biblScope unit="issue">9</biblScope>
							<biblScope unit="page" from="1212" to="1214"/>
							<date type="published" when="2013">2013</date>
						</imprint>
					</monogr>
					<idno type="DOI">10.1093/bioinformatics/btt123</idno>
					<note type="submission">Received on November 9, 2012; revised on March 5, 2013; accepted on March 6, 2013</note>
					<note>Associate Editor: Inanc Birol Contact: Jennifer.Bowen@umb.edu Supplementary information: Supplementary data are available at Bioinformatics online.</note>
				</biblStruct>
			</sourceDesc>
		</fileDesc>
		<profileDesc>
			<abstract>
				<p>Pyrosequencing of 16S rDNA is widely used to study microbial communities, and a rich set of software tools support this analysis. Pyrosequencing of protein-coding genes, which can help elucidate functional differences among microbial communities, significantly lags behind 16S rDNA in availability of sequence analysis software. In both settings, frequent homopolymer read errors inflate the estimation of microbial diversity, and de-noising is required to reduce that bias. Here we describe FunFrame, an R-based data-analysis pipeline that uses recently described algorithms to de-noise functional gene pyrosequences and performs ecological analysis on de-noised sequence data. The novelty of this pipeline is that it provides users a unified set of tools, adapted from disparate sources and designed for different applications, that can be used to examine a particular protein coding gene of interest. We evaluated FunFrame on functional genes from four PCR-amplified clones with sequence depths ranging from 9084 to 14 494 sequences. FunFrame produced from one to nine Operational Taxanomic Units for each clone, resulting in an error rate ranging from 0 to 0.18%. Importantly, FunFrame reduced spurious diversity while retaining more sequences than a commonly used de-noising method that discards sequences with frameshift errors. Availability: Software, documentation and a complete set of sample data files are available at</p>
			</abstract>
		</profileDesc>
	</teiHeader>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1">INTRODUCTION</head><p>Pyrosequencing of 16S rDNA is commonly used to study microbial community structure, and existing bioinformatics pipelines are primarily designed for the analysis of 16S rDNA (<ref type="bibr">Caporaso et al., 2010b;</ref><ref type="bibr" target="#b4">Schloss et al., 2009</ref>). Noise from DNA sequencing errors upwardly biases the estimates of microbial diversity (<ref type="bibr">Huse et al., 2007;</ref><ref type="bibr">Kunin et al., 2010</ref>). Substantial progress has been made to remove noise artifacts from 16S rDNA sequence datasets (<ref type="bibr">Huse et al., 2010;</ref><ref type="bibr" target="#b0">Quince et al., 2009</ref><ref type="bibr" target="#b1">Quince et al., , 2011</ref>). Targeted metagenomics of protein-coding genes offers the possibility of focusing on the diversity, abundance and expression of specific genes, particularly those genes that encode enzymes critical to biogeochemical cycling. Protein-coding sequences fundamentally differ from non-coding 16S rDNA in that the genetic code implicitly constrains the sequences to the 61 amino-coding triplets. This distinction is particularly relevant with pyrosequencing, as the technology is prone to misread the lengths of long homopolymers, thereby creating the appearance of frameshift mutations. To reduce the inflated diversity bias with proteincoding genes, a commonly used approach discards sequences containing unexpected stop codons (<ref type="bibr">Jones et al., 2008;</ref><ref type="bibr">Iwai et al., 2010;</ref><ref type="bibr" target="#b3">Rozera et al., 2009</ref>). A more nuanced error detection algorithm, HMM-FRAME, was recently introduced (<ref type="bibr" target="#b5">Zhang and Sun, 2011</ref>). In HMM-FRAME, a hidden Markov model (HMM) of the target protein, combined with a probabilistic model of homopolymer errors, detects and corrects the frameshifts caused by homopolymer read errors. In addition, the algorithm reports HMM alignment scores, which can be used in downstream quality filtering. To facilitate targeted metagenomics using PCR-amplified protein-coding genes, we produced FunFrame, a complete bioinformatics pipeline that uses HMM-FRAME followed by chimera detection, Operational Taxanomic Unit (OTU) clustering, rarefaction and diversity estimation (Supplementary<ref type="figure" target="#fig_0">Fig. S1</ref>). Additionally, FunFrame performs clustering and ordination using UniFrac and Bray–Curtis metrics (Supplementary Figs S2 and S3). Contrasting with the 16S rDNA pipelines QIIME (<ref type="bibr">Caporaso et al., 2010b</ref>) and Mothur (<ref type="bibr" target="#b4">Schloss et al., 2009</ref>), FunFrame centers around the R Project for Statistical Computing (R Core<ref type="bibr" target="#b2">Team, 2012</ref>), which facilitates analysis with a rich set of ecological, statistical and visualization tools (<ref type="bibr">Borcard et al., 2011;</ref><ref type="bibr">Oksanen et al., 2011</ref>).</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2">METHODS</head><p>The FunFrame pipeline begins with HMM-FRAME (<ref type="bibr" target="#b5">Zhang and Sun, 2011</ref>) for pyrosequencing error analysis; UCHIME (<ref type="bibr">Edgar et al., 2011</ref>) for chimera detection (running in de novo mode without a reference database) and ESPRIT-Tree (<ref type="bibr">Cai and Sun, 2011</ref>) for OTU clustering. FunFrame performs ecological analyses on the resulting OTU table. Sub-sampled diversity estimation is computed with QIIME (<ref type="bibr">Caporaso et al., 2010b</ref>). Bray–Curtis distances of Hellinger-transformed counts are computed in Vegan (<ref type="bibr">Oksanen et al., 2011</ref>). To compute unweighted and weighted UniFrac metrics (<ref type="bibr">Hamady et al., 2010</ref>), representative OTUs are aligned with PyNAST (<ref type="bibr">Caporaso et al., 2010a</ref>), a phylogeny is inferred using FastTree (<ref type="bibr">Price et al., 2010</ref>) and UniFrac metrics are computed from the tree. Principal coordinates analysis and hierarchical clustering are performed in R on the Bray–Curtis and UniFrac metrics. Rarefaction curves and alpha diversity estimates are computed in Vegan. Redundancy analysis and constrained correspondence analysis are computed with user-supplied environmental variables and displayed as biplots using Vegan. FunFrame programs are written in R and Python. A bash script runs the full pipeline; alternatively, users can run pipeline stages individually. *To whom correspondence should be addressed. A user-customizable configuration file specifies all parameter settings. Installation and operating instructions are provided with the software distribution, as are sample data with expected outputs. Environmental clones containing the gene nirS, a gene in the microbial denitrification pathway (<ref type="bibr" target="#b6">Zumft, 1997</ref>), were prepared (GenBank accessions KC203032–KC203035) and sequenced along with amplicon libraries (Supplementary<ref type="figure">Table S1</ref>) of environmental samples taken from sediments of the Great Sippewissett Salt Marsh, Cape Cod, MA, USA (Supplementary Methods). Sequences mismatching the 5 0 primer or having ambiguous bases were removed, and remaining sequences were trimmed to 432 bp. With these inputs, we ran FunFrame using the cytochrome D1 HMM from Pfam (accession PF02239.10), and retained sequences with HMM scores485. OTUs were defined as sequences within a 0.05 divergence. To compare FunFrame against stop-codon filtering, FunFrame was modified to replace HMM-FRAME with logic that translates sequences in three reading frames, and retains those with a full reading frame.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3">RESULTS AND DISCUSSION</head><p>In evaluating HMM-FRAME over the stop-codon filtering approach, we sought two objectives. First, we wanted to minimize the upward diversity estimation bias due to homopolymer errors, and we measured this property by analyzing the OTU counts of four clone libraries, measured at sequence depths of 9084, 5780, 11 382 and 14 494. Of these four libraries, FunFrame reported 9, 3, 3 and 1 OTUs per clone, whereas the stop-codon filter approach reported 11, 4, 3 and 2 OTUs per clone, respectively (Supplementary<ref type="figure">Table S2</ref>).<ref type="figure" target="#fig_0">Figure 1</ref>shows that FunFrame produces lower OTU counts than stop-codon filtering. Our second objective was to maximize the number of nonnoisy sequences retained, which effectively increases the likelihood of detecting rare species. Starting with 119 663 total reads, the HMM filtering approach retained 117 659 (98%) reads, whereas stop-codon filtering retained 104 347 (87%) reads. After subsequent chimera detection, FunFrame retained 108 603 (91%) versus 95 902 (80%) reads for stop-codon filtering (Supplementary<ref type="figure">Table S3</ref>). This improvement is reflected in the greater number of sequences shown in the solid, compared with the dotted, lines in<ref type="figure" target="#fig_0">Figure 1</ref>. Analysis of these data demonstrates the pipeline's capacity to uncover ecologically meaningful patterns in environmental sequences (Supplementary Figs S2 and S3). In both criteria, FunFrame performed better than the stopcodon approach. FunFrame discards sequences with HMM scores below a configurable threshold, and adjusting this threshold can trade-off sequencing depth for OTU inflation. The results indicate that this parameter can be set such that both objectives exceed the results from the stop-codon filtering approach. Microbial ecological analysis based on functional genes is an enormously powerful paradigm, which we believe will become widely used as DNA sequencing costs continue to decline. We offer FunFrame to the community with the hope that it will contribute to the development of this important area.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>ACKNOWLEDGEMENTS</head><p>Hilary Morrison performed the pyrosequencing at the Marine Biological Laboratory. Sarah Hallin and Chris Jones kindly contributed their exceptionally well-curated nirS alignment. We thank an anonymous reviewer for making substantial and valuable technical suggestions.</p></div><figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_0"><head>Fig.1.</head><figDesc>Fig. 1. Rarefaction curves based on FunFrame compared with stopcodon filtering. Colors represent biological samples; solid and dotted lines produced by FunFrame and stop-codon filtering, respectively. FunFrame tends to retain more sequences and produce less OTU inflation</figDesc></figure>

			<note place="foot">ß The Author 2013. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>

			<note place="foot">FunFrame at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>

			<note place="foot">D.Weisman et al. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>
		</body>
		<back>
			<div type="references">

				<listBibl>

<biblStruct   xml:id="b0">
	<analytic>
		<title level="a" type="main">Accurate determination of microbial diversity from 454 pyrosequencing data</title>
		<author>
			<persName>
				<forename type="first">C</forename>
				<surname>Quince</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nat. Methods</title>
		<imprint>
			<biblScope unit="volume">6</biblScope>
			<biblScope unit="page" from="639" to="641" />
			<date type="published" when="2009" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b1">
	<analytic>
		<title level="a" type="main">Removing noise from pyrosequenced amplicons</title>
		<author>
			<persName>
				<forename type="first">C</forename>
				<surname>Quince</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">BMC Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">12</biblScope>
			<biblScope unit="page">38</biblScope>
			<date type="published" when="2011" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b2">
	<monogr>
		<title level="m" type="main">R: A Language and Environment for Statistical Computing. R Foundation for Statistical Computing</title>
		<author>
			<persName>
				<forename type="first">R</forename>
				<surname>Core Team</surname>
			</persName>
		</author>
		<imprint>
			<date type="published" when="2012" />
			<pubPlace>Vienna, Austria</pubPlace>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b3">
	<analytic>
		<title level="a" type="main">Massively parallel pyrosequencing highlights minority variants in the HIV-1 ENV quasispecies deriving from lymphomonocyte sub-populations</title>
		<author>
			<persName>
				<forename type="first">G</forename>
				<surname>Rozera</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Retrovirology</title>
		<imprint>
			<biblScope unit="volume">6</biblScope>
			<biblScope unit="page">15</biblScope>
			<date type="published" when="2009" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b4">
	<analytic>
		<title level="a" type="main">Introducing mothur: open-source, platform-independent, community-supported software for describing and comparing microbial communities</title>
		<author>
			<persName>
				<forename type="first">P</forename>
				<forename type="middle">D</forename>
				<surname>Schloss</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Appl. Environ. Microbiol</title>
		<imprint>
			<biblScope unit="volume">75</biblScope>
			<biblScope unit="page" from="7537" to="7541" />
			<date type="published" when="2009" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b5">
	<analytic>
		<title level="a" type="main">Hmm-frame: accurate protein domain classification for metagenomic sequences containing frameshift errors</title>
		<author>
			<persName>
				<forename type="first">Y</forename>
				<surname>Zhang</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">Y</forename>
				<surname>Sun</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">BMC Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">12</biblScope>
			<date type="published" when="0198" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b6">
	<analytic>
		<title level="a" type="main">Cell biology and molecular basis of denitrification</title>
		<author>
			<persName>
				<forename type="first">W</forename>
				<forename type="middle">G</forename>
				<surname>Zumft</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Microbiol. Mol. Biol. Rev</title>
		<imprint>
			<biblScope unit="volume">61</biblScope>
			<biblScope unit="page" from="533" to="616" />
			<date type="published" when="1997" />
		</imprint>
	</monogr>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>