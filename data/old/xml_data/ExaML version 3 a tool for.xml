
<?xml version="1.0" encoding="UTF-8"?>
<TEI xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 /home/joey/Project/grobid/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<encodingDesc>
			<appInfo>
				<application version="0.4.2-SNAPSHOT" ident="GROBID" when="2017-08-10T23:32+0000">
					<ref target="https://github.com/kermitt2/grobid">GROBID - A machine learning software for extracting information from scholarly documents</ref>
				</application>
			</appInfo>
		</encodingDesc>
		<fileDesc>
			<titleStmt>
				<title level="a" type="main">ExaML version 3: a tool for phylogenomic analyses on supercomputers</title>
			</titleStmt>
			<publicationStmt>
				<publisher/>
				<availability status="unknown"><licence/></availability>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author>
							<persName>
								<forename type="first">Alexey</forename>
								<forename type="middle">M</forename>
								<surname>Kozlov</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="laboratory">Scientific Computing Group</orgName>
								<orgName type="institution">Heidelberg Institute for Theoretical Studies</orgName>
								<address>
									<settlement>Heidelberg</settlement>
									<country key="DE">Germany</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Andre</forename>
								<forename type="middle">J</forename>
								<surname>Aberer</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="laboratory">Scientific Computing Group</orgName>
								<orgName type="institution">Heidelberg Institute for Theoretical Studies</orgName>
								<address>
									<settlement>Heidelberg</settlement>
									<country key="DE">Germany</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Alexandros</forename>
								<surname>Stamatakis</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="laboratory">Scientific Computing Group</orgName>
								<orgName type="institution">Heidelberg Institute for Theoretical Studies</orgName>
								<address>
									<settlement>Heidelberg</settlement>
									<country key="DE">Germany</country>
								</address>
							</affiliation>
							<affiliation key="aff1">
								<orgName type="department" key="dep1">Department of informatics</orgName>
								<orgName type="department" key="dep2">Institute of Theoretical Informatics</orgName>
								<orgName type="institution">Karlsruhe Institute of Technology</orgName>
								<address>
									<settlement>Karlsruhe</settlement>
									<country key="DE">Germany</country>
								</address>
							</affiliation>
						</author>
						<title level="a" type="main">ExaML version 3: a tool for phylogenomic analyses on supercomputers</title>
					</analytic>
					<monogr>
						<imprint>
							<date/>
						</imprint>
					</monogr>
					<idno type="DOI">10.1093/bioinformatics/btv184</idno>
					<note type="submission">Received on January 7, 2015; revised on March 9, 2015; accepted on March 24, 2015</note>
					<note>Phylogenetics *To whom correspondence should be addressed. Associate Editor: Jonathan Wren Availability and implementation: The code is available under GNU GPL at https://github.com/sta matak/ExaML. Contact: Alexandros.Stamatakis@h-its.org Supplementary information: Supplementary data are available at Bioinformatics online.</note>
				</biblStruct>
			</sourceDesc>
		</fileDesc>
		<profileDesc>
			<abstract>
				<p>Motivation: Phylogenies are increasingly used in all fields of medical and biological research. Because of the next generation sequencing revolution, datasets used for conducting phylogenetic analyses grow at an unprecedented pace. We present ExaML version 3, a dedicated production-level code for inferring phylogenies on whole-transcriptome and whole-genome alignments using supercomputers. Results: We introduce several improvements and extensions to ExaML: Extensions of substitution models and supported data types, the integration of a novel load balance algorithm as well as a parallel I/O optimization that significantly improve parallel efficiency, and a production-level implementation for Intel MIC-based hardware platforms.</p>
			</abstract>
		</profileDesc>
	</teiHeader>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1">Introduction</head><p>ExaML (Exascale Maximum Likelihood) is a relatively new code for large-scale phylogenetic analyses on supercomputers. It implements the RAxML (<ref type="bibr" target="#b9">Stamatakis, 2014</ref>) search algorithm and replaces RAxML-Light (<ref type="bibr" target="#b11">Stamatakis et al., 2012</ref>) which was inefficient for large, partitioned phylogenomic datasets that currently represent the typical use case. Hence, in ExaML (v. 1) we implemented a radically different parallelization approach (<ref type="bibr" target="#b10">Stamatakis and Aberer, 2013</ref>) that improved parallel efficiency by up to a factor of 3 and also increased scalability. For two large alignments that were recently published in Science<ref type="bibr">[</ref><ref type="bibr" target="#b7">Misof et al. (2014)]</ref>, we identified and resolved further performance bottlenecks. Note that, ExaML can also be used for analyzing datasets with 10-20 genes and up to 55 000 taxa, but scalability will be limited to at most 100 cores. For ExaML (v. 2), we developed and integrated algorithms for improved load balance (<ref type="bibr" target="#b12">Zhang and Stamatakis, 2012;</ref><ref type="bibr" target="#b2">Kobert et al., 2014</ref>) and also optimized the parallel I/O for reading multiple sequence alignments. We also started exploring if and how ExaML can be ported to the Intel MIC (Many Integrated Core) hardware architecture (<ref type="bibr" target="#b3">Kozlov et al., 2014</ref>) in a proof-of-concept setting. Here, we present ExaML (v. 3) which offers—apart from new models and data types—a production-level implementation for the Intel MIC architecture that required a substantial amount of reengineering. We also present a novel parallel alignment I/O method. Finally, we completely re-wrote the user manual. ExaML is a stable and well-documented code for large-scale phylogenetic inference on x86 Linux/MAC clusters (compiles with gcc,icc,clang). It addresses and provides generally applicable solutions for several performance bottlenecks in parallel phylogentic likelihood calculations on partitioned alignments.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2">New features</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.1">Models and data types</head><p>Apart from DNA and protein data, ExaML now also supports binary (two-state) characters. This data type can be used, for instance, to analyze genome-wide indel patterns. The number of available protein substitution models now also includes the LG4M and LG4X models (<ref type="bibr" target="#b4">Le et al., 2012</ref>) as well as the recently published stmtREV (<ref type="bibr" target="#b6">Liu et al., 2014</ref>) model. In addition, ExaML can automatically determine the best-scoring protein substitution model for each partition via a newly implemented standard test procedure that uses either (i) the likelihood score, (ii) the AIC (Akaike Information Criterion), (iii) the cAIC (corrected AIC) or (iv) the BIC (Bayesian Information Criterion). Finally, a new option for conducting a maximum likelihood estimate of the base frequencies has become available.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.2">Parallel I/O optimization</head><p>The parallel I/O to read in the input alignment is optimized in two ways. Initially, a plain-text PHYLIP file is analyzed and transformed into a binary file format via a dedicated parser component. The parser can be executed on a standard server and does therefore not consume valuable supercomputer time for issues such as checking the format, detecting duplicate taxon names, compressing site patterns, etc. The binary alignment file contains global data information (alignment length, data types, model options, partition boundaries) as well as the raw sequences stored in the order of the partitions. That is, the sequences for all taxa of partition one are stored first, then, the sequences for all taxa of partition two, etc. This, yet unpublished, binary format allows each ExaML process to concurrently read only those parts of the alignment on which it will be computing likelihoods. This optimization yielded an acceleration of more than one order of magnitude for the start-up phase of ExaML during which the alignment is read (see on-line Supplementary for more details).</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.3">New load balance algorithm</head><p>The typical use case for modern likelihood-based inferences are socalled partitioned analyses, where subsets of the alignment sites form partitions that evolve under a distinct set of evolutionary model parameters (e.g. a shape parameter, GTR rates, base frequencies, etc.). ExaML parallelizes likelihood calculations over alignment sites using MPI (Message Passing Interface). The time for likelihood calculations on a partition i consist of a constant part (irrespective of the partition length), mainly the calculation of the P i matrix via exponentiation of the Q i matrix given the branch length t, that is, P i ðtÞ ¼ e Qit (<ref type="bibr" target="#b0">Felsenstein, 2004</ref>). Once the P i matrix has been computed one can then calculate the per-site likelihoods for each site in partition i in parallel. We observed that, because of additional synchronization and communication overhead, it is not advantageous to first parallelize all P matrix calculation and subsequently (in a second parallel region) calculate all per-site likelihood calculations. Thus, because P i needs to be computed redundantly by every process, even if it has just one alignment site belonging to partition i, we need to minimize the number of partitions for which a process calculates the likelihood. At the same time, we need to evenly distribute the sites among processors for optimal load balance (i.e. we need to split up some partitions among processes). To this end, we formulated a bicriterion problem to define the optimal data distribution of partitions and sites to processors (<ref type="bibr" target="#b2">Kobert et al., 2014</ref>). We showed that: (i) the optimization problem is N P-hard, (ii) an approximation algorithm with a guaranteed bound exists, (iii) the algorithm misses the optimum by at most one partition (one additional P i calculation is required at one or more processes than in the optimal solution). We also showed that this new data distribution algorithm outperforms previous approaches (cyclic distribution of sites, monolithic distribution of partitions) in almost all cases with only minor deviations in cases where the performance was worse. In addition, we showed that ExaML runs up to three times faster [see<ref type="figure">Fig. 4b</ref>in<ref type="bibr" target="#b2">Kobert et al. (2014)</ref>] than with the previous data distribution schemes.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.4">Checkpointing</head><p>As RAxML-Light, ExaML also allows for checkpointing and subsequently re-starting tree searches from light-weight binary checkpoints. This is particularly useful when using typical supercomputer configurations with 24 or 48 hr run-time limits. Apart from the tree search, ExaML also offers an option to estimate model parameters and branch lengths on a given set of fixed trees. This option is also checkpointable.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.5">ExaML MIC version</head><p>An increasing number of supercomputing centers now operate systems with heterogeneous CPU/MIC compute nodes. To this end, we have transformed our initial proof-of-concept MIC code into production-level hybrid software that can leverage the capacity of all resources in such a system. A detailed description of this novel and non-trivial parallelization approach that requires exploiting parallelism and handling load balance at essentially two levels (MPI among MIC cards and 'normal' CPUs and OpenMP within cards) is provided in the on-line Supplementary. As we show in the supplement, the hybrid code allows to make better use of currently available hardware resources.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3">User support and future work</head><p>User support is provided via the RAxML Google group at: https:// groups.google.com/forum/?hl¼en#!forum/raxml. The ExaML source code contains a comprehensive manual. Future work includes the continued maintenance and support of ExaML and the implementation of additional models [e.g. models with ascertainment bias correction (<ref type="bibr" target="#b5">Lewis, 2001)]</ref>, data types and search algorithms (<ref type="bibr" target="#b8">Nguyen et al., 2015</ref>).</p></div>
			<note place="foot">V C The Author 2015. Published by Oxford University Press. 2577 This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (http://creativecommons.org/licenses/by-nc/4.0/), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com Bioinformatics, 31(15), 2015, 2577–2579 doi: 10.1093/bioinformatics/btv184 Advance Access Publication Date: 29 March 2015 Applications Note at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>

			<note place="foot">A.M.Kozlov et al. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>

			<note place="foot">at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>
		</body>
		<back>

			<div type="acknowledgement">
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Acknowledgements</head><p>The authors wish to thank lab member Diego Darriba for help with the implementation of the AIC, cAIC and BIC tests.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Funding</head><p>All three authors are funded by institutional funds from the Heidelberg Institute for Theoretical Studies for theoretical studies. Conflict of Interest: none declared.</p></div>
			</div>

			<div type="references">

				<listBibl>

<biblStruct   xml:id="b0">
	<monogr>
		<title level="m" type="main">Inferring Phylogenies</title>
		<author>
			<persName>
				<forename type="first">J</forename>
				<surname>Felsenstein</surname>
			</persName>
		</author>
		<imprint>
			<date type="published" when="2004" />
			<publisher>Sinauer Associates Sunderland</publisher>
			<pubPlace>Sunderland, MA</pubPlace>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b1">
	<analytic>
		<title level="a" type="main">Whole-genome analyses resolve early branches in the tree of life of modern birds</title>
		<author>
			<persName>
				<forename type="first">E</forename>
				<forename type="middle">D</forename>
				<surname>Jarvis</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Science</title>
		<imprint>
			<biblScope unit="volume">346</biblScope>
			<biblScope unit="page" from="1320" to="1331" />
			<date type="published" when="2014" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b2">
	<analytic>
		<title level="a" type="main">The divisible load balance problem and its application to phylogenetic inference</title>
		<author>
			<persName>
				<forename type="first">K</forename>
				<surname>Kobert</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Algorithms in Bioinformatics Lecture Notes in Computer Science</title>
		<editor>Brown,D. and Morgenstern,B.</editor>
		<imprint>
			<publisher>Springer</publisher>
			<biblScope unit="volume">8701</biblScope>
			<biblScope unit="page" from="204" to="216" />
			<date type="published" when="2014" />
			<publisher>Springer</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b3">
	<analytic>
		<title level="a" type="main">Efficient computation of the phylogenetic likelihood function on the Intel MIC architecture</title>
		<author>
			<persName>
				<forename type="first">A</forename>
				<forename type="middle">M</forename>
				<surname>Kozlov</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Parallel Distributed Processing Symposium Workshops (IPDPSW)</title>
		<meeting><address><addrLine>Washington, DC, Phoenix, Arizona</addrLine></address></meeting>
		<imprint>
			<date type="published" when="2014" />
			<biblScope unit="page" from="518" to="527" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b4">
	<analytic>
		<title level="a" type="main">Modeling protein evolution with several amino acid replacement matrices depending on site rates</title>
		<author>
			<persName>
				<forename type="first">S</forename>
				<forename type="middle">Q</forename>
				<surname>Le</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Mol. Biol. Evol</title>
		<imprint>
			<biblScope unit="volume">29</biblScope>
			<biblScope unit="page" from="2921" to="2936" />
			<date type="published" when="2012" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b5">
	<analytic>
		<title level="a" type="main">A likelihood approach to estimating phylogeny from discrete morphological character data</title>
		<author>
			<persName>
				<forename type="first">P</forename>
				<forename type="middle">O</forename>
				<surname>Lewis</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Syst. Biol</title>
		<imprint>
			<biblScope unit="volume">50</biblScope>
			<biblScope unit="page" from="913" to="925" />
			<date type="published" when="2001" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b6">
	<analytic>
		<title level="a" type="main">Mitochondrial phylogenomics of early land plants: mitigating the effects of saturation, compositional heterogeneity, and codonusage bias</title>
		<author>
			<persName>
				<forename type="first">Y</forename>
				<surname>Liu</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Syst. Biol</title>
		<imprint>
			<biblScope unit="volume">63</biblScope>
			<biblScope unit="page" from="862" to="878" />
			<date type="published" when="2014" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b7">
	<analytic>
		<title level="a" type="main">Phylogenomics resolves the timing and pattern of insect evolution</title>
		<author>
			<persName>
				<forename type="first">B</forename>
				<surname>Misof</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Science</title>
		<imprint>
			<biblScope unit="volume">346</biblScope>
			<biblScope unit="page" from="763" to="767" />
			<date type="published" when="2014" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b8">
	<analytic>
		<title level="a" type="main">IQ-tree: a fast and effective stochastic algorithm for estimating maximum-likelihood phylogenies</title>
		<author>
			<persName>
				<forename type="first">L.-T</forename>
				<surname>Nguyen</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Mol. Biol. Evol</title>
		<imprint>
			<biblScope unit="volume">32</biblScope>
			<biblScope unit="page" from="268" to="274" />
			<date type="published" when="2015" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b9">
	<analytic>
		<title level="a" type="main">Raxml version 8: a tool for phylogenetic analysis and post-analysis of large phylogenies</title>
		<author>
			<persName>
				<forename type="first">A</forename>
				<surname>Stamatakis</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">30</biblScope>
			<biblScope unit="page" from="1312" to="1313" />
			<date type="published" when="2014" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b10">
	<analytic>
		<title level="a" type="main">Novel parallelization schemes for largescale likelihood-based phylogenetic inference</title>
		<author>
			<persName>
				<forename type="first">A</forename>
				<surname>Stamatakis</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">A</forename>
				<surname>Aberer</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Parallel Distributed Processing (IPDPS), 2013 IEEE 27th International Symposium on</title>
		<meeting><address><addrLine>Washington, DC, USA, Boston, MA</addrLine></address></meeting>
		<imprint>
			<publisher>IEEE Computer Society</publisher>
			<date type="published" when="2013" />
			<biblScope unit="page" from="1195" to="1204" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b11">
	<analytic>
		<title level="a" type="main">Raxml-light: a tool for computing terabyte phylogenies</title>
		<author>
			<persName>
				<forename type="first">A</forename>
				<surname>Stamatakis</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">28</biblScope>
			<biblScope unit="page" from="2064" to="2066" />
			<date type="published" when="2012" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b12">
	<analytic>
		<title level="a" type="main">The multi-processor scheduling problem in phylogenetics</title>
		<author>
			<persName>
				<forename type="first">J</forename>
				<surname>Zhang</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">A</forename>
				<surname>Stamatakis</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Parallel and Distributed Processing Symposium Workshops PhD Forum (IPDPSW), 2012 IEEE 26th International</title>
		<meeting><address><addrLine>Washington, DC, USA, Shanghai, China</addrLine></address></meeting>
		<imprint>
			<date type="published" when="2012" />
			<biblScope unit="page" from="691" to="698" />
		</imprint>
	</monogr>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>