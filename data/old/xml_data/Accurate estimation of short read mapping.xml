
<?xml version="1.0" encoding="UTF-8"?>
<TEI xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 /home/joey/Project/grobid/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<encodingDesc>
			<appInfo>
				<application version="0.4.2-SNAPSHOT" ident="GROBID" when="2017-08-10T23:33+0000">
					<ref target="https://github.com/kermitt2/grobid">GROBID - A machine learning software for extracting information from scholarly documents</ref>
				</application>
			</appInfo>
		</encodingDesc>
		<fileDesc>
			<titleStmt>
				<title level="a" type="main">Accurate estimation of short read mapping quality for next-generation genome sequencing</title>
			</titleStmt>
			<publicationStmt>
				<publisher/>
				<availability status="unknown"><licence/></availability>
				<date type="published" when="2012">2012</date>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author>
							<persName>
								<forename type="first">Matthew</forename>
								<surname>Ruffalo</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department">Department of Electrical Engineering &amp; Computer Science</orgName>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Mehmet</forename>
								<surname>Koyutürk</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department">Department of Electrical Engineering &amp; Computer Science</orgName>
							</affiliation>
							<affiliation key="aff2">
								<orgName type="department">Center for Proteomics and Bioinformatics</orgName>
								<orgName type="institution">Case Western Reserve University</orgName>
								<address>
									<postCode>44106</postCode>
									<settlement>Cleveland</settlement>
									<region>OH</region>
									<country key="US">USA</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Soumya</forename>
								<surname>Ray</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department">Department of Electrical Engineering &amp; Computer Science</orgName>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Thomas</forename>
								<surname>Laframboise</surname>
							</persName>
							<affiliation key="aff1">
								<orgName type="department">Department of Genetics</orgName>
							</affiliation>
							<affiliation key="aff2">
								<orgName type="department">Center for Proteomics and Bioinformatics</orgName>
								<orgName type="institution">Case Western Reserve University</orgName>
								<address>
									<postCode>44106</postCode>
									<settlement>Cleveland</settlement>
									<region>OH</region>
									<country key="US">USA</country>
								</address>
							</affiliation>
						</author>
						<title level="a" type="main">Accurate estimation of short read mapping quality for next-generation genome sequencing</title>
					</analytic>
					<monogr>
						<imprint>
							<biblScope unit="volume">28</biblScope>
							<biblScope unit="page" from="349" to="355"/>
							<date type="published" when="2012">2012</date>
						</imprint>
					</monogr>
					<idno type="DOI">10.1093/bioinformatics/bts408</idno>
					<note>Copyedited by: TRJ MANUSCRIPT CATEGORY: ECCB [17:35 9/8/2012 Bioinformatics-bts408.tex] Page: i349 i349–i355 BIOINFORMATICS Contact: matthew.ruffalo@case.edu.</note>
				</biblStruct>
			</sourceDesc>
		</fileDesc>
		<profileDesc>
			<abstract>
				<p>Motivation: Several software tools specialize in the alignment of short next-generation sequencing reads to a reference sequence. Some of these tools report a mapping quality score for each alignment—in principle, this quality score tells researchers the likelihood that the alignment is correct. However, the reported mapping quality often correlates weakly with actual accuracy and the qualities of many mappings are underestimated, encouraging the researchers to discard correct mappings. Further, these low-quality mappings tend to correlate with variations in the genome (both single nucleotide and structural), and such mappings are important in accurately identifying genomic variants. Approach: We develop a machine learning tool, LoQuM (LOgistic regression tool for calibrating the Quality of short read mappings, to assign reliable mapping quality scores to mappings of Illumina reads returned by any alignment tool. LoQuM uses statistics on the read (base quality scores reported by the sequencer) and the alignment (number of matches, mismatches and deletions, mapping quality score returned by the alignment tool, if available, and number of mappings) as features for classification and uses simulated reads to learn a logistic regression model that relates these features to actual mapping quality. Results: We test the predictions of LoQuM on an independent dataset generated by the ART short read simulation software and observe that LoQuM can &apos;resurrect&apos; many mappings that are assigned zero quality scores by the alignment tools and are therefore likely to be discarded by researchers. We also observe that the recalibration of mapping quality scores greatly enhances the precision of called single nucleotide polymorphisms. Availability: LoQuM is available as open source at</p>
			</abstract>
		</profileDesc>
	</teiHeader>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1">INTRODUCTION</head><p>Next-generation genome sequencing (NGS) has quickly become very popular in life sciences because of its utility in efficiently generating high-quality sequence data (<ref type="bibr" target="#b13">Meyerson et al., 2010</ref>). Applications of NGS include analysis of gene expression and alternative splicing (RNA-seq) (<ref type="bibr" target="#b18">Wang et al., 2009</ref>), DNA– protein interactions (chromatin immunoprecipitation sequencing) (<ref type="bibr" target="#b16">Schmidt et al., 2009</ref>), d e novo genome sequencing (<ref type="bibr" target="#b10">Li et al., 2009b</ref>), metagenomics and identification of genetic variants within and across populations (<ref type="bibr" target="#b0">Alkan et al., 2009</ref>). Many computational methods are already available for analyzing genetic * To whom correspondence should be addressed. variants using NGS data. These variants include single-nucleotide polymorphisms (SNPs) and structural variants such as copy numbers, insertions, deletions, tandem duplications, inversions and translocations. Characterization of such variants is useful in many applications, including genome-wide association studies (<ref type="bibr" target="#b12">Mardis, 2008</ref>), identification of driver mutations in cancer (<ref type="bibr" target="#b13">Meyerson et al., 2010</ref>) and comparative genomics (Hudson, 2008).</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1.1">Short read alignment is an important problem</head><p>The first step in the detection and analysis of genetic variants is usually the alignment of short NGS reads from an individual's (donor) genome to a reference genome. This task poses significant computational challenges due to the large number of reads (sometimes tens of millions) and the size of many reference genomes (generally on the order of billions). Furthermore, because of sequencing errors, repeats in the reference genome and differences between the donor and reference genomes, accurate mapping of the reads to the genome is not straightforward. In recent years, many software tools have been developed to address these challenges and efficiently and accurately align short reads to the reference genome (<ref type="bibr" target="#b15">Ruffalo et al., 2011</ref>). These tools include BWA (<ref type="bibr" target="#b8">Li and Durbin, 2009</ref>), SOAP (<ref type="bibr" target="#b11">Li et al., 2009c</ref>), Novoalign (<ref type="bibr">Novocraft, 2010</ref>) and mr(s)FAST (<ref type="bibr" target="#b0">Alkan et al., 2009;</ref><ref type="bibr" target="#b4">Hach et al., 2010</ref>).</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1.2">Current alignment tools do not return reliable mapping quality scores</head><p>As the mapping of a read to a location in the reference genome may not be accurate, many alignment tools report a mapping quality score as an indicator of the likelihood that the mapping is accurate. This score is generally estimated by considering various factors, such as the number of base mismatches and the sizes of inserted or deleted regions in the alignment. In principle, the mapping quality score Q m reflects the log-scaled probability that the mapping is inaccurate and ranges from 0 (Pr{mapping is inaccurate}=1, i.e. the mapping is most likely inaccurate) to 40 (40 =−10log 10 Pr{mapping is inaccurate}→ Pr{mapping is inaccurate} &lt; 10 −4 , i.e. the mapping is most likely accurate). However, for almost all the state-of-the-art alignment tools, the mapping quality scores do not correlate well with the actual likelihood that a mapping is accurate and is therefore not very useful (<ref type="bibr" target="#b15">Ruffalo et al., 2011</ref>). This is illustrated in<ref type="figure">Figure 1</ref>. In the figure, for several alignment tools, the relationship between the mapping quality reported by the alignment tool and the actual mapping accuracy (the fraction of accurate mappings among those that are assigned the respective quality score) is shown. As seen in the figure, alignment tools generally report many accurate mappings with quality 0, and many inaccurate mappings with high-quality scores. We also see that there is very little dynamic range in themapping qualities; even when tools provide many distinct quality scores, there is little difference in actual mapping accuracy between, e.g. mappings with quality score 15 and mappings with quality score 30. Underestimated mapping quality scores might cause the user to discard many accurate mappings because of the conservative estimate provided by the alignment tool. Overestimated mapping quality scores, conversely, may contribute to false-positive results in variant calling and other types of downstream analysis. These observations call for more accurate assessment of mapping quality for the mappings provided by these tools. Furthermore, some methods, e.g. mr-and mrsFAST, do not report any mapping quality scores, they rather report all possible mappings for a read. For such tools, assessment of mapping quality would be useful as well, as a means for choosing from the multiple possible mappings.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1.3">Contributions of this study</head><p>In this article, we use a machine learning approach to assess the quality of the short read mappings more accurately than available alignment tools. For this purpose, we first identify the features that are potentially useful in assessing the likelihood that a mapping is accurate. These features consist of read statistics provided by an Illumina sequencer (e.g. base quality) and alignment statistics provided by the aligner (e.g. number of matches, mismatches, deletions, insertions, number of possible mappings and mapping quality score). Subsequently, we simulate NGS runs to generate reads that accurately reflect the characteristics of available sequencers. We use these simulated reads and the mappings provided by the aligner for these reads as training data to fit a logistic regression model that represents the relationship between read and alignment statistics and mapping accuracy. We implement this computational pipeline into a software package, LoQuM (LOgistic regression tool for calibrating the QUality of short read Mappings), which is available as open source at http:// compbio.case.edu/loqum/. LoQuM can work with a wide range of alignment tools to run the aligner for the user, compile the mappings returned by the aligner, calibrate the quality of these mappings and return the list of mappings with more reliable mapping quality scores. We test LoQuM by comprehensive cross-validation studies on the human genome. The cross-validation studies are conducted by using different simulators to generate the training and testing data. Namely, we first simulate training reads using the Seal (<ref type="bibr" target="#b15">Ruffalo et al., 2011</ref>) sequencing simulation software, and we use validation reads generated by the ART (<ref type="bibr" target="#b6">Huang et al., 2012</ref>) software. We also investigate the utility of recalibrating mapping quality scores in improving genomic variant detection in the context of detecting SNPs. For this purpose, we implant SNPs into the human genome and use the SAMtools (<ref type="bibr" target="#b9">Li et al., 2009a</ref>) software to compare the effect of raw and recalibrated mapping quality scores to the performance of SAMtools in calling these implanted SNPs. Previous work such as SRMA (<ref type="bibr" target="#b5">Homer and Nelson, 2010</ref>) focused on local re-alignment of short reads to improve the accuracy of SNP calls; LoQuM's broader focus also makes it suitable for improving the accuracy of other types of variant calls. The results of our experimental studies can be summarized as follows:</p><p>@BULLET For most aligners, the mapping quality scores estimated by LoQuM strongly correlate with actual mapping accuracy.</p><p>@BULLET The quality scores computed by LoQuM provide a reliable criterion for selecting the high-quality mappings among those that are assigned zero quality scores or not scored at all by the aligner.</p><p>@BULLET The features that are most useful in assessing mapping quality are the raw mapping qualities provided by the alignment tools and (except for Novoalign) the rate of degradation of base quality for a read. For tools that report multiple mappings for reads (e.g. mrFAST), the number of mappings for a read is also highly informative.</p><p>@BULLET Mapping quality scores computed by LoQuM greatly improve the precision of SNP calling at the cost of moderately lower recall.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1.4">Outline</head><p>In the next section, we describe our classification framework for calibrating the quality of short read mappings. Subsequently, in Section 3, we present the results of comprehensive cross-validation studies performed on three different aligners (BWA, SOAP2 and Novoalign) using the human genome and the impact of these results on SNP calling. In Section 4, we interpret our findings, discuss how LoQuM can be useful in a range of applications and outline avenues for future research.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Accurate estimation of short read mapping quality</head><p>Regressionstatistics provided by the aligner. Subsequently, we generate a large set of reads for training, by simulating reads from the reference genome. We then feed these reads to the aligner to generate a set of training mappings. We derive classification features for the training read-mapping pairs based on the model used for generating reads and the alignment statistics. As we know exactly where each simulated read is supposed to be mapped on the reference genome, we label each read-mapping pair in the training set as 'accurate' or 'not accurate'. Using this training data set, we fit a logistic regression model that represents the relationship between the accuracy of a mapping and the features derived from the read and alignment statistics. Finally, we use this logistic regression model to predict the accuracy of each mapping in the test dataset. As logistic regression makes a quantitative prediction for mapping accuracy between 0 and 1, we use this figure directly as a measure of mapping quality. In this section, we first discuss the features that are used in assessing the quality of short read mappings. Subsequently, we describe the proposed classification framework for recalibrating mapping quality scores using these features.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.1">Selection of Features</head><p>We classify the features we use into three categories: (i) alignmentindependent features, (ii) alignment statistics and (iii) aligner-specific features. We discuss the features in each category later.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.1.1">Alignment-independent features</head><p>These features consist of read statistics reported by the sequencer. In particular, most types of sequencing hardware provide a quality score Q b for each base call in the read. In other words, the hardware reports its confidence in assigning a specific nucleotide to each base (e.g. the base is a G with 99.9% confidence or a C with 80% confidence). The raw quality value, also called Phred score, is the log-scaled probability that the base call is incorrect: Q b =−10log 10 Pr{base is incorrect}</p><formula>(1)</formula><p>The base quality scores reported by sequencers range from 0 (least reliable) to 40 (most reliable).<ref type="figure" target="#fig_2">Figure 3</ref>shows base quality statistics for a real RNA-seq data set. In the figure, the distribution of base quality across a random sample of 33 million reads is shown as a function of the position of the base on the read. As seen in the figure, mean base quality decreases in an almost linear fashion as more bases are read. If we use base quality scores directly as features for classification, we would have k base quality features for a read of length k, causing problems<ref type="bibr" target="#b3">Andrews, 2010</ref>) for the MDAMB468 cell line (<ref type="bibr" target="#b17">Sun et al., 2011</ref>) across a random sample of the 33 million reads. The x-axis is the base position in each read, and the y-axis is the base quality score Q b. The blue line shows the mean base quality with high dimensionality. An alternate approach is to use the mean base quality for a read; however, the mean does not capture the base positiondependent nature of base quality scores. For these reasons, we fit a linear regression model to each read's quality scores and use the regression parameters as features for classification:</p><p>@BULLET Intercept: The quality of the first base in the read. @BULLET Slope: The rate of decline of base quality as more bases are sequenced on the read. @BULLET R value (correlation coefficient): How well a line fits the read's base quality scores. A low R value may signify, e.g. a read whose base quality values show a very sharp drop and then 'bottom out' at 0 for the remainder of the read.</p><p>Another potentially useful alignment-independent feature is the number of bases that could not be called (N count) in each read. When the sequencing hardware cannot identify the base at a certain position, it reports an N (instead of A, C, G and T) for that base, along with a zero base quality score. The N count should correlate with base quality statistics, but this may not be completely captured in the linear regression parameters described earlier. An N in the middle of a read should cause a sharp downward spike in</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>i351</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>M.Ruffalo et al.</head><p>base quality, with quality scores more-or-less resuming their previous value immediately afterward.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.1.2">Alignment statistics</head><p>Alignment tools report a few standard values, including the number of matches, mismatches, insertions and deletions in a mapping. These statistics together provide a direct measure of how well a read is aligned to a position in the reference genome. We use the raw counts of each of these values as classification features.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.1.3">Aligner-specific features</head><p>Alignment tools typically report their output in the standard SAM (<ref type="bibr" target="#b9">Li et al., 2009a</ref>) file format, which defines a mapping quality field that aligners can use to signify whether an alignment is likely to be correct. The SAM format defines this mapping quality Q m to be analogous to the base quality Q b :</p><formula>Q m =−10log 10 Pr{mapping is inaccurate} (2)</formula><p>However, as discussed in the previous section, these mapping quality scores do not accurately characterize the reliability of a mapping. Among popular modern alignment tools, BWA and Novoalign provide the most meaningful quality scores (<ref type="bibr" target="#b15">Ruffalo et al., 2011</ref>), though we see that these tools still assign quality 0 to many accurate mappings (<ref type="figure">Fig. 1</ref>). As these quality scores are informative to a certain extent, we expect them to be useful as features for classification. However, we seek to improve on the false negatives—the accurate mappings that have low quality—and the false positives—the inaccurate mappings that have high quality. Furthermore, some alignment tools (e.g. mrFAST and mrsFAST) may return multiple possible mappings for a read. The number of possible mappings for a read may be an indicator of the reliability of each of these mappings, as at most one of the mappings can correspond to the read's position in the genome. For this reason, for these tools, we also use the number of mappings returned for each read as a feature for classification.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.2">Classification</head><p>We choose logistic regression as a classifier to learn the relationship between accuracy of mapping and the features derived in the previous section, for multiple reasons. First, as we are interested in accurately calculating the likelihood that a mapping is correct, a probabilistic classifier is a natural choice. Second, logistic regression makes no assumptions about the independence between features, which is appropriate in this setting. Many of the features described in Section 2.1 are not likely to be statistically independent of each other; at the very least, the mapping quality returned by the aligner should have some correlation with the other features. Finally, logistic regression is a simple classifier that provides insights on which features are most useful in predicting the dependent variable (here, accuracy of mapping), facilitating interpretation of how each feature affects mapping quality. We seek to accurately model the probability p that a mapping is correct. Logistic regression represents this in terms of the log odds ratio ln p 1−p and models this quantity as a linear combination of numeric features x i and coefficients β i (with a constant intercept term β 0 ):</p><formula>ln p 1−p = β 0 +β 1 x 1 +...+β k x k (3)</formula><p>Our x i values are the features described earlier, e.g. mapping quality score, base quality slope and number of mappings.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.3">Simulation of Reads</head><p>Our evaluation of LoQuM uses simulated 50 bp reads from the human genome, provided by the ART (<ref type="bibr" target="#b6">Huang et al., 2012</ref>) sequencing simulation package. ART uses empirical base quality profiles to accurately mimic the characteristics of Illumina hardware, and we use these base quality values to calibrate the machine learning framework. Each read is annotated with its original position in the reference genome, which allows for easy evaluation of whether an alignment tool mapped it to the correct location.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.4">Cross-validation framework</head><p>We perform a standard 5-fold cross-validation procedure: we build the classifier on 80% of the training set and evaluate the accuracy on the remaining 20%. For demonstration purposes, figures in this document represent one of the five training/validation folds.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.5">SNP calling evaluation</head><p>Our evaluation of SNP calling used 100 artificial SNPs inserted into random locations in human chromosome 1. We created a new reference sequence containing these SNPs, then simulated reads from the altered sequence with ART. We then aligned these reads to chromosome 1 with BWA and adjusted these reads' mapping quality scores with LoQuM. We identified significant SNPs with the SAMtools mpileup variant calling program, both with BWA's original mapping quality scores and with LoQuM's recalibrated scores. Using the locations of the artificial SNPs, we evaluated the number of true-positive, false-positive and false-negative SNP calls with each set of mapping quality scores.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3">RESULTS</head><p>We evaluate our classification framework by considering the relationship between precision and recall as one varies a threshold on prediction output. In calculating these measures, we consider a true positive (TP) as a read that is correctly mapped and whose score exceeds this threshold. A false positive (FP) is a read that is incorrectly mapped but whose score exceeds this threshold, and a false negative (FN) is a read that is correctly mapped but is discarded because its score is less than the threshold. We then use the standard definition of precision as TP TP+FP. Similarly, recall is defined as TP TP+FN. We evaluate the performance of LoQuM on multiple alignment tools and compare the classifier output with the raw mapping quality (if provided). We then examine the relationship between our prediction scores and actual mapping accuracy and the effect of these recalibrated mapping quality scores on SNP calling with the SAMtools (<ref type="bibr" target="#b9">Li et al., 2009a</ref>) mpileup variant caller.<ref type="figure">Figure 4</ref>shows precision versus recall for the BWA alignment tool, with<ref type="figure">Figure 4a</ref>showing the raw mapping qualities and<ref type="figure">Figure 4b</ref>showing the output of LoQuM. We see that the raw mapping qualities provide relatively little information about reads that are incorrectly mapped—even at the highest mapping quality of 25, BWA provides high recall and precision of ≈ 0.5. LoQuM, however, identifies these high-quality incorrect mappings and provides much higher precision at comparable recall values.<ref type="figure">Figure 5</ref>shows SOAP2's precision and recall as a function of a threshold on mapping quality or logistic regression output. From the raw mapping quality precision/recall in<ref type="figure">Figure 5a</ref>, we see that SOAP's quality scores have very low dynamic range and discriminative power. In fact, SOAP only reports mapping qualities of 0 or 30, and all quality-30 mappings are at the top of the red line (precision ≈ 0.5) with all quality-0 mappings represented as an invisible blue dot under the red line at precision 0.45. Nonetheless, this logistic regression framework can accurately classify reads as correctly or incorrectly mapped. This is shown in<ref type="figure">Figure 5b—</ref>LoQuM provides higher area under the precision/recall curve, and i352</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.1">BWA</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.2">SOAP</head><formula>0.0 0.2 0.4 0.6 0.8 1.0 0 0.2 0.4 0.6 0.8 1</formula></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Fig. 4. Precision versus recall for</head><p>the alignment tool BWA, using the raw mapping qualities in (a), and the output of LoQuM in (b). The color of the curve denotes a threshold on mapping quality or prediction output; decreasing this threshold typically increases recall but decreases precision a score threshold of 0.5 sits at the 'elbow' of the curve (the point at which mappings become less trustworthy).</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.3">Novoalign</head><p>Again,<ref type="figure">Figure 6</ref>shows precision versus recall for Novoalign's mapping qualities and LoQuM's output. From<ref type="figure">Figure 6a</ref>, we see that Novoalign provides the most dynamic range in its mapping quality, though still with a maximum precision of ≈ 0.5. This logistic regression model produces a great accuracy improvement on the output of Novoalign; we see a smoothly decreasing curve in<ref type="figure">Figure 6b</ref>. This suggests that LoQuM captures a significant amount of information about Novoalign's mappings beyond what is represented in its quality scores.<ref type="figure" target="#fig_7">Figure 7</ref>shows similar data as 1 but uses the output of LoQuM instead of the raw mapping quality. Mappings are divided into 10 groups based on their prediction score, and the average accuracy for each group is plotted against the theoretical accuracy at that score. We see that LoQuM's output generally matches the theoretical<ref type="figure">Fig. 5</ref>. Precision versus recall for the alignment tool SOAP2, using the raw mapping qualities in (a), and the output of LoQuM in (b). The color of the curve denotes a threshold on mapping quality or prediction output; decreasing this threshold typically increases recall but decreases precision accuracy much better than the raw mapping quality shown in<ref type="figure">Figure 1</ref>.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.4">Overall</head><formula>0.2 0.4 0.6 0.8 1.0 0 0.2 0.4 0.6 0.8 1</formula></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.5">SNP calling</head><p>Our SNP calling results are listed in<ref type="figure" target="#tab_1">Table 1</ref>. We see that the SAMtools mpileup variant calls are dominated by false positives; raw mapping qualities provide a recall score of 0.83 but precision of only 0.163. The recalibrated mapping quality scores provided by LoQuM result in lower recall (0.63) but a substantially higher precision of 0.589. These results are consistent with the precision/recall curves shown above—alignment tools report many incorrect mappings with high mapping quality, and LoQuM's more conservative quality scores indeed reduce false-positive SNP calls.<ref type="figure">Fig. 6</ref>. Precision versus recall for the alignment tool Novoalign, using the raw mapping qualities in (a) and the output of LoQuM in (b). The color of the curve denotes a threshold on mapping quality or prediction output; decreasing this threshold typically increases recall but decreases precisionThe F score is defined as the harmonic mean of precision and recall: F = 1/(1/prec+ 1/rec). values provided by most tools, suggesting that it may be valuable for researchers who desire more granularity in their data analysis. Most importantly, LoQuM correctly identifies many correctly mapped reads with lower mapping quality. This is evident in the precision/recall plots; a classifier output threshold of 0.5 sits exactly at the 'elbow' of each curve (the point at which precision starts tosignificantly decrease). LoQuM's scores therefore provide a reliable way to discriminate between correct and incorrect mappings across different alignment tools—one may consistently use 0.5 as a quality score threshold. This suggests that researchers can use a tool of this type to use more of their data and get better yields out of sequencing experiments. The differences in feature significance between alignment tool classifiers also highlight the characteristics of these tools and the information that is likely to be represented in their existing quality scores.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4">DISCUSSION</head><formula>0.2 0.4 0.6 0.8 1.0 0 0.2 0.4 0.6 0.8 1</formula></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5">CONCLUSION</head><p>In this article, we show that a machine learning framework that uses a combination of read and alignment statistics as classification features and simulated reads as training data to predict mapping accuracy can improve on mapping quality scores reported by available tools. These improved mapping quality scores might be particularly useful in improving the identification of genomic variants, since they can 'save' potentially informative mappings that would be conservatively assigned low-quality scores by the assignment tools. Additionally, LoQuM's recalibrated mapping quality scores can reduce false-positive variant calls due to overestimated mapping accuracy. Assessment of the effect of mapping quality scores on identification of more genomic variants remains an important and interesting problem for future studies.</p></div><figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_1"><head>Fig.2.</head><figDesc>Fig. 2. The machine learning framework for recalibrating mapping quality scores. Rectangles represent data, blue rounded rectangles represent available hardware and software and green ellipses represent computational methods implemented within LoQuM</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_2"><head>Fig.3.</head><figDesc>Fig. 3. Boxplots of per-base quality statistics provided by the FastQC tool (Andrews, 2010) for the MDAMB468 cell line (Sun et al., 2011) across a random sample of the 33 million reads. The x-axis is the base position in each read, and the y-axis is the base quality score Q b. The blue line shows the mean base quality</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_7"><head>Fig.7.</head><figDesc>Fig. 7. Comparison of reported accuracy versus theoretical accuracy for ART's simulated reads. The x-axis is the output of the logistic regression classifier p after inversion and negative log-scaling: Q =−10log 10 (1−p). This corresponds to the mapping quality score Q m in Equation (2)</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_8"><head></head><figDesc>Funding: This work was supported by National Science Foundation Award IIS-0916102 and National Cancer Institute Grant No. R01CA131341. Conflict of Interest: none declared.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_0" validated="false"><figDesc>m against each tool's actual accuracy. The mapping quality Q m is defined as the log-scaled probability P that the mapping is incorrect: Q m =−10log 10 P, giving a theoretical accuracy A for each quality score: A = 1−P = 1−10 −Qm /10</figDesc><table>Copyedited by: TRJ 

MANUSCRIPT CATEGORY: ECCB 

[17:35 9/8/2012 Bioinformatics-bts408.tex] 
Page: i350 i349–i355 

M.Ruffalo et al. 

Human Genome: Accuracy by Map. Qual. 

Mapping Quality 

Accuracy 

0 3 6 9 13 17 21 25 29 33 37 

0.0 

0.2 

0.4 

0.6 

0.8 

1.0 

● 
● 
●● 

● 

● 
●●● 
● 
●● 
●●●● ● ● 
● ● 
● 
● 
● 

● 

Tool 

&lt;Theoretical&gt; 
BWA 
Novoalign 
SOAP 

Fig. 1. Direct comparison of the theoretical accuracy at each quality 
score Q </table></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_3" validated="false"><figDesc>Table 1.</figDesc><table>SNP calling results for 100 artificial SNPs inserted into human 
chromosome 1 

Raw Map. Qual. 
LoQuM scores 

True positives 
83 
63 
False positives 
427 
44 
False negatives 
17 
37 
Precision 
0.163 
0.589 
Recall 
0.83 
0.63 
F score 
0.136 
0.304 

</table></figure>

			<note place="foot">© The Author(s) 2012. Published by Oxford University Press. This is an Open Access article distributed under the terms of the Creative Commons Attribution License (http://creativecommons.org/licenses/by/3.0), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>

			<note place="foot" n="2"> METHODS The proposed machine learning framework is shown in Figure 2. As seen in the figure, the reads are generated by the sequencer from the donor genome and are aligned to the reference genome using an available alignment tool. Both the sequencer and the aligner provide certain statistics on the read and the alignment, which are used by LoQuM to recalibrate the mapping quality scores. In the proposed framework, we first derive features for each read-mapping pair from the read statistics provided by the sequencer and the alignment i350 at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>

			<note place="foot">at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>

			<note place="foot">i355 at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>
		</body>
		<back>
			<div type="references">

				<listBibl>

<biblStruct   xml:id="b0">
	<analytic>
		<title level="a" type="main">Personalized copy number and segmental duplication maps using next-generation sequencing</title>
		<author>
			<persName>
				<forename type="first">C</forename>
				<surname>Alkan</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nat. Genet</title>
		<imprint>
			<biblScope unit="volume">41</biblScope>
			<biblScope unit="page" from="1061" to="1067" />
			<date type="published" when="2009" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b1">
	<analytic>
		<title/>
	</analytic>
	<monogr>
		<title level="m">oxfordjournals.org/ Downloaded from Copyedited by: TRJ MANUSCRIPT CATEGORY: ECCB</title>
		<imprint>
			<date type="published" when="2012" />
			<biblScope unit="page" from="355" to="349" />
		</imprint>
	</monogr>
	<note>bts408. .tex] Page</note>
</biblStruct>

<biblStruct   xml:id="b2">
	<monogr>
		<title level="m" type="main">Accurate estimation of short read mapping quality</title>
		<imprint/>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b3">
	<monogr>
		<title level="m" type="main">FastQC: a quality control tool for high throughput sequence data</title>
		<author>
			<persName>
				<forename type="first">S</forename>
				<surname>Andrews</surname>
			</persName>
		</author>
		<imprint>
			<date type="published" when="2010-09-12" />
		</imprint>
	</monogr>
	<note>last. accessed date</note>
</biblStruct>

<biblStruct   xml:id="b4">
	<analytic>
		<title level="a" type="main">mrsFAST: a cache-oblivious algorithm for short-read mapping</title>
		<author>
			<persName>
				<forename type="first">F</forename>
				<surname>Hach</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nat. Methods</title>
		<imprint>
			<biblScope unit="volume">7</biblScope>
			<biblScope unit="page" from="576" to="577" />
			<date type="published" when="2010" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b5">
	<analytic>
		<title level="a" type="main">Improved variant discovery through local realignment of short-read next-generation sequencing data using SRMA</title>
		<author>
			<persName>
				<forename type="first">N</forename>
				<surname>Homer</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">S</forename>
				<forename type="middle">F</forename>
				<surname>Nelson</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Genome Biol</title>
		<imprint>
			<biblScope unit="volume">11</biblScope>
			<biblScope unit="page">99</biblScope>
			<date type="published" when="2010" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b6">
	<analytic>
		<title level="a" type="main">ART: a next-generation sequencing read simulator</title>
		<author>
			<persName>
				<forename type="first">W</forename>
				<surname>Huang</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">28</biblScope>
			<biblScope unit="page" from="593" to="594" />
			<date type="published" when="2012" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b7">
	<analytic>
		<title level="a" type="main">Sequencing breakthroughs for genomic ecology and evolutionary biology</title>
		<author>
			<persName>
				<forename type="first">M</forename>
				<forename type="middle">E</forename>
				<surname>Hudson</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Mol. Ecol. Resources</title>
		<imprint>
			<biblScope unit="volume">8</biblScope>
			<biblScope unit="page" from="3" to="17" />
			<date type="published" when="2008" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b8">
	<analytic>
		<title level="a" type="main">Fast and accurate short read alignment with BurrowsWheeler transform</title>
		<author>
			<persName>
				<forename type="first">H</forename>
				<surname>Li</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">R</forename>
				<surname>Durbin</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">25</biblScope>
			<biblScope unit="page" from="1754" to="1760" />
			<date type="published" when="2009" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b9">
	<analytic>
		<title level="a" type="main">The sequence alignment/map format and SAMtools</title>
		<author>
			<persName>
				<forename type="first">H</forename>
				<surname>Li</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">25</biblScope>
			<biblScope unit="page" from="2078" to="2079" />
			<date type="published" when="2009" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b10">
	<analytic>
		<title level="a" type="main">De novo assembly of human genomes with massively parallel short read sequencing</title>
		<author>
			<persName>
				<forename type="first">R</forename>
				<surname>Li</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Genome Res</title>
		<imprint>
			<biblScope unit="volume">20</biblScope>
			<biblScope unit="page" from="265" to="272" />
			<date type="published" when="2009" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b11">
	<analytic>
		<title level="a" type="main">SOAP2: an improved ultrafast tool for short read alignment</title>
		<author>
			<persName>
				<forename type="first">R</forename>
				<surname>Li</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">25</biblScope>
			<biblScope unit="page" from="1966" to="1967" />
			<date type="published" when="2009" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b12">
	<analytic>
		<title level="a" type="main">The impact of next-generation sequencing technology on genetics</title>
		<author>
			<persName>
				<forename type="first">E</forename>
				<forename type="middle">R</forename>
				<surname>Mardis</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Trends Genet</title>
		<imprint>
			<biblScope unit="volume">24</biblScope>
			<biblScope unit="page" from="133" to="174" />
			<date type="published" when="2008" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b13">
	<analytic>
		<title level="a" type="main">Advances in understanding cancer genomes through secondgeneration sequencing</title>
		<author>
			<persName>
				<forename type="first">M</forename>
				<surname>Meyerson</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nat Rev Genet</title>
		<imprint>
			<biblScope unit="volume">11</biblScope>
			<biblScope unit="page" from="685" to="696" />
			<date type="published" when="2010" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b14">
	<analytic>
		<title/>
	</analytic>
	<monogr>
		<title level="j">Novocraft</title>
		<imprint>
			<date type="published" when="2010-10-16" />
		</imprint>
	</monogr>
	<note>last. accessed date</note>
</biblStruct>

<biblStruct   xml:id="b15">
	<analytic>
		<title level="a" type="main">Comparative analysis of algorithms for next-generation sequencing read alignment</title>
		<author>
			<persName>
				<forename type="first">M</forename>
				<surname>Ruffalo</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">27</biblScope>
			<biblScope unit="page" from="2790" to="2796" />
			<date type="published" when="2011" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b16">
	<analytic>
		<title level="a" type="main">Chip-seq: using high-throughput sequencing to discover protein-dna interactions</title>
		<author>
			<persName>
				<forename type="first">D</forename>
				<surname>Schmidt</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Methods</title>
		<imprint>
			<biblScope unit="volume">48</biblScope>
			<biblScope unit="page" from="240" to="248" />
			<date type="published" when="2009" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b17">
	<analytic>
		<title level="a" type="main">Integrated analysis of gene expression, cpg island methylation, and gene copy number in breast cancer cells by deep sequencing</title>
		<author>
			<persName>
				<forename type="first">Z</forename>
				<surname>Sun</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">PLoS One</title>
		<imprint>
			<biblScope unit="volume">6</biblScope>
			<biblScope unit="page">17490</biblScope>
			<date type="published" when="2011" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b18">
	<analytic>
		<title level="a" type="main">RNA-Seq: a revolutionary tool for transcriptomics</title>
		<author>
			<persName>
				<forename type="first">Z</forename>
				<surname>Wang</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nat. Rev. Genet</title>
		<imprint>
			<biblScope unit="volume">10</biblScope>
			<biblScope unit="page" from="57" to="63" />
			<date type="published" when="2009" />
		</imprint>
	</monogr>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>