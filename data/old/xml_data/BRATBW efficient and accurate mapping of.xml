
<?xml version="1.0" encoding="UTF-8"?>
<TEI xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 /home/joey/Project/grobid/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<encodingDesc>
			<appInfo>
				<application version="0.4.2-SNAPSHOT" ident="GROBID" when="2017-08-10T23:53+0000">
					<ref target="https://github.com/kermitt2/grobid">GROBID - A machine learning software for extracting information from scholarly documents</ref>
				</application>
			</appInfo>
		</encodingDesc>
		<fileDesc>
			<titleStmt>
				<title level="a" type="main">Sequence analysis BRAT-BW: efficient and accurate mapping of bisulfite-treated reads</title>
			</titleStmt>
			<publicationStmt>
				<publisher/>
				<availability status="unknown"><licence/></availability>
				<date type="published" when="2012">. 13 2012</date>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author>
							<persName>
								<forename type="first">Elena</forename>
								<forename type="middle">Y</forename>
								<surname>Harris</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department">Department of Computer Science</orgName>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Nadia</forename>
								<surname>Ponts</surname>
							</persName>
							<affiliation key="aff1">
								<orgName type="department">Department of Cell Biology and Neuroscience</orgName>
								<orgName type="institution">University of California</orgName>
								<address>
									<postCode>92521</postCode>
									<settlement>Riverside</settlement>
									<region>CA</region>
									<country key="US">USA</country>
								</address>
							</affiliation>
							<affiliation key="aff2">
								<orgName type="institution">INRA</orgName>
								<address>
									<addrLine>71 Avenue Edouard Bourlaux</addrLine>
									<postCode>1264, BP81, 33883</postCode>
									<settlement>Villenave d&apos;Ornon Cedex</settlement>
									<region>MycSA UR</region>
									<country key="FR">France</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Karine</forename>
								<forename type="middle">G</forename>
								<surname>Le Roch</surname>
							</persName>
							<affiliation key="aff1">
								<orgName type="department">Department of Cell Biology and Neuroscience</orgName>
								<orgName type="institution">University of California</orgName>
								<address>
									<postCode>92521</postCode>
									<settlement>Riverside</settlement>
									<region>CA</region>
									<country key="US">USA</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Stefano</forename>
								<surname>Lonardi</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department">Department of Computer Science</orgName>
							</affiliation>
						</author>
						<title level="a" type="main">Sequence analysis BRAT-BW: efficient and accurate mapping of bisulfite-treated reads</title>
					</analytic>
					<monogr>
						<title level="j" type="main">BIOINFORMATICS APPLICATIONS NOTE</title>
						<imprint>
							<biblScope unit="volume">28</biblScope>
							<biblScope unit="page" from="1795" to="1796"/>
							<date type="published" when="2012">. 13 2012</date>
						</imprint>
					</monogr>
					<idno type="DOI">10.1093/bioinformatics/bts264</idno>
					<note type="submission">Received on February 16, 2012; revised on April 15, 2012; accepted on April 29, 2012</note>
					<note>Copyedited by: TRJ Page: 1795 1795–1796 Associate Editor: Martin Bishop Availability: The software is available in the public domain at Contact: elenah@cs.ucr.edu Supplementary information: Supplementary data are available at Bioinformatics online.</note>
				</biblStruct>
			</sourceDesc>
		</fileDesc>
		<profileDesc>
			<abstract>
				<p>We introduce BRAT-BW, a fast, accurate and memory-efficient tool that maps bisulfite-treated short reads (BS-seq) to a reference genome using the FM-index (Burrows–Wheeler transform). BRAT-BW is significantly more memory efficient and faster on longer reads than current state-of-the-art tools for BS-seq data, without compromising on accuracy. BRAT-BW is a part of a software suite for genome-wide single base-resolution methylation data analysis that supports single and paired-end reads and includes a tool for estimation of methylation level at each cytosine.</p>
			</abstract>
		</profileDesc>
	</teiHeader>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1">INTRODUCTION</head><p>Bisulfite sequencing (BS-seq) combined with next-generation sequencing (NGS) instruments enables genome-wide methylation analysis at a single base-resolution. Bisulfite treatment of DNA followed by PCR converts unmethylated cytocines to thymines and leaves methylated cytocines unchanged (<ref type="bibr" target="#b4">Frommer et al., 1992</ref>). Bisulfite-treated sequenced reads have to be aligned to the reference genome, but the treatment introduces the computational challenge of mapping both Cs and Ts in a read to Cs in the genome. The most successful methods for mapping short reads either use hashing or data structures based on the Burrows–Wheeler transform (<ref type="bibr" target="#b0">Burrows and Wheeler, 1994)</ref>where the latter approach is considered to yield more time efficient solutions than the former. Although several tools are available for BS-seq data, most of them still use hashing (including RMAP-bs, SOAP, MAQ and BRAT). The fastest tools for mapping BS-seq reads are Bismark (<ref type="bibr" target="#b6">Krueger and Andrews, 2011</ref>) and BS-seeker (<ref type="bibr" target="#b1">Chen et al., 2010</ref>). Both employ the mapping tool Bowtie (<ref type="bibr" target="#b7">Langmead et al., 2009</ref>) that internally uses the FM-index (<ref type="bibr" target="#b3">Ferragina and Manzini, 2000</ref>) based on the Burrows– Wheeler transform. As a consequence, both tools are required to post-process the output of Bowtie to remove ambiguous reads or reads with too many mismatches. Bismark synchronizes instances of FM-indexes run in parallel, which takes a toll on time-efficiency. BS-seeker outputs the results of distinct instances into separate files * To whom correspondence should be addressed. during mapping and then post-processes mapping results, which demands extra storage for intermediate results. Bismark and BSseeker can therefore require large amount of primary memory to complete the processing. Both tools support two distinct types of bisulfite libraries: the first type yields sequenced reads that are bisulfite-converted versions of two original genomic strands (<ref type="bibr" target="#b8">Lister et al., 2009</ref>); the second type produces reads that correspond to four possible strands, as a byproduct of PCR step (<ref type="bibr" target="#b2">Cokus et al., 2008</ref>). To support the second type of libraries, Bismark and BSseeker align reads to four distinct FM-indexes. Even though a type-1 bisulfite library would require only two FM-indexes, Bismark builds four FM-indexes in parallel requiring 16 GB of memory for human genome (Bowtie-2 with offrate 4). On the other hand, BS-seeker's memory footprint depends directly on the size of the input file: it may require up to 15 GB of memory for ∼30 M 32 bp-long reads (the typical number of reads/lane for the Illumina Genome Analyzer). Additionally, BS-seeker currently does not support paired-end reads and allows a limited number of mismatches per read, which makes it unsuitable for longer reads.<ref type="figure" target="#tab_1">Table 1</ref>in the Supplementary Material summarizes the features of all the available tools for BS-seq data. In this article we introduce BRAT-BW, a fast and accurate mapping tool that uses a very memory-efficient implementation of the FM-index. BRAT-BW is an evolution of BRAT (<ref type="bibr" target="#b5">Harris et al., 2010</ref>), which uses about half as much memory compared with BSseeker and Bismark. Additionally, its memory footprint does not depend on the size of the input sequenced reads, likely to continue to increase with future sequencing technologies advances. BRAT-BW supports both types of bisulfite libraries and handles single-end and paired-end reads. It has no limitation on the maximum length of the read or the number of allowed mismatches. BRAT-BW guarantees to find all matches as long as they have at most one mismatch in a prefix of length 32–64 bp (user defined) of the read. There are several advantages of designing a tool for BS-seq data based on the FM-index from the 'ground-up' instead of relying on a general-purpose tool such as Bowtie. BRAT-BW processes both FM-indexes on a single processor, so no synchronization cost is required. In addition, the selection of correctly mapped unique reads is performed 'on the fly' during mapping, so no storage for intermediate results is necessary.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2">METHODS, RESULTS AND DISCUSSION</head><p>BRAT-BW uses the strategy proposed in (<ref type="bibr" target="#b8">Lister et al., 2009</ref>) and employed by both Bismark and BS-seeker. Two FM-indexes are built on the positive strand of the reference genome: in the first, Cs are converted to Ts, and in the second, Gs are converted to As. Original reads with Cs convertedto Ts are mapped to the first index, and reverse-complements of the reads with Gs changed to As are mapped to the second index. To achieve higher efficiency, BRAT-BW employs a multi-seed approach similar to Bowtie-2, by attempting to align a read starting from different locations within the read (details in the Supplementary Material). To assess the accuracy of our tool with that of Bismark and BS-seeker, we generated 1 M in silico reads of different lengths originated from the human genome (hg18), with ∼2 % of errors introduced uniformly at random positions in each read. Our synthetic dataset consisted of a mix of 36 bp and 50 bp reads with one mismatch per read, 75 bp and 100 bp reads with two mismatches per read and 250 bp reads with five mismatches per read. Simulated reads and the parameters used to run the experiments are provided in the Supplementary Material. Bisulfite conversion rate was set to 98%.<ref type="figure" target="#fig_0">Figure 1</ref>reports the total number of uniquely mapped reads and mapping accuracy estimated as the number of unique reads mapped to the original genomic positions divided by the sum of correctly and incorrectly uniquely mapped reads. A read is considered mapped incorrectly if it was mapped with a number of mismatches equal to a given threshold, but the reported location differed from the original genomic location. Bismark and BS-seeker handles differently the case when a C in a read has to be mapped to T in the genome: Bismark allows this mapping, whereas BS-seeker considers it a mismatch. We calculated the number of mismatches in the resulting mapped reads according to both policies. BRAT-BW allows a user to choose between the two policies. In all experiments, Bowtie's FM-index was built with an offrate 4. For BS-seeker, option p was disabled. For BS-seeker on 250 bp-long reads, we required the tool to map the first 150 bp with three mismatches (maximum allowed).<ref type="figure" target="#fig_0">Figure 1</ref>shows that the performance of BRAT-BW in terms of mapped uniquely bases and mapping accuracy is comparable with the best results of the other tools. On longer reads, BRATBW shows slightly better mapping accuracy than Bismark with Bowtie-2. We carried out the same tests on BRAT (tool brat-large). Since brat-large does not allow mismatches in the first 24 bases of a read, the error model used to generate the simulated reads is severely affecting the performance of brat-large. Unlike real reads where the majority of sequencing errors tend to accumulate towards the 3 end, a substantial portion of our simulated reads had mismatches in the first 24 bp. On 36, 50, 75, 100 and 250 bp reads, brat-large only mapped 27, 43, 40, 51 and 55% of reads, respectively, with mapping accuracy of 96.3, 98.8, 99.2, 99.7 and 99.96%, respectively. To evaluate time-and memory efficiency on real data, we used human reads (SRA #SRR020138,<ref type="bibr" target="#b8">Lister et al., 2009</ref>) and prepared two datasets. The first one contains 32 bp-long reads obtained by selecting the high-quality prefix of that length. Each read was duplicated to obtain a realistic number of sequenced reads per lane (∼29.6 M in total). In the second dataset we trimmed reads by quality, selected the first 64 bases, then removed the first two bases, and duplicated each read (∼24.5 M in total).<ref type="figure" target="#tab_1">Table 1</ref>shows that BRAT-BW used half as much memory as other tools. On short reads, the time and the total number of mapped reads was comparable among all tools considered here. On longer reads, BRAT-BW was 1.5, 2.7, 3 and 3 times</p></div><figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_0"><head>Fig.1.</head><figDesc>Fig. 1. Percentage of bases mapped uniquely (bars) and mapping accuracy (lines) on synthetic data, as a function of the read length faster than Bismark with Bowtie-1 and Bowtie-2, BS-seeker, and BRAT, respectively.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_1" validated="false"><figDesc>Table 1.</figDesc><table>Comparing the efficiency of several BS-seq mapping tools 

Options 
Time 
RAM (GB) 
Mapped reads (%) 

32 bp 
Bismark 
bowtie1, best, k = 2, n = 1, l = 32, q 
94 m 26 s 
14.7 
61.3 
BS-seeker 
best, k = 2, n = 1 
110 m 55 s 
15.0 
64.2 
BRAT 
bs, m = 1, S 
190 m 57 s 
2.9 
61.2 
BRAT-BW 
S = 16, C, F = 1, m = 1 
99 m 23 s 
6.4 
65.9 

62 bp 
Bismark 
bowtie1, best, k = 2, l = 32, n = 1, e = 150 
158 m 22 s 
14.7 
73.2 
BS-seeker 
best, k = 2, e = 64, m = 3 
317 m 0 s 
14.0 
72.4 
BRAT 
S, m = 3, bs 
330 m 2 s 
2.9 
68.7 
BRAT-BW 
S = 16, m = 3 
104 m 54 s 
6.4 
73.6 

</table></figure>

			<note place="foot">© The Author 2012. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oup.com</note>

			<note place="foot">at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>
		</body>
		<back>

			<div type="acknowledgement">
<div xmlns="http://www.tei-c.org/ns/1.0"><head>ACKNOWLEDGEMENTS</head></div>
			</div>

			<div type="references">

				<listBibl>

<biblStruct   xml:id="b0">
	<monogr>
		<title level="m" type="main">A block sorting lossless data compression algorithm</title>
		<author>
			<persName>
				<forename type="first">M</forename>
				<surname>Burrows</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">D</forename>
				<surname>Wheeler</surname>
			</persName>
		</author>
		<imprint>
			<date type="published" when="1994" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b1">
	<analytic>
		<title level="a" type="main">BS Seeker: precise mapping for bisulfite sequencing</title>
		<author>
			<persName>
				<forename type="first">P</forename>
				<forename type="middle">Y</forename>
				<surname>Chen</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">BMC Bioinform</title>
		<imprint>
			<biblScope unit="volume">11</biblScope>
			<biblScope unit="page">203</biblScope>
			<date type="published" when="2010" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b2">
	<analytic>
		<title level="a" type="main">Shotgun bisulphite sequencing of the Arabidopsis genome reveals DNA methylation patterning</title>
		<author>
			<persName>
				<forename type="first">S</forename>
				<forename type="middle">J</forename>
				<surname>Cokus</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nature</title>
		<imprint>
			<biblScope unit="volume">452</biblScope>
			<biblScope unit="page" from="215" to="219" />
			<date type="published" when="2008" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b3">
	<analytic>
		<title level="a" type="main">Opportunistic data structures with applications</title>
		<author>
			<persName>
				<forename type="first">P</forename>
				<surname>Ferragina</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">G</forename>
				<surname>Manzini</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proceedings of IEEE Foundation of Computer Science</title>
		<meeting>IEEE Foundation of Computer Science<address><addrLine>Redondo Beach, CA</addrLine></address></meeting>
		<imprint>
			<date type="published" when="2000" />
			<biblScope unit="page" from="390" to="398" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b4">
	<monogr>
		<title level="m" type="main">A genomic sequencing protocol that yields a positive display of 5-methylcytosine residues in individual DNA strands</title>
		<author>
			<persName>
				<forename type="first">M</forename>
				<surname>Frommer</surname>
			</persName>
		</author>
		<imprint>
			<date type="published" when="1992" />
			<publisher>PNAS</publisher>
			<biblScope unit="page" from="1827" to="1831" />
			<pubPlace>USA</pubPlace>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b5">
	<analytic>
		<title level="a" type="main">BRAT: bisulfite-treated reads analysis tool</title>
		<author>
			<persName>
				<forename type="first">E</forename>
				<forename type="middle">Y</forename>
				<surname>Harris</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">26</biblScope>
			<biblScope unit="page" from="572" to="573" />
			<date type="published" when="2010" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b6">
	<analytic>
		<title level="a" type="main">Bismark: a flexible aligner and methylation caller for Bisulfite-Seq applications</title>
		<author>
			<persName>
				<forename type="first">F</forename>
				<surname>Krueger</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">S</forename>
				<surname>Andrews</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">27</biblScope>
			<biblScope unit="page" from="1571" to="1572" />
			<date type="published" when="2011" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b7">
	<analytic>
		<title level="a" type="main">Ultrafast and memory-efficient alignment of short DNA sequences to the human genome</title>
		<author>
			<persName>
				<forename type="first">B</forename>
				<surname>Langmead</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Genome Biol</title>
		<imprint>
			<biblScope unit="volume">10</biblScope>
			<biblScope unit="page">25</biblScope>
			<date type="published" when="2009" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b8">
	<analytic>
		<title level="a" type="main">Human DNA methylomes at base resolution show widespread epigenomic differences</title>
		<author>
			<persName>
				<forename type="first">R</forename>
				<surname>Lister</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nature</title>
		<imprint>
			<biblScope unit="volume">462</biblScope>
			<biblScope unit="page" from="315" to="322" />
			<date type="published" when="2009" />
		</imprint>
	</monogr>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>