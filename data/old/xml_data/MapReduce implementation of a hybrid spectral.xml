
<?xml version="1.0" encoding="UTF-8"?>
<TEI xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 /home/joey/Project/grobid/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<encodingDesc>
			<appInfo>
				<application version="0.4.2-SNAPSHOT" ident="GROBID" when="2017-08-10T23:30+0000">
					<ref target="https://github.com/kermitt2/grobid">GROBID - A machine learning software for extracting information from scholarly documents</ref>
				</application>
			</appInfo>
		</encodingDesc>
		<fileDesc>
			<titleStmt>
				<title level="a" type="main">MapReduce implementation of a hybrid spectral library-database search method for large-scale peptide identification</title>
			</titleStmt>
			<publicationStmt>
				<publisher/>
				<availability status="unknown"><licence/></availability>
				<date type="published" when="2011">. 21 2011</date>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author>
							<persName>
								<forename type="first">Ananth</forename>
								<surname>Kalyanaraman</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department">School of Electrical Engineering and Computer Science</orgName>
								<orgName type="institution">Washington State University</orgName>
								<address>
									<postCode>99164-2752</postCode>
									<settlement>Pullman</settlement>
									<region>WA</region>
								</address>
							</affiliation>
						</author>
						<author role="corresp">
							<persName>
								<forename type="first">William</forename>
								<forename type="middle">R</forename>
								<surname>Cannon</surname>
							</persName>
							<email>william.cannon@pnnl.gov</email>
							<affiliation key="aff1">
								<orgName type="laboratory">Computational Biology and Bioinformatics Group</orgName>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Benjamin</forename>
								<surname>Latt</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department">School of Electrical Engineering and Computer Science</orgName>
								<orgName type="institution">Washington State University</orgName>
								<address>
									<postCode>99164-2752</postCode>
									<settlement>Pullman</settlement>
									<region>WA</region>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Douglas</forename>
								<forename type="middle">J</forename>
								<surname>Baxter</surname>
							</persName>
							<affiliation key="aff2">
								<orgName type="department">Molecular Sciences Computing Facility</orgName>
								<orgName type="laboratory">Environmental Molecular Sciences Laboratory</orgName>
								<orgName type="institution">Pacific Northwest National Laboratory</orgName>
								<address>
									<postCode>99352</postCode>
									<settlement>Richland</settlement>
									<region>WA</region>
									<country key="US">USA</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Alex</forename>
								<surname>Bateman</surname>
							</persName>
						</author>
						<title level="a" type="main">MapReduce implementation of a hybrid spectral library-database search method for large-scale peptide identification</title>
					</analytic>
					<monogr>
						<title level="j" type="main">BIOINFORMATICS APPLICATIONS NOTE</title>
						<imprint>
							<biblScope unit="volume">27</biblScope>
							<biblScope unit="page" from="3072" to="3073"/>
							<date type="published" when="2011">. 21 2011</date>
						</imprint>
					</monogr>
					<idno type="DOI">10.1093/bioinformatics/btr523</idno>
					<note type="submission">Systems biology Advance Access publication September 16, 2011 Received on February 4, 2011; revised on July 18, 2011; accepted on September 1, 2011.</note>
					<note>[17:52 7/10/2011 Bioinformatics-btr523.tex] Page: 3072 3072–3073 Associate Editor: Supplementary Information: Supplementary data are available at Bioinformatics online.</note>
				</biblStruct>
			</sourceDesc>
		</fileDesc>
		<profileDesc>
			<abstract>
				<p>A MapReduce-based implementation called MR-MSPolygraph for parallelizing peptide identification from mass spectrometry data is presented. The underlying serial method, MSPolygraph, uses a novel hybrid approach to match an experimental spectrum against a combination of a protein sequence database and a spectral library. Our MapReduce implementation can run on any Hadoop cluster environment. Experimental results demonstrate that, relative to the serial version, MR-MSPolygraph reduces the time to solution from weeks to hours, for processing tens of thousands of experimental spectra. Speedup and other related performance studies are also reported on a 400-core Hadoop cluster using spectral datasets from environmental microbial communities as inputs. Availability: The source code along with user documentation are available on http://compbio.eecs.</p>
			</abstract>
		</profileDesc>
	</teiHeader>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1">INTRODUCTION</head><p>Identifying the sequence composition of peptides is of fundamental importance to systems biology research. High-throughput proteomic technologies using mass spectroscopy are capable of generating millions of peptide mass spectra in a matter of days. One of the most effective ways to annotate these spectra is to compare the experimental spectra against a database of known protein sequences. The main idea here is to generate candidate peptide sequences from the genome of the organism under study and then to use models of peptide fragmentation to generate model spectra that can be compared against each experimental spectrum. However, as samples become richer in diversity (e.g. from environmental microbial communities), the number of candidate comparisons could increase by orders of magnitude (Supplementary<ref type="figure" target="#fig_2">Figure S1</ref>). An increase in the number of candidates also increases the probability of finding high-scoring, random matches. It is therefore essential to implement a peptide identification method that is both accurate and scalable to large sizes of spectral collections and sequence databases. The prediction accuracy of peptide identification can be improved * To whom correspondence should be addressed. if experimental spectra are also compared against spectral libraries, although this would only exacerbate the computational demands. Recently,<ref type="bibr" target="#b0">Cannon et al. (2011)</ref>developed a novel hybrid statistical method within the MSPolygraph framework, which combines the use of highly accurate spectral libraries, when available, along with on-the-fly generation of model spectra when spectral libraries are not available. This method demonstrated increases of 57–147% in the number of confidently identified peptides at controlled false discovery rates. This effort to enrich quality of prediction, however, comes at an increased computational cost. While a parallel MPI version of the code exists, most users do not have access to large-scale parallel clusters. Whereas, open-source science cloud installations and commercial vendors such as Amazon provide access to MapReduce clusters on an on-demand basis. In this article, we present a MapReduce implementation of MSPolygraph called MR-MSPolygraph. MapReduce (<ref type="bibr" target="#b1">Dean and Ghemawat, 2008</ref>) is an emerging parallel paradigm for data intensive applications, and is becoming a de facto standard in cloud installations. One of the popular open-source implementations for MapReduce is the Hadoop framework. MR-MSPolygraph uses MapReduce to efficiently distribute the matching of a large spectral collection on a Hadoop cluster. Previously,<ref type="bibr" target="#b2">Halligan et al. (2009)</ref>ported peptide identifications tools that use the database search approach onto the Amazon EC2 cloud environment. Our work incorporates the statistics of the hybrid search method in MSPolygraph to any cluster running the open-source Hadoop environment.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2">METHODS</head><p>MR-MSPolygraph is designed to achieve parallelism across the number of experimental spectra to be matched. The MapReduce framework requires developers to define two functions: mapper and reducer. In our case, since the processing of each spectrum is independent of one another, we take advantage of the inherent data parallelism by splitting the input experimental spectra across map tasks. More specifically, the user inputs: (i) (queries) a set of experimental spectra to be matched; (ii) (database) a fasta file containing known protein/peptide sequences; (iii) (spectral library) a set of peptides to be used as the spectral library (required only when the software is run in the 'hybrid' mode); and (iv) a file with quality control and output parameters. In addition, the user specifies a desired number of map tasks. The algorithm executes as follows: first, the queries are automatically partitioned into roughly equal sized chunks and supplied as input to each map task. The chunk size can be controlled either by altering the number of map tasks and/or the min.split.size parameter within Hadoop. Each map task then runs a modified implementation of the serial MSPolygraph code, which matches thelocal batch of queries against the entire database, and also against the spectral library if run on the hybrid mode. The map tasks then output, in one file per task, a list of hits (sorted by statistical significance) for each of their queries. The algorithm has a worst-case complexity of O(q(n 1 +n 2 )/p), where q is the number of experimental spectra, p is the number of mappers and n 1 and n 2 are the sizes of the database and spectral library, respectively. Since the mappers' output cover different subsets of queries, the reducer functionality is not used. However, if it is desired to have all the hits reported in one output file, then it can be achieved using a single reducer. More usage details and parameter descriptions can be found at the software web site.<ref type="figure" target="#fig_2">Figure 1a</ref>shows the runtime of MR-MSPolygraph as a function of input number of spectra (from 1K to 64K). Both modes of the software, hybrid and database only, were tested. As expected, the runtime grows linearly with the input number of spectra. Furthermore, both the hybrid and database-only versions take almost identical times, indicating that the additional cost of matching against the spectral library is negligible for this input. It can be expected that this cost grows gradually with the size of spectral library used. We also studied the performance by measuring the parallel runtime as a function of the number of map tasks used. Supplementary<ref type="figure">Table S1</ref>shows the runtimes and<ref type="figure" target="#fig_2">Figure 1b</ref>shows the corresponding speedup up to 400 map tasks, calculated relative to the corresponding 100 mapper run. As can be observed, the runtime roughly halves with doubling of the number of map tasks and the speedup becomes linear for larger inputs (e.g. 398× on 400 map tasks for 64K spectra). This can be expected as for smaller inputs; the overhead of loading the database and spectral library is likely to dominate in larger processor sizes. Perhaps the merits of Hadoop parallelism become more evident upon comparing its performance against a serial implementation. For instance, to match the entire collection of 64 000 spectra in hybrid mode, the MSPolygraph's serial implementation can be estimated to take &gt;2000 CPU hours using a state-of-the-art desktop computer; whereas, our Hadoop implementation finishes this task in ∼6 h using 400 cores. We also studied the effect of changing task granularity for each map task and the results are summarized under Supplementary Material.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3">RESULTS</head></div><figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_0"><head></head><figDesc>[17:52 7/10/2011 Bioinformatics-btr523.tex] Page: 3073 3072–3073</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_2"><head>Fig.1.</head><figDesc>Fig. 1. Performance of MR-MSPolygraph: (a) Runtime as a function of the input number of spectra, keeping the number of map tasks fixed at 400; and (b) speedup of the hybrid version relative to 100 map tasks, for varying input sizes. The number of map tasks is generally equal to the number of cores used, although that could slightly vary as determined by Hadoop at runtime.</figDesc></figure>

			<note place="foot">© The Author(s) 2011. Published by Oxford University Press. This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (http://creativecommons.org/licenses/ by-nc/3.0), which permits unrestricted non-commercial use, distribution, and reproduction in any medium, provided the original work is properly cited. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>

			<note place="foot" n="3073"> at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>
		</body>
		<back>

			<div type="acknowledgement">
<div xmlns="http://www.tei-c.org/ns/1.0"><head>ACKNOWLEDGEMENTS</head><p>We thank Dr Ramakrishnan at NERSC for offering extensive help with the set up of Hadoop environment. And, the National Energy Research Scientific Computing Center (NERSC) at Lawrence Berkeley National Laboratory.</p></div>
			</div>

			<div type="references">

				<listBibl>

<biblStruct   xml:id="b0">
	<analytic>
		<title level="a" type="main">Large improvements in MS/MS based peptide identification rates using a hybrid analysis</title>
		<author>
			<persName>
				<forename type="first">W</forename>
				<forename type="middle">R</forename>
				<surname>Cannon</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J Proteome Res</title>
		<imprint>
			<biblScope unit="volume">10</biblScope>
			<biblScope unit="page" from="2306" to="2317" />
			<date type="published" when="2011" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b1">
	<analytic>
		<title level="a" type="main">MapReduce: simplified data processing on large clusters</title>
		<author>
			<persName>
				<forename type="first">J</forename>
				<surname>Dean</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">S</forename>
				<surname>Ghemawat</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Commun. ACM</title>
		<imprint>
			<biblScope unit="volume">51</biblScope>
			<biblScope unit="page" from="107" to="113" />
			<date type="published" when="2008" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b2">
	<analytic>
		<title level="a" type="main">Low-cost, scalable proteomics data analysis using Amazon&apos;s cloud computing services and open source search algorithms</title>
		<author>
			<persName>
				<forename type="first">B</forename>
				<forename type="middle">D</forename>
				<surname>Halligan</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Proteome Res</title>
		<imprint>
			<biblScope unit="volume">8</biblScope>
			<biblScope unit="page" from="3148" to="3153" />
			<date type="published" when="2009" />
		</imprint>
	</monogr>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>