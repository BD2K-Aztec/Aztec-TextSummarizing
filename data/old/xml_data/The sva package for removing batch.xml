
<?xml version="1.0" encoding="UTF-8"?>
<TEI xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 /home/joey/Project/grobid/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<encodingDesc>
			<appInfo>
				<application version="0.4.2-SNAPSHOT" ident="GROBID" when="2017-08-10T23:42+0000">
					<ref target="https://github.com/kermitt2/grobid">GROBID - A machine learning software for extracting information from scholarly documents</ref>
				</application>
			</appInfo>
		</encodingDesc>
		<fileDesc>
			<titleStmt>
				<title level="a" type="main">Gene expression The sva package for removing batch effects and other unwanted variation in high-throughput experiments</title>
			</titleStmt>
			<publicationStmt>
				<publisher/>
				<availability status="unknown"><licence/></availability>
				<date type="published" when="2012">2012</date>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author>
							<persName>
								<forename type="first">Jeffrey</forename>
								<forename type="middle">T</forename>
								<surname>Leek</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department">Department of Biostatistics</orgName>
								<orgName type="institution">JHU Bloomberg School of Public Health</orgName>
								<address>
									<settlement>Baltimore</settlement>
									<region>MD</region>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">W</forename>
								<forename type="middle">Evan</forename>
								<surname>Johnson</surname>
							</persName>
							<affiliation key="aff1">
								<orgName type="department">Division of Computational Biomedicine</orgName>
								<orgName type="institution">Boston University</orgName>
								<address>
									<settlement>Boston</settlement>
									<region>MA</region>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Hilary</forename>
								<forename type="middle">S</forename>
								<surname>Parker</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department">Department of Biostatistics</orgName>
								<orgName type="institution">JHU Bloomberg School of Public Health</orgName>
								<address>
									<settlement>Baltimore</settlement>
									<region>MD</region>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Andrew</forename>
								<forename type="middle">E</forename>
								<surname>Jaffe</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department">Department of Biostatistics</orgName>
								<orgName type="institution">JHU Bloomberg School of Public Health</orgName>
								<address>
									<settlement>Baltimore</settlement>
									<region>MD</region>
								</address>
							</affiliation>
							<affiliation key="aff2">
								<orgName type="department">Department of Epidemiology</orgName>
								<orgName type="institution">JHU Bloomberg School of Public Health</orgName>
								<address>
									<settlement>Baltimore</settlement>
									<region>MD</region>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">John</forename>
								<forename type="middle">D</forename>
								<surname>Storey</surname>
							</persName>
							<affiliation key="aff3">
								<orgName type="department">Department of Molecular Biology</orgName>
								<orgName type="institution" key="instit1">Lewis-Sigler Institute</orgName>
								<orgName type="institution" key="instit2">Princeton University</orgName>
								<address>
									<settlement>Princeton</settlement>
									<region>NJ</region>
									<country key="US">USA</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Janet</forename>
								<surname>Kelso</surname>
							</persName>
						</author>
						<title level="a" type="main">Gene expression The sva package for removing batch effects and other unwanted variation in high-throughput experiments</title>
					</analytic>
					<monogr>
						<title level="j" type="main">BIOINFORMATICS APPLICATIONS NOTE</title>
						<imprint>
							<biblScope unit="volume">28</biblScope>
							<biblScope unit="issue">6</biblScope>
							<biblScope unit="page" from="882" to="883"/>
							<date type="published" when="2012">2012</date>
						</imprint>
					</monogr>
					<idno type="DOI">10.1093/bioinformatics/bts034</idno>
					<note type="submission">Received on November 7, 2011; revised on January 12, 2012; accepted on January 13, 2012</note>
					<note>[16:49 27/2/2012 Bioinformatics-bts034.tex] Page: 882 882–883 Associate Editor: Contact: jleek@jhsph.edu Supplementary information: Supplementary data are available at Bioinformatics online.</note>
				</biblStruct>
			</sourceDesc>
		</fileDesc>
		<profileDesc>
			<abstract>
				<p>Heterogeneity and latent variables are now widely recognized as major sources of bias and variability in high-throughput experiments. The most well-known source of latent variation in genomic experiments are batch effects—when samples are processed on different days, in different groups or by different people. However, there are also a large number of other variables that may have a major impact on high-throughput measurements. Here we describe the sva package for identifying, estimating and removing unwanted sources of variation in high-throughput experiments. The sva package supports surrogate variable estimation with the sva function, direct adjustment for known batch effects with the ComBat function and adjustment for batch and latent variables in prediction problems with the fsva function. Availability: The R package sva is freely available from http://www .bioconductor.org.</p>
			</abstract>
		</profileDesc>
	</teiHeader>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1">INTRODUCTION</head><p>High-throughput data are now commonly used in molecular biology to (i) identify genomic features associated with outcomes and (ii) build signatures for prediction. These goals are complicated by the presence of latent variables or unwanted heterogeneity in the high-throughput data. Batch effects are the most widely recognized potential latent variable in genomic experiments. The impact of batch effects can be severe, potentially completely compromising biological results (<ref type="bibr" target="#b5">Leek et al., 2010</ref>). Furthermore, batch effects are not the only potential source of latent variation that may compromise the statistical or biological validity of a study (<ref type="bibr" target="#b3">Leek and Storey, 2007</ref>). Here we introduce the sva package for identifying and removing batch effects and other unwanted sources of variation. The sva package contains methods for removing artifacts both by:</p><p>(i) identifying and estimating surrogate variables for unknown * To whom correspondence should be addressed. sources of variation in high-throughput experiments (<ref type="bibr" target="#b5">Leek and</ref><ref type="bibr">Storey, 2007, 2008</ref>) and (ii) directly removing known batch effects using ComBat (<ref type="bibr" target="#b2">Johnson et al., 2007</ref>). Removing batch effects and using surrogate variables have been shown to reduce dependence, stabilize error rate estimates and improve reproducibility (<ref type="bibr" target="#b5">Leek and</ref><ref type="bibr">Storey, 2007, 2008;</ref><ref type="bibr" target="#b5">Leek et al., 2010</ref>). Finally, the sva package includes the only publicly available function, fsva, for identifying and removing latent variables in genomic/epigenomic prediction problems.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2">USING THE SVA PACKAGE</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.1">Data format</head><p>The data are formatted as a matrix, with features (transcripts, genes, proteins) in rows and samples in the columns. Two model matrices must be created with the model.matrix function—the 'null model' and the 'full model'. The null model consists of the known variables and covariates that must be included as adjustment variables. The full model includes all the variables in the null model, as well as the variable of interest. The variable of interest is the outcome/phenotype being predicted or associated with the high-throughput data.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.2">The sva function for estimating and removing surrogate variables</head><p>The sva function is part of a two step process that first estimates surrogate variables and then removes them in a differential expression analysis. Surrogate variables can be estimated by applying the sva function to the high-dimensional data matrix (dat), with arguments for the full model matrix (mod) and the null model matrix (mod0). The output of the sva function are the surrogate variables themselves. They can be included in the model matrix and null model matrix and then passed, along with the data matrix, to the f.pvalue function in the sva package to calculate parametric F-test P-values adjusted for surrogate variables.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.3">The ComBat function for removing batch effects</head><p>The ComBat function adjusts for known batches using an empirical Bayesian framework (<ref type="bibr" target="#b2">Johnson et al., 2007</ref>). The ComBat function is again applied to the high-dimensional data matrix, passing the full model matrix created without any known batch variables.Page: 883 882–883</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>The sva package</head><p>Batch variables are passed as a separate argument (batch) to the function. The output is a set of corrected measurements, where batch effects have been removed. Standard analysis techniques can be applied to this corrected data, or the sva function can be applied to remove potentially unwanted sources of variation.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.4">fsva for prediction</head><p>For genomic prediction, datasets are generally composed of a training set and a test set. For each sample in the training set, the outcome/class is known, but latent sources of variability are unknown. For the samples in the test set, neither the outcome/class nor the latent sources of variability are known. When applying genomic predictors, individual samples must be corrected. But most functions for batch correction and surrogate variable estimation have been developed in the context of population studies. 'Frozen' surrogate variable analysis can be used to remove latent variation in the training and test sets, as well as individual samples obtained in future studies, similar to the recently developed normalization procedures (<ref type="bibr" target="#b6">McCall et al., 2010</ref>). The arguments that must be passed to fsva are a database of measurements from the training set (dbdat), the model matrix for the training set (mod), the sva object obtained from running sva on the training set and optionally the data from the test set (newdat). The fsva function returns corrected training data (db) and corrected test data (new). If new samples are obtained, they can be adjusted for surrogate variables by including them in the newdat data matrix while leaving all other arguments the same. To illustrate this method, we applied the fsva function to a previously published study of gene expression in bladder cancer. Adjustment with fsva led to increased accuracy and improved clustering of samples in the test set (Supplemental Materials).</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3">DISCUSSION</head><p>We have introduced the sva package, including the popular ComBat function for removing batch and other unmeasured or unmodeled sources of variation. We have also introduced the first function for removing batch effects in genomic prediction problems. The sva package is freely available from the Bioconductor website and is compatible with widely used differential expression software such as limma (<ref type="bibr" target="#b8">Smyth, 2004</ref>).</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.1">Surrogate variables versus direct adjustment</head><p>The goal of sva is to remove all unwanted sources of variation while protecting the contrasts due to the primary variables specified in the function call. This leads to the identification of features that are consistently different between groups, removing all common sources of latent variation. In some cases, latent variables may be important sources of biological variability. If the goal of the analysis is to identify heterogeneity in one or more subgroups, the sva function may not be appropriate. For example, suppose it is expected that cancer samples represent two distinct, but unknown subgroups of biological interest. If these subgroups have a large impact on expression, then one or more of the estimated surrogate variables may be highly correlated with the subgroup (<ref type="bibr" target="#b9">Teschendorff et al., 2011</ref>). This is true regardless of whether the surrogate variables are estimated with principal components, singular vectors (<ref type="bibr" target="#b5">Leek and</ref><ref type="bibr">Storey, 2007, 2008</ref>) or independent components (<ref type="bibr" target="#b9">Teschendorff et al., 2011</ref>). However, removing surrogate variables that are correlated with the phenotype of interest may lead to inconsistent and anticonservatively biased significance analysis, specially if unknown latent variables are correlated with the phenotype of interest (<ref type="bibr" target="#b3">Leek and Storey, 2007</ref>). Thus, whether exclusion of surrogate variables improves inference or not is an open unsolved problem. In contrast, direct adjustment only removes the effect of known batch variables. Batch effects are the best-known source of latent variation in genomic experiments (<ref type="bibr" target="#b5">Leek et al., 2010</ref>). However, there are many variables that may have a substantial impact on genomic measurements, from environmental variables (<ref type="bibr" target="#b1">Gibson, 2008</ref>) to genetic variation (<ref type="bibr" target="#b0">Brem et al., 2002;</ref><ref type="bibr" target="#b7">Schadt et al., 2003</ref>). These variables may be the focus of the study being performed. But there are many studies that focus on identifying the association between genomic measurements and specific outcomes or phenotypes. In these studies, genetic and environmental variables are often unmeasured or unmodeled. If ignored, these biological variables may act in the same way that batch effects act by obscuring signal, reducing power and biasing biological conclusions (<ref type="bibr" target="#b3">Leek and Storey, 2007</ref>). As a rule of thumb, when there are a large number of known or unknown potential confounders, surrogate variable adjustment may be more appropriate. Alternatively, when one or more biological groups is known to be heterogeneous, and there are known batch variables, direct adjustment may be more appropriate.</p></div><figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_0"><head>[16:</head><figDesc>49 27/2/2012 Bioinformatics-bts034.tex]</figDesc></figure>

			<note place="foot">© The Author 2012. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oup.com at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>

			<note place="foot">at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>
		</body>
		<back>

			<div type="acknowledgement">
<div xmlns="http://www.tei-c.org/ns/1.0"><head>ACKNOWLEDGEMENT</head><p>We would like to thank Rafa Irizarry and the Feinberg Lab for helpful comments and feedback on the sva package.</p></div>
			</div>

			<div type="references">

				<listBibl>

<biblStruct   xml:id="b0">
	<analytic>
		<title level="a" type="main">Genetic dissection of transcriptional regulation in budding yeast</title>
		<author>
			<persName>
				<forename type="first">R</forename>
				<forename type="middle">B</forename>
				<surname>Brem</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Science</title>
		<imprint>
			<biblScope unit="volume">296</biblScope>
			<biblScope unit="page" from="752" to="755" />
			<date type="published" when="2002" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b1">
	<analytic>
		<title level="a" type="main">The environmental contribution to gene expression profiles</title>
		<author>
			<persName>
				<forename type="first">G</forename>
				<surname>Gibson</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nat. Rev. Genet</title>
		<imprint>
			<biblScope unit="volume">9</biblScope>
			<biblScope unit="page" from="575" to="581" />
			<date type="published" when="2008" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b2">
	<analytic>
		<title level="a" type="main">Adjusting batch effects in microarray data using empirical bayes methods</title>
		<author>
			<persName>
				<forename type="first">W</forename>
				<surname>Johnson</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Biostatistics</title>
		<imprint>
			<biblScope unit="volume">8</biblScope>
			<biblScope unit="page" from="118" to="127" />
			<date type="published" when="2007" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b3">
	<analytic>
		<title level="a" type="main">Capturing heterogeneity in gene expression studies by &apos;surrogate variable analysis</title>
		<author>
			<persName>
				<forename type="first">J</forename>
				<surname>Leek</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">J</forename>
				<surname>Storey</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">PLoS Genet</title>
		<imprint>
			<biblScope unit="volume">3</biblScope>
			<biblScope unit="page">161</biblScope>
			<date type="published" when="2007" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b4">
	<analytic>
		<title level="a" type="main">A general framework for multiple testing dependence</title>
		<author>
			<persName>
				<forename type="first">J</forename>
				<surname>Leek</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">J</forename>
				<surname>Storey</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proc. Natl Acad. Sci. 105</title>
		<meeting>. Natl Acad. Sci. 105</meeting>
		<imprint>
			<date type="published" when="2008" />
			<biblScope unit="page" from="18718" to="18723" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b5">
	<analytic>
		<title level="a" type="main">Tackling the widespread and critical impact of batch effects in high-throughput data</title>
		<author>
			<persName>
				<forename type="first">J</forename>
				<forename type="middle">T</forename>
				<surname>Leek</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nat. Rev. Genet</title>
		<imprint>
			<biblScope unit="volume">11</biblScope>
			<biblScope unit="page" from="733" to="739" />
			<date type="published" when="2010" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b6">
	<analytic>
		<title level="a" type="main">Frozen robust multiarray analysis (fRMA)</title>
		<author>
			<persName>
				<forename type="first">M</forename>
				<forename type="middle">N</forename>
				<surname>Mccall</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Biostatistics</title>
		<imprint>
			<biblScope unit="volume">11</biblScope>
			<biblScope unit="page" from="242" to="253" />
			<date type="published" when="2010" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b7">
	<analytic>
		<title level="a" type="main">Genetics of gene expression surveyed in maize, mouse and man</title>
		<author>
			<persName>
				<forename type="first">E</forename>
				<forename type="middle">E</forename>
				<surname>Schadt</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nature</title>
		<imprint>
			<biblScope unit="volume">422</biblScope>
			<biblScope unit="page" from="297" to="302" />
			<date type="published" when="2003" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b8">
	<analytic>
		<title level="a" type="main">Linear models and empirical bayes methods for assessing differential expression in microarray experiments</title>
		<author>
			<persName>
				<forename type="first">G</forename>
				<forename type="middle">K</forename>
				<surname>Smyth</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Stat. Appl. Genet. Mol. Biol</title>
		<imprint>
			<biblScope unit="volume">3</biblScope>
			<biblScope unit="page">3</biblScope>
			<date type="published" when="2004" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b9">
	<analytic>
		<title level="a" type="main">Independent surrogate variable analysis to deconvolve confounding factors in large-scale microarray profiling studies</title>
		<author>
			<persName>
				<forename type="first">A</forename>
				<forename type="middle">E</forename>
				<surname>Teschendorff</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">27</biblScope>
			<biblScope unit="page" from="1496" to="1505" />
			<date type="published" when="2011" />
		</imprint>
	</monogr>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>