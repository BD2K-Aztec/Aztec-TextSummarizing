
<?xml version="1.0" encoding="UTF-8"?>
<TEI xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 /home/joey/Project/grobid/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<encodingDesc>
			<appInfo>
				<application version="0.4.2-SNAPSHOT" ident="GROBID" when="2017-08-10T23:45+0000">
					<ref target="https://github.com/kermitt2/grobid">GROBID - A machine learning software for extracting information from scholarly documents</ref>
				</application>
			</appInfo>
		</encodingDesc>
		<fileDesc>
			<titleStmt>
				<title level="a" type="main">Genome analysis BayesPeak—an R package for analysing ChIP-seq data</title>
			</titleStmt>
			<publicationStmt>
				<publisher/>
				<availability status="unknown"><licence/></availability>
				<date type="published" when="2011">2011</date>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author>
							<persName>
								<forename type="first">Jonathan</forename>
								<surname>Cairns</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department">Department of Oncology</orgName>
								<orgName type="institution" key="instit1">University of Cambridge</orgName>
								<orgName type="institution" key="instit2">Li Ka Shing Centre</orgName>
								<address>
									<addrLine>Robinson Way</addrLine>
									<postCode>CB2 0RE</postCode>
									<settlement>Cambridge</settlement>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Christiana</forename>
								<surname>Spyrou</surname>
							</persName>
							<affiliation key="aff1">
								<orgName type="department" key="dep1">MRC Clinical Sciences Centre</orgName>
								<orgName type="department" key="dep2">Faculty of Medicine</orgName>
								<orgName type="institution" key="instit1">Imperial College</orgName>
								<orgName type="institution" key="instit2">Hammersmith Hospital Campus</orgName>
								<address>
									<addrLine>Du Cane Road</addrLine>
									<postCode>W12 0NN</postCode>
									<settlement>London</settlement>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Rory</forename>
								<surname>Stark</surname>
							</persName>
							<affiliation key="aff2">
								<orgName type="institution" key="instit1">Cancer Research UK</orgName>
								<orgName type="institution" key="instit2">Cambridge Research Institute</orgName>
								<orgName type="institution" key="instit3">Li Ka Shing Centre</orgName>
								<address>
									<addrLine>Robinson Way</addrLine>
									<postCode>CB2 0RE</postCode>
									<settlement>Cambridge</settlement>
									<country key="GB">UK</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Mike</forename>
								<forename type="middle">L</forename>
								<surname>Smith</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department">Department of Oncology</orgName>
								<orgName type="institution" key="instit1">University of Cambridge</orgName>
								<orgName type="institution" key="instit2">Li Ka Shing Centre</orgName>
								<address>
									<addrLine>Robinson Way</addrLine>
									<postCode>CB2 0RE</postCode>
									<settlement>Cambridge</settlement>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Andy</forename>
								<forename type="middle">G</forename>
								<surname>Lynch</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department">Department of Oncology</orgName>
								<orgName type="institution" key="instit1">University of Cambridge</orgName>
								<orgName type="institution" key="instit2">Li Ka Shing Centre</orgName>
								<address>
									<addrLine>Robinson Way</addrLine>
									<postCode>CB2 0RE</postCode>
									<settlement>Cambridge</settlement>
								</address>
							</affiliation>
						</author>
						<author>
							<persName>
								<forename type="first">Simon</forename>
								<surname>Tavaré</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department">Department of Oncology</orgName>
								<orgName type="institution" key="instit1">University of Cambridge</orgName>
								<orgName type="institution" key="instit2">Li Ka Shing Centre</orgName>
								<address>
									<addrLine>Robinson Way</addrLine>
									<postCode>CB2 0RE</postCode>
									<settlement>Cambridge</settlement>
								</address>
							</affiliation>
						</author>
						<title level="a" type="main">Genome analysis BayesPeak—an R package for analysing ChIP-seq data</title>
					</analytic>
					<monogr>
						<title level="j" type="main">BIOINFORMATICS APPLICATIONS NOTE</title>
						<imprint>
							<biblScope unit="volume">27</biblScope>
							<biblScope unit="issue">5</biblScope>
							<biblScope unit="page" from="713" to="714"/>
							<date type="published" when="2011">2011</date>
						</imprint>
					</monogr>
					<idno type="DOI">10.1093/bioinformatics/btq685</idno>
					<note type="submission">Received on June 24, 2010; revised on December 7, 2010; accepted on December 9, 2010</note>
					<note>[10:16 10/2/2011 Bioinformatics-btq685.tex] Page: 713 713–714 Associate Editor: John Quackenbush Supplementary information: Supplementary data are available at Bioinformatics online.</note>
				</biblStruct>
			</sourceDesc>
		</fileDesc>
		<profileDesc>
			<abstract>
				<p>Motivation: Identification of genomic regions of interest in ChIP-seq data, commonly referred to as peak-calling, aims to find the locations of transcription factor binding sites, modified histones or nucleosomes. The BayesPeak algorithm was developed to model the data structure using Bayesian statistical techniques and was shown to be a reliable method, but did not have a full-genome implementation. Results: In this note we present BayesPeak, an R package for genome-wide peak-calling that provides a flexible implementation of the BayesPeak algorithm and is compatible with downstream BioConductor packages. The BayesPeak package introduces a new method for summarizing posterior probability output, along with methods for handling overfitting and support for parallel processing. We briefly compare the package with other common peak-callers. Availability: Available as part of BioConductor version 2.6. URL:</p>
			</abstract>
		</profileDesc>
	</teiHeader>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1">INTRODUCTION</head><p>Chromatin ImmunoPrecipitation (ChIP) experiments produce short DNA fragments, preferentially selected to identify the locations of protein binding sites, histone modifications or nucleosome positions. In the ChIP-seq protocol, as described in<ref type="bibr" target="#b4">Robertson et al. (2007)</ref>, the 5-end of one strand of each fragment is sequenced, obtaining a 'read', and then aligned to a reference genome. These aligned reads form 'peaks'—localized regions of high read density—along the genome. Determining the locations and magnitudes of these peaks is an active area of research, and a number of tools exist for the so-called 'peak-calling', using a variety of methodologies. The algorithm described in<ref type="bibr" target="#b6">Spyrou et al. (2009)</ref>takes a Bayesian approach to modelling aligned reads from ChIP-seq data. Many peak-callers model read counts with the Poisson distribution, and thus do not allow for the overdispersion seen in practice. BayesPeak addresses this issue by using the negative binomial distribution.Page: 714 713–714<ref type="figure">Fig. 1</ref>. A schematic representation of a hypothetical peak region, with bins labelled by genomic order. Supposing that each bin has an associated PP value above a threshold (by default 0.5), we would merge these six bins into a peak from 1100 to 1450, with an associated PP value as calculated in Section 2.1. are collected. Where two adjacent jobs call the exact same bin, the maximal PP value is used—this is a rare occurrence under default settings.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>J.Cairns et al.</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.1">Merging bins</head><p>Bins from both the 'normal' and 'offset' jobs that are adjacent or overlap are merged to form contiguous peak regions. The PP value of the peak can be calculated from the constituent bins by either naively taking the maximal value, or by using the 'lower bound' method defined as follows: assign the indices 1,...,n to the n bins within the peak, in order of genomic location (as in<ref type="figure">Fig. 1</ref>). Note that bins with adjacent indices overlap. Now let the PP value of bin i be π i , and define q i = 1−π i as the probability of no enrichment in bin i. Let S n be the set of all subsequences of {1,...,n} such that I ∈ S n ⇔ I contains no consecutive integers ⇔ the bins with indices in I do not overlap. Then, for each I ∈ S n , a lower bound for the probability of enrichment in at least one of the original n bins is F(</p><formula>I) = 1− i∈I q i .</formula><p>The 'best' (highest) lower bound for the probability of peak enrichment is therefore the maximum of this quantity,</p><formula>sup I∈Sn F(I) = 1−Q(n), where Q(n) = inf I∈Sn i∈I q i .</formula><p>We can find Q(n) by dynamic programming since, by conditioning on whether i ∈ I, we have Q(i) = min(Q(i−1),q i Q(i−2)). The advantage of using this method over taking the maximum PP value is that it can give an appropriate score to sustained regions of only moderately large PP values, which will be undervalued when taking the maximum. We tested BayesPeak on the NRSF/REST ChIP-seq dataset from (<ref type="bibr" target="#b1">Johnson et al., 2007</ref>), in which a small subset of regions have been experimentally validated, and we compared the findings against other common peak callers.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3">RESULTS</head><p>We present the peak-caller comparison results in the Supplementary Material. BayesPeak demonstrated a competitive sensitivity and specificity on the genome-wide scale and showed a substantial overlap with other peak-callers. The over-fitting correction greatly improved the enrichment for true binding sites in BayesPeak's data, as did subsequent filtering by PP value. In its raw output, BayesPeak returns PP values for each bin and, for each job, the posterior mean of each estimated parameter (excluding half of the draws as burn-in). As of BayesPeak version 1.1.3, MCMC samples of several key parameters are also present, permitting convergence tests such as the Geweke diagnostic in the boa (<ref type="bibr" target="#b5">Smith, 2007</ref>) or coda (<ref type="bibr" target="#b3">Plummer et al., 2010</ref>) packages. Since the summarized output is in RangedData format, this allows direct analysis of the peaks in any downstream package compatible with IRanges (<ref type="bibr" target="#b2">Pages et al., 2010</ref>), including those in BioConductor. For example, ChIPpeakAnno (<ref type="bibr" target="#b8">Zhu et al., 2010</ref>) can annotate the output. We have observed some phenomena that occur with lower quality data. For example, over-fitting can occur as follows: the model assumes that for each job there are both enriched and unenriched states. As such, when there are no peaks in a job or when the peaks are extremely weak, these two states are used to explain the natural variance present in the unenriched background. We identify over-fit jobs from their low λ 1 values (where λ 1 is the expected number of counts in an enriched bin), and from their PP values being spread out over<ref type="bibr">[0,</ref><ref type="bibr">1]</ref>rather than tending to be 0 or 1. BayesPeak supports the identification and removal of jobs that have encountered this effect (Supplementary Table S2 and<ref type="figure">Fig. S1</ref>).</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4">DISCUSSION</head><p>BayesPeak provides a Bayesian analysis, with advantages including allowance for overdispersion in read counts and a competitive genome-wide specificity and sensitivity. By anticipating peak structure, BayesPeak does not call peaks based on sheer numbers of reads without appropriate read formation. Careful selection of job regions may improve the analysis. For example, we can use prior knowledge to partition jobs in a manner that avoids analysing the centromeres and telomeres, which usually contain no reads. This will prevent unnecessary computation, and may also improve results in the surrounding regions. There is scope for adapting the BayesPeak approach to other forms of peak-calling. For example, some histone mark data consist of regions of enrichment containing many peaks and, in BrDU-seq data, peaks are much broader than those in transcription factor data.</p></div><figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_0"><head></head><figDesc>[10:16 10/2/2011 Bioinformatics-btq685.tex]</figDesc></figure>

			<note place="foot">* To whom correspondence should be addressed. The method optionally allows for the inclusion of a control sample, which enables us to mitigate the effect of experimental artefacts where protein binding is absent. Additionally, the algorithm was shown (in Spyrou et al., 2009) to call merged peaks that are narrower than regions identified by other callers and this, along with inference from posterior probabilities, can improve the efficiency of downstream processing, e.g. motif analysis. We present the R package BayesPeak, which uses a modified version of the algorithm in Spyrou et al. (2009) with a flexible genome-wide implementation. As well as providing compatibility with common input formats and downstream analyses, the BayesPeak package adds additional methods for summarizing data, tools for handling overfitting and support for parallel processing. 2 METHODS The BayesPeak package, written in R and C, forms part of the BioConductor release branch since version 2.6 (Gentleman et al., 2004). The implementation of BayesPeak allows it to take advantage of parallel processing, improving its efficiency. We provide optional parallelization support using the multicore package (Urbanek, 2009) for Linux/Mac OS X. BayesPeak can analyse a human genome in under 12 h, when run in parallel on an 8-core 2.5 GHz machine. For a benchmark example in which the treatment and control .bed files totalled 33 million reads (2.3 GB of disk space), BayesPeak required not more than 3 GB of RAM (although larger .bed files require more RAM). R version 2.11.0 or later is required. The BayesPeak software package fits a hidden Markov model (HMM) to the data (aligned reads) as follows: the genome is divided into &apos;jobs&apos;, i.e. short regions on which the algorithm is run independently. By default, jobs are of length 6 Mb (numerical stability may be compromised in larger jobs), and each job region is expanded by 2 Kb in each direction (to allow peaks falling on the boundary between two jobs to be called). Within a job, the region is divided into small bins (each of length 100 bases, by default), and reads are aggregated by the bin in which they start and the strand on which they lie. A two-state HMM is fitted to these aggregate counts. The HMM&apos;s hidden states correspond to enrichment or unenrichment for sites of interest. A hidden state produces two negative binomial emissions, each corresponding to a bin count (one on each strand), with enriched states tending to emit larger values. The HMM is fitted through MCMC techniques that sample from the posterior distributions of the parameters. The analysis is performed a second time on the same job region, but with all bins offset by half their width (the &apos;offset&apos; analysis) as illustrated in Figure 1. Further details can be found in Spyrou et al. (2009). The output of each job is the posterior probability (PP) of each site being enriched. The data are summarized to form the final peaks as follows. All bins with PP values greater than a user-specified threshold (by default, 0.5) © The Author(s) 2011. Published by Oxford University Press. This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (http://creativecommons.org/licenses/ by-nc/2.5), which permits unrestricted non-commercial use, distribution, and reproduction in any medium, provided the original work is properly cited. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>

			<note place="foot" n="714"> at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>
		</body>
		<back>

			<div type="acknowledgement">
<div xmlns="http://www.tei-c.org/ns/1.0"><head>ACKNOWLEDGEMENT</head><p>We are grateful to Dr Jason Carroll's group and Dr Duncan Odom's group for access to test datasets, and to Dr Mark Dunning for beta testing.</p></div>
			</div>

			<div type="references">

				<listBibl>

<biblStruct   xml:id="b0">
	<analytic>
		<title level="a" type="main">Bioconductor: open software development for computational biology and bioinformatics</title>
		<author>
			<persName>
				<forename type="first">R</forename>
				<forename type="middle">C</forename>
				<surname>Gentleman</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Genome Biol</title>
		<imprint>
			<biblScope unit="volume">5</biblScope>
			<biblScope unit="page">80</biblScope>
			<date type="published" when="2004" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b1">
	<analytic>
		<title level="a" type="main">Genome-wide mapping of in vivo protein-DNA interactions</title>
		<author>
			<persName>
				<forename type="first">D</forename>
				<forename type="middle">S</forename>
				<surname>Johnson</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Science</title>
		<imprint>
			<biblScope unit="volume">316</biblScope>
			<biblScope unit="page" from="1497" to="1502" />
			<date type="published" when="2007" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b2">
	<monogr>
		<title level="m" type="main">IRanges: Infrastructure for Manipulating Intervals on Sequences</title>
		<author>
			<persName>
				<forename type="first">H</forename>
				<surname>Pages</surname>
			</persName>
		</author>
		<imprint>
			<date type="published" when="2010" />
		</imprint>
	</monogr>
	<note>R. package version 1.6.6</note>
</biblStruct>

<biblStruct   xml:id="b3">
	<monogr>
		<title level="m" type="main">Coda: Output Analysis and Diagnostics for MCMC. R package version 0</title>
		<author>
			<persName>
				<forename type="first">M</forename>
				<surname>Plummer</surname>
			</persName>
		</author>
		<imprint>
			<date type="published" when="2010" />
			<biblScope unit="page" from="13" to="18" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b4">
	<analytic>
		<title level="a" type="main">Genome-wide profiles of STAT1 DNA association using chromatin immunoprecipitation and massively parallel sequencing</title>
		<author>
			<persName>
				<forename type="first">G</forename>
				<surname>Robertson</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nature Methods</title>
		<imprint>
			<biblScope unit="volume">4</biblScope>
			<biblScope unit="page" from="651" to="657" />
			<date type="published" when="2007" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b5">
	<analytic>
		<title level="a" type="main">boa: An R Package for MCMC output convergence assessment and posterior inference</title>
		<author>
			<persName>
				<forename type="first">B</forename>
				<forename type="middle">J</forename>
				<surname>Smith</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Stat. Softw</title>
		<imprint>
			<biblScope unit="volume">21</biblScope>
			<biblScope unit="page" from="1" to="37" />
			<date type="published" when="2007" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b6">
	<analytic>
		<title level="a" type="main">BayesPeak: Bayesian analysis of ChIP-seq data</title>
		<author>
			<persName>
				<forename type="first">C</forename>
				<surname>Spyrou</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">BMC Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">10</biblScope>
			<biblScope unit="page">299</biblScope>
			<date type="published" when="2009" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b7">
	<monogr>
		<title level="m" type="main">Multicore-parallel processing in R on machines with multiple cores or CPUs version 0</title>
		<author>
			<persName>
				<forename type="first">S</forename>
				<surname>Urbanek</surname>
			</persName>
		</author>
		<imprint>
			<date type="published" when="2009" />
			<biblScope unit="page" from="1" to="4" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b8">
	<analytic>
		<title level="a" type="main">ChIPpeakAnno: a bioconductor package to annotate ChIP-seq and ChIP-chip data</title>
		<author>
			<persName>
				<forename type="first">L</forename>
				<forename type="middle">J</forename>
				<surname>Zhu</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">BMC Bioinformatics</title>
		<imprint>
			<biblScope unit="issue">11</biblScope>
			<biblScope unit="page">237</biblScope>
			<date type="published" when="2010" />
		</imprint>
	</monogr>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>