
<?xml version="1.0" encoding="UTF-8"?>
<TEI xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 /home/joey/Project/grobid/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<encodingDesc>
			<appInfo>
				<application version="0.4.2-SNAPSHOT" ident="GROBID" when="2017-08-10T23:58+0000">
					<ref target="https://github.com/kermitt2/grobid">GROBID - A machine learning software for extracting information from scholarly documents</ref>
				</application>
			</appInfo>
		</encodingDesc>
		<fileDesc>
			<titleStmt>
				<title level="a" type="main">Fast simulation of reconstructed phylogenies under global time-dependent birth–death processes</title>
			</titleStmt>
			<publicationStmt>
				<publisher/>
				<availability status="unknown"><licence/></availability>
				<date type="published" when="2013">2013</date>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author>
							<persName>
								<forename type="first">Sebastian</forename>
								<surname>Hö</surname>
							</persName>
							<affiliation key="aff0">
								<orgName type="department">Department of Mathematics</orgName>
								<orgName type="institution">Stockholm University</orgName>
								<address>
									<addrLine>Krä ftriket Hus 6</addrLine>
									<postCode>S-10691</postCode>
									<settlement>Stockholm</settlement>
									<country key="SE">Sweden</country>
								</address>
							</affiliation>
						</author>
						<title level="a" type="main">Fast simulation of reconstructed phylogenies under global time-dependent birth–death processes</title>
					</analytic>
					<monogr>
						<imprint>
							<biblScope unit="volume">29</biblScope>
							<biblScope unit="issue">11</biblScope>
							<biblScope unit="page" from="1367" to="1374"/>
							<date type="published" when="2013">2013</date>
						</imprint>
					</monogr>
					<idno type="DOI">10.1093/bioinformatics/btt153</idno>
					<note type="submission">Received on October 10, 2012; revised on March 24, 2013; accepted on March 27, 2013</note>
					<note>BIOINFORMATICS ORIGINAL PAPER Associate Editor: David Posada Contact: hoehna@math.su.se Supplementary information: Supplementary data are available at Bioinformatics online.</note>
				</biblStruct>
			</sourceDesc>
		</fileDesc>
		<profileDesc>
			<abstract>
				<p>Motivation: Diversification rates and patterns may be inferred from reconstructed phylogenies. Both the time-dependent and the diversity dependent birth–death process can produce the same observed patterns of diversity over time. To develop and test new models describing the macro-evolutionary process of diversification, generic and fast algorithms to simulate under these models are necessary. Simulations are not only important for testing and developing models but play an influential role in the assessment of model fit. Results: In the present article, I consider as the model a global time-dependent birth–death process where each species has the same rates but rates may vary over time. For this model, I derive the likelihood of the speciation times from a reconstructed phylogenetic tree and show that each speciation event is independent and identically distributed. This fact can be used to simulate efficiently reconstructed phylogenetic trees when conditioning on the number of species, the time of the process or both. I show the usability of the simulation by approximating the posterior predictive distribution of a birth–death process with decreasing diversification rates applied on a published bird phylogeny (family Cettiidae). Availability: The methods described in this manuscript are implemented in the R package TESS, available from the repository CRAN</p>
			</abstract>
		</profileDesc>
	</teiHeader>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1">INTRODUCTION</head><p>The birth–death process is arguably the most commonly used process to model species diversity (<ref type="bibr" target="#b21">Nee, 2006;</ref><ref type="bibr" target="#b33">Ricklefs, 2007</ref>).<ref type="bibr" target="#b22">Nee et al. (1994a)</ref>introduced the birth–death process to estimate diversification rates from reconstructed phylogenetic trees. It was then used to estimate speciation and extinction rates that are constant over time and equal for all species (<ref type="bibr" target="#b39">Yang and Rannala, 1997</ref>). In recent years, the constant equal-rate birth– death process has been extended to time-dependent speciation and extinction rates (<ref type="bibr" target="#b29">Rabosky, 2006;</ref><ref type="bibr" target="#b31">Rabosky and Lovette, 2008;</ref><ref type="bibr" target="#b1">Alfaro et al., 2009;</ref><ref type="bibr" target="#b20">Morlon et al., 2011</ref>); trait-dependent speciation and extinction rates (<ref type="bibr" target="#b18">Maddison et al., 2007;</ref><ref type="bibr" target="#b9">FitzJohn et al., 2009</ref>); and diversity-dependent speciation rates (<ref type="bibr" target="#b7">Etienne et al., 2012</ref>). The models used for parameter inference have become increasingly complex and different models—such as the time-dependent speciation and the diversity-dependent speciation models—can produce almost indistinguishably close fits to observed phylogenetic trees. Thus, studies investigating the different patterns generated by the different models need to be compared. An evident approach is to use simulations under one model and inference under any of the available models. Furthermore, simulations play an important role in investigations of which parameters can be estimated (<ref type="bibr" target="#b28">Quental and Marshall, 2009;</ref><ref type="bibr" target="#b17">Liow et al., 2010</ref>). However, simulating trees has gained less attention and remains a challenge in several situations (<ref type="bibr" target="#b13">Hartmann et al., 2010</ref>). One might be interested in simulating trees under three different conditions when the process starts with a single species at time t 0 ¼ 0: Simulating a tree for a given time t. Simulating a tree for a given number of species n.</p><p>Simulating a tree for a given number of species n that have evolved over time t. Additionally, the conditions can be modified if the process starts with the most recent common ancestor (MRCA), and thus, there are two species at time t 0 ¼ 0 (<ref type="bibr" target="#b37">Stadler, 2011</ref>). I consider the timedependent speciation and extinction rates birth–death process as the model of choice for simulations in this article. This process contains the constant-rate birth–death process as a special case. Simulations under the first condition, a given time t of the process, are straightforward from a theoretical point of view. One only needs to simulate the exponentially distributed waiting times until the next event, either a speciation event or an extinction event, and pick a random species. Nevertheless, implementing this forward simulation might be challenging and inefficient in situation when the rates are not constant and both rates are high. Additionally, there is no available software for simulating reconstructed trees for a given time t when the rates vary continuously. An overview of available software packages for simulating trees under a time-dependent birth–death process is given in Stadler (2011). Simulating phylogenies under models with a non-zero extinction rate is challenging when one is interested in simulating a tree with a fixed number n of extant species (<ref type="bibr" target="#b37">Stadler, 2011</ref>). The general sampling approach (GSA) introduced by<ref type="bibr" target="#b37">Stadler (2011)</ref>in the program TreeSim, is the currently only available approach to simulate trees under the first and second condition. However, TreeSim only implements changes of speciation and extinction rates at specific predefined times. Furthermore, when one chooses a model with high species turnover (the extinction rate being close to the speciation rate), then the GSA takes a long time to terminate because many speciation and extinction events are simulated and the process converges only slowly to the terminating species number. In this article, I will derive the joint probability density of the reconstructed phylogeny using a new approach that shows that each speciation time in the reconstructed tree is independent and identically distributed (iid). I will then develop an algorithm that uses the cumulative distribution function for fast simulation of the reconstructed tree under any—continuous or discrete—timedependent speciation and extinction rate function. I apply this new simulation technique to sample from the posterior predictive distribution of an empirical dataset, the bird family Cettidae.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2">METHODS</head><p>The strategy of the simulation algorithm, developed in the following section, is to derive the probability density of a single speciation event independent of all other speciation events in the reconstructed tree. Once the probability density is known, it is (at least numerically) possible to compute the inverse cumulative distribution function and thus samples from the desired distribution. The simulation procedure only needs to draw n À 1 speciation events for a tree of size n and does not need to draw all speciation events that are pruned because they do not have extant descendants. I will start by defining the birth–death process. The process starts with a single species at time t 0. Every species has the same speciation and extinction rate at any time t, denoted by lðtÞ and ðtÞ, respectively. The time until a speciation event of a given species is exponentially distribution with rate lðtÞ. At a speciation event, a species gives birth to exactly one new species. The time until an extinction event of a given species is exponentially distributed with rate ðtÞ. Furthermore, let N(t) denote the number of species at time t. Following standard notation, I will use t 0 as the time of the origin or start of the process and T as the present time when the process was stopped. The observation of a tree generated by the birth–death process containing extant as well as extinct species is called a complete tree (<ref type="figure" target="#fig_0">Fig. 1a</ref>). Removing all extinct branches gives the reconstructed tree (<ref type="bibr" target="#b23">Nee et al., 1994b</ref>) (<ref type="figure" target="#fig_0">Fig. 1b</ref>). From the reconstructed tree with n extant species, I obtain the set of speciation times ftg ¼ ft 0 ,. .. , t nÀ1 g. In this article, I consider the reconstructed sampled tree as the data. Let me begin with stating some known probability densities of the birth–death process, the probability of survival PðNðTÞ40 j NðtÞ ¼ 1Þ, the probability of exactly one descendant PðNðTÞ ¼ 1 j NðtÞ ¼ 1Þ and the probability of n descendants PðNðTÞ ¼ n j NðtÞ ¼ 1Þ (<ref type="bibr" target="#b16">Kendall, 1948;</ref><ref type="bibr" target="#b38">Thompson, 1975;</ref><ref type="bibr" target="#b23">Nee et al., 1994b;</ref><ref type="bibr" target="#b20">Morlon et al., 2011</ref>). Although I will follow closely<ref type="bibr" target="#b23">Nee et al. (1994b)</ref>, I modified the process to start at time t and stop at time T instead of starting at time 0 and stopping at T À t and thus is a generalization of the original equations in<ref type="bibr" target="#b23">Nee et al. (1994b)</ref>. Finally, I derive the probability density of a single speciation event, following the idea of<ref type="bibr" target="#b38">Thompson (1975)</ref>, by using the above-mentioned probability densities. First, I define the rate function r as rðt, sÞ ¼ Z s t</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>ððzÞ À lðzÞÞdz: ð1Þ</head><p>The probability of a single species alive at time t surviving until time T [PðNðTÞ40 j NðtÞ ¼ 1Þ] is given (<ref type="bibr" target="#b23">Nee et al., 1994b</ref>, Equation 24) by</p><formula>PðNðTÞ40 j NðtÞ ¼ 1Þ ¼ 1 þ Z T t À ðsÞ expðrðt, sÞÞ Á ds ! À1 : ð2Þ</formula><p>The probability of n species at time T when starting with a single species at time t is (<ref type="bibr">Nee et al., 1994b, Equation 3)</ref>PðNðTÞ ¼ n j NðtÞ ¼ 1Þ ¼ ð1 À PðNðTÞ 4 0 j NðtÞ ¼ 1Þ expðrðt, TÞÞÞ nÀ1 Â PðNðTÞ 4 0 j NðtÞ ¼ 1Þ 2 expðrðt, TÞÞ ð3Þ which leads to the probability of obtaining a single lineage at time T PðNðTÞ ¼ 1 j NðtÞ ¼ 1Þ ¼ PðNðTÞ 4 0 j NðtÞ ¼ 1Þ 2 expðrðt, TÞÞ: ð4Þ Equation (3) can be derived from a geometric distribution with parameter PðNðTÞ40 j NðtÞ ¼ 1Þ expðrðt, TÞÞ multiplied by the probability of survival of the process PðNðTÞ40 j NðtÞ ¼ 1Þ. Thus, the probability of n species at time T given that we had 1 species at time t<ref type="bibr">[NðtÞ ¼ 1]</ref>and the species survives, denoted by Sð1, t, TÞ, is PðNðTÞ ¼ n j NðtÞ ¼ 1, Sð1, t, TÞÞ ¼ ð1 À PðNðTÞ40 j NðtÞ ¼ 1Þ expðrðt, TÞÞÞ nÀ1 Â PðNðTÞ40 j NðtÞ ¼ 1Þ expðrðt, TÞÞ:</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>ð5Þ</head><p>Now, following the reasoning of Thompson (1975, p. 54–58), I give the joint probability distribution of all speciation times ftg of the reconstructed tree given that we sample (or stop) the process at time TThe intuitive interpretation of the probability density is that the process starts with one species that survives until the present time<ref type="bibr">[</ref>(6), we can compute the probability of the conditioned process on n lineages at the present time T results P BD ðftg j Nðt 0 Þ ¼ 1, NðTÞ ¼ n, TÞ</p><formula>P BD ðftg j Nðt 0 Þ ¼ 1, TÞ ¼ PðNðTÞ ¼ 1 j Nðt 0 Þ ¼ 1Þ Â Y nÀ1 i À i Â lðt i Þ Â PðNðTÞ ¼ 1 j Nðt i Þ ¼ 1Þ Á ð6Þ (a) ( b)</formula><formula>¼ Y NÀ1 i i Â lðt i Þ Â PðNðTÞ ¼ 1 j Nðt i Þ ¼ 1Þ 1 À PðNðTÞ 4 0 j Nðt 0 Þ ¼ 1Þ expðrðt 0 , TÞÞ ð7Þ</formula><p>Note, the factor i in front of lðt i Þ is simply a combinatorial constant representing the ðn À 1Þ! possible orderings of the speciation events (<ref type="bibr" target="#b0">Aldous and Popovic, 2005</ref>). Hence, the probability density of each single speciation event is iid by the definition of independence P BD ðt j j ftgnft j g, Nðt 0 Þ ¼ 1, NðTÞ ¼ n, TÞ ¼ P BD ðt j j Nðt 0 Þ ¼ 1, NðTÞ ¼ n, TÞ, and have the probability density</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.1">Simulating reconstructed trees for</head><p>a fixed time t and number of species n I will start developing the algorithm for simulating reconstructed trees when conditioning on both—the time of the process t and the number of sampled extant species n—although this might not be the common or natural condition for simulating reconstructed trees. It is, however, used by the two other simulation conditions. Random speciation events are drawn by solving the inverse cumulative distribution function of the speciation times. From Equation (7) we have that the joint probability of all speciation times in the reconstructed tree and established that all speciation times are iid with the probability density given in Equation (8). Thus, to obtain n À 1 speciation times (or n À 2 in the case when starting at the MRCA), one needs to draw n À 1 random draws from the above distribution. Such random draws can be obtained by first drawing a random number u form the Uniform (0,1) distribution. Then, the speciation time t* for which the cumulative distribution function of Equation (8) equals u, gives the randomly drawn speciation time:<ref type="figure">Figure 2</ref>shows an example of how to draw random speciation times in the sampled reconstructed tree. The algorithm how to construct a random from the set of speciation time is given below.</p><formula>u ¼ R tÃ 0 P BD ðtÞdt R T 0 P BD ðtÞdt ¼ R tÃ 0 lðtÞPðNðTÞ ¼ 1 j NðtÞ ¼ 1Þdt R T 0 lðtÞPðNðTÞ ¼ 1 j NðtÞ ¼ 1Þdt ð9Þ</formula></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.2">Simulating reconstructed trees for a fixed time t</head><p>I start by simulating the number of species after the time t. Equation (3) gives the probability of n species at time t. Therefore, one only needs to make a random draw u $ unifð0, 1Þ and find the maximal n for which the cumulative distribution function of Equation (3) is smaller or equal to u:</p><formula>max n u ! X n i¼1 PðNðtÞ ¼ i j Nðt 0 Þ ¼ 1Þ ! ð10Þ</formula><p>Once the number of species is obtained by a random draw, the speciation times can be simulated using the above algorithm conditioning on both, the number of species and the time of the process.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.3">Simulating reconstructed trees</head><p>for a fixed number of species n A tree with a fixed number of extant species can be simulated by first simulating the time of the process T given that the number of species was NðTÞ ¼ n. Let us assume that one draws a random time T with some probability P(T) and maximum value max, then simulates a tree under the birth–death process. A new time T and a new tree are drawn until the tree contains n species at time T. Thus, using Bayes Theorem, the probability of the time of the process (or the time of the origin/MRCA) is</p><formula>PðT j nÞ ¼ PðNðTÞ ¼ n j Nðt 0 Þ ¼ 1, TÞ Â PðTÞ R max 0 PðNðtÞ ¼ n j Nðt 0 Þ ¼ 1, tÞ Â PðtÞdt : ð11Þ</formula><p>If a uniform distribution as the prior distribution on the time of the process is assumed, then the probability P(T) in the numerator cancels out with the probability P(t) in the denominator. However, in the general form, when one wants to specify some informative prior distribution of the time of the process, then the integral needs to be computed numerically. Only a random draw from the distribution given in Equation (11) needs to be obtained and the same algorithm as for conditioning on the number of species and the time of the process can be used.<ref type="figure">Fig. 2</ref>. An example birth–death process with rates of l ¼ 1:0 if t51:0 or t42:0 and l ¼ 0:1 otherwise; ¼ 0:95 if t51:0 or t42:0 and ¼ 0:0 otherwise. Additionally, there is a mass-extinction event at time t ¼ 0:8 with a survival probability of P ¼ 0:2 per species. The algorithm for drawing new speciation times t* draws a random u\simunifð0, 1Þ, and searches the t* for which CDFðt Ã Þ ¼ u</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.4">Starting at the MRCA</head><p>In the previous sections, I only considered the situations when the process starts with Nðt 0 Þ ¼ 1. Now I will give the necessary modifications if one wants to condition on the MRCA. Let the process start with two species and both survive until the present Sð2, t 0 , tÞ, then Equation (5) needs to be modified to condition on two species to start with</p><formula>PðNðtÞ ¼ n j Nðt 0 Þ ¼ 2, Sð2, t 0 , tÞÞ ¼ X nÀ1 i¼1 ðPðNðtÞ ¼ i j Nðt 0 Þ ¼ 1, Sð1, t 0 , tÞÞ Â PðNðtÞ ¼ n À i j Nðt 0 Þ ¼ 1, Sð1, t 0 , tÞÞÞ</formula><p>¼ ðn À 1ÞðPðNðTÞ40 j NðtÞ ¼ 1Þ 2 expðrðt, TÞÞÞ 2 Â ð1 À PðNðTÞ40 j NðtÞ ¼ 1Þ expðrðt, TÞÞÞ nÀ2</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>ð12Þ</head><p>The rationale behind the derivation is that one could consider two independent processes, both starting with one species at time t 0 ¼ 0, and the sum of the species of both processes equals n. The algorithms for simulating reconstructed phylogenies remain unchanged, and only Equation (3) needs to be replaced by Equation (12).</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.5">Reconstruction of a tree from speciation times</head><p>In the previous sections, I only elaborated the methods how to draw the set of speciation times. The reconstructed phylogeny can be created from the set of speciation times by first creating a set of n species. Then, repeatedly join two random species together. The time of the i-th speciation event is the i-th largest speciation time of the previously created set of speciation times. This procedure is closely related to the UPGMA method (<ref type="bibr" target="#b36">Sokal and Michener, 1958;</ref><ref type="bibr" target="#b8">Felsenstein, 2004</ref>). The resulting tree is from the correct distribution because the speciation times are iid and the birth–death process implies a uniform distribution on labeled histories (<ref type="bibr" target="#b0">Aldous and Popovic, 2005</ref>).</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.6">Modeling mass-extinction events and random taxon sampling</head><p>The rate functions have been provided as general functions of time. Following<ref type="bibr" target="#b23">Nee et al. (1994b)</ref>, mass-extinction events are modeled by</p><formula>rðt, sÞ ¼ Z s t ððzÞ À lðzÞÞdz À X tm2ðt, s logð m Þ ð 13Þ</formula><p>where t m is the time and m the survival probability of the m-th massextinction event. Then, the probability of a single species alive at time t surviving until time T [PðNðTÞ40 j NðtÞ ¼ 1Þ] from Equation (2) changes to</p><formula>PðNðTÞ40 j NðtÞ ¼ 1Þ ¼ 1 À Z T t À ðsÞ expðrðt, sÞÞ Á ds À X tm2ðt, s ð m À 1Þ expðrðt, t m ÞÞ 0 @ 1 A À1 ð14Þ</formula><p>Note that here 1 À m represents the extinction probability at the m-th mass-extinction event. Furthermore, random taxon sampling is the same as a mass-extinction event at the present time (<ref type="bibr" target="#b23">Nee et al., 1994b</ref>).</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.7">Implementation and numerical integration</head><p>The methods described to simulate trees are implemented in the R (R Core<ref type="bibr" target="#b32">Team, 2012</ref>) package TESS (Tree Evolution Simulation Software). TESS can handle any type of rate functions and is designed for fast simulation of reconstructed trees. Furthermore, TESS computes the likelihood function [<ref type="bibr">Equation (6)</ref>] conditioned on the time of the process, survival of the process or the time and number of taxa at present.</p><p>The likelihood function can be used for Bayesian and Maximum Likelihood inference, posterior prediction and model testing (see the Supplementary Material). There are no closed form solutions known for the equations presented above. Only for the special cases when the rates are constant, one can compute the probability densities analytically. Nevertheless, R provides several methods for numerical integration. TESS uses the package deSolve (<ref type="bibr" target="#b35">Soetaert et al., 2010</ref>) to perform the numerical integration. If only a single draw or few draws from a distribution are needed, then TESS performs a simple Monte Carlo sampling instead.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3">RESULTS</head><p>In this section, I compare the performance of TESS to TreeSim and show a potential application: posterior prediction of reconstructed phylogenies.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.1">Performance</head><p>One of the major shortcomings of the GSA as implemented in TreeSim is the long computation time, especially in situation when lðtÞ % ðtÞ. Additionally, TreeSim cannot handle continuous increasing or decreasing rate functions but only constant rates in predefined intervals. Thus, I designed a challenging but hopefully interesting function of the rates. The speciation rate lðtÞ ¼ 1:0 for t 2 ½0:0, 0:8, then is increased for a time of rapid radiation as lðtÞ ¼ 2:0 for t 2 ð0:8, 1:0 and switches back to the original rate when t41:0. The extinction rate changes at the same time points. First, the rate is comparably high ðtÞ ¼ 0:95 for t 2 ½0:0, 0:8 and then slows down to ðtÞ ¼ 0:5 for t 2 ð0:8, 1:0 before switching back to the original value as well. Additionally a mass-extinction event occurs at time t ¼ 0:8 and each species survives with probability P ¼ 0:2. The process resembles the situation when the diversity increases only slowly but a high species turnover happens until a mass-extinction event removes most species but also opens new niches, which results into a time of rapid radiation. Furthermore, each extant species was sampled with probability P ¼ 0:5. I ran both R packages on a MacBook Pro with a 2.3 GHz Intel Core i7 using only one core at a time to produce as fair as possible results. Simulations with the given rates where performed for n 2 f10, 20,. .. , 200g species sampled at the present time. For each n, 100 trees were simulated and the median running time was reported (<ref type="figure">Fig. 3</ref>). Note that the distribution of running times is skewed for TreeSim. Therefore, the median is a more stable estimator than the mean but the median is also much lower. TESS outperforms TreeSim up to four orders of magnitude. Furthermore, TESS computation time is mostly independent of the number of species, and the main challenge is to compute the integral of the probability of survival. Additionally, TESS can simulate a batch of trees faster once the integral of the survival probability is precomputed, which is shown in the simulations of 10 000 trees (TESS 10K).</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.2">Posterior prediction</head><p>For each simulated tree, I computed the posterior predictive distribution can be used to assess the fit of the model to the observed data (<ref type="bibr" target="#b10">Gelman et al., 2003</ref>). Posterior predictive tests have the advantage to take the uncertainty in the model parameters into account, if applied an a Bayesian analysis (<ref type="bibr" target="#b5">Bollback, 2002</ref>). If only the point estimate is used, e.g. the maximum likelihood estimate, then it is possible to compute the distribution of number of species at any time t using Equation (3) or the probability of n species in the reconstructed tree at time t given in<ref type="bibr" target="#b22">Nee et al. (1994a)</ref>. Instead, when the uncertainty of the estimated parameters is of interest, an analytical solution is infeasible in most situations because commonly there does not exist a closed form solution for the posterior distribution, as for the model considered in this article. Here I will present an example how simulating reconstructed trees can be used to approximate the posterior predictive distribution and evaluate the fit of the model. If the observed statistic fall outside the 95% confidence interval, then we can reject the model. I used the species tree phylogeny from (<ref type="bibr" target="#b2">Astro¨mAstro¨m et al., 2011</ref>, Additional file 7) containing the bird family Cettiidae.<ref type="bibr" target="#b26">Phillimore and Price (2008)</ref>showed that most bird phylogenesis show patterns of a diversification slowdown. The rate functions with a slowdown in diversification can be modeled by the functions lðtÞ ¼ l 0 þ l 1 expðÀtÞ and ðtÞ ¼. I choose an exponential prior distribution for each parameter with rate 0.1, which is comparably flat but still puts most prior probability on small parameter values and hence on more simple models, i.e. the parameter combination ¼ 0 represents the pure birth model. The likelihood is obtained from Equation (6), starting at the MRCA and conditioned on the survival of both species. The posterior distribution was approximated using a Markov chain Monte Carlo algorithm (<ref type="bibr" target="#b19">Metropolis et al., 1953;</ref><ref type="bibr" target="#b14">Hastings, 1970</ref>). The parameter values were changed using a scaling proposal and each parameter was updated once per iteration. The MCMC was run for 55 000 iterations and the first 5000 iterations were considered as the burnin period. Convergence was assessed using the Geweke test of convergence to same distribution in two parts of the run (<ref type="bibr" target="#b11">Geweke, 1991</ref>). Every 10th sample from the posterior distribution was used to simulated one tree conditioned on the time of the process (<ref type="figure" target="#fig_2">Fig. 4</ref>), number of taxa at the present time and the-statistic (<ref type="bibr" target="#b27">Pybus and Harvey, 2000</ref>). The histograms of the predicted number of taxa and-statistic values indicate that the observed values fall well within the 95% confidence intervals. The observed lineage-through-time (LTT) plot and the posterior predictive LTT plots both show significant decrease in the rate of diversification. More generally, the observed LLT plot falls well within the ranges of posterior predicted LTT curves. This indicates that the model fits the data. However, the large variance in the prediction shows the uncertainty and possibly a different model could fit the data more closely. The MCMC algorithm as well as a basic posterior predictive test is available in TESS. The MCMC algorithm is kept as</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>0.00</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Gamma Statistic</head><p>Posterior Predictive Density x<ref type="figure">Fig. 3</ref>. The birth–death process with the rates of l ¼ 1:0 if t50:8 or t41:0 and l ¼ 2:0 otherwise; ¼ 0:95 if t50:8 or t41:0 and ¼ 0:5 otherwise. Additionally, there is a mass-extinction event at time t ¼ 0:8 with a survival probability of P ¼ 0:2 per species. Trees with n 2 f10, 20,. .. , 200g species were simulated and the computation time was measured. The plot shows the median running time of 100 repetitions of TreeSim for one simulated tree and TESS for 1 and 10 000 trees, respectively general as possible so that any possible model might be used. See the additional file PosteriorPredictionCettiidae.R that was used for this study.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4">DISCUSSION</head><p>In the present article, I only considered simulations of reconstructed phylogenies. Most estimated phylogenies are reconstructed phylogenies because no information about extinct species is available, such as ancient molecular sequences, and only the extant species are included. Nevertheless, phylogenetic trees including some extinct species might provide more information in estimating the time-dependent diversification rates. In these cases, either the GSA or simulating the missing speciation and extinction events following the idea of Bokma (2008) are useful. Another drawback of the GSA is that events—e.g. massextinction events—cannot be specified to happen at a given time before the present when one conditions on the number of species being sampled. In this manuscript, I did not consider these circumstances, although the simulation procedure can be modified to accommodate events at specific times before the present without major difficulties. In this case, the distribution of the time of the origin (or the MRCA) needs to be considered backward in time instead of forward. Finally, once the time of the process is obtained, the simulation of the single speciation events remains unchanged. The simulation algorithm presented here in this article relies on the factorization of the probability density function. Previously, only for the constant-rate birth–death process has such a factorization been known (<ref type="bibr" target="#b39">Yang and Rannala, 1997;</ref><ref type="bibr" target="#b15">Ho¨hnaHo¨hna et al., 2011</ref>). I derived the factorization for the time-dependent birth–death process. Unfortunately, other types of birth–death process, e.g. the diversity-dependent birth–death process (<ref type="bibr" target="#b7">Etienne et al., 2012</ref>) or the protracted speciation process (<ref type="bibr" target="#b7">Etienne and Rosindell, 2012</ref>), do not have a know factorization. Nevertheless, the time-dependent birth–death process might be used to approximate other birth–death processes, such as the diversity-dependent birth–death process (<ref type="bibr" target="#b31">Rabosky and Lovette, 2008</ref>). It is possible to simulate tree using an MCMC algorithm, once the likelihood equations are known. However, if no direct simulation technique from the desired distribution is known, then the MCMC algorithm must start from some arbitrary starting values. Furthermore, samples are random draws from the specified distribution only after the chain has reached its stationary distribution. When the chain has reached its stationarity distribution and how long it takes to do so is a challenge in itself (<ref type="bibr" target="#b10">Gelman et al., 2003</ref>). Thus, direct sampling, as I propose here, is safer, faster and can even be used for starting values of MCMC runs. Several of the more complicated birth–death processes, e.g. containing different rates for different species (<ref type="bibr" target="#b9">FitzJohn et al., 2009</ref>) or heritable extinction rates (<ref type="bibr" target="#b30">Rabosky, 2009</ref>), do not have a known likelihood function. Instead, approximate Bayesian computation (ABC) can be applied to estimate the parameters of interest (<ref type="bibr" target="#b3">Beaumont et al, 2002</ref>) although ABC has been criticized and should be used cautiously (<ref type="bibr" target="#b34">Robert et al, 2011</ref>). The birth–death simulations implemented in TESS rely on the likelihood function, and therefore, neither ABC is necessary nor are these simulations needed for parameter estimation. Nonetheless, the simulation techniques can be used to test the summary statistics used in ABC. Currently, only the number of species at the present time, the time of the origin and the-statistic have been used as summary statistics for ABC under a birth–death model (<ref type="bibr" target="#b30">Rabosky, 2009</ref>). Using TESS, it might be possible to test the performance of these summary statistics and develop new ones.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>APPENDIX A</head><p>I give here a short version of the proof of the joint probability density of all speciation times of a reconstructed tree. First, let me restate the probability of obtaining exactly one species at time T with T4t. At any given time s, t5s5T the number of species could be between one and infinity; however, all but one species must go extinct until time T (<ref type="bibr" target="#b38">Thompson, 1975</ref>):</p><formula>PðNðTÞ ¼ 1 j NðtÞ ¼ 1Þ ¼ X 1 k¼1 k Â PðNðsÞ ¼ k j</formula><formula>0 , t 1 g, ft 1 , t 2 g, ft 1 , t 3 g, ft 2 , t 4 g, ft 2 , Tg, ft 3 , Tg, ft 3 , Tg, ft 4 ,</formula><p>Tg, ft 4 , Tgg. There are two types of branches, those that end at a speciation event and those that end at the sampling time T. The probability density of a branch that ends at the present time is simply the probability of starting with one species and observing exactly one species</p><formula>Pðft i , TgÞ ¼ PðNðTÞ ¼ 1 j Nðt i Þ ¼ 1Þ ð A:2Þ</formula><p>The probability of any other branch starting at time t i and ending at a speciation event at time t j is given by the probability that there were k species at time t j , one of these speciated with probability klðt j Þ, this species survived but all other k À 1 species went extinct before the present time:</p><formula>Pðft i , t j gÞ ¼ X 1 k¼1 k Â lt j Â PðNðt j Þ ¼ k j Nðt i Þ ¼ 1Þ Â ðPðNðTÞ ¼ 0 j Nðt j Þ ¼ 1ÞÞ kÀ1 ðA:3Þ</formula><p>If we multiply the equation by PðNðTÞ ¼ 1 j Nðt j Þ ¼ 1Þ=PðNðTÞ ¼ 1 j Nðt j Þ ¼ 1Þ, we can see that we get exactly Equation (A</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>.1)</head><p>Pðft i , t j gÞ ¼ 1=PðNðTÞ ¼ 1 j Nðt j Þ ¼ 1Þ X 1 k¼1 k Â lðt j Þ Â PðNðt j Þ ¼ k j Nðt i Þ ¼ 1Þ Â ðPðNðTÞ ¼ 0 j Nðt j Þ ¼ 1ÞÞ kÀ1 Â PðNðTÞ ¼ 1 j Nðt j Þ ¼ 1Þ ¼ lðt i Þ Â PðNðTÞ ¼ 1 j Nðt i Þ ¼ 1Þ=PðNðTÞ ¼ 1 j Nðt j Þ ¼ 1Þ ðA:4Þ Finally, by multiplying the probability densities of all branches together, we obtain the probability density of the reconstructed tree</p></div><figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_0"><head>Fig.1.</head><figDesc>Fig. 1. A simulated birth–death tree starting with a single species. (a) The complete tree containing both extant and extinct species. (b) The reconstructed tree containing only extant species</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_1"><head>P</head><figDesc>BD ðtÞ / lðtÞPðNðTÞ ¼ 1 j NðtÞ ¼ 1Þ ð 8Þ This has previously been shown by Yang and Rannala (1997) for constant rates and been exploited by Ho¨hnaHo¨hna et al. (2011) for estimations of model parameters. I will now show how to use these probability distributions to simulate reconstructed trees under the three different conditions.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_2"><head>Fig.4.</head><figDesc>Fig. 4. Posterior predictive draws were obtained by approximating the posterior distribution with an MCMC algorithm and then simulating trees conditioned on the time of the process. For the first 100 trees the LTT curves (left plot), for each tree the number of taxa at present (middle plot), the-statistic (right plot) are plotted. The thin gray lines represent the random draws, and the thicker black line the observed data. The histograms contain the 95% confidence interval (dashed lines) and the observed value marked with 'x'. See the additional file PosteriorPredictionCettiidae.R</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_3"><head></head><figDesc>NðtÞ ¼ 1Þ Â PðNðTÞ ¼ 1 j NðsÞ ¼ 1Þ Â ðPðNðTÞ ¼ 0 j NðsÞ ¼ 1ÞÞ kÀ1 ðA:1Þ The factor k arises because any of the k currently alive species could survive until the present and we need to consider each possibility. Let us transform the reconstructed tree from Figure 1 into a set of branches b ¼ fft</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_4"><head></head><figDesc>The probability density of all branches PðbÞ is equivalent to the probability density of all branching times [Equation (6)].</figDesc></figure>

			<note place="foot">at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>

			<note place="foot">S.Hö hna at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>

			<note place="foot">Fast simulation of reconstructed phylogenies at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from</note>

			<note place="foot" n="5"> CONCLUSION Simulating reconstructed phylogenies is important for developing and testing macro-evolutionary processes but has been a challenge for non-constant birth–death models (Hartmann et al., 2010). In the present manuscript, I present an algorithm that can be used to simulate reconstructed phylogenies when conditioning on the number of species being sampled or the time of the process or both. The presented algorithms can accommodate any time-dependent rate function—continuous and discrete—and can model mass-extinction events as well as periods of rapid radiation. Compared with the currently only available software for these types of simulations, TreeSim, my implementation is four orders of magnitude faster for 200 taxa and does not need significantly more computational time to simulate larger trees. Thus, simulations under even more complex models and many taxa at present are now feasible. I derived the probability density of the sampled reconstructed phylogenetic tree. The derivation follows the ideas of Thompson (1975) and Nee et al. (1994b). The newly derived probability density is provided in a general and new form. It shows that the speciation times are iid, which has previously only been shown for constant rates (Yang and Rannala, 1997). This enables for instance the Diversified Sampling under time-dependent speciation and extinction rates (Ho¨hnaHo¨hna et al., 2011). R is widely used for inferring diversification patterns (Harmon et al., 2008; O&apos;Meara, 2012). It provides a good framework to implement new methods that can be shared and used freely. The methods of this article are implemented in the R package TESS. TESS constructs trees in the phylo format of APE (Paradis et al., 2008). Thus, the trees simulated in TESS can be directly analyzed in APE and other tools using the phylo format. The implementation is kept general so that any time-dependent rate function can be used. Additionally, an implementation of the likelihood computation is provided that can be used either in a maximum likelihood or in a Bayesian inference, as shown in the posterior prediction example.</note>
		</body>
		<back>

			<div type="acknowledgement">
<div xmlns="http://www.tei-c.org/ns/1.0"><head>ACKNOWLEDGEMENTS</head><p>I am very grateful to Fredrik Olsson for countless discussions on several aspects of this and related projects, to Tom Britton and two anonymous reviewers for comments on the manuscripts, Rich FitzJohn for his comments on the manuscript and the R package and the associate editor.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Conflict of Interest: none declared</head></div>
			</div>

			<div type="references">

				<listBibl>

<biblStruct   xml:id="b0">
	<analytic>
		<title level="a" type="main">A critical branching process model for biodiversity</title>
		<author>
			<persName>
				<forename type="first">D</forename>
				<surname>Aldous</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">L</forename>
				<surname>Popovic</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Adv. Appl. Probab</title>
		<imprint>
			<biblScope unit="volume">37</biblScope>
			<biblScope unit="page" from="1094" to="1115" />
			<date type="published" when="2005" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b1">
	<analytic>
		<title level="a" type="main">Nine exceptional radiations plus high turnover explain species diversity in jawed vertebrates</title>
		<author>
			<persName>
				<forename type="first">M</forename>
				<forename type="middle">E</forename>
				<surname>Alfaro</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proc. Natl Acad. Sci</title>
		<meeting>. Natl Acad. Sci</meeting>
		<imprint>
			<date type="published" when="2009" />
			<biblScope unit="page" from="13410" to="13414" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b2">
	<analytic>
		<title level="a" type="main">Non-monophyly and intricate morphological evolution within the avian family Cettiidae revealed by multilocus analysis of a taxonomically densely sampled dataset</title>
		<author>
			<persName>
				<forename type="first">P</forename>
				<surname>Astro¨mastro¨m</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">BMC Evol. Biol</title>
		<imprint>
			<biblScope unit="volume">11</biblScope>
			<biblScope unit="page">352</biblScope>
			<date type="published" when="2011" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b3">
	<analytic>
		<title level="a" type="main">Approximate Bayesian computation in population genetics</title>
		<author>
			<persName>
				<forename type="first">M</forename>
				<forename type="middle">A</forename>
				<surname>Beaumont</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Genetics</title>
		<imprint>
			<biblScope unit="volume">162</biblScope>
			<biblScope unit="page" from="2045" to="2035" />
			<date type="published" when="2002" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b4">
	<analytic>
		<title level="a" type="main">Bayesian estimation of speciation and extinction probabilities from (in) complete phylogenies</title>
		<author>
			<persName>
				<forename type="first">F</forename>
				<surname>Bokma</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Evolution</title>
		<imprint>
			<biblScope unit="volume">62</biblScope>
			<biblScope unit="page" from="2441" to="2445" />
			<date type="published" when="2008" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b5">
	<analytic>
		<title level="a" type="main">Bayesian model adequacy and choice in phylogenetics</title>
		<author>
			<persName>
				<forename type="first">J</forename>
				<forename type="middle">P</forename>
				<surname>Bollback</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Mol. Biol. Evol</title>
		<imprint>
			<biblScope unit="volume">19</biblScope>
			<biblScope unit="page" from="1171" to="1180" />
			<date type="published" when="2002" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b6">
	<analytic>
		<title level="a" type="main">Diversity-dependence brings molecular phylogenies closer to agreement with the fossil record</title>
		<author>
			<persName>
				<forename type="first">R</forename>
				<surname>Etienne</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proc. Natl Acad. Sci</title>
		<meeting>. Natl Acad. Sci</meeting>
		<imprint>
			<date type="published" when="2012" />
			<biblScope unit="page" from="1300" to="1309" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b7">
	<analytic>
		<title level="a" type="main">Prolonging the past counteracts the pull of the present: protracted speciation can explain observed slowdowns in diversification</title>
		<author>
			<persName>
				<forename type="first">R</forename>
				<forename type="middle">S</forename>
				<surname>Etienne</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">J</forename>
				<surname>Rosindell</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Syst. Biol</title>
		<imprint>
			<biblScope unit="volume">61</biblScope>
			<biblScope unit="page" from="204" to="213" />
			<date type="published" when="2012" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b8">
	<analytic>
		<title/>
		<author>
			<persName>
				<forename type="first">J</forename>
				<surname>Felsenstein</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Distance Matrix Methods. Inferring Phylogenies. Sinauer Associates</title>
		<imprint>
			<date type="published" when="2004" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b9">
	<analytic>
		<title level="a" type="main">Estimating trait-dependent speciation and extinction rates from incompletely resolved phylogenies</title>
		<author>
			<persName>
				<forename type="first">R</forename>
				<surname>Fitzjohn</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Syst. Biol</title>
		<imprint>
			<biblScope unit="volume">58</biblScope>
			<biblScope unit="page" from="595" to="611" />
			<date type="published" when="2009" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b10">
	<monogr>
		<title level="m" type="main">Model checking and improvement. In: Bayesian Data analysis</title>
		<author>
			<persName>
				<forename type="first">A</forename>
				<surname>Gelman</surname>
			</persName>
		</author>
		<imprint>
			<date type="published" when="2003" />
			<publisher>Chapman &amp; Hall/CRC</publisher>
			<pubPlace>New York</pubPlace>
		</imprint>
	</monogr>
	<note>2nd. edn</note>
</biblStruct>

<biblStruct   xml:id="b11">
	<monogr>
		<title level="m" type="main">Evaluating the Accuracy of Sampling-Based Approaches to the Calculation of Posterior Moments. Federal Reserve Bank of Minneapolis</title>
		<author>
			<persName>
				<forename type="first">J</forename>
				<surname>Geweke</surname>
			</persName>
		</author>
		<imprint>
			<date type="published" when="1991" />
		</imprint>
	</monogr>
	<note>Research. Department</note>
</biblStruct>

<biblStruct   xml:id="b12">
	<analytic>
		<title level="a" type="main">GEIGER: investigating evolutionary radiations</title>
		<author>
			<persName>
				<forename type="first">L</forename>
				<forename type="middle">J</forename>
				<surname>Harmon</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">24</biblScope>
			<biblScope unit="page" from="129" to="131" />
			<date type="published" when="2008" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b13">
	<analytic>
		<title level="a" type="main">Sampling trees from evolutionary models</title>
		<author>
			<persName>
				<forename type="first">K</forename>
				<surname>Hartmann</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Syst. Biol</title>
		<imprint>
			<biblScope unit="volume">59</biblScope>
			<biblScope unit="page" from="465" to="476" />
			<date type="published" when="2010" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b14">
	<analytic>
		<title level="a" type="main">Monte carlo sampling methods using Markov chains and their applications</title>
		<author>
			<persName>
				<forename type="first">W</forename>
				<forename type="middle">K</forename>
				<surname>Hastings</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Biometrika</title>
		<imprint>
			<biblScope unit="volume">57</biblScope>
			<biblScope unit="page" from="97" to="109" />
			<date type="published" when="1970" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b15">
	<analytic>
		<title level="a" type="main">Inferring speciation and extinction rates under different species sampling schemes</title>
		<author>
			<persName>
				<forename type="first">S</forename>
				<surname>Ho¨hnaho¨hna</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Mol. Biol. Evol</title>
		<imprint>
			<biblScope unit="volume">28</biblScope>
			<biblScope unit="page" from="2577" to="2589" />
			<date type="published" when="2011" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b16">
	<analytic>
		<title level="a" type="main">On the generalized &apos;&apos;Birth-and-Death&apos;&apos; process</title>
		<author>
			<persName>
				<forename type="first">D</forename>
				<forename type="middle">G</forename>
				<surname>Kendall</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Ann. Math. Statist</title>
		<imprint>
			<biblScope unit="volume">19</biblScope>
			<biblScope unit="page" from="1" to="15" />
			<date type="published" when="1948" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b17">
	<analytic>
		<title level="a" type="main">When can decreasing diversification rates be detected with molecular phylogenies and the fossil record?</title>
		<author>
			<persName>
				<forename type="first">L</forename>
				<forename type="middle">H</forename>
				<surname>Liow</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Syst. Biol</title>
		<imprint>
			<biblScope unit="volume">59</biblScope>
			<biblScope unit="page" from="646" to="659" />
			<date type="published" when="2010" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b18">
	<analytic>
		<title level="a" type="main">Estimating a binary character&apos;s effect on speciation and extinction</title>
		<author>
			<persName>
				<forename type="first">W</forename>
				<surname>Maddison</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Syst. Biol</title>
		<imprint>
			<biblScope unit="volume">56</biblScope>
			<biblScope unit="page">701</biblScope>
			<date type="published" when="2007" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b19">
	<analytic>
		<title level="a" type="main">Equation of state calculations by fast computing machines</title>
		<author>
			<persName>
				<forename type="first">N</forename>
				<surname>Metropolis</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Chem. Phys</title>
		<imprint>
			<biblScope unit="volume">21</biblScope>
			<biblScope unit="page" from="1087" to="1092" />
			<date type="published" when="1953" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b20">
	<analytic>
		<title level="a" type="main">Reconciling molecular phylogenies with the fossil record</title>
		<author>
			<persName>
				<forename type="first">H</forename>
				<surname>Morlon</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proc. Natl Acad. Sci</title>
		<meeting>. Natl Acad. Sci</meeting>
		<imprint>
			<date type="published" when="2011" />
			<biblScope unit="page" from="16327" to="16332" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b21">
	<analytic>
		<title level="a" type="main">Birth-death models in macroevolution</title>
		<author>
			<persName>
				<forename type="first">S</forename>
				<surname>Nee</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Ann. Rev. Ecol. Evol. Syst</title>
		<imprint>
			<biblScope unit="volume">37</biblScope>
			<biblScope unit="page" from="1" to="17" />
			<date type="published" when="2006" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b22">
	<analytic>
		<title level="a" type="main">Extinction rates can be estimated from molecular phylogenies</title>
		<author>
			<persName>
				<forename type="first">S</forename>
				<surname>Nee</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Philos. Trans. R. Soc. Lond. B. Biol. Sci</title>
		<imprint>
			<biblScope unit="volume">344</biblScope>
			<biblScope unit="page" from="77" to="82" />
			<date type="published" when="1994" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b23">
	<analytic>
		<title level="a" type="main">The reconstructed evolutionary process</title>
		<author>
			<persName>
				<forename type="first">S</forename>
				<surname>Nee</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Philos. Trans. R. Soc. Lond. B. Biol. Sci</title>
		<imprint>
			<biblScope unit="volume">344</biblScope>
			<biblScope unit="page" from="305" to="311" />
			<date type="published" when="1994" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b24">
	<analytic>
		<title level="a" type="main">Evolutionary Inferences from phylogenies: a review of methods</title>
		<author>
			<persName>
				<forename type="first">O &apos;</forename>
				<surname>Meara</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">B</forename>
				<forename type="middle">C</forename>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Annu. Rev. Ecol. Syst</title>
		<imprint>
			<biblScope unit="volume">43</biblScope>
			<biblScope unit="page" from="267" to="285" />
			<date type="published" when="2012" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b25">
	<analytic>
		<title level="a" type="main">APE: analyses of phylogenetics and evolution in R language</title>
		<author>
			<persName>
				<forename type="first">E</forename>
				<surname>Paradis</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">20</biblScope>
			<biblScope unit="page" from="289" to="290" />
			<date type="published" when="2004" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b26">
	<analytic>
		<title level="a" type="main">Density-dependent cladogenesis in birds</title>
		<author>
			<persName>
				<forename type="first">A</forename>
				<forename type="middle">B</forename>
				<surname>Phillimore</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">T</forename>
				<forename type="middle">D</forename>
				<surname>Price</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Plos Biol</title>
		<imprint>
			<biblScope unit="volume">6</biblScope>
			<biblScope unit="page">71</biblScope>
			<date type="published" when="2008" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b27">
	<analytic>
		<title level="a" type="main">Testing macro–evolutionary models using incomplete molecular phylogenies</title>
		<author>
			<persName>
				<forename type="first">O</forename>
				<forename type="middle">G</forename>
				<surname>Pybus</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">P</forename>
				<forename type="middle">H</forename>
				<surname>Harvey</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Proc. R. Soc. Lond. B Biol. Sci</title>
		<imprint>
			<biblScope unit="volume">267</biblScope>
			<biblScope unit="page" from="2267" to="2272" />
			<date type="published" when="2000" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b28">
	<analytic>
		<title level="a" type="main">Extinction during evolutionary radiations: reconciling the fossil record with molecular phylogenies</title>
		<author>
			<persName>
				<forename type="first">T</forename>
				<forename type="middle">B</forename>
				<surname>Quental</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">C</forename>
				<forename type="middle">R</forename>
				<surname>Marshall</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Evolution</title>
		<imprint>
			<biblScope unit="volume">63</biblScope>
			<biblScope unit="page" from="3158" to="3167" />
			<date type="published" when="2009" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b29">
	<analytic>
		<title level="a" type="main">Likelihood methods for detecting temporal shifts in diversification rates</title>
		<author>
			<persName>
				<forename type="first">D</forename>
				<surname>Rabosky</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Evolution</title>
		<imprint>
			<biblScope unit="volume">60</biblScope>
			<biblScope unit="page" from="1152" to="1164" />
			<date type="published" when="2006" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b30">
	<analytic>
		<title level="a" type="main">Heritability of extinction rates links diversification patterns in molecular phylogenies and fossils</title>
		<author>
			<persName>
				<forename type="first">D</forename>
				<forename type="middle">L</forename>
				<surname>Rabosky</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Syst. Biol</title>
		<imprint>
			<biblScope unit="volume">58</biblScope>
			<biblScope unit="page" from="629" to="640" />
			<date type="published" when="2009" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b31">
	<monogr>
		<title level="m" type="main">Explosive evolutionary radiations: decreasing speciation or increasing extinction through time? Evolution</title>
		<author>
			<persName>
				<forename type="first">D</forename>
				<surname>Rabosky</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">I</forename>
				<surname>Lovette</surname>
			</persName>
		</author>
		<imprint>
			<date type="published" when="2008" />
			<biblScope unit="page" from="1866" to="1875" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b32">
	<monogr>
		<title level="m" type="main">R: A Language and Environment for Statistical Computing. R Foundation for Statistical Computing</title>
		<author>
			<persName>
				<forename type="first">R</forename>
				<surname>Core Team</surname>
			</persName>
		</author>
		<imprint>
			<date type="published" when="2012-04-18" />
			<pubPlace>Vienna, Austria</pubPlace>
		</imprint>
	</monogr>
	<note>date. last accessed</note>
</biblStruct>

<biblStruct   xml:id="b33">
	<analytic>
		<title level="a" type="main">Estimating diversification rates from phylogenetic information</title>
		<author>
			<persName>
				<forename type="first">R</forename>
				<surname>Ricklefs</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Trends Ecol. Evol</title>
		<imprint>
			<biblScope unit="volume">22</biblScope>
			<biblScope unit="page" from="601" to="610" />
			<date type="published" when="2007" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b34">
	<analytic>
		<title level="a" type="main">Lack of confidence in approximate Bayesian computation model choice</title>
		<author>
			<persName>
				<forename type="first">C</forename>
				<forename type="middle">P</forename>
				<surname>Robert</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proc. Natl Acad. Sci</title>
		<meeting>. Natl Acad. Sci</meeting>
		<imprint>
			<date type="published" when="2011" />
			<biblScope unit="page" from="15112" to="15117" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b35">
	<analytic>
		<title level="a" type="main">Solving differential equations in R: Package deSolve</title>
		<author>
			<persName>
				<forename type="first">K</forename>
				<surname>Soetaert</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Stat. Softw</title>
		<imprint>
			<biblScope unit="volume">33</biblScope>
			<biblScope unit="page" from="1" to="25" />
			<date type="published" when="2010" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b36">
	<analytic>
		<title level="a" type="main">A statistical method for evaluating systems relationships</title>
		<author>
			<persName>
				<forename type="first">R</forename>
				<surname>Sokal</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">C</forename>
				<surname>Michener</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Univ. of Kans. Sci. Bull</title>
		<imprint>
			<biblScope unit="volume">38</biblScope>
			<biblScope unit="page" from="1409" to="1438" />
			<date type="published" when="1958" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b37">
	<analytic>
		<title level="a" type="main">Simulating trees with a fixed number of extant species</title>
		<author>
			<persName>
				<forename type="first">T</forename>
				<surname>Stadler</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Syst. Biol</title>
		<imprint>
			<biblScope unit="volume">60</biblScope>
			<biblScope unit="page" from="676" to="684" />
			<date type="published" when="2011" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b38">
	<monogr>
		<title level="m" type="main">The Likelihood Approach. Human Evolutionary Trees</title>
		<author>
			<persName>
				<forename type="first">E</forename>
				<surname>Thompson</surname>
			</persName>
		</author>
		<imprint>
			<date type="published" when="1975" />
			<publisher>Cambridge University Press</publisher>
			<pubPlace>Cambridge</pubPlace>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct   xml:id="b39">
	<analytic>
		<title level="a" type="main">Bayesian phylogenetic inference using DNA sequences: a Markov Chain Monte Carlo method</title>
		<author>
			<persName>
				<forename type="first">Z</forename>
				<surname>Yang</surname>
			</persName>
		</author>
		<author>
			<persName>
				<forename type="first">B</forename>
				<surname>Rannala</surname>
			</persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Mol. Biol. Evol</title>
		<imprint>
			<biblScope unit="volume">14</biblScope>
			<biblScope unit="page" from="717" to="724" />
			<date type="published" when="1997" />
		</imprint>
	</monogr>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>