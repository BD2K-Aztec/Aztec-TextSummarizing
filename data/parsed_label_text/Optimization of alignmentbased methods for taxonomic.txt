Motivation: Alignment-based taxonomic binning for metagenome characterization proceeds in two steps: reads mapping against a reference database (RDB) and taxonomic assignment according to the best hits. Beyond the sequencing technology and the completeness of the RDB, selecting the optimal configuration of the workflow, in particular the mapper parameters and the best hit selection threshold, to get the highest binning performance remains quite empirical. Results: We developed a statistical framework to perform such optimization at a minimal computational cost. Using an optimization experimental design and simulated datasets for three sequenc-ing technologies, we built accurate prediction models for five performance indicators and then derived the parameter configuration providing the optimal performance. Whatever the mapper and the dataset, we observed that the optimal configuration yielded better performance than the default configuration and that the best hit selection threshold had a large impact on performance. Finally, on a reference dataset from the Human Microbiome Project, we confirmed that the optimized configuration increased the performance compared with the default configuration. Availability and implementation: Not applicable.
IntroductionMetagenomics is the study of the DNA content of a sample particularly powerful to recover complex mix of organisms, including those difficult to isolate by standard techniques (). In the last decade, the advent of next generation sequencing (NGS) technologies has quickly shifted metagenomics approaches from low-scale studies to large-scale investigations, thereby creating a need for improvement and development of specific bioinformatic methods. Taxonomic profiling and taxonomic binning are popular methods to assess the taxonomic diversity of a sequenced sample (). Taxonomic profiling methods aim to estimate the relative abundance of each taxon in the sample by classifying reads using a set of marker-genes specific to each taxonomic clade () or based on their k-mer composition (). Taxonomic binning methods aim to assign each individual read to a given taxon within the microbial taxonomy. They are not as fast as taxonomic profiling methods to generate a taxonomic profile. Nevertheless reads binning is a mandatory step for subsequent analysis that require draft genome reconstruction (). Taxonomic binning algorithms are based either on read alignment strategies or on compositional approaches (such as nucleotide k-mer frequencies), or possibly on a mixture of these two approaches(). In this article, we focused on alignment-based taxonomic binning methods, whose principle was introduced by. Such methods proceed generally in two steps. First, reads are aligned against a reference database (RDB). Then, for each read, the lowest common ancestor (LCA) among the best hits is retrieved. To this end, a threshold is applied to select only hits whose scores lie within a percentage of the best hit score. Several evaluation studies have been published that compare mapper performance for resequencing applications (). However, in the context of taxonomic binning, there is still no consensus on which mapper and configuration to use. The most comprehensive study to date was performed in the context of the Human Microbiome Project (HMP), wherecompared six mappers and optimized the parameters for the best mapper, CLC (CLCbio website: http://www.clcbio.com), by testing six combinations of two parameter values. Beyond the NGS technology (e.g. read length, sequencing error profile) and the completeness of the RDB, taxonomic binning performance depends on the mapper configuration and the taxonomic assignment strategy. Mappers can have many parameters (e.g. more than 15 alignment and score parameters for Bowtie2), some being numerical and other categorical (often with many levels). It is nearly impossible to evaluate the performance of all parameter configurations to identify the best one. Here, we present a statistical framework to efficiently select the optimal configuration (mapper parameters and best hit threshold for LCA calculation) which maximizes taxonomic binning performance for a given NGS technology and level of RDB completeness. We relied on the design of experiments (DOE) methodology (NIST/SEMATECH e-Handbook of Statistical Methods, http://www.itl.nist.gov/div898/handbook/, 2015-07-14) to reduce the number of configurations to run while still efficiently analyzing the parameter space. This optimization strategy could be adapted to any NGS technology, applied to different mappers and adjusted according to the targeted microbial complexity and distinct levels of the RDB completeness.