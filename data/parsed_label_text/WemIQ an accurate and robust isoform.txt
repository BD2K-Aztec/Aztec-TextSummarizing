Motivation: The deconvolution of isoform expression from RNA-seq remains challenging because of non-uniform read sampling and subtle differences among isoforms. Results: We present a weighted-log-likelihood expectation maximization method on isoform quan-tification (WemIQ). WemIQ integrates an effective bias removal with a weighted expectation maxi-mization (EM) algorithm to distribute reads among isoforms efficiently. The weight represents the oversampling or undersampling of sequence reads and is estimated through a generalized Poisson model without any presumption on the bias sources and formats. WemIQ significantly improves the quantification of isoform and gene expression as well as the derived exon inclusion rates. It provides robust expression estimates across different laboratories and protocols, which is valuable for the integrative analysis of RNA-seq. For the recent single-cell RNA-seq data, WemIQ also provides the opportunity to distinguish bias heterogeneity from true biological heterogeneity and uncovers smaller cell-to-cell expression variability. Availability and implementation: WemIQ can be downloaded from
IntroductionThe rapid advances in high-throughput sequencing technologies provide us an opportunity to dissect transcriptomes with unprecedented resolution (). Based on RNA-seq studies, alternative splicing has become more and more appreciated as a key mechanism in higher eukaryotes to expand transcriptomes by generating multiple isoforms from a single gene (). For example, it has been reported that up to 95% of human multi-exon genes undergo alternative splicing (). Therefore, an accurate quantification of transcript isoforms is important to understand gene regulation through alternative splicing. However, the accurate estimation of transcript isoform expression from RNA-seq data remains a challenge. Many state-of-the-art approaches initially assumed that short sequence reads in RNA-seq were uniformly sampled from each transcript. However, the position-level read count often demonstrates larger variation than expected under the uniform sampling assumption (), and shows enormous inter-gene and intra-gene bias heterogeneity. As a result, read counts need to be adjusted in a dynamic way for the abundance quantification. Add-on functions have been introduced to handle the overdispersion in the methods of isoform expression estimation (). These methods usually assumed a constant bias factor for each relative position of genes or simply corrected the sequence-specific bias caused by random hexamer priming.However, the overall bias is complicated and caused by multiple factors including many unknown ones, and the bias pattern can vary significantly across different regions and different protocols (). In light of these facts, previously we proposed to use the generalized Poisson (GP) model to estimate the bias in a data-adaptive way without any presumption (). However, this has not yet been integrated into the isoform expression deconvolution. In this article, we propose a robust isoform-expression quantification method: Weighted-log-likelihood expectation maximization Isoform Quantification (WemIQ). Given gene annotation, WemIQ can accurately quantify RNA products at both the gene and transcript isoform level from RNA-seq data. WemIQ uses the expectation maximization (EM) strategy to distribute reads among different isoforms and incorporates the fragment length information of paired-end reads. More importantly, bias in RNA-seq is corrected by assigning different weights to reads from different gene regions when calculating the weighted log-likelihood. The weighted-loglikelihood approach enables efficient isoform expression deconvolution with appropriate bias removal. To demonstrate the effectiveness of our method, we applied WemIQ to both simulated and real data sets. Simulation studies show that, in both transcript-isoform-centric and exon-centric quantification, our approach significantly outperforms the state-of-theart software, such as Cufflinks (), RSEM () and SpliceTrap (). Cufflinks and RSEM quantify isoform expression, while SpliceTrap quantifies exon inclusion rates in an exon-centric way. Unlike other simulation studies which generated reads based on the uniform assumption () or based on a pipeline in consideration of only a few bias factors (), our simulations generated reads with various bias patterns to mimic the real situation. Analyses on a variety of real RNA-seq data sets also show that our bias correction is more effective; our expression quantification is more accurate; and the expression estimates are more robust across different laboratories and different protocols. For the application to the recent single-cell RNA-seq data, interestingly, we found that compared with population-cell RNA-seq, single-cell RNA-seq usually exhibits a larger bias variation across different genes or different regions of the same gene, and WemIQ meets the challenges by separating bias heterogeneity from true biological heterogeneity by obtaining smaller but still significant cell-to-cell variability.
DiscussionSequencing bias during RNA-seq experiments hinders the deconvolution of transcript isoform expression, because the expression heterogeneity caused by multiple isoforms of the same gene is mixed with that caused by different biases for different regions. Hence, isoform-level expression estimation from RNA-seq experiments is still a challenging problem and lines of methods were proposed for more accurate quantification (). We previously developed a hierarchical Bayesian model (BASIS) to identify differentially isoforms without quantifying the absolute isoform expression for each condition (). However, the estimation of the absolute expression levels of transcript isoforms requires a more delicate handling of bias in RNA-seq. Our GP-based model can effectively separate bias from true expression signals (. However, the simple integration of the GP probability mass function to the isoform deconvolution makes the computation infeasible. WemIQ targets the challenges of accurate isoform quantification by an efficient weighted-log-likelihood-based EM algorithm. Reads from different genomic regions were assigned with different weights according to the degree of the sequencing bias. The bias parameter was estimated in a data-adaptive manner without any assumption about the bias source and format. The weight assignment can be treated as a 'weighted sampling' scheme to penalize or compensate oversampled or undersampled sequence reads. Simulation studies with simple and real gene structures demonstrated that WemIQ significantly improved the expression estimation from both the isoform-centric and the exon-centric perspectives under a variety of gene structures. WemIQ can handle the additional overdispersion caused by missing transcripts and thus provides more robust estimations over Cufflinks and RSEM when gene annotation is incomplete. Besides, we compared the overall gene expression levels with other platforms such as the qRT-PCR results and WemIQ showed an improved estimation. It is worth mentioning that although qRT-PCR may not perfectly measure gene expression, it represents another independent platform with potentially different bias sources. Due to the lack of benchmark dataset, it is difficult to directly compare the isoform expression measurements. In addition to the improved estimation accuracy, WemIQ also provides very robust estimates based on the study of sub-sampled reads from a real RNA-seq data set (details in Section 7 of Supplementary Text S1, Supplementary Figs S12 and S13). On the other hand, we should note that there may be some extreme gene structures with many isoforms and each of them containing only a few nucleotide differences. The power of isoform quantification for these cases is limited, Cufflinks and RSEM, the CV across 18 single-cell RNA-seq data is calculated and their empirical cumulative distribution functions are shown for A: 991 highly expressed genes; and B: 907 highly expressed isoforms and waits for more advanced sequencing technologies with more and longer sequence reads. We also applied our method on a variety of real RNA-seq data, including the ENCODE data from different laboratories and singlecell sequencing data with very low input genetic materials. Results demonstrate that WemIQ provides more robust expression estimation at both the gene and isoform level. Therefore, WemIQ may serve as a powerful tool to make direct comparison across different experiments. We also note that in the cross-laboratory comparison, the median fold change was still higher than the ideal value of 1.0 and could be as large as 1.735 even for highly expressed genes or isoforms. Since we simply used the total bias-corrected reads to perform the normalization across samples, additional improvements on the normalization may further help the cross-laboratory analysis of RNA-seq data. In addition, we observed larger bias heterogeneity from single-cell RNA-seq data than the population-cell RNA-seq, which further complicated the exploration of true cell-to-cell expression variation. Due to the careful read weighting scheme, WemIQ discovered smaller expression variability in single cells. WemIQ utilizes only reads that are uniquely mapped to the genome for the expression quantification. For earlier RNA-seq data where the read length is usually 36 nucleotides or less, it might be an issue to discard reads mapped to multiple genomic locations. However, with the development of sequencing technologies for longer reads, the effect of discarding multireads could be small for majority genes. In summary, we propose WemIQ to quantify gene expression from the RNA-seq data with the transcript isoform resolution. It separates sequencing bias heterogeneity across different genomic regions or different laboratories from expression heterogeneity due to different transcript isoforms or different single cells. WemIQ can serve as a powerful quantification tool for transcriptomics.