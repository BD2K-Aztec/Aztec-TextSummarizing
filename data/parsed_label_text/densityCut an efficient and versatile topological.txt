Motivation: Many biological data processing problems can be formalized as clustering problems to partition data points into sensible and biologically interpretable groups. Results: This article introduces densityCut, a novel density-based clustering algorithm, which is both time-and space-efficient and proceeds as follows: densityCut first roughly estimates the densities of data points from a K-nearest neighbour graph and then refines the densities via a random walk. A cluster consists of points falling into the basin of attraction of an estimated mode of the underlining density function. A post-processing step merges clusters and generates a hierarchical cluster tree. The number of clusters is selected from the most stable clustering in the hierarchical cluster tree. Experimental results on ten synthetic benchmark datasets and two microarray gene expression datasets demonstrate that densityCut performs better than state-of-the-art algorithms for clustering biological datasets. For applications, we focus on the recent cancer mutation clustering and single cell data analyses, namely to cluster variant allele frequencies of somatic mutations to reveal clonal architectures of individual tumours, to cluster single-cell gene expression data to uncover cell population compositions, and to cluster single-cell mass cytometry data to detect communities of cells of the same functional states or types. densityCut performs better than competing algorithms and is scalable to large datasets. Availability and Implementation: Data and the densityCut R package is available from https://bit bucket.org/jerry00/densitycut_dev. Contact:
IntroductionClustering analysis (unsupervised machine learning), which organizes data points into sensible and meaningful groups, has been increasingly used in the analysis of high-throughput biological datasets. For example, The Cancer Genome Atlas project has generated multiple omics data for individual patients. One can cluster the omics data of individuals into subgroups of potential clinical relevance. To study clonal evolution in individual cancer patients, we can cluster variant allele frequencies of somatic mutations, such that mutations in the same cluster are accumulated during a specific stage of clonal expansion. Emerging technologies such as single-cell sequencing have made it possible to cluster single-cell gene expression data to detect rare cell populations, or to reveal lineage relationships (). One can cluster single-cell mass cytometry data to study intratumour heterogeneity (). As measurement technology advances have drastically enhanced our abilities to generate various high-throughput datasets, there is a great need to develop efficient and robust clustering algorithms to analyze large N (number of data points), large D (dimensions of data) datasets, with the ability to detect arbitrary shape clusters and automatically determine the number of clusters. The difficulties of clustering analysis lie in part with the definition of a cluster. Of the numerous proposed clustering algorithms, the density-based clustering algorithms () are appealing because of the probabilistic interpretation of a cluster generated by these algorithms. Let D  fx i g N i1 ; x i 2 R D be drawn from an unknown density function f x; x 2 X  R D. For model-based approaches such as Gaussian mixture models f x  P C c1 p c N xjl c ; R c , a cluster is considered as the points generated from a mixture component, and the clustering problem is to estimate the parameters of the density function from D (). To analyze datasets consisting of complex shape clusters, nonparametric methods such as kernel density estimation can be used to estimate b f x  P N i1 K h x; x i , where K h  is the kernel function with bandwidth h. Here, a cluster is defined as the data points associated with a 'mode' of the density function f x (). The widely used 'mean-shift' algorithm () belongs to this category, and it locates the modes of the kernel density function b f x by iteratively moving a point along the density gradient until convergence. This algorithm, however, is computationally expensive, having time complexity ON 2 T, where T is the number of iterations, typically dozens of iterations are sufficient for most cases. A more efficient, non-iterative graph-based approach () constructs trees such that each data point x i represents a node of a tree, the parent of node x i is a point x j which is in the direction closest to the gradient direction r b f x i , and the root of a tree corresponds to a mode of b f x. Then each tree constitutes a cluster. This algorithm has been used to reduce the time complexity of the mean-shift algorithm to ON 2  (), and has been extended in several ways, e.g. constructing trees after filtering out noisy modes (). Nonparametric clustering methods have been generalized to produce a hierarchical cluster tree (). Consider the k level set of a density function f(x): Lk; f x  fxjf x ! kg:The 'high level clusters' at level k are the connected components of Lk; f x (in the topological sense, the maximal connected subsets of Lk; f x). As k goes from 0 to maxf x, the high level clusters at all levels constitute the level set tree, where the leaves of the tree correspond to the modes of f x (). The widely used DBSCAN algorithm () extracts the high level clusters at just one given level k. Many original approaches for level set tree construction in statistics () take the straightforward 'plug-in' approach to estimating the level set tree from b f x by partitioning the feature space, i.e. X. Therefore, they are computationally demanding, especially for high-dimensional data. Recently, efficient algorithms have been proposed to partition the samples D directly (). Recovering the level set tree from a finite dataset is more difficult than partitioning the dataset into separate clusters. Correspondingly, theoretical analyses show that for these algorithms to identify salient clusters from finite samples, the number of data points N needs to grow exponentially in the dimension D (). Moreover, although the level set tree provides a more informative description of the structure of the data, many applications still need the cluster membership of each data point, which is not available directly from the level set tree. The spectral clustering algorithm () works on an N by N pairwise data similarity matrix S, where each element S i;j measures the similarity between x i and x j. The similarity matrix can be considered as the adjacency matrix of a weighted graph G  V; E, where vertex v i represents x i and the edge weight E i;j  S i;j. Given the number of clusters C, the spectral clustering algorithm partitions the graph G into C disjoint, approximately equal size clusters, such that the points in the same cluster are 'similar', while points in different clusters are 'dissimilar'. In contrast to density-based methods, the spectral clustering algorithm does not make assumptions on the probabilistic model which generates data D (). Therefore, selecting the number of clusters is a challenging problem for spectral clustering algorithms, especially in the presence of outliers or when the number of clusters is large. In addition, the spectral clustering algorithm is time-consuming because it needs to compute the eigenvalues and eigenvectors of the row-normalized similarity matrix S, requiring H N 3  time. Instead of using single value decomposition to calculate the eigenvalues and eigenvectors, the power iteration clustering algorithm (PIC) () iteratively smoothes a random initial vector by the row-normalized similarity matrix, such that the points in the same cluster will be similar in value. Then the k-means algorithm is used to partition the smoothed vector into C clusters. Although PIC has a time complexity of ON 2 T, where T is the number of iterations, PIC may encounter many difficulties in practice. First, the points from two quite distinct clusters may have very similar 'smoothed' densities, and therefore they may not be distinguishable by k-means. Second, the points in a non-convex shape cluster can break into several clusters. As the number of clusters increases, these problems become more severe (). In this article, we introduce a simple and efficient clustering algorithm, densityCut, which shares some advantages of both densitybased clustering algorithms and spectral clustering algorithms. As for spectral clustering algorithms, densityCut works on a similarity matrix; thus it is computationally efficient, even for high-dimensional data. Using a sparse K-nearest neighbour graph further reduced the time complexity. Besides, we can use a random walk on the K-nearest neighbour graph to estimate densities at each point. As for many density-based clustering algorithms, densityCut is simple, efficient, and there is no need to specify the number of clusters as an input. Moreover, densityCut inherits both methods' advantage of detecting arbitrarily shaped clusters. Finally, densityCut offers a novel way to build a hierarchical cluster tree and to select the most stable clustering. We first benchmark densityCut against widely used ten simulation datasets and two microarray gene expression datasets to demonstrate its robustness. We then use densityCut to cluster variant allele frequencies of somatic mutations to infer clonal architectures in tumours, to cluster single-cell gene expression data to uncover cell population compositions, and to cluster single-cell mass cytometry data to detect communities of cells of the same functional states or types.