Motivation: Homology search methods are dominated by the central paradigm that sequence similarity is a proxy for common ancestry and, by extension, functional similarity. For determining sequence similarity in proteins, most widely used methods use models of sequence evolution and compare amino-acid strings in search for conserved linear stretches. Probabilistic models or sequence profiles capture the position-specific variation in an alignment of homologous sequences and can identify conserved motifs or domains. While profile based search methods are generally more accurate than simple sequence comparison methods, they tend to be computationally more demanding. In recent years, several methods have emerged that perform protein similarity searches based on domain composition. However, few methods have considered the linear arrangements of domains when conducting similarity searches, despite strong evidence that domain order can harbour considerable functional and evolutionary signal. Results: Here, we introduce an alignment scheme that uses a classical dynamic programming approach to the global alignment of domains. We illustrate that representing proteins as strings of domains (domain arrangements) and comparing these strings globally allows for a both fast and sensitive homology search. Further, we demonstrate that the presented methods complement existing methods by finding similar proteins missed by popular amino-acid–based comparison methods. Availability: An implementation of the presented algorithms, a web-based interface as well as a command-line program for batch searching against the UniProt database can be found at http://rads. uni-muenster.de. Furthermore, we provide a JAVA API for program-matic access to domain-string–based search methods.
INTRODUCTIONAccurate identification of sequence similarity is a crucial and integral part of modern biological analysis. Sequence similarity is often used to infer functional similarity when comparing an unknown protein sequence to a set of well described sequences and can be the result of conservation or convergent evolution. Homologous sequences are often identified by comparing a query sequence with a large collection of sequences (subjects) in public databases. In such comparisons, a pairwise alignment attempts to match the homologous characters (nucleotides or amino-acid residues) of query and subject sequences according to an evolutionary model. Pairwise alignments can be evaluated in terms of similarity or distance scores (). Furthermore, the probability to obtain an identical or better score by chance alone is computed () and a threshold is chosen to accept or reject potential homology. Given an underlying evolutionary model, calculating the optimal pairwise alignment is possible () but computationally demanding. Therefore, many similarity searches use heuristic approaches.shows an overview of the main methods used for sequence homology search. Local alignment algorithms such as BLAST () focus on conserved regions only, and hence do not enforce an alignment of entire sequences. This approach has advantages in finding homology. First, homologous proteins can have regions that are not similar, for example, if these regions have not been under selectional constraints or are fast-evolving. Second, proteins often have regions of local similarity, which correspond to protein domains. Finally, heuristics are much faster because only stretches of local similarities are considered (). However, using local alignments also bears drawbacks. The most obvious drawback is that multi-domain proteins that share one domain may exhibit a high degree of local similarity, which can mask an overall low degree of global similarity (). Ergo, applying a local alignment approach for finding functional homologs may be misleading. In contrast, global similarity suffers the opposite extreme: remote homologs of a query can be missed owing to the low amount of global sequence similarity. To address these problems, the protein's domain composition or domain arrangement (i.e. the N to C terminal order of domains) can be taken into account (). Protein domains are the units of protein structure, function and evolution *To whom correspondence should be addressed. yThe authors wish it to be known that, in their opinion, the first two authors should be regarded as joint First Authors. zPresent address: Architecture et Fonction des MacromoleculesMacromolecules Biologiques, Aix-Marseille Universite,Universite, CNRS UMR 7257, 162 av. de Luminy, 13288 Marseille, France.  Present address: Department of Biology II, University of MunichMunich (LMU), Grosshaderner Str. 2, 82152 Planegg-Martinsried, Germany.for a review]. Tools that consider domains to find functionally similar, or even homologous, proteins, do exist. For example, CDART () measures similarity by considering the number of domains shared between two proteins. CDART does not consider the order of domains, the number of repeats or the non-shared domains when determining similar proteins; in essence, CDART treats proteins as a 'bag of domains'. Several approaches have been developed that attempt to circumvent the problems with local similarity, which modern search and alignment algorithms face.defined local sequence similarity scores with the analysis of a local neighbour similarity network into a 'Neighbourhood Correlation Score', thus extending the local similarity score to include a global perspective.defined a similarity measure between proteins as the weighted average of three similarity scores, which consider the number of shared domains and the number of domains that are specific for one protein, domain duplications and the local order of domains (incidence of ordered domain pairs). A similar approach is used by DAhunter and WDAC, which also incorporates domain versatility and domain frequency into the search for similar domain arrangements (). Bjorklunddefined the domain distance, a protein distance measure based on the number of domains that are not matched between two proteins. In essence, the domain distance is an edit distance as it measures the number of edit operations (domain additions or deletions) needed to move from one arrangement to another. In addition to similarity search, domain-based approaches have been also used for protein clustering [e.g.. The DomainTeams tool, for example, analyses domainwise local similarities (microsyntenies) on bacterial chromosomes, irrespective of gene boundaries. By using microsyntenies, DomainTeams is able to detect clusters of orthologous genes even if domain arrangements are variable (). Several approaches demonstrated that domain content can be used to reconstruct phylogenies (). Furthermore, beyond domain content, the order of domains in a protein can help elucidate functional and structural constraints (). While aforementioned domain-based algorithms are promising, to date none takes advantage of such a context-based analysis, i.e. the knowledge that the linear combinations of domains bear a strong phylogenetic and functional signal. Here, we present two algorithms for finding homologous proteins that exploit this signal of conserved domain arrangements. The first algorithm, RADS (Rapid Alignment of Domain Strings), represents proteins as domain arrangements and does not require any sequence information. The similarity between two proteins is determined by aligning the proteins' domain arrangements to each other using a dynamic programming algorithm. A key advantage to this approach is the reduction in time complexitywhile proteins in UniProt contain on average 324 amino acids, they harbour an average of only 1.5 domains (2.63 for multi-domain arrangements), making the number of required comparisons considerably smaller. Further, by only considering proteins that share at least one common domain, the search space can be drastically reduced. While abandoning the information contained within the sequences does come at the cost of sensitivity, it is well established that domains are the units of protein evolution and are a good proxy for sequence similarity (the need for increased sensitivity. RAMPAGE creates global alignments of amino-acid sequences using the domainwise alignments provided by RADS as guideline, similar to previously described approaches such as the segment-based approach applied in DIALIGN-T (). We demonstrate that methods searching for domain arrangements yield biologically meaningful results, which are often complementary to sequence-based methods and, at the same time, work at a speed that is significantly faster than local alignment tools.
CONCLUSIONIt has been shown that proteins with identical multi-domain arrangements have similar function in 90% of all cases, whereas 35% of multi-domain proteins sharing only one domain are functional homologs (). We therefore consider the RADS approach to identify all identical arrangements to a given query as a fast and valuable step in determining protein similarity across large datasets. For single-domain proteins and proteins that lack domain annotation, however, sequence-based algorithms provide more relevant results as they are able to identify local similarities, which are crucial in distinguishing close homologs. RAMPAGE alleviates this problem and perform with similar sensitivity but significantly faster than BLAST (Supplementary Material S5). We propose that RADS is complementary to sequence similarity-based approaches and that exploiting domain arrangements for similarity search is, in particular for multi-domain proteins, an important means for identifying functional homologs. Although RADS explicitly disregards sequence information at the alignment stage, the comparison of domains is nonetheless driven by sequence information, as multiple sequence alignments are used to construct the profile. Indeed, such sequence profiles are sensitive, as they in essence describe the variation at the sequence level of a large set of related proteins. This is particularly valuable when dealing with the increasing amount of available sequence data, as the ability to use the strong discrimination power of hidden Markov models (HMMs) or other profilebased methods can be used to initially reduce search space. The sensitivity of RADS/RAMPAGE is theoretically comparable with profile-based searches such as PSI-BLAST (), yet a sensitive similarity search can be achieved without compromising the actual search time because the computationally heavy stage is shifted to protein annotation. However, recent advancements in the HMMER package () have made on-the-fly annotation of protein domains feasible, such that a RADS search is swift even for raw sequence queries. Several published approaches use domain composition or arrangements for homology detection (). Nonetheless RADS/RAMPAGE will be a valuable resource for the communityfor several reasons. First, CDART () does not rank results based on domain arrangement similarity. Rather, it provides the user with the number of shared domains without taking any additional domain or sequence information into account. Moreover, because CDART uses custom-defined domain definitions, results are difficult to compare with more widespread domain definitions such as Pfam. Second, the domain distance introduced by Bjorklundprovides a simple but efficient metric for describing the dissimilarity of domain arrangements, which is defined as the number of domains that remain unaligned in a global alignment of domain arrangements.recently published an analogous approach where domain arrangement similarity is expressed as the number of aligned domains. To the best of our knowledge, neither of these metrics has been implemented in a publicly available resource. Third, in the most recently described method (), which includes a web interface, the authors proposed a complex measure based on information theory that combines the domain composition similarity with ordered pairs and domain duplications. However, the method is 'kingdom'-dependent (Eukaryota, Bacteria, Archea), limiting the possibility of large-scale, cross kingdom comparisons. Furthermore, the scoring system as implemented has not been tested on large datasets and we were unable to reproduce the results provided by the web interface, which only reports the 10 most similar arrangements and seems to be outdated (2009). Fourth, we find that RADS/RAMPAGE perform significantly faster than all other methods tested in this study (Supplementary Material S4). Finally, we provide a set of implementations to meet the needs of various groups. We provide a fast C-based command-line application for running custom domain-string comparisons, a web interface for querying UniProt with Pfam and a command-line JAVA application for querying the web interface in batch mode, which can also be used. Example results of a combined RADS/BLAST search in enzyme family of phosphomannomutases illustrating the differences between the two algorithms. Left: comparison between the original query (A2VP54_MYCTU) and a protein with the same domain arrangement (C7TXY1_SCHJA, a putative phosphoglucomutase) and high RADS score that is not detected by BLAST at an e value of 0.1; Right: comparison with a significant (e value 510 6 ) BLAST hit (C9Z9C4_STRSW) with little agreement with the query in domain arrangement as a JAVA library for programmatic access. Furthermore, we have integrated the RADS/RAMPAGE search into a GUIbased tool termed DoMosaics, which is available for download from http://domosaics.uni-muenster.de (). In summary, the complementary approaches RADS and RAMPAGE and their implementations allow for fast similarity searches using domain arrangement comparisons. The web service provides a fine-grained arrangement scoring with useradjustable parameters and comparison with BLAST. Results can be ordered, filtered by scores and/or reduced to non-redundant arrangements. Searches can be saved and downloaded, and we are currently developing new filters to allow for taxon-and species-specific searches. To ensure that the sequence database of the web service remains current, we are using Pfamseq annotations, and have developed routines to ensure that this resource is updated with each new Pfam release. Given the large amount of sequence data that has so much become an integral part of modern biological analysis and the increasing speed of profilebased annotation methods, we believe that both RADS and RAMPAGE will prove useful in identifying homology of interest, and that it can help to put the available data to work in pursuing interesting and relevant questions in molecular biology and evolution.