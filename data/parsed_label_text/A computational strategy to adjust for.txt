Motivation: The Hi-C technology was designed to decode the three-dimensional conformation of the genome. Despite progress towards more and more accurate contact maps, several systematic biases have been demonstrated to affect the resulting data matrix. Here we report a new source of bias that can arise in tumor Hi-C data, which is related to the copy number of genomic DNA. To address this bias, we designed a chromosome-adjusted iterative correction method called caICB. Our caICB correction method leads to significant improvements when compared to the original iterative correction in terms of eliminating copy number bias. Availability: The method is available at https://bitbucket.org/mthjwu/hicapp.
IntroductionOur knowledge of the higher-order structure of the genome has rapidly expanded over the last decade with the development of several methods able to elucidate the non-linear spatial conformation of the genome (). One important contribution was the development of a chromatin conformation capture (3C)-based method called Hi-C (), which enables high-throughput analysis of spatial structures of chromatin. Recent improvements of the Hi-C protocol led to a characterization of chromatin structure from many species at increased resolution (), from the original 1Mb map () to the most recent 1Kb map (). Increasing effort has since been devoted to studies of the biological function and consequences of the 3D chromatin architecture, such as its role in promoter-enhancer regulation () and associations between chromatin conformation and DNA replication timing () as well as local mutation rates (). Hi-C data at different resolutions may enable researchers to infer different levels of genomic interactions; for instance, a 1Mb resolution elucidates the overall folding principles of chromosomes, which were found to be consistent among different cell types within each species (); a 50-100Kb resolution provides chromosome domain information which is associated with histone marks (; and a 1kb10kb resolution enables detailed studies of chromatin looping, such as enhancer-promoter or enhancer-enhancer interactions, which can be specific to different cell types (). Raw Hi-C data has been observed to have both technical and biological biases (), with three predominant sources of bias identified so far: fragment length, GC bias and mappability. To correct for these biases, many software packages have been developed in order to generate an unbiased interaction map (). Hicpipe () and hicnorm () are explicit correction methods which fit probabilistic and regression models, respectively, to normalize the raw Hi-C map. These approaches require a priori knowledge of the biases. Another method, used in software such as Hiclib () and HiCorrector (), performs an iterative correction (IC), which does not require a priori knowledge of the biases. Such methods use a matrix balancing or scaling algorithm () to iteratively correct for all possible biases, based on the assumption that all loci should have equal representation in the data if there is no bias. IC-based methods generate a bias vector defined as IC bias (ICB, denoted as B below) that converts the raw matrix (R) to a normalized matrix (Nij = BiBjRij in which i and j represent two genomic loci). Because of ease of application and high running speed, easy transformation between the raw and normalized matrices and no requirement of the explicit information on biases, IC-based methods (also called ICB correction) have become the most widely used Hi-C normalization approaches that can correct for both known and unknown biases in many current applications (). A novel source of bias that can arise in Hi-C data is related to the copy number of genomic material. This type of bias has so far been unaccounted for since most Hi-C applications investigate normal tissue and healthy cell line samples, which have mostly uniform copy numbers of chromosomes. However, once tumor samples are analyzed, biases related to copy number alterations become important and need to be corrected for in order to obtain an accurate view of the interaction map between genomic locations. So far, limited Hi-C experiments have been carried out on tumor samples (Associate Editor: Dr. John Hancock  The Author (2016). Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oup.com). For a genome with non-uniform copy number, such as that of tumor cells, DNA copy number variation can introduce critical bias in Hi-C data because genomic locations with a higher copy number have a greater chance to be sequenced in the Hi-C protocol, and genomic locations with low copy number might not be detected at all in Hi-C data. We first identified the bias caused by DNA copy number by analyzing the ENCODE K562 Hi-C data (). Surprisingly, we found that the copy number bias still existed after within-chromosome ICB correction (). Further analyses demonstrated that the ICB method can correct for copy number biases within each chromosome but not between chromosomes, which also cannot be adjusted for simply by using total or average contact counts of chromosomes. By utilizing the count-distance curve between the contact counts and the genomic distance between the contact pairs, we converted the problem of removing the biases across chromosomes to the problem of minimizing the differences across count-distance curves of different chromosomes. We thus designed a linear regression-based chromosome-level adjustment method called caICB, which is based on the ICB protocol, to correct for this bias. We performed the analyses on multiple resolution contact maps (1Mb, 250Kb, 100Kb and 10Kb) and found that the performance of our caICB correction is significantly better than the original ICB method in terms of correcting for copy number biases. Our analyses show that the three previously identified bias factors are also accurately corrected for by caICB. Furthermore, the caICB correction is robust when using a small subset of genomic ranges instead of using the whole genome contact map, and is easy and fast to apply even for extremely high-resolution maps. Our method does not require copy number data for the samples for which Hi-C data is available, and has the potential to adjust for other biases in Hi-C data without a priori knowledge.
ConclusionOur proposed method, caICB, is able to efficiently correct for the copy number bias as well as other potential biases in tumor Hi-C data without a priori knowledge of these biases. Our method is suitable for extremely high-resolution Hi-C maps, because it can achieve robust results when using a small subset of genomic ranges instead of using the whole genome contact map. The method does not require copy number data for the samples for which Hi-C data is available, and has the potential to adjust for other possible biases in Hi-C data without their priori knowledge. Despite the fact that copy number data is not required for the caICB correction algorithm, it would be preferable to monitor copy number bias in the data before and after normalization when analyzing Hi-C data in tumor samples. This observation arises because for extreme cases, such as high-level amplification or near homozygous deletion, which accounts for less than 1% of all locus pairs in K562 cells but may account for a larger fraction in other tumor cells, the contact counts might either be too high or too low to be corrected for by current methods. In these cases, careful evaluation of normalization results is necessary to prevent making biased conclusions. Notably, we found that within-chromosome copy number biases are very effectively corrected by the original ICB method. Therefore, downstream analyses, such as Hi-C loops identified by HiCCUPs, are not biased even when using ICB-corrected Hi-C maps, because the background model is built locally within each chromosome. However, downstream analyses using the genome-wide background, such as the identification of significant contacts by Fit-Hi-C, can be significantly biased in ICB-corrected Hi-C maps; this bias is largely eliminated by using the proposed caICB correction. Furthermore, the caICB correction makes the Hi-C contact counts comparable across the genome, and has potential application for comparing Hi-C data between tumor and normal cells with different genomic copy numbers.