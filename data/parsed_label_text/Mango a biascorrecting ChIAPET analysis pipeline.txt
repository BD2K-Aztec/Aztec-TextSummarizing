Motivation: Chromatin Interaction Analysis by Paired-End Tag sequencing (ChIA-PET) is an established method for detecting genome-wide looping interactions at high resolution. Current ChIA-PET analysis software packages either fail to correct for non-specific interactions due to genomic proximity or only address a fraction of the steps required for data processing. We present Mango, a complete ChIA-PET data analysis pipeline that provides statistical confidence estimates for interactions and corrects for major sources of bias including differential peak enrichment and genomic proximity. Results: Comparison to the existing software packages, ChIA-PET Tool and ChiaSig revealed that Mango interactions exhibit much better agreement with high-resolution Hi-C data. Importantly, Mango executes all steps required for processing ChIA-PET datasets, whereas ChiaSig only completes 20% of the required steps. Application of Mango to multiple available ChIA-PET datasets permitted the independent rediscovery of known trends in chromatin loops including enrichment of CTCF, RAD21, SMC3 and ZNF143 at the anchor regions of interactions and strong bias for conver-gent CTCF motifs. Availability and implementation: Mango is open source and distributed through github at https:// github.com/dphansti/mango.
IntroductionIncreasing evidence suggests that the three-dimensional structure of mammalian chromatin plays an important role in regulating gene expression and biological function (G nd r and). To study chromatin structure, multiple high-throughput sequencing-based assays have been developed including 3C, 4C, 5C, Hi-C and, the newest addition, Chromatin Interaction Analysis by Paired End Tag sequencing (ChIA-PET) (). Though the methods differ in scope and resolution, they all share the same basic steps including cross-linking native chromatin, ligating interacting fragments and sequencing chimeric DNA fragments to assess interaction frequency. Informatic analysis of the resulting data then entails identifying which pairs of loci exhibit more interactions than expected by random chance. It has been well established by 3C, FISH and Hi-C studies that pairs of genomic loci exhibit random-polymer-like behavior in which genomic interaction frequencies decrease as a function of genomic distance (Supplementaryand B) (). Therefore, it is critical that software designed to detect interactions between pairs of loci must consider and accurately model the expected interaction frequency of pairs of loci given linear genomic distance. Indeed, most if not all availablesoftware packages to identify interactions from 5C and Hi-C datasets do consider genomic distance in the null model (). Furthermore, ChIA-PET has the unique property of specifically enriching for loci bound by a specific protein. As these regions are bound at different affinities throughout the genome, the depth of coverage at interacting peaks must be considered in any analysis paradigm. Several analysis methods exist to process ChIA-PET data. However, these methods either fail to address the major sources of bias or require the user to write a large portion of the analysis code themselves rendering them unusable for many wet lab biologists. ChIA-PET Tool (CPT) was the first software to address the unique problems associated with ChIA-PET data and has established an effective workflow for data processing (). The authors of CPT employ both random sampling and statistical methods to filter out noise due to random ligations that occur in solution rather than in vivo. However, CPT fails to address the most common source of bias in 3 C-based techniques, non-specific interactions due to linear genomic distance, i.e. the random-polymer effect. CPT uses the hypergeometric distribution to assess significance of interactions. This model assumes that any two genomic loci are equally likely to be linked by a PET regardless of genomic distance. Therefore, in addition to detecting true looping interactions, this approach is likely to detect a large number of false positives that exhibit nonrandom interaction frequencies due to genomic proximity rather than genomic looping. Indeed, a recent study revealed that interactions determined by CPT showed poor agreement with highresolution Hi-C datasets. In addition, CPT is extremely difficult to install as it requires a very specific OS configuration including a complex array of programming languages and environments including C, perl, python, R, MySQL, Apache web server and PHP. Recently, Paulsen et al described a novel method to process ChIA-PET data that does consider genomic distance in the null model. This method, ChiaSig, uses the non-central hypergeometric to identify statistically significant interactions {Paulsen:2014bn}. As expected, this method identifies far fewer interactions than CPT. While this approach yields accurate interactions, the software only executes the very final step in ChIA-PET data analysis, interaction scoring. Therefore, users must write their own software to find and remove linker sequences, align PETs, remove duplicates, call peaks, group PETs into interactions and determine the lower bound cutoff for PET distances. As such, this software is only useful to researchers with significant programming skills. Other software packages have been described but either are not publicly available or have similar limitations to CPT and ChiaSig (). To address these shortcomings, we introduce Mango an open source ChIA-PET data analysis pipeline. Mango models the likelihood of interactions between genomic loci as a function of both distance and peak depth and uses this model to assign statistical confidence to interactions. This software is simple to install, requires only fastq files as input and completes all steps required to analyze ChIA-PET datasets with only a single command. To evaluate the applicability of Mango, we compared the interactions determined by Mango, ChiaSig and CPT for three publicly available ChIA-PET datasets (). We demonstrate that interactions detected by Mango show better agreement with recently published high-resolution Hi-C data and independently recapitulate several recently discovered characteristics of long-range chromatin interactions. First, the anchor regions of interactions detected by Mango were strongly enriched for the proteins CTCF, RAD21, SMC3 and ZNF143 with between 92 and 98% of anchor regions overlapping a CTCF binding site. Second, the majority (73 to 94%) of interactions linked two loci that harbored CTCF motifs that had a convergent orientation.
DiscussionHere we describe Mango a ChIA-PET data analysis pipeline that corrects for non-specific interactions as a function of genomic proximity and peak depth. We demonstrate that Mango exhibits increased accuracy compared with both CPT, the only existing ChIA-PET analysis pipeline, and ChiaSig, a software package that provides statistical confidence estimates for ChIA-PET interactions. Application of Mango to multiple ChIA-PET datasets allowed for the independent replication of findings regarding the nature of 3D chromatin loops including strong enrichment for CTCF binding sites with inward oriented motifs. In addition to improved accuracy, one of the key benefits of Mango is usability. Mango was designed to be usable by all researchers even those with minimal computer competency. Mango is easily installed and completes all steps from fastq to interactions with a single command. It relies on only four widely used and easily installed software packages. In contrast, CPT requires a very specific OS configuration including a complex array of programming languages and environments including C, perl, python, R, MySQL, Apache web server and PHP and is accompanied by a seven page installation guide. ChiaSig can be installed easily yet only performs a single step required for the analysis of ChIA-PET data. Users are therefore required to write their own code to perform the majority of processing steps including linker parsing, read alignment, duplicate removal, peak calling and distance filtering. The software presented here improves upon methods used in our previous work (). Most notably Mango replaces the computationally expensive distance matched rewiring method with a simple and robust Bayesian approach. Because of improvements in ease of use and accuracy, Mango will drastically improve our ability to uncover the characteristics and function of 3D chromatin structure through the analysis of ChIA-PET datasets.