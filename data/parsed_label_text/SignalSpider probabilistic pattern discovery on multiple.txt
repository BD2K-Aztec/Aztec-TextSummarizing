Motivation: Chromatin immunoprecipitation (ChIP) followed by high-throughput sequencing (ChIP-Seq) measures the genome-wide occupancy of transcription factors in vivo. Different combinations of DNA-binding protein occupancies may result in a gene being expressed in different tissues or at different developmental stages. To fully understand the functions of genes, it is essential to develop probabilistic models on multiple ChIP-Seq profiles to decipher the combinatorial regulatory mechanisms by multiple transcription factors. Results: In this work, we describe a probabilistic model (SignalSpider) to decipher the combinatorial binding events of multiple transcription factors. Comparing with similar existing methods, we found SignalSpider performs better in clustering promoter and enhancer regions. Notably, SignalSpider can learn higher-order combinatorial patterns from multiple ChIP-Seq profiles. We have applied SignalSpider on the normalized ChIP-Seq profiles from the ENCODE consortium and learned model instances. We observed different higher-order enrichment and depletion patterns across sets of proteins. Those clustering patterns are supported by Gene Ontology (GO) enrichment, evolutionary conservation and chromatin interaction enrichment, offering biological insights for further focused studies. We also proposed a specific enrichment map visualization method to reveal the genome-wide transcription factor combinatorial patterns from the models built, which extend our existing fine-scale knowledge on gene regulation to a genome-wide level. Availability and implementation: The matrix-algebra-optimized exe-cutables and source codes are available at the authors websites:
INTRODUCTIONIn human and other eukaryotes, gene expression is regulated by the binding of various modulatory transcription factors (TF) onto cis-regulatory DNA elements near genes. Binding of different combinations of TFs may result in a gene being expressed in different tissues or at different developmental stages. To fully understand a gene's function in the cell, it is essential to identify the TFs that regulate the gene and their corresponding TF binding sites (TFBS) (). The techniques such as protein binding microarray (), microfluidic affinity analysis () and protein microarray assays () enable us to measure the DNA sequence binding of TFs in vitro. On the other hand, the technology of chromatin immunoprecipitation (ChIP) followed by microarray (ChIP-ChIP) or sequencing (ChIP-Seq) () can efficiently measure the binding occupancy of a particular TF on a genome-wide scale in vivo. In a typical ChIP-Seq study, the first step is to call the peaks, i.e. determining the precise location in the genome where the TF binds. A number of peak calling tools have been developed, but recent benchmark studies have shown that the peaks from those tools are often inconsistent (). Because multiple transcription factors often work in cis regulatory modules to confer complex gene regulatory programs, it is necessary to develop models on multiple ChIP-Seq datasets to decipher the combinatorial DNA-binding mechanism. In the following, we briefly review some of the previous works in this area. Gerstein et al. used pair-wise peak overlapping patterns to construct a human regulatory network (). Xie et al. proposed self-organizing map methods to visualize the colocalization of DNA-binding proteins (). Giannopoulou et al. proposed a non-negative matrix factorization to elucidate the clustering of DNA-binding proteins (). Zeng et al. proposed jMOSAiCS to discover histone modification patterns across multiple ChIP-Seq datasets (). Ferguson et al. have described a hierarchical Bayes approach to integrate multiple ChIP-Seq libraries to improve DNA binding event predictions. Mahony et al. also proposed a mixture model (MultiGPS) to detect differential binding enrichment of a DNA-binding protein in different cell lines, which can improve the protein's DNA binding location predictions (i.e. Cdx2 protein in their study) (). On the other hand, Chen et al. proposed a statistical framework (MM-ChIP) based on MACS to perform an integrative analysis of multiple ChIP datasets to predict ChIPenriched regions with known motifs for a given DNA-binding protein (i.e. ER and CTCF proteins in their study) (*To whom correspondence should be addressed.  The Author 2014. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com 2011). On the other hand, Ji et al. proposed a differential principal component analysis method on ChIP-Seq to perform unsupervised pattern discovery and statistical inference to identify differential proteinDNA interactions between two biological conditions (). Guo et al. described a generative probabilistic model (GEM) for high resolution DNA binding site discovery from ChIP data (). Interestingly, that model combines ChIP signals and DNA motif discovery together to achieve precise predictions of the DNA binding locations of a DNA-binding protein. The authors have further demonstrated how GEM can be applied to reveal spatially constrained transcription factor binding site pairs on a genome. Despite the success of the methods described above, to fully understand a gene's function, it is essential to develop probabilistic models on multiple ChIP-Seq profiles to decipher the genomewide combinatorial patterns of DNA-binding protein occupancy. Unfortunately, the majority of the previous work usually focused on large-scale clustering of called peaks, which is an intuitive and straightforward approach. However such approaches have two limitations, as (i) peak-calling ignores the contributions from weak bindings of TFs, and (ii) pair-wise analysis ignores the complex combinatorial binding pattern among the TFs. Here we propose a new approach to build fine-scale probabilistic models for directly analyzing multiple normalized ChIP-Seq signal profiles on all the promoter and enhancer regions quantitatively so that weak bindings can be taken into account (). Especially, its computational complexity has been carefully designed to scale well with the increasing ChIP-Seq data (i.e. linear complexity). After model training, we can extract and reveal the high-order combinatorial and quantitative occurrence patterns from the trained probabilistic models for better understandings on the DNA-binding protein combinatorics.
DISCUSSIONWith the prevalence of ChIP-Seq technology, massive ChIPSeq data have been accumulated. The current ChIP-Seq data analysis studies usually involve single profile peak calling. Two areas of improvement are currently being explored in the field: how to integrate binding profiles of multiple transcription factors and how to include the signals from the areas that are not called as peaks. In light of that, we have developed a probabilistic model to analyse multiple ChIP-Seq signal profiles directly. The model (SignalSpider) not only can cluster genome into several region types, but also can extract subtle binding combinations from multiple DNA-binding proteins. The results show that the proposed model demonstrated performance better than the other existing methods on the simulated data derived from the available ChIP-Seq dataset. With the support of GO enrichment analysis, evolutionary conservation, chromatin interaction enrichment analysis and available wet-lab studies, we found that the discovered patterns show significant genome-wide insights. In particular, the patterns indicate that the genome-wide DNA-binding protein occurrence patterns are far from simple co-associative pair-wise interactions. Instead, we observed different higher-order enrichment and depletion patterns across different proteins. With increasing available ChIP-Seq data, we envision that SignalSpider will be useful in understanding the genome-wide DNA-binding dynamics.. Examples of conserved regions. The vertical axis is the conservation (PhastCons scores), while the horizontal axis denotes two regions. The left boxes correspond to the cluster regions of interest, while the right boxes denote the background region. Outliers are omitted. P-values for Wilcoxon rank sum test and t-test are shown at the title