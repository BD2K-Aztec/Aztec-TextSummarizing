Motivation: Sequence analysis algorithms are often applied to sets of DNA, RNA or protein sequences to identify common or distinguishing features. Controlling for sequence length variation is critical to properly score sequence features and identify true biological signals rather than length-dependent artifacts. Results: Several cis-regulatory module discovery algorithms exhibit a substantial dependence between DNA sequence score and sequence length. Our newly developed LOESS method is flexible in capturing diverse score-length relationships and is more effective in correcting DNA sequence scores for length-dependent artifacts, compared with four other approaches. Application of this method to genes co-expressed during Drosophila melanogaster embryonic mesoderm development or neural development scored by the Lever motif analysis algorithm resulted in successful recovery of their biologically validated cis-regulatory codes. The LOESS length-correction method is broadly applicable, and may be useful not only for more accurate inference of cis-regulatory codes, but also for detection of other types of patterns in biological sequences. Availability: Source code and compiled code are available from
INTRODUCTIONAn important task in computational biology is to score DNA, RNA or protein sequences for a variety of features. These features may range from relatively basic sequence properties such as GC content or evolutionary conservation, to more complex measures of putative biological function, such as the presence of transcription factor binding sites (TFBSs) or of TFBS clusters organized into cisregulatory modules (CRMs), e.g. transcriptional enhancers (). Such general computational endeavors often face the central challenge of properly accounting for input sequences of varying lengths. * To whom correspondence should be addressed.Accounting properly for dependence between a sequence score and its length is critical to identify a true biological signal, rather than a correlation artifact. A greater sequence length offers greater opportunities for finding good local matches by chance alone. For instance, artifacts associated with length dependence were noted in the early days of searching sequence databases. A nearly linear correlation was often observed between the best local similarity score and the length of the sequence match in the queried database, even when those sequences were unrelated (). More recently, adjusting for sequence length dependence was also found necessary in analysis of next-generation RNA sequencing (RNA-Seq) data (). Since the number of reads mapped to a gene depends on its transcript abundance and length (), transcript length may confound gene expression analysis (), with a bias for calling a higher proportion of long transcripts as expressed more highly. In the Drosophila melanogaster genome, for instance, genes have varying non-coding sequence lengths, ranging from 10 2 to 10 6 bp (). A prior study found that genes with more complex expression patterns tend to have longer non-coding sequences (). In prior investigations of CRMs and cisregulatory codes (), it was observed that for various input TFBS motifs there was a notable correlation between a gene's non-coding sequence length (i.e. totalmelanogaster the length of a gene's non-coding sequence varies across four orders of magnitude, from 10 2 to 10 6 bp. For instance, the C1 somatic mesoderm FC gene set has on average lengthier non-coding sequences, with a median of 17.4 kb (25.3 kb mean) as compared with 4.3 kb (11.4 kb mean) for all genes in the genome, a difference that must be accounted for to avoid computational artifacts.
DISCUSSIONDependence of the score of a biological sequence on the length of the sequence may confound or conceal true biological signals. Here, we have shown that this problem occurs for several well-known CRM prediction algorithms. We have presented a general method to adjust for length-dependence of a DNA sequence score. Our LOESS-fit approach is consistent in reducing the correlation between sequence length and score, not only in comparison to other methods (e.g. length division (LD), PCA-based methods and linear-log regression (LLR)), but also in absolute terms (; Supplementary). In the context of cis-regulatory code discovery, LOESS-fit correction allowed the Lever algorithm () to recover experimentally validated codes in two different biological contexts in D. melanogaster (). Compared with other normalization approaches, LOESS-fit performed favorably in recovering the validated codes (), and does not suffer from the artifacts that LLR and PCA may yield (Supplementary). In addition, LOESS-fit correction is useful in application to a variety of CRM prediction algorithms in analyses aimed at identifying putative cis-regulatory codes (). Our GSs were based on relatively stringent biological evidence. We focused on GSs comprising genes that are expressed in relatively homogeneous cell types, that were confirmed by in situ hybridization, and that have prior experimental evidence for a cis-regulatory code. GSs could be constructed alternatively to comprise genes with shared Gene Ontology (GO) annotation terms or pathway involvement. Some major advantages of LOESS, as compared with other regression methods, are that it does not call for a priori specification of a fitting function and that it is a flexible and simple fitting approach used for a wide range of purposes (). Our data points are generally dense (e.g.). However, potential limitations of the LOESS-fit method may arise in small or sparse datasets, where LOESS might overfit or inaccurately fit the data points. On another level, to avoid generating non-monotonic LOESS curves that might overfit the data, we have empirically chosen the value of the smoothing parameter to be robust across various motif combinations and GSs (Supplementary Figs S3 and S4). Potential artifacts might arise in a dataset with varying data density, such as around the extreme ends of a distribution, where LOESS interpolation might deviate from the sparse points that it tries to fit. We seldom encountered such deviations, which occurred mostly for genes with particularly short non-coding sequence lengths and with low gene CRM scores, where the LOESS curve could go below zero. To guard against such deviations, we implemented a small saturation threshold, t  0.01, so that the LOESS curve fit_LOESS = max(t, fit_LOESS) always remains 0 (or a small value, t, above 0). We considered the possibility of score inflation where the LOESS curve came close to zero. However, since the scores fit by the LOESS curve are also generally close to zero and of the same order of magnitude, their ratio will not be inflated. Of course, an outlier score that is much greater than the LOESS curve will be inflated; however;