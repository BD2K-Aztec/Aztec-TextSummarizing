Motivation: Cancer is well known to be the end result of somatic mutations that disrupt normal cell division. The number of such mutations that have to be accumulated in a cell before cancer develops depends on the type of cancer. The waiting time T m until the appearance of m mutations in a cell is thus an important quantity in population genetics models of carcinogenesis. Such models are often difficult to analyze theoretically because of the complex interactions of mutation, drift and selection. They are also computationally expensive to simulate because of the large number of cells and the low mutation rate. Results: We develop an efficient algorithm for simulating the waiting time T m until m mutations under a population genetics model of cancer development. We use an exact algorithm to simulate evolution of small cell populations and coarse-grained Ï„-leaping approximation to handle large populations. We compared our hybrid simulation algorithm with the exact algorithm in small populations and with available asymptotic results for large populations. The comparison suggested that our algorithm is accurate and computationally efficient. We used the algorithm to study the waiting time for up to 20 mutations under a Moran model with variable population sizes. Our new algorithm may be useful for studying realistic models of carcinogenesis, which incorporates variable mutation rates and fitness effects. Contact
INTRODUCTIONCancer is a genetic disease caused by mutations in cancer susceptibility genes, including oncogenes, tumor suppressor genes and genetic instability genes (see e.g.for a review). Mutations that activate oncogenes can confer a selective advantage to the cell when one of the two alleles is mutated, but typically involve specific amino acid changes at specific residues of the protein. Mutations that inactivate both alleles of a tumor suppressor gene also lead to fitness benefits to the cell, and such mutations do not have to be specific as many mutations in a gene can * To whom correspondence should be addressed. disrupt its normal function (). Genetic instability refers to a diversity of changes in the genome on the nucleotide or chromosomal levels. The former is caused by mutations in the DNA repair pathways and involves substitutions, insertions or deletions of one or a few nucleotides. The latter includes gains or losses of whole chromosomes as well as inversions, deletions, duplications and translocations of large chromosomal segments. Mutations in genetic instability genes may cause increased mutation rates in the cell, leading to the so-called 'mutator phenotype' (). For example, p53 mutations may impair the detection of and response to DNA damage. Many cancers have a mutator phenotype that results from mutations in genes involved in DNA mismatch repair. It is now generally accepted that the rate-limiting step in the process of carcinogenesis is the accumulation of new mutations. Both fitness advantages and increased mutation rates can significantly shorten the waiting time until the required number of mutations. The relative importance of selection followed by clonal expansion versus raised mutation rates is somewhat controversial.argue based on a computer simulation that advantageous mutations and clonal expansion were sufficient to initiate tumor without increased mutation rates. However, if more than two mutations in tumor suppressor genes are needed for carcinogenesis, increased mutation rates appear to be an important factor. The number of mutations required for tumorigenesis depends on the type of cancer.used age-specific cancer incidence data to estimate the number of mutations necessary to develop colon cancer to be about 6.inferred from an analysis of the incidence of retinoblastoma in children that the cancer is caused by mutations to the two alleles of a gene (which was later identified to be RB1, the first tumor suppressor gene), one of which may be in the germline and inherited.analyzed data from 1022 colorectal cancers from nine hospitals in Finland and estimated that about five to six oncogenic mutations are required for hereditary cancers or seven or eight mutations for sporadic cancers. In contrast to those early studies which suggested that a handful of mutations were sufficient to cause cancer, recent efforts using next-generation sequencing technologies to identify mutations in protein-coding genes in common tumor types have in general identified far more genes (). For example, SjblomPage: 838 837843analyzed 13 000 protein-coding genes in breast and colorectal tumors, and found that individual tumors accumulate an average of  90 mutations. Only a small subset of those mutations may be 'drivers', which offer the cell a selective advantage and are responsible for carcinogenesis, while the others are 'passengers', which provide no fitness benefits to the cell but hitchhike to fixation by chance.estimated that as many as 14 mutations may be required to initiate colon cancer and as many as 20 may be involved in breast cancer (seefor an updated analysis). The early work of Armitage and Doll (1954) and Knudson (1971) has prompted a large body of theoretical work, which uses population genetics models to describe mutation, drift and selection and to study the waiting time until the accumulation of m mutations.studied a two-stage model for a population of cells evolving according to the Moran model. By assuming that the first mutation is either neutral or deleterious while the second mutation is advantageous, they studied an interesting scenario called stochastic tunneling, in which a population fixed for cells of no mutation can reach fixation for the second mutation without ever reaching fixation for the first mutation. Schweinsberg (2008) andderived the asymptotic distributions of the waiting time until m mutations. Due to the complexity of the problem, they assumed selective neutrality and a constant mutation rate. Numerical simulations were conducted to confirm analytical results, but only for small populations (10 3  10 4 ).studied the waiting time until m mutations under the WrightFisher model with large population sizes (10 6  10 9 ). With numerical simulation, they were able to show how varying population size, mutation rate and selection affect the waiting time. As pointed out by, the Moran model is more natural than the WrightFisher model for describing the evolution of somatic cells. However, simulation under the Moran model is expensive, even more expensive than under the Wright Fisher model. The large population sizes and small mutation rates mean that one has to simulate many transitions, which change the compositions of the population only slightly. In this article, we develop an approximate algorithm to simulate the waiting time until m mutations under the Moran model. We explore the similarity of the model of cancer initiation to a chemical reaction system and develop simulation algorithms that have been studied in that context. The evolutionary process of mutation, drift and selection under the Moran model is described by a variable rate Markov chain, as is a chemical reaction system. The process can be simulated using standard algorithms by generating exponential waiting times until the next event and then deciding what event has happened. This is the so-called Gillespie algorithm (). However, with a large population size, simulation using this exact algorithm is prohibitively slow. The -leaping algorithm () was proposed to speed up the simulation by leaping over a time interval  in which changes to the state and rates of the chain are expected to be small. However, this coarse-grained approximation does not work well for our problem, because of the existence of cell types whose population sizes may be small. Here we develop a hybrid algorithm that can efficiently simulate the evolutionary processes of large populations. We use the exact algorithm to simulate transitions involving small populations, which may introduce substantial changes to the rates, and coarsegrained -leaping algorithm to simulate transitions within each large population, where transitions are unlikely to cause large changes to the state and the event rates. We test our new hybrid algorithm against the exact simulation in small populations and against asymptotic results in large populations. The results suggest that the hybrid algorithm is reliable and computationally efficient. The fast simulation algorithm may be useful for studying realistic carcinogenesis models that allow different cell types to have different finesses and different mutation rates.