Motivation: Bisulfite sequencing is currently the gold standard to obtain genome-wide DNA methylation profiles in eukaryotes. In contrast to the rapid development of appropriate pre-processing and alignment software, methods for analyzing the resulting methylation profiles are relatively limited so far. For instance, an appropriate pipeline to detect DNA methylation differences between cancer and control samples is still required. Results: We propose an algorithm that detects significantly differentially methylated regions in data obtained by targeted bisulfite sequen-cing approaches, such as reduced representation bisulfite sequencing. In a first step, this approach tests all target regions for methylation differences by taking spatial dependence into account. A false discovery rate procedure controls the expected proportion of incorrectly rejected regions. In a second step, the significant target regions are trimmed to the actually differentially methylated regions. This hierarchical procedure detects differentially methylated regions with increased power compared with existing methods. Availability: R/Bioconductor package BiSeq.
INTRODUCTIONDNA methylation is an epigenetic modification regulating gene transcription and is known to direct development and differentiation (). A CG dinucleotide (CpG site) is called methylated if a methyl group is attached to the cytosine (C). DNA treatment with sodium bisulfite specifically introduces conversion of unmethylated cytosine to uracil (then read as thymine by DNA polymerase), whereas methylcytosine remains unmodified (). These changes are mapped by next-generation sequencing. To save per-sample costs, bisulfite sequencing (BS) can be combined with enrichment strategies to target bisulfite sequencing to a specific fraction of the genome (). Along with DNA fragment capture, it is possible to use restriction enzymes as for reduced representation bisulfite sequencing (RRBS), which measures genome-wide DNA methylation in CpG-rich regions (). Msp1 (cleaves at CCGG) digested fragments are size-selected to obtain fragments with short distance between Msp1 sites. Bisulfite-treated DNA fragments are then sequenced and mapped via conversion-aware aligners, such as Bismark (), RRBSMAP (), BS Seeker () or PASS-bs (). The aligners usually return a list of CpG sites with the number of cytosines and thymines among all reads aligned to the cytosine in the genomic DNA sequence, which is then used for subsequent analyses. Aberrant DNA methylation patterns are a characteristic feature of cancer (). Often, studies focus on promoter regions or gene bodies ormore generallygenomic regions that are differentially methylated between cancer and normal specimens. In this context, a differentially methylated region (DMR) denotes a genomic region of adjacent CpG sites that are differentially methylated. Because of lower costs of RRBS or other targeted bisulfite sequencing approaches increasingly larger number of samples are measured, which enables a comparison of DNA methylation and the detection of DMRs between groups of samples (). In the past 3 years, several software tools for descriptive BS data analysis have been published. MethVisual () is an R/Bioconductor () package for visualization and exploratory statistical analysis of BS data. BiQ Analyzer HT () allows a locus-specific analysis and visualization. SAAPRRBS () provides methylation summary statistics and annotation of CpG sites. Nevertheless, few tools to detect DMRs exist. The most common approach is to perform Fisher's exact test CpG-wise or region-wise (). Recently, BSmooth was published, a pipeline to detect differentially methylated regions in wholegenome BS data (). BSmooth basically relies on smoothing the methylation values sample-wise and then testing for group differences via CpG-wise t-tests. DMRs are defined as adjacent CpG sites with absolute t statistics above a defined threshold. To assess the goodness of the results, a suitable error measure is needed. For example, it would be convenient to control the false discovery rate (FDR) on genomic regions, i.e. the expected proportion of regions rejected erroneously out of all regions rejected, testing the null hypothesis that the regions are not differentially methylated. However, the desire for a convenient analysis of BS data and the establishing of an error measure pose challenges specific to the analysis of BS data: first, the coverage, i.e. the number of reads spanning a CpG site varies widely between different CpG sites and different samples. As a consequence, each sample has an individual profile of covered *To whom correspondence should be addressed.CpG sites, and missing values occur frequently. Second, the specific probability distribution of methylation levels requires specific statistical models. Third, the methylation of neighbored CpG sites is spatially correlated and, hence, are the CpG-wise test statistics and P-values. The first and to our knowledge only approach accounting for spatial dependence in multiple hypothesis testing is methylKit, an R package for the analysis of RRBS data and its variants (). methylKit models the methylation per CpG site within a logistic regression. A sliding linear model (SLIM) method is used to determine q values from P-values to correct for multiple hypothesis testing (). We propose BiSeq, a DMR detecting approach that enables testing for DMRs within target regions and controlling a given FDR. This approach is tailored to data received by all kinds of targeted bisulfite sequencing approaches. The article is organized as follows. In Section 2, we give a rough overview of the step-by-step approach. The individual steps are presented in detail in Section 3. In Section 4, we apply the approach to simulated data and compare its results with those from BSmooth and methylKit. Furthermore, we apply BiSeq to a published leukemia dataset. In Section 5, we briefly discuss our results.
DISCUSSIONWe proposed a DMR detection approach that tests regions for differential methylation with subsequent localization of DMRs within rejected regions. This hierarchical procedure is more powerful than BSmooth and methylKit.. Power to detect differentially methylated CpG sites. Shown is the influence of the CpG methylation difference and DMR fraction of the respective CpG clusters on the probability to detect a differentially methylated CpG site. The higher the simulated methylation difference the higher was the probability to reject the CpG site (y-axis). The higher the fraction of differentially methylated CpG sites in CpG clusters, the higher was the probability to reject the clusters and, hence, to reject the CpG sitesOne strength of the proposed algorithm is that a region-wise FDR can be controlled. Nevertheless, we could ask whether smoothing of methylation data and focusing on regions is an appropriate strategy considering the fact that methylation of a single CpG site can prevent transcription factor binding (). To investigate whether focusing on region-wise methylation changes is meaningful, we analyzed the spatial clustering behavior of differentially methylated CpG sites in the leukemia dataset. We tested CpG sites for differential methylation in leukemia compared with controls without smoothing beforehand. This way we ensured that we did not add additional spatial correlation. We compared Ripley's K functions for both, tested CpG sites and differentially methylated CpG-sites and could show that the clustering of differentially methylated CpG sites is more pronounced than the clustering of tested CpG sites (which is due to the targeted sequencing). Differentially methylated CpG sites tend to form clusters of sizes up to 1000 bp (see Supplementary). The fact that entire regions are particularly effected by differential methylation in leukemia (and probably in other cancer types as well) justifies smoothing and detection of differentially methylated regions. An advantage over other approaches is that the methylation levels are modeled within a regression model allowing adding further independent variables and confounders to the model. For instance, Boks et al., 2009 found associations of DNA methylation with gender and age; thus, it might be important to take these confounders into account. Neither BSmooth nor the methylKit package allows adding further variables. By modeling the methylation levels within a beta regression, we make sure that basic properties of methylation levels are respected, i.e. the distribution between 0 and 1 and a smaller variance near the boundaries. Another advantage of the beta regression is the option to consider higher variances in a group of samples (commonly the cancer samples) via a variable precision parameter. A drawback is the long computing time. Most of the parameters that have to be chosen are related to CpG cluster detection and thus influence the extent of the genome that is to be analyzed. Basically, the grade of the minimal spatial density of covered CpG sites that form CpG clusters together with the width of the smoothing window should be adjusted to the expected DMR lengths. Even if many CpG sites are covered over a wide genomic region (for example, in wholegenome bisulfite sequencing data), it is advisable not to choose too large CpG clusters with many CpG sites, when the expected DMR widths are much smaller, as this would decrease the power markedly (). Likewise, a wide smoothing window results in a weaker sensitivity to small DMRs. Moreover, the smoothing bandwidth should be adjusted to the choice of CpG clusters.showed that the cluster testing procedure described earlier in the text controls the cluster-wise WFDR under independence or PRDS assumption, respectively. The procedure ensures that the cluster test statistics are Gaussian, and that the testing hypotheses are one-sided. Finally, to satisfy the PRDS property, the cluster test statistics have to be non-negatively correlated under the null hypothesis. We assume that this property is met in many cases for methylation data. Furthermore, it is important to note that the locationwise FDR is controlled asymptotically only, and DMR boundaries are slightly shifted by the smoothing step. However, we think that a targeted bisulfite sequencing approach primarily requires an analysis of the target units, e.g. CpG islands or gene bodies, rather than individual CpG sites. Besides, differential methylation typically is reported in terms of regions. This indicates a region-wise testing approach in the first place, followed by a CpG-wise detection tolerating more errors. This hierarchical testing procedure achieves a higher power than BSmooth and methylKit. The approach is tailored to targeted BS data. The direct use on whole-genome BS data would be feasible if the analysis was restricted on discrete genomic regions, e.g. on genes. We think that the two-stage testing procedure is applicable for other types of next-generation sequencing data as well. The histone modification H3K4me3 is known to occur in promoter regions primarily (). Thus, promoters could be tested for differential histone modification between groups of samples in a first step and in bins (sub-regions) within rejected promoters in a second step. This is a point for further research.