Motivation: Tiling arrays have been a mainstay of unbiased genome-wide transcriptomics over the last decade. Currently available approaches to identify expressed or differentially expressed segments in tiling array data are limited in the recovery of the underlying gene structures and require several parameters that are intensity-related or partly dataset-specific. Results: We have developed TileShuffle, a statistical approach that identifies transcribed and differentially expressed segments as significant differences from the background distribution while considering sequence-specific affinity biases and cross-hybridization. It avoids dataset-specific parameters in order to provide better comparability of different tiling array datasets, based on different technologies or array designs. TileShuffle detects highly and differentially expressed segments in biological data with significantly lower false discovery rates under equal sensitivities than commonly used methods. Also, it is clearly superior in the recovery of exonâ€“intron structures. It further provides window z-scores as a normalized and robust measure for visual inspection. Availability: The R package including documentation and examples is freely available at
INTRODUCTIONDuring the last decade, tiling arrays have been a mainstay of unbiased transcriptomics (e.g.,) and continue to contribute to novel findings. Tiling arrays have recently been applied, e.g., in the discovery of novel long non-coding RNAs (), to the identification of spatio-temporal patterns of gene expression (), to the characterization of the transcriptome in 30 distinct developmental stages as well as in 25 cell lines of Drosophila melanogaster (), and to the identification of a 'large complement of novel loci' with stage-specific expression in Caenorhabditis elegans (). High-throughput sequencing methods have * To whom correspondence should be addressed. recently shown distinct advantages over array-based approaches (). However, due to the availability of large tiling array reference datasets, e.g., from ENCODE and a clear statistical understanding on how to model differential expression in microarray data, tiling arrays are an important experimental approach in transcriptomics, and tiling array data analysis is a relevant topic in computational biology. One of the most widely used methods in tiling array expression analysis was introduced by () and is implemented in the Tiling Array Software (TAS). In brief, the local expression levels of probes are estimated by calculating the pseudomedian or HodgeLehmann estimator over intensities of probes within genomic distance of bandwidth. Transcribed segments are collections of expressed probes, i.e., probes with a smoothed intensity above a given threshold, with maximal genomic distance of maxgap and minimal length of minrun. TAS extends the method of Kampa et al. by estimating the significance of differential expression using a Wilcoxon signed-rank test. It tests for significant changes of probe intensities among states applied to local windows of given width centered around each probe. Hence, p-values for differential expression are assigned to each probe. More recently, Johnson et al. introduced an approach that models the expected probe behavior. It is available in the tool MAT (). Originally, it was designed to detect regions enriched by ChIP-chip but has also been applied to detect transcriptional activity (). In contrast to TAS, MAT uses a mixture model to normalize probe intensities by estimating the expected binding affinity on the basis of the composition and copy number of their nucleotide sequence on the corresponding genome. To identify (differentially) expressed probes, the score over all normalized intensities of probes within a local window, given by a bandwidth parameter, is compared with a null distribution. This distribution is composed of all non-overlapping window scores that can be calculated on the same array or the array in a different state during expression or differential expression analysis, respectively. Hence, it uses a two-step approach with different background distributions to normalize the probe intensity and assess its significance within a probe-centered window. In the detection of (differentially) expressed segments, positive probes are joined if their genomic distance is below a given maxgap parameter and segments enclosing more than minprobe probes are then reported. TileProbe is a variant of MAT, which models residual probe effects that cannot be explained by the MAT model by incorporating publicly available datasets (). TileProbe has been successfully applied to detect enriched motifs in ChIP-chip tiling array data, but in contrast to MAT, no application to detect differential expression has been reported. HAT uses a hypergeometric distribution to assess the probability to observe a specific number of probes within a window. It is less sensitive but more specific than MAT and cannot directly be used to detect differential expression (). Lastly, HMMTiling models probe-specific effects by a normal distribution defined for each probe individually compared with a control group (), but requires many samples in order to estimate the variance for a probe correctly which may not be available for arbitrary types of tiling arrays. gSAM, is a powerful framework for analyzing differential response of time series tiling array data (). It generalizes SAM () from a gene-centric view to genomic intervals in an underlying piece-wise model. Under this model, the time series is subdivided into logical segments and differential changes are analyzed on each of these segments separately. gSAM requires replicates which are often not available for whole genome tiling data. Another method suitable to detect differential expression on tiling array data is TileMap which assesses the significance of each probe by averaging over moderated t-statistics within a pre-defined window size (). () propose the averaging of p-values instead of test statistics providing a more flexible framework to evaluate more complicated experimental designs and to overcome the problem that the length of a sliding window may not be large enough to assume normal distribution. However, both methods again require replicates because probe-wise expression changes are assessed by hypothesis tests. An HMM-based approach was introduced bythat adaptively models tiling array data on given annotation and subsequently predicts expression on the genomic sequence. It does not require ad hoc parameters but is limited to expression analysis and hence cannot predict differential expression. Huber and colleagues presented a powerful segmentation approach for tiling array data, which controls for probe-specific effects by normalizing probe-wise intensities to a reference experiment with genomic DNA (). Recently,introduced a wavelet transformation to tiling array ChIP-chip data in order to discriminate regions of activity from noisy data. Our aim is to use tiling array data for identifying novel ncRNAs, which are differentially expressed in response to critical signaling pathways or cellular processes. For this purpose, a data analysis method is required to (i) analyze differential expression in tiling array data for genome-wide approaches; (ii) allow the latter without using replicate tiling array experiments due to limitations in the availability of sample material; (iii) identify boundaries of differentially expressed segments sufficiently precise to allow transcript annotation; and (iv) avoid the use of dataset-specific parameters which may hamper analyzing differential expression between arrays of different experiments. In our opinion, none of the state-of-the-art methods sufficiently fulfills all these requirements. Here, we present TileShuffle, a novel tiling array analysis approach that identifies transcribed and differentially expressed segments in terms of significant differences from the background distribution by using a permutation test statistic. Significance is assessed on minimal expected transcriptional units rather than on a single-probe level. TileShuffle does not require any dataset-specific parameters, e.g., intensity-related thresholds or parameters concerning collection of expressed probes. This is particularly favorable since in common tiling array experiments neither spike-ins to control the false discovery rate [FDR; as in (nor sufficiently large positive and negative sets to optimally adjust these ad hoc parameters might be available. We compare TileShuffle to TAS and MAT in analyzing differential expression in one human whole genome tiling array dataset and one spike-in dataset (). TAS is the most widely used tool in tiling array expression analysis and although MAT was originally designed for ChIP-chip data, it was successfully applied to detect transcriptional activity. All, TileShuffle, TAS, and MAT, do not require replicates to detect differentially expressed transcripts which is in particular favorable for studies with limited material and costs. At the same FDR, TileShuffle achieves significantly higher sensitivities than the other methods. Also, it detects boundaries of differentially expressed exons with higher precision than TAS and MAT.
CONCLUSIONMost published tiling array studies have focused on discovery of novel expressed transcripts rather than unbiased detection of differential expression and the choice of software for the latter task is limited. Variants of the maxgap/minrun algorithm () like TAS require dataset-specific cutoff parameters and MAT has been developed for ChIP-chip data analysis and requires adapted parameters to be applicable to expression tiling array data. Both hampers the applicability of these methods in different scenarios without manually inspecting a small set of expected positive regions. We have presented TileShuffle, a method specifically designed for expression and differential expression analysis of tiling array data. It implements a statistical approach to detect expression or differential expression in terms of differences from the background distribution that avoids any intensity-related parameters. TileShuffle reduces the most dominant tiling array biases using an affinity-dependent permutation in conjunction with a windowing approach. A related resampling approach has been used by, which does, however, not consider probe affinities and is not applied to detection of differential expression. We compared TileShuffle, TAS, and MAT in two different test scenarios. In the cell cycle dataset, where a custom array was used for validiation, TileShuffle achieved significantly lower false discovery rates under equal sensitivities. This test scenario has the advantages of building on a biologically meaningful experiment with the associated noise in expression signals and transcriptome complexity and of calculating sensitivity and specificity on a large number of intervals. However, the custom array data has an FDR itself, which is better controlled and significantly lower than for the tiling array, but still providing a surrogate for a true reference. In the second scenario, the algorithms are compared using a spike-in dataset (). The differences between the three algorithms are smaller than in the previous scenario. TileShuffle, however, is the only one obtaining sensitivities 50%. The spike-in experiment has the advantage of a clear definition of positve and negative intervals for calculating sensitivity and specificty. However  though large for a spikein experiment  162 differentially expressed elements is a small number compared with the cell cycle experiment, the noise is low, the basal expression level is already high and a 10-fold differential expression is a strong effect in biological experiments. The scenario is thus rather artificial. Apart from the ROCs, TileShuffle clearly outmatches TAS and MAT in the recovery of transcript structures by identifying the intronexon structure more accurately. However, TileShuffle fails to detect very short exons because of the windowing approach. Additionally, TileShuffle can incorporate replicate experiments and supports input data as custom-formatted files and hence is not dependent on any technology or tiling array design and can also be applied to ChIP-chip data by selecting a larger window size. The required computation time of TileShuffle is considerably higher than for TAS and MAT. However, it is negligible compared with efforts for the genome-wide tiling array experiment and thus does not constitute a bottleneck in the analysis work flow.