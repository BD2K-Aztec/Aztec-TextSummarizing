Motivation: Comparing genomes of individual organisms using next-generation sequencing data is, until now, mostly performed using a reference genome. This is challenging when the reference is distant and introduces bias towards the exact sequence present in the reference. Recent improvements in both sequencing read length and efficiency of assembly algorithms have brought direct comparison of individual genomes by de novo assembly, rather than through a reference genome, within reach. Results: Here, we develop and test an algorithm, named Magnolya, that uses a Poisson mixture model for copy number estimation of contigs assembled from sequencing data. We combine this with co-assembly to allow de novo detection of copy number variation (CNV) between two individual genomes, without mapping reads to a reference genome. In co-assembly, multiple sequencing samples are combined, generating a single contig graph with different traversal counts for the nodes and edges between the samples. In the resulting coloured graph, the contigs have integer copy numbers; this negates the need to segment genomic regions based on depth of coverage, as required for mapping-based detection methods. Magnolya is then used to assign integer copy numbers to contigs, after which CNV probabilities are easily inferred. The copy number estimator and CNV detector perform well on simulated data. Application of the algorithms to hybrid yeast genomes showed allotriploid content from different origin in the wine yeast Y12, and extensive CNV in aneuploid brewing yeast genomes. Integer CNV was also accurately detected in a short-term laboratory-evolved yeast strain.
INTRODUCTIONGenomes can differ in many ways. Several types of variation are commonly distinguished, from small local differences such as single nucleotide polymorphisms and short insertions and deletions (indels), to variation involving DNA fragments41 kbp, i.e. structural variation. Structural variations can be divided into balanced and unbalanced mutations. Balanced mutations, such as inversions and translocations, preserve the copy number of a given allele, whereas unbalanced mutations, such as indels and duplications, change the number of copies of the involved allele. Differences between genomes in the latter respect are referred to as copy number variation (CNV). Algorithms for variant discovery have until recently started by mapping sequencing reads to a reference genome. Subsequently, variation between the sequenced genome and the reference is inferred by analysing aberrantly mapped reads (), read-depth variation (), split-read mappings () or a combination of aberrantly mapped read pairs and read-depth variation (). Optionally, reads from the target sample in regions with many aberrantly mapped reads can then be locally assembled to infer genomic sequence not present in the reference genome. Recently, the Cortex assembler was introduced, the first fully de novo variant detection algorithm, not reliant on a reference genome. Cortex is a de Bruijn graph assembler capable of co-assembling multiple sequencing samples. In the underlying data structure, the de Bruijn graph, the nodes and edges are coloured by the samples in which they are observed. By observing bifurcations in the graph that separate the colours (bubbles), sequence variation is detected. While bubble finding works well for detecting (simple) variation, it does not easily allow CNV detection. A duplication event introduces an (almost) identical sequence in the genome, i.e. a repeat; furthermore, larger CNV regions are likely to contain repetitive regions inherent to the genome, such as transposons and paralogous genes. The resulting repeats pose a problem for assemblers, which collapse them into single contigs (). Because it is unknown how such collapsed repeats should be traversed, i.e. which pairs of incoming and outgoing edges should be connected via the repeat, a bubble cannot be detected. Thus, in a de novo variation detection setting bubble calling is not suitable to detect CNVs. The number of times a contig occurs in the genome can be inferred from read depths, exploiting the fact that assembly automatically segments the genome into contigs of integer copy number. Previously, the A-statistic has been proposed to determine whether a contig is unique or represents a collapsed repeat (). Medvedev andestimated the copy *To whom correspondence should be addressed.  The Author 2012. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com number of a contig using a maximum likelihood flow-solving algorithm, assuming a known genome size. Here, we introduce a Poisson mixture model (PMM) approach to estimate the copy number (CN) of a contig without making assumptions on genome size. The use of a PMM for modelling read depths in segments across multiple samples that have been mapped to a reference genome was recently introduced (). Here, we use a PMM in a de novo setting to obtain a genome-wide model for one genome, rather than in a local segment across multiple samples. The algorithm relies on de novo assembly for segmentation. We show how this mixture model can be applied in coloured assembly graphs to detect CNVs. The algorithm was named Magnolya (matched genomes de novo assembly graph analysis). In contrast to Cortex's De Bruijn graph approach, we use an overlap-layout-consensus assembler to generate a contig string graph. Contig string graphs are generated by first calculating pairwise overlaps between reads. A node in the resulting graph represents a read, and an edge between two reads represents an overlap. The graph is subsequently simplified by transitive reduction, which removes redundant edges, followed by unitigging, a process of collapsing simple paths without branches (). The result is a contig string graph, in which now the nodes represent collapsed reads called contigs, and edges represent reads spanning two contigs. The contigs cannot be collapsed further, as for each pair of contigs connected by an edge the inor out-degree (dependent on strand) is 41. String graph assemblers were first developed in the Sanger era, to assemble relatively long sequencing reads. The advent of nextgeneration sequencing (NGS), yielding short reads of length 36100 bp, required development of assemblers not reliant on pairwise overlaps of reads, the widely used de Bruijn graph assemblers. However, increasing read lengths produced by NGS technology (including the third-generation single-molecule sequencers) are renewing interest in overlap-layout-consensus assemblers, such as String Graph Assembler, capable of efficiently assembling mammalian genomes (). We extended the string graph by assigning each read a colour, corresponding to the sample from which it originated. In the resulting coloured contig string graph, we then detect variation by modelling read counts per colour with a mixture of Poissons and inferring the probability of a CNV. To our knowledge, we here for the first time apply a PMM to detect CNVs fully de novo between samples from two individuals. This approach has two main advantages. First, no read count based segmentation of the genome is required to distinguish regions with different copy numbers; this is handled in the co-assembly. Second, there is no bias to a, possibly distant, reference genome. In experiments, copy number estimation using Magnolya is demonstrated both on simulated data and on data from the genome of an allotriploid wine yeast. Furthermore, CNV detection with Magnolya applied to co-assemblies is tested on simulated data and demonstrated on the aneuploid genomes of two Saccharomyces pastorianus brewing yeasts and a laboratoryevolved yeast strain.