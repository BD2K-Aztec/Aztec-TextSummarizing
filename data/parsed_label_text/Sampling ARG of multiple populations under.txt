Motivation: Simulating complex evolution scenarios of multiple populations is an important task for answering many basic questions relating to population genomics. Apart from the population samples, the underlying Ancestral Recombinations Graph (ARG) is an additional important means in hypothesis checking and reconstruction studies. Furthermore, complex simulations require a plethora of interdependent parameters making even the scenario-specification highly non-trivial. Results: We present an algorithm SimRA that simulates generic multiple population evolution model with admixture. It is based on random graphs that improve dramatically in time and space requirements of the classical algorithm of single populations. Using the underlying random graphs model, we also derive closed forms of expected values of the ARG characteristics i.e., height of the graph, number of recombinations, number of mutations and population diversity in terms of its defining parameters. This is crucial in aiding the user to specify meaningful parameters for the complex scenario simulations, not through trial-and-error based on raw compute power but intelligent parameter estimation. To the best of our knowledge this is the first time closed form expressions have been computed for the ARG properties. We show that the expected values closely match the empirical values through simulations. Finally, we demonstrate that SimRA produces the ARG in compact forms without compromising any accuracy. We demonstrate the compactness and accuracy through extensive experiments. Availability and implementation: SimRA (Simulation based on Random graph Algorithms) source, executable, user manual and sample input-output sets are available for downloading at: https://github.com/ComputationalGenomics/SimRA
IntroductionWe address the task of modeling and simulating complex scenarios of related multiple populations with subdivision and admixture. These scenarios can be used to study the effect on the genetic profiles of extant populations as well as for testing complex hypotheses. The aim of simulations is to not only capture the resulting populations but also the relevant evolutionary history (for possible reconstruction studies). In literature, most admixture models are based on rather simplistic hypothesis of their possible inter-evolution history. One of the bottlenecks has been the sheer size of the monolithic common history of multi-populations, each of realistic size. Under these conditions simulators of even simple scenarios of just three populations often do not terminate in reasonable time in spite of meaningful parameter settings (sometimes up to 1012 hours, for instance with COSI ()). We observed a similar abort-and-rerun requirement in our experiments even with the classical algorithm (called Hudson in the paper). We present a framework for modeling complex evolutionary scenarios and an algorithm named SimRA that is both time and space efficient enough to be practical. SimRA makes it possible to run hundreds of experiments in very short time (in minutes) enabling a very effective means of carrying out complex studies, such as in. We demonstrate that the algorithm does not compromise the accuracy of the resulting simulations, all the while being very compact in its description.
ConclusionThe design of the SimRA algorithm was influenced by the implications of the Ancestor Without Ancestry Paradox, which also paved the way for computing the closed forms of the expected values of the ARG characteristics. To the best of our knowledge this is the first time analytic formulae have been given for an ARG. Such closed-forms, apart from mathematical completeness, also serve multiple practical purposes. Ironically, it obviates single population simulations in many situations where the interest is only in the characteristic estimates. In others it provides a framework for evaluating correctness of the ARG sampling algorithms. Also, for complex scenarios such as the ones with population scaffold architectures it aids in parameter specification (this is illustrated in Supplementary Section S5). Through extensive comparison studies, we demonstrated that the ARGs produced by SimRA are more compact, more efficient in time and space, without compromising accuracy. Currently we are looking into extending SimRA to incorporate other demographic models including selection.. The box-and-whisker diagrams of the compaction factor f, for different values of r. The other parameter values are the same as used inand for each parameter setting both the algorithms were run 100 times. ARGs produced by SimRA are consistently more compact (or less redundant) than that of Hudson