Motivation: Detection and quantification of the absolute DNA copy number alterations in tumor cells is challenging because the DNA specimen is extracted from a mixture of tumor and normal stromal cells. Estimates of tumor purity and ploidy are necessary to correctly infer copy number, and ploidy may itself be a prognostic factor in cancer progression. As deep sequencing of the exome or genome has become routine for characterization of tumor samples, in this work, we aim to develop a simple and robust algorithm to infer purity, ploidy and absolute copy numbers in whole numbers for tumor cells from sequencing data. Results: A simulation study shows that estimates have reasonable accuracy, and that the algorithm is robust against the presence of segmentation errors and subclonal populations. We validated our algorithm against a panel of cell lines with experimentally determined ploidy. We also compared our algorithm with the well-established single-nucleotide polymorphism array-based method called ABSOLUTE on three sets of tumors of different types. Our method had good performance on these four benchmark datasets for both purity and ploidy estimates, and may offer a simple solution to copy number alteration quantification for cancer sequencing projects. Availability and implementation: The R package absCNseq is available from
INTRODUCTIONCopy number alterations (CNAs) are an important class of somatic aberrations in tumor genomes and have been extensively studied in the hope of understanding the mutational landscape and clonal evolution of cancer (). Highthroughput platforms such as array comparative genomic hybridization (), single-nucleotide polymorphism (SNP) arrays () and next-generation sequencing (NGS) () have been widely used to measure CNAs. The direct readout from these platforms is a measure of the relative DNA content between a tumor sample and its normal counterpart, over a set of genomic regions. However, at the cellular level, CNAs are integers: for example, a region of DNA with normal copy number 2, corresponding to the two chromosomes, may be duplicated in one chromosome, resulting in copy number 3, or deleted, resulting in copy number 1. To estimate absolute copy numbers from the observed ratio of tumor to normal DNA, it is necessary to know two additional parameters, tumor purity, which is the ratio of tumor cells to total cells in the sample, and tumor ploidy, which is the average copy number of the entire tumor genome and can be used to account for whole-genome duplication events in the tumor (). Tumor ploidy may itself be a prognostic factor in cancer (). A related issue occurs with detection of somatic single nucleotide variants (SNV) (). As with CNAs, it is more informative to know the integer multiplicity of each gained somatic SNV, rather than the percentage of the alternate allele in the tumor/stromal mixture. Incorporating purity, ploidy and absolute copy number information may also help popular SNV callers like samtools () and GATK () to reduce both false-positive and falsenegative calls. All this highlights the importance of accurately estimating the absolute copy number information from noisy genomic data. Recent work addressing this issue has aimed to control for the effects of either tumor purity or ploidy or both in CNA detection (). ABSOLUTE () uses allele-specific copy ratios from SNP array data to infer purity, ploidy and absolute copy numbers and has demonstrated high accuracy. In principle, ABSOLUTE can also be extended to sequencing data, although the working pipeline and performance on sequencing data are not yet published. As more cancer samples are sequenced using NGS technology and as whole-exome sequencing (WES) becomes a routine platform for characterization of tumor samples, there is an urgent need to develop a similar tool for NGS.developed a method to estimate tumor purity from the deep whole-genome sequencing data; however, their method does not offer the estimation of ploidy and absolute copy numbers, and has not been shown to work equally well on WES data. In this work, we develop a simple and robust statistical method to estimate tumor purity, ploidy and absolute CNAs from WES data. We validated our method by comparing our purity and ploidy estimates against independent gold standard *To whom correspondence should be addressed. values using recently published exome data from 31 cancer cell lines (), 16 breast (), 16 prostate (The Cancer Genome Atlas Research) and 17 glioblastoma cancer patients (The Cancer Genome Atlas Research Network, 2008). We also study the effects of the existence of subclonal populations or segmentation errors on the accuracy of the purity estimation. To the best of our knowledge, this is the first work that has provided a working pipeline to estimate purity, ploidy and absolute copy numbers from raw WES data, which has been validated on several independently published WES datasets. We implemented the algorithm in an R package called absCNseq that is freely available from our Web site (http://biostats.mcc.ucsd.edu/files/absCNseq_1.0.tar.gz).
DISCUSSIONWe have developed a statistical approach, AbsCN-seq, which can estimate tumor purity and ploidy from WES data, and then use these estimates to infer absolute copy number and absolute multiplicity of somatic SNVs in the tumor. The ploidy estimates of our method fit the SKY values well. Our method also has good concordance with ABSOLUTE, although the two differ in several aspects. First, the input data are generated from different high-throughput platforms, ABSOLUTE, in it standard form, using SNP array data while our method takes NGS data. Second, the statistical framework and implementation differ. ABSOLUTE uses a Bayesian framework, whereas our method uses a simpler frequentist approach. Third, ABSOLUTE uses additional independent information to infer which solution is most likely, such as empirical karyotype models, while our solution refers only to the data from the sample and chooses the estimate that gives the best least-squares fit to the data. Given these differences, it is encouraging to see the high concordance between these two methods on our validation datasets. For the breast cancer patients, ABSOLUTE did not make calls on three(a). Comparison of purity (a) and ploidy (b) estimates from AbsCNseq versus ABSOLUTE for 17 GBM samples and 16 prostate samples. Assignment of integer copy numbers to the segments on chromosome 16 for subject BR-M-030. Raw copy ratios and segmented copy ratios between the tumor DNA mixture and the match germ line DNA are in green and blue, respectively. The estimated absolute copy numbers in pure tumor cells are in red. As a copy ratio of 1.0 corresponds to a normal diploid segment, we multiply the copy ratios by two to bring the copy ratio and the absolute copy number to the same scale subjects, and our method made reasonable calls on all three. We are unclear whether the failure of ABSOLUTE to produce an estimate for these subjects was due to a failure in SNP array experiment or to the algorithm itself. Thus, it seems that AbsCN-seq can work for certain samples where ABSOLUTE cannot make a call. On the other hand, our method failed to produce estimates in one case where ABSOLUTE could make an estimate, thus providing complementary approaches. As has been seen by ABSOLUTE, the best fitting solution is not always the correct solution. The validation studies here show that the top two solutions of our method usually cover the correct answer, but exceptions do exist. We recommend the user to manually inspect each solution whenever possible. Although our method does not yet incorporate subclonal tumor heterogeneity, it has been shown to be robust to a considerable amount of such heterogeneity, as well as to segmentation errors, in the estimates of purity and ploidy. Our method is flexible in the sense that it can also be applied to shallow whole-genome sequencing data (), an emerging NGS application to identification of copy number variants genome-wide. However, presence of somatic mutations cannot be reliably called in these type of data, let alone the corresponding variant allele frequency. For these type of data, we can set the algorithm to only use copy number information, by setting  1. The reduced objective function (first term of Equation 5) in step 2 now has a closed form solution. Define a new parameter  =  21  : It is easy to see that when q i 's are given, Equation (3) reduces to a simple linear regression on q i 's. Then can be obtained from the estimate. A caveat arises when we apply this form of AbsCN-seq to the WES data as seen in. We observed a systematic upward bias in the purity estimates as compared with the SNP-based ABSOLUTE estimates. However, by incorporating the SNV information, such bias was greatly diminished, and this did not appear to affect the ploidy estimates. This might not be a concern in practice, as for WES data, we will always use the default form with SNV information. At this moment, it is not clear to us what is the major cause for the small remaining observed bias. Platform-specific biases in the raw copy ratio data could be one possible reason. For instance, as shown by, the algorithm relying on the Illumina SNP array data () systematically underestimate tumor purity, as compared with the ABSOLUTE method relying on the Affymetrix SNP array data. Likewise, the apparent small overestimation of purity by our method as compared with ABSOLUTE might also be attributed to the characteristics of WES data compared with SNP array data. A supporting evidence is that we did not observe such minor biases when the platform is fixed. We have not tested our method on shallow WGS data with reference to purity estimates and we do not know yet if such overestimation also exists in the WGS data. Future work will examine the performance of the method on shallow WGS data, when a benchmark dataset becomes available.