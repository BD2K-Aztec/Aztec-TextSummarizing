Motivation: In the Wrightâ€“Fisher diffusion, the transition density function describes the time evolution of the population-wide frequency of an allele. This function has several practical applications in population genetics and computing it for biologically realistic scenarios with selection and demography is an important problem. Results: We develop an efficient method for finding a spectral representation of the transition density function for a general model where the effective population size, selection coefficients and mutation parameters vary over time in a piecewise constant manner. Availability and implementation: The method, called SpectralTDF, is available at https://source forge.net/projects/spectraltdf/.
IntroductionThe transition density function (TDF) of the WrightFisher diffusion describes the time evolution of the frequency of an allele (). The TDF is useful for understanding the effects of demography, mutation and selection on genetic variation, and it is a key component of a number of methods for inferring selection coefficients (), predicting allele fixation times () and computing population genetic statistics such as the site frequency spectrum (Z  ivkovictivkovict al., 2015). Most existing approaches for computing the TDF assume either restrictive models of dominance () or selective neutrality () or are computationally slow for selection strengths commonly observed in biological data (). However, Song and Steinr cken (2012) and Steinr cken et al. (2013) recently developed a numerically stable and computationally efficient method for finding a spectral representation of the TDF for a general selection model in the case of constant parameters (population size, mutation rates and selection coefficients). Despite the utility of this new approach, assuming that model parameters remain constant over time is often too restrictive for biological applications (of selection in which the fitness of a homozygote is twice that of a heterozygote (i.e. additive or genic selection). Furthermore, selection parameters are assumed to remain constant over time, and the model does not allow for recurrent mutations. Here, we present the first method for computing the TDF under arbitrary models of dominance and recurrent mutation while allowing selection parameters, mutation rates and effective population sizes to change over time in a piecewise constant manner.