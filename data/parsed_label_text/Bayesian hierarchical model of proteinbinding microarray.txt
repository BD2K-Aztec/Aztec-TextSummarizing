Motivation: Sequence-specific transcription factors (TFs) regulate the expression of their target genes through interactions with specific DNA-binding sites in the genome. Data on TF-DNA binding specifici-ties are essential for understanding how regulatory specificity is achieved. Results: Numerous studies have used universal protein-binding microarray (PBM) technology to determine the in vitro binding specifi-cities of hundreds of TFs for all possible 8 bp sequences (8mers). We have developed a Bayesian analysis of variance (ANOVA) model that decomposes these 8mer data into background noise, TF family-wise effects and effects due to the particular TF. Adjusting for background noise improves PBM data quality and concordance with in vivo TF binding data. Moreover, our model provides simultaneous identification of TF subclasses and their shared sequence preferences, and also of 8mers bound preferentially by individual members of TF sub-classes. Such results may aid in deciphering cis-regulatory codes and determinants of proteinâ€“DNA binding specificity. Availability and implementation: Source code, compiled code and R and Python scripts are available from http://thebrain.bwh.harvard.edu/ hierarchicalANOVA. Contact:
INTRODUCTIONTranscription factors (TFs) play a key role in the regulation of gene expression by activating or repressing transcription of their target genes. Regulatory specificity is achieved primarily by the recognition of specific DNA binding sites in the genome by sequence-specific TFs. Data on TF-DNA binding specificity are important for understanding how transcriptional regulation is encoded in cis-regulatory sequences in the genome. TFs can be classified according to the structural class of their DNA-binding domains (). TFs of the same structural class adopt the same fold in their DNA-binding domain and dock with their DNA binding sites in a similar manner. Because of these structural similarities, combined with sequence similarities because of the origin of TF families from ancient gene duplications and subsequent mutations, members of the same DBD class often, but not always, have similar DNAbinding sequence preferences (). A DBD class can be further divided into subclasses, with more closely related proteins exhibiting more similar DNA-binding preferences. Understanding how highly similar members of a TF family attain both redundant and divergent regulatory functions remains a significant challenge (). Accurate and comprehensive data on DNA-binding sequence specificities are essential for investigations of regulatory targeting by TFs, including the identification of the molecular determinants of TF-DNA binding specificity. A variety of high-throughput technologies have been developed for determining TF-DNA binding specificity (reviewed in). Methods that provide data on in vivo TF occupancies in the genome, such as chromatin immunoprecipitation coupled with either DNA microarrays (ChIP-chip) or high-throughput sequencing (ChIPSeq), provide data on both direct and indirect DNA binding by), which can vary across cellular or environmental conditions (). In contrast, approaches that determine DNA-binding specificities in vitro provide data on direct TFDNA interactions, without the confounding effects of in vivo protein cofactors (). Protein-binding microarray (PBM) technology is an in vitro approach for characterizing the DNA-binding specificities of proteins, by assaying the binding of a protein to a library of double-stranded DNA sequences immobilized on a DNA microarray (). Universal PBMs contain synthetic DNA sequences designed to represent all possible k-mers, with commonly used array designs encompassing all possible 10 bp DNA sequences (k  10) (). Universal PBMs have been used in numerous recent studies to determine the DNA-binding specificities of hundreds of TFs from a wide range of organisms (), with major efforts on TFs encoded in the genomes of the yeast Saccharomyces cerevisiae () and mouse (). Universal PBMs contain 60 bp DNA probes, each of which contains multiple 10mers embedded within variable flanking sequence. For statistical robustness, binding preference scores *To whom correspondence should be addressed.are calculated for all 8mers, each of which is represented on at least 16 or 32 spots, for palindromic and non-palindromic 8mers, respectively, on the array. Analysis of universal PBM data using the Universal PBM Analysis Suite, including the Seed-andWobble algorithm (), which was developed together with the universal PBM technology, involves background subtraction, various normalizations of the data and calculation of various binding scores for each 8mer, including the median fluorescence signal intensity over all probes that contain a particular 8mer and a rankbased PBM enrichment (E) score, ranging from 0.5 (worst) to 0.5 (best). The 8mer data can be used to derive a DNAbinding specificity motif, or position weight matrix (PWM) (). Analyses of large collections of universal PBM data have identified previously unknown diversity in the DNA-binding sequences recognized by TFs (). Hierarchical clustering of TFs according to their similarity in 8mer E-scores has permitted more precise identification of TF subclasses according to their DNA-binding specificities (). In addition, examination of k-mer-binding preferences within a TF family (here, defined as a group of closely related TFs belong to the same DBD structural class or the same subclass within a DBD class) has revealed sets of k-mers bound in common across the family ('TF-common' k-mers) and also sets of k-mers preferred by an individual member(s) of a TF family. To date, identification of such 'TF-preferred' k-mers has been performed in an ad hoc fashion, in manual investigations of individual sets of TFs that used various semi-arbitrary thresholds () combined with visual inspection (). Such TF-preferred k-mers may contribute to the distinct regulatory functions that distinguish members of a TF family. Although hierarchical clustering has been used successfully for functional classification of gene expression profiling microarray experiments () and for identification of TF subclasses based on PBM experiments (), the inclusion of unnecessary features that are irrelevant to cluster determination may degrade the results. This is especially the case for PBM experiments, where only a small fraction of k-mers measured by experiments are bound specifically by the profiled TF. Biclustering is a simultaneous similarity-based clustering approach that is able to detect subsets of features that exhibit consistent patterns over subsets of experiments (); however, it does not directly provide a systematic classification of TF subclasses. Model-based methods for identifying and removing batch effects and other sources of variation have been developed for metaanalysis of high-throughput data, including microarray-based gene expression profiling experiments (). Direct application of such methods potentially could separate systematic background noise from identification of k-mers preferred by different TFs from PBM data. Here, we present a Bayesian hierarchical analysis of variance (ANOVA) approach for modeling PBM k-mer data (here, 8mers). Our method identifies 8mers that score artifactually highly ('sticky' 8mers) for unknown reasons. Our approach for subsequently adjusting for these systematic biases improves overall PBM data quality and improves concordance with ChIP-chip data. Our modeling results in systematic identification of TF subclasses, simultaneously with their shared DNA-binding preferences, as well as the sequence preferences that distinguish them. Our TF subclassification results are consistent with classifications based on TF DBD sequence similarity. Our method also permits automated identification of TF-preferred k-mers within TF subclasses. Improved identification of TF-preferred k-mers will aid in studies of potential differences in the targeting of different genomic sites by paralogous TFs, and thus potentially how they may exert different regulatory functions. We anticipate that such modeling will aid in identification of genomic cis-regulatory codes (i.e. cis-regulatory sequence features that confer particular gene expression patterns) and will improve the quality of datasets for identification of the molecular determinants of TFDNA sequence specificity.