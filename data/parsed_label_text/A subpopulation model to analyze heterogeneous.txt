Motivation: Cell differentiation is steered by extracellular signals that activate a cell type specific transcriptional program. Molecular mechanisms that drive the differentiation can be analyzed by combining mathematical modeling with population average data. For standard mathematical models , the population average data is informative only if the measurements come from a homogeneous cell culture. In practice, however, the differentiation efficiencies are always imperfect. Consequently, cell cultures are inherently mixtures of several cell types, which have different molecular mechanisms and exhibit quantitatively different dynamics. There is an urgent need for data-driven mathematical modeling approaches that can detect possible heterogeneity and, further , recover the molecular mechanisms from heterogeneous data. Results: We develop a novel method that models a heterogeneous population using homogeneous subpopulations that evolve in parallel. Different subpopulations can represent different cell types and each subpopulation can have cell type specific molecular mechanisms. We present statistical methodology that can be used to quantify the effect of heterogeneity and to infer the subpopulation specific molecular interactions. After a proof of principle study with simulated data, we apply our methodology to analyze the differentiation of human Th17 cells using time-course RNA sequencing data. We construct putative molecular networks driving the T cell activation and Th17 differentiation and allow the cell populations to be split into two subpopulations in the case of heterogeneous samples. Our analysis shows that the heterogeneity indeed has a statistically significant effect on observed dynamics and, furthermore, our statistical methodology can infer both the subpopulation specific molecular mechanisms and the effect of heterogeneity. Availability and Implementation: An implementation of the method is available at http://vecuum.sourceforge.net/
IntroductionThe capability of a cell to transform from one cell type to several more specialized cell types is crucial for the development of any multicellular organism. Besides developmental processes, cell specification is essential, e.g. for the immune system, particularly for its adaptive arm, where T and B cells respond and differentiate upon external signals. Cell differentiation processes are typically guided by extracellular signals which activate and control intracellular mechanisms in a cell type specific way and, eventually, change the cell's gene expression pattern towards the pattern of a more specialized cell type. Given the central role of cell differentiation in biology, there is a keen interest to achieve a detailed understanding of the molecular mechanisms that drive differentiation processes and, especially, to understand the mechanisms that steer the activation of cell type specific regulatory programs. Among other approaches, mathematical modeling has been used to learn and predict molecular dynamics of cell differentiation processes (). Mathematical modeling can be especially useful when it is combined with time-course data by means of statistical techniques (). Using this approach, different hypotheses about the underlying molecular mechanisms and interactions are quantitatively expressed in the form of mathematical models and, further, the models can be objectively evaluated with respect to experimental data using well-defined statistical methods. In a typical setting, the models are informed using population average measurements, which are informative about the mechanisms of interest only if they come from a homogeneous cell culture. If the underlying cell culture turns out to be heterogeneous, the standard approaches can fail or provide unreliable results. In the context of cell differentiation, it is rather common that the cell culture of interest is a mixture of several cell types. For instance, if we consider a population of Type A cells which are either activated to Type B cells or stimulated to differentiate into Type C cells, it might be that only a fraction of the cells respond to the stimulation and the resulting cell culture is a mixture of Type B and C cells. When these kinds of data are analyzed, the possible heterogeneity needs to be taken into account properly. The importance of heterogeneity modeling has been acknowledged also in other studies (). In their recent study,developed ordinary differential equation (ODE) constrained mixture models that can be used to detect dynamically distinct subpopulations using population snapshot data, such as FACS measurements. We also aim to detect dynamically distinct subpopulations and use ODEs to model molecular mechanisms. However, our approach is different in that we inform our models using population average sequencing data and, along with subpopulation detection, we explicitly infer the subpopulation specific regulatory mechanisms (i.e. network structures) from data. Further, we outline advanced statistical tools that can be used to quantitatively assess the significance of the modeling results. In summary, we develop a novel modeling approach that can be applied to analyze cell differentiation dynamics in the presence of several co-existing cell types. We show how this approach can be used to detect the heterogeneity of the underlying cell culture and to infer cell type specific molecular interactions. We derive our model for naive human CD4  helper T (Th) cells that are induced to polarize towards Th17 lineage but, nevertheless, our approach is fully general. In our Th17 cell differentiation application, we construct alternative models for the core regulatory network driving the Th17 polarization in the form of ordinary differential equations and combine the alternative models with different hypotheses about the possible heterogeneity of underlying cell culture. To carry out quantitative model and parameter inference, we combine these models with time-course RNA sequencing (RNA-seq) data using a recently published statistical framework that is specifically designed for sequencing count data. Our results show that the proposed modeling approach works well for both simulated and experimental data. Further, to the best of our knowledge, we are the first ones to analyze the regulatory mechanisms that steer human Th17 lineage specification by means of data-driven mathematical modeling.