Motivation: Population low-coverage whole-genome sequencing is rapidly emerging as a prominent approach for discovering genomic variation and genotyping a cohort. This approach combines substantially lower cost than full-coverage sequencing with whole-genome discovery of low-allele frequency variants, to an extent that is not possible with array genotyping or exome sequencing. However, a challenging computational problem arises of jointly discovering variants and genotyp-ing the entire cohort. Variant discovery and genotyping are relatively straightforward tasks on a single individual that has been sequenced at high coverage, because the inference decomposes into the independent genotyping of each genomic position for which a sufficient number of confidently mapped reads are available. However, in low-coverage population sequencing, the joint inference requires leveraging the complex linkage disequilibrium (LD) patterns in the cohort to compensate for sparse and missing data in each individual. The potentially massive computation time for such inference, as well as the missing data that confound low-frequency allele discovery , need to be overcome for this approach to become practical. Results: Here, we present Reveel, a novel method for single nucleotide variant calling and genotyp-ing of large cohorts that have been sequenced at low coverage. Reveel introduces a novel technique for leveraging LD that deviates from previous Markov-based models, and which is aimed at computational efficiency as well as accuracy in capturing LD patterns present in rare haplotypes. We evaluate Reveels performance through extensive simulations as well as real data from the 1000 Genomes Project, and show that it achieves higher accuracy in low-frequency allele discovery and substantially lower computation cost than previous state-of-the-art methods. Availability and implementation: http://reveel.stanford.edu/.
IntroductionIdentification of genomic variation in human DNA sequences is a key first step in associating alleles with human traits and diseases (). Genome-wide association studies (GWAS) have successfully linked genetic variation across thousands of genotyped individuals and hundreds of traits (). Beyond human, association of genomic variations with traits has many applications, such as in the quality breeding of plants and livestock (). Despite their success in linking variation with traits, GWAS performed on genotypes have so far failed to explain a large portion of the heritability of common traits and V C The Author 2015. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com diseases such as diabetes, schizophrenia and heart disease (). Genotype-based GWAS have only examined common single-nucleotide polymorphisms (SNPs), and one promising avenue for finding the 'missing heritability' is the association of rare variants with common traits (), also known as the 'common disease rare variant' hypothesis. Many recent efforts have focused on discovering such rare variants in large cohorts through sequencing rather than genotyping (). Algorithms that call SNPs on a single target genome require the sample to be sequenced at a high coverage (30) to confidently differentiate alternate alleles from sequencing errors (). High-coverage sequencing, however, is expensive when applied to large cohorts. Recently, low-coverage sequencing of large cohorts has been proposed as more cost-efficient and informative than sequencing fewer individuals at high coverage (). Many on-going projects have adopted this low-coverage strategy, including the UK10K project (http://www.uk10k.org), the 1000 Genomes Project (), the Cohorts for Heart and Aging Research in Genomic Epidemiology (CHARGE) Project () and multiple participating cohorts in the Haplotype Reference Consortium (http://www.haplotype-reference-consortium.org). Each project sequences thousands of individuals at a relatively low coverage. For example, the 1000 Genomes Project sequenced 2535 whole genomes at depth 46; the CHARGE Project sequenced $5000 whole genomes at depth 7. To leverage the wealth of genomic data that such large-scale population sequencing projects are providing, computational methods that perform accurate and efficient detection and genotyping of rare SNPs in a population are urgently needed. The corresponding computational problem is considerably more challenging than single-sample genotyping from deep sequencing data: to overcome the noise and missing data inherent in low-coverage sequencing, variant detection and genotyping require the joint estimation of all genotypes of all individuals simultaneously and need to infer and leverage the linkage disequilibrium (LD) present in the sequenced cohort. As a result, computation time can become prohibitive and accuracy is harder to achieve for rare alleles. A number of existing computational methods can be applied to population genotyping. Although not designed for analyzing lowcoverage sequencing data, SAMtools (), GATK Unified Genotyper () and Beagle () can perform population genotyping (). In particular, applying GATK Unified Genotyper to 62 CEU samples from the 1000 Genomes Project pilot phase collectively, followed by Beagle, leads to reasonably accurate genotyping for common polymorphisms (). QCALL () employs a dynamic programming algorithm to estimate, for every position of the genome, the posterior probability of presence of an alternate allele in the cohort. The QCALL algorithm then constructs a set of possible ancestral recombination graphs from samples to estimate the SNP posterior probability for each site in each sample from these graphs. The glfMultiples  Thunder pipeline employs a hidden Markov model (HMM) that leverages LD information across a population to genotype likely polymorphic sites, and is currently considered the state of the art for accurate genotyping of populations using sequencing data (). In the underlying HMM, each hidden state is a pair of reference haplotypes, which are most closely related to the sample being considered, and observations are genotype likelihoods. To apply this HMM on a sequenced cohort, the sequenced individuals are used as references. SNPTools () estimates genotyping likelihoods at putative polymorphic sites using a BAM-specific binomial mixture model, in which the parameters are empirically estimated using an expectationmaximization (EM) algorithm. With the resulting genotyping likelihoods, SNPTools utilizes a HMM approach based on the statistical LD pattern model proposed in () to infer genotypes and haplotypes. This method restricts the number of parental haplotypes to reduce the computation overhead. Despite their considerable success, existing genotyping methods are not ideally suited for application to large cohorts (5000 1 000 000 individuals) because of their prohibitive computation time, as well as their reduced accuracy when calling low-frequency genomic variants, which are hard to differentiate from sequencing errors. In particular, the HMM model underlying Thunder links polymorphic sites to surrounding mosaics, modeling these links using a first-order Markovian model. However, the presence of low frequency (0.55%) and rare (0.5% frequency) variants hierarchically breaks the common haplotypes into many uncommon or rare haplotypes, reducing the fit to a model with an underlying Markovian assumption. Additionally, given a cohort of size n, the HMM requires On 2  hidden states, which results in prohibitively high computational overhead as n increases. The SNP detection dynamic programming algorithm of QCALL, on the other hand, is more computationally efficient because it does not account for the non-random associations between loci, but its accuracy is reduced for the same reason. Here, we present Reveel, a novel method for large-scale SNP discovery and genotype imputation using low-coverage sequencing data sets. Reveel leverages the underlying complex LD structure by employing a simplified model that scales linearly with the number of individuals in a cohort for a given number of imputed SNPs, while producing highly accurate genotype calls for both high-and lowfrequency SNPs. We evaluate the performance of Reveel on simulated data, as well as real data and demonstrate that Reveel achieves significant improvements in both efficiency and accuracy over previous state-of-the-art population-scale genotyping methods, making Reveel a practical approach for large-scale population genotyping.
DiscussionA rare genetic variant that originated from a recent mutation event tags many of the other genetic variants surrounding it, as these were present at that time, including variants at long genetic distance from it; rare variants present an extremely high LD, yielding long rare haplotypes. The nearest-neighbor concept in Reveel uniquely leverages this observation: common SNPs tend to have nearest neighbors that are proximal in genetic distance, while rare SNPs tend to have nearest neighbors that are much more distant (Supplementary, Supplementary); moreover, the allele frequencies of target SNPs and their nearest neighbors are in almost perfect linear correlation (Supplementary). HMM-based methods face a tradeoff between either explicitly modeling each rare haplotype, which leads to computational overhead due to the large number of parameters, or compressing the state space which leads to the loss of long-distance rare-haplotype LD information. In particular, previous state-of-the-art methods, such as MaCH and Thunder, apply a first-order Markovian model between two subsequent haplotypic positions. While such models have been demonstrated to work well for genotyping common variants, they face a challenge in modeling rare variants. On the lower side of the rare SNPs spectrum ( 0.1%), the incorporation of LD information in previous methods did not improve the genotyping accuracy in the 1000 Genomes Project Phase 1; rather, the resulting. Genotyping accuracy evaluated using HapMap3 benchmark. Genotyping accuracy was evaluated using the genotypes of 50 ASW, 90 CEU, 94 CHB, 93 GIH, 97 JPT, 90 LWK, 56 MXL, 96 TSI, and 103 YRI samples reported by HapMap 3 as the benchmark. The blue bars represent the genotyping accuracy of Reveel  Beagle. For the other three methods, the bars show the difference from Reveel  Beagle: orange indicates lower accuracy than Reveel  Beagle; green indicates higher accuracy than Reveel  Beagle genotyping accuracy was modestly lower than when not using LD information (). The explanation underlying this phenomenon may be as follows. Although rare haplotypes share common variants, they usually contain distinct rare variants that can serve as a signature. Leveraging those correlations within a simple Markovian model is impractical: every rare haplotype needs to be encoded in the model, captured as a distinct sequence of states in the HMM. The HMMs underlying currently available methods tend to eliminate rare alleles as noise, which contributes to biases towards homozygous reference. Conversely, to infer genotypes, our approach aims to identify the most informative sites in a way that is less sensitive to their genetic distance. The strategy is different from previous models that implicitly weaken the association between remote sites. By focusing on the most informative markers based on their LD, our method provides considerable improvement in the genotype calling of rare variants. High AF SNPs are caused by one or more mutation events that occurred in the distant past; after many generations of recombination, the LD between high AF sites could become very complex. Therefore, perfect LD between a high AF site and a set of surrounding sites may not exist. In this particular case, genotype phasing on common variants is a useful complementary method to our genotype-calling algorithm. We incorporate a post-processing step into Reveel in the Reveel  Beagle pipeline: after imputing the genotypes and genotype probabilities at likely polymorphic sites, we pick SNPs with AF  1% and feed their genotype probabilities into Beagle () for phasing. Finally the output dosages of Beagle are merged with the genotypes at rare SNPs. An important feature of our algorithm at high AF sites is providing high-quality genotype probabilities. To demonstrate this point, we conducted an experiment for comparison, labeled as Reveelgatk-beagle. In this experiment, we forced GATK to make calls across the sites identified by our algorithm with AF  1%. Then, Beagle was trained on the outputs of GATK, producing dosages at these sites. Finally, we merged the outputs of Beagle and the genotypes called by our algorithm at rare SNPs for evaluation. The only difference between this approach and our Reveel  Beagle pipeline is which tool was used to created genotype probabilities. The comparison shown in Supplementaryclearly illustrates that Reveel  Beagle outperforming Reveel-gatk-beagle. The running time of Reveel scales linearly with the number of individuals n and linearly with the number of polymorphic sites m in our algorithms, expect that the process of estimating LD between every pair of polymorphic sites requires m 2 computations. As we restrict the LD estimation within windows of size 500 kb1 Mb (see Section 2), m is usually within the range of a few thousands depending on the size of the studied cohort, which results in practical running times in our experiments. Reveel has been demonstrated to be robust to high variability of sequencing depth across loci and individuals. The 1000 Genomes Project Phase 3 data set used in our experiments has non-uniform sequencing coverage: the mapped coverage of 2535 samples in the studied region ranges from 2.13 to 35.3, with mean value 6.99 and standard deviation 2.56. The average coverage of these loci across the cohort ranges from 0.0197 to 20.7, with standard deviation 1.19. In summary, Reveel is a highly accurate and efficient tool for single nucleotide variation calling and genotyping of large cohorts of low-coverage sequenced individuals. In future work, similar techniques may be applied to leverage a population's LD to provide rapid and accurate genotyping of other types of variation, such as insertions, deletions and structural variants.