Motivation: Immunoglobulin heavy chain genes are formed by recombination of genes randomly selected from sets of IGHV, IGHD and IGHJ genes. Utilities have been developed to identify genes that contribute to observed VDJ rearrangements, but in the absence of datasets of known rearrangements, the evaluation of these utilities is problematic. We have analyzed thousands of VDJ rearrangements from an individual (S22) whose IGHV, IGHD and IGHJ genotype can be inferred from the dataset. Knowledge of this genotype means that the Stanford_S22 dataset can serve to benchmark the performance of IGH alignment utilities. Results: We evaluated the performance of seven utilities. Failure to partition a sequence into genes present in the S22 genome was considered an error, and error rates for different utilities ranged from 7.1% to 13.7%. Availability: Supplementary data includes the S22 genotypes and alignments. The Stanford_S22 dataset and an evaluation tool is available at
INTRODUCTIONEffective responses to the antigenic diversity of the microbial world require the human immune system to produce antibodies with specificities of similar diversity. The genetic diversity necessary to encode such an antibody repertoire is generated by recombination, for immunoglobulin genes are created by the joining of a number of genes. As each B cell develops within the bone marrow, the rearranged immunoglobulin heavy chain (IGH) variable region genes are created by essentially random recombination of single IGHV (V), IGHD (D) and IGHJ (J) genes, each selected from sets of germline genes (). During the recombination process, the recombining gene ends can be trimmed, and variable numbers of non-template encoded nucleotides may be inserted between the recombining genes. Additional diversity is generated during an immune response by the process of somatic hypermutation (SHM) (), which can lead a rearranged VDJ gene of around 370 nts to accumulate in excess of 30 point mutations. * To whom correspondence should be addressed.The processes of VDJ recombination and SHM, when combined with the high similarity of many of the genes, lead to difficulty in identifying the germline contributions to IGH rearrangements. This is particularly true of the D genes, which range in length from just 1137 nt. A number of utilities have been developed to identify the germline origins of VDJ rearrangements. We have previously used sets of clonally related sequences to evaluate such utilities (). This provided a useful test, but as rearrangements with differing characteristics (long D, short D, highly mutated, etc.) present different challenges for the utilities, larger and more varied datasets are required for proper evaluation. Here we present an evaluation of IGH alignment utilities based on alignment of large 454 sequencing datasets from single individuals. The method is explored using the Stanford_S22 dataset. The many thousands of VDJ rearrangements in this dataset allow the individual genotype at the IGH variable gene loci to be inferred (). By assessing the number of alignments made to genes that are absent from the individual genotype using our evaluation tool, such datasets of rearrangements can be used for evaluation and improvement of IGH alignment utilities.
DISCUSSIONNo VDJ rearrangement can be partitioned with absolute certainty, but any alignment made to genes that are absent from the genome of the individual under study must be in error. This study did not attempt to identify all incorrect alignments, but rather it detected errors by reference to an individual's inferred genotype, providing a measure of the minimum frequency of misalignments for each utility. The S22 genotype was independently determined using three utilities. These genotypes were found to be in agreement, with the exception of minor differences resulting from the presence of allelic variants in the S22 genotype that are not present in all repertoires, and misalignment of very infrequently rearranged genes. The inferred rearrangeable V, D and J genes of the S22 genome are available as Supplementary Tables S1, S2 and S3, respectively. S22 carries an apparent homozygous deletion of six contiguous D genes () and is homozygous at the five other D loci where allelic variants exist. The IGHD6-25 gene, which we have previously suggested is non-functional (), was also absent from the S22 genome. These features make the S22 dataset particularly useful for the evaluation of utility performance on D gene alignment. The alignment of D genes is one of the most difficult challenges in the partitioning of VDJ rearrangements and the nature of the challenge varies between D gene families.The output from each utility was compared with the S22 genotype, and all errors were noted. The results for each utility are summarised asand detailed as Supplementary Tables S4S10. Overall, errors were made in the alignment of between 7.1% (iHMMunealign) and 13.7% (Ab-origin) of all sequences. Six unofficial V polymorphisms, previously inferred from sequence analysis (), are seen in the S22 genome. These polymorphisms were present in 9.4% of all S22 VDJ genes, according to the iHMMune-align analysis. While failures to identify these polymorphisms were not scored as errors here, unless alignment utility repertoires incorporate these newly identified polymorphisms, an additional source of substantial error will remain.
CONCLUSIONAnalysis using the Stanford_S22 dataset demonstrates how 454 sequence datasets can be used to evaluate the performance of IGH alignment utilities. Analysis found the fewest definitive misassignments of the IGH genes for iHMMune-align, JOINSOLVER and IgBLAST. This approach should now allow the performance of all utilities to be further refined.