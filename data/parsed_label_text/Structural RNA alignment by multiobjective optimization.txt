Motivation: The calculation of reliable alignments for structured RNA is still considered as an open problem. One approach is the incorporation of secondary structure information into the optimization criteria by using a weighted sum of sequence and structure components as an objective function. As it is not clear how to choose the weighting parameters, we use multi-objective optimization to calculate a set of Pareto-optimal RNA sequence-structure alignments. The solutions in this set then represent all possible trade-offs between the different objectives, independent of any previous weighting. Results: We present a practical multi-objective dynamic programming algorithm, which is a new method for the calculation of the set of Pareto-optimal solutions to the pairwise RNA sequence-structure alignment problem. In selected examples, we show the usefulness of this approach, and its advantages over state-of-the-art single-objective algorithms. Availability and implementation: The source code of our software (ISO Cþþ11) is freely available at
INTRODUCTIONThe central role of RNA is that of being a messenger between transcription and protein translation. However, it is known that non-coding RNA molecules have a wide range of functions in the cell, like catalysis of chemical processes or in gene regulation, and it is assumed that RNA played a central role in the early stages of life (). As the functionality of RNA molecules is not only defined by their primary sequences but also the interaction of their base pairs, their secondary structure is well conserved during evolution (). Based on this observation, RNA can be organized into families with similar sequences and secondary structures. The Rfam database () is a collection of RNA sequences, arranged in currently 1973 different families, each represented by a multiple alignment of its members. When the sequence similarity is too low, the construction of reliable sequence alignments is impossible (). In this case, structural information can be used as another criterium to improve these alignments. Although much work has already been put into the development of sequence alignment methods, especially those for multiple sequences (), RNA sequence-structure alignment can still be considered as an open problem (). RNA secondary structure consists of base pairs i k , j k , i k 5j k (positions from 5 0 to 3 0 ) between nucleotides of an RNA sequence. Through stacking effects, these base pairs tend to form helices and various kinds of loops (seefor an example). For complexity reasons, we will restrict ourselves to non-crossing structures that forbid so-called pseudo-knots. This means that if we have two base pairs i 1 , j 1  and i 2 , j 2  with i 1 5i 2 , it follows that either i 1 5j 1 5i 2 5j 2 or i 1 5i 2 5j 2 5j 1. There are various methods that predict a secondary structure from a single RNA sequence by free-energy minimization, like the dynamic programming algorithm of Zuker and Stiegler (1981). However, it is known that the prediction of the structure of related RNA sequences can be improved by comparative methods (). Most structure prediction tools only calculate noncrossing structures, but there are algorithms that predict structures with pseudo-knots. Therefore, they follow a hierarchical approach of predicting the secondary structure first and the pseudo-knots subsequently (), even if recent works show that tertiary interactions emerge early in the RNA folding process and suppress incorrect structures (). One RNA molecule can have the ability to fold into different 'suboptimal' structures, which differ from each other in their stability. McCaskill (1990) gives an efficient algorithm that calculates all secondary structures, together with their occurrence probability in a thermodynamic equilibrium. The result is a matrix of probabilities P, where an entry at position (i,j) reflects *To whom correspondence should be addressed.. Example of a RNA molecule. The primary sequence is the sequence of nucleotides (encircled), whereas the base pairings (in light grey) between nucleotides make up the secondary structure the probability of the bases at positions i and j to form a base pair. More precisely, P ij is the sum of probabilities of all secondary structures that have a base pair between the nucleotides at positions i and j. To our knowledge, Sankoff's algorithm () was the first to solve the alignment and folding of RNA simultaneously. In its pairwise version, it has a time and space complexity of On 6  and On 4 , respectively, and as a consequence, it is often considered too expensive for a practical application. A simplified and more efficient variant of the Sankoff algorithm is Foldalign (), which uses a restricted energy model to reduce the time and space complexity, where Dynalign () features the full energy model, but it reduces the number of reasonable alignments by limiting the range of positions of matching nucleotides. Recently,even presented an exact and efficient algorithm that uses sparsification to significantly enhance the runtime behaviour. Another popular implementation is LocARNA (), which is based on the work of, and it incorporates structural information into the alignment process in the form of pre-calculated base pair probabilities. It finds an optimal sequence-structure alignment that maximizes an objective function, which is a weighted sum of a sequence alignment score and the sum of base pair probabilities of a consensus secondary structure. All these alignment methods depend on fixed weighting parameters for their sequence and their structure objectives, which have to be estimated or optimized. Depending on the type of RNA or the degree of structure conservation, a fixed weighting can lead to undesirable sequence-structure alignments. A change of these parameters can have a great influence on which consensus structure is considered as optimal. We treat the sequence alignment and the consensus structure calculation as separate objectives, and we solve both problems simultaneously with a new multi-objective dynamic programming algorithm (). The result is not one single solution that is optimal in some sense, but a set of Pareto-optimal solutions. This technique has been applied successfully in different fields like the multi-objective routing problem () or the knapsack problem with multiple criteria (). In the bioinformatics area,construct a set of Pareto-optimal alignments of biological sequences by treating the number of gaps and the scores for (mis)matches as separate objectives. Taneda (2010) gives an evolutionary algorithm for pairwise RNA sequence alignment that incorporates RNA structure information to approximate a set of Paretooptimal solutions. Although it also uses the theory of dominating vectors, it only calculates a rough approximation of the set of Pareto-optimal alignments. Apart from that, it depends on many parameters that influence the quality of approximation, as well as the runtime behaviour. We now present an algorithm that calculates the exact set of Pareto-optimal solutions.