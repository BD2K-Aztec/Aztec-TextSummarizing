Motivation: In the context of studying whole metabolic networks and their interaction with the environment, the following question arises: given a set of target metabolites T and a set of possible external source metabolites S, which are the minimal subsets of S that are able to produce all the metabolites in T. Such subsets are called the minimal precursor sets of T. The problem is then whether we can enumerate all of them efficiently. Results: We propose a new characterization of precursor sets as the inputs of reaction sets called factories and an efficient algorithm to decide if a set of sources is precursor set of T. We show proofs of hardness for the problems of finding a precursor set of minimum size and of enumerating all minimal precursor sets T. We propose two new algorithms which, despite the hardness of the enumeration problem, allow to enumerate all minimal precursor sets in networks with up to 1000 reactions. Availability: Source code and datasets used in our benchmarks are freely available for download at http://sydney.edu.au/science/biology/meep/softwarel.
INTRODUCTIONWe recently introduced the concept of a minimal precursor set which corresponds to a set of metabolites that an organism may obtain from its environment and that enables it to produce a set of metabolic targets of interest (seefor the initial definition of this concept). In this model, we propose a definition of precursor set which does not consider the stoichiometry of reactions. Indeed, the values given for such stoichiometry may often not be accurate. For instance, 51% of the reactions in the Kyoto Encyclopedia of Genes and Genomes (KEGG) were considered to be unbalanced in 2004 () and solving these cases may become challenging for more complex reactions (). To overcome this problem, we propose instead a model based only on the topology of a metabolic network, that is that considers the set of substrates and products of each reaction without considering the amounts involved. The collection of precursor sets defined should therefore be considered as potential/candidate solutions which could be confirmed or discarded a posteriori by other sources of information. The method we developed into enumerate all minimal precursor sets for a given set of targets was then applied into a relatively complex symbiotic system. In this case, the environment was represented by an insect. Homalodisca coagulata, which hosts within its cells two bacteria, respectively, Baumannia cicadellinicola and Sulcia muelleri. The identification of the precursor sets for the sets of metabolites each bacterium gives to the symbiotic system (host and co-resident endocytobiont), enabled to refine the analysis that had been done previously () of the complementarity between the metabolisms of the two bacteria and their host. It also suggested that both B. cicadellinicola and S. muelleri might be completely independent of the metabolites output by the co-resident endocytobiont to produce the carbon backbone of the metabolites provided to the symbiotic system. The algorithms in Cottret et al. (2010a) and Cottret et al.(2008) suffered of a memory problem due to the necessity to construct a huge treecalled the 'replacement tree'. Moreover, the enumeration procedure followed using such a tree was not the most efficient way either to enumerate all minimal precursor sets. For small networks (5250 nodes), the previous method runs in a acceptable time, but for bigger networks it usually runs out of memory. In this article, we present new algorithms for enumerating all minimal precursor sets that address both memory requirements and time efficiency (Section 4). We also provide full proofs for the complexity results that were just indicated in(Section 3). We use for this a simpler characterization of a *To whom correspondence should be addressed. y The authors wish it to be known that, in their opinion, the first two authors should be regarded as joint First Authors.precursor set that makes the concept, and the subsequent proofs, formally easier to grasp (Section 2). Finally, we show by extensive tests that the new algorithms are indeed able to deal with much larger networks, up to 1000 reactions (Section 5).
CONCLUSIONDespite the proved hardness of enumerating all precursor sets of a given target, the algorithms presented in this article can find all solutions for networks of up to around a 1000 reactions. If we restrict ourselves to the benchmark built for this article, the TRD method with minimality check is the one that presented the best behaviour on average. However, the methods vary widely depending on the target chosen. Our benchmark does not allow us to conclude which algorithm has a better performance between TRD with a minimality test and NS with and without minimality test for bigger networks. This justifies the utility of each method individually and leaves an open space for further improvements. Funding: This work was partially funded by the following projects: the French project ANR MIRI BLAN08-1335497, the French project ANR NEMO ANR-08-BLAN-0304-01, the ERC Advanced Grant Sisyphe held by Marie-France Sagot, the INRIA Associated Team SIMBIOSI, the INRIA International Partnership AMICI, the Dutch NWO-CLS MEMESA project and the Chilean FONDAP 15090007 project. Conflict of Interest: none declared.