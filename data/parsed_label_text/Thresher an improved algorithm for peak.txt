Motivation: This article presents Thresher, an improved technique for finding peak height thresholds for automated rRNA intergenic spacer analysis (ARISA) profiles. We argue that thresholds must be sample dependent, taking community richness into account. In most previous fragment analyses, a common threshold is applied to all samples simultaneously , ignoring richness variations among samples and thereby compromising cross-sample comparison. Our technique solves this problem, and at the same time provides a robust method for outlier rejection, selecting for removal any replicate pairs that are not valid replicates. Results: Thresholds are calculated individually for each replicate in a pair, and separately for each sample. The thresholds are selected to be the ones that minimize the dissimilarity between the replicates after thresholding. If a choice of threshold results in the two replicates in a pair failing a quantitative test of similarity, either that threshold or that sample must be rejected. We compare thresholded ARISA results with sequencing results, and demonstrate that the Thresher algorithm out-performs conventional thresholding techniques. Availability and Implementation: The software is implemented in R, and the code is available at http://verenastarke.wordpress.com
INTRODUCTIONThis article presents a new peak thresholding algorithm called 'Thresher' that treats samples and replicates independently, taking their richness into account. We will demonstrate that the Thresher algorithm (and the software of the same name that implements it) offers improved performance over previous approaches to thresholding. DNA profiling or fingerprinting techniques are essential to microbial ecology. For example, automated rRNA intergenic spacer analysis, or ARISA (), and terminal restriction fragment length polymorphism, or T-RFLP (), are widely used. These techniques depend on fluorescent-labeled DNA fragments, discriminating the sizes of fragments present in a sample. Analysis profiles are typically run in replicates.When analyzing ARISA or T-RFLP electropherogram profiles, instrument noise and sample noise are typically present. Instrument noise refers to artifacts produced by the instrument and is usually removed by applying a conservative minimum peak height threshold to the raw electropherograms (). Sample noise, in contrast, refers to false peaks that can result from Polymerase Chain Reaction (PCR) artifacts or sample contaminants, and is normally dealt with by applying an additional threshold based on the percentage of total amplified DNA. It is particularly important to set such thresholds carefully when techniques based on the presence or absence of peaks are to be used in the subsequent analyses (), as presence/absence analyses disproportionately weight weak peaks. We argue that the threshold used to eliminate sample noise must be sample dependent. In past works, such thresholds have typically been applied across a whole sample set, treating all samples identically (). The normal procedure in ARISA data reduction is to standardize data, allowing for more direct comparison of samples with one another. Each standardized peak height gives the percentage of the total counts of peaks for that replicate or sample. This procedure is particularly important when ARISA runs differ in their peak intensity. In most previous ARISA processing procedures, a common threshold is applied to all samples after standardization. However, a problem can arise when cross-comparing standardized samples to which a common threshold has been applied, because such a comparison ignores richness variations among samples. Samples with similar peak heights but different richness can be standardized to dramatically different percentages because of variations in the amount of total counts. Therefore, two samples with different richness but similar peak heights can have different percentages for equivalent peaks, reducing their effective height in the richer sample. This effect can put true data peaks below a threshold for a rich sample, resulting in unwanted data loss. So, instead of using a common threshold across all samples, it is important to select thresholds that are sample dependent and take richness into account. A similar problem can arise when comparing two replicates in a pair. For example, a replicate pair can be identical in data peak distribution and sample noise level, except that the peaks in one *To whom correspondence should be addressed.  The Author 2014. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com replicate have lower intensities than equivalent peaks in the other. Standardization will equalize the sample, causing noise peaks to gain weight in the lower intensity replicate. Some noise peaks could then be counted as data peaks if not thresholded properly. Again, it is more appropriate to apply a properly chosen threshold to each replicate separately. This article presents an improved technique for finding peak height thresholds for ARISA profiles and similar data. Our technique also provides a robust method for outlier rejection, selecting for removal any replicate pairs that are so different from one another that they cannot be considered useful replicates.