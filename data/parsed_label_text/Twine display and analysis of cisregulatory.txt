Many algorithms analyze enhancers for overrepresentation of known and novel motifs, with the goal of identifying binding sites for direct regulators of gene expression. Twine is a Java GUI with multiple graphical representations (Views) of enhancer alignments that displays motifs, as IUPAC consensus sequences or position frequency matrices, in the context of phylogenetic conservation to facilitate cis-regulatory element discovery. Thresholds of phylogenetic conservation and motif stringency can be altered dynamically to facilitate detailed analysis of enhancer architecture. Views can be exported to vector graphics programs to generate high-quality figures for publication. Twine can be extended via Java plugins to manipulate alignments and analyze sequences. Availability: Twine is freely available as a compiled Java .jar package or Java source code at
INTRODUCTIONTranscription is controlled by binding of sequence-specific transcription factors to DNA sequences near a gene. These binding sites are organized into modules called cis-regulatory modules or enhancers (). Understanding how specific combinations of binding sites lead to the precise control of gene expression in developmental patterns or in response to physiological regulation is a major goal of modern biology. Many software tools have been devised to aid in deciphering cis-regulatory logic, by predicting binding sites for known transcriptional regulators or by identifying putative motifs for novel regulators. Databases of in vitro and in vivo binding specificities for thousands of transcription factors enable predictions of possible regulators for an enhancer of interest (). Various algorithms search for enrichment of short sequences (motifs) above statistical 'noise' (reviewed in). However, most program outputs are either text-based or output graphical representations as raster images (), and it is tedious to manually annotate enhancers with binding site predictions. Genome browsers () and gene browsers () map binding sites and functional genomic information on the whole-genome and single-gene scales in a dynamic fashion that allow greater user control. Twine complements these programs as an interactive graphical tool to analyze and compare enhancers. Twine displays the most common information used by researchers (motif locations and evolutionary conservation) in several intuitive 'Views' to help analysis and prediction of regulatory information, and the Views can be exported as vector graphics files to generate figures with scaled representations of conservation and motif locations. independently set, allowing control over match density. Strength of each match is indicated by opacity of each block; the range of opacity and threshold are user-adjusted. Clicking on graphical representations of the alignments (Comparison View or Conservation Views) automatically moves the Sequence View to the appropriate location. Once a matrix is added, thresholds can be adjusted 'on-the-fly' using a slider to adjust the similarity threshold [the threshold score is the negative log of the product of each position's frequency in the matrix; therefore, zero is the most stringent possible score (. To identify conserved motifs in non-optimal alignments and compensatory binding site shifts, the 'drift' of matches between species from linear alignment can be increased so that these will be considered 'conserved' (Supplementary). Matches can also be filtered to display only matches conserved at the current threshold. Motif libraries can be saved to organize collections, and they can be imported en masse from text files containing motif matrices in commonly used formats (e.g. JASPAR). Motif libraries can be filtered using strings (literal or regular expression) matching motif descriptors (Supplementary). Using zeroto third-order Markov Chain background models (), enrichment of each motif over the background model are calculated using binomial () and Poisson distributions. After opening enhancer alignments and adding motifs, the organization and conservation of binding sites within each enhancer, as well as patterns of motif clustering between enhancers, can be identified in the different Views. When threshold parameters have been adjusted to user specification, each View can be saved as Scalable Vector Graphics (SVG) files, where each element can be independently manipulated by programs, such as Adobe Illustrator or Inkscape. In addition to SVG outputs of each alignment view, sub-alignments can be saved in FASTA format by drag-selecting a region in the Aligned Species or Conservation Plot Views and saving the selection as FASTA alignments. Thus, potential 'minimal' enhancers from larger fragments can be extracted by analyzing the conservation patterns and clustered binding sites of likely regulators. Alignment data, motif statistics and the set of all motif matches can be exported as a tab-delimited file for further analysis. To generate representations of all deletions or binding site mutations of a given enhancer (such as from in vitro mutagenesis experiments), an alignment of the wild-type sequence to sequences with each variant can be opened in Twine. Inputting motifs for tested binding sites generates an Aligned Sequence view indicating presence or absence (or deletion) of all tested variants (Supplementary). Using a plugin interface implementing the Java Simple Plugin Framework, AlignedSequence objects (a custom Java class containing all alignments and motifs) can be sent to user-written Java plugins, modified (e.g. aligned, analyzed and manipulated), then returned to Twine for display. Several example plugins, as well as a template, are included. Future work includes expanding the suite of plugins and supporting manual adjustments to alignments.and an unidentified motif (Motif-1), and position frequency matrices for Snail, Twist and Dorsal (from FlyFactorSurvey) were added (). The Comparison View displays all four enhancers, with dark blocks representing regions conserved in at least 75% of species (specified by Threshold). The single-minded (sim) mesectoderm enhancer is displayed in the Conservation View and Sequence View. Organization and conservation of motif matches can be visualized at multiple scales and thresholds and exported to vector graphics programs