Motivation: High-dimensional single-cell snapshot data are becoming widespread in the systems biology community, as a mean to understand biological processes at the cellular level. However, as temporal information is lost with such data, mathematical models have been limited to capture only static features of the underlying cellular mechanisms. Results: Here, we present a modular framework which allows to recover the temporal behaviour from single-cell snapshot data and reverse engineer the dynamics of gene expression. The framework combines a dimensionality reduction method with a cell time-ordering algorithm to generate pseudo time-series observations. These are in turn used to learn transcriptional ODE models and do model selection on structural network features. We apply it on synthetic data and then on real hematopoietic stem cells data, to reconstruct gene expression dynamics during differentiation pathways and infer the structure of a key gene regulatory network. Availability and implementation: Cþþ and Matlab code available at https://www.helmholtz-muenchen.de/fileadmin/ICB/software/inferenceSnapshot.zip.
IntroductionUnraveling the dynamics of gene regulatory programs is a challenging problem, due to multitude of variables and mechanisms involved in the gene control machinery. As genes represent fundamental units in regulatory networks, the problem is commonly restricted to understand how they interact and express themselves, to generate specific biological functions. This gave rise to a variety of mathematical methods which, combined with experimental measurements, provided a way to reconstruct gene regulatory processes and estimate unknown kinetic parameters. Different classes of approaches have been proposed, from ODE-based models () to stochastic models (), and a number of optimization techniques have been developed for inference and parameter estimation in gene regulatory models (). To learn network dynamics, all these models require temporal data sources, such as mRNA or protein time-courses. However, as recent advances in single-cell technologies offer the possibility to analyse gene expression simultaneously in hundreds of individual cells (), time-course data are not always available for massive single-cell dataset. This prevents from using elaborated methods developed in the last decades on data coming from newest technologies such as single-cell RNA sequencing or high-throughput quantitative polymerase chain reaction. Typically, data from such technologies are given in form of single-cell snapshot data. Broadly, single-cell snapshot data consist of gene expression measurements collected from multiple single cells at a single time point. So defined, they represent static data which reflect single-cell states at a single time point. However, as cells may have different stochastic behaviours during the same process (), a sort of temporal information is still retained in snapshot data. Here, we present a framework which allows to extract gene regulatory dynamics directly from single-cell snapshot data. The framework allows reconstruction of individual network nodes' dynamics, estimation of kinetic parameters and computation of Bayes' factors to determine how network nodes functionally interact. The combination of dimensionality reduction with a clustering method and an efficient algorithm to order single cells by time provides a way to reconstruct gene expression pseudo time courses from different cellular processes. These are used to compare different ODE-based transcriptional models and select the one which best
DiscussionAs mathematical modelling is becoming more and more crucial in supporting experimental research in systems biology, computational frameworks need to constantly evolve and adapt to new technologies. In this context, recent advances in high-dimensional single-cell technologies are providing massive amount of data in form of single-cell snapshot data. Although a number of statistical tools have been developed to model gene expression in snapshot data, they were only able to provide limited insights into biological mechanisms. In particular, as snapshot data do not directly represent how concentration of molecular species changes over time, present methods are only able to extract static information from data. Here, we have presented a framework which allows to reconstruct dynamics of gene network nodes from single-cell gene expression snapshot data. By combining a dimensionality reduction method with an algorithm to time-order single cells, we are able to reconstruct pseudo time-series which provide a good approximation to time-series simulated from the real system. Through an efficient optimization strategy, pseudo time-series are then used to calibrate nonlinear ODE models which explain complex transcriptional dynamics. Furthermore, by computing Bayes' factors, we are also able to refine GRNs structures by selecting among transcriptional models with different structural information, i.e. different logic gates in activation functions. The framework is modular and requires a number of sequential steps, which are independent on each other. This has the advantage that each step can be independently improved, without reducing the efficiency of the entire workflow. Many of these steps, especially dimensionality reduction techniques and parameter estimation methods, have already been studied in great detail. However, to the best of our knowledge, similar comprehensive frameworks have not been yet developed: our idea represents the first example of quantitative modelling GRNs dynamics without using protein or gene expression time-courses but only high-dimensional single-cell snapshot data. Only recently, some approaches have been developed to analyse high-dimensional biological data () and their underlying dynamics () but purely for a visualization purpose or qualitative analyses. Analysis on multiple simulated data sets demonstrates that we are able to infer kinetic parameters describing the underlying dynamics and recover logic gates in activation functions. Results on single-cell snapshot data obtained during blood stem cell differentiation show that we can reconstruct gene expression dynamics along differentiation pathways. Compared with competing strategies, we can not only determine correlations among genes in the GRN but also predict edge directions. In particular, GATA2 was predicted to be inhibited by GFI1 and to activate GFI1B, thus possibly working as a modulator of the known toggle switch between GFI1 and GFI1B. Gene GATA2 has been found to be involved in myeloid leukaemia (); a better understanding of its role will not only help to get more insights into cell decision making but also to gain more knowledge about cancer pathologies. From the computational point of view, our work opens possibilities to several further developments. Although diffusion maps have been proved to resolve nonlinear differences in single-cell expression data (), an improvement in the timeordering algorithm would substantially reduce the error in pseudo time-series. In addition, at the statistical modelling level, we have considered ODE-based transcriptional models without taking into account of intrinsic stochasticity of gene expression. Single cells provide more information with respect to cell populations, but such information could be retrieved only by using stochastic models of gene expression. On the other hand, parameter estimation and model selection with stochastic models are challenging and will require more advanced methods compared with those used in this work (). Despite we restricted the analysis to small/medium size GRNs, we believe that our work may evolve to the analysis of larger network and with more complex dynamics, e.g. including feedback loops. A greedy-type strategy could be adopted in model selection to cope with a larger number of dynamical models. However, an integration of structure inference and dynamics modelling would remain challenging in the case of larger networks ().