Motivation: Sequence similarity searches performed with BLAST, SSEARCH and FASTA achieve high sensitivity by using scoring matrices (e.g. BLOSUM62) that target low identity (533%) alignments. Although such scoring matrices can effectively identify distant homo-logs, they can also produce local alignments that extend beyond the homologous regions. Results: We measured local alignment start/stop boundary accuracy using a set of queries where the correct alignment boundaries were known, and found that 7% of BLASTP and 8% of SSEARCH alignment boundaries were overextended. Overextended alignments include non-homologous sequences; they occur most frequently between sequences that are more closely related (433% identity). Adjusting the scoring matrix to reflect the identity of the homologous sequence can correct higher identity overextended alignment boundaries. In addition , the scoring matrix that produced a correct alignment could be reliably predicted based on the sequence identity seen in the original BLOSUM62 alignment. Realigning with the predicted scoring matrix corrected 37% of all overextended alignments, resulting in more correct alignments than using BLOSUM62 alone. Availability: RefProtDom2 (RPD2) sequences and the FASTA software are available from http://faculty.virginia.edu/wrpearson/fasta.
INTRODUCTIONSequence similarity search algorithms are used to identify evolutionary homologs and to generate hypotheses for the function of unknown proteins. These algorithms assign homology between sequences achieving statistically significant similarity scores with high fidelity, even between highly divergent sequences sharing low similarity (). However, the same methodology that provides for the sensitive identification of homology at low identity can also lead to alignments that include non-homologous sequence adjacent to, or between, higher identity homologous sequences (). Homologous overextension was first identified as a source of error during iterative similarity searches (). Overextension occurs when alignments extend past the boundaries of the homologous region in the library, query or both sequences, leading to the inclusion of non-homologous sequence in an alignment (). The inclusion of non-homologous sequence has been identified in alignments between highly identical DNA sequences () and has been termed the 'mosaic effect' (). Overextension occurs because local sequence alignment boundaries depend on the scoring matrix. The popular BLASTP () tool, along with other sequence alignment tools (e.g. SSEARCH and FASTA;), creates local alignments between similar sequences using scoring matrices. Scoring matrices assign a similarity score to each pair of aligned amino acids based on the probability that the amino acid transition has occurred more often through evolution than by chance. Amino acid replacements that are common through evolution are assigned high similarity scores, whereas rare replacements are assigned negative scores. Scoring matrices have an implicit evolutionary model, which allows different matrices to target different evolutionary distances (). Scoring matrices that target long evolutionary times (deep scoring matrices) allow more amino acid substitutions and gaps, whereas shallower matrices favor higher sequence identity and have higher gap penalties. The scoring matrix dictates the local alignment boundaries; increasing or decreasing the length of the optimal local alignment reduces the total alignment score. Likewise, changing the scoring matrix can result in a different alignment. Ideally, a local alignment of homologous domains in different sequence contexts will align every residue in the homologous region, and no residues outside the domain boundaries, so that the alignment boundaries reflect the domain boundaries. Overextended alignments include additional sequence from outside the homologous domain boundaries. For example, inartificial, randomly shuffled, sequence from the query appears to be homologous to a real protein. In this article, we show that scoring matrices have preferred alignment identities and alignment lengths, and that BLOSUM62 can produce overextended alignments, most often between sequences with433% identity. We also show that using the correct scoring matrix can produce more accurate alignment boundaries. Finally, we show that we can produce more accurate alignment boundaries, even without true domain boundary knowledge, by using the initial BLOSUM62 alignment identity to specify a more appropriate scoring matrix.
DISCUSSIONMismatches between the sequence identity of aligned homologous domains and the target identity of the scoring matrix used to produce the local sequence alignment can lead to overextended alignments (Figs. 1 and 2). Similarity scoring matrices have preferred alignment lengths and identity. Deep scoring matrices create longer alignments and have lower target identity compared with shallower matrices (). Alignments created by BLOSUM62, most often between sequences with higher identity (433%), can extend past the boundaries of the homologous domain to include non-homologous sequence (). Using a shallower scoring matrix that targets the correct sequence identity can correct overextension (). Predicting the scoring matrix that will lead to a better alignment, using initial (possibly overextended) identity given by BLOSUM62, can correct overextended alignments. In our RPD2 database, 37% of overextended alignments were corrected to within AE10 residues, or 86% of the alignments with high enough identity (436%) to be considered for realignment. However, realignment has a cost; a fraction of correctly aligned domains are incompletely realigned. The observation that 'deep' scoring matrices produce overextended alignments between domains that are less evolutionarily distant (have higher identity) than the scoring matrix target identity is not surprising, though the relationship between alignment boundaries (in contrast to internal alignment accuracy) and scoring matrices has not been extensively studied. Traditional internal alignment accuracy decreases as evolutionary distance increases; different sequences are difficult to align accurately. In contrast, alignment overextension occurs most often when closely related sequences are aligned, and thus becomes more frequent as sequence databases grow. As log-odds matrices, every scoring matrix has a target evolutionary distance, or percent identity, which can be approximated from the homologous replacement frequencies that are the numerator of the log-odds ratio (). As evolutionary distance and the number of replacements increase, the replacement frequencies for identities decrease and the non-identical replacement frequencies increase, which reduces the target identity of the matrix when aligning random sequences (). Overextension occurs when a scoring matrix that models a longer period of evolution (a deeper scoring matrix) by allowing more mutations is used to align sequences with less evolutionary change. A deep scoring matrix produces a less identical alignment because it accepts more amino acid replacements. Gap penalties also modify alignment length and identity; increased gap penalties produce shorter higher identity alignments, whereas lower gap penalties produce longer lower identity alignments (). Lower mismatch penalties and lower gap penalties in deep matrices allow the local alignment algorithm to add additional identities that are occurring by chance from non-homologous sequence for the sake of modest increases in score. Thus, in, 83% of the score was produced by 67% of the alignment. Overextended alignments are locally optimal, but they are not biologically correct. RPD2 was designed to simulate the most common similarity searchsearches against full-length proteins in a comprehensive sequence database. RPD2 sequences were selected from the set of sequences annotated by Pfam release 26, which samples both SwissProt and Trembl protein sequences. The RPD2 library is large (528 742 sequences) and diverse. Queries were engineered from long (4200 residues) protein domains, allowing BLOSUM62 searches to identify distant homologs. These domains are surrounded by shuffled protein sequence, providing known alignment boundaries. Alignments that extend into the flanking random sequence are thus guaranteed to be nonhomologous. Our initial searches with 136 independent embedded domain queries produced both incomplete alignments (22% BLASTP, 17% SSEARCH, both with BLOSUM62) and overextended alignments (7% BLASTP, 8% SSEARCH). Incomplete alignments reflect the reduced sensitivity of pairwise alignment compared with the HMM based methods used to annotate the Pfam domains in RPD2, and the fact that in the diverse set of homologous RPD2 domains, half of the detectable homologs share 533% sequence identity. In characterizing 42  200 000 alignment boundaries in the 136 query domain searches, we consider far more distant alignments than would typically be examined during the genome annotation process, where sequences sharing at least 40% identity might be used to transfer annotation. Restricting the analysis to the top 100 significant hits for each query increases the median alignment identity to 53%, which in turn decreases incomplete alignments to 5%, and increases the overextension to 10%. Restricting the analysis to the top 25 homologs further decreases incomplete alignment to 2%, whereas increasing overextension to 11%. When the thresholds inare used to correct thetop 100 alignments for each query, overextension is corrected 73% of the time, whereas incomplete alignments are produced only about 10% of the time. For the top 25, overextension is corrected 86% of the time, whereas alignments become incomplete only 1% of the time. We believe our estimates of alignment overextension (710% of alignments) are conservative, both because sequence databases are growing, allowing similarity searches to identify closer homologs, and because many proteins comprise multiple domains. In this study, we examine alignment overextension from a single domain. Many proteins contain multiple domains separated by non-homologous regions; proteins that contain multiple widely dispersed common domains, like Ankyrin, fn3 or SH3 domains, will have many more chances to overextend across non-homologous regions. Although we understand why high identity alignments might overextend when aligned with low targetidentity scoring matrices like BLOSUM62, matrix/targetidentity mismatch only accounts for about half of the overextensions we observed. In our diverse sequence set, 53% of overextensions occur in alignments that are536% identical. Unfortunately, we cannot predict which lower identity alignments will overextend. The amount of overextension does not correlate well with the difference between alignment identity and scoring matrix target identity. Likewise, overextension does not occur significantly more often in domains that have more identity at their ends. The increased frequency of overextended boundaries in alignments between high identity sequences () is the only meaningful trend that we identified. In contrast to high identity overextension, where the difference in targetidentity between the homologous region and the scoring matrix can explain overextension, low identity overextension may simply reflect the propensity of deep matrices to produce long alignments, even between unrelated sequences (). The long alignments inare not statistically significant, but when they occur by chance near a (low identity) homologous domain, they can contribute to overextension. Overextension occurs more frequently in higher identity alignments because of targetidentity mismatch, but the majority of overextension we measured occurs by chance in low identity alignments, because most of our alignments are low identity. In this study, we have focused on overextension in pairwise alignments because pairwise similarity searches are widely used to annotate newly sequenced genomes. Alignment overextension also occurs with model-based searches like PSI-BLAST; we initially identified overextension as the major cause of model contamination with PSI-BLAST (). Our strategy for reducing overextensionre-alignment with a more correct scoring matrixis most easily applied to pairwise alignment because a traditional nonposition-specific scoring matrix like BLOSUM62 or VT120 has an easily characterized target identity and the alignment between two sequences has a natural evolutionary distance. It is more difficult to interpret the 'distance' between a sequence and a position-specific scoring matrix or HMM, and it is unclear how such models might be scaled to reduce overextension. The expansion of modern protein databases has led to an increase in the identification of higher identity homologs. Accurate function prediction requires a higher level of sequence identity and an accurate alignment, two factors that are at odds with deep scoring matrices. With modern comprehensive databases, it is common to identify many homologs that are 440% identical. In our diverse RPD2 protein set, the median sequence identity for the top 100 homologs was 53%, much higher than the target identity range for BLOSUM62. With more high identity homologs and increased sequence and structural annotation, pairwise alignments can provide essential insights to the function of novel proteins, but only if the alignment boundaries are accurate.