Motivation: The three-dimensional structure of the genome is an important regulator of many cellular processes including differentiation and gene regulation. Recently, technologies such as Hi-C that combine proximity ligation with high-throughput sequencing have revealed domains of self-interacting chromatin, called topologically associating domains (TADs), in many organisms. Current methods for identifying TADs using Hi-C data assume that TADs are non-overlapping, despite evidence for a nested structure in which TADs and sub-TADs form a complex hierarchy. Results: We introduce a model for decomposition of contact frequencies into a hierarchy of nested TADs. This model is based on empirical distributions of contact frequencies within TADs, where positions that are far apart have a greater enrichment of contacts than positions that are close together. We find that the increase in contact enrichment with distance is stronger for the inner TAD than for the outer TAD in a TAD/sub-TAD pair. Using this model, we develop the TADtree algorithm for detecting hierarchies of nested TADs. TADtree compares favorably with previous methods, finding TADs with a greater enrichment of chromatin marks such as CTCF at their boundaries. Availability and implementation: A python implementation of TADtree is available at
IntroductionThe 3D architecture of the genome influences key cellular processes such as gene regulation, replication timing and differentiation (). Chromosome conformation capture (3C) technologies use proximity ligation of DNA to elucidate genome structure at high resolution (De Wit and de). Recently, techniques such as Hi-C that couple proximity ligation and high-throughput sequencing have revealed megabase-sized domains of self-interacting chromatin called topologically associating domains (TADs) in both mammals and fruit flies (). Conserved across cell types and species, TADs may partition the genome into functional units and help regulate the distribution of epigenetic marks (). Hi-C uses proximity-based ligation to measure the frequency of physical interaction between pairs of genomic loci (). Typically, the raw read pairs generated by a Hi-C experiment are assigned to bins of fixed width (e.g. 40 kb), resulting in a contact matrix A, where A ij is the number of contacts between bins i and j, normalized for experimental bias. Several methods have been developed for the identification of TADs from Hi-C data. These methods may be roughly classified into two categories: (i) methods that define a one-dimensional (1D) test statistic from the contact matrix A ij and (2) methods that exploit the two-dimensional (2D) structure of the contact matrix.compute a 1D 'directionality index' (DI) from the contact matrix. This index defines whether contacts have an upstream bias, downstream bias or no bias. Next, they use a hidden Markov model (HMM) to partition the genome into regions defined by changes in the DI. Each transition into downstream bias marks the start of a domain and the next transition out of upstream bias marks its end.introduce a 1D statistic called the 'boundary index' (BI) which captures sudden shifts in interaction preference.identify domain boundaries by calling peaks in the BI, but do not explicitly pair these boundaries into domains, leaving the domain structure ambiguous. Recently, a number of methods have been introduced to identify chromatin domains using the full 2D contact matrix.use dynamic programing to find domains with maximal intra-domain contact frequency. This method includes a tunable size parameter and outputs the set of non-overlapping domains that are most robust to changes in the parameter value. More recently, Lvydeveloped a 2D model that fits a block diagonal matrix to observed contacts using maximum likelihood. This method is based on a generative model where the expected contact frequency across a TAD is uniform. All the methods above assume that TADs are non-overlapping. However, several studies have observed a hierarchical chromatin organization including both TADs and sub-TADs within them (). Although TADs are conserved across cell types, sub-TADs are thought to vary between cell types and may facilitate changes in gene regulation during differentiation () and development (). In addition, distinct combinations of proteins such as CTCF, Mediator and Cohesin may demarcate TAD and sub-TAD boundaries (). The distinct properties of TADs and sub-TADs highlight the need for methods that can detect both simultaneously. A very recent development in this direction is the 'Arrowhead' algorithm (). Although this algorithm can identify overlapping domains, it does not explicitly require that overlapping domains be nested, and it is at present not publicly available. In this article, we introduce the TADtree algorithm, which detects nested hierarchies of TADs. In contrast to previously published methods that rely on ad hoc assumptions about the structure of TADs, we derive a straightforward model for the frequency of contacts within TADs. Our model is based on the empirical observation that within TADs, the enrichment of contacts over background grows linearly with the distance between bins, but at a rate that depends on the TAD length. Thus, every TAD can be characterized by two parameters: b, the baseline enrichment for contacts between adjacent bins within the TAD and d, the rate at which contact frequency increases with distance between bins. Using reported TADs from previous studies, we derive relationships between the values of b and d when one TAD is nested inside another. From these observations, we propose a model for TAD hierarchies. We combine our model for contact enrichment within TADs with a 1D BI similar to the one used by. We formulate and optimize an objective function that scores a hierarchy of nested TAD trees according to both the fit to the observed contact matrix and the BI of each TAD and sub-TAD in the hierarchy. We demonstrate that our resulting TADtree algorithm outperforms existing methods on real data, predicting TADs that have greater enrichment for binding of factors known to delineate chromatin organization, and showing greater overlap with high-resolution data.
DiscussionHi-C and other approaches that combine high-throughput sequencing with 3C are becoming widely used to probe the 3D organization of the genome. There is increasing evidence that sub-TAD structure varies between cell types and contributes to changes in gene regulation during differentiation and development (). TADtree is the first publicly available algorithm that detects nested hierarchies of TADs in Hi-C data. Thus, TADtree will enable further research into the organization of TADs and sub-TADs. TADtree employs a straightforward linear model of contact enrichment that is derived from earlier annotations of TADs. TADtree finds the best TAD hierarchy via a dynamic programing algorithm, using an approximation of this model. We demonstrate that TADtree outperforms earlier methods on real Hi-C data. In particular, we show that TADs determined by TADtree on lower resolution (40 kb) data match more closely to TADs derived on higher resolution (5 kb) Hi-C data from. Moreover, we find that TADtree-derived TADs have a higher enrichment at their boundaries for binding sites of factors such that CTCF than are known to demarcate chromatin boundaries. Although the TADtree algorithm demonstrates that TAD hierarchies can be informative, there are several areas where the algorithm can be improved. First, TADtree finds only an approximate best fit to our model. Tests on smaller datasets using a brute force search suggest that the approximate solution differs little from the true solution (data not shown). Nonetheless, finding an exact solution in polynomial timeor proving that this cannot be done may be an interesting problem for future research. A second limitation of TADtree is the rapid increase in runtime $ OS 5  with maximum TAD size S. Third, although our use of a parameter N specifying the number of TADs returned by TADtree is a novel contribution compared with previous methods, we have not included a procedure for model selection, leaving the choice of N to the user. Chromatin structure is highly dynamic and varies widely from cell to cell (). Because approaches such as Hi-C typically pool contacts from across a whole population, it is unclear to what extent the TAD trees identified in this article represent true chromosomal structures within individual cells. Although efforts have been made to deconvolve Hi-C contacts computationally (), this remains a challenging problem. In the future, advances in microscopy and single cell Hi-C () may shed light on whether TAD trees are true chromosomal structures or artifacts of super position. The emerging field of higher order chromatin organization is providing a new lens for viewing the regulatory landscape of cells. Chromatin structure may provide a missing link for understanding the regulatory changes that occur during differentiation and disease (). Because megabase-scale TADs appear to be highly conserved across both cell types and species, it is likely that key changes in chromatin organization occur at the sub-TAD scale. For example, changes in the structure of subTADs could fine-tune opportunities for contact between genes and enhancers. Therefore, methods for deciphering the hierarchical structure of chromatin will be important for linking genome architecture to cellular state.