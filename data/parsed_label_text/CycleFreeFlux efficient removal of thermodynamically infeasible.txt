Motivation: Constraint-based metabolic modeling methods such as Flux Balance Analysis (FBA) are routinely used to predict metabolic phenotypes, e.g. growth rates, ATP yield or the fitness of gene knockouts. One frequent difficulty of constraint-based solutions is the inclusion of thermo-dynamically infeasible loops (or internal cycles), which add nonbiological fluxes to the predictions. Results: We propose a simple postprocessing of constraint-based solutions, which removes internal cycles from any given flux distribution v ð0Þ without disturbing other fluxes not involved in the loops. This new algorithm, termed CycleFreeFlux, works by minimizing the sum of absolute fluxes jjvjj 1 while (i) conserving the exchange fluxes and (ii) using the fluxes of the original solution to bound the new flux distribution. This strategy reduces internal fluxes until at least one reaction of every possible internal cycle is inactive, a necessary and sufficient condition for the thermo-dynamic feasibility of a flux distribution. If alternative representations of the input flux distribution in terms of elementary flux modes exist that differ in their inclusion of internal cycles, then CycleFreeFlux is biased towards solutions that maintain the direction given by v ð0Þ and towards solutions with lower total flux jjvjj 1. Our method requires only one additional linear optimization, making it computationally very efficient compared to alternative strategies. Availability and implementation: We provide freely available R implementations for the enumer-ation of thermodynamically infeasible cycles as well as for cycle-free FBA solutions, flux variability calculations and random sampling of solution spaces.
IntroductionConstraint-based methods for the functional analysis of metabolic networks (CBM or COBRA methods) rely on stoichiometric equations and do not require kinetic information for individual reactions. They are thus applicable to genome-scale metabolic systems (). Flux-balance analysis (FBA), which involves the maximization of a fitness-related objective function in steady-state conditions (), has been successfully applied to predict phenotypes such as growth rates, ATP yield and the effects of gene knockouts. Recent publications have applied FBA to predict drug targets (), while others have used FBA to study the evolution of metabolic systems (). FBA predicts the maximal value of the objective functionoften the yield of biomass production (in the metabolic system (a 'flux distribution') (). One of the difficulties of FBA predictions is that they frequently include thermodynamically infeasible internal cycles, i.e. sets of reactions that together carry a flux that has no influence on the exchange reactions of the model (). These are metabolic 'perpetual motion machines' and do not occur in biological reality. Such internal cycles thus distort predicted flux distributions and should be removed from the predictions. Thermodynamically infeasible cycles affect not only the predictions of FBA, but also those of many other constraint-based analysis methods. In particular, thermodynamically infeasible cycles distort the output of sampling algorithms that aim to characterize the steady-state solution space, and lead to the assignment of unrealistically high values to the flux ranges that can be carried by individual reactions in flux variability analysis (FVA) (). At least for FBA, there exists a strategy that ensures the thermodynamic feasibility of the flux distribution: the minimization of the sum of absolute fluxes under the additional constraint of an optimal value for the original objective function (minimization of total flux, MTF) (). This method aims to approximate a flux distribution that minimizes cellular investment into enzymes, and is hence sometimes called parsimonious FBA (). As a side effect of its parsimonious strategy, MTF also removes any internal cycles. MTF solutions do not represent the full thermodynamically feasible solution space of the original FBA problem; hence, they cannot be used to characterize this full space, which is the purpose of random sampling algorithms and FVA calculations. Several approaches for the identification and/or exclusion of thermodynamically infeasible cycles have been proposed (De). The most widely used method, ll-COBRA (), is based on the integration of thermodynamic constraints with FBA into a mixed-integer linear problem (MILP). However, this approach is computationally expensive, resulting in runtimes that severely limit its applicability to large-scale studies. Here, we propose a new algorithm, termed CycleFreeFlux, which removes all thermodynamically infeasible cycles from any given flux distribution with a single linear optimization step; this makes it orders of magnitude faster than previous approaches when applied to sampling or flux variability analyses of genome-scale metabolic networks.