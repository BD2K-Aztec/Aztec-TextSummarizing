Motivation: Next-generation high-throughput sequencing has become a state-of-the-art technique in genome assembly. Scaffolding is one of the main stages of the assembly pipeline. During this stage, contigs assembled from the paired-end reads are merged into bigger chains called scaffolds. Because of a high level of statistical noise, chimeric reads, and genome repeats the problem of scaffolding is a challenging task. Current scaffolding software packages widely vary in their quality and are highly dependent on the read data quality and genome complexity. There are no clear winners and multiple opportunities for further improvements of the tools still exist. Results: This article presents an efficient scaffolding algorithm ScaffMatch that is able to handle reads with both short (600 bp) and long (35 000 bp) insert sizes producing high-quality scaffolds. We evaluate our scaffolding tool with the F score and other metrics (N50, corrected N50) on eight datasets comparing it with the most available packages. Our experiments show that ScaffMatch is the tool of preference for the most datasets. Availability and implementation: The source code is available at http://cran.r-project.org/web/packages/GMD/
IntroductionNext-generation sequencing (NGS) is a powerful technology as it can produce millions of short paired-end reads covering whole genome. The cost of producing reads keeps a trend of decreasing making it a very attractive tool for genome sequencing and assembly. Genome assembly from short NGS reads is a challenging problem. Assembled genomes are frequently highly fragmented and consist of contigs of highly variable length. The connectivity information coming from read pairs mapped to contigs can be used to merge them into a scaffold which is a set of chains of oriented ordered contigs with estimated gaps between all pairs of adjacent elements. A recent comprehensive evaluation of available software tools shows that the scaffolding problem still does not have an adequate solution (). Because of misassemblies in contigs, repeats and chimeric reads, the information about relative ordering and orientation of two contigs connected with a set of read pairs can be contradictory and not reliable. Thus, choosing a wrong subset of read pairs as an evidence of connection between two contigs can result in inferring a wrong relative ordering and/or orientation as well as the gap estimation between them. Edges that comply with the true orientation of contigs and the distance between them are usually called concordant, otherwise discordant edges. The scaffolding problem is usually formulated as an optimization problem on a graph with the vertices corresponding to the contigs and the edges corresponding to the bunches of read pairs connecting contigs. In contrast, the optimization objectives and the methods to find optimal scaffolding with respect to these objectives significantly vary from one tool to another. For example, OPERA () maximizes the number of concordant edges using dynamic programming, SCARPA () minimizes the number of discordant edges using fixed-parameter tractable and bounded algorithm and linear) maximizes number of read pairs agreeing with a chosen contig orientation using nonserial dynamic programming. As all optimization scaffolding formulations are NP-hard (see e.g.), many state-of-the-art scaffolding tools use heuristic approaches exploiting specific properties of the underlying scaffolding graph. SCARPA and SILP2 solve separately the orientation and the ordering problems, MIP () and SILP2 use decomposition of the scaffolding graph into biconnected components. SSPACE () uses a simple but powerful greedy heuristic and BESST () uses read pair statistics to filter out spurious edges created by structural errors and starts scaffolding with larger contigs. In this article, we propose a novel optimization formulation representing scaffolding as a maximum-weight acyclic 2-matching (MWA2M) problem. As the Hamiltonian path problem can be reduced to this problem, this formulation is also NP-complete. The presented algorithm ScaffMatch efficiently finds the maximumweight 2-matching and iteratively destroys all cycles. This approach works very well since, usually, number of cycles is very small. Our experimental study follows the evaluation of state-of-the-art scaffolders inperformed on five scaffolding datasets [including four from the GAGE project (. We have run the majority of up-to-date versions of stand-alone scaffolders such as OPERA, SOPRA (), SSPACE and MIP as well the recently published ones, SILP2 and BESST. We have also included the results for scaffolding modules of SGA () and SOAPdenovo2 () run independently of de novo assembly following (). Our matching-based tool ScaffMatch compares favorably with the state-of-the-art tools in terms of widely accepted N50 metric, the metrics introduced in, as well as sensitivity, PPV and F score in predicting contig junctions.