Motivation: Liquid chromatography-mass spectrometry (LC-MS) has been widely used for profiling expression levels of biomolecules in various -omic studies including proteomics, metabolomics and gly-comics. Appropriate LC-MS data preprocessing steps are needed to detect true differences between biological groups. Retention time (RT) alignment, which is required to ensure that ion intensity measurements among multiple LC-MS runs are comparable, is one of the most important yet challenging preprocessing steps. Current alignment approaches estimate RT variability using either single chromatograms or detected peaks, but do not simultaneously take into account the complementary information embedded in the entire LC-MS data. Results: We propose a Bayesian alignment model for LC-MS data analysis. The alignment model provides estimates of the RT variability along with uncertainty measures. The model enables integration of multiple sources of information including internal standards and clustered chromatograms in a mathematically rigorous framework. We apply the model to LC-MS metabolomic, proteomic and glycomic data. The performance of the model is evaluated based on ground-truth data, by measuring correlation of variation, RT difference across runs and peak-matching performance. We demonstrate that Bayesian alignment model improves significantly the RT alignment performance through appropriate integration of relevant information. Availability and implementation: MATLAB code, raw and prepro-cessed LC-MS data are available at http://omics.georgetown.edu/alignLCMS.html
INTRODUCTIONLiquid chromatography-mass spectrometry (LC-MS) has been an indispensable tool in various '-omic' studies including proteomics, metabolomics and glycomics (). Each LC-MS run generates data consisting of thousands of ion intensities characterized by their specific retention time (RT) and mass-to-charge ratio (m/z) values, thus enabling comprehensive profiling of a variety of biomolecules. This high-throughput technique is widely applied to identify candidate markers whose expression levels change between groups of distinct biological conditions (). To ensure an unbiased comparison of the ion intensities, several preprocessing steps including peak detection, RT alignment, peak matching and normalization need to be appropriately handled (). Typically, these preprocessing steps generate a list of detected peaks with their RTs, m/z values and intensities, which are subsequently analyzed using statistical tests to identify significant differences in ion intensities. One crucial step is the correct matching of unique peaks across multiple LC-MS runs. With the advances in mass spectrometry technology, it is now possible to achieve highly precise and accurate mass measurement (). However, controlling the chromatographic variability is still a challenging task. This often results in substantial variation in RT across multiple LC-MS runs, raising significant challenges in the preprocessing pipeline. Without appropriate correction of RT, the peak-matching step is error-prone, and the subsequent analysis may yield misleading results. Alignment methods can be categorized as (i) feature-based approaches and (ii) profile-based approaches (). Most current approaches perform RT alignment and peak matching based on a set of peaks identified upfront. The two steps are either carried out sequentially () or combined into a unified module (). The feature-based approaches rely on the correct identification of a set of consensus peaks across LC-MS runs. However, this consensus list cannot be adequately determined based on unaligned data. This, in turn, will affect the alignment results due to erroneously matched peaks. In addition, the results are highly dependent on the method used for peak detection, the prioritization of the detected peaks based on their quality and the handling of missing peaks (). Moreover, estimation of RT variation is limited to only a subset of time points, which is usually not as accurate as considering the whole chromatograms, as done in the *To whom correspondence should be addressed. profile-based approaches (). Profile-based approaches accomplish this by considering a prototype function that represents the underlying pattern across the observed chromatograms, and estimating a set of mapping functions that characterize the relationship between the prototype function and the chromatograms. Appropriate utilization of the whole chromatogram allows improved estimation of the RT variation characterized by the mapping functions. However, this requires that a representative prototype function be reliably selected or estimated, which is still a challenging task for the majority of profile-based approaches using pairwise time-warping techniques. We previously proposed a profile-based method that uses single ion chromatogram (e.g. base peak chromatogram) to estimate both prototype and mapping functions for RT alignment (). The method has been shown to have better performance than other profilebased methods. However, there were unresolved issues including the following: (i) lack of integration of informative prior knowledge, e.g. internal standards, and (ii) implicit assumption of the existence of an underlying pattern based on a single ion chromatogram. In the present work, we propose a Bayesian alignment model (BAM) to address the aforementioned issues. BAM combines the strength of both feature-based and profile-based approaches by incorporating comprehensive information such as multiple representative chromatograms and internal standards. The use of multiple chromatograms is considered in a few studies, by either binning the LC-MS data () or using all the extracted ion chromatograms with acceptable quality (). However, a suitable procedure to use multiple representative chromatograms while retaining computational feasibility is currently not available. We propose a clustering approach to identify multiple representative chromatograms from each LC-MS run. The chromatograms are simultaneously considered in the profile-based alignment to facilitate the estimation of the prototype and mapping functions. Moreover, we incorporate Gaussian process (GP) regression () to estimate the RT variation, based on the peaks of internal standards. The use of internal standards enables a high-confidence estimation of RT variations, which avoids the ambiguity in identifying consensus peaks encountered in the feature-based approaches. The inferred information is used as the prior of the mapping function for profile-based alignment. The integration of internal standards proceeds through weighing uncertainty measures of the regression estimate. Information on internal standards affects the posterior estimation via the GP prior, rather than just providing an initial estimate of the mapping function. This is in contrast to existing methods that rely on internal standards merely as landmarks and do not use them for further adjustment (). We apply BAM to LC-MS metabolomic, proteomic and glycomic data. A consensus list of the ground-truth data is used to evaluate the RT difference across runs, the coefficient of variation (CV) of extracted ion chromatograms and the peakmatching performance in terms of precision and recall. The simultaneous multiple alignment (SIMA) model (), which has shown outstanding performance for the benchmark datasets in, is used to perform the peakmatching step. The remainder of this article is organized as follows. Section 2 introduces the proposed profile-based BAM, including the specification of a GP prior that uses information from internal standards, and the chromatographic clustering approach to perform multi-profile alignment. Section 3 describes LC-MS datasets from metabolomic, proteomic and glycomic studies. Section 4 demonstrates the application of BAM on these datasets. Finally, Section 5 concludes the article with a summary and possible extensions in future work.
CONCLUSIONIn this article, we propose a BAM for LC-MS data analysis. BAM improves on existing alignment methods by (i) using GP prior derived from internal standards and (ii) considering multiprofile modeling with representative chromatograms identified by a clustering approach. Application of the method to various LC-MS datasets shows that the proposed alignment approach greatly facilitates the subsequent peak-matching process by appropriate utilization of available information, which is often overlooked by current methods. Although this article focuses on using internal standards to derive the GP prior, it is also possible to specify the GP prior for the mapping relationship based on the identification of MS/MS spectra or targeted compounds.The alignment model proposed here considers underlying patterns for LC-MS runs in samples drawn from the same biological group. When samples arise from different biological subgroups, the model needs to be extended to account for the heterogeneity across these subgroups. Future work will focus on developing a unified approach that allows the simultaneous alignment of samples from multiple biological groups to ensure coherence in the processing step and data comparability. The LC-MS raw data, the preprocessed peak lists and the ground-truth data used in this article have all been made publicly available to serve as a benchmark for the evaluation of new preprocessing methods.Note: Precision and recall are compared between cases where G chromatograms (G  2,. .. , 5) are derived either by binning along m/z or using the chromatographic clustering procedure.