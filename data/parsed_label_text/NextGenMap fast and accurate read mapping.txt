When choosing a read mapper, one faces the trade off between speed and the ability to map reads in highly polymorphic regions. Here, we report NextGenMap, a fast and accurate read mapper, which reduces this dilemma. NextGenMap aligns reads reliably to a reference genome even when the sequence difference between target and reference genome is large, i.e. highly polymorphic genome. At the same time, NextGenMap outperforms current mapping methods with respect to runtime and to the number of correctly mapped reads.
INTRODUCTIONHigh-throughput sequencing technologies produce several million reads per run, with read lengths ranging from 36 to 41000 bp. The increasing read length and the advent of technologies like Ion Torrent and MiSeq drive the need for new efficient read mapping methods. In addition, the demand increases for methods that can cope with high sequence divergence and at the same time are user-friendly. Two main groups of read mapping programs are distinguished based on their indexing methods (). First, Burrows Wheeler transformation (BWT)-based methods, e.g. BWA (), which are fast but optimized for short reads and genomes with low polymorphism. Second, hashbased methods like Stampy (), which are slow but also suited for highly polymorphic genomes. Thus, a method that combines speed and accuracy provides a quantitative and qualitative improvement of current methods.To this end, we introduce NextGenMap, a method that is faster than current BWT-based methods and at the same time handles short and long reads independent of the number of differences between reads and reference genomes. NextGenMap implements new techniques to efficiently identify genomic regions in the reference genome that share a sequence similarity with a read. To achieve a short runtime and to reliably map the reads, NextGenMap automatically estimates important parameters (like the number of alignment score computations required for each read). Additionally, NextGenMap makes use of multicore CPUs and, if available, any OpenCL-enabled graphic card (GPU). NextGenMap supports fasta, fastq, SAM and BAM as input formats; and outputs SAM and BAM files. Furthermore, NextGenMap maps single-end and paired-end data, offers a local (Smith Waterman) and an end-to-end alignment mode and supports aligning bisulfite-treated reads (). The peak memory consumption of NextGenMap ranged from 5 to 6 GB, depending on the read length.
CONCLUSIONHere, we showed with real and simulated data that NextGenMap maps high-throughput sequencing reads accurately and fast at the same time. This fact was already exploited in studies of miRNA () and bisulfite-treated data (). Finally, the automatized estimation of the required number of alignment score computations per read and the automatic adaptation to the hardware result in a reliable and fast read mapper that requires minimal user interaction. This allows NextGenMap to reliably map reads even to highly polymorphic genomes (10%). Thus, it may also be used to map reads from nonstandard organism to a phylogenetically close reference genome or to apply it to metagenomics data.divergencemapped(a) Percentage of correctly (solid) and incorrectly (dashed) mapped reads and (b) running times for different degree of genomic polymorphisms between read and reference genome for five million 100 bp A.thaliana reads (A 0 ,. .. , A 10 ). NGM  NextGenMap