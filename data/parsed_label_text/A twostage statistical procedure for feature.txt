Motivation: With the advance of new sequencing technologies producing massive short reads data, metagenomics is rapidly growing, especially in the fields of environmental biology and medical science. The metagenomic data are not only high dimensional with large number of features and limited number of samples but also complex with a large number of zeros and skewed distribution. Efficient computational and statistical tools are needed to deal with these unique characteristics of metagenomic sequencing data. In metagenomic studies, one main objective is to assess whether and how multiple microbial communities differ under various environmental conditions. Results: We propose a two-stage statistical procedure for selecting informative features and identifying differentially abundant features between two or more groups of microbial communities. In the functional analysis of metagenomes, the features may refer to the pathways, subsystems, functional roles and so on. In the first stage of the proposed procedure, the informative features are selected using elastic net as reducing the dimension of metagenomic data. In the second stage, the differentially abundant features are detected using generalized linear models with a negative binomial distribution. Compared with other available methods, the proposed approach demonstrates better performance for most of the comprehensive simulation studies. The new method is also applied to two real metagenomic datasets related to human health. Our findings are consistent with those in previous reports. Availability: R code and two example datasets are available at http://cbrc.kaust.edu.sa/svamp
INTRODUCTIONRecently next-generation sequencing technologies are able to produce high volumes of data at an affordable cost (). The power of next-generation sequencing makes it possible to explore microbial environments, opening a new era of genomics study, called metagenomics (). Metagenomics is the study of genomic contents of microbial communities sampled directly from environments (e.g. soil, water, human gut) without prior culturing to understand the true diversity of microbes, their functions, cooperation and evolution in different microbial communities (; Wooley and Ye 2010). Importantly, because only $1% of all microbial organisms can be isolated and cultured in a laboratory, metagenomic analysis enables to reveal the genome contents of the majority of microorganisms that cannot be obtained in traditional genomic analysis based on pure culture (). Metagenomics is broadly applicable to many areas, including ecology and environmental sciences, chemical industry and biomedicine (). In metagenomic analysis, one important aim is to assess whether and how two or more microbial communities differ. To perform metagenomic comparison, researchers can conduct an experiment to compare genomic features based on either taxonomic compositions or functional components obtained from different microbial communities. In this study, we focus on comparison of functions in metagenomes under various conditions. The applications of this research include detection of biological threats and discovery of new bioenergy and new medicine, and so on. For example, comparing microbial communities from human gut corresponding to different phenotypes (e.g. diseased and healthy, or different treatments) can help us determine the activities of microbes related to the disease, resulting in understanding the reactions of microbes that respond to different biochemical products. This may lead to drug development or treatment selection that specifically affects either a particular activity or a group of activities that the disease-related microbes might perform. Statistical procedures play a critical role in detecting differentially abundant features across different microbial conditions. The features here may refer to taxa, functional roles, pathways, or subsystems. Several statistical methods or tools have been developed to compare various microbial communities in terms of detecting differentially abundant features, e.g. SONs (), XIPE-TOTEC (), Metastats () and MEGAN (). However, all of these methods/tools are designed to compare exactly two microbial conditions; ShotgunFunctionalizeR uses a regression method on comparing multiple samples () but it assumes Poisson *To whom correspondence should be addressed. distribution on the count data. It is well known that Poisson model lacks flexibility for over-dispersed count data (). Another method, metagenomeSeq (), has been recently developed to assess differential abundance in sparse high-throughput microbial marker-gene survey data. Even though it can compare multiple conditions, metagenomeSeq is designated for comparison of taxonomic compositions of different metagenomes, rather than functional compositions. In this research, we focus on statistical comparison of functions in metagenomes under various conditions. Statistical methods developed for RNA-Seq analysis may be applicable to metagenomic analysis also, as both RNA-Seq experiments and metagenomic experiments use sequencing technologies and produce count data. A number of statistical tools have been developed for RNA-Seq data analysis, such as edgeR () and DESeq (). However, there are differences between RNA-Seq data and metagenomic data. Different from RNA-Seq data, one of the common characteristics of metagenomic data is the presence of many features with zero counts. It is because metagenomic samples consist of a mixture of microbes, the species-specific functions may only appear in some microbial conditions, while in typical RNA-Seq experiments the genes are the same for different experimental conditions, and only expression levels change. Thus, metagenomic sequencing data may be more sparse than the RNA-seq data. Our research was motivated by (i) the limitations of existing methods developed for metagenomic analysis, (ii) the increasing focus of metagenomic projects on wide applications in various areas [e.g. Human Microbiome Project (HMP,and (iii) the limitations of applying current methods developed for RNA-Seq analysis to metagenomic analysis. In this article, we propose a two-stage statistical algorithm for selecting informative features and detecting differentially abundant functional features (e.g. pathways, subsystems, functional roles) between different microbial conditions. In the first stage of our algorithm, the informative features are selected using elastic net () resulting in dimensional reduction of the metagenomic dataset. In the second stage of our approach, we detect differentially abundant features using generalized linear models (GLMs) with a negative binomial (NB) distribution (). In sparse data, elastic net is a satisfactory variable selection method in the case that the number of predictors (p) is much bigger than the number of observations (N), that is, when p 4 4 N. In addition, another advantage of elastic net is that it is well suitable to data containing a grouping effect, i.e. strongly correlated predictors tend to be in or out of the model together (). The NB distribution is widely used to model count data. The novelty of our two-step method is that we take the common characteristics of metagenomic data into account and combine the feature selection and feature comparison in metagenomic study to improve the power of feature detection. Our method can be directly applied to comparison of more than two microbial conditions. Therefore, our method can be applicable to more general situations, e.g. in clinical trials where the goal is to compare multiple treatment conditions or in natural environmental studies where multiple conditions are compared and investigated.
DISCUSSIONCurrently, there has been an increasing interest in metagenomic projects with various applications. One typical aim is to assess whether and how two or more microbial communities differ. Comparing microbial genetic contents on the basis of functional features (e.g. pathways, subsystems, functional roles) obtained from different microbial communities with different phenotypes (e.g. diseased and healthy, or different treatments) enables us to identify the gnomic contents of microbes contributing to human health and disease, which can in turn lead us to understand how the microbes affect human health. We proposed a two-stage statistical procedure for sequentially selecting informative functional features and detecting differentially abundant functional features between two or more microbial communities/conditions. The proposed method accounts for the specific characteristics of metagenomic data, which are highdimensional complex datasets consisting of a large proportion of zeros, non-negative counts with skewed distribution and a large number of features, but limited number of samples. From the results of various simulations, we showed that our proposed method more effectively selects the informative functional features and therefore more efficiently detects the differentially abundant functional features between metagenomic datasets. Owing to the existence of large proportion of zeros in metagenomic data, we also fitted the Zero Inflated Negative Binomial(ZINB) on the filtered data through elastic net for the Experiment 1. Comparing the results from NB and ZINB methods, NB approach exceeds the ZINB fitting for most of the cases according to the AUC plots and power plots (shown in the Supplementary File, Supplementary Figs S9 and S10); otherwise these two methods are comparable. However, the computational time for ZINB is $200300 times longer than for NB fitting due to more parameters in the ZINB models. We also applied the proposed method on two real metagenomic datasets related to two human diseases. One of them is related to obesity and IBD, and the other one is related to CF lung disease. In the gut data, there are four phenotypes/groups owing to the combination of the two diseases. Our method is directly applied to this multiple-group comparison and our findings are consistent with previous reports. Compared with other existing methods on metagenomic studies, the proposed twostage method is more powerful and flexible.