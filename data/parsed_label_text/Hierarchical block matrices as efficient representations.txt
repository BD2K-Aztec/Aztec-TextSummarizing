Motivation: Recent advancements in molecular methods have made it possible to capture physical contacts between multiple chromatin fragments. The resulting association matrices provide a noisy estimate for average spatial proximity that can be used to gain insights into the genome organization inside the nucleus. However, extracting topological information from these data is challenging and their integration across resolutions is still poorly addressed. Recent findings suggest that a hierarchical approach could be advantageous for addressing these challenges. Results: We present an algorithmic framework, which is based on hierarchical block matrices (HBMs), for topological analysis and integration of chromosome conformation capture (3C) data. We first describe chromoHBM, an algorithm that compresses high-throughput 3C (HiT-3C) data into topological features that are efficiently summarized with an HBM representation. We suggest that instead of directly combining HiT-3C datasets across resolutions, which is a difficult task, we can integrate their HBM representations, and describe chromoHBM-3C, an algorithm which merges HBMs. Since three-dimensional (3D) reconstruction can also benefit from topological information , we further present chromoHBM-3D, an algorithm which exploits the HBM representation in order to gradually introduce topological constraints to the reconstruction process. We evaluate our approach in light of previous image microscopy findings and epigenetic data, and show that it can relate multiple spatial scales and provide a more complete view of the 3D genome architecture. Availability and implementation: The presented algorithms are available from: https://github.com/
IntroductionHiT-3C techniques provide a means for studying the genome architecture at a range of resolutions. As oppose to light microscopy, 3C gives a population-based measure that relies on spatial proximity but does not directly convey a spatial context (). All 3C derivatives consist of cross-linking nuclei, followed by chromatin digestion and re-ligation. Quantifying the number of ligation events between two chromatin fragments gives their 'contact frequency' in the examined population of nuclei, providing a pairwise estimator for their distance. HiT-3C methods (most notably, the Hi-C method) detect contacts between groups of loci, per chromosome or genome-wide, which are typically summarized in a non-negative matrix called a 'contact map'. Analyzing contact maps can reveal different scales of topological organization. At a 1 Megabase (Mb) resolution, chromatin compartments and sub-compartments were identified with principal component analysis (PCA) () and clustering () further suggested that at shorter length scales (40100 kilobases (kb)), a genomic bin can be assigned with a state which represents its preference to interact with other bins along the sequence (directionality index): upstream, downstream or none. Using hidden Markov models (HMM) the researchers have shown that the genome can be segmented into regions of bins with the same state, leading to the definition of Topologically Associated Domains (TADs, 'upstream' or 'downstream' regions) and their boundaries ('none' regions). Dynamic programming () and change point detection () were also employed for identifying transitions in contact frequency enrichment which induce a topological genome segmentation. Owing to the definition of TADs, their position and boundaries can change considerably depending on the sequencing depth and the bin size used (). For example, studying HiT-3C contact maps at different resolutions revealed that previously identified large TADs can be divided into subTADs (). This hierarchical organization suggests the need for methods that could go beyond the TAD-based segmentation and capture topologies at different length scales. Hierarchical topologies derived from contact maps can further provide a spatial context for studying point-wise and relational properties (e.g., histone modifications and gene coexpression, respectively). This can in turn uncover associations between spatial organization (structure) and genomic features (function) that could not have been discovered when considering only the proximity of the sequence. Such evidence synthesis requires an approach which can relate datasets at different resolutions and link genetic and epigenetic features to the spatial scale at which they work. Physics and statistical mechanics have provided valuable lessons about the genome organization. By modelling the chromatin fibre as a polymeric chain of beads, researchers have applied polymer physics to study the expected genome topology and dynamics. In particular, the distance and probability of contact of between beads (loci), given their distance on the sequence, were a subject for much research (). Measurements obtained with fluorescence in-situ hybridization (FISH) and HiT-3C experiments were used to motivate and validate hypotheses concerning these properties, respectively, and, together with general characteristics of polymer chain behaviour were used to propose different models of chromatin organization (). The increasing volume of HiT-3C data calls for the development of algorithms and data structures that can summarize, compress and integrate datasets while considering issues of time and space complexity. Such a computational approach can complement physics simulations and provide the necessary framework for large scale studies of the 3D genome architecture and its function. In this paper, we present a HBM-based algorithmic framework for topological analysis and integration of HiT-3C data. We first introduce the HBM representation for contact maps and give the necessary definitions (Section 2.1). Next, we describe chromoHBM, an algorithm which compresses a contact map into a HBM by iteratively detecting dense modules (communities) of interacting chromatin segments (Section 2.2). We then focus on the application of HBMs for 3C data integration. We explain the difficulties involved in directly combining HiT-3C datasets and propose to merge their HBM representations instead, using the chromoHBM3C algorithm (Section 2.3). We also note that spatial inference can benefit from incorporating topological knowledge and describe chromoHBM-3D, an algorithm which takes a 3D reconstruction method and iteratively guides it by means of HBM traversal (Section 2.4). In order to evaluate our approach, we study Hi-C datasets and show that HBMs highlight key topologies and that the merged HBM representation can capture multiple scales of spatial organization that could not have been detected by separately analyzing each dataset. For the sake of space, robustness and running time evaluation is given in the supplementary (suppl.) information (). Additional results of related or exploratory analysis are also available on request.