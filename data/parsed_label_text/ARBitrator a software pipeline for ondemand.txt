Motivation: Studies of the biochemical functions and activities of un-cultivated microorganisms in the environment require analysis of DNA sequences for phylogenetic characterization and for the development of sequence-based assays for the detection of microorganisms. The numbers of sequences for genes that are indicators of environmentally important functions such as nitrogen (N 2) fixation have been rapidly growing over the past few decades. Obtaining these sequences from the National Center for Biotechnology Informations GenBank database is problematic because of annotation errors, nomenclature variation and paralogues; moreover, GenBanks structure and tools are not conducive to searching solely by function. For some genes, such as the nifH gene commonly used to assess community potential for N 2 fixation, manual collection and curation are becoming intractable because of the large number of sequences in GenBank and the large number of highly similar paralogues. If analysis is to keep pace with sequence discovery, an automated retrieval and curation system is necessary. Results: ARBitrator uses a two-step process composed of a broad collection of potential homologues followed by screening with a best hit strategy to conserved domains. 34 420 nifH sequences were identified in GenBank as of November 20, 2012. The false-positive rate is $0.033%. ARBitrator rapidly updates a public nifH sequence database , and we show that it can be adapted for other genes. Availability and implementation: Java source and executable code are freely available to non-commercial users at http://pmc.ucsc.edu/ $wwwzehr/research/database/.
INTRODUCTIONMicroorganisms catalyze a variety of biogeochemical transformations, such as nitrogen (N 2 ) fixation, that are critical for ecosystem function. Because many microorganisms in the environment have not been cultivated, studies of such functions depend on amplification and sequencing of genes that encode proteins involved in the functions of interest (). This approach facilitates detection and phylogenetic characterization of uncultivated microorganisms. Dinitrogen (N 2 ) is the most abundant gas in the atmosphere, but is not bioavailable unless it is reduced to ammonia by N 2 fixation. Biological N 2 fixation can require the protein products of up to 20 nif genes. The nifH, nifD and nifK gene products are the structural components of the conventional molybdenum (Mo)-containing nitrogenase enzyme (). The products of other nif genes are involved in roles such as regulation and biosynthesis (). In environmental studies, nifH, which encodes the iron (Fe) protein of molybdenum (Mo), vanadium (V) and iron (Fe) nitrogenases, is the most commonly used nitrogenase gene for the investigation of microorganisms with the potential to fix N 2 , as it is the most highly conserved in sequence (). This gene can be used to examine the diversity of N 2-fixing microorganisms in the environment, provides insight into the evolution and ecology of N 2 fixation and can indicate the potential for N 2 fixation in microbial communities (). The application of degenerate nifH PCR primers () enabled the discovery of novel nifH sequences in the environment. This approach fueled studies of N 2 fixation across a broad range of habitats, including woody dicotyledenous plants (), rice roots (), termite guts (), stromatolites (), central ocean gyres () and salt marshes (). The size of phylogenetic trees based on all available nucleotide and amino acid sequences expanded from 19 sequences in 1994 () to $100 sequences in 1997 () and to $1500 sequences in 2003 (). Four (or five, depending on author) major phylogenetic clusters have been described (). Only three of these phylogenetically related clusters contain true nitrogenase-encoding nif genes. Cluster I nifH primarily comprises 'conventional' nifH, which encodes the Fe protein of Mo nitrogenase (), as well as vnfH genes that encode the Fe protein of V nitrogenase (note that vanadium nitrogenase genes cluster differently based on nifD or nifK genes;). Organisms that contain Cluster 1 nifH genes include cyanobacteria and alpha-, beta-and gamma-proteobacteria. Cluster II nifH genes encode the Fe protein of 'alternative' nitrogenases that contain iron but do not contain Mo or V (*To whom correspondence should be addressed.). Cluster III is dominated by genes encoding Fe proteins of nitrogenases primarily of anaerobes, including methanogens and sulfate reducers; these nitrogenases likely contain Mo. Clusters IV and V (sometimes grouped as Cluster IV) contain nifH paralogues whose functions include photopigment biosynthesis () and non-N 2-fixation electron transport (). It has also been suggested that the function of Cluster IV nifH paralogues found in non-N 2-fixing Archaea is the biosynthesis of cofactor F430, essential to the production of methane (). The gene name nflH, for 'nifH-like', has been proposed for these nifH paralogues (). As sequences are accumulating rapidly in gene sequence databases, ongoing efforts to retrieve and analyze new nifH records are necessary to elucidate relationships between phylogenetic categories and identify phylotypes in different ecosystems. These efforts can be frustrated by the sheer number and growth rate of nifH gene sequences deposited into the National Center for Biotechnology Information (NCBI) GenBank database (). For example, in February 2009, Gaby and Buckley identified nifH sequences from the non-redundant nucleotide collection database (nr/nt) at GenBank for a global census of nitrogenase diversity () and records were manually curated to form a database of $17 000 sequences. We estimate that in the intervening time between the download and publication of the related article in 2011, at least 10 000 nifH sequences were added to the database. We estimate that as of January 2012 there were 432 000 nifH sequences in that database, with a growth rate of 4300 sequences per month. Retrieval involving human intervention now requires a significant investment of manpower that will increase over time; an automated retrieval pipeline is needed to allow analysis to keep pace with data collection. However, automating retrieval of all sequences of any specific gene from GenBank is difficult. Moreover, the most common query idioms for searching GenBank are variants of BLAST (), which search for sequence similarity rather than function. Approaches based on BLAST alone are likely to be overly sensitive, as hits to nifH homologues with functions other than N 2 fixation are not easily distinguished from genuine nifH hits. Text searches that analyze sequence annotation can be misled by misannotation () or misspellings in the annotation fields; a text search for 'nifh' in the nr protein database found only 6173 sequences, of which we believe 527 are not actually nifH. The Fungene database (http://fungene.cme.msu.edu) provides a repository of collections of functional genes from GenBank, classified by hidden Markov models (); however, updates from GenBank are infrequent and the hidden Markov model approach is prone to false calls. An alternative nifH database available to the public, maintained at Cornell (), requires the manual retrieval and curation of GenBank nifH sequences. To resolve these issues, a software pipeline was developed, called ARBitrator, that requires little human intervention and retrieves up-to-date nifH sequence collections within a few hours. The software is adaptable to collecting sequences for genes other than nifH, and is especially helpful for discriminating genes of interest from their paralogues, as it incorporates an auto-curation feature based on best Reversed PSI-BLAST hits to GenBank's Conserved Domain Database. ARBitrator's output is formatted for input into other programs, such as the ARB phylogenetic software environment (). Supplementary Appendix A provides a procedure for incrementally updating an existing nifH ARB database using the output of ARBitrator, thus facilitating maintenance of a comprehensive updated gene database.
DISCUSSIONnifH gene diversity studies, and all single-gene diversity studies, are hampered by the difficulty of collecting all sequences associated with the gene of interest. NCBI's GenBank, the database where newly discovered sequences are deposited, provides no service for selecting all records that are annotated as representing a specified gene. A direct text search of the database would be of dubious value because of misannotations. GenBank's main query idiom is the BLAST search, which selects based on sequence similarity regardless of function. Consequently, a sequence collection pipeline that simply BLASTs a representative set of query genes will accept paralogues with the wrong function. The challenge of supporting diversity studies is exacerbated by the rapid growth of GenBank: the collection of nifH, and presumably other genes, appears to have been growing exponentially for the past several years. Thus, there exists an opportunity to facilitate diversity studies by increasing the efficiency of sequence retrieval.