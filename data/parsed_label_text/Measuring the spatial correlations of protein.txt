Motivation: Understanding the interactions of different DNA binding proteins is a crucial first step toward deciphering gene regulatory mechanism. With advances of high-throughput sequencing technology such as ChIP-seq, the genome-wide binding sites of many proteins have been profiled under different biological contexts. It is of great interest to quantify the spatial correlations of the binding sites, such as their overlaps, to provide information for the interactions of proteins. Analyses of the overlapping patterns of binding sites have been widely performed, mostly based on ad hoc methods. Due to the heterogeneity and the tremendous size of the genome, such methods often lead to biased even erroneous results. Results: In this work, we discover a Simpsons paradox phenomenon in assessing the genome-wide spatial correlation of protein binding sites. Leveraging information from publicly available data, we propose a testing procedure for evaluating the significance of overlapping from a pair of proteins, which accounts for background artifacts and genome heterogeneity. Real data analyses demonstrate that the proposed method provide more biologically meaningful results. Availability and implementation: An R package is available at http://man.bioconductor.org/packages/reIease/bioc/html/EMDomics.html
IntroductionUnderstanding the regulatory mechanism of gene expression is an important goal in functional genomics research. It is widely believed that the regulation of transcriptional process involves the combinatory controls of different regulation including protein bindings, histone modification and DNA methylation (). DNAbinding proteins such as transcription factors (TFs) bind to the DNA and thereby either activate or repress the expressions of nearby genes. There are extensive interactions and cooperations among different DNA-binding proteins in order to provide precise gene expression regulation (). The interactions among proteins can often be inferred from exploring the spatial correlation of their binding sites. For example, if the binding sites of two proteins significantly overlap, it is very likely that they interact in some manner. Thus, exploring the spatial correlation of binding sites is an important first step toward understanding the interaction of proteins. The genome-wide profiling of protein binding sites has become an easy procedure, thanks to the rapid advances of high-throughput sequencing technologies such as ChIP-seq (). With the continuous reduction of sequencing cost, it has become a common task for a scientist to map the binding sites of a few proteins under biological conditions of interest, and then compare them with each other or with public data. These results provide information for potential interactions and co-bindings of the proteins. Tasks like this require methods to assess and quantify the spatial correlations of binding sites.Given the binding sites (in the form of genomic regions) of two proteins, it is often of interest to know whether the binding sites significantly overlap. A straightforward approach is to perform statistical test based on a 2  2 table. To do so, one would segment the genome into small bins (such as a few hundred base paris), and use a binary vector to represent the presence/absence of binding for a protein. Then the co-occurrence pattern of the two binding sites can be represented by a 2  2 table. The statistical significance of the overlaps can be assessed using Pearson's v 2 test or Fisher's exact test, and the overlaps can be visualized by a Venn Diagrams (). Unfortunately, such an approach is strongly influenced by the heterogeneity and tremendous size of the genome (details provided in next section). As a result, almost all pair-wise comparisons give significant results. Although constraining analysis to a smaller subset of the genomic regions can reduce the overall genome size and decrease the genome heterogeneity to certain degree implicitly (), simple procedures such as Fisher's exact tests targeting at limited regions still lack systematic treatment of the genome heterogeneity and fails to account for the background artifacts. Approaches based on distance metrics () have also been proposed to measure the similarity of two lists of genomic regions. These approaches, however, don't consider the genome heterogeneity, thus also suffering from inflated significance. Considering the genome heterogeneity, Bickel et al. (2010) developed a subsampling randomization test procedure and a software package Genome Structure Correction (GSC) to assess the overlaps between two region lists. The method assumes that the genome is block stationary, and the overlapping ratios are different in each block. The genome segmentation is estimated from data using a dyadic segmentation approach. However, the segmentation completely depends on the overlapping of the two given lists of regions and thus could provide unstable results. Moreover, the validity of GSC relies on the assumption that the ratio of the number of segments and the total length of the genome goes to zero. That requires the length of each stationary block to be very large, thus the genome segmentation is rather coarse, and the adjustment of genome heterogeneity is insufficient. Additional works on analyzing relationships of genomic regions are available, for example, using multivariate hidden Markov model (HMM) to characterize the combinatory histone patterns across the genome (), or assessing the reproducibility of two replicates for a single TF using a copula mixture model (). These methods, however, are not directly applicable in assessing the strength of correlation of two lists of binding sites. In this work, taking advantage of the rich collection of public data, we systematically investigate the pairwise overlapping of many protein binding sites. We discover through extensive real data analyses that many seemingly significant overlaps of binding sites are actually results of phenomena in a similar flavor as the Simpson's paradox. We therefore propose a new method to adjust for genome heterogeneity and correct the experimental biases. Real data analyses demonstrate that our proposed method outperforms traditional association tests in determining statistical significance as well as providing more biological relevant ranking.
DiscussionIn this work, we focus on assessing the significance of binding sites overlaps. Existing methods mostly fail to consider the genome heterogeneity and experimental artifacts, thus over-estimating the correlations and exaggerate the statistical significance. By carefully exploring the real data, we discover a Simpson's paradox phenomenon in the genome-wide overlapping patterns of protein binding sites, and we show that the genome heterogeneity plays an important role in the seemingly significant results from the traditional methods. We propose a new method to correct for genome heterogeneity and background overlaps, and then develop a statistical test procedure by leveraging information from historical data in large public data repository. Real data analysis shows that the proposed method provides more statistically meaningful and biologically interpretable results. We want to emphasize that the idea of considering genome heterogeneity in assessing TFBS correlation is not completely absent in literature. The essence of the proposed method is similar to the one proposed in () and implemented in GSC, that is, the genome is assumed to be block stationary and the correlations need to be evaluated at different segments of the genome. The difference is that GSC relies on the binding sites of a pair of proteins to perform genome segmentation, whereas our proposed method utilize the genome segmentation provided by ChromHMM. The ChromHMM segmentation leverages information from other data (histone modification ChIP-seq) and provide finer, more biological meaningful segments. These results subsequently improve the inference in assessing binding sites overlaps. Note that our method depends on the availability of ChromHMM segmentation, which is not always available. A very recent paper ChromImpute () supplements ChromHMM by offering an approach to impute epigenomic data and providing genome segmentation based on the imputed data. We believe this method will provide a meaningful segmentation as long as there are some epigenomic data available for a given sample. For biological samples without any available epigenomic data, we recommend segmenting the genome based on other existing data such as genome annotations. The genome can at least be separated into promoter/exonic/intronic/intergenic regions. Other annotations like CpG island and repetitive regions can also be used for better segmentation. Interactions among different regions can be introduced as well. For example, promoter regions can be separated into GCrich and GC-poor promoters. We believe that finer segmentation and more genomically homogeneous segments will provide better results in assessing protein binding interaction. Another important point is that the data used for genome segmentation must be independent of the protein binding data, so that the confounding can be eliminated. Our software package provides an option for users to provide their own genome segments. The proposed method operates on the peaks detected from ChIPseq data, and the raw read counts data are not considered. We believe the correlations in the presence/absence of peaks will be more robust than the correlations in read count level, which is prone to technical artifacts. One concern is that different ChIP-seq peak caller could potentially affect the correlation results. However, we use a rather large window size (1000 bp) to define overlaps and expect the results to be robust against the choice of ChIP-seq peak callers. Using a relatively larger window size will also include the 'closeness' relationship, because peaks spatially close to each other but not exactly overlapping could fall into the same bin and be counted as overlap. The method proposed here is specifically designed for measuring the overlaps of short peaks. For longer peaks, or 'blocks' such as the peaks detected from H3K9me3 histone modification data, the method might not be directly applicable. The method can potentially be applied to assess the spatial correlation of other short genomic features, such as euchromatin island () or DNase I hypersensitive site (). To comprehensively reassess the spatially correlation of different genomic features is our research plan in the near future. The assumption of pairwise independence of most pairs of proteins is the fundamental of the proposed method. However 'most' is a rather loose term, and we believe as long as more than half of the pairs are independent, the method will work well. Even if the assumption is violated, the final result will be on the conservative side (under-estimate the significance), which is more desirable than overly optimistic (over-estimate the significance). Moreover, with the exponential growth of next generation sequencing datasets and their publicly availability, the null distribution can be updated and improved with inclusion of new data.