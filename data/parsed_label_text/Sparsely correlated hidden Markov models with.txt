Motivation: Multiply correlated datasets have become increasingly common in genome-wide location analysis of regulatory proteins and epigenetic modifications. Their correlation can be directly incorporated into a statistical model to capture underlying biological interactions , but such modeling quickly becomes computationally intractable. Results: We present sparsely correlated hidden Markov models (scHMM), a novel method for performing simultaneous hidden Markov model (HMM) inference for multiple genomic datasets. In scHMM, a single HMM is assumed for each series, but the transition probability in each series depends on not only its own hidden states but also the hidden states of other related series. For each series, scHMM uses penalized regression to select a subset of the other data series and estimate their effects on the odds of each transition in the given series. Following this, hidden states are inferred using a standard forward–backward algorithm, with the transition probabilities adjusted by the model at each position, which helps retain the order of computation close to fitting independent HMMs (iHMM). Hence, scHMM is a collection of interdependent non-homogeneous HMMs, capable of giving a close approximation to a fully multivariate HMM fit. A simulation study shows that scHMM achieves comparable sensitivity to the multivariate HMM fit at a much lower computational cost. The method was demonstrated in the joint analysis of 39 histone modifications , CTCF and RNA polymerase II in human CD4þ T cells. scHMM reported fewer high-confidence regions than iHMM in this dataset, but scHMM could recover previously characterized histone modifications in relevant genomic regions better than iHMM. In addition, the resulting combinatorial patterns from scHMM could be better mapped to the 51 states reported by the multivariate HMM method of Ernst and Kellis. Availability: The scHMM package can be freely downloaded from http://sourceforge.net/p/schmm/ and is recommended for use in a linux environment.
INTRODUCTIONThe hidden Markov model (HMM) is an important tool for learning probabilistic models of sequential data with a local correlation pattern, as exemplified in many engineering applications such as speech and handwriting recognition (). In an HMM, it is assumed that the system has a series of unobserved (hidden) states following a Markov process. The observed data are considered as output from the hidden states and follow specific distributions. In recent years, HMMs have been successfully applied to many problems in computational molecular biology () and statistical genetics (). In these applications, they were used to model spatial patterns such as genomic features on the chromosomes, similar to temporal patterns in time series data. HMM analysis is already common in genome-wide location studies. For example, the chromatin immunoprecipitation (ChIP) protocol, coupled with microarray (ChIP-chip) () or next generation sequencing (ChIP-seq) (), is a method of choice for identifying genomic loci enriched with various histone modification marks. In ChIP-seq data, sequence reads are aligned to the target genome and data are summarized by counting the aligned reads in non-overlapping contiguous windows (e.g. 200 bp windows). Because data manifest a clear spatial correlation, an HMM is frequently used to infer the binding status of each window (), where the hidden state space consists of binding state and background state. With the declining experimental cost, it has become increasingly common for genome-wide location analysis to be conducted on multiple regulatory proteins or epigenetic marks (). Because many factors interact with each other to carry out biological processes, it is of great interest to understand the correlation among these factors as reflected in the shared binding sites or modification marks. In the context of HMM analysis with two hidden *To whom correspondence should be addressed.  The Author 2013. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions.com states in each series, one can formulate N separate HMMs by assuming independence between every pair of series, as illustrated in(referred to as iHMM hereafter). Alternatively, one can formulate a single HMM with 2 N hidden states (, referred to as fullHMM), where 2 N is the number of hidden states when there are two states in each series. They represent two opposite extremes in the sense that iHMM completely ignores the correlation between series, whereas fullHMM incorporates the correlation in the multivariate model for the hidden states. Both approaches have advantages and shortcomings: iHMM may feature low statistical power, but it is computationally efficient. In contrast, fullHMM embodies the correlation directly; however, not all hidden state combinations necessarily appear in the data and it is computationally expensive, if not intractable. Practically, however, estimation of an HMM with 2 N hidden states is computationally intractable when N is large because 4 N possible transitions need to be followed. Here we present a novel statistical model that represents a compromise of these two, termed sparsely correlated HMM (scHMM). The scHMM approach captures a small subset of non-ignorable correlations among data series to avoid modeling all pairwise correlations. This sparsity property is achieved by adopting a regularization regression strategy.illustrates our proposed method. The dashed-line arrows connecting the hidden states between series indicate the significant correlations captured by scHMM. For example, the hidden states at windows t  1 and t in the first series, but not the third, are used to estimate the transition probability between windows t  1 and t in the second series, and vice versa. Under this framework, there is no need to consider combinations of hidden states across all series (as N-tuples) as in fullHMM, and hidden states can be inferred considering just four types of transitions in each series separately (solid lines). The scHMM algorithm is able to take advantage of the interactions between correlated series to improve the inference of hidden states. Moreover, we also reduce the computational cost by iterating through N series and inferring the hidden state vectors one series a time, conditioning on the current hidden state vector estimates of all other series. Note that the goal of scHMM is different from that of the multivariate HMM method developed byfor the analysis of combinatorial patterns of histone modification using ChIP-seq data. scHMM aims to infer the hidden states in the multiple chains simultaneously, whereas the multivariate HMM attempts to identify a small subset of representative combinatorial patterns and annotate the genome with respect to such patterns. Nevertheless, the ChIP-enriched windows identified by scHMM can be used to facilitate the multivariate HMM analysis, potentially improving the quality of genomic annotation.