Motivation: Multiple sequence alignment (MSA) is a core method in bioinformatics. The accuracy of such alignments may influence the success of downstream analyses such as phylogenetic inference, protein structure prediction, and functional prediction. The importance of MSA has lead to the proliferation of MSA methods, with different objective functions and heuristics to search for the optimal MSA. Different methods of inferring MSAs produce different results in all but the most trivial cases. By measuring the differences between inferred alignments, we may be able to develop an understanding of how these differences (i) relate to the objective functions and heuristics used in MSA methods, and (ii) affect downstream analyses. Results: We introduce four metrics to compare MSAs, which include the position in a sequence where a gap occurs or the location on a phylogenetic tree where an insertion or deletion (indel) event occurs. We use both real and synthetic data to explore the information given by these metrics and demonstrate how the different metrics in combination can yield more information about MSA methods and the differences between them. Availability: MetAl is a free software implementation of these metrics in Haskell. Source and binaries for Windows, Linux and Mac OS X are available from http://kumiho.smith.man.ac.uk/whelan/software/ metal/.
INTRODUCTIONMany methods used in bioinformatics require one or more accurate multiple sequence alignments (MSAs) as input. Each MSA arranges a set of homologous amino acid or nucleotide sequences in a matrix, where each column of the matrix corresponds to a set of characters that are homologous, functionally related or superposable in a protein structure (). These definitions may coincide when the sequences are closely related, but may conflict as the sequences diverge. Methods of phylogenetic tree reconstruction (), structure prediction (), functional annotation () and the creation of profile hidden Markov models for database searching () all depend on an alignment, and the performance of these methods depends inevitably on the accuracy of these alignments. A variety of MSA methods have been developed over the past two decades that are still in active use (), including methods that co-estimate trees and alignment (To whom correspondence should be addressed.2009;). These algorithms vary in their objective function and the heuristic used to find the best MSA. The performance of MSA methods is frequently assessed by their ability to recover a reference alignment (e.g.), which may be produced from biological information, such as a conserved structure (). The output of each method can then be scored against the reference alignment, either by the fraction of residue pairs in the reference alignment that are correctly identified by a given method, known as the Sum-of-Pairs (SP) score, or by the Total Column (TC) score, which describes the fraction of reference columns identified (). Several studies have noted the effect of sequence alignment algorithm on, for example, phylogenetic tree topology (). Many of these studies used simulated data and the parameter of interest was generally assessed against alignment quality, measured as TC or SP score against the true alignment. Neither the TC nor the SP score are true metrics because they violate the principles of symmetry and the triangle inequality (see below). Producing a valid metric would allow alignment to be projected as points in an alignment space, enabling the comparison of distances between different MSA methods or across different datasets. When these comparisons include a reference alignment, the metric would give some indication of the similarity of alignment methods as well as an accuracy score. Alternatively, such a metric could be used to characterize alignment uncertainty. Previous work on uncertainty has relied on annotating a 'best' alignment with uncertainty information based on the proportion of base pairs that are present when the sequences are reversed before alignment (), or when the guide tree is varied (). A true metric could also provide direct comparison of equally or similarly high scoring paths through the dynamic programming matrix produced during MSA, allowing one to identify regions of high uncertainty in the final alignment. In this study, we derive four true metrics for the comparison of MSAs:(i) a simple correction to the SP score; (ii) a metric that incorporates raw gap information; (iii) a metric that includes the position where gaps occur in a sequence; and (iv) a metric that includes the position where insertion/deletion (indel) events occur both in a sequence and on a phylogenetic tree. We proceed to demonstrate that the SP and TP score are not metrics and cannot be used to investigate many questions about how MSA methods perform. We then show the usefulness of our metrics on MSAs produced by a selection of methods on real data extracted from BAliBASE (), and simulated data produced using INDELible (). Through these analyses, we also demonstrate that the combined use of our metrics can identify similarities and differences betweenPage: 496 495502