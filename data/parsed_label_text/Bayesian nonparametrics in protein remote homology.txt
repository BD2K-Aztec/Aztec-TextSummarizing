Motivation: Wide application of modeling of three-dimensional protein structures in biomedical research motivates developing protein sequence alignment computer tools featuring high alignment accuracy and sensitivity to remotely homologous proteins. In this paper, we aim at improving the quality of alignments between sequence profiles, encoded multiple sequence alignments. Modeling profile contexts, fixed-length profile fragments, is engaged to achieve this goal. Results: We develop a hierarchical Dirichlet process mixture model to describe the distribution of profile contexts, which is able to capture dependencies between amino acids in each context position. The model represents an attempt at modeling profile fragments at several hierarchical levels, within the profile and among profiles. Even modeling unit-length contexts leads to greater improvements than processing 13-length contexts previously. We develop a new profile comparison method, called COMER, integrating the model. A benchmark with three other profile-to-profile comparison methods shows an increase in both sensitivity and alignment quality. Availability and Implementation: COMER is open-source software licensed under the GNU GPLv3, available at https://sourceforge.net/projects/comer.
IntroductionProteins, large molecules, perform a huge number of functions within living organisms. Given that the three-dimensional (3D) structure of a protein determines its function, Structural Genomics centers aim and dominant programs such as the Protein Structure Initiative () aimed at the determination of the 3D structure for most proteins in nature to facilitate understanding of how living organisms function. With increasing coverage of protein fold space (), these efforts are greatly assisted by building protein models by homology to solved 3D structures (). Homology discovery founded on data of solved 3D structures, therefore, constitutes the foundation for homology modeling. Results of the Critical Assessment of Structure Prediction (CASP) experiments () reveal homology search methods as some of the most decisive intermediate means in protein 3D structure prediction. Based on alignments of sequence profiles (generalizations of protein sequence families), these methods (S ding and) can reliably establish homologous relationships even between proteins sharing nearly random (68%) sequence identity. Nevertheless, such relations are remotely homologous and are often missed. Increasing the sensitivity to remotely homologous proteins and the accuracy of alignments is accordingly of great practical importance. To improve the quality of the sequence profile and to obtain the probability distribution of amino acids (residues) more relevant to the sequence family, many efforts were put into the calculation of mutation (substitution) probabilities, including the development of the pseudo-counts (), composition-based statistics () and compositional adjustment () and mixing with many other sequence/structure-derived measures (see, e.g.). The advances in the calculation of substitution probabilities at each profile position have induced more accurate profile alignments and consequently, increased sensitivity to remote homologs (). Despite the apparent progress in developing profile-to-profile comparison methods, some problems remain. Alignment accuracy, one of the most important challenges in homology modeling (), seems to have saturated recently () and further improvements in alignment necessitate. Enhancing the description of substitution probabilities so that the probabilities accurately reflect a structure/sequence environment (context) addresses the problem. Biegert and S ding (2009) showed that generalizing substitution probabilities for each position by mixing them with a library of context profiles has increased the sensitivity of the profile-to-sequence alignment method PSI-BLAST () by more than 64%. The context profiles representative profile fragmentswere not derivatives of structure information but derived from clustering profile fragments. The rationale of using sequence-based contexts was that the profile fragments with different distributions of substitution probabilities could adopt similar local structures. If grouped together, these profile fragments would lose their specificity. Biegert and S ding (2009) modeled the profile fragment by using the product of weighted multinomial probabilities and optimized the substitution probabilities of each context profile with the Expectation Maximization algorithm. In that framework, the number of context profiles is a parameter whose value was found in a homology detection benchmark procedure. In this work, we aim at increasing the sensitivity of profile comparisons and the accuracy of alignments, addressing the issue of profile contexts (Supplementary) from a Bayesian nonparametrics perspective. We propose a hierarchical Dirichlet process mixture model to describe the distribution of profile contexts and apply the inferred mixtures to the problem of protein homology detection. The hierarchical Dirichlet process (HDP) is developed () for model-based clustering of grouped data, where each group is associated with a mixture model. The essential property of the HDP is that it employs a Dirichlet process (DP) for every group of data, where all the DPs share a base distribution which itself is drawn from a Dirichlet process. Such a construction enables sharing of clusters across groups and expresses the property of profiles (sequence families) of sharing common features. Considering profiles as separate groups, the HDP mixture model formalizes the purpose of finding characteristic clusters of contexts within each profile with sharing of the clusters among them. An important feature of the HDP mixture model is that the number of clusters is unknown and is to be inferred from the data in Markov chain Monte Carlo (MCMC) sampling. Overgeneralization of profile contexts leads to signal loss and reduced specificity, and this feature allows to avoid of selecting a particular number of clusters or placing an explicit parametric prior on it. To our knowledge, HDP-based non-parametric Bayesian models to define the distribution of profile contexts or substitution probabilities have not been considered in the literature., though, modeled multiple sequence alignment (MSA) columns with DP Dirichlet mixtures. They specified residue frequencies at single columns by a Dirichlet distribution and inferred the Dirichlet mixtures from MSA data. Although computationally convenient, such a specification has some limitations. One is that a multivariate random variable drawn from a Dirichlet distribution corresponds to a scaled vector of independently distributed gamma random variables. The Dirichlet distribution, therefore, lacks versatility to capture inter-component correlations as illustrated inof the Supplementary Materials. We build the model to handle profile data. The profile generalizes each MSA column with a vector of substitution probabilities, which depending on sequence weighting scheme, embody soft dependencies between adjacent columns. With these properties, substitution probabilities in our setting constitute an observation vector. To control correlations between residues, we model the distribution of substitution probabilities with a logistic-normal distribution (), which follows from the logistic transformation applied to a normal distribution and, to the best of our knowledge, publicly has not been considered to characterize probabilities in profiles. The context (Supplementary) comprises an array of such vectors and is a random variable whose distribution the proposed mixture model describes. The model is valid for contexts of any length. Although, in this work, we confine to the context of one position, Section 5 discusses how the model without any corrections adapts to longer contexts.
DiscussionHighly important in many fields of biomedical research, protein homology modeling relies on protein sequence alignments. Alignments of high quality stimulate discovery of evolutionary related matches and thus are key to sensitivity to homologous proteins and, consequently, homology modeling itself. In this study, we have addressed the problem of protein remote homology detection by improving the quality of alignments between protein sequence families represented by sequence profiles. Modeling profile contexts, fixed-length profile fragments representing the environment of sequence families, previously undertaken by Biegert and S ding (2009), has been engaged to achieve this goal. We have proposed an HDP mixture model to describe the distribution of contexts, where a logistic-normal distribution is used to model substitution probabilities in profile contexts to capture dependencies between amino acids. We have inferred the HDP mixtures from a large set of profile context data by combining Gibbs sampling with Metropolis updates. The Metropolis updates exploited to overcome the inefficiency of Gibbs sampling were implemented by a splitmerge algorithm (), which we have adapted for the HDP mixture model. K  1260 distinct context clusters have been obtained by applying a parallel MCMC sampling algorithm developed to speed up posterior inference. We have developed profile construction and comparison computer utilities and, with respect to the inferred mixtures, derived scores, which we integrated into an extensive profile-to-profile comparison. Evaluating results by generating protein 3D models for each alignment between a pair of profiles and measuring the similarity between the model and the native structure, we have demonstrated that adding the scores increased the number of accurate 3D models, and consequently the number of accurate alignments, in both evaluation modes: with respect to the entire protein domain (global), key to protein structure prediction, and within the alignment boundaries (local), important to sensitivity. A benchmark of the new method COMER, available under the GNU GP License v3, with three other profile-to-profile comparison methods shows a significant improvement in both sensitivity and alignment quality, and an improvement from calculating unit-length contexts is twice that of the HHsearch method employing 13length contexts. Although this study confined to unit-length contexts, the HDP mixture model is applicable for longer contexts. The context consisting of S vectors of A substitution probabilities transformed by the inverse logistic transformation can be represented by an A  S matrix X. The random matrix X will have a matrix variate normal distribution with mean matrix M and covariance matrices R A  A and W S  S, or equivalently, vecX T  $ N AS vecM T ; R W. The mixture model (2.2) applied to g vecX T  will then describe the distribution of Slength contexts, where the conditional distributions and the MCMC sampling algorithms presented in the study remain valid. A model that allows for correlations not just between residues but also between context positions would impart much greater flexibility in modeling profile contexts and specificity in recognizing structural contexts. Integrated into comparison of profiles, the model would very likely increase the sensitivity and accuracy of alignments further. Accordingly, our further work will investigate how effective longer contexts under the HDP mixture model are.