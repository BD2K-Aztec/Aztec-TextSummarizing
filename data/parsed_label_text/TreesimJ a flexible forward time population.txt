Motivation: Most population genetic simulators fall into one of two classes, backward time simulators that quickly generate trees but accommodate only relatively simple selective and demographic regimes, and forward simulators that allow for a broader range of evolutionary scenarios but which cannot produce genealogies. Thus, few tools are available that allow for producing genealogies under arbitrarily complex selective and demographic models. Results: TreesimJ is a forward time population genetic simulator that allows for sampling of genealogies, genetic data and many population parameters from populations evolving under complex evolutionary scenarios. The application provides many fitness and demographic models and new models are easy to develop. Data collection is performed by a variety of independently configurable collectors which periodically sample the population and record statistics. Output options include writing traces, histograms and summary statistics from the data collectors in addition to sampled genetic sequences and genealogies. Summary: TreesimJ allows researchers to easily sample and analyze gene genealogies and related data from populations evolving under a wide variety of selective and demographic regimes. It is likely to be useful for population genetic researchers seeking to understand the links between evolutionary and demographic forces, genealogical structure and the resulting patterns of genetic variation.
INTRODUCTIONThe simulation of evolving populations plays an important role in many aspects of biological inquiry, including the validation of new inference methods, comparison of empirical data to those generated under known conditions and exploration of the dynamics of complex evolutionary processes. Many publicly available tools exist to generate nucleotide sequences under a variety of scenarios, and they are often classified by the direction of time assumed. 'Backward' time or 'coalescent' simulators track only the history of a sample of individuals, and thus can rapidly generate both trees and sequence data from populations of arbitrary size (e.g.). However, these simulators require some assumptions about the nature of the evolutionary process that may not be met in every scenario, especially regarding complex selective regimes. Alternatively, 'forward time' simulators model time as flowing in the usual direction and typically track the state of the entire population (e.g.). While forward time simulation is less computationally efficient than coalescent simulation, a greater range of evolutionary models can be considered. However, the burden of tracking the entire state of the population often means that the genealogical trees underlying the population are not tracked. Thus, forward simulators typically do not allow access to the genealogies that underly the data, and therefore examination of the trees generated under complex evolutionary scenarios has remained difficult using current simulation software. TreesimJ is a simulation tool that addresses this limitation by tracking, in forward time, an evolving population as well as all ancestors of the 'current' generation, thereby combining the flexibility of a forward simulator with the genealogical capabilities typical of backward simulators. This combination allows researchers to investigate how the properties of non-recombining genealogies are affected by evolutionary forces, for instance, how variation in the strength of selection coefficients at multiple sites affects the time to most recent common ancestor (TMRCA) of a sample. Alternatively, various measures of tree shape (for instance, tree depth, skewness or the mean time for two individuals to first share a common ancestor) are easily collected and viewable as time traces or as a histogram of the aggregated values. In addition to tracking genealogies, TreesimJ can also be used to collect a variety of other statistics regarding the population, including many familiar population genetic values (nucleotide diversity, Tajima's D, haplotype diversity, etc.).