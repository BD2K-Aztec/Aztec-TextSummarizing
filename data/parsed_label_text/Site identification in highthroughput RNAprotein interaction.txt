Motivation: Post-transcriptional and co-transcriptional regulation is a crucial link between genotype and phenotype. The central players are the RNA-binding proteins, and experimental technologies [such as cross-linking with immunoprecipitation-(CLIP-) and RIP-seq] for probing their activities have advanced rapidly over the course of the past decade. Statistically robust, flexible computational methods for binding site identification from high-throughput immunoprecipitation assays are largely lacking however. Results: We introduce a method for site identification which provides four key advantages over previous methods: (i) it can be applied on all variations of CLIP and RIP-seq technologies, (ii) it accurately models the underlying read-count distributions, (iii) it allows external covari-ates, such as transcript abundance (which we demonstrate is highly correlated with read count) to inform the site identification process and (iv) it allows for direct comparison of site usage across cell types or conditions. Availability and implementation: We have implemented our method in a software tool called Piranha.
INTRODUCTIONOriginally thought simply to be a vehicle for the transport of genetic information, RNA has come to be seen as a crucial nexus for eukaryotic diversity and control of expression (). The mechanisms which govern this are diverse and include splicing, localization, polyadenylation and the control of both transcript stability and abundance. RNA-binding proteins (RBPs), which associate with RNA through specialized protein domains called RNA-binding domains, drive these processes. The activities of these proteins can be complex and involve not only other proteins but also other RNA species (). The functions of some RBPs are so essential that perturbation of their activity can lead to remarkable phenotypic changes (Chenard). Understanding the functions and mechanisms of the many RBPs is one of the key challenges currently facing cellular biology. Despite tremendous recent progress, there are still many unanswered questions (). Perhaps the most direct approach to profiling these interactions is the immunoprecipitation of the RBP of interest through a process similar in principle to chromatin immunoprecipitation (ChIP). Modern high-throughput immunoprecipitation assays for proteinRNA interaction can trace their lineage back to RIP-chip, an array-based assay (). Cross-linking with immunoprecipitation (CLIP) extended upon the success of RIP-Chip by introducing ultraviolet cross-linking of the protein to the RNA and more stringent washing to increase specificity, though potentially at the cost of reduced sensitivity (). More recently, CLIP has been coupled with high-throughput sequencing (HITS-CLIP) to enable a much greater range and depth of coverage (). Further improvements to allow single-nucleotide resolution have been achieved by iCLIP () and photoactivatable-ribonucleoside-enhance CLIP (PAR-CLIP) variants (). There are substantial challenges to be overcome in terms of the effective analysis of CLIP-seq data however. In this article, our focus is on-site identification (or, peak-calling), which is the crucial step that follows mapping of reads to a reference and deals with identifying those genomic locations that are true protein interaction sites. For simplicity, we refer to this step as site identification regardless of the resolution. That is to say, the process may be as coarse-grained as calling target transcripts or as fine-grained as identifying sites at a single-nucleotide level. We begin by outlining three key challenges in RBP site identification. The first is intrinsic to the peak-calling process: many sites to which reads map only receive a very small number of reads and are likely noise. The levels of noise may be far from negligible and have multiple causes. The sequenced sample may contain RNA that has not been cross-linked to a protein or alternatively that was cross-linked to some different protein, but pulled down through antibody cross-reactivity. In addition, *To whom correspondence should be addressed.  The Author 2012. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com reads can map to non-target transcripts due to sequencing errors or mapping problems. Effective use of the data requires separating these noise sites or false positives, from functional sites. Most studies, explicitly or implicitly, assume read counts at individual sites, follow a particular distribution and use this distribution to determine the probability of seeing a given number of reads at a site by chance. However, there has been no large-scale analysis of CLIP-and RIP-seq data to determine the most appropriate choice of distribution to model these counts. The second challenge is somewhat more esoteric. The proportion of total reads falling in a given transcript does not give the probability of that transcript being a target, but rather informs the probability that a bound RNA is of that transcript. No knowledge of the number of unbound copies is available and hence the RBPs preference for that transcript is not directly discernible. This is true at higher resolutions also. Reads accumulate in transcripts in proportion not only to the RBPs preference for that transcript but also the transcript abundance. This is in contrast to ChIP, where there is (in general) no variation in multiplicity between different parts of the genome. The final challenge we consider is that of incorporating external information into the peak-calling process. There are a number of types of external information, but here we consider what is essentially control data. We give details of other external information in Supplementary Material. Previous studies involving CLIP-seq data have applied a range of different approaches to site identification. Because of the high fidelity of the CLIP assay, it is possible to side step the problem and retain all sites (). This does not allow for the filtering of noise interactions. Another simple approach is to take the top n sites under some scoring, such as normalized read count. This requires selecting a threshold, usually arbitrarily and clearly prevents comparing the number of sites between RBPs or conditions (). More sophisticated methods employ a simulation of the CLIP-seq experiment assuming no site-specific preference and use this to arrive at a false discovery rate for any given peak height (). Although this allows for consideration of transcript abundance, there is no mechanism to explicitly adjust for other sequencing biases and the approach is not applicable to situations, where a second condition or control is available (e.g. RIP-seq). Finally, some site identification methods intrinsically consider information specific to a particular immunoprecipitation assay (). Although these have been highly successful, they cannot be applied in the more general setting. Several databases of CLIP-seq data also exist, for example CLIPZ, StarBase and doRiNA (). The latter two focuses on microRNA (miRNA)RBP interactions. CLIPZ and StarBase group reads into clusters but do not perform any further site identification. In contrast, doRiNA uses a site identification strategy for PAR-CLIP that relies upon T to C conversions at the cross-link site, but is unable to automatically score or rank sites from RIP-seq or other CLIP-seq variants. We present a method for site identification that is applicable across the three commonly used CLIP-seq variants and in addition can be applied to RIP-seq data (for which, to our knowledge, no peak-calling tools currently exist). Our method addresses each of the three challenges outlined earlier: effectively modeling the underlying distribution, utilizing transcript abundance information and flexibly allowing the incorporation of external data. Further, we demonstrate how such a tool can be applied to answer more advanced biological questions regarding RBP binding sites that vary in usage between different cell types, conditions or stages of development.
CONCLUSIONHITS coupled with immunoprecipitation assays have provided an unprecedented level of accuracy in identifying the targets and binding sites for RBPs. Despite this, the data collected from such experiments require some considerable care to extract the most meaningful information from it. Within this article, we have highlighted three challenges that are presented when attempting to identify proteinRNA interactions sites in high-throughput immunoprecipitation sequencing data: selecting the correct distribution for modeling reads, dealing with the transcript abundance bias and incorporating additional external information into the peak-calling process. We introduced Piranha, a peak-calling tool based on the zero-truncated negative binomial regression model that is able to incorporate external information to guide the site identification process. We demonstrated that transcript abundance influences the read counts at sites in IP datasets, that Piranha can successfully incorporate RNA-seq control data to ameliorate this bias and that by considering this additional information, more accurate peak calls are arrived at. We also showed that our method can be applied across all of the currently existing CLIP-seq technologies and also handles the more complex case of RIP-seq data. Finally, we also demonstrated Piranha's application to more complex biological questions involving multiple cell types, conditions, stages of development or species.