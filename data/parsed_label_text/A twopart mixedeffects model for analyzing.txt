Motivation: The human microbial communities are associated with many human diseases such as obesity, diabetes and inflammatory bowel disease. High-throughput sequencing technology has been widely used to quantify the microbial composition in order to understand its impacts on human health. Longitudinal measurements of microbial communities are commonly obtained in many microbiome studies. A key question in such microbiome studies is to identify the microbes that are associated with clinical outcomes or environmental factors. However, microbiome com-positional data are highly skewed, bounded in [0,1), and often sparse with many zeros. In addition, the observations from repeated measures in longitudinal studies are correlated. A method that takes into account these features is needed for association analysis in longitudinal microbiome data. Results: In this paper, we propose a two-part zero-inflated Beta regression model with random effects (ZIBR) for testing the association between microbial abundance and clinical covariates for longitudinal microbiome data. The model includes a logistic regression component to model pres-ence/absence of a microbe in the samples and a Beta regression component to model non-zero microbial abundance, where each component includes a random effect to account for the correlations among the repeated measurements on the same subject. Both simulation studies and the application to real microbiome data have shown that ZIBR model outperformed the previously used methods. The method provides a useful tool for identifying the relevant taxa based on longitudinal or repeated measures in microbiome research. Availability and Implementation: https://github.com/chvlyl/ZIBR
IntroductionThe human microbial communities are associated with many human diseases such as obesity, diabetes and inflammatory bowel disease (IBD) (). In order to decipher the function and impact of the microbes on the human well-being, two high-throughput sequencing-based approaches have been widely used in microbiome studies. One is the 16S ribosomal RNA (rRNA) sequencing approach, which profiles bacterial community by sequencing the 16S rRNA marker gene. Another approach is the shotgun sequencing, which sequences all the microbial genomes presented in the sample, rather than just one marker gene. Both 16S rRNA and shotgun sequencing approaches are quite useful and have been widely applied in human microbiome studies, such as the Human Microbiome Project (HMP) () and the Metagenomics of the Human Intestinal Tract (MetaHIT) project (). To quantify the microbial abundances, the sequencing reads usually are aligned to some known reference sequences (). Due to the uneven total sequence counts of samples, the microbial abundances measured in read counts are not comparable across samples. Therefore, it is common that the read counts are normalized to the relative abundances by dividing total sequence count in the sample so that the relative abundances of all microbes in one sample sum to one (), resulting in compositional data with lots of zeros. It is of great interest to study how microbial abundance changes across time and its association with treatments, clinical outcomes or other covariates. To address this question, many microbiome studies employed the longitudinal study design (for reviews, see). For example,studied the gut microbiome from pediatric IBD patients during an 8-week treatment. One interesting question in this study is to identify the bacterial taxa that change their abundances under different treatments across time. In another longitudinal microbiome study, B ackhed et al.studied the microbiome changes during the first years of newborn babies with different delivery methods and feeding activities. Modeling such sparse longitudinal compositional data is challenging for several reasons. First, the microbiome compositional data is non-normally distributed and bounded in). Methods with normal distributional assumption are not expected to perform well. Second, the microbiome data is often observed with many zeros, which leads to great heterogeneity in the data. Third, in microbiome studies, it is important to adjust for the other covariates/confounders such as patient's age or antibiotic use. Therefore, a multivariate regression based method is more preferred than univariate tests such as the t-test or Wilcoxon rank-sum test. Fourth, the repeated measurements in longitudinal data are correlated, i.e. observations from the same subject across different time points are not independent. This renders the methods with independence assumption not directly applicable. Ignoring the correlations among the repeated measures can lead to incorrect inferences. Therefore, taking into account the correlations among repeated measurements is necessary. Several methods have been used to analyze longitudinal microbiome data in order to identify the covariate-associated taxa, but each has its own limitations. To overcome the issue of non-independence of the data across time points, most of the longitudinal microbiome studies analyze data at individual time point () or compare two time points but ignore the other time points (). To take into account the excessive zeros in the data, a two-part test combining a Z-test for testing the proportion of zeros and a Wilcoxon rank-sum test for testing the non-zero values, was developed for identifying differential abundant microbes between two groups (). Such tests cannot be applied to longitudinal correlated data and are limited to only two-group comparison.developed a zero-inflated Poisson regression model with random effects to account for the correlations in the longitudinal data, but the model can only be applied to count data. A linear mixed-effects model with arcsine square root transformation on the microbiome compositional data was used (), however, this method does not explicitly handle the excessive zeros in the data. This motivates us to develop a flexible method that identifies the covariate-associated taxa while handling the features of the microbiome compositional data and jointly modeling data from all time points. The focus of this paper is to develop a statistical model for identifying the bacterial taxa that are associated with covariates while addressing the above limitations. We propose a two-part mixedeffects Beta regression model, which is a mixture of a logistic regression component and a Beta regression component, with the random effects being included in the model to allow the correlations among the repeated measures. This model takes into account the nature of the microbiome compositional data and allows for multiple covariates in the regression setting. In addition, the model can jointly analyze data from all the time points. Simulation results show that our method outperforms previously used methods in terms of increased power in detecting covariate-associated taxa. We apply ZIBR to a real microbiome study and identify several bacterial taxa that are associated with different treatments of inflammatory bowel disease. ZIBR model was implemented in R package ZIBR and is freely available at https://github.com/chvlyl/ZIBR.
DiscussionWe have proposed a two-part mixed-effects model to identify the taxa that are associated with clinical covariates in the longitudinal microbiome studies. Our model takes into account the compositional and sparse nature of the microbiome data as well as the correlations among the repeated measures in the longitudinal studies. We have demonstrated that our proposed model outperformed the commonly used linear mixed-effects models in identifying the covariates-associated taxa. We applied our method to a real human microbiome study of IBD treatment and identified a number of bacterial genera that showed different abundances between two commonly used treatments during the 8-week treatment period. The model we proposed in this paper can be applied to proportion data obtained from either 16S rRNA sequencing or shotgun metagenomic sequencing. For shotgun metagenomic data, it is not clear how to summarize the sequencing reads into bacterial counts since many reads can be aligned to multiple bacterial genomes. Therefore, most commonly used methods such as MetaPhlAn only output the relative abundances or proportions of the bacteria in the sample. For 16S count data, methods developed for testing.Bacterial genera that showed different abundances between anti-TNF and EEN treatments identified by ZIBR and LMM after adjusting for the initial abundance. LMM identified seven genera, which were also identified by ZIBR. ZIBR identified four additional genera. Four genera identified by ZIBR but not by LMM. Left panel shows the percentage of samples in EEN or anti-TNF groups where the genus was present. Right panel shows the non-zero abundance in EEN or anti-TNF groups, where the abundances were logit-transformedFor each genus, the FDR-adjusted P-value is shown for each of the three covariates in the model.