Motivation: Capillary electrophoresis (CE) of nucleic acids is a workhorse technology underlying high-throughput genome analysis and large-scale chemical mapping for nucleic acid structural inference. Despite the wide availability of CE-based instruments, there remain challenges in leveraging their full power for quantitative analysis of RNA and DNA structure, thermodynamics and kinetics. In particular, the slow rate and poor automation of available analysis tools have bottlenecked a new generation of studies involving hundreds of CE profiles per experiment. Results: We propose a computational method called high-throughput robust analysis for capillary electrophoresis (HiTRACE) to automate the key tasks in large-scale nucleic acid CE analysis, including the profile alignment that has heretofore been a rate-limiting step in the highest throughput experiments. We illustrate the application of HiTRACE on 13 datasets representing 4 different RNAs, 3 chemical modification strategies and up to 480 single mutant variants; the largest datasets each include 87 360 bands. By applying a series of robust dynamic programming algorithms, HiTRACE outperforms prior tools in terms of alignment and fitting quality, as assessed by measures including the correlation between quantified band intensities between replicate datasets. Furthermore, while the smallest of these datasets required 7–10 h of manual intervention using prior approaches, HiTRACE quantitation of even the largest datasets herein was achieved in 3–12 min. The HiTRACE method, therefore, resolves a critical barrier to the efficient and accurate analysis of nucleic acid structure in experiments involving tens of thousands of electrophoretic bands. Availability: HiTRACE is freely available for download at http://sydney.edu.au/science/biology/meep/softwarel.
INTRODUCTIONCapillary electrophoresis (CE) is a widely used approach for biochemical analysis. The rapid electrophoretic separation of * To whom correspondence should be addressed. fluorescently labeled nucleic acid fragments inside electrolytefilled capillaries significantly accelerated genome sequencing (). A more recent, powerful application of CE enables the high-throughput structure analysis of self-assembling nucleic acid-containing systems () as complex as viruses () and ribosomes () at single-nucleotide resolution. The CE profiles obtained in this recent generation of 'structuremapping' experiments present tens of thousands of individual electrophoretic bands; quantifying these data gives detailed portraits of nucleic acid structure, folding thermodynamics and kinetics but requires significant informatics efforts (). 'Basecalling' software packages can assign sequences to these bands in special four-color experiments (see, e.g.) but are not applicable to structure mapping experiments, which require more robust sequence annotation and quantitative fits of each profile to a sum of peak shapes. Such quantitative analysis is aided by the design of experiments so that the desired information appears as differences between corresponding bands across profiles [see, e.g. (; then, sequence annotation of one profile results in annotation of corresponding bands across the entire data. For these datasets, tools for alignment of features or 'rectification' () across different profiles resulted in improvements in quantification speed and accuracy, but these tools remain poorly automated. As the experimental steps of large-scale CE measurements continue to accelerate, the bioinformatic task of profile alignment has become a rate-limiting step in carrying out these information-rich structural studies. Current approaches to aligning and fitting capillary profiles include capillary automated footprinting analysis (CAFA;) and ShapeFinder (); we have found these methods difficult to apply to large-scale titration or mutateand-map datasets (). For instance, CAFA is focused more on peak fitting and has limited alignment capabilities. The ShapeFinder alignment function can align spectrally separated products within a single capillary but not profiles across multiple capillaries with initially poor alignment. Use of these tools requires tedious manual intervention and risks bias or unnecessary errors from such manipulation. Analysis tools for alignment and peak fitting have also been proposed in other domains), mass spectrometry () and slab gel electrophoresis (), but, empirically, these approaches give unsatisfactory performance for CE data. To address the limitations of existing methods, we have developed high-throughput robust analysis for capillary electrophoresis (HiTRACE) to automate the alignment and quantification of nucleic acid structure mapping profiles obtained from hundreds of capillaries. As depicted in, the proposed method consists of four major steps: preprocessing (step A), correlationoptimized linear alignment (step B), dynamic programming-based non-linear adjustments (step C), sequence annotation (step D) and peak fitting (step E). After describing the core algorithms that underlie the robust automation of each step, we present quantitative comparisons illustrating the substantial boosts in both accuracy and speed of HiTRACE over previous approaches. With the proposed methodology, the previously rate-limiting step of quantifying highthroughput CE data is now faster than experimental data acquisition times, enabling the investigation of nucleic acid structure at an unprecedented rate.
DISCUSSIONHiTRACE employs a series of automated techniques to control the high level of variability in parameters of CE systems and to resolve a key alignment bottleneck of modern nucleic acid structure mapping experiments. Several algorithmic advances are responsible for HiTRACE's accuracy and speed, including dynamic programming strategies that have not been been previously considered in the field. Quantitative comparisons on large experimental datasets