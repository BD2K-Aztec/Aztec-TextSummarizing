Motivation: DNA methylation is an important epigenetic modification that has essential role in gene regulation, cell differentiation and cancer development. Bisulfite sequencing is a widely used technique to obtain genome-wide DNA methylation profiles, and one of the key tasks of analyzing bisulfite sequencing data is to detect differentially methylated regions (DMRs) among samples under different treatment conditions. Although numerous tools have been proposed to detect differentially methylated single CpG site (DMC) between samples, methods for direct DMR detection, especially for complex study designs, are largely limited. Results: We present a new software, GetisDMR, for direct DMR detection. We use beta-binomial regression to model the whole-genome bisulfite sequencing data, where variations in methylation levels and confounding effects have been accounted for. We employ a region-wise test statistic, which is derived from local Getis-Ord statistics and considers the spatial correlation between nearby CpG sites, to detect DMRs. Unlike existing methods, that attempt to infer DMRs from DMCs based on empirical criteria, we provide statistical inference for direct DMR detection. Through extensive simulations and an application to two mouse datasets, we demonstrate that GetisDMR achieves better sensitivities, positive predictive values, more exact locations and better agreement of DMRs with current biological knowledge.
IntroductionDNA methylation is a stable epigenetic modification that plays a key role in numerous biological processes, such as genomic imprinting, regulation of gene expression, cell differentiation, development and carcinogenesis (). The presence of large scale aberrant DNA methylation pattern, typically with site-specific hypermethylation in tumor suppressor genes and global hypo-methylation in oncogenes compared to normal tissue, is a hallmark feature of various types of cancers (). The whole-genome bisulfite sequencing (WGBS), which combines the bisulfite treatment with next generation sequencing, becomes the state-of-the-art technology in investigating DNA methylation pattern at single base resolution with relatively high coverage across multiple samples. The bisulfite treatment converts un-methylated cytosines to uracils, while leaving the methylated cytosines unchanged. Thus, it allows for the discrimination between methylated and unmethylated CpG sites (). Methylation proportion at each CpG site is usually defined as the proportion of molecules with cytosine methylated ( C CT ) and is used to summarize the pattern of DNA methylation (). Over the past few years, a number of approaches have been proposed for assessing differentially methylated regions (DMRs) from WGBS data. One of the most straightforward method is to use the Fisher's Exact Test to compare the methylation proportions among different treatment groups at each CpG site (). Recently, Saito et al. developed the ComMet, which is built based on hidden Markov models and designed to detect DMRs between a pair of samples (). Though these methods are easy to implement and can compare a pair of samples obtained either directly from the experiment or by pooling together samples under the same experimental condition, these methods do not take the between sample variations into account and cannot adjust for confounding effects when replicates are available (). Converging evidences suggest that close-by CpG sites tend to have similar methylation proportions (). With the assumption that methylation proportions change smoothly along the genome and the adjacent CpG sites have similar methylation proportions, various smoothing based methods have been proposed to detect DMRs (). Although the smoothing procedures adopted by these methods may differ in details, all of them employ local averaging to improve the precision of the methylation proportion estimates, especially for CpG sites with low coverage. For example, the BSmooth method first estimates the methylation proportions with a local-likelihood smoother, and then performs the statistical test using a signal-tonoise statistic (). A DMR is claimed when groups of consecutive CpGs with the signal-to-noise statistics larger than a cutoff selected based on its marginal distribution. BiSeq first employs a local smoothing technique and then detects DMRs based on the smoothed methylation proportion estimates (). The key difference between BiSeq and BSmooth is that BiSeq adopts a hierarchical testing procedure to detect DMRs and takes the spatial correlations among P-values of adjacent CpG sites into account. The BiSeq requires the specification of a set of candidate regions that may be differentially methylated, and thus it is only suitable for detecting DMRs in targeted bisulfite sequencing data. Though smoothing based methods make use of information from adjacent CpG sites, in most cases they require biological replicates and thus cannot be applied to the datasets without replicates. Currently, the WGBS is quite costly, which prohibits the obtainment of multiple replicates for different experimental conditions given limited budget (). It is quite common that some of the biological replicates are combined into one sample before library generation for sequencing experiments (). Moreover, there are situations where biological replicates are hard to obtain, especially in retrospective studies (). Regression based methods have also been proposed to detect DMRs. For example, MethylKit assumes that the number of methylated reads follows a binomial distribution, and models the methylated reads within the logistic regression framework (). The P-values are calculated and multiple comparisons are adjusted using a sliding linear model method. As methylation proportions vary significantly across individuals, failure to consider the variability across individuals may result in inflated type-I error (). Beta-binomial regression has been recently introduced to model methylation proportions in WGBS data, as it can take both the sampling and epigenetic variations into account (). For example, DSS method uses a lognormal-beta-binomial Bayesian hierarchical model to describe the methylated reads, and the DMR is defined as the CpG site with P-value less than a pre-specified threshold (). The DSS method allows information sharing across different CpG sites to improve precision of the test, but the correlation of P-values for proximal sites is not explicitly modeled in the DMR detection. This may reduce both the sensitivity and specificity of the test. The methylSig method also models the methylated reads using a betabinomial distribution and the likelihood ratio test is used to detect differentially methylated single CpG (DMC) site (). Although the methylSig can be used to identify DMCs, it does not have the mechanism to detect DMRs which is of more biological relevance. RADMeth adopts a beta-binomial regression to calculate the P-values of each CpG site and then combines the information from P-values within 200 base pairs(bp) (). Beta-binomial regression based methods can explicitly take both the epigenetic and sampling variations into account, but they mainly focus on detecting DMCs and have limited power of identifying DMRs. They usually pre-specify a certain length for the DMR and then combines the information within the window to infer the significance of the detected DMRs (). However, compelling evidences suggest that the length of DMRs can range from a few base pairs to thousands of base pairs, and a fixed length of DMR certainly contradicts with the existing biological knowledge (). Compared with detecting DMCs, DMR detection has several advantages. First, locating the regions with multiple DMCs are one of the most basic goals for methylation studies. Second, as pointed out by Bock, after adjusting for multiple comparisons for DMC detection, only the strongest differences tend to remain significant (). Targeting at detecting DMR rather than single DMC can substantially reduce the number of hypothesis being tested and thus increases the statistical power (). To overcome the current limitations, we develop GetisDMR, a genome-wide methylation analysis tool for direct DMR detection. GetisDMR utilizes a beta-binomial distribution (with biological replicates) or binomial distribution (without biological replicates) to model the methylated reads. When bioloigcal replicates are available, it also adopts a regression framework to account for the potential confounding effects. It further uses a local Getis-Ord statistic, which is widely used in identifying statistically significant spatial clusters of high/low values (hot spots) (), to detect DMRs. The length of detected DMRs is determined by the data, and the statistical inference of the detected DMRs is also provided. In the following sections, we first lay out the details of the method, and then we compare our method with ComMet, BSmooth and DSS through simulation studies (). We further apply our method to two public available mouse datasets (), and finally we briefly discuss our results.
DiscussionIn this work, we present a novel statistical method (GetisDMR) to detect DMRs from WGBS datasets. The proposed method utilizes the beta-binomial regression model to account for confounding effects, as well as biological and sampling variations. It further uses a local Getis-Ord statistic to combine information from nearby CpG sites to detect DMRs. The region-wise overall test statistic allows for the detection of DMRs directly, which reduces the number of hypothesis being tested and increases the power of the proposed method. Through extensive simulations, we have demonstrated the proposed method had comparable or higher sensitivities and positive predictive values in detecting DMRs than ComMet, BSmooth and DSS() One strength of the proposed method is that it utilizes the betabinomial regression framework and models the methylation proportions corresponding to experimental as well as other independent and potential confounding factors. As found bythat DNA methylation proportions could be influenced byconfounder, such as age and gender, and thus it is important to take these confounding variables into consideration to avoid bias effect estimates. The beta-binomial regression model can account for biological variability and therefore reduces the rate of false positives compared with a standard logistic regression model. Compared with the beta regression model, which is a widely used technique to model outcomes within the range between 0 and 1, the betabinomial regression increases power even at moderate coverage as it takes the coverage depth into consideration. Another strength of our method is that the GetisDMR adopts region-wise test statistics based on local Getis-Ord statistics to directly detect DMRs. Currently, most of the existing methods focus on detecting DMCs and then identify DMRs based on some prespecified empirical criteria. Although GetisDMR can be used to detect DMCs as we performed the beta-binomial regression for each CpG site independently, our method focuses on detecting DMRs directly and provides statistical inference for direct DMR detection. It has been reported by various researchers that DNA-methylation proportions are spatially correlated along the genome (), and our own data shows that the P-values from the beta-binomial regression are also spatially correlated. In the GetisDMR method, we first derived a z-score and then we employed the local Getis-Ord statistics to account for the spatial correlation in DMR detection. Detecting DMRs from WGBS data is similar to that of hot spot detection, where local Getis-Ord statistics have been widely used. Indeed, most of the local Getis-Ord statistics calculated based on the z-scores are approximately normally distributed as most of the CpG sites are not DMCs. Any regions with abnormal large or small local Getis-Ord statistics may indicate a spatial hot spot and in our case it indicates a DMR. One of the challenges of defining the local Getis-Ord statistics is to calibrate the spatial correlation among z-scores. Although spatial correlations decrease with the increase in the distance between CpG sites, the magnitude of the correlation is quite data dependent. In our method, instead of pre-specifying a weight function to account for the correlation, we use a kernel function to capture this relationship and let the data to determine the magnitude of the parameters. This makes our method robust to various datasets with different underlying spatial correlation structures. We further showed the asymptotic distribution of the region-wise test statistic (i.e. ~ G  $ MVN ~ 0; N), and controlled the region-wise false discovery rate. Therefore, our method can well control the false positive rate and it provides statistical inference not only for DMCs but also for DMRs. It is worth mentioning that the proposed method is quite flexible to the study designs as the DMR detection only requires P-values. For example, for studies where replicates are not available, the Fisher's Exact Test could be used to calculate P-values for each CpG site. We could then use the same procedure to detect DMRs. For studies with more than 2 treatment groups, the likelihood ratio tests could be performed to assess the treatment effects and the same local Getis-Ord statistic based procedure could be used to detect DMRs. For longitudinal studies or studies with clustered effects, robust estimation of the beta-binomial model parameters can be used and the same local Getis-Ord statistic based procedure could be employed to infer DMRs (). In real data application, we applied the proposed method to two public available mouse datasets (). The first dataset is designed to investigate methylation proportions at different tissues of mouse, and it only has one sample per tissue (i.e. one sample from the bone marrow tissue and one sample from the kidney tissue) (). In total, our method