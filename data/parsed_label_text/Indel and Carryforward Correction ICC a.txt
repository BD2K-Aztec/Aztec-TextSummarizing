Motivation: Pyrosequencing technology provides an important new approach to more extensively characterize diverse sequence populations and detect low frequency variants. However, the promise of this technology has been difficult to realize, as careful correction of sequencing errors is crucial to distinguish rare variants ($1%) in an infected host with high sensitivity and specificity. Results: We developed a new approach, referred to as Indel and Carryforward Correction (ICC), to cluster sequences without substitutions and locally correct only indel and carryforward sequencing errors within clusters to ensure that no rare variants are lost. ICC performs sequence clustering in the order of (i) homopolymer indel patterns only, (ii) indel patterns only and (iii) carryforward errors only, without the requirement of a distance cutoff value. Overall, ICC removed 93â€“95% of sequencing errors found in control datasets. On pyrose-quencing data from a PCR fragment derived from 15 HIV-1 plasmid clones mixed at various frequencies as low as 0.1%, ICC achieved the highest sensitivity and similar specificity compared with other commonly used error correction and variant calling algorithms. Availability and implementation: Source code is freely available for download at http://indra.mullins.microbiol.washington.edu/ICC. It is implemented in Perl and supported on Linux, Mac OS X and MS Windows.
INTRODUCTIONMassively parallel sequencing (MPS) technologies, such as 454 pyrosequencing (), are becoming common to rapidly and cost-effectively detect and quantitate rare sequence variants. Pyrosequencing generates up to millions of reads that can include rare variants to detect low frequency drug resistance and immune escape variants in viral (Human immunodeficiency virusand Simian immunodeficiency virus) populations (). However, the PCR required before pyrosequencing of HIV/SIV populations introduces misincorporation errors, and the pyrosequencing process introduces a significant number of indels and carryforward errors (). To accurately estimate population diversity by MPS, it is crucial to distinguish biological variants from process errors with high sensitivity and specificity. Previous studies of 454 pyrosequencing data have managed to reduce sequence-processing errors by improving PCR and sequencing platforms (). Also, several error correction and variant calling algorithms have been published (). Salmela and SchroderSchroder () used multiple alignments of reads as well as quality scores to distinguish correct base calls from erroneous ones, and their method is easily adjustable to reads derived from different MPS platforms. Prosperi and Salemi () developed a program for viral population reconstruction with a built-in Poisson error correction method and post-reconstruction probabilistic clustering.introduced VPhaser, a single nucleotide variant calling tool that uses phase and quality filtering with a probability model that incorporates and recalibrates individual base quality scores to increase both sensitivity and specificity. Sequence clustering is also a common way to reduce sequencing errors. One approach is to cluster sequences using genetic distances (). Another approach is based on flowgrams rather than sequences, which allows pyrosequencing errors to be modeled naturally, as performed by) and. Both approaches require a distance cutoff value that combines substitutions, insertions and deletions in a single distance measure. The cluster centers are haplotypes, and the cluster sizes are interpreted as the haplotype frequency in the population. Error correction in a cluster is performed by collapsing variation within the cluster. Therefore, there is a risk for loss of real variants in a population if an inappropriate cutoff value is set, especially in a population of low genetic diversity. To address the challenge of detecting genetic variants, especially those occurring at low frequencies, we developed a new approach that clusters sequences without substitutions and locally corrects only indel and carryforward errors within clusters *To whom correspondence should be addressed. to ensure that no rare variants are lost. Indel and Carryforward Correction (ICC) provides a complete suite for users to analyze pyrosequencing data, including read quality filtering and alignment, indel and carryforward error correction, variant calling and calculation of single nucleotide variant and haplotype frequencies. To determine the efficiency of ICC in correcting errors, we calculated and compared error rates before and after ICC correction on datasets derived from previously sequenced plasmid DNAs. Using pyrosequencing data of PCR fragments derived from a mixture of 15 HIV-1 plasmid clones at various frequencies, we used ICC to estimate sensitivity and specificity and compared these results with several other commonly used error correction and variant calling algorithms.