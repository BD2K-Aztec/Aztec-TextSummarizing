Motivation: The prediction of protein coding genes is a major challenge that depends on the quality of genome sequencing, the accuracy of the model used to elucidate the exonic structure of the genes and the complexity of the gene splicing process leading to different protein variants. As a consequence, todays protein databases contain a huge amount of inconsistency, due to both natural variants and sequence prediction errors. Results: We have developed a new method, called SIBIS, to detect such inconsistencies based on the evolutionary information in multiple sequence alignments. A Bayesian framework, combined with Dirichlet mixture models, is used to estimate the probability of observing specific amino acids and to detect inconsistent or erroneous sequence segments. We evaluated the performance of SIBIS on a reference set of protein sequences with experimentally validated errors and showed that the sensitivity is significantly higher than previous methods, with only a small loss of specificity. We also assessed a large set of human sequences from the UniProt database and found evidence of inconsistency in 48% of the previously uncharacterized sequences. We conclude that the integration of quality control methods like SIBIS in automatic analysis pipelines will be critical for the robust inference of structural, functional and phylogenetic information from these sequences. Availability and implementation: Source code, implemented in C on a linux system, and the datasets of protein sequences are freely available for download at http://sydney.edu.au/science/biology/meep/softwarel.
INTRODUCTIONNext-generation sequencing (NGS) technologies are revolutionizing genomics, but the annotation of the genome assembly produced by these sequencers remains a major challenge (). The first step in many automatic genome annotation pipelines involves the prediction of protein-coding genes, a process that is intrinsically complicated, time-consuming and error-prone. First, DNA sequencing errors can lead to errors in gene sequence prediction, in particular those produced by NGS technologies or low-coverage assemblies (). Second, the DNA errors are further confounded by inaccuracies in the methods used to delineate the proteincoding genes. Coding regions are mostly predicted by automatic methods, but the relationship between genes, transcripts and proteins is complex, and automated genome annotation is not completely accurate. The detection of protein-coding genes in prokaryotic genomes is generally considered relatively simple compared with eukaryotic genomes; however, there still remain a number of problems, including the detection of small genes () or the localization of the start site (). In eukaryotic genomes, recent analyses have shown that the complete exon/intron structure is correctly predicted for only $5060% of genes (). Even the best gene predictors and genome annotation pipelines rarely exceed accuracies of 80% at the exon level, meaning that most gene annotations contain at least one mis-annotated exon. The situation is further complicated by widespread alternative splicing events, which affect 49294% of multi-exon human genes (). Inconsistencies or inaccuracies in the prediction of proteincoding genes can often lead to errors in subsequent structural, functional or phylogenetic analyses. For example, it has been shown that low-coverage genomes generate not only a massive number of false gene losses but also striking artifacts in gene duplication inference (). It has also been demonstrated that contamination of databases with incomplete, abnormal or mispredicted sequences introduces a bias in the definition of orthologs (), the analysis of protein domain architectures between orthologs () or the estimation of positive Darwinian selection (). The accumulation of erroneous information in genomic and protein databases will continue to grow, as features are frequently transferred from annotated to unknown sequences (), which only amplifies the level of errors in the databases. Such studies clearly highlight the urgent need for error detection and quality control strategies to reduce the impact of inconsistencies and to efficiently extract knowledge from the new genome data. A number of computational methods have been developed to identify inconsistencies or errors in genome and protein sequences. At the genome level, current efforts in sequencing error mitigation mainly rely on filtering strategies, including filtering for sequencing read depth, base call quality, short-read alignment quality, variant call quality, known variants, strand bias, allelic imbalance and sequence context. All of these postprocessing techniques help to reduce uncertainty in the final *To whom correspondence should be addressed. genotyping variant call (). At the protein level, one approach toward solving this problem is to incorporate protein, EST and RNA-seq evidence that may support or contradict the exon/intron structure of the annotated gene. Several metrics have been developed, for example, the annotation edit distance (AED) (), which measures how congruent each annotation is with its overlapping evidence. The MisPred method () is based on the hypothesis that conflicts in structural or functional annotations might imply a badly predicted sequence. Unfortunately, as stated by the authors, although MisPred identifies many suspicious sequences, it detects only a fraction of the truly erroneous sequences. We have previously developed an alternative approach that incorporates evolutionary information and does not require any structural or functional knowledge (). This approach was used to evaluate the effect of sequence errors on multiple sequence alignment accuracy (), as well as in evolutionary and functional enrichment analyses (). In this method, the evolutionary conservation of a set of related sequences was measured using Gribskov profiles (), representing observed amino acid frequencies in alignment columns. Nevertheless, there are a number of shortcomings in estimating scores for amino acids based only on their observed frequencies, especially when the number of observed sequences is small. First, unseen amino acids are assigned scores based on a substitution matrix () that is generally chosen arbitrarily. Second, an arbitrary threshold must be defined to distinguish related from unrelated or erroneous sequences. Here, we present a new method, called SIBIS (Bayesian Inconsistency in Sequences), for the detection of sequence inconsistencies or errors, which replaces the Gribskov profiles used previously with a Bayesian model () to represent the evolutionary information in multiple sequence alignments and to estimate the relatedness of specific sequence segments. The Bayesian approach provides a strong theoretical foundation for modeling the amino acid frequencies found at a specific alignment position, and for calculating scores for including new sequences (). SIBIS thus combines a prior distribution of amino acid probabilities, with observed amino acid frequencies at homologous positions within the related proteins. In theory, the prior distribution may be of any form, but here we use a powerful and elegant formalism, which is to assume that the amino acid frequencies follow a Dirichlet distribution or a mixture of a finite number of Dirichlet distributions (). We then exploit an efficient method for calculating posterior distributions, which was developed in the context of 'Bayesian Integral Log-odds' (BILD) substitution scores (), designed to extend the log-odds formalism that is widely used to define residue substitution scores for pairwise alignments, to multiple alignments. Similar Bayesian approaches have been used previously to improve the accuracy and sensitivity of various sequence analysis tools, including sequence database searches () and in Gibbs sampling optimization procedures for local multiple alignment (). Here, we use the Bayesian model to estimate the relatedness of individual sequences within a conserved alignment region. To do this, we compare the probabilities of observing specific sequences, under the assumptions of relatedness and unrelatedness. Unrelated sequence segments are then flagged as sequence inconsistencies or potential errors. The accuracy of our prediction is evaluated and compared with two existing methods, based on a set of eukaryotic sequences with known sequence errors that were validated experimentally (). The results indicate that the Bayesian approach is statistically most powerful and has the highest accuracy for detecting inconsistent sequence segments, corresponding to ambiguous sequence variants or errors.
CONCLUSIONIn spite of tremendous advances in computational gene finding, comprehensive and robust genome annotation remains a challenge because of the exon/intron structure of eukaryotic genes and the complex relationship between genes, transcripts and proteins. As a consequence, computationally predicted genes and proteins should be confirmed by independent evidence and/or manual verification. Experimental validation of protein sequences, for example, using shotgun proteomics, is one solution, but this is clearly infeasible for all proteomes. An alternative is to use bioinformatics approaches to identify erroneous, ambiguous or inconsistent protein sequences, using additional information such as EST sequences, protein domain families or evolutionary information. Here, we used multiple alignments to identify non-conserved or unrelated segments in sets of related sequences. To assess the evolutionary conservation between sequences in the alignment, we used a Bayesian approach to combine Dirichlet mixture distributions with the observed frequencies of the amino acids in the alignment columns. The Bayesian model provides a robust, theoretically sound representation of sequence relatedness, and, in our experiments, we have shown that it significantly improves the sensitivity of error detection, without loss of specificity. A major advantage of our method is that it does not assume that structural or functional information is available, so it can also be applied to sequences from less well-studied or uncharacterized organisms. The interpretation of the inconsistencies detected using bioinformatics approaches remains an issue. There is a risk that a genetic event (recombination, alternative splicing,pseudogenization etc.), which affects a single sequence in the multiple alignment, could be interpreted as an error. Nevertheless, the majority of the inconsistencies detected by SIBIS are likely to result from genome sequencing errors or inaccuracies in the gene annotation pipeline. Our work confirms previous studies (), which estimated that approximately half of the sequences in the public databases contain errors, and it is clear that simply eliminating these sequences from subsequent analyses is not a viable solution. Our method has the advantage that the errors are delimited, so that the reliable sequence segments can be used in subsequent studies. Error detection methods, such as the one described here, that are capable of accurately distinguishing between reliable and unreliable sequence segments will be crucial for automatic sequence analysis pipelines and should lead to more robust structural, functional and phylogenetic analyses.