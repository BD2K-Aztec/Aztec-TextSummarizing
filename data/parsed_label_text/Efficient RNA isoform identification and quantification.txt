Motivation: Several state-of-the-art methods for isoform identification and quantification are based on  1-regularized regression, such as the Lasso. However, explicitly listing the—possibly exponentially—large set of candidate transcripts is intractable for genes with many exons. For this reason, existing approaches using the  1-penalty are either restricted to genes with few exons or only run the regression algorithm on a small set of preselected isoforms. Results: We introduce a new technique called FlipFlop, which can efficiently tackle the sparse estimation problem on the full set of candidate isoforms by using network flow optimization. Our technique removes the need of a preselection step, leading to better isoform identification while keeping a low computational cost. Experiments with synthetic and real RNA-Seq data confirm that our approach is more accurate than alternative methods and one of the fastest available. Availability and implementation: Source code is freely available as an R package from the Bioconductor Web site (http://www.bioconductor. org/), and more information is available at http://cbio.ensmp.fr/flipflop.Contact:
INTRODUCTIONOver the past decade, quantitation of mRNA molecules in a cell population has become a popular approach to study the effect of several factors on cellular activity. Typical applications include the detection of genes whose expression varies between two or more populations of samples (differential analysis), classification of samples based on gene expression (van't) and clustering, which consists of identifying a grouping structure in a sample set (). While probe-based DNA microarray technologies only allow quantitating mRNA molecules whose sequence is known in advance, the recent development of deep sequencing has removed this restriction. More precisely, RNA-Seq technologies () allow the sequencing of cDNA molecules obtained by reverse transcription of RNA molecules present in the cell. Consequently, any transcript can be sequenced and therefore quantitated, even though its sequence might not be available a priori for designing a specific probe. In addition to facilitating the study of non-coding parts of known genomes and organisms whose genome has not been sequenced (), RNA-Seq technologies facilitate the quantitation of alternatively spliced genes. Genes in eukaryote cells contain a succession of exon and intron sequences. Transcription results in a pre-mRNA molecule from which most introns are removed, and some exons are retained during a processing step called RNA splicing. It is estimated that 495% of multiexonic genes are subject to alternative splicing (): the set of exons retained during splicing can vary, resulting for the same gene in different versions of the mRNA, referred to as transcripts or isoforms. Identification and quantification of isoforms present in a sample is of outmost interest because different isoforms can later be translated as different proteins. Detection of isoforms whose presence or quantity varies between samples may lead to new biomarkers and highlight novel biological processes invisible at the gene level. Sequencing technologies are well suited to transcript quantitation as the read density observed along the different exons of a gene provide information on which alternatively spliced mRNAs were expressed in the sample, and in which proportions. Because the read length is typically smaller than the mRNA molecule of a transcript, identifying and quantifying the transcripts is, however, difficult: an observed read mapping to a particular exon may come from an mRNA molecule of any transcript containing this exon. Some methods consider that the set of expressed isoforms () or a candidate superset () is known in advance, in which case the only problem is to estimate their expression. However, little is known in practice about the possible isoforms of genes, and restricting oneself to isoforms that have been described in the literature may lead to missing new ones. Two main paradigms have been used so far to estimate expression at the transcript level while allowing de novo transcript discovery. On the one hand, the Cufflinks software package () proceeds in two separate steps to identify expressed isoforms and estimate their abundance. It first estimates the list of alternatively spliced transcripts by building a small set of isoforms containing all observed exons and exon junctions. In a second step, the expression of each transcript is quantified by likelihood maximization given the list of transcripts. Identification and quantification are therefore done *To whom correspondence should be addressed.  The Author 2014. Published by Oxford University Press. This is an Open Access article distributed under the terms of the Creative Commons Attribution License (http://creativecommons.org/licenses/by/3.0/), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited. independently. On the other hand, a second family of methods () jointly estimates the set of transcripts and their expression using a penalized likelihood approach. These methods model the likelihood of the expression of all possible transcripts, possibly after some preselection, and the penalty encourages sparse solutions that have a few expressed transcripts. The two-step approach of Cufflinks () is reasonably fast, but does not exploit the observed read density along the gene, which can be a valuable information to identify the set of transcripts. This is a conclusion drawn experimentally using methods from the second paradigm (see Bohnert and R atsch, 2010;). To summarize, the first paradigm is fast but can be statistically less powerful than the second one in some cases, whereas the second paradigm suffers from the exponential number of candidate isoforms and becomes intractable for genes with many exons. The contribution of this article is to allow ' 1-penalized regression methods from the second family to run efficiently without prefiltering the set of isoform candidates, although they solve a nonsmooth optimization problem over an exponential number of variables. To do so, we show that the penalized likelihood maximization can be reformulated as a convex cost network flow problem, which can be solved efficiently (). Note that a significantly different approach was adopted byfor non-convex ' 0penalty. Even though the problem they address is NP-hard, they perform simultaneous isoform identification and quantification, without explicitly enumerating all possible transcripts, by using mixed integer programming techniques. The article is organized as follows: Section 2 introduces the statistical model (Section 2.1) and the penalized likelihood approach (Section 2.2) we follow. Our model is similar to the one used by, but properly models reads that cover more than two exons, effectively taking advantage of longer reads. We then reformulate the model as a path selection problem over a particular graph (Section 2.3), and present our method in Sections 2.42.6 called FlipFlop (Fast Lasso-based Isoform Prediction as a FLOw Problem) for solving it efficiently. Section 3 empirically compares our approach with the state of the art on simulated and real sequencing data. Our experiments show that our approach has higher accuracy in isoform discovery than methods that treat discovery and abundance estimation as two separate steps and that it runs significantly faster than methods explicitly listing the candidate isoforms. We discuss the implications of our results in Section 4.
DISCUSSIONSimultaneously tackling identification and quantitation using penalized likelihood maximization is known to be a powerful approach to estimate the set of expressed transcripts. However, existing ' 1-regularized regression techniques cannot deal with genes that contain too many exons, as the set of candidate isoforms grows exponentially with the number n of exons. By leveraging network flow optimization algorithms, we discover a few expressed transcripts among the exponential number of