Motivation: Fluorescence recovery after photobleaching (FRAP) is a functional live cell imaging technique that permits the exploration of protein dynamics in living cells. To extract kinetic parameters from FRAP data, a number of analytical models have been developed. Simplifications are inherent in these models, which may lead to inex-haustive or inaccurate exploitation of the experimental data. An appealing alternative is offered by the simulation of biological processes in realistic environments at a particle level. However, inference of kinetic parameters using simulation-based models is still limited. Results: We introduce and demonstrate a new method for the inference of kinetic parameter values from FRAP data. A small number of in silico FRAP experiments is used to construct a mapping from FRAP recovery curves to the parameters of the underlying protein kinetics. Parameter estimates from experimental data can then be computed by applying the mapping to the observed recovery curves. A bootstrap process is used to investigate identifiability of the physical parameters and determine confidence regions for their estimates. Our method circumvents the computational burden of seeking the best-fitting parameters via iterative simulation. After validation on synthetic data, the method is applied to the analysis of the nuclear proteins Cdt1, PCNA and GFPnls. Parameter estimation results from several experimental samples are in accordance with previous findings, but also allow us to discuss identifiability issues as well as cell-to-cell variability of the protein kinetics. Implementation: All methods were implemented in MATLAB R2011b. Monte Carlo simulations were run on the HPC cluster Brutus of ETH
INTRODUCTIONThe development of modern microscopy systems coupled with advances in fluorescent protein technology and sophisticated computational methods have made it possible to visualize, track and quantify fluorescent molecules within living cells. Functional live cell imaging techniques, such as fluorescence recovery after photobleaching (FRAP), are increasingly used by biology laboratories to explore the dynamic behavior of proteins in vivo (). During a typical FRAP experiment, molecules tagged with a fluorescent protein (such as the Green Fluorescent ProteinGFP) in a subcellular region are irreversibly bleached by a short laser pulse. Then, the recovery of the fluorescence due to unbleached molecules moving into the bleached region is measured by standard time-lapse microscopy. Analysis of this recovery data aims at providing information regarding the diffusion and binding of the bleached molecules, reflecting biomolecular interactions within the cell (). Conventional quantitative FRAP analysis focuses on parameters associated with the shape of the recovery curve (e.g. value of plateau and half-maximal recovery time), easily estimated using curve-fitting techniques (). However, this approach provides a limited understanding of protein kinetics and is heavily dependent on the experimental setup, especially on the time frame of observation (). To estimate the kinetic parameters of the underlying molecular processes, including association and dissociation constants, relative size of mobile and immobile pools and protein diffusion rates, model-based quantitative FRAP analysis is necessary (). Modeling approaches traditionally rely on developing streamlined models of the diffusion, binding and photobleaching processes to derive approximate closed-form expressions of fluorescence recovery. The parameters yielding recovery curves that correspond best to the data are chosen as the most likely explanation of the underlying protein kinetics (). Over the past years, a variety of models have been proposed, broadly classified into diffusion models, reaction models and reaction-diffusion models, depending on the phenomenon considered dominant (). It has also been observed () that the FRAP recovery curve is composed of two phases: a first phase with fast dynamics, where the recovery is mainly attributed to diffusion (diffusion regime), and a second phase with slower dynamics, where the *To whom correspondence should be addressed.  The Author 2014. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com recovery is regulated by binding and unbinding events (turnover regime). Models giving rise to a sum of exponential terms have been extensively used for quantitative analysis. In the reaction models domain, exponential expressions are derived through compartmental modeling approaches pioneered in (), where the presence of one or two exponential terms is dictated by the number of binding sites. An alternative compartmental modeling approach is proposed in (), which again results in a theoretical curve with two exponential terms. Here, the coefficients of the terms are non-linear functions of all physical parameters (diffusion coefficient, binding/unbinding rates) of the underlying molecular kinetics. The derivation of explicit (parametric) expressions for FRAP curves relies on simplifying assumptions about cellular/nuclear geometry [2D (), 3D (, nature of diffusion [isotropic () or anisotropic (, binding site number [one () or many (and distribution [homogeneous () or heterogeneous (, to name a few. The accuracy of these approximations is, however, difficult to determine. Furthermore, it has been shown that different models or different parameter sets of the same model can fit FRAP curves equally well. Indeed, contrasting estimates of the kinetic parameters of even the same molecule species have been reported in various studies (). At the same time, the use of averages of several cell profiles is common practice in traditional FRAP analysis, which may mask the underlying biological information contained in single-cell measurements. In the past years, the availability of computational resources of ever-increasing power has stimulated modeling and simulation of molecular mobility and interactions at a particle level and within realistic environments (). Stochastic hybrid models, coupling continuous diffusion dynamics with discrete (random) interaction events and providing a realistic account of the complexity of the cellular environment, can be built and simulated in reasonable time (). Analysis of the fit between simulated and experimental recovery curves allows one to (invalidate hypotheses on the values of kinetic parameters. Unfortunately, in this context, a parameter inference method cannot be obtained easily by numerical optimization of the fit, as the repeated simulation of the system for iteratively refined values of the parameters is computationally demanding. To account for this, existing simulationbased methods propose the a priori creation of a large dataset of simulated FRAP curves for varying combinations of kinetic parameter values, obtained by gridding the parameter space (van). Parameter inference from experimental data is then performed by searching in the dataset the simulated curve that fits best the experimental one, thus forcing the estimates to take values on the grid of simulated parameters. In this article, we propose an alternative approach for the inference of the kinetic properties of proteins within living cells. The key idea and novelty of our method is the construction of a mapping from recovery curves to the parameters of the underlying molecule kinetics. The method is based on the numerical simulation of a stochastic hybrid model of protein diffusion and binding in a realistic setup at a particle level (). It assumes that FRAP recovery curves are represented through a sum-of-exponentials. Then, a relatively small number of simulations for different physical parameter values is used to train an Artificial Neural Network (ANN) implementing the required mapping of physical parameters to the parameters of FRAP recovery curves. Given an experimentally determined recovery curve, inference of the underlying kinetic parameters then simply amounts to fitting the data with a sum-of-exponential curve and feeding the obtained recovery parameters to the mapping. In addition, a bootstrap process is used to compute confidence intervals on the parameter estimates. Through the a priori construction of the mapping, our method circumvents the burden of resimulating the model iteratively every time a parameter estimate is sought. Unlike existing methods, our method provides interpolation within the range of parameters of the simulated curves. This allows us to reduce the number of simulations required and yet provide estimates that are not biased toward values fixed a priori. At the same time, the bootstrap process allows us to investigate the identifiability of the physical model parameters. We validate the proposed method first in silico and then through the analysis of in vivo data for the nuclear proteins Cdt1, PCNA and GFPnls. Our method predicts behavior in accordance with earlier findings () and provides elements for the discussion of cell-tocell variability.