Motivation: 16S rDNA pyrosequencing is a powerful approach that requires extensive usage of computational methods for delineating microbial compositions. Previously, it was shown that outcomes of studies relying on this approach vastly depend on the choice of pre-processing and clustering algorithms used. However, obtaining insights into the effects and accuracy of these algorithms is challenging due to difficulties in generating samples of known composition with high enough diversity. Here, we use in silico microbial datasets to better understand how the experimental data are transformed into taxonomic clusters by computational methods. Results: We were able to qualitatively replicate the raw experimental pyrosequencing data after rigorously adjusting existing simulation software. This allowed us to simulate datasets of real-life complexity, which we used to assess the influence and performance of two widely used pre-processing methods along with 11 clustering algorithms. We show that the choice, order and mode of the pre-processing methods have a larger impact on the accuracy of the clustering pipeline than the clustering methods themselves. Without pre-processing, the difference between the performances of clustering methods is large. Depending on the clustering algorithm, the most optimal analysis pipeline resulted in significant underestimations of the expected number of clusters (minimum: 3.4%; maximum: 13.6%), allowing us to make quantitative estimations of the bacterial complexity of real microbiome samples. Contact: a.may@vu.nl or b.brandt@acta.nl Supplementary information: Supplementary data are available at Bioinformatics online. The simulated datasets are available via http:// www.ibi.vu.nl/downloads.
INTRODUCTIONRapidly improving next-generation sequencing technologies have rendered 16S rDNA amplicon sequencing a standard approach to explore the composition and dynamics of complex microbial communities (). The accurate identification of bacteria and discovery of new species with this approach help describe, in unprecedented detail, the hitherto unknown biodiversity in environments such as ocean water () and soil (). On a broader scale, simultaneous sequencing of internal transcribed spacer regions, 16S and 18S rDNA amplicons has led to the successful characterization of bacterial, archaeal and eukaryotic microorganisms (). Within a clinical context, this technique provides novel insights into the relationship between the health status of the host and associated microbiome, for example, the human gut () or oral cavity (). A typical 16S rDNA-based profiling study involves PCR amplification of one or more hypervariable regions (HVRs) of microbial 16S rRNA genes, followed by massively parallel sequencing. Because incomplete 16S rDNA databases limit reference-based taxonomic classification (), a common approach is to perform a taxonomy-independent analysis (TIA), where the sequences (reads) are compared with each other and are clustered into operational taxonomic units (OTUs; conventionally 97% similarity for species-level clustering). The number and sizes of the resulting OTUs describe the diversity in the sample. Among next-generation sequencing platforms that are suitable for amplicon sequencing, 454 pyrosequencing has possibly been the most popular technique due to its relatively long reads and sufficient sampling depth (). Nevertheless, sample diversity and structure estimates based on this procedure are affected by a number of factors, including the DNA extraction method (), choice of primers (), copy number variation (), presence of chimeric () or non-target sequences (), sequencing errors (), and OTU clustering (). Among these, detecting chimeric sequences () and correcting sequencing errors () have perhaps been the most successfully addressed issues by computational means, resulting in a number of algorithms for data pre-processing that incorporate these corrective steps. The removal of such artifacts is key to avoiding accumulation of spurious records in databases (). More importantly, recent studies stress the necessity of data pre-treatment by pointing out that diversity estimates differ orders of magnitude depending on the pre-processing procedure used (). However, conclusive reports on how these methods work *To whom correspondence should be addressed. on a representative scale are limited due to the absence of ground truth in complex environmental datasets. Following pre-processing, accurate clustering of reads into OTUs facilitates the recovery of the community composition in the sample. However, numerous clustering methods used for TIA, such as single linkage or furthest linkage hierarchical clustering (), have been reported to yield considerably different results, and even small changes in algorithm parameters within individual methods can lead to vast differences (). In addition, differences in clustering algorithms, such as different criteria for the ordering of input sequences or the calculation of distance matrices, are likely to yield different clustering outcomes. The evaluation of the various data treatment and clustering methods and their use on real datasets have hitherto been limited to in vitro mock studies, where sample diversities are typically (at least) an order of magnitude less compared with those in real-life situations. Such limitations of in vitro studies have led to the development of simulation software, such as MetaSim () and Grinder (), which are capable of generating complex sequence datasets. These packages, which do not produce the 454-specific standard flowgram format, can be complemented by FlowSim () or 454Sim () to simulate flowgrams (the pyrosequencing output). Nevertheless, some aspects of 16S rDNA pyrosequencing are not amenable to implementation in simulations or cannot be incorporated at all. These include PCR efficiency, primer bias, 16S rDNA copy number variation and realistic read quality scores. Here, using in silico datasets, we aimed to provide an independent assessment of the accuracy and effects of computational techniques on delineating compositions of complex microbial communities using 16S rDNA pyrosequencing. We analyzed two low-complexity experimental datasets and derived data characteristics, which were then used to simulate datasets that are likely to mimic real-life complexity. We applied two widely used data pre-processing tools followed by 11 clustering algorithms on these datasets, and evaluated the accuracy of the resulting clusters using the normalized mutual information (NMI) score and the number of OTUs formed. The overall experimental design is shown in. We show that pre-processing methods have a larger impact on the results of the TIA pipeline than the clustering methods themselves. Without pre-processing, clustering methods were found to yield considerably different outcomes. The workflow that yielded the best agreement with the expected number of clusters resulted in significant underestimations of the expected number of OTUs, depending on the clustering algorithm used. We conclude with a discussion on how these new findings can be projected to earlier studies that describe the microbial complexity in human saliva samples.