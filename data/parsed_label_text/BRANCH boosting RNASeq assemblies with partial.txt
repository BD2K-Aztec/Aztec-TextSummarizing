Motivation: De novo transcriptome assemblies of RNA-Seq data are important for genomics applications of unsequenced organisms. Owing to the complexity and often incomplete representation of transcripts in sequencing libraries, the assembly of high-quality transcrip-tomes can be challenging. However, with the rapidly growing number of sequenced genomes, it is now feasible to improve RNA-Seq assemblies by guiding them with genomic sequences. Results: This study introduces BRANCH, an algorithm designed for improving de novo transcriptome assemblies by using genomic information that can be partial or complete genome sequences from the same or a related organism. Its input includes assembled RNA reads (transfrags), genomic sequences (e.g. contigs) and the RNA reads themselves. It uses a customized version of BLAT to align the trans-frags and RNA reads to the genomic sequences. After identifying exons from the alignments, it defines a directed acyclic graph and maps the transfrags to paths on the graph. It then joins and extends the transfrags by applying an algorithm that solves a combinatorial optimization problem, called the Minimum weight Minimum Path Cover with given Paths. In performance tests on real data from Caenorhabditis elegans and Saccharomyces cerevisiae, assisted by genomic contigs from the same species, BRANCH improved the sensitivity and precision of transfrags generated by Velvet/Oases or Trinity by 5.1–56.7% and 0.3–10.5%, respectively. These improvements added 3.8–74.1% complete transcripts and 8.3–3.8% proteins to the initial assembly. Similar improvements were achieved when guiding the BRANCH processing of a transcriptome assembly from a more complex organism (mouse) with genomic sequences from a related species (rat).
INTRODUCTIONRecent advances in next generation sequencing (NGS) technologies have transformed de novo sequencing of genomes and transcriptomes into routine tasks that are not only feasible for large sequencing centers anymore but also for individual research groups (). The main factors driving this development are reduced NGS run costs, and improvements of sequence volume and read length. Although it is now relatively straightforward to obtain a draft shotgun sequence of a new genome, fragmented into thousands of contigs and scaffolds, the finishing and annotation steps of a complete genome sequence are still very time consuming tasks. Transcriptome sequencing can be often a much more targeted alternative, especially when working with large genomes, or projects where the expressed gene sequences are the main features of interest to gain insight into the functionally relevant regions (e.g. proteins) encoded in a genome (). For an unsequenced organism, this includes the sequencing and assembly of RNA samples where most of the genes of interest are expressed, followed by functional annotation routines of the assembled transcripts using sequence similarity searches against protein reference databases. Subsequently, one can perform RNA-Seq gene expression profiling experiments where the assembled transcripts serve as reference in the read mapping step. Challenges related to transcriptome sequencing and assembly include the following: (i) abundance differences of RNA sequences make it difficult to obtain RNA samples representing most of the expressed genes of an organism and (ii) secondary structures as well as instability of RNA molecules can result in uneven read coverage of the underlying RNA sequences. As a result, transcriptome assemblies will usually only represent a subpopulation of genes in a genome, and the assembled RNA sequences are often fragmented or incomplete with respect to their full length. This study proposes a new method, named BRANCH, for improving the completeness of de novo transcriptome assemblies by making use of partial or complete genomic sequence information from the same or closely related species. It involves the initial de novo assembly of the RNA-Seq reads to transfrags and DNA reads to genomic contigs using existing NGS assembly software for both types of data. For instance, the genomic reads can be assembled with Velvet (), ABySS (), ALLPATHS (), SOAPdenovo () or IDBA (), whereas the RNA reads can be assembled with de novo transcriptome assemblers like Velvet/Oases (), Trinity (), Trans-ABySS (), SOAPdenovo-Trans () or T-IDBA (). In a downstream transcriptome assembly enhancement step, the genomic contig information is used to identify novel exons, extend incomplete transfrags and join fragmented ones using the BRANCH algorithm introduced in this study. This hybrid approach of guiding transcriptome assemblies with preliminary genomic sequencing information is a practical and cost-effective possibility, as one can sequence nowadays a genomic sample of a 1 GB genome of interest at 2050 coverage with the read output from only 12 flow cell lanes of a modern NGS instrument. Technically, the collection and sequencing of a genomic sample is also very straightforward, and stability issues or abundance variations of sequences are less a concern with genomic DNA than RNA. Alternatively, the genome contigs can be substituted by an existing genome sequence from a related species with high enough DNA sequence identity (usually 49095%) to the RNA-Seq sample. This option eliminates the need for generating the genomic contig dataset. The genomic sequences provide an additional backbone of evidence for improving de novo transcriptome assemblies by minimizing their typical errors and limitations, such as incomplete transfrags (e.g. missing exons), fragmented transfrags, chimeric transfrags, and so forth owing to low read coverage and base calling errors. When aligning the transfrags and RNA-Seq reads against given genomic contigs, one can extend and correct many of these fragmented or incomplete transfrags. For instance, two transfrags aligned next to each other on the same contig can be joined if a sufficient number of RNA reads can be aligned to support this merger. Similarly, a transfrag can be extended if the RNA read coverage along the corresponding region of the genomic sequences indicates a truncated transcript sequence. Because genomic contigs also contain errors, it is important to allow in this process only those transfrag modifications that are supported by high-quality alignments. BRANCH contains features that intersect in parts with reference-based splice variant assembly tools (sometimes referred to as ab initio assemblers;), such as the identification of splice variants from RNA sequence alignments against a reference. What makes BRANCH distinct from these tools is that it is designed to maximize the number and completeness of exons contained in preassembled transfrags guided by partial or complete genome sequences from the same or a closely related organism. It does this even for sequence regions with low RNA read coverage. This functionality is novel and relevant for de novo transcriptome assembly projects of unsequenced or only partially sequenced genomes because the additional exonic sequence information will contribute to the functional annotatability of the coding regions of RNA sequences in downstream protein similarity searches.