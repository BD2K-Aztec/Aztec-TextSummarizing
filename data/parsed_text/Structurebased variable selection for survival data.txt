Motivation: Variable selection is a typical approach used for molecular-signature and biomarker discovery; however, its application to survival data is often complicated by censored samples. We propose a new algorithm for variable selection suitable for the analysis of high-dimensional, right-censored data called Survival Maxâ€“Min Parents and Children (SMMPC). The algorithm is conceptually simple, scalable, based on the theory of Bayesian networks (BNs) and the Markov blanket and extends the corresponding algorithm (MMPC) for classification tasks. The selected variables have a structural interpretation: if T is the survival time (in general the time-to-event), SMMPC returns the variables adjacent to T in the BN representing the data distribution. The selected variables also have a causal interpretation that we discuss. Results: We conduct an extensive empirical analysis of prototypical and state-of-the-art variable selection algorithms for survival data that are applicable to high-dimensional biological data. SMMPC selects on average the smallest variable subsets (less than a dozen per dataset), while statistically significantly outperforming all of the methods in the study returning a manageable number of genes that could be inspected by a human expert. Availability: Matlab and R code are freely available from
INTRODUCTIONSurvival-analysis studies the occurrence and timing of events of interest. Often in medicine and biology, the event of interest is death, hence the name survival analysis; however, the field is much broader as the event of interest could be disease relapse or any other event. A typical characteristic of survival data is that they are often right-censored, i.e. the data may record subject i as alive (not having experienced the event) until time f i (follow-up time) but may not contain the exact time t i the event actually occurred. Excluding the censored data from the analysis systematically excludes the instances with higher probability of survival, and thus severely skews the results. Thus, typical variable selection and regression methods cannot be applied to model the time-to-event T. Unfortunately, it is often the case that analysis techniques cannot * To whom correspondence should be addressed. be trivially extended for survival data. Arguably, this is one reason why only a handful of variable selection methods are available for this type of data. Variable selection's primary aim is often to improve understanding of the data-generating process. For example, a biologist may be more interested in the genes predictive of survival, than in the actual predictive model. Presumably, the variables involved in an optimally predictive, minimal, irreducible model carry unique information that provides insight into the data-generating process (we discuss this issue in more detail in the sections to follow). Given the above observations, algorithms with clear semantics for the selected variables, and optimality properties are desirable. In this article, we adapt and evaluate an existing, successful and scalable method for variable selection called the MaxMin Parents and Children algorithm (MMPC;) to survival analysis; the method is based on the theory of Bayesian networks (BN) and Markov blanket-based variable selection () that has been recently shown to perform exceptionally well with complete (non-censored) data (). The MaxMin part of the name refers to the heuristic used in the algorithm regarding the order of consideration of the variables; the Parents and Children part of the name refers the structural interpretation of the selected variables: under certain conditions, they are the parents and children (adjacent nodes) of T in the BN representing the data distribution. We call the novel algorithm Survival MMPC (SMMPC). Under certain conditions, the selected nodes consist of an optimal set for prediction and minimum in terms of size. In other words, the selected variables contain no irrelevant (noise) or superfluous (redundant) variables, facilitating the interpretation of the model. For microarray data, the selected gene expressions always provide predictive information for survival, even when any other combination of gene expressions is known. Under certain conditions, this implies that no other gene is expected to be causally mediating the dependence. The set of parents and children is also connected to the set of direct causes of T ; the causal interpretation of the returned variables is also discussed. SMMPC is evaluated against a variety of prototypical and state-of-the-art variable selection algorithms that can scale up to the dimensionality often encountered in bioinformatics: Univariate Association Filtering, Forward Stepwise Selection, Bayesian Variable Selection (BVS) based on greedy search, Lasso Cox Regression (used as selection method) and Bayesian Selection based on Markov-Chain Monte-Carlo (MCMC). The variable selection methods are coupled with several survival regression methods. The evaluation is performed on several real, publicly available, highdimensional, gene expression survival datasets. The results include
V.Lagani and I.TsamardinosAlgorithm 1 SMMPC 1. procedure SMMPC(T , k, a) Input: T the target variable to predict, the maximum size of a conditioning set k, the threshold for rejecting independence a. Output: A subset of variables in V 2.an ordering of efficacy of both variable selection and regression methods as well as an analysis of the stability and learning curves of the methods.
R
SMMPCWe now present the SMMPC algorithm, and subsequently we discuss its theoretical properties and sufficient conditions for optimality and causal interpretation. The algorithm is essentially MMPC without the symmetry correction, as we call it, enhanced with a statistical test of conditional independence for censored data; it was first appeared infor complete data and in more detail in. The algorithm accepts the target variable T and two tuning parameters, k the maximum size of conditioning set and a the level for accepting dependence. We denote with V the predicting variables, T the time-to-event and C the time-to-censoring. What is observed is F = min(T ,C), the follow-up time, i.e. the time for which we have been gathering information about the patient. The censoring status = 1(T < C) takes value 1 for data that are observed (F = T ) and 0 for the cases are censored (F = C). Survival data D can be modeled as a set of m subjects indexed by i each represented by the triplet v i ,f i , i , where v i is the vector of n predicting variables, f i the follow-up time and  i the censoring status. The objective of SMMPC is to find the neighbors of T in a minimal BN representing the data distribution. Under certain conditions (see Section 3), this coincides with a minimum-size set of variables needed in order to optimally predict T. A basic component of SMMPC is a test of conditional independence using censored data. Let us denote with Ind(X;T |Z), X  V, Z  V the conditional independence of X with T given the variable set Z and with Dep(X;T |Z) Ind(X;T |Z) the corresponding dependence. The null hypothesis of the conditional independence test is that Ind(X;T |Z) holds in the data distribution; the dependence is the alternative hypothesis. We denote with p XT |Z the P-value provided by the test. If p XT |Z  a, where a is a user-defined threshold the null is rejected and we accept Dep(X;T |Z). Otherwise, the null hypothesis of independence Ind(X;T |Z) is accepted. The test of independence is the only place in the algorithm where the actual data are used. Intuitively, it seems that if a variable becomes independent of T given some Z it is superfluous for predicting T, i.e. given Z, X contains no additional information for T. SMMPC employs this basic premise to exclude from selection of all variables X for which it can find a Z  V \{X}, s.t., Ind(X;T |Z). The number of possible subsets for each variable is exponential and a brute-force approach is intractable. However, SMMPC employs BN theory to efficiently identify a Z for which Ind(X;T |Z) if one exist under the conditions stated in Section 3, and make the algorithm practical for even very high-dimensional datasets. In practice, only the conditioning sets with |Z|k are considered, because when |Z| is large, the statistical power of the tests is low. Prior experience with this type of algorithms () as well as the results in this article shows that most distributions are captured by sparse networks; this in turn implies that a small value of k is sufficient to filter out most variables. The basic premise that if Z, s.t., Ind(X;T |Z), then X is superfluous for predicting T is not always correct. Even if Ind(X;T |Z), it could still be the case that Dep(X;T |Z{W }) for some other W  V and X may become necessary for optimal prediction given additional variables. This case is discussed in detail in the sections to follow, where sufficient conditions for soundness are provided. The pseudo-code of SMMPC is shown in Algorithm 1. It begins with a set of candidate variables to consider R, initially set to all possible predicting variables V. The algorithm also maintains a set of currently selected variables S initially set to the empty set. It then removes from R any variable that becomes independent of T condition on some subset Z  S. Subsequently, it heuristically selects and moves a member of R into S and continues until R =. As a final step SMMPC removes from S any variables X for which Z  S \{X}, s.t., Ind(X;T |Z). SMMPC selects as the next variable to include in the S the one with the maximumminimum association with T over all subsets Z of S (hence the name MaxMin). Association of T with X given Z is measured by p XY |Z , so the smaller the P-value the larger the association. Intuitively, the heuristic selects next the variable that remains mostly associated with T despite our best efforts (i.e. after conditioning on all subsets of S) to make the variable independent of T. Recent theoretical results () also discovered another interesting interpretation: the MaxMin heuristic selects next the variable that minimizes an upper bound on the false discovery rate of the output (i.e. the false discovery rate of the identification of the Parents and Children set). The MaxMin heuristic is important both for the efficiency of the algorithm and the quality of the output but it does not affect the asymptotic correctness properties. In terms of time complexity, assuming the size of the final output PC is about the maximum size of S in any iteration and some optimizations are in place () the algorithm performs O(|V||PC| k ) tests of independence. Thus, for problems with sparse structure (few neighbors of T ), its complexity grows linearly to the number of variables.
Test of conditional independenceThe null hypothesis Ind(X;T |Z) of the conditional independence test implies that X is not necessary for predicting T when Z (and only Z) is given; under this condition, the conditional independence test can be thought of as a procedure for selecting the best between two nested models: a model predicting T given Z{X} and a model with only Z as covariates. We employ and evaluate the log-likelihood ratio and the local score test (), both on them based on the widely used Cox regression model (). Extensive experimentations showed that the former test is able to produce better results than the local score test by selecting almost the same number of variables in average, thus we retained only the log-likelihood ratio test for successive experiments. Details about tests implementation and comparative experiments are described in the Supplementary Section 1.
Page: 1889 18871894
SMMPCalgorithm. SMMPC, while conceptually simple, is based on relatively wellunderstood BN and Causal BN theory that can be used to analyze its properties and semantics. An expanded and more in-depth version of this section is included in the Supplementary Section 2.
BN structural interpretationMMPC and its extension, SMMPC, return variables with a specific structural interpretation in the BN representing the data distribution. We do not distinguish between the two versions of the algorithm when not necessary. We briefly review the related BN theory. A BN G,P is a directed acyclic graph G ==V,E and a probability distribution P, both defined on the set of random variables (nodes) V. In the remaining of this section, we assume V is the full set of variables, including T. G and P are such that the Markov condition is satisfied: every variable is independent of any subset of its non-descendant variables conditioned on its parents (). A faithful BN is one where in addition, only the independencies that are entailed by the Markov condition hold in P. In other words, the independencies stem directly from the structure (graph) of the network and are not accidental properties of the parameters. Distributions P for which there exist a faithful network G,P are also called faithful. When choosing parameters randomly for a given structure, the probability of obtaining a non-faithful distribution has Lebesgue measure zero and so one expects them to be 'rare' (although this may not hold in systems obtained by Natural Selection;). For a given distribution P, there may be many graphs G such that the BN G,P is faithful. However, the set of neighbors of a variable T (parents and children of T ) is unique in all networks faithful to the same distribution and denoted by N (T ). Let us also define the extended neighbor set of order k, denoted with EN k (T ) as the set of variables that are dependent on T conditioned on any subset of the N (T ) of size at most k. It is easy to see that EN k+1 (T )  EN k (T ). We will denote with EN (T ) the unrestricted cases for infinite k. In faithful distributions, it holds that N (T )  EN k (T ) for any k. In, we show the following:It is possible that MMPC outputs variables not in N (T ) under the assumptions, i.e. N (T )  MMPC(T ,). First, we note that this type of false positive has to be a descendant of T in the network; second, they can be removed to end up with the true N (T ) by performing additional executions of MMPC and by employing what is called the 'symmetry correction'. In, it was determined empirically that the overhead for the symmetry correction does not outweigh the theoretical benefits and that these cases are rare. Thus, we do not employ the symmetry correction in the algorithm and we will assume that N (T ) = EN (T ) and so MMPC(T ,,a) outputs N (T ) under the conditions above.
Optimality properties and relation to the Markov blanketIn this section, we examine conditions under which the selected variable subset N (T ) is optimally predictive and minimum-in-size. An emerging and principled approach in variable selection is based on identifying the Markov blanket of the variable T to predict (hereafter, the target variable). The Markov blanket of T (denoted as MB(T )) relative to a set of measured variables V is defined as a minimal set conditioned on which all other variables in V become independent of T [this is the Markov Boundary in the terminology of]: P(T |V \{T }) = P(T |MB(T )). Thus, all information for optimally predicting T is contained within the MB(T ) and, therefore, it may seem that this is a minimal set of variables required for optimal prediction. The latter statement is not true in general, however, as the learner and the performance metric used are important. For the MB(T ) to be the solution to the variable selection problem as it was defined above, two conditions are sufficient ():(1) The learner used to construct the prediction model can correctly estimate the distribution P(T |MB(T )).The above conditions often hold or hold approximately in many typical applications. Specifically in our experiments, we use several regression methods and optimize their parameters trying to find the one that best matches the distribution in order to satisfy Condition (1). In addition, the performance metrics usedare optimized only when full knowledge of T 's conditional distribution is optimized. Identifying the MB(T ) in the general case is a difficult problem. New theoretical results connect the MB(T ) with the structure of the BN capturing the data distribution and gave rise to time and sample-efficient algorithms for identifying the Markov blanket in faithful distributions represented by sparse networks; such algorithms include the MaxMin Markov blanket (MMMB;) and the HITON () algorithms. We now briefly present some of these results. Recall that N (T ) denotes the set of neighbors of T in any graph G faithful to the data distribution, while we use S(T ) to denote the set of all parents of common children of T not in N (T ). By definition, N (T )S(T ) =. In a faithful distribution it can been shown that MB(T ), N (T ) and S(T ) are unique. Thus, MB(T ) is not only minimal but also minimum; in addition, the Markov blanket has a graphical interpretation and specifically MB(T ) = N (T )S(T )i.e. the Markov blanket of T is the set of parents, children and parents of common children with T. In the Section 3.1, we show that SMMPC returns N (T ) under the assumptions stated, a subset of the Markov blanket of T. Let us now turn our attention to the remaining part, the S(T ) variables. Recall, the basic premise for selecting variables using MMPC is that if a variable X becomes independent of T given some Z it is superfluous for predicting T. In fact, variables in S(T ) are exactly the variables for which this assumption fails: for an X  S(T ), there exist a subset Z for which Ind(X;T |Z) (otherwise X would have an edge to or from T according to the theorem) but X is in MB(T ), and thus required for optimal prediction. There do exist techniques to identify S(T ) but would require more complicated method for tests of conditional independence with the censored-variable T as a covariate; as a first attempt at structure-based variable selection with censored data, SMMPC performs variable selection by approximating the Markov blanket of T with N (T ).
Causal interpretationIn recent work (), we have shown that in simulated studies with known causal structure, prominent-variable-selection algorithms indeed select subsets that lead to models with close-to-optimal predictive performance; unfortunately, however, the selected variables are distributed almost at random on the causal graph and so they could not be used to understand the domain. One could argue they are actually misleading. BNbased algorithms on the other hand, such as MMPC, output variables that also have a specific causal interpretation, under certain conditions discussed below. We will first assume the standard causal discovery setting of. That is, we assume that there exists a Causal BN defined on the observed variables V, that faithfully captures the data distribution. In that network, an edge X  T means that X is directly causing (affecting) the survival time: if one manipulates X (e.g. increase medication), a change in the distribution of T will be observed. In this case, the N (T ) is the set of neighbors of T in the causal network (and in any other network faithful to the distribution) and so
V.Lagani and I.Tsamardinosit is the set of direct causes and direct effects of T. Since in our setting of survival analysis all variables are measured prior to T , the output of MMPC in this case can be interpreted as the set of direct causes of survival. In addition, since T has no causal effects, S = and so MB(T ) = N (T ). In summary,The assumption of the distribution being faithful to a Causal BN has at least three subtle and implicit subparts. First, the causal mechanism is assumed acyclic, thus there should be no feedback loops. Second, a causal interpretation of the Markov condition (known as the Causal Markov condition) may be violated due to measurement noise. Third, the assumption of a faithful Causal BN for the distribution implies no hidden confounders, i.e. latent variables that are causes of two modeled variables. This assumption is called Causal Sufficiency in the terminology of. The implications of violations of these assumptions are discussed in detail in the Supplementary Material, as well as techniques to relax the assumptions. While possible violations of the assumptions require care in interpreting the output, we note that non-causally based algorithms fail to return causally meaningful variables even in simple simulated problems, where all of the above standard assumptions hold by design ().
REVIEW OF RELATED WORKSurvival data analysis has been an active field in statistics for decades and dozens of regression algorithms have appeared in the literature. The recent emergence of high-dimensional, biological datasets presents new challenges to all aspects of analysis (see van; Witten and Tibshirani, 2009 for a review of recent methods). A standard approach to deal with the high-dimensionality is to search for models that attempt to minimize both the error and the number of the coefficients of the variables, e.g. Survival Trees (), Ridge Cox Regression () and Lasso Cox Regression (). Another approach to address high-dimensional, survival analysis is to first reduce the dimensionality of the problem before applying regression. Dimensionality reduction methods for survival analysis tasks in bioinformatics include clustering algorithms (), principal component analysis () or partial least-square procedures (); see Nguyen and Rojo (2009) for an empirical comparison among different dimension reduction algorithms. General dimensionality reduction often transforms the data to lower dimensional spaces that are hard to interpret in terms of the original, input variables and measured quantities. Thus, dimensionality reduction is not appropriate in general when the goal of the analysis is to understand the effect of the measured quantities to the outcome variable. A restricted form of dimensionality reduction is variable selection, where the data are projected to a lower dimension space consisting of a subset of the original variables. Variable selection for regression and classification has been an intense field of study with hundreds of published algorithms, conferences and competitions (). Unfortunately, it is often the case that these algorithms cannot trivially be adapted to censored, survival data; thus, the number of available variable selection algorithms for high-dimensional, survival data is relatively low.
COMPARATIVE EVALUATIONThe comparative evaluation aims to address several questions of interest regarding regression and variable selection algorithms for high-dimensional, survival analysis tasks in bioinformatics. The primary goal of the evaluation is to validate the advantages of SMMPC over the prior state-of-theart in variable selection for high-dimensional, survival analysis tasks in bioinformatics. Each variable selection algorithm is coupled with several regression algorithms to identify the best combination. Interesting conclusions are also derived about the performance of regression algorithms and their interaction with variable selection methods.
Variable selection algorithmsWe consider general dimensionality reduction methods as out of the scope of this article, and focus on variable selection algorithms for high-dimensional survival data. We try to include as many methods as possible that have been applied to high-dimensional biological data. In addition, we found the BVS method in Faraggi and Simon (1998) interesting and intriguing; we have made simple adaptations to it so as to be applicable to high-dimensional data. A list of algorithms now follows:
No SelectionWe include No Selection (NS) (retain all original variables) as a baseline to compare against the performance of other methods. No parameter needs to be specified.
SMMPCThis is the procedure introduced in Section 2. The parameters to set (see Algorithm 1) are k the maximum-size conditioning set allowed and a the significance level threshold for rejecting conditional independence. The parameter values have been optimized within k {2,3} and a {0.05,0.10,0.15}.
Univariate SelectionThe variables are ranked in descending order of pairwise association with the time-to-event T , and the most associated variables are selected. We used the implementation by. The selected variables are the ones with p XT |  a, where a is a threshold provided as a parameter. The parameter value has been optimized within a {0.05,0.10,0.15}.
Forward SelectionThe method begins with the empty set as the selected predictors S. In each subsequent step, it adds the variable X that maximizes the association of T conditioned on (i.e. in the context of) S, i.e. minimizes p XT |S. We used the implementation by; this specific implementation of Forward Selection (FS) continues to add variables as long as |S| m, where  is a parameter and m the number of samples. The parameter value has been optimized within  {0.01,0.05,0.1} (the default value of the released code is 0.05).
BVS PrimeThe original BVS method first appeared in; unfortunately, this method requires performing intensive matrix operations, and does not scale 'as is' to high-dimensional data. Hence, in our implementation we introduced some minimal modifications in order to make the algorithm applicable to the tasks in our study: (a) perform Univariate Selection (US) to reduce the number of variables to consider; select only the top N variables (we use N = 100 in our experiments), (b) a FS procedure substitutes the backward-selection procedure, (c) the ridge Cox regression (see Supplementary Section 3) was used instead of the Cox regression, due to its robustness to high-dimensional data; a fixed penalty term  = 0.001 is used to fit the model. We name the resulting method BVS Prime (BVS ). The parameter  that we optimize is the hyperparameter corresponding to the SD of the priors of the coefficients. It is optimized within the set {0.1,0.5,1} (the authors suggest values between 0.1 to 0.5).
MCMC selectionThis method is also based on Bayesian statistics and is introduced in. It defines the prior distribution of the coefficients b as well as S, the selected variables over an Accelerated Failure Time (AFT) model. It then employs the MetropolisHastings method () to sample from the posterior distribution of b and S. As the authors suggest, we select the most probable a posteriori S as the output of the method. We employ the implementation provided by the authors.MCMC requires the specification of a large number of parameters; we set all but one to their default values; we specify c the expected number of selected variables to the number selected by SMMPC on the same task (see Supplementary Section 7 for further details).
Page: 1891 18871894
SMMPC
Lasso SelectionFirst proposed in Tibshirani (1997b), the Lasso algorithm adds a penalty term to the log partial likelihood of the Cox regression model: L(b)w||b|| 1. Penalizing the L1-Norm shrinks the coefficients of redundant variables towards zero; thus, variables to be eliminated can be easily identified. The major drawback of this method is that it requires the solution of a non-derivable optimization problem, leading to elevated computational times. We used the implementation provided by, that is considerably faster than other freely available codes. The only parameter to be optimized is w, i.e. the weight that regulates the influence of the penalty term; we varied its values within the set {0.1,1,10} (1 was the default value of the used implementation).
Regression algorithms
As demonstrated in Tsamardinos and Aliferis (2003) and Kohavi and John(1997), the interplay between variable selection method and the learner is important to identify the smallest variable subset with optimal predictive power. Thus, we couple each variable selection method with several regression methods in order to evaluate their performance. In particular, we employ Cox regression, Ridge Cox regression (), AFT models, Random Survival Forest (RSF; see) and Support Vector Machine Censored Regression (SVCR;), optimizing the performances of each regressor on a variety of parameters. We exclude Lasso regression (as a regressor, not as a variable selection method) as dominated by Ridge Cox Regression in this domain and task (). Supplementary Section 3 reports an exhaustive description of regressors and parameters that are optimized.
Dataset descriptionWe identify several micro-array, gene expression, independent public datasets of survival studies with censored outcomes used in prior comparative studies (). Summary statistics and references are reported in. For all but the last dataset, we consider the data as preprocessed by the authors; we log-normalize the data of the last dataset ().
Performance metricsMetrics of performance in the case of survival data is more complicated due to censorship: the error can only be computed exactly if the case is not censored. Thus, several specially designed evaluation metrics have been proposed in the literature, such as the Time-Depending area under the curve (AUC) (), the Weighted Classification Accuracy (), the CI () and the IBS (). We employ the latter two in this study.The CI measures the percentage of pairs of subjects correctly ordered by the model in terms of their expected survival time. Notably, we can determine t i > t j only when f i > f j and  j = 1, and similarly for the reverse relation. The pairs for which neither t i > t j nor t i < t j can be determined are excluded from the calculation of CI. When there are no censored data, the CI is equivalent to the Area Under the Receiving Operating Characteristic curve. Thus, a model ordering pairs at random (without use of the predicting variables) is expected to have a CI of 0.5, while perfect predictions would lead to a CI of 1. The Brier Score BS(t) measures the squared difference between the predicted survival probability and the observed outcome at time t, weighted for the loss of information due to the presence of censorship. The IBS consists in IBS = max (T ) 1 max (T ) 0 BS (t )dt. IBS measures the estimation error assigning a value of 0 when the distribution of S(T |v i ) is exactly estimated, while IBS = 0.25 is expected when predictions are random.
Parameter optimization and estimation of performanceA common procedure for parameter optimization is the use of a hold-out validation set. Each parameter combination is employed to learn a model on the training set and its performance is measured on the validation set. The best-performing parameter combination is then selected and a final model is learnt over all data (training plus validation). The best performance on the validation set is the maximum performance observed, and so it follows an extreme distribution. If a number of parameter combinations are attempted it is likely that the maximum observed performance is optimistic (the estimation is biased upwards; see Jensen and Cohen, 2000 for a discussion). Thus, a second hold-out set, a test set, is required for an unbiased estimation of performance. A drawback of the above protocol is that a portion of the data is not used for training. This is partially overcome by generalizing this procedure using cross-validation to what is known as nested N-fold crossvalidation (; Dudoit and van der). An outer cross-validation loop considers several test sets for estimation of performance. For each one of them, an inner cross-validation loop considers several validation sets (and corresponding training sets) to fit models, select the best parameters and fit a model on the train-validation data using the best parameters. Notice that, the test data are only used for performance estimation and never to fit a model or select parameters. We also note that parameter optimization in the inner loop depends on the metric used each time, i.e. CI or IBS.
Determining statistical significance using permutation testingWe employ permutation testing as a non-parametric way to determine the statistical significance of the difference in performance between two methods. Let us define M 1ij and M 2ij , the models produced by the two methods, respectively, on dataset i when the test set is fold j. Let us call 0 1ij and 0 2ij , the set of predictions of the models on the test fold j of dataset i. We define our test statistic i to be the average difference of performance between Methods 1 and 2 over all folds j of dataset i. We define as the null hypothesis H i the hypothesis that the E( i ) = 0. Under the null hypothesis, it does not matter whether the predictions come from 0 1ij or 0 2ij. We thus create 1000 permuted sets of predictions k 1ij and k 2ij , k = 1,...,1000 produced by randomly swapping with probability 50% each pair of corresponding predictions  1  0 1ij and  2  0 2ij. The test statistic k i is calculated on the corresponding permuted prediction sets. The empirical distribution of { k i } estimates the distribution of i under the null hypothesis. The P-value of H i is estimated as the percentage of times | 0 i || k i |, where 0 i is the statistic calculated on the original (nonpermuted) sets of predictions. We also define the null hypothesis that Method 1 produces more predictive models on dataset i than Method 2, denoted by H 1<2:i. Its P-value is simply the one-sided tail of the distribution, i.e. the percentage of times 0 i  k i. Similarly, we define the statistic as the Page: 1892 18871894of the size of the selected variable set, SMMPC selects on average the fewest number of variable, followed closely by LS. The range of performance between the best and the worst model (regressor) produced by each method is higher for the methods that select small variable sets (FS, LS, BVS and SMMPC). This implies that for such methods it becomes more important to identify the regressor that best matches the inductive bias of the variable selection technique.presents the P-values of the one-sided test of each method against each other method. A rough ranking of the four methods that select small variable sets, in terms of the predictive performance of the resulting models is SMMPC > BVS > LS > FS.shows for each variable selection method the best match for regression method. In terms of CI, methods that select a high number of variables (NS and US) are better coupled with Ridge Cox Regression (recall also that AFT and Cox Regression are not applicable when the number of variables is higher than the number of non-censored samples). LS has a tendency to be better coupled with RSF, while for the remaining methods the best regressor is highly dependent on the dataset. In terms of IBS, Ridge Cox regression is the most frequently chosen method (Supplementary).
V.Lagani and I.Tsamardinos
Comparing survival regression methodsIn this section, we turn the focus on the survival regression methods. The nested cross-validation procedure is employed for parameter optimization and estimation of performance. CI performances are shown infor the variable selection method that best matches the regression method (the P-values of the one-sided test comparing the performance of each method against each other method are give in the Supplementary). When considering the CI metric, a rough ranking of the methods is Ridge > SVCR > {RSF, AFT} > Cox. When we optimize for IBS, Ridge Cox Regression remains superior to all other methods and RSF significantly outperforms AFT models (Supplementary Tables 5 and 7). In termsThis conclusion is in agreement with prior studies pointing out the effectiveness and advantages of Ridge Cox Regression (). SMMPC stems from the BN theory, causal induction theory and variable selection using the Markov blanket concept. The results show that these theories and corresponding variable selection algorithms may transfer their performance and scalability qualities to other tasks than classification. Thus, the extension of MMPC to different variable selection tasks (e.g. to time-series) seems promising.
The Author 2010. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oxfordjournals.org 1887 at :: on August 31, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
THE THEORY AND INTERPRETATION OF SMMPC For a practitioner that employs variable selection for gaining insight and understanding in a domain, it is important to know in depth the theoretical properties and the semantic interpretation of the variables selected by an
at :: on August 31, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
The metrics are presented for the best-performing regression method; the numbers in parentheses show the range of the metric between the best and the worst regression method tried. Symbols + , ++ and +++ : SMMPC outperforms the corresponding method at the significance levels of 0.1, 0.05 and 0.01, respectively;  ,  and  : SMMPC is outperformed by the corresponding method at the significance levels of 0.1, 0.05 and 0.01, respectively. average i over all datasets and the null hypothesis H 1<2 that Method 1 produces models of higher performance than Method 2 on average in all the data populations in the study. The P-values of this hypothesis are estimated in a similar way. Regarding the prediction sets 1ij and 2ij , when the performance metric is the CI they consist of relative risk predictions RR(p,q) for each unordered pair p,q of patients in the test set (RR(p,q) = 1, if subject p is given a higher probability to survive longer than subject q). During permutations a relative risk for p,q as given by Method 1 may be swapped with a relative risk for p,q as given by Method 2. When the performance metric is the IBS, the prediction sets contain the patient-specific survival functions over all patients in the test set. During permutations a survival function for patient i as estimated by Method 1 may be swapped by the survival function for patient i given by Method 2. 6 RESULTS Experimentation results are now provided. Since the results in terms of CI and IBS are substantially in agreement, we report only CI performances. IBS performances as well as adjunctive results are reported in the Supplementary Section 8. 6.1 Comparing variable selection methods In this set of experiments, we compare the variable selection methods, namely NS, FS, Lasso Selection (LS), MCMC, BVS and SMMPC against each other. The MCMC procedure is so computationally costly that forced us to distinguish it from all other methods and use a simplified experimentation protocol to compare against. The details are in the Supplementary Section 7. SMMPC achieves a statistically significantly higher performance for both CI and IBS metrics, on most datasets individually as well as on all datasets collectively. Within the scope of our evaluation (particularly, the fact that we have used 50 000 iterations for the MCMC procedure), we consider the method dominated by SMMPC both in terms of computational efficiency and predictive performance of the resulting models. To compare against all other methods, the nested cross-validation procedure is employed for parameter optimization and estimation of performance. The results are shown in Table 2 for the regression method that best matches the variable selection method. SMMPC serves as the baseline to compare against and produce the P-values of the permutation tests. NS and US produce the highest performing models, even though the difference from SMMPC is not statistically significant for US and only marginally significant for NS (P = 0.052) considering the CI metric. However, this performance is achieved at the expense of employing a quite large number of variables in the models and thus, these methods are not suitable for knowledge discovery tasks. To further clarify the relation between US and SMMPC, we repeated the experiments for US restricting the method to only select at most the top f variables, where f is the number of variables selected by SMMPC on that fold. This restricted version is outperformed by SMMPC at a statistical level of 0.01 and 0.05 for CI and IBS, respectively, showing the SMMPC orders the variables better than US in terms of the cumulative predictive information they carry. We consider the remaining methods, namely FS, BVS , LS, and SMMPC suitable for knowledge discovery, as they reduce the number of variables to a human-management size of less than a dozen. Comparing these methods on individual datasets does not provide a clear picture. However, over all datasets SMMPC produces higher performing models in terms of CI than all other methods (P < 0.05). With respect to IBS, the same conclusions hold against FS and BVS even though the significance levels increase. In terms
DISCUSSION AND CONCLUSION We adopt a successful variable selection method for classification for survival analysis tasks, named SMMPC. SMMPC is relatively simple, scalable to high-dimensional data and has a structural BN interpretation: it identifies the neighbors of T (the timeto-event) in the network representing the data distribution. In an extensive comparative evaluation over several datasets and regression methods, SMMPC is shown to statistically significantly outperform Bayesian Selection based on MCMC techniques, Bayesian Selection based on a greedy-search modified for highdimensional data, Lasso Cox Regression (treated as a variable selection procedure), FS and US restricted to return as many variables as SMMPC. SMMPC selects fewer than a dozen variables per dataset making analysis of the models amenable to human experts. Relative to the other methods tried, SMMPC is 'stable' in terms of the returned variables (Supplementary Section 5). Finally, SMMPC shows a sharp learning curve in terms of available sample size (Supplementary Section 6). Further analyzing the results, shows that the performance of the regression methods is ordered as Ridge Cox Regression > SVCR > {RSFs and AFT} > Cox Regression.
