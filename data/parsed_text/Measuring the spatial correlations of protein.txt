Motivation: Understanding the interactions of different DNA binding proteins is a crucial first step toward deciphering gene regulatory mechanism. With advances of high-throughput sequencing technology such as ChIP-seq, the genome-wide binding sites of many proteins have been profiled under different biological contexts. It is of great interest to quantify the spatial correlations of the binding sites, such as their overlaps, to provide information for the interactions of proteins. Analyses of the overlapping patterns of binding sites have been widely performed, mostly based on ad hoc methods. Due to the heterogeneity and the tremendous size of the genome, such methods often lead to biased even erroneous results. Results: In this work, we discover a Simpson's paradox phenomenon in assessing the genome-wide spatial correlation of protein binding sites. Leveraging information from publicly available data, we propose a testing procedure for evaluating the significance of overlapping from a pair of proteins, which accounts for background artifacts and genome heterogeneity. Real data analyses demonstrate that the proposed method provide more biologically meaningful results. Availability and implementation: An R package is available at
IntroductionUnderstanding the regulatory mechanism of gene expression is an important goal in functional genomics research. It is widely believed that the regulation of transcriptional process involves the combinatory controls of different regulation including protein bindings, histone modification and DNA methylation (). DNAbinding proteins such as transcription factors (TFs) bind to the DNA and thereby either activate or repress the expressions of nearby genes. There are extensive interactions and cooperations among different DNA-binding proteins in order to provide precise gene expression regulation (). The interactions among proteins can often be inferred from exploring the spatial correlation of their binding sites. For example, if the binding sites of two proteins significantly overlap, it is very likely that they interact in some manner. Thus, exploring the spatial correlation of binding sites is an important first step toward understanding the interaction of proteins. The genome-wide profiling of protein binding sites has become an easy procedure, thanks to the rapid advances of high-throughput sequencing technologies such as ChIP-seq (). With the continuous reduction of sequencing cost, it has become a common task for a scientist to map the binding sites of a few proteins under biological conditions of interest, and then compare them with each other or with public data. These results provide information for potential interactions and co-bindings of the proteins. Tasks like this require methods to assess and quantify the spatial correlations of binding sites.Given the binding sites (in the form of genomic regions) of two proteins, it is often of interest to know whether the binding sites significantly overlap. A straightforward approach is to perform statistical test based on a 2  2 table. To do so, one would segment the genome into small bins (such as a few hundred base paris), and use a binary vector to represent the presence/absence of binding for a protein. Then the co-occurrence pattern of the two binding sites can be represented by a 2  2 table. The statistical significance of the overlaps can be assessed using Pearson's v 2 test or Fisher's exact test, and the overlaps can be visualized by a Venn Diagrams (). Unfortunately, such an approach is strongly influenced by the heterogeneity and tremendous size of the genome (details provided in next section). As a result, almost all pair-wise comparisons give significant results. Although constraining analysis to a smaller subset of the genomic regions can reduce the overall genome size and decrease the genome heterogeneity to certain degree implicitly (), simple procedures such as Fisher's exact tests targeting at limited regions still lack systematic treatment of the genome heterogeneity and fails to account for the background artifacts. Approaches based on distance metrics () have also been proposed to measure the similarity of two lists of genomic regions. These approaches, however, don't consider the genome heterogeneity, thus also suffering from inflated significance. Considering the genome heterogeneity, Bickel et al. (2010) developed a subsampling randomization test procedure and a software package Genome Structure Correction (GSC) to assess the overlaps between two region lists. The method assumes that the genome is block stationary, and the overlapping ratios are different in each block. The genome segmentation is estimated from data using a dyadic segmentation approach. However, the segmentation completely depends on the overlapping of the two given lists of regions and thus could provide unstable results. Moreover, the validity of GSC relies on the assumption that the ratio of the number of segments and the total length of the genome goes to zero. That requires the length of each stationary block to be very large, thus the genome segmentation is rather coarse, and the adjustment of genome heterogeneity is insufficient. Additional works on analyzing relationships of genomic regions are available, for example, using multivariate hidden Markov model (HMM) to characterize the combinatory histone patterns across the genome (), or assessing the reproducibility of two replicates for a single TF using a copula mixture model (). These methods, however, are not directly applicable in assessing the strength of correlation of two lists of binding sites. In this work, taking advantage of the rich collection of public data, we systematically investigate the pairwise overlapping of many protein binding sites. We discover through extensive real data analyses that many seemingly significant overlaps of binding sites are actually results of phenomena in a similar flavor as the Simpson's paradox. We therefore propose a new method to adjust for genome heterogeneity and correct the experimental biases. Real data analyses demonstrate that our proposed method outperforms traditional association tests in determining statistical significance as well as providing more biological relevant ranking.
Methods
Data explorationWe obtained the binding sites (peaks called from ChIP-seq data) of 36 proteins in K562 and GM12878, the two most extensively studied cell lines in the ENCODE project (). Here we focus on the overlapping patterns of proteins in K562. Results for GM12878 are presented in the supplementary materials, which are shown to have similar patterns. To evaluate the overlapping of a pair of proteins, we first segment the whole genome into bins of 1000 base pairs (bp). For a protein, each bin is annotated as 0 or 1 according to the absence or presence of its binding peaks. Then for a pair of proteins, a 2  2 contingency table in the format ofis constructed to present the co-occurrence pattern of binding sites. Under this setting, assessing overlapping can be formulated as testing whether the presence of binding sites over the genomic bins for the two TFs are independent, which can be achieved by a v 2 test. Unfortunately, the v 2 test claims significance for 627 out of the total 630 pairs of TFs for K562 at significance level of 0.05 (594 out of 595 pairs for GM12878). In the 2  2 table, under independence assumption, the expected value of overlaps C 22 is EC 22   N2N2 N .shows the observed C 22 versus EC 22  for all pairs of TFs: the observed are systematically greater than the expected overlaps, which leads to the significance results of almost all v 2 tests. The patterns showed inclearly demonstrate that a straightforward v 2 test provides inflated test statistics and exaggerates the significance of correlation, because it is implausible that all pairs of proteins have significant interactions. We carefully examine the data, and discover that the phenomena are mainly caused by three data artifacts. The first artifact is the heterogeneity of the genome. If one examines the correlations at different subsets of the whole genome, two lists of binding sites could be independent at all subsets but correlated marginally. We will provide more in-depth explanation of this point in next section. The second one is the experimental artifact. Some regions tend to have reads clustered and thus easier to be called as peaks. Peaks at these regions artificially increase the overlapping ratio. Thirdly, the sheer size of the genome can turn a tiny effect into statistical significance. Due to the large N, a slight deviation from the balance point of the 2  2 table will result in a tiny P-value, which gives practitioners a wrong impression of TF association strength. With the understanding of these artifacts, we sought to design a novel method to overcome the biases and provide more accurate results.
A Simpson's paradox in binding site correlationBelow we provide an in-depth explanation of the effect of genome heterogeneity on the overlapping analysis. Consider the following hypothetical toy example. Suppose the genome consists of two types of segments with 1000 bins and 100 000 bins, respectively. Two lists of binding sites appear independently in each type of bins (the corresponding 2  2 tables are shown in). Even though the binding sites are completely independent in both types of bins, the marginal table over the whole genome gives significant v 2 test results with an extremely small P-value (P < 2:2e  16). This phenomenon is similar to the well known Simpson's paradox in statistics, and is prevalent in genome-wide association studies (GWAS) and recent epigenome-wide association studies (EWAS).In GWAS, the disease status can be independent of the genetic markers within each subpopulation. However, collectively for a heterogeneous sampling population, spurious associations between disease and makers arise when the population structure is not considered (). In EWAS, celltype composition additionally confounds the relationship between epigenetic makers and diseases (). We suspect that similar phenomenon exists in protein binding sites. If one considers the genome heterogeneity and separates the genome into different segments, two lists of proteins binding sites could appear rather independently in each segment, and yet they correlate marginally. To verify our hypothesis, we segment the whole genome according to the ChromHMM results (). ChromHMM implements a multivariate hidden Markov model, based on histone modification status, to segment the genome into 15 different states. We obtained the genome segmentations for K562 and GM12878 from ENCODE, and constructed a 2  2 table for each type of genome segments. Then in genome segment type s (s  1;. . ., it is clear that the discrepancies between observed and expected overlaps are much smaller. The discrepancies are very small in the three types of promoter regions, as the dots are almost on the diagonal lines. The discrepancies still exist in other regions, albeit in a much smaller scale. Thus, we conclude that the genome segmentation does alleviate the discrepancies between observed and expected overlaps compared to on the whole-genome scale. These figures also reveal that there is a heavy left 'tail' in the lower end at some segments, especially the longer ones such as the repressed regions and heterochromatins. These tails are likely to be caused by the technical artifacts, that is, some regions tend to have reads clustered and be called as peaks. With these understandings, we design a method to correct the background overlaps and propose a statistical testing procedure to more objectively assess the significance of overlaps between the binding sites of a pair of proteins.
Model the overlapsWe propose the following method to correct the background overlaps of two lists of protein binding sites. The method is based on an assumption that a majority of the protein pairs don't interact. This assumption implies that ideally (after proper correction), the dots inshould be around the diagonal lines in all segments. Similar assumption has been the foundation for many different types of differential analysis since early gene expression microarray days, e.g. a majority of the genes are not differentially expressed (). Various methods designed for calling differential protein binding are also based on the assumption that a majority of the binding sites don't change (). Under this assumption, we design the following method. To simplify notations, we denote C is 22 by Y si , representing the observed overlaps for the i th pair of TFs in genome segment type s.(a) K562 and (b) GM12878 cell linesWe further denote the expected overlaps computed from the 2  2 table, under independence assumption that two proteins don't interact, by X si. As mentioned, EY si  6  X si , so one observes discrepancies shown in. Our goal is to estimate the 'true' expected overlaps under independence, denoted as l si , and then construct a statistical test for independence of two lists of binding sites. We use the following model for l si , which is assumed to be a function of X si : l si  c s  expff s logX si g:The model is motivated by the real data observation in.Here c s is a small constant representing the 'baseline' overlap for genome segment type s. It means that when X si is very small (literally no expected overlaps between two lists of binding sites), one still observes some overlaps due to technical artifacts. This constant is used to account for the heavy left tail observed in some regions as shown in. When X si is large, c s becomes negligible. f s  characterizes the relationship between l si and X si on the logarithm scale. The model parameters are c s and f s for each s. When the estimates for these parameters are available, l si can be estimated given logX si , and then a test statistics can be computed. We adopt the following procedure to estimate the parameters, based on the assumption that most pairs have no interaction. c s is estimated from pairs of proteins with small X si. Specifically, let t be the cutoff for the set of small X si , and A s  fi : X si < tg be the resulting set. Then, c s is estimated as the average observed overlaps in setBy default, we use t  1 in real data analysis. In practice, we find the choice of t does not affect the final result much. Meanwhile, f s  is estimated by locally weighted scatter plot smoothing (lowess) () for pairs with reasonably large X si : ^ f s  lowesslogY si $ logX si  for i 6 2 A s. With the estimates, we plug in to obtain the estimates for l si : ^ l si  ^ c s  expf ^ f s logX si g: We applied the procedure to the K562 and GM12878 data.shows the observed (Y si ) versus corrected expected overlaps (^ l si ) from K562 data. Similar figure for GM12878 is shown as Supplemental. As expected, the dots are now scattered around the diagonal lines, indicating that most pairs of proteins don't interact, so that there is no discrepancies between observed and expected overlaps.
Testing procedureWith ^ l si available, we use the following testing procedure to assess the overlaps. Denote the total number of bins for segment type s as N s , we assume that the observed overlap Y si for the i th pair of proteins in segment s follows a Binomial distribution of BinN s ; p si . p si is the probability of observing overlaps in segment s, and is estimated as ^ p si  ^ l si =N s. Then based on the normal approximation to the Binomial distribution, the test statistic in segment s can be calculated as:This procedure provides one test statistic for each genome segment. We examine the distribution of these test statistics, and provide a QQ plot of t si against standard normal distribution in Supplementary Figures S2 and S3. The figures show that t si follow normal distribution reasonably well in each segment. To assess the overall association between a pair of proteins, one wants to aggregate the statistics from all segments and come up with a single score. We define the aggregated score, for the i th pair of protein, as T i  P s t 2 si. Technically, if t si follow independent normal distributions, T i should follow a v 2 distribution under null. However, results show that T i does not follow a v 2 , partly because of the correlations among t si for different s. We use the following procedure to empirically generate the null distribution of T i. We assume that no (or very few) pair of proteins 'repel' each other. In other word, the binding sites of proteins do not exclude, or the observed overlaps usually are not significantly lower than expected. Under this assumption, the left parts of t si represent the null distributions for each segment type. This can be empirically seen from Supplementary Figures S2 and S3, where the left tails of the distributions in all segments are much lighter than the right tail. Then for each segment type s, we randomly sampled N 0 items from ft si : t si < 0g with replacement. Denote the sample by ~ t j s ; j  1;    ; N 0 , we compute ~ T j  P s  ~ t j s  2 , and use its empirical distribution as the null distribution for T i. For the i th protein pair, the P-value for the overall association can be calculated as P ~ T j > T i .
SoftwareThe proposed method has been implemented as freely R package. We are in the process of submitting the package to Bioconductor(). The software package is temporarily available at http://www.sta.cuhk.edu.hk/YWei/ChIPCor.html.
ResultsWe first look at the distribution of the test statistics and p-values from K562 data.(a) shows the QQ plot of T i versus ~ T j .The lower part of the T i distribution follows the null very well. The heavy tail in the upper part represents the protein pairs that exhibit significant overlaps. Overall, the background correlation with the statistical test procedures provide reasonable results.(b)shows the histogram of the resulting P-values P ~ T j > T i , which behave reasonably well with a spike close to 0 and the rest approximately following a uniform distribution. Finally, we turn P-values into q-values, the minimum false discovery rate to call a test significant (), to control for multiple comparison. We further assess the binding site correlations for proteins from K562 and GM12878 cell lines. In all analyses, we set the cutoff t for choosing small X si as 1, and the number of random samples to construct the empirical null distribution N 0 as 10 000. We apply the above procedure to all pairs of proteins to assess their spatial correlations. Here, we discuss the results for several important proteins. We first look at MYC (c-Myc), which is an important TF in cell cycle progression, apoptosis and cellular transformation. We calculate the correlations of MYC with all the other proteins with data available from ENCODE using different methods, including our proposed method and the traditional Pearson's v 2 test. We also intended to compare our results with GSC. Unfortunately, GSC is unavailable from ENCODE anymore, thus the comparison cannot be performed.provides results for all proteins, where the proteins are ranked based on their association strengths with c-Myc. The rankings are based on v 2 test statistics and the proposed T i statistics, respectively. First, results from v 2 test indicate that all proteins are significantly overlapped with c-Myc (v 2 P-values are not provided since they are all very small). From the proposed method, however, only 7 proteins show significant overlap with c-Myc. We believe that the proposed method provides more meaningful results since it is more plausible that only a few instead of all proteins interact with c-Myc. We further look at the rankings of the proteins, which provide important information for the degree of interactions. From v 2 test, Hey1 is the top rank TF. However from our proposed method, it only ranks at the 11th with q-value 0.14, becoming insignificant. On the other hand, the top rank TF by our proposed method is Max (Myc Associated factor X), which is well known to interact with c-Myc ().highlights the Hey1c-Myc and Maxc-Myc pairs (in red and blue dots respectively) in the scatterplots. It can be seen clearly that Max has substantial deviations from the adjusted expected overlaps in most segment types. In contrast, Hey1 is much closer to the adjusted expected overlaps under the independence null assumption. These demonstrate that it is more reasonable that Max has stronger correlation with c-Myc. The figures also show that the most significant correlations between Max and c-Myc happen at poised promoters and various enhancer regions. We further explore the results for c-Fos. Results are provided in Supplementary Table S1. Again, v 2 test indicates that all proteins are significantly overlapping c-Fos, whereas the number of significant proteins is 11 from the proposed method. Looking at the rank of the proteins, Pol2, c-Myc and Hey1 are ranked among the top 10 from v 2 test. From the proposed method, they rank 14, 21 and 22 respectively, and none of them is significant. All four proteins (c-Fos, Pol2, c-Myc and Hey1) heavily bind to the promoter regions, thus their overlaps are significant on the genome-wide scale. However, our results indicate that there's no statistical evidence that these proteins have interaction or co-binding. We conduct literature reviews on these proteins. Even though there are reports on the co-appearance on these proteins, no conclusive evidence has been shown for their interactions. Furthermore, we look at the results for CTCF, an insulator-binding protein (Supplementary(a) Q-Q plot of T i versus ~ T j (b) Histogram of P  ~ T j > T i In addition, we explore the IRF4 protein from GM12878 cell line. IRF4 belongs to the IRF family and is well known for combinatorially collaborations with other TFs (). From Supplementary Table S3, we can see that 9 TFs overlaps with IRF4 at false discovery rate of 5%. In particular, the proposed method ranks JUND rather high (at the third place) compared to the v 2 test (at the 10th place), and JUND is recognized as a crucial factor for IRF4-mediated transcription (). Once again, the proposed method offers more biologically plausible results. Moreover, we investigate the robustness of the proposed method to the number of TFs used to train the model for artifacts and genome heterogeneity correction. We take the K562 data, randomly sample a subset of the 36 TFs, and use these TFs to fit the model for correcting artifacts and genome heterogeneity. Based on the estimated model, we then evaluate correlation strengths for the subsampled TFs as well as for all 36 TFs. We repeat such procedure for 10, 20 and 30 TFs. We find that even with only 20 TFs, the results are very similar to the one from using all 36 TFs (comparing Supplementary Figures S4S9 to, the observed versus corrected expected number of overlapped binding sites), and the test statistics t si 's in each segment behave well according to QQ plot (Supplementary Figs S10S12). The ranking of TFs in terms of association with c-Myc by our proposed method based on 20 and 30 TFs are provided in Supplementary Tables S4 and S5, which are very similar to the ones from using all 36 TFs. Nevertheless, when the number of training TFs drops to 10, the estimation of P-values becomes unstable, even though the relative ranking of TFs remains similar to the ones from using more TFs (Supplementary Tables S6).These results demonstrate that our proposed method will work properly even with a reasonable number of TFs. On the other hand, we acknowledge that more training TFs is always preferred for leveraging additional information to better model the background artifacts. For real application, we recommend including at least 20 TFs into the database so that in total around 200 TF pairs will be used to train the model. The rapid accumulation of ChIP-seq experiments in the public repositories will help enhance the power of the proposed method. Among the ChromHMM segmentation, some regions such as heterochromatin are known to be less informative for assessing TF binding because the peaks in such regions are more likely to be artifacts. To investigate this, we reanalyze the data by excluding the heterochromatin. However, results are almost identical and the ranks of TFs are exactly the same. This indicates that including the less informative regions would not have much impact on the final result, thus we recommend keeping all ChromHMM segment types in analysis to avoid any subjective selection of genomic regions. Overall, by controlling for genome heterogeneity and correcting for background artifacts, the new testing procedure allows more accurate assessment of the real interaction and collaborative binding patterns of proteins. Compared with traditional method such as v 2 test, our results are improved in two aspects. First, it provides a better ranking for the association strength with a certain protein. We acknowledge, however, that without gold standard (the true ranking of association strengths), it is very difficult to comprehensively evaluate and compare the performance of ranking. Nevertheless, the ranks from our proposed method agree with the prior biological knowledge better overall. Secondly, the proposed method provides statistical significance is more biologically plausible. This will be particularly important in experiments where only a few proteins are profiled and their relationships are evaluated, and the scientists really care if the proteins have 'significant' interaction. Traditional methods provide statistically significant results (tiny P-values) for almost all pairs of proteins, which is not plausible. In this case the ability to draw better statistical inference from our proposed method will be especially helpful.
DiscussionIn this work, we focus on assessing the significance of binding sites overlaps. Existing methods mostly fail to consider the genome heterogeneity and experimental artifacts, thus over-estimating the correlations and exaggerate the statistical significance. By carefully exploring the real data, we discover a Simpson's paradox phenomenon in the genome-wide overlapping patterns of protein binding sites, and we show that the genome heterogeneity plays an important role in the seemingly significant results from the traditional methods. We propose a new method to correct for genome heterogeneity and background overlaps, and then develop a statistical test procedure by leveraging information from historical data in large public data repository. Real data analysis shows that the proposed method provides more statistically meaningful and biologically interpretable results. We want to emphasize that the idea of considering genome heterogeneity in assessing TFBS correlation is not completely absent in literature. The essence of the proposed method is similar to the one proposed in () and implemented in GSC, that is, the genome is assumed to be block stationary and the correlations need to be evaluated at different segments of the genome. The difference is that GSC relies on the binding sites of a pair of proteins to perform genome segmentation, whereas our proposed method utilize the genome segmentation provided by ChromHMM. The ChromHMM segmentation leverages information from other data (histone modification ChIP-seq) and provide finer, more biological meaningful segments. These results subsequently improve the inference in assessing binding sites overlaps. Note that our method depends on the availability of ChromHMM segmentation, which is not always available. A very recent paper ChromImpute () supplements ChromHMM by offering an approach to impute epigenomic data and providing genome segmentation based on the imputed data. We believe this method will provide a meaningful segmentation as long as there are some epigenomic data available for a given sample. For biological samples without any available epigenomic data, we recommend segmenting the genome based on other existing data such as genome annotations. The genome can at least be separated into promoter/exonic/intronic/intergenic regions. Other annotations like CpG island and repetitive regions can also be used for better segmentation. Interactions among different regions can be introduced as well. For example, promoter regions can be separated into GCrich and GC-poor promoters. We believe that finer segmentation and more genomically homogeneous segments will provide better results in assessing protein binding interaction. Another important point is that the data used for genome segmentation must be independent of the protein binding data, so that the confounding can be eliminated. Our software package provides an option for users to provide their own genome segments. The proposed method operates on the peaks detected from ChIPseq data, and the raw read counts data are not considered. We believe the correlations in the presence/absence of peaks will be more robust than the correlations in read count level, which is prone to technical artifacts. One concern is that different ChIP-seq peak caller could potentially affect the correlation results. However, we use a rather large window size (1000 bp) to define overlaps and expect the results to be robust against the choice of ChIP-seq peak callers. Using a relatively larger window size will also include the 'closeness' relationship, because peaks spatially close to each other but not exactly overlapping could fall into the same bin and be counted as overlap. The method proposed here is specifically designed for measuring the overlaps of short peaks. For longer peaks, or 'blocks' such as the peaks detected from H3K9me3 histone modification data, the method might not be directly applicable. The method can potentially be applied to assess the spatial correlation of other short genomic features, such as euchromatin island () or DNase I hypersensitive site (). To comprehensively reassess the spatially correlation of different genomic features is our research plan in the near future. The assumption of pairwise independence of most pairs of proteins is the fundamental of the proposed method. However 'most' is a rather loose term, and we believe as long as more than half of the pairs are independent, the method will work well. Even if the assumption is violated, the final result will be on the conservative side (under-estimate the significance), which is more desirable than overly optimistic (over-estimate the significance). Moreover, with the exponential growth of next generation sequencing datasets and their publicly availability, the null distribution can be updated and improved with inclusion of new data.
Y.Wei and H.Wu
