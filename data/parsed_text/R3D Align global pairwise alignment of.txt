Motivation: Comparing 3D structures of homologous RNA molecules yields information about sequence and structural variability. To compare large RNA 3D structures, accurate automatic comparison tools are needed. In this article, we introduce a new algorithm and web server to align large homologous RNA structures nucleotide by nucleotide using local superpositions that accommodate the flexibility of RNA molecules. Local alignments are merged to form a global alignment by employing a maximum clique algorithm on a specially defined graph that we call the 'local alignment' graph. Results: The algorithm is implemented in a program suite and web server called 'R3D Align'. The R3D Align alignment of homologous 3D structures of 5S, 16S and 23S rRNA was compared to a high-quality hand alignment. A full comparison of the 16S alignment with the other state-of-the-art methods is also provided. The R3D Align program suite includes new diagnostic tools for the structural evaluation of RNA alignments. The R3D Align alignments were compared to those produced by other programs and were found to be the most accurate, in comparison with a high quality hand-crafted alignment and in conjunction with a series of other diagnostics presented. The number of aligned base pairs as well as measures of geometric similarity are used to evaluate the accuracy of the alignments. Availability: R3D Align is freely available through a web server http://rna.bgsu.edu/R3DAlign. The MATLAB source code of the program suite is also freely available for download at that location.
INTRODUCTIONAlignments of homologous RNA sequences can provide great insight into the structures, functions and evolutionary histories of RNA molecules. As is the case for proteins, alignment procedures based solely on sequence similarity will also correctly align secondary structure features of RNA, when sequence similarity is high. But such methods are inadequate for RNA homologs that have diverged significantly in sequence, and alignment methods that take into * To whom correspondence should be addressed. account WatsonCrick base-pair co-variation are needed to obtain accurate alignments that reflect the conserved secondary structure. Homologous RNA molecules share a core conserved secondary structure and 3D structure. As more 3D structures of RNA homologs appear, robust methods for simultaneous alignment at multiple structural levels, sequence, secondary structure and 3D structure are needed that can reveal the common structural features. This knowledge, extracted from the extant 3D database, can in turn guide efforts aimed at efficiently aligning the exponentially growing number of homologs known only from sequence (). For example, although only a handful of atomic-resolution 3D structures of ribosomal RNAs are known, hundreds of thousands of homologs have been sequenced. We have 3D structures of three bacterial and one archaeal 23S rRNAs, the bacteria Thermus thermophilus (T.th.), Escherichia coli (E.coli) and Deinococcus radiodurans (D.r.) and the archaeon H.m. In previous work, we produced hand-crafted alignments of these structures, a non-trivial task for which no software existed at the time (). Because producing a hand-crafted alignment is a labor-intensive and time-consuming process, and in light of the rapid increase in 3D RNA structures in the PDB/NDB (), we were motivated to develop automated tools to align RNA 3D structures in a robust manner. This article reports a successful effort to do so. For the purposes of this article, an alignment of two RNA structures is a list of correspondences between individual nucleotides from the two RNAs. In every alignment, we require that the correspondences be well-ordered (if nucleotides i and j are aligned with nucleotides i and j , respectively, then i < j if and only if i < j ) and uniquely assigned (no nucleotide should be aligned to more than one nucleotide from the other RNA). A number of research groups have developed programs for aligning RNA 3D structures, and we briefly review previous work in this section. DIAL () aligns RNA 3D structures using a quadratic time dynamic programming algorithm that includes terms for similarity in nucleotide sequence, base pairing and nine torsional angles used to describe the RNA backbone. The nine torsional angles include six dihedral angles () used to define RNA backbone conformations and the dihedral angle () that describes rotation about the glycosidic bond (). It also uses two additional virtual angles  and , introduced in () and reintroduced in (). SARA () performs pairwise RNA 3D-to-3D alignment by implementing a unit-vectorPage: 2690 26892697
R.Rahrig et al.representation of RNA structures that calculates a set of vectors between consecutive atoms. Quadratic-time dynamic programming algorithms are then applied to the reduced unit-vector representation of the structure. The SARA algorithm was inspired by the MAMMOTH program for protein structure alignment (). SARSA () is a web tool that can be used to align two RNA structures using the PARTS application. PARTS reduces the 3D structure into a 1D sequence of letters selected from an RNA structural alphabet of 23 letters that represent distinct and common backbone conformations. Quadratic-time dynamic programming sequence alignment methods are then employed on these 1D encoded sequences. Thus, the approach used by DIAL, SARA, and PARTS for constructing a 3D-to-3D alignment of RNA is to extract particular classes of information from the 3D structure, create a reduced, essentially linear, representation of the RNA structure, and then utilize a quadratic-time sequence alignment algorithm on the reduced representation. While these programs are certainly useful because they are able to produce alignments quickly, it has been noted that due to the complexity of RNA 3D structural alignment, one cannot rely on a quadratic time algorithm to be highly accurate (). ARTS () represents each nucleotide by the position of the phosphorus atom in the backbone. ARTS seeks the single rigid transformation that maximizes a weighted scoring function based on both the number of corresponding nucleotides and base pairs. This method can be used to discover previously unknown common substructures. ARTS is not constrained to produce wellordered alignments, enabling non-sequential common substructures to be discovered. ARTS is a heuristic algorithm of complexity O(n 3 ). In this article, we introduce a new methodology for alignment of RNA 3D structures and a web server, and program that implements this methodology. We call this program R3D Align, which stands for 'RNA 3D Alignment'. A notable feature of R3D Align is that it is able to accommodate the flexibility that exists among RNA 3D structures. ARTS is not designed to align large, conformationally flexible RNA 3D structures because it uses a single rigid transformation to find corresponding nucleotides. Thus, ARTS typically leaves entire regions unaligned, even though the regions themselves may superpose very well locally. This will be illustrated in the Section 3. R3D Align accommodates local conformational flexibility by using many superpositions of local neighborhoods rather than a single global superposition. The local neighborhoods are formed so as to take into account pairwise nucleotide interactions of all types, including non-WatsonCrick as well as WatsonCrick base pairs. In addition to local base pair interactions, the program considers long-range (tertiary) base pair and base-stacking contacts. Although we account for and use all local and long-range pairwise interactions, we work directly with the geometry of the 3D structures in order to maintain independence from any particular program for annotating base interactions since any such classification necessarily creates a dichotomy in which some interactions fall just beyond the classification cutoff. R3D Align is intended for use where nucleotide to nucleotide alignments are meaningful, for instance, for aligning homologous molecules. In this respect, it differs from ARTS, which is primarily intended to find common substructures using a single rigid superposition of two structures. While R3D Align and ARTS can sometimes both be used in a meaningful way on the same structures, they are in fact complementary programs. R3D Align has been designed to produce highly accurate alignments of homologous molecules. While the tradeoff of achieving more accurate alignments at the expense of greater computational costs is difficult to avoid, R3D Align employs several techniques to maintain computational feasibility (see Section 2). In fact, R3D Align can be used to accurately align very large RNA 3D structures, such as 23S rRNA, in a reasonable length of time (see Supplementary Material S4 and S5). As noted in, a primary application of faster running quadratic-time algorithms may be to identify potential alignment regions which can then be processed by a more accurate, but computationally intensive, RNA structural alignment algorithm. R3D Align has the capability to fulfill this need (see Section 2). The classical tool for 3D-to-3D alignment evaluation has been the average root-mean-square deviations (RMSD) after optimal superimposition of the atomic coordinates of the set of aligned nucleotides in each structure. While the RMSD does reveal information about the global structure of the aligned nucleotides, local neighborhoods may actually differ quite substantially, as the RMSD spreads errors over the whole structure. Using the global RMSD alone, it is difficult to analyze whether specific local regions are aligned sufficiently well or not. Also, the RMSD is not designed to give detailed information about the conservation of interactions among nucleotides between the two structures, whether they are local or long-range interactions. These issues were recognized in, who introduced new tools based on specific RNA structural features rather than on global average measurements were introduced. These tools evaluate different modeling techniques and are useful for comparing a modeled structure with an experimentally resolved structure. Because R3D Align is used to align structures of different organisms, we introduce diagnostics to aid in structure comparison and alignment evaluation when the alignment is non-trivial (see Section 3). In the following section, we present the algorithm upon which R3D Align is built and outline the implementation in the R3D Align web server and MATLAB program suite.
METHODS
Transformation into a maximum clique problemOur objective is to produce the most complete global alignment of two homologous, structurally similar RNA 3D structures in which local neighborhoods locally superimpose well in 3D space. We meet this objective by finding the maximum clique of a specially defined graph. We assemble a set N A of 4-nt neighborhoods from structure A in such a way that each nucleotide is a member of p neighborhoods, where p is an integer specified ahead of time by the user. The 4 nt in each neighborhood are listed in ascending order with respect to the 5-end. The diameter of a neighborhood is the maximum distance between the geometric centers of the bases as previously described (). For each nucleotide i in A, we find the p neighborhoods of smallest diameter which include nucleotide i and add them to the set N A. Most neighborhoods will be added more than once, but we do not keep duplicates in the set N A. The 4-nt neighborhoods of small diameter will contain most pairwise interactions (e.g. base pairing, base stacking, base backbone) whether local or long range with respect to the sequence or secondary structure. For larger values of p, more of the local Page: 2691 26892697is neither a uniquely assigned nor a well-ordered alignment, while the merging of Alignments 2 and 3 violates the uniquely assigned criterion. Only alignments 1 and 2 can be merged to form a valid alignment, namely the aligning of nucleotides 1, 2, 3, 4, 5, 6, 7, 8 in the first structure with nucleotides1, 2, 3, 4, 7, 8, 9, 10 in the second structure, respectively. vicinity of each nucleotide will be represented in N A. The total number of neighborhoods of a molecule with n nucleotides is bounded by pn, and so is of complexity O(n). Given a second structure B that we wish to align with structure A, we construct in the same way its list of 4-nt neighborhoods, N B. We then compare the neighborhoods of N A and N B to determine which neighborhoods are structurally similar. We find that the geometric discrepancy (measured in Angstroms) that was developed in () is suitable for determining the structural similarity between 4-nt neighborhoods. The geometric discrepancy is similar to RMSD, but accounts for base substitutions between the two structures in a consistent way. For each local neighborhood in N A , we calculate the geometric discrepancy with every local neighborhood in N B , and organize these discrepancy values into an m  n array, with m = |N A | and n = |N B | being the number of 4-nucleotide neighborhoods from each structure, respectively. Each entry of the array represents a possible pairing of one neighborhood from A and one neighborhood from B. Two neighborhoods are classified as being structurally similar if their geometric discrepancy is less than a pre-defined discrepancy cutoff parameter d. We seek the alignment of structure A and structure B that aligns the largest number of structurally similar local neighborhoods. Finding the optimal alignment can be reduced to finding the maximum clique of a specially defined graph, which we call the 'local alignment' graph. The construction and use of the local alignment graph is now explained in detail. Using the m  n array described above, we generate a vertex for the local alignment graph for each entry in the array that has geometric discrepancy less than the cutoff d. Because we have put the nucleotides in each neighborhood in 5 to 3 order, each vertex represents a uniquely assigned and well-ordered alignment of structurally similar neighborhoods from A and B. Each of these alignments has only 4 nt correspondences, but we can merge together many such local alignments to form a larger alignment of A and B. However, not all of these 4-nt alignments are compatible; some would lead to an alignment which either violates the well-ordered or uniquely assigned criterion; see. We draw edges between two vertices in the local alignment graph if the 4-nt alignments which they represent are compatible with each other, in the sense that they could be merged together to form a larger valid (well-ordered and uniquely-assigned) alignment. Finding the optimal alignment then corresponds to finding the largest set of vertices such that every pair of vertices in the set are connected by an edge. That is, we want to find the maximum clique of the local alignment graph. This idea was first introduced with 2-amino acid alignments to solve the contact map overlap problem for proteins in (). Finding the maximum clique is computationally challenging, but standard routines may be employed, as we describe below.
R3D Align
R3D Align implementationThe ideas described in the previous section serve as the basis for the R3D Align program, which is accessible via web server at http://rna.bgsu.edu/R3DAlign. R3D Align is also available for download as a suite of MATLAB programs at that location. The R3D Align MATLAB code can be run in Octave, which is freely available. We have prepared a user manual that contains examples of how to use the program. Specific details of the R3D Align implementation of the algorithm are provided next. To find the maximum clique of the local alignment graph, R3D Align implements a branch and bound algorithm which is similar to the algorithm presented in (). Because the problem of finding the maximum clique problem is NP-complete (), algorithms that find the maximum clique, such as the branch and bound algorithm implemented by R3D Align, may have relatively long running times in certain cases. However, R3D Align implements a series of techniques to ensure an alignment will be produced in a reasonable length of time, which we now describe. R3D Align uses heuristic graph coloring and clique-finding procedures to quickly eliminate vertices that cannot be part of the maximum clique before the branch and bound algorithm is run. This is a pre-processing step. A graph coloring is an assignment of colors to the vertices so that no two adjacent vertices have the same color. R3D Align uses the approach described in () to color the local alignment graph in O(L 2 ) time and a greedy clique-finding procedure () to find a large clique in O(L 2 ) time, where L is the number of vertices in the local alignment graph. Suppose this clique has V vertices. Then the maximum clique has at least V colors in the coloring of the local alignment graph, because it has at least V vertices and each vertex needs a different color. Now if vertex i and its adjacent vertices have been colored with fewer than V colors, then vertex i cannot be part of the maximum clique and may be eliminated from the local alignment graph. Checking each vertex in the local alignment graph takes O(L) time. Coloring and clique-finding are iterated several times. Removing vertices in this pre-processing step decreases runtime when subsequently finding the maximum clique of the graph using the branch and bound algorithm. Every vertex in the local alignment graph represents a 4-nt local alignment, and every set of vertices that are all pairwise connected by an edge represents a set of local alignments that can be merged to form a larger, valid alignment. Thus, any clique-finding procedure may be used after pre-processing to find a large clique and thus a valid alignment. R3D Align provides the user the option of using the greedy clique-finding procedure or the branch and bound procedure to produce the clique from which the final alignment is derived. The branch and bound procedure is guaranteed to give the optimal solution but is more costly. The branch and bound procedure is most suitable to use when aligning smaller structures; we elaborate on this in the next section. We have implemented other techniques to improve runtimes. R3D Align can be run using a seed alignment and a bandwidth  so that nucleotide i of structure A will only be superimposed on nucleotides j /2 to j +/2 (/2 is rounded to the nearest integer) of structure B, where j is the nucleotide to which i is aligned in the seed alignment. This limits the size of the local alignment graph, which decreases the time required to find the maximum clique. The user can choose to upload the seed alignment (in FASTA format) or allow R3D Align to internally compute the seed alignment using a dynamic programming sequence alignment algorithm. Thus, sequence alignments, which can be obtained quickly but are not as accurate at the individual nucleotide level, can effectively be used as seed alignments to reduce overall runtime. This feature allows the user to input an alignment produced by any other method including DIAL, ARTS, etc., to produce an improved alignment using R3D Align.Page: 2692 26892697
R.Rahrig et al.This feature also allows R3D Align to be run in an iterative fashion using the results of one iteration as the seed for the subsequent one. We have found this to be the most effective way to speed up the alignment of large RNA structures, such as the large ribosomal RNAs (16S or 23S). Parameter settings for the iterations are discussed in the next section.
Web server usageThe R3D Align web server provides an intuitive user interface that allows the user to run the program online in various modalities. The user can specify the two molecules to align by entering their fourcharacter PDB code, selecting the codes from a drop-down list of database files, or uploading files in PDB format. For each 3D structure, the user may enter the chain identifier and/or a specific list of nucleotides to align. If no chain or nucleotide list is entered, all nucleotides in the file will be used to construct the alignment. Moreover, the nucleotides specified need not be contiguous (e.g. the user may enter '2,3,7:10' as the list of nucleotides, where 7:10 represents all nucleotides from 7 to 10). The user can also choose the discrepancy cutoff parameter, d. Smaller values of d require greater structural similarity between neighborhoods and therefore produce alignments in which only nucleotides in the most similar regions are aligned. Runtimes decrease with decreasing values of d. We suggest the default value d = 0.5 as a value that balances accuracy and computation time (see Supplementary Material S4). Additionally, the value of the bandwidth  must be specified. The value of  directly corresponds to the user's belief regarding the accuracy of the seed alignment. Smaller values of  should be used for more accurate seed alignments while larger values should be used when the seed alignment is less accurate or unknown. Larger values of  generally increase the runtime of the algorithm. The program ignores the seed alignment when  is greater than or equal to the number of nucleotides in the second molecule. The number of neighborhoods per nucleotide (p) can also be entered by the user. In general, alignment accuracy increases as p increases although accuracy levels off around p = 10 (see Supplementary Material S4). Also, larger values of p result in longer running times. We note that careful consideration should be taken when aligning large structures. It was noted above that in this case it is best to use an iterative approach, which decreases runtime while maintaining accuracy. Setting a low value of p in the first iteration limits the number of neighborhoods and produces an alignment quickly. This alignment, which is more accurate than the seed alignment used in the first iteration, is used as the seed alignment for the second iteration. Because this seed alignment is more accurate, a smaller bandwidth can be used for the second iteration, which decreases runtime and allows a higher value of p to be set to produce an even more accurate alignment. This iterative approach produces results similar to simply running one iteration with large values of p and , but it does so in significantly less time. The R3D Align web server allows the user to perform an alignment with up to three iterations automatically. To determine reasonable values for the parameters for large RNA structures, we used the pairs of 16S and 23S molecules for which handcrafted alignments were produced and presented in (). Our tests showed that using a two iteration approach with  = 60 and p = 3 for the first iteration and  = 20 and p = 9 for the second iteration produced accurate results (Supplementary Material S5). Although multiple iterations are not necessary for smaller molecules such as 5S rRNA, we also used R3D Align to produce alignments of the 5S molecules for the sake of more comprehensive testing. These results are also provided in Supplementary Material S5. As we noted above, the user can choose to use the branch and bound or greedy clique finding procedure to produce the final alignment. For large RNA structures, the greedy approach should be used. The R3D Align alignments of the 5S, 16S and 23S rRNA molecules mentioned above were all produced using the greedy method and were found to be accurate when compared to hand-crafted alignments and were very similar to the branch and bound results. This is not unexpected because the pre-processing typically produces a dense graph, and thus the greedy approach often produces a clique similar in size to the maximum clique found by the branch and bound method. For example, in the alignment of 16S rRNA, the greedy clique procedure finds a clique consisting of 3748 vertices, while the maximum clique is only 0.37% larger (3762 vertices).
RESULTSWe tested R3D Align by aligning the 3D structures of 5S, 16S, 23S rRNAs of E.coli (E.coli) and Thermus thermophilus (T.th.). We also aligned the 3D structures of 5S and 23S rRNAs of E.coli and Haloarcula marismortui (H.m.). PDB files 2aw4, 2j01 and 1s72 () were used for E.coli, T.th. and H.m.,respectively. We chose these test cases because high-quality hand-crafted alignments are available to effectively assess the accuracy of the alignments (). Also, these structures provide appropriate test cases because they are large and highly structured, with many non-WatsonCrick base pairs and long-range interactions. Moreover, E.coli, T.th and H.m.are phylogenetically distant so there are significant differences in sequence and structure. We also tested R3D Align on other RNAs including RNAseP and tRNA (see Section 3.5). In this section, we focus on the alignment of the 16S rRNA molecules of E.coli and T.th., PDB files 2avy and 1j5e, respectively (). Because the DIAL and SARA web servers are incapable of producing alignments of structures this large, we asked the authors of the respective programs to provide alignments from local installations of these programs. The R3D Align web server is capable of aligning 16S and even 23S rRNA molecules. Evaluations of the 5S and 23S alignments can be found in Supplementary Materials S4 and S5. To align the molecules, we used the iterative approach discussed in the previous section, which took 13 min to run. We benchmarked using a local installation of R3D Align on a Compaq Presario CQ60 Notebook with one Intel Pentium T4200 processor running at 2.0 GHz and with 4 GB of RAM. MATLAB version 7.7 (R2008b) was used for this benchmark.
Alignment output formatR3D Align produces FASTA output for use in other programs, and displays alignments in two other ways for visualization and diagnostic purposes. The first is an accessible, tabular (spreadsheet) representation that captures much of the detail of the individual 3D structures and their optimal alignment in a way that is easy for scientists to access. The second display is described in Section 3.4.showsFor example, in, it is likely that U1302 in T.th. corresponds to C1302 in E.coli, but they do not superimpose well in 3D. To capture the 3D context, the alignment also shows the base pairs made by each nucleotide in each structure, as in the manually produced base pair alignment first presented in
R3D Align
Comparison of 16S alignmentsFor comparison to R3D Align, we used various methods to create alignments of the two 16S rRNA structures; these are noted in bold in this paragraph. First, sequence-based methods. We made an alignment of the 16S sequences using a Needleman Wunsch (NW) algorithm () setting to allow inexact matches and so as to give the most favorable alignments as determined by the diagnostics in Section 3.3 below. Also, we obtained an alignment using NAST (), which is specifically designed for 16S rRNA sequences. Next, alignments based on 3D structure. The Crystallographer alignment is implicit in the numbering scheme used by the crystallographers. In earlier work (shows that, in the indicated region, R3D Align agrees almost entirely with the manual Basepair alignment. NAST aligns this region very well. ARTS agrees with R3D Align except that it aligns very few of the nucleotides in the internal loop, helix and hairpin extending from C149 to U172 in T.th. The SARA alignment generally agrees with R3D Align, but fails to correctly align two nucleotides in the hairpin extending from G159 to A162. The DIAL alignment is off by one or two nucleotides in each position and consequently does not align any base pairs. The NW alignment, although it allows inexact matches, also struggles in places because the two structures have relatively low (69%) sequence similarity within this region. However, NW performs better where the sequence conservation is higher, such as the helix and internal loop of G144 to C153 and G168 to Page: 2694 26892697C178. There the sequence conservation is 86%. Note the longrange interactions between A151 and G102, between A152 and G68, and between A160 and G347. C142-A196 is a base pair across a junction. R3D Align does well with such long-range interactions.
R.Rahrig et al.
Alignment diagnosticsThe spreadsheet described above is over 1800 lines long and does not report on the quality of the geometric superposition of aligned neighborhoods. Therefore, we also computed several global diagnostics for each alignment. We recognize that it may not be possible to define what a perfect 3D-to-3D alignment is (), but nevertheless it is important to develop effective tools for assessing alignment quality. Because we focus on the alignment of homologous molecules, we utilize effective diagnostics for this situation. In addition to the geometric similarity of the aligned regions, the number of aligned base pairs is a significant and relevant measure of the accuracy of the alignment in this situation. Also, we have concentrated on aligning molecules for which highquality hand-crafted alignments are available for comparison. The diagnostics are summarized in. The first two rows ofsimply count the number of aligned nucleotides. R3D Align aligns nearly as many nucleotides as the Composite alignment. Sequence alignment methods like NW and NAST and the Crystallographer alignment suffer from the problem that they basically need to align things even if they do not correspond very well in 3D. They have little reason not to align nucleotides that are sandwiched between aligned nucleotides. Thus, they tend to align more nucleotides than the other methods. Row 2 ofshows that NW tends to create an alignment with a greater number of identical base correspondences than the other methods. ARTS aligns significantly fewer nucleotides than the other methods. Because of the high degree of structure conservation between these two structures, a good performance characteristic is the number of base pairs aligned by each method. In, these are broken down according to whether they are nested cis Watson Crick/WatsonCrick base pairs (as in helices), non-nested Watson Crick base pairs (as in pseudoknots), nested non-WatsonCrick (as in internal loops), or non-nested non-WatsonCrick base pairs (as in A-minor and other tertiary interactions). In these four categories, R3D Align performs nearly as well as it can, and outperforms the other alignment techniques. The backbone-based methods do better on stacking interactions, which are often between adjacent nucleotides, than on base pairs. Basephosphate interactions were described in. They are most often found in highly conserved regions, which explains why the NW alignment preserved so many of themWe also calculated measures of how well aligned nucleotides superimpose, both locally and globally. For local superpositions, for each nucleotide in T.th., we found the nearest four nucleotides in T.th. which were aligned to nucleotides in E.coli, and then found the geometric discrepancy between the five nucleotides from T.th. and the corresponding five nucleotides from E.coli The mean and median of these discrepancies is given in the table. This diagnostic is somewhat independent of the method used by R3D Align, as it uses 5-nt neighborhoods rather than 4, and as it may superimpose nucleotides that are never part of the same 4-nt neighborhood. In particular, it will give large error readings in places where nucleotides that are nearby in T.th. are aligned to nucleotides that are farther apart in E.coli, which happens at the boundaries of element expansion regions.shows that the R3D Align alignment outperforms the other automated 3D-to-3D alignment methods according to the most relevant metrics. R3D Align correctly aligns more nucleotides engaged in base pair, stacking and basephosphate interactions than do SARA, ARTS and DIAL, and approaches the correct counts of the manually derived alignment. R3D Align also achieves the lowest mean local discrepancy value. The fact that ARTS achieves a lower median local discrepancy value than R3D Align is not necessarily surprising as the main problem with the global alignments produced by ARTS is not nucleotides that are misaligned, but nucleotides that should be aligned and are not. What ARTS does align, it aligns well. Among the three methods that use reduced representations of structures and then apply a quadratic time algorithm, SARA outperforms both DIAL and SARSA/PARTS (data not shown) in all categories.
Page: 2695 26892697
R3D Align
Visual assessment of local superposition qualityGiven an alignment of two RNA structures, it is useful to know which aligned nucleotides superimpose well and which do not. In, 'bar diagrams' display several alignments using straight line segments to connect the corresponding nucleotides in the two structures. As above, for each aligned nucleotide in T.th., we found the nearest four nucleotides in T.th. which were aligned to nucleotides in E.coli, and then found the geometric discrepancy between the 5 nt from T.th. and the corresponding 5 nt from E
.coliThe lines are then colored according to the geometric discrepancy between the 5-nt neighborhoods.makes it clear that R3D Align performs nearly the same as the manually derived Composite alignment. It should be noted that one reason red lines appear in the Composite alignment is because of manual identification of errors in the crystal structures and subsequent manual alignment of those nucleotides, as described in. SARA does very well, but does have some localized poorly aligned regions, as indicated by the sections with many red lines. ARTS does well where it make correspondences, but it is clear from the figure that it leaves out some large regions entirely. DIAL does well in some regions, but poorly in others. The NW alignment is good in some places, poor in others. This is no surprise; any NW algorithm requires sequence conservation to perform well, and some regions are more highly conserved than others. The NAST alignment, which is optimized for 16S rRNA alignment, performs similarly to the Crystallographer alignment.
Alignments of other structuresTo further evaluate R3D Align we also tested it on Ribonuclease P (RNase P), a ubiquitous RNA enzyme (ribozyme) that plays a critical role in all cells. We bench-marked the alignment produced by R3D Align with the manually produced structural alignment presented in. There are two distinct types of bacterial RNase P, types A and B, which differ significantly in sequence and secondary structure of their S-domains, the part of the ribozyme that binds tRNA. Nonetheless, the 3D structures are quite similar, allowing for the conserved function of binding tRNA. Thus, correct alignment of the S-domains of A-and B-type RNase Ps is a significant challenge. We used R3D Align to align the A-type S domain contained in PDB file 1U9S and the B-type S domain Page: 2696 26892697along the bottom. For each nucleotide in 1j5e with a correspondence, it and the nearest 4 nt in 1j5e with a correspondence are superimposed with the corresponding 5 nt of 2avy and the line is colored according to the geometric discrepancy, as indicated by the color bar. contained in 1NBS:B (). The R3D Align alignment was found to be in agreement with the findings described in. That is, elements that were described as being present in both structures were aligned by R3D Align, while all elements that exist in only one of the structures were not assigned correspondences in the other structure. We used an iterative approach. Since these are smaller structures, we used the branch and bound method in both iterations. In the first iteration, we used d = 0.5, p = 3,  = 100. We used d = 0.5, p =9,  = 40 for the second iteration. The entire alignment spreadsheet is included in Supplementary Material S3. For ease of comparison, the nucleotides have been labeled according to which elements of the structure they belong using the same numbering scheme as used in. To highlight the difference between the rigid superpositions used by ARTS and the local superpositions used by R3D Align, we used both programs to align an A-site bound tRNA(phe) (3I8G:B) with a tRNA(thr) bound in the pre-accommodated state (2WRN:Y). R3D Align aligns 56 of the 69 unmodified nucleotides in 2wrn (it cannot read modified nucleotides), whereas ARTS aligns just 14 nt. The entire spreadsheet containing the alignment is provided in Supplementary Material S6. Visual inspection of the two structures verifies that they differ rather dramatically in their overall 3D conformation, but that their local structure is similar in most places.
R.Rahrig et al.
DISCUSSIONOne application of an accurate 3D-to-3D alignment method such as R3D Align is to create a consensus interaction list. One application of an accurate 3D-to-3D alignment method such as R3D Align is to create a consensus interaction list. For a variety of reasons, two crystal structures of the same molecule (whether from the same organism or different organisms) will show small variations in the local structure of the RNA. When one structure shows a base pair but the other shows the corresponding two bases falling just outside the classification limits, it is reasonable to infer the presence of the base pair in the second structure. A R3D Align alignment can be used to locate near base pairs in one structure that are aligned with true base pairs in another. The near base pairs can then be inferred to be true base pairs. This could be used in conjunction with annotation program like FR3D, and the results would be useful for Page: 2697 26892697
R3D Alignprograms which search the annotations rather than the 3D structures. A consensus interaction list will be useful to crystallographers when they are trying to decide how to model a base pair. Finally, it will be useful for programs like JAR3D (manuscript in preparation), which use 3D structure to make multiple sequence alignments. In this article, we have used measurements based on local superpositions rather than one global superposition in order to accommodate the conformational flexibility of large RNA. Specifically, evaluating alignments based on the mean or median geometric discrepancy of aligned local neighborhoods is a concise way of revealing the structural similarity of aligned local neighborhoods is a concise way of revealing the structural similarity of aligned nucleotides at a local level. R3D Align is based on FR3D. Once FR3D is extended to read modified nucleotides, R3D Align will be able to superimpose RNA 3D structures containing such nucleotides. We will re-examine the seed alignment generated internally by R3D Align; improvements here will allow the user to set a narrower bandwidth and thus reduce the running time. We will implement an interface which will allow the user to specify a portion of the alignment to view as a local superposition between the two 3D structures. Finally, we would like to extend R3D Align from pairwise alignment to simultaneous alignment of three or more structures.
CONCLUSIONWe have introduced a new method for aligning two RNA 3D structures and provided an implementation of this method in the 'R3D Align' program suite and web server. In contrast to the existing methods which either rely on a reduced, linear representation of the 3D structure or on single global rigid superpositions, we focus on superpositions of local neighborhoods, which take into account interactions of all types while maintaining independence from discrete classifications of pairwise nucleotide interactions.. We have shown that R3D Align can be used to accurately align large RNA structures. The 16S rRNA alignment produced by R3D Align was compared with alignments produced by other methods. It was shown to be the most accurate and to closely approximate a hand-crafted alignment. We have also introduced new display methods and diagnostics to compare and evaluate alignments. Among the new tools introduced is a spreadsheet which displays all of the alignment information in addition to all base pairs detected in the structure. This spreadsheet format is also useful for comparing different alignments side-by-side. New 'bar diagrams' were introduced which concisely display the alignment and the structural similarity of the local neighborhoods of each aligned nucleotide.
The Author 2010. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oxfordjournals.org 2689 at :: on August 31, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
at :: on August 31, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
