New applications of next-generation sequencing technologies use pools of DNA from multiple individuals to estimate population genetic parameters. However, no publicly available tools exist to analyse single-nucleotide polymorphism (SNP) calling results directly for evolutionary parameters important in detecting natural selection, including nucleotide diversity and gene diversity. We have developed SNPGenie to fill this gap. The user submits a FASTA reference sequence(s), a Gene Transfer Format (.GTF) file with CDS information and a SNP report(s) in an increasing selection of formats. The program estimates nucleotide diversity, distance from the reference and gene diversity. Sites are flagged for multiple overlapping reading frames, and are categorized by polymorphism type: nonsynonymous, synonymous, or ambiguous. The results allow single nucleotide, single codon, sliding window, whole gene and whole genome/population analyses that aid in the detection of positive and purifying natural selection in the source population. Availability and implementation: SNPGenie version 1.2 is a Perl program with no additional dependencies. It is free, open-source, and available for download at https://github.com/hugheslab/ snpgenie. Contact:
IntroductionNext-generation sequencing (NGS) technologies allow the rapid sequencing of pooled DNA samples containing genetic material from multiple individuals. The resultant single-nucleotide polymorphism (SNP) data may be used to reliably estimate population genetic parameters with more accuracy and less expense than the separate sequencing of multiple individuals (), especially when samples are large and coverage is high. Unfortunately, high coverage data also suffer from a substantial false-positive error rate. SNP calling techniques can address this issue, but the only software currently available for evolutionary analysis of pooled NGS data, PoPoolation (), is inextricable from a problematic SNP caller that has an extremely high false-positive rate (). Further, PoPoolation relies on large pileup files and problematic simplifications, including use of the reference sequence alone to determine the number of nonsynonymous and synonymous sites. Ideally, software for evolutionary analyses of these data would allow users to first call SNPs using any preferred method, and then process the results using standard methods for determining the numbers of nonsynonymous and synonymous differences and sites. We have developed SNPGenie to meet this need. Using SNP calling results, SNPGenie estimates: (i) nucleotide diversity (p), and its nonsynonymous and synonymous partitions (p N and p S ) for coding), circumventing a major limitation of pooled data for other applications (). Indefinitely large genomes with multi-nucleotide variants may be analysed at speeds exceeding those of PoPoolation's default settings. The results allow users to test evolutionary hypotheses on the roles of negative (purifying) selection, positive (Darwinian) selection and random genetic drift in the sampled population. In general, p N  p S indicates neutrality, p N < p S indicates purifying selection and p N > p S may indicate positive selection favoring multiple amino acid changes (). Comparing H O at distinct polymorphic site categories may also address these hypotheses (). Parameter estimates are available at the nucleotide, codon, sliding window, whole gene and whole genome/population levels.
MethodsSNPGenie is a data processing Perl script, with no additional dependencies. The program accepts a reference sequence(s) (.FASTA), a Gene Transfer Format (.GTF) file with CDS annotations and an arbitrary number of SNP reports, currently including Geneious (Variations/SNPs Annotationsand CLC Genomics Workbench (Annotated Variant File) formats. The download package includes the Perl code, a detailed manual (README), various example files and scripts to aid in data preparation. Nucleotide diversity (p) is the mean number of pairwise differences per site in a population of sequences. SNPGenie estimates this for all sites, and then separately for nonsynonymous and synonymous coding sites (p N and p S ), using a new method () based on that of. Differences are calculated using all comparisons within every polymorphic codon and including all mutational pathways. To calculate the numbers of nonsynonymous and synonymous sites, SNPGenie weights by the sample allele frequencies. This becomes especially important when populations diverge from the reference sequence(s). Gene diversity is calculated aswhere x i is the population frequency of nucleotide i.
ResultsTo validate SNPGenie's execution of themethod, we constructed sequences with all 61 non-STOP codons and known numbers of differences. MEGA Version 6 () was used to calculate p N and p S. SNP reports and GTF files were then constructed to reflect the known variant frequencies and reference sequence, and SNPGenie was used to estimate the same parameters. All results agreed to the last decimal. Next, both SNPGenie and PoPoolation were used to analyse a pooled H5N1 sample. The nonsynonymous and synonymous mean numbers of pairwise differences per site and numbers of sites (the numerator and denominator of p N and p S ) were then estimated for the hemagglutinin (HA; Supplementary Tables S1A and S1B) and neuraminidase (NA; Supplementary Tables S2A and S2B) genes. When PoPoolation estimates were regressed on those from SNPGenie, all R 2 values were significant (P < 0.001; F-test), but smaller for differences in NA. PoPoolation overestimated differences for HA and underestimated them for NA, while overestimating the number of nonsynonymous sites (). p was significantly lower in HA (P < 0.01 for p N ; P < 0.001 for p S ; two-sample t-tests), consistent with previous evidence for a population bottleneck upon viral transmission that is driven by selection for specific HA residues (). Because PoPoolation overestimated differences in HA, this suggests that its false discovery rate may be exacerbated in low-diversity (e.g. bottlenecked) contexts. Most differences between SNPGenie and PoPoolation can be attributed to: (i) differences in SNP calling; (ii) PoPoolation's treatment of STOP codon variants as nonsynonymous; and (iii) SNPGenie's use of allele frequency data in determining the number of sites, contrasted to PoPoolation's use of the reference sequence alone. PoPoolation also reports p S  0 for codons with no synonymous sites, where p S should be undefined. This could highly inflate the p N /p S ratio, overestimating the prevalence of positive natural selection. If the false positive calls are random, 75% will be nonsynonymous (), exacerbating this problem. Planned future improvements in SNPGenie include additional SNP report formats (e.g. VCF) and weighted mutational pathways.
at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
C.W.Nelson et al. at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
