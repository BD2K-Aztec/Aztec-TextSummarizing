Motivation: Time course gene expression experiments are performed to study time-varying changes in mRNA levels of thousands of genes. Statistical methods from functional data analysis (FDA) have recently gained popularity for modelling and exploring such time courses. Each temporal profile is treated as the realization of a smooth function of time, or curve, and the inferred curve becomes the basic unit of statistical analysis. The task of identifying genes with differential temporal profiles then consists of detecting statistically significant differences between curves, where such differences are commonly quantified by computing the area between the curves or the l 2 distance. Results: We propose a general test statistic for detecting differences between gene curves, which only depends on a suitably chosen distance measure between them. The test makes use of a distance-based variance decomposition and generalizes traditional MANOVA tests commonly used for vectorial observations. We also introduce the visual l 2 distance, which is shown to capture shape-related differences in gene curves and is robust against time shifts, which would otherwise inflate the traditional l 2 distance. Other shape-related distances, such as the curvature, may carry biological significance. We have assessed the comparative performance of the test on realistically simulated datasets and applied it to human immune cell responses to bacterial infection over time. Availability: R scripts are freely available for download at
INTRODUCTIONIn longitudinal microarray experiments, the temporal evolution of expression levels in thousands of genes are monitored in an attempt to understand the dynamic processes that regulate them (). Repeated measurements of mRNA are taken at a relatively small number of time-points for all the available biological replicates. A common aim of such studies is to compare gene expression profiles observed in different populations or under different experimental conditions, and to identify those genes whose temporal profiles differ significantly. The data produced by such longitudinal studies, however, present several challenges for * To whom correspondence should be addressed. statistical analysis. Statistical tests developed for cross-sectional data, such as the t-test and its many modifications, are inadequate because they are only able to detect differential expression at individual time-points and they ignore the temporal dependencies that are typical of the experimental data (). Models from classical time series analysis are also limited in scope as the time courses are generally very short, sampled at irregularly spaced time-points, and often contain missing data. Over the last few years, these issues have led to an increasing interest in the application of functional data analysis (FDA) techniques (). In FDA, the longitudinal observations are treated as noisy realizations of an underlying smooth curve, which represents the true continuous evolution of a gene's expression level over time. Once these underlying curves have been inferred from the observed data, they become the basic unit of statistical analysis, on which a wide variety of tasks can be performed such as dimensionality reduction and visualization (), clustering () and differential analysis (). A recent review of developments in this area can be found in. We consider the problem of detecting differences between gene curves representative of two or more groups when several biological replicates are available for each group. A number of test statistics have been proposed to test for equality between curves, including maSigPro (), EDGE (), PACE () and functional Bayes approaches (). The underlying problem of detecting differences between curves has also been extensively considered in non-parametric statistics, and various tests have been developed that could be used for the analysis of gene expression temporal profiles, including the functional F-statistic () and the more recent TN statistic (). The underlying assumption shared by these methods is that, under the null hypothesis of equality between curves, the area between them is zero. Our work is motivated by the observation that although the area between two curves, as captured by the l 2 distance, often provides an intuitive and easily interpretable measure of difference between them, existing methods only capture this specific type of difference. Thus, potentially interesting differences between gene curves that may carry biological relevance may be missed. For instance, the l 2 distance may fail to capture specific shape-related features that would otherwise be detected by the expert eye, such as the number and location of 'peaks' and 'troughs' or their respective curvatures. Furthermore, time-shifted curves, considered different when using the standard l 2 distance, might be considered similar using anPage: 3136 31353141
C.Minas et al.alternative distance measure. This would mitigate the use of special alignment approaches to capture the similarity of such response patterns (). In this article, we propose a general distance-based test statistic for detecting differences between functional representations of gene expression temporal profiles that only relies on pairwise distances between replicate gene curves. The test statistic is obtained using a generalized distance-based variance decomposition and inferences are drawn using a permutation approach. The proposed test can be interpreted as a generalization of multivariate analysis of variance (MANOVA) methods to non-vectorial data. We also demonstrate that, when the area between gene curves is the preferred difference, the proposed test has the same statistical power as other functional tests, such as EDGE and TN. The major contribution of our approach consists of providing a unified statistical framework for detecting differential gene curves with respect to any notion of distance, which in turn enables the detection of a wide range of patterns in functional data. The structure of the article is as follows. In Section 2.1, we introduce some notation and provide a brief overview of the FDA approach for the analysis of time course data where some limitations of the l 2 distance are also highlighted. In Section 2.2, we describe two shape-based distances for gene curves; the visual l 2 and curvature distances. In Section 2.3, we present our distancebased test statistic whose performance is assessed in Section 3 using realistically simulated curves. The potential benefits of our approach are discussed in Section 4 where it is applied to a longitudinal transcriptional dataset of human immune cell responses. A final discussion and conclusions are provided in Section 5.
METHODS
FDAWe consider a setting in which the expression levels of K genes are observed over a time period . We assume that each gene is modelled independently, and that the expression levels for each gene are observed for G different groups (e.g. representing different biological conditions) at S possibly irregularly spaced design time-points t = (t 1 ,...,t S ) T. A random sample of size N g is observed for group g, for g = 1,...,G, and consists of expression levels of biological replicates denoted by y,...,N g. Within each group g, these data points are assumed to be noisy observations taken from an underlying smooth function of time,  (g) , observed at the design time-points. Several statistical models for estimating the underlying gene curves exist, including semiparametric mixed effect models using different parametric curves such as B-splines and smoothing splines (); any of these methods could be used in our framework. The hypothesis of equality between curves is commonly stated asfor all t  , where i = j = 1,...,G. Several existing statistical tests for functional data, including EDGE and TN, have been developed to test this null hypothesis of equality. A major limitation of these approaches is the implicit assumption that, in order to be considered equal, the curves must have the same amplitude over the entire time range . In other words, the area between them, or their l 2 distance, denoted d L and given bymust be zero under the null. Thus, current methods either explicitly or implicitly test for zero d L distances by construction. However, since d L. In each case, the curves are scaled in both the x-and y-axes, with the shaded areas quantifying the region considered in the computation of the d V distances. The solid lines connecting the two curves (no longer just vertical) represent some points on the curves deemed close by the naked eye. limitation is the visual l 2 measure, denoted here as d V , which was originally proposed in the context of qualitative smoothing (). In order to compute the distance between curves  (i) and  (j) , scaling effects are initially removed by rescaling both axes to theinterval, thus ensuring that any differences detected between curves are truly differences in shape. The curves are then considered as infinite sets of points in the R 2 plane so that rescaled curve  (i) is represented by a set of 2D points collected inFor a given time-point t, the distance between point  (i) (t) and curve  (j) is found as the shortest Euclidean distance between the 2D coordinate (t, (i) (t)) and all coordinates in p j ,The integral of this quantifies the difference between the two curves analogous to scanning all points on  (i) by the naked eye and detecting the corresponding closest points on  (j). That is, the features of  (i) such as peaks and troughs, for example, are compared with the closest features of  (j). The difference between  (j) and  (i) is then quantified in the same way, and these two comparisons are combined into the overall d V distanceThe fact that d V takes into account both vertical and horizontal directions yields a distance measure more representative of the distance detected by the naked eye. This is illustrated in, in which we have shown how the d V distance of the curves presented inare computed. The curves in the A1 comparison have a larger visual distance (d V = 0.56) than those in A2 (d V = 0) showing that once the difference in amplitude has been removed, the two curves have exactly the same shape. Also, d V is smaller for the curves represented in the B2 comparison, than those in B1; similar conclusions would have been reached by visual exploration of the curves, which clearly shows that the two temporal profiles are time-shifted, but their shapes are otherwise very similar. In some studies, the speed of differential gene expression over time is of interest, regardless of the changes in direction. In this case, a suitable measure should quantify the difference in curvatures, and a suitable distance would bewhere  indicates the curve's second derivative. This measure quantifies the difference in smoothness of the curves, and unlike d L and d V , will yield a zero value if the curves are perfect reflections of each other in the time axis (for example, one having a peak and the other having a trough). Such inverted temporal profiles can indicate inhibitory relationships between the groups (). In this case, on using d C , the gene curves are considered similar. In, d C is smaller in B2 than in B1, thus also declaring the time-shifted curves more similar to each other than those in B1.
Distance-based hypothesis testingWe introduce a general hypothesis testing framework that can be flexibly adopted to work with any distance measure. Instead of (1), we reformulate the problem aswhere i = j = 1,...,G and d is any suitable non-negative and symmetric dissimilarity measure between two curves computed over the entire time range . In this formulation, under H 0 , the curves do not have to be exactly equal to be similar, but are similar with respect to the chosen dissimilarity measure. In what follows, we develop a distance-based test statistic for (2). As detailed in Section 2.1, for each given gene, we assume that a smoothing procedure has been applied to estimate all N g curves available in group g, for every g = 1,...,G. Each estimated curve for a biological sample is denoted asas as i. We denote by N the total number of replicate curves available across all G groups, and obtain an N N distance matrixcontaining all pairwise distances among the N estimated curves {   i } N i=1 , with elements altered if necessary so that the distances are metric (see Supplementary Material). In order to keep track of group membership, we introduce the indicator variable I gi , which equals 1 if curv  i is in group g and 0 otherwise. Our objective is to test (2) using all the information stored in and the grouping information. This is achieved by first decomposing the total sample variability into within-and between-group elements in a way that only depends on and I gi for all g,i, and then building a test statistic that makes use of this generalized decomposition. In order to derive the variance decomposition, we first consider the case of N independent data points being represented by S-dimensional vectors, y 1 ,...,y N , and arranged in an N S matrix Y. We let T represent the S S total sum of squares matrix,As generally done in classical multivariate analysis of variance, this can be decomposed as T = W +B, where W is the within-group sum of squares matrixis the between-group sum of squares matrix, where we have denoted the group means by  y g , and the overall mean by  y. In order to quantify the variance in the sum of squares matrices, we take the trace operator, yielding tr(T) = tr(W)+tr(B). This decomposition can be re-written in terms of the pairwise Euclidean distances between the N observations stored in the N N distance matrix.where tr(T) = tr(T E ), showing that tr(T) only depends on the pairwise Euclidean distances in E. Similarly, we obtain expressions for the traces of W and B in terms of Euclidean distances aswhere tr(W) = tr(W E ) and tr(B) = tr(B E ). The variance decomposition can be written in a distance-based equivalent form as tr(), where all terms are non-negative as they are weighted sums of distances. When the data are functional rather than vectorial, such as gene curves, a generalized distance-based variance decomposition is obtained simply by replacing d E with any curve-based distance measure d, yielding tr(T ) = tr(W )+tr(B ). Using this expression, we then define the distance-based statisticwhich is non-negative due to tr(B ) and tr(W ) being non-negative. Large values of the statistic are due to a large between-and low within-group variance, and support the hypothesis that the true group measurements differ with respect to d. The null distribution of DBF is dependent on the specific distance measure being used, and is generally unknown. Permutation testing can be performed by simultaneously permuting the rows and columns of (so the zero diagonal elements are maintained) and subsequently re-evaluating DBF to assess whether or not an observed statistic is significant. This procedure requires a set of N  permutations such that each   is a one-to-one mapping of the vector (1,...,N) T to itself. On denoting the permuted distance matrix  for a given permutation , the set {DBF  }  is generated giving the permutation distribution of DBF under the null from which the empirical P-value is found asOur proposed test statistic encompasses several known statistical tests proposed in multivariate analysis as special cases. When the observations are scalars, the DBF statistic applied with Euclidean distances is equivalent to the standard ANOVA F-statistic. In this case, under the null hypothesis of no difference in mean between the groups, DBF follows an F distribution with G1 and N G degrees of freedom (after multiplying by suitable constants). When the observations are vectorial, MANOVA techniques are usually applied to test for equality of the true group means (). On using the Mahalanobis distance for vectors, the DBF test is related to the Hotelling's T 2 , Wilks' Lambda, Pillai trace and LawleyHotelling trace tests in the two group case, and is related to Pillai and LawleyHotelling trace tests when G > 2 (analytical derivations are provided in the Supplementary Material).
EXPERIMENTAL RESULTSThe performance of the proposed DBF test was assessed using artificially simulated curves for 250 genes with 225 under H 0 and25 under H 1 in a two group comparison. Independently for each gene we simulated group curves  (g) for g = 1,2 over  =and took these as the known population curves. In order to create the observed dataset, each curve was observed at the design timepoints t = (0,4,18,48) T. Finally, N g = 9 replicates were assumed, for g = 1,2, to emulate the real data described in Section 4. The salient features of the artificial population curves in each group depend on whether they are generated under the null or alternative hypotheses, and on a specific notion of distance. We performed three different experiments: (i) area-preserving, in which the null curves have zero d L distances; (ii) shape-preserving, in which the null curves have zero d V distances and (iii) curvature-preserving, in which the null curves have zero d C distances. The challenge here consists of simulating population curves that preserve the prescribed distances and resamples experimental data. We used Bezier curves, for example] whose parameters can be randomly generated. The specific simulation settings are described in the Supplementary Material, and examples of simulated curves in each experiment are provided in. It can be noted that the sample curves drawn under the null hypothesis (left plots) preserve the zero distances. The DBF test is compared with EDGE and TN, which have been proposed to detect large differences in the area between curves, according to (1), and are directly comparable with the DBF test with the d L distance. In this comparison, we also include the distancebased Mantel test (), defined asi=1 are the N simulated replicate curves across both groups and d is the selected distance measure. This statistic has been applied in ecology () and geneticsDBF with d L distances is competitive with EDGE and TN for the area-preserving experiment. EDGE and TN have no power to detect shape-related differences between the groups. In all cases, DBF outperforms the Mantel test which only uses between-group distances and therefore has less power.
Distance-based differential analysis of gene curves(), with large values supporting the alternative hypothesis as large between-group distances are usually indicative of differences between groups. However, we note that while between-group distances may be large, the relative size of the within-group distances are ignored, potentially masking the true signal of differential expression. The power of the tests are computed using 200 Monte Carlo simulations, and are reported infor 1, 5 and 10% false positives rates. It is seen that EDGE and TN perform well for the area-preserving experiment where differentially expressed genes were designed to exhibit large differences in area between the two group profiles. Here, DBF is competitive with these approaches, and they all outperform Mantel. As expected, for the shape-and curvature-preserving experiments EDGE and TN have no power to detect the differential curves. Moreover, DBF always outperforms Mantel. This is because DBF considers both within-and between-group distances rather than just between-group distances. In particular, Mantel suffers a large reduction in power for the curvature-preserving experiment due to the low order of magnitude of the d C distances masking the elements of the signal of differential expression provided by the between-group distances. The DBF statistic detects this signal due its ratio formulation of between-to within-group distances. (See Supplementary Material for more results).
APPLICATION TO HUMAN IMMUNE CELL DATAProcesses that may contribute to controlling Mycobacterium tuberculosis infection () may be highlighted by comparing the transcriptional profiles of human phagocytic immune cells (macrophage and dendritic cells, denoted M/DCs) that differ in their ability to limit bacterial growth. Time course measurements of M/DC gene expressions were recorded at 0,4,18 and 48 h after infection using Affymetrix U133A high-density oligonucleotide arrays. The observation of each type of cell at each time-point was repeated with human immune cells isolated from 9 healthy donors. After preprocessing and removal of missing data,and). The differential expression of RAB13 () and RAB21 were only detected when considering the differences in the scale-invariant expression profiles as determined by d V. For these genes, the divergent pattern of gene expression over time indicates that distinct processes are impacting upon intracellular trafficking in M compared with DC after mycobacterial infection, highlighting pathways of interest for further investigation and identifying inflection time-points where the interactions between host and pathogen appear to alter. RND1 () and RND3, Rho family GTPases, were only identified when considering the d C measure between the expression profiles. Here, large differences in the speed with which the profiles changed over time were captured, whereas the direct time-point comparisons of the d L measure did not detect significant differences in amplitude.
DISCUSSION AND CONCLUSIONSIn this work, we have presented a distance-based test for the detection of statistically significant differences between groups of curves representing gene expression temporal profiles. Compared with existing tests that have power to detect time-varying differences in expression profiles characterized by large areas, our approach provides additional flexibility by enabling the use of any distance measure that is most suitable for the specific application. In an exploratory study, a variety of distance measures could be used in order to detect alternative patterns. In particular, we have suggested a visual distance between curves that can identify differences in shape such as those detected by visual exploration. This distance has been shown to be robust to time shifts and other perturbations that do not alter the shape of the response curve. Using realistically generated curves that closely resemble the experimental data, we have shown that DBF can achieve the same statistical power of other functional tests specifically designed to detect amplitude-driven differences between gene curves. In our case study, the identification of RAB13 and RAB21 genes in particular demonstrates that shape-based distances may be employed to discriminate genes by the geometric patterns of their transcriptional response over time. Such analyses may be desired in scenarios where large changes in amplitude of gene expression are not a pre-requisite, or where the differential actions of transcriptional regulators are of interest.The emphasis of this article has been on functional data for longitudinal experiments, and gene expression profiles in particular. When the response profiles are described by vectorial rather than functional representations (e.g. a vector of expression values at all design time-points), the DBF test provides a distancebased alternative to common MANOVA tests for detecting mean differences using the Mahalanobis distance. However, apart from gene expression data, the DBF test has a much wider applicability and can be used to detect group differences involving any biological entity, regardless of the specific data structure, as long as a meaningful pairwise distance matrix can be defined. For entities best represented by non-vectorial data types such as sequences, protein 3D structures and networks, a variety of distance measures have been proposed in the literature and would be promptly available.
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
is only concerned with vertical distances between points taken on each curve, expression profiles may not necessarily exhibit differences in the time-varying patterns of mRNA abundance even when having large d L distances. This is illustrated in Figure 1 where we consider two groups (G = 2). Each of the four plots shows a comparison between two gene curves, one curve for each group. The solid vertical lines indicate the vertical distances considered when computing d L. For both the A1 and A2 comparisons, the d L distance is the same (d L = 3.24), indicating that the area between the two curves (shaded region) is the same in both cases. However, in these examples there is a clearly visible difference in their respective shapes. Specifically, halfway through the time course, the expression levels in A1 increasingly diverge as time progresses, whereas the expression levels in A2 both plateau. For both the B1 and B2 comparisons (bottom row), the d L distance between curves is also the same (d L = 1.8), indicating again that the areas between the curves are the same. However, whereas the two curves in B2 have very similar shapes and have only undergone a time-shift, the curves in B1 have different time-varying patterns, resulting in shapes more different than just being timeshifted. Clearly the d L distance is unable to identify similar temporal profiles that only differ due to delays on the time scale. Such time-shifts can be representative of expression responses that may be slower in one group than another, due to a time lag in their transcription control for example, Qian et al. (2001). These examples support the argument that the d L distance may be unable to capture clearly visible differences in the shape of the expression profiles, and so existing tests that focus on this distance are expected to have very little statistical power in detecting certain shape-related differences. Below, we introduce alternative distances that enable the identification of shaperelated patterns of variation for which no statistical procedures are currently available. 2.2 Shape-based distance measures As already noted, the area between curves as computed by d L only relies on vertical distances between the gene curves, and therefore does not truly caption the notion of shape. An alternative distance that overcomes this
995 probe sets remained for the differential analysis (Tailleux et al., 2008). Temporal profiles of all genes were smoothed using cubic smoothing splines, after which transcriptional responses were normalized at baseline so that any differences detected were relative to pre-infection state. The DBF test was used with the d L , d V and d C distances. Empirical P-values were obtained by using 24 310 permutations, and were subsequently adjusted using a multiple testing correction to control the false discovery rates at 1% (Storey and Tibshirani, 2003). As expected, each dissimilarity measure identified different subsets of genes as differentially expressed between M and DCs in response to Mycobacterium tuberculosis infection (see Venn diagram in the Supplementary Material). We computed the hypergeometric probabilities of each gene belonging to pre-defined gene ontology (GO) classifications of genes (Ashburner et al., 2000). This resulted in a set of functional categories which were significantly enriched with each dissimilarity measure, providing an overview of the pathways that are likely to be reprogrammed in dendritic cells compared with macrophages after infection. Gene Ontology (GO) terms for membrane invagination (GO:0010324) and endocytosis (GO:0006897, GO:0016193, GO:0016196), the process whereby phagocytic cells (such as M/DCs) engulf foreign bodies (such as M.tuberculosis bacilli), significantly overlapped with genes recognized using the DBF test with d L. Additionally, genes associated with the endosome (GO:0005768) and late endosome (GO:0005770), the membrane structures containing foreign bodies that are formed during endocytosis, were significantly enriched only using the DBF test with d V dissimilarities. Thus, the d V measure that discriminates gene curves by shape, identified subtle changes in gene expression between the cell types that did not rely on large differences in amplitude between time-points. This suggests that processes controlling engulfment of M.tuberculosis bacilli may differ between phagocytic cell types permissive and non-permissive for mycobacterial growth. We also looked at a subset of genes involved in intracellular trafficking, the RAB GTPases. These are a family of small guanosine triphosphatases found on the surface of intracellular membranes that play integral roles in regulating the movement of these vesicles around the cell (Brumell and Scidmore, 2007). The retention of RAB5 and the failure to recruit RAB7 has been used to characterize the stalled development of the M.tuberculosiscontaining phagosome (Brumell and Scidmore, 2007). Genes encoding RAB7A and RAB7L1 were identified to be differentially regulated between M/DCs using the DBF tests with multiple measures (RAB7A with d L , d V and d C , and RAB7L1 with d L and d V ). Figure 4 displays the M/DC expression profiles for a selection of genes, of which RAB7A is the first. We see that there is a large difference in area between the two curves (d L distance), large scale-invariant differences in shape (d V distance) and the macrophage curve changes shape much faster than the dendritic curve (d C distance). RAB5B and RAB5C were only revealed to be divergently expressed using the DBF test with the d L measure, as was also the case for RAB22A (Fig. 4B), which has been implicated in the reprogramming of M.tuberculosis-phagosome trafficking (Brumell
