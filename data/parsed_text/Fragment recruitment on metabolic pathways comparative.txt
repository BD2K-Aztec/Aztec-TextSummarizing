Motivation: The sheer scale of the metagenomic and metatranscrip-tomic datasets that are now available warrants the development of automated protocols for organizing, annotating and comparing the samples in terms of their metabolic profiles. We describe a user-friendly java program FROMP (Fragment Recruitment on Metabolic Pathways) for mapping and visualizing enzyme annotations onto the Kyoto Encyclopedia of Genes and Genomes (KEGG) metabolic pathways or custom-made pathways and comparing the samples in terms of their Pathway Completeness Scores, their relative Activity Scores or enzyme enrichment odds ratios. This program along with our fully configurable PERL-based annotation organization pipeline Meta2Pro (METAbolic PROfiling of META-omic data) offers a quick and accurate standalone solution for metabolic profiling of environmental samples or cultures from different treatments. Apart from pictorial comparisons, FROMP can also generate score matrices for multiple meta-omics samples, which can be used directly by other statistical programs. Availability: The source code and documentation for FROMP can be downloaded from https://sites.google.com
INTRODUCTIONThe rapidly accumulating environmental meta-omic (metagenomic and metatranscriptomic) projects resulting from highthroughput sequencing techniques warrant the development of new protocols that can provide a quick overview of the microbial metabolic potential or activity. There has been some effort towards management of such data (), its taxonomic and metabolic profiling (), visualization of metabolic pathways and statistical analyses of community differences (). In most cases, the tools are web-based and the primary method for annotation is BLAST (). We describe here a standalone set of tools to get a rapid and accurate overview of the metabolic functions of the resident microbial community. The enzyme identification component of this pipeline, based on the ModEnzA Enzyme Commission (EC) numbers () and Pfam () profile hidden Markov models (HMMs), provides a quick and accurate EC number identification. The standout feature is the FROMP (Fragment Recruitment on Metabolic Pathways) pathway mapping and comparative visualization tool, which maps EC numbers and Pfam annotations onto the Kyoto Encyclopedia of Genes and Genomes (KEGG) reference () or custom-made metabolic pathways. Multiple meta-omic samples can be compared with each other based on a Pathway Completeness Score modified from, a Pathway Activity Score or an odds ratio for enzyme enrichment (). The increased accuracy of HMM-based annotation and an ability to compare multiple meta-omic samples at once are attributes that improve on currently available metabolic profiling tools such as Megan () and MG-RAST ().
METHODS AND FEATURESThe java program FROMP is a part of the Meta2Pro (METAbolic PROfiling of META-omic data) pipeline (Supplementary). It maps the EC numbers from ModEnzA directly onto the KEGG pathways or user-defined custom-made pathways. The Pfam hits are first mapped to the corresponding Gene Ontology IDs () (using the conversion files pfam2go, kegg2go and ec2go downloaded from http://www.geneontology.org/external2go/), which are then mapped to KEGG reaction IDs or EC numbers. Pathway Completeness Score: We have modified the weighing scheme for EC numbers described in () by adding a term for the presence of continuous unbranched chains of reactions. For each EC i, the weight*To whom correspondence should be addressed. yThe authors wish it to be known that, in their opinion, the first two authors should be regarded as joint First Authors.where N (T,i) is the total number of ECs in all pathways that have EC i, N (U,i) is the number of unique ECs in all the pathways that have EC i and N (P,i) is the total number of pathways where EC i is present and L (UBC,r) is the total edge-length of the unbranched chain containing EC i in the reference pathway. The pathway completeness score for a pathway p is thenwhere W i is the specificity weight of each EC i in pathway p, and I i is 1 if the EC number is detected in the sample and L (UBC,s) is the edge-length of the unbranched chain containing EC i in the sample. Odds ratio for gene enrichment: As described in Gill et al., if A and C are the occurrence counts of a given EC in sample i and all other comparison samples j, respectively, and B and D are occurrence counts of all other ECs in sample i and comparison samples j, respectively, then the odds ratio for the given EC in sample i is (A/B)/(C/D). Pathway Activity Score: This is simply the sum of counts for the ECs in a given pathway multiplied by the EC weight. Equalization of sequencing effort: To remove bias introduced by differences in sequencing effort, the user can equalize unequal sample sizes to the smallest sample by randomly selecting equal numbers from the other samples. Custom-designed pathways: In addition to the KEGG pathways, the users can design their own pathways in the Pathway Designer. Chemical species and EC numbers can be placed on a grid and linked with lines. The customized pathways can then be added to any project in FROMP. Input: Apart from reading the output of the hmmscan program (), FROMP can also read in tab-or comma-separated list of EC numbers and Pfam accession numbers (one column), ECs and Pfams with counts (two column) and ECs and Pfams with counts and sequence IDs (three column) of the meta-omic sequences. It also accepts a matrix file of EC counts, with the samples arranged in columns and the EC numbers in the rows. Output: The comparative recruitment of various samples on the reference pathways can be exported as PNG image files. The various score matrices (including the EC count matrix) for the samples and the sequence IDs of the fragments mapping onto each EC or pathway can also be exported as text files.
COMPARATIVE ANALYSIS OF METATRANSCRIPTOMES FROM THE OXYGEN MINIMUM ZONE OFF PERUThree metatranscriptomic samples from a depth profile (oxic, oxycline and anoxic), collected from one station in the Peruvian oxygen minimum zone, were analysed with FROMP and mapped onto a custom-designed pathway that included biological reactions that are thought to be carried out in oxygen-depleted environments (Supplementary Figs S2S4). The oxic sample metabolism was dominated by sequences affiliated to oxic respiration (cytochrome-c oxidase, EC 1.9.3.1). It also had elevated levels of nitrite reduction transcripts (EC 1.7.2.1), while sequences from the oxycline and the anoxic samples exclusively mapped onto nitrate reductases (EC 1.7.99.4). In the sulfur cycle, sequences similar to hydrogen sulfite reductase (EC 1.8.99.3) mostly originated from the anoxic depth, while the sulfate adenylyltransferase (EC 2.7.7.4) was most abundant in the oxic surface. These visual observations are also supported by the odds ratio or enrichment factors calculated for the ECs in these samples (Supplementary).
CONCLUSIONWe present here a set of tools for accurate standalone metabolic profiling of meta-omic data. The java program FROMP and the Meta2Pro collection of PERL scripts along with the relevant documentation are available from https://sites.google.com/site/ dhwanidesai/home/software.
Crown copyright 2013. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
