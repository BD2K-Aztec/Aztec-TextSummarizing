We have developed an RNA-Seq analysis workflow for single-ended Illumina reads, termed RseqFlow. This workflow includes a set of analytic functions, such as quality control for sequencing data, signal tracks of mapped reads, calculation of expression levels, identification of differentially expressed genes and coding SNPs calling. This workflow is formalized and managed by the Pegasus Workflow Management System, which maps the analysis modules onto available computational resources, automatically executes the steps in the appropriate order and supervises the whole running process. RseqFlow is available as a Virtual Machine with all the necessary software, which eliminates any complex configuration and installation steps.
INTRODUCTIONWith the recent technological breakthroughs in the study of the whole transcriptome (), RNA-Seq datasets have been generated to decipher, characterize and quantify the set of all RNA molecules produced in cells. Readalignment tools () and gene expression-estimation tools () have been developed to analyze millions of reads generated from mRNA sequencing and to determine the expression level. However, the majority of these tools have focused on single functions, resulting in the frequent incompatibility of data interfaces among different tools. Therefore, integrating these tools into an overall computation, or, a workflow, is critical for downstream RNA-Seq data analysis. Recent works on RNA-seq analysis pipelines include inGAP (), RSEQtools () and ArrayExpressHTS (). Each of them offers a subset of common RNA-Seq analytical functions that are organized
RseqFlowdownstream analysis. The detail of the merging can be found in the Supplementary Section S1. Calculating expression levels: expression levels of genes, exons and splice junctions are calculated based on the reads aligned to the transcriptome. For genes and exons, we calculate RPKM (Number of reads Per Kilobases per Million mapped reads) values (), and for splice junctions, we calculate RPM (Number of reads Per Million mapped reads) values. We further implemented three choices of RPKM values, using different strategies to treat the multi-reads that are mapped to multiple genome/gene regions. These include the elimination of multi-reads (RPKM_Uniq), the random assignment of multi-reads (RPKM_Random) and the elimination of both multi-reads and un-mappable transcript regions (RPKM_UM). An un-mappable transcript region is a sub-sequence of a transcript that is identical, or almost identical, to sub-sequences of other genes or other genome sub-sequences. We pre-compute libraries for unmappable transcript regions based on gender, read length and gene annotation databases. Among the three RPKM formulas, we found that RPKM_UM gave the most accurate gene expression levels and is therefore the default option in our workflow. Details are described in the Supplementary Section S3. Identifying Differentially Expressed (DE) genes: we implemented the negative binomial model proposed in DESeq () to compute differentially expressed genes. For datasets with replicates, we use the negative binomial model to compute P-values for differentially expressed genes. For datasets without replicates, P-values for exons are computed first and then combined into a single value using the Fisher probability test. Flexibility of the workflow: the workflow allows substitution of existing functions with other methods, and can be easily extended to include more analytical functions. In addition, it can be revised for other species, using the details described in the Supplementary Section S3.1. The first version of RseqFlow was built for the human genome, using human genome Hg19 and the transcriptome database of Gencode v3. Recently, we built a workflow for Rhesus, which can be downloaded from our website (http://pegasus.isi.edu).
Workflow with Pegasus and virtual machineRseqFlow uses Pegasus to develop and manage workflow execution (). Pegasus manages task execution and data movement efficiently, and allows users to track the provenance of the workflow execution results, including the modules/codes used, the machine on which the modules ran, the parameters used for the analysis and the datasets and their sizes. If failures occur during execution, Pegasus tries to automatically recover from them by resubmitting the failed tasks or by re-planning the failed part of the workflow. To reduce the time necessary to begin using our workflow, we have created an RseqFlow VM capable of running on Windows, Linux and Macintosh without complex software installation and workflow configuration steps. This VM allows users to run RseqFlow either on a local machine or on Amazon EC2. Instructions on running the VM on a local machine with sample datasets as well as user datasets are provided on our website at (http://genomics.isi.edu/rnaseq). The VM can also be used as a submit host to schedule jobs on remote resources such as clusters, grids and clouds. This advanced setup does require several additional configuration steps, and will be automated in a later release. RseqFlow consists of a total of 155 computing tasks and 31 data management tasks when the input sample data is split into 64 parts to map to the genome, in parallel. This is a configurable parameter for the workflow. RseqFlow has been tested in a cluster environment as well as on our VM. Our test cluster was a 118 nodes Linux cluster with 54 dual hexcore Intel x86_64 Xeon 2.66 Ghz, 24 GB RAM nodes and 64 dual quadcore Intel x86_64 Xeon 2.3 Ghz, 16 GB RAM nodes. The input dataset including the sample dataset in fastq format and reference data is about 29 GB in size. The parallel workflow runs on our test hardware in 187 mins. Without splitting the data it takes 784 mins to run on the same cluster, thus resulting in a 440% improvement in runtime. During execution the workflow uses a max of 72 cores in parallel. The workflow uses 53 GB scratch space on a shared file system across all the nodes and saves 37 GB of output data.
CONCLUSIONSIn summary, we have developed RseqFlow, a workflow containing an interacting set of RNA-Seq analytic functions. For operational efficiency, modules are formalized into a workflow and managed by Pegasus Workflow Management System in a VM environment. Although the current version of RseqFlow is built on human genome Hg19 and Gencode, it is easy to re-compile the workflow for other species. The analysis modules can be easily customized because the inputs to the modules are in standard data format. Users can also substitute existing functions with other tools. And the workflow is open to further function extension, and we plan to expand the workflow by adding functions for novel alternative splicing identification and other required analysis.
* To whom correspondence should be addressed. and managed by specific software management system. In this article, we present an RNA-Seq analysis workflow, RseqFlow, which attempts to integrate more analytical functions than the previous tools, and at the same time, be flexible and easy to use. In particular, this workflow is organized by the Pegasus Workflow Managment System (Deelman et al., 2005, 2007; http://pegasus.isi.edu), which supports large-scale workflows on diverse environments in a scalable and reliable fashion (Callaghan et al., 2010). Users can easily acquire analysis results with just one command, instead of in a step-by-step manner and inputting commands and arguments for each module. We also provide a downloadable Virtual Machine (VM) image that allows users to run the RseqFlow easily using different computational resources, including a local laptop, a workstation, high-performance computer clusters, national Grids or computational Clouds (Juve et al., 2010), thus eliminating any complex software installation and workflow configuration steps. 2 FEATURES AND FUNCTIONS 2.1 Functions of RNA-Seq analysis workflow The RseqFlow workflow (Supplementary Figure S1) contains several modules and features. The major modules include mapping reads to genome and transcriptome references, performing quality control (QC) of sequencing data (described in Supplementary Section S2), generating files for visualizing signal tracks based on the mapping results, calculating gene expression levels, identifying differentially expressed genes, calling coding SNPs (described in Supplementary Section S4) and producing MRF and BAM files (described in Supplementary Section S5). The modules in workflow can be extended for more functions, or replaced by other methods. Some of the unique features of RseqFlow are specified in the following. Mapping reads: the current version includes two alignment tools, Bowtie (Langmead et al., 2009) and PerM (Chen et al., 2009) as options. The workflow consists of two separate tracks for mapping, one for the male genome with chromosome Y, and the other for the female genome without chromosome Y. Reads are mapped to both the genome and the transcriptome reference because alignments to the genome can locate transcripts that are not annotated in the transcriptome database, while alignments to the transcriptome can identify splice junctions. The mapping results are merged to output a unique-mapped read set and a multi-mapped read set for
The Author 2011. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oup.com at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
