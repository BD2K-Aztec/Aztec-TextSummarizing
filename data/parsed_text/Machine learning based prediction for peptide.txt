Motivation: Ion mobility spectrometry (IMS) has gained significant traction over the past few years for rapid, high-resolution separations of analytes based upon gas-phase ion structure, with significant potential impacts in the field of proteomic analysis. IMS coupled with mass spectrometry (MS) affords multiple improvements over traditional proteomics techniques, such as in the elucidation of secondary structure information, identification of post-translational modifications, as well as higher identification rates with reduced experiment times. The high throughput nature of this technique benefits from accurate calculation of cross sections, mobilities and associated drift times of peptides, thereby enhancing downstream data analysis. Here, we present a model that uses physicochemical properties of peptides to accurately predict a peptide's drift time directly from its amino acid sequence. This model is used in conjunction with two mathematical techniques, a partial least squares regression and a support vector regression setting. Results: When tested on an experimentally created high confidence database of 8675 peptide sequences with measured drift times, both techniques statistically significantly outperform the intrinsic size parameters-based calculations, the currently held practice in the field, on all charge states (+2, +3 and +4). Availability: The software executable, imPredict, is available for download from
INTRODUCTIONThe capability of ion mobility spectrometry coupled with mass spectrometry (IMS-MS) to characterize biological mixtures has been extensively reported (). IMS offers fast separation times () as well as additional information on ion structure that can assist e.g. identification of post-translational modifications () as well as gas-phase collision cross * To whom correspondence should be addressed. sections of peptides (). Determination of collision cross section can aid structural studies and provide clues to understanding protein function. Calculating the collision cross section also facilitates peptide identification and allows the reduction in false discovery rates (FDRs).investigated the use of intrinsic size parameters (ISPs) for prediction of peptide ion cross sections in IMS. While the results reported for this technique were promising, the application of such a technique to high throughput data analysis is challenging due to modeling the geometry of the ion which is required to solve a series of transport equations to determine the potential of interaction between the buffer gas atoms and the ion. One of the first efforts for computationally calculating collision cross sections and ion mobility drift times was based on determination of the ISPs of amino acid residues using calculations that were based on the stoichiometry of each residue (). The ISP technique is based on the assumption that all peptides are closely packed without major internal cavities and are near spherical in shape. As a result, the volume (and thus the cross section) of a peptide is directly proportional to the sum of the areas of the constituent atoms divided by the total mass. The use of the ISP technique facilitates computational calculation of collision cross sections and hence allows determination of ion mobilities and peptide drift times. The prediction of peptide drift times has practical application in peptide identification and may assist in the reduction of FDRs in high throughput IMS experiments. The ISP method was tested on 271 singly protonated peptides from the original 660 peptides published in. While the results of this calculation are accurate for this dataset, the technique has not been tested on datasets containing higher charge states peptides. A recent meeting abstract () uses an artificial neural network to predict peptide drift times directly without calculating cross sections and claims prediction performance of over 90% on charges +1 (212 peptides) and +2 (306 peptides) while reporting a 75% performance on charge +3 data (77 peptides). Prediction performance in a regression setting is calculated by selecting an error threshold and counting predictions within the error threshold as true predictions and those outside the threshold as false predictions. A more recent method proposed bydeveloped quantitative structureproperty relationships (QSPR) to predict the drift times for a set of 1481 peptides using information derived from molecular structures. Additionally, they
A.R.Shah et al.also investigated the use of multiple mathematical techniques such as partial least squares regression (PLSR), least-squares support vector machines (LS-SVM) () and a Gaussian Process (GP) to predict drift times. They concluded that diversified properties (particularly structural topological information and charge distribution) contribute to the peptide drift time and an LS-SVM and GP coupled with a genetic algorithm for feature selection was capable of capturing the linear and non-linear relationships between the QSPRs. In this article, we present a model consisting of a set of amino acid properties that helps accurately predict the ion mobility drift times for a large experimentally derived database of peptides with varying lengths and charge states, using partial least squares (PLS) and support vector regression (SVR) based methods. The novelty of our method is the determination of ion mobility drift times from physicochemical properties that can be directly calculated from a peptide amino acid sequence. Additionally, our method is computationally efficient and requires no manual determination of molecular structures, thereby making it suitable for high throughput data analysis pipelines. Both the PLS and SVR techniques provide significantly higher prediction performance when compared to the ISP-based technique proposed previously () when tested on a database of 8675 peptides generated at the proteomics facility at Pacific Northwest National Laboratory.
METHODS
IMS-MS measurements for experimental dataset creationIMS provides a powerful tool to separate ions based on their 3D shape. IMS distinguishes ions based on the fact that different ion shapes and charge states travel at different velocities when pulled by a weak electric field through a drift cell filled with an inert buffer gas. In order to quantitatively measure the drift time, mobility and collision cross section of an ion, experiments were conducted using an IMS-TOF MS instrument (). The ions were analyzed by passing them in packets into a 98-cm long drift cell filled with 4 Torr of ultrapure nitrogen buffer gas. Once in the drift cell, a uniform electric field gently pulled the ions through the buffer gas where they quickly reached equilibrium between the forward acceleration force imposed by the electric field and the frictional drag force from the buffer gas. This causes the ions to drift at constant velocity, v, proportional to the applied field Eas shown in Equation (1) ():where the proportionality constant, K (in cm 2 /Vs), is termed the mobility of the ions. Because K is dependent on the number density of the buffer gas (the number of objects per specified volume), it is usually standardized with respect to pressure and temperature and termed reduced mobility, K o. The reduced mobilities were determined by collecting arrival time distributions (ATDs) at four different electric field voltages. The drift time, t D , of a particular ion was extracted from the center of the ATD peak and can be written as:where l is the length of the drift cell, V is the voltage drop across the cell, p is the pressure and t o is the time the ion spends between the exit of thesection can be determined. The relationship between the mobility of an ion and its collision cross section has been derived in detail using kinetic theory () and is given by:where q is the ion charge, N o is the buffer gas density at standard temperature and pressure (STP),  is the reduced mass of the collision partners, k b is Boltzmann's constant and is the momentum transfer collision integral also termed the collision cross section. Using the linear dependence of Equation (2) on p/V , four different measurements were conducted on individual samples from human plasma, mouse plasma and Shewenella Oneidensis MR-1 at 4T pressure and voltages varying from 1.6, 1.8, 2.0 and 2.2 kV. Individual raw data files were then deisotoped using Decon2LS (), and the identified isotopic distributions were clustered using VIPER (), aligned () and peak matched to existing Accurate Mass and Time (AMT) () tag databases for the respective organisms to identify peptides using default parameters for all software and only the mass and elution time dimensions. The drift time for each LC-MS feature was determined by selecting the maximum abundance IMS scan across the entire LC scan range for a feature. Using a consensus approach, only peptides that were observed in at least three out of the four experiments (for each sample) were considered to be part of the final dataset. An additional condition was placed on the experimentally measured drift times for these peptides where the drift times were expected to be linear with p/V across different experiments to the tune of a cross-correlation coefficient value of 0.9999. Lastly, all drift times reported in the database were standardized to a pressure of 4.0T and a voltage of 1800 V. The final dataset, downloadable as Supplementary Material 1, consists of 8675 peptide sequences of varying lengths (642 residues) populated with measured collision cross sections and drift times resulting in an overall FDR of 3.2% (refer Supplementary Material 2 for details on FDR estimation for this dataset). The FDR calculated above is a measure of confidence associated with each peptide in the final dataset.shows a distribution of the number of peptides present for each charge state. Robust models of prediction were built only for +2, +3 and +4 charge states. Charge states +1 and +5 or higher are very sparse and we believe the peptides present in these datasets do not exhibit sufficient sequence variability to develop comprehensive drift time prediction models that would perform adequately on novel peptides. Additional experiments on complex biological mixtures containing higher charged species will result in adequate training data for such models.
PLSRThe PLS approach is widely applied in the field of chemometrics (), in sensory evaluation () and more recently to predict drift times in IMS (). The PLS technique is a method for relating two matrices, X (the independent variable) and Y (the response variable) by a linear multivariate model, but goes beyond traditional regression in that it models also the structure of X and Y. The general underlying model of multivariate PLS is given bywhere X is an n  n matrix of predictors, Y is an n  p matrix of responses, T is a n  l matrix (the score, component or factor matrix), P and Q are, Page: 1603 16011607
Ion mobility spectrometryrespectively, m  l and p  l loading matrices and matrices E and F are the error terms, assumed to be i.i.d. normal.
SVRThe application of support vector machines (SVMs) in classification problems is well studied within the wider bioinformatics community. Numerous examples exist in literature where SVMs are used as a classification technique with state-of-the-art prediction accuracies and as such a detailed discussion here would be redundant. The application of SVMs as a technique for high-dimensional regression provides the ability to predict real values with high precision and is relatively less common in literature. We select -SVR as our intention is to not penalize prediction errors that are below the resolution of the instrument setup when measuring drift times. Additionally, the use of an SVR method provides a predictive probability interval based on the framework suggested by Lin and Weng (2004). As formulated in Vapnik (1998), the -SVR problem can be explained as follows. Given a set of training data available to us ={x i ,y i } N i=1 where y i = 1,...,N are continuous output values, the goal of -SVR is to approximate a linear function of the formwith w  R N and b  R that has at most  deviation from all possible targets y i and <.,.> denotes a dot product in R N. To ensure that we do not accept any deviations larger than , one can minimize the norm,As outlined in Smola and Scholkopf (2004), one can write this as a convex optimization problem with the introduction of slack variables , * i to cope with otherwise infeasible problems to minimizeThe constant C determines the trade-off between the flatness of f and the amount up to which errors larger than  are tolerated. The selection of C and  has significant effect on the performance of the SVR. The value of C is derived from the training data using the following equations as suggested bywhere y and  y are the mean and standard deviation of the drift times from the entire dataset. The value of  is selected based on the resolution of the instrument setup for drift times. When compared to a PLSR technique, the SVR is a more robust method that is capable of modeling both linear as well as non-linear relationships between the feature vector and the target values. The robustness comes at a computational cost when training the algorithm as it involves solving a quadratic programming problem. The testing phase of the algorithm or prediction for new peptides is a linear calculation and a fast operation. Using a least squares non-linear SVM technique (), also referred commonly as ridge regression (), could avoid much of the computation as it involves solving a linear programming problem as opposed to a quadratic one.
Peptide vectorizationA common characteristic between both the PLS and the SVR technique is the modeling of the independent variable matrix X that is a certain dimensions in length and is commonly referred to as a feature vector. This requirement dictates that each peptide be represented as a fixed-length n-dimensional vector of properties. Each dimension in this fixed-length vector plays a role in the final determination of the ion mobility drift times for these peptides. Our feature vector is a combination of the reversed phase high performance liquid chromatography (LC) peptide elution time (normalized on a scale of zero to unity), the physicochemical properties) 10 HydrophilicityHoppWoods Scale () 11 HydropathicityRoseman scale () 12 PolarityZimmerman polarity () 13 Bulkiness () 14134 120 dimensional encoding for structure of a peptide and a structural representation of its amino acid composition. The normalized elution time (NET) of a peptide represents the time a peptide is retained within a high-performance reverse phase liquid chromatography separations column. We use a software utility that predicts the NET directly from the amino acid composition of a peptide. Details of this algorithm are further described inwhile the software is freely available from our web site: http://omics.pnl.gov/software/NETPredictionUtility.php. The physicochemical properties of a peptide/protein sequence have been successfully used to predict subcellular localization of protein sequences (), proteinprotein interactions (;), promoter regions (), long disordered regions () and sequence homology () among others. Our selection of these properties is a variant of a model used for predicting proteotypic peptides (peptides that are likely to be observed in MS-based experiments) (). In order to encode the structural composition of amino acid residues we have tried multiple encodings from using the output of predictive algorithms such as PredictProtein () to profile-based string kernel representations (). However, a simplistic encoding scheme, that divides the peptides into fifths and accommodates the tail end, achieves the highest levels of accuracy. Each chunk is encoded as a 20-dimensional vector (a dimension for every amino acid residue) resulting in 100 dimensions for the chunks and 20 dimensions for the tail (the left-over residues after dividing by 5), encoding a histogram of amino acid distributions. The granularity of this representation (number of chunks and chunk size) can be increased and we have experimented with different chunk sizes, with the best performance reported below. We also investigated the use of the ISP parameter as a component of the feature vector. The information content within the ISP is captured by the mass, length and the peptide chunks and as a result did not see any significant improvement in the model performance.outlines the final set of features selected that model diverse peptide properties directly derived from a peptide sequence and provide the best prediction performance. The individual features are on different scales and hence the feature vectors are normalized to have zero mean and unit variance. The Supplementary Material 3 contain the details on the scales of the different features.
RESULTS AND DISCUSSIONWe have developed a computational method, imPredict, to predict the ion mobility drift times for polypeptide ions of modest size (e.g. 50-mer) directly from their amino acids compositions for +2, +3 and +4 charge states using two mathematical techniques, Page: 1604 16011607
A.R.Shah et al.PLSR and SVR. We compare the prediction performance of both these techniques with the ISP () technique, on an experimentally derived dataset.
Predicting ion mobility drift timesWe compared the results of imPredict using both SVR and PLS with the ISP technique for three charge states (+2 to +4). The results reported herein are using a 5-fold cross validation (CV) technique for the PLS and SVR prediction models while the ISP technique was re-implemented in software. The ISP for a residue is directly related to its density (average mass/size ratio of its constituent atoms) and is easily calculated by the following formula as suggested by (). where r i are the radii of the atoms and m i are their masses. The ISP is related to the cross section of the peptide sequence by a linear equation presented in. The drift time for the peptide can then be calculated using the theory presented in Section 2.1. The results of the ISP technique have only been published thus far on a singly protonated dataset containing 263 peptides. This is the first report of that technique on higher charge state data. The n-fold CV technique, as suggested by, assures an un-biased evaluation for learning algorithms by randomly dividing the entire dataset in n (n = 5 in our case) distinct subparts. Of the n subparts, a single subpart is retained as the validation data for testing the model, and the remaining n1 parts are used as the training data. The CV process is then repeated n times, with each of the parts used exactly once as the validation data. We use the plsregress method, available as part of the statistics toolbox in Matlab R2008a, to test the PLSR method. Using minimum mean squared error (MSE) as the determining factor, the optimal number of components was determined to be 30, 44 and 9 for the respective charge states. For the -SVR models, the libsvm software library () was used with a linear kernel. The choice of epsilon SVR as opposed to a Huber loss function is motivated by a rigorous evaluation described here (). Using Equation (7), the C values for the respective charge state models (+2, +3 and +4) are 34.75, 33.5 and 33.36 while the  values were constant at 0.5 based on the drift time resolution of the instrument setup. Additionally, we used the probability estimates as produced by the libSVM software to generate predictive intervals for each target drift time for downstream data analysis.displays a comparative analysis of the fraction of peptides that can be correctly predicted based on various percentage error threshold levels using all techniques. The error residuals are calculated as a fraction of the difference in measured and predicted value to the measured value. When multiplied by hundred, they give the percentage error for each prediction. Methods for charge +2 carry a dot as marker, for charge +3 carry a triangle as marker and for charge +4 carry a square. The ISP parameter technique is represented by a dotted line, the PLS based method with a long dash and dash line while the SVR based method is denoted with a dash and dot line. The figure resembles a cumulative receiver operating characteristic curve and aims to depict the number of peptides that can be accurately predicted at a given error threshold. A higher curve (larger y intercept) indicates a larger number of peptides with predicted drift times that have errors that are smaller than the supplied threshold (x-axis) value. As can be seen fromthe figure, the imPredict curves yield more accurate results at all threshold levels when compared to the ISP method. Additionally, one can observe that the curves for the imPredict methods using PLS and SVR closely follow each other suggesting that the two techniques yield comparable performance. To further distinguish between the three methods, we report other measures of accuracy such as the squared value of the Pearson's correlation coefficient (), generally represented as R 2 and the MSE. The Pearson's coefficient is a standard method of estimating the degree to which two series are correlated while the MSE is another way to quantify the difference between the actual value and the predicted value for an estimator.presents the Pearson's correlation coefficient (R 2 ) and the MSE (in brackets) for the predicted drift times when compared to the experimentally measured drift times. A higher value on the Pearson's co-efficient and a lower value of the MSE indicate a better predictor. In all cases, the PLS-based method yields the best value, the SVR is a close second and the ISP technique is the worst performer.plots the histograms for percentage error when predicting drift times for peptides with charges +2 (a), +3 (b) and +4 (c). A higher and narrower curve indicates a larger number of peptides with smaller percentage errors and is reflective of better performance and higher accuracy levels. Fromand, one can conclude that all three methods predict the charge +2 peptides to high levels of accuracy. The PLS method outperforms the other two methods and the near-Gaussian nature of the error distributions suggests a strong linear dependence of drift times on the model. The charges +3 and +4, on the other hand, are difficult to predict and the MSEs on these peptides are higher for all methods. For the charge +3 peptides, Page: 1605 16011607the ISP algorithm, the dashed line with squares is for the the PLS technique and the solid line represents the SVR technique. Different charge states are plotted on different graphs for clarity. The x-axis values when multiplied by 100 gives the percentage error for those prediction models., the ISP and the SVR methods tend to overestimate the drift times while the PLS method slightly underestimates them. As far as the charge +4 peptides are concerned, all three methods overestimate the drift times () and once again the PLS method is the best performer.
Ion mobility spectrometry
Feature selectionThe quest for an optimal set of properties modeling the drift times is an ongoing research effort and a never ending one as well. However, of the given set of properties described above, it is important to discern which features play a critical role in the modeling of ion mobility drift times. Variable selection on PLS models is a computationally intensive exercise where each feature can be left out and a measure of performance prediction (like MSE) computed to determine whether the feature is an important attribute or otherwise. A similar approach can be used with the SVR model where the MSEMW, molecular weight.and CV R 2 values can be used to determine the contribution of each feature. We use the F-score technique as suggested byin conjunction with SVR for determination of the importance of each feature.presents the five most important features for the three charge states along with their F-score values while Supplementary Material 4 contains the entire F-score tables. The blanks in the table represent a component from the structural encoding. As expected in all three cases, the molecular weight, NET and the length of the peptide are indicated as important attributes. Higher charge state models have greater dependence on the other features while models for lower charge states (specifically +2) are highly dependent on the mass of the ions.illustrates the correlation (93% on charge +2, 85% on charge +3 and 89% on charge +4) that can be achieved by a prediction model using only individual peptide masses. The introduction of each additional feature within the machine learning framework incrementally improves the prediction accuracy. Results for +1 and +5 charge state are not shown as there are only 14 and 90 high confidence drift time measurements and they do not represent adequate peptide variability.
DiscussionGiven the increased application of IMS to biological separations and proteomics research, there is a need for a high throughput fast computational method to predict ion mobility drift times.
Page: 1606 16011607
A.R.Shah et al.For one, such a computational utility can be an indispensable tool for extending existing AMT tag databases, built with extensive tandem MS experiments, with the added dimension of ion mobility at no additional cost. High throughput IMS-MS measurements can then be used and a 3D peptide signature (mass, elution time and drift time) can be compared against extended AMT tag databases. The added dimension of separation is expected to reduce false positive matches and help biological inference. The practical challenge with this approach would be the high degrees of prediction accuracies desired from such a prediction utility. While the data for the charge +2 peptides suggest the feasibility of the imPredict approach, charges +3 and +4 present opportunities to improve the performance. As the current imPredict model uses the same set of features to represent a peptide for all charge states, it is possible to expand on this research and include charge-specific properties in the feature set. The superior performance of the PLSR-based method suggests that the drift times have a strong linear dependence on the set of properties. The introduction of more properties depicting peptide structure such as the presence of certain sequence-structural motifs () or dipeptide combinations of residues could help improve the prediction accuracies. We believe that the currently generated training data does not exhibit sufficient variability in amino acid residues (especially for charge +4) to investigate sequence-order based feature vectors. To develop a comprehensive utility such as the NET prediction tool (), one would have to continually evolve the model as more peptides are available for training.
CONCLUSIONSThe highly reproducible nature of ion mobility drift times for peptide ions makes IMS-MS platforms highly attractive for high throughput peptide analyses. However, the lack of a purely computational technique to determine these drift times limits downstream high throughput analyses and peptide identifications. Here we present imPredict, a computational technique that provides distinct models for charge states +2, +3 and +4, and produces highly accurate drift times that are statistically significantly better than the ones obtained with the ISP-based technique, the only other computational technique previously reported for accurate calculation of drift times, for all considered charge states. The imPredict algorithm illustrates the feasibility of a purely computational technique for accurately predicting ion mobility drift times. The high prediction performance attained by the PLSR method suggests required improvement in modeling the drift times for charge +3 and +4.
The Author 2010. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oxfordjournals.org 1601 at :: on August 31, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
at :: on August 31, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
