Background: Gene-and pathway-based analyses offer a useful alternative and complement to the usual single SNP-based analysis for GWAS. On the other hand, most existing gene-and pathway-based tests are not highly adaptive, and/or require the availability of individual-level genotype and phenotype data. It would be desirable to have highly adaptive tests applicable to summary statistics for single SNPs. This has become increasingly important given the popularity of large-scale meta-analyses of multiple GWASs and the practical availability of either single GWAS or meta-analyzed GWAS summary statistics for single SNPs. Results: We extend two adaptive tests for gene-and pathway-level association with a univariate trait to the case with GWAS summary statistics without individual-level genotype and phenotype data. We use the WTCCC GWAS data to evaluate and compare the proposed methods and several existing methods. We further illustrate their applications to a meta-analyzed dataset to identify genes and pathways associated with blood pressure, demonstrating the potential usefulness of the proposed methods. The methods are implemented in R package aSPU, freely and publicly available. Availability and implementation: https://cran.r-project.org/web/packages/aSPU/
IntroductionIn spite of the tremendous success of genome-wide association studies (GWASs), due to modest to small effect sizes of the majority of causal SNPs for complex and common disease, large sample sizes and more powerful statistical tests are always needed. Furthermore, even when some associated SNPs or loci are identified by the most popular single SNP-based analysis, it is often extremely difficult to offer a functional interpretation that can shed light on the underlying biology. As alternatives, gene-and pathway-based analyses have been proposed and applied for single traits, demonstrating their useful and complementary roles (). A statistical challenge is that, due to unknown true association patterns, there is no uniformly most powerful test to detect multiple SNP-single trait associations; an association test may perform well for one dataset, but not necessarily for another. For example, the presence of non-associated SNPs will largely diminish the power of a standard test if no effective SNP selection or weighting is adopted ().proposed a data-adaptive (aSPU) approach based on estimating and selecting the most powerful test among a class of so-called sum of powered score (SPU) tests, which cover several popular tests as special cases, such as the burden test, a variance component test and a univariate test. The main idea is to use various values of a parameter to construct data-driven and varying weights for the SNPs, thus adaptive to unknown signal sparsity and association directions among the multiple SNPs being tested. Furthermore,extended the methodology to pathway analysis (aSPUpath). In particular, two parameters are introduced such that the test is adaptive at both the SNP and gene levels. As demonstrated therein, due to their high data-adaptivity, the two adaptive tests remained powerful across a wide range of scenarios.However, the two adaptive tests for gene-and pathway-single trait associations are only applicable to the case with individuallevel genotype and phenotype data. Due to various reasons, it is often difficult for many researchers to obtain access to individuallevel data. At the same time, it is easier to obtain access to some summary statistics, e.g. P-values, of individual SNPs in a GWAS. In addition, use of some summary statistics is often necessary for practical meta analyses, which have become increasingly popular and important for complex disease and traits (). Here we propose extending the two highly adaptive tests to the case with only summary statistics for individual SNPs, demonstrating their applications to a meta-analyzed GWAS dataset for blood pressure (). In numerical examples we compared our methods with genebased GATES () and three pathway-based approaches, GATES-Simes (), HYST () and MAGMA (). All methods are for a single (univariate) trait. GATES adopts an extended Simes procedure to correct multiple testing while calculating the P-value quickly based on SNP summary statistics. GATES-Simes extends the main idea of GATES to extract the most significant gene-level P-value for a pathway, whereas HYST uses Fisher's method to combine multiple genes' P-values. MAGMA is based on multiple regression. We also considered one gene set enrichment analysis (GSEA) method, i-GSEAGWAS (), an extension of GSEA () to GWAS summary statistics. Note that here our goal is global association testing in the category of 'selfcontained tests' with a null hypothesis H 0 that none of any genes in a pathway is associated with disease, in contrast to enrichment or competitive testing with a null hypothesis H 0;E that the proportion of associated genes in a pathway is no more than that in the rest of the genes; since rejecting H 0;E implies rejecting H 0 , a global testing is often more powerful than an enrichment analysis (). The proposed methods are available in R package aSPU, which is downloadable from CRAN.
MethodsWe first assume that individual genotype and phenotype data are available, facilitating the derivation of our proposed methods later. Suppose for individual i  1;    ; n, we have a quantitative or binary trait Y i , and a vector of the genotype scores for k SNPs X i  X i1 ;    ; X ik  0 , possibly drawn from either a single gene or a pathway with multiple genes. As usual we use the additive coding for each SNP: X ij  0, 1 or 2 is the count of an allele at SNP j for subject i. We also assume a vector of covariates W i. We adopt a generalized linear model (GLM):where g is the link function (i.e. the identity function for a quantitative trait, or a logit function for a binary trait). We would like to test the null hypothesis H 0 : b  b 1 ;    ; b k  0  0; that is, there is no association between any SNP and the trait under H 0. The score vector U  U 1 ;    ; U k  0 for b iswhere ^ l 0;i  ^ EY i jH 0   g 1  ^ b 0  ^ a 0 W i  is the estimated mean of Y i in the null model (under H 0 ). The covariance matrix of U can be estimated aswith its mean under H 0 aswhere r 2 i  VarY i jH 0  and R X  CovX.
A gene-based adaptive test with summary statisticsNow, suppose that we do not have individual-level data (Y i , X i )'s but only single SNP-based summary statistics, say Z-scores Z  Z 1 ;. .. ; Z k  0 with Z j  ^ b j =se ^ b j  % U j =seU j  for j  1;    ; k; the approximation is based on the asymptotic equivalence between the Wald test and the score test. A key observation is thatwhere the last approximation is based on Eq. (1). Note that Corr(X) can be easily estimated from some reference panel, e.g. the CEU sample in the Hapmap data or 1000 Genome data, for a similar target population. Accordingly, we obtain an estimate of CorrZ j ; Z l , say R. Mimicking the SPU and aSPU tests for individual genotype and phenotype data, we can now define the corresponding tests with only summary statistics Z:where P SPUsc;Z is the P-value of the SPUs c; Z test, and C  f1; 2;. .. ; 8; 1g is often used. Note that since SPUsc; Z / jjZjj c ! max j jZ j j as an even integer c ! 1, we define SPUs1; Z  max j jZ j j. An optimal choice of c depends on the unknown SNP-trait association patterns. For example, if most SNPs are (almost) equally associated with the trait in the same direction, then the burden test SPUs(1) will be (nearly) most powerful; if only one or few SNPs are associated with the trait, then using a larger c, e.g. SPUs(8) or SPUs(1), is expected to be more powerful; on the other hand, if the truth is between the above two extremes, then using an intermediateindependent Z b $ N0; R for b  1;    ; B;case, we calculate jZ j j  U 1 1  p j =2, where p j is the P-value for SNP j and U is the CDF of the standard normal distribution N(0, 1). Then we will replace Z j 's by jZ j j' s in the above formula (2) (and do so similarly for the null statistics too).
A pathway-based adaptive test with summary statisticsThe idea of substituting a Score vector with Z-scores can be similarly extended to an adaptive pathway-level test (). Given a pathway S with jSj genes, we partition its Z-scores aswhere two integers c > 0 and c G > 0 are used to adaptively weight the SNPs and genes respectively. For example, a larger c G (or c) is more effective when there are a smaller number of genes (or SNPs) associated with the trait. Since the optimal values of (c; c G ) are unknown, to adaptively choose (cis used to obtain the P-values. However, now the dimension of Z is possibly larger, leading to a much larger correlation matrix R. For computational efficiency, we assume that any SNPs in different chromosomes are independent, leading to a block-diagonal R. Given that most genes and pathways will not be significant in most applications, we employ a stage-wise strategy to gradually increase the simulation number B to save computing time for aSPUs and aSPUsPath. In the later applications, we first performed B  5000 simulations for all genes and pathways, and then increased B to 10 6 or 10 7 for those genes (or 10 5 for pathways) with a P-value < 0.003.(). CD is an autoimmune disease with a strong genetic component. The WTCCC GWAS dataset contains about 2000 CD-affected cases and about 3000 controls with a total of 500 568 SNPs. Following the WTCCC's quality control (QC) recommendations, we removed subjects and SNPs that did not pass the QC criteria, resulting in 469 612 SNPs in 1748 case subjects and 2938 control subjects. We further removed SNPs with MAF <5% since we would use a small reference panel to infer the LD structure for a set of SNPs. In a ControlControl experiment, we randomly divided the controls into two groups, each with 1469 samples, then tested for possible association between the group indicator and a gene or a pathway. Since no association was expected, the goal was to investigate how well a method could control type I errors or false positives. In a CaseControl analysis, the two groups contained 1748 cases and 2938 controls respectively, and we'd like to see the power of a method to detect possible associations. We calculated the Z-score for each SNP based on individual-level data, then used only the Z-scores in subsequent analyses for any summary statistics-based method. We analyzed 4572 genes mapped to 186 KEGG pathways. The significance threshold after the Bonferroni correction was 0.05/4572  1:09  10 5 for gene-based analysis, or 0:05=186  0:000268 for pathway-based analysis. The simulation number of B  10 6 was used as a default, though we also used B  10 5 for comparison in aSPUs and aSPUsPath.
Applications
WTCCC data
Choice of the reference panelsWe first investigated how the choice of the reference panels in estimating LD among SNPs might influence the performance. We considered three ways to estimate a correlation matrix R among the SNPs: using (i) 90 Hapmap CEU samples, (ii) 100 randomly chosen WTCCC control samples and (iii) the whole 2938 WTCCC controls.shows the QQ plots of the aSPUs P-values based on each of the three ways to estimate the correlation matrix for the ControlControl experiment (upper row) and CaseControl experiment (lower row). Based on the ControlControl analysis, we conclude that using the Hapmap samples seemed to give a bit inflated type I errors while the other two performed well. The less desirable performance of using the Hapmap samples could be due to the small sample size, leading to unstable estimates. However, by comparison with that of using 100 WTCCC controls, it was more likely due to some inherent differences between the two panels. Treating using the whole WTCCC controls as the gold standard, we compared in more details about the estimated P-values in. Most points are on the identity line. However some points are above the line, implying that using the Hapmap panel over-estimated the significance levels of several genes (i.e. with smaller Pvalues). Nevertheless, the agreement of the aSPUs P-values based on the reference panels was high: their correlation coefficients in both experiments were 0.98. In summary, the performance using any reference panel was mostly satisfactory with an estimated inflation factor k close to 1 (e.g.
Pathway analysisWe first investigated how the choice of the reference panel might influence the performance of a pathway-level test. Again we used either the 90 Hapmap samples or all WTCCC controls to estimate the correlation matrices.compares the results for each of the three methods, aSPUsPath, GATES-Simes and HYST. Perhaps due to more SNPs in a gene set (pathway), aSPUsPath appeared to be more robust than aSPUs to estimation errors using a small reference panel. Again GATES-Simes was very robust due to its use of only a few top SNPs and genes to construct its test statistic. GATES-Simes identified the same 5 pathways with any choice of the reference panels based on the threshold of P < 0.00025. HYST seemed to be more influenced by incorrectly estimated correlation matrices (due to its using Fisher's method to combine the P-values of all the genes in a pathway). HYST identified the same 3 pathways using either the Hapmap panel or 100 WTCCC controls. However, it identified 12 pathways using all WTCCC controls as the reference panel. This indicates that the accuracy of estimating the correlation matrix is critical to HYST. In comparison, aSPUsPath identified 17 significant pathways using either the 100 or all WTCCC controls as the reference panel, among which 15 pathways were common; the Pearson correlation between the two sets of the P-values was 0.998. Using the Hapmap panel, aSPUsPath identified 16 significant pathways, among which 11 pathways were common with those identified by using the whole WTCCC control as the reference panel., B=10^6Adaptive gene-and pathway-trait association testingshows 17 highly significant KEGG pathways with Pvalues less than 0.00001 by any of the three methods. The aSPUsPath identified nine such highly significant pathways using either all or 100 WTCCC controls as the reference panel, a much larger number than those of the other two methods, suggesting possibly higher power of aSPUsPath for the WTCCC data. Furthermore, the close performance between using the two sets of the WTCCC controls as reference panels suggested that using 100 samples from the corresponding population worked well enough in identifying significant pathways. The five KEGG pathways that have been confirmed to be associated with susceptibility to CD by meta-analysis and replication studies () are all among the 17 significant pathways. We also performed analysis with one GSEA method, i-GSEA4GWAS, but it did not find any significant pathway.
ICBP dataWe illustrate the application of the methods to the summary statistics of a meta analysis by the International Consortium for Blood Pressure Genome-Wide Association Studies (ICBP GWAS) (). The data include the P-values of 2.6 million SNPs for the diastolic blood pressure (DBP) based on the discovery sample of 29 studies with 69 395 individuals of European ancestry. We obtained the genomic coordinates of the SNPs and genes according to the human reference genome hg19, and assigned SNPs within 2 kb upstream or downstream a gene to the gene using software MAGMA (). About 1 095 843 (41.04%) SNPs were mapped into at least one of 17543 genes. We set the gene-level significance threshold at 0.05/17543  2:85  10 6 based on the Bonferroni correction. We used the Hapmap CEU reference panel to estimate the correlations among the SNPs, downloaded from the Plink website ().shows the significant genes identified by aSPUs, GATES (), VEGAS () and MAGMA (). We implemented the first two methods but used the original software for the latter two. In total 49 significant genes were identified by at least one method, in which 14 were common across all the methods. In comparison with a single SNP-based analysis,identified 29 significant independent SNPs in 28 loci/genes for SBP and/or diastolic BP (DBP) based on a much larger sample combining both the discovery and validation samples with up to 133 661 additional individuals; even so, if only SBP was considered, 4 of the 29 SNPs were no longer significant. In contrast, as shown in, 12 genes out of the 28 loci were detected by gene-based testing with a much smaller sample size of the discovery sample. In fact, based on single SNP analysis of only the discovery sample as used here, only 8 of the 29 independent SNPs/loci inofwere significant. The Manhattan plots for the various methods are shown in Supplementary. Since GATES is essentially a univariate method with a modified Simes procedure for multiple testing adjustment, as expected, its results were similar to that of SPUs(1), which is the univariate minimum P-value method: SPUs(1) detected 32 associated genes, among which 28 genes overlapped with those of GATES; in comparison, SPUs(1) and SPUs(2) identified 25 and 28 significant genes, among which only 17 and 20 genes were common to those of GATES. On the other hand, the test statistic of VEGAS is P k j1 Z 2 j  SPUs2, though VEGAS was implemented differently inSNP/gene mapping and covariance estimation (), we would still expect that VEGAS and SPUs(2) performed similarly: it was confirmed that 21 of the 28 genes identified by SPUs(2) overlapped with that of VEGAS. The gene ULK4 was uniquely identified by aSPUs. As shown in, gene ULK4 contains many nearly significant SNPs and many non-significant SNPs, requiring an adaptive test like aSPUs with effective SNP weighting (or selection) to detect it. For gene HIST1H4C that was identified by GATES but not by other methods, it contained 11 SNPs; only one of the SNPs had a P-value around 2e-7 while those for other SNPs were all around 0.1 or 0.01. The P-values of aSPUs, GATES, MAGMA and VEGAS were 4.70e6, 1.29e-6, 0.0015 and 0.00023 respectively. Due to the sparse signal with only one significant SNP, it favored a univariate method like GATES; nevertheless, due to the inclusion of SPU(1) (with a Pvalue of 2.0e-6), the P-value of the aSPUs test was almost significant. Now consider another gene BRAP that was identified by aSPUs, VEGAS and MAGMA but not by GATES. It contained 10 SNPs, 6 of which were with a P-value around 2e-6 while other SNPs were much less significant. The P-values of aSPUs, GATES, MAGMA and VEGAS were 1.3e-6, 5.06e-6, 2.065e-7 and 1e-7 respectively, confirming an advantage of aSPUs in accumulating nonsparse and weak signals with multiple moderately associated SNPs.
Gene-based analysis
Pathway-based analysisFinally we conducted a pathway-level analysis. We used the Kyoto Encyclopedia of Genes and Genomes (KEGG) pathways () downloaded from MSigDB (). There were 186 pathways with 4874 genes and 309 347 SNPs mapped for trait DBP. We restricted the analysis to SNPs with MAF !5%. We randomly removed some adjacent SNPs within 50kb in high LD with r > 0.9 based on the genotype data of the Hapmap CEU sample (release 2). We set the significance threshold at 0:05=186  0:000268 based on the Bonferroni correction. In total 42 pathways were identified to be significant, including 24 by aSPUsPath, 38 by GATES-Simes, 34 by Hyst and 7 by MAGMA, as shown in. Here GATES-Simes and Hyst identified more pathways than aSPUsPath and MAGMA. Nevertheless, aSPUsPath uniquely identified 'hsa04010 MAPK signaling pathway', which contains 254 genes, including 4 known BP-related genes inof; out of a total of 16503 SNPs in this pathway, 55, 21 and 6 SNPs were significant at P < 1e-5, 1e-6 and 1e-7 respectively, demonstrating multiple moderate associations (in multiple genes) and thus lower power of a univariate test like GATES-Simes.
DiscussionWe have proposed two adaptive tests, aSPUs and aSPUsPath, respectively for gene-and pathway-level association analyses of a univariate trait with the availability of only summary statistics, such as Z-statistics or P-values, for individual SNPs. With only summary statistics like Z-statistics or P-values, one has to recourse to some reference panel to estimate LD or correlations among SNPs, whichAdaptive gene-and pathway-trait association testingmight influence the performance of subsequent association testing. Overall, the P-values calculated from using different panels were similar as shown in our analysis of the WTCCC data. However, depending on the reference panels being used, the results for a small number of the genes or pathways could be different. Hence, caution must be taken, and an independent validation on any detected associations based on summary statistics becomes more important. We have further illustrated the application of the proposed methods to a meta-analyzed GWAS data, demonstrating their usefulness as compared to the popular single SNP-based analysis. In addition, we have compared their performance with several other existing tests. Since there is no uniformly most powerful test for multiple SNPs, it would be desirable to have an adaptive test that can robustly maintain high, not necessarily highest, power across various scenarios, which motivated our proposed two tests (). Our proposed tests offer an alternative and complement to existing gene-and pathway-level association testing. We have developed an R package aSPU to facilitate their use.
Bioinformatics, 32(8), 2016, 11781184 doi: 10.1093/bioinformatics/btv719 Advance Access Publication Date: 10 December 2015 Original Paper at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
< c < 8, e.g. SPUs(2) that is similar to a variance-component test like KMR or SKAT (Liu et al., 2007; Pan, 2011; Wu et al., 2010), may have higher power. Note that SPUs(1) is exactly the same as the univariate minimum P-value method most often used in GWAS. Since we do not know the optimal value of c, we try multiple ones in C and then estimate and select the best one by aSPUs. Note that, in our experience, often SPUs(8) and SPUs(1) give almost identical results, hence we do not try any c values between 8 and 1 in C. By the asymptotic distribution of U, we know that for a large n, under H 0 , Z follows a multivariate normal distribution N(0, R), where R is the correlation matrix of X i that can be estimated from some reference panel as discussed. Based on this known null distribution of Z, we use Monte Carlo simulations to obtain the P-values of the SPUs and aSPUs tests. Specifically, (i) we generate
at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
II.-Y.Kwak and W.Pan at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
