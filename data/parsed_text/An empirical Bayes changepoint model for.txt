Motivation: Next-generation RNA sequencing (RNA-seq) has been widely used to investigate alternative isoform regulations. Among them, alternative 3 0 splice site (SS) and 5 0 SS account for more than 30% of all alternative splicing (AS) events in higher eukaryotes. Recent studies have revealed that they play important roles in building complex organisms and have a critical impact on biological functions which could cause disease. Quite a few analytical methods have been developed to facilitate alternative 3 0 SS and 5 0 SS studies using RNA-seq data. However, these methods have various limitations and their performances may be further improved. Results: We propose an empirical Bayes change-point model to identify alternative 3 0 SS and 5 0 SS. Compared with previous methods, our approach has several unique merits. First of all, our model does not rely on annotation information. Instead, it provides for the first time a systematic framework to integrate various information when available, in particular the useful junction read information , in order to obtain better performance. Second, we utilize an empirical Bayes model to efficiently pool information across genes to improve detection efficiency. Third, we provide a flexible testing framework in which the user can choose to address different levels of questions, namely, whether alternative 3 0 SS or 5 0 SS happens, and/or where it happens. Simulation studies and real data application have demonstrated that our method is powerful and accurate. Availability and implementation: The software is implemented in Java and can be freely down-loaded from http://ebchangepoint.sourceforge.net/.
IntroductionWith continued development and improvement, next-generation RNA sequencing (RNA-seq) has become more and more popular, owing to its affordable cost and advantages over existing technologies. In addition, its superiorities in detecting transcripts in undetermined genomic sequences and very accurate digital resolution make it a more attractive technology which is expected to gradually replace microarray technology (). Many compelling biological problems, once hard to tackle, can be solved by new methods built upon RNA-seq. In particular, alternative splice forms play important roles in building complex organisms from a limited number of genes. They provide a major mechanism for enhancing transcriptome and proteome diversity, and critically regulate various biological functions (). Using RNA-seq, people observe that more than 90% of human genes undergo alternative splicing, a much higher percentage than anticipated (). Of various alternative splice forms, alternative 3 0 SS and 5 0 SS are particularly important and constitute more than 30% of all AS events as revealed by RNA-seq (). Several studies have V C The Author 2016. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com found that alternative 3 0 SS and 5 0 SS events are relevant to many diseases. By analyzing alternative 3 0 SS and 5 0 SS events, we can obtain precious diagnostic and prognostic information for therapies (). Thanks to high-throughput RNA-seq, genome-wide quantitative studies on AS events become feasible (). Quite a few computational methods have been developed to detect and identify AS events. These methods can be roughly classified into three categories based on their strategies. The first category, represented by Cufflinks (), performs differential splicing detection based on transcript quantification, which is the most challenging. Short reads, sampled from RNA-seq, can be aligned to multiple transcripts due to the similarity and overlaps between alternative transcripts (). It makes the expression estimation of individual transcript an undetermined problem. In addition, various sampling biases, including position-specific biases (Bohnert and R atsch, 2010;) and sequencespecific biases () in the RNAseq data, incur daunting difficulties for accurate transcript quantification. Consequently, the efficiency of these methods is diminished by the uncertainty in transcript quantification. The second category of methods aims to detect differential splicing by testing differential expression of the annotated events obtained from existing splicing databases. Representative examples in this category include ALEXA-seq (), MISO (), MATS () and SpliceTrap (). Among them, MISO employs a statistical model to estimate expression of alternatively spliced exons and isoforms (); MATS leverages a Bayesian statistical framework to flexibly test the hypothesis of differential alternative splicing patterns (). These methods may work well when splicing events are well and accurately annotated. They are not applicable to detect novel AS events not cataloged yet in existing annotation databases. The third category of methods, including DiffSplice (), DEXSeq () and FDM (), utilizes splice junction read information to overcome the annotation dependency limitation. The performances of these methods are highly dependent on the number and quality of splice junction reads. Sequencing costs often set limits to sequencing depth and coverage of RNA-seq datasets () and, consequently, performance of these junction read-based methods. Furthermore, the number and quality of aligned splice junction reads will also rely on sequencing technology as well as read-mapping tools (). Very recently,propose a change-point model which requires no annotation information. It relies on characterizing the coverage change for detecting alternative polyadenylation (APA). In principle, it can be applied for detecting 3 0 /5 0 AS events. However, compared with APA, a key difference for 3 0 /5 0 alternative splicing is that junction read information can be useful and utilized for locating splice sites. For example, a simple strategy for calling 3 0 / 5 0 AS events is to identify locations supported by at least N independent splice junction reads with different alignment start positions (). It is noted that when sequencing depth is not enough, a significant proportion of 3 0 /5 0 AS events may not be covered by junction reads, in particular when using a stringent N threshold for ensuring quality. Due to the junction read coverage limitation, there is room for improvement even when sequencing depth is high. Exon read coverage may be used as clues for 3 0 /5 0 AS events. We expect that using both coverage and junction read information will improve both sensitivity and specificity of AS 3 0 /5 0 calls compared to relaying solely on junction reads or read coverage. It is therefore desirable to develop a method that can systematically integrate both junction read information and coverage information. From a methodology point of view, Wei's method is a frequestist approach and fails to pool and exploit information across many genes under investigation. In addition, it tests only whether there is a change-point, but not where the change-point is. Thus its changepoint location estimation does not guarantee any multiplicity control. In this paper, we develop an empirical Bayes change-point model for identifying 3 0 /5 0 AS events. Our approach requires no annotation information and is applicable to detect novel aberrant splicing events. Compared with previous methods, our approach has several unique merits. First of all, our model does not rely on annotation information. Instead, it provides for the first time a systematic framework to integrate read coverage information and junction read or annotation information, when available, in order to obtain better performance. Secondly, we utilize an empirical Bayes model to efficiently pool information across genes for improving detection efficiency. Thirdly, we provide a flexible testing framework in which the user can choose to address different levels of questions, namely, whether alternative splicing happens, and/or where it happens. Simulation studies and applications to real data have demonstrated that our method is powerful and accurate.
Methods
Alternative 3 0 SS and 5 0 SS selection and changepoint problemWe formulate alternative 3 0 SS and 5 0 SS selection as a change-point problem and illustrate it via toy examples in. As shown in, different mRNA isoforms, with different expression levels, are generated from a single gene through the alternative selection ofS i;s1:Li  x is1 ;. .. ; x iLi  follow another homogeneous distribution, as described in details below.
Negative Binomial-Beta modelConsidering the over-dispersion of RNA-seq data, we use a Negative Binomial (NB) distribution to characterize the observed read-counts. As shown in, we assume that, when there is no alternative 3 0 SS or 5 0 SS in exon i, the read-counts across the whole exon i will follow a homogeneous Negative Binomial distribution NBr; q i0 , and when there is a change-point, the alternative 3 0 SS or 5 0 SS exon contains a splice site at position s, dividing the read-count sequence into two homogeneous parts governed by two homogeneous Negative Binomial distributions NBr; q i1  and NBr; q i2 , respectively. Formally, we have x ij jq i $NBr; q i0 ; if q i  0NBr; q i1 ; if q i  s and j sNBr; q i2 ; if q i  s and j > sFurthermore, we assume q ik follows a Beta distribution q ik $ Betaa; b, a conjugate prior of the Negative Binomial distribution, in order to characterize fluctuations in technical and biological variation across exons (segments). The hierarchical structure of this Negative Binomial-Beta model is illustrated by. Differently from a conventional Bayesian approach, we will estimate the hyperparameters a and b from the data using an empirical Bayes approach. From the Negative Binomial-Beta model, we have f x ij jr; q i   x ij  r  1Integrating out the unknown exon/segment specific parameter q i , we derive the likelihood of! Br  a; x ij  b Ba; b :Since observations in the same segment are independent and identically distributed (i.i.d.), the likelihood for a homogeneous segment S i; j:k  x ij ; x ij1. .. ; x ik  can be computed asBa; b :If there is no change-point in the sequence S i , the likelihood is f S i jq i  0; r; a; b  f 0 S i;1:Li jr; a; b:When there is a change-point at s, the likelihood is then f S i jq i  s; r; a; b  f 0 S i;1:s jr; a; b  f 0 S i;s1:Li jr; a; b: (5)
Prior information and hot pointsWhen no additional information is available, we assume every position has the same prior probability of being a change-point. Suppose that each sequence S i has a change-point with a prior probability P, and then we assign it equally to each candidate position asIf additional information is available, such as splice junction reads or isoform annotation, we will integrate it and build a more sophisticated model. Specifically, we assign different weights to different candidate positions allowing them to have different prior probabilities as derived from extra information. We define as hot points the positions which are supported by splice junction reads and/or isoform annotation and more likely to be splice sites. The basic strategy is that we assign weight W ! 1, which can be estimated from data or pre-specified by the user, to hot points and weight 1 to ordinary positions. Then the prior probability for each position will bewhere w ij is the weight assigned to position j in sequence i, (i, j) for short, and w ij  1 i fi; j is ordinary position W if i; j is hotpoint:(This weighting scheme allows flexible weight assigning strategies. It is very useful when the user has different kinds of prior information. Assuming that various information has additive effects on the weight of a candidate position, our model can make full use of all kinds of information. Suppose there are m different kinds of information, we can assign weights to candidate positions as follows(k; l  1; 2;. .. ; m). For example, given the annotations and splicing reads, a weight assigning strategy can bewhere b 1 ; b 2 and b 12 measure the additive effects of splice junction reads, isoform annotation and their interactions, respectively. By assigning different weights to different candidate positions and distinguishing hot points from ordinary ones, we can efficiently leverage domain knowledge to improve our model. Since all parameters (b k ) are estimated from data through the empirical Bayes approach, it does not matter if the domain knowledge is dubious or totally wrong. It is noted that there are trade-offs between simple versus sophisticated strategies. Adopting more sophisticated strategy will make better usage of prior information on one hand, but on the other hand, it will introduce more parameters and cause difficulty in parameter estimation. Thus, appropriate strategies need to be chosen to balance these trade-offs for different applications.
Empirical Bayes estimatorEmpirical Bayes estimates combine the Bayesian and frequentist reasoning that the prior probability is estimated frequentistically in order to perform Bayesian inferences (). This kind of combination not only gives the Bayesian accurate, objective and data-related prior information, but also enables frequentists to obtain more test efficiency in solving scientific problems (). For simplicity and generality, we denote U as the set of the parameters for the Negative Binomial-Beta model (r, a and b) and the parameters for characterizing prior information (P and W). The change-point location q i is latent and we sum them out. The maximum likelihood estimation of U, applied to the total N sequences, is thenThe optimization algorithm L-BFGS-B (), a limited-memory modification of the BFGS quasi-Newton method with box constraints, is applied to estimate the parameters U. We set appropriate upper and lower bounds for each parameter (e.g. 0 P 1 for the prior proportion of sequences with change-points). All these procedures are implemented through R (http://www.r-project. org/) and Java.
Empirical Bayes testing and decision procedureThere are two questions we aim to address: Q1: Detection, which genes have change-points? Q2: Identification, where is the change-point, if any? For Q1, we only care about whether there is a change-point or not and are not concerned about where the change-point locates. For Q2, we aim to find the accurate location of the change-point. In other words, if we correctly detect a sequence with change-point but wrongly locate its position, it is still considered as an error. Given the estimated parameters ^ U, we haveFor both two questions, we want to control the false discovery rate (FDR) () at a nominal level a and find as many sequences with change-points as possible at the same time. To obtain this goal, we propose the following two empirical Bayes testing and decision procedures for Q1 and Q2, respectively. An empirical Bayes testing and decision procedure for Q1: 1. Order sequences by p i0 in an ascending order and denote them by p 13. Report sequences S i (S i 2 G Detection ) to have a change-point, where G Detection  fi :An empirical Bayes testing and decision procedure for Q2: 1. Order sequences by 1  p  i  in an ascending order and denote them by p 13. Report sequences S i (S i 2 G Identification ) to have a change-point at positionThrough simulation studies, we will show that these two testing procedures are powerful and can control FDR at the nominal level.
Results
Simulation settingsWe first perform simulation studies to investigate the numerical performance of the proposed method. We randomly generate N  500 sequences, each with length L i  100. Then we select P  N sequences to have change-points. We simulate two scenarios, the first one without hot points and the second one with hot points. For the first scenario, we randomly pick one position with equal probability to be the change-point for all the P  N selected sequences. For the second scenario, we set positions 25, 50 and 75 as hot points with weight W  32 while the other points with weight W  1. one half of the selected P  N sequences have change-points at hot points and the other half don't. As a result, we will have 1  P  N  2 P  N  1  PN homogeneous sequence segments. For these homogeneous sequence segments, we generate q i for each of them based on a Beta distribution Ba; b, which is then used together with r to generate the number of reads aligned to a position based on a Negative Binomial distribution NBr; q i . We set r  10, a  b  4 so that the simulated exons have expression levels close to real data (). We vary P from 0.05 to 0.7 (P  0:05; 0:1; 0:2; 0:3; 0:4; 0:5; 0:6; 0:7) and set the nominal FDR level at 0.1. The simulation was repeated 100 times for each parameter setting, and we report the averaged FDR and sensitivity. For our empirical Bayes models, we also evaluate two settings. The first one does not consider hot points by setting W  1 rather than estimating it. The second one considers hot points by allowing W to be estimated from data. The method inessentially scans the whole sequence and selects a position exhibiting the most dramatic difference as a potential change-point to be determined by a statistical test. Following their strategy, we implement a frequentist testing procedure as a competing method to be compared with our proposed empirical Bayes method. Specifically, this frequentist method scans the whole sequence and finds a position with the most significant difference as quantified by rank-sum testing statistic. It is an extreme testing statistic and its original P-value may not be valid any more. As a result, this frequentist method could not guarantee multiplicity control. To make comparison, we just rank exons based on their maximum rank-sum testing statistic and then claim the same number of significant exons as our models.shows the results for the scenario without hot points. We observe several interesting results. First, our model without considering hot points (NB model without HP), which is ideal for this scenario, can control FDR precisely at the nominal level 0.1 for all settings. Second, our model considering hot points (NB model with HP) can also control the FDR at nominal level 0.1 for all settings. In addition, it demonstrates similar sensitivity as the ideal model which has the information of W  1. This comparable performance suggests that our model considering hot points, which estimates W from data, is more general and robust. Third, both of our empirical Bayes models outperform the frequentist method which demonstrates a higher FDR while with a lower sensitivity. Fourth, the sensitivity for the detection problem (Q1) is much higher than the identification problem (Q2), which is expected, as the latter indeed is more challenging.shows the results for the scenario with hot points simulated. Again, our empirical Bayes models, considering hot points or not, both demonstrate significantly better performance than the frequentist method. Our model considering hot points is the optimal model. It can precisely control FDR at the nominal level and shows the best performance. It is noted that the model without considering hot points erroneously set W  1, and, as a result, it either could not guarantee FDR control for the detection problem (Q1), or has a lower sensitivity than the correct model for the identification problem (Q2). From above results, in comparison of the model considering hot points versus the one without considering hot points, we can see that the former is comparable when applied to data without hotAn empirical Bayes change-point modelpoints, and better than the latter when applied to data with hot points. Therefore, we conclude that our model considering hot points is robust and superior.
Simulation results
Integrating junction read informationSplice junction reads are informative for locating 3 0 /5 0 AS events. A simple strategy by counting splice junction reads support has been used for calling 3 0 /5 0 AS events (). It is therefore desirable to exploit this junction read information. Meanwhile, it is noted that additional genes are still being detected even at high read depths of >1 billion reads (SEQC/MAQC-III), which suggests that many alternative 3 0 /5 0 AS events may not be covered by junction reads in most current RNA-seq studies and there is room for improvement. We show that integrating both coverage and junction read information will bring further improvement over the simple strategy that utilizes only junction read information. We use similar hot points simulation settings as in the previous section except that we simulate only one candidate splicing point (hot point) at the middle. We then assume 40, 50, 60 and 70% 3 0 /5 0 splicing events are captured by junction reads (thus the sensitivities achieved by the simple counting strategy), which are used as hot points in our identification model.shows the sensitivities of our method averaged over 100 runs. We observe a significant improvement brought by our method in all settings. For example, when junction read coverage is low (40%), our sensitivities are almost doubled. Even when junction read coverage is high (70%), our method can still bring more than 10% improvement.
Real data applicationWe then apply our proposed method to analyze a real dataset.conducted whole transcriptome RNA-seq to study melanoma cell migration. Their RNA-seq datasets have been deposited to the NCBI Gene Expression Omnibus (GEO) database (http://www.ncbi.nlm.nih.gov/geo/) with ID GSE33092. We download their raw reads data from GEO. There are 69 925 376 pairedend reads in the control sample SRR354040 from primary human melanocytes infected with RFP lentivirus, and 62 884 955 pairedend reads in the case sample SRR354042 from primary human melanoma sample (). We align the raw reads to the hg19 reference genome using the popular RNA-seq mapping tool Tophat () v1.3.1 with default settings. Exons with short reads found in both samples are used for our analysis. As a result, 62 209 exons from 13 290 distinct genes remain. We calculate the number of reads starting from each position in every exon and bin them every 5 BPs as one point to reduce the effect of sparsity and noise. In addition, we exploit junction read information in our model by setting junction read-supported positions as hot points, whose weights will be estimated from the data. We apply our model considering hot points on the whole genome.shows the estimated parameters for the two samples. We can find that the estimated weights of hot points are bigger than 1 ( ^ W > 1), which indicates that the positions supported by junction reads do have higher prior probabilities than other locations. Our model can capture and make use of this information effectively. To find biologically meaningful 3 0 /5 0 AS events, we try to detect the exons that have change-points in one sample but not in the other sample. We set the FDR level a  0:05 and detect 7222 such exons.shows four representative examples of the detected exons and their estimated change-point positions. For(A) and (B), we observe clear different short read densities before and after the change-points in the melanocyte sample (SRR354040) but not in melanoma sample (SRR354042). In contrast, for(C) and (D), there are clear changes in the melanoma sample but not in melanocyte sample.(A) shows an example of a detected 5 0 AS event which is also covered by junction reads.(B) demonstrates that our model can also detect 3 0 /5 0 AS events precisely in the situation when there are no junction reads covering the splice sites. In addition, as shown in(C), our model can detect exons with multiple alternative splice sites. The detected AS events in(A), (B) and (C) are supported by gene annotations as well, as the detected change-points are close to the splice sites cataloged in UCSC Genes database. We present in(D) a potential novel 3 0 AS event detected by our model, as it is supported by clear change in read density in the melanoma sample. This potential AS event is not covered by junction reads. The new isoform is not found in RefSeq Genes, UCSC Genes or the AceView database, suggesting that this may be a novel splice site yet to be cataloged. As a comparison, we also apply the tool developed by () and the simple strategy, which counts only junction reads, to analyze this dataset. Wei's tool only detects 3366 exons with significant changes between the two samples at the same FDR level, which suggests a lower power compared to our method. For the simple strategy, we call a 3 0 /5 0 AS event if it is supported by one or more junction reads. This strategy detects 796 exons that contain 3 0 /5 0 AS events in one sample but not in the other sample. This improved sensitivity of our method over the simple strategy shows that utilizing junction reads together with read coverage information could obtain a better performance than using junction reads only. We compare these detected AS events with the isoforms cataloged in the AceView database. When the algorithm detects an AS event and there is one in the matching AceView exon as well, we define this detected AS event as supported by AceView. It is noted that this is not an experimental validation but serves as a proxy to the 'truth'. As summarized in, 5234 out of the 7222 AS events our method finds are supported by AceView and 1988 AS events are novel, while for Wei's method, 2308 out of the 3366 AS events are supported and 1058 AS events are novel, and for the simple strategy, 772 AS events are supported and 24 AS events are novel. In contrast, for the whole genome, 64.7% exons contain AS events annotated in the AceView database. Here, our model only uses the junction readsas side information and leaves the AceView annotations for evaluation purpose. The exons reported by our method have a statistically higher supporting rate of 72.5% (P-value 0). Finally, following, we also conduct the gene set enrichment analysis (GSEA) of the genes with 3 0 /5 0 AS events reported by our model in order to evaluate the results from a systems biology point of view. We use the canonical pathways definitions (Version 4) downloaded from the Molecular Signatures Database (http://www.broadinstitute.org/gsea/msigdb/index.jsp). We identify 12 significantly enriched pathways as shown inat an FDR level of 0.05. Interestingly, many of them are relevant to melanoma or cancer. For example, recent studies demonstrate that activation of the Smad2/3 pathway has inhibitory effects on tumor cell plasticity of melanoma (). Regulation of the actin cytoskeleton contributes to cancer cell migration and invasion (). The Notch signaling pathway plays a key role in melanoma growth and progression (). The meaningful GSEA results from a systems biology point of view provide supplementary support to the accuracy of our results. They may provide insight into the role of 3 0 /5 0 AS in these pathways.
Conclusion and discussionWe propose an empirical Bayes change-point model to identify 3 0 /5 0 AS events. Simulation studies and real data application have demonstrated that our method is powerful, accurate and efficient for analyzing the next-generation RNA sequencing data. Compared with previous methods, our approach does not rely on annotation information. Instead, it provides for the first time a systematic framework to characterize coverage change while being capable of integrating other information, in particular the junction read information which is very helpful for detecting 3 0 /5 0 AS events. We utilize an empirical Bayes model to efficiently pool information across genes. Our Negative Binomial-Beta model, which allows the over-dispersion in the real data, could estimate the hyperparameters from data efficiently. This makes our model more powerful compared with frequentist methods, as our model applies Bayesian inference (). Since the hyperparameters are estimated frequentistically from data, it also overcomes the defects of subjective priors of Bayesian methods. We provide a flexible testing framework in which the user can choose to address different levels of questions, namely, whether alternative splicing happens, and/or where it happens. This gives users more flexibility in solving real problems. When exact splice sites are hard to determine, we could choose to only report the exons thatAn empirical Bayes change-point modelcontain alternative splicing. In addition, a Bayesian confidence interval for the splicing point can be constructed based on the posterior probabilities calculated by our method if it is of the user's particular interest. Recent studies have revealed that RNA-seq data sampled from the transcriptome exhibit various biases, including position-specific and sequence-specific biases (). These biases may incur great difficulties in detecting 3 0 /5 0 AS events and cause false positive reports. When applying our model, the user may circumvent this problem by using additional control samples and doing further filtering. For example, an XOR filtering, q case i > 0 XOR q control i > 0, or an even sophisticated filtering jq case i  q control i j > a threshold, may be applied. Our testing and decision procedures allow the user to solve either the detection problem (having or not a change-point) or the identification problem (locating the change-point), but not both simultaneously. The identification problem is more informative as it provides location estimation, but it is also more challenging leading to a lower sensitivity. The detection problem is the converse. To take advantage of both, an idea is to do identification when signal is strong enough and do detection when signal is weak. We are working on this extension within a multiple testing framework and have obtained some promising theoretical results (). It is hard to precisely evaluate the accuracy of the real data analysis results without experimental validation. We use the number of exons detected vs. the number of exons with AceView 'Support' as an implicit indication of the validity of the results. We also conduct GSEA and use the meaningful enriched pathway results as supplementary support to the accuracy of the results. It is noted that both of them are not an experimental validation. We believe that as our tool becomes popular among biologists, a rigorous accuracy validation will be possible and available in the near future. We assume either one or no alternative 3 0 /5 0 splice sites, represented as the alternative model (M 1 ) and the null model (M 0 ), respectively. It is noted that there can be more than one alternative 3 0 /5 0 splice site. In principle, we may extend our model to search for more change-points. To do so, we can replace M 1 (Equation 5) with a more general product partition model M K allowing K changepoints (). Given multiple change-points, M 1 will fit less well but still better than M 0 assuming no changepoints. The null hypothesis (no change-points) we test remains the same. Thus, our testing procedures would remain valid, though not optimal, under some circumstances. Our method may not always be optimal when the signal is subtle. However, we do not expect many such instances. Moreover, if they are interested, the users may manually inspect further those identified genes to see whether there is more than one change-point and where they are. In addition, seeking the optimal model for multiple change-points would impose great computational cost. Computational time is linear to scan for one possible change-point, and becomes factorial when considering multiple change-points. There is also a caveat of over fitting to consider. Because of these implications, the potential gain may not necessarily warrant seeking a perfect model. We would leave this extension for multiple change-points to future work.
0 SS or 5 0 SS. The common regions (constitutive exons), shared by the two isoforms, are expected to have a higher expression level than the extended regions (spliced regions). As a result, for RNA-seq data, we expect that the common regions will have higher short read densities than the extended regions, and the exons with alternative 3 0 SS or 5 0 SS will have change-points at their 3 0 or 5 0 splice sites as illustrated in Figure 1. Thus, we can detect exons with alternative 3 0 SS and 5 0 SS and their splice sites by detecting the change-points where the short read densities change. We model exon i with length L i as a sequence of observations S i  x i1 ; x i2 ;. .. ; x iLi  ordered in position, where x ij is the number of reads (read-count) whose first base mapped to exon i at position j. Following previous change-point models (Barry and Hartigan, 1993; Denison, 2002; Xuan and Murphy, 2007), we assume the change-points divide the sequence of observations into K unknown homogeneous segments, P  P 1 ;. .. ; P K , such that the data is independent across different segments pS i;1:Li jP  Y K k1 pS i;P k : For our alternative 3 0 SS and 5 0 SS problem, we further assume K  1 or 2, namely, expecting there is at most one change-point in an exon read-count sequence. We introduce variable q i 2 f0; 1; 2;. .. ; L i  1g for sequence S i to indicate whether there is a change-point and where the change-point is. Specifically, q i  0 indicates there is no change-point and q i  ss > 0 means that there is a change-point at position s, before which read-counts in S i;1:s  x i1 ;. .. ; x is  follow one homogeneous distribution and after which read-counts in
J.Zhang and Z.Wei at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
0 SS or 5 0 SS, the common region shared by the two isoforms has a higher gene expression level than the extended region. Thus, the average number of short reads (read-count) mapped to the common region will be larger than the one for extended region. This generates a change-point at the splice site, which partitions the whole region into two different homogeneous segments with different average read-counts (Color version of this figure is available at Bioinformatics online.) Fig. 2. Hierarchical structure of Negative Binomial-Beta model
at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
