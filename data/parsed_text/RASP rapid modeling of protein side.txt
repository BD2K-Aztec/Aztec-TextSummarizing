Motivation: Modeling of side chain conformations constitutes an indispensable effort in protein structure modeling, protein–protein docking and protein design. Thanks to an intensive attention to this field, many of the existing programs can achieve reasonably good and comparable prediction accuracy. Moreover, in our previous work on CIS-RR, we argued that the prediction with few atomic clashes can complement the current existing methods for subsequent analysis and refinement of protein structures. However, these recent efforts to enhance the quality of predicted side chains have been accompanied by a significant increase of computational cost. Results: In this study, by mainly focusing on improving the speed of side chain conformation prediction, we present a RApid Side-chain Predictor, called RASP. To achieve a much faster speed with a comparable accuracy to the best existing methods, we not only employ the clash elimination strategy of CIS-RR, but also carefully optimize energy terms and integrate different search algorithms. In comprehensive benchmark testings, RASP is over one order of magnitude faster (∼40 times over CIS-RR) than the recently developed methods, while achieving comparable or even better accuracy. Availability: RASP is available to non-commercial users at our website
INTRODUCTIONProtein side chain conformation prediction or side chain packing is a crucial step in both protein design () and protein structure modeling (). As such, during the last two decades, many efforts have been dedicated to the prediction of protein side chain conformations, leading to the development of many side chain packing programs (). In general, these side chain packing programs formulate the side chain conformation prediction problem as a combinatorial search problem based on discrete side * To whom correspondence should be addressed. chain conformations, called rotamers. The problem usually involves three key elements, summarized as follows:(i) A rotamer library of discrete side chain conformations (;). Although some approaches attempted to model the continuous side chain conformations (), most of the current methods rely on discrete rotamers, which can significantly reduce computational expense ().(ii) An energy function for rotamer selection. A number of energy functions for side chain packing have been proposed, ranging from simple van de Waals potential () to more complicated potentials by incorporating hydrogen bonding term (), solvation term () and statistical orientation term () to improve the prediction accuracy.(iii) A search algorithm. The use of rotamer library leads to the formulation of the side chain packing problem as a combinatorial problem, which finds the best solution from all the possible combinations constrained by side chain rotamers. Many search algorithms have been proposed to solve the combinatorial problem, including dead-end elimination (DEE) (), simulated annealing (), Monte Carlo (), A* (), integer programming (), self-consistent mean field () and graph theory-based approach (). The combining of these search algorithms is critical in side chain prediction. For example, to achieve a fast speed, SCWRL4 () and SCATD () combine DEE, branch-and-bound and tree-decomposition search.As summarized above, the appropriate consideration of the above three elements is critical in developing rotamer-based side chain packing programs. Thanks to the intensive previous efforts, the prediction of side chain conformations has become more and more accurate. However, the improvement of accuracy usually comes with the increase of computational time. For example, although the recently developed side chain packing program SCRWL4 from Dunbrack's laboratory and the program CIS-RR developed in our laboratory () have an improvement of 3% in  accuracy over SCRWL3, their speed is over 6 times slower than SCRWL3, indicating the challenge in achieving both high accuracy and high speed in the prediction of protein side chain conformations. In this study, by carefully considering the key elements summarizedPage: 3118 31173122
Z.Miao et al.above, we present a RApid Side-chain Predictor, called RASP, which builds the protein side chains over one order of magnitude faster than the best existing ones while achieving comparable accuracy.
METHODSSimilar to CIS-RR, RASP uses clash detection-guided side chain optimization to alleviate atomic clashes caused by rigid rotamer approximation. But unlike CIS-RR which couples the elimination of atomic clashes with the process of side chain packing in an iterative search, RASP efficiently eliminates atomic clashes after the generation of a highquality structure. Therefore, in RASP, we focus on (i) rapid generation of high-quality initial structures by carefully considering the key elements of rotamer-based side chain packing algorithms, which is described in Section 2.1 and (ii) rapid elimination of atomic clashes by relaxing those residues in clashes, which is described in Section 2.2.
Rapid prediction of side chain conformations with high accuracy
Rotamer buildingRotamer dihedrals along with their probabilities are read from a binary-formatted backbone-dependent rotamer library () in order from highest to lowest probability until the cumulative probability reaches 98%. Then, the coordinates of all side chain atoms are built according to rotamer dihedrals () using standard side chain topology ().
Energy calculationAssuming that the rotamer r i is one of the all possible rotamers of residue i, the total energy of a protein system of N residues is expressed as:The side chain packing problem is a combinatorial problem, which finds the set of r i (i = 1,..., N) that gives the lowest E total over all possible rotamers of a residue. Rotamer probability term, E lib (r i ), takes the same form as the one used in SCWRL4 ():Given backbone dihedrals ( and ), this term expresses the relative probability of a rotamer r i to the highest probability rotamer r max. Scaling factor w aa is residue-type dependent (Supplementary). Besides, three other energy terms are used to characterize the interactions between atoms (both E bbsc and E scsc ): van de Waals potential, disulfide term and hydrogen bonding term:The van de Waals potential, E vdw , is adapted from the one used in OPUS-PSP (), which is formulated as follows:where e ij =  e i e j , and e i , e j are well-depths from charmm19 (). d = d ij /R ij , d ij is distance between atoms i and j. R ij is summation of atomic radii (Supplementary) of the two atoms i and j. 1.63 and 0.99 are scaling factors to express the difference between repulsive and. Hydrogen bonds between hydroxyl and carboxyl. B is the Base of the hydrogen donor (base of hydroxyl) and D is the hydrogen donor (O atom in hydroxyl). O is hydrogen acceptor (O atom in carboxyl) and C is its base C atom in carboxyl.  is the angle between hydrogen acceptor, hydrogen donor and base of the hydrogen donor;  is the angle between hydrogen donor, hydrogen acceptor and base of the hydrogen acceptor. attractive effect. For the repulsive term, it is capped at a maximum value of 50e ij to alleviate fixed rotamer approximation. The disulfide term, E SS , is a simplified version of the one used in SCWRL3 ():The description of the term is illustrated in. This term is calculated only if the distance between an O atom in the carboxyl and the O atom in the hydroxyl is <3.2 . Since no explicit hydrogen atom coordinates are needed in this term, its calculation is relatively very fast. In order to efficiently compute the interacting energies between residues within a protein system, we only consider the pairs of residues that have effective contact. A pair of residues are assumed to have effective contact if the C atom of one side chain falls within a region of a hemi-sphere centered at the C atom of another side chain (illustration of side chain in effective contact see):is the distance between the two C atoms, r i , r j are radii of side chain hemisphere of residue i and j, respectively. To prevent a side chain from severely colliding with backbone atoms, one rotamer is excluded when its backbone energy [E bbsc , second term in Equation (1)] is 8.0 U higher than any other rotamers of the same residue.
Combinatorial searchTo achieve a fast and convergent search, we employed a combination of DEE algorithm (), graph theory-based search (), branch-and-terminate search (), Monte Carlo search () and backtrack algorithm (). The DEE and graph-theory based search were used by following a similar procedure used in SCWRL3 (): a simple Goldstein DEE algorithm () was first used to reduce the combinatorial space, and then an interaction graph was constructed and further divided into bi-connected components that can be solved by branch-and-terminate search strategy. To speed up the search process, we made two modifications described as follows:(i) In our graph theory-based search, the graph was constructed by connecting the residue pairs whose energy difference between any). As seen from Supplementary, a residue with longer side chain has longer radius of hemisphere, derived from the training set (the longest distance from a side chain atom to the C atom of the side chain is taken as radius of the hemisphere). (B) Case of residue pairs in effective contact or not in effective contact. Residue A and C form a pair in effective contact when d is shorter than 5 , A and B do not have effective contact. rotamer combinations of the residue pair is bigger than a threshold of 3 kcal/mol:This is because of the introduction of attractive terms in RASP. In SCWRL3, only the rotamer pairs that have repulsive effects are considered to form 'edges' in the graph. While in RASP, we considered edges for the rotamer pairs having either repulsive effects or attractive effects. However, the introduction of attractive term led to more 'edges' (residue pairs in contact) in the graph, and making the graph more complicated and difficult to solve. (ii) Therefore, to effectively solve the bi-connected components, we used two strategies. For the bi-connected components with a combination number over 10 15 , a simulated annealing Monte Carlo is carried out. Otherwise, the branch-and-terminate search strategy is performed (). The MC search starts from a structure with all residues using the rotamer of the lowest self energy. The acceptance probability of a new rotamer n to replace an old rotamer o, denoted as p(o  n), is calculated as follows:First, rotamers with low acceptance probability (p(o  n) < exp(10)) are eliminated. Then, it performs 100 rounds of standard Monte Carlo search with a gradual temperature decrease from 2 to 0.02 U followed by three rounds of greedy search.
Clash detection-guided rotamer relaxationAs defined in CIS-RR, two atoms are deemed to collide when the distance between them is <60% the sum of their van der Waals radii. Residues with no clashes are kept intact, others are relaxed using the CIS-RR () approach.
Training and evaluation
Training and parameterizationThe training and testing dataset were obtained from PISCES server () with resolution 1.8 , R-factor <25% and mutual sequence identity <25% (Supplementarywere first optimized over the training set. Then the other terms were optimized one by one using a greedy algorithm.
EvaluationTwo different test sets are used for evaluation of RASP and other programs. One test set consists of 2412 protein structures described above (see Section 2.3.1 and Supplementary). This is a very comprehensive test set, which contains 437 393 residues, namely at least 6700 counts per residue type. The other is taken from SCWRL4 (), thus called SCRWRL4 test set, which consists of 379 structures (58 231 residues in total). RASP and some other programs are evaluated on the above two test sets using their respective default settings. We use two criteria to assess the side chain packing accuracy. One is percent correct of  1 and  1+2. If the dihedrals  1 and  2 of a modeled side chain are within 40those40those of the native side chain conformation, they can be regarded to be correct (). The other is side chain atom root mean square deviation (RMSD), which is computed as follows:d is the distance between a native coordinate and the predicted one. N is the total atom number. As defined in CIS-RR (), two atoms are assumed to be in clash if the distance between them is <60% of the sum of their van de Waals radii taken from Rosetta program (), and the performance of elimination of atomic clashes is quantified based on the number of atom pairs in clash.
Implementation and software availabilityRASP was implemented in object-oriented C++, compiled using gcc version 4 with-O3 option. It has been tested on five versions of linux platforms. For fast computation, the pair-wise energies are stored in a 4D array for quick indexing. The evaluation of the program was carried out on Intel Q9550 processor. The binary executable program is freely available to nonprofit research via http://jianglab.ibp.ac.cn/lims/rasp/rasp. All datasets are available at the same web. Commercial users should contact the investigator for consent.
RESULTS
RASP has a comparable prediction accuracy but is much faster than CIS-RRTo evaluate the performance of RASP by comparing to CIS-RR, the two programs were tested on a comprehensive test set consisting of 2412 high-resolution X-ray structures (see Section 2.3). The test showed that both programs have very close performance in prediction accuracy: 86.02% for RASP versus 85.49% for CISRR for the percent correct of  1 and 75.92% for RASP versus 75.68% for CIS-RR for the percent correct of  1+2. Both programs also have similar prediction performance for different residue types (Supplementary, Tables S6 and S7). Moreover, both programs can effectively eliminate atomic clashes. There exists one pair of atoms in clash in about 4 (2412 proteins/642 clashes) protein structures modeled by CIS-RR and only in about 5 (2412 proteins/495 clashes) protein structures modeled by RASP. However, RASP is much faster (40 times) than CIS-RR.RASP finished the prediction of all 2412 protein structures within 16 min of CPU time, namely <0.4 s per proteinWhile CIS-RR spent 601 min on the 2412 protein structures.
Z.Miao et al.
Comparison of RASP with other popular side chain modeling programsWe further compared RASP with some recently developed programs, including CIS-RR (), SCWRL4 (), OPUS-Rota () and IRECS (), on the SCWRL4 test set. As shown in, for prediction accuracy in terms of percent correct for  1 and  1+2 and RMSD, RASP is comparable to the recently developed side chain programs (detailed data can be found in Supplementary). While for speed, RASP is relatively much faster, being 14 times faster than OPUS-Rota, 18 times faster than SCWRL4 and 40 times faster than CIS-RR. Moreover, it generates fewer clashes than CIS-RR, SCWRL4 and OPUS-Rota do. We further investigated the distribution of prediction time by RASP, CIS-RR, SCWRL3 and SCWRL4 on the SCWRL4 test set.shows that RASP completed the predictions within 1 s for nearly all proteins (370 out of the 379 proteins in the SCWRL4 test set), showing significant advantage in speed over the other three programs.
DISCUSSIONDetermination of side chain conformations on a fixed protein backbone plays an important role in protein structure prediction, protein design and molecular docking. In hitherto, many methods have been developed to predict protein side chain conformations (). Although the prediction has become more and more accurate, the gradual improvement of accuracy usually comes with the dramatic increase of computational cost. In this study, in order to improve speed without at expense of prediction accuracy, we have developed a more powerful program, called RASP. The tests showed that RASP achieves high prediction accuracy comparable to the best existing methods, but is much faster.The good performance of RASP lies in its elegant integration of the strategies used in the existing approaches, which is contributed by three critical points discussed as follows: One is the design of energy function to achieve both high accuracy and high speed. Previous studies have indicated that van der Waals potential alone is able to achieve a high accuracy in prediction of side chain conformations (), suggesting the dominant role it plays in side chain packing. Although the incorporation of other energy terms could improve the accuracy of side chain packing, the consideration of complicated energy terms would aggravate the computational expenses. Therefore, in developing an effective energy function for side chain packing, all the individual energy terms were carefully implemented for fast speed and high accuracy. To calculate van der Waals potential, the hydrogen atoms were not represented explicitly and their effects, through parameterization, could be captured in the heavy atoms that are linked to hydrogen atoms (Supplementary). As shown in Supplementary Table S2, among the heavy atoms of the same type, the ones with more hydrogen links have longer van de Waals radii. For simplicity and fast computation, the effect of dihedral CC SS is omitted in the disulfide term, and the hydrogen bonding term only depends on the orientation between the hydrogen donor and hydrogen acceptor. The careful consideration of these energy terms led us to develop an effective energy function for side chain packing. As demonstrated by our testing described above, RASP is not only much faster than CIS-RR, but also is slightly better than CIS-RR (with 0.2% improvement in both  1 and  1+2 accuracy) (Supplementary Table S6 and S7). The second is the use of clash detection-guided rotamer relaxation after side chain packing process. Further elimination of the atomic clashes in protein structures with modeled side chains can lead to more harmonic structures. Our recently developed CIS-RR coupled side chain packing process with the elimination of atomic clashes by using clash detection-guided iterative search in rotamer relaxation. Although in CIS-RR both the accuracy of side chain packing and removal of atomic clashes can be achieved, it is time consuming. In RASP, we uncoupled the side chain packing process and atomic clash elimination process. The rotamer relaxation was performed on the side chains that are involved in atomic clashes. By doing this, we found that rotamer relaxation process in RASP can effectivelyeliminate the atomic clashes without incurring the computation time significantly (, Supplementary). Moreover, the elimination of atomic clashes has led to a slight increase of prediction accuracy. The SCWRL4 test set was used for the evaluation. Total time for the prediction is evaluated. Clashes are those residue pairs whose distance is <60% the summation of their van de Waals radii.  dihedrals within 40 @BULLET are considered correct. The third is the implementation of effective search algorithms. To achieve a fast and convergent search, we designed a combinatorial search strategy involving graph theory-based approach which decomposed the graph of contact residue pairs to bi-connected components (see Section 2). For a bi-connected component of N residues, its time complexity is  O(m N ) (m is the average rotamer number in a residue) for an exhaustive search like branchand-terminate approach, while for Monte Carlo search the time complexity is O(mN). Therefore, in design of search algorithms, we used MC search instead of the exhaustive branch-and-terminate search for a large bi-connected component with over 20 residues. Indeed, we found use of MC search can significantly reduce the computation time for large proteins. Supplementarycompares the performance of RASP using MC or not on SCWRL4 test set. As can be seen from Supplementary Table S9, although the improvement by adding MC is general to nearly all proteins, it varies significantly for different proteins. Especially, for those proteins that tend to form highly connected graphs (often occurring in large proteins of over 300 residues), MC contributes significantly to the speed improvement. Taken together, RASP not only combines the advantages of the existing programs in both prediction accuracy and clash elimination, but also achieves a much faster speed. We believe RASP would be a very useful tool for fast side chain modeling that can complement the current existing methods in a wide range of applications.
The Author 2011. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oup.com
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
