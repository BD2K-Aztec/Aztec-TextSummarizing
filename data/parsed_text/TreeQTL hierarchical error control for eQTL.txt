Commonly used multiplicity adjustments fail to control the error rate for reported findings in many expression quantitative trait loci (eQTL) studies. TreeQTL implements a hierarchical multiple testing procedure which allows control of appropriate error rates defined relative to a grouping of the eQTL hypotheses. Availability and Implementation: The R package TreeQTL is available for download at
IntroductionThe goal of eQTL analysis is to gain insight into the genetic regulation of gene expression. Typically, this is carried out by testing a vast collection of hypotheses H vg probing association between the genotype at variant v and the measured expression for gene g, where v  1;. .. ; M; g  1;. .. ; G, M is on the order of hundreds of thousands, and G of tens of thousands. Given the large number of hypotheses tested, the need to adjust for multiplicity is universally recognized and the false discovery rate (FDR) () is typically adopted as the target global error rate. In an effort to improve interpretability, reporting of results is typically organized along more general findings such as the discovery of genes subject to local regulation (eGenes) () or regulatory SNPs (eSNPs) (). The adopted strategy for multiplicity adjustment needs then to offer guarantees on these reported 'global' discoveries. For example, imagine testing the H vg hypotheses using the BH rule () and defining as an eSNP those variants v for which H vg is rejected for at least some gene g. While this would control the FDR among the H vg rejections, it would not control any measure of global error for the discovery of eSNPs, as shown by the simulations inResearchers in the eQTL field have recognized this challenge, and have additionally noted that since local regulation is more common than distal (), hypotheses probing these two mechanisms should be tested separately. However, there is no single standard in the literature for error rates targeted or error-controlling strategies: for example, one finds the notion of pergene error rates () or the application of Bonferroni across genes () in local regulation, while for distal effects significance cut-offs vary from 5  10 8 () to 5.78  10 12 (). This makes comparison across studies and replicability challenging.
ApproachTo overcome the confusion generated by the plurality of approaches and to provide guarantees relative to the discoveries reported, it is useful to recognize the structure among the hypotheses tested in an eQTL study and to introduce some terminology. We distinguish between hypotheses testing local (when the distance between variant v and gene g is less than a threshold) and distal regulation, indicating them with L vg and D vg , respectively. Further, we recognize that we might be interested mainly in identifying which genes appear to have local (distal) regulation prior to V C The Author 2016. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com obtaining a detailed list of the variants involved in this regulation; or we might want to pinpoint SNPs that appear to have local (distal) effects on multiple genes, even without committing to a comprehensive list of these genes. We use the term 'local eGene' to signify a gene whose expression is influenced by some local DNA variants and 'local eSNP' to designate a specific SNP associated to variability in expression for some local genes. With 'local eAssociation' we signify the local association between one specific SNP and one specific gene. For distal regulation, 'distal eGene', 'distal eSNP' and 'distal eAssociation' are similarly defined. These terms can be mapped back to the original collection of hypotheses noting, for example, that discovering a distal eSNP is equivalent to rejecting the intersection hypothesis D v@BULLET  \ g D vg , that is, the null stating that SNP v has no effect on any distal gene g. To control global error rates defined in terms of the reported discoveries (local eSNPs, local eAssociations, etc.), we have implemented in TreeQTL a multi-resolution approach based on results in Benjamini and Bogomolov (2014) whose practical effectiveness in GWAS has been described in. Furthermore, TreeQTL has the potential to increase power: by focusing on the promising SNPs with possibly higher proportions of true eAssociations, one capitalizes on the adaptivity of FDR.
MethodsTreeQTL is a hierarchical testing procedure that distinguishes two levels of discoveries within each class of local or distal regulation. In Level 1, users can specify their primary interest as the identification of either eGenes or eSNPs. Given this choice, all the pair-wise association hypotheses are given a position in a tree similar to that shown in: each eGene or eSNP hypothesis indexes the collection of simple hypotheses by whose intersection it is defined. Level 1 hypotheses are tested controlling for global errors within the two regulation classes. The more granular eAssociation hypotheses in Level 2 are tested only when they correspond to a global hypothesis rejected in Level 1. TreeQTL takes as input the P-values for each hypothesis in Level 2: these may be computed via Matrix eQTL () and their validity is of crucial importance. Regardless of how the P-values were obtained, the input file for TreeQTL should follow the format used by Matrix eQTL, i.e. a tab-delimited file with columns SNP, gene, beta, t-stat, p-value and FDR (note that the fields beta, t-stat and FDR can be empty). The P-values for the Level 1 hypotheses are computed using Simes' rule () on the families they index. This summary of the evidence for the global null hypotheses is relatively robust to dependence (). Users can, however, input alternative P-values for Level 1, such as those obtained via permutation. Testing proceeds from Level 1, where three options are available: controlling FDR at level q 1 using BH or BY () or controlling the family-wise error rate via Bonferroni. In Level 2, significance is established using a modified BH within each set of eAssociation hypotheses corresponding to an eSNP or eGene identified at Level 1, using a more stringent target FDR to account for selection. The expected average proportion of false discoveries across the selected Level 2 families is controlled to the userspecified target level q 2. (See Supplementary Material).
Example applicationPurely to demonstrate feasibility, we applied TreeQTL to wholeblood data from the pilot phase of the
Bioinformatics, 32(16), 2016, 25562558 doi: 10.1093/bioinformatics/btw198 Advance Access Publication Date: 19 April 2016 Applications Note at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
million local tests (reflecting an average of 21 genes in the local region for each SNP) and 205 billion distal tests. Following the steps in Ardlie et al. (2015), P-values were obtained by applying Matrix eQTL to normalized gene expression, adjusting for both known and unknown technical covariates by the inclusion of gender, 3 genotype principal components and 15 PEER factors. In applying TreeQTL, we identified eSNPs as the discovery of interest in Level 1, choose the BH procedure in level 1 and set q 1  q 2  0.01. This led to the discovery of 136 609 local eSNPs (with 229 821 local eAssociations) and 164 860 distal eSNPs (with 216 933 distal eAssociations). This analysis required around 2 h in R version 3.1.0 to complete. Note that because of linkage disequilibrium, the number of eSNPs (and eAssociation) discoveries is likely much larger than the number of true causal variants. A discussion of this point as well as an indicative comparison with the analysis of these data published in Ardlie et al. (2015) is included in the Supplementary Material. 5 Conclusion By analyzing local and distal regulation separately, TreeQTL has less stringent cut-offs for tests probing local effects, where it is expected that a larger number of hypotheses will be non-null. By grouping hypotheses relative to the same SNP or the same gene, TreeQTL capitalizes on the inherent heterogeneity of the problem. For example, while few SNPs will act as distal regulators of expression and might influence multiple genes, the vast majority of SNPs will not have such an effect: testing all the eAssociation hypotheses relative to one SNP together, separately from those concerning other loci, increases the discovery of eSNPs with many associations, which may play a true regulatory role, and reduces the discovery of SNPs with few associations, which are more likely to correspond to false positives. Finally, the hierarchical structure of TreeQTL assures control of the FDR for eSNP and eGene discoveries. While the current version of TreeQTL implements methodology relative to studies involving only one tissue, future releases will incorporate approaches for the more complex structure of multi-tissue investigations.
at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
C.B.Peterson et al. at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
