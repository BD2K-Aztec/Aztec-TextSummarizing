We propose a likelihood ratio test (LRT) with Bartlett correction in order to identify Granger causality between sets of time series gene expression data. The performance of the proposed test is compared to a previously published bootstrap-based approach. LRT is shown to be significantly faster and statistically powerful even within non-Normal distributions. An R package named gGranger containing an implementation for both Granger causality identification tests is also provided.
INTRODUCTIONTemporal association between genes in time series expression data can be studied through the identification of Granger causality (). Granger causality in time series data was mathematically formalized byand later implemented to a multivariate framework by, allowing the identification of conditional relationships. Recently,proposed the application of Granger causality to identify relationships between sets of genes, i.e. to identify if a set containing n genes Granger causes another set with m genes. Their main goal is to create networks representing pathway-level connections that could help the understanding of molecular mechanisms underlying biological processes. In the above-mentioned work, the authors propose a bootstrap procedure to test and identify Granger causality. Despite the usefulness of the bootstrap method to identify/test Granger causality, it * To whom correspondence should be addressed. is computationally intensive, becoming particularly slow when accurate P-values are required. To overcome this drawback, here we propose an analytical approach based on likelihood ratio test (LRT). For time series experiments containing less than 100 points, we also propose a Bartlett correction in order to improve the asymptotic approximation of the statistics. Two simulations were carried out in order to evaluate the performance of the proposed LRT with Bartlett correction-based test. First, since the Granger causality between sets of gene expression time series data is a generalization of the multivariate version proposed by, it is necessary to know if the proposed LRT is as good as the classic Wald's test in terms of statistical power in a multivariate context by using the vector autoregressive (VAR) model (Simulation 1). The second simulation consists in comparing the performance of the proposed test with the previously published bootstrap-based method () in a context where one would like to identify Granger causality between sets of time series data. The results show that: (i) the LRT is equivalent to Wald's test in the multivariate model in terms of statistical power; (ii) the LRT is much faster and has a higher statistical power than the bootstrap method (when analyzing sets of time series data); and (iii) both the LRT and bootstrap can control the rate of false positives even under non-Normal noises. An R package named gGranger containing the identification method for Granger causalities, the bootstrap procedure and the LRT with Bartlett correction is provided.):
METHODS
Granger causality for sets of time serieswhere CCA is the canonical correlation analysis.Page: 2350 23492351
A.Fujita et al.
LRT= 0 (Granger causality) for the following statistics:is the block matrix of the unbiased estimator of (). For large T , the statistic test is approximately distributed as a  2 random variable. For relatively small T , we suggest the use of Bartlett correction (). Timm andshowed that the Bartlett correction under our problem arises by replacing the multiplicative factor T 1(k n) in the likelihood ratio statistic with the factor r = T 2(k n) 1 2 (m+n+1) to improve the  2 approximation to the sampling distribution of 2ln. Thus, we reject H 0 at significance level  ifwhere  2 mn () is the upper (100)th percentile of a  2 distribution with mn degrees of freedom.
Experimental set-upTwo simulations were carried out in order to evaluate the performance of the proposed LRT with Bartlett correction.
Simulation 1Multivariate model Descriptionof the comparison between the proposed approach and the multivariate VAR model with Wald's test in the case where n = 9 time series (predictors) Granger cause m = 1 time series (target) (Supplementary).,...,9). The time series length is set to 75, i.e. T = 75.
Simulation 2Modulemodule modelComparison between the proposed LRT and the bootstrap-based test proposed by. The structure of the artificial network is similar to Simulation 1 described in, where the Granger causality from one gene set to another gene set is tested (Supplementary). To evaluate the robustness of LRT under different noise distributions, gene time series are generated with residues following both Normal and non-Normal distributions (Exponential, Uniform, Gamma, half-Normal and t-Student). The time series length is set to T = 75.
RESULTS AND DISCUSSIONSTo evaluate the performance of the proposed likelihood ratio-based test to identify Granger causality in both a multivariate condition and between sets of time series data, two simulations were carried out (see Section 2.3).and Wald's test are equivalent in the multivariate model (the solid and dashed lines coincide), and the LRT performs better than the bootstrap procedure in terms of statistical power in the module module model (the solid line is above the dashed line). The fact that the LRT and Wald's test are equivalent in the multivariate model is an expected result since the identification of Granger causality between sets of genes in time series experiments is a generalization of the multivariate Granger causality proposed by Geweke (1984).and d illustrate the P-value distributions under the null hypothesis obtained by running 10 000 times Simulations 1 and 2, respectively, with Normal residues. Notice that the rate of false positives is effectively controlled since the histograms are close to Uniform distributions. Simulation 2 was also performed with residues following non-Normal distributions namely,half-Normal and (v) t-Student in order to evaluate the robustness of the tests. LRT was able to control the rate of false positives in the majority of the non-Normal residues even when the residues followed t-Student distribution with three degrees of freedom (i.e. time series with outliers due to heavy tails in the t-Student distribution if compared to Normal distribution). In the case of noise following multivariate t-Student distribution (when there are outliers and time series are contemporaneously correlated), the Type I error was controlled but not as well when compared to the simulations performed with other noise distributions. In the multinormal distribution case (contemporaneously correlated time series without outliers), both bootstrap and LRT controlled the rate of false positives (refer to Supplementary Section 'Simulation 2 with different noise distribution' for more information about P-values' distributions and ROC curves in these simulations). To verify how Type I error is controlled in actual biological data when noise distribution is unknown, we used the dataset of genes originally published byand used to construct networks in. The points of the time series were permuted to eliminate any presence of Granger causality. LRT was Page: 2351 23492351applied to this permuted time series and the process was re-done 10 000 times. The results (Supplementary Section 'Verifying the control of Type I error in actual biological data') show P-values histograms close to Uniform distributions under the null hypothesis, confirming that even in real biological data, LRT is able to control the rate of false positives. In addition, the method we propose here was applied to the same dataset () in order to exemplify its application in the context of microarray data interpretation (Supplementary Section 'Application to biological data'). For comparative purposes, the processing times of both the LRT and the bootstrap test were measured by running 1000 times Simulation 2.shows that as the number of bootstrap samples increases in order to improve the P-value estimation, it becomes slower than the LRT. A fast statistical test such as the proposed LRT is of extreme importance nowadays due to the enormous amount of data generated by microarray experiments and, consequently, the increasing number of hypothesis to be tested. Bonferroni or FDR correction are usually used for multiple tests correction and when using bootstrap approaches, more accurate P-values must be calculated by increasing the number of bootstrap samples. In summary, the advantages of the LRT with Bartlett correction over the bootstrap approach are: (i) the statistical power of the LRT is greater than the bootstrap procedure; (ii) the LRT can control the rate of false positives on both Normal and even in non-Normal (Exponential, Uniform, Gamma, half-Normal and t-Student) residues; and (iii) the LRT is much faster than the bootstrap test. As a final consideration, despite the advantages presented for LRT, we recommend the use of the bootstrap procedure, which is non-parametric, if one cannot guarantee that the residues follow one of the studied distributions.
Testing Granger causality between sets of genes
The Author 2010. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oxfordjournals.org 2349 at :: on August 31, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
at :: on August 31, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
