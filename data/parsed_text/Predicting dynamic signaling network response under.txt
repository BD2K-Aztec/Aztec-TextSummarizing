Motivation: Predicting trajectories of signaling networks under complex perturbations is one of the most valuable, but challenging, tasks in systems biology. Signaling networks are involved in most of the biological pathways, and modeling their dynamics has wide applications including drug design and treatment outcome prediction. Results: In this paper, we report a novel model for predicting the cell type-specific time course response of signaling proteins under unseen perturbations. This algorithm achieved the top performance in the 2013 8th Dialogue for Reverse Engineering Assessments and Methods (DREAM 8) subchallenge: time course prediction in breast cancer cell lines. We formulate the trajectory prediction problem into a standard regularization problem; the solution becomes solving this discrete ill-posed problem. This algorithm includes three steps: denoising, estimating regression coefficients and modeling trajectories under unseen perturbations. We further validated the accuracy of this method against simulation and experimental data. Furthermore, this method reduces computational time by magnitudes compared to state-of-the-art methods, allowing genome-wide modeling of signaling pathways and time course trajectories to be carried out in a practical time. Availability and implementation: Source code is available at
INTRODUCTIONProtein signaling networks, especially those involving phosphoproteins, play a critical role in diverse cellular functions and are related to almost all pathways (). Understanding these networks under defined perturbations, e.g. inhibitions or stimulations on certain gene(s), has wide applications in many medical fields, especially cancers, which are heterogeneous in their genetics (). Experimental methods that quantify the dynamics of the signaling phosphoproteins tend to be expensive and timeconsuming, making them unaffordable to be extended to the genome scale and tested under a large number of perturbations. Mass spectrometry-based methods are now the major approach used to quantify dynamic changes in phosphoproteins, i.e. trajectories of these proteins over time (). They are vitally important for inferring signaling networks, drug responses and treatment outcome (di). Knockdown coupled with phosphoproteomics can help determine the causal relationships between signaling elements (). However, these experiments are labor-intensive and unlikely to be carried out for a large number of perturbations or a large number of knockdown genes. Thus, computational modeling becomes vitally important for predicting time course signaling network dynamics under unseen situations. Generally, cell line-specific signaling network dynamics under several known perturbations are observed. The observed data are time course data describing phosphorylation levels of phosphoproteins at different time points and under several different perturbations. The task is to predict time course responses if new drugs/perturbations come in (with the knowledge of their targeted proteins). Thus, given phosphorylation-level data E px k t for a group of proteins (k in 1 to N) sampled at a series of time points under perturbations p 1 ; p 2 ;. .. , we are interested in the phosphorylation levels E pnew k t for the same group of proteins under a new, unobserved perturbation p new for the same time course. Computationally predicting the response of signaling networks under unseen perturbations remains a challenging task. First, current models for reconstructing directional signaling networks tend to be time-consuming (), preventing them to be applied to the genome scale. The algorithms that are capable of reconstructing directional networks are usually designed to search the prohibitively large space of all possible network structures through temporal models. This basic approach renders the problem to be insolvable at the genome scale, even they are explored using an efficient probabilistic algorithm. For example,) recently proposed belief propagation (BP)-based searching method, which is three orders of magnitude faster than previous standard Monte Carlo methods used in this field, but still requires minutes to solve a network with 40 proteins. However, the *To whom correspondence should be addressed. human genome contains about 500 protein kinases and an estimated 6000 proteins modified by kinases (). Because the time required to reconstruct the network is exponentially growing with the number of proteins, these methods are impossible to be applied to the genome of a typical mammalian species. Second, the performance of most established algorithms is not satisfactory. As quoted from the DREAM 3 report (), 'Overall, a handful of best-performer teams were identified, while a majority of teams made predictions that were equivalent to random.' DREAM 3 challenges focused on the same topic of the most recent DREAM 8: signaling cascade identification and signaling response prediction. It is indeed repeatedly observed from community blind assessments that the actual performance of most submitted algorithms are not far from random guesses (). Thus, a more accurate mathematical model different from what has already been established must be sought. Last but not least, even if these networks can be established at a smaller scale, it is still challenging to use these networks to accurately predict trajectories for a time course under unseen situations. Most of the previous endeavors have focused on inferring the network structures, but not predicting its changes over time. Thus, we developed a novel mathematical model to solve the above challenges in signaling network modeling. We formulate the network inference problem into a standard-form regularization problem, and the solution to this discrete ill-posed problem was found using truncated singular value decomposition (TSVD). This new method developed here has four advantages: (i) Highly accurate: In the 2013 DREAM 8 subchallenge: time course predictions, this algorithm was the top performing one when tested on experimental data; it also achieved the top performance in aggregated experimental and in silico results. Furthermore, it was identified as the most consistent performer, defined as robustly ranked first when evaluated with a subset of data. (ii) Highly computationally efficient: Both the network inference and the trajectory prediction steps of this algorithm take linear time to the number of proteins, which allow us to achieve magnitudes of improvement in speed over previous methods, making its application to the genome scale possible. (iii) Capable of de novo prediction: This algorithm is capable of inferring network structures and predicting trajectories without any prior knowledge of signaling interactions. (iv) Able to incorporate unseen perturbations: By manipulating the solution to the regularization problem (the regression coefficient matrix), the levels of phosphoproteins under unseen perturbations can be predicted.
METHODSIn this study, we developed an algorithm for reconstructing signaling networks through formulating the problem into a standard regularization problem and estimating its solution with TSVD. The algorithm then predicts the trajectory of phosphoproteins under new inhibitors by manipulating the regression coefficients of the networks. This trajectory predication method contains four steps (): (i) Collect time course phosphorylation data under several separate perturbations. (ii) Determine the regression coefficient matrix representing the influence level (positive and negative) of protein i on protein j. (iii) Estimate the starting phosphorylation levels of the proteins under unseen perturbations. (iv) Iteratively predict the phosphorylation level across a time course under new inhibitors.
AssumptionWe make the first-order Markov and stationary assumption (): every variable at a given time point t i only depends on the variables at the previous time point t i-1. Furthermore, we assume that the value of a variable remains stable without the influence from any other variables (including self-regulation). Equation 1 is the foundation of our method:Where E k t i  represents the phosphorylation value for protein k at the i th time point, R j;k is the regression coefficient indicating how much protein j will affect protein k. N is the number of proteins and " is the error caused by uncontrollable factors such as measurement errors.
Inferring matrix RCombining Equation 1 for all proteins, all time points and all inhibitors, we can form the following equation:R 1;2 R 2;2 ::: R N;2 ::: ::: ::: :::::: ::: ::: :::For the convenience of description, we assign an abbreviation for each matrix in Equation 2:Where each element in T is the observed phosphorylation value for a phosphoprotein at a given time point, whereas the corresponding element in T + is the observed value for the same protein at the next time point. Both T and T + are obtained from the observed time course data and R is the unknown regression coefficient matrix we are interested in. The problem can be solved by:R=T +  TT 1 4 T-1 in Equation 4 is the pseudo-inverse of matrix T. There are numerous pseudo-inverse methods, such as singular value decomposition (SVD) (), QR method, L1-regulation and L2-regulation. To handle the noise " in Equation 1, we used truncated SVD (), a variant of SVD, which has been shown to have nice properties in denoising the data in other domains of application (). Truncated SVD (TSVD) allows us to reduce the effect of noise and calculate the pseudo-inverse matrix. In TSVD, the first step is to decompose the observed phosphorylation matrix into:Where U and V are unitary matrices, V T is the transpose matrix of V and P is diagonal matrix. A convention is to order the diagonal matrix P in a decreasing order and the diagonal entries of P are known as the singular values of original matrix T. Elements on the diagonal matrix P are non-negative real numbers. As there may be zero-value elements on the diagonal matrix S, inverse matrix S 1 does not exist. In traditional SVD, the S 1 is calculated using following equation:Note that this is a pseudo-inverse operation thatBecause the small values caused by noise in the diagonal matrix may result in extremely large values in P 1 , the noise is emphasized and dominates the inverses diagonal matrix using traditional SVD. A truncating step is therefore used to prevent the amplification of noise. A truncation parameter is defined, which specifies the number of the largest elements to be kept in the diagonal matrix P , while the rest of the elements will be set to zero in P 1. Thus, the amplification to the observation noise is restrained. In TSVD, Equation 6 is written as:Finally, based on Equations 4, 5 and 7, the regression coefficient matrix can be calculated as:
Determine the starting phosphorylation levelsUnder an unseen inhibitor, there is no access to the phosphorylation levels at the first time point. A protein's initial phosphorylation level was therefore set to its average value at the time 0 under observed inhibitors. Furthermore, proteins, when targeted by an inhibitor(s), tend to have different initial phosphorylation levels compared with the levels when they are not targeted. Thus, we excluded the data points for inhibited proteins in the training data when estimating the starting points.
Adjust the influence of inhibited proteinsThe activities of the phosphorylation proteins targeted by inhibitors are expected to be much lower than what are calculated in the matrix R in Equation 8. To model the situation of a complete inhibition, the contribution of inhibited proteins toward other proteins was set to 0 when predicting the unseen trajectory of phosphorylation levels.0 Antibody i is inhibited R i;j otherwise (
9Equation 9 is applied to both inferring the R matrix (Equation 2) and predicting the dynamics of levels of phosphorylation under unseen situation. During the model training, time course data under different inhibitors can be combined together in Equations 2, 3, 4 and 8, i.e. multiple observed trajectories under different perturbations could be combined to predict a single regression coefficient matrix R (see Supplementary Material).
Iteratively predict the phosphorylation levels across a time courseAfter estimating the phosphorylation levels of each protein at the first time point E i t 1  and adjusting the regression coefficient matrix R based on the new, unseen inhibitors, Equation 1 is used iteratively to predict the time course phosphorylation levels at the rest of the time points under this specific perturbation.
RESULTSThis trajectory prediction method is a regression-based method using the first-order Markov and stationarity assumption. It first estimates the regression coefficients between phosphoproteins and determines the starting phosphorylation levels under unseen perturbation, then predicts the trajectory one time point by one time point. In the following sections, we first demonstrate the accuracy of this algorithm using simulation data. Second, we evaluate the prediction accuracy under different assumptions, such as different levels of noise and regression coefficient matrix density. Third, we examine the accuracy of this method on experimental data in breast cancer cell lines.
Simulation modelA simulation study was performed using 20 phosphoproteins, seven time points with five different inhibitions. The simulation model is constructed following the description in previously studies ().Briefly, the simulation contains six steps: (i) A random regression coefficient matrix R with a non-zero element density of 15% is generated and its non-zero values are replaced by values in a uniform distribution of ([0.2, 0.02] [). These values represent the effect of one phosphoprotein on the phosphorylation value of another protein, where positive values represent activation relationships and negative values represent inhibition relationships. A zero-element indicates that the first phosphoprotein has no effect on the second phosphoprotein.(ii) Proteins' initial phosphorylation levels are randomly generated from a uniform distribution over. (iii) Randomly select one (or two) inhibited protein(s) and adjust the corresponding elements to 0 in the regression coefficient matrix R, for simulating phosphorylation dynamics under defined inhibitors. (iv) Equation 1 is used to iteratively generate the observed time course data. (v) A normally distributed noise $N 0; 0:1   or N 0; 0:5   or N 0; 1:0   is added to each phosphoprotein at every time point. (vi) Repeat step 3 and 5 to generate time course trajectories under five different inhibitors. To evaluate the performance of our method, we simulated 5-fold cross-validation for 100 repeated runs. Thus, this prediction method uses time course data under four inhibitors as training data and data under the remaining inhibitor are used as the test set and withheld from model training.
Evaluation on reconstructing the signaling networksAs this prediction method predicts the regression coefficient matrix before predicting the trajectories over a time course, we first evaluated how well it can recover the true regression coefficient matrix.shows the area under receiver operating characteristic curve (AUC) and area under precision recall curve (AUPRC) under low (0.1), medium (0.5) and high (1.0) noise levels with different denoising truncation parameters (as described in Equation 7). The performance under each of the noise level and parameter combination was an average of 100 simulations. We found that the denoising step (truncation in TSVD) is critical for recovering the original signaling networks (). In the case that the noise is small, the performance reaches maximum (AUC = 0.74, AUPRC = 0.48, compared with a baseline of 0.5 and 0.15) with a truncation parameter of 8 (Equation 7). As the noise level increases, a stronger denoising step is required, represented by less retained values in the diagonal matrix. As expected, the performance slightly drops with the increase of noise level (AUC = 0.7 for medium level of noise, and AUC = 0.67 for very high level of noises), i.e. the signal-tonoise ratio (SNR, defined as the average of the original phosphorylation levels divided by the SD of noise) is $14 (medium level) to 6.6 (high level). This performance was achieved without any prior knowledge.
Influence of truncation parametersTo evaluate the accuracy of this algorithm in predicting the phosphorylation dynamics across a time course under new perturbations, we calculated root-mean-square error, or RMSE, to measure the difference between predicted trajectory values and the withheld values during the cross validation. For each protein and each time point, the predicted value will be compared against the simulated values and differences between these values are considered as the prediction error.One critical parameter in this prediction method is the truncation parameter (Equation 7), where a strict parameter and thus less retained elements in the diagonal matrix indicate stronger denoising effort. The accuracy in terms of RMSE under different parameters and different noise levels is therefore evaluated (). Under the noise level of 0.1 (low noise level), this method remarkably recovers the shadowed trajectory with a RMSE equals to 0.8, where the RMSE for random prediction is 44 (truncation parameter = 8). Even if the noise level is increased to 1.0, this method is still able to deliver a close prediction with a RMSE51.5. As expected, loose parameters (410), could barely estimate the hidden trajectory because of the amplified noise effect using traditional SVD and result in a high level of errors. Furthermore, when the noise level is high, a strict truncation parameter (=3) performs better in terms of RMSE () because of its strong denoising effect. Furthermore, the simulation results indicate that the number of protein and sparsity of signaling network does not change the optimal truncation parameter, while, as we expected, noise level could influence the truncation parameter (see Supplementary Figs S1S3 for more details). Based on the RMSE in the crossvalidation, the optimal truncation parameters are 310, depending on the noise level, i.e. the optimal truncation parameter is 510 under low noise level (SNR ! 14) and is 35 under high noise level (SNR514).
Influence of noise levelSubfigures (d), (e) and (f) ofshow the RMSE at each time point under different noise levels. A parameter of eight elements retained in the diagonal matrix is used in these subfigures. The predicted phosphorylation levels at the first point after the starting time point is extremely accurate, with a RMSE value almost the same as the noise level, indicating that we could almost perfectly recover the real phosphorylation levels. The prediction error starts to increase in the following time points, as noise accumulates during the iterative prediction steps. The RMSE predicted by our method is much smaller than random prediction baseline. Taking the low noise level as an example, the predicted trajectory has a RMSE of 0.1 at the first point (which is the same as the noise level) and 0.253 at the second time point, the RMSE increases to 1.60 at the last time point due to the accumulation of the prediction error in each iteration. At the same time, the random prediction has RMSEs ranging from 3.91 to 9.55, which are 5 to 38 folds larger than this prediction model.
Influence of sparsity of signaling networkTo assess the robustness of this prediction method, we have evaluated the prediction error against different influence matrix densities of the signaling networks (). We found that better performance is achieved when the influence matrix is sparse. With the increased density of non-zero elements and thus more complex network structure, the performance is slightly reduced, but the RMSE values are always 51.5 (compared with a RMSE of 7.02 for random prediction), indicating that this algorithm can robustly perform well even for networks with very complex structures, i.e. many interactions.shows the computational time required for this method and other two state-of-the-art network inference methods: dynamic Bayesian network (DBN) () and BP (). The computational time is evaluated on a PowerEdge R410 processor, with four cores and 48 GB memory. This new algorithm takes 50.01 s for 20 proteins, while DBN costs $1 s and BP takes 41 min. When dealing with 40 proteins, both DBN and BP need 410 min, whereas TSVD only takes 0.01 s. This algorithm has a linear computational time requirement, and the computational time required for 2560 proteins is only 22.7 s. Compared with DBN and BP, TSVD are consistently hundreds of folds faster. Therefore, we conclude that this new algorithm offers tremendous computational performance advantage over the state-of-the-art methods, and make the genomescale reconstruction of signaling networks possible.
Computational time
Validation using experimental dataWe further validated this method using time course phosphorylation data in the breast cancer cell line MDA-MB-468 (). These data contain eight time points from three replicates, under different levels of EGF stimulus (0, 5 and 10 ng), for 20 proteins. In the validation, we used data under 0 and 10 ng EGF stimulus as training data and evaluated how well it can recover the phosphorylation levels under 5 ng EGF stimulus. Data from replicates are treated as separate time course observations. Considering that the signal-to-noise ratio, which is determined by the average of the phosphorylation levels divided by the SD between replicates, is 14.5 (close to the median level of noise and larger than the low level of noise in simulation), a truncation parameter = 6 is used in TSVD. This model is robust that truncation parameters ranging from 5 to 10 all deliver predictions with similar accuracy.shows the predicting accuracy for experimental data. The average RMSE for the eight time points is 0.06, while random prediction baseline (for 100 runs) is 0.91, indicating 15-fold reductions in error. Notably, the average SD of phosphorylation levels between experimental replicates is 0.015. This indicates that the prediction performance (RMSE = 0.06) almost approximates the performance of real perturbation experiments affected by noises such as measurement error, which strongly supports the effectiveness of our algorithm.
DISCUSSIONAnalyzing time course trajectories under unseen perturbations has important application in model biology, such as predicting dynamic phosphorylation networks, drug responses and treatment outcomes. However, previous research mainly focused on recovering the relationship between phosphoproteins. In this article, we describe a novel framework to predict trajectories under unseen perturbations. We found that the noise level and the signaling network density have noticeable influence on the prediction accuracy. However, this model is able to handle all the noise levels and signaling network structures with a satisfying performance. The effectiveness of this model is also validated using experimental data on a breast cancer cell line MDA-MB-468. The experimental validation indicates that the predicting error of this model is at the similar level as the difference between experimental replicates. The effectiveness of this model was demonstrated in the 8th Dialogue for Reverse Engineering Assessments and Methods (DREAM 8: https://www.synapse.org/#!Wiki:syn1929437/ ENTITY/63075) challenge as the best performing and most consistent method (judged by RMSE, see Supplementary Materials for more details) in the subchallenge time course prediction (). In this subchallenge, both experimental
The Author 2014. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
Dynamic trajectory prediction at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
F.Zhu and Y.Guan at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
