We developed PSAR-Align, a multiple sequence realignment tool that can refine a given multiple sequence alignment based on suboptimal alignments generated by probabilistic sampling. Our evaluation demonstrated that PSAR-Align is able to improve the results from various multiple sequence alignment tools. Availability and implementation: The PSAR-Align source code (implemented mainly in Cþþ) is freely available for download at
INTRODUCTIONMultiple sequence alignment (MSA) is one of the most important foundations for cross-species comparative genomic analysis (). Although many algorithms for MSA have been developed (), MSA is still error-prone. For example, it was estimated that at least 10% of the human-mouse wholegenome alignment is misaligned at the UCSC Genome Browser and the number increases for other species (). We previously developed a novel measure, called PSAR (), which can assess the reliability of an MSA based on its agreement with probabilistically sampled suboptimal alignments (SAs). SAs provide additional information that cannot be obtained by the optimal alignment alone, especially when the optimal alignment is not far superior to the SAs. In this article, we introduce a new realignment method, PSARAlign, which refines a given MSA based on a probabilistic framework that takes advantage of the SAs of the given MSA. Briefly, PSAR-Align (i) samples SAs from the given MSA, (ii) estimates posterior probabilities of aligning two residues from two different sequences and (iii) generates a revised MSA using an expected accuracy-based alignment algorithm ().
METHODS
PSAR-Align algorithmGiven an input MSA, PSAR-Align first generates SAs by probabilistic sampling (and B). Specifically, for each pair of one sequence and a remaining sub-alignment, PSAR-Align compares them based on a special pair hidden Markov model (pair-HMM) that emits columns of an MSA, which can be represented by dynamic programming matrix. To generate the SAs, PSAR-Align traces back through the dynamic programming matrix based on a probabilistic choice at each step that can take into account the relative score of a current path in comparison with neighboring paths (). Then, for each pair of two residues x i and y j from two different sequences X and Y in the input MSA, their alignment in the sampled SAs are counted and converted to the posterior probability P(x i $ y j jX,Y) (and D), which is defined as follows:where S is the set of the SAs, jSj is the total number of alignments in S and 1{x i $ y j 2S k } is an indicator function that returns 1 only when x i and y j are aligned in an SA S k. PSAR-Align uses these probabilities to generate the revised alignment by maximizing an expected accuracy of an MSA A [acc(A)] against the (unknown) true alignment. The expected accuracy is the sum of the posterior probabilities of aligned pairs of residues and unaligned (aligned with a gap) residues in a given MSA (), which is defined as follows:where A XY is a pairwise alignment between two sequences X and Y, P(x i $ y j jX,Y) is the posterior probability of pairwise alignment mentioned earlier in the text and P(x i $  jX,Y) and P( $ y j jX,Y) are the posterior probabilities of aligning each residue with a gap that can be computed as follows:For the maximization of the expected accuracy, we used the sequence annealing algorithm in the FSA program (). The current version of PSAR-Align was implemented mainly in C with additional Perl scripts, and the expected accuracy *To whom correspondence should be addressed. maximization step was implemented on top of the source code of FSA ().
EvaluationWe assessed the performance of PSAR-Align by using a simulated benchmark generated by Dawg (). The benchmark mimics non-coding DNA sequences of five mammalian species (human, mouse, rat, dog and cow), whose phylogenetic tree was obtained from the UCSC Genome Browser (). The benchmark consists of 1000 replicates of $1 kb-long sequences, and ClustalW (), MAFFT (), MAVID (), MUSCLE () and Pecan () were used to generate the input MSA. Two evaluation measures were used: (i) alignment sensitivity, which is the fraction of aligned and unaligned (aligned with a gap) residues in the true alignment that agree with the predicted alignment and (ii) alignment specificity, which is the fraction of aligned and unaligned (aligned with a gap) residues in the predicted alignment that agree with the true alignment.
Computational complexityThe time and memory complexites of alignment sampling are O(L 2 NS) and O(LN), respectively, where L is the alignment length, N is the number of sequences and S is the number of sampling trials (). The pairwise posterior probability computation requires O(N 2 L) time and memory complexity, and the maximization of the expected accuracy was done efficiently by FSA (). In the evaluation, a single run of PSAR-Align for each input MSA took $3 min in an Intel (R) Xeon 2.67 GHz machine with 64 GB memory.
The Author 2013. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
RESULTS We evaluated PSAR-Align by using simulated sequences of five mammalian species (see Section 2). By using ClustalW, MAFFT, MAVID, MUSCLE and Pecan, input MSAs were generated and fed into PSAR-Align, which resulted in a refined MSA. The original (by the aforementioned five programs) and revised (by PSAR-Align) MSAs were compared with true MSAs, which were known from the simulation. We used two evaluation measures: alignment sensitivity and specificity (see Section 2). As shown in Table 1, the alignment specificity of the original MSA by all five programs increased in the PSAR-Align MSA. The amount of increases ranges from 0.662 (Pecan) to 2.591 (ClustalW). Similar differences were also observed for alignment sensitivity, which showed an increase ranging from 0.554 (MAVID) to 2.602 (ClustalW). In the case of Pecan, alignment specificity of the revised alignment by PSAR-Align was slightly higher than the original, but the opposite pattern was observed from alignment sensitivity. Our evaluation results indicate that (i) PSAR-Align can be used to improve MSAs from different types of MSA programs and (ii) Pecan is a high-quality MSA program based on our evaluation datasets. 4 CONCLUSION We have developed a new alignment refinement tool, PSARAlign, which is a realignment algorithm based on probabilistically sampled SAs. The performance of PSAR-Align was evaluated by simulation-based benchmarks. This tool will be useful for comparative genomics studies using MSA. Funding: National Research Foundation of Korea Grant (2012R1A1A1015186 to J.K.) and National Institutes of Health grant (HG006464 to J.M.). Conflict of Interest: none declared. REFERENCES Bradley,R.K. et al. (2009) Fast statistical alignment. PLoS Comput. Biol., 5, e1000392. Bray,N. and Pachter,L. (2004) MAVID: constrained ancestral alignment of multiple sequences. Genome Res., 14, 693699. Cartwright,R.A. (2005) DNA assembly with gaps (Dawg): simulating sequence evolution. Bioinformatics, 21 (Suppl. 3), iii31iii38.
PSAR-Align at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
