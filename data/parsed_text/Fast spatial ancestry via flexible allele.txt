Motivation: Unique modeling and computational challenges arise in locating the geographic origin of individuals based on their genetic backgrounds. Single-nucleotide polymorphisms (SNPs) vary widely in informativeness, allele frequencies change non-linearly with geography and reliable localization requires evidence to be integrated across a multitude of SNPs. These problems become even more acute for individuals of mixed ancestry. It is hardly surprising that matching genetic models to computational constraints has limited the development of methods for estimating geographic origins. We attack these related problems by borrowing ideas from image processing and optimization theory. Our proposed model divides the region of interest into pixels and operates SNP by SNP. We estimate allele frequencies across the landscape by maximizing a product of binomial likelihoods penalized by nearest neighbor interactions. Penalization smooths allele frequency estimates and promotes estimation at pixels with no data. Maximization is accomplished by a minorizeâ€“maximize (MM) algorithm. Once allele frequency surfaces are available, one can apply Bayes' rule to compute the posterior probability that each pixel is the pixel of origin of a given person. Placement of admixed individuals on the landscape is more complicated and requires estimation of the fractional contribution of each pixel to a person's genome. This estimation problem also succumbs to a penalized MM algorithm. Results: We applied the model to the Population Reference Sample (POPRES) data. The model gives better localization for both unmixed and admixed individuals than existing methods despite using just a small fraction of the available SNPs. Computing times are comparable with the best competing software.
INTRODUCTIONThe pertinence of the first law of geography'Everything is related to everything else, but near things are more related than distant things' ()has long been obvious to population geneticists. For example, in the 1930s,) and Kolmogorov () derived and solved a partial differential equation describing the spatial spread of an advantageous allele. Subsequent generations of ecologists and evolutionary biologists have studied the correlations between geography and population structure from many different perspectives (). During the past decade in particular, geneticists have discovered how to localize the origin of individuals, human and otherwise, based on their genetic backgrounds (). Such localization is called spatial assignment. In an application of principal component analysis (PCA),were able to match the first two principal components of the genotype matrix of the Population Reference Sample (POPRES) dataset () to the map of Europe. PCA-based estimation of geographic origins was accurate to within a few hundred kilometers. Though this level of resolution is impressive, it is natural to wonder if a modelbased method for spatial assignment could perform better and whether inferences could be reliably made for admixed individuals. This promptedto introduce spatial structure analysis (SPA), which, in fact, produces more accurate spatial assignments than PCA. In estimating allelic frequency surfaces for each surveyed single-nucleotide polymorphism (SNP), SPA depends on a simple gradient function describing how allele frequencies vary with location. In practice, allele frequency surfaces can be bumpy without a dominant cline. The current article relaxes this restriction and gives more accurate reconstructions.
APPROACHOur software, OriGen, adapts techniques from image reconstruction that encourages smoothness without requiring rigidly parameterized allele frequency surfaces (). OriGen is model based and fast. It can infer the geographic origin of Europeans in the POPRES dataset to much less than 100 km. Its impressive speed is achieved by focusing on the most informative markers, sometimes as few as 1% of all markers, and relying on new minorizationmaximization (MM) algorithms for parameter estimation. In choosing ancestry informative markers, we replace the information criterion ofby a homogeneity likelihood ratio test (LRT) that accommodates substantial differences in sample sizes. *To whom correspondence should be addressed.
MATERIALS AND METHODS
A LRT criterion for SNP selectionThe majority of SNPs are uninformative for ancestry and geographic localization. This fact and considerations of computational speed suggest choosing the most informative SNPs and ignoring the rest. The standard ancestry informativeness criterion ofmakes the implicit assumption of equal sample sizes. The failure of this assumption in the POPRES data prompted us to turn to a homogeneity LRT. The null model of the test for a given SNP postulates that all individuals come from a single population with a unique allele frequency for the reference allele; the alternative model postulates different reference allele frequencies at the different sampling sites. Binomial sampling is in force. Suppose there are s sites with k i sampled reference alleles and n i sampled genes (reference alleles plus alternative alleles) at site i. If k=then the LRT statistic reduces towhere ^ q=k=n and ^ p i =k i =n i are the maximum likelihood estimates of the reference allele frequencies under the null and alternative models, respectively. Although small sample sizes at many sites invalidate the chi-square distribution of the LRT statistic, nothing prevents the statistic from being used as an index to rank the various SNPs. In our experience, the highest ranking SNPs are indeed the most informative.
Allele frequency surface estimationTo estimate the allele frequency surface for a given SNP, we divide the region of interest, say Europe, into pixels and assign a reference allele frequency p i to each pixel i. Extending our previous notation, k i now represents the number of sampled reference alleles and n i the number of sampled genes from pixel i. For most pixels, k i =n i =0. Maximizing the binomial loglikelihoodwould allow estimation of the reference allele frequencies if all pixels actually contained sampled people. Because this is not the case and because we desire smooth estimates across the landscape, we subtract squared difference penalties from the loglikelihood and maximize the penalized loglikelihoodHere the tuning constant determines the extent of smoothing. The nonnegative weights w ij incorporate nearest neighbor interactions and scale the distance between pixel centers. For square pixels we accordingly set w ij = 1 for pixels sharing a side, w ij =1= ffiffi ffi 2 p for pixels sharing a corner and w ij = 0 for all other pixel pairs. Limiting interactions to the eight pixels surrounding a pixel obviously reduces computational complexity. Maximizing the criterion (1) is a formidable optimization problem because the penalty terms couple the parameters in an awkward fashion and make it impossible to find an exact solution. However, we can invoke the MM principle () and construct a surrogate function that separates the parameters. A surrogate function gp j p n  for the objective function fp must be tangent to fp at the current iterate p n and dominated by it throughout the common domain of both functions. Formally, these conditions can be restated as the equality gp n j p n =fp n  and the inequality gp j p n  fp for all feasible p. In the maximization step of the MM algorithm, the next iterate p n+1 is chosen to maximize p  gp j p n . These definitions imply the ascent condition fp n+1  ! gp n+1 j p n  ! gp n j p n =fp n ; which is the secret of the MM principle's success. The derivation of our surrogate function depends on the minorization xy ! x m y m 1+ln x x m +ln y y m ! 2 for positive numbers. This minorization reduces to the supporting line inequality ln z ! 1  z if we substitute z=xy=x n y n . Application of the minorization (2) leads to the overall minorizationh i of fp up to an irrelevant constant. With parameters separated, we can now solve the stationarity equationw ij p nj. This cubic is positive when p i = 0 and non-positive when p i = 1. The cubic also tends to AE1 when p i tends to AE1. Hence, there exists a single root on the interval 0; 1. One can extract this root by one of the standard formulas for solving a cubic equation. In practice, we add a small increment , say 0.1, to each sampled k i and 2 to each sampled n i. These pseudocounts, which are similar to Laplace estimators, stabilize estimation and prevent allele frequencies from converging to 0. For plotting on a log-scale, pseudocounts are mandatory. One can view pseudocounts as imposing a weak beta prior.
Localization of unknownsOnce the allele frequency surfaces for the informative SNPs are estimated by the MM algorithm, one can localize individuals of unknown origin. For person j with genotype vector x j , Bayes' rule gives the posterior probability Pr j from pixel i j x j = Pr x j j j from pixel i Pr j from pixel i Pr x j  that j originates from pixel i. Application of this rule depends on fixing a prior. Two possibilities are convenient. The simpler one is the uniform prior. A more accurate but less convenient choice is to scale the prior of a pixel by its population size. For sufficiently informative genetic data, the evidence dominates the prior, and the uniform prior is probably adequate. The likelihood term Pr x j j j from pixel i= Y kPr x jk j j from pixel i factors into a product of likelihoods at the canvassed SNPs under the assumption of linkage and HardyWeinberg equilibrium. The likelihood Pr x jk j j from pixel i at SNP k equals one of the three genotype probabilities p 2 ik ; 2p ik 1  p ik  or 1  p ik  2 depending on j's genotype at SNP k. In practice, it is advisable to work with the logarithms of these quantities to avoid computer underflows. Although the pixel with the highest posterior probability provides the most likely localization, it is a good idea in practice to assign an average latitude and longitude and highlight the set of pixels that contribute substantially to the posterior distribution. For large numbers of SNPs, the two methods of localization appear equivalent.
Admixed individualsFor an ethnically admixed individual, we suggest estimating the fractional contribution f i of each pixel i to his/her genome. If we let x k denote the observed number of reference alleles at SNP k, then the loglikelihood of the person's observed genotypes amounts toand f i ! 0 for all i. This formulation of the problem is reminiscent of the ethnic admixture problem if we identify pixels with ethnic groups and fix allele frequencies rather than estimate them (). Maximization of Lf is a typical MM exercise. The key step is to separate parameters via the minorizationsbased on Jensen's inequality applied to the concave function ln x. Equality holds when f=f n. If we define the constantsthen standard arguments invoked in maximizing a multinomial likelihood yield the updatesOne can accelerate convergence in estimating f and improve inference by imposing a penalty that drives to 0 those components f i with low explanatory power. As a lasso penalty Xand penalty to estimate haplotype frequencies. Rather than repeat the mathematical derivation of the same penalized MM algorithm here, we refer the reader to the reference () for details. Suffice it to say that with parameters separated, the MM updates require solving a simple quadratic equation for each component f i. Generic extrapolation techniques for MM and similar algorithms permit convergence acceleration beyond that afforded by our specific penalization (). Because highly admixed individuals are nearly impossible to characterize fully, we choose = 1 16. Beyond this value no further penalty is exerted to eliminate pixels with little evidence of admixture. The total strength of the penalty is chosen to minimize the expected geodesic distancebetween the true and estimated centers of a person's admixture distribution over many simulated admixed people. Here, d ij is the geodesic distance between the centers of pixels i and j. Although somewhat ad hoc, these choices of and perform well in practice.
RESULTS
A LRT criterion for SNP selectionThe utility of SNPs in identifying ancestral origins varies widely. Thecriterion for ranking SNPs implicitly assumes equal sample sizes at the different sampling sites. In practice this assumption is usually violated. As an alternative, we turned to a LRT statistic for testing homogeneity of allele frequencies across sites. The LRT statistic compares the best loglikelihood of the data under the null hypothesis of homogeneity to the best loglikelihood of the data under the alternative hypothesis of complete heterogeneity.allows us to compare the value of the two different methods of ranking SNPs. The vertical axis of the figure represents the average distance under cross-validation between the true location of the POPRES individuals and their estimated locations under OriGen. The horizontal axis represents the number of SNPs used, with SNPs taken in their order of informativeness. Although the three curves document the value of ancestry informative SNPs in geographical projection, it is obvious that the LRT criterion performs better than the information criterion.
Allele frequency surfacesAccurate allele frequency surfaces are the primary reason for OriGen's superior performance. OriGen surfaces are more adaptable and less rigidly parameterized.
Ancestral origin inferenceSpatial assignment is the main application of OriGen. To showcase OriGen's accuracy, we computed average localization error by leave-one-out cross-validation.displays the results for OriGen versus SPA. The lower curve for SPA emphasizes the benefits of exploiting LRT ordered SNPs. Examination of the figure shows that OriGen using 1% of the SNPs achieves better accuracy than SPA using all of the SNPs. Using 5% of the SNPs, OriGen is nearly perfect at the pixel level in its localizations. The same point can be made by comparing OriGen's results to the results inof the SPA paper (). Given the nature of the table, a fair comparison requires using OriGen to estimate the optimal ancestral origin of each person and then assigning the person to the closest sampling site as measured by geodesic distance. Overall, OriGen was more than twice as accurate as PCA and SPA based on just 1% of the data. With 5% of the data, OriGen maps individuals to sampled pixels with 99% accuracy. In, we show the localization results of OriGen obtained from cross-validation using only 2% of the SNPs. With this small amount of data, it can already be seen that OriGen does well in placing individuals at their true origin. We also performed some small-scale comparisons with SCAT (). SCAT is computationally demanding and so more ambitious comparisons were impossible to implement.
Estimating proportions of admixed originsMany individuals have mixed ancestry. PCA tends to localize individuals with parents of different ethnicities in between their parents' regions of origin. SPA has the capacity to localize each parent separately, but the user must inform the program beforehand how many different ancestries contribute to a given individual. Because this information is often unavailable, it would be preferable for admixture detection and origin selection to be more agnostic. OriGen can estimate admixture fractions on a pixel-by-pixel basis. For example, when applied to a person with a German parent and an Italian parent, ideally OriGen should deliver 50% German ancestry, 50% Italian ancestry and 0% other ancestry. This would make OriGen comparable with the program ADMIXTURE (), with the benefit of using more accurate allele frequencies and covering small countries with no sampled people at all. In admixture mode, OriGen exploits the same allele frequency surfaces that it does in normal mode. However, instead of applying Bayes' rule to find the posterior probability of origin of each pixel, it estimates an admixture fraction for each pixel by penalized maximum likelihood estimation. OriGen is not only able to select the two contributing populations, it is also able to estimate their proportions well. Asillustrates, OriGen takes admixture estimation a step further by estimating the fractions at each pixel instead of each population. OriGen allows one to place individuals at locations with no sampled data. In the figure, the true locations of the individual's grandparents are highlighted, while OriGen's results are written as text atNote: Population of origin was predicted for each individual using leave-one-out cross-validation. Accuracy AE SD is the proportion of individuals from each population correctly assigned to their true population. The values listed for OriGen represent either 1% of the data (2 K SNPs) or 5% of the data (10 K SNPs). To make the values from OriGen comparable with PCA and SPA, the most likely location of each individual was estimated, and the population closest in distance to that point was chosen as the population of origin. The results for PCA and SPA are taken fromof the paper ().OriGen vs. SPA. Average localization error for individuals based on leave-one-out cross-validation using OriGen (=0:1), SPA without SNP selection and SPA with SNP selection based on the LRT. For the unordered results, the default ordering based on chromosomal position is shown. Different subsets were tried with similar results their respective locations. The results presented infor admixed individuals are typical of many reconstructions.
DISCUSSIONMotivated by advances in image reconstruction, we have presented a probability model for the estimation of complex allele frequency surfaces. Our model captures not only linear clines, but also multiple local peaks on a landscape. Allele frequency estimates represent a compromise between locally sampled genotypes and smoothness. The degree of smoothness is determined empirically by cross validation. Spatial assignment exploits the allele frequency surfaces of the most informative SNPs. To no one's surprise, the ancestry informative SNPs drive projection. In ranking SNPs our homogeneity LRT statistic outperforms the information criterion of, which assumes equal sample sizes at the sampled sites. In practice, the combination of a good model with just 1% of the available SNPs give better geographic localization on the POPRES data than competing models (PCA, SCAT and SPA) with all of the SNPs. Our computing times are vastly superior to SCAT and competitive with PCA and SPA. We have also proposed a model for spatial assignment of admixed individuals. Our model assigns an admixture coefficient to each pixel. To avoid over-parameterization, we impose a penalty that enforces parsimony and focuses attention on those pixels with the greatest explanatory power. Estimation of both allele frequency surfaces and admixture coefficients benefits from the MM principle. The MM algorithms generated are simple to code and automatically enjoy the ascent property. Convergence can be slow, but standard extrapolation techniques accelerate convergence dramatically. On the negative side of the balance sheet, our software OriGen requires more storage per SNP than SPA, which characterizes an allele frequency surface by just three parameters. The accuracy of OriGen is also limited by the number of pixels. For the POPRES dataset, we enclosed Europe in a square with 70 pixels on a side. Smaller pixels make little discernible difference in resolution at the expense of considerably more computation. The heatmaps of posterior probabilities and admixture coefficients afforded by the pixels are a decided plus. The ability to exclude infeasible pixels over oceans is another advantage.Note: SPA's localizations can fall outside the mapped region. The localization of OriGen and SCAT must fall within the mapped region. be taken as geographically localized. Finally, our SNP selection criterion is probably better suited to identifying ancestry informative SNPs than abstract information criterion. Readers will doubtless think of many other ways of improving the current model. For example, a reviewer suggested that it might be useful to incorporate standard errors of allele frequency estimates into localization heatmaps. Our preliminary testing of this plausible idea finds no improvement, probably because localization averages across so many SNPs. Science, like product design, is usually an iterative process of successive refinement.Admixed Surfaces Longitude Latitude. Admixture coefficients for four simulated Europeans with grandparents from locations highlighted in lighter colors. The numbers listed are the estimated admixture coefficients at their respective pixels based on 40 K SNPs; values51% are omitted. In the top left is a simulated individual with four grandparents coming from the UK. On his right is an individual with two grandparents from Germany and two from Poland. On the bottom left is an admixed individual with two grandparents from Portugal and one each from France and Poland. Finally, on the bottom right is an individual whose four grandparents come from Spain, France, UK and Poland
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
J.M.Ra ~ nola et al. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
Fast spatial ancestry at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
