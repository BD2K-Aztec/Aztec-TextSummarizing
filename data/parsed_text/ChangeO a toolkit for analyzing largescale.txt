Advances in high-throughput sequencing technologies now allow for large-scale characterization of B cell immunoglobulin (Ig) repertoires. The high germline and somatic diversity of the Ig repertoire presents challenges for biologically meaningful analysis, which requires specialized computational methods. We have developed a suite of utilities, Change-O, which provides tools for advanced analyses of large-scale Ig repertoire sequencing data. Change-O includes tools for determining the complete set of Ig variable region gene segment alleles carried by an individual (including novel alleles), partitioning of Ig sequences into clonal populations, creating lineage trees, inferring somatic hypermutation targeting models, measuring repertoire diversity, quantifying selection pressure , and calculating sequence chemical properties. All Change-O tools utilize a common data format , which enables the seamless integration of multiple analyses into a single workflow. Availability and implementation: Change-O is freely available for non-commercial use and may be downloaded from http://clip.
IntroductionLarge-scale characterization of immunoglobulin (Ig) repertoires is now feasible due to dramatic improvements in high-throughput sequencing technology. Repertoire sequencing is a rapidly growing area, with applications including detection of minimum residual disease, prognosis following transplant, monitoring vaccination responses, identification of neutralizing antibodies and inferring B cell trafficking patterns (). We previously developed the repertoire sequencing toolkit (pRESTO) for producing assembled and error-corrected reads from high-throughput lymphocyte receptor sequencing experiments (), which may then be fed into existing methods for alignment against V(D)J germline databases [e.g. IMGT/HighV-QUEST (), IgBLAST (), iHMMune-align (. However, extracting measures of biological and clinical interest from the resulting germline-annotated repertoire remains a time-consuming and error-prone process that is often dependent upon custom analysis scripts. Here, we introduce ChangeO, a suite of utilities that cover a range of complex analysis tasks for Ig repertoire sequencing data.
FeaturesThe Change-O suite is composed of four software packages: a collection of Python commandline tools (changeo-ctl) and three separate R (R Core) packages (alakazam, shm, and tigger)). Data are passed to Change-O utilities in the form of a tab-delimited text file. Each utility identifies the relevant input data based on standardized column names and adds new columns to the file with the output information to be carried through to the next analysis step. Change-O provides tools to import data from the frequently used IMGT/HighV-QUEST () tool as well as a set of utilities to perform basic database operations, such as sorting, filtering and modifying annotations. The more computationally expensive components have built-in multiprocessing support. Each utility includes detailed help documentation and optional logging to track errors. Example workflow scripts are provided on the website, which can easily be modified by adding, removing or reordering analysis steps to meet different analysis goals. As detailed later, several repertoire analyses may be carried out, depending on the nature of the study.
Inference of novel alleles and individual genotypeGermline segment assignment tools, such as IMGT/HighV-QUEST, work by aligning each sequence against a database of known alleles. However, this process is inaccurate for sequences that utilize previously undetected alleles. In this case, the sequence will be assigned to the closest known allele and any polymorphisms will be incorrectly identified as somatic mutations. To address this problem, the Tool for Immunoglobulin Genotype Elucidation (TIgGER) () has been implemented as an R package for inclusion in Change-O. TIgGER determines the complete set of variable region gene segments carried by an individual and identifies novel alleles, yielding a set of germline alleles personalized to an individual. The germline variable region allele assignments are then adjusted based on this individual Ig genotype. This process significantly improves the quality of germline assignments, thus increasing the confidence of downstream analysis dependent upon mutation profiles.
Partitioning sequences into clonally related groupsIdentifying sequences that are descended from the same B cell (clonal groups) is important to virtually all Ig repertoire analyses. Clonal group sizes and lineage structures provide information on the underlying response, and clonally related sequences cannot be treated independently in statistical analyses and models. Change-O provides several methods for partitioning sequences into clones. Along with published methods based on hierarchical clustering (), users also have the option to employ several published somatic hypermutation (SHM) hot/cold-spot targeting models as distance metrics in the clustering methods (). Users may alter the clustering thresholds, and Change-O also includes tools to tune the thresholds based on distance patterns in the repertoire ().
Quantification of repertoire diversityTo assess repertoire diversity, Change-O provides an implementation of the general diversity index ( q D) proposed by, which encompasses a range of diversity measures as a smooth curve over a single varying parameter q. Special cases of this general index of diversity correspond to the most popular diversity measures: species richness (q  0), the exponential Shannon-Weiner index (as q ! 1), the inverse of the Simpson index (q  2), and the reciprocal abundance of the largest clone (as q ! 1). Resampling strategies are also provided to perform significance tests and allow comparison across samples with varying sequencing depth ().
Generation of B cell lineage treesLineage trees provide a means to trace the ancestral relationships of cells within a clone. This information has been used to estimate mutation rates (), infer B cell trafficking patterns () and trace the accumulation of mutations that drive affinity maturation (). Change-O provides a tool for generating lineage trees using PHYLIP's maximum parsimony algorithm (), with modifications to meet the requirements of an Ig lineage tree (). Trees may be viewed and exported into different file formats using the igraph () R package.
Somatic hypermutation hot/cold-spot motifsSHM is a process that operates in activated B cells and introduces point mutations into the DNA coding for the Ig receptor at a very high rate (%10 3 per base-pair per division) (). Accurate background models of SHM are critical, since SHM displays intrinsic hot/cold-spot biases (). Change-O provides utilities for estimating the mutability and substitution rates of DNA motifs from large-scale Ig sequencing data to construct hot/cold-spot motif models. Furthermore, models may be generated based solely on silent mutations, thereby avoiding the confounding influence of selection pressures (). These tools can be used to build models of SHM targeting and gain insight into the relative contributions of different error-prone repair pathways in SHM.
Analysis of selection pressureFor quantifying selection pressure in Ig sequences, Change-O includes the BASELINe () method, which has been implemented as an R package for inclusion in the suite. BASELINe quantifies deviations in the frequency of replacement mutations compared with a background model of SHM. Users may choose between published background models () or infer the background from their own data using the SHM model building tools described above. communication between the utilities and can easily be viewed using any spreadsheet application. This format also allows research groups the flexibility to incorporate other analysis tools into their in-house analysis pipelines by simply adding additional columns of information to the central file. Change-O, along with pRESTO (), provides key components of an analytical ecosystem that enables sophisticated analysis of high-throughput Ig repertoire sequencing datasets.
at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
Conclusion Change-O is a suite of utilities implementing a wide range of B cell repertoire analysis methods. Together these tools allow researchers to quickly implement advanced analysis pipelines for large datasets generated by repertoire sequencing experiments. A simple tabdelimited file with standardized column names allows for Table 1. Summary of Change-O features Package Analysis tasks changeo-clt Parsing of V(D)J assignment output Basic database manipulation Multiple alignment of sequence records Assignment of sequences into clonal groups Calculation of CDR3 physiochemical properties alakazam Clonal diversity analysis Lineage reconstruction shm SHM hot/cold-spot modeling Quantification of selection pressure tigger Inference of novel germline alleles Construction of personalized germline genotype Change-O
N.T.Gupta et al. at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
