Motivation: Many computational methods for RNA secondary structure prediction, and, in particular, for the prediction of a consensus structure of an alignment of RNA sequences, have been developed. Most methods, however, ignore biophysical factors, such as the kin-etics of RNA folding; no current implementation considers both evolutionary information and folding kinetics, thus losing information that, when considered, might lead to better predictions. Results: We present an iterative algorithm, Oxfold, in the framework of stochastic context-free grammars, that emulates the kinetics of RNA folding in a simplified way, in combination with a molecular evolution model. This method improves considerably on existing grammatical models that do not consider folding kinetics. Additionally, the model compares favourably to non-kinetic thermodynamic models.
INTRODUCTIONThe function of ribonucleic acid molecules (RNA) is known to depend on their 3D structure, which, in turn, depends on their secondary structure, a scaffold of base pairs formed by hydrogen bonds between nucleotides, for thermodynamic stability and molecular function. Accurate prediction of RNA secondary structures, however, falls short of being adequately solved. By contrast, the spreading of next-generation sequencing technologies and new methods in transcriptomics has increased the importance of RNA secondary structure prediction. This is exemplified by the growing amount of biological RNA data available in databases, such as Rfam () and RNA STRAND (). Computational RNA secondary structure prediction methods have been used for a number of years: some of the first attempts (e.g.) simply evaluate the free energy of all possible secondary structures, postulating that the minimum free-energy structure is the functional one. These thermodynamic models were later refined to take into account biological and thermodynamic principles and are used to great effect in algorithms such as RNAFold () and UNAFold (), which rely on a large number of experimentally determined parameters. Alternative approaches use the framework of stochastic context-free grammars (SCFGs) to find the most likely structure given their training data, postulating that this is the functional structure. Among the first to describe such models were Eddy and Durbin (1994). Many different grammatical models for RNA secondary structure prediction have been implemented (). If one seeks to build better grammatical models for RNA secondary structure prediction, one can take essentially two different routes:Build more complex grammars that express higher-order dependencies, such as base pair stacking, and, for instance, thereby emulate the nearest-neighbour model underlying thermodynamic approaches;Include additional biological and physical information about the sequences, for example, at the level of the previous pairing and unpairing probabilities of the grammar.The former approach has been taken by Nebel and Scheid (2011) and. The latter developed a language to translate a wide variety of probabilistic and thermodynamic models for RNA secondary structure prediction into the language of SCFGs, yielding highly complex grammars with a large number of parameters. However, we follow the latter approach, which was pioneered by, who coupled a simple grammar to an evolutionary model to obtain better estimates of the previous base pairing probabilities when folding an alignment of RNA sequences. Most current approaches to RNA secondary structure prediction are static, insofar as they assess structures based on their constituent elements like base pairs and loops but with no contribution from the path followed to form these *To whom correspondence should be addressed. elements, insofar as they fold sequences in one go, and thereby ignore the mechanisms of folding. The importance of folding mechanisms was noted by, who studied the folding of intermediary stems. We note that 'the differences between real structures and the minimum energy states are believed to be determined mainly by defects in the energy rules used or by the existence of specific folding pathways capturing molecules in local minima' (). Just as comparative structure prediction is based on the observation that structure is important for function and, hence, conserved, as folding kinetics is important for either guiding or determining structure formation, we would expect evolution to exert selection on the kinetics too. Previously, evolutionary models () and kinetic models (e.g.) have been implemented, but they have not been combined. It is, therefore, important to implement folding kinetics in an evolutionary framework. In this article, we work in the framework of the fundamental problem of predicting a consensus structure for a given fixed alignment of RNA sequences. We incorporate folding kinetics, in a simplified way, into an evolutionary grammatical model in an iterative framework. Further, we introduce a distance function to incorporate information about the relationships between different pairs of columns, thus adopting the second of the aforementioned approaches. The resulting model is benchmarked against PPfold (SukosdSuko), a parallelized implementation of the Pfold algorithm of. Additionally, we compare it with a thermodynamic model, RNAalifold ().
METHODS
Background: grammatical modelsA context-free grammar () is a four-tuple N , V, P, S consisting of a finite set N of non-terminals, a finite set V, disjoint form N , of terminals, a finite set P of production rules and a distinguished starting symbol S 2 N. Each production rule replaces a non-terminal with a string of non-terminals and terminals. For example, the context-free grammar underlying the Pfold algorithm of) is represented as S ! LSjL L! :jF F ! LSjF It has non-terminals S, L, F and terminals :, , , representing unpaired and paired nucleotides in the dot-parenthesis representation of RNA secondary structures. For example, the string :: is produced by the derivation S ! L using rule S ! L ! F using rule L ! F ! F using rule F ! F ! LS using rule F ! LS ! LL using rule S ! L ! :L using rule L ! : ! :: using rule L ! :In the grammar of Knudsen and Hein (1999), the starting symbol S produces loops, whereas F produces stems and L determines whether a loop position should be a single base or the start of a new stem. A SCFG is a context-free grammar with an associated probability distribution over the production rules. Thus, each string produced by the grammar (by beginning with the starting symbol and following production rules) is given a certain probability, which gives a probability distribution over RNA secondary structures. The rule probabilities are determined by insideoutside training, an expectation maximization technique (). To complete the model, we require the previous probabilities of a dot representing any of the four nucleotides A, C, G and U and of a pair of parentheses representing any of the 16 corresponding base pairs. For example, the probability of producing an A from the non-terminal L is the product of the probability of the rule L ! : and of the previous nucleotide probability of a dot representing an A. For single sequences, these are simply the frequencies observed on training data. For alignments of multiple sequences, rather than using the simple heuristic of just multiplying the maximum likelihood estimates of the pairing probabilities of the bases in a given pair of columns in each sequence to estimate the previous base pairing probabilities of that pair of columns, the Pfold algorithm uses an evolutionary model: each pair of columns is assumed to evolve independently according to a continuous Markov process with rates given by the branch lengths of an evolutionary tree estimated from the alignment. The base pairing probabilities are then determined by post-order traversal () on the evolutionary tree. Gaps in the alignment are treated as unknown nucleotides. One possible candidate for the consensus structure is the structure with the highest probability under grammar and evolutionary model, obtained using the Cocke-Younger-Kasami (CYK) algorithm, a dynamic programming algorithm (). However, this ignores contributions from other possible structures. Most current implementations, therefore, predict the structure with the highest expected number of correctly predicted base pairs (maximum expected accuracy, MEA, estimation). The latter is determined, using a dynamic programming algorithm, from the posterior pairing and unpairing probabilities, i.e. the pairing and unpairing probabilities given the sequence data and the model (; Supplementary Material), which, in turn, are determined from the matrices of inside and outside probabilities associated with the SCFG (). For RNA secondary structure prediction, it is most convenient to write the production rules in the double-emission form of, which only allows rules of the forms U ! :, U ! VW and U ! V, where U, V, W denote generic non-terminals. Throughout this article, we use the grammar of Knudsen and Hein (1999) rewritten in double-emission form, viz S ! LSj:jF L ! :jFThis slightly reformulated version of the grammar produces the same probability distribution over strings; therefore, predictions will be the same. The generalized expressions for the insideoutside and posterior probabilities used in this article are given in this double-emission form.
Folding kinetics: iterative helix formationThe kinetics of RNA folding have been studied by, who determined the speed at which helices form. They showed that helices form quickly from a local base pair, in the sense that, once the first base pair of a helix has formed, nearby bases are more likely to pair. This motivates emulating the kinetics of RNA folding in a simplified way by forming helices iteratively. Iterative helix formation has also been used by. Once a suitable candidate base pair has been identified, a helix containing that base pair is formed.where we use hats to denote the posterior pairing and unpairing probabilities obtained from the grammar. From a technical point of view, taking maximal probabilities in this way can be considered as a greedy approximation of the CYK algorithm (). In the framework of iterative helix formation, the statistic corresponding to MEA estimation is the expected difference in the number of correctly predicted base pairs after pairing bases i and j, i, j  b P paired i, j  1 2  b P unpaired i  b P unpaired j , 2
LocalJust as the difference in Equation (2) is naturally interpreted, by analogy with thermodynamic models, as a measure of the energy and, therefore, of the stability of a base pair, the corresponding base pairing probabilities can be considered as a measure of the time it takes for that base pair to form. If we approximate base pair formation as a continuous Markov process with rate equal to the posterior pairing probability, the time until helix formation has the exponential distribution with mean equal to the inverse of the posterior pairing probability. With this interpretation in mind, Equation (1) just expresses the pairing of bases in the physical order. At each iteration, a new helix containing i max , j max  and such that, for each base pair i, j in the helix, i, j40, is determined conditional on previously formed helices. By folding helices in one go, the fact that helices form quickly is taken into account. More helices are formed until i max , j max 5, for some threshold 40. MEA estimation hinges on the assumption that the posterior base pairing probabilities given by the grammatical model are equal to the probability that a given base pair is correct. In fact, small positive values of the difference in Equation (2) are not reliable; therefore, requiring 40 might be expected to increase the positive predictive value of the algorithm. From a more physical point of view, to additionally require i, j440 for the base pair i max , j max  is to incorporate the physics that once the first base pair is formed, nearby bases are more likely to pair. This local base pair needs to be 'strong' enough for its dissociation time to be long enough for other base pairs to form. This also addresses the issue of the geometric and, therefore, unphysical distribution of helix lengths in the grammar (). A remark on the evolutionary model. For alignments of sequences or subsequences with high-primary sequence conservation, the evolutionary might miss 'obvious' helices, as it introduces extra uncertainty. This is especially relevant in iterative helix formation because we only ever try to pair bases that have high-posterior pairing probabilities. For this reason, rather than using the evolutionary model as in Knudsen and Hein (2003), we use a mixed model: at the start, we form base pairs with very highposterior pairing probabilities using the simpler heuristic of just multiplying the base pairing probabilities for each sequence to obtain the previous base pairing probabilities and then switch to the full evolutionary model. The ability to mix different methods is strength of the iterative approach.
Bayesian weighting: the distance functionIn the model we have built up to this point, distinct columns and pairs of columns are, insofar as previous unpairing and pairing probabilities are concerned, assumed to be independent. This does not reflect biological fact, as interlacing structures prevent each other from forming, and a column cannot pair with two different columns at the same time. We note that this kind of crossing interaction may lead to pseudoknot formation. Standard SCFG approaches are unable to predict pseudoknots (): in standard MEA estimation, one hopes that the model predicts the more stable of the two interlacing structures. In the iterative framework, the extra information is used to address, more generally, the most obvious drawback of the iterative approach: once a helix that is incompatible with the correct structure has been formed, the final prediction is likely to be poor. From a kinetic perspective, base pairs frequently blocked by other transient base pairs would take longer to form, as the underlying continuous Markov process is only enabled during intervals where the base pair is not in conflict with other base pairs. To include these physical dependencies between columns in the model, we look to penalize the pairing of two columns if there exist columns between that are likely to form a base pair incompatible with these two columns. As standard SCFG approaches cannot model pseudoknots; here, 'incompatible' does not only refer to base pairs that share a position with these two columns but also to base pairs that would form a pseudoknot with these two columns. Thus, we discount the previous base pairing probabilities by an exponential factor based on a distance function, so that they take the formwhere s i denotes the ith column of the alignment, and where di, j is a distance function to be specified, K is a weighting parameter and $s i , s j  are the usual base pairing probabilities derived from an evolutionary model or the simple heuristic mentioned previously. We choose a distance function such that two columns are 'far away' from each other if there are columns between them that are likely to form a base pair incompatible with these two columns. Each intermediate column k, with i5k5j, is given a weight equal to the probability of that column forming a base pair incompatible with k  1, j.shows an example of the distance function on a partially folded structure. Formally, we define, for i j, di, j  0 i f i  j; d" {, j if i, " { pair and i " { j; i, j  di  1, j otherwise:For example, in, we calculate the distance between i and j, following Equation (4). We have di, j  i, j  di  1, j and di  1, j  i  1, j  di  2, j and so on. Further, dk, j  d " k, j, as k and " k are paired. Continuing, d " k  1, j   " k, j  d " k  1, j, and so on; finally, dj, j  0. Here, i, j is the probability that column i  1 forms a base pair that is incompatible with i, j, so that, the events in question being disjoint,Thus, the posterior pairing probabilities are used to guide the folding of the next iteration (and the posterior probabilities for the wholly unfolded sequence, without the exponential weighting factor, are used to calculate the distance function for the first iteration).. Representation of the distance function. The distance between two positions i and j in the sequence is the shortest distance moving along the structure, allowing shortcuts across stems. Intermediate positions are weighted with the probabilities of certain incompatible base pairs. Informally, this can be thought of as the shortest distance between two nodes of a weighted graph with edges between paired and adjacent positions. See text for further explanationThis completes the set-up of the kinetic folding algorithm. A summary of the algorithm is given as pseudocode in, which also shows the expressions for the insideoutside and posterior probabilities conditional on existing base pairs. As the distance function, as shown in, allows shortcuts across stems, this distance function implements the physics that, once a base pair has been formed, nearby bases are more likely to pair (). We note that the distance function imposes a certain hierarchy on substructures, making it more attractive to pair interior stems before pairing exterior ones. It is important to note the effect of the denominator Kjj  ij in the exponential factor in Equation (3): we do not penalize absolute distance between base pairing partners, but rather, the penalization is relative, comparing the probabilistic weights to the parameter K. From a more fundamental point of view, this is a Bayesian approach: the observed 'horizontal' relationships between the columns in the alignment are used to update the previous information from the evolutionary model, which evaluates the 'vertical' relationships between the sequences in the alignment. Thus, these two parts of the model complement each other.
DISCUSSIONSThe full kinetic model for RNA secondary prediction, Oxfold, was benchmarked against PPfold (SukosdSuko), a parallelized implementation of the Pfold model of). We also evaluate the performance of RNAalifold (), a thermodynamic model without evolutionary information. Benchmarking data and parameters. For benchmarking purposes, we have created a curated RNA dataset based on the Rfam database (). Alignments of homologous RNA sequences with their consensus secondary structure were extracted from among those Rfam seed alignments that bear the 'published' tag. From these, 50 alignments with at least 50 sequences were randomly selected. We note that random data selection ensures reliability of results. In a pre-filtering step, we discarded outlier sequences with many/long insertions and deletions from each family, using a similar approach to that of PPfold (SukosdSuko), which does not consider columns with 475% of gaps for pairing. Indels were first determined relative to a family consensus sequence; then a total mismatch score was calculated based on indel lengths; and sequences that had significantly larger mismatch score than the family mean were deleted. Further random selection was performed to reduce these to alignments of five sequences each; the results of) suggest that this suffices to take into account the evolutionary information. Because of the computational complexity of the model (which we discuss further in the text), we restricted to 41 alignments of length up to 214, with an average length of 105. The consensus secondary structures given in Rfam may be slightly different from the secondary structures that the individual sequences fold into. In this sense, we cannot say that our secondary structures are experimentally verified, but the approach of comparing predictions to these secondary structures is commonly used in analysis of comparative predictionmethods. As with all benchmarks of this nature (), this should be taken into account. It is known that grammar performance depends on datasets (). Consequently, it is important to monitor dataset dependence, in particular to avoid overfitting. For these reasons, the grammar parameters and evolutionary trees used for benchmarking purposes were those of PPfold. In particular, the grammar underlying our present approach is essentially the simple grammar for which Rivas et al. (2012) did not find evidence of overfitting. The other parameters were chosen heuristically: the parameter was set to 0.5 to make the first, local base pair stable enough for its dissociation time to be long enough for other base pairs to form. This is a trade-off between losing sensitivity at high values of and losing positive predictive value (PPV) at low values of. Similarly, K determines the amount of penalization by the distance function; setting K  0:5 leads to a maximum penalization of about one order of magnitude.Benchmarking statistics. We assess the performance of these models on a single alignment by calculating the sensitivity,respectively, for the sequences in the test dataset of 41 alignments. The outliers marked A and B are discussed in the text. Discussion of results. We note that Oxfold performs better, on average, than PPfold in terms of averaged sensitivity, PPV and F-score. Additionally, it has a higher F-score and PPV than RNAalifold, although the thermodynamic model has a higher sensitivity. In particular, we observe that Oxfold has a noticeably higher PPV than PPfold and RNAalifold. We also note that including an evolutionary model decreases the sensitivity of the algorithm, but greatly increases the PPV. Moreover, the distance function does not seem to be of much use without an evolutionary model. Both of these observations are compatible with the conclusion that the posterior probabilities without the evolutionary model are less reliable (in the sense that they somehow correlate with correctness) than those obtained with an evolutionary model. The fact that the iterative model without distance function, both with the mixed and the unmixed evolutionary model, has essentially the same PPV, gives further weight to this conclusion. Also, the model with evolutionary information, but without distance function, performs mildly better than PPfold. This is notable because this method is the iterative method applied to the standard PPfold model. By conditioning on known structure, the grammar model no longer has probability mass contributed from incompatible structures, which one might hope would lead to a better structure prediction. As PPfold and Oxfold share the same grammatical framework, outliers incan be attributed to the iterative method developed in this article. We discuss two such outliers, marked A and B in(see Supplementary Data for the corresponding predictions). In outlier A, the prediction cut-off is not met by a base pair predicted by PPfold, on which Oxfold terminates prediction (consequently, the PPVs are similar, but the sensitivity of PPfold is higher). By contrast, outlier B is an example of an alignment where Oxfold performs noticeably better than PPfold. Without the distance function, Oxfold has zero F-score on this alignment; with this distance function, the F-score rises to 0.5, illustrating how the distance function facilitates the prediction of correct base pairs. With the interpretation of the difference in Equation (2) as a measure of the stability of a base pair, and of the posterior pairing probabilities as a measure of the inverse time it takes to form a base pair (discussed in Section 2), the fact that this model works indicates that RNA folds a stable scaffold before less stable substructures with short dissociation times start to appear and disappear (rather than folding its functional secondary structure while such substructures appear and disappear).
CONCLUSIONSIn this article, we have incorporated kinetic effects into a grammatical model for RNA secondary structure prediction by iterative formation of helices and by taking into account of some relationships between columns of an alignment by means of a distance function. Conceptually, introducing a distance function is the analogue, at the level of the emission probabilities of the grammar, of including (albeit possibly different) information about the relationships between columns in the alignment by making the production rules of the grammar more complex. The performance of the kinetic model suggests that the dynamical aspects of RNA folding should not be disregarded in SCFG approaches to RNA secondary structure prediction. Incorporating co-transcriptional effects into the model might, therefore, be a possible next step: Kramer and Mills (1981) have shown that RNA folds as it is being transcribed, usually in the 5 0 3 0 direction. Thus, the 5 0-end of the RNA molecule is allowed to fold before the sequence has been entirely transcribed, resulting in intermediate structures that do not necessarily exist in the final functional structure, as the speed of stem formation greatly exceeds the speed of transcription (). Moreover, Meyer and MiklosMiklos (2004) have demonstrated 'with statistical significance that co-transcriptional folding strongly influences RNA sequences in two ways: (i) alternative helices that would compete with the formation of the functional structure during co-transcriptional folding are suppressed and (ii) the formation of transient structures that may serve as guidelines for the cotranscriptional folding pathway is encouraged '., for instance, have incorporated co-transcriptional effects into a thermodynamic model by using a genetic algorithm. Nevertheless, the fundamental problems affecting SCFG algorithms listed by Knudsen and Hein (1999) still remain much topical. Here, we discuss three issues of particular relevance to our algorithms: Pseudoknots. As mentioned previously, standard SCFG approaches cannot predict pseudoknots (). Leaving the framework of SCFGs, but still using a formal grammar, it is possible to predict pseudoknotted structures (). The iterative method presented in this article could be adapted to predict pseudoknots either by adapting the definition of permissible base pairs or by using the methods described by. Similarly, we would expect biophysical folding mechanisms to be conserved in pseudoknotted structures as in non-pseudoknotted structures. Computational complexity. Standard SCFG algorithms for RNA secondary structure prediction have computational complexity O' 3 , where ' is the sequence length (). Hence, the kinetic model presented in this article has complexity O' 4 , and a co-transcriptional algorithm along the lines of the algorithm of(i.e. folding longer and longer subsequences, starting at the 5 0-end) would have a complexity O' 5 , which makes the algorithms even more expensive than standard prediction approaches. Although it is straightforward, even intrinsic, to reuse computations for shorter subsequences in current methods for thermodynamic models, this may seem much more complex in a kinetic model, as the optimum pathway may completely change on the elongation of a subsequence. However, when the aim is to include co-transcriptional effects, it is not unreasonable to assume that relevant models can be formulated allowing algorithms with complexity lower than O' 5 . This matters especially for co-transcriptional folding, as one expects transcriptional effects to be stronger for longer sequences. Non-canonical base pairs. The existence of non-canonical base pairs is a possible complication in RNA secondary prediction, for long, correct helices with non-canonical base pairs may seem less attractive than short, yet spurious helices. This observation ties the non-canonical base pairs issue somewhat to the geometric, and, therefore, unphysical, distribution of the helix lengths in the grammar (). Here, we have addressed that issue by making the pairing of the first base pair of a helix more expensive than that of later pairs (as discussed in Section 2). The effect of more complex distributions of helix lengths has previously been studied by Dowell and Eddy (2004) and, who considered more complex grammars, allowing for stacking non-terminals in the grammar. Nonetheless, RNAalifold () does not allow non-canonical base pairs in its default settings, whereas PPfold (SukosdSuko) associates very low-pairing probabilities with non-canonical base pairs. Some gain in sensitivity might, therefore, be possible by allowing some non-canonical base pairs in pairs of alignment columns at low-probability cost, but more insight into the role of noncanonical base pairs (and a corresponding model) may well be required.
The Author 2013. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
Oxfold: kinetic folding with SCFGs at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
J.W.J.Anderson et al. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
