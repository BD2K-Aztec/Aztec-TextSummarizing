Motivation: Chromatin immunoprecipitation (ChIP) followed by high-throughput sequencing (ChIP-Seq) measures the genome-wide occupancy of transcription factors in vivo. Different combinations of DNA-binding protein occupancies may result in a gene being expressed in different tissues or at different developmental stages. To fully understand the functions of genes, it is essential to develop probabilistic models on multiple ChIP-Seq profiles to decipher the combinatorial regulatory mechanisms by multiple transcription factors. Results: In this work, we describe a probabilistic model (SignalSpider) to decipher the combinatorial binding events of multiple transcription factors. Comparing with similar existing methods, we found SignalSpider performs better in clustering promoter and enhancer regions. Notably, SignalSpider can learn higher-order combinatorial patterns from multiple ChIP-Seq profiles. We have applied SignalSpider on the normalized ChIP-Seq profiles from the ENCODE consortium and learned model instances. We observed different higher-order enrichment and depletion patterns across sets of proteins. Those clustering patterns are supported by Gene Ontology (GO) enrichment, evolutionary conservation and chromatin interaction enrichment, offering biological insights for further focused studies. We also proposed a specific enrichment map visualization method to reveal the genome-wide transcription factor combinatorial patterns from the models built, which extend our existing fine-scale knowledge on gene regulation to a genome-wide level. Availability and implementation: The matrix-algebra-optimized exe-cutables and source codes are available at the authors' websites:
INTRODUCTIONIn human and other eukaryotes, gene expression is regulated by the binding of various modulatory transcription factors (TF) onto cis-regulatory DNA elements near genes. Binding of different combinations of TFs may result in a gene being expressed in different tissues or at different developmental stages. To fully understand a gene's function in the cell, it is essential to identify the TFs that regulate the gene and their corresponding TF binding sites (TFBS) (). The techniques such as protein binding microarray (), microfluidic affinity analysis () and protein microarray assays () enable us to measure the DNA sequence binding of TFs in vitro. On the other hand, the technology of chromatin immunoprecipitation (ChIP) followed by microarray (ChIP-ChIP) or sequencing (ChIP-Seq) () can efficiently measure the binding occupancy of a particular TF on a genome-wide scale in vivo. In a typical ChIP-Seq study, the first step is to call the peaks, i.e. determining the precise location in the genome where the TF binds. A number of peak calling tools have been developed, but recent benchmark studies have shown that the peaks from those tools are often inconsistent (). Because multiple transcription factors often work in cis regulatory modules to confer complex gene regulatory programs, it is necessary to develop models on multiple ChIP-Seq datasets to decipher the combinatorial DNA-binding mechanism. In the following, we briefly review some of the previous works in this area. Gerstein et al. used pair-wise peak overlapping patterns to construct a human regulatory network (). Xie et al. proposed self-organizing map methods to visualize the colocalization of DNA-binding proteins (). Giannopoulou et al. proposed a non-negative matrix factorization to elucidate the clustering of DNA-binding proteins (). Zeng et al. proposed jMOSAiCS to discover histone modification patterns across multiple ChIP-Seq datasets (). Ferguson et al. have described a hierarchical Bayes approach to integrate multiple ChIP-Seq libraries to improve DNA binding event predictions. Mahony et al. also proposed a mixture model (MultiGPS) to detect differential binding enrichment of a DNA-binding protein in different cell lines, which can improve the protein's DNA binding location predictions (i.e. Cdx2 protein in their study) (). On the other hand, Chen et al. proposed a statistical framework (MM-ChIP) based on MACS to perform an integrative analysis of multiple ChIP datasets to predict ChIPenriched regions with known motifs for a given DNA-binding protein (i.e. ER and CTCF proteins in their study) (*To whom correspondence should be addressed.  The Author 2014. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com 2011). On the other hand, Ji et al. proposed a differential principal component analysis method on ChIP-Seq to perform unsupervised pattern discovery and statistical inference to identify differential proteinDNA interactions between two biological conditions (). Guo et al. described a generative probabilistic model (GEM) for high resolution DNA binding site discovery from ChIP data (). Interestingly, that model combines ChIP signals and DNA motif discovery together to achieve precise predictions of the DNA binding locations of a DNA-binding protein. The authors have further demonstrated how GEM can be applied to reveal spatially constrained transcription factor binding site pairs on a genome. Despite the success of the methods described above, to fully understand a gene's function, it is essential to develop probabilistic models on multiple ChIP-Seq profiles to decipher the genomewide combinatorial patterns of DNA-binding protein occupancy. Unfortunately, the majority of the previous work usually focused on large-scale clustering of called peaks, which is an intuitive and straightforward approach. However such approaches have two limitations, as (i) peak-calling ignores the contributions from weak bindings of TFs, and (ii) pair-wise analysis ignores the complex combinatorial binding pattern among the TFs. Here we propose a new approach to build fine-scale probabilistic models for directly analyzing multiple normalized ChIP-Seq signal profiles on all the promoter and enhancer regions quantitatively so that weak bindings can be taken into account (). Especially, its computational complexity has been carefully designed to scale well with the increasing ChIP-Seq data (i.e. linear complexity). After model training, we can extract and reveal the high-order combinatorial and quantitative occurrence patterns from the trained probabilistic models for better understandings on the DNA-binding protein combinatorics.
METHODS
Overall approachWe propose and describe a probabilistic three-layered model called SignalSpider to model the binding mechanisms of DNA-binding proteins across different genomic regions as depicted in. Because it is generally believed that a genome can be clustered into different types of regions (), we have put a clustering layer to cluster the genome regions into different types at the top (fx t g). After the clustering, we model that different DNA-binding proteins can be found on each type of region. Thus, we put a binding mode layer in the middle to represent the binding modes of each DNA-binding protein (fb t j g). For example, if b t j =1 (or 0), it means the j-th protein binds (or does not bind) to the t-th region. In particular, we note that b t j can have more than two binding modes here (e.g. b t j 2 f0; 1; 2g) to account for partial binding modes (). Based on each binding mode of each DNA-binding protein at the middle layer (fb t j g), we assume a Gaussian distribution for its observed ChIP-Seq profile signal (fs t j g) at the bottom layer. We note that such a hierarchical structure is welljustified in most gene regulation contexts. For example, its hierarchy is similar to those of iASeq () and CorMotif () but in different contexts. SignalSpider aims at modeling and extracting genome-wide combinatorial patterns from the normalized ChIPSeq profile signals of DNA-binding proteins; iASeq aims at inferring allele-specificity probabilities of proteinDNA binding sites from ChIP-Seq read counts; CorMotif aims at modeling the t-statistics of genes' differential expression.
Model descriptionMathematically, SignalSpider is a mixture model with a three-layer hierarchy as depicted in. The main function of SignalSpider is to extract patterns from multiple signal profiles by estimating the combinatorial interaction between the top layer cluster and the middle layer signal components. For tth region, the bottom layer is to represent the observed signals fs t 1 ; s t 2 ;. .. ; s t M g across M profiles directly. We empirically observe that the normalized ENCODE ChIP-Seq profile signals (after taking natural logarithm) always follow continuous Gaussian mixture distributions. Thus, we model each profile to follow the generation of one dimensional Gaussian mixture distribution with N components, where the hidden discrete variable b t j represents the component that is used to generate signal s t j. The top layer is the cluster layer consisting of K clusters. Each cluster influences the middle layer components used for generating signals via a discrete function. The hidden discrete variable x t represents which cluster is used. Mathematically, a SignalSpider Model can be defined as SS =f i g; f ijk g; f jk ; jk g:
.. ; Ngwhere i =Px t =i is the prior probability of top layer ith cluster. ijk = Pb t j =kjx t =i is the conditional probability of the kth middle layer component, given that the current top layer cluster is the ith one, for the jth signal profile.  jk ; jk  are the Gaussian mean and variance of the jth signal profile, given that its middle layer component is the kth one. In essence, it is a Bayesian network in which complete data likelihood can be written as: L=
Model buildingBy taking partial derivatives to the expected complete data likelihood Elog L (plus adding Lagrange multipliers to the probability sum to one constraints) with respect to parameters to zero, we can derive the expectation maximization method (details can be found in Supplementary Data).Briefly, all the model parameters f i g; f ijk g; f jk ; jk g are randomly initialized at the beginning. E-step and M-step are then alternated and repeated until the percentage of changes in the model parameters is numerically negligible (i.e. 50:001%). Multiple runs are used to avoid local optima.
Complexity analysisThe prior probability of top layer ith cluster f i g is O(K). The conditional probability of the jth signal profile being in its kth middle layer component, given that the current top layer cluster is the ith one f ijk g, is O(KMN). The Gaussian mean and variance of the kth middle layer component for the jth signal profile f jk ; jk g is O(MN). Limited by the parameters between top layer and middle layer (i.e. f ijk g), the overall model complexity is O(KMN). On the other hand, the overall time complexity of each iteration of the expectation maximization method is O(KMNT) because it is limited by computing the posterior probabilities of hidden variables fpx t =i; b t j =kjD; g in the E-step, although we can pre-compute all the numerators before summing them up to obtain the denominators for speedup. In other words, its model complexity and building time complexity are both linear to the input data size. It can scale well with the increasing ChIP-Seq datasets.
RESULTS
Data sourcesThe primary data sources are the normalized ChIP-Seq signal profiles processed from the ENCODE consortium (ENCODE, 2012). They have been normalized by replicate aggregation and kernel smoothing by Wiggler (). In particular, we have downloaded all the available normalized ChIP-Seq signal profiles in the K562 cell line. For illustrative purpose, some of the ChIP-Seq normalized signal profiles for E2F4, CFOS, GATA2, JUNB and TBP are plotted in Supplementary. From the figure, we can observe that the signal magnitude and variation are quite different among the profiles. It is challenging to extract any combinatorial pattern of the signal profiles by naive methods.In particular, we limit our study to the human genome (hg19) regions designated as 'Promoter' or 'Enhancer' regions by both ChromHMM and Segway at 1000 base pairs resolution (). Maximal normalized ChIP-Seq signals are taken at those regions; natural logarithm has also been taken for efficient Gaussian modeling.
Tests on simulated ChIP-Seq profiles3.2.1 Performance comparison To verify the robustness of SignalSpider, we seek to compare it with ChromHMM () and jMOSAiCS () on their genome clustering abilities in different parameter settings. We would like to note that, in addition to its ability to cluster genome regions, SignalSipider can also extract higher-order binding patterns among the DNA-binding proteins of interests from their ChIP-Seq data. Such ability is useful for interpreting the combinatorial transcription factor binding patterns encoded in multiple ENCODE ChIP-Seq data. It will be shown in the following section. We have generated simulated data based on ENCODE ChIPSeq data properties. In particular, the number of data (T) was set to the same size as in the following section (i.e. T = 92, 485); the number of clusters (K) was selected from f2; 3;. .. ; 10g; the number of profiles (M) was selected from f3; 4; 5; 10g to reflect the usual clique sizes in the following section; the number of ChIP-Seq signal components of each DNA-binding protein (N) was set to 2 to accommodate the binary clustering nature of ChromHMM and jMOSAiCS (although SignalSpider can handle 3 or more in this aspect). For the means and variance of each simulated profile, we randomly paired it with an actual profile in the ENCODE ChIP-Seq data. For the actual profile paired, we fitted a one dimensional Gaussian mixture model on it with N components in 10 replicates because we observed Gaussian mixtures fit well to the actual ChIP-Seq normalized profile data after taking natural logarithm. The fitted model with the highest likelihood was then used as the basis for the simulated profile paired. By doing all the above, we obtainedsimulated datasets with known cluster labels in different parameter settings. For each parameter setting, we generated 10 datasets. For each dataset, we ran SignalSpider, ChromHMM and jMOSAiCS on it with the corresponding parameter setting. Ten random runs with random initialization were used for SignalSpider and ChromHMM for each dataset. The run with the highest likelihood was taken as the final model for both SignalSpider and ChromHMM on each dataset. The convergence graphs are shown in the Supplementary Data. In summary, it can be observed that SignalSpider converges within 20 iterations for most cases. For example, the convergence graph for the 10 runs with the setting K = 10 and M = 10 is depicted in Supplementary. For each dataset, we evaluate the clustering ability of each method based on two metrics: Rand Statistics (RS) () and Purity (). Rand Statistics is based on the intra-cluster similarity and inter-cluster dissimilarity. For the intra-cluster similarity, if a pair of data vectors is in the same cluster in both the target result and the clustering result, then the score will be increased by one. For the inter-cluster dissimilarity, if a pair of vectors is in different clusters in both the target result and the clustering result, then the score will also be increased by one. On the contrary, if a pair of data vectors is in the same cluster in the target result, but not in the clustering result, the score will not be increased. After we have checked all the possible pairs, the score is normalized by the total number of possible pairs. On the other hand, purity solely measures the intra-cluster similarity. Nevertheless, it is useful in the sense that we only care about the quality of individual clusters. Their mathematical definitions can be found in Supplementary Data. The results are depicted in. It can be observed that SignalSpider has a better performance than ChromHMM and jMOSAiCS on the given datasets. We reason that it is because ChromHMM and jMOSAiCS involve peak-calling, ignoring the weak DNA-binding events.
Sensitivity analysison cluster prior probabilities It has been reported that weak clusters may be absorbed into strong clusters during a clustering process (). To examine its effect, we have conducted a sensitivity analysis on cluster prior probabilities under two simulations (Scenario 1 and 2; details can be found in Supplementary Data). Briefly, for each simulation, we examine how often a weak cluster (with low prior cluster probability) can be discovered in the presence of another weak cluster and a strong cluster (with high prior cluster probability) in 100 random runs. From the simulations, it can be observed that weak clusters are more difficult to be discovered than strong clusters because weak clusters tend to be merged into a discovered strong cluster. Nonetheless, from the results, we can observe that such phenomenon is not severe (e.g. 470% discovery rate for clusters with 0.2 prior probabilities or higher). Multiple runs of SignalSpider with different initializations can be adopted to circumvent such problems.
Complex pattern discoveryTo demonstrate the higher-order (beyond pair-wise) pattern discovery of SignalSpider, the available proteinprotein pair-wise interaction data is used as the basis so that we don't have to enumerate all the possible sets which are computationally infeasible.
Data acquisitionFor the DNA-binding proteins we have identified from the ENCODE ChIP-Seq data, we mapped them onto the BioGRID proteinprotein interaction database (). Based on the network mapped, we extract the maximal cliques with k = 3 (). Note that maximal cliques are defined as the cliques with at least three nodes which subgraphs are also cliques. By choosing k = 3, we ensure that the output cliques have at least three nodes for discovering higher-order combinatorial patterns on at least three profiles (beyond pair-wise patterns on two profiles which have already been given from BioGRID). The clique list is shown Supplementary Table S1.
Model buildingFor each clique, we trained SignalSpider on the ChIP-Seq signal profiles of the corresponding DNA binding proteins belonging to the clique. In the parameter settings,. From the figure, we can observe that SignalSpider can model the signal distributions precisely. Another practical aspect of SignalSpider is its soft clustering ability. We can verify its modeling by looking at the top layer cluster probabilities Px t  as shown in. From the figure, we can observe that the profiles are well clustered by SignalSpider into different combinations according to their signal values.
Higher-order combinatorial pattern discoveryIn particular, we are interested in the patterns enriched in each clique model. Thus, we calculated the fold enrichment for each ChIPSeq signal component in each cluster Pb j =kjx=i, comparing to its own marginal occurring probability Pb j =k. Mathematically, it is calculated as:where FOLD ijk is the fold enrichment value for the kth ChIP-Seq signal component of the jth DNA-binding protein in the ith cluster. To visualize all the clique models, we have plotted the enrichment maps with full discussions in Supplementary Data. Representative examples are discussed and depicted in. For Clique 1, we observe the prominent co-occurrence of CJUN, GTF2FB, P300 and TBP in 14% of genomic ChIP-Seq signal regions. These proteins are known to be part of the preinitiation complex (PIC) for initiating gene transcription as shown inof. On the other hand, GTF2B and TBP are further found to be co-associative in another 25% genomic regions, which provides genome-wide evidence on their direct binding as revealed by a recent PIC crystal structure study (). For Clique 11, we can observe there is a strong enriched co-occurrence pattern between SIN3A, SP1 and CEBPB. It has been shown in a previous study that SIN3A forms complexes with p53 and HDAC1 to repress the ERalpha promoter on which SP1 and the CCAAT binding site bound by CEBPB are found. Our model provides additional genome-wide evidence for such interactions (). For Clique 13, we observe the same PIC pattern as in clique 1. Notably, Clique 13 reveals more details in the formation of PIC than clique 1. For instance, TAF1 and TBP show a strong co-association pattern because both of them are part of Transcription factor II D (TFIID). On the other hand, GTF2F1 is part of Transcription factor II F (TFIIF). TFIID and TFIIF are known to form the RNA polymerase II preinitiation complex with other transcription factors (including CJUN) to initialize gene transcription, inducing the co-occurrence pattern observed by our model (). For Clique 18, we observe that TBP shows enriched occurrence in 22% of ChIP-Seq signal regions. It is consistent with the estimate that around 24% of human genes contain a TATA box within the core promoter (). Among those, as suggested by the co-occurrence pattern, half of them are associated with the activating protein-1 (AP-1) which is composed of FOSL1 and activated by BCL3 (). For Clique 28, we observe different pair-wise co-occurrence patterns of SRF, BRG1 and CEBPB. It is expected since each pair of them is shown to work in different tissues. For instance, SRF and BRG1 are shown in complex to regulate muscle-specific gene expression (); BRG1 and CEBPB are shown to interact for regulating the beta-and gamma-casein promoters (); SRF and CEBPB are demonstrated to regulate the serum response element (). For Clique 29, we observe that P300 co-occurs with USF1 and USF2. In the former study by Huang et al., it was shown that the USF family can recruit histone modification complexes including P300 for maintaining chromatin barriers (). Taken it together with our results, it suggests that such process may be prevalent across the genome. For Clique 30, we observe that YY1, P300 and JUNB co-occur in 31% of ChIP-Seq regions. Independent of this study, Wang et al. have proposed a model explaining their co-occurrence (). In that model, YY1 binds to the promoter region of the gene HLJ1 while AP-1 (which is(c), the grey scheme represents ChIP-Seq signal values while the colour scheme indicates the cluster index x t. For panels (b) and (d), the vertical height represents each cluster probability while the colour scheme indicates the cluster index x t. The clustering probabilities Px t  are calculated by computing belief propagation (sum product algorithm) from the leaves to the root of the graph topology which is outlined in. The horizontal region order (from left to right) of the panels is sorted by the ascending cluster index i which is determined by arg max i Px t =i for all bins (i.e. 8 t 2 f1; 2;. .. ; Tg composed of JUNB) binds to the enhancer region of the same gene. P300 is used to mediate the interaction between YY1 and AP-1 through DNA bending or looping mechanisms. Such a local mechanism supports the biological validity of our results. On the other hand, our results provide genome-wide evidences on them. For Clique 34, we observe that JUNB is more enriched with P300 than CEBPB. It is interesting because P300 and CEBPB have similar structures and functions as gene activators via acetylating histones and recruiting other transcription factors (). Taken together with our results, it suggests that P300 is preferred more by JUNB to interact than CEBPB although P300 and CEBPB are functionally similar on a genome-wide basis.
Comparison with jMOSAiCsWe have run jMOSAiCS () (with its default setting) on the same clique datasets. The enrichment patterns discovered by jMOSAiCS are depicted in Supplementary Figures S7 and S8. In general, we observe that the patterns discovered by SignalSpider are largely consistent with those discovered by jMOSAiCS. However, the patterns discovered by SignalSpider are more informative than those by jMOSAiCS according to the enrichment analysis because SignalSpider can consider the ChIP-Seq signal contributions from weak bindings of TFs. For instance, the weak bindings of the P300 protein can be quantitatively revealed by SignalSpider as depicted in Supplementary Figures S7 and S8. In addition, SignalSpider can learn the depletion patterns which most existing methods are difficult to capture.
Gene ontology enrichment analysisFor each cluster in each clique, we ran Gene Ontology (GO) enrichment analysis using Fisher's test. For each promoter or enhancer region, we take the gene within 1000 bp downstream as the target gene. Different statistical significant GO terms (Biological Process) are found for each cluster (Supplementary Data). For example, for Clique 1, we observed that the GO term 'cellular response to external stimulus' (GO:0071496) is statistically enriched (P = 0.00028) for the cluster 3 regions (with enrichment of CJUN) but not in cluster 2 regions (without enrichment of CJUN). It is consistent with the known functional role of CJUN which binds with CFOS to form the AP-1 early response transcription factor (). More examples can be found in Supplementary Data.
Evolutionary conservation enrichment analysisFor each cluster in each clique, we checked their conservation using PhastCons with other 99 vertebrate genomes (phastCons100way) (). For each cluster, we computed the mean of the PhastCons scores across its regions. Interestingly, we can observe that, if a cluster involves enriched co-occurrence of at least three proteins (active cluster regions), it is usually more conserved than the background (i.e. all the regions we have considered in this study). Their statistical significances (P-values) are justified by both Wilcoxon rank sum test and t-test (P50.0001). Examples are depicted in. Complete results can be found in Supplementary Data.
Chromatin interaction enrichment analysisWe next investigated whether the regions in each clique are more likely to form three-dimensional chromatin interactions inside the K562 cell nuclei. We downloaded and extracted the K562 high-confidence Hi-C interaction data from Fit-Hi-C (). To accommodate the Hi-C data resolution, each interaction region midpoint is extended to 50 000 bp in both directions. We set a qvalue threshold to 0.05, resulting in 37 893 very high-confidence chromatin interactions (shown in Supplementary Data) amongcluster, we check whether it belongs to those 37 893 very high-confidence chromatin interactions. Interestingly, we found that those active clusters in the last paragraph are also enriched in Hi-C interaction pairs. For instance, all the clusters shown inare enriched for Hi-C chromatin interactions using Fisher exact test (P50.0001). Details can be found in Supplementary Data.
Revealing DNA-binding protein machineriesBecause SignalSpider is linear in complexity, we have built a SignalSpider model on all the ChIP-Seq profiles studied here using 100 cluster indices with 2 binding modes. The cluster centroids are depicted in Supplementary. We observe that SignalSpider can reveal different DNA-binding protein machineries across different regions. For example, we observe that the chromatin structure protein profiles (e.g. CTCF) are well-separated from the other clusters, and thus consistent with their insulator roles.
DISCUSSIONWith the prevalence of ChIP-Seq technology, massive ChIPSeq data have been accumulated. The current ChIP-Seq data analysis studies usually involve single profile peak calling. Two areas of improvement are currently being explored in the field: how to integrate binding profiles of multiple transcription factors and how to include the signals from the areas that are not called as peaks. In light of that, we have developed a probabilistic model to analyse multiple ChIP-Seq signal profiles directly. The model (SignalSpider) not only can cluster genome into several region types, but also can extract subtle binding combinations from multiple DNA-binding proteins. The results show that the proposed model demonstrated performance better than the other existing methods on the simulated data derived from the available ChIP-Seq dataset. With the support of GO enrichment analysis, evolutionary conservation, chromatin interaction enrichment analysis and available wet-lab studies, we found that the discovered patterns show significant genome-wide insights. In particular, the patterns indicate that the genome-wide DNA-binding protein occurrence patterns are far from simple co-associative pair-wise interactions. Instead, we observed different higher-order enrichment and depletion patterns across different proteins. With increasing available ChIP-Seq data, we envision that SignalSpider will be useful in understanding the genome-wide DNA-binding dynamics.. Examples of conserved regions. The vertical axis is the conservation (PhastCons scores), while the horizontal axis denotes two regions. The left boxes correspond to the cluster regions of interest, while the right boxes denote the background region. Outliers are omitted. P-values for Wilcoxon rank sum test and t-test are shown at the title
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
K.-C.Wong et al. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
SignalSpider at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
