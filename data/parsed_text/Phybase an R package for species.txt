Motivation: Phybase is an R package for phylogenetic analysis using species trees. It provides functions to read, write, manipulate, simulate, estimate, summarize and plot species trees, which contain not only the topology and branch lengths but also population sizes. Availability: The Phybase package is available at the R repository. The manual and supporting materials including source code, sample R code and sample data files for the species tree analysis are available at
INTRODUCTIONSpecies trees are the fundamental tools in studying biodiversity and evolutionary history. It has been appreciated that phylogenies of genes (gene trees) are distinct from phylogenies of species (species trees) (). However, most phylogenetic programs are designed for estimation of gene trees and lack functions to perform species tree analysis. As an example, when species trees are recorded as modified Newick files, the population size parameter () in the species tree is not readable by most phylogenetic programs including PAUP (), PHYLIP () and MrBayes (), making it difficult to summarize species trees in these phylogenetic programs. It is desirable to have a phylogenetic program that can provide functions necessary for the analysis of species trees. Phybase is an R package designed specifically for species tree analysis, although it is also capable of analyzing gene trees. It provides functions to read, write, manipulate, simulate, estimate and summarize species trees. The input/output functions in the package can read and write DNA sequences and phylogenetic trees (gene trees and species trees) in the Newick format. Phylogenetic trees are read in as a string and then transformed to a matrix, which describes the ancestral relationships of nodes and branch lengths. The nodes matrix provides an easy access for developers to further manipulate the tree, while the tree string provides a useful interface to other phylogenetic packages in R such as the package APE (). Basic functions are available in the package to manipulate phylogenetic trees including deleting and swapping nodes, rooting and unrooting trees. Phybase includes functions to summarize collections of species trees such as those that arise from bootstrap analysis or the posterior distribution * To whom correspondence should be addressed.in Bayesian analysis of species trees (). Phybase is able to simulate DNA sequences from a prespecified species tree. Gene trees can be generated from a species tree under the coalescent model (), which assumes a molecular clock for gene trees and the species tree. Alternatively, gene trees can be generated from a non-clock-like species tree which allows variable mutation rates along the branches (populations) in the species tree (). The variable mutation rate is most likely due to changes in generation time as well as changes to the overall rate of mutation along the branches (populations) in the species tree. Phybase has functions to generate DNA sequences from gene trees under a variety of substitution models (). The species tree can be simulated from another phylogenetic package PhySim in R.
A PHYBASE APPLICATION: COMPARING THE PERFORMANCE OF THE STAR METHOD WITH CONCATENATION IN ESTIMATING SPECIES TREESAs an example of the utility of Phybase, we used Phybase to simulate DNA sequences from a 5-taxon species tree (). For simplicity, we assume a constant population size across all populations in the species tree. The population size and branch lengths in the species tree are in mutation units. The population size is set to be 0.001, 0.003, 0.005 and 0.007 to investigate the effect of the population size on the performance of STAR () and concatenation () in estimating species trees. We generated 10 gene trees from the species tree (an allele per species) under the coalescent model (). DNA sequences ofPage: 963 962963
Phybase500 bp were generated from the 10 gene trees with the HKY model (). The simulated DNA sequences were then treated as data to estimate the species tree using the concatenation and STAR methods. Phybase does not have functions to calculate maximum likelihood (ML) gene trees. For the STAR method, we used the phylogenetics program PhyML () to estimate ML gene trees without a molecular clock. We do not need to estimate coalescence times in gene trees, because STAR estimates species trees on the basis of the ranks of coalescence times. The simulation was repeated 1000 times. The performance of STAR or concatenation is measured by the proportion of trials yielding the true species tree. According to coalescent theory, the proportion of gene trees matching the species tree decreases as the population size increases. Higher proportion of gene trees matching the species tree implies that it is easier to recover the true species tree. Thus, we expect that the proportion of trials yielding the true species tree for both methods will increase as the population size decreases. The results of the simulation agree with our expectation, showing that both methods perform better as the population size decreases (). In addition, the results indicate that concatenation outperforms STAR at the population sizes 0.001 and 0.003, while STAR outperforms concatenation at the population sizes 0.005 and 0.007. For the population size 0.007, 110 and 160 genes are required, respectively, for STAR and concatenation to successfully recover the true species tree for all trials. Since the concatenation method assumes concordant gene trees, it may perform poorly for the cases when the concordant gene trees assumption is seriously violated (). This explains the poor performance of concatenation when the population size is equal to 0.005 and 0.007, and the corresponding proportions of concordant gene trees are 0.124 and 0.089. In contrast, concatenation performs well when the population size is 0.001 and the corresponding proportion of concordant gene trees is 0.717. This simulation study suggests that the concatenation method for estimating species trees is suitable for the cases when the majority of gene trees are similar to each other, although we expect the confidence in the tree generated by concatenation to be inflated nonetheless (). If the data indicate highly incongruent gene trees, the STAR method may be more appropriate than concatenation for the species tree estimation.
CONCLUSIONPhybase is available under the GNU General Public License (GPL). As an R package, Phybase inherits the open source nature of R.We invite others to continue to contribute phylogenetics inference packages in the R framework.
The Author 2010. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oxfordjournals.org at :: on August 31, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
at :: on August 31, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
