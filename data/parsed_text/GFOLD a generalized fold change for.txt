Motivation: RNA-seq has been widely used in transcriptome analysis to effectively measure gene expression levels. Although sequencing costs are rapidly decreasing, almost 70% of all the human RNA-seq samples in the gene expression omnibus do not have biological rep-licates and more unreplicated RNA-seq data were published than replicated RNA-seq data in 2011. Despite the large amount of single replicate studies, there is currently no satisfactory method for detecting differentially expressed genes when only a single biological repli-cate is available. Results: We present the GFOLD (generalized fold change) algorithm to produce biologically meaningful rankings of differentially expressed genes from RNA-seq data. GFOLD assigns reliable statistics for expression changes based on the posterior distribution of log fold change. In this way, GFOLD overcomes the shortcomings of P-value and fold change calculated by existing RNA-seq analysis methods and gives more stable and biological meaningful gene rankings when only a single biological replicate is available. Availability: The open source C/Cþþ program is available at
INTRODUCTIONIn RNA-seq, high-throughput sequencing is applied to transcriptome analysis to effectively measure gene expression levels, identify alternative splicing variants and reconstruct novel or fusion transcripts. Since the first publications in a series of studies in 2008 (), RNA-seq has quickly gained popularity for use in transcriptome analysis (). One fundamental use of transcriptome analysis is to measure the level of gene expression and to identify genes that are differentially expressed between conditions. For this purpose, RNA-seq produces gene expression profiles with much smaller technical variance () than traditional microarray technologies. Specifically, in a typical RNA-seq experiment, millions of short reads are sampled from expressed transcripts and the expression level of a gene is then measured by the number of reads mapped back to this gene. The variance in the read count of a gene may be decomposed into the variance due to the random sampling of reads and the variance due to other sources of variation including technical and biological noise. The variance due to read sampling can be closely approximated by a Poisson distribution (), which serves as the lower bound on the overall variance. When biological variance is taken into consideration, the number of reads mapped to a gene should resemble an over-dispersed Poisson distribution. A natural distribution for modeling over-dispersed count data is the negative binomial (NB) distribution, which has been applied to build tools such as edgeR (), DESeq () and baySeq (). Models other than the NB have also been developed. For example,built a tool, referred to as ASC, based on the observation that log fold changes obey the normal distribution. The same assumption has also been adopted byproposed an MA-based method that approximates the distribution of the M value (log fold change) at given A value (log intensity sum) with a normal distribution. Srivastava and Chen (2010) adopted a two-parameter, generalized Poisson model to fit the nucleotide-wise read distribution on each gene independently. Cufflinks () adopts the delta method, a commonly used method in microarray expression analysis, to estimate the variance of the log fold change. When comparing RNA-seq data between two conditions, existing methods calculate a P-value for the differential expression of each gene. These P-values, however, do not measure how much a gene is expressed in one condition relative to the other. Highly significant P-values can result from even miniscule relative differences in gene expression, if the number of sequencing tags available for the comparison is large enough. This type of result is contrary to what is of fundamental biological interest. In most studies of gene expression, the genes of highest interest are those with large relative differences. The relative difference, or fold change, is a basic and widely used measure for identifying differential gene expression. Unfortunately, the raw fold change is unreliable because it does not take into account the uncertainty of gene expression measures under the two conditions being compared. In particular, the fold changes of genes with low read counts are less reliable than those of genes with high read counts. In other words, fold changes based on read counts are not comparable for genes with different expression levels or genes of different lengths. In microarray analysis, a well-known variance stabilization method is fold change with offset (or start-log) (), which adds an offset before calculating fold changes. Researchers have also attempted to combine the fold change and P-value to provide more meaningful results by setting cutoffs for both the fold change and P-value as in the well-known volcano plot (). However, such an ad hoc technique does not result in meaningful gene rankings. Although sequencing costs are rapidly decreasing, experimentalists are reluctant to sequence replicate RNA samples without pilot data that demonstrate the utility of the study. By comparing single RNA-seq treatment samples from control conditions, experimentalists can obtain valuable information that allows them to adjust the experimental plan before scaling up to include multiple replicates. That may partially explain why almost 70% of all the human RNA-seq samples in the gene expression omnibus () do not have biological replicates and more un-replicated RNA-seq data were published than replicated RNA-seq data in 2011 (Supplementary). Despite the importance of single replicate studies, there is currently no satisfactory method for detecting differentially expressed genes when only a single biological replicate is available. In this article, we describe a technique for estimating fold change that takes into account the uncertainty of gene expression measurement by RNA-seq. We argue that this new measure of fold change is more informative for the biology of a perturbed system than either P-values or raw fold change especially for single biological replicate experiments. From a Bayesian perspective, our representation of fold change is derived from the posterior distribution of the raw fold change. This representation, denoted as GFOLD, balances the estimated degree of change with the significance of this change. GFOLD is more reliable than raw fold change for estimating the relative difference of gene expression and facilitates the comparison of genes with different expression levels or of different lengths. To validate its effectiveness, we applied GFOLD to several datasets with biological replicates and compared it with edgeR, DESeq, DEGseq, Poisson, Cufflinks and fold change with offset. By comparing the results of different methods when biological replicates are not available with the results when biological replicates are available, we were be able to estimate the performance of different methods using information from single replicates. We also explored the biological significance of gene rankings produced using different methods. Comparisons show that GFOLD outperforms all other methods in most cases when there is only a single replicate. We built a hierarchical model for cases in which biological replicates are available. In such cases, GFOLD provides comparable results to existing methods.
METHODSWe describe the single-replicate model in the main text and leave the multiple-replicate model in the supplementary. Because the technical variance of RNA-seq is negligible (), the read count of a gene can be effectively modeled by the Poisson distribution (). Specifically, the probability of observing k short reads associated with a gene is as follows:, n is a normalization constant reflecting the sequencing depth and l is the gene length. The method proposed by Anders and Huber () was used to calculate n. If this method fails, we simply treat n as the library size (sequencing depth). The observed read count k is based on the expression level x, which is actually what we want to measure. From a Bayesian point of view, and therefore x can be treated as random variables, and the posterior distribution of is defined bywhich is a gamma distribution with shape k  1 and scale 1. Here, the uniform distribution is used as the prior for. For a gene, given the observed read counts under two conditions, the posterior distribution of expression levels x 1 and x 2 under the two conditions can be calculated as above. Furthermore, the posterior distribution of log2 fold change log 2 x 2 =x 1  can also be calculated. Note that the calculation involves l, which can be avoided by calculating the posterior distribution of y i  l  x i , i 2 f1, 2g and z  log 2 y 2 =y 1  instead. It is obvious that log 2 y 2 =y 1  and log 2 x 2 =x 1  have the same distribution. To utilize the variance information of the posterior distribution of fold change, we define the generalized fold change of a gene as follows:GFOLDc  maxt, 0jP Z z t  c, if meanZ ! 0 mint, 0jP Z z ! t  c, if meanZ50 3 where P Z is the posterior distribution of z  log 2 y 2 =y 1  and c is a parameter with default parameter 0.01. If the gene is up-regulated, i.e. meanZ ! 0, the probability of the log2 fold change (2nd/1st) being larger than t is 1  c. In this case, t is less than meanZ with default value of c. GFOLD(c) takes maxt, 0 to truncate negative t to zero. If GFOLD(c) is 0, then the expression level of this gene does not show significant change. The case for meanZ50 is symmetric to the case of meanZ ! 0. Genes can be ranked by their GFOLD values in descending order such that top ranked ones are differentially up-regulated and bottom ranked ones are differentially down-regulated.shows examples of the posterior distributions of log2 fold change and the calculated GFOLD values for three up-regulated genes. The figure also compared the gene rankings based on the naive read count fold change, GFOLD value and P-value for the three genes. According to the P-value we would consider the black gene to be the most significant one, followed by green then red. The ranking of black above green is problematic because the true fold change of the green gene is very likely to be much greater than that of the black. If we used the naive fold change to rank genes, green would be the most significant one, followed by red then black. Although the red gene has a greater naive fold change than the black gene, the read counts for the red gene are low and the estimate of fold change is unreliable. GFOLD strikes a balance between fold change and P-value, ranking green first, followed by black and then red. GFOLD not only measures the fold change but also captures the small variance of the posterior distribution of log2 fold change for the highly expressed genes. If the fold change based on the read count is fixed and c 5 0.5, then GFOLD(c) penalizes genes with low expression levels because the posterior distribution of the fold change from such genes has a large variance. This trend is clearly demonstrated in. Setting c to a smaller value shifts the preference from genes with higher fold changes at lower expression values to genes with lower fold changes at higher expression levels. By default, we set c  0.01, which means that in 99% of cases, the fold change of a gene is above the absolute GFOLD(0.01) value for this gene. To better understand the properties of the posterior distribution of fold change and GFOLD, we compared several posterior distributions of fold change with normal distributions in Supplementary. When read counts are high, the posterior distributions of fold change are similar to normal distributions; but the similarity disappears when read counts are low. It might be possible to describe the posterior distribution of log2 fold change with a closed-form formula based on the distribution of the ratio of two gamma variables (). However, the close form calculation is too time consuming to be practical because it involves the inverse of the distribution function. Therefore, in this work, the calculation is done by sampling. Specifically, we first sample y i  l  x i , i 2 f1, 2g according to Equation (2), then estimate the posterior distribution of z  logy 2 =y 1  based on sampled values of y i , i 2 f1, 2g, and last calculate GFOLD(c) according to Equation (3). The whole process is very efficient. For example, to calculate GFOLD values for all the genes given a pair of samples used in this work, it costs less than 30 s on a typical desktop PC.
APPLICATIONS
DatasetsWe assessed the effectiveness of our approach on the following five publicly available RNA-seq and GRO-seq datasets that contain biological replicates. For each dataset, we merged technical replicates to form a single biological replicate. The five datasets are as follows: human brain dataset downloaded from DDBJ () with accession number SRA009447, mouse brain dataset () downloaded from DDBJ with accession number SRA030347, Type I latency B-cell line dataset () downloaded from DDBJ with accession number SRP001880, ENCODE dataset () downloaded from UCSC Genome Browser () and estrogen response dataset containing GRO-seq data () and ERa-binding data (). The detailed description of each dataset is in the Supplementary Material.
Methods comparedIn the following comparison, we compared GFOLD with the following methods: edgeR (), DESeq (), Cufflinks (), DEGseq (), Poisson test and fold change with offset. Because GFOLD value depends on the cutoff c, we use GFOLDX to denote GFOLD with c  X/1000 (i.e. GFOLD10 means cutoff 0.01). The method edgeR has an option of whether to estimate the tag-wise dispersion. We denote the version of edgeR that estimates tag-wise dispersion as edgeRT. For DEGseq, there are two MA-based methods: MA-plot-based method with Random Sampling model (MARS) and MA-plotbased method with Technical Replicates (MATR). MARS deals with replicates by summing up read counts for every gene and then treating the data as if there were no replicates, whereas MATR estimates the variance based on replicates. When replicates were available we found the MATR results to be less accurate than those produced by MARS (results now shown); therefore, we used MARS method for DEGseq. Because Poisson test (Poisson) is the simplest method considered for detecting differentially expressed genes, it was included in the comparison. For fold change with offset, because the optimal offset is unknown, we tried different offsets: 1, 5, 10, 20, 30, 40, 50 and 60. Fold change with offset X is denoted as FCX.
MA plot comparisonsMA plot is a convenient way to display differentially expressed genes. We applied MA plot to compare the results from nine methods (GFOLD5, GFOLD10, FC20, Cufflinks edgeRT, DESeq, edgeR, DEGseq and Poisson) on a pair of samples (one control and one TDP-43 depleted sample) selected from the mouse brain dataset. Supplementaryshowed the distribution of the variance and signal strength for the top 1000 differentially expressed genes identified by different methods. DEGseq and edgeR show similar results as Poisson. They are biased towards genes with larger read counts. Such a bias would cause less biological meaningful results as shown in the following sections. GFOLD5, GFOLD10, DESeq and FC20 show less bias. Although all of the methods except for GFOLD and FC20 adopt P-values for testing significance, the P-values of different methods are not comparable (as shown in Supplementary). DESeq tends to overestimate the variance and, as a result, identifies fewer differentially expressed) and (50, 250) under two biological conditions with the same sequencing depth, respectively. The three curves are the corresponding posterior distributions of log fold change. 'G' stands for GFOLD value and 'p' stands for P-value calculated using Poisson test genes using the same P-value cutoff. The high similarity between Poisson, edgeR and DEGseq indicates that the later two methods essentially calculate the Poisson variance introduced by random sampling in the sequencing step and thus omit biological variance. Therefore, none of the nine methods properly estimate the biological variance when no biological replicate is available.
Ranking comparisonsAlthough we do not know the true levels of gene expression under different conditions, in theory, estimates of the gene expression levels improve with the increase of replicate number. We therefore can evaluate the performance of a method on single replicate against a proxy for the truth in which multiple biological replicates are used. As the different statistics results from different algorithms are not directly comparable, we compared the rankings of the gene differential expression statistics to evaluate the performance of the different approaches while avoiding setting arbitrary cutoffs for different methods. Specifically, given two top N up-regulated (or N downregulated) gene rankings, we took the top k 5 N genes in each ranking and then calculated the number of genes in common (denoted as k) in the two top gene sets. Then, ^ k=k, ranging from 0 to 1, measured the similarity of the two top k genes. After all ks were considered, we were able to draw a curve with k/N as the x-axis and ^ k=k as the y-axis. We further defined rank area as the area below the curve, similar to the calculation of the area based on an ROC curve. If the rank curve reached the top left corner of the plot, i.e. the rank area was 1, then the two gene rankings were identical. The rank area is a direct measure of the similarity of the two rankings. We set N  1000 in the comparisons.illustrates an example that compares the results produced by DESeq on all replicates (as benchmark) with the results by all methods on only a pair of single replicates on Type I B-cell dataset. GFOLD in general gives the better overlap with the benchmark, with the default GFOLD10 giving the best results. Compared with FC, GFOLD is less sensitive to the parameters as shown in Supplementary. Of all the methods we compared, six (Cufflinks, GFOLD, DEGseq, edgeR, DESeq and edgeRT) accepted replicates. Theoretically, results produced by each of them on all replicates could be used as benchmark, but we did not know which derived benchmark was the most reliable one. Therefore, we compared the results of each method on every possible pair of single replicates with all derived benchmarks from six methods separately. The comprehensive comparison on human brain datasets is given in the heatmaps illustrated in Supplementary. Except for using DEGseq as benchmark, GFOLD in general performed better than any given method even when the benchmark was produced by that method. When the benchmark by DEGseq was used, DEGseq, edgeR and Poisson gave better results than GFOLD. We looked into details of the results and found that the MARS method adopted by DEGseq summed up read counts from replicates and behaved similar to Poisson and edgeR, as shown in Supplementary(GI). Therefore, edgeR, DEGseq and Poisson performed better when the benchmark by DEGseq was used. Supplementaryalso shows that the performance of FC10 was comparable to that of GFOLD10. To better understand the difference between GFOLD and fold change with offset, we further evaluated the performance of different methods on other datasets. For each method on each dataset,shows the average rank area which was calculated by averaging over all possible sample pairs, all benchmarks and the up-/down-regulated gene lists. In the table, methods are ranked by their average rank areas over all datasets. For each dataset, fold change with the optimal offset was comparable with GFOLD10. However, the optimal offset for fold change varied for different datasets. For example, FC10 performed better than other offsets in the human brain and the ENCODE dataset but not on the other three datasets. Furthermore, the selection of the optimal offset for fold change seems uncorrelated with the sequencing depth. To the contrary, GFOLD with parameter 0.005 or the default parameter 0.01 performs well on all five datasets.
In-group and out-group comparisonsGiven a dataset with biological replicates under two conditions, an in-group comparison consists of all possible comparisons between two biological replicate samples. An out-group comparison consists of all possible comparisons between two samples from different conditions. A commonly used strategy to assess the specificity of a method is to do an in-group and out-group comparison and to identify differentially expressed genes using the same cutoff. If a method reports fewer differentially expressed genes in the in-group comparison but reports more differentially expressed genes in the out-group comparison, then such a method is considered to achieve better specificity. In previous studies, the in-group and out-group comparisons were conducted by setting a default cutoff for the P-value. However, as we stated above, P-values used by different methods are not comparable. Furthermore, GFOLD and fold change with offset do not rank genes by P-values. To make a fair comparison of different methods using the in-and out-group comparisons, we adopted a strategy similar to the calculation of FDR mentioned above. For a method generating a P-value, we first applied this method to all possible in-and out-groupcomparisons and determined all of the P-values assigned to every gene. Then, we drew a curve with the x-axis representing the percentage of genes with P-values below a certain cutoff in the in-group comparison and the y-axis representing the percentage of genes with P-values below the same cutoff in the out-group comparison. This approach was similar for GFOLD and fold change with offset, except that we calculated the percentage of genes with absolute fold changes or GFOLD values above certain cutoffs.and Supplementaryrepresent the results for the human brain dataset. The figures show that GFOLD achieved the best specificity when a large GFOLD value cutoff was used, which is a desired property because we are more interested in these genes. Supplementaryalso shows that GFOLD is not sensitive to the parameter. DEGseq, edgeR and Poisson produced similar curves, which is consistent with the previous analysis that DEGseq and edgeR give similar results with those by Poisson. Although fold change with offset performed better than GFOLD on the Type I B-cell dataset and edgeRT performed slightly better than GFOLD on the estrogen response dataset, GFOLD generally performed well and is not sensitive to the cutoff (as shown in Supplementary). In general, the difference between two biological replicates is expected to be smaller than that between two samples from different conditions. If the variance is not overestimated, as in the Poisson model, under the same P-value cutoff, we expected to observe more genes with more significant P-values when comparing two samples from different conditions. The fact that the curves for edgeR, DESeq and Cufflinks are close to the reverse diagonal line indicates that under the same P-value cutoff the three methods give similar number of differential genes for both in-and out-group comparisons, demonstrating that edgeRT, DESeq and Cufflinks overestimated the variance for out-group comparison. Therefore, for those three methods, more stringent cutoffs could be selected to identify more differently expressed genes. In practical data analysis, the gene ranking is often of greater importance that the P-values themselves; in many downstream data analyses, such as gene set enrichment analysis, a ranking of genes is the only required input ().
The biological significance of gene rankings on ENCODE datasetsAlthough previous comparisons were concerned with consistency within datasets these comparisons do not address the main reason for using GFOLD that it provides a useful measure of biologically relevant changes. This section focuses on the biological significance of gene rankings given by different methods using the functional annotation service provided by DAVID (). We first checked the functional annotations produced by DAVID given the top 1000 genes up-regulated in K562 using all biological replicates in both K562 and GM12878 by six different methods. Generally, the top-ranked functional annotations are very similar for results from GFOLD, DESeq, edgeR and edgeRT both in ranking and significance. Except for DEGseq, the first functional annotation clusters by the other methods contain the same four Gene Ontology (GO) terms: angiogenesis, vasculature development, blood vessel development and blood vessel morphogenesis. For GFOLD, DESeq, edgeR and edgeRT, the enrichment scores of this cluster are all over 5 and the Benjamini P-values for every GO term are all below 0.01. High enrichment of the angiogenesis related cluster is an expected result, because increased angiogenesis is one of the characteristics of chronic myelogenous leukemia cell line like K562 ().The in-out-group comparison on the human brain dataset. The x-axis is the percentage of genes above (for GFOLD and fold change with offset) or below (for other methods) a certain cutoff in the in-group comparison. The y-axis is the percentage of genes above/blow a certain cutoff in the out-group comparison. A curve that is closer to the top left corner of the plot is considered to achieve better specificityWe then evaluated the performance of all methods on pairs of single replicates. The top 1000 up-regulated genes produced by each method were used to do functional annotation analysis as above. We checked whether the angiogenesis-related set could be identified with high significance (enrichment scores 45 and Benjamini value 50.01) by DAVID given the results from each method. The DAVID results, summarized in Supplementary Table S1, showed that only results produced by GFOLD5, GFOLD10, GFOLD50, GFOLD100 and FC5 could pass the test on both pairs of single replicates simultaneously. Furthermore, in most of the cases, the angiogenesis-related set is ranked top for GFOLD and fold change with offset. Therefore, when only a single replicate is available, GFOLD and fold change with offset could give more biological meaningful gene rankings, and results by GFOLD were more stable and less sensitive to the parameter than that by fold change with offset. We further redid the GO analysis using GOseq () to avoid possible bias due to over-detection of differential expression for long and highly expressed transcripts. Similar to the results of DAVID, the GOseq results, summarized in Supplementary Tables S2S4, show that blood vessel development and blood vessel morphogenesis are ranked top given the gene lists produced by GFOLD, DESeq, edgeR, edgeRT and Cufflinks when all biological replicates are used. When single replicate is used, GFOLD, FC and Cufflinks give these two GO terms much higher and more consistent ranks than the other methods do, and GFOLD is less sensitive to the parameter compared with FC.
The biological significance of gene rankings on estrogen response datasetWe further discuss the biological significance of gene rankings based on the estrogen response dataset. Using the breast cancer cell line MCF7, Hah et al. (2011) performed a GRO-seq experiment that measures the rate of transcription, different from the cellular concentration of mRNA that is measured by RNA-seq. Comparing transcription rates before and after estrogen stimulation, they found that genes with estrogen induced transcription rates tended to have estrogen receptor (ER) binding sites near their transcription start sites (TSSs). This is consistent with the biological mechanism in which ER binding at enhancers interacts with the transcriptional machinery at the TSS to induce transcription. Gene rankings that have the largest proportion of ER binding near the top of the list could be said to be of the greatest biological relevance. In Supplementary(AC), we compare, as a function of ranking, the proportion of genes having at least one ER binding site within 10 kb of the TSS. Here, for a better visualization, we used the default cutoff for GFOLD and selected 30 as the optimal offset for fold change based on. When two biological replicates are used [Supplementary(
DISCUSSIONAn experiment with multiple treatment and control replicates should be considered better designed and more informative than one that has single treatment and control samples. However, it is common for experimental groups to have biological material that is sufficient for only single replicate RNA-seq experiments. The data from such experiments provide imperfect information which is nevertheless far better than no information at all. In many experimental settings when it is not clear which downstream experiment is better, single replicate experiments are efficient for collecting useful knowledge that allows informed decisions to be made. In this study, we have shown that GFOLD provides a more consistent and more biologically meaningful approach to ranking differentially expressed genes than other commonly used methods for RNA-seq data without biological replicates, Although raw fold change does not take the variance of gene expression into account, and many P-value estimation methods rely too much on variance estimates, GFOLD seeks a balance between estimates of expression change and variability. The GFOLD value for each gene can be considered as a robust fold change, which measures primarily the relative change of the expression level instead of the significance (i.e. P-value) of differential expression. The evaluation results conducted on real datasets showed that in the analysis of a single pair of replicates, the gene ranking by GFOLD is better than other methods in terms of consistency with rankings based on multiple replicate data. The results from the ENCODE and GRO-seq dataset suggest that when using single replicate data the rankings produced by GFOLD are more biologically meaningful than the gene rankings by other methods. We stress that while useful information can be obtained from single replicate experiments, an analysis of variation between samples is necessary to draw sound conclusions, especially on the individual gene level. In comparison with other methods, besides fold change with offset, GFOLD is simple and intuitive. If there is no biological replicate, GFOLD is based on only one assumption that the read count of a gene follows a Poisson distribution. On the contrary, P-value is likely to be inaccurate without reliable measurements and modeling of gene expression variation because it is in the tails of the null distribution. Even if the biological variance has been captured accurately, P-values from other methods tell only of whether a gene is differentially expressed and not directly of the relative difference in expression. In comparison with GFOLD, fold change with offset is even simpler and could give comparable results if the optimal offset is selected; however, it is hard to select the optimal offset. Furthermore, the optimal offset seems uncorrelated with the sequencing depth. In contrast, GFOLD with the default cutoff performed well on all five datasets we have tested. GFOLD is generalizable to isoform-level analysis of differential expression. The main challenge is that a system of linear equations has to be solved before calculating the posterior distribution of log fold change (), which is out of scope of this study. In general, we believe that the ranking of gene expression changes by GFOLD, using a reliable measure of fold change, is more biologically meaningful than ranking by Pvalue. This concept can be broadly applied, beyond RNA-seq or GRO-seq, to other types of genomic data, including ChIP-seq.
The Author 2012. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
J.Feng et al. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
GFOLD at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
