Motivation: Mathematical morphology (MM) provides many powerful operators for processing 2D and 3D images. However, most MM plugins currently implemented for the popular ImageJ/Fiji platform are limited to the processing of 2D images. Results: The MorphoLibJ library proposes a large collection of generic tools based on MM to process binary and grey-level 2D and 3D images, integrated into user-friendly plugins. We illustrate how MorphoLibJ can facilitate the exploitation of 3D images of plant tissues. Availability and Implementation: MorphoLibJ is freely available at http://imagej.net/MorphoLibJ
IntroductionThe continuous development of microscopy imaging techniques results in increasingly better spatial resolution, signal quality and throughput and allows 3D imaging of biological cells, tissues or organisms. Biological images present specific difficulties for automated analysis, due to data dimensionality (space, time, channels, etc.), acquisition artefacts, or low contrast. There is thus a recurrent need for efficient image processing algorithms and for user-friendly software that integrates them.To meet the needs for generic implementations and ImageJ interfaces of MM operators, we developed the GPL-licensed MorphoLibJ library. MorphoLibJ implements a large collection of MM algorithms applicable to 2D and 3D grey level images and integrated into userfriendly interfaces.
The MorphoLibJ libraryThe library provides different categories of functions, corresponding to standard image processing workflows. The complete list of operators is given in the user manual (Supplementary File S1).
Image processing and filteringA large collection of pre-processing operations (noise reduction, edge detection, feature enhancement.. .) is available through tunable morphological filters (closing, opening, top-hat, morphological gradients.. .). Grayscale attribute opening allows efficient filtering of images based on a size criterion. The library also contains a large family of operators based on geodesic reconstruction (), such as hole filling or automated identification of extended minima or maxima.
SegmentationThe watershed transform has proven efficiency for segmenting contrasted structures or plant tissues, but usually results in oversegmentation (). Segmentation can be significantly improved by pre-processing images to remove non significant minima. This is classically achieved by combining the watershed with the h-maxima and regional extrema operators. We developed a plugin interface to allow end-users to easily run the corresponding pipeline of operators. The plugin lets users tune a single tolerance parameter defining significant minima and provides immediate visual feedback ().
Post-processingMost segmentation algorithms require additional processing to remove or merge regions with inappropriate size or location (e.g., touching borders). Several MorphoLibJ utilities allow a posteriori manual correction of label and binary images, labelling of connected components in 2D or 3D binary images, and the production of meaningful representations from segmentation results.
Quantitative analysisObject morphology and topology can be described by volume, surface area (implemented as discretization of Crofton formula ()) or Euler Number. Using geodesic reconstruction, MorphoLibJ also provides less common, yet powerful, features such as the maximal enclosed ball and geodesic diameter. Spatial organisations and neighbourhood relationships between labelled regions can be quantified by region adjacency graphs.
Library re-usabilityA key design concept was the modularity of the implementation. The library is structured into three layers with different programming abstraction. For final users, plugins provide graphical display and intuitive tuning of parameters. For plugin developers, the library provides collections of static methods, and most operators can be called in a single line of code. For core developers, algorithms are implementations of abstract interfaces, making it possible to choose or develop the most appropriate one. This modularity permitted to develop other plugins devoted to the analysis of nucleus images (), grey level granulometries () or the description of binary microstructures ().
Sample application: quantitative analysis of Arabidopsis thaliana early embryosThe automated analysis of 3D images of plant tissues is particularly challenging. Using MorphoLibJ, we analysed cell morphologies and division patterns in 3D confocal images of Arabidopsis thaliana embryos at early development stage (). The computation of extended minima by manually adjusting the " tolerance " parameter identified large dark regions and allowed a coarse detection of cells. Extended minima were used as markers of the 3D watershed algorithm, resulting in the identification of homogeneous regions in the image (). The regions outside of the embryo were manually removed after a visual inspection of the label image, to obtain an accurate 3D cell segmentation (). Visualizing the length ratio of largest and smallest axes of the equivalent ellipsoid highlighted specific geometric differences between embryo domains ().
ConclusionThe MorphoLibJ library provides a set of generic tools for image processing and analysis of biological samples. We demonstrated its applicability on 3D images of plant tissue. The cell-resolved data provided by MorphoLibJ will be useful for the analysis of cell lineage, and the modelling of plant growth and morphogenesis in 3D.
FundingI.A.C. was funded by the TEFOR Infrastructure under the Investments for the Future program of the French National Research Agency (Grant #ANR-11
Mathematical morphology (MM) is a class of image processing algorithms and methods with well-established theoretical foundations that have proven useful for a large variety of problems (Soille, 2003). Typical applications comprise image filtering and enhancement, segmentation and analysis. It extends naturally to the processing of three dimensional images. Though it constitutes a methodology of choice for the processing of biological images, it is not widely used, possibly due to the lack of developer-friendly implementations and user-friendly interfaces. One of the most popular bioimage informatics tools is the ImageJ/Fiji software, which offers a large spectrum of image processing operators and allows addition of plugins developed by the community (Schindelin et al., 2012). Several plugins include morphological filtering (Landini, 2008; Ollion et al., 2013; Prodanov et al., 2006), or segmentation (Tsukahara 2008, available at http:// bigwww.epfl.ch/sage/soft/watershed) tools. However, none of them implements a comprehensive and consistent set of MM operators, supporting 2D as well as 3D images, and compatible with arbitrary image types (8, 16 and 32 bits). Understanding the cellular bases of complex phenomena such as plant development and morphogenesis requires quantitative approaches of cellular morphology and tissue architecture. Many software have emerged for image analysis of plant tissues (Barbier de Reuille et al., 2015; Fernandez et al., 2010; Pound et al., 2012; Schmidt et al., 2014). However, such software are specific to a particular application, and rarely interact with ImageJ. V C The Author 2016. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com 1 Bioinformatics, 2016, 13 doi: 10.1093/bioinformatics/btw413 Advance Access Publication Date: 13 July 2016 Applications Note Bioinformatics Advance Access published July 21, 2016 at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
MorphoLibJ: mathematical morphology with ImageJ
