Motivation: Computational modeling is widely used for deepening the understanding of biological processes. Parameterizing models to experimental data needs computationally efficient techniques for parameter estimation. Challenges for parameter estimation include in general the high dimen-sionality of the parameter space with local minima and in specific for stochastic modeling the intrinsic stochasticity. Results: We implemented the recently suggested multiple shooting for stochastic systems (MSS) objective function for parameter estimation in stochastic models into COPASI. This MSS objective function can be used for parameter estimation in stochastic models but also shows beneficial properties when used for ordinary differential equation models. The method can be applied with all of COPASI's optimization algorithms, and can be used for SBML models as well. Availability and implementation: The methodology is available in COPASI as of version 4.15.95 and can be downloaded from
IntroductionExperimental data from time series experiments has been widely modeled with ordinary differential equations (ODE). Due to progress in experimental techniques, e.g. the possibility to measure small numbers of molecules in single cells (Raj and van), the importance of stochastic modeling is increasing. Both types of models (i.e. ODE and stochastic) need to be parameterized to experimental data. This parameter estimation can be challenging due to local minima in the parameter search space. In case of stochastic modeling, the treatment of the intrinsic stochasticity poses an additional challenge. We recently developed an objective function (multiple shooting for stochastic systemsMSS) for parameter estimation () that treats the intervals between measurements separately and uses a state updating mechanism for calculating initial values for the intervals. In contrast to a least squares functional, where the states are solely determined by the initial value and the ODE system, this objective function allows a more flexible state estimation. This objective function has shown to be successfully applicable to the estimation of kinetic parameters in intrinsic stochastic models (). Furthermore, the flexibility in the state estimation also shows beneficial properties when dealing with ODE systems.
Approach: the objective functionAssume that data obs   obs 0 ;. .. ; obs n  are observed at time points t 0 ; t 1 ;. .. ; t n. The state of the system at time t i comprises observed and unobserved species: i   obs ; hid . The MSS objective function decomposes the whole time series into intervals and fits to the intervals individually. The initial value for the ODE for each interval is obtained by a state updating:The objective function for parameter estimation is then defined aswith an ODE solution x at time t i  t i1 for a parameter h and an initial value ^ i1 at t i1 .
Implementation and discussionCOPASI () is a platform independent, user friendly software tool for setting up, simulating and analyzing kinetic models of biochemical reaction networks. It is freely available, open source software and is developed in a well-established international cooperation. It aims at making advanced, state-of-the-art modeling techniques available to researchers who are not necessarily experts in software development or numerical methods. COPASI provides a wide range of tools, including metabolic control analysis, sensitivity analysis, time scale analysis, exact and approximate stochastic simulation (including hybrid approaches), optimization and parameter estimation. It offers strong support for using established community standards, most importantly the SBML () file format for exchange of models. We integrated the new objective function in COPASI as an extension to the parameter estimation task. First, a user would set up their observed time course data in the experimental setup, where the data are read in and mapped to the individual-dependent elements in the model. Once that is done, the entry Create Events for Timeseries Experiment can be chosen from the Tools menu. This will analyze the time series experiment and create discrete events for each of the observed time points. Each event will assign all observed values of the specified time point to the mapped model elements. Once the events have been created, they will force the model at each measured timepoint to the observed state. This will apply to all of the simulation tasks in COPASI, including time course simulations, scans, parameter estimation runs and optimization runs. Since the objective function described above is completely deterministic, the optimization can be performed with gradient-based methods or global optimization techniques. Since the feature is implemented as events, they can be edited by users, allowing them to remove some data points, or add new elements to adjust non-observed components The method can be used for SBML and COPASI models alike, and once set up, the model including the events can be exported back to SBML for analysis in other software tools. The new feature in COPASI can be used for parameter estimation in stochastic models: Results from Zimmer and Sahle (2012) could be reproduced for Immigration-Death and Lotka-Volterra (full observation) and for Lotka-Volterra (partial observation) even better convergence could be achieved. This especially means that the feature can exploit the information that intrinsic noise contains for parameter identification (). Furthermore, the new feature can be applied to parameter estimation in ODE models. Here, it has the effect that it smooths the landscape and allows for a more efficient optimization.shows a plot of the objective function landscape with the least squares objective function (middle panel) containing local minima and with our objective function on the right side (without local minima). These results are discussed in detail in Zimmer et al. (2015b). For more examples please see also the Supplementary Material provided.
DiscussionWe implemented the MSS objective function for parameter estimation in COPASI. It splits the time horizon into intervals between the measurement points and uses state updating mechanism to create initial values for the intervals. This allows more flexible treatment of states as conventional least squares functional where states only depend on the initial value and the parameterized system. This allows us to successfully treat models containing intrinsic stochasticity. In addition, our functional can be applied to parameter estimation in ODE systems. It leads to a reduction of local minima in parameter space. Local minima are a highly discussed topic () but only few methods focus on the influence of the choice of the objective function such asfor a more detailed discussion. Our implementation in COPASI allows for combining this powerful objective function with all the feature of COPASI such as a variety of optimization algorithms, a SBML import/ export and a graphical user interface. Thus, by integrating the newly developed method into a widely used and user friendly software package, it is made accessible for a wider community for evaluation and practical application.. Left: COPASI, and a plot of a time series with discrete events describing the measured data; Middle, Right: Plot of the logarithm of the objective function landscape for a Lotka-Volterra model. Darker color stands for lower objective function value. Middle side shows landscape for the conventional least squares. Right side for the new MSS functional. Optimization is easier as there are no local minima
5.5 5.75 6 6.5 7 7.5 8 8.5 9 9.5Piecewise parameter estimation for stochastic models
at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
F.T.Bergmann et al. at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
