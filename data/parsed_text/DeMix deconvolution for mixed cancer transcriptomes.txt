Motivation: Tissue samples of tumor cells mixed with stromal cells cause underdetection of gene expression signatures associated with cancer prognosis or response to treatment. In silico dissection of mixed cell samples is essential for analyzing expression data generated in cancer studies. Currently, a systematic approach is lacking to address three challenges in computational deconvolution: (i) violation of linear addition of expression levels from multiple tissues when log-transformed microarray data are used; (ii) estimation of both tumor proportion and tumor-specific expression, when neither is known a priori; and (iii) estimation of expression profiles for individual patients. Results: We have developed a statistical method for deconvolving mixed cancer transcriptomes, DeMix, which addresses the aforemen-tioned issues in array-based expression data. We demonstrate the performance of our model in synthetic and real, publicly available, datasets. DeMix can be applied to ongoing biomarker-based clinical studies and to the vast expression datasets previously generated from mixed tumor and stromal cell samples. Availability: All codes are written in C and integrated into an R function , which is available at http://odin.mdacc.tmc.edu/$wwang7/ DeMix.html.
INTRODUCTIONSolid tissue samples frequently consist of two distinct components, glandular epithelium and its surrounding stroma. Traditional analytic approaches that ignore the presence of tissue heterogeneity may suffer from inaccurate transcriptional profiling and are likely to miss important genes that are related to shaping cancers. To remove heterogeneity in tumor samples, researchers can use laser capture microdissection () to physically isolate the different tissue components. However, this technique is time-consuming, costly and requires special equipment that is not available at all institutes. Thus, it is of substantial interest to isolate expression data from mixed samples in silico. In biomarker-based clinical trials, microarray gene expression data are actively studied to profile transcriptions of hundreds of cancer patients (). Current methods for dissecting array-based expression data () are limited in their application to actual data for the three following reasons. First, existing methods assume a linear mixture of expression levels, as presented by log-transformed data. This assumption, recently shown to be invalid, can distort the estimation of tissuespecific expressions (). We describe this linear assumption by AX  B, where A is a matrix of individual tissue-specific expression, X is a vector of mixture proportions and B is a vector of observed expressions.showed that raw measured data should be used for input B. When log-transformed fluorescent intensity data are used instead, the output A is underestimated. The convention of using log-transformed expression data started because such data were shown empirically to follow a normal distribution (), which is straightforward for model building and parameter estimation. No available model-based methods are designed to analyze data from heterogeneous tumor samples before the data are log-transformed. Second, the available methods do not provide a practical way to jointly estimate both tissue proportions (X) and tissue-specific expressions (A). Most methods require good knowledge of one of these measures. The tissue-specific expressions (A) can be derived from a set of genes with known expression profiles in all constituting tissue types () or from a set of genes that show significant enrichment in one of the tissue types (). Other methods focus on deconvolution of gene expressions based on known tissue proportions (implemented a Bayesian model to assess the tissue proportions as well as gene expression levels, using strong previous information on the proportions.took reference profiles from all tissue components and allowed for adjustments in tissue-specific expression levels from the reference profiles.*To whom correspondence should be addressed. developed a geometry-based method to estimate mixture proportions without knowledge of all tissue-specific expressions, which directly improved the method of, but did not deconvolve individual gene expressions. Third, previous methods have focused on estimating the mean tissue-specific expressions for each gene and thus are not applicable to estimating individual expression levels in each sample and each gene. Methods for in silico dissection of individual gene expression profiles are urgently needed. It is straightforward to compute these individual profiles in a matched design, where the mixed sample and one pure tissue sample are obtained from the same individual. In a more commonly observed unmatched design, where tissue samples are derived from mixed and pure tissues from different individuals, no methods are available to deconvolve these individual profiles, yet downstream biomarker analyses depend on the accuracy of these profiles. To bridge the gap from current methods to actual applications, we propose a statistical approach for deconvolving mixed cancer transcriptomes, DeMix. Our method supports the analysis of mixed tissue samples under four data scenarios, with or without reference genes, and with a matched or unmatched design. Here, reference genes are a set of genes for which expression profiles have been accurately estimated based on external data in all constituting tissue types. We anticipate that DeMix can broaden the investigation of mixed samples and increase the accuracy of downstream transcriptome analysis. The rest of this article is organized as follows. In Section 2, we briefly explain the general framework of DeMix and describe four strategies in detail. In Section 3, we conduct a simulation study and a validation study using publicly available data. We provide concluding remarks and potential extensions of our method in Section 4.
METHODSWe let N ig and T ig denote the expression level for a gene g, g  1,. .. , G from the pure normal and tumor tissues, respectively, which are derived from sample i for i  1,. .. , S. We do not observe the pure tumor expression T ig. Instead, we observe Y ig , which denotes the expression level of a clinically derived tumor sample i for gene g. We let i denote the proportion of tumor tissue in sample i, which is also unknown. We write a linear equation on the raw measured data asHere, the i for sample i represents the proportion of cells in tumor tissues, which remains the same across genes. We further assume that N ig $ LN Ng , 2 Ng  and T ig $ LN Tg , 2 Tg  where LN represents log 2 Normal distribution because the log 2 transformed data were shown to empirically follow a normal distribution (). The fundamental challenge of deconvolution is how we predict T 's, given that we observe the Y's and N's without previous information on the T's and 's. If only a single sample were available, this would be an unsolvable problem, as both 's and T's are unknown. However, simultaneous analysis of several samples can teach us: to what extent a gene is component specific, in which component a gene is likely to be expressed more or less, and how variable a gene is across samples. These elements allow us to make predictions on the 's and T's. Note that the roles of tumor and normal tissues can be swapped, i.e. we can observe the pure tumor expression T's and make inference about the unobserved N's from the heterogeneous sample Y's. Another challenge lies in the distribution of Y, which does not follow a log 2 Normal distribution when both N ig and T ig follow a log 2 Normal distribution. With this in mind, our method mainly consists of two steps: (i) given the Y's and the distribution of the N's, we search for a set of f, T , 2 T g that maximize the likelihood of observing Y; (ii) given the 's and the distributions of the T's and N's, we estimate an individual pair of (T, N) for each sample and each gene. Below, we describe these steps for specific data scenarios.
Data scenario 1: unmatched tumor and normal samples, without reference genesThis is a general and common data scenario. We observe Y ig , i  1,. .. , S and a set of unmatched observations of normal samples. We first obtain the sample mean and variance ( ^ Ng , ^ 2 Ng ) under the log 2 Normal distribution for the normal tissue samples. This allows us to initialize n ig , which cannot be observed from the unmatched samples (see the Appendix for details). Unlike a mixture of normal distributions generating a normal distribution (for log-transformed data), the distribution of Y as a mixture of two log 2 Normal distributions does not have a closed form. We, therefore, estimate i and t ig as follows.(1) Obtain an optimal set of f ^ i g S i1 along with f ^ Tg , ^ 2 Tg g using the NelderMead procedure (). This set should maximize the likelihood for observing the expression levels Y 's, i.e.see the Appendix for details).Tg , we further deconvolve y ig into n ig and t ig. The values of t ig and n ig are reconstituted gene expression levels of pure tumor and normal tissue corresponding to subject i and gene g. Given ^ i , we can write n ig as a function of y ig and t ig. We search for a value of t ig that is most likely to be presented given the LN distributions of N and T (see geometric illustration in Supplementary):where j, 2  is a log 2 Normal density with corresponding mean and variance 2 .Our algorithm initializes n ig and iterates (usually a couple of times) between Steps 1 and 2 (n ig is updated using ^ t ig ), until the change in ^ t ig between two consecutive iterations is 51%.
Data scenario 2: matched tumor and normal samples, without reference genesWe do not need to initialize a known n ig , and can replace Step 2 withWe estimate ^ i by following the same steps described in Section 2.1. The ^ t ig can have negative values for some genes, in which case we set t ig at 0 and exclude these genes from the likelihood computation.
Data scenario 3: unmatched tumor and normal samples, with reference genesWe derive the tumor expression level distribution (with ^ Tg and ^ 2 Tg ) for a reference gene set, as denoted by G 0. Then under the linear relationship (1), we follow procedures as described in Section 2.1, except for the NelderMead optimization procedure in Step 1. Instead, to estimate i , we do the following:where k  k is a L 1 norm.
Data scenario 4: matched tumor and normal samples, with reference genesThis is a most desirable but uncommonly observed data scenario. We first estimate ^ i using Equation (4) given ^ Tg and ^ 2 Tg for a set of reference genes, then estimate ^ t ig using Equation (3).
Methods for comparisonFor comparison purposes, we implemented a linear model (LM) for the log-transformed data. This model estimates tumor proportions and gene expressions by assuming a normal distribution on the normal, tumor and mixed tissue samples. Following a similar procedure as in DeMix, we estimated associated parameters, as they maximize the likelihood of observing the log 2-transformed expression values from the mixed tissue samples (see the Appendix for details). In addition, we present results based on a non-mixture model (NM), which ignores tumor heterogeneity (  1 for all tumor samples).
Uncertainty measureWe applied a standard bootstrap method () to estimate the uncertainty on the tumor proportion estimates ^ i. Given the set of genes used for deconvolution, e.g. all genes denoted by G or reference genes denoted by G 0 , we sampled these genes with replacement for m times (m  50) and obtained a set of estimates for each experiment: fb 1 ,. .. ,b m g. Then, we calculated the standard deviations of b as standard errors.
RESULTS
SimulationWe used simulation to assess the performance of our approach in estimating unobserved tissue proportions and reconstituting unobserved tissue-specific expressions. Deconvolutions in matched designs with or without reference genes and in unmatched designs with reference genes are reported in the Supplementary Materials (Supplementary Figs S2S4). Here, we present results from the unmatched design without reference genes (Section 2.1). We simulated datasets as follows: 20 samples, 10 of pure A-type and 10 of mixed tissues. For the 10 mixed tissue samples, we assigned B-type tissue fractions, i s, at evenly spaced values from 0.1 to 0.9. In each sample, we simulated expression levels for 2000 genes and randomly selected 25% (500 genes) to be differentially expressed (DE) when comparing A-type with Btype samples. We assumed the expression levels to follow log 2 Normal distributions with mean and variance as follows. For A-type tissues, a vector consisting of means Ng , g  1,. .. , 2000 was generated independently from N7, 2 2 . For DE genes in B-type cell samples, the means of the A-type tissue samples were added by g , g  1,. .. , 2000, where we generated g $ N4, 1:5 2 . For non-DE genes, g s were sampled from N0, 0:2 2 . Across 10 pairs of A and B-type tissue samples, the sample-wise standard deviation at a given gene was set at 0.2. Then, we mixed the 10 A-type and B-type tissue sample expressions linearly at assigned proportions based on Equation (1). By doing so, we created 10 heterogeneous samples along with 10 observed A-type tissue samples. The 10 B-type tissue samples were hidden and used for validation. We repeated this procedure to generate 200 replicate datasets. In, we present results of the biases and mean-squared errors (MSEs) with respect to our estimation of B-type tissue proportion i s. Compared with LM, DeMix resulted in substantially smaller biases and MSEs. LM performed worse at estimating proportions as the true proportion decreased. In contrast, DeMix performed well across all values of. This uniformity in performance is desirable because the actual tumor proportions will be unobserved in real data. As an example, at  0:1, we observed biases of 0.02 for DeMix and 0.28 (14-fold larger) for LM; at  0:9, the bias was 0.02 for both DeMix and LM. To evaluate how well DeMix reconstituted the B-type tissue expression level, we used an integrated relative mean-squared error (IRMSE) to quantify the discrepancy between the trueexpression (t ig ) and the estimated pure tissue expression ( ^ t ig ) for sample i and gene g:: We estimated ^ t ig using DeMix, LM and NM, respectively.shows that our approach outperformed the LM and NM in estimating pure gene expressions. Again, as the actual B-type tissue proportion increased to a value close to 1, the LM and even the NM (no deconvolution) provided gene expression levels close to the truth. This suggests that DeMix provides the best improvement when analyzing heterogeneous samples with low to medium tumor proportions. Without knowledge of the true gene expression levels, however, we cannot obtain information on tumor proportions a priori, which vary across samples. When the true B-type tissue proportion was low, the LM performed better than the NM, but at a degree that was not comparable with the performance of DeMix. The monotonic trend in the bias from the LM can be explained by our simulation settings. Here, we assume all differentially expressed genes were overexpressed in the tumor tissue as compared with the normal tissue. When all tumor tissue expressions are underexpressed compared with the normal tissue expressions, however, this trend can be reversed (Supplementary Tables S2 and S3).
Data exampleTo validate our method using real data under data scenario 1 (Section 2.1), we analyzed four public gene expression datasets, which are generated by artificially mixing tissues at varying proportions. We downloaded dataset GSE19830 from the GEO website (http://www.ncbi.nlm.nih.gov/geo/). This dataset was originally generated from rat microarray experiments (To summarize the probe intensities in all datasets, we used the robust multi-array averaging (RMA) procedure (), as implemented in R (R Development Core Team, 2009) and bioconductor (http://www.bioconductor.org). To maintain computational efficiency and remove probes with high background noise, we selected a subset of genes to be analyzed by DeMix. We required the mean expression levels of these genes in pure normal tissue samples to be in the upper quartile of the expression levels of all genes. This provided us with 700014 000 probesets across all datasets. With pre-processed raw measured data, we confirmed that assuming a linear mixture on the data before they are log-transformed is appropriate, as compared with assuming it on the log-transformed data. This can be done when we know T, N and Y, from which we derive  YN TN. Specifically, in dataset GSE19830, we compared the differences in transcript abundances between the pure liver and brain tissues (TN), with differences between the mixed and brain tissues (Y-N), both at the original scale () and at the log 2 scale (). The linear relationship AX  B fits well with the raw measured data, with a few deviations in genes at extreme values, e.g. at jT  Nj45000. In the log-scale data, however, the linearity assumption does not hold when the abundance ratio between two tissues is 42-fold. First, we evaluated how well DeMix estimated tissue proportions in these datasets (). Without using previous knowledge of tissue-specific expression from both components of the mixture, as in other methods (), DeMix correctly estimated the unknown tissue proportions with a correlation coefficient, r, of 0.98. In contrast, LM consistently overestimated the tissue proportions, likely because of the concavity property of log functions, as explained by Zhong and Liu (2011). Of 47 samples, all estimates from GSE19830 and MAQC site 1 presented 95% confidence intervals that included the truth, or less often, with one boundary 12% away from the truth (see also Supplementary). We observed three samples from(a) (b)Affymetrix and two samples from MAQC site 3 that presented overestimated proportions. The first overestimation was likely caused by deviation from the linearity assumption, which we diagnosed using scatter plots of (TN) versus (YN) (Supplementary). With the normalized raw measured data, we still observed a curvature in the three samples, with many data points at both extremes of the (YN) values unevenly distributed on top of an expected line of 25% (the true proportion). The second overestimation was likely caused by issues in data quality. We compared the MA plots of all five samples generated at the same proportion of 25% for the MAQC site 3 data (Supplementary). We observed larger variations in probe intensities for samples 1 and 3 compared with those of the other three samples (respective inter-quartile ranges of 0.19 and 0.18 versus 0.06, 0.08 and 0.05). We obtained similar results when analyzing the four datasets with probesets presenting expression levels 42 6 in the normal samples (3549% of all probesets, Supplementary). We observed overestimation in tissue proportions in the same five samples. Next, we examined how well DeMix reconstituted pure tissuetype expressions at four different proportions using the GSE19830 data as an example. As shown in a heatmap (), DeMix removed mixed-in gene expressions from brain tissue samples at different mixture proportions. It provided individual gene expression levels from pure liver tissue that are more homogeneous across 12 samples than they were before deconvolution, and more similar to the actual gene expressions in pure liver tissue.shows the estimated expressions from pure liver tissue are highly correlated with the true expressions (correlation coefficient r40:88). Within each sample, we achieved greater accuracy when the gene expression levels were high for pure samples, as low expression levels may beoverrepresented by a high level of background noise. We obtained similar results from the other three datasets, and lower correlation coefficients in samples where the proportion estimates were significantly different from the truth (Supplementary). Finally, we illustrated the use of DeMix in finding DE genes, again using the GSE19830 dataset as an example.shows the number of significant genes (found by a two-sample t-test) between liver and brain tissue samples at varying cut-offs of the P-values (Bonferroni corrected). At an initial cut-off of 0.05, DeMix-based deconvolution found 4774 DE genes, which was $1.3 times more than those found by LM (3598) and 9 times more than those found by NM (523). We also directly compared the observed pure brain and pure liver tissue samples. Given a relatively small sample size (3 versus 3, as compared to 12 versus 3 from mixed samples), we found only 1900 genes, 2.5 times fewer than the amount found with DeMix. Even though these 1900 genes largely overlapped with the 4774 genes found by DeMix, the different sample size, and hence the different statistical power, prohibited us from using these 1900 genes as truth. The issue of small sample size is also supported by an observation that at a P-value cut-off of 0.001, the NM (not considering heterogeneity) yielded a higher number of DE genes than the 'pure' samples. As we lowered the cut-off on P-value, we found more DE genes with DeMix. We tested the homogeneity among 12 deconvolved samples by performing two-sample t-tests between six randomly selected deconvolved samples against the remaining six samples. At a P-value cut-off of 0.05, we did not find any significant DE genes. These results suggest that DeMixbased deconvolution is able to make mean differences more distinct between two tissue samples and reduces variances across all single tissue samples (), both of which contributed to increasing the power of detecting DE genes.
CONCLUSIONWe have presented a novel statistical method, DeMix, for computational dissection of gene expression levels from mixed tissue samples, and in particular, for microarray data generated from cancer patient samples. Our method addresses three existing problems for in silico dissection: (i) model-based analysis of raw measured data that follow a log 2 Normal instead of a normal distribution; (ii) estimation of both tissue proportions and tissue-specific expression levels; and (iii) reconstitution of patient-specific gene expressions. We also provide uncertainty measures on estimated tissue proportions. DeMix provides practical solutions by requiring knowledge of gene expression of one tissue type, which does not have to be matched, i.e. derived from the same sample. Our solutions vary according to data scenarios, to take advantage of all the available information. Both simulation studies and analysis of actual data highlight the importance of following a linear mixture of gene expression levels on data before they are log-transformed, for which DeMix is the first method to do so. Our validation study showed that DeMix performs accurately on expression data generated from both Affymetrix and Illumina platforms. Our method can be applied to analyzing newly generated expression data from biomarker studies, as well as to re-analyzing data generated from previous studies. Our method is useful when there is little information on gene expression levels in one of the mixing components, and at the same time the mixing proportions, which could be obtained from other sources such as pathologist estimates or from DNA copy number data (), are not available. We do not require knowledge of reference genes. However, when such knowledge is available, we have provided an alternative solution to take advantage of the information. Even though our algorithm requires a minimum of one gene as a reference gene, we recommend using at least 510 genes to alleviate the potential influence from outliers and to identify an optimal set of s. DeMix uses expression levels from thousands of genes to estimate each and is, therefore, robust to perturbations in the expression of a minority of genes, arising from interaction with surrounding tumor cells. DeMix can also use a list of selected genes that are not affected by the tumor, when available, for the estimation of proportions. If cell proportions are estimated reliably, they can also be used to estimate mean expression levels in both normal and tumor tissues for potentially perturbed genes, based on the linear relationship AX  B on raw measured data. When reference genes are considered, DeMix performed similarly or better than PERT () in estimating tissue proportions with our validation data (Supplementary Figs S9 and S10). Our estimation procedure under matched or unmatched samples with reference genes is computationally efficient. On a PC with a 2.2 GHz Intel Core I7 processor, the computation of our simulation data consisting of 20 matched samples and 2000 genes in each sample takes $1 s. In contrast, it takes $10 min to complete the computation of the same data without knowledge of any reference genes. We used the NelderMead optimization procedure that includes a numerical integration of the joint density, which may explain this substantial increase in computation time. DeMix takes a two-stage approach by first estimating thetially expressed genes at varying P-value cut-offs (Bonferroni-corrected), using different models. The third curve from the top corresponds to comparison between the three pure brain and the three pure liver tissue samples i 's and then estimating the means and variances of gene expressions based on the ^ i 's. A joint model that estimates all parameters simultaneously will be able to further incorporate the uncertainty measure of the tissue proportions. However, the estimation step from such a model can be computationally intensive and may not be suitable for the analysis of high-throughput data. We identified a few considerations for the deconvolution of microarray data. First, the assumed linear mixture of data before they are log-transformed may not perfectly hold for some samples, e.g. samples 1 to 3 from the Affymetrix data, and for some genes, e.g. those with extreme expression values such as 52 4 or 42 14. Second, our estimation method is based specifically on log 2 Normal distributions of the raw measured data for each mixture component. When this assumption is violated, a deterioration of accuracy is to be expected. Third, microarray technology has inherent limitations, such as high background noise and inconsistent gene expressions across experiments. Screening out genes with low expression levels and accounting for batch effects must be tackled before deconvolution. We found scale normalization using MAS5 can obscure the actual linear mixture of expression levels, on which the downstream deconvolution is based. Summarization using RMA, together with quantile normalization, seemed to retain our linearity assumption of the raw measured data most of the time. Our model assumes that a mixed sample consists of at most two cellular compartments: normal and tumor, and that the distributional parameters of normal cells can be estimated from other available data. These assumptions seem to us to be a logical place to begin, but there remain important situations where more complex modeling may be needed. First, we assume pure normal samples to be representative of the normal tissues in the mixture samples, allowing for estimation of sample-specific expression values. This assumption can be violated as there are sometimes perturbations of gene expression levels in tumorstromal interactions, as previously discussed. Second, both normal and tumor tissues may in turn consist of different cell types, with different transcriptional activity, and represented in proportions that can be variable across samples. This has been studied in, which used reference profiles from all cell types. Extensions of our model to deconvolution of more than two mixture components can address this issue without requiring reference profiles from all mixing components and can be done with a more computationally efficient density integration and optimization procedure. Currently, to identify i 's, we assume a roughly stable composition of one or multiple cell types within each tissue component. With data from real tissue samples, it is necessary to evaluate the extent to which this assumption is valid. The variation in the composition of multiple cell types from sample to sample will be captured by the variance of the distribution of expression levels within each tissue, which is estimated based on the data. When there exist multiple tumor subtypes, our method should be applied separately to samples that belong to the same subtype.
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
J.Ahn et al. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
DeMix at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
