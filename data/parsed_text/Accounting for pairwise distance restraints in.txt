ClusPro is a heavily used proteinâ€“protein docking server based on the fast Fourier transform (FFT) correlation approach. While FFT enables global docking, accounting for pairwise distance restraints using penalty terms in the scoring function is computationally expensive. We use a different approach and directly select low energy solutions that also satisfy the given restraints. As expected, accounting for restraints generally improves the rank of near native predictions, while retaining or even improving the numerical efficiency of FFT based docking. Availability and Implementation: The software is freely available as part of the ClusPro web-based server at http://cluspro.org/
IntroductionThe fast Fourier transform (FFT) correlation approach has proved to be very useful for macromolecular docking. The major advantage of the method is the extremely fast evaluation of scoring functions, enabling global systematic sampling of the entire conformational space defined by the relative orientations of two molecules. Although the scoring function must be expressed as a sum of correlation functions (), it is possible to represent complex energy functions, based on molecular mechanics and including solvation terms, in a form suitable for FFT. FFT-based methods such as ZDOCK (), GRAMM (), PIPER (), DOT () and DOCK/PIERR () consistently perform well both as protocols of individual groups and as automatic servers. In particular, during the latest rounds of the blind protein docking experiment CAPRI (), performance of our docking server ClusPro (), based on the PIPER program, was comparable with top human predictor groups (). The server is heavily used: by December 2015 the Cluspro 2.0 website registered over 15 000 unique user IPs, and completed almost 150 000 docking calculations, currently adding about 5000 per month. Models built by the server have been reported in over 400 publications. In spite of the significant progress, docking generally needs to be complemented by experimental validation. The main reason is that the current scoring functions are not accurate enough for finding the best models among the ones generated by the sampling. Thus, additional information can be very useful for improving the reliability of structure determination. Accordingly, ClusPro has the option to apply extra attraction terms to residues that are a priori known to be in the interface. Conversely, repulsion terms are applied to residues that are not expected to be in the interface. However, what ClusPro was lacking so far was the ability to define distance restraints between pairs of atoms or residues. Such restraints can be derived, e.g. from NMR Nuclear Overhauser Effect (NOE) experiments or by chemical crosslinking. The use of restraints is central to the popular High Ambiguity Driven biomolecular DOCKing (HADDOCK) server (), which incorporates the interaction restraints into the scoring function to guide the search toward regions of the conformational space in which the restraints are satisfied. While the extra terms in the scoring function due to the restraints do not significantly increase the computational burden if the sampling is based on Monte Carlo or molecular dynamics algorithms, a similar approach is very costly when used with FFT based sampling. The problem is that each pairwise restraint in the scoring function requires a new correlation function term, and thus an additional Fourier transform, thereby reducing the numerical efficiency of the method. Thus, it is not surprising that none of the successful FFTbased docking programs has the option of accounting for pairwise restraints. However, since FFT performs global sampling, there is no need for guiding the search toward feasible regions. Based on this observation, we solve the problem by directly selecting low energy solutions that also satisfy the restraints. As will be shown, this implies that frequently only portions of conformational space needs to be examined, and hence the computational efforts can actually be reduced. A further advantage is that the scoring function is not affected, and thus we retain the favorable properties of the ClusPro server, validated in many rounds of the CAPRI docking experiment. We demonstrate the method using both simulated and experimentally determined distance restraints.
MethodsA pairwise distance restraint can be defined by two sets of atoms, S 1 and S 2 and a distance range, d min to d max. The restraint is considered satisfied if there are at least one atom in S 1 and at least one atom in S 2 such that the distance between them falls in this range. While the implementation allows for arbitrary sets of atoms to be used to define a restraint, most frequently these involve a single atom or residue on each side of the interface. Given multiple restraints, users may want to require a certain number of restraints out of a group to be satisfied. In addition, restraints may be based on sources with varying reliability, requiring different cutoff values. Our implementation allows for grouping restraints into restraint groups, and restraint groups into restraint sets. Restraint groups are considered satisfied when more than a user specified number of restraints in the group are satisfied, and a restraint set is satisfied when more than a user specified number of its groups are satisfied. We have developed a Javascript Object Notation (JSON) based file format for specifying groups of restraints used by our restraint library, as well a script for converting data in the NOE format into our JSON format. A full description of the file format is provided in the Supplementary Data. Docking is performed using PIPER, which samples all translations and rotations of a ligand protein with respect to a receptor protein. When a restraint set is provided, PIPER will only report solutions that satisfy the restraints. We note that an FFT based approach has been reported for visualizing such regions of the conformational space. (van). To do this efficiently, for each rotation we first generate the set of translations that satisfy each individual restraint, called the feasible translation set for the particular restraint. We then consider the intersection of feasible translation sets for the restraints in each restraint group, and select the translations that appear more often than the cutoff for the restraint group. The selected feasible translation sets for each restraint group are merged in a similar way to generate the feasible translation set for an entire restraint set. We note that providing restraints can actually decrease the running times by using the restraint set to generate a feasible translation set for each rotation. For each feasible translation the van der Waals interaction energy is computed, and it is used to filter out translations that result in unacceptable clashes. If there are no feasible translations leading to an acceptable van der Waals energy, the rotation is skipped and no other energy terms are evaluated. In practice, this often results in skipping detailed energy calculation for the majority of the rotations. When the cost of generating the feasible translations is less than the cost of evaluating the additional energy terms, fast rotation skipping results in overall speedup. After selecting the solutions that satisfy the restraints, 1000 structures with the lowest PIPER energies are clustered and minimized to remove steric overlaps as customary in ClusPro ().
Examples of docking with restraintsWe first demonstrated the method using simulated distance restraints for a large set of complexes and using different requirements for the number of restraints to be satisfied (see Supporting Material). Here, we present two examples of docking problems with restraints based on experimental data, with details also given as Supporting Material. The first example is constructing the phosphoryl transfer complex between the signal transducing proteins HPr and IIA Glucose (E2A) of the Escherichia coli phosphoenolpyruvate:sugar phosphotransferase system, starting from the free form protein structures using 20 distance restraints based on intermolecular NOE measurements (). This problem was also studied using HADDOCK, defining a set of Ambiguous Interaction Restraints (AIRs) based on the NOE data (). We compared the results of docking without any restraint to the results of docking using the restraint set. ClusPro works very well for this problem even without any restraint, as the center of the second ranked cluster has interface RMSD (iRMSD) of 3.78 A  from the native state. Accounting for the restraints further improves the result, and the center of the largest cluster is shifted to 2.88 A  iRMSD (Supplementary). The second example is based on the study of the recognition of UbcH5c and the nucleosome by the Bmi1/Ring1b ubiquitin ligase complex (). Bmi1 and Ring1b are critical components of the polycomb repressive complex 1 (PRC1) that binds and ubiquitinates the nucleosome in histone H2A on Lys119. We note that the docking of the UbcH5c subunit of the PRC1 complex to histone H2A of the nucleosome was target 95 of the CAPRI docking experiment (). Restraints were generated after examining the evidence available from the literature. The catalytically competent geometry requires that Cys85 of UbcH5c be located relatively close to the H2A acceptor lysine, Lys119, and hence we created one restraint that had to be satisfied between these two residues. The required range, 08 A  , was fairly large, because these residues were located in flexible tail regions of the proteins. Based on mutation data Lys97 and Arg98 of Ring1b interact with the histone in the nucleosome, and hence we created a second restraint group with multiple restraints, from Lys97 to the set of surface residues on the histone. In this second group we only require one of the restraints to be satisfied, since we do not know which of the residues on the surface of the histone interact with Lys97. In this case the best structure without restraints has the iRMSD of 38.68 A  whereas docking using this restraint set produced a near-native pose ranked 2 with the iRMSD of 4.53 A  (Supplementary).
ConclusionsWe describe implementation of pairwise restraints in the FFT sampling approach. Unlike other approaches that bias the energy function to steer the docking towards satisfying the restraints, we leave the energy function intact and restrain the search space. Thus, the restraints provide additional information but docking results can be obtained without them. Users can vary the confidence in the restraints by varying the number of restraints to be satisfied, and by specifying restraints in groups. The approach generally improves docking results even with relatively spurious restraints. The method is freely available as part of the ClusPro protein docking server.
FundingThis research was supported by NIH/NIGMS under grants GM093147, GM061867 R35 GM118078, and U01HL127522 and by NSF under grant DBI-1147082 and AF-1527292. Conflict of Interest: none declared.
Bioinformatics, 2016, 13 doi: 10.1093/bioinformatics/btw306 Advance Access Publication Date: 29 June 2016 Applications Note Bioinformatics Advance Access published July 3, 2016 at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
B.Xia et al. at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
