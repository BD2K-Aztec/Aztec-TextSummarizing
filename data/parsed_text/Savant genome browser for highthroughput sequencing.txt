Motivation: The advent of high-throughput sequencing (HTS) technologies has made it affordable to sequence many individuals' genomes. Simultaneously the computational analysis of the large volumes of data generated by the new sequencing machines remains a challenge. While a plethora of tools are available to map the resulting reads to a reference genome, and to conduct primary analysis of the mappings, it is often necessary to visually examine the results and underlying data to confirm predictions and understand the functional effects, especially in the context of other datasets. Results: We introduce Savant, the Sequence Annotation, Visualization and ANalysis Tool, a desktop visualization and analysis browser for genomic data. Savant was developed for visualizing and analyzing HTS data, with special care taken to enable dynamic visualization in the presence of gigabases of genomic reads and references the size of the human genome. Savant supports the visualization of genome-based sequence, point, interval and continuous datasets, and multiple visualization modes that enable easy identification of genomic variants (including single nucleotide polymorphisms, structural and copy number variants), and functional genomic information (e.g. peaks in ChIP-seq data) in the context of genomic annotations. Availability: Savant is freely available at
INTRODUCTIONThe emergence of high-throughput (a.k.a. next-generation) sequencing technologies has made the acquisition of genomic data quicker and more affordable than ever before. Continued technological strides are being made to further improve throughput, cost and accuracy of the sequencing platforms, enabling largescale studies of genomes, populations and diseases. Within the field of personalized genomics, ambitious sequencing projects such as the 1000 Genomes Project, the International Cancer Genome Consortium and the Autism Genome Project, are seeking to identify genomic variants among human genomes and to use this knowledge to determine the genetic underpinnings of human diseases by associating variants with symptoms (; http://www.icgc.org/). Many computational * To whom correspondence should be addressed. tools have been developed for single nucleotide polymorphism (SNP), insertion/deletion (indel) and other types of genetic variation discovery in individuals sequenced using high-throughput sequencing (HTS) platforms (for reviews). The results of these analyses are being integrated into large-scale datasets, annotating each variant with the allele frequency in various populations, and enabling demographic and association studies. Simultaneously, HTS has also revolutionized functional genomics, where the ability to sequence RNA and DNA to extremely high coverage has made possible RNA-seq and ChIP-seq (), methodologies that help discover rare RNA transcripts, identify the location of transcription factor binding sites on the genome, as well as discover the locations of nucleosomes. RNA-seq and ChIP-seq data also consist of many reads aligned to a reference genome, which are then binned and analyzed for peaks that indicate putative transcription factor binding sites and exons, respectively. Additionally, anomalously mapped reads or pairs from RNA-seq experiments can suggest alternative splicing or fusion transcripts. The capacity of new sequencing technologies to generate huge volumes of raw sequence data has made its analysis a substantial informatics challenge. Sequencing machines typically output files containing a nucleotide sequence and quality values for each read, which can be tens to hundreds of gigabytes in size due to the sheer number of reads sequenced in a single run. These files can be easily parsed line-by-line by downstream computer programs because of their structured textual format, but are not intended for direct manual or visual analysis. While downstream analysis programs, such as read mappers, SNP callers and peak finders can identify regions of interest to the bench scientist, a visual analysis of the supporting data, as well as other, orthogonal, information is usually warranted before costly wetlab experiments are performed to confirm the biological validity of the prediction. Visualization of genomic data gives researchers the benefit of looking at information in a more natural and interpretable way compared with a textual representation. There are many different tasks that are facilitated by visualization including: (i) integration of multiple related datasets into a single view, to gain insight into the interaction between genomic features, (ii) algorithm development, where visualization of many putative calls (e.g. genomic variants, promoter sites, intronexon boundaries, etc.) helps with debugging and identification of true and false positives; and (iii) exploration of various genomic regions for specific signatures of functional sites that may be difficult to describe within a computer program, e.g. two closely spaced peaks in ChIP-seq data indicating adjacentbinding sites. Without the convenience of a visualization tool, in each of these settings all regions of interest would have to be painstakingly considered via manual analysis of the supporting data. A number of tools have been developed for visualizing genomebased annotations. The UCSC and Ensembl genome browsers, for example, are popular online tools that have traditionally been used to display various biological datasets, such as genomic variants, expressed sequence tag (ESTs) and functional genomic data, in the context of high-quality, manually curated annotations (). While both have been recently updated to support display of HTS data, their use for this purpose is onerous because: (i) a large amount of locally stored data must be uploaded to servers across the internet, (ii) once uploaded, the data being visualized cannot easily be manipulated or computed with; and (iii) server-side browsers are typically slow and non-interactive. Other visualization programs such as the Integrative Genomics Viewer, Artemis and Tablet (http://www.broadinstitute.org/igv;) are designed to run on conventional desktop computers and thus make use of local storage capacity and computing resources to overcome the shortcomings of web-based browsers. While these popular browsers allow for interactive visualization of HTS data, they have limited analytic capability, and are not extensible through user-contributed modules. A substantial barrier for researchers who use genomic visualization tools, for all types of data, is the disconnect between the processes of visualization and computerintensive analyses (), a void which is caused by visualization tools being programmatically inaccessible. Here, we introduce Savant, the Sequence Annotation Visualization and ANalysis Tool, which combines visualization of HTS and other genome-based data with powerful analytic tools. The Savant feature set (summarized in) was guided by three key design principles. (i) Ease of use: users can easily install the application, obtain and load data, and navigate to specific regions of interest. The general layout of data mirrors the standard genome browsers to shorten the learning curve. (ii) Speed and efficiency: the program quickly and dynamically sifts through very large datasets while maintaining a reasonable memory footprint. (iii) Access and extensibility: the underlying data is readily accessible from within the tool itself, and users can extend the application by adding any number of plug-ins for specific tasks.
Savant genome browser
INTERFACESavant has a simple and intuitive interface, which is customizable through the use of a modular docking framework.shows a screenshot of Savant, and illustrates its various components, expanded upon in the following subsections.
NavigationThere are several ways a user can specify the genomic region to be displayed by the viewer. Coarse navigation is made possible through a range selection panel whose horizontal length represents the length of the loaded genome, from which subranges can be chosen using the mouse. Alternatively, fine navigation is possible by entering the desired genomic range into text fields. Neighboring buttons enable zooming in and out and panning left and right. Each of these functions can also be engaged through mouse and keyboard shortcuts. Savant also uses a bookmarking framework to allow the user to switch between many regions of interest, as described lower.
Modules and docking frameworkSavant uses a modular docking framework, similar to those used in most Integrated Development Environments (IDEs). Each module within the application appears as a separate window that can be shown, hidden, maximized, minimized, resized, closed or rearranged in any configuration the user desires. Modules can also be detached from the main interface and moved to a separate location, which is useful for maximizing screen usage on setups having multiple displays. Savant includes a number of modules which are described in subsections that follow. To demonstrate the power and utility of Savant's plug-in framework the Table View module was implemented as a plug-in.
TracksA track is a visual representation of one dataset. Each track shows data of a single type, such as a genome, read alignment, gene set or generic annotation. A user can specify the region of the loaded tracks to be displayed via the browser's many navigation controls. By default, multiple tracks are stacked on top of each other so that positions along their horizontal axes correspond to the same location of the genome, which is standard for genomic viewers (). Simultaneously, Savant enables the user to lock a certain track, while updating the others, as is described in Section 3.1
BookmarksIt is often useful to make note of interesting regions while using the browser, or to load a set of such regions in order to quickly navigate between them. The Bookmarks module helps keep track of such locations. Users may add, remove or seek to a bookmarked region byusing buttons within the module or keyboard shortcuts. Furthermore, bookmarks may be tagged with a description and exported for future use or for sharing among colleagues.
M.Fiume et al.
Table viewFinally, while Savant aims to provide the user with the ability to compute on the underlying data directly, through the plug-in framework described in Section 5, in many cases the user may wish to identify the underlying data elements for export to an external program, e.g. identifying the genomic sequence within a window to align against another genome, or downloading all of the supporting reads for a SNP to make sure they do not align elsewhere in the genome. In Savant, the user can display the underlying textual data from any loaded track within the Table View. This module displays records as rows and fields as columns in a spreadsheet. For each read mapping, for example, thedisplays the read name, mapped position, CIGAR string and other SAM fields. The data can be sorted in either ascending or descending order with respect to any field. The spreadsheet can also be exported for further analyses.
VISUALIZATIONSavant retrieves and renders data every time a range change is requested by the user. Together, these processes happen quickly so as to confer seamless navigation around the genome. The renderer for each track is adaptive to both the display mode and the length of the viewed region chosen by the user.
Dynamic resolution changesSavant dynamically adjusts its resolutionthe amount of information it displaysto optimize both nucleotide-andgenome-scale visualization of tracks. For example, read alignments can be visualized as a coverage track when the number of base pairs within a region is too large to enable the visualization of individual reads. Once the region is small enough, Savant seamlessly switches to a read-alignment view, as shown in. In addition to presenting a more intuitive visualization, this feature also reduces the program's memory footprint and improves overall speed. Individual tracks can also be locked to a particular range so that they are not updated until they are unlocked. Locked tracks can be used as overview profiles from which subregions can be selected to specify range changes for other tracks. Track locking also enables simultaneous viewing of high-and low-resolution profiles.
Savant genome browser
Display modesParticular data types can be displayed in different modes. For example, interval annotations can be squished together on a single line or packed neatly so that none overlap (mimicking the squish and pack modes of the UCSC browser). The representation can be dynamically toggled within the browser, with each representation option emphasizing different aspects of the data. The variant and strand modes for read alignments, for instance, use colors to emphasize mismatches in reads and the strands to which reads are mapped, respectively. A novel mode for representing matepairs shows arcs between the mapped locations of paired reads, where the height of each arc is proportional to the inferred insert size. Arcs for anomalously mapped pairs, such as those suggestive of inversions or duplications, are colored differently. The various modes for read alignments are illustrated in.
FILE FORMATTING AND PERFORMANCESavant supports a number of common text-based formats, which are described in. However, because text-files do not enable fast random access, Savant formats and saves each file so as to provide very efficient search operations at runtime. The speed with which Savant can sift through large datasets is enabled by the way inwhich it formats and indexes data. In particular, formatting involves converting text records into an indexed binary data structure specific to each data type. Sequence and continuous tracks are stored as fixed-width records, enabling direct lookup of records of interest. Annotation ranges (such as genes) are stored using a binning scheme similar to the one used in the UCSC Browser () and in BAM files (), so retrieving all ranges corresponding to some region usually requires only one, and at most O(logn) disk seeks. File formatting can be done directly through the application itself. Savant keeps its memory usage low by adjusting its sampling rate depending on the size of the visualized range. The time and space requirements for the processes of data formatting and visualization were measured for a collection of human chromosome 1 datasets, including a genetic sequence, genes, SNPs, mammalian conservation and alignments of sequenced reads from an individual from the 1000 Genomes Project (40 coverage). The tests were performed on a Lenovo T61p laptop computer with an Intel Core 2 Duo CPU at 2.40 GHz and 3.0 GB of RAM. The results are summarized in. Formatting of the gene, SNP, sequence and conservation tracks took less than 10 min total, while the computation of a coverage track from a large set of read alignments took about an additional 40 min. The latter conversion is optional, and allows for dynamic switching between an alignment view and a coverage view as illustrated in. Runtime performance was assessed by measuring the time taken to navigate to ranges of various sizes. Each measurement was performed on a newly started instance of Savant and the start location of the range was randomized. For seeking arbitrary ranges of sizes 10 million to 10K bp, Savant took less than a second to fetch and render data. The performance was worst for ranges just slightly shorter than 10K long, where the large number of BAM records that are displayed require 2 s to be fetched from disk. Savant renders virtually instantaneously for regions having sizes on the order of hundreds of base pairs, where most fine-scale visualization is done.
PLUG-IN FRAMEWORKSavant is able to integrate user-defined plug-ins, allowing one to accomplish very specific tasks. Each plug-in can be one of two general types. Interactive plug-ins are allocated dockable modules on which graphical user interface (GUI) elements such as buttons or text fields can be placed to respond to user input and retrieve data. Non-interactive plug-ins are not designated a GUI component butstill have extensive access to the innards of the browser. A number of helper functions are provided to plug-ins which are summarized in. Plug-ins can be used, for example, to prototype a SNP finder by identifying variable columns currently in view, or for computing genome-wide statistics, such as the fraction of SNPs in exons. Plug-in development is straight-forward and requires implementation of one Java interface. The Bookmark Intersection Plug-in, shown in, is an example of an interactive plug-in. The plug-in allows the user to select two tracks, intersect them and load the intersecting regions into the list of bookmarks, enabling easy navigation to all of the regions of interest. Once developed, plug-ins can be shared among users through the Plugin section of the Savant web site.
M.Fiume et al.
EXAMPLE USESIn this section, we demonstrate example usages of Savant to identify and visualize various polymorphisms between the reference human genome and a Yoruban genome (HapMap individual NA18507) sequenced with the Illumina platform (). The raw reads and MAQ mappings (in BAM format) were downloaded from the 1000 Genomes web site, while the conservation track (in WIG format), gene annotations and dbSNP data were obtained from the UCSC database.shows two likely SNP variants inof the UI that allows the user to select two tracks have been omitted. Once the two tracks are selected, the bookMarkTrackIntersections() method is run, which, for each interval of one track, finds overlapping intervals of the other, and saves intervals with overlap to the bookmark panel. the NA18507 genome. SNPs are typically supported by consistent mismatches in aligned reads with respect to the reference at the variant positions. The reads support the existence of a transition. To identify variants of interest, the user selects the two tracks in the BookMarkIntersection window, and those variants that overlap exons are added to the list of bookmarks. The user can then easily go through this list. In this particular case the indel likely occurs in the intron between the exons, but because of MoDIL's inability to accurately identify borders of variants, the variant is shown as overlapping.
Savant genome browser
M.Fiume et al.mutation (C to T) at a known SNP site, indicating a likely common variant in the human population. There is also considerable evidence (3/12 reads) for another transition (G to A) slightly upstream, indicating a putatively novel SNP. Both of these SNPs fall in an exon of a gene, as shown by the annotation, while the conservation appears to drop-off in the immediate vicinity of the SNPs, indicating weakened evolutionary constraint. We also demonstrate the use of the plug-in framework to identify and investigate biologically interesting indel predictions made using an external tool. We used the dataset of predicted insertion and deletion (indel) polymorphisms predicted by MoDIL (), which identifies these variants by analysis of matepair data. In particular, MoDIL identifies regions of the genome with a significant number of discordant matepairs (those with a distance between the mappings of the reads significantly different from the expected insert size of the library). We built a plug-in to identify those indels that overlap exons, the code of which is shown in.displays the result of running this plug-in, together with one such region of interest. In this case, the deletion lies directly between two exons, and likely creates a genomic variant with a much shorter intron, or with the intron completely spliced out of the gene sequence. Taller arcs in the read visualization mode are indicative of 'stretched' matepairs that confirm the deletion, while the lack of read mappings within the deleted region indicates that the deletion is homozygous.
DISCUSSION AND FUTURE WORKIn this article, we introduce Savant, a genome browser customized for visualization of HTS data. In addition to dynamic visualization and support for multiple data types, Savant supports multiple novel features meant to simplify the analysis of genomic data, including a Bookmarks module to keep track of regions of interest, a Table View module to allow researchers access to the raw data underlying the visualizations and a plug-in framework that allows developers extensive access to the browser, enabling them to program novel analysis methods and extend the browser to support new visualization and data types. In the near future, we plan to expand Savant by supporting additional file formats, while also allowing users to automatically download annotation tracks from various public resources, such as the UCSC Genome Browser and the 1000 Genomes Project. Additional functionality, for example, to save/restore user sessions, enabling novel visualization modes, such as superimposition of tracks, and combining the matepair and regular read alignment views in a single panel will also be added in subsequent releases. Savant is an open source tool, freely available at http://compbio.cs.toronto.edu/savant/. We are also working to build a user community, accessible through the same web site. The community can be used to share Savant plug-ins with other researchers, as well as to communicate with the development team, to report bugs and to suggest new functionality and improvements.
at :: on August 31, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from [12:08 19/7/2010 Bioinformatics-btq332.tex]
at :: on August 31, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
