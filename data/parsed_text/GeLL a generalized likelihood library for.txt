Phylogenetic models are an important tool in molecular evolution allowing us to study the pattern and rate of sequence change. The recent influx of new sequence data in the biosciences means that to address evolutionary questions, we need a means for rapid and easy model development and implementation. Here we present GeLL, a Java library that lets users use text to quickly and efficiently define novel forms of discrete data and create new substitution models that describe how those data change on a phylogeny. GeLL allows users to define general substitution models and data structures in a way that is not possible in other existing libraries, including mixture models and non-reversible models. Classes are provided for calculating likelihoods, optimizing model parameters and branch lengths, ancestral reconstruction and sequence simulation.
IntroductionMany studies in molecular evolution use phylogenetic substitution models to infer patterns of change between homologous characters using maximum likelihood (ML). These models allow us to infer many valuable quantities, such as how the rate evolution varies among sites or the selective pressures acting on codons (). The growing availability of genome sequences has led to new forms of data, such as gene content and the presence or absence of promoters (e.g. ENCODE), and their study requires statistically rigorous inferential tools. Nearly all phylogenetic substitution models are continuous time Markov chains with discrete and finite state spaces, which require the same underlying computational machinery. General phylogenetic libraries, such as BEAST (), PLL () and Bio (), take advantage of these similarities and allow programmers to build phylogenetic models and are often the basis of existing packages. Here, we present GeLL, a Generalised Likelihood Library, which provides non-expert users a text interface to define data and models, allowing users to create data structures and models parameterizations that reflect the properties of their data. To aid in characterization of these models, GeLL also allows users to perform ML inference, simulate data and perform ancestral reconstruction.
CapabilitiesGeLL is designed around the idea that phylogenetic models are defined by three key components. The first component is a finite and discrete character space used to define a data matrix, such as a nucleotide sequence, counts of occurrences of gene family members in genome or presence or absence of morphological characters in a species. The second component is the instantaneous rate matrix of a continuous time Markov process that describes the relative rates of transition between characters in the model state space. These two components are related by a function that maps each single element of the character space on to one or more elements in the model state space. The final component defines output, which allows users to V C The Author 2015. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com access information derived from the other two components.shows the major components of GeLL and how they link together to perform phylogenetic analysis.
DataGeLL allows users to define their own character space, which can be any set of discrete characters for which users are confident of assigning one-to-one homology. The user expresses these homology statements through the equivalent of a multiple sequence alignment conditioned on that character space, which in turn is input into GeLL for computation. Data may be commonly used sequence character spaces, such as nucleotides or amino acids, or more unusual characters, including genome size, gene family copy number or ploidy number. A state may also contain groups of 'characters', such as the three nucleotides in a codon. GeLL comes with classes to read a traditional alignment (in relaxed Phylip and FASTA formats) or an 'alignment' of numbers (such as gene family size). The sites in an 'alignment' can be partitioned, so that each partition has its own model and the parameters of that model may be shared between all or subsets of partitions. The relationship between observed elements of the character space and the elements used in the model space may be straight forward, such as the direct mapping of 'A' in a nucleotide character-space to an 'A' in the model state space. One may wish, however, to include characters that represent uncertainty about the observed characters, such as the use of 'W' to represent the weakly bonding nucleotides A:T or work with covarion-style models (), where an observed 'A' may map to both an 'ON' state or an 'OFF' state in the model. To accommodate these forms of models, GeLL allows users to define the relationship between the observed character space and the state space used in the model.
ModelsThe most important component of GeLL for many users will be the Model class. Central to the definition of phylogenetic substitution models () is the rate matrix, Q, that uses a set of parameters to define the instantaneous rate of change between any two elements in the model state space. In, for example, the nucleotide HKY model is () defined through parameters describing the relative rate of change of transitions to transversions (k) and the stationary distribution of the nucleotides. GeLL allows users to define this matrix through a two-dimensional array of strings, with each string representing an equation consisting of parameters and simple mathematical operators. Models may be both reversible and non-reversible, with the maximum size of the model state space limited only by the computational resources available. Models may also have multiple rate matrices, allowing users to create complex mixture models, including models with multiple rate classes (), temporal hidden Markov models () and structure-based mixture models (). To enable non-stationary models, GeLL allows users to define the distribution of states at the root of the tree in one of four ways:(i) through a string of character-states, such as a sequence; (ii) through the stationary distribution of the rate matrix; (iii) through the quasi-stationary distribution for models with a sink-state () or (iv) through the method of, where root frequencies are proportional to the probability of that root assignment generating the data. We note that the quasi-stationary distribution is new to phylogenetics, although it has been used for modelling populations () and endemics (). To our knowledge, no other library allows users to define such a broad range of complex non-stationary and non-reversible models.
OutputGeLL provides a number of ways to study both a model and its application to data. At the simplest level, GeLL allows the computation of the likelihood of an alignment given a parameterized substitution model and a rooted or unrooted tree with branch lengths using the pruning algorithm (). Model parameters and branch lengths can also be estimated from sequence data using ML. Given a set of model parameters and data, GeLL can be used to simulated data or perform ancestral reconstruction using either marginal () or, in the case of nonmixture models, joint reconstruction (). To aid the statistical comparison of models, there are also classes for comparing models through the likelihood ratio test statistic (), the Akaike information criteria () and the Bayesian information criteria (). Classes are also included that allow the comparison of models with different state spaces using the method of Whelan et al. (2015).
Using GeLLcode new models to help users to become familiar with GeLL's syntax. It also includes a broad comparison of GeLL's features and performance with other phylogenetic libraries and software packages (Supplementary Tables S2 and S3), the numerical optimization methods available in GeLL (Supplementary) and the tests used to verify GeLL's calculations (Supplementary).
Bioinformatics, 31(14), 2015, 23912393 doi: 10.1093/bioinformatics/btv126 Advance Access Publication Date: 27 February 2015 Applications Note at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
GeLL offers considerably different functionality than existing libraries, such as Bio (Guguen et al., 2013) or packages, such as HyPhy (Pond and Muse, 2005) and PAML (Yang, 1997). By allowing users to define the character space of their data, the state space of their model and how the two spaces interact, it allows complex model specification outside the norms of phylogenetic inference, in contrast to existing tools that are strongly linked to existing modelling approaches and structures. The generality of the model, including the specification of non-reversible models and the root distributions, also allows users to create novel and complex models that cannot be implemented in existing packages. GeLL includes a driver which allows many simple investigations to be completed without the need for any programming. To further demonstrate the functionality and utility of GeLL, we include as an example the models described in Mayrose et al. (2010) to describe the evolution of chromosome number. This implementation required fewer than 100 lines of code and around half an hour of programming. A second example comes from our previous work, where GeLL was used to model gene family evolution through a birthdeath-innovation model with an upper bound on family size (Ames et al., 2012). The Supplementary Material includes many examples of how to Fig. 1. A schematic of the major components of GeLL, including examples of models that can be implemented in GeLL such as, from left to right, a twostate binary character model, the HKY nucleotide model, amino acid GTR models and birthdeath models
D.Money and S.Whelan at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
