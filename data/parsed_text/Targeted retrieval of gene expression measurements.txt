Motivation: Large public repositories of gene expression measurements offer the opportunity to position a new experiment into the context of earlier studies. While previous methods rely on experimental annotation or global similarity of expression profiles across genes or gene sets, we compare experiments by measuring similarity based on an unsupervised, data-driven regulatory model around pre-specified genes of interest. Our experiment retrieval approach is novel in two conceptual respects: (i) targetable focus and interpret-ability: the analysis is targeted at regulatory relationships of genes that are relevant to the analyst or come from prior knowledge; (ii) regulatory model-based similarity measure: related experiments are retrieved based on the strength of inferred regulatory links between genes. Results: We learn a model for the regulation of specific genes from a data repository and exploit it to construct a similarity metric for an information retrieval task. We use the Fisher kernel, a rigorous similarity measure that typically has been applied to use generative models in discriminative classifiers. Results on human and plant microarray collections indicate that our method is able to substantially improve the retrieval of related experiments against standard methods. Furthermore, it allows the user to interpret biological conditions in terms of changes in link activity patterns. Our study of the osmotic stress network for Arabidopsis thaliana shows that the method successfully identifies relevant relationships around given key genes. Availability: The code (R) is available at
INTRODUCTIONConsiderable effort has been spent on collecting gene expression measurements into huge public repositories. This has opened up the door to large-scale comparisons and meta-analysis of data from different experiments. A crucial question is how to find datasets that are biologically relevant for a certain phenomenon under study. The common way to obtain relevant data from repositories is keyword search (for instance,); however, the reliability and usefulness of this approach fully depend on the availability and quality of data annotation, and on the existence of good standardized keywords. Therefore, content-based retrieval methods have received attention recently. In addition to detecting other relevant datasets, such methods can assist in automatic prediction of annotations and in discovering previously unknown relationships between different biological conditions. Previous data-driven approaches for relating gene expression profiles can be grouped by two criteria: the representation of gene expression profiles and the similarity measure for comparing profiles. Regarding the representation, there exist three common alternatives: (i) activity profiles over genes, often differential rather than absolute values if control measurements are available, or simply rankings of genes (); (ii) activity profiles over known gene sets (also called pathways or signatures;) and (iii) activity profiles over gene modules predicted from other data sources (e.g. proteinprotein interactions;). The most widely used similarity measures are Pearson and Spearman correlation (); other search tools take signatures of up-and down-regulated genes as a query and compute rank-based scores against the measurements in a database (); neither approach is fitted in any way to the database. In contrast, several approaches derive features from the database or learn a model of it; the results are then used when computing the similarity of the query to database entries. In the simplest case, variances of gene or gene set activity values are determined from the data compendium, and then exploited for calculating a weighted correlation coefficient (); beyond that, one can apply dimensionality reduction techniques to learn low-dimensional feature spaces that represent the data appropriately ().) proposed probabilistic generative *To whom correspondence should be addressed. latent variable models that inherently yield probabilistic similarity measures between gene expression profiles. In addition to these purely unsupervised methods, also supervised approaches have been proposed to relate gene expression experiments with each other (). The novelty of our approach lies in the fact that the model learned from the data compendium focuses on inferring the local regulatory network neighborhood of specific user-defined genes of interest. As a well-defined and intuitive model-based retrieval criterion, we use the Fisher kernel (FK) (), which derives a similarity measure between data points from a generative model. Consequently, the comparison of biological samples is based on the differential activity of particular cellular processes only. The alternative of using global transcriptomic models and hence global similarities between data would easily obscure the interesting local processes shared between measurements. The alternative of using known ontologies, on the other hand, would miss unknown regulatory patterns. In practice, the user can focus the modeling by providing known key genes involved in the biological process under study or genes whose connection to known pathways and experimental conditions is yet unclear. Our model-driven targeted retrieval approach is intended to complement earlier tools for experiment retrieval targeted by query genes:retrieve experiments where the query genes are differentially expressed,retrieve datasets where the query genes are correlated, and Greene and Troyanskaya (2011) identify experimental conditions discriminating positive and negative query genes. As our approach models relationships of biological samples with respect to only a subset of genes, it shares some aspects with bicluster detection methods, which are very popular in gene expression analysis (); defining genes of interest and a query sample can be seen as providing a seed bicluster. However, in contrast to bicluster approaches, we bring the structure of gene networks into the similarity criterion. A related approach has been proposed by, but it assumes a given network whereas we infer the network around the target genes. Furthermore, none of the earlier biclustering-type approaches has been designed for retrieval. In a nutshell, our approach consists of the following components, which will be described in detail in Section 2. First, a regulatory model of gene expression is learned from the database; to allow for more user interaction and better individual interpretability, the model focuses on relationships around user-defined genes of interest; here, we use a set of local dependency models learned by sparse linear regression as a simple regulatory model (). Second, the model serves as a basis for comparing measurements: given a query measurement, the method ranks the measurements in the repository according to a model-based similarity criterion, here a variant of the FK (). In Section 3, we show the effectiveness of our approach in a leukemia case study with a human microarray compendium and in an osmotic stress study with a collection of plant stress datasets. Section 4 discusses the work and describes future extensions.
METHODS FOR TARGETED COMPARISON OF GENE EXPRESSION MEASUREMENTSOur approach for comparing gene expression measurements consists of two main steps: (i) learning a conditional expression model for a given target gene list, using a large data compendium and (ii) computing Fisher score similarities between measurements based on the model. In the following, we describe the steps in detail.
Targeted gene expression modelOur goal is to build a model for the expression of target genes, conditioned on the expression of other genes. Let us first introduce some notation. The X  X 1 ;. .. ; X p  is a p-dimensional random variable that represents the gene expression profile, where p is the total number of genes. Let T & f1;. .. ; pg be the set of target gene indices and T the set of all the remaining gene indices (f1;. .. ; pg n T ). Then, X T denotes the variable X limited to the subspace defined by T. Furthermore, let X be the data matrix, containing in row i the i-th realization of X, which is denoted by x i  x i 1 ;. .. ; x i p ; 1 i n. We are interested in modeling the expression values of the target genes given the expression values of the remaining genes, that is, modeling of the distribution PX T jX T . One prominent formalism for modeling conditional independence relationships between variables is Gaussian graphical models (GGMs), introduced by Dempster (1972); see Dobra et al.(2004) and Markowetz and Spang (2007) for the use of GGMs in gene network reconstruction. In that context, estimating the model structure is challenging due to the 'small n, large p' problem. A common approximation is to estimate the neighbors of each gene separately and combine these estimates into a so-called dependency network (). We use a local dependency network composed of individual neighborhood estimates for each target gene j 2 T. Each neighborhood estimate is obtained by learning a Gaussian linear model (see, e.g.X j  X fjg  "; " $ N 0; 2 ; 1 where is a weight vector and 2 the variance of the Gaussian noise; the variables X 1 ,.. .,X p are assumed to have been standardized to mean 0 and unit variance, and hence we need not consider an intercept term. In high-dimensional settings, it is desirable to obtain sparse estimates for , i.e. solutions where most entries are 0. The variables corresponding to non-zero entries build the 'neighbor set' of the j-th variable, written as Nj  fk 2 f1;. .. ; pg n fjg : indk 6  0g: 2Here, ind(k) indicates the position of that is mapped to the variable X k. Sparse coefficient estimates are achieved by applying L 1-norm regularization or Lasso (), yielding the following solution:Meinshausen and BuhlmannBuhlmann (2006) provide an analytical choice for the penalty parameter that guarantees asymptotically consistent neighborhood estimates for sparse high-dimensional graphs. All results reported in this article use the analytical-value, with the constant (bounding the probability of falsely joining two connectivity components) fixed to 0.05, as in the original article and in SchaferSchafer and; it yielded sparser solutions than the-value chosen by cross-validation. To obtain a model for the whole set of target genes, we simply concatenate the gene-specific models, treating them as independent. This is a widely used model approximation strategy, based on the so-called 'pseudo-likelihood' (For compactness, we write in the following L j ; x i  instead of Px i j jx i fjg ; j . Here, j denotes the parameters of the j-th independent submodel, in our case consisting of the coefficient vector (j) and the variance j 2. The likelihood of a submodel with respect to the i-th data point is calculated as follows:
Model-based similarity measureHaving learned a model for the expression of target genes, we exploit it for defining the similarity between gene expression profiles. For that purpose, we represent each expression profile (data point) by its Fisher score with respect to the model; the score is defined as the gradient of the log-likelihood for the profile  with respect to the parameters  at the learned values of the parameters (Shawe). In our modeling setup, each submodel has its own parameters, and by concatenating the gradients of all submodels, we obtain a gradient of the global pseudo-log-likelihood. The parameters of biological interest in each submodel are the weight coefficients for the neighbors of the respective target gene; we ignore the derivative regarding the noise parameter j , because the noise is assumed to be independent of the biological condition. The partial derivative of the log-likelihood with respect to ind(l) (j) amounts toConcatenating these partial derivatives yields the Fisher score representation of the i-th data point, written as s ^ x i , where ^ denotes the estimated parameters of the overall model, which here are the L1-regularized maximum-likelihood estimates for. The inner product in this new feature space is a model-dependent similarity measure K , also called the simple Fisher kernel (FK) (; Shawe):To understand this measure, recall that the gradient of a function is sufficient for determining its first-order Taylor series approximation. In our case, the function is the (pseudo-)log-likelihood of the model. Its first-order Taylor series approximation evaluated at ^ is log L; x i  % log L ^ ; x i   r log L;where r log L; x i  ^ denotes the gradient of the log-likelihood for x i at ^ and the ^ are the (maximum-likelihood) parameter estimates obtained on some training dataset D  not necessarily the ones maximizing the likelihood when a new data point x i is added to the dataset. Since the approximation is exact in the close neighborhood of ^ , the gradient r log L; x i  ^ , which is identical to the Fisher score s ^ x i , indicates the direction in which to update the parameters in order to maximize the log-likelihood for x i , starting from the current parameters ^ . Hence, we get a parameter update for the extended dataset D  x i1 by gradient ascentwhere d is a suitably small step size. In the same way, we obtain an updated parameter estimate ^ new x i 2  for D  x i2. As the model parameters constitute the summary statistics of the dataset under the assumptions of the model, comparing ^ new x i 1  and ^ new x i 2  is sufficient for comparing the datasets D  x i1 and D  x i2. This is a well-defined way for doing a model-based comparison of two different data points x i1 and x i2 if D is the dataset from which the model has been learned. Furthermore, the informative part here is the comparison between s ^ x i1  and s ^ x i2 , ignoring the step size (Shawe). In terms of differential geometry, the proper metric for comparing models on the Riemannian manifold of the model class is the Fisher information metric. The steepest ascent locally along the manifold is the natural gradient J 1 s ^ x i1 , where J is the Fisher information matrix. Replacing the gradient s ^ x i1  in Equation (8) by the natural gradient and applying the metric, we obtain a kernel that is proportional to s ^ x i1  T J 1 s ^ x i2  (). The simpler kernel s ^ x i1  T s ^ x i2  is a suitable approximation () that makes the computation much more efficient. In summary, the inner product between the Fisher scores of two different data points x i1 and x i2 is an approximate measure for the similarity of the resulting datasets, from the model's point of view, when adding either x i1 or x i2 to the data. In our case, we compare the Fisher scores with respect to the coefficients, which indicate the strength and the sign of gene relationships (i.e. whether the co-regulation is in the same direction or in opposite directions). In retrieval, which is the primary application in this article, this similarity criterion is used to compare a new measurement profile against all previous ones, which results in a ranked list of the measurements available in the database. The underlying model is learned based on the whole database and does not require any experimental annotation. The retrieval is computationally inexpensive because the gene-specific submodels as well as the corresponding scores can be pre-computed offline on the data compendium. At query time, we only have to compute the scores of the query and then compute inner products between the query scores and previous measurement scores, where only scores of submodels for genes specified in the user-given target list are considered. These operations require O(KM) time, where K is the number of non-zero coefficients in the model and M is the number of measurements in the database.
RESULTSWe applied our method in two case studies: human leukemia and plant stress. We show that targeted expression models are not only able to enhance the retrieval of related measurements but also allow for interpretation of underlying biological processes in terms of networks and network activation patterns. Prior knowledge in the form of key genes is taken into account, and relevant relationships (putative network neighbors) of the genes are inferred directly from the data.
Leukemia case studyFor a proof-of-principle study of the new method's performance, we used a large compendium of human microarrays (); it consists of 5372 measurements from different cell types tissue types and disease states, which have been collected from 206 different studies, all based on the same microarray platform (Affymetrix U133A). A subset of 567 samples from 15 studies are labeled as leukemia (according to the '15 metagroups' annotation). We tested the performance of the model-based method for the task of retrieval of relevant experiments (REx) by 5-fold cross-validation, where one-fifth of the leukemia samples were excluded from the model training and then taken as queries. The model was learned from the remaining leukemia samples and all non-leukemia samples, without using the label information. The ranked retrieval results were evaluated based on the given annotation (leukemia versus non-leukemia). The precision of the top-k results of a query is given by the fraction of leukemia samples among the first k samples. As targets, we chose eight genes that are known to play a role in leukemia: BCR, ETV6, FLT3, HOXA9, MYST3, PRDM2, RUNX1 and TAL1. They were also reported as being differentially expressed in the 567 leukemia samples (among a list of 243 genes;). This preselection might give a positive bias to the precision values, which we controlled by testing whether this set of target genes would be a good biomarker for discriminating leukemia samples against non-leukemia samples. We observed that baseline approaches (Pearson correlation, Euclidean distance) restricted to this set of genes are clearly inferior to REx in the cross-validation performance (; rows 1, 7 and 8), and hence REx has a competitive advantage here. We tested two variants of REx: the first one learned the expression model by choosing predictors from among all the other genes of the total set of 13 262 measured genes; the second took only the other target genes into account. Interestingly, the second variant is only slightly worse than the first at the high precision end (top1 and top5 results), and it is even better than the first when looking at more than five retrieval results (; rows 1 and 2). This indicates that already the relationships among the eight target genes (i.e. at most 56 links) are sufficient for almost perfect retrieval performance. Both variants of REx achieved an enormous dimensionality reduction compared with the baseline methods that use all genes (the first REx variant used on average 351.4 links, the second 44.4); in addition to increasing the biological interpretability, REx led to the best retrieval results (; rows 1, 2, 5 and 6). Finally, we benchmarked the FK similarity used in REx against the simpler baseline similarity criteria (Pearson correlation, Euclidean distance) when controlling the dimensionality of data representations to be equal. For that purpose, we constructed hybrid approaches that take the predictor genes from the learned expression model and then compute Pearson correlation or Euclidean distance on their expression values. The similarity criterion of REx, which considers modeled relationships between predictor genes and target genes, achieved better results in the retrieval task (; rows 1, 3 and 4). Variances across the 567 queries were generally high, but with REx they were lower than with the other methods. For instance, at the top100 results, REx had slightly lower average precision, but also lower variance than the hybrid method with Pearson correlation, which had the best average precision at that level.
Plant stress case studyBesides being efficient and effective in finding relevant data, retrieval by targeted models can assist in analyzing molecular pathways related to specific biological processes. Here, we present a study on osmotic stress regulation in Arabidopsis thaliana.3.2.2 Retrieval of osmotic stress measurements One widely studied type of plant stress is osmotic stress, which relates to dehydration of the plant caused by environmental conditions such as drought, high salt concentration or cold (). The transcription factor DREB2A has been found to play a central role in osmotic stress response in A.thaliana; it interacts with a dehydration-responsive element (DRE).experimentally induced overexpression of a constitutively active form of DREB2A and published a list of 36 genes that responded with expression changes greater than eight times, relative to control plants. We refer to this list, together with DREB2A, as 'Sakuma-all' later on. Note that the underlying experiment is not included in the data compendium we use in our analysis. Nine out of these strongly overexpressed genes are annotated as water-stress-related and have a DRE element in the upstream region. We call this list, with the addition of DREB2A, 'Sakuma-water'. Moreover, we downloaded from STIFDB (http://caps.ncbs.res.in/stifdb/browse.html#se)) a list of 41 genes annotated as 'droughtsalt-cold', which originally has been derived by integrating various microarray datasets. This list is named 'STIFDB' hereafter. 'Sakuma-all' and 'STIFDB' share only four genes, since DREB2A is not activated by cold stress. Our data collection contained 31 osmotic stress samples from five different datasets (comprising at least six samples). We investigated the retrieval performance of REx by cross-validation in a leave-one-dataset-out manner, using the same six comparison methods as in the leukemia case above.shows the resulting precisionrecall curves for the three different lists of input genes: Sakuma-water, Sakuma-all and STIFDB. In all cases, REx performs better than the baseline methods. The best retrieval results are obtained with Sakuma-water and REx, closely followed by the REx variant restricted to only operate on the target genes; the top false positives are shown in the Supplementary Material. For the other two gene lists, restricting the REx model only to predictors among the target genes was actually beneficial for the retrieval. One possible reason for this observation is that these lists are larger than Sakuma-water and thereby can already explain by themselves the expression of some central target genes sufficiently well, whereas less relevant external predictors can decrease the performance. Next, we take a closer look at the osmotic stress network learned around Sakuma-water targets.
Data Collection, preprocessing and annotation
Analysis of osmotic stress gene networkThe REx method extracted 29 additional genes with putative relationships to genes in Sakuma-water; they form three networks which we refer to as DREB2A, RD29A and AT2G46140 after the central target of each network (). Target genes are depicted as boxes. Arrows go from putative predictors to targets; they do not indicate regulatory relationships. Only one negative (i.e. suppressive) gene relationship was found (dashed edge). Black edges indicate relationships that are strengthened in osmotic stress relative to the base model (i.e. the corresponding coefficients move further away from zero in 475% of the osmotic stress samples). The remaining, gray edges mark relationships with larger heterogeneity.provides an overall view of the expression changes across all datasets in terms of model-based Fisher scores with respect to the three networks. The RD29A network is the largest of the three networks; it is activated by drought and osmotic stresses, by cold stress (which has an osmotic stress component), and by the plant hormone abscisic acid, also a regulator of abiotic stress. The DREB2A network shows some osmotic stress regulation and regulation by UV-B radiation. Closer inspection of the genes in this network indicated that they could be part of the plant heat shock response. We validated this hypothesis against an independent dataset containing a time course heat shock experiment (Supplementary). Indeed, the genes showed rapid expression response to heat shock. The role of DREB2A as regulator in osmotic stress and heat shock response is well established (). The smallest network, centered around AT2G46140, is a novel finding suggesting that DREB2A and some of its targets also have a role in responses to pathogen infection and pathogen elicitors. We checked the significance of the inferred gene relationships in a bootstrapping experiment (see Supplementary Material). The most prevalent relationships were well supported by functional annotations. In addition, concordant expression between the transcription factor DREB2A and the predictors AT3G62260 and ZAT12 was validated in two independent datasets, giving rise to interesting biological hypotheses (see Supplementary Material). While further experimental studies are needed to untangle regulatory mechanisms of stress genes, our results show that the relationships discovered by REx are relevant in recognizing osmotic stress conditions.
Robustnessagainst nuisance target genes A further question is whether errors in the target list are harmful for the retrieval. To study this, we added randomly picked genes to Sakuma-water; they were chosen among the other 6648 genes (genes showing only minor differential expression in all datasets were removed in the preprocessing). We did 50 repeats on each number of additional genes. Supplementaryshows the average retrieval performance. As expected, a larger number of added random genes led to a stronger decrease in precision. However, the change was not very dramatic, implying that a reasonable number of unrelated genes can be tolerated quite well as long as the target list contains also discriminative genes.
DISCUSSIONWe introduced a novel approach for targeted model-based retrieval of gene expression measurements. The model we proposed is suitable for efficient retrieval; due to the decomposition into gene-specific submodels, learning can be done offline, prior to the queries. Although we used L1-regularized regression to learn a simple regulatory model in this work, the approach is not limited to a specific type of probabilistic models. For instance, it is straightforward to use the elastic net approach (), and it is also possible to exploit additional data (e.g. proteinprotein interactions) or prior knowledge during learning. If the user-specified genes are modeled jointly (e.g. by common predictors), more computational effort is required at query time; alternatively, the model may be provided directly by the user. In contrast to condition-specific regulatory models (), our method does not rely on annotation of samples. The current modeling approach requires that data are comparable. To apply it in cross-platform analysis, previous methods to achieve comparability can be used (). An interesting direction for future work is retrieval across different platforms or species using an integrated model. Besides allowing for unsupervised data-based retrieval of related measurements, the proposed method assists in investigating relationships among genes. As illustrated in the osmotic stress example, measurements with curated annotation can help to assess the quality of models and to detect condition-dependent activity changes. When applying targeted modeling, an important question is how to choose the target list for a biological process of interest. If it is too narrow, it might not have sufficient discriminative power; if it is too wide, the performance might suffer due to irrelevant genes. The retrieval framework allows the user to check different possibilities and to interactively improve the target list for her purposes. It also makes possible exploration of the types of retrieval results a particular target list yields, exploiting different kinds of annotations that are available for the database content. This can be useful if the user is interested in specific genes, but uncertain about the processes they are involved in. Finally, the targeted modeling and retrieval approach can be a useful analysis tool also for other omics-type high-throughput data.with respect to the networks in; columns represent network links. The horizontal line separates osmotic stress samples from the other samples, the vertical lines separate the networks. The RD29A network is highly activated in osmotic stress samples. The DREB2A network is activated in UV-B samples and some osmotic stress samples. The AT2G46140 network is induced by pathogen infection and treatment with pathogen elicitors. Annotation of each sample can be found in Supplementary
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
E.Georgii et al. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
Model-based targeted retrieval of gene expression measurements at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
.2.4 Smallest discriminative set of target genes In Figure 1, we observed that the list of targets (Sakuma-water) is more discriminative on our data compendium than the larger lists Sakuma-all and STIFDB. Next, we were interested whether even smaller lists of target genes have discriminative power. For that purpose, we tested the retrieval performance with reduced versions of Sakuma-water. More specifically, for given sizes of the target list, we used cross-validation on the training set to choose the best subset of Sakuma-water satisfying the size constraint, where the quality criterion was average precision (across the whole recall range). This best subset was used to learn a model with all training data, which was then tested on left-out test data. Training and test data were defined by cross-validation in exactly the same way as for Figure 1. Supplementary Figure S4a shows the precisionrecall curves obtained on the test data (averaged across all queries) for different sizes of the target list. Target lists of size 3 outperformed the original target list of size 10. The exact composition of the subset differed between the cross-validation folds, but only the following genes occurred (in decreasing order): RD29A, LEA7, COR15A, AT3G17520 and LSR3. Remarkably, a model with a single target gene performed very well, except in the top precision region. In all cases, RD29A was the selected gene (responsive to dehydration). However, while selected subsets of targets can be very powerful, on average the retrieval performance decreases monotonically when reducing the size of the target list (Supplementary. Fig. S4b).
