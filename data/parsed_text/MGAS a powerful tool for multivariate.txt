Motivation: Standard genome-wide association studies, testing the association between one phenotype and a large number of single nucleotide polymorphisms (SNPs), are limited in two ways: (i) traits are often multivariate, and analysis of composite scores entails loss in statistical power and (ii) gene-based analyses may be preferred, e.g. to decrease the multiple testing problem. Results: Here we present a new method, multivariate gene-based association test by extended Simes procedure (MGAS), that allows gene-based testing of multivariate phenotypes in unrelated individuals. Through extensive simulation, we show that under most trait-generating genotype– phenotype models MGAS has superior statistical power to detect associated genes compared with gene-based analyses of univariate phenotypic composite scores (i.e. GATES, multiple regression), and multivariate analysis of variance (MANOVA). Re-analysis of metabolic data revealed 32 False Discovery Rate controlled genome-wide significant genes, and 12 regions harboring multiple genes; of these 44 regions, 30 were not reported in the original analysis. Conclusion: MGAS allows researchers to conduct their multivariate gene-based analyses efficiently , and without the loss of power that is often associated with an incorrectly specified geno-type–phenotype models. Availability and implementation: MGAS is freely available in KGG v3.0 (http://statgenpro.psych iatry.hku.hk/limx/kgg/download.php). Access to the metabolic dataset can be requested at dbGaP (https://dbgap.ncbi.nlm.nih.gov/). The R-simulation code is available from http://ctglab.nl/people/ sophie_van_der_sluis.
IntroductionStandard genome-wide association studies (GWAS) involve the univariate regression of one trait on a large number of genetic variants (single nucleotide polymorphisms, i.e. SNPs), while adapting the nominal a criterion level for the extensive multiple testing (typically a  5  10 8 ). This analysis is limited in two important ways. First, genes, not SNPs, are the functional unit in the genome (). Although SNPs may have different allele frequencies and linkage disequilibrium (LD) structure across human populations, genic function is highly consistent. Furthermore, analysing genes rather than SNPs decreases the multiple testing problem, and relaxing the significance threshold in gene-based analyses improves the statistical power of GWAS studies (). Second, traits of interest are often multivariate in nature, i.e. multiple phenotypes are measured to cover the full extent of a trait. For instance, cognitive ability is usually measured through test batteries covering various cognitive abilities (e.g. vocabulary, memory). Similarly, diagnostic interviews and clinical questionnaires cover a collection of symptoms to deal with the symptomatic heterogeneity. In the GWAS context, this multivariate information is generally reduced to a univariate score, i.e. a univariate full-scale IQ score, or a binary casecontrol index. Reducing multivariate to univariate data nearly always results in loss of information. Specifically, whether univariate composite scores exhaustively summarize all information in the multivariate data (i.e. are sufficient statistics) depends on the true trait-generating genotypephenotype model, i.e. the model that describes how the multiple phenotypes and genes jointly generate the observed trait (). (Specifically, in factor analytic terms, sum scores are only sufficient statistics if (a) all correlations between the phenotypes are explained by one latent trait or factor, (b) all phenotypes have identical factor loadings, (c) all phenotypes have identical residual variances [i.e. the phenotypes adhere to a so-called, and the genetic effect is on the latent factor (illustrated in). In all other cases, the sum score is not a sufficient statistic and conducting association analysis on the sum score will result in a considerable loss in power to detect genetic effects (). Noteworthy: the variancecovariance structure of data generated through a network model may closely mimic the variancecovariance structure of data generated through a 1-factor model (), implicating that factor analytic results are not sufficient to determine the true trait-generating model.) Various simulation studies have shown that overreliance on the unidimensional trait-generating model, and the associated use of univariate composite scores, can result in considerable loss of statistical power to detect genetic variants (). Gene-based methods for the univariate trait setting are available (e.g. GATES, VEGAS, JAG,), as are multivariate methods for the genome-wide SNP-based setting [e.g. MultiPhen, canonical correlation analysis (CCA), i.e. multivariate analysis of variance (MANOVA) with the SNP-effect treated as covariate, TATES and JAMP:; http://ctglab.nl/software/]. However, to date, only two recently published methods () incorporates both. In fact, the rapid multivariate multiple linear regression (RMMLR) method proposed byis essentially equivalent to the multivariate gene-based CCA/ MANOVA proposed by Tang and Ferreira, leaving only one MANOVA-based method. MANOVA (and thus RMMLR), however, is known to be powerful specifically if the genetic variant affects only one or a few of multiple correlated phenotypes, but power decreases when the variant affects all or many of the phenotypes (). Here, we present a multivariate gene-based genome-wide analysis tool that is based on an extended Simes test (), MGAS (Multivariate Gene-based Association test by extended Simes procedure). MGAS combines P-value information obtained in standard univariate genome-wide SNP-based association software to arrive at a multivariate genebased P-value P MGAS. The standard GWAS can thus be considered an MGAS preprocessing step. MGAS is implemented in knowledgebased mining system for genome-wide genetic studies (KGG v3.0), is freely available (http://statgenpro.psychiatry.hku.hk/limx/kgg/ download.php), and has a user-friendly graphical interface for loading P-value files and genetic and phenotypic correlational information, and for visualizing results and annotating sequence variants and interesting genes.
Methods and results
The MGAS algorithmSuppose m phenotypes and n SNPs located in one gene. Regular GWAS software [For data including unrelated individuals: e.g. PLINK, Mach2dat/DSL, SNPtest, Gen/ProbABEL and FaST-LMM (tests the m  n univariate phenotype-SNP associations using a statistically appropriate method (e.g. linear or logistic regression depending on the measurement scale of the phenotypes). MGAS subsequently combines the resulting, ascendingly ordered, P-values p 1. . .p m  n to obtain one overall, multivariate gene-based P-value P MGAS as follows:Here, q e denotes the effective number of independent P-values within a gene. Whereas the total number of P-values equals m  n, the effective number is corrected for the fact that the P-values are dependent, i.e. correlated due to both the correlations between the phenotypes and the correlations between the SNPs. Parameter q ej denotes the effective number of P-values among the top j P-values, where j runs from 1 to m  n, and p j denotes the jth P-value in the list of ordered P-values. P MGAS is thus the smallest weighted P-value associated with the null hypothesis that there are no associations between the m phenotypes and the n SNPs within the gene, and the alternative hypothesis that at least one of the m phenotypes is associated to at least one of the n SNPs in the gene. Let p 1 and p 2 denote the P-values associated with the test of the association between phenotype m 1 and SNP n 1 , and between phenotype m 2 and SNP n 2. The correlation between p 1 and p 2 depends on the observed correlations between the SNPs r n1n2 , and the observed correlation between the phenotypes r m1m2. An estimate of the effective number of P-values among the top j P-values, q ej , is obtained through eigenvalue decomposition of the correlation matrix U among the m  n ascendingly ordered P-values. This correlation matrix is not observed, but can be accurately approximated from the n  n SNP correlation matrix, X, and the m  m phenotypic correlation matrix, R (see Section 2.2 later). Specifically, q ej is calculated as:where j denotes the number of top j P-values, k i denotes the ith eigenvalue, and I(k i ) is an indicator function, which takes on value 0 if k i 1 and value 1 if k i > 1:The effective number of P-values q ej is thus calculated as the observed number of P-values j minus the sum of the difference between k i and 1 for those eigenvalues > 1. If all j P-values are uncorrelated (i.e. if the phenotypes m and/or SNPs n involved in the statistical tests giving rise to the j P-values, are uncorrelated), then all j eigenvalues equal 1, and q ej  j  0  j. Conversely, if the j P-values are perfectly correlated (i.e. if the phenotypes m and the SNPs n are perfectly correlated), then the first eigenvalue equals j, all other eigenvalues equal 0, and q ej  j  (j  1)  1 (i.e. testing the association of perfectly correlated phenotypes with perfectly correlated SNPs yields only one unique unit of information). In practice, we expect that q ej will generally be smaller than j but larger than 1, since the phenotypic correlations and the SNP correlations likely take on values between 0 and j1j. Finally, q e is a special case of q ej , i.e. q e  q ej when j  m  n, i.e. when the selection of P-values j covers all m  n P-values. It is important to note that as q e is by definition !q ej , the weighted p j is always ! the unweighted p j. This weighting procedure has three consequences. First, when all P-values are large (i.e. non-significant tests), the originally largest P-value can sometimes be selected by the MGAS procedure as P MGAS , i.e. as the smallest weighted P-value that is selected as the multivariate gene-based P-value. Because for the largest P-value the weight q e /q ej  1, and q e /q ej > 1 for all other P-values, the largest P-value before weighting can become the smallest P-value after weighting when all P-values were high to begin with. Second, because for most P-values q e /q ej > 1, weighted P-values can become >1, especially when the unweighted P-values are large to begin with. However, P MGAS cannot exceed 1. Third, the search for the smallest weighted P-value can stop once q e p j /q ej is p j  1 : as the weight q e /q ej is always !1, no subsequent weighted P-values will be q e p j /q ej. This rule saves computation time for calculating the effective number of independent tests.
Approximation of P-value correlationsThe m  n correlation matrix between the P-values is not observed in practice. Followingwe used simulation to derive the mathematical relationship between the observed SNP-correlations X and observed phenotypic correlation R on the one hand, and the correlations between the P-values U on the other, under the assumption of no genetic association (i.e. under the null hypothesis). Assuming two correlated bi-allelic SNPs and two correlated phenotypes, genotype and phenotype data were simulated for N  4000 subjects for every combination of allele frequencies (assuming HardyWeinberg equilibrium), LD coefficient r, and phenotypic correlation q. For each LD coefficient r, the SNP haplotypes were randomly generated by reference to a categorical distribution. For quantitative phenotypes, phenotypic scores were randomly drawn from a bivariate normal, and a linear regression model (Wald test) was used to evaluate the statistical association between each phenotype and each SNP. For qualitative phenotypes, the bivariate Bernouilli distribution with correlation q was used to produce pairs of dichotomous phenotypic scores for each subject, and a logistic regression model (v 2 test) was used to evaluate the association between each phenotype and each SNP. Allele frequencies, r, and q were increased from the smallest values to the largest values with steps of 0.05 to generate a series of data points. For each setting, 10 000 datasets were generated, yielding 10 000 sets of P-values from which the correlation between P-values could be estimated. Our simulations then showed that the correlation matrix of the m  n P-values U could be accurately approximated using a sixth-order polynomial function featuring the Kronecker multiplication of the observed SNP-correlation matrix X and observed phenotypic correlation matrix R, with coefficient of determination R 2  0.995:Network model in which all phenotypes are equally and bidirectionally related, yielding a phenotypic variancecovariance matrix mimicking that of a 1-factor model. All SNPs within a gene affect one phenotype directly and all related phenotypes indirectly. (F) Network model distinguishing four clusters of phenotypes; all phenotypes are bidirectionally related, with relations being stronger within, compared with between, clusters, yielding a phenotypic variancecovariance matrix mimicking that of a 4-factor model. All SNPs within a gene affect one phenotype directly and all related phenotypes indirectly. See Supplementary Material for specific simulation settingsNeither sample size nor allele frequencies affected the accuracy of this approximation (see Supplementary). MGAS as implemented in KGG v3.0 calculates the expected matrix U using the user-provided correlation matrices R and X. The first can be calculated from the raw phenotype data, while the latter can either be calculated from the actual genotype data or can be obtained from reference genotype data in HapMap (http://hapmap. ncbi.nlm.nih.gov) or the 1000 Genomes Project (http://www. 1000genomes.org/). KGG v3.0 facilitates the building of X from both observed and reference data.
MGAS running time: the divide-and-conquer algorithmTo speed up computation of P MGAS for a gene with a large number of SNPs and many phenotypes, we developed a divide-and-conquer algorithm. The m  n weighted P-values are partitioned into K clusters according to their expected correlations using a cutoff of c  0.50. The P-value of each block is calculated by the extended Simes test (), and the SNP determining the blockwise P-value is marked as the key SNP of that block.
Type I error rate and power: simulation
Simulation settingsTo examine the Type I error rate and the power of MGAS to detect associated genes, multivariate genotypephenotype data were simulated for 2000 unrelated subjects (see Supplementary Information for details). Phenotype data included 20 standard normally distributed phenotypes. The covariance structure of the phenotypic data was either a unidimensional common factor model (and B), a 4-common factor model (and D) or a network model in which correlations between phenotypes are the result of direct, mutual relations between the individual phenotypes (and F; the relevance of network models for psychological traits like cognition, depression and personality has been demonstrated;). Network data were generated such that the associated phenotypic covariance structure either mimicked a unidimensional factor model (i.e. all phenotypes mutually affect each other to a similar extent;), or a 4-factor model (i.e. four clusters of phenotypes are specified;). Within and between factors or clusters, phenotypes correlated 0.56 and 0.13, respectively. In these six phenotypic settings, the effects of all SNPs within a gene were either modeled at the latent level (and C), or directly on one specific phenotype (F). Genetic data included a small gene (10 SNPs) or a larger gene (60 SNPs, assuming equal coverage) with varying numbers of disease-susceptibility loci (DSL, i.e. a SNP that is causally related to one or more phenotypes), and LD blocks.shows an overview of all simulation settings (see also Supplementary Tables S1ae for a visual representation of the LD structure and a detailed description of all simulation settings). In all simulations, the minor allele frequency of all SNPs was 0.2. Within and between LD blocks, LD measure r was set to 0.9 and 0, respectively. The simulated regression weights of DSL were chosen to account for 0.5% of the phenotypic variance in small genes and 1% in large genes (see Section 2.5 later). Note that in the univariate regression of one phenotype on a DSL, the effect of the DSL can be larger than simulated when the DSL is in high LD with other DSL (i.e. the effect is augmented because of the correlation of the DSL to other DSL in the same LD block: see Supplementary Information Simulations). Hence, power comparisons should only be made within each scenario, not between scenarios. In each scenario, data were analysed in five ways, all yielding a gene-based P-value. First, the sum score, calculated across all 20 phenotypes, was regressed on all SNPs within a gene, and the P-values from these univariate tests were submitted to the GATESsum procedure. Second, this sum score was submitted to a multiple regression model, in which all SNPs within a gene were included as predictors. Third, MANOVA was conducted with all 20 phenotypes as dependent variables, and all SNPs within a gene as predictors (). In both multiple regression and MANOVA, fixing all predictor effects to zero simultaneously yields a gene-based test with the number of degrees of freedom equal to the number of SNPs in a gene. Note that for these simulation settings (i.e. unrelated individuals, no covariates and an additive codominant SNP), MANOVA is equivalent to CCA () and the RMMLR method (). Fourth, as various studies (e.g.) have shown that MANOVA featuring one predictor (i.e. SNP) has excellent power to pick up trait-specific effects (i.e. only one of multiple correlatedNote. DSL: disease susceptibility locus. Roman numerals refer to the power results in. aIn latent factor models (and C), the one DSL affected half of the phenotypic indicators of a factor positively and the other half negatively. In unclustered networks (), the one DSL affected one phenotype positively and another phenotype in the network negatively. In clustered networks (), the one DSL affected either two phenotypes in the same cluster, or two phenotypes in different clusters, in opposite directions. bHalf of the DSL in a gene conveyed a positive effect, the others a negative effect of the same magnitude (and C) or phenotypes (F). phenotypes is affected), and SNPs with opposite effects, we performed a combination of MANOVA and GATES (i.e. GATESMANOVA). That is: given m phenotypes and n SNPs, n multivariate SNP-based MANOVAs with all m phenotypes as dependent variables and each SNP separately as predictor, produced n P-values that were combined to one multivariate gene-based P-value using GATES. Finally, all m phenotypes were individually regressed on all n SNPs, and the m  n P-values from these univariate tests were submitted to the MGAS procedure. Importantly, the first two methods summarize the multivariate phenotypic information into one composite score, while the latter three methods preserve the multivariate nature of the phenotypic input. For all six trait-generating genotypephenotype models, we simulated and analysed 2000 datasets using the freely available program R (R Development Core), and we counted the number of times that gene-based P-values indicated significance given a  0.05.
Simulation resultsType I error rates were correct for all methods in all scenarios (Supplementary Tables S2S7 for precise power and Type I error estimates), bar a small tendency toward inflation ($0.063) for MGAS over multiple simulation runs (not shown) when analysis concerned a large gene in the clustered network scenario (), suggesting that MGAS can be slightly liberal in this scenario. To study the Type I error rate for smaller a levels, we ran the scenario illustrated in100 000 times for a small gene and obtained values of 0.01017, 0.00134 and 0.00011 for a  0.01, 0.001 and 0.0001, respectively, suggesting correct Type I error rates for more stringent a-levels. In addition, we used real genome-wide genetic data of N  4763 subjects from the Northern Finland Birth Cohort (NFBC1966,, see Section 2.6 later), simulated 10 sets of 9 phenotypes, of which the correlational structure mimicked the observed correlations of the NFBC1966 metabolic phenotypes (see Supplementary), and performed 10 whole-genome multivariate gene-based association analyses using MGAS. These analyses showed that both small ( 10 SNPs) and larger (>10 SNPs) genes had empirical Type I error rates very close to the nominal alpha bar some stochastic fluctuation (), suggesting that MGAS has correct Type I error rate regardless of LD pattern and gene size. Indeed, qq-plots of the thus obtained MGAS P-values against a uniform distribution showed no aberrations (see Supplementary. Power results and Type I error rates for all scenarios are in Supplementary Tables S2S7.depicts power results for the six trait-generating genotypephenotype models, except for the scenarios including multiple opposite-effect DSL from the same LD block (Scenarios 5 and 7 in) since none of the five methods had reasonable power (max 9%) to detect these. As expected (), the methods that use phenotypic sum scores rather than the multivariate information (i.e. GATES and multiple regression, represented in red and orange, respectively) perform well when the true trait-generating model is a unidimensional factor model with the gene-effect on the latent factor, because only in that specific case the phenotypic sum score is a sufficient statistic (Figs 1A and 2A). That the phenotypic sum score is not a sufficient statistic under the other five simulated genotypephenotype models is evident from the power results of GATES and multipleNote. Type I error rates of MGAS for small genes ( 10 SNPs) and larger genes (>10 SNPs) obtained in 10 whole-genome scans of real genomic data and nine simulated phenotypes with realistic correlational structure.blocks, eight DSL of opposite effect. IVXI represent result for a small gene (10 SNPs): (IV): one LD block, one DSL; (V): one LD block, two DSL; (VI): one LD block, four DSL; (VII): two LD blocks, one DSL; (VIII): two LD blocks, two DSL; (IX): two LD block, two DSL of opposite effect; (X): one LD block, one DSL conveying opposite effects on different phenotypes (that in network models resided in the same cluster); (XI): one LD block, one DSL conveying opposite effects on phenotypes in different clusters. Specific power results and Type I error rates for all scenarios are in Supplementary Tables S2S7. Because MGAS has less power to detect larger genes (see Supplementary Material), small genes and large genes were simulated to explain 0.5 and 1% of the variance, respectively. Power results of the five methods are thus not directly comparable between scenarios (see Supplementary Material) regression: the power to detect DSL-harboring genes hardly ever exceeds 20%, and is often close to 5% as expected under the null hypothesis of no genetic signal. From previous studies () MANOVA is known to be particularly powerful when one predictor (e.g. SNP) affects only one of multiple highly correlated phenotypes (and D), or when that one predictor affects correlated phenotypes in opposite directions (scenario X in). Indeed, GATESMANOVA has the best power in these scenarios, with MGAS as second best (MGAS has 022% less power, with a median of 12%). When the gene affects multiple phenotypes simultaneously (i.e. pleiotropy,and C), MGAS outperforms GATESMANOVA (1 to 45% more power, median 22%), but when the genotypephenotype data have a network structure, MGAS and GATES-MANOVA perform similarly, except, as expected, when one DSL affects highly correlated phenotypes oppositely (power differences range between 28 and 10%, with a median of 0). In general, MGAS outperforms all other gene-based methods, except when the trait-generating genotypephenotype model is a unidimensional factor model with the gene-effect on the factor (), in which case it is sometimes slightly outperformed by the GATES procedure (MGAS has 9% less, to 95% more, power, with a median of 6%). MGAS outperforms MANOVA and multiple regression considerably in this scenario (compared with multiple regression: 095%, median 12%; compared with MANOVA: 076%, median 52%), and for all other trait-generating genotypephenotype models, MGAS has (much) more power than GATES-sum, MANOVA and multiple regression (calculated across all other five genotypephenotype scenarios; compared with GATES-sum: 594%, median 45%; compared with multiple regression: 795%, median 45%; compared with MANOVA: 0.04 to 77%, median 22%). Although MANOVA including all (highly correlated) SNPs as predictors often outperforms GATES and multiple regression, it is always less powerful than MGAS. Overall, all methods have less power to detect genes harboring multiple small-effect DSL, unless these are in high LD, in which case MGAS and GATES-MANOVA show sufficient power. Yet, none of the currently included methods can pick up genes with small-effect DSL that are in high LD but show opposite effects (Scenarios 5 and 7 in).
Particulars MGASSince MGAS revolves about selection of the best SNP (i.e. the SNP with the smallest weighted P-value), it is not directly sensitive to increased numbers of DSL within one gene. We note, however, that 'indirectly', MGAS does favor genes with multiple DSL because the weights q e /q ejand(2)] generally decrease quickly. For instance, assuming 10 phenotypes that correlate 0.53 and a gene harboring 10 SNPS that correlate 0.3, the first four weights equal 88.44, 44.94, 31.04 and 23.70. Assuming a  0.01, to implicate a gene with one DSL, that DSL must thus have a P-value < 0.01/ 88.44  0.00011, while to implicate a gene harboring four DSL, thefor the entire list of False Discovery Rate controlled significant genes). Abbreviations metabolic phenotypes: body mass index (BMI), C-reactive protein (CRP), diastolic blood pressure (DBP), glucose (GLU), high-density Lipoprotein (HDL), insulin (INS), low-density lipoprotein (LDL), systolic blood pressure (SBP) and triglycerides (TG). P-value of the DSL with the weakest signal only needs to be <0.01/ 23.70  0.0004, i.e. can be approximately four times higher. At the same time, because the weights q e /q ej are based on eigenvalue decomposition, a gene represented by multiple DSL in high LD can be easier to detect than a gene represented by multiple DSL (same signal) in low LD. For instance, while the first four weights q e /q ej are 35.66, 19.68, 13.59 and 10.38 when 10 phenotypes correlate 0.53 and 10 SNPs correlate 0.9, they equal 88.44, 44.94, 31.04 and 23.70 when the 10 SNPs correlate only 0.3. Assuming the same number of SNPs representing a gene and DSL with the same effect size, MGAS thus more easily detects genes with DSL that are part of an LD block. This is also illustrated by the relatively high power of MGAS in scenarios V and VI, compared with IV, inF. However, adding highly correlated, non-causal SNPs to represent a gene more comprehensively quickly decreases the power of MGAS to detect the gene: because j in Equation (2) increases when one adds SNPs, the weights q e /q ej increase, thereby decreasing the probability that weighted P-values will be below a chosen criterion level a. For instance, assuming 10 phenotypes correlating 0.53 and a gene with 60 SNPs divided over six LD blocks (10 SNPs per block, LD  0.9 within, and LD  0 between blocks), the first four weights equal 213.94, 115.61, 79.20 and 60.24. If one was to select one SNP per block such that the gene is represented by six unrelated SNPs, the weights would drop to 49.85, 27.51, 19.00 and 14.51, respectively. That is: when adding highly correlated SNPs to the analysis, power only increases if these SNPs are actually DSL that convey an independent association signal. In practice, however, we do not know which SNPs are such DSL. Therefore, while imputation and sequencing yield dense genotype files, the power of MGAS (as of other SNP-based and gene-based tests) to detect associated genes will generally improve if one uses LD-based pruned data in the analysis since most SNPs are not DSL [a similar conclusion was reached for univariate gene-based tests by, who showed that inclusion of non-causal intra-genic variants often dilutes the signal of gene-based tests]. However, as always, the process of LD-based pruning implies a trade-off between gaining power by reducing the number of redundant tests, and losing power by potential pruning of real genetic signal. Whether P-value based pruning is suited for procedures like MGAS that are based on P-value selection, or maybe introduces bias through capitalization on chance, requires further study.
Implementation: metabolism dataTo illustrate the usefulness of MGAS, we re-analysed nine quantitative metabolic traits measured in the population-based NFBC1966 (N  4763;), obtained from the dbGaP database. Data were available for triglycerides (TG), high-density lipoprotein (HDL), low-density lipoprotein (LDL), glucose (GLU), insulin (INS), C-reactive protein (CRP), body mass index (BMI) and systolic and diastolic blood pressure (SBP, DBP), and 328 836 SNPs, whose genomic positions were retrieved using SnpTracker (http://statgenpro.psychiatry.hku.hk/limx/snptracker). To run MGAS, KGG v3.0 requires a phenotypic correlation matrix and a file containing the Pvalues from the statistical association test between each SNP and each of the nine phenotypes. Phenotypic correlations, corrected for the covariates used in the original genome-wide analysis, were calculated from the original phenotype data downloaded from dbGaP (Supplementary). To follow the original analyses and results as closely as possible, we used the original P-value files provided by the authors and available in dbGaP (i.e. the P-values from the original 9, PCs and covariates corrected, genome-wide analyses). Combining these nine P-value files, we had information on 328 836 SNPs, 180 520 of which were located within genes, covering 21 153 genes in total. In KGG v3.0, SNPs were mapped onto genes defined by the RefGene database with 5 kb boundary extensions on both sides. When an SNP was located in overlapping regions of multiple genes, the SNP was assigned to all involved genes. The LD structure within each gene was determined in KGG v3.0 by reference to the HapMap LD data (http://hapmap.ncbi.nlm.nih.gov/downloads/ld_ data/latest/). To illustrate the added value of a test that is both multivariate and gene-based, we also conducted multivariate SNP-based analysis using TATES (Van der) and univariate gene-based analysis using GATES (For each participant, we established whether they met the criteria (yes/no, coded as 1/0) and then calculated the sum of endorsed criteria. This sum, ranging from 0 to 5 (42.9, 32.9, 15.7, 6.7, 1.6 and 0.1 % of the participants met 0, 1, 2, 3, 4 or 5 of the criteria, respectively), was then treated as a continuous dependent variable in a genome-wide analysis that we conducted in PLINK (), including, like in the original analyses, sex, use of oral contraception, pregnancy status and the first two PCs of a multidimensional scaling analysis as covariates (the first two PCs were used as covariates by the original authors as a proxy for geographical origin of the subjects). GATES analyses were also performed on the individual risk factors, i.e. the dichotomized variables TG, HDL, GLU, BMI and blood pressure, and on the nine continuous metabolic traits separately. Using an original Benjamini False Discovery Rate () controlled genome-wide threshold of a  1.80  10 04 , MGAS identified 32 genome-wide significant genes and 12 genome-wide significant regions harboring multiple genes (Supplementary; qq-plots in Supplementary Figs S3 and S4). Of these 44 regions, 30 were not reported in the original analysis, but 39 have been identified before in unrelated studies on the separate metabolic traits according to the Catalog of Published Genome-wide Association Studies (http://www.genome.gov/gwastu dies; Supplementary). Inspection of the univariate SNP-based P-values underlying the multivariate MGAS P-values showed that while the top regions (P < 1.0  10 07 ;) were only implicated in one of the nine metabolic traits, other regions showed associations of varying strength to multiple metabolic traits (e.g. APOB: P MGAS  1.13  10 06 , associated to HDL, LDL and TG; TOMM40/PVRL2: P MGAS  1.47  10 06 , associated to LDL, TG and CRP). Three of the five regions newly identified by MGAS were previously associated to disorders of which treatment/prognosis is known to be related to metabolism (see Supplementary). For instance, the region harboring GLT8D1, GNL3, SNORD19B and SNORD69 (here associated to GLU and LDL) has been associated to major psychiatric mood disorders (), and lipid and glucose abnormalities are reported in a considerable proportion of patients using atypical or second-generation antipsychotics (). MGAS identified more genes compared with the multivariate SNP-based method TATES (20 genome-wide significant SNPs with P < 1.52  10 07 covering 10 genetic regions: Supplementary) and the univariate gene-based method GATES conducted on the sum of endorsed risk factors (Supplementary). GATES analyses based on the nine individual continuous metabolic phenotypes (Supplementary), however, yielded results largely similar to those obtained with MGAS (comparison in Supplementary Table S14), except that the MGAS P-values are properly corrected for the phenotypic correlations and multiple testing.
DiscussionWe have shown that the new multivariate gene-based method MGAS has correct Type I error rate and performs well under a variety of trait-generating genotypephenotype models. With respect to power, MGAS often outperforms other gene-based methods that do not require permutation, like the univariate methods GATES, multiple regression and the multivariate MANOVA [which, with our simulation settings, is equivalent to CCA () and RMMLR (. MGAS, based on P-value information obtained in standard software like PLINK, has several important advantages. First, simultaneous analysis of phenotypes that have different measurement scales (e.g. continuous, ordered categorical, dichotomous) is unproblematic. Second, standard GWAS software deals with quality control in a genome-wide setting, covariates and population structure or stratification. MGAS, subsequently using the P-values resulting from these specialized packages, benefits from the strengths of such software. Third, MGAS is relatively fast as the method does not require permutation. Fourth, for the simulated genotypephenotype models, MGAS often proved the most powerful gene-based methods, especially for the detection of pleiotropic genes (and C). Only when the gene affects that part of one specific phenotype that shows no relation to other phenotypes in the analysis (i.e. geneeffect on the residual,) is MGAS outperformed by GATES-MANOVA. As a powerful method, MGAS more easily detects genes that show relatively weak associations with one or multiple traits. This was nicely illustrated by our real data example, in which we identified 30 regions that were not reported in the original analysis. It is important to note that, like all other multivariate gene-based methods included in our simulations, MGAS has difficulty detecting genes that harbor multiple DSL in high LD, with contrasting effects (Scenarios 5 and 7 in Supplementary Tables S2S7). Although contrasting effects of SNPs in high LD, located within one gene, may indeed exist, e.g. as a balancing mechanism, the scope of this scenario, and thus of this shortcoming, is probably limited. Yet, multivariate gene-based methods that can detect such contrasting effects are currently lacking. We close with some final remarks concerning the practical use of MGAS. First, MGAS, like TATES, cannot be used to analyse data collected in multiple, non-overlapping samples (e.g. trait A was measured in sample I, and trait B in sample II) because the resulting P-values will not show the expected correlations resulting from both the phenotypic correlations and the LD structure in the genome. Also, those P-values might be based on samples of different size, obtained using variable recruitment strategies, and might originate study design, data collection and analysis, decision to publish, or preparation of the manuscript. Conflict of interest: none declared.
S.Van der Sluis et al. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
diverging analytic choices with respect to data cleaning and inclusions of covariates. Second, KGG v3.0 facilitates estimation of the genetic correlation matrix from a reference population like HapMap: actual genotypes of study samples do not need to be available. However, when the LD structure of the reference population differs from the LD in the actual study sample, MGAS can be liberal or conservative: we refer to Li et al. (2011) for an extensive discussion. Third, the phenotypic correlation matrix used in MGAS should be corrected for the same covariates that are used in the univariate association analyses that provide the input for MGAS (i.e. the original phenotypic scores need to be regressed on these covariates and the correlations between the residuals feature as input for MGAS). Traits that have to date yielded few results in GWAS are often believed to be genetically complex, i.e. they involve many genes of small effect. However, genome-wide studies of complex traits have so far almost invariably relied on composite scores like sum scores or casecontrol dichotomies, thereby assuming the true trait-generating genotypephenotype model to be a 1-factor model with the gene-effects on the factor (Fig. 1A). Our previous (Van der Sluis et al., 2010, 2013) and current simulations show that the abundance of null-results in the GWAS literature is not only in line with the hypothesis that many traits are genetically complex: the difficulty to identify associated genes could also indicate that the trait-generating genotypephenotype model is misspecified. Here we showed that MGAS, which is exploratory in the sense that it does not require researchers to commit to one trait-generating genotypephenotype model before conducting the association analysis, has excellent power under various trait-generating models. As such, MGAS allows researchers to conduct their multivariate gene-based analyses efficiently, and without the loss of power that is often associated with an incorrect trait-generating genotypephenotype model.
