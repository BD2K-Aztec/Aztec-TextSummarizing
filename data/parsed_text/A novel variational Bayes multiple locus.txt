Motivation: For many complex traits, including height, the majority of variants identified by genome-wide association studies (GWAS) have small effects, leaving a significant proportion of the heritable variation unexplained. Although many penalized multiple regression methodologies have been proposed to increase the power to detect associations for complex genetic architectures, they generally lack mechanisms for false-positive control and diagnostics for model over-fitting. Our methodology is the first penalized multiple regression approach that explicitly controls Type I error rates and provide model over-fitting diagnostics through a novel normally distributed statistic defined for every marker within the GWAS, based on results from a variational Bayes spike regression algorithm. Results: We compare the performance of our method to the lasso and single marker analysis on simulated data and demonstrate that our approach has superior performance in terms of power and Type I error control. In addition, using the Women's Health Initiative (WHI) SNP Health Association Resource (SHARe) GWAS of African-Americans, we show that our method has power to detect additional novel associations with body height. These findings replicate by reaching a stringent cutoff of marginal association in a larger cohort. Availability: An R-package, including an implementation of our variational Bayes spike regression (vBsr) algorithm, is available at http://kooperberg.fhcrc.org/soft.html.
INTRODUCTIONPopulation-based genome-wide association studies have succeeded in discovering a large number of variants that individually explain a small percentage of heritability for many complex phenotypes. For example, when considering height in Caucasian populations, over 180 loci have been identified (), which cumulatively explain 10% of the variation, whereas the total estimated heritable variation is 8090% (). This 'missing' or 'dark' heritability * To whom correspondence should be addressed.() has many purported causes, including additional highly penetrant or large effect rare alleles (), epistatic interactions (), epigenetic variation () or many uncharacterized loci of small effect (). In the case of height, most of the additional loci recently identified are in this latter category, and only reach genome-wide significance in studies with hundreds of thousands of subjects (). In addition, predictive models of height within the Framingham study () have demonstrated that a much larger number of loci are likely contributing to variation in height, though not all of these loci may reach a stringent genome-wide significance threshold.also showed that the estimated heritability ascribed to height can largely be explained through observed common variants across the genome, where common variants explained 45% of the variation in height within an Australian population of European descent. These studies demonstrate an important challenge that while evidence suggests many common genetic variants driving phenotypic variation exist, our current methodologies and studies are under-powered to map the location of many of these causal variants. The GWAS approach of testing individual variants for association with phenotype has succeeded in producing replicable associations (). This success is largely attributable to both stringent Type I error control after accounting for a large number of tests and the systematic correction for confounding factors such as population stratification (). Complex phenotypes, such as body height, with hundreds of genetic associations could in theory benefit from a modeling approach that tests for multiple genetic variants simultaneously. One type of solution to this problem is the use of penalized multiple regression methods. These methods can have greater power to detect genetic associations by including all the genetic variants within the GWAS in the model of association (). Penalized regression consists of estimating the additive genotypic effectsIn this model, y i is the phenotype, x ij is the jth genotype, and e i is the residual error for the ith individual. Penalization of  is necessary to prevent model over-fitting when millions of variants are being tested with only thousands of samples. Although each penalized regression method proposed for GWAS can have greater power than single-marker analysis, none has demonstrated strict control of FWER, thus precluding their broader application in the field. We propose the first penalized regression methodology, based on the variational Bayes approach of, that is capable of directly controlling the family-wise error rate (FWER) through a variant level test statistic, z vb , that is approximately N 0,1 distributed under the null hypothesis. Similar toand Carbonetto and Stephens (2011) our variational Bayes spike regression (vBsr) approach treats the genetic effects  as random, with the prior. This prior can be thought of as a constraint on  similar to best subset selection, with p  controlling the sparsity of the subset solution. We simplify the models proposed by, who propose a three-component mixture, and the approach of Carbonetto and Stephens (2011), who propose a twocomponent mixture, by using a two-component mixture without the 'slab' component (see Supplementary Material for further details). The variant level statistic z vb is derived based on the results of fitting the vBsr model. We show that when p   0 this statistic is asymptotically N 0,1 under the null hypothesis. We then propose a diagnostic statistic (log KL ) to determine the size of the vBsr best subset solution (i.e. p  : p  > 0) such that this empirical distribution is approximately N 0,1 for the vast majority of genetic variants within the GWAS. The main assumptions of this approach are that most genetic variants are independent of the phenotype of interest, their empirical distribution under the null hypothesis will be N 0,1 , and this distribution will be very sensitive to model over-fitting (for example if p  is tuned to be too large). Given these conservative assumptions, the innovation of this test-statistic is therefore 2-fold. Not only can we demonstrate that it is possible to generate an approximately N 0,1 distributed test statistic within a multi-locus penalized regression methodology (and therefore have much tighter control of the FWER) but also it is possible to use the data to suitably tune the penalized regression methodology to ensure that this approximation is valid.
Variational Bayes approximate inferenceWhile variational Bayes approximations were first proposed as mean-field theory in theoretical physics (), they have seen a recent resurgence in the field of machine learning () by providing tractable approximations to challenging Bayesian inference problems. Consider an arbitrary vector of parameters  1 ,..., J = , a data matrix W , a likelihood function defined as N i p W i | and a prior defined as p . A typical Bayesian inference problem is to identify the posterior distribution of the parameters of interest given the data, p |W . In practice, this is often analytically or computationally intractable (e.g. exact Markov chain Monte Carlo approaches may not scale well to large datasets), so instead one can fit a model with an approximate distribution Q |W = J j q j  j |W , by minimizing the KullbackLeibler (KL) divergence ()In addition, the variational Bayes approximation generates a lower bound L W of the marginal posterior probability of the data p W . Further details of variational Bayes methods are provided in the Supplementary Material.
METHODS
GWAS regression modelsWe compare the relative performance of vBsr with both the popular lasso penalized regression method () and standard single variant test statistics for a range of simulated datasets and experimental data. We chose these methods for comparison to demonstrate that vBsr can control Type I error as well as single variant analysis, but under certain circumstances has greater power than either a single variant analysis or the lasso. The lasso was chosen for comparison since previous work indicates it has greater power than single variant tests in GWAS (), but in general suffers from poor Type I error control (). For all the multiple locus methods, we consider the following multiple regression model (with the single variant methods only considering each j-th variant separately)where y i is the phenotype, x ij is the genotype at the j-th locus for m loci, z ik is the k-th unpenalized covariate for p covariates and e i is the residual error term, which is assumed to be normally distributed with error variance parameter  2 e , for the i-th individual. All columns of the genotype matrix X are standardized to have mean zero and variance one. The first column of the covariate matrix Z is always the intercept. For single-marker analyis, we define  2 sma as the standard score statistic for single variant association for this regression model.
vBsr model
Fitting the vBsr modelFor the vBsr model, we assign an improper 'spike' prior to each penalized regression coefficient  j  1p  I. For the vBsr model, the approximate posterior distribution for an arbitrary  j parameter is, with p j the approximate posterior probability of  j not being zero,  j the approximate posterior mean of the non-zero effect and  2 j the approximate posterior variance of the non-zero effect. We estimate the error variance parameter  2 e and unpenalized covariate parameters  1 ,..., p through maximization of the lower bound L. The full derivations of these updates are provided in the Supplementary Material.
vBsr Z-statistic, z vbAfter fitting the model, we define the vBsr Zstatistic z vb , for the j-th variant, as z j =  j / j. We show in the Supplementary Material that when p   0, this statistic is equivalent to the standard N 0,1 distributed score statistic (under the null hypothesis) for a single variant test of association. Alternatively, we want to use this test statistic when there are multiple variants identified as being associated with phenotype when p  > 0 and z vb is no longer equivalent to the single variant score statistic. For notational and computational convenience, we define the tuning parameter 0 = 2log p  2log 1p  +log 2 . Given most genetic variants are independent of phenotype, we choose 0 to ensure the empirical distribution of the z vb statistic for the vast majority of genetic variants matches the N 0,1 distribution as diagnosed based on an estimated Kullback Leibler divergence, log KL . See the Supplementary Material for a detailed description of this log KL diagnostic statistic.
Bayesian model averaging
B.A.Logsdon et al.parameters. This allows us to identify multiple local maxima of the lower bound Lwhere each maximum can correspond to a different sparse subset of genotypes identified as being in the model (i.e. genotypes with posterior probabilities p j >> 0). We then reduce the model uncertainty associated with identifying many different sparse models by producing a Bayesian model averaged Z-statistic z vb , for the j-th, for g unique local maxima. Further details are presented in the Supplementary Material.
Lasso regressionThe lasso solution to the regression equation is ,for some choice of penalty parameter . We use the path solution to the lasso that is solved with the R package glmnet (), where the log-likelihood is defined as:n being the observed sample size, andand the corresponding Akaike's information criterion (AIC) andBayesian information criterion (BIC) are lasso aic =2  +2||, lasso bic = 2  +log(n)||, with justification of the choice of degrees of freedom || as described in. The default settings are used for glmnet, with a path length of 1000. In addition, 10-fold cross-validation is also performed using the glmnet package and the penalty parameter with the minimum mean-squared error is chosen for analysis of the entire dataset.
SimulationsWe simulated haploid genotype data for 10 000 independent genotypes sampled from a Bernoulli distribution with frequency parameter varying between 0.1 and 0.5. Since all simulated genetic architectures were additive, the use of haploid genotypes as opposed to diploid genotypes did not appear to have an effect on any of the results we observed. Sample sizes of 500, 1000 and 2000 were simulated. We first performed null simulations to demonstrate Type I error control by testing null phenotypes (with error variance parameters chosen as in the non-null simulations). Next, we performed non-null simulations to test both Type I error control and power, by simulating genetic architectures with 50 independent loci randomly sampled from the 10 000 independent genotypes. The genetic effects for this model were sampled from a standard normal distribution and the heritability was fixed at 0.5 or 0.9. For each sample size and overall heritability, 1000 replicate phenotype datasets were generated with the same genotypes, while re-sampling the location and magnitude of the genotypic effects. For each phenotype, replicate vBsr was only run once since the lower bound tends to only have one maximum when the genotypes are independent. Finally, we analyzed simulated phenotype data with genetic architectures generated using correlated genotypes. For the correlated genotype data, we used the first 10 000 genotypes on Chromosome 1 within the SHARe dataset, where we randomly split the data into disjoint sets of 500, 1000 and 2000 individuals. For these correlated genotypes, we found that the lower bound had more local maxima, so we ran 60 random restarts of the vBsr algorithm for each replicate analysis. For the simulations with correlated genotypes, the lasso was excluded because of its poor FWER control (as shown in).
Analysis of SHARe dataThe WHI SHARe genotype data were collected using the Human SNP Array 6.0 (Affymetrix, Santa Clara, CA, http://www.affymetrix.com) genotype platform, for 8515 self-identified African-American women who consented to have their DNA analyzed. Individuals were filtered based on failed genotyping, call rate <95% or sex/ethnicity discrepancy. Among related individuals, only the subject with the highest call rate was retained.Body height was measured at baseline in centimeters, using wall mounted stadiometers. Height measurements below the 1-st percentile and above the 99-th percentile were truncated as per request of the Fred Hutchinson Cancer Research Center Institutional Review Board, to maintain anonymity. Further details of the quality control of the genotype data are presented in, and study protocols and additional details of the WHI cohort are presented elsewhere (The Women's Health Initiative Study). Some details that are different from the previous analyses of these data include imputing the sporadic missing data to the empirical mean of the observed genotypes, and filtering to 5% minor allele frequency. In addition, as opposed to the analysis published in, the 47 individuals without height data from the first visit were excluded. These differences wereimplemented to make our analysis more conservative than the analysis ofto strengthen our confidence in the penalized regression methodologies. For the analysis of the SHARe height data, we performed a marginal pre-screening (using the first four principal components and age as covariates) with a P-value cutoff of 10 3. This left 1579 markers (out of an original 772 202 which passed the quality control filters and 5% minor allele frequency filter). We performed a marginal pre-screening to decrease the analysis time for the vBsr method to hours instead of days on a workstation with a twelve core Intel Xeon processor. The vBsr algorithm was run with 1000 restarts, to ensure a high-quality model could be identified across the lower bound surface.
RESULTS
Simulation resultsSimulation results for our method in comparison to standard singlemarker analysis as well as three different methods for the choice of the penalty parameter  for model selection with the lasso based on AIC, BIC and 10-fold cross-validation are shown in. The simulation results depicted in this table were for genetic markers that were simulated independently of one another. We see for the null simulations inthat the Type I error rates can be explicitly controlled for both single-marker analysis and the z vb statistic using two conservative strategies for choosing the penalty parameter (either based on the minimum KL diagnostic statistic, or the expected KL diagnostic statistic, see Section 2 for details), while only the choice of model size through BIC for the lasso maintains the Type I error even marginally. As expected, the choice of penalty parameter for the lasso based on AIC tends to always choose a large over-fit model in these null simulations, whereas crossvalidation does a decent job of controlling the model size, but does not explicitly enforce extreme sparsity, all of which are consistent with previously observed results on model selection criterion for AIC, BIC and cross-validation (). Importantly, cross-validation is intended to minimize the prediction error of the lasso model rather than to select genome-wide significant predictors, thus it is not surprising that cross-validation selects a larger model. For the non-null simulations depicted in, we still see that the FWER can be controlled for both the z vb and  2 sma statistics, but the criteria for choosing the size of the lasso solution perform even worse than in the null simulations. Of all the methods for choosing the size of the lasso solution, BIC does the best, but it still contains an average of 4.91 false positives per replicate analysis (for h 2 = 0.5,n = 1000). These results suggest that the lasso is sensitive to weak sampling correlations between true and false positives when n << m. We considered six different strategies for choosing the model size based on the penalty parameter 0 in the penalized regressiondepicts the FWER starting with single-marker analysis on the far left, then comparing these six different strategies for choosing model size starting with the most conservative z a vb and ending with the most liberal z f vb , for the six different non-null simulations. The right panel ofdepicts power for this same set of test statistics. The more conservative strategies show excellent control of FWER, though have a more modest increase in power over single-marker analysis. Alternatively, the more liberal strategies show a slight deviation from the exact control of FWER but have greater power. Even when the model size is constrained to fix the ratio of the number of true positives to false positives, the z vb statistic can have greater power than the lasso, as shown in the precision-recall curves in Supplementarywith the liberal choice of log(KL) based on the expected value plus two standard errors, z f vb. Precision (true-discovery rate) is defined as tp/tp+fp and recall (power) is defined as tp/tp+fn, for the total number of true positives (tp), false positives (fp) and false negatives (fn) at a given cutoff of the test statistics for z vb or  2 sma , or a given penalty parameter  for the lasso across 100 replicate simulations. This appears to be especially true for smaller sample sizes with more signal (i.e. greater total heritability). Supplementaryalso demonstrates that both vBsr and the lasso can outperform single-marker analysis in terms of power and false-discovery rates. In addition, we explored similar simulations with non-independent markers, with results described in the Supplementary Results and shown in Supplementary Figures S2 and S3, where vBsr has superior control of FWER and superior power compared with single-marker analysis for high heritability simulations. We also inspected the QuantileQuantile plots for the different test statistic strategies, also discussed in the Supplementary Results and shown in Supplementary.
Variational Bayes Z-statistic for genome-wide association studies
SHARe analysis resultsWe investigate the relative performance of the z vb statistic when compared with single-marker analysis and the lasso in terms of the percentage of genotypes that replicated (with a single-locus test) when considering an independent cohort(s). First, none of the model size selection procedures produced meaningful results above and beyond marginal screening to P sma < 10 3 for the lasso (AIC chose a model with 1089 out of 1579 pre-screened features, BIC chose the null model and CV chose a model with 1049 out of 1579 pre-screened features), therefore we did not further investigate that approach. The percentage of loci identified at an estimated falsediscovery rate of 10% (assuming 10 6 features) that were replicated when considering an independent cohort [as described infor height] was 50% (5/10) with the vBsr approach, as opposed to 33.3 (3/9)% for the single-marker analysis approach. The estimated false-discovery rate was determined as in. Notably, for height there is sufficient signal such that the z vb statistic identifies an additional two loci beyond the marginal test that were replicated inin an independent cohort. A complete comparison of the results ofand the z vb statistic is shown in. The family-wise error rates and expected number of false positives per replicate analysis, FWER (E), for a simulation of 10 4 independent genotypes, with 50 causal variants and 1000 replicatesThe phenotypes in the h 2 = 0.0 simulations were generated under the null model. The z vb and  2 sma statistics are controlled to have a FWER of 0.05, whereas the choice of size of the lasso solution is determined by either AIC, BIC or 10-fold cross-validation. The FWER is computed over the null markers. a Results for 0 chosen based on the minimum value of the KL diagnostic statistic along the path. b Results for 0 chosen based on the expected value of the KL diagnostic statistic (as determined by Monte Carlo simulations) along the path.) excluded missing genotypes and contains a slightly different subset of the WHI SHARe samples, therefore the P-values are not exactly the same between analyses. c While this specific locus did not replicate, it was in linkage disequilibrium with a locus (rs1787200) that did replicate with P rep = 7.3710 10. The R 2 within the SHARe samples analyzed in this article between these two loci is 0.28.(LCORL), rs13292627 on Chromosome X (ARSE) and rs7239949 on Chromosome 18 (DYM ) that all replicated in the meta-analysis of. (Locus rs7239949 did not replicate itself, but was in strong linkage disequilibrium with locus rs1787200 that did replicate.) In addition, the vBsr approach identified two additional associations with rs606452 on Chromosome 11 (SERPINH1) and rs7968682 on Chromosome 12 (HMGA2) that also replicated in, that were not chosen by SMA with an estimated FDR = 0.10. Both single-marker analysis and the vBsr approach identified rs11867328 on Chromosome 17 as being genome-wide significant, though this result was not replicated in the meta-analysis of. Similarly, the association at rs565042 in the nerve growth factor receptor (NGFR) gene did not replicate. To illustrate the vBsr path solution, we show the estimates of the expected regression coefficients inalong the path of 0. Around 0 =13 many genetic markers start to enter the model, where likely most of these are false positives.also shows where each choice of model size lies on the 0 path. The most conservative strategy of z a vb identifies very few features, whereas the more liberal strategy of z d vb incorporates a large number of features, of which many are likely false positives. In this case z b vb lies on the cusp before too many false positives enter the model and degrade the quality of the distributional assumption of the test statistic. We also show the QQ plots for both z vb and our single-marker analysis in Supplementary. For this analysis, we choose 0 =13.39 specifically such that the QQ plot appeared null in the 10 3 < P vb < 10 4 region, (this corresponded to the strategy associated with the z b vb statistic) where P vb is the P-value associated with the z b vb statistic. The P vb statistic only becomes inflated when P vb < 10 4 , indicating there exists a value of the model complexity parameter 0 such that the distributional assumption of the z vb test statistic is valid for the majority of markers except for the tail cases. Our simulations supported this observation, as shown in the bottom left panel of Supplementary, where the distribution of theAs the penalty parameter increases in magnitude, the size of the model increases until it becomes over-fit. The position in the path for the four different strategies is shown with the vertical bars, with the chosen strategy (z b vb ) in blue. The features that were significant for z b vb at FDR = 0.10 are also shown in blue along the entire path expected distribution. Notably, the QQ plots for the z b vb statistic look closer to the null assumption than the corresponding SMA Q Q plots. We found in other simulations (not shown) that the marginal pre-screening had very little effect on the FWER control of the vBsr approach and resulted in a mild loss in power when the phenotype was very heritable or the sample sizes were very large. Although it would be possible to run the entire dataset with the vBsr approach, the identified solution mostly contained variants that were nominally significant (i.e. P sma < 10 5 ), indicating it would be unlikely that any additional associations would arise as genome-wide significant.
Variational Bayes Z-statistic for genome-wide association studies
DISCUSSIONThe z vb test statistic provides three major practical advantages over either single-marker analysis or alternative multiple locus penalized regression approaches in the GWAS setting. First, as demonstrated through both simulations (as shown in; Supplementary Figs S1 and S3), and the analysis of the WHI SHARe GWAS of height (shown in), this statistic has greater power to detect additional replicable loci beyond those that are identifiable by either a standard single-marker analysis or the lasso, given the phenotype is highly heritable or the sample size is sufficiently large. In addition, while the increase in power was modest over the single-marker analyses in terms of replicated associations, we also see that the two associations vBsr identified on Chromosome 17 had statistically significant correlations with the two replicated hits on Chromosome 17 (the R 2 between rs11658329, the replicated association and rs11867328, the vBsr association was 0.044, P < 10 16 , and the R 2 between rs1549519, the replicated association and rs565042, the vBsr association, was 0.066, P < 10 16 ). Although the physical distance between these associations is large, because of the weak statistical dependence vBsr still identifies a signal. Second, the main innovation of the z vb statistic is that it is possible to tune vBsr such that it is approximately N 0,1 distributed under the null hypothesis. This means that, unlike other penalized regression methodologies, it is possible to directly control either the FWER or FDR. Other multiple locus penalized regression procedures often rely on cross-validation, or information criterion such as AIC or BIC to choose the appropriate model size and magnitude of their penalty (), which will not necessarily control the Type I error to an arbitrary level (as shown infor the lasso). We demonstrated the Type I error control capability of our method through a wide range of simulations, of either the null model for independent genotypes, the null features in a non-null model with independent genotypes (as in), or even in a non-null model with linkage disequilibrium among genotypes (as in Supplementary). Third, while a few authors have proposed a choice of penalty parameter within penalized regression methods to asymptotically bound the type I error (), our approach is unique, in that we demonstrate a data-driven choice of the penalty parameter 0. The penalty parameter 0 (or alternatively p  ) is an appropriate tuning parameter because it directly determines the evidence necessary for a given genetic variant to be included in the model by controlling the scale of the posterior probability of inclusion, p j , for all genetic variants. The posterior probability of inclusion for a given variant is an essential aspect of the vBsr model since it determines the effect of a given genetic variant on the overall model through the expectation E  j = p j  j , where p j  0 implies the variant is not in the model and p j  1 implies the variant is in the model and effectively unpenalized. In general, we always choose 0 such that the empirical distribution of the z vb statistic matches very closely to the expected N 0,1 null distribution for the vast majority of genetic features (i.e. up to the 99-th percentile for simulations, or between the 99.9-th and 99.99-th percentiles in the dataanalysis), within the study (as shown in Supplementary Figs S4 and S5). Therefore not only can we control the Type I error to an arbitrary level, but also, we do not necessarily rely on an asymptotic argument for the choice of 0 to ensure the validity of our choice of penalty parameter. Finally, the vBsr methodology incorporates additional general features beyond the choice of penalty parameters which are unique and distinguish it from alternative penalized regression methodologies () including other 'spike-and-slab' approaches (). This includes the use of Bayesian model averaging to regularize over uncertainty in the space of identified models. In addition, there is theoretical evidence that 'spike-andslab' penalized regression approaches do not suffer from the possible model selection inconsistency of the lasso, given highly correlated predictors (). We see the practical consequences of this fact for m >> n datasets where the Type I error rates for the lasso seem to be driven by random correlations between causal and null features (as shown in), even among independently sampled genetic features. Finally, by defining a test-statistic which is approximated by a N 0,1 distribution for
B.A.Logsdon et al.every genotype in the dataset, it is possible to diagnose confounding population structure as is common with single-marker analysis, but challenging with other penalized regression methods.
CONCLUSIONOur vBsr methodology is a novel approach for identifying additional replicable loci within genome-wide association studies that directly addresses the limitations of other penalized multiple regression methodologies. Specifically, the data-driven choice of penalty to ensure the validity of the distribution of the test statistic and the use of a penalty with attractive theoretical model selection properties make this a robust and practical tool for the GWAS practitioner interested in identifying additional replicable associations for complex phenotypes with rich genetic architectures.
The Author 2012. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oup.com at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
