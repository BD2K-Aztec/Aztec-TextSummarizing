Motivation: Cell growth and division affect the kinetics of internal cellular processes and the phenotype diversity of cell populations. Since the effects are complex, e.g. different cellular components are partitioned differently in cell division, to account for them in silico, one needs to simulate these processes in great detail. Results: We present SGNS2, a simulator of chemical reaction systems according to the Stochastic Simulation Algorithm with multi-delayed reactions within hierarchical, interlinked compartments which can be created, destroyed and divided at runtime. In division, molecules are randomly segregated into the daughter cells following a specified distribution corresponding to one of several partitioning schemes, applicable on a per-molecule-type basis. We exemplify its use with six models including a stochastic model of the disposal mechanism of unwanted protein aggregates in Escherichia coli, a model of phenotypic diversity in populations with different levels of synchrony, a model of a bacterio-phage's infection of a cell population and a model of prokaryotic gene expression at the nucleotide and codon levels.
INTRODUCTIONRecent evidence suggests that even in cellular organisms whose division is morphologically symmetric, there are a number of asymmetries between daughter cells. These arise, among other things, from the stochasticity in the partitioning of components in division () and from biased partitioning schemes for some components. For example, in Escherichia coli, unwanted protein aggregates follow biased partitioning schemes dependent on the age of the daughter cells' poles (). These and other recent findings suggest that the phenotypic diversity of cell populations, among other factors, depends on errors and biases in the partitioning of RNA, proteins and other molecules. This is of relevance since most RNAs exist in small numbers () and small fluctuations in these numbers can alter the behavior of genetic circuits () and trigger visible phenotype changes (). These sources of phenotypic heterogeneity are difficult to distinguish from, e.g. noise in gene expression (). Although some effects can be assessed analytically (), others are too complex and must be assessed numerically. A simulator is thus needed that accounts for noise and delays () in gene expression and for compartmentalization of processes and components. Presently, simulators of the dynamics of noisy biochemical systems rely on the Stochastic Simulation Algorithm (SSA) (), e.g. (). Some support compartmentalization, simulating reaction-diffusion systems in either static () or dynamically sized compartments (). Others support rule-based creation of reactions at runtime (), and thus can simulate a dynamic cell population. Very few support delays on the release into the system of one or more products of a reaction (). These delays are essential to accurately model the kinetics of some processes, e.g. transcription, as RNA production is mostly regulated by the duration of events in transcription initiation (). Here, we present SGNS2, an extension of SGN Sim () that incorporates dynamic compartments and multiple partitioning distributions at cell division, applicable on a per-molecule-type basis. the number of reactions, compartments and delayed events, allowing complex models to be simulated in reasonable time. To simulate cell division, we introduced a special reaction event, whose timing follows the SSA rules. When executed, instead of subtracting substrates from the system, a random number is generated based on one of the several partitioning distributions available, including some of those listed in Huh and Paulsson (2011). Each of these mimics a specific molecule partitioning process during cell division. SGNS2 allows both biased and unbiased partitioning of molecules and sub-compartments. The results of these events can be instantaneous or be placed on the wait list. Compartment division and molecule partitioning are represented in the following form: splitp : Protein@Cell ! c @Cell : Protein@Cell When this reaction occurs, a new cell compartment is created (@Cell in the product list). Proteins in the original cell are partitioned according to a biased binomial partitioning scheme. In this, each protein is independently partitioned into the new cell with probability p. Other common partitioning distributions include the independent partitioning of molecules into daughter cells with random (beta-distributed) sizes and the binding of molecules to spindle binding sites which are segregated evenly between daughter cells such as during mitosis. Available distributions are listed in the manual. SGNS2 is a command line utility, designed to fit into a toolchain, supporting various input and output formats. Input can be specified in two formats: SBML () and SGNSim's native format (). A subset of SBML Core level 3 version 1 is supported, allowing simulation of most SBML models. Output can be in csv, tsv or in binary format. A text editor may be used to write models in SGNSim format. SBML-based graphical interfaces such as CellDesigner () or Cytoscape () may be used to manage SBML models. The results of simulations are interpretable by programs like MATLAB, R or Excel. An example of running a model in SGNSim format of a growing cell population is shown in Supplementary.
METHODS SGNS2 is an extension of SGNS, the stochastic simulator of SGNSim (Ribeiro and Lloyd-Price, 2007). It contains all the features of SGNS, such as reactions with multi-delayed events. The two key additions in SGNS2 are (i) it supports dynamic, interlinked, hierarchical compartments and (ii) it supports multiple molecule and compartment partitioning schemes, applicable on a per-molecule-type basis. The novel features considerably extend the class of models that can be simulated. SGNS2 uses a modified version of the Next Reaction Method (NRM) (Gibson and Bruck, 2000). Namely, the NRM was adapted to stochastic P-systems (Spicher et al., 2008) by using a hierarchy of indexed priority queues (IPQ, an ordered list of elements that keep track of their position in the list) and further modified to allow multiple delays in reactions. The IPQ data structure, implemented with a binary heap, is described in Gibson and Bruck (2000). We use a separate IPQ for each compartment, which publish a 'tentative next event time' to an overall IPQ which determines the next event time in the entire simulation. We optimize the update step when molecule populations in a parent compartment change by using a hierarchical refinement of the IPQs with appropriate scaling of tentative firing times (see Supplementary Material). Delayed events were implemented by creating wait lists, implemented by binary heap-based priority queues, whose earliest event is published to each compartment's indexed priority queue. The simulation's elementary SSA steps scale logarithmically with *To whom correspondence should be addressed.
The Author 2012. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
DISCUSSION SGNS2 is the first stochastic simulator that includes multi-delayed events, dynamic compartments and molecule partitioning schemes in division. To test its correctness, we simulated models from the Discrete Stochastic Model Test Suite (Evans et al., 2008). All showed the expected behavior (Supplementary Figs S2 and S3). SGNS2, though making use of existing and slightly modified versions of existing algorithms, can simulate an array of biological processes not previously possible. For example, it is ideal for simulating gene expression at the nucleotide and codon levels (see 'Availability' section) and study features such as how events in transcription elongation affect protein production kinetics (MakelatMakelat al., 2011). SGNS2 is also suited to study partitioning in cell division, which affects aging, among other processes, and is of particular relevance when modeling populations over multiple generations. To exemplify this, we modeled the biased partitioning of protein aggregates in E. coli, known to accumulate in cells with older poles, reducing vitality (Lindner et al., 2008). The results in Supplementary Figure S4 agree with measurements (Stewart et al., 2005). We further studied how cell-cycle synchrony affects the population-level statistics of RNA numbers [Supplementary Fig. S5, in agreement with measurements in Lloyd-Price et al. (2012)]. As a side note, we expect the partitioning of RNA and proteins to affect the dynamics of genetic circuits, particularly the stability of their noisy attractors (Ribeiro and Kauffman, 2007). To further demonstrate the simulator's utility, we modeled the viral infection of a dynamic bacterial population. In conclusion, SGNS2 provides novel functionalities to model and simulate cellular processes not previously possible, as seen from the examples. In general, SGNS2 enables the modeling of stochastic processes in live cells that require compartmentalization, multi-delayed complex processes and complex stochastic partitioning schemes at a per-molecule type in cell division. These features are necessary to study in silico, among other phenomena, phenotypic diversity in cell populations. Funding: Work supported by Academy of Finland (126803). Conflict of Interest: none declared.
SGNS2 at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
