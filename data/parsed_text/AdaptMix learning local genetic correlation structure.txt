Motivation: Approaches to identifying new risk loci, training risk prediction models, imputing untyped variants and fine-mapping causal variants from summary statistics of genome-wide association studies are playing an increasingly important role in the human genetics community. Current summary statistics-based methods rely on global 'best guess' reference panels to model the genetic correlation structure of the dataset being studied. This approach, especially in admixed populations, has the potential to produce misleading results, ignores variation in local structure and is not feasible when appropriate reference panels are missing or small. Here, we develop a method, Adapt-Mix, that combines information across all available reference panels to produce estimates of local genetic correlation structure for summary statistics-based methods in arbitrary populations. Results: We applied Adapt-Mix to estimate the genetic correlation structure of both admixed and non-admixed individuals using simulated and real data. We evaluated our method by measuring the performance of two summary statistics-based methods: imputation and joint-testing. When using our method as opposed to the current standard of 'best guess' reference panels, we observed a 28% decrease in mean-squared error for imputation and a 73.7% decrease in mean-squared error for joint-testing.
IntroductionSummary statistics of association tests, such as effect size estimates and their standard errors, are becoming the datatype of choice in many genetic analyses due to two significant advantages. First, summary statistics-based methods are generally orders of magnitude faster than their genotype-based counterparts. The rapidly increasing size of existing and planned cohorts is causing computational bottlenecks for some standard analyses. Second, analyses of summary statistics are often a necessity since access to individual-level data is complicated by privacy and other issues (). Publication of summary statistics is now required for all Nature Genetics genome wide association study (GWAS) papers, and these statistics have already been released for a large number of traits. For these reasons, a growing number of summary statisticsbased methods, including imputation of z-scores, joint-testing, fine mapping of causal variants, quality control of GWAS results and gene-based tests, have recently been published (). Moving forward, the integration of summary statistics will be vital for increasing our knowledge of various complex diseases and phenotypes (
i181This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (http://creativecommons.org/licenses/by-nc/4.0/), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com, i181i189 doi: 10.1093/bioinformatics/btv230 ISMB/ECCB 2015 tools use 'best guess' reference panels to estimate LD (). For example,used European ancestry individuals from the Queensland Institute of Medical Research reference panel to estimate LD for an analysis of statistics produced from the European ancestry GIANT consortium (). This approach is not optimal and has the potential to produce misleading results in the case of admixed populations. Admixed individuals' genomes can be viewed as mosaics, where different segments of the genome are derived from various ancestral groups. Previous work has shown that the proportions of ancestry for individuals from admixed populations are highly variable (). Given this high variability in admixed populations, 'best guess' panels are more likely to have LD estimates that are not in concordance with original datasets and which vary in their local structure. This will be especially true if the population of interest has no reference panel available. Furthermore, several genotype-based methods have shown that learning local structure from multi-population reference panels improves performance even in the case of homogenous study populations (). In this work, we develop a method, Adapt-Mix, to accurately estimate the local single-nucleotide polymorphism (SNP) correlation matrix for each region of the genome from summary statistics of an arbitrary population study. We compute the correlation matrix using a mixture of existing reference panels, such as the 1000 Genomes Project Consortium (2012), where the mixture proportion for each reference population is learned from summary statistics. Unlike previous approaches, our method incorporates data from multiple reference panels when computing the correlation matrix and allows for adaptation to local structure. We first provide a closed form solution for the expected correlation structure from a mixture of populations in a genomic locus. Then, using this derivation, we efficiently search for the mixture of populations in each genomic locus that maximizes/minimizes an objective function most relevant to the problem in question. For example, in this work, we consider the problems of imputation and joint-testing from summary statistics, using imputation error and joint-test accuracy as the objective function, respectively. In practice, arbitrary objective functions can be used provided they can be computed efficiently. We apply our method to summary statistics from simulated phenotypes over real genotypes from the Genes-environments & Admixture in Latino Americans () cohort that is composed of Mexican and Puerto Rican individuals. We also apply our method to real coronary artery disease summary statistics from the CARDIoGRAMplusC4D consortium (Coronary Artery Disease (C4D)). In the simulated datasets, we show significant improvements in the mean-squared error (MSE) of our mixture correlation coefficients compared with the most relevant reference panels. We also demonstrate the direct impact of the improved correlation estimates for imputation and joint-testing methods, which take correlation matrices as input. For both the simulated summary statistics over the GALA II study as well as the meta-analysis results, we show significant improvement in both summary statistics-based imputation and joint-testing ().
MethodsFirst, we describe the situation where Adapt-Mix may be applied. We then derive a formula for the genotype correlation matrix as a mixture of several reference populations and describe our procedure for optimizing the mixture frequencies for various objective functions. We end the section by discussing the simulation framework in which we evaluate our method. GWAS summary statistics typically consist of an effect size b i and standard error r i for each SNP i examined in a study. For simplicity, b i and r i can be converted to a Wald test statistic (Z-score) z i. When dealing with casecontrol phenotypes z i  ffiffiffiffi ffiwhere N is the sample size, p  i (p  i ) is the frequency of the reference allele in cases (controls), and p i is the overall frequency. For quantitative phenotypes z i  ffiffiffiffi ffi N p cor~ g i ; ~ q, where ~ g i are the genotypes of the individuals and ~ q are the phenotypes. Here, ~ g i  fg i1 :::g iN g for g id 2 f0; 1; 2g, g id being the count of the reference allele for individual d. As input, most summary statistics-based methods take Z-scores and a correlation matrix R (). For each pair of SNPs i, j, the correlation matrix has the value R ij  r ij , where r ij is the Pearson correlation coefficient between the SNPs in the study. If individual level genotypes are available, the correlation can be computed by r ij  cor~ g i ; ~ g j . When individual level genotypes are unavailable, r ij is typically estimated using a reference panel of genotypes from a population similar to the source population of the data being analyzed. In this work, we develop a method to provide a better estimate of r ij using a combination of reference panels from different populations. Given a set of K reference populations, we generate a correlation matrix for each genomic locus using a new mixture population, where the frequency of population k 2 K in the mixture population is f k. The objective of our work is to select the frequencies, f k , that optimizes the performance of the summary statistics method of interest.
Estimating the mixture correlation matrixGiven a set of mixture frequencies, ~ f  ff 1 ;. .. ; f K g, where f k 2 ~ f is the frequency for population k 2 K. We wish to compute the expected correlation between each pair of SNPs in the mixture population. For simplicity, we begin by deriving the mixture variance of the allele frequencies (r 2 i ) at SNP i, in a mixture population composed of two reference populations. At SNP i, the two reference populations will have separate variances (r 2 1i ; r 2 2i ), sample sizes (n 1 , n 2 ) and allele frequencies (p 1i ; p 2i ). Additionally, assume that each reference population has a mixture frequency equal to their proportion of sample size, i.e. f 1  n1 n1n2 and f 2  n2 n1n2. We can then express the mixture variance aswhere g kd is the genotype of individual d in population k, and 2p i  f 1 2p 1i  f 2 2p 2i is the genotype frequency in the mixture population. Let us now consider only P n1 z1 g 1z  2p i  2. This term is equal toApplying the same logic to P n2 q1 g 2q  2p 2i  2 , we arrive at the formula for the variance for the mixture population.We now extend from 2 to K populations. Suppose we have a set of reference panels representing K populations and their corresponding mixture frequencies, ~ f. Then for SNP i in population k 2 K, let r 2 ki be the variance and 2p ki be the frequency. The frequency in the mixture population is then 2p i  P K k1 f k 2p ki and the combined variance at SNP i isNext, we derive the covariance between SNPs i and j in the mixBy definition, the mixture correlation matrix is R ij  covi; j ffiffiffiffiffiffiffiffiffiffiAlgorithm 1 details our procedure for computing the mixture correlation matrix over a set of SNPs. Given K populations and M SNPs, it takes as input the mixture frequencies ( ~ f ), a matrix of SNP variances (V KxM  fr ki g), a matrix of the pairwise SNP covariances (C KxMxM  fcov k i; jg) and a matrix of the genotype frequencies (P KxM  f2p ki g) and outputs the mixture correlation matrix.
Optimization of mixture frequenciesGiven this algorithm for computing the correlation matrix R of the mixture population over a set of SNPs, we turn to the problem of selecting the mixture frequencies ~ f. We formulate this as a constrained optimization problem: minimizing (or maximizing) the value of a given objective function subject to the constraint that P f  1 using the L-BFGS algorithm (). In this context, the 'best guess' approach corresponds to setting f k  1 for the guessed population and f j  0 8j 6  k. In this work, we consider the problems of imputation and joint-testing from summary statistics and therefore selected the MSE of imputed z-scores at observed SNPs and MSE of computed joint-test statistics as our objective functions, respectively (see Sections 2.3 and 2.4). However, other objective functions may be more appropriate depending on the purpose of the summary statistics-based method. For example, one could chose to maximize the likelihood of the observed z-scores ~ Z under a multivariate normal distribution. To allow for variation in local correlation structure, the genome is separated into W equally sized non-overlapping windows. For each window, w 2 f1:::Wg, we compute the correlation matrix using only SNPs in w, R w. Using R w , z-scores are imputed for all SNPs in w and the imputed values are used to compute the MSE from the true z-scores. We exclude SNPs from R w with a minor allele frequency (MAF) less than 0.01 in any of the k populations, missing z-scores, r 2 0:003, or an undefined r with the SNP we are imputing. These SNPs are excluded because they only add noise to the imputation process. To ensure that R is invertible, k is added to the diagonal of the matrix. The final correlation matrix is then R  R unadj  kI. R unadj is the original correlation matrix prior to adding k. The exact algorithm to compute the imputation MSE for a set of SNPs in a window is described in Algorithm 2.
Algorithm 2 MSE objective functionInput: ~ f , V, C, P, windowSize, k,# Impute SNPs in the window for all s 2 f1:::windowSizeg doThe procedure we have described is easily extendable from a window to any region, be it a whole-genome, chromosome or single locus. In this case, ~ f is optimized by minimizing/maximizing the objective function over the sum of the non-overlapping windows. If there are a large number of SNPs in the region of interest, the convergence time of the algorithm will increase. To minimize the computation time when optimizing over the entire genome, we selected regions of the genome that have the largest absolute z-scores. Specifically, for every set of five adjacent windows, we optimized using the two windows with the largest number of z-scores with >1.5.
ImputationThe z-score at a SNP i can be imputed from summary statistics and the correlation matrix, R, using the ImpG approach (). Pasaniuc et al. used a Gaussian approximation combined with a windowing approach to impute the z-score at i. The windowing aims to decrease runtime and reduce statistical noise that might be caused by distant SNPs with random non-zero correlation but no true LD. Define ~ Z t as the set of observed z-scores within a given window size around i. The imputed z-score is thenall SNPs t in the window.
Joint-testingAt genomic loci where two SNPs are negatively correlated, using a marginal test often underestimates effect sizes (). A joint analysis is more powerful than a marginal test when analyzing such SNPs. Given two z-scores computed at SNPs i and j using a marginal test, a v 2 teststatistic with 2 degrees of freedom, J ij can be calculated as shown in Equation (3).In our tests, the calculation of J ij is restricted to SNPs that have a pairwise correlation jrj < 0:8 because small changes in r can cause large fluctuations in J ij as jrj approaches 1.
Simulation frameworkWe simulated data using individuals from the Genes-environments & Admixture in Latino Americans (GALA II) cohort (), which is composed of 1245 Mexican and 1785 Puerto Rican individuals. The Mexican individuals have predominantly European and Native American ancestry, whereas their Puerto Rican counterparts tend to have mostly European and African ancestry.We conducted separate simulations for each group due to the differences in ancestry. We generated quantitative phenotypes and z-scores for every non-overlapping window of 1000 SNPs. For each window, a binomial trial (P  0.01) was used to determine whether the phenotype should be drawn from the null or alternate. Under the null, individuals' phenotypes were drawn from a N 0; 1. Under the alternate, we assumed an effect size of 0.2 and drew individuals' phenotypes from N 0:2g id ; 1, where g id is the genotype of individual d at SNP i. The phenotypes were generated using the SNP in the middle of each window, and z-scores were computed at all SNPs as described in the introduction of Section 2.
Reference panelsReference panels were generated using the 1000 Genomes (1KG) Phase 3 data from the following 11 populations: CEU, IBS, FIN, GBR, TSI, YRI, MXL, PUR, CHB, JPT and GIH. For each dataset we analyzed (i.e. GALA II, CARDIoGRAMplusC4D), we removed any A/T and G/C SNPs to avoid strand issues. We then took an intersection of rsids between our data and the 1KG data to determine which SNPs to include in our reference panels. All SNPs for the reference panels were coded as the number of reference alleles an individual had (i.e. 0, 1 and 2).
ResultsWe applied Adapt-Mix to summary statistics from simulated and real data to estimate the pairwise SNP correlation matrix (R). In this work, we use z-score imputation and joint-testing. For both datasets, we used several approaches to estimate R and impute z-scores. All imputation was done using a window size of 200 SNPs and k  0:1. The values for window size and k were chosen based on the recommended settings used in. We measured the impact of using different methods to estimate R on z-score imputation by computing the MSE and Pearson correlation coefficient (r) between the imputed z-scores and true z-scores. In addition to imputation, we also performed joint-testing in the simulated data because we had access to the individual genotypes and thus they could compute the true SNP correlation matrix. Again, we measured the effect of several R estimation methods on joint-testing by computing the MSE and r between the true joint statistics and the estimated joint statistics.
Simulated dataSimulated z-scores from the GALA II genotypes (see Section 2.5) were used to determine whether our method gave more accurate results for (i) imputing z-scores and (ii) computing joint-test statistics. Since there are multiple ways to optimize mixture frequencies using Adapt-Mix, we compared the use of several optimization strategies against the 'best guess' approach. Using Adapt-Mix, we estimated R using 1KG reference panels by optimizing over each chromosome (1KG-Chrom), over the whole genome (1KG-Genome) and per window (1KGWindow). We note that any SNP used to measure imputation quality was excluded during optimization. Additionally, to evaluate how our method affects imputation and joint-testing when a 'best guess' panel is unavailable, we removed both MXL and PUR panels and optimized frequencies over the chromosomes (1KG-No-PUR-MXL).
Population FrequenciesWe applied our method to simulated data over Mexican and Puerto Rican individuals from the GALA II cohort ().shows the average frequency assigned to each population i184 D.S.when frequencies were optimized per chromosome. When matching reference populations are included in the optimization (MXL for the Mexicans and PUR for the Puerto Ricans), nearly one-third of the mixture is assigned to the matching reference panel. The rest of the frequencies are distributed to populations in a similar manner to the admixture proportions of each group (). Having predominantly Native American and European ancestry, Mexicans have frequencies distributed among European and East Asian panels in addition to MXL. However, when MXL and PUR are not included, we see an increase in frequency assigned to the East Asian panels. Puerto Ricans have more African ancestry than Native American ancestry, and we observe a correspondingly larger frequency of the YRI (African) panel and lower frequencies of East Asian panels.
ImputationWe next evaluated the imputation performance of the different approaches to estimating R. We measured each method's impact on imputation by computing the MSE and Pearson correlation coefficient (r) between the imputed z-scores and true z-scores. We imputed the z-score of the 100th SNP in every window. We restricted our analysis to SNPs with an MAF ! 0.01 in the reference panel since imputation quality tends to be poor for rare SNPs. We also removed from R SNPs that had a r 2 0:003 with the SNP we were imputing. When using a mixture reference panel, we filtered SNPs using a mixture MAF. The mixture MAF for SNP i is P K k1 f k MAF ki , where f k is the mixture frequency assigned to population k and MAF ki is the MAF of SNP i in k. As the gold standard, the original GALA II genotypes were used to estimate R. It is clear from Tables 1 and 2 that using the original genotypes results in very high imputation quality. To demonstrate that using the wrong reference panel can cause a huge decrease in performance, we imputed z-scores using YRI and JPT as reference panels for the Mexicans and Puerto Ricans, respectively. Using theAdapt-Mix: learning local genetic correlation structure improves summary statistics-based analyses i185 wrong reference panel resulted in MSE increasing over 400% in the Mexicans and over 250% in the Puerto Ricans. Next, z-scores were imputed using Adapt-Mix to estimate LD. We found that for imputation in admixed individuals, locally optimizing mixture frequencies over each window performs the best. For z-scores imputed over the whole genome, there is a 28.8% decrease in MSE for the Mexicans and a decrease of 15.7% for the Puerto Ricans (Tables 1 and 2). Similar decreases in MSE are seen when optimizing frequencies over the chromosome and the entire genome. Even when MXL and PUR were removed, we see that our method approach to estimating R outperforms the 'best guess' panel. We also see increases in the r of imputed and true z-scores in the Mexicans and the Puerto Ricans when using Adapt-Mix. The increase in r is equivalent to an increase of 25.0% and 12.8% in effective sample size for the Mexicans and Puerto Ricans, respectively. Interestingly, the local optimization approach does not necessarily find mixture frequencies that are closest to the study's overall mixture of ancestry. The results here indicate that using such a mixture may not be the best for imputation accuracy and highlights the benefits of using the correct objective function when optimizing mixture frequencies for the selected summary statistics-based method.
Joint-testJoint-testing of pairs of SNPs from summary statistics also relies on estimates of the pairwise correlation between SNPs (). Using SNPs on chromosome 22, we computed true joint statistics using R computed from the genotypes of the GALA II individuals. The estimated joint statistics were computed using R estimated using Adapt-Mix. The mixture frequency optimization strategies were the same as those used in z-score imputation. We computed Joint statistics for SNPS that had a MAF or mixture MAF ! 0:05 in all of the R estimation approaches. Tables 3 and 4 show that using a R estimated from a mixture reference panel results in increased performance over using a 'best guess' reference panel. In both populations, the frequencies optimized per chromosome (1KG-Chrom) performed the best. Compared with using a 'best guess' panel, we observed a 73.7% decrease in MSE for the Mexicans and a 70.2% decrease in MSE for the Puerto Ricans. We plotted the estimated joint statistics versus the true joint statistics for Mexicans and Puerto Ricans for different choices of R (). The results show that joint statistics computed using the combined reference panel are in higher concordance with the truth than the 'best guess' panel. Remarkably, even when MXL and PUR are removed from the mixture, estimates of R improvements can be clearly seen (). To show that the joint statistics produced by using our method for estimating correlations are unbiased (i.e. E 0), we looked at the mean difference between the true statistics and estimated statistics. Tables 3 and 4 show that the mean difference is closer to 0 when our approach is used in both the Mexicans and Puerto Ricans. The 1KG-Chrom-based correlation estimates generated differences in true versus estimated that were the closest to zero amongst all approaches. We can see from Tables 3 and 4 that 1KGChrom has the smallest variance for the differences in true versus estimated joint statistics. The 'best guess' panels had the highest variance of all approaches except for 1KG-Genome in the Puerto Ricans. Additionally, we examined all estimated joint statistics that were more than 2 chi-squared units from the truth. In Mexicans, we saw 122 such statistics for the MXL and 22 for 1KG-Chrom (). A similar trend is seen in Puerto Ricans as well, with 53 large deviations for the PUR and 3 for 1KG-Chrom (). The decrease in frequency and magnitude of large differences demonstrates that using Adapt-Mix can help reduce the number of false positives in a joint analysis using reference panels. However, high deviations seen in both methods indicate that regardless of approach there is potential to misestimate the pairwise correlation coefficients of SNPs.
Real data
Population FrequenciesWe applied our method to the C4D coronary artery disease dataset from the CARDIoGRAMplusC4D consortium (CARDIoGRAM plusC4D, Coronary Artery Disease (C4D)). In the C4D study, the discovery cohort consisted of 14 790 South Asians and 15 692 Europeans. South Asians are known to have undergone admixture between two ancestral populations, with one of the ancestral populations being genetically similar to Europeans (). Consistent with the admixture seen in South Asians, we see mixture frequencies for C4D that are assigned primarily to the European and the South Asian panels ().
ImputationThe C4D data provided us with an opportunity to assess how our method affects the performance of z-score imputation in the context of a dataset with different population structure than that used in the simulations. Unlike our simulations, where everybody was admixed, the summary statistics in C4D were generated using a mixture of individuals with homogenous ancestries (Europeans) and heterogeneous ancestries (South Asians). As we did for the simulated data, we used MSE and r of the imputed z-scores as our performance metrics. Here, we estimated R using a 'best guess' reference panel, 1KGChrom and 1KG-Window. We chose to optimize frequencies for the 1KG reference panels over each chromosome and each window because these two approaches performed the best in our simulations. We imputed the 100th SNP in each window and we restricted our analyses here to SNPs that had (mixture) MAF ! 0:01. As the 'best guess' reference panel for C4D, we used GIH and CEU because the C4D discovery cohort was composed of roughly an equal number of individuals with a European or South Asianancestry. When imputing we saw similar results to our simulations. Compared to using CEU or GIH, there was a decrease of 30.1% or 36% in MSE, respectively (). In terms of r, we saw increases of about 7% over CEU and about 9% over GIH for both 1KGWindow and 1KG-Chrom. The increase in correlation is equivalent to an increase of 15% in effective sample size compared to CEU.
DiscussionSummary statistics-based methods requiring an estimate of the genetic correlation matrix are becoming increasingly popular; however, very few GWAS include LD information in their released data. In prior work, this information has been approximated by using LD information from 'best guess' reference panels, but here we show that this can lead to high error rates even when a population closely matching the study population is available (). Our method can be used to improve the accuracy of any summary statistics-based method that requires LD information by more accurately estimating the local genetic correlation structure using information available across several reference populations. Our simulations have demonstrated the importance of accurately estimating the genetic correlation matrix. Using Adapt-Mix to estimate LD for summary statistics methods can increase their power and decrease their false positive rates. For example, for z-score imputation,showed that as long as there is a best guess reference panel available, there is no increase in false positive rate when imputing summary statistics. However, in the case that there is no best guess panel available, we have shown that thereAdapt-Mix: learning local genetic correlation structure improves summary statistics-based analyses i187 is a potential for increased false positives by using the wrong reference panel. One of the biggest benefits of our method is allowing the analysis of arbitrary populations when a matching reference panel is not available. We were able impute z-scores and compute joint statistics with better precision 'best guess' panels alone even after leaving out the relevant 'best guess' panels from our computation of R. For datasets with admixed individuals, the high variability of ancestry proportions may make it harder to consistently model LD in an accurate manner with a single reference panel. For example, in the Native American component Latinos, there is a high level of population substructure (). In the 1000 Genomes reference panels, there are currently no Native American reference panels available. Although proxy populations such as CHB and JPT are often used, they are unlikely to capture the full resolution of each underlying sub-population. Accounting for all the fine scale differences seen in admixed individuals will improve with the collection of additional reference panels. In this work, we aimed to minimize the MSE of imputed summary statistics in our objective function because imputation was one of our main focuses. For other purposes, it may be more appropriate to use a different objective depending on how the pairwise correlation estimates will ultimately be used. For example,use summary statistics to fine map causal variants by finding the set of variants that maximize the likelihood of a multivariate normal distribution. In this case, optimizing frequencies for reference panels by using the multivariate normal likelihood may improve performance. Improvements to Adapt-Mix may be made by using an out-ofsample approach to learning the mixture frequencies due to the potential of overfitting. Typically, overfitting will cause high prediction error variances. We have shown though, with the example of joint-testing, that overfitting should not be a major concern as the error variances are smaller when using Adapt-Mix compared with a 'best guess' panel. Another enhancement could be made to Adapt-Mix by using partial correlations. Often covariates such as principal components are included in GWAS, which alter the genetic correlation structure of the individuals being studied. Partial correlations which account for these covariates may provide even more accurate estimates of the R for use in summary statistics methods.
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
