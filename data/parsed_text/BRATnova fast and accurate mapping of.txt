In response to increasing amounts of sequencing data, faster and faster aligners need to become available. Here, we introduce BRAT-nova, a completely rewritten and improved implementation of the mapping tool BRAT-BW for bisulfite-treated reads (BS-Seq). BRAT-nova is very fast and accurate. On the human genome, BRAT-nova is 2–7 times faster than state-of-the-art aligners, while maintaining the same percentage of uniquely mapped reads and space usage. On synthetic reads, BRAT-nova is 2–8 times faster than state-of-the-art aligners while maintaining similar mapping accuracy, methylation call accuracy, methylation level accuracy and space efficiency. Availability and implementation: The software is available in the public domain at
IntroductionWhole genome bisulfite sequencing (BS-Seq), allows genome-wide studies of DNA methylation at single base pair resolution. Sodium bisulfite treatment of DNA () followed by PCR and sequencing enables the detection of the methylation status of individual cytosines. The first step in BS-Seq analysis is to map bisulfite-treated reads to the reference genome. Since sodium bisulfite converts unmethylated cytosines to thymines, the criteria for mapping BS-Seq reads requires one to allow a T in a read to match a C in the reference genome. Various indexes have been used to accelerate the mapping of BSSeq reads to a reference genome. In practice, tools that employ the FM-index () achieve the best balance between space requirements, mapping accuracy and speed. Among these, Bismark () and BS-Seeker/BSSeeker2 () are arguably the most commonly used tools for BS-Seq data. Here, we introduce BRAT-nova, a completely rewritten and improved implementation of BRAT-BW () for aligning BS-Seq reads. BRAT-nova employs a novel space-efficient representation of the genome and supports local alignment by allowing one indel per read. BRAT-nova is 211 times faster on the human genome than Bismark, BS-Seeker2 and BSMAP () while demonstrating comparable results in terms of the proportion of mapped unique reads, mapping accuracy, methylation level and methylation call accuracy and RAM usage. negative strands with Cs converted to Ts, and each read with Cs converted to Ts is aligned only once to a single index, which speeds up the mapping step. For large genomes such as the human genome, the concatenation of positive and negative strands is longer than 2 32 bases, which is the current genome size limit for BRAT-BW. To handle this, BRAT-nova uses an additional bit per base to track the strand identity. After mapping bisulfite-treated reads, BRAT-nova determines the methylation level of each cytosine. The methylation level of a cytosine is defined as the fraction of mapped reads that have a C (i.e. methylated, thus not converted to a T) in that genomic location, to the total number of reads mapped to that location (i.e. with a C or a T). BRAT-nova supports a single variable-length indel in the middle of a read by using two exactly matched seeds surrounding the indel followed by the linear time dynamic programming algorithm described in the Supplemental Notes.
Experimental results and discussionTo assess the performance of BRAT-nova, we benchmarked it against Bismark (that supports end-to-end alignment with indels), BS-Seeker-2 (that supports local alignment with indels), BSMAP (supports end-to-end alignment with one gap) and BRAT-BW (that supports end-to-end alignment with no indels). We evaluated all tools using real human genome reads from dataset SRR306435 () and dataset SRR306421 (), as well as synthetic reads generated from human genome GRCh38. Our experiments measured mapping efficiency, mapping accuracy, methylation call accuracy, methylation level accuracy, running time and space usage. Below, we report the results of our benchmarking; see Supplemental Notes for a full description of the benchmarking methods. On real reads, we ran each tool using various parameter settings and measured the percentage of uniquely mapped reads (i.e. reads mapped with the highest score to a single location), running time and RAM usage. Experimental results are reported in(see Supplemental Tools 13 for more details). The percentage of uniquely mapped reads and running time can vary significantly depending on the parameter settings. In terms of uniquely mapped reads, BRAT-nova showed a comparable range of performance as other tools, but it was 211 times faster (Supplemental).On synthetic reads, we measured two types of mapping accuracy defined as the ratio of uniquely mapped reads aligned within 50bp and 0bp of the original positions (same chromosome, same strand) to the total number of uniquely mapped reads. Supplementaland Supplemental Tables S4S6 report the results of the mapping accuracy tests. Again, the mapping accuracy can vary significantly depending on the parameter settings. All tools showed a higher mapping accuracy with stricter parameters at the expense of a smaller percentage of reads mapped. In these experiments, BRAT-nova showed comparable results with all other tools. Next, we measured the performance of the tools in terms of methylation call accuracy and methylation level accuracy. Methylation call accuracy was measured as the ratio of the cytosines whose methylation status was correctly identified (methylated or not methylated) to the total number of the cytosines covered by at least ten reads. A cytosine was considered to be methylated if it had a methylation level of at least 0.5, and unmethylated otherwise. To calculate the methylation level accuracy, we used a randomized analysis (see Supplemental Notes). Supplemental Figures S3 and S4 and Supplemental Tables S7 and S8 show the results for methylation call and methylation level accuracy tests; BRAT-nova showed comparable results to the other tools. With strict parameters, all tools mapped fewer reads with higher mapping accuracy. However, despite decreased mapping accuracy with loose parameters, methylation level accuracy was 24% higher for all tools compared to strict parameters. In these experiments, BRAT-nova was 28 times faster than Bismark, BS-Seeker2, BSMAP and BRAT-BW.
FundingThis project was supported in part by NSF IIS-1302134.
Methods For a directional library (i.e. when the chosen BS-Seq protocol produces reads only from the two original strands), in order to allow a T in a read to map to a C in a genome, both Bismark and BSSeeker2 use two FM-indexes built from positive strand of the reference genome: in the first, Cs are converted to Ts, and in the second, Gs are converted to As. During the mapping phase, reads with Cs converted to Ts are mapped to the first index, while the reversecomplement of the reads with Gs replaced by As are mapped to the second index. Thus, in Bismark and BS-Seeker2 each read requires two alignments to two distinct indexes. BRAT-nova instead uses a single FM-index built on the concatenation of the positive and V C The Author 2016. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com 1 Bioinformatics, 2016, 13 doi: 10.1093/bioinformatics/btw226 Advance Access Publication Date: 23 February 2016 Applications Note Bioinformatics Advance Access published May 19, 2016 at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
