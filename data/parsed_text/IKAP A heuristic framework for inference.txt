Motivation: Phosphoproteomics measurements are widely applied in cellular biology to detect changes in signalling dynamics. However, due to the inherent complexity of phosphorylation patterns and the lack of knowledge on how phosphorylations are related to functions, it is often not possible to directly deduce protein activities from those measurements. Here, we present a heuris-tic machine learning algorithm that infers the activities of kinases from Phosphoproteomics data using kinase–target information from the PhosphoSitePlus database. By comparing the estimated kinase activity profiles to the measured phosphosite profiles, it is furthermore possible to derive the kinases that are most likely to phosphorylate the respective phosphosite. Results: We apply our approach to published datasets of the human cell cycle generated from HeLaS3 cells, and insulin signalling dynamics in mouse hepatocytes. In the first case, we estimate the activities of 118 at six cell cycle stages and derive 94 new kinase–phosphosite links that can be validated through either database or motif information. In the second case, the activities of 143 kin-ases at eight time points are estimated and 49 new kinase–target links are derived. Availability and implementation: The algorithm is implemented in Matlab and be downloaded from github. It makes use of the Optimization and Statistics toolboxes. https://
IntroductionPhosphoproteomics is a branch of proteomics that identifies, catalogues and characterizes proteins containing a phosphate group as a post-translational modification. Since intracellular signal transduction is primarily mediated by the reversible phosphorylation of various signalling molecules, data generated by phosphoproteomics approaches is commonly used to study the dynamics of signalling networks (). A major challenge in the analysis of such data lies in the high combinatorial complexity of the observed signalling networks. The human genome encodes roughly 540 kinases that phosphorylate 20 000 proteins at probably more than 350 000 phosphosites (). Hence, the number of possible targets per kinase tends to be high, and the majority of proteins acting as kinasetargets can be phosphorylated at multiple sites, where each site can potentially be targeted by several kinases, resulting in an intricate network of kinases, target proteins and phosphatases, which remove the attached phosphorylations again. Both kinases and phosphatases can thereby themselves be phosphorylated. The situation gets further complicated by the fact that mostknown phosphosites can so far not be related to a distinct protein function. Thus, most research up to the present focuses on individual phosphoproteins and kinases or is restricted to clustering and enrichment methods which group the detected sites according to their behaviour and relate the proteins they are localized on to cellular processes like canonical pathways, transcriptional networks or disease mechanisms via statistical testing against databases (). Modelling of phosphoproteomics networks is usually limited to few components (<50) and rather includes single phosphosites than whole proteins due to the lack of functional information (). To address these challenges, we developed the machine algorithm IKAP (Inference of kinase activities from phosphoproteomics) that estimates the activities of all kinases that are known to phosphorylate at least one phosphosite in a phosphoproteomics dataset. IKAP takes information from the PhosphoSitePlus (PSP) database as input and uses a non-linear optimization routine to minimize a cost function that relates kinase activities and affinities to phosphosite measurements. The predicted activities directly display the engagement of signal transduction pathways such as cAMP/PKA, Ca 2/ PKC, MTOR or Akt kinase pathways. If data for multiple time points or conditions are available, each kinase receives a unique activity profile which depicts the change of cellular function over all conditions. Furthermore, these profiles can be used as an input for mathematical modelling which enables the usage of protein nodes instead of phosphosite nodes, making the model more meaningful and predictive. Another application lies in the inference of possible new kinasetarget links. By correlating the calculated kinase activity profiles to the measured phosphosite profiles the kinases that are most likely to phosphorylate a respective phosphosite can be derived. To demonstrate the capabilities of IKAP, we applied it to two previously published phosphoproteomics datasets. The first comprises a study of the human cell cycle in HeLaS3 cells (). Eukaryotic cells replicate by a complex series of evolutionarily conserved events that tightly regulate defined stages of the cell division cycle. Progression through this cycle involves a large number of dedicated protein complexes and signalling pathways, and deregulation of this process is implicated in tumourigenesis. Global analyses of transcriptome dynamics during the cell cycle have been performed in microarray studies. However, in addition to changes in messenger RNA (mRNA) abundance, protein phosphorylation and targeted protein degradation are also important regulators of cell cycle progression. To examine the influence of protein phosphorylations on the progression of the cell cycle, the phosphoproteome was measured through a combination of immobilized metal affinity chromatography () and stable isotope labelling of amino acids () at the six phases G1, G1-S, early-S, late-S, G2 and M. Further details can be found in. The second dataset is a study of insulin signalling dynamics in the mouse liver (). Here, the phosphoproteome was measured after 0, 0.5, 1, 2, 3, 4, 6 and 10 min after stimulation with insulin.
MethodsThe algorithm consists of a set of Matlab functions that have to be sequentially executed. The package including explanations for use can be found in the Supplementary Material and in our code repository at github. All scripts were written in Matlab R2014b, but were tested on earlier versions down to R2012a. The algorithm makes use of functions from the Optimization and Statistics toolboxes for parameter estimation and statistical analysis. It is divided into three parts, where in the first part kinase activities and affinity parameters are estimated from the measured data using known interactions, in the second the calculated kinase profiles are used to infer possible new kinasetarget links, which are validated through database, motif and literature information in the third part. All experimental methods can be found in Olsen et al. (2010).
Part 1: estimation of kinase activitiesThe algorithm assumes as an input a data sheet consisting of protein or gene names, the sequences of the measured peptides and t columns with data values. 1. The first function performs a PSP database search for all sequences in the dataset and outputs the kinases that are known to phosphorylate each sequence in a column next to the data values. The PSP database (Kinasesubstrate dataset) can be downloaded from http://www.phosphosite.org/staticDownloads.do. 2. In the next step, the kinases found can be filtered by proteomics data to ensure only those kinases that are present in the cell type under investigation are included. This step is optional. Afterwards, the original dataset is filtered for those phosphosites that have at least one annotated kinase in PSP which is present in the proteome. If no proteome data is available, the filtering is done with respect to all kinases from the first step. We end up with a reduced dataset data_red and the string array kin that contains the kinase names. 3. The third step generates a truth table for the kinase phosphosite interactions in the reduced dataset. It produces the n  m matrix A with A(i,j) [ {0,1}, n being the number of phosphosites in the reduced dataset and m the number of kinases in kin. 4. Now that we have produced data_red, kin and A, we can use these variables to perform the optimization task of finding the kinase activities which best explain our data. In the most simple case, the activity k of kinase l at time point i can be defined as the product of the kinase's abundance a, which is mostly known by proteomics data, and its mobilization m; which is dependent on posttranslational regulation.The effect e a certain kinase has on a phosphosite j can in turn be regarded as the product of its activity and the affinity p the kinase has to the respective phosphosite.Thus, we can define the value of phosphosite j as the mean of all effects acting on it. Since the affinities of various kinases to phosphosite j are different and both activities and affinities would become structurally non-identifiable if calculated for one single condition, the mean is computed by dividing the summed effects by the sum of affinities instead of the number of kinases. Hence, optimization is done by minimizing the cost functionwith t being the number of time points measured, n the number of phosphosites in the reduced dataset, m the number of kinases that phosphorylate site j, K the activity of kinase l for j at time point i, p the affinity of kinase l for site j and P the measured value of site j at time point i.gives an exemplified overview of how IKAP: A heuristic framework for inference of kinase activities from Phosphoproteomics dataphosphosites are modelled at a given time point. The affinity parameters are optimized globally with respect to all measured time points, whereas the kinase activities are estimated for each time point separately. The function makes use of the Matlab built-in function fmincon which is part of the Optimization toolbox and uses a trust region related routine to find a parameter set that minimizes our cost function (3) applying parameter bounds. Bounds were set to 0 and 50. Besides the model-to-data-distance of a given parameter set, Step 4 also calculates the parameters' gradients, which are then forwarded to fmincon. In addition to the variables data_red, kin and A, a fourth input is the desired number of iterations. Since for each iteration, the starting values for both kinase activities and affinity parameters are randomized, a higher number of iterations yields a better coverage of the parameter space and thus a better chance to find the global optimum. The outputs of Step 4 are the arrays K and AP which contain the optimal kinase activities and affinities as well as the minimal cost. 5. In this optional step, we test the identifiability of the calculated activities. This is done by exploring the v 2 space along the dimension of the respective kinase activity. If the resulting profile exhibits a minimum, the activity is identifiable on the basis of the measured data.
Part 2: inference of kinasetarget linksIn this part, the calculated activity profiles are applied to infer the most likely kinases for each phosphosite by means of correlation coefficients. Our assumption is that the phosphorylation state of a site is correlated to the activity of the kinase that dominates the phosphorylation of this site. In case of one dominating kinase for a site the phosphorylation state of the site and the activity of the kinase result in a high correlation coefficient. A high and significant correlation therefore points to a kinasesubstrate link. In case of sites that are phosphorylated by several different kinases, the phosphosphorylation time profile is the sum of the activity profiles of these kinases. If the contributions of the kinases to the phosphorylation of the sites are in a similar range a correlation will be less obvious. It should be pointed out, however, that the sum of the activity profiles of one set of kinases might mimic the activity profile of other kinases. Potentially, this could lead to the detection of false positive kinase substrate links. 1. Using the function ComputeDistances, we calculated P-values for all kinasephosphosite pairs in the complete dataset by computing the correlation coefficient between the estimated kinase profiles and the measured phosphosite values. The function generates the n  m matrix dist. Each entry represents a P-value for the respective kinasetarget interaction indicating the probability of getting a correlation as large as the observed value by random chance, when the true correlation is zero. Since not every phosphosite has a valid measurement value at all applied conditions, the function also outputs a vector containing the number of valid values for all phosphosites. This can be important when comparing the different P-values to each other. 2. The second step generates the cell array psig, which includes all significant kinasephosphosite links and their respective P-values, taking the newly produced distance matrix dist, the kinase list kin and the desired false discovery rate as an input.
Part 3: validation functionsNow that we have derived the most likely kinases for each phosphosite, we validate the newly found interactions by means of database information from IPA (QIAGEN Redwood City, www.qiagen.com/ ingenuity) and MetaBase (Thomson Reuters, http://thomsonreuters. com/metabase) as well as motif information from NetworKIN (). Since the latter is based on the STRING database, this also covers publicly available information at this point. Before we start to validate our links, Part 2 should be repeated with a dataset from which the pairs in the reduced dataset are removed to guarantee for an unbiased validation. This can be done by the optional function MakeDataVal, which produces data val. 1. This step produces a list pnsig which has the same size as psig and contains randomly taken kinasephosphosite links for comparison. 2. To validate our significant links, we established a list of all kinasetarget links which are present in the IPA and MetaBase databases. Those links are not phosphosite-specific but rather limited to interactions of kinases with entire proteins. However, if a certain kinaseprotein link can be found in the databases and a phosphosite located on that protein has a low IKAP P-value with respect to the respective kinase, the interaction is likely to be realized within the investigated cell type. The function compares the database list with both psig and pnsig, counts the agreements and calculates a P-value by means of a fisher exact test. Since pnsig has been generated randomly, Steps 1 and 2 should be repeated several times with taking the mean of all obtained P-values. 3. The second validation consists in checking the likelihood of the found interactions in a motif-based manner via NetworKIN (), which is an integrated platform for modelling kinase signalling networks by combining sequence specificity with cellular context from the STRING database (). Thus, here we replenish our database validation from Step 4 by publicly available resources. This is again done for both psig and pnsig. In this case, the algorithm calculates two different P-values. The first is based on the summed likelihoods of all links in psig and pnsig , respectively, and the second is computed on the number of significant likelihoods (!1) in both lists. Both P-values are derived by a fisher exact test.
Results
Calculation of kinase activities and most likely pairsWe started our analysis with the HeLaS3 phosphoproteome data (Supplementary Material, original data mit.xls) taken fromand the mouse liver data taken from(Supplementary Material, data-mit.mat).In the case of HeLaS3 data, where proteomics measurements were available, the measured phosphopeptide values are normalized with respect to the corresponding changes in protein abundance to determine changes in phosphorylation state rather than changes in protein abundance. Here, all values are given as log 2 and lie within the interval. The data contains 24 714 phosphosites in total which were measured at the six cell cycle stages G1, G1/S, early S, late S, G2 and M.depicts the overall workflow. By applying IKAP Part 1, we at first obtained a reduced dataset comprising 1069 phosphosites for which at least one kinase is known from PSP. Filtering of the obtained kinases by proteomics led to a list comprising 118 kinases which are expressed in HeLaS3 and known to phosphorylate a peptide in our dataset at the respective position. By applying Step 4 with an iteration number of 100, we estimated the activities of these 118 kinases within the six cell cycle stages. As quoted before, affinity parameters were estimated globally with respect to all six conditions, whereas kinase activities were fitted for each condition separately. Parameter bounds were set to 0.1 and 10 for affinity parameters and 15 and 15 for activities. The latter thus lie in the same range as the phosphosite measurements. To match units and for the sake of clarity, we can modify Equation (1) to:The mobilization factor m is now comparable to a raw phosphosite value. However, since we estimate k, the algorithm is not affected by this change. Fitting led to an overall v 2 =N value of 1.22 for N  6414 data points (1069 phosphosites at 6 conditions) and 1777 parametersshows the five most and least active kinases at each cell cycle stage. In all stages, we see at least one member of the MAPkinase pathway among the five most up-regulated kinases. This suggests this pathway to be particularly active in HeLaS3 cells. In, the mean kinase activity is displayed. We can see that the overall kinase activity is highest at G1 and G2, and lowest during the S and M phases, which is what we would expect (). IKAP Part 2.1 produces a distance matrix which displays P-values for all kinasephosphosite pairs. Step 2.2 finally shows all significant pairs (2684 with false discovery rate  0.05).exemplary depicts the profiles of CDK1, CDK4, GRK5 and NEK2, each along with one of their most likely targets. An activity value of zero indicates no post-translational regulation to be present. Here, the mobilization factor is zero. Higher activity values imply a posttranslational up-regulation, whereas lower values suggest a posttranslational down-regulation. The activity of CDK1 is high during mitosis but low during S phase (), which is what we would expect (). CDK4 on the other hand shows its highest activity in G1 followed by a drop and a second onset in late S phase (). Here, we would expect a single peak within the G1 and S phases () indicating that cell cycle control is altered in HeLaS3 cells. The GRK5 protein phosphorylates the activated forms of G proteincoupled receptors thus initiating their deactivation. Its activity should be highest within the G1 phase and lowest during the S-phase (), which is confirmed by our approach (). NEK2 is a protein which localizes to the centrosome, and is undetectable during G1 phase, but accumulates progressively throughout the S phase (), which is consistent with our model as well (). All kinase activations can be found in the Supplementary Material. In the insulin signalling dataset, a total of 9782 phosphosites was measured with respect to eight time points (0, 0.5, 1, 2, 3, 4, 6 and 10 min after stimulation with insulin). The values are given as log 2 and lie within the interval. IKAP Part 1 leads to a reduced dataset containing 487 phosphosites for which a kinase is known and 143 kinases that are known to phosphorylate at least one site in the data (Steps 1 and 2). After calculating the truth table (Step 3), the kinase activities and affinity parameters were estimated with an iteration number of 100 (Step 4). For affinity parameters, we chose the same bounds as for the mitosis experiment (0.1 and 10), whereas bounds for kinase activities were set to 0 and 50 to match the range of measured values. Here, no proteome normalization was performed and Equation (1) stays in its basic form.. After 30 s and 1 min, we see a strong increase in the activity of Nemo-like-kinase, which is an atypical member of the MAPK family. Its activation mechanism and downstream targets are still not well characterized. Thus, it could be an interesting target of further investigations. TBK1, whose activity rises after 1 min, can mediate NFKB activation in response to certaingrowth factors. This result suggests a crosstalk between the classical insulin receptor and the NFKB pathway and could be another rewarding target for future experiments. The insulin receptor shows up among the 10 mostly up-regulated kinases at all examined time points, which is what we would expect. The strongest down-regulation affects kinases which are involved in cytoskeletal rearrangements, like MYLK, ROCK2 and LIMK2. In, the mean kinase activity is plotted in dependence of time. The trajectory shows a biphasic behaviour with a first peak after 2 min and a second after 6 min. This could be due to autocrine signalling or other time-delayed feedback-loops.exemplary depicts the profiles of GRK6, CDK5, PLK3 and MAP2K4, each along with one of their most likely targets. In this dataset, the activities of many kinases show either a peak or a drop within the first minute after stimulation, followed by a return to basal levels. Thus, insulin seems to have a rather short lasting effect in murine hepatocytes.
Identifiability analysisTo test whether the optimization results are unique, we performed an identifiability analysis by means of profile likelihood examination (). For each condition and each kinase, the computed kinase activity was increased and decreased in a stepwise manner. The new value was then fixed and the other parameters reoptimized to get an impression of the v 2 landscape along the dimension of the respective kinase activity. All kinase activities displayed a minimum within the v 2 space and were thus found to be identifiable.exemplary shows the v 2 profiles of the kinases CDK1, CDK4, GRK5 and NEK2 at G1 of the HeLaS3 dataset () and of AKT1, MAPK1, MTOR and TBK1 at 0.5 min of the mouse liver dataset. In some cases, like the CDKs, an activity increase has more severe effects than a decrease, whereas in other cases, like NEK2, the activity can vary within a certain interval without larger effects.
ValidationBy exerting IKAP Part 3, we validated our approach through literature and motif information. After producing the lists psig and pnsig, we tested both lists against all known kinasetarget pairs of the IPA and MetaBase databases and computed a P-value by applying a fisher exact test to the number of hits in both lists (Step 2 IKAP Part 3). This was done five times, each time varying the list pnsig. In the HeLaS3 example, the number of hits for psig turned out to be 42 out of 2684, whereas the average number of hits for pnsig was just 2 out of 2684. This led to a P-value of 9.7278*10 11 (pDB Mit,). In the mouse liver example, psig showed 33 hits out of 3599 significant kinasetarget pairs. Compared with pnsig , this leads to a P-value of 1.3605*10 5 (pDB Ins). Estimating kinase activity profiles and correlating those to phosphosite measurements thus produces a significantly higher amount of literature-known kinasetarget pairs than taking random combinations of kinases and targets. Step 3 finally utilizes the amino acid sequence of the phosphorylated peptide to infer a likelihood for the kinasetarget pair underKinase activities correspond to log 2 ratios of mobilization and proteome intensity. Lines with circles  kinases, lines with crosses  targets investigation via NetworKIN (). A likelihood ! 1 can thereby be regarded as significant. This step is again applied several times to both psig and pnsig to be able to calculate two different P-values on the basis of fisher exact tests. On the one hand, a P-value for the summed likelihoods of psig and pnsig is calculated in each iteration (pSUM). On the other, a P-value accounting for the number of significant likelihoods in psig and pnsig is computed (pNUM).gives an overview of all three P-values generated by Steps 2 and 3 and displays the respective input numbers. pSUM turned out to be 2.5661*10 28 whereas pNUM came down to 8.8961*10 12 for the HeLaS3 example. For the mouse liver example, motif validation led to P-values of 0.0179 (pSUM Ins) and 0.0013 (pNUM Ins). Even though these are substantially higher than those for the HeLaS3 data, applying an alpha of 0.05 for the fisher exact test leads to significant test results in all cases. Thus, on the basis of sequence information the kinasetarget links identified by our algorithm are substantially more likely than random pairs. To replenish our validation through findings that are not included in one of the three databases but nonetheless appear in literature, we performed a Linguamatics search () for both psig and pnsig links. This led us to 216 vs 122 hits resulting in a P-value (pLIN) of 1.4694*10 7. If a significance level of 0.01 is applied, all four P-values lie far below this threshold, indicating the algorithm to be beneficial. However, since the algorithm relies on correlations of the time courses of single kinases and phosphosites, whereas in the cell the time profile of a phosphosite is likely to be the result of several kinases phosphorylating it, the method can only capture those links where one kinase is predominant. In addition, it should be remarked that the overall coverage of significant links and validated links is a mere 1.56% for database-based, 1.93% for motifbased and 8.04 for literature-based validation. Esitmated kinase profiles in the mouse liver experiment, each in combination with one of its most likely targets. Original measurement values and kinase activities are given as log 2 intensities. Lines with circles  kinases, lines with crosses  targets. Chi 2 space in the dimensions of CDK1, CDK4, GRK5 and NEK2 activities at G1 of HeLaS3 dataset (A) and of AKT1, MAPK1, MTOR and TBK1 at 0.5 min of liver dataset (B). All Chi 2 courses display a minimum, the kinase activities can thus be determined uniquely using the applied data IKAP: A heuristic framework for inference of kinase activities from Phosphoproteomics databy the algorithm should therefor in the first place be regarded as guidelines for experimental verification. Nevertheless, we regarded a statistical validation of newly found kinasetarget links to be a more reasonable means of verification than a comparison of kinase activities to autophosphorylation sites, since on the one hand in the most of all cases they can be phosphorylated by several other kinases as well, and on the other the activity of a kinase is a function of all its sites.
DiscussionPhosphorylation of serine, threonine and tyrosine plays significant roles in cellular signal transduction and in modifying multiple protein functions. Phosphoproteins are coordinated and regulated by a network of kinases, phosphatases and phospho-binding proteins, which modify the phosphorylation states, recognize unique phosphopeptides or target proteins for degradation. Detailed and complete information on the structure and dynamics of these networks is required to better understand fundamental mechanisms of cellular processes and diseases. High-throughput technologies have been developed to investigate phosphoproteomes in model organisms and human diseases. Among them, mass spectrometry-based technologies are the major platforms and have been widely applied, which has led to explosive growth of phosphoproteomic data in recent years. New bioinformatics tools are needed to analyse and make sense of these data. Moreover, most research has focused on individual phosphoproteins and kinases. To gain a more complete knowledge of cellular processes, systems biology approaches, including pathways and networks modelling, have to be applied to integrate all components of the phosphorylation machinery, including kinases, phosphatases, their substrates and phospho-binding proteins. We developed here a machine-learning algorithm that estimates the activities of all kinases which are known to phosphorylate sequences occurring in a phosphoproteomics dataset. The algorithm thus reduces the dimensions of the parameter space to the number of kinases, and renders the data easier to display and analyse. The estimated activities can then be used for modelling or inference of new kinasetarget links. Previous approaches to infer kinase activities from phosphoproteomic data only rely on the number of targets in the sample, without taking the detected amounts of phosphorylation into account (), or solely deliver relative activities from one condition to another () and do not include affinity parameters for kinasetarget interactions. IKAP however calculates the absolute activities for each condition separately and thus provides a more precise picture of pathway engagement in biological samples. Furthermore, in opposition to previous approaches, an arbitrary number of kinases can be assigned to each phosphosite, which makes the approach more realistic compared with sorting phosphosites into distinct kinase groups and considers uncertainties in kinase specificities for certain targets. Especially in the case of time-resolved data the computed kinase activities are directly applicable as an input to subsequent dynamical modelling. The calculated affinities can thereby be used as starting points for parameter calibration, and through the use of identifiability analysis it is possible to determine how reliable the computed activities are. The derivation of novel kinasetarget pairs as it is described in () is an in vitro method that has to be performed for each kinase individually. Thus, it is much more time consuming. Furthermore, IKAP provides a ready-to-use framework, whereas previous approaches need to be implemented by the user from scratch. Although the approach does not include phosphatases, both the estimated kinase activities and the newly derived links proved to be reliable in literature-and motif-based validation. Our conclusion is that, at least in HeLaS3 cells and murine hepatocytes, phosphatase activity could rather be considered as a factor which removes phosphorylations at a constant rate than a mechanism which is under sophisticated regulation. Since this can be different in other cell types, the findings that are generated through the application of our method should always be critically appraised and validated. The algorithm represents a step towards a system-wide understanding of signal transduction processes within a cell. In the near future, we will further test it on other phosphoproteomics datasets and implement versions in other programming languages like Python and R to make it available to a larger community of scientists.
FundingThe project was funded by Sanofi-Aventis Deutschland GmbH, Frankfurt, Germany Conflict of Interest: none declared.IKAP: A heuristic framework for inference of kinase activities from Phosphoproteomics data
at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
M.Mischnik et al. at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
