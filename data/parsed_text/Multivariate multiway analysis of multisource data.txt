Motivation: Analysis of variance (ANOVA)-type methods are the default tool for the analysis of data with multiple covariates. These tools have been generalized to the multivariate analysis of high-throughput biological datasets, where the main challenge is the problem of small sample size and high dimensionality. However, the existing multi-way analysis methods are not designed for the currently increasingly important experiments where data is obtained from multiple sources. Common examples of such settings include integrated analysis of metabolic and gene expression profiles, or metabolic profiles from several tissues in our case, in a controlled multi-way experimental setup where disease status, medical treatment, gender and time-series are usual covariates. Results: We extend the applicability area of multivariate, multi-way ANOVA-type methods to multi-source cases by introducing a novel Bayesian model. The method is capable of finding covariate-related dependencies between the sources. It assumes the measurements consist of groups of similarly behaving variables, and estimates the multivariate covariate effects and their interaction effects for the discovered groups of variables. In particular, the method partitions the effects to those shared between the sources and to source-specific ones. The method is specifically designed for datasets with small sample sizes and high dimensionality. We apply the method to a lipidomics dataset from a lung cancer study with two-way experimental setup, where measurements from several tissues with mostly distinct lipids have been taken. The method is also directly applicable to gene expression and proteomics. Availability: An R-implementation is available at
INTRODUCTIONData from experiments with multiple covariates are usually analyzed with multi-way analysis of variance (ANOVA)-type methods. A typical one-way analysis setup in experiments looking for potential biomarkers for disease is the diseasedhealthy differential analysis. Biological experiments often contain additional covariates, such as drug treatment groups, gender or time-series, resulting in a multi-way experimental setup. The traditional methods for multi-way analysis are univariate multi-way ANOVA, and its multivariate generalization MANOVA. In the two-way case, to explain the covariate-related variation of the * To whom correspondence should be addressed. data in one data source, say x, the following linear model is usually assumed:Here the a and b (a = 0,...,A and b = 0,...,B) are the two independent covariates, and the main effects  x a and  x b and the interaction effect () x ab model the variation from the baseline level (grand mean)  x. The is a noise term. A recurring problem in 'omics' measurements, in particular in gene expression and metabolomics, is the small number of samples versus high dimensionality; the traditional multivariate methods break down due to the singularity of the covariance matrix. A further disadvantage of MANOVA is that it gives only a P-value describing the statistical significance of the effects, and the location (which variables) and direction (up/down) of the effects have to be deduced afterwards separately by other methods, such as t-tests. The latter holds for ANOVA as well. Dealing with the small sample size problem is currently an active research topic, and has already led to working solutions. Multi-way, multivariate ANOVA-type analysis can be done in the small sample size cases with simple two-step approaches relying on a prior principal component analysis (PCA) dimension reduction (). Another approach is forming sparse latent factors (), where some of the variables but not all are associated with each factor. In this approach, covariate information is used for factor regression and the model has been extended with univariate ANOVA models with a joint sparsity prior (). We have recently introduced a unified Bayesian machine learning model () especially designed for metabolomic experiments with a two-way setup and small sample size. This approach assumes similarly behaving correlated groups of variables, a valid assumption for metabolites, and models the multi-way covariate-related variation for the groups. The model is an extension of a factor analyzer and models the statistical significance of multivariate covariate effects on the low-dimensional factor space, representing the discovered clusters of variables. However, the multi-way data analysis problem becomes complicated when heterogeneous data with multiple covariates are integrated from multiple sources. Different data sources usually have distinct, unmatched variable spaces with different dimensionalities; this becomes evident when considering integration of transcriptomics and metabolomics data, or metabolic profiles from different tissues which usually have different metabolites. If the variable spaces were the same, one might want to consider the 'source' as an additional covariate in a standard ANOVA-type analysis. However, this is usually impossible since variable spacesPage: i392 i391i398
I.Huopaniemi et al.are in general distinct and unmatched, and covariate effects shared between the sources cannot be defined a priori. The desired goal would be to write a linear model for the sources x and y in the two-source, two-way case aswhere, in addition to the source-specific effects denoted by superscripts x and y , there are effects shared between the sources:  a ,  b and () ab. Unfortunately, since x and y have distinct variable spaces, a model including shared effects cannot be defined as simply as in Equation (2). It turns out that the problem is accessible under the additional assumption that the observations x and y from the two different sources come in pairs (co-occur). Then, we can include into the model an unknown functional mapping f x and f y from the shared effects to each source, and estimate it from data. The complete model readsThe model allows decomposing the effects to shared and sourcespecific ones, although they are in different variable spaces, which has not been possible with existing ANOVA-type methods. This article concentrates on the multivariate analysis of multi-way, multi-source datasets. The focus is on cases where two or more data sources have been measured from each biological sample (paired samples), but no a priori known matching of the variables in different sources needs to be assumed and sources can have different numbers of variables. No methods currently exist for the analysis of data from multiway, multi-source experimental setups. Since the focus of biological research has moved toward multi-source experiments, there is a need for multi-way, multi-source analysis methods. In order to connect different kinds of sources we need paired samples. Setups with paired samples are becoming increasingly relevant as experiments that use two or more measurement techniques for each patient, or study a set of tissues of each patient, are becoming more and more common. When for example a metabolomic and a gene expression (or proteomic) profile have been measured from each patient, the samples (profiles) of the two sources are paired, allowing for modeling of dependencies between them. A widely known classical statistical method for finding dependencies between datasets is canonical correlation analysis, for which there exist recent sparse variants (; Witten and). The CCA-type two-source analysis does not take covariate information into account and has therefore evolved as a separate field from ANOVA-type methods, although both are equally based on traditional multivariate statistics. In the CCA, there are at least two data-sources, x and y, with paired samples and distinct variable spaces, and the task is to find canonical latent variables in each source such that the dependency is maximized. The relationship ofMulti-way analysis studies datasets with two or more covariates for each sample. The task is to find the effects of the covariates in the data. (middle) Multi-source analysis studies dependencies between two or more datasets with paired samples without covariate information. (bottom) Multiway, multi-source analysis combines both tasks. The task is to find shared and source-specific covariate effects. In the data matrices, rows represent samples, and columns represent variables. these two analysis setups and our new task, multi-way, multi-source analysis, is illustrated in. An initial step for utilizing covariate information in multi-source analysis was taken in a sparse supervised CCA method (). The method can handle multi-source setups with one-way covariate information approximately by a simple two-step approach where a coarse dimension reduction for each data source is first performed by choosing variables with a high enough univariate correlation with the outcome variable, and then performing sparse CCA. Common data integration methods also include partial least squares-based classification () and regression () studies. It is very promising that integrating multiple sources has been shown () to increase classification accuracy compared to using a single source. Here, we extend from classification studies to actual latent effect models.
i392
Multivariate multi-way analysis of multi-source dataIn this article, we present a unified Bayesian machine learning method that can solve the multi-way, multi-source analysis task in a single model. The multiple sources with different variable spaces are integrated by an extended Bayesian CCA that solves the multi-way analysis in a space shared by the sources. The method solves the problem of high dimensionality and small sample size by finding groups of similarly behaving variables and estimating the main covariate effects and the interaction effects in a low-dimensional latent-variable space representing the clusters found. Furthermore, the method partitions these effects to shared effects between the sources and to source-specific effects. Correlations between the groups of variables between and within sources are detected as well. The method also finds groups of variables behaving similarly in each source, but not responding to the external covariates and determines whether they have a dependency shared between the sources. The method is specifically designed for small sample size, highdimensional datasets. Given the Bayesian treatment, a rigorous estimate for the uncertainty of the effects is inherently obtained. In addition to estimating the significance of the shared and sourcespecific multi-way effects, the method directly pinpoints (in contrast to MANOVA) which group(s) of features are up/downregulated. We demonstrate the method on simulated data, and show how it finds shared and source-specific two-way effects even with small sample sizes. We then apply the method on a lipidomics lung cancer dataset where lipidomic profiles have been measured from several tissues with mostly distinct lipids. In addition to the diseased healthy division, half of both populations have been given a test anticancer drug. The method is not restricted to metabolomics; it is generally applicable when the variables can be assumed to form mutually correlated groups, for instance in gene expression and proteomics.
METHODSWe formulate the new model for the multivariate analysis of multi-way, multi-source datasets under the so-called 'large p, small n' conditions (high dimensionality p, small number of observations n) as a hierarchical Bayesian machine learning model. To solve the modeling task, we need three components: (i) regularized dimension reduction, (ii) combination of different data sources, and (iii) multi-way analysis. Following the basic idea of hierarchical Bayesian modeling, these components are formulated as parts of an overall generative model that is assumed to have generated the observed data x and y. The model parameters are learned jointly with Gibbs sampling; the Gibbs-formulas are presented in Section 2.6. We will first summarize the main components of the model shown in, and then describe each part in detail. To deal with the small sample size (n p) problem, we reduce the dimensionality of the data x and y from the two sources into their respective latent variables x lat and y lat. This is done with factor analyzers (FA), which are additionally regularized by assuming that the variables come in groups and each group comes from one factor only. This is a strongly regularizing assumption effective for solving the 'large p, small n' problem. The clustering assumption is particularly sensible under the assumption that metabolomics data, our main application, contains strongly correlated groups of variables () associated to the same biochemical networks. The second necessary element is search for components shared by the two different sources x lat and y lat , needed for finding shared multi-way effects. Given paired data, this is a task for Bayesian CCA (BCCA;), which introduces a new hierarchy level where a latent variable z captures the shared variation between the sources.The third necessary element, the ANOVA-type multi-way analysis, is supplemented by assigning the effect terms describing the linear ANOVA model as priors on the latent variables z. The observed covariates a and b choose the correct effects for each sample. In effect, the model consists of two FA, where the loadings assume cluster memberships (multiplied with scales), a CCA-type generative model for combining the sources, and population-specific priors on z that assume ANOVA-type multi-way structure. The details of the model are now presented for the two-way, two-source case for simplicity of presentation; generalization to multiple 'ways' and sources is straightforward.
Dimension reduction by FADimension reduction is done by a FA (analogous to PCA), one for each source, x and y. Factor analysis assumes that the high-dimensional data spaces x and y have been generated by low-dimensional latent variable spaces x lat and x lat , respectively. To overcome the n p problem, the FA are regularized by clustering. We assume similarly behaving groups of variables and search for them in the Gibbs sampling. Each factor now represents one cluster of variables. All this is done in a single unified model.
Factor analysis modelThe factor analysis model () for n exchangeable replicates isHere V x is the projection matrix that is assumed to generate the data vector x j from the latent variable x lat j , whose elements are known as factor scores. The V x x lat j models such common variance of the data around the variable means  x that can be explained by factors common to all or many variables, effectively estimated based on the sample covariance matrix of the dataset. The sample covariance becomes decomposed intwhere x is a diagonal residual-variance matrix with diagonal elements
i393
I.Huopaniemi et al.At this point, when n < p, V x cannot be estimated due to the singularity of the sample covariance matrix. To overcome the n p problem, we now restrict V x to a non-singular clustering matrix, suitable for data containing groups of similarly behaving variables.
Projection matrix that assumes grouped variablesWe make the assumption that there are correlated groups of variables in the data, and restrict the projection matrix V x to a clustering-type of matrix, where each variable comes from exactly one factor. This means that in the model the generated values within the whole cluster are being governed by one latent variable. The projection matrix V x is positive-valued, each row having one non-zero element corresponding to the cluster assignment of the variable, multiplied by the variable-specific scale  i :The location of the only non-zero value,  i on row i, is denoted by v i. It follows a multinomial distribution with one observation, with an uninformative prior distribution  i. The  i could also be used to encode prior information on the known grouping of variables. The variation of each variable within a cluster is assumed to be modeled by the same latent variable, but the scales  i may differ. Estimating the  i is explained in Section 2.5. The variable-specific residual variances  2 i , that are the diagonal elements of x , follow a scaled Inv- 2 with an uninformative prior. The information in each high-dimensional sample is now represented by a low-dimensional latent variable corresponding to a vector of factor scores, one score for each cluster. The integration of the data sources including the decomposition into shared and source-specific effects is now done in the low-dimensional latent variable space.
Integrating the sources by Bayesian CCAWhen modeling dependencies between datasets, CCA searches the variation shared between the datasets and separates it from the dataset-specific variation. In the probabilistic Bayesian formulation of CCA (BCCA;), common variation is modelled by a latent variable z j common to both sources. Note that modelling dependencies by a shared low-dimensional latent variable z j for each sample j allows to correctly utilize the pairing information and model dependencies between the sources, crucial in integrating the data-sources. The z now model dependencies between the low-dimensional latent variable spaces x lat and y lat. The generative model of CCA has been formulated () for sample j asand likewise for y. Here, we have assumed no mean parameter since the mean of the data is estimated in the factor analysis part. The W x is a projection matrix from the latent variables z j , and x is a matrix of marginal variances. The crucial thing is that the latent variables z are shared between the two datasets, while everything else is independent. The prior distributions for the Bayesian CCA were chosen () asHere, w l denotes the lth column of W, and IG and IW are shorthand notations for the inverse Gamma and inverse Wishart distributions. The priorsfor the covariance matrices x and y are conventional conjugate priors, and the prior for the projection matrices is the so-called automatic relevance determination (ARD) prior used for example in Bayesian principal component analysis ().
Estimating the multivariate, two-way ANOVA-type effectsThe linear model for the two-way covariate effects is set on the shared latent variables z j , in order to have access to effects shared between both spaces x lat and y lat. In the K z-dimensional latent variable space we then havewhere  a and  b are the shared main effects, () ab is the shared interaction effect and j is a noise term. The effects are modeled as population priors on the latent variables, which in turn are given Gaussian priors  a ,  b , () ab  N (0,I). Note that the baselines (grand means)  x and  y are estimated in the lower level of hierarchy, that is, directly in the x and y spaces, and do not appear here. To simplify the interpretation of the effects we center the grand means to the mean of one control population. A similar choice of baseline has been done successfully in other ANOVA studies (), and it does not significantly sacrifice generality. We set the parameter vector  x , describing variable-specific means, to the mean of the control group. One group, denoted by (a,b) = (0,0), now becomes the baseline to which other classes are compared by adding main and interaction effects. Due to the new centering, the() a0 become zero and are not estimated. The differences between the populations are now modeled directly with x lat and y lat , and hierarchically by the mainIn our case study, the factors a (healthy diseased) and b (untreated treated) have only two levels and we have populations (a,b)), and there are hence three terms  1 (disease),  1 (treatment) and () 11 (interaction), that model the difference to the control population (a,b) = (0,0). The subscripts 1 and 11 will be dropped in the results section. In this case study, the healthy untreated is the natural choice for an intuitive control population.
Decomposition into shared and source-specific effectsThe decomposition of the effects into shared and source-specific effects is illustrated in.(6) be zero for the y-specific components and vice versa for x. In summary, the complete hierarchical model ofis
Data preprocessing and model complexity selectionFor simplicity and to reduce the number of parameters of the model, the data are preprocessed such that for each variable the mean of the control population (a = 0, b = 0) is subtracted and the variable is scaled by the SD of the control population. This fixes the scales  i to one and the  x and  y to zero. The factor analysis part now models correlations of the variables. The possible covariate effects are now comparable with the control population as discussed in Chapter 2.3. Model complexity, that is, the number of clusters and latent variables, is chosen separately for both x lat and y lat by predictive likelihood in 10-fold cross-validation as in).
Gibbs-formulasLet us index samples by j = 1,...,n, variables by i = 1,...,p, and clusters by k = 1,...,K. The Gibbs sampling formulas for the model are as follows:Here v lat j =and similarly for y. Here n a , n b and n ab denote the number of samples belonging to group a, b, and both a and b, respectively. Finally, the regularized projection matrix, or clustering matrix V x is sampled one row at time. The cluster assignment of variable i, v i , is the location of the non-zero scale parameter  i. The formula isSampling of the CCA-projection matrices is explained in Klami and Kaski (2007).
Study designThe sample series corresponds to 28 mice divided into four groups. For the two tumor-bearing groups, Lewis lung cancer cell suspension containing 8106 cells in 0.2 ml saline was injected subcutaneously. The other two groups were non-tumor bearing normal mice. Twenty-four hours after tumor inoculation, 100 mg/kg/d Rh2 in 0.5% sodium carboxymethyl cellulose (CMC-Na) was given by gavage to one tumor-bearing group (TR, diseased treated) and one non-tumor bearing group (NR, healthy treated). The other two groups were given blank CMC-Na as controls, they are named group NS for healthy-untreated and TS diseased-untreated for non-tumor bearing and tumor-bearing groups, respectively. Both Rh2 and CMC-Na groups were treated daily for 21 days. By the end of experiment, blood was collected from the orbital sinus and animals were killed by cervical dislocation. The brain, heart, lung, liver, spleen, thymus and tumor were collected and frozen in liquid nitrogen immediately. Samples were analyzed by ultra performance liquid chromatography (UPLC)/Mass Spectrometry (MS) as described previously (), and the raw data was preprocessed by MZmine (). Lipids were then identified according to RT and m/z values, resulting in 168 lipids in blood plasma, 68 in lung and 58 in heart.
RESULTSWe first demonstrate the functioning of the method on simulated data, focusing on how the generated effects are found when the sample size is small. We then apply the method to a lung cancer study where lipidomic profiles have been measured from several tissues of model mouse samples, under a two-way experimental setup (disease and treatment). Different tissues have distinct lipids. Finally, the method is compared with a standard (one-source) MANOVA-approach including dimension reduction with PCA.
Simulated dataWe generate data having known effects, and then study how well the model finds the effects as a function of the number of measurements. There are three generated effects, in ,  y and () x. Each of the three effects has strength +2, the x lat and y lat are both 3D, and the x and y are 200D. The marginal covariance matrices x and y have diagonal variance of magnitude 5 and off-diagonal covariance of magnitude 4. The  i = 1 for each variable i in x and y, and p(. Three components are estimated, one shared and two source-specific components. The model is computed by Gibbs sampling, discarding 1000 burn-in samples, and collecting 1000 samples for inference. To fix the sign of the effects without affecting the results, each posterior distribution is mirrored, if necessary, to have a positive mean, i.e. multiplied by the sign of the posterior mean.The method finds the three generated effects, shown with black boxes in. The uncertainty decreases with increasing number of observations. Note that the shared effect is found with much less uncertainty since there is evidence from both sources. With low numbers of samples, there is considerable uncertainty in the effects for source-specific components, which can be interpreted as follows: with such a low number of samples, there is not enough evidence for the effect. In typical bioinformatics applications there may be 2050 samples. The model also found the correct clusters of variables (data not shown).
i395
I.Huopaniemi et al.
Lung cancer studyWe then study data from a two-way, two-source, n p, so far unpublished lung cancer mouse model experiment. The diseased mice are compared with healthy control samples and, in addition, some mice from both groups have been given a test anticancer drug treatment. There are thus healthy untreated (n = 9 mice), diseased untreated (n = 7), healthy treated (n = 6) and diseased treated (n = 6) samples. Lipidomic profiles have been measured by UPLC/MS. The study has a two-way experimental setup, such that the disease effect , treatment effect  and an interaction effect () on lipid groups are to be estimated. The high-dimensional lipidomic profiles have been measured from several tissues of each mouse; the tissues have partly different lipids that have not been matched, and even the roles of the matched lipids may be different in different tissues. Hence, the tissues have different feature spaces with paired samples, implying a two-source study. We specifically focused on the relationship between blood and lung tissue profiles. This is particularly relevant for drug efficacy and safety studies in non-clinical and particularly in clinical studies, given that plasma samples can be easily collected in such investigations.
Experiment 1: effects shared by blood and disease tissueBlood plasma (168 lipids) and lung tissue (68 lipids) were integrated with the method. The optimal number of clusters for plasma was six and for lung five, found based on predictive likelihood.. In Experiment 1 (left), the method finds a disease effect  and a treatment effect  shared between the two sources, plasma (x) and lung (y) tissues. In Experiment 2 (right), the method finds only source-specific effects in plasma (x) when integrating with the heart tissue (y). No effects are found in heart. The boxplots show quartiles and 95% intervals of posterior mass of the effects; a consistently non-zero posterior distribution implies an effect is found.Three components are learned, one shared and two source-specific. The method finds (, left) a disease effect  and treatment effect  shared by both sources; the shared interaction effect is close but not significant (95% confidence). The results imply that a cluster of 12 lipids in lung and a cluster of 20 lipids in blood are mutually coherently upregulated due to disease, and additionally upregulated by the treatment. Another cluster of 13 lipids in lung was found to be downregulated due to the disease and additionally downregulated due to treatment. The lipids of the downregulated cluster are thus negatively correlated with the upregulated clusters. The results indicate that there might be a shared interaction effect () with opposite direction, that might indicate a cure for the disease. However, the effect is not significant using the common 95% rule. The 28 samples used in the analysis thus do not give enough evidence for this effect being consistent, and there is no confirmation that the treatment would cure the cancer effects. This confirms our prior concern that the specific treatment might not be efficient. The treatment does, however, affect the same groups of lipids as the disease, so investigating it as a potential cure was not a far-fetched hypothesis. The effects are traced back to the metabolite groups, by first identifying the responsible row of W x and hence component of x lat , and then the lipid cluster from the V x corresponding to the x lat component. The upregulated cluster of plasma contains abundant triacylglycerols known to be coregulated (), the upregulated cluster of lung contains lipotoxic ceramides () and proinflammatory lysophosphatidylcholines (), while the downregulated cluster of lung contains ether lipids, known as endogenous antioxidants (). Our analysis reveals that the drug treatment enhances, not diminishes, the proinflammatory lipid profile found in the disease. Our findings thus indicate that the tissue-specific changes due to cancer can be monitored by specific plasma lipids. Clearly more studies are needed to establish a mechanistic link between the plasma triacylglycerols and the observed inflammatory changes in the lung.
Experiment 2: when integrated with a non-diseased tissue, only source-specific effects are foundWe then integrate plasma x with another tissue, heart (58 lipids) y. The results in(right), show that the disease effect and the treatment effect are found only i396in the source-specific component of plasma. This implies that there is no evidence of shared effects between plasma and heart, and in fact no consistent effects are found for the heart tissue. The method finds, however, the same effects, disease  and treatment  in the plasma as in Experiment 1 and for the same cluster of lipids, which signifies that the method works well. In summary, Experiments 1 and 2 combined provide strong evidence towards the validity of the model: shared effects were found between tissues having a functional link (plasma and tissue containing tumor), whereas no link was found when there was a more remote functional link (between plasma and some other tissue). Then disease effects were only found in plasma. The specific found effects need to be studied further.
Multivariate multi-way analysis of multi-source data
Comparison to existing ANOVA-type methodsNo earlier multi-way ANOVA-type method can be properly used to analyze data from multi-way, multi-source experiments; they do not allow access to shared multi-way effects and therefore cannot be used for decomposing covariate effects into shared and sourcespecific ones. Three imperfect workarounds are possible, presented below in the two-way, two-source case:(1) Separate single-source two-way analysis for each source.(2) Concatenation of the datavectors x and y from the different sources to a longer vector, followed by a single-source two-way MANOVA (with PCA dimension reduction). Such standard MANOVA naturally cannot separate the sourcespecific effects from the shared ones at all.(3) In the rare special case, where the variables between the sources x and y have the same dimensionality and the variables of the two sources have a full, a priori known matching, a naive alternative is to ignore the pairing and consider the source as a covariate in a three-way MANOVA, as in Equation 2. This is not possible in our case study since variable spaces are different. We compare our method to concatenating the sources and performing a two-way 50-50 MANOVA (), MANOVA based on a PCA-dimension reduction, with the real lipidomics data and with simulated data.
Comparison with real lipidomics dataThe lipidomic dataset, with results presented in, was analyzed by concatenating the two data sources and performing 5050 MANOVA. The results inpoint out several interesting differences to the results obtained with our proposed method (). First, the
P-values ofthe covariate effects are given to the overall contatenated sources, and the method has no means of differentiating shared and source-specific components. Single-source or univariate analyses would need to be done for the specific components, but they would lose the access to dependencies between the sources and therefore to the shared effects. Second, as a result of using the unoptimal PCA-dimension reduction, only the disease effect  is found in each experiment, and the treatment effect  is not found. This demonstrates the superior behavior of the multi-way, multi-source analysis method that includes a dimension reduction as an integrated clustering of similarly behaving variables. Third, MANOVA gives only a P-value, and the locations (which variables) and direction (up/down) of the effects have to be deduced by other methods, such as univariate ANOVA and t-tests.
Comparison with simulated dataWe compare the simulated data presented inwith 5050 MANOVA analysis with concatenated data sources as a function of sample size. The confidences for the effects, shown as distributions in, are converted to a numerical confidence value comparable with the P-values given by MANOVA; a distribution above or below zero with 95% confidence is considered significant. In addition, the decomposition to shared and source-specific effects is ignored since MANOVA is unable to perform it. The comparison results are shown in. The proposed method outperforms MANOVA, especially with small sample sizes, which is the case of interest. The proposed method finds the main effects with 32 samples and the interaction effect with 64 samples, whereas the comparison method needs 256 samples to reliably find all the effects from the data.
DISCUSSIONWe have generalized ANOVA-type multi-way analysis to cases where measurements from multiple sources are available for samples having a multi-way experimental setup. Furthermore, the method is able to decompose the covariate effects to shared and sourcespecific effects, unlike any existing methods. The problem is solved by a hierarchical latent variable model that extends the generative model of Bayesian CCA to model multi-way covariate information of samples, by assigning population-specific priors on the shared latent variable of CCA. The method is designed for cases with high dimensionality and small sample size, common in bioinformatics applications.
i397
I.Huopaniemi et al.The small sample size problem was solved by assuming that the variables come in similarly behaving groups, which is reasonable for the 'omics' applications such as metabolomics in this article. An alternative approach could be using sparse approaches, for instance L 1-regularization or point-mass mixture priors (), in applications where the clustering assumption is unrealistic. The modeling task is extremely difficult due to the complexity of the task and small sample size. Hence, it was striking that the method was capable of finding covariate effects in a real-world lipidomic multi-way, multi-source dataset. In practice, the model is applicable for finding disease-or other covariate-related effects across multiple paired measurements, from different sources having different variables, which is an increasingly common and important data-analysis task. The key assumption needed for connecting different types of measurements is sample pairing, which allows formulating shared latent variables between the sources. The study on lung cancer showed that the model is capable of separating effects shared by the sources from effects in one source only. When integrating metabolic profiles from two tissues (blood and lung) which both had disease and treatment effects, the model was able to model these effects as shared disease and treatment effects, establishing a covariate-related dependency between the tissues. When the same blood tissue was integrated with heart tissue not expected to show disease or treatment effects, the method found no significant shared effects but modeled the effects in blood as sourcespecific disease and treatment effects. This result provides evidence in support of the method and its modeling assumptions. In the case of simulated data, the generated shared and sourcespecific covariate effects were found with relatively small sample sizes, clearly outperforming the alternative MANOVA approach. The shared effect was found already with considerably smaller number of samples, since there is evidence from both sources. For simplicity, the method was presented in the two-way, twosource case. Generalization to multiple 'ways' is straightforward by adding more main and interaction terms to Equation 8, and to multiple sources by adding sources (x,y,...) to Equation 6. Both generalizations have been tested with simulated data (details not reported here) where effects were found equally well. Finally, the method is not restricted to metabolomics; it is generally applicable to other data types and especially well suited for combinations of heterogeneous data sources, whenever the variables can be assumed to form similarly behaving functional groups, such as in gene expression and proteomics. As more and more biological multi-source datasets with paired samples integrating data from different measurement techniques and/or tissues are becoming available, we expect the method to find wide applicability.
at :: on August 31, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
at :: on August 31, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from [12:19 12/5/2010 Bioinformatics-btq174.tex] Page: i397 i391i398
i398 at :: on August 31, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
