Motivation: Accurate inference of genealogical relationships between pairs of individuals is paramount in association studies, forensics and evolutionary analyses of wildlife populations. Current methods for relationship inference consider only a small set of close relationships and have limited to no power to distinguish between relationships with the same number of meioses separating the individuals under consideration (e.g. aunt–niece versus niece–aunt or first cousins versus great aunt–niece). Results: We present CARROT (ClAssification of Relationships with ROTations), a novel framework for relationship inference that leverages linkage information to differentiate between rotated relationships, that is, between relationships with the same number of common ancestors and the same number of meioses separating the individuals under consideration. We demonstrate that CARROT clearly outperforms existing methods on simulated data. We also applied CARROT on four populations from Phase III of the HapMap Project and detected previously unreported pairs of third-and fourth-degree relatives. Availability: Source code for CARROT is freely available at
INTRODUCTIONAlgorithms for relationship inference can greatly benefit association and linkage studies by detecting undeclared or misspecified relatives, and have applications in forensics and wildlife population management. Existing methods () based on Hidden Markov Models (HMMs) only consider a small number of relationship types. RELPAIR () examines eight types of relationships (full siblings, parentchild, avuncular, grandparent grandchild, half siblings, first cousins, monozygotic twins, and unrelated). PREST-plus () extends this set of alternative relationships to include the relationship types half avuncular, half first cousins and half-siblings first-cousins. Algorithms for pedigree reconstruction () partition the individuals into sets of sibling and parentchild pairs () and are not designed for datasets containing distantly related individuals. Additionally, the methods mentioned above cannot differentiate between rotated * To whom correspondence should be addressed.  The authors wish it to be known that, in their opinion, the first three authors should be regarded as joint First Authors. relationships, that is, between relationships with the same number of common ancestors and the same number of meioses separating the individuals under consideration (e.g. auntniece versus nieceaunt or first cousins versus great auntniece). Distinguishing between such relationships facilitates pedigree reconstruction from relatively distant relationships. We developed CARROT (ClAssification of Relationships with ROTations), a new framework for relationship inference that leverages linkage information to differentiate between rotated relationships. As suggested by, we grouped relationships between outbred individuals into three categories, based on whether the individuals under consideration have one or two common ancestors or whether one of them is the ancestor of the other. Building on the ideas of, we defined three sets of HMMs, one for each category of relationships. CARROT uses a novel heuristic to decide whether one of the two individuals under consideration is closer to the common ancestors than the other and benefits from haplotype phasing in order to distinguish between certain rotated relationships. We demonstrated that CARROT achieves higher accuracy than maximum-likelihood approaches, such as RELPAIR and PRESTplus, using simulated data. We also applied CARROT on real data from Phase III of the HapMap Project (). In addition to validating relationships reported by, we identified previously unreported third-and fourth-degree relationships in this dataset.
METHODS
Overview of CARROTCARROT is a framework for predicting the relationship type for a pair of individuals from their genotypes. Similarly to previous work (), CARROT uses HMMs to compute the likelihood of the genotype data under a set of alternative relationships. Unlike existing methods, which define a different HMM for each relationship type, CARROT defines three HMM templates from which it generates HMMs for a broad range of relationships. CARROT uses the likelihoods computed by all alternative models as features of a classifier together with additional features that quantify the overall genetic sharing between the two individuals. In this work, we use the term Identity By Descent or Identical By Descent (IBD) to refer to genomic regions inherited from the Most Recent Common Ancestors (MRCAs) of the two individuals. The additional features we consider are the percentage of IBD, the number of transitions between IBD and non-IBD regions and the haplo-frequencies of the two individuals in these regions. Roughly speaking, the haplo-frequency of an individual A in a given genomic region is the
S.Kyriazopoulou-Panagiotopoulou et al.fraction of the reference population that has the same haplotype as A in that region. The use of phased data enables CARROT to assign different likelihoods to relationships that are indistinguishable by previous methods: in the case of an auntniece pair, for instance, segments inherited from the common ancestors can lie on either haplotype of the aunt, but must lie on the same haplotype of the niece. This haplotype model, combined with linkage information captured in the haplo-frequencies, gives CARROT a significant advantage in differentiating between rotated relationships compared with the existing methods.
HMMs and factorial HMMsA HMM is a probabilistic model for capturing the dependencies of a sequence of observations G 1 ,G 2 ,...,G M on a chain of unknown (or hidden) variables S 1 ,S 2 ,...,S M taken from a set S. An HMM makes the following conditional independence assumptions: first, given S k , G k is conditionally independent of all observations and hidden states, that isis conditionally independent of all previous hidden states, that is,). An HMM is, therefore, defined by a set of transition probabilities P(S k |S k1 ), a set of emission probabilities P(G k |S k ) a probability distribution over the initial states. Often, we want to infer the value of the hidden variables from the observed variables. The posterior probability P(S i |G) can be computed using the forwardbackward algorithm in time O(M|S| 2 ) (), where |S| is the number of values in S. In a factorial HMM (), the observation at position k depends on multiple hidden variables, S 1 k ,S 2 k ,...,S T k , which are assumed to evolve independently, that is:A factorial HMM where each hidden variable S t k takes values from the set S is equivalent to an HMM with hidden variables taking values from the Cartesian product S T. Using the latter representation, running the forwardbackward algorithm on a factorial HMM requires O(M|S| 2T ) time. However, by taking advantage of the independence assumptions for the hidden variables, the forwardbackward algorithm can be modified to run in O(MT |S| T +1 ) time, which is a significant improvement when the number of hidden variables T is large.
Likelihood computation assuming linkage equilibriumWe want to infer the relationship between two individuals A and B, genotyped at a set ofbe the two haplotypes of A and B, respectively,be their ordered, or phased, genotypes, and  k be the probability of recombination between SNPs k and k +1. Throughout this work, we assume that  k is the same for both sexes. Let R be a set of putative relationships for individuals A and B. For any relationship R  R, we want to compute the likelihood of R, or the probability of the observed genotypes under the assumption that the true relationship between A and B is R, L R = P(G A ,G B |R). As noted in, assuming that A and B are not inbred, their relationship must fall into exactly one of the following categories:(1) A and B share exactly 2 MRCAs (e.g. full siblings, first cousins);(2) A and B share exactly 1 MRCA (e.g. half siblings, half cousins); and(3) A is the ancestor of B or vice versa.We call relationships R 1 and R 2 rotated, if R 1 and R 2 are in the same relationship category and the total number of meioses between the twoindividuals is the same in R 1 and R 2. Alternatively, we say that R 1 is a rotation of R 2. We defined a set of HMMs for each of three relationship categories similarly to, who defined HMMs for cousins parameterized by the number of generations between them. Unlike these methods, the state space of our models does not increase with the number of generations of the pedigree. Below, we describe our HMMs for the first type of relationships. The models for the other two cases are derived along similar lines. Given that A and B have two MRCAs, C and D (), the hidden state at SNP k depends on the following binary variables:(= 1, we will say that there were off-chain donations in the lineage of A at position k. d B (k) is defined in an analogous way for the lineage of B.(4) p A (k) indicates which of the alleles of A, H A0 (k) or H A1 (k), comes from E gen A and is used to capture phasing errors. p B (k) is defined in an analogous way. Each of these variables refers to a different set of meioses in the pedigree, therefore they all evolve independently from each other. We thus model the process of generating the genotypes G A and G B as a factorial HMM with hidden state s(k)
i334
Relationship reconstructionis the probability that a variable transitions from state i at SNP k to state j at SNP k +1, gen A and gen B are the generations between the MRCAs and each of A and B (),  k is the recombination probability between SNPs k and k +1; and  is the probability of a phasing error.The transition probabilities for all the variables are shown in. We now derive the transition probabilities for d A. Let gen A be the number of generations between the MRCAs and A (). The number of meioses between E 2 and A is gen A 1. Assume that d A (k) = 0, that is, the allele that E 2 inherited from the MRCAs at locus k was passed down to A. Any recombination between loci k and k +1 would result in
The transition probabilities for the variables, then there exists at least one off-chain donation in the gen A 1 meioses between E 2 and A. The probability that there are exactly n off-chain donations between E 2 and A is gen A 1 n (1/2) gen A 1. Given that there are exactly n off-chain donations at SNP k, the probability that there are no off-chain donations at SNP k +1 is  n k (1 k ) gen A 1n. Therefore:Given s(k), we can determine the IBD status at SNP k and use population allele frequencies to compute the emission probabilities (). To account for genotyping errors, let be the probability of a genotyping error, and f (x,y) be the probability that allele x is genotyped as y:Then:where q c is the frequency of allele c in the reference population. The rest of the emission probabilities are adjusted in a similar way.
Relationship notationWe refer to relationship types using the notation (mrcas,gen A ,gen B ). The variable mrcas is 2 when individuals A and B share two MRCAs and 1 otherwise. Unless A is the ancestor of B or vice versa, gen A and gen B are the number of generations between the MRCA(s) and A and B, respectively. If A is the ancestor of B, then gen A is set to 1, and gen B is the number of generations between A and B. For close relationships, we prefer to use the usual verbal description, unless space is limited.shows the numerical notation for some common relationships.For all relationships with gen A = gen B , there is a corresponding symmetric relationship, for example (1, 0, 1) denotes a childparent pair. Note that the term 'avuncular' does not specify a direction. The terms 'aunt' and 'niece' should be read as 'aunt/uncle' and 'niece/nephew', respectively.
Incorporating linkage informationHMMs that use unlinked markers have limited power to distinguish between relationships of the same degree (). Linkage information can help disambiguate such relationships. Assume, for instance, that we want to determine whether the relationship between individuals A and B is first cousins or great auntniece. An IBD block between A and B implies that they inherited overlapping genomic segments from their MRCAs (). If A and B are first cousins, the two scenarios ofare equally likely. However, if A is closer to the MRCAs than B, then it is more likely that A inherited a larger segment from the common ancestor than B [scenario (a)], because we expect fewer recombinations between the MRCAs and A than between the MRCAs and B. Therefore, if we compare the haplotypes of A and B in a small window around the IBD transitions to the haplotypes of a reference population, we are more likely to find a match for the haplotype of A, than for the haplotype of B.To quantify this intuition, assume that there is a transition in IBD status between SNPs k and k +1, and let H i (k w+1..k +w) be the haplotype of individual i at positions k w+1,k w+2,...,k +w, that is in a window of size 2w around k. The haplo-frequency of A is defined as:where the sum is over all haplotypes in the reference population, N is the number of such haplotypes, and f (H i (k w+1..k +w),H A (k  w+1..k +w)) is the probability that H i (k w+1..k +w) is genotyped asThe overlapping part of the blue haplotypes is IBD in the two individuals. The first scenario is more likely if A is closer to the MRCA than B. H A (k w+1..k +w):
i335
S.Kyriazopoulou-Panagiotopoulou et al.The positions of transitions in IBD status are estimated from the posterior probabilities of IBD of the HMMs using two cutoffs, c ibd and c nonibd. Positions with posterior probability for IBD larger than c ibd are called IBD, while positions with posterior probability lower than c nonibd are called non-IBD. If position k is IBD, position is non-IBD, and positions k +1....1 have IBD probabilities between c ibd and c nonibd , then we consider k w+1...+w1 as the transition window.
Classifying relationshipsExisting methods for relationship inference () use HMMs to compute the likelihood of the observed genotypes under a set of alternative relationships and then select the relationship that maximizes that likelihood. As explained in Section 2.5 and demonstrated in the Section 3, the likelihoods assuming unlinked markers have limited power to distinguish between relationships of the same degree.To overcome this problem, we used simulated data to train a multiclass discriminant analysis model with the following features:(1) the likelihoods of all the alternative models;(2) the total number of transitions between IBD and non-IBD;(3) the estimate of the IBD sharing,are the posterior probabilities of sharing one and two alleles IBD at SNP k, respectively, and the sum is taken over all M SNPs; and(4) the percentage r of transitions between IBD and non-IBD in which C A < C B , where C A and C B are the haplo-frequencies of A and B, respectively. As explained in Section 2.5, when A and B are equally distant from their common ancestors, r is expected to be 0.5. A value of r much larger than 0.5 indicates that C A tends to be smaller than C B , so A is more distant from the common ancestors than B. Similarly, a value of r much smaller than 0.5 indicates that B is more distant from the common ancestors than A.
SimulationsPhased genotypes of 165 individuals from UT, USA, with ancestry from northern and western Europe (CEU) and 88 Tuscans (TSI) were obtained from release 2 of Phase III of the HapMap Project. Some individuals in the CEU population were connected in parentchild pairs. We removed the offspring of all these pairs and combined the remaining 113 CEU individuals with the TSI individuals. After removing SNPs with minor allele frequency smaller than 1% in the combined CEU-TSI population, we obtained a set of 1 133 686 SNPs, which we call the linked set of SNPs. SNPs in the linked set that were in linkage disequilibrium (LD) were removed using the variance inflation factor method implemented in PLINK, version 1.07, () to obtain an unlinked set of 79 681 SNPs. The HMMs were run on the unlinked set, while the haplo-frequencies were computed from the linked set. The 201 individuals were divided randomly into two subgroups, T sim , containing 57 CEU and 44 TSI individuals and T ref , containing 56 CEU and 44 TSI individuals. T sim was used to simulate pedigrees, while T ref was used as a reference population, to compute allele and haplotype frequencies. Only autosomes were simulated. Following Haldane's model of recombination (), we set the recombination probability between SNPs k and k +1 to 1e 2g k /2, where g k is the genetic distance between the SNPs.Genetic maps were obtained from the HapMap Project. The genotyping error was set to 0.9%. The window w for the computation of the haplo-frequencies was set to 20, and the cutoffs, c ibd and c nonibd , were set to 0.9 and 0.2, respectively. These values were chosen based on the accuracy of capturing the IBD transitions on a set of simulated individuals distinct from the training and testing sets.
Comparison with RELPAIR and PREST-plusWe compared our method to RELPAIR, version 2.0.1 () and PREST-plus, version 4.09 () on simulated individuals created as described in Section 2.7. PREST-plus was run on the same 79 681 unlinked SNPs that was used to run CARROT's HMMs. RELPAIR cannot handle more than 9999 markers, so, similarly to, we ran it on 5 random subsets of the unlinked SNPs of size 9961 SNPs each. Each subset was created by dividing the 79 681 SNPs into non-overlapping windows of size 8, and then randomly selecting one SNP from each window. The prediction of RELPAIR for a given pair of individuals was set to the relationship predicted in the majority of the five runs.
Inference of relationships in Phase III of HapMapPhased genotypes of 83 individuals of African ancestry from the southwestern USA (ASW), 165 CEU individuals, 171 individuals of Mexican ancestry from Los Angeles, CA, USA (MXL) and 167 Yoruba individuals from Ibadan, Nigeria (YRI) were obtained from release 2 of Phase III of HapMap. We inferred relationships in each population separately, since, according tothere is no evidence for populationlabeling errors. For each population, we removed SNPs with minor allele frequency smaller than 1%, SNPs in LD, as well as SNPs that failed the hypothesis test of HardyWeinberg equilibrium [P < 10 4 , computed by PLINK, version 1.07 (, and created linked and unlinked sets as described in Section 2.7. To reduce computation time, we first obtained a rough estimate of the IBD sharing by running the HMM for full siblings for all pairs in each population. Pairs with predicted IBD percentage less than 3% were removed from further consideration. This threshold was selected to exclude most of the fifth-degree relatives, since the accuracy of our method is small in such cases. It is possible that some of the fourth-degree relatives were also excluded during this process. We note, however, that the goal of this analysis was not to exhaustively identify all the relationships in the populations studied, but rather to demonstrate the applicability of our method on a real dataset. For the pairs that passed the above cutoff, we ran our HMMs for all relationships of degree up to 5, using previously reported unrelated individuals of the corresponding population to compute allele and haplotype frequencies. The phasing error parameter , was set to 0.1%. To infer the relationships of these pairs, we trained our classifiers on 100 pairsPage: i337 i333i341
i336
Relationship reconstructionof individuals for each relationship of degree up to 5 and 100 unrelated individuals, simulated as described in Section 2.7. We verified our predictions for the first-and second-degree relationships by comparing them with the relationships reported in HapMap and the predictions of. To verify our predictions for relationships of higher degree, we detected sets of three or more individuals that were all predicted to be related to each other and examined whether our predictions for these individuals were mutually consistent. We were very conservative in our verification process, reporting newly discovered thirdand fourth-degree relationships as verified only if they had strong support from relationships of smaller degrees. Pedigrees were drawn using HaploPainter, version 1.043 ().
RESULTS
Results on simulated dataComparison with maximum-likelihood methods: we compared CARROT with two existing methods for relationship inference, RELPAIR () and PREST-plus (). Both these methods use HMMs similar to those defined in Section 2.3 to compute the likelihoods of a set of alternative relationships and select the relationship within the set with the maximum likelihood. RELPAIR only considers the relationships such as full siblings, parentchild, avuncular, grandparentgrandchild, half siblings, first cousins, monozygotic twins and unrelated. PREST-plus considers the relationships examined by RELPAIR as well as the relationships half avuncular, half first cousins and half-siblings-first-cousinsfor the definition of that relationship]. Neither RELPAIR nor PRESTplus differentiate between rotated relationships, so for example they do not distinguish between a grandparentgrandchild pair and a grandchildgrandparent pair. We first compared CARROT, RELPAIR and PREST-plus on the set of relationships that can be handled by RELPAIR, except twins, which are not considered by CARROT. We simulated 100 pairs of phased individuals for each of the relationships full siblings, parentchild, aunt/uncleniece/nephew, grandparentgrandchild, half siblings, first cousins and unrelated. We ran RELPAIR and PREST-plus on all pairs using the seven aforementioned alternative relationships. The performance of CARROT was assessed using 10-fold cross-validation: The simulated pairs were divided into 10 subsets each containing 10 pairs from each relationship. CARROT was trained on 9 of the subsets, that is, on 90 pairs from each relationship, and tested on the remaining subset. This process was repeated 10 times and the accuracy was averaged over the 10 runs.shows the number of pairs that were predicted incorrectly by each method. Although all three methods achieved excellent accuracy for the first-degree relationships, CARROT clearly outperformed both RELPAIR and PREST-plus on second degree pairs, particularly on half siblings. RELPAIR and PRESTplus classified more than half (56 and 68%, respectively) of the half sibling pairs as avuncular. We note that the difference in performance between RELPAIR and PREST-plus can probably be attributed to the fact that RELPAIR was run on smaller sets of SNPs (see Section 2.8). We also compared CARROT with PREST-plus on the set of nine relationships which includes the seven relationships above as well as half avuncular and half first cousins. As shown in, CARROT outperformed PREST-plus for most relationships as well as onaverage. The only relationship for which CARROT performed worse than PREST-plus was first cousins: 13% of the first cousins pairs were classified as half avuncular by CARROT, probably because the haplo-frequencies of these two relationships are similar. As mentioned above, RELPAIR and PREST-plus use HMMs to compute the likelihoods of a set of alternative relationships and select the relationship with the maximum likelihood. However, i337direct comparison between these methods and CARROT can only be done for a small set of relationships. To extend this comparison to additional relationships, we implemented a classifier that uses the HMMs of Section 2.3 for the likelihood computation and then selects the relationship with the maximum likelihood. This classifier can serve as a proxy for any method that maximizes the likelihood of unlinked markers. We compared the maximumlikelihood classifier with CARROT using a set of 100 simulated pairs of phased individuals for each relationship of degree up to five, including all rotated relationships. We assumed that the degree of the relationship was known, so predictions were made only within each degree. To assess whether a classification-based approach is better that a maximum-likelihood approach, we also ran CARROT using only the likelihoods as features. We observed that for relationships of degree up to two, the likelihoods are sufficient to differentiate between relationships (). For higher degrees, the likelihoods become less informative and the additional features of CARROT result in a significant increase in accuracy. Additionally, we notice that CARROT performs consistently better than the maximumlikelihood approach, even when we only use the likelihoods as features. Intuitively, the classifier can capture correlations between the likelihoods of different relationships. We observed, for instance, that when the true relationship is great grandparentgrandchild, the likelihood of the relationship great aunt/niece tends to be increased, but this effect is overlooked when we use the maximum likelihood criterion. Differentiating between rotated relationships: to evaluate the ability of CARROT to distinguish between rotations of relationships, we simulated 100 pairs of individuals for each of the possible relationships of degree up to five, including all possible rotated relationships. We first assumed that the degree of each relationship was known, and ran CARROT separately for each degree. We started by examining the ideal case of perfect phasing, so we set the probability of phasing errors, , to zero. We assessed CARROT's accuracy using 10-fold cross-validation, as described in the previous section: the simulated pairs were divided into 10 subsets each containing 10 pairs from each relationship. CARROT was trained on nine of the subsets and tested on the remaining subset. This process was repeated 10 times and the accuracy was averaged over all 10 runs. We defined the prediction accuracy as the number of pairs that were classified in the correct relationship.
S.Kyriazopoulou-Panagiotopoulou et al.The value at row i and column j is the percentage of pairs of relationship i that were predicted to be of relationship j. (2, 0, 2): great auntniece; (2, 1, 1): first cousins; (2, 2, 0): great nieceaunt; (1, 1, 2): great grandparentgrandchild, (1, 0, 1): half auntniece; (1, 1, 0): great nieceaunt; (1, 2, 1): great grandchildgrandparent.When run on first-and second-degree relatives, CARROT achieved perfect performance. The results for the third-and fourthdegree relationships are summarized in Tables 4 and 5, respectively. The average accuracy over all the pairs of the corresponding degree, was 83.86 and 56.89%, respectively. For the fifth-degree relationships, the average accuracy was 34.45% (full results not shown). As expected, the accuracy of our classifiers drops as the degree of the relationship increases. However, even within the same degree, some relationships are much harder to predict correctly than others. For example, the two half-avuncular relationships, (1, 0, 1) and (1, 1, 0), are hard to differentiate from each other and from first cousins, since the difference in the distance of each of the individuals from their MRCA is not enough for the haplofrequencies to distinguish them from a balanced relationship where both individuals are equally distant from the MRCAs. Similarly, although the average accuracy for the fifth-degree relationships was 34.45%, the (2, 4, 0) and (2, 0, 4) pairs were predicted correctly in 48.5% of the cases.
Predictions across degrees: sincein practice the degree of the relationship is not necessarily known, we also performed cross validation on a set of 200 pairs of individuals from each of the relationships of degree up to 5, including rotated relationships, as well as 200 pairs of unrelated individuals. The average classification accuracy was 57.5%, varying widely for different degrees: all the first-degree pairs were classified correctly; the average accuracy for the second-degree pairs was 99.5%, for the third-degree pairs 76.57%, for the fourth-degree pairs 46% and for the fifth-degree pairs 23.36%. Finally, 90% of the unrelated individuals were classified correctly. We note that there was a small decrease in accuracy compared with the results of the previous section, because some of the pairs were classified in relationships of the incorrect degree, while this was never the case when only within-degree predictions were made.shows the percentage of pairs that were classified in a relationship of the correct degree for each of the degrees examined. On average, the correct degree was predicted for 89.83% of the pairs.Page: i339 i333i341The value at row i and column j is the percentage of pairs of relationship i that were predicted to be of relationship j.The value in row i and column j is the percentage of pairs of degree i that were classified in a relationship of degree j.
Relationship reconstructionrelationships, introduced phasing errors at various rates in the range 01% and performed 10-fold cross-validation, as described above. We observed that, as the phasing error increased from 0% to 1%, there was an almost linear decrease in classification accuracy from 84% to 67.57%, although for phasing errors in the range 0.00.1%, the accuracy was almost unaffected. Current algorithms for statistical phasing of genotype data, such as BEAGLE (), have phasing error rates ranging between 0.05% and 6%, depending on the number of genotyped individuals and markers. Recently, however,proposed new experimental techniques for wholechromosome haplotyping, which promise to achieve much smaller error rates than current methods. Given these recent developments in phasing techniques, we believe that the phasing error requirements of our algorithm are realistic.
Inference of relationships in Phase III of HapMapPhase III of the HapMap dataset contains genotypes of 1184 individuals from 11 populations in more than a million SNPs. To facilitate phasing, many of these individuals are connected in trios (two parents and an offspring) or duos (a parent and an offspring). Recently, however,of degree greater than two, to verify the novel predictions of CARROT, we identified sets of three or more related individuals and examined whether our predictions for these individuals were consistent with each other and with previously reported relationships.summarizes our findings. For each population, we report:(1) the number of predictions that agreed with previously known relationships;(2) the number of identified pairs for which the relationship predicted by CARROT was inconsistent with previously known relationships but the degree of the relationship was in agreement with previously known relationships;(3) the number of identified pairs for which the degree of the predicted relationship was inconsistent with previously known relationships; and(4) the number of identified pairs for which we could not determine whether CARROT's prediction was correct or not based on previously known relationships.We note that there are small discrepancies between the numbers of first-and second-degree relationships that we report here and the numbers reported by. These discrepancies can be partially explained by the fact thatused release 3 of Phase III of HapMap, while we used release 2. Additionally, unlike, we did not include in our analysis individuals who failed the quality control filters during phasing. In total, we identified 23 previously unreported third-degree pairs and 44 previously unreported fourth-degree pairs.shows one of the pedigrees we detected. This pedigree involves three families from the MXL population, M008, M010 and M012. All the depicted first-degree relationships as well as the auntnephew relationship between the individuals NA19660 and NA19664 have been reported previously. However, our algorithm correctly identified the first cousin pairs NA19664NA19685 and NA19664 NA19662, therefore CARROT reconstructs this pedigree even in the absence of genotype data for the mother of NA19685 and NA19662. A list of all the previously unreported relative pairs detected by CARROT is given in the supplement.
i339
S.Kyriazopoulou-Panagiotopoulou et al.
Relationship reconstructionand PREST-plus on simulated data. We also applied CARROT on data from four HapMap populations, ASW, CEU, MXL and YRI, and correctly identified the vast majority of the first-and seconddegree relatives recently detected by. Additionally, CARROT detected 67 previously unreported third-and fourth-degree relative pairs. A possible shortcoming of CARROT stems from its current reliance on phased data. However, state of the art statistical methods for phasing achieve phasing errors smaller than 1% () when large cohorts and dense SNP panels are used. Additionally, novel experimental phasing techniques have achieved haplotyping of whole chromosomes with accuracy of 99.8% (). Methods for detecting genealogical relationships and for disambiguating between rotated relationships can facilitate pedigree reconstruction from cohorts such as the HapMap and WTCCC (Wellcome Trust Case Control) datasets, where most individuals are not expected to be closely related. Existing algorithms for pedigree reconstruction that are based on the detection of parentoffspring and sibling pairs cannot be applied in such datasets. In studies such as WTCCC, that are based on the premise that the individuals in the dataset are unrelated, putative relatives are usually removed or reweighted. Knowledge of the exact pedigrees, however, allows a more informed selection of the individuals to be removed. More importantly, instead of discarding the information captured in related individuals, one can leverage the reconstructed relationships in a meta-analysis step. Combining the linkage analysis from multiple reconstructed partial pedigrees with the association analysis over the remaining unrelated individuals can potentially increase the power of such studies. CARROT was designed with such applications in mind and aims at bridging the gap between algorithms for pedigree reconstruction from close relatives and traditional relationship inference methods.
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from [20:20 6/6/2011 Bioinformatics-btr243.tex] Page: i336 i333i341
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from [20:20 6/6/2011 Bioinformatics-btr243.tex] Page: i338 i333i341
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
We note that, although for the CEU and MXL populations, the accuracy of our algorithm is consistent with the simulation results of Section 2.7, in the other two populations there was a drop in accuracy. This difference in performance might be a result of an increased phasing error in the YRI and ASW populations. Additionally, in the ASW population, the degree of relatedness is unexpectedly high, with 94 identified relationships in a sample of 83 individuals. We observed, for example, that 14 individuals from eight HapMap families (2483, 2487, 2488, 2489, 2490, 2492, 2495, and 2496) are connected to each other. With less than 50 presumably unrelated individuals [there are 53 individuals reported as unrelated in the HapMap ASW dataset, even if we ignore the relationships reported here and in Pemberton et al. (2010)], the estimation of allele and haplotype frequencies becomes problematic, especially in an admixed population like ASW. To help determine whether the previously unreported pairs detected by CARROT are predicted correctly, we ran KING (Manichaikul et al., 2010) on all the identified third-degree relatives. KING uses identity by state to distinguish relatives of degree up to three from unrelated individuals. Six out of the seven pairs of individuals that were predicted to be third-degree relatives by CARROT and could not be otherwise verified, were also predicted to be third-degree relatives by KING. We thus concluded that these six pairs are most likely true third-degree relatives. We notice that KING correctly predicted only 13 out of the 16 verified third-degree relatives. It is therefore likely that the last unverified third-degree prediction for which there was a disagreement between CARROT and KING is also a true third-degree pair. 4 DISCUSSION We presented CARROT, a novel framework for relationship inference that uses linkage information to infer more distant relationships than existing methods and to distinguish between rotated relationships, that is, relationships with the same number of common ancestors and the same number of meioses separating the individuals under consideration (e.g. auntniece versus niece aunt or first cousins versus great auntniece). We demonstrated that CARROT achieved superior accuracy on relationships of degree up to four, clearly outperforming previous methods, such as RELPAIR i340 at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
i341 at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
