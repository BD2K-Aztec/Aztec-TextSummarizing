Motivation: Adjustment for population structure is necessary to avoid bias in genetic association studies of susceptibility variants for complex diseases. Population structure may differ from one genomic region to another due to the variability of individual ancestry associated with migration, random genetic drift or natural selection. Current association methods for correcting population stratification usually involve adjustment of global ancestry between study subjects. Results: We suggest interrogating local population structure for fine mapping to more accurately locate true casual genes by better adjusting the confounding effect due to local ancestry. By extensive simulations on genome-wide datasets, we show that adjusting global ancestry may lead to false positives when local population structure is an important confounding factor. In contrast, adjusting local ancestry can effectively prevent false positives due to local population structure and thus can improve fine mapping for disease gene localization. We applied the local and global adjustments to the analysis of datasets from three genome-wide association studies, including European Americans, African Americans and Nigerians. Both European Americans and African Americans demonstrate greater variability in local ancestry than Nigerians. Adjusting local ancestry successfully eliminated the known spurious association between SNPs in the LCT gene and height due to the population structure existed in European Americans.
INTRODUCTIONUnrecognized population structure can potentially lead to both false positive and false negative findings in genetic association studies (). Current statistical method used to adjust population * To whom correspondence should be addressed. stratification in genetic association studies often focus on adjusting global population structure, which is mainly caused by recent migration and genetic random drift. Global population structure can be characterized as an individual's global ancestry calculated as the proportion of the individual's genome inherited from a given ancestral population. In contrast, local population structure can be characterized in a similar way but in local genomic region or at a locus. A popular procedure to eliminate the effect of population structure is the genomic control (GC) approach (), which assumes that the variance inflation factor of a test statistic is a constant across the genome. However, variance inflation can also be due to locus-specific attributes. For example, the imprint of natural selection has recently been identified in many regions across the genome (), and can create substantial variation in F st which in turn affects the degree of variance inflation for specific loci (). Thus, the GC approach will eliminate the effect due to the global population structure, but may not be effective in eliminating the effect due to local population structure. An alternative method to correct population structure is based on the principal components (PCs) of the genotypes, in which the PCs of the genotype score matrix of many markers across the entire genome (referred to as global PCs hereafter) are used to represent individual ancestry background and used as covariates in association analysis (). Various studies have shown that the global PCs can effectively represent human demographic history (Cavalli). However, local genomic regions harboring functional variants may be subject to subtle forms of population structure not only as a result of demographic history but natural selection and local random fluctuations of admixture (). In genome-wide association studies, numerous markers are usually tested one at a time. The test of a non-causal maker locus, which is dependent of a causal gene, may be confounded by a pathway leading through both global and local ancestries (). The dependence between a non-causal marker and a causal gene may due to short range or long-range LD. Short-range LD may exist when two loci are nearby. Long-range LD might exist between two genes in different chromosomes, i.e. due to co-evolution ().Page: 2962 29612968. The pathways which confound the relationship between a non-causative marker G and phenotype Y. A single-arrowed line indicates correlation which is possibly directive (i.e. D to Y ), and a double-arrowed line indicates correlation only. Population history determines local ancestries G , D and their correlation, i.e. G and D can be correlated if markers G and D are close to each other, population admixture or co-evolution occurred on both regions; local ancestries impact the variations of and the allele frequencies of G and D; and D and directly impact phenotypic variation. Therefore, both global and local ancestries may confound GY relationship. G may impact phenotypic variation either indirectly (A) due to correlation or directly (B) due to natural selection. Adjusting G can effectively control the type I error due to the confounding by both G and. Adjusting alone may not well control type I error, especially when G directly confounds the GY association.
H.Qin et al.
A BWe reason that the whole genome is a mosaic consisting of chromosome segments coming from different ancestral populations.illustrates one way of thinking about global and local ancestries. For one individual, we denote by G the local ancestry of one marker genotype and define the global ancestry () as the average of G across the entire genome. Individuals within a population have varying family trees leading to variation in. For example, some African Americans may have 25% European ancestry, whereas some others may have 50% European ancestry. While and G are correlated as shown in, they are different quantities. The allele frequencies of a marker may be different in different ancestral populations. Hence, the global ancestry () and genotype (G) are independent conditioning on local ancestry ( G ). However, conditioning on global ancestry (), the phenotype (Y ) may still be dependent on G due to the pathway G G  D DY (see Pearl, 2010 for a further explanation of admissible covariates). Hence, when testing for genotype phenotype association, type I error may not be adequately controlled in principle by adjusting global ancestry alone. It may be instructive to adjust local ancestry G .further illustrates why adjusting local ancestry ( G ) is important for fine mapping. In this figure, D is the local ancestry at the causal gene (D), which is associated with the marker (G). There are multiple pathways confounding the genotypephenotype relationship. The pathways G G Y and G G  D Y may be blocked by adjusting G but cannot be blocked by adjusting. When attempting to detect genes, one may not wish to block the pathway G G Y because the marker (G) possibly nears a true causal locus. Local ancestry adjustment, however, may serve to refine the location of the true disease locus. With current high-throughput genotyping technologies and recent methods development on ancestry inference (), it is possible to estimate the ancestry of a local genomic region even when the entire genome is a mixture of several ancestral populations. In practice, the real ancestry at a specific locus is usually unknown. For recently admixed populations such as African Americans, the ancestral populations are typically known with good approximation. In this situation, locusspecific ancestry can be inferred accurately using hidden Markov model-based methods (). However, it is difficult to accurately infer locusspecific ancestry for a population whose substructure is subtle, due to either the lack of information on the ancestral population or when admixture has occurred within similar populations. For example, among European Americans, where population admixture occurred within populations of similar origin, it is difficult to accurately infer locus-specific ancestry due to the lack of ancestral population information. For such scenarios, we propose using local PCs to present local ancestries. By extensive simulations, we find that the correlation between global PCs and true local ancestries is very weak. Hence, global PCs may not well capture the variations in local ancestry. In contrast, the PCs of the genotype score matrix of the markers within local genomic regions (referred to as local PCs hereafter) are strongly correlated with true local ancestries. To illustrate the advantages of incorporating local PCs into fine mapping, we evaluated Local Ancestry Principal Components Correction (referred to as LAPCC). Our simulation results illustrated that LAPCC was more effective in eliminating false positives due to local population structure than Global Ancestry Principal Components Correction (referred to as GAPCC) and it retained testing power successfully. We further performed local PC analysis and LAPCC to the datasets from genome-wide association studies (GWAS) in three populations: African-Americans from Maywood, Illinois, Nigerians from Igbo-Ora and Ibadan, Nigeria and European Americans from Framingham, Massachusetts (). High degrees of variability in local ancestry of African Americans and European Americans were uncovered whereas very little was found among Nigerians of Yoruba ethnicity. This result is consistent with the demographic histories of the three populations. In addition, LAPCC successfully removed the spurious association between the LCT gene and height, which results from Northern and Southern European population structure in European Americans.Page: 2963 29612968
Interrogating local population structure for fine mapping
METHODS
Association methodsIn LAPCC, we divided each chromosome into 4 Mb adjacent window cores according to the SNP map and constructed an envelope with an 8 Mb-margin to each side of the window core (Supplementary). The left (right) envelopes of the first (last) two windows on each chromosome might be shorter than the inner envelopes. We computed the first 10 PCs of the genotype score matrix of the SNPs within the enveloped 20 Mb window. This window size was chosen based on the linkage disequilibrium due to recent population admixture (). These local PCs were then used to adjust population structure for the SNPs within the 4 Mb core. At each SNP in the core, we computed genotype score residualsg residuals residualsg i and trait value residualsyresiduals residualsy i by regressing genotype scores g i and trait values y i on the 10 PCs, respectively. We measured the evidence of trait SNP association by s 2 = (N 12)r 2 (1r 2 ), where N was the number of individuals used after excluding individuals with missed genotypes and r was the correlation coefficient between residualsyresiduals residualsy i andgand andg i. Asymptotically, s 2 follows  2 1 under the null and if population structure is well adjusted. In GAPCC, the first 10 global PCs were computed using the genotypes of all markers across the genome and utilized in the aforementioned way to contrast the association test of each SNP, which is similar to EIGENSTRAT (). When the true local ancestry is known, we can incorporate the true local ancestry in a regression model and we termed this approach as RegRA. We termed the nave regression analysis without controlling for population structure as RegUa.
Local and global PCsTo assess the degree of discrepancies between global PCs and local PCs, we calculated the coefficients of multiple-determination (R 2 ) and squared coefficients of canonical correlation ( 2 ). Let N denote the sample size, A =[a 1 ,denote the N K matrix consisting of the first K global PCs, and B =[b 1 ,denote the N K matrix consisting of the first K local PCs in a local window. The coefficient of multiple-determination R 2 j for b j and A is the R 2 in the linear regression of b j on A. The j-th largest squared coefficient of canonical correlation  2 j between A and B is the j-th largest coefficient of determination between any linear combination of B's columns and any linear combination of A's columns. Mathematically,j equals the j-th diagonal element and  2 j equals to the j-th largest eigenvalue of B AA B, and R 2is the coefficient of determination between b j and a i. Canonical correlation analysis and multiple-determination analysis enable us to evaluate the degree of discrepancies between local and global PCs and facilitate the exploration of population structures. R 2 indicates how much variation of local PCs can be accounted for by global PCs and  2 measures the shared variance between local and global PCs.
GWAS dataIn our analysis, we used three genome-wide datasets: Maywood, Nigeria and Framingham (). The detailed description and QC for Maywood and Nigeria data can be found in(i.e. spouses) based on an algorithm that prioritizes individuals with higher genotyping rates, selecting individuals at random when needed. After QCs, the Framingham dataset contained 415 281 SNPs genotyped for 1106 unrelated individuals.
SIMULATION STUDIES
Designs
Admixed populations without selection pressureWe first applied the software ADMIXPROGRAM () to the Maywood dataset to infer the individual's SNP-specific ancestries for the 701 Maywood subjects using 2606 selected ancestry informative SNPs. We observed that the distribution of individual genome-wide CEU allele portions can be well fitted by), the beta distribution with mean 0.2 and standard deviation 0.08. Based on this distribution, we simulated an admixed population with average 20% European and 80% African ancestries. Specifically, we simulated N i individuals with average ancestries w i (Supplementary Material). For each individual, we simulated the genotypes at the SNPs on 22 autosomes using HapMap dataset, which included 1 969 739 SNPs with complete haplotype information for CEU, YRI and CHB/JPT samples. For each autosome, we simulated the number of crossover points s from the Poisson distribution of mean  = l g10 7 , where l was the length of an autosome, g was the generation since the individual began admixture and was randomly sampled from 1 to 10. Then, we uniformly distributed s crossovers across the chromosome. Next, we randomly sampled haplotype segments from CEU or YRI HapMap data between two crossovers independently according to the average ancestry w i. Using this simulation procedure (denoted by GenoAnceBase0), we simulated the SNP genotypes and ancestries for 2000 unrelated individuals.
Admixed populations with selection pressureWe assumed that natural selection will result in non-concordance between local and global ancestry. For each of the 22 autosomes, we randomly picked one locus where selection pressure would be observed. We adopted specific admixture weights for the segments covering the chosen loci. For an odd (even) numbered chromosome, we simulated the segments covering the locus with average 10% (40%) European ancestry and 90% (60%) African ancestry. For the rest of genomic regions, we applied the algorithm GenoAnceBase0. We called the method for generating selection pressure as GenoAnceBase1.
Genetic modelsTo compare different methods, we considered six different genetic models (Supplementary). Models 1, 2 and 3 were designed to evaluate whether type I errors are under control for different methods. Specifically, in Model 1, only global ancestry contributed to the phenotypic variation; in Model 2, only local ancestries contributed to the phenotypic variation; whereas in Model 3, both global and local ancestries contributed to the phenotypic variation. Models 4, 5 and 6 were designed to evaluate the utilities for fine mapping for different methods. Besides random effect and the effects of 66 QTLs, in Model 4, only global ancestry contributed to the phenotypic variation; in Model 5, only local ancestries contributed to the phenotypic variation; whereas in Model 6, both global and local ancestries contributed to the phenotypic variation. We randomly sampled three SNPs on each chromosome as QTLs for all the three models, but for Models 5 Page: 2964 29612968). For Models 46, we sampled only 29 QTLs and the others were assumed to have not been genotyped.
H.Qin et al.
A B
Results
PCs and true local ancestriesWe used simulations to examine whether the local PCs can represent local ancestries better than global PCs. Using the Maywood and HapMap datasets, we simulated a dataset using the GenoAnceBase0 algorithm to mimic the admixture of two ancestral populations without local population structure, i.e. no selection pressure confined to specific genomic regions. We also simulated a dataset using the GenoAnceBase1 algorithm to ensure the presence of local population structure under the circumstances where selection was acting on specific loci. Since selection may occur in different regions in the genome, in the datasets generated using the GenoAnceBase1 algorithm we randomly selected 1 local region in each of the 22 autosomes with a selection effect. Since the real ancestry at each locus was known, we calculated the adjusted R 2-value (R 2 adj ) by regressing the real ancestry at each SNP on the first 10 local PCs of the enveloped window. For comparison, we also computed the R 2 adj value by regressing the real ancestry at each SNP to the first 10 global PCs.displays the distributions of R 2 adj values for local and global PCs in the two simulated datasets. For both simulated datasets, local PCs reflected variation of real ancestry much better than global PCs. For the dataset by GenoAnceBase0, R 2 adj = 0.50  0.09 for local PCs wheras R 2 adj = 0.10  0.03 for global PCs. For the dataset by GenoAnceBase1, R 2 adj = 0.50  0.09 for local PCs, whereas R 2 adj = 0.09  0.03 for global PCs. The R 2 adj values of the real ancestries for global PCs in the 22 regions under selection pressure were even smaller when compared with other genomic regions, as evidenced by the hump indue to the 22 regions with selection pressure. Our results indicate that global PCs do not capture local ancestry well, especially when significant effects from natural selection are present.
Type IWhen there are no genetic variants contributing to the phenotypic variation, a quantile-quantile (QQ) plot of log 10 (P-value) of a test statistic against a uniform distribution should be close to the diagonal line. Supplementarydisplays the QQ plots of single SNP analysis for the four different methods when applied to the datasets simulated from Models 1 to 3. RegUa performed poorly because there was no adjustment of population structure. When only global ancestry contributed to phenotypic variation (Model 1), both RegRA and LAPCC were within the 95% concentration band and GAPCC was associated with a slightly inflated type I error rate (Supplementary Figs S3Ai and S3Aii). However, when phenotypic variation was influenced by local ancestry (Models 2 and 3), GAPCC yielded notably inflated type I error rates whereas both RegRA and LAPCC still controlled type I error rates close to the nominal level (Supplementary Figs S3B and S3C). The QQ plots of GAPCC went beyond the 95% concentration band and the -values were substantially larger than 1. GAPCC failed to control type I error rates when the local ancestries contributed to phenotypic variation. In contrast, the QQ plots of RegRA and LAPCC were concentrated around the diagonal line and the -values were close to 1. To address the robustness of LAPCC to the change of windowwide SNP density, we dropped the odd-numbered SNPs and reanalyzed the genotype-ancestry data of even-numbered SNPs in the simulated Affymetrix 6.0 datasets and studied the representativeness of the first 10 PCs of 20-Mb local windows for the ancestry structures of their 4-Mb cores. Even though half of SNPs dropped, the patterns of false positive control were essentially unchanged (comparing Supplementary). This suggested that window-wide local PCs well maintained the representativeness for true local ancestry structures (Supplementary). The denser a window, the better the local PCs capture the true ancestry. However, the improvement is limited in general, suggesting the SNP density of Affymetrix 6.0 or Affymetrix 500K is adequate for controlling population stratification using LAPCC (Supplementaryand). It should be noted that ideally we would require each Page: 2965 29612968testing SNP is centered with its own 20-Mb window and our approach is only for reducing computational burden when analyzing GWAS data. In this case, the performance should be even better.
Interrogating local population structure for fine mapping
PowerWe evaluated the power of different methods based on 1000 replicate datasets generated under three QTL models (Models 46 in Supplementary).shows the power for the three methods, viz, GAPCC, LAPCC and RegRA. Power for LAPCC and RegRA was only slightly lower than GAPCC for all the models we evaluated. However, power of GAPCC could be overestimated when local ancestries contributed to the phenotypic variation because GAPCC might fail to control type I error as noted below. When true ancestry was known, RegRA seemed to have slightly better power than LAPCC.
Fine mappingSince linkage disequilibrium created by admixture may extend over much longer distance than the background LD (), we expect to see association signals for many non-causal markers surrounding a true QTL if local population structure is not properly controlled, even when the distance to the QTL is over several mega base pairs. We examined the performance of LAPCC and GAPCC for the 1351 SNPs within a 5 Mb region of the strongest QTL (). When global ancestry contributed to phenotypic variation, LAPCC and GAPCC performed similarly and we did not observe high significance for the SNPs far away from the QTL (). However, when local ancestry contributed to the phenotypic variation, we observed that substantially more SNPs were in association with GAPCC than LAPCC, and many of them were several Mbp away from the true QTL (Figs 3B and 3C). Similarly, we also observed more SNPs showing association evidence with GAPCC than LAPCC for QTLs with smaller effects (data not shown). Our results suggest that false positives might be detected if local population structure at non-causal markers is not properly controlled. LAPCC could effectively eliminate such spurious association and thus improve mapping resolution.
APPLICATIONS TO GWAS DATASETS
PCAWe compared local and global PCs from the three GWAS datasets to uncover local ancestry patterns in the three populations.presents the R 2-values of the first local PC in each window and global PCs as well as the largest  2-value between local PCs in each window and global PCs. The distribution of the top 10 R 2-and  2-values are presented in Supplementary. In general, we observed a small degree of correlation between local and global PCs in the samples we studied. However, the R 2 of the first local PC and  2 are substantially larger for the Maywood and Framingham samples than for Nigerian sample (), similar for the R 2 values for the rest local PCs (Supplementary). The results of the other  2 values for the three GWAS datasets are similar. These results suggest that there is relatively little population structure in the Nigerian sample, whereas Maywood and Framingham display relatively more population structure. Somewhat surprisingly, the Framingham participants demonstrated much more complex local population structure than the other two samples, at odds with the usual assumptions. To alleviate the concern that the finding in the Framingham data was caused by the presence of related individuals we removed 22 participants who shared >15% of their genome identical by descent. The results were essentially the same (data not shown).
Association analysisTo the three GWAS datasets, we applied RegUa, GAPCC, LAPCC to study the BMI and height association. To remove the potential confounding effect of age and gender, we regressed log(BMI) and height on age and obtained the residuals, within each gender (). We then performed linear regression by regressing the residuals on each SNP, which was coded additively. Supplementaryshows the QQ plots of the log 10 (P-value) for association tests for the three methods. We observed that the three methods performed similarly for both the Maywood and the Nigeria datasets, but their performance differs substantially for Framingham (Supplementary Figs S8A and S8B). Interestingly, RegUa had similar GC inflation -values as the other two methods for both height and BMI in Maywood, which seems contradictory to the intuition, as it is generally believed that population structure will inflate type I errors. For the Nigeria dataset, the three methods performed equally well, consistent with the aforementioned observation that the Nigerian samples did not have either global or local population structure. For the Framingham data, we observed the largest GC inflation -value for RegUa, followed by LAPCC and GAPCC for both BMI and height (Supplementary). One possible reason for the relatively large -value for LAPCC is that the 10 PCs we calculated may not well capture the local population structure if a specific window does not include enough ancestry informative markers (AIMs). It is also possible that there are a large number of heightassociated variants across the genome and the collection of these variants will result in departure from the diagonal line for the QQ plot. To investigate this further, we examined the known spurious association between SNPs in the LCT gene and height, which results from Northern and Southern European population structure in European Americans (). Both LAPCC and Page: 2966 29612968
H.Qin et al.A B CGAPCC eliminated this spurious association but RegUa did not (). Many genetic variants have been reported to contribute to variation in human height (). We searched the published literature and identified 121 SNPs reported to be in strong association with height, 56 out of which were also available in the Framingham dataset. Supplementarydisplays the QQ plot obtained from these 56 SNPs. The LAPCC had a slightly larger -value than GAPCC. We further examined the 100-Kb regions surrounding the 121 reported SNPs and identified 2879 SNPs genotyped in the Framingham dataset. We then presented the QQ plot for these SNPs and again LAPCC had a larger -value than GAPCC (Supplementary). In both cases, we observed that LAPCC had larger -values than GAPCC, which could be potentially caused by cryptic relatedness among the subjects. To eliminate the impact of relatedness, we further removed the 22 individuals as identified by IBD analysis (Section 4.1) and analyzed the refined data for height association. The QQ plot patterns were essentially unchanged although the -values of RegUa and GAPCC increased slightly (Data not shown). Thus, the observed larger -value for LAPCC in Framingham height association might be caused by large amount of true genetic variants contributing to height, although we cautioned that LAPCC could not perform well in some regions without sufficient AIMs. Further simulations (Supplementary Figs S10S12) indicate that 6002000 QTLs with small genetic effects together with SNPs in LD with QTLs may lead the genomic inflation factor to be larger than one, further suggested that the observed larger -value for LAPCC might be caused by large amount of height QTLs.
DISCUSSIONSIn this article, we investigated the effectiveness of local and global ancestry adjustments for fine mapping in genetic association studies. Through extensive simulations, we observed that local PCs were strongly correlated with true local ancestry, whereas global PCs were merely weakly correlated with the true local ancestry. Moreover, our simulations illustrated that adjusting local ancestry (i.e. LAPCC or RegRA) was able to remove spurious association due to both global and local population structure and retain statistical power, whereas global ancestry adjustment methods such as genomic control and global PC-based methods may be inadequte. In our simulations, many significantly associated SNPs surrounding the causal variants in the GAPCC analysis were no longer significant in the LAPCC analysis, whereas the causal variants are essentially not affected. When spurious association is created due to the long-range LD, which is shown inwhen the correlation between G and D is due to coevoluation, our proposed method should also work well. Further, we point out that adjusting local ancestry may in theory reduce type I error equally well as adjusting global ancestry when local ancestry confounds association only through global ancestry. When only global population structure is present, the power of LAPCC is still comparable to the power of GAPCC.Our simulation findings were corroborated by the application of PCA, LAPCC and GAPCC to the three real GWAS datasets. We observed that there could be abundant variation in local ancestry structure across the genome and local ancestry would be weakly correlated to global ancestry for admixed poulations, i.e. African Americans and European Americans, consistent with the demographic histories of these populations. For the three GWAS datasets, the association results produced by LAPCC are roughly comparable to those produced by GAPCC. For the Framingham height data, RegUa had the largest GC inflation -value, followed by LAPCC and GAPCC. To investigate whether it was due to Page: 2968 29612968
Page: 2967 29612968
Interrogating local population structure for fine mapping
A
H.Qin et al.be possible to improve LAPCC by introducing some metric of defining a meaningful window size instead of working with a fixed window size.
The Author 2010. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oxfordjournals.org 2961 at :: on August 31, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
at :: on August 31, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
the reduced power of GAPCC, we further examined the SNPs surrounding the loci reported to be associated with height. As expected, LAPCC had much larger GC inflation -value than GAPCC did, suggesting that the smaller -value for GAPCC could be due to the power reduction since global ancestry adjustment might not completely remove the effect of population stratification. Furthermore, we examined the SNPs in the LCT gene which was reported to be spuriously associated with height in European Americans. LAPCC firmly abolished all those SNPs found positive by RegUa, suggesting that local ancestry adjustment would control the effect due to population structure in European populations. For the Maywood data, we observed that RegUa had a similar GC inflation -value to LAPCC and GAPCC, fitting a continuous gene flow model under which population structure would not have a large effect in association studies (Rosenberg and Nordborg, 2006). For the Nigerian data, all the three methods performed similarly, and this observation is consistent with our observation that no substantial local or global population structure is present in Nigerians. Like other approaches, the LAPCC has limitations. The SNP density of a segment may impact its performance. In our analyses, it worked well when a 20-Mb window covered >1000 SNPs in minimum (Supplementary Figs S3S6 and Table S2). We caution that it may not perform well in the regions without enough AIMs. It is reasonable to run LAPCC on the subset of markers which are found positive by GAPCC. In doing so, we could prevent false positives due to other confounding resources, improve fine mapping and save computing time as well. In addition, it may
