Motivation: Free energy nearest-neighbour (NN) thermodynamics is widely used in DNA biochemistry , ranging from the calculation of melting temperatures to the prediction of secondary structures. Methods to calculate NN parameters require the knowledge of total sequence entropies and enthalpies, which are not always available. Results: Here, we implement and test a new melting temperature optimization method where we obtain the NN parameters directly from the temperatures. In this way, we bypass the constraints imposed by total sequence entropies and enthalpies. This enabled us to calculate the missing NN entropies and enthalpies for some published datasets, including salt-dependent parameters. Also this allowed us to combine 281 sequences from different types of melting temperature data for which we derived a new set of NN parameters, which have a smaller uncertainty and an improved predictive power. Availability and implementation: Cþþ source code and compiled binaries for several Linux distributions are available from https://sites.google.com/site/geraldweberufmg/vargibbs and from OpenSuse build service at https://build.opensuse.org/package/show/home:drgweber/VarGibbs. The software package contains scripts and data files to reproduce all results presented here. Contact:
IntroductionThe concept of dividing a DNA or RNA sequence into pieces of nearest-neighbour (NN) pairs for predicting melting temperatures (T m ) was pioneered 40 years ago byintroduced much of the concepts and terminologies that are in use today. A more detailed analysis of the NN representation was given by) and later by. Its simplicity of use and effectiveness has made it into a nearly universal method for applications in oligonucleotide chemistry and molecular biology. With this technique, predictions of thermodynamic properties for any unknown sequence can be made by summing over NN entropies and enthalpies (DP NN with P  H; S). The method which is currently in use for extracting DP NN is essentially based on writing a set of linear equations where each equation represents the total entropy or the total enthalpy variations (DP i Tot ) of a given sequence i. For the remainder of this article, we call this the total entropy and enthalpy variation (TEEV) method. Therefore, it is necessary to first obtain the total DP i Tot. This can be done either by curve fitting the melting curve or from a linear regression of T 1 m versus log C t in which case one needs a number of measurements at different species concentrations C t. Unfortunately, both curve-fitting or T 1 m  log C t methods introduce a certain amount of uncertainty into the resulting parameters DP NN. Furthermore, the total DP i Tot may, for various reasons, not be available at all. Here, we propose a new melting temperature optimization (MTO) method, which does not require the total parameters DP i Tot. Instead, we simply fit the DP NN , which best describe the meltingThis direct approach has two advantages over the TEEV method. One is that we fit the much more accurate melting temperatures T m. The other is that this method can be applied to situations where the total parameters DP i Tot are unavailable. For example, one can work out the NN parameters from the melting temperatures, which were measured only for a single species concentration for each DNA sequence.summarizes the differences between the methods. Another interesting feature of the model is that the initialization parameters can be obtained in the framework of the MTO. Numerically, the MTO minimizes the difference between measured and predicted melting temperatures by varying the DP NN parameters freely. Here, we applied the MTO method successfully to the dataset by SantaLucia (1998) and showed that the resulting predictive uncertainty is significantly reduced. We used a similar method for the non-linear Peyrard-Bishop model (). The good results obtained for the non-linear model were one of our main motivations to investigate the applications of the MTO method to the linear NN model. One key aspect of obtaining the free energy parameters DP NN is the experimental set of melting temperatures. Unsurprisingly, different sets are bound to result in different parameters. Here, we analysed the two sets by). However, as total sequence entropies and enthalpies are not required, we could also analyse the datasets by(D-OW04). We discuss the significant differences resulting from those datasets, especially regarding initiation parameters. Finally, we combined the datasets DSL98 and D-OW04 into a new set for which we obtain the best overall melting temperature prediction.
Methods
DataIn this work, we are using five different datasets to test the optimization method.presents a summary of these datasets and the notation adopted throughout this work. The D-SL96 includes the non-two-state sequences, otherwise we would not have enough sequences for retrieving all initiation parameters. The D-SL98 dataset was used by SantaLucia (1998) to retrieve NN parameters (P-SL98), which is widely used for temperature prediction. Note that the actual sequences and temperatures were in fact published in the Supplementary Tables of, but it has become common practice to refer to them as coming from SantaLucia (1998). D-OW04 are the melting temperatures obtained from ultra-violet absorption measurements at five different salt concentrations byThe D-OW04DSC dataset comprised the same DNA sequences as in D-OW04 but measured by differential scanning calorimetry (DSC) at low and high salt concentrations. All sequences in D-OW04 and D-OW04DSC are non-self-complementary. D-CMB is the combination of all data from D-SL98, D-OW04 and D-OW04DSC at high salt concentration.
Temperature calculationThe melting temperature for the ith sequence is calculated fromwhere f  1 for self-complementary sequences and f  4 otherwise. C t is the species concentration and C 0  1 mM is the reference concentration introduced to insure that the argument to the logarithm is dimensionless. DH tot i and DS tot i are the total entropy and enthalpy variations for sequence i.
NN modelsThe various NN models found in the literature differ mainly by the introduction of initiation factors, which try to take into account symmetry and several other specific aspects of nucleotide sequences. The optimization method presented here can be used with any of these methods. The basic model is simply the summation of all NN parameters pwhere Dp a is either the enthalpy (p  H) or the entropy (p  S) variation for n ia occurrences of NN types a in the ith sequence. Additional correction factors Dp c may be added, such asfor an AT base pair at the 5 0-endsummarizes the correction factors used in various models.
Local minimizationThe aim of the method is to minimizewhere T i is the measured melting temperature for the ith sequence. T 0 i is the corresponding predicted temperature resulting from the set of tentative parameters fpg k  fp k1 ; p k2 ; p k3 ;.. .g:We start with an initial set of parameters fpg 0 and let the parameters vary until we minimize as much as possible v 2. After L steps of minimizations, the resulting set fpg L represents the parameters which best reproduce the melting temperatures for the model. To minimize simultaneously all parameters, we used the multidimensional NelderMead or downhill simplex method () in a similar way as for the non-linear models (). Each local minimization was carried as follows:1. Define a set of initial parameters fpg 0. 2. Carry out the minimization with a characteristic length which should be roughly of the order of magnitude of the parameters (). Here, we used a value of 10 for the characteristic length. 3. Stop the minimization either when the variation of v 2 from one round to the next falls below 0.01 or when a limit of L  3000 steps is reached. 4. Use the newly obtained parameters {p} as new initial parameters and repeat the whole procedure five more times.
Local minimization control parametersIn addition to, the following parameters are used to assess the quality of the minimization: Average prediction difference:This is a simple parameter that allows a more direct comparison of the prediction quality of the results to those by other authors.Root mean square of prediction differences is closely related to v 2 ,and is useful for evaluating the relative dispersion of predicted temperatures T i 0 .
Global minimizationThe drawback of the minimization of Equation (3) is that most of the time we will find only local minima. This is especially problematic for minimizations involving experimental data because local minima may be result of noise. One way to overcome this problem is to repeat the local minimization many times with different initial parameters fpg 0. We will call this procedure global minimization, i.e. the attempt to find the local minima which is closest to the global minimum. In summary, a global minimization is M repetitions of local minimizations by varying certain conditions randomly each time.
Global minimization control parametersAverage parameterwhere p k is the kth parameter in the set, and M is the total number of complete local minimizations performed. Standard parameter deviationwhich is used to estimate the uncertainty of each parameter p k for the melting temperature predictions after M rounds of local minimizations. Relative average parameter differencewhich measures how much the average parameter hp k i M is changing in round M compared with the previous round M  1. One possible stop criterion for the global minimization is to calculate the average of a k;M over all parameters k parameters,and set a threshold a t , such that the minimization stops whenis satisfied. Relative standard deviation differenceSimilar to the relative average parameter difference, this can be used as a much stricter criterion for stopping the minimization process, by requiringHere, we repeat the local minimizations 1000 times (M 1  1000). For the second block of global minimizations, we take the best parameters from the first block and use them as fixed initial parameters (fpg 0  fpg min v 2 k), but now we vary randomly the experimental temperatures. We create a new set of modified temperatures fTg l 0 , which differ by random amounts from the original set {T} in such a way that on average the standard deviation between the two sets is close to the declared experimental uncertainty of 0.3 C. We repeat this procedure using b t  0:01 as stop criterion, see Equation (13), resulting in a variable number M 2 of new local minimizations. From these M 2 results, we calculate the average parameters, which are presented here.
Parameter correlationTo compare different parameters sets {p} and {q}, we use the Pearson's sample correlation coefficient,In this work, we will provide the correlation coefficient separately for entropies (r S ) and enthalpies (r H ) and only for NN parameters. Initiation parameters are not included in the parameter correlation. Please note that this coefficient is not part of the MTO method and is used only as a guide to aid the comparison between different parameter sets.
Summary of notationDNA sequence and melting temperatures datasets are prefixed by D-, published parameters by P-, initiation parameters by iP-and averaged optimized parameters by AOP-.
Results and discussionThe most problematic aspect of the MTO method presented here is the occurrence of local minima which are likely to occur when adjusting experimental data and are mainly caused by fluctuation due to experimental uncertainties. To overcome this problem, our method is applied in two distinct steps. First, we repeat the minimization many times where we vary the initial parameters by a very large amount. From this step, we obtain the parameters with the smallest disagreement from the experimental temperatures. In the second step, we use the previous parameters as input and now vary the experimental temperatures within their declared experimental uncertainty. This last step provides us with an estimate of parameter uncertainty resulting from experimental fluctuations. See section 2.5.2 for details. We consider here two types of predictions: self-predictions and cross-predictions. Self-predictions are those where the parameters were derived from the same dataset that is being predicted. For instance, predicting the melting temperatures of the sequences in D-SL98 using parameters AOP-SL98. Cross-predictions are predictions where the dataset is different from the one used to obtain the parameters.shows some examples of melting temperature predictions as scatter plots for the combined dataset D-CMB. The predictions obtained from the older parameter set P-SL96 (),, is one of the poorest. The frequently used set P-SL98 () is clearly a significant improvement as shown inbut the prediction, especially at higher temperatures, still suffers.shows the self-predictions from the optimized parameter set AOP-CMB with very little dispersion along the diagonal line and a very low average temperature deviation hDTi. This clearly shows that the MTO method minimizes Equation (3) much more uniformly for all temperatures. Note that it would be very difficult, if not impossible, to treat such a combined set with the usual single value decomposition method. The reason is that for the TEEV method one needs the total entropies and enthalpies of all sequences, which are not available for the D-OW04 and DOW04DSC datasets. Evidently,only shows how the MTO successfully minimizes the difference in temperatures between datasets and predictions when compared with other methods. A much more complete overview is presented inwhere we show a summary of all predictions performed in this work. For all optimizations, the average temperature deviation hDTi and its DT RMS are considerably reduced for self-predictions. Better self-prediction, however, typically results into poorer cross-predictions. For example, the optimized AOP-SL98 results into much better self prediction that the original P-SL98, reducing hDTi from 1.9 C to 1.5 C. But for crosspredictions, AOP-SL98 is generally poorer than SL98. The optimized parameters AOP-OW04 and AOP-OW04DSC are exceptionally good at self-predicting melting temperatures but do perform poorly otherwise. This is true even when using AOP-OW04 to predict D-OW04DSC and vice versa, even though both use exactly the same sequences. With the choice of dataset playing such a crucial choice, we combined the D-SL98, D-OW04 and D-OW04DSC into a single set D-CMB. Once again the self-prediction is very good, at 1.4 C, and all its cross-predictions are second-best if compared with the. Scatter plot of predicted melting temperatures compared with the experimental temperatures for dataset D-CMB at 1000 mM. The crosspredictions using the (a) original P-SL96, (b) the original P-SL98 and (c) the self-prediction for optimized AOP-CMB parameters are shown. The closer the points are to the diagonal dashed lines, the better the prediction quality. Predictions are shown as bullets if they are within 1 C of the experimental points, otherwise they are shown as crosses. Data points are horizontally shifted to the right for clarity, and the resulting average temperature deviation hDT i is calculated from Equation (5) self-predictions of other parameters,. Compared with the widely used P-SL98 parameters, AOP-CMB reduces hDTi by 0.5 C and DT RMS by 0.6 C for the D-CMB dataset. The TEEV method aims at getting close to the total entropy and enthalpy variations, DH Tot and DS Tot , for all sequences. Nevertheless, the difference between the self-predicted and experimental total parameters for the P-SL98 TEEV parameters is rather large, 7.2% and 8.2% for DH Tot and DS Tot , respectively. For the MTO parameters AOP-CMB, there is an increase to 12% and 14% when predicting the total parameters DH Tot and DS Tot of D-SL98. With the MTO method being clearly able to produce acceptable self-predictions comes the question of how the MTO parameters compare to those obtained from TEEV method. To assess this unambiguously, we calculated the correlation between the parameters using Equation (14), where a good correlation should yield a number close to 1.presents correlations comparing all parameters analysed in this work. There is mostly very little correlation between optimized dataset, which explains the generally poor cross-prediction. For the AOP-CMB optimized parameters, there is some correlation for the fDHg with the original P-SL98 and a moderate correlation when it comes to fDSg. Note that initiation parameters were not included in the correlation analysis and that the correlation coefficients may not be a reliable indicator of similarity if non-unique parameters are included. The complete set of parameters for all optimizations at high salt concentrations is listed in. In general, the enthalpies have a similar behaviour as for the TEEV parameters (P-SL96 and P-SL98). For entropies, however, important changes are observed with their values covering a much wider range. These wide ranges of entropies are accompanied by large positive variations in initiation factors, in particular for the AOP-OW04 and AOP-OW04DSC with some of them becoming as high as hDS term AT i  35 cal/mol. One crucial difference from D-OW04(DSC) to all other datasets is the absence of self-complementary sequences. This may explain the important parameter variations, especially for entropies seen for the AOP-OW04(DSC) parameters. The enthalpies of AOP-CMB are clearly closer to the original P-SL98, as already noted from the correlation factors. As the total parameters DH tot i and DS tot i in P-SL98 are essentially averaging out differences in melting temperatures from various species concentrations C t , it would seem that a similar averaging effect is occurring for AOP-CMB. Good self-prediction with poor cross-prediction may sometimes indicate over-fitting, i.e. fitting to noise. Could this be the case for the AOP-OW04(DSC) parameters? The second block of global minimizations, see section 2.5.2, is precisely to assess this type of situation. As we randomly vary the temperatures within the experimental uncertainty, we effectively change the position of the experimental noise. If over-fitting was occurring, we should have seen large parameter uncertainties; however, this not the case as shown in. As the datasets D-OW04 and D-OW04DSC are measured at various salt concentrations (), we can now calculate the parameters as function of.shows the parameter dependence with salt concentration for datasets D-OW04 and DOW04DSC. Note that D-OW04DSC is measured only at the lowest and highest salt concentrations. Only ApT, TpA and ApA (panels c and g) show similar trends for D-OW04 and D-OW04DSC. All remaining parameters display very dissimilar behaviours, and no particular conclusion can be drawn at this stage except that sequence context seems to play an important role for salt concentration corrections. On the other hand, the qualitative trends of enthalpies and entropies are nearly identical, possibly resulting from the form of Equation (1). If the influence of the term ln C t =fC 0 is small then one would expect DH a i to become largely proportional DS a i. One word of caution is needed here, one should keep in mind that these are self-predictions and contain no self-complementary sequences. Therefore changes to the salt-dependent results should be expected as new datasets become available. Ideally, large and diverse datasets are best for the MTO method as shown by the results of the AOP-CMB parameters. However, for many practical applications, the available melting temperature data may be limited to only a small collection of sequences, which brings the question of what are the minimal conditions for the MTO method to work properly? Although the non-linearity introduced by Equation(1) makes this difficult to answer precisely, a rule of thumb confirmed by numerical experiments is that there should be more sequences than variables. In general, DT RMS should never turn out to be smaller than the experimental uncertainty. Therefore, optimizations that returnCpGEstimated uncertainties, where available, are displayed in concise notation. DT RMS % 0 are a clear sign of insufficient number of sequences in the dataset. A practical advice in this case is to reduce the number of parameters to optimize, e.g. by keeping the initiation parameters as constants. When designing new sequences to be used with the MTO method, one should favour longer sequences with a diversity of NN configurations and with a large melting temperature range.
ConclusionWe presented a new method for the calculation of NN parameters from experimental melting temperatures. Because this method sidesteps the calculation of total entropies and enthalpies, it enables us to calculate the NN parameters under conditions, which cannot be handled by the traditional methods. It also allows us to combine datasets obtained under very dissimilar experimental conditions. The results of temperature predictions show a marked improvement, especially when larger datasets are used to calculate the parameters. The software that implements this method is made freely available. A comprehensive user manual is part of the package and included as Supplementary Material. Therefore, the interested reader is provided with ability to calculate the thermodynamic parameters for any desired dataset. Also the availability of the source code allows for modifications for particular variants of the NN model, for instance to include nucleation terms (Oliveira Guerra, 2013).
Funding
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
G.Weber at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
