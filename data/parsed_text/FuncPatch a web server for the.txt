Motivation: A number of statistical phylogenetic methods have been developed to infer conserved functional sites or regions in proteins. Many methods, e.g. Rate4Site, apply the standard phylogenetic models to infer site-specific substitution rates and totally ignore the spatial correlation of substitution rates in protein tertiary structures, which may reduce their power to identify conserved functional patches in protein tertiary structures when the sequences used in the analysis are highly similar. The 3D sliding window method has been proposed to infer conserved functional patches in protein tertiary structures, but the window size, which reflects the strength of the spatial correlation, must be predefined and is not inferred from data. We recently developed GP4Rate to solve these problems under the Bayesian framework. Unfortunately, GP4Rate is computationally slow. Here, we present an intuitive web server, FuncPatch, to perform a fast approximate Bayesian inference of conserved functional patches in protein tertiary structures. Results: Both simulations and four case studies based on empirical data suggest that FuncPatch is a good approximation to GP4Rate. However, FuncPatch is orders of magnitudes faster than GP4Rate. In addition, simulations suggest that FuncPatch is potentially a useful tool complementary to Rate4Site, but the 3D sliding window method is less powerful than FuncPatch and Rate4Site. The functional patches predicted by FuncPatch in the four case studies are supported by experimental evidence, which corroborates the usefulness of FuncPatch. Availability and implementation: The software FuncPatch is freely available at the web site, http://info.mcmaster.ca/yifei/FuncPatch
INTRODUCTIONBecause of the fast development of sequencing techniques, the amount of sequence data is increasing exponentially. The best ways to extract biological insights from massive sequence data have become important questions in biology. Comparisons between homologous sequences from different species are very common strategies to analyze biological sequences. For example, given a set of homologous protein sequences from different species, we can compare these sequences to identify conserved amino acid sites. These conserved amino acid sites are more likely to be functionally important, since mutations at these sites are more likely to be deleterious. To infer the conservation levels of amino acid sites, we need evolutionary models to describe the substitution process of amino acids in the evolutionary history. The simplest idea is to use the standard statistical phylogenetic models () to infer the site-specific substitution rates and the sites with low substitution rates may be considered to be functional. For example, a widely used web server, ConSurf (), uses the site-specific substitution rates estimated by the Rate4Site program () to infer the conservation levels of amino acid sites. Then, the conservation scores are mapped onto the protein tertiary structure to get insights on the possible functions of the highly conserved sites (). While the standard phylogenetic models are useful tools for inferring conserved sites in proteins, they typically model the substitution rate variation by some discretized distributions, e.g. the discretized Gamma distribution (), and ignore the spatial correlation of substitution rates in protein tertiary structures. However, it is well known that functional amino acids are clustered together in protein tertiary structures in many proteins and modeling the spatial clustering can improve the prediction of functional sites (). The independence assumption of site-specific substitution rates in the standard phylogenetic methods may make it difficult to infer conserved functional patches in protein tertiary structures. The problem is especially acute when the sequences used in the analysis are very similar to each other, because it is difficult to estimate site-specific substitution rates accurately in this scenario due to the limited information at each amino acid site. A few methods have been proposed to relax the independence assumption of site-specific substitution rates to predict conserved protein patches in protein tertiary structures (). These methods are useful tools for inferring conserved protein patches, especially when the sequences in the dataset are highly similar. However, most of these methods are based on the 3D sliding window framework () or other heuristic algorithms (). The common problem of these methods is that they cannot infer the strength of the spatial correlation of substitution rates, which in turn makes the inference of sitespecific substitution rates unreliable. For example, the window *To whom correspondence should be addressed.
yPresent address: Department of Pathology and Laboratory Medicine, University of British Columbia, Vancouver, BC V6T2B5, Canada size in the 3D sliding window method is typically predefined before analyses. However, the strength of spatial correlation may vary in different proteins, which suggests that the optimal window size may vary in different datasets (). Recently, we developed a phylogenetic Gaussian process model, GP4Rate, which combines standard phylogenetics and Gaussian processes to infer conserved functional regions in protein tertiary structures (). Using the Gaussian process as the prior distribution of log values of site-specific substitution rates, GP4Rate naturally captures the spatial correlation of substitution rates in the protein tertiary structure. In addition, GP4Rate can infer the strength of the spatial correlation of substitution rates based on the Bayesian principle. Therefore, it overcomes the drawbacks of the 3D sliding window method and other heuristic methods. However, GP4Rate is based on Markov chain Monte Carlo (MCMC) methods to generate samples from the posterior distribution of parameters. Because MCMC methods are generally very slow, it typically takes a few hours to a few days to analyze a gene family using GP4Rate. In addition, the command-line interface of GP4Rate may not be intuitive to many experimental biologists. Here, we report a new algorithm, FuncPatch, which is designed as a fast approximation to GP4Rate. This method is fast enough to be implemented in a web server. Using a simplified likelihood function and a Laplace approximation, FuncPatch is orders of magnitudes faster than GP4Rate and the analyses of most gene families can be finished in a few minutes. Both simulations and four case studies based on empirical data demonstrate that FuncPatch is a very accurate approximation to GP4Rate. In simulations, FuncPatch is always among the most powerful methods regardless of the assumptions of the simulations. Furthermore, FuncPatch could be more powerful than Rate4Site when a spatial correlation of substitution rates is present and the sequences in the simulated alignments are highly similar. In contrast, the performance of the 3D sliding window method is generally very poor. Therefore, FuncPatch is complementary to Rate4Site and is particularly useful to infer conserved 3D patches in a set of highly similar protein sequences. The four case studies suggest that the spatial correlation of substitution rates is present in real data and that the strength of spatial correlation may vary in different protein families.
MODELS
Overview of FuncPatchWe developed FuncPatch, an algorithm for the fast Bayesian inference of conserved patches in protein tertiary structures. FuncPatch is designed as a fast approximation to GP4Rate (), which combines phylogenetics and Gaussian processes to infer conserved functional patches in protein tertiary structures. In this section, we describe the basic idea of FuncPatch in simple terms and ignore mathematical details. Thereafter, we describe technical details of the parameterization and implementation of FuncPatch. Readers who are not familiar with computational statistics may read this section but skip these technical sections. FuncPatch assumes that the users provide an alignment of proteins and a representative protein tertiary structure. Similar to GP4Rate (), it combines the information from the protein alignment and the protein tertiary structure to infer site-specific substitution rate at each amino acid site. The estimated substitution rates are used as proxies of functionality: lower substitution rates suggest that the corresponding sites are more likely to be functionally important. If conserved functional sites form tertiary patches, e.g. protein protein interaction interfaces, the site-specific substitution rates may be positively correlated over the protein tertiary structure. Thus, physically closely located sites are more likely to have similar substitution rates. Modeling the spatial correlation of substitution rates may in turn improve the prediction of conserved functional patches, since the inference of substitution rate at a focal amino acid site can borrow 'statistical information' from closely located sites with similar substitution rates (). FuncPatch uses the Bayesian statistical principle to infer site-specific substitution rates. To apply the Bayesian principle, we need to specify a prior distribution over site-specific substitution rates and a likelihood function which describes the probability of the observed data given the site-specific substitution rates. In FuncPatch, the protein tertiary structure is used to specify a prior distribution of substitution rates. Similar to GP4Rate, we assume that the prior distribution of the log values of site-specific substitution rates follows a Gaussian distribution guided by the protein tertiary structure. The Gaussian prior distribution has a very useful property that the log substitution rates of two physically closely located sites are strongly correlated while the log substitution rates of two distant sites are weakly correlated. Therefore, the Gaussian prior distribution encourages the site-specific log substitution rates to be smoothly distributed over the protein tertiary structure. To fully define the Bayesian model, we also need to specify the likelihood function. In our previous work of GP4Rate (), we used the standard phylogenetic likelihood function (). However, the phylogenetic likelihood function is too computationally expensive for a web server. Therefore, FuncPatch uses a simpler likelihood function. First, we use the parsimony method implemented in the PROTPARS program in PHYLIP () to estimate the most parsimonious number of substitutions at each site. Then, this number of substitutions is used as a summary statistic in the likelihood function. The likelihood function, which measures the probability of the most parsimonious number of substitutions at a site given its site-specific substitution rate, is assumed to follow a Poisson distribution. The Poisson likelihood function significantly simplifies the computation and, more importantly, makes it easy to design efficient approximation algorithms to infer the posterior distribution of site-specific substitution rates. The combination of the Poisson likelihood function and the Gaussian process priors has been studied in the area of Bayesian disease mapping (). We developed a customized C++ program to implement this model and then a user-friendly web server based on BioPerl () and Jmol () was developed to make FuncPatch easily usable to biologists.
Poisson likelihood functionWe assume that a protein alignment, a PDB file of a representative protein tertiary structure, a query PDB chain name, a query sequence name and an optional phylogenetic tree are provided by the users. The query sequence name should be the exact name of a sequence in the protein alignment and the query sequence should correspond to the query PDB chain. If the users do not provide a phylogenetic tree, FuncPatch generates a neighbor-joining tree automatically (). The phylogenetic tree used in FuncPatch is denoted by T. Then FuncPatch uses MUSCLE () to align the query sequence with the query PDB chain to generate a guide alignment. A set of informative sites are chosen from the original alignment based on the guide alignment. An informative site must meet three conditions: (i) it must match an amino acid in the query PDB chain; (ii) at least three sequences in the original alignment must have amino acids instead of gaps at the site; (iii) the number of gaps at the site must be less than a half of the number of sequences in the original alignment. The informative sites form a new alignment denoted by X and the number of sites in the alignment X is denoted by N. Then, FuncPatch uses the PROTPARS program in PHYLIP () to estimate, C, a vector of the most parsimonious number of substitutions for each site in X, in which a single element C i is the most parsimonious number of substitutions at site i. FuncPatch assumes that C i , the most parsimonious number of substitutions at site i, follows a Poisson distribution,where i denotes the expected number of substitutions at site i [which will be described in detail in Equation(5)].
Gaussian prior distributionGiven the alignment X, FuncPatch calculates, , the average number of substitutions over all sites,Based on the 3D coordinates of the carbons of amino acids in the user provided PDB file, FuncPatch then calculates a distance matrix D in which an element D ij measures the Euclidean distance between sites i and j in the alignment X. Similar to GP4Rate (), we assume that the prior distribution of , the vector of site-specific log substitution rates, follows a zero-mean Gaussian distribution,
Inference of hyperparameters and Bayesian model comparisonThe descriptions in the previous sections assume that the two hyperparameters, i.e. l and , are known. In real data analyses, we need to estimate these hyperparameters from data. FuncPatch performs a grid search to generate a point estimation of parameters. We choose 20 representatives l, evenly spaced between 1 and 39 A  , and 20 representatives , evenly spaced between 0.1 and 3.9. Therefore, there are 400 different combinations of hyperparameters based on these representative values. Then, FuncPatch performs a Laplace approximation for each combination of hyperparameters to calculate the approximate marginal likelihood Z (). The combination of hyperparameters with the largest marginal likelihood Z is chosen as the point estimation of the hyperparameters. The average of the marginal likelihoods over all combinations of hyperparameters is used as the overall marginal likelihood of the model, which implies that we put a uniform hyperprior over hyperparameters. To evaluate whether the spatial correlation of substitution rates is significant in a dataset, we developed a test based on the Bayesian model comparison. The model described above is the alternative model (model 1) in the Bayesian model comparison. We also designed a null model (model 0) in which any spatial correlation of substitution rates is absent. In model 0, we assume that the characteristic length scale l is always equal to 0, which essentially removes the spatial correlation from the Gaussian prior distribution. Twenty representative signal standard deviations are evenly spaced between 0.1 and 3.9 as model 1. The average marginal likelihood over the 20 combinations of hyperparameters is used as the overall marginal likelihood of model 0. We suggest that 8 may be used as a conservative cutoff for the log Bayes factor (model 1 versus model 0). If the estimated log Bayes factor is larger than 8 in a dataset, we consider that the spatial correlation of site-specific substitution rates is significant in the dataset.
SIMULATIONS AND CASE STUDIES
SimulationsWe evaluated the performance of FuncPatch and compared it with the performances of GP4Rate (), Rate4Site () and a customized 3D sliding window program based on the Bio++ library (). In the comparison, Rate4Site is used as a representative of methods which ignore the spatial correlation of site-specific substitution rates in protein tertiary structures. The 3D sliding window program is similar to the methods described in previous studies (). In the 3D sliding window program, the JTT substitution model () is used to describe the substitution process of amino acids. We assume that a window size and a reference phylogenetic tree have been provided by the users. For each site in the protein tertiary structure, the 3D sliding window program first collects the set of sites whose Euclidean distances to the focal site is smaller than the window size to generate a local alignment and then optimizes the scale of the reference phylogenetic tree given the local alignment. The tree scale is considered to be the estimated substitution rate at the focal site. We used two window sizes in the 3D sliding window program. The small window size (7 A  ) may be more powerful to capture small conserved patches while the large window size (15 A  ) may be more powerful to capture large conserved patches. We generated four sets of simulated alignments (AD) based on the human Bcl-xL protein to benchmark the performances of FuncPatch, GP4Rate, Rate4Site and the customized 3D sliding window program, respectively. To generate simulated alignments, we need to specify a substitution model, a reference protein structure, a reference phylogenetic tree and a set of reference site-specific substitution rates. In all simulations, the JTT substitution model () was used to describe the substitution process of amino acids and the protein tertiary structure of the human Bcl-xL protein (PDB ID: 1MAZ;) was used as the reference structure. The reference phylogenetic trees and the reference site-specific substitution rates were different in the four simulated datasets, which will be described in detail below.The 100 alignments in dataset A were generated using a small reference phylogenetic tree. As shown in Supplementary, the small phylogenetic tree consists of four sequences and the total branch length is equal to 1. Therefore, the expected number of substitutions per site is equal to 1, which is comparable to the expected numbers of substitutions per site in many empirical datasets which only consist of orthologous sequences. We expect that it is relatively difficult to estimate site-specific substitution rates accurately in this scenario due to the relatively small number of substitutions per site. The reference substitution rates used in the step of generating alignments were downloaded from the ConSurf-DB database (), which automatically collected a large number of homologs of the human Bcl-xL protein and then used Rate4Site to estimate site-specific substitution rates. It is expected that the spatial correlation of substitution rates is present in this dataset, since a previous study based on Rate4Site has suggested that the inferred conserved sites are clustered together in the protein tertiary structure of the human Bcl-xL protein (). The 100 alignments in dataset A were permuted randomly to generate the 100 alignments in dataset B. The permutations destroyed the spatial correlation of substitution rates but kept all other features of the alignments. This dataset was designed to test the performances of different methods when the reference phylogenetic tree is small and a spatial correlation of substitution rates is absent.The 100 alignments in dataset C were based on a large reference phylogenetic tree (Supplementary). There are 12 sequences in the phylogenetic tree and the expected number of substitutions per site is equal to 4.2, which is comparable to the expected numbers of substitutions per site in many empirical datasets consisting of paralogous sequences. Therefore, we predict that it is relatively easy to estimate site-specific substitution rates in this scenario, because the generated protein sequences are highly diverged. Similar to dataset A, the substitution rates downloaded from the ConSurf-DB database () were used to generate dataset C. Therefore, the spatial correlation of site-specific substitution rates is present in this dataset.The 100 alignments in dataset C were permuted randomly to generate the 100 alignments in dataset D. This dataset was designed to test the performances of different methods when the reference phylogenetic tree is large while a spatial correlation of substitution rates is absent. We applied FuncPatch, GP4Rate, Rate4Site and the customized 3D sliding window program to the four sets of simulated alignments. The reference phylogenetic trees (Supplementary) were used as the input trees in all analyses. For GP4Rate, two independent MCMC chains were implemented for each alignment and the first 30% of samples were discarded as burn-in. We used the ROCR package in R () to plot the receiver operating characteristic (ROC) curves to evaluate the statistical powers of the four programs. To perform the ROC analyses, we need to define a cutoff of percentage which corresponds to the proportion of functional sites in the simulated alignments. We assumed that the cutoff of percentage is equal to 10%, which suggests that the 10% of sites with the lowest reference substitution rates were considered as functional sites. Similar results are reached using different cutoffs, e.g. 30 and 50% (data not shown). As shown in, FuncPatch and GP4Rate generally have similar powers in the four simulated datasets. More importantly, FuncPatch and GP4Rate are always among the most powerful methods. Therefore, FuncPatch is a good approximation to GP4Rate and the two methods are robust against different assumptions. More specifically, when the spatial correlation of substitution rates is present and the reference phylogenetic tree is small (), FuncPatch and GP4Rate could be more powerful than Rate4Site. When a spatial correlation of substitution rates is absent and the reference phylogenetic tree is small, FuncPatch is only marginally less powerful than GP4Rate and Rate4site (). When a large phylogenetic tree is used in simulations, the powers of FuncPatch and GP4Rate are very similar to that of Rate4Site regardless of whether the spatial correlation of substitution rates is present or not (). It is not surprising, since when the phylogenetic tree is large, each site in the alignment is informative and it is relatively easy to infer the site-specific substitution rate accurately based on the information at a single site. The 3D sliding window method is almost always among the least powerful methods in the four simulated datasets, which may be due to the difficulty of determining the optimal window size. In summary, the simulations demonstrate that FuncPatch is a good approximation to GP4Rate and may be a useful tool complementary to Rate4Site. In contrast, the performance of the 3D sliding window method is generally very poor.
Case study of MAPK1 genesTo demonstrate the power of FuncPatch in analyses with real data, we applied FuncPatch to four signal transduction-related gene families to predict conserved functional patches. As shown in the previous section of simulations, the performance of the 3D sliding window method is poor, so we only compared FuncPatch with GP4Rate and Rate4Site. In this section, we report the results of the MAPK1 (ERK2) gene family which is a central player in signal transduction. The MAPK1 gene family is a member of the mitogen-activated protein kinase (MAPK) superfamily. In the activation of the MAPK/ERK pathway, cell surface receptors are first activated by extra-cellular ligands and then the cell surface receptors activate a series of factors, including MAPKs (). MAPKs thus activate a variety of downstream transcriptional factors. We downloaded the protein sequences of 17 MAPK1 orthologous genes from the NCBI HomoloGene database (HomoloGene ID: 37670;). The dataset corresponds to a set of representative MAPK1 sequences collected from vertebrates, invertebrates, plants and fungi. We only included the MAPK1 subfamily in the analysis and excluded other MAPK subfamilies, because the biological functions of the MAPK1 subfamily may be different from the functions of other MAPK subfamilies and the locations of conserved functional patches might be different in different subfamilies. Therefore, the level of sequence divergence is relatively lowin this dataset, which makes it difficult to accurately infer sitespecific substitution rates in individual sites. The 17 MAPK1 protein sequences were aligned using MUSCLE (with default parameters. The phylogenetic tree was inferred using PhyML with the JTT+ model (). We used the X-ray crystallographic structure of the rat MAPK1 gene (PDB ID: 1ERK;) as the representative structure. We applied FuncPatch with default parameters to the MAPK1 dataset. As shown in, the best estimation of characteristic length scale is equal to 21 A  , which is much larger than 0. It suggests that spatial correlation of substitution rates is extended over a very long distance. The statistical significance of the spatial correlation of substitution rates is supported by the Bayesian model comparison. The approximate log Bayes factor (model 1 versus model 0) is equal to 148.7 which is significantly larger than the cutoff 8 (). To furthermore demonstrate that the cutoff 8 is valid, we randomly permuted the MAPK1 alignment 1000 times to generate a set of new alignments. The potential spatial correlation of substitution rates has been destroyed in these permuted alignments and we applied FuncPatch to them to generate a null distribution of the log Bayes factors. As shown in, only 2.6% of permuted alignments' log Bayes factors are greater than 8, which confirms that the cutoff 8 is conservative. Therefore, the spatial correlation of substitution rates is statistically significant in the MAPK1 dataset via both the Bayes factor and the permutations. We superimposed the 35 most conserved sites predicted by FuncPatch onto the protein structure of the rat MAPK1 gene (PDB ID: 1ERK). Because the MAPK1 dataset consists of 357 sites, the 35 sites correspond to the 10% of most conserved sites in MAPK1. As shown in, the 35 most conserved sites form a clearly bounded patch in the protein tertiary structure. The result is not surprising because the estimated characteristic length scale is very large. We further investigated whether this predicted conserved patch is related to MAPK1's activities. Interestingly, previous studies suggest that Asp-147, the second most conserved site predicted by FuncPatch, acts as the catalytic residue (). Therefore, the predicted conserved patch corresponds to the catalytic site of MAPK1. The high conservation of neighboring sites of Asp-147 suggests that these sites might be important to mediate the interaction between MAPK1 and its substrate proteins or maintain a suitable local environment for the kinase reaction. We also applied GP4Rate and Rate4Site to the MAPK1 dataset and mapped the 35 most conserved sites onto the protein tertiary structure of the rat MAPK1 gene (PDB ID: 1ERK). As shown in, GP4Rate reported essentially the same conserved patch as the one reported by FuncPatch. The consistency between FuncPatch and GP4Rate is not surprising, because the simulation study has already demonstrated that FuncPatch and GP4Rate have similar powers to identify conserved functional patches. However, FuncPatch took only about 1 CPU minute to analyze the MAPK1 dataset whereas GP4Rate took about 33 CPU hours to analyze the same dataset. Therefore, FuncPatch is orders of magnitudes faster than GP4Rate in the MAPK1 dataset. In contrast, the most conserved sites predicted by Rate4Site are very different from the conserved sites predicted by FuncPatch and GP4Rate (). Indeed, the most conserved sites predicted by Rate4Site are scattered in the protein tertiary structure and do not form any clearly bounded 3D patch. In addition, Asp-147, i.e. the catalytic residue, is not included in the 35 most conserved sites predicted by Rate4Site, even though it is invariant across all sequences in the MAPK1 alignment. The reason that Asp-147 is not included in the set of most conserved sites predicted by Rate4Site is that there are a number of invariant sites in the MAPK1 alignment. Therefore, it is difficult to know which one is more conserved than the others based on the information at individual sites. In contrast, FuncPatch models the spatial correlation of substitution rates and the invariant sites in the core regions of the conserved patches tend to have lower estimated substitution rates than other invariant sites scattered in the protein tertiary structure.
Case study of SMAD genesSMAD genes are important factors which mediate the transduction of signals from extracellular ligands to downstream factors (). We downloaded the protein sequences of 11 SMAD1 genes (HomoloGene ID: 21196), 9 SMAD5 genes (HomoloGene ID: 4313) and 10 SMAD8 genes (HomoloGene ID: 21198) from the NCBI HomoloGene database (). All these sequences are receptor-regulated SMAD (R-SMAD) genes regulated by bone morphogenetic proteins (BMPs) (). MUSCLE () with default parameters was used to generate an alignment based on the 30 SMAD proteins and then PhyML with the JTT+ model () was used to generate the reference phylogenetic tree. We did not include other SMAD genes in the NCBI HomoloGene database (), because these SMAD genes are either not R-SMAD genes or not regulated byBMPs and may have different functions from the BMP-regulated R-SMAD genes (). The RSMAD proteins consist of two domains, i.e. MAD homology 1 (MH1) and MAD homology 2, connected by a disordered peptide (Attisano and Tuen Lee-Hoeflich, 2001). We used the X-ray crystallographic structure of the MH1 domain in the mouse SMAD1 protein (PDB ID: 3KMP;) as the representative protein tertiary structure. We applied FuncPatch to the SMAD dataset to infer conserved functional patches in the SMAD MH1 domain. FuncPatch analyzed 124 sites in the SMAD alignment. As shown in, the estimated characteristic length scale is equal to 9 A  in the SMAD dataset. Because the estimated characteristic length scale is larger than 0, a spatial correlation of substitution rates may be present in the SMAD dataset. Indeed, the approximate log Bayes factor reported by FuncPatch is greater than the cutoff 8 (), which suggests A B. The 3D locations of the most conserved sites in the case study of the MAPK1 genes and the case study of the SMAD genes. A The 35 most conserved sites predicted by FuncPatch, GP4Rate and Rate4Site in the MAPK1 dataset (PDB ID: 1ERK). The blue sites are the predicted conserved sites while the yellow sites are not conserved. The space-filled atoms belong to Asp-147, the catalytic residue. B The 12 most conserved sites predicted by FuncPatch, GP4Rate and Rate4Site in the SMAD dataset (PDB ID: 3KMP). The blue sites are the predicted conserved sites while the yellow sites are not conserved. The space-filled atoms belong to an experimentally verified binding site (). The protein structures are visualized using Jmol (that the spatial correlation of substitution rates is statistically significant in the SMAD dataset. To test whether the cutoff 8 is valid in the SMAD dataset, we again generated 1000 permuted alignments based on the SMAD alignment and then applied FuncPatch to these permuted alignments to generate a null distribution of the approximate log Bayes factors. As shown in, none of the 1000 permuted alignments has a log Bayes factor larger than 8. Therefore, the cutoff 8 is conservative in the SMAD dataset. We superimposed the 12 most conserved sites predicted by FuncPatch onto the tertiary structure of the MH1 domain (), which correspond to the 10% of most conserved sites in the 124 analyzed sites. Obviously the most conserved sites predicted by FuncPatch are physically close to each other in the protein tertiary structure. In addition, most of these conserved sites overlap with the-helix 4 of the MH1 domain. A previous experimental study has already demonstrated that this region is a binding site which may interact with calmodulin and may contribute to the crosstalk between the calmodulin pathway and the SMAD pathway (). Therefore, the conserved region predicted by FuncPatch is supported by experimental evidence. We also applied GP4Rate and Rate4Site to the SMAD dataset. As shown in, the 12 most conserved sites predicted by GP4Rate largely overlap with the 12 most conserved sites predicted by FuncPatch. Therefore, FuncPatch is a good approximation to GP4Rate. However, FuncPatch took only about 6 CPU seconds to analyze the SMAD dataset whereas GP4Rate took about 4 CPU hours. Again, FuncPatch is orders of magnitudes faster than GP4Rate. In contrast, the 12 most conserved sites predicted by Rate4Site are scattered in the protein tertiary structure and do not overlap with the sites predicted by FuncPatch (). Therefore, FuncPatch identified an experimentally verified conserved region in the SMAD dataset which is overlooked by Rate4Site.
Case studies of MDM2 genes and RAS genesMDM2 genes and RAS genes are important players in signal transduction networks and many somatic mutations in these genes can be drivers of cancer progression (). Because MDM2 genes and RAS genes are important and well studied, we applied FuncPatch, GP4Rate and Rate4Site to infer conserved functional sites in these genes. We summarize the results in this section and more details are described in the Supplementary Material. In both of the two case studies, FuncPatch and GP4Rate predicted conserved patches while Rate4Site predicted spatially scattered conserved sites. It is not surprising, since Rate4Site implicitly ignores the possibility of spatial clustering of conserved sites in protein tertiary structures. In addition, the conserved patches predicted by FuncPatch and GP4Rate are essentially identical, which again confirms that FuncPatch is a good approximation to GP4Rate. However, FuncPatch is orders of magnitudes faster than GP4Rate. By comparing the predicted conserved sites with previous experimental studies, we found that many conserved functional sites predicted by FuncPatch are supported by previous experimental studies (). In contrast, only one conserved functional site predicted by Rate4Site is directly supported by existing experimental evidence. These results again highlight that FuncPatch may be a potentially useful tool complementary to Rate4Site.
DISCUSSIONRecently, we developed GP4Rate, a phylogenetic Gaussian process model which combines statistical phylogenetics and Gaussian processes to infer conserved functional regions in protein tertiary structures (). Our previous study has already shown that GP4Rate is a powerful method to infer conserved functional regions and is potentially a useful complementary to Rate4Site, but GP4Rate is a slow MCMC program. In this study, we present a new statistical method, FuncPatch, which is designed as a fast approximation to GP4Rate. While it takes from hours to days for GP4Rate to analyze a protein family, FuncPatch can finish a similar analysis within a few minutes. An intuitive web-based graphical interface of FuncPatch is available and makes it more accessible to experimental biologists. Both simulations and four case studies suggest that FuncPatch is an accurate approximation to GP4Rate. The simulations also show that FuncPatch may be a useful complementary to Rate4Site but the 3D sliding window method typically leads to bad results. The conserved patches predicted by FuncPatch in the four case studies are supported by experimental evidence. Therefore, we believe FuncPatch is a useful tool for analyzing protein families and guiding mutagenesis experiments. Unlike many other alternative methods, e.g. the 3D sliding window method, FuncPatch uses a Gaussian prior distribution which naturally captures the spatial correlation of substitution rates in protein tertiary structures. Therefore, it can infer the strength of the spatial correlation of substitution rates. In addition, a Bayesian model comparison method has been implemented in FuncPatch to test whether the spatial correlation of substitution rates is significant in a dataset. The four case studies of empirical data suggest that the strength of the spatial correlation may vary in different protein families and our preliminary analyses on a few other protein families also suggest that the spatial correlation of substitution rates may be insignificant in some protein families (data not shown). We believe that the ability of inferring the strength and significance of the spatial correlation of substitution rates is a significant advantage of FuncPatch over the 3D sliding window method. Our case studies in this work focus on four empirical datasets in which the divergence levels of sequences are relatively low. However, it is by no means the case that FuncPatch cannot be used to analyze datasets in which the sequence divergence level is high. As shown in the Supplementary Material, the site-specific substitution rates estimated by FuncPatch are strongly correlated with the rates estimated by Rate4Site in two large gene families each of which consists of highly diverged sequences. Together with the results in simulations, it seems that FuncPatch and Rate4Site typically give similar results when the sequence divergence levels are high. In practice, it is always helpful to include more sequences in the analyses, if it is believed that the sequences share the same conserved patches. However, functional divergence may happen after gene duplication (). Therefore, including remote homologs may reduce the power of detecting functional patches unique to an orthologous family. If researchers believe that a family of orthologous genes has distinct biological functions from its remote homologs, it is beneficial to infer conserved patches solely based on the family itself. The traditional methods, e.g. Rate4Site, may not be very powerful in this scenario because of the limited information about the substitution rate at each site. FuncPatch may alleviate the problem, because the Gaussian process prior used in FuncPatch can let an amino acid site to borrow statistical strength from neighboring sites with similar substitution rates. Therefore, FuncPatch is particularly useful for analyzing small gene families or gene subfamilies derived from recent gene duplication events.
The Author 2014. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
Y.-F.Huang and G.B.Golding at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
where D ij is the Euclidean distance between sites i and j, l is the characteristic length scale and is the signal standard deviation. l is a positive number, which measures the strength of the spatial correlation of the site-specific log substitution rates over the protein tertiary structure. A large l implies that the spatial correlation is strong while a small l implies that the spatial correlation is weak. is a positive number which measures the marginal variation of site-specific log substitution rates at a single site. It is easy to show that, in Equation (4), S ij decreases with increasing D ij , which implies that the closely located sites are more likely to have similar substitution rates than the distantly located sites. Therefore, the Gaussian prior distribution naturally captures our intuition that site-specific substitution rates are smoothly distributed over the tertiary structure. Similar to GP4Rate, FuncPatch introduces a very small amount of noise ('jitter' term) to the diagonal elements in the covariance matrix to ensure that its Cholesky decomposition is numerically stable. To connect the Poisson likelihood function with the Gaussian prior distribution, we assume that the relationship between i , i.e. the expected number of substitutions at site i, and  i , i.e. the log substitution rate at site i, can be described by the following equation, i = exp  i ; 5 where is the average number of substitutions calculated by Equation (2). In this parameterization, the site-specific substitution rate, i.e. exp  i , is a scaling factor, which is analogous to the substitution rate parameters in statistical phylogenetic models. By inserting Equation (5) into Equation (1) and then combining Equations (3) and (1), we obtain the posterior distribution of , Pjl; ; C; D |fflfflfflfflfflfflfflfflfflfflffl{zfflfflfflfflfflfflfflfflfflfflffl} Posterior $PjD; l;  |fflfflfflfflfflfflfflffl{zfflfflfflfflfflfflfflffl} Prior Y N i=1 PC i j exp  i  |fflfflfflfflfflfflfflfflfflfflfflffl ffl{zfflfflfflfflfflfflfflfflfflfflfflfflffl} Likelihood : 6 Note that the right-hand side of Equation (6) is proportional to the posterior distribution up to a constant Z which is the marginal likelihood of the observed data given the hyperparameters, i.e. l and. The posterior distribution is log concave, so it has only a single stationary point which is also the global maximum. FuncPatch uses the L-BFGS-B algorithm (Zhu et al., 1997) to find the global maximum of the posterior distribution and then uses a Laplace approximation to calculate the approximate posterior distribution of  and the approximate marginal likelihood Z (Rasmussen and Williams, 2005). The Laplace approximation uses the location of the global maximum in the posterior distribution and the second-order derivatives at the maximum to construct a Gaussian distribution to approximate the posterior distribution of  (Rasmussen and Williams, 2005). For each site i in X, the Laplace approximation can calculate E i and S i based on the approximate posterior distribution, where E i is the approximate posterior mean of  i and S i is the approximate posterior standard deviation of  i. We use exp E i  as the estimated substitution rate at site i and the interval expE i  0:6745S i ; expE i +0:6745S i  as the approximate 50% credible interval at site i, in which 0.6745 corresponds to the 75% quantile of the standard Gaussian distribution.
Fast Bayesian inference of conserved functional patches at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
