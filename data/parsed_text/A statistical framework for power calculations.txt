Motivation: ChIP-seq technology enables investigators to study genome-wide binding of transcription factors and mapping of epige-nomic marks. Although the availability of basic analysis tools for ChIP-seq data is rapidly increasing, there has not been much progress on the related design issues. A challenging question for designing a ChIP-seq experiment is how deeply should the ChIP and the control samples be sequenced? The answer depends on multiple factors some of which can be set by the experimenter based on pilot/prelim-inary data. The sequencing depth of a ChIP-seq experiment is one of the key factors that determine whether all the underlying targets (e.g. binding locations or epigenomic profiles) can be identified with a targeted power. Results: We developed a statistical framework named CSSP (ChIP-seq Statistical Power) for power calculations in ChIP-seq experiments by considering a local Poisson model, which is commonly adopted by many peak callers. Evaluations with simulations and data-driven computational experiments demonstrate that this framework can reliably estimate the power of a ChIP-seq experiment at different sequencing depths based on pilot data. Furthermore, it provides an analytical approach for calculating the required depth for a targeted power while controlling the false discovery rate at a user-specified level. Hence, our results enable researchers to use their own or publicly available data for determining required sequencing depths of their ChIP-seq experiments and potentially make better use of the multiplexing functionality of the sequencers. Evaluation of power for multiple public ChIP-seq datasets indicate that, currently, typical ChIP-seq studies are powered well for detecting large fold changes of ChIP enrichment over the control sample, but they have considerably less power for detecting smaller fold changes.
INTRODUCTIONNext-generation sequencing technologies produce tens of millions of sequence reads during each instrument run and are used to answer questions central to human diseases. Multiple NIH consortia (ENCODE, modENCODE, 1000 Genomes, Roadmap Epigenome) are pursuing mapping of transcription factor (TF) binding and epigenome in multiple tissues and developmental stages with ChIP-seq applications (). Analysis of ChIP-seq experiments involves comparing sequence reads from a ChIP sample to an appropriate control sample (e.g. chromatin input) to identify genomic loci/regions that exhibit enrichment in the ChIP sample compared with the input sample. Although there are 430 algorithms for analyzing data from ChIP-seq experiments (reviewed in), there has been little and mostly empirically driven efforts on the design of these experiments (). Identification of biologically interesting genomic regions can be hindered by background noise. Detection of these regions can be improved by sequencing more reads. The total number of reads from a sequencing experiment is referred to as the sequencing depth. Sequencing depths so far have been set empirically because of lack of a formal statistical framework, e.g. the ENCODE Consortium suggested using a minimum sequencing depth of 20 million (M) mapped reads for sequence-specific TFs (); however,recently concluded with empirical studies that the regularly adopted sequencing depth of 1520 M reads in humans may not be high enough.explored the impact of sequencing depths of ChIP samples using saturation analysis. This analysis evaluated the effect of sequencing depth on the number of peaks discovered by identifying peaks from reads sub-sampled at varying proportions from the original ChIP sample. The proportion of sub-sample peaks that overlap the peaks from the full set is plotted against the sub-sample depth. When this curve reaches a horizontal asymptote, it indicates that the set of detected enrichment sites has stabilized at the current depth. Although this computational approach is useful for evaluating the available sequencing depth of a ChIP sample, it has three major drawbacks: (i) it is not suited for addressing how many more reads are needed if saturation has not been reached at the available depth [e.g. in a recent ENCODE publication (), RNA Pol II, which mainly interacts with DNA across genes, exhibited a nearly linear gain in the number of peaks through 50 M reads with no indication of how many more reads are needed for saturation]; (ii) it only evaluates saturation based on the ChIP sample and discards the control sample; and (iii) it only allows investigating saturation from the point of either a minimum fold-enrichment or false discovery rate (FDR), but not both. *To whom correspondence should be addressed.Addressing the question of sequencing depth requires (i) defining a statistical criterion that can quantify the information loss of an experiment because of its apparent sequencing depth and (ii) determining the sequencing depth needed to control the information loss based on a pilot, possibly undersequenced, dataset. From a statistical point of view, ChIP-seq peak calling procedures can be cast as multiple testing problems because they aim to assess whether data for each candidate locus is supported by the background noise distribution or the ChIP signal. Therefore, the information loss is naturally connected to the concept of the testing power. As a result, both of the aforementioned issues can be considered within a power calculation framework where the sequencing depth plays the role of sample size. Power computations require modeling distribution of both the background reads and ChIP signal in a way that reflects the stochastic nature of read accumulation at each genomic locus as a function of sequencing depth. Although a number of models were proposed for locus-specific read counts, none of them explicitly accounted for read accumulation.considered models with locally Poisson distributed background and did not model ChIP signal.proposed a flexible model taking into account the genome structure and overdispersion. However, this model used the input sample as a covariate and did not explicitly parametrize the model in terms of sequencing depths.proposed a hierarchical Bayesian t-mixture model to identify local concentration of directional reads, but did not consider the relationship between read accumulation and sequencing depth.adopted a signal-to-noise model, parameters of which followed some arbitrary prior distribution to account for intrinsic read bias. Although such a prior distribution, if estimated, could be utilized to model the background distribution at varying sequencing depths, the work ofexclusively focused on the normalization aspect of ChIP-seq analysis. We developed CSSP (ChIP-seq Statistical Power) framework for statistical power calculation by considering a local Poisson model for the read generation process. We assume that background reads in the ChIP and the input samples are generated by local Poisson processes with shared Gamma prior distributions. The corresponding Gamma parameters are modeled as functions of the local genome structure, including mappability and GC content. The local Poisson parameters for the enrichment signals follow convolution of Gamma distributions. This model preserves the local structure of themodel while keeping the negative binomial distribution as the marginal signal distribution as in. Such a local structure is key for capturing dynamics of the counting process for individual genomic locus as a result of increasing sequencing depths. We introduce a conditional power definition that uses the practically used notion of fold change of ChIP signal over the control input sample. We show with data-driven computational experiments that our approach can be used to determine (i) the apparent conditional power for a given sequencing depth; (ii) the required sequencing depth to achieve a target power while controlling the FDR at a specified level. Simulation experiments based on a deeply sequenced Escherichia coli dataset indicate that power predictions of our model agree well with the observed empirical power. Using data from pilot studies, we can reliably estimate power for larger sequencing depths; thus, the CSSP framework has significant implications for designing ChIP-seq experiments with the multiplexing functionality. Finally, we study the power of multiple ENCODE datasets with varying sequencing depths. Our results illustrate that, although the power varies considerably with the signal-to-noise ratios of the datasets, the current sequencing depths have high power for proteinDNA interactions with large effect sizes and are generally adequate for smaller effect sizes. Our calculations are further supported by the data quality metrics proposed by the ENCODE project ().

METHOD
The CSSP frameworkOur CSSP framework models read counts from ChIP-seq data as Poisson processes with Gamma prior distributions. We assume that the uniquely mapping reads of both the ChIP and the input samples are pre-processed by the commonly adopted method of extension to the average fragment length provided by the experimental design (). For modeling purposes, we divide the reference genome into n non-overlapping intervals, e.g. bins as in, with sizes set to the average fragment length. Let X i and Y i denote the number of extended input and ChIP sample reads overlapping the ith bin, respectively. Let N x and N y denote the sequencing depths for input and ChIP samples. We assume that X i and Y i follow Poisson distributions (): X i j l x i  $ Poisl x i N x , Y i j l y i  $ Poisl y i N y , 1 where l x i and l y i are bin-specific rate parameters for the input and ChIP samples, satisfying E  P i l x i   1 and E  P i l y i   1, where the expectations are with respect to the prior distributions that we introduce later in the text. This formulation models bin counts as Poisson processes with fixed intensities. Let Z i be the vector containing local genomic information, such as mappability and GC-content as infor the ith bin. We consider the following bin-specific prior distributions for local Poisson intensities of the input sample:where 0 is a normalization constant such that P n i1 z i   1 and f : is a function of local genomic information. We adopt the flexible smoothing spline framework as infor capturing the effect of mappability and GC by f : on the input read counts. For the ChIP sample, we define an unobserved variable B i to indicate enrichment state of bin i, e.g. B i  0, for background bins. For enriched bins, we allow J different states to reflect levels of enrichment strengths (e.g. J  2 broadly captures low-and high-affinity binding for TFs), and correspondingly B i  j, j  1,    , J. The prior distributions for each state aresize. Under this model specification, the marginal distributions of X i and Y i are negative binomials given by:X i $ NB a, a i N x , Y i j B i  0 $ NB b, b e 0 i N y , Y i j B i  j $ NB b j , b j j N y , j  1,    , J: 4In contrast to the Kuan et al. (2011) model, marginal distributions in our model arise from two levels of hierarchy: a local Poisson distribution and a prior distribution. The local Poisson structure is critical for modeling counts for each bin on a process level as sequencing depths increase. The prior distribution models the intrinsic read biases, which are supported by arguments inIn the resulting model, although the number of local Poisson parameters l y i s is the same as the number of observations, inference is possible through Bayesian analysis where the posterior distribution of the ChIP counts for each bin given the bin count y i and enrichment state B i  j is given by:,    , J: Determining the number of components J is a model selection problem within the CSSP framework. In practice, we recommend setting J to 2.observed that when modeling the ChIP signal as a mixture of negative binomial distributions, two components adequately captured both the low-and high-affinity binding. Our R package enables using larger values of J and users can apply model selection criterion, such as Bayesian Information Criterion () to control model complexity. We used J  2 for the examples presented in this article.
A multiple testing procedure and power evaluationThere is a plethora of algorithms for assessing whether individual bins are enriched in the ChIP sample compared with input sample (). Our CSSP framework naturally lands itself into a multiple testing framework. For unenriched bin i, the ChIP count originates from negative binomial distribution, Y i $ NBb, b=e 0 i N y , and ChIP counts for enriched bins have larger values. Therefore, we consider onesided testing against the null H 0 : Y i $ NBb, b=e 0 i N y . Under the prior distribution for the local Poisson rate, the decision rule based on the marginal distribution achieves optimal Bayes risk. The P-value for Y i  y i is thus Pvaly i   PfY i ! y i j Y i $ NBb, b=e 0 i N y g. Suppose we control the overall Type-I error at q and reject the null hypothesis when Pvaly i 5 q. The corresponding rejection region for bin R i is Q i  q , 1 where Q i  q  is the 1  q -th percentile of the null distribution. To control the FDR, we set q using the BenjaminiHochberg procedure (). The mean power of the aforementioned testing procedure across all enriched bins is given by#fi : B i 6  0g :This definition of power nominally considers all enriched regions regardless of their actual enrichment levels, i.e. effect sizes. However, in practice, investigators expect true proteinDNA interaction regions to not only exhibit statistically higher read counts in the ChIP sample compared with the input sample but also achieve a pre-determined enrichment level. Regions failing to achieve this are usually filtered by peak callers (i.e. SPP and MACS) through post-processing. The statistical implication of such a practice is that in testing the observed ChIP count Y i against the background distribution, we should impose restriction on the effect size in addition to a P-value threshold. As a result, when evaluating the power across all enriched regions, our attention should be restricted to only the enriched regions with sufficiently large effect sizes. We introduce quality thresholds, including a fold change threshold r and a minimum intensity threshold , to accommodate this practical issue. As a result, the enrichment detection procedure requires that read counts exceed not only the corresponding percentile Q i  q  required for FDR control but are also r fold of the prior mean e 0 i N y and exceed minimum intensity of N y. Hence, the peak calling threshold for bin i iswhere x _ y  maxx, y. As a result, we establish the following conditional power function:where A  fi : l y i 4re 0 i _ , B i 6  0g, and #A denotes the size of set A. This definition depends on local Poisson parameters, which are usually not estimable. We propose the following conditional posterior power function by plugging in Bayesian estimators of the numerator and denominator of Equation (7), respectively. A numerical algorithm to compute (8) is presented in Supplementary Materials Section A.where w i  Pfl y i 4re 0 i _ , B i 6  0 j Y i  y i g.
Estimating the model parametersWe present the details of the overall model fitting procedure in Supplementary Materials Section B and highlight a few key points here. The parameters in CSSP are estimated based on the marginal distributions of the ChIP and input read counts in three consecutive steps. First, we estimate hyper parameters in f : by fitting a negative binomial regression model to the input sample. This is easily carried out with the glm.nb() function in R. Second, we estimate the normalization factor e 0 , the proportion of background bins 0 and the dispersion parameter b from the ChIP sample. These parameters normalize the ChIP sample against the input sample and are critical for the downstream power evaluation. We observed that the conventional estimating methods, e.g. maximum likelihood and method of moments, lead to poor estimators of 0 and b (Supplementary Materials Section D). Therefore, we propose the following minimum distance estimator, which is motivated by the minimum distance and robust estimation framework in Parr and Schucany (1980) as an alternative. Let F n : denote the empirical distribution of Pvaly i  derived from initial estimators of e 0 and b. If we plug in the true values and apply continuity adjustment (Lemma 1, Supplementary Materials Section B), F n should be a mixture of uniform distribution between 0 and 1 arising from background bins and a point mass concentrated near 0, representing P-values from enriched bins. In other words, when x4c for some tuning parameter c, F n x % 0 x  1  0 , where 0 denotes the proportion of unenriched bins. Then minimum distance estimators of e 0 , b and 0 are given byFinally, we apply a generalized expectation-maximization algorithm as into estimate the signal parameters j and b j , j  1,    , J.
RESULTSWe first evaluated our CSSP framework in a simulation study to assess the consistency of our parameter estimates, power and FDR control (Supplementary Materials Section C). Then we performed sub-sampling experiments based on two deeply sequenced datasets [E.coli FNR ChIP-seq dataset of Myers et al. (2013) and mouse GATA1 ChIP-seq dataset of Wu et al.] to demonstrate the consistency and power of our CSSP framework. We used multiple human CTCF ChIP-seq datasets from the ENCODE consortium to evaluate the impact of laboratory and laboratory-specific batch effects on power estimation. Finally, we investigated eight ENCODE datasets to assess the power of currently available typical ChIP-seq studies.
Model fit for deeply sequenced dataThe E.coli FNR dataset consists of 9.07 M 32mer single-end ChIP and 6.45 M input reads. These sequencing depths approximately correspond to 4.9 and 3.5 billion reads for the mappable human genome (). The GATA1 dataset from G1E-ER4  E2 cell line is also deeply sequenced compared with many available mammalian ChIP-seq datasets and has 106.4 M 55mer and 15.6 M 36mer reads for the ChIP and input samples, respectively. For both of the datasets, we created bin level data by extending aligned reads to the average fragment length provided by their experimental protocols (150 bp for FNR and 250 bp for GATA1) and counting the number of reads overlapping every bin. Fitted probabilities of bin-level counts are compared with their empirical frequencies inand b, for FNR and GATA1 ChIP samples, respectively. Both figures show good agreement between the fitted and empirical frequencies. In addition, we plot the empirical cumulative distribution of the P-values obtained under the fitted background distributions inand d. Both of the empirical distributions exhibit an expected mixture pattern where the majority of the P-values follow a uniform distribution between 0 and 1. We note here that, for the GATA1 dataset, the ChIP and input samples have different read lengths. This indicates that our assumption of the same background prior distribution for the ChIP and input samples may not hold. However, the resulting model fits, as well as the computational experiments of the latter sections, suggest that the power estimation is robust against this type of mis-specified background estimation. This is partly because GC score is not affected by the read length, and the mappability remains the same for majority of the bins (% 95%) between read lengths 36 and 55 bp. We discuss mis-specifications in background estimation in more details in Supplementary Materials Section E.
Evaluating the accuracy of the power curve estimated based on pilot dataNext, we evaluated the consistency of CSSP power estimation when only low-sequenced pilot data are available. For both the FNR and GATA1 datasets, we generated a power curve at various sequencing depths using parameters estimated from the full data. We set the quality thresholds as r  2 and  0. Because both datasets are deeply sequenced, their corresponding power curves can be viewed as oracle or gold-standard curves. To simulate low-sequenced pilot datasets, we sampled 0.5, 2 and 6% (FNR) and 20, 40 and 60% (GATA1) of the available ChIP and input data and refitted the models. The lowest sampling percentages of 0.5 and 20% were chosen because sub-samples with depths lower than these resulted in non-convergent parameter estimators in the CSSP model. Both of these lowdepth sub-samples had an average bin-level ChIP count of 2.5. We generated 20 independent sub-samples at each sampling percentage for both datasets. The power estimates from subsampled data are compared with the oracle power estimates inand b. We observed that our power estimates based on under-sequenced GATA1 data agreed well with the oracle power curve. For the FNR dataset, when we sub-sampled 56% of the full dataset, the predicted power was biased at low-sequencing depths and agreed well with the oracle curve as the sequencing depth got larger. The mean biases of the power estimates were 0.009 and 0.015 for the 6% FNR and 20% GATA1 sub-sample datasets, respectively. The overall implications of these experiments are significant, as they indicate that our power framework is capable of reliably estimating the required depth for a target power when only undersequenced data are available.
Predicted power versus empirical powerThe aforementioned comparisons thus far relied on theoretical calculations of the power based on our model fit. We next compared our theoretical power predictions with the empirical power(7) is unknown, we obtained gold-standard peak sets for both datasets using the full dataset with FDR of 0.05, r  2,  0 and considered these gold-standard peak sets as proxies for the true set of enriched regions. Then, we generated 20 independent subsamples at varying proportions of the full sequencing depth (220% for FNR and 2090% for GATA1). For each sub-sample, we generated the list of enriched regions that were significant at FDR-adjusted significance levels and had at least 2-fold enrichment against the estimated background mean (r  2). We then calculated the proportions of the gold-standard peak sets that overlapped with the sub-sample-based peak sets. We report the empirical power by multiplying these proportions with the power at the full sequencing depths, as the full depth power was used as a proxy for Equation (7).and b displays the boxplots of empirical power as a function of sequencing depth and compares the empirical power with the oracle power curve. In both cases, the empirical power follows the CSSP power estimates closely.
Impact of the control sample on power calculationsThe sequencing depth of the input library is an important factor that influences the power of ChIP-seq experiments. Our computational experiments thus far varied ChIP and the input samples simultaneously.observed identification of more peaks when a ChIP-seq dataset was normalized against a more deeply sequenced input dataset. Furthermore, this study also observed that deeply sequenced input datasets correlated well with the GC content.concluded that deeper sequencing of the input sample led to better detection specificity. These studies also established that the dependence on the sequencing depth of the input sample varied substantially between different algorithms. For example, MACS () achieved best performance when the ChIP and the input samples were balanced in terms of sequencing depths, whereas USeq () performed better when more input was sequenced compared with ChIP sample. To assess how the CSSP power estimates are influenced by the sequencing depth of the input sample, we evaluated the power from FNR sub-samples by varying the input sequencing depth as a percentage of the full depth at three levels of 0.4, 2 and 20% and fixing the ChIP sample depth at 6%. In, we compare the resulting estimated power curves to the oracle power curve. We performed a similar experiment with the GATA1 dataset where we used 1, 2 and 4% of the input sample and 20% of the ChIP sample. We observed that varying depths of the input sample had little effect on our power calculations as long as the model parameters are reliably estimated. This is due to the fact that the input sample is only used to estimate prior mean for the background intensity, whereas estimation of the parameters regarding the ChIP signal intensity ( j ) and normalizing effects (e 0 , b) mostly rely on the ChIP sample. We observed that the estimation algorithm encountered convergence problems at extremely small depths, which would be considered as lowquality data by the currently used ChIP-seq data quality standards. Our analysis suggest that if the normalization is done in a similarly efficient fashion for other peak callers, the effect of input on their performances might also be minimized, as the background distribution alone can be captured using lower depth input samples. To illustrate this point, we compared the set of enriched bins identified at sub-sampled ChIP and input data at different combinations of depths at an FDR of 0.05 with the quality thresholds set as r  2 and  0. For fixed ChIP samples, the set of identified enriched regions remained consistent at varying input depths (Supplementary). Overall, thissupports that increasing the sequencing depth of the input beyond what is required for estimating the background parameters does not lead to power gain.
Impact of laboratory and batch effectsOur computational experiments thus far focused on the effect of increasing the sequencing depth while keeping other experimental factors, i.e. laboratory and batch effects, fixed. Such effects almost always exist when pilot data are used for designing future experiments. To investigate their effects on power prediction, we analyzed seven CTCF ChIP-seq datasets from the GM12878 cell line. These datasets were generated by four different laboratories within the ENCODE consortium (The ENCODE). Each laboratory sequenced two to three individual cultures of GM12878. Samples within a laboratory differed in one or more of the following aspects: person and/or date for preparation of the cell cultures, cross-linked DNA and Illumina sequencing libraries; sequencing machine; and date of sequencing. The total number of reads, as well as the data quality metrics for each dataset, is summarized in Supplementary Table S3. To shorten computation time, we focused on chromosome 1. We sampled ChIP reads from each original dataset so that each pilot dataset had the same number of reads as the lowest sequenced dataset. Then, we extended the reads to average fragment lengths estimated by the R package SPP () and mapped them to bins of size 100 bp. Finally, we paired each ChIP sample to its matching input and fitted the CSSP model. We generated power curves with quality thresholds of r  2, 5, 10 and  0 at sequencing depths ranging from 10 6 to 4  10 6 (Supplementary). We computed the differences in predicted power between samples within the same and across different laboratories at each sequencing depth.illustrates that laboratory effects are more prominent than batch effects within the same laboratory, and both effects decrease when the fold change threshold increases. Supplementaryhighlights that the minimum fold change at which the batch effects are small is laboratory dependent. However, even at the small fold change of two, the maximum absolute and relative differences in power between different batches from the same laboratory are 510 and 30%, respectively. Although our study of the laboratory and batch effects is hampered by the lack of designed experiments for specifically investigating these effects, this limited study on CTCF confirms that although batch effects are difficult to control, controlling the laboratory effects by using pilot data from the same laboratory should result in better power prediction.
Power estimation for a set of recent ChIP-seq datasetsWe applied the CSSP framework to evaluate the power of eight ChIP-seq experiments generated by the ENCODE project (). Datasets included ChIP-seq profiling of GATA2, cFos, cJun and Pol II in Huvec and K562 cell lines. We merged replicates within experiments and removed abnormal reads using the R package SPP (). The remaining uniquely mapping reads were extended to 200 bp and mapped to bins of size 200 bp. We note that these datasets have much lower sequencing depths than the FNR and GATA1 experiments, with an average bin count of 5. For computational reasons, we fitted the CSSP model for each chromosome separately. To restrict our attention on high-quality peaks, we set the quality threshold to be equivalent to the 99th percentile of the ChIP bin count intensity l y i estimated using the posterior distributions in Equations (5) and (6), i.e. determined byThe estimated N y ranged between 10 and 20 counts across all experiments. We set the fold change threshold r at different levels of 2, 5 and 10. The numbers of final set of used reads, as well as the genome-wide power are shown in. Further results on these analyses are available in Supplementary Table S4.(b)Absolute differences in predicted power are computed at various sequencing depths for CTCF ChIP-seq samples from(a) same laboratory and (b) different laboratories
C.Zuo and S.Keles758Keles
Keles758The estimated powers were generally 480% indicating that 480% of true enriched regions that meet our fold change and minimum intensity thresholds were identified. We evaluated robustness of these power calculations with simulations in Supplementary Materials Section H (Supplementary). The estimated power, in general, should increase as sequencing depth increases. However, when comparing power estimates across different experiments, quality of the individual datasets should be considered. We investigated the sequencing quality metrics of these datasets provided by the ENCODE consortium (Supplementary) and corroborated implications of these metrics with our power results. For cFos and cJun, SPOT and PBC values are comparable for both cell lines, reflecting comparable data quality. As a result, power estimates for the deeper sequenced Huvec samples are higher. For Pol II, SPOT values of Huvec, which are reflective of the signal-noise ratio, are a lot smaller than those of K562. Hence, for Pol II, although the sequencing depth of the Huvec dataset is almost twice of the K562, K562 sample has higher or comparable power.
Power implications for other peak callersAlthough the CSSP framework uses a specific peak calling procedure based on testing against background read distribution and quality thresholding, power estimated by CSSP has implications for other peak callers. To illustrate this, we considered one of the commonly used peak callers SPP (), which is also adopted by the ENCODE project. The key to adapting CSSP power estimation to SPP is to identify quality thresholds r and that would correspond to the analysis generated by SPP at the same FDR level. To enable this comparison on the ENCODE datasets, we used the enriched regions identified by SPP and set the r and parameters based on data from these regions. Specifically, to set , we mapped the filtered reads to 200 bp regions surrounding the binding sites identified by SPP, and then set N y as the minimum ChIP count across these bins. Similarly, we set rN x =N y to the minimum ChIP to input count ratio of these bins to estimate r. We then applied the CSSP model with these r and estimates driven by the SPP analysis. We evaluated how well the set of enriched regions from CSSP and SPP agreed with the idea that, for datasets with good agreement, the CSSP power would yield an upper bound for the SPP power (). In addition to imposing the fold change and minimum count thresholds, SPP further filters the set of enriched regions based on the symmetry of the read distributions around each enrichment site; therefore, it is more conservative than CSSP. For the four datasets where the overlap percentages between CSSP and SPP exceeded 90%, CSSP estimated power presents upper bounds for the SPP power. For the other four experiments, 415% of SPP peaks are not captured by the CSSP model. We noticed that these four experiments either have lower data quality or sequencing depths, and the discrepancy between the two peaks caller might due to low signal-to-noise ratios or different FDR control procedures and requires further investigation.
DISCUSSIONThe sequencing depths of most, if not all, initial published experiments have been limited by practical considerations, such as cost or instrument availability. With decreasing sequencing costs, considerations are shifting from how many sequences should be obtained for a single experiment, to how many experiments one can perform in a single lane. Therefore, power calculations are extremely important for ChIP-seq experiments. We have developed the CSSP framework to enable such power calculations. This framework can be applied to compute power at a wide range of sequencing depths with varying fold change and minimum intensity thresholds. Our extensive computational experiments demonstrated the consistency in predicting power from pilot data and its practical implications. To the best of our knowledge, this is the first model that enables power analysis for ChIP-seq data through an analytical approach. It is worth noting that although our calculations mostly emphasize the sequencing depth N y , other parameters including e 0 and j , which indicate the signal-to-noise ratio of the data, as well as the data quality are also important factors of the power analysis. These parameters are fixed when comparing datasets obtained under the same experimental conditions. However, for comparing datasets with different experimental conditions, such as TF and cell line, effects of data quality and strengths of enrichment signals should bear equal emphasis. Our limited investigation of the laboratory and batch effects indicated that laboratory effects are larger than batch effects within a laboratory, and that pilot data from the same laboratory would yield more unbiased power prediction than pilot data from another laboratory. Although the analytical calculations in the CSSP framework depend on the peak calling procedure implied by our model, theOverlap proportion was calculated as the proportion of SPP peaks that are among the CSSP peaks. The SPP peaks were constructed by extending each peak of SPP by the estimated 'half window size' () in both of the 5 0 and 3 0 directions.
ChIP-seq statistical powerpower estimation has broad applications for other peak callers. In general, if the peaks identified by the peak caller can also be identified by CSSP at the same FDR level and at certain fold change and minimum enrichment thresholds, then the power evaluated at these thresholds can serve as the upper bound for that peak caller. When peaks identified by a peak caller are vastly different than that of the CSSP, our power results can not directly be related to that peak caller. Analyzing the power for an arbitrary peak caller requires specialization of our algorithm. Overall, as the CSSP peak calling procedure is simpler than most existing peak callers, our power estimation can serve as a benchmark for other peak callers. The CSSP framework also enables the investigation of the impact of input sequencing depth on power. Our computational experiments indicate that increasing the input depth does not increase the peak calling power or the accuracy of power prediction. The impact of input depth is, to a large extent, determined by how the ChIP read counts are normalized against input read counts, a procedure that highly varies among peak callers. Overall, our results suggest that if the ChIP sample is normalized efficiently against the input data, the dependence of power on input depths may be reduced.
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
3 where e 0 2 0, 1 is a normalizing factor reflecting the proportion of background reads in the ChIP sample (Liang and Keles,Keles, 2012; Xu et al., 2010). For brevity, we denote z i  by i by suppressing its dependence on z i , which is fixed for a genome at given read and fragment lengths and bin
C.Zuo and S.KelesatKeles Kelesat :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
ChIP-seq statistical power at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
