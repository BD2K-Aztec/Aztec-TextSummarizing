Non-linear calibration is a widely used method for quantifying biomarkers wherein concentration-response curves estimated using samples of known concentrations are used to predict the bio-marker concentrations in the samples of interest. The R package nCal fills an important gap in the open source, stand-alone software for performing non-linear calibration. For curve fitting, nCal provides a new implementation of a robust, Bayesian hierarchical five-parameter logistic model. nCal supports a simple graphical user interface that can be used by laboratory scientists, and contains functionality for importing data from the multiplex bead array assay instrumentation. Availability: The R package 'nCal' is available from http://cran.r-pro ject.org/web/packages/nCal/ under GPL-2 or later. Contact: yfong@fhcrc.org Supplementary information: Supplementary information is available in the form of an R package vignette at the above repository and an FAQ at http://research.fhcrc.org/youyifong/en/resources/ncal.html.
INTRODUCTIONNon-linear calibration is a widely used method for quantifying biomarkers in biomedical studies. There are two stages in nonlinear calibration. In the first stage, a concentration-response curve is estimated for each assay run using observed outcome for standard samples with known concentrations. An assay run refers to a batch of samples run closely in time and space, e.g. all samples run on a single microplate. In the second stage, point estimates and confidence bounds are estimated for the biomarker concentrations in the samples of interest. Many laboratories use commercial software for performing non-linear calibration. These include general purpose programs like GraphPad Prism and StatLIA, as well as assay-specific programs like MasterPlex and Bio-Plex Manager for the multiplex bead array assay, which is becoming a common assay for quantifying protein concentrations. Besides being expensive and hard to automate, these programs provide relatively simple singlecurve fitting methods. Furthermore, they often lack proper precision estimates for the estimated concentrations. The R package nCal provides two sets of curve-fitting methods. The first, implemented through another R package drc (), is an estimating equation-based method that is equivalent to those available from most existing non-linear calibration software. The second, implemented within nCal, is a robust Bayesian random effects model-based approach (). It allows borrowing of information across multiple assay runs for the same biomarker, incorporates prior information regarding the curve-to-curve variability and provides flexible models for the experimental noise. After obtaining a curve fit via either approach, nCal estimates the biomarker concentrations in the samples of interest and computes variance estimates for the estimated concentrations. nCal does not have as extensive a graphical user interface as its commercial counterparts do, but it does contain a simple graphical user interface based on the R package gWidgets that allows non-R users to perform non-linear calibration. nCal also provides a function that imports data from the Excel files of Luminex  results that have been output by a Bio-Plex instrument's software.
METHODSSigmoid-shaped concentration-response curves can be approximated well by five-parameter logistic (5PL) curves. Let Y ik denote the experimental outcome, where i indexes assay runs and k indexes standard samples. Let f 5PL ; i   denote the 5PL function with parameter i. Estimating equation-based methods solve the following optimization problem for each assay run:where g is a penalty function. For least square method, g x    x 2 ; for robust method, g x   can be x j j, a trim function or a winsorization function (). The estimated concentration for a sample with observation y is then ^ t y;A Bayesian random effects 5PL model was considered by Fong et al.(2012) and Davidian and Giltinan (1995) and can be described as follows.i is assumed to have a multivariate normal distribution with mean 0 and precision. The experimental noise " ik can be modeled as having a normal distribution; for robust methods, it can be modeled as having a Student's t-distribution, a mixture of two normal distributions or a latent first-order autoregressive process (). We assume weakly informative priors on 0 and the parameters of the noise distribution, and substantive priors on (). The hyperparameters are listed in the Supplementary Information. Posterior samples are drawn using Just Another Gibbs Sampler (JAGS) (). We take the median of the posterior samples of i to be its point estimate, and the median of the posterior samples of f 1 5PL y; i  to be the estimated concentration for a sample with observation y. As in, the variance of the estimated concentration can be decomposed into two components. The first component assumes that the concentration-response curve is perfectly known and the variability comes from the variability of y. It can be estimated as ^ 2 @f 1 5PL y; ^ i =@y n o 2 for both sets of curve fitting *To whom correspondence should be addressed.  The Author 2013. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com methods, where ^ 2 is the estimated variance of the experimental noise. The second component assumes that y is perfectly measured and the variability comes from the variability of the curve estimate. For the estimating equation-based methods, it can be estimated byis the estimated variancecovariance matrix of ^ i. For the Bayesian random effects model-based methods, it can be estimated by the variance of the posterior samples of f 1 5PL y; i  .
EXAMPLE SESSIONSWe illustrate the use of nCal through two examples (see Supplementary Information for the complete R code and more detailed explanation of the output). In the first example, we simulate a dataset with one assay run and four samples of interest. To perform non-linear calibration, we call 4 resncal(log(fi) $expected_conc, dat, bcrm.fitTRUE)The Boolean argument bcrm.fit controls whether to use bcrm, which implements the Bayesian random effects model, or drm from the drc package, which implements the estimating equation methods for curve fitting. res is a data frame, each row of which corresponds to one sample of interest. ncal also creates a plot with four panels (Supplementary Information nCal vignette Supplementary), showing the curve fit, the estimated concentrations for the samples of interest and the precision profiles. From the two figures, we see that both curve fitting methods lead to similar calibration results for this example. In the second example, we analyze a dataset containing four assay runs, one of which is affected by multiple outliers. 4 fit.bcrmbcrm(log(fi) $expected_conc, dat, error.model''gh_t4'', informative.priorT) 4 for (i in 1:4) { fit.drmdrm(log(fi) $expected_conc, data dat, subsetassay_idpaste(''Run'',i), fctLL.5(),robust''median'') plot(fit.drm, type''all'', mainp) plot(get.single.fit(fit.bcrm, paste(''Run'', i)),addT) }shows that the two methods produce similar results for Runs 1, 3 and 4, but differs significantly for Run 2.also shows the curve fits by Prism with the robust option. By borrowing information across assay runs, bcrm appears more successful at reducing the influence of multiple outlying observations than drm and Prism.
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
Y.Fong et al. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
