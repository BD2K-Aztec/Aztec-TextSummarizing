Motivation: Genomic analyses of many solid cancers have demonstrated extensive genetic heterogeneity between as well as within individual tumors. However, statistical methods for classifying tumors by subtype based on genomic biomarkers generally entail an all-or-none decision, which may be misleading for clinical samples containing a mixture of subtypes and/or normal cell contamination. Results: We have developed a mixed-membership classification model, called GLAD, that simultaneously learns a sparse biomarker signature for each subtype as well as a distribution over subtypes for each sample. We demonstrate the accuracy of this model on simulated data, in-vitro mixture experiments, and clinical samples from the Cancer Genome Atlas (TCGA) project. We show that many TCGA samples are likely a mixture of multiple subtypes.
INTRODUCTIONGenomic analyses of many solid cancers have demonstrated extensive genetic heterogeneity between () as well as within individual tumors (). Microdissection and DNA sequencing have recently validated at high resolution the existence of intratumor heterogeneity (). Characterizing such heterogeneity is important because it may be a contributing factor to mono therapy treatment failure (). Accurately detecting subtypes in an individual tumor may lead to improved combinatorial therapies. Many cancers have been classified into distinct genetic subtypes that develop by means of activation or repression of different driver pathways. These tumor subtypes are commonly identified and characterized by clustering the genomic data from hundreds of samples (). In an effort to disambiguate driver from passenger mutations, the genomic signatures associated with each subtype are sparse and comprised only of those aberrations that are thought to be involved in oncogenesis. New tumors are then classified based on their similarity to the centroids or signatures of those subtypes. However, this classification approach makes an all-or-none assumption about the primary tumor that is incorrect for heterogeneous tumors. Mixture models have been used extensively to analyze gene expression patterns in complex experiments. Gasch and Eisen (2002) used fuzzy k-means clustering to identify functionally co-regulated transciptional networks.took a less heuristic non-negative matrix factorization (NMF) approach to decompose the gene expression data matrix into a product of a meta-gene matrix and a sample weight matrix. The NMF approach was extended to allow for sparseness in either of the factor matrices (). Mixed-membership models have emerged in recent years as a tool for data where the all-or-none clustering assumption is inappropriate. In text classification, the topic-modeling framework, which includes mixed-membership models, captures the structure in large document corpora, where each document may exhibit a mixture of topics (). Mixed-membership models have been used in population genetics (), social network analysis (), and elsewhere (). Our model achieves the dual purposes of (i) representing each sample as a mixture of genomic subtypes, and (ii) representing each subtype signature as a sparse set of genomic features that delineate driving oncogenic pathways. Our model provides a more general framework for representing mixed samples than all-or-none classification methods and we show that we obtain a more accurate estimate of mixture proportions than a mixedmembership model without subtype sparsity. We demonstrate our model on RNA expression data from primary glioblastomas (GBM), comprising thousands of genomic features and hundreds of samples. There we show that we recover known subtypes with a sparse set of driving aberrations, and we give evidence that many of the primary samples are mixed.
MODEL STRUCTUREWe are given a data matrix y 2 R M  N , where the element y ji is an observation of feature j in sample i. We would like to *To whom correspondence should be addressed.
yThe authors wish it to be known that, in their opinion, the first two authors should be regarded as Joint First Authors. represent each column of y as y i = x i , where x 2 R M  K is a matrix of K cluster centroids and i 2 " K1 is the ith sample's distribution over the K clusters. Furthermore, we would like x to be sparse, for purposes of cluster interpretability and generalizability to test cases. In the specific case of cancer subtyping, y ji is a possibly normalized gene expression measurement for gene j in sample i.
Generative processWe introduce GLAD, a GaussianLaplaceDirichlet model for mixed-membership data where the underlying clusters have a sparse representation. The name refers to the component distributions comprising the joint model. The generative process for the observed data involves unobserved cluster centroids and unobserved mixing proportions, as follows:(1) Draw the elements of the M  K cluster-centroid matrix x as iid Laplace variables.(2) For each sample i = 1;. .. ; N, independently:(a) choose a distribution over clusters, i $ Dirichlet;This process involves several hyperparameters: , a non-negative scalar governing the Laplace prior on the elements of x; , a K-vector of non-negative values controlling the possibly asymmetric Dirichlet prior on each sample's mixing proportions; and S 2 R M  M , the conditional covariance matrix for the normally distributed components of the gene expression vectors. GLAD has two levels of latent-variable sampling: global and local. Globally, the cluster centroids are chosen once in advance for the entire dataset. Locally, the expected value of each observed vector is chosen as a mixture of cluster centroids, with different mixing weights for different observed vectors.depicts GLAD as as a graphical model. The Laplace distribution over the x jk enforces sparsity in the subtype matrix (). The automatic relevance determination method similarly uses a Laplace prior over features to induce sparsity (). The Laplace prior is also used to create sparsity in the multinomial inverse regression model for text sentiment analysis (). As i has a Dirichlet distribution, it provides, for each sample, a distribution over the K clusters. For simplicity, we set S = 2 I M from now on. The development of the model is similar for anisotropic or non-diagonal S, though some regularization may be required. Under the GLAD model, the joint distribution of observed and latent variables for the ith observed sample, also called the complete likelihood, is as follows:
1Integrating over the latent variables x and i yields the marginal likelihood of a sample,Finally, under the independent-samples assumption, the likelihood of the full dataset is as follows:The inference algorithms in Section 3 focus on the maximum likelihood estimate, that is, maximizing Equation (3) with respect to the hyperparameters , , and 2 .
Comparison with other clustering and topic modelsGLAD differs from other gene expression clustering models. A classical clustering mixture model would sample a Dirichlet once for the entire dataset. The resulting probabilities would be used to assign each expression vector to one cluster. This is the assumption of the PAM50 method () and other all-or-none clustering approaches (). Also, our method does not require side information, such as biochemical network structure, though this information may be incorporated into a structured sparsity parameter (). GLAD also differs from other topic models. A standard topic model chooses from a Dirichlet distribution once for each sample as we have done here. But then, given that Dirichlet draw, a number of additional per-sample latent variables are drawn, rather than just one as we have done in GLAD. Particular instances of this alternative structure are latent Dirichlet allocation (), where many additional multinomial random variables are drawn, and latent process decomposition (LPD) (), where additional Gaussians are drawn. The sparseTM model for text classification also uses additional multinomial random variables, with another type of sparsifying prior ().. Graphical model representation of the GLAD statistical model
Interpretation as matrix factorizationMany statistical models have corresponding matrix factorization interpretations (). Principal component analysis, NMF and latent semantic indexing have both linearalgebraic and probabilistic formulations. GLAD is different from standard decomposition approaches because of the constraint that i form a distribution over the columns of x. In particular, the negative complete log likelihood, retaining only terms involving x and , is as follows:with the simplicial constraints > i 1 = 1 and i ! 0 (elementwise) for each i. As we explain in Section 3, approximately minimizing Equation (4) is the main ingredient in the GLAD inference procedure. To see the connection to matrix factorization, set 2 = 1 2 ; = 1, and = 1, leaving the objective function as following:The first term in (5) can be viewed as a loss function for the difference between the fitted value ^ y i = x i and the actual observation y i. The second term is a sparsifying regularizer, wherein setting x jk to a non-zero value has a cost proportional to the magnitude of x jk. Viewing Equation (5) as a Lagrangian function where only the terms involving x and =  1. .. N  have been retained, the matrix factorization problem corresponding to GLAD can be written as follows:The inequality on is element-wise. The optimization problem (6) is biconvex in x and. It bears some resemblance to sparse coding (), with interesting differences: in sparse coding, x is dense and is sparse and non-negative, whereas in (6), x is sparse and is dense and simplicial.As exact inference is intractable, we have developed a non-conjugate variational inference algorithm () to estimate the posterior distribution p ; x j y; ^
INFERENCE AND PARAMETER ESTIMATIONSupplementary Section S1 provides a complete derivation of the procedure; here we summarize it briefly. We start by defining a family of candidate approximate posterior distributions, each of which has the same partially factorized structure:In Equation (8), each qx j  approximates the posterior distribution of the jth gene's values across all subtype signatures. Each q i  approximates the posterior distribution of the ith sample's subtype-mixing weights. This family of approximate posteriors imposes mutual independence between the x j 's and i 's. We do not use a fully factorized 'mean-field' approximation, which would treat the components within each x j and i as independent as well. Factorizing the variational distribution q (x) across features allows the algorithm to update each K-dimensional feature distribution qx j  in parallel while allowing qx j  to incorporate dependencies across subtypes. Factorizing the variational distribution across samples in q i  accomplishes the same goals. Next, we use a variational expectation-maximization (EM) procedure () to choose the best approximate posterior in the family just described. The procedure also produces approximate maximum-likelihood estimates of the hyperparameters ^ : = f ^ ; ^ ; ^ 2 g. Variational EM maximizes a global lower bound Lq;  on the true likelihood, by alternating between maximization over q (the variational E-step) and maximization over (the M-step). The variational E-step is carried out via coordinate ascent: we cycle through the factors qx j  and q i , maximizing in turn over each one with all others held fixed, until no more progress on Lq;  can be made. The optimal coordinate update for qx j  is known, but intractable to compute (). So, following, we invoke the idea of the Laplace approximation to find a good qx j  in the family of normal distributions. The Laplace approximation is not related to the Laplace prior. For q, whose optimal update is also intractable, we choose as an approximation a Dirichlet distribution, as in latent Dirichlet allocation (). The M-step involves closed-form updates for ^ and ^ 2 , with numerical optimization applied for ^ . Algorithm 1 summarizes the GLAD inference procedure in pseudocode.Algorithm 1 GLAD variational Laplace inference 1: Initialize qx;  and ^ 2: repeat 3: repeat 4: for j = 1 to M do 5: //fx j ; ^  is E j log py; x j ; x j ; .(See Supplementary Section S1) 6: Set ^ x j arg max xj fx j ; ^  7: Approximate qx j  % N ^ x j ; r 2 f ^ x j ; ^  8: end for 9: for i = 1 to N do 10: Optimize Lq; ^  over q i ; i  = Dir i  11: end for 12: until change in Lq; ^  is small 13: Set ^ arg max Lq;  14: until change in Lq; ^  is small 227 GLAD
Estimating the number of subtypes (K)Choosing the number of clusters for any clustering method is challenging (). Methods include the silhouette measure (), information theoretic measures (), and cross-validation (). Non-parametric Bayes methods enable posterior inference about K (). Prediction accuracy on heldout data has been used in the context of document topic models (). Here, we use the Bayesian information criterion (BIC) (), choosing K to minimize the following:BICq;  =  2  Lq; + K  M+N+1+2   log N: 9We count one parameter for each element of x and , as well as for , 2 and. We expect that this method, although simple, should guide selection toward a reasonable value of K. As it is intractable to evaluate the exact likelihood, we instead use the maximized variational lower bound. We show results of this metric on tissue mixture data in Section 4.2.
RESULTS
Simulation studyWe used simulated data with known parameter values to assess the performance of GLAD as sample size is increased, in comparison to LPD (). We constructed a suite of simulations as follows. We set the number of subtypes to two (denoted 'A' and 'B'), and the number of features to 500. We used sample sizes N = 30, 300, 3000 and 6000. In all simulations, the expected value for the first 20 features is +2 for subtype A and 2 for subtype B; the remaining features have an expected value of zero for both subtypes. For each simulated dataset, the first N/3 samples are 100% subtype A, the next N/3 samples are 100% subtype B and the last N/3 samples are a 50/50 mixture of the two subtypes. Thus, to simulate a dataset, we drew observations independently from a Gaussian distribution with mean parameter correspondingly set to subtype A's signature, subtype B's, or the average of the two. We set the Gaussian standard deviation to one. We fit GLAD and LPD to each simulated dataset and estimated the subtype proportions for each sample.shows boxplots of the estimated fraction of subtype A in each sample. The sizes of the datasets are on the x-axis. The three panels in the figure correspond to the three different kinds of sample in each dataset: pure subtype A (top), pure subtype B (middle) and 50/50 mix (bottom). The boxplots show the distribution over samples of E Ai j y i , the posterior mean fraction of subtype A detected in each sample. We show the data points for the N = 30 dataset because each boxplot is constructed from only 10 samples.shows that in pure samples, as the sample size increases, GLAD's mixing proportion estimates concentrate at the true values. For the smallest sample size of 30, LPD's mixing proportions are more accurate than GLAD's on pure samples but much less accurate on mixed samplesin real tumors, subtype mixing is liable to be the rule rather than the exception. At N = 30, the GLAD posterior underestimates the amount of subtype A for the 100% A samples and overestimates it for the 100% B samples as a consequence of the Dirichlet prior for small N. But GLAD improves quickly with more data; at N = 300, pure mixing proportions are well resolved, and this continues to hold on the larger datasets. The bottom panel ofshows that GLAD is accurate across a wide range of sample sizes for mixed samples. The median estimate is close to the true value of 0.5, and the spread of the estimates is small. In contrast, LPD has a large variance across a range of sample sizes, and it appears to exhibit some bias, which does not disappear even at N = 6000. Both models use empirical Bayes in their estimation procedures. This causes some degree of smoothing in the predictions. The amount of smoothing owing to hyperparameter-fixing decreases as the sample size increases, as can be seen from the estimates for the pure samples in. The GLAD posterior expectations are closer to 0.5 than they should be for small sample sizes, but the degree of smoothing decreases for larger sample sizes. Although empirical Bayes may appear to over-smooth the training-set predictions, this same smoothing often improves performance on test data ().
In vitro tissue mixture dataSimulated data are useful to obtain performance metrics with known ground truth under idealized conditions. But simulated variability is not the same as variability in real gene expression data. Shenperformed an in vitro mixture experiment that yields a good dataset on which to test our algorithm, while still providing a true-positive control. They independently isolated RNA from rat lung, liver and brain tissue. Then they mixed those samples at varying fractions and measured the levels on microarrays with replicates. This dataset gives us known mixture fractions and a known number of subtypes with real gene expression microarray data variability. The initial dataset contains 42 samples and 31 099 features. The measurements are the RMA-normalized microarray intensities on a log 2 scale. We preprocessed the probes to select only those that have a coefficient of variation 420%, yielding a data matrix that is 1198  42 in size.We used the BIC approach to estimate K.shows that the BIC method chooses a value of K = 5, roughly in keeping with the correct value of K = 3. For the remainder, we set K = 3, the true value, and ran variational inference for GLAD to focus the results on the inference algorithm and model. An analysis of the results for K = 5 is provided in Supplementary Section S2. The results are qualitatively similar for both K = 3 and K = 5.shows true values of and point estimates ^ for the three subtypes, across all 42 samples. GLAD evidently identifies both pure and mixed samples in the dataset. This dataset has many samples containing higher fractions of brain tissue than the other tissue types. The empirical Bayes estimate of reflects this, which in turn influences the subtype fraction estimates for the pure samples. In applications where one would prefer uniform subtype predictions a priori, can be fixed to a scalar multiple of the ones vector. Fixing to small positive values reduces the regularization, and thus, the underestimation of pure samples (Supplementary Section S5). However, the estimated values do provide information about the distribution of subtypes across the entire dataset. Many of the non-zero genes within each subtype signature are known to be associated with the corresponding tissue type.shows the top 10 genes ranked by the absolute value of x j for the three subtypes. All of the top 10 genes are over-expressed in the subtype indicated. We have labeled each subtype with the most closely matching tissue type. In the liver signature, there are genes associated with blood components (ITIH4, FGA, MUG1, FGB and PZP) and genes that are associated with liver regeneration (A1BG) and molecule uptake (FABP1). In the brain subtype, the top component is MBPa myelin sheath component. The signature also includes VSNL1 a neuronal calcium sensor, SNAP25a synaptic vesicle dicing protein and PLP1a transmembrane myelin protein. Finally, the lung signature contains SLC34A2, which if defective causes pulmonary alveolar microlithiasis and SFTPD, which plays a role in defense response in the lung.
TCGA GBM tumor classificationWe applied the GLAD model to microarray measurements of RNA expression levels in GBM tumors obtained as part of The Cancer Genome Atlas (TCGA) project (). We used the unified filtered sample matrix provided in the Supplementary Materials (). These data have been normalized and filtered for the most differentially expressed genes leaving a data matrix with 1740 features and 202 primary tumor samples. Previous work showed four canonical subtypes: classical (CL), proneural (PN), neural (NL) and mesenchymal (MES) (). As these are biopsy samples, we expect that there is some normal cell contamination in the samples. Normal contamination was also observed byand clustered within the NL subtypes. As such, we expect that mixture fractions of the NL subtype may represent normal cell contamination in our model. We applied the BIC model selection method to this dataset and found the optimal value of K = 6. Briefly, one subtype is enriched for gene in the immune response process and anothershows genes enriched for cell cycle processes. These findings correspond to analysis byusing a supervised learning approach to estimate tumor purity. A full analysis with K = 6 is reported in the Supplementary Sections S3 and S4. Here, we proceed with K = 4 to directly compare our results with those obtained byshows the distribution over subtypes for each sample in the GBM dataset. We have labeled the subtypes based on their similarity to the reported subtypes in. They found that the two normal samples in their dataset were classified as NL. As expected, there is a considerable mixing between the NL subtype and other subtypes in our analysis, possibly due to normal cell contamination. We also see significant mixing among the other subtypes, indicating that the samples are indeed generally not pure.shows the genes involved in the four subtypes identified by GLAD. Like topic models, each subtype has coefficient values for all features. However, the Laplace prior has the effect of regularizing uninformative coefficients toward zero, yielding a sparse signature. We report only the top 15 candidates for the signature here; the full table is available in the supplementary information. Genes in green are upregulated in the subtype, and genes in blue are downregulated. Genes in bold were also identified byfor that subtype, except UGT8, which was associated with NL-like, whereas we associated it with PN. Upregulation of DKK1 and POSTN is associated with the MES subtype in our analysis. DKK1 plays a role in inhibition of the Wnt signaling pathway and the presence of bone lesions in multiple myeloma patients (). Although the entire function of perstonin (POSTN) is not known, it is frequently upregulated in cancers and has been associated with adhesion and differentiation of osteoblasts (). These markers, in combination with collagen-specific genes, COL1A1 and COL1A2, point to the role of these genes in the precursor to bone and cartilage development for this subtype's MES-like genomic character. The classical subtype has only one highly upregulated gene EGFR.observed this association at both the mRNA and DNA levels in 97% of classical-like cells indicating its strong association. The PN actin and microtubule-related genes TMSL8 and DCX are over-expressed in the PN subtype (). Finally, the NL-like subtype contains the central nervous system water channel AQP4 and other genes associated with normal NL cells.
DISCUSSIONWe have presented GLAD, a new statistical model for the genomic classification of solid tumors. The model does not make an all-or-none classification for each sample; instead, it estimates a per-sample distribution over subtypes. Simultaneously, the model estimates a sparse expression signature for each subtype. We provide an interpretation of the model as a regularized form of matrix factorization. We compared GLAD with LPD, another clustering and classification model, using simulated data. At small dataset sizes, we found that GLAD overestimates the amount of mixing for pure samples, whereas LPD is quite imprecise for any particular sample; in our view, one should expect heterogeneity to be the norm in applications. As we increased the simulated sample size, the performance of GLAD improved quickly, owing to the decreased weight of the prior in the inference about i. GLAD is able to identify gene expression patterns associated with different tissue types from real microarray data, even when the sample is a. Sparse subtype signatures for GBM data. Upregulated genes are shown in a lighter shade (green), and downregulated genes are in a darker shade (blue). Genes identified by the TCGA analysis are shown in bold. There is high concordance between this sparse subtype signature and the more dense TCGA signatures (color online) heterogeneous mixture. An analysis of TCGA GBM data shows that there is significant heterogeneity in those clinical samples. Our Laplace variational inference algorithm provides a fast method for statistical inference using GLAD. However, it is an approximation. A Markov-Chain Monte Carlo approach has potential to reduce bias, at the expense of possibly much higher computational cost. Our variational approximation is also one of many possible factorizations of the model. We are actively testing other ways of approximating the posterior distribution that retain the computational advantages while improving the quality of the approximation. When fitting GLAD, we optimize a non-convex objective function by coordinate ascent. As such, we are only able to identify a local maximum in the variational auxiliary function, not necessarily a global maximum. Restarting the algorithm using random initializations can help, and we found it important to do so. Estimating the number of clusters, K, is a universal problem for clustering algorithms. Our approach, using the BIC, provides only a rough guideline. However, this approach may require much more data for accurate parameter estimation than needed in the current model. Another alternative is to choose K by cross-validation. This shifts the problem from choosing K to choosing an appropriate cross-validatory accuracy metric. Recent studies in breast cancer () and colon cancer (De Sousa E) have suggested different subtypes, which show distinct survival outcomes. As more samples are analyzed a clearer picture of cancer subtypes and number of subtypes develops. We can extend GLAD in several directions. Other data types such as imaging, DNA copy-number variation and DNA methylation may be incorporated as additional x and y outcomes. Structured sparsity may be incorporated into the hyperparameter. Finally, a hierarchical Dirichlet process may be incorporated into to learn the number of subtypes K.
The Author 2014. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
H.Saddiki et al. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
