Motivation: Next-generation sequencing (NGS) has revolutionized the study of cancer genomes. However, the reads obtained from NGS of tumor samples often consist of a mixture of normal and tumor cells, which themselves can be of multiple clonal types. A prominent problem in the analysis of cancer genome sequencing data is deconvolving the mixture to identify the reads associated with tumor cells or a particular subclone of tumor cells. Solving the problem is, however, challenging because of the so-called 'identifiability problem', where different combinations of tumor purity and ploidy often explain the sequencing data equally well. Results: We propose a new model to resolve the identifiability problem by integrating two types of sequencing information—somatic copy number alterations and loss of heterozygosity—within a unified probabilistic framework. We derive algorithms to solve our model, and implement them in a software package called PyLOH. We benchmark the performance of PyLOH using both simulated data and 12 breast cancer sequencing datasets and show that PyLOH outperforms existing methods in disambiguating the identifiability problem and estimating tumor purity. Availability and implementation: The PyLOH package is written in Python and is publicly available at https://github.com/uci-cbcl/PyLOH.
INTRODUCTIONThe advent of next-generation sequencing (NGS) and launch of comprehensive cancer genome sequencing projects () have yielded an unprecedented view on the complex landscape of cancer genomes, leading to the discovery of new cancer-causing genes and pathways, and novel therapeutic targets for treating cancers. Analyzing the data from cancer genome sequencing remains, however, computationally challenging because of the shear size of the sequencing data and the complexity of the tumor genomes and samples. Cancer genomes are often characterized by wide-spread somatic copy number alterations (CNAs), where genomic segments are deleted or duplicated one or more times. Identifying somatic CNAs associated with specific tumor genomes is of longstanding interest in the study of cancer genomes and is one of the focal points of the cancer genome analysis. Many computational methods have been proposed to discover copy number changes directly from DNA microarrays () or sequencing data (). However, most of these methods aim at identifying the relative copy numbers of segments of the same tumor genome. Discovering copy numbers in an absolute scale is biologically more relevant () but more challenging. This is because of the fact that the absolute copy number changes can be affected by two confounding factors: (i) tumor purity, the fraction of all cancerous cells within a heterogeneous tumor sample, and (ii) tumor ploidy, the baseline copy number of genomic segments or entire chromosomes (), both of which are unknown and themselves need to be estimated to infer absolute copy number changes. It is possible to estimate tumor purity and ploidy using experimental techniques such as quantitative image analysis () and single-cell sequencing (); however, these techniques are still too expensive or time-consuming to support large-scale studies. Hence, it is of great interest to use computational approaches to estimate tumor purity and ploidy, and consequently absolute copy number changes, directly from the NGS data. Tumor purity and ploidy affect not only copy number changes in different segments of genomes but also the distribution of allele frequencies in these segments. In the NGS data, these two types of information can be summarized in terms of the total number of reads mapped to each segment (total read count) and the frequencies of reads matching B-alleles (B-allele frequencies) at different sites. Computational methods have been proposed to estimate tumor purity alone () or jointly with tumor ploidy () based on these two types of information extracted from NGS data. Depending on how copy number changes and B-allele frequency information are used, the existing methods can be roughly grouped into two categories: one category of methods use B-allele frequencies (BAFs) at somatic mutation sites to estimate tumor purity, including PurityEst () and PurBayes (). These methods leverage the fact that the BAFs at somatic mutation sites are expected to be $0.5 if the tumor purity is 100%, and any addition of normal cells will lead to a reduction in the observed BAFs at these sites. The second category of methods relies on copy number changes *To whom correspondence should be addressed. to estimate tumor purity and/or ploidy, including CNAnorm (), THetA () and ABSOLUTE (). It has been shown that the methods in the second category are often more accurate and robust than those in the first category because of the fact that (i) the total read counts are large in NGS data, and thus, methods relying on copy number changes are statistically more stable than methods relying on BAFs at somatic mutation sites, the number of which is often small, and (ii) the determination of somatic mutations is not perfect and the inclusion of false-positive findings can significantly bias the estimation (). However, the utility of the methods relying on copy number changes to estimate tumor purity and ploidy is severely hindered by the so-called 'identifiability problem', where different combinations of tumor purity and ploidy can explain the observed data equally well (). This is because tumor purity and ploidy are often intertwinedchanges in one can be offset by compensations from the other, allowing the same copy number to be explained by multiple combinations of tumor purity and ploidy. For example, a homozygous deletion combined with 30% tumor purity can also be explained as a heterozygous deletion combined with 60% tumor purity. Resolving this ambiguity is key to accurate estimation of tumor purity and ploidy. Existing methods try to solve this identifiability problem by using heuristics, e.g. favoring solutions that have the smallest deviations from diploid (e.g. CNAnorm;), seeking additional experiential data (e.g. ABSOLUTE;) or simply outputting all possible solutions (e.g.). Here we provide a more principled way to solve the identifiability problem by combining the information revealed from copy number changes and B-allele frequencies. Instead of using Ballele frequencies extracted from somatic mutation sites as in the previous cases, we use B-allele frequencies calculated at sites that are heterozygous with respect to the normal genomes, and most of which are common single nucleotide polymorphisms (SNPs). These heterozygous sites are much more abundant () and easier to identify, leading to more statistically stable results. Copy number changes in the cancer genome often result in loss of heterozygosity (LOH) at these heterozygous sites, and the extent of LOH is closely related to absolute instead of relative copy number changes. We will use BAFs to gauge the extent of LOH, and provide information on the absolute copy number changes by examining the patterns of BAFs at the heterozygous sites within the same genomic segment. For example, although a homozygous deletion with 30% tumor purity results in the same copy number as a heterozygous deletion with 60% tumor purity in a tumor sample, B-allele frequencies at heterozygous sites of the tumor sample cluster at different values in the two combinations and therefore are able to distinguish these two cases. Based on this insight, we propose a full probabilistic model implemented as a software package called PyLOH to integrate the information gathered from CNAs and LOH. Estimations of tumor purity and absolute copy numbers are then formulated as an optimization problem in which we choose those values that maximally explain both total read counts and B-allele frequency information. Our method is similar in spirit to some of the earlier methods proposed for SNP array analysis, where both the signal intensity and BAF of each SNP are used in estimating copy number changes. The combination of these two signals has been shown to improve the estimation accuracy of tumor ploidy (), or both tumor purity and ploidy (). Recently, some of these methods have been extended to sequencing data, including OncoSNP-SEQ by Yau (2013) and Patchwork by. However, the OncoSNP-SEQ algorithm uses only the reads mapped to the SNP sites, although our algorithm uses all reads, and thus should be able to yield a more accurate estimation of copy number changes. Similar to our work, the Patchwork algorithm also uses all reads, but it requires manual interpretation through data visualization to determine the initial copy numbers of clusters of genomic segments, which could be useful when the tumor genome is too complex for the algorithms to resolve different solutions by themselves. Here we seek an alterative approach that is based on a generative model and requires no manual intervention. In addition, the Patchwork algorithm requires the existence of copy-neutral loss of heterozygosity within the tumor genome to run the algorithm, whereas our algorithm has no such constraints. The outline of this article is as follows: in Section 2, we describe the full probabilistic model of PyLOH. In Section 3, we first present cluster patterns of BAFs in NGS data of paired tumor-normal samples, then introduce a visualization tool called 'BAF heat map' to characterize such patterns. Finally, we compare tumor purity estimates of PyLOH and other methods on both simulated datasets and 12 breast cancer sequencing datasets. Our results show that explicitly incorporating both CNAs and LOH information can resolve the identifiability problem and significantly improve the accuracy of tumor purity estimation. Finally, we discuss the limitations of PyLOH and propose future directions in Section 4.
METHODSIn this section, we present the probabilistic model of PyLOH that combines CNAs and LOH information to infer absolute copy numbers and tumor purity. We first introduce some notations, then propose a generative mixture model incorporating both total read counts and B-allele frequency information and finally introduce algorithms to solve the model.
Basic definitions and notationsSimilar to previous work (), we assume the tumor genome has already been segmented into J segments, each of which has the same CNAs. Denote the copy number of the j-th segment of the tumor genome by C j with j  1,. .. , J. In addition, we assume each segment has a number of heterozygous sites (single nucleotide changes) in the corresponding normal (i.e. control) genome. We use (i,j) to index the i-th heterozygous site in segment j with i  1,. .. , I j , where I j is the total number of heterozygous sites in segment j. The observed data are summarized and grouped into two categories: one category is the copy number information, represented as the total number of reads mapped to each segment. Let D j denote the number of reads mapped to segment j. The second category of observed data is the allele frequency information, represented by the total number of reads matching each of two alleles at a heterozygous site. For notational purpose, for each heterozygous site, we define the A allele to be the allele matching the reference genome and the B allele to be the corresponding unmatched one. Using the notation from (), let a ij and b ij denote the number of reads matching A and B alleles, respectively, at site (i,j). As most of the data we consider are from paired tumornormal samples, we use a superscript N (from normal samples) and T (from tumor samples) to denote the sample origin of the data. For example, D T j and D N j will denote the total number of reads mapped to segment j from the tumor and normal samples, respectively. To account for the contamination of normal cells, we assume the tumor sample yielding the sequence data consists of a mixture of normal and tumor cells. Denote the fraction of tumor cells within the tumor sample by , which will also be called tumor purity. Consequently, the average copy number of each segment within the tumor sample is " C j  C j  1  2 1 for j  1,. .. , J, assuming that the default copy number within normal cells is always 2. Our goal is to use both the total read count information and site-specific allele count information to infer both the absolute copy number fC 1 ,. .. , C J g and the tumor purity .
Modeling CNAsFollowing the LanderWaterman theory (Lander and), the probability of a read originating from a specific segment depends on three main factors: (i) the copy number of the segment, (ii) the total genomic length of the segment and (iii) the mappability of the segment (depending on factors such as GC content, repetitive sequence and so on) (). Borrowing the concept of interval weight factor from (), we associate a coefficient j to segment j accounting for the effect of its genomic length and mappability. We assume the expected number of reads mapped to segment j, denoted by j , in the tumor sample is proportional to " C j j. That is, given two segments a and b, we have a b  " C a a " C b b 2 In Equation (2), the mapping coefficient j 's matters only in their relative values. For simplicity, we take a = b  D N a =D N b , the ratio of the mapped read counts between these two segments in the normal sample, as it reflects intrinsic sequence properties of these segments and therefore should be the same between the normal and tumor samples. The above formula determines the relative value of the expected number of reads mapped to each segment. To further specify the absolute value of j of segment j, we make use of the allele frequency information and curate a list of segments that contain no loss of heterozygosity. Where there is no loss of heterozygosity, the only possible copy numbers at these segments in tumor cells must be even numbers. From the list, we further remove 'outlier' segments whose copy numbers deviate from the bulk of the segments in the list based on the observed read counts at these segments. At the end, we are left with a set of segments (denoted by set S containing the indices of these segments) that both contain no loss of heterozygosity and likely share the same copy number. Details are given in Supplementary Material Data preprocessing. The set of segments in S will be the baseline segments that we use to specify the expected read counts j s. To reduce complexity, we assume that the same even copy number c s shared by all segments in S can only be either 2 or 4. (The other possible values are 0 for homozygous deletion, which is unlikely, as each segment in S is supported by a certain amount of reads, or values that are44 for ploidy higher than tetraploid, which is likely to be rare.) Our algorithm will check both cases and select the one most compatible with the observed data (in terms of the likelihood function). Given the values of c s s for each s 2 S, the average copy number of these segments in the tumor sample, taking the contamination of normal cells into account, is then given by Equation (1). With the average copy numbers in the baseline segments given, we then specify the expected read count for each segment j  1,. .. , J in the tumor sample as follows:which is the average expected read count suggested by the baseline segments through Equation (2), where the observed read counts in segment s of the tumor sample are denoted as D T s. Here jSj denotes the number of segments in set S. Given the expected read count at each segment, we model the probability of observing D T j reads in segment j as a Poisson distribution with parameter j ,for each j  1,. .. , J, where j is a parameter depending on the absolute copy numbers and is calculated based on Equation (3). More discussion about using the Poisson distribution is given in Supplementary Material.
Modeling loss of heterozygosityTo model the loss of heterozygosity at heterozygous sites (i.e. with genotype AB in the normal cells), we need to consider the genotypes of these sites in tumor cells. Let G  f;, A, B, AA, AB, BB, AAB, ABB, AABBg be the set of possible genotypes that we will consider at each heterozygous site in tumor cells. By focusing on this set, we have excluded some other genotypes that are less likely to occur in tumor cells. For instance, we will not consider genotypes AAA or BBB, as any copy number change from AB to these two genotypes will involve at least one deletion and two insertions. Instead, all genotypes included in G can be derived from AB with a minimum of one operation on each allele. Although we formulated the set of possible genotypes here by assuming the maximum copy number of each allele is 2 in tumor cells, PyLOH allows the user to change this value. However, there is a trade-off in choosing the maximum copy number threshold. On one hand, increasing the threshold can accommodate genomes with high instability, but on the other hand, it can also significantly increase the complexity of the model and thus make it more susceptible to overfitting. The corresponding copy number and BAFs associated with each genotype in G are {0,1,1,2,2,2,3,3,4} andspectively, written in the same order as the genotypes in set G. We have included a small (1 in the calculation of BAF to account for sequencing and/or read-mapping biases or errors. In practice, we choose  0:01, corresponding to a Phred quality score of 20 (). We will use n g and g to denote the corresponding copy number and BAF, respectively, for genotype g. As the tumor sample consists of a mixture of normal and tumor cells, the fraction of B alleles in the tumor sample is the weighted average of BAFs between normal and tumor cells, with weights depending on tumor purity and copy numbers,where 0  0.5 is the BAF at the heterozygous sites in normal cells. Using the notation from (), let G ij be a random variable denoting the genotype of site (i,j) in tumor cells. Conditional on its genotype, we model the probability of the B allele count at each site as a binomial distribution, that is, given d T ij  a T ij  b T ij reads mapped to site (i,j), the chance of observing b T ij reads matching B allele is given by the equation b T ij j G ij  g, $ Binomiald T ij , " g   6 with the total number of trials specified by d T ij and the chance of success at each trial specified by " g .
Combining CNAs and LOH informationFor heterozygous sites located within the same segment, their genotypes are constrained by the underlying copy number associated with the segment. We model this constraint through a conditional probability distribution PG ij  gjC j  c  Q gc for all i and j. Here Q gc is a predefined matrix specifying the chance of a site being genotype g conditional on the underlying copy number being c. In practice, we assign a small probability to any genotypes incompatible with the copy number c conditional on the heterozygosity in normal cells, and equal probabilities to other compatible genotypes. Conditional on the underlying copy number, we can then write down the probability of observing B-allele read count at each site as follows:We will assume that conditional on the underlying copy number, the B-allele read counts at different sites of the same segment are independent of each other and are independent of the total read count from the segment. Let b T j  b T 1 ,. .. , b T Ij  denote all B-allele read counts at heterozygous sites of segment j. Under the conditional independence assumption outlined above, the joint probability of observing D T j and b T j conditional on the underlying copy number C j  c and the tumor purity being is as follows:where the probability of D T j conditional on C j and is the Poisson distribution (4), and the probability of b T ij conditional on G ij and is the binomial distribution (6).
Likelihood modelSo far, we have specified the probability of observing total read count and site-specific B-allele read counts at each segment conditional on the underlying copy number. Next we further treat the copy number C j at each segment as a random variable, and model its probability as a categorical distribution with support C  f0, 1, 2, 3, 4g, denoting the range of considered copy numbers, and parameters j   j0 ,. .. , j4 , where jc denotes the probability of having C j  c in segment j. In other words, we havefor each j  1,. .. , J. We treat   1 ,. .. , J  and as parameters of our model   , , and the goal of our model is to infer the values of these parameters based on the total read count information in each segment and site-specific allele count information at each heterozygous site of these segments. Let D  D 1 ,. .. , D J  and b  b 1 ,. .. , b J . By, and assuming the observations from different segments are conditionally independent conditional on the tumor purity , the likelihood of observing the combined read count information is then given as follows:Given the likelihood function, we can then estimate the model parameters using maximum likelihood estimation. Alternatively, we can also add a prior into the model by incorporating our prior knowledge on the copy numbers and/or tumor purity. For instance, we can use the Dirichlet distribution to incorporate the prior on the distribution of copy numbers and beta distribution to incorporate the prior on tumor purity, j $ Dirichlet!, $ Beta,   10 where ! is a vector having the same dimension as j and gives a weight to each copy number. If the priors are specified, we can then estimate the values of the parameters by maximizing their posterior probability, i.e. using the method of maximum a posteriori (MAP) estimation. In this article, we use non-informative prior for and a Dirichlet prior configured based on the compatible genotypes of each copy number for j. We solve the MAP problem using the Expectation-Maximization (EM) framework (). An alternative approach would be to take a Bayesian approach to calculate the posterior probabilities of the tumor purity and copy number changes. We do not take the Bayesian approach owing to computational considerations, as it would require more time-consuming inference procedures. The complete details about prior configurations and EM updates are given in Supplementary Material.
RESULTSNext we demonstrate the utility of combining loss of heterozygosity with CNAs to infer tumor purity and ploidy. For this purpose, we first present a clustering pattern of B-allele frequencies derived from NGS data in paired tumor-normal samples. Then we show that this clustering pattern can be used to resolve the ambiguous combinations of tumor purity and copy number changes, using both a toy example and real data. Afterward, we apply our method PyLOH, developed to infer tumor purity and absolute copy numbers by integrating the information from total read counts and B-allele frequencies, to simulated data and compare its performance with exiting state-of-the-art methods, CNAnorm-1.4.0 (), THetA-0.0.3 () and PurBayes-1.3 (). Finally, we test the performance of our methods and other methods on real data, consisting of 12 whole genome sequencing datasets from breast cancer samples ().
BAFs patterns in NGS data and BAF heat mapAs discussed in the introduction, the distribution of BAFs is closely related to the underlying copy number changes. In particular, copy number changes at sites that are heterozygous with respect to the normal genome may result in a deviation of the BAFs from 0.5 (loss of heterozygosity), and the extent of this deviation depends on the absolute copy number changes and tumor purity. We illustrate this idea using a heat map plot (), which shows the frequencies of BAF pairs, with one calculated from the normal sample and the other calculated from the matched tumor sample at the same site, coded in pseudo colors.shows the BAF heat maps of paired tumornormal samples from three independent cancer genome NGS datasets, including both exome sequencing () and whole genome sequencing (). The BAF heat maps demonstrate a clear cluster pattern on the distribution of BAF pairs (). Two clusters are shared by all four heat maps, including the bottom left cluster, containing sites with homozygous A-allele in both normal and tumor genomes, and the top right cluster, containing sites with homozygous Ballele in both normal and tumor genomes. (The small deviations of BAFs away from 0 or 1 of sites in these two clusters are likely because of sequencing and/or read-mapping errors.) Without changes in BAFs, these two clusters reveal no information with regard to the underlying copy number changes. Thus, we focus our attention on the other clusters in the heat maps, which all have BAFs centering at 0.5 in the normal samples, and thus contain mostly the heterozygous sites that underscore our method. For this reason, these clusters will be referred to as heterozygous clusters in the following. The heterozygous clusters demonstrate distinct cluster patterns in different genomic segments of same/different samples. Although the BAFs of these clusters all center at 0.5 in the normal samples, the BAFs of the corresponding matched tumor samples can center at 0.5 (and d) or at values away from 0.5 (c). In fact, these values provide a measure on the extent of LOH in the segments of tumor samples. For example, the tumor BAFs of the heterozygous cluster center at 0.5 in, suggesting no loss of heterozygosity in this segment. Without LOH, the absolute copy number in this case can only be even numbers, with diploid being the most plausible answer. (We can eliminate homozygous deletion, as there are reads mapped to this region.) A different cluster pattern emerges inand b, which show two heterozygous clusters, with tumor BAFs centering at 0.1 and 0.9 in, and at 0.2 and 0.8 in, suggesting significant loss of heterozygosity in these two segments. (The appearance of two heterozygous clusters in these two cases and the symmetry of the two clusters with respect to the tumor BAF  0.5. This is because the B-alleles are determined according to the human reference genome, which is not phased.) If the underlying copy number changes are a single-copy deletion in both cases, then the cluster with tumor BAFs centering at 0.1 () would correspond to a larger LOH, and consequently a higher tumor purity than the other case ().shows an interesting case with three heterozygous clusters with one center cluster showing no LOH and two symmetric clusters suggesting LOHs. This more complex cluster pattern suggests more than one type of CNAs within the segment being considered, most likely owing to the presence of both diploid and single-copy deletion changes. Overall, these BAF heat maps provide a convenient and intuitive way to examine the overall CNAs of a chromosomal segment, and illustrate the utility of BAFs at heterozygous sites for inferring tumor purity and absolute copy numbers.
Using BAFs to solve the identifiability problemThe BAF patterns shown incan be used to resolve the identifiability problem, as the heterozygous clusters in each BAF heat map will center at different values with respect to different combinations of tumor purity and copy number changes. We demonstrate this idea using a toy example (). In this example, we have total read counts in two segments of the genome from both normal and tumor samples. The segment 2 has much smaller total read counts from the tumor sample than the normal sample. The differences can be explained by either a heterozygous deletion with 60% tumor purity or a homozygous deletionwith 30% tumor purity in this segment. The total read counts themselves cannot distinguish these two possibilities. However, if we add in the information from the BAFs of the sites in segment 2, an observation of heterozygous clusters centering at tumor BAFs away from 0.5 would eliminate the homozygous deletion solution (). We can observe similar cases in real cancer genome sequencing data as those in the above toy example. For instance,shows the total read counts and BAFs at three SNP sites [dbSNP 130 ID listed (observed in the exome sequencing of a breast cancer patient MB-154 (). The mean coverage of the exome sequencing data was 141X for the tumor samples and 133X for the normal samples, respectively (). The first SNP site shows an example of a heterozygous deletion as d T is significantly lower than d N , whereas BAF T significantly deviates from 0.5. The second site shows an example of a homozygous deletion as d T is significantly lower than d N , whereas BAF T is around 0.5. As a control, the third site shows an example without LOH or CNAs.
Results from simulated dataWe have developed a probabilistic model to infer tumor purity and absolute copy numbers by integrating the LOH information described above and the information based on total read counts (see Section 2). Next we benchmark the performance of our new method on simulated data and compare it with other algorithms. By using simulated data, we know the ground truth of both tumor purity and absolute copy numbers, thereby providing us an objective way of comparing the performance of different algorithms. We first created an artificial diploid human genome by using the human reference genome as a template and inserting SNP sites with a frequency similar to those observed in the human population (). This diploid genome will be treated as the normal genome in our follow-up simulation and analysis. The tumor genome was generated by adding somatic mutations and copy number changes to the normal genome. NGS reads were then simulated from the tumor sample consisting of a mixture of the normal and tumor genome, with the fraction of the tumor genome determined by the tumor purity. To reduce computational time, we use only data from chromosome 1 in our analysis. Details on how the genomes and reads were generated are described in Supplementary Material. We created four tumor genomes that differ in their copy number configurations. The absolute copy numbers of each tumor genome were configured to introduce the identifiability problem, and the detailed configurations are given in Supplementary Table S1. For each tumor genome, we then simulated eight different sets of NGS reads from both normal and tumor samples by varying tumor purity. Overall, 32 sets of paired tumor-normal reads, each with 60X coverage, were generated. We applied PyLOH to each of these datasets, and compared its performance with three other methods, including PurBayes, CNAnorm and THetA. THetA and PyLOH require a segmentation of the tumor genome based on relative CNAs as an input. To avoid issues related to genome segmentation, we used ground truth segmentations in our analyses. Similarly, we used ground truth somatic mutation sites as the input for PurBayes. Details on how reads were preprocessed are given in Supplementary Material. The tumor purities estimated by PyLOH and three other existing methods are shown in. Because of the space limitation, we only show the results of the first three simulated datasets in. The complete tumor purity estimates for all the simulated datasets are shown in Supplementary Table S2. The absolute copy numbers estimated by PyLOH and THetA for each simulated dataset are shown in Supplementary Tables S4S7. A few observations emerge from the figure and tables. First, PyLOH significantly outperforms the other three methods on these datasets, providing a more accurate estimation of both tumor purity and absolute copy numbers and returning ground true values in most of the tested cases. Second, the THetA method, based only on total read counts information, is able to identify the ground truth as one of its possible solutions for tumor genomes 1 and 2 but fails to resolve the identifiability problem. Finally, the PurBayes method, based on information from somatic mutations, can return the true tumor purity in some cases, but has larger deviations than PyLOH, likely reflecting the statistical fluctuation associated with relatively small number of somatic mutation sites. In addition to the four simulated tumor genomes discussed above, we simulated two additional tumor genomes based on copy number configurations derived from Sanger COSMIC v68 (). The tumor purities and absolute copy numbers of the two COSMIC samples estimated by PyLOH and other methods are shown in Supplementary Tables S9S11. PyLOH still outperformed the other methods on these two new datasets. Further details on these two datasets are described in Supplementary Material.
Results from breast cancer sequencing dataHaving illustrated the utility of our method on simulated data, we proceed to test the performance of PyLOH on a real cancer genome dataset, consisting of whole genome sequencing of 12 breast cancer samples (). As the ground truth tumor purities are unknown for this dataset, we used the tumor purities calculated by ABSOLUTE based on SNP array data and reported in the paper byas a baseline for our comparison. Although this baseline is by no means absolutely correct, it offers clues on the performance of different algorithms, as it was derived from SNP array data instead of NGS data as inour case. We used BIC-seq-1.2.1 () to obtain segmentation files for THetA and PyLOH, and used VarScan-2.3.5 () to call somatic mutation sites for PurBayes. As THetA often outputs multiple solutions, we selected the ones with the smallest deviation from the diploid whenever this happens, as recommended by THetA (). Further details on this dataset are described in Supplementary Material. The tumor purities estimated by PyLOH and three existing algorithms, THetA, CNAnorm and PurBayes, for the 12 breast cancer sequencing datasets are summarized in. If the tumor purities estimated by ABSOLUTE are used as our comparison baseline, we find PyLOH to be the most accurate algorithm among the fourit yields a mean absolute error (MAE) of 0.186, as compared with a MAE of 0.22 by the second best algorithm, THetA. PurBayes, which uses somatic mutations to estimate tumor purity, produced poorest results, likely because of the inclusion of false-positive results in the somatic mutation calling procedure. Although PyLOH returned closer solutions to ABSOLUTE (as measured by MAE) than any of the other methods, the tumor purities estimated by PyLOH and ABSOLUTE deviate in six samples: MB-15, MB-45, MB-82, MB-98, MB-116 and MB-123. To find out why such a discrepancy arises, we carefully studied each of these six cases. In two of these cases (MB-15 and MB-45), we believe that the results obtained by PyLOH are more accurate because the tumor purities and absolute copy numbers inferred by total read counts information are consistent with those inferred by BAFs information, and both support the results obtained by PyLOH. For sample MB-82, MB-116 and MB123, the contribution of BAFs information to estimating tumor purities is not significant compared with the total read count information, likely because of a low tumor purity in these samples. As a result, the estimation of tumor purity is mainly contributed by information from total read counts, and in fact produces a similar estimation compared with THetA. For the remaining case MB-98, the estimated tumor purities given by the four algorithms are all inconsistentone possible reason for this may be the existence of subclonal tumor populations in the tumor sample. Aside from the accuracy comparison described above, we note that PyLOH is fast, with a running time scaling linearly with the number of segments. This is in contrast to the THetA method, the running time of which scales exponentially with the number of segments, as it explores all combinations of copy number changes across all segments (). As a result, THetA takes a prohibitively long time to run when the number of segments is above 150 and the maximum copy number is 46, although PyLOH has no such constraints. Further details about the run time of each algorithm are given in Supplementary Material.
DISCUSSIONIn this article, we examined the problem of estimating tumor purity and absolute copy number changes from NGS data,. The tumor purity estimates of the first three simulated datasets given by THetA, CNAnorm, PurBayes and PyLOH. The x-axis is the estimated tumor purity and the y-axis is the ground truth tumor purityand here we only show the solutions with the smallest deviation from the diploid. b For tumor purities reported by THetA with multiple solutions, we used the average of the solutions with the smallest deviation from the diploid to calculate the MAE. and, in particular, focused on solving the identifiability problem that has not been properly solved by the existing methods. We demonstrated that the distribution of B-allele frequencies at sites that are heterozygous with respect to the normal genome provides key, but under used, information to solve the identifiability problem. We further developed a full probabilistic model to integrate the copy number change and BAF information, and derived a principled way to estimate tumor purity and absolute CNAs. We benchmarked the performance of our method, PyLOH, on both simulated data and real whole genome sequencing data, showing that our method outperforms existing methods in both cases. PyLOH requires a segmentation of the genome into segments with different CNAs as input. Many algorithms have been developed to segment genomes based on copy number changes and BAFs of SNP array data with varying levels of accuracy (). A few of these array-based methods have recently been translated to the sequencing domain (). A future direction of PyLOH would be to integrate these existing methodologies and combine them with the probabilistic model of PyLOH to carry out both genome segmentation and absolute copy number estimation. Another important future direction is to use our model to study tumor heterogeneity. So far, we have focused on separating genetic changes from a mixture of normal and tumor cells. It is well known that multiple tumor clonal types may coexist in the tumor sample, each with an associated mutation landscape (). To further model intra-tumor heterogeneity on top of the current probabilistic framework, we can assume there are multiple populations of tumor cells. Thus, the model likelihood given by Equation (9) can be extended to account for subclonal tumor populations (details in Supplementary Material). We plan to further extend PyLOH in this direction to tackle the more challenging problem of deconvolving tumor heterogeneity by combining copy number change and allele frequency information.
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
Y.Li and X.Xie at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
Deconvolving tumor purity and ploidy at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
chr7:82,225,896 317 352 50 51 rs62465931 Note: BAF N and BAF T denote BAFs of the normal and tumor sample, respectively. d N and d T denote the read depth at the SNP site of the normal and tumor sample, respectively.
