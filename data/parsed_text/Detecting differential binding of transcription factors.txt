Increasing number of ChIP-seq experiments are investigating transcription factor binding under multiple experimental conditions, for example, various treatment conditions, several distinct time points and different treatment dosage levels. Hence, identifying differential binding sites across multiple conditions is of practical importance in biological and medical research. To this end, we have developed a powerful and flexible program, called DBChIP, to detect differentially bound sharp binding sites across multiple conditions, with or without matching control samples. By assigning uncertainty measure to the putative differential binding sites, DBChIP facilitates downstream analysis. DBChIP is implemented in R programming language and can work with a wide range of sequencing file formats.
INTRODUCTIONChIP-seq (Chromatin immunoprecipitation followed by sequencing) is widely used in studying proteinDNA binding on a genomewide scale. After cross-linking, immunoprecipitation and shearing, millions of sequenced DNA fragments (reads) are mapped to a reference genome, and sites with over-abundant reads are declared as putative binding sites. We focus on an important class of binding sites that have similar read profiles throughout the genome. Specifically, the lengths of the binding sites are similar across the genome, and their centers are well defined. These binding sites tend to have read profiles that look like sharp peaks. This class includes transcription factor binding and some histone modifications measured by ChIP-seq. Most of the available ChIP-seq peak-finding programs identify transcription factor binding sites in a single ChIP sample with or without a matching control sample; for a review, see Wilbanks and Facciotti (2010). An increasing number of experiments are investigating differential binding across two or more experimental conditions, including but not limited to, multiple treatments (), series of time points (), and multiple cell * To whom correspondence should be addressed.lines (). Since transcription factors regulate gene expression, differential binding across multiple experimental conditions is critical for revealing the function of a transcription factor at each binding site. Thus, a program that can detect differential binding of transcription factors across multiple conditions is much needed.
METHODSSuppose there are a total of K conditions, each with one ChIP sample and possibly one matching control sample, for comparison. The workflow of DBChIP is illustrated in. DBChIP works with existing ChIPseq peak-finding programs for identifying binding sites in any individual condition. Most ChIP-seq programs can output a list of predicted binding site locations along with scores indicating the strengths of binding for a given ChIP sample. DBChIP first merges the lists of predicted binding locations from multiple conditions into one single list by clustering close-by sites into consensus sites. Then a hypothesis of non-differential binding is tested at each consensus site. If a matching control sample is available for each ChIP sample, the test can be further improved by directly applying to the estimated binding signal read counts. We briefly describe each step in the remainder of this section. Further details are discussed in the Supplementary Material.(i) Consensus site: binding site predictions can be obtained under each condition through one of many existing ChIP-seq programs. However, it is unlikely that the predictions for the same binding site across different conditions are exactly the same. To obtain consensus sites, we first pool all the predicted binding site locations of different conditions together. Next we employ agglomerative hierarchical clustering with centroid linkage to group predicted locations into different clusters. Then, the consensus site positions are calculated as the average of predicted locations within each cluster, weighted by their scores if available. The read count for each binding site is
K.Liang and S.KelesKele Kelesdefined as the sum of the number of 5 ends on the positive strand within the upstream windowand the number of 5 ends on the negative strand within the downstream window, where s is the consensus site position and w is a configurable window size parameter.(ii) Detecting differential binding: to control the probability of falsely declaring differentially bound sites, we formally test a null hypothesis of non-differential binding at each consensus site. The tests are generally carried out through a generalized linear model with Negative Binomial distribution to account for the over-dispersion among samples. When replicates are available, the dispersion parameter in the Negative Binomial distribution is estimated through edgeR (). We develop novel methods to account for potential over-dispersion in the absence of replicates. Details are provided in Section 1.2 of the Supplementary Material. We obtain a P-value and fold change estimates between conditions for each site, and DBChIP can then report significantly differentially bound sites according to a pre-specified false discovery rate (FDR) threshold. There are also graphical functions in DBChIP to plot binding profiles for visual inspection; examples can be found in Supplementary Figures S5, S6, and S8.(iii) Control samples: in many ChIP-seq datasets, ChIP samples are accompanied with matching control samples to improve peak detection. The ChIP reads in a binding site can be decomposed into binding signal reads and background noise reads (; Supplementary). Arguably, it is of more interest to detect the differences among the binding signal reads across conditions than to detect the differences of all reads (signal+noise), because the latter may be attributed to the differences in the background noise reads across conditions. Without control samples, the tests performed in (ii) need to implicitly assume that the background reads across ChIP samples are comparable. Such an assumption may be reasonable for some datasets, but cannot be taken for granted in general. Since matching control samples provide natural estimates of the background noise read counts, we replace the total read counts at binding sites with the estimated signal counts (ChIPcontrol) and test for differential binding as in (ii).studied binding of the transcription factor PHA4 in C.elegans under two developmental conditions: embryonic and the first stage of larval development (L1) under starvation conditions. The authors first identified 4350 binding sites in embryos and 4808 in starved L1 larvae and then treated non-overlapping sites as differential binding sites. This simple approach can have two potential pitfalls. First, the sites that are bound in all conditions but have different binding strengths will not be captured as differentially bound. Second, binding sites identified in one or more but not in all conditions (differentially bound sites) may be a result of potential false negatives in some conditions.
EXAMPLEOur application of DBChIP on this dataset revealed that 139 of the 1742 binding sites identified as bound in both conditions show differential binding after FDR control at 0.05 level. This result is further supported by observing that the median fold changes for favorable binding in embryonic and L1 conditions are both >3.5 fold. These differences in binding strengths may be attributable to the differential activity of important binding co-factors of PHA-4 under the embryonic and L1 stages. In contrast, among the 2608 binding sites declared bound in the embryonic condition only, 1361 of them have P > 0.05 and are unlikely to be declared differentially bound using any error rate control method at level 0.05 (see Supplementaryfor an example). Similarly, 864 out of 3066 L1 only binding sites have P > 0.05. DBChIP also provides estimated fold changes between the ChIP samples in addition to differential binding calls; hence, the downstream analysis can be based on both P-values and fold changes. Further details are in Section 2 in Supplementary.
DISCUSSIONIn summary, DBChIP detects differential binding in a quantitatively principled way by formally testing hypothesis of non-differential binding at each putative binding site. DBChIP assigns uncertainty measure (P-values) to each finding, and thus, proper error rate control can be achieved. Furthermore, when there are more than two conditions for comparison (K > 2), DBChIP can be used to detect pairwise differences after the detection of overall differential binding. Moreover, DBChIP does not rely on a specific sequencing platform and can accommodate data from Illumina, SOLiD and other platforms.
The Author 2011. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oup.com
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from [17:48 19/12/2011 Bioinformatics-btr605.tex]
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
