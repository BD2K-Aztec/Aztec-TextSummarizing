Motivation: Recent large-scale omics initiatives have catalogued the somatic alterations of cancer cell line panels along with their pharmacological response to hundreds of compounds. In this study, we have explored these data to advance computational approaches that enable more effective and targeted use of current and future anticancer therapeutics. Results: We modelled the 50% growth inhibition bioassay end-point (GI 50) of 17 142 compounds screened against 59 cancer cell lines from the NCI60 panel (941 831 data-points, matrix 93.08% complete) by integrating the chemical and biological (cell line) information. We determine that the protein, gene transcript and miRNA abundance provide the highest predictive signal when modelling the GI 50 endpoint, which significantly outperformed the DNA copy-number variation or exome sequencing data (Tukey's Honestly Significant Difference, P <0.05). We demonstrate that, within the limits of the data, our approach exhibits the ability to both interpolate and extrapolate compound bioactivities to new cell lines and tissues and, although to a lesser extent, to dissimilar compounds. Moreover, our approach outperforms previous models generated on the GDSC dataset. Finally, we determine that in the cases investigated in more detail, the predicted drug-pathway associations and growth inhibition patterns are mostly consistent with the experimental data, which also suggests the possibility of identifying genomic markers of drug sensitivity for novel compounds on novel cell lines.
IntroductionCultured cell lines have, despite their inherent limitations, served as versatile preclinical disease models for cancer drug discovery (). Recent large-scale multi-omics initiatives have catalogued the somatic alterations of cancer cell line panels along with their pharmacological response to hundreds of compounds (), enabling us to now make links between the compounds' action and the V C The Author 2015. Published by Oxford University Press.
85This is an Open Access article distributed under the terms of the Creative Commons Attribution License (http://creativecommons.org/licenses/by/4.0/), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited. genetic makeup of a cell on a large scale. The US National Cancer Institute (NCI) pioneered these efforts by assembling the NCI60 tumour cell line panel, which, to date, has been assayed for its sensitivity to over 130 000 compounds and has been extensively profiled at the biological level (). Although these cell line collections have proved valuable to identify genomic markers of drug sensitivity () and even led to the development of new drugs (), the question now arises of how these pharmacogenomic dataset can be meaningfully mined, both to discover cancer subtype-specific drugs, and ultimately to aid in the design of personalized cancer treatments. Previous studies of the NCI60 panel include the identification of drug mechanism of action (MoA) (), visualization tools for drug sensitivity data () and drug sensitivity predictions based on the cell line profiling data (). Beyond algorithmic differences, the conceptual limitation shared by these models was the unfeasibility of extrapolating the data to novel compounds and cell lines simultaneously, as the cell line profiling data and chemical information were separately used as predictive features and were not integrated into a single machine learning model. To overcome this limitation, two recent studies have pioneered the combination of drug and cell line information [gene expression, gene copy number variations (CNVs) and mutation profiles] on the data from the Genomics of Drug Sensitivity in Cancer project (GDSC) for drug sensitivity prediction (). The first study () modelled the sensitivity of 608 cell lines to 131 drugs with Neural Networks and Random Forests, thereby obtaining a coefficient of determination (R 2 ) of 0.64 on an external set. The second study () applied kernelized Bayesian matrix factorization to model the sensitivity of 650 cell lines to 116 drugs, and obtained an R 2 value of 0.32 when predicting the activity for new drugs on a set of cell lines in the training set. The authors showed that the combination of chemical and cell line information indeed improved model performance, which permitted the interpolation of drug activities to complete the missing entries in the bioactivity matrix of 482 cell lines by 116 drugs. In this study, we now propose the simultaneous modelling of chemical and cell line information in a single machine learning model to predict the 50% growth inhibition bioassay end-point (GI 50 ) of 17 142 compounds screened against 59 cancer cell lines from the NCI60 panel. Conformal prediction was implemented to predict the confidence intervals (CI) for individual predictions. The integration of these different, yet complementary, streams of information is often termed proteochemometrics or pharmacogemonic (PGM) modelling (). In typical PGM models, each compoundcell line interaction is numerically encoded by the concatenation of the compound, U c (c d ), and cell line, U cl (cl d ), descriptors into a single vector, namely U pair (c d , cl d ). Although this encoding approach is widely used, other approaches exist (). For instance, in the case of kernel methods, each pair U pair (c d , cl d ) is encoded by the tensor product of U c (c d ) and U cl (cl d ) (). Subsequently, these descriptors are related in a single machine-learning model to the specific biological readout of interest (). In practical terms, PGM thereby helps us to understand complex relationships between the compound structures and cell line features and enables the estimation of the bioactivity for (novel) compounds on (novel) cell lines (). We curated cell line profiling data consisting of 59 cell lines that were characterized using various genetic and proteomic profiling methods. From this, we assembled 14 profiling datasets, denoted here as dataset views. We benchmarked their predictive signal, and demonstrated that the simultaneous modelling of the compound and cell line information improves the prediction of compound potency across the NCI60 panel compared with models trained on only compound information. Our modelling approach permits us to interpolate and extrapolate compound bioactivities to novel cell lines and tissues in the NCI60 panel, and, to a lesser extent, to chemically dissimilar compounds. Finally, we demonstrate that the predicted bioactivities can be used to estimate growth inhibition patterns across the NCI60 panel and that the predicted drug-pathway associations are consistent with the experimental data published in the literature.
Methods
DatasetsThe raw pGI 50 values (log 10 GI 50 , M) for 17 142 compounds were downloaded from CellMiner (database version 1.4) (). The mean pGI 50 values were calculated when several measurements were available for the same compoundcell line combination and the standard deviation of the replicates was considered as the experimental uncertainty of the measurements. The representation of the chemical structures (with respect to the aromaticity or stereochemistry) was normalized with the StandardiseMolecules function of the R package camb using the default values (). The final dataset consisted of 17 142 compounds versus 59 cell lines (the NCI60 panel, except for ME.MDA_N) and a total of 941 831 data points, which corresponds to a matrix completeness of 93.08%.summarizes the details of the profiling datasets used to describe the cell lines.
Compound descriptorsThe compounds were described with circular Morgan fingerprints in count format, which encode the compound structures via radial atom neighbourhoods (). The fingerprints were calculated with the R package camb (). The size of the fingerprints was set to 256 bits, and the maximum radius of the substructures considered was set to 2. We used the circular fingerprints because they have provided high retrieval rates in comparable studies ().
Compound clusteringThe compounds were clustered using periodic two-dimensional SelfOrganizing Maps (SOMs) (). Two dimensions, here 50  50, determine the map size in a periodic manner, whereas the third dimension contained the compound fingerprints. Each vector along the third dimension is called a neuron, v. The same fingerprints used to train the PGM models served as input vectors to the SOMs. The SOM values were initialized from a uniform distribution spanning the values present in the input vectors. At each training step, the most similar neuron to the input vector considered was updated. The conventional Unified distance matrix (Umatrix) was calculated to delineate the clusters. The U-matrix value associated with a given neuron, U heightv , is defined as the average Euclidean distance between that neuron and its eight closest neighbours: U heightv; l, where Nv is the set of neighbours and E d is the Euclidean distance between neurons. A distance threshold value was then applied to the U-matrix to define the contours of the compound clusters ().
Model trainingRandom Forest (RF) models () were trained with the ensemble.RandomForestRegressor module of the python library scikit-learn () using the following parameters: (i) number of trees in the forest: 100 (); (ii) criterion to assess the quality of a split: mean squared error; (iii) minimum number of data points to split a node: 1; (iv) minimum number of data points in a leaf to keep a given node split: 1; (v) maximum number of randomly selected descriptors considered when splitting a node (mtry): dimensionality of the input space. Radial-kernel Support Vector Machine (SVM) models were trained using the svm module of the python library scikit-learn ().. Pharmacogenomic modelling concept and illustration of the learning strategies explored. (a) The pGI 50 values for 17 142 compounds on 59 cancer cell lines (941 831 data points) were modelled with RF and SVM models and conformal prediction. (b) Illustration of the training data used in the following learning strategies: (b) 10-fold CV PGM models (interpolation); (c) LOCCO; (d) LOCO; and (e) Family QSAR. As can be seen in (be), the training data used in each learning strategy differs with respect to (i) the subset of data-points from the whole dataset used for training and (ii) the type and combination of input descriptors, which can be only compound descriptors, only cell line descriptors, or the combination of both. In all models reported in this article, Morgan fingerprints were used as compound descriptors, whereas the dataset views indicated inand four cell line kernels were used to encode the cell lines. Overall, this validation enabled us to assess the model's performance in real-world settings, where the extrapolation to novel cell lines and compounds is often a necessary stepThe abbreviated names used inare indicated in the second column. Prior biological knowledge, such as pathway information, was included in some dataset views, whereas the gene transcript levels and mutational status for genes implicated in cancer, kinases and ABC transporters were gathered independently and combined in the dataset views to assess the redundancy of their predictive signalThe parameter values were optimized with a 10-fold cross-validation (CV) and a grid search. The parameter grid was composed of the following values: (i) C: {2 8 , 2 6 ,. .. , 2 2 , 10 1 , 10 2 , 10 3 } and (ii) r: {2 8 , 2 6 ,. .. , 2 2 }. All calculations were performed on 16 Intel Xeon E5-2670 processors and a total memory of 256 GB. The training times on the complete dataset ranged between 6 and 8 h.
Learning strategies
PGM modelsIn the following, we define 'PGM models' as those models simultaneously trained on (i) compound descriptors and on (ii) one cell line profiling data set view. @BULLET Assessment of the interpolation power with a 10-fold CV (10fold CV PGM) model: a given dataset was randomly divided into (i) a training set comprising 90% of the data points and (ii) a test set comprising the remaining 10% of the data (). This process was repeated 10 times, each time leaving out a random subset of the data, which enabled the generation of predicted values for all data points. Thus, although the test set is comprised of compounds and cell lines that are also present in the training data, the training and test sets are comprised of different compoundcell line pairs. The interpolation power of these 10 models was evaluated on a per cell line and on a per compound cluster basis. To this end, the RMSE and R 2 0 values were calculated on subsets of the test set grouped by cell line (cell line-averaged performance) or by the compound cluster (compound cluster-averaged performance). @BULLET Leave-One-Compound-Cluster-Out (LOCCO) models (): all data points annotated on a given chemical cluster were left out as a test set; a PGM model was trained on the training set, and the values for the test set were predicted. These steps were repeated for each compound cluster. This scenario reflects the practical situation where a model predicts pGI 50 values for chemically novel compounds, and thus permits the assessment of the extrapolation capabilities of a PGM model in chemical space. @BULLET Leave-One-Cell-Line-Out (LOCO) models (): this validation scenario is similar to LOCCO, except that the data left out for the test set are now all of the data obtained for a particular cell line. This scenario intends to mimic the situation where the PGM model is employed to extrapolate the data to novel cell lines. @BULLET Leave-One-Tissue-Out (LOTO) models: The performance of the PGM models was further evaluated by extrapolating to cell lines whose tissue of origin was not present in the training set. This scheme is similar to LOCO, except for the fact that all of the cancer cell lines originating from the same tissue were left out from the training set each time. It was employed because cell lines from the same tissue, despite their genetic differences, often still share commonalities with regard to compound activity.To quantify the improvement of the PGM models over models exclusively trained on compound fingerprints (compound-only models), the following one-space learning strategies were explored ().
Compound-only (QSAR) models@BULLET Family Quantitative Structure-Activity Relationship (QSAR F): the models were exclusively trained using the compound fingerprints as the input features (). A QSAR F model serves to assess whether the explicit inclusion of the cell line information improves the prediction of compound activity; if the PGM model displays a performance very similar to the QSAR F model, the inclusion of cell line information would add little benefit to the modelling of compound activity. @BULLET Individual QSAR models per cell line: one QSAR model per cell line was exclusively trained on compound descriptors, which is, therefore, not able to include information from the biological side or measurements against other cell lines. In this case, the comparison was made with the compound cluster-averaged interpolation power of the PGM models to evaluate whether the integration of the compound and cell line information leads to higher predictive ability with respect to the per cell line QSAR models.
Cell line kernelsTo assess whether the explicit inclusion of the cell line profiling data as input variables provides a higher predictive signal than the cell line kernels (), which encode cell lines with a vector quantifying the similarity among cell lines in a given space (e.g. gene expression), we trained models with two sources of information, namely: (i) compound descriptors and (ii) one of the following cell line kernels: @BULLET Dirac kernel () or cell line identity fingerprints (CLIFP) (). CLIFP are binary descriptors of length equal to the number of different cell lines considered, where each bit position corresponds to one cell line. Formally, CLIFP are defined as CLIFPi; j  di  ji; j 2 1; :::; N cells , where d is the Kronecker delta function and N cells is the number of distinct cell lines. These descriptors are simply cell line indicator variables, and, therefore, no information on compound activity across different cell lines is shared during model training (). @BULLET Multitask (MLT) kernel (). This kernel encodes the cell lines in the following form: MLTi; j  1  di  j i; j 2 1; :::; N cells =2. When coupled to SVM, this kernel decomposes the model as a sum of two linear functions. The first function, common to all cell lines, learns the shared patterns of compound activity against all cell lines (e.g. substructures enriched for compound activity). The second function describes the aspects of compounds specific to each cell line. The cell lines are located at an equal distance, and information across cell lines can be shared during the learning phase (though their biological similarities and differences are not explicitly taken into account). @BULLET Cor. Transcriptome kernel. This kernel encodes cell lines by defining a N cells  N cells matrix where each i, j entry corresponds to the Spearman's Rank Correlation coefficient (r s ) of the transcript levels (log 2 ) of 19 965 genes () between cell lines i and j. @BULLET Cor. Proteome kernel. This case is similar to the previous kernel, with the difference that it considers the correlation of the protein levels of 8113 distinct proteins () for all cell line pairs.
Model validationThe predictive power of the models was assessed on the test set according to the RMSE test and R 2 0 test values ():where N represents the size of the test set; y i the observed, ^ y i the predicted, and y the average pGI 50 values of those data points included in the test set; and ^ y r0 i  s^ y, with s  P y i ^ y i = P ^ y 2 i .
Assessment of the maximum and minimum achievable model performanceTo assess the maximum and the minimum achievable RMSE test and R 2 0 test values based on the experimental uncertainty of the pGI 50 values, we generated the simulated data as follows:@BULLET Maximum performance. A sample, A, of the same size as the test set was randomly extracted from the vector containing the whole set of pGI 50 values. Subsequently, the experimental uncertainty (multiplied by 1 in half of the cases) was added to each data point in A, thus defining the sample B. We define experimental uncertainty as the standard deviation of replicate pGI 50 measurements. In cases where no experimental uncertainty was available for a data point, the mean of the available replicate-averaged experimental uncertainties, namely 0.27 pGI 50 units, was used. Next, the RMSE test and R 2 0 test values were calculated for A with respect to B. These steps were repeated 1000 times, which led to the distributions of the maximum achievable RMSE test and R 2 0 test values. @BULLET Minimum performance. The procedure was the same as in the previous case, except that sample A was randomized before calculating the RMSE test and R 2 0 test values.
Conformal predictionConformal prediction builds upon past experience, i.e. the data points in the training set, to define the confidence intervals (CI) for individual predictions, ^ y, with an error of 1  e, where e is the tolerated error. The non-conformity score, a new , for a new data point, x new , quantifies how distant it is with respect to the data points from the training set, X  fx i g n ii. Here, the non-conformity scores were calculated as: a new  jynew^ y new j ^ q ynew , where ^ q ynew is the predicted error for x new with an error model. The main advantage of conformal prediction is that the CI are always valid, i.e. a confidence of 0.8 means that the predicted confidence regions will contain the observed value in at least 80% of the cases (). To calculate and validate the predicted CI, the following protocol () was implemented. First, the entire dataset was randomly divided into an external set (20% of the data) and a training set (80%). The latter was subsequently split into a calibration set (30%) and a proper training set (70%). Thus, these three sets include data from the entire sets of cell lines and compounds. Two models were trained on the proper training set, the first of which predicted the pGI 50 values (point prediction model), whereas the second predicted the errors in the prediction (error model), ^ q. Both models were trained with the compound fingerprints and the 'G.t.l 1000 genes' dataset view as input features using the complete dataset. The point prediction model was generated by training an RF model on the proper training set with a 10-fold CV and with pGI 50 values as the dependent variable. The generated CV predictions served to calculate the residuals (i.e. prediction errors) for the data points in the proper training set. Subsequently, the error model was generated by training an RF model on the proper training set using these residuals as the dependent variable. The pGI 50 values and prediction errors were subsequently predicted for the calibration set and employed to calculate the vector of non-conformity scores for this set, which, after being sorted in increasing order, led to: a calib  fa calibj g N calib j1, where N calib corresponds to the number of data points in the calibration set. The a value for a given confidence level, namely a 1e , was calculated as follows: a 1e  a calibj if j bN calib  1  ec; where indicates identity. This corresponds to traversing the set a calib at its a 1e element, namely 1  e. Finally, the prediction errors (^ q y ) and the pGI 50 values (^ y) were predicted for the test set. The CI was calculated as: ^ y6 a 1e  ^ q y .
Pathwaydrug associationsThe average log 2 gene transcript level for the genes in each pathway of the MSigSB C2 Canonical Pathways gene set () was defined as the expression level of each pathway. To assess the association between the drug response (pGI 50 ) and the expression of a given pathway, we fitted a linear model considering the tissue type, T, as a blocking factor (Haibe-Kains et al., 2013), which was defined as: pGI 50  b p P i  b T T i  e; where P i corresponds to the average expression of pathway i in a given cell line, T i to the tissue of origin of that cell line, and e to the error term. The b p values determined the strength of the associations, whereas their significance was estimated by the statistical significance of b p (twosided t-test, a  0.05).
Results
Summary of the cell line profiling dataset viewsWe collected seven profiling datasets for 59 cell lines from the NCI60 panel, excluding ME.MDA-N due to the lack of gene transcript microarrays (). These molecular/phenotype datasets were combined in a variety of ways, which we termed dataset views in analogy to database views (). The dataset views may consist of (i) a profiling dataset, (ii) a subset thereof, e.g. gene transcript levels of gene sets or (iii) a modification of the dataset to which prior knowledge is added, e.g. the calculation of pathway expression levels based on knowledge of the cell signalling networks. A total of 14 dataset views were defined, which are summarized inand provided in the Supplementary Material. In addition to the complete dataset, comprising all available data and including 17 142 distinct compounds (Supplementary) and 941 831 data points, we assembled three additional datasets: (i) the uncorrelated bioactivities 0.5 dataset, comprising 3641 distinct compounds (199 940 data points) whose bioactivity distributions on the 59 cell lines exhibit standard deviations higher than 0.5 pGI 50 units (Supplementary); (ii) the uncorrelated bioactivities 1 dataset, comprising 165 distinct compounds (9376 data points) whose bioactivity distributions on the 59 cell lines exhibit standard deviations higher than 1 pGI 50 unit (Supplementary); and (iii) the high confidence dataset, exclusively comprising data points averaged over at least two experiments (304 212 data points and 5302 distinct compounds). The uncorrelated bioactivities 0.5 and 1 datasets served to assess the models' performance on compounds displaying a dynamic range of bioactivities across the cell line panel, while the latter dataset served to evaluate whether the models' performance improves when using replicate-averaged cell line sensitivity data (Supplementaryfor details).
Chemical space characterizationTo assess the chemical diversity in the data, we clustered the 17 142 compounds with SOMs (Supplementaryand Section 2.3), which resulted in the definition of 31 distinct chemical clusters. Several clusters, e.g. 4 and 18, are highly homogeneous, as highlighted by the high inter-neuron similarity (blue areas in Supplementary). In contrast, other clusters are comprised ofImproved large-scale prediction of growth inhibition patternsmore diverse compounds (shown in red in Supplementary). For instance, cluster 2 (Supplementary) is composed of polycyclic aromatic compounds with diverse halogen substituents and topologies. The definition of structural clusters will be employed later to examine the extrapolation power of the PGM models to chemically dissimilar structures.
Comparison between RF and SVMAlthough the statistical robustness of RF to model the chemical and biological data simultaneously has been empirically shown (), the mathematical notions by which information is shared across compounds and cell lines are poorly understood. Given that a comparison between the multi-task learning capabilities of RF and SVM in the field of pharmacogenomics is lacking, we first compared their performance in 10-fold CV when trained on the uncorrelated bioactivities 1 dataset using (i) compound fingerprints and (ii) either gene expression data or a cell line kernels as the input features (). We did not find statistically significant differences in the performance between the RF and SVM 10-fold CV PGM models trained on compound fingerprints and the dataset view 'G.t.l. 1000 genes' (P < 0.05). The performance of these models was comparable to that of the 10-fold CV PGM models encoding cell lines with the cor. GE and MLT kernels trained with RF and SVM, respectively (P < 0.05, labelled with 'a' in). Hence, in this dataset, encoding cell lines with kernels that are navenave with respect to the nature of the genomic makeup of the cell lines, in this case the MTL kernel, provides virtually the same predictive signal as the gene expression data, i.e. the 'G.t.l. 1000 genes' dataset view. Interestingly, the performance of SVM and RF across the cell line kernels explored was not constant, as the RF models outperformed SVM when using the cor. Proteome and Dirac kernels to encode cell lines, whereas the SVM models outperformed RF in the case of the MLT kernel, thus highlighting that information across compounds and cell lines is not shared in a similar way across RF and SVM. Based on the comparable predictive power of RF and SVM, we used RF to train all of the models presented in the following sections because RF (i) requires smaller training times than the kernel methods and (ii) are robust with respect to the value of their parameters (Supplementaryand).
PGM model validationThe PGM models trained on the complete dataset with 10-fold CV using compound fingerprints and the dataset view 'G.t.l 1000 genes' as input features exhibited mean RMSE test and R 2 0 test values of 0.40 6 0.00 pGI 50 units and 0.83 6 0.00 (n  10), respectively. These values were consistent with the theoretical maximum and minimum achievable performance, which were 1.42 and 0.35 pGI 50 units, respectively, for the RMSE test and 0.96 and0.96, respectively, for the R 2 0 test (Supplementary). Moreover, the model performance did not stem from chance correlations, as R 2 0 test values became negative when 75% of the pGI 50 values were randomized () (Supplementary). Modelling the high confidence dataset led to a similar performance, with an RMSE test of 0.45 pGI 50 units and an R 2 0 test value of 0.84. This indicates that the predictive power of RF does not decrease when we included the data points measured in only one experiment, which is in agreement with a recent benchmarking study on the noise sensitivity of machine learning algorithms in bioactivity modelling (). The 10-fold CV PGM models were further evaluated on the uncorrelated bioactivities 0.5 dataset, where RMSE test and R 2 0 test values of 0.58 pGI 50 units and 0.79, respectively, were observed. These RMSE test and R 2 0 test values were also in agreement with the maximum achievable performance estimated for the uncorrelated bioactivities 0.5 dataset (Supplementary).
Comparisons between the PGM and QSAR modelsTo test whether the PGM models display higher predictive power than per cell line QSAR models, we trained (i) the individual QSAR 10-fold CV RF models with increasingly larger training sets, whose performance was assessed on the held-out data (orange in), on the uncorrelated bioactivities 1 dataset and (ii) the 10-fold CV PGM). The CV RMSE test values on the left out sets in CV were used as a proxy to monitor the predictive power of the models. RF and SVM trained on the 'G.t.l. 1000 genes' dataset view displayed comparable predictive power, whereas RF and SVM exhibited diverse performance across the cell line kernels used in this study. Models sharing a letter label performed at the same level of statistical significance (Tukey's HSD, a  0.05). The blue points indicate the median and the interquartile range (25th75th percentile), whereas the red points indicate the mean RMSE test value. (b) Comparison between the individual QSAR and PGM models. The 10-fold CV Ind. QSAR models were trained on increasingly larger training sets and their performance was assessed on the left out data (orange). Thus, each point in the figure corresponds to the average 10-fold CV RMSE test value across 59 models (one per cell line). The 10-fold CV PGM models were trained jointly on the compound and cell line descriptors ('G.t.l. 1000 genes' dataset view). For each model, the training set comprised a fraction of the data annotated on a given cell line (x-axis) and a percentage of the data annotated on the remaining cell lines (indicated in the legend). Overall, lower RMSE test values are obtained when integrating information from several cell lines, indicating that the PGM models enable us to share information across cell lines and compounds, thereby outperforming the individual QSAR models RF models on the compound and cell line descriptors ('G.t.l. 1000 genes' dataset view). In the latter case, the training set comprised an increasingly larger percentage of the data annotated on a given cell line (x-axis in) and an increasingly larger percentage of the data annotated on the remaining cell lines (indicated in the legend of). We consistently obtained lower RMSE test values with the PGM models than with the individual QSAR models, indicating that PGM modelling enables the sharing of information in the biological and chemical space. Likewise, the RMSE test values systematically decreased as more data were added to the training set in the PGM models. The biggest RMSE test difference between the individual QSAR and the PGM models were obtained when the least amount of data (5 or 10%) was assigned to the training set, whereas the lowest difference was found when almost all of the data available on a given cell line was used for training. This indicates that integrating data across different cell lines seems more beneficial when the data are relatively scarce. On the complete dataset, the 10-fold CV PGM models slightly outperformed models trained exclusively on compound descriptors, namely QSAR F, with RMSE test and R 2 0 test values of 0.45 pGI 50 units and 0.78, respectively. These results indicate (compared to an RMSE test value of 0.40 pGI 50 units and R 2 0 test  0.83 for the 10fold CV PGM model) that the pGI 50 values of the compounds are largely correlated across the cell line panel. However, the 10-fold CV PGM models increased the relative performance over the QSAR F models on the uncorrelated bioactivities 0.5 dataset, with respective RMSE test values of 0.58 versus 0.69 pGI 50 units, respectively, highlighting the finding that the PGM models appear to be more suitable for modelling compounds exhibiting an uncorrelated pGI 50 value on a cell line panel. Moreover, the 10-fold CV PGM models significantly outperformed individual cell line models, i.e., QSAR (two-sided t-test, a  0.05, P < 0.05), trained on the data points corresponding to a given cell line that exclusively used the compound descriptors as the input features. These individual models displayed an average RMSE test value of 0.73 6 0.05 pGI 50 units (Supplementary). Therefore, integrating the biological information from different cell lines in a single PGM model improves the compound sensitivity prediction on the NCI60 panel over the QSAR models, and even more so in cases where activities across cell lines show less of a correlation.
Benchmarking the cell line profiling datasetsTo benchmark the predictive signal across the 14 dataset views, we used the uncorrelated bioactivities 0.5 dataset, as it contains the compounds displaying the least correlated pGI 50 values on the cell line panel and thus is more challenging to model. For each dataset view, we trained a 10-fold CV PGM model using that dataset view and the compound fingerprints as the input features, which resulted in a total of 140 models (14 data set views  10 CV folds). An analysis of variance (ANOVA) on the RMSE test values () yielded significant differences between the models (P < 1  10 17 ). Similar to previous reports (), we have also observed that the gene transcript levels led to the highest predictive power, with median RMSE test values in the 0.560.58 pGI 50 units range (). However, the combination of transcript levels from different gene sets, e.g. kinases and ABC transporters (), did not translate into increased performance, suggesting that these dataset views might contain redundant predictive signal. In addition, there were no significant differences in performance between the models trained on the gene transcript levels and those trained on the miRNA abundance or RPLA data [Tukey's Honestly Significance Difference (HSD), P value < 0.. Interestingly, the performance of the models trained on the CNV or exome sequencing data was significantly worse (), with RMSE test values in the 0.630.68 pGI 50 units range. This poorer performance could possibly be expected given the sparseness of these data, as the percentage of nonzero entries in the CNV and exome-seq matrices is 2.66 and 0.03%, respectively.
Bioactivity interpolation to the cell lines and compound clusters present in the training setThe interpolation power of the 10-fold CV PGM models was evaluated by calculating the RMSE test values on subsets of the test set) and two cell line kernels, namely cor. Proteome and cor. Transcriptome, was quantified by the RMSE values on the test set. For each dataset view, we trained the 10-fold CV PGM models on the uncorrelated bioactivities 0.5 dataset. We found significant differences among the dataset views (ANOVA, P < 0.01). Post-hoc analyses (Tukey's HSD, a  0.05) were used to cluster the dataset views according to their predictive power. Dataset views sharing a letter label performed at the same level of statistical significance. We consistently found that the gene transcript levels and the abundance of proteins and miRNA led to the most predictive models (labelled with 'a'). (b) The evaluation of both interpolation and extrapolation power was evaluated on the complete dataset. After finding significant differences across groups (ANOVA, P < 0.01), we found that the PGM models interpolate and extrapolate to new cell lines and tissues at the same level of statistical significance (Tukey's HSD, a  0.05). In contrast, we found statistically significant differences in the performance between extrapolation and interpolation to new chemical clusters. The blue points indicate the median and the interquartile range (25th75th percentile), whereas the red points indicate the mean RMSE valueImproved large-scale prediction of growth inhibition patternsgrouped by the cell line, cell line-averaged (Supplementary), or compound cluster, compound cluster-averaged performance (Supplementary). Thus, one average RMSE test value across the 10-fold models was calculated for each cell line and compound cluster. If not otherwise indicated, the results presented in the following sections correspond to models trained on the uncorrelated bioactivities 0.5 dataset with (i) compound fingerprints and (ii) the 'G.t.l. 1000 genes' dataset view as the input features. The cell lineaveraged RMSE test values ranged from 0.41 6 0.01 (U251) to 0.86 6 0.01 pGI 50 units (HOP-92). We found significant differences for the tissue-averaged performance (Tukey's HSD, P < 1  10 16 ), with RMSE test values ranging from 0.48 6 0.01 (prostate, displayed in cyan) to 0.70 6 0.01 (leukaemia, displayed in green) pGI 50 units (Supplementary). In addition, the learning curves showed that the RMSE test values of approximately twice the replicate-averaged experimental uncertainty (0.27 pGI 50 units) and the maximum achievable performance (0.35 pGI 50 units) can be obtained when <10% of the data is used as a training set (Supplementary). In contrast, an ANOVA analysis did not yield significant (P > 0.05) differences among the 31 chemical clusters (Supplementary), with observed median RMSE test values in the 0.480.65 pGI 50 units range. Hence, overall, it has been found that the interpolation power is constant across the 31 chemical clusters, but not across tissues.
Extrapolation in the cell line and tissue spaceWe further evaluated the extrapolation power to novel cell lines and tissues with the LOCO and LOTO models using the complete dataset. The LOCO models exhibited mean RMSE test values of 0.43 6 0.08 pGI 50 units (and Supplementary), with the lowest and highest RMSE test values of 0.31 and 0.61 observed for cell lines U251 and OVCAR-5, respectively. Notably, we found that the LOCO and cell line-averaged predictions are highly correlated (r s  0.92), indicating that interpolation and extrapolation to novel cell lines are correlated. The RMSE test values for the LOTO models ranged between 0.35 (prostate) and 0.63 pGI 50 units (leukaemia). Remarkably, the prediction errors were similar across the entire bioactivity range (Supplementary). Overall, we did not observe significant differences in performance among the LOCO, LOTO (), cell line-averaged (Supplementary), and compound cluster-averaged (Supplementary) results (Tukey's HSD, P < 0.05). We found that the RMSE values between the observed and predicted pGI 50 values calculated using the LOCO and LOTO models for 47 out of 81 drugs, such as Imiquimod (NSC 369100) and Bendamustine (NSC 138783), were below 0.5 pGI 50 units (Supplementaryand b). High RMSE values, between 1 and 1.5 pGI 50 units, were observed for 11 drugs, such as the folate antimetabolite pemetrexed (NSC 698037) and Irinotecan (NSC 728073). Together, these data indicate that the PGM models extrapolate compound bioactivities to novel cell lines and tissues at the same level of statistical significance as for interpolation within a given cell line or tissue.
Extrapolation in the chemical spaceA markedly different trend was observed for the ability of the PGM models to generalize across the chemical space, as assessed by the LOCCO models using the complete dataset. The LOCCO models exhibited mean RMSE test values of 0.83 6 0.17 pGI 50 units (and Supplementary), which differed significantly from the LOCO and LOTO results () (Tukey's HSD, P < 0.01), and from the compound cluster-averaged interpolation performance (Supplementary). Notably, the chemical diversity within the compound clusters was not correlated with model performance, as low RMSE test values were consistently obtained for the heterogeneous and homogeneous clusters (and Supplementary). The lowest RMSE test value of 0.53 pGI 50 units was obtained for cluster 24, which contains 485 compounds with polycyclic ring systems, generally with no more than three fused rings, as well as ring assemblies linked by sulphide, sulfinyl, secondary amine, carbonyl and alkyl groups (Supplementary). Cluster 16, which was modelled with the highest RMSE test value of 1.23 pGI 50 units, contains tri-and tetracyclic systems with hydroxybenzene, methoxybenzene and quinone functionalities. We obtained errors in prediction values below 0.5 pGI 50 units for 15 out of 81 drugs in the complete dataset, and below 1 pGI 50 units for 43 compounds. The worst predicted drugs were depsipeptide (NSC 630176) and the halichondrin B analogue NSC 707389, with respective errors in prediction of 4.29 and 4.35 pGI 50 units (Supplementary). Taken together, these results indicate that the range of errors is considerably large (>4 pGI 50 units), and, hence, extrapolations in the chemical space remain a challenging task, and certainly on this particular dataset.
Conformal prediction provides informative CIConformal prediction was included in the modelling framework to provide CI for the individual predictions. The percentage of data points for which the predicted value lay within the calculated CI, which were calculated with an increasing confidence level, is highly correlated with the confidence level (Spearman's r s > 0.99, Supplementary). Therefore, the combination of the Random Forest and conformal prediction estimates the compound activity as a pGI 50 region associated to a user-defined confidence level, which represents an easily interpretable estimate of the reliability of individual predictions.
Consistency of pathwaydrug associations with predicted bioactivitiesTo investigate whether the bioactivities predicted by the PGM models make it possible to identify genomic markers of drug sensitivity, we evaluated the consistency between the pathwaydrug associations inferred from the experimental and predicted bioactivities for the 37 FDA-approved drugs and the 19 compounds in the clinical trials (Supplementary) present in the uncorrelated bioactivities 0.5 dataset. For each pathway, we fitted a linear model controlled by the tissue source, where the average pathway expression was considered as the predictor of drug sensitivity. Overall, no significant differences (Tukey's HSD, P < 0.05) were observed between the pathwaydrug associations calculated with the most predictive 10-fold CV PGM (Supplementary) and LOCO models, as the median Spearman's r s values between the b p coefficients estimated with (i) the experimental cell-line sensitivity data and (ii) the CV and LOCO predictions were in the 0.750.91 range (Supplementary). These results indicate that the 10-fold CV and LOCO predictions reflect the association between gene expression summarized at the pathway level and the cell line sensitivity. However, significant differences were found among these groups and the LOCCO and LOTO models, for which the median Spearman's r s values were 0.63 and 0.03, respectively. We obtained similar results when considering only the pathways significantly associated to drug response [false discovery rate (FDR) < 20%] (Supplementary). Next, we analysed whether the pathwaydrug associations are consistently predicted for drugs exhibiting diverse MoAs. Out of the 56 drugs considered, 26 exhibited median Spearman's r s values between the b p coefficients estimated with the experimental cell line sensitivity data and the 10-fold CV predictions in the 0.50.75 range, and 18 were above 0.75 (Supplementary). High Spearman's r s values were obtained across the 22 distinct drug MoAs, indicating that no specific MoA is favoured. Notably, most Spearman's r s values increased (Supplementary) when the calculation of the pathwaydrug associations was restricted to the pathways significantly associated to drug response (FDR < 20%). Together, we can conclude that the identification of genomic markers of drug sensitivity is significantly dependent on the presence of cell lines originating from the same tissue and structurally similar compounds in the training set.
Prediction of the growth inhibition patterns using the NCI60 panelThe experimental and predicted growth inhibition patterns obtained by the most predictive models were highly correlated (Supplementary), with median Spearman's r s values in the 0.530.58 range, and 32 out of the 56 drugs from the uncorrelated bioactivities 0.5 dataset had values higher than 0.5 for (Supplementary). Nevertheless, the LOCO, LOTO and LOCCO models (Tukey's HSD, P value < 0.001) displayed a marked decrease in the r s values (Supplementary) with respect to the most predictive 10-fold CV PGM models. The relative growth inhibition values using the NCI60 panel can be depicted in a bar plot with the pGI 50 values transformed into zscores.depicts the observed and predicted growth inhibition patterns for methotrexate (MTX) via the 10-fold CV PGM model. MTX was chosen for illustration, given its complex growth inhibition pattern. (Bar plots for the 56 drugs calculated with the predictions obtained with the 10-fold CV PGM, LOCO, LOTO and LOCCO models are provided in the Supplementary material.) The predictions accounted for 55 out of 59 cases for the relative sensitivity of the cell line. For instance, the six leukaemia cell lines (green turquoise) were predicted to be sensitive to MTX. Moreover, complex inhibition patterns for renal-derived cell lines (light magenta) were accounted for by the predictions, as the TK-10, RXF-393 and A498 cell lines were predicted to be highly resistant to MTX, whereas the effect of MTX on sensitive cell lines, namely UO-31, SN12C, CAKI-1 and ACHN, was also correctly predicted (). Taken together, these data indicate that the drug sensitivity predictions were able to account for the complex patterns of cell line growth inhibition for this particular drug.
Comparisons to previous methodsWe compared our results with previous studies () by applying our modelling procedure to the GDSC and CCLE datasets using the Morgan fingerprints as the compound descriptors, and the gene transcript levels for the 1000 genes displaying the highest variance across the cell line panel to describe the cell lines (Supplementary Text and). For the GDSC dataset, we obtained lower mean RMSE test and higher
DiscussionThe primary goal of this study was to capitalize on the increasing amount of in vitro cell line sensitivity and molecular profiling data of cancer cells to predict the growth inhibition patterns of compounds on the NCI60 panel. Although the principles of pharmacogenomicPredicted relative growth inhibition pattern of growth inhibition in the 10-fold CV model (i.e. interpolation) along with the 75% CI calculated using conformal prediction. Complex, and overall matching, inhibition patterns are reflected by the predictions. For instance, the TK-10, RXF-393 and A498 renal cell lines (marked with an asterisk) were predicted to be highly resistant to MTX, whereas the effect of MTX on sensitive cell lines, namely UO-31, SN12C, CAKI-1 and ACHN, was also correctly predicted. Cell lines originating from the same tissue are in the same colour (breast: red, central nervous system: orange, colon: olive green, lung cancer: dark green, leukaemia: turquoise, melanoma: blue, ovarian: blue, prostate: purple, renal: magenta)Improved large-scale prediction of growth inhibition patternsmodelling are not new, this study represents novelty in the field, as, to our knowledge, it is the first effort to combine large-scale NCI anticancer screening data using the NCI60 panel with the available cell line profiling information, including error bars. Unlike previous modelling studies on the NCI60 panel (), we simultaneously integrated the chemical information and cell line profiling data, which enables us to predict the growth inhibition patterns and to inter-and extrapolate on the chemical and cell line domains. In addition, coupling conformal prediction to the Random Forest enabled the definition of CI for the individual predictions. We consistently found the highest predictive signals in the gene expression, miRNA and protein abundance data. The incorporation of prior biological knowledge by summarizing the gene expression data at the pathway level did not provide an additional predictive signal. Interestingly, high predictive power was attained with models trained on gene expression data from the genes displaying the most variable transcript levels across the cell line panel. Encoding cell lines with cell line kernels led, in some cases, to models with comparable predictive power to those trained explicitly on the cell line profiling data. Although encoding cell lines with cell line kernels may be sufficient to model the compound pGI 50 values from the NCI60 panel, in our view this would not be the case on datasets comprising highly dissimilar cell lines. In addition, we note, in particular, that the Dirac and MLT kernels do not permit us to extrapolate in the cell line space, likely rendering them less useful in those cases. The sparseness of the CNV and exome sequencing data may be the reason for the poor model performance, and, therefore, it remains to be seen whether the modelling of cell line panels with more comprehensive mutational data leads to better predictions (). A major challenge to the cell line sensitivity prediction is the extrapolation of compound bioactivities to novel cell lines and to structurally distinct compounds. We did not find significant differences in performance between the interpolation and the extrapolation to new cell lines (LOCO) and tissues (LOTO), with mean RMSE test values in all cases smaller than twice the mean uncertainty value of the bioactivity measurements. This observation enables the prediction of compound activities on cancer cell lines for which little bioactivity data are currently available; however, extrapolation is still improved by the presence of cell lines from the same tissue/ontogeny in the training set. Given that similar compounds exhibit similar growth inhibition profiles (), it was expected that the model performance would considerably decrease when predicting the activity of structurally dissimilar compounds. This was indeed the case because mean RMSE test values of approximately three times the average experimental uncertainty were obtained when extrapolating in the chemical space (LOCCO). Although the error in prediction should ideally be close to the experimental uncertainty, this performance may still be useful for compound prioritization. Previous studies have shown that adding physicochemical descriptors or increasing the bit-string length of the Morgan fingerprints (set to 256 here) leads to higher predictive power when modelling a highly diverse set of molecules (). Here, we did not obtain higher predictive power when increasing the bit-string length, when adding physicochemical descriptors to the compound fingerprints, or when using Morgan fingerprints in binary format (). Our approach displays a higher predictive ability (10% decrease of CV RMSE) than the methods previously applied to the GDSC dataset (Supplementary Text and Supplementary). Moreover, the application of our approach to the Cancer Cell line Encyclopedia (CCLE) () dataset led to statistically validated models, displaying R 2 0 test values of$0.74, which were comparable to those obtained on the GDSC and NCI60 datasets. Given that gene expression profiles for the 44 cell lines comprised in the CCLE and the NCI60 panel are highly correlated (Spearman's r s  0.88) (Supplementary), we suggest that PGM models trained on the NCI60 panel could be applied to the CCLE cell line panel, which could identify new purposes for the 17 142 compounds considered here (). It is also important to consider how the cell line sensitivity is quantified for the application of the type of model presented here. Fallahiapplied a multi-parametric analysis to a dataset comprising the activity of 64 anticancer drugs on 53 breast cancer cell lines. The results of this study indicate that the parameters of the doseresponse curve vary systematically and depend on both the cell line as well as the drug class. For instance, the MoA of a drug has a strong influence on drug efficacy (E max ), potency (IC 50 ) and on the steepness of the drug response curve. Overall, this study indicates that parameters other than the potency of the drug response curve should be considered in studies comparing drug activity, as they are likely to provide crucial insights into the biology of the cell line's response to drug treatment and into the drugs' MoA. An additional key aspect is the consistency of the in vitro cell line sensitivity data. A previous study () reported a rather low correlation of the cell line sensitivity data from the CCLE and GDSC datasets. We found low concordance between the NCI60 and the CCLE sensitivity data (Supplementary), and we did not obtain a high correlation between the predictions calculated with a model trained on the NCI60 data for eight drugs on 44 cell lines shared by the CCLE and the subset of the NCI60 cell lines considered here. Actually, the RMSE values for these predictions against the experimental data from the CCLE and, the pIC 50 values from the CCLE and the pGI 50 from the NCI60 dataset for these eight drugs and 44 cell-lines was comparable, namely 0.87 log 10 units, indicating that high predictive power cannot be attained given the low concordance of the sensitivity data from these two datasets. These results come as no surprise, given the different surrogates of cytotoxicity exploited by the assays used to screen the CCLE and NCI60 panels, namely metabolic activity and protein abundance, respectively. Therefore, we conclude, in accord with Haibe, that models trained on the NCI60 data set are likely to fail on sensitivity data measured with a different experimental procedure, e.g. the CCLE or GDSC datasets. Finally, although cultured cell lines and primary tumours differ genetically () and 2D cell lines cultures do not recapitulate the complex tumour microenvironment, investigating the extent to which gene expression (and other cell line profiling) data can be used to model in vitro cell line sensitivity can help researchers to develop approaches for the prediction of clinical drug responses using the genomic data of tumour samples ().
I.Cort s-Ciriano et al. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
