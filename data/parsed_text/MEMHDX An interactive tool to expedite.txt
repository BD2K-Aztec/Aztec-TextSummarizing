Motivation: With the continued improvement of requisite mass spectrometers and UHPLC systems, Hydrogen/Deuterium eXchange Mass Spectrometry (HDX-MS) workflows are rapidly evolving towards the investigation of more challenging biological systems, including large protein complexes and membrane proteins. The analysis of such extensive systems results in very large HDX-MS datasets for which specific analysis tools are required to speed up data validation and interpretation. Results: We introduce a web application and a new R-package named " MEMHDX " to help users analyze, validate and visualize large HDX-MS datasets. MEMHDX is composed of two elements. A statistical tool aids in the validation of the results by applying a mixed-effects model for each peptide, in each experimental condition, and at each time point, taking into account the time dependency of the HDX reaction and number of independent replicates. Two adjusted p-values are generated per peptide, one for the " Change in dynamics " and one for the " Magnitude of âˆ†D " , and are used to classify the data by means of a " Logit " representation. A user-friendly interface developed with Shiny by RStudio facilitates the use of the package. This interactive tool allows the user to easily and rapidly validate, visualize and compare the relative deuterium incorporation on the amino acid sequence and 3D structure, providing both spatial and temporal information. Availability: MEMHDX is freely available as a web tool at the project home page http://memhdx.
INTRODUCTIONHydrogen Deuterium eXchange followed by Mass Spectrometry (HDX-MS) is a biophysical tool in structural biology capable of probing protein/ligand interactions, conformational changes, and protein folding and dynamics. Despite an increased number of applications , the expansion of the technology has been slowed by its intrinsic technical and analytical complexity (i.e., digestion at pH 2.5 and rapid HPLC separation at 0C). With recent advancements in sample preparation robotics, refrigerated ultra-high performance liquid chromatography systems and high resolution mass spectrometers, HDX-MS has surged in popularity and is now emerging from the academic benchtop to the expanse of the pharmaceutical sector .The use of improved HDX-MS workflows enables the structural analysis of larger protein systems such as antigenantibody complexes (> 180 kDa) or integral membrane proteins, in a more routine way. The characterization of such systems results in very complex HDX-MS datasets, for which specific non-commercial analytical software (e.g.,), as well as commercial platforms (e.g., DynamX and HDExaminer), have been developed. Such software extract deuterium incorporation information from (un)processed raw m/z data files and produce deuterium uptake curves that can pinpoint regions of interest on protein 3D structures. However, many of these tools do not integrate statistical approaches and use the absolute difference of deuterium uptake to evaluate the significance between conditions. Hydra (or Mass Spec Studio) was the first standalone application to introduce a Student's t-test and p-values to statistically evaluate the difference across HDX-MS experiments. Alternatively, Houde and co-workers calculated confidence limits based on the experimental uncertainty of measuring deuterium uptake across replicates. In this context, two distinct confidence limits were calculated manually using either the differences of deuterium uptake, or the summed value of HDX differences measured for each peptide, in each condition, and at each time point. Lastly, HDX Workbench includes a two-tailed ttest and Tukey multiple comparison procedure for the statistical cross-comparison of two or more datasets. Despite significant efforts to design requisite statistical tools, the aforementioned software solutions are suitable to analyze HDX-MS data at one time point only, failing to account for the time-dependency of the HDX-MS reaction. Thus, Liu and coworkers proposed a multiple regression or ANCOVA model. By deriving a statistical test based on the model parameters, they evaluated the significant difference between two groups under comparison, for all peptides in the dataset, and across all independent replicates. Expanding on this, we introduce a web application named " MEMHDX " (Mixed-Effects Model for HDX experiments) to aid in the rapid statistical validation and visualization of large HDX-MS datasets. MEMHDX uses a linear mixed-effects model where replicates are considered as random effects. This accounts for both the time dependency and the variability across replicates. Moreover, instead of testing the variation in global deuterium exchange between two experimental conditions, we propose to calculate two individual p-values for each peptide. Firstly, the difference between conditions is measured (p-value for the " Magnitude of Delta Deuterium (D) " ), followed by the evolution of the deuterium uptake behavior over the time course of the experiment (p-value for the " Change in dynamics " ). MEMHDX therefore allows the clustering of each peptide in the dataset based on these two respective pvalues. A user-friendly interface developed with Shiny by RStudio facilitates the use of the application, allowing the user to easily visualize and compare the relative deuterium incorporation across the entire protein sequence and 3D structure. As a test system, we used the receptor-binding Repeat-in-ToXin (RTX) domain of CyaA produced by Bordetella pertussis, the causative agent of whooping cough, to pinpoint regions undergoing structural and conformational changes upon calcium binding .
METHODSThe description of the MEMHDX workflow is reported in. MEMHDX is composed of two independent elements: a statistical tool written in R for the validation of HDX results, and a web interface developed with Shiny. Details of the mixed-effects model, the Shiny web interface and the outputs are given below.
The MEMHDX R-package
The mixed-effects modelThe aim was to compare the exchange behavior of a defined set of N peptides derived from the same protein placed in two distinct states. The incorporation was measured at T time points (t1,,tT) for all peptides in both biological conditions, and the experiment was repeated R times. Ya,i,r,t corresponds to the deuterium incorporation value measured for peptide ( ), at each time point (), for each replicate ( ) and condition ( ), and can be calculated using: , ,,where M and M0 correspond to the mass of the labeled and unlabeled peptide, c represents the extracted centroid value (m/z), and z the peptide charge. Thus, we consider the following linear mixed-effects model:where is the vector of observations , t, i and ti correspond to the vectors of fixed effects for the time, the condition and the interaction between time and condition, the vector of random effects (i.e., replicates), and the vector of random errors. In our model, the time t, the condition i, and the interaction between t and i are considered as fixed effects. The condition and the interaction represent the two parameters of interest. The replicates are considered as a random effect.
The statistical inferenceThe " nmle " R package was utilized to estimate the vectors of fixed effects () and ur (http://CRAN.Rproject.org/package=nlme). The restricted maximum likelihood method was used to fit the linear mixed-effects model. To evaluate the statistical significance of the, DynamX). The .csv file is uploaded to MEMHDX where a linear mixed-effects model is applied to statistically validate the dataset. Main results are displayed on a " Logit " representation (for data clustering and validation) and visualized using a global summary plot and the 3D structure, where available. A user-friendly ShinyInterface facilitates the use of the application. condition and the interaction on the rate of deuterium incorporation of the protein, two p-values were calculated per peptide, using two individual Wald tests. The conditionassociated p-value (hereafter referred to as pvalueMagnitude_of_Delta_D) tests the null hypothesis of there being no difference in deuterium uptake between condition 1 and 2; the interaction-associated p-value (hereafter referred to as p-valueChange_in_dynamics) tests the null hypothesis of there being no change in the deuterium uptake behavior between condition 1 and 2 and takes into account the time dependency of the HDX reaction (see Comment 1 of Supplementary Material). A multiple testing procedure was applied to adjust the significance level of each Wald test. In this work, the False Discovery Rate (FDR) criterion was used instead of the classical familywise error rate to achieve higher statistical power .
User interface and data output
The " Start analysis " windowTo facilitate the use of the MEMHDX R-package, a userfriendly interactive web interface was developed with Shiny by RStudio (http://shiny.rstudio.com). The " Start analysis " window (Supplementary) contains a short reminder of the main variables required in the input .csv file, i.e., the sequence and position of each peptide in the protein, charge state z, extracted centroid m/z values for each time point and replicate and in each condition, exposure time (min), number of replicates, and the maximum number of exchangeable amide hydrogens (MaxUptake) that could be theoretically replaced into the peptide. MaxUptake corresponds to the number of amino acid residues contained in the peptide, minus the number of proline residues and minus one for the N-terminus that back-exchanges too rapidly to be measured. Once the .csv file is loaded, the system informs the user of any missing variables. Missing centroid m/z values are allowed; in such a scenario, they are automatically replaced by the mean value across all replicates.Before starting any analysis, two user-defined parameters must be defined: the statistical significance value (%) corresponding to the desired stringency of the analysis, and the percentage of deuterium (D) contained in the final labeling solution (Supplementary). The latter is used to calculate the Relative Fractional Uptake (RFU) values. MEMHDX automatically generates RFU values as follows:where Ya,i,r,t corresponds to the deuterium incorporation value measured for peptide at each time point t. RFU can be viewed as normalized deuterium uptake values (i.e., the number of incorporated deuterium becomes independent of the length of the peptide) and are utilized to generate the global visualization charts.
Data outputOnce processing is complete, the " HDX-MS Results " panel appears below the " Start analysis " window. This is composed of six independent tabs, namely Raw Data, Peptide Plot, Logit Plot, Global Visualization, 3D Structure and Summary. The " Raw Data " tab lists all the variables included in the .csv file. The " Peptide Plot " tab (Supplementary) allows the user to control the quality of the fitted model for each peptide and to evaluate the reproducibility across replicates. The " Logit Plot " tab summarizes the main statistical results (Supplementary). This is divided into three sections. The " plot options " section is used to adjust the options of the plot (size points, max distance in pixels) and the export. The center area displays the " Logit " representation, where each dot represents one individual peptide. The Logit function of the two p-values defines the position of each peptide in the graph. The red lines correspond to the statistical significance threshold for the " Magnitude of D " (vertical line), and for the " Change in dynamics " (horizontal line), thus dividing the " Logit " Plot into four regions (Supplementary): peptides only statistically significant for the " Change in dynamics " or the " Magnitude of D " are located in the " a " and " b " region, respectively; statistically significant peptides in both states are clustered in the " c " region; statistically nonsignificant peptides are displayed in the " d " region. The " Logit " viewing mode of MEMHDX provides a rapid and effective way to discriminate statistically significant from non-significant peptides and to classify each based on their respective HDX behavior. The final section appears at the bottom of the " Logit " screen after selection of an individual peptide in the " Logit " representation (not shown). MEMHDX automatically displays a summary table containing the mean incorporation (in Da) per time point, and state, and associated " Logit " values. This summary table can be exported into a .csv format. The identity of each peptide (i.e., sequence, position and deuterium uptake curves) appears below the " Logit " plot when the mouse cursor is hovered over a dot. The " Global Visualization " and the " 3D Structure " tabs are dedicated to the visualization of the HDX data and contain two sections (Supplementary Figures 1B3, 1B4). The left section allows the user to navigate through the different parameter options. The right section of the " Global Visualization " summarizes the deuterium uptake behavior observed in the two states (Supplementary, upper and middle charts). The RFU values calculated by MEMHDX are plotted as a function of peptide position. In addition, the lower chart plots the difference in RFU between state 1 and 2, providing a more quantitative assessment of the difference between states. Statistically significant peptides are highlighted in gray. The right section of the " 3D Structure " tab displays the mapping of the HDX results on the crystal structure of the protein (Supplementary). Finally, the " Summary " tab recaps the different parameters used by MEMHDX to perform the statistical analysis and includes an export option for both the raw data and statistically relevant results (not shown).
RESULTS AND DISCUSSIONMEMHDX was developed to complement the HDX-MS pipeline commercialized by Waters Corporation. The software is fully compatible with the main output generated by DynamX (i.e., cluster data), but has been designed to handle data from any HDX-MS platform, as long as the input file is structured in .csv format and with the appropriate architecture, i.e., columns listed in Panel 1 of Supplementary. MEMHDX was evaluated using our recently published differential HDX-MS dataset generated with the C-terminal Repeat-in-toxin Domain (RD, 701 residues) of the CyaA toxin. Briefly, we used HDX to identify and locate secondary structural elements in the intrinsically disordered Apo-RD protein, and followed its transition to a more compact and folded state upon calcium binding. In total, 13 experimental time points were selected, and all data was collected in triplicate.
Pre-processing and dataset quality controlA total of 602 peptic peptides of RD were identified by ProteinLynX Global Server (Waters Corporation) using the default search parameters, of which 198 remained after filtering by DynamX. Following this, 162 were selected for HDX analysis and covered 98.4% of the RD sequence (Supplementary). Considering 162 peptides, 1 charge state, 3 replicates, 14 time points (including the unlabeled control) and 2 conditions, we have up to 13,608 unique data points in the complete test dataset. This demonstrates the complexity of datasets acquired using modern HDX-MS pipelines, the processing and interpretation of which is extremely challenging and timeconsuming by traditional, manual means. The current version of MEMHDX can only handle one unique charge state per peptide. A pre-processing step is required by the user to select the most appropriate charge state for analysis. The quality determination of the dataset is directly accomplished by MEMHDX. A Box and Whisker plot displaying the agreement across replicates is automatically generated (Supplementary). For each peptide, the calculated deuterium uptake values (Ya,i,r,t) are averaged across all time points in each respective state. This comparison is possible as each replicate is considered as an independent variable. A scoring function (loglikelihood) is determined per peptide to easily control the quality of the fitting. MEMHDX includes a filtering option to sort each peptide according to this score and to remove those with a low fitting quality from the analysis.
Statistical analysis and peptide clusteringA central feature of MEMHDX lies in its ability to classify peptides based on their respective HDX behaviors. MEMHDX automatically summarizes and displays the statistical results by means of a " Logit " representation. Two adjusted p-values are calculated by the software and define the position of each peptide in the " Logit " plot (). On the one hand, the magnitude of D-associated p-value defines the magnitude of difference of deuterium uptake between the two states investigated, while on the other; the change in dynamics-associated p-value describes the timewise evolution of HDX behavior between states. Considering the magnitude of D only, the significance increases (i.e., p-value decreases) as the peptide position moves from right to left on the plot, due to the greater magnitude of change observed between states. Similarly, the significance of change in dynamics increases as the peptide position moves from top to bottom. Deuterium uptake curves for selected peptides are displayed into illustrate the clustering performed by the software. Statistically non-significant peptides are clustered in the top(A) " Logit " plot obtained with RD. The effect of calcium binding on the deuterium uptake behavior was measured on 162 RD peptides. Each dot corresponds to one unique peptide. Peptides are classified and color-coded based on their respective HDX behavior: peptides showing dynamic events in both the Apo-and Holo-state are colored in gray; peptides only dynamic in the Apoor Holo-state are colored in red and blue; non-dynamic peptides in both states are colored in green. The statistical significance threshold was set to 1%. (B) Deuterium uptake curves for selected peptides in the Apo-(open circles) and Holo-(filled squares) states. The position of each in the " Logit " plot is also reported. right-hand corner (e.g., peptide 349-365). Statistically significant peptides for the magnitude of D only are found at the top of the plot (e.g., peptide 395-401), whereas those significant for the change in dynamics only are plotted on the far right (not applicable to this dataset). Those peptides which are significant for both states are located in the center of the plot. Comparing peptides 395-401, 499-506 and 246260 allows us to easily visualize the effect of a change in the magnitude of D-or the change in dynamics-associated pvalue. Peptides 395-401 and 499-506 possess the same magnitude of D-associated p-value, but are separated by their differing change in dynamics-associated p-value. This difference is directly linked to the change of HDX behavior observed in peptide 499-506 in the presence of calcium, which is not observed in the other peptide (). Conversely, peptides 499-506 and 246-260 differ only by their magnitude of D-associated p-value because the magnitude of difference between states is less for the former, than the latter. MEMHDX enables the user to color code all peptides in each state based on their respective HDX behavior (). Dynamic peptides in two states are colored in gray (e.g., peptide 587-594), whereas those which are dynamic in one or the other state are colored in red or blue [Apo-RD (e.g., peptide 633-639) in red, and Holo-RD (e.g., peptide 499-506) in blue herein]. Non-dynamic peptides are colored in green (e.g., peptide 395-401). Results generated with MEMHDX were compared to those manually obtained for RD. Excellent agreement was observed between the automated software and the manual approach. However, the speed of analysis was greatly increased by MEMHDX and the validation completed in one full day (10 to 15 sec to generate the statistical results by the software, followed by several hours of user interpretation), compared to up-to two weeks by manual analysis. Visually speaking, the difference in deuterium uptake between the two states was too small to be considered as significant in the manual analysis of some peptides. With the introduction of two independent p-values, the sensitivity of MEMHDX over the manual approach is enhanced. This is apparent for RD region 1-25, where segment 16-25 was considered as non-significant in the manual analysis, whereas was found to be statistically relevant by MEMHDX (Figures 3A and B). This illustrates the advantages of our automated MEMHDX approach over manual means.
Global and 3D visualizationMEMHDX integrates two visualization tools to facilitate the interpretation of the HDX results. The " global visualization " tool contains two distinct plots. The relative fractional uptake plot enables the user to directly visualize and compare the relative deuterium uptake and the exchange behavior of each peptide across the entire protein sequence, providing both spatial and temporal information (). Using this representation, the regions of the RD-protein containing residual structural elements in the Apo-state or acquiring secondary structures in the Holo-state, are easily identified. The second plot displays the difference in relative fractional uptake between the two states (). A high uptake difference indicates that the peptide incorporates more deuterium in state 1 than in state 2 and vice versa. This is the case for peptide 203-209 of RD, which incorporates more deuterium in the Apo-state than in the Holo-state, indicative of a calcium-induced protective effect (). In addition, the statistical results are reported on the differential uptake plot. Statistically non-significant peptides are highlighted in white, whereas those displaying significant p-values in gray. The second visualization tool allows the mapping of the HDX results on the 3D structure of the protein (Figures 3C and D). The user can either download a PDB file or enter theProtein DataBank identifier of the protein. In this scenario, MEMHDX will automatically retrieve and display the structure from the protein databank archive. Differential exchange behaviors will be color-coded to distinguish modified from unmodified regions (Figures 3C and D).
CONCLUSIONSMEMHDX is a statistical tool designed to aid in the analysis of large HDX-MS datasets. The initial concept of the software was to complement the HDX-MS solution provided by Waters Corporation, which is to-date, the only complete automated pipeline commercially available. The use of two distinct p-values in the handling of HDX-MS data introduces a novel way to interpret and classify HDX results. This was successfully demonstrated here with the analysis of the RD protein from the adenylate cyclase toxin. In this regard, the validation of the complete RD dataset was significantly expedited, taking only one day with MEMHDX, compared to up to two weeks when performed manually. The current version of the software allows for the comparison of two unique conditions using only one unique charge state. As a future perspective, the software will be enhanced to allow for the comparison of multiple conditions, using multiple charge states.
AKNOWLEDGMENTSWe thank Christophe Malabat for providing the virtual machine, Amine Ghozlane for his help with the 3D visualization tool, and Diogo Borges Lima for his contribution to the on-line tutorial.
FUNDING
Associate Editor: Prof. Alfonso Valencia  The Author(s) 2016. Published by Oxford University Press. This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (http://creativecommons.org/licenses/by-nc/4.0/), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com Bioinformatics Advance Access published July 13, 2016 at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
