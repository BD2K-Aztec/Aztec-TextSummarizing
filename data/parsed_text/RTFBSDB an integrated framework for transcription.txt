Transcription factors (TFs) regulate complex programs of gene transcription by binding to short DNA sequence motifs. Here, we introduce rtfbsdb, a unified framework that integrates a database of more than 65 000 TF binding motifs with tools to easily and efficiently scan target gen-ome sequences. Rtfbsdb clusters motifs with similar DNA sequence specificities and integrates RNA-seq or PRO-seq data to restrict analyses to motifs recognized by TFs expressed in the cell type of interest. Our package allows common analyses to be performed rapidly in an integrated environment. Availability and Implementation: rtfbsdb available at (https://github.com/Danko-Lab/rtfbs_db).
IntroductionTranscription factors (TFs) regulate complex programs of gene expression by modulating the rates of several steps early in transcription. TFs bind degenerate DNA sequence motifs, typically 320 bp, located in regulatory regions known as promoters, enhancers and insulators. Identifying the coordinates of TF binding motifs within the genome is a crucial step in many genomic analyses. However, motif discovery is a challenging computational problem owing to the short lengths and high degeneracy of TF binding motifs. Using experimentally derived sources of TF binding is one strategy to improve accuracy by constraining the motif discovery problem to known binding sequences. This strategy requires extensive knowledge about the DNA sequence specificities of TFs, which have historically been time-consuming to measure experimentally. Recently, high throughput experimental approaches have allowed the systematic discovery of motifs for thousands of TFs (). Moreover, strategies to impute binding motifs using TF amino-acid sequences extend these resources to most species with a sequenced genome (). These developments make the use of known TF binding motifs a powerful strategy in many common applications. Here, we introduce rtfbsdb, an open-source pipeline for transcription factor binding site (TFBS) identification and analysis, which integrates experimentally derived TF binding data for thousands of TFs. Unlike other TFBS identification tools, rtfbsdb integrates high-throughput measurements of gene expression for TFs associated with each motif. For downstream TFBS scanning and identification, rtfbsdb uses the rtfbs package (Peterson et al., unpublished), a highly flexible and efficient implementation of many TFBS scanning tasks. Many common and complex analyses can be solved by rtfbsdb in as little as a single line of R. We demonstrate rtfbsdb using genomic data from the ENCODE project.
Description
Description of the RTFBSDB packageThe rtfbsdb package is an open-source package for R which automates many common tasks in TFBS discovery and analysis. The flowchart for a typical analysis using rtfbsdb is presented in. To begin an analysis, users import a large database of experimentally defined TF binding motifs. We primarily support the Catalog of Inferred Sequence Binding Preferences (Cis-BP) database, which integrates more than 65 000 motifs from >25 distinct experimental V C The Author 2016. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com sources (). Cis-BP also includes imputed motifs for non-model organisms and for paralogs of well-characterized TFs. In addition to Cis-BP, rtfbsdb supports motifs from a variety of different sources and integrates data seamlessly in R. DNA binding specificities are often highly similar between different TFs. Duplicate motifs reduce the interpretability of downstream analyses and can inappropriately decrease statistical power when using more stringent corrections for multiple hypothesis testing. We provide tools to focus analyses on motifs that are directly suitable for the user's application. Many analyses benefit from focusing on the subset of motifs for which the cognate TF is expressed in the cell type of interest. For this task, rtfbsdb integrates gene expression data collected using high-throughput sequencing approaches, including RNA-seq, PRO-seq, or related assays. Rtfbsdb estimates transcriptional activities of the TF associated with each motif in CisBP, which contains ENSEMBL IDs for each motif, using counting functions in the BedTools () and bigWig packages. Rtfbsdb implements a statistical test to identify TFs which are expressed in the cell type or tissue of interest relative to background (). To remove remaining redundant entries from rtfbsdb we cluster motifs based on their DNA sequence specificities using an affinity propagation clustering algorithm provided in APCluster (). In most cases, downstream analyses will represent each cluster as a single motif which is a member of that cluster. After clustering, the similarities between each pair of motifs can be visualized as a heatmap (Supplementary) and images of the motif logos within each cluster can be visualized in R (Bembom, unpublished) or written to disk as a PDF file. The result of these pruning and clustering steps is to tailor the repertoire of motifs analyzed for the user's application. After reading and filtering motifs, an rtfbsdb object can then be used to solve two classes of problem that are common in genomics. First, a common analysis is to identify the coordinates of known motifs in a target genome. During this task the user provides a target genome file (in UCSC 2-bit format) and rtfbsdb will return the coordinates of motif matches to the user. Although this challenge is addressed by FIMO () and other applications, a notable advantage of rtfbsdb is that a database of experimentally derived motifs is integrated directly within the package. Moreover, our pipeline provides users with the option to write the coordinates of each motif directly to disk in a highly efficient compressed file format using bedops (), enabling thousands of motifs to be scanned efficiently across large genomes. Second, another common analysis task is to identify motifs that are enriched in a common set of DNA sequences compared to background. This task can provide insight into which TFs putatively cause changes between two or more biological conditions. For example, differences in ATAC-seq or dREG peaks between two biological samples often reflect differences in TF binding. Motifs that are enriched in peaks that change between conditions relative to constitutive peaks can provide insight into which TFs are responsible for causing these changes. However, these analyses can be challenging to implement in practice. The most common challenge with such an analysis is a systematic difference in nucleotide composition between test and background sequences. By default, rtfbsdb uses a resampling approach to identify background sequences with a similar distribution of GC content as test sequences. Additionally, rtfbsdb identifies motifs that are robustly enriched at several motif match score cutoff thresholds. Together, these innovations result in more reliable discriminative TFBS identification. To our knowledge, HOMER is the only other package that allows discriminative TFBS identification using experimentally derived TF binding motifs (). Compared to HOMER, rtfbsdb provides a larger repertoire of motifs, rigorously integrates TF expression levels using genomic data, and supports clustering motifs with similar DNA sequence specificities. Together, these advantages are likely to make rtfbsdb a more powerful and reliable tool for discriminative TFBS identification in many applications.
Using multiple GC content groups decreases accuracyA common step in TFBS identification is to divide loci into separate groups based on GC content and use a separate background model for each group. This strategy is assumed to accommodate systematic differences in GC content across the genome, and thus improve the specificity of motif matches. However, whether this practice results in superior TF binding site predictions has not been tested directly. We created an empirical test using publicly available data from the ENCODE project to determine whether dividing sequences into multiple GC content groups improves the accuracy of TFBS predictions. We used motif match scores to classify high-confidence DNase-I hypersensitive sites (DHS), defined as the intersection of DHS discovered using Duke and UW assays (), as bound or unbound to its cognate TF. Chromatin immunopercipitation and sequencing (ChIP-seq) peaks from 21 TFs were used as a gold-standard set. Surprisingly, a background model constructed using all available sequences performs more accurately than dividing sequences into four separate groups by GC content in almost 90% of cases (median AUC 0.771, 0.741 [4 GC groups] Supplementary; Supplementary). The largest differences were observed for ZBTB7A and E2F6 for which binding site discrimination was 12.9 and 11.1% more accurate with only one GC content group. Thus, we conclude that using a single GCGenome regionsAnalyses:. Schematic illustrating the rtfbsdb workflow. Motifs are loaded into a CisBP.db object in R using an automated web scraper that imports data directly from the Cis-BP database. The set of motifs is reduced to those most applicable for analysis (right side) by removing TFs that are not expressed in the cell system of interest, and subsequently grouping motifs recognizing similar DNA sequences by clustering. The final set of motifs can be used to complete several common tasks in genomics (bottom row), including testing a set of DNA sequences for enriched motifs, scanning a target genome, or visualizing motifs as sequence logos content group results in superior performance for the majority of TFs, though individual differences were relatively small. A single GC content group is the global default in rtfbsdb.
ExampleTo demonstrate the utility of rtfbsdb we used motifs in Cis-BP to search ChIP-seq peaks discovered by ENCODE for TFBS. We focused on ChIP-seq data profiling 97 TFs and co-factors in K562 cells. Forty-one of these are not represented by a motif in available databases, and these are largely comprised of either transcriptional co-repressors (e.g. HDAC1, EZH2 and KAP1) or general transcription factors (e.g. GTF3C2 and TAF1) without intrinsic sequencespecific DNA binding. Of the remaining 56 TFs the expected motif was recovered in 52 cases (93%), and was the most strikingly enriched motif in 41 (73%; Supplementary). For example, the motif corresponding to the transcriptional repressor REST was more than 50-fold enriched in ENCODE REST ChIP-seq peaks (Supplementary). In the 27% of cases where the expected motif was not the most enriched, rtfbsdb often recovered a motif corresponding to a known cofactor which may recruit the expected TF to ChIP-seq peaks by proteinprotein interactions, in a process known as tethering. For example, peaks binding SP1 and SP2 were enriched for NFYA and NFYB binding motifs, which represent a known TF tethering interaction (). Similarly, although EP300 contains a motif in CisBP, it is a transcriptional coactivator which is recruited to DNA by other TFs (). We thus conclude that rtfbsdb returns the expected motif in real world test cases.
Bioinformatics, 2016, 13 doi: 10.1093/bioinformatics/btw338 Advance Access Publication Date: 10 June 2016 Applications Note Bioinformatics Advance Access published June 22, 2016 at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
