Motivation: The area under the receiver operating characteristic (ROC) curve (AUC), long regarded as a 'golden' measure for the predictiveness of a continuous score, has propelled the need to develop AUC-based predictors. However, the AUC-based ensemble methods are rather scant, largely due to the fact that the associated objective function is neither continuous nor concave. Indeed, there is no reliable numerical algorithm identifying optimal combination of a set of biomarkers to maximize the AUC, especially when the number of biomarkers is large. Results: We have proposed a novel AUC-based statistical ensemble methods for combining multiple biomarkers to differentiate a binary response of interest. Specifically, we propose to replace the non-continuous and non-convex AUC objective function by a convex surrogate loss function, whose minimizer can be efficiently identified. With the established framework, the lasso and other regularization techniques enable feature selections. Extensive simulations have demonstrated the superiority of the new methods to the existing methods. The proposal has been applied to a gene expression dataset to construct gene expression scores to differentiate elderly women with low bone mineral density (BMD) and those with normal BMD. The AUCs of the resulting scores in the independent test dataset has been satisfactory. Conclusion: Aiming for directly maximizing AUC, the proposed AUC-based ensemble method provides an efficient means of generating a stable combination of multiple biomarkers, which is especially useful under the high-dimensional settings.
INTRODUCTIONGiven that there are multiple biomarkers and a binary response of interest (e.g. case and control), it is often of substantial interest to combine the biomarkers to form a 'strong' scoring system for the differentiation of cases from controls. While the choice of the predictive measure is not unique, the most appealing choice is the area under the receiver operating characteristic (ROC) curve (AUC) in the casecontrol study (). * To whom correspondence should be addressed. For finite samples, AUC is simply the non-parametric two-sample MannWhitney U test statistics. Unlike the measures such as misclassification rate, the AUC reflects the intrinsic predictive value of a score in that it does not depend on the prevalence of the cases and thus is invariant under the casecontrol sampling. Therefore, it is natural to combine biomarkers by maximizing the AUC under ROC curve (). However, it is notoriously difficult to maximize the AUC numerically since the objective function is neither continuous nor convex. Ad hoc methods have been proposed to tackle the numerical problem. For example, sigmoid function has been used to approximate the indicator function used in calculating AUC (). However, the smoothed objective function may still have multiple local maximums, with no guarantee of locating the global maximizer by using the commonly used numerical algorithms. In view of these challenges, we propose a class of ensemble methods aiming for maximizing AUC with multiple biomarkers. Specifically, we introduce a class of convex surrogate loss functions to approximate the non-convex AUC, greatly facilitating computation and optimization.
METHODS
Surrogate loss functionsAssume that X 1 ,...,X n are n independently identically distributed (i.i.d) copies of p-dimensional random vector X, representing, for example, p biomarkers for cases, and Y 1 ,...,Y m are m i.i.d copies of p-dimensional random vector Y for controls. Suppose that we want to construct a score as a linear combination of the p biomarkers with the aim of maximizing the AUC under ROC curves. Specifically, we want to find a vector  to maximize the objective functionIdeally, we would want the score for cases to be higher than that for controls, which yields 1 for the AUC and completely differentiates cases and controls. However, several challenges are prominent. First, since the objective is invariant in   c 0  for arbitrary c 0 > 0, there is no unique maximizer for the objective function. One often needs to subjectively select an anchor biomarker with its weight in the linear combination being one and maximize the remaining p1 components in . The performance of the score heavily depends on the selection of the anchor biomarker. Second, even with a given anchor biomarker the objective function is still neither continuous nor concave and therefore it is very likely that conventionally used optimization iterations have been trapped around local maximum points depending on the subjectively selected initial point.
AUC-based biomarker ensembleWe are now in a position to propose a method addressing these two challenges. By noting that 1AUC() can be interpreted as the misclassification rate of using the binary rule  (X i Y j ) > 0 to classify a binary response always taking value 1, we may borrow the popular classification approaches aimed for minimizing the misclassification rate in the data mining literature (). Specifically, instead of directly maximizing AUC() or equivalently minimizing 1AUC(), it is sensible to minimize a surrogate loss function. We propose the following two surrogate functionswhich correspond to the negative log likelihood function raised in the conditional logistic regression and hinge loss function used in support vector machine, respectively, where x + = xI(x > 0). Since these two functions are continuous convex function, their minimizers are well defined and can be reliably located. Numerically, it amounts to replace the indicator function I(x < 0) by log{1+exp(x)} and (1x) + , respectively. Previous data mining literature reveals that algorithms minimizing such surrogate loss functions often result in models with good performance in minimizing the misclassification rate. Analogously, the estimated scores tend to render satisfactory AUCs. With moderate dimension p, while M 1 () can be minimized via the scoring algorithm in fitting a generalized linear model, we can use linear programming technique to minimize M 2 (). Specifically, it is equivalent toSeveral advantages of the proposal are obvious. First, minimizing either M 1 () or M 2 () does not require selecting an anchor biomarker a priori, which is especially appealing for high-dimensional case. Second, in the limiting case, the maximizer of the AUC under the ROC curvefor any strictly monotone increasing function m(), where f 1 () and f 0 () are the underlying density functions of X and Y , respectively (). The minimizer ofand thus minimizing E{M 1 (g)} is equivalent to maximizing the AUC under the ROC curve. The minimizer of E{M 2 (g)}=E{1g(X)+g(Y )} + , is more complicated. Numerical studies point that the minimizer may also be a monotone transformation of f 1 ()/f 0 (), as opposed to the conventional support vector machine whose solution approximates the optimal decision boundary.(1) Set the initial
Adaptive generalizations(2) Update  aswhere the minimization can be solved via linear programming technique.(3) Repeat Step (2) until convergence or the number of iteration reaches a pre-specified number.Our numerical results (reported in the Supplementary Material) show that the adaptive iteration may increase the resulting AUC especially when there are potential outliers. The robustness of the method is not a surprise, because the influence from individual observations on the objective function via m c (x) is always bounded. Furthermore, we find that one or two iterations often suffice to harvest most of the gain in maximizing AUC() and thus, in general, there is no need to continue the iteration until convergence.
Extension to survival outcomesWhen the outcome is survival time subject to potential right censoring, the c index as the generalized AUC is often computed as,...n are n i.i.d copies of ( T ,,,Z), T is the minimum of the censoring and failure times, is the binary censoring indicator and Z is the covariate vector (). Similarly, one may find  by minimizing, respectively. Indeed, the log-partial likelihood function also can be viewed as surrogate to the cindex in that
X.G.Zhao et al.may serve as a surrogate toThis may explain that the Cox model-based cindex is often high.
Regularization for high-dimensional covariatesWhen p is high, the proposed surrogate loss function can be conveniently regularized for feature selection. While many regularization methods can be used, we hereafter pursue the popular lasso regularization for illustration (). Specifically, we propose to minimize, one may use the following iterative coordinate descending algorithm to minimize the objective function with a given (1) Set an initial estimator .for i = 1,...,n and j = 1,...,m. The standard coordinate descending algorithm can be used to minimize the weighted L 2 loss function in this step ().(3) Repeat Step 2 until convergence.The coordinate descending algorithm is not directly applicable for the nondifferentiable surrogate loss function M 2 (). However, since the objective function M 2 () is convex and piecewise linear, the exact solution path with  varying from  to 0 is also piecewise linear and can be computed using the generalized LARS algorithm (). When the dimension p or sample size n is high, the computation is demanding due to dense joints in the solution path. As a remedy, we propose a forward stagewise algorithm that generates an approximate solution path of  ().(1) Set an initial estimator  = 0 and small positive number >0.(2) At step k = 1,..., identify the coordinate j with the largest decreasewhere >0 is an small constant selected a priori, e j is a p-dimensional vector with all the components being zero except the j-th component, which is 1 and s j = 2I{M 2 ( +e j ) < M 2 ( e j )}1.When the exact lasso solution is desirable, one may employ an ad hoc twostage approach. Specifically, one may first implement the aforementioned forward stagewise algorithm to screen informative features. The forward stagewise algorithm stops when the number of selected features reaches a prespecified maximum number of biomarkers to be used for constructing the score in practice, say 30. At the second step, the exact lasso solution path can be computed with only the selected features. In either case, the penalty parameter can be selected via cross-validation. The objective function used in the cross-validation can be either M j () itself or the AUC under ROC curve.
SIMULATIONExtensive simulations are conducted to examine the finite sample performance of the proposed method. We generate the covariatesfrom the following models:of the markers values in both cases and controls are contaminated by a common error distribution.In the above settings, we let  1 = (1,0,0,...,0) ,,1,0,...,0) ,is the identity matrix. We considered several configurations of n, m and p to investigate the operational characteristics of the proposed method. First, we examine the scenario where the number of covariates is low relative to the sample size. To this end, we let p = 3 and n = m = 50. For each generated dataset, we construct a linear combination of the covariates as a score differentiating cases from controls, where the weights of the linear combinations are estimated by minimizingproposed in Ma and Huang (2007) and (iv) by fitting a regular logistic regression. We also implement the popular ada-boosting with 300 iterations using the simple stump as the base classifier (). The continuous class probability based on ada-boosting trained ensemble is used to generate the ROC curve. In minimizing S(), we first identify the 'anchor covariate' with the most significant p value from t-test comparing the covariate distribution between cases and controls and set its regression coefficient at +1 or 1 depending on the sign of the. The AUCs in the training sets are higher than their counterparts in the validation sets as expected. In most cases including the first setting, where the logistic regression estimates the optimal combination in terms of maximizing the AUC, the scores based on M 1 (), M 2 (), S() and logistic regression perform similarly in terms of AUC in the validation sets. In general, the score based on ada-boosting has the lowest AUC, which could be due to overfitting indicated by the high AUCs in the training set. Furthermore, the score based on the one-step adaptive hinge loss function performs similar or slightly superior to that based on hinge loss function itself. Second, we have examined the performance of the proposed method for covariates with moderate dimension. In this case, we let p = 200 and n = m = 50 and the lasso regularization is used for selecting the important features in logistic regression. The forward stagewise algorithm similar to that presented in Section 2.2 for minimizing M 2 () is also used to minimize S(). We choose the popular lasso penalty mainly for the purpose of fair comparison, i.e. evaluating the relative performance of various methods under similar regularization schemes. The boxplots of AUCs in independent test sets over 250 replications are plotted in. In general, the scores based on M j () perform better than that based on the alternatives in terms of average AUC in the test sets. Furthermore, the AUCs from scores constructed via M j () also tend to have smaller variability than their counterparts. In the most challenging fourth setting, the empirical average AUC in the test sets is 0.66 for score minimizing M 1 (), 0.66 for score minimizing the hinge loss, M 2 (), 0.60 for scores minimizing S(), 0.60 for score from the logistic regression fitting and 0.63 for score from ada-boosting using three markers. An increase from 0.6063 to 0.66 in the AUC is often considered non-trivial in clinical practice.Lastly, we have examined the cases for high-dimensional covariate. Here, we let p = 20 000 and n = m = 50. To save computational time, the ada-boosting is only applied to top 500 features selected based on significance levels of t-test comparing cases and controls in the training set. The simulation results are presented in. For the high-dimensional covariates, the relative performance of the proposed methods is even better than that in the previous case where p = 200. For example, in the third setting, the empirical average AUC in the test sets is 0.85 for score minimizing M 1 (), 0.85 for score minimizing the hinge loss, 0.76 for scores minimizing S(), 0.74 for score from the logistic regression fitting and 0.64 for score from ada-boosting using three markers. Similarly, in the fourth setting, the empirical average AUC in the test sets are 0.56, 0.56, 0.53, 0.53 and 0.53 for aforementioned five methods.
ANALYSIS OF THE BONE MINERAL DENSITY STUDYWe apply the proposed method to a dataset () arising from a study that recruited 301 non-related post-menopausal ethnic Norwegian women at the Lovisenberg Deacon Hospital. Among them, bone mineral density (BMD) and gene expression levels (Affymetric array) were measured for 84 women. Since low BMD is associated with higher fracture rates (), it is of interest to identify a linear combination of gene expression levels to differentiate the osteopenia or osteoporosis (low BMD) from normal among post-menopausal women. Bone biopsies show that there are 39 from 84 women having osteopenia or osteoporosis. All the normalized gene expression level are log-transformed. After screening out 25% probesets with lowest variation, we have 40 411 probesets for each patient. We randomly split the data into training and validation sets and apply the proposed method to the trainingare determined using the same method as that presented in the simulation study. To save computational time, adaboosting is only applied to the top 2000 genes according to their significance level in t-test comparing average gene expression levels between cases and controls. With the estimated scores based on
X.G.Zhao et al., the regularized logistic regression and adaboosting, we examine their corresponding AUC in the validation set. The results are shown in. It can be seen that in general scores based on M 1 () and M 2 () yield higher AUC than that based on S(), the commonly used logistic regression and adaboosting with the same number of covariates in the validation set. In, we also plot the AUC in the training set. Since the number of covariates is much higher than the sample size, the maximum AUC (AUC = 1) corresponding to complete separation between case and control in the training set is reached with 20 30 covariates for all the methods. The highest AUCs for scores based on S 1 (), regularized logistic regression and ada-boosting are 0.764, 0.687 and 0.728, respectively, while the highest AUC is 0.708 for score based on M 1 () and 0.764 for score based on M 2 (). As a reference, the AUC for age is only 0.669 in this cohort. Furthermore, while the optimal scores with M 1 () and M 2 () use 9 and 13 genes, respectively, their counterparts based S(), regularized logistic regression and ada-boosting use 37, 12 and 45 genes, respectively. These comparisons suggest that the genes score based on M 2 () possesses the best combination of sparsity and prediction performance: it attains the highest AUC in the validation set with only 13 genes. The gene lists selected by these methods are heavily overlapping. For example, there are seven common genes shared by at least three out of four linear combinations constructed basedand logistic regression. The probe set AFFXM27830_M_at, which is shared by all four scores, is a member of the eight core genes reported by (). Furthermore, gene SOST (Affymetrix ID 223869_at) shared by scores based on M 1 (), M 2 () and logistic regression is also a member of the eight core genes explaining the variation of BMD and sits in the 'center' of the constructed intermolecular network sharing significant associations reported in the original paper (). The selected genes and their corresponding weights are summarized in, where the weights are standardized such that the probe set AFFXM27830_M_at has the unit weight for comparison purpose. One interesting and reassuring observation is that signs of all non-zero weights were consistent across methods. We also repeat analysis based on other random training test splitting and obtain similar results.
DISCUSSIONMotivated by recent advances in data mining, we have proposed a class of methods combining biomarkers to construct a scoring system, boosting the resulting AUC under the ROC curve, a prevalence-free summarization of intrinsic predictive values of a continuous score. The method is easily adapted to high-dimensional cases, wherein one may need to identify informative features from thousands of candidate biomarkers. In high-dimensional case, we propose to apply lasso regularization to yield a parsimonious combination maximizing the AUC. On the other hand, lasso is neither the unique nor the universally optimal regularization method for analyzing high-dimensional data. Due to the convexity of the proposed loss function, it is straightforward to couple M j () with other penalty functions such as elastic net, adaptive lasso and SCAD, which may have superior performance to simple lasso in specific settings (). The key proposal is to target a convex surrogate loss function instead of a discontinuous MannWhitney rank statistic. While in this article, we have focused on the hinge loss function (corresponding to the 1 norm support vector machine), our results can be extended to accommodate other versions of SVM loss
AUC-based biomarker ensemblefunctions, such asfor any given   1. Another alternative is the exponential function used in boosting algorithmFinally, while the AUC under the entire ROC curve is a useful global measure, the AUC under partial ROC curve has recently emerged as a useful problem-specific measure in practice (). Therefore, an numerically efficient algorithm combining multiple biomarkers to maximize the AUC under partial ROC curves or sensitivity for given specificity level is worth further investigations.
The Author 2011. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oup.com at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
