Motivation: We have witnessed an enormous increase in ChIP-Seq data for histone modifications in the past few years. Discovering significant patterns in these data is an important problem for understanding biological mechanisms. Results: We propose probabilistic partitioning methods to discover significant patterns in ChIP-Seq data. Our methods take into account signal magnitude, shape, strand orientation and shifts. We compare our methods with some current methods and demonstrate significant improvements, especially with sparse data. Besides pattern discovery and classification, probabilistic partitioning can serve other purposes in ChIP-Seq data analysis. Specifically, we exemplify its merits in the context of peak finding and partitioning of nucleosome positioning patterns in human promoters. Availability and implementation: The software and code are available in the supplementary material.
INTRODUCTIONChIP-Seq (immunoprecipitation combined with high-throughput DNA sequencing) experiments allow to characterize in vivo transcription-factor binding events and local chromatin organization on a genome-wide scale (). Within the past few years, ChIP-Seq has become a widely used and indispensable technology in the study of transcriptional regulation. Other epigenetic profiling assays are also starting to have a similar impact on the research field (). A ChIP-Seq experiment produces a large number of sequence tags that are mapped to the genome, resulting in a genome-wide profile of tag counts. A high tag count at a location on the chromosome indicates the presence of a particular protein at that location. This protein may be a sequence-specific transcription factor, a post-translationally modified histone or some other chromatin-associated protein. The regions enriched in ChIP-Seq tags are diverse in terms of magnitude, shape and orientation (). Sequence-specific transcription factors typically produce uniform narrow Gaussian peaks, while regions enriched in histone modifications tend to show complex multimodal signal distributions. The term 'chromatin signature' has been coined to designate recurrent patterns found in ChIP-Seq-based histone modification maps and other types of chromatin profiling data (). A chromatin signature is usually represented by a vector of average tag counts in bins of certain sizes (typically 50500 bp) in a collection of larger genomic regions of sizes 110 kb. Chromatin signatures can be detected by so-called aggregation plots (APs) (), if precisely mapped experimentally defined anchor points [e.g. transcription start sites (TSSs)] are available for selection and delineation of the genomic regions of interest. A basic assumption in ChIP-Seq data analysis is that specific chromatin signatures are associated with specific functions. For instance, human promoters are characterized by a nucleosome-free region of $150 bp and a rigidly positioned H3K4me3-marked +1 nucleosome centered 120 bp downstream from the TSS (). Discovering a chromatin signature is difficult, especially when anchor points are not available. An effective algorithm must be capable to cope with the following obstacles. Biological inhomogeneity of the samples: The set of analyzed genomic regions often consists of multiple unknown subclasses, in which case, a plot derived from all samples shows the superposition of several different chromatin signatures.Alignment uncertainty: Precise anchor points are rarely available for delineating genomic regions. Selected chromatin regions first need to be optimally shifted (registered) with respect to each other before an AP can reveal a highresolution chromatin signature. Asymmetry: Chromatin signatures associated with directional molecular mechanisms (such as transcription) are usually asymmetrical. However, the orientation of the genomic regions is often unknown. The input count vectors should then be compared with each other in both orientations.Sparse count data: Certain bins may have very low tag counts, leading to high sampling errors. The problem of inhomogeneity can be tackled by off-the-shelf clustering and partitioning algorithms. In fact, hierarchical clustering and K-means have been incorporated in several *To whom correspondence should be addressed. multipurpose computational platforms for ChIP-Seq data analysis. SeqMINER () offers an in-built K-means function, while ChIPseeker () is interfaced with a third-party hierarchical clustering software. However, shifting and flipping are only implemented in specialized programs like ChromaSig (), ArchAlign (), CATCHprofiles () and CAGT (). ArchAlign performs only shifting and flipping and can find only one single signature. CAGT supports flipping but not shifting. (The problem of optimal shifting is typically solved by exhaustive comparison of all overlapping subregions of a given size from two genomic regions, possibly in both orientations.) ChromaSig, ArchAlign and CATCHprofiles use progressive multiple alignment strategies to assemble similar tag profiles. Because these algorithms have to carry out a large number of pairwise comparisons, they tend to be slow. To overcome this drawback, CAGT applies a two-step divide-and-conquer approach. It first uses the K-median algorithm (a variant of K-means) to define top-level classes and then runs a hierarchical clustering algorithm on each of these classes in turn. The shifting and clustering functions require some type of distance measure. All of these programs, except ChromaSig, use non-probabilistic measures such as the Euclidean distance or the Pearson correlation coefficient, neither of which does well with low counts per bin. ChromaSig assesses similarity between samples and class membership assuming position-specific Gaussian distributions of the normalized ChIP-Seq signal within a chromatin signature. The use of Gaussian distributions, which seems unnatural for count data, is explained by the fact that ChromaSig was originally designed for ChIP-chip data. In this article, we propose an alternative approach for finding recurrent patterns in ChIP-Seq data by probabilistic partitioning. The underlying principle of this general method is to optimize a mixture model by an Expectation-Maximization (EM) algorithm, a strategy that has already proved effective in finding recurrent DNA motifs in selected genomic regions (). A key difference in this method compared with the other clustering methods mentioned is that samples are not deterministically assigned to a single class: rather, their classification status is defined by a vector of class membership probabilities. While EM has long been a standard tool in machine learning, it is a general-purpose method, whose convergence rates and running times depend on the exact formulation of the objective function and the updating formulae. The purpose of this article is to demonstrate the merits of EM when applied to ChIP-Seq data and to explain by examples how it can be applied to classification and motif-discovery problems in research on chromatin structures. The probabilistic partitioning approach offers the following advantages.(1) The use of probabilistic distance functions naturally takes into account random sampling variation in low-count data.(2) Probabilistic class assignment allows accurate characterization of classes even in situations where the classification of individual samples is uncertain.(3) Probabilistic class assignment is flexible and can combine goals, for instance, the ranking and prioritizing of ChIPSeq signal-enriched regions based on peak shape.(4) Shifting and flipping can be implemented in the EM framework via hidden variables.(5) The implementation of probabilistic partitioning is straightforward with existing programming platforms. All algorithms used in this work can be implemented by 530 lines of R code.(6) Flexibility: Methods are readily customized to meet the needs of a particular application. For instance, the switching from a Poisson probabilistic model to a negative binomial model requires only one change in the corresponding R code.(7) Efficiency: In contrast to most existing methods, the EM algorithm does not require exhaustive pairwise comparisons, so that each iteration runs in time linear in the number of samples.(8) Transparency and Reproducibility: Methods can be accurately described in a research paper by reproducing a few lines of R code (for example, see the R code given in the Supplementary Material). Section 2 presents in detail several variants of the probabilistic partitioning algorithms. Section 3 analyses the performance of these algorithms on carefully chosen examples based on simulated and real ChIP-Seq data and compares its performance with K-means clustering and CAGT.
METHODSWe are given N samples, S 1 , S 2 ,. .. , S N. These samples could be regions around TSSs of genes or transcription factor binding sites. We divide the genome into bins and count the number of ChIP-Seq fragments that fall into each bin to obtain bin counts. Thus, each sample S i is an integer vector of length L, S i =s i1 s i2. .. s iL , where each element s il is a bin count. Bincount vectors of several ChIP-Seq libraries (e.g. different histone marks) may be concatenated to partition them together. We assume that the samples originate from a mixture of K different classes, C 1 , C 2 ,. .. , C K. Each class C j occurs with characteristic probability p j =PC j  and is further characterized by 'profiles' of expected bin counts: C j =c j1 c j2. .. c jL .
EM algorithmThe probability of sample S i given class C j is computed as follows:Poissons iv ; =c jv   1 Now, the probability of class C j given sample S i is given by:Using this probability, we update the classes as follows:These computations are iteratively carried out for a fixed number of steps.
Modified 'Shape-Only' EM algorithmWe also propose a shape-only version of the EM algorithm for normalization purposes. For all K classes, the average count frequency is set to 1. In other words, we imposeEquation (1) is modified as follows:The purpose is to adjust the average count frequency of class j to the average count value of sample i.We further have to make sure that the average count frequency of the reestimated class j equals 1. To this end, Equation (3) is modified as follows:
Variationswith shift and flipWe propose some variations of the basic method. In the following, we show how flipping and shifting can be implemented. Note that these two options could be implemented separately. Here (for the sake of generality) we show the version that supports both. Shifting and flipping are modeled with two hidden variables, the shift index m and the flip state inv. Let m be the shift index and M be the maximum number of shifts allowed, and let inv be equal to 1 when there is no flip and equal to 2 when there is one. Note that with shifting, the patterns C j are shorter than the samples S i by M  1. The notation s il m; inv will be used to represent the data for a particular shift and flip state: for inv=1, s il m; inv=s i;l+m1 ; for inv=2, s il m; inv=s i;LM+ml+1. Now, the probability of sample S i given class C j and further conditioned on shift index m and flip state inv is computed as follows:Poissons iv m; inv; =c jv   9 Now, the probability of class C j given sample S i is given byUsing this probability, we update the classes as follows:Here we assume that the shift states follow a centered Gaussian distribution with equal width for all classes. Therefore, we infer only the SD of the distribution from the data. Practically, this is achieved by applying the following regularization step to the reestimated probabilities p  j m; inv.u u u t 14Let NormalmjM+1=2;  be the probability of shift m that has a Gaussian distribution of mean M+1=2 and SD .As before, these computations are iterated for a fixed number of steps. Because we are able to estimate the probability of each shift for every sample and class, we can use these probabilities to estimate the internal position of a given pattern in a particular sample. Under Section 3.2.3, we present a biological example where we make use of this possibility.
Seeding and initialization strategiesVarious seeding and initialization strategies are possible for the proposed probabilistic partitioning algorithms. Here are two such possibilities. Start with one class (K = 1). Set PC 1 jS i =1 (for partitioning without shifts or flips) and p 1 =1. The initial distribution of class one (c 1l ) can be defined in either of these two ways: (i) we can take the mean of the entire data across all the samples; (ii) choose a random distribution by either picking a random subset of the data or by choosing a random probability for each sample, and then taking the weighted sum over all the samples according to their probability value. Then, iteratively increase the number of classes (K=K+1) till the maximum number of classes is reached. With each iteration, the new class is initialized to a uniform distribution (c jl = 1) 8l and j is the new class. The new class will have a prior probability p new class =1=K, where K is the total number of classes so far. The remaining classes have a total probability ( P j p j ) of 1  1=K, where each class is p j =1  1=Kp old j (the earlier value of p j is p old j ). After the initialization (for each increase in the number of classes), the EM method is applied. Start with K classes (K ! 1). Like done before, we could take K different subsets of the original data and compute their mean, and use this to compute the initial distributions for different classes. Alternatively, one could also choose K random probability vectors (each vector containing probabilities for all samples) and use this to compute K weighted sums for finding the initial distributions of the K classes. After this initialization, the EM method is applied. Determining the optimum number of classes or clusters (choosing K) in a dataset has been a problem, which has been addressed in the literature for many decades now. The number of classes should strike a balance between assigning all samples into one class and assigning each sample into a separate class. Methods that look at percentage of variance as a function of number of classes () or by using methods based on information criteria like Akaike information criterion or Bayesian information criterion are often used (among many others). However, most of these methods have their drawbacks (). Because probabilistic partitioning method is to be used as an exploratory tool, we leave it to the user to manually see what is the best number of interesting classes for the dataset being used.
RESULTS/DISCUSSION
On simulated dataWe first run the computational experiments on simulated data. The data are composed of a mixture of two classes characterized by bin count frequency profiles of different shapes. The samples were integer vectors of length 100. Counts were generated by randomly sampling from a Poisson distribution with varying in a class-and position-specific manner along the bin count frequency profiles. Because we were particularly interested in the algorithm's capability of recovering patterns from sparse count data, we varied the total count coverage f over a wide range of relevant values (f is defined as the total expected bin counts per sample). The simulated data were generated using statistical software R. The R code and additional details of the computational protocols are given in the Supplementary Material.
Data without shifts or flipsWe first generated random samples belonging to two classes, 1000 samples for each class. The classes were defined by bin count profiles of Gaussian shape, each one with a different mean and variance. The experiments were repeated several times with coverage f ranging from 50 to 0.5. The shape-based version of probabilistic partitioning (Partition) was compared with K-means and the recently introduced Clustered AGgretation Tool (CAGT). The latter was used with two different distance metrics, Euclidean and correlation [henceforth denoted as CAGT (Euclidean) and CAGT (. CAGT differs from the other two methods in that it tries to infer the number of classes from the data, a behavior that can be partly controlled by the command line parameter 'K-means/ median'. For the sake of fair comparison, we changed the value of this parameter, so as to force the program to always return exactly two classes. For CAGT (Euclidean), the parameter k (the number of clusters for K-means/medians) was always set to 2, while for CAGT (correlation), it was set to 2 when f55 and to the default value of 40 when f ! 5. For the same reason, we disabled the flipping option with CAGT. During the test, we observed that CAGT (correlation) returned an error when trying to process samples consisting of zeros only. We therefore eliminated these samples from the input datasets fed to CAGT (correlation). The number of EM iterations in the probabilistic partitioning method was set to 30 for any value of f. Here and in all subsequent experiments, we used the iterative version of EM, starting with an initial class consisting of the mean bin count vector taken over all samples. The performance of the different methods was assessed in several ways: (i) by visual inspection of APs for the true and rediscovered classes ()in the case of the probabilistic partitioning method, the AP represents a probability-weighted average; (ii) by measuring the similarity between the true and rediscovered patterns as a Pearson correlation coefficient of the corresponding bin count profiles (); (iii) by comparing the reestimated class frequencies to the true class frequencies of 50% (); (iv) by computing the classification error defined as the percentage of misclassified samples (). Classification error is calculated as Ncr1cr2 N   100, where cr1 and cr2 are number of samples from classes 1 and class 2, respectively, which were correctly classified as belonging to their respective classes, and N is the total number of samples in the data. To compute the classification error, we need to label the classes inferred by the various algorithms. Because the setup of the simulations involves only two classes, we could easily do this by hand. In addition for the probabilistic partitioning method, we need to give a deterministic class assignment for each sample, and we give it to the most probable class. As a general trend, we can see that all methods work well when the count coverage is high (f ! 10). When there is a lower coverage, probabilistic partitioning clearly outperforms all other methods. In fact, it recovers the underlying patterns of the two classes surprisingly well (r40.94) even at a low coverage (f = 0.5) and this in spite of a high classification error of $33% (). The high classification error is probably due to the expected large number of samples consisting of zeros only (60%) all of which will be attributed to class c2, which has the higher estimated frequency (). K-means and CAGT (correlation) still recover the count frequency profiles of the two classes with reasonable accuracy at a coverage as low as f = 2. Note further that probabilistic partitioning is the only method capable of accurately estimating the frequencies of the two classes at a low coverage. This is clearly related to the probabilistic rather than the deterministic assignment of class membership.
Data with flipsThe next thing we wanted to see was how well the method works when there are flips in the data. We used two classes as before. The simulated data now contain 2000 samples per class, 1000 presented in one orientation and 1000 in the reversed orientation. We compared probabilistic partitioning in shape-based mode to CAGT (correlation) with flipping enabled. Because CAGT (correlation) in default mode returned variable numbers of patterns for f55, we reduced the parameter k to 5. Simulated data without shifts or flips. Shows the data and the patterns found using the K-means clustering method, CAGT methods and the probabilistic partition method (shape-based without shift or flips). Sub-figures a1, b1, c1, d1 and e1 are for f = 50 and a2, b2, c2, d2 and e2 are for f = 1. Dashed line is class 1 (class c1 in) and solid line is class 2 (class c2 in) for f = 2 and to 4 for f = 1, to force the program to output only two classes. Overall, the results (and) were similar. The methods were able to recover the underlying patterns with high accuracy if the coverage was not too low. At a lower coverage, probabilistic partitioning worked better. Note, however, that in this test, we had to increase the number of iterations from 30 to 70 to reach good performance with a low coverage (for f 2). In general, it was seen that for low values of f, we may need to increase the maximum number of EM iterations for this experiment. The probabilistic partitioning method is, however, seen to be robust over a wide range of EM iterations.
Additional testswith simulated data We performed similar tests with mixtures of more than two classes and show that the probabilistic partitioning approach works well. The details of the test protocols and the corresponding results are presented in Supplementary Materials. We also found that the CAGT (correlation) method does not work well in differentiating classes with co-localizing peaks but different width. However, CAGT (Euclidean), K-Means and probabilistic partitioning method do not run into the same problem. We show an example in the Supplementary Material to demonstrate this.
On real ChIP-Seq dataWe now check the usefulness of the method on real data from ChIP-Seq experiments.
H3K4me1 and H3K4me3 promoter signaturesThese two histone marks exhibit characteristic and distinct chromatin signatures around promoters. In the following experiment, we mix H3K4me1 and H3K4me3 bin count profiles representing promoter regions to test whether automatic classification methods can correctly identify the two classes of samples and accurately reconstruct the corresponding chromatin signatures (i.e. bin count frequency profiles). As a promoter collection, we used 34 741 annotated TSSs from ENSEMBL. We then extracted H3K4me1 and H3K4me3 tag counts from public ChIP-Seq data for mouse embryonic stem (ES) cells), GEO entries GSM594577 and. For each sample, tags for H3K4me1 and H3K4me3 were counted in bins of 50 bp over a region of 2500 to +2500 relative the TSS. The two datasets were then combined into one. The advantage of having such a combined dataset (by mixing two real datasets) is that we know the underlying truth, and we can do. Simulated data with flips. Data (4000 samples) consist of two classes characterized by Gaussian-shaped patterns. Each class is represented by two subsets of 1000 samples, one showing the underlying pattern in native, the other one in reversed (flipped) orientation. Sub-figures a1, b1, c1 and d1 are for f = 50 and a2, b2, c2 and d2 are for f = 1. b1 and b2 are APs of the same data but with all samples presented in their native orientation. It can be seen that the probabilistic partitioning method (shape-based) using flips captures the actual data patterns at a high (f = 50) and low (f = 1) coverage. The CAGT (correlation) method works well for f = 50 only. Dashed and solid lines correspond to classes c1 and c2 inthe quantitative comparisons similar to what we have done using simulated experiments by trying to separate the two datasets from the combined dataset. This test dataset potentially poses several new difficulties as compared with the previous synthetic datasets. (i) The two classes are likely to be inhomogeneous themselves because not all promoters are active in ES cells, and this is known to be reflected by the respective histone modification signatures. (ii) The two classes are highly unequal in terms of coverage (f = 11 for H3K4me1, f = 90 for H3K4me3). This explains why an AP of the mixed dataset looks quasi-identical to an AP for H3K4me3 only (). Because unequal coverage may help to distinguish between the two classes, we tested probabilistic partitioning in both basic-and shape-based mode. (iii) This dataset is much larger than the previously tested synthetic datasets and thus may represent a challenge in terms of CPU requirements. We exploited this fact to carry out a speed comparison of the different programs. In total, we tested five methods on this dataset, K-means, CAGT (Euclidean), CAGT (correlation), partitioning (basic non-shape-based) and partitioning (shapebased). The results are shown inand. Not surprisingly, all methods perform well in reconstructing the H3K4me3 signature around promoters, which dominates the dataset in terms of tag coverage. For the H3K4me1 signature, probabilistic partitioning (shape based) performs best, followed by CAGT (correlation) and partitioning (basic). A possible explanation for this fact is that coverage is highly inhomogeneous within the H3K4me3 class, causing misclassification of low-coverage H3K4me3 samples as H3K4me1 by the basic but not the shape-based version of probabilistic partitioning. It is noteworthy that CAGT (correlation) outperforms probabilistic partitioning in estimating the relative frequencies of the two classes. This may be due to the fact that CAGT (correlation) was tested on a reduced dataset lacking samples with zeros only. Regarding speed, we note that probabilistic partitioning (shapebased) is a little slower than CAGT but is still capable of processing the datasets in a few minutes. The speed figures should be interpreted with caution, as they depend on the number of iterations carried out by the probabilistic partitioning algorithm. We further note that K-means is fast but basically incapable of recovering the two histone modification signatures.
Application to nucleosome positioning in promotersIn the previous example, we have shown that our method can separate H3K4me1 and H3K4me3 signals that are artificially pooled together. Such a test is useful for method validation but obviously not representative of an interesting biological application. In the following, we apply probabilistic partitioning to a potentially inhomogeneous dataset where the subclasses are not known in advance. Specifically, we analyze the positioning of nucleosomes in human promoters. As anchor points, we use 9714 precisely mapped TSSs from EPDnew version 1 (). Nucleosome mapping data produced by MNase digestion were taken from. Before partitioning, the mapped MNase tags were shifted by 70 bp toward the center of the nucleosome and then counted in bins of 20 bp. Thus, the input data vectors reflect the frequency at which a nucleosome center occurs at a given distance from a TSS. The AP plot for the complete promoter set () shows a well-positioned +1 nucleosome flanked downstream by a damped oscillatory pattern with the expected period of $200 bp. The region immediately upstream of the TSS appearsdata mixed together and separated using the K-means, CAGT (correlation), CAGT (Euclidean) and probabilistic partitioning approach (non-shape and shape-based). Dashed line is for the class that represents H3K4me1 and solid line is for H3K4me3. In the figures, each class is normalized so that the maximum value is 1 for the sake of clarity for each class. Only for subb), we normalize using a global maximum of H3K4me1 and H3K4me3to be nucleosome free. No clear oscillatory pattern is seen in the promoter upstream region. The absence of an oscillatory pattern could mean that nucleosomes are randomly positioned or that different promoters have regularly positioned nucleosomes with different phase shifts relative to the TSS. We used shape-based probabilistic partitioning with limited shifting (AE1 bins/20 bp) to discriminate between these two alternatives. The results obtained with K = 4 are shown in(bf). With one exception (class 4), the class-specific AP plots show higher nucleosome peaks and stronger oscillatory patterns than the AP plot for the complete set. Therefore, we conclude that the absence of a periodic signal in the upstream region inpromoters results from interference of periodic patterns with different phase shifts that almost entirely cancel out each other. We were wondering whether the four promoter classes with distinct nucleosome architectures may differ in terms of regulatory properties. To this end, we analyzed the distribution of an active and a repressive histone mark (H3K4me3 and H3K27me3) as well as Pol II in the same cell type (Supplementary). We see clear differences. Perhaps most interestingly, classes 2 and 3 show regularly positioned H3K27me3-labeled nucleosomes indicative of a repressed state.
Shape-based peak evaluation with shiftingIn this example, we apply probabilistic partitioning to improve a publicly available peak list originating from a ChIP-Seq experiment against a sequence-specific DNA-binding protein. Note that this application is different from the previous ones in that here we are not trying to discover distinct classes. We are merely trying to separate typical examples (belonging to the majority class) from atypical examples, assuming that atypical examples are contaminants. The second goal is to refocus the peak center positions. To reach these objectives, we use shape-based probabilistic partitioning with two classes, one corresponding to the majority class and trained during EM, the other one with a flat count distribution representing background and not modified during EM. As output, we obtain for each peak region in the input list a probability of being a true binding site plus an optimal shifting distance under the true peak model.To test this approach, we used ChIP-Seq data for CTCF in HUVEC from Broad/ENCODE downloaded from GEO (). As anchor points, we used the midpoints of the CTCF binding regions given in the peak file included in the GEO sample entry (GSM733716). For each binding region, we counted sequence tags in bins of 10 bp within a 1 kb region around the anchor point. Probabilistic shifting was done by evaluating the ChIP-Seq signal in 31 overlapping windows of 700 bp (70 bins). After partitioning, we split the input peak list into a 'good' and a 'bad' peak class, applying a threshold probability of 0.5. We also shifted the center positions of the good peaks based on the posterior probability distribution over the 31 shift classes. We then evaluated the peak lists obtained in this way by motif enrichment using the CTCF position weight matrix from the JASPAR database ().shows the frequency of CTCF binding motifs around the peak center positions. We note an essentially flat ChIP-Seq signal distribution for the bad peaks and a drastically enhanced Gaussianlike distribution with an increased height and a narrower width for the shifted good peaks. Given the relatively small size of the bad peak set (12 552 of 63 904), the increase in peak height primarily results from shifting and only to a lesser extent from false binding sites elimination. As a control, we split the same peak list into good and bad examples using the P-values contained in the file downloaded from GEO. (The probability threshold was chosen such as to match the numbers of the subsets obtained with probabilisticpartitioning.) With this filtering criterion, the AP for the bad peak set still shows a low Gaussian-shaped signal distribution, suggesting the retention of a few true binding sites, whereas the good peaks exhibit only a modest increase in signal height (). The latter was expected because these peaks were not subjected to optimal shifting. We also evaluated probabilistic peak ranking in terms of reproducibility, using a GEO sample that provides separate peak lists for replicates (see Supplementary Material for details). At an equivalent irreproducible discovery rate of 1%, our method finds slightly fewer peaks than the peak-finder used by the data submitters. However, our peak list was more enriched in CTCF motifs. A possible interpretation of these findings is that our method, which attempts to eliminate peaks of atypical shape, removes artifacts that are reproducibly called by other peak-finders. Taken together, our results show that probabilistic partitioning is an effective post-processing method for filtering and focusing a publicly available ChIP-Seq peak list obtained with a state-of-the-art peak finder.
Other real examplesWe wanted to know whether the results obtained with our method would differ from results obtained with another method when applied to the same dataset. Therefore, we tested probabilistic partitioning on an example that was used in () for introduction and illustration of the CAGT algorithm. The details of this analysis are presented in the Supplementary Material. This dataset consists of H3K27ac bin count profiles around CTCF binding sites. Overall, the two methods reveal concordant trends, but the results differ in some details (see Supplementary Material).
CONCLUSIONWe presented a probabilistic partitioning method to find significant patterns in ChIP-Seq data. The corresponding algorithm runs in O(n) time given a fixed number of classes and EM iterations. It is capable of processing large datasets (tens of thousands of samples) in minutes. The method is conceptually simple yet flexible, and has been implemented in a few lines of R code. The basic partitioning algorithm is readily adjusted to handling flips and shifts following standard principles of EM. With low data coverage, the probabilistic partitioning method gives excellent model accuracy, superior to K-means or CAGT when tested on the same data examples. We have further shown that probabilistic partitioning can serve other purposes than pattern discovery and classification, like partitioning of nucleosome positioning patterns in human promoters, and shape-based evaluation and re-focusing of ChIP-Seq peaks from published peak lists.. Shape-based peak evaluation with shifting. The figure illustrates the effects of probabilistic partitioning on a CTCF peak list provided by ENCODE in terms of motif enrichment. (a) Probabilistic partitioning with shifting. (b) Partitioning based on original P-values. Method details: CTCF binding motifs where identified by scanning the DNA sequence around peak centers with the JASPAR matrix MA0139.1 at a P-value threshold of 10 5. The percentage of sequences containing a CTCF motif is plotted in a sliding window of 50 bp. The numbers in parentheses indicate the sizes of the peak lists. For fair comparison, the threshold for partitioning with the original P-values was chosen such as to match the numbers of good and bad peak obtained with probabilistic partitioning. The motif enrichment profile for the complete peak list (dotted line) is included in both graphs
The Author 2014. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
Probabilistic partitioning methods for ChIP-Seq data at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
N.U.Nair et al. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
