Motivation: In modern sequencing studies, one can improve the confidence of genotype calls by phasing haplotypes using information from an external reference panel of fully typed unrelated individuals. However, the computational demands are so high that they prohibit researchers with limited computational resources from haplotyping large-scale sequence data. Results: Our graphics processing unit based software delivers haplo-typing and imputation accuracies comparable to competing programs at a fraction of the computational cost and peak memory demand. Availability: Mendel-GPU, our OpenCL software, runs on Linux platforms and is portable across AMD and nVidia GPUs. Users can down-load both code and documentation at
INTRODUCTIONImputation of untyped genotypes is a critical preliminary in modern genetic association studies. The intuition behind haplotype-based imputation is that typed markers situated on haplotypes in key individuals can be leveraged probabilistically to impute untyped markers at the same position in other individuals of similar ethnicity. If an imputed single-nucleotide polymorphism (SNP) correlates better to a causal variant than neighboring typed SNPs, then imputation can improve statistical power to detect association. In haplotyping and imputation, computational demands escalate quadratically as the number of reference haplotypes increases. The computational burdens of current datasets are so onerous that most genotyping centers divide their data into small subsets and process each subset on a different node of a computer cluster. For instance, IMPUTE2 documentation recommends this strategy (). Genotyping by second-generation sequencing is quickly becoming costcompetitive with traditional SNP genotyping. Unfortunately, the massive amounts of data generated by sequencing will exacerbate problems and stress traditional computing clusters to the breaking point. Graphics processing units (GPUs) offer one solution to this dilemma. GPUs have been used in recent years to solve several high-dimensional problems in computational biology () amenable to fine-grained parallelization. In this article, we introduce Mendel-GPU, a software application that addresses the practical need to efficiently impute genotypes on large-scale datasets. Further details on implementation and additional analyses can be found in the Supplementary Information.
SOFTWAREThe algorithms behind our imputation method exploit rapid estimation of haplotype frequencies in narrow genomic windows. Carefully chosen penalties eliminate haplotypes with low explanatory power. Penalized estimation is accomplished by harnessing a variant of the standard Expectation Maximization (EM) algorithm known as the Minorization Maximization (MM) algorithm (). The MM algorithm for haplotype frequency estimation converges in fewer iterations with no loss in imputation accuracy (). Mendel-GPU is implemented in C and OpenCL. If a GPU device is available, users can activate a flag to enable execution of our OpenCL kernels. We include several utilities that ease the transition from other standard formats such as variant call files (VCF), PLINK binary files () and the reference haplotype formats used by HapMap and the 1000 Genomes Project (KGP) (). Because memory demands can be especially heavy in imputation of whole chromosomes, Mendel-GPU automatically splits large regions into subregions that safely fit within the confines of GPU memory. Unlike competing methods, which do not operate on a sliding window, Mendel-GPU can generate genotype, dosage and quality metric data on the fly, reducing overall memory burden substantially. Imputed genotypes and haplotypes are output in SNP major order to facilitate integration with databases and SNP association testing.
RESULTS
Comparisons with competing programsWe compared the performance of Mendel-GPU with leading programs for genotype imputation: in particular thunder (), IMPUTE2 (). In contrast to previous evaluations of haplotyping () and imputation performance (), we base our simulations and comparisons on the KGP rather than microarray derived data. In our first example, we performed genotype imputation and haplotyping with no reference haplotypes present on simulated 24 coverage data generated from a 1 MB region of Chromosome 22 taken from the KGP.compares our runtime and accuracy results to those from the three competing programs. The second column of the table indicates haplotype phasing performance, measured as 1 minus the switch error, while the third column indicates imputation performance, measured as concordance of imputed heterozygotes to true heterozygotes. Our results indicate comparable haplotyping and imputation accuracies across all programs. In terms of computational efficiency, Mendel-GPU achieved 6-, 33-and 76-fold speed improvements over BEAGLE, IMPUTE2 and thunder, respectively, while requiring only 56, 13 and 33% as much peak memory. In our second example, we considered a random 7 MB dataset derived from the KGP where one has ethnically matched reference haplotypes. One half of the KGP was reserved as reference haplotypes, and the other half was used to simulate 24 coverage data. In capitalizing on reference haplotypes, Mendel-GPU takes advantage of a computationally efficient middle-thirds algorithm. Because all genotypes in the middle third of a sliding window are imputed simultaneously, the speed and memory improvements for Mendel-GPU are more impressive inthan. Mendel-GPU is 104 and 144 times faster than BEAGLE and IMPUTE2 and requires only 815% of their peak memory demands. Mendel-GPU's accuracies fall between those of BEAGLE and IMPUTE2. Note that thunder does not support reference haplotypes.
DISCUSSIONWe have described software to meet the challenges of imputation in whole-genome sequencing data. Mendel-GPU supports the use of dense reference haplotypes and genotype penetrances as reported by variant calling pipelines. As the two examples illustrate, Mendel-GPU enjoys similar accuracies to the most highly regarded programs available, while requiring only a fraction of their time and memory demands. The fine-grained parallel algorithms of Mendel-GPU effectively harness the computational efficiency and memory bandwidth of hundreds of GPUs. Although BEAGLE appears to have an edge in accuracy in the scenarios tested, the speed and memory advantages of Mendel-GPU outweigh, in our opinion, its slight losses in accuracy. As GPU devices increase in sophistication and we further tune the code of Mendel-GPU, we expect to see greater gains. Even as things now stand, Mendel-GPU will prove helpful. For researchers interested in testing rare variants coordinated with the KGP, our simulations highlight potential gains for study data consisting of a few hundred subjects sequenced at modest coverage. For example, whole-genome imputation of low-pass sequencing data on 545 study subjects would complete in $6.8 days on a machine equipped with a single nVidia Tesla C2050 GPU. The same analysis using IMPUTE2 would require $2.7 years on a single CPU machine. This difference puts small laboratories back in contention with the sequencing factories. Enabling small projects will ripple productively through the entire fabric of genomics research.
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
G.K.Chen et al. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
