DivBayes is a program to estimate diversification rates from species richness and ages of a set of clades. SubT estimates diversification rates from node heights within a clade. Both programs implement Bayesian statistics and provide the ability to account for uncertainty in the ages of taxa in the underlying data, an improvement over more commonly used maximum likelihood methods. Availability: DivBayes and SubT are released as C++ source code under the GNU GPL v. 3 software license in Supplementary information 1 and 2, respectively, and at
INTRODUCTIONBayesian inference has become a major part of the phylogenetic analysis tool kit, including applications such as topological inference and ancestral state reconstruction (). However, methods of Bayesian inference are still not widely applied to infer species diversification rates, a major field within macroevolution (). Here, we present two new programs that use Bayesian statistics to estimate net diversification rates (speciation minus extinction rate) and relative extinction rate (extinction rate divided by speciation rate) under the Yule or birthdeath model based on two different types of datasets. DivBayes uses the number of species and clade ages of a set of taxa (likelihood formula in), while SubT uses node height data from within a clade (likelihood formula in). Here, clade age data refer to the stem age of a group and may be derived from fossils, dated phylogenies or other sources. Node height data refer to the split between each lineage in a group and are most likely to derive from dated phylogenies.
TEST DATASETSProgram performance was evaluated on data simulated in Geiger () under Yule and birthdeath models (Supplementary Materials 3 and 4). The DivBayes estimates were compared with maximum likelihood (ML) estimates performed in R. Different standard deviations were applied to the age priors (Supplementary Material 4). Each analysis was done assuming equal diversification rates for all clades and using a run length of one million generations with the MCMC sampled every one thousand generations. The performance of SubT was compared to that of the ML-based R packages LASER () and APE (). SubT was tested on trees simulated to include different number of species as well as different numbers of randomly selected species, with known node heightsreplaced by 'substitute taxa' (Supplementary Material 4). Each dataset was analyzed using ten million generations sampling every ten thousandth. In both DivBayes and SubT analyses, the Yule model was used for datasets simulated under the Yule model while the birthdeath model was
M.Ryberg et al.
ABused for the datasets featuring extinctions. Default values were used for priors and starting values. Both DivBayes and SubT were found to perform well under the various conditions examined. Both analyze reasonably large datasets within minutes, and the execution time scales linearly with number of data points (clades/nodes). In our test datasets, the addition of uncertainty in clade ages results in DivBayes execution times 1.52 times longer than runs with exact dates. The extra execution time implementing 'substitute taxa' in SubT depends on the number and proportion of taxa. It scales reasonably linearly when <50% of the data are 'substitute taxa', but run time increases considerably in our test datasets when 'substitute taxa' represent 75% of the data (Supplementary Material 4). Parameter values used in simulations of DivBayes fall within the estimated 95% credibility interval both for the Yule datasets and datasets with relative extinction rate of 0.1. The net diversification rate was overestimatedand extinction rates underestimatedfor the data simulated under the highest and lowest net diversification rates (0.375 and 0.0075) and the higher relative extinction rates (0.5 and 0.9;; Supplementary Material 4). These simulated values differ markedly from the default net diversification prior (mean 0.1). It is only for the highest relative extinction rate that the ML estimate is closer to the parameter values used for the simulation than the median of the posterior distribution estimate in DivBayes.Parameter values used in simulations of SubT fall within the 95% credibility interval for all but three estimations (for different number of 'substitute taxa') made on one tree. In APE, the net diversification parameter used in the simulations occurs outside the 95% confidence interval in four cases and in two cases for the relative extinction rate. The ML estimates for net diversification rates from LASER and APE were never >0.015 U different from the median of the posterior distribution in SubT (Supplementary Material 4).
CONCLUSIONSWe present two freely available, stand-alone programs for Bayesian analyses of diversification rates: DivBayes and SubT. Both produce reasonable estimates of net diversification and relative extinction rates (comparable to ML estimates) with decent computational times. Both programs also incorporate uncertainty in age estimates of taxa, a significant advantage in dealing with datasets characterized by incomplete taxon sampling.
* To whom correspondence should be addressed. 2 IMPLEMENTATION Both DivBayes and SubT use a MetropolisHastings MCMC algorithm (e.g. Gilks et al., 1995) to estimate the posterior distribution of parameters. In DivBayes, it is possible to assume equal or different diversification rates for all clades, or define which clades should have the same rates. The method implemented in SubT is based largely on Bokma (2008) and uses his algorithm to update parameters. Both programs are command line based and will read commands and data from a text-formatted input file. The output can be summarized with a separate command. The MCMC is presented in a tab-delimited file that can be read by many other applications such as R (R Development Core Team, 2010) or spreadsheet programs. In Bayesian analysis, it is easy to incorporate uncertainty in the underlying data by treating such data as parameters to estimate (Gilks et al., 1995). In DivBayes, it is possible to use normal distributions as priors for the clade ages instead of using absolute dates. Similarly, in SubT it is possible to include 'substitute taxa' (Ryberg and Matheny, 2011) for taxa with unknown node heights, using a uniform distribution between zero and the oldest included node as a prior. SubT can also handle distributions of data by reading several sets of node heights and performing estimates on each set separately. The final estimate can then be averaged over the given distribution.
The Author 2011. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oup.com
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
