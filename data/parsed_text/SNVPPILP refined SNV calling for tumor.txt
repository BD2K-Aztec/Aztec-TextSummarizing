Motivation: Recent studies sequenced tumor samples from the same progenitor at different development stages and showed that by taking into account the phylogeny of this development, single-nucleotide variant (SNV) calling can be improved. Accurate SNV calls can better reveal early-stage tumors, identify mechanisms of cancer progression or help in drug targeting. Results: We present SNV-PPILP, a fast and easy to use tool for refining GATK's Unified Genotyper SNV calls, for multiple samples assumed to form a phylogeny. We tested SNV-PPILP on simulated data, with a varying number of samples, SNVs, read coverage and violations of the perfect phylogeny assumption. We always match or improve the accuracy of GATK, with a significant improvement on low read coverage.
IntroductionRecent studies on cancer tissue () suggest that as the disease progresses, the original tumor progresses into several different sub-clones. These sub-clones contain not only the original mutations but also new mutations added over time; this work focuses on single-nucleotide variants (SNVs). Accurate SNV calls can better reveal early-stage tumors, identify mechanisms of cancer progression or help in drug targeting. This phylogenetic assumption has been recently taken into account in, by proposing a tool for refining the SNV calling of GATK's Unified Genotyper (), the state-of-the-art SNV multi-sample caller for next-generation sequencing data. In this note, we present SNV-PPILP (SNV calling with Perfect Phylogenies and Integer Linear Programming), a tool for refining GATK's Unified Genotyper SNV calls for multiple samples. We assume these samples form a character-based phylogeny, the characters being the SNVs reported by GATK. As in, we work with the perfect phylogeny model; however, we have a new problem formulation for fitting GATK's calls to such a phylogeny, which we solve exactly using integer linear programming (ILP). SNV-PPILP can be run especially on low-coverage samples, without big violations of the perfect phylogeny model. For a significant improvement in accuracy, six or more samples are needed.
MethodsThe perfect phylogeny model assumes that (i) once a mutation occurred in a node of the phylogenetic tree, it is passed along to all its descendants and (ii) a mutation does not recur in other nodes apart from these. As argued in, these assumptions are reasonable in the context of cancer genomics. From the set ofn rows represent the n samples and whose m columns represent the set of all m SNVs found by GATK's Unified Genotyper in at least one sample. For every entry (i, j) where GATK's Unified Genotyper did make a call (either of presence or absence), GATK also provides a likelihood (PL field), which we denote here by L(i, j). It is a standard result, e.g., that this matrix corresponds to a perfect phylogeny if and only if every two columns j 1 and j 2 are compatible, in the sense that for no three rowsOur strategy is, in the first step, to select a set of pairwise compatible columns by a maximum-weight independent set (MWIS) formulation, similar tobut which we solve here exactly using ILP. In the second step, we iteratively edit the remaining columns, so that they become compatible with the columns initially selected and with those corrected so far. This is achieved using a new problem formulation, which we also solve by ILP. In the first step, we collapse identical columns into mutation groups and consider the graph in which they are the nodes and where two mutation groups are adjacent if and only if they are not compatible. Using ILP, we find a MWIS in this graph, where, contrary to, a mutation group has as weight the sum of the likelihoods of its calls. Denote by A the matrix made up of the columns in the mutations groups of this independent set; A corresponds to a partial perfect phylogeny. Denote by B the matrix made up of the other columns of matrix M. In the second step, contrary to, we iteratively edit each column in B, so that it becomes compatible with all columns of A, remove it from B and add it to A. We consider the columns of B in decreasing order on their average likelihoods. We propose a new editing strategy, for each such column c, as follows. For each row i, if Mi; c  1, then the weight w(i, c) of correcting the ith row of c is L(i, c). If Mi; c  0, then we set w(i, c) to be the mean of the likelihoods of the '1' entries in column c minus ffiffiffi 2 p times their standard deviation. Having these weights, we then ask for the correction of the rows of c, such that the sum of the weights of all corrections is minimum. We solve this by another ILP, as follows. We transform all '0' entries into '1' entries to flip them by a multiplication with 1. For every row i, we have a variable x i 2 f0; 1g, with the meaning that if x i  0, then we flip the entry in row i of column c, and if x i  1 then this entry is not flipped. Thus, each row i of the corrected column becomes 2x i  1Mi; c. We want to find the binary vector x 1 ;. .. ; x n  which maximizes P n i1 x i wi; c, under the constraint that the edited column is compatible with each column in A.Finally, we add the edited column to A, and remove it from B and proceed by editing the next column in B. At the end of this process, matrix A is the edited matrix of all SNVs reported by our method.
Experiments and discussionWe conducted three types of experiments on simulated data, as follows.(i) First, we created a 'perfect' scenario, by varying the number of samples, between 3 and 10, and generating a random tree with that number of leaves. We randomly assigned mutation groups (i.e. sets of known SNVs from GATK resource bundle dbsnp_137.b37) to the edges of these random trees. The size of the mutation groups was varied according to four simulation scenarios, described in(right). This resulted into 8  4  32 experiments. We ran the experiments on chromosome 21. In each leaf (i.e. sample) of the simulated phylogenetic tree, we mutate chromosome 21 with the set of SNVs appearing in mutation groups on the path from the root to it. With DWGSIM (), we generate Illumina reads from it, of length 100, coverage 15 and base error rate set to the default 2%. We align them with BWA-MEM (), and the alignments are given to GATK's Unified Genotyper. As in, we followed GATK's best practices guidelines (see Supplementary Material for details) and ran GATK in multi-sample mode. (ii) Second, we repeated the above 'perfect' scenario but with coverages 30 and 100. (iii) Third, we considered violations of the 'perfect' scenario, by allowing recurring mutations [violations to property (ii) of the perfect phylogeny model]. For each r 2 f1; 5; 15g, we selected r% of all mutations present in the tree and assigned them to one edge of the tree at random. As above, we then propagated them to all the leaves descending from this edge. This gave 8  4  3  96 other experiments. For each SNV in the union of all mutation groups labeling a tree and for each sample (i.e. leaf of the tree), we checked whether the SNV was reported correctly in the sample (true positives (TP)), if. The F measure of GATK's Unified Genotyper's calls (column A), SNV-PPILP's calls (column B) and of the method of Salari et al.The values are averages over the four mutation group sizes. These are distributed normally, with mean and standard deviation as shown on the right it was missing from the report, when it should have been present (false negatives (FN)) or if it was reported even though it should not be present (false positives (FP)). We computed the F measure  2  TP/(2  TP  FP  FN) shown in(left). We experimented also with the method of, but its F measure was consistently worse than GATK's original calls. For this reason, we report it only in the perfect scenario. SNV-PPILP's F measure is always the same or better than GATK's. At 15 coverage, the difference with respect to GATK's F measure is significant. On 30 coverage, we see $1% difference in F measure. At coverage 100, GATK's F measure is very good, at $0.98. SNV-PPILP's F measure remained the same up to the third decimal. However, we noticed a slight improvement in the absolute numbers of TPs and FNs (see Supplementary Material). Even though for high coverages the relative improvement is small, it might reveal some critical SNVs in cancer progression studies. Moreover, SNVPPILP seems resilient to a degree of heterogeneity, as the F measure improved even for a recurring rate r  15%. However, big violations to the perfect phylogeny model cannot be handled by our model, as this is its core editing principle. We also ran SNV-PPILP on six whole-genome breast cancer samples from NCBI: PRJNA193652. SNV-PPILP's runtime is only a fraction of GATK Unified Genotyper's overall running time. All running times are provided in the Supplementary Material.
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
K.E. van Rens et al. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
