Motivation: In order to obtain statistically relevant results, the study of membrane effects at the single-vesicle level requires the analysis of several hundreds of giant unilamellar vesicles (GUVs), which becomes a very time-consuming task if carried out manually. Complete and user-friendly software for fast and bias-free automated analysis has not been reported yet. Results: We developed a framework for the automated detection, tracking and analysis of individual GUVs on digital microscopy images. Our tool is suited to quantify protein binding to membranes as well as several aspects of membrane permeabilization on single vesicles. We demonstrate the applicability of the approach by comparing alternative activation methods for Bax, a pore-forming protein involved in mitochondrial permeabilization during apoptosis. Availability and Implementation: The complete software is implemented in MATLAB (The MathWorks, Inc., USA) and available as a standalone as well as the full source code at
INTRODUCTIONIn recent years, giant unilamellar vesicles (GUVs) have become powerful and widely used tools to study membrane processes (). Among other applications, GUVs are extensively used to investigate the mechanisms of pore-forming molecules (). In previous work, we developed a GUV-based single-vesicle method for the analysis of membrane permeabilization (). The individual-vesicle integrity, the permeabilization degree, the stability of the permeabilized state, the binding of proteins to the membrane as well as the kinetics of single-vesicle leakage can be successfully addressed with this approach (). However, to achieve high statistical accuracy, several hundreds of GUVs per experiment need to be considered. The analysis of GUV experiments is mostly carried out on digital microscopy images using basic image processing techniques like measuring mean pixel intensities on defined regions of interest or quantifying certain shape features (). Due to the high amount of vesicles, this method usually turns out to be extremely time consuming and can additionally suffer from subjective bias if carried out manually. The researcher might tend to select GUVs following certain characteristics like size or degree of filling and thus introduce a bias into the sample. So far, integrated systems for segmenting large populations of lipid vesicles are scarce in publishing research.proposed a vesicle segmentation algorithm based on the Markov random field model, which depends on a bright vesicle rim and a generous intensity contrast between the inner and outer region of the vesicle. This is hardly the case in permeabilization studies since a reduced dye concentration and laser power during image acquisition is required to not considerably affect membrane properties. We propose the Circular Hough Transformation (CHT), a robust technique to find circular patterns in images (), for the segmentation of GUVs and demonstrate its efficiency on noisy real experiment images. To our best knowledge, this article presents the first complete and user-friendly framework for the automated detection and analysis of large GUV populations. It is suitable for an entire permeabilization analysis, including kinetics and the size and stability of pores. In addition, radial profiles for each vesicle can be used to acquire quantitative information about protein binding to membranes. The automatization is not only advantageous in terms of time saving, but also guarantees an unbiased statistical analysis to the highest possible extent. The software is therefore powerful not only in detecting circular objects in microscopy images, but also objects which moderately deviate from the circular shape. For the analysis of movies, we implemented a tracking algorithm which allows tracking of single vesicles, making the software applicable to moving GUVs. To validate the approach and demonstrate the applicability of our program, we investigated the degree of individual vesicle *To whom correspondence should be addressed. permeabilization induced by Bax under different activating conditions. Bax is a member of the Bcl-2 family with a major role in the regulation of apoptosis. It induces the permeabilization of the outer mitochondrial membrane (OMM) that releases cytochrome c (cyt c) during apoptosis (). Despite intense research, the mechanism of Bax-induced OMM permeabilization is under debate. Previous studies showed that the cleaved form of the BH3-only protein Bid activates Bax (). Furthermore, Bax activation has been shown to occur in vitro by incubation with detergents, acid pH or high temperature (). But whether these methods induce comparable Bax activation and pore activity remains unknown. In this article, we compared the effect of these four activating methods on Bax-induced membrane permeabilization at the single-vesicle level. Our results demonstrate that all four methods efficiently activate Bax and yield comparable all-or-none pore activity on cardiolipin-containing GUVs.
GENERAL FEATURES
Pre-processingRaw images as acquired under real conditions are usually not optimally suited for segmentation but require some pre-processing. Most GUV images have a poor contrast due to low dye concentration and laser power (as usually desired to avoid artifacts). On the other hand, the GUV-detection algorithm is initialized by the detection of edges, which is best carried out on a high-contrast image. Thus as a crucial step, contrast is increased by linear mapping of a user-defined gray-value interval I min ; I max  to the maximally representable grayscale range. Values below I min are mapped to 0 and those above I max to the highest possible gray-value. Additionally, we found that slight smoothing contributes to an increased detection performance. From our experience, convoluting the image with a boxcar filter to smooth out short-scaled noise works best on fluorescent microscopy images. For high processing speed it is convenient to minimize the file size as much as possible but a limit to this procedure is given by the accuracy of object localization and gray-value determination. On the image, even the smallest GUVs must have a size that is much larger compared to the size of one pixel. In our experience and considering typical GUV sizes, resizing to a resolution of 1.7 pixels/mm seems to be a good choice. The applied resizing mechanism is based on the bicubic interpolation.
Automatic detection of GUVsThe detection algorithm is based on the CHT, a model-based method for the segmentation of circular shapes in images. The CHT mainly consists of a voting process, where every point in the image votes for a point in an accumulation array according to a specific voting scheme. Image points belonging to a circularshaped object vote for the same point in the accumulation array, leading to local maxima. The detection of circles is then reduced to the task of detecting peaks in the accumulation array (see Supplementary Material for a more detailed description of the CHT). Parallel to the classical CHT method provided by Matlab, we use a variation of the Adaptive Hough Transform (). Some GUVs are detected only by one of both methods but based on our experience we could not figure out if one of the methods works generally better on our images than the other. The parallel arrangement of both CHT algorithms maximizes the detection efficiency by providing the set union of the individual results. In case that one GUV is detected by both methods, one of the counts is eliminated; the requirement for such discrimination is that the distance between the center points is less than the sum of the radii of both GUVs.and C show the final accumulation array for a typical GUV image () in 2D and 3D, respectively. The peaks clearly indicate the positions of the GUVs. The tool is not only restricted to detect perfectly spherical vesicles but can also deal with objects which slightly deviate from the circular shape, for instance ellipses. Inwe used one of the images obtained from the same experiment asand stretched it by a factor of 1.5 in horizontal direction. As a result, the GUVs appear as ellipses instead of circles. Our tool detected 22 objects from which two were false detections and two objects were missing. The circle detection is the key process and the raw output, consisting of center points and radii, can be used for several kinds of pixel-based analysis. Our program is specialized to determine mean intensities within circles as well as radial intensity profiles, but the implementation of other analysis schemes is straightforward.
GUV tracking in image sequencesWhen dynamic processes are of interest, time series can be recorded resulting in stack files with several frames, usually 4100. Normally, the vesicles change their position from frame to frame due to Brownian diffusion. Moreover, GUVs can diffuse into or out of the observed sample region, leading to a changing number of detections among the frames. Particle tracking plays an important role in biosciences when time-lapse experiments are performed on moving particles (). We implemented a tracking algorithm to follow the movement of single vesicles through the image sequence. The GUVdetection algorithm is applied to each frame and yields a set of T (total number of frames in the image sequence) matrices C t with rows x p ,, where N t is the total number of detected GUVs in frame t and x p , y p  are the coordinates of the center point of one GUV. The tracking tool identifies detection points corresponding to the same GUV in subsequent frames. Let = represent the set of detection points p i i  1, :::, N t  in frame t and R a user-defined integer parameter specifying how many future frames are to be considered. For all sets @ r , r  1, :::, R, of detection points q j , where j  1, :::, N tr in frame t  r, an association matrix G t r is defined as G t r i, j  1 if p i in frame t and q j in frame t  r are produced by the same vesicle and G t r i, j  0 otherwise. Every row and every column of G t r can contain maximally one entry of value 1, all others are 0. The detection points p i and q j are associated to the same GUV if the distance between their center points is smaller than for any other possible association and is at the same time below a userdefined threshold.If for one r41 we have G t r i, j  1 but G t r 0 i, j  0 for all r 0  1, :::, r  1, it means that a GUV was successfully detected in frame t and frame t  r, but not in the intermediate frames. Nevertheless we assume that the GUV is also present in the intermediate frames but is missing in the result due to limited detection efficiency. In this case, the missing detection points are automatically added to the intermediate frames. The center point x * rt 0 of a missing vesicle in frame t  r 0 is set to: Accordingly, we set G t r 0 i, j  1 for all r 0  1, :::, r  1: Let t and t 0 be frames, t 0 4t: Then the one-elements of the matrix product B tt 0  Q t 0 it G i 1 connect the detection points between the two frames. B tt 0 i, j  1 means that the i-th detection in frame t and the j-th detection in frame t 0 are produced by the same GUV.
Automated pixel-based analysisUsually, when imaging GUVs, more than one fluorophore is used and thus the image file consists of stacks containing several channels. In order to perform unbiased GUV detection, one channel should contain the fluorescence signal of the vesicle membrane and the detection step is performed only in this channel. Once the center points and radii are obtained, they can in principle be used for any kind of further pixel-based analysis on the additional channels of the stack file. For the permeabilization analysis, the percentage of GUV filling is given bywhere F in and F out are the average fluorescence intensities inside and outside a GUV, and F 0 is the initial fluorescence signal inside the GUV or noise offset. Along this article, we will usually refer to F out as background and to F 0 as offset.The background as well as the offset is determined separately for each channel and frame to preserve intensity variations across the image. For the automated determination of the background intensity, the algorithm first smoothes the image with a boxcar filter of 1/50 of the original image size. The most frequent grayvalue in the smoothed image is reported as background intensity. The offset is estimated by collecting pixel intensities within nonpermeabilized GUVs, as they provide regions where no free dye but only noise contributes to the local fluorescence intensity. To keep GUV pixels separate from background and considering typical GUV diameters, we smooth with a smaller boxcar filter, having 1/90 of the original image size. The average over the 1000 darkest pixels is reported as offset. Unlike the detection which is performed on one specified channel, the analysis of percentage of GUV filling according to Equation (1) is carried out on all channels. This allows for performing a variety of analysis, like total permeabilization, permeabilization kinetics or estimation of pore stability and size (). For example, the histogram of permeabilization degrees of a GUV population provides insight into the mechanism of pore formation, while the permeabilization kinetics can be used to estimate the total permeabilized area per GUV.shows some example measurements that can be analyzed with the presented program. Time-lapse image sequences allow the observation of the GUV-filling process with time and can be used to characterize the permeabilization kinetics (). The ability to read out intensities at the same position in different channels can be mostly used for studying the stability) and were composed of PC/CL (4:1) with 50.05% DiO used as lipid marker. All images are single confocal images. The extension of the focal volume in z-direction is 2 mm. (B and C). In the detection process, the accumulation array (matrix) has the same size as the original image and contains real numbers which are initially all set to 0. The voting process of the CHT leads to a pattern where maxima correspond to the center positions of the GUVs. Detecting GUVs is reduced to the task of finding maxima in the accumulation array. (D) The program is also suitable to detect objects which are not perfectly round. By stretching one of the images from the same experiment by a factor of 1.5 in horizontal direction, the vesicles appear as ellipses. The automatic detection yields a total amount of 22 identified objects in the shown image, from which two were false detections, while two objects remained undetected. The bright spots are MLVs containing lipids in their interior. Ideally, only true GUVs contribute to the permeabilization result, while MLVs are excluded from the analysis by thresholding the inner pixel intensity of the vesicles in the membrane channel of the permeabilized state and estimating the pore size, as explained in. Moreover, the program analyzes the radial profile of each vesicle, which provides mean pixel values along a circle perimeter as a function of the radius. This function is suitable to quantify protein binding to GUV membranes. If the protein of interest, fluorescently labeled, binds to the membrane, a peak of fluorescence intensity appears on the GUV boundary (). The algorithm automatically discriminates multi-lamellar vesicles (MLV) since they are not of interest for permeabilization measurements. Due to their multiple-labeled lipid bilayers, they are characterized by high inner-pixel intensity in the membrane channel and are excluded from the analysis by simple thresholding.
Manual control of the automated analysisThe program presented here includes several options to control manually the quality of the analysis. These options are accessible via the graphical user interface we provide (Supplementary) and are explained in detail in the user manual which we provide together with the software. False detections can be removed fast and easily by clicking on them and pressing the Remove button. On the other hand, the user can manually add undetected GUVs by dragging a mask over the region of interest and defining this region as a new GUV. Background and offset intensities can be modified by hand at any time during the analysis. Even when the data are already analyzed, a change in background or offset prompts the program to recalculate the data. Additionally, the user can collectively scale the radius of the GUVs by a factor of his choice. This is especially useful if small vesicles with diameters 520 pixels dominate the image. Then, the size of the region of interest for measuring the inner pixel intensity has to be chosen generously smaller than the GUV itself to ensure that no background is included in the region of interest. A rescaling of the radii by a value between 0.4 and 0.8 is highly recommended in this case.. The automated GUV analysis tool is suited to analyze image sequences (movies) and multichannel images. In all cases, the detection of the GUVs is performed on a user-selected channel. Generally, the membrane channel should be used for an unbiased detection. The mean pixel intensity is read out on the obtained regions of interest (interior of vesicles) in all channels and frames. (A) Taking an image sequence during an experiment of GUV permeabilization allows the observation of the filling kinetics. Here, two independent GUVs (red and blue) were observed every 20 s for 1000 s. Scale bar: 30 mm. (B) The multichannel analysis can be used to characterize the pore size and pore stability. For pore size, two free dyes with different molecular sizes are added simultaneously and the degrees of filling for both dyes are compared. Cyt c (12 kDa) can be used as dye 1 and APC (105 kDa) as dye 2, for instance (). For pore stability, different free dyes with similar chemical properties are added at different times during incubation. A stable pore remains open once it is formed and allows the internalization of all dyes. To demonstrate the principle of the multichannel analysis, we used here Alexa488 (dye 1) and Alexa633 (dye 2), which have the same size and were added at different time points, and analyzed 23 GUVs composed of PC/ CL (4:1) with 50.05% DiO. The fact that the permeability of the individual vesicles is essentially the same for both dyes indicates that the pores are stable. If this were an experiment to test pore size, the conclusion would be that the pores are large enough to allow the entry of both dyes. To make a statistically significant conclusion, independent repetitions and a large number of vesicles (4100 per repetition) are needed. Scale bar: 30 mm. (C) Radial profiles are created for all GUVs in a user-defined channel. The pixel intensity averaged over a circle perimeter (y-axis) is recorded as a function of the circle radius (x-axis), starting at the GUV center point and reaching up to the doubled GUV radius. The radial profiles of a bright and a dark GUV are shown as examples. Both vesicles have a radius of 20 pixels and the zero-position was set to the vesicle center. This method can be used, for instance, to quantify protein binding to the membrane. Here, the radial intensity originates from DiO in the vesicle membrane. Scale bar: 10 mm
METHOD VALIDATION
Finding an optimal set of parametersWe first tested the performance of our tool for different parameter sets on a training image from the same experiment as used for the evaluation in. Therefore we compared the efficiency of the automatic GUV detection, namely the number of correctly detected GUVs and the number of false detections (detections which do not correspond to GUVs). For the permeabilization study, only undistorted GUVs are desired to contribute to the result, since they are well-defined structures. No MLVs should be included.shows the effect of the user-defined parameters, namely the contrast adjustment and the radius range, on the detection result. A high contrast is favorable for a good detection rate but exorbitant contrast enhancement would saturate a large number of pixel values and reduce the detection performance. In our experiments, we labeled the vesicle membrane with 0.05% DiO and adjusted the laser power so that the GUVs can still be seen on the microscope (30200 mW). Under these conditions, we found best if pixel values ranging from 0 to 30 (with 255 being the highest pixel value) are mapped to the full representable range of pixel intensity. For the radius range, a default of 1050 pixels is predefined in the GUI and works best for GUVs prepared following the proposed protocol () and an image resolution of 2.4 pixels/mm. In general, the minimum radius should not be set below 10 pixels since it is not possible to measure the fluorescence intensity within smaller GUVs with sufficient accuracy. On the other hand, choosing a maximum radius 450 pixels is only recommended in the absence of small GUVs. Otherwise, the CHT tends to misinterpret accumulations of small vesicles as one huge GUV, if those accumulations have a roughly circular shape. However, we did not observe this effect using the default radius range. MLVs are excluded from the analysis by a user-defined threshold for the intensity of the vesicle interior in the membrane channel. To determine the most appropriate threshold value, we measured typical MLV intensities using the manual tools provided in the GUI and arrived at a best value of 7 (total range is 0255). Additionally, the user has the possibility to scale down the size of all masks where the pixel intensity within the GUVs is read out. We encourage the user to test for different scaling factors prior to saving the analysis result. Proper scaling will ensure that no background pixels contribute to the result. For the training image, a scale factor of 0.45 was the best choice. Assuming a homogenous dye distribution within the GUVs, an underestimation of the scaling factor has no effect on the permeabilization histogram. On the other hand, an overestimation will shift the histogram towards high permeabilization values since background pixels are included in the masks. Even when the best parameter set is found, some GUVs may still remain undetected, which is mainly due to the following reasons.Brightness: one particular GUV may contain less dye on its membrane than the majority of the vesicles in the image. As a result, it shows less fluorescent intensity and will probably not be matched by the Hough Transformation. To avoid this, the experimentalist should mix well the lipidSize: the CHT requires a user-defined radius range for the search of circular objects. We recommend a range of 10 to 50 pixels for image resolutions of $2.4 pixels/mm and using the electroformation protocol suggested in this manuscript (). Some large GUVs are beyond this range and remain undetected, but can be easily added manually. Anyway, they are not expected to have a different permeabilization behavior compared to the rest of the GUVs. However, in cases where proteins influence the size of the GUVs, the software could add bias by preferably analyzing a certain size range. This needs to be considered by the researcher.Distorted shape: if carried out carefully, the electroformation produces circular GUVs. Otherwise, some vesicles deviate from the circular shape. As demonstrated in, our tool also detects distorted shapes like ellipses, but with lower efficiency compared to circles. A slight deviation from the circular shape should in principle not affect the ability of vesicles to permeabilize. In some cases it is even advantageous to exclude distorted GUVs from the analysis (for example for the estimation of vesicle radii).
Comparison of manual and automatic analysisThe quality of the automated GUV detection and analysis was evaluated using a set of images from real experiments. The degree of membrane permeabilization was directly determined by monitoring the entry of a dye into the lumen of the GUVs initially devoid of dye (). The extent of permeabilization can be quantified for individual vesicles on the sample. This allows the identification of subpopulation effects, which is not possible in traditional bulk experiments. To analyze the goodness of our automated GUV analysis, we compared the extent GUV permeabilization obtained in the experiments with three different analysis methods: (i) automatic analysis without any manual interaction except for eventual background/offset correction or radius rescaling, (ii) a semi-automatic analysis which consists of the first method followed by manual removal of false positives and (iii) the second method followed by manual adding of missing GUVs. Note that the third analysis mode provides the same result as a completely manual analysis since it includes all possible manual corrections.shows the direct comparison of all three methods in terms of population analysis of the degree of single GUV permeabilization, as well as the required analysis time for a set of images containing GUVs after incubation with inactive Bax. Totally, our test images contained 200 GUVs. The permeabilization distribution differs only slightly among the methods and in all cases leads to the same conclusions for the experiment (). In this comparison, the automatic method provides a higher fraction of highly permeabilized GUVs (with 490% filling degree) than the manual and the semi-automatic methods. This is mainly due to false detections, which do not correspond to vesicles but to background, thus yielding a higher fraction of reputedly fully permeabilized GUVs. Comparing the analysis time, we find important differences between the pure manual analysis and the three methods making use of our tool (). Without any manual corrections, one can save $95% of analysis time compared to the manual analysis, while achieving a very similar result. Even for full corrections, which provide the same result as the manual analysis, one still saves $70% of analysis time. From our results, we estimate an averaged analysis speed for one image of around 80 GUVs per minute on a common desktop computer with 3.40 GHz and 16 GB RAM, compared to $6 GUVs per minute for manual analysis. It is notable that this high level of accuracy is achieved by detecting only 60% of available GUVs compared to the manual analysis. In our evaluation experiment, the pure automatic detection provided 167 GUVs; 47 of them were false positives and 80 GUVs could not be detected automatically. This robustness of the method is due to the fact that the number of GUVs belonging to a certain class (e.g. bin of 10% of degree of filling as in our analysis) follows a Poisson distribution and, as a result, the error of the measurement depends on the square root of the number of GUVs. For this reason, in order to obtain high statistical accuracy, not the fraction of detected GUVs is of importance, but the absolute number of data points. From our experience, analyzing $100 GUVs per experiment is already sufficient for a representative result. Adding more GUVs to the analysis will cause only a slight increase in statistical accuracy, which is in most cases irrelevant compared to the systematic error of the individual experiment. In most applications, the semiautomatic analysis is a good balance between fast processing and accurate results.
Different methods of Bax activation yield similar permeabilization of GUVsWe validated and demonstrated the applicability of the automated GUV analysis tool by testing the permeabilization ofwas used to compare the detection performance for different parameter sets. For contrast, the indicated range of intensity values is linearly mapped to the full range of 0255. Radius range is given in pixel units (image resolution is 2.4 pixels/mm). The first line shows the optimal parameter set, giving the best balance between high number of detected GUVs and low number of false detections. Since it is easier to manually remove a false detection than to add a missing GUV, we assign more weight to the number of detected GUVsGUVs induced by Bax using different methods of activation. GUVs composed of pure PC or PC/CL (4:1) were visualized using lipophilic dyes of different colors (DiO, green and DiD, red), mixed in a buffer-containing free Alexa555 and Bax at 20 nM, and incubated under four different conditions (): (i) in the presence of cBid, (ii) in the presence of detergent, (iii) at pH 5.5 and (iv) at T  42 C (experiments (i), (ii) and (iii) were performed at room temperature). The experimental details are described in the Supplementary Material. By mixing GUVs of different lipid compositions, preferences for certain membrane types can be directly assessed in a situation closer to the coexistence of membranes in a cell. For all conditions, we observed permeabilization of vesicles containing CL, but not with pure PC, illustrating the effect of the mitochondrial lipid CL on the membrane activity of Bax (). It is notable that with all activation protocols, similar all-or-none permeabilization was observed. Comparable results were obtained when CL was substituted by PG (data not shown), indicating that rather than a specific CL effect, negatively charged lipids are necessary and enough for Bax pore activity. Supplementaryshows the corresponding control experiments. Our results suggest that all four methods of Bax activation promote a similar mechanism of pore formation. This all-ornone mechanism is likely associated with a cooperative transition from a closed to an open state.
CONCLUSIONSIn this article, we presented a computationally efficient and robust method for the detection and analysis of GUVs based on the CHT. The algorithm is not intrinsically limited to GUVs. In principle, giant vesicles produced from the plasma membrane of cells or any other circular objects can be detected according to the applicability of the CHT. Even distorted circular objects can be segmented and analyzed with our tool. It can be used for quantitative studies of vesicle size, membrane permeabilization and protein binding on a single-vesicle level. Also time-lapse analysis can be performed even if the vesicles move during the measurement time. We showed that the automated-GUV-analysis platform is of high accuracy on noisy real microscopy images taken usually at low laser power and low dye concentration. The results obtained from the analysis of experiments of GUV permeabilization using our application were comparable to the results obtained in a time consuming manual analysis. Even if the automatic analysis was complemented by manual corrections to match all available GUVs, the time saving is still $70% compared to a complete by-hand analysis. The reduced analysis time is of special importance in a single vesicle approach since a high number of GUVs is needed for statistical accuracy. To validate the application in a real situation, we used it to study GUV permeabilization induced by Bax activated by cBid, detergent, acid or heat. Histograms of permeabilization values of a GUV ensemble are characteristic for the molecular mechanism forming the basis of membrane permeabilization. We observed that all four methods yield all-or-none permeabilization of CLcontaining membranes, indicating that regardless the method of activation, the mechanism of pore formation by Bax is maintained. Conflict of Interest: none declared.
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
E.Hermann et al. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
Automated analysis of giant unilamellar vesicles at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
