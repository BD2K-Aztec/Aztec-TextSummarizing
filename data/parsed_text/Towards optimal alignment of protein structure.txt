Motivation: Structural alignments of proteins are important for identification of structural similarities, homology detection and functional annotation. The structural alignment problem is well studied and computationally difficult. Many different scoring schemes for structural similarity as well as many algorithms for finding high-scoring alignments have been proposed. Algorithms using contact map overlap (CMO) as scoring function are currently the only practical algorithms able to compute provably optimal alignments. Results: We propose a new mathematical model for the alignment of inter-residue distance matrices, building upon previous work on maximum CMO. Our model includes all elements needed to emulate various scoring schemes for the alignment of protein distance matrices. The algorithm that we use to compute alignments is practical only for sparse distance matrices. Therefore, we propose a more effective scoring function, which uses a distance threshold and only positive structural scores. We show that even under these restrictions our approach is in terms of alignment accuracy competitive with state-of-the-art structural alignment algorithms, whereas it additionally either proves the optimality of an alignment or returns bounds on the optimal score. Our novel method is freely available and constitutes an important promising step towards truly provably optimal structural alignments of proteins.
INTRODUCTION
BackgroundStructural alignments are assignments of structurally equivalent amino acids between proteins with many applications in structural biology (). Generally, the 3D structure of a protein determines its function and is often more conserved during evolution than protein sequence. Therefore, structural alignment is especially useful to detect remotely homologous proteins with low sequence identity. Structural alignment is also applied to identify * To whom correspondence should be addressed. common structural elements and new protein folds and is used to cluster all known protein structures into groups. Furthermore, structural similarities can be used for functional annotation (). Various scoring functions and algorithms have been proposed. They can be divided into two categories: they are either based on the root mean square deviation (RMSD) of the 3D coordinates after optimal superposition of aligned residues or on matching inter-residue distances imposed by aligned residues. Finding an optimal assignment of amino acids is in both cases an NP-hard problem (), since coordinate and distance matrix representation of a protein structure can be transformed into each other in polynomial time (). Therefore, many structural alignment algorithms use heuristics to find alignments. They confine the search space, e.g. by considering fragments of several residues or by applying hierarchical approaches that align secondary structure elements (SSEs) in a first step. There are many different competitive approaches and techniques for structural alignment, either utilizing 3D coordinate superposition), ProtDeform (), matt (), ce (), structal (), fatcat (), sheba (), c-alpha match (ca) (), ppm (), tmalign (), lga () and rash (, or inter-residue distances [dali (), matras (), ssap () and vorolign (. Many of these algorithms are considerably accurate when evaluated based on manually curated reference alignments, and often they are quite fast. Nonetheless, they are not capable to report whether the computed alignment is optimal according to the corresponding scoring function. As a consequence, there is no way to compare different scoring schemes for structural alignment, because weak performance can be attributed either to the scoring function that is maximized or to the algorithm that is used. Some efforts to compute close to optimal structural alignments exist. For alignments based on 3D coordinate superposition, Kolodny and Linial (2004) give a polynomial-time algorithm for finding an alignment whose score lies within  of the optimal score. Although their algorithm runs in polynomial time, it is too expensive to be used in practice.suggests also a polynomialtime -approximation algorithm for a class of scoring functions based on 3D superposition, which works very well in practice. Finding the optimal alignment, i.e.  = 0, however, is not practical with any of the two approaches. Exact structural alignment algorithms based on inter-residue distance matrices have so far been limited to very basicPage: 2274 22732280
I.Wohlers et al.scoring functions. There are, for example, algorithms that compute optimal structural alignments by finding their maximum contact map overlap (CMO)), a_purva (), cmos (Xie and)], as well as faster heuristics for the same problem (). Furthermore, other exact algorithms determine a structural alignment by identifying a maximum clique of similar inter-residue distances (). These algorithms have been evaluated in terms of their capability to compute alignments to optimality and to classify rather small benchmark sets. Although optimality might be especially interesting in the case of single-case high-quality alignment, the accuracy of their alignments has not been benchmarked or compared.
ContributionIn this article, we give a general mathematical model for optimal alignment of inter-residue distance matrices. Our model is based on an integer linear programming (ILP) formulation of. We add structural scores, affine gap costs, amino acid substitution scores and a negative sequence penalty, similar to, to the model. In this way, various existing scoring functions can be emulated, e.g. those of ssap, matras and dali. While we can model these scoring schemes, the current algorithm can handle only positive scores and is practical only for sparse distance matrices. We specifically pinpoint the two restrictions that currently prevent us from computing alignments based on the original scoring functions for complete distance matrices. These are: (i) the too large number of pairs of interresidue distances, especially for long proteins; and (ii) the current lack of effectively considering negative structural scores. Therefore, we currently impose a distance threshold and use only positive structural scores. Our method is implemented in a software tool called paul. With a preliminary version of paul we showed, e.g. that the use of structural scores generates better alignments than the use of contact maps (). Now we develop a general mathematical model and a comprehensive, improved implementation, e.g. by integrating scoring schemes, gap costs, filtering and different types of inter-residue distances. We perform an extensive parameter optimization in order to determine our own customized scoring function. We do this for C  , C  and allatom distances, where all-atom distances are the minimum distance between any pair of atoms of two residues. We show that the algorithm with our scoring scheme is competitive with state-of-theart structural alignment methods in terms of alignment accuracy. Additionally, we are able to compute a provably optimal alignment in about 25% of the cases. High accuracy and optimality or nearoptimality come at the price of a significantly longer run-time that is not competitive to that of heuristic methods. Therefore, the main contribution of our approach is 2-fold. First, we provide a very accurate algorithm with an interchangeable and customizable scoring scheme for high-quality single-case pairwise alignment. Second, we make an important step towards a general method for optimal alignment of distance matrices using combinatorial optimization, by formulating the corresponding ILP and pointing out the current challenges. A general method that generates optimal alignments will make it possible to evaluate and compare different distance matrix-based scoring schemes for structural alignment and help develop provably better scoring functions.in the graph problem. Alignments are characterized by non-crossing matches, or traces, in the complete bipartite alignment graph (V 1 V 2 ,L) (). Here, vertices in V 1 and V 2 denote the residues of the two proteins, respectively, and L is the complete set of alignment edges, i.e. L ={(i,j) | i  V 1 ,j  V 2 }. The displayed trace (bold alignment edges) maximizes the CMO, in the example there are three shared contacts (also shown in bold). (d) An aligned pair of distances. Function (,) denotes the distance between two residues with respect to their 3D coordinates.
APPROACH
Combinatorial approach to structural alignmentOur mathematical model and algorithm are based oncompute a pairwise alignment of two protein structures that maximizes the number of common contacts. Two residues are in contact if they are in some sort of chemical interaction, e.g. by hydrogen bonding. The model uses a simple distance criterion: whenever the distance between two residues is below a predefined distance threshold d t , the residues are considered to be in contact.have introduced the maximum CMO problem of finding the maximum number of common contacts in two proteins. They give an ILP formulation, which they propose to solve using an elegant Lagrangian relaxation approach. Their ILP formulation relies on a reformulation of the structural alignment problem as a graph problem.explains the relation. In their model,introduce two vectors x and y of binary variables. They consist of variables x l for each alignment edge l  L aligning two residues and variables y lm for each potentially shared common contact maintained by the two alignment edges l and m. The binary variables indicate the presence or absence of the corresponding objects in the solution. The authors express the set of feasible solutions using linear inequalities and integrality constraints involving x and y and find the largest set of common contacts using the objective function max (l,m) L 2 y lm. For the detailed mathematical model refer to. To align inter-residue distance matrices, we change the mathematical model ofby replacing the rigid contact definition and taking into account the 3D distances between the residues. Let (l,m) be a pair of aligned distances of two proteins A and B with l = (l A ,l B ) and m = (m A ,m B ), see also. By using a distance measure (,) that denotes the distance between two residues with respect to their 3D coordinates, we are now able to align inter-residue distances instead of contacts. Therefore, we replace the objective function maxPage: 2275 22732280
Towards optimal alignment of protein structure distance matrices(b)(a) Left, the upper-level DP matrix. Right, profit computation via two lower-level DP matrices, demonstrated for the upperlevel DP cell that aligns residues 3 and 2. One profit DP matrix aligns on the left, the other on the right of alignment edge (3,2). Scores of lowerlevel DP cells are given by Equation(2) and each coloured cell, and its score corresponds to a pair of inter-residue distances that is realized in the profit computation. The score of an upper-level DP cell consists of this profit (computed via the two lower level DPs) minus a sequence penalty c. (b) An alignment, denoted by black DP cells and black alignment edges, containing two gaps with gap penalty g. Choices that have been made in the lower level DPs during profit computation do not agree with the upper-level DP and are penalized by Lagrangian multipliers . Steps (a) and(b) are repeated iteratively. while keeping the constraints unchanged. In Equation (1), S(x) is a sequence score. The structural score w lm is determined by a function that assigns a value for aligning distance (l A ,m A ) with distance (l B ,m B ). Inspired by the rigid similarity introduced by Holm and Sander (1993) in their paper on dali, we chooseHere,  and t are constant parameters. As, we use Lagrangian relaxation to compute alignments, which leads to an iterative double dynamic programming (DP) algorithm, see. The algorithm can handle only positive scores effectively; therefore, we have to restrict w lm to be greater than zero. Pairs of inter-residue distances with a score w lm smaller than or equal to zero can be omitted from the ILP. The idea of Lagrangian relaxation is to relax constraints of an intractable problem, e.g. the structural alignment ILP, such that the relaxed problem can be solved efficiently. The relaxed constraints are moved to the objective function, penalized by so-called Lagrangian multipliers. The optimal solution of the original problem (i.e. the top-scoring alignment) is also a solution of the relaxed problem, and every optimal solution of the relaxed problem provides an upper bound on the optimal score of the original problem. In general, a solution of the relaxed problem is not a feasible structural alignment (cf.). Nonetheless, from a solution of the relaxed problem a feasible structural alignment can be deduced, and the score of this alignment provides a lower bound on the optimal score of the original problem. The Lagrangian multipliers are adjusted iteratively such that the upper bound decreases gradually, and we can deduce better structural alignments and thus increase the lower bound on the optimal score. If upper and lower bound coincide, an optimal structural alignment has been found. In each Lagrange iteration, we solve the relaxed problem for the current Lagrangian multipliers using double DP (cf.). In a first step, the profit of each alignment edge is computed (, right). Therefore, we determine the alignment of maximum score of those residues that are within distance threshold d t of the two residues of the respective alignment edge. These are the lower level dynamic programs, two for each pair of residues. In a second step, an alignment of the proteins based on the given profits is computed (). This is the upper-level dynamic program. The resulting DP score is an upper bound. We generate a feasible structural alignment by considering all pairs of inter-residue distances that are realized by this alignment, the corresponding score constitutes a lower bound. Analogous to contact map alignment, the time and space complexity of one Lagrange iteration of our method isare the numbers of considered distances in the two proteins, respectively.
Interchangeable scoringAny positive function that scores pairs of inter-residue distances can be used to compute scores w in (1). Examples are the scoring function used by ssap or the non-negative portion of scoring functions used by dali or matras. The number of pairs of inter-residue distances iswhere n 1 and n 2 are the lengths of the sequences. This large number currently cannot be treated explicitly even for mediumsized proteins. Therefore, algorithms that align inter-residue distance matrices resort to techniques such as aligning fragments of several residues or hierarchical alignment. In our approach, we use a distance threshold d t ; only distances smaller than the threshold are used. We hereby omit long inter-residue distances that are less significant for structural similarity than short distances. Since our scoring function assigns only positive scores, we additionally try to omit all pairs of inter-residue distances that are unlikely observed in biologically correct alignments. In our algorithm, we use scoring function (2), which takes into account that scores must be positive and that we use a distance threshold. For the interpretation of parameters, see Supplementary Material. We determine scoring function parameters for C  , C  and all-atom distances. Each type of inter-residue distance places a slightly different focus on the alignment. An alignment of C  distances is based on similar protein backbone conformations, an alignment based on C  distances takes into account side-chain placement, and an alignment of all-atom distances highlights similar residue interactions in the two proteins. Because of the different nature and range of the three inter-residue distance types, we determine individual scoring function parameters. We define our own scoring function that explores the characteristics of our algorithm. To make a first step towards aligning general distance matrices, we additionally emulate the positive portion of the scoring function used in the structural alignment algorithm matras (). Analogous to sequence
I.Wohlers et al.substitution matrices, matras uses log-odds value matrices M as scores. A value M i,j indicates the log-likelihood that distance i is aligned to distance j. Matrices are determined for 20 different sequence separations, i.e. number of residues in the sequence over which the distance ranges. A positive log-likelihood for a given sequence separation means that the corresponding distances are aligned more likely than expected by chance. We investigate how alignment accuracy and performance change when the distance threshold is varied by computing alignments based on matras scoring.
FilteringThe most effective technique to improve performance and speed of our algorithm is to keep the number of variables in our ILP low. For each variable y lm , we store its score and adapt its Lagrangian multiplier. For each alignment edge l, we compute its profit, which has to be completely recomputed in each Lagrange iteration in which at least one of the multipliers of outgoing pairs of distances has been changed (cf.). Accordingly, there are two ways of filtering: filtering pairs of distances affects the lower-level dynamic program, and filtering alignment edges the upper-level dynamic program. If we forbid an alignment edge l and, therefore, set its variable x l to zero, we never have to compute its profit, i.e. the two lower-level dynamic programs. We filter on both levels. On the upper level, we use secondary structure information. Using dssp (), we assign to each residue its secondary structure type. We determine experimentally that we can safely forbid to align -helical residues (dssp state 'H') with -sheet residues (dssp state 'E'). On the lower level, we filter in three different ways. Here, we take advantage of the non-negative scoring function and omit all pairs of distances to which a negative score would be assigned. We omit pairs of distances from which at least one distance exceeds the distance threshold d t and distances that differ more than the distance difference threshold t. Additional to these filters, we use matras log-odds values () and omit all pairs of distances with a negative log-likelihood.
Sequence scores and gap costsUsing only positive scores for pairs of distances leads to the problem that even aligning structurally dissimilar regions will increase the overall score. A poor global alignment can then yield a higher score than a shorter alignment of structurally highly conserved regions. We deal with this problem by using a global negative sequence penalty c for aligning two residues. The sequence penalty serves as a threshold on the structural score, i.e. on the profit of an alignment edge. Only if the profit exceeds this threshold, the overall score increases when the corresponding residues are aligned. To obtain a general approach for the alignment of inter-residue distance matrices, we incorporate affine gap costs with gap open penalty g and gap extension penalty 0.25 times g into the algorithm. Practically, the gap costs simply have to be considered in the upperlevel dynamic program and we do this using the Gotoh algorithm (). Formally integrating gap costs into the ILP is more involved, and we refer tofor a comprehensive analogous extension of the model in the context of RNA alignment. An optional sequence score can be added to the structural score of each alignment edge. This sequence score can be provided by any external amino acid substitution matrix. A scaling factor can be tuned in order to balance structural against sequence score. By default, sequence scores are not used.
ImplementationWe implemented the novel structural alignment algorithm as the freely available package paul within the C++ software library planet lisa (http://planet-lisa.net/). paul supports different input formats, e.g. pdb files, lists of pre-selected distances or complete distance matrices, as well as different types of interresidue distances, C  , C  and all-atom. Furthermore, also scoring function parameters, gap costs, amino acid substitution matrices and the proportion of sequence to structural score can be chosen. The use of secondary structure and log-odds for filtering is optional. By keeping the scoring adaptable, paul allows to incorporate additional information about the input proteins and makes it a very flexible software tool. By default, paul uses the optimized scoring function parameters reported in this article as well as SSE filtering. If a global alignment of two proteins is needed, we resort to tcoffee (). tcoffee computes a sequence-based alignment for those residues for which no structural similarity could be determined.
METHODS
Experimental setup for parameter setting, optimization, and evaluationTo optimize parameters, we use a training set consisting of structure-based alignments from the Homologous Structure Alignment Database (homstrad, October 2008 release) (). As these alignments are manually curated by experts, we consider them as gold standard reference alignments. From homstrad, we consider only those non-corrupt 302 protein families with exactly two members from the twilight or midnight zone of sequence identities below 35%, where sequence identity denotes the percentage of identically aligned residues in comparison to the total number of aligned residues. We optimize the parameters on a training set of 200 alignments and evaluate them on a test set that consists of the remaining 102 alignments. We measure the quality of the results computed by structural alignment algorithms in terms of the achieved alignment accuracy, which is the number of correctly aligned residues divided by the number of aligned residues in the reference alignment. We conduct an extensive parameter sweep in order to determine robust scoring function parameters that promote a high average alignment accuracy. See Supplementary Material for details. For the best overall parameter sets (d t ,, t ,,c,g) for combinations of C  , C  or all-atom distances with or without filtering, we align the homstrad test set and compare paul performance to dali, a widely used state-of-the-art structural alignment algorithm that is ranked very high in many benchmarks (). For this evaluation, we use the 99 test set protein pairs for which dali returns an alignment; this subset we call the consolidated test set.
Evaluating alignment accuracyWe use the parameters optimized on the homstrad dataset to evaluate paul on two distinct, more challenging datasets, sisy and ripc () (http://biwww.che.sbg.ac.at/RSA/). These sets contain alignments that are difficult for various reasons and were constructed to assess and compare the accuracy of structural alignment algorithms and to investigate their limitations. We compare paul to the state-of-the-art structural alignment programs dali, matras, matt, sheba, Page: 2277 22732280
Towards optimal alignment of protein structure distance matricesfatcat, ce and ca, which were benchmarked by. The sisy set is assembled from sisyphus (), a manually curated database for alignments of proteins with non-trivial relationships. It consists of 130 very diverse reference alignments for which the lengths of the protein chains and the number of aligned residues in the reference alignment vary greatly. The ripc set contains 23 reference alignments with focus on functional residues and flexible proteins. Following, we use their consolidated set of sisy and ripc, which are the subsets for which no structural alignment method in their study fails to produce a result. They contain 98 and 22 alignments, respectively. Note that paul does not fail even on the removed alignments (see also Section 5). Furthermore, two recent structural alignment methods, ProtDeform () and MaxPairs () have been evaluated on an older version of the sisy set, which we name in the following sisy.v1. For sisy.v1, the consolidated set of alignments for which no method fails comprises 106 protein pairs. In, dali, ssap, Max-Pairs, ProtDeform, matras, matt, ppm, lga, vorolign and rash have been benchmarked on sisy.v1. We evaluate paul on the consolidated sisy.v1 set and compare the results. For aligning proteins from sisy, sisy.v1 and ripc, we use a maximum run-time of 30 CPU minutes per alignment. Note that the actual run-time in which we observe improvements depends strongly on the length of the proteins and is usually much shorter (cf. Supplementaryand homstrad results). Nonetheless, to prove optimality of a solution, a conservative and rather deliberate update scheme for the Lagrangian multipliers (e.g. the one of) is needed and thus a longer overall run-time.
RESULTS
Optimized scoring function and results on HOMSTRADFor paul_matras, which uses positive matras log-odds values as structural score, a high distance threshold is beneficial, for C  distances, d t = 10  and for C  distances, d t = 10.5  (see Supplementary). Due to the high memory requirements, we currently cannot evaluate higher distance thresholds. The corresponding average alignment accuracy for C  distances lies at 88.7% and for C  distances at 88.9%. The respective average test set accuracies are 91.1% for C  and 90.4% for C  distances (cf. Supplementary). When optimizing the paul parameters of scoring function (2) we find that the average alignment accuracies on homstrad vary only slightly for different parameter values (cf. Supplementary Tables 13). Furthermore, the parameter values after optimization are robust: slightly changed parameter settings still have comparable average alignment accuracy. Using a secondary structure filter always leads to higher accuracy. When a log-odds filter is used, higher distance thresholds improve alignment accuracy. The best cross-validation accuracy on the training set after solely optimizing structural scores is 87.6% for C  , 87.4% for C  and 87.8% for all-atom distances (Supplementary Tables 13 list all values). In a second stage, we fix the best parameter set (d t , t and ) for each combination of an inter-residue type (C  , C  and all-atom) with a filter type and optimize the parameters without influence on structural scores, i.e. the sequence penalty c and the gap open penalty g. The final average alignment accuracies on the training set are in the range 89.090.2% (cf. Supplementary). The average alignment accuracies on the consolidated test set lie in the range 90.891.3% and the median alignment accuracies in the range91.993.4%. dali reaches on the consolidated test set an average accuracy of 89.0% and a median accuracy of 91.0%. We obtain the highest average training set alignment accuracy of 90.2% for C  distances with SSE filter and a parameter set) (refer to Supplementary Figs 1 and 2 for a histogram of aligned C  distances and a visualization of the scoring function, respectively). We use this setting for the evaluation on the sisy set. This is also paul's default scoring scheme.displays the accuracies of paul, dali, matras, matt, sheba, fatcat, ce and ca. paul alignments reach with 95.9% the highest median, but with 80.7% a slightly lower average alignment accuracy than matt and dali. According to Wilcoxon signed rank tests, paul matches the reference alignments significantly better than sheba, fatcat, ce and ca (P < 10 4 ). paul furthermore computed >25% of alignments (26) to provable optimality. The correlation between alignment accuracies of different methods lies mainly between 0.5 and 0.6 and is thus generally low (cf. Supplementary). paul with traditional CMO as scoring function (d t = 7.5 ) reached a median alignment accuracy of 88.5% and an average alignment accuracy of 72.1%. Because rounding can be applied for the decimal upper bound of the integer-value contact map overlap Page: 2278 22732280
Results for SISY
I.Wohlers et al.score, even 48 of the alignments were computed to optimality, i.e. almost 50%. We also test the performance of paul_matras, our algorithm with emulated positive matras scores. The results show that although using only positive scores and applying a distance threshold, paul_matras achieves accuracies competitive with those achieved by matras (cf. Supplementary), but not as high as paul using our customized scoring function. With C  distances, paul_matras reaches a higher median but a lower average alignment accuracy than matras. paul_matras with C  distances performs slightly worse according to both median and average. The correlation between paul_matras and matras alignment accuracies is not particularly high (Pearson and Spearman's correlations 0.67 and 0.73, respectively, for C  distances; 0.66 and 0.72 for C  ). The correlation between paul_matras with C  distances and paul_matras with C  distances is in contrast very high (Pearson's correlation 0.91, Spearman's correlation 0.87).
Results for SISY.V1On sisy.v1, ProtDeform () and Max-Pairs () have been evaluated and compared with dali, ssap, Max-Pairs, ProtDeform, matras, matt, ppm, lga, vorolign and rash. For this dataset, paul alignments reach with 96.3% the highest median alignment accuracy of all methods and, slightly after matt, with 82.4% the second highest average accuracy (for Max-Pairs, we compare only to the version that is solely structural and does not use blosum62 substitution scores). The box plots of alignment accuracies for each of the methods are provided in Supplementary. More than 30% (32) of the alignments were computed to optimality. Many of the methods that have been tested on this dataset perform very well and should be considered competitive in terms of alignment accuracy. paul alignments match the reference alignments significantly better than lga, vorolign and rash alignments (P < 10 4 ). The correlation between alignment accuracies achieved by different methods is, as on sisy, generally low (cf. Supplementary). Average run-times of the compared structural alignment methods vary notably, between <1 s and 24 s (cf. Supplementary, which is taken from). paul tries to compute the alignments to optimality and is terminated after 30 CPU minutes; nonetheless, often alignments do not change any more after much shorter time spans of 12 min; this is visualized in Supplementary.
RIPC setpaul reaches the highest average and median alignment accuracy of all methods tested (dali, matras, matt, sheba, fatcat, ce and ca). Box plots of alignment accuracies are given in. Four of the 22 paul alignments were computed to optimality, but only 2 of those 4 reach 100% alignment accuracy with respect to the reference alignment (cf. Supplementary). paul is furthermore unsuccessful in four cases, generating alignments with 0% alignment accuracy. All these problematic cases correspond to pairs of proteins related by circular permutation where the reference alignments also include extensive indels. This result is expected as paul was not designed to account for circular permutation. In general, the other tested methods also perform poorly on these four pairs, with the exception of ca, which allows for non-sequential alignments. There are five cases where paul), and from human on the right (d2hgsa1) (). -strands are in blue, -helices in orange. The two proteins show considerable structural variation and several indels are required to align them. The sequence identity is 16%. The five positions matched in the reference alignment are represented as ball-and-stick, the rigid body superposition of their C  atoms has an RMSD of 2.05 . paul misaligns only one position (marked with arrow), but the shift is only one residue in the sequence. The proteins are viewed in the same orientation as given by the superposition according to the reference alignment. Image prepared with Chimera (). performs better than most of the other methods in terms of alignment accuracy (d1d5fa_/d1nd7a_, d1dlia1/d1mv8a1, d1l5ba_/d1l5ea_, d1gsaa1/d2hgsa1 and d2bbma_/d4clna_). These cases correspond to pairs of proteins with extensive structural variation resulting from flexibility or from divergent evolution, Supplementary Figures 10 and 11 provide two examples. In four of these cases paul alignments have 100% accuracy, with fatcat and matras also generating highquality alignments. The fifth case (d1gsaa1/d2hgsa1) corresponds to two remote homologous proteins with considerable structural variation where the paul alignment is 80% accurate, whereas other methods achieve only 40% accuracy (cf.).
DISCUSSION AND CONCLUSIONThe results on homstrad show that our algorithm performs well with any type of inter-residue distance matrix, despite the qualitative difference between C  , C  and all-atom distances. On this test set, it reaches a higher average and median alignment accuracy than dali with all types of inter-residue distances and any type of filter. Furthermore, our optimized scoring function is robust against slight parameter changes and always performs better than CMO scoring. Introducing additionally sequence penalty and gap costs consistently increases the alignment accuracy. The sisy and ripc sets give us further insight into the alignments produced by paul. When compared to reference alignments, the alignment accuracy is very high and often better than that of other state-of-the-art structural alignment methods. This good performance of paul can be attributed to several factors. First, paul always computes alignments on single-residue level (contrary to fragments) and without using any hierarchical approach that might introduce mistakes on the first, broad level which cannot be corrected later on. Second, structural alignment methods that are based on intramolecular distances as in paul, are more adequate to compare flexible proteins or proteins with considerable structural variation Page: 2279 22732280
Towards optimal alignment of protein structure distance matricesthan methods that rely on rigid body superposition. Twists have to be introduced in the comparison of these types of proteins by rigid body superposition methods in order to accommodate for structural variation. dali and matt also perform well in these datasets as they both take into account protein flexibility in comparisons. dali relies on intramolecuar distances, and matt is a superpositionbased method that allows for different relative orientation between fragment pairs during alignment generation. When evaluating ripc results, one should be cautious, because the dataset is very small; nonetheless, the results indicate that paul compares favourably to other methods in protein pairs that are challenging for structural comparison, in particular, when these proteins show considerable structural variation or flexibility. Furthermore, in the sisy set, we find that the accuracy of paul_matras alignments, which are computed based on positive matras scores and with a distance threshold, is competitive with the accuracy obtained by matras itself. This result indicates that (i) scores for some pairs of inter-residue distances might be irrelevant for a correct alignment and (ii) that we use a very accurate algorithm to compute the structural alignment. The sisy set also contains pairwise alignments with multiple chains. These were excluded from our study because many algorithms handle multiple chains differently or cannot handle them at all. In paul, we add an option to concatenate several chains, which is reasonable if they correspond to one biological unit. Using this option, we are able to run paul also on the instances of multiple chains and obtain alignments in very good agreement with the reference alignments. Looking closer at paul alignments, we find that they still share a characteristic with alignments that have been computed with CMO scoring: the exclusively positive structural scores encourage to align even remotely structurally similar regions. The alignments tend to be longer and have higher RMSD than alignments of other structural alignment methods (cf. Supplementary). On the other hand, a high RMSD is expected when proteins are related by considerable structural variation or flexibility. In fact, RMSD does not tend to correlate with alignment accuracy as measured by comparison to reference alignments (cf. Supplementary). RMSD is a useful measure of structure similarity, but does not seem to be an adequate indicator of alignment quality. Our results give a partial answer to a question raised by: can the performance of dali be achieved using strategies based on contact maps? On the datasets of our study and with respect to alignment accuracy, the answer is that an increased distance threshold and a more sophisticated scoring function is needed. Protein structure classification will benefit from increased alignment accuracy. For classification, the scoring function can be adjusted to obtain a better accuracy to speed ratio. Furthermore, integrating fast heuristics such as, and Jain and Obermayer (2009) into exact algorithms can help to find high-scoring alignments earlier (even if proofing optimality might still be time consuming), which can render the approach competitive also in terms of speed. We show that the current algorithm is, in terms of alignment accuracy, competitive with state-of-the-art structural alignment methods. High accuracy and optimality or near-optimality of the computed alignment come at the price of a longer runtime in comparison to heuristic methods. paul is, therefore, not competitive with faster methods when performing extensive structure comparison over a database. Instead paul should be applied when there is a need for a high-quality pairwise structure alignment, where a run-time of minutes is acceptable. Our study demonstrates that using combinatorial optimization and a sophisticated scoring function, we can compute very accurate and in some cases optimal alignments. Although the current approach works well, it is only a first step towards a general ILP-based approach for optimal structural alignment of complete protein interresidue distance matrices. On the way to such a generic method, there are three major challenges. First, we have to compute more alignments to optimality. Second, an algorithm has to be developed that can effectively handle negative structural scores. Third, we need to be able to handle more or even all pairs of inter-residue distances. With a general method for the alignment of inter-residue distance matrices, we could then align proteins using various scoring schemes; for instance, those of the widely-used structural alignment algorithms dali, matras and ssap. Knowing always the top-scoring alignment, we could objectively compare structural alignment scoring schemes. Furthermore, these scoring schemes could be verifiably improved, for example, by designing combinations of different scoring functions.
The Author 2010. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oxfordjournals.org 2273 at :: on August 31, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
at :: on August 31, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
