Interpretation of electron tomograms is difficult due to the high noise levels. Thus, denoising techniques are needed to improve the signal-to-noise ratio. XMSF (Microscopy Mean Shift Filtering) is a fast, user-friendly application that succeeds in filtering noise while preserving the structures of interest. It is based on the extension to 3D of a method widely applied in other image processing fields under very different scenarios. XMSF has been tested for a variety of tomograms, showing a great potential to become a state-of-the-art filtering program in electron tomography. Applied iteratively, the algorithm yields pre-segmented volumes facilitating posterior segmentation tasks. Moreover, execution times remain low thanks to parallel computing techniques to exploit current multicore computers.
INTRODUCTIONElectron tomography (ET) has gained interest in recent years for its ability to image relatively big and heterogeneous specimens in a near-to-native state (). Low electron doses are used to reduce the radiation damage, which makes the reconstructed volumes exhibit low signal-to-noise ratios (SNR). Thus, noise reduction is essential to increase the SNR and to facilitate visual inspection, segmentation and, in the end, interpretation of volumes. Different denoising techniques have been applied with different degree of success. Gaussian filtering techniques allow fast noise reduction but tend to blur volume features, not discerning between noise and signal. Recently, iterative median filtering (van der) has emerged as a simple and nonlinear technique to filter electron tomograms, but it is not optimal under extremely noisy conditions. Bilateral filtering is an anisotropic filtering technique that has drawn some attention in this field (). It is based on adaptive Gaussian filtering that accounts for both spatial and intensity distances. Anisotropic nonlinear diffusion (AND) techniques adapt the strength and direction of the filtering to the local structure (). They are prevalent because the SNR is significantly enhanced while the important structural information is preserved. However, their computational demands are large and they have a number of parameters whose tuning is not * To whom correspondence should be addressed. trivial. For those reasons, the availability of new, fast methods that are easy to use are very welcome in ET. This work proposes to use a filtering technique based on the Mean Shift algorithm (). Mean Shift image filtering and segmentation has been previously used with success in different image and video processing areas such as photo edition, video tracking systems, etc. Here, we have extended this algorithm for the 3D case and have prepared a program for public use, XMSF (Microscopy Mean Shift Filtering). The resulting filtering program is highly intuitive and user-friendly and, moreover, yields good results under different SNR circumstances. Also, if applied iteratively, it has shown a great potential as a preliminary step for segmentation tasks.chip expected to grow rapidly in the near future, the user is expected to benefit from this feature greatly. Memory consumption is twice the size of the tomogram/image being processed.
TESTINGTo illustrate the performance of XMSF, tomograms with different noise conditions and sizes were processed. Several window sizes were also tested for both intensity and spatial distances. The spatial distances did not turn out to be very important for the visual result, with lower values yielding much faster results. A single XMSF iteration produces good results, but more can be used for presegmentation purposes.shows the results after one iteration for an experimental cryotomogram of HIV-1 virions. It can be observed how background has been effectively denoised and flattened while the important structural features remain clear and sharp. See supplementary material at the web site of the program for additional illustrative examples that include datasets prepared with different preparation techniques involving different SNR conditions. Regarding execution times,shows close-to-linear speed-ups for different tomogram sizes up to eight cores (processors). In order to carry out an objective assessment, we chose the HIV-1 tomogram and applied XMSF and different standard techniques: iterative median, bilateral (both implemented in http://bsoft.ws) and AND (). We then computed the SNR for the different results, with the SNR defined as (I s I b )/ b , where I s and I b denote the average intensity in the structure of interest and in the background, respectively, and  b is the standard deviation of the background. The background was defined by thresholding the filtered tomogram, followed by morphological operations.shows that XMSF outperforms the median and bilateral filtering in terms of performance and execution time. Though AND is superior, it requires much more time and memory consumption (eight copies of the volume).
CONCLUSIONXMSF has a great potential of application in ET. It has shown to deal well with disadvantageous noisy conditions present in electron tomograms while preserving important structural features. The parallel implementation of the algorithm allows a nearly linear speed-up in multicore machines, providing fast results at a reduced cost. In terms of execution time and image quality, XMSF outperforms other standard methods in many applications. XMSF has the additional advantage of its ability to perform presegmentation of complex tomograms, which is essential in this field.
DESCRIPTION XMSF is a portable, command-line application written in C++. It is distributed as a stand-alone application and, due to its good performance, it has also been fully integrated in the EM image processing package Xmipp (Sorzano et al., 2004). It can be used to process both 2D (images) and 3D (volumes) datasets. Conceptually, the application works as follows (Fig. 1). For each pixel/voxel ('origin') the centroid of its neighbours is calculated. The new centroid is only calculated taking into account those voxels/pixels falling within a certain spatial distance and within a certain intensity (i.e. density) distance. Then, the new 'origin' is that pixel/voxel corresponding to the calculated centroid. This process is repeated iteratively until the 'origin' does not change. This last 'origin' is the so-called 'mode' for the first 'origin', whose intensity value is set to that of the last 'origin'. Mean-shift filtering is closely related to bilateral filtering but outperforms it thanks to the use of different data during the mean-shift iterations through the adaptive movements of the kernel (Song et al., 2006). There are two possible implementations available in XMSF. First, the centroids are calculated using Gaussian kernels (one for pixels/voxels distance and the other for intensity distance) centered on the 'origins'. This is, in principle, a slower but more accurate process. Second, an alternative and simpler implementation replaces Gaussian kernels with uniform ones (i.e. based on simple sums of the pixels/voxels in the kernel window), leading to equally good results and a much faster execution. The user should provide two main parameters (although default values are provided otherwise), the width of both the spatial and intensity windows or the equivalent Gaussian kernels bandwidths. These parameters are easy to be tuned. Low spatial distances, in the range 510 pixels/voxels, are normally used. For the density distance, the standard deviation computed from the whole dataset normally yields good results. Due to its iterative nature and the high number of pixels/voxels to be processed, a parallel implementation has been developed to reduce execution times, specially high for big volumes. For user simplicity and compatibility, POSIX threads, which are available for any Unix/Linux OS, have been used (Bilbao-Castro et al., 2009). With the number of cores in a single
at :: on August 31, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
3 Bilateral (bsoft) 2.7 59.2 1 1 AND (tomoand) 3.9 387.2 1 40 XMSF 3.4 5.7 8 1 When available (XMSF), parallel executions have been performed and those are the shown times (with eight cores). Conflict of Interest: none declared.
