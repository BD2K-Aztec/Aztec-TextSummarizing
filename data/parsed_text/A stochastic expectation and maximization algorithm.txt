Motivation: Most biological traits may be correlated with the underlying gene expression patterns that are partially determined by DNA sequence variation. The correlations between gene expressions and quantitative traits are essential for understanding the functions of genes and dissecting gene regulatory networks. Results: In the present study, we adopted a novel statistical method, called the stochastic expectation and maximization (SEM) algorithm, to analyze the associations between gene expression levels and quantitative trait values and identify genetic loci controlling the gene expression variations. In the first step, gene expression levels measured from microarray experiments were assigned to two different clusters based on the strengths of their association with the phenotypes of a quantitative trait under investigation. In the second step, genes associated with the trait were mapped to genetic loci of the genome. Because gene expressions are quantitative, the genetic loci controlling the expression traits are called expression quantitative trait loci. We applied the same SEM algorithm to a real dataset collected from a barley genetic experiment with both quantitative traits and gene expression traits. For the first time, we identified genes associated with eight agronomy traits of barley. These genes were then mapped to seven chromosomes of the barley genome. The SEM algorithm and the result of the barley data analysis are useful to scientists in the areas of bioinformatics and plant breeding. Availability and implementation: The R program for the SEM algorithm can be downloaded from our website: http://www.statgen.
INTRODUCTIONDifferential expression analysis often applies to discrete phenotypes (primarily dichotomous phenotypes). The phenotype is often defined as 'normal' or 'affected'. If a phenotype is measured quantitatively, it is often converted into two or a few discrete ordered phenotype so that a differential expression analysis or an analysis of variances (ANOVA) method can be applied (). It is obvious that such * To whom correspondence should be addressed. discretization is subject to information loss. The current microarray data analysis technique has not been able to efficiently analyze the association of gene expression with a continuous phenotype (). Pearson correlation between gene expression and a quantitative trait has been proposed ().ranked genes according to the correlation coefficients of gene expression with MMSE, a quantitative measurement of the severity of Alzheimer's disease (AD), and detected many genes that are associated with AD.used a within family correlation analysis to remove the effect of family stratification. Pearson correlation is intuitive and easy to calculate. However, it may not be optimal because (i) the correlation coefficient may not be the best indicator of the association; (ii) higher order association cannot be detected; (iii) data are analyzed individually with one gene at a time; and (iv) the method cannot be extended to association of gene expression with multiple continuous phenotypes.investigated the association of gene expression with six malting quality phenotypes (quantitative traits) of 10 barley cultivars. They compared the distance matrix of each gene expression among the 10 cultivars with the distance matrix calculated from the phenotypes of all six traits using the G-test statistic. The G-test statistic was designed to measure the similarity between two matrices. For each gene, there is a distance matrix (based on the expression levels). For the phenotypes of six traits, there is another distance matrix. The two matrices are compared for the similarity. If the similarity is high, the gene is associated with all the six phenotypes. Eventually, the associations of the phenotypes with all the genes are evaluated. The distance matrix comparison approach may have the same flaws as the correlation analysis. Recently, we proposed to use the regression coefficient of the expression on a continuous phenotype as the indicator of the strength of association (). Instead of analyzing one gene at a time, we took a model-based clustering approach to studying all genes simultaneously.extended the model-based clustering algorithm to capture genes having higher order association with the phenotype. The model-based clustering analysis () classifies genes into several clusters and all clusters share the same variancecovariance structure. The analysis is implemented via the expectationmaximization (EM) algorithm (). Several problems have been encountered for this method. One is the identifiability problem where the cluster labels can be exchanged among different clusters. The other problem occurs when two or more clusters often have the same cluster mean. These two problems can be avoided by introducingPage: 64 6369
H.Zhan et al.a small noise to the cluster means in every iterative step of the EM algorithm (). This ad hoc modification of the EM algorithm lacks strong theoretical foundation and cannot guarantee to produce the optimal result. In this study, we proposed an alternative method with a rigorous theoretical basis to solve the problem. We used this new method to detect expressed genes that are associated with multiple quantitative traits of barley. The gene expression levels are quantitative traits (). Finding the genetic loci controlling the expressions can help identify gene regulation networks (). Traitspecific gene networks can be inferred by studying the genetic loci controlling the expressed genes only associated with the trait under investigation. In this study, we focus on a new method called the stochastic expectation and maximization (SEM) algorithm () and its application to both expression quantitative trait locus mapping (eQTL) mapping and phenotype-associated microarray data analysis. This new method is then compared with the existing EM algorithm () to demonstrate its superiority. A real dataset collected in the North American Barley Genome Project (NABGP) is used for the demonstration.
MATERIALS AND METHODS
Experimental dataThe gene expression data were published byand downloadable from the ArrayExpress: http://www.ebi.ac.uk/microarray-as/ aer/entry with accession number: E-TABM-112. The phenotypic values of eight quantitative traits of barley were published byand downloadable from the following website: http://wheat.pw.usda.gov/ ggpages/SxM/phenotypes.html. Detailed description of the experiment can be found from the original study (). The experiment involved 150 double haploid (DH) lines derived from the cross of two spring barley varieties, Morex and Steptoe. All the 150 DH lines were microarrayed for 22 840 transcripts. The eight traits are -amylase, diastatic power, grain protein, grain yield, heading date, plant height, lodging and malt extract. The phenotypes of the traits were measured in different environments (locations and years). The number of replicated measurements ranged from 6 to 16 depending on different traits. Both the single trait association and multiple trait joint association analyses were conducted for all the eight traits using the average trait values across all environments. The original (raw) microarray data were normalized using the RMA algorithm () implemented in the GeneSpring GX 11 software package (Agilent Technologies, Santa Clara, CA, USA). ArrayExpress also provides the preprocessed dataset without log transformation. The phenotypic values of each trait were rescaled so that the range of each trait is between-1 and +1. The formula for the rescaling iswhere X k is the original phenotypic value for the kth line, X min and X max are the minimum and maximum values of the phenotypic value, respectively, and Z k is the rescaled phenotypic value for k = 1,...,n, where n is the sample size (number of DH lines).
Linear modelDenote the microarray data by a data matrix Y with n rows and m columns, where n is the number of individuals subject to the microarray analysis and m is the number of microarrayed genes. Let y j be the jth column of matrix Y, i.e. an n1 vector for the expression levels of gene j for all the n subjects (j = 1,...,m). Let Z be an nq matrix for the rescaled phenotypic values of q quantitative traits measured from all n individuals. Let X be a np matrix for some factors not directly relevant to the quantitative traits, for example, gender effect, age effect and so on. We now have three sources of data (i) Y the microarray data, (ii) Z the phenotypic data and (iii) X the cofactors not directly relevant to the association study. The cofactors are not something of interest themselves, but may affect the gene expressions. They are included in the model to reduce or eliminate the interference on the association between Y and Z. The expressed levels of gene j can be expressed using the following linear model,where  j is a p1 vector for the effects of cofactors,  j is a q1 vector for the regression coefficients of gene j on all the q traits. The residual error  j is an n1 vector with an assumed N(0,I 2 ) distribution. This assumption is very common in the linear model analysis. The DH plants are indeed independent samples from the line cross of the barley experiment. In the special case of one phenotype with no cofactors, p = q = 1 and X is a vector of unity with a dimensionality of n1. We now assign prior distributions to the parameters included in the linear model. The prior distribution for  j iswhere   is a p1 vector of mean and  is an unknown pp positive definite variance matrix. The prior distribution of  j is a Gaussian mixture with two components,In the above Gaussian mixture, 0 = I q is a known diagonal matrix with a common  = 10 8 across all the diagonal elements. In other words, 0 is a known positive definite matrix with values close to zero and the value can be changed according to the investigator's preference. For the other cluster, 1 is an unknown positive definite variance matrix. This Gaussian mixture prior divides all the genes into two clusters, one (cluster 1) being associated with the phenotypes and the other (cluster 0) not associated with the phenotype. Variable  (0 <<1) is a prior probability that a gene randomly selected from the pool belongs to cluster 1. A gene classified into cluster one is claimed to be associated with the traits while genes classified into cluster zero are not associated with the traits. The actual parameters involved in the problem are denoted byWe are also interested in  j , the posterior probability of gene j being associated with the traits. The relationship between the posterior  j and the prior  will be presented later.), for 0 < j < 1, be an indicator variable for the cluster membership of gene j. It is defined as  j = 1 if j belongs to cluster 1 0 if j belongs to cluster 0Given  j , the genetic effect  j has the following distribution,Note that this conditional distribution is not a Gaussian mixture because the membership is already known. The indicator variable  j tells which Gaussian component  j belongs to. Also note that the parameter vector does not include  j and  j. Under the random model framework,  j and  j are treated as missing values. If they are integrated out, the density of y j given the cluster membership is normal with mean and variance shown in the following normal density p(y j |, j ) = N Page: 65 6369
SEM algorithm for detecting quantitative trait-associated geneslikelihood function for the entire dataset isThe MLE of parameters are obtained through a two-step approach. The first step is to estimate the parameters by maximizing the above log likelihood function given  =  j through the regular expectation-maximization (EM) algorithm (). This step is called the EM step. The second step is to stochastically simulate  =  j from its conditional posterior distribution. This step is called the stochastic step. The two steps are repeated iteratively until a stationary distribution is reached for each parameter, an algorithm called the stochastic expectation and maximization (SEM) algorithm (). The stochastic step and the EM step are performed sequentially, not in parallel.
Stochastic samplingThe density of y j defined in Equation (8) can be split into the following two densities,The posterior probability that  j = 1 isBecause  j is a Bernoulli variable, it is sampled fromdistribution. Once  =  j are sampled for all genes in the stochastic process, we can proceed with the EM algorithm described below.
EM algorithmThe EM algorithm for the Gaussian mixture model is standard () and thus we only provide the EM steps without proof. Denote the variance covariance matrix of  j conditional on  j byLet us defineWe now provide the formulas for updating each parameter using the EM algorithm. Given  j , the updated proportion of genes coming from cluster 1 isThe population mean   is updated usingThe variance-covariance matrix of  j is denoted by  and updated usingGiven  j , the unknown variancecovariance matrix of  j is j =  j 1 + (1   j ) 0. However, the corresponding matrix 0 is a constant. Therefore, we only need to update 1 using all  j that come from cluster one. The updated equation for 1 isThe residual error variance is updated usingThe E-step of the EM algorithm consists of calculatingE(. So far all parameter have been updated. We can now combine the stochastic steps with the EM steps to compete the analysis. Note again that the stochastic and EM steps are performed sequentially and repeated many times until a stationary distribution for each parameter is reached.
SEM estimateThe SEM algorithm differs from the classical EM algorithm in that the parameters do not converge to some fixed values; rather, they converge to a stationary distribution due to the stochastic process of  =  j . We can monitor the converging process for each parameter. Once all parameters have converged, we start to collect the posterior sample for . Unlike the posterior sample for the fully Bayesian analysis, the observations with the posterior sample for the SEM algorithm are not correlated. The posterior sample size, denoted by T , does not have to be large; T = 100 seems to bebe the t-th observation in the posterior sample (after convergence), the estimate parameter vector of the SEM algorithm isThe most important quantity of the SEM analysis is not the entire vector of ; rather, it isthat is most important because it represents the posterior probability that gene j belongs to cluster 1, i.e. gene j is associated with the quantitative traits. Thes  j 's are ranked in a descending order. The top proportion of genes is selected as candidate genes associated with the phenotypes. The proportion is defined by the investigator in an arbitrary manner. Some objective criteria, e.g. false discovery rate (FDR), may be used, but it is not the focus of this study. Here, we simply chose an arbitrary cut-off value of  j  0.9 to declare significant association.
Expression quantitative trait locus mappingThe gene expression levels can be treated as quantitative traits and QTL mapping can be performed on each transcript, so-called eQTL mapping (). The problem with the eQTL analysis is that the large number of expression traits make eQTL mapping very difficult. The SEM algorithm developed for the quantitative trait-associated microarray data analysis can be extended to eQTL mapping with limited modification. This section describes the application of the SEM algorithm to eQTL mapping. Consider Q markers with known map positions and the genotypes for all the n individuals. We will study the association of all the m transcripts simultaneously with the k-th marker for k = 1,...,Q. The approach is similar to the interval mapping in which one marker is studied at a time (Page: 66 6369
H.Zhan et al.Botstein, 1989). The entire eQTL mapping will take Q separate analyses. Using the same model as given inEquation (2), we now replace the phenotype Z by the numerically coded genotype of marker k denoted by Z k so thatwhere  jk is the QTL effect for transcript j at marker k. The Z k variable is defined aswhere A 1 A 1 is first genotype and A 1 A 1 is the second genotype of marker k. The barley population under study is a doubled haploid population and thus only two genotypes exist for each locus. We now have to analyze the data Q times, one for each marker. Previously, we have a single  for the proportion of genes associated with the phenotype. We now have Q such's to indicate the proportions of transcripts associated with all markers, denoted by a vectorIn addition, the posterior probability of gene j associated with marker k is denoted by  jk. These parameters  k , jk are important to the eQTL mapping. The SEM algorithm remains the same as before except that we must analyze the data Q times (one for each marker).
RESULTS
Single trait associationSince each trait was measured from multiple environments, we took the average of the phenotypic values across the environments as the phenotypic values that entered the linear model for analysis. Therefore, the Z matrix for each trait analysis was an n  1 = 150  1 vector for the average phenotypic values (rescaled between 1 and +1). The number of transcripts (genes) measured in the experiment was m = 22 840. Since no other cofactor existed except the intercept,  j is a scalar with dimension p = 1. For the single trait analysis, q = 1 for each trait analysis. Each of the five parameters,  is of single dimension.Both the (two-cluster) SEM algorithm developed here and the three-cluster EM algorithm ofwere used for the single trait association study. The EM algorithm of Jia and Xu (2005) classified each gene into one of three clusters. The three clusters shared a common variance of the regression coefficient but with three different means. The three cluster means were restricted with negative value for the first cluster, zero for the second cluster and positive value for the third cluster. Genes classified into either the first or the third cluster are differentially expressed genes. The criterion of detection for each gene was that the posterior probability of being in cluster 2 (the neutral cluster) was less than 0.1. This is equivalent to the criterion of  j  0.9 in the SEM analysis. The numbers of genes associated with each of the eight traits are listed infor the SEM and the EM algorithms. We can see that the SEM algorithm consistently detected more genes than the EM algorithm. The result of the SEM algorithm shows that more genes are associated with the height and grain protein than other traits. The heading date trait has the least number of associated genes. The estimated parameters for all the eight traits obtained from the separate SEM analyses are listed in Supplementary Table S1. Lists of all the detected genes associated with the traits and gene annotations are given in Supplementary Table S2 (Sheet1Sheet8) for interested readers.In order to compare the performance of the SEM model and the EM model, we carried out a simulation experiment based on the SEM model by using the estimated parameters obtained from the barley data (grain yield) analysis. The ROC curve () shows that both the SEM and the EM models have high sensitivity and specificity, but the SEM model performs better and has higher sensitivity. It is well known that the EM algorithm tends to converge to some sub-optimal values which are close to the initial values. We set different parameters and simulated several datasets based on the EM model to test the convergence of parameters. When parameters are precisely estimated, the EM model is able to identify most of the associated genes. If parameters converge to some local optimal values that are different from the true values, the sensitivity is quite low. However, the SEM model can identify most associated genes in both cases and has high sensitivity and specificity, which are similar to the EM results when parameters were estimated well. We also performed permutation for the real data analysis by permuting the phenotypes (grain yield) to test the specificity of the two methods. After 100 permutations by the grain yield, we took average of the posterior probabilities generated from the 100 permutations for each gene and we found that no gene had probabilities exceeding the cutoff point (0.9), which indicates that the SEM method also has good specificity in real data analysis. We choose the grain yield as an example to demonstrate the converging process of the estimated parameters. The trace plots (parameters against the iteration) are depicted inforPage: 67 6369all the five parameters and the regression coefficient of gene AF250937_s_at. From the trace plots, we can see that all parameters have converged in about 10 iterations. After the parameters converged to their stationary distributions, the parameters fluctuated around the mean values and the means are the SEM estimates of the parameters. We also presented the predicted regression coefficients obtained with the SEM analysis and the scatter plots of the observed genes expressions for the genes associated with each trait (Supplementary). Some genes have positive associations with the traits, e.g. AF250937_s_at and Contig6445_at, and some have negative associations with the traits, e.g. Contig23592_at and Contig3295_at.
SEM algorithm for detecting quantitative trait-associated genes
Multiple traits association studyFor the joint association study of eight traits, the dimensionality of the parameters increased to p = 8 and q = 8. Therefore,   is an 81 vector,  is a 88 matrix and 1 is an 88 matrix. The rest of the parameters,  and  2 , remain scalars. The Z matrix is an 1508 matrix for all the eight traits measured from all the 150 DH lines. Only the SEM algorithm was used in this analysis because the EM algorithm of Jia and Xu (2005) cannot be applied to multiple trait association study. Using the same criterion of  j  0.9 to declare significance association, we detected a total of 1646 genes that are jointly associated with the eight traits, accounting for 7.2% of all the 22 840 genes included in the analysis. The list of associated genes is given in the supplemental data (SupplementaryNote that the proportion of genes detected (7.2%) in the experiment is not the same asas as = 8.9% because the former depends on the cut-off point ( j  0.9) used for gene declaration, whereas the latter represents the probability that a randomly selected gene belongs to the associated cluster and it does not depend on the cut-off point. In the simulation study, we used parameters estimated from the barley data to simulate 5000 genes (100 individuals) based on the SEM model. The SEM algorithm identified all associated genes, which indicated that SEM does have high sensitivity and specificity. By randomly permuting the eight traits, we tested the specificity of SEM in real data analysis. Among the total of 22 840 genes, 521 genes still had significant effects in the permuted data. The false positive is 521/22 840 = 0.022 811, reasonably low. Interestingly, all genes associated with the 8 traits in the single trait analysis were also detected in the joint analysis, demonstrating the high efficiency of the joint analysis. The estimated regression coefficients for the top ten genes jointly associated with all traits are listed inalong with the F-test statistics and the P-values. The F-test statistic was calculated usingFwhere,The P-value was calculated usingwhere F 8, (x) is the cumulative distribution function of the central F distribution with numerator degree of freedom q = 8 and the denominator degree of freedom .
eQTL mappingThe purpose of the eQTL mapping is to identify the locations of the genome that control the expressions of the transcripts. We used the results of the previous analysis to reduce the number of transcripts for the eQTL analysis. For example, out of the 22 840 transcripts, we identified 888 genes that are associated with the grain protein trait. The eQTL mapping was then targeted to these 888 transcripts. This has dramatically reduced the number of transcripts for eQTL mapping related to the grain protein trait. Recall thatgives the number of transcripts associated with each of the eight traits. The eQTL mapping for each trait was only conducted on the identified transcripts. The barley genome contains seven chromosomes. The total number of SNP markers investigated was Q = 495 with an Page: 68 6369h shows the plots of the remaining four traits. Here, we used grain protein and yield traits as examples to describe the plots. For the grain protein trait, three chromosomes (2, 3, 5) seem to control more genes than other chromosomes. For example, the central region of chromosome 2 contains almost 50% of the 888 transcripts. This region is considered as a hot spot. For the yield trait, chromosome 3 is the only one containing more transcripts. The hot spot is located in the middle of the chromosome and it controls the expression of about 80% of the 457 transcripts. Other information about this eQTL analysis is provided in Supplementary Table S4 (Sheet1Sheet8) and Supplementary(Sheet1Sheet8). The additional information includes the eQTL effects for each transcript across the genome (Supplementary). The posterior probability of each transcript associated with each marker (Supplementary). The supplementary tables can serve as a reference database for barley biologists to further study the gene networks for the eight quantitative traits.
H.Zhan et al.
DISCUSSIONWe adopted a new statistical method (SEM) for quantitative trait associated microarray data analysis. We used the method to analyze 22 840 microarrayed genes associated with eight quantitative traits in barley. Many genes have been identified to be associated with these traits. The actual functions of these genes in barley are not known prior to this study. These genes are provided in Supplementary Table S2 (Sheet1Sheet8) and Supplementary. For example, among the 22 840 genes, 888 are related to grain protein content. This dataset provides much information for barley biologists to further study these genes. The functions of some genes are known in rice. For example, according to BLASTX results, transcript 22 767 (rbah35f01_s_at) is the code for the Cyclopropane-fatty-acyl-phospholipid synthase in rice. This gene is strongly associated to the grain protein in barley, with an F-test statistic of 1436.718 and a P-value of zero. The same SEM algorithm for phenotype associated microarray data analysis has been applied to eQTL mapping with virtually no modification. The eQTL mapping conducted was still an interval mapping approach where one marker is analyzed at a time. However, all the transcripts were analyzed simultaneously. This is already a significant improvement over the traditional interval mapping for QTL where one transcript was analyzed at a time (). Results of the eQTL analysis are provided in Supplementary Table S4 (Sheet1Sheet8) and Supplementary(Sheet1Sheet8). This dataset will help barley biologists to infer gene networks for these quantitative traits. Transcripts simultaneously associated with one marker belong to the same network (or pathway) because they are all controlled by the segregation of the same locus. For example, marker ABC152D (83.1 cM) on chromosome 2 controls the expression of about 50% of the transcripts associated with the grain protein. These transcripts are allegedly to be in the same pathway for the development of grain protein. Theoretically, the method can analyze all markers simultaneously using a single model. This is the all-transcript-and-all-marker model. Practically, however, it is difficult to handle the large matrix with a dimensionality repeatedly in the SEM algorithm. The theory is identical to the joint analysis of all the eight traits (a matrix). Further study on this simultaneous analysis is needed for the SEM algorithm. The MCMC implemented Bayesian eQTL mapping () can be adopted here, but it is a sampling based method and is time consuming in terms of computing time. This study focused on the SEM algorithm for phenotype associated microarray analysis with the eQTL mapping as an example of extension to other problems. Finally, the data were analyzed using an R program, which can be downloaded from our laboratory website (www.statgen.ucr.edu) under the 'Phenotype Associated Microarray' section. A sample dataset (subset of the barley data) is also provided in the website for interested users to test the method. Users may customize the code to analyze their own data using the SEM algorithm.
at :: on August 31, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
y j |X  ,X  X T +Z j Z T +I 2 (8) where j =  j 1 +(1 j ) 0 (9) and the notation N {y|a,b} stands for the normal density of variable y with mean a and variance b. Given the cluster membership, =  j , the log
