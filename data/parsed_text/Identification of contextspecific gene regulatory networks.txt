Motivation: Gene regulatory networks, in which edges between nodes describe interactions between transcriptional regulators and their target genes, determine the coordinated spatiotemporal expression of genes. Especially in higher organisms, context-specific combinatorial regulation by transcription factors (TFs) is believed to determine cellular states and fates. TF–target gene interactions can be studied using high-throughput techniques such as ChIP-chip or ChIP-Seq. These experiments are time and cost intensive, and further limited by, for instance, availability of high affinity TF antibodies. Hence, there is a practical need for methods that can predict TF–TF and TF–target gene interactions in silico, i.e. from gene expression and DNA sequence data alone. We propose GEMULA, a novel approach based on linear models to predict TF–gene expression associations and TF–TF interactions from experimental data. GEMULA is based on linear models, fast and considers a wide range of biologically plausible models that describe gene expression data as a function of predicted TF binding to gene promoters. Results: We show that models inferred with GEMULA are able to explain roughly 70% of the observed variation in gene expression in the yeast heat shock response. The functional relevance of the inferred TF–TF interactions in these models are validated by different sources of independent experimental evidence. We also have applied GEMULA to an in vitro model of neuronal outgrowth. Our findings confirm existing knowledge on gene regulatory interactions underlying neuronal outgrowth, but importantly also generate new insights into the temporal dynamics of this gene regulatory network that can now be addressed experimentally. Availability: The GEMULA R-package is available from http://www.few.vu.nl/~degunst/gemula_1.0.tar.gz.
INTRODUCTIONCell-type-and condition-specific interactions between transcriptional regulators and their target genes are a primary mechanism * To whom correspondence should be addressed.for cells to accomplish spatiotemporal changes in gene expression. Identification of such interactions is an important step in modeling transcriptional regulatory networks. Regression methods are valuable tools that can be used to address three important issues in gene regulatory network building. First, they allow identification of transcription factors (TFs) and synergistic interactions between TFs that determine observed variation in gene expression. When two TFs commonly regulate a set of target genes, the synergistic effect of the TFs on target gene expression may not be just simply the sum of the individual effects. By fitting regression models that contain interaction terms that represent synergy between TFs, and comparing these to simpler models without such interactions, regulatory interactions between TFs can be inferred. Second, regression models provide answers to the question of how much of the observed variation in a single gene expression condition of interest can be predicted or explained based on regulatory motifs occurring in gene promoters. Since transcriptional gene regulation is time dependent, it is of interest to get some quantitative measure of how much of the observed variation in a specific biological context can be attributed to TF activity. Finally, regression models can provide insight into spatially and temporally dynamic interactions between TFs and target genes by comparing models inferred from the sets of genes regulated at successive time-points and/or under different experimental conditions. Pioneering work on constructing linear regression models for gene expression analysis was performed bysubsequently suggested a non-parametric regression approach that uses Multivariate Adaptive Regression Splines. They demonstrated the importance of generating and selecting among competing candidate models in a systematic way in order to model interactions between synergistic TFs. Model selection, however, is a major challenge in gene expression analysis given the large number of potential model terms. When interactions between predictors are considered, the number of possible candidate predictor terms p is relatively large compared with the sample size n (typically p  n or even p > n). To select and fit models that appropriately trade-off bias and variance and that do not suffer from substantial overfit is not easy in this context. If we assume that only a small subset of the candidate predictors s << p is really associated to the response of interest, we can restrict ourselves to sparse models by considering penalized regression methods such as the lasso. Statistical methods that generate sparse models have already successfully been appliedPage: 215 214221
Gene expression modeling using LAssoin related but different contexts. For instance,used the graphical lasso to infer regulatory relationships from multifactorial perturbations, andcompared different regularization methods for estimating large-scale gene association networks modeled using graphical Gaussian models. In this article, we present a new approach to identify networks of TFtarget gene and TFTF interactions that underlie variation in gene expression instead of genegene association or perturbation networks. We propose GEMULA, a method based on linear models that is fast, and considers a wide range of biologically plausible models. GEMULA is a four-stage method based on the lasso () and post hoc re-sampling () that can be used to identify and prioritize synergistic interactions between predictors that underlie observed variation in gene expression. On yeast data, we compare models inferred by GEMULA and MARS with different predictors by evaluating the amount of variation that can be explained across genes. Moreover, we demonstrate that prioritization identifies biologically important TFTF interactions that are supported by independent sources of experimental evidence. Next, we analyzed a time course dataset of cultured neuronal cells profiled at several time-points following induction of axon growth. This identifies context-specific gene regulatory networks within the complexity of the mammalian genome. We confirm existing relationships between TFs and growth-associated gene expression, and we generate new insights into the temporal dynamics of the regulatory network underlying axon growth.contains a flowchart for GEMULA. DNA promoter sequences and gene expression for a set of n genes are assumed to be given, together with a collection of p TF binding motifs. Prior to model building, we generate X 1 ,...,X p , where X ij represents the in silico predicted affinity of TF j to bind the promoter of gene i. We then use penalized regression to fit and evaluate models that relate the observed variation in gene expression to predicted binding of TFs. These models may include interaction terms to represent the combinatorial effect of TFs on expression. An additional feature of our method is the implementation of a stability selection procedure to prioritize terms in the fitted models according to relevance. Fitted models typically contain many terms and this allows a principled selection of the most relevant terms. Below, we describe the regression model, model selection and prioritization steps in detail.
MODEL
GEMULA
The regression modelbe a response variable, that represents some gene expression response of interest for a set of n genes, and X 1 ,...,X p , all vectors of length n, a set of p predictor variables. We assume that Y and X 1 ,...,X p are related through the following regression model, is an unknown n(d +1) design matrix with columns, for j = 1,...,d and polynomial functions f 1 ,...,f d , = ( 0 ,.
.., d) is an unknown vector of regression parameters and = ( 1 ,...,, n )  N (0, 2 I n ). GEMULA evaluates and compares many different candidate regression models M with Y as response and different subsets of the predictor variables. We identify different models M by their corresponding design matrices X M , wherepolynomial functions. Hence, M consists of d M candidate terms, which are polynomial functions of the input predictor variables. We let M 0 denote the model with design matrix. Given Y and X M , GEMULA repeatedly uses the lasso () to select the predictors in model M and to estimate  M. For t  R + , the lasso estimate of  M is determined by min(2) We use lars () repeatedly to solve the different penalized least squares regression problems. The parameter t  R + indexes the entire lasso path. The lars algorithm proceeds in steps, indexed by k, for k = 0,...,K, where K is the number of steps needed in order to reach the unpenalized ordinary least squares solution from the intercept-only model, which roughly equals p. We identify the lasso solution at step k bySby byS M (t k ). We denote the entire path by) denote the estimate of  M corresponding to the lasso solution at step k,
G.Geeven et al.(), we use the AIC c criterion when we apply GEMULA to analyze real gene expression data. Let AIC c) denote this criterion, forSfor forS M (t k )  S M. ThenIt was shown bythat the optimal model in S M according to the selection criterion can be found by minimizing (3) over all t k , k = 0,...,K and therefore we let).
Stages of GEMULAGEMULA is composed of four stages, i.e. a predictor pre-selection stage, a candidate model generation stage, a model evaluation stage and a stability selection stage. Although the lasso performs predictor selection, we do a pre-selection in Stage I to control computational complexity, as the number of candidate model terms grows superexponentially as a function of the number of predictors.GEMULAStage I: in Stage I, GEMULA determines the order in which the input predictors may enter the candidate models by applying the lars algorithm to M 0. Since at each step k of the algorithm, the index of exactly one predictor enters the set B k M 0 , GEMULA uses the mapping r(j) = min {k :}, j {1,...,p}, and its inverse r 1 defined by,...,p},s {1,...,K} to define the order number s for the predictor X j .GEMULAStage II: in Stage II, GEMULA uses the lasso to generate candidate models confined to Q different candidate model subspaces. The different model subspaces are identified by 3D parameters, for q = 1,...,Q, where  q1 represents the maximum allowed order of interactions between terms in the models,  q2 the maximum power to which candidate predictors are raised in candidate terms and  q3 represents the maximum number of candidate terms allowed in the model. The complete collection of models that are considered by GEMULA is,150) and  3 = (1,1,150), thenFor each matrix X  q , GEMULA fits the entire path of lasso solutions S  q and selects the optimal lasso-AIC shrinkage parameter,500) and  4 = (2,2,500) and in Section 3.2 we used,500) for the early responsive genes and  1 = (1,1,700),,700) for the late responsive genes (which is a bigger set).
GEMULAStage III: in StageIII, GEMULA uses cross-validation to evaluate the fit of the Q candidate models. As goodness-offit measure, we use the R 2 statistic, because it has an intuitive interpretation that is of interest also biologically. Recall that for a candidate model M q and corresponding fitted response valuesYvalues valuesY M q , the R 2 is given byFor comparison, we always use the same data splits to cross-validate the different candidate models and we used 5-fold cross-validation throughout. For each model q, in Stages I and II, all n observations are used to select and fit the candidate model. In Stage III, we randomly partition the observations into five mutually disjunct sets of (almost) equal size and quote R 2 (M q )'s averaged over these five validation sets as  R 2 cv , where for each set th Y M q 's are determined by re-estimating the parameters on data with the observations from the corresponding validation set left out. GEMULAStage IV : we give a brief outline of the method of Meinshausen and Bhlmann (2010) that we implemented to assess the significance of terms in candidate models generated by GEMULA. Let a model M with candidate model predictors Z 1 ,...,Z d M , generated by GEMULA in the first two stages, be given. The lasso produces the estimat, but provides no formal inference. The stability selection procedure is based on resampling and allows us to compute 'selection probabilities' for the candidate predictors. We iteratively resample for b = 1,...,B, uniformly at random, subsets of {1,...,n} of size, and recompute the regularization paths and corresponding coefficients on the subsample. For t  R + , letlet let tb) denote the lasso solution obtained in iteration b.Then, for each candidate predictor j, its selection probability can be computed as the proportionproportion proportion t j of the B iterations in which thePage: 217 214221
Gene expression modeling using LAssocoefficient of Z j does not equal zero:For any t  R + , th  t j given by (4) define a ranking of the variables according to selection probability. We use the selection probabilities to prioritize the predictor terms in models generated by GEMULA, for a fixed t = k AIC c M
.
Multivariate-responses:the univariate model presented above, does not quantify explained variation across experiments. For general applicability, we suggest an extension to the case where gene expression is obtained under a set of k different conditions and Y ij represents the expression of gene i in condition k. We equip GEMULA with a feature extraction procedure based on principal component analysis (PCA). This allows for the extraction of strong signals across experiments [which may be modeled using a common set of predictors, see e.g. ()] without having to deal with a mathematically and computationally more complex regression problem (). Let Y = VW be a singular value decomposition, where V =[v 1 v k ] is a matrix of score vectors, a diagonal matrix and W the k k matrix containing the loadings of the k principal vectors. Score vectors v j can be used as input to GEMULA to discover interesting regulatory interactions across experiments.
Outer cross-validation: anotheroption in our GEMULA-package is the use of an outer loop of cross-validation to reduce selection bias in the  R 2 cv estimates in Stage III, which will cause these to be overly optimistic. Since this will at the same time increase the variability (and reduce the power) of the whole fitting procedure, this is only recommended when selection bias is expected to be a serious problem, e.g. when p is large with respect to n. We provide a comparison of the results obtained with both ordinary and nested CV in Supplementary Table S3.
RESULTS
Yeast response to environmental stressTo compare the competitive predictive strength of different sets of predictor variables and to compare GEMULA to MARS on data from a well-characterized biological system, we applied GEMULA to gene expression data from the yeast Saccharomyces cerevisiae.published genome-wide expression patterns in yeast cells that were exposed to various changes in environmental conditions, including heat shock, nitrogen depletion and amino acid starvation. Approximately 900 genes show a comparable and strong transcriptional response to almost all stress conditions examined (). The term 'environmental stress response' (ESR) was coined to describe this phenomenon. The heat shock expression dataset contains time course profiles of all ESR genes at different different time-points, ranging from 5 to 80 mins post-shock. Here, we consider the observed gene expression at 20 mins as our response variable Y. Analysis of the other time-points yielded similar results. We consider two different sets of predictor variables. From the experimentally derived DNA binding sites published by, we extracted 123 different position frequency matrices (PFMs) representing models of the DNA sequences bound by yeastTFs. We used the TRAP (TRanscription factor Affinity Prediction) method developed byto calculate TFDNA binding affinities for binding of TFs to the genomic DNA sequences from 1 to 1000 bp directly upstream of yeast open reading frames. The resulting predictors are referred to as MRM. Variation in rates of transcription can result from factors other than TF binding. For instance, several studies have pointed out that there is a clear relationship between patterns of histone acetylation and observed gene expression.have shown that indeed such data can be used to improve prediction of transcription factor binding sites (TFBS)s. Therefore, we included experimental data from the genome-wide map of nucleosome acetylation and methylation () as an additional set of predictors. This second set of predictors consist of 19 extra variables, including eight sets of histone modifications, measured under both normal conditions and following oxidative stress. We refer to these predictors as NUC. Fitted GEMULA models contain TFBS motifs of TFs that are well known to be crucial for the transcriptional regulation of heat shock responsive genes. For instance, the GEMULA M2 model fitted using the MRM + NUC predictors contains the predictors MSN2, MSN4, ROX1, HSF1 and CST6. These 5 are among the 12 TFs that regulate gene regulatory modules of heat shock genes identified by Wu and Li (2008). Furthermore, we find that GEMULA models containing interactions between predictors outperform models with only main effects (, models M 2 ,M 3 ). In contrast,  R 2 cv of MARS models decreases when interactions are included, likely due to overfitting. Another noteworthy conclusion is that inclusion of the additional NUC predictors consistently leads to models with higher  R 2 cv s. This supports the hypothesis that both chromatin structure dynamics and TF binding play an important role in the regulation of gene expression.acid starvation, Nitrogen depletion and Hydrogen peroxide treatment. We fit models using GEMULA and focus on the selected TFs and their interactions in the inferred models. Results are presented as context-specific TF regulatory networks in. GEMULA correctly predicts important roles for the major regulators of the general stress response MSN2 and MSN4, the regulator of ribosomal protein genes FHL1, the osmotic and oxidative stress response TF SKO1 and SFP1, a TF that controls expression of ribosome biogenesis genes in response to nutrients and stress. Of particular interest are condition specific changes in TF activity suggested by the networks in. For instance, GEMULA predicts interactions between GAT1, DAL80 and GZF3, all TFs known to mediate nitrogen-responsive expression, in the amino acid starvation network. To assess the functional relevance of the TFTF interactions identified by GEMULA, we use results of an independent study on combinatorial regulation from the literature.computed co-regulatory coefficients (CCs) of 5622 pairs of TFs in the yeast transcriptional network. The CC measures the significance of overlap in target genes shared between pairs of TFs and thus high CC values correspond to pairs of TFs that co-regulate common sets of targets. We tested whether TFTF interactions with high selection probability (Section 2.2) have higher CCs on average, using a Wilcoxon rank sum test. Hence, we test for a significant change in location of the distribution of CCs for TFTF pairs with high selection probability relative to all candidate TFTF pairs considered by GEMULA.contains the results and shows that, on average, the interactions with a high selection probability correspond to TFTF pairs with significantly higher CCs and hence suggests their functional relevance.
Identification of TFTF interactions
TF regulatory networks underlying axon growthWe next used GEMULA to infer TFTF interactions in the gene regulatory network underlying neuronal outgrowth. As a cellular model, we used F11 cells (). Upon stimulation with Forskolin, F11 cells acquire a neuronal phenotype, which results in the outgrowth of neurites (). We reanalyzed previously published genome-wide gene expressionOn average, TFTF interactions j with a high selection probabilityprobability probability j have a significantly higher CCs, based on a Wilcoxon rank sum test. NA, not applicable. time course profiles of F11 cells measured at four time-points following Forskolin stimulation (). Using Bayesian Analysis of Time Series], we identified a set of Forskolin responsive genes, i.e. genes that show differential expression in Forskolin stimulated F11 cells compared with unstimulated control cells. BATS is a Bayesian method for analysis of gene expression data, specifically tailored to handle short, replicated time series. Initially, we analyzed the entire group of Forskolin responsive genes at all four time-points separately (Supplementary). We observed rather low  R 2 cv s for the fitted models, but interestingly, the amount of 'explained' expression variation seemed to vary in time. We then further examined the expression profiles of the regulated genes using PCA and noticed clear differences between the expression at the first two time-points immediately following Forskolin stimulation and the two 'late' time-points. We performed PCA on the gene expression matrix to see if the observed variation in expression could be further divided into biologically meaningful patterns. For each gene, we used the signs of the coefficients corresponding to the first and second principal component to define four gene sets of interest (Supplementary). The first Page: 219 214221principal component seems to identify the main direction of the induced gene expression changes and can be used to distinguish between predominantly up-versus predominantly downregulated genes, whereas the second principal component discriminates between early genes and late genes. Based on these observations, we named these four expression clusters 'early up', 'late up', 'late down' and 'early down'.shows a plot of the average expression of genes in these clusters. The definition of these gene sets allowed us to investigate the possible underlying time-dependent activity of TFs and the presence of an 'early' and a 'late' transcriptional response. This separation into early and late genes makes sense from a computational point of view, because inclusion of background genes, i.e. genes that are not actually regulated under the experimental condition of interest, may adversely affect the overall fit of the models, as the measured gene expression for such genes constitutes only noise (). From a biological point of view, it makes sense to distinguish between 'early' and 'late' genes, because interactions between TFs and their target genes are expected to be condition-specific and time-dependent. The yeast ESR set that we analyzed in Section 3.1 consists of genes that show a remarkably consistent transcriptional response to different stress conditions. In contrast, the set of Forskolin-responsive genes displays strong timeheterogeneity, which is why a further subdivision is necessary. We applied GEMULA again, but this time we distinguished between early responsive genes, consisting of the union of genes in the 'early up' and 'early down' sets, and late responsive genes, consisting of all genes in the 'late up' and 'late down' sets. If the early genes are transcriptionally regulated at the early, but not the late time-points, we expect the models fitted at the late time-points using data from the early responsive genes to have considerably lower  R 2 cv s and vice versa. We indeed find that this is the case (). Moreover, this time the fitted models have notably higher  R 2 cv s than the models fitted on the entire group of genes (Supplementary). These results suggest that indeed the experimental data arise from two separate waves of transcriptional changes. Of particular interest biologically are the sets of TFs that are associated to these early and late gene expression changes, the interactions between them and their effects on axon outgrowth. To this end, we made a subselection of genes based on informative GO-terms (Supplementary Material) and calculated selection probabilities for candidate terms in the models generated by GEMULA. This allowed us to prioritize terms in the models and focus on the most significant predictors. The resulting TF networks are shown in. Note that the network inferred for the early, but not the late changes, contains the predictors V.CREB.01 and V.CREBATF.Q6, among others. These motifs represent the TFBSs for CREB, a cAMP-inducible TF. Activation of CREB is known to be induced by Forskolin stimulation of F11 cells () andhave shown that activated CREB is sufficient to promote spinal axon regeneration. Interestingly, many TFs binding to the DNA binding motifs insuch as V.CEBPDELTA.Q6, V.PPARA.02 and V.PBX.Q3 were previously found to have a significant effect on axon growth upon knockdown in F11 cells (). In contrast, the network that was inferred from the late timepoints () contains no known transcriptional regulators of neurite outgrowth, suggesting that these cells indeed have entered a different stage of differentiation. Together, these observations show that GEMULA can be used to detect important context-specific regulatory interactions in gene networks that underlie transitional changes in cell fates.
Gene expression modeling using LAsso
DISCUSSIONThe success of a regression-based approach to modeling gene expression and DNA sequence data depends on appropriate choices for the type of model and the predictors used as input. This was first demonstrated bywho proposed a strategy that uses the non-parametric MARS method as core regression routine ().claim that their MARSMOTIF algorithm, which allows modeling of synergistic interactions between predictors, is approximately 1.5 to 3.5 times more accurate than the method of, which is based on a linear model. The comparison is based on an R 2-like  2 statistic and no cross-validation was performed. A comprehensive comparison is lacking. The results we present in this article show that similar synergistic interactions as in) can be modeled using linear models. In fact, GEMULA produces biologically plausible models with superior fit compared with MARS when applied to the same data. Typically, models contain a rather large number of predictors, whereas not all of these are equally relevant for the underlying biological processes. We demonstrate that GEMULA identifies synergistic pairs of TFs that are likely to be functionally relevant, i.e. on average the overlap in target genes of such identified TFTF pairs is significantly higher than expected by chance. In order to build models that are biologically useful and interpretable, the availability of relevant biological predictors used as input are crucial. The TRAP predictors we consider in this article represent in silico predicted binding affinities of TFs. Using yeast data, we showed that GEMULA in combination with TRAP predictors successfully identifies interactions between known heat shock regulating TFs such as MSN2, MSN4, HSF1, CST6 and ROX1 that underlie the observed variation in expression of yeast genes in response to hypothermic shock. The TRAP predictors are realvalued and have an interpretation that is closer to experimentally measured TFDNA binding profiles as obtained, for instance, with ChIP-chip assays than other motif representations, which use exact words. Models that use TRAP predictors have a clear Page: 220 214221Columns 310 correspond to models fitted for the early responsive genes and columns 1118 to models for the late responsive genes.The column 'N.P' lists the number of predictors in the fitted GEMULA models and 'N.T' denotes the number of model terms.  R 2 cv is the goodness-of-fit criterion of the selected model (Section 2.2), together with a 95% bootstrap confidence interval.interpretation, which facilitates the step toward biological validation. Our analysis of yeast stress response gene expression data shows that GEMULA can identify context-specific TFTF interactions that underly observed variation in gene expression under different physiological conditions. We demonstrate that our method can also be used to analyze mammalian gene expression data. We applied GEMULA to identify TFs associated to observed variations in early and late gene expression changes in F11 cells in response to Forskolin stimulation. The observed fit in terms of  R 2 cv of the resulting models is considerably less than for GEMULA models inferred from yeast heat shock data where additional predictors are available. However, we show that GEMULA identifies several crucial TFs with a well-established role in the regulation of neuronal outgrowthassociated gene expression and additionally provides new insights into the temporal dynamics of the regulatory network underlying axon growth. The strength of our approach is the combination of l 1-penalization and re-sampling methods to fit and select appropriately regularized models. A current limitation is that the linear models we discuss in this article are not capable of quantifying contributions of TFs to variation in gene expression across experiments. To extend the penalized regression framework to the multivariate case of multiple experiments would require fitting a model that includes parameters representing TF activity in each condition separately [see e.g.], resulting in a computationally more complex problem. How to induce the right amount of sparsity and solve the corresponding optimization problem would be an interesting direction for further research.
G.Geeven et al.
CONCLUSIONLinear models are valuable tools for inference of transcriptional gene regulatory interactions and synergistic pairwise interactions between predictors that underlie observed changes in gene expression under
The Author 2011. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oup.com at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
