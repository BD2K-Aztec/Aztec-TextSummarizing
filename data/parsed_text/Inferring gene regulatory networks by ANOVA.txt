Motivation: To improve the understanding of molecular regulation events, various approaches have been developed for deducing gene regulatory networks from mRNA expression data. Results: We present a new score for network inference, η 2 , that is derived from an analysis of variance. Candidate transcription factor:target gene (TF:TG) relationships are assumed more likely if the expression of TF and TG are mutually dependent in at least a subset of the examined experiments. We evaluate this dependency by η 2 , a non-parametric, non-linear correlation coefficient. It is fast, easy to apply and does not require the discretization of the input data. In the recent DREAM5 blind assessment, the arguably most comprehensive evaluation of inference methods, our approach based on η 2 was rated the best performer on real expression compendia. It also performs better than methods tested in other recently published comparative assessments. About half of our predicted novel predictions are true interactions as estimated from qPCR experiments performed for DREAM5. Conclusions: The score η 2 has a number of interesting features that enable the efficient detection of gene regulatory interactions. For most experimental setups, it is an interesting alternative to other measures of dependency such as Pearson's correlation or mutual information. Availability: See http://www2.bio.ifi.lmu.de/˜kueffner/anova.tar.gz for code and example data.
INTRODUCTIONThe reconstruction of gene regulatory networks (GRNs) from expression data can help to improve our understanding of molecular regulation events. A variety of algorithms have been devised to predict gene regulatory interactions, frequently based on mutual dependencies between the expression of regulators and their targets (see related work). We propose to evaluate transcription factor:target gene (TF:TG) interactions by the measure  2], a non-linear correlation coefficient derived from an analysis of variance (ANOVA). Although  2 has a number of interesting features it has, to our knowledge, not been applied to network inference or to bioinformatics in general. * To whom correspondence should be addressed. A high proportion of our predicted novel interactions were confirmed by small-scale qPCR experiments performed by the DREAM5 organizers. In addition, our approach was evaluated as the best performer for the inference of real datasets in the recent DREAM5 blind assessment [http://wiki.c2b2.columbia.edu/ dream/index.php;;. Here, 29 participating teams applied a diverse set of inference methods to a variety of large real (Escherichia coli, Saccharomyces cerevisiae) and artificial expression compendia with thousands of genes from several hundreds of microarray measurements. The microarray experiments consisted of various gene, drug or environmental perturbations that were in some cases carried out as time courses. After a brief summary of related work we describe the GRN inference setting, introduce our inference approach based on the score  2 and evaluate its properties and performance.
Related workThe inference of large GRNs of 500+ nodes is frequently tackled by unsupervised, data-driven approaches that aim to resolve dependencies from expression data alone. We briefly review some commonly used techniques in the following and refer the reader to review papers [e.g. by, Lee and Tzou (2009) and Markowetz and] for a more comprehensive overview of methods. Unparameterized topologies can be approximated even for large networks by measures of pairwise gene dependencies, e.g. using Pearson's linear correlation coefficient [. To take non-linear correlations into account, information theoretic approaches can be employed such as Bayes conditional probability tables or mutual information [;;. The latter techniques require a very careful discretization of the expression data to avoid the loss of signal [Altay and Emmert-Streib (2010a); Mukherjee and;. One source of false positive predictions are indirect effects, i.e. in a cascade ABC methods are likely to also predict the additional effect AC. Extensions like the data processing inequality] and gene dependent background distributions] have been proposed to overcome this problem. The minimum redundancy maximum relevance concept [;] offers another way to select important edges. Indirect effects might also be identified and removed by partial correlations [], elastic net or lasso, a L1-penalized estimation of the inverse covariance matrix;. All of the mentioned approaches measure global dependencies, i.e. dependencies that are visible
GRN Inferenceacross the majority of measured experimental conditions. Local dependencies that are only apparent in a subset of the conditions] might thus be missed. Models like Boolean, (probabilistic) Bayesian networks, ordinary differential equations (ODE) or Petri Nets are generative i.e. they allow the generation of the original training datasets by simulation. Optimization approaches minimize the deviation from given data by parameterizing models;. Due to the huge parameter space these algorithms may not scale well to large networks. The assessment of the multitude of reconstruction algorithms is quite difficult. Comparative studies;;;;] evaluate only subsets of approaches. More comprehensive assessments are facilitated through community-wide challenges conducted by the DREAM consortium.
METHODS
Inference setting, data sources and evaluationProblem statement and evaluation. GRN inference aims at the detection of gene regulatory relationships from mRNA expression datasets. The task is to reverse engineer the directed topology of one network for each of the available expression datasets (). In the following, we describe a setup for the evaluation of inference methods that has been adopted by many comparative assessment studies including DREAM5 (http://wiki.c2b2.columbia.edu/dream/index.php/D5c4) and. For each dataset, potential TFs are given. Only these TFs should be included as regulators in the network predictions as the used gold standards do not contain gene regulatory interactions for other regulators such as sigma factors or miRNAs. The list of TFs was available to all participants of the challenge. Approaches were then required to check and rank |TF||Genes| candidate relationships. Lists of ranked candidate interactions are evaluated against the true topology (in case of the artificial dataset) or against experimentally determined TF:TG interactions. Candidate lists are evaluated against gold standard networks (see below) based on the area under the precision-recall curve (AUPR) and the area under the receiver-operator characteristics curve. In DREAM5, only the top 100 000 interactions were considered for this analysis. The resulting AUPR and AUROC will be lower if only a subset of the interactions is considered. Although this difference has only little effect on the ranking of the approaches, we will report AUROC values for the top 100 000 predictions as well as for all predictions in order to enable the comparison to other studies [e.g.. The performance evaluation in this article focuses on the AUROC, but additional evaluation and scores can be found in the Supplementary Material (part 4).). In comparison to data repositories such as GEO], DREAM5 and M3D provide fewer but uniformly preprocessed and normalized datasets. Measurements as well as annotations are rendered comparable across different experiments and are thus suited to automated network inference. In case of the real DREAM5 datasets, organism, experiment and gene names are replaced by random IDs to enable the evaluation of the inferred networks against experimentally confirmed interactions unknown to the participants. Thus, no prior knowledge could be utilized for the inference. Datasets in the expression compendia are subdivided into experiments that consist of all microarrays described in a single publication or conducted by the same experimenter. Besides wild-type measurements, experimental conditions represent (combinations of) drug, environmental and gene perturbations. Some of the drug or environmental perturbations are provided as time course measurements. We considered each time point as a separate condition. A condition may contain multiple replicates. In case of gene perturbations (deletion or over-expression), the annotations provide the IDs of the perturbed genes. The artificial dataset was generated by the tool GeneNetWeaver, see Section 6 of the challenge description at http://wiki.c2b2.columbia.edu/dream/index.php/D5c4] and mimicked the E. coli dataset in the composition of the perturbations and time courses. For additional validation, we obtained E. coli and S. cerevisiae expression data from the M3D database [seeand. Similar to the chip annotations provided in DREAM5, M3D provided manually curated metadata for their chip measurements.
Gold standard networks. Predicted E. coliinteractions were validated based on RegulonDB;, a database of gene regulatory relationships that are both experimentally validated and manually curated. The S. cerevisiae gold standard] was automatically derived by large-scale chromatin immunoprecipitation (ChIP) binding assays. Physical binding is not a sufficient evidence, as noted byand Boulesteix and Strimmer (2005). Thus, ChIP will lead to many false positive interactions.aimed to overcome this problem by complementing ChIP assays with conservation-based motif discovery algorithms. Due to the more reliable small-scale assays and the manual curation, the E. coli gold standard should be regarded as more reliable than the one for S. cerevisiae. This is supported by a recent review bywhere even otherwise accurate methods fail to predict this gold standard. The true network topology is known for the artificial dataset and was used for evaluation. Combined with the above mentioned M3D datasets, these gold standard networks have been used for evaluating inference methods by DREAM5 as well as. Because the same gold standards are used and because the majority of the experiments in the DREAM5 datasets on E. coli were taken from the M3D database (Daniel Marbach, personal communication) results of DREAM5 andare approximately comparable. This also applies to assessments based on artificial datasets that have been generated by the tool GeneNetWeaver] in both studies.
Network inferenceFold changes. Basal gene levels can be very different between experiments. To compensate for this, we transformed the absolute expression values into expression fold changes (see also Supplementary Material, part 1). Fold changes are computed by mapping the measurements m i ,i = 1...|m| of each condition m onto one or more valid control conditions (). Each m is subject to a combination of gene, drug or environmental perturbations P. A condition m c measured at time t(m c ) under the set of perturbations P c is called a valid control condition for m if P c  P and t(m) = t(m c ), where P P c represents the differential treatment between two conditions.and CLRframeworks (Supplementary Material, part 4).
A measure of association derived from two-way ANOVA.Our inference approach is based on a two-way ANOVA. A two-way ANOVA can be used to model experimental observations Y ijk as responses to two factors C and G as well as the measurement error,where  is the average response,  i is the effect from the i-th level of the factor C,  j is the effect from the j-th level of factor G,  ij is the joint effect from the interaction between factors C and G and ijk represents the remaining unexplained error in replicate k. In our application of ANOVA, C models the effect of differential expression across i [1...c] different experimental conditions and G models whether the expression profiles of the genes j [g,t] (as we consider exactly one TF t and one TG g) differ. Thus, we apply ANOVA to a matrix of conditions, genes and replicates as depicted in. A two-way ANOVA tests three null hypotheses: (i) no differences in means of factor C; (ii) no differences in means of factor G;and (iii) no interaction between C and G, by partitioning the total sum of squares SS T into four components ():A sum of squares (SS) is a sum of squared deviations from a mean] and can be regarded as an unadjusted measure of dispersion.A variance V x is computed by adjusting the SS x for the degree of freedom df x , where df x is the number of data points under consideration minus 1, and x [C,G,CG,err,T ]. An F-value is computed by weighting the effect variance against the error variance. F-values follow the F-statistic, which can be used to derive the statistical significance of the involved factors as p-values. For instance, to estimate the significance of differential expression across conditions we compute F C by:Effects so far describe differences, but ANOVA can also be used to detect specific similarities or associations between TF and TG. Phrased in terms of the two-way ANOVA, the strength of an association is proportional to the fraction of SS C in the total sum of squares SS T :Thus,  2 + [0...1] measures association as the fraction of the total variance that is explained by the differential expression across experimental conditions. Cohen (1973) refers to  2 + as the non-parametric non-linear correlation coefficient. Its statistical significance can be estimated via F +. A more detailed description of the algorithm including pseudo code can be found in the Supplementary Material (parts 2 and 3). Adjusting for negative correlation. In contrast to Pearson's  2 ,  2 does not directly test for negative correlations. We therefore propose to reverse the signs of the TF-fold changes to compute an additional  2 . The final ranking of candidate interactions is performed using
GRN InferenceIncorporation of gene perturbation experiments. We extend the basic approach to incorporate measurements on gene specific perturbations. A candidate interaction between a TF and a putative TG should be considered more likely if the TG shows a response to the knock-out or over-expression of the TF. In the calculation of  2 for such an interaction this is taken into account by increasing the weight of conditions that involve gene perturbations affecting the TF by a user specified weight parameter w gp. Values may range between 10 and 1000 (see Supplementary Material, part 4) and have been estimated based on M3D data] prior to our participation in DREAM. The weight of such a condition is increased by inserting w gp 1 additional copies into the ANOVA matrix (). Conditions where non-TFs or TFs other than the currently tested TF are perturbed receive the default weight of 1.shows the resulting expression patterns from the largest clusters of the E. coli and the artificial data. Co-regulation patterns are easy to detect in all real datasets but are virtually absent in the artificial data. We also noticed that 50% of the regulation in the artificial data is due to inhibition. Inhibition, i.e. negative correlations between TF and TG is comparatively rare in the real datasets (). Real networks are more complex than the artificial networks created byas they do not account for interactions involving proteins or other molecules. The real E. coli and S. cerevisiae datasets were also markedly different. While correlation between TF and TG is a good predictor of a gene regulatory relationship in artificial and E. coli data, this is not the case in S. cerevisiae (). This finding is reproducible across different yeast datasets, gold standards and measures of dependency (not shown). That network inference is more difficult in S.cerevisiae as compared with E. coli is consistent with the work ofRun time complexity. The run time complexity of our network inference approach is O(|TF||genes||chips|) (see Supplementary Material, part 3), i.e. the complexity of the ANOVA estimator is linear in the number of chips. The datasets () required between 280 k and 2 M evaluations of  2 across 160 to 907 chips. The largest datasets required a run time of 2 min on a single processor core. The complexity of other inference approaches has been discussed previously.show the performance of our  2 method in comparison to other approaches. For a broad comparison of methods we combined our own evaluation results for some of the publicly available methods (for additional evaluation and scores see Supplementary Material, part 4) with the results of the DREAM5 network inference challenge as well as the large comparative assessment study of. We selected methods that performed best on one of the three DREAM5 datasets (methods 13) and the best performing methods (with respect to AUROC) as determined by(methods 69). For comparison, we also applied the methods 2 as well as 57 as end-user ready tools were available.In order to render the DREAM evaluation (that considered only the top 100 k predictions) comparable to the evaluation by, we re-computed the performance based on all predictions (i.e. not only the top 100 k) and re-applied publicly available methods. Considering all predictions usually increases the resulting AUROC by up to a few percentage points, which usually has only little effect on the performance ranking of the methods. Interestingly, some of the participants in the DREAM5 challenge outperformed existing inference methods significantly, particularly in case of the artificial and E. coli datasets (). For the inference of yeast interactions such a clear statement was not possible as all methods performed rather poorly. The presented  2 method was the best performer for inferring E. coli interactions and was also competitive for the artificial dataset, outperforming the previously published methods analyzed in this article or by. The performance on artificial and E. coli interactions is depicted infor all methods that participated in the DREAM5 network inference challenge. The prediction performance apparently also depends on the number of chip experiments. All methods yielded a better prediction performance for the M3D E. coli dataset (), which contains more measurements than the DREAM5 E. coli dataset. The same reasons also contribute to the lower performance observed in the S. cerevisiae dataset. Properties of  2 exemplified via selected interactions. We analyzed properties of  2 on the E. coli dataset from M3D. A strong linear correlation is exhibited for instance by the fis:dusB interaction (fis: organization and maintenance of nucleoid structure; dusB: tRNAdihydrouridine synthase B,). The observed linear correlation might be due to the fact that both genes are part of the same operon. Non-linear correlations such as gadE:hdeA are also detected by  2 (gadE: acid-induced positive regulator of glutamate-dependent acid resistance; hdeA: stress response acid resistance protein). hdeA is already activated by low gadE concentrations (). In contrast, mdtE (multidrug transporter component) is activated only at high concentrations of gadX (regulator of acid resistance) resulting in an upwardly-curved scatterplot (not shown).  2 also enables the detection of correlations that are only apparent in a subset of the measured conditions, i.e. it detects local correlations. This increased sensitivity is due to theThe area under the ROC curve (AUROC) curve is used for the evaluation of inference methods performed by the DREAM5 organizers a , by the authors of the present article b,c,d and from the paper ofe. To render the DREAM5 protocol a,b (gray background, considering the top 100 k predictions only) comparable to other studies, the performance on the DREAM datasets has been re-calculated c with all predictions. Also, publicly available methods have been re-applied d to M3D datasets. Methods show similar performance between the DREAM5 c and M3D d,e real (because of their large overlaps) as well as artificial datasets (because they were generated by the same tool, GeneNetWeaver). The best predictions are shown in bold. See Supplementary Material (part 4) for additional scores. All methods were invoked with the designated options to utilize the preselected lists of TFs. effective utilization of the replicated measurements to quantify the measurement error. The expression profiles of an interaction between the multiple antibiotic resistance (mar, GeneOntology GO:0046677response to antibiotic) genes marA and marB are a good example of a local correlation between TF and TG. While Pearson's  2 would argue against this edge, it is considered as relevant by  2 (, panels C and E). The interaction between marA and marB is active in E. coli treated with the antibiotic norfloxacin (a gyrase inhibitor). The co-regulation across various gene over-expression experiments in the presence of norfloxacin is depicted in(left side). The treatment with other antibiotics such as ampicillin and kanamycin also triggers the co-regulation of the two mar genes (not shown). The interaction is not active in the experiments on biofilm formation and growth phases as marA and marB exhibit virtually no co-regulation here (, right side).
RESULTS
Performance evaluation. Table 2 and
In vivo confirmation of novel interactions. Novel candidate interactions in E. coliwere preselected by applying a 50% precision cutoff to the predictions, i.e. we stop iterating over the list of predictions from most to least confident when the precision evaluated against RegulonDB drops <50%.Predicted TF:TG interactions were tested by quantifying the presence of the TG mRNA through qPCR amplification in E. coli gene knockouts of the corresponding TF. The mRNA levels for the same TG were quantified in non-mutant, wild-type E. coli to measure gene expression differences. Expression differences >2-fold for TGs are considered evidence for a true regulatory relationship between the predicted TF:TG pair. In total, 5 TFs were sampled and 53 interactions not contained in the gold standard were tested. Here, 21 TF:TG pairs showed greater than a 2-fold change corresponding to a confirmation rate of 39.6%. Relaxing the fold change cutoff to 1.8, 26 pairs are reported (precision of 49.1%). This approximately confirms the 50% precision cutoff from the computational analysis. At a precision cutoff of 50% we predict 1995 novel interactions thus expecting 1000 (199549.1% = 979) additional true interactions not contained in RegulonDB. The qPCR experiments were performed by the lab of James J. Collins at the Boston University in the context of the DREAM5 challenge. The full description and analysis of these interactions as well as the participating inference approaches will be the subject of a future paper (Marbach,D., Costello,J. andThe wisdom of crowds for gene network inference, submitted).
GRN Inference
DISCUSSIONTo infer gene regulatory networks (GRNs), we rank the relevance of candidate relationships consisting of a TF and a TG by measuring the dependency between their respective expression profiles. For the detection of dependencies we proposed the measure  2 that is derived from an analysis of variance (ANOVA). To our knowledge,  2 has not been applied to network inference or to other problems in bioinformatics although it has a number of interesting features (). Like Pearson's  2 , but in contrast to Bayes conditional probability tables or mutual information,  2 does not require the discretization of the input data. This increases the robustness of our method as inappropriate discretization might lead to loss of signal. In contrast to Pearson's linear correlation coefficient,  2 is a non-parametric, non-linear correlation coefficient. It also detects local correlations that are only apparent in a subset of the measured conditions. This increased sensitivity is due to the effective utilization of replicated measurements to model the measurement error. The recent DREAM5 blind assessment solicited the prediction of GRNs with thousands of genes from two real datasets (E. coli and S. cerevisiae) and one artificial dataset. The 29 participating teams employed a variety of methods based on regression (Lasso, random forests), Bayesian networks, mutual information and correlation. In DREAM5, our approach was rated the best performer on the inference of real networks and the second best performer on real and artificial networks combined. Especially for the inference of E. coli interactions, our approach performed significantly better than the methods evaluated in DREAM5 () as well as in the large assessment of().In contrast to E. coli, predictions for S. cerevisiae received significantly lower scores because the yeast gold standard network is less reliable. Compared with E. coli and artifical networks, inference is substantially more difficult in S. cerevisiae as here the expression of TF and their regulated genes is hardly correlated (). Indeed, with an AUC between 0.49 and 0.54, predictions were hardly better than guessing. The difficulty of network inference in S.cerevisiae has also been recognized by. Many publications on network inference approaches solely focus on E. coli; Mordelet and. Some of the known E. coli interactions identified by our approach were quite interesting biologically. For instance, an interaction between multiple antibiotic resistance genes was active after antibiotic treatment (local correlation) but not in growth phase experiments. According to qPCR experiments that were performed as part of the DREAM5 conference >50% of our novel predictions represent true interactions. At a precision of 50% we thus expect that our predictions contain 1000 previously unobserved true interactions.
The Author 2012. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oup.com at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
