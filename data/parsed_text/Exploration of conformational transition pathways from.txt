Motivation: A new algorithm to trace conformational transitions in proteins is presented. The method uses discrete molecular dynamics as engine to sample protein conformational space. A multiple minima Go-like potential energy function is used in combination with several enhancing sampling strategies, such as metadynamics, Maxwell Demon molecular dynamics and essential dynamics. The method, which shows an unprecedented computational efficiency, is able to trace a wide range of known experimental transitions. Contrary to simpler methods our strategy does not introduce distortions in the chemical structure of the protein and is able to reproduce well complex non-linear conformational transitions. The method, called GOdMD, can easily introduce additional restraints to the transition (presence of ligand, known intermediate, known maintained contacts,. . .) and is freely distributed to the community through the Spanish National Bioinformatics Institute (http://mmb.irbbarcelona.org/GOdMD). Availability: Freely available on the web at http://mmb.irbbarcelona. org/GOdMD.
INTRODUCTIONMany biological functions of proteins such as mechanic work, signal transduction or enzymatic activity are modulated by a key property of them: flexibility (). Flexibility is a property that has been refined and maintained by evolution () and that, in turn has been also exploited by evolution to generate new proteins in a conservative mechanism, which guarantees the maintenance of the structural scaffold as well as the relevant deformation pattern (). Structural databases show () increasing number of proteins having alternative structures depending on external factors (such as crystallization conditions, posttransductional chemical modifications, presence of ligands, changes in solvent environment, etc). This probes the existence of dramatic conformational transitions in proteins, but giving no information on how such transitions happen. Recent refinements of experimental techniques have provided direct evidence on the mechanisms of conformational transitions for some model proteins (). However, we are still far from the point that all conformational transitions could be described by means of experimental methods. This situation forces the use of simulation techniques, which has been largely refined in the past years (), providing information of increasing quality for a large number of conformational transitions in proteins (). Molecular dynamics (MD), using atomistic force-fields and explicit representation of solvent (), is probably the most accurate theoretical technique for reproducing protein flexibility. Recent computational approaches have made possible the simulation of thousands of proteins () and the derivation of up to millisecond trajectories for proteins (). Unfortunately, most conformational transitions are still far from the capabilities of plain atomistic MD, forcing the use of biasing schemes (), designed to maximize the sampling along a given variable that is believed to capture conformational transition motions. Biased-MD protocols are extremely powerful, but they are expensive computationally, require expertise from the user and can lead to incorrect results when the transition coordinate is not well defined. Coarse-grained (CG) models () are inexpensive, but still accurate alternatives to atomistic MD simulations, which have gained significant popularity in recent years. Unfortunately, the use of CG models require the assumption of a certain loss of detail in the simulation, for example, explicit solvent is ignored, which prevent the study of specific waterprotein interactions and side chains are either ignored or dramatically simplified (), which raises problems *To whom correspondence should be addressed. to reproduce ligand-target interactions. CG models have been calibrated against experimental data, such as B-factors, structural variability in databases or atomistic MD, and despite their simplicity, provide often results of surprising quality with limited computer resources and reduced expertise from the user. CG-methods have been largely used to trace conformational transitions in proteins. The first implementations followed mainly interpolation schemes between original and final conformations (). Interpolation protocols are fast and guarantee the completion of the transition, but often at the expense of unrealistic intermediate conformations, which are not good starting points for refinement through more accurate atomistic simulations. Alternative CG-transition methods have been developed under the assumption that biologically relevant transitions should follow the easiest deformation movements of the proteins () defined as the softest deformation modes obtained by diagonalization of the Hessian matrix derived from an elastic network model (ENM) Hamiltonian:where i and j are residues, ij is a delta function equal to 1 when i and j are at less than a given distance, and 0 otherwise; K is a spring constant (linear or distance dependent), R ij stands for inter-residue distance and the superscript 0 refers to the value of K ij in the reference structure. Morphing methods based on the use of essential deformation modes provide more reasonable approaches than linear interpolation schemes, but are far from being optimal since (i) the covalent structure of the protein can be damaged when large displacements along a limited number of Cartesian eigenvectors are made, (ii) a non-negligible number of transitions do not align with the intrinsic deformation pattern of proteins (), and even those cases where the alignment between the essential deformation space and the transition vector is good, displacement along the essential space of one of the proteins never allows a full transition between the two conformational states. Recent advances in the field, such as the use of multiple reference structures to define a transition-dependent essential deformation space () or the derivation of the essential deformation modes in the dihedral space (), have alleviated but not solved these problems. In this article, we present a new approach to obtain ultra-fast, but accurate, conformational transition pathways in proteins out of physics-based molecular mechanics simulations. By combining an efficient sampling technique [discrete molecular dynamics (dMD;with a novel multiple-well Go-like scheme. Sampling is enhanced with biasing techniques such as metadynamics () and Maxwell Demon MD (). The method was tested in a large battery of transitions (near 50 pairs of structures) obtaining, with reduced computational cost, reasonable pathways in all cases, including in cases of extreme difficulty, where transition requires, for example, partial unfolding of the protein. Owing to the physical nature of the method, sampled intermediate structures maintain covalent structure, and no steric clashes are allowed. In cases where experimental intermediates are characterized, the method finds transition paths passing close to them. Surprisingly, the method outperforms our previous more detailed algorithm, Maxwell Demon discrete molecular dynamics procedure (MDdMD;), and is also competitive with respect to alternative methods in the literature (Supplementary Figs S1S3). Our novel approach is flexible, allowing the introduction of any perturbation. Furthermore, the user can easily bias trajectories to guarantee that known experimental intermediates are sampled.
METHODSIn this approach we have applied the dMD method [see () for details]. In dMD, particles move in the ballistic regime, with constant velocity until a collision occurs. Collisions occur at the particleparticle distances corresponding to a discontinuity in the dMD potential. The velocities of the particles after the collision are obtained using the rules of conservation of momentum and energy. This allows avoiding the integration of Newton's equations of motion, speeding up the simulations as compared with usual MD. Discrete MD has successfully been applied to protein folding (), macromolecular dynamics (), RNA structural predictions () and protein aggregation (). Recently dMD has been also used to robust energy minimization of proteinprotein complexes () and proteinligand interactions ().
Force-field representationWe adopted a CG representation of the protein, where only Cs were explicitly represented. We used a single square well with infinite walls to define the bonded interactions between consecutive beads. The nonbonded interactions were described by a multiple well Go-like model () depending on the experimental inter-particle distance. Non-bonded terms of the Hamiltonian were classified in two categories based on whether or not the inter-particle distance is different between the initial (A) and final (B) conformations. If they are, we define a double well potential () centered in the respective experimental values: ~ r A and ~ r B. When the distances are similar in both conformations (i.e. ~ r A $ ~ r B ), we used a single, but wider, well (50% larger) centered at  (~ r A  ~ r B ). To avoid over-restraining the system with physically irrelevant interactions, the potential energy was defined only for those particles within a cutoff (~ r A , ~ r B 4radii of gyration/2). It is worth noting that the height of the wells for all non-bonded interactions is finite (0.5 kcal/mol), allowing the particles to escape from the wells if required. This Go-like scheme is convenient to complete transition paths [ 485% of the root mean square deviation (RMSd) difference between end structures) because target minimum acts as attractor. This situation enables us to use softer biasing schemes and to better recover native contacts (see Supplementary Materials for details].
Accelerating the transitionWithin the Hamiltonian definition above, the A!B transition occurs through a movement of particles jumping from wells centered at ~ r A to those centered at ~ r B. Unfortunately, as a side effect of Go-like potentials,
Moving toward the final conformation The ENM-metadynamics procedure outlined above guarantees that the protein moves apart from the original structure sampling preferentially essential deformation modes. However, there is no guarantee that such movements will approach the protein to the final conformation. To guide the trajectory toward the final structure, without introducing arbitrary energy restraints, we have implemented a Maxwell Demon biasing algorithm () with a control magnitude () defined as follows:where N is the total number of residues, B is the target structure, X is the sampled conformation (X  A for the original conformation) and !(i) is an optimized weight function dependent on the inter-particle distance and the size of protein (Supplementary; results are robust to ! values in the range 1525 A  are used). Following the MDdMD procedure the bias toward the target structure is not introduced by an energy penalty, but using a less interfering informational criteria (). The scheme is simple and efficient, after a certain number of dMD simulation steps (time t) the value of the progress variable (; equation 2) is compared with that obtained in a previous accepted movement (t-t). The simulation fragment t-t!t is then accepted or rejected based on a simple Metropolis test (equation 3):where p is the acceptance probability, RMSd (X;t, B) is RMSd between structure sampled at time t(X) and target structure, is dynamically. Interaction potentials used in this study. (a) single well corresponding to a particleparticle non-bonded pair that does not change their distance during transition (E GO  0.5 kcal/mol, s  0.15 A  ). (b) Double well representing two states of particle radial distance that corresponds to two known structures (E GO  0.5 kcal/mol, D  0.10 A  ). (c) Example of how discrete metadynamics increases the potential energy of a pair of particles whose movement overlaps with the essential deformation space of the initial state and (d) the same situation but when the overlap is much lower adjusted to guarantee an acceptation rate of 70%, and the time frame (t) is typically 100 time steps. These large acceptance rates, combined with a weight function with a maximum at $15 A  enables the system to explore no so direct pathways that could lead to stressed structures and provides the best local geometries (Supplementary Figs S6 and S7). The presence of the Go-potentials of the target structure in the Hamiltonian avoids the need to increase when trajectory approaches the final target conformation.
RESULTSTo evaluate the power of GOdMD, we apply it to trace transitions between known equilibrium conformations of proteins. After analyzing protein data bank (PDB), we define a set of 94 transitions corresponding to 47 proteins showing two distinct conformations. This large benchmark set was extracted from a previous work in our group () and spans a wide range of proteins from 100 to 1000 residues, showing different shapes and secondary structure composition. The database contains no trivial conformational changes and some of the conformational transitions represent dramatic geometrical alterations in the structure of the protein, including refolding in some cases. Many of the transitions are coupled to the binding to small ligands (60%) and/or macromolecules (39%), which increase the difficulties to trace reasonable conformational transition pathways. Further analysis of the data set reveals that a significant fraction of the transitions (44%) correspond to open/ close ones, which can a priori generate hysteresis problems. Finally, 22% of the transitions do not align well [overlap (accumulated dot product) between top five normal modes and conformational transition is below 0.25] with the first five essential deformation modes detected from EN-normal mode analysis (NMA), i.e. that they will be very difficult to represent by simply activating movements along intrinsic deformation modes. Looking at different criteria () we consider 62 of the 94 transitions as difficult or very difficult to follow, which means that we are validating our method with the most exigent transition dataset available. GOdMD has been able to find reasonable pathways for all studied transitions, even those requiring large refolding processes. The algorithm can provide multiple transition trajectories, defining a scenario of multiple pathways, which fits better into the transition funnel theory (). Furthermore, no violations of covalent distances, nor steric clashes or chemical meaningless conformations are sampled during transitions, which are always smooth, without the presence of apparent discontinuities or hysteresis effects (Supplementary). PROSA () calculations performed in random conformations sampled during the different transition yields to native-like profiles (Supplementary Figs S9 and S10), indicating that we are not sampling unrealistic conformations along the transition. The method is extremely efficient, 460% of trajectories are finished in 52 min wall-clock time in a laptop computer (2.4 GHz Intel Core 2 Duo) and even the most difficult transitions are finished in 530 min in the same computer. We are working in a parallel algorithm to explore larger systems with similar efficiency.
Sampling known intermediate conformationsThere are a few cases in PDB of distinct conformations for a protein, where there is in addition to the start and end conformation a third structure, which is intermediate (at least in terms of RMSd) between the other two. Following Weiss and Levitt (2009) we can suggest that in general the third structure can be near a preferred passing point on the transition between the extreme conformations (i.e. we can consider an 'intermediate' in the transition). Thus, for the five cases where this putative intermediate is available, we determined transition paths between the two more diverse conformations. In all cases () we found smooth and reasonable transitions, which go in the direction of the putative intermediate, even for the most difficult cases, where simpler methods have serious difficulties. In small systems (Ribose Binding Protein, 5 0-NT), the transition passes through the putative intermediate. In larger systems, small RMSd deviations to the putative intermediate are much more difficult to obtain, partly because of noise introduced by the presence oflong connecting loops, and partly because the intrinsic difficulty of tracing large conformational transitions. Although some large RMSd values are obtained (due mostly to stochastic loop movements), the potentials used in GOdMD capture better intermediate states than other state-of-the-art morphing methods (Supplementary). However, it is clear that the simulation drives spontaneously the transition toward conformational regions close to the putative intermediate. PROSA profiles and TMScore () of both sampled and putative experimental intermediates are similar (Supplementary Figs S9 and S10 and Supplementaryfor details), supporting the quality of the transition path.
Non-linearity of the transitionsOne of the main caveats of biasing methods based on forcing a regular reduction of RMSd to the target structure (as most morphing methods) is that they force a linear transition path, that might be unrealistic (), and that does not provide information on the bottlenecks in the transition. Our method is able to detect non-linear transition pathways, and provides information on where are the bottlenecks, i.e. those points where the transition seems nearly stopped for long periods, and which correspond to regions of high rejection rate in the Maxwell Demon (Supplementary). Interestingly, the method is also able to disconnect local (measured as % of native contacts) to global transitions (measured by the RMSd to the target), showing how for some transitions local rearrangements happen first, while, on the contrary, for other transitions global movement is before local conformational rearrangements (). It is worth noting that, the physical nature of the method guarantees that the guiding engine (NMA-bias metadynamics and a Maxwell Demon here) finds conformational pathways that never explore regions of unrealistically large energy. This guarantees that along all the transitions we sample protein-like conformations (), avoiding sampling always linear pathways that can leads to strong local distortions.
Introducing experimental informationOne of the main advantages of our method is its flexibility, which makes very easy to introduce the effect of external perturbations in the transition, or to bias the trajectory by experimental information. To show the capabilities of our algorithm, we analysed the effect of ligand binding in a transition, and also illustrate how the existence of experimentally validated intermediate can be used to bias the transition towards preferred pathways. For the first purpose we studied three additional systems for which ligand binding is known to displace conformational equilibrium: D-Allose binding protein (1gud/1rpj), L-Leucine Binding Protein (1usg/1usi) and Osmo-protection protein (1sw5/1sw2). After running 10 simulations (five in the absence and five in the presence of the ligand), we observed that those trajectories containing ligand were less efficient to reach the final state (Supplementary Figs S12 and S13 for details). These are just 'prove of concept' calculations, but provide encouraging evidence that our simple and fast algorithm can capture qualitatively the effect of the ligand in altering conformational pathways. To explore the possibility to bias GOdMD transitions by using experimental information on intermediate we have repeated the study of the very difficult 1SU4 ! 1IWO transition () assuming that the intermediate structure 1VFP corresponds to a necessary pass-point in the transition. So, we decoupled our sampling methods to find the transition pathways that better accommodate this experimental information. With the same Hamiltonian defined by the end states (A, B; see Methodological Approach), the Maxwell Demon MD is now first referred to the experimental intermediate structure (1VFP) and then switched to the target structure (when sampling of intermediate structure is converged). With this protocol, we selected the path closer to the putative intermediate state I.shows the obtained results. A clear improvement on the sampling of I is observed, showing that while the potentialenergy surface is defined considering only A and B, the transition derived is fully compatible with the presence of the putative intermediate I. Note that the new bias introduced in the trajectory by the experimental restrain does not impact dramatically on the energy, and it even improves energy relaxation toward the final state ().
CONCLUSIONWe present GOdMD, a new method to trace conformational transition at the CG level. The method uses the fast CG dMD algorithm coupled to two biasing methods: (i) metadynamics adapted to follow proteins easiest deformation pattern, and (ii) a Metropolis-based Maxwell Demon algorithm. The method is fast and, contrary to many other approaches, always finds a smooth transition path when tested in a large dataset of transitions. Obtained trajectories maintain the covalent structure of the protein avoiding also unfavourable contacts, sampling intermediate structures with 'protein-like' properties, a clear advantage with respect to usual morphing schemes. The method is extremely flexible and can be easily adapted to introduce the effect of external perturbations in the transition or to bias the transition using experimental information. Limitations of the method are likely to be coupled to its CG nature that precludes the derivation of atomistic information on the transition. The approach is then expected to be especially powerful to obtain rough transition pathways that will be further refined by atomistic MD-based algorithms. A computer program implementing our method is publicly available as a web server at mmb.irbbarcelona.org/GOdMD.
The Author 2013. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
Exploration of conformational transition pathways at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from spontaneous hopping from one minimum to another is difficult, making unlikely to find a spontaneous transition. We decided then to bias the trajectory to guarantee enrichment of sampling along the transition path. For this purpose, we implemented here a complex biasing scheme designed to favor the transition, but avoiding the use of restrains that would guide the trajectory along arbitrary (and probably unrealistic paths). The first level of biasing is designed to move the protein far from the starting conformation, while the second level is designed to enrich biasing to approach the protein to the final conformation. For the interested reader, a flowchart of the algorithm is presented in Supplementary Figure S4. 2.2.1 Escaping from the initial minima We have implemented a discrete version of the metadynamics method (Laio and Parrinello, 2002) to guarantee that the system leaves the original minima. Metadynamics penalizes visits to the original well by raising gradually the energy of the well (i.e. by filling it; Fig. 1), which increases the chances of the system to escape from the attraction of the Go-potentials to the starting structure. As a consequence, as trajectory progresses sampling of the original conformation is less and less probable and system departs from the original conformation. Metadynamics is efficient as a method to escape from a minimum, but such a divergence happens in a random way, which can yield to unrealistic deformations when applied in an unsupervised fashion. To solve this problem, we have coupled metadynamics to an ENM (Emperador et al., 2008a; Orellana et al., 2010) in such a way that wells associated to inter-particle distances showing large changes along the first five essential deformation modes were filled faster than those associated to inter-particle distances that are not coupled to the essential deformation modes of the protein (Fig. 1). This strategy guarantees the exploration of alternative ways to escape from the original structure minima, while increasing the possibility to sample preferred pathways as defined by the essential deformation modes (first five are considered by default, but results are largely invariant in the range 310 modes (data not shown). Note that the ENM analysis is done only with the initial structure irrespectively of which the target structure is, avoiding the definition of too linear pathways. Note also that the full dMD simulations are done, which means that all the degrees of freedom (and not only the five preferred ones) are sampled.
P.Sfriso et al. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
Exploration of conformational transition pathways at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
