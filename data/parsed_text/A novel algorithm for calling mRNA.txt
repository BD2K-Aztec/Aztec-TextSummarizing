Motivation: N 6-methyl-adenosine (m 6 A) is the most prevalent mRNA methylation but precise prediction of its mRNA location is important for understanding its function. A recent sequencing technology , known as Methylated RNA Immunoprecipitation Sequencing technology (MeRIP-seq), has been developed for transcriptome-wide profiling of m 6 A. We previously developed a peak calling algorithm called exomePeak. However, exomePeak oversimplifies data characteristics and ignores the reads' variances among replicates or reads dependency across a site region. To further improve the performance, new model is needed to address these important issues of MeRIP-seq data. Results: We propose a novel, graphical model-based peak calling method, MeTPeak, for transcriptome-wide detection of m 6 A sites from MeRIP-seq data. MeTPeak explicitly models read count of an m 6 A site and introduces a hierarchical layer of Beta variables to capture the variances and a Hidden Markov model to characterize the reads dependency across a site. In addition, we developed a constrained Newton's method and designed a log-barrier function to compute analytically intractable, positively constrained Beta parameters. We applied our algorithm to simulated and real biological datasets and demonstrated significant improvement in detection performance and robustness over exomePeak. Prediction results on publicly available MeRIP-seq datasets are also validated and shown to be able to recapitulate the known patterns of m 6 A, further validating the improved performance of MeTPeak. Availability and implementation: The package 'MeTPeak' is implemented in R and C þþ, and additional details are available at https://github.com/compgenomics/MeTPeak Contact:
IntroductionCompared with DNA methylation, which is a well-established and extensively studied epigenetic phenomenon, m 6 A methylation in mRNA is still largely an uncharted territory. Recent surge of interest comes mainly as a result of two groundbreaking studies () that show high abundancy of m 6 A in >25% of transcripts in human and mouse cells. A number of subsequent studies have provided significant insights into the mechanism as well as the functions of mRNA m 6 A methylation. It is known now that the m 6 A methyltransferase complex, or the m 6 A writer, consists of Wilms' tumor 1-associating protein (WTAP), methyltransferase-like 3 (METTL3) and methyltransferase-like 14 (METTL14) (). Different from DNA methylation, m 6 A methylation is reversible and V C The Author 2016. Published by Oxford University Press.
i378This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (http://creativecommons.org/licenses/by-nc/4.0/), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com, i378i385 doi: 10.1093/bioinformatics/btw281 ISMB 2016 can be removed by m 6 A demethylase, or m 6 A erasers, such as the fat mass-and obesity-associated protein (FTO) (). In addition, the YTH protein domain functions as an m 6 A reader that recruits the binding of the m 6 A methyltransferase to mRNA (). The mRNA m 6 A methylation has been shown to play a role in mRNA stability, processing and translational efficiency (). These recent advances notwithstanding, the fact of wide-spread m 6 A in transcriptome suggests that m 6 A is potential involved in many other unknown biological processes. These recent breakthroughs of m 6 A are largely attributed to the development of the Methylated RNA Immunoprecipitation Sequencing technology, or MeRIP-seq (also known as 'm 6 A-seq'), which is designed to profile transcriptome-wide m 6 A sites. MeRIPseq is technically a synthesis of two well-established methods: chromatin immunoprecipitation sequencing () and RNA sequencing (RNA-seq) (). In MeRIP-seq, mRNAs are first fragmented into approximately 100-nucleotidelong fragments. A large portion of the fragments are immunoprecipitated by anti-m 6 A antibody and subsequently measured by highthroughput sequencing to form Immunoprecipitation Sequencing (IP) samples. In addition, input samples, which are used to measure the background mRNA abundance for the IP experiments, are generated by sequencing the un-immunoprecipitated mRNA fragments. To predict m 6 A sites, the IP and input reads are aligned to the transcriptome and the reads enrichment of IP over the combined reads in IP and input are assessed. To meet the computational needs for MeRIP-seq-based m 6 A peak detection, we previously developed the exomePeak R package (). Basically, exomePeak calculates the overall methylation degree by dividing the IP reads by the sum of IP and input reads. Given the hypothesis that all the IP reads at a particular location follow the same Binomial distribution, parameterized by the overall methylation degree, exomePeak computes a C test () to determine the methylation sites. Although exomePeak could achieve fairly robust m 6 A detection, there are still two major limitations. First, exomePeak does not model the reads variance within transcripts and across replicates. Usually, highly fluctuating read enrichments can be observed around an m 6 A site and in MeRIP-seq replicates. However, exomePeak assumes that the site regions share the same reads enrichment. Second, exomePeak ignores the dependency of reads enrichment along the mRNA transcripts and therefore could miss the true peaks with low enrichment or erroneously predict the noisy outlier as true peaks. To address these issues, we introduce in this article a new algorithm, MeTPeak. MeTPeak deploys a hierarchical beta-binomial model to model the variance of reads enrichment and a Hidden Markov Model (HMM) to account for the dependency of neighboring enrichment. MeTPeak is an opensource R package, where core heavy computation part of the algorithm is written in C .
Methods
Graphical representation of MeTPeakMeTPeak detects m 6 A peaks on each gene separately, where a particular gene is first divided into N mutually connected bins whose length is equal to the sequencing fragment L, MeTPeak models the reads dependency of the continuous bins by an HMM and the reads count in each bin by the mixture of Beta-binomial distribution. Now assume that there are M pairs of IP and input replicate samples. For bin n, let X mn denote the reads count in the m th IP sample and Y mn the counts in the m th input samples. We assume that the read counts follow the Poisson distribution aswhere S IP;m and S ctrl;m are the total reads (sequencing depth) in the m th IP and the m th input samples, respectively, and k IP;m and k ctrl;m are the respective normalized Poisson rates. Let Z n 2 1; 2 denote the unknown hidden methylation status, with 1 representing methylated and 2 otherwise. As shown in, given (1), the conditional probability of observing X mn given the total counts T mn  X mn  Y mn follows the binomial distributionwhere p n represents methylation degree at the n th bin, which is proportional to reads count in the IP over the total counts at bin n, I() is the indicator function. In addition, to model the read counts variances, p n is further assumed to follow a priori the Beta distribution, Pp n jZ n ; a; b where a  awhere C  CT mn  1=CX mn  1CY mn  1 is the normalization constant. It becomes clear from(4) that the parameters a and b are shared for all bins across the replicates and they function to model. Graphical Model of MeTPeak for a gene. N is the total number of bin s; M is the number of replicates; Xn;m is the observed IP reads and TN;m is the total number of observed reads in the m th replicate at the n th bin: P is the methylation degree; Z is a latent variable that denotes the meth ylation status; indicating whether this is a peak or not:where H  a; b; A; p;2.
Sites detection and parameter inferenceIdentifying methylation sites requires inferring the hidden methylation status variable Z and the model parameters H. However, given the non-linearity of the likelihood function (5), no closedform solution for the maximum likelihood estimators can be obtained. Alternatively, we turn to the expectation maximization (EM) framework for a numerical solution (). Furthermore, as the parameters for Beta-binomial distribution a; b are constrained to be positive, we device a barrier function and propose a constrained maximization procedure to achieve that goal. The EM algorithm estimates Z and H in an iterative fashion, where each iteration consists of an E step and an M step. In the E step, the posterior distributions of Z given an initial estimate or the previously computed parameters H old is calculated. To do so, the joint marginal PZ n ; X is first computed through the forwardbackward recursion algorithm (Supplementary Equation (911)), from which the conditional posterior distributions PZ n jX; H old  and P Z n1 ; Z n X; H old  can be subsequently obtained. In the M step, a new estimate of H new is obtained through maximizing QH; H old , which is a lower bound of l in (5) and has the expressionwhere qZ) is a shorthand expression of PZjX;H old . Among H, closed-form expressions can be obtained for A;p   and the detailed derivations are provided in Supplementary (S14S17). However, because the derivative of QH;H old  w.r.t. a;b  has no closed form and a;b  are constrained to be positive, an estimate of a;b  cannot be computed directly. To address this difficulty, we propose a constrained Newton's method, whose optimization objective is formulated as minimize  s s:t: FD hwhere s is an equivalent form QH; H old  containing only the terms w.r.t a; b  , D  a T ; b T  T h and F and h are the coefficients for the inequality constrains. To constrain D > 0 as desired, h is set to zero and F is set to a diagonal matrix with 1s as the diagonal elements; however, this general inequality constrain formulation allows inclusion of any linear constrains such as an upper limit on a; b  . The basic idea to solve (7) is to use a logarithmic barrier to make the inequality constrain implicit, i.e.where t > 0 is a parameter that sets the accuracy of estimation,where the estimation becomes more accurate as the t increases, m is the number of inequality constrains, and f T 1 ; :; f T m are the rows of F. Minimization of (9) can be carried out for each component separately and the parameters D k for the kth component for k 2 1; 2 is calculated iteratively aswhere J k and H k are the gradient and Hessian of (9) w.r.t. D k  a k ; b k   T : Specifically, the gradient has the formwhere F k and h k are elements in F and h that correspond to D k , q Z nk  PZ n  kjX, which is the posterior probability of Z n  k, and U     logC   ; and d k  F k D k  h k. The Hessian can be expressed aswhere S k is the Hessian for s in (10) with respect to D k , whose detailed form can be found in Supplementary Equation (2324). Taken together, the proposed MeTPeak algorithm can be summarized as follows:For every gene in the list Initialization: choose an initial random H Repeat: until the increment of likelihood in (5) 10 5 E step: use the previous estimate H m1 to update the posterior probability qZ n  in (6)
Results
Performance evaluation by simulationWe started by first evaluating the performance of the proposed constrained Newton's method for estimating the parameters a; b  by examining the goodness-of-fit to the mixture of Beta-binomials distribution. The results showed that MeTPeak can accurately fit the mixture under a variety of variance conditions (Supplementary). Then, we assessed the performance of MeTPeak using the simulated MeRIP-seq dataset where the true methylation sites were known according to the proposed generative model described in Section 2.1. The reads for each gene were simulated independently, where the count for each bin was generated according to the HMMbased Beta-binomial model. To obtain proper parameters for a and b that mimic the methylation sites, we examined the genes with methylation degree p n and fitted the Beta distributions from a real MeRIP-seq case-control study as shown in Supplementary. The estimated parameters for the site region was a 1 ; b 1  6; 2, with the mean of methylation degree p mean  0:75, the parameters for non-peak region were set to a 2 ; b 2   1; 5  ; and the proportion weight for the peak versus non-peak region was set to w  0:3; 0:7   : For each of the following experiments, MeRIP-seq reads of 1000 genes with methylation sites were simulated according to the above-defined parameters. Detection results of both MeTPeak and exomePeak were obtained and to evaluate the performance, areas under the receiver operating characteristic curves (AUCs) were obtained for both methods. Unless otherwise specified, two replicates were simulated for each experiment.
MeTPeak is robust against data varianceWe first investigated the detection robustness of MeTPeak by considering different variances of data because in the real MeRIP-seq datasets, the reads variation in peak regions across these replicates can vary dramatically. Particularly, a number of beta distributions of peak regions with variances designed to range from 0.014 to an extreme high level 0.134, corresponding to a; b   0:3; 0:1   ; were simulated to generate reads, where p mean  0:75 was held for each case. The AUC curves inshow that MeTPeak was highly robust against the change of variance and achieved close to >95% AUC even at the highest variance. In contrast, the performance of exomePeak clearly degraded with variance and at the highest variance level, it dropped >20% in AUC and more than four times than MeTPeak. This is because exomePeak assumed that the methylation degree from all the sites are the same, which obviously violates the real case of MeRIP-seq data.
MeTPeak is robust for small replicatesWe next evaluated the influence of MeRIP-seq replicates on the detection performance. Usually in the MeRIP-seq experiments, it is hard to get more than four biological replicates, and robustness under the condition for small replicates is useful for the peak-calling algorithms. Simulated data with the number of replicates varying from 1 to 12 were generated under two variances conditions and results are shown in. AUCs of both methods increased with the number of replicates. However, MeTPeak was robust and achieved about 5% and 10% more AUC than exomePeak even with one replicate at low and high data variance, respectively. In addition, even under the condition of high data variance, with more than four replicates, MeTPeak could excel the AUC of exomePeak in low data variance. In contrast, exomePeak can barely reach that of MeTPeak at high variance despite the increase of replicates. This improvement of MeTPeak is mainly owing to careful modeling of reads variance and replicates.
MeTPeak is robust against data outlierWe next considered a specific case in which MeRIP-seq data contain reads outlier, a scenario where counts in some replicates were significantly larger than those in the remaining replicates. In such case, because exomePeak is likely to produce erroneous predictions because its decision is based on the average counts of all the replicates, and the outlier reads could significantly skew the true distribution of the reads, leading to erroneous predictions. To evaluate the impact of reads outlier on MeTPeak performance, we simulated a case with four replicates and three samples were generated with parameter a; b  6; 2 for the methylation peaks, whereas in the fourth, outlier sample, peaks were simulated from different locations and reads counts in peak regions were made to artificially vary from 1 to 15 times of the averaged counts of peak regions in the other three replicates. As shown in, the performance of exomePeak drops significantly with the increase of outlier counts. In contrast, MeTPeak performance is highly robust ($95% of AUC) against different levels of outlier.
MeTPeak is sensitive to lowly enriched peaksFurthermore, we examined the detection sensitivity, especially for lowly enriched peaks. We simulated the data with varying methylation degree from a low methylation degree with p mean  0:33, to aMeTPeak: novel m 6 A peak calling algorithm i381 highly enriched with p mean  0:89. The result is depicted inand it demonstrates that at all tested methylation degrees, MeTPeak outperformed exomePeak for detecting lowly enriched peaks. Even at an extremely low methylation degree of p mean  0:33, a scenario where the read counts in IP samples are half of that in input samples, MeTPeak still can achieve >70% AUC, about 5% higher than exomePeak. This improvement by MeTPeak in detecting lowly enriched peaks demonstrates the advantage of modeling the dependency of reads.
Performance evaluation using real MeRIP-seq datasetsTo further validated MeTPeak, we applied it to real publically available MeRIP-seq datasets. The first two MeRIP-seq datasets are from the study of the function of FTO, where FTO is a demethylase that functions to remove m 6 A methylation. In this study, FTO was knocked out from mouse midbrain cells, and the MeRIP-seq datasets before (wildtype or WT-FTO) and after knock-out (KO-FTO) were obtained (). We should expect an increase of m 6 A methylation after FTO knockout. The other four datasets come from the experiments that studied the roles of the components in human methyltransferase complex, namely METTL3, METTL14 and WTAP. The datasets include MeRIP-seq samples from the wildtype HeLa cells (WT-HeLa) and HeLa cells after knocking out each of the three proteins (KO-METTL3, KO-METTL14 and KOWTAP) (). In this case, we should expect a decrease of m 6 A methylation in knockout cells. The datasets were downloaded from Gene Expression Omnibus under the accession number GSE47217 for KO-FTO experiment and GSE46705 for the others. The dataset of WT-FTO (KO-FTO) includes three replicates for each of WT-FTO IP samples (KO-FTO IP) and WT-FTO input samples (KO-FTO input). Each dataset of KO-METTL3, KOMETTL14 and KO-WTAP has two IP and input replicates and WTHeLa has four replicates, respectively. For all the samples, reads were aligned to the corresponding transcriptome (UCSC mm9 or UCSC hg19) by TopHat2 (). After quality control (QC > 30), the depth of the samples was normalized to the geometric mean. We assessed the prediction specificity of MeTPeak and exomePeak by evaluating their false positives (FPs), i.e. the percentage of falsely detected peaks among all un-methylated peaks. To calculate false-positive rates, we need to know the true unmethylation peaks, which however were not readily available. To circumvent this difficulty, we created artificial datasets, where for each dataset, we replaced input (or IP) samples by a subset of IP (or input) replicate samples and treat them as pseudo input (or IP) samples for a particular condition WT (or KO). Because the IP and input samples in each artificial dataset are replicate samples from the same IP (or input), there should not be any reads enrichment and thus any detected peaks should be FPs. Eight artificial datasets were generated as WT-FTO IP versus WT-FTO IP, WT-FTO input versus WT-FTO input, KO-FTO IP versus KO-FTO IP, KO-FTO input versus KOFTO input. Each dataset can be manipulated to generate two pseudo datasets by the strategy of using IP versus IP and input versus input (i.e. WT-FTO IP versus WT-FTO IP, WT-FTO input versus WTFTO input). Therefore, a method has higher specificity if it detects less number of m 6 A sites across all these artificial datasets at the same FDR threshold. To evaluate the specificity at different detection thresholds, a series of FDR thresholds (0.000010.1) was evaluated for both MeTPeak and exomePeak. At a particular FDR, a ratio of FPs (RFP) was computed as number of FPs by MeTPeak divided by that by exomePeak. MeTPeak will have higher specificity if RFP < 1.shows the RFPs for the artificial datasets from WT-(KO-) FTO and WT-(KO-) METTL14 datasets; the results of the rest datasets can be found in Supplementary. We can see RFPs are always less than one for all FDR thresholds in all 12 tested datasets. On average, MeTPeak has three times less FPs than exomePeak at any given FDR threshold. For exomePeak, even at FDR threshold of 0.00001, it still reported about more than 10 times more FPs than MeTPeak did. These results suggest that MeTPeak has a consistently higher specificity than exomePeak.
Prediction results on real MeRIP-seq datasetsAfter comprehensive evaluation of MeTPeak performance on both simulation and real datasets, we analyzed the MeTPeak predictions on those six MeRIP-seq datasets to investigate context-specific and common characteristics of m 6 A methylation sites. The results for WT(KO)-FTO and WT(KO)-HeLa(METTL14) are shown in(see Supplementaryfor results for KO-METTL3 and KOWTAP). On average, 13 172 m 6 A sites were detected by MeTPeak (FDR < 0.05), whereas the number of detected peaks by exomePeak is 16 691. Although in all datasets, exomePeak reports more peaksthan MeTPeak, exomePeak commits far more FPs as demonstrated in Section 3.2. As a result, MeTPeak is likely to produce more reliable m 6 A sites. Besides, we carefully examined the methylation sites in IGV2.1 (). We found that some obvious methylation sites were missed by exomePeak (see gene Tgfbr3 in), while a lot more unlikely methylated loci were reported as methylation sites, as the read count was extremely small (see gene Ccdc60 in). It takes MeTPeak about 3$4 hours to predict m 6 A sites for the datasets with three replicates on an ordinary desktop (see detailed runtime analysis in Supplementary). To further validate the methylation sites identified by MeTPeak, we searched the m 6 A motif in the sequences of detected peaks. It has been shown in () that 'GGAC' is the most significant consensus sequence. Therefore, we extracted the sequences of the top 5000 most enriched peaks ranked according to FDR for each algorithms using BEDTools () and searched 'GGAC' motif in each one of these sequences, where the distance from the location of the identified motif to the center of the peak was computed. The distributions of the distance for WT-FTO and WT-HeLa are plotted in(See Supplementary S6 for other datasets). We can see that the distribution of MeTPeak is peakier, indicating that 'GGAC' motif is closer to the center in the MeTPeak detected peaks, demonstrating again higher accuracy in the detected methylation site. Next, we investigated the m 6 A fold enrichment, defined as IP reads count divided by input reads count in the peak region. The distributions of fold enrichment of the identified peaks are plotted inand Supplementary. The figures show that the distribution of fold enrichment for MeTPeak is significantly higher than that for exomePeak (Welch t-test, P < 2.2e-16). The results show that MeTPeak is robust to the reads variance and favors peaks with higher fold enrichment than exomePeak, demonstrating the advantages of modeling variances for the read counts. We next examined the shared m 6 A peaks between WT and KO conditions in these four MeRIP-seq datasets to evaluate theMeTPeak: novel m 6 A peak calling algorithm i383 enrichment change of the common methylation sites. There are 11 534 common m 6 A peaks reported by MeTPeak in WT-FTO and KO-FTO datasets; for KO-METTL14, KO-METTL3 and KOWTAP datasets, we found 6170, 8256 and 6067 m 6 A peaks, respectively. Later, we extracted the fold enrichments for the shared m 6 A peaks and differential ratios were computed by using fold enrichment in the treated condition divided by that in the WT condition. The boxplots of differential ratios for each group of MeRIPseq datasets are shown in. In KO-FTO dataset, both the median and mean are above zero, meaning that methylation sites detected in KO-FTO have higher fold enrichment than that in WTFTO, which is consistent with the fact that knocking out FTO would lead to increased methylation because FTO is an m 6 A demethylase. In contrast, in the other datasets, KO-METTL14/METTL3/-WTAP leads to less methylation in the treated conditions, which is again consistent with the fact that METTL4, METTTL3 and WTAP form the m 6 A methyltransferase complex. Interestingly, KO-METTL14 and KO-WTAP introduce more significant reduction of methylation than KO-METTL3. Indeed, it has been reported that both METTL14 and WTAP have a larger impact on m 6 A level than METTL3 (). We also assessed the sequence motif of the detected m 6 A peaks. For each MeRIP-seq dataset, DREME () was used for each dataset separately and the results are shown in. The enriched motifs from these datasets all contain 'GGAC' motif. Then, we examined the distributions of m 6 A peaks. As shown in, in all cases, the distributions in mRNAs are consistent with the previously reported general distribution of m 6 A (), where a clear enrichment can be seen around the stop codon. In addition, the distributions on lncRNA are also examined in. This consistent pattern of m 6 A distribution in mRNA and lncRNA across different cell lines and species suggests that the m 6 A methylation is likely regulated by a similar mechanism. Note that the distributions of KO-M14 and KO-WTAP are somewhat different from
ConclusionWe presented MeTPeak, a novel graphical model-based peak calling method for detecting m 6 A sites from MeRIP-seq data. We formulated the m 6 A peak calling problem as an inference of the mixture of binomial distributions by introducing a hierarchical layer of Beta distribution to model the variances among m 6 A sites in replicates. We also used HMM model to capture the reads dependency among the bins. To find the solution to the inference problem, we proposed a constrained Newton's method for estimating the Beta parameters and developed a fast inference mothed for estimating the m 6 A peaks. The method is suitable for processing MeRIP-seq data with replicates and high variance, which are common cases in MeRIP-seq data. We have compared MeTPeak with exomePeak both on simulated and real MeRIP-seq datasets and the results showed that MeTPeak is highly robust against the data variances and outliers and making far less FPs than exomePeak. Finally, prediction of MeTPeak on real MeRIP-seq datasets have suggested that it precisely recapitulates the motif and distribution of m 6 A sites, as well as correctly predicting the methylation differences among these methyltransferases, demonstrating the validity of MeTPeak.
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
MeTPeak: novel m 6 A peak calling algorithm i379 at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
