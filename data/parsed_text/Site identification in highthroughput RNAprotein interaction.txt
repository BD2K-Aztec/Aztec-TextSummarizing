Motivation: Post-transcriptional and co-transcriptional regulation is a crucial link between genotype and phenotype. The central players are the RNA-binding proteins, and experimental technologies [such as cross-linking with immunoprecipitation-(CLIP-) and RIP-seq] for probing their activities have advanced rapidly over the course of the past decade. Statistically robust, flexible computational methods for binding site identification from high-throughput immunoprecipitation assays are largely lacking however. Results: We introduce a method for site identification which provides four key advantages over previous methods: (i) it can be applied on all variations of CLIP and RIP-seq technologies, (ii) it accurately models the underlying read-count distributions, (iii) it allows external covari-ates, such as transcript abundance (which we demonstrate is highly correlated with read count) to inform the site identification process and (iv) it allows for direct comparison of site usage across cell types or conditions. Availability and implementation: We have implemented our method in a software tool called Piranha.
INTRODUCTIONOriginally thought simply to be a vehicle for the transport of genetic information, RNA has come to be seen as a crucial nexus for eukaryotic diversity and control of expression (). The mechanisms which govern this are diverse and include splicing, localization, polyadenylation and the control of both transcript stability and abundance. RNA-binding proteins (RBPs), which associate with RNA through specialized protein domains called RNA-binding domains, drive these processes. The activities of these proteins can be complex and involve not only other proteins but also other RNA species (). The functions of some RBPs are so essential that perturbation of their activity can lead to remarkable phenotypic changes (Chenard). Understanding the functions and mechanisms of the many RBPs is one of the key challenges currently facing cellular biology. Despite tremendous recent progress, there are still many unanswered questions (). Perhaps the most direct approach to profiling these interactions is the immunoprecipitation of the RBP of interest through a process similar in principle to chromatin immunoprecipitation (ChIP). Modern high-throughput immunoprecipitation assays for proteinRNA interaction can trace their lineage back to RIP-chip, an array-based assay (). Cross-linking with immunoprecipitation (CLIP) extended upon the success of RIP-Chip by introducing ultraviolet cross-linking of the protein to the RNA and more stringent washing to increase specificity, though potentially at the cost of reduced sensitivity (). More recently, CLIP has been coupled with high-throughput sequencing (HITS-CLIP) to enable a much greater range and depth of coverage (). Further improvements to allow single-nucleotide resolution have been achieved by iCLIP () and photoactivatable-ribonucleoside-enhance CLIP (PAR-CLIP) variants (). There are substantial challenges to be overcome in terms of the effective analysis of CLIP-seq data however. In this article, our focus is on-site identification (or, peak-calling), which is the crucial step that follows mapping of reads to a reference and deals with identifying those genomic locations that are true protein interaction sites. For simplicity, we refer to this step as site identification regardless of the resolution. That is to say, the process may be as coarse-grained as calling target transcripts or as fine-grained as identifying sites at a single-nucleotide level. We begin by outlining three key challenges in RBP site identification. The first is intrinsic to the peak-calling process: many sites to which reads map only receive a very small number of reads and are likely noise. The levels of noise may be far from negligible and have multiple causes. The sequenced sample may contain RNA that has not been cross-linked to a protein or alternatively that was cross-linked to some different protein, but pulled down through antibody cross-reactivity. In addition, *To whom correspondence should be addressed.  The Author 2012. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com reads can map to non-target transcripts due to sequencing errors or mapping problems. Effective use of the data requires separating these noise sites or false positives, from functional sites. Most studies, explicitly or implicitly, assume read counts at individual sites, follow a particular distribution and use this distribution to determine the probability of seeing a given number of reads at a site by chance. However, there has been no large-scale analysis of CLIP-and RIP-seq data to determine the most appropriate choice of distribution to model these counts. The second challenge is somewhat more esoteric. The proportion of total reads falling in a given transcript does not give the probability of that transcript being a target, but rather informs the probability that a bound RNA is of that transcript. No knowledge of the number of unbound copies is available and hence the RBPs preference for that transcript is not directly discernible. This is true at higher resolutions also. Reads accumulate in transcripts in proportion not only to the RBPs preference for that transcript but also the transcript abundance. This is in contrast to ChIP, where there is (in general) no variation in multiplicity between different parts of the genome. The final challenge we consider is that of incorporating external information into the peak-calling process. There are a number of types of external information, but here we consider what is essentially control data. We give details of other external information in Supplementary Material. Previous studies involving CLIP-seq data have applied a range of different approaches to site identification. Because of the high fidelity of the CLIP assay, it is possible to side step the problem and retain all sites (). This does not allow for the filtering of noise interactions. Another simple approach is to take the top n sites under some scoring, such as normalized read count. This requires selecting a threshold, usually arbitrarily and clearly prevents comparing the number of sites between RBPs or conditions (). More sophisticated methods employ a simulation of the CLIP-seq experiment assuming no site-specific preference and use this to arrive at a false discovery rate for any given peak height (). Although this allows for consideration of transcript abundance, there is no mechanism to explicitly adjust for other sequencing biases and the approach is not applicable to situations, where a second condition or control is available (e.g. RIP-seq). Finally, some site identification methods intrinsically consider information specific to a particular immunoprecipitation assay (). Although these have been highly successful, they cannot be applied in the more general setting. Several databases of CLIP-seq data also exist, for example CLIPZ, StarBase and doRiNA (). The latter two focuses on microRNA (miRNA)RBP interactions. CLIPZ and StarBase group reads into clusters but do not perform any further site identification. In contrast, doRiNA uses a site identification strategy for PAR-CLIP that relies upon T to C conversions at the cross-link site, but is unable to automatically score or rank sites from RIP-seq or other CLIP-seq variants. We present a method for site identification that is applicable across the three commonly used CLIP-seq variants and in addition can be applied to RIP-seq data (for which, to our knowledge, no peak-calling tools currently exist). Our method addresses each of the three challenges outlined earlier: effectively modeling the underlying distribution, utilizing transcript abundance information and flexibly allowing the incorporation of external data. Further, we demonstrate how such a tool can be applied to answer more advanced biological questions regarding RBP binding sites that vary in usage between different cell types, conditions or stages of development.
DataWe compiled all CLIP-seq (HITS, iCLIP and PAR-CLIP) datasets that were publicly available at the time of writing (see). In addition, we analyzed a previously unpublished HITS-CLIP dataset for Ago2/ miR-124 and a RIP-seq dataset for hTra2, which we briefly describe. For the identification of miR-124-guided Ago2 binding sites by CLIP, 5 cm  15 cm plates of 293S cells at 70% confluency per condition/replicate were used. Cells were transfected for 24 h with 100 nM mir-124 siRNA (5 0-UAAGGCACGCGGUGAAUGCCA-3 0 and 5 0-GCAUUCACCGC GUGCCUUACA-3 0 duplex) or control gl3.1 siRNA (5 0-CUUAC GCUGAGUACUUCGAUU-3 0 and 5 0-UCGAAGUACUCAGCGUA AGUU-3 0 duplex) using Mirus Trans-IT TKO. The CLIP procedure was carried out by a modified protocol ofas described in Supplementary Material. The RIP protocol used for hTra2 is as follows: 400 ml of Protein A sepharose (50% slurry) was washed five times with NT2 buffer (50 mM TrisHCl pH 7.4, 1 M TrisHCl, 150 mM NaCl, 1 mM MgCl 2 , 0.05% NP40) and resuspended in 1 ml of NT2 plus 5% BSA and 10 mg of rabbit anti-hTRA2B (Abcam) or normal rabbit IgG. Beads plus antibodies were incubated overnight at 4 C with rotation and washed five times with cold NT2 buffer. Lysates were prepared from semi-confluent HeLa cells in polysomal lysis buffer (10 mM HEPES pH 7.0, 100 mM KCl, 5 mM MgCl 2 , 0.5% NP40, 2 mM dithiothreitol) containing proteinase and RNA inhibitors. After centrifugation for 10 min, supernatant was adjusted to 2 mg/ml and 6 ml of lysate were combined with the bead/ antibody and rotated at room temperature for 35 h. Beads were washed five times with cold NT2. After last wash samples were digested with RNase III; 4 ml of RNaseIII (Ambion) were combined with 600 ml of 1 buffer, added to samples and incubated for 30 min at 37 C with agitation. Beads were recovered by centrifugation and washed three times with NT2 buffer. Proteins were extracted with 25 ml (20 mg/ml) proteinase K in 600 ml of 1 buffer at 50 C for 30 min. Samples were vortexed for 1 min and beads pelleted by centrifugation. The supernantant was extracted with 700ml of acid phenolchloroform and precipitated with sodium acetate and isopropanol. RNA was recovered by centrifugation, washed and resuspended in 13 ml of RNase free water. Quantity and quality were checked with Nanodrop and Bioanalyzer. Fifty nanograms of RNA were amplified using Nugen Ovation RNA-seq System I and libraries prepared with the Nugen Encore NGS Library System I per manufacturer's protocol. To adjust for transcript abundance, we also make use of RNA-seq data for HeLa cells () and HEK293 cells. All previously unpublished sequence data have been deposited into the sequence read archive (SRA), accession numbers: SRA056343, SRA056308, SRA056344.
Pre-processingFor each dataset, we trimmed adapters and mapped to an appropriate reference genome (full genomehg19 or mm9) and junction database using rmap (). Transcripts were defined per the University of California Santa Cruz (UCSC) genome browser knowngenes track. We allowed up to three mismatches when mapping and retained only reads that unambiguously mapped to a single location. Junction reads were split and assigned to both side of the junction. Full details of the mapping results are given in Supplementary Material. Our method does not depend on any particular mapping or pre-processing strategy. Research is ongoing with respect to the most effective methods for mapping RNA reads and will be further spurred on as immunoprecipitation-based assays are paired with emerging sequencing platforms promising longer read lengths. Coupled with an effective choice of mapping and pre-processing techniques, our site identification method will remain relevant.
Peak findingThe input for site identification is a set of reads mapped to the reference genome. All reads are binned based on the nucleotide at which they begin. A bin represents a genomic interval and can be single nucleotide in width. Appropriate choice of bin size is dependent on depth of coverage and technology used (see Section 3.3). Let y i be the count of the number of reads which start in the ith bin. Each bin optionally has an associated vector of covariates, which we denote x i !. A covariate is a measure of some property that is expected to vary in parallel with the immunoprecipitation read counts, but need not be count data. An example is mappability of the bin, a measure of how many locations within the bin start sequences of length equal to the read length, which are not duplicated elsewhere in the genome and hence can be non-ambiguously mapped to. Bins with low mappability are expected to correlate with lower read count. We model the read counts within bins using a zero-truncated negative binomial distribution (see Section 3.2 for justification). Read counts from high-throughput immunoprecipitation experiments are Poisson over-dispersed. The negative binomial is an appropriate choice of distribution for dealing with Poisson over-dispersion, but does not correctly handle the adjusted weight for zero observations. One option is to use the zero-inflated negative binomial, as was adopted by the zero-inflated negative binomial algorithm (ZINBA) for peak calling in ChIP-seq data (). However, the zero-inflated negative binomial assumes a mixture, where a certain number of zeros are drawn from the negative binomial component (and the remainder from the zero-inflated component); this does not genuinely reflect the true underlying distribution, which does not produce zeros. Moreover, the additional complexity makes model fitting more difficult and time consuming. Instead, we retain only those bins with one or more reads mapping. We discuss this further in Supplementary Material. The zerotruncated negative binomial (ZTNB) has the following log-likelihood function:Lj, y  L NB j, ywhere m is the (un-truncated) mean, is the dispersion parameter and L NB j, y is the log-likelihood of the non-adjusted negative binomial, that isWe fit the model by finding the maximum likelihood estimates for m and. We assume that the majority of sites with reads are low-occupancy or noise sites (see Section 3.2 for details and justification) and so the fit model represents a background. At an abstract level, our method is modeling the read-count distribution of the dataset, which is an acceptable proxy for the background noise distribution. We then look for locations with read counts that are unexpectedly large based on this theoretical distribution. To do this, after model fitting, each bin is assigned a P-value by subtracting from 1 the sum of densities for all values less than the read count associated with that bin. Significant bins can then be selected by a P-value threshold; the smaller the P-value, the more unlikely the read count in the bin is given the fit distribution. When additional external data (covariates) are available, we use a zero-truncated negative binomial regression (ZTNBR) model (). Briefly, this requires replacing the scalar parameter m with a vector ~ , where each i  exp ~ T x i !  and ~ is the vector of regression coefficients. The model is fit using a Newton Raphson algorithm for the estimation of the regression parameters and a dispersion dampening algorithm for estimating (). Each bin is assigned a P-value in the same way as previously described. A short illustration of applying the regression model to calculate P-values is given in. Notice how large read counts do not necessarily lead to significant P-values. A full description of the model, its derivation and fitting is provided in Supplementary Material.
Implementation and post-processingOur method has been implemented in a software tool called Piranha. When no covariates are provided, it will fit a ZTNB model. If covariates are provided, it will fit a ZTNBR model. Input may be either raw reads in browser extensible data (BED) or binary sequence alignment/map (BAM) format, or pre-binned read counts in BED format. Covariates are provided in BED format. Output is in an extended BED format, where an additional column gives the P-value. The implementation and instructions for its use are given at http://smithlab.usc.edu For the analysis in this article, we adjust output P-values to correct for multiple hypothesis testing using the method of Benjamini and Hochberg (1995).
RESULTS AND DISCUSSION
Alternative methodsTwo recent approaches have been proposed specifically for addressing the problem of site identification in CLIP-seq data (). Zhang's method works on HITS-CLIP data and employs cross-linkinginduced mutation sites (CIMS, primarily deletions) to refine site location, while PARalyzer is designed for PAR-CLIP data and relies on T to C conversions at the cross-link site. In contrast, the method we propose works on all CLIP-seq variants (iCLIP, PAR-CLIP, HITS-CLIP), as well as RIP-seq, while still being able to consider the positional deletion and mutation information used in these two methods as covariates. Further, our method allows the consideration of additional covariates (such as transcript abundance, which we demonstrate impacts read counts considerably). Moreover,found that deletion events occur only in $820% of mRNA tags, meaning a substantial proportion of reads would not be informative, while our method can take advantage of all the mapped reads in each study. PARalyzer is publicly available and we compare its performance to our method (details of usage are in Supplementary Material); The CIMS-based method has no public implementation at the time of writing.
Read counts follow a zero-truncated negative binomial distributionFor each dataset, we estimated the parameters of a zerotruncated Poisson, negative binomial and zero-truncated negative binomial distribution for the counts when binned at single-nucleotide resolution.and B shows visually the improved fit provided by the ZTNB when compared to the NB; both panels show the average density of the real data in red and all of the fit densities for the NB and ZTNB in blue and green, respectively. To validate the improvement seen visually inand B we conducted a set of Pearson's 2 tests. For 90.8% (109 of 120) of the datasets, the Pearson's 2 test showed that the zero-truncated negative binomial provides a superior fit to a Poisson, zero-truncated Poisson or regular negative binomial distributions (seefor an example and Supplementary Table S2 for the complete set of results from the 2 tests). The majority of sites with reads mapping are low-occupancy or noise sites (); in most of the datasets analyzed, 480% of locations with reads mapping saw 55 reads. Theoretically, read counts at sites are a mixture, with some drawn from a foreground distribution and some from a background noise distribution. In practice, though the mixing parameter is so heavily weighted toward the background that parameter estimates for the whole data closely approximate the background component. This is one reason that we eschew fitting a mixture and instead prefer the simpler single distribution.
Read count is correlated with transcript abundanceThe most common approach for site identification is a threshold. Applying a single threshold across the whole transcriptome is problematic since it does not consider transcript abundance. To quantify this, we compared RNA-seq data from HeLa and HEK293 to those IP experiments conducted in these cell lines. We observed a substantial positive correlation between RNA-seq read counts for a transcript and IP read counts (seefor the distribution of correlation coefficients andfor an example dataset), with an average correlation coefficient of 0.36 over the 85 datasets examined. We also compared 200 nt bins (see) to ascertain the extent to which this relationship holds at a more fine-grained level. Here, we observed a lesser, but still substantial degree of correlation, with an average correlation coefficient of 0.16. To address the problem of varying transcript abundance, we incorporate an RNA-seq control into our peak calling by supplying it as a covariate for the ZTNB regression method of Piranha. For this analysis, we considered a bin size of 200 nt, as was used earlier. An appropriate choice of bin size is dependent on the technology used and sequencing depth. Here, we have opted to select a bin size that allows us to capture the correlation between IP and RNA-seq given the level of coverage we have and is generally appropriate across all of the technologies profiled. The number of experimentally verified binding sites for any given RBP is currently too low to realistically be used as a gold standard for peak calling. Instead, we turn to motif enrichment as a measure of accuracya similar approach was taken by Zhang and Darnell (2011). To be agnostic of existing characterizations of an RBPs motif, we perform de novo motif discovery for each dataset and consider the top enriched motif to be theThe average read count density for all datasets is shown in red (error bars are 95% confidence interval). The fitted densities for a negative binomial on all of the datasets is shown in blue (note that all densities are shown, rather than an average for each read count). Only read counts 520 are shown. (B) As with (A), but replacing the fit densities from the negative binomial with those of a zero-truncated negative binomial distribution. (C) Histogram of read counts from an iCLIP experiment for TIA1 () showing fit zero-truncated Poisson, negative binomial and zero-truncated negative binomial distributions. (D) Histogram showing the count of datasets for which 80% of the locations receiving reads have no more reads than the given count; the majority of datasets have 480% of their locations with 55 reads. Four outliers are not shown, with read counts of 79, 93, 88 and 228 correct one. For motif discovery, we use the DME algorithm (). Full details of the scoring method used are given in Supplementary Material. We observed an average 11.6% improvement in motif score on the examined datasets when using the ZTNBR with RNA-seq covariate over the regular ZTNB (P55.9  10 3 , Wilcoxon test), demonstrating that inclusion of this additional data can improve site identification. We compared the performance of our method to PARalyzer, the only other publicly available site identification tool for CLIP-seq data. On PAR-CLIP datasets (which it is designed for), PARalyzer scores are on an average 3% better than ZTNB; however, the difference is not statistically significant. On an average the ZTNBR with transcript abundance covariate scores 17.2% higher (P50.002, Wilcoxon test). Full details are given in Supplementary Material.
Incorporating general external information3.4.1 Using non-specific antibody controls in RIP-seq data RIP-seq is not as specific as CLIP-seq, but is a more sensitive assay. An additional immunoprecipitation experiment using a non-specific antibody acts as a control. The appropriate use of this control in a statistically sound and robust fashion is essential for site identification in RIP-seq data; to our knowledge, no tools currently exist for this task. Piranha is able to use the non-specific antibody control as a covariate when calling peaks. We applied our method to a RIP-seq dataset for hTra2, a ubiquitously expressed member of the serine/argenine-rich protein family. hTra2 functions as a splicing regulator, with its aberrant activity implicated in several diseases (). The canonical hTra2 binding site is the (GAA) 2 repeat (). We provide the non-specific antibody control as a covariate to our zero-truncated negative binomial regression method. After selection of those sites which are significant, we performed de novo motif detection. The top identified motif enriched around the sites we identified is a match for the previously known (GAA) 2 motif and shows preferential localization near significant RIP-seq sites (see). To determine whether the use of the non-specific antibody improves performance, we also ran Piranha without this extra input. Although the motif found is the same, we observe an increased occurrence around sites identified when using the non-specific antibody control. This demonstrates that our peak-calling tool can successfully be applied not only to CLIP-seq but also RIP-seq data. Full details of the hTra2 analysis, including identified sites, are given in Supplementary Material.
Identification of differentially used binding sitesAnother challenge is the identification of sites which are differentially bound between tissue types or conditions. Our method allows for such a comparison by considering read counts in the first tissue/condition as a covariate of the second. Bins receiving significantly low P-values are enriched for binding in the second tissue/condition relative to the first. We applied this idea to a HITS-CLIP dataset for the RBP Ago2, which is part of a ribonucleoprotein complex that is predominantly MiRNA targeted. We transfected HEK293 cells with miR-124 (which is not endogenously expressed) and identify its targets by a comparison against non-transfected cells. We applied our method to this dataset (see Supplementary Material for full details) and identified a set of 318 locations enriched for binding upon miR-124 transfection (false-discovery-rate-corrected P50.05). This is comparable to the number of genes found to be down-regulated byupon transfection of miR-124. Performing de novo motif search on windows of 800 bp (400 upstream and 400 downstream) of these sites identified the motifs in. Our method identifies sites which are enriched for sequences that are complementary to the miR-124 sequence, supporting these as true miR-124 target sites. Further, the matching motifs arepositionally enriched around the cross-link sites, supporting their functional importance. Finally, we also show inthe number of sites that have a match to any 7-mer from the miR-124 complement around the identified sites; more than half the sites have a match within 45 nt of the peak centre. We compared this approach to simply calling sites separately in each condition using the ZTNB (without covariates) and then taking those sites which are significant in the miR-124 transfection, but not in the control. Using this approach, the top six enriched motifs match miRNAs other than miR-124; none of them is a match for miR-124. Further details are in Supplementary Material. Although here we have applied this to the problem of miRNA target site identification, the same approach could be used to identify differentially bound sites in any conceivable pair of tissues or conditions, an exciting research direction that promises to further expand our understanding of how RBPs participate in cell-fate determination and pathogenesis or for exploring RBP evolution by comparing across species.
CONCLUSIONHITS coupled with immunoprecipitation assays have provided an unprecedented level of accuracy in identifying the targets and binding sites for RBPs. Despite this, the data collected from such experiments require some considerable care to extract the most meaningful information from it. Within this article, we have highlighted three challenges that are presented when attempting to identify proteinRNA interactions sites in high-throughput immunoprecipitation sequencing data: selecting the correct distribution for modeling reads, dealing with the transcript abundance bias and incorporating additional external information into the peak-calling process. We introduced Piranha, a peak-calling tool based on the zero-truncated negative binomial regression model that is able to incorporate external information to guide the site identification process. We demonstrated that transcript abundance influences the read counts at sites in IP datasets, that Piranha can successfully incorporate RNA-seq control data to ameliorate this bias and that by considering this additional information, more accurate peak calls are arrived at. We also showed that our method can be applied across all of the currently existing CLIP-seq technologies and also handles the more complex case of RIP-seq data. Finally, we also demonstrated Piranha's application to more complex biological questions involving multiple cell types, conditions, stages of development or species.
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
P.J.Uren et al. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
Site identification in high-throughput RNAprotein interaction data at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
