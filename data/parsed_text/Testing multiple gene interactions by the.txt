Motivation: The multifactor-dimensionality reduction (MDR) method has been widely used in multi-locus interaction analysis. It reduces dimensionality by partitioning the multi-locus genotypes into a high-risk group and a low-risk group according to whether the genotype-specific risk ratio exceeds a fixed threshold or not. Alternatively, one can maximize the Ï‡ 2 value exhaustively over all possible ways of partitioning the multi-locus genotypes into two groups, and we aim to show that this is computationally feasible. Methods: We advocate finding the optimal MDR (OMDR) that would have resulted from an exhaustive search over all possible ways of partitioning the multi-locus genotypes into two groups. It is shown that this optimal MDR can be obtained efficiently using an ordered combinatorial partitioning (OCP) method, which differs from the existing MDR method in the use of a data-driven rather than fixed threshold. The generalized extreme value distribution (GEVD) theory is applied to find the optimal order of gene combination and assess statistical significance of interactions. Results: The computational complexity of OCP strategy is linear in the number of multi-locus genotypes in contrast with an exponential order for the naive exhaustive search strategy. Simulation studies show that OMDR can be more powerful than MDR with substantial power gain possible when the partitioning of OMDR is different from that of MDR. The analysis results of a breast cancer dataset show that the use of GEVD accelerates the determination of interaction order and reduces the time cost for P-value calculation by more than 10-fold. Availability: C++ program is available at
INTRODUCTIONAnalysis of genegene interaction is of great concern in modern genetic studies (). With a large number of genes, classical statistical methods such as the logistic regression and Pearson's  2 test may not be appropriate due to high degree of * To whom correspondence should be addressed. freedom involved (). Methods that can detect multi-locus interacting genes that may have been overlooked by a single-locus analysis are of central importance in genetic association studies. Multifactor-dimensionality reduction (MDR) is a non-parametric and model-free method that was developed for detecting highorder genegene interaction in the absence of marginal effects (). Operationally, the MDR method divides the multi-loci genotype combinations into high-and lowrisk groups according to whether the ratio of cases to controls exceeds a fixed threshold or not. As noted by, this is a constructive induction method that changes the representation space of the data by reducing/recoding the single nucleotide polymorphism (SNP) combinations to a single binary attribute. This results in a 2  2 contingency table and the sparsity and the high-dimensionality problems are greatly alleviated. The Pearson's  2 statistic is calculated but with P-value determined using a permutation procedure rather than from a  2 distribution with one degree of freedom (df). Empirical studies show that the MDR method is a useful tool for testing high-order genegene interaction (). Since it was proposed, the MDR method has been widely applied to multi-locus association studies (). Many efforts have been made to improve the power of MDR, such as the extended MDR (EMDR) of, modified MDR methods based on balanced accuracy (), likelihood ratio and normalized mutual information () or other evaluation measures (). Some other extensions of MDR such as the odds ratio-based MDR (OR-MDR;), model-based MDR (MB-MDR;), log-linear model-based MDR (LM-MDR;) and generalized MDR (GMDR;) were also developed. These extensions make the MDR more flexible in applications (). In recent years, many other data mining algorithms for detecting high-order genetic interactions such as classification trees, random forests and multivariate adaptive regression splines (MARS) have been proposed ().developed a powerful multi-locus parametric test based on Tukey's 1-df model of interaction.proposed the focused interaction testing framework (FITF). The performance of neural networks evolved from genetic programming is studied bycompared the performances of six methods for testing main effects and interactions. The six methodsPage: 1872 18711878
X.Hua et al.they considered are MDR, grammatical evolution neural networks, random forests, FITF, step-wise and explicit logistic regression.compared MDR with set association (), and random forests and suggested the use of a combination of existing multi-locus methods in genetic association studies.demonstrated that MDR is a special case of recursive partitioning (). Park and Hastie (2008) illustrated penalized logistic regression based on L 2 regularization used in interaction detection. The FlexTree algorithm () is also introduced along with their method.proposed to use a support vector machine and a combinatorial optimization method in genegene interaction detection. The MDR is originally designed for balanced casecontrol studies. It partitions the contingency table by collapsing multi-locus genotypes with risk ratios equal to or greater than the threshold 1 as high risk and others as low risk (for unbalanced casecontrol studies, the threshold is the ratio of the numbers of cases to controls). Such a partitioning strategy using a fixed threshold may not be optimal since it excludes many other possible ways of partitioning. Intuitively, a different threshold that yields a larger value of the  2 statistic could possibly lead to a more powerful test. In this article, we show that the optimal threshold for maximizing the  2 value can be obtained by using an ordered combinatorial partitioning (OCP) algorithm. Although our OCP algorithm maximizes over the ordered partitions only, which is what makes it computationally feasible, we prove that the algorithm has not missed anything important and will still give us the global maximal  2 that would have resulted from an exhaustive search over all possible partitions. We call the optimal partitioning produced by the OCP algorithm as the optimal MDR (OMDR). To reduce the computational burden of permutation in assessing significance and determining the order of interaction, we propose a procedure based on the generalized extreme value distribution (GEVD) approximation in the OMDR method. This article is organized as follows. In Section 2.1, the limitations of the partitioning strategy used in the original MDR are illustrated by a simple example. The OCP strategy is then proposed for partitioning a contingency table. The computational complexity of the OCP and the resulting OMDR are discussed. In Section 2.2, we introduce the GEVD approximation method for interaction order determination and significance assessment in the OMDR method. Simulation studies for comparing the MDR and the OMDR are conducted in Section 3. Finally, some discussions about the OMDR and the OCP method are given in Section 4.
METHODSIn Sections 2.1 and 2.2, we introduce the two key ingredients of the OMDR method, namely, the efficient exhaustive partitioning method, OCP, and the GEVD method in interaction order determination and the computation of a validity measure.
OCP methodMDR partitions multi-locus genotype combinations according to their risk levels based on a fixed threshold. Here, we review this strategy in detail and point out its limitations. Suppose that n dichotomous genes such as SNP markers (each gene has three genotypes) are considered for testing interactions. The 3 n genotype combinations of cases and controls can be summarized in a 23 n contingency table. One can calculate the ratio ofhave been deleted, and the columns are sorted into an ascending order according to the ratios. Based on the ordered contingency table, the MDR method labels each genotype combination as 'high risk' if its ratio meets or exceeds some chosen threshold (e.g. the fixed threshold 1 used in the original MDR in balanced casecontrol studies), or 'low risk' otherwise. Fixing the threshold beforehand is an attractive feature of the MDR method since this can reduce the computational expense substantially. However, even in some simple situations, partitioning based on a fixed threshold as is the case in the MDR method may lead to substantial loss of power compared with an exhaustive search strategy. We illustrate this using an artificial 23 casecontrol data as shown in. For this dataset, the P-value of the standard 2-df Pearson's  2 statistic is 0.019, which reports an insignificant result at the 0.01 level (all P-values are obtained from permutation with 10 5 replicates). Since the first two columns have ratios less than 1, while the third column has ratio greater than 1, we combine the first two columns together to get(left) and the standard 1-df Pearson's  2 statistic for this table is 240(10100 20110) 2 /(12012030210) = 3.810, and the P-value based on 10 5 replicates of Monte Carlo simulation increases to 0.088, which concludes an insignificant result even at the 0.05 level. However, if we use a different threshold, say, 0.8, and classify the last two columns as 'high risk' and collapse them into one column, then we have another 22 table (, right) with  2 statistic 240(111010119) 2 /(12012011229) = 7.717 (double the statistic of MDR, 3.810), which is the maximal 1-df  2 statistic of all 22 collapsed tables, and the P-value reduces to 0.006, which concludes a significance result at the 0.01 level. The simple example shown above suggests that a partitioning strategy with a different threshold may improve the result of MDR substantially. In this article, we propose an exhaustive search method based on the OCP property (Theorem 1 below), which can quickly identify the threshold that corresponds to the 22 table with the maximal  2 value among all possible 22 tables. The computational cost of this method is much smaller than the naive exhaustive search method. Before presenting our main results, we introduce a couple of concepts.Obviously, for a 2K contingency table S, there are up to 2 K1 1 distinct CPs, while the number of distinct OCPs is not more than K 1. Without loss of generality, for n candidate genes, suppose that each gene (e.g. SNP) has three genotypes, which are labeled as 0,1 and 2. Then the genotype combinations can be organized as a 23 n contingency table, with the first row containing the counts of the genotype combinations of the cases and the second row for the controls. The naive exhaustive strategy that finds the optimal table with maximal  2 value would involve up to 2 3 n 1 1 collapsed tables and calculations of  2 statistics. This number is enormously large even when n is small. For example, three genes corresponds to up to 2 3 3 1 1 = 67 108 863 tables. Therefore, it is not feasible to use such exhaustive strategy. The following theorem states that the exhaustive search can be accomplished efficiently by an OCP method.
Ordered combinatorial partitioning
here  2 P is the  2 statistic for P.An equivalent result has been established previously by, which is a corollary of a general theorem given in. During the preparation of this article, we found this result independently and an elementary proof can be found in Supplementary Material. We shall call any P 0  0 maximizing the  2 value as the optimal OCP. According to the definition, any CP selected by MDR is also an OCP, but it is not necessarily the optimal OCP. The example in Section 2.1 sheds some lights on this.illustrates the upper bounds of computational complexities (number of  2 computed) for naive exhaustive search, OCP (for OMDR), and CP with fixed threshold (for MDR) strategies. Compared with the naive exhaustive search strategy, the OCP strategy is much more efficient. In real data analysis, the computational burden can be further reduced by using the sparsity property. Suppose the total sample size is k, then the number of columns with at least one positive count would be at most k, and the computation complexity is not more than k 1. The analysis above suggests that the computational complexity of OCP procedure should be bounded by the minimum of the number of OCPs and the total sample size. In fact, this upper bound can be further relaxed. Suppose S 1 is a contingency table with positive margins and it is sorted into ascending order by column according to the ratio of the number of cases to controls. Since the columns with zero entries for cases have ratio 0, these columns can be combined into one column; likewise, the columns with zero entries for controls can be combined into another column. Let S 2 be this combined version of S 1. We have the following proposition, the proof of which can be found in Supplementary Material.We illustrate the above property by an example. We generated the genotypes of 50 cases and 50 controls based on Model 6 in. In this example, we can find the optimal OCP of the 2729 table with only about 11 operations according to Proposition 1, which is much smaller than the number of OCPs 728 and the total sample size 100.
Order determination and P-value calculation by GEVDAdequacy of the MDR method was assessed by comparing the average crossvalidation (CV) consistency (or prediction error) from the observed data to the distribution of average consistency (or prediction error) under the null hypothesis of no associations derived empirically from 10-fold CV and a large number of permutations. Thus, the computational burden is huge when the number of loci is large. In this article, in order to reduce computational burden we will use a P-value approximated by a GEVD () as a validity measure for the OMDR procedure. A similar approach has been used in. We describe the procedure as follows. Suppose we want to detect interactions up to order N 0 , N 0 < N. For every order n (n = 1,2, ,N 0 ) and every choice of n+1 loci out of the total of N, we use the OCP method to find the maximal 1-df  2 statistic. The optimal gene combination for this order of interaction is the one which maximizes the maximal  2 statistic and we denote this maximum by Tn is used to measure significance of the n-order interaction model. The optimal order of interaction is the one with the smallest P-value. Since T (0) n is the maximum of many  2 statistics, we assume that its null distribution can be approximated by a GEVD with cumulative distribution functionwhere  <,<+, > 0. Therefore, the P-value of T(0) n can be approximated by  n = 1F(T (0) n ;,,). To compute  n , we randomly permute the casecontrol labels of the original dataset to get M sets of null data. Since we have assumed the distributional form of the null distribution, the number of permutation replicates, M, can be taken to be very small (say, less than 50 for most studies). The maximal 1-df  2 for these M permutation datasets, {T, ,M}, can be obtained in the same way as that for Tn. Then, we use the permutation sample {T,...,M} to estimate the unknown parameters in  n based on the maximum likelihood principle. With this permutation sample, we can get the maximum likelihood estimates (MLEs) of the three parameters , and . Notice that the asymptotic property of the MLE may not hold if the shape parameter  falls outside the interval. Actually, the MLE may not exist if ||1 (). Therefore, we solve for the MLE with a constraint 0.5    0.5. The initial values of parameters are generated by the probability-weighted moment method (). For each n = 1,2, ,N 0 , the P-value,  n , for testing association between any n genes and disease can then be estimated byby by n = 1F(logTThe order of interaction is estimated bynby byn = argmin{argmin{ argmin{ 1 ,   2 , ,   N 0 }, and the corresponding gene combination is chosen as the final interaction model. Finally, we need to assess the significance of the detected model by computing the P-value ofnof ofof ofn. To do this efficiently, we apply the GEVD theory again and assume lognlog loglog logn has a GEVD distribution as in (1) under the null hypothesis. To estimate the parameters in this distribution, we permute the original dataset again and repeat the above procedure M 1 times and get null values loglog log,2,...,M 1. These values are used to estimate the parameters in the GEVD distribution and hence the P-value ofnof ofof ofn. Note that due to application of the GEVD theory, the total number, MM 1 , of permutations is relatively small.illustrates the procedure of the OMDR method.
Page: 1874 18711878
X.Hua et al.
RESULTSIn this section, we first show some simulation results, then we apply our method to a real dataset.
SimulationWe conducted simulations to compare the proposed OMDR with MDR. We considered 10 diallelic genetic markers (e.g. SNPs), two of which were assumed to be associated with the disease and the others are not associated. We generated genotypes of the two associated markers from four different two-locus models. Under Model 1 (), the two markers have no marginal effects but have interaction effects (). Models 2, 3 and 4 () are the epistasis model, the threshold interaction. Two-locus interaction models without marginal effect (entries are penetrance. p 1 and p 2 are the minor allele frequencies of two loci, q 1 = 1p 1 and q 2 = 1p 2 ; K is the population prevalence;  is the tuning parameter controlling the size of interaction effect)(1))K K model, and the multiplicative interaction model considered in. In generating genotype data for the 10 genes, we assume they obey the Hardy Weinberg equilibrium law and are in linkage equilibrium in the population. The population minor allele frequencies are 0.25 for the associated loci and 0.5 for the other 8 loci. In what follows, we consider interactions up to the order of N 0 = 4 and all of the simulation results are based on 400 replications. In addition, we consider balanced casecontrol study only, i.e. the numbers of cases and controls are equal since the results for unbalanced design are similar. As mentioned in the introduction, there are many versions and extensions of MDR in the literature. We use the version based on consistency and predictive error as the benchmark () in our comparisons.shows the empirical Type I error rates of the OMDR method based on 400 replicates of simulation and M = M 1 = 50 permutation replicates in order determination and P-value calculation. We can see that all the empirical Type I error rates of OMDR are close to the nominal level 0.05. Our simulations suggest that the number of permutation replicates can even be reduced to 20 without inflating the size of test when the total sample size is between 200 and 600. Simulation results for other choices of minor allele frequencies also show that the GEVD method can well control the Type I error rate of the OMDR method (results are not shown here). In our simulation study, we define the detection rate (DR) as the probability of successfully pinpointing the true set of interacting genes by the OCP method when the order of interaction is known a priori. The detected set is the one with maximal  2 no matter it is significant or not. Power is defined as the success probability of locating the pre-disposing genes without knowing the order of interaction while controlling the Type I error. Since determining order of interaction may have extra error, power is always less than the DR.shows DRs and powers for Model 1. It is seen that, compared with the MDR, OMDR has a substantial gain in DR andpower. For example, when the tuning parameter  is 7 in Model 1 () the DR gains of OMDR over MDR are 0.20, 0.73 and 0.71, and the power gains are 0.05, 0.28 and 0.79 for sample sizes 400, 800 and 1200, respectively. In addition, when the total sample size is fixed to be 1200 and the size of interaction effect  changes from 4 to 7 (), the DR increment of OMDR ranges from 0.11 to 0.71, while the power gain ranges from 0.01 to 0.79. We also studied the situation that the associated loci have both main and interaction effects.lists three models of this kind that were studied in the literature, namely, the epistasis, threshold and multiplicative interaction models. Simulation results for the former two models are summarized in. The sizes of the main effects of the two associated loci are fixed to be  =  1 =  2 = 2.0. Again, the DR of OMDR is uniformly higher than that of MDR. For the threshold interaction model, the DR gain of OMDR over MDR ranges from 0.22 to 0.39. Except for the case of  = 2.5 and sample size 400, the power gain of OMDR over MDR is around 0.3 for all the other five cases depicted in the lower panels of. Figures 2 and 3 show that the power of the OMDR method can be even greater than the DR of MDR when the interaction effect is large. Analogous results but with smaller power gain are observed for the epistasis model. For example, when the total sample size is 1200, the power gains of OMDR are 0.04 and 0.07 for interaction effect  = 3,4. But when interaction effect is smaller ( = 2), no power gain is spotted. For the multiplicative interaction model and the six models used in, the DR behavior of OMDR and MDR are similar but OMDR is slightly less powerful (see Supplementary Material), with the biggest power difference of 0.12 recorded for Model 5 (0.70 for MDR and 0.58 for OMDR). The magnitude of this loss in power by OMDR is not as big as the power gained by OMDR for the interaction model with no marginal effect () and the threshold interaction model (and D), which can reach 0.79 and 0.31, respectively. Upon closer scrutiny, we find out what happened was that OMDR would sometimes select a larger model containing the true model instead of the true model. MDR did not suffer from this problem because it selects order of interaction by means of an integer valued criterion called consistency and it gives preferences to lower order models in case of ties. In contrast, OMDR selects order by minimizing the estimated P-values that are continuous with no ties in general, and sometimes a higher than necessary order of interaction is chosen because its P-value is just slightly smaller. Since MDR favors small models by design and the true model used to simulate the data is of order 1 only, the fact that MDR is slightly more powerful than OMDR for the six models of Ritchie is perhaps understandable.
Ordered combinatorial partitioning
A B
Real data analysisWe applied the GEVD-based OCP and the permutation distribution based OCP to find the OMDR for the real casecontrol dataset from the Ontario Familial Breast Cancer Registry (). This case-control study contains 398 breast cancer cases and 372 population controls.analyzed the data set as summarized below. Nineteen SNPs from 18 cancerrelated genes passed the HardyWeinberg equilibrium test. Under recessive, dominant and co-dominant models, an unconditional logistic regression procedure was employed for each SNP by adjusting for age, BMI and family history. Only XPDshowed a significant main effect at the 0.05 level according to a crude P-value. However, none of the 19 SNPs showed significant evidence of a main effect after correcting for multiple testing by applying the false discovery rate (FDR) principle (). On the other hand, four two-way interactions, XPDand IL10-[G(-1082)A], GSTP1and COMT, COMTand CCND1, and BARD1and XPD, were detected at the 0.05 level based on FDR-adjusted P-values under a co-dominant model, although none of these four two-way interactions remained significant by Bonferroni adjustment. The joint genotype counts of the four SNP pairs are given inin. We used M = M 1 = 100 permutation replicates to get more stable and accurate estimations of P-values. Results of two-way interaction analysis are shown in. Note that the P-values computed by GEVD are quite similar to those computed by 10 5 permutation replicates. Meanwhile, the computation time is reduced more than 10-fold by using the GEVD method in our setting. Thus, using GEVD rather than permutation with the OCP method can significantly reduce the computation time while ensuring accuracy.The OCP solution, being the maximal  2 , is always not less than the MDR solution and, in this example, they coincide with each other. Therefore, inthe P-values of OCP method using GEVD approximation or permutations are also similar to but slightly larger than the ones from the MDR method. We also provided some real data examples in the Supplementary Material to show that it is a common phenomenon in practice that the partitionings of MDR and OMDR are different in which case the maximal  2 statistic will be strictly larger than the MDR solution. False positive report probabilities (FPRPs) listed inare fromin, only the analysis results adjusted for age are presented due to the highly missing proportion of BMI. FPRP is defined as the probability that the null hypothesis is true given a statistically significant result due to some test procedure, which depends on the prior probability that the null hypothesis is true, the level and statistical power of the test (). According to FPRP at the 0.1 level, at least two out of the four interactions are unnoteworthy: COMT[Met108/158Val] and CCND1, BARD1and XPDwere reported to be insignificant. Our OMDR method also reports insignificance of these two interactions at the 0.05 level (P-value = 0.066 and 0.087, respectively), while agrees with the conclusion inthat the interaction of XPDand IL10-[G(-1082)A] plays a very important role in breast cancer (P = 0.005). However, OMDR suggests that the interaction of GSTP1and COMTPage: 1877 18711878
Ordered combinatorial partitioningmight not be significant (P = 0.137), which is different from the conclusion inbased on FDR-adjusted P-value and FPRP.
DISCUSSIONMDR is a powerful non-parametric method in genetic interaction studies. Many empirical computer studies and real data analyses have demonstrated the impressive capability of MDR in detecting high-order interactions. The key idea of MDR is the pooling of high-dimensional predictors into two distinct groups, which reduces dimensionality and alleviates the sparsity problem. We observe that the power can be further improved by introducing the exhaustive search strategy. In this study, an OCP-based search strategy is proposed for finding the optimal contingency table with largest  2 statistic, which has computational complexity that is dramatically lower than that of the exhaustive search method. The GEVD theory is employed to further reduce computational cost. Both simulation studies and real data analysis show that the GEVD approximation is rather accurate and much more computationally efficient than using the permutation distribution. Simulation studies inshow that the MDR method performs robustly in the presence of noise due to genotype error and missing data, but may lose power substantially in the presence of phenocopy.proposed a genegene interaction detection approach based on the support vector machine and demonstrate several advantages of their machine learning method by simulation studies, especially the strong ability (e.g. power and model stability) to handle sample noise. Since the OMDR method always leads to higher DRs than MDR, it is conceivable that our OMDR method can deal properly with this noise while MDR does not. The performance of OMDR in the presence of these sources of noise will be explored in future studies and compared withmethod. Another important issue is the class-imbalance problem in gene gene interaction detection. The generalization ability of many classification methods such as logistic regression will be weakened by extremely imbalanced datasets. In balanced casecontrol design, the threshold used by MDR is 1 which can be naturally adjusted by the ratio of cases to controls when the design is unbalanced.proposes the balanced accuracy function defined as the arithmetic mean of sensitivity and specificity to substitute the accuracy function such as cross-validation consistency and prediction error used in previous literature (). Simulation shows that the power of the MDR method using this balanced accuracy function with the adjusted threshold can be elevated efficiently. Since the variable threshold used in OMDR is data-driven, our OMDR method can also be applied without modification to detect genegene interactions in unbalanced casecontrol studies.
The Author 2010. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oxfordjournals.org 1871 at :: on August 31, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
at :: on August 31, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
2 1  1 2 1  1 2 2  1 4  1 2 1  2  1 2 AA  1  1  1  2    1  1  2    1  2    1  1  1 2 2  1 2  1  2
