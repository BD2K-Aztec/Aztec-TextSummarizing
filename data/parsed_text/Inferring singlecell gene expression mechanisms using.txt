Motivation: Stochastic promoter switching between transcriptionally active (ON) and inactive (OFF) states is a major source of noise in gene expression. It is often implicitly assumed that transitions between promoter states are memoryless, i.e. promoters spend an exponentially distributed time interval in each of the two states. However, increasing evidence suggests that promoter ON/OFF times can be non-exponential, hinting at more complex transcriptional regulatory architec-tures. Given the essential role of gene expression in all cellular functions, efficient computational techniques for characterizing promoter architectures are critically needed. Results: We have developed a novel model reduction for promoters with arbitrary numbers of ON and OFF states, allowing us to approximate complex promoter switching behavior with Weibull-distributed ON/OFF times. Using this model reduction, we created bursty Monte Carlo expectation-maximization with modified cross-entropy method ('bursty MCEM 2 '), an efficient parameter estimation and model selection technique for inferring the number and configuration of promoter states from single-cell gene expression data. Application of bursty MCEM 2 to data from the en-dogenous mouse glutaminase promoter reveals nearly deterministic promoter OFF times, consistent with a multi-step activation mechanism consisting of 10 or more inactive states. Our novel approach to modeling promoter fluctuations together with bursty MCEM 2 provides powerful tools for characterizing transcriptional bursting across genes under different environmental conditions. Availability and implementation: R source code implementing bursty MCEM 2 is available upon request.
IntroductionThe process of gene expressionwhereby the information contained in a DNA sequence is converted into RNA and proteinsplays an essential role in the execution of nearly all cellular functions. As a result, the misregulation of this process underlies a large number of human diseases including cancer, diabetes and neurological disorders (). Despite its importance, the mechanistic details of gene expression are still not well understood. In particular, we lack a comprehensive molecular-level explanation for expression 'bursts'periods of intense RNA and protein production separated by periods of quiescenceobserved in pro-and eukaryotes (). Precise characterization of the mechanisms underlying expression bursts is profoundly important, as the properties of these bursts have been implicated in V C The Author 2015. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com disease-related processes such as bacterial phenotype switching () and HIV activation (). Recent advances in single-cell monitoring and single-molecule detection have made possible the experimental characterization of gene expression bursts (). Specifically,have quantified transcriptional bursts from 11 endogenous mouse promoters, demonstrating that each observed expression pattern can be approximated using a stochastic two-state model of promoter architecture. This commonly used 'random telegraph' model assumes that each promoter can exist in one of two states'ON' or 'OFF'with synthesis of RNA only possible in the ON state. Because of intrinsic noise exhibited by the small numbers of molecules involved in transcription (e.g. 12 copies of DNA, few available copies of transcriptional regulators) (), the promoter produces expression bursts by switching randomly between the transcriptionally active (ON) and inactive (OFF) states according to kinetic parameters (rate constants) that can be estimated from single-cell time series data (). Although conceptually useful and amenable to analytical characterization, the random telegraph model is an oversimplification of the architecture of most promoters. Because of simultaneous regulation by multiple transcription factors as well as chromatin modifications, the effective number of states for most promoters is thought to be larger than two (). A recent study of the human prolactin gene supports this assertion, where the distribution of time its promoter spent in an inactive state was inferred to be strongly non-exponential and thus indicative of multiple, sequential OFF states (). Classical examples of multi-state promoters include that of P RM in phage lambda, whose complex mechanism of regulation gives rise to 128 regulatory states () and the Endo16 gene in sea urchin, whose cisregulatory domain contains >30 binding sites for 15 different proteins that perform combinatorial regulation (). In light of these observations and the increasing availability of single-cell expression data, computational methods are needed for characterizing complex promoter architectures and efficiently simulating their behavior. An ideal candidate for such a method would (i) leverage the intrinsic noise of the system to better identify underlying mechanisms (), (ii) simultaneously infer both the configuration of promoter states and the associated kinetic parameters needed for predictive simulation and (iii) provide computationally efficient performance for a wide range of architectures. Currently existing methods satisfy only a subset of these requirements.performed hidden Markov model parameter inference for two-and three-state promoter architectures, but their models assume constant (noise-free) promoter activity and RNA levels between discretely observed time points and they do not provide an efficient means to characterize architectures with larger numbers of states. We previously developed Monte Carlo expectationmaximization (MCEM) with modified cross-entropy method (MCEM 2 ), which uses statistically exact stochastic simulations to infer kinetic parameters from single-cell time series data (). However, the original version of MCEM 2 does not enable characterization of promoter architecture.developed an approximate Bayesian computation-based method for inferring both parameters and model structure using stochastic simulations. Unfortunately, when using this method to discriminate between promoter models with increasing numbers of states, the addition of each state increases the number of unknown kinetic parameters (e.g. switching rates). In the presence of limited amounts of experimental data, this quickly renders more complex (and thus more realistic) models non-identifiable. We note that this drawback applies to any inference method that represents transitions between individual promoter states explicitly. Finally, stochastic simulation of multi-state promoter architectures suffers from a linear increase in computational cost with the addition of each promoter state, making the study of more complex models difficult. Because of the limitations described above, our goal in this work was to develop a computationally efficient method for characterizing gene expression bursts by inferring the number and configuration of promoter states from single-cell time series data.
ResultsOur results are structured as follows: we first devise a novel model reduction strategy that represents arbitrary numbers of promoter states by a single state accompanied by a time-dependent switching rate. As we demonstrate below, this strategy enables both efficient simulation and parameter inference. Next, we incorporate this model reduction into MCEM 2 and augment the method to perform model selection for configuration of promoter states. We demonstrate the resulting approach'bursty MCEM 2 'by inferring the effective numbers of promoter states underlying simulated singlecell expression data. In addition, we use bursty MCEM 2 to characterize the architecture of the endogenous mouse glutaminase promoter given experimentally observed time series data ().
Model reduction for multi-state promotersThe random telegraph model of transcription can be represented by the following four chemical reactions:where the promoter randomly switches between OFF and ON states according to rates k on and k off. RNA synthesis occurs at rate k m from the ON state and expressed mRNAs live for an exponentially distributed time interval with mean lifetime 1=c m , where c m is the mRNA degradation rate. A simplified version of (1) that is often used to model transcriptional bursting of mRNAs is:where c 1 and b denote the burst frequency and size, respectively. In the stochastic formulation of (2)). Model (2) provides an increasingly accurate approximation of (1) as k off ! 1, with c 1  k on and c 3  k off =k off  k m . A sample trajectory of mRNA copy numbers with transcriptional bursts followed by decay is illustrated in. Given the evidence discussed above that promoters exhibit multiple, sequential OFF states, a more realistic representation of the reversible reaction in (1) is the following:where the promoter exhibits a multi-step OFF to ON transition with N  1 OFF states and a single ON state. In contrast to (1), the distribution of time spent in OFF states between transcription events is now non-exponential. Specifically, these time increments follow the hypoexponential distribution, which approaches an Erlang distribution () when the switching rates (k 1 ;. .. ; k N1 ) are roughly equal. The construction of a simplified transcriptional bursting model of (3) that mirrors (2) requires the generation of inter-burst arrival times from an arbitrary distribution. This can be realized by making the burst frequency time dependent (). Let xt denote the state of a timer at time t measuring time elapsed since the last burst event: xt is reset to zero whenever bursts occur and dx=dt  1 in between burst events. The desired inter-burst arrival time cumulative distribution function (CDF) F is obtained by setting the propensity function of the transcription reaction to F 0 x=1  Fx, a quantity also known as the hazard function or failure rate (). Thus, the probability that an mRNA burst event will occur in the next time interval t; t  dt is F 0 x=1  Fxdt.In this work, we consider transcription propensity functions of the form c 1 xt c2 , where c 1 > 0 and c 2 !0. The corresponding simplified transcription reaction is represented as:For this class of propensity functions, the inter-burst arrival time distribution can be obtained as follows:) Fx  1  exp  c 1 c 2  1 x c21 :Equation (6) is the CDF of the Weibull distribution with shape parameter k W and scale parameter k W , where c 1  k W =k kW W and c 2  k W  1 (). The mean (represented by E) and coefficient of variation squared (CV 2 variance=mean 2 ) of this distribution can be expressed as follows:respectively, where t k denotes the kth mRNA burst time and C is the gamma function. When c 2  0 (time-independent burst frequency), the Weibull distribution reduces to an exponential distribution and CV 2  1. As c 2 increases, CV 2 monotonically decreases to zero. Thus, for large values of c 2 , mRNA bursts arrive at deterministic time intervals. The Weibull distribution is known to provide an accurate approximation of the Erlang distribution (). This property allows us to mimic the behavior of an N-state promoter with roughly equal switching rates (3) using a simplified model of transcription with the propensity function c 1 xt c2. Specifically, by increasing the value of c 2 , we can simulate expression from promoters with larger numbers of states. The relationship between c 2 and N is given by the following expression, which is obtained by equating the CV 2 of the Weibull and Erlang distributions:where N is one greater than the Erlang shape parameter (k E in the Erlang CV 2 formula: 1=k E ). In model (2) and its modification (4), we assume that mRNA bursts are instantaneous. This assumption can be relaxed by generalizing (2) to:where c 11 ; c 21  and c 12 ; c 22  contribute to the first and second reaction propensity, respectively, and the timer xt resets to zero each time the promoter transitions between the OFF and ON states (). By choosing the transition rates to be monomials in xt, the promoter resides in each state for a Weibull-distributed time interval. Setting c 21  c 22  0 recovers the standard random telegraph model where promoter ON and OFF times are exponentially(b)2.
Bursty MCEM 2Single-cell time course datasets are necessarily incompleteat best, they provide the numbers of molecules for a subset of the system species at discrete time points. Because of the intractability of the incomplete data likelihood for stochastic biochemical systems (), the direct calculation of maximum likelihood parameter estimates (MLEs) is only possible given complete data. In light of this, we resort to an iterative, simulation-based approach for computing MLEs using the MCEM algorithm. Previously, we developed MCEM 2 (MCEM with modified cross-entropy method), a computationally efficient approach for estimating parameters of stochastic biochemical systems given incomplete data (). We describe this approach in more detail in Supplementary Section S1, and below we present the modifications needed to accommodate the models of transcriptional bursting discussed in the previous section. Given our time-dependent transcriptional model reduction, it is relatively straightforward to construct closed-form update formulas that enable MCEM 2 to infer maximum likelihood estimates for c 1 and the geometrically distributed burst size parameter c 3 (~ c 1 and ~ c 3 , respectively). Because of the occurrence of c 2 in an exponent, it is not possible to derive closed-form update formulas for this parameter, so we fix its value in the following derivation and select most probable values for c 2 separately via model selection. Specifically, we use MCEM 2 to identify which value of c 2 provides the lowest Akaike information criterion (AIC), a model selection score that quantifies both data likelihood and model complexity (see Supplementary Section S3 for details). We begin by representing each of the system's M reaction propensity functions (where M is the total number of reactions in the system) as an explicitly state-and time-dependent function a j t  a j Xt; t defined as follows:where X(t) represents the state of the system at time t, h j Xt is the system state-dependent portion of the propensity function and x j t is a reaction-specific timer that resets to zero each time the jth reaction fires. We note that c 1j ; c 2j and x j t are designated with arbitrary subscripts only for the purposes of the below derivation; in practice, each promoter is associated with only one timer xt and at most two values each of c 1 and c 2. For system reactions with mass action propensity functions (e.g. a j t  a j Xt  h j h j Xt), the representation of Equation (11) is achieved by relabeling h j as c 1j and setting c 2j  0. For the remaining system reactions that exhibit time-dependent propensities as outlined in the above model formulation, h j Xt  1 and c 2j is nonzero. With all reaction propensities in the form of Equation (11), we can use the results ofto express the distribution function of the time interval s until the next reaction firing, given the system at the current time t, as:where X(t) is constant in the integral because no reactions take place within the time interval t; t  s. After differentiating Equation (12) with respect to s, integrating and simplifying (given x j t  s  x j t  s), we obtain the corresponding density function:where c 2j  c 2j  1. Given the time of the next reaction firing t  s, we can also express the probability mass function of the index of the next fired reaction j 0 as a simple categorical probability: pj 0 ; s; t  c 1j 0 h j 0 Xt  x j 0 t  s c 2j 0 P M j1 c 1j h j Xt  x j t  s c2j :Taken together, Equations (1214) allow us to represent the likelihood of a fully observed stochastic trajectory as the following product:where i indexes the events including the start of each simulation (i  0), the total number of overall reaction firings r k and arrival at the final time (i  r k  1), s i is the time interval between the ith and i  1th events, t i represents the time immediately after the ith event and j 0 i is the index of the ith reaction to fire. By taking the logarithm of Equation (15), differentiating with respect to c 1j , solving for the unique root and averaging across K 0 simulated trajectories, we obtain a closed-form Monte Carlo update formula:where gb; j 0  represents the geometric probability mass function evaluated at a burst size of b (1  c 3j 0  b c 3j 0 ) if j 0 is a transcriptional burst reaction and 1 otherwise. Following the same procedure as for c 1j , we obtain a closed-form update formula for c 3j :Inferring gene expression mechanismswhere 1 j j 0  is an indicator function that takes a value of 1 if j 0  j (0 otherwise). Taken together, the above derivations combined with MCEM 2 enable the construction of 'bursty MCEM 2' , a novel parameter estimation and model selection framework for inferring the number and configuration of promoter states from single-cell expression data. Supplementary Section S2 provides additional details of the method.
Simulation studyTo illustrate the accuracy of our model reduction along with bursty MCEM 2 's ability to select a plausible multi-state transcriptional model given observed data, we first performed a simulation study using three models with different numbers of promoter states. Model (A) represents a single-state promoter, which exhibits constant (non-bursty) production of mRNA: DNA ON  ! 5:0 DNA ON  mRNA mRNA ! :0001 ;:In the above system, the transcription reaction produces an average of five mRNA molecules per unit of time, whereas mRNAs are degraded at a much lower rate. Model (B) contains a promoter with three statestwo OFF states and a very short-lived ON state which exhibits bursty mRNA production. It modifies (A) by replacing the first reaction with the following:As before, the rates of (B) were chosen so that the promoter would produce five mRNA molecules per time unit on average. However, rather than exhibiting constant production, the promoter switches from OFF to ON once per time unit on average and quickly outputs a burst of mRNA molecules with mean burst size 500:0=100:0  5 before returning to OFF. Finally, model (C) contains a promoter with six states that also exhibits bursty mRNA production. It modifies (B) by replacing the first two reactions with the following:As in model (B), this promoter switches from OFF to ON once per time unit on average, and it outputs bursts of mRNA with mean size 5 before returning to OFF. The mRNA degradation rates of all three models are identical. For each model, we first simulated a single trajectory over 100 time units and recorded the number of mRNA molecules at 400 equally spaced intervals. The starting conditions for each simulation were 0 mRNA molecules and 1 promoter in states DNA ON ; DNA OFF1 and DNA OFF1 for models (A), (B) and (C), respectively. Supplementary(Supplementary Section S5) displays the three simulated trajectories. Given each synthetic data trajectory, we used our time-dependent transcriptional model reduction with bursty MCEM 2 to infer the unknown parameters (c 1 , c 2 ,where the mRNA degradation rate is given. The general version of model (E) is shown in. We used bursty MCEM 2 to perform parameter inference and model selection on each data trajectory using model (D) and three versions of model (E) with different values of c 2 : (i) c 2  0, (ii) c 2  0:4 and (iii) c 2  1:4. These four model parameterizations correspond to promoters with one, two, three and six states, respectively. We set the initial guesses for parameters c 1 and c 3 to 1 and 0.5, respectively. Since the initial value of the reaction clock x0 was unobserved, we set it to 0 for all bursty MCEM 2 model simulations.selected the model with the correct number of states as most probable for each synthetic data trajectory. For data from the one-(A) and six-state (C) models, competing models did not achieve a relative likelihood within an order of magnitude of a 0.368 cutoff (relative likelihood difference of 2 AIC units from best fitting model); for data from the three-state model (B), the two-state version of model (E) provided a second-best fit that was still substantially worse (likelihood  0.052) than the cutoff. When inferring parameters of the one-state model (D) using data from model (A), ~ c 1  4:81 is close to the true value of 5 and ~ c 1 's 68% confidence interval (4.595.03) includes the true value. Similarly, the inferred mean burst sizes for the most probable models fitting data from models (B) and (C) (5.37 and 4.20, respectively) are close to the true value of 5 and the 68% and 95% confidence intervals, respectively, of these two estimates (and) both include the true value. Finally, we note that results for model (D) were unavailable when fitting data from models (B) and (C), as the lack of transcriptional bursts in a one-state model precluded the simulation of trajectories matching data with bursts.
Glutaminase data inferenceNext, we applied bursty MCEM 2 to actual time-lapse microscopy data from a reporter gene driven by a mammalian promoter.measured gene expression at eight endogenous mouse promoters upstream of luciferase reporter genes. Using these data, the authors estimated the values of transcriptional parameters by modeling each promoter as occupying two or three states. Our goal was to use our model reduction with bursty MCEM 2 to infer whether one of these promoters likely occupies more than three states. To this end, we extracted a single trajectory of luminescence data collected once every 5 min from the glutaminase promoter (in) and performed data smoothing and calibration to convert light intensity values to numbers of proteins (see Supplementary Section S4 for details).displays the glutaminase trajectory before and after preprocessing. We then used bursty MCEM 2 to infer the unknown parametersand (I) given the data from:(D) lacking these parameters; remaining NA values from fitting data of models (B) and (C) due to inability of one-state model to generate trajectories matching data with bursts.(b)Inferring gene expression mechanismstranscriptional burst size of $20 ( ~ k m = ~ k off ) before returning to the first OFF state. These predictions are in stark contrast to the two-and three-state promoter models used into model the glutaminase promoter. To illustrate the differences between these models,displays simulated trajectories and OFF state dwell time distributions from versions of model (I) with 2, 3 and most probable 26 states (and the corresponding MLEs from). Asshows, the 26-state version of model (I) exhibits much less variable OFF state dwell times than the two-or three-state versions. This is reflected in the tendency of the trajectory into stay above a small number of proteins ($25), while the trajectories inand b occasionally decrease to near zero. The glutaminase data trajectory inalso consistently remains above 25 proteins, providing visual evidence for the superior fit of a 26-state promoter model to the data.
DiscussionIn this work, we present a novel model reduction for multi-state promoters along with an efficient computational technique for inferring the number and configuration of promoter states from singlecell gene expression data. Specifically, we first developed a timedependent reaction propensity function for transcriptional bursting that generates Weibull-distributed ON/OFF promoter state dwell times. Using this function, we demonstrated an ability to closely approximate the behavior of promoters undergoing multi-step transitions between OFF and ON states. Next, we created 'bursty MCEM 2 ' which, when combined with our model reduction, allows for computationally efficient parameter inference and model selection across a wide range of promoter architectures. As an example of the computational savings conferred, we note that modeling a promoter transitioning between nine OFF states and one ON state requires specification of 10 switching parameters and simulation of 10 chemical reactions per transcriptional cycle. In contrast, use of our time-dependent propensity function introduces only three parameters and requires the simulation of only two reactions per cycle. These computational and parametric savings increase linearly with the number of promoter states modeled, enabling efficient analysis of arbitrarily complex promoter architectures with bursty MCEM 2. Through a simulation study, we demonstrated the ability of bursty MCEM 2 to correctly identify the number of promoter states used to generate single-cell time-series trajectories. In addition, we showed that our method accurately infers the values of kinetic parameters within the chosen promoter model. We then applied bursty MCEM 2 to experimental time-lapse microscopy data from a reporter gene driven by the endogenous mouse glutaminase promoter (). Our results suggest that, rather than occupying two or three states as previously described, the glutaminase promoter likely traverses through 10 or more OFF states before transcribing mRNA from an ON state. We hypothesize that a distinct advantage of a promoter architecture with >10 states lies in its potential noise buffering properties. As the number of states increases, promoter OFF times become more deterministic, leading to more consistent rates of mRNA production. As shown in, this leads to less variable protein levels over time (particularly at lower levels), which can confer more robust behavior in response to stochastic perturbations. Because of the intrinsic noise present in the transcriptional and translational machinery, we note that the confidence interval accompanying our estimated number of glutaminase promoter OFF states is somewhat large (1050). The addition of measurements at later time points would certainly help reduce this uncertainty. However, if protein measurements were replaced with direct quantification of mRNA, we would expect a much more precise estimate, since translational noise would no longer affect our analysis. Results from the simulation study support this, where we obtained more precise estimates of numbers of promoter states by performing inference on mRNA data. When discussing particular numbers of promoter states within our model reduction, it is important to note that these values represent 'effective' numbers of states rather than distinct biochemical configurations. In particular, since the correspondence between the parameters of the Weibull distribution and the number of promoter states (4) is most accurate when the switching rates are equal, the effective number of states is likely an underestimation of the true number. This follows from the observation that as the switching rates depart from equality, the slowest promoter transitions become ratelimiting and thus mask the presence of faster transitions. Given that. Two-and three-state promoter models exhibit more variable OFF times than 26-state promoter model. Values of c 1 and c 2 used for each model version are shown one of our goals in this work was to demonstrate that mammalian promoters occupy more than two or three states, this discrepancy only strengthens the conclusions drawn from our results. In conclusion, we anticipate that our novel approach to modeling promoter fluctuations together with bursty MCEM 2 provides powerful tools for characterizing transcriptional bursting across genes under different environmental conditions. Future work will focus on discovering general transcriptional regulatory principles by applying these methods to single-cell expression data from a wide range of promoters.
Funding
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
B.J.Daigle, Jr. et al. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
c1xt c 2 k off DNA ON DNA ON  ! km DNA ON  mRNA; (I) where the latter three models also include the mRNA degradation, protein translation and protein degradation reactions of model (F) with given rate constants. Models (F) and (G) are similar in structure to models (D) and (E), respectively, with protein translation and degradation reactions added. Models (H) and (I) represent promoters with multi-step ON to OFF and OFF to ON transitions, respectively. Figure 1b represents models (H) and (I) by selecting appropriate values for c 11 , c 21 , c 12 and c 22. Like models (B) and (C), these two models exhibit burst-like transcription with the proper parameterization, and they do not assume instantaneous production of bursts. All four models share fixed, identical rates of mRNA degradation (derived from the 45-min glutaminase reporter mRNA half life experimentally determined by Suter et al., 2011), protein degradation (derived from the 21 minute luciferase protein half life experimentally determined by Suter et al., 2011) and protein translation (reported in Molina et al., 2013). We performed model selection over all models, using fixed values of c 2 (when present) ranging from 0 to 11. Altogether, these models approximate the behavior of promoters containing 1101 states. We set the initial guesses for all other unknown parameters to 1 (except for c 3 , which was set to .5). As before, we set the initial value of the reaction clock x0 to 0 for all bursty MCEM 2 model simulations. In addition, we set the unobserved initial state of the promoter for models (H) and (I) to DNA OFF. Finally, for the unobserved initial number of mRNA molecules, we tried values from zero to 30 in increments of five. However, as 20 molecules allowed the simulation of trajectories with the largest observed data likelihood, we used this number for all bursty MCEM 2 model simulations. Supplementary Tables S1 and S2 (Supplementary Section S5) and Table 2 lists the resulting parameter estimates, log likelihoods, AIC values and relative likelihoods (calculated across all models) for versions of models (F), (G), (H) and (I). As Supplementary Tables S1 and S2 show, no versions of models (F), (G) or (H) provide plausible fits to the data. From these results, we predict that the glutaminase promoter (i) occupies at least one OFF state, (ii) does not exhibit instantaneous bursting of mRNA and (iii) does not undergo a multi-step ON to OFF transition with a single OFF state. Instead, the results in Table 2 suggest that model (I) exhibiting a multi-step OFF to ON transition with a single ON state best fits the data, and we predict that the glutaminase promoter occupies between 10 and 50 OFF states (model versions with relative likelihood !:368) in the process of transitioning to a single ON state. Once in the ON state, our results predict a mean
