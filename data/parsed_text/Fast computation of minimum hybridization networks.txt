Motivation: Hybridization events in evolution may lead to incongruent gene trees. One approach to determining possible interspecific hybridization events is to compute a hybridization network that attempts to reconcile incongruent gene trees using a minimum number of hybridization events. Results: We describe how to compute a representative set of minimum hybridization networks for two given bifurcating input trees, using a parallel algorithm and provide a user-friendly implementation. A simulation study suggests that our program performs significantly better than existing software on biologically relevant data. Finally, we demonstrate the application of such methods in the context of the evolution of the Aegilops/Triticum genera. Availability and implementation: The algorithm is implemented in the program Dendroscope 3, which is freely available from www.dendroscope.org and runs on all three major operating systems. Contact:
INTRODUCTIONSpeciation by hybridization () is a widespread phenomenon not only in plants (), but also occurs in some other types of organisms (). When two individuals from distinct species hybridize and merge their sets of chromosomes, the hybrid organism is often sterile and does not produce any progeny. Differences among homologous chromosomes prevent correct meiotic pairing and viable gamete production. However, the eventual doubling of the chromosome number could restore a correct pairing (each chromosome pair with its double), and the fertile genotype could give rise to a new allopolyploid species. In this case, homologous chromosomes do not mix and the number of the genes is doubled. In other words, the genes from both parental species coexist in the polyploid genome and evolve independently.In the case that the parental species are genetically similar enough, the pairing between homologous chromosomes is not completely prevented and balanced meiosis could take place. In this case, the hybrid genotype could produce viable hybrid gametes (containing portions of both parental chromosomes) and progeny. If the progeny remains reproductively isolated from the parental genotypes, it could give rise to a new species (homoploid hybrid speciation). This implies that, in a hybrid species, different genes may have different evolutionary histories, in which case they will give rise to incongruent gene trees. Thus, using a single rooted phylogenetic tree to represent the evolutionary history of a set of taxa may be inaccurate in the presence of interspecific hybridization. A more precise description may be possible using a rooted phylogenetic network, in which internal tree nodes (nodes of indegree 1) represent putative speciation events, whereas reticulate nodes (nodes of indegree  2) represent possible hybridization events. Suppose we are given a collection of species for which we suspect that hybridization events have played an important role in their evolution. One way to determine a set of possible hybridization events is to compute a hybridization network for a given set of gene trees that aims at explaining the incongruences between the different trees using a minimum number of putative hybridization events. A hybridization network for a set of trees T is simply a rooted phylogenetic network containing the trees in T. In computational terms, the problem can be formulated as follows: given a set T of two or more rooted phylogenetic trees, determine all hybridization networks for T that are minimum in the sense that they have a minimum reticulate number (see below). This problem is known to be a computationally hard problem even for the case of determining only one hybridization network for two bifurcating trees on the same set of taxa (). In this article, we present an algorithm that takes as input two bifurcating, rooted phylogenetic trees T 1 and T 2 on the same taxon set X and produces as output a representative set of minimum hybridization networks N on X that contain both trees. Such a representative set is defined to contain exactly one network derived from each of the possible maximum acyclic agreement forests (MAAF), as defined below. The number of reticulation nodes in any such minimum network is called the hybridization number, denoted by h(T 1 ,T 2 ), for T 1 and T 2. Our algorithm is based on previous work described in;), which aims at computing the hybridization number, and on the work on the rooted SPR distance computation reported in;. We extend the published approach and provide a parallel implementation to compute a representative set of minimum hybridization networks containing one network perPage
B.Albrecht et al.MAAF. In this context, a number of theoretical issues arise and we will show how to address them in a forthcoming paper (). In our experience, the number of resulting networks can be quite large and so we provide methods for showing how the two input trees are embedded in the networks and for determining the number of different networks that contain a specific reticulation. We also provide variants of the algorithm that can be used to compute the rooted SPR distance (defined below) or the hybridization number of two bifurcating, rooted phylogenetic trees. We report on a simulation study that we have undertaken to compare our implementation with other competing methods. This study indicates that our approach is much faster than existing methods. Moreover, to illustrate how one may apply our method to a practical problem, we use it to investigate the evolution of the Aegilops/Triticum genera. The algorithm presented in this article is implemented in our program Dendroscope 3 (), which is freely available from www.dendroscope.org and runs on all three major operation systems.
METHODSThroughout this article, we follow the terminology and notation defined inand assume that the reader is familiar with graphs and related terminology. Let T be a phylogenetic tree on X and let X  X be a subset of taxa. We use T (X ) to denote the minimum connected subgraph of T that contains all leaves that are labeled by elements of X. The restriction of T to X is defined as the phylogenetic tree T | X that is obtained from T (X ) be suppressing all nodes that have both in-and outdegree 1. We define a rooted phylogenetic network on X as a directed acyclic graph with a single node with indegree zero (the root), no nodes with both indegree and outdegree equal to 1, and nodes with outdegree zero (the leaves) bijectively labeled by the set X. Given a rooted bifurcating phylogenetic tree T , a rooted Subtree Prune and Regraft move (rSPR move for short) on T is performed by first detaching a subtree of T rooted at the target of e 1 = (v 1 ,w 1 ) by deleting the edge e 1 and re-grafting the subtree on a different branch e 2 of T , by first creating a new node z 2 in e 2 and then a new edge (z 2 ,w 1 ). Finally, any node with both in-and outdegree 1 is suppressed. Note that, in the case of regrafting above the root , a new root node  has to be created, as well as two new edges ( ,) and ( ,w 1 ). Let T 1 and T 2 be two rooted bifurcating phylogenetic trees on a taxon set X. The rSPR distance between T 1 and T 2 is defined as the minimum number of rSPR moves required to transform T 1 into T 2. The problem of computing the rSPR distance between two rooted bifurcating phylogenetic trees on the same taxon set is known to be NP-hard, but fixed-parameter tractable (FPT) (). Let T 1 and T 2 be two rooted bifurcating phylogenetic trees on X. For technical purposes, we assume that the root  of both trees is a pendant node that has been adjoined to the original root and no re-grafting is permitted above . An agreement forest for T 1 and T 2 on X {} is a set of phylogenetic trees, called also a forest,on X  {} that has the following properties:(1) Each tree F i in F is the restriction of T 1 , and also of T 2 , to the set of taxa X i that appear in F i .(2) The root  is contained in(3) The trees in {T 1 (X i ) | i {,1...,h1}} and {T 2 (X i ) | i  {,1,...,h1}} are node disjoint subtrees of T 1 and T 2 , respectively.An agreement forest with minimum cardinality is called a maximum agreement forest (MAF). The concepts of rSPR distance and MAFs are closely related. Indeed, a pair of rooted bifurcating phylogenetic trees {T 1 ,T 2 } has an rSPR distance equals to d if and only if there exists a MAF F (T 1 ,T 2 ) with size d +1 (). Hence, to determine the rSPR distance between T 1 and T 2 , it suffices to compute a MAF for these two trees. Recall that a hybridization network for two rooted bifurcating phylogenetic trees T 1 and T 2 on X , is a rooted phylogenetic network that contains both trees. Given a rooted phylogenetic network N = (V ,E), the reticulate number of N is defined aswhere   (v) denotes the indegree of v. In the special case that N is bicombining, that is, all nodes have indegree at most two, then this is simply the number of reticulation nodes. The hybridization number for T 1 and T 2 is the minimum reticulation number obtained over all hybridization networks N for T 1 and T 2. The problem of computing the hybridization number for two rooted bifurcating phylogenetic trees on the same taxon set is known to be NP-hard, but FPT (;). The hybridization number can be calculated by computing a maximum acyclic agreement forest. An agreement forest F a (T 1 ,T 2 ) for T 1 and T 2 is called acyclic if its ancestor-descendant graph AG T 1 ,T 2 ,F a (T 1 ,T 2 ) does not contain any directed cycle. This graph is defined as the directed graph whose vertex set is F a (T 1 ,T 2 ) and for which an edge (F i ,F j ) exists precisely whenever i = j, and either(1) the root of T 1 (X i ) is an ancestor of the root of T 1 (X j ) in T 1 , or(2) the root of T 2 (X i ) is an ancestor of the root of T 2 (X j ) in T 2 .where X i ,X j  X are the sets of taxa that appear in F i and F j , respectively. An acyclic agreement forest with a minimum number of components is called a MAAF. If a MAAF with h components exists, then a hybridization network with reticulation number h1 containing both T 1 and T 2 exists (). For example, if a MAAF with only one component exists, then we have that T 1 and T 2 are congruent and 0 reticulations are needed.
The algorithmIn this section, we give a high level description of an algorithm that takes as input two rooted bifurcating phylogenetic trees T 1 and T 2 on the same taxon set X , and produces as output a representative set of minimum hybridization networks N on X that contain both trees, providing exactly one network per MAAF. The problem of computing the rSPR distance or the hybridization number between two trees is algorithmically a much simpler problem than computing the hybridization networks and the algorithm that we have implemented deals with these two problems, too. The algorithm consists of three phases, namely, a reduction phase, an exhaustive search phase and a final phase. In the latter, either the rSPR distance or hybridization number is reported, or the final hybridization networks are constructed. Whereas the first and the third phases can be executed in polynomial time, the exhaustive search phase is known to be NP-hard (). The main aim of the initial reduction phase is to decrease the practical running time by reducing the size of the two trees that are passed to the exhaustive search phase.
Reduction phaseIn the first phase of the algorithm, certain patterns present in both T 1 and T 2 are identified and used to reduce the instance of the problem. There are three types of reductionsfor a review]. A subtree reduction reduces pendant subtrees that are common to both trees (). This simplification preserves both the rSPR distance and the hybridization number. A chain reduction
Computation of minimum hybridization networksreduces maximal chains of at least three leaves. Chain reductions for the MAF and the MAAF problem are described in Bordewich and Semple (2005) and Bordewich and Semple (2007a), respectively. Finally, a cluster reduction divides the problem into a number of smaller subproblems using the set of minimal clusters common to both trees. A cluster reduction for the computation of MAAFs can be found in. Recently, a cluster reduction for the computation of MAFs has been proposed ().
Exhaustive search phaseThe first phase of the algorithm will usually subdivide the original problem into several smaller subproblems. For each such subproblem (T 1 ,T 2 ), we must compute a MAF, a MAAF or the set of all MAAFs, depending on whether we want to compute the rSPR distance, the hybridization number or a set of hybridization networks, respectively. To compute a single MAF, we use the FPT-algorithm described in Whidden and Zeh (2009). A lower bound for the rSPR distance can be found using the three-approximation algorithm of. In, the authors also describe an FPT-algorithm for computing acyclic agreement forests. Unfortunately, that work is based on the incorrect assumption that it suffices to avoid all cycles of length two so as to obtain an acyclic agreement forest. In a forthcoming paper (C.in preparation, available at http://arxiv.org/abs/1109.3268), we will show how to correct and extend their algorithm so as to obtain all MAAFs for a given pair of trees. Broadly speaking, the algorithm works as follows: suppose that we are interested in computing a MAAF for two trees T 1 and T 2. Our algorithm takes as input a tree R and a forest F and it proceeds in a bounded-search type fashion by recursively deleting an edge in F or reducing a common cherry of R and F until the resulting forest F is a forest for T 1 and T 2. (The algorithm is called the first time with R = T 1 and F = T 2 ). More precisely, each recursion starts by picking an arbitrary cherry {a,c} in R, i.e. a pair of leaves a and c adjacent to a common vertex. Depending on whether {a,c} is a common cherry of R and F or not, and whether a and c are vertices of the same component in F or not, the algorithm branches into at most three computational paths by recursively calling itself. Regardless of whether {a,c} is a common cherry of R and F or not, the algorithm branches into two new computational paths that correspond to deleting one of the edges entering a and c in F , denoted e a and e c , respectively. Additionally, if {a,c} is not a cherry in F and a and c are in the same connected component in F , then the algorithm branches into a third computational path that corresponds to deleting an edge whose starting node lies on the shortest path connecting a and c in F , e a and e c excluded. Similarly, if {a,c} is a common cherry of R and F , then the algorithm branches into a third path that corresponds to reducing the cherry {a,c} to a new leaf labeled {ac} both in R and F. If only one MAAF is required, then the algorithm is terminated as soon as the first MAAF is found.
Output phaseIn the case that our aim is only to compute the rSPR distance or the hybridization number, we simply report the number of components in the MAF or MAAF, respectively, minus one. Otherwise, if our aim is to generate a representative set of hybridization networks, then we construct a phylogenetic network on X for each different MAAF computed in the exhaustive search phase as described in. To do this, we first need to undo all the reductions performed in the reduction phase.
Parallelization and additional analysisFor the computation of the hybridization number or networks, each application of a cluster reduction in the reduction phase of the algorithm gives rise to two subproblems. Since the hybrid number for the unreduced problem is equal to the sum of the hybrid number for the two subproblems (), the exhaustive search can be run independently on the two subproblems. In our parallel implementation of the algorithm, each subproblem produced in this way is placed in a queue and the subproblems in the queue are dispatched to individual cores subject to availability. For the parallelization of the computation of the rSPR distance, it is not that simple and a cluster hierarchy H has to be computed (). A parallel analysis of the subproblems is then possible, but respecting the cluster hierarchy: a subproblem in the hierarchy is analyzed only once all its 'descendent subproblems' are. Note that the sum of MAF sizes of each subproblem only provides an upper bound of the rSPR distance. For computing the exact rSPR distance, some additional steps are required, see Linz and Semple (2011). When constructing a hybridization network in the output phase of the algorithm, we assign the number 1 or 2 to each reticulate edge, depending on whether the edge corresponds to tree T 1 or T 2 , respectively. With this information, we can highlight the edges of T 1 or T 2 in each of the computed networks. The exhaustive search phase is also performed in a parallel fashion, launching different threads to search for agreement forests of increasing sizes. When an agreement forest of size k has been found, then all threads searching for an agreement forest of larger size are aborted. A similar strategy is used when searching for a single MAAF or for the set of all MAAFs. Thus, parallelism is used even when the two input trees do not share any common cluster. Let N be the set of output networks. For each network N i in N and for each reticulate node r z in N i , we compute the set of leaves  L(r z ) that can be reached by direct paths from r z without crossing any reticulate node. (Note that this leaf set represents the leaf set of a component of the underlying MAAF.) Given two networks N i ,N j  N and a reticulate node r z in N i , we say that N j contains r z if there exists a reticulate node r l in N j such thatThen, for each reticulate node in one of the output networks N 1 ,...,N t , we determine how many networks contain that particular node and then label the node by this number divided by the total number of computed networks t. Thus, a reticulate node that occurs in all computed t minimum hybridization networks obtains a support value of 1, whereas a reticulate node that occurs only once has a support value of 1 t. In addition, the computed networks are listed in descending order with respect to the sum of the support values of their reticulate nodes. When interpreting support values, remember that only one network per MAAF is computed, when there might be many networks per MAAF.
SIMULATION STUDYTo study the performance of our approach and implementation, we undertook a simulation study. We generated 2000 synthetic datasets, each consisting of a pair of rooted bifurcating phylogenetic trees. The datasets are based on three parameters, namely the number of taxa n, the number of rSPR moves k used to obtain the second tree from the first, 1 and the tangling degree d (as defined below). For each of the following choices of the parameters, n in {20,50,100,200}, k in {5,10,...,50} and d in {3,5,10,15,20}, we constructed 10 pairs of trees, thus obtaining 2000 different datasets in total. The tangling degree is an ad hoc concept that we introduce to control how tangled the resulting network will be and it influences the way we obtain the second tree from the first using rSPR moves. More precisely, let R be an rSPR move performed on a tree T by choosing two edges e 1 and e 2 , pruning the subtree of T rooted at the source ofand re-grafting it on e 2 = (v 2 ,w 2 ). We say that R respects a tangling degree of d, if the path from the lowest common ancestor of the nodes v 1 and v 2 to the node v 1 contains at most d edges. The tangling degree is a useful concept because the smaller it is, the more likely it is that one or more cluster reductions can be performed on the resulting dataset. As we will see, the number of common clusters in the two input trees has a major effect on the performance of our algorithm. Indeed, the more cluster reductionswe can perform, the smaller the problem instances are and the more effective our parallelization is. In more detail, each pair (T 1 ,T 2 ) of rooted bifurcating phylogenetic trees for a given set of parameters n, k, and d is created as follows: the first tree T 1 on X ={x 1 ,...,x n } is generated by first creating a set of n leaf nodes bijectively labeled by the set X. Then, two nodes u and v, both with indegree 0, are randomly picked and a new node w, along with two new edges (w,u) and (w,v), is created. This is done until only one node with no ancestor, the root, is present. The second tree T 2 is obtained from T 1 by applying k rSPR moves, in each move respecting the given tangling degree d. We compared our implementation with the best available software for computing the exact hybridization number between two rooted bifurcating trees on the same taxon set, which is HybridNET (), available from http://www.cs.cityu.edu.hk/~lwang/software/Hn/. [The underlying algorithm is described in. We do not consider the program HybridInterleave (), because it has been shown to be much slower than the HybridNET software (). Both programs have been run on a AMD Phenom X4 955 Processor with 4 GB RAM. We present the results of our simulation in Figures 1 and 2. Each program run that took >20 mins was aborted and then counted as if it took 20 mins. In, aborted runs have been included in the averages and, in all plots, the percentages report the proportion of the executions that were completed within 20 min. In, aborted runs have not been included in the averages because their hybridization number is unknown. In the latter figure, we report the number of the executions that were completed within 20 minutes. Figures 1 and 2 show that the average running time (as function of the number of leaves, of the number of rSPRs or of the hybridization number) of our implementation is always lower than that of HybridNET. For both programs, the running time increases with the number of taxa (and b), and also with the rSPR distance (approximated by the number of rSPR moves) (Page
B.Albrecht et al.
Computation of minimum hybridization networks(b)and d) and the hybridization number ().also shows that, in our simulations, HybridNet was unable to compute the hybridization number for any tree pair with hybridization number
APPLICATION TO PHYLOGENY OF AEGILOP/TRITICUM GENERAThe Triticeae tribe (Family Poaceae) consists of diploid and polyploid grasses with the same basic haploid chromosome number (x = 7), and they are distributed worldwide. Phylogenic analysis performed with different sequence datasets show significant inconsistencies (; Mason-Gamer and Kellogg,). In particular, inconsistencies between chloroplast and genomic data are often detected (). We used two datasets of sequences from number of diploid species belonging to the close genera Triticum and Aegilops: matK and PinA, located on the chloroplast and the Triticeae chromosome 5, respectively. Sequence data were obtained from GenBank. The accession numbers can be found in. The best-fit model of nucleotide substitution for each dataset was chosen using JModeltest (), and PhyML 3.0 () was used to obtain maximum likelihood phylogenetic trees (heuristic search with BIONJ starting tree, SPR and NNI swapping and 100 bootstrap replicates). Majority-rule extended
B.Albrecht et al.consensus trees were computed from 100 bootstrap replicates by the consense program of the PHYLIP package (), using the default parameters in the rooting setting. The two consensus trees are shown in. Two kinds of inconsistencies were found. One involves Aegilops speltoides and the ancestor of A.bicornis, A.longissima and A.sharonensis (hereafter referred to as the BLS species). A.speltoides has a basal position in both trees, but in the matK tree it is isolated, whereas in the PinA gene it is very close to the BLS. In the matK tree, the BLS species are close to species that radiated more recently. This deep phylogenetic inconsistency could be a consequence of a hybridization between A.speltoides and an ancestor of BLS species that introgressed into portions of A.speltoides genome. This hypothesis is supported by the observation of similar inconsistencies involving A.speltoides and A.longissima in a larger sample of nuclear genes (). Note that this hypothesis is present in all three hybridization networks obtained by Dendroscope 3 from the two consensus trees (). The other inconsistency involves the relative position of A.tauschii, of the ancestors of two groups of species, i.e. A.uniaristata + A.comosa and of the BLS species. Three alternative hybridizations could be inferred (). However, this inconsistency is more recent and could also be explained by an incomplete allele sorting (that is, allelic variants coexisting in the common ancestor of all these species were randomly fixed in the derived species).
The Author 2011. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oup.com
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
Note that this number is an upper bound on the true rSPR distance.
>21, while our program produces results for tree pairs having a hybridization number up to 40. Note that the number of common clusters has a significant effect on the performance of our algorithm (Fig. 1e and f), and this explains much of the performance advantage over HybridNet. However, even in the case that no parallelization is performed, namely when the number of common clusters is equal to 1, our implementation is still faster than HybridNet (Fig. 1e and f). Note that the plot in Figure 1f is very erratic when the number of common clusters is >15. This is due to the fact that few datasets share such a high number of common clusters. Using the same datasets, we also studied the performance of our implementation for the problems of computing the rSPR distance for two rooted bifurcating phylogenetic trees. We compared the running time of our implementation with that of the best available software for computing the exact rSPR distance between two rooted bifurcating trees on the same taxon set, i.e. rSPR (Whidden et al., 2010), available at http://kiwi.cs.dal.ca/Software/RSPR. In all conditions, the program rSPR performs better than our implementation (data not shown). Since the underlying algorithms are the same in this case, we suspect the difference in performance may be due to the fact that our program is implemented in Java, whereas the rSPR program is written in C++. For the sake of completeness, in Supplementary Figure S1 we report the running time of Dendroscope 3 and HybridNET when computing the exact hybridization number and a set of hybridization networks, containing a network per MAAF, on a grass (Poaceae) dataset provided by the Grass Phylogeny Working Group (Grass Phylogeny Working Group, 2001). This dataset has been often used to evaluate programs computing the hybridization number or hybridization networks for two rooted bifurcating phylogenetic trees on the same taxon set.
DISCUSSION It has become standard practice to base evolutionary studies on multiple genes. When incongruences between different gene trees are small, then they are usually deemed insignificant and are dealt with by performing a consensus analysis. However, when the differences between the gene trees are more significant, and when mechanisms such as hybridization may have played an important role in the evolutionary history of a set of species, then an alternative approach may be to try to reconcile the different gene trees by combining them into a rooted phylogenetic network in which reticulation nodes represent possible hybridization events. While some papers in the literature have focused on reconciling incongruent gene phylogenies in terms of a network (Koblmuller et al., 2007), a major problem has been the lack of software implementing an algorithm for computing and investigating such networks. In this article, we address the need for such software by providing an algorithm that runs fast on most practical problems and produces a representative set of minimum hybridization networks, containing one network for each MAAF. Our algorithm is implemented in the program Dendroscope 3, which allows the user to visualize and compare the resulting networks, both among each other, and also with the original input trees. Our simulation study shows that our implementation is faster than existing implementations and the study of grasses, reported in Section 4, shows how one may use the software to obtain different possible hybridization scenarios.
