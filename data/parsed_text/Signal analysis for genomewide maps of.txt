Motivation: Chromatin structure, including post-translational modifications of histones, regulates gene expression, alternative splicing and cell identity. ChIP-seq is an increasingly used assay to study chromatin function. However, tools for downstream bioinformatics analysis are limited and are only based on the evaluation of signal intensities. We reasoned that new methods taking into account other signal characteristics such as peak shape, location and frequencies might reveal new insights into chromatin function, particularly in situation where differences in read intensities are subtle. Results: We introduced an analysis pipeline, based on linear predictive coding (LPC), which allows the capture and comparison of ChIP-seq histone profiles. First, we show that the modeled signal profiles distinguish differentially expressed genes with comparable accuracy to signal intensities. The method was robust against parameter variations and performed well up to a signal-to-noise ratio of 0.55. Additionally, we show that LPC profiles of activating and repressive histone marks cluster into distinct groups and can be used to predict their function. Availability and implementation: http://www.cancerresearch.unsw .edu.au/crcweb.nsf/page/LPCHP A Matlab implementation along with usage instructions and an example input file are available from:
INTRODUCTIONGene expression is controlled at multiple levels, including factors regulating DNA accessibility (). A combinatorial code of post-translational modifications of the nucleosome proteins H2A, H2B, H3 and H4, can render their associated DNA, accessible or inaccessible for transcription and splicing (). Acetylation is generally associated with activation, while the affect * To whom correspondence should be addressed. of histone methylations is condition and position dependent (). Chromatin immunoprecipitation (ChIP), originally developed to enrich DNA fragments bound by specific proteins, is now frequently used in studies of histone modifications (HMs) (). In brief, a target protein, such as a transcription factor (TF) or histone with a particular modification is first crosslinked and immunoprecipitated using an antibody. The associated DNA is then extracted and detected using methods such as a hybridization array (ChIP-chip) or deep sequencing (ChIP-seq). The later approach shows advantages in resolution and following bioinformatics processing provides genome-wide maps of TF binding and HMs. A large number of algorithms for downstream processing of ChIP-seq datasets have been developed (). These tools generally evaluate signal intensities, with the aim of detecting sparse, highly localized and enriched peaks. However, while this is a common characteristic for TF binding, the signals from HM ChIP-seq are more variable. For example, H3K4me3 and H2A.Z, localize at the transcription start site (TSS) whereas others, such as H3K36me3 and H3K20me1, spread over many base pairs covering the promoter and full gene body (). In addition, these signals often differ in peak shape and location, as well as frequency. By focusing the analysis on signal intensity alone, existing methods are potentially limiting and constrain our ability to identify common motifs or patterns. A number of genome-wide studies have recently been published and show correlations between HMs and gene expression. While each study varied slightly in processing of the ChIP-seq data, in all cases, the read intensities that mapped to an arbitrary region around the TSS of a gene were extracted and normalized. A vector containing quantification values from each dataset was constructed for each gene, and these vectors were subsequently correlated with gene expression using different multivariate statistical approaches. The earliest work analyzed ChIP-seq data for 20 histone methylations () and identified two major gene groups by hierarchical cluster analysis. The first contained active marks and genes expressed above average while the second cluster contained repressive marks and genes expressed below average. A later study used the same methylation data but also included measures of 19 histone acetylation profiles (). Here, a linear regression model was used and again revealed that the HM ChIP-seq data was predictive for gene expression.
Signal analysis for genome-wide mapsA smaller study of the two methylations, H3K4me3 and H3K27me3, applied a mixture of linear regression models and found that HMs were more predictive for gene expression compared to TF binding (). Interestingly, these articles reported good predictability of gene expression by three different computational models, all using transformations of read counts as input. However, purely based on intensity information, these approaches neglect other key signal characteristics such as peak shape and location, as well as signal frequencies. Incorporating peak shape information will be essential to identify HMs present on adjacent nucleosomes. The specific locations of the histone modification, e.g. in the promoter or within the transcribed region, have been correlated with different functions, including transcription initiation, promoter clearance or transcriptional elongation (). In addition, recent data from ChIP-seq of H3K27me3 identified three different regions relative to the TSS of gene, which independently correlate with different gene expression levels (). Motivated by the biology and the shortcoming in available algorithms, we propose a new strategy that quantifies the ChIP-seq profile, making use of the pattern and location of the signal. After data pre-processing, the linear predictive coding (LPC) model, a method widely used in speech recognition, was applied to optimally parameterize the signal. The derived coefficients were used as quantitative features replacing signal intensities. With focus on the correlation between histone methylation and gene expression, we first validated our approach and show that it is robust, tolerates noise and performs with comparable accuracy to read intensities in a general and large-scale cross-validation. We then show that our method can be used to successfully predict the function of HMs.
METHODS
Datasets and gene selectionIn this study, gene expression and HM data of resting CD4 + T cells was analyzed. The gene expression data, measured on an Affymetrics whole-genome HG-U133A expression array, was obtained from (). Genome-wide ChIP-seq data were acquired on a Solexa Genome 1G platform and obtained fromhistone modifications, the histone variant H2Z.A, as well as PolII and CTCF binding. The recently established consensus coding sequence (CCDS) database () was used to map between these datasets.
Pre-processing of histone modification dataThe datasets from 21chromatin modification, PolII and CTCF were referred to as C = {c 1 ,c 2 ,c 3 ,..., c M } and M = 23. On an average, each ChIP-seq experiment contained 8.1910 6 sequence reads with a length of 20 bp and the total read counts that uniquely mapped to the genome were denoted as r c. The CCDS database was used to identify human protein coding genes g that have high-quality annotations for their genome location. A genomic window w g was then defined for every gene, stretching equal distances from its TSS and having a total length l w g . The positions w g i , i = 1,2,3,...,l w g represent the base pairs within the genomic loci. Next, signal profiles at w g were extracted from all ChIP-seq experiments. Therefore, the forward (+) and reverse () strands were first considered independently and aligned sequence tags at each genome coordinate i were summed up into the read profiles r + cg and r  cg respectively (, Step 1). These profiles were then joined to avoid strand-specific bias ():where  is the peak shift parameter, which was calculated for individual regions of 300 bp that exceed a threshold of 600 aligned sequence reads. In each region, we first indentified local maxima that correspond between the forward and reversed strands,  was then calculated as the average distance between these peaks (, Step 2). The resulting signal profiles were transformed, using kernel density estimators, into density profiles further smoothening the signal and increasing resolution, which both benefits the LPC estimation procedure (). In addition, this step removed the overall intensity information. The density profile z cg was then calculated as follows:where n is the number of reads, h is a smoothing parameter and K the kernel function. Here, we use the Gaussian kernel which is given by K(u) = 1  2 e 0.5u 2 and the bisquare kernel given by K(u) = 15 16 1u 2 2 if 1  u  1 and 0 otherwise (, Step 3).
Computation of LPC features from ChIP-seqLPC is a spectral analysis method that optimally characterizes a given wave signal by a set of LPC parameters (). It has a number of desirable characteristics including a mathematically precise solution, straightforward and simple implementation as well as low computational costs. In addition, the LPC model is widely applied in speech recognition systems, where it performs well in variety of applications. Interestingly, the waveforms and large variance that are characteristic for human speech are similarly found in ChIP-seq signals of different HM [comparein. Therefore, we have investigated the application of LPC to parameterize ChIP-seq data into spectral vectors, and use these features for downstream bioinformatics analysis (, Steps 4 and 5).The basic idea behind the application of LPC to ChIP-seq data is that the kernel density estimate z cg i of the signal c at gene g and genome coordinate i can be approximated from a linear combination of the previous signals i1,i2,i3,...,ip following ():where a cg k with k = 1,2,3,...,p are the prediction coefficients to be determined, and p also referred to as poles denotes the number of earlier signals used. The approximation error e cg i is given by:and thus the mean squared error E can be expressed as:Having obtained an expression for the mean square error, we can derive an optimal solution for each a cg k that minimizes E:which can be solved by the autocorrelation method:where a cg is a p1 vector that contains the LPC coefficients, R cg is a pp Toepliz matrix and r cg is a p1 vector both containing the autocorrelation values.
Signal analysis for genome-wide maps
Histone profiles derived from LPC and read intensitiesThe LPC features a cg , obtained from each of the analyzed experiments of gene g, were summarized to the feature vector. We denote f g the LPC histone profile (LPCHP) of the gene g as it describes its overall histone pattern, including PolII and CTCF, measured by 23 ChIP-seq experiments as described earlier. In addition, histone profiles from read intensities (RIHP) were calculated. Therefore, the signal profiles r cg for a given gene were summed as following:The final values from all datasets M were summarized to the feature vector. We denote f g the read intensity profile of the gene g.
Cross-validation accuracies for validation and parameter analysis of LPCHPIn order to identify reasonable model parameters and to validate the proposed approach, we performed cross-validation analysis on several pre-labeled gene groups. Therefore, the LPCHP f g , and for comparison reason the RIHP f g , were derived for all pre-labeled genes and a supervised classification (two and three groups) was performed using the support vector machine approach (). In brief, for each cross-validation the full dataset is first randomly split into k equally sized parts, each part is used once as a validation set while the other k 1 parts are used as a training set (). In each experiment, k supervised classifications tasks are executed and the mean classification accuracy over all runs is calculated. In our analysis the classifications were run 100 times to allow for statistical assessment of the results.
Cluster congruence for parameter comparison of LPCHPCluster analysis using the average linkage method and Euclidean distance metric was performed on the LPCHP with different parameters. In order to quantitatively evaluate the congruence of these clusterings, we used a popular measure called the Adjusted Rand Index (ARI) (see Supplementary Material 1 of detailed description) (), which has previously been used in bioinformatics applications (). It measures the agreement between two clusterings U and V , and is bound to ARI with ARI U,V = 1 in case of maximal agreement (e.g. identical clusterings) and ARI U,V = 0 when the clusters are independent (e.g. no agreement between the clusterings).
Histone function prediction through similarity analysis of LPCHPWe investigated if functionally similar methylations also show similarities in their ChIP-seq structure. Therefore, the full dataset C was split into two nonoverlapping sets, K containing well characterized transcriptional activators or repressors, and the set X with histone modifications that are less studied in CD4 + cells. In each set the histone marks were represented by the LPC parameterization of some pre-selected genes, covering high and baseline expression levels. In order to identify structural similarities in K, we used a standard hierarchical clustering algorithm based on the average linkage method and Euclidean distance metric. For functional prediction of histone methylations, we split K into a two class training sets containing the transcriptional activators and repressors A and R, respectively, and defined as follows (compare also):where the indices H and L were used to represent the genes in G H and G L. In order to predict the function of each methylation in x  X we used a simple decision rule, defined by the mean distance of x and the training sets following:where d is the Euclidean distance. The histone methylation x is assigned to the activation or repressing group following:Note that in case D A = D R no prediction can be made for the specific methylation. The greater the difference between D A and D R the better the prediction.
ImplementationThe algorithms were implemented in Matlab (version 7.11.0.584). All datasets including the ChIP-seq and expression array, as well as the annotation files from the CCDS and affymetrix were imported to and mapped between using MySql (version 5.5.14). The LibSVM implementation of the support vector machine was used with default parameters (). A Matlab script implementing the procedure outlined in, along with example input files and usage instructions are available from: http://www.cancerresearch.unsw.edu.au/crcweb.nsf/page/LPCHP
RESULTS
Evaluation of LPCHP and comparison with RIHPIn order to validate the proposed methodology, we set up several cross-validation experiments based on the support vector machine approach with standard parameters (). Following the idea of the histone code theory, HM profiles are expected to be similar within and different between gene groups expressed at different levels. Hence, a logical way to evaluate our methodology is to determine how well the LPCHP distinguishes different gene groups and how this accuracy compares to a more traditional analysis based on RIHP. In an initial exploratory study, we cross-validated a large number of all model parameters on a small gene set. This revealed that the bisquare kernel with parameter h = 10 performed best across most combinations. Therefore, this parameter was fixed for the remainder of this article. In contrast, the comparison for the parameter p in the LPC model identified a number of parameters with good performance, indicating the robustness of this model. Reasonable values were found between 8 and 16, which is the suggested range for speech recognition application, as well as smaller values including 4 and 6, and larger values like 22 and 24 (Supplementary Material 2). For a detailed evaluation of our approach on a larger dataset we first defined three gene groups for highlow G L expressed genes. For each set, 500 genes were identified based on expression measurements from the HG-U133A expression array (). The mean expression levels were G H = 3613.6, G M = 209.66 and G L = 2.39. The LPCHP and RIHP were calculated and we visualized the first three principle components in Supplementary. The RIHP clearly separated the three gene groups, as expected from the literature. However, strikingly the LPCHP also showed a significant grouping, similar to the RIHP. In order to quantify this trend we performed a k-fold crossvalidation with the objective of classifying the whole dataset (e.g. 1500 genes) into the three expression groups. The results for k = 10,5 and 2 as well as using the leave-one-out strategy are shown in, with more details shown in Supplementary Table S1. As expected from the principle component analysis the RIHP and the LPCHP achieved similar classification rates. For example, the overall differences in mean classification from RIHP to LPCHP wereIn addition, the LPCHP approach performed well and achieved mean classification accuracy >75% over all four experiments. The classification accuracies betweenHowever, this trend was expected as genes in G H and G M are expressed with relatively high copy numbers and should be actively marked on the histone level (e.g. G H = 3613.6 and G M = 209.66). Therefore, we further examined the predictive power of any single HM to distinguish the gene groups G H and G M. We notice that in this comparison the LPCHP outperformed the classification rates of RIHP for H3K79me1, H3K79me2, H3K79me3, H3K9me1, H3K9me2, H3K9me3 and H4K20me (Supplementary). Noise tolerance analysis further suggested that the approach remains accurate up to a signal-to-noise ratio of 0.55 and 0.3 for Gaussian and uniform noises, respectively (Supplementary).
Evaluation and robustness of LPCHP under different parameters
Evaluation of LPCHP with parameter settings customized to each datasetIn the last section, the same p was used for all datasets included in the LPCHP. The cross-validation analysis resulted in consistent classification accuracies for a number of different p. Here, we further investigated whether a customized parameter p should be selected for each dataset. Unfortunately, due to the large number of potential combinations, it is not computationally feasible to cross validate different p for each datasets included into the LPCHP. As an example, to test only five different values, for each of the 23 ChIP-seq experiments, a total of 5 23 cross-validation experiments are required. Therefore, we utilized the variogram approach (see Supplementary Material 3 for detailed description) to estimate parameters for a number of selected genes from each ChIP-seq experiment (Supplementaryand Supplementary Material 3 and 4). We found that the estimates were stable for the genes within each dataset. An exception was H3K4me3, where the variogram suggested two different parameters for high and medium marked genes. In addition, for 19 out of 23 (83%) experiments the parameter was either 25 or 26. This stability is in line with the cross-validation presented above. It further provides evidence that p can be selected constant for the analysis of different ChIP-seq datasets, hence making its application more straightforward in future applications. However, the values derived from the variogram analysis differed from those determined in the cross-validation of the previous section. Hence, we revisited the cross-validation results for the LPC parameters 25 and 26 (Supplementary). Further, we investigated the cross-validation performance of LPCHP, when a customized p () was set for each dataset included in the analysis. When compared to the previous LPCHP with p = 4, we did not find significant improvements on the classification accuracy. The result indicates that LPCHP is robust against changes in p, including cases where it was customized to each dataset. In addition, the variogram analysis estimated constant parameters p from all ChIP-seq datasets. Together this suggests that it is appropriate to use the same parameter for the datasets analyzed here.
Analysis of robustness of the LPCHP parametersIn the analysis of the past two sections, our approach performed well in cross-validation for multiple parameters. However, it is unclear if different parameter sets extract the same structural information from the underlying ChIP-seq datasets. Therefore, we further evaluated the LPCHP using the recurring task of de novo gene groupings. We reasoned that the proposed approach is robust in its parameters if for different parameterizations p the clustering results are identical or similar. This contrasts with clustering results that are highly dissimilar or close to random. The ARI was used to compare the clusterings for the genesetsdifferent parameterizations p and k-means clustering (k = 3) are used (). In general, the ARI values were high, indicating excellent congurence between parameterizations.The greatest similarity was found between three of the five tested values p = 4,6 and 16 with ARI of 0.95 (p = 4,6), 0.93 (p = 4,16) and 0.95 (p = 6,16), respectively. This suggests that further downstream analysis would be marginally influenced if p was to be selected among these values. Similarly, the smallest ARI0.67 found for p = 6 and p = 8, was still relatively high. The high congruence suggests that the proposed methodology is robust for tested paramters p. It further argues that the different parameterizations tested recover similar signal characteristics, and that the choice for p is less critical. In addition to the previous section, this suggests that the parameter p = 4 is ideal for the analyzed datasets. Therefore, we fixed this parameter, and applied our method to the prediction of histone function in the next section.
Signal analysis for genome-wide maps
Histone function prediction using LPCHPIn the second application, we investigated if structural features obtained through LPCHP can identify commonalities between different histone modifications. In particular, we hypothesized that similarity information would be most apparent in the two setsTherefore, we performed hierarchical cluster analysis of the five well characterized histone modifications associated with transcriptional activation: H3K4me1, H3K4me2, H3K4me3, H3K36me3 and PolII as well as three repressive marks: H3K27me3, H3K9me2 and H3K9me3. This analysis () indicated a clear clustering between the activating and repressing histone marks. Motivated by this finding we hypothesized that the LPCHP could be utilized to characterize or predict the function of less well-defined HMs. The LPCHP profiles calculated from the two gene groups G H ,G L were used as features for the HM (). A training set was built using the eight well-characterized active and repressive chromatin marks, as described above. Note that methylations that did not clearly correlate with gene expression in human CD4 + T-cells, e.g. different methylations of H3K79, H4K20me3 or the variant H2A.Z that was previously associated with activation (TSS) and repression (gene body) depending on the genome region, were not used in the training set.. In each plot a clear clustering between the activating (green) and repressive (red) marks can be seen. In (B) we illustrate the histone function prediction as detailed in the text. Note, that in each group of histone modifications, e.g. A, R and X, the distances between nodes were calculated using the force-weighted layout within Cytoscape. Nodes were colored according to the predicted function of the HM they present. We used red for repressive and green for active marks.The training data were then used to predict the potential function of the other 14 histone ChIP-seq profiles inand. Within this set, seven marks were consistent with active chromatin and the other seven marks were associated with repressed chromatin around the TSS. Two of the seven inactive marks, (H3K27me2, H2AZ) were also assigned as such bywhile five (H3K79me2, H3K36me1, H3R2me2, H4K20me3, H4R3me2) were in agreement with their known repressive role in gene expression (). Within the chromatin marks predicted as active by LPCHP, four (H3K9me1, H2BK5me1, H4K20me1, H3K27me1) were in agreement withwhile two (H3K79me1 and H3K79me3) were consistent with the predictions made by. The LPCHP approach also predicted an active role for H3R2me1. While this mark was assigned, it is known to accumulate across the coding regions of active genes in yeast, where it correlates with active transcription (). Taken together, LPCHP performs robustly in predicting chromatin function when analyzing enrichment profiles at TSS.
DISCUSSIONThe analysis of enrichment profiles is currently based on read intensities and do not take into account signal structure. We show that modeled signal structures (LPCHP) from a set of 23 ChIPseq experiments correlate well with gene expression. We also show that LPCHP can be used to gain insights into chromatin function. It is important to note that the binding profiles obtained from HM ChIP-seq are a superposition of signals from the histone modification and underlying location of the nucleosome. Therefore, the reported correlations likely reflect the influence of both factors, and normalization in the presence of data on total H2, H3 and H4 levels is necessary to avoid this bias. LPCHP is better suited for comparative studies of chromatin function, particular in situations where the signal structure is expected to change, while the signal intensity remains constant. Importantly, nucleosome free regions (NFR) mark general sites of transcription initiation for coding and non-coding RNAs, and are influenced by a combination of DNA sequence and transcription factors (Radman). If nucleosome repositioning is assumed in ChIP-seq libraries, our approach is expected to detect the associated peak shift, while no differences would be detected from the signal intensities. The LPC approach can also be extended for the analysis of other sequencing protocols such as the distinction of nucleosome positioning between methylated and non-methylated CpG islands (). Incorporating peak shape information will further facilitate the identification of specific TF binding to one of multiple, closely situated binding sites, as typically seen in promoters of critical developmentally regulated genes. Furthermore, our analysis pipeline automatically reduces noise and handles data scaling and normalization, while obtaining spectral features, which can be further analyzed using a variety of previously developed spectral pattern comparison techniques ().
CONCLUSIONIn conclusion, both applications show that the LPCHP and the signal structural that they represent, provide a useful feature that is currently neglected in the literature. Since we show that the LPCHP can be used as an alternative to read intensities, its utility may extend beyond ChIP-seq to other next-generation sequencing applications. It will be particularly useful in situations where read intensity information is either insufficient or non-informative. In addition, the transformation of the original signal into LPC feature vectors is a useful intermediate allowing for the application of various machine learning algorithms. As recently noted, a particular important task in bioinformatics is the identification of all possible chromatin states (), which could be obtained from a simple vector quantization analysis of the LPCHP. Other potential applications include the identification of enhancer or regulatory regions in the genome. In addition, further methodological development is needed to extend the application of LPCHP to the analysis of more complex genomic features. This includes, for example, the comparison of HM binding structures in gene body regions that are variable in length, and the number and length of exons, introns and enhancers.
The Author 2012. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oup.com at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
