Pyrosequencing of 16S rDNA is widely used to study microbial communities, and a rich set of software tools support this analysis. Pyrosequencing of protein-coding genes, which can help elucidate functional differences among microbial communities, significantly lags behind 16S rDNA in availability of sequence analysis software. In both settings, frequent homopolymer read errors inflate the estimation of microbial diversity, and de-noising is required to reduce that bias. Here we describe FunFrame, an R-based data-analysis pipeline that uses recently described algorithms to de-noise functional gene pyrosequences and performs ecological analysis on de-noised sequence data. The novelty of this pipeline is that it provides users a unified set of tools, adapted from disparate sources and designed for different applications, that can be used to examine a particular protein coding gene of interest. We evaluated FunFrame on functional genes from four PCR-amplified clones with sequence depths ranging from 9084 to 14 494 sequences. FunFrame produced from one to nine Operational Taxanomic Units for each clone, resulting in an error rate ranging from 0 to 0.18%. Importantly, FunFrame reduced spurious diversity while retaining more sequences than a commonly used de-noising method that discards sequences with frameshift errors. Availability: Software, documentation and a complete set of sample data files are available at
INTRODUCTIONPyrosequencing of 16S rDNA is commonly used to study microbial community structure, and existing bioinformatics pipelines are primarily designed for the analysis of 16S rDNA (). Noise from DNA sequencing errors upwardly biases the estimates of microbial diversity (). Substantial progress has been made to remove noise artifacts from 16S rDNA sequence datasets (). Targeted metagenomics of protein-coding genes offers the possibility of focusing on the diversity, abundance and expression of specific genes, particularly those genes that encode enzymes critical to biogeochemical cycling. Protein-coding sequences fundamentally differ from non-coding 16S rDNA in that the genetic code implicitly constrains the sequences to the 61 amino-coding triplets. This distinction is particularly relevant with pyrosequencing, as the technology is prone to misread the lengths of long homopolymers, thereby creating the appearance of frameshift mutations. To reduce the inflated diversity bias with proteincoding genes, a commonly used approach discards sequences containing unexpected stop codons (). A more nuanced error detection algorithm, HMM-FRAME, was recently introduced (). In HMM-FRAME, a hidden Markov model (HMM) of the target protein, combined with a probabilistic model of homopolymer errors, detects and corrects the frameshifts caused by homopolymer read errors. In addition, the algorithm reports HMM alignment scores, which can be used in downstream quality filtering. To facilitate targeted metagenomics using PCR-amplified protein-coding genes, we produced FunFrame, a complete bioinformatics pipeline that uses HMM-FRAME followed by chimera detection, Operational Taxanomic Unit (OTU) clustering, rarefaction and diversity estimation (Supplementary). Additionally, FunFrame performs clustering and ordination using UniFrac and BrayCurtis metrics (Supplementary Figs S2 and S3). Contrasting with the 16S rDNA pipelines QIIME () and Mothur (), FunFrame centers around the R Project for Statistical Computing (R Core), which facilitates analysis with a rich set of ecological, statistical and visualization tools ().
METHODSThe FunFrame pipeline begins with HMM-FRAME () for pyrosequencing error analysis; UCHIME () for chimera detection (running in de novo mode without a reference database) and ESPRIT-Tree () for OTU clustering. FunFrame performs ecological analyses on the resulting OTU table. Sub-sampled diversity estimation is computed with QIIME (). BrayCurtis distances of Hellinger-transformed counts are computed in Vegan (). To compute unweighted and weighted UniFrac metrics (), representative OTUs are aligned with PyNAST (), a phylogeny is inferred using FastTree () and UniFrac metrics are computed from the tree. Principal coordinates analysis and hierarchical clustering are performed in R on the BrayCurtis and UniFrac metrics. Rarefaction curves and alpha diversity estimates are computed in Vegan. Redundancy analysis and constrained correspondence analysis are computed with user-supplied environmental variables and displayed as biplots using Vegan. FunFrame programs are written in R and Python. A bash script runs the full pipeline; alternatively, users can run pipeline stages individually. *To whom correspondence should be addressed. A user-customizable configuration file specifies all parameter settings. Installation and operating instructions are provided with the software distribution, as are sample data with expected outputs. Environmental clones containing the gene nirS, a gene in the microbial denitrification pathway (), were prepared (GenBank accessions KC203032KC203035) and sequenced along with amplicon libraries (Supplementary) of environmental samples taken from sediments of the Great Sippewissett Salt Marsh, Cape Cod, MA, USA (Supplementary Methods). Sequences mismatching the 5 0 primer or having ambiguous bases were removed, and remaining sequences were trimmed to 432 bp. With these inputs, we ran FunFrame using the cytochrome D1 HMM from Pfam (accession PF02239.10), and retained sequences with HMM scores485. OTUs were defined as sequences within a 0.05 divergence. To compare FunFrame against stop-codon filtering, FunFrame was modified to replace HMM-FRAME with logic that translates sequences in three reading frames, and retains those with a full reading frame.
RESULTS AND DISCUSSIONIn evaluating HMM-FRAME over the stop-codon filtering approach, we sought two objectives. First, we wanted to minimize the upward diversity estimation bias due to homopolymer errors, and we measured this property by analyzing the OTU counts of four clone libraries, measured at sequence depths of 9084, 5780, 11 382 and 14 494. Of these four libraries, FunFrame reported 9, 3, 3 and 1 OTUs per clone, whereas the stop-codon filter approach reported 11, 4, 3 and 2 OTUs per clone, respectively (Supplementary).shows that FunFrame produces lower OTU counts than stop-codon filtering. Our second objective was to maximize the number of nonnoisy sequences retained, which effectively increases the likelihood of detecting rare species. Starting with 119 663 total reads, the HMM filtering approach retained 117 659 (98%) reads, whereas stop-codon filtering retained 104 347 (87%) reads. After subsequent chimera detection, FunFrame retained 108 603 (91%) versus 95 902 (80%) reads for stop-codon filtering (Supplementary). This improvement is reflected in the greater number of sequences shown in the solid, compared with the dotted, lines in. Analysis of these data demonstrates the pipeline's capacity to uncover ecologically meaningful patterns in environmental sequences (Supplementary Figs S2 and S3). In both criteria, FunFrame performed better than the stopcodon approach. FunFrame discards sequences with HMM scores below a configurable threshold, and adjusting this threshold can trade-off sequencing depth for OTU inflation. The results indicate that this parameter can be set such that both objectives exceed the results from the stop-codon filtering approach. Microbial ecological analysis based on functional genes is an enormously powerful paradigm, which we believe will become widely used as DNA sequencing costs continue to decline. We offer FunFrame to the community with the hope that it will contribute to the development of this important area.
ACKNOWLEDGEMENTSHilary Morrison performed the pyrosequencing at the Marine Biological Laboratory. Sarah Hallin and Chris Jones kindly contributed their exceptionally well-curated nirS alignment. We thank an anonymous reviewer for making substantial and valuable technical suggestions.
The Author 2013. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
FunFrame at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
D.Weisman et al. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
