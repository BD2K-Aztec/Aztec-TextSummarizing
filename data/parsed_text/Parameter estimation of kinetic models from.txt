Motivation: Time-series measurements of metabolite concentration have become increasingly more common, providing data for building kinetic models of metabolic networks using ordinary differential equations (ODEs). In practice, however, such time-course data are usually incomplete and noisy, and the estimation of kinetic parameters from these data is challenging. Practical limitations due to data and computational aspects, such as solving stiff ODEs and finding global optimal solution to the estimation problem, give motivations to develop a new estimation procedure that can circumvent some of these constraints. Results: In this work, an incremental and iterative parameter estimation method is proposed that combines and iterates between two estimation phases. One phase involves a decoupling method, in which a subset of model parameters that are associated with measured metabolites, are estimated using the minimization of slope errors. Another phase follows, in which the ODE model is solved one equation at a time and the remaining model parameters are obtained by minimizing concentration errors. The performance of this two-phase method was tested on a generic branched metabolic pathway and the glycolytic pathway of Lactococcus lactis. The results showed that the method is efficient in getting accurate parameter estimates, even when some information is missing.
INTRODUCTIONAdvancements in biological techniques have made time series measurements of metabolite concentration more readily available, providing data for the creation of kinetic metabolic network models in the form of ordinary differential equations (ODEs). Time-course data contain information about the structure and dynamics of the metabolic pathways, but such information is implicit and must be extracted using an inference method. This inverse modeling task has motivated the creation of various methods for parameter estimation and structure identification, as summarized in a recent review (). However, the inverse modeling of biological systems is often complicated by the lack of complete data, * To whom correspondence should be addressed.poor data quality (noise) and the computational difficulty in solving model equations and optimization problems. Existing techniques often fail to yield accurate parameter estimates due to one or a combination of these reasons. Time-series datasets for metabolites are usually incomplete and noisy due to two roadblocks: complexity and technology. The high complexity of metabolic networks with a large number of metabolites means that the complete measurement of all relevant metabolites is not practically feasible. In addition, in order to accurately capture the dynamic behaviors of metabolites, the timecourse data should be measured frequently enough, which often challenges the limit of the available techniques. Furthermore, in experiments, several time points of metabolites could be missing because of various reasons (e.g. human error). While the issue of missing time-points can be partly addressed by data interpolation, the complete loss of data from metabolites poses a more challenging problem in parameter estimation and is the focus of the present work. In few instances, it may be possible to obtain missing metabolite measurements by analyzing the convex basis of the left null space of the stoichiometric matrix, which gives the sets of metabolites whose total weighted concentration is time invariant (). Among canonical ODE models of metabolic networks, power-law models within the Biochemical Systems Theory (BST) (), such as S-system, have drawn much attention due to many advantages (). The generic form of an S-system model is given by:where X is an n-dimensional metabolite concentration vector and the parameter vector p consists of the rate constants ( i ,  i ) and kinetic orders (g ij , h ij ). The sign of the kinetic orders indicates the nature of the connectivity among metabolites, where a positive value represents a substrate or activation and a negative number
Estimation of kinetic models from metabolic profilesrefers to an inhibition. That is, in S-system models, the parameter values directly describe the connectivity of the metabolic pathway, including stoichiometric and regulatory relationships. This oneto-one relationship between parameters and structural features facilitates parameter estimation and network structure identification in a single step (). One of the challenges when applying standard parameter estimation methods (e.g. least square or maximum likelihood) to S-system models is in the expensive numerical computation of the model solution, where ODE simulations become practically infeasible for some parameter combinations due to stiffness. In one example, the time taken by the ODE integrations in estimating parameters of an S-system model made up >95% of the total computational time (). Another challenge is the combinatorial increase in the number of parameters as a function of the number of metabolites, leading to a large-scale optimization problem. Even after more than 100 publications on this topic, the parameter estimation remains the bottleneck in the application of BST modeling for biochemical networks (). In this article, a new parameter estimation procedure is proposed that combines two methods: the decoupling method () and the ODE decomposition method (). Provided that all metabolite measurements are available, the decoupling method is a highly efficient estimation procedure that avoids solving ODE integration altogether by fitting models to the slope of time-series data. In the ODE decomposition method, the model equation is solved one at a time, and likewise this method decouples the parameter estimation problem. While each of these methods has its own merits (see Section 2), the proposed iterative estimation is created to keep the advantages and to lessen the disadvantages of the original methods.
METHODS
Decoupling methodIn order to circumvent expensive computational efforts in solving coupled ODEs, a method was proposed previously by fitting the right hand side of the ODE model in Equation (1) to the slope of concentration data directly, thereby decoupling the ODEs (, b):Thus, assuming that time-series concentration data of all metabolites X i (t k ) are available, the slopes S i (t k ) can be calculated and the estimation simplifies to solving a set of nN (nonlinear) algebraic equations, where N is the number of time points. Note that since there is no integration of the ODEs, the minimization of the difference between slopes and f (X,p) is computationally efficient, even for a large number of parameters. However, one drawback of this method is that the mole balance is only satisfied at discrete time points t k and thus, the resulting parameter estimates often give concentration time profiles that offset the data. When data are noisy, slope estimates by finite differencing will have spurious fluctuations as noise are amplified by such calculations. Thus, data smoothing is a necessary step in this method, for example using polynomial fitting, neural network () or automated smoother (). Regardless of the smoothing method, extra care has to be taken to avoid data overfitting, and even with automated methods, user judgment is still needed in this process.
ODE decomposition methodA different decoupling method has been proposed that involves solving each of the ODE one-by-one, and parameter estimates are obtained by minimizing the sum of squares of concentration difference between model simulations and data (). During the integration of one ODE, the other states (metabolites) are treated as external inputs, whose values are interpolated from smoothen time-series data. By solving and fitting one metabolite at a time, this method avoids the integration of coupled ODEs and also reduces the parameter search space. In contrast to the decoupling method above, the mole balance of each metabolite is approximately satisfied over time, not just at discrete time points. Furthermore, the method can still be applied in a situation where there are missing metabolite concentrations. However, the ODE stiffness problem, though lessened, is not completely eliminated.
Combined iterative estimationThe proposed parameter estimation in this work iterates between the two methods above according to the flowchart shown in. By doing so, this method combines the computational efficiency of the decoupling method and reduced search space of the ODE decomposition method, and is also able to handle missing metabolite measurements. In consideration of missing data of some metabolites, the ODE model is rewritten as:where X m and X u denote the measured and unmeasured metabolites, respectively, p m includes all parameters appearing in f m , and p u includes the remaining parameters (specific to f u ) and the initial concentrations for X u. Prior to the iteration, data smoothing was performed to reduce noise effects and to obtain slope estimates. Using the smoothen data and initial guess of the parameters p u and p m , a simulation of unmeasured metabolites is carried out by solving the ODEs for X u only, as done in the ODE decomposition method. The first iteration then begins with the decoupling method to obtain p m by minimizing the following slope errors:where S m (t k ) is the slope of smoothen data for X m at t = t k. Using the estimates of p m , the values of p u are obtained in the next estimation phase by minimizing the concentration errors:in which the ODEs are solved one at a time. In this case, the ODEs for X u are solved prior to X m and the newly simulated X u values are then used in the next iteration. If there are more than one unmeasured metabolites, the ODEs for X u need to be solved simultaneously. The procedure iterates between the two estimation phases until convergence. Here, the iterationsare stopped when parameter estimates between iterations differ by less than a chosen convergence factor. In this article, the optimization problems in the two phases are solved using the SSm GO MATLAB toolbox (Scatter Search Method for Global Optimization) (). SSm is a population-based metaheuristic method designed to incorporate strategic responses, both deterministic and probabilistic, and has recently been shown to be effective in solving multi-minima optimization problems. In addition, to alleviate the ODE stiffness problem, each ODE simulation is limited to a given maximum time and those exceeding this upper bound are assigned a large objective function value.
G.Jia et al.
RESULTSThe performance of the proposed method is demonstrated in applications to a generic branched pathway () and the glycolytic pathway of Lactococcus lactis ().
A generic branched pathwayThe metabolic pathway in this example is given in, which describes the transformations among four metabolites (double-line arrows) with both feedback activation and inhibition (dashed arrows with plus and minus signs, respectively). The pathway is modeled in the form of an S-system with 12 kinetic parameters, as follows ():This model was used to generate in silico noise-free and noisy experimental data (10% additive noise, Gaussian, i.i.d.) using the parameter values reported in the original publication (see Supplementary) and with the assumption that only X 1 , X 2 and X 4 were measured. A 6th order polynomial, for which the adjusted R 2 reached a maximum, was chosen for data smoothing and to calculate the slope data. Adjusted R 2 was used here to avoid data overfitting (). In the parameter estimation, the search space was limited to  i ,  i . The numerical integrations were performed in MATLAB using ode15s. One practical issue affecting the parameter estimation in this example and a majority of biological system modeling is the lack of complete parameter identifiability (). In other words, not all parameters can be uniquely identified and only a subset can be determined from data. Here, the proposed method will first be evaluated under the ideal scenario, in which the estimation is done only for the subset of a priori identifiable parameters (AIPs) () (the other parameters were set to the original values) and using noise-free data. Application of standard least square estimation using fully coupled ODEs encountered numerical stiffness problem and failed to converge, and the decoupling method cannot be applied for estimation involving missing measurements. Thus, in this example, the ODE decomposition estimation was used for comparison.summarizes the estimation results under the ideal scenario described above. In this case, the performance of the proposed method using 0.01% convergence criterion is comparable to the ODE decomposition. The larger parameter deviations in the twophase estimation is caused by the polynomial smoothing to obtain the time slope data, without which the performance of the two estimation methods are virtually identical. In addition, by increasing the convergence factor, the proposed method can reduce computational time, but at the cost of increased errors in the parameter estimates. The results of estimating the full parameter set are given in,B and Supplementary Table S1. Even when data are noise-free, the relative errors of the parameter estimates can reach higher than 300% using the ODE decomposition method. While parameter identifiability issue certainly contributes to these errors, the ODE decomposition in this case failed to extract the maximum information available in the data, in comparison to the proposed method. Here, the application of the proposed iterative method using noise-free data and 1% convergence criterion gaveimproved parameter estimates and importantly, in much shorter time than the ODE decomposition (seeB and). The maximum relative error dropped to 150% and fewer parameters had errors above 50%. In addition, the predicted concentration and slope profiles were relatively better than those from the ODE decomposition alone. While the lack of fit to the missing X 3 data in both methods was expected, parameter estimates from both methods were able to capture the trend. The proposed iterative method again gave comparatively more accurate parameter estimates and finished in much shorter time than the ODE decomposition when using noisy data. The results from the two estimation methods are shown in Figures 3CD and 4CD and in. As expected, these parameter estimates were on average less accurate than those obtained from noise-free data. However, the estimation in this case took two to three times longer than those using noise-free data.
Estimation of kinetic models from metabolic profiles
The glycolytic pathway in L.lactisThe second case study was taken from the modeling of the glycolytic pathway of L.lactis using S-system () (Supplementary). Experimental time-course data of the metabolites were previously obtained using in vivo NMR (Neves). Here, the concentration variables denote the following metabolites:First, using the parameters reported in the original publication () (Supplementary), in silico noise-free data were produced for all metabolites, except X 3. In this case, we have used a piecewise polynomial fitting, since the data before t = 9.4 min had markedly different dynamics. Specifically, eighthorder and second-order polynomials were used in the fitting before and after this time, respectively, again based on maximizing the adjusted R 2. The parameter search space was limited such that  i ,reports the parameter estimation results using the ODE decomposition and the two-phase iterative method. Compared with the results from the ODE decomposition (and), the proposed method gave better concentration and slope fitting at roughly three times lower computational cost. In addition, the parameter errors from the two-phase method, though large, were comparably lower. Even with the full measurements, parameter identifiability issue has been shown to exist in this system (). Finally, the two-phase iterative estimation and the ODE decomposition were applied to published smoothen NMR data using automated smoother (), again without X 3 The estimation results are also summarized inand illustrated in. As before, the proposed method gave markedly improved concentration and slope data fitting in shorter amount of time than the ODE decomposition method.
DISCUSSIONThe proposed iterative parameter estimation method builds on the strengths of the decoupling method and the ODE decomposition method. By decoupling the ODEs, this method is significantly faster than other methods that require integrating complete coupled ODEs at each objective function evaluation, while still giving good fit to measured concentration data. In addition, like the ODE decomposition method, the combined approach does not require complete measurements of all metabolites and has much reduced parameter search space. As shown in the applications to the two cases, the proposed method was superior to the two methods from which it was developed. When metabolite measurements were incompletely available, the decoupling method could not be applied. Compared with the ODE decomposition method, the proposed method gave more accurate parameter estimates and better data fit (slope and concentration) at a much lower computational cost. While the fit to missing concentration measurement had an offset, it is noteworthy that the dynamic trend can be captured. The combination of slope and concentration fitting had also been used in several existing parameter estimation methods. For example, Wang and Liu had developed a method where kinetic
The Author 2011. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oup.com at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from [13:14 22/6/2011 Bioinformatics-btr293.tex] Page: 1969 19641970 Estimation of kinetic models from metabolic profiles parameters were estimated simultaneously by minimizing both slope and concentration errors using a multiobjective optimization framework (Wang and Liu, 2008). Similar to the two-phase method here, Gennemark and Wedelin had proposed a multi-step method, where a derivative method was used to obtain an initial, rough guess of model parameters, for subsequent minimization of concentration error (Gennemark and Wedelin, 2007). These two methods however assumed that all metabolite measurements are available. Notably, in the latter, the ODEs were also solved one at a time using single or multiple shooting methods, thereby decoupling the parameter estimation problem as in the ODE decomposition. The shooting method can in fact be used to substitute the role of ODE decomposition in the two-phase iterative estimation, giving an alternative method. Another method extended a class of ODE solvers, called orthogonal collocation method, for estimating model parameters (Ramsay et al., 2007). In this case, the concentrations were approximated as a linear combination of basis functions, where the coefficients were treated as nuisance parameters. Model parameters were then simultaneously estimated by minimizing the approximation errors between the simulated concentration and the data, and between the time-derivative of concentration prediction and the right hand side of Equation (1). Despite the similarities, the proposed method differs from this and the above methods in the grouping parameters into two, those that are associated with measured variables and those with unmeasured concentrations. By doing so, the parameter estimation can be solved more efficiently (solving a few small parameter estimation problems is easier than solving the combined, simultaneous estimation). Also, in this case, when more metabolites are measured, the estimation naturally becomes faster, since more parameters will be estimated in the first, computationally efficient phase. Although the proposed method performed better than the ODE decomposition in terms of data fitting (i.e. lower slope and concentration errors), many of the parameter estimates were far from the true values (see Supplementary Tables S1 and S3). This may not be surprising as that the estimation problems had assumed missing data for one metabolite. Nevertheless, even with complete data, parameter identifiability has been shown to be lacking in the estimation of kinetic parameters from time-series data and the severity of this problem can be assessed quantitatively (Raue et al., 2009; Srinath and Gunawan, 2010). Related to the identifiability issue, the kinetic information contained in different metabolites are not equal. The expected degradation in the accuracy of the parameter estimates from missing data depends on the degree of connectivity of the missing metabolite in two ways. The kinetic information (i.e. rate of change) of a metabolite is partially contained in the downstream and upstream metabolites in the metabolic network. The higher the degree of connectivity, by stoichiometry, of a missing metabolite, the more can the missing flux information be extracted from the available data. While this missing flux can be determined, the (initial) concentration of the unmeasured metabolite however is still lost. Thus, it is possible to capture the trend of the missing profiles, but not the concentration values, giving an offset between the simulated and true concentrations, as seen in the first and to some degree in the second example above. However, when considering regulatory connectivity, the concentration of metabolite(s) is important. Here, the loss of concentration data of an important, highly connected regulatory metabolite will lead to a significant loss of information that cannot be easily recovered. In the first example, the loss of metabolite X 3 data represented the worst-case scenario, as this metabolite has a high regulatory connectivity and missing downstream metabolite data. On the other hand, if X 2 was not measured, the parameters can still be identified from other metabolites, since the set of p u is null, i.e. the estimation can be done using only the decoupling method. Finally, an increase in the number of unmeasured metabolites will, in general, lead to lower overall kinetic information and poorer parameter estimates. In the first example, missing both X 2 and X 3 indeed gave less accurate parameter estimates, but the two-phase method still outperformed the ODE decomposition (Supplementary Tables S1, S2 and Figure S1). For a given system, the computational requirement of the proposed method depends on several aspects, such as the number of measured and unmeasured metabolites, the number of parameters associated with measured and unmeasured metabolites, the convergence speed of the iterations, and as seen in the example, the noise in the data. In general, the higher the number of parameters involved in the first phase, the faster will the estimation finish. Unfortunately, the scalability of the method to larger systems is difficult to be determined as all of the factors mentioned above will interact. For example, the scaling will depend on the distribution of the additional parameters between the two phases as well as on the dynamics of the system (e.g. related to stiffness of the ODEs). In addition, the convergence will also play an important factor, but unfortunately, this is difficult to consider as the two phases have different objective functions. Finally, while the applications considered in this article were taken from S-system models, the proposed iterative estimation is not limited to only BST models. The reason to consider these examples was that these models represent some of the most difficult parameter estimation problems due to the large number of parameters, stiff ODEs, and high degree of nonlinearity. The proposed method can also be applied to problems in which complete time-series data are available. In such a case, the parameters can be divided into two groups based on the level of difficulty in estimating them in each estimation phase. For example, for S-system models, the kinetic orders can be grouped together in the first phase (decoupling method), while the rate constants can be estimated in the second phase (ODE decomposition).
