Motivation: The rapid development of genotyping technology and extensive cataloguing of single nucleotide polymorphisms (SNPs) across the human genome have made genetic association studies the mainstream for gene mapping of complex human diseases. For many diseases, the most practical approach is the population-based design with unrelated individuals. Although having the advantages of easier sample collection and greater power than family-based designs, unrecognized population stratification in the study samples can lead to both false-positive and false-negative findings and might obscure the true association signals if not appropriately corrected. Methods: We report PHYLOSTRAT, a new method that corrects for population stratification by combining phylogeny constructed from SNP genotypes and principal coordinates from multi-dimensional scaling (MDS) analysis. This hybrid approach efficiently captures both discrete and admixed population structures. Results: By extensive simulations, the analysis of a synthetic genome-wide association dataset created using data from the Human Genome Diversity Project, and the analysis of a lactase-height dataset, we show that our method can correct for population stratification more efficiently than several existing population stratification correction methods, including EIGENSTRAT, a hybrid approach based on MDS and clustering, and STRATSCORE , in terms of requiring fewer random SNPs for inference of population structure. By combining the flexibility and hierarchical nature of phylogenetic trees with the advantage of representing admixture using MDS, our hybrid approach can capture the complex population structures in human populations effectively. Software Availability: Codes can be downloaded from
INTRODUCTIONThe rapid development of genotyping technology and extensive cataloguing of single nucleotide polymorphisms (SNPs) across * To whom correspondence should be addressed. the human genome have made genetic association studies the mainstream for gene mapping of complex human diseases. For many diseases, the most practical approach is the population-based design with unrelated individuals. Although having the advantages of easier sample collection and greater power than family-based designs, population-based design is prone to population stratification (). Population stratification refers to the presence of a systematic difference in allele frequencies between subpopulations in a study due to ancestry difference between study subjects. Unrecognized population stratification can lead to both false-positive and false-negative findings and can obscure the true association signals if not appropriately corrected. There are three types of population structures that might be observed in genetic association studies: discrete population structure consists of populations that are remotely related (such as Europeans, Africans and Asians) and the population structure is easy to discern as the individuals are clearly separated. Admixed population structure consists of subjects of admixed ancestry (such as African Americans and Hispanic Americans) with different individuals having different degrees of admixture, and that cannot be separated into discrete clusters. Intercontinental gradients can also be considered as admixed, although the degree of admixture is smaller than African Americans and Hispanic Americans. In other scenarios, we may see hierarchical population structure that consists of both discrete and admixed population structures. Hierarchical population structures may be seen in studies that involve multi-ethnic cohorts, which are becoming increasingly common in genetics consortiums (). Recognizing the issue of population stratification induced by population structures, various methods have been developed to control for population stratification. Two early approaches are genomic control () and structured association (). The genomic control method corrects for stratification by adjusting association statistics with an overall inflation factor obtained from a set of random markers that are not associated with the phenotypes of interest. However, some markers differ in their allele frequencies across ancestral populations more than others. Thus, the uniform adjustment may be insufficient at markers having strong differentiation across ancestral populations and may be superfluous at markers lacking such differentiation. Structured association uses STRUCTURE program () to assign the study subjects to discrete subpopulations and then aggregates evidence of association within each subpopulation. This method is computationally intensive, andPage: 799 798806
Population stratification in genetic association studiesassignments of subjects to clusters are sensitive to the number of clusters, which is often ill defined in many real studies. The current state-of-the-art approach for the correction of population stratification is EIGENSTRAT (), which computes principal components for SNPs across the genome to identify population structure. In this approach, a small number of 'top' principal components will capture the main axes of genetic variation in the study subjects. Correction for population stratification is carried out by including these top principal components as covariates in a regression framework. Although popular, several studies have demonstrated that EIGENSTRAT will fail to correct for population stratification in certain scenarios (). Recently, Li and Yu (2008) proposed an extension of EIGENSTRAT by incorporating cluster information obtained from multi-dimensional scaling (MDS) analysis as additional covariates in the adjustment. This MDS clustering approach tries to identify both discrete and admixed patterns of genetic variation and correct for their potential confounding effects by adjusting each position of subject along identified axes of genetic variation and the cluster membership simultaneously. This method is a direct extension of EIGENSTRAT when the metric used by EIGENSTRAT is adopted for measuring the genetic correlation between two subjects. Simulation results demonstrate that the MDS clustering method provides a more appropriate correction for population stratification than EIGENSTRAT under simulation settings that they considered (). The goal of this article is to utilize phylogenetic trees to correct for population stratification in genetic association studies with unrelated individuals. Widely used in the study of evolution and other fields of biology, a phylogeny represents the evolutionary relationship between species as a tree structure, where each leaf is an observed species, each internal node corresponds to the most recent common ancestors of all species below it and each internal edge represents a bipartition of leaves due to evolutionary divergence. The use of phylogenetics in the study of human genetic diversity has a long history dating back to the sixties: the approach was first proposed by Cavalli-Sforza and Edwards (1967) who developed likelihood estimation methods using allelic frequencies in subpopulations. Distance measures that adjust allelic frequencies are also available (). The phylogenetic approach has been used extensively in the analysis of the Human Genome Diversity Project (HGDP) (http://www.stanford .edu/group/morrinst/hgdp.html), which genotyped more than 1000 individuals collected at more than 50 geographic locations around the world. The HGDP dataset has well-defined subpopulations and complete population identification. The resulting phylogenies, using microsatellites and SNPs, have been highly consistent and compatible with the widely accepted pattern of human migration (). We propose a phylogenetics-based approach for correction of population stratification based on several motivations. First, widely used and thoroughly tested for decades to study evolution, phylogenetics is a natural choice for detecting divergence in human subpopulations. Phylogenetic analysis of the HGDP dataset shows that this approach is robust and sensitive to subtle population structures (). Second, thanks to decades of work by an active research community, many phylogenetic reconstruction algorithms have been developed, and efficient and versatile programs are widely available. Third, the hierarchical characteristic of a phylogeny is easy to interpret and visualize. Finally, phylogenetic trees are more flexible to represent highly complex spatial structures than clusters obtained from clustering-based algorithms (). To correct for discrete, admixed and hierarchical population structures, we propose to combine information from phylogeny and MDS together with the phylogenetic tree representing discrete population structure and the principal coordinates of MDS analysis representing admixed population structure. Given the flexible nature and the hierarchical characteristic of phylogenetic trees, we expect this hybrid approach to perform well under complex population structures, such as those from multi-ethnic studies with some of the study samples showing admixed population structure, whereas other study samples showing discrete population structure ().
METHODS
Construction of a phylogenetic treeThe first step in our method is to construct a phylogenetic tree of subjects from the genetic marker data. We opt to use the distance-based approach, which accepts as input a distance matrix, i.e. the pairwise dissimilarities between every pair of individuals based on SNP genotypes and constructs trees entirely from the distance matrix (). In our analysis, we code the SNP genotypes as 0, 1 and 2, representing the number of minor alleles, and calculate the distance as '2the number of alleles that are identical by state' between two individuals. We then built the phylogenetic tree using the FastME algorithm (), a very fast distance-based phylogeny reconstruction algorithm that shows better topological accuracy than the commonly used neighbor joining algorithm () in simulation studies. Compared with other more computationally intensive methods such as maximum likelihood or maximum parsimony, the distance-based approach is much more tractable, especially when the number of individuals or the number of markers becomes large. Note that the leaves of the constructed phylogenetic tree are individual subjects in the study sample instead of subpopulations.
Reduced representation for the phylogenetic treeWe reduce the phylogenetic structure into a collection of bipartitions on subjects in order for us to incorporate information from the phylogeny in the association tests as covariates in a regression framework. Each bipartition corresponds to an internal edge in a phylogenetic tree, which divides the data into two groups: a phylogenetic tree with n leaves (subjects) will have up to n3 internal edges; in turn, the entire phylogenetic tree can be fully recovered by these (n3) bipartitions. For each bipartition, we can construct a 0-1 vector indicating the bipartition membership by assigning all members from one of the two subsets in a bipartition to have value 0, and all members from the other set to have value 1. We cannot use all of the bipartitions in the regression analysis, because (i) the degrees of freedom in the regression is close to the number of observations (subjects) and significance will never be reached; (ii) most bipartitions, in particular, bipartitions that separate a very small number of subjects from the rest, are not informative for the purpose of population stratification correction; and (iii) the bipartitions are not entirely independent; for example, bipartitions for adjacent edges may only differ by a small number of subjects. We select a subset of representative bipartitions based on the following criteria:(1) The relative size of either side of a selected bipartition is above some given threshold. We used 2.5% in our analysis.(2) Filter bipartitions by the correlation threshold so that each remaining bipartition is correlated with at least one selected bipartition. We used Page: 800 798806The corresponding instance to the minimum dominating set problem using correlation threshold 0.7. Black vertices (1, 2, 3, 6) form the solution returned by the greedy algorithm; bipartitions corresponding to the four vertices are also emboldened in the phylogeny (A) and labeled in boldface in the matrix of bipartitions (B). Note that because each vertex in (D) is adjacent to at least one black vertex, this ensures each of the six bipartitions is correlated with at least one of the four chosen bipartitions, so the reduced set of bipartitions still represents the topology of the original phylogeny well. 0.7 as the correlation threshold for discrete population structures, and 0.1 for admixed population structures in the simulation studies. For the analysis of the HGDP data and the lactase-height data, we also used 0.7 as the threshold. We discuss the selection of correlation threshold in Section 4.
M.Li et al.The bipartition selection problem can be formulated as the NP-hard minimum dominating set problem in graph theory as follows (): let G = (V , E) be a graph where each vertex in the vertex set V corresponds to a bipartition passing the size threshold. We add an edge between any two vertices (u, v) to the edge set E if the absolute value of the correlation between bipartitions associated with u and v is above the threshold. The minimum dominating set problem finds a smallest set of vertices V  V such that for every vertex u  V V , there exists a vertex v in V such that (u,v)  E. Our problem can then be solved by finding such a minimum dominating set for G; then every bipartition is correlated with at least one bipartition associated with a vertex in the dominating set. To select bipartitions, we implemented a simple approximation algorithm [where the size of the solution is at most 1 + ln the size of the optimal solution (Garey and)] by iteratively (i) selecting a vertex with largest degree and add to the cover, then (ii) removing all adjacent vertices and their incident edges from the graph. The selection step is repeated until all vertices are removed.illustrates the bipartition selection procedure.
MDS analysisMDS is a statistical technique that aims at displaying the similarity of members of a set of objects. This technique starts with a matrix of similarities or dissimilarities between a set of observations, and embeds the observations as points in a low-dimensional Euclidean space so that Euclidean distances between points in the plot are close to the original dissimilarities. Suppose that T is a (n  n) positive-semidefinite symmetric matrix of similarities among a set of n observations., 2, , n. Now consider the n observations as points in n dimensional space with the j-th coordinate for the i-th observation equal to c ij , the i-th element of c j. With this geometric interpretation of the n observations, the Euclidean distance between the h-th and i-th observations isPage: 801 798806), representing two, three and four subpopulations. In each setting, we generated simulated datasets each consisting of 500 cases and 500 controls, with varying numbers of random SNPs carrying information capable of differentiating among populations. To generate genotypes for the random SNPs, we followed the algorithm of. Specifically, for each subpopulation, the allele frequency for each SNP was generated using the BaldingNichols model () using F ST = 0.01. For each SNP, an ancestral population allele frequency p was drawn from the uniform distribution on (0.1, 0.9). The allele frequencies for each subpopulation were drawn from -distribution
Population stratification in genetic association studiesThis distribution has mean p and variance F ST p(1  p). To evaluate the performance of different population stratification correction methods, we considered four categories of testing SNPs: (i) the first category (random SNPs without association with disease) was generated the same way as those SNPs chosen for detecting population structure, i.e. F ST = 0.01. (ii) For the second category (differentiated SNPs without association with disease), we assumed a large allele frequency difference between the subpopulations. More specifically, for C1 and C2, we chose allele frequencies of 0.2 for population 1 and 0.8 for population 2; for C3 and C4, the allele frequencies are 0.8, 0.8 and 0.2, respectively, for the three subpopulations; and for C5 and C6, the allele frequencies are 0.2, 0.8, 0.2 and 0.8, respectively, for the four subpopulations. (iii) The third category of SNPs (random causal SNPs with association with disease) was for power evaluation in which the allele frequency was generated the same way as those random SNPs, i.e. F ST = 0.01; we then assumed a multiplicative model with a genotype relative risk of 1.5 for the causal allele to generate genotypes for the causal SNPs conditioned on the disease status. (iv) The fourth category of SNPs (differentiated causal SNPs with association with disease) was generated in a similar fashion as category (iii) except that the marker allele frequency was generated the same way as those from category (ii). Testing SNPs in categories (i) and(1 Africa Central African Republic (n = 29), Namibia (n = 5) Congo (n = 15) Nigeria (n = 23) Kenya (n = 12) Senegal (n = 23) 2 Middle Algeria-Mzab (n = 29), France (n = 48) East/Europe Israel-Carmel (n = 45), Italy (n = 35) Israel-Central (n = 49) Italy-Bergamo (n = 12) Israel-Negev (n = 47) Orkney Islands (n = 16) Russia (n = 25) Russia-Caucasus (n = 17)3 Central South China (n = 10) Cambodia (n = 11) Asia/Oceania/ Pakistan (n = 182) China (n = 169) East Asia/ Bougainville (n = 18) Japan (n = 27) America New Guinea (n = 16) Siberia (n = 25) Brazil (n = 45) Colombia (n = 13) Mexico (n = 49) population structure. Type I error and power were estimated based on 100 (datasets) 1000 (testing SNPs) = 100 000 tests. Setting 2: Cases and controls from an admixed population were simulated similar to that as described by. Disease status for individuals with ancestry proportions a from population 1 and (1  a) from population 2 were simulated using disease risk proportional to r a , where r is the ancestry risk and a is uniformly distributed on (0, 1). To insure an average value of 0.5 across possible values of a, the probability of being affected was set to 0.5 log(r)r a /(r  1). The risk model with a genotype relative risk of 1.5 for the disease allele was implemented the same way as discrete populations, with allele frequency ap 1 + (1  a)p 2. Similar to the simulations for discrete populations, we also considered two categories of SNPs to evaluate the type I errors and two categories of SNPs to evaluate the power. Setting 3: A casecontrol dataset of hierarchical population structure was simulated based on individuals genotyped in HGDP (), an international project for studying the diversity and unity of the entire human population. A total of 1064 individuals in this project, representing individuals from 51 populations from sub-Saharan Africa, North Africa, Europe, the Middle East, South/Central Asia, East Asia, Oceania and the Americas, were genotyped by the Illumina HumanHap 650K SNP array, which includes 650 000 SNPs. We downloaded the genotype data and sample description information from http://hagsc.org/hgdp/files.html. After merging genotype data and sample description and data cleaning, 995 individuals remained for analysis. To obtain casecontrol data with population structure, we created three artificial subpopulations:(. To infer population structure, we randomly selected 10 000 autosomal SNPs that have no missing genotypes and are in linkage equilibrium with each other (at r 2 < 0.05). We then tested for association with the casecontrol status using 515 710 autosomal SNPs that satisfy the following quality control criteria: (i) minor allele frequency >1% in both cases and controls, (ii) HardyWeinberg equilibrium test P-value > 1  10 7 and (iii) fraction of missingness <5%. For each method, we estimated the type I error rate at various levels ( = 0.01, 0.005, 0.001 and 0.0005 level) and calculated the genomic control inflation factor ().
Page: 802 798806
M.Li et al.
Application to lactase-height dataA classic way to test the performance of a population stratification correction method is to examine whether the method is able to remove the effect of population stratification between the lactase (LCT ) gene and height (). As we do not have access to the original data reported by, we created a lactase-height dataset using data from PennCAC, an ongoing candidate-gene study on coronary artery classification that we are working on. PennCAC includes 1361 Caucasians with phenotypes on height. These individuals were genotyped using the ITMAT/Broad/CARe (IBC) 50K SNP array (), which includes 1755 autosomal ancestry informative markers (AIMs) and 21 LCT SNPs. The originally reported LCT SNP, rs4988235, is not included in the IBC array, but two other LCT SNPs, rs3769005 and rs7579771, have strong LD with rs4988235 (r 2 = 0.72 in HapMap CEU samples). We, therefore, tested association between height and these two SNPs. For all population stratification correction methods that we considered for comparison, we inferred population structure using 100, 200, 250, 300, 500, 700, 1000 and 1755 autosomal AIMs.
RESULTSTo evaluate our proposed method, we carried out extensive simulations, including discrete population structure, admixed population structure and a synthetic casecontrol GWAS dataset generated from the HGDP data, which represents hierarchical population structure. We assessed whether the proposed method can appropriately correct for population stratification by estimating type I error rate, and also assessed its power in detecting disease association. We compared PHYLOSTRAT with four other methods, including (i) the conventional CochranArmitage trend test (), which does not control for population stratification, (ii) the EIGENSTRAT approach (), (iii) the MDS clustering approach (); and (iv) the STRATSCORE approach (). For STRATSCORE, as suggested by the authors (Dr Michael Epstein, personal communication), we adjusted the continuous stratification scores (obtained from principal components) rather than the quartiles of the stratification scores because this modified version of STRATSCORE generally leads to smaller type I errors than the original method under the simulation settings we considered. We did not compare with the genomic control approach becauseand Li and Yu (2008) have demonstrated its unsatisfactory performance. For type I error and power estimation, significance was evaluated at the 1% level.
Setting 1: discrete population structureTables 34 display the results for discrete population structures with two and four subpopulations, respectively. Results for three subpopulations are similar (Supplementary). In all situations we considered, PHYLOSTRAT has type I error rates that are close to the nominal level. The MDS clustering approach performs well when there are two discrete subpopulations; but when the number of discrete subpopulations is three or four and the population stratification is extreme, its type I error rates can be greater than the nominal level, especially when the number of random SNPs is small. For example, when there are four discrete subpopulations and when the degree of population stratification is extreme (i.e. configuration C6 in), the type I error rate of the MDS clustering approach can be as high as 10.19% with 100 random SNPs, 2.06% with 300 random SNPs, even with 500 random SNPs, the type I error rate isstill slightly inflated. Similar results are observed for EIGENSTRAT, which also yields inflated type I errors. In contrast, for this extreme situation, the type I error rate of PHYLOSTRAT is close to the nominal level even with only 100 random SNPs, much less than the number of random SNPs required by other methods to achieve the same level of type I error rate. This implies that PHYLOSTRAT uses the ancestry information contained in the random SNPs more efficiently. We observed that STRATSCORE can yield either inflated or conservative type I errors. As suggested by the authors (Dr Glen Satten, personal communication), we also implemented a modified version of STRATSCORE with 20 strata. This modified version yields appropriate type I errors when there are two underlying subpopulations; however, when the number of subpopulations is greater than 2, e.g. configurations C4 and C6, the type I errors are still inflated even with 500 random SNPs. It is possible that more strata are needed to appropriately control the type I errors when the number of subpopulations is more than two and the degree of population stratification is extreme. For causal SNPs in category (iii), PHYLOSTRAT, MDS clustering and EIGENSTRAT yield similar power, but the power for STRATSCORE is generally lower than the other three methods. For causal SNPs in category (iv), PHYLOSTRAT is more powerful than the other three methods under several settings. For example, for configuration C6 in, with 300 random SNPs, the power for PHYLOSTRAT is 51.27%, whereas the powers for EIGENSTRAT, MDS clustering and STRATSCORE are 39.06, 39.49 and 20.77%, respectively. This is because EIGENSTRAT and MDS clustering cannot completely remove the confounding effect due to population Page: 803 798806stratification, which obscures the true association signal, whereas STRATSCORE has conservative type I error rate. For causal SNPs in category (iv), we observed noticeable power change for each method as the number of random SNPs, m, increases, and such power change is also due to difference in ability to remove the confounding effect of population stratification.shows the results for admixed populations. We observed similar patterns for PHYLOSTRAT, MDS clustering, EIGENSTRAT and STRATSCORE. All these methods yield type I error rates that are close to the nominal level with STRATSCORE being slightly conservative. The power for detecting causal SNPs is similar for all methods.
Population stratification in genetic association studies
Setting 2: admixed population structure
Setting 3: HGDP dataWe applied our method to a dataset of 955 individuals from the HGDP data genotyped on the Illumina HumanHap 650 SNP array (). To simulate a dataset with population structure, we artificially created three populations (). The phylogenetic tree built from 10 000 randomly selected autosomal SNPs is shown in. With the same 10 000 random SNPs, we also conducted MDS analysis and plotted the first two principal coordinates (Supplementary). As shown in both figures, this synthetic GWAS dataset contains both discrete and admixed population structures. The genomic control inflation factor for unadjusted trend test with 515 710 autosomal SNPs is 17.3, indicating strongpopulation stratification in the data. Such a complex population structure poses a challenge to genetic association analysis, but also offers an opportunity to evaluate various methods. We analyzed the 515 710 autosomal SNPs using EIGENSTRAT, MDS clustering, STRATSCORE and PHYLOSTRAT, and then estimated type I error rate for each method based on the 515 710 tests as none of the SNPs are associated with case control status by design. At  = 0.01 significance level, the type I error rates of EIGENSTRAT, MDS clustering, STRATSCORE and PHYLOSTRAT are 0.0428, 0.0290, 0.0373 and 0.0232, respectively; when  = 0.001, the type I error rates of the four methods are 0.0087, 0.0047, 0.0067 and 0.0016, respectively; when  = 0.0005, the corresponding type I error rates are 0.0054, 0.0026, 0.0039 and 0.00048, respectively. We also estimated the genomic control inflation factor for each of the four methods: 1.66 for EIGENSTRAT, 1.45 for MDS clustering, 1.59 for STRATSCORE and 1.35 for PHYLOSTRAT. We also investigated the performance of these three methods with larger number of random SNPs (m = 30 000, 50 000 and 70 000), and obtained similar results. As the continent information is known for each individual, one might consider controlling population stratification by adjusting continent; however, the genomic control inflation factor for this simple approach is 2.67, much higher than the other three methods, suggesting that simply adjusting for continent is not sufficient. We also explored a hybrid approach by adjusting MDS principal coordinates and continent; the genomic control inflation factor for this approach is 1.45, similar to that of MDS clustering. Although Page: 804 798806none of the methods we considered completely corrected for population stratification for this complex synthetic GWAS dataset, PHYLOSTRAT did show more encouraging result than the other methods.
M.Li et al.
Analysis of lactase-height dataUsing the nave Armitage trend test, we observed significant associations between the LCT SNPs and height after adjusting sex (rs3769005: P-value= 1.8  10 6 ; rs7579771: P-value= 2.1  10 6 ), suggesting the presence of population stratification. We then analyzed this dataset with various population stratification correction methods with different numbers of AIMs (). We adjusted sex in all analyses. Our results indicate that PHYLOSTRAT performs favorably against the other methods. For example, with 250 AIMs, among the four methods we considered for comparison, only PHYLOSTRAT yields P-values >0.05 for both SNPs; whereas the other three methods require more AIMs to remove the effect of population stratification. Our results are consistent with, who also observed that EIGENSTRAT cannot completely resolve the confounding issue between LCT and height when only a small number of AIMs were used in the analysis.
DISCUSSIONWe have developed a new method to correct for population stratification in genetic association analysis by combining information obtained from phylogenetic trees and MDS analysis. Our method represents relations between individual's genetic background using a set of phylogenetic bipartitions and principal coordinates from MDS analysis, and incorporates them as covariates in a regression framework to adjust for the confounding effect due to hidden population stratification.As shown in our simulations, this hybrid approach effectively captures both discrete and admixed population structures. It yields a more appropriate correction for population stratification than EIGENSTRAT (), MDS clustering () and STRATSCORE () under discrete population structures; its performance is similar to these three approaches under admixed population structures. To evaluate the performance of our method when the population structure is hierarchical, we applied our method to the HGDP dataset, which contains real genetic variation patterns. Although none of the methods could completely remove the confounding effect of population stratification, PHYLOSTRAT performs favorably against the other methods and yields type I error rates that are closer to the nominal level. To test the performance of our method in real genetic association studies, we applied our method to a lactaseheight dataset and found that PHYLOSTRAT is able to correct for population stratification with only 250 AIMs, smaller than the number of AIMs required by the other methods. Our results suggest that phylogenetics is a robust and useful tool for inferring complex population structures, and appropriate utilization of information captured by phylogenetics trees can help correct for population stratification in genetic association analysis, especially when the number of random SNPs is small. We note that as the number of random SNPs used for inference of population structure increases (e.g. when m = 50 000), the type I errors of PHYLOSTRAT, EIGENSTRAT and MDS clustering are all close to the nominal level under simulation settings we considered, but the type I errors of STRATSCORE are conservative with the patterns similar to those seen in Tables 34 and Supplementary. These results suggest that when only a small number of random SNPs are available, one might consider using PHYLOSTRAT to control for population stratification, but when the number of random SNPs is large, EIGENSTRAT would be a preferable approach as it is computationally faster. It is worth noting that the bipartitions obtained from the phylogenetics tree can be used together with principal components as basis functions to build the stratification scores (Dr Glen Satten, personal communication), Page: 805 798806
Population stratification in genetic association studiesand such a modified version may improve the performance of STRATSCORE. Our method shares similarity with another hybrid approach MDS clustering () in that both methods use the principal coordinates from the MDS analysis to capture admixed population structure. To capture discrete population structure, the MDS clustering method assigns each individual a group membership based on clustering of the MDS principal coordinates, where the number of clusters is determined by the gap statistic (). However, the problem of estimating the number of clusters can be difficult, because in many situations there is no clear definition of a 'cluster'. Moreover, for data that are not clearly separated into groups, e.g. when there are overlapping classes, determining the number of distinct clusters can be highly subjective. In contrast, the use of phylogenies in our method circumvents this problem because our method does not require such parameter to be predefined. It is worth noting that clustering is a degenerate or a simplified version of phylogenetic tree. Unlike clustering, which can only handle simple population structures, phylogenetic trees are suitable for handling more complex, hierarchical population structures as demonstrated in our analysis of the HGDP data. Compared with existing methods for population stratification correction, our method has two distinct advantages. First, the phylogenetic approach allows better interpretation and visualization of the population structure in the study sample, especially when the data contain a hierarchical structure. Many tools have been developed for molecular phylogenetic studies since the fifties, and it will be an important research direction to find how these methods can be applied for the population stratification problem. Second, as shown in our simulations and the analysis of the lactase-height data, our method requires fewer markers to infer population structure than other existing methods; therefore our method is ideal for candidate gene studies or replication study of GWAS, in which a large number of random SNPs may not be available. Although we considered a small number of random SNPs in our simulations, our method can be applied to GWAS as demonstrated by the analysis of the HGDP dataset. Our method has to make a decision on how a set of bipartitions is selected without losing too much information for subsequent association analysis. If the population has a small number of subpopulations, most bipartitions will be similar to one of the bipartitions selected by our bipartition reduction algorithm. Having too many bipartitions retained in the stratification correction procedure will introduce many partially correlated covariates in logistic regression, and can have an adverse effect on the numerical regression procedure; on the contrary, over-reduction of bipartitions may lead to loss of important information on the population structure. Both scenarios can hurt the performance of our algorithm. In our analysis, we tried various thresholds for bipartition selection. We found that using 2.5% as the threshold for the number of leaves and 0.7 as the threshold for the correlation coefficient generally leads to stable results for discrete population structures, and the corresponding thresholds are 2.5% and 0.1 for admixed population structures. In general, we recommend the users to try multiple sets of thresholds and select the threshold that gives the smallest genomic control inflation factor. We recognize that there are other methods such as bootstrapping that can reduce bipartitions in the phylogeny (); however, we expect these methods are very sensitive to any leaves (individuals) in the tree that cannot be properly placed, which we expect to happen very often in human genetic data. What methods best reduce correlated bipartitions and how the bipartition reduction step affects the stratification correction is an important future research direction. For PHYLOSTRAT, the running time is dominated by the pairwise distance computation as FastME is a very fast algorithm with sub-quadratic asymptotic running time in practice. Because pairwise distance computation is more time-consuming than PCAbased approaches, the running time of PHYLOSTRAT is longer than EIGENSTRAT and STRATSCORE. For example, for a dataset consisting of 500 cases and 500 controls with 500 random SNPs and 1000 testing SNPs, using an Intel Xeon CPU (2.66 GHz, 8 GB RAM, linux), it took 9 s for EIGENTRAT, 14 s for STRATSCORE, 19 s for PHYLOSTRAT and 40 s for MDS clustering. However, given that high-performance and low-cost computational capabilities are easily accessible, the required computing time for pairwise distance matrix calculation in PHYLOSTRAT would be a small overhead. One possible approach to reduce the running time is to limit the number of markers by LD pruning. Our experience with the analysis of the HGDP data and several other GWAS datasets suggests that this approach generally works well in GWAS. In summary, we have proposed a new method that combines information from phylogenetic tree and MDS together. Given the flexible nature and the hierarchical characteristic, this hybrid approach is expected to perform well under complex population structures. We expect our method will provide a useful tool in the analysis of both candidate gene and GWAS studies.
The Author 2010. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oxfordjournals.org at :: on August 31, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
at :: on August 31, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
hi = n j=1 (c hj c ij ) 2. MDS analysis attempts to find the optional q dimensional (q < n) approximation to the n dimensional representation so that the distance is preserved. 2.4 Association test with adjustment of phylogenetic bipartitions and principal coordinates from MDS analysis The phylogenetic bipartitions can effectively capture the population structure information in a dataset when the structure is discrete or hierarchical. On the other hand, some of the populations, such as admixed populations, may contain continuous patterns of genetic variation. To incorporate both types of population structures, similar to MDS clustering, a hybrid approach proposed by Li and Yu (2008), we adjust for the population structure by the phylogenetic bipartitions and the principal coordinates from MDS analysis. This is done by representing the population structure as a collection of selected bipartitions and principal coordinates from the MDS analysis and introducing them together with the genotypes of the SNP as independent variables, and the binary phenotype as the dependent variable in a regression framework. To test for genetic association for casecontrol studies, we conduct logistic regression with the following model: logit[P(Y = 1|g,X)]=+g+ T + T , where Y represents disease status (1: affected; 0: unaffected), represents the selected phylogenetic bipartitions, represents the selected principal coordinates from the MDS analysis, X represents a set of random markers that are used for inference of population structure and g is the genotype score for the testing SNP, with (0, 1, 2) for a multiplicative model, (0, 1, 1) for a dominant model and (0, 0, 1) for a recessive model. To test for association between the SNP and the disease status, either a likelihood ratio test, a score test, or a Wald test can be carried out. For continuous phenotypes, we can conduct linear regression with similar adjustments. We note that principal components analysis (PCA) can be used instead of MDS and the computation for PCA is faster than similarity matrix. We choose to use MDS because the similarity matrix is already calculated when constructing the phylogenetic tree; moreover, the results of MDS and PCA are generally similar. Note that the selected phylogenetic bipartitions and principal coordinates might be correlated because both of them represent population structure in the data, although with emphasis on different types of variation. To avoid the issue of multi-collinearity, when the correlation between a phylogenetic bipartition and a principal coordinate is greater than 0.7, we will keep only the principal coordinate in the regression model. It is worth noting that multicollinearity is also a concern for the MDS clustering approach. Similar to what we did for PHYLOSTRAT, when testing the MDS clustering method by Li and Yu (2008), we also used 0.7 as the correlation cut-off point to remove a correlated cluster dummy variable. 2.5 Simulation set up We conducted extensive simulations under various settings to compare the performance of PHYLOSTRAT with four other methods, including the standard CochranArmitage trend test without corrections (Armitage, 1955), the EIGENSTRAT approach (Price et al., 2006), the MDS clustering approach (Li and Yu, 2008) and the STRATSCORE approach (Epstein et al., 2007). We designed three sets of simulations, one for discrete population structures, one for admixed populations and the other based on genotype data from the HGDP samples (Li et al., 2008). In all scenarios, we coded the genotype score for the testing SNP assuming a multiplicative model. In the four methods we tested, either top 10 principal components (EIGENSTRAT
