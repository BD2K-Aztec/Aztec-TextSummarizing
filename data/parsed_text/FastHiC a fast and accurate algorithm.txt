Motivation: How chromatin folds in three-dimensional (3D) space is closely related to transcription regulation. As powerful tools to study such 3D chromatin conformation, the recently developed Hi-C technologies enable a genome-wide measurement of pair-wise chromatin interaction. However, methods for the detection of biologically meaningful chromatin interactions, i.e. peak calling, from Hi-C data, are still under development. In our previous work, we have developed a novel hidden Markov random field (HMRF) based Bayesian method, which through explicitly mod-eling the non-negligible spatial dependency among adjacent pairs of loci manifesting in high resolution Hi-C data, achieves substantially improved robustness and enhanced statistical power in peak calling. Superior to peak callers that ignore spatial dependency both methodologically and in performance, our previous Bayesian framework suffers from heavy computational costs due to intensive computation incurred by modeling the correlated peak status of neighboring loci pairs and the inference of hidden dependency structure. Results: In this work, we have developed FastHiC, a novel approach based on simulated field approximation , which approximates the joint distribution of the hidden peak status by a set of independent random variables, leading to more tractable computation. Performance comparisons in real data analysis showed that FastHiC not only speeds up our original Bayesian method by more than five times, bus also achieves higher peak calling accuracy.
IntroductionThe spatial organizations of chromosomes play a critical role in transcription regulation. In particular, regulatory elements such as enhancers, often contact with the promoters of targeted genes by forming long-range DNA looping. Understanding such 3D chromatin conformation provides novel insights into the regulation mechanisms of gene expression (). The recently developed Hi-C technologies enable a genome-wide measurement of chromatin interaction (). In the Hi-C data, the contact frequency between any two chromatin loci is measured by the number of paired-end reads spanning across them. Higher read count indicates more frequent chromatin interaction and closer spatial proximity. The rapid accumulation of Hi-C data with high sequencing depth enables the study of chromatin interaction at the unprecedented resolution (). However, the detection of biologically meaningful long-range chromatin interactions poses great challenges. Most existing methods () assume that the chromatin interaction frequencies for different loci pairs are independent, which is clearly invalid. If two loci show high interaction frequency, their adjacent loci will be more likely to interact with each other. To fill in this gap, we have recently developed a novel hidden Markov random field based Bayesian (HMRFBayes) method to explicitly model the spatial dependency among adjacent loci (). By borrowing information across neighborhood loci, HMRF achieves substantially improved robustness and enhanced statistical power. While extremely promising, HMRFBayes is based on a Bayesian framework which requires intensive computation. The key challenge is to efficiently and effectively infer the dependency structure underlying the hidden peak status. To address this challenge, we developed a novel algorithm named FastHiC, which approximates the joint distribution of the hidden peak status by a set of independent random variables. Under such approximation, we adopted an EM algorithm for statistical inference. Compared with HMRFBayes, FastHiC not only speeds up by more than five times, but also achieves higher peak calling accuracy.
Statistical modelWe use the same HMRF model as in our previous work (). Our goal is to detect biologically meaningful chromatin interactions among N loci. Let x ij and e ij represent the observed and expected chromatin contact frequency between loci i and j, respectively 1 i < j N. Here, e ij is known based on the prespecified background model (). Let z ij be the hidden peak status: z ij  1 indicates a biologically meaningful interaction, while z ij  1 indicates a random collision. We further assume that x ij follows a negative binomial distribution with mean e ij expfhz ij  1=2g and over-dispersion /. Here, expfhg is the signal-noise-ratio of the peak over the background. In the HMRF model, we assume that x ij 's are conditionally independent given the hidden peak status z ij , where z ij follows an Ising distribution ():Here, w is the parameter accounting for spatial dependency. Larger w indicates higher spatial dependency. Ww is the normalization constant without explicit expression form. The key challenge is the efficient and effective inference of the spatial dependency parameter w. In our previous work (), we used the pseudo-likelihood (PL) to approximate the Ising distribution, and devised a Gibbs sampler for statistical inference.However, in the PL approximation, the neighborhood of each loci pair can still fluctuate, resulting in intractable computation of w. To solve this problem, we developed a novel algorithm named FastHiC, which uses the simulated field m ij  Ez ij jz i 0 j 0 ; i  i 0  j  j 0  1 to approximate the joint distribution of the peak status implicated by the Ising distribution (), leading to a modified pseudo-likelihood (MPL):This MPL approximates the Ising distribution by a set of independent random variables, enabling tractable computation of w. FastHiC then adopts an EM algorithm for inference. Details of the simulated field approximation and EM algorithm can be found in Supplementary Material Section S1.
ResultsWe first conducted simulation study to compare the performance of FastHiC with HMRFBayes (Supplementary Material Section S2). These two methods achieved comparable statistical efficiency in parameter estimations (Supplementary) and peak calling accuracy (Supplementaryand). Noticeably, FastHiC ran more than five times faster than HMRFBayes (Supplementary), due to the novel implementation of simulated field approximation. Next, we re-analyzed the Hi-C data in human IMR90 cells () where 2262 topological associated domains (TADs) were identified (). We analyzed each TAD separately to detect intra-TAD chromatin interactions at 4Kb resolution. We didnot analyze inter-TAD chromatin interactions because low sequencing depth for inter-TAD reads (the average number of intraTAD and inter-TAD reads are 58.91 and 1.57, respectively). Since we have shown that HMRFBayes () outperforms AFC () and Fit-Hi-C (), in this work, we only compared the performance of FastHiC and HMRFBayes (Supplementary). We did not compare with HiCCUPS () since its software is not publicly available. Overall, FastHiC and HMRFBayes obtained highly similar peak calling results. The Spearman correlation coefficient of peak probabilities between FastHiC and HMRFBayes within each TAD has median 0.934 and standard deviation 0.121. In addition, we compared the peak calling results from FastHiC and HMRFBayes with the chromatin loops identified from the in situ Hi-C data ().shows that peaks identified by FastHiC have slightly higher overlap with chromatin loops than peaks identified by HMRFBayes. Overall, FastHiC and HMRFBayes achieved highly similar peak calling accuracy in real Hi-C data in human IMR90 cells. Next, we compared the computational time of four different peak callers with different TAD sizes (). In general, the running time increases quadratically with the TAD size. For all 2262 TADs, the average running time for FastHiC, HMRFBayes, AFC and Fit-Hi-C are 428, 4134, 2605 and 19 s, respectively. FastHiC runs much faster than HMRFBayes and AFC. Although Fit-Hi-C runs faster than FastHiC, we have showed that the HMRF-based approach outperformed Fit-Hi-C in peak calling accuracy (). Compared with Fit-Hi-C, we believe that FastHiC achieves a reasonable balance between speed and accuracy. To further compare the performance of FastHiC and HMRFBayes, we analyzed two additional Hi-C datasets in human H1 embryonic stem cells () and human GM12878 lymphoblastic cells (). We detected intra-TAD chromatin interactions at 40 kb resolution. To evaluate peak calling accuracy, we compared the peak calling results from FastHiC and HMRFBayes with the recently published ChIA-PET data on H1 () and GM12878 cells (). We found that peaks identified from FastHiC show much higher overlap with chromatin loops detected from ChIA-PET data than those identified from HMRFBayes, in both H1 (and Supplementary) and GM12878 cells (). These results demonstrate that FastHiC achieves higher peak calling accuracy than HMRFBayes. In addition, we explored modeling the dependency structure with broader neighborhood, but neither simulation studies nor real data analysis showed performance improvement (Supplementary Material Section S4).
ConclusionIn summary, we have developed FastHiC, a fast and accurate algorithm to detect long-range chromatin interactions from Hi-C data. FastHiC utilized the same hidden Markov random field model as in our previous work (), but with a novel implementation of the simulated field approximation, leading to more than five times speed-up and higher peak calling accuracy. We believe that FastHiC has potential to become a useful tool in studying chromatin spatial organization.
FundingThis research was supported by the National Institute of Health grants R01HG006292 and R01-HG006703 (awarded to YL), and 1U54DK107977-01 (awarded to MH).
Bioinformatics, 2016, 14 doi: 10.1093/bioinformatics/btw240 Advance Access Publication Date: 3 May 2016 Applications Note Bioinformatics Advance Access published June 1, 2016 at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from Conflict of Interest: none declared.
