Ribosome profiling is a recently developed high-throughput sequencing technique that captures approximately 30 bp long ribosome-protected mRNA fragments during translation. Because of alternative splicing and repetitive sequences, a ribosome-protected read may map to many places in the transcriptome, leading to discarded or arbitrary mappings when standard approaches are used. We present a technique and software that addresses this problem by assigning reads to potential origins proportional to estimated transcript abundance. This yields a more accurate estimate of ribosome profiles compared with a na€ ıve mapping. Availability and implementation: Ribomap is available as open source at
IntroductionRibosome profiling (ribo-seq) provides snapshots of the positions of translating ribosomes by sequencing ribosome-protected fragments (). The distribution of ribo-seq footprints along a transcript, called the ribosome profile, can be used to analyze translational regulation and discover alternative initiation (), alternative translation and frameshifting (), and may eventually lead to a better understanding of the regulation of cell growth, the progression of aging () and the development of diseases (). Different environmental conditions such as stress or starvation alter the ribosome profile patterns (), indicating possible changes in translational regulation. In higher eukaryotes, alternative transcription initiation, premRNA splicing, and 3 0 end formation result in the production of multiple isoforms for most genes. The resulting isoforms can have dramatically different effects on mRNA stability () and translation regulation (). However, to date ribosome profiling analyses have been conducted at the gene, rather than isoform, level using either a single rate of Ribomap is 50% compared to 7% if only uniquely mapped reads are used. Estimation of mRNA isoform abundance from RNA-seq has also had to deal with ambiguous mappings (). However, unlike in RNAseq, coverage in ribo-seq is highly non-uniform regardless of sequencing bias since ribosomes move along mRNAs at non-uniform rates, and it is in fact the non-uniformities that are of interest (). Further, ambiguous mappings are much worse for ribo-seq data since the read length cannot exceed the ribosome size (approximately 30 bp), while paired-end and longer reads can be generated from RNA-seq experiments to reduce the problem of ambiguous mappings. Methods developed for transcript abundance are therefore not applicable to assigning ribo-seq reads. By observing that ambiguous mappings are mainly caused by multiple isoforms (Supplementary), Ribomap assigns riboseq reads to locations using estimated transcript abundance of the candidate locations. On synthetic data, our approach yields a more precise estimation of ribosome profiles compared with a pure mapping-based approach. Further, the ribosome abundance derived using our method correlates better with the transcript abundance on real ribo-seq data.
ApproachRibomap works in 3 stages (; see also Supplementary Material): I. Transcript abundance estimation. Since RNA-seq experiments should always be performed in parallel with ribo-seq (), the abundance a t per base of each transcript t can be estimated from the RNA-seq data using Sailfish (), an ultra-fast mRNA isoform quantification package. Ribomap also accepts transcript abundance estimations from cufflinks () and eXpress (). II. Mapping ribo-seq reads to the reference transcriptome. We obtain all the transcript-location pairs L r where the read sequence r matches the transcript sequence by aligning the entire set of ribo-seq reads R to the transcriptome with STAR (). III. Ribosome profile estimation. Let c r be the number of ribo-seq reads with sequence r. Ribomap sets the number of footprints c rti with sequence r that originate from a specific location i on transcript t to be proportional to the transcript abundance a t of transcript t: c rti  c r a t = P t 0 ;i 0 2Lr a t 0 , where the denominator is the total transcript abundance with a sequence matching r. The total number of reads c ti that are assigned to transcript t, location i, is then c ti  P r2R c rti. The c ti give the profiles for each transcript. The sum is needed here because there can exist multiple read sequences being mapped to the same transcript location due to sequencing errors, so the final estimated ribosome count for a transcript location should be the sum of the estimated count for all matched read sequences.
Results and discussionTo evaluate the performance of Ribomap, we synthetically generated ribo-seq reads with known ground truth profiles using transcript abundance of GSM546921 RNA-seq data () and a dynamic range of initiation rates. Ribosome occupancy probabilities for locations on a given transcript were simulated using the ribosome flow model (). Errors were added to the reads using a Poisson process with a rate of 0.5%, which was estimated from the ribo-seq data GSM546920 (). For comparison, we also test a na ve approach, called 'Star prime', that maps each read to a single candidate location. More details are in Supplementary material. The Pearson correlation coefficients between Ribomap's ribosome profiles and the ground truth is significantly higher than that of Star prime (): 81% of our profiles have a higher Pearson correlation (MannWhitney U test p < 3  10 308 ) and 68% have a smaller root mean square error (MannWhitney U test p  3:3  10 221 ). This suggests that Ribomap more accurately recovers the ribosome profiles than the standard mapping procedure applied to isoforms. The good correlation between the ground truth profile and the estimated profile also leads to a good estimation of the total ribosome loads on a transcript. Ribomap's ribosome loads estimation on non-synthetic ribo-seq data (GSM546920,) correlates well with the estimated transcript abundance (Pearson r  0.71). We do not expect a perfect correlation due to isoformspecific translational regulation. On the other hand, the pure mapping-based approach of Star prime does not correlate as well (r  0.28). Through two lines of evidence, on real and synthetic ribo-seq data, we show that Ribomap produces useful, high-quality ribosome profiles along individual isoforms. It can serve as a useful first step for downstream analysis of translational regulation from ribo-seq data.
'representative' isoform (e.g. Guo et al., 2010) or exon union profiles (e.g. Olshen et al., 2013). The lack of isoform-level analysis of ribo-seq data is partially due to the absence of the necessary bioinformatic tools. Here, we present a conceptual framework and software (Ribomap) to quantify isoform-level ribosome profiles. By accounting for multi-mapping sequence reads using RNA-seq estimates of isoform abundance, Ribomap produces accurate isoformspecific ribosome profiles. The challenge in estimating isoform ribosome profiles is that a short ribo-seq read may map to many different transcripts. Ambiguous mappings are not rare in ribo-seq data and can be caused by either repetitive sequences along the genome or alternative splicing (Ingolia, 2014). For example, in the human Hela cell riboseq data (GSM546920, Guo et al., 2010), among all mapped reads (about 50% of all reads), only 14% can be uniquely mapped to a single location of a single mRNA isoform, 22% can be mapped to multiple regions on the reference genome due to repetitive sequences, and 64% can be mapped to multiple mRNAs due to alternative splicing. Ribomap deals with both types of ambiguous mappings, and therefore does not discard multi-mapped reads, resulting in more of the data being used. In this example, the mapping V C The Author 2016. Published by Oxford University Press. 1880 This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (http://creativecommons.org/licenses/by-nc/4.0/), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com Bioinformatics, 32(12), 2016, 18801882 doi: 10.1093/bioinformatics/btw085 Advance Access Publication Date: 15 February 2016 Applications Note at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
