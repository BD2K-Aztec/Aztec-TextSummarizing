Motivation: In recent years, development of a single-method fold-recognition server lags behind consensus and multiple template techniques. However, a good consensus prediction relies on the accuracy of individual methods. This article reports our efforts to further improve a single-method fold recognition technique called SPARKS by changing the alignment scoring function and incorporating the SPINE-X techniques that make improved prediction of secondary structure, backbone torsion angle and solvent accessible surface area. Results: The new method called SPARKS-X was tested with the SALIGN benchmark for alignment accuracy, Lindahl and SCOP benchmarks for fold recognition, and CASP 9 blind test for structure prediction. The method is compared to several state-of-the-art techniques such as HHPRED and BoostThreader. Results show that SPARKS-X is one of the best single-method fold recognition techniques. We further note that incorporating multiple templates and refinement in model building will likely further improve SPARKS-X. Availability: The method is available as a SPARKS-X server at
INTRODUCTIONGiven a query protein sequence with unknown structure, the most reliable structure prediction technique is to recognize its matching structural folds from existing known structures with or without significant sequence similarity (called homology modeling and fold recognition, respectively). This approach is also known as templatebased modeling. Template-based modeling becomes increasingly powerful because most popular structure folds (adopted by multiple sequences) are known (). However, recognizing structurally similar folds in the absence of sequence similarity (fold recognition) is challenging, as revealed from the critical assessment of structure prediction (CASP) * To whom correspondence should be addressed. techniques. CASP experiments highlighted the importance of posttreatment of models predicted by individual fold recognition methods through the use of consensus predictions [For example, ROBETTA (), Pmodeller6 (), Fams-ace (), Phyre (and/or constrained templatefragment recombination and refinement [For example, Chunk-TASSER (), I-TASSER (. The experiments also indicated a convergence of techniques that can be broadly characterized as mixing and matching of multiple fragments and templates (). Examples of recently developed new methods include the combined use of fragment and template comparison (), non-linear scoring function from conditional random field model () and profile entropy (), employment of predicted torsion angles () and a combined use of profileprofile alignment and pairwise and solvation potentials (). We have developed a series of single fold recognition methods (SPARKS, SP 2 , SP 3 , SP 4 and SP 5 ) that are based on weighted matching of multiple profiles that include sequence profiles generated from multiple sequence alignment (), predicted versus actual secondary structures (), knowledge-based profile (singlebody) score function (), depth-dependent sequence profiles derived from template structures (), predicted versus actual solvent accessible surface area () and predicted versus actual dihedral angles (). Statistically significant improvement is observed for the accuracy and sensitivity of fold recognition as the number of matching profiles increases from 3 to 5 (). In particular, SPARKS, SP 3 and SP 4 were ranked among the top performers for automatic servers in CASP 6 () and CASP 7 () experiments. One issue in the methods developed above is that matching predicted 1D profiles of query sequence with actual profiles of templates is based on simple difference matrices. It does not account for the probability of errors in predicted 1D structural properties such as secondary structure, backbone torsion angles and solvent accessible surface area. In this article, we introduce energy terms
SPARKS-X for fold recognitionbased on the estimated probability of a match between predicted and actual 1D structural properties, a technique commonly used in fold recognition based on hidden Markov models (). In addition, we take advantage of recently improved accuracy in predicted secondary structure [Q 3 = 8182% by SPINE X (E.for publication)], torsion angles [SPINE X (), mean absolute error = 33 @BULLET for  and 22 @BULLET for ] and solvent accessibility (ASA) [correlation coefficient of 0.74 between predicted and actual values, Real-SPINE 3.0 (. The above proposed algorithm leads to the new method called SPARKS-X in order to distinguish from previous SP series methods. We tested SPARKS-X alignment accuracy, fold recognition and structure prediction by using several benchmarks, compared it to several state-of-the-art techniques and participated in the automatic server part of CASP (CASP 9). All results indicate that SPARKSX is one of the best single-method fold recognition servers. The performance of the method can likely be further improved significantly by incorporating the techniques of multiple templates and refinement in model building that are employed in many other automatic servers.
METHODS
Alignment scoreThe alignment score of SP 5 for aligning query position i with the template position j is ((i) are the sequence-derived log odd profile of the template sequence and that of query sequence, respectively. These sequence profiles are constructed by three iterations of PSIBLAST () searching (E value cutoff of 0.001) against non-redundant (NR) sequence database, which was filtered to remove low-complexity regions, transmembrane regions and coiled-coil segments (). The second term in Equation (1) compares the sequence profile from the query sequence and that derived from the template structure (sequence profiles that would 'fit' to the structure). F struc template (j) is a depth-dependent sequence profile generated from the sequences of those structural fragments that are similar to 9-residue segment structures of the template (). The third term in Equation (1) measures the difference k ij between the predicted 1D structural properties of the query sequence and the actual properties of the template (three-state secondary structure, real-value solvent accessibility and real value torsion angles). By comparison, the alignment score developed in this article for SPARKSX is as follows:(i))+s shift .There are two major changes from Equation (1) in SP 5 to Equation (2) in SPARKS-X: the removal of sequence profile derived from template structure (designed sequences for templates) and replacement of simple difference k ij by energy terms dependent on the predicted confidence E(SS t (i)|SS q (j),C SS,q (j)) and E( k ij|C k,q (j)). Here, torsion angles  and  are treated separately so that the maximum value of k is 4. We dropped the structure-derived sequence profile (the main novel feature in SP 3 ) because we found that including this term no longer improves our results in our new formulation. The first energy term for secondary structure (k = 1) is calculated based on:where P(SS t |SS q ,C SS,q ) is the probability of predicted secondary structure SS q by SPINE-X with confidence score C SS,q () for a native secondary structure SS t , and the reference probability P(SS t ) is the probability of secondary structure SS t in native proteins. For obtaining the probabilities, secondary structures were predicted by SPINE-X (E.Faraggi, submitted for publication) with three states for templates defined according to DSSP (). C SS,q is evenly divided into eight discrete states. The second energy term is based onwhere P( k |C k,q ) is the probability of the predicted property having difference of k to corresponding native values with confidence score C k,q ; and the reference probability P 0 ( k |C k,q ) is obtained by comparing the predicted one to all native values in the dataset. There are a total of three terms with k = 2 for real valued , k = 3 for real valued , and k = 4 for the real value solvent accessibility. Real value torsion angles ( and ) are predicted by SPINE-X (). The difference for  and  are evenly divided into 18 bins, C k,q are evenly discretized into eight states. Real value solvent accessibility is predicted by Real-SPINE 3 (). The difference values are divided into 20 states, and C 4,q is employing 20 amino acids to represent the prediction confidence. All energy terms were obtained from a NR dataset of 2479 proteins with length <500 amino acids from the original SPINE database [25% sequence identity cutoff, X-ray resolution lower than 3  and no unknown structural regions ()].
Parameter training and template rankingAs in SP 5 , the SmithWaterman alignment algorithm () is used to optimize the score that matches the query profiles with template profiles. To reduce the number of parameters, we set w 2 = w 3 (equal weights for two torsion angles). All weight parameters and two gap penalty parameters (gap opening g o and gap extension g e ) were trained on the Prosup structural alignment benchmark (). The parameters were trained using the Powell method by many repeats from different random seeds (). The final parameters used are10.2, g e = 0.69 and s shift =1.52. The templates are ranked by the greater one of two Z-scores, which is calculated based on the raw alignment score normalized by L  or l  with L, the full alignment length, l, the non-end gap alignment length and , a free parameter. The fractional exponent is introduced to mimic the fractional exponent employed in calculating domaindomain interactions (). We find that  = 3/4 yields a slightly improved (0.4% in TMscore of built model for the SCOP_20 dataset, see below) ranking. This ranking method is the same as used in SP 3 , SP 4 or SP 5 except that  = 1 was used previously.
CASP 9 template library and model buildingAn automatically updated template library is used for the threading. When a new protein is input to the library, it is first divided into domains according to the 'Author' parameters in DDOMAIN (). The divideddomains are compared to existing domains in the library. If the sequence identity is <40%, or the TM score [by TM align ()] between them is smaller than 0.5, the new domains and its chain will be included in the library. The automatically updated library had 31 750 templates on July 15, 2010 at the completion of server predictions in CASP 9. The model is built by modeller9v7 () using the alignment generated by SPARKS-X. When there are gaps of >30 residues in the termini, the program will be recalled to build a model for the missing parts in the region. After that, these different models are linked and steric clashes are removed by using the DFIRE potential functions ().
Y.Yang et al.
RESULTS
Alignment accuracyAs in SP 3 and SP 4 , SPARKS-X was optimized by using the Prosup benchmark () and tested in SALIGN (). The Prosup benchmark, prepared by Sippl's group, consists of 127 pairs of proteins with alignment by the structural alignment program Prosup (). The SALIGN benchmark () contains 200 selected pairs with an average pair sharing 20% sequence identity or less and 65% (or more) of structurally equivalent C  atoms superposed with an rmsd of 3.5  (). Reference alignment is obtained from the structural alignment obtained from the TMalign program (shows the alignment accuracy of different methods given by different benchmarks. There is a consistent gradual improvement (12%) from SP 3 , SP 4 to SP 5 but a much larger improvement from SP 5 to SPARKS-X (46%). This accuracy is comparable with the recently developed BoostThreader () or the new version of Raptor (). It is of interest to know the contribution to the overall accuracy of SPARKS-X made by individual terms in Equation (2).compares the accuracy made by individual scoring terms by either adding to sequence profile [Position Specific Scoring Matrix (PSSM)] or removing from SPARKS-X. The results are obtained by training with the Prosup benchmark and testing with the SALIGN benchmark. It is clear that all three terms (secondary structure, torsion angles and ASA) contributed to the accuracy of alignment. Adding them to the PSSM increases the alignment accuracy while removing them from SPARKS-X decreases the accuracy. The contribution from ASA is the largest (5% adding to PSSM in SALIGN or 4% removing from SPARKS-X in SALIGN). Smallerpercentage in each cell is the fraction of correctly recognized match of proteins in the same fold, super family, family as the first ranked or within top 5 ranked templates. c From Ref. (). d From Ref. (). e From Ref. (). f From Ref. (). g From Ref. (). but significant contributions are observed for secondary structure or torsion angles (34% for adding to PSSM and 0.41% for removing from SPARKS-X). The results from training and testing are consistent with each other.
Testing fold recognition with Lindahl benchmarkThe purpose of improving alignment is to increase the ability of recognizing the correct structural fold of a query sequence from a template library. We employed the Lindahl Benchmark for comparing SPARKS-X with different methods. The benchmark is a large data set of 976 proteins, with 555,434, and 321 pairs of proteins in the same family, superfamily and fold, respectively (). Here, the fold recognition sensitivity of each method is tested by aligning each protein with the rest 966 proteins, and checking whether or not the method can recognize the member of same family, superfamily or fold as the first ranked or within top five ranked templates. Thus, the benchmark tests both the modeling accuracy and the ranking methods for fold recognition.shows the fraction of correctly recognized matches for proteins in the same family, superfamily, fold as the first ranked or within top five ranked templates given by various methods. Although many published methods have been applied to this benchmark (), we only list the most recent ones (). This is because of the time-dependent nature of sequence databases for sequence profiles.indicates that the improvement over SP 3 , SP 4 , SP 5 in success rate of fold recognition by SPARKS-X exists in all three levels (family, superfamily and fold) except the Top 1 ranked model in superfamily where the success rate is similar between SP 5 (59.8%) and SPARKS-X (59.0%). The largest improvement over SP 5 is observed in fold level (7% absolute increase in Top 1 and 8% absolute increase for the best in Top 5). This is somewhat expected because the method was trained for remote homolog recognition (structurally similar protein with <30% sequence identity in the Prosup benchmark). Comparing to BoostThreader, SPARKS-X is less successful in homology detection (family and superfamily in Top 1) but more successful in fold recognition (2% improvement in Top 1 and 10% improvement in Top 5) as trained. The above success rates of matching sequences within the same SCOP classification are based on somewhat subjective SCOP definition of family, superfamily and fold (). A more direct measurement of accuracy is to calculate the accuracy of the first-ranked model built from the fold recognition alignment. First, the model is built by transferring the C  coordinates of the template structures to the aligned residues in the query sequence. Then, the constructed model is assessed by using the MaxSub score between the model and the known native structure. MaxSub score () between two structures is a measure of similarity between them with 0.0 indicating no similarity and 1.0 a perfect match. The value is calculated by searching for the largest subset of well-superimposed residues (3.5 ).reports the MaxSub scores for the models built by SP 3 , SP 4 , SP 5 and SPARKS-X methods averaged over the number of proteins. Again SPARKSX improves over SP 5 , SP 4 and SP 3 in all levels. The relative improvement of SPARKS-X over SP 5 in MaxSub score is 12, 22 and 13% in family, superfamily and fold levels, respectively.
Page: 2079 20762082
SPARKS-X for fold recognition
Testing fold recognition with SCOP-20 datasetWe built a SCOP-20 dataset by using domains of sequence identity <20% and chain lengths >60 from SCOP 1.75. Afterremoving domains with C  atoms only, we obtained 6367 domains. We also compared our results with HHPRED () (version 1.5.1) and PRC () (version 1.5.6) because these two programs could be downloaded and installed on our local machine. The profiles of the domains for HHPRED are directly downloaded from HHPRED's web page (http://toolkit.tuebingen.mpg.de/hhpred). The profiles for PRC are using profiles generated from three iterations of PSIBLAST. For both these two predictors, default parameters were used. We would like to emphasize that we have only assessed PRC with the sequence profiles generated from PSIBLAST. Its performance may be different if other profiles are employed. First, we tested the ability of HHPRED and SPARKS-X to recognize a match in the same family, same superfamily (after removing family members from the templates) and same fold (after further removing superfamily members) according to the SCOP definition within top-N templates. Note that on a given search we removed the query protein from the template library.shows the success rates of recognizing at least one template within same family, superfamily or fold as a function of the number (N) of top predicted matching templates. At the family and superfamily level, HHPRED has a higher success rate than SPARKS-X based on top 112 templates but a lower success rate afterwards. At the fold level, SPARKS-X has a consistent higher success rate than HHPRED and the difference becomes greater as more top templates are included. Similar results are observed in the ROC curve when the true positive rate is plotted as a function of the false positive rate () for all pairs of the SCOP-20 dataset. Here, true positives denote the detection of the templates within the same classification (family, superfamily or fold). The performance of SPARKS-X is consistently better than that of HHPRED at the fold level while HHPRED has a higher true positive rate only at low false positive rate at the family and superfamily levels.To avoid somewhat subjective definition of family, superfamily and fold, another way to compare the ability of recognizing structural similarity is to directly calculate the structural similarity between the target structure and the structure recognized without actually building the model. Results of average TM score between query and Top 1 template are shown inwhere structural similarity is measured by TM align (). The table shows that the average TM score given by SPARKS-X is about 3% higher than that given by HHPRED when all templates are employed. The difference between the TM scores given by SPARKS-X and that given by HHPRED is larger if easily recognized templates are removed. SPARKS-X's average TM scores are 5, 14 and 16% higher than that given by HHPRED when templates from same family, superfamily and fold are excluded from the templates library. This result indicates that SPARKS-X has a higher ability than HHPRED or PRC to recognize structurally similar proteins regardless if they are in the same family, superfamily or same fold. The results incan be further illustrated by a ROC curve for all SCOP-20 templates (). The positives are defined by templates having TM score >0.5 to query structures by TM align. However, the positives are defined as those predicted template structures with a TM score >0.5 to the query structure by TM align. Three sets of results from top to bottom are shown: all pairs, excluding the templates within the same family, and excluding those within the same family and superfamily.(i.e. to test the ability to recognize a similar structure). The figure shows that the performance of SPARKS-X is consistently better than that of HHPRED at detecting structurally similar templates from all templates, without the same family members, and without the same family and superfamily members. The difference between the two methods is small at very low false positive rates (see the insert of) but increases significantly at low false positive rates. The difference betweenandis because family and superfamily members in SCOP are defined according to sequence evolution origins, rather than structural similarity. Our results suggest that using structural similarity is more direct and accurate assessment of the performance of structure prediction techniques. The results reported inandare based on direct structural comparison between target and template structures. A more common comparison is to measure the accuracy of the model built based on sequence template alignment. We found that this will further improve the performance of SPARKS-X relative to that of HHPRED/PRC because SPARKS-X uses local-global alignment while HHPRED and PRC are based on local alignment. As a result, SPARKS-X typically gives a longer alignment than HHPRED and PRC. This leads to improved scores for models built. For example, the average TM score of Top 1 model from all templates for HHPRED and SPARKS-X are 0.476 and 0.517, respectively. This is 9%, rather than 3% improvement based on structural alignment of target and template structures (). We also tested HHPRED with the option of '-mact 0.05' because this option leads to almost global alignment and better scoring models. Although it does not change the ability of recognizing structurally similar proteins (), this option indeed increases the average TM score of Top 1 model from 0.476 to 0.502, which is 3% rather than 9% behind SPARKS-X.
The Author 2011. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oup.com at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
