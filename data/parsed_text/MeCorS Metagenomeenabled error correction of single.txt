We present a new tool, MeCorS, to correct chimeric reads and sequencing errors in Illumina data generated from single amplified genomes (SAGs). It uses sequence information derived from accompanying metagenome sequencing to accurately correct errors in SAG reads, even from ultra-low coverage regions. In evaluations on real data, we show that MeCorS outperforms BayesHammer, the most widely used state-of-the-art approach. MeCorS performs particularly well in correcting chimeric reads, which greatly improves both accuracy and contiguity of de novo SAG assemblies. Availability and implementation: https://github.com/metagenomics/MeCorS
IntroductionThe vast majority of microbial species found in nature has yet to be grown in pure culture, turning metagenomics andmore recently single cell genomics into indispensable methods to access the genetic makeup of microbial dark matter (). Frequently, single amplified genomes (SAGs) and shotgun metagenomes are generated from the same environmental sample, and are methodologically combined e.g. to validate metagenome bins with single cells or to improve the SAG's assembly contiguity (). However, a single cell's DNA needs to be amplified prior to sequencing, as usually accomplished by multiple displacement amplification (MDA;). This amplification is heavily biased, leading to uneven sequencing depth including ultra-low coverage regions with basically no informed error correction possible (; Supplementary). Moreover, chimera formation occurs roughly once per 10 kbp during MDA, further complicating SAG assembly (). While an array of error correction tools exist for a variety of use cases (), only one tool was specifically designed to correct SAG data: hammer (), recently refined to BayesHammer (). We propose a metagenome-enabled error correction strategy for single cell sequencing reads. Our method takes advantage of largely unbiased metagenomic coverage, enabling it to correct positions with too low a coverage for SAG-only error correction, and to correct chimeric SAG reads through non-chimeric metagenome reads.
MethodsWe correct potential errors using an algorithm similar to solving the spectral alignment problem (). Given a set of trusted k-mers, we use a heuristic method to find a sequence with minimal corrections such that each k-mer on the corrected sequence is trusted. Using a k-mer size of 31, we consider a k-mer trusted if it occurs at least twice in the accompanying metagenome. This coverage threshold was determined empirically to work with most datasets (Supplementary). Our correction algorithm was inspired by fermi () and BFC (), but we do not act on the assumption of uniform
2199This is an Open Access article distributed under the terms of the Creative Commons Attribution License (http://creativecommons.org/licenses/by/4.0/), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited.
Bioinformatics
Results and discussionAs a realistic benchmark, we used eight Escherichia coli K12MG1655 SAGs from, a strain for which the complete genome sequence is available (Supplementary). A concomitant in vitro mock metagenome consisting of 26 microbial species, including E. coli K12-MG1655, was sequenced on Illumina's HiSeq platform (). Based on metagenome read mapping, we estimate the relative abundance of E. coli to amount to 0.15%, corresponding to a mean per-base coverage of only 20.7 (Supplementary). We evaluated MeCorS along with BayesHammer (), a widely used error correction tool for SAG data. Our method corrects more errors than BayesHammer, producing a significantly higher fraction of better and perfect reads after correction (; Supplementary). In contrast to BayesHammer, MeCorS reduces the amount of chimeric SAG reads by one order of magnitude, likely due to the non-chimeric nature of the metagenome reads. MeCorS works well with modern single cell assemblers, most notably reducing the misassembly rate of both IDBA-UD () and SPAdes () by half, while providing high sequence contiguity (). In particular poorly amplified SAGs benefit from metagenome-enabled error correction, yielding improved assembly accuracy and contiguity (Supplementary Tables S4 and S5). We note that such a hybrid error correction of SAG data may result in miscorrection(s) of rare variants. If the captured cell contains a variant that is rare or absent in the corresponding metagenome, correction will be biased towards the most abundant variant in the metagenome sequence. If strain resolution is desired, we suggest polishing the SAG assembly using the uncorrected raw data. In all other cases, SAG assemblies benefit directly from metagenome-enabled error correction via MeCorS. Uneven genome coverage and chimera formation present the biggest challenges in the downstream processing and analysis of SAG datasets to date. We propose MeCorS for the correction of SAG reads when complementary metagenome datasets are available. Error and chimera correction is essential for improved SAG assembly and demonstrates a powerful application of combined shotgun metagenome and single cell sequencing.Mean percentage and standard deviation of perfect reads, chimeric reads (i.e. reads with parts mapped to different places), corrected reads becoming better and worse than the raw reads. Evaluation as described in; please refer to Supplementary Table S3 for per-SAG metrics, including runtime and memory usage.
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
A.Bremges et al. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
