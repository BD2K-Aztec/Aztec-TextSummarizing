Motivation: The Illumina BeadArray is a popular platform for profiling DNA methylation, an important epigenetic event associated with gene silencing and chromosomal instability. However, current approaches rely on an arbitrary detection P-value cutoff for excluding probes and samples from subsequent analysis as a quality control step, which results in missing observations and information loss. It is desirable to have an approach that incorporates the whole data, but accounts for the different quality of individual observations. Results: We first investigate and propose a statistical framework for removing the source of biases in Illumina Methylation BeadArray based on several positive control samples. We then introduce a weighted model-based clustering called LumiWCluster for Illumina BeadArray that weights each observation according to the detection P-values systematically and avoids discarding subsets of the data. LumiWCluster allows for discovery of distinct methylation patterns and automatic selection of informative CpG loci. We demonstrate the advantages of LumiWCluster on two publicly available Illumina GoldenGate Methylation datasets (ovarian cancer and hepatocellular carcinoma). Availability: R package LumiWCluster can be downloaded from
INTRODUCTIONDNA methylation is an important epigenetic modification and plays critical roles in transcriptional regulation, chromosomal stability, genomic imprinting and X-inactivation (). Numerous literatures have established the influence of DNA methylation in transcriptional aberrations in human diseases including various types of cancer (). DNA methylation occurs in cytosines of CpG dinucleotides in human in a non-random fashion across the genome. In particular, CpG-rich regions (known as CpG islands) are usually hypomethylated, whereas repetitive genomic sequences are hypermethylated in normal cells. Over the past decade, there has been vast research in studying alterations of * To whom correspondence should be addressed. DNA methylation in cancer. A general observed trend of perturbed DNA methylation includes hypomethylation of oncogenes and hypermethylation of tumor suppressor genes, leading to genomic instability and tumorigenesis (). Several platforms are available for DNA methylation profiling that includes high-throughput arrays and more recently, the nextgeneration sequencing instruments. The experimental approaches in high-throughput array-based methylation include bisulfite conversion-based methods, restriction enzyme-based methods and immunoprecipitation-based methods (). A popular robust methylation profiling platform via bisulfite conversion is the Illumina GoldenGate and Infinium Methylation Assays based on the BeadArray technology. This technology utilizes 3 m silica beads which are replicated 30 times on the array and has emerged as an attractive platform for genotyping, expression and methylation analysis (). This technology requires less sample input but produces high-quality data (), thereby reducing the cost of array experiments. The increasing popularity of Illumina BeadArray technology is apparent given the numerous scientific publications since 2008. However, there is only a handful of statistical framework for analyzing Illumina BeadArray gene expression (), and limited work is available for methylation array counterpart (). Existing work for gene expression BeadArray falls into the categories of data preprocessing and differential expression detection. This includes background correction methods (), variance-stabilizing techniques () and modified test statistics for differential gene expression in Illumina BeadArray (). Most of the framework for gene expression analysis is based on the assumption that the majority of the genes are not differentially expressed. In contrast, many sites are expected to be methylated (), and therefore the assumptions in gene expression are not applicable to methylation experiments. The goal of our article is to provide a statistical framework for arraybased methylation profiling on Illumina BeadArray technology, by studying the source of biases and the data-generating mechanism of Illumina methylation assays. Specifically, we propose a model for correcting the source of biases in Illumina Methylation BeadArray and introduce a weighted model-based approach for clustering the methylation profiles. The framework of our weighted model-based clustering can also be directly applied to other Illumina BeadArray platforms, e.g. gene expression BeadChip, because it does not rely on the assumption that most beads are from the null distribution of no differential expression. In the next section, we describe thePage: 2850 28492855
P.F.Kuan et al.methylation data structure and introduce our proposed statistical framework.
MOTIVATIONMethylation levels in Illumina methylation assays are quantified by the beta value using the ratio of intensities between methylated (M) and unmethylated (U) alleles. Specifically, beta = max(M,0) max(M,0)+max(U,0)+100 where M and U are the red and green dyes, respectively, for the GoldenGate and VeraCode Methylation assays, whereas for Infinium assay, M and U are signals A and B (produced by two different bead types and reported in the same color), respectively. The constant 100 is to regularize beta when both M and U values are small (). The beta values are continuous and range from 0 (unmethylated) to 1 (completely methylated). Each locus reports an average beta value obtained from the average of M's and U's across approximately 30 bead replicates, and individual beadlevel measurements are not readily available (). A standard summary output from BeadStudio (Illumina software to process raw intensities) includes four columns for each sample, i.e. (1) average beta, (2) average M, (3) average U and (4) detection P-values, for each locus. Therefore, our proposed framework will be based on the average beta values for convenience. The detection P-value reported by BeadStudio can be used as a quality control measure of probe performance. The detection P-value is defined as 1P-value computed from the background model characterizing the chance that the signal was distinguishable from negative controls (Supplementary Materials). Standard protocol by Illumina recommends excluding probes that have a detection P-value greater than an arbitrary cutoff of 0.05. On the other hand,excluded samples that consist of 25% observations with detection P-values  110 5 , as well as probes (CpG loci) with median detection P-values >0.05, whereas Hernandezexcluded probes with detection P-values >0.01 in >10% of the samples. In Section 3.2, we will introduce a modeling framework that avoids arbitrary choice of detection P-value threshold. We will now explore and illustrate the source of biases present in Illumina Methylation BeadArray based on the data generated by the Thomas-Conway Lab at UNC-Chapel Hill. The methylation experiment is performed on the GoldenGate Cancer Panel I methylation panel, which interrogates 1505 CpG loci/probes associated with 803 cancer-related genes (tumor suppressor genes, oncogenes, genes involved in DNA repair, cell-cycle control, differentiation, apoptosis, X-linked and imprinted genes) where 28.6% contain one CpG site per gene, 57.3% contain two CpG sites and 14.1% have three or more sites (). The probe length varies between 41 bp and 59 bp with median 50 bp, whereas the number of CG dinucleotides for each probe varies between 1 and 7. A pair of allele-specific oligonucleotide (ASO) and locusspecific oligonucleotide (LSO) measures the methylation level of a specific CG dinucleotide for a probe under the assumption that flanking CG dinucleotides within the same probe exhibit similar methylation status. In other words, the observed methylation level for the measured CG dinucleotide should not be affected by the number of flanking CG dinucleotides. To investigate the potentialsource of biases in Illumina Methylation assays, we utilize six positive control samples from our dataset, in which all the cytosines in CG dinucleotides are expected to be methylated and any deviation from methylated status indicates the presence of technical biases. We apply quantile normalization to these six positive control samples.compare the pairwise correlations among these positive controls before and after normalization, respectively. Both plots show the high correlations among the positive controls, with improvement after normalization. In addition, array-based technology are known to be affected by the sequence and thermodynamic properties, e.g. melting temperature and GC content in proteinDNA binding and gene expression experiments (). In, we plot the quantile normalized average beta values pooled from all positive controls against probe length, number of CG dinucleotides within each probe, melting temperature and GC content. Individual plots for each positive control sample are given in Supplementary Materials. Melting temperature is computed according to, whereas GC content is the percentage of C and G nucleotides for a given probe. As evident from,the observed methylation level is influenced by the sequence and thermodynamics properties of the probes. Sequence length bias in methylation array is also observed in. Since melting temperature is a function of GC content and sequence length, and GC content is highly correlated with the number of CG dinucleotides, our modeling framework will incorporate sequence length and GC content. In gene expression and proteinDNA binding arrays, GC content exhibits increasing trend with intensities due to the three hydrogen bonds compared with two hydrogen bonds in AT pairs. However, the decreasing trend observed in methylation arrays can be attributed to the loss of efficiency in binding for a probe with more CG dinucleotides, because the CG dinucleotides within a probe are expected to have similar methylation status. Although CG dinucleotides yield a more straightforward interpretation, we choose GC content which has more distinct values for better function approximation.
METHODS
Estimating L j and GC j biasesFor notational brevity, we denote the average beta value and detection P-value for each locus j, j = 1,...,p and sample i, i = 1,...,n as  ij and p ij , respectively. Let L j and GC j denote the probe length and GC content for locus j, respectively. Since  ij  (0,1), beta distribution arises as a natural distribution for modeling the observed  ij (). However, maximum likelihood estimation of the unknown parameters (, ) in a beta distribution does not have a closed form and relies on numerical methods (). In this article, we consider an alternative for modeling  ij via a logit transformation,To avoid a logit tranformation of  = 0, we add an = 10 4 to  aswhere  M and  U are the average M and U values across 30 replicates as mentioned in Section 2. We modelwhere s ij is the true methylation level and h 1 , h 2 characterize the bias arising from sequence length and GC content. We estimate h 1 , h 2 from the positive control sample instead of treatment sample itself. This is to safeguard against removing actual methylation signals due to the potential confounding effect with GC content, i.e. hypomethylation in CpG islands (CG-rich regions) of normal cells (). Letunder the constraints (1)  1 = 44 2 ,(4)  3 = 0.8 2 for continuity at the knots. That is, we model h 1 and h 2 as piecewise constant + linear + constant. The knots are chosen so that the number of observations in {L j < 44} and {L j  57} are comparable with the number of observations in {L j = n} for n = 44,...,56 as well as to avoid over (under)estimation for large (small) L j , and vice versa for GC j. In, we plot the correctedcorrected corrected ij against the attributes, wherfor the positive control. As evident from this figure, the bias of these four attributes are reduced substantially.
A weighted model-based approachOne of the most common applications of DNA methylation is in identifying subgroups with distinct methylation patterns () via unsupervised clustering techniques. Numerous clustering methods have been developed, including non-parametric (e.g. agglomerative hierarchical clustering) and model-based approaches. Modelbased clustering assumes that the data is generated from a finite mixture model, in which each mixture component corresponds to a cluster. It has emerged as a popular technique and allows for statistical inference (e.g. selecting number of clusters and estimating membership probability) to be carried out (). We let
P.F.Kuan et al.distributions. Specifically,where h 1 , h 2 are pre-estimated from positive control samples as shown in Section 3.
DefineyDefine Definey ijbe the unknown parameters. The mixture model log-likelihood function for the whole data is given byAs pointed out in Section 2, standard preprocessing steps for Illumina methylation assays include a quality control of probe measurements by excluding probes that have detection P-values (p ij ) larger than an arbitrary cutoff. This step results in missing observations and information loss by discarding a subset of probes. To avoid using a hard threshold for quality assessment, we would like to assign a weight for each sample which reflects its quality rather than discarding a sample completely from the analysis. We introduce an alternative model-based clustering on a weighted likelihoodbased approach. The objective of a weighted likelihood function is to assign a different weight to each sample, in which samples with higher weights have more influence in estimating the mixture parameters for cluster structure inference. The weighted mixture model log-likelihood function is given bywhere w i is the weight of sample i. Without loss of generality, we assume, where Q3 is the third quartile. Weighted model-based clustering has been shown to outperform the non-weighted method in both simulations and real datasets from remote sensing images in geology (). In addition,showed that detection P-values weighting in computing Pearson's correlation coefficient improved the performance of expression profiling in Affymetrix microarrays. The mixture modeling framework can be recast in an expectationmaximization (EM) framework for estimating the unknown parameters  k. We introduce z ik to be the unobserved indicator latent variable taking value 1 if sample i belongs to cluster k and 0 otherwise. The complete weighted log-likelihood function isIn clustering DNA methylation profiles for identifying subgroups among the n samples, we are faced with the well-known 'large p, small n' problem. One strategy is to apply dimension reduction, e.g. principal component analysis (PCA) to the p loci, followed by clustering on the reduced space. However, treating dimension reduction and clustering as two separate steps may destroy the cluster structure in the data (). Moreover, each PCA is a linear combination of all CpG loci, and does not allow for automatic selection of important CpG loci. Therefore, our goal is to incorporate a variable selection in model-based clustering approach, which identifies important CpG loci (variable selection) and subgroups among the n samples (clustering) simultaneously based on a penalized criterion (). We consider a penalized complete weighted log-likelihood to achieve the goal:where ={ kj ,k = 1,...,K;j = 1,...,p} and J() is a penalty function. Several choices of penalty functions are available, e.g. Pan andproposed an L 1-norm penalty function which takes the form J(As pointed out by, however, there is a natural group structure among  kj 's, i.e. for each j, we can treat  kj , k = 1,...,K as a group since they are associated with the same CpG locus. The L 1-norm penalty function ignores this group structure and treats  kj individually. As a result, it tends to keep many unimportant loci in the model. To circumvent this problem, Wang and Zhu (2008) proposed a penalty function that incorporates group information and shrinks  kj 's more effectively. In addition, some loci have large detection P-values across all samples and are unreliable. Therefore, we would like to impose heavier penalty on these loci. We achieve this by introducing g j to be weight of locus j, where larger g j values indicate more reliable probes. One possible choice is g) (here we take median across samples, cf. w i : median across loci). We generalize the proposed penalty function byby including the detection P-values as follows:are the unpenalized estimates of cluster means and  is a non-negative tuning parameter. Under this penalty function, loci with large detection P-values will be assigned a higher penalty, and are more likely to be excluded in the variable selection.  is a tuning parameter that controls the sparsity, i.e. small (large)  results in the selection of more (fewer) CpG loci. Additional details on the proposed penalty function are given in Supplementary Materials. We further assume that k = = diag( 2 1 ,..., 2 p ) as in. That is, the covariance matrices are the same across different clusters and are diagonal, a common assumption for a high dimension and small sample size problem. Further theoretical justifications for adopting the diagonal structure of the covariance matrix are provided by. At the t iteration of the EM algorithm, the E-step computesz computes computesz,...,n and k = 1,...,K. The M-step involves maximizing Equation (1) with respect to ( k ,  kj , 2 j ). Following the derivations inwith modifications to incorporate the weightsThe estimates for  j and  kj are not trivial, since the penalty function is singular at the origin point. However, similar to the derivation in Wang and Zhu (2008), we can update estimates of  j and  kj iteratively by the following explicit formula, which makes our method easy to implement in practice:+Plognwhere P is the total number of non-zero estimates inin in kj ,   2 j andand and k. The first term is the right-hand side is exactly the regular 2 n i=1 loglik when w i = 1/n, i. We name our method LumiWCluster (IlLumina W eighted modelbased Clustering).
RESULTS
DNA methylation studies in ovarian cancerWe illustrate our proposed method on the ovarian epithelial carcinoma tumors and cell lines methylation dataset from. In, we show the presence of sequence bias on the positive control sample in this dataset. The observed pattern in consistent with our six positive control samples (). Using the estimated h 1 and h 2 from our six positive controls, we adjust for the observed bias in the ovarian methylation dataset. Although h 1 and h 2 are estimated from an independent source of data, we show that the effect of sequence bias is reduced significantly for the ovarian methylation dataset (). This ovarian cancer dataset consists of 27 primary tumors (15 serous, 9 endometrioid and 3 clear cell) and 15 cell lines. By applying our proposed weighted clustering approach (LumiWCluster) to this dataset, the optimal number of clusters chosen is K = 4. Details are provided in Supplementary Materials. We also compare the clustering results from Gaussian mixture model without penalty and weights, i.e. J(
DNA methylation studies in HCV-cirrhosisOur next example is on a data set measuring DNA methylation of hepatocellular carcinoma (HCC) () from Illumina GoldenGate Methylation BeadArray. This data set consists of 20 samples from HCC with cirrhosis and 20 normal liver tissues. Similar to Section 4.1, we compare the clustering results from LumiWCluster, GMM-nopenalty, Mclust, k-means and PAM on the normalized data (corrected for sequence length and GC content biases). LumiWCluster selects K = 2, whereas the rest of the methods select K = 3 as the optimal number of clusters. LumiWCluster automatically shrinks 639 CpG to zero and results in perfect separation between the C and N samples. However, the other methods contain misclassification of these samples (). In Supplementary Materials, we also provide the clustering results for the other methods by fixing K = 2. Unlike LumiWCluster, these methods still misclassify the two different types of samples. Next, we run GMM-nopenalty on the subset of CpG loci selected by LumiWCluster [referred to as 'GMM-nopenalty (with subset of CpGs selected by LumiWCluster)' in. Interestingly, the optimal number of clusters is chosen to be 2 and results in perfect classification. This highlights that LumiWCluster is able to select informative CpG loci that differentiate cirrhosis from normal tissues. To further illustrate the advantage of LumiWCluster in selecting important CpG loci, we carry out the non-parametric Wilcoxon ranksum test for comparing cirrhosis and normal group samples on each of these 1505 CpG loci. The P-values are adjusted using the false discovery rate (FDR) control (). At FDR of 0.05, 597 loci are significant, of which 578 overlap with the 866 loci selected by LumiWCluster. This shows that LumiWCluster is able to retain statistically significant loci. As a comparison, 19 CpG loci have median detection P > 0.05 and will be excluded using the filtering criterion in. Among these 19 loci, 15 of them were shrunk to 0 by LumiWCluster.and B shows the distribution of the  values for two CpG loci that were not shrunk to 0, which appear to be informative in differentiating HCC with cirrhosis from normal liver tissues. We also include two CpG loci that have median detection P >0.05 and were shrunk to 0 by LumiWCluster (). This again demonstrates the ability of LumiWCluster in selecting informative CpGs which can differentiate the two groups despite being completely unsupervised.
A B C D
DISCUSSIONThe delineation of DNA methylation patterns is important in understanding how these epigenetic changes might lead to aberrant expression patterns and disease (). Advancements in biotechnology have enabled high-throughput profiling of DNA methylation, including the Illumina GoldenGate and Infinium BeadArray via bisulphite conversion. These platforms are robust, highly reproducible and require less starting materials. In the first part of this study, we illustrated the source of biases present in Illumina Methylation arrays and proposed a model for correcting these biases. A common approach in analyzing Illumina Methylation data includes omitting CpG loci and samples that exhibit detection P-values larger than an arbitrary cutoff. This hard thresholding step often results in missing observations and information loss by discarding a subset of probes. We proposed a weighted model-based approach called LumiWCluster that weights each CpG locus/sample by its detection P-values for clustering DNA methylation profiles. In this article, we set the weights as the median detection P-values across samples (or CpG loci) which appears to perform well in the two case studies. Optimal selection of weight functions is beyond the scope of this article and will be an interesting future research direction.
The Author 2010. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oxfordjournals.org 2849 at :: on August 31, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
at :: on August 31, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
15CL, 1CC, 2E 9S 13CL, 1CC, 2E, 9S 2 2CC, 7E, 6S 2CL, 2CC, 7E, 6S CC, clear cell; CL, cell lines; E, endometrioid; S, serous. Mclust, k-means and PAM (partitioning around medoids, a more robust version of k-means) (Kaufman and Rousseeuw, 1990) which identify K = 4, 2 and 2 as the optimal number of clusters, respectively. The optimal number of clusters chosen by k-means and PAM is based on the 'silhouette' criterion (Rousseeuwl, 1987). As shown in Table 1, k-means and PAM are unable to separate cell lines from primary tumors; whereas LumiWCluster, GMMnopenalty and Mclust yield comparable cluster membership, where cell lines are separated from primary tumors, but there are some mixing among the three tumor subtypes. However, an advantage of LumiWCluster is that it automatically shrinks 554 CpG loci to 0, which implies that these loci do not contribute to the clustering. This refines the set of CpG loci which are important in the resulting cluster structure. These 554 CpG loci include the eight sites which have median detection P > 0.05 and are excluded using the filtering criterion in Marsit et al. (2009). We also demonstrate that the ability of LumiWCluster in selecting important CpGs yields tighter clusters in Supplementary Materials. In addition, LumiWCluster results in smaller BIC compared with GMM-nopenalty and Mclust, indicating a better model fit. We provide additional information on the advantages of incorporating the detection P-values in our proposed clustering approach in Supplementary Materials.
