Motivation: Networks are vital to computational systems biology research , but visualizing them is a challenge. For networks larger than $100 nodes and $200 links, ball-and-stick diagrams fail to convey much information. To address this, we developed Network2Canvas (N2C), a web application that provides an alternative way to view networks. N2C visualizes networks by placing nodes on a square toroidal canvas. The network nodes are clustered on the canvas using simulated annealing to maximize local connections where a node's brightness is made proportional to its local fitness. The interactive canvas is implemented in HyperText Markup Language (HTML)5 with the JavaScript library Data-Driven Documents (D3). We applied N2C to visualize 30 canvases made from human and mouse gene-set libraries and 6 canvases made from the Food and Drug Administration (FDA)-approved drug-set libraries. Given lists of genes or drugs, enriched terms are highlighted on the canvases, and their degree of clustering is computed. Because N2C produces visual patterns of enriched terms on canvases, a trained eye can detect signatures instantly. In summary , N2C provides a new flexible method to visualize large networks and can be used to perform and visualize gene-set and drug-set enrichment analyses. Availability: N2C is freely available at http://www.maayanlab.net/N2C and is open source.
INTRODUCTIONSince the late 1990s, networks have been popularized for helping to increase our understanding of complex systems across various scientific disciplines (;), including systems biology and systems pharmacology. Commonly, networks are used to model complex systems by representing the various types of entities as nodes and their relationships as links. Network representation is useful for organizing the accumulating data about the system, which allows identifying novel non-trivial relationships. For example, network representation is useful for finding clusters in proteinprotein interaction networks () or for detecting network motifs (), such as feedforward and feedback loops. In addition, selected nodes with common properties, such as disease genes or differentially expressed genes, can be projected onto networks to highlight specific regions in the system, whereas forming a network can be a first step toward modeling the system's dynamics. In the fields of systems biology and systems pharmacology, networks are used to represent proteinprotein interactions (), cell signaling pathways (), gene regulatory networks (), metabolic networks (), drug-target networks () and other types of networks where nodes and links may represent different types of relationships (). Although network representation has been proven to be useful, large networks are difficult to visualize. The most popular approach to visualize networks is ball-andstick diagrams. Many software tools are available to convert networks saved in a tabular format into a graphic ball-andstick representation (). However, when there are more than $100 nodes and 200 links, a situation that is common in systems biology and systems pharmacology, ball-and-stick diagrams fail to convey much useful information. Alternative methods such as TreeMaps (), chord diagrams () or clustered adjacency matrix heatmaps can also visualize networks. These approaches have their own advantages and disadvantages, but most of these alternative methods have not been widely adopted. In the past, we have developed the software tool grid analysis of time-series expression (GATE), which is a tool to visualize time series gene expression data on a hexagonal grid movie (). Neighboring genes on the GATE hexagonal grid can be considered connected in a network where links between genes are established based on a genegene time-series correlation. This gave us the idea that any network can be visualized on a hexagonal grid. More recently, we developed an algorithm called Sets2Networks to construct functional association genegene and drugdrug networks based on their shared properties (). Given gene-or drug-set libraries, typically used for gene-set enrichment analyses (), the algorithm converts these gene-or drug-set libraries to functional association networks (FANs) based on various measures of gene or drug co-occurrence. In the FANs, genes are connected if they share many functional terms, such as belonging to the same pathway or regulated by the same transcription factor. Using the same approach, gene-set libraries can be transposedmaking the genes the terms, and the terms the set members associated with each gene; for example, a transposed gene-set library created from the Kyoto Encyclopedia of Genes and Genomes (KEGG) signaling pathways database () can be created where a gene/protein is the term, and members of each set are pathways that contain the gene/protein. Applying the Sets2Networks algorithm on transposed gene-set libraries results in termterm FANs. Similar networks have been developed for the Cytoscape (), plug-ins BiNGO () or EnrichmentMap (), which display ball-and-stick diagrams of related gene ontology (GO) terms (). With the popular tools BiNGO and EnrichmentMap, enriched terms are visualized on the network by highlighting the enriched nodes (GO terms) in different colors and size given input gene lists entered by users. Here we implemented a new approach to visualize large networks. We project the network nodes onto a square grid canvas. The method and tool are called Network2Canvas (N2C). N2C arranges nodes on the canvas to maximize local connections where a node's brightness is made proportional to its local fitness. In addition, we use this network visualizing approach to perform gene-set enrichment analyses (). Conceptually, this approach provides similar functionality as BiNGO and EnrichmentMap, highlighting enriched terms on FANs. However, instead of visualizing termterm networks using balls-and-sticks, we visualize the networks of terms on a canvas where each square on the canvas represents a functional term, and terms are organized on the canvas based on their gene-set content similarity. This provides a condensed and appealing view of the results. Besides creating canvases for the three GO ontologiesbiological process, cellular component and molecular functionas implemented for BiNGO and EnrichmentMap, we created canvases for 27 additional gene-set libraries. To make the plots interactive, webbased, lightweight and publication ready, we implemented the application using the JavaScript library Data-Driven Documents (D3) ().
METHODSGene-set library canvases: N2C contains 30 canvases representing 30 geneset libraries belonging to six broad categories: transcription, pathways, ontologies, drugs/diseases, cell lines and miscellaneous. Although some of the libraries are borrowed from other sources (), including some from our previous publications, new gene-set libraries were added, including a gene-set library created from the Encyclopedia of DNA Elements (ENCODE) project (), the Epigenomics Roadmap (), the Cancer Cell Line Encyclopedia () and the human and mouse gene atlases. Details about the construction of each gene-set library with references can be found in the supporting text. To create canvases from such gene-set libraries, we first transposed the libraries where the genes are the set labels and the terms are the set members. We then applied the Sets2Networks algorithm () to the resultant term-set libraries to create networks that connect terms from each library based on termterm gene-set content similarity. Drug-set library canvases: N2C also contains six canvases representing drugdrug similarity networks and six canvases representing drug-property/drug-property similarity networks. These 12 canvases are made from the same six drug-set libraries linking drugs to their shared properties or properties to their shared drugs. The drugs in the six drugset libraries are all approved by the Food and Drug Administration (FDA). Two libraries are created from side effect sources: The first side effect drug-set library is created from the Side Effect Resource (SIDER) side effect database (), which has computational formatted information from drug insert labels. The second drug-set library is created from the FDA adverse events reporting system (FAERS) (). To create this library, we used 1 million recent FAERS reports. We first identified the top 40 most common severe side effects and then assigned side effects to drugs if the side effect was disproportionally associated with the side effect. We also created a drug-set library based on the drug first-and second-level Anatomical Therapeutic Chemical classification codes by processing information available from the DrugBank (). In addition, we also created a drugset library based on the drug structure. Using the R library ChemmineR (), the simplified molecular-input line-entry system (SMILES) strings of each FDA-approved drug were converted to a binary string representing various structural elements of the drugs. Then, to create a drug-set library, the structural elements were made the terms, and the drugs that contain these structural elements are members of the sets. The last two drug-set libraries are created from processing the Connectivity Map database (CMAP) (). We first processed the ranked files from CMAP to identify the top 100 up-and down-regulated genes for each experiment. Using these gene lists, we performed gene-list enrichment analysis using the KEGG pathway gene-set library () or our own ChIP-seq enrichment analysis (ChEA) database/gene-set library (). If the KEGG pathway or the ChEA transcription factor experiment was found to be enriched (P50.05 after BH correction), then the drug was added to the pathwaydrug-set library or the transcription factor drug-set library, respectively. To create networks from such drug-set libraries, we applied the Sets2Networks algorithm to the transposed and untransposed drug-set libraries to create six networks that connect FDA-approved drugs and six networks that connect terms that describe drug properties. Converting networks to canvases: N2C creates canvases from any network, including FANs inferred from drug-or gene-set libraries. N2C contains two principal modules: the Annealer and the Visualizer. The Annealer converts an adjacency matrix representation of a network into a JavaScript Object Notation (JSON) file that contains the structure of the canvas; the Visualizer colors the canvas for display using D3 and outputs HTML and JavaScript files that can be viewed by modern browsers that support scalable vector graphics (SVG). To maximize the global fitness of the canvas, a Boltzmann probability function is used for the simulated annealing of the nodes on the canvas. Initially, nodes/terms are placed on the canvas randomly, and then pairs of nodes/terms are swapped repeatedly. As more time elapses, the probability of accepting a poor swap decreases (see supporting text for additional details). Enrichment analysis and assessing clustering on the canvas: Enrichment analysis using N2C uses the standard method of the Fisher exact test applied on the overlap proportions between the query input list and the lists in the gene-or drug-set libraries. Resultant P-values are corrected using two alternative methodsBonferroni and BenjaminiHochberg for multiple hypotheses testing. The enriched terms are highlighted on the canvas and are also output in a table with their corrected and uncorrected P-values. The enrichment analyses also produce Z-scores that show the degree of clustering of the enriched terms on the canvas. Subsets of nodes are considered significantly clustered when the position of the highlighted nodes on the canvas is significantly more clustered than what is expected for randomly placed nodes. To compute the degree of clustering, we first require a measure of average distance among the selected nodes: the mean nearest neighbor distance (). Because a random subset of nodes is distributed uniformly and randomly over the canvas, we also need a measure of clustering relative to this random unclustered distribution (). If we use the Manhattan distance, the probability of exactly zero nodes within a Manhattan distance of r of any given node is:where r is half the length of the squared canvas, and is the number of selected squares per unit area. Next, we turn to the second event, which is that there is at least one node within the annulus defined by the radii r and r  r. The area of this annulus is 4rr, so according to the Poisson distribution the probability of observing exactly zero events in this area is:Repeating the steps as above, the probability distribution for the nearest Manhattan distance neighbors is:This probability distribution can now be used to quantify the significance of any observed value of the mean nearest neighbor distance. For this, we need to know the expectation and variance under the null hypothesis of no clustering. This is calculated as follows:And the Manhattan distance z-score is given by:Note that here we retain the assumption of continuity. However, in our application the canvases are often not large enough and affected by the discrete nature of the squares. Running simulations for various size canvases, we noticed that power laws are a good approximation, so we fitted power laws to the expected distances between random nodes:The fitted values are listed in. In the web application, we used the approximation and table to compute the level of clustering. Network view and P-value view: N2C provides three views for each canvas. The default view shows the nodes in various shades of brightness, where node brightness is made proportional to its local fitness: the brighter a node is, the stronger its connections to its neighbors. The second view is called the P-value view. Here, only the top 20 enriched terms are highlighted where the brightness is based on the significance of the P-value. The third view is a network of enriched terms. Here, nodes are connected if they are enriched and close to each other on the canvas. All images generated by N2C are vector graphic SVG images that can be downloaded and imported into software tools such as Adobe Illustrator. The canvas view provides an interactive display of square labels, and clicking on squares provides more information about the terms and the set members.
RESULTS
Creating canvases from gene-set libraries and converting networks to a canvasThe workflow of N2C starts with a gene-or drug-set library coded as a gene matrix transposed (GMT) file or a network coded as an adjacency matrix. If starting with a drug-or a gene-set library, or other dataset that takes the form of a GMT file, the Sets2Networks algorithm converts the GMT file into an adjacency matrix. If starting with a network, the network is converted into an adjacency matrix. Python scripts with example data files and detailed explanations are provided on the N2C website help section. Using the adjacency matrix as input, the Annealer component of N2C organizes the nodes on a canvas, and once it is done annealing, it generates a JSON file that contains the information needed to display the canvas. The Visualizer script then creates the HTML and JavaScript files that are needed to display the interactive canvas in a browser ().
The N2C web applicationWe created 30 canvases from 30 different gene-set libraries () and 12 canvases from 6 drug-set libraries () and combined them into a web-based application available athttp://www.maayanlab.net/N2C (). From this interface, users can perform gene-or drug-set enrichment analyses for data exploration and generate figures for publications. Later, we demonstrate how this can be accomplished in two case studies. In addition, Python scripts and a user manual are provided to enable users to create their own canvases from their networks.
Application of N2C to analyze gene expression data collected from embryonic stem cellsTo demonstrate the usefulness of N2C, we performed enrichment analysis on lists of genes that are up-regulated after RNAi knockdown of various pluripotency transcription factors in mouse embryonic stem cells (mESCs) (). We first extracted lists of differential expressed up-regulated genes after knockdowns of the key well-studied factors in mESCs: Nanog, Oct4, Sox2, Esrrb and Tbx3. All these factors are critical for maintaining pluripotency because, when knocked down with short hairpin RNAs, mESCs differentiate into embryoid bodies after several days. Although it is known that these factors autoregulate each other and often physically interact (), not much is known regarding theIn each canvas, each node (square) represents a gene list associated with a gene-set library term. The terms are arranged on the canvas based on their gene-set content similarity. The brightness of each node is determined by its similarity to its eight neighbors. Canvases are color coded based on their category: pathways, cyan; transcription, purple; ontologies, green; disease/drugs, yellow; cell types, red and miscellaneous, blue) or an FDA-approved drug property, e.g. a side effect or a structural element. Nodes are arranged based on their drug property similarity (for the drug canvases) or based on drug content similarity (for the drug property canvases). Nodes are colored based on their similarity to their neighbors: the brighter the spot, the higher the similarity. The six drug property set library canvases are the inverse of the six drug-set library canvases, all made from the original six drug-set library. Screenshot from the N2C web application. The interactive user interface of N2C provides users with the ability to select the desired canvas (KEGG is selected a default), change the canvas colors, highlight specific nodes on the canvas, perform enrichment analyses and explore the content of each node. The enrichment results are displayed in a table and can be exported subtle differences of the effects of these knockdowns on lineage propensity. Using N2C, we generated enrichment analysis canvases resulting from ChEA, histone modifications, MouseGenome-Informatics/Mammalian-Phenotype (MGI-MP) and mouse cell atlas canvases. The results show that, overall, the various transcription factors induce similar patterns, but some differences are clearly visible (). For example, Nanog, Esrrb and Tbx3 induce genes that are targeted by EGR1, but EGR1 is not enriched for Oct4 and Sox2 knockdowns. Esrrb is the only factor that does not induce the expression of genes regulated by Myc. Tbx3 up-regulates genes that are mostly regulated by the active histone marks H3K4me3, whereas the rest of the factors up-regulated genes are enriched for the repressive marks H3K27me3. Interestingly, Sox2 and Oct4 have a strong neuronal signature based on both MGIMP and the mouse gene atlas, suggesting a propensity for differentiation toward neuroectoderm. It was previously described that Sox2 and Oct4 interact and regulate genes together (), whereas induction of Oct4 alone in neuronal progenitor cells is sufficient for induced pluripotency stem cell reprogramming (). Nanog, Tbx3 and Esrrb show suppression of kidney, intestine, bladder and endothelial cell phenotype genes. This suggests that the knockdown of these factors promotes the propensity toward mesoderm lineage differentiation. The advantage of the N2C visualization is that such similarities and differences can be seen immediately by the
Application of N2C to identify and visualize links between drug-induced side effects and chemical structureUsing the drug-set libraries created from FAERS, we ran the N2C enrichment analysis to identify the level of clustering of drug lists linked to 48 severe side effects on the drug chemical structure canvas. The hypothesis is that if drugs that are associated with a specific side effect are clustered on the drug-structure canvas, there might be a connection between drug structure and the side effect. Interestingly, for 18 of the 48 side effects, we observed significant clustering (z score42.0) (Tables 2 and Supplementary Table S1, first column). This means that for 18 side effects there are common structural elements that are predictive of potential side effects. For the top three side effectscardiac arrest, coma and pancreatitiswe display the drug canvas signatures (). The cardiac arrest and coma canvases share some structural elements, whereas the pancreatitis side effect canvas displays a completely different cluster of drugs with similar structures. Because the canvas visualization of the drugdrug association networks involves information loss due to the two-dimensional constraint and annealing process, we also examine the ability to associate side effects and structural elements directly from the adjacency matrices before the annealing. This was done to compare the level of information loss and to see whether the ranking of side effects is significantly altered. We computed the average network distance between structural elements for enriched side effects (P50.05 without correction) to obtain a new ranked list of side effects that share related structural elements (Tables 2 and Supplementary Table S1, second and third columns). Although the two methods produce slightly different ranking of side effects, it is surprising that such a large majority of severe side effects can be predicted based on common structural elements by both methods. This may be important for in silico toxicity surveillance and for future drug design. Although quantitative structureactivity relationship models have been shown to mostly fail in the past in predicting most severe side effects, these initial drug enrichment results indicate that there may be useful information in approaching the problem in a slightly different angle as was done here. On the other hand, the methods used here to compute the relationship between structural elements and side effects can be improved in many ways, including better computation of expected distributions and better consideration of weights of enriched terms on the canvas.
DISCUSSION AND CONCLUSIONSN2C provides an alternative method to visualize large networks and perform enrichment analyses. Although the approach is capable of condensing information, the projection of a high-dimensional object onto a two-dimensional canvas does cause significant information loss. This is compensated with the ability to better detect clusters from the network data by eye. However, it should be noted that the annealing approach may not reach the best possible fitness and may result in different layouts for the same input networks. The application of N2C to gene-set libraries currently only provides visualization of termterm libraries, but future applications can use the same approach to display all human or mouse genes. Seeing how groups of genes become active/inactive or expressed/silenced in different cell lines and conditions directly on such canvases may be illuminating. In addition, because each cell type has a unique expression signature and during development or disease there are transitions between cell types and cell phenotypes, movies of either enriched terms or clusters of genes can be created. The N2C approach and web-based tool generate visually appealing enrichment analysis signatures from sets of differentially expressed genes. Such signatures can be applied in high-throughput to datasets that profiled many conditions or many patients to detect patterns across large datasets (). Instead of visualizing the enriched terms for one list, the canvas can be used to displayNote: The first column provides the z-score computed on the canvas as described in the method. The second column is the average distance between enriched terms on the drug structural element adjacency matrix. The third column is a P-value that examines the difference between the observed distance and the expected mean distance. The expected mean distance is computed as the average distance for the same number of, but randomly selected, structural elements from the drug structural element adjacency matrix.keys, using the P-value view in N2C show enrichment for MACCS keys for drug lists associated with the side effects of cardiac arrest, coma and pancreatitis the accumulation of enriched terms for many lists as a twodimensional histogram. The approach to link side effects to structural elements works for some drugs and some side effects but not for most drugs and side effects. A similar approach can be used to see if gene expression signatures induced by drugs can be predictive of side effects or if structural elements can be predictive of beneficial indications for various diseases. If such connections can be made, new drugs can be designed and tested by connecting structural elements to create novel drugs. The gene expression approach can be used to detect potential side effects before these manifest in patients.
The Author 2013. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
Network2Canvas: network visualization on a canvas with enrichment analysis at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
C.M.Tan et al. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
