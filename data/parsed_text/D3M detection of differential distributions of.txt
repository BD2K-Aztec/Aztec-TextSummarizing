Motivation: DNA methylation is an important epigenetic modification related to a variety of diseases including cancers. We focus on the methylation data from Illumina's Infinium HumanMethylation450 BeadChip. One of the key issues of methylation analysis is to detect the differential methylation sites between case and control groups. Previous approaches describe data with simple summary statistics or kernel function, and then use statistical tests to determine the difference. However, a summary statistics-based approach cannot capture complicated underlying structure, and a kernel function-based approach lacks interpretability of results. Results: We propose a novel method D 3 M, for detection of differential distribution of methylation, based on distribution-valued data. Our method can detect the differences in high-order moments, such as shapes of underlying distributions in methylation profiles, based on the Wasserstein metric. We test the significance of the difference between case and control groups and provide an in-terpretable summary of the results. The simulation results show that the proposed method achieves promising accuracy and shows favorable results compared with previous methods. Glioblastoma multiforme and lower grade glioma data from The Cancer Genome Atlas show that our method supports recent biological advances and suggests new insights.
IntroductionDNA methylation is an epigenetic chemical alternation in which a methyl group is attached to a 5-carbon of a cytosine (C) base. It is closely related to gene expression, silencing and genomic imprinting, including oncogenesis. Typically, methylation is explained as occurring in cytosine-phosphate-guanine (CpG) sites in mammals. The methylation of promoter regions, in particular, silences cancer suppressor genes (). We focus on the methylation data from Illumina's Infinium HumanMethylation450 BeadChip. One of the key issues for methylation analysis is to detect differentially methylated sites, i.e. a significant difference in methylation levels between the case and the control groups at a site. When comparing groups, we often summarize (or aggregate) data in summary statistics, such as mean and variance, and then investigate the difference between the groups. For example, IMA () detects the differentially methylated sites by T-test, Empirical Bayes (EB) method or by MannWhitneyWilcox (MWW) test. DiffVar () detects the sites by testing significant difference of variance. Other nonparametric approaches exist, such as the KolmogorovSmirnov test (KS) or). In particular, since KS and MMD consider the underlying distribution structure, they are better suited for use with complicated distributions than methods based on summary statistics. These approaches are insufficient from some perspectives; underlying distributions are complicated by being skewed, heavy-tailed and multimodal. In particular, since cancer cells include heterogeneities, measurements of the methylation levels potentially include complex distribution shapes. This observation indicates that we need to consider the underlying structure. The disadvantage of KS and MMD is infeasible interpretability of results because they measure the maximum and kernel distances of distributions, respectively, which are difficult to interpret corresponding to the actual difference of underlying distributions. We develop a method to detect differential methylation sites with distribution-valued data (). Distribution-valued data are an example of symbolic data analysis (). This framework can treat complex data such as functional (), tree (), set, interval and histogram values (). The proposed method describes case and control groups using distribution values. We measure the differences between distributions using the Wasserstein metric. We detect the differential methylation sites using a statistical test of significant differences of distribution functions.
MethodsOur method is aimed at a distribution-based comparison of methylation levels in two groups at a single cytosine level. We construct distribution functions representing the two groups at each site. Next, we compare the groups using a dissimilarity measure and test statistical significance by resampling approach at a site. We adopt an L 2-Wasserstein metric () as a dissimilarity measure, a distribution function-based measure of statistical distance. The advantage of this distance is the interpretability of results because the distance can be decomposed into three components, i.e. mean, variance distribution shape. This fact leads to visualization of results using a QQ plot to interpret the detected distribution difference including hypo-or hyper-methylation status. Methylation level can be represented by a beta value that is the ratio between the methylated probe intensity and the overall intensity (). The definition of ith site beta value in Illumina methylation assay is as follows:Beta i  maxz i;methy ; 0  a maxz i;unmethy ; 0  maxz i;methy ; 0  awhere z i;methy and z i;unmethy are the intensity measured by ith methylated and unmethylated probes, respectively and a is constant. b values have biologically direct interpretation (), as opposed to M value (i.e. logit transformation of b value). IMA and DiffVar use b value and M value, respectively. In the following, we use b value as the input of D 3 M.
Construction of objectsXsIn practice, let the beta value observations be x j s i ; j  1; 2;. .. ; n and y j s i ; j  1; 2;. .. ; m following F i x and G i y, respectively, where n and m are the respective numbers of observations at s i. From the data, we construct the empirical distribution functions;where 1a b  1 if a b 0 otherwise: (2.
Dissimilarity measure for distributionsThe Wasserstein metric is defined by the following:where 1 q 2 and F 1 i x and G 1 i y indicate quantile functions. In particular, in the case of q  2, the metric can be decomposed into three components that describe the distribution characteristics, i.e. mean, variance shape (): l i  l0 i  2  r i  r0 i  2  2r i r 0 i 1  q i;i 0 where l i and r 2 i (respectively, l 0 i and r 0 i 2 ) are mean and variance of F i x (respectively, G i y), and q i is the correlation index of the points in the QQ plot of F i and G i. The empirical estimator of the Wasserstein metric is given byTechnically, we use quantiles to compute the approximation of the (7) for reducing computational costs. Let Q i;1 ; Q i;2 ;. .. ; Q i;K  and Q 0 i;1 ; Q 0 i;2 ;. .. ; Q 0 i;K  be k-quantiles of F i x and G i y. We calculate d 2  ^ F i ; ^ G i  % P K l1 Q k;l  Q0 k;l  2 in the case of q  2, instead of evaluating the integral in (7). Here, we simply write d i : d ^ F i ; ^ G i .
Detection of differential methylation sitesWe use the metric to investigate whether two distributions are significantly different. We pose statistical hypotheses as follows.Null hypothesis :We use resampling to construct a null distribution.. Next, we obtain the new distancei;B all  be all possible distances for the permutation process. Then P-value isB all :Approximation of (9) uses the subset ofwhere B B all :In the simulation of Section 3 and data analysis in Section 4, we set B  10, 000. The number of permutations B is closely related to the accuracy of the P-value. However, resolution of P sub is limited to 1=B, if we need the very small P-values. One solution is to perform a large number of permutations, but it is computationally expensive. A semi-parametric estimation of P-value is proposed byto obtain more accurate P-values. We use an exponential distribution to estimate the distribution tail as follows,where k i is a scale parameter and d min i is a threshold that we set to 99 th percentile of null distributions. We estimate k i using data above the threshold. Technically, we perform the semi-parametric estimation only if P sub d i  reaches to zero.
Graphical representation of resultsThe graphical interpretation of the statistical test result is important. One approach is to plot all the distribution (density) functions of candidate sites, but this is infeasible for hundreds of sites. We use a QQ plot with two distributions. It enables us to visualize many pairs of distributions at a time, with the directions being easy to interpret. In the actual example shown in Section 4, we plotted 1000 pairs of differentially methylated distributions (). We can see the hyper-methylation with the most significant 1000 sites (blue lines in).
Simulation
Simulation settingWe evaluated the proposed method with simulated datasets with focus on single cytosine level in the case and control group. Our simulation is intended for the detection of differential methylation sites when there is cancer heterogeneity. Here, the cancer heterogeneity is described by the multiple modes of distributions. We conduct a statistical test for H 0 : F i  G i $ H 1 : F i 6  G i under significance levels 5%, and we compare the results to those of the other methods, i.e. DiffVar, MMD, KS, MWW and EB. We used several packages; missMethyl (), limma () written in R and mmd () (http://www. kyb.tuebingen.mpg.de/bs/people/arthur/code/mmd.zip) written in MATLAB. The setting of missMethyl is default and mmd with options alpha  0.5 and MMD_METHOD  'approxmoments'. We describe the outline of the simulation as follows. The details are described in Supplementary file S1 and R codes are described in Supplementary file S2. The data are generated by using two types of distributions. The control and case groups are represented by normal and normal mixture distributions, respectively. In each case (case 1case 8 in), there are 80 samples; 40 samples for case and control groups, respectively (). We performed the statistical test with each method for 50 times in every case (i.e. cases 18) and evaluate averages of a type I error and power. Besides we repeat this process for 100 times to assess the variances of the averages.
Simulation resultsThe results are shown in. In the first case, it is shown that error rates of D 3 M, MMD, DiffVar, KS, EB and MWW are close to the significance levels, which indicates that they effectively control type I errors. Furthermore, we investigate the power for cases 28. The KS test and MMD show relatively good performance in case 2 where only the shape parameters of the distributions differ. However, they cannot capture the feature of case 8 where the majority of the two groups are overlapped with each other although 15% of minority of distribution exists. Besides, KS testing fails to detect case 6 where 15% of minority distribution is hyper-methylated and MMD fails to detect case 4 where only mean is different. DiffVar shows high power for cases where explicit hypothesis is tested, however, it might capture the other distribution features for the cases with equal variances (case 6), leading to uninterpretable results. EB can appropriately distinguish only the mean difference that is the explicit hypothesis. MWW can detect case 4 and 7, but cannot detect cases in which the means differ under non-normality. The proposed D 3 M provides preferable results over the eight cases. On one hand, from this simulation, the differential distributions in each case can be detected with D 3 M with the sufficient power, which indicates that it works well for the given situations and it can be applied to various cases flexibly. On the other hand, a small sample situation should also be examined. We conduct the simulations in Supplementary file S1 considering several situations such as; small sample size (25 samples) with the same setting of(Supplementary Tables S.3 and S.6), sample sizes are extremely different between the case and control groups (Supplementary TableS.5). In general, the power of D 3 M is decreasing as well as the other methods.
Actual example
DatasetsWe apply our method to methylation data of glioblastoma multiforme (GBM) and lower grade glioma (LGG) from The Cancer Genome Atlas (TCGA). GBM is the primary brain tumor that progresses with malignant invasion destroying normal brain tissues (TCGA, 2008). In this analysis, we compare the methylation levels in the LGG and GBM groups, and then specify the differential methylation sites. We focus on mean, variance and shape differences using EB, DiffVar, KS and D 3 M and compare the results. Here, we briefly describe the datasets and preprocessing as follows. All the samples are hybridized to Illuminas Infinium HumanMethylation450K arrays, including 485 577 CpG sites, which is downloadable from TCGA portal sites. Each CpG site contains 145 samples and 530 samples in GBM and LGG, respectively. We remove CpG sites on the X and Y chromosomes and SNP control probes(rs1rs65). We also use HumanMethylation450 v1.2 SNP Update Table to remove SNP related probes by minor allele frequency 1%. As a result, we get 351 932 probes. Missing values in both groups are inferred using R package pcaMethods () with pca functions since DiffVar does not accept missing values and the number of the probes including missing values cannot be ignored. We remove the batch effect using the ComBat function in SVA package () with default settings. We use batches having more than 2 samples. The details are described in R codes in S3. We finally obtain 141 GBM and 530 LGG samples.
Analysis resultsSignificant differential methylation sites were identified as those having false discovery rate (q-value) () less than 1%. The Venn diagram () shows the number of detected probes from the perspective of mean, variance and shape difference of distributions using EB, DiffVar, KS and D 3 M, and 279 008, 191 050, 297 493 and 255 317 sites are totally detected, respectively. From, most of detected sites with the shape difference are overlapped with the sites by the mean and the variance differences, respectively. However, when focusing on top 1000 significant sites (), the overlaps between them become very small. This suggests that the 'signal' of differentially methylated sites in terms of q-value is quite different from each other. The 'signal' is important for the further analysis, such as the pathway analysis since we often use the filtered gene set, e.g. using top 1000 significant sites. We also calculate the Spearman's rank correlation between the four methods (D 3 M, EB, KS and DiffVar) resulting from q-values (Supplementary Table S.7). Among the detected sites with D 3 M, we investigated sites with the smallest 1000 q-value. Heat map and QQ plots of the top 1000 sites are shown inand B. Comparing heat maps and QQ plots, the methylation levels are easy to interpret in the latter. From the QQ plot, we could see that the top 1000 sites tend to be hypermethylated in LGG (with the reverse in GBM). Among the top significant 1000 pairs of distributions of GBM and LGG, we can observe that there are mainly two patterns in terms of the QQ plot. Then, we cluster the 1000 curves in QQ plot into two classes; we consider input data as Z i  Q i;1 ; Q i;2 ; .
.. ;Q i;K ; Q 0 i;1 ; Q 0 i;2 ;. .. ; Q 0 i;K i  1; 2;. .. ; 1000 and define the dissimilarity as ffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffi ffi Z i  Z j  2 q i 6  j where Q i;k and Q 0 i;k k  1; 2;. .. ; K is kth quantile in LGG and GBM group, respectively. Then we apply the standard hierarchical clustering (Clusters 1 and 2 in). Typical distribution examples in each cluster are shown in. Clusters 1 and 2 contain 715 and 209 sites, respectively. Next, we perform enrichment analysis on gene sets in clusters 1 and 2. We used ingenuity pathway analysis (IPA) for 444 and 209 genes in clusters 1 and 2, respectively, and significantly enriched pathways in each cluster using Fisher's exact test.shows five pathways and related genes with q-values 10 3 in each cluster. Other pathways are described in Supplementary files S4 (cluster 1) and S5 (cluster 2). The pathways in clusters 1 and 2 include significant pathways in GBM, which have been previously reported even though we do not include any information on GBM. The axonal guidance signaling pathway in cluster 1 has been suggested as prompting the cell invasion of GBM () and ERK/MAPK Signaling is reported to be up-regulated in GBM (). The enrichments of Caveolar-mediated Endocytosis Signaling and Calcium Signaling are studied in (). The remaining pathways might be explained elsewhere. Our prediction using D 3 M provides a hypothesis that DNA methylation in these pathways might cause the phenotypical difference between GBM and LGG.
Detection of differential distributionsWe further focus on Wnt in Human Embryonic Stem Cell Pluripotency pathway, and then compare the ranking based on Pvalue by D 3 M with those by other methods. The activation of Wnt family is closely related to cell differentiation of GBM (). In our analysis, there are 18 Wnt genes on the probes. Among them, six Wnt genes (Wnt2, Wnt2b, Wnt3, Wnt4, Wnt7a and Wnt 9a) are included in top 1000 significantly differentially methylated probes using D 3 M. We investigate the enrichment of the six Wnt genes in top 1000 significant probes using Fisher's exact test and we confirm the enrichment of the genes (the details are described in Section S-3-3 in Supplementary file S1). The six Wnt genes are included in both the clusters 1 and 2, and the majority of the distribution is hypomethylated and the minority is hyper-methylated in GBM, vice versa in LGG. This suggests that demethylation of Wnt might trigger the activation of Wnt family and prompt cell differentiation.We focus on a probe and generate beta values, 40 samples each in a case and a control group respectively. We apply six methods to this data and evaluate the P-value at the significance level, i.e. 5%. This process is repeated 50 times and returns the averages of type I error (%) and power (%). We represent the power in italics within top three. Furthermore, we also evaluate the standard deviations of the averages; we repeated the process of the evaluating average of type I error and power a 100 times and then obtained the standard deviations of the averages.
A BThe ranking of Wnt genes in D 3 M, EB, KS and DiffVar is shown in.
DiscussionHere, we summarize the advantages and disadvantages of D 3 M, DiffVar as well as MMD. These methods are designed for detecting differential methylation levels focusing on cancer heterogeneity, which is caused by epigenetic instability and diversity. Cancer heterogeneity can often be confused with outliers. For example, DiffVar fails to detect simulation case 6 as differential methylation, even though we set the variance, but not the mean and the shapes, to be the same for the two groups. This is because DiffVar deals with minority distributions as outliers and evaluates only those in the majority. In general, the significance of an outlier depends on the context of analysis (). When an outlier arises from measurement error not relevant to signals of interest, we must remove them prior to analysis. In contrast, when an outlier arises from an unusual event including new findings that we seek, we use them for further analysis. In this case, cancer heterogeneity could be regarded as an abnormal event compared with normal cases, and thus must be included in the analysis.MMD was originally developed as a distribution-free two sample test based on a kernel. Both the Wasserstein metric and MMD are family of integral probability metrics () designed to capture not only such basic difference as those between the means but also such higher-order differences as those between the distribution shapes of the groups. From the simulation in Section 3.1, we see that MMD shows good detection performance in cases except cases 4 and 8. D 3 M shows good performance over all eight 8 cases. Specifically, D 3 M shows excellent performance in cases 7 and 8. In the study of sample size effect in Section S-2-1, using the same simulation model as in Section 3.1, the result indicates that the superiority of D 3 M to other methods are reduced compared to large sample case, although all the methods decrease in power (SupplementaryD 3 M can be flexibly applied to differential methylation problems. Simulation results indicate that D 3 M can detect not only shape differences but also summary statistics differences as effectively as EB and DiffVar, i.e. natural results from the decomposition (6). This suggests that if we cannot obtain sufficient power using a simple summary statistics approach, we have other options to add shape information. If we would like to simultaneously check the results of variance and shape differences, we remove the mean from the data using X  EX in each group at a site before applying D 3 M. This option is provided with R package D 3 M; in the function D3M::d3m, the logical parameters of rm.mean and rm.var exists. If we would like to see the variance and shape differences at the same time, we just set the rm.mean  T and rm.var  F. The statistical test of D 3 M relies on resampling and requires computational time to calculate P-values. However, we could reduce the resampling time using a semi-parametric approach (). A current limitation of D 3 M is that it deals with univariate distributions. In a case of the study of large sample sizes, we can deal with covariates, such as age and gender, but our method currently does not incorporate them into the model, and the user needs to remove the effects of covariates; for example, using residuals with regression analysis, prior to the analysis. The extension of D 3 M to multivariate distribution relies on the estimation of the Wasserstein metric between the empirical multivariate distributions. The approximation of the Wasserstein metric between the multivariate distributions has been studied recently in (), and we could derive the null distributions based on that approximation. D 3 M does not support a spatial correlation of methylation levels within the CpG island in the current form (). The spatial information will enhance the power of detection for differential methylated sites. This could be accomplished by spatially weighted average of Wasserstein distance over a fixed range of locus. These extensions of D 3 M will be covered in a future study.
ConclusionIn this study, we proposed a novel method, D 3 M, for detecting differential methylation sites based on distribution-valued data. We showed that distribution shape includes interesting information other than that found using mean-and variance-based methods. A simulation study indicated that D 3 M is capable to detect various situations. In the application to the GBM and LGG dataset in the TCGA cohort, we identified 1000 sites with the smallest q-values. Most of the sites detected by D 3 M show strong heterogeneity and tend to be hyper-and hypo-methylated in LGG and GBM, respectively, as found in previous studies. Since the GBM and LGG dataset contains a large number of significantly different sites, including 279 008, 191 050, 297 493 and 255 317 sites for EB, DiffVar, KS, and D 3 M respectively; at the FDR 1%, it is difficult to understand the methylation levels at these sites. In the future, it would be of interest to develop a method that describes the diversity of methylation levels.
at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
Y.Matsui et al. at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
