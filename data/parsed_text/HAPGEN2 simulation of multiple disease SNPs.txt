Motivation: Performing experiments with simulated data is an inexpensive approach to evaluating competing experimental designs and analysis methods in genome-wide association studies. Simulation based on resampling known haplotypes is fast and efficient and can produce samples with patterns of linkage disequilibrium (LD), which mimic those in real data. However, the inability of current methods to simulate multiple nearby disease SNPs on the same chromosome can limit their application. Results: We introduce a new simulation algorithm based on a successful resampling method, HAPGEN, that can simulate multiple nearby disease SNPs on the same chromosome. The new method, HAPGEN2, retains many advantages of resampling methods and expands the range of disease models that current simulators offer. Availability: HAPGEN2 is freely available from
INTRODUCTIONGenome-wide association studies have become a powerful approach for uncovering the genetic variants that impact human phenotypes. Simulation studies are a popular and inexpensive approach to evaluate new methods for statistical analysis () and to examine the power of different experimental designs (). The traditional approach of simulating a population forwards () or backwards () in time ignore the large amount of observed genetic data that are available, can be computationally intensive and can struggle to match real LD patterns. To overcome these problems,introduced a novel simulation approach, HAPGEN, which uses an alternative resampling approach. Given a reference panel of haplotypes, this method produces a sample of haplotypes with patterns of LD similar to those in the reference panel. Using the HapMap3 and 1000G haplotype data as reference panels, HAPGEN is able to simulate data for many populations. In addition, it is fast and can simulate a single disease SNP under a general disease model, allowing the user to specify the risk allele and heterozygote and * To whom correspondence should be addressed.  The authors wish it to be known that, in their opinion, the last two authors should be regarded as joint Last Authors. homozygote relative risks. Other resampling methods also exist (), but they and HAPGEN can only simulate a single disease SNP on the same haplotype. There are many complex diseases with multiple-associated loci on the same chromosome, some of them in close proximity (e.g.), so the ability to simulate multiple disease SNPs on the same chromosome would be desirable. To address this issue, we have devised a new approach, extending HAPGEN, to simulate multiple nearby disease SNPs on the same chromosome.
METHODSThe HAPGEN2 simulation approach is similar to that of HAPGEN and is based on the Li and Stephens (LS) model () of LD. Briefly, given a reference panel of haplotypes, H R ={h 1 ,...,h r } as input, where each haplotype is typed at L biallelic sites, that is h i = (h (i,1) ,...,h (i,L) ) and h (i,j) {0,1}, the LS model models each newly simulated haplotype as an imperfect mosiac of the haplotypes in H R and the haplotypes that have already been simulated (see below for more details). Simulation of case control data is based on a set of disease SNPs, D ={d k : d k {1,...,L},k = 1,...,K} with effect sizes and RR ={(rr 1 k ,rr 2 k )}, where rr 1 k and rr 2 k are the disease risks of carrying one and two copies of the 1 allele relative to carrying two copies of the 0 allele at d k , which combine multiplicatively across the K disease SNPs. The haplotypes, H P ={h r+1 ,...,h p }, for the control individuals are simulated first, followed by the haplotypes, H Q ={h p+1 ,...,h q }, for the case individuals.
Simulating control dataWe simulate the control data as population controls (so that some of them may be cases) and simulate each additional haplotype, h i+1  H P , sequentially under the LS model. We use the copying states, z (i+1,j) {1,...,i}, which evolve in a Markov manner, to indicate the haplotype that h (i+1,j) copies at site j. We simulate each haplotype in three stages. First, the cross-over events, which are locations where z (i+1,j) = z (i+1,j1) , are simulated according to the transition probabilitieswhere I z is 1 if z = z (i+1,j1) and 0 otherwise, and  j is genetic distance between SNPs (j 1) and j. Conceptually, the cross-over events mimicks the effect of recombination and breaks up h i+1 into independent segments, {h (i+1,s 1 ) ,...,h (i+1,sn) }, where each segment is a haplotype of SNPs between two cross-over events. Second, the copying state for each segment is sampled uniformly from {1,...,i}. Finally, the allele at each SNP is simulated conditional on the copying state and a mutation parameter  i :Spencer et al., simulated amounts of novel haplotype variation similar to data simulated under the coalescent model.
HAPGEN2
Simulating case dataWe simulate the case haplotypes in a similar way, but we simulate them sequentially in pairs (with each pair corresponding to a case individual) and oversample haplotypes carrying the risk alleles based on the relative risks. Simulation of each haplotype pair, (h i+1 ,h i+2 )  H Q , proceeds in four stages. First, the cross-over events are simulated in the same way as for the controls, according to (1). Second, the alleles at the disease SNPs are simulated. Let (h 1 D ,h 2 D ) be the subset of (h i+1 ,h i+2 ) that consist of the alleles at the disease SNPs, so that hfrom its joint distribution, which is calculated from the relative risks and the marginal frequencies of each segment in H P and H R , using Bayes Theorem:is the genotype at d k , and p(h s ) is the frequency of the haplotype segment h s in H R and H P. Third, the copying state for each segment, h (i+1,s) , is simulated independently and is drawn uniformly from {1,...,i}, like we do for the controls, if s does not include any disease SNPs; or else it is drawn fromand 0 otherwise. Finally, each allele for h (i+1,s) is simulated according to (2). Copying states and alleles for h i+2 are simulated in the same way.The model described here can be easily extended to simulate interacting disease SNPs (we currently provide an R package that does this) and admixture (using reference panels from multiple populations), which we hope to implement in the future.
The Author 2011. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oup.com at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
RESULTS To demonstrate HAPGEN2, we have simulated, using HapMap2 CEU as the reference panel, 2000 cases and 2000 controls at 880 SNPs across a 700 kb region on chromosome 21, with 3 disease SNPs, at positions d 1 = 25 356 790, d 2 = 25 390 071 and d 3 = 25 691 378, each under a log-additive disease model with a heterozygote relative risk of 1.3. The simulation process took <10 s on a 2.93 GHz processor laptop, and will increase linearly with the number of SNPs and individuals. Figure 1, produced by HAPLOVIEW (Barrett et al., 2005), shows the similarity between the LD patterns of the reference panel (top) and the simulated haplotypes (bottom). The top plot in Figure 2 shows the log 10 (P-values), for the log-additive test, across the region, illustrating the signal of association at the disease SNPs; subsequent plots show the P-values conditioned on the genotypes at d 1 , at d 1 and d 2 and at d 1 , d 2 and d 3 , respectively, confirming that there are indeed three independent disease SNPs. 4 DISCUSSION We have introduced a new resampling method that can simulate multiple disease SNPs on the same haplotype, which will be particularly useful for investigating disease models involving multiple disease SNPs within close proximity. HAPGEN2 is fast, simple to use and available as a C++ package from http://www.stats.ox.ac.uk/~marchini/software/gwas/gwas.html, along with instructions and supporting resources, such as recombination rates, HapMap and 1000G reference panels.
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
