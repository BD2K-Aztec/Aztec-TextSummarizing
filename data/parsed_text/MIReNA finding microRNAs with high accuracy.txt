Motivation: MicroRNAs (miRNAs) are a class of endogenes derived from a precursor (pre-miRNA) and involved in post-transcriptional regulation. Experimental identification of novel miRNAs is difficult because they are often transcribed under specific conditions and cell types. Several computational methods were developed to detect new miRNAs starting from known ones or from deep sequencing data, and to validate their pre-miRNAs. Results: We present a genome-wide search algorithm, called MIReNA, that looks for miRNA sequences by exploring a multidimensional space defined by only five (physical and combinatorial) parameters characterizing acceptable pre-miRNAs. MIReNA validates pre-miRNAs with high sensitivity and specificity, and detects new miRNAs by homology from known miRNAs or from deep sequencing data. A performance comparison between MIReNA and four available predictive systems has been done. MIReNA approach is strikingly simple but it turns out to be powerful at least as much as more sophisticated algorithmic methods. MIReNA obtains better results than three known algorithms that validate pre-miRNAs. It demonstrates that machine-learning is not a necessary algorithmic approach for pre-miRNAs computational validation. In particular, machine learning algorithms can only confirm pre-miRNAs that look alike known ones, this being a limitation while exploring species with no known pre-miRNAs. The possibility to adapt the search to specific species, possibly characterized by specific properties of their miRNAs and pre-miRNAs, is a major feature of MIReNA. A parameter adjustment calibrates specificity and sensitivity in MIReNA, a key feature for predictive systems, which is not present in machine learning approaches. Comparison of MIReNA with miRDeep using deep sequencing data to predict miRNAs highlights a highly specific predictive power of MIReNA. Availability: At the address
INTRODUCTIONMicroRNAs (miRNAs) are a class of endogenes of 1825 nt in length and they occur in a precursor (pre-miRNA) with a * To whom correspondence should be addressed. characteristic hairpin secondary structure. miRNAs are involved in post-transcriptional regulation of protein-coding genes in animals and plants by sequence complementarity within the corresponding messenger RNA. Since the discoveries of lin-4 and let-7 () in Caenorhabditis elegans, the number of miRNA/pre-miRNA pairs found in miRBase (), the reference database collecting all known miRNAs from 115 species, has grown to more than 10000 (11488 in version 14.0). Experimental identification of novel miRNAs is difficult because they might be transcribed under specific conditions and cell types. Only the half (6166 out of 11488) of miRBase pre-miRNA/miRNA pairs have been experimentally validated. Several computational methods were developed to detect miRNAs in genomes (see, for a review). A first family of methods tests specific physical and geometrical characteristics of the associated pre-miRNAs (); these properties concern the hairpin structure of sequences that are similar to experimentally known pre-miRNA sequences. A second family is constituted by de novo methods that use thermodynamic stability of pre-miRNA hairpins and characteristic patterns of sequence conservation () to predict pre-miRNAs. To confirm premiRNA sequences and their structures, tools that are based either on machine-learning algorithms () or on ranking euclidean distances in a multidimensional space constructed from more than 30 parameters () have been developed. A third approach to miRNA prediction is based on deep sequencing data. A computational tool, named miRDeep, predicting pre-miRNA/miRNA pairs by combining experimental data to a Dicer processing model has been introduced (). We propose a new tool, named MIReNA, designed for answering several questions on miRNAs and pre-miRNAs. MIReNA searches for miRNAs and pre-miRNAs at genome scale, and computationally validates pre-miRNAs. It can be used in four different ways, depending on available data: known miRNAs, deep sequencing reads, potential miRNAs occurring in long sequences and putative pre-miRNAs containing potential miRNAs. It has been compared to four existing computational tools: MiPred () that classifies sequences from real or pseudo pre-miRNAs by using a random forest prediction model with combined features, miRabela () that uses an ab initio approach to identify clustered miRNAs based on the validation of pre-miRNAs by aPage: 2227 22262234
Finding microRNAs with high accuracymachine learning method, microPred (), a classifier system for real and pseudo pre-miRNAs that uses machine learning techniques, miRDeep () that predicts pre-miRNA/miRNA pairs from deep sequencing data.
THE ALGORITHMMIReNA is a search algorithm, which is designed for the prediction of miRNAs and pre-miRNAs. It can be used for a genome-wide miRNA or pre-miRNA discovery. To identify pre-miRNA/miRNA pairs, it explores a multidimensional space defined by only five (physical and combinatorial) parameters. These parameters characterize suitable pre-miRNA structures and allow the identification of a strikingly simple set of conditions that make MIReNA powerful at least as much as more sophisticated computational methods, such as machine learning algorithms, used to confirm pre-miRNA sequences ().
Five numerical criteria to describe a pre-miRNAWe call miRNA* the complementary sequence r * (possibly including unpaired nucleotides) of the miRNA r within a premiRNA structure. Given a pre-miRNA sequence s, the adjusted minimum folding energy (AMFE(s);) is computed as MFE(s) l(s) * 100, where MFE(s) stands for the minimum free energy of s () and l(s) is the length, i.e. the number of nucleotides, of s. The minimum free energy index (MFEI(s);) is computed as AMFE(s) %GC , where %GC stands for the percentage of G+C composition of s. A pre-miRNA secondary structure is defined to satisfy five main properties, the first three fixing the combinatorial structure of the pre-miRNA and the last two its physico-chemical characteristics:(I) a miRNA r cannot fold with itself within the pre-miRNA secondary structure;(II) the inequalities 0.83  l(r * ) l(r)  1.17 hold. To compute the thresholds, we considered the distance between r and r * to be defined as |l(r)l(r * )|/l(r), where l(r),l(r * ) are the lengths of r,r * , respectively. A distance close to zero implies a strong proximity of the sequences with a matching of essentially all nucleotides in r,r * ; larger distances imply a larger number of unpaired nucleotides between the sequences. By analyzing the distribution of distances between a miRNA and its miRNA* on the testing set, we estimated an acceptable distance to be <+, where , are mean and SD of the distribution. This corresponds to define an interval of acceptable ratios to be 1(+) and 1+(+), where a ratio = 1 corresponds to a matching between sequences of the same length. The testing set is defined by the 6166 experimentally verified miRNAs in miRBase (version 14.0, all 115 species confounded) from which pre-miRNA/miRNA pairs with the miRNA folding with itself or with the ratio l(r * )/l(r) > 3 were removed;(III) the percentage p(r) of unmatched nucleotides in r within the pre-miRNA secondary structure is  26% of l(r). This threshold corresponds to +, where , are mean and SD of the distribution of percentages computed on the testing set in II.(IV) the pre-miRNA sequence has AMFE 32. This threshold corresponds to +, where , are mean and SD of the distribution of AMFE values computed on the set of distinguished pre-miRNAs in miRBase containing an experimentally verified miRNA. pre-miRNA/miRNA pairs with the miRNA folding with itself or with the ratio l(r * )/l(r) > 3 were removed from miRBase;(V) the pre-miRNA sequence has MFEI < 0.85. This MFEI criterion was used in () to discriminate premiRNAs from other RNA sequences with high specificity. The threshold was found to sharply select only pre-miRNA sequences out of coding and non-coding RNA sequences. Criteria II and III ask r, r * to match almost completely: the lengths of r and r * are comparable by II, and a high percentage of matched nucleotides is demanded by III. The five numerical criteria are used to identify suitable pre-miRNA structures. They allow us to consider structures with multiple stems, which are not accepted as feasible by many known approaches like MiPred for instance (Supplementaryand d).
MIReNA algorithmMIReNA can handle four kinds of data, is characterized by specific pre-treatments of these data and predicts miRNAs and pre-miRNAs after using Criteria IV to filter the associated structures. It handles known miRNAs, deep sequencing data, potential miRNAs occurring in long sequences and putative pre-miRNAs containing potential miRNAs. The first two kinds of data are checked against full genome sequences. The first kind of large scale analysis takes into account a set of known miRNAs. Given a known miRNA, the algorithm searches for highly similar sequences in a genome. The outcoming sequences are potential miRNAs that are checked to have a suitable pre-miRNA structure surrounding them. The black path inillustrates the successive steps of the algorithm:
A.Mathelier and A.Carbone(1) it looks for sequences that are similar to the known miRNAs by minimizing the number of insertions, deletions and substitutions of nucleotides. Sequences obtained with this search are considered as potential miRNAs. An approximate string matching algorithm, i.e. an adaptation of (), extracts, for each genome position, the minimal (in length) suffix sequence of at most 25 nt in length that displays at most 15% of errors (by the Levenshtein distance; Levenshtein, 1966) with the original miRNA sequence;(2) the resulting sequences are extended on the left and on the right by 200 nt on each side;(3) for each sequence extension obtained in Step 2, we compute secondary structures of all subsequences containing the potential miRNA. To produce secondary structures, we used an adapted implementation of RNAfold ();(4) all structures obtained in Step 3 are scanned to filter out those that do not satisfy numerical Criteria IV above. The remaining structures are considered as putative pre-miRNAs. (Notice that the sequences that we retain are at least 60-nt long.);(5) we consider all potential miRNAs that are included in putative pre-miRNA sequences validated in(6) (this step is optional) the resulting pre-miRNAs are filtered and either repeated sequences (RepeatMasker is used for this), or sequences that are not overlapping deep sequencing reads, or sequences that are not overlapping expressed sequence tags (ESTs) are discarded.(7) (this step is optional) the resulting pre-miRNAs coming from either Step 5 or 6 are filtered using genomic information. Pre-miRNAs overlapping CoDing Sequences (CDS), scRNA, snRNA, snoRNA, tRNA, rRNA and 21U-RNA sequences on either strains are discarded.The second kind of large scale analysis considers deep sequencing data (red path in). Following the same approach introduced in miRDeep (), we map deep sequencing reads on the genome and identify clustered regions of reads (at most 30 nt away) by discarding those which are >140 nt. Such sequences are considered as putative pre-miRNAs and all reads contained in them are taken as potential miRNAs. Secondary structures of putative pre-miRNAs are constructed using RNAfold. Step 4 above is run. It is followed by a step that filters precursors satisfying a Dicer processing condition and at least one condition among three concerning reads mapping the precursor. Among several miRNAs within the same precursor, we select the one which is most represented by reads. The screening based on genomic information might also be run. MIReNA can realize Step 4 alone to check whether a putative premiRNA including a potential miRNA satisfies Criteria IV (brown path in). Finally, it can predict pre-miRNAs included in sequences of about 400 nt in length by starting from a potential miRNA in each sequence. This is done by running Steps 3 and 4 (blue path in).
RESULTSMIReNA has been tested in several manners. To validate Criteria IV, we fully varied the corresponding thresholds, we evaluated different combinations of these criteria and we compared IV to MiRfold criteria (). MIReNA performance in the validation of pre-miRNAs (brown path in) has been evaluated against three predictive systems, miR-abela, MiPred and microPred. MIReNA predictive power on deep sequencing data (red path in) was compared to miRDeep. MIReNA was used to predict miRNAs and pre-miRNAs on six different species (black path in) starting from known miRNAs in miRBase.
Validation of Criteria IVMIReNA has been validated on several datasets of known pre-miRNA structures coming from the phylogenetically distant genomes of Arabidopsis thaliana, C.elegans, Homo sapiens, Oryza sativa and Rattus norvegicus. To demonstrate that the method confirms sequences as pre-miRNAs and does it with good specificity and sensitivity, we traced the receiver operating characteristic (ROC) curves on the datasets for the five different species varying systematically parameters. We studied ROC curves by varying all five criteria (seeand c, and Supplementary, c, e, g, i, k, m and o), by fixing the combinatorial Criteria IIII and by varying the physico-chemical Criteria IV and V (seeand d, and Supplementary, d, f, h, j, l, n and p), and by varying criteria IIII without considering Criteria IV and V (Supplementary). When using one criteria at the time, Criteria V is the one
Finding microRNAs with high accuracythat provides best predictions and for this, we checked whether the coupling with the other criteria could improve its strength or not (seeand c, Supplementary, c, e, g, i, k, m and o and Supplementary). For all species, we used single and multiple stems datasets. MIReNA's ROC curves show a successful discrimination of real pre-miRNAs from pseudo ones on H.sapiens (d), O.sativa, C.elegans, A.thaliana and R.norvegicus (Supplementary). MIReNA's ROC curves approximate well with the maximal performance point [i.e. the top left corner in the plots, corresponding to an ideal curve passing through it and characterizing 100% of the area under the curve (AUC), or equivalently a 100% sensitivity and 100% specificity] as shown in Supplementary Table 1, where different numerical criteria provide a AUC >97% on all species. AUC, accuracy (Acc) and Mathew's correlation coefficient (MCC) values reported in Supplementarycorrespond to the ROC curve with best MCC value. These curves are plot inand c and Supplementary, c, e, g, i, k, m and o. By varying Criteria IVV and letting fixed IIII, we observe that best ROC curves are comparable with those obtained by varying IV (seeand Supplementary). Essentially, the same AUC values are obtained by different combinations of numerical criteria, but slightly improved Acc and MCC values are identified when the five criteria are considered all together, both for single and multiple stems validation. We explicitly measured the predictive power of Criteria V by ignoring the other criteria and letting V to vary. While best AUC values are reached by considering V alone, best Acc and MCC values are obtained with the combination of all criteria (see Supplementary). As expected, by varying combinatorial Criteria IIII and ignoring physico-chemical properties IV and V, ROC curves show a much lower discrimination power (see Supplementary). MIReNA's ROC curves are stable for a large interval of AMFE values: curves computed for AMFE 20 overlap each other and for AMFE 30 the signal starts to degrade with a loss of sensitivity (and an improved specificity). This stability is an important feature for a user since it simplifies considerably parameterization. Seeand d, and Supplementary, d, f, h, j, l, n and p, where the AUC of MIReNA's ROC curves shows to be consistently excellent, varying on a range between 96% and 100% for both single and multiple stems predictions (Supplementary). We tested whether MiRfold's two criteria (), which are close to our Criteria III, IV and V, could provide good parameters to discriminate putative pre-miRNAs or not. MiRfold takes an miRNA sequence and looks for two extensions, downstream and upstream of the miRNA, having an optimal folding. Among all different possible extensions, MiRfold selects the one that minimizes a penalty score on miRNA/miRNA* matching and the MFE of the secondary structure. The first condition is an analog of our combinatorial Criterion III, where we include a dependence on the miRNA length though. The second condition is an analogue of our physico-chemical Criteria IV and V where we take into account the pre-miRNA length (IV) and the pre-miRNA GCcomposition (V). We computed ROC curves by varying the two MiRfold's criteria on the multiple stems positive and negative datasets constructed on H.sapiens, O.sativa, C.elegans, A.thaliana and R.norvegicus. Results obtained with MIReNA and with MiRfold criteria are very different (Supplementary). MIReNA ROC curves upper bound ROC curves on MiRfold criteria in all datasets,Top: MiPred dataset (); results reported for MIReNA correspond to best MCC in the ROC curve analysis for H.sapiens (Supplementary). Bottom: Predictions realized on datasets of secondary structures with single (left) and multiple (right) stems. Results reported for MIReNA correspond to best MCC in ROC curves analysis obtained by varying Criteria IV (see Supplementary). Bold values are the highest in a column. and show prediction stability over a large parameter range (this corresponds to the overlapping of ROC curves) contrary to ROC curves corresponding to MiRfold criteria. We conclude that MiRfold criteria are not optimal for pre-miRNA discrimination. Notice that no use of MiRfold software was made but that only the two MiRfold criteria were tested.
Comparison with other predictive toolsMIReNA has been compared to MiPred, microPred and miR-abela on two distinct datasets. The first dataset is the testing dataset used infrom H.sapiens. It is composed by a positive and a negative set of pre-miRNAs and pseudo pre-miRNAs where miRNAs positions are not specified. For comparison, we do not use any information coming from known miRNAs in miRBase, but merely test MIReNA on the brown path in. The second dataset is composed by five negative and positive sets from five different species (including sets for H.sapiens that are different from the ones defining the first dataset). Positive sets have been constructed from species-specific precursors in miRBase and the negative ones from CDS sequences coming from the corresponding genomes.
Comparison with MiPredMiPred is a classifier that discriminates real single stem pre-miRNAs from pseudo ones (). It is based on a Random Forest machine learning method using more than 30 pre-miRNA features. On the first dataset, MiPred obtains better specificity results, while best sensitivity, Acc and MCC are obtained by MIReNA (MIReNA is used to predict multiple stems miRNA precursors using deep sequencing reads as potential miRNAs. We report: number of predicted precursors (3rd column), sensitivity (4th), signal-to-noise ratio (5th), number of specific (that is, captured by one method but missed by the other) miRNAs in miRbase version 14.0 (6th), total number of new predicted precursors (7th) and number of new specific predicted precursors (8th). An exact match with the miRNA in miRbase or with a read is required for the results in the last three columns. Results were obtained by using thresholds on Criteria IV computed on the C.elegans and on the H.sapiens ROC curves (for multiple stems) displaying best MCC (and Supplementary). second dataset, MIReNA performs slightly better than MiPred for all species when looking at Acc and MCC values (, bottom and Supplementary, computed by varying Criteria IV). In conclusion, MIReNA obtains as good results as MiPred, or better, and simplifies in an essential manner the searching space, reducing it to 5 parameters instead of 30. It can be applied to larger sets of pre-miRNAs possibly presenting multiple stems.
A.Mathelier and A.Carbone
Comparison with microPredmicroPred is a classifier system used to discriminate pre-miRNAs from other non-coding RNAs by using machine learning techniques (). The comparison between microPred and MIReNA has been made on single and multiple stems datasets (and Supplementary). MIReNA obtains a slightly lower sensitivity but much higher specificity, Acc and MCC values than microPred for four species. For A.thaliana, MIReNA outperforms microPred.
Comparison with miR-abelamiR-abela identifies clustered miRNAs by searching for pre-miRNAs (). It uses a machine learning method to computationally validate the premiRNAs. Sensitivity, Acc and MCC are higher for MIReNA on both testing datasets (and Supplementary), with a lower specificity, making MIReNA a better classifier to discriminate pre-miRNAs from pseudo ones.
miRNA discovery from deep sequencing dataMIReNA can be applied to deep sequencing datasets (red path in). It has been compared to miRDeep on C.elegans and H.sapiens deep sequencing data (). MIReNA provides a slightly lower number of predictions with a lower sensitivity against a higher signal-to-noise ratio than miRDeep. The two tools appear complementary due to an important set of specific predictions revealed on the analysis of both. The first time to select clusters of reads providing precursors as done in. The second time when filtering premiRNA/miRNA pairs that respect the Dicer processing. Intuitively, given a pre-miRNA/miRNA pair, we expect reads to overlap the miRNA, the miRNA* and the remaining hairpin loop (i.e. the sequence between the end of the miRNA and the beginning of the miRNA*) without having too many reads overlapping two of these regions. This idea is present in. A main difference between MIReNA and miRDeep is the selection of the potential miRNA at the beginning of the algorithm (second box in red path of) that for MIReNA is less restrictive. We accept pre-miRNA/miRNA pairs where each miRNA matches a read in the dataset, while miRDeep only considers those pairs where the miRNA is most represented by reads matching the pre-miRNA. This means that for the same pre-miRNA, MIReNA may consider several pre-miRNA/miRNA pairs satisfying Criteria IV, whereas miRDeep considers only one pair. However, notice that our Criteria IIII (depending on the length of the miRNA) turn out to be more restrictive than those used by miRDeep (based on fixed thresholds) to accept a miRNA in a pre-miRNA. Another main difference between MIReNA and miRDeep is in the second filtering step of MIReNA (fourth box in red path of). MIReNA considers the same ideas used in miRDeep but encodes them in a set of combinatorial rules instead of defining a probabilistic model.
Predictive miRNA analysis with MIReNAMIReNA has been applied to discover miRNAs and pre-miRNAs in species already known to contain miRNAs and in species where their existence could be verified experimentally after prediction. An exploratory analysis was done on six eukaryotic species. Two of them, A.thaliana and C.elegans, are multicellular and contain experimentally known miRNAs. The remaining four, the two diatoms Thalassiosira pseudonana and Phaeodactylum tricornutum, and the two yeasts Schizosaccharomyces pombe and Saccharomyces cerevisiae, are unicellular organisms not known to contain any miRNA. Based on miRBase, a dataset of known miRNAs from multicellular species, MIReNA predicts similar miRNA sequences whose associated pre-miRNA structures satisfy necessary structural conditions and whose pre-miRNA sequences are required not to have low complexity (by RepeatMasker). Secondary structures of predicted pre-miRNAs might display multiple stems (Supplementary). MIReNA finds potential miRNAs for all six studied organisms (, 3rd column). When considering EST data, all species contain potential miRNAs whose pre-miRNA sequences match some EST (with the exception of yeast species having no EST match lying in intergenic regions (). Among the 1842 (respectively 621) predicted pre-miRNA/miRNA pairs of C.elegans (respectively A.thaliana), 1392 (respectively 370) are similar in sequence to known miRNAs whose hairpin sequences Page: 2231 22262234MIReNA identification of pre-miRNA/miRNA pairs with miRNA sequences similar (but not necessarily identical) to miRNAs in miRBase. The number of known premiRNAs belonging to miRBase is given after the species name. The number of premiRNA/miRNA pairs that do not overlap CDS, scRNA, snRNA, snoRNA, tRNA, rRNA and 21U-RNA sequences on either strands is reported (2nd column; all columns named 'filter' identify a screening based on genomic information). For T. pseudonana and P. tricornutum, we check overlapping with CDSs (the only information available). A second filter of all pre-miRNA/miRNA pairs is realized with RepeatMasker (3rd), EST sequences (4th) and deep sequencing data (6th) and validation of putative pre-miRNAs is done by matching an EST to the pre-miRNA or a read to the miRNA. A number of new pre-miRNA/miRNA pairs, not contained in miRBase, are predicted from ESTs or deep sequencing data after filtering ('new').
Finding microRNAs with high accuracyare not classified within the family classification of miRBase. Of these 1392 (respectively 370) sequences, 718 (respectively 119) are similar to already known miRNAs from C.elegans (respectively A.thaliana). This means that there exists a large number of miRNA paralogs whose hairpin sequences have not been yet classified within miRBase. Multicellular species contain potential miRNAs that match deep sequencing reads. MIReNA highlights that new expressed premiRNAs may exist (, 5th and 7th columns). The associated miRNAs are similar and not necessarily identical to known miRNAs in miRBase (possibly identified for other species). This pool of pre-miRNA/miRNA constitutes a set of new predictions, since the miRNA is not a known miRNA for the species.
METHODS
Genomic data and datasetsGenomes flat files for A.thaliana, S.cerevisiae, S.pombe, H.sapiens, R.norvegicus and O.sativa were retrieved from the NCBI site http://www.ncbi.nlm.nih.gov/genomes/, for C.elegans from the WormBase site http://www.wormbase.org, for P.tricornutum and T.pseudonana from the JGI site http://genome.jgi-psf.org. The corresponding assembling versions are listed in Supplementary Table 3. Known miRNA sequences and their genome location were downloaded from version 14.0 of miRBase (http://microrna.sanger.ac.uk/sequences/ftp.shtml). miRBase () was used as a reference dataset to define thresholds and to construct testing sets of premiRNA/miRNA pairs. It declares a miRNA to be experimentally validated or computationally predicted by coupling it with a specific pre-miRNA. In miRBase, there are miRNAs within a species that have been validated for several different pre-miRNAs, and there are several pre-miRNAs that validate several miRNAs contained in their sequence. Out of this list of 11 488 miRNA/pre-miRNA pairs, 6166 concern experimentally validated miRNAs and 5322 concern computationally predicted miRNAs. Among the 6166 experimentally validated pairs, 5471 present different pre-miRNA sequences; among the 5322 computationally predicted pairs, 4406 have different pre-miRNA sequences. Thresholds in MIReNA were computed using experimentally validated pre-miRNA/miRNA pairs in miRBase only. We constructed several datasets on the five species H.sapiens, A.thaliana, C.elegans, O.sativa and R.norvegicus following the generation method proposed in. The five datasets have been used to compare MIReNA to available tools (and Supplementary). Each dataset is constituted by two sets of sequences, a positive one, made of experimentally validated and computationally predicted pre-miRNA sequences in miRBase, and a negative one, made from coding sequences, that is extracted from concatenated CDS of the corresponding species. Positive and negative sets are composed of pre-miRNAs and pre-miRNAslike sequences, i.e. sequences validating four conditions on: (i) sequence length; (ii) minimum number of basis paired on the stem of the hairpin structure; (iii) MFE of the sequence structure; and (iv) hairpin structure, made of a single stem. These four conditions have been previously used in MiPred. Sets contain from a minimum of 71 to a maximum of 660 hairpin structures characterized by a single stem. Positive and negative datasets are referred to as 'single stem datasets' in the text. We were interested to study hairpin structures with several stems too and generated for each species negative datasets accepting hairpins, following the same generation approach as in. Corresponding positive datasets contain all known premiRNAs (from 173 to 717), for the considered species, in miRBase, and no filtering with conditions (iiv) above has been applied. We refer to these positive and negative datasets as 'multiple stems datasets'. The testing dataset described inwas used to compute(top): 263 positive sequences are human miRNAs and 265 negatives are issued from CDS sequences as described above.
ROC curvesROC curves are plot on datasets from five species by varying values of MIReNA parameters and MiRfold criteria. MIReNA's pre-miRNAs validations from the datasets were computed using the five criteria introduced above. As no potential miRNA is determined for pre-miRNAs in the datasets, we say that a pre-miRNA validates Criteria I, II and III if it includes a subsequence (i.e. a potential miRNA) of 1825 nt in length that ensures the corresponding thresholds. MIReNA's ROC curves were computed for different combinations of Criteria IV. Also, ROC curves have been plot based on MiRfold two criteria: a penalty score counting the number of mismatches between miRNA and miRNA*, and the MFE.
Computational tools used for comparisonPage: 2232 22262234
A.Mathelier and A.CarboneThis adaption of the code concerns Step 4 in the algorithm (). RNAfold is found at http://www.tbi.univie.ac.at/RNA/. Default parameters of RNAfold were used. RepeatMasker [A.F.A.RepeatMasker unpublished data] has been used as a filter to remove sequences containing repeats. We used version open-3.2.8 with RMLib: 20090604 (http://www.repeatmasker .org/cgi-bin/WEBRepeatMasker) and crossmatch as search engine with a slow speed. Repeat sequences used by RepeatMasker are stored in the Repbase database ().
Deep sequencing data and their mappingThe two sets of reads used to compare MIReNA and miRDeep are constructed following. The first puts together two 454 deep sequencing C.elegans datasets of GEO database at NCBI, and the second puts together two Solexa and one 454 deep sequencing H.sapiens datasets of GEO database at NCBI (see Supplementary Table 4 for accession numbers). Putative pre-miRNAs were constructed by using scripts fromrealizing the excision of clusters of reads. To compute sensitivity of the two systems, we considered miRNAs in miRBase version 14.0. This version of miRBase contains 13 C.elegans and 9 H.sapiens miRNAs predicted by miRDeep in, which were not contained in miRBase version 10.0 used in. Sensitivity is computed as the ratio between the number of species-specific miRNAs of miRBase contained in predicted precursors and the number of speciesspecific miRNAs in miRBase matching deep sequencing reads (a match allows for mismatching in the last three nucleotides of miRNAs). Specificity cannot be directly computed because of the impossibility to directly evaluate false positives. This value can be estimated, following, by generating a set of pre-miRNAs together with positions of mapped reads. To do so, we start from the set of putative pre-miRNAs where positions of mapped reads are identified and shuffle the association between the set of pre-miRNAs and the set of configurations of read positions. We obtain a set of negative pre-miRNAs on which the algorithm is tested and the number of false positives is computed. This is done 100 times and a distribution of the number of false positives is considered. The signal-to-noise ratio is N/ FP : 1 where  FP is the mean of the distribution and N the number of predictions obtained with MIReNA or miRDeep. The mapping of a read is done asking for 100% of identity over the full length of the read, for all deep sequencing datasets, using megablast (with options-W12-p100). A read is considered only when it perfectly maps  5 locations in the genome. The only exception is done with the H.sapiens dataset GSE10829 due to our comparison with miRDeep: given a read, a mapping of the read to possibly several sites in the genome, is constructed by asking that the first 18 nucleotides of the read perfectly align with the genomic sequence and by extending the alignment on the 3-end until the first mismatch is found. Accepted matches are those with maximal length. There might be several of them and reads with more than five matches are discarded. The red path in the algorithm asks for a filtering step for precursors that is based on a Dicer processing condition. Following, we define a Dicer processing signature for a pre-miRNA/miRNA pair to be as follows: a read has to map with the potential miRNA of the pair, or its corresponding miRNA* or the remaining hairpin loop. The alignment can extend the miRNA or the miRNA* on the 5-end by at most 2 nt and the 3-end by at most 5 nt. Among the reads mapping the precursor, we ask at least the 90% of them to satisfy the signature. Pre-miRNA/miRNA pairs satisfying the Dicer processing condition should also satisfy at least one of the following conditions: (i) the miRNA* is mapped by a read where the alignment can extend the miRNA* on the 5-end by at most 1 nt and the 3-end by at most 5 nt; (ii) the miRNA sequence should be matched by at least two reads (where the alignment can extend the miRNA on the 5-end by at most 2 nt and the 3-end by at most 5 nt) and within nucleotide 28 from the 5-end should match nucleotides 28 of a known miRNA in miRBase (miRNAs for metazoan are considered with the exception of the species under consideration); (iii) the different pre-miRNA subsequences mapped by reads that satisfy the Dicer processing condition should be at least 3 (4) for C.elegans (H.sapiens). The threshold 3 (4) has been statistically evaluated by mapping reads on the C.elegans (H.sapiens) pre-miRNAs in miRBase, by retaining only those pre-miRNAs that do not satisfy conditions (i) and (ii), and by computing the mean of the number of different pre-miRNA subsequences mapped by reads that satisfy the Dicer processing condition. Conditions (iiii) are inspired by the criteria used into define a probabilistic scoring. In, to filter MIReNA miRNA predictions we used deep sequencing data (see Supplementaryfor GEO accession numbers).
Pre-miRNAs filtering using ESTs or readsIn columns 45 of, we filtered MIReNA predicted pre-miRNA sequences against the EST database dbEST of the studied species () by using BLAST (http://blast.ncbi.nlm.nih.gov/) with default parameters: a pre-miRNA sequence matches an EST when at least 80% of similarity on at least 80% of the sequence with an e-value <= 1e 30 are present. In columns 67 of, miRNA predictions from deep sequencing data are obtained starting from pre-miRNA/miRNA pairs where the miRNA is similar to a known miRNA in miRBase, and by filtering out those miRNAs that do not match a read. For the matching of the read, we ask for 100% identity on the miRNA length.
Prediction system assessmentTo properly evaluate MIReNA performance, we rely on the following quantities: the number of known pre-miRNAs correctly predicted (true positives, TP), the number of pseudo pre-miRNAs correctly predicted (true negatives, TN), the number of pseudo pre-miRNAs incorrectly predicted as pre-miRNAs (false positives, FP) and the number of known pre-miRNAs incorrectly predicted as pseudo pre-miRNAs (false negatives, FN). We use four standard measures of performance: Specificity (Spe = TN TN+FP ), Sensitivity (Sen = TP TP+FN ), Acc (Acc =) ().
ImplementationMIReNA package is written in bash, C, perl, python, and it is available at http://www.ihes.fr/carbone/data8/. Parameters are described in Supplementary Material and in the help file by typing './MIReNA.sh-h'.
DISCUSSIONMIReNA is a platform that helps to test new hypothesis on miRNAs and pre-miRNA structures. Across organisms, it might be that the characteristic length of miRNA sequences might vary slightly and a tool like MIReNA, allowing for length calibration, can help in silico investigation of the existence of miRNA sequences with nonstandard properties. Similar considerations might be extended to unusual characteristics of pre-miRNA structures as hairpin multiple branching, contrary to what has been usually assumed (). Experimentally validated multiple branched pre-miRNAs exist (Supplementary) and in miRBase, they constitute the 10% (671 over 6166) of experimentally validated pre-miRNAs. Many other properties of miRNAs and pre-miRNAs can be fine-tuned in MIReNA giving the opportunity to the biologist to perform an in silico identification of miRNA sequences (possibly with non-standard features) in experimentally unexplored genomes. MIReNA does not search for structurally similar pre-miRNAs. In consequence, its results are different from those obtained by mostPage: 2233 22262234
Finding microRNAs with high accuracymethods (), and in particular from those based on secondary structure conservation (). One should expect MIReNA to detect pre-miRNAs that cannot be predicted by other approaches. (, analysis in Supplementary Material.) MIReNA handles experimental data and can check the compatibility of its predictions against EST data and deep sequencing data. Deep sequencing data can be used in two distinct manners. MIReNA can check either that predictions from miRNAs in miRBase are matched by reads, or it can directly employ reads to predict pre-miRNA/miRNA pairs, as previously done in miRDeep. MIReNA and miRDeep provide a large core of common predictions but also specific ones. MIReNA appears to have a signal-to-noise ratio higher than miRDeep and its specific predictions highly support experimental validation. The exploratory analysis done on six eukaryotic species highlights the existence of pre-miRNA/miRNA pairs for all species when a purely genomic prediction filtered with RepeatMasker is realized (, 3rd column). On the other hand, when ESTs are taken into account, miRNAs are predicted only for multicellular species and for diatoms (, 4th column). The number of premiRNA/miRNA pairs is much smaller for unicellular species than for multicellular ones, and this difference is consistent with the observed correlation between expansion of sets of miRNAs and morphological complexity of the organisms (). The few miRNAs found for diatoms suggest diatoms miRNAs to have specific characteristics and be different from those observed up to now, their detection demanding different parameterizations. The existence of RNA interference (RNAi) in diatoms has been indirectly proven by using a putative silencing machinery; several enzymes have been proposed to participate in silencing but the identification of miRNAs is still undergoing (). MIReNA found no pre-miRNA in yeasts (after filtering with EST data) in agreement with the absence of RNAi machinery. miRNAs have never been reported for fungi and are absent in S.pombe, which has known RNA silencing mechanisms (). The gene silencing pathway of RNAi was estimated to have recently being lost in S.cerevisiae, where reintroducing Dicer and argonaute restores RNAi (). The finding of eight potential miRNAs in S.cerevisiae from genomic analysis (, 3rd column) is not in contradiction with the loss of the RNAi machinery but might suggest the existence of an ongoing process of hairpin deletion. EST sequences and deep sequencing data depend on specific experimental conditions and pre-miRNAs predictions filtered or computed from these data capture only partially miRNAs expressed in the cell. Their exploration allows us to predict new miRNAs (Tables 2 and 3) though and parameterizable tools like MIReNA open a way to miRNA discovery in organisms where miRNA characteristics are yet unknown. MIReNA answers to several questions addressed by available tools, it performs at least as well as these tools and in most cases better than those, displaying very good sensitivity, specificity and Acc. The biologist can use it as a platform to check several questions around miRNAs and pre-miRNAs prediction starting from different kinds of available information (computationally and experimentally validated miRNAs, or deep sequencing data) and can play with sensitivity and specificity by using parameters variability.
at :: on August 31, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
MIReNA was compared to different existing tools. MiPred (Jiang et al., 2007) implementation was provided to us by the authors (personal communication). We used miR-abela (with default parameters) at http://www.mirz.unibas.ch/cgi/pred_miRNA_genes.cgi, microPred at http://www.comlab.ox.ac.uk/microPred/microPred-server.html. miRDeep was downloaded at http://www.mdc-berlin.de/en/research/research_teams/ systems_biology_of_gene_regulatory_elements/projects/miRDeep/ 4.4 Computational tools used for MIReNA The computation of secondary structures is realized with the RNAfold program of the Vienna RNA package (Hofacher et al., 1994) by minimizing the free energy of the structure. We modified the source code of RNAfold to avoid the sequential computation of all possible subsequences, and directly compute the secondary structure of the whole sequence and retrieve the minimum free energy structure of all sub-sequences of it by backtracking.
