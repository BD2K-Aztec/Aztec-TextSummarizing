Motivation: The role of personalized medicine and target treatment in the clinical management of cancer patients has become increasingly important in recent years. This has made the task of precise histological substratification of cancers crucial. Increasingly, genomic data are being seen as a valuable classifier. Specifically, copy number alteration (CNA) profiles generated by next-generation sequencing (NGS) can become a determinant for tumours subtyping. The principle purpose of this study is to devise a model with good prediction capability for the tumours histological subtypes as a function of both the patients covariates and their genome-wide CNA profiles from NGS data. Results: We investigate a logistic regression for modelling tumour histological subtypes as a function of the patients' covariates and their CNA profiles, in a mixed model framework. The covariates, such as age and gender, are considered as fixed predictors and the genome-wide CNA profiles are considered as random predictors. We illustrate the application of this model in lung and oral cancer datasets, and the results indicate that the tumour histological subtypes can be modelled with a good fit. Our cross-validation indicates that the logistic regression exhibits the best prediction relative to other classification methods we considered in this study. The model also exhibits the best agreement in the prediction between smooth-segmented and circular binary-segmented CNA profiles. Availability and implementation: An R package to run a logistic regression is available in
IntroductionNext-generation sequencing (NGS) technology has greatly transformed our way of interrogating genomes and advanced our understanding of genomic changes such as copy number alterations (CNAs). We have previously shown that CNA data can be generated from routine diagnostic biopsy specimens in a very efficient manner using multiplexed, low-coverage sequencing () and developed a robust algorithm to analyse these data in individual patients (). Our objective in this current study is to analyse multiple samples from two tumour subtypessimultaneously and develop informatic techniques to separate them using their CNA profiles, so that subsequent patients could be better stratified in a predictive manner. Currently, methods for studying groups of CNA profiles tend to focus on looking for similarities in a homogeneous group of samples () or to look for regions of the genome where two groups of samples are very different (). We are focusing less on the genomic regions involved, and more on the problem of separating similar groups of samples and predicting to which group a new sample belongs. More specifically, our focus is in utilizing the whole (genome-wide) CNA profiles to stratify tumour subtypes, in addition to other covariates or patients characteristics. This strategy enables us to have a wider picture of the contribution of each genomic region in the stratification, in light of the contribution of the other regions. To model the tumour subtypes, we investigate logistic regression within a random effects model framework, where the contributions of patients' clinical characteristics are considered as fixed effects and those of the CNA profiles are considered as random effects. Because our interest is in the prediction of tumour subtypes of new samples, we perform a cross-validation to identify the prediction error of the model. We compare this prediction error with those from other classification methods. As a test dataset, we have analysed a cohort of lung tumours, all of which are from the two closely related subtypes, squamous cell carcinoma (SCC) and adenocarcinoma (ADC). Until recently these have been treated as part of the larger subgroup non-small cell lung carcinoma (NSCLC), but there is growing evidence that the two groups should be treated as separate diseases (). As a validation dataset, we analysed another cohort of two related tumour subtypes, oral squamous cell carcinoma (OSCC) and oral verrucous carcinoma (OVC). These subtypes have very different prognoses and clinical management, but there can be histological uncertainty in distinguishing between them (). The results of our analysis indicate that the logistic regression enables us to stratify tumour subtypes and investigate genome-wide contribution of each genomic region to the stratification. The results also indicate that the logistic regression has good predictive value for new samples: advantageously, this prediction is achieved regardless of the segmentation methods involved in the estimation of CNA. The latter advantage is important because a number of tools exist to obtain CNA estimates from NGS data, and they use a variety of pre-processing steps, such as normalization, and a number of different segmentation methods. Before we discuss those results, we discuss first the logistic regression in the next section.
Methods
Patients, sequence data and alignmentsSeventy-six lung cancer patients were included in this study from Leeds Teaching Hospital (UK), comprising of two groups: squamous carcinoma (38 patients) and ADC (38 patients). We recorded the patients' clinical characteristics, but in this study we only consider age and gender as covariates. For a validation of our methods, samples from 102 oral cancer patients were collected from Leeds Teaching Hospitals (UK), Queen Victoria Hospital (Sussex, UK), University of Torino (Italy) and the National Guard Hospital (Saudi Arabia), comprising of 45 OSCC samples and 57 OVC samples. Unfortunately, for this cohort of patients, we could not obtain the patients' clinical characteristics, and only work with their CNA profiles. The main body of this manuscript will deal largely with the lung cancer dataset. The experimental validation using the oral cancer dataset will mainly be presented in the Supplementary Material. Details on sample preparation, DNA extraction and library preparation are described by. Sequences were aligned using the bwa suite version 0.5.9-r16 () against assembly hg19 of the human genome. Only sequences that could be uniquely aligned and with mapping quality !37 were used.
Normalization and CNA estimateThe CNA profile from each lung tumour is calculated by 'depth of coverage' from their sequences. For this purpose, the optimal window size for this group of samples is estimated using NGSoptwin package to be 150 kb (). The sequence data from 76 cancer patients are not directly comparable because inevitably the tumour samples are contaminated with normal cells by different degrees. To deal with this problem, we performed a normalization using the CNAnorm packageto obtain the CNA estimates. An example of CNA estimates is presented infor patient LS67, which can be in two forms depending on the segmentation method used: 1. Smooth estimate, where CNA is estimated as smooth segmented lines (). The main characteristic of the estimate is that the segmented line is smooth and follows the sudden 'jumps' and 'drops' in the CNA profile. This is illustrated in the top row of. 2. DNACopy estimate, where CNA is estimated as circular binary segmented lines (). The main characteristic of the estimate is that the segmented line tends to form relatively long constant segments. This is illustrated in the bottom row of.With 150 kb window size, we approximately have slightly more than 20 000 windows to cover the whole genome. In this study, we exclude the CNA estimates from the sex chromosomes and the centromere regions, where some missing values can be problematic in the analysis. After we remove them, we have CNA estimates from 17 571 genomic windows in two different forms as described earlier. For each form of CNA estimate, the CNA profiles from the patients are summarized in a matrix of size 76 by 17 571.
Logistic regressionAt this stage, our data consist of three components: (i) the binary tumour histological subtype (squamous carcinoma  1, ADC  0),(ii) age and gender as covariates and (iii) the CNA estimates across 17 571 genomic windows. To model the binary histological subtype, logistic regression is a natural choice because we can extend the standard model to deal with the second type of predictors namely CNA profiles. One of the immediate challenges dealing with this type of data is the dimension of the CNA profiles. We have a data matrix of size n  q where 76  n ( q  17 571. A standard logistic regression will fail in the computation because the number of variables far exceeds the number of observations. To proceed, we extend the standard model by assuming that the parameters of CNA to follow a Normal distribution. Specifically, in vector notation, consider y as a vector of binary tumour histology with y i  1 if the tumour is squamous carcinoma and y i  0 if the tumour is ADC, for i  1; 2;. .. ; n. We assume that y follow a Binomial(1,l) distribution with l is the probability of the tumour being squamous carcinoma. In logistic regression, we model hl  Xb  Zcwhere h is a logit link function that applies elementwise, X is a matrix of fixed covariates of size n  p, b is a P-vector of fixed effects for matrix X, Z is matrix of CNA estimates of size n  q, and c is a q-vector of random effects for matrix Z. We assume that c j , j  1;. .. ; q would follow a Normal(0,s 2 ) distribution. The joint log likelihood of the parameters is given by log L b; c;where pyjc is the likelihood based on conditional distribution of y given c, and pc is the likelihood based on the Normal distribution of random effects c. Given the data y 1 ; y 2 ;. .. ; y n , the log likelihood is given by logL b; c;where l i is a logistic function of b and c, and k  1 s 2 .
Estimation of b and c at fixed kThe estimation of b and c in (3) can be performed using iterative weighted least squares (IWLSs) at a fixed value of k. At a fixed value of k and starting values of b 0 and c 0 , IWLS is performed to find the solution of mixed model equationwhere ' 0 ' denotes transpose,is the working vector, R is a diagonal matrix withwhere I q is an identity matrix of size q. Specifically, in the m-th iteration, 1. update the working vector Y m and R m based on b m1 and c m1 2. calculate c m  Zwhere in steps (2) and (3) we use the current values of R and Y. We iterate the above steps until convergence and, at convergence, we obtain the estimates ^ b and ^ c. The dimension of matrix Z 0 R 1 Z  D 1  is in the order of 17 571  17 571 so that its inversion is a computational bottle neck in the iteration. To overcome this problem, we use a computational modification that are discussed further in Section 2.4. The approximate standard errors for ^ b and ^ c are given by the square root of the diagonal ofrespectively, where S  R  s 2 ZZ 0 .
Estimation of s 2 given b and cWe estimate b and c above at a given value of s 2 , and s 2 can be estimated as the one that minimizes Akaike's Information Criterion (AIC) or through cross-validation. The calculation of AIC in practice is described further in Section 2.4.
Computational considerationThe size of the matrix Z 0 R 1 Z  D 1  involved in the above computation is in the order of 17 571  17 571. To reduce the computational burden, we consider a modification of the computation to find the solution of the above estimation problem. We can overcome this problem by representing the matrix Z (of size n  q) as a multiplication of special matrices in singular value decomposition (SVD) (). Let us definewhere U and Q are of size n  n, and V is of size q  n, such that U 0 U  I n ; V 0 V  I n (but VV 0 6  I q ), and Q is a diagonal matrix of singular values of Z. Using this decomposition, the relevant part in 4 can be rewritten aswhere c  Vc . Based on this representation, the updating equation in step (2) in the above iteration gives an update for c  (hence also c), and at convergence we obtain the estimates ^ b and ^ c (via ^ c  ). The SVD is only done once before IWLS, as the quantities that are updated in the above iteration are only Y m ; R m ; b m and c m (via c m ). With this representation, the dimension of the matrix inversion reduces dramatically from q  q to a manageable n  n. In the estimation of s 2 (Section 2.3.2), we minimize the AIC AIC  2log L^ l  2df whereand ^ l is calculated in a logistic function using ^ b and ^ c (via ^ c  ). The degrees of freedom is computed as df  trace UQ 0 R 1 UQ  kI   1 UQ 0 R 1 UQ  kI   n o ().
Cross-validationIn building a logistic regression to model tumour histology, we wanted to consider how well the model can be employed to makeStratifying tumour subtypes based on CNA profilesprediction of new observations. To obtain the prediction of the histology based on the CNA profiles, we performed a cross-validation. We randomly split n observations into training set of size n t and validation set of size n v (n t  n v  n) such thatThe training set serves as the set by which we estimate the model parameters ^ b t and ^ c t. The estimates are then used in the validation set to obtain model predictionwhere I equals one (squamous group) if the expression inside the brackets is true, and zero (ADC group) otherwise. From this prediction, we obtain how many tumour histologies in the validation set are misclassified (classification error). Denoting y v  y v1 y v2. .. y vnv  0 and, from(8) ^ y v  ^ y v1 ^ y v2. .. ^ y vnv  0 , we define the classification error asWe also calculate this error as percentages out of n v , which are presented in the Supplementary Material. In our application, we perform the cross-validation 100 times where, out of 76 observations, 38 observations are randomly selected to be in the training set and the remaining 38 observations are in the validation set. To see whether the classification error obtained by logistic regression is within a reasonable range, we need to consider other classification methods in the cross-validation. This enables us to get a better view of the performance of the logistic regression model (Section 2.3) in the prediction of tumour histology. Some classification models that we consider in the crossvalidation are: (i) k-nearest neighbour (KNN) with k  1;. .. ; 7, (ii) diagonal-quadratic and diagonal-linear discriminant-analysis (DA),support vector machines and (viii) smoothed logistic regression. For this purpose, we only use the CNA profiles based on the smooth and circular binary segmentation (CBS), i.e. X t and X v are just vector of ones, and ^ b t is just an estimate of fixed intercept (from the training set). Note that the elastic-net and lasso models are essentially logistic regression with different penalties to the likelihood that that we describe in Section 2.3. To avoid confusion, we reserve the term 'logistic regression' for the one we describe in Section 2.3. We use the terms 'elastic-net' and 'lasso' to refer to the logistic regression with elastic net and lasso penalties, and use the acronym 'SLR' to refer to the SLR.
Agreement in prediction between segmentation methodsA concern that we have in the analysis is whether the choice of segmentation method that we use to estimate CNA really does determine whether a patient's tumour histology is misclassified or not, given a classification model. In other words, if a patient's tumour is predicted as ADC based on smooth-segmented CNA, is it also predicted as ADC based on CBS-segmented CNA? To answer this question, we also estimate the agreement in prediction between these two very different segmentation methods. Let us denote Z s and Z d as CNA profiles based on the smooth and CBS segmentation, respectively. Let us also denote ^ b s t and ^ c s t to be the fixed and random parameter estimates from the training set using CNA profiles based on smooth segmentation. Similarly, we denote ^ b d t and ^ c d t as the estimates in the training set using CNA profiles based on CBS (DNACopy) segmentation. We distinguish the predicted tumour histology in the validation set using CNA profiles based on the smooth and CBS segmentation aswe measure the agreement in prediction between the two segmentation methods asA high value of j indicates that, given a classification model, the prediction in the validation using CNA profiles based on smooth segmentation is in agreement with those based on the CBS segmentation.
SoftwareAn R package called CNALR is available from the corresponding author's webpage ('Availability' in the abstract section), including some tools to combine the results of normalization from CNAnorm package (). The CNAnorm package normalizes each sequence individually, and the CNALR package will select relevant quantities from the CNAnorm output. The CNALR package contains functions to handle the CNA profiles across patients and fit a logistic regression.
ResultsIn this section, we mainly present the results for the lung cancer dataset. For the oral cancer dataset, we present its results mainly in the Supplementary Material.
CNA profilesIn this section, we briefly describe the summary of the profiles within each histology.shows (point-wise) means of the CNA profiles across the patients within each of the squamous and ADC groups. One point incorresponds to a genomic window, and is the mean of CNA at the same genomic window (as illustrated in) across different patients in each histology group. The figure indicates that the means of CNA profiles between the two groups share many similarities, although some differences can be observed. For example, we observe that the overall gains in 3q and 2p regions are higher in the squamous group than those in the ADC group. Although the pattern in, e.g. 3q region indicates a separation between the squamous and ADC groups, this does not mean that a modelling is not needed. Gains in 2p and 3q are not exclusive to the squamous group, just more common. If we rely the classification of tumour histology only on the pattern that we observe in the 3q region, then effectively we ignore the contribution of other genomic regions in the genome, as well as risk mis-classifying any sample which happens by chance to have a small number of CNAs in the 'wrong' places. Our results below suggest that the histology prediction of new samples does not necessarily improve if the prediction relies only on CNA profiles from some genomic windows.
Model fitWe fit the logistic regression on the covariates and CNA profiles of the patients. An important parameter to be estimated from the model is k, and this is described in. The figure indicates that the optimal k in the model is estimated as exp6 and exp6:5 for CNA profiles using smooth segmentation and CBS segmentation, respectively. Using the optimal ^ k, the results of estimation in the (fixed) covariates are presented in. The table indicates that none of the (fixed) covariates is statistically significant (i.e. P-value > 0.05). These results suggest that there is no significance difference in patients' age and gender distribution between the squamous and ADC groups. The random effects estimates of the logistic regression are presented in. An immediate pattern that we could see is the magnitude of the estimates for the genomic windows in the 3q region. This pattern suggests that CNA gains in the region contribute to increase the probability of the tumour to be classified into the squamous group, and CNA losses to the ADC group. On the other hand, negative estimates as we see in most of chromosome four indicate that CNA gains in the region contribute to increase the probability of the tumour being classified as ADC group and CNA losses to the squamous group. The model fit for our analysis is presented in. The figure indicates that the logistic regression can fit the data very well, where the tumour histology is correctly classified. In, we need to be careful in interpreting the pattern of the random effects estimates. None of the individual random effects estimates is statistically significant, in the sense that all of the 95% individual confidence interval for the random effects include zero. This does not mean that there is no information contained in the data. This is just a result of the estimation of more than 17 000 parameters from just 76 observations. This is also not a contradiction when we consider that the model has a good fit as shown in. From the construction of the model, although the individual random effects estimates are not significant, there is a linear combination of window-wise CNA profiles that jointly classify the tumour histology.
Cross-validationThe results of cross-validation for the lung cancer dataset are presented in. The figure indicates that the logistic regression has the lowest median classification error in comparison to the other classification models that we consider in our study. The use of KNN and discriminant analysis give a relatively high classification error. This high error is consistent regardless of the number of neighbour in KNN or the type of discriminant analysis. The PLSs gives relatively low median of classification error, which are comparable to that of the logistic regression. In building the classification rule, PLS expands the space on the CNA mean differences [see for example Barker and], without being weighted by the between-class covariance matrix. Given that CNA profiles can exhibit dramatic changes of copy number, PLS ignores the between-class covariance-matrix (i.e. focus on the differences on copy number) to give a good prediction. The elastic-net and lasso models give a slightly higher median classification error than that of the logistic regression when we use smooth-segmented CNA profiles, but not when we use CBS-segmented CNA profiles. This is an interesting result because the elastic-net and lasso models produce sparse solution on the parameters where some of the estimates are zero estimated. Effectively, a variable selection is embedded inside the classification models. Our results indicate that when we use smooth-segmented CNA profiles as predictors, the variable selection does not necessarily produces higher prediction (or lower error). On the CBS-segmented CNAStratifying tumour subtypes based on CNA profilesprofiles, the variable selection still gives the same low median of classification error as that of logistic regression (Section 2.3). For the oral cancer data, we have a more challenging situation where it is sometimes more difficult to distinguish oral squamous cell carcinoma (OSCC) from OVC histologically.describes the prediction error in the oral cancer data. The figure indicates that the logistic regression and SLR have the lowest prediction error in both smooth and CBS (DNAcopy) segmented CNA profiles. Support vector machines with nu-classification has a low prediction error comparable to the logistic regression, only when using the smooth-segmented CNA profiles. Still within the cross-validation,presents how the two segmentation methods (smooth and CBS segmentation) agree in prediction within the validation set. If the agreement is low, then the choice of segmentation method does matterin terms of classification errorwhen we use a particular classification method. The contrary can be said if the agreement is high.indicates that we have a high agreement when we use logistic regression and support vector machines. PLS, elastic net and lasso models have lower agreement in the lung cancer data compared with the logistic regression, and this agreement increases in the oral cancer data to be comparable to the logistic regression. The overall results of our cross-validation suggest that the logistic regression is able to achieve a low classification error while maintaining high agreement in prediction between the smooth-and CBSsegmented CNA profiles.
DiscussionIn predicting tumour histology, the main challenge is to consider a model with low classification error. Further than that, we are also interested in the agreement between smooth-and CBS-segmented CNA profiles in the prediction of new tumour sample. This is critical when we consider that the CNA profiles are derived from lowcoverage NGS data that have undergone several preparation steps. This includes, but is not limited to, mapping to the reference genome, filtering, optimal window estimation, normalization (including normalization due to contamination) and segmentation. To have a classification method with a good prediction while having a minimum dependency on a previous pre-processing step is a great advantage. The logistic regression described in Section 2.3 (also known as Tikhonov regularization) is well-known to tend to group variables (genomic window) together (). This property of. The observed tumour histology against its model fit based on the full logistic regression model using smooth and DNACopy CNA profiles in the lung cancer dataset. The vertical lines mark the 50% probability to be in the Squamous histological group. Probability > 50% are normally classified to the Squamous groupFig. 6. Classification error from 100 cross-validations (38 observations in each of the training set and validation set) using only the smooth-and CBSsegmented CNA profiles in the lung cancer dataset across different classification models: logistic regression ('Log'), KNN with k  1; 2 ('K1'-'K2'), diagonal quadratic ('DA1') and linear ('DA2') discriminant analysis, 'PLSs', elastic net ('Net'), lasso ('Las'), neural network ('NN'), support vector machines with C-classification ('SV1'), nu classification ('SV2'), and bound-constraint classification ('SV3') and 'SLR'. The horizontal dotted line is the median of classification error of the logistic regression. Figures with 'K3'-'K7' are presented in the Supplementary Material. The significance of the classification error between pair of methods are also presented in the Supplementary Material) that have significant differences of CNA profiles between the squamous and ADC groups, using a permutation method. A more detailed view of the random effects estimates in each chromosome is presented in the Supplementary Material the logistic regression is likely to predominate in prediction, in terms of classification error and agreement between the segmentation methods, because there are some dependencies of CNA between neighbouring genomic windows. The lasso and elastic net models achieve comparable classification error as the logistic regression only when the CNA profiles are CBS-segmented. The CBS (DNACopy) segmentation generally outputs long segments, and the variable selection effect that the two methods produce does not impair the prediction because the genomic regions that survive the penalization are able to represent the information of the whole segment. We have demonstrated the ability of the proposed method to distinguish between two subtypes of lung cancer. We then validated this method in a separate cohort of oral cancer patients, whose diagnosis is not always straightforward, but whose prognosis is very different. However, in theory, it could be used to distinguish between any subtypes of tumour, or to make predictions about disease progression, drug resistance or outcome. Currently, several molecular classifiers are used to distinguish cancer subtypes, among them mRNA or protein expression. These are both selective methods. The study of mRNA usually involved the removal of non-coding RNA and micro RNA, the roles of which are increasingly becoming apparent. The study of protein expression usually involves only a few known proteins. Both of these methods will also involve further depletion of valuable sample material. Where there is no known mRNA or protein signature, our method may prove useful in finding previously unsuspected differences in the genomes of two sample groups. Low coverage sequencing is also possible with extremely low quantities of badly degraded DNA (). If mRNA or protein tests are available, then their results can be easily added to the logistic regression method as additional predictors and will further improve performance.
Smooth CNA
ConclusionWe have investigated that the use of logistic regression to model tumour histology and include the genome-wide CNA profiles as predictors. The model enables us to include clinical characteristics as fixed covariates and CNA profiles as random predictors in a single modelling framework. The model exhibits a good fit and, in a cross-validation, shows minimal classification error. The model also demonstrates the best agreement in prediction between CNA profiles produced by two very different segmentation methods.. Classification error from 100 cross-validations (52 and 50 observations in the training set and validation set, respectively) in the oral cancer dataset using only the smooth-and CBS-segmented CNA profiles across different classification models: logistic regression ('Log'), KNN with k  1; 2 ('K1'-'K2'), diagonal quadratic ('DA1') and linear ('DA2') discriminant analysis, 'PLSs', elastic net ('Net'), lasso ('Las'), neural network ('NN'), support vector machines with C-classification ('SV1'), nu classification ('SV2'), and boundconstraint classification ('SV3') and 'SLR'. The horizontal dotted line is the median of classification error of the logistic regression. Figures with 'K3'-'K7' are presented in the Supplementary Material. The significance of the classification error between pair of methods are also presented in the Supplementary Material. Agreement between smooth segmentation and CBS segmentation in prediction from 100 cross-validations in the lung cancer dataset (top panel) and oral cancer dataset (bottom panel) across different classification models: logistic regression ('Log'), KNN with k  1; 2 ('K1'-'K2'), diagonal quadratic ('DA1') and linear ('DA2') discriminant analysis, 'PLSs', elastic net ('Net'), lasso ('Las'), neural network ('NN'), support vector machines with C-classification ('SV1'), nu classification ('SV2'), and bound-constraint classification ('SV3') and 'SLR'. For the oral cancer dataset (bottom panel) the agreement for DA1 and DA2 are below 0.6. The horizontal dotted line is the median of agreement in the logistic regression. Figures with 'K3'-'K7' are presented in the Supplementary Material
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
A.Gusnanto et al. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
