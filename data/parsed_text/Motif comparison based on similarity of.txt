Measuring motif similarity is essential for identifying functionally related transcription factors (TFs) and RNA-binding proteins, and for annotating de novo motifs. Here, we describe Motif Similarity Based on Affinity of Targets (MoSBAT), an approach for measuring the similarity of motifs by computing their affinity profiles across a large number of random sequences. We show that MoSBAT successfully associates de novo ChIP-seq motifs with their respective TFs, accurately identifies motifs that are obtained from the same TF in different in vitro assays, and quantitatively reflects the similarity of in vitro binding preferences for pairs of TFs. Availability and implementation: MoSBAT is available as a webserver at mosbat.ccbr.utoronto.ca, and for download at github.com/csglab/MoSBAT. Contact:
IntroductionThe sequence preference of a transcription factor (TF) or an RNAbinding protein (RBP) is most commonly represented using a 'motif', which refers to the matrix of the probabilities of occurrence of any given nucleotide at any given position of the binding site. Measuring the similarity of motifs is fundamental to several aspects of studying TFs and RBPs, such as elucidating the relationship between sequence and function of these factors (), assigning known TFs and RBPs to de novo discovered motifs (), and measuring performance of in silico motif prediction approaches (). The majority of motif comparison approaches are based on alignment of two motifs, where the similarity measure is defined as the score of the best alignment (). A few other methods use binding site predictions to identify overlapping sites in random sequences, allowing derivation of a motif similarity score and alignment (). Here, we introduce an alignmentindependent approach for measuring the similarity of two motifs. The method is based on measuring the similarity of the affinity profiles of TFs or RBPs across a large number of random sequences, with the affinity profiles predicted using the associated motifs. We show that our approach for measuring Motif Similarity Based on Affinity of Targets (MoSBAT) can accurately identify similar motifs that are derived from different experimental methods, e.g. in order to identify TFs associated with de novo motifs derived from ChIP-seq data. Motif similarity scores reported by MoSBAT also closely reflect independent sequence preference similarity measures derived directly from in vitro measurements.
Materials and methodsTo measure the similarity of two motifs, we first convert the motifs to position-specific affinity matrices (PSAMs) (). Then, we generate a set of N random sequences (N > 20 000) of length L (default 100 nt). For each of the two PSAMs, we calculate the score profile across the random sequences using PSAM scanning, as described in Supplementary Note S1. The resulting two vectors represent the binding 'affinity' profile of each of the motifs for the N sequences (). By taking the logarithm of affinity vectors, we obtain vectors that represent the binding 'energy' profiles of the motifs for the N sequences. Similarity of the two motifs is then calculated as the Pearson correlation coefficient (PCC) of the two affinity vectors (MoSBAT-a), or the two energy vectors (MoSBAT-e). Additional details of the methods can be found in Supplementary Notes S1 and S2. MoSBAT is available as a webserver at http://mosbat.ccbr.utor onto.ca, and for download at https://github.com/csglab/MoSBAT. The input and output of the MoSBAT webserver are described in Supplementary.
BenchmarkingWe compared MoSBAT to four popular motif comparison tools () by scoring their ability to correctly match the motifs obtained for the same protein from different assays. One such task is assigning the correct TFs to motifs discovered by ChIP-seq, based only on comparison to in vitro motifs. We compiled a set of 94 TFs with motifs that were discovered both by ChIP-seq and in vitro assays (PBM, SELEX, and B1H) in the CIS-BP database (), and asked whether we can correctly label the ChIP-seq with their respective TFs by comparison to the available in vitro motifs. In this 'classification' task, the 'positives' are pairs of ChIP-seq and in vitro motifs that are obtained from the same TF, the 'negatives' are pairs of motifs that are obtained from different TFs, and the 'predicted value' is the similarity between the ChIP-seq motif and the in vitro motif, measured using different motif comparison tools. Among 11 variations of the five tools tested, MoSBAT-e, Tomtom (P-value) () and STAMP () were the best-performing methods with area under the receiver operating characteristic (ROC) curve (AUROC) of 0.96 (). Furthermore, when the performance of different motif comparison tools was measured in each TF structural class separately (), MoSBAT-e overall outperformed all other measures (average rank 3.1 across 14 structural classes), followed by Tomtom and STAMP (average rank 4.1). Similar results are obtained when comparing different motifs of the same protein derived from different in vitro assays (Supplementary), suggesting that MoSBAT can correctly match related motifs across various experimental platforms. We also found that, for motifs obtained from pairs of different TFs, MoSBAT scores closely correlate with similarity of the in vitro binding preferences of TFs obtained directly from high-dimensional PBM data (PCC of 8-mer Z-scores, Supplementary Figures S34). These results suggest that MoSBAT can quantitatively measure the underlying similarity of TF sequence specificity even after the highdimensional PBM data have been summarized as motifs. In this regard, MoSBAT outperformed all other motif comparison tools by a large margin, and was more tolerant to experimental noise (Supplementary). We note that MoSBAT uses randomly generated sequences to calculate binding affinity profiles for measuring similarity of motifs. This stochastic process can potentially generate different scores every time for the same pair of motifs (Supplementary Note S3). However, our analyses suggest that MoSBAT-e scores are highly stable when >50 000 sequences are used for constructing the binding affinity profiles (Supplementary). MoSBAT-a scores are also stable for short motifs, but have larger variance for some longer motifs (Supplementaryand Supplementary Note S3). Indeed, when the results of our motif comparison between different in vitro methods are stratified by motif length, a small decrease in accuracy is observed for longer motifs especially when comparing PBM motifs to SELEX motifs, but this decrease in accuracy is comparable to that of Tomtom (Supplementary). Overall, given the superior performance of MoSBAT-e in almost all tests, and the biochemically relevant definition of its scoring measure, we present it as an easy to use tool for motif comparison.
Funding
S.A.Lambert et al. at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
