Motivation: Atomic resolution modeling of large multimolecular assemblies is a key task in Structural Cell Biology. Experimental techniques can provide atomic resolution structures of single proteins and small complexes, or low resolution data of large multimolecular complexes. Results: We present a novel integrative computational modeling method, which integrates both low and high resolution experimental data. The algorithm accepts as input atomic resolution structures of the individual subunits obtained from X-ray, NMR or homology modeling, and interaction data between the subunits obtained from mass spectrometry. The optimal assembly of the individual subunits is formulated as an Integer Linear Programming task. The method was tested on several representative complexes, both in the bound and unbound cases. It placed correctly most of the subunits of multimolecular complexes of up to 16 subunits and significantly outper-formed the CombDock and Haddock multimolecular docking methods. Availability and implementation: http://bioinfo3d.cs.tau.ac.il/DockStar Contact:
IntroductionMany cellular processes are performed by multimolecular protein complexes (). A cell consists of hundreds of different functional complexes, such as the RNA exosome, the proteasome and the nuclear pore complex (). Detailed structural characterization of such complexes is a primary goal of structural biology. However, structural characterization of large complexes by high resolution experimental techniques, such as X-ray crystallography or NMR spectroscopy, is challenging, whereas electron microscopy or mass spectrometry (MS) produce low resolution data (). It is becoming clear that integration of data derived from a variety of bio-physical techniques at multiple levels of resolution is essential for the structural analysis of large complexes (). In the last couple of decades significant progress has been achieved in computational modeling of binary proteinprotein complexes as has been showcased in the CAPRI (Critical Assessment of Prediction of Interactions) challenge (). However, only a handful of methods has been developed for the modeling of multimolecular complexes. The better performing ones have been limited to symmetric homo-oligomers (). For the non-symmetric case, we have previously developed CombDock (), which formulates the multimolecular complex detection task as a search for an optimally scoring spanning tree of the complex subunit interactions graph. The optimization is done by a branch and bound technique. The multimolecular version of Haddock () is driven by experimental and bioinformatics data, but limits the number of subunits to six, apparently due to computational complexity constraints. Multi-LZerD () builds the multimolecular assembly applying a stochastic search driven by a genetic algorithm.construct the multimolecular complex iteratively, where at each iteration the subassembly is grown by one subunit.model the complexes at a coarse grained resolution, where proteins are represented by single spheres. Experimental MS-based data is translated into spatial restraints and integrated into the scoring function using the IMP platform (). The generation of candidate models is done by an exhaustive Monte Carlo search of the conformational space. The large multimolecular assembly task can be divided into two subtasks: (a) Detection of the protein-protein interaction graph between the individual subunits; (b) Detection of a globally consistent pose of the subunits, so that there are no steric clashes between them and the binding energy of the whole complex is optimized. Low resolution experimental data obtained from MS is especially suitable to assist in subtask (a). In particular, native MS of intact protein complexes and their subcomplexes can determine the stoichiometry of the complex subunits and deduce the interaction graph of the multimolecular complex (). Chemical cross-linking combined with MS (XL-MS) provides distance constraints between surface residues both on the same and on neighboring subunits (), thus providing information both for the detection of the interaction graph as well as constraints on the relative spatial poses of neighboring subunits. Such constraints have been successfully exploited in the modeling of the 26S proteasome (), the proteasome lid (), the TRiC/CCT chaperonin (), the RNA polymerase IITFIIF complex () and more. Here, we introduce DockStar, a novel protein assembly modeling algorithm which integrates MS-based data. We assume knowledge of the subunit interaction graph [subtask (a)] and focus on a global solution to the '3D-puzzle assembly' task. Our algorithm performs a search for assemblies, optimizing satisfaction of cross-linking restraints as well as a knowledge-based interaction potential between neighboring subunits. The optimization is performed by formulating the task as an Integer Linear Program (ILP), thus not depending neither on greedy type iterative algorithms, which tend to miss solutions with low scoring intermediates, nor on time consuming Monte Carlo type search. This enables efficient handling of relatively large assemblies. To validate this method, DockStar was tested on a set of examples, where both high resolution structures of the full complex and cross-linking data between neighboring subunits was available. The modeling was performed both in bound and unbound scenarios and compared with the state of the art Haddock () and CombDock () multimolecular assembly algorithms. DockStar proved to be significantly more time efficient than the other methods, while exhibiting better performance.
MethodsDockStar receives as input a set of subunit structures, the subunit interaction graph and (optionally) a set of cross-linked residue pairs. It applies a pairwise (soft) docking algorithm to compute candidate docking poses for neighboring subunits, which are deduced from the interaction graph. The pairwise docking hypotheses are assembled into globally optimal multimolecular complex hypotheses by an ILP-based optimization algorithm. The final output is a ranked set of 3D complex structures, which are scored by the binding energy between the interacting subunits and satisfaction of the cross-links induced distance restraints. More specifically, the method is composed of the following steps (Supplementaryin the Supplementary Materials): 1. Generation of transformation sets. The aim of this step is to produce an initial set of candidate 3D poses (rigid transformations) for each subunit. 2. Pairwise scoring. A (docking) pair of candidate transformations belonging to different subunits is scored according to the quality of the resulting interface between the transformed subunits. The scoring function takes into account the number of satisfied cross-link restraints and a knowledge-based potential. 3. Choice of globally optimal solutions. A solution includes one rigid transformation for each subunit. The transformations are chosen to optimize the sum of the resulting interfaces scores. This optimization problem is solved by formulating the task as an ILP. The algorithm is tuned to produce a ranked set of K (user predefined) best solutions. 4. Integration of partial solutions. In some cases, the method of choice for generating the transformation sets limits the algorithm to deal only with complexes in which one subunit interacts with all the other subunits (interaction graph with a star shaped spanning tree). In such a case, the interaction graph of the whole complex is partitioned into (overlapping) subcomplexes with star shaped spanning trees, and the top scoring solutions for the subcomplexes are reintegrated to detect global solutions to cover the whole complex (Supplementary).
Generation of transformation setsIn the first stage of the algorithm for each subunit a set of candidate rigid transformations is generated. These transformations are obtained from the top scoring docking poses of neighboring subunits. However, when modeling multimolecular complexes, it is important to ensure that all these transformations are consistent, namely, refer to the same 3D reference frame. Therefore, one subunit is chosen as an anchor subunit, and its coordinate system is used as the 3D reference frame for all the other subunits. Preferably, the anchor subunit should have the largest number of neighbors in the multimolecular assembly interaction graph. All other subunits which are known to interact with the anchor are then docked to it. Hence, in this case, transformation sets are generated only for the anchor and its neighbors requiring a star shaped spanning tree topology of the interaction graph. In cases where the interaction graph of the complex does not have a star shaped spanning tree, the complex is divided to sub-complexes with star shaped spanning trees, that are solved independently and then the top solutions are integrated to cover the whole complex. The docking step is carried out by the PatchDock () algorithm, which optimizes shape complementarity, while satisfying distance constraints between residues of neighboring subunits, if such constraints are available. In our examples the cross-link induced maximal distance constraint, which includes the linker and extended residue lengths, was set to 30 A  (). The top 1000 PatchDock transformations are refined, rescored and reranked by the FiberDock () algorithm. For each subunit, a predefined number of top ranked transformations is chosen as the subunit transformation set. Using an anchor subunit as a 3D reference frame for a subcomplex with a star shaped spanning tree is the 'method of choice' in the difficult cases, where no additional data is available. However, if a homologous complex or an intermediate resolution cryo-EM map of the complex is available, one can compute the transformations by aligning the atomic resolution subunit structures to the (homologous or lower resolution) template complex.
Pairwise scoringFor each of the n subunits, let P i (0 i < n) be subunit i and TP i  be the set of candidate transformations received from the previous stage for subunit P i. Let T i;r be transformation r of subunit P i and ST i;r ; T j;s  the pairwise interaction score of subunits P i and P j transformed by T i;r and T j;s , respectively. Each pair of transformations T i;r and T j;s , where i 6  j, is scored by the number of satisfied cross-link constraints between the transformed subunits. In case of equality, the interfaces generated between the subunits are ranked according to the recently published statistically optimized atomic potentials (SOAP-PP) score ().
Choice of a globally optimal transformation setThe globally optimal solution Sol includes one transformation per subunit and maximizes score(Sol) defined as:Graph theoretic formulation of the optimization task. This optimization task can be formulated as the following graph theoretic problem (Supplementary). Let G  V; E be an undirected n-partite graph with vertex set V  V 0 [    [ V n1 , so that for each transformation T i;r 2 TP i  there is a vertex u i;r 2 V i. Each pair of vertices is joined by an edge: E  fu i;r ; v j;s ju i;r 2 V i ; v j;s 2 V j ; i 6  jgwith the weight: wu i;r ; v j;s   ST i;r ; T j;s  8u i;r ; v j;s  2 EThe optimal solution is achieved by choosing one vertex per V i that maximizes the edge-weight of the induced sub-graph. ILP formulation. The above graph theoretic task can be formulated as an ILP (). Define a variable X i;r for each vertex u i;r 2 V and a variable Y i;r;j;s for each edge e  u i;r ; v j;s  2 E as follows:X i;r  1 ifu i;r is chosen 0 otherwise (Y i;r;j;s  1 if both u i;r and v j;s are chosen 0 otherwise (The ILP objective function is:The objective function (Eq. 6) is exactly the edge-weight of the chosen sub-graph. The first constraint (Eq. 7) ensures that exactly one transformation is chosen for each subunit. The second constraint (Eq. 8) ensures that an edge is chosen if and only if both vertices that it connects are chosen as well. The ILP step was solved by the CPLEX 12.5 package (http:// www.ilog.com/products/cplex/). Missing subunit. Although the previous formulation ensures the choice of exactly one transformation per subunit, in a practical setting it might occur that no reasonably scoring candidate transformation exists at all for some of the subunits, due, for example, to poor homology modeling. In such a case, one would like to return a partial solution. To handle this event an extra transformation is added to each subunit transformation setthe blank transformation. This transformation represents a situation where a solution for this subunit is 'missing'. The pairwise score of this transformation with any transformation of another subunit is set to zero. Therefore, a solution with missing subunits will be chosen if there is no full solution (with all subunits) with a higher score. Alternative solutions. The method presented above outputs one single highest scoring global solution. To retrieve additional high scoring solutions, the ILP step is applied iteratively to find a solution that maximizes the objective function and was not chosen before. To achieve it a linear constraint is introduced for each previously obtained solution F. Define: 8X i;r FX i;r   1 , X i;r was chosen in solution F. Then add the following constraint to the ILP constraint set:This constraint promises that solution F will not be chosen again.
Integration of partial solutionsThe presentation above deals with complexes having a star shaped spanning tree, where an anchor subunit, which interacts with all the other subunits, can be chosen. However, this is a special case. To apply the method for arbitrary complexes, they are divided into overlapping sub-complexes, each with a star shaped spanning tree, which are solved separately as above. Then, top solutions of subcomplexes that share a subunit are merged, while defining the shared subunit as the new 'anchor'. All the transformations in the merged (new) subcomplex are recalculated vis-a-vis the reference frame of the new 'anchor'. These new transformation sets are used as input for steps 24 of the algorithm in order to solve the larger sub-complex. In several such iterations one can cover all the subunits of the assembly.
ResultsDockStar is a multimolecular docking method which integrates experimental cross-links and graph topology data. The method was tested on a diverse dataset, which included bound and unbound examples, different numbers of complex subunits (from 3 to 16), and diverse additional experimental data (see summary of results in). The method was compared with the state of the art CombDock and Haddock multimolecular docking methods. All running times were measured on a 12 core XEON 3.06 GHz server. Below we present in detail the results for several large complexes. Additional data, including figures, can be found in the Supplementary Materials.
Modeling of individual subunitsIn order to simulate unbound modeling, models of the different subunits were created using homology modeling. Homologous proteins were found using BLAST () and HHBLITS () and were modeled with MODELLER ().
Assessment criteriaThe assessment of the quality of the resulting solutions was determined by three measures: (i) global Ca-RMSD between the predicted complex and the (known) native complex, (ii) i-RMSDbb (interface RMSD of the backbone) and (iii) Fnat (fraction of native contacts) between interacting subunits of the complex interaction graph spanning tree (Supplementary Materials for comprehensive Fnat and i-RMSDbb definitions). The interacting subunit interface prediction quality was divided into four categories (the three first follow the CAPRI challenge definition): high quality predictions (Fnat ! 0.5 and i-RMSDbb 1.0 A  ), medium predictions (Fnat ! 0.3 and i-RMSDbb 2.0 A  ), acceptable predictions (Fnat ! 0.1 and i-RMSDbb 4.0 A  ) and lenient predictions (i-RMSDbb 8.0 A  ). The lenient criterion was introduced, since analysis of docking funnels suggested that predictions with i-RMSDbb up to 810 A  can be locally minimized and refined to near native structures ().
The complexes modeledPP2A. The protein phosphatase 2A has a key role in regulating diverse signaling pathways including cell growth, differentiation, apoptosis, cell motility, the DNA damage response and cell cycle progression (). The complex in its active form is composed of a catalytic subunit C, a scaffold subunit A and a regulatory subunit B (). Cross-link data of this complex is available () as well as the 3D atomic resolution of the subunits (). The cross-link data includes three inter cross-links. As all inter crosslinks included subunit A. This subunit was used as the anchor subunit and subunits B and C were docked to it using PatchDock with the inter cross-links as distance constraints. The top scored 50 PatchDockFiberDock solutions were used as candidate transformations for DockStar. In the bound case, out of $ 2:6  10 3 possible solutions (the number of all possible solutions is the product of the size of the transformations set of each subunit), the first solution was correct with only 0.6 A  average i-RMSDbb of the predicted interfaces and low global Ca-RMSD of 0.68 A  [,, Supplementaryin the. The runtime of DockStar on this example was <32 min for the pairwise scoring step and 1:16 min for the ILP step. In the unbound case, MODELLER was used to calculate the structures of the individual subunits according to templates with sequence identity of 40 to 100% (Supplementary). These calculated models had 1.95.3 A  RMSD to the bound native subunits. Sets of 50 alternative transformations for B and C were created by taking the best 50 scored docking results of PatchDockFiberDock for the pairs AB and AC as in the bound case. In these sets, the smallest i-RMSDbb of subunits AB and AC were 5.6 and 5.8 A  , respectively. The first solution of DockStar included these best transformations (Supplementary Table S3 and) and the global Ca-RMSD of this solution was 6.9 A  (). The major reason for this relatively high i-RMSDbb is due to the limited accuracy of the homology modeling. The homologous models of subunits B and C have 5.3 and 3.2 A  RMSD to the native, respectively. The run time was 40 min for the pairwise scoring step and 2 min for the ILP step. Beef Liver Catalase. The beef liver catalase is a common homotetramer, which catalyzes the decomposition of hydrogen pyroxide to water and oxygen (). Its subunits contain a hem group and a NADPH molecule. Cross-link data of this complex is available () and includes three inter cross-links that connect subunits: B-D, B-C, A-D. Therefore, the complex was solved in two steps. First, subunits B and D were selected as anchor subunits and the complexes D-B-C and A-D-B were solved. Then, the top 100 results from the previous run were merged by applying a second run. In the bound case, the first solution was correct with three out of three high quality interface predictions (with average i-RMSDbb of 0.54 A  ) and global Ca-RMSD of only 0.85 A  to the native (,, Supplementary). The run time in this case was 35 min and 1:48 min for the pairwise scoring step and the ILP step of the first run, respectively; 2:13 h and 1:14 min for the pairwise scoring step and the ILP step of the second run. For the unbound case, each of the subunits was modeled according to the human erythrocyte catalase template with sequence identity of 91% to the beef liver catalase and the obtained models had average RMSD of 0.73 A  to the native bound structures (Supplementary). The first solution had three medium quality interfaces (with average i-RMSDbb of 1.57 A  ) and global Ca-RMSD of only 2.7 A  to the native (, Supplementary Table S3, Supplementary). The run time in this case was 56 min and 1:43 min for the pairwise scoring step and the ILP step of the first run respectively; 2:51 h and 3:39 min for the pairwise scoring step and the ILP step of the second run.RNA polymerase II. In eukaryotic cells, RNA pol II catalyses mRNA synthesis during transcription of protein-coding genes. This large asymmetric complex is composed of 12 subunits: a 10-subunit catalytic core (Rpb1-3,5,6,8-12) and a complex of two subunits (Rpb4/7) (). The two big core subunits Rpb1/2 are connected to all other subunits except of Rpb4, which is connected to the complex through Rpb7. Data which includes 34 inter crosslinks is available (). We have solved the complex both in the 'bound' and 'unbound' scenarios. In both cases, first the two big core subunits (Rpb1/2) were docked to each other using PatchDockFiberDock (). Then, all other nine subunits were docked to the Rpb1/2 complex. Finally, DockStar was executed with sets of the top 200 FiberDock candidate transformations and the inter cross-link data. For the bound case, the complex subunits from PDB 1WCM () were used. DockStar's first solution predicted correctly 9 out of the 10 interfaces and had 7.9 A  global Ca-RMSD of the 10 subunits subcomplex relative to the native. The average iRMSDbb was 1.85 A  (,, Supplementaryandin the Supplementary Materials). This solution satisfied 32 out of the 34 inter cross-links. The run time of this example was 4:35 h for the pairwise scoring step and 18:22 min for the ILP step. In the unbound case, models of the different subunits were generated using homology modeling templates ranging from 33 to 100% sequence identity to the native subunits. Unbound structures were modeled with an average RMSD of 2.8 A  (Supplementary). The third ranked DockStar solution predicted correctly eight interfaces with an average of 3.0 A  i-RMSDbb relative to the native structure (Supplementary). The global CaRMSD of the solution subcomplex of these nine correctly transformed subunits is only 4.8 A  () satisfying 31 out of the 34 inter cross-links. The runtime in this example was 4:47 h for the pairwise scoring step and <4 min for the ILP step. Yeast Exosome. The exosome complex is the main cellular machinery responsible for degrading RNA molecules (). The interaction graph of this 10 subunits complex was deduced by the SUMMIT algorithm based on native MS experimental data (). The core of the complex consists of a six subunit ring (Rrp41-Rrp42-Mtr3-Rrp43-Rrp46-Rrp45) and the remaining four subunits (Rrp4, Rrp40, Csl4, Dis3) interact with the ring subunits (Supplementary). Later, an X-Ray structure was published (). Because this complex spanning tree is non-star shaped, it was modeled in three rounds with different anchor units for each round (see Supplementaryfor a detailed explanation). In the bound case, the top ranked solution by DockStar correctly predicted seven out of the nine interfaces of the complex interaction graph spanning tree, () with average i-RMSDbb of 1.72 A  (Supplementary) and 5.1 A  global Ca-RMSD of the eight subunits subcomplex that includes only the correct interactions (). The total run time of this example was 10:34 h. In the unbound case, for 3 out of the 10 subunits the structure similarity between the homology modeled and the native structures was large (above 15 A  RMSD). In these cases (subunits: Rrp43, Mtr3, Dis3), the bound structures were used. The other homologous templates had 21100% sequence identity to the native subunits with an average of 36%. The modeled structures had RMSD range of 1.910.5 A  to the native bound structures (Supplementary). This is a difficult example for which there is no cross-links data and the unbound subunits have large RMSDs to the native. Despite that, the 12th solution of DockStar predicted correctly four interfaces with 3.5 A  average i-RMSDbb (Supplementaryand). The global Ca-RMSD of the subcomplex that includes only these interactions was 6.0 A  (). The total run time was 11:22 h. TRiC/CCT. The eukaryotic TRiC chaperonin plays a central role in assisting the folding of polypeptide chains (). In its open state the chaperonin binds the substrate, while in its closed state, the substrate is inserted into a large cavity where folding occurs (). The eukaryotic TRiC chaperonin is composed of 16 subunits, two copies of eight different subunits, that are arranged in two octameric rings (). Although each ring consists of eight different subunits the order of which allows specific substrate binding modes (Martn), the sequence identity between the different subunits in the same organism is 30% resulting in high structural identity, which makes reliable identification of the subunit order difficult as the subunits look almost the same in low resolution maps (in the eukaryotic bos taurus chaperonin, yet their methods are highly time consuming. Here, DockStar was applied to the cross-link data published by these two groups to detect the same structure in 10 and 14 min of CPU time, respectively. The published experimental datasets were used independently. First, all the individual subunits were modeled by homology modeling according to the homo-oligomer Thermococcus chaperonin closed state () that has 3440% sequence identity with the subunits (Supplementary). Then, 3D rigid transformation sets were generated bystructurally aligning each of the different modeled subunits with each of the Thermococcus chaperonin subunits. Sixteen subunits were used as inputtwo copies for each of the eight different subunits. Each copy has a set of eight 3D rigid transformations for the different locations in the octameric ring. The first cross-link set was taken from. Out of 63 high confidence cross-links, 17 are cross-links between different subunits. The top ranked solution () was identical to the solution obtained by
at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
N.Amir et al. at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
.4 Comparison with other methods DockStar was compared with the state of the art Haddock (Karaca et al., 2010) and CombDock (Inbar et al., 2005). Here, the results of the three methods were compared on the large complexes RNA polII, Yeast Exosome, and the small complexes PP2A and Beef liver catalase. Comparison with CombDock. CombDock is designed to model multimolecular complexes from subunit data alone, without receiving interaction graph information. It gets as input 3D structures of the subunits and a predefined number of top docking results of all subunit pairs in the complex. In each iteration, CombDock produces subcomplexes of size i from smaller subcomplexes produced in previous iterations and saves the K best scored structures. The pairwise docking results were calculated by PatchDock with cross-links as distance constraints. To perform a 'fair' comparison between CombDock and DockStar, we have run CombDock twice on each example. In the first run, the regular CombDock procedure was performed. In the second run, we artificially provided CombDock the interaction graph information by supplying PatchDock docking results for subunit pairs that are known to be in contact, while for the non-contacting subunits random transformations were introduced. The results are summarized in Supplementary Table S4 of the Supplementary Materials. DockStar outperformed CombDock in all the above mentioned examples. Although CombDock succeeds to predict good solutions in most of the bound cases, this is not the case in the unbound examples. Although the knowledge of the interaction graph improves performance, still in all of the unbound cases CombDock succeeds to predict correctly only 02 of the interacting pairs. In all cases, DockStar was able to rank good solutions higher than CombDock. DockStar's better ranking ability can be attributed to its scoring function, which ranks first cross-link satisfaction, followed by a SOAPs score (Dong et al., 2013), while CombDock uses a purely shape complementarity-based scoring function. Also, DockStar utilizes the ILP technique which returns an optimal scoring solution in the majority of the cases. Although in the small examples (34 subunits) Combdock's runs were extremely fast and lasted <2 min, in some of the large examples (1011 subunits), due to its exponential complexity, the runtime was prohibitive. The efficiency of the Dockstar method is due to the ILP technique which allows tackling problems with extremely large search space as multimolecular modeling, in relatively short running time. Comparison with HADDOCK. HADDOCK uses experimental and/or bioinformatics data to predict the complex structure. This data is translated to ambiguous and/or unambiguous restraints which are integrated into the score function. Here, CPORT, a Consensus Interface Predictor (de Vries and Bonvin, 2011), was used to predict the interface residues of each subunit. Ambiguous distance constraints between predicted interface residues of subunit pairs that are known to interact (according to the interaction graph) were generated using GenTBL. The cross-links data was used as unambiguous constraints. As HADDOCK is limited to six subunits, for the RNA polII and the Yeast Exosome examples (composed of 11 and 10 subunits, respectively) a subcomplex of six connected subunits was chosen to be remodeled. In the bound case, out of the four examples only one example has completed its run, the PP2A. None of the PP2A solutions contained a correct interface prediction. As there were no correct solution or sub-solution in the bound cases, HADDOCK was not tested for the unbound cases. 4 Discussion DockStar is a novel integrative multimolecular docking algorithm. The method integrates experimental or modeled atomic resolution individual protein subunit structure data with MS-based low resolution data. The search for a globally optimal multimolecular assembly is formulated as an ILP and, thus, efficiently solved in the majority of the cases. The method can be applied in additional situations where (low resolution) complex data is obtained from electron microscopy or homologous complexes. Future challenges include handling significant conformational flexibility of the modeled individual subunits.
