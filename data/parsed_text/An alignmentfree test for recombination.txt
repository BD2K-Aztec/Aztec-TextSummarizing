Motivation: Why recombination? is one of the central questions in biology. This has led to a host of methods for quantifying recombin-ation from sequence data. These methods are usually based on aligned DNA sequences. Here, we propose an efficient alignment-free alternative. Results: Our method is based on the distribution of match lengths, which we look up using enhanced suffix arrays. By eliminating the alignment step, the test becomes fast enough for application to whole bacterial genomes. Using simulations we show that our test has similar power as established tests when applied to long pairs of sequences. When applied to 58 genomes of Escherichia coli, we pick up the strongest recombination signal from a 125 kb horizontal gene transfer engineered 20 years ago.
INTRODUCTIONIt is surprisingly difficult to account for the prevalence of sex and recombination in nature (). Classical explanations for the evolution of sex are based on the realization that it can speedup adaptation (). In addition, it removes deleterious mutations from the population (). However, recombination also leads to the breakup of coadapted genes, which begs the question as to whether recombination has an evolutionary cause, or is a mere consequence of molecular mechanisms such as DNA repair (). Perhaps both views are correct, as the contemporary consensus is that sex and recombination would only be maintained in multicellular organisms with high mutation rates and largely negative fitness interactions between genes (). Irrespective of this uncertainty about the function of recombination in unicellular organisms, horizontal gene transfer in bacteria has attracted particular attention, as it often underlies the emergence of virulent pathogens (). The enigma of recombination, combined with its prevalence and clinical importance, has inspired the development of numerous methods for assessing genetic exchange (). These fall into two broad categories: methods for detecting the presence of recombination, and methods for estimating its rate. We concentrate here on the simpler detection problem. In the past, this has been solved in two ways: by looking for clustering of mutations or by identifying multiple mutations to the same nucleotide in distinct lineages. Such recurrent mutations are called homoplasies. Methods based on the detection of clustered polymorphisms include the widely used Max-2 method () and the runs method implemented in the popular GENECONV program (). Both are based on the realization that the time to the most recent common ancestor varies along a recombining sequence (). Because the number of mutations that affect a genomic region is proportional to the time to the most recent common ancestor of the sampled sequences, the number of mutations varies along the sequence; as a result, the mutations are clustered. Classical homoplasy-based methods rest on the assumption that any nucleotide mutates at most once, thus generating three haplotypes between a pair of polymorphisms, say 10, 01 and 00. The missing fourth possible haplotype, 11 in our example, can only be generated through recombination. The detection of such haplotype quartets is used to determine the minimum number of recombination events in an aligned sample of homologous sequences (). More recently, this diagnosis of either presence or absence of a recombination event between a pair of polymorphisms was generalized to inferring possibly more than one recombination in samples of more than four sequences. This has been formalized as the  w statistic and implemented in Phi, a fast tool for detecting recombination (). Like all homoplasy-based tests,  w tends to have greater power than its rivals based on polymorphism clustering (). The detection of recombination among a sample of homologous sequences is thus a well-understood problem, as long as an alignment of the sequences is available. However, aligning genomes remains challenging despite great advances in this field (). At the same time, there is interest in analyzing recombination at the scale of bacterial genomes, if not greater (). Fortunately, the nucleotide-wise assignment of homology that defines alignments is not necessary to test for recombination. We show this by developing a fast alignment-free test for recombination. Like Max-2 () and *To whom correspondence should be addressed.  The Author 2013. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com GENECONV (), our test is based on the detection of polymorphism clustering. But instead of scoring single nucleotide polymorphisms (SNPs), we record the lengths of exact matches between pairs of sequences. To a first approximation this corresponds to the distances between SNPs. Recombination leads to an increase in the fluctuation of match lengths when compared with no recombination. Because match lengths can be looked up efficiently using modern string algorithms (), our test scans a pair of Escherichia coli genomes totaling 10 Mb in only 8 s on a contemporary laptop. In the following, we derive our test and demonstrate its sensitivity and specificity through simulation. We also use simulations to compare it with two published tests, Max-2 and  w. Finally, we apply our test to 58 E.coli genomes to search for horizontal gene transfer.
METHODS
DerivationConsider the query q  ATATC and the subject s  ACGTG. At every position i in q we look for the shortest substring qi::j that is absent from s. We call this SHortest Unique subSTRING 'shustring' () at position i and denote its length by X i. For example, AT is the shustring starting at the first position in q, hence X 1  2. Our approach is built on the assumption that in pairs of homologous DNA sequences the shustrings correspond to homologous matches and hence their lengths represent distances to the next SNP. This assumption is reasonable for closely related sequences such as those sampled from populations or recently diverged species. Conceptually, we identify shustrings using a suffix tree of q and s (). We say 'conceptually' because our actual implementation is based on an abstract version of a suffix tree called 'enhanced suffix array' ().shows the suffix tree of q and s. Each suffix is represented by a path from the root to a leaf. For example, q1 is the leaf that corresponds to the suffix starting at position 1 in q, ATATC. Moreover, repeated prefixes are collapsed into single paths. For example, the suffixes q5::5  C and s2::5  CGTG share the prefix C, which appears only once in the tree. The sentinel character $ at the end of q and s differs from every character in q and s, even from itself. Its addition ensures that a suffix such as q5::5  C, which is a prefix of the suffix s2::5  CGTG, is also represented by a leaf in the tree. To identify the shustring starting at, say, q1, we visit leaf q1, and climb toward the root until we find a node, n, with a subject leaf in the subtree rooted on n. In our example, we carry out two climbing steps. Then we extend the path label from the root to the node we have reached by one character toward the starting leaf, to find our first shustring, AT. In this way, we calculate the shustrings at every position in q. Our test statistic is based on the lengths of shustrings, X i. Without recombination, and if sequences differ at a fraction of their sites, every site i has probability of differing between q and s, independently of other sites. Using this model based on the infinite sites model from population genetics, we obtain for the average shustring lengthHence, can be estimated from unaligned sequences as the inverse of the average shustring length (). Recall that recombination leads to fluctuations in the coalescence times along a sequence and therefore to clustering of polymorphisms (). As a result, the mean shustring length increases, which might be used as an indicator of recombination (). Unfortunately, we found that it was impossible to infer the expected average shustring length without estimating to a precision attainable only with alignments. However, the empirical variance of shustring lengths is a more promising statistic. Its expectation without recombination iswhere we can estimate from the average shustring length (). Es 2  is then compared with the observed variance, s 2 , to test the null hypothesis H 0 : Es 2   E " X 2. For this, we derivedVars 2  % 24 l 5 1 and assumed that s 2 is normally distributed with expectation " X 2 (Supplementary Material). This means that can we use a one-sided test for the normalized difference between s 2 and "which is approximately normally distributed with mean 0 and standard deviation 1. We also define the ratio$ G T G $ qs$ T G $ ssA T C $ C$ G $ qqsFig. 2. Suffix tree of our example query and subject sequences s and q
ImplementationWe implemented our test in the program rush, which stands for 'Recombination detection Using SHustrings'. The program rush takes as input a query and a subject DNA sequence in FASTA format and computes Q, D r , and the corresponding P-value. Its suffix tree construction is based on the deep-shallow algorithm and implementation by Manzini and Ferragina (2002), which is one of the most efficient string indexing methods available ().
DataWe downloaded complete genome sequences from GenBank for the 58 E.coli strains listed in Supplementary Table S1. Because rush is restricted to the analysis of sequences consisting solely of the nucleotide designations fA, C, G, Tg, all other characters were removed prior to the analysis.
Simulations and computer programsWe generated samples of homologous DNA sequences using the coalescent simulation program ms () in conjunction with ms2dna available from http://guanine.evolbio.mpg.de/bioBox/ These simulations were conditioned on the population mutation rate, , and the population recombination rate,.  2N e , where N e is the effective population size and is the mutation probability per generation. Under the infinite sites model, is equal to the expected number of pairwise mismatches,. Similarly,  2N e c, where c is the probability of recombination per generation. For more background on coalescent theory see the excellent introduction by. Max-2 and  w-values were computed using the program Phi (). The distances between the E.coli genomes were computed using kr (Domazet-LosoLoso and) and the tree based on these distances was computed and drawn with Phylip () using neighbor joining and mindpoint rooting.
RESULTS
SimulationsWe explored the accuracy of the newly derived Equation (1) through simulations. In, we varied sequence length. The simulated values of Vars 2  were always smaller than Equation (1), but the two curves are close. Similarly, when varying in, we found that Equation (1) is greater than the simulated value, though not much. Notice also that as expected from Equation (1), a 10-fold change in sequence length corresponds to a 10-fold change in Vars 2  (), whereas a 10-fold change in corresponds to an enormous 10 5-fold change in Vars 2  (). This comparison between simulated and computed Vars 2  values suggests that our test is conservative. Accordingly, we found that for the low rate of recombination of =bp  10 7 the null hypothesis of no recombination is rejected at  0:05 with a frequency of only 0.032 rather than the expected 0.05 (). However, with increasing recombination the rejection rate grows to 40.99 until %. When exceeds , the rejection rate declines again, as our test statistic D r is maximal if %. We also compared the rejection rate with D r to that with the homoplasy-based test statistic  w , which is computed from four or more aligned sequences ().shows that  w has a similar rejection curve as D r , with slightly less sensitivity at the simulated parameter combination. However, the sensitivity of D r and  w depends on the number of mismatches sampled.shows the rejection rate as a function of sequence length at  10 3 and a length-invariant expected number of recombination events of 100. When sequence length is 10 5 , D r and  w have little power, whereas 10 times longer sequences yield rejection in ! 97% of cases, with  w marginally outperforming D r. It is reassuring that D r is highly sensitive in the limit of long sequences. This is equivalent to saying that D r is sensitive when applied to polymorphic sequences as long as is small. This proviso follows from the assumption that shustrings are homologous. The greater , the more shustrings occur that are generated by random non-homologous matches between query and subject.Traditional methods for detecting recombination such as Max2 were designed for sequences no longer than a few kilobase. To compare D r with Max-2 , we used the simulation scheme by: for  w and Max-2 , we simulated samples of 10 sequences with =bp  0:01 and  16. For 1 kb sequences,  w was more sensitive than Max-2 , in agreement with) (). For D r , we simulated pairs of sequences with the same , and a value that resulted in the same expected number of recombination events as in the sample of 10; that is, we used  16  P 9 i1 1=i  45:3 (). For kilobase length sequences, D r has little power (). However, the power of all methods to detect recombination increases with sequence length (). For sequences of 100 kb or more D r is sensitive. Incidentally, this is the sequence length where we stopped the Max-2 simulations as they became too slow. The  w statistic was developed as a fast alternative to methods such as Max-2. We, therefore, simulated sequence quartets of lengths 10 4 10 7 bp and timed Phi given an alignment. The slope of the resulting run time curve was 2.2, that is, doubling the sequence length increases the run time 2 2:2  4:6-fold. We compared this with rush when applied to sequence pairs of the same lengths. The slope of its run time curve is 1.2. This is still a bit steeper than the optimal slope of 1, but means that with double the input data rush takes 2.3 times longer. As a consequence, Phi is eventually outperformed by rush for sequences longer than 100 kb (). Because Phi requires aligned sequences as input, we also timed aligning sequence quartets with Mavid (). Mavid is fast and the slope of its run time curve is only 1.1, making it virtually optimal. Still, rush is roughly 100 times faster than alignment-based Phi. In our final set of simulations, we investigated the potentially confounding effects of codon data and changes in GC content, and found that the rejection rate was unaffected by either (Supplementary Figs. S1 and S2).
A
Horizontal gene transfer in E.coliHaving established the accuracy and robustness of rush through simulations, we applied it to the 58 fully sequenced E.coli genomes available from GenBank at the time of writing (Supplementary).shows a cluster diagram of the strains computed from their complete genomes. The 58  57  3306 pairwise recombination tests between the 58 E.coli strains took rush 15 h, 9 min and 15 s on an Intel Xeon 2.40 GHz CPU, an average of 16.5 s per test. In all, 97% of these tests were rejected with significance P 0:05, indicating that the model assumption of uniformly distributed mutations is usually violated across whole bacterial genomes.shows the distribution of the 3306 values of our recombination measure Q;). The graph shows the fraction of hypothesis tests rejected with significance P 0:05 as a function of the rate of recombination, . Horizontal line: 0.05; Sequence length  10 6 ,  10 3 , replicates  10 4 ; sample size for  w : 4. Rejection rate as a function of sequence length for D r compared with  w ();  10 3 ,  100 for entire region, replicates  10 4 its median is 2.951 with a huge range of 0.58740.939. We focused on the two strains with the largest Q, KO11 versus K12_MG1655, which are marked by arrows in the cluster diagram (). To search for evidence of horizontal gene transfer, we looked for regions in the KO11 genome that were more closely related to K12_MG1655 than to its closest relative. The cluster diagram () indicates that the closest relative of KO11 is KO11FL. However, this is an artifact of the clutering algorithm, which guarantees finding the correct tree only for distances that actually fit a tree. Empirical distances are often not strictly tree-like, especially in the presence of recombination. When we look up the raw pairwise distances, we find that the distance between KO11 and KO11FL is 2:1  10 5 , whereas that between KO11 and W1 or W2 is below the sensitivity of kr, the program we used for estimating the substitution rates between genomes (). Hence, we took W1 as the closest relative of KO11.shows that at position 4.4 Mb, KO11 contains large fragments more similar to K12_MG1655 than to W1. The longest of these spans 102 kb and is located at 4 385 8664 487 685. When blasting this region against W1, the best hit is 46.9 kb long and contains 367 mismatches and 13 gaps. In contrast, the best hit in K12_MG1655 is 78.6 kb long with just 8 mismatches and 1 gap. The next best hit in K12_MG1655 is 23.5 kb long with 4 mismatches and 0 gaps. This is strong evidence for horizontal gene transfer. It looks as if it affected a common ancestor of KO11 and KO11FL because in KO11FL the 102 kb query generates two top hits, one 68.2 kb long, the other 33.5 kb with just 2 mismatches and 0 gaps. shustring lengths by shuffling polymorphisms requires an alignment. Moreover, a parametric approach is faster, albeit sometimes less accurate, than its Monte Carlo equivalent. In our case, Vars 2  is always slightly larger than its simulated counterpart (). Our test is thus conservative when applied to simulated data. This is illustrated by, where no recombination leads to 3% rejections with  5%. However, a 3% rejection rate is reasonably close to the expected 5%, giving us additional confidence that the test statistic D r behaves as desired. We compared Max-2 with D r using one of the parameter combinations of. Our 1 kb results inwere compatible with theirs; our results also document that D r is not a replacement of established methods, but rather complements them for megabase-length sequences. Application to sequences of this length is possible because rush runs $100 times faster than Phi plus alignment (). Given that our test is conservative (), it might come as a surprise that 97% of the pairs of E. coli genomes tested had a significant D r (). This points to a weakness our method shares with all methods for detecting recombination that are based on the identification of clustered polymorphisms. These methods are sensitive to variations in the rate of mutation. This is the reason for the superiority of homoplasy-based methods including  w over cluster-based methods (). In the present study, we compared in particular the alignmentbased test statistic  w with our alignment-free test statistic D r. An important difference between them is that  w is applied to at least four aligned sequences, whereas D r compares unaligned pairs of query and subject sequences. In our example application the subject was always a single genome, but it could also consist of several concatenated sequences. Statistical tests exist independently of their implementations. However, to analyze simulated and experimental data, we rely on the tests' implementations, which may or may not be the best possible. With this proviso in mind, we computed  w using the published program Phi (), and D r using our new program rush. The program rush is always faster than the alignment step necessary for applying Phi. However, for sequences longer than 10 5 rush is even faster than Phi given an alignment (). Its ability to work without alignment makes rush not only fast, it also facilitates its application to genomes that are available only as sets of contigs. This is useful because genomes are increasingly published in this form rather than as fully assembled chromosomes. In our study, not aligning enabled us to efficiently search for the genome pair with the largest value of Q  s 2 = " X 2 , which was KO11 as query and K12_MG1655 as subject. The closest relative of KO11 is strain W. Together with strains K12, B and C this belongs to the select group of four E.coli strains classified as Risk Group 1 organisms; these are safe to use in the laboratory. It turns out that KO11 was engineered in 1991 from W to produce ethanol (). In the process, two chunks of DNA were transferred into what became KO11: three genes for ethanol production from Zymonas mobilis and 125 kb of the laboratory work horse E.coli K12_MG1655. These 125 kb comprise the uvrAmutL region of the K12_MG1655 chromosome. The 102 kb fragment we investigated starts inside the uvrA locus. In other words, we have picked up a region that was acquired from K12_MG1655 20 years ago. During these 20 years KO11 was serially transferred and evolved into KO11FL. We found that KO11FL had diverged more from its ancestor KO11 than from their common ancestor W. This was also reported by the team that sequenced KO11FL ().
CONCLUSIONOur fast method for detecting recombination from unaligned genomes is accurate when applied to simulated data. Applied to bacterial genomes, it diagnoses recombination too frequently, due to variation in mutation rate across long sequences. This is a weakness D r shares with other methods to detect recombination based on identifying polymorphism clustering (). Nevertheless, using the recombination measure Q, we discovered the strongest signal for the pair of E.coli genomes that had undergone an engineered 125 kb horizontal gene transfer 20 years ago.
ACKNOWLEDGEMENTThe authors are grateful to Paul Rainey for helpful comments.strain KO11 as query and the two strains K-12_MG165 and W1 as subject using the program alfy (Domazet-LosoLoso and Haubold, 2011). Regions where KO11 is most closely related to W1 are shown in light gray, regions closer to K-12_MG165 in black; query regions with no close homolog in the subject sequences are shown in white. The x-axis gives positions in megabase
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
B.Haubold et al. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
Test for recombination at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
DISCUSSION To make the most of genomic sequences, we would ideally use software that allows us to query them interactively. Our fast alignment-free test of recombination is intended as a step toward this goal. The program rush achieves its speed by using similar string-indexing techniques as applied in the genome-aligner MUMmer (Kurtz et al., 2004). The central feature of this approach to sequence analysis is that it is 'optimal' in the sense that in theory it runs in time linear in the length of the sequences analyzed. In practice, programs based on modern string-indexing techniques are fast and memory efficient (Puglisi et al., 2007). We have been interested for some time now in bringing the power of these algorithms to biology by combining them with modeling the distribution of shortest unique substrings (shustrings), which we take as proxy for the distribution of the distances to the next polymorphism (Domazet-LosoLoso and Haubold, 2009, 2011; Haubold et al., 2005, 2009;). In particular, in our previous derivation of an alignment-free estimator of genetic diversity we noted that the mean shustring length is sensitive to recombination (Haubold and Pfaffelhuber, 2012). Here, we have used the test statistic D r defined in Equation (2), which is based on the variance of the shustring length. Specifically, we compared its observed value, s 2 , with its expectation, " X 2. We tested the null hypothesis that D r  0 by deriving Vars 2  and constructing a parametric hypothesis test. This contrasts with the approach taken by the authors of Phi, our main point of reference: They test the null hypothesis of no recombination using a permutation test (Bruen et al., 2006). This was not an option for us because generating the null distribution of Fig. 8. Midpoint-rooted neighbor joining tree of 58 E.coli strains. The two genomes with the highest recombination measure Q, K12_MG1655 and KO11, are indicated by arrows Fig. 7. Comparing the run times of Phi and rush as a function of sequence length. =bp  0:01,  1000
B.Haubold et al. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from Conflict of Interest: none declared.
