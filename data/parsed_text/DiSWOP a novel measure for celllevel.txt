Motivation: New bioimaging techniques have recently been proposed to visualize the colocation or interaction of several proteins within individual cells, displaying the heterogeneity of neighbouring cells within the same tissue specimen. Such techniques could hold the key to understanding complex biological systems such as the protein interactions involved in cancer. However, there is a need for new algorith-mic approaches that analyze the large amounts of multi-tag bioimage data from cancerous and normal tissue specimens to begin to infer protein networks and unravel the cellular heterogeneity at a molecular level. Results: The proposed approach analyzes cell phenotypes in normal and cancerous colon tissue imaged using the robotically controlled Toponome Imaging System microscope. It involves segmenting the 4',6-diamidino-2-phenylindole-labelled image into cells and determining the cell phenotypes according to their proteinâ€“protein dependence profile. These were analyzed using two new measures, Difference in Sums of Weighted cO-dependence/Anti-co-dependence profiles (DiSWOP and DiSWAP) for overall co-expression and anti-co-expression , respectively. These novel quantities were extracted using 11 Toponome Imaging System image stacks from either cancerous or normal human colorectal specimens. This approach enables one to easily identify protein pairs that have significantly higher/lower co-expression levels in cancerous tissue samples when compared with normal colon tissue. Availability and implementation:
INTRODUCTIONTo understand cellular biology on a systems level, relationships between molecular components must be understood not only at a functional level but also localized in the spatial domain (). This is due to the fact that proximity of key proteins provides an indication of the possible existence of functional protein complexes. As a consequence, new bioimaging techniques have been recently proposed to visualize the colocation or interaction of several proteins in cells in intact tissue specimen. These include Matrix-assisted laser desorption/ionization (MALDI) imaging (), Raman microscopy (), Toponome Imaging System (TIS) (), multi-spectral imaging methods () and MxIF (). TIS is an automated high-throughput technique able to co-map up to a 100 different proteins or other tag-recognizable biomolecules in the same pixel on a single tissue section (). It runs cycles of fluorescence tagging, imaging and soft bleaching in situ. While colocation does not necessarily imply interaction, it has been consistently found that clusters containing particular proteins are found in specific sub-cellular compartments, hence allowing such a hypothesis to be generated (). Also, co-dependence between two proteins is a potential indication for an interaction that is not necessarily direct. TIS has a sub-cellular maximum lateral resolution of 206  206 nm/pixel (), which allows the determination of sub-cellular protein network architectures. The combination of proteomic information with spatial sub-cellular level topographical data has been termed 'toponomics' (). Biomarkers used in current clinical practice are limited to the simultaneous analysis of only a handful of proteins. Therefore, they fail to assess the true complexity of cancer, and the resulting biomarkers have a low prognostic value (). The capabilities of the TIS hold promise for developing a new generation of multiplex biomarkers (), which could aid the development of personalized medicine. Studying the protein interactions in cancer could uncover previously unknown mechanisms of tumour formation and could identify new potential drug targets in the form of protein interactions. It has been shown that TIS imaging can be used in cancer research for protein network mapping (). However, there is a need for new algorithmic approaches that analyze the co-expression patterns. The standard way to analyze TIS images is to apply a threshold to each image of the stack and thus reduce it to binary values (). However, while this step is straightforward and can be performed objectively (), by reducing the image to binary, a lot of potentially important information is *To whom correspondence should be addressed lost. Recently, such non-threshold methods have been presented (). These algorithms cluster molecular co-expression patterns on a pixel level and therefore lose the variation at a cell level. This can be crucial when analyzing cancerous samples due to the heterogeneity of cancer cells (). Furthermore, these algorithms are based on the raw expression levels, which are intensity dependent and hence may vary between different stacks. A similar approach is used in the Web-based Hyperbolic Image Data Explorer (WHIDE) (), which allows analysis of the space and colocation using a H2SOM clustering (). Although this tool is effective at identifying molecular co-expression patterns, the cellular structure is lost, and hence the method is unable to analyze the different cell phenotypes that may be present in the samples. More recently, focus has shifted towards cell-level analysis. One approach is to use K-median clustering to phenotype-segmented cells (). However, the conclusions in this study about pathways in colon cancer were drawn by only visual inspection of the phenotypes obtained and without considering any control samples. In another study (), cells were phenotyped after dimensionality reduction of their raw expression vector using t-distributed stochastic neighbor embedding (Van der). In this article, a new approach is proposed where the protein protein dependence profile (PPDP) is considered instead of the raw protein expression profiles. There has been evidence in the literature that despite the spherical and the exploratory cell states of rhabdomyosarcoma cells having identical average protein profiles, striking differences were found between the two states at the sub-cellular protein cluster level (). Hence, rearrangement, rather than up-or downregulation of proteins, is (or can be) the key to generating new cell functionalities (). This shows the importance of co-dependence of proteins rather than abundance on its own. Furthermore, we perform the analysis at cell level rather than pixel level, allowing for the cells to be phenotyped according to their PPDP. This enables us to gain a better understanding of the heterogeneity within the cancer cell population. Finally, two new measures are proposed to enable us to infer small-scale protein networks. These new measures highlight protein pairs that have different interaction in cancer and normal tissues and, hence, can be used as biomarkers to distinguish between different types of samples using protein co-dependence. To our knowledge, this is the first study of localized protein networks performed using multilabelling imaging techniques. An overview of the approach is presented in. Applying it to synthetically generated data gave the expected results, giving confidence in the new measures.
METHODS
Data and pre-processingThe image data used in this study were acquired using a TIS microscope () installed at the University of Warwick. Samples had been surgically removed from colon cancer patients. One sample was taken from the surface of the tumour mass, and another one was selected from apparently healthy colonic mucosa at least 10 cm away from the visible margin of the tumour. Two visual fields were manually selected in each tissue sample, resulting in four TIS datasets from a single patient. The results presented here were obtained by considering 11 samples6 healthy and 5 cancerous. A library of 12 antibody tags (see Supplementary Material for a list of criteria on how these were selected) was used based on recent findings (). Some of the tags are known tumour markers or cancer stem cell markers. These were CD133, CK19, Cyclin A, Muc2, CEA, CD166, CD36, CD44, CD57, CK20, Cyclin D1 and EpCAM. The stacks also included a 4',6-diamidino-2-phenylindole (DAPI) tag used to identify the cell nuclei. A previously presented protocol for sample preparation and image acquisition was used (). Background autofluorescence is digitally subtracted at an early stage. Hence, any remaining fluorescence should be true protein expression. In each of the stacks, the images were aligned using the RAMTaB (Robust Alignment of Multi-Tag Bioimages) algorithm (). This is done to prevent possible noise resulting from the slight misalignment of the multi-tag images obtained using TIS. This method has been shown to achieve sub-pixel accuracy of registering these data (). Then, if there are K tags, each having a corresponding image of size m  n, the data can be represented as a K  mn matrix:only nuclei may reduce the amount of cell available for analysis, but is comparatively unambiguous and can be used as a rough approximation of the cells. Details of the method and examples can be found in the Supplementary Materials. Segmentation resulted in 2945 cells being identified. The cell-localized protein expression values for each of the K proteins are collected in a protein expression matrix X c of the order K  N c for each cell c X c  x i, j j i, j   2 c   2 where c  fi 1 , j 1 , i 2 , j 2 , :::, i Nc , j Nc g denotes the set of pixel coordinates in cell c, N c  j c j denotes the number of pixels in each cell c and the vector x i, j  x 1 i, j , :::, x K i, j  is the expression levels of each tag at pixel i, j. In matrix form this is given by:
Proteinprotein dependence profileThe pairwise maximal information coefficient (MIC) () for each pair of proteins, localized to an individual cell c, is calculated to obtain the PPDP of the cell. We used this statistic, as it has been shown to capture a wide range of associations, both functional and not, and it gives similar scores to equally noisy relationships of different types (). Details of the way it is calculated can be found in the Supplementary Materials. For each cell c, a KK  1=2-dimensional vector c of pairwise MIC scores is obtained. The vector represents the PPDP of the cell and can be expressed aswhere i, j c 2 0, 1 is given by the MIC between rows i and j of the matrix X c. The PPDP for two sample cells from the same tissue specimen is shown in. Other co-dependence measures were also considered for the analysis. Pearson and Spearman correlations fail to capture non-linear relationships between protein expression profiles, which often occur because of the inhomogeneous structure of the cells. Mutual information and normalized mean expression values were also tested. However, each of these resulted in a batching effect where some phenotypes were predominantly located in a single, usually cancerous, sample (see Section 3 of Supplementary Materials). This seems biologically unlikely, as we expect that there should be some normal cells within the tumour tissue and that cancers share some common types of cells. These findings are consistent with the findings that functionality can be determined by colocation rather than changes in abundance levels (). The analysis was also performed using distance correlation (). The final results obtained were similar to the ones obtained using MIC (see Supplementary Materials). However, it has been found that the distance correlation has a strong preference for some types of dependencies and gives different scores at the same noise levels (). Therefore, the MIC is preferred due to its robustness to variations in the type of dependence.
Cell phenotyping based on localized PPDPThe vector c is the PPDP of the cell c and can be used to determine the cell phenotype using a clustering algorithm. Affinity propagation is a clustering method, which takes as input a matrix containing measures of similarity between pairs of data points. Real-valued messages are passed between data points until a high-quality set of exemplars and corresponding set of clusters gradually emerges (). We have used a Gaussian kernel based on the Euclidean distance between the protein co-dependence profiles of cells as an affinity matrix, so for a pair of cells a and b with PPDPs a and b , respectively, the a, b entry of the similarity matrix (for a 6  b) is given bywhere  max a, b jj a  b jj   =3 and jj  jj is the Euclidean distance. All diagonal entries of the matrix are set to equal the minimum value of the matrix. This means that each cell is equally likely to be a cluster centroid and results in a moderate number of clusters. We denote the number of cell phenotypes resulting from this approach by ^ C, which, in this instance, was found to be 41. An agglomerative hierarchical clustering () and Gaussian Bayesian hierarchical clustering () approaches with the same number of clusters were also considered. It was encouraging to see that these gave similar results, which are shown in the Supplementary Materials.
Proteinprotein co-dependence and anti-co-dependence measuresOnce the cell phenotype clusters have been obtained, an average PPDP S is calculated for each cluster S. For a protein pair i, j (with i5j K) i, j S is given byTo more objectively investigate the protein pairs that have higher dependency and are more frequent in cancer samples, a difference of weighted sums was calculated by considering the top N (here set to equal 5 or 10) dependency scores of the 10 most frequent phenotypes in each sample. The measure weights the dependency score with the phenotype probability in the sample, and sums all occurrences of the protein pair in all the cancerous samples and of all the normal samples. The sums are normalized by the number of samples. It then subtracts the score for the normal from the score for the cancer samples, hence giving a positive score if a pair appears more frequently and with higher dependency scores in the cancerous samples. More formally, if ^ S is the vector with the elements of S (lying in) sorted in descending order, p r S is the probability of phenotype S in sample r, S , r is the th most frequent phenotype in sample r, and M i, j S  i, j S , if i, j S is one of the first N elements of ^ S 0, otherwise ( 8. PPDP of two cells from the same specimen then the difference of the sum of frequency-weighted localized protein protein co-dependence values for a protein pair i, j, w i, j is given by:where is the set of cancerous samples and is the set of normal samples. A similar quantity of anti-co-dependence has also been considered by looking at the bottom N dependency scores, so we define ^ M i, j S  i, j S , if i, j S is one of the last N elements of ^ S 0, otherwise & 10 and use 1  ^ M i, j S instead of M i, j S to measure anti-co-location of protein pairs, i.e.Hence, we introduce two new measures called Difference in Sum of Weighted cO-dependence/Anti-co-dependence profiles, further referred to as DiSWOP [] and DiSWAP. Large positive values of DiSWOP indicate that the protein pair i, j is more co-dependent in cancer samples, whereas a low negative DiSWOP value means that the protein pair is more co-dependent in the normal samples. Similarly for DiSWAP, a large positive value suggests that the protein pair is more anti-co-dependent in cancer, and a large negative value suggests that the protein pair is more anti-co-dependent in healthy samples. The DiSWOP and DiSWAP scores are shown in. Various combinations of number of phenotypes and dependency scores were also considered. Altering the number of clusters caused little change to the results, as the phenotypes that were added or excluded have low probability in the samples. On the other hand, increasing the number of dependency scores considerably changed the protein pairs highlighted. However, if more than the top 10 scores are included, the average dependency score added to the analysis is 50.5, and so the proteins are more anti-codependent than they are co-dependent. Therefore, these scores should not be included as part of the DiSWOP measure. Further, biological validation and analysis of a greater number of samples is needed to determine the optimal number of dependency scores to be considered as part of the dependency measures.
Synthetic dataThe measures presented above were checked using synthetically generated data. Details of the algorithm for generating these data can be found in the Supplementary Materials. Initially, two samples were generated to correspond to one cancer and one normal tissue samples. The expression of five tags was simulated for each of these samples. Each of the samples contained $80 cells, which were randomly allocated to two different phenotypes per sample, with the first phenotype containing about onethird of the cells in the sample and the rest belonging to the second phenotype. Once the first tag was created, the rest of the tags were generated by keeping a fraction of the pixels the same as in tag 1 and assigning a random value to the rest. The fractions of pixels that were kept the same were as follows:where c gives the similarity in the 'cancer' sample and n in the 'normal' sample. Each column corresponds to a different phenotype, with the smaller phenotype in the sample being determined by the first column. A row j in the matrices in Equation (12) gives the similarity between tag 1 and tag j  1. Note that the order of pixels to be kept the same remains constant for a cell, so, for a phenotype S, the prescribed similarity between tags i and j (i, j41) is given by min i  1, S, j  1, S  . Examples of the images obtained for the 'cancer' sample are shown in. A larger simulation was run to test the power of the DiSWOP measure for discriminating between cancer and normal samples. This consisted of generating 30 samples with six tags and five initialized phenotypes for each sample type (see Supplementary Materials for details). The DiSWOP values were calculated on a training set of five cancer and five normal samples. The protein pair that gave the highest DiSWOP value was selected as a biomarker. Then, each sample in the test set was individually phenotyped and the DiSWOP values were calculated, treating the sample as cancerous in order to obtain non-negative scores. In the cancerous samples, the DiSWOP values for the selected protein pair had a mean of 0.28 and a standard deviation of 0.06, whereas in the normal samples, the values had a mean of 0.04 and a standard deviation of 0.04. Therefore, in this set of synthetic data, the DiSWOP measure provided an easy way to discriminate between the types of samples. In addition, it was encouraging to see that the phenotyping results were similar to the initialized phenotypes. Although most initialized phenotypes were subdivided into two or three phenotypes, this was expected with the synthetic data due to the large number of random pixel intensities introduced when generating the expression of the tags. Only $2% of the cells were misclassified by the affinity propagation clustering. samples were analyzed (). The protein interactions identified should be validated biologically once the method has been applied to a large number of samples. In fact, there are pathways involving some of the protein pairs highlighted, which have been found to play an important role in colorectal cancer (). The use of synthetic data, where the ground truth of the interaction of the tags is known, gives support to the proposed method. The DiSWOP and DiSWAP results for the data generated using Equation (12) are shown in. It can be seen that the measures gave the expected results. DiSWOP gave the largest positive value for tags 1 and 3 and the largest negative value for tags 1 and 2. This corresponds to the rows with greatest values in Equation (12). The smaller values of DiSWOP shown incorrespond to the second highest values in the matrices in Equation (12). The results for DiSWAP are also as expectedit has identified the tags with lowest similarity in each of the samples.(c) show DiSWOP values when considering the top 5 and 10 dependency scores, respectively. Here, a large positive value (shown in red) indicates that the protein pair is more co-dependent in cancer samples, whereas a large negative value (shown in blue) means that the protein pair is more active in normal tissue.(b) and (d) show DiSWAP values when considering the top 5 and 10 dependency scores, respectively. In this case, a large positive value (shown in red) indicates that the protein pair is more anti-co-dependent in cancer samples, whereas a large negative value (shown in blue) means that the protein pair is more anti-co-dependent in normal tissueshows a zoomed in section, highlighted in (b), of tag 1 (top), tag 3 (middle) and tag 5 (bottom). The two cells on the left side belong to the first phenotype, and the two cells on the right side to the second phenotypeThe framework presented here is novel, as it clusters the cells found in a sample, rather than the pixels, as in previous methods (). Hence, this method enables us to consider the heterogeneity of the samples. Using the MIC scores means that the PPDP is considered rather than the raw expression profile. Therefore, the method is independent of the intensity of the images, and hence different stacks can be considered simultaneously. Furthermore, it enables the identification of pairs of proteins that are more active in cancer cells than in normal cells, and vice versa. The approach has been developed for images obtained using TIS, but it can also be easily used for other multivariate imaging techniques, such as MALDI imaging (), Raman microscopy () and multispectral imaging methods (). The proteins used were not chosen because links between them were expected to show up in a protein network, but for a different scientific purpose, namely, to help identify cell type. For this reason, relatively few links were considered significant, although with a compensating chance that these links were previously unknown. In the future, we will use additional proteins, and we expect to find additional links. Previous works on exploring protein networks in colon cancer have used techniques like microarrays, which, unfortunately, destroy all anatomical details. The advantage of our approach is that the links in the protein network are found by studying individual cells. However, a disadvantage is that we are restricted to at most 100 proteins, whereas microarrays measure expression of thousands of genes simultaneously. The proposed measures could prove more useful once a membrane tag is used to help in a more accurate segmentation of cells. Many of the proteins considered are located in parts of the cell other than the nucleus, and these interactions are currently not fully taken into account. Furthermore, a study with an extended tag library may reveal more prominent dependencies specific to cancerous tissue. The binarization method () introduced the ideas of lead and absent proteins in motifs of protein clusters, where a lead protein is one that is present after binarization in all clusters and an absent protein is one that is not present in any of the clusters. These ideas in a way have been expanded by the DiSWOP and DiSWAP measures, which also identify colocation and anti-co-location, respectively. The quantities introduced here provide a measure of the degree, rather than a simple yesno classification, of the co-dependence of proteins. Furthermore, they overcome the fact that these proteins are found in both types of tissue by considering the difference between cancer and normal samples.
The Author 2013. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
1 where x k i, j is the expression level of protein k (k5K) at pixel i, j. In our experiments, K  12, m  1027 and n  1056. We recently proposed to perform cell segmentation of TIS stacks to restrict the analysis to cellular areas only (Khan et al., 2012). This ensures that signals from stroma and lumen are removed, as they can potentially add noise to the subsequent analysis. To follow best practice, one should segment entire cells, as some of the proteins observed are located in parts of the cells other than the nucleus, such as the cytoplasm, vesicles or the Golgi apparatus. However, this is challenging in cancerous tissues because of the variable orientation of cells due to disrupted tissue architecture, and a tag of the cell membrane was not used in this set of experiments to enable us to precisely identify entire cells. Instead, each image was segmented using a modified form of the graph-cut method (Al-Kofahi et al., 2010) applied to a DAPI channel (Khan et al., 2012). This was necessary to extract pixel locations of the nuclei and their immediate neighbourhood only, as the DAPI tag stains the DNA. Using Fig. 1. Overview of the proposed framework
DiSWOP for protein network analysis at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
V.N.Kovacheva et al. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
RESULTS AND DISCUSSION The results presented in Figure 3 suggest that it is, in fact, the combinations of protein pairs with high dependency scores that identify cancer cells, which is to be expected, considering the complexity of the system. Calculating the DiSWOP and DiSWAP measures identified pairs, which are significantly more co-dependent or anti-co-dependent in cancer samples than in normal tissue. As can be seen in Figure 3a and c, EpCAM and CEA have high positive DiSWOP score for both results. This may be due to the fact that both proteins are involved in cell adhesion [details of all the proteins considered have been previously presented (Bhattacharya et al., 2010)]. On the other hand, the pairs CD36 and CD57, and CD44 and EpCAM were more likely to interact in the normal tissue samples (Fig. 3a and c). These dependencies can be seen in the data. Figure 5 shows the expression levels of CEA, EpCAM and CD44 in a cancer and a normal sample. It is clear that protein expression in Figure 5a and b illustrate a higher dependence than in Figure 5d and e, whereas the expression patterns in Figure 5b and c differ more than those in Figure 5e and f. Similar trends can be seen in most of the other samples. Considering the DiSWAP measure also highlights some pairs of proteins such as CD44 and CD57 being more anti-codependent in cancer samples and Ck19 and CD133 in normal samples. It is important to note that these results were obtained using only 11 samples, which, while being a great improvement on previous studies in the toponomics of colon cancer (Bhattacharya et al., 2010, Humayun et al., 2011), is still insufficient to draw significant biological conclusions. To further analyze the consistency of the two dependency measures, the analysis was performed on 16 different combinations of three cancer and three normal samples. The results are shown in Figure 6 where it can be seen that the protein pairs with highest and lowest DiSWOP and DiSWAP scores are the same as the ones found when all 11
CONCLUSIONS We have introduced a novel method for analyzing multi-label image data such as the TIS image data. It is different from previously presented methods in that it considers the samples at cell rather than at pixel level, it is intensity independent and it allows phenotyping of cells based on their protein co-expression profile. Owing to the general nature of the framework, the method could be applied to other tissues and/or images obtained from other multivariate imaging techniques. We have presented two new measures of co-dependence and anti-co-dependence, namely, DiSWOP and DiSWAP. Applying these over a TIS dataset of 11 samples of cancerous and normal colon tissue, we have found combinations of protein pairs that are much more co-dependent or anti-co-dependent in cancerous than in normal tissue, pointing to the possibility that combinations of protein pairs rather than single proteins will lead to specific markers for cancer. The results presented here are only preliminary and need to be validated using a larger number of samples and subsequently by other biological techniques. Although the number of samples considered is insufficient to draw significant biological conclusions, this is the largest study of colon cancer using TIS conducted to date. Furthermore, checks using synthetic data give confidence that our novel measures can help identify and quantify important examples of co-dependence and anti-codependence of protein pairs.
