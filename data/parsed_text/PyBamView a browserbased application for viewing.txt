Current sequence alignment browsers allow visualization of large and complex next-generation sequencing datasets. However, most of these tools provide inadequate display of insertions and can be cumbersome to use on large datasets. I implemented PyBamView, a lightweight Web application for visualizing short read alignments. It provides an easy-to-use Web interface for viewing alignments across multiple samples, with a focus on accurate visualization of insertions. Availability and Implementation: PyBamView is available as a standard python package. The source code is freely available under the MIT license at https://mgymrek.github.io/pybamview.
INTRODUCTIONThe rapid growth of next-generation sequencing (NGS) technologies has led to a wide variety of short read DNA datasets. Manual inspection of sequence alignments is an important aspect of quality control. While the majority of NGS analyses have focused on single nucleotide polymorphisms (SNPs), recent bioinformatics advances allow analysis of more complicated variants, such as small insertions or deletions (), larger structural variants () and short tandem repeats (). Furthermore, widely used genome engineering techniques, such as the CRISPR-Cas9 system () can often produce a wide range of complex variants. In these cases, visualization of insertion and deletion events is a particularly critical analysis step. Current genome browsers, such as the UCSC Genome Browser () and the Integrative Genomics Viewer (IGV) (), offer visualization of alignments from SAM/BAM files across multiple samples and integration of many layers of genomics datasets. However, most existing tools have two important limitations. First, most are based on alignments to an ungapped reference sequence, which provides inadequate visualization of insertions. The SAM specification supports a padded reference, which captures multiple sequence alignment information and results in accurate insertion display by most browsers. However, most BAM files consist of pairwise alignments of short reads to a reference and do not use this feature. As a result, insertions are represented by an icon such as a vertical bar, which does not provide any visual information about the size or sequence of the inserted nucleotides. Second, the majority of alignment browsers are cumbersome to use, especially to visualize the large datasets typical of NGS experiments. They either require that the user upload large data files to a remote server or involve complicated installation and large resource requirements to run locally. Several alignment browsers, such as Bambino (), Consed () and the text-based SAMtools () tview, overcome these limitations: they display the sequence of insertions even when using the standard ungapped reference, and are run locally with relatively low system requirements. However, tview does not allow the user to view multiple BAM files at once, and none of these tools allow for exporting alignments as snapshots or for sharing alignments remotely through a Web browser. Here, I present PyBamView, a lightweight Web application for viewing alignments from BAM files. PyBamView provides alignment visualizations that accurately represent SNP, insertion and deletion events that can easily be exported to create publicationready figures. It runs locally from the command line with minimal resource requirements and displays alignments in a Web browser. This interface allows users to quickly view alignments locally and to easily share alignments with local or remote collaborators.
BASIC USAGE AND FEATURESPyBamView is a Python-based Web application that is run from the command line. Users provide PyBamView with a directory containing indexed BAM files and an optional reference genome in fasta format:the URL with remote collaborators or as a public resource. For instance, adding the options-ip 0.0.0.0-port 5000 will serve PyBamView over port 5000 via http. The Supplementary Text and program Web site contain a complete description of this feature. The Web browser displays a list of all samples contained in the BAM files provided. Users can select one or more samples to open in the genome-browser view. This consists of a reference track, followed by collapsible alignment tracks containing reads for each sample. While there is theoretically no limit to the number of samples analyzed, PyBamView can reasonably display five low to moderate coverage samples at once. Users can navigate to the genomic region of interest by entering the genomic coordinate into the search bar (e.g. chr1:10000). In the default view, base pair differences from the reference genome are highlighted, allowing easy identification of SNPs and potential sequencing errors (). A deleted base pair is indicated by a '.' in the alignment, and an insertion as a '.' in the reference sequence (). This allows easy visualization of the sequence and size of inserted bases, which is not currently possible with most alignment browsers (Supplementary). Users can zoom out up to 100 to easily visualize large insertions or deletions spanning hundreds or thousands of bases. Additional features are described in the Supplementary Text.
EXAMPLE USE CASESAlignment visualization is a critical step of any sequencing experiment. Here, I show three examples where PyBamView provides useful visualization of sequence variants. Use cases are not limited to these examples and can theoretically include any '-seq' experiment that can be represented by a BAM file. First, it provides accurate visualizations of different length insertions, such as different alleles of a tandem repeat (Supplementary). Furthermore, zooming out allows for visualization of large repeat expansions, such as a 60bp CAG expansion in Huntington's Disease (Supplementary, simulated 250bp reads). Second, it can be used to analyze variation across samples. This is useful in such analyses as comparing matched tumor versus normal samples or looking for mutations in affected versus non-affected individuals in disease genetic studies. Supplementaryshows example comparisons of individuals at a SNP, small insertion and a large deletion spanning several kb. Third, it can visualize complex mutations generated by genome engineering technologies such as CRISPR-Cas9 (). Dissecting these mutations requires adequate visualization of indels. An example alignment from a CRISPR library is shown in Supplementary.. PyBamView display of sequence variants. In each figure, the reference sequence is shown at the top followed by alignments of each read. Alignments were generated by PyBamView's PDF export feature. (a) Mismatches from the reference sequence, due to either SNPs or sequencing errors, are shown as highlighted bases. (b) Insertions are shown as gaps in the reference, which allows the length and sequence of the insertion to be easily visualized
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
IMPLEMENTATION PyBamView is implemented as a Python-based Web application using the Flask library. Alignments are processed using a Python backend, which then generates HTML, Cascading Style Sheets (CSS) and JavaScript files that are displayed in the Web browser. PyBamView takes advantage of BAM and fasta indexing to avoid loading large files into memory. It uses the pysam and pyfasta libraries for parsing BAM and fasta files, respectively. Both libraries use efficient index data structures, which allow them to quickly fetch data from specific genomic regions of interest. Read alignments are parsed from the CIGAR strings in the BAM file and are displayed as simple HTML tables as Scalable Vector Graphics (SVG) elements using Javascript. All CIGAR options reported in the SAM specification, including the padded reference option, are supported (Supplementary Fig. S5). 5 CONCLUSION As the use of NGS to analyze complex genomic events grows, there is a critical need for accurate and easy-to-use visualization tools. PyBamView provides a simple, yet powerful, interface for alignment visualization that facilitates collaborative data analysis.
M.Gymrek at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
PyBamView at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
