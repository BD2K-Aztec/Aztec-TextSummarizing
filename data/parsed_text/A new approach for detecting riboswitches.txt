Motivation: Riboswitches are short sequences of messenger RNA that can change their structural conformation to regulate the expression of adjacent genes. Computational prediction of putative ribos-witches can provide direction to molecular biologists studying riboswitch-mediated gene expression. Results: The Denison Riboswitch Detector (DRD) is a new computational tool with a Web interface that can quickly identify putative ribos-witches in DNA sequences on the scale of bacterial genomes. Riboswitch descriptions are easily modifiable and new ones are easily created. The underlying algorithm converts the problem to a 'heaviest path' problem on a multipartite graph, which is then solved using efficient dynamic programming. We show that DRD can achieve $88â€“99% sensitivity and 499.99% specificity on 13 riboswitch families.
INTRODUCTIONThe regulation of gene expression is a critical process that dictates the ability of cells to function properly, to establish cellular identity, and to respond to changes in environmental conditions. Gene regulation is manifested in a variety of ways, ranging from the action of transcriptional activators and repressors through cis-acting regulatory binding sites, DNA accessibility via chromatin structure, and localization of DNA within the cellular/ nuclear confines. In addition to these mechanisms, RNA has surfaced as a player in gene regulation (). Specific forms of RNA, such as microRNAs, small interfering RNAs and many others, have been identified and characterized as important components of gene regulation. One specific manner by which RNA molecules serve as regulators of gene expression is in the form of riboswitches. Riboswitches are short sequences ($50250 nt in length) located in the non-coding portions of specific messenger RNAs (mRNAs) that regulate the expression of the coding sequences contained within the mRNA (). They function via their ability to fold into distinct secondary structures that influence the ability of the mRNA to be transcribed, processed or translated. Riboswitches consist of two specific components: an aptamer region that binds to a specific organic molecule, often some type of metabolite; and an expression platform that produces a change in structural conformation as a result of binding to the aptamer (). The aptamer region is generally a highly conserved sequence, capable of binding to a number of organic molecules with high specificity (). Binding to the aptamer triggers changes in the intramolecular base pairing within the expression platform, leading to changes in secondary and tertiary structure of the RNA. The change in conformation in turn influences the ability of the mRNA to be expressed in a variety of different ways, depending on the specific riboswitch. The activation of some riboswitches results in premature termination of transcription, ending synthesis of the mRNA before the coding region. Others act by directly blocking translation of the mRNA by restricting access to the ribosomal binding site (). In eukaryotes, riboswitch folding may also influence expression via regulation of mRNA splicing. There are currently about 20 known families of riboswitches that bind to a variety of nucleobases, amino acids, metal ions and other organic compounds (). Many of the more extensively studied riboswitches serve as part of a feedback regulatory system for genes that participate in cellular metabolism (). The metabolites that bind to the aptamer serve as indicators of the relative activity of specific metabolic pathways, and upon binding, influence expression of genes that participate in the pathway. For example, certain genes involved in the synthesis of vitamin B 1 (thiamin) are regulated by a riboswitch that binds thiamin pyrophosphate (TPP), the biologically active form of thiamin. TPP binds to a conserved RNA sequence known as a THI-box, which represses transcription of genes possessing this sequence in the 5 0 untranslated region. The THI-box is a particularly intriguing example of a riboswitch, as it is found in a wide range of bacteria, archaea and eukaryotes and functions in a variety of contexts. The TPP riboswitch is the only known eukaryotic riboswitch identified to date (). Given the importance of riboswitches in gene regulation in the context of whole-genome regulation, methods to identify such sequences are needed. A variety of efforts have been previously *To whom correspondence should be addressed. undertaken to develop bioinformatics tools to predict the presence of riboswitches in RNA sequences (). Most programs that have been developed operate on the principle of sequence alignment to identify conserved sequences in previously identified riboswitches, coupled with RNA structural folding algorithms. Programs that are currently available are generally limited to the identification of a specific subset of known riboswitch types, and are only able to search modest sized sequence inputs. To date, few programs have been developed to take advantage of the abundance of completed full genome sequences. To address the need for riboswitch prediction on the wholegenome scale, we have developed a new computational tool with a Web interface that can identify putative riboswitches in DNA sequences, called the Denison Riboswitch Detector (DRD). DRD can quickly (typically 51 min) process complete bacterial genomes and achieve $90% sensitivity and almost 100% specificity. DRD's description of a riboswitch is simple and easily modifiable, based on the highly conserved motifs found in all known riboswitches. To identify an optimal sequence of short motifs, DRD transforms the search into a path-finding problem on a directed multipartite graph, which is then solved by an efficient dynamic programming algorithm. DRD can be accessed at http://drd.denison.edu. Researchers interested in using the program as a stand-alone tool may also contact the first author.
RELATED RESEARCHThere are three primary approaches currently used to detect riboswitches. The first approach compares conserved stem-loop features in the secondary structure, determined by an algorithm like mFold (). For example, RiboSW () and RegRNA () focus on the characteristic secondary structures of 12 different riboswitches. Riboswitch Finder () searches for the characteristic secondary structure of purine riboswitches. RNAMotif () defines a general descriptor language, allowing one to search for any desired structure. The second approach takes advantage of the fact that the aptamer regions of riboswitches are highly conserved for the metabolite that they bind to. Thus, it is possible to recognize motif sequences that are specific to a certain family of riboswitches. To detect a riboswitch, the input is first scanned for the motif sequence(s), and then the optimal secondary structure is predicted. If the predicted structure matches the known structure of the riboswitch, it may be considered a putative riboswitch. This approach is also incorporated into Riboswitch Finder () and the unpublished SequenceSniffer algorithm (). Motif search is used exclusively by RibEx (Abreu), which also searches for translational attenuators. The third, more recent, approach is to characterize a riboswitch family using a probabilistic model.consider using profile hidden Markov models and Infernal (), upon which Rfam () is based, uses a covariance model. RiboSW () also uses HMMER () after it performs a search for conserved structural characteristics. Our technique primarily falls into the second category. DRD is designed to be fast, working quickly on entire bacterial genomes, with conveniently modifiable definition files. Although this approach sacrifices some of the accuracy of the more comprehensive probabilistic models, it still achieves $90% specificity, compared with Rfam, in our comprehensive tests.
METHODSHere we will give an overview of our algorithm, followed by a more detailed description and a discussion of its implementation.
The DRD algorithmTo detect instances of a particular riboswitch with n known motifs in a long DNA sequence, we first break the sequence and its reverse complement into short overlapping segments of a few hundred nucleotides each. We assume that at most one riboswitch can occur in each segment. In each segment, we identify all matches for each of the n motifs. If at least one match is found for each motif, we then find the highest scoring sequence of matches in the segment that conforms to given ordering and spacing requirements. This step is accomplished by transforming the problem into a heaviest path problem on an n-partite graph, and using an efficient dynamic programming algorithm to find the best path. (This is described in detail in Section 3.2.) If such a path exists and its weight exceeds a given threshold, we then fold the corresponding putative riboswitch using mFold (). Finally, we align the resulting Vienna (dot-bracket) string, with motifs inserted to guide alignment, with a given consensus Vienna string. If the number of identities in this alignment exceeds another given threshold, we display the result with a graphical representation of its secondary structure. DRD accepts the following parameters describing a riboswitch: a maximum length of the riboswitch M; a segment length l and segment overlap length p ! M; n motifs m 1 ; m 2 ;. .. ; m n (may contain degenerate symbols); minimum motif identity scores (By 'identity score', we mean the number of nucleotide matches in a local alignment between a motif and a portion of the query sequence with the same length. An indel subtracts one from the score in the local alignment algorithm but is not counted in the final motif identity score.)maximum length of the riboswitch. For each segment, our approach consists of the following steps:(1) Use the SmithWaterman local alignment algorithm to locate, for each specified motif m i , all matches with identity score at least i. Indels subtract one from the alignment score. For the j th discovered match for motif m i , record both its starting position b i;j and its identity score s i;j ! i. If not all motifs are found, abort and continue with the next segment.(2) Construct a directed n-partite graph G=V; A in which each layer i contains a node v i;j for each match to motif m i found in the previous step. Connect a node v i;j in layer i to a node v i+1;k in layer i + 1 if b i+1;k 4b i;j and jm i j+d i b i+1;k  b i;j D i. Each node is given a weight equal to the associated motif's Smith Waterman identity score.(3) Find the maximum weight path hv 1;j1 ; v 2;j2 ;. .. ; v n;jn i from a node in Layer 1 to a node in Layer n, using a dynamic programming algorithm described below. If no such path exists, abort and continue with the next segment. Otherwise, this path corresponds to a subsequence containing matches to all the motifs, and its weight X n i=1 s i;ji is the sum of the identify scores of the corresponding motifs. If X n i=1 s i;ji ! S 1 , consider the subsequence between positions b 1;j1  D 0 and b n;jn +jm n j+D n to be a putative riboswitch. Otherwise, abort and continue with the next segment.(4) Optionally, check whether the putative riboswitch discovered in the previous step overlaps with any sufficiently long open reading frames (ORFs). If so, abort and continue with the next segment.(5) Fold the putative riboswitch using the mFold algorithm () and convert it to a Vienna string in dot-bracket notation.(6) Insert the discovered motifs into the Vienna string at their correct locations and perform a global alignment of the resulting Vienna string and the modified consensus string F 0. If the resulting identity score is at least S 2 , output the sequence as a putative riboswitch.(7) Also, for informational purposes only, perform a global alignment of the unmodified Vienna strings, convert the Vienna representations of both the putative and consensus riboswitches to shape notation (), and perform a global alignment of the two shape strings.With these matches, we construct the directed tripartite graph below. In the first layer are vertices representing matches for motif AAAA, in the second layer are matches for motif CCCC and in the third layer are matches for motif TTTT. Each vertex is connected to all vertices in the next layer corresponding to motifs between distance 2 and 20 downstream.
Heaviest path problemWe now wish to find a path connecting a vertex in Layer 1 with a vertex in Layer 3 with the maximum total vertex weight. The unique maximum weight path in this case is shown with dashed lines. This path corresponds to the subsequence indicated below with the chosen motifs still underlined.
GAAGCAACAGCGTTTCACCCCTGC AAAAGAGAGATAAGCCTCGGTCCC GGATATATGTATTCGAGAAGTTTT |fflfflfflfflfflfflfflfflfflfflfflfflfflfflfflfflfflfflfflfflfflfflfflfflfflfflfflfflfflfflfflfflfflfflfflfflfflfflfflfflfflfflfflfflfflfflfflfflfflfflfflfflfflfflfflfflfflfflfflfflfflfflfflfflffl ffl{zfflfflfflfflfflfflfflfflfflfflfflfflfflfflfflfflfflfflfflfflfflfflfflfflfflfflfflfflfflfflfflfflfflfflfflfflfflfflfflfflfflfflfflfflfflfflfflfflfflfflfflfflfflfflfflfflfflfflfflfflfflfflfflfflffl ffl}ACCCATAGThe heaviest path problem is solved using a dynamic programming algorithm based on the following recurrence. Let H i;j denote the weight of the heaviest path from a node in Layer 1 to node v i;j in Layer i. Then we can define H i;j recursively as follows:Then, we ultimately want the heaviest path, satisfyingThe associated dynamic programming algorithm has time complexity nm 2 , where m is the maximum number of matches for a motif.
Implementation as a Web toolWe implemented DRD as a multithreaded C++ program for the Linux operating system and placed it behind a PHP Web interface, shown in the top half of. The interface allows one to input a query sequence in FASTA format and choose one or more query riboswitch types. Each riboswitch is represented by a text definition file containing the parameters outlined in Section 3.1. Clicking on the name of the riboswitch displays the corresponding file. One may also supply their own definition file (or a modified version of one of the given files) by selecting the 'Other' option. Finally, one may opt to have the program disregard any motifs that overlap ORFs (by checking 'ORF Search?'). An ORF is defined to be a sequence of codons that starts with the start codon ATG and ends with one of three stop codons (TAA, TAG, TGA), with no stop codons in between. Only ORFs containing at least the number of codons given by the user in the 'Minimum ORF Length' box (120 by default) impact the search. The format of the description file is straightforward; one example is shown in. Line 1 contains the values of l and p. Line 2 contains n, the number of motifs, followed by a motif m i and its minimum identity score i on each of the following n lines. After the motifs (on Line 8 in the example in), are the maximum inter-motif distancesWhen Submit is pressed, work begins and a results window, describing the progress so far, appears for each selected riboswitch. The pages will refresh every 3 s, leading ultimately to the final results, like those in, listed in the order of motif identity score, then Vienna identity score. In our tests, matches to previously annotated riboswitches were virtually always displayed on top. Clicking on a result sets up a BLAST query. Below the alignments and scores, optimal and suboptimal secondary structures computed by mFold are displayed with the Rfam consensus image.
RESULTSWe tested DRD on 13 riboswitch families, using definition files derived from multiple sequence alignments of the families' Rfamdesignated seed sequences. These definition files may be viewed in Supplementary Table S1 or in the Web interface by clicking on the riboswitch name. For each riboswitch, we performed two types of tests. First, to obtain robust sensitivity results for each riboswitch family, we tested DRD on all known riboswitchsequences predicted for each family in the Rfam database at http://rfam.xfam.org. The sensitivity, or true-positive rate (TPR), is TP/(TP+FN), where TP is the number of true-positive findings, and FN is the number of false-negative findings. Second, to measure the corresponding false-positive rate (FPR) for each family in genome-scale sequences, we randomly selected a small number of Rfam-predicted riboswitch sequences and tested DRD on the set of GenBank sequence records in which they are contained. The false-positive rate is 1-specificity; specificity is defined to be TN/(TN + FP), where TN is the number of true-negative findings, and FP is the number of false-positive findings. We discuss each of these tests in detail below.
SensitivityWe used a specialized front-end program to test how well DRD detects Rfam-predicted riboswitches in isolation. The number of sequences assigned to a family in Rfam ranges from 356 (SAM-II) to 11 197 (TPP). For each riboswitch family, we set S 1 =0 in the definition file to ascertain the sensitivity over the full range of possible S 1 values. The results, displayed inand, show that, with the exception of the cobalamin riboswitch, we get a sensitivity of $90% or better for each riboswitch family when S 1 is set to be $95% of the maximum possible motif identify score. The data in the left half ofshow the detailed sensitivity results for the default values of S 1 in DRD. Higher values of S 1 allow for too little deviation from the given motifs, and therefore, the sensitivity drops off quickly. Sensitivity for the cobalamin riboswitch on the full set of 9056 Rfam sequences reaches a maximum of $83%. However, sensitivity for the smaller set of 430 seed sequences easily exceeds 90%. Looking at the multiple sequence alignment for the full set of cobalamin riboswitch sequences reveals much less consensus than the seed sequences, especially at the 5 0 end. We find that, upon closer inspection, when DRD fails to identify an Rfam-predicted riboswitch, it is commonly due to missing one or two identities in one or two motifs. By reducing individual minimum motif identity scores i and the value of S 1 , we can easily generate higher sensitivity values. However, we also found that this will result in much lower specificity values when DRD is applied to genome-scale input files. We discuss these results next.
SpecificityTo contextualize these sensitivity results, we would ideally compute corresponding specificity values for every GenBank sequence record containing an Rfam-predicted riboswitch. Because this is infeasible, we instead estimated sensitivity by randomly selecting a small set of Rfam-predicted sequences from each riboswitch family and running DRD on their corresponding GenBank sequence records. For each family, we selected records that covered at least five organisms and totaled at least 12 million nt. In the case of three riboswitch familiesflavin mononucleotide (FMN), purine and TPPwe conducted tests on a larger set of 30 GenBank records. To derive specificity values over a range of S 1 values, we set S 1 to be three less than the maximum possible identity score for each family. Because DRD searches for a riboswitch in each segment, we considered each segment to be an individual trial. If a segment contained a riboswitch that has been annotated in either Rfam or GenBank, it was considered a true positive when DRD detected the riboswitch and a false negative otherwise. If a segment did not contain an annotated riboswitch, it was considered to be a false positive when DRD detected a riboswitch and a true negative otherwise. We note that this may not be a perfect classification because either (i) a segment may actually contain a previously unannotated riboswitch or (ii) two overlapping segments may both contain the same annotated riboswitch, but DRD will report only one hit. In the first case, the reported specificity may be too low. In the second case, the reported specificity will be too high. However, because the number of annotated riboswitches is so small relative to the number of segments, these errors are negligible. Our results, displayed inand, show that DRD achieves very high specificity while generally maintainingshow the detailed specificity results for the default values of S 1 in DRD. The raw data for these experiments can be found in Supplementary Tables S2S14.
Other observationsWhile we found that the default ORF threshold length (120 codons) worked well for a variety of inputs, we also found that, in some cases, especially with cobalamin and ykkC-yxkD, it was necessary to increase the ORF threshold to locate a riboswitch reported by Rfam. Some examples of this are annotated in Supplementary Tables S2S14. In many cases, increasing the ORF threshold did not introduce many more false-positive results, but in a very few cases it did. Because DRD defines the ends of its reported riboswitches with respect to distances on either side of the first and last motif (D 0 and D n , respectively), the accuracy of these predicted positions is better when there are defined motifs close to the 5 0 and 3 0 ends. Because this is true in almost all of the tested families, the bounds reported by DRD are very close to those in Rfam. One exception is the cobalamin riboswitch. While a multiple sequence alignment of the cobalamin seed sequences predicts a well-conserved short GGT motif near the 5 0 end, we eliminated this motif from our definition file because it resulted in an even lower hit rate for the full set of sequences. (An inspection of the multiple sequence alignment for the full set of sequences reveals significantly more variability than the seed sequences and no clear consensus on the 5 0 end.) The leaves the first motif 4050 bases from the 5 0 end, resulting in more variability in the predicted 5 0 boundary. To detect glycine riboswitches, which tend to appear as two similar structures in tandem, DRD must have contiguous segments overlap significantly. Therefore, in our definition files, we set each segment length to be 150, with a 140 bp overlap, resulting in a 150 bp 'window' that shifts down by 10 bp in each iteration. This significantly slows the search, but it still completes within a few minutes on genome-scale sequences.compares the functionality of DRD with some other recently developed riboswitch search tools discussed in Section 2. As discussed previously, DRD is able to scan genome-scale files for riboswitches, whereas other tools have relatively constraining input size limits. Like RiboSW (), DRD also allows a user to define new riboswitch definition files, but the format of DRD's files is significantly more straightforward. We compared the sensitivities of DRD and RiboSW () on all riboswitch families but SAM-IV, which RiboSW does not consider. For the purine riboswitch, we also compared the sensitivities of DRD and Riboswitch finder (). We chose to omit RibEx because a similar comparison with RiboSW was already undertaken byFor these comparisons, we randomly selected up to 50 Rfam seed sequences for each family. If the number of seed sequences was 550, we used the entire seed set. We chose to test on this reduced set because of RiboSW's size constraints and computation times. The results, summarized in, show that DRD's sensitivity at least rivals that of RiboSW for all riboswitch families, and significantly exceeds it in four cases (glycine, TPP, ykkC-yxkD and yybP-ykoY) (For TPP and ykkC-yxkD, we used the most favorable results for RiboSW over four random sets to validate these more significant differences.). Over all sequences, RiboSW achieves sensitivity of 0.85, whereas DRD achieves sensitivity of 0.95. Overall, there were 12 instances in which RiboSW detected a riboswitch that was not detected by DRD, and 64 instances in which the opposite was true. Complete results can be found in Supplementary Tables S15S26. Because of the input size constraint and the different way in which RiboSW searches a sequence, it was not possible to compute comparable specificity values for RiboSW. Such a comparison was omitted byas well. In conducting this comparison, we found the response time of RiboSW to be mostly comparable with that of DRD on inputs with similar sizes (but searches for a single cobalamin riboswitch sometimes took up to a few minutes). RiboSW's limited input size prevented comparisons on larger inputs.
Comparison with existing tools
CONCLUSIONSWe have designed a new Web-based tool for identifying putative riboswitches on a whole-genome scale. To efficiently identify high-quality strings of short conserved motifs, DRD transforms the problem into a heaviest path problem on a directed multipartite graph and solves the transformed problem with an efficient dynamic programming algorithm. We have shown that this technique is both fast and can achieve relatively high sensitivity and specificity. There are several directions that could be pursued in the future to improve DRD. First, we could enhance our motif model to. Test results illustrating the relative sensitivity (TPR) of each tool
The Author 2014. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
; 2 ;. .. ; n , where i is the score corresponding to motif m i ; maximum inter-motif distances D 0 ; D 1 ; D 2 ;. .. ; D n , where D i , i=1; 2;. .. ; n  1, is the maximum distance between motifs m i and m i+1 , and D 0 and D n are distances on the 5 0 side of the first motif and the 3 0 side of the last motif, respectively, that are used to define the 5 0 and 3 0 boundaries of a reported riboswitch; minimum inter-motif distances d 1 ; d 2 ;. .. ; d n1 , where d i , i=1; 2;. .. ; n  1, is the minimum distance between motifs m i and m i+1 ; minimum total motif identity score S 1 ! X n i=1 i ; consensus secondary structure representations F and F 0 (in Vienna notation), where F is the consensus secondary structure, and F 0 is the consensus secondary structure with motifs inserted in their appropriate locations; and minimum total Vienna identity score S 2. DRD begins by cutting the input sequence and its reverse complement into short segments of l (% 7001000) nucleotides that overlap each other in p (% 200) nucleotides. The overlap length should exceed the expected
A new approach for detecting riboswitches at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
J.T.Havill et al. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
J.T.Havill et al. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from include site-specific characterizations of motifs, akin to a profile hidden Markov model, with a likely increase in computation time. Second, we could consider replacing our somewhat crude method for secondary structure in comparison with an alternative method, such as that used by Macke et al. (2001). Funding: This work was performed by C.B., S.M.J. and J.D.S. while they were students at Denison University. Conflict of Interest: none declared.
