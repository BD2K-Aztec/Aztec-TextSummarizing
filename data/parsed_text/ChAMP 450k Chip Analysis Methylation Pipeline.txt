The Illumina Infinium HumanMethylation450 BeadChip is a new platform for high-throughput DNA methylation analysis. Several methods for normalization and processing of these data have been published recently. Here we present an integrated analysis pipeline offering a choice of the most popular normalization methods while also introducing new methods for calling differentially methylated regions and detecting copy number aberrations. Availability and implementation: ChAMP is implemented as a Bioconductor package in R. The package and the vignette can be downloaded at
INTRODUCTIONDNA methylation is the most studied epigenetic modification. Changes in DNA methylation patterns have been implicated in the development of a number of diseases and have been defined as a major hallmark of cancer (). Technological developments for the genome-wide detection of DNA methylation have grown rapidly in recent years, and several options exist (). Although bisulphite conversion combined with next-generation sequencing is the most comprehensive approach, it is currently feasible for only small sample sizes, and application to large-scale studies remains challenging. The Infinium HumanMethylation450 BeadChip (www.illumina.com) offers this rapidly moving field an attractive balance with respect to throughput, coverage and cost. It extends the previous 27k array, providing an assessment for 4480 000 CpG loci, covering key features of the human genome, including CpG islands, shores and shelves as well as promoters, gene bodies, intergenic and imprinted regions (). Based on Pubmed and GEO submissions, the 450k array has established itself as the platform of choice for epigenome-wide association studies (). The challenge with this new technology is in the analysis.There are several important steps a 450k analysis pipeline should include: normalization, batch effect analysis, single nucleotide polymorphism (SNP) flagging, detection of copy number aberrations (CNAs) and segmentation of methylation variable positions (MVPs) into biologically relevant DMRs. Normalization is especially important, as the 450k platform combines two different assays, Infinium I and Infinium II (). A number of normalization methods are now available that deal with this issue in slightly different ways (). In chronological order of development, they are Peak Based Correction (PBC) (), SQN (), Subset-quantile within array normalisation (SWAN) () and Beta-mixture quantile normalization (BMIQ) ().
DESCRIPTIONThe Chip Analysis Methylation Pipeline (ChAMP) package is a pipeline that integrates currently available 450k analysis methods and also offers its own novel functionality. It is implemented in R and can be run on any platform with an existing R (version 43.0) and Bioconductor installation. ChAMP takes the raw IDAT files as input, using the data import, quality control and normalization options offered by minfi (). By default, raw data are filtered for probes with a detection P40.01 in at least one sample. If raw data are not available, users are able to upload a matrix of M-, beta-or raw intensity values. The user can decide to filter out individual probes or probe sets such as the X and Y chromosomes. An option to filter SNPs based on a user-specified minor allele frequency in one of four populations as defined by the 1000 genomes project (The 1000) is also available. This prevents biases due to genetic variation in downstream statistical analyses aimed at identifying differentially methylated CpGs. The batch effect analysis is performed on raw data and can be more thorough if the user provides additional covariate information available for the particular study (i.e. age, gender, etc). Following preprocessing, subsequent steps include normalization, DMR calling and CNA detection, which are illustrated inand described in more detail later.
Adjustment for type2 biasAfter running basic quality control metrics, it is recommended to perform intra-array normalization to adjust the data for bias introduced by the Infinium type 2 probe design. ChAMP offers a choice of four methods that have recently been developed specifically for 450k data. As default, ChAMP implements BMIQ *To whom correspondence should be addressed.(), which was identified by, as an effective method. The user can also select SWAN (), PBC () or no normalization.
Batch effectsTo assess the magnitude of batch effects in relation to biological variation, singular value decomposition is applied to the data matrix to obtain the most significant components of variation (). A heatmap rendering the strength of association between the principal components and technical/ biological factors allows the user to easily visualize whether batch effects are present. If present, there is an option within ChAMP to use ComBat to correct for these effects ().
MVP and DMR callingFor MVP calling, ChAMP uses the Bioconductor package Limma () to compare two groups. The MVP calling can be performed on M-or beta-values.recommend that M-values be used for small sample size studies (510 samples per phenotype). As DNA methylation is highly correlated for up to 1000 bases (), unidirectional MVPs can be grouped into biologically more relevant DMRs as implemented by (). ChAMP incorporates a novel DMR hunting algorithm 'probe lasso' that considers annotated genomic features and their corresponding local probe densities and methylation according to (). Probe lasso (Butcher unpublished) varies the requirements for nearest neighbour probe spacing in a given region based on the genomic feature to which the probe is mapped. The appropriate-sized lasso is then centred on each significant CpG probe and retained if the lasso captures an additional minimum user-specified number of significant probes.
CNA analysisFinally, ChAMP integrates a method for analyzing 450k intensity values to identify CNAs in a given dataset (). This has the advantage of getting 'two for one' analyses of the same sample, which is particularly important in the context of cancer where tumour heterogeneity is a major confounding factor unless the exact same sample is used. The resulting CNA analysis has been compared with SNP data and been shown to yield comparable results ().
DISCUSSIONThe bottleneck for researchers using the 450k platform as part of systems and disease-oriented projects is the need for an integrated analysis pipeline. We have addressed this need by developing ChAMP and making it publicly available. ChAMP incorporates already published and novel tools and complements existing 450k analysis pipelines such as Illumina Methylation Analyzer (), RnBeads () and wateRmelon (), providing users a choice for their analyses. The advantage of ChAMP is that it offers three additional methods for the analysis of batch effects, DMR calling and CNA detection over and above the standard functionalities. ChAMP has been tested on studies containing up to 200 samples on a personal machine with 8 GB of memory. For larger epigenome-wide association studies, the pipeline requires more memory, and running it in steps as described in the vignette can break up the time requirements.An integrated map of genetic variation from 1,092 human genomes. Nature, 491, 5665. Touleimat,N. and Tost,J. (2012) Complete pipeline for infinium((r)) human methylation 450k beadchip data processing using subset quantile normalization for accurate DNA methylation estimation. Epigenomics, 4, 325341.IMA: an R package for high-throughput analysis of illumina's 450k infinium methylation data. Bioinformatics, 28, 729730. Zhuang,J. et al. (2012) A comparison of feature selection and classification methods in DNA methylation studies using the illumina infinium platform. BMC Bioinformatics, 13, 59.
The Author 2013. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
k Chip Analysis at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
T.J.Morris et al. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
