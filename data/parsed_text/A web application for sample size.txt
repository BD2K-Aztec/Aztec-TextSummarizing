When designing a case-control study to investigate differences in microbial composition , it is fundamental to assess the sample sizes needed to detect an hypothesized difference with sufficient statistical power. Our application includes power calculation for (i) a recoded version of the two-sample generalized Wald test of the 'HMP' R-package for comparing community composition , and (ii) the Wilcoxon-Mann-Whitney test for comparing operational taxonomic unit-specific abundances between two samples (optional). The simulation-based power calculations make use of the Dirichlet-Multinomial model to describe and generate abundances. The web interface allows for easy specification of sample and effect sizes. As an illustration of our application, we compared the statistical power of the two tests, with and without stratification of samples. We observed that statistical power increases considerably when stratification is employed, meaning that less samples are needed to detect the same effect size with the same power. Availability and implementation: The web interface is written in R code using Shiny (RStudio Inc., 2016) and it is available at https://fedematt.shinyapps.io/shinyMB. The R code for the recoded generalized Wald test can be found at https://github.com/mafed/msWaldHMP.
IntroductionA pivotal aspect of planning a case-control study is the calculation of sample sizes, which is typically based on the costs of data collection and on the need to have sufficient statistical power for detecting a relevant difference between cases and controls. Power can only be computed if the researchers can specify: (i) the smallest relevant deviation from the null hypothesis that is to be detected at some specified significance level, and (ii) a realistic guess of the variability in the sample. We model microbiome data with the Dirichlet-Multinomial (DM) distribution. It is described by two parameters: the overdispersion parameter (h) which measures the within-sample excess of variability w.r.t. a multinomial distribution; and the vector of relative abundances (p). Depending on the research question each element of p refers to a single Operational Taxonomic Unit (OTU) or to a species, genus or any other rank in the microbial taxonomy. In many microbiome studies the null hypothesis can be expressed as H 0  p 1  p 2 , where the indices 1 and 2 refer, respectively, to the controls and cases. The null hypothesis thus expresses equality of community composition. () proposed to test this null hypothesis with the generalized Wald test of Koehler and Wilson (1986). For other applications researchers are interested in differential abundance for k 1 specific OTUs. The null hypotheses of interest are then H 0 : p 1j  p 2j , j  1,.. .k, where the index j refers), as well as the non-parametric Wilcoxon-Mann-Whitney (WMW) test, but correcting for multiple testing is required. It is usually hard to specify the smallest relevant deviation from H 0 , particularly when the p-vectors are large. In the web application, p 1 (controls) is specified by the user in an interactive way with several possible choices, while p 2 (cases) is based on p 1 with some user-selected OTUs showing a modified relative abundance (referred to as the 'requested' OTUs). For the other OTUs (referred to as the 'unrequested' OTUs) the relative abundances are altered to make the entries in p 2 add up to 1. It is also possible to estimate p 1 and h from user-uploaded data. For ease of presentation both vectors p 1 and p 2 are ordered according to the decreasing order of relative abundances in p 1. Our application allows the simulation-based statistical power to be computed either for a specific pair of sample sizes (balanced or not, named 'Power Option 1' in the application), or for a range of sample sizes (only balanced, named 'Power Option 2' in the application). Powers for both the generalized Wald test for comparing community composition and the WMW test for comparing relative abundances of specific OTUs are implemented. Sometimes biological samples can be classified into strata. A multicenter trial is a typical example, but stratification may also arise when age, gender or any other baseline information is used in the design stage to account for population heterogeneity. Power calculation for stratified designs is also implemented in the web application, and we illustrate its use with enterotypes as strata. Enterotypes can be described as microbiome profiles to which a sample can be said to belong; more details on the topic can be found in. Although enterotypes have to be used with care as a stratification factor (they can only be identified after sequencing), power calculations are still correct as long as differences between cases and controls are not confounded by the enterotype. Moreover, over-sampling may be needed to ensure that the required number of subjects is acquired in the least frequent stratum, or when accounting for drop-out during the study.
Methods and implementationPowers are calculated by means of a Monte Carlo approach in which, for given sample sizes, data of k OTUs are randomly generated from a DM distribution with the parameters specified in the interface. The total numbers of reads (library size) are randomly drawn with replacement from the library sizes observed in the HMP data ('stool' is default, but user can change it). For testing equality of community composition the generalized Wald test gives a single P-value. Hence, its power is computed as the average number of rejections among the Monte Carlo-generated datasets. The WMW test, instead, is applied to each OTU individually and the resulting P-values are multiplicity adjusted with themethod, so as to control the False Discovery Rate. Here two quantities are reported: (i) the average number of times there was at least one rejection among the requested OTUs (requested by the user to be differentially abundant between the two groups), and (ii) the average power among the requested OTUs. The latter is interpreted as the expected power for an arbitrary requested OTU. In case of stratification, since observations of different strata are mutually independent, the generalised Wald test can be performed for each stratum individually, and then the single-stratum statistics may simply be summed to form the overall test statistic. As each single-stratum test statistic asymptotically has a v 2 null distribution, the overall one has also a v 2 null distribution, with degrees of freedom being the sum of the individual degrees of freedom. The same construction is used for combining the WMW test statistics (sum of squared standardized WMW statistics). Shiny () was introduced by RStudio for developing interactive web applications from within R (R Core). It is mainly composed of two files: ui.R, in which the user interface is defined, and server.R that contains scripts producing the outputs. The generalized Wald test of the HMP package () has been recoded to speed up computations, whereas for the WMW test we employed the 'wilcox.test' function of the standard R installation. The web page is divided in two sections: a sidebar on the left, where all parameters can be set, and the main page, which is further divided into tabs. The user can specify: stratification ('yes' or 'no'); the 'Shape' of p 1 with several choices, including all body sites from the HMP ('Stool' is the default), and possibility to use user-uploaded data; the number of OTUs to be considered (k); the h parameter (only if 'Shape' is one of the theoretical ones; for HMP body sites and for user-uploaded data h is estimated); two sets of requested OTUs for which relative abundances in p 2 are modified relative to p 1 with a user-specified percentage for each of the two sets of OTUs; the number of Monte Carlo runs used for power calculations; the significance level (a); sample sizes of the two groups (for 'Power Option 1'); range of sample sizes for the power vs. sample size graph ('Power Option 2'); include or not the WMW test. A PDF report with all inputs and outputs of the application can be downloaded, including a list of the requested OTUs
ResultsUsing HMP stool samples data, we compared the powers of the generalized Wald test (a  0.10) with and without stratification by enterotype. The sample size was set to 40 in both groups. The four most abundant OTUs of p 2 were set 20, 20, 40 and 40% higher than those in p 1. The resulting power was much larger for the stratified Wald test, going from 0.008 without to 0.393 with stratification. The power of the WMW test went up from 0.145 to 0.94. These results were based on 1000 Monte Carlo simulations.
at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
F.Mattiello et al. at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
