flowDensity facilitates reproducible, high-throughput analysis of flow cytometry data by automating a predefined manual gating approach. The algorithm is based on a sequential bivariate gating approach that generates a set of predefined cell populations. It chooses the best cutoff for individual markers using characteristics of the density distribution. The Supplementary Material is linked to the online version of the manuscript. Availability and implementation: R source code freely available through BioConductor
INTRODUCTIONFlow cytometry (FCM) is the predominant technique used to identify and quantify the widest variety of cell types. However, it is widely recognized that FCM data analysis, primarily in the identification of clusters of homogenous cells in high dimensional space, has become a rate-limiting step in application of the technology. Researchers currently use a manually intensive and subjective process of serial inspection of one or two characteristics (dimensions) at a time (a process termed 'gating'). There is widespread demand for the development of software tools as the ability to organize, analyze and exchange FCM data is lagging far behind the ability to run samples, to the detriment of health research (O'). One reason that end-users are still relying on manual analysis is the absence of a systematic way to formulate and transfer their expert knowledge to automated software in order to provide satisfactory results on hard to gate cell populations. Although unsupervised clustering algorithms have been developed for FCM data, they often fail to replicate a human expert's gating results due to their generalized, global approach and often return as a result of a number of clusters that cannot be interpreted readily without more sophisticated cluster matching methods (). Supervised approaches have also focused on setting global parameters that are difficult to appropriately set for all clusters and requiring tuning of parameters that are not linked to researchers' biological understanding of the data (). To address these issues, we developed flowDensity, an automated gating approach that emulates an expert's sequential 2D gating strategy to identify predefined cell populations using a sequential bivariate gating algorithm. The innovation of our approach is to use customized threshold calculations for different cell subsets, based on expert knowledge of hierarchical gating order and 1D density estimation. Using this approach, cell populations can be defined once using a gating strategy as a guide, which also enables clusters to be easily compared across samples.
APPROACHflowDensity estimates the region around cell populations using characteristics of the marker density distribution (e.g. the number, height and width of peaks and the slope of the distribution curve). Parameters can be adjusted on a population-specific basis when extra information is given by a user (e.g. desired percentile cut-off, number of standard deviations from the peak). To pick the proper threshold for each marker within each sample, flowDensity first finds all the peaks (p=1; 2;. .. n) in the density distribution.(1) If p = 1, the position of threshold can be determined by tracking the slope of density for a drastic change. Percentiles, standard deviation and FMO controls can be used when given as extra information.(2) If p = 2, the position of threshold is the minimum intersection point between the two peaks on the density curve, unless forced to use methods above (e.g. percentiles, slope changes)., for each peak, it calculates the height of the peak h and its distance from the next adjacent peak d and calculates the score d h. It then finds the peak corresponding to the maximum of all computed scores and chooses this peak and its next adjacent and goes to the case p = 2. *To whom correspondence should be addressed. y The authors wish it to be known that, in their opinion, the first two authors should be regarded as Joint First Authors.
Gating rare cell populationsTo address the challenge of identifying rare cell populations, flowDensity determines whether the slope of the curve of the density distribution along sections of the curve drops below a threshold. In rare cases where the slope varies slowly, a percentile of the density distribution (default 90th) is used as the threshold. If the spread of the density distribution is mostly around the mean (i.e. the standard deviation is small relative to the mean), then slope tracking tends to returns better results than percentile (). If neither of these techniques are able to set a proper threshold, the peak value plus a multiplier of the standard deviation is chosen as the threshold. However, the user can also modify this decision by setting parameters specifically for the challenging cell populations.
Utilizing control samplesflowDensity can accept control data for each channel used in gating (). When a control sample is included, the gating threshold is calculated based on the control population.
RESULTS AND DISCUSSIONflowDensity's completely automated results match that of expert users when it was possible to set cell population boundaries in a data-driven manner (). For those cell populations where additional information is required to set the cell population boundaries according to those chosen by the user, thresholds are set based on the information (). When no additional information is given or the population of interest is really small (0.04% for a typical FCM data with 300 000 events), flowDensity might fail to identify a proper gating due to misleading kernel estimation. flowDensity performs well in the range of human variation and is close to the average of humans (). We also compared the flowDensity result with state-of-the-art supervised and unsupervised FCM analysis tools. Only flowDensity identified the correct populations, even though the number of clusters was given as input and parameters were extensively adjusted (and Supplementary Material). This success lies in the approach, which does not identify all populations by examining all dimensions simultaneously like typical clustering algorithms. Rather it can be seen as a sequential algorithm that automates a 2D traditional gating scheme in a data-driven manner highly suited to targeted investigations such as clinical trials identifying predefined cell populations. The catch is customization, does have to be performed once for each marker panel which is simplified since flowDensity is integrated into the opencyto framework ().
The Author 2014. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
flowDensity at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
