Motivation: This article presents Thresher, an improved technique for finding peak height thresholds for automated rRNA intergenic spacer analysis (ARISA) profiles. We argue that thresholds must be sample dependent, taking community richness into account. In most previous fragment analyses, a common threshold is applied to all samples simultaneously , ignoring richness variations among samples and thereby compromising cross-sample comparison. Our technique solves this problem, and at the same time provides a robust method for outlier rejection, selecting for removal any replicate pairs that are not valid replicates. Results: Thresholds are calculated individually for each replicate in a pair, and separately for each sample. The thresholds are selected to be the ones that minimize the dissimilarity between the replicates after thresholding. If a choice of threshold results in the two replicates in a pair failing a quantitative test of similarity, either that threshold or that sample must be rejected. We compare thresholded ARISA results with sequencing results, and demonstrate that the Thresher algorithm out-performs conventional thresholding techniques. Availability and Implementation: The software is implemented in R, and the code is available at
INTRODUCTIONThis article presents a new peak thresholding algorithm called 'Thresher' that treats samples and replicates independently, taking their richness into account. We will demonstrate that the Thresher algorithm (and the software of the same name that implements it) offers improved performance over previous approaches to thresholding. DNA profiling or fingerprinting techniques are essential to microbial ecology. For example, automated rRNA intergenic spacer analysis, or ARISA (), and terminal restriction fragment length polymorphism, or T-RFLP (), are widely used. These techniques depend on fluorescent-labeled DNA fragments, discriminating the sizes of fragments present in a sample. Analysis profiles are typically run in replicates.When analyzing ARISA or T-RFLP electropherogram profiles, instrument noise and sample noise are typically present. Instrument noise refers to artifacts produced by the instrument and is usually removed by applying a conservative minimum peak height threshold to the raw electropherograms (). Sample noise, in contrast, refers to false peaks that can result from Polymerase Chain Reaction (PCR) artifacts or sample contaminants, and is normally dealt with by applying an additional threshold based on the percentage of total amplified DNA. It is particularly important to set such thresholds carefully when techniques based on the presence or absence of peaks are to be used in the subsequent analyses (), as presence/absence analyses disproportionately weight weak peaks. We argue that the threshold used to eliminate sample noise must be sample dependent. In past works, such thresholds have typically been applied across a whole sample set, treating all samples identically (). The normal procedure in ARISA data reduction is to standardize data, allowing for more direct comparison of samples with one another. Each standardized peak height gives the percentage of the total counts of peaks for that replicate or sample. This procedure is particularly important when ARISA runs differ in their peak intensity. In most previous ARISA processing procedures, a common threshold is applied to all samples after standardization. However, a problem can arise when cross-comparing standardized samples to which a common threshold has been applied, because such a comparison ignores richness variations among samples. Samples with similar peak heights but different richness can be standardized to dramatically different percentages because of variations in the amount of total counts. Therefore, two samples with different richness but similar peak heights can have different percentages for equivalent peaks, reducing their effective height in the richer sample. This effect can put true data peaks below a threshold for a rich sample, resulting in unwanted data loss. So, instead of using a common threshold across all samples, it is important to select thresholds that are sample dependent and take richness into account. A similar problem can arise when comparing two replicates in a pair. For example, a replicate pair can be identical in data peak distribution and sample noise level, except that the peaks in one *To whom correspondence should be addressed.  The Author 2014. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com replicate have lower intensities than equivalent peaks in the other. Standardization will equalize the sample, causing noise peaks to gain weight in the lower intensity replicate. Some noise peaks could then be counted as data peaks if not thresholded properly. Again, it is more appropriate to apply a properly chosen threshold to each replicate separately. This article presents an improved technique for finding peak height thresholds for ARISA profiles and similar data. Our technique also provides a robust method for outlier rejection, selecting for removal any replicate pairs that are so different from one another that they cannot be considered useful replicates.
APPROACH
Threshold selectionOur approach to setting thresholds that eliminate sample noise is based on comparing two replicate profiles for each sample in a set. Thresholds are calculated individually for each replicate in a pair, and separately for each sample. The thresholds are selected to be the ones that minimize the dissimilarity between the replicates after thresholding.illustrates the important point that thresholds must be calculated separately for each replicate in a pair to correctly find the minimum dissimilarity. A single threshold for both replicates would limit investigation to the diagonal of the diagram (). In contrast, Thresher investigates all threshold combinations within the full two-dimensional solution space (). If a choice of threshold results in the two replicates in a pair failing some quantitative test of similarity, either that threshold or that sample must be rejected. As we show below, an appropriate test of similarity can be used both to set thresholds and to recognize 'outlier' samples that should not be used in the analysis. The test of similarity must be chosen with care. If peak heights were to be considered, then standard statistical measures of similarity like Pearson's product-moment correlation coefficient (Pearson's r) could be used. However, in methods like ARISA, presence or absence of peaks is usually analyzed rather than using their heights. Popular measures of similarity that are based on presence/absence alone include Srensen's index [which is equal to one minus Bray-Curtis dissimilarity ()] and Jaccard's index (). The measure of similarity used to select the thresholds should be compatible with the analysis techniques that will be used subsequently. Because ARISA analysis typically involves presence/ absence, we use BrayCurtis dissimilarity.
Outlier rejectionThe measure of dissimilarity between the replicate pairs can also be used for outlier rejection. One quantitative approach to this problem for ARISA data was presented by. In our approach, the BrayCurtis dissimilarities for each thresholded replicate pair are compared with one another, and a pair is declared to be an outlier if their dissimilarity is above some number of standard deviations chosen number by the user.
IMPLEMENTATIONIn implementing the approach described above, steps are performed in the following order:Step 1: Application of a minimal threshold, in fluorescent units, to all profiles, to eliminate instrument noise.Step 2: Standardization of all profiles to 100%.Step 3: Application of a range of possible thresholds to both replicates in each pair.Step 4: Fixed-width binning of both replicates in each pair for all possible threshold combinations.Step 5: Presence/absence transformation.Step 6: Computation of BrayCurtis dissimilarity for all possible threshold combinations.Step 8: Identification of outlier samples.Steps 1 and 2 were discussed above in Section 1. The additional steps are described below. Step 3: The goal of Thresher is to assess all possible combinations of reasonable thresholds, selecting the two best thresholds for each pair. Threshold values used in the literature span the range from 0.09 to 1.0% of total standardized fluorescence (). Therefore, we allow the choice of threshold for each replicate to vary from 0.0 to 1.0% in steps of 0.01%, resulting in a total of 101  101 = 10 201 possible combinations. For all combinations, the thresholds are applied to each pair by eliminating all peaks with a standardized peak height lower than the threshold. Step 4: The standardized ARISA data are binned to compensate for uncertainty in the estimates of ARISA fragment length (). For this step, we use the fixed binning capability of dpbin (). We chose fixed binning over dynamic binning because of its computational efficiency and also because we find that both binning processes lead to similar results for this purpose. Thresholding is performed before binning because unwanted peaks could otherwise influence binning results. Step 5: Each profile is transformed to presence and absence, equalizing all peak heights as is typically performed for ARISA data.The choice of N is important, as it represents the investigator's definition of what constitutes an outlier. We recommend use of N = 2, so that all dissimilarities of non-outlier replicate pairs are within two standard deviations of the median.
RESULTS
Environmental data from troll springs, SvalbardTo demonstrate application of Thresher, we use a dataset for microbial communities from Troll springs on Svalbard in the high Arctic (). Microorganisms there exist under an unusually wide range of environmental conditions: in warm water as biofilms, in moist granular materials, and in cold, dry rock as endoliths. These samples vary in their richness and community composition and were analyzed using ARISA as well as 454 pyrosequencing. The 454 results were presented in the study by; we present the ARISA results for the first time here. Preparation of the samples used for ARISA processing is described in Supplementary Material. To show how the Thresher algorithm performs, we assume that the sequencing dataset represents the true community composition, and compare it with the thresholded ARISA data.shows two examples of the 101  101 dissimilarity matrix for two endolithic samples, displaying dissimilarity as a function of the thresholds for each replicate in the pair as color contour maps () and the corresponding standardized ARISA profiles for both replicates (). Ideally, the lowest values of dissimilarity should lie along the diagonal, drawn as a dotted line on the contour maps in. The sample on the left has two replicates with similar peak amounts and distributions. When thresholds are applied to this sample, the lowest values of dissimilarity are found close to the diagonal. However, if two replicates differ significantly in their distribution or number of peaks (e.g. because of noise highlighted by arrows in, right), then the lowest dissimilarity may lie off the diagonal, and each replicate in the pair requires its own threshold. The greater richness in one replicate means that peak heights in that replicate are reduced by standardization. A common threshold applied to both replicates would result in unbalanced treatment of the standardized peak values. The algorithm will select threshold values that lie off the diagonal, accounting for the different initial richness in each replicate of the pair.Thresher algorithm, and by using three single thresholds for all samples. Sample 3 has a BrayCurtis dissimilarity substantially greater than all the others. Using the outlier rejection criterion of two standard deviations above the median (i.e., N = 2), it is rejected as an outlier in the single and separate threshold selection scenario. Additionally, when choosing a single threshold, samples 12 or 5 should be rejected under the same outlier rejection criterion for a single threshold of 0.1 or 0.9%, respectively. However, when choosing thresholds independently using Thresher, both of these samples can be retained.
Dissimilarities of evenly and unevenly distributed replicates
Outlier rejection
Determination of the best thresholding methodAs noted above, the purpose of ARISA is 'community fingerprinting', allowing an investigator to quickly profile the makeup of a microbial community. Our goal in creating Thresher is to provide a thresholding technique that allows ARISA community fingerprinting to be as biologically accurate as possible. Thresher's performance can be evaluated both on a sample-by-sample basis and, more comprehensively, on a suite of related samples. To evaluate the performance of Thresher sample by sample, we compared BrayCurtis dissimilarities between replicates after thresholding both by Thresher and by using single thresholds (). Thresher consistently finds the lowest dissimilarity between replicates, outperforming traditional single thresholding by this metric. No single threshold performs better than all others for all samples. For example, sample 6 has a lower dissimilarity when using a common threshold of 0.1%, whereas sample 1 is treated better with a threshold of 0.9%. To evaluate the performance of Thresher in determining community structure across a suite of samples, we compared both Thresher and the traditional single thresholding technique with results obtained from the pyrosequencing dataset from Troll springs (). The DNA extracted from these samples was used for sequencing as well as the ARISA analysis. For this purpose, we assumed that the pyrosequencing dataset represents the true community composition that ARISA is attempting to approximate. Whole-community fingerprinting techniques like ARISA reveal only a description of microbial community structure rather than identifying specific named taxonomic levels. Therefore, we judged the quality of the thresholding algorithm simply by noting the closeness of community structure of the post-thresholding ARISA-derived dissimilarity matrix to the equivalent matrix derived from sequencing data. We tested Dis min as chosen by Thresher for each replicate and each sample, and compared it with results for single thresholds of 0.1 (least stringent allowing more peaks), 0.5 and 0.9% (most stringent) that were applied across the whole dataset.Standardized ARISA profiles of replicate profiles (one red and one black) for two samples. Similar profiles lead to a relatively symmetric dissimilarity matrix (left sample), while major differences (highlighted by arrows) can lead to an asymmetric dissimilarity matrix (right sample). The y-axis for the second replicate in each pair is shifted upward by 1% for better visualization After applying the thresholds, binning is necessary to combine the two replicates in a pair into a single profile, and to allow profiles to be compared with one another. The standardized and thresholded ARISA data were binned using the dynamic binning capability of dpbin (). The 454 sequencing reaches greater community depths and, consequently, contains higher Operational Taxonomic Unit (OTU) counts compared with ARISA. Therefore, to adjust the sequencing OTU count as closely as possible to the corresponding sample in the ARISA dataset, we applied a threshold to the sequencing data to eliminate minor OTUs. This resulted in similar OTU counts for each sample in the sequencing and the ARISA datasets. To evaluate the performance of the two competing thresholding techniques, we adopted a statistical approach widely used byshow the median value, and dashed lines lie one and two standard deviations above the median after outlier removal has been performed ecologists to describe microbial communities. Specifically, we performed a presence-absence transformation on the data, and then calculated BrayCurtis dissimilarities among all sample pairs. A total of 10 samples were used, yielding 10  10 dissimilarity matrices. We obtained such matrices for the 454 sequencing data, for ARISA data that were thresholded using single thresholds of 0.1, 0.5 and 0.9% and for the same ARISA data thresholded using Dis min as chosen by Thresher. A variety of approaches exist for drawing biological inferences from large dissimilarity matrices. Some of the techniques most familiar to biologists (e.g. non-metric multidimensional scaling) suffer from the shortcoming that they sacrifice quantitative information to allow for easy visualization (). Because we wished to perform a robust comparison of thresholding techniques, we instead used a simpler, but rigorously, quantitative approach. First, we normalized all of the dissimilarity matrices to one another, allowing direct intercomparison. We then calculated the difference between each normalized ARISA-derived matrix and the 454-derived matrix that we assume represents 'biological truth'. This approach is functionally equivalent to visual comparison of results obtained from common ordination techniques, but it reveals the best match between dissimilarity matrices in a straightforward and quantitative manner. The thresholding technique that provides the best match, as determined by the sum of the squares of the differences between normalized matrices, represents the best result. The results are summarized in. As shown, Dis min as chosen by Thresher yielded a better match to the sequencing dataset (i.e. a smaller sum of squares) than when the whole dataset was treated with any single threshold. Stated in biological terms, this means that the ARISA-based microbial community fingerprint obtained using Thresher was closer to sequencing resultsand, we therefore assume, closer to biological truth than the fingerprint obtained using any single threshold.
CONCLUSIONSThis article presents Thresher, a sample-by-sample peak thresholding method that works by maximizing the similarity of replicates by using their best individual thresholds. Thresher outperforms single thresholding methods applied across the whole dataset. It also identifies and eliminates outlier samples. Despite the availability of high-throughput sequencing techniques, ARISA and T-RFLP remain among the fastest and easiest means of assessing variations in microbial community structure. They are particularly well suited to comparing large numbers of samples, recognizing differences in community structure rather than identifying specific taxa. Microbial samples can exhibit large variations in richness, requiring that the essential thresholding be performed on a sample-by-sample basis. The technique can be readily applied to ARISA data from a range of environmental samples. In principle, our thresholding approach could also be useful for other forms of data analysis that seek to separate valid peaks from sample noise peaks. The software is implemented in R (R Development Core Team, 2012). The code is generally available to the research community and can be found in the Supplementary Material or on the Web site http://verenastarke.wordpress.com.. Comparison of the ARISA dataset to the sequencing datasetThreshold choices Sum of squares between the ARISA and sequencing matrix Dis min 0.471 Single T = 0.5 0.576 Single T = 0.1 0.588 Single T = 0.9 0
.621Note. The differences are calculated as sum of squares where the lowest sum represents the highest similarity. Values are ordered according to their sum of squares. ARISA matrices are thresholded separately or one single threshold ('Single T') for all replicates. Threshold values are in percentage.
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
V.Starke and A.Steele at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
Thresher at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
