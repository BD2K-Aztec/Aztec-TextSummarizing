Motivation: BUCKy is a C++ program that implements Bayesian concordance analysis. The method uses a non-parametric clustering of genes with compatible trees, and reconstructs the primary concordance tree from clades supported by the largest proportions of genes. A population tree with branch lengths in coalescent units is estimated from quartet concordance factors.
INTRODUCTIONAs sequencing costs continue to drop and multiple orthologous genes become easily available for a given set of individuals, phylogenetic trees are now commonly inferred from multiple loci at once. However, trees inferred from different loci are very often incongruent with each other. While some of this discordance might be explained by stochastic and technical errors (undetected paralogy or model misspecification), it has become obvious that biological processes are often at the heart of the discordance, including incomplete lineage sorting (ILS), horizontal gene transfers or hybridization. Concatenation of all loci is known to be powerful in some cases, but also known to report inflated support values or to be misleading in other cases (). Several approaches now specifically account for the discordance between genes, such as MDC (), STEM (), BEST () and *BEAST (). The former two methods assume that each gene tree is inferred without error, while the latter two methods integrate uncertainty in gene tree estimation. These methods assume that the sole reason for discordance is ILS as modeled by the coalescent (). The Bayesian concordance approach (BCA;) is an alternative method that integrates over gene tree uncertainty and does not make any particular assumption regarding the reason for discordance. It assumes no recombination within loci and free recombination between loci. BCA uses a non-parametric clustering of genes with information sharing across compatible genes. ItsThe concordance and population trees: the primary concordance tree features relationships inferred to be true for a large proportion of genes. It is built as a greedy consensus: clades are ranked by their estimated CFs and included in the concordance tree one by one as long as they do not contradict a clade with a higher CF already in the tree.showed that this greedy consensus provides an inconsistent estimate of the population tree when discordance is caused by the coalescent and if the population tree belongs to a region they called the 'too-greedy' zone. They also showed that a method based on rooted triples, called R*-consensus, is consistent.To estimate the population tree, BUCKy implements a consensus method similar to the R*-consensus, based on unrooted quartets and which consistently identifies the species tree (). CFs are estimated from the full taxon set alignment and quartets are considered only afterwards. The posterior mean CF of each quartet is computed and transformed to an integer weight as follows, to ensure consistency. For each set of four taxa, the quartet with the largest estimated CF is favored and given weight 1, while the other two conflicting quartets are given weight 0. If CFs are estimated accurately and if the coalescent is solely responsible for the discordance, then all quartets with weight 1 must be compatible and identify the true population tree. In practice, incompatibilities between the favored quartets are resolved with the quartet-joining algorithm described by, which starts from the star tree and progressively joins pairs of nodes. BUCKy currently outputs a population tree with the same set of leaves as in the gene trees (but see Supplementary Material). To estimate the coalescent units u on a branch of the population tree, BUCKy first calculatespcalculates calculatesp, the average posterior mean CF of all quartets defining the branch. Under the coalescent model, any such quartet has a CF of 12/3exp(u) (). Therefore, the branch length is estimated as asas =log(3/2(1p1 1p)). Note that large coalescent units are difficult to estimate numerically when the quartet CF approaches 1. In practice, for anypany anyp > 0.99997,  u is set to a maximum of 10.Method accuracy: from the population tree in, the coalescent was used to generate gene trees along which sequences of length 500 were generated with a mutation rate  = 0.01. BUCKy was then used to estimate the concordance and population trees (Supplementary Material). The gene sets were also concatenated to obtain a consensus tree with MrBayes.shows the proportion of times these three trees matched the true population tree. All tested sets of coalescent branch lengths (x,y) correspond to a fair amount of discordance. With x = 0.6 and y = 0.4, the population tree is outside the 'anomaly zone' described by Degnan and Rosenberg (2006). With x = y = 0.1, the tree is in the anomaly zone but outside the too-greedy zone. An even greater level of discordance is obtained using x = y = 0.05 with a tree in the toogreedy zone. In this case, BUCKy's estimated population tree is consistent but the concordance tree and the concatenation method do not estimate the true population tree consistently. Coalescent branch length estimates had a positive bias but became more accurate with more loci (Supplementary Material).
* To whom correspondence should be addressed. primary goal is to estimate the concordance factor (CF) of each clade, i.e. the proportion of genes that truly have the clade (Baum, 2007). The primary concordance tree is reconstructed from the clades with the largest CFs, in order to capture the main vertical phylogenetic signal (Galtier and Daubin, 2008). CFs measure the genomic support of each clade and summarize the horizontal signal: clades with moderately low CFs display relationships that are not in the primary concordance tree, but that are still true for a minority of the genome. In this note we describe BUCKy, a program that implements BCA. BUCKy version 1.4.0 includes new features added to the version used in An et al. (2007), including the estimation of a population tree with branch lengths measured in coalescent units. 2 PROGRAM DESCRIPTION BUCKy takes as input the complete tree files generated by the Bayesian analysis of each individual locus, in the format generated by MrBayes (Ronquist and Huelsenbeck, 2003). BUCKy's output from the Bayesian analysis consists of a sample of gene trees from their joint distribution, from which CFs are estimated with credibility intervals. Finally, these CFs are used (as described below) to produce the main output: a concordance tree and a population tree. BUCKy can also generate a pairwise similarity measure between loci: the posterior probability that two loci share the same tree. This matrix can help reconstruct gene clusters and detect outlier loci. An option allows the user to run the analysis on a subset of taxa, bypassing the need to re-run the lengthy Bayesian analysis of individual loci pruned to the desired taxon subset. The user may also easily skip loci that are missing one or more taxa in the desired list, and analyze only the remaining loci. For datasets with many loci and many taxa, an option allows the use of a sparse data structure to reduce the space requirement (see Supplementary Material).
at :: on August 31, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
CONCLUSION BUCKy is a program to combine multiple orthologous loci with potential conflict between their phylogenetic trees. The estimated primary concordance tree summarizes the vertical phylogenetic signal shared by the largest proportion of loci, while estimated CFs provide information about the horizontal signal. Although BUCKy makes no assumption regarding the reason for discordance when reconstructing gene trees and CFs, a population tree with branch lengths in coalescent units is estimated from CFs. This population tree estimation is based on and consistent under the coalescent model. The user may chose to prefer the estimated concordance tree when forces other than ILS are believed to be at work, and to prefer the estimated population tree otherwise.
