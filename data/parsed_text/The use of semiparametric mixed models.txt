Motivation: Phosphorylation by protein kinases is a central theme in biological systems. Aberrant protein kinase activity has been implicated in a variety of human diseases (e.g. cancer). Therefore, modulation of kinase activity represents an attractive therapeutic approach for the treatment of human illnesses. Thus, identification of signature peptides is crucial for protein kinase targeting and can be achieved by using PamChip microarray technology. We propose a flexible semiparametric mixed model for analyzing PamChip data. This approach enables the estimation of the phosphorylation rate (Velocity) as a function of time together with pointwise confidence intervals. Results: Using a publicly available dataset, we show that our model is capable of adequately fitting the kinase activity profiles and provides velocity estimates over time. Moreover, it allows to test for differences in the velocity of kinase inhibition between responding and non-responding cell lines. This can be done at individual time point as well as for the entire velocity profile.
INTRODUCTIONScientific advances in biotechnology bring us in a new era of targeted therapies and personalized medicine. Biomarkers are essential for selecting patients that benefit from certain treatments, and biomarker discovery is nowadays driven by novel platforms that measure more biological properties more precisely. Evidently, these technological advances often require the development of optimal analysis approaches for its generated data in order to increase its detection power. Here, we propose a statistical model to efficiently analyze output from PamChip microarrays. These high-content peptide arrays are capable of measuring phosphorylation changes over time for more than hundred peptides simultaneously (). * To whom correspondence should be addressed.Compared to conventional microarrays, PamChips have two main advantages. First, proteins are closer to phenotypic expression than DNA or mRNA profiles. Second, PamChips are not measuring concentrations but biological activity, i.e. phosphorylation over time. An important application area of PamChip microarrays is the study of protein kinase activity (). Protein kinase inhibitors can specifically block key signaling pathways in cancer, making kinases very popular targets in anticancer-targeted therapy discovery programs (). PamChip microarrays have a very distinct technical design (see Section 1 of the Supplementary Material for more details) and the data properties of the PamChip read-out are atypical compared with more traditional microarrays. Hence, specific data analysis pipeline has to be developed for PamChip microarrays. In this article, we demonstrate the statistical methodology to model the kinase activity profiles and thereby estimate the phosphorylation rate, referred to as velocity. With the proposed approach, phosphorylation rates can be investigated and tested for each peptide. The article is organized as follows. Section 2 describes a real-life PamChip microarray experiment that is used to demonstrate our method. In Section 3, we describe existing methods for analyzing PamChip array data and motivate our approach. In Section 4, we give a brief review of penalized smoothing splines formulated as mixed models, specify the proposed model, specifically adapt it to the PamChip array data at hand and focus on the inference problem of this study. The results are given in Section 5. The discussion and conclusions are presented in Sections 6 and 7, respectively.
REAL-LIFE PAMCHIP ARRAY DATAWe use a real-life dataset described inas a motivating example for our method. It consists of an oncology experiment where phosphorylation of peptides is measured in 20 different cell line lysates in the absence (control) and presence of a kinase inhibitor (compound) using peptide arrays with a kinetic read-out. Ten out of twenty cell lines are known to be responsive and others are non-responsive to the specific kinase inhibitor under study. The cell lines were randomly assigned to six 96-well plates, of which each well contains a 144-peptide array. Each cell line was typically replicated 56 times. For quality control issues, some wells were excluded.The intensities of 144 peptides were measured at 5 min time intervals over a period of 60 min using PamChip technology. The first kinetic reading is done 11 min after the assay mix was pumped to the plate. The last reading is done at 71 min. For simplicity, we shift the time by subtracting 11 min from each time point leading to a time range t = 0,...,60 min. Therefore, t = 0 corresponds to the first kinetic read.shows kinase activity over time for a selected peptide of a responsive cell line under the treatment () and control (). Profiles for a non-responsive cell line are given in Supplementary. The graphical illustration of intensity measurements for a selected peptide across all the cell lines are given in Supplementary.
P.J.Thilakarathne et al.
A B
MOTIVATIONSignal intensity profiles are the outcomes of the peptide microarray experiment and correspond to the degree of phosphorylation. For assessing the impact of the kinase inhibitor compound, however, the phosphorylation rate is required.modeled peptide array data with an exponential model, Y ij = Y o +Y max, where the Y ij values stand for the signal intensity of subject i at j-th time point, Y o is the signal intensities at the beginning of the experiment and Y max is the maximum observed intensity.  is the reaction rate constant and t j is the time point when the image was recorded. Only the initial velocity of the peptide phosphorylation was used for subsequent data analysis.preprocessed each PamChip profile separately using CurveFitHT software for deriving the initial velocity at the first kinetic time point read. They only used the first 30 min of the assay and based all subsequent data analysis on the estimated initial velocities. In particular, the estimated initial velocities were log 2 transformed and are used for comparing responsive and non-responsive cell lines with a mixed model. Bothuse a two stage approach where (i) exponential models are used in the first stage to summarize the individual time series into a single value i.e initial velocities and (ii) these estimated initial velocities are assessed in the downstream analysis without accounting for their associated uncertainty. Hence, they ignore the within replicate variability and only capture the technical variation between the replicates. This can have a severe effect on the outcome of the second stage analysis if the within variability of the replicates is large as compared to the between variability and in case that the uncertainty of the initial velocity estimates differs among replicates, cell lines or treatments. Hence, the Hilhorst method and the Versele method might suffer from a loss in power, efficiency and an incorrect control of the type I error (). We propose a semiparametric mixed effects model that combines both the estimation and modeling stage into a single analysis. Moreover, the link between mixed models and smoothing provides a very flexible framework for estimating the kinase activity profiles in a data-driven way. Within the mixed model framework, it is very natural to account for the dependence structure of the intensity signals within and across activity profiles by modeling all data for a given peptide, simultaneously. The proposed semiparametric mixed model allows for testing whether the change in phosphorylation rate (velocity) induced by the treatment (compound) effect differs between responsive and non-responsive cell lines. The tests can be performed at any time point as well as for the entire profile, simultaneously. Further, velocity profiles can be derived as a function of time along with 95% pointwise confidence bands.
METHODSHigh-content PamChip microarrays produce longitudinal time series profiles. For inference, it is necessary that we properly capture the form of the evolution of profiles over time. In longitudinal studies, the mean profile is often estimated by parametric functions. Examples of longitudinal studies and an extensive overview on longitudinal data analysis and inference using parametric models can be found in;;; Verbeke and Molenberghs (2000). However, many biomedical experiments typically generate nonlinear data and imposing parametric functions might yield unsatisfactory results (). In the context of PamChip experiments, for instance, the individual profiles are non-linear and parametric models may be too restrictive. Moreover, the experimental setup gives rise to a complex dependence structure, which can obscure the interpretation and inference on the non-linear phosphorylation profiles. Therefore, we propose a data-driven approach based on semiparametric regression models. Particularly, we use penalized thin plate regression splines to analyze PamChip data. Penalized thin plate regression splines avoids problems of knot selection and knot placement, as they both emerge naturally from the mathematical formulation of the smoothing problem (). The smoothing parameters that control the degree of smoothing typically have to be tuned toward the specific application. Interestingly, these smoothing parameters can also be estimated within the linear mixed-model framework (). Let Y i (t) denote the log 2 transformed and background corrected intensity measurement on cell line i (i = 1,...,n), taken at time point t. The penalized spline model, with cell line-specific random effects b 0i ,...,b pi can be expressed aswhere f  (t)s are a set of thin plate spline basis functions (Supplementary),   are the coefficients of the basis functions (),, b ) and  i(t) i.i.d. N(0, 2  ). The cell linespecific random effects b pi 's accounts for the correlated nature of the intensities. Statistical significance of the cell line-specific random effects can be tested by using an approximate likelihood ratio test (). The spline model parameters can be
Page: 2861 28592865
Mixed model for PamChip peptide arraysestimated by considering the goodness-of-fit and the degree of smoothness (). The model (1) can be fitted by finding the function from an appropriate reproducing kernel Hilbert space which minimizes
Q =||y S||] 2 dt is the roughness penalty which penalizes for the lack of smoothness of S. Roughness is quantified by the integral of squared m-th order derivatives. The most commonly used roughness penalty is m = 2. Note that, for m = 2 and a given , S, the minimizer of Q, is a cubic smoothing spline. In the literature, the smoothing parameter  is often tuned by using an optimization criterion such as generalized cross-validation. Penalized thin plate regression splines (TPRS), however, can also be represented within the mixed model framework (). It allows for the estimation of the smoothing parameter  =  2  / 2 s , where  2 s is the variance of the random effects that are involved in the mixed model representation of the spline. In this study, our aim is to estimate the marginal phosphorylation rate over all cell lines, which is the first-order derivative of the smoother, S(t), with respect to time t. Note that, the first-order derivative Sis a linear combination of the derivatives of the basis functions. S (t) is a smooth function of time when using cubic splines. However, they give rise to biased velocity estimates at the boundaries (Supplementary Section S9) and are not suitable in our situation. Therefore, we will penalize on the third-order derivative, which provides a more smooth first derivative that does not suffer from boundary artifacts (). Because the TPRS are adopted within the mixed model framework, standard errors and confidence bands for the velocity follow from standard theory of mixed models (e.g.). Fitting penalized splines models within the linear mixed model framework has some appealing advantages, such as the estimation of the smoothing parameter , a unified framework for inference and straightforward extension of the model. Moreover, the mixed model representation also provides a natural way for handling clustered data, missing data and measurement error (). In the following section, we describe how we draw the inference from the proposed approach.
Inference on first-order derivativeIn this particular study, we are interested in marginal velocity. Hypothesis tests on the velocity can be formulated by using general linear hypotheses.where L is the contrast matrix and V is a vector which contains coefficients of the first derivatives of the basis functions (f  (t)) discussed in Section 4.
Formulation of the model for PamChip array dataThis section provides the formulation of the spline model (1) for the PamChip array data at hand. We propose a full factorial model structure for treatment and responsive status. For a desired flexibility, the penalized thin plate regression smoothing splines with penalization on the third-order derivative (m = 3) are considered (). For the present study, we have two treatments (control and compound) and two responsive statuses (responsive: R and non-responsive: NR) for cell lines. This data structure formulates four distinct groups namely, g = 1: Compound-R, g = 2: Compound-NR, g = 3: Control-NR and g = 4: Control-R. Let Y gijl denote the log 2 transformed and background corrected intensity measurement of cell line i, replicate j, measured at time t, on the l-th plate for group g, with i = 1,...,20; j = 1,...,6; t = 0,5,10,...,55,60 min, l = 1,...,6 and g = 1,...,4. We propose the following semiparametric mixed model with quadratic random effects structures (p = 2) for replicates as well as for cell linesIn this proposed model, the cell line-specific random intercept is considered to capture correlation of the intensity measurement over time within the cell line. We assumed cell line-specific random slopes for linear as well as for quadratic time effects to capture different evolution of kinase activity over time. Moreover, we allow these cell lines-specific random structures to be different for each group. We assumed group-specific random structure for cell lines for which [b 0gi ,b 1gi ,b 2gi ] T  MVN(0,, b ) where g is the group indicator and b denote the variance covariance matrix of cell line-specific random effects. There are technical replicates for each cell line under each treatment and therefore, the replicate-specific random effect within the cell line, c 0j(gi) , is specified. Replicate-specific random slopes for linear and quadratic time effects nested within the cell line, capture the different evolutions of replicate-specific profiles (). We assumed that the replicate-specific random structure is, c ) and c denote the variance covariance matrix of replicate-specific random effects. A random 96-well plate-specific effect, a l  N(0, 2 a ), is assumed for the correlation of the cell lines on the same 96-well plate. Ten out of twenty cell lines are known to be responsive and others are non-responsive. Therefore, we assumed heterogeneous error variability across the four different groups. Hence, the residuals  gijl(t) are assumed to be i.i.d. N(0, 2 g ). Further, we assume a different smoother, S g (t), for the four different groups, which is defined aswith group-specific smoothing parameter  g. Note, that the design matrix, corresponding to the smoother, is a block diagonal with each diagonal entry corresponding to a particular group.
Comparing group-specific velocitiesThe data structure for the present study formulates four distinct groups as described in Section 4.2. We define S g (t) as the velocity for each group g, g = 1,...,4, and we are interested in investigating whether kinase inhibitor induces a similar velocity change in responsive and non-responsive cell lines. To test whether the treatment effect is the same for responsive and nonresponsive cell lines, we formulate the general linear hypothesis.This hypothesis can be tested at any time point t as well as for the entire time profile t [0,...,. The null hypothesis obviously implies that the velocity contrast between the treatment and control is the same for responsive and non-responsive cell lines. Supplementaryillustrates a hypothetical example for a possible scenario related to the evolution of velocity over time under the alternative hypothesis. The left panel of Supplementaryshows a velocity at t = 0 under the alternative hypothesis and the right panel shows the evolution of velocity over time for each group. Four groups have different velocities over time and the groups differ in both linear and smooth parts. First we consider testing at a particular time pointis the vector of first derivatives of basis functions.is the vector of group-specific coefficients of the basis functions for which. Therefore, the null hypothesis is H 0 : LV = 0 and theThe -th row represents the contrast on the coefficients of the -th basis function f  (t) for four different groups, with  = 1,...,. In this case, hypothesis (4) can then be tested using the test statistic Lwhich follows a chi-squared distribution with degrees of freedom equal to the rank of L. The test can be performed for each peptide and illustrations are given in Section 5. We provided a proof for the equivalence between testing on the entire profiles and testing on the coefficients of the basis functions in the Supplementary Section S11. In what follows, we apply the proposed semiparametric mixed model (3) to the PamChip array data and test the scenarios illustrated in Supplementary.
RESULTSWe apply the proposed method to a publicly available dataset from, which we described in Section 2. Similar to microarray technology, PamChip data are also subject to noise and we use background corrected intensity measurements for the data analysis. Prior to fitting the model, we examine the data for unusual observations and extreme profiles. Outlier removal has been done in three steps. First, we notice that some of the observations are negative for a given kinase activity profile. The PamChip software reports background corrected intensities. Hence, negative observations might occur when the measured intensity for a particular peptide in a certain well does not exceed the background signal. Negative intensity measurements are replaced by half of the positive minimum intensity measurement of that profile. Second, we compute the area under the curve (AUC) for each profile of a given cell line. Analysis of variance has been carried out based on those AUC values while taking the treatment as covariate with two levels. Extreme profiles whose residuals are beyond 2 the square root of the mean squared error are removed. Third, we look at the observations within a profile and remove the extreme observations if they differ more than 2 standard deviations of the profile-specific mean. In this step, we are able to remove extremely high intensity measurements (spikes). All these steps are repeated for each peptide and each cell line. Supplementary Figures S6 and S7 illustrate these preprocessing steps for peptide AMPE_5_17_Y12 and cell line N87. The filtered data are then log 2 transformed to stabilize the variability over time.
Results on a single peptideWe begin with analyzing peptide, TYRO3_679_691_Y686, which is known to be biologically significant (). The proposed penalized thin plate regression splines model is fitted for the particular peptide by using the gamm procedure available in R package mgcv. The smoothing parameters can be estimated via generalized cross-validation (). In this study, we use the link between mixed model and splines. This is an advantage of fitting the thin plate regression splines within the mixed model framework.Time0 1 0 2 0 3 0 4 0 5 0 6 0 Time0 1 0 2 0 3 0 4 0 5 0 6 0 Time0 1 0 2 0 3 0 4 0 5 0 6 0 Timelog210We used penalized thin plate regression splines with a roughness penalty on the third-order derivative m = 3 to obtain a smooth firstorder derivative. For this particular peptide, we test whether the groupspecific error variances are the same. The null hypotheses H o :NR,Control are tested using a Wald test. We found that treatment and control have the same variance irrespective of their responsive statuses (p 1 = 0.521 and p 2 = 0.189). Therefore, we refit the model while assuming different error variances for responsive and the nonresponsive cell line groups. The null hypothesis H o :Wald test. We found that responsive and non-responsive cell line groups have significantly different error variances (p = 0.0001). Further, we tried to reduce the proposed model by reducing the cell line-specific as well as the replicate-specific random effects structures. We test the null hypotheses H o :  2 b2 = 0 and H o :  2 c2 = 0 separately by using approximate likelihood ratio tests. However, testing for the variance components has to be done with care because the parameter of interest is on the boundary of the parameter space (). To account for the boundary problem under H 0 , we can approximate the null distribution of the test statistic with a mixture of  2distributions (). It is found that both variance components are significant (with P-values P 1 = 0.0001 and P 2 = 0.0001), implying the need for the random effects b 2ig and c 2j(ig). Therefore, the proposed model (3) is not reduced. Supplementaryshows the restricted maximum likelihood estimates for the fixed effects and variance components for the model (3).shows the observed time series profiles and Page: 2863 28592865TimeVelocity
Mixed model for PamChip peptide arraysTime0 1 0 2 0 3 0 4 0 5 0 6 0 0 1 0 2 0 3 0 4 0 5 0 6 0 TimeTimeVelocityA B C Dthe estimated smoothers for each group. The solid thick curve indicates the group-specific smoothing curve and gray lines indicate the observed time series profiles for all replicates. Note, that the replicate specific curves suggest a multimodal distribution of the data for the control, which can be modeled by the hierarchical structure of the random effects in Model (3). This is illustrated in Supplementary Figures S8 and S9. There is a huge variation among replicate specific profiles and among cell line-specific profiles. These variations are incorporated in our model by replicate-specific and cell line-specific random effects. Further, the variation between the different 96-well plates is captured with the plate-specific random effects. In Supplementary, all fitted replicate specific profiles for all cell lines are displayed along with the data. It can be seen that the model captures the variability between the profiles adequately. The phosphorylation rate, velocity, in model (3) is available over time and therefore the initial velocity can be extracted very easily by evaluating the first derivative of S(t) at t = 0. Further, standard errors for the estimated velocity are also available. We construct the confidence bands around the group-specific velocity profiles using the methodology discussed in Wood (2006) and. The estimated velocity profiles and 95% pointwise confidence bands for each group are shown in. These are the first-order derivatives of the fitted group-specific curves. The phosphorylation rate is higher at the beginning of the experiment and reaches a plateau after a few minutes. The estimated groupspecific mean curve for the RControl flattens slightly between time interval 525 min (). This corresponds to the shape on the corresponding first derivative in. This might seem unusual for individual profiles if phosphorylation follows first-order kinetics. However, the relationship might be obscured, because we measure phosphorylation indirectly by using noisy intensities corresponding to fluorescence of labeled antibodies that bind to the phosphorylated peptides. Moreover, the average profile should not necessarily have the same functional relationship as the individual curves. Although the group specific mean curve flattens slightly between 5 and 25 min, this does not happen for the observed and fitted individual kinase activity profiles: they seem to reflect a realistic physiochemical behavior (seeand Supplementary, respectively). However, the individual profiles reveal a huge variation among the different cell lines within this time interval. Therefore, the shape in the group-specific mean velocity profile might be attributed to the averaging process in a region where huge differences occur among the cell lines. Supplementaryillustrates velocity profiles for different groups and the differences in initial velocities between the non-responsive and responsive groups. Later we show that the difference for signature peptide TYRO3_679_691_Y686 is statistically significant.
Selecting the signature peptidesThis section describes the identification of signature peptides based on both initial velocity and the entire velocity profile using the proposed model. Similar to Section 4.3, our aim is to identify peptides with velocities that are different across the groups. The hypotheses in (4) are tested at the initial time point as well as for the entire velocity profile. The rate of phosphorylation is expected to be higher at the start of the experiment than at later time points. Thus, the test is first performed using the initial velocities only. The hypothesis given in (4) can be used to test for time t = 0 with contrast. Second, we update this hypothesis for drawing inferences based on entire velocity profiles (Section 4.3). The updated contrast matrix L has as many rows as the number of basis functions in the smoother described in Section 4.3. The proposed model is fitted for each peptide and the testing procedure is repeated. P-values are corrected for multiplicity using the false discovery rate (FDR) procedure of Benjamini and Hochberg described in. Based on the tests using the entire velocity profile, 30 signature peptides are discovered and tabulated in Supplementarywith the FDR corrected P-values. Supplementarysummarizes the maximum likelihood estimates of initial velocities of significant peptides along with their standard errors for each group. P-values for all peptides are summarized in Supplementary.
DISCUSSIONProtein kinases are key regulators of important cellular processes, including growth, stress response, differentiation and apoptosis. For drug development, signal transduction research and clinical research, in-depth insight in the effects of stimuli on multiple protein kinases is often required in order to fully understand the effects of kinase inhibitors. The novel PamChip technology enables us to monitor kinase activity in a highly multiplex setting with wide range of peptides. We have proposed a semiparametric mixed model to analyze PamChip array data. Our aim was to model the kinase activity profiles and estimate the rate of phosphorylation (velocity) over time. The proposed approach is capable of modeling these Page: 2864 28592865
P.J.Thilakarathne et al.activity profiles while incorporating the correlation structure of the data. Moreover, our approach does not require restrictive parametric model assumptions and thus allows greater flexibility by estimating phosphorylation profiles with thin plate regression splines. Hence, the risk of bias is greatly reduced as the estimates depend more on empirical data and less on a priori assumptions. Further, estimation and inference is performed in an unified way within the mixed model framework. This approach makes it easy to fit more complex models by including additional fixed effects, random effects or interactions. Moreover, various error structures may be formulated for the errors to account for spatial or longitudinal correlations (). The main interest of this study was to estimate the phosphorylation rate. Therefore, a smooth first derivative of the fitted phosphorylation profiles is desirable. We have investigated different sets of basis functions for model (3) and thin plate regression splines with a smoothness penalty on the third derivative had the best performance (Supplementary Section 9). Thin plate regression splines have the additional advantage that basis functions, number of knots and position of the knots naturally arise from optimizing the objective function given in (2). The proposed model belongs to the additive mixed model family and can be fitted using standard mixed model software, e.g. with the gamm procedure in the R package mgcv () or with procedure GLIMMIX in SAS. Our semiparametric model overcomes several drawbacks of the methods (). With our model, we found 30 significant peptides using tests based on the entire profiles, and 25 based on the initial velocities, 10 of which were also found with the Versele method. The differences between both methods can be explained as follows. Our single stage approach captures the complex dependence structure of PamChip data and accounts for heteroscedasticity between responsive and non-responsive cell lines. Therefore, it correctly incorporates the uncertainty in the final statistical inference. The Versele and Hilhorst methods, however, are two-stage approaches that summarize information of the individual time profile into a single summary statistic (initial velocities) and use the initial velocities in the downstream analysis step without accounting for the uncertainty on these estimates. Hence, they ignore the within replicate variability and only capture the technical variation between the replicates. The outcome of the second stage analysis can be severely affected if the within variability of the replicates is large compared with the between variability or if the uncertainty on the initial velocity estimates differs among replicates, cell lines or treatments. In the Versele experiment, the uncertainty on the velocity estimates is bound to be different, because (i) some observations are missing and preprocessing steps are necessary to remove outliers, which results in a different number of observations for the different profiles and (ii) due to the inherent heteroscedasticity between the responsive and non-responsive cell lines. Hence, the model assumptions in the second stage analysis ofwere violated. Additionally, both Hilhorst and Versele approaches also ignore the correlation between treatments, cell lines and replicates that are assessed on the same 96-well plate, because each phosphorylation profile is preprocessed independently. The random plate effect was also not included in their second stage analysis. For our particular experimental design, the random plate effect does not affect inference on the contrasts between Compound and Control. However, we incorporate the random plate effect in our model for three reasons. First, to ensure that we capture the complex dependence structure of PamChip data correctly: the data of different cell lines that are placed on the same plate are correlated. Second, to propose a more general model, which provides correct inference for other potential contrast of interest and for unbalanced designs. Third, to accommodate for experiments where the replicates of a specific cell line are placed on different plates. Based on all these arguments, the Hilhorst and the Versele methods are expected to suffer from a loss in power, efficiency and an incorrect control of the type-I error ().
Page: 2865 28592865
Mixed model for PamChip peptide arrayslinear combination of a set of non-linear basis functions. Therefore, our model is very flexible while remaining linear in the model parameters. This approach is very attractive: it relaxes the model assumptions and simplifies statistical inference as it can build upon the standard theory of linear mixed models.
CONCLUSION
The Author 2011. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oup.com
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
The exponential model (Y ij = Y o +Y max [1exp(t j )]) that is suggested by Hilhorst et al. (2009) can be integrated within a single stage non-linear mixed model by specifying random effects on the exponential model parameters: Y ijlg =b 0ig +c 0j(ig) +a l +Y og + (b 1ig +c 1j(ig) +Y max,g ) 1exp ( g +b 2ig +c 2j(ig) )t j (5) where b 0ig , b 1ig , c 0j(ig) , c 1j(ig) and a l are cell line, replicate and plate specific random effects, respectively. We adopted the model in R and encountered issues related to numerical stability for some peptides. In model (5), we explicitly assume that the individual time profiles follow the Hilhorst model. However, this assumption does not necessarily hold for the average group-specific phosphorylation profiles. Usually there is no closed form solution for the average evolution of non-linear mixed effects models (Fitzmaurice et al. 2008; Molenberghs and Verbeke 2005). Hence, it might not be sufficient to draw inference on the parameters Y max,g and  g when assessing differences in the marginal group-specific velocity profiles. This was confirmed in our analysis; only one significant peptide could be detected with contrasts on model parameters Y max,g and  g (results not shown). Inference at specific time points is even more challenging. The average velocity can be estimated at a particular time point, however, standard errors and estimates of the correlation between the velocities are lacking. In principle, they can be approximated by the delta method or by using bootstrap techniques. Alternatively, one could also perform Monte Carlo Markov Chain (MCMC) simulations to sample from the posterior mean of the velocity profiles. But, both bootstrapping and MCMC will lead to a tremendous increase in numerical complexity. From the discussion above, it is clear that inference on the average group-specific velocity profiles of non-linear mixed models is not straightforward. Another argument against non-linear mixed model (5) is that we feel that the parametric assumptions of the exponential model should be relaxed. The model is motivated by the assumption that peptide phosphorylation follows first-order reaction kinetics. In practice, this might be too restrictive and competing kinetic models might be more appropriate. The reaction kinetics, however, will also be obscured as the phosphorylation is followed indirectly by measuring the fluorescence of labeled antibodies that bind to the phosphorylated peptides. Similar to conventional microarray data, a log transformation of the intensities is beneficial to stabilize the variance, which again will affect the functional form of the profiles that have to be modeled. Our semiparametric method estimates the phosphorylation profiles in a data-driven way by using thin plate regression splines without imposing an a priori functional relationship. The thin plate regression splines can be represented as a
