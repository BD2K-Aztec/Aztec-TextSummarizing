Motivation: With recent advances in sequencing, structural and functional studies of RNA lag behind the discovery of sequences. Computational analysis of RNA is increasingly important to reveal structureâ€“function relationships with low cost and speed. The purpose of this study is to use multiple homologous sequences to infer a conserved RNA structure. Results: A new algorithm, called Multilign, is presented to find the lowest free energy RNA secondary structure common to multiple sequences. Multilign is based on Dynalign, which is a program that simultaneously aligns and folds two sequences to find the lowest free energy conserved structure. For Multilign, Dynalign is used to progressively construct a conserved structure from multiple pairwise calculations, with one sequence used in all pairwise calculations. A base pair is predicted only if it is contained in the set of low free energy structures predicted by all Dynalign calculations. In this way, Multilign improves prediction accuracy by keeping the genuine base pairs and excluding competing false base pairs. Multilign has computational complexity that scales linearly in the number of sequences. Multilign was tested on extensive datasets of sequences with known structure and its prediction accuracy is among the best of available algorithms. Multilign can run on long sequences (>1500 nt) and an arbitrarily large number of sequences. Availability: The algorithm is implemented in ANSI C++ and can be downloaded as part of the RNAstructure package at:
INTRODUCTIONRNA sequences have been discovered to play remarkably diverse roles, such as catalysis (), gene expression regulation () and sequence recognition (). Recent studies show that there are a large number of RNA transcripts that do not encode proteins (). The functional and structural roles of these RNAs are of great * To whom correspondence should be addressed. interest. With current techniques, however, it is slow and expensive to experimentally determine structures for the majority of those RNA. Thus, structural and functional analysis of RNA molecules has lagged behind the rate of sequencing, leaving a large gap needing to be filled. Structure prediction is an attractive tool for studying all the currently available sequences. RNA secondary structure, defined as the sum of canonical base pairs (A-U, G-U and G-C) is commonly predicted and these predictions have been used to design structures (), discover functional RNA sequences in genomes (), study folding (), design siRNA sequences () and facilitate comparative sequence analysis (). The prediction of lowest free energy structures with a dynamic programming algorithm is a popular approach for making such predictions (). In this approach, a nearest neighbor energy model with a set of thermodynamic parameters derived from optical melting experiments on small RNA models () is used to evaluate possible structures and the dynamic programming algorithm guarantees that the most stable structure will be found. Only 73% or fewer known base pairs are predicted by free energy minimization for sequences shorter than 700 nt (). The prediction is worse for longer sequences, with 2060% average accuracies for small and large subunit rRNA (). When multiple homologous sequences are available, evolutionary conservation can be used to improve RNA secondary structure prediction accuracy. RNA sequences often change during evolution, but RNA structures are generally conserved in order to preserve function. The set of structures that multiple different sequences can adopt is smaller than the number of structures each can adopt independently, so determining the conserved structure is more accurate. A number of computational approaches have been applied to this problem, as previously reviewed (). Some of the algorithms require a fixed initial alignment as input (). The drawback to this is that the initial alignment, based on nucleotide matching, may not reflect the correct alignment because of compensating changes in the sequence. This imperfect alignment can seriously restrict prediction accuracy.introduced a dynamic programming algorithm to find optimal consensus structures and sequence alignment simultaneously without being constrained to aPage: 627 626632. Multilign algorithm flowchart, illustrating progressive calculations of S sequences. The index sequence is used with each other sequence as input to Dynalign. The cycle is repeated for multiple iterations, using the same index sequence for all iterations. A structure is predicted for each sequence with the final iteration. The computational complexity for this algorithm is O(N 4 ) in memory and O(ISN 6 ) in time for I iterations of calculation for average sequence length of N.
Multilignfixed alignment. The computational complexity scales O(N 3S ) in time and O(N 2S ) in memory, where N is the average length of the sequences and S is the number of sequences. Dynalign is a variant of Sankoff's algorithm that uses the complete nearest neighbor thermodynamic model to find the lowest free energy structure common to two RNA sequences (). An X-Dynalign was reported to simultaneously fold and align three sequences (). It improves prediction accuracy, but is extremely computationally demanding even for sequences as short as 5S rRNA. A profile alignment algorithm using Dynalign was also explored to find strict common base pairs in all the input sequences (Bellamy). Its performance on 5S rRNA and tRNA was reported to be comparable with other benchmarked methods, but depends highly on the quality of the guide tree that is used to guide the progressive alignment (Bellamy). In this contribution, a new algorithm, called Multilign, is introduced to solve the high-computational complexity of predicting structures common to three or more sequences. Multilign is based on multiple Dynalign calculations. It departs from previous greedy approaches that build upon fixed decisions made early in the calculation. Instead, Multilign uses a single index sequence and performs Dynalign calculations with the index sequence and each other sequence in turn. Base pairs for the index sequence that are in low free energy structures are allowed in subsequent Dynalign calculations. This progressively refines the set of allowed pairs utilizing comparison with each sequence. Multilign works well for an arbitrary number of long sequences, e.g. >1500 nt, with a memory requirement the same as Dynalign and a time requirement that scales linearly with sequence number. In accuracy, Multilign performs as well as the best available methods.
METHODS
Progressive templatingThe progressive calculations used by Multilign are illustrated in. A sequence is chosen as the index sequence. This sequence is then utilized for pairwise structure prediction with each other sequence in the set using Dynalign, one after another. In each calculation, the energy dot plot is calculated (). This plot determines, for each possible pair in each sequence, the lowest total free energy for a conserved structure and alignment that contains that pair. During the progressive calculations, subsequent calculations only allow the set of pairs for the index sequence that were found in low free energy structures in prior calculations. The allowed pairs are determined using a threshold described below. As the Multilign calculation proceeds, the energy dot plot for the index sequence becomes less crowded with possible pairs because few pairs are in low free energy structures with all previous Dynalign calculations. This relies on the hypothesis that the true base pairs are in low free energy structures predicted by all Dynalign calculations, but the competing false base pairs are not. Supplementaryshows that the set of relatively low free energy structures contains the vast majority of true base pairs for a diverse set of RNA families. An example of the removal of false pairs by Multilign is shown in. After calculations with all other sequences, the folding space of the index sequence is well constrained, but the folding spaces for the other sequences is not as well defined. Thus, subsequent iterations in the same progressive manner and with the same index sequence can be used to constrain the folding of the other sequences until a common structure is determined.
Determination of parametersA threshold is used to select pairs that will be allowed for the index sequence in subsequent Dynalign calculations. The optimal threshold is one that allows just all true base pairs and few false positive base pairs in subsequent calculations. There is, however, no universal cutoff for all types of RNA as shown in Supplementary, either in absolute free energy or in percentage of free energy change. Empirically, it was found that a threshold that allows a specified number of pairs (MaxPairs) in conjunction with a percentage cutoff (maxdsvchange) provided the best average performance. The cutoff maxdsvchange allows all pairs found in structures with folding free energy within a maximum percentage interval above the lowest free energy structure. The criterion for allowing pairs at each step is the one that allows the most pairs in subsequent calculations. Other factors that may influence the Multilign prediction accuracy include the choice of the index sequence, the order of the pairwise Dynalign calculations, the number of iterations and the total number of sequences used. How these factors impact the prediction result were tested (Section 3 and). The default settings are a maxdsvchange of 1%, a MaxPairs equal to the average length of all the input sequences, the index sequence as the first of the input sequences and the number of iterations set to two. The default settings were used for the benchmarks here. The index sequence was chosen at random.
BenchmarkDefault options and parameters are used for all the programs except RNAshapes. For RNAshapes prediction on tRNA and 5s rRNA, the options, '-t 3 c 50' were used to have less abstract levels and wider energy ranges. For the other RNA families with longer sequences, default parameters ('-t 5 c 10') were used to reduce memory requirement. All the calculations were done on cluster compute nodes each having two quad-core Intel Xeon 3.0 GHz processors with 16 GB of RAM. Multilign has both serial and parallel versions available, where the parallel version works on shared memory architectures. The parallel version was used in the benchmark. ClustalW2 () was used to predict an alignment for RNAalifold (), which requires a sequence alignment as input. Secondary structures determined by comparative sequence analysis were used as reference structures for testing Multilign. These structures are accurate; it has been shown that > 97% of base pairs in ribosomal RNA secondary structures predicted by comparative sequence analysis exist in high-resolution crystal structures (). The dataset includes types of RNA used in previous benchmarks (), including tRNA (), 5S rRNA (), Signal Recognition Particle (SRP) RNA (), RNase P RNA () and small subunit rRNA Page: 628 626632
Z.Xu and D.H.MathewsA B C) predicted by Dynalign or Multilign. In each plot, a dot indicates a base pair between nucleotides with indices as indicated along the x and y axes. The lower triangle shows the base pairs in the known structure and the upper triangle shows all base pairs possible for secondary structures with folding free energy change within the percentage intervals above the minimum free energy structure as annotated by color. In (A) and (B), the base pairs were predicted by Dynalign with M.thermoautotrophicum B 5S rRNA and Methanococcus voltae5S rRNA as the second sequences, respectively. In (C), the base pairs were predicted by Multilign together with other nine 5S rRNA sequences from M.thermoautotrophicum A2, M.thermoautotrophicum B, M.thermoformicicum, Methanobrevibacter ruminantium, Methanothermus fervidus, M.thermolithotrophicus, M.vannielii, M.vannielii, M.voltae. For these calculations, the default settings of Multilign were used.shows the results when structures are predicted for three different orders, chosen at random. This randomization also changes the sequence that is chosen to be the index sequence. (C) shows the prediction accuracy from 1 to 4 iterations.
A(). For SRP RNA, sequences shorter than 200 nt were removed from the dataset since they do not accommodate a consensus structures with longer sequences. From the sequence pool, 400 tRNA, 100 5S rRNA, 20 SRP RNA, 60 RNase P RNA and 40 small subunit rRNA were randomly selected without replacement. The sequences in each RNA type were divided into groups of 5, 10 or 20 sequences in a randomly ordered list. All methods except Dynalign and the single-sequence free energy minimization method (Fold in RNAstructure package;) ran on these divided groups. Fold was run on each sequence. Dynalign also ran on the divided groups of sequences but in a different style because it only predicts structures of two sequences at a time. For each group, the first sequence (used as the index by Multilign) in the group is predicted along with each of the other sequences by Dynalign. Therefore, there is more than one predicted structure for the first sequence, and only the structure predicted by the last Dynalign calculation is included in scoring.
Scoring of prediction accuracyPredicted structures are evaluated by comparison with known structures. Two scores, sensitivity and positive predictive value (PPV) are calculated. Sensitivity is the fraction of known pairs correctly predicted and PPV is the fraction of predicted pairs in the known structure (). When determining whether a predicted pair is consistent with a known base pair, up to one nucleotide rearrangement on one side of the base pair is allowed. Therefore, a predicted base pair (i, j) is correctly predicted if either (i, j),(i, j 1) or (i, j 1) appears in the reference structure (). This scoring scheme reflects the uncertainty of base pair matches in comparative sequence analysis and the conformational dynamics of RNA secondary structures.
RESULTS
Factors that may influence the accuracy of multilignMultilign uses a series of Dynalign calculations on two sequences to predict the common secondary structure for multiple sequences (). The threshold for allowing pairs in subsequent calculations, the choice of index sequence, the order of the sequences and the number of calculation iterations may impact the Multilign structure Page: 629 626632
Multilignprediction. Their influence on prediction accuracy was tested using 5S rRNA sequences. First, the influence of the threshold was tested. Empirically, it was determined that using both a maxdsvchange of 1% and a MaxPairs equal to the average length of the input sequences provides the best performance. These two cutoffs should be set to allow all the true base pairs in subsequent calculations, and also exclude competing false base pairs. In many cases, false base pairs can occur in structures with comparable or lower free energy changes than true base pairs because of imperfections in the nearest neighbor parameters. As shown in, when MaxPairs is set too small, e.g. 20, the false base pairs of low free energy are removed at the cost of removing true base pairs, therefore PPV is improved at the cost of sensitivity. When MaxPairs is set too large, e.g. 500, the competing false base pairs were not efficiently excluded. False positives were incorporated into the predicted structures and this compromised the prediction accuracy. Setting the MaxPairs to the average length of the input sequences, 120 in this example, is a reasonable choice. The influence of the choice of index sequence and the order of the other sequences were tested. The order of sequences was randomized and the first one was chosen as index sequence. Overall, it was found that this random ordering does not adversely affect the accuracy.shows an example of this with three different random orderings of 5S rRNA sequences. On average, the performance is the same with the three random orders, although in detail, the accuracy of structure prediction on a single sequence can vary. The final choice that may influence the accuracy is the number of iterations of the process. For example, after the first iteration, the folding space of index sequence should be well constrained, but those of the other sequences may not be.shows that a second iteration is necessary to improve the prediction of all sequences while extra iterations beyond appear to make no difference in the accuracy.
BenchmarkThe performance of Multilign in structure prediction was evaluated and compared with the nine other methods that predict conserved structures for three or more sequences: FoldalignM (), mLocARNA (), MASTR (), Murlet (), RNA Alignment and Folding (RAF) (), RNASampler (), RNAshapes (), RNAalifold () and StemLoc (). For comparison, the prediction results of single-sequence free energy minimization (Fold;) and Dynalign on the same dataset are also shown. The accuracy of structure prediction is illustrated in. For each type of RNA, the methods were evaluated over a dataset that is divided into groups of 5, 10 or 20 sequences to show how the number of sequences influences the prediction accuracies. All multiple sequence methods predict structures of tRNA with high accuracy. Multilign significantly improves the prediction in terms of sensitivity and PPV by 34%, as compared with Dynalign. As expected, Fold, the single sequence method, has the lowest prediction accuracies both in sensitivity and PPV. Multilign, FoldalignM, mLocARNA, RAF, RNASampler and StemLoc predict both sensitivity and PPV around or above 90%. The sensitivity of RNAalifold is about the same as Fold, although the PPV is significantly higher. For the predictions of 5S rRNA, all the multiple sequence methods again perform better than single sequence structure prediction. RNASampler stands out as having a particularly high PPV (> 90%), but at the cost of sensitivity. The accuracy of prediction by singlesequence free energy minimization is the worst, especially for PPV, which has an average of only 62.4%. The methods were also evaluated on longer sequences, namely the SRP RNA, RNase P RNA and small subunit rRNA. Not all the methods would run for these sequences on the available hardware because of their computational complexity. Surprisingly, for SRP RNA, Dynalign outperformed all the other methods in sensitivity, including Multilign. This is because some of the true base pairs are incorrectly ruled out early in the Multilign process (Supplementary). For RNase P, single-sequence free energy minimization outperforms all the other methods in sensitivity, but not PPV. One possible explanation is that structures of RNase P RNA vary more than those of other RNA types. It is therefore difficult to determine a single consensus structure, causing the algorithms tested here to perform poorly. For small subunit rRNA, only Multilign, Dynalign, RNAalifold, mLocARNA and RAF run successfully on the entire benchmark set. Multilign and mLocARNA have comparable sensitivities and PPVs. The sensitivity of small subunit rRNA prediction by Multilign is much higher than those of RAF (>10%) and RNAalifold (>5%), although RAF outperforms Multilign by  3% in PPV. It is also notable that the methods demonstrate different patterns of prediction accuracy as a function of number of input sequences. Prediction accuracies of some methods changes remarkably in 5-, 10-and 20-sequence calculations, while scores of others are stable. Multilign, FoldalignM and MASTR tend to have comparable or higher accuracy when using more sequences up to 20, as shown in. The prediction accuracies of the other methods show either an opposite pattern or a stochastic pattern in number of sequences utilized. The CPU time is reported for all the calculations in. The CPU time requirement for Multilign is roughly equal to the product of Dynalign time requirement, the number of iterations and the number of sequences in the calculation.shows that among all the algorithms that work with three or more unaligned sequences, i.e. not including Fold, Dynalign or RNAalifold, the time requirement for Multilign and RNAshapes scale the best in terms of the number of sequences. Although the absolute CPU time of some Multilign calculations is large, Multilign is the only parallelized software and a prediction of five small subunit rRNA sequences can be done in <1 day with Multilign running in parallel on eight cores.
DISCUSSIONMultilign combines free energy minimization and comparative sequence analysis to predict RNA secondary structures of multiple sequences with higher or comparable accuracy to Dynalign. It has among the best accuracy as compared with other algorithms that predict conserved structures for multiple sequences.
Strengths and limitations of MultilignMultilign inherits the strengths of Dynalign. It uses a dynamic programming algorithm to guarantee that the lowest free energy Page: 630 626632. The average structure prediction accuracies (PPV, left and Sensitivity, right) of 12 methods over tRNA, 5S rRNA, SRP RNA, RNase P and small subunit rRNA datasets. There are 400 sequences in tRNA, 100 in 5S rRNA, 20 in SRP RNA, 60 in RNase P and 40 in small subunit rRNA. The dataset for each RNA type is divided into groups of 5, 10 or 20 sequences and predictions were done on each group. The missing bars for some predictions indicate that the methods did not proceed on available hardware. The plotted error bars are 95% confidence intervals. conserved structure will be found for two sequences. The total free energy score optimized by Dynalign does not depend on sequence identity, which allows the algorithm to predict consensus secondary structures for homologous sequences with little sequence identity, e.g. as low as 20% in previous benchmarks (). Suboptimal structures can be predicted to provide alternative solutions and show the well-definedness of prediction by creating dot plots. Multilign extends Dynalign to multiple sequence prediction and improves the prediction accuracy as shown infor all types of RNA tested except for SRP RNA. Although the average improvement of Multilign over Dynalign does not appear large, this is because the improvement on sequences is averaged. The improvement of prediction accuracy for a single sequence can be large. Dynalign predicts structures well for a majority of the sequences, but poorly for a subset of sequences. Multilign, however, Page: 631 626632For Fold and Dynalign, the average of each calculation is reported here. Times are reported in hours (h), minutes (m) and seconds (s). N/A, 'Not Applicable,' is reported for programs that did not complete the calculation for small subunit rRNA on the available hardware.tends to improve the average accuracy of sequences for which Dynalign does well, but additionally it also dramatically improves the accuracy for structures poorly predicted by Dynalign (and Supplementary). In other words, Multilign does well by ensuring that the structure prediction accuracy will be uniform and generally good for all sequences in a set. Additionally, Multilign is able predict structures of an arbitrary number of long sequences. To our knowledge, this work is the first report of the prediction of multiple unaligned sequences as long as small subunit rRNA, which have a mean length of 1526 nt in this test set. Most algorithms failed to predict structures for long sequences or large number of homologous sequences on the hardware used for this study. Multilign has computation complexity linear to the number of sequences in time. In memory, the requirement does not increase with increasing number of sequences. Overall, Multilign improves prediction accuracy as compared with Dynalign. This is not, however, guaranteed in all cases, such as SRP RNA. Dynalign is accelerated by two steps of prefiltering that restrict the space of solutions that needs to be considered.
Z.Xu and D.H.Mathews
MultilignOne prefilter predicts structures for each sequence by free energy minimization and only base pairs that are in secondary structures within 30% of the lowest free energy are then allowed in Dynalign (). The other constrains the allowed alignment space with a probabilistic model predicted using a Hidden Markov Model (). It is known that these two steps exclude few genuine base pairs from consideration. Therefore, they influence a Dynalign structure prediction little, but they turn out to be a hidden problem for Multilign. If a genuine base pair is prohibited by a particular pairwise Dynalign calculation, it is permanently prohibited in all the following calculations (Supplementary). This effect is cumulative and can be a problem for sequence families that have diverse structures.
ProspectusGreat efforts have been placed on improving RNA secondary structure prediction. One way is to mimic comparative sequence analysis by predicting a structure for multiple sequences simultaneously. Some RNA types demonstrate great structural diversity, however, and are hard for current existing algorithms to predict their structures accurately. As reported in this work, structure prediction of SRP RNA and RNase P RNA remains a difficult problem because of structural heterogeneity. Another point worth noting is that not all methods predicting conserved structures for multiple sequences are guaranteed to perform better on average than single sequence folding. Furthermore, many of the available algorithms do not necessarily improve in prediction accuracy when more homologous sequences are utilized by the prediction. Clearly, no method yet replaces human expertise for comparative sequence analysis. The predictions from these programs need to be considered as hypotheses. Users may, for example, want to use multiple programs to develop hypotheses for subsequent study.
The Author 2010. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oup.com at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
