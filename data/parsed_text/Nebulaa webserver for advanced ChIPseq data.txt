Motivation: ChIP-seq consists of chromatin immunoprecipitation and deep sequencing of the extracted DNA fragments. It is the technique of choice for accurate characterization of the binding sites of transcription factors and other DNA-associated proteins. We present a web service, Nebula, which allows inexperienced users to perform a complete bioinformatics analysis of ChIP-seq data. Results: Nebula was designed for both bioinformaticians and biologists. It is based on the Galaxy open source framework. Galaxy already includes a large number of functionalities for mapping reads and peak calling. We added the following to Galaxy: (i) peak calling with FindPeaks and a module for immunoprecipitation quality control, (ii) de novo motif discovery with ChIPMunk, (iii) calculation of the density and the cumulative distribution of peak locations relative to gene transcription start sites, (iv) annotation of peaks with genomic features and (v) annotation of genes with peak information. Nebula generates the graphs and the enrichment statistics at each step of the process. During Steps 3â€“5, Nebula optionally repeats the analysis on a control dataset and compares these results with those from the main dataset. Nebula can also incorporate gene expression (or gene modulation) data during these steps. In summary, Nebula is an innovative web service that provides an advanced ChIP-seq analysis pipeline providing ready-to-publish results. Availability: Nebula is available at
INTRODUCTIONChromatin immunoprecipitation followed by high-throughput sequencing (ChIP-seq) is a technique that allows identification of binding sites of DNA-associated proteins. Most of the existing tools for ChIP-seq data analysis are ifficult to use by non-bioinformaticians. These tools map sequenced reads to the reference genome () or predict binding site locations (ChIP-seq peaks) (, for a review;). Several tools exist for peak filtering (), motif discovery () and genome feature association (). Such tools are often command-line applications, R packages or their use on the web is restricted to a limited number of sequences/data quantity. ChIP-seq data analysis solutions offering a graphical interface such as the main Galaxy server (), Cistrome (), CisGenome () and the web version of CEAS () can be very useful (in particular for biologists) when performing the first steps of ChIP-seq data analysis (Galaxy main) or further analysis of predicted binding sites (Cistrome, CisGenome and CEAS). However, none of these solutions provides the full set of tools needed for a complete ChIP-seq data analysis (Supplementary). Our goal was to develop a framework in which biologists could analyze their ChIP-seq data with minimal help of bioinformaticians, from read mapping to the analysis of binding site properties. However, bioinformaticians can also benefit from using such a framework.
METHODSOur web service, Nebula, is based on the Galaxy open source framework (), which is highly used by the research community (). The Nebula pipeline contains about 20 tools. It allows read mapping, peak calling, peak/gene annotation and de novo motif discovery. We used Perl and R to develop the tools that (i) calculate and visualize peak height distribution, (ii) calculate and visualize density and cumulative distribution of peak locations relative to gene transcription start sites (TSSs) provided by RefSeq (), (iii) annotate peaks with genomic features, (iv) annotate genes with peak information and (v) find genomic categories (promoter, enhancer, etc.) enriched in binding events. All these tools accept as a second input a file with control peak locations, so that the user can compare distributions calculated for ChIP and control experiments (see Supplementary Methods for more detail). In addition, tools (25) can use information about gene expression or gene modulation. This allows separate characterization of binding in expressed/silenced genes or in genes activated/repressed/ non-modulated by a transcription factor (TF) of interest. The pipeline also includes several published tools (samtools, MACS, FindPeaks and ChIPMunk). The pipeline can be used via Internet or can be downloaded and installed on a personal computer or server. A detail tutorial and a toy example are provided on the Nebula main page. The Nebula pipeline can be run from beginning to end in one stroke or each step can be run independently. Users can also build workflows based on their personal needs. *To whom correspondence should be addressed.
RESULTSWe developed a pipeline for advanced ChIP-seq data analysis that (i) is web-based, (ii) modular, (iii) includes several tools for data quality control and (iv) produces graphical output and necessary statistics.
Nebula functionalities
Read mappingThe primary step of ChIP-seq data analysis is read mapping. We provide capacities to do read mapping with Bowtie (). Bowtie is an ultrafast gapless aligner, which is optimal for mapping ChIP-seq reads. The standard format of raw reads accepted by Bowtie is 'fastq'. Thus, we added a tool, which converts SOLiD 'csfasta' and 'qual' files to 'fastq' files (). When reads are mapped, the user can get information about the number and quality of reads using tools 'flagstat' () and 'FASTQC' (www.bio informatics.babraham.ac.uk/projects/fastqc/).
Peak callingFor prediction of binding sites (peak calling), we implemented FindPeaks () and maintained MACS (), already existing in Galaxy. Findpeaks and MACS represent two families of peak calling tools: the former is based on tag extension and the latter on tag shift. We also developed a strategy to assess antibody quality and evaluate the false discovery rate (FDR) using FindPeaks. Briefly, we create a subset of control (input or nonspecific IgG) reads which contains the same number of reads as the ChIP dataset; we apply FindPeaks on both datasets and calculate peak height distribution (). Under the hypothesis that the peak height distribution for the control subset reflects the level of noise in the ChIP dataset, we can evaluate FDR of a subset of ChIP peaks higher than a given threshold T as the ratio of number of peaks higher than T in the control over the number of peaks higher than T in the ChIP dataset. Duplicate reads are excluded from the analysis. The user can also perform local filtering by removing ChIP peaks overlapping with peaks in the control.
Peak and gene annotationNebula calculates peak location distribution relative to gene TSSs (and C). Using gene expression or gene modulation data, Nebula can separate curves for expressed/silenced genes or genes activated/inhibited/ non-modulated by a given TF. When a user specifies boundaries of genomic categories (promoter, enhancer, gene downstream region, etc.), Nebula calculates the proportion of peaks falling in each category (). For each gene, Nebula identifies peaks falling in each genomic category () and calculates enrichment relative to the control and/or to the average peak distribution (data not shown). The user can choose to apply bootstrapping to attain enrichment P-values.
De novo motif discoveryWith Nebula, the user can run de novo motif finding in the whole set of peak sequences or in the areas centered on peak summits. The ChIPMunk tool () provided for this purpose allows two modes for finding multiple motifs. Mode 'mask' hides already identified motifs before each subsequent round of motif discovery and mode 'filter' eliminates complete sequences containing already identified motifs. In addition, the user can select for motif discovery peaks falling in a given genomic category, e.g. peaks in promoters of TF-activated genes or enhancers of TF-repressed genes.
Application to Spi-1 ChIP-seq data
The Author 2012. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions.com
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
V.Boeva et al. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from Conflict of Interest: none declared.
Web-server for advanced ChIP-seq data analysis at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
