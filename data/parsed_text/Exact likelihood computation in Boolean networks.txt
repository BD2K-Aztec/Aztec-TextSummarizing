Motivation: For biological pathways, it is common to measure a gene expression time series after various knockdowns of genes that are putatively involved in the process of interest. These interventional time-resolved data are most suitable for the elucidation of dynamic causal relationships in signaling networks. Even with this kind of data it is still a major and largely unsolved challenge to infer the topology and interaction logic of the underlying regulatory network. Results: In this work, we present a novel model-based approach involving Boolean networks to reconstruct small to medium-sized regulatory networks. In particular, we solve the problem of exact likelihood computation in Boolean networks with probabilistic exponential time delays. Simulations demonstrate the high accuracy of our approach. We apply our method to data of Ivanova et al. (2006), where RNA interference knockdown experiments were used to build a network of the key regulatory genes governing mouse stem cell maintenance and differentiation. In contrast to previous analyses of that data set, our method can identify feedback loops and provides new insights into the interplay of some master regulators in embryonic stem cell development.
INTRODUCTIONThe inference of signaling networks from biological data is of fundamental importance for a systemic understanding of regulatory processes. The statistical methods that have been developed for that purpose can be grouped according to the type of data that they expect as input. Many approaches use gene expression data. Some methods are based solely on static observations of the unperturbed system; they exploit the fact that fluctuations of interacting components are dependent (). The use of perturbation data greatly improves network reconstruction (). To resolve the order of events in a signaling cascade, time-resolved measurements after perturbation yield further improvements (). Boolean networks are an appropriate tool for dealing with this type of data (). The most difficult problem lies in accounting for the mostly unknown time delays with which the signal is propagated through the network (). In this work, we propose Boolean networks with probabilistic time delays as a novel statistical network inference method. There have been attempts to calculate the likelihood of a Boolean network in special cases by using Markov Chain Monte Carlo (MCMC) sampling () and for dynamic nested effects models (). Exact results were so far obtained only under strong restrictions on the logic functions involved, as in the context of conjunctive Bayesian networks (). By analytically marginalizing over the unknown delay times, we derive our main result, an exact and efficient recursive likelihood formula for a broad class of Boolean networks with exponentially distributed time delays that may include feedback loops. We evaluate our method in various simulation scenarios for its ability to recover the unknown topology. The method is then applied to a murine stem cell knockdown data set by, which consists of a set of whole genome gene expression time series after the knockout of six genes (Essrb, Sox2, Nanog, Tcl1, Oct4 and Tbx3) that are considered key regulators in the maintenance and differentiation of mouse embryonic stem cells. Our analysis reveals more feedback loops than previously detected.
METHODSWe aim to model central aspects of dynamic signaling networks, namely, combinatorial regulation, and time delayed responses in gene activity. All signaling components are considered either active or inactive, i.e. they are represented as binary variables. The activity of each component is modeled as a Boolean function of its parent variables in the network. *To whom correspondence should be addressed. y The authors wish it to be known that, in their opinion, the first two authors should be regarded as Joint First Authors. Signaling in biological networks occurs with time delays, which are suitably modeled by the Boolean networks introduced later in the text.
Boolean networks with unknown time delays and interventionsLet G  f1,. .. , Ng be a set of N signaling components that dynamically interact with each other via transcriptional regulation, and let F  f0, 1g be a Boolean field. Our model represents intracellular gene regulation by a directed graph given by an adjacency matrix  2 F GG. It is understood that  ij  1 whenever i is a parent, i.e. a regulator of j. At each time point t, a gene j 2 G is characterized by two Boolean variables A j t and B j t. The induction state variable A j t tells us whether gene j is either transcribed at its basic rate or whether it exhibits altered transcription (A j t  0 or 1, respectively). The activity state variable B j t reports whether the signaling molecule j is in its basic functional state or whether its function is altered at time point t (B j t  0 or 1, respectively, see). It helps to think of the induction states as genes and their expression, and the activity states as the corresponding gene products (proteins) and their activity as transcription factors. Although protein activity can be measured in some instances, it is generally hard to obtain timeresolved data. Therefore, we will infer the activity variables from the expression of their known target genes. The induction state A j t of j at time t is determined instantaneously by the activity states B i t of its parents i 2 pa j G via a Boolean function f j : F paj ! F, A j t  f j B i t; i 2 pa j , j 2 G, t 2 0, 1 1If paj  ;, f j is a constant. The family ff j jj 2 Gg of Boolean functions is denoted by F. The changes in the activity state of gene j are transmitted to changes in the corresponding activity state with a constant time delay d j 2 0, 1, B j t  A j t  d j  for t ! d j A j 0 else & , j 2 G, t 2 0, 1 2 Let   fd j jj 2 Gg. The graph , together with F and  define the dynamics of all binary variables in the model. To completely specify the Boolean network, we need to initialize the values of A j t at t  0. Through an intervention experiment, some induction states are actively set to 1, A j 0  1 (e.g. by a gene knockdown), whereas the rest of the variables are initialized by 0. At the same time, all feedback to an actively perturbed induction state variable A j is blocked, which is reflected by the removal of all incoming edges to A j .In practical situations the delay times  are rarely known. We account for this fact by considering the delay times as unknowns for which we specify their prior distribution. The prior is a product of independent exponential distributions, one for each individual delay time, ;   Y N j1 j d j ; j  , j d j ; j   j exp j d j  if d j ! 0 0 otherwise
RESULTS
Performance on synthetic dataHaving in mind the application to stem cell differentiation data with six genes (see Section 3.2), we manually chose five representative topologies with six nodes for our simulation studies with an OR as sole Boolean function. The delay times d g for each gene g were sampled uniformly from the intervalmin. The measurements were generated after t  f0, 15, 30, 45, 60g min. For each topology, we then calculated the binary activity patterns B g t for each single gene knockout g. The local probability distributions L  fPD j jB j ; j 2 Gg are taken asfor 2 f0:006, 0:12, 0:24, 0:36, 0:46, 0:58g. We assume that vague prior knowledge about the delay times is available by choosing the hyperparameter g of the exponential delay time prior such that their expected value equals the respective true delay time d g. For each topology, we started 100 MCMC runs with 2000 steps (see Supplementary Material S3 for details on the MCMC method). The likelihood requires the summation over all possible state sequences B 2 F NK. This makes calculations infeasible even for medium-sized networks. We address this problem by restricting the model space search to state sequences that are in the immediate vicinity of the best scoring state sequence B max. To find B max , we exploit the fact that in our model, the hidden state variables B j change their value from 0 to 1 at most once in their time course (due to the monotonicity of the chosen Boolean function, OR). This means that for each B j we can summarize its time course by denoting the time at which the state change occurs by the random variable T j called change point. The contribution of the hidden state B j to PDjB, L iswhere  k 4T j   1 if k 4T j 0 else & is the indicator function.Thus, there are at most K  1 different time courses for B j [(0,0,. .. ,0), (0,0,. .. ,0,1),. .. (0,1,1,. .. ,1), (1,1,. .. ,. Enumerating these, we find the time course for B j that maximizes the term in (5). Doing so for all j 2 G, we find the best scoring state B max .shows the results for all five topologies. The model shows a good overall performance for low and moderate noise levels. It performs best on tree topologies (), which are often encountered in biological pathways. Another frequent pathway motif is the feed-forward loop, as modeled in. The addition of feedback to the linear topology indecreases performance, but it still remains at a reasonable level.shows the results on a biological network from literature [of the stem cell differentiation pathway from Anchang et al.. Specificity and sensitivity are comparable with the simpler topologies AE.
Application to stem cell differentiation dataOur model calls for time series measurements of protein activities after single gene knockouts. Data of that kind are still sparse. We circumvented this problem and increase the applicability of the method by treating the binary activity state variables as hidden variables. Our data consist of time series of measurements D  D j  k  of the activity states B j  k , j 2 G, at a finite number of K  1 time points 0  0 5 1 5 2 5. .. 5 K .Function score(B, ,  ): input: state sequence B, switch time , parameter of the integral For each k, find the interval  ik , ik1  where the switch in the state sequence B happens calculate:This is done using the following recursion formula:Here, ^  j, ;  and ^ c j, ;  are constants defined as ^  j, ;    ^ i  j, ;  i1, ..., k , ^ i  j, ;   i if i 6 2 fj,  j , 2  j ,. . .g i  if i 2 fj,  j , 2  j ,The data D j  k  can be thought of as a noisy possibly replicate quantification of the hidden activity states B  fB j  k ; j 2 G, k  0,. .. , Kg. We relate measurements to their underlying activity state through time-independent local probability distributions L  fPD j jB j ; j 2 Gg. Given the hidden induction states B and the local probabilities L, the probability of observing D isEquation (6) assumes independence of observations. The likelihood then becomesThus, we can apply the method to the dataset of Ivanova et al.(2006) who used short hairpin RNA loss of function techniques to downregulate genes whose expression patterns suggest selfrenewal regulatory functions in mouse embryonic stem cells. Genome-wide gene expression time series measurements after t  0, 1,. .. , 7 days were obtained after knockdown of each of the following genes: Nanog, Oct4, Sox2, Tbx3, Esrrb and Tcl1. These genes are known to play a major role in stem cell differentiation and are therefore called 'major genes'.built a model with this knockdown data using dynamic nested effect models. The major genes represent the nodes in our network. The variables A j t and B j t correspond to their gene and protein activities, respectively. Because the activity states B j t are not directly measured by, we use the expression activity of gene groups under the regulatory control of the major genes [the E-Genes in the nested effect model ofas a proxy for their protein activity. To get the local probabilities PD j jB j  needed in the case of assuming hidden B j t, we use data from 122 genes given as discretized time series representing admissible patterns [see the Supplementary Materials of. In accordance with our definition, genes in their basic state were assigned the value 0, and assumed the value 1 on activation. We kept the grouping of the 122 genes into six groups of genes depending on Nanog, Oct4, Sox2, Tbx3, Esrrb or Tcl1 discovered from the E-Genes graph from Anchang et al. Because the data contain time series representing the undifferentiated cell culture (the negative control), and the cell culture undergoing normal differentiation (the positive control), we filtered for genes whose expression differed more than two-fold at the last time point between the two control experiments. Then, we assigned to each gene at each time point a probability to belong to the basal or the active state, according to whether its expression resembled more the negative or positive control (a likelihood ratio was calculated under the assumption of Gaussian expression distributions). Using the gene groups defined earlier, we calculated a likelihood ratio for each major gene to be active versus inactive as the product of the corresponding likelihood ratios of the assigned genes (this was done separately for each time point and each knockout). The likelihood ratios are then converted into a probability of being active (at a certain time point, in a certain knockdown experiment), which corresponds to the input required for our model. In this application, we only use the Boolean function AND, leading to monotonic activity states B. As described in Section 3.1, we chose the state sequence B max that maximizes PDjB, L. Using the same MCMC procedure as in the simulation setting (Supplementary Material S5), the stationary chain comprised 155 unique models. We used model averaging and calculated the weighted frequencies of each edge. Each model was weighted by its number of occurrences in the Markov chain, resulting in a probabilistic adjacency matrix (). Tcl1 has the lowest connectivity, whereas Nanog has the highest. To compare the results of our model with the model from Anchang et al. (), we converted the probabilistic adjacency matrix into a graph by drawing all edges with a probability 40.5 (). The most striking difference ofcompared withis the presence of cycles. In particular, the major genes Oct4, Sox2, Nanog and Esrrb form a maximal clique of the graph.The two graphs essentially agree on the position of Tcl1, which in both cases is targeted by Tbx3 and Esrrb. Also, Tbx3 is located mostly upstream of the Oct4, Sox2, Nanog, Esrrb clique in both graphs. Still, it is puzzling why our method finds a highly interconnected feedback-loop rich structure, whereas Anchang et al. find a sparser solution. The method in Anchang et al. assumes an acyclic graph structure, and hence by definition cannot find cycles. As our simulation studies have shown that the model can accurately predict circular structures in regulatory graphs, the feedback in this network might be higher, and the signaling hierarchy less pronounced than previously thought. This is confirmed by a different approach to mouse embryonic stem cell network reconstruction () that also discovers a large amount of interplay between the key regulators of stem cell differentiation. Zhou et al. have also reconstructed a mouse embryonic stem cell network based on transcription factor binding sites, protein interactions and literature annotation. They show bidirectional interactions of Oct4 with Nanog and Sox2 coinciding with our finding ().
A B C D
CONCLUSIONIn this work, we developed an algorithm that permits us to analyze gene knockdown time series experiments, which have high dimensional readouts (such as gene expression). To elucidate the interplay of the major regulators, all of them need to be perturbed and measured individually. On the side of methods development, we have solved the problem of calculating the likelihood function for data generated from a Boolean network with probabilistic exponentially distributed time delays (Algorithm 2). The likelihood function can be used for network reconstruction, as has been demonstrated in our simulation studies. Having a closed form solution for the likelihood has several further applications that we did not mention so far. It is possible to sample the joint distribution PBj, F ,  rather efficiently, because many observations B can be excluded a priori knowing  and F. This allows for accounting for some hidden variables B k among the observed B by integrating them out. Furthermore, it is possible to calculate the expectation of a certain B j to be on or off in a given time interval. As an application, we have devised a method to apply it to data in which the values of the Boolean network can only be observed indirectly (Algorithm 1). We analyzed murine stem cell differentiation data offor the purpose of signaling network reconstruction. Comparison with a previous reconstruction attempt inrevealed a much richer feedback structure than expected. Our method suggests regulatory feedback loops that lead to a better understanding of the dynamic interplay of some master regulators in murine embryonic stem cell development. We expect our method to find numerous applications, as protein abundance data become increasingly available ().
The Author 2013. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
& 3 Here,    j  is a tuple of appropriately chosen positive hyperparameters, and a complete parametrization of the model is given by the tuple M  , F , L, . 2.2 The likelihood function Let B  fB j  k ; j 2 G, k  0,. .. , Kg the observations of the binary state variables B j at K  1 time points 0  0 5 1 5 2 5. .. 5 K. Given a parametrization M of the model and some initial activation pattern, one seeks to calculate the probability of observing B, by integration over the unknown delay times, PBj, F ,   Z  PBj, F ,   ;   4 The major technical achievement of this article is the closed-form solution of the integral in Equation (4) for arbitrary Boolean networks (possibly including cycles) that satisfy a rather general admissibility condition (Supplementary Material S1). The class of Boolean networks that can be inferred includes all acyclic networks, and all networks that allow each node to switch only once, yet it is substantially larger. As the derivation of this result requires tedious calculations and elaborate notation, we just give the algorithm for the likelihood calculation in Algorithms 1 and 2 and refer to Supplementary Methods S2 for details. We also prepared a table of all symbols as Supplementary Materials S6. Some quantities arising during the calculation become extremely small, which bears the risk of underflow errors. Therefore, all necessary computations were performed in log space instead of using standard floating point arithmetic (Supplementary Material S3). Having scored a Boolean network, we search the space of all admissible signaling graphs by Markov Chain Monte Carlo as outlined in Husmeier (2003) (Supplementary Material S5). Our framework easily allows the modeling of a series of intervention experiments. Each intervention will produce its own sequence of state observations B, and each sequence will be evaluated separately by actively initializing the expression states of perturbed variables with 1 and blocking all feedback to this state by the removal of all incoming edges. Fig. 1. Schematic of the model for a fixed time point t: A i and B i are the induction and activity states, respectively, of each regulator f1, 2, 3g. The delays in signaling between an alteration of the gene state and an ensuing alteration of the activity state are given by   d i . Given all parent child relationships of the network, F  ff 1 , f 2 , f 3 g is the family of Boolean functions. Functions for nodes with 52 parents (A 1 and A 2 ) are constant
Exact likelihood computation in signal network reconstruction at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
S.D mcke et al. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
