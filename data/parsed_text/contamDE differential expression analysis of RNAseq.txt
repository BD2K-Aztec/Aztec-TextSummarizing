Motivation: Accurate detection of differentially expressed genes between tumor and normal samples is a primary approach of cancer-related biomarker identification. Due to the infiltration of tumor surrounding normal cells, the expression data derived from tumor samples would always be contaminated with normal cells. Ignoring such cellular contamination would deflate the power of detecting DE genes and further confound the biological interpretation of the analysis results. For the time being, there does not exists any differential expression analysis approach for RNA-seq data in literature that can properly account for the contamination of tumor samples. Results: Without appealing to any extra information, we develop a new method 'contamDE' based on a novel statistical model that associates RNA-seq expression levels with cell types. It is demonstrated through simulation studies that contamDE could be much more powerful than the existing methods that ignore the contamination. In the application to two cancer studies, contamDE uniquely found several potential therapy and prognostic biomarkers of prostate cancer and non-small cell lung cancer. Availability and implementation: An R package contamDE is freely available at
IntroductionThe primary goal of the ordinary differential expression (DE) analysis methods is to distinguish biological variation between various conditions from technical effects and random noises (). Since the clinical tumor samples obtained from patients are usually infiltrated with surrounding normal cells (), the traditional DE analysis cannot distinguish the expression variability resulting from the shifts in cell specific expression versus the cell proportion variation if the cellular contamination is ignored (). Ignoring the cellular contamination could also greatly lower the power of DE analysis (). Several experimental methods aiming at dissecting multiple distinct cell types have been developed to eliminate the effects caused by contamination, such as laser capture microdissection and cell sorting. However, these methods are expensive, time consuming and may introduce new confounders (). Computational approaches addressing the contamination issue could avoid such problems thus are much desired.The following linear equation is commonly used to model the microarray expressions of contaminated tumor cells ():where T, T C and T N represent the expression profile of the contaminated tumor cells obtained by experiments and those of the underlying tumor component and normal component, respectively, w is the pure tumor cell proportion in each contaminated tumor sample shared by all genes, while is the random error. RNA-seq data are inherently different from microarray data, and there is very limited work in literature focusing on the contamination issue for RNA-seq data, with a couple of exceptions (). Li and Xie (2013) used an online expectationmaximization algorithm to quantify the expression levels of purified tumor transcripts in a probabilistic fashion for better understanding the abundance of the tumor transcripts. Gong and Szustakowski (2013) developed a quadratic programming method to obtain sub-cell proportions by utilizing significantly differentially expressed genes of homogeneous samples as a prior. The above methods are subject to several limitations if they are used in DE analysis. First, it is hard to account for the variability of the purified expression profiles in the downstream DE analysis. Second, requiring extra information in the above methods greatly limits their applicability, since the extra information is expensive to obtain in practice. Third, additional bias could be introduced if the extra information is not accurate. To our best knowledge, there is no statistical method in literature that can properly account for the contamination of tumor samples in DE analysis using RNA-seq data, and we aim to fill this gap. In this article, we propose a new method 'contamDE', which is based on a novel statistical model for associating gene expression profiles and cell types. Based on this model, a rigorous and efficient statistical method is developed for DE analysis using RNA-seq data from contaminated tumor samples and normal samples. In contamDE, the normalized proportions of tumor cells in contaminated tumor samples are estimated, and DE analysis can be consequently carried out. The new method contamDE has several unique features. First, contamDE does not require any extra information that might be expensive to obtain in practice; second, the developed algorithm is computationally efficient; third, contamDE provides a unified procedure for DE analysis, which avoids the necessity of accounting for the variability of purified expression profiles required in the existing methods. The rest of this article is organized as follows. The technical details of the new method contamDE are described in Section 2. Some simulation studies and five real data applications are provided in Section 3 and Section 4, respectively, to demonstrate the advantage of contamDE over the existing methods. Some concluding remarks and future research topics are presented in Section 5.
MethodsIn this section, we describe the proposed method contamDE. We begin with the situation with a single tumor cell type, then extend the developed method to the situation with multiple tumor cell types.
Statistical modelsFirst, we consider the situation where the normal samples and the tumor samples are unmatched. Suppose the read counts of G genes are obtained from I 0 normal cell samples and I tumor cell samples, respectively. Let N ij be the number of the RNA-seq reads mapped to the jth gene (j  1;. .. ; G) for the ith normal cell sample (i  1; 2;. .. ; I 0 ); C ij the number of the RNA-seq reads mapped to the jth (j  1;. .. ; G) gene for the ith i  1; 2;. .. ; I pure tumor cell sample. In order to distinguish the systematic expression difference between various conditions by controlling the biological and technical variations, it is often advantageous to use the two-parameter negative binomial distribution to model the read counts generated from RNA-seq experiments (). We assume that N ij and C ij follow negative binomial distributions NBj i l j ; / j  and NBj 0 i l 0 j ; / j , respectively. Here NBl; / denotes the negative binomial distribution with mean l and dispersion parameter /, whose variance is l  l 2 /; j i and j 0 i are size factors accounting for library size effects, which can be estimated using any existing methods, e.g. the median normalization () and the quantile normalization (). We use the median normalization because it is quite robust to outliers and simple to implement. Let d j  l 0 j  l j be the mean expression difference between tumors and normals. We are interested in identifying those genes with DE profiles between tumor and normal samples, i.e. those j's with d j  0. In practice, the obtained tumor samples usually consist of both tumor cells and normal cells due to cellular contamination. Suppose that the ith contaminated tumor cell sample consists of a proportion of w i tumor cells and a proportion of 1  w i normal cells. Let T ij be the number of reads mapped to the jth gene of the ith contaminated tumor cell sample, which is equal to C 0 ij  N 0 ij , where C 0 ij and N 0 ij are the numbers of reads from pure cancer cells and pure normal cells, respectively. It is reasonable to assume that C 0 ij and N 0 ij follow negative binomial distributions NBj 0 i 1  w i l j ; / j  and NBj 0 i w i l j  d j ; / j , respectively, where w i and 1  w i are used to adjust the effects of cell proportions and j 0 i is a size factor, so that l j and l j  d j are adjusted means. The expectation of T ij is therefore j 0 i l j  w i d j , but the distribution of T ij would be rather complicated since N 0 ij and C 0 ij are correlated with each other. For the simplification purpose, we assume the following model: N ij $ NBj i l j ; / j  and T ij $ NBj 0 i l j  w i d j ; / j :Here NBj 0 i l j  w i d j ; / j  is different from 1  w i NBj 0 i l j ; / j  w i NBj 0 i l j  d j ; / j . The later distribution could be used to model the summation of two independent random variables. However, the independence assumption is violated in the current situation. It is unclear which of these two distributions fits T ij better, so we use the former one because the corresponding estimation procedure is simpler. Next, we consider the situation where each tumor sample is matched with a normal sample. The read counts N ij and T ij are matched if both tumor cell sample and normal cell sample are obtained from the same cancer patient, and their correlation should be accounted for. Actually, in a real prostate cancer study, we observed an evident positive correlation between the read counts from tumor sample and matched normal sample (Supplementary Material). Therefore, we use a fix effect to characterize such correlation. That is, we assume that N ij and T ij follow the negative binomial distributions with a common dispersion parameter / j and means j i l j e aij and j 0 i f1  w i l j  w i l j  d j ge aij , respectively: N ij $ NBj i l j e aij ; / j  and T ij $ NBj 0 i l j  w i d j e aij ; / j :The correlation between N ij and T ij is characterized by the shared fix effect a ij as inIn both unmatched-sample model (2) and matched-sample model (3), the mean expression for a contaminated tumor cell sample follows a semi-additive pattern. In the absence of contamination (i.e. w 1      w I ), the two models reduce to the logadditive models commonly used in literature (). The semi-additive models (2) and (3) greatly facilitate the estimation of the proportions w i , as will be shown in the next subsection. Note that the proportions w i are identifiable up to a scale parameter. We normalize the proportions such that their mean value is 1:Let the true proportions and mean expression differences be w i0 and d j0 , respectively, then the values of w i and d j satisfying constraint (4) are equal torespectively. As a result, for any 1 j G, the null hypothesis of interest H j : d j0  0 is equivalent to H j : d j  0. We have the following proposition:Proposition.The proposition immediately follows from the fact that two distributions are the same implies that they have the same first two moments. The normal samples and the tumor samples have non-negative mean expression profiles, so l j and d j should satisfy the following additional constraints: l j ! 0 and l j  w i d j ! 0 for i  1;. .. ; I:In the presence of contamination, the true proportions are smaller than 1. Therefore, the normalized proportion w i given in (5) would be greater than w i0 , and some of them could be greater than 1. Similarly, the absolute value of d j is smaller than that of d i0. Therefore, under constraint (4), the tumor-versus-normal fold change defined byis shrunk toward 1, compared with the true fold change. This is a tradeoff of not using extra information. The extent of shrinkage is decreasing in the magnitude of w i0. In particular, FC j is equal to the true fold change in the absence of contamination (i.e. w 10      w I0  1). Note that the likelihood ratio test we will use does not depend on the form of linear constraint since the likelihood function is invariant to the linear constraint.
Normalized proportion estimationIn this subsection, based on models (2)and(3), we construct appropriate estimators of w i subject to constraint (4) in the matched sample situation and the unmatched sample situation, respectively, without appealing to extra information. In what follows, we propose an initial estimator of w i , then update it in an iterative manner. The initial estimator could be much closer to the true one compared with the naive initial estimator (e.g. 1), which effectively save computational time, as confirmed in our simulation studies. First, we consider the matched sample situation. In what follows, we construct an initial estimator of w i and update the estimator based on a likelihood method. Under model (3), the means of j 1 i N ij and j 0 i  1 T ij are l j e aij and l j  w i d j e aij , respectively. Therefore, we can use the following moment estimating equation:Here X 1 is a set of DE genes ('working gene set' hereafter) used to remove the impact of non-DE genes since they are not informative in estimating w i and can introduce a tremendous noise. We can include either up-regulated genes or down-regulated genes, but it is not appropriate to include both types of genes as the information for estimating w i would be greatly obscured by doing so. If P j2X1 d j e aij is free of i, then it will not appear in the normalized w i estimator derived from (8). This motivates an initial estimator of w i given by. In practice, we can choose the working gene set X 1 using any DE analysis tool such as edgeR by ignoring the contamination of the tumor samples. Specifically, we select those genes with DE analysis P-values smaller than a small threshold value (say 10 3 ) and a negatively estimated log-fold change. Such a gene set results in virtually sound proportion estimators in both simulation studies and real data applications. We will give more details for obtaining such P-values in the next section. Now we update the proportion estimators.in the next subsection, an updated working gene set X 2 can be obtained based on the previous criterion (DE analysis P-value < 10 3 and log-fold change < 0). More accurate estimators of w i can be iteratively given byfor k  2; 3;. .. The iteration can be stopped if max i j ^ w k1 i  ^ w k i j < for some small. Denote by ^ w 1 i the converged estimator of w i. Next, we consider the unmatched sample situation. Under model (2), we have the estimating equationfor some working gene set X 1. This motivates proportion estimators(12) contamDEfor k  1; 2;. .. where X 1 ; X 2 ;. .. can be constructed similarly to the matched sample situation. Note that only the working gene set is updated in ^ w k i (k  2; 3;. . .) since P j2X d j is free of i.
DE analysis procedureIn this subsection, we give an outline for estimating unknown parameters (/ j , l j , d j ) and a j : a 1j ;. .. ; a Ij ; j  1;. .. ; G, which is followed by a DE gene detection procedure. Note that a j needs to be estimated only in the matched sample situation. The detailed algorithm for estimating unknown parameters are given in Supplementary Material Methods. First, we estimate the dispersion parameters / j and select a working gene set X 1. Since / j are nuisance parameters, for simplicity and other parsimonious reasons, we use an empirical Bayes strategy () to estimate the dispersion parameters / j by ignoring the contamination of the tumor samples. Let ^ / j denote the resulting estimator of / j. DE analysis is then carried out using the likelihood ratio test, which results in a P-value for each gene. A working gene set X 1 can then be selected (P-value < 10 3 and logfold change < 0). Next, we estimate l j , d j and a j with / j fixed at ^The pseudo-likelihood ratio test statistics for testing null hypotheses H j : d j  0 can be constructed immediately. The asymptotic null distributions of the test statistics are the chisquare distribution on 1 degree of freedom, so the P-values for testing H j : d j  0 easily follow. The algorithm for estimating all parameters is outlined in a flowchart (Supplementary Material).
Multiple tumor cell typesSome cancers have multiple tumor cell types. For example, some cancers have multiple subtypes (e.g. the main primary types of lung cancer include small-cell lung carcinoma and non-small-cell lung carcinoma), and some cancers undergo several stages with various tumor cell types. In Supplementary Material Methods, we describe a model and an outline of estimation and testing procedure for multiple tumor cell types.
Existing methodsDeMix () and UNDO () are two methods designed for the deconvolution of array-based data without using extra information. Our preliminary numerical study indicated DeMix might not be applicable to RNA-seq data, so we only considered UNDO in the following numerical studies. We also considered a couple of benchmark DE analysis methods, which ignored the contamination of tumor samples and had been implemented in the R Bioconductor packages edgeR and DESeq2, respectively. Refer to Supplementary Material Methods for the descriptions of DeMix, UNDO, edgeR and DESeq2.
Simulation studiesWe conducted simulations to evaluate the performance of contamDE. The data generation procedure and the corresponding simulation results in a two-condition situation (one tumor cell type plus one normal cell type) are described in the next three subsections. Some simulation results for multi-condition situation (two tumor cell types plus normal cell type) are reported in Supplementary Material Results and Supplementary Material Figures S3S5.
Data generationWe generated genewise read counts (G  10, 000) for six pure normal samples and six contaminated tumor samples. In the unmatched sample situation, the read counts N ij and C ij for pure normal and tumor samples were generated from NBj i l j ; / j  and NBj 0 i l j  d j , respectively; in the matched sample situation, the read counts N ij and C ij for pure normal and tumor samples were generated from NBj i l j e aij ; / j  and NBj 0 i l j  d j e aij ; / j , respectively. In both situations, the read count T ij for contaminated tumor sample was w i C ij  1  w i N 0 ij , where N 0 ji $ NBj i l j ; / j  in the unmatched sample situation and N ji 0 $ NBj 0 i l j e aij ; / j  in the matched sample situation, and N ij , N 0 ij and C ij were independent of each other. To evaluate the performance of UNDO, we considered two scenarios, one used N ij ; T ij  as in contamDE; the other used N 0 ij ; T ij . The proportions w i were either homogeneous (i.e. w 10      w 60  0:5) or heterogeneous (i.e. w i0  i=6). The description of the other parameters are given in Supplementary Material Methods. For each parameter combination, 100 datasets were generated.
Proportion estimation resultsWe evaluated three w i estimators, namely ^ w, we used the convergence criterion max i jw k1 i  w k i j < 10 4. For comparison purpose, we rescaled the w i estimators by 3:5=6 in the heterogeneous proportion situation and 0.5 in the homogeneous proportion situation, respectively. In the heterogeneous proportion situation (i.e. w i0  i=6 for i  1;. .. ; 6), the boxplots of the proportion estimates for 100 simulated datasets are depicted inand Supplementary Material. The initial estimator ^ w 1 i was much closer to the true one than the naive initial estimator 1, so using ^ w 1 i could effectively save computational time as claimed in Section 2.2. For example, in the unmatched sample situation, the average number of iterations with initial estimator ^ w 1 was around 2.7, and that with naive initial estimator 1 was 3.9. As shown in Supplementary Material, the w i estimation results did not depend on initial 'working gene set'. Furthermore, ^ w 2 i and ^ w 1 i were very close to each other, and their biases were much smaller than those of ^ w 1 i. For example, in the unmatched sample situation, the mean square error rates of's were 1:0  10 3 ; 0:7  10 3 and 0:7  10 3 , respectively. Therefore, we propose to use ^ wfor the sake of saving computational time. The saved number of iteration was particularly considerable in the matched sample situation, with an average value being 7.4. UNDO performed well only when the two samples used for deconvolution were perfectly matched (i.e. N 0 ij and T ij were used), while its proportion estimates were very close to 1 when N ij and T ij were used. Noted that the perfect matching scenario was very unrealistic since N 0 ij cannot be obtained in practice.In the homogeneous proportion situation (i.e. w i0  0:5), contamDE was quite unbiased (Supplementary Material), while UNDO produced similar results as above (results not shown).
DE analysis resultsIn contamDE, we used ^ w 2 i according to the previous simulation results. For comparison purpose, we also included a version of contamDE using true proportions (TRUE). The ability of DE analysis of TRUE, contamDE, edgeR and DESeq2 were evaluated through receive operating characteristic (ROC) curves, false positive rates (FPRs), true positive rates (TPRs) and false discovery rates (FDRs). We begin with the heterogeneous proportion situation. For each of 100 simulated datasets, the DE analysis P-values of the DE genes (either up-regulated or down-regulated) and equally expressed genes were used to produce ROC curves. In the heterogeneity proportion situation, the average ROC curves based on 100 simulated datasets are displayed in. Overall, TRUE and contamDE performed quite comparably, and they distinctly outperformed edgeR and DESeq2. Next, we present the FPRs and TPRs (nominal level  0.05) in. Among the four methods, TRUE and contamDE had slightly lower FPRs and they performed comparably with each other. Also, TRUE and contamDE were more powerful than edgeR and DESeq2, with power gains varying from 0.08 to 0.13. Overall, TRUE and contamDE performed comparably, and they outperformed edgeR and DESeq2 in terms of ROC curves and TPRs. This demonstrates that including extra accurate information on proportions has little power improvement in DE analysis. Finally, we compare the FDRs of the four methods. Among top N (N  200; 400;. .. ; 2000) genes with smallest DE analysis P-values, the average empirical FDRs for detecting DE genes based on 100 simulated datasets are reported in Supplementary Material. Evidently, TRUE and contamDE had much lower FDRs than edgeR and DESeq2. For each dataset, using the R function 'p.adjust', we also calculated the FDR-adjusted P-values (), then obtained the empirical FDRs at various nominal levels. The average empirical FDRs are again reported in Supplementary Material. TRUE and contamDE had much better control of FDRs than edgeR and DESeq, i.e, the empirical FDRs of TRUE and contamDE were much closer to the nominal levels. On the other hand, the four methods performed comparably in the homogeneous proportion situation (Supplementary Material Figs S10S12).
Real data applicationsFive publicly available datasets were used to evaluate the performance of contamDE. The first one had both RNA-seq data and whole-exome sequence data. The second one had experimental mixtures and the third one had numerical mixtures. These three studies were mainly used to verify the performance of proportion estimation. The forth and fifth ones were used to evaluate the DE analysis performance. In these studies, a gene was claimed to be differentially expressed if the DE P-value after Bonferroni correction was smaller than 0.05.
Proportion estimation performanceFirst, a non-small cell lung cancer (NSCLC) study () with both RNA-seq data and whole-exome sequence (WES) data were used to validate the proportion estimation performance. In this study, RNAs of tumor tissue from each of 165 NSCLC patients were sequenced on an Illumina Hiseq 2000 platform. WES data for the tumor tissues were available for two patients. We downloaded the RNA-seq data and the corresponding WES data for these two patients, and the RNA-seq data for three randomly selected normal samples (NCBI website http://www.ncbi.nlm.nih.gov, accession IDs: PRJEB3132). After some data processing, we obtained the RNA-seq read counts of 12 382 genes for each of the five samples (Supplementary Material Results). The DNA-seq reads from the WES data were aligned to human reference genome hg19 (UCSC release) using Bowtie2 (), and a java based SNP caller 'Virmid' () designed for matched samples was used to identify contamination levels for these two samples, which could serve as golden standards. By (5), the truecontamDEproportions w i0 's can be estimated by contamDE with some additional information (e.g. the average proportion). In detail, we estimated the mean proportion (i.e. w 10  w 20 =2) of the two samples using Virmid, then rescaled the normalized proportions estimated by contamDE to obtain the estimates of w 0i. As shown in, the resultant estimates by Virmid and contamDE were quite close to each other, which well verified the validity of contamDE. On the other hand, the proportion estimates produced by UNDO were close to 1, which coincided with UNDO 1 for the simulation data (). Next, we applied contamDE to experimental mixtures of two lung adenocarcinoma cell lines (i.e. NCI-H1975 and HCC827) (). In this experimental mixture study, the sequence data were obtained for three NCI-H1975 samples, three HCC827 samples, and three biological replications of mixtrue samples at three mixture levels (NCI-H1975 versus HCC827 ratios were 1:3, 1:1 and 3:1, respectively). Therefore, the true proportions of NCI-H1975 in the three mixture samples were 0.25, 0.5, 0.75, respectively. We downloaded the summarized read count data for all the 15 samples from http://www.ncbi.nlm.nih.gov/geo (accession ID:GSE64098). The read counts for 23 669 genes were obtained. Using the pure samples of NCI-H1975 and HCC827, the proportions estimated by contamDE and UNDO were very both closed to 1 (). We selected 12 combinations, each combination consisted of three pure samples and three matched mixture samples (Supplementary Materials). Since the average proportion of the mixture samples in each combination was 0.5, we rescaled the normalized proportion estimates of contamDE by multiplying 0.5. The mean square errors of the estimated proportions were 0.007 and 0.21 for contamDE and UNDO, respectively (), showing that contamDE had a much higher precision than UNDO. Altogether, contamDE identified 4797 DE genes, compared with 4767 and 4087 by edgeR and DESeq2, respectively (Supplementary Material). Since there was no ground truth, we treated the 3914 genes identified by all of the three methods as 'true' DE genes as suggested by. Overall, contamDE obtained many more 'true' DE genes than edgeR and DESeq2 (Supplementary Material). Finally, we applied contamDE to a Drosophila melanogaster study (). We downloaded the read count data summarized by. In this study, there were seven RNA-seq samples of Drosophila melanogaster S2 cells, of which three samples were treated with siRNA targeting the splicing factor pasilla (CG1844) (referred to as cell type 'A') and four samples were untreated (referred to as cell type 'B'). The read counts for 7196 genes were obtained. As shown in, the estimated w i 's of contamDE were very close to 1. Since the original type 'A' cell samples were pure, the true proportions should be 1. These proportion estimates again demonstrated a pretty good performance of contamDE. The numbers of DE genes identified by contamDE, edgeR and DESeq2 were 187, 188 and 265, respectively (Supplementary Material). The number of DE genes identified by both contamDE and edgeR was 184, showing a pretty high concordance between the results of contamDE and edgeR. Again, we treated the 169 genes identified by all the three methods as 'true' DE genes, and used artificial counts for contaminated tumor samples to validate the performance of the considered methods through the identified 'true' DE genes (Supplementary Material Results). With artificial count data, contamDE was found to be more accurate than UNDO in estimating contamination proportions, and contamDE identified many more 'true' DE genes than edgeR and DESeq2 (Supplementary Material Figs S15 and S16).
DE analysis performanceThe prostate cancer data were downloaded from the EMBL-EBI website http://www.ebi.ac.uk/ (accession ID: E-MTAB-567). In this study, a prostate cancer cell sample and adjacent normal cell sample were provided by each of 14 patients from Shanghai Changhai Hospital (). After some data preprocessing, we obtained read counts for 12 698 genes (Supplementary Material Results). Using contamDE, the maximal w i estimate was 1.38 while the minimal one was 0.54, revealing an impressive heterogeneity of proportions across the contaminated tumor samples (Supplementary Material). To verify the proportion estimation accuracy and the DE analysis power of contamDE, we adopted the same strategy used in Drosophila melanogaster study to generate artificial read counts for contaminated tumor samples, refer to Supplementary Material Results for details. Again, the proportion estimates were accurate enough and contamDE was more powerful than edgeR and DESeq2 (Supplementary Material). The proposed method contamDE identified most DE genes, with a number of 1031, compared with 948 and 1022 by edgeR and DESeq2, respectively. Altogether, 810 genes were commonly identified by all the three methods, while 85 uniquely by contamDE, 15 uniquely by edgeR and 129 uniquely by DESeq2. See Supplementary Materialfor more details. We further investigated the identified DE genes through database mining and functional analysis. Several genes uniquely identified by contamDE were found to be closely related to prostate cancers, i.e. PDLIM4 and RASL11A were explored to be candidate biomarkers for prostate cancers. The uniquely identified GO terms enriched by contamDE were associated with gene functions of epithelial cell development, membrane and cellular proliferation that played important roles in tumor progression. Refer to Supplementary Results for more information.In our NSCLC study, six NSCLC patients from Shanghai Changhai Hospital provided tumor samples and adjacent normal samples. The RNA samples were extracted and sequenced using Illumina Hiseq 2000 platform. Refer tofor details of this study. After the same data preprocessing as the prostate cancer study, we obtained the read counts for 13 312 genes for each of the 12 samples. The normalized proportions w i for tumor cell samples estimated by contamDE (Supplementary Material) ranged from 0.57 to 1.47, indicating a considerable heterogeneity of proportions. As in the prostate cancer study, artificial read counts were generated to examine the accuracy of proportion estimates and DE detection power of contamDE, refer to Supplementary Material Results for detailed description. Again, contamDE was shown to be more powerful than edgeR and DESeq2 in detecting DE genes (Supplementary Material). The numbers of the DE genes detected by contamDE, edgeR and DESeq2, respectively, are shown in Supplementary Material. Again, contamDE identified most DE genes, with a number of 477, compared with 454 and 405 by edgeR and DESeq2, respectively. Altogether 307 genes were commonly identified by all the three methods, while 75 uniquely by contamDE, 23 uniquely by edgeR and 53 uniquely by DESeq2. In these 75 genes, three were demonstrated in literature to be potential therapeutic drug targets in vivo for NSCLC. Moreover, three GO terms uniquely detected by contamDE were related to the gene functions of cytoskeletal part, cell-substrate junction and cytoskeleton, which had close relationship to tumor cell migration and invasion in non-small cell lung carcinomas. Refer to Supplementary Material Results for more information.
DiscussionIn this article, we present a rigorous and efficient DE detection method contamDE using RNA-seq data from contaminated tumor samples, where the tumor samples could be either matched or unmatched with normal samples. Unlike most existing methods, contamDE does not require extra information. The normalized proportions reflect relative contamination intensities of the contaminated tumor samples, and the true proportions can be estimated if some pathology information or DNA sample is available. The proposed normalized proportion estimator was evaluated through both simulation studies and experimental/numerical mixture data. Through both simulation studies and real data applications, UNDO (an existing deconvolution algorithm originally designed for arraybased data without using additional information) performed well only when the samples were pure (and D) or the two samples used for deconvolution were perfectly matched (UNDO 2 in). In more practical situations, UNDO either greatly overestimated the proportions (UNDO 1 in Figs 1 and 4A) or had a much larger variance than contamDE (). In the presence of contamination, contamDE were shown through simulations to greatly outperformed the benchmarks edgeR and DESeq2 that ignored the contamination in terms of both powers and false discovery rates; in the absence of contamination, contamDE performed comparably with edgeR and DESeq2. In the application to a prostate cancer study and a lung cancer study, contamDE returned more biologically meaningful DE genes that were closely related to cancers, compared with edgeR and DESeq2. An R package implementing contamDE can be downloaded from http://homepage.fudan.edu.cn/zhangh/softwares/, which can be used to estimate the normalized contamination proportions of contaminated tumor samples, to conduct pseudo-likelihood ratio tests for detecting DE genes between tumor samples and normal samples, and to estimate fold changes. Using a desktop computer with a 3.20 GHz CPU, it took contamDE no more than 10 minutes to analyze all considered real datasets, revealing that the computational burden of contamDE was quite acceptable.
at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
Q.Shen et al. at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
