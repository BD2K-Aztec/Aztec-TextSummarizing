Motivation: Flow cytometry is a widely used technique among biologists to study the abundances of populations of microscopic algae living in aquatic environments. A new generation of high-frequency flow cytometers collects up to several hundred samples per day and can run continuously for several weeks. Automated computational methods are needed to analyze the different phytoplankton populations present in each sample. Software packages in the programming environment R provide powerful tools for conducting such analyses. Results: We introduce flowPhyto, an R package that performs aggregate statistics on virtually unlimited collections of raw flow cytometry files and provides a memory efficient, parallelized solution for analyzing high-throughput flow cytometric data. Availability: Freely accessible at
INTRODUCTIONPhytoplankton are microscopic algae that are at the foundation of the marine food web and can influence Earth's climate. Flow cytometry has provided new insights into phytoplankton ecology in freshwater and marine environments. It creates 'fingerprints' of phytopkankton cells based on their ability to scatter or re-emit specific wavelengths of light. This light can be detected and used to estimate cell size and the composition of photosynthetic pigments that are used to distinguish different phytoplankton populations. In the last decade, several high-frequency flow cytometers have been developed to study phytoplankton community structure at very fine spatial and temporal scales, collecting several hundreds of samples per day for several weeks. One of the largest flow cytometry datasets publicly available to marine biologists is produced by a new generation of flow cytometer created at the University of Washington, called SeaFlow, that continuously measures phytoplankton composition and abundance. The instrument generates the equivalent of 6700 samples, representing a dataset of 35135 GB, after a typical 2-week long oceanographic cruise (). Software tools for automated data analysis and visualization of phytoplankton populations is therefore essential. We describe the R package flowPhyto, which provides a
COMPUTATIONAL ANALYSISThe flowPhyto package consists of a collection of functions that turn the high volume of flow cytometry files into customizable cytograms, georeferenced images and a summary data table.depicts the analysis pipeline from raw flow cytometry files to end statistics through four batch processing steps, namely filter, classify, census and summarize. Each step makes a separate pass over the entire repository and processes the samples in a highly parallel fashion using file-based wrapper functions. Unlike a traditional flow cytometer, SeaFlow directly analyzes a raw stream of seawater using two detectors that determine the position of a particle in the focal region of the instrument optical system (). The filter function selects optimally positioned particles (OPP) in each EVT file and creates an OPP file used to distinguish the different phytoplankton populations. Because the characteristics of each phytoplankton population vary according to environmental conditions and instrument settings, a table of customizable parameters (pop.def.tab) is used to define the pre-gating regions and statistical priors of phytoplankton population clusters. The classify function uses these predefined parameters and inputs one or more OPP files (3 by default) to classify individual phytoplankton cells into different populations using statistical clustering methods (). The function can also input FCS files after conversion to OPP files. For each group of OPP flowPhytofiles, classify outputs corresponding vector files (consensus.vct) that contain the population identification of the cells. classify is run in single file increments to provide multiple passes over a single cell and strengthen the clustering analysis. During the census step, these multiple-pass vector files are collapsed into one consensus vector, which represents the most likely population classification of the different phytoplankton cells. In addition, census produces a one-row census tab file that contains the number of cells per population for each file. The concatenation of these census tab files is used to create a per-population resampling scheme that calculates the number of OPP files necessary so a sufficient number of cells (500 by default) is present in the resampled population. The summarize function performs per-population aggregate statistics using the resampling scheme and associates the corresponding acquisition time and location. It outputs a summary table (stat.tab) of the entire dataset that can easily be exported by the user.
VISUALIZATIONThe filter step optionally outputs a quality control plot for the position-sensitive detectors specific to SeaFlow technology. plotCytogram outputs a series of customizable 2-D cytograms to visualize the various phytoplankton populations present in the sample for each OPP or FCS file.The plotStatMap creates customizable plots of the georeferenced data created by summarize. A combination of the different parameters per population or a single parameter over different populations can be selected depending on the purpose of the analysis. Hotspots of phytoplankton diversity and abundance are shown in.
CONCLUSIONflowPhyto provides an efficient approach for the analysis of highthroughput flow cytometry data. Although this approach provides an unique solution for the analysis of SeaFlow data repository, it is also compatible with standard flow cytometry data.
* To whom correspondence should be addressed.  The authors wish it to be known that, in their opinion, the first two authors should be regarded as joint First authors. disk-based, parallelized solution to the analysis of high-throughput flow cytometric data. 2 DATA STRUCTURE The flowPhyto package is compatible with conventional Flow Cytometry Standard (FCS) files (Spidlen et al., 2010), as well as those from the SeaFlow repository. SeaFlow data are stored in a custom binary file (EVT file) created every 3 min and consists of eight 16-bit integer channels (see Ribalet et al., 2010 for more details). The acquisition time and location (longitude and latitude) of EVT files is written into a log file (SDS file). The SeaFlow repository is composed of julian day labeled directories, each containing chronologically-ordered EVT files and an SDS file. The partioning of the data circumvents hardware memory constraints and enables parallelization over a beowulf class computer cluster. As an example, we use a subset of SeaFlow data available at http://seaflow.ocean.washington.edu that represents 1 day (480 files) of an oceanographic cruise that took place in Puget Sound, WA, USA, in November 2009. The goal of the study was to identify hotspots of phytoplankton diversity and abundance.
The Author 2011. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oup.com at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from [10:22 10/2/2011 Bioinformatics-btr003.tex]
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
