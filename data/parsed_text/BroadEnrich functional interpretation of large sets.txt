Motivation: Functional enrichment testing facilitates the interpretation of Chromatin immunoprecipitation followed by high-throughput sequencing (ChIP-seq) data in terms of pathways and other biological contexts. Previous methods developed and used to test for key gene sets affected in ChIP-seq experiments treat peaks as points, and are based on the number of peaks associated with a gene or a binary score for each gene. These approaches work well for transcription factors, but histone modifications often occur over broad domains, and across multiple genes. Results: To incorporate the unique properties of broad domains into functional enrichment testing, we developed Broad-Enrich, a method that uses the proportion of each gene's locus covered by a peak. We show that our method has a well-calibrated false-positive rate, performing well with ChIP-seq data having broad domains compared with alternative approaches. We illustrate Broad-Enrich with 55 ENCODE ChIP-seq datasets using different methods to define gene loci. Broad-Enrich can also be applied to other datasets consisting of broad gen-omic domains such as copy number variations. Availability and implementation: http://broad-enrich.med.umich.edu for Web version and R package.
INTRODUCTIONChromatin immunoprecipitation followed by high-throughput sequencing (ChIP-seq) identifies transcription factor (TF) binding sites and the locations of histone modifications (HMs) across the genome (), and is a step toward better understanding the gene regulatory programs of living organisms. Numerous algorithms, termed peak callers, have been developed to detect the genomic regions of significant signal (peaks) within the millions of aligned reads resulting from ChIP-seq experiments (). Some of these peak callers are geared specifically to HMs, which are known to exhibit broader enriched domains on average compared with TFs (). HMs are numerous and varied, and like TFs, often drive the regulation of a specific biological program, such as cellular differentiation () or growth (). Specific signatures often occur at HM intersections, such as the bivalent domains observed for H3K4me3 and H3K27me3, which mark genes expected to be activated on cellular differentiation (). Other histone changes occur in disease progression () or in response to environmental signals (). Such signatures are likely often cell-type and context specific, and therefore, assessing the biological commonalities among the targeted genes is a question of intense interest. Gene set enrichment (GSE) is a common approach to infer biological function given a set of experimentally derived genes (). GSE was originally developed to biologically interpret lists of differentially expressed genes derived from microarray studies () in terms of particular biological functions, processes or pathways [e.g. Gene Ontology (GO) () or KEGG Pathways (. An early enrichment tool is DAVID (), which uses a slightly modified Fisher's exact test (FET) to determine whether experimentally derived genes significantly overlap a gene set representing a biological concept, relative to the remaining genes. Under the null hypothesis of no more overlap than expected by chance, FET assumes that each gene has the same probability of being detected as significant. In the context of GSE with ChIP-seq data, FET assumes that each gene has an equal probability of being associated with a peak. Although FET has been used with ChIP-seq data (), it is typically used only with peaks within or near gene promoters. When all peaks are used, the presence of a peak in a gene locus is often correlated with the length of the locus (), thereby violating the FET assumption. We refer to this correlation as the locus length bias. Given that some gene sets contain genes that have, overall, significantly longer (e.g. nervous system, development and transcription related) or shorter locus length (e.g. metabolic processes and stimulus responses) than the average locus length, the possibility of confounding exists when no correction is made for locus length (). Using FET with only peaks near gene promoters removes nearly all of the length bias, but also ignores a large portion of the data. Recent GSE tools for ChIP-seq experiments have attempted to correct for this length bias. One such tool, Genomic Regions Enrichment of Annotations Tool (GREAT), uses a binomialbased test to test whether the total number of peaks within the loci in a gene set is greater than expected relative to the total number of peaks, the total locus length of the gene set and the non-gapped length of the genome (). In contrast to FET, the binomial test of GREAT assumes that the number of peaks in a locus and the locus length are proportional. Thus, FET and the binomial test have opposing assumptions regarding the relationship between the presence of a peak in a *To whom correspondence should be addressed.  The Author 2014. Published by Oxford University Press. This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (http://creativecommons.org/licenses/by-nc/3.0/), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com genomic region and the length of that region. Although FET is typically used after classifying each gene as either (i) having at least one associated peak or (ii) having no peak, the binomial test uses the total number of peaks. Both methods typically use a single nucleotide point, the midpoint or mode of the peak, to represent the entire peak region. We examined 100 TF and 55 HM ChIP-seq experiments from ENCODE (ENCODE Project) for differences between peak sets from transcription factor-and histonebased ChIP-seq experiments. HM peak sets have been observed to have broader peak regions than TFs, with individual peaks often spanning multiple genes (). We hypothesized that an enrichment method using such relevant regulatory information rather than simply the midpoint of each peak, as both FET and the binomial test do, would improve performance for HMs and other experiments resulting in broad domains. To incorporate the properties of broad-domain peak sets into functional enrichment testing, we developed Broad-Enrich to functionally interpret large sets of broad genomic regions. A unique feature of our method is that we score gene loci according to the proportion of the locus covered by all peaks overlapping the locus, which we will refer to as the coverage proportion. BroadEnrich then uses a logistic regression model that empirically adjusts for any bias in gene locus coverage relative to locus length, avoiding the pitfalls of either FET or binomial-based tests. We show that Broad-Enrich exhibits the correct type I error rate across 55 permuted ENCODE ChIP-seq datasets. We then illustrate the benefits of Broad-Enrich across the same set of 55 datasets, concentrating on H3K4me1,-2 and-3, H3K9me3, H3K27me3 and H3K79me2 in the GM12878 cell line.
MATERIALS AND METHODS
Gene locus definitionsWe define a gene as the region between the furthest upstream transcription start site (TSS) and furthest downstream transcription end site (TES) for that gene. The UCSC knownGene table (human genome build hg19) was used to define TSS and TES sites. We removed small nuclear RNAs, as they are likely to have different regulatory mechanisms than other genes and often reside within the boundaries of other genes. For functional enrichment testing, we use three primary definitions of a gene locus (). (i) Nearest TSS: the region between the upstream and downstream midpoints of a gene's TSS and the adjacent gene's TSS, equivalent to assigning each peak to the gene with the nearest TSS. (ii) 5 kb: the region within 5 kb of all TSSs in a gene. If TSSs from the adjacent gene(s) are 510 kb away, we use the midpoint between the two TSSs as the boundary of the locus for each gene. (iii) Exons: the exons of each gene. When exons from multiple transcripts of the same gene overlap, the exons are consolidated into one continuous region. In the R package and on the Web site, we include two additional definitions. (i) Nearest gene: the region from the midpoint between the TSS and the adjacent gene's TSS or TES (whichever is closest) to the midpoint between the TES and the adjacent gene's TSS or TES (whichever is closest). This is equivalent to assigning peaks to the nearest gene; (ii) 1 kb: same as 5 kb, but within 1 kb of all TSSs in a gene.
Proportional assignment of peaks to genesA unique feature of Broad-Enrich is how peaks are assigned to gene loci. For a particular gene locus definition, each locus is scored according to the proportion covered by the union of all peaks overlapping the locus (). Our approach accounts for the extent to which a locus is covered by a peak and allows coverage by multiple peaks.The proportion of each gene locus covered by ChIP-seq peaks from a given HM, or otherwise derived genomic regions, is determined. (3) For each gene set to be tested, logistic regression is performed using the model shown, where geneset refers to the binary vector of gene set membership, r refers to the vector of proportions of the gene loci covered by all peaks overlapping the respective loci, SS is a binomial cubic smoothing spline that corrects for any locus length bias and L is a vector of gene locus lengths. (4) P-values for enrichment or depletion are adjusted for multiple testing, and users are provided summarized functional enrichment results, peak to gene loci assignments and diagnostic plots i394 R.G.Cavalcante et al.
Annotation databasesFunctional enrichment results presented here are performed on gene sets constructed from the GO database and the KEGG Pathways database. We construct GO terms from GO biological processes, GO cellular components and GO molecular functions using the org.Hs.eg.db and GO.db R packages. All analyses in the article were performed using R version 3.0.1. KEGG pathways are inherited from LRpath (). Eleven additional annotation databases are offered in the R package, including cytoband regions, Biocarta () and Panther pathways (), pFAM () and gene sets derived from literature-based Medical Subject Heading terms (). Before enrichment testing, all gene sets are filtered through the user-selected gene locus definition so that only genes with a locus definition are included in the tests. By default, only gene sets containing between 10 and 2000 genes are tested. A minimum of 10 genes allows better convergence of the logistic regression model used for enrichment () and the maximum of 2000 genes avoids general, lessinformative gene sets. Annotation databases were built for human (hg19), mouse (mm9 and mm10) and rat (rn4).
Broad-Enrich method for functional enrichment testingWe use a logistic regression framework to test for functional enrichment, similar to LRpath (), an enrichment testing method developed for microarray data. The independent variable r for BroadEnrich is the vector of proportions of each gene's locus that is covered by the union of all peaks (visually represents these proportions). The dependent variable is a binary vector indicating gene set membership (1 if the gene belongs to the gene set and 0 otherwise). Let be the proportion of genes in the gene set at a specified r value and locus length L. Then, the ratio /(1  ) is the odds that a gene with peak coverage proportion r and locus length L is a member of a given gene set. If the log odds increase as r increases, then we conclude the gene set is positively associated with the coverage proportion, and thus enriched with the experimental set of broad genomic regions. We use the model:where b 0 is the intercept, b 1 is the coefficient of interest for the coverage proportion, the function SS is a binomial cubic smoothing spline that adjusts for the potentially confounding effect of locus length and the log 10 transformation is used to improve the model fit (data not shown). The smoothing spline function is fitted using generalized crossvalidation to estimate the smoothing penalty, , and 10 knots with the cubic spline basis as an approximation to a true cubic smoothing spline (. The overall model is fitted using a penalized likelihood maximization approach with the gam function in the mgcv R package (). A Wald test is used to test the null hypothesis H 0 : b 1 = 0 versus the alternative H 1 : b 1 6  0 and to calculate the P-value for the significance of the coverage proportion coefficient, b 1 (). Gene sets with b 1 40 are enriched, whereas those with b 1 50 are depleted. Pvalues are corrected for multiple testing using the BenjaminiHochberg false discovery rate (FDR) adjustment (). For presented analyses, gene sets with FDR50.05 are considered to be significant.The 100 TF datasets were originally called using a variety of peak callers according to the lab of origin. We implemented a standard peak-calling pipeline for the TF datasets (Supplementary Methods and Supplementary).
Experimental ChIP-seq peak datasets
Permutations to test type I error rateTwo permutation scenarios were performed to assess the type I error rate of the enrichment tests under the null hypothesis of no true biological enrichment with gene sets from GO. In both scenarios, gene labels are permuted so that each gene is given the GO term assignments of a randomly chosen gene. Preserved in both scenarios is the number of genes in a gene set and the correlations among the gene sets inherited from their parent/child relationships. In the first scenario (referred to as Permuted), we randomly permute gene labels relative to locus length and peak coverage proportion. The resulting permutations remove true biological association and the locus length bias inherent in the GO terms. In the second scenario (referred to as Permuted in Bins), gene labels are randomly permuted within bins of 100 genes sorted by locus length. This has the effect of preserving the relationship between locus length and peak coverage proportion in the dataset. The resulting permutations remove true biological association in the gene sets while maintaining any locus length bias. Tests exhibiting inflated type I error under this scenario in excess of the first scenario can be considered as not appropriately accounting for locus length. Each type I error estimate was based on 5404 tests.
Alternative functional enrichment testing methodsWe compared the functional enrichments for the 55 HM experiments (11 HMs across 5 cell lines) found with Broad-Enrich with those found by FET and our implementation of the binomial test of GREAT (). Additionally, we determined the type I error rate for a simplified version of the Broad-Enrich model excluding the smoothing spline [simple logistic regression (LR) model] to assess its necessity. Genes that were annotated in GO or KEGG and had a defined locus were included in the analyses. We used a two-sided FET to test for association of peak presence (!1 peak midpoint within a gene locus) and gene set membership. We used a binomial test similar to the one described in GREAT; we calculate the probability of seeing greater than or equal to the number of peaks we observe for a gene set, , with the formula:where n is the total number of peaks within gene loci in any gene set, and k is the number of peaks annotated to gene set. The term p is defined as the expected proportion of peaks in gene set. In other words, p is the total non-gapped gene loci length in the gene set, divided by the total nongapped length of loci with at least one gene set annotation. P-values are calculated as the probability of observing k or more peaks in the gene set. We also used GREAT (http://bejerano.stanford.edu/great/) with hg19, the non-gapped genome as the background region, and the single nearest gene within 9999 kb association rule excluding curated regulatory domains.
RESULTS
Differences between histone-and TF-based ChIP-seq datadetecting HMs tend to have more peaks (), broader peaks () and more variable peaks widths (). We also find histone-based peaks tend to cover a much larger percentage of the hg19 genome (). In addition to more and broader peaks in the HM datasets, we observed that the HM datasets also tend to have a higher proportion of peaks intersecting two or more gene loci compared with TF datasets. With the nearest TSS locus definition, we find the percentage of peaks covering two or more gene loci tends to be higher for HMs (median = 5.78%, range = 1.7124.66%) than for TFs (median = 2.64%, range = 0.178.82%) (). Similarly, the percentage of peaks covering three or more loci is higher for HMs (median = 0.60%, range = 0.17 7.64%) than for TFs (median = 0%, range = 0.000.14%) (). The properties observed in HM peak sets indicate current methods may be ill-suited for detecting functional enrichment in HM ChIP-seq data.
Broad-Enrich methodBased on the differences observed between TFs and HMs in ChIP-seq data, we aimed to develop an enrichment testing method that accounts for the extent to which each HM is associated with each gene. Using the number of peaks associated with a gene, as GREAT does, would yield stronger association to a gene with two narrow peaks than to a gene with one broad region covering the entire gene. Using a binary indicator of whether a gene has at least one peak associated with it, as is done with FET, would not account for any differences in the proportion of the gene locus covered. Both approaches ignore instances where a peak covers a significant portion of the loci of two or more genes. We first define the gene locus definitions, which capture the main trends of where HMs tend to occur relative to exons and TSSs. In this article, we use (i) the region(s) within 5 kb of every TSS of a gene ( 5 kb), (ii) the combined exon regions for a given gene (exons) and (iii) the region between the upstream and downstream midpoints between a gene's TSS and the adjacent gene's TSS (nearest TSS) (). These locus definitions represent binding in the greater promoter regions, throughout gene bodies and anywhere in the surrounding genomic region including enhancers (assigned to the gene with the nearest TSS), respectively. Given a locus definition, the proportion of each gene locus covered by all peaks overlapping the locus is determined. To test for significant enrichment, we use a logistic regression approach with gene set membership as the outcome and the proportion of a locus covered as the predictor. Because of the known confounding effect of locus length relative to the presence of !1 peak (), we examined and observed a similar relationship between locus length and peak coverage proportion (Supplementary). We correct for log 10 locus length empirically using a binomial cubic smoothing spline (see Section 2 for more details). P-values are then calculated for enrichment and adjusted for multiple testing. Broad-Enrich outputs three tab-delimited text files: (i) peakto-gene locus assignments from the input peak set with lengths of peaks, loci and overlap; (ii) the gene locus coverage information after aggregating over all peaks overlapping a locus; (iii) the enrichment results, with significance values and summary information for tested gene sets. QC plots showing the relationship between log 10 locus length and the proportion of the locus covered by a peak are also output (Supplementary).
Investigation of type I errorUnder the null hypothesis of no true GSE, the type I error rate, or proportion of false-positive results, for a dataset at a given threshold is the proportion of gene sets with P-value less than . A method with type I error rate higher than the expected level will result in an overabundance of false-positive results. We investigated the type I error rates for Broad-Enrich, the simple LR model, the binomial-based test and FET, for 55 HM datasetsunder two permutation scenarios using the nearest TSS locus definition. Both permutations remove any true biological association between gene sets and the genes they contain. The first scenario (Permuted) assesses type I error of the enrichment test under no locus length bias. The second scenario (Permuted in Bins) has the effect of preserving the locus length properties of the gene sets and illustrates the extent to which the type I error rate is affected by locus length. We find that Broad-Enrich exhibits the correct type I error rates in both permutation scenarios and at different levels. The binomial test exhibits severely inflated type I error in both scenarios, and both the simple LR model and FET exhibit the correct type I error rate in the 'Permuted' scenario, but have inflated error for the 'Permuted in Bins' scenario [( = 0.05),I error for the binomial-based test. Welch et al. identified significant extra variability (beyond that expected by the binomial test) in the number of peaks assigned to genes in ENCODE ChIP-seq data; they show this, together with the incorrect assumption of the binomial test with respect to locus length, accounts for the inflated type I error (). In contrast, FET resulted in correct type I error for 16 of 55 datasets under both permutation scenarios (and Supplementary). The inflated type I error of the remaining 39 datasets results from FET being unable to account for the locus length bias present in these datasets (). We compare the enrichment results for these 16 datasets with those of Broad-Enrich in Section 3.5.
Summary of ENCODE HM enrichment resultsWe tested for GSE using Broad-Enrich in the same 55 HM ChIP-seq datasets from the ENCODE Consortium. We find that significantly enriched gene sets outnumber significantly depleted gene sets by $3:1 over all the datasets (Supplementary). The number of enriched gene sets varies greatly among experiments, with as few as 8 for H3K9me3 in K562 and as many as 1058 for H3K4me2 in H1hESC (median number of enriched gene sets = 664) of 5591 total gene sets tested from GO and KEGG, and using the nearest TSS locus definition. For a fixed histone, the number of enriched gene sets can vary greatly across the five cell lines (e.g. H2az range = 74767 and H3K9me3 range = 8253), suggesting different biological activity for such HMs across GM12878, H1hESC, HeLa-S3, HepG2 and K562. For each HM, we determined the extent of overlap among significantly enriched gene sets across the five cell lines with the nearest TSS locus definition (Supplementary). GM12878 and H1-hESC tend to have the highest percentage of unique enrichments across all HMs. This could be an indication of more specific regulation via HMs in these cell lines compared with the others. H3K36me3 and H3K79me2 exhibit the highest percentage of enriched gene sets common to all cell lines (39% each). Both modifications tend to occur within the gene body, and the observation of many mutually enriched gene sets could be a result of their necessary functions in constitutively expressed gene groups required by cells, such as transcription and RNA processing (ENCODE Project). H2az had the smallest percent (0.1%) of mutually enriched gene sets among all five cell lines, with the most uniquely occurring in the embryonic stem cell line.
Comparison of Broad-Enrich to FET and GREATFET has an acceptable type I error rate ( 0.05 at = 0.05 level) in only 16 of 55 datasets (and Supplementary). These datasets tend to have fewer peaks overall, and more peaks located within 5 kb of the TSS compared with the 39 HM datasets with type I error rate 4 0.05. For each of these 16 datasets, we compared the average peak coverage proportion of gene loci in the gene sets uniquely enriched by Broad-Enrich with those uniquely enriched by FET. The gene sets uniquely enriched by Broad-Enrich have a consistently higher proportion of the gene locus covered (Supplementary). We also examined the percentage of significant enrichments that were stronger in one). (A) At = 0.05 (red line), we find inflated type I error for the binomial test under both permutation scenarios, the correct error rate for Broad-Enrich and the correct error rate for permutations eliminating length bias but often inflated error for permutations preserving length bias for both the simple LR model and FET. (B) At = 0.001 (red line), we observe results similar to = 0.05. Mean error rates are given inset
i397Broad-Enrich method versus the other by comparing the FDR values of gene sets enriched in either method. Broad-Enrich resulted in stronger enrichment signal in 12 of 16 datasets (Supplementary). Finally, we compared the power of Broad-Enrich with FET in the 16 datasets by varying the proportion of genes with a peak, and the proportion of each gene locus covered by a peak (Supplementary Methods). We find that Broad-Enrich has higher power than FET in nearly all cases (Supplementary). For comparison with GREAT (v1.8.2), we selected six histone datasets (H3K4me1,-2,-3, H3K9me3, H3K27me3 and H3K79me2 in the cell line GM12878) representing a mixture of activators/repressors and binding close/distal to TSSs. We tested all GO terms using the 'single nearest gene' within 9999 kb gene regulatory domain definition provided in GREAT because it is most similar to the nearest TSS definition in Broad-Enrich. We compared relative ranks of enrichments, as the binomial-based test implemented in GREAT has overly significant P-values (inflated type I error rate). Comparing the top 20 ranked GO terms for each enrichment test, we find that compared with GREAT, Broad-Enrich consistently finds gene sets with higher coverage in terms of the proportion of each gene locus having the HM (Supplementary). The GM12878 cell line is a lymphoblastoid cell line. Lymphoblasts are na ve lymphocytes, which is the term used for any of the three types of white blood cell (leukocytes) in the vertebrate immune system. H3K4me1 is a known general transcriptional activator. The top 20 ranked GO terms for H3K4me1 in Broad-Enrich include leukocyte activation, lymphocyte activation, regulation of lymphocyte activity, positive regulation of immune response and regulation of leukocyte activation (and Supplementary). None of the above (and only one immune-related term) is in the top 20 ranked GO terms according to GREAT. In contrast, the top terms ranked by GREAT included mitochondrion-and ribonucleotide binding-related gene sets, which are not as strongly related to the known properties of GM12878 (and Supplementary). H3K27me3 is a known repressor of differentiation and developmental genes. Within the top 20 ranked GO terms from Broad-Enrich, we find tissue development, organ morphogenesis, epithelium cell differentiation and regionalization. According to GREAT, none of the above or related GO terms is ranked in the top 20, and only one is in the top 100 (Supplementary). Moreover, the top terms ranked by GREAT included metabolic processes and energy/transport-related gene sets, which are not commonly associated with the regulatory targets of H3K27me3. In both instances, we find that the binomial test not only finds an overabundance of significant (FDR50.05) terms, as indicated by its inflated type I error rate, but also that BroadEnrich ranks biologically relevant terms better than GREAT.
Effect of locus definition on enrichmentIt is known that some histone marks preferentially occur in particular locations relative to gene features. To investigate the effect of locus definition on enrichment signal, we ran Broad-Enrich for each of the 55 HM ChIP-seq datasets with the nearest TSS, exons and 5 kb locus definitions. We hypothesized that using a locus definition better conforming to the known genomic location of the histone mark would result in stronger enrichment signal. H3K4me2, known to occur in promoters (2010), tends to have strongest enrichment signal with the 5 kb locus definition across the five cell lines (Supplementary). H3K4me3, also known to occur in promoters (), shows results similar to H3K4me2 (not shown). H3K79me2 binds near the 5 0 end of gene bodies, and overall we see the strongest enrichment signal when using the 5 kb definition (Supplementary). In contrast, H3K36me3 binds near the 3 0 end of the gene body, and we see a somewhat stronger enrichment when using the exons definition compared with the 5 kb definition (Supplementary) (). Histone acetylation, such as H3K9ac, tends to occur near TSSs (), and we observe stronger enrichment signal for the 5 kb locus definition across the five cell lines (Supplementary). H3K27me3 gives stronger enrichment signal with the exons definition for all cell lines except H1hESC, which performs best with the 5 kb locus definition (Supplementary). This may be indicative of a different regulatory regime for H3K27me3 in embryonic stem cells versus the other cell lines, consistent with current literature (). H3K4me1 is considered a distal activating mark (), and exhibits stronger enrichment signal with the nearest TSS locus definition in GM12878 and HepG2 but stronger signal with 5 kb in H1-hESC, HeLa-S3 and K562 (Supplementary). Broad-Enrich results from the additional tier 2 ENCODE cell lines A549, Huvec and Monocytes-CD14+, and using the same three locus definitions resulted in the same overall conclusions for the 11 HMs above (not shown). Overall, we observed that the locus definition closest to the known locations of an HM provided the strongest enrichment results. These results should be interpreted in light of the fact that nearest TSS is the only locus definition to include all peak regions; thus, important information about individual genes within enriched gene sets may be lost for the 5 kb or exons definitions.
DISCUSSIONFunctional enrichment testing leverages our collective biological knowledge together with high-throughput genomic technologies in a statistical framework to functionally interpret new biological data. Unique properties observed in ChIP-seq data for HMs have led to the use of specialized peak-calling algorithms. These properties, combined with the bias observed in gene loci coverage relative to locus length, present challenges to existing functional enrichment methods. We have developed Broad-Enrich to address these issues in functionally interpreting large sets of broad genomic regions. Our approach uses the proportion of a gene locus covered by all peaks overlapping the locus, and a correction accounting for the locus length in a logistic regression model with gene set membership as the outcome. Inflated type I error rates result in an overabundance of falsepositive results, while well-calibrated type I error rates result in accurately reported FDRs. We demonstrate that Broad-Enrich has a well-calibrated type I error rate across 55 HM ChIP-seq datasets representing a wide variety of technical and biological characteristics. In contrast, the binomial-based test consistently exhibits inflated type I error, while FET has the correct type I error for only 16 of the 55 datasets. These 16 HMs represent transcriptional activators, or HMs occurring in actively transcribed genes. Even for these 16 HMs, Broad-Enrich tends to provide stronger enrichment signal than FET. Compared with GREAT, Broad-Enrich finds more biologically relevant terms in the top ranked gene sets, as illustrated with immune functionrelated terms for H3K4me1 and H3K27me3 in the context of lymphoblastoid cell line GM12878. While rank comparisons are not ideal, in the absence of a gold standard, we rely on known biological roles for the HMs combined with known characteristics in cellular context. Finally, we examined the effect of locus definition on the enrichment signal from Broad-Enrich. We see the strongest enrichment signal by using the locus definition closest to the known locations of the HM. For two HMs, we observe differences in the optimal locus definition. For H3K27me3, the exons locus definition performs best in all cell lines except for H1-hESC, where 5 kb performs best. This difference could be explained by the role H3K27me3 plays in embryonic stem cells, where it is known to often occur in promoters of genes having CpG islands to regulate differentiation of ES cells (). For H3K4me1, we observe that nearest TSS performs best for GM12878 and HepG2, whereas 5 kb performs best for the remaining cell lines. This might indicate that GM12878 and HepG2 cells rely more heavily on long-range enhancer activity for gene activation than the other three cell lines. These results emphasize that the definition with strongest enrichment signal tends to mirror the currently understood location of HM binding. Our implementation of Broad-Enrich allows users to define their own custom locus definition to fit their own experimental contexts. In addition to functionally interpreting single HM experiments, it is also possible to examine bivalent or trivalent HM signatures together (e.g. H3K4me3 and H3K27me3) with BroadEnrich and compare the results with the HMs individually to determine if bivalency leads to unique biological function. Broad-Enrich is also applicable to other types of broad domain experiments, such as copy number variations. As the regulatory programs of living organisms are better understood, Broad-Enrich may be improved with distal regulatory information from Hi-C experiments, allowing for more accurate locus definitions. The significance or strength of each peak region reported by peak callers may also be incorporated in the enrichment model. Such future changes may bring functional interpretation of broad genomic regions closer to making optimal use of peak information.
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
We examined peaks from 155 ENCODE ChIP-seq experiments including 20 TFs and 11 HMs in five cell lines. We find that, relative to TF-based experiments, ChIP-seq experiments i395 Broad-Enrich at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
