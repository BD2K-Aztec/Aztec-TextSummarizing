Motivation: Finding biologically causative genotype–phenotype associations from whole-genome data is difficult due to the large gene feature space to mine, the potential for interactions among genes and phylogenetic correlations between genomes. Associations within phylogentically distinct organisms with unusual molecular mechanisms underlying their phenotype may be particularly difficult to assess. Results: We have developed a new genotype–phenotype association approach that uses Classification based on Predictive Association Rules (CPAR), and compare it with NETCAR, a recently published association algorithm. Our implementation of CPAR gave on average slightly higher classification accuracy, with approximately 100 time faster running times. Given the influence of phylogenetic correlations in the extraction of genotype–phenotype association rules, we furthermore propose a novel measure for downweighting the dependence among samples by modeling shared ancestry using conditional mutual information, and demonstrate its complementary nature to traditional mining approaches.
INTRODUCTIONVariation in an organism's observed physical and environmental attributes, known as its phenotype, is determined in part by its gene composition, known as its genotype. Organismal traits are often influenced not by a single gene, but by combinations of genes. Comparing profiles of orthologous genes or proteins () with profiles of phenotypes is a common method for identifying gene correlations (). Genes that confer a particular phenotype can be inherited from ancestors, created through duplication of existing genes and mutation, or acquired from other organisms through lateral gene transfer (LGT) events. Once thought to be restricted to a few exceptional events, LGT is now known to have played a central role in bacterial evolution, including in the emergence of traits such as * To whom correspondence should be addressed. thermophily (), photosynthesis () and antibiotic resistance (). The genomes of prokaryotic organisms typically contain 10006000 genes. Many have studied methods of associating single genes or clusters of genes to phenotypes, including with direct distribution comparisons (), analysis of neural network parameters (), statistical significance () and mutual information (MI;). These approaches did not consider combinations of genes that do not share a similar pattern of distribution across genomes; if there is a gene that is only important when other genes have already been taken into consideration, it could be missed.looked at several settheoretic methods of combining cluster profiles. Several studies used more advanced machine learning techniques to build up multigene associations, such as recursive feature elimination () and filter () methods on cancer microarray data. Recently,used metabolic profiles with wrapper, filter and embedded methods of feature selection. Depending on the classifier used, wrapper methods can be computationally expensive on feature-rich datasets as a classifier must be trained multiple times on various subsets of features. Association rule mining (ARM;) is an alternative method to mine multi-feature associations. ARM is a data mining technique that finds associations among features, constructing rules of the general form. Classification using ARM is the basis of NETCAR (), a MI-based method of pruning the huge search space of gene combinations to identify genotypephenotype relationships that would not be otherwise detected. Feature selection is often used to find these predictive combinations of genes; however, good predictors do not necessarily have a causal influence on the property, but can simply be correlated with it (). Common correlated factors, such as dependence among samples due to shared ancestry, can confound predictive analyses. One of the strongest confounding patterns in phenotype prediction is the evolutionary ancestry of the organism (). The default mode of genetic inheritance is vertical, with organisms typically acquiring genes from their direct ancestors. If a particular phenotypic trait is common or ubiquitous within a taxonomic group, then genes that correlate significantly with the presence of the trait may in fact be characteristic of the taxonomic group rather than causal of the trait.shows the uneven distribution of temperature environment preference over 387 bacteria and 40 archaea, subdivided by phylum. In this, grouped by phylum. The bars represent the proportion of thermophiles (dark) and nonthermophiles (light). The number next to each bar is the number of microbes in that group. The uneven distribution of the phenotype class labels over the taxonomic groupings demonstrates the dependence among samples. dataset, 62% of thermophiles are within three phyla: Crenarchaeota (21%), Eurarchaeota (20%) and Firmicutes (20%). The other 38% of thermophiles are unevenly distributed (from 0% to 8%) over 15 other phyla. As identifying predictors is a needle-in-a-haystack problem, with tens of thousands of possible genes over only hundreds of examples, ignoring confounding shared ancestry can lead to predictors of overrepresented groups (such as, in this case, the three main phyla). Clostridium thermocellum is a thermophilic member of an otherwise mesophilic genus. In this case, we would like to pay particularly close attention to those differences between C.thermocellum and the other clostridia. By subtracting genes common among all close relatives, we amplify the importance of genes that are different among closely related thermophiles and non-thermophiles. If these genes are present in other thermophiles, they will be further emphasized. By downweighting genes that are expected to be present due to common descent, we emphasize the genes with unusual distributional patterns due to selective gene loss or LGT and may therefore play a particularly important determining role in the phenotype. Phylogenetic dependency networks () have been used to mitigate shared ancestry of HIV viral proteins by constructing Bayesian networks conditioned on a phylogenetic tree. With our approach we do not depend on fine-grained and uncertain relationships within strict evolutionary hierarchies of microorganisms, as may be necessary with closely related viral samples such as HIV, and instead allow the exploration of shared ancestry within large clusters at various taxonomic depths. We apply a predictive rule mining approach, which has not previously been tested on genotypephenotype mapping problems, that achieves better predictive accuracy than NETCAR and has lower running time. To mitigate the effect of shared ancestry, we also propose a novel metric based on conditional MI (CMI) (Section 2.2) for incorporating information regarding shared ancestral descent into genotypephenotype analyses. While this approach does not improve the overall classification accuracy, it highlights sets of genes with relevant biological functions, and highlights the strong influence of phylogenetic correlation.
APPROACH
Associative classification rule miningClass ARM is useful for determining associations between sets of genes and phenotypes. Genes that do not independently correlate with a given trait may not be found in a gene-by-gene feature selection approach, but enumerating all possible subsets of genes is impossible for large feature spaces. Here we examine two algorithms designed to efficiently mine sets of genes associated with a phenotype with class ARM. NETCAR () first finds all single genephenotype associations with an MI score above a given threshold, known as the parent genes. It then builds a gene connectivity graph from these parents, where a connection implies the MI between a parent and another gene is above a second MI threshold. Child genes are defined as being within x steps of a parent on the connectivity graph, where x is user-defined. All such parentchild relationships are used to construct candidate associations between gene set and phenotype. It then uses MI between each gene set and the target phenotype to evaluate the most likely causative relationships. Consequently, NETCAR aims to discover sets of genes that show correlated patterns of occurrence. The authors reported various patterns of predicted gene interaction for six phenotypes. Classification based on Predictive Association Rules (CPAR;) builds predictive rules that cover examples for each class label in a dataset. Initially, all samples (here, genomes) in a dataset are uniformly weighted. Next, counts of positive and negative examples of the class label are constructed, as well as counts for each gene in the database. The genes that increase the Foil gain () on the positive set, thereby correctly classifying more of its members, are added to new rules, which are then extended in a similar manner until the information gain of adding a new gene is below a given threshold. At this point, the association between gene set and phenotype is stored, and each positive example that the gene set covers is downweighted for the next iteration of the algorithm. This process continues until a minimum weight threshold has been reached (coverage of the dataset) or no more single genes are above the Foil gain threshold. The weights are reset to a uniform level for each sample and the process is repeated for each class label (e.g. for both the 'yes' and 'no' class labels). In this manner, CPAR is constructed to find rules that make generalizations over as many samples as possible for a class, and then iteratively focus in on those samples that were not covered by the generalizations.
Shared ancestryMI is the measure of information shared between two random variables (). Formally, MI is defined asPage: 1836 18341840On the left is a typical information theoretic model for finding predictive attributes, where the goal is to choose G to minimize the entropy in our target, H(P|G). On the right, we have an extra confounding attribute, taxonomy, which models genes that are correlated (and potentially predictive) with our target phenotype, but not necessarily biologically meaningful. As we are interested in understanding the system that produced our target class rather than only prediction, we would like to tell which predictive features have high I(G;P|T ), i.e. interaction between genes and phenotype that cannot be explained by the confounding taxonomic signal.
N.J.MacDonald and R.G.Beikowhere subscripted p are the probability mass functions of the subscripts. MI has been used as a method of finding features that follow a similar distribution as the target class, and are thus potentially predictive of that class. In genotypephenotype association problems, we can find a predictive relationship between a gene and phenotype, but we would also like to downweight those genes that can be explained by common ancestry (). By modeling shared descent as a discrete random variable corresponding to a given taxonomic level, we can find the MI present between feature and class that is remaining after subtracting the information both share with the taxonomic level. This measure is known as CMI. CMI has been examined recently for selecting non-redundant features (). CMI has been used to select features that are non-redundant with previously chosen features. The CMI evaluates the MI shared between the feature in question and the class in the context of the already known features. In this study, we are interested in finding features that have a biological influence on the class, and wish to evaluate the effect of taxonomy as a confounding factor. Formally, CMI is defined aswhere p(x,y,z) is the joint probability mass function of random variables X,Y and Z, and subscripted p are the probability mass functions of the subscripts. With a log base of 2, the units of CMI are bits. The information shared between random variables X and Y in the context of Z is given by CMI. For the phenotype problem, let X be the presence or absence of a gene set, Y be the phenotype, and Z be the taxonomic group, our confounding variable. The CMI gives us the amount of MI between the genes and the phenotype that cannot by explained by common ancestral signal. We can also think of the CMI as the amount of new information a feature brings for the prediction of a phenotype, if we have used the taxonomic label as the first step in a decision tree classifier.
Weighting with CMIWhen MI is high, we know that there is a strong correlation between the variables. When accounting for the confounding effects of common descent, we are looking for variables that appear to influence the phenotype in ways that are not easily explained with common descent. Once we identify these variables, we want to report the strength of the dependence between the phenotype and genotype, regardless of taxonomy, i.e. the MI. Here we define a score that balances these two considerations, Conditionally Weighted MI (CWMI). For any given target phenotype, there is a maximum possible CMI, as it is impossible to share more information than is present in either factor. Formally, the maximum CMI for this problem is the entropy remaining in phenotype having subtracted the MI of phenotype and taxonomic groups, H(Y |Z), defined asIn order to factor in the amount of MI in the context of taxonomy to the amount of MI as a whole, we use a normalized weight formula, defined when H(Y |Z) is positive,Here, we use CMI normalized between 0 and 1 to provide a measure of our confidence that the correlation between X and Y is not confounded by Z. Several benefits of this normalization include the ability to scale other predictive scores with  such as the Laplace error estimate used by Yin and Han (2003), its unit-less nature and its interpretation as the confidence that a given relationship is not confounded by common descent. Note that for a given problem, scaling I(X;Y ) by  is proportional to scaling I(X;Y ) by I(X;Y |Z), as H(Y |Z) is constant over a phenotype distribution. When  = 0, then there is no evidence that X and Y share any more information than X and Z or Y and Z alone. When  = 1, then the information shared between X and Y is the maximum amount possible given the taxonomic grouping. Thus, CWMI
Microbial genotypephenotype associationsimultaneously covers the cases in which either the candidate gene or the target phenotype are conserved in the taxonomic group.
MATERIALS AND METHODS
DataClusters of orthologous groups (COG;) are manually curated groups of orthologous genes constructed by merging triangles of reciprocal best BLAST hits. Non-supervised orthologous groups (NOG:) are constructed in a similar manner but are extended to more genomes. The phylogenetic COG/NOG (herein referred to collectively as COG) profiles were downloaded from the STRING v8.2 database () and COG descriptions were downloaded from the NCBI COG database (). Of the 630 available COG profiles from STRING, 55 eukaryotes were removed as only one had associated phenotype data and it was not a microbe. Of the 46 archaea and 529 bacteria remaining, 427 had data for at least 1 of the 10 phenotypes considered (see below). Before executing on each phenotype, organisms with a null label for that phenotype were removed. Redundant COG profiles were detected and removed, for example, the 47 615 COGs in the 427-microbe thermophily dataset were automatically reduced to 26 290 distinct COG patterns within 5 s. Ten phenotypes, consisting of aerobic, anaerobic, facultative, gramnegative, halophilic, thermophilic, motile, photosynthetic, psychrophilic and endospore-forming traits (identified in this work as AEROBE, ANAEROBE, FACULT, GRAMNEG, HALO, THERM, MOTILE, PHOTO, PSYCHRO, and SPORE, respectively), were obtained from the Joint Genome Institute (JGI) Integrated Microbial Genomes (IMG) (). In Supplementarythe distribution of each phenotype is given. In the case of halophily, only positive examples are provided by JGI IMG. In this case, the negative set was downloaded from the list of sequenced prokaryotic organisms at NCBI (http://www.ncbi.nlm.nih.gov/genomes/lproks.cgi). Taxonomic assignments of all genomes used in this study were downloaded from the NCBI taxonomy database (http://www.ncbi.nlm.nih .gov/Taxonomy). For taxonomic ranks not defined for a given organism, the ranks were propagated downward, from superkingdom to genus. For example, the undefined family and order of Dehalococcoides ethenogenes 195 were each set to its class, Dehalococcoidetes.
Classifier trainingThe Java implementation of NETCAR from Tamura and D'haeseleer (2008) was used for this study. Phylogenetic profiles were converted into NETCAR's sparse binary matrix format. Only the top 30 MI-ranked parent COGs [as explained by Tamura and D'haeseleer (2008), onlinewere used as seeds to build rules composed of two and three COGs (size-2 and size-3 rules), as choosing an appropriate MI cutoff is dependent on the phenotype and problem size, and not intuitive to choose. Only positive class label rules are mined by NETCAR by default. In order to evaluate the predictive capability of rules mined by NETCAR, negative predictors were mined by switching the positive (1) and negative (0) class labels and re-executing NETCAR. For each phenotype and class label, NETCAR was executed for size-1, size-2 and size-3 rules, and the resulting lists are combined and sorted by F-score on the training set, the default sorting by NETCAR. Since the size-1 and size-2 rules are necessarily mined before the size-3 rules, and the pre-specification of rule size is just a limitation of the interface, the runtime performance of only the size-3 rule sets are compared with CPAR. Due to the pre-and post-processing required to compare with the NETCAR algorithm, a single, 2-fold cross-validation was performed between CPAR and NETCAR. We developed an efficient, user-friendly, plug-in extensible framework implemented in Python for comparing genotypephenotype algorithms (PICA). PICA handles input of data from human-readable files, efficiently compresses identical profiles and handles randomized, paired, crossvalidated comparisons of user-defined training algorithms, while providing complete classification logs for identifying difficult-to-classify genomes. A CPAR plugin was built into our classification framework and executed with the settings from Yin and Han (2003).
CMITen replicates of paired 5-fold cross-validation comparing features selected with MI, CMI, CWMI and an even combination of features from MI and CWMI were generated and tested using a Python interface to LIBSVM (). For each training set, the MI between each COG and phenotype was calculated. The CWMI was calculated among each COG, phenotype and taxonomic rank, where the ranks included genus, family, order, class, phylum and superkingdom. A binary flag of whether a COG was predictive of the positive or negative set was calculated based on observed frequencies, or assigned to the positive set in the case of equal observed frequencies. The top x unique positive and the top x unique negative features from MI, CMI, CWMI and a combination of MI and CWMI were chosen, where x is in (2, 4, 10, 20, 50, 500).
TestingNormally, association rule classifiers such as the classification based on association rules (CBA) algorithm () or CPAR () would be used to test classification accuracy of association rule sets. Since these decision-tree type classifiers are generally suboptimal compared with support vector machines (SVMs), we have instead used the rules as a feature-selection step, allowing the SVM to develop its own model of interaction among genes for positive and negative examples. Rules were broken down into component features, and the top unique x were taken from each set, balanced for positive and negative predictors, and used to train LIBSVM on that set using a linear kernel and cost parameter C = 5, which controls the cost of misclassifying points when determining the margin between class labels. Each prediction made was recorded and summarized over all replicates. In all cases, the Q  score (herein referred to as balanced accuracy) is used as the accuracy measure, which is an average of the positive set accuracy with the negative set accuracy ().
RESULTS
Comparison of CPAR with NETCARCPAR and NETCAR were compared with 1 replicate of 2-fold crossvalidation over 10 phenotype datasets. Each algorithm was trained and the resulting rules were broken down into single items, with equal numbers of positive and negative predictive genes for both approaches. The number of each positive (negative) set of genes was dependent on the minimum of the positive (negative) CPAR or NETCAR sets. The feature sets were then evaluated using SVM training and testing.contains balanced accuracies of CPAR and NETCAR trials, as well as the number of positive and negative genes used in each case. Since we performed cross-validation on the same training and test sets, we perform a paired t-test to evaluate differences in balanced accuracy. Considering all datasets, the difference in accuracy is not significant at the 0.05 level (N = 20, paired t = 1.27, P = 0.220). However, there is a strong outlier effect due to the small psychrophile dataset: neither algorithm performs well on this dataset, and there are very few positive examples (17, less than half of the next largest, halophily, with 35). The observed difference in accuracy is due to NETCAR classifying 5/17 correctly versus Page: 1838 18341840P is the average number of distinct positive genes used (e.g. 'aerobe'), N is the average number of distinct negative genes used (e.g. 'not an aerobe') and S P and S N are the average number of distinct genes shared among the CPAR and NETCAR feature sets over the positive and negative sets, respectively. Best accuracy scores for each phenotype are shown in boldface.CPAR classifying 3/17 correctly on the positive set, and 409/410 versus 410/410 on the negative set. After psychrophily is removed, the differences in accuracy are significant (N = 18 paired t = 2.53, P = 0.021); however, the effect size is small (0.855 versus 0.836). The mean runtimes, however, differ substantially: CPAR with 12.2 s and NETCAR with 1410.0 s (). The difference in accuracy between CPAR and NETCAR seems to be attributable to CPAR covering taxonomically distinct groups. For example, in the thermophily group, CPAR was able to correctly classify five more thermophiles than NETCAR, covering both superkingdoms. NETCAR found more DNA replication, recombination and repair COGs than CPAR (fold 1: 36 versus 14, fold 2: 20 versus 13). Since CPAR tends to reduce redundancy when producing rule sets, it could be the case that some of the DNA repair COGs are found by NETCAR but not CPAR, but redundant with the original COGs. We conclude that the rules mined with CPAR are marginally better predictors than those mined with NETCAR, and that CPAR has a significantly smaller runtime (100 times faster on average). CPAR also has the advantage of not requiring pre-specification of target rule sizes to mine. Thus, if a single gene is predictive in and of itself, the algorithm does not necessarily build a larger rule with other genes which would obfuscate the predictive gene's central role. We further note that increased predictive accuracy on previously unseen testing data does not necessarily mean increased biological relevance, but it is an important filtering step of determining genes for further investigation. Following an investigation with CPAR, it is recommended that other COGs that are linked with the discovered rules are investigated, as these could be left out due to the builtin redundancy compensation of CPAR, but may play important biochemical or structural roles in contributing to the phenotype of interest. These linkages can be discovered with a simple similarity metric such as MI. In order to gain a better understanding of the classification results produced by CPAR, 10 replicates of 5-fold cross-validation were performed. We note that some organisms were particularly difficult to classify (Supplementary). Some of these misclassifications were potentially not annotated correctly or were near the borderline between classes in the original dataset. For example, Steptococcus thermophilus LMD-9, a thermotolerant mesophile, is misclassified as a thermophile in 7 of 10 replicates; Sulfurovum sp., classified by JGI as a thermophile, was consistently classified as a mesophile in all 10 trials. In this case the CPAR predictions, rather than the phenotype label, appear to be correct: although Sulfurovum sp. was isolated from a hydrothermal vent environment, its optimum growth temperature appears to be 3035 @BULLET C (). Each of the 10 misclassified thermophiles was derived from taxonomic groups which contained predominantly mesophilic organisms. Of the 40 correctly classified thermophiles, 29 were part of homogeneous taxonomic ranks (to order, class or phylum). The strong correlation of classifier performance with the heterogeneity of taxonomic ranks implies that our classification technique may be finding genes spuriously correlated with phenotype, and are rather predictive of closely related organisms who happen to share the phenotypic trait thermophily.
N.J.MacDonald and R.G.Beiko
Ranking with CWMIWe now demonstrate our novel method of correcting for shared ancestry, focusing on thermophily and the point at which homogeneity and heterogeneity seem to impact classifier performance overall, the taxonomic rank of order.(Panel a) and(Panel b) display results of the two measures on the same dataset, thermophily (THERM). The top 10 ranked COGs by MI for the thermophile class are given in(Panel a), while the top 10 ranked COGs by CWMI are given in(Panel b) (complete list available in Supplementary). Since it is known that DNA repair proteins are often specialized in organisms that live at high temperatures, we expect to see a high proportion of these genes labeled as having an influence on that phenotype. In the top 10 MI-ranked scores, we do in fact see two COGs that have been confirmed as being involved in DNA replication, recombination and repair. COG1110 is also found in the top 10 list for CWMI, and COG1857 was discovered by CWMI five times. Overall, 55 of the top 100 COGs identified as having high agreement according to MI have a CWMI of 0. This means that the COG and phenotype share no more information than COG and taxonomic rank order. Given two hypotheses, the first (H 0 ) that either the COG and the phenotype have simply been conserved in the ancestral signal and share no other biological dependency, or the other (H A ) that the COG biologically influences the phenotype, the CWMI score indicates that there is noPage: 1839 18341840reason to prefer H A over H 0. It is certainly possible that COGs with a CWMI= 0 influence the phenotype, but we cannot deconvolute the effects of taxonomy and phenotype in such cases without further taxonomic sampling or experimentation. Five of the CWMI-ranked COGs for thermophily are involved in DNA replication, recombination and repair. Four of the remaining five either have only general functional prediction, or the function has not yet been identified. Overall, 40% of the unique COG patterns in this dataset have this poorly characterized functional classification. Some of the genes found have previously been predicted as being part of a thermophile-specific DNA repair system through neighborhood, sequence and structural analysis (;). Interestingly, both thermophilic strains of S.thermophilus were classified correctly the majority of the time by CPAR, but almost never correctly by CWMI or MI. The three rules extracted by CPAR that pertain to these two organisms (and 14 other thermophilic organisms) are in. The individual COGs do not stand out as differentiating between thermophile and non-thermophiles, e.g. COG2189 has near zero MI/predictive value, but when taken with COG1337 and COG2723, they cover the thermophilic Streptococci and 8 other thermophiles, and no non-thermophiles. This illustrates the need to examine multi-element associative rules. On the other hand, C.thermocellum ATCC 27405 and Synechococcus sp. JA-3Ab were classified incorrectly the majority of the time with CPAR and with MI, but with CWMI applied at the taxonomic rank of order, both are classified correctly the majority of the time. This could be due to the downweighting of COGsIn braces are the NCBI function codes; in bold are those not found in the non-thermophilic (thermotolerant) S.thermophilus. NCBI COG function codes: L: replication, recombination and repair; K: transcription; G/P: metabolism; O: posttranslational modification, protein turnover, chaperones; S/R: poorly characterized. that are confounded with the taxonomic rank order, and thus the highlighting of COGs that span multiple taxonomic groups. For instance, these organisms both have COG1337 (noted by;), which is highly ranked with CWMI (, Panel b) but not with MI. Even though the discovered COGs and the organisms that each classifies correctly are different (Supplementary Tables S2 and S3), overall, there is no difference in classification accuracy of the two measures (N = 10, paired t = 0.46, P = 0.659; Supplementary Tables S4 and S5). This means that after highly predictive (though taxonomically confounded) COGs have been downweighted, we have discovered a subset of COGs that are just as predictive of the given phenotype, and are relevant across taxonomic groups.
Microbial genotypephenotype association
CONCLUSIONSPredictive machine learning methods are being used to reverse engineer the genetic underpinnings of phenotypes, but mining the large feature space for interactions leading to traits is computationally demanding. We have demonstrated that our implementation of the predictive associative-rule mining algorithm, CPAR, outperforms a recent genotypephenotype classifier in terms of accuracy and is on average 100 times faster. It is widely known that attributes with high predictive power are not necessarily causal, and the uneven taxonomic distribution and sampling of genomes with various phenotypes can potentially generate spurious correlations. Our analysis using CWMI produced a remarkably different ranking of genes than did more-traditional ranking criteria such as MI and the known functional roles of many genes favored by CWMI indicate that phenotypically relevant genes are indeed being highlighted. An advantage of our approach is that it is not tied to the COG methodology or phylogenetic profiles in general. Phenotypes such as temperature adaptation are conferred not only by the presence of certain genes, but also by adaptive mutations in existing genes that change their physical or chemical properties. For instance, the DNA polymerase from the thermophile Thermus aquaticus is an example of a protein that is stable at high temperatures (). However, this protein is homologous to polymerases from non-thermophiles and its presence would therefore not discriminate between thermophiles and non-thermophiles. By encoding variations in DNA or protein sequence in a matrix, we will be able to evaluate gene content and gene sequence variation in a combined framework, thereby gaining a much more comprehensive picture of the genetic adaptations that are necessary for different phenotypic traits.
at :: on August 31, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
