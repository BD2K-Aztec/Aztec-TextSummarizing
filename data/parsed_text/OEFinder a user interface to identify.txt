A recent article identified an artifact in multiple single-cell RNA-seq (scRNA-seq) data-sets generated by the Fluidigm C1 platform. Specifically, Leng et al. showed significantly increased gene expression in cells captured from sites with small or large plate output IDs. We refer to this artifact as an ordering effect (OE). Including OE genes in downstream analyses could lead to biased results. To address this problem, we developed a statistical method and software called OEFinder to identify a sorted list of OE genes. OEFinder is available as an R package along with user-friendly graphical interface implementations which allows users to check for potential artifacts in scRNA-seq data generated by the Fluidigm C1 platform. Availability and implementation: OEFinder is freely available at https://github.com/lengning/ OEFinder
IntroductionSingle-cell RNA-seq (scRNA-seq) has led to important findings in many fields and is becoming increasingly popular in studies of transcriptome-wide expression (). To facilitate scRNA-seq, the majority of studies utilize the Fluidigm C1 platform for cell capture, reverse transcription and cDNA amplification, as this platform allows for rapid and reliable isolation and processing of individual cells. In spite of the advantages,identified an artifact in multiple datasets generated by C1 and confirmed that the artifact was present in the cDNA processed by the C1 machine. In particular, in these datasets, there are genes showing higher expression in cells captured in specific capture sites. These capture sites are the ones with small or large plate output IDs. We refer to this artifact as an ordering effect (OE), which has been shown to be independent of organism and laboratory (). As detailed in, accurate identification of OE genes is important to ensure unbiased downstream analyses.used an ANOVA-based approach to detect OE genes. The ANOVA-based approach performs well in many cases, but has reduced power when few cells are available. (Note that in empirical data, the cells can be missed owing to the random effects of capture failurean empty capture site, or doubletscapturing more than one cells in one capture site.) To improve power for identifying OE genes, we developed an approach, OEFinder, based on orthogonal polynomial regression. Results show that OEFinder is less sensitive to sample size and outperforms the ANOVA-based approach when few cells are available. OEFinder is implemented in R, a free and open source language, with a vignette that provides working examples. The graphical user interface (GUI) implementations of OEFinder allow users with little V C The Author 2016. Published by Oxford University Press.
1408This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (http://creativecommons.org/licenses/by-nc/4.0/), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.comcomputing background to easily identify and characterize OE genes in scRNA-seq data (and Supplementary).
Analysis input and output
Input
Expression estimatesOEFinder requires a genes-by-cells expression matrix. The expression matrix can be either normalized or unnormalized. If the input matrix is unnormalized, OEFinder applies the Median-by-Ratio normalization method introduced by Anders and Huber (2010) prior to OE detection.
Capture site group definitionsAs detailed in, the capture sites are labeled as A01,. .. , A12, B01,. .. , B12,. .. , H01,. .. , H12. If the capture site IDs are provided, OEFinder groups cells from sites with the same starting letters. When the capture site information is not available, OEFinder groups cells based on their input order. By default, OEFinder groups cells into eight even-sized groups. The number of groups may be changed by the user.
MethodThe normalized expression values of each gene are scaled to zscores. For each gene, OEFinder applies an orthogonal polynomial regression on z-scores against group code. To infer whether gene g follows the OE trend, OEFinder calculates the P-value p g,2 of a onetailed test that tests whether the coefficient of the quadratic term is positive. To account for the goodness of the spline fitting, OEFinder defines an aggregate statistics S g as log(p g,2 )  log(p model ), in which p model denotes the F test P-value of the full model. OEFinder then generates 10 000 simulated genes from permuted data to evaluate the significance of the observed aggregated statistics. By default, genes with permutation P-value <0.01 are identified as OE genes. The number of simulated genes and the P-value cutoff may be changed by a user (for further details, see Supplementary Section S2).
Output
List of OE genesOEFinder outputs two.csv files-one contains a sorted list of OE genes and the other contains p-values for all genes.
Expression matrix for downstream analysisOEFinder outputs a normalized expression matrix that can be directly input to downstream analyses. The user has the option to choose either removal of the OE genes, or imputation of the OE genes with adjusted values.
Visualization of OE genesOEFinder generates a .pdf file contains expression plots of the top N OE genes, where N is user specified. An example is shown in Supplementary
Evaluations
Simulation studiesWe conducted eight simulation studies to evaluate the performance of the OE detection algorithms. In each simulation, we generated 5000 expressed genes with 500 OE genes. Expression of OE genes was generated based on expression profiles of OE genes detected in empirical data. (Details of the simulations may be found in Supplementary Section S3.) The eight simulation studies evaluate cases with varying numbers of available cells (2090 cells). Each simulation study contains 100 repeated simulations.and c shows the true positive rate (TPR) and false positive rate (FDR) comparing the ANOVA-based method introduced inand OEFinder. Results indicate that >60 cells are available, both methods have TPR >90% while FDR is controlled <10%. When fewer cells are available, OEFinder has a higher TPR than the ANOVA-based approach and the FDR is still well controlled. The improved power in OEFinder is likely because the polynomial regression in OEFinder fits the OE trend more specifically than the ANOVA-based approach. Additional simulation results may be found in Supplementary Section S4.(a) OEFinder GUI for identifying OE genes (shown is implementation using R/RGtk2 package; an implementation using R/shiny package is also available, see Supplementary).OEFinder to identify OE genes in scRNAseq
Case studiesWe applied OEFinder on two publicly available datasets with capture site ID information.data anddata contain four and three experiments, respectively.and e shows 187 and 451 OE genes identified in the first experiment of each dataset. Genes detected by OEFinder show a clear OE pattern. Results of other experiments may be found in Supplementary Section S5.
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
N.Leng et al. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
