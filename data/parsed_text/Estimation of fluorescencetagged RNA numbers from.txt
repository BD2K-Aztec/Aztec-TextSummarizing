Motivation: Present research on gene expression using live cell imaging and fluorescent proteins or tagged RNA requires accurate automated methods of quantification of these molecules from the images. Here, we propose a novel automated method for classifying pixel intensities of fluorescent spots to RNA numbers. Results: The method relies on a new model of intensity distributions of tagged RNAs, for which we estimated parameter values in maximum likelihood sense from measurement data, and constructed a maximum a posteriori classifier to estimate RNA numbers in fluorescent RNA spots. We applied the method to estimate the number of tagged RNAs in individual live Escherichia coli cells containing a gene coding for an RNA with MS2-GFP binding sites. We tested the method using two constructs, coding for either 96 or 48 binding sites, and obtained similar distributions of RNA numbers, showing that the method is adaptive. We further show that the results agree with a method that uses time series data and with quantitative poly-merase chain reaction measurements. Lastly, using simulated data, we show that the method is accurate in realistic parameter ranges. This method should, in general, be applicable to live single-cell measurements of low-copy number fluorescence-tagged molecules. Availability and implementation: MATLAB extensions written in C for parameter estimation and finding decision boundaries are available under Mozilla public license at
INTRODUCTIONThe processes of production and degradation of RNA and protein numbers are stochastic, which causes these numbers to differ between individuals () and to vary over time in individual cells, even under optimal stable conditions (). Present measurement techniques to study these processes in live cells rely on the usage of fluorescent proteins (), and consequently on fluorescent microscopy and image processing methods, to extract the relevant statistical data. One of the most accurate techniques to quantify gene expression dynamics in vivo consists of tagging target RNA molecules with multiple MS2d-GFP proteins, which makes the target RNA transcripts visible as bright spots (), as soon as these are transcribed (). The present method of quantifying the RNA numbers in cells or in the fluorescent RNA spots relies on a manual selection of the intensity of a single-tagged RNA using the histogram of fluorescence intensities (). Following this selection, this method assumes that the peaks of spots intensities are concentrated at multiples of the expected intensity of a single RNA (), so as to quantify the number of RNA molecules in spots of varying fluorescence intensities. This method of quantification is not optimal for several reasons. First, it relies on human intervention, and the manual selection can have a major effect in the results of the process of counting the RNA molecules. This hampers comparison between results because the selection of the intensity of the first peak varies between users. Second, the distribution of the number of RNA molecules composing the spots is not uniform, and thus the optimal quantification of these numbers is not achieved by simple rounding. Third, the variance in intensities of the spots is expected to increase with the number of tagged RNAs composing the spot. Fourth, the tagged RNA molecules tend to accumulate at the poles of the cells, and one cannot rely on spatial separation between them (). Lastly, for large datasets, manually assisted quantification can be excessively laborious. Here, we propose an automatic method that improves on the RNA quantification from fluorescence images. For this, we establish a mathematical model of the intensities, which is free from any assumption on the shape of the distribution of the RNAs, as this distribution is the subject of the study. Also, we propose methods to estimate the parameters of the model and construct a classifier. We then exemplify the usage of the method in determining the number of RNAs in clusters of MS2-GFPtagged RNA molecules in Escherichia coli under various conditions. In particular, we compare results of analyzing cells with one of two target RNA constructs that differ in the number of binding sites for MS2-GFP proteins. In addition, the results are compared with a method that uses temporal information for the RNA quantification, and results from cells subject to different *To whom correspondence should be addressed. levels of induction of target RNA are compared with quantitative polymerase chain reaction (qPCR) measurements. Lastly, we study the performance of the classifier on simulated data, whose ground truth is known, and compare it with that of the previous method.
SYSTEM AND METHODS
Cells and plasmidsEscherichia coli strain DH5-PRO was provided by I. Golding (University of Illinois) and contains two constructs: a PROTET-K133 medium-copy vector carrying a MS2d-GFP reporter, controlled by P LtetO1 , and the pIG-BAC single-copy vector coding for mRFP1-MS296bs RNA, whose expression is controlled by P lac=ara1 (). The second construct was engineered by us, and it was designed to contain 48 binding sites (bs) for MS2-GFP. The target-gene vector pMKBAC, containing P lac=ara1 with a 48 MS2-GFP binding site array in a single-copy bacterial artificial chromosome (BAC), was constructed using standard molecular biology methods. P lac=ara1-48bs was amplified with smaI restriction endonuclease from a BAC clone carrying a target gene P lac=ara1-mRFP1-96bs. The primers (forward: 5 0 CCCGGGGAAGACATGAGGATCA 3 0 and reverse: 5 0 CCCGG GTCAATTCTGTGTGAAATTG 3 0 ) were designed to amplify the P lac=ara1-48bs with smaI restriction site flanking regions. The amplicon and the BAC vector were subjected to smaI restriction digestion, followed by ligation of the amplified product. We obtained a single-copy F-based plasmid carrying the target region P lac=ara1 with a 48bs array. This product was transformed into the competent E.coli strain DH5-PRO. The recombinants were selected with antibiotic screening and confirmed with sequence analysis.
Microscopy measurementsCells were grown in Miller lysogeny broth (LB) medium, supplemented with antibiotics according to the specific plasmids. Cells were grown overnight at 37 C with aeration, diluted into fresh medium and allowed to grow at 37 C until an optical density of OD600 of 0.30.5 was reached. To attain full induction of the MS2d-GFP reporter, cells were incubated with 100 ng/ml of anhydrotetracycline (aTc, from IBA GmbH). In all, 0.1% of L-arabinose (Sigma-Aldrich) and 1 mM of isopropyl-D-thiogalactopyranoside (IPTG, Fermentas) were used to fully induce the target RNA. In one case, IPTG was not added, so that the target gene remains only weakly induced. Cells were preincubated with arabinose at the same time as aTc. IPTG was added (if added) 1 h after aTc, and cells were incubated for 5 min. Microscopy was performed using a Nikon Eclipse (TE-2000-U, Nikon, Tokyo, Japan) inverted confocal laser-scanning microscope. Cells were imaged in a thermal chamber set to 37 C. Single time-point images were taken 1 h after induction by IPTG (if induced). For time series, images were taken 5 min after induction by IPTG, for 2 h, once per minute. For imaging, a few microliter of culture were placed between a coverslip and a slab of 1% agarose containing LB along with the appropriate concentrations of inducers. When both the reporter and the target RNA are present in the cells, MS2d-GFP proteins bind to the target RNA, forming a bright fluorescent spot (). The RNA becomes visible during or shortly after elongation ().
The qPCR analysis of the target RNAThe target RNA was induced as described earlier in the text. Following induction, the cells were immediately fixed with RNAprotect bacteria reagent, followed by enzymatic lysis with Tris-EDTA lysozyme buffer (pH 8.3). From the lysed cells, total RNA was isolated with RNeasy RNA purification kit (Qiagen), according to the manufacturer's instructions. DNaseI treatment was performed to avoid DNA contamination. The complementary DNA (cDNA) was synthesized (Fermentas, Finland) from 1 mg of RNA with iScript Reverse Transcription Supermix, according to the manufacturer's instructions. The cDNA templates with final concentration of 10 ng/ml were added to the qPCR master mix, which contained iQ SYBR Green supermix (Fermentas, Finland) with primers for the target and reference genes at a final concentration of 200 nM. We used the 16S ribosomal RNA housekeeping gene for internal reference. The primers for the target mRNA (forward: 5 0 TACGACGCCGAGGTCAAG 3 0 and reverse: 5 0 TTGTGGGA GGTGATGTCCA 3 0 ) target the mRFP1 coding region and the reference gene 16S ribosomal RNA (forward: 5 0 CGTCAGCTCGTGTTGTGAARNA should follow a binomially weighted mixture of sums of the amounts of lights detected from single MS2-GFPs. Regardless, if this is strictly true, given a large number of independent sources of light, the light detected from a singletagged RNA can be well approximated by a normal distribution (central limit theorem), if the signal-to-noise ratio is low. If the signal-to-noise ratio was high, it would be possible to estimate the GFP numbers instead. Letting the light detected from a single-tagged RNA to follow normal distribution N , 2  with mean of and variance of 2 , the light emitted by k-tagged RNAs will be distributed according to N k , k 2 , if the light emitted by the tagged RNAs are independent of one another. If the probability for finding a cluster of k-tagged RNAs is given by k , the mixture density takes the form as follows:where f N x j , 2  is the density of a normal distribution with a mean of and variance of 2. We do not wish to impose any constraints (model) on the distribution defined by k , which represents the RNA distribution, as this distribution is the subject of the study.
Parameter estimationThe form of the density of Equation (1) makes finding closedform estimates for the parameters hard. We solve the problem by applying expectation maximization (EM) algorithm (). The EM algorithm iteratively estimates new parameters h 0 using the 'incomplete' (observed) data y, the 'complete' data x and the current parameter estimates h by maximizing: Qh 0 j h  E log fx j h 0  j y, h   3 where fx j h is the complete data density. We denote the parameters bylikelihood function for h given the intensity observations y  : y 1 ,    , y M  and the RNA numbers k  : k 1 ,    , k M  is as follows:where x  y, k is the complete data. The distribution of the missing parameter K i under the parameters h is given by the following equation:yields the following form for Qh 0 j h:The parameters h 0 maximizing Equation (7) can be found by finding the roots of the partial derivatives and verifying that the obtained point is a global maximum. The estimators are as follows:where the variance estimator involves the true parameter. If the estimator ^ 0 is substituted for , Bessel's correction should be applied (or the variance will be underestimated on average). Lastly, we note that in our case the EM iteration is guaranteed to converge to a maximum of the likelihood function (). However, this maximum is not guaranteed to be the global maximum (). For this reason, it is required that either the initial parameter values for the EM algorithm are close to the optimal values or multiple initializations are used. An alternative iterative algorithm with reduced complexity can be derived by assuming some values of k i estimating the parameters and by assigning new k i by classifying the data under new estimate of the parameters. This algorithm is similar to the k-means clustering algorithm and is referred here as 'hard' EM, as opposed to the previous being 'soft' EM. Assuming k i , the parameter estimates become (by letting w ki  If k i  k g):and for ^ 0 as in Equation (9). In these, Ifg is the indicator function (unity if the condition is true, and zero otherwise), i.e. the estimator ^ 0 k is the fraction of items with k i equal to k. With these, only OM  N work is required per iteration, instead of OMN of the soft EM algorithm, which is significant for large N. Regardless of the algorithm used, an initial parameter estimate is required. We found the following scheme to be appropriate: (i) sort the observed data y i and partition it into N bins, (ii) assign k i  j if y i is in the jth bin and (iii) estimate initial parameters using Equations (9), (11) and (12). A good partitioning depends on the true values of k. We found that equidistant partitioning in y i is simple, parameter-free and appeared to yield results equivalent to more complicated schemes (e.g. multiclass Otsu's method). It is noted that hard boundaries (as in the above scheme) cause the variance to be initially underestimated, if the overlapping of the clusters is large.The parameter N can be found by finding the parameter estimates for several values of N and by selecting the model with least order that does fit significantly better than the lower-order models. To determine the significance, we use a likelihood ratio test, where the log-likelihoods ' a and ' b of models of orders a and b are obtained, respectively, and the statistic 2' a  ' b  is computed. For M ! 1, this statistic follows a 2 distribution, with b  a degrees of freedom (), from which a P-value can be computed. If the P-value is smaller than a given significance level, the higher-order model should be favored over the lower-order one. We note that this procedure rarely selects a model of too high order (as determined by the significance level), but for small sample sizes it might lack evidence to select the appropriate high-order model.
Spot classificationNext, we construct a classifier that is used to estimate the number of RNAs in a cluster based on the intensity of the cluster. We use maximum a posteriori decision rule, i.e a class k, which is the most probable, is to be associated with an intensity value x:where PK  k j x represents the posterior probability, and k the priors and f N x j k , k 2  the likelihood functions of each class (the equality owing to the Bayes rule). The classification can be performed by evaluating the term to be maximized for each k. Alternatively, a range of intensity values can be associated with each k. Possible decision boundaries can be obtained from the equation:If the decision boundaries x  do not exist, the density of the higher order envelopes the density of the lower-order one. If so, the lower-order class must not be associated with any intensity. Alternatively, even though the decision boundaries exist, it might be that a lower-order density is enveloped by multiple higherorder ones. A procedure starting from the highest-order density and proceeding to the lowest can determine the decision boundaries in ON time, which enables the lower complexity of the hard EM algorithm. The decision boundaries are symmetric around zero, so the classification can be performed on jxj, rather than x. For the purposes of evaluating the classifier performance, the expected accuracy (ACC) can be computed:where x  k and x  k are such that 8 x,The integral does not have a closed form solution, but it is the Gauss error function, and can be evaluated numerically. Lastly, we note that this quantity applies asymptotically if the model is true and the estimated parameters are correct. Nevertheless, it is likely useful to evaluate how hard the estimation problem is.
Means of comparison with the previous methodThe previous method of RNA quantification from the spot intensity histogram, here called rounding method, relied on manual inspection of the intensity distribution (). Namely, the location of the first peak in the distribution of intensities is selected by an expert, after which the intensities are divided by this value to obtain the RNA numbers in each spot and cell (). The discretization is achieved by rounding, which can result in suboptimal choice of thresholds for the classifier accuracy. Given our model of spot intensities, the expected accuracy of the rounding classifier can be computed using Equation (17) withwhere  is the location of the first peak. For comparison, we find  such that the accuracy is maximized. This classifier is not realizable, as the true parameters must be known, but it serves as the upper limit of performance of the classifier. Alternatively, it is possible to use the parameter estimation procedure proposed with the classification of the rounding method, which has the advantage that finding  can be automated. However, on average, such an automated method cannot perform better than the method proposed.
RESULTS
Estimating the number of MS2-GFP-tagged RNAsWe first used our method to estimate the number of MS2-GFPtagged RNA molecules in live E.coli cells. In one case, cells contained an RNA coding for 96 bs for MS2-GFP (). In the other case, cells contained a different construct, with only 48 bs. In both cases, cells were induced with 1 mM of IPTG and 0.1% of arabinose, and images were taken 60 min after induction. In theory, we expect the intensity of tagged RNAs to be halved in the second set of measurements. From both sets of images, we extracted the total pixel intensity of each cell and of each spot. This procedure yielded 269 and 155 samples of spot and cell intensities, respectively, from cells with the 96 bs construct, and 443 and 242 from cells with the 48 bs construct. For each construct, we assumed that all tagged RNAs exhibit the same fluorescence level when measured from either spot or cell intensities and can be represented by a distribution with the same mean and variance ( and 2 ). Such mean and variance only differ between the two constructs. With this constraint, one can use both datasets (cell and spot intensities), to jointly estimate the parameters of the model, for each construct. For this, we modified the estimator to account the joint estimation of the two sets of data and estimated the parameters in each case. The distribution of measured intensities along with the estimated distributions is shown in, and the values of the parameter estimates are given in. First, one would expect the mean of intensities detected from the 48 bs RNAs to be half of the one detected from the 96 bs RNAs. However, from, the estimated ratio of their means of intensities is 0.83, rather than one half. One likely explanation for this is that the number of functional binding sites in the two RNA constructs differs from the intended numbers (particularly in the case of the longer construct). Meanwhile, the ratio between the variances is expected to be similar to the ratio between the means. Instead, it equals 0.69, which deviates from the measured value, likely due to deviations in noise levels arising from non-linear changes in intensities with the number of binding sites. Nevertheless, we kept the estimated parameters values (), rather than imposing the constraint on the values, as they allow a significantly better fit than would be achieved by constraining the ratios to one half, as determined by a likelihood-ratio test (P52:1  10 4 ). Because the induction level of the target gene is the same in the two cases (96 and 48 bs constructs), one also expects similar RNA-per-spot (first and third row of) and RNA-percell distributions (second and fourth row) in both cases. The obtained values of b a suggest that this expectation appears to be correct. In agreement, we found no evidence that the parameters infit significantly better than in a case where each of the RNA-per-spot and RNA-per-cell distributions are constrained to be equivalent, as determined by a likelihood ratio test (P40.54). Next, we used the parameters obtained from the spot intensities and cell intensities to estimate the number of RNAs in each cell. Results are shown in. We note that the procedure of estimating the RNA numbers using the classification of intensities of each spot is expected to yield better results than estimating the RNA numbers from the total intensities of each cell (cf. accuracy in), as the problem is easier and the sample size is larger, but it requires an accurate detection of the spots inside the cells. As expected (and necessary if the methods are appropriate), the RNA statistics () are similar in the four cases (even though classifying spots are expected to yield better results than classifying cells). Also, the results are in agreement with previous measurements using the RNA target for 96 bs () in terms of mean and variance of RNA numbers.
Comparison with a time series methodTo validate our results, we compared our method with a previously introduced method () to extract RNA statistics from time series data (). Unlike our method, this method uses temporal information, i.e. time series of intensities in the cells, which allows better accuracy of RNA counting, but makes it unsuitable for analysis of individual frames of cell populations. We collected images taken for 2 h, separated by 1 min intervals, of cells subject to the same media and induction as in the previous cases. Then, we made use of the method fromto extract the RNA statistics at $60 min. The results are shown in. Visibly, these results are similar to those obtained by our method (cf.). To verify the agreement between the results using the two methods, we performed two-sample KolmogorovSmirnov permutation tests with the null hypothesis of the RNA numbers extracted from different methods and/or cases (A through F in Tables 2 and 3) are generated by an equal distribution, which assesses if the distributions are significantly different. All tests were done with 10 6 permutations, and the results are shown inNote: The table shows the number of samples M, the estimated model order ^ N (Section 2), the estimated parameters mean ^ and standard deviation ^ of the intensity of one RNA and the vector of probabilities b a. The value of ^ k is the estimated probability that one has k RNA molecules in a spot or cell (depending on the case).as a toggle switch), shown in the bottom panel of. The expected accuracies are 0.9394 and 0.5457, suggesting that our method is appropriate, but the rounding method is not. Lastly, we note that our method is likely biased for finite samples. We found that for sample sizes 5100, it generally overestimates the mean and the variance, which primarily results from underestimation of the order due to lack of evidence for selecting a highorder model with small samples. Regardless, even if the order was known, the maximum likelihood estimator is likely biased. However, these effects are negligible for larger sample sizes (410 2 ), and e.g. the standard deviation of the parameter estimates exceeds the bias ().. Distributions of accuracies for various samples sizes M obtained using MC simulations. Top panel: Poisson distributed , with  2:5 and 1  0:25. Bottom panel: bimodal distribution of and 1  0:5. Circles represent means, pluses medians and whiskers upper and lower standard deviations from the mean. The dashed lines are the expected accuracy for our method (higher value) and for the rounding method (lower value)
The Author 2014. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
0 and reverse: 5 0 GGACCGCTGGCAACAAAG 3 0 ). The experiment was performed using a Biorad MiniOpticon real-time PCR system (Biorad, Finland) with the following thermal cycling protocol: 40 cycles of 95 C for 10 s, 52 C for 30 s and 72 C for 30 s for each cDNA replicate. Reactions were performed in two experiments, each with two replicates per condition with a final reaction volume of 50 ml. Nonspecific signals and contamination were crosschecked using no reverse transcriptase and no template controls. PCR efficiencies of the reactions were495%. The CFX Manager Software was used to calculate relative expression, whereas standard errors were calculated as in Livak and Schmittgen (2001). 2.4 Image processing The individual frames of cells were analyzed as follows. First, the cells in the images were segmented using an automatic method (Chowdhury et al., 2013). Next, the each cell intensity is fit to a surface, which is a quadratic polynomial of the distance from the cell border, in least-deviations sense, which is subtracted to obtain the foreground intensity. The foreground intensity is fit with a set of Gaussian surfaces, in least-deviations sense, with decreasing heights until the heights are in the 99% confidence interval of the background noise (estimated assuming a normal distribution and using median absolute deviation). The Gaussians are taken to represent spots, the volume under each representing the total spot intensity. Meanwhile, the volume under the whole foreground surface is taken to represent the total cell intensity. The time series analysis was performed as described in Kandhavelu et al. (2012b), from segmentation to spot intensity calculation and RNA estimation. The new procedure was found to perform similar but had lower noise in spot intensities than the method from Kandhavelu et al. (2012b). 3 ALGORITHM 3.1 Model of RNA spot intensities The target RNA contains either 96 or 48 bs (earlier in the text) for MS2d-GFP molecules (Golding et al., 2005). Not necessarily are all the binding sites occupied by GFPs at all moments, but it is reasonable to assume that a large number of the binding sites are occupied, as the MS2-GFP is highly abundant in the cells, and the spots are easily visible at almost all time. The observed intensity can also vary because of other reasons, such as variations of the molecule locations with respect to the focal plane. If the amounts of light detected from a single GFP are independent and identically distributed, and the binding of MS2-GFP molecules are independent, occurring with a constant probability, the amount of light detected from a single-tagged
Estimating RNA numbers from spot intensities at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
A.H kkinen et al. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
A.H kkinen et al. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from From Table 4, we find that the results obtained from the images of cell populations using the spot intensities provided similar results to those extracted from time series (i.e. the null hypothesis cannot be rejected when comparing cases A, C, E and F). This indicates that our method performs consistently with the time series method. The same does not hold for the results extracted from the cell populations using cell intensities in all cases, where statistical differences are detected with higher sample sizes (B or D versus C or E). This further suggests that the spot intensities should be used in favor of the cell intensities for more accurate quantification of the RNA numbers. Generally, and confirming the results of the previous section, we found no evidence that the results extracted from the 96 and 48 bs constructs are statistically different. 4.3 Comparison with qPCR measurements We compared the fold-change in RNA numbers estimated using our method with those obtained by qPCR. For this, we used the 96 bs construct with induction levels of 1 mM (Table 2) and of 0 mM of IPTG (not shown), the former resulting in a higher expression rate. The estimated mean RNA numbers in the case of 0 mM of IPTG using our method were 0.68 and 0.63, using the spot and cell intensities, respectively. These result in expression ratios of 0.345 and 0.303. The expression ratio obtained by qPCR is 0.305 with a standard deviation of 0.024. Both numbers estimated using our method are within the 90% confidence interval of the qPCR measurement, indicating a strong agreement. 4.4 Applying the method on simulated data Lastly, we assessed the performance of the parameter estimation and classification using data from Monte Carlo (MC) simulations of our model [Equation (1)] so that the ground truth is known. First, we computed the expected accuracy of the classification procedure for different parameters values, which assesses the asymptotic performance of the classifier if the parameters are well estimated. This is shown in Figure 2. The accuracy can be good for either low-mean levels, where the problem is simpler, as most of time the number of RNAs is equal to unity, or for low-noise levels, as in this case the distribution consists of distinct peaks. More importantly, for typical RNA levels in E.coli [i.e. 110 (Bernstein et al., 2002)], the accuracy is 40.8 for noise levels 5 0.25 (which are in agreement with our results in Table 1). For high RNA levels and/or high noise levels, the accuracy deteriorates, as the distribution no longer exhibits distinct peaks. We found that the expected accuracy is similar with slightly non-Poissonian data (not shown) but generally better with subPossonian and worse with super-Poissonian. For typical RNA levels and low-noise levels (50.1), the accuracy remains 40.9 even for geometric distributed RNA numbers. The rounding method has comparable performance only for limited noise levels, and its performance is more sensitive to the RNA distribution. With a finite sample, the parameter estimates are not necessarily correct, which causes errors in the classification. We tested the method for various samples sizes, and the results for noise level of 1  0:25 and Poissonian RNA numbers with a mean of  2:5 are shown in the top panel of Figure 3. For small samples (e.g. 10), the performance is not comparable with the asymptotic performance, whereas for sample sizes410 3 the mean accuracy exceeds the theoretical accuracy of the rounding method (0.8049). We also used noise level 1  0:5 and a bimodal RNA distribution of  030, 0:01, 0:01, 0:66, 0:01, 001 (these are observed e.g. in the case of genes integrated into circuits such
DISCUSSION We have presented a fully automatic method of quantification of RNA numbers from the intensities of the either fluorescent spots or cells. The method consists of a numerical maximum likelihood parameter estimation step (with one of the two proposed methods) followed by a maximum a posteriori classification. We showed that the method proposed has several advantages. First, by being automated, it will allow an objective comparison of results from independent measurements. Second, our method is expected to have better accuracy than the previous method (Golding et al., 2005), when the distribution of RNAs is nonuniform and/or, when the measurement noise is high. When the distribution is uniform and/or the noise-level is low, the solution converges to that of the previous method. Third, our method allows the estimation of its own accuracy. The theoretical analysis indicates that the finite sample biases of the maximum likelihood estimators are negligible and that the method is expected to perform well ($80% accuracy or above) in a typical setting, when the sample size is few hundred samples or more, which is typical for a single-cell study. The method can be applied on various intensity distributions. We demonstrated its applicability on both the spot intensities and cell intensities extracted from live E.coli cells. The choice of the input is two-fold: spot intensities result in more accurate classification, but the detection of spots is required in addition to cell segmentation. In theory, the method is applicable to any fluorescent or fluorescence-tagged molecules present in low-copy numbers, such as low-expression level fluorescent proteins. However, a proper counting requires a certain degree of separation between brightness levels (not much smaller than the one between e.g. the RNAs with 48 bs). In this regard, our tests showed that the method fails if the data are too noisy or the degree of clustering of the spots is too high. For example, we tested the method on confocal microscopy measurements of tsr-venus proteins coded in E.coli, but the signal-to-noise ratio was found to be too low, except for rare cases, where all cells would have one or two proteins. Overall, we expect that, as the methods of fluorescent tagging and microscope improve, our method will become more widely applicable, as it is automatic and allows comparing data from different sources, which is currently not possible. Funding: Tampere City Science Foundation [to A.H.]; Academy of Finland [257603 to A.S.R.]; Tekes [1386/31/2012 to A.S.R.]; and Fundacao para a Ciencia e Tecnologia [PTDC/BBB-MET/ 1084/2012 to A.S.R.]. Conflict of Interest: none declared.
