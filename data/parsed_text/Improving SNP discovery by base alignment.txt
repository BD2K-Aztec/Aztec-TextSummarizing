I propose a new application of profile Hidden Markov Models in the area of SNP discovery from resequencing data, to greatly reduce false SNP calls caused by misalignments around insertions and deletions (indels). The central concept is per-Base Alignment Quality, which accurately measures the probability of a read base being wrongly aligned. The effectiveness of BAQ has been positively confirmed on large datasets by the 1000 Genomes Project analysis subgroup. Availability:
INTRODUCTIONOne of the leading sources of errors in SNP discovery is errors caused by indels (). Current solutions include realignment and filtering SNPs around predicted indels. However, realignment is computationally intensive; filtering SNPs around predicted indels is hampered by indel discovery which itself is a harder problem. This article aims to provide an effective and efficient solution to sorting out SNPs caused by misalignments. To begin with, we need to make a distinction between read mapping and read alignment, which are often taken as synonymous. I define the alignment of a read as the set of coordinate pairs of read and reference bases that are placed together, while define the mapping of a read as the coordinate interval between the first and the last reference bases inclusive in the alignment. We say an alignment is correct if all bases are aligned correctly and say a mapping is correct if it overlaps the true mapping. Therefore, an alignment can be wrong even if the underlying mapping is correct. Wrong alignments are mostly caused by the ambiguity in the presence of indels when we are unsure whether differences should be explained by mismatches or by indels. They tend to reoccur in the same context and deceive SNP callers into calling false SNPs. To account for the intrinsic alignment ambiguity, I model the read alignment with a profile HMM and compute a per-Base Alignment Quality (BAQ) to directly evaluate the probability of misalignment of each base. I will show that by replacing the original base quality with the minimum between the base quality and BAQ we can dramatically improve the SNP accuracy.
METHODS
The profile HMM for computing BAQLet the nucleotide reference sequence be x = r 1 r 2 ...r L (in practice x is the reference subsequence around a mapping) and the read sequence be y = c 0 c 1 ...c l c l+1 where c 0  '' marks the start of the read and c l+1  '$' marksthe end. Let i , i = 1...l, be the substitution probability associated with c i , which in practice is set to be the maximum between the scale mutation rate and the sequencing error probability deduced from the base quality. We can construct a profile HMM to simulate how to generate the read sequence y from the reference x without considering introns (). If we index the five types M, I, D, S and E by 0, 1, 2, 3 and 4, respectively, the transition matrix between types of states is:where  is the site-independent gap open probability,  the gap extension probability and  = 1/(2l) controls the average length of the read which does not affect the computation of BAQ in practice, although a formal proof is lacking. By default  and  are set to 0.001 and 0.1, respectively. They should be adjusted based on the sequencing indel error rate. As to emissions, the S state only emits the start symbol ('') and E emits the end ('$'). D are silent states that do not emit any symbols. The emission probability from I k is set to 0.25, and from M is a function of substitution probabilities { i }, which is, for i = 1,...,l:
The forward and the backward algorithmsThe recurrence equations are given as follows where any undefined values in the forward matrix f or the backward matrix b are assigned to zeros. The initialization of the forward algorithm is (k = 1,...,L):Page: 1158 11571158
H.LiFor i = 2,...,l and k = 1,...,L:The probability of the read being generated from the reference equals f l+1,E = b 0,S. In development, evaluating the equality helps to check the correctness of the implementation.
Computing BAQWe define an alignment A as a set of coordinate pairs {(otherwise as the coordinate of the reference base that the read base c i is aligned to. The BAQ is computed as Q(i|A) = 10log 10 1Pr{i-th read base aligned tois mostly above 40, the logarithm scale is appropriate. In SNP calling, we update the i-th base quality to min{q i ,Q(i|A)} where q i is the original base quality. The SNP calling algorithm may not need to be changed.
Numerical stability and banded accelerationGiven long sequences, the forward/backward algorithm given above may suffer from floating point underflow. For numerical stability, we computefinstead, where  k represents any state and the scaling factor s i is chosen such that. I refer toand the source code for details on computingfcomputing computingf ,  b and s. Another concern with the computation of BAQ is the quadratic time and space complexity O(L l). This can be resolved by only computing the forward and the backward matrices within a band that is large enough to contain the likely alignments.
RESULTS AND DISCUSSIONSBAQ is implemented in the SAMtools software package (), distributed under the MIT open source license.), which is done in 12 CPU hours with 110 MB memory.compares the quality of the call sets with and without BAQ applied. Note that for human, the transition/transversion ratio (ts/tv) is above 2, while ts/tv of random errors is 0.5. Thus, a worse call set tends to have a lower ts/tv. The much higher ts/tv with BAQ applied indicates that BAQ has effectively suppressed many false SNPs. In conclusion, BAQ successfully resolves false SNPs caused by misalignment and improves the accuracy of SNP discovery. In addition to base quality and mapping quality (), BAQ is another useful statistic towards accurate SNP calling.
The Author 2011. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oup.com
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
