Motivation: We have created an R package named phylogeo that provides a set of geographic utilities for sequencing-based microbial ecology studies. Although the geographic location of samples is an important aspect of environmental microbiology, none of the major software packages used in processing microbiome data include utilities that allow users to map and explore the spatial dimension of their data. phylogeo solves this problem by providing a set of plotting and mapping functions that can be used to visualize the geographic distribution of samples, to look at the relatedness of microbiomes using ecological distance, and to map the geographic distribution of particular sequences. By extending the popular phyloseq package and using the same data structures and command formats, phylogeo allows users to easily map and explore the geographic dimensions of their data from the R programming language.
IntroductionDeep sequencing of environmental metagenomes provides scientists with a way to assess the structure and function of microbial communities including the majority of microorganisms that cannot be cultured in the laboratory. In the course of a typical microbiome study, a number of datasets are generated that may include raw sequencing reads, tables of clustered reads, taxonomic tables, phylogenetic trees and sample collection information. This data can be organized and analyzed by a number of computational suites including QIIME (), mothur () and phyloseq (). While these are robust tools for processing data, none of them support mapping, a valuable tool for hypothesis generation that not only displays the physical location of samples but can also answer basic questions that have a spatial component (e.g. How are sample variable such as pH and carbon content distributed? Where are ecologically similar samples located? Are there sequences found in only one region?). To address this shortcoming we built phylogeo, an R package containing a set of functions for creating geography-centric plots of microbiome data. phylogeo was engineered as an extension of the phyloseq package, chosen for its simple design and its high-quality, programmable, ggplot-based () figures. By adding mapping capabilities to a preexisting software package, phylogeo minimizes the effort needed to generate maps, and thereby facilitates the exploration of the geographic relationships in microbiome sequencing data.
Biological applicationsMicrobial ecologists are interested in how microbial communities differ and what the functional significance and causes of those differences may be. Having a geographic perspective on the distribution of samples, their relationship with one another and the distribution of particular sequences can be an informative part of hypothesis generation. and phylogeo assists this process by providing a set of tools that can be used during the early stages of data analysis as well as to produce production-quality figures using the full customizability of ggplot. As illustrated in, phylogeo's functions allow users to map the intrinsic properties of samples (e.g. pH, nitrogen and carbon content) (), to show how microbial populations vary from sample to sample (,C), and to explore unusual distributions of particular metagenomic sequences (, E). The most basic function of phylogeo, map_phyloseq, creates a customizable map of a metagenomic dataset that can zoom into a region of interest, offset crowded points, and use color and shape to highlight the data associated with each sample including a sample's intrinsic properties and sequence-abundance (). This functionality can be combined with the powerful subsetting abilities of phyloseq to map only relevant portions of the data (e.g. map only the distribution of reads belonging to Actinobacteria) by using phyloseq to subset the dataset prior to mapping it. map_phyloseq, also serves as the foundation for phylogeo's other mapping functions which are tailored to look at the sample-sample relationships or to look at the geographic distribution of particular sequences. Sample similarity, an important component of microbiome studies, is calculated using an ecological distance metric such as the Jaccard, Bray-Curtis and UniFrac distances (). phylogeo provides two tools for exploring how intersample comparisons correlate with geographic distance. The plot_distance function calculates the ecological and geographic distance between every set of samples and creates a scatter plot that provides a global overview of the relationship between geographic proximity and ecological similarity within a dataset (). The second function, map_network, produces a map in which sample sites are connected by lines if they are more ecologically similar than a threshold value (). As in phyloseq's network-based utilities, the user can specify the distance metric and cutoff values, allowing a user to quickly assess ecological similarity across samples. Finally, if a phylogenetic tree of sequences is available, phylogeo provides two functions that allow a user to look at the distribution of these sequences in space. This sort of analysis can be of particular use to microbiologists studying enzymes where different subclades may have unique activities, allowing them to visualize where these subsets are located. map_tree plots a phylogenetic tree of sequences along with a map of sample locations, allowing the user to easily locate sequences on the map () while map_clusters uses k-means clustering to divide the phylogenetic tree into k similarity groups, and individually map those groups to show the location and abundance of the sequences. ()
ConclusionThe geographic component of environmental microbiomes has been underexplored in microbial ecology studies due, in part, to the difficulty of combining microbiome data with geographic plotting tools. phylogeo makes it possible for any user of R to easily and reproducibly generate maps showing the geographic patterns in their microbiome data.
Funding
ReferencesAuguie,B. (2012) gridExtra: functions in Grid graphics. R package version 0.9.1 http://CRAN.R-project.org/package=gridExtra.. phylogeo facilitates the geographic exploration of microbiome sequencing datasets. phylogeo functions can display (A) a zoomed-in map that displays sample properties (pH) with map_phyloseq; (B) pairwise geographic and ecological distances of all samples using plot_distance; (C) ecological relatedness of samples with map_network; (D) plotting sequences location with map_tree; and (E) the location of sequence subgroups as identified by k-means clustering with map_clusters. Code to recreate these figures is part of the web-based documentation on the phylogeo homepage
phylogeo
Methods phylogeo is written in R and extends the commonly used phyloseq package with only a single additional requirement: that the dataframe encoding sample information contain a latitude and longitude column. phylogeo's plotting and mapping functions use a number of open source R packages for mapping, network and phylogenetic analyses. [maps (Richard et al, 2014), sp (Edzer and Pebesma, 2005), ggplot2 (Wickham, 2009), gridExtra (Auguie, 2012), igraph (Nepusz, 2006), ape (Strimmer, 2004)] By integrating many preexisting packages that process geographic and phylogenetic data, phylogeo facilates exploratory data analysis of microbiome data. V C The Author 2015. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com 2909 Bioinformatics, 31(17), 2015, 29092911 doi: 10.1093/bioinformatics/btv269 Advance Access Publication Date: 25 April 2015 Applications Note at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
Z.Charlop-Powers and S.F.Brady at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
