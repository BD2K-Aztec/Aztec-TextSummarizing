Motivation: Distance methods are well suited for constructing massive phylogenetic trees. However, the computational complexity for Rzhetsky and Nei's minimum evolution (ME) approach, one of the earliest methods for constructing a phylogenetic tree from a distance matrix, remains open. Results: We show that Rzhetsky and Nei's ME problem is NP-complete, and so probably computa-tionally intractable. We do this by linking the ME problem to a graph clustering problem called the quasi-clique decomposition problem, which has recently also been shown to be NP-complete. We also discuss how this link could potentially open up some useful new connections between phylo-genetics and graph clustering.
IntroductionOne of the earliest distance-based approaches introduced to construct a phylogenetic tree is the minimum evolution (ME) method. It was first suggested by Kidd and Sgaramella-Zonta (1971) and consists of two main steps: First branch lengths are assigned to tree topologies based on a distance matrix, and then a topology is selected which minimizes the sum of the branch lengths. There are several variants of this approach which are reviewed in e.g.and Desper and Gascuel (2005). Although model-based tree construction methods, such as likelihood and Bayesian approaches, are tending to supersede distance-based methods in the literature, ME methods still remain popular. This is in part due to the fact that large-scale sequencing applications such as metagenomics involve constructing massive trees for which distance-based methods are well suited (see e.g.. In this article, we are interested in the ME approach introduced by. This is based on ordinary least squares (OLS) estimates of branch lengths, served as a motivation for the neighbor-joining method (), and is implemented byin the popular FastME software. It is commonly believed that, just as the optimization problems arising from the parsimony () and the likelihood () approaches, this version of the ME method also leads to an NP-complete problem and, so, is probably computationally intractable. However, even though this has been stated to be the case in some of the literature (probably because tree construction based solely on OLS for integer branch lengths is), to our best knowledge this fact has not been formally proven. It should also be noted, however, that the closely related and more recently introduced balanced ME (BME) problem ()in which branch lengths are estimated by a special case of weighted least squares ()has been shown to be NP-complete ().Here, we shall show that the ME problem is NP-complete for trees with integer branch lengths. In particular, to prove our main result, we show that the ME problem is closely related to the so-called quasiclique decomposition problem, a special example of a graph clustering problem (see, e.g.) which has recently been shown to be NP-complete by. We believe that the link that we describe could open up some interesting and useful new connections between the fields of phylogenetics and graph clustering (), a burgeoning area with several applications including pedigree construction () and community structure detection (). The rest of the article is organized as follows. In the next section, we show that certain OLS weightings for trees relative to a distance matrix are related to clique properties in a graph that can be associated to the distance matrix. In the following section, we then show that a rooted version of the ME problem is NP-complete, and explain how a technique used in Day (1987) can be used to show that the ME problem is NP-complete (we provide the full proof for this in the Supplementary appendix as it is quite technical in nature). In the last section, we discuss a link between phylogenetics and graph clustering which arises from our approach to the ME problem, and some possible future directions.
L 2-weightingsIn this section, we shall show that OLS tree weightings for a certain distance matrix associated to a graph G can be related to a clique property of G. We first recall some definitions concerning trees. For a set X of taxa, a rooted X-tree T  V; E is a graph-theoretical tree with (i) leaf set X, (ii) no vertices of degree two and (iii) a specific vertex q which is called the root of T and will not be regarded as part of the leaf set. Given a rooted X-tree T  V; E, we let T be the partial order on V induced by T , that is, u T v, or u is below v, if and only if v is contained in the path from the root q to u. If in addition, we have u 6  v, we write u < T v and say that u is strictly below v. The lowest common ancestor of two vertices u and v, denoted by lcau; v, is defined as the lowest vertex in T such that both u and v are below it. Moreover, for each vertex u in T , Cu  fx 2 X : x T ug denotes the set of leaves below u. Finally, a rooted X-tree with a particularly simple structure is the star X-tree S X whose vertex set consists of the root q and leaf set X. A weighting of a rooted X-tree T is a map x that assigns every edge of T a non-negative real number. Given such a weighting, D x u; v denotes the length of the shortest path in T between any two vertices u and v. Moreover, such a weighting is called an integer equi-weighting on T if x : E ! Z ! 0 : f0; 1; 2;. .. ; g and D x x; q  D x y; q for all x; y 2 X. Given a distance matrix D on a set of taxa X and a rooted X-tree T , an L 2-weighting x for T ; D is an integer equi-weighting on T such thatis minimum over all integer equi-weightings on T. In this case, we shall say that T ; x is an L 2-representation of D. Now, for a graph G  X; E with vertex set X, let D G be the distance matrix on X such that for a pair of distinct elements x and y in X, we have D G x; y  2 if x, y are adjacent in G, and D G x; y  4 otherwise. The edge density of G, denoted by cG, is defined as jEj= X 2 ! and G is called a semi-clique if cG ! 1=2. In the following we will also refer to subsets X 0 X as semi-cliques in G if the subgraph of G induced by X 0 is a semi-clique. We now provide a key relationship between the edge density of G and L 2representations of D G .
LEMMA 2.1:Suppose that G is a graph with vertex set X, jXj ! 2, and S X is the star X-tree. Let x i (i  1, 2) be the weighting that assigns to each edge of S X weight i. Then the following assertions hold:i. If cG > 1=2, then x 1 is the unique L 2-weighting for S X ; D G . ii. If cG < 1=2, then x 2 is the unique L 2-weighting for S X ; D G . iii. If cG  1=2, then the L 2-weightings for S X ; D G  are x 1 and x 2 .
PROOF:For simplicity, put D : D G and let x j (j 2 Z ! 0 ) be a weighting function that assigns weight j to each edge in S X. Noting that each leaf is incident to the root, we know that an L 2-weighting for S X ; D must equal x j for some j in Z ! 0 because an L 2-weighting is necessarily an integer equi-weighting. Because Dx; y 2 f2; 4g for x 6  y in X, a straightforward calculation leads to minfDD x1 ; D; DD x2 ; Dg < DD xj ; D for j 2 Z ! 0  f1; 2g. In other words, an L 2-weighting for S X ; D is either x 1 or x 2. Let n and m be the number of vertices and edges in G, respectively. Then we have DD x1 ; D  DD x2 ; D  2nn  1  4m:If cG > 1=2, then we have 2m=nn  1 > 1=2, and hence 4m > nn  1. Together with Equation (1), this implies DD x1 ; D < DD x2 ; D, and hence x 1 is the unique L 2-weighting for S X ; D. This completes the proof of part (i); parts (ii) and(iii) follow by similar arguments. hFor G as above, we now summarize how the property of being a semi-clique is related to L 2-representations of D G .LEMMA 2.2:Suppose that G is a graph with vertex set X, jXj ! 2, and T is a rooted X-tree with root q. Let x be an L 2-weighting for T ; D G , then D x x; y ! 2 for all x; y 2 X; x 6  y. In addition, if q  lcay; z for some y; z 2 X, then we have D x x; q 2 for all x 2 X, where equality holds if G is not a semi-clique.
PROOF:For simplicity, put D : D G and for a vertex u 6  q, let p(u) be the parent of u, that is, the vertex on the path from u to q in T that is adjacent to u. Since x is an L 2-weighting, we know that for every pair of elements x; y 2 X, we have D x u; x  D x u; y for every common ancestor u of x and y. In particular, we havecontradicting that x is an L 2-weighting for T ; D. Now assume that q  lcax 1 ; x 2  for some x 1 ; x 2 2 X. It remains to show that k 2, that is, D x x; q 2 for all x 2 X. If not, then we have k ! 3. Let fu 1 ;. .. ; u t g be the set of vertices in T such that D x q; pu i   0 and D x q; u i  > 0 for 1 i t. Then fCu 1 ;. .. ; Cu t g is a partition of X. Let x 0 be the integer equiweighting obtained from x by setting x 0 e  xe  1 for efpu i ; u i g with 1 i t, and x 0 e  xe otherwise. Then for x 2 Cu i  and x 0 2 Cu j  with i  j, we haveTherefore, in view of t ! 2, we havecontradicting that x is an L 2-weighting for T ; D. Finally, when G is not a semi-clique, a proof similar to that of Lemma 2.1 shows k  2, and hence completes the proof of the lemma. h
ME is NP-completeIn the last section, we saw how L 2-weightings were related to semicliques. We now use this information to relate semi-clique decompositions of graphs to the ME problem, which will also allow us to show that this latter problem is NP-complete. We begin by presenting a problem that is closely related to the ME-problem. Given a distance matrix D on X, a rooted X-tree T and an L 2-weighting x for T ; D, we let xT  denote the sum of the edge-weights of T .Problem Ultra-metric ME (UME(D, m)) Instance: A distance matrix D on a finite set X and an integer m. Question: Does there exist an L 2-representation T ; x of D such that xT  m?Now, let G be a graph with vertex set X. We call a partition P of X a semi-clique decomposition of G if every set in P is a semi-clique in G. We now relate this concept to the problem of finding a solution to the UME problem.
Proposition 3.1:Let G be a graph with vertex set X and k ! 1 an integer. Then there exists a semi-clique decomposition of G with size at most k if and only if there exists an L 2-representation T ; x of D G with xT  jXj  k.
Proof:Put D : D G and n  jXj. In addition, let x j (j 2 Z ! 0 ) be the weighting function that assigns weight j to each edge in a rooted X-tree. To simplify the proof it will be convenient to allow vertices of degree two in a rooted X-tree. " ) " Let fX 1 ; X 2 ;. .. ; X k g be a semi-clique decomposition of G whose size is minimum over all semi-clique decompositions of G. If k  1, then consider the star tree S X. Since G is a semi-clique, by Lemma 2.1 we know that x 1 is an L 2-weighting for S X ; D and, clearly, x 1 S X   n, as required. So, assume k > 1. Then G is not a semi-clique. For each 1 i k, let T i : S  Xi be the X i-tree obtained from S Xi by adding a new node adjacent to the root of S Xi , and designating this new node as the root of S  Xi. Note that, if jX i j  1, then S Xi contains one edge while S  Xi contains two edges. Considering the X-tree T obtained by identifying the roots of all T i as the root of T , each tree T i can be regarded as a subtree of T. Moreover, since x 1 T   jXj  k, it suffices to show that x 1 is an L 2-weighting for T ; D. To this end, consider an arbitrary L 2-weighting x for T ; D. Since G is not a semi-clique and k > 1 implies that q is the lowest common ancestor of a pair of elements of X, by Lemma 2.2 we have D x q; x  2 for all x 2 X, as well as D x x; y ! 2 for x  y. Therefore, to establish that x 1 is an L 2-weighting for T ; D, it remains to show, for all i with jX i j ! 2, that xe  1 for all edges e in T i. Indeed, if this does not hold for some i with jX i j ! 2, then by D x x; q  2 and D x x; y ! 2 for x  y in X i we must have xe  2 for all pendant edges e in T i and xe  0 for all other edges. Let x 0 be the weighting function on the edges of T defined as x 0 e  1 for edges e in T i and x 0 e  xe otherwise. Since X i is a semi-clique in G, an argument similar to the one used in the proof of Lemma 2.1 either yields DD x 0 ; D < DD x ; D; contradicting that x is an L 2-weighting, or DD x 0 ; D  DD x ; D, as required. " ( " Let k be the minimum positive number such that there exists a rooted X-tree T  V; E and an L 2-weighting x for T ; D with xT  jXj  k. Without loss of generality, we may assume that k < jXj (as otherwise the conclusion clearly holds) and that the root q of T is the lowest common ancestor of two elements in X (as the single edge incident to a root of degree one can always be contracted without changing the distance D x x; y for any x; y 2 X). In addition, we may assume that xe > 0 for all edges e 2 E (indeed, by Lemma 2.2 we can assume xe > 0 for all pendant edges e of T and an interior edge with weight 0 can simply be contracted) and may further assume that x  x 1 (as an edge with weight m > 1 can be replaced by m edges with weight 1). Now, if k  1 it follows immediately from the assumptions above that T  S X and, therefore, in view of Lemma 2.1 we can conclude that G is a semi-clique, as required. So assume 1 < k < jXj. Then we can further assume that G is not a semi-clique, as otherwise the result clearly holds. Therefore, by Lemma 2.2, we have D x1 x; q  2 for some (and hence all) x 2 X. This implies that, besides jXj pendant edges, T contains k edges fe 1 ;. .. ; e k g that are adjacent to q. For 1 i k, let X i be the set of elements x in X such that the path between q and x contains e i and let E i be the set of pendant edges incident to e i. It remains to show that, for 1 i k, X i is a semi-clique in G. Indeed, if this were not the case for some i, then clearly jX i j ! 2. Let x 0 be the weighting function obtained from x 1 by setting x 0 e  0 for e  e i , x 0 e  2 for e 2 E i , and x 0 e  x 1 e otherwise. Since X i is not a semi-clique, an argument similar to the proof of Lemma 2.1 leads to the contradictionBy the main result ofit follows that the following problem is NP-complete. Problem Semi-clique decomposition (SCD(G, k)) Instance: A graph G with finite vertex set X and an integer k. Question: Does there exist a semi-clique decomposition P of G such that jPj k?Using this fact, we immediately obtain the following corollary to Proposition 3.1.
Corollary 3.2:The problem UME(D, m) is NP-complete, even when the non-diagonal entries of the distance matrix D are all in {2, 4}. h Now we return to the ME problem mentioned in Section 1. It refers to unrooted X-trees, that is, we drop the condition of having a distinguished root vertex and, as a consequence, when referring to weightings we also drop the condition that all leaves have the same distance from the root. To avoid any confusion as to whether the latter condition applies or not we will use the term unrooted when referring to weightings and L 2-representations for which it does not apply. Formally, the ME problem is stated as below.Problem ME (ME(D, m)) Instance: A distance matrix D on a finite set X and an integer m. Question: Does there exist an unrooted L 2-representation T; x of D such that xT m? Now, using Corollary 3.2 and the following transformation that was presented bywe show that the ME problem is NPcomplete. Given a distance matrix D on X with jXj  n and two integers m and p, let Y : fy 1 ;. .. ; y m g be a set disjoint from X and let ~ D : f m;p D be the distance matrix on X [ Y defined as ~ Dx i ; x j   Dx i ; x j  for x i ; x j 2 X; ~ Dx; y  p for x 2 X; y 2 Y, and ~ Dy i ; y j   2 for y i  y j in Y. The NP-completeness of ME follows from the next result, whose rather technical proof is presented in the Supplementary appendix.
Proposition 3.3:Suppose jXj  n ! 4. Suppose that D is a distance matrix on X with Dx; x 0  2 f2; 4g for x  x 0 in X. Let p  n 3 ; m  p 3 and k ! 1. Then D has an L 2-representation T ; x with xT  n  k if and only if f m;p D has an unrooted L 2-representation T; w with wT n  k  m  p  3.
By Proposition 3.3 and Corollary3.2 we obtain the main result of thisarticle.
Theorem 3.4:The problem ME(D, m) is NP-complete even when the non-diagonal entries of the distance matrix D take on only three values. hIt would be interesting to see whether the ME problem is hard for the more general case where the edge weights can be set to rational numbers. Note that the hardness of the BME problem mentioned in Section 1 includes the case of rational weight (). On the other hand, Theorem 3.4 does not imply that the rational version of the ME-problem (RME) is hard, and there are many optimization problems which can be solved efficiently once the restriction that the solution must be integral is removed, such as the well-known linear programming problem (cf.). A starting point to explore the complexity of RME could be the observation that the semi-clique decomposition problem is a special case of the c-clique decomposition problem for c  1 2 , in which the aim is to decompose a graph G into a minimum number of c-cliques, where c is a real number with 0 c 1, and a c-clique in G is a subset C of V having at least c jCj 2 ! edges in G with both endpoints in C (cf.). In addition,showed that the c-clique decomposition problem is NP-complete. However, to date we have not been able to use this fact to prove that the RME problem is also NP-complete.
DiscussionTo prove that the ME problem is NP-complete, we first showed that the UME problem is NP-complete by relating it to the semi-clique decomposition problem. Interestingly, this is a special example of a more general link between tree inference and graph clustering problems. In particular, we can link the following two types of problem for a set X:i. Given a distance matrix D on X and a tree scoring function r D on the set T X of all rooted X-trees, find a tree that optimizes r D. ii. Given a graph G with vertex set X and a cluster scoring function j G : P X ! R that assigns to each partition in the set P X of all partitions of X a real number j G , find a partition of X that optimizes j G .More specifically, this correspondence is obtained by restricting any given tree inference problem to the set of rooted trees in T X where every leaf is adjacent to a vertex that is adjacent to the root (the tree in, for example, has this structure), to edge weightings that assign to every edge weight 1 and to distance matrices that have only off-diagonal entries that are 2 or 4. In this restricted type of rooted tree, every vertex u adjacent to the root induces a cluster of elements in X (namely the leaves that are adjacent to u) and, clearly, for every partition P of X there exists a unique such tree T P that induces precisely the clusters in P. Thus, given any graph G with vertex set X and the distance matrix D  D G on X which is induced by G, we obtain the cluster scoring function j G from the scoring function r D by putting j G P  r D T P . To give another example of this correspondence, consider the L 1-fit problem (see, e.g.). In this problem, given a distance matrix D the aim is to find a rooted X-tree T which minimizes the score r D T  which is equal to the minimum of X x;y2X jDx; y  D x x; yj taken over all weightings x of T. For this example, the corresponding graph clustering problem is known as the correlation clustering problem () where the cluster scoring function j G assigns, for a given graph G with vertex set X, to any partition P in P X the number of 2-element subsets (i.e. edges)(a) A rooted graph theoretical tree T with root q and leaf set X  fx 1 ; x 2 ;. .. ; x 9 g. For the edge weighting x that assigns weight 1 to every edge of T , the shortest path distance Dxx2; x5  4. (b) A graph G with vertex set X  fx1; x2;. .. ; x9g that is partitioned into the clusters C 1 , C 2 and C 3 indicated by the shaded boxes e  fu; vg of X that violate P, that is, either e is an edge of G but u and v do not lie in the same cluster in P or e is not an edge of G but u and v both lie in the same cluster of P. For the partition P  fC 1 ; C 2 ; C 3 g of the graph G in, for example, this cluster scoring function yields a score of 4. It is not hard to check that the L 1-fit of the tree infor the distance matrix D G derived from the graph G is 4 too. Note that minimizing the cluster scoring function corresponding to the L 1-fit is equivalent to computing the minimum number of edge deletions and insertions that suffice to transform G into a disjoint union of complete graphs. When adopting this latter view, correlation clustering is usually referred to as cluster editing (see, e.g. B cker et al., 2011). It would be interesting to explore which tree inference problems are related in a similar way to other graph clustering problems, and conversely. This could yield useful new insights into these inference problems, and possibly new algorithms for their solution or approximation.
at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
S.Bastkowski et al. at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
