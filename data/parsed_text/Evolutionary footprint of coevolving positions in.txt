Motivation: The analysis of molecular coevolution provides information on the potential functional and structural implication of positions along DNA sequences, and several methods are available to identify coevolving positions using probabilistic or combinatorial approaches. The specific nucleotide or amino acid profile associated with the coe-volution process is, however, not estimated, but only known profiles, such as the Watson–Crick constraint, are usually considered a priori in current measures of coevolution. Results: Here, we propose a new probabilistic model, Coev, to identify coevolving positions and their associated profile in DNA sequences while incorporating the underlying phylogenetic relationships. The process of coevolution is modeled by a 16 Â 16 instantaneous rate matrix that includes rates of transition as well as a profile of coevolution. We used simulated, empirical and illustrative data to evaluate our model and to compare it with a model of 'independent' evolution using Akaike Information Criterion. We showed that the Coev model is able to discriminate between coevolving and non-coevolving positions and provides better specificity and specificity than other available approaches. We further demonstrate that the identification of the profile of coevolution can shed new light on the process of dependent substitution during lineage evolution.
INTRODUCTIONCoevolution is defined as 'the modification of a biological object triggered by the change of a related object' (). This process of dependent evolution has been described in various biological systems and can be an essential process behind changes occurring at both morphological level, e.g. coevolution of female and male genital morphology (), and molecular level (), e.g. ligandreceptor interactions (). At the molecular level, studies of dependent substitutions have gained importance in evolutionary biology because of the potential functional and structural interpretations that can be made on the positions identified as coevolving. For example, coevolving positions in proteins are known to be involved in allosteric communication, to create physically connected networks that link distant functional positions in the tertiary structure, and to modify the structure of the protein (). Further, it has been shown recently that coevolving fragments within protein sequences can also be involved in binding specificity and folding constraints (). They are thus good indicators to explain folding intermediates, peptide assembly and key mutations with known roles in genetic diseases (). Coevolution within RNA sequences also revealed structurally and functionally important positions (), which are often located on helices and are subject to WatsonCrick constraint (i.e. guaninecytosine and adeninethymine complementarity). For example, the positions 245 and 283 of the 16S ribosomal RNA in Thermus thermophilus coevolved under the specific WatsonCrick profile {CC, UU}, respectively, to maintain the specific hydrogen bonds necessary for the stability of the helix hairpin-like structure (). Current methods designed to detect coevolution focus primarily on the identification of pair of positions along the aligned sequence by evaluating a score of coevolution. Some methods consider solely the set of aligned sequences to estimate these coevolving positions (), while others take into account the evolutionary history of the observed sequences (). The score of coevolution usually represents the correlation of the nucleotide or amino acid patterns found at two different positions along a multiple alignment. This correlation can be considered as the outcome of the dependent evolutionary process that is depicted by coevolution and the correlated pairs constitute the set of coevolving nucleotides or amino acids. This set is defined here as the profile of coevolution and is similar to the profile of site classes present in phylogenetic mixture models (e.g.). While current methods designed to detect coevolving positions have proven very useful, they do not estimate the coevolving profile that corresponds to the structural or functional constraints involved in the evolutionary process (). This lack of a mechanistic component induces the use of arbitrary rules to identify the profile of coevolution for protein-coding sequences, such as using the most frequent pattern within a pair of coevolving positions (). Alternatively, the profile of *To whom correspondence should be addressed.  The Author 2014. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com coevolution can be set a priori, like in the case of RNA sequences where WatsonCrick profiles are known to be important. Setting a profile a priori was done in a Bayesian context () by constraining the mapping of substitutions that occurred independently at each site on the branches of the phylogenetic tree using, as weights, the biochemical properties of the nucleotides defining the WatsonCrick constraint. Similarly, this constraint was used as modifiers of the rate parameters of a dependent model describing the process of coevolution (). State transitions that establish or maintain Watson Crick base pairs were favored and coevolution under this specific constraint was assessed through likelihood ratio tests. These two approaches confirmed that a well-known coevolving pair was constrained by a WatsonCrick profile in 16S RNA sequences (). However, other known types of constraints, such as the Hoogsteen base pairing (), were not explicitly incorporated in the model and thus not identified in these analyses. Furthermore, the integration of particular constraints in the models may be difficult in the case of amino acid or proteincoding DNA sequences, for which little a priori information is available regarding the coevolving profiles. Thus, the coevolving profile should be considered as a parameter to be estimated from the data, rather than being defined on the basis of the frequencies of coevolving patterns or of known constraints. Methods that estimate coevolving profiles in DNA, RNA or protein sequences are currently not available. However, some methods have been developed for binary encoded data where coevolving profiles represent presence or absence of characters such as genes, restriction sites, introns, indels and methylation sites (). Identifying the profiles of binary character states involved in correlated evolution is also an important part of the analyses of phenotypic data. These approaches have progressed from using maximum parsimony criteria () to a full probabilistic framework () in which the dynamics of presence and absence of events are assumed to follow a continuous-time Markov process along the phylogenetic tree. In this context, it is possible to define a dependent substitution model, which is expressed as a 4  4 matrix of instantaneous transition rates, to explain the correlated evolution of two binary characters (). Each row and column of this matrix specifies a pair of character states built on an alphabet of size 2 (i.e. the character states of binary traits), which defines two possible profiles of coevolution {00, 11} or {01, 10}. This model can be compared to an independent model of evolution, which assumes a single 2  2 substitution matrix, through likelihood ratio tests (). It is possible to apply the ideas used for binary data to identify profiles in molecular data. The nucleic (or proteic) alphabet can be reduced to an alphabet of size two using the physico-chemical properties behind the nucleotides or amino acids (). This reduction is, however, arbitrary and could omit important factors that play a role in the evolution of the molecular sequences. For this reason, we propose in this study a new Markov model that describes the evolutionary process of coevolving positions along DNA sequences. Because correlated positions within nucleotide and protein sequences are the result of an evolutionary process, a better understanding of the coevolving profile should be obtained by incorporating the underlying evolutionary history of the sequences (i.e. their phylogenetic relationships and the associated profile;). We thus developed a dependent model of nucleotide substitutions based on a 16  16 instantaneous rate matrix that includes four substitution rates s, d, r1, r2 and a fifth parameter representing the profile of coevolution. We implemented the model in maximum likelihood and Bayesian frameworks. The performance of the model was tested simulated datasets and we compared the model's predictions with existing methodologies on empirical data.
MATERIALS AND METHODS
Definitions and notationsLet us consider the set S of aligned orthologous DNA sequences and a phylogenetic tree. We define a combination C as the association of two letters l 1 C, l 2 C from the same aligned sequence seq 2 S, where l 1 C is the letter at the first position in seq and l 2 C is the letter at the second position in seq. The maximal number of possible combinations depends on the size of the alphabet and is equal to 16 in the case of nucleotide sequences. For a pair of positions, the two combinations C 1 and C 2 are called 'conflicting combinations' if either l 1 C 1  is equal to l 1 C 2  or l 2 C 1  is equal to l 2 C 2 , that is, if two words share a common letter at any one of the two positions. For a pair of positions, every combination C i has a number of occurrences oC i  within the associated alignment S and a combination frequency fC i , which is oC i  divided by the total number of aligned sequences. In the pair P1 (), for example, combinations AC and TT occur at the same frequencies, whereas in pair P2, the number of occurrences o(TT) is higher than the other and, thus, fTT4fAC (). We define as Comb the set of combinations observed in a pair of sites, which represents a subset of the 16 possible combinations. For example, pair P3 (A coevolving profile 2 P, is a subset of Comb that does not include any pairs of conflicting combinations. In the case of nucleotide sequences, the size of a profile varies from 2 to 4 and the total number of profiles is 192 ( P j j  192; Supplementary; Supplementary Material 1). The frequency of a profile is further calculated as the sum of thecombination frequencies composing it. For instance, in the pair P3 (), the profile {AC, TT} is of size 2 and has a frequency of 0.8.
Model of coevolving substitutionsA dependent model of evolution for binary characters can be derived from the standard models of substitutions by extending the dimensionality of the instantaneous rate matrix Q and evaluating the likelihood of a pair of positions simultaneously (). Using a similar approach, a dependent model for DNA sequences will be based on a Q matrix of size 16  16 to account for the four states A  fA, C, G, Tg representing the nucleotide alphabet. For amino acid sequences, the instantaneous rate matrix would be of size 400  400. Coevolution further posits that a substitution should trigger the change at another position during a coevolution event and that these two events should not happen simultaneously. Consequently, all double substitutions have a rate of 0 (). The Q matrix of a generalized model of dependent evolution for DNA sequences will thus be composed of 96 non-zero different instantaneous rates (), which will clearly lead to overparameterization of the model. We propose a new way to restrict the number of parameters by incorporating into the dependent model the discrete parameter representing the coevolving profile. This will reduce the number of parameters to estimate from 96 to 4. There are at most 192 distinct profiles that can be formed by combining two nucleotide positions. For each of these profiles, a unique 16  16 Q matrix is constructed by distributing differently the four parameters depending on the combination involved in each profile (Supplementaryand; Supplementary Material 1). Given a profile, , the instantaneous rate matrix Q of our model, Coev, is modeled as follows:Q ij  0 if i and j differ by two nucleotide positions, r1 if fi, jg = 2 and if i differs from j at position 1, r2 if fi, jg = 2 and if i differs from j at position 2, s if i 2 and j 6 2 , d if i 6 2 and j 2The parameter s is the rate of transition from a coevolving combination present in the profile to a non-coevolving combination. Conversely, d is the rate of transition from one non-coevolving to a coevolving combination (; Supplementary; Supplementary Material 1). The additional parameters r1 and r2 are the rates of transitions between two non-coevolving combinations at positions 1 and 2, respectively (Supplementary; Supplementary Material 1). For simplicity, we considered in the following a JukesCantor (JC) model of substitutions (), where position 1 evolves under a single rate r1 and position 2 evolves under another rate r2. This can easily be modified to use any existing substitution models. The rate parameters of the Coev model represent continuous variables potentially taking any positive value i:e: s, d, r1, r2 2 0, 1:
Maximum likelihood estimationIn a Maximum Likelihood (ML) framework, we want to estimate the probability of a pair of positions X, which represents one combination of characters for each species in S, ProbXj, s, d, r1, r2, ,   3 coevolving under the model Coev along a phylogenetic tree with topology and branch lengths. For simplicity, we assume that these and parameters are known and are not estimated during the ML optimization. We use Felsenstein's pruning algorithm () to evaluate the likelihood of the model. This is done by calculating, for each branch of a phylogenetic tree, the transition probability matrix Pt  e Qt , where the branch length t is a finite time interval. The amount of data in X is not sufficient to estimate the frequencies at equilibrium and the model assumes that the frequencies of all combinations are equal (). The parameter is a discrete parameter and an exhaustive search through the 192 possible profiles of P is performed to find the profile that best fit the data X. For each profile , the continuous parameters are estimated by numerical integration to obtain the values that maximized the probability of X () using the NelderMead algorithm (). The Coev model can be tested against an 'independent' model that assumes that the two positions are evolving independently from each other. The fit of the Coev model with respect to the 'independent' model was estimated using  Akaike information criterion AIC  AIC independent  AIC Coev : This procedure can be used to assess whether a pair of positions X is coevolving by directly indicating if the Coev model better fits the data than the 'independent' one. For example, the pairs 1, 2 and 3 inwere coevolving with the profile {AC,TT} (Supplementary Table S7; Supplementary Material 1). In contrast, the Comb set of pair 4 was composed of two conflicting combinations AC and AT and P  ;, which means that the positions forming pair 4 are not coevolving. The examples illustrated by pairs 1, 2 and 3 () also showed that the AIC scores for Coev are providing similar results than the non-parametric scores of coevolution (here S comp ;;) and that the AIC decreases under weaker coevolution (Supplementary; Supplementary Material 1). To delimit with confidence the list of coevolving pairs for a given dataset, a distribution of expected AIC was obtained for each dataset by simulating alignments based on the same phylogenetic tree as the original data but evolving the nucleotides under the 'independent' model. The 95th percentile of this expected AIC distribution provided a threshold to consider the observed AIC for Coev to be large enough to be accepted as evidence for coevolution (see Supplementary Material 1 for more details).
Bayesian implementationAs is commonly done in other evolutionary models, we first tested all combination of pairs X in an alignment S for coevolution using the ML implementation and then used the Bayesian approach to fully estimate the uncertainty in the parameter estimates of the Coev model for pairs that did coevolve based on the AIC described above (e.g.). The Bayesian framework used a Markov Chain Monte Carlo algorithm (MCMC) to sample the rate parameters s, d, r1, r2 and estimated the profile from their posterior distribution. We updated the rate parameters by applying a uniform sliding window on the log scale of the parameters (), while we randomly drew the profileafter the burnin phase), sampling parameters every 1000 generations. We assessed the efficiency of the chain mixing by measuring the effective sample size of the different parameters and by examining the MCMC log files in Tracer (). The sampling frequencies of each profile were calculated from the MCMC samples and used as approximations for the respective posterior probabilities. The rate parameters were summarized as mean values and 95% credibility intervals, calculated as highest posterior densities.
Empirical simulated and illustrative datasetsWe analyzed (i) two datasets to compare model predictions on real biological sequences (empirical datasets), (ii) datasets of three different sizes with each 180 simulated positions (simulated datasets) to evaluate the models performance and (iii) two additional datasets to study the intrinsic properties of Coev model (illustrative datasets). The first empirical dataset was a DNA alignment of the large subunit of the ribulose-bisphosphate carboxylase gene (rbcL). The dataset contained 422 species of Poaceae obtained from GPWG2 (2012). We used a larger but taxonomically more focused set of sequences thanwho looked for co-evolving positions in 142 rbcL angiosperms, gymnosperms, ferns and mosses sequences. The second dataset was obtained from Yeang et al. (2007) and included 146 sequences of 16S RNA spanning several kingdoms of life (animals, plants, fungi, archea and bacteria). The 16S ribosomal RNA sequence is well known for its coevolving pair 245, 283 constituted of 68 CC combinations and 65 UU combinations across different lineages (). For both empirical datasets, we filtered the alignment to remove highly conserved positions (i.e. 490% conservation) as well as all positions with at least one insertion or deletion. We estimated the presence of coevolution on all pairs of positions of the filtered alignments of the two empirical datasets using the ML implementation of Coev. The coevolving positions identified by ML were subsequently analyzed with the Bayesian implementation to evaluate the posterior probabilities of the coevolving profiles. For comparison, we also ran two non-parametric methods (score of comparison, S comp ;) and Mutual Information (MI;) and two parametric models: CO () and CoMap. To further evaluate the performances of our new model, we simulated three datasets of variable size (33, 67 and 110 species). Tree topologies were randomly created and the branches of the phylogenetic trees were randomly drawn form an exponential distribution with  0:5: The coevolving positions were created by simulating convergent codons in different lineages differing by a single nucleotide (e.g. Methionine ATG to Lysine AAG) in the coevolving lineages following the approach used by. The second position of each codon was then kept. This has the advantage to use a model of evolution (here codon model of substitution) that is different from Coev, while creating a pattern of nucleotides that mimics coevolution. It will thus not favor our model over any alternative approaches to measure coevolution. For each dataset, we simulated 20 coevolving positions and concatenated these positions with 160 independently evolving positions that were simulated without forcing coevolution. Each of these datasets resulted in the simulation of 190 pairs of coevolving positions 20  20  20=2 and 15 920 non-coevolving pairs and allowed us to evaluate each method using standard performance measures. Specifically, we estimated the number of positions correctly predicted as coevolving (true positives, TP), the number of residues correctly predicted as non-coevolving (true negatives, TN), the number of non-coevolving positions predicted as coevolving (false positives, FP) and the number of coevolving residues predicted as non-coevolving (false negatives, FN). From these measures, we calculated the sensitivity TP/(TP  FN), specificity TN/(TN  FP), accuracy (TP  TN)/(TP  FN  TN  FP) and positive predictive value TP/ (TP  FP) for each method tested. We compared the performance of Coev to CoMap, S comp and CO methods. Coev performance was evaluated by considering pairs with AIC values higher than the 95th percentile value of the AIC distribution issued from independently evolving positions. The performance of CoMap was evaluated by considering coevolving pairs with a stat score 40.75 and a P-value 50.05, while the performance of S comp was evaluated by considering pairs with either a score equal to 1 (SComp I) or the 1% top scores (SComp II) as coevolving. For the CO parametric model, we considered pairs with a likelihood ratio 46 log units as coevolving Yeang et al. (2007). In the Supplementary Material 1, we also described two illustrative datasets (S1 and S2) specifically designed to highlight the intrinsic properties of the model. Those datasets were designed to explore the properties of the Coev model and in particular to assess the effect of conflicting combinations on the model. The dataset S1 was composed of five pairs of positions. The first pair, P1(S1), had a Comb P1S1 size equal to two Comb P1S1  fAA, TTg: The number of occurrences of each combination is reported in Supplementary Table S3 (Supplementary Material 1). The four other pairs were created by adding each time one new conflictual combination to the previous pair. The dataset S2 was built with the same rationale but starting with a pair of positions with a complex profile of coevolution Comb P1S2  fAA, CC, GG, TTg:
RESULTS
Ribulose-bisphosphate carboxylase geneWe ran our ML implementation on the 74 filtered positions of rbcL and found, out of the 2701 possible pairs tested, that Coev was preferred over the 'independent' model for a total of 103 pairs of positions. The three coevolving nucleotide pairs (positions 401, 950 and 1058 in the alignment) that obtained the best AIC belong to codon 133 of the N-terminal domain, and codons 326 and 362 of the C-terminal domain. These positions are not in close proximity in the DNA sequence. However, they form a triplet that is in direct contact in the 3D crystallized structure of Oryza sativa RuBisCO protein (pdb 1WDD; Supplementary; Supplementary Material 1). The three amino acids are linked to the binding site of the CAP A 1001 substrate, suggesting their involvement in the allosteric movements of the RuBisCO (). The AIC ranged from 6.65 to 171.53 log units. The nucleotide pair 9501058 had the highest AIC value for the coevolving profile {AA, GG} (Supplementary; Supplementary Material 1). The Bayesian analysis over this pair of positions confirmed that {AA, GG} is the profile with the highest posterior probability (100%). The highest MI score obtained over the 2701 possible pairs of the rbcL gene was 0.9 (). The MI score could, in theory, vary between 0 and 2 and scores below 0.9 indicates that none of the pairs are coevolving (Supplementary Material 2). High MI score are obtained when the frequencies of the nonconflicting combinations are homogeneous, which is not the case for the 103 pairs of the rbcL gene identified by our Coev model. For instance, the AA combination frequency for the pair 9501058 was 363 out of 422, which lead to a MI score of 0. Further, none of the 103 pairs had a S comp score 40.86 and the S comp score associated with the pair 9501058 was intermediate (0.54 and 0.51). This is certainly due to the fact that the pair was partially composed of conflicting combinations (Comb  {AA, AG, GA, GG}). The pair 656818 had the highest S comp value (0.86) and the AIC of the Coev model was not the highest (35.98). When we looked closely at the combinations associated with this pair, we observed that the AC combination had the highest frequency (70% or 297 species out of 422) and the combination with the second highest frequency was TC (17%).originally reported that about half of the sites of the rbcL gene are co-evolving whereas the new analysis (using the 422 sequences filtered dataset) showed that $40% (30 out of 74) of the sites are coevolving when using CoMap. This difference is likely due to the dependency of CoMap to the number of species (). Finally, the CO model predicted 15 pairs of coevolving positions. The three coevolving pairs with the highest AIC were not identified by CO. However, the pairs 61407 identified by CO with the highest score (19 log units) was predicted by Coev among the 103 list of pair of positions preferred over the 'independent' model. This pair was mainly composed of two conflicting combinations CT and CG and its estimated profile was {CT, TA}.
16S ribosomal RNAThe 16S ribosomal RNA empirical dataset was first used to analyze the well-known coevolving pair of positions 245283, which have been found as coevolving under the WatsonCrick profile {CC,UU} by both structural and experimental analyses (). ML analyses showed that the Coev model for this pair had a AIC  53:71 (Supplementary; Supplementary Material 1), which confirmed that {CC,UU} was the best profile of coevolution for this pair. Over all the 23 005 possible pairs that can be tested with the 16S ribosomal RNA dataset, we found, however, that the best coevolving pair was not the positions 245283, but rather the positions 19502017 (AIC of 164.72). Using the 95th percentile of the expected AIC distribution as the threshold of coevolution (AIC  1:77; see Supplementary Material 1), 1008 pairs were selected as coevolving. Among those, the top 3% of the pairs with the highest AIC displayed profiles of different complexity: 12 pairs had a profile of size 2, 12 pairs had a profile of size 3, five pairs had a profile of size 4. Among those 29 pairs, 25 showed a typical WatsonCrick profile. However, the pair with the highest AIC had a complex WatsonCrick profile {AT, CG, GC, TA} with repeated occurrences of each combination across lineages of the phylogenetic tree (Supplementary. Nevertheless, no correlation was observed between the AIC values and S comp or MI scores (Pearson correlation  0.19 and 0.1, respectively). We looked more closely at the pair 19482020, whose proportion of conflict was 0 and S comp score was maximal, but whose AIC for Coev was not the highest (52.05 log units). Its AIC was not the highest, it was still larger than the threshold of coevolution defined for this empirical dataset and its estimated profile was {CG, GC, TA}. The GC combination occurred in all bacterial, archae and protist lineages, as well as the two eukaryote organelles. In contrast, all multicellular eukaryotes had the TA combination, except two fungi (Fellomyces ogasawarenisis and Bullera huiaensis) and one animal (Strongylocentrotus intermedius), which retained the ancestral CG combination (Supplementary; Supplementary Material 1). The double substitution between TA and CG was thus specific to the multicellular eukaryotic lineages and, although it is not possible to date precisely the acquisition of the TA combination, it suggests a local coevolution within the phylogenetic tree in the early evolution of the multicellular eukaryotes. The Coev model is thus sensitive to local coevolution patterns and, in contrast to other methods, can distinguish between global and local coevolving positions. We further validated our predictions by localizing the coevolving positions on the 2D and 3D structure available for the 16S subunit (pdb 2AVY) of Escherichia coli. We found that 24 of the 29 pairs identified by our model were connected in the 2D structure (Supplementary(left); Supplementary Material 1) and 26 of the 29 pairs were connected in the 3D structure (Supplementary(right); Supplementary Material 1). In contrast, only five and six of the 15 pairs of positions predicted by S comp demonstrate direct contact of the nucleic acid pairs in the 2D and 3D structure, respectively. For CO,reported that 15 of the 41 predicted pairs are in direct contact in the 3D structure.
Simulated and illustrative datasetsThe Coev model outperformed other parametric and nonparametric methods for the three simulated datasets of size 110, 67 and 33 sequences (; Supplementary; Supplementary Material 1). In particular, the sensitivity was found to be consistently higher in the simulations suggesting that the Coev model can reliably detect true coevolving positions (i.e. all of the 190 co-evolving pairs simulated for each of datasets). The sensitivity of Coev did not appear to be affected by the size of the tree whereas a substantial decrease was observed in S comp and CoMap (9-and 4-fold, respectively) with increasing tree size (; Supplementary Table S9; Supplementary Material 1). Noticeably, the CO model failed to recover the true co-evolving positions in all datasets (TP  0). These observations were previously shown by Dib and Carbone (2012). Moreover, two illustrative datasets (S1 and S2) were used to describe intrinsic properties of the Coev model (Supplementary Material 1). The analysis of S1 and S2 showed a strong negative correlation of 0.994 between the proportion of conflicts and the AIC values. Furthermore, the simulations revealed that the s/d ratio can be seen as a measure of the coevolution strength (Supplementary; Supplementary Material 1) since s/d ratio decreased as the signal of coevolution became stronger. In the perfectly coevolving case, s/d tended towards zero (Supplementary; Supplementary Material 1), whereas this ratio increased until the two parameters became equal when the pairs of positions evolved independently. Further, the r1, r2 parameters do not incorporate information about coevolution since their values can fluctuate from zero to infinity without any correlation with the AIC of Coev (Supplementary; Supplementary Material 1). We also designed an experiment (Supplementary Material 1) to show that, contrary to the S comp score, Coev can distinguish between coevolving and co-inherited pairs of positions (Supplementary; Supplementary Material 1). A coinherited pair is defined as a combination acquired only once during the evolution and further inherited by all the descendants. Our results showed that the AIC difference increased with the number of occurrences of the combination in the phylogenetic tree (Supplementary; Supplementary Material 1).
DISCUSSIONWe presented a new dependent model of evolution, Coev, based on the broad class of Markov models. Coev can reliably identify the coevolving pairs of nucleotide positions and their molecular footprint, expressed by the profile of coevolution. The Coev model incorporates free parameters that are easily interpreted from an evolutionary perspective and that govern the change of one combination into another within pairs of coevolving positions. Our model is mechanistic and describes the process of evolution that is responsible for the simultaneous evolution of dependent sites along DNA or amino acid sequences. The profile of coevolution is explicitly incorporated in the model as a discrete parameter and thus can be estimated from the data. It is an essential parameter in our model since it shapes the instantaneous rate matrix at the base of Coev (Supplementary; Supplementary Material 1) and defines the number of occurrences of the rate parameters s, d, r1 and r2 (Supplementary; Supplementary Material 1). The parameter s is the rate of transition from a coevolving combination to a noncoevolving one. This parameter thus represents the rate of a necessary step (yielding conflict) that precedes the shift to a new coevolving combination. A new substitution is then required to re-establish the coevolving profile, and this event is modeled by the parameter d. This parameter d therefore represents the rate of transition from a non-coevolving combination to a coevolving one. Parameters s and d describe the two temporally successive substitutions that are the minimum requirement to shift from one coevolving combination to another in the profile. The additional parameters r1 and r2 represent the rates of independent substitution between non-coevolving combinations.. Performance: sensitivity and specificity plots. Sensitivity and specificity plots comparing the performance of the Coev model to CoMap, S comp and CO. For each dataset (110, 67 and 33 tips), we simulated an alignment of 180 positions (20 coevolving positions and 160 independently evolving). SComp I is the performance of S comp method when only maximal scores of 1 are considered, whereas SComp II considered the 1% top scores. CoMap's performance where evaluated when considering coevolving pairs with a stat score 40.75 and a P-value 50.05. While the specificity does not strikingly change across datasets and methods, the sensitivity is higher for the Coev when compared to the other methods Conflictual substitutions in each site are modeled by a single independent rate regardless of the type of substitution, e.g. transition/transversion, thus resembling a JC model. The model can however be extended to incorporate more complex nucleotide substitution models such as the GTR ().
Coev profile and influence of the phylogenetic treeOur approach can provide a better understanding of the evolutionary forces shaping pairs of coevolving positions by estimating the profile that best fits the coevolving pair using a probabilistic model of dependent nucleotide evolution. We implemented our model in a Bayesian framework that further provides the posterior probability associated with each profile for a given pair of coevolving positions. The data-driven estimation of the profile of coevolution is novel and expands the potential of coevolution analyses by allowing us to identify patterns of coevolution without restricting itself to known profiles, such as WatsonCrick constraint for RNA sequences. Based on illustrative and empirical datasets, we found that the best fitting profile is not necessarily the most frequently observed one, especially in the presence of conflicts (e.g. P5S1 in Supplementary Table S8; Supplementary Material 1). Further, the selection of the profile that best describes the coevolution at two positions depends on the associated phylogenetic tree. Using the Coev model, we showed that the coevolving profiles in ribosomal RNA are not necessarily WatsonCrick profiles but can rather involve complex patterns with, for example, three or four combinations. Additionally, the {CC, UU} profile prediction for the pair 245, 283 in the 16S ribosomal RNA sequence identified by other methods (), was estimated by Coev without assuming any a priori weighting based on physico-chemical properties of the nucleotides. This is certainly a strength of our approach as it allows the estimation of coevolution due to other less known constraints or to extend these analyses to protein coding genes that are not affected by WatsonCrick constraint.
Coev model compared to other modelsSome of the most widely used methods to estimate coevolution, such as MI (), SCA (Lockless andallow the characterization of the evolutionary process that has lead to the binary coevolving pattern. The Coev model is conceptually different from the approaches that develop dependent models of evolution. Our model can describe the process of evolution of a coevolving pair, estimate the associated profile, reconstruct the ancestral states of dependent positions and provide the probability vector for several ancestors (see Supplementary; Supplementary Material 1). We have shown as well that the phylogenetic tree is an essential aspect of the coevolution process and that the estimation of the profile, but also the prediction of coevolving positions, can be affected by the underlying phylogenetic tree.
Global versus lineage specific coevolutionThe Coev model assumes that a pair of positions coevolve under the same evolutionary process along the whole phylogenetic tree. It is however likely that during the acquisition of a new function, a gene will be under different selective constraints in different lineages. This will create branch-specific coevolving positions in the phylogenetic tree that none of current methods are able to account for. For example, the evolution of genotypic convergence has been documented recently () and it illustrates that different processes can take place in specific lineages. For example, different codons are used in the different lineages to create the convergent functional protein in the C4 grasses. Thus, it will be important in future development to define an evolutionary framework able to detect these lineage-specific constraints, especially as gene-tree estimation can be biased due to constraints or selective pressures (). Additionally, the Coev model can help to distinguish coevolving from co-inherited pairs of positions, which are defined as combinations acquired once in the evolution of a lineage and inherited by all its descendants. The pair of positions 19482020 of the 16S ribosomal RNA family is an example of a co-inherited position acquired at the origin of the multicellular organisms and further lost only in few species. None of the available methods consider the number of times a combination is acquired along the tree when assessing a score of coevolution (), whereas in the Coev model we observed higher AIC for pairs whose combinations have been acquired multiple times in different lineages. This is the case even though our model does not explicitly count the number of acquisitions (Supplementary Material 1). However, establishing whether the pair 19482020 is coevolving or co-inherited is still an open question. One difficulty comes from the current definition for co-inheritance, which is simplistic and assumes that a coevolving pair is necessarily coevolving under a simple profile (i.e. of size 2;). However, the pair 19482020 coevolved under a complex profile that presents both co-inherited and coevolving combinations. The substitutions of GC to TA combination were co-inherited by the ancestor of the multicellular organisms. However, the CG combination was later acquired again several times and can be considered as coevolution (Supplementary; Supplementary Material 1). This example clearly shows the difficulty to assess if two positions are coevolving or co-inherited and the definition of co-inheritance given byshould be revisited in order to take into account complex profiles. Lineage-specific constraint and co-inherited pairs affected our model since their associated AIC was weaker than coevolving pairs with combinations acquired several times in the phylogenetic tree. One possible move forward to assess locally coevolving pairs would be to extend the Coev model and allow the rate parameters and coevolving profiles to vary across the branches of a phylogenetic tree. There is also the need to better assess the links existing between coevolution and the well-known selective pressures affecting molecular sequences. This is an important area to develop and it can help understand better protein signatures that are used to identify the function and the role of newly sequenced proteins. For instance, one could look for Hoogsteen pair of positions that interact in the tertiary structures of RNA sequences but that do not necessarily evolve simultaneously and present conflict in the observed data.
CONCLUSIONWe presented a new, fully mechanistic, model that describes the processes governing the coevolution of a pair of positions.Conserved sites have been extracted from gene families for more than 40 years (), but we propose that the evolutionary profile of coevolving sites should be added to these known signatures. This will help the community to classify highly divergent sequences and better interpret the function of new ones.
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
L.Dib et al. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
Evolutionary footprint of coevolving positions in genes at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
Ranganathan, 1999) and ELSC (Yip et al., 2008), do not incorporate the evolutionary history of the gene under consideration and any random assignment of sequences along the underlying tree produces the same score of coevolution. Other methods do use the topology of the phylogenetic tree to estimate local scores of coevolution for each node before merging them hierarchically to obtain a single score for the whole tree (Dib and Carbone, 2012). We compared the performance of Coev to available methods and showed that it outperforms existing approaches especially when the number of sequences in the alignment increases (Fig. 2). Moreover, available parametric and non-parametric methods do not attempt to capture the long-term evolutionary process shaping DNA sequences, but rather focus on the product of this process only. This misses important information, such as selective pressure and evolutionary constraints, which are key elements to explain how and why a pair of positions can coevolve. Few attempts have been made to model coevolution directly, but they all differ in several aspects from our Coev model. First, the model used in the CoMap method was an attempt to capture the process of coevolution in DNA sequences (Dutheil and Galtier, 2007). It used a Bayesian approach to map the substitutions that occurred at each site independently onto the branches of the underlying phylogenetic tree. Mutations occurring at two sites are thus not correlated, which violates the specific assumption of coevolution (Bollback, 2005; Huelsenbeck et al., 2003). This could explain the lower sensitivity observed in our simulations for CoMap and highlight the necessity to model the precise process of coevolution to be able to correctly predict correlated pairs of positions. Several studies used CoMap to analyse the co-evolving positions within and among genes (Corbi et al., 2012; Wang et al., 2011). For instance, Wang et al. (2011) post-processed CoMap predictions to learn about the combinations properties found in the co-evolving amino-acid positions of the rbcL dataset. They looked for the most frequent combination in the co-evolving positions and described the bio-chemical properties of the amino acids composing the coevolving positions. However, we showed using Coev that the most frequent combination is not necessarily part of the coevolutionary profile and Coev is now able to estimate the profile of co-evolution along a phylogentic tree. This profile provides the biochemical properties and evolutionary constraint associated with a pair of positions. Second, a Markov model that, like Coev model, used an instantaneous rate matrix to model the coevolution of pairs of positions has also been proposed (Yeang et al., 2007, CO model). We compared the CO model with Coev on the rbcL empirical data and showed that CO was not able to capture the same coevolving pairs of positions and more specifically the pair 9501058 where AA and GG combinations appear in several lineages along the tree. The CO model accounts for non-independent evolution of the pair of positions by specifying rate parameters for double substitutions and down-weighting the single substitution rates. This has the effect of penalizing single changes, but the model still allows simultaneous substitutions within a small unit of time. The latter assumption is in contradiction with a coevolution process, where a substitution should trigger the change at another position (Pagel, 1994). This contradiction could explain the lack of sensitivity of CO in our simulations, which confirmed previous studies (Dib and Carbone, 2012). Further, the different assumptions made by the CO and Coev models, might explain the discrepancies in the prediction of coevolving sites for the rbcL dataset. Finally, the dependent model proposed by Pagel (1994) for phenotypic data was modified and adapted for protein data (Pollock et al., 1999), but this has not been extended to the full alphabet of the sequences at hand. Instead, a categorization of the physico-chemical properties of the amino acid was used to create an alphabet of size 2 (e.g. positively and negatively charged residues; large and small residues), and the dependent model of Pagel (1994) was applied directly. The reduction of the original amino acid alphabet into two categories has the advantage of assessing potential important characteristics of the protein, but multiple categorization will be necessary to test which physico-chemical property is the most pertinent for the coevolution. It is also possible that different lineages could present coevolution between different physico-chemical properties for the same pair of positions depending on the DNA-sequence analyses. In addition, the dismissal of the original alphabet will not
