Motivation: The ability to accurately measure structural similarities among small molecules is important for many analysis routines in drug discovery and chemical genomics. Algorithms used for this purpose include fragment-based fingerprint and graph-based maximum common substructure (MCS) methods. MCS approaches provide one of the most accurate similarity measures. However, their rigid matching policies limit them to the identification of perfect MCSs. To eliminate this restriction, we introduce a new mismatch tolerant search method for identifying flexible MCSs (FMCSs) containing a user-defin-able number of atom and/or bond mismatches. Results: The fmcsR package provides an R interface, with the time-consuming steps of the FMCS algorithm implemented in Cþþ. It includes utilities for pairwise compound comparisons, structure similarity searching, clustering and visualization of MCSs. In comparison with an existing MCS tool, fmcsR shows better time performance over a wide range of compound sizes. When mismatching of atoms or bonds is turned on, the compute times increase as expected, and the resulting FMCSs are often substantially larger than their strict MCS counterparts. Based on extensive virtual screening (VS) tests, the flexible matching feature enhances the enrichment of active structures at the top of MCS-based similarity search results. With respect to overall and early enrichment performance, FMCS outperforms most of the seven other VS methods considered in these tests. Availability: fmcsR is freely available for all common operating systems from the Bioconductor site
INTRODUCTIONThe development of computational methods for detecting and quantifying structural similarities among small molecules is an area of intensive research in drug discovery and chemical genomics. The effort is largely driven by the observation that many structurally related compounds share similar bioactivity and physicochemical properties (). Maximum common substructure (MCS) approaches are commonly used to identify the largest substructure (subgraph) shared among two compounds (). MCS is a pairwise graph matching concept that differs fundamentally from the structural descriptor-based methods, but its results (e.g. size of MCS relative to source structures) can be used for the computation of related similarity coefficients. Compared with descriptor-based similarity methods, MCS approaches generate chemically more meaningful search results by pinpointing the common features within the structure of two compounds. They also provide the most efficient method for identifying local structural similarities and similarities among compounds with large size differences (). With the exception of bond mismatches, existing MCS search algorithms can only identify MCSs that are perfect substructure matches in two compounds of interest. Extending this strict matching scheme to one that tolerates mismatches among atoms and/or bonds facilitates the identification of larger flexible MCSs (FMCSs) than their strict MCS counterparts, resulting in a more complete description of the similarities among two compounds. Here we introduce such a FMCS algorithm that allows both mismatches of atoms and/or bonds in the identified MCSs. When the flexible matching feature is enabled, the user can identify more complex and subtle similarity patterns among two structures than is possible with strict MCS algorithms (). For instance, two molecules may share a larger imperfect MCS that is disrupted by a substitution of a small number of atoms. Strict MCS algorithms will identify in these cases only the largest invariant subcomponent(s), while the FMCS algorithm will often find a much larger, but partially imperfect MCS (). This has various advantages for practical applications in small molecule discovery, such as the prediction of bioactive compounds, scaffold identification in screening libraries or assignment of metabolic compounds to enzymatic steps in pathways.
METHODS
BackgroundTo meet the above requirements, we designed the FMCS algorithm as an extension of our previously published backtracking VF algorithm for MCS detection () where we enabled flexible matching by introducing counters for bond and atom mismatch tracking, and further optimized its time performance. A detailed outline of the algorithm is provided in the Supplementary Materials Section S1. To achieve both optimal performance and usability of the method for data mining applications, the time-consuming computational steps of fmcsR are implemented in C, and its R interface integrates the small molecule analysis utilities and S4 object classes provided by the ChemmineR library (). *To whom correspondence should be addressed.
Main functionalities of fmcsRThe FMCS algorithm can be called in R from the fmcs function, which computes either the MCS or FMCS shared among two compounds and returns the result as an object of class S4 containing one or many alternative solutions. The speed-optimized fmcsBatch function provides MCS/ FMCS-based search functionalities of small molecule databases. The number of allowable atom/bond mismatches and ring matching policies are user-definable parameters. A plotting function is available to visualize MCS/FMCS results by color highlighting the corresponding bonds in their source structures. A detailed user manual is included in the fmcsR package.and C compare the performance of fmcsR with the MCS algorithm implemented in the SMSD toolkit (). With perfect matching (FMCS00 in), the FMCS algorithm returns MCSs with similar size distributions as SMSD, but with shorter compute times (). Slight differences in the MCS size distributions among the two methods are as expected owing to (i) differences in their perception and matching behavior of rings and aromatic bonds, (ii) different heuristics used for improving time performance and (iii) different MCS concepts considered by the two methods (for details see Supplementary Materials S1;). For extremely large compounds, above 60 non-hydrogen atoms, SMSD switches to a faster approximation approach where it exhibits a better time performance than FMCS in its perfect matching mode. When allowing 1, 2 or 3 mismatches of bonds and atoms, the size distributions of the FMCS results increase on average by 2050% compared with the strict MCS results. On average these size increases substantially exceed the number of allowed mismatches because a mismatch will often allow the algorithm to identify many additional matching bonds and atoms resulting in an FMCS of a much larger size than the corresponding MCS. For instance, the MCS shared among diethyl ether and diethyl sulfide contains only two non-hydrogen atoms, but their FMCS with one atom mismatch contains five non-hydrogen atoms (). With relaxed mismatch parameters, the complexity of the FMCS computation increases, resulting in longer processing times. Nevertheless, for 12 atom and bond mismatches the compute times are still acceptable across the six compound size bins considered in. In virtual screening (VS) benchmark tests, the FMCS method shows consistently better performance than strict MCS matching (and E), indicating that the mismatch tolerant MCS similarity concept improves the early and late enrichment performance of MCS-based search methods in VS experiments (). The strong overall performance of FMCS, compared with a diverse set of seven 2D and 3D structure similarity search algorithms (), demonstrates its usefulness for this application field. The details for these extensive VS performance tests are provided in the Supplementary Materials S2.
RESULTS
CONCLUSIONSThe fmcsR package introduces a versatile algorithm for identifying both MCSs and FMCSs. Its mismatch tolerant matchingThe plot compares the size distributions of MCS/FMCS results. Test compound pairs were randomly selected from DrugBank considering 1000 pairs within each of six size categories (x-axis) ranging from 5 to 60 non-hydrogen atoms. Each member of a compound pair had to fall into the same size category. The size distributions of the MCS/FMCS matches (y-axis) computed for these pairs are represented as box plots. The SMSD results are given in white and the FMCS results with three different mismatch settings are given in gray allowing zero (FMCS00), one (FMCS11), two (FMCS22) or three (FMCS33) bond and atom mismatches. (C) The corresponding compute time distributions of the four methods are plotted for the same dataset used in the previous plot.The VS performance of FMCS with three different mismatch settings is compared with seven other methods (atom pairs, AP; atom pair fingerprints, APFP; PubChem fingerprints, PCFP; MACCS keys; the graph fragment-based method AFGen, the 3D methods SHAFTS and OAK). Averaged awAUC (arithmetically weighted area under the receiver-operating characteristic curve) values are plotted and the methods have been sorted along the x-axis by their performance. As test dataset, a subset of 13 compound sets from the Directory of Useful Decoys was used that is optimized for benchmarking VS experiments. More details and source data are provided in the Supplementary Materials S2 and Supplementary. (E) The plot compares the early enrichment performance of the same methods and test datasets used in the previous plot. The results are plotted as awROCE (arithmetically weighted receiver-operating characteristic enrichment) values obtained at false-positive rates of 0.5, 1.0, 2 and 5% (for details see Supplementary Materials S2 and Supplementary) mode provides a more complete description of subtle similarity patterns shared among compounds than this is possible with strict MCS detection methods.
The Author 2013. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
fmcsR at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
Y.Wang et al. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
