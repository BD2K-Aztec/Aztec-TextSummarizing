Motivation: DNA methylation is a molecular modification of DNA that plays crucial roles in regulation of gene expression. Particularly, CpG rich regions are frequently hypermethylated in cancer tissues, but not methylated in normal tissues. However, there are not many methodological literatures of case-control association studies for high-dimensional DNA methylation data, compared with those of microarray gene expression. One key feature of DNA methylation data is a grouped structure among CpG sites from a gene that are possibly highly correlated. In this article, we proposed a penalized logistic regression model for correlated DNA methylation CpG sites within genes from high-dimensional array data. Our regularization procedure is based on a combination of the l 1 penalty and squared l 2 penalty on degree-scaled differences of coefficients of CpG sites within one gene, so it induces both sparsity and smoothness with respect to the correlated regression coefficients. We combined the penalized procedure with a stability selection procedure such that a selection probability of each regression coefficient was provided which helps us make a stable and confident selection of methylation CpG sites that are possibly truly associated with the outcome. Results: Using simulation studies we demonstrated that the proposed procedure outperforms existing mainstream regularization methods such as lasso and elastic-net when data is correlated within a group. We also applied our method to identify important CpG sites and corresponding genes for ovarian cancer from over 20 000 CpGs generated from Illumina Infinium HumanMethylation27K Beadchip. Some genes identified are potentially associated with cancers.
INTRODUCTIONDNA methylation, which is the addition of a methyl group to the 5 position of cytosine in the context of a CpG dinucleotide, is a molecular modification of DNA that plays crucial roles in regulation of gene expression. Particularly, CpG rich regions are frequently hypermethylated in cancer tissues, but not methylated in normal tissues. Tremendous amounts of DNA methylation data have recently been generated from high-throughput DNA methylation platforms. For example, the Illumina GoldenGate array, the Illumina Infinium HumanMethylation27K array and the most recent Illumina * To whom correspondence should be addressed. Infinium HumanMethylation450K array are popularly used. These platforms are based on genotying bisulfite converted DNA. The results of the array, the methylation status of the interrogated CpG site are a sequence of -values, one for each locus, calculated as the average of approximately 30 replicates of the quantity (),where U is the fluorescent signal from an unmethylated allele on a single bead, and M is that from a methylated allele. A maximum between signal intensity and 0 is chosen to compensate for negative signals due to background subtraction. The constant 100 is to regularize -values where both M and U values are small. This -value ranges continuously from 0 (unmethylated) to 1 (completely methylated) and reflects the methylation level of each CpG site. Many researchers have applied statistical classification methods to select differently methylated loci (). Statistical approaches developed for gene expression data may not be applied directly to methylation data since many genes are methylated, while only a few genes are differently expressed. However, disease related CpG regions should still be sparse, in which case the problem is equivalent to identify a few relevant genes from high-dimensional gene expression data. Compared with the case-control studies of gene expression data, there are currently not many methodological developments for methylation data. Wang (2011) has recently proposed a likelihood-based uniformnormal mixture model to select differently methylated loci between case and control groups. One difference of methylation data from gene expression is that the former ranges between 0 and 1. But, this is not an issue in regression frameworks. Another key feature of DNA methylation data that has not been fully utilized is the group structure within a gene. With the Illumina HumanMethylation27K array, there are about 122 CpG sites per gene where methylation levels of CpG sites within a gene are usually correlated. Unlike genotype data with single nucleotide polymorphisms (SNPs), -values  (0,1) are continuous thus correlations among them can be observed more precisely. Note that although CpG sites within a gene are correlated, some CpG sites might be neutral while some CpG sites might be causal. Therefore, considering these features of DNA methylation data, in this article we proposed a penalized logistic regression model for correlated CpG sites within a gene as predictors of a disease status. The proposed method can select CpG sites individually that associated with a disease while grouping effects are encouraged. The penalized logistic regression has been recently used to select SNPs or genes associated with a disease in high-dimensionalinduce the overall sparsity and group sparsity, respectively. Consequently, predictors with stronger effects on responses are more likely to be selected into the model. However, none of the methods above are designed to encourage selection effects for highly correlated predictors. For the analysis of correlated microarray gene expression data, several variable selection methods have been developed in the past decade. The fused lasso () imposes the l 1 penalty on the absolute differences of the regression coefficients in order to account for some smoothness of the coefficients. The elastic-net (Enet) procedure (), which is a compromise between a ridge regression penalty and a lasso penalty, encourages a grouping effect of highly correlated variables. When genetic network information such as a genetic pathway is available,) proposed a graph-constrained regularization procedure. In their method, a Laplacian matrix representing a graph structure was imposed on a ridge-regression penalty of the Enet procedure such that linked genes have a smoothness penalty on their regression coefficients. The authors demonstrated that when the information of gene networks is incorporated into the regularization procedure, it can select more relevant genes than the lasso and Enet procedures. Motivated by the graph-constrained procedure by), we extended it to the logistic regression model for the analysis of case-control DNA methylation data, where our Laplacian matrix represents CpG sites clustered within genes. The rest of this article is organized as follows. In Section 2, we described our statistical model and regularization procedure for grouped and correlated predictors (CpG sites) together with the computational algorithm and the stability selection procedure. We then presented the simulation results in Section 3, where existing main-stream variable selection methods were compared with the proposed method when predictors within a group are correlated. Section 4 analyzed a real DNA methylation data in a case-control study of ovarian cancer. Finally, we gave a brief discussion of the method and future research in Section 5.
METHODS
Penalized logistic regressionLet us denote the methylation -values of the i-th individual by x i = (x i1 ,...,x ip ) T , i = 1,...,n, and p is the total number of CpG sites considered in the analysis. The penalized logistic regression is defined aswhere P( ) is a penalty function, and the response y i is 0 for controls and 1 for cases. The probability that the i-th individual is a case based on his/her DNA methylation information is denoted as p(x i ) = exp( 0 +x T i  ) 1+exp( 0 +x T i  ) .The intercept parameter  0 and regression coefficients  = ( 1 ,..., p ) T can be estimated by minimizing the objective function (1). In the work of Li and), the p-dimensional Laplacian matrix L ={l uv } was used to represent a graph structure when the network information of predictors is provided. It is defined asif u and v are linked with each other 0 otherwise,where d u is the total number of links of the u-th predictor, and it is often called a degree of the vertex u in graph theory. Their penalty function iswhere  1 is a l 1 norm, and u  v indicates the index set of all linked variables to the u-th predictor. The tuning parameters  1 and  2 control the amount of regularization for sparsity and smoothness, respectively. When  2 = 0, this penalty simply reduces to the lasso (), and if the Laplacian matrix L is replaced by an identity matrix I, the penalty becomes the Enet penalty (). Also, the estimates of ridge regression for logistic regression can be obtained when  1 = 0 and L = I. This penalty is defined as a combination of the l 1 penalty and squared l 2 penalty on degree-scaled differences of coefficients between linked predictors. It induces both sparsity and smoothness with respect to the correlated or linked structure of the regression coefficients.) have shown that a desirable grouping effect can be reached by specifying links among regression coefficients in the model. However, their approach is limited to the ordinary regression model. Here we extended it to the penalized logistic regression for the analysis of case-control methylation data. First, we need to specify a network structure that describes correlation patterns for methylation measures of CpG sites within a gene. There are two networks prevalently used in graph theory that fit our situation, namely, the ring network and the fully connected (F.con) network.depicts these network topologies in the scenario when there are 6 genes and each of which consists of 1, 2, 3, 4, 6 and 9 CpG sites. In the ring network, we assumed that the first and last CpG sites from a gene are connected with each other so that all CpG sites within the same gene have the same number of links. In contrast, a F.con network assumes that all CpG sites within the same gene are connected with each other. In the penalized regression model, both networks specify a group structure of predictors so that the coefficients of correlated predictors within the same group can shrink toward each other, allowing them to borrow information
H.Sun and S.Wangfrom each other. Unlike the group penalized method of, our model still performs individual selection, so neutral CpG sites within significant genes are not forced to remain in the final model. To compare the biological basis of the ring and the F.con networks, although it depends on the underlying true correlation patterns of CpG sites within genes, the later might be more appropriate for DNA methylation data since one CpG site might be correlated with the rest sites within the same gene. The ring network assumes correlation of just flanking sites except for the first and last sites. Note that the link between the first and the last sites in the ring network is less possible biologically but is imposed to apply the ring network. In terms of variable selection, the ring network will induce a mild groping effect on a large group since the number of links per CpG site is fixed at 2 for all genes that have >2 CpG sites. In contrast, the total number of links per CpG site in the F.con network model is increased by the number of CpG sites within a gene. So, the fully connected network usually produces a strong grouping effect since variables with more links are more likely to be selected in the network-based regularization procedure. This is also discussed by. If all CpG sites in a gene are true signals, the F.con network are desirable. But, if there are both neutral sites and causal sites in a gene, the ring network might be preferable to weaken the grouping effect. However, in simulation study and real data application we showed that the selection results using the two networks are almost identical. Also note that the Laplacian matrix in our model (2) has the form of a blockwise diagonal matrix for both network models.
Computational algorithmsLi and Li (2010) has applied the coordinate descent algorithm ofto obtain the minimizer of the function (1) when a response variable follows a Gaussian distribution. But this cannot be directly applied to the logistic regression. Moreover, recent publication ofhas drastically improved the computational efficiency, and a R package glmnet was developed for the Enet regularization procedure of the logistic regression. Since the Enet method simply replaces the Laplacian matrix by an identity matrix in the penalty function (2), we could impose the Laplacian matrix in the glmnet code and be benefited from the efficient computation algorithm already implemented. In this section, we briefly explained how the Enet procedure and our method differ in terms of algorithm. Let us denote the negative log likelihood function of the logistic regression model by l( 0 ,), which is equivalent to the first term of the function (1). Our objective function is thenAs l( 0 ,) is approximated by a second-order Taylor series expansion at current estimates ( * 0 , * ), the function (3) can be re-written asWe refer the readers tofor the details of this derivation. Next, we can compute the gradient at  u =  * u while the other estimates  * v for all v = u are fixed. By setting the gradient to 0 and solve for  u , we can get the current estimate of  * u using the following formula,i )+(1)g(u),,and S(z, ) is a soft thresholding operator with value if z > 0 and  <|z| z + if z < 0 and  <|z| 0 otherwise. If the u-th predictor is a unique member of a group, i.e. no links to any other predictors, the function g(u) in (5) is equal to 0. If all predictors are isolated, the penalty function (4) is reduced toand thus g(u) = 0 for all u = 1,...,p. In this case the solution becomes exactly the same as that of the Enet procedure. In other words, we only need to include the term (1)g(u) in the formula of the Enet when we create a group of CpG sites by genes.
Selection probabilitiesIn our penalty function (4) we have two tuning parameters to be selected. The parameter   (0,1) induces the model to have the estimates between ridge ( = 0) and lasso ( = 1). As  increases from 0 to 1, the sparsity solution to (3) is obtained for each , but the model near  = 1 becomes indifferent to correlated predictors. The Enet procedure usually uses a small value of  to overcome collinearity problems in regressions with high-dimensional predictors. However, results of variable selection are very similar with a small perturbation of . In contrast, the tuning parameter  forces the model to select more variables as  decreases with a fixed . Since the value of  directly determines the total number of relevant predictors, the choice of  is crucial in variable selection problems. Cross-validation (CV) is commonly used to find the optimal value of  in variable selection literatures, although it is known that for high-dimensional data CV generally selects too many variables including some truly unrelated variables.in their recent work proposed to compute selection probabilities for all variables, and to include only the variables with high selection probabilities in the model. Their method is based on resampling, and provides a more stable selection for highdimensional data compared with CV. Recently, Alexander and Lange (2011) have applied it to select relevant SNPs in GWAS. We employed their method to determine important CpG sites in our regularization procedure. Let us denote as a regularization parameter space, e.g.  . Let I k be the k-th random subsample of {1,...,n} of size n/2 without replacement, where x is the largest integer not greater than x. The selection probability of the u-th predictor is then defined as) is the estimator of  u using a regularization procedure based on the subsample I k given , and K is the total number of resampling. Then, the variables whose selection probabilities are greater than some cutoff value, say  , are selected in the model. According to, selection results do not rely much on the choice of , and tend to be very similar with different values of the cutoff . They also provided the formula to select both and  so that the expected number of falsely
Analysis of high-dimensional DNA methylation dataselected variables can be controlled when the exchangeability assumption of predictors are met. However, this assumption is a weaker version of independence and is hard to be satisfied with highly correlated genomic data. We thus focused on identifying the CpG sites which have high selection probabilities in the analysis of methylation data.
Adaptive regularization procedureLi and Li (2010) have pointed out that their procedure does not perform well when two predictors that are linked with each other are negatively correlated with the response because in this situation the corresponding regression coefficients have different signs, so they are not expected to be locally smooth. Their solution to this problem is to estimate the signs of coefficients first, and refit the model with the estimated signs. This change only affects the Laplacian matrix of the penalty function, so we can simply modify it in the following way,v are linked each other 0 otherwise,where s u is the estimated sign of the u-th predictor, which can be obtained by ordinary regression estimates when p < n, and ridge estimates for p  n. Then, the function g(u) in (5) should be updated in the formula,Li and Li (2010) have demonstrated that this adaptive regularization procedure leads to improved estimates and selection results compared with the ordinary procedure in their simulation studies. Therefore, we also have included the sign estimates in our regularized estimates for both simulation studies and the real data application.
SIMULATION STUDIESWe conducted some simulation studies to compare the performance of our proposed method to existing main-stream regularization procedures. In our simulation models, we have 600 genes which consist of 19 CpG sites such that 100 genes have 1 CpG site, 150 genes have 2 CpG sites and each 50 genes of the others have 39 CpG sites, respectively. Therefore, a total of 2500 CpG sites were simulated. To mimic real DNA methylation data, we need to generate group correlated variables within therange. To do so, we employed the inverse logit transformation of multivariate normal random variables. Thus, the methylation -values of the g-th gene for the i-th individual is calculated aswhere s is a scale parameter and p g is the size of the g-th gene, i.e. 1  p g  9. In this study, we set  = (0.1,...,0.1) T and s = 4 so that the distribution of the methylation values have an enriched '0' (unmethylated) and enriched '1' (completely methylated) as previously observed (). Next, we specified the true regression coefficients  similar as Li and Li (2010). Let us first denote the coefficients of the g-th gene by  (g) = ( 1,g ,..., p g ,g ) T. Since 600 genes have 1 to 9 CpG sites, we grouped the genes by the number of CpG sites. For example, the first gene group has only one CpG site, and the second group has only two CpG sites, and so on. Then, we selected one gene from each of the 9 different gene groups, which leads to a total of 45 CpG sites. We denoted the regression coefficients of these 45 CpG sites asfor g = 1,...,9 and referred them as CpG set-1. Similarly, we selected another nine genes from each of the nine different gene groups, and denoted their coefficients aswhere x is the smallest integer not less than x. We referred them as) T. For each simulation set, samples were generated until we have 200 cases. We then randomly selected 200 controls from the control pool already generated. We considered nine different simulation models, differing the strength of the true signals  and the covariance matrix within genes. First, three models are defined in the following way,where the correlation of the first two models is AR(1), and the third model has compound symmetric correlation structure. We then simulated the data with different correlation coefficient  = 0.2,0.5 and 0.7 for all three models. For each model we repeated simulations 100 times, and selection probabilities for each simulation set was computed based on 100 resamplings. We compared the performance of the proposed ring and F.con network-based method to that of the group MCP (gMCP) procedure using the R package grpreg (), the lasso and Enet procedures using glmnet ().shows the box plots of averaged selection probabilities of 70 true signals in 9 different simulation models. It appears that the lasso has the lowest selection probabilities, and the Enet and our methods have similar selection probabilities through all simulation models. The selection probabilities of gMCP are slightly lower than that of the Enet but much higher than that of the lasso. However, the model with the highest selection probabilities does not always lead to the best model, when the model might have selected too many false positives if the selection probabilities of the disease unrelated predictors are also high. Thus, we computed both true positive rates and false positive rates of each procedure while varying the cutoff  of selection probabilities from 0 to 1.The averaged receiver operating characteristic (ROC) curves of selection results of the procedures are given in Supplementary Materials (). The corresponding area under the ROC curves (AUC) are shown in. It is obvious that our proposed networkbased methods outperform other procedures in all simulation scenarios. Surprisingly, both versions of the proposed networkbased methods (Ring and F.con) have very similar AUCs and almost identical ROC curves in all simulation models. This may suggest that the penalty of misidentifying correlation structures of CpG sites within a gene is negligible, but instead the group selection effects of clustering CpG sites is strong enough to enhance overall selection performance and overwhelm the others.The null simulation (with  = 0) were also conducted for these five procedures for validation. The results are provided in Supplementary Materials (Figs S2 and S3), where averaged selection probabilities over 100 simulation replications are displayed for all 2500 CpG sites. It can be seen that all procedures produced roughly uniform selection probabilities across all CpG sites. Note that the comparison of selection probabilities across the five procedures in the null simulation is not meaningful, but we should compare selection probabilities across CpG sites. Since the lasso procedure handles neither group structure nor correlated predictors, their selection performance is always poor for group correlated predictors. The gMCP is better than the lasso as it specifies grouped variables but does not differentiate their correlations. In contrast, the Enet is designed to have grouping effects for correlated predictors without specifying defined groups. Only our proposed methods account for both group structure and correlated variables thus lead to a superior selection performance over the other regularization procedures.
H.Sun and S.Wang
A
B
DATA ANALYSISWe applied our proposed method to select differentially methylated CpG sites between ovarian cancer cases and healthy controls using the DNA methylation data generated from Illumina Infinium HumanMethylation27K Beadchip (). The data is available at the NCBI Gene Expression Omnibus (http://www.ncbi.nlm.nih.gov/geo/). We first performed the quality control procedure of the methylation data similar aspre-treatment cases, and 123 post-treatment cases. We chose to work with more homogenous comparisons by separating pre-treatment and post-treatment cases. Among 12 770 genes, 5834 genes have one CpG site, and 6744 genes have two CpG sites. Only 169 genes include 3 to 9 CpG sites, and 23 genes have 10 to 22 CpG sites. Next, we investigated the sample correlations between CpG sites of 6936 genes that have at least 2 CpG sites. The first comparisons is between 152 controls and 119 pre-treatment cases, and second comparison is between 152 controls and 123 post-treatment cases. The sample correlation matrix was computed gene by gene. We took the maximum correlation from all pairwise correlations among CpG sites on genes with >2 CpG sites and plotted the histograms of these correlations over 6936 genes for comparisons (). Although the distributions of the correlations are quite different between two comparisons, it is clear that methylation -values within genes are highly correlated. The correlation histograms of separate pretreatment cases, post-treatment cases, and controls are also given in Supplementary Materials (). To identify the important CpG sites and corresponding genes for ovarian cancer, we applied the proposed two versions of the regularization procedures (Ring and F.con) and three existing ones (Lasso, gMCP and Enet). The selection results of the pre-treatment and post-treatment comparisons are reported inwhen comparing pre-treatment cases and controls, gene HOXB5, which was selected by the proposed procedure was previously identified to be differentially methylated between liver cancer tumor tissues and adjacent normal tissues (), but Enet failed to select HOXB5 into its top 20 list. The gene MPO is known to be related to lung cancer risk () and all procedures identified one CpG site from this gene. Inwhen comparing post-treatment cases and controls, DNA methylation level of the gene EGF was previously reported to be related to head and neck cancer () and EGF was identified by all five procedures. Gene TNFAIP8, which is known to act as a negative mediator of apoptosis and may play a role in tumor progression (http://www.ncbi.nlm.nih.gov/gene/25816) was only selected by the proposed procedures but not the Enet procedure.
Analysis of high-dimensional DNA methylation data
DISCUSSIONIn this article, we proposed a penalized logistic regression model for correlated predictors within a group and applied it to highdimensional methylation data. In simulation studies we have demonstrated that the proposed procedure outperforms existing main-stream regularization methods such as lasso and Enet when data is correlated within a group.Beadchip. Some genes in our findings are known to be associated with other types of cancers. Since we mainly focused on identifying most likely associated CpG sites through selection probabilities, we did not discuss about estimation performance of our proposed method. In the case that prediction is desirable, we strongly recommend to reobtain unpenalized likelihood estimates based on selected predictors. This unpenalized MLE is often adopted for better prediction (). Our proposed selection method provides a way to potentially better select CpG sites that are truly related to the outcomes among tens of thousands of CpG sites who are correlated within genes. However, underlying true correlation structure of methylation data is much more complicated than what we assumed. Particularly, genes from a pathway may also be correlated with each other (). To incorporate a prior knowledge of genetic pathways may further improve the selection accuracy. We are currently pursuing the usage of genetic pathways information for the DNA methylation data analysis.
H.Sun and S.Wang
The Author 2012. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oup.com at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
