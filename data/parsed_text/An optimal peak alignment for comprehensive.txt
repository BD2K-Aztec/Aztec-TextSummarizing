Motivation: Comprehensive two-dimensional gas chromatography mass spectrometry (GC × GC–MS) brings much increased separation capacity, chemical selectivity and sensitivity for metabolomics and provides more accurate information about metabolite retention times and mass spectra. However, there is always a shift of retention times in the two columns that makes it difficult to compare metabolic profiles obtained from multiple samples exposed to different experimental conditions. Results: The existing peak alignment algorithms for GC × GC–MS data use the peak distance and the spectra similarity sequentially and require predefined either distance-based window and/or spectral similarity-based window. To overcome the limitations of the current alignment methods, we developed an optimal peak alignment using a novel mixture similarity by employing the peak distance and the spectral similarity measures simultaneously without any variation windows. In addition, we examined the effect of the four different distance measures such as Euclidean, Maximum, Manhattan and Canberra distances on the peak alignment. The performance of our proposed peak alignment algorithm was compared with the existing alignment methods on the two sets of GC × GC–MS data. Our analysis showed that Canberra distance performed better than other distances and the proposed mixture similarity peak alignment algorithm prevailed against all literature reported methods. Availability: The data and software mSPA are available at
INTRODUCTIONAn emerging technology, comprehensive 2D gas chromatography mass spectrometry (GCGCMS) brings much increased separation capacity, chemical selectivity and sensitivity for metabolomics analysis although there are several issues. This approach usually uses a short column after the * To whom correspondence should be addressed. main analytical column. Typically, the second column is operated at a higher temperature than the first column with different stationary phase. The compounds co-eluted from the first column are further separated in the second column because of the difference of column temperature and the chromatography matrix. The further separated compounds are directed to a high capacity time-of-flight mass spectrometry system for detection. The GC  GCMS platform offers significant advantages for analysis of complex samples including: an order-of-magnitude increase in separation capacity, significant increase in signal-to-noise ratio and dynamic range and improvement of mass spectral deconvolution and similarity matches. Since the GC  GCMS system can provide more accurate information about compound retention times and mass spectrum, it represents a powerful tool for the analysis of compounds in complex biological systems. However, while gathering GC  GCMS data, there is always a shift of retention times in the two columns. Retention time shifts make it difficult to compare metabolic profiles obtained from multiple samples. In order to correct the retention time shifts in the GC  GC system, two alignment approaches have been developed: profile alignment and peak alignment. The profile alignment directly uses the entire chromatographic data, i.e. the raw instrument data, as the input data. In the peak alignment approach, the raw instrument data are first deconvoluted to peak list, and the peak lists of multiple samples are then employed as the input data to correct retention time shifts. The selection of the two approaches for retention time correction depends on the methods of downstream statistical analysis. Currently, four profile alignment methods have been reported.introduced an algorithm based on the generalized rank annihilation method.developed a correlation-optimized shifting method. These two methods were designed to align small or local regions of interest in GC  GC data. In order to correct the entire chromatogram in both dimensions,proposed an indexing scheme together with a piecewise retention time alignment algorithm.developed a 2D correlation optimized warping (2-D COW) method for warping the GC  GC data. However, all the profile alignment methods align the GC  GCMS data based on 2D retention times alone, although the signature feature of a compound, i.e. mass spectrum of fragment ions, is readily available in the raw instrument data. Aligning compound peaks solely based on the 2D retention times may introduce a high rate of false-positive alignment becausePage: 1661 16601666
Mixture similarity peak alignment for GC  GCMSsome compounds with similar chemical functional groups have similar retention times in the two columns. For this reason, two peak alignment methods, MSort () and DISCO (), were developed. In these methods, the raw instrument data of each sample were first reduced to a compound peak list, where each compound was characterized by its two dimension retention times, mass spectrum and other features. The two dimension retention times and the mass spectrum of compound fragment ions were then used for compound alignment. These two methods greatly reduced the rate of falsepositive alignment compared with the profile alignment methods. MSort was developed to align only for homogeneous data while DISCO can be applied to both homogeneous and heterogeneous data. The homogeneous data mean that all samples were analyzed under the identical GC  GCMS experiment conditions while the heterogeneous data refer that experiment data were acquired under different GC  GCMS conditions. In terms of analytical methods, there are two main differences between MSort and DISCO approaches. First, they employ the different peak distance measures, Maximum distance and Euclidean distance for MSort and DISCO, respectively. However, the effect of different peak distance measures was not examined. In this study, we examined the effect of the different peak distances on the peak alignment using four distance measures: Euclidean, Maximum, Manhattan and Canberra. Second, the different variation windows are used in both approaches. MSort requires a distance-based window and a spectral similarity-based window is required in DISCO. However, it is usually difficult for users to set an optimal value for each of the variation windows. To avoid this difficulty, we proposed a novel similarity measure, a mixture of the peak distance and the spectra similarity, and developed peak alignment algorithms in a software package named mSPA, using the proposed similarity measure in which any variation window is unnecessary. We evaluated the performance of the different peak alignment methods along with the different peak distance measures using two sets of GC  GCMS data. The remaining part of this article is organized as follows. The four different distance measures and spectral similarity measures are introduced along with two sets of real GC  GCMS data in Section 2. In Section 3, the four peak alignment algorithms are described and followed by the introduction of the algorithms of the proposed mixture similarity peak alignment. All the peak alignment algorithms are then compared using the two sets of GC  GCMS data in Section 4. Discussion and conclusion are given in Section 5. We will use the following notations throughout the article. Let T ={t 1 ,...,t n } be a peak list of the target GC  GCMS data and R = {r 1 ,...,r m } the peak list of the reference GC  GCMS data, where r i and t j (i = 1,...,m,j = 1,...,n) are composed of its first and second retention times (r (i,1) ,r (i,2) ) and (t (j,1) ,t (j,2) ), respectively. Note that the distance and the similarity always refer to the retention times and the mass spectra information, respectively. All the statistical analysis and simulations are performed using a statistical package R (www.r-project.org).
METHODS
Distance measureThe four different distance measures are employed in this study: Euclidean distance, Maximum (aka Chebyshev) distance, Manhattan distance andCanberra distance. Each distance measure between two peaks t j and r i is as follows:where t (j,1) and r (i,1) are the first dimension retention time of the peaks t j and r i , and t (j,2) and r (i,2) are the second dimension retention time of the peaks t j and r i. To help understand the variation among the distance measures, the four distance measures are delineated inof the Supplementary Data II.
Similarity measureWe use the dot product Stein and, which is the most popular approach, for spectrum similarity measure between two mass spectra, I t j and I r i , of two peaks, t j and r i , as follows:where < I t j ,I r i > is an inner product between the two), as an alternative method for the spectrum similarity calculation and it showed the same conclusions as the dot product (see Supplementary Data I). The difference between two similarity measures is centering of the variables and normalizing by the variance of each variable. In fact,compared the different measures of spectral similarity and concluded that the Pearson's correlation coefficient is robust but the difference between the dot product and the Pearson's correlation coefficient is subtle. We included the Pearson's correlation coefficient in our mSPA software as an option for users to select.
GC  GCMS dataIn this study, two sets of GC  GCMS data were used. One is a mixture of 106 compound standards and the other is metabolite extract from rat plasma with spiked-in six compound standards. In the first dataset (Dataset I), the GC  GCMS analysis were repeated 10 times under 5 @BULLET C/min temperature gradient, resulting in a total of 10 datasets (S1S10 in). As for the spiked-in sample (Dataset II), the compounds were analyzed five times on GC  GCMS (D1D5 in). The detailed procedure for generating these two datasets is described in the Supplementary Data II. The LECO ChromaTOF software version 3.4 was used for instrument control, spectrum deconvolution and compound identification. The peak list of each GC  GCMS data was then manually examined. In case that there are multiple peaks identified as the same compound in an experiment, only the peak with the largest peak areas was selected.Page: 1662 16601666
S.Kim et al.
ALGORITHM
Four peak alignment algorithmsFour algorithms are considered here to compare the performance of the peak alignment for the homogeneous GC  GCMS data. For each peak alignment algorithm, we employ the four different distance measures.
Peak alignment without windowIn this case, there are two methods. One is a peak alignment procedure using solely the peak distance without window (PAD) and the other peak alignment algorithm is rendered only based on the spectral similarity between two peaks without window (PAS). In detail, for each peak t j  T in the target chromatogram, the peak distances and spectral similarities between the current target peak and all the peaks r h ( R), h = 1,...,m, in the reference sample are calculated for PAD and PAS, respectively. Then the best matched peak r i ( R) of t j is decided by:where |R|=m and D d is a distance measure (d = 1,...,4).
Peak alignment with windowThe previous methods find a best match by searching the peak with the minimum distance or the maximum spectral similarity. Therefore, there might be a false positive alignment if the experimental variations are bigger than the information of the peak distance or the spectral similarity. This can be resolved if both measures are used on the peak alignment at the same time. To this end, MSort () uses the distance-based window while the spectral similarity-based window is used by DISCO (). In other words, MSort and DISCO require users to provide predefined variation windows for the distance and the spectral similarity among the different experiments. The detailed description of MSort and DISCO can be found in the Supplementary Data II. We here introduce two algorithms which can be considered as generalized versions of MSort and DISCO, respectively. The first method is called the peak alignment with the distance-based window (DW-PAS) and the second method the peak alignment with the similarity-based window (SW-PAD). In case of DW-PAS, for each peak t j  T , the distances between the current target peak t j and all the peaks r i  R in the reference chromatogram are calculated by the chosen distance measure and some of the reference peaks are selected for the peak alignment by the distance-based window,where  (k) is the k-th closest peak's distance to the current peak t j obtained by using the chosen distance measure D d , d = 1,...,4. Once the several reference peaks are selected by the distance-based window, the best matching reference peak r i of the current target peak t j is inferred using the following expression:where |R S ||R|=m. Note that MSort employs the Maximum distance D 2 to build the window and considers the Pearson's correlation as spectral similarity measure. The difference between DW-PAS and SW-PAD is the way to construct the variation window. In case of SW-PAD, the window is constructed by the spectral similarity measure, dot product in this work. Once some of the reference peaks are selected by the window constructed, the reference peak with the minimum distance is chosen as the best match of the current target peak. The entire procedure of SW-PAD for finding the best matching reference peak r i  R of the current target peak t i  T can be summarized byR} and |R S ||R|=m and  is the user-defined threshold for the spectra similarity by the dot product. SW-PAD becomes DISCO when the Pearson's correlation as a similarity measure is used to extract the subset R S of R instead of the dot product accompanied by the Euclidean distance D 1 .
Mixture similarityWe further developed a novel similarity measure which uses both the peak distance and the spectral similarity measures simultaneously. We call the proposed measure the mixture similarity, and the mixture similarity to r i ( R) given t j can be defined:where w is the weight for the mixture similarity measure and 0  w  1. Note that the distance part in the right-hand side of Equation (6) is normalized so that the range becomes between 0 and 1. Certainly, when w = 1, the mixture similarity use the peak distance only and it is only based on the spectral similarity measure when w = 0. That is,). As the mixture similarity between r i and t j becomes large, the possibility of t j matching to r i increases. Using the mixture similarity measure, the peak alignment can be rendered as follows. For each peak t j  T , the mixture similarities between the current target peak and all the peaks r h ( R),h = 1,...,m, in the reference sample are calculated. Then the best matching peak r i ( R) of t j is decided bywhere |R|=m. We call this method the peak alignment using the mixture similarity without window (PAM). One of the main benefits of the proposed PAM method is the ability to use both the peak distance and the spectral similarity simultaneously without constructing the variation window differing from DW-PAS and SWPAD in which both the distance and spectral similarity measures are used sequentially through a constructed window.
IMPLEMENTATIONSIn the previous section, the five methods are introduced for the peak alignment, which are PAD, PAS, DW-PAS, SW-PAD and PAM. For each method, we apply the four different distance measures, Euclidean, Maximum, Manhattan and Canberra distances, along with the spectral similarity measure to GC  GCMS data. We first describe the comparison criteria to evaluate the performance of each method. Then we consider two cutoff values (k and ) which need to be predefined for the variation window-based peak alignment methods, DW-PAS and SW-PAD, as well as the weight w for the mixture similarity measure, PAM. Then the performances of each method are considered for each dataset and followed by thePage: 1663 16601666
Mixture similarity peak alignment for GC  GCMSdescription of the method of finding the optimal distance measures and w value.
The comparison criteriaThe performances of all five methods are compared by calculating the true positive rate (TPR), positive predictive value (PPV) and F1 score of the peak alignment. Suppose there are n target peaks T ={t 1 ,}, where u  min(n,m). Note that if two peaks are generated by the same compound, it is called a positive peak pair. If a certain peak alignment method is applied to the two datasets, T and R, and v matched peak pairs are found, then the values of TPR and PPV of the peak alignment between two datasets are estimated by the following equations:where TP is the number of positive peak pairs that were aligned as positive (true positive) and is less than or equal to min(u,v), FP is the number of negative peak pairs that were aligned as positive (false positive) and is v-TP, FN is the number of positive peak pairs that were not aligned (false negative) and is u-TP and TN is the number of negative peaks that were not aligned (true negative) and is mn-u-FP. Note that the total number of peak pairs is mn. TPR is called recall and PPV precision and their harmonic mean (=2  TPR PPV/(TPR + PPV)) is used as an accuracy which is called F1 score. Thus, we use F1 score as an accuracy of the peak alignment. Once all the implementations were finished, the means and standard errors (SE) of TPR, PPV and F1 score for all the cases of each peak alignment method were estimated for the purpose of comparing their performance. The results of this estimation are given in the Supplementary Data I.
The cutoff values and the weight wDW-PAS method requires to construct the distance-based window for peak alignment. To do this, k, which is described in expression (5), should be set up prior to the peak alignment. It means that the window is constructed by the reference peaks which have less than or equal to the distance of the k-th closest reference peaks to the current target peak. In our studies, the five values, (3, 5, 10, 15, 20) were used to see the effect of the k value on the performance of the peak alignment. On the other hand, the cutoff value for the spectral similarity, , is necessary for SW-PAD method and the 13 values (0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 0.93, 0.95, 0.97, 0.99) were considered to investigate how the performance of the peak alignment was affected. The performance of PAM depends on the weight w of the mixture similarity. If w goes to one, then the peak distance will play an important role in the peak alignment and the contribution of the spectral similarity measure will increase as w goes down to zero. In this study, we examined the performance of PAM according to the 13 different w values, (0.01, 0.05, 0.1, 0.2 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 0.95, 0.99).
Performance analysis of pair-wise peak alignmentAll the pairs among the data are constructed, considering that one is a reference chromatogram and the other is a target chromatogram. As a result, there are a total of 45 homogeneous chromatogram pairs for Dataset I and 10 for Dataset II used for the comparison analysis of the peak alignment methods. For each peak pair, the five different peak alignment methods were implemented along with four different distance methods as well as the different cutoff and weight values.
Dataset I: a mixture of compound standardsWhen PAD was used for Dataset I, Canberra distance measure significantly outperformed other distance measures in terms of F1 score. Their mean and SE of F1 scores are as follows: Euclidean = 0.9253  0.0052; Maximum = 0.9035  0.0072; Manhattan = 0.9276  0.0049; Canberra = 0.9652  0.0026 (see Supplementary Data I). The effect of the cutoff value, k, for the peak alignment method DW-PAS was first examined as depicted in(a). Note that k is the rank of the distance in ascending order, meaning that if k is close to one, the distance goes to zero. Euclidean distance with PAD performs the best when k = 3, but its F1 score is overlapped with those of Maximum and Manhattan distances when k = 3 (F1: Euclidean = 0.9618  0.0037; Maximum = 0.9614  0.0037; Manhattan = 0.9604  0.0039). Interestingly, the superiority of Canberra distance with PAD is disappeared in case of DW-PAS (F1 = 0.8981  0.0069). We examined the performance of the SW-PAD method according to its different cutoff value, , which is used to construct the similarity-based window.(b) displays that the optimal  may be around 0.5 for Dataset I. As  goes to near zero, both TPR and PPV tend to be decreased. If  goes to near one, the PPVs are increased but the TPRs are sharply decreased. When the cutoff value, , is small, Canberra distance shows much better performances than other distance measures. However, no significant difference is observed among the different distance measures in case that the cutoff value is large. The  = 0.5 version for SW-PAD with Canberra distance performs the best (F1 = 0.9766  0.0026).(c) shows the performance of the PAM method using the mixture similarity measure. The performances were examined according to the different weight values (w) between 0 and 1. Clearly, Canberra distance behaves differently from other distance measures. Namely, as w increases, the performance of the peak alignment of Euclidean, Maximum and Manhattan distances with PAM drop down sharply, while the performance of Canberra distance tends to increase up to some point as w goes to one. As a result, Canberra distance performs the best when w is greater than or equal to 0.5 and other distances have the best performance when w is smaller than 0.5. That is, while the spectral similarity plays an important role in the version of PAM with other distance measures, the peak distance and the spectral similarity are equally contributed to the case of PAM with Canberra distance. The w = 0.5 version of PAM with Canberra distance outperforms others (F1 = 0.9810  0.0020). When Dataset I was used for each peak alignment method, PAS (M2) shows the worst performance (F1 = 0.9023  0.0069) as can be seen inandand(a) of the Supplementary Data II. Apparently, PAM (M5) shows a promising performance, especially coupled with Canberra distance (D4) as depicted in(a). Collectively, in case of Dataset I, the  = 0.5 version of SW-PAD with Canberra distance and the w = 0.5 version of PAM Page: 1664 16601666with Canberra distance have the better performances significantly different from other methods as shown in.
S.Kim et al.
Dataset II: a spiked-in sampleThe performance of the five different peak alignment algorithms was examined with Dataset II and we observed several different trends from Dataset I. There was no clear distinction among the four different distance measures when PAD was employed in terms of F1 scores (F1: Euclidean = 0.4728  0.0178; Maximum = 0.4677  0.0179; Manhattan = 0.4729  0.0177; Canberra = 0.4694  0.0273). PAS outperforms against PAD (F1: PAS = 0.6109  0.0102; PAD with Manhattan = 0.4729  0.0177), while PAD performed better than PAS significantly in case of Dataset I as shown in. This means that the variation in peak distance might be larger in Dataset II than that in Dataset I compared with the variation in spectral similarity, which is true because the sample complexity is significantly increased in the Dataset II. As a result, the contribution of the spectral similarity to the peak alignment will be larger than that of the peak distance in Dataset II. When DW-PAS was applied to Dataset II, the Canberra version performed better than other distances as clearly shown in(d). When k is three, the difference between Canberra and other distances becomes much bigger than when k is larger than 15. The k = 15 version of DW-PAS with Canberra distance shows the best performance (F1 = 0.5932  0.0110) as can be seen in Tables 2 and S2. It seems that the optimal cutoff value, , for Dataset II is different from the value for Dataset I. As shown in(e), the highest TPR is occurred when  = 0.8 which is consistent with the result of DISCO (). However, if TPR and PPV are considered through F1 score which is the harmonic mean between Page: 1665 16601666
Mixture similarity peak alignment for GC  GCMSTPR and PPV, then the best performance is occurred when  = 0.93. On the other hand, Dataset I gives us 0.5 as an optimal  as displayed in(b). All the distance measures have the similar trends according to w when PAM was applied to Dataset II as depicted in(f). Namely, as w goes to one, the performance decreases, while the performance increases if w decreases to zero. Interestingly, when w = 0.99, the version of Canberra distance outperforms against other version of distance measures (F1: Euclidean = 0.4811  0.0169; Maximum = 0.4814  0.0168; Manhattan = 0.4815  0.0169; Canberra = 0.5414  0.0148 as shown in the Supplementary Data I), while no significant difference was observed when PAD was applied to the same dataset. This means that although the amount of the contribution of the spectral similarity is relatively small (1w = 0.01), the number of false positives can be reduced significantly by aid of the spectral similarity measure. Similar to the conclusion in Dataset I, PAM shows the best performance in peak alignment as shown in
Peak alignment of all peak listsIn the previous section, we considered the performance of the peak alignment of each method based on the pairwise peak alignment. However, the peak table that all peak lists were aligned together is absolutely necessary for further analysis. For this reason, we aligned all peak lists using the cases which have the maximum F1 score for each peak alignment method as summarized inin order to examine the performance of the peak alignment of each method when all peak lists were aligned. As for Dataset I, we aligned 10 peak lists with 9 pairs of the pairwise alignment, (S1,S2), (S2,S3), (S4,S5), (S6,S7), (S7,S8), (S8,S9) and (S9,S10), by choosing the best cases of each pair for each method which has the maximum F1 score except for OP-PAM which is described in the next section. In case of OP-PAM, it was done by optimization. Similarly, Dastset II was aligned with four pairs of the pairwise alignment, (D1,D2), (D2,D3), (D3,D4) and (D4,D5). Once the peak table of all peak lists was constructed, the peaks that had at least one missing were deleted. Using the scheme described above, the peak alignment of the entire peak list was done with the best cases for each peak alignment as depicted inin the Supplementary Data II. To examine the performance of the peak alignment for each algorithm, we calculated TPR, PPV and F1 score based on the true peak alignments for Datasets I and II as shown inin the Supplementary Data II. The true number of peaks matched throughout all the homogeneous chromatograms was 66 and 146 for Datasets I and II, respectively. The results were consistent with the previous validation studies in Section 4.3. Indeed, PAM outperforms others in terms of F1 scores. In case of Dataset I, SW-PAD and PAM show the largest F1 scores (F1: PAD = 0.9365; PAS = 0.8333; DW-PAS = 0.9219; SW-PAD = 0.9618; PAM = 0.9618) as can be seen in(a).(b) also shows that PAM performs the best out of the five peak alignment algorithms using Dataset II (F1: PAD = 0.3275; PAS = 0.5048; DW-PAS = 0.4940; SWPAD = 0.5091; PAM = 0.5363).
Finding the optimal value of w for PAM methodFor the PAM method, it is indispensable to find the optimal value of w and distance measure for the best performance of the peak alignment. Therefore, we developed an optimal version of PAM which is called OP-PAM. In case of OP-PAM, the optimal value of w and optimal distance measure will be estimated iteratively based on a certain likelihood function differently from fixing their values for PAM by users in advance. To do this, the following likelihood function L(Y ,X|) was considered to evaluate the potential performance of the peak alignment:where  = (w,d), d is the index of the four different distance measure (1 = Euclidean; 2 = Maximum; 3 = Manhattan; 4 = Canberra), l is the number of all the matched peaks between T and R, |T |=n, |R|= m, and l  min(n,m). Therefore, the optimal weight and distance measure,are estimated given T and R by the following maximization:The estimated optimal weight and distance measure,can be found inin the Supplementary Data II. The initial value was 0.5 for all the cases and the maximization was done using the R package nlminb which is unconstrained and constrained optimization using PORT routines. In case of Dataset I, the estimates of w are consistent with the best case of PAM. That is, the best case of PAM was Canberra distance with w = 0.5 as shown inand, in case of OP-PAM, Canberra distance was estimated as the best for all the peak pairs with the mean 0.6939 and SD 0.2558 of the estimates of w as can be seen in. As for Dataset II, the estimates of OP-PAM are different from the best case of PAM. Namely, the best case of PAM was Euclidean, Maximum and Manhattan distances with w = 0.05 in, while Canberra distance was selected having the maximum likelihood with the mean 0.6187 and 0.0786 of the estimates of w in. The peak alignment of all peak lists was then done using OPPAM for Datasets I and II as depicted in. Interestingly, the performance of the peak alignment using OP-PAM is the same as that using PAM for Dataset I and outperforms others in case of Dataset II (F1 = 0.9618 for Dataset I and F1 = 0.5370 for Dataset II) as shown in. Their detailed results such as aligned retention time, area and compound name tables can be seen in the Supplementary Data III.
DISCUSSION AND CONCLUSIONHomogeneous peak alignment using either the distance of peaks and/or the similarity of mass spectra was considered with four different distance measures and the mixture similarity measure by combining the peak distance and the spectral similarity. Then the performances of the five different alignment methods were compared. In addition, the optimal version of PAM, OP-PAM, was further implemented into a software package mSPA for automatic peak alignment. Compound retention index (I), normalized retention time, can be employed for peak alignment. As for GC-MS data, Shimadzu (www.shimadzu.com) developed a retention time correction algorithm, which is called Automatic Adjustment of Retention Time (AART), inside their GCMS solution 2.5 software using I features and showed the promising performance. Similarly, I features can be used for GC  GCMS data to correct the retention times of Page: 1666 16601666
S.Kim et al.both dimensions. However, mSPA is designed for the alignment of homogeneous data, where the compound retention time shifts are not large and therefore, the advantage of converting retention time to I and then use I for alignment may not be significant. Throughout the comparison, Canberra distance shows better performances than other distance measures. This may be because Canberra distance normalizes the variations of retention time by taking the weight, resulting in reducing the effect of the variation of each retention time. The variation in peak distance of Dataset I is larger than that of Dataset II as seen inand. Consequently, PAD performed worst in Dataset II in terms of F1 score, while it showed better performance marginally in Dataset I in. However, although PAS showed the smallest F1 score in Dataset I in, PAS is less sensitive to the quality of data than PAD. It means that the measurement error of mass spectra is stable so that PAS may be robust to variation in peak distance. In order to utilize the peak distance and the spectral similarity together, a novel similarity measure, the mixture similarity, was proposed. This is a mixture of the peak distance and spectral similarity information in that the contribution of each measure is controlled by the weight w. Therefore, if the peak distance plays an important role in peak alignment, w will be large and the weight w will be small if the spectral similarity plays a primary role in peak alignment as described in Equation (6). Indeed, when PAM with the mixture similarity measure was implemented, the smaller w values were observed when the variation in peak distance is larger (Dataset II) than when the variation is smaller (Dataset I) as shown inand in the last column of. In particular, it can be seen that PAM prevailed against other four methods in peak alignment. As we stated above, the cutoff values are not consistent with the different dataset so that an optimal cutoff value should be found according to the quality of the dataset before the peak alignment. For this reason, OP-PAM, the optimal version of PAM, was developed to find the optimal value of w automatically to avoid this issue. The main advantages of OP-PAM to peak alignment are (i) it uses both peak distance and spectral similarity, (ii) it does not need to construct the window so that the cutoff values are not necessary, and (iii) it can find the optimal distance and weight w based on the likelihood function statistically as described in Equation (7). In our comparison analysis, it is demonstrated that OP-PAM outperformed all the literature reported peak alignment methods and other methods investigated in this work for the peak alignment of the entire peak lists as shown in Supplementary. Especially, OP-PAM method can be an optimal approach for the peak alignment because it performed the best for both datasets. In other words, it provides highquality peak alignment regardless of the quality of the GC  GCMS data.
The Author 2011. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oup.com at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
