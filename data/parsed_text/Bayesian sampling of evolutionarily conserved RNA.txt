Motivation: Today many non-coding RNAs are known to play an active role in various important biological processes. Since RNA's functionality is correlated with specific structural motifs that are often conserved in phylogenetically related molecules, computational prediction of RNA structure should ideally be based on a set of homologous primary structures. But many available RNA secondary structure prediction programs that use sequence alignments do not consider pseudoknots or their estimations consist on a single structure without information on uncertainty. Results: In this article we present a method that takes advantage of the evolutionary history of a group of aligned RNA sequences for sampling consensus secondary structures, including pseudoknots, according to their approximate posterior probability. We investigate the benefit of using evolutionary history and demonstrate the competitiveness of our method compared with similar methods based on RNase P RNA sequences and simulated data. Availability: PhyloQFold, a C++ implementation of our method, is freely available from
INTRODUCTIONSince the first discovery of catalytic RNA activity in the early 1980s a great number of structural and enzymatic RNAs have been found, which are involved in a large variety of tasks concerning highly topical fields of research including gene regulation (), tumor biology () and epigenetic phenomena (). A fundamental condition for the biological function of RNA is the ability to adopt complex tertiary structures. These molecule comformations are encoded to some extent by the sequence of the molecule's nucleotides, i.e. the primary structure (). Since structure determination by experimental techniques like X-ray crystallography and NMR spectroscopy are time consuming and costly (), * To whom correspondence should be addressed. researchers are interested in computational methods to predict the molecule's conformation based on its primary structure. In cases when several similar functional RNA sequences of evolutionarily related organisms are available, their structure can be inferred by comparative sequence analysis. Since the biological function of ncRNAs is determined by their molecular structure, RNA sequence evolution is constrained by the secondary structure. Changes in the molecules primary structure have less influence on selection pressure as long as the secondary and tertiary structure is maintained. This is the case when compensatory mutations conserve complementarity between base pairings (). Thus, in a multiple sequence alignment where structurally similar parts are grouped together, pairs of columns can be found that provide these co-varying signals. Comparative structure prediction methods use information like this to predict the structure that a group of related RNA sequences share (i.e. the consensus secondary structure). If a structurally correct or at least a high quality alignment is given, methods of this category, e.g. Pfold () and RNAalifold (), achieve very good results (). () describe the algorithms implemented in Pfold in terms of Stochastic Context-Free Grammars (SCFGs), which generate secondary structures with nested base pairings. This means that if position i is paired with position i > i, and j is paired with j > j, then either i < j < j < i or j < i < i < j must hold. Also many other RNA secondary structure reconstruction methods, including RNAalifold, focus on secondary structures that fulfill this assumption. An remaining problem is given by structural elements called pseudoknots, which contain non-nested base pairings. Even if they occur rather rarely, pseudoknotted RNAs are known to be essential for a large variety of functional processes in the cell (). Several methods have been proposed to reconstruct secondary structures with pseudoknots (see, for example,). The program IPKnot of () reconstructs pseudoknotted consensus structures from homologous RNA sequences. Benchmarks like CompaRNA () reveal that we cannot expect to find for every primary structure the correct secondary structure with any of the available prediction approaches, even if pseudoknots are neglected. For this reason, it is important to assess the reliability of a prediction. One possibility is to use Bayesian sampling, see () for a primer.
PhyloQFoldFollowing this strategy, () presented the RNA secondary structure prediction program McQFold. Instead of computing only the most likely folding of a given RNA primary structure, it samples possible secondary structures according to their approximate posterior probability, which makes the uncertainty of the predictions explicitly assessable. They developed an extended grammar model, permitting pseudoknots of arbitrary type, and a Metropolis Hastings strategy for a Markov chain Monte Carlo (MCMC) method to sample possible pseudoknot configurations. In the program SimulFold () implemented an MCMC method for the simultaneous Bayesian sampling of multiple sequence alignments, phylogenies and RNA secondary structures. The latter are first sampled without pseudoknots, but the consensus structures that are subsequently computed from the samples are socalled bi-secondary structures, which can contain a certain type of pseudoknots.Here we present PhyloQFold, a new version of McQFold that makes use of the evolutionary history of a set of homologous RNA sequences. PhyloQFold is able to accept a multiple sequence alignment and a phylogenetic tree as an input and benefits from comparative sequence analysis. We suggest an extended model and show how the information that is contained in the alignment is weighted by the phylogeny of the sequences and how this information is integrated into the algorithms. We exemplify the potential of our method and investigate the improvement introduced by the new functionality. Furthermore, we compare the performance of our method to that of similar approaches on RNase P RNA sequence alignments and on data simulated according to our model.
MODELTo define a prior probability distribution on the set of folded alignments we combine the SCFG model of (), which emits alignment columns, with the capability of the model underlying McQFold to generate pseudoknots (). This means, we assume that the first step to generate a set of aligned RNA sequences is to generates a secondary structure, which may contain pseudoknots, according to the extended SCFG model of (), which is based on the grammar of () (see online Supplementary Material 1). Compared with the SCFG of (), our grammar has an additional terminal symbol q, which can generate pseudoknots after the SCFG has generated the sequence of terminal symbols. For this, the q symbols occuring in the SCFG output are randomly arranged into pairs that generate stem regions, so-called 'q-stems'. The q symbols are then replaced by the corresponding sequence sections that are matched in the q-stem. The q-stems are usually not nested with the paired regions ('stems') generated by the SCFG. After the grammar has generated the secondary structure, positions of the structure that are not paired emit unpaired alignment columns, whereas position pairs involved in stems emit pairs of alignment columns. For a given alignment, let p T (i) be the probability of the i-th column, given that it is emitted from an unpaired position, and let p T (j,k) be the probability of columns j and k, given that they are emitted as a pair of columns. These probabilities depend on the given phylogenetic tree T along which the sequences have evolved. For the emission probability p T (i) of unpaired alignment columns we assume that all unpaired sites evolve independently of each other along the phylogeny. Given a substitution rate matrix for loop regions, we compute p T (i) by Felsenstein's pruning algorithm (). We account for the stochastically dependent evolution of alignment columns pairs by modelling the substitution process of doublets (), which in our case are nucleotides at opposite positions of a stem. Thus, the underlying transition dynamic P f h (t) defines the probability of the observed change of doublet f {a,g,c,u} 2 into doublet h {a,g,c,u} 2 after time t. We compute the emission probabilities p T (j,k) of paired alignment columns with Felsenstein's pruning algorithm, in which we use the 1616 substitution model of ().
ALGORITHMS AND IMPLEMENTATIONThe general flow of our new program PhyloQFold is similar to that of McQFold (). The program generates a set of candidates for the q-stems, i.e. segment pairs of the alignment which may be involved in pseudoknots. From this pool of candidates, configurations of q-stems are proposed in each step of the MCMC sampling process. To decide whether a q-stem configuration is accepted as the next state of the Markov chain, it is rated by the probability of the sequence alignment conditioned on the q-stem configuration, which is computed by the inside algorithm (). After a burn-in phase of 100 Metropolis Hastings steps, every 50th state of the following 1000 steps is used to sample one consensus structure and to approximate the pairing probabilities (these default values can be changed by the user). Each structure is computed by the inside algorithm with randomized backtracking. For each possible pair of positions, the posterior pairing probabilities are calculated with a variant of the insideoutside algorithm and averaged over 20 sampled q-stem configurations (). The search for the most probable folding is based on simulated annealing (). In the first 1000 steps of this heuristic, the proposal chain is optimized using the inside algorithm to rate the states of the proposal chain, whereas in the second phase (also 1000 steps) the CYK algorithm () is used to rate each state. Finally, the most probable parse tree together with the q-stem configuration of the last state of the Markov chain is assumed as the most probable consensus secondary structure of the alignment. In PhyloQFold, the SCFG algorithms (inside, outside, CYK) use the emission probabilities p T (i) and p T (i,j) of alignment columns and of pairs of alignment columns. Thus, PhylQFold uses, like PFold, the phylogenetic information contained in p T (.) and p T (.,.). This is the main difference to McQFold, which uses only emission probabilities of single nucleotides and pairs of nucleotides. The runtime of the SCFG algorithms is cubic in the length of the input alignment. The number n of sequences only affects the runtime of the Felsenstein pruning algorithm, which is linear in n and is performed only once for each of the alignment columns and 2 pairs of alignment columns, see also online Supplementary Material 4.1 and
G.Doose and D.Metzlerof the Newick tree file. The output is given by three result files. One file consists of 20 sampled consensus secondary structures, another file contains the pairing probabilities for all position pairs and the third file contains the most probable consensus folding.
Detecting q-stem candidatesFor a given alignment, the pool of q-stem candidates is a set of interval pairs  ={(i,i +1,...,i +k),(j k,...,j 1,j)}. To decide during the MCMC procedure which  are proposed to be involved in a pseudokont, we apply two criteria. First, a q-stem candidate  should provide complementary nucleotides in the corresponding alignment columns. Second,  are preferred if they have a small probability to form a regular non-pseudoknot stem. To find segment pairs  that comply with the first criterion, we search for high-scoring segment-pairs (HSP;) between the input alignment and its complement, which means that the order of positions is inverted and nucleotides match if they are complementary. As alignment score for a pair of alignment columns, we use a log-scaled likelihood ratio, here defined as the ratio of the probability p T (i,j) of the two columns i and j, under the assumption that they are paired, to the probability p T (i)p T (j) of the two columns, under the assumption that they are independent, where both probabilities are conditioned on the phylogenetic tree T. We define the score   of a segment pair  as given above byTo test if a detected  is in accordance with the second criterion, the SCFG insideoutside algorithm is applied and both criteria are used to rate q-stem candidates as described by ().
Treatment of gapsIn the current implementation, gaps are treated as missing data, which means that the likelihood of a tree, given one column with gaps, is the same as the likelihood of the pruned tree, given the pruned column. This strategy is straightforward for the calculation of the probabilities p T (i) of unpaired alignment columns, but during the calculation of the probability p T (i,j) of column pairs situations may occur in which only one of the two doublet positions is a gap symbol. In such cases the corresponding branch is not pruned, but the remaining doublets that are still possible are assumed to have a probability of 1. This procedure can cause high probabilities for column pairs with many gaps, resulting in a prediction where gaps are paired with nucleotides. To avoid this, we penalize gaps by multiplying p T (i,j) with a factor (1 /n) < 1, where n is the number of aligned sequences,  is the number of column positions at which one of the two columns provides a gap symbol, and the parameter can be chosen by the user. In the analyses reported below we used = 0.7. Simulations indicate, however, that changing to a different value between 0.5 and 1.0 has little effect on the performance of our method (data not shown).
RESULTS AND DISCUSSIONThough PhyloQFold is primarily designed for sampling secondary structures in accordance with their posterior probability, the following evaluation relies on the most probable folding that the heuristic optimization process attempts to find. Thereby a comparison to other approaches, which mostly produce one optimized folding, became possible. The production rules of the extended SCFG are those as given by (), see also online Supplementary Material 1, while the rate matrices of the evolutionary model are those of (). Although there does not exist a perfect method to describe a confusion matrix of a classifier by a single value, a measure well established in bioinformatics is Matthews correlation coefficient (MCC;). It can be approximated by the geometric mean of sensitivity and selectivity (Here, sensitivity is the fraction of predicted position pairs among all pairs of positions given in the reference folding, whereas selectivity is the fraction of correctly predicted position pairs among all pairs of positions that are predicted to be paired with each other. To obtain these frequencies, we compare the predicted consensus structure to the correct consensus structure, neglecting all alignment positions that contain gaps (see online Supplementary Material 2).
Example for Illustration: RNase P RNAThe RNase P Database by () provides a high quality structural alignment of archaeal RNase P RNAs, which is examined by extensive comparative analyses (). We extracted the structural alignment of the four sequences of Acidianus ambivalens (Sequence 1), Acidianus brierleyi (Sequence 2), Sulfolobus shibatae (Sequence 3) and Sulfolobus solfataricus (Sequence 4). We estimated the corresponding phylogenetic tree by a maximum-likelihood (ML) approach applying a standard 44 DNA substitution model. Results of applying PhyloQFold to an alignment of all 41 available archaeal RNase P RNA sequences are shown in online Supplementary Material 4.1. Bayesian Sampling: The 20 consensus secondary structures produced by the Bayesian Sampling procedure of PhyloQFold indicate that many different consensus structures are possible for this set of molecules (see online Supplementary). Posterior pairing probabilities:shows that all of the column pairs predicted as highly probable (0.81) are indeed also given in the database structure, while most of the stems predicted as unlikely (0.050.4) are not existent. Most probable folding: the predicted consensus structure obtained by the simulated annealing procedure together with the correct structure were put into graphs with the help of the program VARNA ().reveals a strong similarity between both foldings, where most of the base pairs were correctly predicted. In fact all of the predicted stems are also present in the reference structure including the stem (positions 2025 and 220225) that is responsible for the pseudoknot. Yet some of the base pairs of the correct structure were not predicted. Since the applied grammar model only allows for stems consisting of at least three base pairs, the stems of length two in the reference structure are not provided by the predicted structure. The performance evaluation of this prediction led to an MCC value of 0.905.
Benefit of accounting for the evolutionary historyAs an example for the benefit of the extension presented in this work, the influence of phylogenetic information on the predictionWith the present analysis we want to treat the case that a reliable phylogeny is given, but in fact we had to reconstruct the phylogeny from the given data. To keep the risk of using an erroneous phylogeny as small as possible, we took the structural information given in RNase P Database into account in the phylogeny reconstruction. For this we used the software MrBayes (version 3.1.2;), which allowed us to apply the standard 4-state nucleotide substitution model for the loop regions and a 16-state doublet model for the stem regions. Corresponding to the F81 model () each partition model assumes the same rate for all of its substitutions. Convergence of the MCMC processes was examined with the program tracer (). Consensus trees were derived from sampled phylogenies, describing the evolutionary relationship of the subsets of the RNase P RNA molecules. This dataset made it possible to investigate the performance, provided that the correct alignment and phylogeny are known. The prediction results for this scenario are given in. We observed a performance improvement, which correlates with the amount of employed sequences. The first row shows the results examined by McQFold, whereas the other rows show the results determined by PhyloQFold. The performances, achieved by using only single sequences, differ between MCC values of 0.599 and 0.786 with arithmetic mean 0.707. Predictions based on two sequences achieved an arithmetic mean of 0.809, while the range is rather large with 0.226. In this category the lowest prediction(b)result is 0.699, which is still 33.22% superior to the worst singlesequence prediction. When three sequences were used, the lowest prediction result is given by a MCC value of 0.778, which is nearly as good as the best single-sequence prediction. The arithmetic mean is 0.848. The performance evaluation of the prediction based on all four sequences led to a MCC value of 0.905, which is an improvement of 28% compared with the arithmetic mean of the single-sequence prediction performances.
Performance comparisonWe compare PhyloQFold to other methods for inferring a consensus secondary structure from an alignment of RNA sequences. In thefield of approaches following this strategy, RNAalifold (version with RIBOSUM scoring;) and Pfold () are widely used programs. The program Pfold applies a SCFG model for secondary structures combined with an evolutionary model of RNA sequences, whereas RNAalifold implements a variant of the well-established dynamicprogramming algorithm from (). As these two programs are not able to deal with pseudoknots we also chose KNetfold () because it can also predict base pairs that violate the nested structure of other pairings. It uses k-nearest neighbor classifiers, mutual information and the fraction of complementary nucleotides of column pairs in a machine learning framework. The newest program in our comparison is IPKnot (version 1.2.1;). Moreover, we included SimulFold () because, like PhyloQFold, it follows a Bayesian MCMC approach. This comparison is based on the archaeal structure alignment from the RNase P Database by. The available 41 sequences were divided into 10 disjunct groups of size 4, while 1 sequence remained unaffected. For each group the corresponding structural alignment was extracted. Nine of these structural alignments form the test set, while one of them was not used, as it possesses 677 columns and is therefore too large for the current version of Pfold. Since PhyloQFold requires in addition a phylogenetic tree as input data, for each of these nine alignments the program RAxML was employed to estimate the phylogeny (). In SimulFold we chose the options-S-T to sample structures together with phylogenies while keeping the given alignment fixed. Up to this exception, all programs were applied with their default parameter settings. It should be noted that all the caveats mentioned by () also hold for this comparison.displays a direct performance comparison between PhyloQFold and the other programs for each test instance. In 40 out of the 45 comparisons PhyloQFold reached a higher prediction quality. Pfold supports for three test instances slightly better MCC values than those reached by PhyloQFold, whereas RNAalifold and SimulFold achieved for only one test instance a better MCC value. For all nine test instances KNetfold's and IPKnot's predictions are poorer compared with those of PhyloQFold. We also compared the performance of the different programs on alignments of RNAs whose secondary structures (according to the public databases) do not contain pseudoknots. For 35 alignments of nuclear yeast RNA sequences from the RNase P database, PhyloQFold achieved the best average MCC values. On four RNA P and tRNA alignments that had been used in the study of () only PFold and RNAalifold, which both assume the absence of pseudoknots, achieved better MCMC values than PhyloQFold, and for seven alignments of SPR RNA sequences () only RNAalifold and KNetfold showed a better average performance than PhyloQFold. Details on these comparisons are given in Section 5.2 of the online Supplementary Material.
G.Doose and D.Metzler
Simulation studyWe performed a simulation study to investigate the qualification of our model and the applied model parameters. By using the same model parameters for data generation as for the analysis of the prediction results, an impression of the performance potential of our method was provided. Furthermore, we applied the same programs used in Section 4.3 on the simulated data and compared their prediction results. For this purpose we simulated 50-folded alignments based on 6 arbitrary trees (see online Supplementary). Although each phylogeny compasses five sequences, they vary in their pairwise taxa distances from 0.006 to 1.8 time units. The length of the simulated alignments differ between 68 and 410 columns. Since the applied substitution models do not cover insertiondeletion modelling, the alignments were generated devoid of gap symbols. To take the ability of handling gaps into consideration, gaps were included in a postsimulation process where different probabilities (0.1 and 0.02) were applied to loop and stem regions in order to change each nucleotide into a gap symbol. We employed PhyloQFold, RNAalifold, Pfold, KNetFold SimulFold and IPKnot to the simulated alignments and compared the quality of their predictions. Again, the phylogenetic trees for PhyloQFold were estimated with RAxML and SimulFold was allowed to sample the phylogeny together with the secondary structures. We also applied PhyloQFold and SimulFold with the phylogeny fixed to the true tree used in the sequence simulation, and the results were only marginally different from those obtained with estimated trees (data not shown).The predictions were ascertained on a test set, which was simulated according to our model. All programs were used with their default parameter settings
CONCLUSION AND OUTLOOKWe have presented a method to sample consensus RNA secondary structures with pseudoknots according to their posterior probability. PhyloQFold, the implementation of our method, is able to incorporate the information given by the evolutionary history of a set of homologous RNA primary structures. We combined an extended SCFG with an explicit evolutionary model to define the prior probability distribution of structures. The results of the performance comparison for RNase P RNA data are very encouraging and suggest that PhyloQFold is indeed competitive with widely used approaches. But even MCC values around 0.9, which we observed in some of our analyses, imply that there is still some uncertainty in the inferred secondary structures. On synthetic data PhyloQFold performed significantly better than the other programs, which may partly be due to the fact that we generated the folded alignments according to our model. The mean of PhyloQFold's MCC values (0.712) together with the standard deviation in these values (0.112) indicate the need to assess the uncertainty of each prediction. For this purpose, PhyloQFold's Bayesian Sampling procedure calculates posterior pairing probabilities which give vital information about the reliability of the structure predictions. In Section 4.1 we have shown examples where PhyloQFold was capable of predicting pseudoknots (). This example has also shown, however, that the minimum length of stems of three, which is dictated by our grammar rules, can be obstructive. This issue could be avoided by using a refined grammar model. Moreover, as all our results were obtained without any parameter adjustment, there may be some potential for improvement by fitting the grammar parameters to available data. For SCFG models it is possible to compute ML estimators for model parameters from RNA sequences of unknown secondary structure by combining expectationmaximization with insideoutside algorithms (). For our grammar, ML estimation is more difficult even if trusted secondary structures are given. The reason for this is the ambiguity of our grammar. Each stem in a structure could either be a q-stem or a stem generated by the SCFG. One possibility to compute (and then numerically optimize) the likelihood of the grammar parameters would be to apply MCMC for sampling the contributions of many possible q-stem configurations. However, the fact that the grammar used in McQFold and PhyloQFold has only four free parameters makes it possible to estimate the parameters from summary statistics, as for example the numbers and lengths of loops, stems and pseudoknots in trusted secondary structures. We provide an example of such a summary-statistic-based parameter estimation procedure using Approximate Bayesian Computation () on the PhylpQFold homepage. However, given the good performance of PhyloQFold on RNase P RNA data, it may surprise in the simulation study in Section 4.4 that PhyloQFold was only slightly better than the other programs even though it was the only program that 'knew' the model and parameters underlying the simulated data. This indicates that the benefit of fitting the grammar parameters to data may be limited. As observed in Section 4.2, the information contained in the alignment and weighted by the phylogeny of the sequences seems to improve the quality of our structure estimations. But the alignment is of crucial importance and the dependency of the alignment quality implies the conceptual problem shared by all comparative approaches that are based on a fixed input alignment. In an application-orientated scenario, where no structural alignment is at hand, the use of structure-enhanced alignment programs like R-coffee () may be a good choice to estimate the input alignment. However, a more general solution to this problem would be to combine PhyloQFold with the Gibbs algorithm () of SimulFold () to sample from the joint distribution of alignments and secondary structures.
The Author 2012. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oup.com at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
