Motivation: RNA-Seq is increasingly being used for differential gene expression analysis, which was dominated by the microarray technology in the past decade. However, inferring differential gene expression based on the observed difference of RNA-Seq read counts has unique challenges that were not present in microarray-based analysis. The differential expression estimation may be biased against low read count values such that the differential expression of genes with high read counts is more easily detected. The estimation bias may further propagate in downstream analyses at the systems biology level if it is not corrected. Results: To obtain a better inference of differential gene expression, we propose a new efficient algorithm based on a Markov random field (MRF) model, called MRFSeq, that uses additional gene coexpression data to enhance the prediction power. Our main technical contribution is the careful selection of the clique potential functions in the MRF so its maximum a posteriori estimation can be reduced to the well-known maximum flow problem and thus solved in polynomial time. Our extensive experiments on simulated and real RNA-Seq datasets demonstrate that MRFSeq is more accurate and less biased against genes with low read counts than the existing methods based on RNA-Seq data alone. For example, on the well-studied MAQC dataset, MRFSeq improved the sensitivity from 11.6 to 38.8% for genes with low read counts. Availability: MRFSeq is implemented in C and available at
INTRODUCTIONNext-generation sequencing technologies have been widely used in genomics research. RNA-Seq, one of the most exciting applications of next-generation sequencing technologies, is used to reveal the complexity of tanscriptomes in biological systems (). Many unprecedented discoveries are being made by RNA-Seq, such as the inference of novel isoforms, characterization of the modes of antisense regulation and study of intergenic expression patterns (). In recent years, RNA-Seq has taken a major role in the quantitative analysis of gene expression and transcript variant discovery. In the past decade, most of these applications were dominated by microarray-based technologies. In these quantitative assays, RNA populations are partially sequenced and the obtained read sequences are aligned back to the reference genome. The aligned reads are then assigned to genes based on the common regions that they share in the alignment. The number of reads assigned to a gene is called the read count of the gene, which has been shown to be nearly linearly correlated with the expression level of a gene (). Differential gene expression analysis is to identify if genes express differently between biological conditions of interest. Given RNA-Seq read count data, detecting differentially expressed (DE) or equally expressed (EE) genes can be done by checking if the observed difference of the read counts is significant or not, i.e. greater than some natural random variation. To test the significance of the difference between RNA-Seq read counts, the distribution of read counts was first assumed to be Poisson in (). However, the Poisson distribution may underestimate the variance of read counts and cause unexpected false positives in differential gene expression analysis (). To solve the problem, negative binomial distributions were applied to RNA-Seq read data () and have become the state-of-the-art statistical model. Other than the methods based on the Poisson or negative binomial distributions, two data-driven probabilistic methods, baySeq () and NOISeq (), have also been proposed. Moreover, given annotated or inferred mRNA transcripts (or isoforms) of genes, some statistical methods for detecting differential expression at the transcript level have been published recently (). Because the expression level of a gene with known (or inferred) isoforms can be calculated by simply summing up the expression levels of its isoforms, these transcript-level methods can be used as alternative methods for detecting differential expression of isoforms (), although the accuracy of these methods clearly depends on the quality of the provided isoforms. Although the statistical properties of RNA-Seq data have been well studied and taken into account in the above statistical methods, these methods suffer from the following issues. First, it has been observed that statistical power increases with read count *To whom correspondence should be addressed. values (). Note that the read count of a gene is proportional to the gene expression level multiplied by the gene length. As a result, long or highly expressed genes are more likely to be detected as DE genes compared with their short and/or lowly expressed counterparts. This bias in DE gene detection is unavoidable even when normalization or rescaling is applied to read count data (). It is known that the selection bias on DE genes, if uncorrected, may lead to biased downstream analyses (). Second, the dependency among the expression of genes is not used in these methods. In gene expression analysis based on microarray data, the prior knowledge of gene coexpression patterns has been used to improve the performance of algorithms for detecting phenotype-related pathways (), searching for significant pathway regulators (), identifying differential gene expression patterns () and the classification of microarray data (). In particular, to obtain more accurate inference of DE genes, Wei and Li () proposed a Markov random field (MRF) model that integrates the gammagamma model based on microarray data () and gene coexpression networks extracted from KEGG pathways () such that DE genes can be determined by the maximum a posteriori (MAP) estimation of the MRF model. Their experimental results demonstrate that the additional gene coexpression information can help detect more subtle changes of gene expression (e.g. local disturbances within known pathways) and significantly improve the overall prediction accuracy of DE genes (). However, due to the difference between continuous microarray intensity values and discrete RNA-Seq read counts, The MRF model in () cannot be applied to RNA-Seq data immediately. Moreover, because the MAP estimation problem for an MRF model is generally NP-Hard (), the MRF model in () was solved by a heuristic method, iterated conditional modes, which provides an approximately optimal prediction with no confidence scores. In this work, we propose a novel MRF model, MRFSeq, combining RNA-Seq read counts with the prior knowledge of gene coexpression networks to infer DE genes. Different from the MRF model in (), we choose the clique potential functions of the MRF model carefully so that the MAP estimation of DE genes can be reduced to the wellknown maximum flow problem on flow networks based on the work of Kolmogorov and Zabih (). Because the maximum flow problem is polynomial-time solvable, our MRF model can be solved exactly in polynomial time. Moreover, we introduce a loopy belief propagation method () to calculate the confidence of each inferred DE or EE gene. Our extensive experiments on simulated and real RNA-Seq data demonstrate that MRFSeq achieves a much improved overall estimation performance by gaining considerable sensitivity without losing precision. A detailed analysis of the prediction results indicates that the DE genes predicted by MRFSeq are distributed more evenly across different values of read counts than those recovered by the existing methods using RNA-Seq data alone. Hence, MRFSeq can help alleviate the selection bias of DE genes against genes with low read counts. Our analysis further shows that most of the DE or EE genes that can be correctly predicted from RNA-Seq data alone are also correctly predicted by MRFSeq, implying that the use of the prior knowledge of gene coexpression does not introduce new biases in the differential analysis result. Moreover, we compare MRFSeq with a recently published transcript-level method, Cuffdiff 2 (), on the real RNA-Seq data using the annotated transcriptome from UCSC hg19 (). The comparison shows that MRFSeq is much more sensitive than Cuffdiff 2. The rest of this article is organized as follows. Section 2.1 defines the terms and notations used in our algorithms, while Section 2.2 provides the formulation of the MRF model and the design of its clique potential functions. The reduction to the maximum flow problem is shown in Section 2.3. The experimental results are described in Section 3, which also contains a comparison between MRFSeq and existing differential expression analysis methods including edgeR (), DESeq (), baySeq (Hardcastle and), NOISeq () and Cuffdiff 2 (). In particular, Section 3.4 compares the performance of the methods on genes with low read counts and shows that MRFSeq achieves not only an overall significantly higher accuracy but also provides a less biased prediction. A few concluding remarks are given in Section 4. The loopy belief propagation method for calculating the confidence level of each prediction as well as some figures and tables are omitted in the main text owing to page limit and are provided in the Supplementary Materials.
MATERIALS AND METHODS
Terminology and notationsLet G  fg 1 , g 2 , :::, g n g be the genes to be tested for differential expression and X  fx 1 , x 2 , :::, x n g the binary random variables such that each x i 2 f0, 1g indicates the DE state of gene g i. The random variable x i  1 if the gene g i is a DE gene and x i  0 indicates that the gene is an EE gene. Two random variables x i and x j are assumed to be correlated if the two genes g i and g j form a pair of coexpressed genes. A configuration x is a 01 assignment to the random variables X. Assume that there are p and q replicates in the two conditions, A and B, of interest, respectively. Let the read counts a i j and b i j be the number of the reads aligned to gene g i in the j-th replicate of the conditions A and B, respectively. For each gene g i , two sets of the read counts R A, i  fa i 1 , a i 2 , :::, a i p g and R B, i  fb i 1 , b i 2 , :::, b i q g are summarized from all the replicates of the two conditions A and B after mapping all the reads to the reference genome. Popular statistical measurements for the observed difference of read counts are the false discovery rates [FDRs, i.e. the p-value corrected for multiple testing ()] and prior probability. The current statistical methods infer DE genes by checking independently for each gene if the difference measurement of its read count exceeds a certain threshold (). In our method, DE genes are determined by the configuration that maximize a likelihood function of both observed difference of read counts and gene coexpression while no prior knowledge of the thresholds is required. MRFSeq uses, but is not limited to, the FDR q i from DESeq () as the difference measurement of the read counts R A, i and R B, i , where q i 2 0, 1. To improve the computational efficiency of our algorithm, the FDR q i is further discretized by binning the intervalintervals of the same length 0.05. Let y i 2 f1, 2,. .. , 20g denote the interval where the observed difference q i belongs to, and Y  fy 1 , y 2 , :::, y n g be, the collection of all the discretized FDRs. The joint probability of the hidden variables X given its observed values Y is then formulated by an MRF model, a graphical model capable of capturing the statistical dependency of random variables (), described in the next subsection. Given the joint probability of X conditional to Y, estimating the DE states of the genes actually involves two inference problems. The first is the MAP estimation problem, i.e. searching for a configuration x  such that Prx  jY is maximized. The algorithm for the MAP estimation problem will be discussed later in the section. The second is the marginal probability problem, i.e. computing the probability Prx i jY as a confidence level of the configuration on each gene g i. The loopy belief propagation method for the marginal probability problem is given in the Supplementary Materials.
MRF modelLet H  V x , E be an undirected graph representing the coexpression network for G such that every node v xi 2 V x is associated with the random variables x i 2 X and every edge i, j shared by the nodes v xi and v xj encodes the dependency of the two correlated random variables x i and x j. Two variables x i and x j are assumed to be correlated if the two genes g i and g j are coexpressed. To determine which pair of the genes are the coexpressed genes, the correlation coefficient c i, j defined in COXPREdb () is used as the measurement of gene coexpression between the two genes g i and g j. Two genes are considered as a pair of coexpressed genes if c i, j is greater than a threshold . We use  0:5 throughout this work because it is widely used in the literature (). In our model, we think that the DE state of each gene should depend on its observed difference in read counts and the DE states of its coexpressed genes. In other words, we can assume that every random variable is conditionally independent to the variables indexed by non-adjacent vertices in H. Hence, the following property is satisfied:Prx i jX  Prx i jx j , v xj 2 Nv xj , 1where Nv xj  represents the neighbors of v xi in H. By the Hammersley Clifford theorem (), a joint distribution of the random variables X given Y can be factorized as a form of clique potential functions T C C, the positive functions for configurations over cliques in the given graph H such that PrXjY  Q C2H T C C. To model the pairwise dependency between coexpressed genes, we may use an MRF model consisting of only potential functions for cliques of sizes at most 2. This type of MRF is called the pairwise MRF () and will be used in our work. There are two types of potential functions adopted in our MRF model. One is the unary functions i x i  that score how compatible the random variable x i is with its observed evidence y i. The other is the pairwise potential functions i, j x i , x j  that measure the statistical dependency between every pair of correlated variables x i and x j. By the definition of the potential functions, the joint distribution of X given Y can be written aswhere Z is the normalized term to assure that the joint probability PrXjY sums up to 1. Let P 1, i  Prx i  1jy i  and P 0, i  Prx i  0jy i . The unary function i x i  is defined as follows:To calculate the unary functions, the ratio between the two prior probabilities Prx i  1jy i  and Prx i  0jy i  should be given as a known parameter in our MRF model. To estimate the parameter, the read counts of four replicates (two per condition) for 10 000 DE genes and 10 000 EE genes are first synthesized. Our simulation of the read counts of the DE and EE genes follows the same steps as used in the simulation study of DESeq (). For the DE genes, the log 2 fold change rate of the observed read counts between two conditions is randomly drawn from the normal distribution with mean 0 and variance 0.7. For the EE genes, the mean is set to be 0 and the variance 0.2. After the simulation of read counts, the discretized FDRs introduced previously are calculated as the observed difference in the synthesized read counts. Assume that there are m yi DE genes and n yi EE genes whose discretized FDR is y i in this simulation. We further assume the equality of the two background probabilities of x i holds, i.e. Prx i  1  Prx i  0. By Baye's rule, the ratio of the prior probabilities is obtained as follows:Symmetrically, we have Prx i  1jy i =Prx i  0jy i   m yi =n yi. For the pairwise function i, j x i , x j  of every pair of coexpressed genes g i and g j , the correlation coefficient c i, j defined in COXPREdb () is used as the measure of the statistical dependency between x i and x j. The pairwise potential functions are thus defined as follows:This completes the specification of the joint distribution of X. To facilitate the presentation of our algorithms, the joint distribution of X can be rewritten by taking negative logarithm on both sides of Equation (2) as below:where is a constant, i x i   ln i x i  and i, j x i , x j   ln i, j x i , x j . EXjY is called the pseudo-energy function when each i is a unary term and each i, j is a pairwise term of the energy. A configuration maximizing the joint probability PrXjY is actually the configuration minimizing the pseudo-energy function EXjY ().
MAP EstimationDifferent from the heuristic method, iterated conditional modes, used to approximate the MAP of the MRF model of Wei and Li (2007), we show in this subsection that, by designing the potential functions in MRFSeq carefully, the MAP estimation problem for MRFSeq is no longer an NPHard problem because it can be reduced to the maximum flow problem on flow networks and solved optimally in polynomial time. A random variable x i is said to be inverted by a configuration x if the state assignment to x i violates its prior probability, i.e. x i  1 if Prx i  0jy i 4Prx i  1jy i  or x i  0 if Prx i  1jy i 4Prx i  0jy i . For an inverted random variable x i , i x i   0 instead of jln i 1  ln i 0j. We define jln i 1  ln i 0j as the cost of the inversion. Two correlated variables x i and x j are said to be separated by a configuration x if the assigned states of x i and x j are different, i.e. x i 6  x j. For a pair of separated variables x i and x j , i, j x i , x j   0 instead of c i, j. The cost of the separation is c i, j .proved that when the pairwise term i, j x i , x j  of the pseudo-energy function EXjY is submodular, that is, the following property is satisfied: MRF model can be reduced to the maximum flow (or minimum cut) problem over a flow newtwork H 0 such that a minimum cut of H 0 corresponds to a MAP estimation of the MRF model and the saturated capacity of the cut is exactly the total cost of the inversion and separation. It is easy to verify that our paiwise term is submodular. i, j 0, 0  i, j 1, 1 sums up to 2c i, j , where c i, j ! 0:5, while i, j 0, 1  i, j 1, 0 is 0. The reduction from our MRF model whose graph representation is H  V x , E to the flow network H 0  V x [ fs, tg, E 0  can be done as follows. The nodes of H 0 are the union of the nodes of H and two additional nodes, the source s and sink t. Every undirected edge i, j of H is transformed into two directed edges i, j and i, j with capacity c i, j. For every node x i , two directed edges s, i and i, t are added to E 0. The capacity of the edge s, i is jln i 1  ln i 0j if Prx i  1jy i 4Prx i  0jy i . Otherwise, the capacity of the edge s, i is 0. Symmetrically, the capacity of the edge i, t is jln i 1  ln i 0j if Prx i  0jy i 4Prx i  1jy i . Otherwise, the capacity of the edge i, t is 0. After running a standard maximum flow algorithm, e.g. the Edmond and Karp algorithm (), on the flow network H 0 , a minimum cut Q  fV s [ s, V t [ ftgg is obtained, where V s are the nodes adjacent to s and V t the nodes adjacent to t. It represents a 01 assignment such that all the random variables corresponding to the nodes of V s are assigned 1 and all the random variables corresponding to the nodes of V t are assign 0. Then, a gene g i is inferred as a DE gene if x i is 1, or an EE gene otherwise.
RNA-Seq DatasetsTwo publicly available human RNA-Seq datasets, the MAQC dataset () and Griffth's dataset (), will be used as the benchmark datasets to assess the performance of our selected differential gene expression analysis methods. Each of the dataset is associated with an additional qRT-PCR dataset to validate the DE states of genes. The MAQC dataset consists of two samples, Ambion's human brain reference RNA (brain) and Stratagene's human universal reference RNA. Each sample provides seven replicates and a total of 45 million single-end RNA-Seq reads of length 35 bp. The read counts for the MAQC dataset is obtained from 71 million uniquely mapped reads calibrated by ReCounts (). Griffith's dataset was made from the qRT-PCR validation for the DE or alternatively expressed genes highlighted by ALEXA-Seq (). It contains 96 and 198 million pair-end reads across two human colorectal cancer cell lines that only differ in fluorouracil resistance phenotypes. To equilibrate sequencing depth in both samples, as done in (), the read library size is set to be about 100 million reads per condition. Raw RNA-Seq reads of the MAQC dataset were downloaded from the SRA database (), while the RNA-Seq reads of Griffith's dataset were downloaded from the FTP site of the ALEXASeq Web site. The gene association across platforms was performed with BioMart (). Unmatched genes were discarded in downstream analysis steps. To obtain the read counts for Griffith's dataset, the raw RNA-Seq reads were aligned against the high-coverage assembly of the human genome UCSC hg19 () using Tophat () where two mismatches were allowed and reads mapped to multiple locations were removed. Finally, the read counts for each gene in Griffith's dataset were summarized by using the R packages GenomicFeatures and RSamtools from Bioconductor along with the genome annotation information from Ensembl (version 60) () and only exonic reads. For a fair comparison, a pseudo read count, 1, was applied to all genes with zero read counts to avoid the divided-byzero problem in some statistical calculations.
Evaluation MetricsFollowing the assessment method of, all our experimental results are evaluated in terms of precision (PRE), PRE  TP=TP  FP  100%, and sensitivity (SEN), SEN  TP= TP  FN  100%, where TP is the number of true positives, FP the number of false positives and FN the number of false negatives. To combine the two evaluation measures, the F-score (FS) (), defined as FS  2  PRE  SEN= PRE  SEN  100%, is used as a measure of the overall performance of a prediction method in our tests.
EXPERIMENTAL RESULTS
Selection of differential gene expression analysis methodsTo compare our method with the existing gene differential analysis methods, the same selection criteria proposed by Tarazona et al. (2011) was followed. However, Fisher's exact test (), which was compared in (), was excluded here because its performance was shown to be far lower than those of the other methods. At the end, four methods including edgeR (), DESeq (Anders and), baySeq (Hardcastle and Kelly, 2010) and NOISeq () were selected to be compared in our tests. Note that NOISeq has two versions, NOISeq_real and NOISeq_sim, and the version NOISeq_real is used in our experiments because numbers of replicates in our simulated and real datasets are always greater than one. Some reasonable cutoff values are required in these methods (except MRFSeq) to decide the significance of a statistical difference measurement. To obtain comparable performance analysis scenarios, the cutoff values adopted in the literature are applied in our experiments. More specifically, the FDR 0.1 chosen in DESeq is used for DESeq and edgeR. We choose the probability 0.8 and 0.999, as done in the work of, for NOISeq and baySeq, respectively. Experiments at two levels of difficulty are conducted to compare our method MRFSeq with the other selected methods. At the first level, all read counts of the benchmark datasets are generated from the same distribution as assumed in the simulation studies of DESeq. At the second level, all read counts of the genes are accumulated from the two real datasets, the MAQC and Griffith's datasets, and may contain low read counts. In addition to the comparisons with the gene-level methods, MRFSeq is also compared with the recently published transcript-level method Cuffdiff 2 on the two RNA-Seq datasets.
Simulation studies3.2.1 Simulation experiments Our simulation experiments follow the framework in (). All gene sets associated with the 186 KEGG pathways in MSigDB () were downloaded. The coexpression networks of the 186 gene sets were then defined using COXPREdb () and they formed 186 undirected graphs. A gene set was discarded if the number of the edges in its coexpression network is less than the number of the nodes. After the filtration, 37 gene sets consisting of 2194 different genes were kept. The 37 coexpression networks (see Supplementary) were merged as a global network consisting of 2194 nodes and 8512 edges. All the methods are tested at five different abundance levels of true DE genes. The performance assessment is categorized into five classes, where each class represents an abundance level interval of 10% such that the five classes cover abundance levels of DE genes ranging from 0 to 50% as done in (). At each of the five levels, we randomly choose 10 combinations of the pathways to form the sets of true DE genes, while keeping the rest of the genes as true EE genes, such that the percentage of the true DE genes is within the range of the level. The 10 different combinations form 10 benchmark datasets and read counts are randomly obtained by following the same steps for simulating read counts used in DESeq. The simulated read counts range from 25 to 401. All the methods are applied to the 50 benchmark datasets. Owing to the page limit, the performance assessment on the first interval [0,10) is summarized inand the complete assessment on all five intervals is presented in Supplementary Table S2. For the convenience of the reader, the precision-sensitivity curves are also provided in Supplementary.
Comparisonsof the methods on simulated data MRFSeq has clearly the best F-scores (i.e. the overall performance) and significantly improved sensitivity over the other methods. Its F-score is 14.2, 6.8, 6.8, 3.7 and 4.8% greater than the second best in the five interval, while its improvement on sensitivity is 13.6, 10.6, 9.1, 1.7 and 2%, respectively. Although baySeq provides close sensitivity scores in the intervals) and), it fails to obtain comparable precision scores and hence has an inferior overall performance. While achieving a considerable improvement on sensitivity in the interval [0,10), MRFSeq improves the precision by at least 6.9%. In the other four intervals, MRFSeq's precision is slightly lower than those of the other methods. The difference between the precision of MRFSeq and the best precision in these intervals is 2.3, 1.4, 2.2 and 1%, respectively, which are actually smaller than the standard deviations. The standard deviations of the sensitivity and F-score of MRFSeq are greater than the standard deviations of the other methods. This is because the performance of MRFSeq is somewhat correlated to the topological distributions of the true DE genes on the coexpression network. The amount of improvement achieved by MRFSeq may vary depending on the topological distribution. Nevertheless, the simulation results demonstrate that coexpression data could help improve differential gene expression analysis by increasing the coverage of true DE genes significantly.
Performance on real RNA-Seq data
Experimentson the MAQC dataset In addition to the previous simulation study, the performance for inferring DE genes is assessed on the MAQC dataset. Previously,tested the selected methods on different numbers of replicates (or lanes), from 2 replicates to 7 replicates per condition, in the MAQC dataset to see how sequencing depth would affect the performance of the methods. The results indicated that increasing the sequencing depth would decrease the precision of all selected methods except NOISeq. To compare the performance and understand how the precision of MRFSeq would change as the sequencing depth increases, the experiments designed by Tarazona et al. are used in our work. Different numbers of replicates are considered such that the read library size varies from 14 to 45 million reads in each of the two samples. The expression levels of the genes in the MAQC dataset were measured by the normalized threshold cycle values (CT) of qRTPCR. To validate the true DE genes of the MAQC dataset, a gene is defined as a true DE gene if the log 2 fold change ratio (LR) of its CT values is greater than a certain threshold b, e.g. 0.5 or 2, while a gene is a true EE gene if its LR is smaller than threshold a, e.g. 0.2 (). Any gene whose LR is between the two thresholds a and b is considered as a borderline gene. In the previous studies, all borderline genes were discarded (). Owing to the detection limitation of qRT-PCR, lowly expressed genes may be absent in some of the qRT-PCR assays. A gene that was detected in at least one of the qRT-PCR assays would also be removed if it failed to appear in at least three-fourth of the qRT-PCR assays (). Different from the previous studies, we do not throw away those borderline genes. To further test the inference power on genes with low read counts, lowly expressed genes are also kept in our experiments. This gives us a total of 836 genes. We define a gene as a true DE gene if its LR is larger than the threshold b. Otherwise, the gene is a true EE gene. There are 669 true DE genes when the threshold b is set to be 0.5 and 373 true DE genes when b is 2.0. The coexpression network of the 836 genes forms a graph of 836 nodes and 2426 edges. All the methods are tested at these two different abundance levels (or LR values) of DE genes. The prediction results are again assessed in terms of precision, sensitivity and F-score as summarized in.
Comparisonof the performance on the MAQC dataset Similar to the results in the simulation study, MRFSeq achieves significantly improved sensitivity scores and F-scores at both abundance levels of true DE genes. The improvement on sensitivity is at least 9.2 and 8.8% for all sequencing depths considered when b  0.5 and 2, respectively. While achieving the best sensitivity scores, the precision scores of MRFSeq are also comparable with the precision of the others except NOISeq who exhibits extremely high precision. Note that although NOISeq has the best precision among all methods, its sensitivity is much lower than the scores of the others and its overall performance (as measured by F-score) suffers from this. As the sequence depth increases, the precision of NOISeq remains stable while all other methods lose some precision. The precision of DESeq drops 4.0 and 4.7%, respectively, for the twovalues of b, when the number of replicates increases from two to seven. The decrease in precision is 5.4 and 6% for baySeq, while edgeR loses 2.0 and 2.6%. At the same time, the precision of MRFSeq only decreases 1.6 and 2.8%. The relative small loss of the precision for MRFSeq can be explained by the fact that many false positives, if not predicted at a strong confidence level, could be eliminated by MRFSeq using the coexpression information. Hence, these results on the MAQC dataset show that coexpression information not only helps gaining more coverage of the true DE genes but also keeps precision relatively stable against the increase of sequencing depth. Moreover, it could help reduce our reliance on deeply covered RNA-Seq data in differential gene expression analysis.
Performance on genes with low read counts
Genes with low read countsTo understand how the methods perform on genes with different read count levels, the prediction on the real datasets is further analyzed. The genes in the datasets are separated into two classes, genes with low read counts and genes with decent read counts. In (), a gene is said to have a low read count if it has fewer than 10 reads in every replicate of the two conditions. Otherwise, the gene is said to have a decent read count. Because Griffith's. Performance assessment at various sequencing depths. The X-axis shows the number of used lanes and the Y-axis indicates various assessment measures. In the upper row of plots, the LR threshold b is set as 0.5 and in the lower row b  2.0. Plots (a) and(d) compare the precision scores at different sequence depths. Plots (b) and (e) depict the sensitivity scores, while plots (c) and (f) illustrate the F-scores dataset contains only genes with decent read counts, we consider the MAQC dataset only below. Among the 836 genes in the MAQC dataset, there are 453 genes with low read counts and 383 genes with decent read counts. The methods baySeq and NOISeq provide an additional option for normalizing gene lengths. These two methods with normalized gene lengths are denoted as baySeq len and NOISeq len , respectively. To further study the effect of the normalization on genes with low read counts, baySeq len and NOISeq len are also applied to the MAQC dataset. By choosing a threshold of b  0:5 for the LR values, the prediction results on genes with low read counts by different methods are compared in. The detailed numbers of true and predicted DE genes with low or decent read counts are listed in Supplementary Table S4.
Significant improvement on genes with low read countsOn the genes with low read counts, the sensitivity of MRFSeq is 38.8%, while the second best sensitivity is only 11.6%. Similarly, MRFSeq achieves an F-score of 53.3%, while the second best F-score is only 20.4%. In addition to these significant improvements, the prediction of MRFSeq shows a more balanced pattern between genes with low read counts and genes with decent read counts. The RTP l=h of MRFSeq is 43.1% while its RPP l=h is 42.7%. The second best RTP l=h and RPP l=h are only 13.0 and 13.3% (obtained by edgeR). This result shows that all the other methods are biased against genes with low read counts. Most of their predicted DE genes are from the genes with decent read counts. After applying the normalization of gene lengths on genes with low read counts, the performance of baySeq and NOISeq is slightly improved. However, the length normalization does not really improve the overall performance on genes with low read counts much or correct the selection bias.
Comparison with Cuffdiff 2Different from gene-level methods that use raw read counts, Cuffdiff 2 requires the mapping of reads to the given transcripts of genes as input to call differential gene expression (). To assess the performance of Cuffdiff 2 on the MAQC and Griffith's datasets, the RNA-Seq reads of the two real datasets are mapped to the annotated transcriptome UCSC hg19 using Tophat as done in (). The same threshold 0.1 for the FDR values is used to call DE genes for Cufflink 2. The prediction accuracies of MRFSeq and Cuffdiff 2 on the two datasets are summarized in Supplementary Table S5, with the LR threshold b  2 and the cutoff P-value 0.05 for the MAQC and Griffith's datasets, respectively. The precision-sensitivity curves also are illustrated in Supplementary. The table shows that MRFSeq has a significantly better F-score (and thus overall performance) by achieving a higher sensitivity, while Cuffdiff 2 achieves a better precision. The precision-sensitivity curve also suggests that MRFSeq has a better overall performance than Cuffdiff 2 when we consider the full spectrum of FDR or restricting the FDR value to at most 0.1. A detailed analysis shows that Cuffdiff 2 predicts fewer true DE genes with relatively small LR values than MRFSeq. In the MAQC dataset, there are 290 true DE genes with the LR values from 0.5 to 2. The prediction of MRFSeq covers 171 of the 290 genes, while Cuffdiff 2 can only detect 140 of the true DE genes. In Griffith's dataset, 9 true DE genes are associated with P-values, which measure the significance of the difference between the LR values, from 0.005 to 0.001. All of the 9 true DE genes are predicted by MRFSeq, but Cuffdiff 2 could only identify 4 of the DE genes. This result is consistent with the discussion in (). In general, Cuffdiff 2 may report fewer DE genes with relatively low LR rates because of its control of variance in expression owing to fragment count uncertainty.
Consistency of predictions by DESeq and MRFSeqA gene is defined to be incorrectly inverted if its DE state is correctly predicted by using RNA-Seq data alone but incorrectly predicted by MRFSeq. Although our above results demonstrate that using the prior knowledge of gene coexpression significantly improves the overall accuracy of differential gene expression analysis and helps to alleviate the bias against genes with low read counts, it raises the question if the prior knowledge might introduce some new prediction biases. In this subsection, we estimate the number of incorrectly inverted genes in the prediction of MRFSeq compared with prediction by a popular RNA-Seq based method DESeq and analyze the types of genes in coexpression networks that are more likely to be incorrectly inverted. The detailed prediction results of DESeq and MRFSeq on our above simulation and real datasets are compared. In the 40 simulation benchmark datasets, only 3092 of the 73 619 (4.2%) correctly predicted genes by DESeq are incorrectly inverted by MRFSeq. In the MAQC and Griffith's datasets, only 16 (3.5%) and 0 (0%) genes correctly predicted by DESeq are incorrectly inverted by MRFSeq, respectively. Generally, most of the correctly predicted genes by DESeq remain correct in the MRFSeq prediction. Moreover, we observe that the incorrectly inverted genes tend to have higher edge degrees in gene coexpression networks than the other genes. The comparison of the average edge degree of all genes and that of the incorrectly inverted genes in gene coexpression networks is shown in Supplementary. The significance of the difference between the edge degrees is confirmed by using one-tailed t-test (). The P-value of the t-tests on the simulation and MAQC datasets are 5:1  10 14 and 5:1  10 4 , respectively. However, as genecoexpression networks usually possess the well-known scale-free property, only a small number of genes have high edge degrees (). This property should limit the number of incorrectly inverted genes, and thus most of the DE or EE genes correctly predicted based on RNA-seq data alone (by, e.g. DESeq) are well preserved in the result of MRFSeq.
CONCLUSION AND DISCUSSIONIn this work, we have proposed a new statistical method, MRFSeq, that combines both RNA-Seq data and coexpression information and obtains a MAP estimation of the DE/EE genes efficiently. The discussion of the improvement benefits from our graphical model is provided in Section 1.3 of the Supplemmentary Materials. Using extensive experiments on both simulated and real data, we have shown that MRFSeq is able to take advantage of coexpression information and this additional piece of information can help provide a more accurate and less biased differential gene expression analysis. Clearly, our improved performance (especially on genes with low read counts) critically depends on the existence of a high-quality gene coexpression network (See the discussion in Section 1.4 of Supplementary Materials.) Finally, MRFSeq uses the DE analysis results of DESeq. It would be interesting to study how MRFSeq performs when the DE analysis results of other tools are used instead. Section 1.5 of Supplementary Materials compares the performance of MRFSeq with the variant where NOISeq is incorporated. We plan to make MRFSeq flexible so it can be combined with any DE analysis tool in the near future. Our experiments used COXPREdb (), which consists of coexpression data for seven model organisms. One could also consider using other sources of coexpression data such as ACT (), ATTED-II (), CSB.DB (), CoP(), etc. or constructing custom gene coexpression networks from publicly available expression data such as GEO (http://www.ncbi.nlm.nih.gov/geo/), ENCODE (http:// encodeproject.org/ENCODE/), modENCODE (http://www. modencode.org/), etc., especially for organisms (or tissues) not covered by COXPREdb. Moreover, the threshold used for extracting pairs of coexpressed genes from a given gene coexpression network may also have an impact on the performance of our algorithm. We set  0:5 empirically in our experiments based on the literature () and some preliminary tests on the MAQC data. Clearly, a higher may decrease the sensitivity of MRFSeq, while a lower may decrease the precision of MRFSeq. We plan to explore the impact of different coexpression networks (including the choice of ) on the performance of MRFSeq and study automatic methods for choosing an optimal in future work.
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
i, j 0, 0  i, j 1, 1 ! i, j 0, 1  i, j 1, 0, 7 searching for a configuration that minimizes the pseudo-energy function can be done by looking for a configuration minimizing the total cost of inversion and separation. That is, the MAP estimation problem on an
MRFSeq at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
E.-W.Yang et al. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
.3.3 Taking confidence scores into consideration Like the FDRs of DESeq and edgeR or the prior probability of baySeq and NOISeq, MRFSeq estimates the confidence (i.e. marginal probability) for each predicted DE gene and a confidence threshold can be applied to select DE genes for the output (instead of following the MAP estimation algorithm). We are interested in the performance of MRFSeq on the MAQC dataset when different thresholds are applied to the confidence. To calculate the confidence scores, the loopy belief propagation algorithm is run on all seven replicates in the MAQC dataset. To compare the performance of MRFSeq with the other methods, a precisionsensitivity curve where each point represents the precision and sensitivity under a certain threshold, is depicted for each of the selected methods, as done in (Tarazona et al., 2011). To depict the precision-sensitivity curves for DESeq and edgeR the range of the FDR threshold from 10 6 to 1 is selected. Note that this range for FDR cutoffs covers all the threshold values used in practice and these FDR thresholds yield sensitivity values between 45 and 100%. For the other methods that do not use FDRs, equivalent thresholds that lead to sensitivity within the same range, i.e. 45100%, are applied to draw the precisionsensitivity curves. The precision-sensitivity curves in Supplementary Figure S2 show that, in general, MRFSeq provides more accurate confidence scores than the other methods. Note that unlike the MAP estimation algorithm, using the marginal probabilities obtained by the loopy belief propagation algorithm to infer DE genes requires additional knowledge to choose an approproate confidence (marginal probability) threshold. Besides, the loopy belief propagation algorithm is a heuristic and thus does not guarantee correct marginal probabilities. Hence, MRFSeq uses the MAP estimation to select DE genes and the loopy belief propagation algorithm only to estimate the confidence score of each selected DE gene. 3.3.4 Comparisons of the performance on Griffith's dataset The qRT-PCR data of Griffith's dataset consists of 193 exon assays on 94 protein coding genes. Different from the LR of the MAQC dataset, a two-tailed t-test was applied to identify the true DE genes from the qRT-PCR data of Griffith's dataset. A P-value of the t-test was considered significant if it is smaller than 0.05 (Griffith et al., 2010). Under this criterion, 83 true DE genes and 11 true EE genes are identified and used in testing the selected methods. The coexpression network of the 94 genes extracted from COXPREdb forms a graph of 94 nodes and 25 edges. The performance of the methods on Griffith's dataset is shown in Supplementary Table S3. MRFSeq still has the best overall performance, although its improvement over the other methods is not as significant as on the MAQC data. Please see the Supplementary Materials for a detailed discussion.
