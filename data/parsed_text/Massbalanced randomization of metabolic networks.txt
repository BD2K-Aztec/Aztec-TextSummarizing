Motivation: Network-centered studies in systems biology attempt to integrate the topological properties of biological networks with experimental data in order to make predictions and posit hypotheses. For any topology-based prediction, it is necessary to first assess the significance of the analyzed property in a biologically meaningful context. Therefore, devising network null models, carefully tailored to the topological and biochemical constraints imposed on the network, remains an important computational problem. Results: We first review the shortcomings of the existing generic sampling scheme—switch randomization—and explain its unsuitability for application to metabolic networks. We then devise a novel polynomial-time algorithm for randomizing metabolic networks under the (bio)chemical constraint of mass balance. The tractability of our method follows from the concept of mass equivalence classes, defined on the representation of compounds in the vector space over chemical elements. We finally demonstrate the uniformity of the proposed method on seven genome-scale metabolic networks, and empirically validate the theoretical findings. The proposed method allows a biologically meaningful estimation of significance for metabolic network properties. Contact
INTRODUCTIONThe advances in omics technologies and algorithmic techniques for analysis of high-throughput data have placed network-based integrative studies in the focus of systems biology (). The promise of network analyses lies in the possibility to devise genome-scale representations of biological systems for predictive analyses. However, the statistical significance of any prediction must be validated in a biologically meaningful context using an appropriate null model. The seminal work of () directed complex networks research toward revealing the unifying properties of biological networks, starting from metabolic () to gene regulatory () to proteinprotein networks () and their integrated variants (). Despite the identification of simple * To whom correspondence should be addressed. mechanisms by which these networks may arise and evolve, such as the preferential attachment of newly added nodes (representing genes, proteins, reactions or metabolites) to already highly connected ones, the advantage of such approaches to answering biological questions remains debatable. Nevertheless, this direction in network research has resulted in the discovery of salient properties of biological networks, i.e. properties which show similar trends for a wide variety of networks from different cells, tissues and species. Some of these properties include: scale-free (i.e. power-law) degree distribution, large clustering coefficient, small average path length, degreedegree correlation, different behavior of various centrality measures and the distribution and overrepresentation of subnetworks, known as motifs (). The studies following the work of Barabsi and Albert have attempted to relate the salient properties of biological networks to their functionality (). However, it is often the case that the detection of novel salient properties of complex biological networks and determination of their statistical significance is based on a generic null model, which may result in misleading conclusions and, consequently, in inappropriate biological reasoning (). Network null models are essential for establishing the significance of any prediction obtained from a network representation of a biological system. A randomization procedure allows for sampling from the (usually large) space of networks from a null model, and for estimating the statistical significance empirically. A P-value of a given property is usually calculated based on the following procedure: (i) determine the chosen property from an investigated biological network, (ii) sample a large number of random networks which have a similar structure to that of the analyzed network and (iii) estimate the mean and variance of the property from the simulated networks to calculate a z-score and P-value under the assumption of normal distribution. Without this assumption, in principle, step (iii) requires determining the distribution of values for the property under the considered network null model. Clearly, the P-value of a property strongly depends on the sampling procedure and structure of the network null model. Therefore, any network-based analysis is prone to detecting statistically significant properties due to an ill-posed null model (). Finally, a null model strongly and ultimately depends on the type of analyzed network. For instance, gene regulatory networks include directionality, while proteinprotein interaction networksPage: 1398 13971403
G.Basler et al.are undirected; signal transduction and metabolic networks are directed hypergraphs (representable as bipartite graphs) (), whereas metabolic networks include stoichiometry and biologically meaningful node labels (representing chemical structure). Thus, a common randomization procedure, which samples from a generic network null model, is unlikely to resolve the problem of relating the properties of different classes of networks to their biological function. Despite these observations, many network-based studies e.g. () do rely on a common reference frame for all biological networks, called switch randomization. According to switch randomization, a randomized network is obtained from a given network by shuffling its edges while ensuring that the number of (incoming and outgoing) edges of every node remains unchanged. This can be achieved by the switch operation, whereby a randomly chosen pair of edges, (u,v) and (x,y), is replaced by two other edges, (u,y) and (x,v), provided that they do not already exist in the network. Switch randomization ensures that the probability of two nodes being connected is effectively independent of their distance in the original network. However, there are contradicting results with regard to whether the generated networks are sampled uniformly from the ensemble of networks with preserved degree distribution (Artzy). The underlying assumption of switch randomization is that the distribution of incoming and outgoing edges sufficiently characterizes the constraints under which networks of the analyzed type evolve. While this assumption may be valid on, e.g. gene regulatory networks, where the number of regulatory targets of a gene is a principle constraint, completely different constraints permeate the evolution of metabolic networks. For illustration, consider the following two metabolic reactions: glucose isomerase (glucose  fructose) and maleate isomerase (maleate  fumarate). After applying switch randomization, we may obtain: glucose  fumarate and maleate  fructose, which is chemically infeasible due to the violation of the preservation of mass, since the corresponding chemical equations are C 6 H 12 O 6  C 4 H 2 O 4 and C 4 H 2 O 4  C 6 H 12 O 6. In the metabolic networks we analyzed, 99.8% of the reactions are unbalanced after applying switch randomization. By disregarding this fundamental principle, the generated networks are able to consume and produce matter out of nothing, yielding them incomparable to metabolic networks. Establishing the statistical significance of a network property, mediated through a common, yet inappropriate reference frame, may result in the erroneous detection of significant properties, leading to questionable biological hypotheses. Therefore, the techniques for establishing suitable null models and randomization procedures need to be developed further, before making any statements about their biological importance. Recent work of () on estimating the overrepresentation of motifs is a first step toward a network null model tailored to a particular set of real-world biological networks (therein, proteinprotein interaction networks). Motivated by the shortcomings of the switch randomization and the lack of a network null model for metabolic networks which includes directionality, topological salient properties and biochemical constraints (e.g. reaction degrees and preservation of mass in biochemical reactions), here we present a method for randomizing metabolic networks. Our randomization procedure is based on the notion of mass equivalence classes for compounds and can be used to estimate the significance of a given topological property with respect to its importance in chemically constrained biological systems. Moreover, we show that our procedure samples a randomized network uniformly at random, which is another important requirement for any network sampling scheme. For the empirical validation of our results, we use the metabolic networks of seven organisms from all kingdoms of life: (i) Bacillus subtilis (), (ii) Saccharomyces cerevisiae (), (iii) Escherichia coli from iAF1260 () and(iv) EcoCyc (), (v) Chlamydomonas reinhardtii (), (vi) Arabidopsis thaliana () and (vii) Homo sapiens () (network properties are shown in Supplementary).
APPROACHA metabolic network is represented as a directed bipartite graphwhere V c is the set of compound nodes, V r the set of reaction nodes and E  (V c V r )(V r V c ) is the set of directed edges denoting substratereaction and productreaction relationships. For a compound c  V c , we denote by m c  N n its mass vector, i.e. the vector representation of c over n chemical elements. For instance, one may consider only the six most abundant elements in biological systems (): carbon (C), hydrogen (H), nitrogen (N), oxygen (O), phosphorus (P) and sulfur (S). The mass vector of water is then m H 2 O = (0,2,0,1,0,0)(C,H,N,O,P,S) T. For a given reaction r, r in ={c  V c | (c,r)  E} denotes the set of substrates, and r out ={c  V c | (r,c)  E}, the set of products. We abbreviate the expression c  r in r out by c  r, and write d(r) = |r in |+|r out | for the degree of r (we omit the definition of compound degree, as it is not required for our purpose). Reversible reactions are represented by one reaction node for each direction:Furthermore, let s c,r  N + be the stoichiometric coefficient of a substrate (product) c of reaction r. A reaction is mass balanced, i.e. chemically feasible with respect to the conservation of mass, if and only if the sum of its substrate atoms equals the sum of its product atoms:In order to uniformly randomize a network while preserving mass balance, each possible mass-balanced network has to be generated with equal probability. This requires enumeration of all possible sets of substrates and products, for which Equation (1) is satisfied. A special case of this problem is to find all possible partitions of a set of integers, which sum up to 0 (which, in turn, is a special case of the Knapsack problem, see (). As a consequence, the number of possible mass-balanced networks is at least exponential in the number of compounds. We approach the complexity of the general problem by restricting the set of possible solutions to Equation (1) 2-fold: (i) the inand out-degrees of reactions are preserved and (ii) the substitution of compounds is limited to certain subsets, as detailed below, which allows to easily find a solution for Equation (1). The first restriction is in line with the observation that reaction degrees are biochemically constrained by the number of interacting compounds. The second allows to divide the randomization procedure into a precalculation step and an actual randomization. As a result, thePage: 1399 13971403Each mass vector is a multiple of a scalar and the basis vector (1,2,0,1,0,0). generation of a large set of mass-balanced randomized networks becomes computationally feasible. We now move to the description of our randomization procedure including the above-mentioned restrictions. Our procedure depends on determining the classes of linearly dependent mass vectors. Two compounds c,k  V c will be called mass equivalent if and only if their respective mass vectors m c and m k are linearly dependent.The sum of mass vectors for each pair is a multiple of a scalar and the basis vector (6,8,0,9,1,0).Page: 1400 13971403
Mass-balanced randomization
G.Basler et al.
Randomization algorithmThe algorithm consists of two steps: in the first step, for a given metabolic network G, the mass equivalence classes are generated from the set of compounds V c (G). This step is to be executed only once for all subsequent randomizations of the same network. In the second step, the reactions of G are randomized while preserving mass balance. To randomize a reaction, chosen uniformly at random from V r (G), substrates and products are replaced by randomly chosen substitutes from their corresponding mass equivalence classes. In addition, this substitution entails recalculation of the stoichiometric coefficients to guarantee the preservation of mass balance. The output from this step is a network in which stoichiometric coefficients are changed, edges are replaced and, consequently, the degrees of the compounds are altered, while the reaction degrees and mass balance of all reactions are preserved (see Supplementaryfor an overview and comparison to switch randomization). Let (c) denote the mass equivalence class of a compound c and (c,k), the mass equivalence class of a pair of compounds (c,k). Given a reaction r, a substrate (product) c of r will be called substitutable in r by a compound c  V c , denoted by c  r c , if and only if the following two conditions are satisfied: @BULLET (S1) the compounds are mass equivalent, i.e. c  (c) and @BULLET (S2) the substitute c is not already a substrate (product) of r.Similarly, we define a pair of substrates (products) (c,k)  (r in r in ) (r out r out ), c = k, to be substitutable in r by a pair of compounds (c ,k ),), if and only if the following three conditions hold:@BULLET (P2) neither c nor k is already a substrate (product) of r and @BULLET (P3) there are stoichiometric coefficients s l,r  N + ,l  r for the new reaction r , such that Equation (1) is satisfied.Note that substitutability, in contrast to mass equivalence, is defined over substrates and products of a reaction, such that a substitution only affects either the substrates or the products of one reaction. In addition, conditions (S2) and (P2) imply c = c, such that each substitution results in a reaction r = r (i.e. substitutability is irreflexive). In order to choose a particular substitution for a given reaction r uniformly at random, the set of all possible substitutions for r has to be determined. Let the set of substitutions of individual compounds be denoted by s (r), and the set of substitutions of pairs of compounds be denoted by p (r). According to the above definitions, these sets are then given byThe combined set of all possible substitutions for r is then given by (. Note that substitutability is symmetric, i.e. any substitution can be reversed, as we can always replace the substitutes and their stoichiometric coefficients by those of the original reaction.Proof. Suppose the substitutions of individual compounds (c,c ) and(k,k ) in r both result in the same reaction r. Then, c  r and k  r imply that c  r and k  r, which contradicts condition (S2). By condition (P2), this holds analogously for the substitution of pairs of compounds. Suppose the substitution of individual compounds (c,c ) results in the same reaction r as the substitution of a pair of compounds (k,l,k ,l ). Then, either k  r or l  r, both contradicting condition (P2).In the following, we analyze the algorithm for randomizing metabolic networks: For a reaction r, chosen uniformly at random, the set of possible substitutions for all substrates, products and pairs of substrates or products in r is generated, in order to then choose one substitution uniformly at random (see Algorithm). The stoichiometric coefficients in r are recalculated (line 6) by finding positive integers s l,r  N + ,l  r satisfying Equation (1). For the substitution of an individual compound (c,c ), such coefficients can always be found, due to the linear dependence of the mass vectors: s c ,r is obtained as 1
m cs c,r m c. If s c ,r is a non-integer a/b, then all coefficients of r are multiplied by b. Recalculation of the stoichiometric coefficients for the substitution of pairs of compounds requires solving a system of n linear equations with two unknowns. In case there is no solution, the substitution is not carried out.shows examples of possible substitutions (details of the algorithms can be found in the Supplementary Material).
Algorithm: Mass-balanced randomization of metabolic networksInput: Mass-balanced metabolic network,Note that the number of reactions in G as well as the in-and out-degrees of perturbed reactions are not changed by the algorithm. Since both directions of a reversible reaction are considered independently, reversibilities can optionally easily be preserved by choosing only forward reactions in line 1, and updating the reversed reaction accordingly after line 6. Due to the consideration of all pairs of compounds, the time complexity for precalculating the mass equivalence classes is in O(|V c | 2 ). However, this step is executed only once for any (usually large) number of subsequent randomizations of the same network. For the randomization procedure, choosing a reaction and a substitution uniformly at random (lines 1 and 3) and replacing edges (lines 4 and 5) can be performed in constant time. Determining all possible substitutions for a reaction r (line 2) requires retrieving the precalculated mass equivalence class of each substrate, product and each pair of substrates or products, which is in, for each mass equivalent compound or pair of compounds, one has to determine whether they are already substrates or products in r, and whether there exist stoichiometric coefficients satisfying Equation (1), in order to obtain (r). The latter requires solving a system of n linear equations with two unknowns, which is in O(n), such that the solution can be used in line 6. Hence, line 2 is in O(d(r) 2  max n), where  max is the size of the largest mass equivalence class, and line 6 can be executed in constant time. Therefore, the algorithm has time complexity in O(t ( 2  max n)), where is the maximum reaction degree of G. Note that and n are bounded by small constants:  17, n  23 and  max  780 in the investigated networks.
Uniformity of samplingAny algorithm for randomizing a combinatorial structure should guarantee that every random instance is generated with equal probability. In other words, the probability distribution over the space of possible combinatorial structures must converge to the uniform probability distribution. Otherwise, the properties of the sample space would be biased toward those of more frequently generated networks, and, consequently, the significance assigned to any property would be questionable. Here, we show that our proposed algorithm for randomizing metabolic networks indeed has this property on the class of metabolic networks randomized via substitutions of single compounds and pairs of compounds (with mild assumption for the latter). To establish this result, we rely on a transition graph G , in which a node represents a network that can be generated by our algorithm, and two nodes are connected by an edge (u,v), if there exists a substitution in u generating v. The given metabolic network to be randomized is denoted by. The set of networks obtained after applying t substitutions to G 0 is denoted by t ={G t i | i = 1,...m,m  N + }. Note that, due to the symmetry of the substitutability relation, G is undirected (i.e. each edge corresponding to a substitution can be traversed in both directions). Moreover, since each node in the transition graph G corresponds to a network obtained after applying t substitutions starting from G 0 , the transition graph G is connected. Applying the randomization algorithm is equivalent to a random walk on G , starting at G 0. Therefore, we use the existing results from the theory of random walks on graphs. The classical theorem for uniformity of random walks on graphs (see () states that, for any non-bipartite regular transition graph G , a random walk using transition probabilities, 1/d(u),, is stationary, i.e. the probabilities for stopping the random walk at a node after any number t of transitions do not change with t . Therefore, to prove the uniformity, we show that G is (almost) regular, i.e. the degree distribution of G is (almost) uniform. We first show the uniformity of our method if only individual compounds are allowed to be substituted. Given a metabolic network G 0 , for any reaction r  V r the number of possible substitutions of individual compounds in r, it follows that each substitution corresponds to a unique edge in G. Therefore, the degree of G 0 in the transition graph isTheorem 1. If only individual compounds are allowed to be substituted, then G is regular.Proof. To establish the claim, we need to show that dfor any number of substitutions t  N. Note that the number of reactions |V r | and their degrees remain unchanged. Therefore, it suffices to show that the number of possible substitutions for a reaction r does not change after substituting a compound. Let x be a substrate (product) of a reaction r and let x  r y, i.e. y  (x) and y is not already a substrate (product) of r. The symmetry of mass equivalence implies x  (y). The possible substitutions for x are then the same as the possible substitutions for y after replacing x in r by y, except that x  r y is replaced by y  r x in the new reaction r. For any substrate (product) z = x,, then the transitivity of mass equivalence implies z  (y). Thus, the substitutions for z do not change, except that z  r y is replaced by z  r x [as y is a substrate (product) of the new reaction r ]. On the other hand, ifimplies that the substitutions for z do not change after substituting x in r by y. Thus, we have d, and the sampling is uniform.The more general case, on which our algorithm is based, considers substitutions of both individual compounds and pairs of compounds. In this case, due to changes after applying a substitution, G may not be regular. To illustrate this point, for a reaction r, if a substrate c is substituted by a compound x, we may subsequently substitute the pair of substrates (x,k), where k is any other substrate of r. The possible substitutions)}, may be different from the possible substitutions for (x,k) in the new reactionSimilarly, the possible substitutions for individual compounds may change after substituting a pair of compounds. Consequently, the sizes of substitutability classes s (r) and p (r) may differ from the sizes of s (r ) and p (r ), so that two nodes in G may have different degrees. In the following, we analyze the probability that the algorithm samples nodes from G almost uniformly at random. Let us consider a random walkon G , starting at node G 0. Let Y i be the non-negative random variable whose value is the absolute value of difference of degrees between two neighbors G i and G i+1 on the walk, i.e.We assume that all Y i are independent and identically distributed variables, with probability density function P(a positive constant C. Since all networks and the number of possible substitutions are finite, this distribution exhibits a finite mean. A sequence of randomwhere the expected value of X t is determined by X t1 , is called a martingale (). Then, the sequencemartingale, and, in particular,). Furthermore, let B j denote the event that |Xis the probability that the absolute difference between expected and actual degree changes in step j of the random walk on G exceeds some c j > 0. By a result of () (Theorem 8.3), the following generalized Azuma inequality holds for the probability that degree changes differ at least by  from the expected degree changes after t steps:where B = B t. Let  denote the expected degree difference of adjacent nodes, i.e.shows the power-law fit with a scaling coefficient of   1.87. The mean difference is   7.14 (see Supplementaryfor the remaining organisms). (B) Sojourn frequencies of a random walk on the transition graph of the TCA cycle (equivalent to a randomization of the TCA cycle). For 10 5 steps, the SD of sojourn frequencies is   10.8, yielding a coefficient of variation of 0.113 (grey line); after 10 6 steps, we have   34.6 and a coefficient of variation of 0.038 (black line), confirming that the probability distribution over the 1024 networks converges toward the uniform distribution.). Therefore, the probability that the degree difference between neighbors is larger than the expected difference can be expressed as P(B) = P(Y >)   1. We then have the following claim:Proof. By invoking Equation (4) with c j = , 2 t j=1 c 2 j = 2t  2 , we get the probability that, after t steps, the accumulated difference between expected and actual degree differences is at least t:As X t and X 0 are the sums of absolute differences in degrees, the above expression represents the maximum difference in degrees between any two nodes reachable within t steps, i.e.The proof relies on the assumption that the distribution of differences in degrees of neighboring nodes in G follows a power-law distribution. This is confirmed infor E.coli (see Supplementaryfor the remaining organisms). Let d( G ) denote the average degree of G. We call G almost regular if, for any two nodes G,H  V ( G ), the following holds:We then have the following corollary.
Corollary. The probability that the algorithm samples nodes from Galmost uniformly at random is bounded by:Proof. Since(4) we can establish the probability that |X t X 0 | with  = d( G ), as in the proof of Theorem 2. We thenAs an example of the corollary, for the case of E.coli, we obtain P( = k)  k 1.87 ,   7.14 and d( G )  19490 from sampling 10 4 random walks. Then the probability, that the algorithm samples nodes from G uniformly at random within t = 10 6 steps is bounded by:(Supplementaryshows the results for the remaining organisms). Note that these probabilities represent a rare worst case, since all X j are the sums of absolute differences in degrees. In practice, the cumulative degree changes of sampled nodes are likely to be smaller due to positive and negative changes in degree. Finally, we briefly analyze some practical implications of these findings. First, we determine the size of the sample space, i.e. the number of distinct randomized networks which can be generated from a given metabolic network G, if only individual compounds are substituted. Let s (r) denote the set of all mass equivalence classes, which contain a substrate or product of r. From each such equivalence class e s  s (r), we may choose any subset with the size of the number of substrates (products) of r contained in s (r); let  denote this number. Then, there are |e|  possible reactions for each mass equivalence class e s , where the original reaction may be obtained by reversing any previous substitutions. Therefore, the number of distinct networks which can be generated from G by substituting only individual compounds isFor the model organism E.coli, the size of the sample space is s  2.9710 957 (see Supplementaryfor the remaining organisms). The large sample spaces, again, illustrate the importance of uniform sampling. As shown before, the number of distinct networks which can be generated by substituting pairs of compounds does not merely depend on the reactions in the original network, as the number of possible substitutions may change after applying substitutions. Therefore, we are unable to give a precise Page: 1403 13971403
Mass-balanced randomizationexpression for the sample size in this case. Nevertheless, it is clear that, for the case of substituting individual compounds and pairs of compounds, the sample space is at least as large as G,s. In order to confirm the result of uniformity empirically, we analyze a random walk on the transition graph of the TCA cycle, a central respiratory metabolic pathway consisting of only 8 reactions and 20 compounds. For this network, the sample spaces are TCA,s = 256, TCA,p = 1024, with a combined total of 1024 possible randomized networks (i.e. all networks generated by a sequence of individual compound substitutions can also be generated by pair substitutions). We observe that the sojourn frequencies, i.e. the number of times each network is visited by the random walk, indeed converge toward the uniform distribution (see), confirming our theoretical claims.
CONCLUSIONThe advances in high-throughput omics technologies require developing algorithmic techniques for the analysis of large-scale biological networks. However, the significance of any networkbased prediction must be validated using a realistic null model. While the method based on switch randomization has been extensively used to study the significance of topological properties in many different types of networks, we argued that it is unsuitable for the analysis of metabolic networks. We presented a new method for randomizing metabolic networks under the constraint of mass balance. We observed that a null model should satisfy two important requirements: preservation of ubiquitous constraints characterizing the class of analyzed networks and uniformity of the sampling procedure. We demonstrated the uniformity of the proposed method theoretically and empirically on seven metabolic networks from all kingdoms of life. By integrating the (bio)chemical constraint of mass balance into a network null model, our method allows for a more realistic measure of significance. In addition, the proposed approach can be used for identifying network properties which are independent of mass balance constraints, and thus are likely to relate to the evolutionary history of metabolic networks. For instance, in a recent study, we applied the method to assess the evolutionary significance of thermodynamic favorability of metabolic reactions (). We believe that the integration of mass balance constraints is a necessary first step toward extracting biologically meaningful properties of genome-scale metabolic networks.
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
Moreover, two pairs of compounds, denoted by (c,k) and (c ,k ), will be called mass equivalent if and only if the corresponding sums of mass vectors m c +m k and m c +m k are linearly dependent. Note that mass equivalence is an equivalence relation, which follows from the reflexivity, symmetry and transitivity of linear dependence for vectors in N n. As a result, the mass equivalence relation partitions the set of compounds and pairs of compounds (see Tables 1 and 2 for examples, and Supplementary Fig. S2 for the class size distributions). The inclusion of linear-dependent triplets of mass vectors is straightforward and may further increase the sample space. However, due to the computational restrictions imposed by the size of genome-scale metabolic networks, we rely only on substitutions of individual and pairs of compounds. Finally, our approach is in line with the observations that some fundamental properties should be fixed while carrying out the randomizationhere, these are the degrees of the reaction nodes and mass balance. 3 METHODS In this section, we present the details of the proposed algorithm for randomizing metabolic networks together with its computational complexity, and show the main result about the uniformity of the method for network randomization.
