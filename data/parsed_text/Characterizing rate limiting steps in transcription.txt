Motivation: Single-molecule measurements of live Escherichia coli transcription dynamics suggest that this process ranges from sub-to super-Poissonian, depending on the conditions and on the promoter. For its accurate quantification, we propose a model that accommodates all these settings, and statistical methods to estimate the model parameters and to select the relevant components. Results: The new methodology has improved accuracy and avoids overestimating the transcription rate due to finite measurement time, by exploiting unobserved data and by accounting for the effects of discrete sampling. First, we use Monte Carlo simulations of models based on measurements to show that the methods are reliable and offer substantial improvements over previous methods. Next, we apply the methods on measurements of transcription intervals of different promoters in live E. coli, and show that they produce significantly different results, both in low-and high-noise settings, and that, in the latter case, they even lead to qualitatively different results. Finally, we demonstrate that the methods can be generalized for other similar purposes, such as for estimating gene activation kinetics. In this case, the new methods allow quantifying the inducer uptake dynamics as opposed to just comparing them between cases, which was not previously possible. We expect this new methodology to be a valuable tool for functional analysis of cellular processes using single-molecule or single-event microscopy measurements in live cells. Availability and implementation: Source code is available under Mozilla Public License at
IntroductionIn bacteria, transcription is the main regulatory mechanism of RNA numbers in the cell. This conclusion is supported by the lack of correlation between RNA numbers and their degradation rates () and by the fact that most regulatory molecules modulate the transcription initiation process (). Relevantly, the regulatory mechanisms of transcription allow wide adaptability, as the kinetics of this process varies widely between promoters, and for the same promoter under different conditions. Live cell measurements in Escherichia coli suggest that depending on the promoter and the conditions, such as the presence/ absence of repressor/activator molecules, RNA production can range from sub-Poissonian, that is, less uncertain than a Poisson process (), through Poissonian (), to super-Poissonian (). Such wide dynamic range is not likely achievable by a single mechanism and, in agreement, evidence suggests that this is a multi-step process ().Currently, the subprocesses that constitute transcription cannot be directly measured in live cells. However, it is possible to observe RNA production of individual promoters with single molecule resolution over time (). This information can be used to estimate the dynamical parameters of the subprocesses by the means of a stochastic model (). The success of this strategy requires accurate and unbiased statistical methods of data analysis as well as a model that can account for all possible dynamical regimes. Previously, we made use of distributions of intervals between transcription events in various conditions in order to estimate in maximum likelihood (ML) sense, for each condition, the number and duration of the rate limiting steps in transcription (). Relevantly, unlike RNA numbers, these intervals are not affected by RNA degradation, or dilution due to cell division, and consequently allow more accurate quantification of the transcription process. However, the previous model of transcription does not cover all potential cases (e.g. super-Poissonian RNA production). Here, we first propose a model that, by combining previous models responsible for different dynamical behaviors (), is capable of exhibiting behaviors ranging from sub-to super-Poissonian. Next, we present methods to estimate its parameters in ML sense. An advantage over previous methods () is that the new methods also use information of the unobserved transcription events. Such additional information results in improved accuracy and can be used to correct the biases resulting from the limited the measurement time. The methods can also account for the discrete sampling, which is typical for a fluorescence microscopy measurement. The increased accuracy allows studying subprocesses with smaller time scales, while the lack of bias is essential in order to correctly estimate the parameters of the more noisy models and to compare them in an unbiased manner. The methods can also be used to provide features such as confidence in the estimated parameters, and we use statistical methods to select components of the model in/out, which can be used to determine if certain components are responsible for the observed dynamical behavior.
MethodsTranscription intervals and activation time measurements in live E. coli cells were obtained using the MS2-GFP RNA-tagging system (). The cells contain a single-copy vector coding for the target RNA under the control of a specific target promoter: TetA (), bacteriophage k RM (), or arabinose BAD (). The target RNAs contain an array of 48 or 96 binding sites (depending on the construct) for the highly expressed MS2-GFP reporters to bind. This allows the target RNAs to be visualized using fluorescence microscopy right after their production. The systems were constructed previously (), and more details of the measurements conducted here using these systems are given in the Supplementary material.
AlgorithmsIn this section, we propose a model of transcription initiation whose kinetics can, depending on parameters selection, range from sub-to super-Poissonian. Next, we describe how to extract time interval distributions from the model. Finally, we describe how to estimate the model parameters using the measurement data.
Model of transcription initiationTo allow transcription dynamics to range from sub-to superPoissonian, we propose the model of elementary reactions:where P off ; P on ; I j 2 Z 1 represent different states of the promoter: inactive, active and some intermediate states of transcription initiation, respectively, while E represents the elongation complex. This model is designed to combine the activeinactive promoter model () with a sequential model of transcription initiation (). Note that any number of backward reactions for steps 1 through n  1 is implicitly supported, since equal dynamics can be achieved by setting the rates of the model appropriately (see Supplementary material). The onoff mechanism produces bursty RNA production, due to the random off periods (). When this mechanism dominates the dynamics, the intervals between transcript productions are highly noisy, resulting in super-Poissonian RNA production. The above model is appropriate regardless of the mechanism controlling the promoter onoff transitions as long as the state transitions occur with constant probability per unit time. Recent studies suggest that the dynamics of several promoters in E. coli may be dominated by such a mechanism (). In contrast, a sequential process of RNA production reduces noise, as it produces more regular intervals. In vitro measurements suggest the following sequence of events (): first, an RNA polymerase must find and diffuse along the DNA template until finding the transcription start site (). There, the polymerase forms a closed complex, and then goes through several isomerization steps, until completing the open complex formation (). After escaping the start site, the complex elongates along the DNA template, clearing the promoter region. Recent in vivo measurements have shown that at least some promoters in E. coli are capable of exhibiting a dynamics consistent with this model for a wide range of conditions (). In Equation (1), the steps which are much faster than the others can be neglected. Using the same argument, we can also take elongation complexes E to represent fully transcribed RNAs, as elongation takes tens of seconds (), while interproduction intervals are in the order of hundreds of seconds (). Regardless, elongation is not expected to affect the RNA production intervals on average, unless the initiation rate is so high that there is polymerase traffic (). We also note that if the promoter states are unobservable (as is the case here), the order of sequential processes cannot be determined from the transcription dynamics.
Transcription interval distributionSince transcription intervals can be split to sums of independent steps, the probability densities are easily manipulated in terms of their moment generating functions (MGFs). This is due to the fact that the MGF of a sum of independent variables is the product of the individual MGFs, and the MGF of a mixture is a weighted sum of the individual MGFs. The MGF of an exponential variate with a mean of k i 1 is:Characterizing rate limiting steps in transcriptionwhich implies that the MGF of the on-off step (including on, off and the first reaction) is:which is described in more detail in the Supplementary material. This indicates that any MGF of the model must have the form:where the latter is the partial-fraction decomposition of M(t). The residues R v i can be computed e.g. using: z  t  z  p  p  t and 1=p  t=q  t  1=p  q=p  t  1=p  q=q  t. By noting that the decomposition specifies a linear combination of the MGFs of sums of exponential variates, the probability density function (PDF) is recovered as:where the parenthesized term is the mixing weight and the remaining term is the PDF of a sum of v exponential variates, with a mean of p i 1 each. Here, Cw denotes the factorial of w  1. In general, the mixing weights are not convex, so this is not a proper mixture density. Manipulating the MGF can be also used to perform other useful operations: the survival function can be obtained by adding a pole at t  0, subtracting the t 1 term, and taking the inverse transform as above. Also, differentiation might be easier to perform on the MGF, which is useful for evaluating gradients and/or Hessians for optimization or for confidence estimation. For example, differentiation with respect to a k 1 i with i > 1 can be achieved by adding a zero at t  0, a pole at t  k i and multiplying the residues by k i .
ML estimationAs the measurements have finite length and discrete sampling (see), the true intervals between RNA production are not exactly known. An interval can be only observed if it fits in to the measurement window, and as such, in each cell, the last interval will not be observed due to the end of the measurement period. Neglecting these unobserved intervals will result in underestimation of the interval durations. Meanwhile, the discrete sampling implies that each interval contains some uncertainty about its exact duration, which should be communicated to the estimator. For example, the true interval between the second and third productions inis known to be 1012 units long (interval-censoring). Meanwhile, the true interval between the third and fourth productions is not <9 units long (right-censoring). These two modes of uncertainty are called interval-and right-censoring, as the true value is bounded to an interval or to the right (on the real line) of some observation. More precise definitions can be found e.g. in. Provided that the intervals T i between transcription events are independent, the probability of observing a sequence of intervals t 1 ;. .. ; t m  in a time series of length L is given bywhere the notation abuses P X ' x   P x X < x  @x  for infinitesimal @x and I   is the indicator function. Here, m and L need not to be constant, but can be realizations of independent random variables. This implies that a ML estimator can be written in the following form:where x i and y i are the (possibly infinite) known bounds for t i , and F(x) is the cumulative density function (CDF). The ordinary ML estimator is recovered at the limit y i ! x i , since Fy i j h  Fx i jh ! f x i j h y i  x i , where f(x) is the PDF, and y i  x i  is constant with respect to h. In general, the times from the beginning of the measurement to the first production might not have the appropriate distribution, and they cannot be used in the estimator. An exception to this occurs when it is known that the transcription process starts at the same time as the measurement. Another exception occurs when the transcription intervals are exponential, in which case the first production has the appropriate distribution due to the memorylessness of the exponential distribution. If interval-censoring of the consecutive intervals is used, the samples are not independent, since the error terms of the consecutive measurements might be correlated. However, if the production intervals are much longer than the sampling intervals, a condition necessary for accurate estimation anyway, these correlations tend to be negligible. Despite violating this assumption, we found intervalcensoring to improve the estimator performance considerably, as shown below. In some cases, simple solutions to the ML problem exist (see Supplementary material). However, the general ML problem requires numerical methods. Also, the ML surface is not guaranteed to be concave, nor even unimodal. However, it tends to be well behaved in practice, especially for larger samples (the usual properties of an ML estimator apply). Due to this, we perform 100 restarts with random starting point. We used the Nelder-Mead method () for optimization, since it appeared to perform well and is fast. We also experimented with the Broyden FletcherGoldfarbShanno method, with either exact or finite difference derivatives, but it produced similar results and was significantly slower.
Results
Applying the methods on Monte Carlo simulationsThroughout this article, we use 'exp' and 'seq-n' to denote models of 1 or n sequential exponential steps and no onoff mechanism, respectively, and 'onoff', and 'onoff-n' to denote the full models with 1 or n steps, respectively. The parameters of each model is given as a vector (k on 1 ; k off1 , since the order of k i is exchangeable. We performed Monte Carlo simulations using the following models based on previous live E. coli measurements: exp with a mean of 2750 s with 60 cells sampled every 180 s for 3300 s (), seq-2 with means of 712 and 716 s with 40 cells sampled every 60 s for 7200 s (), seq-3 with means of 109, 254 and 254 s with 113 cells sampled every 60 s for 3600 s (), and onoff with k on 1  360 s, k off 1  1020 s and k 1 1  102 s with 100 cells sampled every 20 s for 4800 s (). We constructed a hypothetical onoff-2 model based on the onoff model, by setting k 1 1  k 2 1  51 s, since there are no live E. coli measurements supporting the more complex onoff models. However, such models have been used in eukaryotic context (). The shapes of the model distributions are shown in, and model statistics are shown in Supplementary Table S1. This table shows the parameters, the mean and standard deviation (sd) of the transcription intervals, their noise, as determined by the squared coefficient of variation, and the differential entropy, which is useful in interpreting the entropy-based statistics. In addition, the number of cells and the sampling (samples  sampling interval) is shown, which apply for the time series simulations.
Model selection and effects of sample sizesFirst, we generated 100, 500 or 1000 intervals from each model, and fit the data with the following models: exp, seq-2, seq-3, onoff, onoff-2 and onoff-3. A network of likelihood ratio (LR) tests is used to choose the preferred model, such that the least complex model which cannot be rejected at a significance level of 0.01 is selected. Supplementaryshows the statistics for the most frequently selected model. Statistics were gathered from 1000 simulations in each case. In the table, log-likelihood (LL) quantifies how well the estimated model fits the data. The differential KullbackLeibler divergence (KLD) from the true model to the estimated one measures the information lost when the estimated model is used to approximate the true model, which will, as opposed to the likelihood, penalize overfitting. The spatial median (med) of the parameter estimates represents a typical estimate. Finally, the choice frequency indicates how often this model is selected in favor of the others. The alternative model (alt model) indicates the second most frequently selected model. The results indicate that the information lost with the onoff models is an order of magnitude greater, which is expected, since they are noisier. The likelihood values suggest that the estimators behave as is expected from an ML estimator, despite the numerical optimization procedure. For the exp and seq-2 models, 100 samples appear to be sufficient to identify the appropriate model for >90% of the time. For 500 or 1000 samples, this is true for all but the onoff model, in which it occurs more than 80% of the time. Finally, we note that especially with 100 samples, the multi-parameter models have biases in the parameter estimates, such as toward/away from equal values in the sequential models. Fortunately, these biases vanish with larger sample sizes, as is typical for ML estimates, so the problem can be mitigated by collecting more samples.
Advantages of censoringNext, we generated time series of RNA numbers to simulate our measurement settings. The data extracted from these series were fit with the appropriate model using full censoring, without intervalcensoring (i.e. disregarding discrete sampling effects), without rightcensoring (i.e. without correcting for the unobserved samples) or with neither mode of censoring. For the sequential exponential models, the last method corresponds to a previous method (). The results are shown in Supplementary Table S3. Again, the likelihood quantifies how well the estimated model fits the data, the divergence how well the estimated model corresponds to the true model, and the median of the estimates represents a typical parameter estimate. The likelihood values are not comparable between the different modes of censoring. While these results demonstrate the applicability of the methods under typical settings, the different models cannot be compared as the relative sampling settings of the models differ widely (cf. Samples in Supplementary). To allow such comparison, we also simulated each model for 5l time units, sampling every 5 1 l units, where l is the mean production interval. These results are shown in. The results indicate that the lack of right-censoring will result in drastic underestimation of the transcription interval duration, especially in the noisy cases, such as with the onoff models. Also, without right-censoring, the variance is generally underestimated in a similar manner. In the tested settings, the effects of discrete sampling were found comparatively weaker, but this is likely mitigated by the relatively frequent sampling (sampling rates are around 10-fold to that of transcription). However, accounting for it offers slight improvements in the accuracy in all cases. In summary, it is essential to apply both modes of censoring for the high-noise models, while for sequences of exponentials neither mode of censoring is critical. However, in all cases the variant with full censoring performs best, as expected. Also, if the true model is not known but model selection will be performed, it is again necessary to use censoring to avoid biases toward selecting a less noisy model.
Applying the methods on transcription interval measurements
Transcription kinetics of the tetA promoterWe used MS2-GFP RNA-tagging and the methods with full and no censoring to analyze transcript production intervals in live E. coli (see). This allows determining if the two methods result in significantly different results with true measurement data. For this, we performed experiments, as described in Section 2. Again, the model is selected using a network of LR tests and the following models: exp, seq-2, seq-3, onoff, onoff-2, onoff-3. First, we measured the RNA production in a construct where the target gene is controlled by the tetA promoter. A previous study reports that the dynamics are explained by a sequence of two or threeCharacterizing rate limiting steps in transcriptionexponentials, depending on the conditions (). Our measurements were conducted under full induction (15 ng/ml of anhydrotetracycline) (), imaging the cells for every 1 min for a duration of 60 min. The histogram of observed intervals collected from the measurements is shown in the upper panel of Supplementaryalong with the PDFs of the estimated models. The intervals were extracted by analyzing the time series of individual cells separately (as opposed to observing production intervals in the whole cell lineage). By pooling the observed intervals from multiple cells, we implicitly assume that there are no significant variations in the model parameters between the cells. In addition, the lower panel of Supplementaryshows the Turnbull's CDF estimate (), which is a non-parametric ML estimate of the CDF accounting for both modes of censoring. Note that the histogram only contains the observed samples, so it is expected to underestimate (overestimate) the probability for large (small) values. On the other hand, the Turnbull estimator is expected to represent well the true CDF.shows statistics for the two methods. The number of samples is different in the two cases, as the full censoring method also includes the right-censored samples. Here, both methods suggest a three-exponential model and rule out the possibility of an on off mechanism as the primary regulator of the dynamics. In both cases, the estimated parameter standard deviation is $2 min per parameter, with full censoring resulting in a slightly higher confidence on the parameters. With full censoring, there is about 1.3-fold increase in the mean, which is expected, since neglecting the right-censored data tends to result in underestimation of the durations. To confirm the statistical significance of this difference, we performed a one-sided t-test with a null hypothesis that the two means are equal, resulting in a P-value of 5.20  10 9. Also, we found differences in the noise levels, but both methods suggest cv-squared of <0.5, favoring the three-exponential model. To demonstrate that the full censoring method is immune to changes in the measurement duration, we repeated the estimation procedures such that the time series was split into two halves of 30 min each, from which the data were extracted separately. The results are shown in the lower block of, and they indicate that with the full censoring method, only the confidence in the parameter estimates is visibly affected, whereas the non-censoring method underestimates the mean and standard deviation (even more than when applied to the time series 60 min long). Finally, we studied whether our results are affected by the elongation process. First, to test if significant RNA polymerase traffic occurs (e.g. due to pausing), we estimated the correlation between consecutive transcription intervals. We found a correlation coefficient of 0.149 with a P-value of 0.196 in an LR test with a null model of uncorrelated normal data, indicating that the correlation is not significant. Next, we added a normal zero-mean noise term to the transcription model to simulate stochasticity resulting from chain elongation. The estimated sd of this noise term was 24.4 s (Pvalue of 0.574 in an LR test with a null model from), suggesting that such noise term is not significant at our resolution. As neither of the null hypotheses can be rejected, we conclude that there is no evidence that the dynamics of elongation affects our results. In addition, in agreement, we note that no differences have been found in the dynamics of RNA production between constructs with 48 and 96 of the MS2-GFP binding sites ().
Transcription kinetics of the k RM promoterNext, we analyzed measurements of the transcription intervals of the MS2-GFP-tagged target RNA controlled by the bacteriophage kRM promoter. This construct is expected to result in a bursty, highly noisy expression (). In this case, the cells were imaged every 1 min for a duration of 120 min. Again, the histogram of the observed intervals and the PDFs of the estimated models are shown in the upper panel of Supplementary, and the Turnbull's CDF estimate and the CDFs of the models are shown in the lower panel. Similarly,shows statistics from the two estimation procedures. Both methods indicate that an onoff model is required to explain the measurements, and that the interval distribution is highly noisy (cv-squared above unity). However, in the case where the unobserved samples (which constitute $50% of the samples) are neglected, both the mean and sd of the distribution are drastically (over 5-fold) underestimated. In terms of cv-squared, this results in a 2-fold underestimation of stochasticity in the transcription initiation process. Finally, we computed the statistics of the bursts in the two estimated models, which are shown in. The model estimated using full censoring suggests that the noise results from a low-duty cycle (i.e. the gene being repressed most of the time), while the model estimated without censoring suggests that the noise is due to the large size of the bursts.
Applying the methods on measurements of external transcription activation timesFinally, we analyzed the activation dynamics of the arabinose BAD promoter to demonstrate that the methods generalize to other estimation problems. The analysis was performed by collecting both the time for each cell to produce the first RNA after introducing arabinose in the medium, and the subsequent time intervals between consecutive productions of transcripts. For this, 1% of L-arabinose was introduced at the start of the measurement, after which cells were imaged every 1 min for 120 min. The time to produce the first RNA is expected to include the time for the cell to uptake sufficient arabinose to turn on the active arabinose uptake system, for the arabinose to form the complex activating the BAD promoter (), and for the first transcript to be produced. As such, after, we fit the following modelwhere A on ; A off 2 Z 1 represent the states that the internal arabinose concentration has or has not reached sufficient concentration to turn on the arabinose uptake mechanism, respectively, and P on ; I j 2 Z 1 represent the states of the BAD promoter. Since the intervals were found to have low noise (cv-squared of 0.347), we model transcription with a sequence of three exponentials. In the above model, the times for the first RNA production follow an seq-5 model with the parameters, where p 6 are as in Equation (3), and the intervals of the subsequent productions follow a seq-3 model with the parameters (k 2 , k 3 , k 4 ). As the models share parameters, they are fit jointly to both data. The histogram of the observed data and the PDFs of the estimated models are shown in the upper panels of Supplementary, and the Turnbull's CDF estimates and the CDFs of the models are shown in the lower panels.shows statistics from the estimation procedure. The exponential-likeness of the activation process suggests that either k on , k 1 or both must be fast (non-rate limiting). Meanwhile, in transcription, two of the rates k 2 , k 3 and k 4 are rate limiting. The mean (sd) of the observed first production times and transcription intervals were 3880 s (1700 s) and 1700 s (1000 s), respectively, which agrees with those reported in. Again, this suggests that neglecting the unobserved data results in slight underestimation of the mean and the variance. Regardless, the qualitative results, such as noise, reported inappear to hold. It is worth noting that, to avoid artificial correlations between the first and the subsequent production times,used a windowing method to compare the activation dynamics in different conditions. In our method, such windowing is not needed, as the censored data is used. Because of this, in addition to using more information, our method also allows unbiased quantification of the different distributions, not just their comparison. Furthermore, our method can also be used to deconvolve the activation dynamics distribution, as shown in.
DiscussionWe have proposed a model that combines a promoter onoff mechanism () with a sequential process of transcription initiation (), which allows explaining recent measurements of transcription dynamics under a wide range of conditions (), and established methods to estimate its parameters in maximum likelihood sense using transcription interval data. The methods enable more accurate quantification of the transcriptional dynamics both in theory and in practice, as demonstrated by the Monte Carlo simulations, as well as testing if particular components of the model are responsible for the observed dynamics. In addition, we compared the methods with previous methodsThe table shows the number of samples, the selected model (sel model), the estimated parameters and estimates of their standard deviation and the mean (est mean), standard deviation (est sd) and squared coefficient of variation (est cv-squared) resulting from the estimated model. Also shown is the burst size, burst interval and the duty cycle of the estimated modelThe table shows the number of samples, the selected model (sel model), the estimated parameters and estimates of their standard deviation and the mean (est mean), standard deviation (est sd) and squared coefficient of variation (est cv-squared) resulting from the estimated modelCharacterizing rate limiting steps in transcriptionusing measurement data from live E. coli, and showed that the new methods produce significantly different results and can provide new biological insight (e.g. on the underlying sources of noise in transcription). Finally, we demonstrated that the methods have a wider applicability on problems of similar nature, such as estimating the kinetics of external activation of a promoter. In its present form, the proposed model should already be detailed enough to allow a genome-wide analysis of transcription and transcription activation of individual genes under a wide range of conditions in prokaryotes, which is necessary to understand how inducers and repressors regulate the dynamics of gene expression. Further, we believe that our methods can be extended to enable future studies of eukaryotic transcription dynamics and of translational dynamics at the single protein level.
FundingThe work was supported by the Jenny and Antti Wihuri Foundation
at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
A.H kkinen and A.S.Ribeiro at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
Blocks from top to bottom: 60 min series and 30 min series. The table shows the number of samples, the selected model (sel model), the estimated parameters and estimates of their standard deviation and the mean (est mean), standard deviation (est sd) and squared coefficient of variation (est cvsquared) resulting from the estimated model
