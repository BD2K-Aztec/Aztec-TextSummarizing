Chromaligner is a tool for chromatogram alignment to align retention time for chromatographic methods coupled to spectrophotometers such as high performance liquid chromatography and capillary electrophoresis for metabolomics works. Chromaligner resolves peak shifts by a constrained chromatogram alignment. For a collection of chromatograms and a set of defined peaks, Chromaligner aligns the chromatograms on defined peaks using correlation warping (COW). Chromaligner is faster than the original COW algorithm by k 2 times, where k is the number of defined peaks in a chromatogram. It also provides alignments based on known component peaks to reach the best results for further chemometric analysis. Availability: Chromaligner is freely accessible at http://cmdd.csie .
BACKGROUNDChromatography is the most important separation technique. With the improvement of chromatographic technology and chemometric analysis, there is a growing interest to use the entire chromatogram to detect differences between pre-classified sample sets. Fingerprint analysis () and metabolomics () are two rapid growing research fields that use the entire chromatogram for authentication of herbal medicine, clinical diagnostic and evaluation of drug toxicity or efficacy. Most samples used for fingerprint analysis and metabolomics are composed of a large number of diverse components and slight retention time shifts could result in the incorrect detection of differences between preclassified samples. Retention time shifts in chromatograms may be originated from variation in flow rate, temperature and column aging of the chromatographic system (). It is important to correct the retention time shits before chemometric analysis of a chromatographic data. For the reasonable chemometric analysis with chromatograms, specifically the fingerprint analysis of plant extracts () or metabolomics analysis (), certain known peaks, as the key chromatogram features, should be aligned together before any statistical treatment. * To whom correspondence should be addressed.Current publicly available tools for chromatogram alignment such as ChromA (), VIPER () and Metalign () are designed for chromatographic technique coupled to mass spectrometers. Due to the high instrumental cost of mass spectrometry, many laboratories use UV and fluorescence detectors for signal detection. However, current alignment tools cannot be applied to such data sets. The two most commonly used alignment algorithms are correlation optimized warping (COW) () and dynamic time warping (DTW) () that focus only on the comprehensive optimal solution only, and failed on chromatograms with large peak shifts as commonly seen in capillary electrophoresis (CE). Most alignment methods are implemented in MATLAB code that is typically difficult for a wet lab analytical chemist to use. Several algorithms are implemented as web servers, for example,provide one employing the COW and DTW functions for chromatogram alignments. However, users can only compare two chromatograms with the exact length and less than 2000 data points at one time. This restriction makes it difficult to align common chromatogram of 30 min (more than 3000 points) or longer that are generated by a HPLC or a capillary electrophoresis. Our goal is to use a constrained chromatogram alignment algorithm to resolve those issues. Here, we provide a web interface, Chromaligner, for chromatogram alignment algorithms with constraints using COW. It can be used to align retention time for chromatographic methods coupled to spectrophotometers.
METHODAmong the current alignment methods, COW has the advantage of matching small and large peaks, while preserving their shape but the processing is typically slow. Chromaligner uses a constrained chromatogram alignment based on COW to reduce the complexity and the processing time. Prior to aligning the chromatogram, Chromaligner corrects the baseline and selects the peaks. The chromatogram is partitioned into walking windows of 25 s. To determine whether a point is a peak, that point must first be the maximum in a window. Then, the standard deviation of intensities of each walking window is ranked and the third quartile of the standard deviation is selected. If the difference of the maximum intensity and minimum intensity in this walking window exceeds the third quartile, the point is considered a peak. To reduce the processing time and to improve accuracy, Chromaligner uses either user-defined peaks () or it automatically selects peaks by matching UV spectrum from a diode array detector (DAD). If the Pearson's correlation of peaks from the UV spectrum between the test and target chromatograms is >0.98, within 1 min, the corresponding peak(s) will be selected. Chromaligner further divides the chromatograms into segments,Page: 2339 23382339with respect to these peaks () and then, performs COW on each segment (). For a chromatogram of length L, COW and DTW can resolve the alignment in O(L 2 ) time through dynamic programming (DP) (). For Chromaligner, if the number of defined peaks is k, the segment length to be aligned is reduced to O(L/k). Therefore, the time complexity for each segment is reduced to O(L 2 /k 2 ). However, COW requires manual tuning of the section length and the slack number to achieve better alignment. Our experience showed that the local optimal solution using COW is generally obtained, while the section length is between 20 and half of L with the slack number between 1 and 5. By heuristically tuning a chromatogram, COW needs to tune O(L) times to achieve the optimal alignment in O(L 3 ) time. To completely align a chromatogram, Chromaligner tunes O(L/k) times for each segment and continues to align a total of k+1 segments for a chromatogram; making the time complexity O(L 3 /k 2 ). Thus Chromaligner aligns chromatograms k 2 times faster than COW. By DP nature, both DTW and COW require O(L 2 ) in space. However, the size of the DP table in COW is dependent on the section length (). A section length of m results in a DP table size of L 2 /m and reduces the space complexity to O(L 2 /m) for COW which is smaller than the O(L 2 ) of DTW. The space complexity of Chromaligner is O(L 2 /k 2 m) due to the fact that each segment length L is reduced to L/k.
Chromaligner
INPUT AND OUTPUTChromaligner requires three sets of files in plain text (tab delimited with a .txt extension): an index file, raw data and parameter files. The raw data file must contain retention time to intensity information. UV spectrum from a DAD can be provided for auto-picking peaks for Chromaligner. For additional details on the file format, please visit the Chromaligner website. Chromaligner is able to export results in chromatograms. The aligned files are transformed into retention time and intensity data for further chemomatric analysis. Overlaid chromatograms that depict shifts between the target and sample are also provided.
CASE STUDYThe World Health Organization (WHO) has suggested chromatographic fingerprinting for quality evaluation of the herbal medicines. We applied Chromaligner to chromatograms obtained from different instruments and herbal extracts. Chromatograms ofScutellaria were obtained from an HPLC-DAD instrument. Using the auto-picking function in Chromaligner to select the peaks of DAD (which is absent from original COW), the correlation greatly improved to a great extent after alignment. We also used Chromaligner to analyze a well-known traditional Chinese medicine and cooking herb, rhubarb (). The chromatograms of rhubarb were obtained from a CE-UV instrument. Compared to COW, Chromaligner provided better alignments within a shorter execution time. Thus, Chromaligner is an efficient and accurate tool for chromatogram alignment.
at :: on August 31, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
