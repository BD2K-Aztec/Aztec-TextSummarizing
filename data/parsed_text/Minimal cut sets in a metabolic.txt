Motivation: Elementary modes (EMs) and minimal cut sets (MCSs) provide important techniques for metabolic network modeling. Whereas EMs describe minimal subnetworks that can function in steady state, MCSs are sets of reactions whose removal will disable certain network functions. Effective algorithms were developed for EM computation while calculation of MCSs is typically addressed by indirect methods requiring the computation of EMs as initial step. Results: In this contribution, we provide a method that determines MCSs directly without calculating the EMs. We introduce a duality framework for metabolic networks where the enumeration of MCSs in the original network is reduced to identifying the EMs in a dual network. As a further extension, we propose a generalization of MCSs in metabolic networks by allowing the combination of inhomogeneous constraints on reaction rates. This framework provides a promising tool to open the concept of EMs and MCSs to a wider class of applications.
INTRODUCTIONModeling and analysis of complex metabolic networks is a central area of research in systems biology. Stoichiometric or constraintbased modeling relying on the assumption of steady state in the metabolites has become a key methodology to analyze functional properties of large-or even genome-scale metabolic networks (). One of these approaches is flux balance analysis (FBA), which uses Linear Programming in conjunction with a linear objective function to compute particular stationary flux vectors, corresponding e.g. to optimal growth (). Another approach for metabolic network and pathway analysis is based on Elementary Modes (EMs), which are steady-state flux vectors involving a minimal set of reactions (). EMs analysis allows identification of balanced metabolic pathways and cycles and to study a multitude of functional network properties * To whom correspondence should be addressed.  The authors wish it to be known that, in their opinion, the first two authors should be regarded as joint First Authors.  Co-Senior Authors.[for a review see. One important application of EMs is the computation of intervention strategies, e.g. for metabolic engineering (). A particular approach for rational (re)design of metabolic networks built upon EMs is the computation of Minimal Cut Sets (MCSs). In the original work (), MCSs were introduced as minimal sets of reactions whose deletion will block the operation of a given objective or target reaction; i.e. removal of an MCS implies a zero flux for the target reaction in steady state. Generalizations of this definition were presented afterwards, e.g. for blocking the operation of arbitrary sets of EMs () or/and for accounting for side constraints (). The problem of computing EMs results in the computation of extreme rays of convex polyhedral cones and is well studied in systems biology. Although a full enumeration is still not possible for most genome-scale models, considerable algorithmic improvements could be achieved over the last years (;;), and the computation of tens of millions of EMs is now, in principle, possible. Regarding the enumeration of MCSs, three different approaches have been proposed so far (; upper half). The first is based on an a priori calculation of EMs with subsequent calculation of the minimal hitting sets of the (target) EMs. This approach is also known as computing a hypergraph's transversals: the support patterns of the target EMs give rise to an undirected hypergraph and the minimal hitting sets (which are then the MCSs) correspond to those transversals whose entire set spans another hypergraph, the transversal hypergraph. The algorithm introduced inrepresents one variant for computing all transversals of the hypergraph of a given set of EMs. However, this algorithm requires the enumeration of many partial solutions, which leads to an extensive running time and memory usage. As shown in, the computation of MCSs as minimal hitting sets from a set of EMs can significantly be accelerated by using Berge's Algorithm (), which is a fast method to compute hypergraph transversals.presented also a completely different approach to compute MCSs, which is based on the Joint-Generation Algorithm () and generates both the EMs and the MCSs simultaneously. However, both techniqueshypergraph transversal (minimal hitting sets) as well as Joint-Generation Algorithmeither need the EMs of the metabolic network or generate them as a byproduct although they might not be of interest.Here we propose a method to compute MCSs directly without knowing the EMs. A brute-force procedure to achieve this could be to use FBA to test systematically all 1-,2-,3-,.... combinations of knock-outs for their ability to imply the desired blocking of targeted flux vectors (). However, such an approach again becomes quickly prohibitive for MCSs with larger cardinalities. A slightly different concept are Minimal Direction Cuts introduced by. These cuts allow to cancel only one direction of reversible reactions, which can also be embedded in the model of MCSs by splitting reversible directions and target one of them. However, the concept of minimal direction cuts allows for a direct computation by means of the Farkas Lemma (). The enumeration of all minimal cuts is accomplished by solving iteratively (general) Mixed Integer Linear Programs. In contrast, our approach relies on the notion of a dual network whose stoichiometric matrix is basically given by the transposed stoichiometric matrix of the original system. Based on the Farkas Lemma, we will show that the computation of MCSs is equivalent to finding the EMs in the dual network (). In particular, the duality implies also the other way around: EMs in the original metabolic network correspond to MCSs in the dual. Additionally, our duality framework enables us to expand the concept of EMs and MCSs (originally defined for homogeneous constraints only) for systems with inhomogeneous constraints that can model e.g. boundaries for the reaction rates or for linear combinations of fluxes. The computation of EMs and MCSs remain the same in this generalization while the expressive power highly increases.
K.Ballerstein et al.
ElementaryFor reasons of representation, we will initially restrict ourselves to the MCS problem for a given set of target reactions which will be generalized in a later step. The duality theory, which enables direct computation of MCSs as EMs of a dual network, is presented in Section 2.2. Implementation details and computational results for benchmark problems are provided in Sections 2.3 and 3.1. Generalizations together with an application example are described in the Section 3.2.
METHODS
Basic conceptsA metabolic reaction network consists of m metabolites and n biochemical reactions for which we denote the index sets by M and N, respectively. We model such a network via the mn stoichiometric matrix N where each column encodes one reaction by storing the respective stoichiometric coefficients of the metabolites consumed and produced. Each reaction may operate with a certain rate and the full set of n reaction rates is collected in the (flux) vector r. The reactions usually divide into a set of reversible and a set of irreversible reactions, denoted by Rev and Irrev = N \Rev, respectively. Irreversible reactions can only proceed in the forward direction, hence, r i  0 for all reactions i  Irrev. Given such a metabolic network we say that it is in steady state if each metabolite is equally consumed and produced by the reactions. The set of flux vectors keeping the network in steady state is described as the following convex polyhedral cone, also called flux cone,The EMs are, up to scaling, the support-minimal non-zero points of F , where the support of a vector x is defined as the index set {i  N : x i = 0}.
Page: 383 381387
Minimal cut sets and elementary modesThus, they are determined by the binary support pattern of which we will make use. Note that EMs correspond to the extreme rays of the steady-state flux cone if all reactions are irreversible. Generally this is not true. However, one may split the reversible reactions into its two irreversible parts to make use of algorithms known for the extreme ray generation problem. A more detailed discussion about the computation and geometric interpretation of EMs can be found in Gagneur and Klamt (2004). One is often interested in combinations of reaction knock-outs (cuts) that block the operation of certain target reactions in steady state. If we denote the set of target reactions by  = T  Irrev, assuming for simplicity that they are all irreversible, these sets are called cut sets for T. Speaking algebraically, a cut set C  N is a set of reactions such that for all solutions to the system r  R n | Nr = 0,r q  0 for q  Irrev, r i = 0 for i  C it holds true that r j = 0 j  T. An MCS is an inclusion-wise smallest cut set, i.e. no subset of an MCS C fulfills the latter condition. Note that the restriction of T  Irrev is not a loss of generality as each reversible reaction can be split into two irreversible parts. It will be convenient to denote the target reaction set by a target reaction vector t {0,1} n which is a column vector indicating the targets by 1.
Computing MCSs as elementary modes in a dual networkIn the following, we derive a method that detects all MCSs without the necessity to generate the EMs. The idea is to use the same polyhedral methods as for calculating EMs but for a dual stoichiometric network. It is obtained by polyhedral duality. First, we review the basic concept and notation. Let A be a mn, and C be a pn real matrix, M and P the respective index sets of their rows, N the index set of columns (and thus also of the variables) and let b  R m , d  R p. For J  M, we denote by A J the submatrix of A consisting of the rows corresponding to the index set J  M and all columns. Accordingly, A J describes the submatrix with columns from J  N and all rows. We abbreviate the polyhedron S ={x  R n :In particular, we can relate the set of MCSs to the IISs of a certain system. Lemma 1. Each MCS C for given stoichiometric matrix N  R mn and target reaction vector t = 0 can be identified with an IIS of the systemwhere I denotes the n-dimensional identity matrix.Proof. First, note that the system (1) is obviously infeasible, which justifies the consideration of its IISs. To prove the claim, we have to show that any MCS C corresponds to an IIS of the system (1), and no other MCS C corresponds to the same subsystem. To this end consider the systemSince C is an MCS, this system is an inconsistent subsystem of (1). Otherwise, it is not true that r j = 0 j  T and thus C is not a cut set. But clearly (2) is not necessarily irreducible. Thus, it remains to argue that (2) has an IIS that contains all equalities r i = 0, i  C. As C is an MCS, we know that {Nr = 0,r C = 0 C ,r Irrev  0}{r  R n : r j = 0 j  T }. Thus, there exist minimal sets J  M and K  Irrev\C such that {N J.. Hence, the systemThe relation between MCSs and IISs of (1) is clearly not one-to-one but one MCS corresponds to many IISs. The choice of J and K is, a priori, not necessarily unique, but imposing preferences on indices (use e.g. a lexicographic order on the set J K) yields uniqueness. Furthermore, some IIS refer to supersets of MCSs. For example, {r T = 0, t r  1} is always an IIS whereas blocking all target reactions T is always a cut set but not necessarily a minimal one. Therefore, we compute MCSs by finding all IISs of (1) and select those minimal with respect to the variables fixed to 0. In Parker and, the computation of all IISs of an inconsistent system {Ax  b,Cx = d,x  0} is reduced to enumerating all vertices of a certain polyhedron. It is shown that the support of each vertex of this polyhedron identifies exactly the index set of one IIS of the original system. The auxiliary polyhedron is obtained by means of the Farkas Lemma, which characterizes the infeasibility of an arbitrary system of linear equality and inequality systems [for detailed illustration see. For completeness, we state here one version of the famous result.(row) vectors in our particular case, the vector w reduces to a scalar. Thus, we know that the following system is consistentwhere I  R nn is the identity matrix and I Irrev  R n|Irrev| is the identity matrix for irreversible reactions filled with n|Irrev| 0 rows at the position of reversible reactions. To obtain the standard form of a steady-state description of a reaction network we relax w > 0 to w  0, which leads to the dual stoichiometric network with stoichiometric matrix N dual .Page: 384 381387Comparing primal (1) and dual (4) system one can see that the latter is basically the transposed version of the original system except that the matrices related to the inequality constraints were multiplied by 1. Thus, reactions in this dual framework stem from metabolites of the original network while primal reactions became metabolites in the dual (see also the example at the end of this section). Furthermore, the variables w and z correspond to irreversible reactions, whereas u and v are associated with reversible reactions. As proved in Gleeson and Ryan (1990) and Parker and, the IISs of (1) correspond to the support of those extreme rays of the cone (4) with w > 0. Thus, the extreme rays that determine the MCSs are those with minimal support of v and a strictly positive w. From the Farkas Lemma, it is clear that all relevant solutions of (4) must satisfy w > 0 since system (1) without the inequality t r  1 is feasible. We also remark that the dual of the dual network (4) yields:
K.Ballerstein et al.which is upto a trivial projection of k and scaling of the remaining inequality the original metabolic network transformed to its IIS form (1). To conclude the section, we illustrate the approach by the small example in. The network on the left-hand side shows the primal network with five reactions and two metabolites A and B. The intervention goal is to block the flux through the target reaction r 5. The network has five EMs, and the four relevant EMs involving target reaction r 5 are given by their support. The conventional way to obtain the MCSs is to compute the minimal hitting sets of the target EMs. As an alternative, our new approach suggests to build the dual network instead (right-hand side in) and to compute the MCSs of the primal network as EMs of the dual. As can be seen in, the reactions of the primal network become metabolites in the dual and the primal metabolites are now reactions. In addition, each metabolite (formerly reaction) gets an associated reversible exchange reaction (v 1 ,...,v 5 ) and, if the metabolite originates from an irreversible reaction in the primal network, an irreversible outflow (z 2 ,...,z 5 ). Finally, all species in the dual network originating from a target reaction are virtually excreted by one reaction w; in the example this affects only r 5. Generally, the conversion of the primal to the dual network can be performed instantly without computational effort. One then computes the EMs in the dual network and selects those which are minimal with respect to v 1 ,...,v 5 and where w > 0 (i.e. reaction w is involved). These EMs are the desired MCSs for the primal network. If we compute the MCSs (as minimal hitting sets) of the dual EMs (focusing again only on MCSs comprising exclusively v 1 ,...,v 5 ), we get the EMs of the primal network (). The fact that only particular EMs of the dual network are relevant in this procedure suggests a particular design of the algorithm to compute them which is briefly outlined in the following section.
Implementation detailsGenerally, the enumeration of EMs can be a demanding problem due to a possible combinatorial explosion during the generation of new candidate modes. As described above, we are interested in those EMs of the dual system (3), which are minimal with respect to reactions v and fulfill w > 0. For small systems, it is possible to calculate all EMs and then to select those that fulfill these properties. For larger systems, this turns out to be impractical. Therefore, we devised an enumeration scheme which effectively calculates the desired subset of EMs. Details of this implementation can be found in the Supplementary Material. Briefly, certain redundancies and particular structures of the dual system (3) can be exploited to simplify the procedure and to reduce the computational effort. For example, reactions z can be seen as parallel reactions (isozymes) to the backward direction of the reversible reactions v (). This means that for EM computation reactions z can at first be ignored and taken into account by a postprocessing step. Furthermore, as we are only interested in EMs of the dual system that are minimal with respect to the reactions v, columns corresponding to reactions u need not be processed during the EM calculation procedure.Comp. time, computation time.
Page: 385 381387
Minimal cut sets and elementary modes
RESULTS
Computational resultsIn order to test our implementation of the dual approach described above, we applied it to the benchmark problem of calculating MCSs in a model of the central metabolism of Escherichia coli [cf.; note that we did not consider multifunctional enzymes leading to slightly different numbers of. Concretely, the task is to calculate MCSs that disable growth under four different substrate uptake scenarios. To increase the performance of EM computation, the metabolic network (N) is compressed beforehand as usual and the same reduction is also used before dualizing the system. After calculating the (primal) MCSs as EMs of the dual network, they can be readily mapped back to the original reactions. Computation times are shown in. For the conventional MCS computation procedure, the calculation time splits into the computation of EMs and minimal hitting set computation (cf.). The former was done with Metatool (von) while for the latter, API functions of CellNetAnalyzer were used (). In the dual network, Metatool is used for processing the rows and Matlab scripts have been written for filtering intermediate modes and for selection of support-minimal and superseded vectors (Supplementary Material). All in all both methods show similar computation times. However, during row iterations of the dual network method we observed that the number of intermediate modes can considerably exceed the number of final MCSs, which can lead to high memory requirements, at least as far as our prototypical implementation is concerned. Therefore, in future work we will address a more dedicated implementation of the dual network method, e.g. reduce memory demand which should also improve its runtime performance. Furthermore, although the dual approach did not outperform the conventional method to compute the MCSs in the example, other problem instances may exist where the circumvention of the minimal hitting set calculation may become highly beneficial. Moreover, the enormous recent improvements in the EM calculation procedure including parallelized variants () may favor the computation of MCSs as EMs from the dual network in the near future. As we had to use our own implementation (Metatool) to encode the dual approach and its enhancements (as described in the Supplementary Material), we did not yet fully benefit from these latest developments.
GeneralizationsThe procedure of computing MCSs as EMs in a dual network outlined above can be further generalized to increase the scope of applications and to allow for a more precise specification of intervention problems. First of all, it is straightforward to relax the notion of target reactions to target flux vectors which need to be blocked. In case of target flux vectors, the goal is to block all flux vectors where at least one of the target reactions is active. In the primal system (1), this was expressed by the vector t which occurs after dualization as column in the dual stoichiometric matrix (3). Another design strategy relevant e.g. for metabolic engineering is to block all flux vectors where the yield: product excretion rate; r S : substrate uptake rate) of a certain product falls below a given threshold h, i.e. where r P /r S < h. These target flux vectors can be specified by hr S r P  1 and the target reaction vector t is thus constructed with zeros except for the 1 for the product excretion and h for the substrate uptake reaction. However, for some applications we need more inhomogeneous constraints to specify target flux vectors properly. To this end, we move away from the flux cone to the flux polyhedron of a metabolic network.The double inequalities can be written as two separate systems which read Tr  b U , Tr b L. For ease of notation, we will from now on put all constraints into one matrix T and the combined right-hand side is denoted by b:The original formulation with the target reaction vector t can be easily embedded within this description with T =t and b =1. Matrix T allows us to express complex sets of (target) flux vectors in a flexible way, not only by specifying target reactions but also by other homogeneous or inhomogeneous constraints, e.g. on boundaries or certain ratios of reaction rates. Moreover, by moving a row from N to T and providing suitable lower and upper bounds, the steady-state assumption on certain metabolites can be relaxed to certain boundaries of accumulation/degradation rates of the corresponding metabolite. [This generalization also covers the reaction simplex as introduced by, more appropriately called concentration polyhedra, see].
Example 1. For illustration of potential application scenarios, we return to the example network of Figure 2 and assume the systemPage: 386 381387
K.Ballerstein et al.
to be in steady state as usual. Additionally, we limit the rate of reaction r 1 within the range [2,10] which is expressed by Tr  b, with:T = 1 0 0 0 0 1 0 0 0 0 , b = 2 10 .
We can fix certain reaction rates to a single value (which could represent, for example, the non-growth associated ATP maintenance demand) in combination with boundaries for others, e.g. r 5 = 5, 0  r 3  3, 0  r 4  3 which can be encoded by0 0 1 0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 1 0 0 0 0 0 1AnotherIt is well known that polyhedra can alternatively be represented by an outer description as intersection of hyperplanes (as it is the case for P) or by an inner description, as a Minkowski sum P = convV +coneE, using the vertices V and the extreme rays E of P. The flux polyhedron P, therefore, decomposes into a cone and a polytopal part, whose vertices characterize the extremal operating states of the network for the prescribed ranges of reaction rates or their linear combinations. Each vertex v  V is determined by some combination of simultaneously tight constraints of the inequality description. The vertices hence show whether the ranges required are in fact limiting, and how their limiting effects are intertwined.With the (target) flux polyhedron P at hand, we wish again to find minimal knock-out sets that block all its flux vectors. The generalized definition of MCSs for P is straightforward.Note that setting r i = 0 for i  C in flux polyhedra may lead to an empty solution space while in the homogeneous case at least the trivial solution r = 0 always remains. In accordance with the case of a flux cone, by applying again Theorem 2 one can compute the MCSs of a given (target) flux polyhedron P as the vertices of the following dual polyhedron:with I  R nn the identity matrix and I Irrev  R n|Irrev| the identity matrix filled with 0 rows for reversible reactions. Again the MCSs correspond to those vertices with q > 0, i.e. with b w < 0, and minimal support of v. As before, we determine the vertices by computing the EMs (rays) for q  0 and selecting afterwards the ones with support in q and minimal support in v. This generalization of MCSs in flux polyhedra yields a highly general modeling framework. Returning to scenario (6) for the network in, it becomes clear that the capacity constraints on reaction rates r 3 ,r 4 and r 5 imply different MCSs blocking all (steady state) flux vectors obeying the inhomogeneous constraints (6): it is now sufficient to remove either r 3 or r 4 because then the constraint for r 5 cannot be fulfilled anymore. This does not obviously hold when neglecting the inhomogeneous constraints. Combinations of inhomogeneous constraints can conveniently be integrated in the dual system (8) but are difficult to treat via the conventional way, i.e. by defining a set of target EMs and then computing the minimal hitting sets: whether an EM is a target EM or not is not a local property anymore; in general, only certain (conic) combinations of EMs fulfill a given set of inhomogeneous constraints. The following example illustrates the use of the dual description for a realistic application scenario where the classical way of MCSs computation cannot directly be used.
Minimal cut sets and elementary modes
ATP maintenance demand. Hence, the cells become more vulnerable against random failures or targeted removal of certain combinations of reactions.
DISCUSSION AND CONCLUSIONWe presented a novel method that allows the computation of MCSs without knowing beforehand or producing simultaneously the EMs of a stoichiometric network. Our computational approach is based on a duality framework, which completes the picture of dual relationships between EMs and MCSs (). Interestingly, both EMs and MCSs can be computed with the same algorithm, which enumerates extreme rays of a polyhedral cone. In addition to computational aspects, this duality offers a new perspective on function and dysfunction in biochemical networks: minimal functional units imply minimal failure modes and vice versa and their role can be interchanged in a dual network. It depends on the application which path of calculation the most effective one is. As a further extension, we proposed a generalization of the classical steady-state analysis in metabolic networks that permits to model arbitrary combinations of homogeneous and inhomogeneous conditions on reaction rates or even accumulation/exhaustion of certain metabolites. As computations can still be performed by the same method, this expansion is a promising tool to open the concept of EMs and MCSs to a wider class of applications.
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
