Motivation: Human genomic variability occurs at different scales, from single nucleotide polymorphisms (SNPs) to large DNA segments. Copy number variations (CNVs) represent a significant part of our genetic heterogeneity and have also been associated with many diseases and disorders. Short, localized CNVs, which may play an important role in human disease, may be undetectable in noisy genomic data. Therefore, robust methodologies are needed for their detection. Furthermore, for meaningful identification of pathological CNVs, estimation of normal allelic aberrations is necessary. Results: We developed a signal processing-based methodology for sequence denoising followed by pattern matching, to increase SNR in genomic data and improve CNV detection. We applied this signal-decomposition-matched filtering (SDMF) methodology to 429 normal genomic sequences, and compared detected CNVs to those in the Database of Genomic Variants. SDMF successfully detected a significant number of previously identified CNVs with frequencies of occurrence ≥10%, as well as unreported short CNVs. Its performance was also compared to circular binary segmentation (CBS). through simulations. SDMF had a significantly lower false detection rate and was significantly faster than CBS, an important advantage for handling large datasets generated with high-resolution arrays. By focusing on improving SNR (instead of the robustness of the detection algorithm), SDMF is a very promising methodology for identifying CNVs at all genomic spatial scales. Availability: The data are available at http://tcga-data.nci.nih.gov/tcga/ The software and list of analyzed sequence IDs are available at http://www.hsph.harvard.edu/∼betensky/ A Matlab code for Empirical Mode Decomposition may be found at:
INTRODUCTIONGenome-wide DNA aberrations (duplications, deletions and rearrangements) are part of the normal human genetic variability. Copy number variations (CNVs) occur at thousands of loci across * To whom correspondence should be addressed. the genome (). To date, over 66 000 DNA aberrations at 16 000 loci have been identified), and pairwise comparisons of human genomes suggest that they may differ by at least 1%, a 10-fold higher percentage than the previously estimated 0.1% based on single nucleotide polymorphism (SNP) incidence (). CNVs have also been associated with many diseases and disorders (), and may specifically play an important role in sporadic diseases (). Array comparative genomic hybridization (aCGH) is a highresolution technology that enables simultaneous interrogation of the entire genome. It involves hybridization of differentially fluorescent dye-labeled reference and test sequences on a microarray, and estimation of relative allelic changes as the log 2-ratio of the two fluorescence intensities. CNV detection is often limited by the resolution of the microarray and the data signal-to-noise ratio (SNR). Current platforms with >1 million probes enable the detection of shorter CNVs (1025 kb), and consequently capture the finer scale of genomic variability (). In practice, detection of short CNVs is still limited by high noise levels in the data. Consequently, methodologies that explicitly increase SNR to improve CNV detection are needed. Several detection methods have been proposed and applied to genomic data with variable success (). They include smoothing procedures (), Hidden Markov Models (HMM) (), Circular Binary Segmentation (CBS) (), a change-point method that segments a chromosome into regions of constant copy number, and the Genome Alteration Detection Algorithm (GADA) (), based on Bayesian learning. These methods aim to improve the true positive detection rate, not to increase SNR. Their performance also depends on the selection of appropriate thresholds for calling CNVs. The false discovery rate () or the Genomic Identification of Significant Targets in Cancer (GISTIC) approach are often used to establish these thresholds (). Genomic and measurement noise, as well as impurities and artifacts may contaminate aCGH data, decrease their SNR and introduce spurious spatial correlations (). Dimensionality reduction methods, including principal component analysis (PCA), independent component analysis (ICA) and wavelet decomposition (), have been applied for denoising and artifact
Signal processing approach for CNV detectionsuppression in genomic data. The lack of physical interpretation of some components, or lack of a priori knowledge of an appropriate mother wavelet, are respective drawbacks of these methods. Signal processing methods for locally increasing SNR are widely used in the physical sciences and engineering, where measured signals are often severely contaminated by different types of noise. When a waveform of interest is known or can be robustly estimated, it may be recovered from a noisy signal via pattern matching methods, e.g. matched filtering, which increases SNR locally, in regions where the known signal (the template) matches the observed signal, and reduces SNR elsewhere (). The application of signal processing methods to genomic data has been very limited, since these data are not truly continuous (). However, such methods may be very useful for improving CNV detection. In this article, data-driven signal decomposition (for denoising), followed by matched filtering, hereafter referred to as Sequence-Decomposition-Matched Filtering (SDMF), is proposed to locally improve SNR, and consequently restrict the genomic regions of interest and increase the specificity of CNV detection. SDMF is applied in normal genomic sequences from The Cancer Genome Atlas (TCGA). The performance of SDMF is compared to CBS through simulations. Detected CNVs are also compared to identified CNVs in the DGV.
APPROACHA two-step methodology is proposed, summarized in. Signal decomposition is performed to increase the overall data SNR and suppress artifacts, followed by matched filtering where pairs of genomic sequences are treated as both template and test signals and pattern matched, to increase SNR locally. CNVs are ultimately called based on their frequency of occurrence.
METHODS
Sequence decomposition for artifact elimination
DataACGH sequences (log 2 intensity ratios) from 429 normal samples were obtained from the Cancer Genome Atlas (TCGA). These included all 322 normals matched to glioblastoma samples, from all available data batches (14, 610, 16,), and all 107 normals matched to ovarian cancer samples, from all available data batches (9, 11, 15). The Agilent Human Genome CGH Microarray 244A was used for hybridization in both sets. Cytoband information was obtained from Agilent and TCGA (Gene list, http://chem.agilent.com). Detected CNVs were compared to those catalogued in the DGV. All sequences were segmented into individual chromosomes, which were then analyzed separately.), and appears to be highly correlated with the guaninecytosine (GC) content in DNA (). This artifact introduces spurious spatial correlations in the data, which makes the detection of CNV breakpoints difficult. Previous studies have applied different methods to suppress the artifact (). Each has advantages and shortcomings. For example, smoothing methods may eliminate small amplitude CNVs in addition to artifacts. The structure of typically non-stationary genomic log 2 sequences may be investigated using an appropriate decomposition method. There are very few truly data-driven methods for non-stationary signals, that do not make a priori assumptions on the shape of the unknown signal components (referred to as modes). The most-widely used method is the Empirical Mode Decomposition (EMD) (), which recursively decomposes a non-stationary signal into modes with significant amplitude contributions. These modes must satisfy two conditions: (i) they must have zero mean and (ii) they must contain a single extremum between zero crossings. In addition, they must be such that the signal reconstruction error between the original signal x(k) and mode-based estimated signa x(k) [see Equation
Mode estimation and signal decomposition(2)], defined) 2 , is minimized. The algorithm first identifies one set of maxima and one set of minima in a signal, and fits respective cubic spline functions through them to obtain the upper and lower signal envelopes. The mean of the two envelopes m 1,1 is then subtracted from the original signal. If the mean of the residual h 1,1 is zero, then h 1,1 is the first mode. In practice, multiple iterations are necessary, at which new means are estimated and removed from successive residual signals. This procedure continues until convergence, i.e. until the first q that satisfies: K k=0 |h 1,q1 (k)h 1,q (k)| 2 K k=0 h 2 1,q1 (k) <<,which implicitly ensures that h 1,q is zero mean. In Equation (1), k denotes probe and K is the total number of probes in a chromosome sequence. The first mode is then defined to be d 1 () = h 1,q (), and is subtracted from x() to obtain the residual r 1 (), which is then treated as the new signal. The sifting process is repeated for r 1 (),...,r M1 (), to obtain modes d 2 (),...,d M (). The decomposition stops once the difference between successive reconstruction errors, based on sets with progressively higher number of modes, is negligible. Additional criteria have been used to stop the mode estimation (), e.g. (i) the root mean-squared1, and/or (ii) a depletion of extrema through which to fit the envelopes, and/or (iii) a pre-defined upper bound on the number of modes is reached. Here we set an upper bound (M max = 30), which was, however, never reached. The signal reconstruction error was typically minimized when M  15 modes were estimated. Thus, EMD is also a dimensionality reduction approach. The reconstructed signal based on M modes is given by:for k = 1,...K. Some of these M modes may still correspond to highamplitude artifacts and/or noise. Thus, a subset M  M is ultimately selected, as described below. Although a powerful method, there are sources of variability in the EMD estimation. First, there are theoretically infinite combinations of modes with different amplitude distributions that can be estimated from a given signal (). There is currently no consensus on what constitutes an optimal basis (these modes form an approximately orthogonal basis) (), and thus the requirement of basis uniqueness is not satisfied. Second, the stoppage criteria for mode estimation are often arbitrarily set. Thus, a criterion for the selection of an optimum set of modes is desirable. Thresholding approaches, model selection criteria and penalized least-squares approaches can all be used to estimate a subset of modes (), since the stoppage criterion may not penalize Page: 2340 23382345higher order (redundant) decompositions. However, these methods do not directly provide a means for selecting an optimum mode subset. A different upper bound may result in a different distribution of modes, and a higher number of modes is not necessarily optimal. An example of a sequence and reconstructed signals using upper bounds of 20, 15 and 10 modes, respectively, are shown in. The reconstruction error based on 15 modes is two orders of magnitude higher than the error corresponding to 10 modes. To assess the effect of individual modes, signal x(k) may be decomposed into a set of modes that are sequentially eliminated to obtain the m-mode reducedxreduced reducedx m (k). This is then compared to x(k):
C.Stamoulis and R.A.Betensky
Awhere s(k) is the noiseless signal,  s m (k) is the estimate of this signal and   N(0,e are the additive Gaussian noise of the original and reconstructed signals, respectively. The requirement for denoising may be expressed asthe variance of the estimated signal is less than the variance of the noise in the measured signal. When additional modes are eliminated, the noise variance decreases further, i.e.However, sequential mode reduction may also eliminate significant components, resulting in large signal reconstruction errors. Thus, we need to bound the number of eliminated modes. We define the risk function as:When 0 modes are eliminated from the original signal,  x 0 (k) = x(k) and R 0 = 0. When the reconstructed signal is the optimum estimate of the s(k), thens then thens m (k)  s(k) and Equation (5) becomes:It is assumed thatsthat thats m (k) and w(k) are independent and thus  2Then, if we set the variance of the mode-reduced signa x equal to the risk function, we have [from Equationwhich ensures the desired  2  s   2  (assuming w m and  are positively correlated), with equality when (k) or w m (k) is zero, i.e. a noiseless measurement x(k) = s(k) or noiseless estimat x(k) =  s m (k) and asymptotic equality when K . There are several threshold estimation approaches for denoising, e.g. wave-shrinkage (). Although perhaps not optimal, our proposed approach has the advantage of not requiring detailed estimation of the threshold. Setting the variance of the mode-reduced signal equal to the risk function ensures that mode reduction increases SNR. An example is shown in, using a subset of the data. Typically, the variance and risk function intersected at mode 1 or 2, depending on the chromosome, and thus 12 modes were eliminated. We compared the proposed approach to loess curve fitting (), PCA and ICA. Corresponding changes in SNR (averaged over all sequences) are shown in. SNR was computed as the log 2 ratio at each probe divided by the SD of the signal, to be consistent with the definition of SNR in. Elimination of redundant ICA/PCA components and loess fitting yielded only modest changes in SNR. In contrast, mode elimination resulted in substantial increases in SNR. Similar results were obtained for all chromosomes.
Effect of normalization by a common referenceIn addition to the wave-like artifact, a common reference for normalization may also introduce spurious spatial correlations in genomic data. To explore this, the normalization was reversed by adding the log 2 reference to each observed sequence, to obtain non-normalized data:where x i is the non-normalized sequence and x i,obs the batch-normalized sequence. Each non-normalized sequence was decomposed. Contributions of low-amplitude modes were compared in raw and normalized sequences. The wave-like artifact was not suppressed in non-normalized data, which implies that it is unrelated to the normalization, as also noted in. We assessed the effect of renormalization (measured by the variance of the sequence) by renormalizing each sequence by the mean of all others, as shown is(for 20 sequences). The variance of renormalized raw and mode-reduced data were compared. The diagonal entries correspond to the variance of the non-normalized sequence. The effect of normalization was in some sequences significantly higher (O) than in others, e.g. the variance increase in sequence 1 was negligible when the sequence was normalized by 24, 814, 1820, but substantial when normalized by sequences 15 17. In contrast, renormalization of mode-reduced sequences resulted in small variance changes. Thus, denoising via mode elimination reduces the uncertainty associated with normalization by different sequences.
Matched filteringMatched filtering is a waveform-matching method that is widely used in pattern recognition, sonar and communications, to detect a desired waveformc(k) in a measured signal x obs (k). The matched filter is a quasi-optimum filter that locally maximizes the output SNR by decreasing SNR in regions of mismatch between observed and desired (template) signals and increasing SNR in matched regions. It improves SNR by reducing the noise spectral bandwidth to that of the desired waveform (). Theoretically, the optimum filter that maximizes SNR is the time-reversed signal itself, i.e. c(k) = x obs (k) under the assumption of Gaussian noise, and matched filtering is a convolution operation:
Page: 2341 23382345
Signal processing approach for CNV detection
A BTemplate signal: typically, the template c(k) is either precisely known or robustly estimated. An observed signal is then matched-filtered with this template. However, in this study there was no unique or known template. Every normal chromosome sequence was treated both as a template and an observation. To identify CNVs, regions of signal mismatch rather than regions of match were examined. Each of N s mode-reduced sequences was segmented according to the filter length described below, and each of Q segments was filtered with N s 1 corresponding segments (the templates), to obtain N s 1 matched-filtered segments. The ratio of pre-over post-filtering SNR SNR, was computed for each segment, and averaged over N s 1 SNRs. A matrix of SNRs was ultimately obtained of size N s Q. A segment was further examined for potential CNVs if SNR, averaged over N s was less than an estimated threshold, described below. Filter length: the choice of filter length is important for achieving optimal SNR. We examined the change in SNR following matched filtering as a function of filter length. We used the typical definition of SNRshows the average (over all sequences and chromosomes) SNR change as a function of filter length. Since the first change in slope of average SNR change occurs at a length of 500 probes, which was determined empirically to be sufficiently long for matched filtering, we selected this as the segment/filter length, though it may not be optimal. Threshold for estimating regions of mismatch: contrary to the traditional application of matched filtering, for CNV detection we are interested in regions of mismatch rather than regions of maximum match. This is because we presume that CNVs occur with relatively low frequency. Regions of mismatch not only include both allelic variability between two sequences but also potentially distinct noise and artifacts. Thus, the first step of mode decomposition for denoising is necessary. Furthermore, a threshold or random mismatch due to noise rather than true waveform mismatch must also be estimated, instead of assuming that any decrease in SNR, i.e. SNR  0, following matched filtering reflects waveform mismatch. We simulated and matched-filtered 500 pairs of identical, and thus theoretically perfectly matched signals, but corrupted with distinct additive Gaussian noise sequences, while maintaining high SNR. We estimated that noise-induced mismatch resulted in a maximum decrease in SNR of 1.5 dB. Therefore, regions where mean SNR in the filtered sequence decreased by more than 1.5 dB were identified as regions of potential true waveform mismatch. CNV call: matched filtering increases/decreases SNR according to match/mismatch, and thus the resulting signal amplitude in the filtered data may be different from the log 2 ratios in the original (but denoised) data. Thus, once potential segments of mismatch have been identified, we need to examine the corresponding segments in the denoised data for determining the actual type of aberration at the probe level. For simplicity, we set a detection threshold of one loss or one gain, i.e.probability of a CNV at probe k was defined as the union of the probabilities of (mutually exclusive) gain and loss. This is practically equivalent to the maximum of these probabilities since one of the probabilities is typically negligible relative to the other:
C.Stamoulis and R.A.Betensky
A
Bwhere N s is the total number of sequences, and log 2 (j,k) corresponds to the mode-reduced sequence j at probe k. A probability of 0.1 (10% frequency) was chosen as the threshold for a CNV call. Although this choice is somewhat arbitrary, low CNV frequencies  10% have been reported in the normal genome ().
RESULTS
CNV detection in the normal genomeWe applied SDMF to 429 normal sequences from the TCGA database, and compared them to CNVs in the DGV detected in datasets with least 420 samples, irrespective of their frequency of occurrence, as well as CNVs in two studies with 270 samples and high frequency (40%) (). For the Y chromosome, the maximum sample size in any study was 270. For two CNVs to be comparable, we assumed a very conservative 50% spatial overlap of the length of the detected CNV with respect to the length of the CNV in the DGV. In cases where the same CNV was reported by multiple studies, but with slightly different lengths, the intersection of these regions was assumed as the CNV length. Finally, when a detected aberrations was entirely contained within the genomic coordinates of the corresponding CNV in the DGV, it was called a separate CNV irrespective of its overlap (this occurred in only very few instances). On average, filtering restricted the regions of mismatch for further examination to 19 34% of the total number of segments, depending on the chromosome. This is expected as these were all normal sequences, and thus with high waveform similarities and low mismatch.summarizes the number of CNVs in DGV, in each chromosome, irrespective of frequency (column 2); the overall sensitivity of SDMF with respect to DGV, calculated as the ratio of the number of CNVs in the intersection of the two sets over the total number of CNVs in DGV (column 3); Cohen's kappa statistic (), as a measure of agreement between SDMF and DGV that accounts for overlap between the two occurring by chance (column 4); CNVs detected by SDMF with least 10% frequency (column 5); CNVs in DGV with at least 10% frequency (column 6); sensitivity of SDMF with respect to CNVs in DGV with frequencies at least 10% (column 7); and the corresponding kappa (column 8). Note that the kappa statistic is calculated at the probe level, by assuming that the maximum number of CNVs is the number of probes in each chromosome. However, CNVs in DGV have been detected with a wide range of arrays of different resolution. To account for this, we obtained the genomic coordinates for each identified CNV in the DGV and calculated the corresponding number of probes in our data, so that the two sets are comparable for the estimation of kappa. A significant number of detected CNVs have also been reported in DGV with frequencies 10%. For this subset, the sensitivity of SDMF with respect to DGV was 83%. The overall sensitivity of SDMF was lower (1760%). Furthermore, based on the accepted interpretations of levels of kappa (), the agreement between DGV and SDMF was slight (0 <<0.2) to moderate (0.4 < <0.6), depending on the chromosome. This may be due due to: (i) differences in the populations of DGV and TCGA normals; (ii) novel CNVs detected by SDMF; and (iii) the use of distinct thresholds for CNV calls in different studies. We can only assess the false positive rate of SDMF through simulations.
Comparison of SDMF with CBS via simulationSDMF may be applied to identify regions of mismatch, and thus to detect CNVs occurring at low frequencies in a relatively large set of genomes, or to identify regions of significant waveform match between sequences, and thus to detect common CNVs occurring at high frequencies. We compared SDMF to CBS. Although other. CNVs in DGV (column 2), sensitivity of SDMF with respect to DGV (column 3),  statistic (column 4), CNVs in DGV and in this study, with at least 10% frequency (columns 5 and 6), sensitivity of SDMF with respect CNVs in DGV with at least 10% frequency (column 7) and the corresponding  (column 8).methods have been shown to be computationally faster, e.g., CBS is widely used for CNV detection (), by simulating both cases (match/mismatch). The respective performance of the two methods was measured by the true and false detection rates, as a function of SNR and inter-CNV distance. Sequences were corrupted with additive, multiplicative or periodic (sine wave) Gaussian noise. SNR was measured in decibel. We simulated 1000 sequences (100 per each of 10 noise levels). In this set, CNV frequency was 100% and matched filtering was applied in the traditional sense, to identify regions of maximum match between template and test sequences, which corresponded to regions containing CNVs. To simulate low-frequency occurring CNVs, all but 1025% of sequences in this set were randomly selected and replaced by pure Gaussian noise. An example of a sequence containing 1 short CNV (300 markers long), contaminated with progressively higher additive noise levels (decreasing SNR) is shown in. Note that SDMF was applied to simulated data in the same way as in real data, using noise-contaminated sequences as both the template and test signals. All sequences were first mode-decomposed for denoising. The matched-filtered sequences corresponding toare shown in. matched filtering successfully suppressed noise in regions of mismatch, even in very low SNR (7 to 10 dB), locally increased SNR in the neighborhood of the CNV by at least 5 dB and decreased SNR elsewhere by at least 3 dB. This example demonstrates the ability of SDMF to detect even shortCNVs in very high noise levels. Note that when a template with high SNR is precisely known, the first step of signal denoising by mode-reduction results only in modest additional increases in SNR (<2 dB). However, when a robust template is not precisely known and/or is noisy, mode decomposition is a necessary pre-processing step.In the examples shown in, CBS performed very well for SNR 6dB, but detected spurious CNVs at lower SNRs. In contrast, SDMF correctly identified one CNV in all sequences. In cases of pure noise (no CNVs), neither SDMF nor CBS identified any CNVs. Also, the additional simulations for mismatch did not change the results of CBS, which processes each sequence individually. True and false detection rates of SDMF and CBS as a function of SNR, noise type and distance between CNVs are summarized in. SDMF correctly detected at least 70% of CNVs irrespective of SNR and noise type, compared with at least 15% detected by CBS. Multiplicative noise decreased the true detection rate in both methods, but periodic noise did not significantly affect detections by SDMF, possibly due to the initial denoising. With regard to inter-CNV distance, for fewer than 1000 markers, SDMF detected 84% of CNVs, versus 40% by CBS, at low SNR. CBS sometimes detected closely spaced CNVs as a single CNV. Also, the estimated mean gain/loss, which depended on the accuracy of the CNV breakpoints, was more precisely estimated by SDMF, particularly for SNR < 6 dB. Finally, false detection rate, estimated as the ratio of falsely identified CNV probes over the number of true non-CNV probes, increased significantly for multiplicative and periodic noise for CBS but not for SDMF. This calculation was based on 8000 probes and a varying number of CNVs of different lengths. In simulations for mismatch, the true detection rate was higher for SDMF than CBS and the false detection rate was lower. As expected, the false detection rate of SDMF in these simulations was slightly higher than the corresponding rate in simulations for waveform match, since it is calculated at the probe level and random mismatch at low SNR may affect the estimated CNV length. In general, although SDMF substantially outperformed CBS at low SNR, CBS performed well for higher SNR. However, the computational cost of CBS was significantly higher (O(5) in simulations and O(8) in real data). Next-generation CGH arrays withvery high resolution will require computationally efficient analysis methods. SDMF can handle large genomic datasets, whereas CBS is limited in that respect.
Signal processing approach for CNV detection
Page: 2344 23382345
C.Stamoulis and R.A.Betensky
DISCUSSIONWe have developed SDMF, a computationally efficient methodology that combines the signal processing tools of signal decomposition and matched filtering for CNV detection in array CGH data. The latter are inherently noisy and robust CNV detection is difficult at low SNR. SDMF treats genomic sequences as spatially continuous, non-stationary signals, which are denoised through elimination of noise-related components. Spatially localized matched filtering is then applied to identify regions of pairwise match/mismatch. Through these two processes, SDMF increases SNR and improves the specificity of CNV detection. Note that SDMF requires the selection of the matched-filter length and thresholds for match/mismatch and loss/gain for CNV detection. These were not explicitly optimized in this study. The choices of filter length and match/mismatch thresholds are dataset dependent. The log2 ratio threshold depends on the goal of the study, e.g. for detection of pathological CNVs it may be based on the log2 ratios of normal CNVs. SDMF was applied to 429 normal sequences from the
Signal processing approach for CNV detectionTCGA, and detected CNVs were compared to those in the DGV. Very high sensitivity (83%) relative to the DGV for CNVs with frequency 10% was estimated. In simulations, SDMF had a higher true detection rate and significantly lower false detection rate and computational cost than the CBS method, an important advantage when analyzing large datasets from very high-resolution arrays. In summary, SDMF is a promising approach for CNV detection even in very noisy genomic data. Microarray platforms are rapidly improving and remain the most appropriate tool for interrogating the entire genome at a reasonable cost. Although next-generation sequencing technologies are very promising, their cost currently prohibits the analysis of the entire genome, and may require significant amounts of DNA not always available. Furthermore, there is much information to be gained from existing well-annotated array-based studies through the application of highly sensitive and computationally efficient methods such as SDMF.
The Author 2011. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oup.com at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from [12:17 11/8/2011 Bioinformatics-btr402.tex]
