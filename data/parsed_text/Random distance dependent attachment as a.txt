Motivation: The topology of the network induced by the neurons connectivity's in the Caenorhabditis elegans differs from most common random networks. The neurons positions of the C.elegans have been previously explained as being optimal to induce the required network wiring. We here propose a complementary explanation that the network wiring is the direct result of a local stochastic synapse formation process. Results: We show that a model based on the physical distance between neurons can explain the C.elegans neural network structure, specifically, we demonstrate that a simple model based on a geometrical synapse formation probability and the inhibition of short coherent cycles can explain the properties of the C.elegans' neural network. We suggest this model as an initial framework to discuss neural network generation and as a first step toward the development of models for more advanced creatures. In order to measure the circle frequency in the network, a novel graph-theory circle length measurement algorithm is proposed. Contact:
INTRODUCTIONNeural networks can have up to 100 billion synapses (). The information defining the position of each synapse is not hard coded into the genome, since the number of genes coding for the properties of the neural network does not exceed a few hundred, even for the complex network of the Homo sapiens (). Axon guidance, for example, is determined by a few tens of genes [specifically 93 in the Caenorhabditis elegans] mainly Nertins, Ephrins and Semphorins (). The position of each synapse must therefore be determined by other means. The synapse positions can be a combination of genetically coded hardwired connections, stochastic processes or learning mechanisms (). The relation between the neurons positions and the network wiring has been extensively studied in the context of optimal wiring (; * To whom correspondence should be addressed.; Perez-Escudero and). The neuron positioning was proposed to be optimized to minimize the total axon and dendrite lengths (). The neuron positions were indeed found to reduce the wiring length (compared to a random positioning). However, it is not clear whether the neuron positioning is optimized to minimize the wiring or if the short wiring is simply the result of the preferential attachment of nearby neurons. The only currently existing fully mapped neural network is the one of the CE. As part of the CE project, a full map of the CE cells was produced, and all neurons and synapses were mapped (). The observed CE has 302 neurons and 2170 synapses, which are divided into motor, sensor and intermediate neurons. A wide distribution of synaptic connections characterizes the CE network. Neurons with a high number of synaptic connections are mostly localized on the main nerve ring. The nerve rings, bundles of 100 axons encircling the outside of the pharynx, are the principal circumferential tracts in the CE nervous system (). Axons from sensory neurons in the anterior ganglia form six labial nerves that enter the nerve ring at its anterior margin. Most axons from neurons in the lateral ganglia enter the nerve ring at its posterior margin either laterally or ventrally via the ventral ganglion. Other neurons, such as sensors and motor neurons, are naturally localized near the edges of the nematode. However, there are also a large number of sensors near the pharynx because the pharynx centralizes much of the sensory activity of the nematode. In the current work, we propose to study the CE NN generation mechanism using network theory tools. We represent the CE NN neurons as nodes and synapses as edges. Hundreds of network generation mechanisms were proposed in the last few years, some very generic and some specific to a given network (e.g. among many others (). The simplest network generation mechanism model was suggested by. In this model, a network is constructed by randomly connecting nodes. For a given Erdos Renyi Network with n nodes [ERN(n,p)], the probability of connecting each pair is p. This network has a Poisson degree distribution, 1 and short average geodesic distances between nodes. 2Page: 648 647652
R.Itzhack and Y.LouzounAnother well known set of models explains Scale Free Networks (SFN). These networks have a power-law degree distribution, where the probability that a random node would have k neighbors is p(k) = k  , with values of  usually between 2 and 3 (). A more structured model was proposed by Strogatz and Watts (SW) (1998). This model explains the frequently observed combination of short geodesic paths and a high clustering coefficient. 3 The average geodesic path of the network represents the average minimal number of edges from a random node to another one, and the clustering coefficient of the network quantifies approximately the fraction of closed triangles in the network. This model basically transfers a spatial regular lattice into an Erdos Renyi network. Models incorporating the nodes positions were also proposed such as the gravity model (). In the gravity model, the probability of an edge between a node couple decreases with the distances between the nodes. Specifically, in the context of the CE, Artzy-Randrup (Artzy-Randrup and Ben) suggested that the small scale motif analysis performed by Milo () should consider the spatial features of the CE. We here propose that the gravity model can explain many of the observed CE neural network properties. In the current context, this model can be interpreted as a synapse formation probability proportional to a power of the physical distance between the soma of the pre-synaptic neuron and the dendrite of the post-synaptic neurons. The properties of this network depend on the spatial positioning of the different neurons.
METHODS
Degree distributionThe degree k(i) of a node is defined as the number of neighbors of the node i. It can be divided into the indegree (degree of incoming edges), outdegree (degree of outgoing edges) and total degree. P(k) is the probability that a randomly selected node has a degree of k.
Distance distributionThe shortest path or geodesic distance d(i,j) is defined as the minimal number of edges from node i to j. Note that in a directed graph, the shortest path d(i,j) from i to j is usually not equal to the shortest path d(j,i) between j and i. In fact both are longer or equal to the undirected shortest path, since the undirected path often violates the correct edges direction. The average shortest path is defined as the mean of the distance matrix that represents the shortest paths between all connected nodes.
Clustering coefficientThe clustering coefficient [C.C(i)] of a node i is the fraction of its neighbors that are connected one to each other. Given the set of k(i) neighbors of a node i, one could in principle have k(i)/2 undirected edges between them. The number of connected neighbors divided by k(i)/2 is the C.C. For a large, completely random graph the average CC is <k>/N, while for a clique (group of nodes which are completely connected to each others) the C.C is 1. 3 The clustering coefficient of a node in a network is the fraction of the node's neighbors that are connected one to each other. The clustering coefficient of a network is the average clustering coefficient of its nodes.
Betweenness centrality (BC)Given all the geodesic distance in a network, the betweenness centrality C B (v) of a node v is defined as the fraction of the shortest paths passing through v:where  st denotes the number of shortest paths from node s  V to node t  V , and  st (v) is the number of shortest paths from node s to t passing through v  V. We have computed the BC using the highly efficient Brandes algorithm ().Page: 649 647652
Model for neural network generation
Translation of the CE neural network to a graphThe CE NN is fully mapped and contains 302 neurons and 2170 synaptic connections between them (; Hall and Russell, 1991;). We used the connectivity data () that was recently updated from an earlier version (). The connected part of the network contains 280 neurons and 2170 synaptic connections. Each synaptic connection between a dendrite and an axon was treated as a single edge and each neuron was represented as a node. All edges were considered to have an equal weight.
SimulationWe placed the neurons according to their observed positions, publicly accessible in the 'WormAtlas' project (WormAtlas, 2009). We defined the probability of creating an edge between two neurons as:The c constant was set to produce the proper number of edges in the network (synapses in the neural network), and the value of  was varied. For each value of , we check the average properties as measured from 50 simulations. We used our publicly accessible network analysis toolbox to measure all the networks properties (Muchnik).
RESULTSThe network properties of the CE NN differ from most known networks. The CE NN stands half-way between an ERN and a scale free network. The CE NN degree distribution is neither a power law (black line in), nor a Poisson distribution. The CE NN has a large number of nodes with a very low degree on one side and a fat tail on the other side. The CE NN clustering coefficient is high (0.19 versus 0.016 in parallel ERN). Its shortest paths distribution is also longer than the one typical to ERN (), and it has a peculiar small-scale motif distribution (Supplementary). The CE NN degree distribution also differs from the one expected in a Strogatz and Watts model (). The CE NN evolves through cell division and synapse formation () over a limited spatial region (). Neurons with distant soma have a lower probability of being connected, as can be seen from the observed distribution of synapses and pre-synaptic soma physical distances (). Note that some of the neurons are long and span most of the nematode body affecting the distance distribution. The probability of connecting two neurons decreases with the distance between the soma centers. If only neurons with short span are considered, the decrease is approximately geometrical with a power between 2 and 3, except for a small group of distal connections that will be further discussed. We here propose an attachment model that follows the observed node position and synapse distance distributions. All neurons were placed in their observed experimental position, and the probability of creating an edge between two neurons was defined as: p(i  j) = c d i,j . In order to test the validity of our model, we tested whether the model reproduces the generic features of the observed CE NN. The only free parameter in the simulation is . We run multiple simulations with different values of , and for each such value, we did 50 simulations. Most of the properties of the LS are similar to the CE NN for  2.5 (and). The average geodesic distance (4.004 against 4.01  0.1), the full shortest path distribution and the average connectivity (244.1  6.67properties, the simulated spatial network and an ERN. The upper left drawing represents the nodes shortest paths distribution, where the similarity between the real CE NN and the local simulation (LS) network can be seen, in contrast with the ERN. The lower left panel represents the degree distribution on a loglog scale. The upper right drawing is the connectivity distribution and the lower right drawing is the betweenness centrality distribution. In all drawings, one can clearly see the similarity between the CE NN and the LS network, and the difference to the ERN.the physical distance distribution of neurons with short spans as a fraction of the total nematode body length. In neurons which are long and span most of the nematode body (more than half the size of the nematode), the neuron itself contributes significantly to the physical distance and the physical distance distribution of all connected neuron pairs is flat (full gray line). against 239.4) are similar between the LS and the CE NN, and very different from the ERN or SFN. The connectivity of node i is defined as the number of nodes in its connected component. The only feature that is different between the LS and the CE NN is the clustering coefficient, which is 2 SD away from the LS results. The SD of each Page: 650 647652
R.Itzhack and Y.LouzounA B C DThe results from all the networks that we measured are summarized. The real CE NN compared with the average results of 50 LS network ( = 2.5), 50 ERN and 50 SFN. The rows represent the networks and the columns the properties. The results of the CE network are very similar to the spatial simulation. The only difference between the networks is in the circle distribution. feature is computed among all realizations of the LS with the same value of . A more complex feature of networks is the BC. The BC represents for each node the sum of the fractions of his participation in geodesic paths. The BC distributions of the LS and CE practically overlap (). Twenty percent of the nodes have an almost zero centrality. These neurons represent sensors or motors located at the edges of the nematode. The top 10% of the nodes have an abnormally high BC (i.e 10007000). This group probably represents the neurons located at the nerve ringsthe parallel in the CE to the CNS (). The properties of the LS network are sensitive to the value of , and at  = 2.5 these properties are highly similar to the ones of the observed CE NN (). In order to understand the meaning of the optimal value of , we tested the effect of  on the LS network structure. -values providing a good fit to the CE NN properties reside at the transition between a fully connected, yet random network (in the ErdosRenyi sense of the term) and a disconnected one (). This transition can also be observed in the real CE NN (). As  grows, so does the average shortest path, the clustering coefficient and the fraction of bidirectional edges (cycles with only two nodes). For very low values of , the simulated network is practically an ERN, while for very high values of , it is a set of cliques. 4 The choice of the -value at the transitions between the two regimes suggests that the nematode may 'attempt' to produce a local structure, while maintaining an almost full connectivity. This model can actually be used as a more natural way to obtain a small world network than starting with an artificial rigid lattice and transforming it into an ERN. Here the high clustering coefficient is obtained since nearby nodes have a high probability of being connected and thus small cliques are created. The above-mentioned network measures are macroscopic features of the network. A more microscopic picture can be obtained by looking at the small scale motif distribution. The 3-motif distribution of the observed CE NN, the LS and an ERN was compared. As previously reported (), the CE NN has a nonrandom motif distribution. Indeed, for all 3-motifs a statistically significant difference is found between the CE NN and a scrambled version of the CE NN (Supplementary). The CE NN is also very different from the ERN (Supplementary). However, the CE NN and the LS demonstrate a very similar behavior for all motifs, with the exception of the three nodes simple directed circle motif (motif number 9). This motif appears half as often as expected in the CE NN, while in the simulated network it appears twice as often. This motif is simply a coherent 3 nodes circle. The specific difference in a single motif hints that directed circles are selected against. In order to systematically test this possibility, we developed a new measurethe minimal circle length distribution. A minimal circle is defined as a closed couple of shortest paths between two neighbors. Such circles in general tend to be short, since large circles containing a short circle are ignored (Supplementary). The circle distribution of the CE NN has a long tale with a maximal length of 11 neurons, and many 811 neuron long circles (25% of the circles). This is in contrast with an average circle length of <3 in the ERN (). It is also much longer than predicted by the LS. These differences suggest a functional mechanism limiting directed short circles. Such a mechanism is expected if neural networks require long circles of information flow. To further validate this conclusion, we changed our model to mimic destruction of synapses participating in three and four node circles. First, 500 extra edges were added to the network. These edges were then removed selectively from 3 and 4 node circles. We denote this model as LS1. In LS1 the main features of the network did not change significantly (Supplementary). The motif frequency now fully fits the observed CE NN, and the number of circles of length 2 to 5 is similar to the real CE NN (, Supplementarycircle number between the simulation and the CE NN may further be explained by a positive selection of long circles. We checked for a specific selection of long circles through the experimental positions of the neurons in the CE NN () and the ganglion to which they belong. The Euclidian length (the sum of the distances between the centers of the soma) of experimentally measured circles with a large number of edges is much longer in reality than expected from the simulation. Moreover, all nodes in long circles belong to the same ganglia and form pre-defined consistent physical pathways. One can thus conclude that in contrast to all other features studied here, the long circles are a hard coded feature of the CE NN.
Model for neural network generation
DISCUSSIONThe CE NN is currently the only fully mapped network. Beyond its obvious physical parameters (size, number of neurons, number of synapses and the physical position of the neurons), it has several well-defined properties, such as its peculiar degree distribution, clustering coefficient, centrality and shortest distance and circle distribution. This fully mapped network allows us to test if the network structure is predetermined and rigid, or is based on a simple stochastic process. We have tested the simplest stochastic process where the probability of creating a synapse decreases geometrically with the physical distance. This model contains a single parameter and can explain the vast majority of the network properties. The main difference between the proposed model and the experimentally measured CE NN is the low number of coherent circles in the observed network. This may be due to a secondary process that limits useless very short information cycles and increasing the number and length of long circles. Such an inhibitory process is reasonable, taking into account that most axon guidance and neural adhesion genes are inhibitory. Thus, the network generation is a mixture of spatial and functional limitations. The proposed model suggests that the network properties can be explained by the need to maintain global connectivity and a local structure. Such a balance leads to the creation of local nerve rings with a high internal clustering on the one hand and the creation of long range axons on the other hand. At the mathematical level, these two requirements limit the values of  to a very narrow range and explain most of the network properties. A complementary view of neural networks is that the neurons positions have evolved over long periods to minimize the wiring length. Neuron positions may have evolved to optimize some functionality, for example, through the aggregation of neurons in rings. However, the observed minimal wiring length cannot serve as a proof for such a mechanism. The proper positioning of neurons based on their wiring properties can be an artifact of the network generation mechanism. We have applied an optimal wiring algorithm () to the network produced by the simulation and obtained a average error of 0.17  0.03 in the node positions (random positions would give 0.35  0.01). A similar error was obtained when the CE NN was used. The analysis was performed assuming a single synapse between each pair of connected neurons. While the nematode's NN is much simpler than that of primates and advanced vertebrates, its generation rule may hint to the way much more complex networks are generated. One may extrapolate from these results two basic building elements: (i) a local stochastic creation mechanism combined with functional limitations on short coherent circles, (ii) local structure and long range connectivity need to be maintained. Such a model can be the prototype for the way the structure of large complex networks can be theoretically coded by a very small number of genes.
Conflict of Interest: none declared.
The degree of a node is the number of other nodes directly connected to it.mk 2 The geodesic distance between two nodes is the minimal number of edges in the path between the two nodes.  The Author 2010. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oxfordjournals.org
at :: on August 31, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
.5 Small-scale motifs We have characterized the network using the number of small connected subgraph frequency, compared with their expected frequency in a randomized network (Itzhack, 2007; Kashtan et al., 2004a, b; Louzoun et al., 2006; Milo et al., 2002). These 34 node sub-graphs are denoted as network motifs. Recently, network motifs have attracted attention as a tool to study networks' microscopic details, such as the structure of connections between all connected triplets (Milo et al., 2002). We have computed the motifs of sizes 3 and 4 using a novel and highly efficient algorithm (Itzhack, 2007). 2.6 Circle enumeration A directed circle is a closed directed path containing no repetitions (i.e. none of the nodes in the circle appears twice). We define a minimal circle as a circle composed of a minimal path from one node to the other and the minimal path back to the original node. We have developed a rapid algorithm to enumerate all such circles. The naive algorithm would find the minimal geodesic path between all node pairs in a directed graph, G(V ,E), using a Breath First Search (BFS) algorithm (Tutte, 2004), and check for each source node v source whether nodes at the end of the path have a direct edge to the source node v source. This algorithm would, however, count each circle multiple times (Supplementary Fig. S1). The only way to count each circle once would be to maintain a list of all circles, and check for those only present once in the list. This naive algorithm is extremely costly, and becomes impractical even for networks of a few hundred nodes. We developed a practical algorithm that counts each node only once. If a circle of size r is counted j times in the nave algorithm, the circle counter of size r increases only by 1/j, every time this circle is measured. j is the number of nodes in the circle, with a directed distance of r to the node pointing to them in the circle. In other words, if in a circle of length 8 (for example), the distance from a node v k to its precedent is <8, it implies that there is a shortcut in this circle, and one will not count the circles when starting from v k (Supplementary Fig. S1). A circle of size r would be counted exactly r times only if the direct distance from each node to its precedent is r 1. We thus do not use a data structure but only count for each circle how many nodes have a distance of r 1 to their precedent. The total cost of the algorithm is O(V*E*l) where l denotes the average geodesic path length. The total memory cost is O(V 2 * L) (in the worst case), where V 2 denotes the number of all the shortest paths between pairs of nodes, and l denotes the average geodesic path length. 2.7 Network analysis toolbox library We have developed a comprehensive network analysis toolbox library containing graph import and generation tools, graph manipulation routines and network analysis tools to carry out a large number of network measurements, across many applications and disciplines. This MatLab based toolbox provides a coherent, easily expandable environment, which to the best of our knowledge is the most complete graph analysis package available today. At the time of writing, it implements over 100 analytical and utility methods for graph analysis and manipulation (Muchnik, http:// www.levmuchnik.net/Content/Networks/ComplexNetworksPackage.html).
Groups of nodes which are completely connected to each others.
