Motivation: Detecting positive selection in genomic regions is a recurrent topic in natural population genetic studies. However, there is little consistency among the regions detected in several genome-wide scans using different tests and/or populations. Furthermore, few methods address the challenge of classifying selective events according to specific features such as age, intensity or state (completeness). Results: We have developed a machine-learning classification framework that exploits the combined ability of some selection tests to uncover different polymorphism features expected under the hard sweep model, while controlling for population-specific demography. As a result, we achieve high sensitivity toward hard selective sweeps while adding insights about their completeness (whether a selected variant is fixed or not) and age of onset. Our method also determines the relevance of the individual methods implemented so far to detect positive selection under specific selective scenarios. We calibrated and applied the method to three reference human populations from The 1000 Genome Project to generate a genome-wide classification map of hard selective sweeps. This study improves detection of selective sweep by overcoming the classical selection versus no-selection classification strategy, and offers an explanation to the lack of consistency observed among selection tests when applied to real data. Very few signals were observed in the African population studied, while our method presents higher sensitivity in this population demography. Availability and implementation: The genome-wide results for three human populations from The 1000 Genomes Project and an R-package implementing the 'Hierarchical Boosting' framework are available at
IntroductionOver the past decades, many different methods to detect positive selection from polymorphism data in genomic regions have been developed (for reviews see). Such methods rely on the different genomic patterns left by a hypothetical selection event occurring in an idealized population: a beneficial de novo mutation arises and increases in frequency in relatively few generations until eventually it reaches population fixation. This specific mode of positive selection is known as the hard sweep model (Maynard). Through the effect of genetic hitchhiking, this process leaves some characteristic patterns in the region surrounding the beneficial allele (selective sweep), such as skewed site frequency spectrum toward low-frequency variants (), strong linkage disequilibrium (LD) patterns leading to extended haplotype homozigosity (EHH) (), and population differentiation (). Computational methods developed to distinguish such patterns have helped to identify the genetic basis of some examples of human adaptation, such as the lactase persistence allele () or the malaria resistance gene variants (). However, most of those methods usually lack consistency in reporting the same selective events along the genome (), causing a loss of confidence in the approach. This disagreement was thought to appear due to specific power of the different methods to uncover selection patterns under some local features of a given genomic region (such as specific recombination map), or due to specific demographic dynamics of the studied populations. Thus, during the last decade, special effort was made to incorporate population-specific demographic models and region-specific recombination maps to approximate the neutral model to more complex and realistic scenarios (). While these approaches clearly improve the sensitivity to detect positive selection, they did not explain the continued lack of concordance between methods, which raised concerns on false positive and false negative rates (). Recently, a new family of selection tests started to appear: statistics based on composite approaches combining different positive selection tests, and tuned using neutral and selection simulations (). Individual tests are sensitive to different modes and tempos of adaptation according to the specific molecular pattern they are aimed to identify. However, individual positive selection tests and most of the composite methods implemented so far address the selection analysis as a binary classification problem (i.e. selection versus no selection), ignoring the specific features of the analyzed selective sweeps, such as the extent of completeness (i.e. final frequency of the selected allele) or the time depth of the event (recent versus ancient selective events). In this study, we developed a hierarchical classification framework based on a boosting algorithm (using a similar approach to that presented in) to scan the whole genome for several evolutive scenarios. We trained the algorithm with simulations under different selective scenarios considering different final allele frequencies (FAF) for the selected allele (completeness of a selective sweep) and with different timespanning selective events (age of a selective sweep). We demonstrate that our approach achieves high sensitivity toward general hard selective sweeps, and can provide information about their relative age of onset. Once calibrated, we applied it to empirical genome-wide data from The 1000 Genomes Project (The 1000 Genomes Project Consortium, 2012). We provide the results of our analysis for three continental human populations as UCSC tracks that can be easily loaded in any UCSC Genome Browser server and an R-package implementing the 'Hierarchical Boosting' framework (http://hsb.upf. edu/). We detected a $13-fold and $15-fold decrease in significant signals in the African population as compared with the European and East Asian populations, respectively, while our method showed better sensitivity in African-ancestry simulations.
MethodsThe classification method described in this study is based on a machine-learning algorithm called boosting (from the mboost R packageB hlmann and). Boosting is a supervised algorithm that estimates linear regressions (hereafter referred as boosting functions) of input variables (summary statistics of selection tests) to maximize the differences between two competing scenarios (e.g. complete versus incomplete selective sweeps). Our method sequentially applies different boosting functions into a hierarchical classification scheme to optimally classify genomic regions into different evolutive regimes.). To avoid biases in our analysis due to heterogeneous power to detect positive selection across the genome (), we filtered out any indel and high-coverage SNVs annotated in this release. We also took into account the well-described low SNP calling sensitivity toward rare variants () by applying a 'singleton thinning' strategy to the simulated dataset as explained in Extended Methods (Supplementary File S1). The SNV data were already phased by The 1000 Genomes Consortium and its phasing state was kept in order to apply haplotype-based statistics. We also used both the ancestral allele state genome and the global genetic map provided by the consortium.
Reference empirical data
Coalescent simulationsWe used the coalescent simulator cosi (version 1.2.1; see the initial description in) which includes a tuned human demography for three continental populations of Northern Europe, East Asian and African ancestry (CEU, JPT/CHB and YRI, respectively). In addition to the neutral scenario, cosi can simulate classic selective sweeps (i.e. under the hard sweep model) under specific constraints (): cosi does not allow any population effective size change or migration between populations while selection is occurring. Accordingly, selective sweeps were simulated in a period when population effective sizes do not change in any population (between 10 and 45 Kya;). Nine different timespanning selective sweeps were simulated covering different time periods between 10 and 45 Kya (thereafter grouped as Recent, Recent Long or Ancient selective sweeps). And within each timespanning selective sweep, we simulated five different FAF for the selected allele (and grouped them as Complete, Incomplete or Partial selective sweeps, as explained below).
Mutation rate and generationMachine-learning framework to detect and classify hard selective sweepstime was set to 1.5  10 8 mutations/year/bp and 25 years, respectively. We also used the hotspot recombination model implemented in the simulation package (recosim) in order to obtain more realistic genome-wide LD patterns. More details of the demographic model and selection parameters used in our simulations are provided in Supplementary File S2 and Supplementary. We computed 3000 replicates for the neutral scenario and 100 replicates for each one of the 45 selection scenarios. For each replicate, we simulated regions of 600 kbp to allow extended homozygosity statistics to calculate properly the EHH decay. Sample size in our simulations was 97, 85 and 88 diploid individuals for CEU, CHB and YRI populations, respectively, matching the sample size of the reference dataset.
Implemented positive selection testsWe previously had implemented a bioinformatic pipeline including 21 different positive selection statistics (Supplementary). The pipeline design and detailed descriptions for the selection tests can be found in. We ran our positive selection tests to the whole 600 kbp simulated sequence after applying a 'singleton thinning' strategy, as explained in Extended Methods (Supplementary File S1). Then, we used the results from the centraland incomplete selective sweeps as a first step (or first level) in our hierarchical classification framework (). Thus, a first boosting function (Complete Boostingfunction 1a) comparing complete sweep cases against incomplete, partial and neutral cases was trained and calibrated (at 1% FPR) to be sensible exclusively to complete selective sweeps. Once complete sweep signals were classified/discarded, a second boosting function (Incomplete Boosting function 1b) was trained and calibrated (1% FPR) to distinguish between incomplete sweep cases, and partial and neutral cases. At this point, the cases classified as partial or neutral were left unclassified, as the sensitivity of the selection tests to partial sweeps was extremely low and hardly distinguishable from neutral cases. Once this first 'classification level' was finished, we trained specific boosting functions (Recent/Ancient Boostingfunctions 2a/2b) for each one of the categories obtained in the previous step (Complete/ Incomplete scenarios) to distinguish between recent and ancient cases. Again, thresholds of 1% FPR were used, so only true cases of each category could be correctly classified. Because of the difficulty of assigning the age category with accuracy, many cases remained with age category undefined at this second step. According to the hierarchical nature of the algorithm, a given genomic region (either empirical or simulated) is sequentially classified into the nine categories defined in the decision tree ().
Alternative classification treesTwo more alternative classification trees were tested but presented lower performance: an 'independent' configuration showed higher misclassification rates and a 'non-hierarchical' configuration produced a lower accuracy overall. See the details for the alternative classification trees in Supplementaryand their classification power in Supplementary Table S6.
Results
Method performanceUsing an independent set of evaluation simulations with the same parameters as the training dataset, we evaluated our framework performance. We calculated population-average classification power for each scenario in the evaluation dataset (Supplementaryand B). Similar population-specific tables are found in Supplementary Table S1. Population-averaged, our Hierarchical Boosting method was able to classify the evaluation scenarios with low number of misclassified replicates (5.37% of Complete sweeps classified as incomplete or vice versa), and even lower false positive cases (Neutral and Partial scenarios classified either as Complete or Incomplete; 1.06%). Nonetheless many cases of Incomplete sweeps were left unclassified (47.95%), making Hierarchical Boosting a conservative method for Incomplete sweeps. It also showed different correct classification rates depending on the scenario: Complete sweeps were easier to classify (89.58%) than Incomplete sweeps (43.41%), probably because most of the positive selection tests were implemented to detect hard sweeps that already reached fixation. Concerning the Ancient/Recent classification, our method is again conservative, leaving 66.28% evaluation replicates unclassified while showing an extremely low misclassification rate (1.26%).shows the classification power of the time-frame boosting functions (Ancient/Recent) for those replicates that have passed the Complete/Incomplete classification step. In this case, Ancient sweeps (both Complete and Incomplete) were slightly more well classified (33.35%) than Recent sweeps (31.56%). When looking at population-specific performance (; Supplementary) we noted that Hierarchical Boosting performed better in correctly classifying selective sweeps for the simulated African-ancestry population (93.44% for Complete and 52.27% for Incomplete sweeps) than in the simulated Out-of-Africa populations (89.42% for Complete and 37.44% for Incomplete sweeps in the European population, 85.87% for Complete and 40.50% for Incomplete sweeps in the East Asian population).
Comparison with other composite methodsWe used three state-of-the-art composite methodsevolBoosting (), CMS () and SFselect ()to detect positive selection to compare their performance with our method. These methods are also tuned using neutral and selection simulations, thus we consider them ideal for a comparison analysis. However, all of them confront the problem of detecting selection as a binary outcome (i.e. selection versus no selection). Instead, our method tries to give insights about the nature of an observed sweep, thus it classifies it in more than two categories. We believe that this approach increases the value of our method regardless of its sensitivity to general hard selective sweeps. To allow a fair comparison between the methods evaluated, we used the Complete and Incomplete boosting functions independently (outside of the classification framework). We applied those methods to the evaluation simulations for the European population, and used the distribution of the central 25 kbp region on neutral simulations to calculate the 1% FPR threshold to, in turn, calculate their sensitivity at our selection simulations (always using the central 25 kbp region). A full description of the methods implementation can be found in Supplementary File S4.shows the resulting sensitivity of each composite method for the selective sweep categories defined in this study. We also evaluated the FPR at Neutral simulations for all the methods as well. Our method (more specifically, the Incompleteboosting function) showed the highest sensitivities at all the simulated selection scenarios compared with the other implemented methods, with the lowest sensitivity for the Incomplete Ancient scenario (59.25%). Our Complete boosting function shows lower sensitivity at Incomplete scenarios because it was trained not to be sensitive to incomplete selection sweeps. Curiously, the CMS genome-wide and CMS local implementations failed to detect complete sweep signals, most probably because both CMS scores combine results from all the applied tests: iHS and diHH (population-specific tests) cannot be calculated in alleles that have reached fixation, leading to a lack of polymorphism in the central 25 kbp region of our complete sweep simulations. In Supplementary File S4, we discuss why, in our opinion, the CMS functions exhibit much lower sensitivity in our evaluation sets than described in the original articles.
Application to the 1000 Genomes dataWe applied our population-specific 'Hierarchical Boosting' implementations to the reference empirical genome-wide data that was used to calibrate our simulations. We obtained a list of 25 kbp windows per population that were classified according to the different boosting functions described above. Then, we implemented an algorithm that estimates the number of selective events by concatenating consecutive 25 kbp windows, allowing for a valley of non-significant scores as long as they do not contain any recombination hotspot. The algorithm implementation is explained in detail in Supplementary File S3 and Supplementary Figures S3S6. After applying the algorithm we counted 27, 355 and 424 selective events in YRI, CEU and CHB populations, respectively (Supplementary). A $13fold and $15-fold difference in the number of selective events were detected in CEU and CHB populations in relation to YRI population, respectively. In addition, we classified the selective events according to the boosting function scores showing significance in the genomic region encompassing the selective sweep signal (Supplementary). We observed few signals with any ambiguity for the sweep Class (Complete or Incomplete): only 10.2% (0, 7.6 and 12.1% in YRI, CEU and CHB, respectively) of the identified selective sweeps in any of the three populations show significant scores for both Complete and Incomplete boosting functions (Supplementary). Moreover, these ambiguous signals exhibit a much longer size and lower proportion of significant scores as compared with unambiguous (discriminant) signals (Supplementary Figures S4 and S5); hence, most of the ambiguous signals may actually arise from different adjacent independent selective events. Conversely, most of the selective events could not be assigned to a sweep age (Ancient or Recent): only 59.4% of the identified selective sweeps in any of the three populations (44.4, 71.5 and 50.2% in YRI, CEU and CHB, respectively) could be assigned a given age. This demonstrates the difficulty to assess the age of a sweep even considering a large amount of tests. Here, we have designed a very conservative framework for that purpose, as demonstrated by the very low number of regions with a signal that have been assigned to both Recent and Ancient selective sweeps (0, 0.6, 2.4 and 1.5 in YRI, CEU, CHB and any of the three populations, respectively). Moreover, although the classification power of our method is lower for Incomplete scenario we detected more Incomplete than Complete sweeps in the CEU population (58.9 and 33.5%, respectively), and even numbers of Complete and Incomplete sweeps detected in YRI and CHB. Finally, we generated UCSC supertracks to easily visualize our Hierarchical Boosting results in a UCSC Genome Browser server (). Visualizing selective sweeps in a genome browser helps to properly evaluate their genomic context, and to propose candidate genes under putative positive selection (Supplementary File S5). The provided UCSC tracks represent a novel and unified view of the different types of selection analyzed in this study (complete, incomplete, ancient and recent selective sweeps). Using individual selection tests will only highlight the types of selective sweeps that a given test is sensitive to. For example, iHS alone may be able to detect incomplete selective sweeps, but it will never detect complete ones. Furthermore, our method provides information about the nature of the selective sweep detected (age of onset), which can help to elucidate the biological and historical context of a given selective event. The supertracks and the raw Hierarchical Boosting results can be found in a dedicated server (http://hsb.upf.edu/), as well as a detailed explanation on how to interpret them.
Interpretation of the estimated boosting functionsWe standardized the regression coefficients assigned to each positive selection statistic within a given boosting function, as in Lin et al.In our classification framework both Complete and Incomplete boosting functions are considered together. This way, the low sensitivity shown by the Complete boosting function toward incomplete sweeps is masked by the Incomplete boosting function. In this sensitivity analysis we have used them separately to be comparable to the other methods.(2011). These standardized coefficients give an insight into the relevance of a given test to distinguish between two competing scenarios (). We found that to indicate Complete sweeps, the statistics positively correlated are, in order of importance, XP-EHH, dDAF, Fu & Li's D, Omega and CLR. Conversely, the statistics negatively correlated to a Complete sweep signal are iHS, Fay & Hu's H and XPCLR. Once Complete sweep signals are classified, the Incomplete boosting function is applied to the remaining ones. In this case, the statistics indicating Incomplete sweeps are iHS, XP-EHH and dDAF. For the boosting functions uncovering time-frame properties of a selective sweep, we observed that in Complete Recent sweeps, XP-EHH contributed the most along with EHH Average, and Fu & Li's D. Instead, for Complete Ancient sweeps, Tajima's D and dDAF are the more relevant ones. Within Incomplete sweep cases, iHS highlights recent selection patterns while dDAF defines older selective events. Those results are concordant to the sensitivity described for individual tests given the final frequency of the selected allele and the tempo of selection (e.g. see). Finally, we notice that our three population-specific boosting functions showed very similar coefficients, indicating that the method is robust to continental human demography ().
Missing hard sweep signals in Yoruba populationWe report fewer selective events or regions under selection ($13-fold and $15-fold reduction) in African-ancestry populations (YRI) than Out-of-Africa populations (CEU and CHB, respectively). Low number of selective events in several African populations was also reported in. But the authors acknowledged that this result could be explained by low sensitivity of the implemented tests of selection on genotyping data in African populations. On the contrary, our method shows greater power to uncover selective events for African-like demography than Out-of-Africa ones (CEU and JPT/CHB) as shown in Supplementary Table S1. The dearth of selection footprints in African populations could be explained by selection acting on standing variation in Africanancestry populations (soft sweep), rather than de novo mutations (hard sweep). Moreover, the Out-of-Africa human diaspora likely occurred through serial founder effects, a specific case of population bottlenecks. Such a demographic scenario seems to increase the fixation rates of de novo favored alleles (). Moreover,recently showed that population bottlenecks can bring a soft selective sweep to generate molecular footprints that are expected under the hard sweep model (hardening of soft sweeps). In fact, under a serial founder demography, it is likely that a unique haplotype carrying the standing favored mutation is sampled during a strong bottleneck event (). This would imply that complete hard sweep signals (even though they started as soft sweep) should be more frequent in Outof-Africa populations, as observed in our study. Nonetheless we demonstrate that hard sweeps have definitely not been common in African populations (or at least in the Yoruba population studied here), and underlines the still crucial role of demography in understanding human adaptation ().
PerspectivesThe statistical framework applied in this study is based on the estimation of composite scores of selection tests (boosting functions) that maximize the differences between two competing scenarios. Appropriate thresholds are then used to produce a binary outcome. These competing scenarios (and their boosting functions) are embedded in a hierarchical classification tree, which is structured according to the relevance of the properties that can or want to be classified. Unlike multinomial logistic regression and other multi-category algorithms, our framework allows to set up significance thresholds at each classified category and hierarchical step. This way, it is possible to minimize the FPR for a given scenario, or relax classification accuracy for other ones. We believe that this flexibility increases the value of our statistical framework when applied to the study of natural selection. A possible improvement in classification accuracy could imply the use of non-linear classifier algorithms (like some variations of SVMs, ANNs or k-nearest neighbors algorithms), as the response of the selection tests to different selection scenarios is likely to be nonlinear. It is still unknown whether other boosting-like algorithms, like gradient boosting, may improve the strategy outlined here. This study offers a unique and powerful way of detecting candidate regions in the genome that have been evolving under positive selection in a more reliable way than many lists produced by single selection tests or even some other existing composite methods. It also distinguishes, in many cases, the final state (complete/incomplete) and the relative age (ancient/recent) of a given selective event. Our framework implementation emphasizes the minimization of false positive results, even if it implies a number of unclassified results. Thus, we give strong support to the cases in which positive selection is detected.
Funding
at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
kbp region containing the selected allele (and driving the signal of selection) to train our boosting algorithms and evaluate the method. Since we needed a unique score for every 25 kbp region to apply the boosting algorithm, we used a specific summary statistic for each test (minimum, maximum or mean), as shown in Extended Methods (Supplementary File S1) and Supplementary Table S2. Next, we had to remove some selection tests from the analysis. Some cross population tests were not suitable to be combined under our framework, such as F ST , and others needed some corrections before using them, as with XPEHH or dDAF. In addition, some correlated tests were removed to achieve coefficient convergence and avoid over-fitting during the algorithm training process. The details of this selection process is explained in Extended Methods (Supplementary File S1) and summarized in Supplementary Table S4. The final list of selection tests used in the training process were: CLR (Nielsen et al., 2005), iHS (Voight et al., 2006), XP-CLR (Chen et al., 2010), XPEHH (Sabeti et al., 2002b), dDAF (Hofer et al., 2009), diHH (Voight et al., 2006), Fay and Wu's H (Fay and Wu, 2000), Omega (Pavlidis et al., 2010), EHH Av (Sabeti et al., 2002b), Fu and Li's D (Fu and Li, 1993) and Tajima's D (Tajima, 1989). 2.4 The hierarchical boosting framework We define a boosting function as a linear regression function of the scores of individual positive selection tests. This function is estimated through a boosting algorithm (B hlmann and Hothorn, 2008; Hothorn et al., 2010), and in turn, can be used as a classification method by setting up a significance threshold. In our framework, four different boosting functions were sequentially considered within a hierarchical decision tree implementation (Fig. 2). 2.4.1 Competing scenarios We grouped the simulated datasets according to common selective sweep features. Hence, we created classes of different selection scenarios according to the FAF of the selected variant as main property or Class (Complete: FAF  1.0, Incomplete: FAF  0.8 and 0.6, Partial: FAF  0.4 and 0.2 and Neutral scenarios). Concurrently, the scenarios were grouped again according to the number of generations elapsed since the end of the simulated selective sweep or Types (Recent: from 25 to 10 Kya, Ancient: from 45 to 30 Kya) (Fig. 1). Once our competing scenarios (Fig. 2) were defined, and the 11 positive selection tests were calculated, we ran the machinelearning algorithm to train four boosting functions which allowed us to distinguish between competing groups of scenarios (Supplementary Table S3). We systematically verified coefficient convergence for every estimated boosting function (Supplementary Fig. S14). To circumvent a putative convergence to local instead of global optimal, and thus, to obtain a more robust regression, we developed a bootstrapping strategy explained in Extended Methods (Supplementary File S1). We used the mean coefficient values for each positive selection test obtained across the bootstraps to build our final boosting functions. Then, we calculated the thresholds for the estimated regression scores that were needed to classify the evaluation datasets allowing up to a 1% false positive rate (FPR). 2.4.2 Algorithm description After noticing that the main feature driving selection signals in almost all the selection tests was FAF, we decided to classify complete Fig. 1. Coalescent simulations were run following a calibrated human demographic model (Schaffner et al., 2005) mimicking population genetic data from three reference continental populations (YRI, CEU and JPT/CHB). Nine different time-spanning selective sweeps were simulated (grouped as Neutral, Recent, Recent Long and Ancient) allowing for five different FAF (FAF  0.2, 0.4, 0.6, 0.8 and 1.0) Fig. 2. The implemented 'Hierarchical Boosting' classification tree
M.Pybus et al. at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
Machine-learning framework to detect and classify hard selective sweeps
Discussion 4.1 Detection and classification of hard selective sweeps The inference of positive selection using population genetics data usually focuses in determining whether a genomic region exhibits signals of positive selection or not. However, while in simulation studies most of those tests show similar power to detect hard selective sweeps, in real data few of them coincide to point to common selection signals. We believe that this lack of consistency among tests is explained by their different power to detect different types of selective sweeps. Because of that, we think that the strategy of combining shared signals from different selection tests, as implemented in other composite methods, will highlight only those selective sweeps for which all the implemented tests show high detection power, which generally means the 'strong recent hard' selective sweep. We showed that the implementation of a hierarchical classification framework enables classification of a given genomic region into specific adaptive regimes and can explain the lack of consistency of different selection tests in empirical data. We have compared Hierarchical Boosting with other composite methods (SFselect, CMS and evolBoosting) and we found that our method shows higher sensitivity to the different selection scenarios evaluated. In addition, Hierarchical Boosting is the only unifying method that gives information about the nature of the detected selective sweep while preserving great sensitivity toward general hard selective sweeps.
