Motivation: The transformation of the embryo during development requires complex gene networks , cell signaling and gene-regulated cell behaviors (division, adhesion, polarization, apoptosis, contraction, extracellular matrix secretion, signal secretion and reception, etc.). There are several models of development implementing these phenomena, but none considers at the same time the very different bio-mechanical properties of epithelia, mesenchyme, extracellular matrix and their interactions. Results: Here, we present a new computational model and accompanying open-source software, EmbryoMaker, that allows the user to simulate custom developmental processes by designing custom gene networks capable of regulating cell signaling and all animal basic cell behaviors. We also include an editor to implement different initial conditions, mutations and experimental manipulations. We show the applicability of the model by simulating several complex examples of animal development. Availability and implementation: The source code can be downloaded from: http://www.biocenter. helsinki.fi/salazar/software.html.
IntroductionMulti-scale computational models help in making the complexity of development more amenable to the human mind. They may be conceived as summaries of what is known about the development of an organ or embryo part. Such summaries, however, should be built upon explicit mechanistic hypotheses about how development works in these systems. Computational models can then provide explicit quantitative predictions about how an embryo changes over time according to each specific mechanistic hypothesis. These quantitative predictions (e.g. quantitative morphology as the position of each cell in space and the levels of expression of different genes in space) can then be compared with experimental results to facilitate the rejection or provisional acceptance of a hypothesis (further experiments would be required for actual acceptance of an hypothesis). There is a long list of models of pattern formation and morphogenesis involving cellcell communication and biomechanics. Some of them simulate the development of different organs, such as teeth (), limb (), turtle shell's scutes (), to cite a few. In other cases, processes involving the whole embryo, such as gastrulation in the sea urchin, are reproduced). Others implement a framework of cell biomechanical interactions and gene regulation, including one or several cell behaviors, namely cell division, apoptosis and growth. Some early models already identified the relevance of the combination of cell signaling and morphogenetic movements by making the local curvature of epithelial to depend on morphogen concentrations (). The cellular Potts model (CPM) () defines a regular lattice in which cells occupy several contiguous lattice positions. Cells may extend to further lattice positions or retract from them by minimizing a Hamiltonian energy function based on cell adhesion, volume conservation and other mechanical properties. The CPM is especially suitable for developmental systems in which cells change their neighbors and shape in rather dynamic ways (such as in cell sorting and migration by chemotaxis and haptotaxis). However, tissues in which forces can be transmitted along a specific direction at long distances, such as in epithelia, may not be so easily grasped by the CPM. There are several models based on CPM that implement several cell behaviors such as cell division, cell migration (by chemotaxis), apoptosis and cellcell signaling (). In the vertex model (), cells are defined by the contact surfaces with other cells or the media. Each cell is a polygon [or polyhedron in the three-dimensional (3D) case] defined by a set of vertices and edges (and faces in the 3D case). Forces are calculated based on overdamped motion equations or a Monte Carlo algorithm. This model is suited to simulate dynamics of densely packed tissues like epithelia but is not very well suited to simulate processes involving mesenchymal tissues or processes in which cells move freely in the extracellular space and seldom form tightly packed cell condensates. In some cases, cell signaling and gene regulatory networks have been implemented as well (). The viscoelastic model (or IBCell model) () combines an off-grid representation of cells as elastic bodies with a lattice Boltzmann method to simulate intra and intercellular fluids. Thus, each cell is represented by a set of points forming an elastic body in a continuous two-dimensional space, but chemical substance concentration is calculated on a regular grid in discrete space. Then the position of each cell part on this grid has to be interpolated every time to correctly calculate how fluid fluxes in the grid affect cell shape. This implementation and level of detail make the model computationally very costly and thus precludes, according to the authors (), its extension to 3D problems. Several cell behaviors have been implemented: cell proliferation (), cell growth and cellcell signaling (). The subcellular element model (SEM) (;) is an off-latice model in which cells are made of groups of point elements that interact mechanically based on a potential equation. Motion is computed with Langevin overdamped dynamics. In some cases, cells are modeled with a single subcellular element, thus approximating Drasdo's spheroid model (). The original model does not implement any cell behaviors apart from cellcell adhesion, but in a more recent implementation of the model (), cell division, polarization, cell signaling, migration and some basic gene networks are implemented. Here, we present a new general multi-scale model of development, the EmbryoMaker, that differs from previous models in a fundamental way: the model recognizes that the bio-mechanical properties of epithelia, extracellular matrix (ECM) and mesenchyme are crucial to correctly understand many processes in early animal development and in organogenesis. Other models are adequate for either mesenchymal cells or flat epithelia but not for both or for their interaction as it occurs in development (Biggs and Mikkola 2014). The EmbryoMaker is based on the SEM for mesenchymal cells but not for the epithelia and for the non-mechanical interactions. Epithelial cells are instead assumed to be made of cylindrical subcellular elements rather than spheres as cells in the SEM. In addition, epithelial-specific rules are used to capture how epithelia interact with mesenchyme and ECM and, in general, how they behave in development. In addition, our model implements the most complete set of basic cell behaviors used by cells in animal development (cell growth and division, cell death, cell migration, polarization, ECM secretion, cellcell adhesion, cellcell signaling and epithelial to mesenchymal transition). This is done by a unified set of rules acting on the cells' subcellular elements. EmbryoMaker includes also a detailed implementation of cell's molecular mechanisms involved in regulation and cellcell communication. This includes transcriptional and posttranscriptional gene networks and signaling by the diffusion of gene products in the extra-cellular space and the binding to their specific receptors. A fundamental aspect of the model is that the gene products present in each subcellular element can regulate its mechanical properties and activate or repress specific cell behaviors. This allows an explicit multi-scale coupling between microscale regulatory molecular processes and macroscale mechanical properties and cell behaviors.
Structure of the modelOur modeling framework is, thus, multi-scale; it includes cells, ECM, cell parts and regulatory molecules that interact in intracellular networks and molecules that diffuse between cells in the extracellular space and affect gene expression in other cells (see Supplementary). The parameters of the model specify how much each molecule regulates those and also the intra and extracellular molecule regulatory network. The model allows to implement any arbitrary gene network and initial condition. Thus, different implementations of the model will have different number of parameters according to how many genes and molecules it includes. The number of subcellular elements (also called nodes in here) in a cell and the number of cells can change due to cell growth and cell division.
BiomechanicsSubcellular elements or nodes represent a physical part of a cell. Mesenchymal nodes are spherical, while epithelial nodes are cylindrical. Each cylinder consists of two elements that move independently, an apical and a basal one, which may have different mechanical properties. These two nodes are tied by an elastic spring (). The ECM consists of spherical nodes that do not belong to any cell. Each node has a radius of interaction p ADD that defines the maximum distance at which the node is in contact with other nodes and a radius of equilibrium p EQD at which the mechanical interaction is at equilibrium (i.e. the interaction force is zero). Nodes i and j will experience a repulsive force when they are closer than their equilibrium distance (d EQD ij) and an attractive force when their distance is longer than d EQD ij but closer than d ADD ij (and Supplementary Data). The modulus f Aij of the mechanical force vector is calculated as,Note that the elastic coefficients (k REP ij and k YOU ij) may be different in the repulsive and attractive case and depend on the mechanical properties of the nodes i and j (that in our model can be regulated by molecules). The direction of force vectors differ between the mesenchymalmesenchymal, the epithelialepithelial and the epithelialmesenchymal interaction, since vectors need to be normal to the contact interface between the two elements (, see Supplementary Data). Our model, thus, makes the assumption, as in the SEM, that cell shape can be represented with some degree of accuracy by a set of movable points (the nodes) that adhere to each other (so that each cell is a cohesive entity by the cohesion between its nodes). This way adhesion between cells is represented also as adhesion between nodes. We also assume that no two cells can occupy the same physical space and that, thus, there would a repulsion force when two nodes get to close. The model also assumes, in contrast to the SEM, that epithelial tissues always tend to minimize local curvature () and that epithelial cells always tend to orient their apical-basal axis normal to the local tissue surface. In order to evaluate the local curvature between apical nodes i and j, we consider the vector ~ c ij , connecting those two nodes, ~ s ik and ~ s jl as the vectors that define the elastic link to their basal counterparts and ~ m ijkl as the sum of ~ s ik and ~ s jl which defines the vector normal to the surface between i and j. The bending radial force tends to minimize the local curvature of the epithelial sheet, while the bending rotational force reorients the cylinders, so that their longitudinal axis (~ s) is always normal to the epithelial surface (Where k EST ij and k ERP ij derive from node's mechanical properties and the circumflex denotes unit vector. Note that the force vector ~ f ESTij will be normal to the epithelial surface and ~ f ERPij will be parallel to the vector connecting i and j (). Motion is computed by a hybrid method, solving a system of PDEs assuming Langevin overdamped dynamics (see Supplementary Data) and then applying Monte Carlo random displacements to a certain proportion of nodes at each time step (See Supplementary Data). This way some stochasticity is introduced into the model.
Gene and molecular regulationThe model assumes that all molecules are contained within the system's nodes, whether they belong to a cell or to ECM. Diffusion is then the transport of molecules between nodes. Thus, both calculations of movement and specific molecule concentrations occur only on nodes and molecules carried by nodes, respectively. We use the term regulatory molecules to refer to any molecule irrespectively of whether a molecule is a gene product or not. Each regulatory molecule has a set of intrinsic characteristics that are assumed to be genetically encoded and thus do not change over model dynamics. We call those molecular parameters. For each regulatory molecule, these are diffusivity coefficient, intrinsic rate of degradation, regulatory interactions at the level of transcription and at the level of catalytic reactions, regulation of each node property and regulation of cell behaviors and cell properties (See Supplementary Data). Some regulatory molecules act as inter-cellular adhesion molecules, for which there is a matrix that specifies the binding affinity of each pair of adhesion molecules. Transcription occurs only in the nuclear node of each cell, and we assume it follows a saturating function similar to MichaelisMenten (as in many other previous models,):Where Q ik is the rate of transcription of gene k in node i, g il is the amount of transcriptional factor l in node i and t lk is the strength by which each specific transcriptional factor k activates (positive t lk ) or inhibits (negative t lk ) the transcription of gene l. The sum is done through all the regulatory molecules and by definition only transcriptional factors have t lk terms different from zero. The set of t lk values in a model constitute the matrix T (whose size depends on the number of genes included in the model). U is a function that is equal to 0 for values of x smaller than 0 and equals to x when x is greater than 0 (Ux  0 if x < 0 and Ux  x if x > 0). This function is used to ensure that there is no such a thing as negative transcription (although t lk can be negative and thus repress transcription).EmbryoMakerThe model represents two states of the same protein as two different regulatory molecules with different molecular properties. Non-transcriptional enzymatic reactions mediate the transformation of one regulatory molecule into another. Thus,The first term defines the rate of production of regulatory molecule k in node i due to the transformation of other molecule l into k catalyzed by j. The second term defines the rate of loss of form k due to its transformation into molecule l mediated by catalysis by j. Each element r jlk specifies the catalytic activity of regulatory molecule j on the transformation of regulatory molecule l into regulatory molecule k. As before, we assume MichaelisMenten kinetics similar to those known to occur in enzymatically catalyzed reactions. For simplicity, we assume K M equals 1. As before the set of all, r jlk values constitutes matrix R.
Molecular diffusion and signalingWe assume that regulatory molecules can diffuse between nodes in a cell. Extracellular diffusible molecules can diffuse between nodes in different cells. For these molecules, its concentration in a node represents concentration in the extracellular space close to the node. Diffusion cannot occur in empty space but it can occur in aqueous media represented as ECM nodes. This is implemented by applying Fick's second law in the context of the irregular and changing mesh made by all the nodes that are not too far from each other (this distance is itself considered, see Supplementary Data for details). This method allows to implement diffusion in a way that is not computationally very costly. Since molecules are only defined within nodes, they cannot diffuse toward empty spaces or cavities. This limitation can be overcome, if necessary, by filling empty spaces with ECM nodes. Diffusible molecules may interact with membrane receptors. The model also considers membrane tethered ligand and receptor complexes, such as in the Notch-Delta signaling pathway (, see Supplementary Data).
Cell behaviors and regulation of node propertiesThe model is specifically designed to incorporate all animal cell behaviors as simple rules on cell nodes (, see Supplementary Data and Supplementary Figs. S5S10). This way the temporal and spatial scales of these rules are compatible with each other. Growth is increase in the sizes of the elements in a cell, until a maximum element size is reached (and Supplementary). Only then a new small element is added to the cell, which can then undergo further growth. The model allows to choose the number of elements a cell is made of (though that number may fluctuate due to growth, division or death). Large number of elements per cell should be chosen when cell shape changes are a driving force in development. Otherwise cells can be chosen to comprise few or even a single element. Cell division is the splitting of a cell's nodes between two daughter cells (and Supplementary, see Supplementary Data). Apoptosis is implemented as a gradual decrease in the size of nodes in a cell (and Supplementary, see Supplementary Data) until nodes, and eventually the cell, disappear. Adhesion is implemented as the strength of the attractive force between elements from different cells. Cell contraction, or expansion, is simply a limited decrease, or increase, in the size of some elements in a cell. This can occur actively as a result of gene expression changes. Nodes can also have some degree of plasticity, which can be genetically regulated, and decrease or increase their size if put under strong compressive or tensile forces, respectively, by surrounding nodes. Migration is the result of random node movement (see Supplementary Data) biased by differential adhesion or chemoattractant gradients (although the mobility of elements can be increased by gene regulation to simulate cell body extensions like filopodia). Cell shape changes are the result of the relative movements of the elements in a cell. ECM secretion results from the production of ECM nodes by cells expressing a specific gene (and Supplementary, see Supplementary Data). Cells can also undergo epithelial-mesenchymal transitions (and Supplementary, see Supplementary Data). An important aspect of our model is that all cell behaviors and elements' bio-mechanical properties (such as adhesion) can be affected by the regulatory molecules present in nodes. Specific equations apply for the molecular regulation of each cell behavior, see Supplementary Data for details. Each column of matrix C specifies how strongly each molecule positively or negatively regulates a certain cell behavior. Regulation of node mechanical properties at each time step follows:Where p l i t is the value of node property l in node i at time t and p l i 0 is the value of that node property l in node i when the node was created (this is in the initial condition or when the node first arose through growth). p DIF i is the degree of differentiation in node i (differentiation slows down changes in nodes). The effect of molecule k on node property l is the model parameter e lk of matrix E. A slightly different rule applies to node size, p EQD. At each time step, this property is equal to:The first term is due to active contraction, the second to cell growth or apoptosis, the third to cell mechanical plasticity and the fourth to volume conservation. Cell contraction occurs when a molecule regulates negatively the node property p COD. Since contraction is happening in the nodes, cells may have contraction in only part of its nodes, as it is necessary in a number of developmental processes such as in invagination by apical cell contraction. p COD is calculated as in Equation (7) above. The other terms are explained in the Supplementary Data. The cell behaviors described above are in fact the most basic animal cells have. However, individual cells can do more complex behaviors by differentially activating these basic cell behaviors in different parts of the cell. This is possible in our model because different nodes in a cell can have different concentrations of different regulatory molecules (since transcription occurs in the nucleus node but other reactions and signaling occurs in all nodes). This allows a rich set of spatially polarized cell behaviors. Thus, for instance, the orientation of cell division plane is by default normal to the longest axis of the cell following Hertwig's rule () but can be oriented in the model by the direction of intra-cellular gene product gradients through the nodes in a cell (that may arise from extra-cellular gradients through signaling, not affecting transcription). In a similar manner, intra-cellular gradients can regulate asymmetric division () quantitatively controlling how much larger is one daughter cell with respect to the other. Similarly, intracellular differences in regulatory molecule concentrations can lead to contraction of only specific parts of a cell, as in the apical contraction required for invagination of epithelia. Similarly, cells can migrate in a polarized manner by preferentially extending more filopodia toward one side of the cell than to others. This can be reproduced in the model by differentially regulating the mobility of nodes along the cell.
Initial conditions, model parameters and model structureFor the application of the model to the study of pattern formation and morphogenesis in a specific experimental developmental system, three sets of developmental parameters need to be specified by the user: (i) The network of interactions between regulatory molecules (the T and R matrices), (ii) how these regulatory molecules affect each node property (E matrix) and cell behavior (C matrix) and (iii) the initial conditions as the spatial location of each node and the quantity of each regulatory molecule in each of them.
ImplementationThe EmbryoMaker software implements the model herein described and provides a user-friendly environment to design and manipulate custom developmental systems. An editor allows the user to design cells, nodes and gene expression in the initial conditions or at any time during a simulation. The NetworkMaker software allows to design and edit gene network topologies and set model parameters. A central panel displays each application network. User Manuals are downloadable from 'http://www.biocenter.helsinki.fi/salazar/ software.html'. We use the cell behavior ontology () for the example model of sea urchin gastrulation (Section 4). The OWL file describing the system can be downloaded from 'http://www.biocenter.helsinki.fi/salazar/software.html'.
Application examplesIn this section, we provide a set of examples of how the model can be applied to animal development. The aim in these examples is not to understand their dynamics better but to show that the model is realistic and general enough to consider many different animal systems. We have started by implementing a set of developmental mechanisms that have been proposed to be the most basic ones in animal development (). This is the simpler developmental mechanisms able to produce pattern formation by using only one cell behavior (seeand Supplementary Figs. S11S16 for the genotypephenotype maps). We also apply the model to a paradigmatic example of animal morphogenesis: the sea urchin gastrulation (). In this example, we do not intend to provide any new fundamental understanding about the sea urchin development per se. Instead we use sea urchin gastrulation to explain the steps by which the model is applied to a specific system. At the onset of gastrulation, the sea urchin embryo consists of a hollow sphere of epithelial cells with some mesenchymal cells scattered in the blastocoel cavity. At the vegetal pole of the embryo, there is a group of cells called the vegetal plate. The early invagination of the vegetal plate arises from two combined processes: the apical constriction of the vegetal plate cells and the secretion of ECM on their apical side (). Experiments by Lane et al. applied different drugs to sea urchin embryos to specificallyEmbryoMakerinhibit each of those two processes. By applying either one drug or the other different degrees of invagination were achieved, with no invagination when both drugs were applied. The initial conditions assumed in the application of our model consist of a hollow epithelial sphere surrounded by an external ECM layer acting as the semi-rigid egg cover of the sea urchin (hyaline layer). It is known that only cells in the vegetal plate are involved in apical constriction and ECM secretion, so we assume a molecule (from now on called molecule A) to be present in the apical side of the most central vegetal cells in the embryo (in black in) to regulate those two processes. The model assumes that actomyosin contraction in the apical cell cortex triggered by molecule A results in a decrease of apical cell surface, which is translated as a decrease in apical surface of the cell's cylinders. The initial conditions were set with the EmbryoMaker editor. We set the three different experimental conditions using NetworkMaker. In the first, we set an e lk value different from zero and negative, so that A leads to apical contraction by decreasing the contraction radius, p COD , as specified in Equation (7) (with k being for contraction and l being for molecule A). In the second experiment, A promotes the secretion of ECM in the nodes where it is present according to the equation for ECM secretion:Where p ECM i is the rate at which ECM accumulates around node i. c ECM m is the C matrix element where the effect of molecule m (in this case A) on ECM secretion is specified and g im is the concentration of m in node i. Once p ECM i reaches a value of one a ECM node is secreted near node i (see Supplementary Data for the equations for the molecular regulation of other cell behaviors). Thus, this equation simply assumes that the rate of secretion of ECM is a linear function of the concentration of the regulatory molecules that promotes this secretion. In the third experiment, A promotes both processes at the same time. The first experiment is the one in which an applied drug inhibits ECM secretion, the second is the one in which a drug inhibits apical contraction and the third is the one in which no drugs are applied. The experiments thus only involve different values in the e A COD and e A ECM parameters. These were manually set to match the morphologies observed in the two drug experiments. When these two values are used at the same time, in the third experiment, a deeper invagination resembling the one observed experimentally (), when drugs are not added is found in the model simulations (). There are several earlier modelling approacheson the initial conditions in (A). The left column shows, in section, the node types. Blue for basal side of cylinders, violet for the apical side of cylinders, red for mesenchymal cells and orange for ECM nodes. Middle and right column display concentrations of GF2 and TF5, respectively (yellow for high concentration, blue for low concentration). See Supplementary Data Section 2 for details on sea urchin gastrulation () that undergo a more analytical and systematic study of the invagination process. However, as we mention earlier, our aim in this example is only to show that our model can be applied to real developmental systems. The above examples consider only developmental mechanisms that involve only one or two cell behaviors at the same time. An additional example combines the regulation of several different cell behaviors to show how from simple initial conditions () a more complex gastrula-like embryo can be produced (see Supplementary Data section 2 for a more detailed explanation of the observed dynamics).
DiscussionOur model differs from previous ones in implementing all the cell behaviors known in animal cells. In addition, it explicitly implements the molecular quantitative regulation of all cell mechanical properties and cell behaviors. Ours differs from previous models in explicitly considering the different mechanical properties of epithelial and mesenchymal cells and ECM and their interactions.
at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
M.Marin-Riera et al. at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
