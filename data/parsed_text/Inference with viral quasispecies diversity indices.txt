Given the inherent dynamics of a viral quasispecies, we are often interested in the comparison of diversity indices of sequential samples of a patient, or in the comparison of diversity indices of virus in groups of patients in a treated versus control design. It is then important to make sure that the diversity measures from each sample may be compared with no bias and within a consistent statistical framework. In the present report, we review some indices often used as measures for viral quasispecies complexity and provide means for statistical inference , applying procedures taken from the ecology field. In particular , we examine the Shannon entropy and the mutation frequency, and we discuss the appropriateness of different normalization methods of the Shannon entropy found in the literature. By taking amplicons ultra-deep pyrosequencing (UDPS) raw data as a surrogate of a real hepatitis C virus viral population, we study through in-silico sampling the statistical properties of these indices under two methods of viral qua-sispecies sampling, classical cloning followed by Sanger sequencing (CCSS) and next-generation sequencing (NGS) such as UDPS. We propose solutions specific to each of the two sampling methods— CCSS and NGS—to guarantee statistically conforming conclusions as free of bias as possible.
INTRODUCTIONRNA viruses show a high replication error rate due to the lack of proofreading mechanisms, and it is estimated that for viruses with typically high replicative loads every possible point mutation and many double mutations are generated with each viral replication cycle, and may be present within the population at any time (). In the case of hepatitis C virus (HCV), the viral loaddefined as the number of viral particles per milliliter of serum in acutely or chronically infected patientsmay reach 10 7 in immunocompetent patients, which roughly means a population of circulating particles of 10 10 10 11 at any given time. This population is highly dynamic, with a viral half-life of a few hours, and with the production and clearance of 10 10 10 12 genomes per day in a patient (). Given this inherent dynamics, we are often interested in the comparison of diversity indices of sequential samples of a patient or among groups of patients. These comparisons may be informative of the patient evolution or the appropriateness of a given treatment (Supplementary Material). Next-generation sequencing methods (NGS) will likely be increasingly adopted in clinical diagnostics in the next years. Improvements in costs, protocols and coverage are closing the gap between what was feasible in research and diagnostics. The first diagnostics likely to be moved to NGS will be those currently based on classical molecular cloning and Sanger sequencing (CCSS) because it is labor intensive and has limited sensitivity. In this work we use in-silico sampling from viral reference distributions to study the statistical properties of diversity indices aimed at quantifying RNA virus quasispecies complexity. Estimates of the species richness and other diversity indices as defined in ecology (Supplementary Material) are challenging when populations are complex in genomic composition () as is the case with viral quasispecies (). The approaches in the ecology domain are extensive and still active () and can be useful for the analysis of viral quasispecies. Although the quasispecies definition as a 'dynamic distributions of non-identical but closely related mutant and recombinant viral genomes subjected to a continuous process of genetic variation, competition and selection, and which act as a unit of selection' () conveys an intuitive image of complexity, no comprehensive and universally admitted *To whom correspondence should be addressed. index of quasispecies complexity exists. In a large population in equilibrium or with small perturbations, the genome frequencies are related with their relative fitness. There are a number of useful indices and variables but none of them fully captures that intuitive image. Viral quasispecies complexity may be viewed as a multivariate feature, where the number of haplotypes of polymorphic sites and their relative frequencies are its dimensions. Each of these indices and variables are difficult to estimate given the expected diversity of a quasiespecies from available data and the limited sample size amenable to analysis (). The primary indices measure the extend of the viral quasispecies complexity by the number of haplotypes, polymorphic sites and number of different mutations; these may be considered as richness indices. Other indices such as the Shannon entropy (S) () or the Simpson index () measure the diversity, or the evenness when normalized to maximum diversity (Sn), while others such as the mutation frequency (Mf) or the nucleotide diversity (Pi) measure the intrapopulation heterogeneity, that is how different are the members of the population among them. S and Sn, or the Simpson index, are not sensitive to the number of mutations. The Simpson index has been less used with viral quasispecies (), as it provides a more stable, although less sensitive, measure of diversity by downweighting the rare haplotypes. Mf measures the heterogeneity with respect to the most represented (dominant) sequence () or the consensus sequence of the population (). Pi gives the global population heterogeneity, taking into account the average number of mutations between each pair of individuals in the viral population (). Each of these variables describes a different part of the mutation space occupied by a quasispecies, and they all provide relevant information regarding mutation barriers to antiviral treatment resistance. We studied by in-silico sampling the distribution and properties of three of the most common variables used to quantify the viral quasispecies complexity in the literature, the diversity through S and Sn and the heterogeneity through Mf. The quasispecies richness by the number of estimated haplotypes in the population is also studied because of its implications on Sn and Mf. We propose methods for inference for each sampling schemeCCSS and NGSwith these complexity indices.
METHODS
Basic assumptionsTo make simulations of CCSS or NGS sampling experiments, we need the distribution of haplotypes of a viral quasispecies. We can empirically approach a 10 10 genomes distribution by taking the raw data from high coverage amplicon ultra-deep pyrosequencing (UDPS) experiments of samples of a wide complexity spectrum as reference distributions. Simulations of measures by CCSS will be obtained by in-silico sampling a given number of particles from the reference distribution, where any particle has the same probability to be sampled. Simulations of measures from NGS data will be obtained by in-silico sampling a number of particles from these distributions and setting an abundance filter, corresponding to RT  PCR  NGS noise levels (). This study is based on the following set of basic assumptions:(a) A very high coverage (50 000 times) UDPS amplicon dataset from patient samples of HCV may be considered as a coarse approximation to the high complexity of RNA virus quasiespecies, and the observed distribution of haplotypes may be used as a viral population reference distribution from which to sample viral particles.(b) A CCSS in-silico experiment consists in sampling a given number of viral particles from a reference distribution. All obtained sequences are accepted as true members of the population. Measures of viral quasispecies complexity are then computed from the observed haplotypes and frequencies.(c) The NGS methods have a noise level, due to Reverse transcription (RT) and polymerase chain reaction (PCR) sequencing errors, below which we may not distinguish true from erroneous mutations. Any data treatment of amplicon NGS sequences requires some sort of abundance filter to exclude artifactual haplotypes and point mutations.As a simple approach, a NGS in-silico experiment consists in sampling a given number of molecules from the reference distribution, followed by an abundance filter to exclude all haplotypes with abundance below the noise level. Measures of viral quasispecies complexity are then computed from the filtered haplotypes and frequencies.
Indices of diversity, definitions and equationsWe give in the Supplementary Material all relevant definitions and equations used throughout this work. That is, the definitions related to viral quasispecies and to diversity indices, and the equations with and without bias corrections.
Distribution of diversity measuresThe distribution of a variable measuring viral quasispecies complexity obtained by a CCSS experiment will be estimated by repeating a number of times (2000) an in-silico sampling of a given number of viral particles, and computing such variable each time. In this study, we repeated a number of times experiments with 20 and 50 clones, covering the most common range of sample sizes in the literature. The distribution of NGS measures were obtained by repeating the same number of times (2000) in-silico samplings of 400 and 1000 reads sampled from the reference populations, filtering at a noise level of 0.5% and computing the complexity variables each time. This is a feasible expected mean coverage in clinical settings with 50 samples in a 454 Junior plate.
Shannon entropy normalizationIn the ecology literature, the Shannon entropy (Supplementary Equation SI) is normalized to the natural logarithm of the number of estimated species in the population (Supplementary Equation SVI) so that a population where all species are equally represented corresponds to a maximum entropy of 1, whereas a population with a single species is a population of minimum entropy, with Sn  0. In the virology literature, we observe other two normalizations. Either to log(N) () or to N (), where N is the sample size, that is the number of clones in each sample. The normalization to log(N) is justified by saying that maximum entropy is attained when all observed molecules are different. These two normalizations are sample size-dependent, that is, having the same S for two samples of different size from the same population, we obtain two different Sn. Normalizing to log(N) may be accepted when the number of clones of all samples to be compared is the same as in () but lacks justification otherwise. A different measure of Shannon entropy may be obtained by the average of the per-site S, which would be normalized to log(4) for nucleotide sequences, or to log(20) for amino acid sequencesthe natural logarithm of the alphabet size. In this study, we use the per-haplotype S, with Sn normalized to log(h), where h is the number of estimated haplotypes in the population, according to the definition of Shannon entropy used in ecology. The meaning of the three normalizations is different. Where S/log(N) and S/N are scaled versions of S with equivalent statistical properties, and S/log(h) requires the estimate of h, and is influenced by its distribution.
RarefactionWhen the expected value of a diversity index depends of the sample size, we render comparable two samples of different size by rarefaction. The process of rarefaction () is defined as a repeated resampling without replacement from a sample to a smaller sample size. In ecology, it is specifically used to compare species richness values, and to construct rarefaction curves. This is particularly useful for biased estimators where the bias is a function of the sample size, as the number of haplotypes, S and Sn.
Fringe trimmingWhen filtering the haplotypes of an NGS experiment above a given noise level, say 0.5% for instance, because of the sampling process there are chances to accept haplotypes with real abundances50.5% while rejecting haplotypes that are 40.5% in the population. This produces fringes of haplotypes at the lower end of the NGS filtered sample, which could compromise the comparison of samples. A conservative way to make comparable samples of filtered data, eventually of different sizes, is to trim these fringes up to a given confidence level. Fringe trimming and haplotype filtering may be carried out in a single step by excluding all haplotypes withPn n i N, P  0:005 j 50:9 that is, by excluding the haplotypes with n i reads for which the probability to observe up to n i counts in a sample of size N, when the haplotype abundance in the population is 0.5%, is 590%. Both the noise level and the confidence level may be modified as required. As examples, 0.5 and 90% are just given, which fit our requirements on HCV NS3 samples, according to previous experience (). In the Supplementary Material, we show results filtering at 0.2 and at 1%, and trimming at different confidence levels.
Software and statistical methodsThe in-silico sampling and all the computations and graphics were done on the open source R language and environment (R Core) using default libraries, and libraries in the Bioconductor project () as the Biostrings library (). The R scripts are available upon request. NGS data simulations from a set of haplotypes of the high complexity population were performed by the Grinder program (with the parameters described in the Supplementary Material.
DataSamples from two patients, one with an acute HCV infection and another with a chronic HCV infection were used to obtain the reference distributions used in the in-silico sampling. Six amplicons covering the NS3 HCV region were compared. The methods and protocols followed from patient sampling to UDPS sequencing have been described elsewhere (). A coarse quality filter is used on the raw 454 reads to exclude all haplotypes represented by a single read, or those with more than two indeterminations or three gaps. We took the haplotype distribution of three of these amplicons as reference distributions of examples of quasispecies with low, mid and high complexity. The corresponding fasta files are included in the Supplementary Material, with frequencies (number of reads and percentage) in the header of each haplotype. The characterization of these reference quasispecies, along with the number of reads obtained in sequencing are given in. Although the reference distributions are based on HCV patient samples, we think that the conclusions are equally extensible to any virus passing through an RNA phase.
In-silico samplingThe statistical properties of diversity indices are studied by in-silico sampling from the reference distributions described above. The sampling is done by generating n random integers, where n is the sample size, between 1 and N, where N is the number of molecules in the reference population, with replacement, and assigning each random number to the corresponding haplotype by the population cumulative distribution ().
RESULTS
Data characterizationThree reference distributions of different levels of viral quasispecies complexitylow, mid and highare used as datasets (). The profile of these quasispecies populations may be depicted by the cumulative distribution of its haplotype frequencies (). A complementary plot ingives the haplotype frequencies in descending order, with a dash-dot line at the 0.5% cutoff showing the incidence of filtering on each population. On the other hand, Supplementaryshows the effect of filtering at different noise levels on the reference populations. The most dramatic change is produced on the number of haplotypes, followed by the number of polymorphic sites. Mf and Pi show a smooth transition, while Sn displays a similar behavior except for the mid-complexity population where larger changes areobserved. Increasing levels of filtering are considered as the gradual elimination of genomes of low replication fitness. The number of reads excluded by these filters is particularly high for the highcomplexity population, where filtering at 1% abundance represents the exclusion of 42.5% of the population. This is consistent with the production of tails of low fitness mutants from each of the haplotypes with enough replicating fitness.. Mf shows no bias with respect to the population value in any of the three populations. For S and Sn, we observe a bias with respect to the population value, which is sample size-dependent. When comparing pairs of samples of size 20 and 50, this differential bias could bring to the wrong conclusion that they come from populations of different diversity. When applying the bias corrections of Hutcheson (Supplementary Equation SII) () and Chao1 (Supplementary Equation SIII) () the bias is partially corrected but remains sample size dependent (Supplementary Table S2B and Supplementary). While applying the rarefaction of the samples of size 50 to size 20, the median values of both samples are brought to the same level (Supplementaryand Supplementary) and the samples become comparable despite the different sample size. In conclusion, the Mf values are not biased and may be directly compared with no further precaution, but the comparison of S or Sn values requires a bias correction. When the sizes of the two samples being compared are unbalanced, the comparison of S or Sn also requires the rarefaction of the big sample to the small sample size (Box 1). Inference is carried out by the t-test (Supplementary Equation SXI) ().
Inference on complexity values in CCSS
Inference on complexity values in NGSWe have taken 400 and 1000 reads as feasible sample sizes in a clinical setting for the determination of the viral complexity by NGS, with the same ratio as the 20 and 50 clones used in CCSS. Now we consider as population diversity values those obtained from the populations filtered at the noise level (Supplementary). That is, the values that at best could be obtained by NGS. While filtering at the noise level most 'rare' haplotypes are removed and the bias correction on S and Sn, as seen under CCSS, has a lower impact. On the distribution of 2000 replicates of samples of 400 and 1000 reads, filtered at 0.5%, we still observe a sample size differential bias, not only for S and Sn, but also for Mf in this sampling scheme (Supplementaryand). The bias correction of Hutcheson (Supplementary Equation SII) has a limited impact, as expected. We observed that the filtering has effects that depend of the sample size, as may be seen inwith a scatterplot of the number of haplotypes observed on 2000 replicates of pairs of samples of size 400 and 1000. The small samples are clearly biased toward higher number of haplotypes despite being sampled from the same population, and filtered at the same abundance level. This effect is explained by the lower frequencies at which the same haplotypes are observed when increasing the sample size, particularly for those at the lower frequency end. The number of haplotypes observed before filtering in the big samples is higher than those observed in the small samples. As a consequence, the relative frequencies of the same haplotypes are lower in the big than in the small samples. This is illustrated in, where we show a barplot with the probabilities to observe an haplotype at a frequency of 0.5% in the population with a number of reads up to a given number of counts, both for samples of size 400 and 1000. The probability to observe such haplotype in a sample of size 400 with up to 2 reads is higher than the probability to observe the same haplotype in a sample of size 1000 with up to 5 reads. According to this observation, after filtering at noise level, the small sample carries more information than the big sample. Soin the study. In abscissa the haplotypes are ordered primarily by the Hamming distance to the most frequent haplotype, and ties are determined in descending order of frequency. The first haplotype is the dominant one, while the last is the one showing more differences respect to the dominant and with a lower frequency in the population. The flatter the profile, the less complex is the quasispecies. (B) Quasispecies profile as a frequency distribution with the haplotypes ordered by decreasing frequency, the plot shows a detail of the full plot to view the impact of filtering on each of the three viral populations, with a dash-dot line at the 0.5% threshold the clean big sample is not useful for rarefaction. Instead the basis for rarefaction should be the raw big sample, including all rare haplotypes and artifacts. At each rarefaction cycle, the resampled reads should be filtered previously to compute the diversity indices. An alternative strategy could be trimming the haplotype fringes at noise level at a given confidence level. The effect of this additional filtering is seen by comparingand C. The bias of S, Sn and Mf is also greatly reduced (Supplementary). To assess the sensitivity of this method to small changes in the parameters, we explored the results filtering at levels of 0.2 and 1%, and trimming at 80, 90 and 99% confidence. Filtering deeper, into the noise level at 0.2%, the differential bias is exacerbated for S and Sn, and a differential bias is introduced in Mf. In these circumstances, the fringe trimming alleviates both, the absolute and the differential bias, of S, Sn and Mf, but does not completely cancel them. On the other hand, filtering well above noise level, at 1%, the absolute and the differential bias are rather limited and the fringe trimming strategy alone is able to compensate for the differential bias (See Supplementary Materials Parameters Sensitivity.doc). Finally to assess the generality of the two strategies (rarefy the raw sampled data, and fringe trimming), we performed a prospective simulation study using the Grinder program () to simulate NGS data on the 18 clean haplotypes of the high complexity population, with corresponding frequencies. We used a linear error rate profile with three different mean error rates (0.15, 0.25 and 0.35%) and with three different slopes each. This simulation confirmed that the fringe trimming approach reduces both bias and differential bias, with the rarefaction giving the minimum differential bias, but showing higher absolute bias (See Supplementary Materials Grinder Simulations.doc). In conclusion, under the NGS sampling scheme the comparison of diversity indicesS, Sn and Mfrequires of rarefaction or haplotypes fringe trimming above noise level. When the sizes of the two samples being compared are markedly unbalanced, the use of rarefaction should be preferred for S and Sn. The fringe trimming suffices for Mf in either case. The use of analytical formulations of rarefaction for S and Sn () is not possible with NGS data as the abundance filter discards singletons, doubletons and rare haplotypes in general. Resampling should be used instead.
DISCUSSIONQuasispecies dynamics represents an important challenge for the control of infectious diseases associated with RNA viruses and some DNA viruses. In particular, we are interested in improved molecular diagnosis of B and C hepatitis viruses, which are responsible for4500 million cases of chronic infections worldwide.As strongly evidenced by recent reports, viral quasispecies complexity, measured by diversity indices, has clear clinical relevance in the course and prognosis of these diseases. Moreover, the adequate diagnosis of quasispecies complexity has direct implications for antiviral treatment failure because of its reflection in genetic barriers to resistance (). Because of these reasons, it is paramount to establish a standard method of measuring and comparing diversity indices with statistic grounds and fitted to the expected degrees of viral quasispecies complexity. We argue that the virus field would benefit of implementing solutions already established in ecology to compare diversity indices. Useful connections between ecology and viral quasispecies have been previously established. Self-organization of subpopulations from a viral quasispecies that exhibited competition-colonization dynamics was approached by applying ecological models of biodiversity in spatially structured habitats (). The study revealed that host cell killing by viruses can be modulated by a trade-off between competition and colonization, and suggested a model of virus virulence based on intramutant spectrum interactions (). Also niche theory of competition communities and the replicator-mutator equation were combined to show that a typical quasispecies profile required both competition and cooperation among variants (). By a review of methods used in ecology that could be approached to describe RNA viral quasispecies, and thanks to deep coverage amplicon UDPS data, which has been used as source of in-silico sampling, we have studied the behavior and statistical properties of S, Sn and Mf under the sampling schemes of CCSS and NGS. By CCSS, we may sample any virion with equal chance, but their estimated frequency will never be lower than 1/N, the granularity or resolution of the device, where N is the number of clones in the experiment. That is, when using 20 clones, no observed haplotype will have an estimated frequency in the population 55%. This granularity together with the high diversity of RNA viruses causes a systematic bias in the estimation of S and Sn. On the other hand, Mf does not suffer of estimation bias. Another consideration for the CCSS method is that we lack any means to control whether any of the observed clones are artifactual or of low abundance. In a recently published study (), we compared experimentally a patient sample of HBV sequenced in replicates by UDPS (two 454FLX, one 454-FLX and one 454 Junior, in the forward and reverse) and by 150 sequences obtained by CCSS. Among the 36 singleton haplotypes by CCSS, 10 were also identified by UDPS in 58 of the UDPS replicates, and 24 could not be identified in any of the replicates with 96 221 quality filtered reads covering the full amplicon. As an example, filtering at 0.5% the high complexity reference population, a 36.2% of the reads is removed (Supplementary), which means that in CCSS experiments, on this kind of viral populations, roughly one outUnder the assumption that all observed clones are true members of the population, we observed by this sampling scheme that S and Sn are biased, and that the bias is sample size-dependent. We also observed that S shows a better behavior to analytical bias correction than Sn, and that Mf is an unbiased estimator. A less biased comparison of S or Sn values between samples requires of intra-sample normalization, composed of terms of correction (Supplementary Equations SII and SIII). When the sample sizes are unbalanced, the normalization requires a rarefaction of the big sample to the small sample size as well. On the other hand, NGS methods are highly sensitive and reproducible but they are limited by the technical noise level. By discarding observed haplotypes, our diversity estimates are biased with respect to the true population values. We may nevertheless consider the haplotypes below the 0.5% frequency in our example as spurious or of low biological relevancy at the sampling time point. In this case, we used the diversity values of the filtered population as gold standard, being the best we can achieve by NGS. We observed a sample size-dependent bias on S, Sn and Mf. The minimum differential bias is provided by rarefaction for S and Sn. For Mf, fringe trimming provides an unbiased comparison. When the samples to be compared are not very unbalanced and the abundance filter is above noise level, fringe trimming could give good results for S, Sn and Mf. The in-silico sampling and simulation allowed us to assess the validity of the estimate and tests used in ecology when dealing with viral quasispecies with S, Sn and Mf, and permitted to identify the key points for less biased comparisons of complexity indices under the same sampling scheme. In this work, we have empirically studied the statistical properties of S, Sn and Mf while observing the quasispecies viral complexity either by CCSS or by NGS, and through this we assessed the means for less biased comparisons of complexity indices. These methods could allow us to statistically conclude whether a viral quasispecies is expanding or contracting in diversity, independently of the size of the samples being compared. In the Supplementary Material we give the formulation, and in
A BBoxes 1 and 2 we propose the methods of data treatment for inference for each of the two methodologies, CCSS and NGS.
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
J.Gregori et al. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
samples of size 400 and 1000 after filtering the haplotypes below the noise-level. The clouds are biased to higher values for the small samples. (B) Plots with the cumulated probabilities to observe an haplotype with an abundance in the population at the noise level (0.5% here) with growing number of reads, for samples of size 400 and 1000. The numbers inside the bars give the number of reads, on top, and the percentage in the sample below. (C) Scatterplot with the number of observed haplotypes in pairs of samples of size 400 and 1000 when the haplotype fringes have been trimmed at a 90% confidence level. The clouds are now centered on the diagonal (see Box 2). Use the Z test on S (Supplementary Equation SV), SN (Supplementary Equation SV with SVI and SVII) or MF (Supplementary Equation SX)
Inference with viral quasispecies diversity indices at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
