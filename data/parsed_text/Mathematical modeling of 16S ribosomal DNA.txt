Motivation: Many current studies of complex microbial communities rely on the isolation of community genomic DNA, amplification of 16S ribosomal RNA genes (rDNA) and subsequent examination of community structure through interrogation of the amplified 16S rDNA pool by high-throughput sequencing, phylogenetic microarrays or quantitative PCR. Results: Here we describe the development of a mathematical model aimed to simulate multitemplate amplification of 16S ribosomal DNA sample and subsequent detection of these amplified 16S rDNA species by phylogenetic microarray. Using parameters estimated from the experimental results obtained in the analysis of intestinal microbial communities with Microbiota Array, we show that both species detection and the accuracy of species abundance estimates depended heavily on the number of PCR cycles used to amplify 16S rDNA. Both parameters initially improved with each additional PCR cycle and reached optimum between 15 and 20 cycles of amplification. The use of more than 20 cycles of PCR amplification and/or more than 50 ng of starting genomic DNA template was, however, detrimental to both the fraction of detected community members and the accuracy of abundance estimates. Overall, the outcomes of the model simulations matched well available experimental data. Our simulations also showed that species detection and the accuracy of abundance measurements correlated positively with the higher sample-wide PCR amplification rate, lower template-to-template PCR bias and lower number of species in the interrogated community. The developed model can be easily modified to simulate other multitemplate DNA mixtures as well as other microarray designs and PCR amplification protocols.
INTRODUCTIONOwing to the development and refinement of novel DNA and RNA interrogation technologies, there is a surge of studies in the current literature exploring the populational structure and function * To whom correspondence should be addressed. of various complex microbial communities (). The ability to isolate and subsequently examine total community DNA and RNA without any need to culture individual microbial species and cells allows analysis of systems that would otherwise be difficult to profile and examine including microbiota of human intestine and other epithelial surfaces and the microbes of soils and ocean waters (). Gene coding for the small ribosomal subunit RNA molecule (16S rRNA in prokaryotes and 18S rRNA in eukaryotes) has been used in the vast majority of such studies due to its ubiquitous presence in all organisms and because of the conservation of its nucleotide sequence (). In a typical experimental design to profile microbial community structure, total genomic DNA (gDNA) isolated from a sample of interest is subjected to rounds of 16S rRNA gene (rDNA) specific amplification in polymerase chain reaction (PCR) using two 'universal' primers complementary to the beginning and the end of prokaryotic 16S rRNA molecule (). The amplified DNA is then interrogated by a detection method of choice such as DNA sequencing or microarray analysis. Because on average 16S rRNA gene constitutes only  0.25% of the total genomic DNA (see below), selective 16S rDNA amplification is crucial to increase the sensitivity of detection () and to obtain good measures of bacterial presence and relative abundance in the community samples. However, the optimal use of such PCR amplification in relation to microarray and DNA sequencing detection have not been yet fully explored. A number of studies have been published, though, examining the thermodynamic behavior of DNA molecules during DNA amplification, and the biases that can be observed during many rounds of PCR amplification (). Because most microbial communities consist of a large number of different microbial species with varied 16S rRNA gene sequences, any PCR amplification of community DNA is multitemplate. PCR amplification of such gDNA has been shown to introduce a deviation of the post-amplification fractions from the initial ratios of DNA molecules (termed PCR bias) due to unequal amplification of different DNA molecules during PCR (). Several mechanisms of this effect have been described that include (i) unequal denaturation of templates based on GC content of DNA sequences; (ii) higher binding efficiency of GC-rich variants of degenerate amplification primers to the template at the same annealing temperature; and (iii) competitive re-annealing
PCR and microarray modelingof abundant templates at later amplification cycles discriminating against major templates (). In addition, the stochastic nature of the PCR amplification process during the first few cycles of amplification can lead to a reaction-specific skew in relative distribution of amplified templates producing so-called PCR drift (). Finally, genomic DNA isolated from environmental sources or human bodily fluids such as fecal matter is known to often contain PCR inhibitors that are able to significantly impede DNA amplification sample-wide (). All these mechanisms result in a skew of the product-to-template ratios for most DNA species in complex samples. Several studies have provided theoretical framework aimed to describe the individual components of the PCR or to simulate a particular PCR bias. Initial efforts focused on the modeling of individual biochemical reactions including template enzyme kinetics (), DNA renaturation () and DNA re-annealing (). Two recent studies described detailed simulations of kinetic processes of PCR based on the calculations of mass preservation and equilibrium coefficients (). Both studies focused on the behavior of single-template amplification process, and in addition provided considerations of biochemical constants for each equilibrium reaction. In this work, we extend these previous PCR simulations with a quantitative model of multitemplate PCR amplification of complex 16S ribosomal DNA mixture derived from the simulated genome pool of 400 different microbial species. The multitemplate PCR amplification is computationally assessed through the detection of amplified 16S ribosomal DNA by phylogenetic microarray.
METHODS
General model descriptionA typical experimental procedure of microbial community analysis consists of selective amplification of 16S rDNA from the total genomic DNA, applying the pool of amplified and total gDNA onto a microarray, and then measuring hybridization of this mixture to different microarray probes. Detection of bacterial species of intestinal microbiota with Microbiota Array () was used as a model of this method. In the in silico simulation of the interrogation process, developed in Matlab (version 7.3, The Mathworks, Inc.), the starting gDNA sample was subjected to successive rounds of PCR amplification producing a mixed sample containing original gDNA and amplified 16S rDNA molecules. After each PCR amplification round, detection of 16S rDNA species in the mixture was assessed by the microarray detection algorithm.
Model of the multitemplate PCRThe process of PCR amplification was simulated for each bacterial species in the mixture individually, and the accumulation of amplified 16S rDNA was modeled for each species as:where P N is the total amplified 16S rDNA after N cycles of PCR amplification, P 0 is the starting amount of 16S rDNA and AE i is amplification efficiency at cycle i for each species 16S rDNA ().
O.Paliy and B.D.Foydiminished as the starting DNA amount increased. The yield rates were used to empirically estimate K INH ().(2) Sample-wide rate of PCR amplification: quantitative PCR tests, utilizing small amounts of genomic DNA to reduce possible inhibitory effect(s), were carried out as described previously () to estimate AE MAX. The average amplification rate was 1.75 for the exponential phase of PCR giving AE MAX of 0.75, a value comparable to other reports ().(3) Distribution of PCR biases due to primer annealing variability: based on experimental data (), the PCR bias was modeled as lognormal distribution of the templateprimer complex formation constant. The SD of the natural logarithm was set to 1.74 in order to produce a distribution of species-specific amplification rates matching experimental median per-cycle bias of 1.59% ().(4) Microbiota array detection and experimental conditions: the minimum detection limit of the microarray was estimated from the microarray validation experiments to be between 2.5 and 10 pg of 16S rDNA (). The detection limit was modeled as a normal distribution function with mean of 5 pg, SD of 2 pg and minimum of 1 pg. The number of bacterial species in the interrogated sample was set to 400 (). The distribution of starting amounts of each bacterial species in the mixture was modeled by the square of an exponential function and varied over four orders of magnitude. This produced a distribution of species DNA abundances heavily skewed toward low abundance members to match experimental data (). The model assumed that 1500 ng of combined pool of amplified 16S rDNA and initial gDNA was added to each microarray (). If necessary, multiple simulated PCRs were combined to obtain this 1500 ng of total material.(5) 16S gDNA fraction: fraction of the 16S rDNA per bacterial genome was estimated by multiplying the average 16S rDNA gene copy number (6.0) by average 16S rDNA gene length (1500 bp) and dividing the product by average prokaryotic genome size (3.6 Mb) this produced a 0.0025 fraction. NCBI microbial genomes and rrnDB databases were used to obtain these averages.
Measured outcomes of the simulated processesModel simulations were focused on the analysis of how species detection and accuracy of community composition measurements by phylogenetic microarray depended on the amount of starting gDNA material for PCR amplification and the number of PCR amplification cycles the samples are subjected to (). The model was run with all parameters defined as shown in, while varying the amount of starting material and the number of 16S rDNA-specific cycles of PCR amplification. One hundred repeated simulations were carried out for each different amount of starting material and different number of PCR amplification cycles, and the simulation results were averaged among repeats. Two outputs of the model were used to assess the simulation: (i) the fraction of bacterial species detected by the microarray and the (ii) accuracy of quantitative measurement of bacterial relative abundance. Additional model outcomes such as fraction of nucleotides and primers used, total reaction yield and cycle-to-cycle amplification rate changes were also tracked. The accuracy of species abundance measurements was defined as:where SP.FRAC TRUE i is the true fraction of 16S rDNA represented by species i in the initial sample, SP.FRAC EXP i is the fraction of 16S rDNA represented by species i estimated by microarray interrogation of PCR-amplified sample and N SPECIES is the total number of species in the sample. SP.FRAC EXP i for all undetected species was set to 0. In words, this accuracy measure is the average of the absolute fractional error for each species fraction estimate. A lower value represents greater accuracy, with a zero value being perfect accuracy.
Model limitationsSeveral parameters known to influence the behavior of standard PCRs were omitted from the model for simplicity because they were not found to be modified often in phylogenetic studies examined. These included Mg 2+ concentration, varying annealing temperature and temperature ramp rate. Because DNA polymerases currently used for PCRs are very thermostable, denaturation of the enzyme during PCR was considered to be insignificant. Since our model was focused on the determination of amplification efficiency of each template at each PCR cycle, it did not include detailed simulation of the biochemistry of melting and extension reactions that were considered in detail previously (). Nevertheless, the behavior of our PCR simulation was similar to those reported elsewhere (). Finally, our algorithm did not model complexities of microarray hybridization behavior and bias; rather it assumed a perfect measurement of each species abundance as long as it was above the microarray detection limit.and B displays detection fraction of microbial species in the sample as a factor of the number of PCR amplification cycles and the amount of starting material. As expected, bacterial detection increased with an initial increase in the number of PCR amplification cycles. The curves of species detection fraction were similar when starting material was kept < 50ng. After initial increase, the detection fraction started to plateau out around 15th PCR cycle and reached maximum level around cycle 20 (9193% of bacterial species detected for samples with < 50ng starting gDNA). The detection slowly decreased with further PCR amplification to  90%. The detection fraction curve was different for samples with higher starting amounts of gDNA. When increasing initial gDNA template from 100 ng to 1000 ng, the rate of detection became progressively lower. At 15 cycles of PCR amplification, 86, 78, 71 and 63% of all species in the sample were detected for samples containing 100, 300, 600 and 1000 ng of starting genomic DNA, respectively. The lower rate of detection is explained in part by an increased amount of PCR inhibitors in large gDNA samples reducing the rate of template amplification. The initial sample-wide amplification rate dropped from 1.75 for reactions with 150 ng starting material to 1.50 for samples with 1000 ng of starting gDNA (Supplementary). Elevated template self-annealing in large samples also contributed to a lower amplification rate. In addition, because of higher initial concentration of DNA templates, PCR reached resource limitation stage faster for larger gDNA samples. A drop in the amplification rate occurred at cycle 20 for PCR with 1 ng starting gDNA versus cycle 10 for reactions with 1000 ng starting gDNA (Supplementary). This lowered the 16S rDNA enrichment factor of the amplified samples (Supplementary). Whereas 16S rDNA constituted 86% of total sample after 15 cycles of PCR amplification for sample containing 1 ng of starting gDNA (99% after 20 cycles), this fraction was 73% for 100 ng starting gDNA sample (83% after 20 cycles, 93% after 40 cycles) and only 22% for 1000 ng starting gDNA sample (30% after 20 cycles, 51% after 40 cycles). The initial Page: 2137 21342140fraction of 16S rDNA in genomic DNA samples was 0.25%. The relative fractions of detection at 15, 20, 25 and 30 cycles of PCR amplification observed in our simulations were in good accordance with our previous experimental analyses of human fecal samples using Microbiota Array (). Carrying out PCR amplification past 20 cycles actually led to a slight reduction of species detection in samples with small starting amount of gDNA. This was connected to the existence of the simulated PCR bias among different species, since species detection did not drop when PCR bias was turned off (). Our simulation results are consistent with previous observations that the use of large number of PCR amplification cycles to enrich genomic DNA samples with 16S rDNA results in reduced estimates of microbial community diversity ().and D displays the accuracy of microarray estimation of species relative abundance in a sample. Independent of the amount of starting material used, the accuracy of community composition estimates improved with an initial increase in the number of PCR amplification cycles a sample was subjected to. The optimum accuracy was inversely proportional to the starting gDNA amount: it was similar for samples with 110 ng of starting gDNA, but was progressively worse for samples with higher starting gDNA amounts. The best accuracy (minimum value onand D graphs) was observed at cycle number 17, 15, 12 and 11 for samples with 1, 10, 100 and 1000 ng of starting gDNA, respectively. In all cases, the accuracy then started to decline sharply as the number of PCR amplification cycles continued to grow. Several different effects influenced the observed accuracy of 16S rDNA abundance measurements. Since many bacterial species are not detected in samples subjected to a low number of PCR amplification cycles, this leads to a poor concordance of relative abundance values between initial (true) and measured sample compositions. However, because each additional PCR amplification cycle skews the original distribution of species abundances due to unequal amplification efficiency of 16S rDNA of different species, use of many PCR amplification cycles leads to a significant overall deviation of measured signals from the initial species distribution (). In addition, template self-annealing introduced another amplification deviation in samples with higher starting gDNA that influenced the position of optimum accuracy (see Supplementary). Thus, even though a progressively higher fraction of community members is detected until at least the 20th PCR amplification cycle, accumulation of PCR amplification biases leads to optimum accuracy being reached at an earlier cycle.
RESULTS
Fraction of bacterial detection
PCR and microarray modeling
Accuracy of 16S rDNA abundance measurements
Sensitivity analysis of estimated model parametersTo test the dependence of model predictions on values chosen for key parameters, sensitivity analyses were carried out where each parameter was systematically permuted while keeping all other Page: 2138 21342140
O.Paliy and B.D.Foy
PCR and microarray modelingfraction was generally proportional to the PCR amplification rate. The 90% detection point was reached at PCR cycle 12, 14, 17 and 21 for reactions with amplification rates of 2.00, 1.75, 1.60 and 1.45, respectively. The highest detection fraction was the same for all simulations and thus was independent from the starting amplification rate. The optimum accuracy was generally observed for the PCR cycle that corresponded to detection fraction reaching 90% level. Template PCR amplification bias: due to the differences in the primer annealing and in sequence replication rates, different 16S rDNA species display slightly different rates of PCR amplification, which in a complex sample can lead to deviations of the post-PCR template ratios from the original sample composition. A number of approaches to experimentally affect PCR bias level are known and can be used (). For this sensitivity analysis, the SD of the templateprimer equilibrium K TP EQ constant was systematically permuted to determine the influence of PCR bias level on both the detection and accuracy performance of microarray measurements (and D). Maximum detection fraction was inversely proportional to the bias level. With a 0.15% median per-cycle amplification rate bias, 95% of species were detected in our simulations; however, this fraction dropped to 87% for amplifications with 5.9% median per-cycle bias (). An even larger negative effect of PCR amplification bias was observed for the accuracy of abundance measurements (). This was expected since each PCR cycle introduces deviations into relative species abundances. With PCR bias close to 0, accuracy stayed at the same level after reaching an optimum. Concentration of amplification primers:and F shows simulation results of varying the initial concentration of amplification primers. Because in standard PCR primers are always in abundance compared with the amount of template (2.610 12 M of 16S rDNA template in 50 ng of total genomic DNA versus 2.0 10 7 M of each primer), primer concentrations are often assumed to be invariant during PCR. Somewhat unexpectedly, both of the main assessed parameters showed primer concentration dependence. Though the optimum accuracy and the highest detection fraction were generally not affected, the decline in both parameters with higher number of amplification cycles was inversely proportional to the overall primer concentration in the reaction. Increasing each primer concentration beyond 350400 nM had negligible additional effect. Our finding can be explained by the fact that because phylogenetically conserved primers with several degenerate positions are often used in 16S rDNA amplification studies (), the actual effective concentrations of each forward and reverse primer for each specific 16S rDNA template are likely significantly lower. This effect was included in our model. A lower effective primer concentration will lead to a lower overall template amplification rate through shifting the reaction equilibrium. This reduction will be particularly noticeable when concentration of the templates is comparable with primer amounts at the later stages of PCR amplification. Number of species in the community sample: based on the previous analysis of intestinal microbial communities (), our simulations were run with 400 species members. However, community diversity is expected to be vastly different for diverse ecological environments and microbial communities.and H shows detection and accuracy results for simulations where community complexity was varied between 160 and 640 members. As expected, overall fraction of species detection decreased with an increase in the number of community members, since the same amount of genomic DNA was distributed among larger number of members. We detected all members of the 160member community but only  84% of the 640-member community. A similar relationship was also observed for accuracy estimates microarray results were generally more accurate for a low-member community due to the higher fraction of detected members.
DISCUSSION AND CONCLUSIONSIn this work, we have developed the first detailed model of PCR amplification and microarray detection for the quantitative analysis of microbial community structure. Model performance matched well available experimental data including total number of detected species, total PCR reaction yield and species detection differences for 15, 20, 25 and 30 cycles of PCR amplification [see Supplementary Table S1 and (. Model simulations led to the following conclusions:(1) Species detection showed a positive relationship with the number of PCR amplification cycles and lower templateto-template amplification bias. On the other hand, it was inversely proportional to the number of species comprising the interrogated community. A detection fraction plateau was reached in each case due to a significant and quick drop in the PCR amplification rate once the template concentration became high enough to affect chemical reaction equilibria.(2) Accuracy of 16S rDNA abundance measurements had a non-monotonic relationship with most tested parameters. The accuracy initially improved with each successive PCR amplification cycle due to a significant increase in the fraction of detected species. However, once reaching an optimum, the accuracy started to decline due to the rising PCR amplification bias with each additional amplification cycle. Overall, PCR amplification bias had the most profound effect on the detection and accuracy estimates among all parameters tested in our model.(3) A caution has to be exercised when comparing species composition and abundance among microbial communities with significantly different numbers of community members. With the same experimental protocol used, a community with many members will have a lower detection fraction than a community with fewer species. Thus, the actual differences among such communities would be underestimated.(4) Not surprisingly, our experiments indicated that the total yield of PCR amplification correlated positively with the amount of starting material as well as with the number of amplification cycles employed. The yield neared a plateau in each case (Supplementary) which coincided with a drop in the PCR amplification rate (Supplementary). Previous studies also showed that efficiency of DNA duplex denaturation is decreased at higher concentrations, which leads to poor PCR performance when too much sample DNA is added to the mixture ()
O.Paliy and B.D.Foybe considered. The same amount of material (1500 ng) was 'loaded' onto the microarray in our simulations; therefore, for reactions with small starting amounts and low number of PCR amplification cycles, the simulation assumed that many PCRs were combined to achieve the needed load. This is not likely to be practical for most experiments: assuming a 50% loss of PCR products during reaction purification, 27 separate PCR amplification reactions would have to be combined for samples with 10 ng of starting gDNA subjected to 15 cycles of PCR amplification (see Supplementary). Overall, when assuming maximum sample-wide PCR amplification rate of 1.75, the optimal conditions for PCR amplification of complex 16S rDNA samples included a combination of smaller amount of starting gDNA (< 50ng) and moderate number of PCR amplification cycles (1520 cycles). The use of a higher number of PCR amplification cycles should be avoided (). The particular optimal values for starting gDNA amount and the number of amplification cycles will be affected by the specific microbial community under investigation and the details of the experimental protocol. The developed model is well suited to provide these optimal condition estimates for different experimental setups. Our model predicts that combination of 50 ng starting material and 1820 cycles of PCR amplification will require pooling of between 5 and 8 independent PCRs (assuming 1500 ng microarray load), which is of reasonable cost and labor-wise. An additional advantage of pooling multiple independent PCR amplifications of the same sample is the mitigation of potential measurement biases associated with PCR drift (). Our experimental PCR amplification and purification tests [data not shown and] are consistent with these predictions. In summary, this work develops a mathematical model which can assist with establishing the optimal experimental conditions for the selective amplification and microarray-based measurements of community 16S rDNA. The developed model can be easily modified to simulate the interrogation of other microbial communities as well as other microarray designs or PCR amplification protocols. For example, to simulate different microbial communities the number of species and their expected abundance distribution in the sample can be modified (). On the other hand, microarray detection limit and the number of interrogating probesets can also be changed to simulate a different microarray design. Furthermore, the model can be further expanded to include additional parameters influencing microarray detection such as cross-hybridization behavior among different probes and 16S rDNA fragments ().
The Author 2011. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oup.com at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
a Based on data from (Rigsbee et al., 2011) and (Paliy et al., 2009). b Based on available mixture composition of standard Taq PCR kits. c Based on parameter estimation from (Mehra and Hu, 2005). The overall species-specific PCR amplification rate AR i = 1+AE i at cycle i was defined as: AR i = 1+(AE MAX K INH gDNA) CONC TEM.PR.ENZ.NUCL EQ CONC TEM IN  (2) where AE MAX is maximum amplification efficiency, K INH gDNA term defines amplification reaction inhibition due to the presence of PCR inhibitors, CONC TEM IN is the total concentration of single-stranded template at the melting step and CONC TEM.PR.ENZ.NUCL EQ is the concentration of the templateprimerenzymenucleotide complex (growing complementary nucleotide chain) at equilibrium. The last term in the equation models the adjustment of amplification efficiency based on biochemical reaction equilibria and takes into account template self-annealing (Mehra and Hu, 2005), template-specific PCR bias due to variability of the 16S rDNA nucleotide sequences complementary to universal primers among different species (Polz and Cavanaugh, 1998) and sample-wide reduction in amplification efficiency due to enzyme and nucleotide resource limitation (Lee et al., 2006; Mehra and Hu, 2005; Sachse, 2004). A detailed description of the mathematical model is available in Supplementary Material. 2.3 Simulation of microarray detection Microarray analysis of species 16S rDNA in the amplified sample was simulated by comparing the amount of each species rDNA versus the microarray detection limit (see below). If the species-specific 16S rDNA amount was above detection limit, the corresponding species was treated as detected, and its gDNA abundance was equal to its 16S rDNA amount in the amplified mixture. Otherwise, the species was treated as undetected, and its measured gDNA abundance was assumed to be 0. 2.4 Parameter estimation The following modeling parameters and coefficients were estimated (Table 1): (1) Yield of PCR amplification as a function of the amount of starting material: PCR amplification yield was estimated from semiquantitative PCR tests that utilized between 50 and 500 ng of gDNA template and between 15 and 30 cycles of amplification (Supplementary Fig. S1). The yield rate (defined as the ratio of the final amplified amount divided by the starting DNA amount)
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
