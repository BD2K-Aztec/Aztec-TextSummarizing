Motivation: Cancer development and progression is driven by a complex pattern of genomic and epigenomic perturbations. Both types of perturbations can affect gene expression levels and disease outcome. Integrative analysis of cancer genomics data may therefore improve detection of perturbed genes and prediction of disease state. As different data types are usually dependent, analysis based on independence assumptions will make inefficient use of the data and potentially lead to false conclusions. Model: Here, we present PINCAGE (Probabilistic INtegration of CAncer GEnomics data), a method that uses probabilistic integration of cancer genomics data for combined evaluation of RNA-seq gene expression and 450k array DNA methylation measurements of promoters as well as gene bodies. It models the dependence between expression and methylation using modular graphical models, which also allows future inclusion of additional data types. Results: We apply our approach to a Breast Invasive Carcinoma dataset from The Cancer Genome Atlas consortium, which includes 82 adjacent normal and 730 cancer samples. We identify new biomarker candidates of breast cancer development (PTF1A, RABIF, RAG1AP1, TIMM17A, LOC148145) and progression (SERPINE3, ZNF706). PINCAGE discriminates better between normal and tumour tissue and between progressing and non-progressing tumours in comparison with established methods that assume independence between tested data types, especially when using evidence from multiple genes. Our method can be applied to any type of cancer or, more generally, to any genomic disease for which sufficient amount of molecular data is available. Availability and implementation: R scripts available at
IntroductionCancer genomics aims to improve patient diagnosis, prognosis and treatment opportunities. Identification and optimal use of molecular biomarkers is key to achieve this, as they may allow for stratification of clinically relevant cancer subtypes and prediction of clinical outcome. Individual molecular markers of different types have long been used in the cancer field, however, their predictive performance is often limited (), which may at least in part be explained by tumour molecular heterogeneity (). Combined use of multiple markers of different molecular types is generally thought to improve discriminatory power and clinical performance (). However, integration using standard machine learning (ML) approaches often fails to deliver a performance gain (). Accordingly, there is a need for novel integrative approaches. We hypothesize that the predictive performance of integrative approaches can be improved by including existing knowledge on the biological relationships between the different molecular types. Hence, we propose a model-based strategy that can be extended to the increasing array of molecular profiling data types and demonstrate its use with DNA methylation and gene expression data. Both gene expression and DNA methylation have been extensively studied as cancer biomarker candidates (). Biomarker screens from individual laboratories have typically included only relatively few patients and profiled only a single data type. In contrast, large patient cohorts with hundreds of patients profiled for several molecular types are now available from the International Cancer Genome Consortium (ICGC;) and The Cancer Genome Atlas (TCGA;). These datasets offer new opportunities for exploring and developing integrative predictive approaches. Integration can be done across both data types and genomic loci.Three main strategies for data integration exist: (i) navenave combination of individual methods, (ii) use of general-purpose machine-learning methods and (iii) structured integration using prior knowledge (). The first and simplest strategy combines results from separate analysis methods for individual data types, for instance in a sequential (greedy) manner by intersecting lists with significant candidates. This approach, however, requires that a genomic marker is statistically significant for each analysed data type. Alternatively, P-values from analyses of individual data types may be combined given independence assumptions, based on either calculation of products () or sums () (reviewed by). A weakness of this approach is the assumption of independence between tested data types, which is often not fulfilled. The second strategy applies general-purpose ML methods to multiple molecular data types. For instance, methods selecting relevant features from normalized heterogeneous data, such as Lasso () or elastic net (), have been followed by building logistic regression (LR) models or performing clustering (). These methods typically also miss dependencies between data types. Some studies successfully address this (e.g.), but at the expense of interpretability, individual biomarkers identification, and increased variation in predictive performance. The third strategy explicitly incorporates prior knowledge on the structure of possible interactions between data types. In one study, the modules of copy number perturbation that best explained observed gene expression variation were called as cancer drivers (). PARADIGM is another attractive integrative approach (). It derives patient-specific pathway activities from gene expression profiles and copy number status and uses these to cluster tumours into subtypes. The subtypes were shown to stratify patient survival for breast cancer and glioblastoma. A more comprehensive review of the various integrative methods, including the three types discussed here, is given in. Here, we propose a structured integrative model, called Probabilistic INTegration of CAncer GEnomics data (PINCAGE), which includes DNA methylation at individual CpG sites and mRNA expression. The model is modular and may be extended to other data types. We demonstrate its use for both candidate biomarker identification and sample classification. This novel method separately models the relationships between gene expression and methylation of two gene regions: promoter and gene body. It also explicitly models the distribution of the data types and the sampling of the underlying high-throughput measurements. We evaluate the method on Breast Invasive Carcinoma (BRCA) dataset from TCGA ().
Materials and Methods
Data sources and initial processingBRCA samples with both 450k Infinium array DNA methylation and RNA-seq expression data were downloaded from TCGA consortium Data Portal (). The resulting dataset consisted of 730 tumour (T) samples and 82 Adjacent Normal (AN) samples (Supplementary). The methylation array data were processed using the statistical language R (R Development Core Team, 2014): the minfi package was used to parse raw data and infer beta-and M-values (), peak-correction () was done using R routines provided by Matthieu Defrance for the IMA package (). M-values are defined as logit-transformed beta-values and are preferred for differential analysis due to their homoscedasticity (), while beta-values are preferred for biological interpretation as they represent a fraction of methylated sites in the sample. Promoters were defined as extending from 1500 bases upstream of the transcription start site (TSS) to the end of the first exon, as defined by Illumina's categories [TSS1500, TSS200, 5 0-untranslated region (UTR) and first Exon; 450k Manifest File v1.2 (); Supplementary]. Similarly, gene bodies were defined as extending from the end of the first exon to the end of the transcript (Illumina's gene body and 3 0-UTR regions; Supplementary). The overall promoter and gene body methylation levels were averaged across individual probes for use in plotting and downstream analysis. The RNA-seq data were already summarized per gene and no further processing was needed, except for calculation of original library sizes. For plotting and LR analysis, we A B. Data summary. (A) Definition of datasets and their sizes. (B) Data structure schema: samples were divided into two groups: adjacent normal (AN), and tumour (T). Within each sample (indexed by s), genes (indexed by g) were profiled for mRNA expression levels and DNA methylation, yielding read counts for expression (RNA-seq) and methylation levels for the included promoter (P) and gene body (GB) CpG sites normalized gene expression read counts by library size and reported reads per million (RPM). The data were summarized and organized by disease groups (T versus AN), samples (indexed by s), genes (indexed by g), data types (expression, promoter methylation or gene body methylation) and directly measured variables (read count or probe-specific methylation levels) (). The indexing and naming scheme introduced in thewill be used throughout the rest of the manuscript. To concretise the data and to show that statistical independence between data types is seldom fulfilled, we show their marginal distributions across samples and groups, and their pairwise correlations for the PLK1 gene (). We will use this and other examples in the further subsections when arguing for our model design choices.
PINCAGE modelWith the aim of integrating multiple levels of genomic data, we developed a gene-oriented probabilistic model of expression, promoter methylation and gene body methylation. The model should be able to define the joint distribution of the observed data as well as to capture potential dependencies between data types, as seen for the PLK1 gene (). It should be of a modular nature to allow fits to data of increasing complexity. Based on these considerations, we chose to base the model on probabilistic graphical models. Probabilistic graphical models are inherently modular and are composed of separate sub-models. In our setup, we have individual sub-models for each of the data types (promoter methylation, gene body methylation and gene expression) for every gene (). Each sub-model specifies a distribution over the observed variables of the corresponding data type. As both promoter and gene body methylation levels may affect gene expression levels (), we aimed to capture their underlying relationships. We therefore included pairwise interactions between gene expression and the two methylation types in our model (, green arrows).
PINCAGE methylation sub-modelsWe decided to model gene body and promoter regions separately for two reasons: first, the distributions of their methylation levels show distinct differences (), and second, different molecular mechanisms govern their CpGs methylation levels (). For both regions, we model an underlying overall methylation status, which the observed methylation levels at individual probed CpG sites depend on. The dependency structure can be visualized graphically (; methylation models) and results in the following factorization of the joint probability of the promoter (P) and gene body (GB) specific sets of probed methylation sites (where r is an experimentally determined standard deviation; r  0.14 (), while m P g;s and m GB g;s represent the expected methylation level of given promoter and gene body, respectively. The priors on methylation levels PM P g;s  and PM GB g;s  are specified using Gaussian kernels (see Section 2.2.4).
PINCAGE expression sub-modelWe next defined a probabilistic model of a given gene's expression across samples. The RNA-seq data is summarized as the number of mapped reads per gene per sample (r g;s ). However, these counts are not directly comparable, as the total library size (r :;s ), which is summed across all genes, differs between samples. The expression levels are therefore normalized by the library size (e g;s  r g;s =r :;s ) and given in terms of RPM. The uncertainty in the measured expression level depends on the library size: the smaller the library the larger the sampling variance. To capture this relationship, we model the observed read count as dependent on both the expression level and the library size (; Expression model) using a Poisson distribution (Eq. 6), similarly to various other methods (). The joint probability of the observed read counts given their corresponding library sizes in a set of samples is computed using the following formula:
PINCAGE integrative modelThe integrative model combines the sub-models to capture the gene specific interplay of methylation and expression. Methylation of either promoter or gene body can affect gene expression levels or even transcript splice patterns (). The current paradigm is that promoter methylation generally silences/down-regulates gene expression as a result of insulation from transcription factor binding (). In contrast, gene body methylation seems to generally be associated with active transcription (). The example of the PLK1 gene () clearly shows the relationship between gene expression and methylation types can be more nuanced. We integrate the individual sub-models described above by modelling the pairwise interactions of gene expression (E g ) with promoter (M P g ) and gene body (M GB g ) methylation (). The joint probability of a data tuple D g , containing promoter methylation, gene body methylation and gene expression data for a given gene across samples (D g  M P:CpG g ; M GB:CpG g ; R g ; r : ), is given by the following factorization:P Eg;s  eg;s   P Rg;s  rg;s j Eg;s  eg;s; r:The individual sub-models remain the same. The dependencies of methylation levels on expression, PM P g jE g  and PM GB g jE g , are specified using 2D Gaussian kernels (see Section 2.3). The integrative model can learn the joint distribution of expression and methylation in promoter as well as gene body (GB) regions. Though hierarchical, the modelling approach is not Bayesian, as the parameters are not assigned prior distributions.
Model implementation and discretizationWe have made a factor graph library to implement the above probabilistic graphical models, which currently handles only discrete random variables. Restricting to discrete random variables simplifies. Directed acyclic graph representation of PINCAGE probabilistic graphical model. Individual sub-models are sub-set using orange boxes. Variables in square boxes are observed, while variables in circles are inferred. The dependencies highlighted in green are present only in the integrative model the implementation and speeds up likelihood calculations. The model implementation therefore relies on discretization of the continuous random variables. The discretization scheme is separately defined for each variable within each gene model based on all training samples: first, continuous kernel-smoothed overall densities were inferred, and second, 25 bins were defined, each spanning four percentiles. In this setup, inferred distributions of regional methylation, expression or methylation given expression become multinomial distributions with parameters specified using grid Gaussian kernels as implemented in the AWS () and smoothie () R packages (see Supplementary data: PLK1 example of training process and). We use kernels to smooth the fine-grained discrete probability distributions and to prevent overfitting. The training process can be described as smoothing of the evidence across the grid representing the discretized conditional probability distribution table. The training therefore depends on the smoothing parameter which we calculate per gene using a heuristic scheme (optimized based on simulation studies, formula and kernel given in Supplementary Equations S1 and S2) that ties it to the number of available data points and to the resolution of the discretization. The smoothing parameter was selected to strike the right balance between overfitting and discriminatory power. Generally, increasing its value will lower the variance of the predictions and protect from overfitting, while lowering its value may lead to overfitting, especially when the training data are insufficient given model complexity. The discretized versions of the joint probability distributions sum, rather than integrate, out the unobserved random variables:where d E is the number of bins used to discretize normalized expression, d P and d GB are the numbers of bins used to discretize promoter and gene body methylation states, respectively. The non-parametric form of the distributions allows them to capture the potentially multi-modal and highly variable methylation and expression distributions seen for cancer samples (, cumulatively shown in). For a given gene, cancer samples often show much heterogeneity, with some behaving like normal tissue while others are perturbed in various ways (Supplementary, examples of RNASEH2A, TMEM63B, PLK1 and RABIF, amongst many others). This approach also allows us to capture the often complex, non-linear and highly gene-specific relationships between gene expression and methylation (Supplementary, RAG1AP1, CPA1, PLK1).
Applications
Evaluationof the degree of perturbation We evaluate the degree of perturbation of expression-, methylation-or joint expression and methylation using a modified likelihood ratio test procedure (). Consider a calculation of the D statistic in a comparison between AN and tumour groups (Gr.):The T and AN gene models are trained using only tumour or only AN samples, respectively. The prior probability would typically reflect the expected proportion of normal samples P Gr:  AN  versus the proportion of tumour samples P Gr:  T  . However, we only supply uniform priors in our applications. The null model is trained using samples from both groups. Due to variable number of CpG sites for each gene, raw values of the D statistic cannot be directly compared across the genome. Hence, we normalize the value of the D statistic using its random expectation obtained by permuting sample labels:The final genome-wide ranking of gene perturbations is based on Z-scores. Although some tumours are paired with AN tissue (n  82), we ignore this pairing to facilitate inclusion of the majority of tumours without the AN counterpart (n  682). In this way we can better evaluate the degree of heterogeneity of the tumour group and apply the approach to unpaired datasets.
Classification of sample's group labeluse in clinicsHere, we show how our model can be used to predict which group label is the most probable for a given sample (tumour versus normal, progressing versus non-progressing, etc.). For instance, to classify a given sample as either tumour or AN, we evaluate the likelihood of its data (D g;s  d g;s ) using both the T model and AN model and evaluate the posterior probabilities of belonging to either group: PGr:  TjD g;s  d g;s  and PGr:  TjD g;s  d g;s  (Eqs. 10 and 11).PGr:  ANjD g;s  d g;s   1  PGr:  TjD g;s  d g;s Furthermore, we may combine the evidence from several genes to improve classification performance. Given a set of selected candidate genes (G), we implement this using a navenave Bayes classifier and thus assume independence between genes: PINCAGEIn this case, T model G and AN model G are sets of selected gene models. We later construct navenave Bayes classifiers using running combinations of most significant genes.
B
Time complexityThe likelihood evaluation of the integrative model dominates the time usage (Eqn. 11). For each gene, it is linear in the number of samples (n), the number of bins used to discretize expression d E , the number of CpG sites (n P  n GB ), and the number of bins used to discretize the methylation levels (d P and d GB ):The Z-score evaluations are much more time-consuming than the final classification, as the likelihood evaluations are performed across the dataset for each the permutations (n perm  100. The actual run-time therefore depends on the size of the dataset and the number of bins used for discretization (d E d P d GB  25. For the BRCA dataset, with 17 728 genes evaluated across 487 tumours and 55 normals, the total runtime of the significance evaluations were 5400 CPU core hours on Intel E5-2670 processors. The median runtime for a single gene was $16 min. For the smaller progression set (n  71), the median runtime was 4.5 min per gene. The classification for selected candidates is $2 orders or magnitude faster than the significance evaluation.
Comparison to existing methodsWe compared PINCAGE's performance with established methods within differential methylation, gene expression analyses and classification tasks. For differential expression analysis, we compare with the edgeR algorithm using tag-wise dispersion (). For the differential methylation analysis, we compare with Welch's t-test () applied to the mean methylation levels across all CpGs within promoters or gene bodies. The widely used limma method () does not apply to our simulated dataset as it learns and uses a prior on the observed variance and is therefore not used. For independent combination of the individual data types, we use Fisher's method (), which we apply to independently combine both the established methods and PINCAGE sub-models. When we below refer to combinations of methods/models we always mean the combination with the Fisher's method. We control the false discovery rate (FDR) using the Benjamini and Hochberg procedure () in the differential analysis of expression, methylation or joint expression and methylation data across all genes. For sample classification, we primarily compare against the LR (). For the progression set analysis, which is based on smaller sample set and is generally a much harder problem, we additionally compare against Random Forests () and Bayesian LR (Bayesian LR) (). These ML methods were identified as the best performing multi-modal uniform classifiers in a range of different cancer-related tasks including recurrence and survival (). We use the normalized gene expression (RPM), and overall regional GB and promoter methylation levels as predictors for the ML methods. LR classifiers were built without any interaction terms. Classifiers involving multiple genes include sets of gene-specific expression and overall methylation predictors. Optimal tuning hyper-parameters for the different ML methods were found using grid search via the caret package (). Final ML models were trained using bootstrapping with 25 repetitions.
Results
Overview of DNA methylation and gene expression in breast cancerWe first characterized the breast cancer methylation and expression profiles across all genes using the BRCA dataset to motivate the model design choices. A central aim was to evaluate the degree of correlation between promoter or gene body methylation and expression for each gene and the degree of variability of tumours compared with normals. We first looked at the global distributions of the three data types. The overall expression profiles of tumours and AN samples were similar, though tumours showed a relative increase in the number of lowly expressed genes (more genes with RPM 1). The distribution of methylation levels across promoters was bimodal: some were highly methylated, though the majority were lowly methylated. More highly methylated promoters (Mvalue > 2/Beta-value > 0.8) are seen for normal samples (16.4%) than for tumour samples (13.8%). Consistent with existing observations of cancerous hypermethylation of the normally unmethylated promoters (), moderately methylated promoters (M-value >-1 & < 1/Beta-value > 0.33 & < 0.67) were more abundant among tumours (16.1%) than normals (12.9%). The distribution of gene body methylation is unimodal, with a large fraction of highly methylated genes, though also here, high methylation levels are more common for ANs (44.4%) than for tumours (40.2%). Even if the mean level of a data type for a gene is not perturbed between tumours and ANs, the amount of variation across individual samples may still differ. To characterize the frequency and strength of this, we evaluated the ratio between the standard deviation of the tumour sample set and the AN sample set for each gene. Consistent with previous reports in various cancer types (), all three data types show significantly higher variation in the tumour samples than in the AN samples (). We defined 5% significance levels using genome-wide random expectation (Supplementary) by repeatedly (n  10) permuting sample labels genome-wide. Significantly increased variability in tumours compared with normals was more often seen for the methylation data types (71.3% of gene bodies and 58.5% of promoters) than expression (12.9%). We next evaluated the gene-specific correlation of promoter and gene body methylation with expression () to further motivate separation of these relationships. Gene body methylation was primarily negatively correlated with expression in the ANs (57.9% of genes), which contrasts the generalization from most studies (). Promoter methylation was also primarily negatively correlated with expression (69.3% of genes), which is in agreement with the existing paradigm (). In both cases, however, much variation in direction of correlation existed, with no general rule, though tumours generally showed PINCAGEless extreme levels of correlation between methylation and expression than AN samples. We further quantified the significant fraction of gene-specific expression-methylation correlations at 5% significance levels () using the group-specific random expectations (Supplementary). The significant fractions of gene expression correlation with promoter and gene body methylation were generally larger in AN samples (26.1% of gene bodies, 22.4% of promoters) than in tumours (19.7% and 18.4%, respectively). There was also a significant fraction of negatively correlated methylation of gene bodies and promoters with gene expression, though smaller than of the positively correlated in both tumours (7.8% and 9.8%, respectively) and normals (12.3% and 8.49%, respectively). We finally looked at the per-gene differences in methylation to expression correlation between the tumour and AN groups (). More genes show significant positive correlation changes than expected by random (Supplementary) across both methylation types (27.0% of gene bodies and 24.9% of promoters), which is in agreement with the average trend across genes (). To a smaller degree, albeit still significant, negative shifts are also seen for some gene bodies (11.7%) and promoters (7.4%). Correlation of expression and methylation signals and variation in the strength of these correlations suggest joint, adaptive analysis of the three data types to be important. Also, the heterogeneity of the cancer cohort suggests use of flexible and multi-modal distributions for modelling individual variables and the relationships between them.
Simulated dataWe initially explored PINCAGE's performance under different conditions using artificially generated datasets as follows. We first simulated datasets under a range of conditions and then evaluated the ability to detect genes perturbed in tumour using the significance evaluation procedure described above (Eqs. 8 and 9). The overall performance was quantified using the Area Under the receiver operating characteristic Curve (AUC). Each dataset consisted of an equal number (n  100) of tumour and normal samples with values for all three data types simulated for 2,000 genes (Supplementary data: Simulation procedure description). The parameters of the simulation (Supplementary) were chosen to resemble the values observed for the BRCA dataset (). We first asked how the detection of perturbed genes changed if only a fraction of the tumour samples were truly perturbed, to evaluate the effect of inter-tumour heterogeneity on individual and joint analyses using PINCAGE and established methods (Supplementary data: Evaluation of heterogeneity simulated datasets). The performance was both better initially when the signal is the purest and degraded more slowly as the fraction of perturbed tumour samples decreases (Supplementary). We attributed PINCAGE's greater robustness to tumour sample heterogeneity in this setting to its ability to model the resulting multi-modal distributions. We next explored the effect of modelling the dependencies between the data types as done in the integrative model. For this, we simulated a separate series of datasets with constant levels of correlation between expression and methylation in the normal samples and varying levels in the tumours, as seen in the BRCA dataset (and D). The joint analysis using the integrative PINCAGE model recovers more signal than combining either the established methods or individual data type models throughout in this setting (). As the difference in correlation levels increase between tumours and normal samples, the performance gain of the integrative model increases over the combination of individual data type tests.
Gene perturbation between BRCA tumours and normalsWe next used PINCAGE to detect perturbed genes across all genes of the BRCA dataset. We withheld one-third of the data (validation) for later evaluation of the discriminatory power of the identified genes. The remaining two-thirds (training) were used to contrast tumour (n  487) samples with AN samples (n  55) using the integrative PINCAGE model, the individual PINCAGE sub-models, and the established methods. The vast majority of genes (>91%) were found to be significantly altered at 1% FDR when including all three data types by combination of the established methods (n  16 805). This showed that most genes were perturbed in at least one data type in the BRCA set. We next asked if known sets of cancer genes ranked differently between the P-value ordered gene lists generated with the combination of established methods and PINCAGE Z-scores (Supplementary). We evaluated the set of candidate genes from the original TCGA study of the BRCA set (); a general set of cancer driver genes (), and the set of COSMIC driver genes (). No set showed a significant bias toward the most significant/perturbed genes by either method (Supplementary). However, the combination of established methods showed marginally stronger association of COSMIC and Vogelstein et al. genes towards low ranks (P-values of 0.3294 and 0.3296, onesided Wilcoxon rank sum test) than integrative PINCAGE (P-values of 0.7358 and 0.8493). The differences between methods, however, were insignificant (P-values of 0.7661 and 0.8425, MannWhitney test). This suggests that many more genes are jointly more perturbed than those in the driver gene sets. We finally evaluated the overall Spearman correlation of gene ranks from the different methods. For the PINCAGE sub-models compared with the established methods on individual data types, the correlation was highest for gene expression (cor  0.731), with gene body (cor 0 .576) and promoter (cor  0.542) methylation being at similar levels (Supplementary). Upon combination of all three data types, the ranking between methods became more concordant, with the combination of the established methods showing similar levels of correlation as the integrative PINCAGE model (cor 0. 742; Supplementary) and the combination ofindividual PINCAGE sub-models (cor  0.747; Supplementary). The analysis using integrative PINCAGE correlated strongly with the combination of PINCAGE sub-models (cor0. 868; Supplementary). The three compared integrative methods generally agree on the overall ranking but differences are apparent. These differences are likely caused by incorporation of dependencies and allowing for multimodality by the PINCAGE models.
Top-ranked candidatesAmong the top-10 ranked candidates from the integrative PINCAGE model (), we found that five had been linked to breast cancer previously: CPA1, NEK2, RNASEH2A, TIMM17A and PLK1 (references in Supplementary). Marginal distributions of the PLK1 (and Supplementary S8, PLK1) show pronounced changes between disease groups. Also, patterns of differential correlation were seen between groups. Three additional genes from the top-10 had been associated with other types of cancers. The RABIF gene regulates the Rab family of proteins involved in cancer cell motility (). The PTF1A encodes the subunit alpha of pancreas transcription factor 1, which is involved in cell fate determination in various organs () and is causally implicated in exocrine pancreatic cancer (). Although the expression of PTF1A is lost in exocrine pancreatic cancer and is unexpressed in breast tissue, we observed an activation of transcription of this gene in some of the BRCA tumour samples (Supplementary, PTF1A Expression). It is highly differentially methylated in both promoter and GB regions (P-values of 2.18e-29 and 4.56e-34; Welch's t-test), though these changes appear uncorrelated with status of expression changes. Finally, the RAG1AP1 encodes transporter SWEET1 that mediates sugar transport across membranes (). GLUT1, another sugar transporter, was previously found upregulated and substantially increasing glucose uptake into cytoplasm in many cancers (), contributing to one of the hallmarks of cancer, the Warburg effect (). We saw the same pattern of up-regulation in BRCA with the RAG1AP1 (Supplementary; RAG1AP1, P-value2.44e-77, edgeR) and speculate its similar role in the Warburg effect. The final two genes are poorly characterized: TMEM63B encodes Transmembrane Protein 63B (differentially expressed, P-value1.95e-64, edgeR), and, interestingly, LOC148145 is a nonprotein-coding gene, encoding lincRNA 906 that is very lowly, yet differentially expressed (P-value1.70e-40, edgeR) and highly methylated in BRCA tumour samples (P-values of 1.81e-38 and 3.87e-73 for promoter and GB, Welch's t-test).
Classification of tumour versus normalWe explored PINCAGE's classification performance on the top-10 most significant genes and compared it against that of LR using the same set of genes or using genes identified with combination of established methods. We evaluated the methods using the set-aside adjacent normal (n  27) and tumour (n  243) samples and report AUCs for both individual genes and their running combinations (; right-hand side). For individual genes, the performance varies and neither PINCAGE nor LR models are consistently best in the top-10 (3 versus 7, respectively). Upon combination of signals across genes using the navenave Bayes approach for integrative PINCAGE models (Eqs. 12 and 13), the performance remains very high (AUC%0.998) and stable after AUC saturation at the fifth gene. When signals across multiple genes are combined, the PINCAGE classifiers showed better performance than the LR models that had fluctuating AUCs. For comparison, we also evaluated LR models using the top-10 most significant genes according to the combination of established methods (Supplementary). Several genes among the top10 are of relevance to breast cancer (references in Supplementary), however, their ranking is primarily driven by changes in gene expression between cancers and AN samples, rather than by joint expression-methylation gene perturbation (Supplementary). The resulting individual gene classifiers show similar classification performance as the LR classifiers produced using the top-10 genes from the PINCAGE ranking.Signifies significantly higher AUC than competing LR or PINCAGE classifier ().
Gene perturbation between BRCA progressed and non-progressed tumoursWe next applied PINCAGE to the more challenging problem of discriminating between progressing and non-progressing tumours. In the BRCA set, we used occurrence of a new tumour after initial treatment (recurrence) as a proxy for disease progression. Tumour samples were dichotomized into progressing (n  14) and non-progressing (n  57) based on presence or absence of recurrence within close to 3 years (1065 days) of initial treatment (Supplementary). This time threshold maximizes inclusion of patients with recurrence. Remaining patients with clinical follow-up (n  121) had not been followed long enough to be included. We first identified significantly perturbed genes between the groups using the combination of established methods (, lefthand side). Much smaller number of genes was found significantly perturbed (n  234) at 1% FDR than in the tumour-normal comparison. Among the top-10 most perturbed genes according to PINCAGE, the distributions of observations are complex for both groups (Supplementary) and classification based on individual data types appear difficult.
Classification of progressing versus non-progressingWe next asked how accurately the PINCAGE models could classify unseen tumour samples as progressing (i.e. aggressive) versus nonprogressinga question of great clinical relevance. Given the limited number of progressing tumours, a cross validation procedure was used. Specifically, we divided the training data into 14 subsets, with one progressing sample and 45 non-progressing samples in each. In each fold of the procedure, a subset is held out for validation and the remaining training samples were used to (i) rank genes according to significance evaluation and (ii) train classifiers for each gene in top-10. This approach was used with the integrative PINCAGE model and the combination of established methods. Similarly to the tumour versus normal setting, the classifiers based on a running combination of top-k genes generally performed better than individual gene classifiers for the PINCAGE methods. However, the performance peaked already at top-2 genes for the integrative PINCAGE classifier (AUC0.8358), which was significantly better than that of the corresponding LR classifier (AUC0.7895; P-value7.76e-09; DeLong's test, (). However, the LR classifiers trained using PINCAGE-identified genes exhibited erratic AUCs ranging from 0.4091 at the fifth gene to 0.8860 at the ninth gene, suggesting that the LR classification was less robust. The LR classifiers based on genes ranked by the combination of established methods generally showed poorer performance, peaking at the top ranked gene (AUC0.7055), with consistently lower AUCs for all running combinations.
ZNF706 and SERPINE3The most consistently top-ranked genes (22 of 28 possible positions in the top-2; Supplementary) in the 14-fold cross-validation procedure were the Serpin Peptidase Inhibitor Member 3 (SERPINE3) and the Zinc Finger Protein 706 (ZNF706). The candidates ranked 310 did not validate as well and therefore hold less promise as effective biomarker candidateslarger datasets would be needed to reliably identify and evaluate these. Neither of the two top biomarker candidates has previously been linked to breast cancer. ZNF706 is a zinc finger transcription factor with limited characterization in the literature; however, it was found upregulated in Laryngeal Squamous Cancer (). We also found it consistently upregulated in tumours versus normals in the BRCA set (P-value2.02e-08; edgeR). In the progression dataset, its gene body and promoter methylation levels were significantly correlated with gene expression. Also, the gene body methylation levels were significantly different between progressing and non-progressing tumours when evaluated on their own (P-value5.23e-4, Welch's t-test; Supplementary). Four alternative splicing isoforms exist for ZNF706 and the differential gene body methylation could potentially signify their differential usage. SERPINE3 belongs to the large serpin family of protease inhibitors, which targets a wide variety of serine and cysteine proteases. Though little is known specifically about SERPINE3, excreted serpins were previously found to be important in producing the correct microenvironment for tumour growth and spread (Xiao et al.,). Recently, serpins were found to play a role in brain localization of breast and lung cancer metastases (). We find that SERPINE3 has significantly lower levels of gene body methylation in progressed versus non-progressed BRCA tumour samples (P-value 3.15e-5, Welch's t-test), but remains very lowly expressed in both groups (Supplementary). However, we find other serpins to be more highly and differentially expressed in the progression set: SERPINB3, SERPINB4, SERPINB7, SERPINE1 (2.06e-07, 2.21e-07, 5.98e-03 and 3.17e-05 respective P-values; edgeR), though the functional interpretation and possible relation to SERPINE3 is not known. Although both ZN706 and SERPINE3 are interesting biomarker candidates for breast cancer disease progression, further studies are needed to establish their roles and clinical applicability. However, this task is beyond the scope of the current work. In comparison with best classifiers based on clinical and immunohistochemistry features for the same BRCA dataset (), with AUCs averaging 0.686 across different tasks including prediction of survival in dichotomized timeframes, the identified biomarker candidates represent significant improvements in classification performance.). We evaluated the classification performance of all genes from this set across both PINCAGE and ML methods. Again, we used PINCAGE Z-scores to select top genes at each of the 14-folds. The mean performance on this gene set using single rank classifiers was highest for integrative PINCAGE (), followed by LR, Bayesian LR and Random Forests. Upon combination of all PAM50 genes for which both methylation and gene expression data was available (n  54), the performance increased for PINCAGE, and dropped for the other methods. The classification performance using the externally defined PAM50 set is generally lower than for the top-ranked genes in the genome-wide analysis (), with few classifiers achieving AUCs above 0.6500. The genes most often top ranked were BCL2 and PSMC4 (Supplementary), though not as often as SERPINE3 and ZNF706 ranked at the top in the genome-wide analysis (Supplementary). These observations show that the PINCAGE model achieves better overall signal extraction than the other methods and can identify robust biomarker candidates.
Classification using
DiscussionCancer genomics data types are often integrated under a simplifying assumption of independence (). We have introduced PINCAGE, a flexible model for integration of multiple gene-level genomic data types based on the probabilistic graphical model formalism. We applied it to three types of data: gene expression, promoter methylation and gene body methylation. PINCAGE integrates these by modelling pairwise interactions between both DNA methylation types and gene expression. This permits joint analysis and evaluation of data tuples while considering their relationships. The genome-wide analysis of gene expression and DNA methylation across tumours and AN samples in the BRCA dataset revealed patterns and correlations that support joint analysis of data types with flexible, non-parametric models. Our findings also suggested that regulation of expression by methylation is usually concerted with other mechanisms in the healthy system, while in cancer, the impact of methylation changes on expression is more limited (). The strength likely depends on the genomic context, with other factors such as copy number variation, binding by transcription factors, mutation of regulatory elements, histone modifications or nucleosome positioning also affecting expression. We implemented PINCAGE's probability distributions with Gaussian kernels. By doing so, we can encode the complex and often multimodal distributions across data types, relationships, and groups. Similarly to established methods for count-based RNA-seq expression analysis that introduce a gamma prior to account for the overdispersion of Poisson-distributed read counts (), we also model the overdispersion, however, using the gene-specific empirical priors instead. This improves model fits in the analysis of cancer datasets known for high variance. To our knowledge, no other method models the overdispersion in the integrative context. Benefits of such integrated data analysis are 2-fold. First, it enables detection of subtleIn the last row, AUC values for single rank classifiers represent the mean performance across all 54 ranks for given method. The bold AUCs denote highest value at given rank.
PINCAGEsimultaneous deviations of all three variables that would be too weak to become significant if analysed separately. Second, the inference becomes more robust to noisy data, especially when the data types are interdependent, as seen in our simulation study. The reason is that the model can exploit the partial redundancy among observations. This is relevant for both the group comparisons and the classification of new samples. Fisher's method for data integration, on the other hand, assumes independence between tested data types and therefore in some cases can under-or over-emphasize the significance of findings when dependencies exist. In contrast, apart from performing joint analysis, PINCAGE models the relationships between data types and thus can evaluate each set of observations with respect to the expected dependency. This should help rank genes according to their combined perturbation and aid in sample classification. Our empirically defined, kernel-smoothed probability distributions results in parameter rich specifications. Provided there is enough training data, this approach will accurately capture both the group-wise distributions of data types and the relationships among them. When the amount of training data is limited, however, parametric specification of probabilistic distributions yields simplistic, yet more reliable results. This can viewed in terms of the biasvariance trade-off (): parameter-rich models will typically have more prediction variance and less prediction bias compared with parameter-sparse models. In this respect, our approach would benefit from a larger BRCA progression dataset with more patients followed up as it would help address the issues with high number of parameters. As the amount of quality data available for training will likely increase in the future, parameter-rich models, such as PINCAGE, will become increasingly powerful as prediction variance is reduced. Also, upon combination of likelihoods across many genes, the inherent variance of single gene models is greatly reduced, as shown with the PINCAGE running combinations of genes. In the future, more data types are also expected to be available per sample amenable to PINCAGE-style modelling. The generation of multiple data types could be prioritized by their information contents (). In contrast to most integrative methods such as (), our approach aims at identifying individual integrative biomarkers, rather than clusters of molecular features able to stratify patients by survival. It facilitates translation of integrative analyses into clinical practice as assays for individual biomarkers are more scalable and cheaper than the genome-wide platforms whose data is required for clustering. PINCAGE could also be used to cluster samples into subtypes by appropriate formulation of the question in probabilistic terms. For instance, a discrete parent variable denoting group membership could be introduced into the model. Our future work could also be directed at parametersparser implementation of the model, which would help in the analysis of smaller cancer cohorts that offer limited training material. Finally, PINCAGE could also be used for feature selection for external ML classification methods, similarly to the supervised canonical correlation analysis methods such as GNCCA (). However, the NaveNave Bayes classification used in PINCAGE proved to be well performing, especially when combining evidence across genes. On the other hand, further studies are required to confirm the robustness of integrative biomarker candidates, and to test how well they generalize across cohorts. Integrative cancer genomics analysis has received growing attention over the last years, but much work remains. With the advent of large publically available datasets, such as from the TCGA or ICGC, and with the growing data generation of individual research laboratories, integrative methods will play increasing roles in clinical research and practice as they better exploit the available information and become increasingly robust with higher number of data points. Collection of molecular data has to be met with increased quality of clinical annotations, which will facilitate discovery of molecular biomarkers for improved diagnosis, prognosis and treatment stratification of patients. The freely available PINCAGE software is available as R scripts with examples of processed BRCA data at http://moma.ki.au.dk/prj/ pincage/, with a faster and more user-friendly implementation under development.
M.P. Switnicki et al. at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
B B B B B B B B B B B B B B B B B B B B B @
Right: Comparison of classification performance for integrative PINCAGE, LR on PINCAGE-identified genes, and LR on genes found by combination of established methods with Fisher's method.
