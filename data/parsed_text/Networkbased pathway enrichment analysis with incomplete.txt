Motivation: Pathway enrichment analysis has become a key tool for biomedical researchers to gain insight into the underlying biology of differentially expressed genes, proteins and metabolites. It reduces complexity and provides a system-level view of changes in cellular activity in response to treatments and/or in disease states. Methods that use existing pathway network information have been shown to outperform simpler methods that only take into account pathway membership. However, despite significant progress in understanding the association amongst members of biological pathways, and expansion of data bases containing information about interactions of bio-molecules, the existing network information may be incomplete or inaccurate and is not cell-type or disease condition-specific. Results: We propose a constrained network estimation framework that combines network estimation based on cell-and condition-specific high-dimensional Omics data with interaction information from existing data bases. The resulting pathway topology information is subsequently used to provide a framework for simultaneous testing of differences in expression levels of pathway members , as well as their interactions. We study the asymptotic properties of the proposed network esti-mator and the test for pathway enrichment, and investigate its small sample performance in simulated and real data settings. Availability and Implementation: The proposed method has been implemented in the R-package netgsa available on CRAN.
IntroductionRecent advances in high-throughput technologies have transformed biomedical research by enabling comprehensive monitoring of complex biological systems. By profiling the activity of different molecular compartments (genomic, proteomic, metabolomic), one can delineate complex mechanisms that play key roles in biological processes or the development of distinct phenotypes. These technological advances have thus motivated new methodological developments, most notably the adaptation of systems perspectives to analyze biological systems. Pathway analysis represents a key component in the analysis process and has been used successfully in generating new biological hypotheses, as well as in determining whether specific pathways are associated with particular phenotypes. Examples include analysis of pathways involved in initiation and progression of cancer and other complex diseases (), discovering novel transcriptional effects and co-regulated genes (), and understanding the basic biological processes in model organisms (). Seefor additional examples of applications.Pathway analysis methods have evolved since the seminal work by. As pointed out in the review article by, earlier techniques such as over-representation analysis (), and gene set analysis (GSA) () treat each pathway as a set of biomolecules. These methods assess whether members of a given pathway have higher than expected levels of activity, either by counting the number of differentially active members, or by also accounting for the relative rankings of pathway members and/or the magnitude of their associations with the phenotype. On the other hand, more recent and statistically powerful methods also account for interactions between biomolecules. These interactions are increasingly available from carefully curated biological databases, such as Kyoto Encyclopedia of Genes and Genomes (KEGG,), Reactome (), RegulonDB () and BioCarta (). A network topology-based method that exhibits superior statistical power in identifying differential activity of pathways was proposed in). The Network-based Gene Set Analysis (NetGSA) method also allows testing for potential changes in the network structure under different experimental or disease conditions. However, it requires a priori knowledge of interactions among pathway members, which, despite rapid progress, remains highly incomplete and occasionally unreliable (see e.g.and references therein). Moreover, existing network information often determine molecular interactions in the normal state of the cell, and do not provide any insight into condition/ disease-specific alterations in interactions amongst components of biological systems. The increased availability of large sets of high-dimensional Omics data [e.g. from The Cancer Genome Atlas (TCGA), http://can cergenome.nih.gov/], coupled with the development of network estimation techniques based on graphical models () offers the possibility to validate and complement existing network information, and to obtain condition-specific estimates of molecular interactions. Such an approach for leveraging existing knowledge to enhance the analysis of low signal-to-noise biological datasets was advocated in. The first contribution of this article is the development of a method for constrained network estimation from high-dimensional data, together with establishing the consistency of the resulting estimate. Estimation of high-dimensional networks subject to hard (or soft) constraints on conditional dependence relationships amongst random variables represents a canonical problem in the context of graphical models, and the proposed method for addressing this problem is of independent interest. By incorporating the conditionspecific network estimates from the proposed method into the NetGSA framework, we also provide a rigorous statistical framework for assessing alterations in biological pathways, referred to as differential network biology (). The proposed framework accounts for two sources of uncertainty: the first concerns the reliability of the external information used for constructing the network estimate from data. The second is the variability of the network estimate, which can impact the pathway enrichment testing procedure. We establish that, under certain regularity conditions, consistent estimates of the network can be obtained, leading, in turn, to an asymptotically most power unbiased test for pathway enrichment analysis. Our theoretical analysis also sheds light into the potential improvements in accuracy and power by directly accounting for the amount of reliable external network information. A second objective of this study is to scale up the NetGSA estimation algorithm to very large size networks. The main bottleneck in applying the NetGSA methodology arises from the estimation of mixed effects linear parametersspecifically the variance componentsfor thousands of variables. We develop efficient and stable computational methods for estimation of these parameters based on a profile likelihood approach. In particular, we employ a Cholesky factorization of the covariance matrices to speed up matrix inversions, and use it to develop a stable algorithm based on Newton's method with backtracking line search (: 487) for step size selection. To supply reliable starting points for this algorithm, we further develop an approximate method-ofmoment-type estimator. The proposed methods are illustrated on both metabolomics and gene expression data. For mass spectrometry metabolomics profiling one can obtain good quality measurements for a few hundred metabolites that do not provide complete coverage of the underlying biochemical pathways. The small number of metabolites in each pathway and the incomplete coverage of the metabolites particularly hinder the application of over-representation and GSA methods in this setting. In our experience, only topology-based pathway enrichment analysis methods, such as NetGSA, are capable of reliably delineating pathway activity, as illustrated in Section 4. Further, our investigation of previously analyzed gene expression data set on lung and breast cancer provides new useful insights. The remainder of the article is organized as follows. Section 2.1 presents the new method for network estimation under external information constraints and establishes its consistency. Section 2.2 outlines the new computational algorithm for scaling up NetGSA, as well as the inference procedure for both pathway enrichment and differential network analysis. The performance of the developed methodology is evaluated in Section 3 and is examined on real data sets in Section 4.
MethodsGaussian graphical models () are widely used in biological applications to model the interactions among components of biological systems (, Chapter 6). Specifically, partial correlation networks are commonly used to model interactions in molecular networks; these networks are represented by an undirected graph G  (V,E) with node set V and edge set E corresponding to biomolecules interactions among them, respectively. The edge set E corresponds to the p p precision, or inverse covariance, matrix X, whose nonzero elements x ii 0 refer to edges between nodes i and i 0 , and indicate that i and i 0 are conditionally dependent given all other nodes in the network. The magnitude of the partial correlation A ii 0  x ii 0 = ffiffiffiffiffiffiffiffiffiffiffiffiffi ffi x ii x i 0 i 0 p determines the strength (positive or negative) of the conditional association between the respective nodes. In the sequel, the matrix A will also be called the weighted adjacency matrix, with A ii 0 being the association weight between i and i 0 .
Network estimation under external information constraintsAs discussed in Section 1, the availability of large collections of samples for different disease states and biological processes together with carefully curated information of biomolecular interactions enables the estimation of network structures within the setting of Gaussian graphical models. However, the availability of external network information provides a novel and unexplored modification of the corresponding network estimation problem. Denote by E c the set of node pairs not connected in the network, i.e. x ii 0  0. Then, the external information can be represented by the following two subsetswhere each row represents one sample from a p-variate Gaussian distribution N 0; X 1  for a given biological condition (e.g. cancer or normal). Our goal is then to estimate the network structure, or equivalently the precision matrix X, subject to external information encoded in E 1 and E 0. Let D  diagX represent the diagonal matrix whose diagonal entries are the same as X and I p be the p-identity matrix. Then, A  I p  D 1=2 XD 1=2 is the partial correlation matrix. When E 1  E and E 0  E c , the problem becomes that of covariance selection (), which has been studied extensively in the literature. However, to the best of our knowledge, the problem of estimating X (and the partial correlation matrix A) when E 1 and E 0 only contain partial information (E 1 E and E 0 E c ) has not been investigated before. In this section, we assume that the m observations used for estimating condition-specific networks are separate from those used for pathway enrichment analysis (highlighted by the use of Z i 's and m to denote the random variables and sample size, respectively). The framework introduced in this section reduces the potential bias in small sample settings, and takes advantage of the additional publicly available samples, in lieu of reliable network information. With large enough samples, network estimation and pathway enrichment can be performed using the same set of samples by incorporating sample splitting strategies. Although the problem considered in this section is seemingly similar to matrix completion (), the two problems are fundamentally different in nature. In particular, in this setting, matrix completion corresponds to completing the remaining entries from the partially observed p  p matrix A, under some structural assumptions on A, such as lowrankness. On the other hand, in the setting of graphical models, the entries of the weighted adjacency matrix are estimated based on data on the nodes of the graph. In biological settings, both the structure of the network, as well as strengths of associations may be condition-specific. Therefore, we need to accurately estimate the nonzero entries in X to recover both the structure of the network and the strength of associations between nodes. In the absence of any external information, the ' 1-penalized negative log-likelihood estimate of X is obtained by solving argmin X10 traceX b R  logdetX  kjjXjj 1 n o ;wherein b R  Z T Z=m is the empirical covariance matrix of the data, jjXjj 1  P i6 i 0 jx ii 0 j denotes the ' 1 norm of the parameters, and k is the regularization parameter. In the presence of external information, the problem can be cast as the following constrained optimization one minIn the following, we present a two-step procedure to solve the constrained optimization problem (2). The proposed approach combines the neighborhood selection technique (Meinshausen and B hlmann, 2006) with constrained maximum likelihood estimation. It exploits the fact that the estimated neighbors of each node using neighborhood selection coincide with the nonzero entries of the inverse covariance matrix (). Specifically, in neighborhood selection the network structure is estimated by finding the optimal set of predictors when regressing the random variable Z i corresponding to node i 2 V on all other variables, using an l 1-penalized linear regression. The coefficients for this optimal prediction h i are closely related to the entries of the inverse covariance matrix: for all i 0 6  i; h i i0  x ii 0 =x ii. The set of nonzero coefficients of h i is thus the same as the set of nonzero entries in the row vector of x ii 0 i 0 6  i, which defines the set of neighbors of node i. Let J i 1 and J i 0 denote the subsets Vni for which external information is available: J i 1 is the set of nodes which are known to be in the neighborhood of i, and J i 0 is the set of nodes which are known to be not connected to i.c. For i 0 2 ~Remark 1.In step (i-b) of the algorithm, the coefficients h i for known edges have not been penalized in (3). In settings where the external information may be unreliable, we can augment (3) with a lasso penaltywhere the penalty weights t i 0 i 0 2 J i 1  allow for different penalization depending on the reliability of existing information. The second step focuses on estimation of the magnitude of nonzero entries in the precision matrix X, given the estimated network topology b E. The optimization problems in both steps are convex and can be solved efficiently using existing software (e.g. glmnet and glasso in R).The proposed estimator enjoys nice theoretical properties under certain regularity conditions. Before presenting the main result, we introduce some additional notations. Let R 0 be the true covariance matrix and X 0  R 1 0. For i  1;. .. ; p, denote by jjh i jj 0  # fi 0 : h i i0 6  0g the l 0 norm of h i. Write s  max i1;...;p jjh i jj 0 andNetwork-based pathway enrichment analysisS 0  P p i1 jjh i jj 0. For a subset J & f1;. .. ; pg, let Z J be the submatrix obtained by removing the columns whose indices are not in J. We make the following assumptions.There exist / 1 ; / 2 > 0 such that the eigenvalues of R 0 are bounded, i.e. 0 < / 2 / min R 0  / max R 0  1=/ 1 < 1:There exists js > 0 such thatAssumption 1 is standard in high-dimensional settings. Assumption 2 corresponds to the restricted eigenvalue assumption introduced in, which is presented here for completeness. Denote by jEj the cardinality of the edge set E. Let r jE 0 j  j E 1 j=fpp  1=2g represent the percentage of external network information available. Clearly, 0 r < 1. We are now ready to state our first result. Theorem 1. Suppose Assumption 1 holds and Assumption 2 is satisfied with j2s. For constants c 1 > 4 and 0 < k 1 < 1, assume also that the sample size satisfieswhere S 0 is the total number of nonzero parameters excluding the diagonal. Consider b X defined in (5). Then, with probability at least 1  2p 2c 2 1 =8 , under appropriately chosen k, we haveRemark 2.In addition to the improved sample complexity (7), the convergence rate in (8) indicates an improvement of the order of ffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffi ffi S 0 log1  r 1 =m q in the presence of external information. This improvement is particularly important for our analysis of power properties of NetGSA in Section 2.2.2, which requires norm consistency of adjacency matrix estimation. Although consistency can be established using a theoretical analysis similar to graphical lasso (), our proofs in the Supplementary Materials Section A utilize the techniques from Bickel et al.Let A 0 be the true partial correlation matrix, i.e., where D 0  diagX 0 . The following corollary is an immediate result of Theorem 1. Corollary 1. Let assumptions in Theorem 1 be satisfied. Assume further that S 0  om=logp  rp. For b X defined in (5), let b A be the corresponding partial correlation matrix. Then, with probability at least 1  2p 2c 2 1 =8 , under appropriately chosen k, we have jj b A  A 0 jj 2  o1:Corollary 1 implies that, under certain regularity conditions, the error in the condition-specific network estimate b A is negligible. This proves essential for establishing power properties of NetGSA with estimated network information, as shown in the next section. The proof of Corollary 1 is available in the Supplementary Materials Section A. The tuning parameter k in the first step of the proposed algorithm is important for selecting the correct structure of the network, which further affects the magnitude of the network interactions in the second step. Accurate estimation of these magnitudes is crucial for topology-based pathway enrichment methods. We propose to select k using the Bayesian Information Criterion (BIC). Specifically, for a given k, we define BICk  trace b R b X k   logdet b X k   logm m j b E k j;where b X k is the estimated precision matrix from the data and b E k is the estimated edge set. The optimal tuning parameter is thus k   argmin k BICk.
NetGSA with estimated network informationNext, we discuss how (condition-specific) estimates of bimolecular interactions from Section 2.1 can be incorporated into the NetGSA framework to obtain a rigorous inference procedure for both pathway enrichment and differential network analysis. To this end, we formally define the NetGSA methodology based on undirected Gaussian graphical models in Section 2.2.1. In Section 2.2.2, we discuss how the constrained-network estimation procedure of Section 2.1 can be combined with NetGSA to rigorously infer differential activities of biological pathways, as well as changes in their network structures.
The latent variable modelConsider p genes (proteins/metabolites) whose activity levels across n samples are organized in a p  n matrix D. In the framework of NetGSA, the effect of genes (proteins/metabolites) in the network is captured using a latent variable model (). Denote by Y an arbitrary column of the data matrix D. Suppose the observed data can be decomposed into signal, X, plus noise e $ N p 0;The latent variable model assumes that the signal X follows a multivariate normal distribution with partial correlation matrix A. Based on the connection between linear recursive equations and covariance selection proposed in Wermuth (1980), there exists a lower triangular matrix K such thatNote that the current version of the NetGSA model differs from the original model in). This difference is primarily manifested through the definition of K in the two models: K is defined here based on the undirected partial correlation network A, whereas it was previously defined based on directed (physical) interactions among genes (proteins/metabolites) in). Assuming that c and e are independent, the NetGSA model can then be summarized as Y  Kc  e:The NetGSA methodology allows for more complex models, including time course observations. For expositional clarity, we present the methodology in the setting of two experimental conditions and consider the general case where A 1 6  A 2. Details of NetGSA under multiple conditions can be found inand the remaining n 2  n  n 1 columns to condition 2 (treatment).Here, c j is the vector of (unknown) random effects, and e j is the vector of random errors. They are independent and normally distributed with mean 0 and variances r 2 c I p and r 2 e I p , respectively. Inference in NetGSA requires estimation of the mean parameters l 1 and l 2 and variance components r 2 c and r 2 e. The variance components can be estimated via maximum likelihood or restricted maximum likelihood, which can be computationally demanding for large networks. To extend the applicability of the NetGSA, we consider using Newton's method for estimating the variance parameters based on the profile log-likelihood to improve the computational stability. See Supplementary Materials Section B for more details.
Joint pathway enrichment and differential network analysis using NetGSATo test for enrichment of a pre-specified pathway P, Shojaie andpropose the contrast vector () '  bK 1 b; bK 2 b, where b is a row binary vector determining the membership of genes in a pre-specified pathway P and denotes the Hadamard product. The advantage of this contrast vector is that it isolates influences from nodes outside the pathways of interest. Let b  l 1T ; l 2T  T be the concatenated vector of means. The null hypothesis of no pathway activity vs the alternative of pathway activation then becomes H 0 : 'b  0; H 1 : 'b 6  0:The significance of individual contrast vectors in (11) can be tested using the following Wald test statistic TS  ' b b SE' b b ;where SE' b b represents the standard error of ' b b and b b is the estimate of b. Both ' and SE' b b depend on the underlying networks, which are estimated using data from the two experimental conditions. Under the null hypothesis, TS follows approximately a t-distribution whose degrees of freedom can be estimated using the Satterthwaite approximation method (). The above general framework allows for test of pathway enrichment in arbitrary subnetworks, while automatically adjusting for overlap among pathways. In addition, the above choice of contrast vector ' accommodates changes in the network structure. Such changes have been found to play a significant role in development and initiation of complex diseases (), and NetGSA is currently the only method that systematically combines the changes in expression levels and network structures, when testing for pathway enrichment. However, the applicability of the existing NetGSA framework () is limited by the assumption of known network structure (namely K k ; k  1; 2). In the current framework, we estimate K k k  1; 2 from data as discussed in Section 2.1. We next show that NetGSA with estimated network information provides valid inference for pathway enrichment and differential network analysis. For k  1, 2, let Z k of dimension m k  p be the data matrix used to separately estimate the partial correlation matrix under condition k. Denote by S k the number of nonzero off-diagonal entries in the true partial correlation matrix A k 0 and by r k the percentage of available external information. We obtain the following result., then NetGSA is an asymptotically most powerful unbiased test for (11). The result in Theorem 2 establishes this property for (partially) estimated networks using the consistency of our proposed network estimation procedure in Theorem 1 and Corollary 1. A detailed proof can be found in the Supplementary Materials Section A.
Simulation resultsWe present two simulation studies to assess the performance of the proposed network estimation procedure, as well as its impact on NetGSA. We refer readers to the Supplementary Materials Section C for additional simulation scenariosincluding validation of Type I errors and settings with a large number of variables pand subsequent discussion. Our first experiment is based on an undirected network of size p  100. The network structure is extracted from the DREAM3 challenge () corresponding to the Ecoli network (labeled Ecoli 1). The pathways of interest are determined through a community detection algorithm based on the leading nonnegative eigenvector of the modularity matrix of the network (). Under the null hypothesis, all nodes have the same mean expression values of 1. Under the alternative hypothesis, the mean expression levels of 0%, 30%, 40% and 60% of nodes in subnetworks 1, 3, 5 and 7 are increased by 0.5, respectively. Our second experiment considers a network of size p  160 with 8 subnetworks of equal sizes, all of which are generated from the same scale-free graph of size 20. To allow for interactions across subnetworks, there is 20% chance for the hub node in each subnetwork to connect to the hub node in another subnetwork. Mean expression values for all nodes are the same under the null hypothesis. Under the alternative hypothesis, we allow, respectively, 0, 40, 60 and 80% of the nodes to have positive mean changes of magnitude 0.5 for subnetworks 14. Subnetworks 58 follow the same pattern. In both experiments, we also allow the structures in four subnetworks under the alternative hypothesis to differ from their null equivalent by a small amount, in order to simultaneously test pathway enrichment and differential networks.shows the network topologies as well as the structural changes for the chosen subnetworks from the null to the alternative hypothesis in the two experiments. Further, we study the robustness of NetGSA to model misspecification by including scenarios where a proportion (50% for r  0.2 and 20% for r  0.8 in experiment 1, and 60% in experiment 2) of the supplied structural information is incorrectly specified, i.e. they are not present in the true model. To illustrate how external network information affects the estimation accuracy, we vary the percentage of information r from 0 to 1. When r is less than 1, we estimate the adjacency matrices using Network-based pathway enrichment analysisthe proposed two-step procedure and fill in the non-zero edges with the estimated weights. When full knowledge of the network topology is given (r  1), we only apply the second step to estimate the edge weights. When there exist misspecified edges in the external information, we use two tuning parameters for network estimation, one for controlling the overall sparsity of the network and the other for correcting the misspecified edges. The optimal tuning parameters are selected over a grid of values using BIC defined in (9).compares the estimated networks with the true model under several deviance measures based on 100 simulation replications; in both experiments, the sample size for both null and alternative hypotheses is m  100. The Matthews correlation coefficients improve significantly as the percentage of external information r increases from 20 to 80%, and the Frobenius norm loss shows a clear decreasing trend, both indicating the improvement in estimation accuracy when more external information is available. In cases where the information is misspecified [denoted by 0.2(m) and 0.8(m)], one can see that the performance of network estimation is not compromised by much after properly selecting the tuning parameters. Next, we examine the performance of NetGSA in detecting pathway enrichment by comparing it with GSA (). GSA tests a competitive null hypothesis and compares the set of genes in the pathway with its complement in terms of association with the phenotype. The underlying model consists of both randomization of the genes and permutation of the samples, which are combined into the idea of 'restandardization'. This method is later denoted by GSA-c. In addition, we consider GSA with permutation of the samples only, later denoted by GSA-s, since this version of GSA compares the set of genes in the pathway with itself. Tables 2 and 3 present the estimated powers for each subnetwork in the two experiments from 100 simulation replicates, respectively. Here we use n 1  n 2  25 samples for each condition in experiment 1 and n 1  n 2  40 in experiment 2, which are different from the datasets used for network estimation. The powers are calculated as the proportion of replicates that show differential changes, based on the false discovery rate (FDR) controlling procedure of. To facilitate comparison, different FDR cutoffs are used for GSA and NetGSA to ensure consistent type I error for the first pathway in both experiments. For NetGSA, we look at scenarios when there is 20 and 80% external structural information (with and without misspecification) and use the estimated networks to test enrichment for each subnetwork. We also include the scenario where the exact networks with correct edge weights are provided, in which case only the variance components and mean expression values are estimated from the mixed linear model. True powers for each subnetwork are calculated by replacing all unknown parameters with their corresponding known values. For p  100, the results from NetGSA with the exact networks agree with the true powers, indicating low powers for subnetworks 1, 2 and 4, slightly higher powers for 3, 6 and 8, high powers for 5 and 7 due to significant changes in mean expression levels and structures. When the exact networks are unknown, we see clear improvement in the estimated powers for subnetworks 4, 7 and 8 as the percentage of external information increases from 20 to 80%. GSAs does reasonably well with overestimated powers for subnetwork 8. The last two columns inshow the estimated powers from NetGSA when the external information is misspecified. For bothcases (r  0.2 and r  0.8), the results bear high similarity to those in the first two columns, which suggests that the proposed framework is robust to inaccuracy in network information. For p  160, the NetGSA estimated powers when 20% external information is available match the true powers reasonably well, with a small underestimation of powers for subnetworks 3, 7 and 8. We note marked improvement in the three corresponding values when the external information increases to 80%. Moreover, NetGSA is able to distinguish subnetworks 58 that have both changes in mean values and subnetwork topology from their corresponding counterparts 14. When the external information is misspecified, the last two columns indicate that NetGSA still returns valid powers that are comparable to those obtained with correctly specified structural information. GSA-s yields a small overestimation of powers for subnetwork 7. In both experiments, GSA with randomization of the genes (GSA-c) fails to identify any of the differential subnetworks. are estimated P-values after FDR correction with a q-value of 0.01 for the significant pathways selected from NetGSA. These identified pathways include those that describe altered utilization of amino acids and their aromatic counterparts, as well as metabolism of fatty acids and intermediates of tricarboxylic acid cycle which were followed up for biological insights in the original study by. Among the selected pathways, fatty acid biosynthesis is not identified by GSA-s. Interestingly, GSA-c fails to report any pathway as being significantly enriched. This again confirms our hypothesis that incorporating pathway topology information allows sophisticated enrichment methods in detecting important regulatory pathways. The second data set () consists of gene expression profiles of 5217 genes for 62 normal and 24 lung cancer patients. We considered 47 KEGG pathways of size at least 5 that describe signaling and biochemical mechanisms and excluded genes that eitrher are not present in the 47 pathways, or without recorded network information. The number of genes that remain for pathway enrichment analysis is 303. Based on the external topology information from the BioGRID database, we applied the proposed network estimation procedure coupled with BIC to estimate the underlying interaction networks for both normal and cancer conditions. We then explored whether GSA and NetGSA with the estimated networks are able to detect enriched pathways using the same data set. After correcting for multiple comparisons, using a FDR of q   0:01, none of the three methods identifies any pathway as being significantly differential enriched. The lack of statistical power in obtaining differential pathways was also noted in the original article of (); see SupplementaryforFDR cutoffs are q*  0.01 for 0.2, 0.8, 0.2(m) and 0.8(m), 0.05 for GSA-s and 0.10 for E and GSA-c. 0.2/0.8 refer to NetGSA with 20%/80% external information; E refers to NetGSA with the exact networks; T refers to the true power; GSA-c/GSA-s refer to Gene Set Analysis with/without randomization of the genes based on 1000 permutations; 0.2/0.8(m) refer to NetGSA with 20/80% misspecified external information.Here 0.00 represents a zero P-value produced out of finite permutations. GSA-c/GSA-s refer to Gene Set Analysis with/without randomization of the genes based on 3000 permutations.
Network-based pathway enrichment analysisthe complete list of FDR adjusted P-values. Nevertheless, using NetGSA and a relaxed FDR cutoff threshold of 0.30 (similar to the strategy adopted in), we obtain the following top three ranked signaling pathways: Jak-STAT, p53 and Wnt. All three are implicated in lung cancer, although the latter two are also implicated in multiple other types of human malignancies. However, the Jak/STAT pathway has been recently shown to play a key role in non small cell lung cancer cells (). Our third and final application is based on a data set from TCGA (2012). The data set contains RNA-seq measurements for 17 296 genes from 1033 breast cancer specimens, including ER positive, ER negative and other unevaluated cases. As in the previous gene microarray study, the external network information is extracted from the BioGRID database. We focused on a subset of the genes that have recorded network information and are present in KEGG pathways with at least 5 members. This leaves for further consideration 800 genes with 403 samples from the ER positive and 117 from the ER negative classes, spanning over 45 KEGG pathways. We then applied the constrained network estimation procedure with the tuning parameter selected via BIC in (9) to obtain the partial correlation networks for the ER positive and ER negative classes, respectively. Due to the large number of variables, visualization of the estimated networks at the individual gene level is challenging. Instead, we examine the interactions among pathways into gain insight into their co-regulation behavior. The weighted pathway level network is defined as follows. Let each node in the network represent one pathway, with size proportional to the size of the corresponding pathway. A weighted edge between two pathways P 1 and P 2 is defined as the number of nonzero partial correlations between genes in P 1 and those in P 2 (normalized by the sizes of the two pathways). Links visualized inare the top 5% of the weighted edges, where ranking is based on edge weights.presents the FDR corrected P-values for the selected differential pathways using NetGSA based on the estimated partial correlation networks, as well as GSA-c and GSA-s. The complete table is presented in the Supplementary Materials Section D. At q*  0. 01, NetGSA reports 25 out of the 45 KEGG pathways as significantly enriched, whereas GSA either rejects the null for all pathways (GSA-c) or fails to reject any pathway (GSA-s). Selected differential pathways identified by NetGSA are also highlighted in. Of particular interest is the set of connected, enriched pathways centered around the ErbB pathway in(b). This pathway contains receptors that signal through various pathways to regulate cell proliferation, migration, differentiation, apoptosis, and cell motility and play a key role in breast cancer (), although its role in breast carcinogenesis not very well understood. Note that the Jak-STAT pathway is downstream of the ErbB one and can be activated by key epidermal growth factor receptors in the former to create signaling cascades (). Further, the GnRH signaling pathway has been reported to interact with the ErbB pathway receptors (). All these A B. The estimated pathway topology in the TCGA cancer study: (A) the complete pathway topology and (B) the subnetwork surrounding the ErbB pathway. Edges in black are present in both classes, whereas red and green edges are only present in ER positive and ER negative class, respectively. Node size is proportional to the size (number of genes) of the corresponding pathway.Here 0.00 represents a zero p-value produced out of finite permutations. GSA-c/GSA-s refer to Gene Set Analysis with/without randomization of the genes based on 3000 permutations. interconnected pathways are related to receptors that have been implicated in various studies with over-expression in the ER negative class and hence faster tumor growth and poorer clinical outcomes.
DiscussionThis article introduces a constrained partial correlation network estimation method that seamlessly incorporates externally available interaction information for genes and other biomolecules. The end product is a reliable condition-specific estimate of the underlying networks. The resulting estimated network structures are then used for network-based pathway enrichment analysis. For the purpose of constrained network estimation, one might also try the one-step constrained maximum likelihood estimation (a functionality offered in the R-package glasso) to recover the underlying partial correlation network. However, this one-step approach requires sophisticated specification of the tuning parameters at positions for which structural information is available, and can be challenging to implement in practice. Two sources of uncertainty can be identified in the proposed framework: one from the reliability of the external database information in the network estimation procedure and the other from the uncertainty regarding the estimated network itself, as well as how it propagates into the NetGSA testing procedure. As discussed in Remark 1, the proposed method can conveniently accommodate the first source of uncertainty by incorporating a non-zero penalty on parameters that are uncertain. Further, as shown in Theorem 2, the proposed test via the extended NetGSA framework is asymptotically unbiased and most powerful, given the consistency of the estimated network, and hence accounts for the second source of uncertainty. Nevertheless, in finite samples as the numerical work in the Supplementary Materials Section C illustrates, Type I errors may be slightly off in the presence of numerous errors in the estimated network (either due to misspecification of the external information or lack of samples for accurate estimation). The topic of dealing with network estimation errors and possible ways to address it is discussed in Narayan and Allen (2016). Finally, the current framework of NetGSA uses the Cholesky decomposition of the covariance matrix of the underlying network. It is natural to ask whether the order of the variables affects the result of enrichment analysis. In simulations and the real data analyses, we find that the estimated powers/P-values from NetGSA are comparable after permutation of the variables.
at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
J.Ma et al. at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
Applications to metabolomics and genomics data We apply NetGSA to three Omics data sets to demonstrate its potential in revealing biological insights. In all three studies, the P-values were corrected for multiple comparisons using the FDR control procedure proposed in Benjamini and Yekutieli (2001) to account for the dependency among KEGG pathways. Our first application is based on the metabolomics data set from (Putluri et al., 2011) to examine changes in metabolic profiles associated with bladder cancer using untargeted mass spectrometry data acquisition strategy. The data consists of 31 cancer and 27 benign tissue samples and 63 detected metabolites. Here we focused on estimating the network of metabolic interactions, enhanced by information gleaned from KEGG (Kanehisa and Goto, 2000). For each condition, we used the BIC criterion to select the tuning parameter k. At the optimal k, we applied the proposed network estimation procedure to identify the metabolic network; see Figure 2 for an illustration of the estimated networks for the cancer and benign classes, respectively. It can be seen that there are numerous interactions between pathways that describe energy metabolism in the cancer state, due to the greater need of cancer cells for energy. We tested for differential activity of biochemical pathways extracted from KEGG using the same set of data. Shown in Table 4
