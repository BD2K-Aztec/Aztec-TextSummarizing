Tomo3D implements a multithreaded vectorized approach to tomographic reconstruction that takes full advantage of the computer power in modern multicore computers. Full resolution tomograms are generated at high speed on standard computers with no special system requirements. Tomo3D has the most common reconstruction methods implemented, namely weighted Back-projection (WBP) and simultaneous iterative reconstruction technique (SIRT). It proves to be competitive with current graphic processor unit solutions in terms of processing time, in the order of a few seconds with WBP or minutes with SIRT. The program is compatible with standard packages, which easily allows integration in the electron tomography workflow.
INTRODUCTIONElectron tomography (ET) allows visualization of complex specimens in its native cellular context at near-molecular resolution (). A series of projection images is taken with an electron microscope from a unique biological sample at different orientations around a single tilt axis. Tomographic reconstruction algorithms then combine those images so as to derive the 3D structure of the specimen. The number of images in the series usually ranges from 60 to 200. Due to the resolution needs, the image size generally ranges between 10241024 and 20482048 pixels, though 40964096 can now be used as well. Weighted Backprojection (WBP) is the standard reconstruction method. Iterative methods, such as Simultaneous Iterative Reconstruction Technique (SIRT), exhibit better performance in ET (). However, they demand much longer processing time, which has prevented their extensive use so far. The complexity of the algorithms along with the data size turns 3D reconstruction into a computational intensive problem. Traditionally, high performance computing has been used to cope with the demands in ET (). Recently, the use of graphics processor units (GPUs) has revolutionized the field as they provide exceptional performance-to-cost ratio (), though a relatively specific * To whom correspondence should be addressed. hardware component, the GPU, is still necessary. Current standalone computers present tremendous power, thanks to technological and architectural advances (), but they still have not been fully exploited in the field. We present a program, Tomo3D, that implements an approach to tomographic reconstruction based on the full use of the computational power within modern multicore computers. It takes advantage of the multiple cores and of the vector instructions within the cores, and also uses general code optimization techniques to make the most of the computers. The program significantly accelerates the 3D reconstruction methods WBP and SIRT, and even outperforms current GPU solutions. Furthermore, this program enables real-time tomography on standard multicore computers, without the need for clusters or GPUs.
IMPLEMENTATIONCurrent computers usually ship with one or more multicore processor chips, every one comprising several powerful cores (e.g. dual-2, quad-4, hexa-6). Moreover, the individual cores contain vector instructions, typically known as SIMD (Single Instruction, Multiple Data), which perform multiple computations with different data elements of the same kind simultaneously (). In particular, the SSE instructions (, present in all Intel and AMD processors, can perform four floating-point operations of the same type (addition, multiplication, etc) with their corresponding four pairs of operands. These features turn current computers into extremelly powerful platforms with two levels of parallelism available for the programmer: threads and SSE instructions to exploit cores and vector units within the cores, respectively. The 3D reconstruction problem in ET can be decomposed into a set of independent 2D reconstruction sub-problems corresponding to the slices perpendicular to the tilt axis. This has traditionally been the data decomposition used in ET for high-performance computing (). Each of the 2D slices of the volume can then be computed with any of the reconstruction methods, either WBP or SIRT but now working in 2D, from the corresponding set of 1D projections. The reconstruction of the independent slices can then be carried out in parallel. Tomo3D uses a multithreaded-vectorized approach to tomographic reconstruction (). It relies on the Single Program, Multiple Data (SPMD) paradigm whereby the different threads essentially execute the same task over different data. The program creates a number of threads, typically as many as cores in the computer, that run in parallel. The program keeps a pool with the slices to reconstruct, clustered in slabs of four slices. The slabs are asynchronously dispatched to the threads when these become idle. When a slab is alloted to a thread, its four slices are reconstructed simultaneously, thanks to the SSE instructions (). Once a thread finishes the reconstruction of the slab, it requests for another one. The fact that slabs are dispatched on demand provides an inherent load-balancing mechanism (), and makes Tomo3D flexible to adapt to situations where the computer is shared by several users/programs.Page: 583 582583Tomo3D has been implemented in C under Linux, using Pthreads and SSE intrinsics. Single-core code optimization techniques have also been used to better exploit the memory hierarchy and the internal processing units within the cores (). Memory consumption has been reduced to a minimum, only keeping a small subset of slabs and precomputed tables (e.g. cosines, etc.) used throughout the reconstruction process. I/O operations have been optimized to reduce disk latencies. Tomo3D is equipped with the two most common reconstruction methods in the field: WBP and SIRT. For the iterative method SIRT, a number of options are available: the positivity constraint that ensures that all the points in the reconstruction be positive, a weighting to compensate the 'long object effect' () and the possibility of resuming a reconstruction with more iterations. Tomo3D reads tilt-series and writes the output tomograms in MRC format and is fully compatible with standard ET packages (e.g. IMOD). Tomo3D is provided as a stand-alone, download-and-go, program that does not require any special hardware or software library in the system, which makes it especially attractive for structural biology laboratories. The program is freely available for predominant processing plaftorms and can be built for other platforms on request to authors.
Fast tomographic reconstruction on multicore computers
ILLUSTRATIVE PERFORMANCE TESTINGTo illustrate the performance of Tomo3D in typical structural studies by ET, we used tilt-series of 70 and 140 images of sizes 10241024 and 20482048 to yield volumes of 10241024256 and 20482048256. The computation was carried out on a state-of-the-art server with two quadcore processors Intel Xeon E5405 at 2.0 GHz and on a standard desktop computer with a quad-core processor Intel Core 2 Q9550 at 2.83 GHz under Linux. Both reconstruction methods, WBP and SIRT (30 iterations) were tested. The experiments were carried out using eight threads on the server (denoted by 8T) and four threads on the desktop computer (denoted by 4T). For comparison, the reconstructions were also computed using the standard package in the field (see Supplementary Data).shows the processing times required by Tomo3D for the different experiments as well as the average speedup factors (based upon the time required by a single core with no use of vector instructions). As far as the processing time is concerned, Tomo3D succeeds in yielding full resolution reconstructions with WBP in the order of seconds (327 s and 216 s with 4 or 8 cores, respectively), which enables it for real-time ET (). Even more interestingly, Tomo3D is able to provide iterative reconstructions in just a few minutes (323 min and 216 min, respectively). Finally, Tomo3D was compared to the most advanced GPU solution in the field. A reconstruction of 14242024591 was computed from 61 images of
CONCLUSIONThe multithreaded-vectorized approach to tomographic reconstruction in Tomo3D allows computation of full resolution tomograms at high speed on standard computers. There are no special system requirements to run the program and, furthermore, it is fully compatible with standard packages in the field. All these are the major contributions of Tomo3D from the user's point of view. The good performance of Tomo3D stems from the full exploitation of the computing power latent in modern multicore computers. The processing time required by the methods implemented in Tomo3D, WBP and SIRT, turns out to be competitive with GPUs.
The Author 2010. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oup.com at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
W B P 4 T 8 T 4 T 8 T 4 T 8 T
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
