In the last years there has been an increasing effort to computationally model and predict the influence of regulators (transcription factors, miRNAs) on gene expression. Here we introduce biRte as a computationally attractive approach combining Bayesian inference of regulator activities with network reverse engineering. biRte integrates target gene predictions with different omics data entities (e.g. miRNA and mRNA data) into a joint probabilistic framework. The utility of our method is tested in extensive simulation studies and demonstrated with applications from prostate cancer and Escherichia coli growth control. The resulting regulatory networks generally show a good agreement with the biological literature. Availability and implementation: biRte is available on Bioconductor
IntroductionGene regulation is one of the most important biological processes in the living cell. Its malfunctioning is directly associated with many human diseases. Transcription factors (TFs) are one of the most relevant drivers of mRNA expression. In addition, miRNAs can degrade or inhibit translation of target mRNAs on the post-transcriptional level. Thus both, TFs and miRNAs, influence mRNA concentration jointly together in complex networks. Based on existing TF and miRNA target gene prediction methods during the last years there has been an increasing effort to computationally model regulatory networks and draw conclusions about context specific regulator activities ().also considered statistical interactions between regulators, which they depicted as networks. In our earlier publication we devised BIRTA as a method, which combines miRNA and mRNA expression data into a joint probabilistic model to infer condition specific activities of TFs and miRNAs (). BIRTA is formulated in a Bayesian regression framework and uses a so-called spike and slab prior () to infer probabilities of activation for transcription factors and miRNAs in a sparse manner. BIRTA does not support statistical interactions between regulators. Independent of the question to predict context specific regulator activities, structure learning of gene regulatory networks directly from expression data has been widely studied (). In this article, we introduce biRte as a combined approach to estimate context specific regulator activities and networks between these regulators. biRte first uses a significant improvement of BIRTA to infer activities of regulators and their statistical interactions from expression data and target gene predictions. A key difference to BIRTA is a computationally efficient analytical marginalization of regression coefficients, which yields far better prediction performance and 1015 fold less computation time. After estimation of active regulators, biRte employs Nested Effects Model (NEM) () structure learning to infer the associated transcriptional network. A key difference to many existing methods at this point is that our approach does not rely on direct mRNA measurements of regulators, but employs information of differential expression of downstream target genes. V C The Author 2015. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com
Overview about biRteThe minimum input to biRte consists of (differential) gene expression data together with a genome-wide regulator-target gene network. Based on that biRte addresses two goals (1. Estimation, which regulators (miRNAs, TFs and possibly other factors) exhibit a significant influence on the expression of their target genes in a specific biological context. We call a regulator active, if such a significant influence is present and inactive otherwise. biRte also supports the inference of statistical twoway interactions between regulators. 2. Estimation of the network between active regulators based on observed nested subsets of differentially expressed target genes.Besides gene expression data biRte can make use of direct regulator measurements (e.g. miRNA expression), if available. Gene expression data of transcription factors is treated specially: differential expression of these factors may indicate positive evidence that the respective regulator has a different activity in one compared to another experimental condition. This positive evidence can be exploited in the integrated likelihood model of biRte.3 BiRte step I: estimation of active regulators
Likelihood model for data integrationIn order to estimate the active influence of regulators on gene expression a sufficient likelihood model is required. The basic intuition behind our likelihood model is two-fold: @BULLET If the set of active regulators is already known, then mRNA expression can be predicted from regulator activities via a sparse linear model. @BULLET We do not assume a direct correlation between the expression level of regulators and mRNA. However, we suppose that in case a regulator is active in one and inactive in another condition, then there should be an observable shift of the expression level of the regulator itself. In other words, differential regulator expression increases the likelihood to obtain differential activity between two conditions. Let n mRNA be the set of all measured mRNAs. With biRte we assume that these mRNAs have been measured in C conditions (in our software C 2) with R mRNA replicates. Let O be the set of all resulting mRNA expression levels (after appropriate normalization and transformation of data). Let A denote the set of all miRNA expression levels with R miRNA being the respective number of replicates per condition. Possibly further available TF expression data is denoted by T and other data (e.g. CNVs) by Z. The notation for the number of measured molecular entities and replicates is done in consistency with the previously introduced notation for mRNAs and miRNAs. In our model we distinguish between hidden regulator states (active vs. inactive) and observable measurements. We denote the set of all available experimental data as D here. Given the set of active regulators R  fR 1 ; R 2 ; :::; R C g in each experimental condition (c  1; 2; :::; C) (which is equivalent to knowing the hidden variables) together with further model parameters H we decompose the likelihood of D as: L D;H R  pDjR; H  Y ^ D2fO;A;T;Zg p ^ DjR; Hwhere ^ D irc is the ith feature and the rth replicate measured under condition c in data type ^ D. This formulation is slightly more general than the one used in. It allows for including further data types (Z) and captures the situation that relative expression (log fold changes) are measured. In this case C  R ^ D c  1. Using relative expression data allows to apply biRte to arbitrary complex statistical designs. Let T A denote the target genes of regulator A. Two-way interactions between regulators A, B can be formally introduced as additional regulators A : B that only target genes lying within T A \ T B. Since the number of potential two-way interactions scales quadratically with the number of regulators, in practice we only consider A : B, if jT A\T Bj jT A[T Bj lies within a defined range (default: 0.1 to 0.8). Next we specify, how the data specific (marginal) likelihoods p ^ D irc jR c ; H are computed.
Marginal likelihood for mRNA expressionIn agreement with our previous paper each observed mRNA measurement is assumed to be determined by the set of active regulators:were R cj denotes the set of active regulators of gene j. The equation can be interpreted as a linear regression with coefficients x qc and intercept x 0c. The formulation assumes a constant noise variance for all genes, which can be achieved after appropriate scaling of the data. In contrast to our previous paper () regression coefficients in biRte are not sampled, but marginalized out analytically: Let p : jR c j and x c : x 0c ; x 1c ; :::; x p . Let o be the vector of expression values for a particular replicate r under condition c. Then EojX p ; x c   X p x c , where X p is a n mRNA  p  1 design matrix (the first column is constantly 1 for the intercept). Using conjugate priors $ IGa 0 ; b 0  and x c j 2 $ N0; 2 k 1 ) the marginal distribution pojR c   pojX p  (also called model evidence) can be written down in closed form (Let n : detX T p X p  kI. Then the log marginal likelihood is given as: log pojX p  /  1 2 log n  a 0 log b 0  a n log b n  log Ca n   log Ca 0 We thus have to efficiently compute the determinant n and the matrix inverse of C p : X T p X p  kI) in order to make the approach practically feasible. Here we address this problem via a Cholesky decomposition C p  R T R, where R is an upper triangular matrix:Since log n  2 X i logjR ii j Cholesky factorization allows to efficiently calculate the log determinant. Moreover,Note that inversion of the triangular matrix R can be done quickly via back-fitting.
Marginal likelihood for miRNA expression and other experimental dataLet us assume C  2, wherewithout loss of generalizationc  1 denotes a reference condition. We distinguish two situations: In one miRNA i has switched its activity between c  1 and c  2. In that case we use two Gaussian distributions to model expression levels. In the other case miRNA i has not switched, and we use only one Gaussian distribution. The resulting one-way ANOVA model is thuswhere c i0 and c i are parameters, which describe the mean expression and log fold change of miRNA i, respectively. The equation should be interpreted in a probabilistic sense: If a miRNA is differentially expressed, then the chance increases that it also exhibits a measurable influence on its target genes. Vice versa non-differential expression lowers that chance. If we assume r 2 i $ IGa; b, the marginal likelihood pA irc jR c   pA Airc jX p  can be calculated in analytical form:where C is the gamma function and l ic  c i0  c i , if the first condition in Equation (9) holds and c i0 , otherwise. Although this marginal likelihood has been already derived init is not used in BIRTA. The same strategy as described here for miRNAs can be applied to experimental data of other regulatory factors, if available. More specifically, one may use mRNA data of differentially expressed TFs to support evidence for their conditions specific activity on protein level. The idea is that differential gene expression of a TF increases the chance that there is a measurable difference in the influence on target genes, while the opposite can generally not assumed to be true. Accordingly, for TFs we define a model following Equation (10) for differentially expressed TFs only.
Bayesian variable selectionIn order to allow for variable selection we need to make our model sparse. There exists a large amount of literature on Bayesian variable selection methods. One possibility that we also followed in our previous BIRTA model is the spike and slab prior ():where d 0 denotes a point mass at 0, p cp $ Bernoulliq cp p  1; :::; N and k 1 is large. N is the total number of possibly active regulators. One advantage of the spike and slab prior compared to a lasso type prior is a selective shrinkage of model coefficients. That means model coefficients for selected variables are only mildly pushed towards zero and thus estimates are less biased compared to a lasso prior (Hernandez-Lobato et al., 2010). Another advantage of the spike and slab prior is that sparsity can be controlled in a variable dependent manner via parameters q cp. Here prior knowledge can be integrated: For each regulator we can encode the prior belief that it is active.
Model fitting via MCMC
General ideaIn Section 3.2 we showed that regression coefficients can be effectively marginalized out while estimating model evidence. In biRte we are thus left with estimating the condition specific hidden state variables p c : p cp  p1:::N. For that purpose we use a stochastic sampling scheme based on Markov Chain Monte Carlo (MCMC). More specifically, we define two possible move types: @BULLET switch: a regulator switches from active to inactive state within randomly picked condition c @BULLET swap: an inactive regulator and an active regulator exchange their activity states within randomly picked condition c. In practice we restrict swap operations to regulators showing a significant overlap of regulated targets. We formally accept an MCMC move with probabilitywhere p new c and p old c correspond to the old and new miRNA and TF state configurations, respectively, and X is the full n mRNA  N  1 design matrix. Please note that inclusion of the proposal distribution q is necessary, because the swap operation induces non identical probabilities to reach p old c from p new c and vice versa. In conclusion the MCMC algorithm allows for estimating for each regulator and condition the posterior probability to influence the expression of its target genes.
Efficient update of marginal likelihoodOne of the major differences of biRte vs. BIRTA is the analytical marginalization of regression coefficients in Equation (3). This in turn requires updates of the design matrix X and the determinant n after each MCMC move. To make these updates computationally feasible we can exploit the fact that only the design matrix X p restricted to active regulators needs to be updated. When a switch or swap operation is performed a column in X p is added, removed or exchanged. Let X 0 p denote our updated design matrix, then the difference in the marginal log likelihood for mRNA data is given by:log n  log n 0   a n log b n  log b 0 n  (13)Based on Section 3.2 it is sufficient to update the Cholesky factor R of C p  X T p X p  kI in order to compute this formula efficiently: Suppose we add a column v to X p , i.e. X 0 p  X p1  X p ; v. We are interested in the updated Cholesky factor R 0. Note thatAccording to the Schur complement and block-wise matrix inversion lemmas we can decompose X 0 T X 0  kI 1 as:Hence, R 0 1 can be updated efficiently according to the block-wise matrix decomposition indicated in the third line, and R 0 is computed from R 0 1 via back-fitting. If the last column is deleted in X p , the whole procedure has just to be done in reverse order. However, if an arbitrary column 1 ' < p is removed, one would have to re-triangulate R 0 , e.g. via Householder reflections. This is, however, computationally not beneficial compared to just re-calculating the Cholesky decomposition of matrix C 0 p after removal of column ' and row '.
Posterior inferenceInference about active regulators based on MCMC samples can be done in different ways. One method is to return the configuration with highest posterior probability among all sampled ones. Another possibility is to look at the marginal selection frequencies during sampling and filter those above a defined cutoff s. The arising question is, how such a cutoff could be chosen. We here implemented a method that we recently proposed in the context of Bayesian Network learning (Fr hlich and). Briefly the idea is to fit a beta mixture model to the observed regulator frequency profile. Based on this mixture model it is possible to select s such that the expected false positive detection rate is below a defined cutoff (e.g. 0.1%).
Hyperparameter settingsOur model contains a few hyper-parameters that need to be specified. These include parameters for the variance priors (a; b; a 0 ; b 0 ), which biRte estimates in an empirical Bayes sense via maximum likelihood from the global distribution of empirical variances (separately for each data type). The method is taken from Venables and Ripley (2002) and implemented in the R-package MASS. Following () we set k  1 in the spike and slab prior. Moreover, c i0 is set to the average expression level in the reference condition, and c i to the median log fold change of differentially expressed regulators (separately for each regulator type and for up-and down-regulation). This procedure was chosen in order to reduce false positive predictions of regulator activities.
BiRte step II: network inferenceAfter having determined active regulators one may ask, in which way these regulators influence each other. Established methods, such as Bayesian Networks, would usually require direct measurements of regulators, which are at least difficult to obtain for TFs. Moreover, the typically small sample size imposes a principal limitation. In biRte we thus restrict ourselves to subset relationships between differentially expressed target genes. These subset relationships can express biologically interesting properties: Suppose regulator A to act upstream of regulator B. There is a certain subset set of target genes E A , which is only affected by A. However, because A is upstream of B, A also influences target genes E B of B (). This might happen, because A activates or deactivates B on protein level and only B itself influences E B. Another possible mechanism is that A and B together modulate expression of E B in a combinatorial fashion. Both mechanisms are not distinguishable without further experiments and thus the schema incomprises both of these situations. Our task is to infer the correct wiring of the network from observable differential expression of target genes as well as target gene predictions for individual regulators. The whole idea has striking similarities to Nested Effects Models (NEMs) (e.g.), which have been introduced for causal network inference from perturbation data. Although in our case we do not have targeted perturbations of individual regulators, probabilistic inference of subset relationships between differentially expressed targets of regulator pairs can be done effectively via existing NEM structure learning algorithms. For the sake of simplicity we here explain the idea of the pairwise NEM inference algorithm discussed in: Let n  jE A j  jE B j and E 2 f0; 1g n2. We set E ik  1, if gene i is differentially expressed and a predicted target of regulator k, otherwise E ik  0. Let us further assume we know certain type I and type II error rates a, b that occur while declaring differential gene expression. Let H be one of the four possible hypotheses fA ! B; A B; A $ B; A::Bg, where A::B means no edge / subset relationship. In order to score H we are interested in the marginal likelihood of our observations E:where h i is a parameter that indicates whether E i is attached to regulator j. In Equation (15) we marginalize over all possible attachment positions, possibly weighted by a prior (which is set uniform in the default case). While doing so we consider an additional dummy node null which is unconnected to A, B. This trick allows for effective removal of target genes that react unspecifically (). The local likelihoods PE ik jH; h i  j are defined as:PE ik  1jH; h i  j  1  b if edge k ! j exists a otherwise (
SoftwarebiRte is available as a Bioconductor R-package. To ease the analysis of relative expression levels the software offers appropriate interface functions to limma () and thus allows to be applied for arbitrary complex statistical designs. Since biRte relies on the assumption of multivariate normally distributed data we recommend the limma-voom mechanism for RNA-seq data (). Notably biRte optionally allows for grouping regulators with highly similar target gene sets (being unlikely to be distinguishable) into clusters in a pre-processing step (see details in Supplements). In the subsequent network analysis clusters are automatically decomposed into individual regulators.
Simulation results
Active regulators and regulator interactionsIn order to gain insights into the principal behavior of our model we conducted several simulations. In a first simulation study we compared biRte to our previous BIRTA method (), to GEMULA () as well as to a hypergeometric test () with multiple testing correction via the method by. This was done on the basis of a human regulatory sub-network and accordingly simulated expression data of 900 target genes (details in Supplements). In order to have a fair comparison we here applied GEMULA, biRte and the hypergeometric test such that they used the same set of potentially relevant two-way interaction terms (see Supplements). BIRTA does not support inference of regulator-regulator interactions. Supplementary Figures S1S10 depict the quality of regulator activity predictions for different fractions of false positive and false negative target gene predictions, i.e. erroneous edges in our regulatory network. Results are shown for 20 simulation repeats in terms of partial area under ROC curve (for a specificity cutoff of 90%) and Brier scores (i.e. average squared differences between probabilistic predictions and indicators of true regulator activities). Overall the results indicate a significant improvement of biRte compared to all competing methods. For miRNAs pAUCs are typically close to 1 and Brier scores close to 0, even for the highest levels of false positives and negatives. TF predictions react more sensitive, because TFs typically have fewer target genes than miRNAs in our network. As expected, prediction of regulator-regulator interactions is most challenging for all compared methods. We observed 1015 fold speed-up of biRte compared to BIRTA and GEMULA (Supplementary).
Network inferenceIn a second round of simulations we compared the network reconstruction used in our biRte approach to Bayesian Networks (BN) (), ARACNE (), GENIE3 (Huynh) and GeneNet (Opgen-Rhein and) on 10 randomly selected regulatory sub-networks of Escherichia coli and 20 correspondingly simulated datasets per network (details in Supplements). For BN structure learning a greedy hill climber using the BGe score was employed. For BN as well as for ARACNE we investigated additionally the effect of a data discretization into three 3 bins using the information theoretic approach by Hartemink (2001). Accordingly, for BN the BDe was used to score candidate networks for discretized data. For biRte the assumed type I and type II error rates for differential expression detection were fixed to 0.05 and 0.1, respectively. GENIE3 returns an edge weight matrix. We transformed these edge weights into z-scores and then selected all edges with P < 0.1. For GeneNet we returned all edges (ignoring directions) with FDR < 10%. Accordingly, GeneNet here only detects the existence of an edge, regardless of direction. This was appropriately taken into account while counting false positive predictions, when comparing the inferred network against the true one. Likewise, for BNs the CPDAG and for biRte the transitive closure of the original network was considered as reference. That means a predicted edge was only counted as false positive, if it was not contained into the respective equivalence class of the true network. We conducted our comparison for different fractions of false positive and false negative target genes (Supplementary Figs S13 S16), number of replicates r (Supplementary Figs S13 and S17S19), total number of downstream targets m (Supplementary Figs S13, S20 and S21) as well as number of network nodes n (Supplementary Figs S13 and S22S24). For n > 15 nodes ARACNE and BN on discretized data became infeasible slow, so they had to be omitted. The boxplots in all cases show a clear advantage of biRte's network reconstruction, which uses subset relationships between differentially expressed target genes. The computation time varied between less than 1 second (15 nodes, Supplementary) and 30 seconds (60 nodes, Supplementary), which makes the approach practically highly feasible. biRte showed a highly robust behavior against false positive and false negative target gene predictions, given a sufficient amount of target genes. Sensitivities and specificities stayed in all cases close to 1. As expected, increasing the number of replicates from 5 to 10, 20 and 30 yielded a small improvement of all competing methods, because they directly use expression data of regulators. Decreasing the number m of total target genes from 450 to 150 on average led to a decrease of sensitivity to around 80% for biRte, but in single cases (e.g. network 4) the effect was stronger. Increasing the number n of network nodes from 15 to 30, 40 and 60 lead to a decrease of sensitivity for all methods. However, even for n  60 biRte with 5 replicates still achieved a sensitivity of around 60% at a specificity close to 1.
E.coli growth conditionsWe investigated a microarray dataset bytogether with a filtered TF-target graph (). The gene expression data comprises three replicates from E.coli during aerobic growth and four replicates during anaerobic growth. The TFtarget graph contains annotations for 160 transcription factors. The data are also contained in the vignette of the biRte R package. Potential two-way interaction terms between regulators were selected such that the overlap of target genes was between 10 and 80%. Limma analysis yielded 224 differentially expressed genes (FDR<5%, jlog FCj> 1). Moreover, 9 TFs showed differential expression on mRNA level. For these 9 TFs we set a prior activation probability of 50%, whereas for the others a uniform prior was used. We conducted a biRte analysis with a burn-in and sampling phase of 20 000 iterations. The calculation took around 2 min on a 2.5 GHz AMD Opteron 6380 machine. Convergence can be checked according to the trace plot of the marginal log-likelihood (Supplementary). Active regulators were selected according to their marginal selection probability (cutoff: expected FPR < 0.001). Application of biRte's network inference to all active regulators resulted in a network of 28 unique regulators (), which have all at least one differentially expressed target gene. The network consists of one connected component with 25 regulators and three singletons. The master regulator of the connected network component, fumarate and nitrate reductase (fnr), is well known to be essential for the switch from aerobic to anaerobic metabolism (). Fnr regulates arcA in anaerobic conditions () and has an effect on the narX/narL system (), as also reflected by our network. Furthermore, arcA represses betI under anaerobic growth conditions (). The activity of gadE, gadX, gadW, appY, fhlA and marA under anaerobic growth conditions have also been described previously (). Likewise, ompR, iscR, soxS, iclR and dnaA activities have been associated to aerobic growth and oxidative stress (). The TF crp (cAMP receptor protein) regulates several TFs in our inferred network. It is known to regulate more than 100 genes involved in energy metabolism (). The singleton argP is an arginine and lysine responsive transcriptional regulator. It competes with dnaA for iteron binding (). When comparing the estimated against the original, literature based TF-target gene network, direct TF-TF interactions could explain the edges fnr ! arcA; gadE ! gadX; crp ! galS; crp ! fur; arcA ! betI as well as fnr ! soxS; fnr ! pdhR, fnr ! narL; fnr ! gadX, fnr ! gadW; fnr ! fhlA, crp ! pdhR; crp ! gadX, crp ! gadE; arcA ! gadX, arcA ! gadE. Several of these edges are contained in the equivalence class of our estimated network (which is transitively closed), but removed for better visualization purposes in.). For the following analysis we restricted ourselves to the set of 44 normal and 47 cancer samples that were matching between mRNA and miRNA data. These data were mapped to a human regulatory network (see Supplements). Only regulators targeting more than 5 probesets were considered. Potential two-way interaction terms between regulators were selected such that the overlap of target probesets was between 25 and 50%. This was done in order to ensure significant effects that were clearly distinguishable from main effects of regulators. Limma analysis yielded 262 differentially expressed probesets and 134 differentially expressed, network map-able miRNAs (FDR < 5%, |log FC|> 1). Moreover, on mRNA level there were four differentially expressed, network map-able TFs. Differentially expressed miRNAs were given a prior activation probability of 80%, and for differentially expressed TFs we set this number to 50%, TF expression is expected to be less indicative of TF protein activity. All other regulators were given a uniform prior probability per respective regulator class (TF, miRNA, interactions). We ran biRte with 1 000 000 iterations with an additional burnin phase of 1 000 000 iterations. The whole calculation took around 16.2 hours. Convergence can be checked according to the trace plot of the marginal log-likelihood (Supplementary). Active regulators were selected according to their marginal selection probability (cutoff: FDR < 0.001). We applied biRte's network inference to all active regulators, resulting in a hierarchical network structure (). All 26 regulators in this network have all at least one differentially expressed target gene. Several are known to be involved in cancer and prostate cancer specifically: For example, HLTF encodes a member of the SWI/SNF family. Members of this family have helicase and ATPase activities and are thought to regulate transcription of certain genes by altering the chromatin structure around those genes. They have been associated to cancer progression (). EP300 encodes the adenovirus E1A-associated cellular p300 transcriptional co-activator protein. It functions as histone acetyltransferase that regulates transcription via chromatin remodeling and is important in the processes of cell proliferation and differentiation. Several studies suggest EP300 to play a role in the development of prostate cancer (). ATF4 is a member of the activating TF family and discussed as a cancer drug target (). E2F1 is a member of the E2F family and plays a crucial role in the control of cell cycle and action of tumor suppressor proteins. It has been associated to prostate cancer (). FOXC1 belongs to the forkhead box TF family. These TFs play important roles in the regulation of tissue-and cell type-specific gene transcription and have been associated to prostate cancer (). Comparison of the network against the BioGRID database () could verify the edges EP300 ! TAL1; ATF4
Prostate cancer
ConclusionbiRte combines inference of regulator activities with network reverse engineering. For inference of regulator activities we rely on an extension of our previous BIRTA method (). The most significant difference is the analytical and computationally efficient marginalization of regression coefficients, which results in 1015 fold faster computation time. Furthermore, our simulations indicate that biRte not only outperforms BIRTA, but also a hypergeometric test () and the lasso based GEMULA () with respect to prediction of active regulators and regulator-regulator interactions. biRte performs post-hoc inference of networks between active regulators via NEM structure learning, which infers subset relationships of differentially expressed target genes. According to our simulations the approach yields far more reliable network reconstructions than typical methods that use observational expression data of regulators. Application of biRte to a gene expression data measuring response to different growth conditions in E.coli as well as to a combined mRNA and miRNA dataset from prostate cancer patients demonstrated the principal agreement with the biological literature. We thus think that biRte could be a useful contribution to decipher biological context specific regulatory networks. Conflict of Interest: none declared.
at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
H.Fr hlich at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
