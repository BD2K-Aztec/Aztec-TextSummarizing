Genome-wide association studies are an invaluable tool for identifying genotypic loci linked with agriculturally important traits or certain diseases. The signal on which such studies rely upon can, however, be obscured by population stratification making it necessary to account for it in some way. Population stratification is dependent on when admixture happened and thus can occur at various levels. To aid in its inference at the genome level, we recently introduced PSIKO, and comparison with leading methods indicates that it has attractive properties. However, until now, it could not be used for local ancestry inference which is preferable in cases of recent admix-ture as the genome level tends to be too coarse to properly account for processes acting on small segments of a genome. To also bring the powerful ideas underpinning PSIKO to bear in such studies, we extended it to PSIKO2, which we introduce here. Availability and implementation: Source code, binaries and user manual are freely available at https://www.uea.ac.uk/computing/psiko.
IntroductionA major confounding factor in genome-wide association studies (GWAS) is population stratification, that is reproductive isolation of a sampled population. A powerful way to account for it is to assume that the genotype of each individual [generally called an accession and represented in terms of a single-nucleotide polymorphism (SNP) sequence] in a study is an admixture of genotypes of K2 (generally unknown) founder (populations). This admixture can then be expressed in terms of a dataset's principal components (PCs) or its population stratification matrix (i.e. its Q-matrix), which indicates for each accession of a study the proportion of its genotype that came from each of the K founders. Contrary to leading tools such as EIGENSTRAT (), which only infers a dataset's PCs and STRUCTURE () (and its extension to FASTSTRUCTURE ()), ADMIXTURE () and SNMF (), which only infer a dataset's Q-matrix, PSIKO () is able to infer both. Furthermore, comparison of PSIKO against competing methods suggests that while the quality of its Q-matrices is on par with those generated by them, PSIKO has better scaling properties. However, until now, PSIKO could not be used for local ancestry inference (LAI), which is important for applications ranging from human population studies to identification of disease causative loci (). Furthermore, it could only be used on a LINUX platform, and the efficiency of its principle component analysis (PCA) step was not benchmarked. PSIKO2 addresses these shortcomings.
Features
PCs and number K of founders of a datasetTo obtain a dataset's PCs and thus estimates for its K, we perform a PCA analysis. Rather than using standard PCA, we employ linearkernel PCA (see e.g. Murphy 2012) due to its good scaling properties in terms of the number of variables (SNPs in our case).
Q-matrix inferenceThe Q-matrix for the PCA-reduced dataset is returned as Q-matrix for a given dataset. To obtain that matrix, we combine properties of PCA relating to simplices observed in e.g. Ma and Amos (2012) and Patterson et al. (2006) with an iterative least squares approach.
Local ancestry inferenceCombining a sliding window approach with information about founder genotypes allows us to map, for each individual of a dataset, each such window to one of the K founders. The window size can be chosen by the user, and the mapping is closely related to PCADMIX's (). Contrary to PCADMIX which requires information about founder genotypes as input and thus cannot be used in its absence, this input is optional for PSIKO2. For datasets where this information is not available, we infer it from the estimate of its Q-matrix (see Supplementary Material for details).
Implementation and usageReleased under a GPL license, PSIKO2 is command line based and takes as input a genotype matrix in the form of the widely used .geno file format (). It is written in C++ and comes with directly linked binary executable files that should work on all modern Linux platforms/Mac environments. Alternatively, the user may compile the program himself if all required libraries are present on their system (see user manual for details). Its output can be used to inform a study in terms of a dataset's local ancestry, PCs, K and Q-matrix [which can then be graphically represented in terms of a barplot using R (R Core)] or as input to approaches such as STRUCTURE (in the form of e.g. a starting point for estimation of that number) or packages for association mapping such as TASSEL (), BOLT-LMM () and FASTLMM ().
Testing and performance measureTo ensure the correctness of PSIKO2's predecessor regarding K and Q-matrix estimation, we rigorously tested it in Popescu et al. (2014) on both real biological and simulated data. This testing did not include scrutinizing the efficiency of our implementation of linearkernel PCA. We rectify this here by comparing PSIKO2 against an implementation of that strategy in the freely available SKLEARN software (). Furthermore, to better understand
at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
PSIKO2's performance with respect to LAI, we used an approach similar to the one described in Brisbin et al. (2012) to compare it against PCADMIX. See Supplementary Material for details for both. 4.1 Linear-kernel PCA Key to PSIKO's impressive performance (see Popescu et al. 2014) with respect to large (in the number of SNPs) datasets common with NGS data is a compact representation of genotype data. One of the reasons for this is owing to the fact that SNPs can only attain one of three possible values (i.e. 0, 1 or 2) allowing PSIKO to efficiently store them using a bitwise implementation. In the context of linear-kernel PCA, this also allows for quick dot product computation which PSIKO requires for finding a dataset's PCs (see Supplementary Material). Using the R 2 correlation coefficient between the PCA-reduced datasets generated by the two kernel-PCA methods [where we obtained the input datasets as described by Popescu et al. (2014)] as assessment measure, we found R 2 to be larger that 0.999 for all simulated datasets indicating that both methods produce, to all extends and purposes, identical output with differences attributable to floating point arithmetic precision errors. However, PSIKO's runtime was a fraction of that of SKLEARN (Table 1), with SKLEARN running out of memory for sequences of length 2.5M. 4.2 LAI algorithm To assess PSIKO2's suitability for LAI, we used simulated datasets which we generated by combining the dataset provided by PCADMIX with the methodology described by Brisbin et al. (2012). We considered two main scenarios. In the first, we provided PSIKO2 with founder (genotypes), and thus our results are directly comparable with those reported for PCADMIX in (Brisbin et al., 2012). In the second, we withheld that information rendering PCADMIX inapplicable as it requires that information as input. Using the Q-matrix estimated by PSIKO2 and taking as proxy for the dataset's founders all accessions which had more than 91% of their genome originating from the same population, this dataset did not pose a problem for PSIKO2. In both cases, the performance of PSIKO2 was notable with it correctly reporting, within less than a second, the ancestry of 91.2%/ 91.1% (first/second scenario) of the loci under consideration for the input dataset. This is of the same quality as the results that PCADMIX obtained for a dataset with similarly diverged founders. In summary, we believe PSIKO2 to hold great promise for population stratification correction on various genomic levels.
Alexander,D.H. et al. (2009) Fast model-based estimation of ancestry in unrelated individuals. Genome Res., 19, 16551664. Bradbury,P.J. et al. (2007) Tassel: software for association mapping of complex traits in diverse samples. Bioinformatics, 23, 26332635. Brisbin,A. et al. (2012) PCAdmix: principal components-based assignment of ancestry along each chromosome in individuals with admixed ancestry from two or more populations. Hum. Biol., 84, 343.
