Motivation: Genome-wide association (GWA) studies have proven to be a successful approach for helping unravel the genetic basis of complex genetic diseases. However, the identified associations are not well suited for disease prediction, and only a modest portion of the heritability can be explained for most diseases, such as Type 2 diabetes or Crohn's disease. This may partly be due to the low power of standard statistical approaches to detect gene–gene and gene– environment interactions when small marginal effects are present. A promising alternative is Random Forests, which have already been successfully applied in candidate gene analyses. Important single nucleotide polymorphisms are detected by permutation importance measures. To this day, the application to GWA data was highly cumbersome with existing implementations because of the high computational burden. Results: Here, we present the new freely available software package Random Jungle (RJ), which facilitates the rapid analysis of GWA data. The program yields valid results and computes up to 159 times faster than the fastest alternative implementation, while still maintaining all options of other programs. Specifically, it offers the different permutation importance measures available. It includes new options such as the backward elimination method. We illustrate the application of RJ to a GWA of Crohn's disease. The most important single nucleotide polymorphisms (SNPs) validate recent findings in the literature and reveal potential interactions. Availability: The RJ software package is freely available at
INTRODUCTIONGenome-wide association (GWA) studies have become a standard approach for helping unravel the genetic basis of complex genetic diseases. The recent successes are tremendous, and a series of new loci have been identified using single marker analyses (). Unfortunately, only a small portion of the * To whom correspondence should be addressed. heritability was explained by corresponding single nucleotide polymorphisms (SNPs) for most diseases such as Type 2 diabetes (6%) or Crohn's disease (20%) (). Furthermore, SNPs identified by GWA studies for various diseases make poor classifiers (). For overcoming such drawbacks and recognizing the complexity of the underlying biology, further mechanisms such as genegene interaction need to be taken into account (). However, the discovery of genegene interactions using GWA studies remains challenging with traditional statistical approaches (). Given genotype data at different loci, an exhaustive search of interactions between all loci is the obvious way of testing interactions. Testing all two-locus interactions is computationally feasible although time demanding (). However, an exhaustive search of higher order interactions is computationally impractical because the number of tests increases exponentially with the order of interaction (). One approach to deal with such large numbers of SNPs is to first perform univariate tests on each SNP, discard SNPs with high P-values and apply interaction methods, e.g. within logistic regressions, to SNP subsets afterwards (). Unfortunately, such approaches may result in low power for SNPSNP interactions with very small marginal effects. Another concern is genetic heterogeneity, i.e. different subsets of genes affect the same disease, and traditional statistical methods show limitations when genetic heterogeneity is present (). A promising alternative is Random Forests (). RF was applied successfully to genetic data in various studies (), and it is anticipated that RF will help to detect genegene interactions in genome-wide data (). It has been shown that RF can substantially be more efficient than standard statistical methods in ranking the true disease-associated SNPs in order to detect SNPSNP interaction (). The method is able to detect SNPs with small effects and to deal with genetic heterogeneity because separate models are automatically fit to subsets of data defined by early splits in the tree (). In addition, RF is able to handle SNPs that are associated in a non-linear fashion. The RF method is a specific data mining method. In data mining, in general, algorithms attempt to identify an unknown concept based on randomly chosen examples of the collected data. The aim is to find a prediction rule that correctly classifies new instances of the
On safari to Random Jungle: a fast implementation of Random Forestsconcept (). Thus, RF makes fewer assumptions about the functional form of the model, as required by statistical tests (). A grown tree in a forest is often graphically represented by an upside down tree. Multiple paths lead through the tree from the root to different leaves via various nodes. Each node corresponds to a specific predictor variable. Thus, a path is a sequence of predictor variables (for details, see Section 2.1 and). Such a predictor variable sequence includes potential interactions between them in terms of hierarchical dependencies (). Thus, the RF method allows for interactions between SNPs. RF yields a classification result and a measure of the importance for each variable. Variable importance (VI) quantifies the impact of a SNP in predicting the response and may reflect a causal effect. In turn, it can be used to select the relevant SNPs from a GWA study (). Although appealing, RF has rarely been applied on the genomewide level. In analogy to standard statistical approaches, this is due to the computational intensity and memory requirements (). The original RF implementation, termed RF in Fortran, bydesigned to analyze low-dimensional data, i.e. a low number of SNPs, with a large number of observations, e.g. 100 SNPs and 10 000 observations. It has been successfully used, e.g. byin a candidate gene casecontrol study involving 42 SNPs. However, it is computationally and memory inefficient so that not more than 10 000 of SNPs can be analyzed on a standard machine within reasonable time and memory usage (). Furthermore, the code is not user-friendly because the program has to be modified and compiled anew, whenever a new dataset is used. An alternative implementation is the randomForest package for the programming language R (R Development Core) by. It is user-friendly, and it has been often used in applications (). The source code of the package randomForest consists of R, C and Fortran source code. Elementary subroutines were left in Fortran code. However, the same computational and memory limitations apply as to RF in Fortran. One approach to overcome the memory issue is to split up the GWA data into small chunks, which are subsequently analyzed separately (). The results of all processed chunks are finally combined. Through this, main effects are detected, but one may fail to discover some important interaction effects due to data separation. Thus, these approaches do not overcome the restrictions in detecting complex interactions. An alternative has recently been presented by. In their package Willows, they compress the GWA data internally and subsequently apply RF. However, it is slow for large values of the mtry parameter (see Section 2) as recommended for datasets with many noise variables such as GWA study data (). Tuning mtry for optimizing the performance of the forest is also strongly recommended (), which can hardly be done with Willows. Using this program can be computationally intensive, thus time demanding. Here, a novel software package called Random Jungle (RJ) is presented, which has been specifically tailored for the large-scale analysis of GWA studies. This computational and memory efficient implementation of RF is able to analyze hundreds and thousands of samples and SNPs.In the following, we first briefly introduce the RF methodology, including the growing procedure and essential features. Next, we describe the estimation of various VI measures. Specifically, we show differences between importance scores of randomForest and RF in Fortran. After these theoretical considerations, we describe the RJ software and demonstrate its superior computational performance when compared with other implementations. Finally, we illustrate its use with data from a GWA study on Crohn's disease.
METHODS
Random forestsRFs is an ensemble consisting in multiple classification and regression trees (CART) that are grown using a bootstrap sample of given data and without pruning. In general, an ensemble is a group of classifiers in which the classifier is only required to perform slightly better than random guessing or coin flipping. This property is fulfilled by many base classifiers, such as CART (). With a CART as base classifier, a sample is classified by taking the majority vote over all tree classifiers in a forest (). RF has been shown to provide good accuracy, robustness to noise, internal estimation of error, stable classifiers and VI (). The RF procedure takes the following steps ():(1) Consider a dataset X, termed training data, consisting of one response variable and many predictor variables from N samples. The total count of predictor variables is M, with M being substantially larger than N.(2) A bootstrap sample X * consisting of N samples is drawn with replacement from the original training data X. On average, one-third of all samples are left out due to the bootstrapping process. These samples are called 'out-of-bag' (OOB) data X\X * .(3) A CART t is grown using the bootstrap dataset X * . The CART is constructed by recursively splitting data into distinct subsets, so that one parent node leads to two child nodes. For splitting data, an appropriate split rule has to be selected so that the subsets of each child node are purer than the subset of corresponding parent node. The goodness of the split is defined to be the decrease in impurity as follows: i = i parent (p left  i left +p right  i right ). The proportion of samples in left and right nodes is given by p left and p right , respectively. The measure of impurity i parent , i left and i right of parent node, left and right child node is determined by the Gini index, i.e. i = 1 j p(j) 2 , where is the proportion of samples that are labeled with class j in that node. At each node, a random subset of all predictor variables is chosen without replacement to determine the best split. The size of the subset is given by the parameter mtry. Although different variables might be selected at each node to be tested, the number mtry is held constant during the procedure, and the default setting is mtry =  M , where  denotes the next larger integer.(4) The tree t is grown to its largest extent, and no pruning proceeds. The final nodes are called terminal nodes.(5) Steps 1 to 4 are repeated to grow a specific number of trees, and, for classification, the majority vote over all trees in the resulting forest is used.(6) Finally, the OOB error fraction is calculated by classifying each sample of the OOB. Each observation is predicted by the trees for which it is an OOB observation. The prediction accuracy of the classifier is estimated by subtracting the OOB error fraction from its maximum, which is one. The prediction accuracy estimation method is a suitable surrogate for cross-validation (). A special feature of RF is the calculation of proximities between samples. For this, after a tree is grown, every subject is classified by each tree. Then, Page: 1754 17521758
D.F.Schwarz et al.each pair of subjects is compared with regard to its final stopping point. That is, if they are assigned to the same terminal node in a single tree of the forest, the proximity between them is increased by one. The proximity matrix is useful, e.g. for replacing missing data, imputing data, identifying outliers and finding class representative samples called prototypes. RF can be turned into an unsupervised learning method. To initialize the process, the original dataset is considered as Class 1. A new synthetic dataset of the same number of samples and predictor variables is created and labeled as Class 2. This synthetic data is created by sampling at random without replacement from the univariate distributions of the original data. The original and the synthetic data are merged. The resulting artificial twoclass dataset is analyzed by RF in order to produce sample proximities as described above. The 2D multidimensional scaling (MDS) technique () is subsequently applied to the proximity matrix. The method yields a 2D graphical representation of the underlying sample structure. To identify clusters in the sample structure, the graphical representation has to be investigated by standard clustering techniques, such as k-means clustering (). A further feature is the computation of sample margins. A sample margin is the difference of proportional votes for the correct class and maximum proportional votes of remainder classes. Sample margins are defined between 1 and 1. A high positive sample margin means a coherent and correct classification. The standard RF methodology can be extended by a flexible backward elimination procedure. The procedure identifies small sets of variables that can achieve good predictive performance. To select a small subset of variables, RFs are fitted iteratively. Specifically, at each iteration step a RF is grown and its importance (see Section 2.2) for classification is calculated. Variables that yield small VI scores are discarded subsequently. The elimination procedure is stopped when the number of remaining variables falls below a specific threshold or when the OOB accuracy is maximized (Diaz-Uriarte and Alvarez).
ImportanceAn essential standard feature of RF is that the importance of each predictor variable can be estimated. The RF approach serves two fundamentally different VI measures, the Gini importance and the permutation importance. The Gini importance of a predictor variable X i is the total decrease in impurity I = k i k. The Gini importance is obtained by adding up impurity decrease i k of all nodes in a forest, where the corresponding predictor variable was selected for splitting. The Gini importance has been shown to be biased when the number of categories differs between predictor variables (). Moreover, bootstrapping observations without a replacement yields a less biased VI (). Another VI is the unscaled permutation importance, which is the mean decrease of accuracy for a predictor variable. This VI is calculated as follows: first, the prediction accuracy A t is estimated for each tree t in forest T using OOB samples; second, the values of corresponding predictor variable are randomly permuted; third, prediction accuracy A * t is estimated using OOB samples again; and finally, the difference in accuracy, averaged over all trees in the forest, gives the unscaled permutation importance of the predictor variableThe scaled permutation importance, often called z-score, is calculated by dividing the mean decrease of accuracy by its standard error over all trees in the RFThe variance estimators differ between randomForest and RF in Fortran. As a result, both programs provide different scaled permutation importance scores. The estimator of randomForest is defined aswhere N OOB,t determines the number of samples in OOB of the current tree. The variance estimator of RF in Fortran is defined asVI measures as described above can show a bias of correlated predictor variables such as SNPs in linkage disequilibrium (). Permuting a predictor variable using the usual permutation scheme disrupts a potential dependency structure between the permuted variable and the other predictor variables. The disruption entails an inflation of the importance value of the predictor variable when predictors were associated with the outcome (). The conditional VI (CVI) is an approach to solve this problem (). For preserving the dependency structure between a specific predictor variable and other predictor variables, the predictor variable in question is permuted only within groups of observations. Group assignment is determined by analyzing the corresponding dependency structure as described in detail by. It has been shown that the CVI reflects the importance of predictors of correlated predictors more reliably than usual importance measures (). Therefore, the CVI should be applied to data that contain correlated predictor variables such as SNPs in linkage disequilibrium.
IMPLEMENTATION
Random jungleThe novel software package RJ implements all features of the reference implementation randomForest such as various tuning parameters, prediction of new datasets using previously grown forests, sample proximities and imputation. Commonly used VI measures are implemented, such as Gini importance, permutation importance and conditional importance measures. The features of RJ are shown in Supplementary Table 1. RJ additionally implements the variable backward elimination. When multiple CPU are available, RJ is able to perform RF on multiple CPUs simultaneously using multithreading and Message Passing Interface (MPI) parallelization. RF in Fortran and randomForest grow ensembles of a CART, but the RF method is not restricted to a CART. Therefore, RJ serves a generalized framework for tree growing, which can be utilized to extend the set of tree types. RJ also implements CART, but several tree types such as conditional trees () are currently under construction and will be added to RJ in the future. RJ is written in the C++ language, and the program structure fundamentally differs from the randomForest and RF in Fortran implementations. A comparison of importance scores, computing time and memory consumption across different implementations is given in Section 3.2. The software is freely available on www.randomjungle.org, where a detailed documentation of RJ can be found.
Comparison of importance valuesA simulation study was set up for comparing importance score ranks of RJ with the reference implementation randomForest. To this end, we used the simulated data for rheumatoid arthritis (RA) that were provided for the Genetic Analysis Workshop (GAW) 15
On safari to Random Jungle: a fast implementation of Random Forests(). Several loci contribute to the susceptibility, and nine major gene effects (Locus AH and Locus DR) and three key covariate effects (smoking, age and sex) were simulated. The first replicate of the genome-wide SNP dataset, RA affection status and gender was utilized for the purpose of comparison. To mimic a casecontrol study, one affected sibling per affected pair for the cases and one unaffected sibling per control family for the controls were randomly selected. The dataset for application comprises 1500 cases and 2000 controls genotyped at 9187 SNPs. Ranks of Gini and unscaled permutation importance scores were investigated by applying RJ and randomForest to a subset of the GAW15 data. The subset comprised three informative predictor variables, i.e. sex, Locus C/DR (SNP6_153) and Locus D (SNP6_162), and three uninformative predictor variables (SNP2_394, SNP3_481, SNP1_98) that were randomly selected out of the set of all uninformative predictor variables (). Each program was applied 500 times in order to capture the variation of importance ranks. Data was analyzed using default parameter settings of 500 trees and mtry =
Performance and application to Crohn's diseaseThe real dataset was used to compare the different implementations and to find potential interactions. The performance of RJ, randomForest, RF in Fortran and Willows was compared in terms of computing time and memory consumption of each software. RJ was run in two different modes, namely in a single CPU mode and in a 40-CPU mode using multithreading and MPI. All applications were performed on computers running the SUSE Linux operating system with a 2.33 GHz Intel dual quad-core processor (8 CPUs) and 16 GB memory. In the 40-CPU mode, five processes were distributed among five computers. Each process was performing on eight CPUs simultaneously using multithreading. The real dataset is from a Crohn's disease GWA study, which has been described previously in detail (). In brief, data of 513 Crohn's disease affected Caucasian cases and 515 Caucasian controls were analyzed. The samples were genotyped on the Illumina HumanHap300 Genotyping BeadChip (317 503 SNPs). The GWA study was funded by NIDDK IBD Genetics Consortium. Samples were visualized using MDS plots and outlying persons were excluded from MDS clusters by visual inspection of two experienced experts, resulting in 1006 persons (501 cases and 505 controls). Sex was the only covariate in the analysis in addition to the SNPs. SNPs with a call rate <0.98 per study group, a MAF <0.05 in the cases and controls combined or a P-value <0.0001 for deviation from HardyWeinberg expectations in control group were excluded, resulting in 275 153 SNPs. The RJ software can handle missing data, i.e. imputing internally and analyzing data subsequently, but it is advised to impute data using standard imputing tools (). Missing genotypes were imputed by the IMPUTE program () using default parameters. Imputation uncertainty cannot be taken into account. Each implementation performed a RF analysis using the default forest size of 500 trees. To optimize the performance of the forest, the parameter mtry was tuned as recommended (). The RF manual recommends choosing the mtry value that minimizes the OOB prediction error fraction. The parameter mtry was optimized by using several candidate values based on the formula mtry = M/20(1,...,19) is the number of predictor variables which are SNPs and sex. The results are shown in Supplementary Table 2. The minimal OOB prediction error was obtained for mtry = 247 638. For investigating the genetic relevance of SNPs and their interactions, data analysis was performed by RJ using 100 000 trees in forest. The parameter mtry was optimized for 100 000 trees by comparing different values shown in Supplementary Table 2. The optimal mtry was found to be 27 515. The CVI was calculated for each SNP. For comparing results with a standard univariate method, the 275 153 SNPs were also analyzed using the common trend test, which tests SNPs for being associated with a disease (). The P-values and their rank were compared with results of RJ analysis. A network was created using the top 10 genes. The network was generated through the use of Ingenuity Pathways Analysis (Ingenuity Systems, www.ingenuity.com).
RESULTS
Comparison of importance scoresshows that RJ and randomForest rank all variables in the same order. Results of Gini importance score and permutation importance scores investigation are shown in Supplementary, b and c. Both programs yield similar scores for all importance measures. All implementations are able to handle the real dataset, but computing time and memory consumption differed substantially (). Specifically, the randomForest and RF in Fortran analyzed the dataset in 88.8 and 84.1 h, respectively, whereas RJ performed the same analysis in only 0.53 h using 40 CPUs in parallel. RF in Fortran is the fastest alternative tool. In comparison to RF in Fortran, RJ performed 159 times faster. With RJ running in a single CPU mode, a speed up of seven was still obtained. Willows required 1750 h for the analysis. RJ turned out to be the fastest program for real data analysis. The computing time of all implementations is depicted in. The randomForest package and RF in Fortran consumed 9805 and 5421 MB memory, respectively (). Considerably less memory was used by Willows, which consumed 136 MB memory. RJ spent 179 MB using one CPU. When using multiple CPUs, the program RJ distributed five processes among five computers using the MPI mode. Each process consumed 303 MB and utilized eight CPUs by using multithreading. RJ consumed more memory in the multiprocessor mode because helping data structures have to be provided for every CPU. The importance scores of the SNPs and their chromosomal positions are depicted in. The two highest peaks are located on chromosomes 1 and 16, which correspond to genes IL23R and NOD2, respectively. A comparison of positive CVI scores and two-sided P-values from the CochraneArmitage trend test is shown in Supplementary. The smallest P-value of all positive CVI scores is 210 8. The Pearson's correlation coefficient between scores and P-values is 0.38, showing a moderate association between importance scores Page: 1756 17521758. The genes were derived by evaluating the most important SNPs that are located within genes as shown in Supplementary Table 3. The first 10 unique genes were selected for further investigations. The four most important SNPs yielded the smallest P-values in the trend test. The interleukin 23 receptor (IL23R) and nucleotidebinding oligomerization domain containing 2 (NOD2) were found to be the most important genes by RJ analysis. IL23R and NOD2 genes were also identified by several GWA studies and corresponding SNPs are known to be strongly associated with susceptibility to Crohn's disease ().A moderate association of calsyntenin 2 (CLSTN2) (P = 610 5 ) with Crohn's disease was reported in literature (). The tumor necrosis factor superfamily member 10 (TNFSF10) was high ranked by RJ analysis. The traditional trend test of TNFSF10 yielded P = 0.001576. TNFSF10 is involved in apoptosis and proliferation of human colon cancer cells (). Colorectal cancer and Crohn's disease are related due to the fact that relative risk of colorectal cancers is significantly raised in Crohn's disease (). Five of the 10 most important genes can be linked to a potential pathway by consulting additional genes, proteins and transcripts. The potential pathway is shown in. The IL23R and Page: 1757 17521758
D.F.Schwarz et al.
On safari to Random Jungle: a fast implementation of Random ForestsTNFSF10 potentially interact via the signal transducer and activator of transcription 3 (STAT3;). TNFSF10 possibly interacts with PRKG1 via Sp1 transcription factor (SP1;). TNFSF10 contingently interacts with NOD2 via nuclear factor of kappa light polypeptide gene enhancer in B-cells 1 (NFKB1;). Finally, NOD2 conceivably interacts with CDK5 regulatory subunit associated protein (CDKAL1) via hepatocyte nuclear factor 4 alpha (HNF4A,).
DISCUSSIONThe RF method was applied to genome-wide data using RJ and assigned a score of importance to each SNP. The resulting list of SNPs was investigated for potential interactions. The results of the real data analysis validate the findings of GWA studies such as NOD2 and IL23R. Results give also evidence of new potential interactions between genes that are associated with Crohn's disease. Specifically, the TNFSF10 was not found to be strongly associated with Crohn's disease by traditional statistical tests. In contrast, RJ analysis detected that TNFSF10 potentially interacts with NOD2, PRGK1 and IL23R. STAT3 is considered to be a link between TNFSF10 and IL23R, which was shown to be moderately associated with Crohn's disease. The TNFSF10 is involved in apoptosis of human colon cancer cells. TNFSF10 might possibly explain a part of the high risk of colorectal cancers in Crohn's disease patients. However, interpreting results and assessing biological plausibility is challenging. Results may show false positives. Thus, further investigation is needed to validate this specific causal relationship. Furthermore, although RF has the ability to detect very small main effects, its power to identify interactions depends on the presence of main effects. Thus, genegene interaction with no marginal effects might be left unrevealed when RF is applied. Nevertheless, an impressive computational efficiency and memory management of RJ allow for analyzing high-dimensional data in an acceptable amount of time. Analyzing GWA data comprising thousands of observations and a million SNPs seem to be feasible with respect to time and memory consumption. The software computes up to 159 times faster than the fastest alternative implementation, and the program shows the same importance ranking with respect to the reference program. RJ presents various features such as RF growing, prediction, parameter tuning or imputation. In summary, RJ is a promising software package for applying RF method to high-dimensional data such as GWA data. The application of RF to GWA data may help to identify potential interacting SNPs that were not found by traditional statistical approaches.
ACKNOWLEDGMENTSWe thank the anonymous reviewers for their helpful suggestions and comments. The NIDDK IBDGC Crohn's Disease GWA Study was conducted by the NIDDK IBDGC Crohn's Disease GWA Study Investigators and supported by the National Institute of Diabetes and Digestive and Kidney Diseases (NIDDK). This manuscript was not prepared in collaboration with Investigators of the NIDDK IBDGC Crohn's Disease GWA Study and does not necessarily reflect the opinions or views of the NIDDK IBDGC Crohn's Disease GWA Study or the NIDDK.
at :: on August 31, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
