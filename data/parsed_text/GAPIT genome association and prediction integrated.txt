Software programs that conduct genome-wide association studies and genomic prediction and selection need to use methodol-ogies that maximize statistical power, provide high prediction accuracy and run in a computationally efficient manner. We developed an R package called Genome Association and Prediction Integrated Tool (GAPIT) that implements advanced statistical methods including the compressed mixed linear model (CMLM) and CMLM-based genomic prediction and selection. The GAPIT package can handle large data-sets in excess of 10 000 individuals and 1 million single-nucleotide polymorphisms with minimal computational time, while providing user-friendly access and concise tables and graphs to interpret results.
INTRODUCTIONAdvances in high-throughput single-nucleotide polymorphism (SNP) genotyping are enabling powerful genome-wide association studies (GWAS), thereby enhancing the ability to identify causal mutations that underlie human diseases and agriculturally important traits. The resulting SNPs are also valuable for genomic prediction and selection (GS), which provides criteria for disease risk management in humans and expedited selection in animal and plant breeding (). Before the full potential of GWAS and GS are realized, inflated false-positive rates, extensive computational requirements and suboptimal prediction accuracies need to be addressed. Newly developed GWAS statistical methods based on the mixed linear model (MLM) hold great promise to overcome these challenges. They are flexible because they incorporate fixed and random effects. To address the spurious associations that arise from population structure, covariates from either STRUCTURE () or principal components (PCs) can be included as fixed effects. The cryptic relationships between individuals are accounted for through a kinship matrix in the unified MLM (). The more computationally efficient and powerful compressed MLM (CMLM) () uses a group kinship matrix calculated from clustered individuals. Because the typical number of genotypic data points is exceeding hundreds of millions, solving MLMs using the traditional restricted maximum likelihood approach is computationally intensive. Therefore, the efficient mixed model association (EMMA) algorithm () was developed to reduce this computational burden by reparameterizing the MLM likelihood functions. EMMA eXpedited (EMMAX) () and population parameters previously determined (P3D) () were independently developed to further reduce computing time by eliminating the need to re-estimate variance components at each marker. Most GS methods make predictions with the sum of the effects from all available SNPs or Genomic Best Linear Unbiased Prediction (gBLUP) based on a kinship matrix derived from these SNPs. The former approach offers higher prediction accuracies for simpler traits, while the latter approach is more accurate for complex traits (). Our work implements an improved gBLUP method that increases accuracy, especially for simple traits. Most software packages were developed for a particular GWAS or GS approach. For example, packages were written exclusively for the EMMA and EMMAX algorithms. Other software such as the Trait Analysis by aSSociation, Evolution and Linkage (TASSEL) () and PLINK () make multiple GWAS approaches available in one package. We continue these software development efforts by creating Genome Association and Prediction Integrated Tool (GAPIT), which integrates the most powerful, accurate and computationally efficient GWAS and GS methods into a single R package.
IMPLEMENTATIONThe GAPIT program accepts several combinations of genotypic data, phenotypic data, externally obtained kinship matrices, and *To whom correspondence should be addressed. covariates such as population structure and age. Multiple traits can be stored in a single phenotypic dataset, which allows sequential analysis of each trait. The genotypic data may be stored in HapMap or numerical formats. If genotypic data are absent, then phenotypic data and a kinship matrix are required to perform GS. By default, GAPIT uses the CMLM approach with P3D/ EMMAX for GWAS. GS is performed using the same optimization settings as GWAS (Supplementary Sections I and II and). There is an option to perform GS only by specifying 'SNP.test  FALSE'. Seven algorithms are available to cluster individuals into groups. GAPIT can also perform the MLM and GLM approaches by adjusting the 'group.to' and 'group.from' input parameters. When the kinship matrix is not provided, it will be calculated with the methods of VanRaden (), Loiselle () or EMMA (). GAPIT can also perform principal component analysis of the genotypic data to control for population structure (). GAPIT has several strategies for analyzing large SNP datasets. One is to import genotypic data stored in multiple smaller files. If these files still exceed memory limits, the 'file.fragment' parameter can be used to sequentially load fragments within each file. If there is not enough memory to use all SNPs to calculate the kinship matrix and PCs, then the 'SNP.fraction' input parameter will select a random sample of the SNPs for these calculations (). The results from GAPIT are accessed as both objects within the R workspace and as external files. The R objects, which include GWAS and GS results, may be used for follow-up analyses in R. The external files include publication-ready summaries of GWAS and GS results. GWAS results are summarized by Manhattan plots, quantilequantile plots and a table. Similarly, GS results are presented in a heat map and a table. Graphs of the heritability estimates and the likelihood function at various compression levels are included. A subset of the graphs and tables produced by GAPIT are presented in.
PERFORMANCE TESTSEMMA and TASSEL were compared with GAPIT. These two packages were selected because both use the EMMA algorithm, while TASSEL also implements the CMLM approach with P3D. When the same approach was used, identical results were obtained (Supplementary Figs S2 and S3). The computing time of all three packages increases linearly with the number of SNPs (Supplementary). However, the average computing time per SNP in GAPIT is 7-fold and 180-fold faster than TASSEL and EMMA, respectively (Supplementary). It took 69.5 h to analyze a dataset with 11 000 individuals and 500 000 SNPs, which extrapolates to 7195 SNPs/CPU hours or less than 6 days to analyze 1 million SNPs.
CONCLUSIONSThis R package uses state-of-the-art mixed model methods to conduct GWAS and GS. GAPIT analyzes large datasets with minimum computational time and produces comprehensive results including R objects and high-quality graphs.(h) Output table of GWAS results. The SNP id, chromosome, bp position, P-value, minor allele frequency (maf), sample size (nobs), R 2 of the model without the SNP, R 2 of the model with the SNP and adjusted P-value following a false discovery rate-controlling procedure ().
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
A.E.Lipka et al. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
Genome association and prediction integrated tool at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
