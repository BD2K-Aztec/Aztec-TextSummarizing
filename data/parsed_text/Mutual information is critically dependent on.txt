Motivation: Mutual information (MI) is a quantity that measures the dependence between two arbitrary random variables and has been repeatedly used to solve a wide variety of bioinformatic problems. Recently, when attempting to quantify the effects of sampling variance on computed values of MI in proteins, we encountered striking differences among various novel estimates of MI. These differences revealed that estimating the 'true' value of MI is not a straightforward procedure, and minor variations of assumptions yielded remarkably different estimates. Results: We describe four formally equivalent estimates of MI, three of which explicitly account for sampling variance, that yield non-equal values of MI given exact frequencies. These MI estimates are essentially non-predictive of each other, converging only in the limit of implausibly large datasets. Lastly, we show that all four estimates are biologically reasonable estimates of MI, despite their disparity, since each is actually the Kullbackâ€“Leibler divergence between random variables conditioned on equally plausible hypotheses. Conclusions: For sparse contingency tables of the type universally observed in protein coevolution studies, our results show that estimates of MI, and hence inferences about physical phenomena such as coevolution, are critically dependent on at least three prior assumptions. These assumptions are: (i) how observation counts relate to expected frequencies; (ii) the relationship between joint and marginal frequencies; and (iii) how non-observed categories are interpreted. In any biologically relevant data, these assumptions will affect the MI estimate as much or more-so than observed data, and are independent of uncertainty in frequency parameters.
BACKGROUNDMutual information (MI) is an information-theoretic quantity measuring the dependence between two arbitrary random variables. It is used in a vast array of bioinformatic disciplines such as phylogenetics (), RNA secondary structure prediction (), * To whom correspondence should be addressed. transcription factor binding site analysis () and protein coevolution (), among many other fields. Given two discrete random variables X and Y , the MI I(X,Y ) shared by them is given byNote that the summations in (1) can be replaced by abstract integration, allowing MI to be defined for arbitrary probability measures. However, for the remainder of this article we will implicitly assume that X and Y are discrete and finite. Virtually all bioinformatic applications of (1) involve multinomial likelihoods for mn, 2D contingency tables. A d-dimensional contingency table is a representation of the number of observed occurrences of d categorical variables, and when d = 2gives the total estimated MI aswhere p ij is the joint probability that Pr(X = x i ,Y = y j ), r i the marginal probability Pr(X = x i ) and s i the marginal probability Pr(Y = y j ). Of course, the probability parameters p ij , r i and s j are not observed. Instead, they must be inferred from the entries of a contingency table of observed events, where n ij represents the number of observed events of joint class (i,j), n i+ the marginal countsVirtually all applications of (2) make two fundamental assumptions when estimating the frequency parameters from the contingency counts. These assumptions are that: (i) p ij n ij /n,as per the marginal counts. When assumed to hold, these conditions can be used to map a given table of counts n ij to a unique point-estimate of MI, which we term I p. A graphical depiction of the overall procedure for estimating I p from n ij is shown in Supplementary Figure A-1. This point-estimate I p is the most commonly used estimate of MI reported in the literature. However, to mitigate the effect of categories n ij with small counts, pseudocounts () have been used for estimating motifs for both protein domains () and transcription factor binding sites (). In essence, pseudocounts estimate p ij as proportional to n ij +c ij , where all c ij > 0 denote small constants, resulting in a different point-estimate
A.D.Fernandes and G.B.Gloorof MI. Since our work focuses on describing variability that is intrinsic to the computation of MI from frequencies, rather than the inference of frequencies from counts, we constrain c ij to be zero as this is the standard pseudocount value in comparable studies that utilize MI or a variant to study substitution covariance in proteins. A notable exception to the implicit estimate of p ij n ij /n is the work of, who detail several methods by which frequencies can be inferred from counts for computing MI. As with previous literature and in contrast to this work, however,only infer frequency point-estimates from the count data, effectively discarding information regarding sampling variance, and implicitly but incorrectly assume that I a , defined below, is the only correct estimate of MI.
METHODS
Estimate of sampling varianceEstimates of sampling variance for I a , I m and I u were computed using standard Bayesian methods. Posterior estimates of p ij were inferred from observed n ij via Dirichlet priors and multinomial likelihoods, resulting in Dirichlet posteriors (). All Dirichlet hyperparmeter components were set to 1/2 following Berger andas this value formally minimizes the influence of the prior on the posterior and is formally equivalent to using Jeffreys' reparameterization-invariant prior ().
Multiplicatively constrained MIThe decomposition of log(p ij ) = s ij +d ij is based on the observation that the p ij parameters themselves comprise a probability density, and this density can be viewed as a proportional composition. The analysis of proportional compositions is best done via their logarithms () because such log-compositions are isomorphic to standard Euclidean vector spaces (). In these spaces, vector addition and scalar multiplication correspond to the physical amalgamation of compositional mixtures. Therefore, rather than being a theoretical artifice, the use of log(p ij ) has a simple, direct and physical interpretation. The mathematical theory and a concrete example of computing I m from p ij is fully detailed in Supplementary Material B.
RESULTSOur main results are 2-fold in that: (i) the two common assumptions that p ij n ij /n and that the joint frequencies sum to the marginal frequencies are not required to estimate MI; and (ii) not using or modifying these assumptions results in dramatically varying estimates of MI especially for protein covariation data. The implication is that these two assumptions provide far more a priori information, and hence bias, to the estimate of MI than previously believed. Our conclusions are based on the behavior of four equally valid, yet often dramatically different estimates of MI, described below. Differences among the estimates are particularly acute for the sparsely populated contingency tables commonly observed in studies of covariant substitution between two protein alignment sites. Note that although the natural base is used throughout, our results are invariant to choice of logarithm base.
Four estimates of MIA representative sample of our four different estimates of MI is shown inexample plots with their associated contingency tables are given as Supplementary Material E. Our dataset consists of a representative structural alignment of 454 sequences of triose-phosphate isomerase (TIM1) gathered from Genbank, restricted to a maximum of 90% identity. Site numbering follows the Escherichia coli Protein Data Bank entry 1TRE and only utilizes ungapped sites exhibiting clear homology (). The validity of using only ungapped sites can be substantiated by the extensive analysis of TIM1 functional covariance detailed by, with the additional benefit that sample-size effects do not complicate our analysis.
Point-estimate MIThe first estimate of MI considered is the point-estimate I p described above, without pseudocounts. This is the most common estimate of MI reported in the literature.
Additively constrained MIRather than using pseudocounts, we instead use Bayesian techniques to estimate the posterior distribution of each component p ij (see Section 4). We emphasize that essentially any technique could be used to estimate the posterior distribution of the p ij without qualitative change in our findings. The most important property of what we deem the additively constrained estimate of MI, or I a , is that estimates of p ij given n ij are given a range rather than a single value. In this article, the range of p ij is given as a parameter posterior distribution. However, even simple uniform-type error-estimates yield qualitatively similar findings. Specifically, given a table of counts n ij , a specific set of joint probabilities p ij is drawn from the posterior density of Pr(p ij |n ij ). The marginal probability parameters p i+ and p +j are computed through the previously discussed additive constraints p i+ = j p ij and p +j = i p ij. The procedure is repeated to build a Monte Carlo estimate of the posterior distribution of MI. This estimate of MI, deemed I a , is the one most commonly used whenever sampling variance is accounted for ().
Multiplicatively constrained MIThe constraint that the joint frequencies precisely sum to the marginal frequencies is not the only mathematically or physically reasonable assumption, however. For example, if log(p ij ) is used rather than p ij for parameterization, standard techniques from linear algebra can be used to partition log(p ij ) = s ij +d ij as further elucidated in Section 4. The components s ij specifically quantify row/column
Dependence of MI on prior assumptionsindependence and the components d ij specifically quantify row/column dependence. We deem the estimate of MI comparing p ij and s ij to be I m. Although the use of the log-frequencies may be unfamiliar, we emphasize that their use is quite common in standard statistical theory. Log-frequencies are the 'natural' parameter space for the multinomial distribution on which (2) is based. As the multinomial is an exponential-family distribution, many of its properties have been elucidated and are best understood in the logarithmic natural parameter space.
Independent, unconstrained MIAlthough perhaps counterintuitive, there is no a priori necessity to condition on the joint and marginal frequencies being consistent. To understand why, consider the following thought experiment. The table of joint counts n ij is given to Alice from which she is told to estimate the p ij parameters without assuming any particular structure in the data. Independently, the table of counts is summed to the marginals n i+ and n +j which are given to Bob in order to estimate p i+ and p +j , again without further assumptions. Alice and Bob may each choose different, yet equally valid, methods of inferring frequencies from counts, some of which have been cataloged by. Alice's frequencies are inferred under the hypothesis of dependence whereas Bob's are inferred under the hypothesis of independence. Only after inferring frequencies from counts do Alice and Bob need to compare their respective joint frequencies using MI. Since Alice and Bob do not share information before comparing frequencies, there is no a priori requirement that joint frequencies sum to equal the marginal frequencies, and in generalThis thought experiment shows the plausibility of Pr(p ij |n ij ) being wholly unconstrained by either Pr(p i+ |n i+ ) or Pr(p +j |n +j ). We deem such an unconstrained estimate of MI to be I u. Of course, given any reasonable dataset n ij it is likely but not strictly necessary that the inferred parameters be reasonably consistent with p i+  j p ij and p +j  i p ij. Far from being a statistical artifice, this thought-experiment informally yet precisely describes the information-independence between the hypotheses of 'dependence' versus 'independence' in contingency table analysis: small 'errors' in the frequencies inferred by Alice are necessarily independent of small 'errors' in the frequencies inferred by Bob.
Properties of the estimatesIn examining the 24 000 pairs of alignment sites for TIM1, it appears that both the central tendency and dispersion of the estimates robustly follow the orderingas displayed inand the Supplementary Material. In general, all three distributions were distinct except when both alignment sites were highly conserved (see sites 010 and 077 in Supplementary Material E) in which case I p  0 and I m  I u were their largest. This latter case was among the most intriguing since site-pair conservation, which implies that one entry of the n ij receives the majority of observations, minimizes I p while maximizing I m and I u. This discrepancy highlights how much 'information'is implicitly added by the assumption that n ij = 0  p ij = 0.
Point-estimate comparisonThe inability of I p to meaningfully predict any of the three distributional estimates is shown by the left-hand panels of.are approximately Gaussian, implying that the z-score is a reasonable measure of correspondence between point-and distributionalestimate. Although mildly correlated, the large dispersion of each scatterplot show that MI p is not a meaningful predictor ofdoes not necessarily imply that I p is a 'closer' estimate to I a than either I m or I u. For example, if the 'distance' between the point and distribution-mean estimates is taken to be the standardized score z-score, then I a is considerably less predictive of I p than either I m or I u are. The negative correlation seen infurther highlights the information inherent in the assumption that zero counts imply a zero frequency. When both sites are highly conserved, implying that the majority of counts occur in one n ij category, I p tends to zero while I m and I u tend to overlap and attain their largest values (see sites 010 and 077 in Supplementary Material E). The point estimate I p assumes that non-observed categories contain precisely zero information, whereas the distributional estimates assume that each of the 400 categories contributes a 'small amount' of MI to the total, as shown in a plot of i p i log(p i ) in Supplementary Figure A-2. Among the distributional estimates, scatter plots of mean values for I a , I m and I u (Supplementary
A.D.Fernandes and G.B.Gloorseen between I m and I u , with the weakest between I a and I u. This observation can be interpreted to imply that joint-to-marginal consistency is a less-stringent constraint in the multiplicative log(p ij ) parameter space than the additive p ij parameter space.
Convergence of the estimatesAlthough the four estimates differ substantially when the contingency table n ij is sparse, standard arguments show that a sufficient condition for all four estimates to converge is asymptotic normality. Such normality is guaranteed only if a sufficient number of observations (usually 510) are seen in every category n ij. In this case, the multinomial likelihood is wellapproximated by the multivariate normal and all estimates converge in distribution. In actual protein data, site-specific residues have wellknown constraints due to participation in catalytic function or secondary/tertiary structural elements. These biological constraints imply that asymptotic normality cannot be achieved in real data. Therefore, we expect that non-commensurate estimates of MI as shown inare not exceptional and are in fact inescapable. A more detailed examination of the convergence ofrespect to sample-size and dependence-to-independence ratio is presented in Supplementary Materials D and F. These examinations show that under biologically realistic amino acid frequencies displaying maximal variance as given by the WAGmodel equilibrium frequencies () and no phylogenetic correlation, between 1000 and 10 000 sequences are needed for convergence, with greater dependency requiring a larger number of sequences. Since phylogeny and amino acid preference (smaller variance) can be seen by inspection to reduce the effective sample size, the actual number of biological replicates required would be much greater. Although the example presented in Supplementary Material D might seem to imply that I p is the 'better' estimate of the four when sample sizes are small and there is relatively little dependence, such a conclusion is incorrect because it is not known a priori that dependency is in fact small. In fact, it is arguable that since values of I p appear to be relatively insensitive to both the number of sequences and the amount of modeled dependence that I p is less able to discern true covariation from 'noise' than the other measures. An examination of convergence issues for different groups of protein orthologs is detailed in Supplementary Material F. Although it is theoretically impossible that one of the four estimates is, in any global sense, a 'better' estimator of MI than the others, it is certainly possible that in practice one or more estimators may outperform the others. However, we emphasize that this study provides no evidence of such superiority even in light of the single example illustrated by Supplement Material D.
Boundedness of the estimatesUsing the method of Lagrange multipliers, it is straightforward to show that both I p and I a have a finite range (). Specifically, for a d-dimensional contingency table with m k marginal classes possessing m 1 m 2 m d joint classes, it can be shown thatIn contrast, both I m and I u are unbounded and can, with nonzero probability, take any non-negative value. Such unboundedness does not necessarily make these I m and I u incongruous with I p and I a since large values of the former only occur if the joint and marginal frequencies are asymptotically inconsistent. Examples of such unlikely parameter estimates are discussed in Supplementary Material C.
CONCLUSIONSMI is a tool commonly used to define and study a type of generalized covariance between two random variables. In this work, we show that for sparsely populated contingency tables there exist at least four different estimates of MI. These estimates are poor predictors of one other and often differ greatly when compared on both relative and absolute scales. Unlike previous work, where differences between estimates of MI are universally attributed to differences in how frequency parameters are estimated from counts, we show that the definition of MI itself may be responsible for uncertainty in its value. For example, given precise frequency parameters p ij, the additive I a =5log(2)+9/8log(3)+5/8log(5) whereas the/16log(5)+7/16log(7). Thus, even for exact frequencies p ij we have I a = I m. To our knowledge, this is the first demonstration that definition of MI itself possesses intrinsic uncertainty. Such uncertainty may explain why MI, either in raw or corrected form, is in often an unreliable estimate of categorical dependency (). Minimizing such differences requires that the estimates mutually converge, and such convergence requires implausibly large biological datasets. Thus, the assumed relationship between the joint and marginal frequencies and the interpretation of unobserved categories will inevitably have non-negligible consequences. The breadth of these consequences may explain the broad range of results observed bywith respect to the MIbased detection of protein coevolution. Moreover, the example convergence discussed in Supplementary Material D taken in the context of the Central Limit Theorem implies that a necessary although insufficient condition for an MI estimate to be principally dependent on the data rather than assumptions is that the expected value of each of the four estimates must be equal. As shown in Supplement Material F, an analysis of 10 different alignments across 7 functionally and structurally diverse ortholog families reveals that even with alignments with 1000 sequences, estimates of MI are primarily dependent on prior assumptions, not observed data. By carefully tracking all conditional assumptions inherent in our four MI estimates, we see that both I p and I a are inferredwhere A denotes the hypothesis of an additive constraint. The I p estimate builds on I a with the additional conditional restriction that p ij = n ij /n, a strong assumption that collapses the distribution of I a to the single-point I p , itself a poor predictor of I a. Similarly to I a , the I m estimate is inferred through Pr(p ij |n ij ) and Pr(p i+ ,p +j |n ij ,p ij ,M), where M denotes the hypothesis of multiplicative subspace decomposition. Lastly, I u is inferred via Pr(p ij |n ij ), Pr(p i+ |n i+ ) and Pr(p +j |n +j ) with the only conditional assumptions coming from observed data. All four of the resultant MI estimates have the form I(p,q) = ij p ij log(p ij /q ij ) and can, therefore, be equivalently viewed as KullbackLeibler divergences between distributions conditioned on different hypotheses and parameter estimates (). From a statistical viewpoint, none of these estimates are 'more correct' than any other since each merely conditions on different assumptions. What we have shown is that estimates of MI are necessarily as or more affected by these assumptions than the actual Page: 1139 11351139
Dependence of MI on prior assumptionsobserved data. The 'correct' conditional assumptions to use, we believe, are those that more closely match known or hypothesized biological constraints. For example, a pair of protein sites forming a putative salt bridge may assume that p ij = 0 for all joint classes possessing uncharged amino acids. Similarly, sites involved in putative -helices may a priori disallow proline and proportionally weight the prior probability of other amino acids by their known helical-forming propensities. Unlike the filtering methodology ofthat is applied only to I a , corrections to MI as per, or different ways of inferring frequencies as per, this information needs to assist in the construction of the MI computation itself. A consequence of requiring that mathematical and biological assumptions be concordant is the impossibility of meaningfully inferring coevolution using only pair-count data. Like the examples above that conditioned on possible salt-bridges or -helices, we posit that additional biological knowledge is a necessary prerequisite for meaningful inferences about coevolution. The difficult problem of how to best express such often-incomplete biological information as conditional prior-probabilities remains an open question for future research.
The Author 2010. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oxfordjournals.org 1135 at :: on August 31, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
at :: on August 31, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
