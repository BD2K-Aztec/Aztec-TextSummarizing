For heterogeneous tissues, measurements of gene expression through mRNA-Seq data are confounded by relative proportions of cell types involved. In this note, we introduce an efficient pipeline: DeconRNASeq, an R package for deconvolution of heterogeneous tissues based on mRNA-Seq data. It adopts a globally optimized non-negative decomposition algorithm through quadratic programming for estimating the mixing proportions of distinctive tissue types in next-generation sequencing data. We demonstrated the feasibility and validity of DeconRNASeq across a range of mixing levels and sources using mRNA-Seq data mixed in silico at known concentrations. We validated our computational approach for various benchmark data, with high correlation between our predicted cell proportions and the real fractions of tissues. Our study provides a rigorous, quantitative and high-resolution tool as a prerequisite to use mRNA-Seq data. The modularity of package design allows an easy deployment of custom analytical pipelines for data from other high-throughput platforms. Availability: DeconRNASeq is written in R, and is freely available at
INTRODUCTIONHigh-throughput next-generation sequencing (NGS) technologies are becoming quickly established in biomedical research and discovery (). NGS-based sequencing of mRNA (referred to as mRNA-Seq) offers several potential advantages over microarray-based methods (). Heterogeneous tissues are frequently collected (e.g. blood, tumour, etc.) from humans or model animals (). Therefore, mRNA-Seq samples are often heterogeneous with regard to those cell types, making it difficult to distinguish gene expression variability that reflects shifts in cell populations from variability that reflects change of cell-typespecific expression (). Recently, we have described the deconvolution of microarray data from complex samples such as blood samples collected in a clinical trial ().described a probabilistic framework to address the similar problem using high-throughput sequencing. Their approach requires strong assumptions about the distributions of gene abundance and is not able to generate per-sample estimates of tissue or cell abundance. mRNA-Seq data are inherently different than microarray data, which are able to give the more refined information necessary to tackle the deconvolution problem; we therefore expected that these methods need to be updated and re-validated. However, transferring the approach of microarray data into a robust analysis pipeline is an inherently study-specific task and poses ongoing challenges. Although mRNA-Seq is promising, it is widely accepted that many factors could introduce variation and bias to mRNA-Seq data. Therefore, proper pre-processing methods are needed to de-noise and fine-tune the mRNA-Seq data before they are used in downstream deconvolution. In light of these considerations, we have developed DeconRNASeq, an R/Bioconductor-based pipeline for constituent fraction estimation and quality assessment of deconvolution on mRNA-seq datasets. Here, we describe the DeconRNASeq package that encapsulates the method in a convenient-to-use format. DeconRNASeq is based on a linear model of a sum of pure tissue-or cell-type-specific reads of all cell types, weighted by the respective cell-type proportions. To estimate the proportions of known tissue types in a sample, DeconRNASeq solves a non-negative least-squares constraint problem with quadratic programming to obtain the globally optimal solution for estimated fractions. Results from mRNA-Seq data described here demonstrate that our method is able to accurately predict mixing fractions for multiple species of tissues or cells. Using the mixing samples containing relatively rare cell types ( 2%), we show that correlation coefficient between the estimate proportions and the true proportions can reach 0.9754. In principle, DeconRNASeq is also applicable to other types of profiling data from heterogeneous samples. For example, the same approach could be used to track species in metagenomics data () or DNA contamination in tumour samples ().depicts the workflow of our transcriptome quantification and deconvolution pipeline. Given the information of the short-read alignment, followed by transcript quantification, we apply a statistical approach to model expression from a mixed cell population as the weighted average of expression from different cell types. We solve these equations using quadratic programming, which efficiently identifies the *To whom correspondence should be addressed. globally optimal solution while preserving non-negativity of the fraction of the cells. Consequently, we can accurately estimate the fractions of various cell populations. The details are described as follows. DeconRNASeq requires input in the form of two R data frames that contain normalized transcriptional measurements from pure tissues (S) and the heterogeneous samples (X) to be analysed respectively. The gene was used as the expression unit in our example, although the methodology can be extended to transcripts or exons, provided the quantification of their expression is properly obtained. More specifically, the expression level x jk of gene j in a sample k is the average of expected expression levels across the cell types s ij , weighted by the respective cell-type proportions a ki (i  1. .. N, N: the total number of cell types):
METHODSOr more generally, we represent the above equation in matrix form as:Here, X denotes the observed mixture gene expression matrix (genes by samples). S, the signature matrix derived from the training data (homogeneous samples), gives the tissue-type-specific gene expression profiles (genes by tissue types), and A, the proportion matrix, is the quantity to estimate tissue proportions over samples (tissue types by samples). We solve this weighted non-negative least squares problem for each gene by min A k AS  X k 2 , s:t:the coefficient a ki is a scalar parameter between 0 and 1 to represent the fraction of tissue type. The formulation can then be efficiently solved by quadratic programming ().
RESULTSTo systematically examine the accuracy of our deconvolution algorithm, we designed several inbe noted that we investigated the influence of extremely low fractions of contaminating cell types (52%). More experiments including the deconvolution of biologically related cell population can be found in Supplementary Material. We estimated the number of expression signatures (genes) through the condition number of the signature matrix (see Supplementary Sections 3.2 and 3.3 for its detailed derivation). Consequently, we seleted first 1570 genes that consist of the signatures for the five tissues and deconvoluted the data (refer to the Supplementary Section 3.3 for the validation of the 'optimal' number of expression signatures in terms of condition number). The results are shown in(bf), with correlation coefficient between the estimation and the real frations  0.9754. Reassuringly, our algorithm was able to accurately predict the level of mixing across a wide range of proportions including multiple pure sources for mRNA-Seq data.
The Author 2013. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
CONCLUSION We have introduced a statistical workflowDeconRNASeqto estimate proportions of tissue or cell types by incorporating tissue-type-specific genes. Simulations show that our deconvolution analysis accurately detects expression heterogeneity and assesses proportions of multiple tissue types in newly advent NGS platform. The main objective of our work is to develop comprehensive and flexible deconvolution software effectively applicable to expression profiling experiments. Thereby, it is worth noting that the algorithmic items are shared with our previous work (Gong et al., 2011) and can also be applied to microarray data. However, microarray data require appropriate normalization and other pre-processing methods as described in Gong et al. (2011). The independent profile-generating module in DeconRNASeq grants great freedom to users, who can combine with other R or Bioconductor packages to perform upstream and downstream analysis of NGS data.
T.Gong and J.D.Szustakowski at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
DeconRNASeq at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
