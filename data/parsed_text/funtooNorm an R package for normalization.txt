Motivation: DNA methylation patterns are well known to vary substantially across cell types or tissues. Hence, existing normalization methods may not be optimal if they do not take this into account. We therefore present a new R package for normalization of data from the Illumina Infinium Human Methylation450 BeadChip (Illumina 450 K) built on the concepts in the recently published funNorm method, and introducing cell-type or tissue-type flexibility. Results: funtooNorm is relevant for data sets containing samples from two or more cell or tissue types. A visual display of cross-validated errors informs the choice of the optimal number of
IntroductionRecently, a normalization method was introduced by Fortin et al.). The percentilespecific adjustments in funNorm are the key feature allowing batch effects and technical artefacts to have non-constant influence across the range of signal strengths. However, since methylation patterns may differ substantially across cell types or tissues leading to cell-(or tissue)-type-specific quantiles, optimal normalization adjustments should capture this. Here we present an R package for normalization of Illumina 450 K data, funtooNorm (an extension of the ideas in funNorm) applicable to such heterogeneous data sets.
MethodsKey features of funtooNorm and funNorm are identical, i.e. normalization adjustments are estimated via regression models applied to a series of quantiles of the probe-type-specific signals in each sample. Covariates, derived from the control probes, capture variation not associated with the biological signals of interest. In funtooNorm, an augmented covariate matrix is constructed by including interactions between cell-type or tissue-type indicators and the average signal from each control probe type. Either principal component regression (PCR) or partial least squares regression (PLS) () can be fit (the type.fits option); as in funNorm, normalized methylation values are based on predictions from linear interpolations between the analyzed percentiles (see Supplemental Methods). The function, funtoonorm, operates in two distinct modes:. Root mean square error from cross-validation comparing different numbers of components in funtooNorm on the Replication Data Set. Separate model fits are implemented for A and B signals, and for different probe types
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
Normalization mode: When validate  FALSE, normalization of the data is performed for a chosen number of components in the regressions. The model-fitting step requires only a set of quantiles for each sample, and hence is efficient both computationally and in memory usage. Calculations can be performed in a modular fashion; intermediary results can be saved by setting appropriate flags.  Cross-validation mode: When validate  TRUE, a graphical display of root mean squared errors (RMSE) obtained with crossvalidation facilitates choice of an appropriate number of components (Fig. 1). Plots are provided for both PCR and PLS fits. Three data sets are used to illustrate performance (Supplemental Table S1). In the Replication Data Set, methylation was measured in ten healthy individuals who contributed 23 samples of each of whole blood, buccal swab and dried blood spots, including a mixture of technical and biological replicates. In the Systemic Autoimmune Diseases Data (SARDS), monocytes and CD4  T-cells from incident patients were separated from whole blood, with repeated samples drawn before and after 6 months of immunosuppressive treatment. For the Gestational Diabetes Data (GD), one technical replicate sample was available for each of fetal placenta and cord blood tissues. Agreementwithin a tissue or cell typeis measured by the average (over probes) of the squared intra-replicate set differences, summed over distinct individuals. 3 Results Figure 1 displays the cross-validation RMSE plot for the Replication Data set with PCR. The optimal number of components varies across the percentiles and signals; evidently there is substantial improvement in mean squared error from 2 to 3 components. Technical replicate agreement was improved with funtooNorm compared to funNorm (Supplemental Figs S1 and S2, Supplemental Tables S2 and S3). Agreement improved by substantially for technical replicates of whole blood, blood spots, and fetal placenta tissues, although there was little difference between the methods for buccal swabs or cord blood. For biological replicates, we saw improvements of 10-20% in many tissues. Performance was particularly good for probes on the X chromosome. Supplemental Figure S3 shows that the distribution across probes of the differences between tissue types is distinct on the X chromosome; this is captured by our augmented covariate matrix. A similar argument explains enhanced performance for some probe annotations (Supplemental Fig. S4). Performance on the Y chromosome was poor, since with only 416 probes, a quantilebased model fit is overly complex; we recommend the simpler method implemented in funNorm for this chromosome.
K.O.Klein et al. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
Most methylation studies today are designed to detect interindividual differences, rather than inter-tissue differences. Improved normalization of datasets containing multiple tissues can be expected to translate into increased power to detect associations of interest, due to the inferred reduction in residual error; funNorm and this extension funtooNorm are designed with this goal in mind.
