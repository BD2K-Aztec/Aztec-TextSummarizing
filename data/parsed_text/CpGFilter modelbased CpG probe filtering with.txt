The development of the Infinium HumanMethylation450 BeadChip enables epigenome-wide association studies at a reduced cost. One observation of the 450K data is that many CpG sites the beadchip interrogates have very large measurement errors. Including these noisy CpGs will decrease the statistical power of detecting relevant associations due to multiple testing correction. We propose to use intra-class correlation coefficient (ICC), which characterizes the relative contribution of the biological variability to the total variability, to filter CpGs when technical repli-cates are available. We estimate the ICC based on a linear mixed effects model by pooling all the samples instead of using the technical replicates only. An ultra-fast algorithm has been developed to address the computational complexity and CpG filtering can be completed in minutes on a desktop computer for a 450K data set of over 1000 samples. Our method is very flexible and can accommodate any replicate design. Simulations and a real data application demonstrate that our whole-sample ICC method performs better than replicate-sample ICC or variance-based method. Availability and implementation: CpGFilter is implemented in R and publicly available under CRAN via the R package 'CpGFilter'.
IntroductionRecent advances in genomic technologies have enabled researchers to conduct large-scale studies of human disease-associated epigenetic variation, specifically variation in DNA methylation. Such epigenome-wide association studies (EWAS) have helped elucidate the non-genetic determinants of human disease (). The Illumina Infinium HumanMethylation450 Beadchip, which interrogates the methylation level of more than 450K CpG sites throughout the human genome, has been increasingly popular in large-scale EWAS due to its good genome coverage, high reproducibility and lower cost (Sandoval). One observation of the 450K data is that many CpGs have relatively larger technical variability compared with their biological variability, which are results of either large absolute technical variability (the methylation level cannot be measured accurately) or lower biological variability (many CpGs are constitutively methylated or unmethylated). These CpGs are less informative and including these CpGs will reduce the statistical power to discover relevant CpG sites by unnecessarily increasing the number of statistical tests. Hence, CpG filtering could potentially boost statistical power for underpowered studies. Traditional variance-based CpG filter is based on the total variability, which is the sum of the biological variability (signal) and technical variability (noise). However, we are more interested in retaining CpGs with relatively large biological variability instead of total variability. As with any hybridization-based array technology, CpG probes differ in their technical variability, possibly due to inexact probe sequence match, crosshybridization and local secondary structures (). Therefore, large total variability does not necessarily reflect large biological variability. Without technical replicates, the assessment of technical variability is difficult and we can only rely on the total variability to filter CpGs. Fortunately, most EWAS have included some technical replicates to assess various sources of batch effects. We can therefore use these replicates to assess technical variability. We propose to use intra-class correlation coefficient (ICC), which is defined as the ratio of biological variability to total variability, to filter CpG probes ()the method using technical replicates only, our method can result in more efficient ICC estimate since the unreplicated samples provide significant amount of information about the biological variability. Our method can accommodate any type of replicate design including unbalanced design. We have implemented an ultra-fast algorithm to fit LMM in linear computational time and the algorithm is highly scalable.
ModelSuppose we have m independent biological samples measuring the methylation of p CpGs. Assume each biological sample replicates n i i  1;. .. ; m times, totaling n  X m i1 n i samples. Note in most studies, the majority of the samples are not replicated and the majority of n i  1. Before ICC estimation, we recommend that data normalization and batch correction be performed to remove systematic technical variability. Denote y ij as the methylation M-value of a given CpG for ith biological sample and its jth technical replicate. We model y ij using an LMMwhere ij $ N0; r 2  and n i $ N0; r 2 n  represent technical and biological variability respectively. Denote y i  y i1 ;. .. ; y ini  and Y  y 1 ; y 2 ;. .. ; y m  T , we then have Y $ MVN l; V;  with the mean l  l; l;    ; l T and the covariance matrix Vwhere r 2  r 2  r 2 n is the total variance and q  r 2 n =r 2  r 2 n  is the ICC. When r 2 is the same for all CpGs, the filtering procedure based on the total variance is the same as that based on ICC. However, as in all array-based technologies, different probes have different measurement error levels, and ICC is generally a more appropriate measure than total variance. Fitting a mixed effects model with existing general-purpose algorithms is computationally intensive and is not scalable with the ever increasing sample size and CpG sites for genome-wide association studies. The major contribution of this paper is therefore the development of an ultra-fast algorithm based on maximum likelihood estimation, utilizing the special structure of the covariance matrix (block-diagonality and compound symmetry structure). The computational complexity is O(np) and scalable with the sample size and CpG number. The detailed algorithm is included in the Supplementary Note S1.
ResultsWe compare our whole-sample ICC method to the replicate-sample ICC method byas well as the total variance-based method using simulations. We simulate 1000 CpGs and 1000 independent samples, among which 10 samples are replicated twice. Let r n $ Uniform0:5; 8:0 and r $ Uniform0:25; 2:0. We then simulate the methylation M-values based on the model (1) and rank these CpGs based on ICC or variance after applying the three alternatives. We calculate the Spearman correlation between the resulted ranking and the ranking based on the simulated true q's, which is assumed to be the best. Simulations are repeated 100 times.shows our whole-sample ICC method produces invariably better ranking than the other two methods (median correlation 0.80 vs. 0.70 and 0.58). We next study the effects of ICC-based CpG filtering on the type I error and power of association tests using realistic simulations (Supplementary Note S2). CpGs with small ICCs will have no or little chance of showing significance, and removing these CpGs will enrich signals against a background of noise. As expected, using Bonferroni correction and false discovery rate control for multiple comparison correction, the proposed method has achieved better power than the replicate-sample ICC method, while controlling the type I error at the desired level. Simulation also suggests at least six technical replicate pairs to achieve good results. We apply our method to a cleaned 450K dataset of 482 985 methylation sites from buffy coat leukocytes of 559 males and 10 technical replicate pairs from the Normative Aging Study (). We conduct an epigenome-wide cross-sectional analysis of age (median 72, range 55100 years) based on a linear model, adjusting for subject characteristics, estimated cell type proportions and technical covariates. Strict Bonferroni correction isused to select 'significant' CpG sites. Clearly, these sites are dramatically enriched in large ICC values (). We see that 96.7% of the sites associated with age come from those with an ICC greater than the median (0.55). We also see 138 562 sites with an estimated ICC of zero, indicating much larger technical variability (measurement error) compared with their biological variability. In comparison with the ICC method, if we had only used the sites with total variance above the median, we would have captured only 93% of the sites associated with age in the full analysis (Supplementary). In general, an ICC cutoff of around 0.5 provides a good tradeoff between loss of potential significant CpG sites due to filtering and gain of power due to reduction of multiple testing burden (Supplementary).
FundingThis work was supported by NCI R37 CA76404, NCI P01 CA134294, NCI R35 CA197449, NIEHS R01 ES015172, NIEHS R01 ES021733, K99 ES023450 and Gerstner Family Career Development Award. Conflict of Interest: none declared.
at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
J.Chen et al. at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
