Motivation: In a microarray time series analysis, due to the large number of genes evaluated, the first step toward understanding the complex time network is the clustering of genes that share similar expression patterns over time. Up until now, the proposed methods do not point simultaneously to the temporal autocorrelation of the gene expression and the model-based clustering. We present a Bayesian method that considers jointly the fit of autoregressive panel data models and hierarchical gene clustering. Results: The proposed methodology was able to cluster genes that share similar expression over time, which was determined jointly by the estimates of autoregression parameters, by the average level of expression) and by the quality of the fitted model. Availability and implementation: The R codes for implementation of the proposed clustering method and for simulation study, as well as the real and simulated datasets, are freely accessible on the Web
INTRODUCTIONMicroarray time series (MTS) analysis allows the researcher to characterize set of genes through their longitudinal pattern of expression. According to, the MTS data analysis methodologies can be divided into two classes. The first one assumes the observations on the expression at each time as independent variables, and so the usual methods such as hierarchical process () and the optimization () can be directly used to cluster genes with similar expression pattern. The second performs clustering based on the set of parameters estimates from specific models, therefore, it is considered more interesting from the statistical and biological viewpoint, since the temporal expression behavior can be taken into account in the clustering. Among the second class of methods, the dynamic (), the hidden Markov () and the B-splines () models deserve special attention. Although these methods are useful, they are not suitable for relatively small * To whom correspondence should be addressed. experiments, with less than 10 temporal observations per gene (). However, according to, MTS studies are generally characterized by a large number of genes evaluated but with a small number of the temporal expression measures per gene. In the field of time series, mainly in econometrics, the Bayesian autoregressive panel data model is recommended for situations with large number of small series (), since it provides an increase in accuracy relatively to autoregressive model fit to each one small series. Considering these advantages of model-based clustering methods and the difficulty of applying them to a large number of small series, here we propose a Bayesian method that considers simultaneously an autoregressive panel data model fit and a hierarchical clustering of the parameter estimates from this model. In addition, we present the detailed R (R Development Core) codes with comments about the proposed method and its application to a MTS dataset extracted from Saccharomyces cerevisiae Stanford MicroArray Database.
METHODSThe autoregressive panel data model of order p, AR (p), according to, is given by as follows:+e it , i = 1,2,...,m; j = 1,2,...,p; t = 1,2,...,n,where Y it is the current value of the series i with mean  i ;  i1 , i2 ,..., ip are the autoregression parameters and e it is the residual term, assumedThe approximated likelihood function in matrix notation is given by as follows:where+I , = X T X +I and I is an identity matrix.
Iterative method for clustering genes with similar gene expression patternsThe gene clustering was performed using iterative process in which initially a single panel (only one cluster with all genes) from which the parameter estimates from Model 1 were obtained. These estimates were used as input variables in a Ward clustering analysis (), then for each resulting cluster, the Model 1 was fitted again. This procedure results in a new set of parameter estimates in each Gibbs sampler iteration and consequently in a new clustering output. The number of clusters in each Ward clustering was defined by Mojena's (1977) criterion; therefore, this number can change in each iteration. Thus, once guaranteed the Gibbs sampler chains convergence, the convergence to the globally optimal solution (the optimal clustering of which the input data should be belonged to) is also guaranteed. Nevertheless, the Gibbs sampler involves drawing random numbers from full conditional posterior distributions, and due to this, the algorithm was run considering three different sets of start values in order to verify if the clustering results were always the same after the convergence.shows a scheme of the proposed method for genes whose expression series were modeled by an AR(2) panel data model, the simplest multi parametric model. Under this framework, our main goal is that at the end of the algorithm, the resulting clusters contain series with similar gene expression patterns over time, according to the parameter estimates of the given model.
ImplementationWe implemented our program using R statistical computing environment with the computation conducted with a Intel Core 2 Duo E7500 2.0 GHz with 4 GB of RAM.
Application to simulated dataWe evaluated the proposed clustering method performance using 10 simulated datasets, each one with 117 genes divided into five clusters. The genes expression levels were generated over 10 time points using the model described in equation (1). The function arima.sim of R softwarewhere Y ik is the time series (a vector with dimension 110) of gene i (i = 1, 2,, I k ) of cluster k (k = 1, 2,, 5),  k is the intercept (average of gene expression), the term ar indicates a autoregressive process (Model 1) with parameters  1 and  2 (AR(2) process) and  2 e is the residual variance. The numbers of genes and longitudinal points were chosen taking into account the dimension of the real dataset presented in the next item, and the number of clusters (five) and the values ofwere determined in according to the results from the real data analysis that will be presented later. For example, the values assumed for  1 k in the simulation were the average values of the estimates obtained from each resulting clusteris the estimate of  1 for each gene belonging to cluster k and I k is the number of genes in the cluster k.were obtained in same way as  1 k. In order to compare the clustering method present here with a traditional clustering method, the 10 simulated datasets were also analyzed using kmeans algorithm, in which the input variables were the observed gene expression level in each time. Under this approach, given a set of time series gene expression observations:, the k-means algorithm aims to partition the 117 genes into Kso as to minimize the within-cluster sum of squares: arg min, where S j is the mean of point in S j. The choice of k-means is due to its general use in gene expression clustering (, which was computed as the ratio between the numbers of genes clustered into the true cluster (from simulation) and the total number of genes.
Application to real dataWe applied the proposed method to expressions of 117 genes that act on cell cycle of the Saccharomyces cerevisiae (). We used 10 points of the non-synchronized cells data, whose fold-change values came from the expression of mutant strains (treated) compared with wild strains (control), at each evaluated time (0, 15, 30,, 135 min). At first, the choice by nonsynchronized data was a manner to show that the proposed methodology works well for not only for highly selected datasets but also for general class of microarray datasets. For example, if a cell culture is separated out by time, and the expression of genes is measured as a function of time, one can get an idea of which genes vary in expression over time using regression models () with time as a covariate. However, considering that non-synchronized cell populations contain cells at various points in the cell cycle, under this common regression approach, the time effect can be confounded with cell cycle. By the other hand, in the autoregressive regression Model 1, the covariate is not time itself but instead is the expression levels measured at the previous time, thus avoiding the confounding between cell cycle and time. The used dataset may be downloaded at: http://smd.stanford.edu/.
RESULTS
Simulated dataPerformance of the clustering methods based on the simulated data is presented in, in which the proposed CCR in Section 2.3 was used for evaluation over 10 replicated datasets. Comparison of the approaches does show that k-means clustering performs poorly in relation to Bayesian model-based, once the CCR values were clearly lower. On average, these values were 47.5% (12.56)and 67.42% (9.44), respectively, for k-means and Bayesian model-based methods. Although the simulated dataset was generated under Model 1 assumptions, the comparison between the proposed model-based clustering (using parameter estimates as input variables) and the traditional k-means (using observed gene expression level in each time as input variables) methods makes sense. It is because there are biological justifications to dependence between a gene expression at time t and previous time, thus whether this dependence isdisregarded in the clustering process (as occurred with k-means application) really the results will not be satisfactory. We would like to make clear that the simulation study compared the clustering effectiveness of a new method, which take into account the temporal dependence of gene expression values using Ward algorithm and a traditional method, k-means, that considers the independence between these values. Maybe a more honest comparison would be realized between k-means and Ward using this same Bayesian model-base approach, but it can be a topic for future research, once the use of k-means rather than Ward requires an iterative process (k-means optimization) into each Markov Chain Monte Carlo (MCMC) iteration.
Real dataThe algorithm had a running time of 24 46 considering Gibbs sampler chains with 10 000 iterations. The chains convergence was accessed by Geweke and RafteryLewis diagnostics using boa package () of R software (R Development Core). These results indicated that the iteration number was enough to ensure the convergence, and furthermore, it was found that the number of clusters (k) and individuals belonging to them stabilized from around 1000 iterations. In addition, it is relevant to highlight that the three different sets of start values provided the same clustering output. Results allowed genes to be partitioned into five distinct clusters, with 23, 32, 15, 24 and 23 genes in each one. In general, it can be observed that the five clusters have very distinct expression patterns. Among the various differences, it can be noted that the genes that make up Clusters 1 and 2 () have opposite average behavior during the cell cycle, with observed fold-change values, respectively, for Clusters 1 and 2, negative and positive until a given time, and
Bayesian model-based clustering of temporal gene expressionA B D Cthen, after those times the signals are inverted (and D). Furthermore, genes belonging to Cluster 5 () generally showed more expression in the control (wild strains) during the cell cycle of Saccharomyces. Figures 3A, C, E and 4A and C depict the gene expression time series in each resulting cluster. The differences in the number of genes that made up each cluster may be related to the number of functions associated with the genes, i.e. clusters with a greater number of genes could be associated with a greater number of functions during the cell cycle. In summary, we can verify that the proposed methodology was able to cluster genes that share similar expression pattern over time. This similarity can be explained jointly by the magnitude of the dependence between expression at time t and the expressions at timet1timetimet1 andt2andandt2 (estimates of autoregression parameters,  1 and  2 ), by the average level of expression () and by the quality of the fitted model ( 2 e ), once these values were considered as input variables in the clustering rather than the observed gene expression values over time.
CONCLUDING REMARKSIn both simulated and real datasets, the proposed Bayesian modelbased clustering method performed very well, once allowed to cluster genes that share similar expression pattern over time. This method was based on the autoregressive panel data model, which is widely used in the econometrics field. Thus, one of the main contributions of this study is to arouse interest of bioinformatician for models from this field in order to describe the time dependence of gene expressions. For example, other powerful models like autoregressive integrated moving average and autoregressive conditional heteroskedasticity can also be considered. Furthermore, high-throughput sequencing data from time series RNA-seq assays can also be analyzed under this approach. However, because to the counting nature of these data (number of reads in a class), other distributions, such as Poisson and Negative Binomial, must be adopted in the likelihood function. With respect to inference methods, the maximum likelihood () can be used rather than Bayesian method using generalizations of the Expectation-Maximization (EM) algorithm.
Conflict of Interest: none declared.
The Author 2012. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oup.com at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
