Motivation: Due to recent advances in high-throughput technologies , data on various types of genomic annotation have accumulated. These data will be crucially helpful for elucidating the combinatorial logic of transcription. Although several approaches have been proposed for inferring cooperativity among multiple factors, most approaches are haunted by the issues of normalization and threshold values. Results: In this article, we propose a rank-based non-parametric statistical test for measuring the effects between two gene sets. This method is free from the issues of normalization and threshold value determination for gene expression values. Furthermore, we have proposed an efficient Markov chain Monte Carlo method for calculating an approximate significance value of synergy. We have applied this approach for detecting synergistic combinations of transcription factor binding motifs and histone modifications. Availability: C implementation of the method is available from
INTRODUCTIONOne of the important goals of genome biology is to unravel the transcriptional regulatory mechanism. Among various statistical approaches, one common approach is to check non-random association between gene expression patterns and the presence of various factors close to the transcription start sites of genes. Although studies have mostly been performed on the relationships between expression patterns and transcription factor binding motifs, recent advances in high-throughput technologies have made it possible to consider other genome annotations such as in vivo transcription factor binding sites [e.g. (, histone modification [e.g. (, nucleosome positioning [e.g. (and open chromatin regions [e.g. (. Among the statistical methods used for testing relationships between functional genome elements and gene expression, Gene * To whom correspondence should be addressed. Set Enrichment Analysis [GSEA; (has several merits over other statistical approaches such as the chi-squared test and Fisher's exact test. Because GSEA measures the significance of the gene set on the basis of the rank of the expression level, threshold values do not need to be set in advance for determining upregulated and downregulated genes. As discussed in, this threshold-independent property is crucially helpful because variations in expression caused by changes in the biological environment are often modest, and the list of statistically significant genes is usually difficult to reproduce if the experiments are performed in different laboratories. In addition, because GSEA has a non-parametric framework, the validity of probabilistic assumptions such as the normality of noises need not be considered. However, GSEA has one limitation. GSEA in its present form cannot be directly used to infer the combinatorial logic of multiple factors. Many biological studies have shown that gene expression in some cases is induced only when multiple factors come in place, and many pairs of transcription factors that work in synergy have been identified, such as E2F and NF-Y, TATA and CREBand estrogen receptor and FOXA1. Because of the accumulation of various types of genome annotation data, statistical methods for detecting combinations of multiple factors functioning in synergy for transcription are becoming increasingly important. Several approaches for identifying cooperativity among transcription factors have been proposed. One popular approach [e.g. (] is to screen synergistic pairs of two transcription factor binding motifs on the basis of expression coherence. If genes with both the motifs have expression patterns that are significantly coherent than those of genes with only one motif, then we can conclude that these two factors work in synergy. This approach was successfully used to identify many cooperative combinations of motifs, especially those related to cell cycle. However, it requires many types of samples for determining coherence among genes, which is not the case in general problems. Furthermore, the choice of threshold for coherence is another difficult issue. Another approach [e.g. ()] is to treat the subject as a predicting problem of gene expression from sequence motifs, and examine whether the interaction term of two factors is important. However, these approaches usually make several assumptions on probabilistic models such as the linearity of the effects of relevant factors and their interaction terms, and the validity
Y.Shiraishi et al.of assumptions are usually difficult to investigate. In addition, the choice of normalization method considerably affects the results. In this article, we propose a novel rank-based statistical test for measuring the synergistic effects of two factors. Similar to GSEA, our method just utilizes the ranked list of genes and is independent from threshold determination and normalization. First, we have newly defined a measure of synergy between two factors on the bases of ranks. Although this measure is hard to calculate when many genes are involved, we have provided an efficient approach for obtaining the approximate value by using a Markov chain Monte Carlo method.
RANK-BASED ENRICHMENT ANALYSISIn this section, we will briefly describe how the significance value for each gene set can be obtained. Here, gene sets are, for example, genes included a specific pathway or having a certain transcription factor binding motif in their promoter sequences. As discussed in, GSEA is not the only solution for determining whether the distribution of the genes included in a specific set is different from that of the genes not included in the set. Here, we have used a rather simple approach. The method introduced here is based on the intuitive idea illustrated in. When the overall expression values within a gene set tend to be significantly high or low, then that gene set is considered to have significant functions in transcription regulation. This idea is brought into shape via Wilcoxon rank-sum test, where the significance of each gene set is quantified by the gap between the obtained rank sum and the expected rank sum under the null hypothesis. Suppose we have gene the expression profile of N genes and the target gene set. By ordering genes according to the absolute expression level or the amount of change after treatment, we can obtain a set of ranks for the gene set, which is denoted by Q * {1, ,N}. The number of the set Q * is denoted by |Q * |, and the rank sum for the set Q * is denoted byFor example, in the case of gene set 1 in, Q * ={3,9,16,25,30,36,37,42}, |Q * |=8 and S(Q * ) = 198. The significance of the target gene set, T (Q * ), is obtained by normalizing the rank sum aswhereThis approach takes advantage of the fact that the rank sum is asymptotically normally distributed, i.e. T (Q * )  N(0,1), under the hypothesis that the rank of each gene in the gene set is uniformly distributed. The significance values of gene sets correspond to observation values from the standard normal distribution. Therefore, we can easily obtain the corresponding P-value from the significance value by consulting percentile tables [e.g. T (Q * ) = 3 is converted to 0.0027 in. Furthermore, unlike other methods such as Fisher's exact test, it is not necessary to decide the threshold value in this method. This approach takes the variation pattern of entire genes into account, and thus, this method has higher statistical power even in experimental conditions where the gene expression level shows only modest changes.
NEW DEFINITION OF RANK-BASED SYNERGY BETWEEN TWO GENE SETSIn this subsection, we will give a definition of synergy on the basis of the rank-based enrichment analysis method described in the previous section.
How can synergy be defined on the basis of the rank sets ?Examples of the configurations of the ranked gene list in two gene sets is described in. Using these illustrative examples, let us determine in which case a synergistic effect exists between two gene sets. First, the bias of genes belonging to both gene sets can be considered as an appropriate measure for the significance of synergy. In Case 1, there seems to be no synergy between gene sets 1 and 2, because no bias is observed in the genes within the common sets. In contrast, because the intersection of two gene sets has a significant upward bias in Case 2, there seems to be a cooperative effect between the gene sets. Second, and more importantly, the bias of each gene set has to be taken into account for determining whether or not the bias of the common set is significant. In Case 3, the common set is biased upward. However, this bias is not surprising because two gene sets are already biased, and therefore, we cannot say that there is a synergistic effect.
Definition of rank-based synergyWe adopt the rank sum of the intersection of two gene sets as the test statistics. Then, the reference distribution of the test statisticstaking into account the bias of each gene setis necessary. The approach taken in this article is to list all the configurations where the biases of gene sets 1 and 2 are the same as those of the target configuration (the bias of each gene set is measured again using the rank sum), and collect the rank sum of the common sets for each configuration as an element from the reference distribution. An
A rank-based statistical test for measuring synergistic effects between two gene sets,...,N} 2 {1,...,N} denote the rank set pair of the target. In the case of,7},{2,5}). The concrete procedure for calculating the amount of synergy between gene sets 1 and 2 is as follows:(1) List all the configurations (Q 1 ,Q 2 )  2 {1,...,N} 2 {1,...,N} that satisfy the following requirements:@BULLET The cardinality of the intersection of two gene sets is the same as that for the target configuration. Therefore,The family of rank set pairs satisfying the above conditions is represented as(2) Construct the histogram of the rank sum of the intersection of two gene sets S(Q 1 Q 2 ) from all the configurations listed above.(3) The P-value of the target configuration is the ratio of the number of configurations for which the rank sum of the intersection is smaller than that of the target, among all the configurations satisfying the conditions above. ThereforeIn fact, the number of configurations meeting the conditions exponentially increases with increase in the number of genes, and thus, it is not possible to list all the configurations. Therefore, we need to resort to a sampling approach from the population so that an approximate distribution of the rank sum can be obtained.
SAMPLING CONFIGURATIONS VIA MARKOV CHAIN MONTE CARLO METHODIn this section, we provide an approach for uniformly sampling the rank set pairs included in the family C(Q * 1 ,Q * 2 ). Let  denote the uniform distribution. Since, this is a sampling problem under considerably complex conditions, we use an approach based on Markov Chain Monte Carlo methods. Here, we introduce a simple MetropolisHastings Markov chain () whose stationary distribution is . Suppose we have a rank set pair (Q) is stochastically determined by the following rule:2 randomly for updating. In what follows, we assume that Q2 is easily derived by slightly changing notations.(3) List the set of integers{q a c,q b +c}. Select one integer c randomly from the above set.2 ). The above updating rule is illustrated in. The following proposition guarantees that each sequential output2 ) of the chain constructed above is asymptotically a sample from the target distribution .Proof. Because the chain is MetropolisHastings Markov Chain, it is only necessary to prove that the chain is irreducible and aperiodic [e.g. the Theorem 7.4 in. Aperiodicity holds because the chain can remain in the same state.In fact, the Markov chain proposed in this section slightly compromises theoretical validity. In rare cases where the set of ranks is densely populated, irreducibility, which means that the Markov chain can traverse all the, does not always hold; thus, the outputs obtained from the above procedure may lead to inaccurate P-value estimates. In such cases, more complicated updating rules are required. However, in most practical cases, we can obtain samples uniformly fromSince the description of a Markov chain with a rigorous guarantee is rather technical, we have included it in Supplemental Material. In the statistical community, Markov chain Monte Carlo approach has been extensively used for sampling distributions of test statistics in various settings [(. However, most approaches focuses on contingency tables, and our approach can shed new light on the field of Monte Carlo statistical test.
NUMERICAL EXPERIMENTS ON SYNTHETIC DATAIn this section, we will evaluate the following issues through a comparison study of numerical experiments.(1) The behavior of the proposed method under null hypotheses.
Page: 2402 23992405
Y.Shiraishi et al.(2) The effectiveness of the proposed method compared with that of other methods.
Generative modelsWe use two probabilistic models. The common platform is the following equation:where i = 1,...,N is the index of genes, y i is the expression level of the i-th gene and U(a,b) is the uniform distribution with support. Suppose that each gene is a member of none, either or both two gene sets and x i,j = 1 the i-th gene is a member of the gene set j 0 the i-th gene is not a member of the gene set j ,for j = 1,2. The difference between the two models is the generative mechanisms of z i ,{0,1}. In the first model, z i is generated independent identically for all i as follows:Pr(z i = 1) = 0.6 x i,1 = 1 0.5 otherwise . Since x i,2 does not influence the expression, there is no synergy between two gene sets in this model. For the second model, we adopt the following rule:
Behavior of the proposed method under null hypothesesWe investigated the behavior of the P-value obtained using our approach for the first model. For each trial, we randomly generated the dataset {x i,1 ,x i,2 ,y i } 1iN and obtained the p-value via the proposed method. In this study, x i,1 and x i,2 were generated according to Bernoulli trial with probability 0.2; x i,1 and x i,2 become 1 with probability 0.2 for each i independently. We performed this trial for 10 000 times.shows that the P-values are distributed nearly uniformly, Thus, the P-value obtained via our approach reflects the extremeness in an appropriate manner under a null hypothesis.
Comparison to other methodsFor data generated by the second model, the power of the proposed approach was compared to a basic likelihood-ratio test. For the likelihood-ratio test, we preprocessed the expression values in several ways (taking logarithms, assigning ranks in decreasing order and using unchanged values). We checked the significance of the interaction term in two-way analysis of variance models, which was performed classically for seeing a synergistic effect. SeeSupplementary Material for the detailed models of the likelihoodratio test. We generated the dataset as described in the previous subsection and performed both tests 10 000 times. The results are shown in. Our method has stronger statistical power compared to likelihood-ratio tests in this example. This may be because the likelihood-ratio test assumes a model that differs from reality. In contrast, the proposed approach is non-parametric and has no assumption of probabilistic models. Likelihood-ratio tests greatly depend on the choice of normalization methods. The number of true positives decreased when performing the likelihood-ratio test with unchanged values. However, since the proposed approach is just designed for rankbased values, normalization methods need not be considered. Although many sophisticated approaches using probabilistic models have been proposed, the above observation clearly shows that their results are heavily influenced by the choice of normalization methods.
APPLICATION TO BIOLOGICAL DATA
Combinatorial effects of sequence motifs in a breast cancer cellIn many types of breast cancer, malfunction of the estrogen receptor (ER) often leads to aberrations in downstream transcriptional machinery and subsequent several biological processes such as the cell cycle and apoptosis. Therefore, studying the estrogen triggered transcriptional mechanism is crucially important. In this article, we applied our method to gene expression data for MCF-7 (estrogen receptor-positive human breast cancer cell line) stimulated via 17estradiol (E2, one of the most common forms of estrogen). The data we used are available at Gene Expression Omnibus (GEO, accession number GSE8597). Using transcription factor binding motifs as gene sets, we tried to identify pairs of synergistically working transcriptional factors.. Pairs of motifs that are estimated to have synergistic effects
Page: 2403 23992405
A rank-based statistical test for measuring synergistic effects between two gene sets
Experimental methodologyThe information on transcription start sites and sequence motifs was extracted from the UCSC Genome Browser (hg18) RefSeq Gene track and transcription factor binding site (TFBS) conserved track, respectively. For each gene, we checked whether the corresponding promoter sequence covering 1000 bp upstream and 1000 bp downstream included each TFBS motif. For genes that had multiple promoter sequences, concatenated sequences were used. Next, the gene set for each motif was determined as the set of genes that have at least one in their promoter sequences. To avoid the redundancy of multiple probe set IDs, the probe set ID whose expression profile had the maximum variance was associated for each gene. We calculated t-statistics for each gene by measuring the difference between the expression levels of samples collected 24 h after treatment and control samples. Gene are ranked in descending order of t-statistics.
ResultsFirst, using the method described in Section 2, we extracted the 42 gene sets whose enrichment score was positive (Supplementary). After filtering the pairs whose common sets include <20 genes (|Q * 1 Q * 2 | < 20) for a robust inference, we measured the synergistic effect of each combination of these gene sets by using the proposed method. Then, to account for multiple hypothesis testing, false discovery rate (FDR) q-values are calculated (Supplementary Material for the detailed procedure). The significant synergistic combinations are listed in. E2F and NF-Y, whose cooperativity have been verified in many published studies, are reported to be highly synergistic. Although the single effects of these motifs are already significant, their cooperativity provides additional benefits (). Furthermore, the motifs for E2F and NF-Y were also enriched in upregulated genes in tumor samples from patients with breast cancer (). These observations confirms that the combinatorial functions of these two transcription factors are closely related to transcription mechanism in breast cancer.
Combinatorial effects of modificationsHistone tail modifications such as methylation, acetylation and phosphorylation play an important role in chromatin structure. Although combinations of histone modifications are considered to play a role in chromatinDNA interactions and subsequent gene expression [(, the precise mechanisms underlying this involvement remain unclear. Using the data for 39 histone modification in human CD4+ T cell () as gene sets, we tried to detect the pairs of synergistic histone modifications.
Experimental methodology Summary BEDfiles of histone methylation and acetylation data were obtained from http://dir.nhlbi.nih.gov/papers/lmi/epigenomes/hgtcell.aspx and http://dir.nhlbi.nih.gov/papers/lmi/epigenomes/hgtcellacetylation .aspx. Information on the transcription start site and promoter of each gene was obtained as described in the previous subsection. Histone modifications on each gene were identified by the same way as (). The modification on a promoter was deemed significant when the tag count exceeded a threshold, which was determined by a P-value of 10 7 under the Poisson distribution fitted to the genome-wide tag density. Then, the gene set for each modification was obtained as the set of genes that have the Page: 2404 23992405
Y.Shiraishi et al.corresponding modification pattern in their promoter sequences. Gene expression values for CD4+ T cells were obtained from the BioGPS atlas (http://biogps.gnf.org/downloads/). Filtering pairs whose common set includes <20 genes and FDR q-value calculation were performed as described in the previous subsection.Asterisks are marked on modifications belonging to the backbone module reported in a previous study (). show anti-synergistic effects. Since the information that the gene is associated with an additional modification does not aid in expecting higher expression within this set, we call this set as the 'redundant effect set'. On the other hand, some modifications such as H2AK5ac and H3R2me1 seem to have synergistic effects with several members in the redundant effect set (). The 'backbone' module consisting of 17 modifications was identified in a previous study (). These modifications tend to colocalize, and the genes associated with this module tend to have higher expression than others. The redundant effect set includes most members of the backbone module. This overlap can be explained as follows: since modifications within the backbone module are highly correlated with each other, it is hypothesized that there exists a latent factor that is responsible for simultaneous modifications within the backbone module and subsequent gene expression. One modification in the backbone module is highly a predictive indicator for the activation of that factor, and additional information on other modifications may be redundant. Furthermore, the fact that H2AK5ac and H3R2me1 synergize with different members of the redundant effect set suggests the existence of more complicated machinery in the backbone module.
Results Estimated P-values
DISCUSSIONIn this article, we proposed a novel non-parametric framework for measuring the synergy between two gene sets. The choice of normalization method and threshold values are issues that need not be considered for this approach. Application to sequence motifs and histone modifications data implies that our method is helpful for unraveling the gene expression mechanisms. However, our approach still has several limitations. First, we did not take into account the positional relationships between two factors in this study. Several studies have reported the importance of positional relationships [e.g. ()], therefore, methods that can use this information should be devised. Second, although this is not just confined to our approach, identifying gene sets itself is a very difficult problem. The members of gene sets
A rank-based statistical test for measuring synergistic effects between two gene setsvary greatly depending on the threshold of similarity to the position weight matrix or the number of reads collected via ChIP-Seq. We need to continue developing efficient identification methods. Furthermore, there are still a lot of things to consider about the definition of synergistic measure. Recently, using the information theoretic measure of synergy [e.g. (, a framework for identifying combinatorial rules of gene sets were proposed in () though their approach is different from that of this article because it requires a lot of samples. However, investigating theoretical relationships between the definition of synergy in this article and the information theoretic synergistic measure is an important future task. Currently, several large projects are generating a large amount of data on various functional genome elements [e.g. (. Developing statistical methods for integrative understanding of the transcription mechanism will become increasingly crucial. We believe that measuring the cooperativity of two factors is the first important step for elucidating the combinatorial logic of various functional elements, and our method will make an important contribution to solving this problem.
ACKNOWLEDGEMENTWe thank Takeshi Nagashima, Andr Fujita and Yoshiaki Tanaka for their helpful discussion and comments.
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
