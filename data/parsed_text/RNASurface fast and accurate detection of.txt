Motivation: During the past decade, new classes of non-coding RNAs (ncRNAs) and their unexpected functions were discovered. Stable secondary structure is the key feature of many non-coding RNAs. Taking into account huge amounts of genomic data, development of computational methods to survey genomes for structured RNAs remains an actual problem, especially when homologous sequences are not available for comparative analysis. Existing programs scan gen-omes with a fixed window by efficiently constructing a matrix of RNA minimum free energies. A wide range of lengths of structured RNAs necessitates the use of many different window lengths that substantially increases the output size and computational efforts. Results: In this article, we present an algorithm RNASurface to efficiently scan genomes by constructing a matrix of significance of RNA secondary structures and to identify all locally optimal structured RNA segments up to a predefined size. RNASurface significantly improves precision of identification of known ncRNA in Bacillus subtilis. Availability and implementation: RNASurface C source code is available from
INTRODUCTIONRNAs perform diverse enzymatic, regulatory and structural functions in living cells and are involved in nearly all housekeeping cellular processes. Numerous new classes of non-coding and regulatory RNAs were discovered during past decades. For example, microRNAs regulate gene expression through post-transcriptional repression of messenger RNA (). Other prominent examples include the RNA role in translation (), messenger RNA localization (), alternative splicing (), epigenetic states (), virus replication () and so forth. Moreover, according to recent studies of the human genome, up to 90% of the genome may be transcribed, and a substantial fraction of transcripts may represent functional non-coding RNAs (). Biological function of the majority of functional RNAs crucially depends on its tertiary structure. RNA molecules fold hierarchically and sequentially, therefore the tertiary structure is largely determined by the secondary structure scaffold (). For example, riboswitches regulate gene expression by switching between two specific secondary structures (). There exist numerous methods to predict secondary structure computationally (for a review see), among which free energy minimization () based on nearest neighbor thermodynamic parameters () is the most prevalent approach. Generally, RNA sequences have numerous suboptimal structures, which have energies close to the optimal one (). In addition to this, inaccuracies of the energy parameters, base modifications and dependence on cell conditions yield a moderate quality of the structure prediction by energy minimization with the average sensitivity of 75% and selectivity of 79% (). However, the optimal energy could be a good measure to define propensity of a sequence to fold in a stable structure, the minimum free energy (MFE) of functional RNAs can be distinguished from that of random sequences (). On the other hand, there exist RNA regions actively bound by protein factors. Relatively low MFE, due to selection against formation of stable secondary structure, may represent a signal of an accessible site (). Structural potential of an RNA sequence reflects significance of its secondary structure MFE. Next-generation sequencing technologies produce vast amounts of genomic data. Hence, identification in genomes of segments with unusual structural potential is of special interest. This problem has two sides: to efficiently scan genomes and to assess significance of output hits. There are several programs that efficiently scan genomes. RNALL () and RNAslider () use a window-based approach to calculate the MFE and structure of each local sequence of a predefined size. RNALfold () slightly diminishes the output size by considering only structures with paired first and last nucleotides, so-called closed structures. These programs focus on efficient computing and ignore significance of output hits. The only discriminator in these programs is MFE. However, MFE strongly depends on the length and dinucleotide composition of a sequence (). Comprehensive comparison of RNA structure scores (shows that *To whom correspondence should be addressed.  The Author 2013. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com Z-score () can be used as a suitable measure of the structural potential. The Z-score of a sequence is calculated aswhere E is the MFE of a biological sequence, and are the average and standard deviation of the energy distribution of shuffled sequences with preserved length and average dinucleotide composition. There also exists a less common approach, which uses uniqueness of secondary structure instead of thermodynamic stability to assess its significance (). An early attempt to detect significant structures was based on a Monte Carlo simulation (). This approach becomes impractical for sequences of moderate (several thousand of nucleotides) size. Further studies introduced look-up tables to eliminate bias of nucleotide composition, combined with regression on sequence length () or the notion of asymptotic Z-score (). The current stateof-the-art program RNALfoldz () extends RNALfold by calculating Z-score using SVR. To our knowledge, the implementation of RNALfoldz is now embedded in RNALfold. Approaches, that analyze RNA segments of a fixed size, suffer from an inability to detect structured elements of varying sizes, whereas functional RNAs fall into a wide range of sizes. Here, we circumvent this limitation. To that end, we define the surface of the structural potential as the surface of Z-scores for all genome subsequences shorter than a predefined size.visualizes this concept. The line at the bottom represents a segment of the genome, each point on the heatmap represents a subsequence and color represents structural potential of this subsequence (from highly structured dark blue to highly nonstructured dark red). We introduce the program RNASurface that efficiently reconstructs the surface of structural potential using a new fast algorithm for Z-score evaluation. This approach introduces an intuitively clear definition of locally optimal segments as peaks in the surface of structural potential. Besides identification of structured regions, the surface usage allows one to identify structured domains comprising the region. We apply our method to the genome of Bacillus subtilis and identify genome regions with high structural potential. A highly accurate determination of structured intervals or regions of accessibility is useful for several purposes: preprocessing during de novo search for regulatory and noncoding RNAs; accurate definition of ncRNA boundaries; and correlation of genome-scale structural potential with other genomic features (gene boundaries, ribosome profiling, transcriptome data, binding sites of protein factors etc.).
METHODS
Surface of structural potential and definition of locally optimal sequenceGiven a sequence S, S ij denotes a subsequence from position i to position j and E ij  ES ij  denotes its MFE. MFE calculation of S uses a dynamic programming algorithm. The optimal score E ij is defined recursively through optimal scores of shorter subsequences by the Zuker algorithm () and is stored in the MFE matrix. This property of dynamic programming allows the algorithm to obtain and store optimal energies of each subsequence of S. Further, Z-score Z ij of each subsequence S ij is estimated based on a fast Z-score evaluation procedure and is stored in the Z-score matrix. Given a genome of size N, the upper bound L and the lower bound m of possible RNA sequence length, the surface of structural potential is defined as a trapezoid-shaped part of the Z-score matrix fZ ij  E ij  l l j l  j  i  1, m l Lg  2Parameters l and l also depend on the dinucleotide content, this point is addressed later in the text (Sections 2.2.1 and 2.2.3). The MFE is a negative value, therefore more structured sequences have smaller Z-scores. A sequence is called locally optimal if small changes in its boundary coordinates only increase Z-score. Such sequences correspond to local surface peaks. Formally, S is called k-locally optimal, if and only if 8S 0 : jS 0Parameter k is interpreted as the amplitude of boundary changes. Increasing k leads to more global surface peaks and substantially reduces output size, but also causes skipping of subtle local peaks. Thus, k controls the relation between boundary accuracy and output size. Efficient construction of the surface is discussed in Section 2.4, whereas Sections 2.2 and 2.3 describe preprocessing required for Z-score estimation and inference of surface properties, respectively. Minor changes in the above definitions convert the problem to a form useful for the analysis of accessibility regions instead of structured regions. However, the methods described later in the text concern the analysis of structured regions.
Z-score estimationReconstruction of the structural potential surface requires developing a new strategy to Z-score estimation, as previous approaches are timeexpensive. Among various measures, Z-score best reflects the structural potential (). The Z-score of an RNA sequence is calculated for energies of simulated sequences of the same length and average dinucleotide frequencies. Stacking interactions contribute most to the free energy formation; therefore simulations that preserve dinucleotide composition and possible stacking are of major importance (). Among various approaches to efficient evaluation of parameters and required for calculation of Z-score, RNAz 2.0 () support vector regression (SVR) is considered to be the most efficient one. It uses several thousand support vectors with a radial kernel. In our case, surface construction requires $ NL 2 evaluations of Z-scores, where N is the genome length and L is the upper bound of a possible RNA length. SVR requires operations on thousands of support vectors to estimate each point. Therefore, it becomes a bottleneck of the algorithm. Instead, we use quadratic regression to fit the dependence of and on the dinucleotide composition. While preserving the quality of the approximation, this regression allows for fast recursive recalculation of parameters. Thus, although previous approaches focused on short L up to several hundred nucleotides, we can expand the segment length up to thousands of nucleotides.
Generalizationof the segment dinucleotide content To estimate parameters of the MFE background distribution ( and ) of a target RNA segment, common practice is to use random sequences having the same average dinucleotide content as the target segment. In case of a functional ncRNA, structural constrains may influence its dinucleotide content (). Hence, bias of a dinucleotide content of a segment compared with its genomic background may be a consequence of selection on the secondary structure and represents an additional genomic signature (). We simulate sequences having the same dinucleotide content as the local genomic context of the target segment using the 1-order Markov model. We define genomic context of a segment S ij as a region S i0j0 of size d containing the segment with its flanking sequences S i0i and S jj0. The size d of a genomic context is recommended to be sufficiently large compared with the window size L to obtain a robust estimation of background dinucleotide frequencies. Z-score of a segment is estimated using the dinucleotide content of its genomic context. If a segment size exceeds d, then its genomic context is the segment itself. Thus, option d  0 permits one to return to common practice without considering genomic background.
Approximation by sequence length The Z-score formula (2)contains the mean and standard deviation, which are dependent on sequence length l, thus estimation of these dependencies becomes central for the algorithmic complexity. Functions l and l denote the mean and standard deviation of the energy distribution for a fixed average dinucleotide composition and variable length l. Earlier it has been observed () and then proved () that l is asymptotically linear. Here, we performed extensive simulations up to sequence length of 4000 nt and found that at moderate length intervals, l is linear and l perfectly fits as the root of length (). To overcome approximation inaccuracy for large lengths, we fix 11 control lengths in the range from 60 to 1200 nt and linearly approximate l and 2 l for intermediate control lengths (for details see Supplementary Material S1).
Quadratic regression of the dinucleotide space For each of11 control lengths, we apply quadratic regression to estimate the dependence of parameters on the dinucleotide composition. Following RNAz 2.0 (), we constrain analysis to sequences of G  C content and G=G  C, A=A  T ratios ranging from 0.2 to 0.8 (the set of such sequences is denoted by ). Gruber et al. found that $99% of the human ENCODE genome belongs to  and thus  covers nearly all functional elements. We further grid sequence region  on 27 subregions ( 1 ,. .. ,
Quality of approximation We chose 24 000 random sequenceswith length ranging from 60 to 2400 nt from the human and Drosophila genomes (Supplementary). We compared Z-scores of these sequences obtained by our approximation and by sampling (2000 sequences with preserved average dinucleotide frequencies were sampled to estimate Z-score). Approximation and direct calculation show excellent concordance with R 2  0.997 (Supplementary). The concordance remains high for lengths up to 2400 nt (Supplementary). The average error of Z-score is 0.1. Moreover, the average error for small sequences (up to 250 nt) falls to 0.041, comparable with 0.076 of the SVR approach.
Inference surface properties
Smoothing the surfaceThe surface of the structural potential is rugged in particular due to errors in Z-score estimation and experimental errors in measurement of thermodynamics parameters () and intrinsic properties of the RNA folding landscape (). Thus, significant secondary structure in a genome corresponds to many adjacent surface peaks, although only one peak is informative. We smooth the surface with an exponential kernel to emphasize one or few peaks among clusters of adjacent peaks and as a result to reduce the output size. The distance between two genome intervals (i, j) and (k, l) is defined as follows:di, j, k, l  ji  kj  jj  lj Each surface position Z ij is smoothed by taking into account only positions Z kl at the distance di, j, k, l not exceeding a predefined parameter s with the weight e di, j, k, l .The surface smoothed at s nucleotides Z s ij is derived from Z ij as follows:where C s  P di, j, k, l s e di, j, k, l is the total weight of positions adjacent to Z ij at a distance less than s. Larger s leads to a smoother surface. Discussion on selection of parameter and effective recursive calculation of the smoothed surface can be found in Supplementary Material S3.
One-dimensional plots Genome-wide analysis and correlationof biological features require simple and convenient representation and visualization of biological information, which is difficult to achieve with the 2D surface of the structural potential. Thus, based on the surface, we introduce two 1D measures, which are less informative compared with the surface, but easier to interpret and to correlate with various genome features. The maximum squared Z-score (MZ) of a position is the maximum of squared Z-score among all sequences covering this position for sequence lengths not exceeding a threshold L:where I is the indicator function. The plot of MZ(i) is shown in the top panel of. Another measure reflects the density of locally optimal sequences w i at each genome position i and may be used to discriminate islands of locally optimal sequence fragments:where w is the maximum distance between position i and the center of a locally optimal sequence fragment. RNASurface program implements efficient calculation of aforementioned measures. Application of plots to 100 kb region of B.subtilis is discussed in Supplementary Materials S7.
AlgorithmGiven a genome S of size N and window L, RNASurface uses program RNAslider () that efficiently calculates MFE for each subsequence with length up to L. This program applies a sparsification technique () that speeds up the algorithm to $ NL. Given a segment S ij , ff k g is a vector of dinucleotide frequencies of its genomic context S i0j0 (Section 2.2.1). Parameter S ij  is estimated by quadratic regression (Section 2.2.3):where fc kl g are the coefficients of the quadratic regression. Vectors of dinucleotide frequencies of genomic context differ by only two components between S ij and a shifted segment S i1, j1 : S i0, i01 and S j0, j01. Thus one can define a recursion based on (3). The same equations hold for the standard deviation S ij . The recursion relations allow for fast recalculation of parameters. Given MFE and parameters, one can estimate Z-score immediately. Additional smoothing of the Z-score surface is implemented in time $ Ns, where s is the smoothing parameter defined earlier in the text (for details see Supplementary Material S3). Further detection of peaks within the Z-score matrix is carried out by direct comparison of each matrix cell with adjacent cells.
RESULTSWe analyzed the genome of B.subtilis to benchmark the programs and to study regions of structure accumulation. This gram positive bacterium has numerous cis-acting regulatory RNAs and small RNAs. In addition, widespread rho-independent transcription termination () and non-random prevalence of stem-loops structures () make B.subtilis an object of specific research interest.
Performance comparisonTherelength(). Functional RNAs are more stable than random decoys. Thus, one expects that an energy-based program would discriminate them to some extent. To our knowledge, RNALfoldz is the only currently available program that scans genomes for significant RNA secondary structure using statistical information. We compare the quality of discrimination of RNASurface and RNALfoldz, whose outputs are lists of candidates. To accept a candidate as a true prediction, we assess the degree of overlap by the Jaccard measure. The Jaccard measure of two sequences S 1 and S 2 is defined as follows:A known functional RNA was considered as correctly predicted if there was an intersecting candidate sequence with the Jaccard measure of at least 75%. Nearly all functional RNAs in B.subtilis are 5250 nt, thus we set the upper length L  250 and the lower length m  50. The results of programs comparison are presented as a Receiver-Operating Characteristic curve and the sensitivity versus positive predictive value (PPV) plot in. Sensitivity, false-positive rate (FPR) and PPV are defined as follows:PPV  TP=predicted positive FPR  FP=all negative sensitivity  TP=all positive where TP is true positive and FP is false positive. To calculate the FPR one has to know the true negative (TN), whereas it is not clear how to identify and count non-functional RNA. Thus, we consider TN to be huge compared with TP and estimate TN by the genome length. RNASurface detects structural potential of functional RNA significantly better than RNALfoldz, especially at small FPR. Moreover, short RNASurface predictions are robust to increasing window size, whereas RNALfoldz predictions are gradually lost (Supplementary). The length of the majority of annotated RNA elements (87%) is less than 150nt. This decreases the prediction accuracy of RNALfoldz on substantially larger windows. A possible explanation is that the probability of the optimal structure or the base pair decreases with nucleotide distance () and obeys the zetapolymer property (), which influence the prediction quality of closed structure and thus the quality of RNALfoldz predictions. On the other hand, RNASurface relies on the Z-score matrix that does not change for smaller length with increasing nucleotide distance. The complexity of functional structures in genomes varies from simple small hairpins to complicated multidomain structures. We compared the discrimination ability of the programs with respect to the structure complexity. Rho-independent terminators were selected as a widespread example of simple functional hairpins. We used 42000 terminators predicted with accuracy of $94% (). Riboswitches and T-boxes were selected as examples of complex structures. RNASurface identifies complex structures better than RNALfoldz (Supplementary). Moreover, RNASurface identifies complex structures better than simple ones (Supplementary). In contrast to complex structures, terminators were discriminated weakly by both programs (Supplementary). To confirm the aforementioned observation about influence of the structure complexity on performance, we classified non-coding (cis-regulatory) RNAs from Rfam by the number of stems comprising their structures (Supplementary Materials S5). The prediction accuracy of RNASurface improves with increasing number of stems in the structure and does not exceed the RNALfoldz performance for only simple hairpin structures (Supplementary). Complex structures often are not closed and are composed of several closed substructures, thus to interpret the results for closed structures, RNALfoldz output could benefit from additional post-processing.
Structural potential of ncRNAs and genomic regions in B.subtilisWe estimate the structural potential for different non-coding RNA classes: riboswitches, T-boxes, ribosomal protein leader).illustrates results for varying Z-score thresholds. Strict Z-score threshold of 3 demonstrate moderate rRNA (15%) and tRNA (16%) structural potential compared with cis-acting regulatory RNAs (3369%) and small RNAs (54%). Regulatory RNAs are located in specific regions of genomes due to their function. For example, some prokaryotes rely on RNA hairpin formation to terminate transcription and thus have numerous RNA secondary structures with high structural potential downstream of genes (). On the other hand, structures regulating transcription and translation (riboswitches, T-boxes, attenuators) occur primarily upstream of genes. We performed analysis of hits abundance in coding regions, intercoding regions and regions upstream and downstream of genes. Upstream regions were defined as segments from 200 to 50 nt from the start codons, downstream regions were defined as segments from 50 to 150 nt from the stop codons and intercoding regions were defined as segments between two coding regions. To estimate the abundance of structured RNAs in genome regions, we consider a background model, when predictions are distributed uniformly throughout the genome. The observed number of predictions was compared with the expected number of predictions in the background model (). A considerable overrepresentation of significant structures was observed upstream and downstream of genes. This result may be partially explained by the existence of numerous cis-regulatory RNAs and rho-independent terminators in B.subtilis, some of which show high structural potential according to RNASurface predictions (predictions of 200 cis-regulatory RNAs and 434 terminators have Z-score less than 2). Strong 12-fold enrichment in the intercoding regions is partially explained by enrichment in the upstream and downstream regions, but excluding upstream and downstream regions still retains 44-fold enrichment. This can potentially be induced by small non-coding RNAs (). Few hits were found in the coding regions, although these regions also show signs of selection toward secondary structures (). Methodology of Z-score estimation does not include codonusage statistics, which could produce additional selection on RNA secondary structure in coding regions (). Thus, our results could underestimate the structural potential of coding regions. However, accurate dissection of selection on protein-coding and structural properties of a coding sequence requires extensive simulations () or usage of homologous sequences ().
Time and space requirementRNASurface requires ONL  s time. Practically, time performance of RNASurface was compared with RNAslider and RNALfold. The B.subtilis genome was taken as an input sequence. Execution time as a function of window length up to 600 showed similar results for RNASurface and RNAslider, and several-fold less than for RNALfold (Supplementary). Additional parameters of RNASurface were fixed at the following values: dinculeotide frame d  600, smoothing parameter s  1 and locally optimal parameter l  1. Varying parameters yielded up to 3-fold time increase for d (d  0; L  100, 300), 2-fold time increase for s (s  10; L  100, 300) and no increase in time for l in worst cases (l ! 15; L  100, 300). RNASurface requires OL 2  memory.Here, we define and calculate the surface of structural potential. This yields a new definition of locally optimal sequence regions as peaks in this surface. We also introduce several one-dimensional measures that reflect unusually structured regions. An efficient method of surface construction has been implemented in the program RNASurface that uses a novel approach to estimating the significance of RNA secondary structure. RNASurface has the same time requirements as well-known scanning programs that search for secondary structures (RNALfold and RNAslider). We also have implemented a web server that provides visualization tools to explore the surface of structural potential, the detailed description of service capabilities will be reported elsewhere. Application to B.subtilis demonstrated better abilities of RNASurface to discriminate known structured RNAs from random regions. Moreover, we showed that the regions upstream and downstream of genes are significantly enriched in structured motifs. Thus, surface exploration by RNASurface can bring new understanding of structured patterns in genomes.
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
R.A.Soldatov et al. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
RNASurface at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
