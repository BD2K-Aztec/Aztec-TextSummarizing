Motivation: The Hi-C technology was designed to decode the three-dimensional conformation of the genome. Despite progress towards more and more accurate contact maps, several systematic biases have been demonstrated to affect the resulting data matrix. Here we report a new source of bias that can arise in tumor Hi-C data, which is related to the copy number of genomic DNA. To address this bias, we designed a chromosome-adjusted iterative correction method called caICB. Our caICB correction method leads to significant improvements when compared to the original iterative correction in terms of eliminating copy number bias. Availability: The method is available at https://bitbucket.org/mthjwu/hicapp.
IntroductionOur knowledge of the higher-order structure of the genome has rapidly expanded over the last decade with the development of several methods able to elucidate the non-linear spatial conformation of the genome (). One important contribution was the development of a chromatin conformation capture (3C)-based method called Hi-C (), which enables high-throughput analysis of spatial structures of chromatin. Recent improvements of the Hi-C protocol led to a characterization of chromatin structure from many species at increased resolution (), from the original 1Mb map () to the most recent 1Kb map (). Increasing effort has since been devoted to studies of the biological function and consequences of the 3D chromatin architecture, such as its role in promoter-enhancer regulation () and associations between chromatin conformation and DNA replication timing () as well as local mutation rates (). Hi-C data at different resolutions may enable researchers to infer different levels of genomic interactions; for instance, a 1Mb resolution elucidates the overall folding principles of chromosomes, which were found to be consistent among different cell types within each species (); a 50-100Kb resolution provides chromosome domain information which is associated with histone marks (; and a 1kb10kb resolution enables detailed studies of chromatin looping, such as enhancer-promoter or enhancer-enhancer interactions, which can be specific to different cell types (). Raw Hi-C data has been observed to have both technical and biological biases (), with three predominant sources of bias identified so far: fragment length, GC bias and mappability. To correct for these biases, many software packages have been developed in order to generate an unbiased interaction map (). Hicpipe () and hicnorm () are explicit correction methods which fit probabilistic and regression models, respectively, to normalize the raw Hi-C map. These approaches require a priori knowledge of the biases. Another method, used in software such as Hiclib () and HiCorrector (), performs an iterative correction (IC), which does not require a priori knowledge of the biases. Such methods use a matrix balancing or scaling algorithm () to iteratively correct for all possible biases, based on the assumption that all loci should have equal representation in the data if there is no bias. IC-based methods generate a bias vector defined as IC bias (ICB, denoted as B below) that converts the raw matrix (R) to a normalized matrix (Nij = BiBjRij in which i and j represent two genomic loci). Because of ease of application and high running speed, easy transformation between the raw and normalized matrices and no requirement of the explicit information on biases, IC-based methods (also called ICB correction) have become the most widely used Hi-C normalization approaches that can correct for both known and unknown biases in many current applications (). A novel source of bias that can arise in Hi-C data is related to the copy number of genomic material. This type of bias has so far been unaccounted for since most Hi-C applications investigate normal tissue and healthy cell line samples, which have mostly uniform copy numbers of chromosomes. However, once tumor samples are analyzed, biases related to copy number alterations become important and need to be corrected for in order to obtain an accurate view of the interaction map between genomic locations. So far, limited Hi-C experiments have been carried out on tumor samples (Associate Editor: Dr. John Hancock  The Author (2016). Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oup.com). For a genome with non-uniform copy number, such as that of tumor cells, DNA copy number variation can introduce critical bias in Hi-C data because genomic locations with a higher copy number have a greater chance to be sequenced in the Hi-C protocol, and genomic locations with low copy number might not be detected at all in Hi-C data. We first identified the bias caused by DNA copy number by analyzing the ENCODE K562 Hi-C data (). Surprisingly, we found that the copy number bias still existed after within-chromosome ICB correction (). Further analyses demonstrated that the ICB method can correct for copy number biases within each chromosome but not between chromosomes, which also cannot be adjusted for simply by using total or average contact counts of chromosomes. By utilizing the count-distance curve between the contact counts and the genomic distance between the contact pairs, we converted the problem of removing the biases across chromosomes to the problem of minimizing the differences across count-distance curves of different chromosomes. We thus designed a linear regression-based chromosome-level adjustment method called caICB, which is based on the ICB protocol, to correct for this bias. We performed the analyses on multiple resolution contact maps (1Mb, 250Kb, 100Kb and 10Kb) and found that the performance of our caICB correction is significantly better than the original ICB method in terms of correcting for copy number biases. Our analyses show that the three previously identified bias factors are also accurately corrected for by caICB. Furthermore, the caICB correction is robust when using a small subset of genomic ranges instead of using the whole genome contact map, and is easy and fast to apply even for extremely high-resolution maps. Our method does not require copy number data for the samples for which Hi-C data is available, and has the potential to adjust for other biases in Hi-C data without a priori knowledge.
MethodsWe evaluated copy number as well as fragment length, GC content and mappability biases in Hi-C data of the K562 cancer cell line. The raw contact counts in 1Mb, 250Kb, 100Kb and 10Kb resolution Hi-C maps were obtained from GEO with accession number GSE63525 (). The maps had already been pre-processed to remove experimental artifacts. The Iterative Correction Bias (ICB) was then determined using HiCorrector () for 30 iterations within each chromosome. Different subsets of genomic ranges were considered to study the bias effects in K562 Hi-C data (). We also applied our method to MCF7 Hi-C data () for 1Mb and 250Kb resolutions. The raw fastq files were downloaded from GEO with accession number GSE66733 (). HiCup () was used to pre-process the data to remove experimental artifacts, which resulted in interaction maps with 1Mb and 250Kb resolution. The subsequent processing steps were the same as above.
Spline modelA significant drop in contact counts was observed with increasing genomic distance between two loci of the same chromosome in all published Hi-C datasets. Because of the different Hi-C protocol settings, it is difficult to identify a single function that can capture the relationship between contact counts and genomic distance (). Thus, in previous studies (), local regression methods such as loess or spline were employed to capture this relationship. In our analysis, we used spline implemented as the R function " smooth.spline " (http://www.bioconductor.org/) to capture the relationship. First, the mean contact counts (oi) among all locus pairs with the same genomic distance (di) were calculated by removing extreme data points that are outside of a 10 fold of interquantile range (IQR). Then spline models were fit to the resulting oi and di pairs to capture the expected contact counts for different genomic distances. The analyses were performed on raw data, ICB-corrected and caICB-corrected data (see below) of different resolutions in order to calculate the observed/expected (O/E) values in different conditions. The O/E values were then used to evaluate the results of different normalization strategies.
Linear model to correct for ICBBy utilizing the count-distance curve between the contact counts and the genomic distance between the contact pairs, we converted the problem of removing the biases across chromosomes to the problem of minimizing the differences across count-distance curves of different chromosomes. We assumed that the mean contact counts of the same genomic distances for different chromosomes are the same if no bias were observed in the Hi-C data. We propose a linear regression-based method to minimize the differences between count-distance curves of different chromosomes, which can correct for the across-chromosome bias without changing the within chromosome bias structure learned from ICB correction step. Specifically, the mean (ICB-corrected) contact counts (Oi|j, i=2, .., K) among all locus pairs with the same genomic distance (di|j, i=2, .., K) in each chromosome j (j=1, .., N) were calculated by removing the extreme data points that were outside of a 10 fold interquantile range (IQR). Genomic distance between locus pairs was calculated by d | = r  i, i = 2, .
. , K,where r is the resolution of the Hi-C map, i is the binning step between locus pairs, j is the chromosome index, and K is the tuning parameter controlling the number of adjacent interaction bins from each genomic locus chosen for the correction. This parameter represents the tradeoff between accuracy and efficiency, since larger values of K include more data points, which reduces efficiency but increases accuracy, and vice versa. K equals to 200 was used in all analyses in this study. Then linear regression on Oi|j between every chromosome pair was performed as follows:where EO | is the linear estimation of O | from O | , and the coefficient  , represents the bias between chromosomes m and n. This step was taken to calculate the coefficient matrix (  , m  j, n  j) representing the biases between each chromosome pair.   is a mn matrix with elements  , .The matrix   was further standardized by dividing with coefficients from chromosome 1:  , = ,,Then cbias was learned as the square root of the median standardized coefficients of each chromosome: cbias = median(, ), n = 1, 2,  , N, m  j, c  j.Finally, caICB was calculated from ICB by correcting for the chromosome level bias (cbias) by applying caICB = ICB  cbiasThe caICB correction ideally accounts for all biases in the Hi-C data, and was used to normalize the raw count matrix to generate a corrected Hi-C map, or alternatively can be used in the Fit-Hi-C package () to obtain an unbiased list of significant contacts. The caICB correction algorithm was implemented in the HiCapp Hi-C analysis pipeline, which can be obtained from https://bitbucket.org/mthjwu/hicapp. The implementation of our caICB correction includes and extends the ICB correction, which can correct for both within-and across-chromosome copy number biases as well as other potential biases in raw Hi-C maps of any given resolution.
Calculation of explicit biasesSegmentation results of snp6.0 microarray data of all available tumor cell lines were obtained from the CCLE project website (). Log2 copy number, which is the log2 ratio of the tumor sample intensity to the normal sample intensity, of the genomic bins in different resolutions was calculated from segmentation results by using the DNAcopy package in bioconductor (). The log2 multiplicative copy number was calculated by adding the log2 copy numbers of the two genomic bins of each locus pair. In silico restriction enzyme cutting of the hg19 version of the human genome was performed by using the " hiccup_digester " script from the HiCUP package () ; fragment length was then obtained from the in silico cutting results. Surrounding sequences of 200bp and 500bp around each restriction enzyme cutting site were used to calculate the GC content and mappability scores, respectively. The fragment-based score was determined by averaging the scores of the two ends of each fragment. GC content was calculated by using bedtools () , and mappability was obtained from UCSC genome browser tables ().
Results
DNA copy number is a critical bias factor in tumor Hi-C data. DNAcopy number variation is a hallmark of human cancer (). Most tumors display several copy number gain and loss events at the time of diagnosis, which provides their genomes with a non-uniform copy number pattern. Previous Hi-C applications () have mainly focused on studying looping principles of normal tissues and cell lines, which rendered investigators unaware of DNA copy number as a potential source of bias in a non-uniform copy number genome. By analyzing Hi-C data from the K562 cell line (), we identified DNA copy number, in addition to fragment length, GC content and mappability, as a significant source of bias in Hi-C contact counts (). Since the Hi-C contact counts are associated with genomic distance between locus pairs, the Observed/Expected metric (O/E) by distance was used in all comparisons throughout. We employed a similar method as described () to calculate the expected contact counts at each genomic distance (see " Spline model " in Methods). We observed a positive correlation between DNA copy number and O/E in the 2D bias plot in different resolution Hi-C maps in both K562 and MCF7 cells (, b and). This finding was consistent with our expectation that genomic loci with more DNA copies tend to be sequenced more frequently in the Hi-C protocol, and vice versus. Because of the strong positive correlation between DNA copy number and the O/E ratio, we then generated a log2 multiplicative copy number value for each locus pair, which was calculated by adding the log2 ratios of copy numbers of the two genomic loci of each locus pair. We found that this metric roughly log linearly increased with the O/E ratio in the core region, defined as, accounting for more than 99% and 97% of all locus pairs in K562 and MCF7 cells, respectively (, d,). Locus pairs with extremely high copy number displayed a high degree of variability due to too few data points contained in each copy number bin (, d,, c). Locus pairs with extremely low DNA copy number are not represented with an adequate number of reads in the Hi-C protocol (, d,, c), which renders this part of the data uncorrectable by any method.
Chromosome-adjusted iterative correction (caICB). Theiterative correction (IC) method based on the matrix balancing algorithm is one of the most widely used methodologies to remove both explicit and unknown biases from Hi-C data (). The advantage of the IC method is that it provides an IC bias vector (ICB), instead of a bias matrix, which contains all information used to correct the Hi-C data matrix. The IC method (also called ICB correction) has been demonstrated to work well in normal samples and cell lines (), which have uniform copy number genomes. However, the ICB correction should not be directly applied to data from tumor samples, such as the K562 cell line, because such samples display a significant degree of variation in copy number across chromosomes (). The ICB correction is preferentially applied chromosome by chromosome to prevent overloading computational resources when analyzing high resolution Hi-C maps (). Use of the ICB correction leads to an uncorrected chromosome-level bias (andd), thus causing biased calling results of significant contacts (). This bias cannot simply be adjusted for by using total or average contact counts of chromosomes due to the length differences of chromosomes (). In Hi-C data, contact counts decrease with increasing genomic distances such that smaller chromosomes have fewer long distance locus pairs than larger chromosomes. This observation leads to the fact that average contact counts of chromosomes are negatively correlated with chromosome length (), and total contact counts of chromosomes are positively correlated with chromosome length (). For the K562 cell line, the chromosome bias is very apparent, especially for chromosome 9 in lower resolution Hi-C maps (and). Further analysis shows that chromosome-level copy numbers are highly correlated with chromosome-level Hi-C contact O/E ratios even after ICB correction (). To correct for this particular source of bias, we designed a linear regression-based chromosome-level adjustment method called caICB (), which represents an extension of ICB correction. We performed our analyses on multiple resolution contact maps (1Mb, 250Kb, 100Kb and 10Kb) in K562. The algorithm initiates with the ICB corrected Hi-C data matrix. Our method assumes equal representation of genomic locus pairs with similar genomic distances located on different chromosomes if there were no bias in the Hi-C maps. Our approach first calculates the empirical mean of contact counts over genomic distances for all chromosomes. We used linear regression by forcing the intercept to be 0 in each chromosome pair to generate a coefficient matrix. The coefficient matrix is further standardized and summarized as a chromosome-level bias vector (called cbias). This vector is then used to adjust the original ICB-to obtain the caICB-corrected data (). The caICB correction minimizes the difference among chromosomes () and organically corrects for chromosome-level copy number biases (, b,and S8). The caICB corrected O/E ratio provides an unbiased Hi-C map for different copy number regions across different resolutions (, d, and).
The caICB correction leads to unbiased significant contact calling results. Most Hi-C analysesreport a list of significant contacts (), no matter whether the study was designed to ultimately investigate folding principles of the genome () or long-range DNA interactions (). Therefore, an unbiased significant contact list is an essential starting point for the downstream functional analysis or modeling of Hi-C data. Here we applied Fit-Hi-C (), which uses a spline fitting followed by a binomial test to investigate whether there were significantly more contact counts than expected in the same genomic distances, to identify significant contacts in potentially interesting genomic regions of four resolution Hi-C maps of K562 cells. By selecting a q-value < 0.01 as the significance threshold, we found that significant contacts are biased to high copy number genomic loci for uncorrected Hi-C maps of a non-uniform copy number genome, such as that of tumor cells (). This finding demonstrates that a correction is necessary for Hi-C data of tumor samples and other cell types with copy number variation. The caICB correction leads to a nearly unbiased significant contact calling result, unlike the ICB correction (and). Taking the 100Kb resolution map as an example, the standard deviation of the percent of significant contacts across all copy number groups for caICB correction results is 0.017, which is only half (0.035) that of ICB correction results and one fourth (0.071) that of un-corrected results. The regression curves of 1Mb resolutions are much flatter for caICB-corrected results (regression slope = 0. 04, p = 0.44) than for ICB-corrected (regression slope = 0.13, p = 0.04) and raw results (regression slope = 0.18, p = 0.007) (), which indicates a more efficient bias elimination by the caICB as compared to the ICB correction. Similar results were also observed in other resolutions (). In addition, when choosing the top N significant contacts identified from both the ICB-and caICB-corrected matrices and comparing them with Hi-C loops identified by HiCCUPs for K562 cells (), we found that the caICB correction provides higher overlapping results with Hi-C loops than the ICB correction ().
Performance of caICB for all known explicit bias factors.In previous studies (), 2D bias plots were used as an evaluation measurement of the normalization step. We therefore utilized a similar approach to investigate the performance of the caICB correction with regard to known explicit biases. We first confirmed that, by comparing to raw O/E values as well as residual scores across different methods (and), the ICB correction significantly reduces all three explicit biases  mappability, GC bias, and fragment length-at different resolutions. As expected, the caICB correction performs similarly well with respect to these biases. For instance, the reduction in the fragment length bias is similar between the ICB and caICB corrections (). The GC content bias is also largely unchanged between ICB and caICB corrections, except for a slight increase in the 100Kb resolution map in caICB; however, the overall distribution of all tile residuals is unchanged (). Furthermore, mappability is a bias factor that may benefit from the caICB correction; consistent with this expectation, we observed a clear decrease of both mean and variance of the distribution of tile residuals for mappability in lower resolution maps (weighted t-test p=2.1E-4 for 1Mb and p=5.3E-4 for 250Kb ), but not in higher resolution maps (and). Most importantly, the caICB correction significantly reduces the copy number bias in lower resolution maps (weighted t-test p=1.6E-4 for 1Mb and p=0.03 for 250Kb,and). For the highest resolution investigated, the 10kb map, the decrease of the mean residual score is not as significant as that in lower resolution maps after caICB correction, but the variance of the residuals is significantly decreased (and S12). Similar results were also observed for the 100 Kb map (). Therefore, we found that the caICB correction significantly reduces the copy number bias in all resolution maps without increasing the other sources of bias, and can furthermore potentially reduce some of the biases such as mappability in certain resolutions.
Stabilization of the caICB correction.The main goal of the caICB correction algorithm is to capture and correct for the chromosome-level bias (cbias) in Hi-C maps. The cbias results obtained for different resolutions of Hi-C maps of the K562 cell line are overall similar, but there are minor differences. For instance, the cbias vector of chr9 in lower resolution Hi-C maps is around 0.6 but is 0.75 in the 10Kb Hi-C map. In another case, the cbias vector of chr4 is decreased with the resolution increase (). Therefore, the cbias results cannot be shared across all resolution Hi-C maps, and need to be calculated separately for different resolution Hi-C maps. To calculate the cbias in extremely high resolution Hi-C maps (< 10Kb), it is preferable to choose a small genomic range to perform the algorithm instead of using the whole contact map, since this approach significantly increases the running speed and reduces memory usage. In the methodology, the parameter K represents the tuning parameter for choosing the nearest K binning steps of each genomic locus to perform the algorithm (see Methods). We tested the algorithm by using different values of K for 100Kb Hi-C maps, and found that the resulting cbias vectors were very stable across different values of K from 5 to 800 (). Especially when K is larger than 100, the cbias vectors were identical across different values of K, up to 2 decimal places (). Therefore we concluded that the algorithm is robust with regard to using a subset of genomic ranges, and we used K = 200 in this study. In general, we recommend using a K such that K times the resolution is equal to the genomic range that users are interested in.
Application to other datasets. In addition toK562 cells, we also applied the caICB correction to MCF7 Hi-C data, which has a higher level of copy number variation (). The 2D bias plots show that the caICB correction can successfully eliminate the copy number bias (S14a, b). We furthermore surveyed chromosome-level copy number differences in all CCLE tumor cell lines () and found that a substantial number of tumor cell lines (~75% of all CCLE tumor cell lines) display an even higher level of chromosome-level copy number variations than K562 cells (). This finding demonstrates that chromosome-level copy number bias is very common in tumor Hi-C data, which makes the caICB correction a widely applicable normalization algorithm for studying the 3D genome of cancer cells.
ConclusionOur proposed method, caICB, is able to efficiently correct for the copy number bias as well as other potential biases in tumor Hi-C data without a priori knowledge of these biases. Our method is suitable for extremely high-resolution Hi-C maps, because it can achieve robust results when using a small subset of genomic ranges instead of using the whole genome contact map. The method does not require copy number data for the samples for which Hi-C data is available, and has the potential to adjust for other possible biases in Hi-C data without their priori knowledge. Despite the fact that copy number data is not required for the caICB correction algorithm, it would be preferable to monitor copy number bias in the data before and after normalization when analyzing Hi-C data in tumor samples. This observation arises because for extreme cases, such as high-level amplification or near homozygous deletion, which accounts for less than 1% of all locus pairs in K562 cells but may account for a larger fraction in other tumor cells, the contact counts might either be too high or too low to be corrected for by current methods. In these cases, careful evaluation of normalization results is necessary to prevent making biased conclusions. Notably, we found that within-chromosome copy number biases are very effectively corrected by the original ICB method. Therefore, downstream analyses, such as Hi-C loops identified by HiCCUPs, are not biased even when using ICB-corrected Hi-C maps, because the background model is built locally within each chromosome. However, downstream analyses using the genome-wide background, such as the identification of significant contacts by Fit-Hi-C, can be significantly biased in ICB-corrected Hi-C maps; this bias is largely eliminated by using the proposed caICB correction. Furthermore, the caICB correction makes the Hi-C contact counts comparable across the genome, and has potential application for comparing Hi-C data between tumor and normal cells with different genomic copy numbers.
Bioinformatics Advance Access published August 16, 2016 at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
