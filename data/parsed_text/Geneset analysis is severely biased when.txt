Motivation: DNA methylation is an epigenetic mark that can stably repress gene expression. Because of its biological and clinical significance , several methods have been developed to compare genome-wide patterns of methylation between groups of samples. The application of gene set analysis to identify relevant groups of genes that are enriched for differentially methylated genes is often a major component of the analysis of these data. This can be used, for example, to identify processes or pathways that are perturbed in disease development. We show that gene-set analysis, as it is typically applied to genome-wide methylation assays, is severely biased as a result of differences in the numbers of CpG sites associated with different classes of genes and gene promoters. Results: We demonstrate this bias using published data from a study of differential CpG island methylation in lung cancer and a dataset we generated to study methylation changes in patients with long-standing ulcerative colitis. We show that several of the gene sets that seem enriched would also be identified with randomized data. We suggest two existing approaches that can be adapted to correct the bias. Accounting for the bias in the lung cancer and ulcerative colitis data-sets provides novel biological insights into the role of methylation in cancer development and chronic inflammation, respectively. Our results have significant implications for many previous genome-wide methylation studies that have drawn conclusions on the basis of such strongly biased analysis.
INTRODUCTIONMicroarrays and high-throughput sequencing are frequently used to assess the methylation status of CpG sites and CpG islands genome-wide. Array platforms for this purpose have been developed by Agilent, Illumina and NimbleGen, and several high-throughput sequencing-based methods have also been developed, such as genome-wide bisulphate sequencing, meDIPseq () and HELP-seq (). Gene-set analysis (GSA) is frequently used to discover meaningful biological patterns from lists of genes generated from highthroughput experiments, including genome-wide DNA methylation studies. The objective is typically to identify similarities between the genes, with respect to annotations available from sources such as the Gene Ontology (GO) () or Kyoto Encyclopedia of Genes and Genomes (KEGG) (). Popular tools for this purpose include GOstats () and DAVID (). A significant result for a gene set is interpreted as evidence that the corresponding biological function or process is affected in the experimental condition or treatment. A key assumption of GSA methods is that all genes have, a priori, the same probability of appearing in the list. If this is not true, that is, if certain classes of genes are more likely to appear in the list, regardless of the treatments or conditions being investigated, this has the potential to cause misleading results from GSA. The application of GSA to lists of genes found to be differentially expressed between groups of samples using RNA-seq is known to be affected by such a bias (). This is because there is more power to detect changes in expression for genes with higher numbers of mapped sequence reads. Consequently, longer and more highly expressed genes (which tend to have more mapped reads) are more likely to be identified as differentially expressed. The lengths and expression levels of genes frequently differ between gene sets, resulting in some gene sets wrongly appearing to be enriched among the differentially expressed genes. A method to correct this bias has already been developed (). However, the application of GSA is not restricted to the results of highthroughput gene expression measurements; the same approach is used for many other high-throughput experiments. A similar issue has also been highlighted in ChIP-Seq data, when distal binding sites are included in the analysis. In this case, GSA may be confounded when genes in different gene sets are represented by different proportions of the genome.developed GREAT, a tool that can take account of these differences by using a binomial test over a user-defined set of genomic regions. However, GREAT is not suitable for analysis of methylation data, as it cannot differentiate between *To whom correspondence should be addressed. one gene in a set with many highly differentially methylated CpG sites or many genes in the same set with one highly differentially methylated CpG site each. This distinction is important in studies of DNA methylation because there are many cases where methylation of only one CpG site has been shown to perturb expression (for example,); hence, GREAT has not been applied to data of this type. Here, we focus on the application of GSA to the results of high-throughput DNA methylation experiments. We show that GSA, as it is typically applied to DNA methylation data, is severely biased and show that methods that have previously been applied to RNA-seq data can be adapted to correct this bias.
RESULTS AND DISCUSSION
Bias in GSA applied to the results of genome-wide differential methylation studiesMicroarray platforms designed to profile DNA methylation across the genome are typically designed such that some genes are associated with a large number of probes, whereas others have few associated probes. These differences stem from the fact that different genes and gene promoters contain different numbers of CpG sites. On the Agilent Human CpG Island array, for example, the number of probes per gene promoter ranges from 1 to 285 (Supplementary). Similar platforms by NimbleGen (Human DNA Methylation 385 K Promoter Plus CpG Island Array) and Illumina (Infinium HumanMethylation450 BeadChip) contain from 1 to 80 and 1 to 1288 probes per gene, respectively (Supplementary). The reason that these differences are problematic for GSA becomes clear when we consider the methods currently used to identify differentially methylated genes. For example, comparing tumor and normal lung samples,called a gene differentially methylated when two nearby probes (allowing one intervening probe) both showed at least a 2-fold difference in methylation between the sample groups. Given this criterion, genes (for example, SOCS4) that have only two associated probes will be tested just once for differential methylation. By contrast, PPP2R3B, which has 197 associated probes, is tested nearly 400 times. It is clear that PPP2R3B is far more likely to give false-positive results (resulting from probes exceeding these fixed thresholds by chance). Indeed, there is also more power to detect a real differential methylation signal for genes with many associated probes. Many other ad hoc criteria have been applied to define differentially methylated genes. For example,classed genes as differentially methylated if one associated probe reached a fold change of 43. Other authors have used more complex experimental designs and data analysis methodologies, but these do not eliminate the bias. For example,used a peak calling method to identify regions that appeared enriched for methylation; however, because of the different numbers of probes associated with each gene, it is clearly more likely to call peaks on genes with many associated probes. In all cases, where some genes are tested many more times than others (as is typical in methylation analysis), genes with more associated probes (in the case of microarrays) or more associated CpG sites (in the case of high-throughput sequencing) are more likely to fulfill whatever criteria is used, violating a key assumption of GSA. The reason that this causes such a strong bias in GSA is because there are also large differences between gene sets in the mean numbers of associated probes per gene. For example, on the Agilent Human CpG Island microarray, genes annotated to the Gene Ontology term 'Embryonic organ development' (GO:0048568) have, on average, 22.7 associated probes, more than twice the average of 9.8 probes for all genes. Consequently, if the methodology used to identify differentially methylated promoters is sensitive to the number of probes in the promoter, this gene set is likely to contain a disproportionate number of significant genes, and thus is more likely to appear to be significantly enriched in the subsequent GSA.
Reanalysis of a published datasetMany published studies have applied GSA to high-throughput methylation data (for example,). In all of these studies, regardless of the platform used, gene sets relating to development, transcription or differentiation were reported to be enriched for differentially methylated genes; however, these gene sets are typically associated with large numbers of probes per gene (the precise number depending on platform;). We now consider one such study in detail.used the Agilent Human CpG Island microarray to assess methylation in five lung cancer samples compared with normal lung tissue andapplied GSA to identify hypermethylated gene sets in this dataset. CpG islands were called as hypermethylated in a sample 'when at least two adjacent probes, allowing a one-probe gap, within the CpG island scored a folddifference factor of42 when comparing tumor and normal tissue DNA' (). Genes were considered hypermethylated in lung cancer if any associated CpG island met this criterion in four out of the five samples. The R package GOstats was then used to assess aberrant methylation of GO biological processes (BP) containing between 100 and 1000 genes (). We followed the original methodology and obtained results similar to(). The most significantly enriched gene sets (including differentiation/ developmental and transcription factor activity related gene sets) all consisted of genes that were associated with far more microarray probes than average (). Furthermore, the enrichment P-value for each gene set was strongly correlated with the mean number of probes per gene (). This suggests that these results may be attributable, at least in part, to differences between gene sets in the number of probes per gene.
Demonstration of bias using randomized probe locationsAs an additional line of evidence, we show that significant results can be achieved from this dataset using randomized data. To do this, we carried out 100 random permutations of the probe logintensity values within each sample and repeated the inference of differential methylation followed by GSA. To ensure that the results were comparable with the original data, we modified the fold change cut-off for differential methylation so that the average number of hypermethylated genes was the same as in the original data. Altering the fold change cut-off was necessary because the methylation status of adjacent CpG sites is correlated in the real data (), resulting in a higher probability of adjacent CpG sites showing differential methylation between groups. If the application of GSA to this dataset was valid, it should not reveal any significant results because in the permuted data, each gene was associated with a random set of probes. Yet, when we applied GSA to the genes found to be differentially methylated in this random dataset, many of the same gene sets that were reported in the original analysis were found to be highly significant (and Supplementary) in the vast majority of the random permutations.
Demonstration of bias using sample randomizationAn alternative way to test the validity of results obtained using GSA is through permutation of sample labels (; Efron and). If similar GSA results are obtained from random groupings of the samples, then the GSA results do not reflect real biological differences between the sample groups (e.g. tumor versus normal), but rather are an artifact of the analysis. High-throughput methylation experiments typically do not admit straightforward label permutation because different samples are often hybridized to different channels of the same microarray. This is the case for the data of Helman et al. (2012) that was generated by hybridizing tumor and normal tissue to dual channel arrays. However, it is possible to reproduce the effect of sample label permutation by inverting the fold change values for each pair of samples. The data consisted of five pairs of samples, resulting in 32 possible configurations when probe intensities are inverted in this way. For each permutation, we ranked genes by methylation fold change of the most differentially methylated probe and applied GSA to the same number of genes as in the original analysis. Again we found that the same gene sets that were reported in the original analysis also seem to be enriched for the inverted datasets (). In fact 6 of the 10 most significant gene sets were significant for all of the configurations.
GSA applied to differential methylation in ulcerative colitisAs a further demonstration of the bias, we analyzed data generated again using the Agilent CpG Island microarray, this time applied to sigmoid colon biopsies from five patients with long standing (425 years) ulcerative colitis (UC), and five healthy age-matched controls (manuscript under review). This is adifferent experimental design to the dataset discussed earlier in the text, as cases and control samples were hybridized to different microarrays. The Cy3 channels were hybridized with immunoprecipitated methylated DNA [isolated using the MeDIP (, and the Cy5 channels were hybridized with input DNA (see Section 4). Thus, the log intensity ratio of a probe is, in this case, indicative of the extent of methylation of a probe in a given sample, rather than a log ratio of two different samples (as in the lung cancer experiment). This experimental design allows conventional label permutations. To select a candidate list of differentially methylated genes in this dataset, we used the Bioconductor package limma () and identified probes that were hypermethylated in the UC samples (P50.05). All genes associated with at least one hypermethylated probe were considered hypermethylated (see Section 4). This approach identified a foreground list of 380 genes for gene set analysis, which was carried out using GOstats (also for GO BPs with between 100 and 1000 associated genes). Once again, the results contain a large number of biological processes related to development and differentiation (). Interestingly, the GSA results obtained for this dataset were highly correlated with the results of the lung cancer dataset (Pearson r  0.69, P52.2  10 16 ). This could suggest that similar biological processes are perturbed in the two cases, which would be of interest, as long-standing UC may be associated with the development of colon cancer (). However, because of the bias we have identified, this interpretation could be misleading, and the correlation may simply be the result of a shared artifact. Indeed, for the UC dataset we found that a large majority the same gene sets identified earlier in the text remained highly significant when sample labels were randomized, with in many cases P-values more extreme than 10 20 generated from arbitrary arrangements of the samples (). This shows that even when using a different experimental design and different criteria to define methylation, highly significant results can again be achieved from random data.
Bias correctionWe applied the Bioconductor package GOseq () to control for the fact that different genes have, a priori, different probabilities of appearing in the foreground list. This package was developed to control for bias in GSA applied to RNA-seq data. The package uses (by default) a six knot monotonic spline function to model the association between the odds of a gene appearing in the foreground list (i.e. being detected as differentially expressed, or in our case hypermethylated) and the value of the confounding variable (in our case the number of CpG probes associated with the gene; (). The model can be used to predict the probability of a gene appearing in the foreground list, as a function of the number of associated probes. Given these probabilities, empirical P-values are calculated by simulation. In the lung cancer dataset, the number of GO BP categories that were significantly enriched (FDR50:05) after correction was much smaller than previously (9, compared with 72). After correction (), 'Embryonic organ morphogenesis' was the most significant category (P  4.9  10 4 , compared with P  8.1  10 17 , before correction). The expected number of hypermethylated genes for 'Embryonic organ morphogenesis' rose from 1.9 to 3.4, but this is still considerably fewer than the observed number of hypermethylated genes for this category, which is 15. This suggests that the reported hypermethylation of developmental associated genes in this lung cancer dataset is not an artifact of the higher numbers of associated probes. However, several of the gene sets identified in the original analysis are no longer significant. These include gene sets related to transcription factor activity and, perhaps importantly, the gene sets related directly to differentiation. The P-value for '
Validation of bias-corrected GSA by comparison with label permutationSeveral authors have previously suggested correcting the results of GSA using sample label permutations (). For example, the popular tool GSEA () uses this approach. In many cases (for example, the lung cancer study discussed earlier in the text), this is not possible, and in many other cases, it may be highly computationally intensive, there may be a limited number of samples (meaning that it will be impossible to achieve statistical significance), or it may be difficult because of the complexity of the analysis pipelines sometimes applied to methylation datasets. However, in the case of our UC dataset, it is straightforward. Thus, we used this dataset to compare the results of the GOseq-corrected GSA method to the results obtained from sample label permutations. Applying an uncorrected GSA to the UC dataset identifies many highly significant gene sets (). After correction using sample label permutations, 19 gene sets were identified with P50.05 (). GSA corrected by GOseq identified 12 gene sets (; Supplementary) compared with 262 when using an uncorrected approach (suggesting that a large proportion of the results from the original analysis were artifacts). Of the 12 gene sets identified using the corrected GSA, 11 were also identified by label permutation. The similarity to the results of a robust permutation-based approach provides good evidence that the corrected GSA performs well and is a suitable method of accounting for bias in methylation data. By comparison, only 12 of the 19 gene sets identified using label permutation were detected using the uncorrected GSA, despite an order of magnitude more processes reported significant in the latter analysis. When a corrected analysis is applied, results in the UC dataset are not significant after correction for multiple testing. Where label permutation is possible (e.g. in the UC experimental design), it can be used to perform GSA in a way that is robust to the differences in the number of probes per gene. However, it is likely that GOseq provides better power to detect gene sets that are enriched for differentially methylated genes, as the statistical significance that can be achieved by a permutation method can be limited because of the relatively small sample sizes that are often encountered in genome-wide methylation experiments. In the previous section, we showed that the results of an uncorrected GSA applied to the lung cancer and UC datasets were similar, a result that could potentially provide insight into UCassociated carcinogenesis. However, when we corrected for the number of probes per gene, the Pearson correlation between the P-values in the UC and lung cancer datasets is dramatically lower than for the uncorrected results (r  0.17, compared with r  0.69), suggesting that the similar results were largely artifactual.
CONCLUSIONSIn general, when different genes and gene sets are associated with different a priori probabilities of appearing in the foreground list as a consequence of factors other than those that are of biological interest there is the potential for bias. This arises in many GSA applications. It is common in GSA to associate multiple and different numbers of features with each gene; typically, multiple features are collapsed onto single-gene identifiers. For instance, the popular web-based GSA tool, DAVID (Huang et al., 2009a, b) offers the option to use microarray probe IDs (e.g. from methylation or gene expression arrays) as foreground and background lists. These are converted to unique gene IDs before statistical analysis. When there is a difference in the number of probes associated with each gene, this can give rise to the bias that we have outlined. In this article, we have demonstrated that this causes severely biased results when GSA is applied to highthroughput methylation data, typically leading to false-positive results for gene sets related to development, differentiation and transcription. This bias can be corrected by applying a GSA method, such as GOseq, that models the relationship between the number of features (e.g. CpG probes in the case of microarrays or CpG sites in the case of high-throughput sequencing) associated with a gene and its probability of appearing in the foreground list, or where applicable, by using sample label permutations.
METHODS
Gene-set analysis using label permutationSample labels were rearranged in all possible combinations. As there were a total of 10 samples, split equally between UC and control phenotypes, this yielded 126 distinct arrangements of the samples. For each of these arrangements, the enrichment odds ratio test statistic was re-calculated for each gene set, using the same pipeline as the original analysis and selecting the same number of hypermethylated genes (so that the GSA is comparable between the observed and permuted data). P-values were calculated as the proportion of the test statistics that were as extreme, or more extreme, than the test statistic corresponding to the observed data.
UC microarray dataMeDIP was performed to capture methylated DNA sequence as previously described by Weber et al. with slight modifications. Briefly, 10 mg of 5-methylcytosine antibody was incubated with 50 ml of Dynabeads M-28 Sheep anti-mouse IgG for 5 h in immunoprecipitate (IP) buffer at 4 C. Genomic DNA was sonicated using the Branson digital sonifier, and 4 mg of genomic DNA was incubated with the antibody-beads complex overnight at 4 C. Then, the DNA-antibody-dynabeads complex was washed three times with IP buffer and incubated with 5 ml of proteinase K for 2 h at 55 C. In our experiment, we labeled the IP DNA with fluorescent dye, cyanine 3 and reference (R) DNA with cyanine 5 and co-hybridized to the Agilent microarrays. The MeDIP followed by CpG island microarray analysis enables us to identify the methylated and unmethylated CpG islands between long-standing UC patients and age-matched control patients. Purification of labeled products, array hybridization and scanning were performed at the functional genomics and high-throughput screening facility at the National Centre for Biomedical Engineering Science, NUI Galway. Data were quantile normalized and analyzed using the Bioconductor library limma. Genes with at least one associated hypermethylated probe in UC (P50.05) were selected for GSA. These data have been uploaded to GEO and are available under accession number GSE39188.
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
P.Geeleher et al. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
Bias in methylation GSA at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
