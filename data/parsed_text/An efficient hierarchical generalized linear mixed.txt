Motivation: In genome-wide association studies (GWAS) of complex diseases, genetic variants having real but weak associations often fail to be detected at the stringent genome-wide significance level. Pathway analysis, which tests disease association with combined association signals from a group of variants in the same pathway, has become increasingly popular. However, because of the complexities in genetic data and the large sample sizes in typical GWAS, pathway analysis remains to be challenging. We propose a new statistical model for pathway analysis of GWAS. This model includes a fixed effects component that models mean disease association for a group of genes, and a random effects component that models how each gene's association with disease varies about the gene group mean, thus belongs to the class of mixed effects models. Results: The proposed model is computationally efficient and uses only summary statistics. In addition, it corrects for the presence of overlapping genes and linkage disequilibrium (LD). Via simulated and real GWAS data, we showed our model improved power over currently available pathway analysis methods while preserving type I error rate. Furthermore, using the WTCCC Type 1 Diabetes (T1D) dataset, we demonstrated mixed model analysis identified meaningful biological processes that agreed well with previous reports on T1D. Therefore, the proposed methodology provides an efficient statistical modeling framework for systems analysis of GWAS. Availability: The software code for mixed models analysis is freely available at http://biostat.mc.vanderbilt.edu/LilyWang.
INTRODUCTIONGenome-wide association studies (GWAS) have become a main approach for identifying disease genes. These studies examine large numbers of genetic polymorphisms across the genome in hundreds or thousands of samples at a time. So far, GWAS have * To whom correspondence should be addressed. identified many genetic variants statistically associated with diseases or traits (). However, for complex diseases, typically individual genetic variants only have weak marginal effects on disease risk, even for real associations. Therefore, after multiple comparison adjustment for the large number of tests performed in GWAS, real but weak associations are likely to be missed by the conventional strategy of considering only the most significant hits (). To help increase power and to better understand the disease mechanisms underlying complex diseases, several recent studies () considered GWAS Pathway Analysis (GWASPA) (). These approaches test for effects of groups of genetic variants that belong to the same biological pathway such as those defined in kyoto encyclopedia of genes and genomes (KEGG;) or Gene Ontology () databases. The underlying assumption is that complex diseases are likely to be caused by changes in activities in biological pathways, where a number of mutations in different genes each contributes a modest amount to disease predisposition but works together to cause major disruption in normal biological processes. Higher power in pathway-based analysis is achieved by combining weak signals from a number of individual genetic variants in the pathway. Recently, a number of GWASPA approaches (), such as the modified gene set enrichment analysis (GSEA) algorithm () have been proposed. Typically, to preserve correlation patterns between genes, P-values are estimated by permuting sample labels. However, for a typical GWAS, the recalculation of test statistics for half a million or more single nucleotide polymorphism (SNPs) with hundreds or even thousands of samples for each permutation is extremely computationally intensive. In addition, a recent review () comments: 'the permutation studies that are currently being conducted require raw genotype data, which are not always available. An important methodological improvement would make the P-values alone, and not raw data, the basis of analysis in GWASPA'. When raw genotype data are not available, a simple and popular approach for pathway analysis is an over-representation analysis based on Fisher's exact test. This method condenses test statisticsPage: 687 686692
Efficient hierarchical GLMM for pathway analysisfor multiple SNPs within a gene into a single value (usually by choosing the most significant P-value), classifies each gene as significant or not based on a pre-specified significance threshold, and then compares the proportion of genes significantly associated with disease in a pathway versus the rest of the genome. The Fisher's exact test and its extensions have been implemented in a number of software programs such as the Ingenuity Pathway Analysis (IPA, http://www.ingenuity.com/), SNPtoGO (), PRP (), ALIGATOR () and JMP Genomics (http://www.jmp.com/genomics). However, when the threshold for declaring significant genes changes, the results of pathway analysis based on Fisher's test can differ. In addition, because genes in the same pathway are expected to regulate or interact with each other, the assumption that these genes are independent may not be tenable. A further difficulty for GWASPA is that it is not immediately clear what strategy should be used for the SNP information reduction for each gene. When each gene locus is represented by a single SNP, the potential effects of multiple association signals for the gene would be missed. Moreover, for overlapping genes, bias may be introduced when SNPs mapped to multiple genes are highly significant, because these SNPs would be included multiple times in the dataset and pathway significance may be driven by only a few of these SNPs. In this article, to address these analytical challenges, we propose an efficient, threshold-free, hierarchical generalized linear mixed model (GLMM) for GWASPA. The proposed model has several desirable properties: (i) It is computationally efficient: only summary statistics are needed; raw genotype data, which may not be available due to confidentiality concerns (), are not required.(ii) We model all the genes and SNPs within a pathway in a hierarchical fashion using random effects, which provide the ability to borrow information across genes in the same pathway. Our method corrects for the presence of overlapping genes and linkage disequilibrium (LD) between SNPs. (iii) The proposed model improves power over currently available pathway analysis methods while preserving type I error rate. (iv) In addition to identifying pathways associated with diseases, genes that contribute most to pathway association with disease can be identified using shrinkage estimates of best linear unbiased prediction (BLUP;). (v) Covariate information, environmental effects and other complex design factors can also be accommodated using fixed and random effects in the mixed model. In Section 2, we will discuss a few mixed models, including our proposals for modeling overlapping genes and LD patterns across genes and SNPs within a pathway. In Section 3, we will use both simulated and real GWAS dataset to show our proposed model has an increased power over currently available methods while preserving type I error rate for identifying disease associated pathways. Finally, using GWAS dataset from the WTCCC T1D study, we will show that mixed model analysis identifies meaningful biological processes and genes that agree well with previous reports on T1D.
METHODS
From SNPs to pathwaysThere are several pre-processing steps for pathway analysis of GWAS datasets:(1) Determine the pathway database to be used. For the analysis of the real GWAS dataset in Section 3.2, we used gene sets from the C2-CP collection and C5-BP collection of the Molecular Signature Database (MSigDB;). The C2-CP gene sets are biological processes compiled by domain experts and the C5BP gene sets are derived from controlled vocabulary of the Gene Ontology project ().(2) Assign SNPs to genes. For the analysis in Section 3.2, we assigned SNPs to a gene if they were located within 5 kb upstream of the first exon or downstream of the last exon.(3) Assign genes to pathways. We linked genes to pathways based on HUGO Gene symbols. After this step, we obtained a dataset with SNP identifiers linked to genes in each pathway for subsequent statistical analysis.
General structure of the proposed mixed modelsWe propose a new method for GWASPA using a class of statistical models called mixed effects models. These models include a systematic or fixed effects component that models the mean disease association for a group of genes, and a random component that models how each gene's association with disease varies about the gene group mean, thus called the mixed effects model. In the analysis of gene expression data, mixed models have been successfully applied to both single gene and pathway analysis (). For single marker analysis in GWAS, mixed models have been successfully applied to account for population structure () and to incorporate prior biological information (;). More specifically, to assess pathway association with disease, we propose two mixed models (see details in Supplementary) with the following general structure: let y ij be the chi-squarestatistic for SNP j on gene i, based on the CochranArmitage trend test for a single SNP, we assume y ij follows a chi-squaredistribution with mean  ij , denoted as y ij   2 ( ij ). Assuming SNP j on gene i is not associated with disease, we have  ij = 1 or Log ( ij ) = 0. Next, for each pathway, pooling all SNPs mapped to genes in the pathway, we formulate the following model: log( ij ) =  ij =  +u i i = 1,...,g;j = 1,.
..,s iwhere g is the number of genes in the pathway; s i is the number of SNPs on gene i;  is a fixed (intercept) effect; and u 1 ,...,u g  N(0,G) are random gene effects and G is genegene covariance matrix. To test for pathway association with disease, we test the null hypothesis.Because the random gene effects have mean 0, statistical significance (of departure from 0) for  would indicate an overall association with disease for pathway SNPs. Under H 0 , the test statisticstatistic statistic/ss  follows t distribution with nrankdegrees of freedom (where n is the number of SNPs in the pathway and X and Z are design matrices for fixed and random effects, respectively). When the number of SNPs (n) is large, this is approximately the standard normal distribution; therefore, the null distribution for test statistics in mixed model does not depend on gene set size for pathways with a large number of SNPs. In the above model, the dependent variable y ij is assumed to follow the chisquare distribution which belongs to the exponential family of distributions. Therefore, this model is a generalized linear model. Furthermore, since both fixed and random effects are included, it is a GLMM.
Detailed description of the mixed modelsWhen devising the mixed models, we considered two important and challenging issues in pathway analysis: (i) accommodating overlapping genes, where a single SNP is mapped to more than one gene and (ii) accounting for the correlations between SNPs due to LD. Page: 688 686692For the first mixed model (A), we assume the random effects u 1 ,...,u g  N(0, 2 I).shows a coding scheme for the independent variables, where the fixed effect  is an intercept and the random effects u 1 ,...,u g are indicator variables for each gene. For issue (i), note that each SNP appears only once and thus contributes only once to the overall pathway association test statistic. To address issue (ii), using matrix algebra () it can be shown that for SNPs j and j on the same gene i, cov(u ij ,...,u ij ) =  2 ,j = j so the random effects u 1 ,...,u g account for a homogeneous covariance pattern between the SNPs in the same gene. To account for any additional variability due to unstructured covariance between SNPs on different genes, using the fact that chi-square distribution is a special case of gamma distribution, we increase the flexibility of the model by assuming y ij  gamma( ij ,) where  ij is the mean parameter and phi is the scale parameter. The inclusion of an additional scale parameter is a common mechanism to account for over-dispersion in generalized linear models (). Supplementaryshows the details for these models. Model (B) is similar to Model (A), except that in Model (B), we propose modeling the covariance between genes in the gene set based on physical locations of the genes. Let u i ,...,u i be random gene effects for genes i and i , respectively. The spatial model (B) assumes cov[u i ,...,u i ]= 2 e d ii / where the distance measure d i i is calculated based on Euclidean distance between physical locations of genes i and i (averaged over all SNPs mapped to the gene). The parameters  2 and  can be estimated automatically by maximizing the pseudo (restricted) maximum likelihood using PROC GLIMMIX of SAS software (Version 9.1, SAS Institute, Inc., Cary, NC, USA).
L.Wang et al.
Empirical null distribution estimationTo further improve the accuracy of significance testing, rather than relying on asymptotic approximations, we pooled the estimated t-statistics corresponding t  for all gene sets, and estimated gene set P-values based on the empirical null distribution (), which is a normal distribution with empirically estimated meanmean mean and standard deviationdeviation deviation.showed that in large-scale simultaneous testing situations (e.g. when many gene sets are tested simultaneously in a study), serious defects in the theoretical null distribution may become obvious, while empirical Bayes methods can provide much more realistic null distributions. The empirical null distribution can be estimated using the locfdr package in R statistical software. Note that for each study, the empirical null distribution only needs to be estimated once, and can be accomplished in a few seconds, so this step adds little computational complexity to the proposed algorithm. In summary, we followed the following five steps for significance testing of gene sets:(1) For each gene set, fit an appropriate mixed model and obtain its t-statistic corresponding t .(2) Convert the t-statistic to a z-score. For example, let t i be the t-statistic for gene set i, the corresponding z-score can be obtained by) where and F d are distribution functions for standard normal distribution and t distribution with d degrees of freedom.(3) Pool the z-scores for all gene sets tested in a study and calculate their median value (m). Subtract m from the z-scores so that they have median of 0.(4) Given the median-centered z-scores, use the locfdr package, estimate location () and scale () parameters of the empirical null distribution.(5) Calculate standardized z-scores, s i = (z i mm m)/  , and compute the P-value for each gene set as p i = 1(s i ).
Ranking of individual gene contribution to the gene set signalAs gene sets are defined based on existing knowledge in biological processes without considerations for any specific disease, typically only a subset of the genes in the pathway have genetic variations associated with disease susceptibility. Therefore, for significant gene sets, it is helpful to identify the subset of genes contributing to the gene set significance. Toward this end, we define the influential subset of genes, which are those genes contributing most to the gene set signal, to be those genes with estimated meanmean mean +  u i higher than the estimated overall meanmean mean for the gene set. Recall in the general mixed model (Section 2.2), u i models the deviation of each gene's average chi-square statistic (on a log scale) from the gene set mean . In other words, the influential subset includes all genes withwithwith i > 0 or equivalentlyequivalently equivalently +  u i >  . Furthermore, we can rank these influential genes by their estimated individual gene estimat  +  u i. Under the mixed model framework, these estimates are called empirical BLUP; they are shrinkage estimates that borrow information across all genes in the gene set and naturally fall into the hierarchical empirical Bayes framework. We illustrate ranking and selection of the influential genes in the pathways using a GWAS dataset in Section 3.2.
Design of a simulation experimentTo study the properties of the proposed mixed models, we simulated both null gene sets, for which the disease status of the samples were generated randomly, and causal gene sets, for which the disease status were generated based on a genetic model. For the null gene sets, we used a genotype dataset of the genetic association information network (GAIN) GWAS for schizophrenia (). The details of data preparation were provided in our previous work (). It includes 1158 schizophrenia cases and 1378 normal controls of European ancestry. After quality control and mapping SNPs to the pathways in the C2-CP collection of MSigDB (http://www.broadinstitute.org/gsea/msigdb), we obtained 596 gene sets with size ranging from 3 to 200 genes. For each pathway, we generated random disease status for the samples from a Bernoulli distribution (with parameter P = 0.5), so that by the experiment's design, SNPs in these pathways were not associated with the disease. This process was repeated twice, so that we had two sets of random outcomes for each pathway for a total of 1192 (5962) null gene sets. Next, for the causal gene sets, we generated genotype data for 12 000 samples representing an entire population of patient samples, and for each causal gene set, we sampled 500 cases and 500 control samples based on disease prevalence of 0.05. Since genotype data for many more samples were needed, instead of using an existing GWA dataset, we used the HAPSAMPLE software () to simulate a genotype dataset with realistic LD patterns. HAP-SAMPLE simulates genotype datasets by resampling chromosome-length haplotypes from existing phased datasets, such as the HapMap dataset, thus preserving realistic genetic data structure. Given simulated genotype data, the samples' disease statuses were then simulated based on a genetic model with various parameters modeling the strengths of Page: 689 686692
Efficient hierarchical GLMM for pathway analysisassociations between pathway SNPs and the disease. More specifically, we followed these steps to generate the causal gene sets:(1) Simulate genotype data: the median number of genes for pathways in the C2-CP collection of MSigDB is 23. Therefore, for this simulation study, we selected the ATM pathway with 23 genes. The SNP IDs of the 262 SNPs (corresponding to the 23 genes in the ATM pathway) were entered into HAP-SAMPLE and the Caucasian cohort (CEU) from HapMap Phase II Project was used as the source data. We next used HAP-SAMPLE to generate genotype data for a total of 12 000 samples, representing the entire population of samples.(2) Simulate disease status for the samples: after fixing the genotype data, we next simulated casecontrol status for each sample based on the following genetic model:represents the number of copies of the minor alleleThe number of causal SNPs (D) associated with disease in the pathway were set at an average of t = 0.5, 1 and 1.5 per gene, so that D = t n gene. The first D SNPs with the lowest RSID numbers (dbSNP assigned reference SNP ID), which mapped to several different genes, were selected to be the causal SNPs. We generatedwhere the mean log odds ratio  = log(1.1) and  2 = 0.3 and 0.5. Under this setup,  i can be positive or negative, therefore each simulated pathway included causal SNPs with minor alleles increasing or decreasing risk of disease. Next, given disease prevalence K(= 0.05) and  i (i = 1,...,D),  0 were estimated by maximizing the equation, we computed f and generated disease status for each sample using the genetic model above. From the pool of 12 000 samples [step (1) in this section], the genotype data for the first 500 cases and 500 controls were then selected. In, for each simulation dataset, we included 100 causal gene sets [generated by repeating step (2) in this section 100 times] and the same set of 1192 null gene sets (generated by adding random sample labels to gene sets based on GAIN schizophrenia genotype data). The type I error rate and power were estimated by the proportion of mixed model with P < 0.05 for the null gene sets or the causal gene sets, respectively.
RESULTS
Results of simulation studyFirst, we assessed the accuracy of the estimated empirical null distributions for each mixed model. In, each simulation dataset consisted of 100 causal gene sets and 1192 null gene sets. For the mixed models, given the t-statistics corresponding t  from models (A) and (B), as discussed in Section 2.4 [following the Steps (2)(4)], we estimated the empirical null distributions using the locfdr package in R software. Since the same 1192 null gene sets were included in each simulation dataset, the estimated parametersparameters parameters,   andpand andp 0 for the empirical null distribution are expected to be the same across all datasets. Among all models, the parameter estimates were most consistent for model (B), indicating the estimated empirical null distribution was most accurate for this model. Next, for each simulation dataset, we estimated the type I error rate for each model. Under the null hypothesis, we expect the P-values to follow a uniform distribution, so a model with type I error rate equalto or less than the significance level of 0.05 is desirable. Among all models, again, Model (B) had type I error rate closest to the expected error rate of 0.05. Model (A) also had reasonable type I error rate. Finally, we assessed the power of the proposed models.shows the estimated power (based on 100 causal gene sets in each simulation dataset) for the mixed models and Fisher's exact tests. For Fisher's test, a CochranArmitage trend test P-value was computed for each SNP, and the most significant SNP was selected to represent each gene. To classify each gene as significant or not, we used P-value cutoffs of 0.01, 0.05 and 0.1 for Fisher0_01, Fisher0_05 and Fisher0_1 in, respectively. When the number of causal SNPs in the gene set was moderate (t = 1, where t is the average number of causal SNPs per gene = 1) or high (t = 1.5), all models except Fisher0_05 and Fisher0_1 performed well. When the number of causal SNPs in the gene set was low (t = 0.5), model (B) performed best, followed by model (A). As expected, the results of Fisher's exact test varied when different thresholds were used to classify each gene as significant or not, with Fisher0_01 and Fisher0_1 having the most and least power, respectively. Note that in these simulation datasets, disease outcome for each sample was generated randomly or based on a genetic model for the null and causal gene sets, respectively, it was difficult to evaluate performance of permutation-based pathway analysis methods such as GSEA, where only a single set of disease outcomes is allowed for all genesets in a dataset. Therefore, we next analyzed the GAIN schizophrenia dataset with real disease outcomes, to compare the power of mixed model (B) with GSEA, permutation-based Fisher's exact test and one other recently proposed methodALIGATOR (). Previously, we analyzed this dataset using GSEA () and permutation-based Fisher's exact test (or hypergeometric test) for a set of 511 curated pathways (). Using the exact same dataset, we next performed analysis with mixed model (B).shows that model (B) identified more significant gene sets than the other methods. For example, the number of significant gene sets with P < 0.05 identified by mixed models, Fisher's exact test, GSEA and ALIGATOR were Page: 690 68669226, 10, 5 and 8, respectively. Note that these comparisons based on real disease outcomes are meaningful since as shown in, type I error rate for mixed model (B) was preserved for the same GAIN genotype dataset with random outcomes. Therefore, model (B) improved power over currently available GWASPA methods, while controlling false positive rate.
L.Wang et al.
Application to Wellcome Trust Case Control Consortium T1D GWAS datasetPage: 691 686692pathways in GWAS without resorting to individual-level genotype data, which are often unavailable to non-owner investigators. In particular, this approach should make large-scale meta-analysis much more convenient and practical, since currently meta-analysis often requires numerous multi-institution effort to share and coordinate genotyping data. Even when raw genotype data are available, the re-calculation of test statistics for thousands of samples in GWAS for each permutation can be computationally demanding. In contrast, maximum likelihood estimation and testing for the proposed mixed model using PROC GLIMMIX in SAS software for a typical gene set can be achieved in seconds. Second, in our proposed mixed model, all the genes in a pathway and all the variants across each gene locus were carefully modeled in a hierarchical fashion. In addition, the correlations between SNPs (due to LD) were modeled based on the spatial distances between genes. Furthermore, for SNPs mapped to overlapping genes in the same pathway, the proposed mixed model include each SNP once and only once. In contrast, methods that select a most significant SNP to represent each gene may have difficulties, because significant SNPs mapped to multiple genes would be included multiple times and pathway significance may be driven by only a few of these SNPs. This kind of false discoveries has been frequently encountered in our analysis. For example, in the GAIN schizophrenia dataset, the 'starch and sucrose metabolism pathway (HSA00500)' included several genes located closely on the chromosome (e.g. UGT1A1, UGT1A3, UGT1A4, UGT1A5, UGT1A6, UGT1A7, UGT1A8, UGT1A9, UGT1A10 and others). When the most significant SNP was used to represent each gene, most of the genes in the cluster were represented by the same SNP. Therefore, if this SNP has a small P-value, the pathway would very likely be identified as a significant pathway, while in fact, the result was driven by one highly significant SNP located on multiple genes. Third, using real and simulated GWAS dataset with realistic LD patterns, we have shown that the proposed mixed model improved power over currently available methods while preserving type I error rate. Unlike traditional pathway analysis method such as Fisher's exact test where each gene is classified as significant or not based on an arbitrary significance threshold, the proposed model uses continuous information in P-values to help improve power. Fourth, the proposed model represents a flexible methodology that operates within a well-established statistical framework. In addition to identifying pathways associated with disease, as explained in Section 2.5, this model can also identify genes contributing most to the pathway association. Moreover, it can be easily extended to handle more complex designs with multiple sources of variations such as covariate information and environmental effects, when it is difficult to justify the exchangeability assumption behind permutation tests.
Efficient hierarchical GLMM for pathway analysis
The Author 2011. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oup.com at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
To further validate the proposed methodology, we next applied mixed model (B), which performed best in the simulation study, to the GWAS dataset from the Wellcome Trust Case Control Consortium (WTCCC) Type 1 diabetes study. Similar to the analysis of GAIN dataset, we collected and tested gene sets defined by the canonical pathway (C2-CP) and biological process (C5-BP) collections of the MSigDB. We replaced the KEGG gene sets in C2-CP with the May 2010 version of KEGG gene sets. To reduce the amount of multiple testing and to avoid testing gene sets for which biological annotations are too broad, we used gene sets with size from 3 to 200 genes. This resulted in a total of 1273 gene sets for our testing. For each pathway, in order to assign SNPs to genes, we followed the procedures outlined in Section 2.1. On a Linux computer with a 3.00 GHz processor and 8 GB memory, computing time was 4 h and 33 min for this mixed model analysis of 1273 gene sets. This indicates that mixed model (B) can be run efficiently for large GWAS dataset. Table 3 and Supplementary Table 1 show the results based on model (B). After correcting for multiple comparisons, model (B) identified 16 gene sets that are significantly associated (false discovery rate <0.2) with T1D. These pathways included antigen processing and presentation, interleukin-1 secretion and T-cell signal transduction and duplicate longstanding associations between these biological processes and T1D. Antigen processing and presentation was demonstrated to be associated with T1D more than 35 years ago (Nerup et al., 1974) and our findings of an association between SNPs in HLA-C, HLA-C and HLA-G of the major histocompatibility region and T1D indicate that the proposed mixed model could effectively detect biologically significant results (WTCCC, 2007). The identification of interleukin-1 pathway is another important replication because IL-1 was one of the first cytokines studied and has been shown to cause toxicity to islet cells, impairing their ability to produce insulin (Zawalich and Diaz, 1986). Finally, association of SNPs in genes involved in T-cell signal transduction mimics knowledge that lymphocytes are the effector cells of T1D, shown just years after the major histocompatibility complex (MHC) discovery when T1D was passively transferred from man to mouse through a lymphocyte transfusion (Buschard et al., 1978). Additionally, the recent study by Eleftherohorinou et al. (2009) also found that SNPs located in genes in the Jak-STAT signaling pathway were associated with T1D, a finding duplicated by this method. In addition, SNPs located in or near the genes CTLA4, IL2 and IL2RA have been repeatedly shown to be associated with T1D and were also found significant in this analysis (Barrett et al., 2009; Consortium, 2007). CTLA4 is a member of the immunoglobulin superfamily that sends an inhibitory signal to T cells, while IL2 and IL2RA may both be involved in the decreased synthesis of IL-2 in lymphocytes from patients with T1D (Zier et al., 1984). 4 DISCUSSION In summary, we have described several GLMMs for pathway-based analysis of GWAS. This flexible, unified and practical approach can be implemented in common statistical packages. Our method makes several improvements over currently available algorithms for pathway testing. First, the proposed methodology represents our attempts at rigorous statistical modeling of disease association with biological
