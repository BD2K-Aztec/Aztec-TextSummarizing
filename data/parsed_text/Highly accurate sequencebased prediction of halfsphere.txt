Motivation: Solvent exposure of amino acid residues of proteins plays an important role in understanding and predicting protein structure, function and interactions. Solvent exposure can be characterized by several measures including solvent accessible surface area (ASA), residue depth (RD) and contact numbers (CN). More recently, an orientation-dependent contact number called half-sphere exposure (HSE) was introduced by separating the contacts within upper and down half spheres defined according to the Ca-Cb (HSEb) vector or neighboring Ca-Ca vectors (HSEa). HSEa calculated from protein structures was found to better describe the solvent exposure over ASA, CN and RD in many applications. Thus, a sequence-based prediction is desirable, as most proteins do not have experimentally determined structures. To our best knowledge, there is no method to predict HSEa and only one method to predict HSEb. Results: This study developed a novel method for predicting both HSEa and HSEb (SPIDER-HSE) that achieved a consistent performance for 10-fold cross validation and two independent tests. The correlation coefficients between predicted and measured HSEb (0.73 for upper sphere, 0.69 for down sphere and 0.76 for contact numbers) for the independent test set of 1199 proteins are significantly higher than existing methods. Moreover, predicted HSEa has a higher correlation coefficient (0.46) to the stability change by residue mutants than predicted HSEb (0.37) and ASA (0.43). The results, together with its easy Ca-atom-based calculation, highlight the potential usefulness of predicted HSEa for protein structure prediction and refinement as well as function prediction. Availability and implementation: The method is available at http://sparks
IntroductionMeasuring exposure of amino acid residues of proteins to solvent is important for understanding and predicting protein structure, function and interactions (). The most common measure is solvent accessible surface area (ASA) (with applications ranging from protein structure prediction () to protein function prediction (). The inability of ASA to discriminate deeply buried residues from those buried just beneath the surface leads to development of residue depth () by averaging the distance to the nearest atom on the protein surface. Both ASA and residue depth, however, require precise evaluation of the protein surface in full atomic details that is time consuming. Having a timeconsuming calculation and requiring an all-atomic model limited the usefulness of ASA and residue depth in the ab initio prediction of protein structure where protein conformation is often represented by main-chain atoms () or only Ca atoms () in initial conformational sampling. Another measure of residue exposure to solvent is contact number (CN), which counts the number of residues within specific distance cut offs. The distances are based on the positions of Ca or Cb atoms. Thus, unlike ASA and residue depth, only a coarse-grained model is needed for evaluating CNs. Different distance cut offs have been used in earlier studies (). It was shown that CN with a distance cut off between 12 and 14 A  is the best for protein fold recognition (). All above-mentioned solvent-exposure measures, however, do not contain explicit information regarding the orientation of side chains that are important for functional and structural studies. Hamelryck designed a new measure by splitting the sphere around the Ca atom into two half spheres along the vector of Ca-Cb atoms (). The half sphere containing the Cb atom was defined as upper and the other as down half spheres. The numbers of Ca atoms enclosed in these two half-spheres were named as Half-Sphere Exposure (HSE)-up and HSE-down, respectively. In addition, he has substituted the vector Ca-Cb with a pseudo vector generated from the sum of vectors Ca i-1-Ca i and Ca i1-Ca i. This HSE is denoted as HSEa (-up and-down) to distinguish from the HSE calculated based on the Ca-Cb vector (here and hereafter, it will be annotated as HSEb). HSEa does not require the positions of Cb-atoms. One advantage of HSE is that its value is independent of amino acid type because it describes a residue's coordination environment rather than a quantity related to its size such as ASA and RD. Interestingly, HSEa-up outperforms other solvent exposure measures including CN, ASA, relative ASA, residue depth and the other three HSE definitions (HSEb-up, HSEb-down and HSEa-down) in correlation to changes in protein stability due to mutations and to conservation of amino acid residues (). More recently, HSE was found to be better than ASA for prediction of B cell epitopes of proteins from their three dimensional structures (). HSE has also been found useful in many other applications (). Most of these applications obtained HSE based on known protein structures. Because the structures for most proteins are not known experimentally, a sequence-based prediction is desirable. Many sequence-based methods were developed for predicting ASA () and CN (). However, there is no method available for prediction of HSEa and only one (HSEpred) for the prediction of HSEb (). We found that the correlation coefficients between actual HSEb and those predicted by HSEpred (up and down, respectively) are less than 0.43 for our dataset of 1199 proteins. One possible factor is that HSEpred was trained on a small dataset of 632 proteins and was not tested on independent datasets. Therefore, a more accurate method is clearly needed. Recently, we developed a method called SPIDER 2 () that utilized predicted secondary structures, backbone torsion angles and ASA, iteratively, in order to improve their accuracies. The method achieved 82% accuracy for secondary structure prediction, 0.76 for the correlation coefficient between predicted and actual solvent accessible surface area, 19 and 30 for mean absolute errors of backbone u and w angles, respectively, and 8 and 32 for mean absolute errors of Ca-based h and s angles, respectively, for an independent test dataset of 1199 proteins. Here, we expand the iterative technique to the prediction of HSEa (-up anddown), HSEb (-up and-down) and CN by employing a large dataset containing 4590 protein chains. The method was independently tested in a dataset of 1199 proteins and a dataset of 69 proteins from the Critical Assessment of Structure Prediction technique (CASP 11, 2014). As a result, highly accurate and robust prediction was obtained (e.g. a correlation coefficient of 0.73 for HSEb-up, 0.69 for HSEb-down and 0.76 for contact number on the independent test set). Comparison to two previous methods for contact prediction and HSEb confirmed the superior performance of the method obtained. The HSEa and HSEb predictors are incorporated as a package in SPIDER 2 available at http://sparks-lab.org or downloadable as a standalone package.
Methods
DatasetsWe have employed the same dataset as used in our previous study (), which consists of 5789 proteins (1 246 420 residues). This dataset was generated by the sequence culling server PISCES (< 25% pairwise sequence identity and <2.0 A  resolution) (). From this dataset, 4590 proteins were randomly selected as training set (TR4590) and the remaining 1199 proteins were utilized as an independent test set (TS1199). In addition, we downloaded the targets from critical assessment of structure prediction technique (CASP 11, 2014, http://www.predictioncenter. org/casp11/). After removing redundant sequences (30% in between or to the training set), we obtained a set of 69 proteins (CASP11) out of original 99 proteins. This set contains 18 617 residues.
Input featuresFor each amino acid, we have extracted 69 input features. The first 20 features are substitution probabilities of amino acids from the PSSM matrix. The PSSM is generated by PSI-BLAST () with three iterations of searching against 90% non-redundant protein database (downloaded from ftp://toolkit.genzentrum.lmu. de/pub/HH-suite/databases/). The next 30 features are extracted from the HMM-profile generated by HHblits with default parameters against Uniprot20 protein database (). The HMM profile includes 10 transition probabilities between matching, insertion and deletion states in addition to 20 substitution probabilities. The additional 12 features represent predicted structural properties of amino acids by SPIDER 2 that include predicted probabilities in three secondary structure states (Helix, Sheet and Coil), ASA, and sine and cosine values of the main chain torsional angles (u and w) and main chain angles between Ca atoms (h and s). Here, sine and cosine of angles were employed to remove the effect of angle periodicity (). The last seven features are physicochemical representatives (PP7) of twenty standard amino acids, namely, a steric parameter (graph shape index), hydrophobicity, volume, polarizability, isoelectric point, helix probability and sheet probability. Additionally, we utilized a window size of 17 amino acids (8 amino acids at each side of the target amino acid). Together with a global feature of the protein length, this led to a total of 1174 input features (17  69  1  1174). The window size was taken from SPIDER 2 () without further optimization.
Parallel multiple-step iterative deep neural-network learningHere, we implemented the same learning scheme as previously used in SPIDER 2. As shown in, the features were input into the deep learning neural network to obtain an initial prediction of HSEs (HSE-up, HSE-down and CN). The deep artificial neural network consists of three hidden layers, each with 150 nodes. The input data was normalized to the range of 01. The weights were initialized by unsupervised learning from stacked sparse auto-encoders, and then refined by using standard back propagation. In this study, we employed the deep neural network from the MATLAB toolbox, implemented by Palm (2012). Deep neural networks have been widely implemented in the prediction of protein structure (). In the second iteration, the predicted values from the first iteration were added into the input features to predict HSEs. This process iterated with updated predicted values until convergence. We found that the prediction accuracy did not increase after two iterations. The training process was performed separately for HSEa (HSEa-up, HSEa-down and CN) and HSEb (HSEb-up, HSEb-down and CN). All contacts are defined with 13 A  distance cut off.
Evaluation methodThe method was first examined by 10-fold cross validation where the training set TR4590 was randomly divided into 10-folds. Nine folds were used in turn for training and the remaining one for testing until all 10-folds were tested. As SPIDER 2 has been trained in the same training set, we avoided over-training by following the same 10-folds and utilizing the 10-fold cross validation results during the training of SPIDER 2 as input features. Moreover, we tested our method in the independent test sets TS1199 and CASP11 dataset by using TR4590 as the training set. The prediction performance of CN, HSEa and HSEb was measured by Pearson correlation coefficient (PCC) as used in previous studies ().
Results and discussions
Overall prediction performanceFigure 2 andshow the results of 10-fold cross validation and independent test in the first four iterations for prediction of CN, HSEb-up and HSEb-down. For the independent test, PCCs achieve the highest value at the second iteration with 0.734, 0.693 and 0.756 for HSEb-up, HSEb-down and CN, respectively. The same is true for 10-fold cross valuation. Thus additional iterations are unnecessary. We also noted that the correlation coefficients from the 10-fold cross validation and from the independent test set are essentially the same. For example, PCCs for CN at the second iteration are 0.757 and 0.756 for 10-fold cross validation and independent test, respectively. PCC for HSEb up at the second iteration are 0.733 and 0.734 for 10-fold cross validation and independent test, respectively. High consistency between 10-fold cross validation and independent test indicates the robustness of our trained method. The small standard deviations between ten subsets from 10-fold cross validation further confirm a stable performance. We further found that the accuracy for HSEa is similar to that of HSEb. For example, The PCCs of HSEa-up and HSEb-up at the second iteration for independent test are 0.729 and 0.734, respectively. The PCCs of HSEa-down and HSEb-down at the second iteration for independent test are 0.717 and 0.693, respectively. Because of similarity between HSEa and HSEb, here and hereafter, we will only present the results for HSEb from the second iteration based on the independent test unless specifically mentioned.Highly accurate sequence-based prediction
The contribution from each feature groupIt is of interest to know the contribution of each feature group to the overall prediction performance of SPIDER-HSE.compares PCCs by utilizing a single feature group or by removing them individually from SPIDER-HSE. In the first test, predicted ASA is the single best feature as it achieved the highest PCC of 0.72, 0.69 and 0.64 for CN, HSE-up and HSE-down, respectively. This is understandable because ASA and CN both describe the level of solvent exposure. Such high correlation confirms the suitability to substitute ASA by the simpler representation of solvent exposure by HSE. The performance of two conservation profiles HMM and PSSM is only slightly worse than ASA with HMM marginally better than PSSM. The physical parameters alone without sequence conservation information can make a decent prediction with PCC around 0.5 for CN and HSE-up.One interesting observation is that predicted angles are more useful than predicted secondary structure in predicting HSE-up (0.58 versus 0.50) and HSE-down (0.54 versus 0.48) although they contribute similarly in predicting CN (0.584 versus 0.586). This suggests that continuous main-chain torsion angles have more orientation information than discrete states of secondary structure. Another interesting observation is that protein length itself as a single feature is not very useful in predicting HSE. Its combination with other features, however, proved useful. Removing protein length will reduce the correlation coefficient in the independent test from 0.756 for CN to 0.740. This is the largest reduction, compared to removing other feature groups. The relatively small change by removing other feature groups is partly due to high redundancies between these feature groups. For example, HHM and PSSM describe residue conservation during evolution, whereas secondary structure and main-chain angles both represent the main-chain conformations. In addition, ASA, SS and main-chain angles have been obtained from PSSM and PP7 feature groups for their prediction. Nonetheless, a drop in performance by removing any single feature group indicates usefulness of all these features for the overall performance.
Comparison to previous methodsTo compare our results with previously reported methods, we reproduced the results of HSEpred by both its locally running version and online server (http://sunflower.kuicr.kyoto-u.ac.jp/$sjn/hse/links. html) on test sets TS1199 and CASP 11. In addition, we compared with a contact number prediction method CRNpred () (http://ipr.pdbj.org/crnpred/). As shown in, the PCC values for HSE are less than 0.5, compared to 0.7 from our method for both test sets. Our predicted CN (PCC  0.76 for the independent test set) are also significantly more accurate than either HSEpred (PCC  0.56) or CRNpred (PCC  0.70). A similarresult was obtained for the CASP 11 set. CRNpred was trained with a contact defined by a cut off 12 A  , whereas we have used 13 A  as a cut off. To be consistent with CRNpred, we specially trained our method based on 12 A  cut off. The accuracy of our method is unchanged. This is not surprising as the correlation coefficient between the contact number from the cut off of 12 A  generated from protein structures is highly correlated to the contact number from the cut off of 13 A  (PCC  0.976).
Correlation of predicted HSE to the stabilities of mutantsTo examine the usefulness of sequence-based prediction of HSE, we compared predicted HSE to the stabilities of mutants. Hamelryck found that HSE from protein structures strongly correlates with experimentally measured stability changes due to mutation (). Here, we expanded the stability dataset by using protherm database recently updated in 2013 (). As with Hamelryck, we limited point mutants from VAL/ILE/LEU to ALA. These three residues were selected because mutations from small hydrophobic residues to ALA will not cause significant changes in polar interaction or in global conformations. Therefore, the protein stability change is dominated by the change of solvent accessibility, and thus eligible for evaluating solvent exposure measures. A total of 220 mutants were found after removing two outliers with DDG above 3.0 kJ/mol (details listed in Supplementary Materials). As shown in, HSEa-up, HSEb-up, CN and ASA calculated from experimental structures consistently have strong correlation to DDG (negative correlation for HSEa-up, HSEb-up and CN with PCC  0.595, 0.541 and 0.494 respectively, positive correlation for ASA with PCC  0.538). Negative correlation for CN and HSE-up is because CN is negatively correlated to ASA (i.e. more contacts mean less solvent accessible). Thus, HSEa-up has the best correlation, which confirmed the result of the previous study () with a larger dataset. For predicted CN, HSE and ASA, the correlations to experimental DDG become weaker. Predicted HSEa-up has the best correlation with PCC  0.461. One interesting observation is that HSE-down has no correlation to DDG. Similar results were obtained earlier (). This is consistent with our physical intuition that the contacts with the front of the side-chain of an amino acid residue contribute most to the interaction of this residue to other amino acid residues. Although the correlation, as shown in, between HSEa-up and DDG is only slightly stronger (PCC  0.461) than that between ASA and DDG (PCC  0.438), the much simpler calculation of HSEa-up than that of ASA will make it more useful in structure prediction. The fact that HSEa-up (PCC  0.46) correlates better than HSEb-up to DDG (PCC  0.37) indicates the importance of a separate predictor for HSEa developed here.
ConclusionsThis work has developed the first sequence-based method for predicting HSEa, in addition to prediction of HSEb and contact number. Trained by a large dataset of >4000 proteins and independently tested by two separate datasets, we showed that our predictions of HSEb and contact numbers are significantly more accurate than existing methods (HSEpred and CRNpred) with correlation coefficients between predicted and actual number at about 0.7 for 10-fold cross validation and independent tests. This highly accurate prediction was built on highly accurate prediction of secondary structure, backbone angles and solvent accessible surface area by our previous method SPIDER 2. Another contribution was from the established iterative deep learning scheme. The deep neural network allows us to train the server on a dataset that is >7 times larger than the previous method HSEpred, and thus avoids potential over-training of the predictor. In addition, DNN was found to be much faster toHighly accurate sequence-based predictionconverge with better performance than SVM and random forest methods in training big datasets with a large number of features (). The usefulness of predicted HSEa is demonstrated by its improved correlation to experimentally measured stability change due to mutation, over predicted ASA. Fast calculation of HSEa that requires the positions of Ca atoms only makes it an ideal sequence-specific restraint for coarse-grained modeling, protein structure prediction and refinement. The HSEa and HSEb predictors are incorporated as a package in SPIDER 2 available at http://sparks-lab.org. To speed up calculations, we provide another version by using all features except HMM profile. This version leads to a slight reduction in PCCs but cuts the total running time by half because it requires to prepare only one of the two sequence profiles that are the most time-consuming.Highly accurate sequence-based prediction
at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
R.Heffernan et al. at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
