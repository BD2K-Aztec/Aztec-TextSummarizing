Motivation: Several statistical tests are available to detect the enrichment of differential expression in gene sets. Such tests were originally proposed for analyzing gene sets associated with biological processes. The objective evaluation of tests on real measurements has not been possible as it is difficult to decide a priori, which processes will be affected in given experiments. Results: We present a first large study to rigorously assess and compare the performance of gene set enrichment tests on real expression measurements. Gene sets are defined based on the targets of given regulators such as transcription factors (TFs) and microRNAs (miRNAs). In contrast to processes, TFs and miRNAs are amenable to direct perturbations, e.g. regulator over-expression or deletion. We assess the ability of 14 different statistical tests to predict the perturbations from expression measurements in Escherichia coli, Saccharomyces cerevisiae and human. We also analyze how performance depends on the quality and comprehensiveness of the regulator targets via a permutation approach. We find that ANOVA and Wilcoxons test consistently perform better than for instance Kolmogorovâ€“Smirnov and hypergeometric tests. For scenarios where the optimal test is not known, we suggest to combine all evaluated tests into an unweighted consensus, which also performs well in our assessment. Our results provide a guide for the selection of existing tests as well as a basis for the development and assessment of novel tests.
INTRODUCTIONThe interpretation of gene expression studies is difficult because a large number of genes or other expressed sequences are profiled. Instead of individual genes, it has been proposed to analyze the expression of gene sets that correspond to biological processes. The Gene Ontology (GO;) is an example source for biological process definitions and process-associated gene sets. The analysis of expression data in the context of gene sets can be performed by many different enrichment tests (). These tests aim to detect gene sets exhibiting significant differential expression. However, it is not known a priori, which processes will be affected in a given expression experiment. This lack of a dependable standard-of-truth has prevented an objective selection and evaluation of enrichment tests on real data. * To whom correspondence should be addressed. Targets of gene expression regulators such as transcription factors (TFs) and microRNAs (miRNAs) can also be treated as gene sets. TFs are regulatory proteins that bind to the promoter regions of target genes (TGs) to regulate their levels of expression (). miRNAs are short (22 nucleotides) non-coding RNAs that are incorporated into the RNA-induced silencing complex (RISC) to regulate the stability and translation of messenger RNA (mRNA) transcripts (). The activity of such regulators is not visible on the mRNA level: TFs are frequently modulated at the post-transcriptional level () and miRNAs are usually not profiled. It is thus important to indirectly determine the activity of regulators by analyzing their TGs (). Here, the same tests are employed that were devised for analyzing biological processes (). We propose TFs and miRNAs and their associated sets of TGs for the rigorous evaluation of gene set enrichment tests. The experimental perturbation of regulators offers the required standard-of-truth that is not available for biological processes. Given regulator deletion or over-expression experiments, we consider the experimentally perturbed and the remaining regulators (with their corresponding sets of TGs) as positives and negatives, respectively. We thus evaluate the ability of statistical tests to infer the perturbed regulator from the expression of its TGs. The present study, thereby conducts the first large comparison and rigorous assessment of 14 gene set enrichment tests on real data. We applied start-of-the-art statistical methods to test whether expression changes in regulator target sets might be due to chance. In the following sections, we review the field of gene set enrichment tests and describe our approach to rank enrichment tests.
Related work: gene set analysesLong lists of differentially expressed genes (DEGs) derived from microarray experiments are used as a starting point to gain biological insights (). Several statistical methods for the analysis of sets of DEGs have been proposed (reviewed by;). Most test for the overrepresentation of predefined sets of genes (e.g. Gene Ontology) in the DEGs (). Gene set enrichment (GSE) analysis proposed by(2003) and improved by, uses an enrichment score based on a KolmogorovSmirnov test. GSE analysis has been extended () to cover multiclass, continuous phenotypes and more test statistics. More recently, GSE tests have also been applied to gene sets representing TF or miRNA TGs. Sohler and Zimmer, (2005),identified the activity of TFs by analyzing whether the TF-target gene sets are enriched among a list of DEGs using a hypergeometric (HG) test. GSE tests were also applied to detect expression changes of miRNAs based on the expression of their target gene sets (). Recently,proposed a test based on difference of ranks between the miRNA's targets and the remaining genes.
DATASETS AND METHODS
TF-gene regulatory interactionsTo investigate the influence of TFs on downstream TGs, we use TF-gene regulatory interactions to analyze large microarray compendia (). To facilitate the reproducibility of results, we only used publicly available datasets and sources in this study. From RegulonDB (
TF deletion and over-expression compendiaAs summarized in, a compendium of 907 E.coli microarrays were taken from the M3D Database (). It included knock-out (KO) and over-expression (OE) experiments for 17 TFs targeting 949 genes. In case of S.cerevisiae, we analyzed two compendia of 263 (Y1;) and 270 (Y2;) microarrays perturbing 263 TFs and 55 TFs, respectively. In total, 102 TFs (targeting 1527 genes in Y1) and 48 TFs (targeting 1094 genes in Y2) were mapped to the known interactions. Basal gene levels in the datasets can be quite different between experiments. To compensate for this, we transform the absolute expression values into log 2 fold-changes between deletion/over-expression and control. Fold-changes are computed by mapping a condition measuring a perturbed TF to one or more control conditions without the perturbation.
miRNA-target gene associationsSeveral computational algorithms have been developed to predict TGs of miRNAs. We obtained putative human miRNA-target pairs predicted by PITA (), PICTAR () and TargetScan(). In addition, several databases collect TGs of the miRNAs in different organisms. Human miRNAgene associations were obtained from the curated databases TarBase (), miRecords () and miR2Disease (). From miRSel (), we obtained putative miRNAgene associations and relations extracted from biomedical abstracts by text mining (and Supplementary Material 1).
miRNA transfection compendiaWemeasured p53-inducible miRNAs, miR-192 and miR-215, at 10 h and 24 h after miRNA transfection in a human cell line (i.e. HCT116 Dicer-/-#2).measured the gene expression data in HeLa cells at 24 h after miR-124, miR-1 and miR-181a transfection. Expression data were also measured byin HeLa cells at 12 h and 24 h after over-expression of miR-7, 9, 122, 128, 132, 133, 142 and 181a.
Assessment of TF and miRNA activityTo determine activity changes of TFs and miRNAs, we apply several gene set enrichment approaches to test the null hypothesis (H o ) whether the expression levels of regulator downstream targets could be sampled from the background distribution of the remaining (i.e. non-target) genes. Our approach to assess gene set enrichment tests is depicted in. In the following sections, we describe how the standard-of-truth is derived and how sign annotations are used to treat the up-and down-regulation of TGs.In our assessment scenario, we evaluate the ability of statistical tests to infer an experimentally perturbed (i.e. deleted or over-expressed) regulator from the expression of its TG (see Section 2.9). Thus, the identities of the perturbed regulators represent the standard-of-truth. It is compiled into a label matrix that assigns 1 if the given regulator is perturbed in a given measurement or 0 otherwise (). Some TFs are excluded from the assessment. We exclude TFs that exhibit fold-changes smaller than a predefined threshold: here, it is unclear whether the perturbation was effective. We also exclude TFs that exhibit large foldchanges but have not been directly perturbed: they could be direct or indirect targets of a perturbed TF. By varying fold-change thresholds (see Section 3), the performance dependency on the definition of positives can be explored. Since the expression levels of miRNAs have not been measured, all miRNAs are used to determine the performance of tests.
Preprocessing of the data matrixBefore applying enrichment tests, the given gene expression measurements can be preprocessed, so that the interaction signs are either utilized or neglected, i.e. that a TF activates (+) or inhibits () a given target.compiled into a label matrix to represent the standard-of-truth. Perturbation of a regulator results in up-(red) or down-regulation (blue) of its TGs. After (b) processing the data matrix (), GSE tests are (c) applied to determine the activity of regulators based on the expression of TGs. The resulting score matrix (e.g. P-values) is compared with the label matrix to (d) compute the AUROC.The absolute-one-sided (H abs o ) test ignores interaction signs. Enrichment is tested on absolute log fold-changes to evaluate the differential expression of TGs regardless of up-and down-regulation (, left). In contrast, the signed-two-sided (H sign o ) scenario can only be applied to E.coli since only RegulonDB provides sign annotations for gene regulatory interactions. We negate fold-changes for TGs that are inhibited by the given regulator. Thus, all TGs of a regulator should either exhibit enrichment of positive or negative fold-changes in case of increased or decreased regulator activity, respectively. Enrichment at either tail of the distribution is then determined by two-sided tests (, right).
Consistency of signs and fold-changesTo evaluate sign annotations, we define consistency as the fraction of the observed fold-changes that conform to the annotated interaction signs, e.g. in case of an activating (or inhibiting) relationship, an up-regulated TF is expected to cause up-(or down-) regulation in a corresponding TG, respectively. A higher consistency value denotes a better correspondence between observation and annotation where perfect or no correspondence is indicated by a consistency of 1 or 0.5, respectively. Values <0.5 indicate that signs and observations mostly disagree. TFs and TGs are considered regulated if they exhibit absolute log 2 fold-changes that exceed a defined threshold (e.g. between 0 and 2). As a second variant, we only consider TFs as regulated if they are deleted or over-expressed in the given experiment.
Performance assessment and randomizationEnrichment tests are applied to the processed data matrix (). This results in one test score for each combination of a TF and a mRNA measurement. Scores are then evaluated against the standard-of-truth via the area under the receiver-operating characteristic (AUROC) as discussed in. The AUROC compares continuous test scores (: Score Matrix) against discrete regulator states (1 = active, 0 = inactive;: Label Matrix). Thus, AUROC is a summary measure of the tests ability to consistently assign higher scores to active regulators and lower scores to non-active regulators based on given measurements. AUROCs of 1 or 0.5 represent a perfect or random test performance, respectively. In addition to applying the tests to the data matrix, we also progressively randomize the set of regulator TGs to evaluate how much the performance of statistical methods depends on the quality of the known interactions. We generate new target sets that are randomized by x% (where x = 25, 50, 75 and 100), i.e. by randomly selecting x% of the available interactions and exchanging the true TG in such an interaction by a random non-TG. An average AUROC is determined by applying GSE tests on 100 randomized networks for each x.
Enrichment testsThe statistical tests below evaluate the null hypothesis that the two distributions of log 2 fold-changes of targets and non-targets of a given regulator differ. The first category are over-representation tests [KolmogorovSmirnov (KS) and HG] that do not take the expression values or their ranks into account. The KS test () estimates the maximum possible enrichment by varying the length of the list of genes. In contrast, the HG test () requires a threshold parameter to select DEGs. We select genes exhibiting fold-changes >0.5, 1.0 or 1.5 (see Supplementary Material 2 for additional thresholds). For a given regulator i, the P-value is computed via:where N is the population size or number of DEGs in a given chip measurement; m is the number of successes in a population or a set of DEGs filtered based on a given regulated gene threshold value; k is the number of regulator TGs, and x is the number of common DEGs in m and k. ANOVA and the bootstrap test (BT) are evaluated on the gene expression values. In the given setting, the two sample-ANOVA are equivalent to the t-test (). BT () calculates the statistic for two bootstrap samples drawn randomly from the original data of regulator targets and non-targets, and then calculates the proportion of these that are less than or equal to the lower tail, greater than or equal to the upper tail, or either (two tails). Bootstrap is based on the difference in means measured by the t-test. In contrast to ANOVA and BT, the null hypothesis of the Wilcoxon non-parametric rank-sum method [WR;tests whether regulator targets exhibit no significant rank differences in comparison to other (non-targets) genes. The ranks are derived by sorting the genes based on either their absolute or signed log fold-changes (). If the rank distributions of targets and non-targets of the tested regulator are significantly different, the null hypothesis will be rejected. We refer to such a TF/miRNA as active regulator for the tested experiment. In contrast to KS and HG, expression values or their ranks are used by ANOVA, BT and WR. The latter three tests can thus effectively take the noise levels of genes into account. The test statistics of all tests discussed so far result in P-values, i.e. the probability that the observed differences between distributions are due to chance. We further analyze several tests calculated based on fold-changes. The average fold-change (FC-score) of a regulator is defined as the difference of the average mean expression levels between its targets and non-targets. A positive FC-score indicates that the TGs of a regulator are expressed at higher levels than non-TGs. The higher is the FC-score, the stronger is the effect of a regulator on its targets ().
Assessment of gene set enrichment testsThe average gene rank (FCR-score) of a regulator is defined as the difference of the average rank between its targets (T ravg ) and non-targets (nT ravg ). The genes ranks were derived by sorting them based on their absolute or signed fold-changes:where for a given regulator, n and j represent the number and t i and t j represent the ranks of regulator targets and non-targets, respectively. The average fold-change rank weight (FCRW-score) of a regulator is defined as the difference of the combined average rank and expression levels between its targets and non targets. We derive the ranks of genes by sorting them based on their absolute or signed fold-changes ():where w i and w j are the ranks and t i and t j are the fold-changes of targets and non-targets, respectively. Median: The median (MED) of a regulator activity is defined as the difference of the median expression levels between its targets and nontargets. Consensus prediction: A number of tests have been applied to TF to test for over-representation of its targets among the DEGs. For each test, ranks of the regulators are determined by sorting them based on their scores. We define a consensus score (CON) based on the unweighted average of the ranks of a regulator determined by other statistical methods/tests as described above. This approach is called Borda count voting (Borda, 1781). For a given regulator j, the consensus score is calculated as:where n represents the number of tests applied to calculate the significance of a regulator in a given experiment. Thus, R ji represents the rank of a regulator j for a given statistical test i. We also analyzed two recently developed tests, the Gene Set Z-score (GSZ,) and the model-based gene set analysis (MGSA;). GSZ combines features of the KS test (estimating the maximum enrichment) and the fold-change based methods that compare mean expression of targets and non-targets. MGSA models gene responses via Bayesian networks. In contrast to the tests described above, both GSZ and MGSA analyze all gene sets at once. Similar to the HG test, MGSA requires a threshold (used 0.5, 1.0 and 1.5 as for the HG test) to determine differentially expressed genes. Due to performance issues, the more involved permutation analyses were not performed for GSZ and MGSA.
RESULTS
Detection of TF activity without sign annotationsWe first evaluate the ability of the applied enrichment tests to predict TFs that have been deleted or over-expressed. At this point, sign annotations are ignored, i.e. we test H abs 0. Perturbations are only considered effective if the TFs exhibit a fold-change of at least 2 or <0.5. Conversely, substantial fold-changes in non-perturbed (secondary) TFs can be due to a direct or indirect effect from the perturbed (primary) TFs. Such cases are also excluded from the evaluation. In case of negative examples, we vary the foldchange cutoff to explore its influence on the performance of the enrichment tests (). At a higher cutoff, more negative examples are included in the analysis, which leads to a slightly decreased performance but hardly influences the overall ranking of enrichment tests (seefor AUROCs at a cutoff of 0.5). In addition, we also combine individual tests into a consensus. The scores in the individual score matrices () are transformed into
Detection of TF activity with sign annotationsThis section evaluates if test performance can be improved by exploiting the annotation provided by RegulonDB. This annotation distinguishes whether the TF activates or inhibits a given TG. H abs 0 as applied in the previous section, tests only for differential expression. By using H sign 0 instead, we also test whether the foldchanges observed in TF targets are consistent with the interaction sign annotations. Neglecting signs slightly but consistently improves the performance of enrichment tests (). To evaluate why the interaction sign annotations do not improve our results, we compare the signs to the observed foldchanges. Activating interactions conform to our expectation, i.e. up(or down-) regulation of a TF causes up-(or down-) regulation, respectively, of their TGs. In case of inhibiting relationships, we expect opposite fold-changes in TFs and TGs. This occurs only rarely in the data at hand () and thus explains the reduction in the performance of the signed tests.
Detection of miRNA activityIn addition to TF-target relationships, we also evaluate miRNA target relationships based on miRNA transfection experiments in human cell lines. Here, a range of miRNA-target set definitions are employed: databases only (AUROC ANOVA 0.63), DBs+PICTAR+TargetScan (high precision prediction tools, AUROC ANOVA 0.83) and DBs+PITA (high recall prediction tool, AUROC ANOVA 0.84). Although, the quality of computational miRNA target predictions has been discussed controversially (e.g.), they are required to complement manual repositories, which appear to be not sufficiently comprehensive for this analysis. Although this setting deviates considerably from the previously discussed ones, the overall ranking of methods is again very consistent (). An exception is HG-0.5 showing the third best performance after ANOVA and GSZ.
Randomized testingTo determine how the test performance depends on the quality of the available gene regulatory networks, we progressively randomize the regulator target sets. The ability of the different tests to infer the activity of TFs is surprisingly stable even if, on average, 50% of the gene regulatory network is randomized ().
Overall ranking of methodsAverage ranks for the examined tests are computed based on their performance across different partially randomized expression compendia (E.coli, S.cerevisiae and human) and different scenarios (H abs). Thereby, we derive the following ordering of methods: ANOVA > GSZ > CON > WR > HG-0.5 > FCR > KS > HG-1.0 > BT > HG-1.5 > FC > MED > FCRW > MGSA. ANOVA, GSZ, CON and WR perform consistently well across all scenarios. While HG-0.5, FCR and KS also deliver usable results but fail in individual scenarios, the remaining tests (HG-1.0, BT, HG-1.5, FC, MED, FCRW and MGSA) performed below average across several scenarios (). We note that predictions by several methods are quite similar (see Supplementary Material 3) so a consensus of just ANOVA, WR and HG-0.5 is sufficient to improve the AUROC in E.coli from 0.80 to 0.84.
DISCUSSION AND CONCLUSIONGene set enrichment tests have been devised to detect an overrepresentation of differentially expressed genes in predefined gene sets that correspond to biological processes. A dependable standardof-truth is not available since it is difficult to decide a priori, which biological processes will be affected on the mRNA level. This has previously prevented the objective selection and evaluation of enrichment tests on real measurements. Instead, we derived gene sets from the targets of gene expression regulators (miRNAs and TFs) whose experimental perturbation directly offers the required standard-of-truth. In this setting, we evaluated the ability of 14 frequently used statistical tests (compare) to detect regulator perturbations. Regulator activities cannot be derived directly from RNA expression levels: TFs are frequently regulated on the protein level and miRNAs are often not profiled. The indirect inference of regulator activities from the expression of their TGs is thus an important task. We observed that, e.g. ANOVA and Wilcoxons test outperformed the HG and KS tests, which are most frequently used in practice. Tests depending on a threshold (HG, MGSA, compare Supplementary Material 2) yielded mixed results but improved for small thresholds below fold-changes of 2. Despite the diverse test performance (AUC between 0.5 and 0.86 for E.coli), an unweighted consensus of all approaches consistently showed good results. Analogously, the GSZ score() combining features from enrichment and foldchange based methods also showed very good results. Parametric tests expecting normally distributed data such as ANOVA performed well as the data used in our study are indeed approximately normal (see Supplementary Material 3 or). Surprisingly, test performance did not improve by using interaction signs (activation versus inhibition). Here, we tested whether the fold-changes observed in TF targets are consistent with the given interaction sign annotations. Fold-changes and signs were clearly consistent in case of activation where activators caused target expression changes of the same sign. We did not find such coherent relationships between the fold-changes of repressors and their targets. According to, this low correlation can be explained by the observation that either inhibitors or their targets exhibit low expression levels that are not profiled reliably. To ensure the wide applicability of our results, we employed a variety of settings. In terms of microarray data, we used TF perturbations in E.coli (one expression compendium) and S.cerevisiae (two compendia) to compare results between a prokaryote and a eukaryote model organism. We also analyzed a third setting, the transfection of human cell lines with miRNAs. Performance on S.cerevisiae and human is lower than that for E.coli, which might be due to the lower quality of the available TF-/miRNAtarget networks and the more complex regulation in eukaryotes (). The performance ranking of the tests was very consistent between each of the examined scenarios, with several methods always performing substantially better than random guessing. We thus expect that the ranking of the 14 tests will be meaningful in novel settings that deviate from the ones described here. An example is the application of the tests to biological processes, where we expect the consensus to yield the most reliable results. Via an additional permutation approach, we analyzed how enrichment tests depend on the quality and comprehensiveness of the known regulator-target relationships. Most methods showed only a moderate decrease in performance even after randomizing 50% of the gene regulatory network. We therefore conclude that the gene set definitions derived from the known gene regulatory interactions are sufficient to enable the comparative assessment of enrichment tests as well as the detection of regulator activities in real mRNA expression compendia.
Assessment of gene set enrichment tests
The Author 2012. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oup.com at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from Assessment of gene set enrichment tests
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
