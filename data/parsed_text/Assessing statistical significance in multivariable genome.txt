Motivation: Although Genome Wide Association Studies (GWAS) genotype a very large number of single nucleotide polymorphisms (SNPs), the data are often analyzed one SNP at a time. The low predictive power of single SNPs, coupled with the high significance threshold needed to correct for multiple testing, greatly decreases the power of GWAS. Results: We propose a procedure in which all the SNPs are analyzed in a multiple generalized linear model, and we show its use for extremely high-dimensional datasets. Our method yields P-values for assessing significance of single SNPs or groups of SNPs while controlling for all other SNPs and the family wise error rate (FWER). Thus, our method tests whether or not a SNP carries any additional information about the phenotype beyond that available by all the other SNPs. This rules out spurious correlations between phenotypes and SNPs that can arise from marginal methods because the 'spuriously correlated' SNP merely happens to be correlated with the 'truly causal' SNP. In addition , the method offers a data driven approach to identifying and refining groups of SNPs that jointly contain informative signals about the phenotype. We demonstrate the value of our method by applying it to the seven diseases analyzed by the Wellcome Trust Case Control Consortium (WTCCC). We show, in particular, that our method is also capable of finding significant SNPs that were not identified in the original WTCCC study, but were replicated in other independent studies. Availability and implementation: Reproducibility of our research is supported by the open-source Bioconductor package hierGWAS.
IntroductionGenome-wide association studies (GWAS) have enjoyed increasing success and popularity in recent years, due mostly to the thousands of genetic variants found to be significantly associated with complex traits (). The two common designs are case control studies, which look for associations between SNPs and disease, and population-based studies which focus on finding associations between SNPs and continuous traits (). The larger goal of these studies is to function as hypothesis-generating machines, resulting in sets of loci that require further analysis. Thus GWAS are an important first step in the gene identification process (). The findings from these studies provide preliminary genetic information, which need additional analysis and follow-up experiments to be validated. However, many studies have found only a few common SNPs per trait, and these SNPs have generally low predictive power, explaining only a small percentage of the variance (). Often, SNPs are tested individually for association with the phenotype, using the Armitage Trend Test. Because genome-wide scans analyze hundreds of thousands or even millions of markers, the multiple testing issue is resolved by applying a stringent significance thresholdmost commonly 5  10 8 ()to the P-values. This method is successful only if the study is well-powered, such that the associations are strong enough to pass the stringent threshold. However, even if that is the case, this type of analysis has several limitations, which have been addressed in the literature (). Here we focus on two of them. First, single SNPs tend to have small effect sizes. We can increase the explanatory power by looking at the joint effect of multiple SNPs. Second, when we test a SNP individually, we ignore the effects of all other SNPs. If we analyze marginally two sufficiently correlated SNPs, out of which only one is causal for the disease, both may show an association. This leads to higher false positive rates. Joint modeling of all SNPs is challenging. Since in most GWAS the number of SNPs is much larger than the number of samples, the data cannot be analyzed using standard multivariable approaches. An established method in the field is the Genome-wide Complex Trait Analysis (GCTA), which is based on linear mixed models () and enables some joint analysis of SNPs. It allows for statistical significance tests of single SNPs (as fixed effects) while all SNPs other than the considered single SNP are built into the model as a simultaneous random effect. We would classify the obtained statistical significance of the SNPs as a hybrid between marginal (with only one or a few SNPs as fixed effects) and joint (since all the SNPs are in the model) modeling. It also enables to assess the combined effect of all SNPs which quantifies the heritable component of phenotype variation explained jointly by all the genotyped SNPs (). Another solution to the high-dimensionality of the problem is the use of penalized regression, which constrains the magnitude of the regression coefficients, and allows them to be estimated. The two most widely used penalization methods are the Lasso () and Ridge regression (). The Lasso penalizes the sum of the absolute values of the regression coefficients. It is a sparse estimator, meaning that it sets some regression coefficients to zero, while keeping others non-zero. Ridge regression penalizes the sum of squared regression coefficients, but it does not reduce the number of parameters in the model. Init has been shown in the context of GWAS that penalization decreases the false positive rate and increases the probability of detecting the causal SNPs. There are several papers which consider a joint analysis. Methods which apply a penalized model include: the Bayesian Lasso (), a twostage procedure using single regression followed by a Lasso selection (), stability selection in the context of GWAS (), the so-called ISIS (Iterative Sure Independence Screening) combined with stability selection to select significant SNPs (), a combination of Lasso and linear mixed models (), Lasso for screening () or ridge regression (). None of the proposals () compute P-values for SNPs.aims to control the type I error rate, the approaches using stability selection aim to control the expected number of false positive selections (Meinshausen and B hlmann, 2010), whilecontrols the False Discovery Rate (FDR). Our goal is to construct valid P-values for SNPs in a (joint) multiple generalized linear model together with a computationally efficient and powerful way to address the issue of massive multiple statistical hypothesis testing. The problem is challenging due to the complex setting with hundreds of thousands of SNPs. Our method relies on a hierarchical procedure from Mandozzi and B hlmann (2015) which we apply here for the first time to GWAS with very high-dimensional datasets. It provides P-values for multiple (joint) regression modeling of SNPs in high-dimensional settings. We compute P-values not only for individual SNPs, but also for groups of SNPs. The idea is to adapt to the strength of the signal present in the data: if the signal is too weak or the SNPs exhibit too high correlation, we might still detect a significant group of SNPs, instead of single SNP markers. Additionally, we compute the explained variance for every such group in a high-dimensional generalized linear model. We demonstrate our method on the WTCCC data (The Wellcome Trust Case Control), due to the fact that strong associations have been found for some phenotypes in this dataset, and many of their findings have been replicated in subsequent studies. However, our method's advantages are also evident for phenotypes with weak associations: for biologically distant phenotypic traits, the goal is rather to find regions of the genome that are strongly associated with the phenotype. Our proposed method makes it statistically and computationally possible to assess the significance of the parameters in a multiple (generalized) linear model, for large scale GWAS problems with millions of SNP markers. The interpretation of the parameters in a multiple (generalized) linear model is markedly different from marginal association and also from GCTA (). In fact, under some assumptions, we can link the (joint) multiple linear model to causal inference (see Section 2.1). Thus, it as an important step to perform the statistical inference in a multiple generalized linear model.
MethodsConsider the following setting and notation. There are n samples (e.g. persons in a study), and each of them is indexed with i 2 f1;. .. ; ng. A response variable Y i for the ith sample point (e.g. the ith person in the study) encodes the status of a phenotype of interest. For example the binary status of a disease with Y i 2 f0; 1g, the continuous value of a survival time with Y i 2 R  or the continuous degree of an exposure or (log-) concentration with Y i 2 R. The regressor X i is a (long) p  1 vector which encodes the SNP profile for the ith sample point: X i;j 2 f0; 1; 2g is the value of the jth SNP for sample point i, taking three possible values corresponding to the number of minor alleles per person. Typically, the number of SNPs (regressors) is p % 10 6 , while the number of samples is at least one order of magnitude smaller. A model measuring multivariable association is introduced next.
Generalized linear modelsA well-established model for relating the phenotype (response variable) and the SNPs (regressors) is a generalized linear model ().
Multivariable genome wide association analysisThe easiest form thereof is a linear model for continuous (R-valued) responses: Y i  b 0  X p j1 b j X i;j  e i i  1;. .. ; n;where e 1 ;. .. ; e n are independent and identically distributed noise terms with expectation Ee i   0, finite variance and which are uncorrelated with the regressors X i;j. For binary responses with Y i 2 f0; 1g, representing case ( 1) or control ( 0), we consider a logistic regression model:p i  PY i  1jX i ; b  expg i  1  expg i  ; i  1;. .. ; n;Here, p i represents the probability of individual i having a case status given its SNPs X i. There is no additional noise term and the stochastic nature of the model comes from the probability p i. In both models, b 0 denotes the intercept, and the coefficients b j are the (logistic) regression coefficients which measure the association of the jth SNP with the response. Such models, which take into account all SNPs, have two features. First, the (generalized) regression coefficients have the following (well-known) interpretation: b j measures the association effect of X i;j on Y i which is not explained by all other variables fX i;k ; k 6  jg. Thus, a large b j , in absolute value, has the very powerful interpretation that SNP j has a strong association to the phenotype given all other SNPs or controlling for all other SNPs. This is in sharp contrast to marginal correlation between SNP j and the phenotype Y which can easily be of spurious nature and caused by another SNP k having a strong correlation with the phenotype and with SNP j. Furthermore, the regression models are predictive in the sense that for a new sample point (e.g. person) with a given SNP profile X new we obtain a prediction for the corresponding phenotype (e.g. disease status) EY new jX new   b 0  P p j1 b j X new;j or PY new  1jX new   g new , where g new  b 0  P p j1 b j X new;j. Note that this prediction is likely to be more informative or precise than a prediction that is based merely on marginal correlations because the general linear model applied here enables us to use the whole new SNP profile, and not just single SNPs, for predictive purposes. Our main goal is to infer statistical significance of a single SNP or of a possibly large group of correlated SNPs for a given phenotype. More precisely, we aim for P-values, adjusted for multiple testing, when testing the following hypotheses:for single SNP j H 0;j : b j  0 versus H A;j : b j 6  0;or for a group G f1;. .. ; pg of SNPs H 0;G : b j  0 for all j 2 G versus H A;G : at least for one j 2 G we have that b j 6  0:The obtained P-values are with respect to a regression model and hence, they share the interpretation with the regression parameters described above. In particular, they are markedly different from a marginal or linear mixed model approach: the differences are also illustrated in simulation studies in Section 3.1.A link to causal inference. If we assume (i) that the model is correct and that beyond the measured SNPs there are no hidden confounding variablesa condition that might be somewhat less problematic when having a million or more SNP markersand (ii) that the causes point from the SNPs to the phenotype Y, the parameters b j j  1;. .. ; p can be given a causal interpretation. This link to causal inference shows again that a (joint) multiple regression model is very different from a marginal model. In a structural equation model the assumption that the causes point from the SNPs to the phenotype Y means that the arrows in a directed acyclic graph, that encode the causal influence diagram, point to Y and never point away from Y, i.e. Y is childless. Such an assumption says that some SNPs might be the cause for a phenotype, but the phenotype cannot be a cause for the SNPs, which seems a very reasonable assumption. Under these conditions, the following holds: if b j 6  0, then there must be a directed edge in the causal influence diagram of a linear structural equation model from SNP j to the phenotype Y with nonzero edge weight, i.e. there exists a non-zero direct causal effect from SNP j to the phenotype Y. This statement is not true with marginal associations (i.e. if SNP j is only marginally associated with Y) since adjusting for all other SNPs (different from SNP j) is crucial for causal statements. The details are given in Proposition S1.1 in the Supplementary Material Section S1.
The challenge of high-dimensionalityThe difficulty with a regression type analysis is the sheer highdimensionality of the problem. The number of SNPs p % 10 6 is massively larger than sample size n, which is at least one order of magnitude smaller. In such scenarios, standard statistical inference methods fail. Recent progress based on new methods such as multiple sample splitting, has allowed us to obtain statistical significance measures for regression parameters b j (, cf.) or groups thereof (Mandozzi and B hlmann, 2015). We rely here on this method (), which shows reliable performance over a wide range of simulation settings (), and enjoys the property of being computationally vastly more efficient than procedures which operate on the entire dataset. We extend the procedure from Mandozzi and B hlmann (2015) from linear to logistic regression, and we show here for the first time how it performs for extremely high-dimensional GWAS data. The entire statistical procedure is schematically summarized in. In view of the high-dimensional nature of GWAS, it is rather unlikely to detect single SNPs which are significant when controllingThis testing is done hierarchically, on the cluster previously constructed. The output of the method consists of significant groups, or single SNPs, along with their P-values, that are adjusted for multiple testing for all other SNPs. Thus, it is a-priori more likely to detect (large) significant groups of SNPs with respect to the group hypotheses H 0;G in a regression model. The construction of such groups is achieved by clustering the SNPs, as explained next.
ClusteringOur goal is to perform significance testing on single SNPs (the hypotheses H 0;j ) as well as arbitrarily large groups of SNPs (the hypotheses H 0;G ). We do this hierarchically since this allows for powerful multiple testing adjustment as well as for efficient computation (see Section 2.4). We first discuss the hierarchical clustering of SNPs. The hierarchy can be constructed in different ways. One option is to use specific domain knowledge to group the SNPs, for instance by clustering them first into genes, and then into functional pathways. Another option is to use standard hierarchical clustering methods which rely on a distance measure between the SNPs. Here we adopt the second approach, which is similar to the construction of haplotype maps (). We use hierarchical clustering with average linkage () which can be represented as a cluster tree, denoted by T. The method requires a distance or dissimilarity measure between SNPs. We consider the distance between two SNPs as one minus their linkage disequilibrium (LD) value, where LD refers to the statistical dependency of the DNA content at nearby locations of the chromosome. One of the most common measures of LD is the square of the Pearson correlation coefficient (), which quantifies the linear dependence between two loci. Thus, two SNPs will have an LD equal to one if they are perfectly correlated, or an LD equal to zero if they are uncorrelated. Since LD has a tendency to decay with the distance of the studied loci, close-by SNPs are typically in high LD. This means that SNPs belonging to the same gene, or more generally, neighboring SNPs will end up in the same cluster. Often, LD is studied within each chromosome separately. Therefore, we construct separate cluster trees for each chromosome (in addition to providing a biological interpretation, clustering each chromosome separately results in substantial computational gains for problems with p % 10 6 SNPs), and we then join these into one tree T which contains all the SNPs in the study, as shown in.
Statistical significance testingA cluster, as described in Section 2.3, is denoted by the generic letter G which encodes a subset of f1;. .. ; pg of single SNPs. We explain here how to test a null-hypothesis for a group H 0;G in (4) or for a single SNP H 0;j in (3).
Hierarchical inferenceIn Section 2.4.2 we will show how one can construct valid P-values for the hypotheses H 0;j and H 0;G. On the basis of valid P-values, our hierarchical approach proceeds as follows: 0 < a < 1, where P H0 denotes the probability assuming that H 0 is true). Due to the high-dimensionality with p ) n, obtaining a P-value for the hypotheses H 0;j or H 0;G in (3) or (4) is a non-trivial problem. We rely here on a multiple sample splitting approach from, and we follow exactly the method from Mandozzi and B hlmann (2015). The idea is as follows. For b  1; .. . ; B repetitions: 1. Randomly partition the n samples into two parts, say N b in and N b out. 2. Using a variable selection procedure such as the (logistic) Lasso (), select regressors (SNPs) based on data from the first half-sample N b in. Denote the selected regressors by ^ S b f1;. .. ; pg. Because a Lasso estimated model has cardinality smaller or equal to minn; p, the number of selected variables j ^ S b j < n=2 will be smaller than half of the sample size. We choose to select the first n=6 SNPs that enter the Lasso path. This ensures that we have enough regressors for computing P-values. 3. Based on data from the second half-sample N b out , use classical P-value constructions in a linear or generalized linear model with the selected regressors (SNPs) from ^ S b in the previous step. The construction of a P-value of a cluster G is done in the following manner: we intersect the hierarchy T constructed in Section 2.3 (using hierarchical clustering) with ^ S b , obtaining an induced hierarchy with root node ^ S b. The testing is then applied on this induced hierarchy. Finally we assign the P-value to the entire cluster G, although we have only used the variables inwhere p G 0 out is the P-value for H 0;G 0 based on data from N b out (G 0 f1;. .. ; pg). For a cluster G 2 T , the multiplicity adjusted P-value is defined as:G;b adj  1 otherwise. 4. Repeat steps 1-3 B times (with e.g. B  100) and aggregate the B P-values (separately for every hypothesis). The aggregated Pvalue of any cluster G is computed by considering its empirical quantile:where Q G c  minf1; q c fp G;b adj =c; b  1;. .. ; Bgg; c 2 0; 1; c min  0:05 and q c  is the empirical c-quantile function. Finally, the hierarchically adjusted P-value of a cluster G is:The sample splitting in step 1 is made to avoid being over-optimistic when performing variable selection and P-value construction on the same dataset. The repeated sample splitting in step 4 helps to achieve much more reliable results which do not depend in a sensitive way on how we split the sample (). More details about the assumptions which guarantee control of the familywise error rate are provided in Supplementary Material Section S2. This multi-sample splitting method is computationally fast since Lasso in step 2 is rather cheap to perform and step 3 requires classical P-value computations in low-dimensional models with fewer than n regressors only. In terms of accuracy for type I error control, i.e. avoiding false rejections of hypotheses, the multi-sample splitting approach has been found very reliable in extensive simulations relative to other methods. This reliability comes at the price of being slightly inferior in terms of power to detect true underlying positive findings (), see also Mandozzi and B hlmann (2015). However, this slightly more conservative scheme has the advantage of limiting false positives.
Results
Simulation studiesWe used the WTCCC Crohn's disease genotype data to create semisynthetic datasets. To generate the new genotype matrix, we kept all the samples (n  4682), but selected a block of 500 consecutive SNPs from each of the 22 autosomal chromosomes, having in total 11 000 SNPs. The phenotype data was generated from a logistic regression model with the probability of having the disease as the dependent variable and 10 causal SNPs as the independent variables. We considered three designs for choosing the causal SNPs: 1. Randomly select a set of 10 consecutive SNPs from chromosome 1. The regression coefficients are sampled with replacement from the set {-2,-1.75,-1.5,-1.25, 1, 1, 1.25, 1.5, 1.75, 2}. 2. Randomly select a set of 5 consecutive SNPs from chromosome 1 and 5 consecutive SNPs from chromosome 2. The regression coefficients are sampled with replacement from the set {-1,0.75,-0.5, 0.5, 0.75, 1}. 3. Randomly select a set of 10 non-consecutive SNPs from chromosome 1. The regression coefficients are sampled with replacement from the set {-2,-1.75,-1.5,-1.25,-1, 1, 1.25, 1.5, 1.75, 2}.To ensure that the number of cases and controls are not too different, we required the ratio between cases and controls to be within the interval 0:67; 1:5. We kept the genotype matrix constant, and generated 100 simulation runs for each design, using new coefficients for every simulation run. We chose to compare our method to three other algorithms. One is the classic bivariate testing, implemented in PLINK (). The other two are mixed model approaches: the FaST-LMM () and the GCTA () algorithms. Both calculate a genetic relationship matrix (GRM) to control for the effect of the other SNPs. There are many ways of computing the GRM. One can use all the SNPs, or just a particular subset. An approach that is computationally efficient is leave-one-chromosomeout (LOCO) (). With this option when one tests the SNPs in a particular chromosome, the SNPs from all the other chromosomes besides the one being tested are used to compute the GRM. The main difference between mixed models and our method is the way in which the effects of other SNPs are modeled. While the mixed model uses a random component to account for all the other SNPs, our method considers each SNP as a fixed effect, and includes all of them in the model. Our goal was to assess how good these methods are at detecting the causal variants (which are known for simulated data), while limiting the number of false positives: SNPs that are not truly causal (but perhaps correlated with the causal variants). Assessing the performance of the methods was done by considering several criteria. The first is the FWER, which we expect to be controlled at level a. This is equivalent to expecting 100 a false discoveries, when performing 100 simulations. As a less conservative criterion, we also consider the k-FWER, a generalized version of the FWER. The kFWER is defined as PfV ! kg, where V is the total number of false rejections. For our simulations, we are interested in the value of k, under which the k-FWER is controlled at level a  0:05. In the case of our method, a rejection is considered false only if the cluster does not contain any of the true causal SNPs. The third assessment criteria is the power of the method. Also here we consider two variants. The first is a 'naive' version, which considers all findings where the true causal SNP is present in a cluster, irrespective of the cluster size. The second metric penalizes the size of the group with respect to the causal variants. This is computed in the following way:where G sign is the set of groups declared significant by our method, and S 0 is the set of true causal SNPs. For the three comparison methods, we declare significant SNPs that have a P-value below 5  10 8 , and compute the power, FWER and k-FWER using this set. The results shown inare in line with our expectations. In the first 2 designs, our method has a lower power compared to the other three methods that behave almost identically. The cost of a larger power is however a significant increase in the number of false positives. While our method fails to control the FWER due to the very complex correlation structure in the data, it does however control the 2-FWER at level a. This means that the probability of making more than 2 false rejections is below a. In comparison, the other three methods do on average at least one order of magnitude more false rejections. This has to do with the fact that they infer marginal associations, or associations which are partially adjusted by random effects: many significant findings are spurious because of high correlation between some of the SNPs. The lower power of our hierGWAS procedure can be explained by the fact that it aims to infer associations which are adjusted for other SNPs: our method would detect some of them individually, some of them as groups, and if the correlation among some SNPs is too strong (or the signal too weak), it would miss some. This becomes apparent also when we consider the two power measures: POW adaptive is always smaller than POW, because some of the causal SNPs will be grouped into clusters, due to their correlation structure. In the case of the third design, our method has the same power as the other three to detect the causal SNPs. If we assume that this is close in spirit to the real life case of having one causal SNP surrounded by many others that are in LD with the causal one, our method has the power to detect it just as well as the marginal methods, while providing a greatly reduced set of false positives, and a much stronger interpretation of the findings. While the FWER is the highest in the third design, due to the fact that there are many more confounders around each SNP compared to the other two designs, our method still performs much better, by controlling the 3-FWER at level a. We note that GCTA and FaST-LMM have a slight disadvantage regarding the control of false positives, because we used the LOCO approach to compute the GRM. However, since this is an established approach, and the strategy of eliminating only the SNP being tested, and using all other SNPs to construct the GRM is computationally infeasible (), we believe that this situation reflects reality.10 4 , the threshold for strong association was set to 5  10 7. Using the standard marginal analysis, the WTCCC study identified 21 new SNPs strongly associated to the phenotype. For BD rs420259 on chromosome 16, for CAD rs1333049 on chromosome 9, for CD, the WTCCC study identified 9 SNPs strongly associated to the phenotype: rs11805303 on chromosome 1, rs10210302 on chromosome 2, rs9858542 on chromosome 3, rs17234657 and rs1000113 on chromosome 5, rs10761659 and rs10883365 on chromosome 10, rs17221417 on chromosome 16 and finally rs2542151 on chromosome 18. 2 SNPs were found for RA: rs6679677 on chromosome 1 and rs6457617 on chromosome 6. T1D was strongly associated to 5 SNPs: rs6679677 on chromosome 1, rs9272346 on chromosome 6, rs11171739 and rs17696736 on chromosome 12 and rs12708716 on chromosome 16. Finally, for T2D 3 associations were found: rs9465871 on chromosome 6, rs4506565 on chromosome 10 and rs9939609 on chromosome 16. For HT, the WTCCC did not find any SNP strongly associated to the phenotype. Before applying our analysis, we have preprocessed the data, by excluding some SNPs and samples, as well as imputing the missing SNPs. Details about this procedure are given in the Supplementary Material Section S4.1. The output of our method is a list of SNP groups of different sizes. These represent the smallest jointly significant groups in the hierarchical tree of SNPs. We create a distinction between small (<10 SNPs) and large groups, and present the corresponding results separately. The number 10 is somewhat arbitrary and determined by notational simplicity to list at most 10 SNPs per group. We identified small groups for 5 of the 7 diseases, and present them below. Large groups have been identified for all of the diseases, however we chose to present in detail the results for BD only. We chose BD because it is the disease for which the WTCCC found a single strongly associated SNP, which we did not identify using our method. The large groups for the other six diseases are detailed in theSupplementary Material Section S4. It is important to note that these groups are not overlapping. For example, if in a specific chromosome we find a small group of four SNPs, as well as two large groups both containing thousands of SNPs, these three groups do not share common SNPs and they belong to different regions of the chromosome. This happens because our method finds the smallest group of SNPs for which the null hypothesis can be rejected. Such a result means that one region of the chromosome exhibits a strong signal, while there are other regions exhibiting weaker signal. Thus, the size of the group reflects the strength of associations: the weaker these associations, the larger the significant groups. Tables 2 reports on individual SNPs or small clusters of SNPs selected by our method for the seven diseases we analyzed. We found a total of 20 such clusters, out of which 16 are individual SNPs. Twelve out of the 20 clusters contain at least one SNP that was found to be strongly associated to the phenotype in the original WTCCC study. The remaining eight clusters contain SNPs that are either in LD with the ones identified by the WTCCC, belong to the same gene or genomic region, or have been identified as having a significant effect in other studies. While it is informative to see if our findings have been previously reported in other studies, it is important to remember the distinction in terms of interpretation. Our method makes the significance of previous findings much stronger, because it does not simply compute the marginal correlation, but it instead tests whether the effect of a SNP or a group is still significant after we have taken into account the effect of all other SNPs. In the case of the small clusters, it restricts the confounders to a reduced number of SNPs that are either introns in the same gene, or in close proximity to each other. Besides these small significant groups, our method also identified larger groups. Again, it is important to keep in mind that these larger groups are not overlapping with the smaller ones, and they are in other regions of the chromosome. These clusters contain many of the SNPs that were identified to have moderate associations in the original study. Because of their size, they are given lower weight in terms of power, however, they reflect the assumption that these diseases are highly polygenic, and associations appear in many places throughout the genome. In the following we will describe in more detail our findings for each disease.
WTCCC data
Coronary artery diseaseWe replicated rs1333049, an intergenic SNP on chromosome 9, the only finding from the WTCCC study. Our result however has a much stronger interpretation compared to the original finding, because we control for all possible confounders. Thus, rs1333049 shows an association with the phenotype, even after taking into account the effects of all other SNPs.
Crohn's diseaseOn chromosome 1 we identified a small significant cluster of five SNPs: rs11805303, rs2201841, rs11209033, rs12141431 and rs12119179. Two of them: rs11805303 and rs2201841 are introns in the IL23R gene, while the last three SNPs are up to 22-kb downstream from IL23R. Though rs11805303 showed strong association in the WTCCC study (The Wellcome Trust Case), our result has a different and much stronger interpretation. Our finding is a group of five SNPs that are jointly significant, though none of them is significant individually. Becausethis significance results from a joint model of all SNPs, it means that our group is jointly significant while controlling for all other SNPs in the study. The interpretation of this finding is that we limit the set of confounding SNPs to four other SNPs. When a SNP is declared significant by computing the marginal correlation, like in The Wellcome Trust Case Control Consortium (2007), the set of possible confounders that produce this correlation is the set of all other SNPs. Thus, if the correlation turns out to be a spurious one, there could be hundreds of other SNPs that produce it. In contrast, our method not only drastically reduces the number of confounders, but gives a small set of much more plausible ones, that are in a narrow region of the chromosome, often clustered around a gene. On chromosome 2 we identified an individual SNP, rs10210302, which showed strong association in the WTCCC paper (The Wellcome Trust Case Control). This SNP has by far the lowest P-value (4:6  10 5 ) in CD, and it also explains a relatively large proportion of the variance attributed to chromosome 2: 0.014 compared to 0.05 explained by all the selected SNPs in the chromosome. On chromosome 5 we identified a group of 9 SNPs: rs6871834, rs4957295, rs11957215, rs10213846, rs4957297, rs4957300, rs9292777, rs10512734 and rs16869934. They are all intergenic, 85 kb apart and located in the 40.4M region of the chromosome. rs16869934 is 4 kb downstream from the SNP rs17234657 showing strong association to CD in The Wellcome Trust Case Control Consortium (2007). On chromosome 10 we found 2 significant SNPs. The first is rs10883371, a 2-kb upstream variant both for LINC01475 and NKX2-3. rs10883365, found to be strongly associated to CD in the WTCCC study is a 2-kb upstream variant in LINC01475. Our second finding on chromosome 10 is rs10761659, a non-coding intergenic SNP mapping 14-kb telomeric to gene ZNF365 and was identified first by the WTCCC (The Wellcome Trust Case Control), followed by a meta-analysis () and later a study of a southern european population by. On chromosome 16, we found an individual SNP, rs2076756, which is an intron in NOD2. Interestingly, this SNP was not found to be significant in the original WTCCC study, while our approach shows that it is even significant when we control for all other SNPs. This SNP has been confirmed by several studies (). Finally, on chromosome 18, we identified a single intergenic SNP: rs2542151. This finding was reported by The Wellcome Trust Case Control Consortium (2007), as well as by).
Rheumatoid arthritisWe identified two SNPs, both individually significant. The first, rs6679677 is located on chromosome 1 and is a 2-kb upstream variant in the PHTF1 gene. This finding was reported by The Wellcome Trust Case Control Consortium (2007). The second SNP, rs9272346, is located on chromosome 6 and is also a 2-kb upstream variant in the HLA-DQA1 gene. This SNP belongs to the MHC region, just like the WTCCC finding. as the variance is homogeneously distributed across the chromosomes. The plot shows an excellent fit (R 2 % 0:91), meaning that the length of a chromosome is a very good predictor for the amount of variance that a particular chromosome explains.
HypertensionHypertension was the only disease where The Wellcome Trust Case Control Consortium (2007) did not find any strongly associated SNPs. We also haven't found small clusters or individual SNPs, but we did find larger clusters on 13 of the chromosomes. The results are shown in the Supplementary Material Section S4.7.It is difficult to directly compare our results to other marginal methods because we assign significance with respect to a generalized multiple regression parameter, and not only for individual but also for groups of SNPs. Nevertheless, we performed a small simulation study in which we compared the results for our method to the standard marginal approach, as well as two mixed model algorithms. The findings were in line with our expectations: while our method had slightly reduced power in two of the settings, it compensated by producing a significantly reduced number of false positive selections. In the third design our method had the same power as the mixed model and marginal testing approaches, while still having a superior control of the false positives. One direction for improving the method would be to change the clustering, which could be performed through the use of more indepth biological knowledge. For instance, if we would cluster the SNPs into genes, and then into pathways, even for a weak signal we would potentially identify larger pathways, which would be useful in terms of biological meaning.
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
. Test the global hypothesis H 0;G global where G global  f1;. .. ; pg: that is, we test whether all SNPs have corresponding (generalized) regression coefficients equal to zero or alternatively, whether there is at least one SNP which has a non-zero regression coefficient. If we can reject this global hypothesis, we go to the next step. 2. Test the hypotheses H 0;G1 ;. .. ; H 0;G22 where G k contains all the SNPs on chromosome k. For those chromosomes k where H 0;G k can be rejected, we go to the next step. 3. Test hierarchically the groups G which correspond to chromosomes k where H 0;G k was previously rejected. Consider first the largest groups and then proceed hierarchically (down the cluster tree) to smaller groups until a hypothesis H 0;G cannot be rejected anymore or the level of single SNPs is reached. 4. The output is a collection of groups G final;1 ;. .. ; G final;m where H 0;G final;k is rejected (k  1;. .. ; m) and all subgroups of G final;k (k  1;. .. ; m) downwards in the cluster tree are not significant anymore. In such a hierarchical testing procedure, which belongs to the scheme of sequential multiple hypothesis testing, the multiple testing adjustment is resolution dependent. To guarantee that the familywise error, i.e. the probability for at least one false rejection of the hypotheses among the multiple tests, is smaller than or equal to a for some pre-specified 0 < a < 1, e.g. a  0:05, the hypothesis tests must be performed at different significance levels, depending on where one is in the hierarchy. The more we descend in the hierarchy, the more the multiple testing adjustment increases because we do more tests. It is important to keep in mind that even though the procedure controls the type I error simultaneously over all levels of the hierarchy, the adjustment for larger clusters does not depend on whether one will test their subclusters or not. While there is an ordering of the clusters, due to the nature of the hierarchical clustering procedure, and testing of subclusters stops once the null hypothesis of the parent cluster is accepted, the adjustment applied to the P-value of any cluster does not depend on the number of tests that have already been performed, but only (essentially) on the size of that particular cluster, see Section 2.4.2. The details have been developed by Meinshausen (2008). In other words: the final output of the method are P-values for significant groups G final;1 ;. .. ; G final;m with the interpretation, that these P-values control the familywise error rate for multiple testing (if we collect all groups with a P-value smaller or equal to a, then the probability for making one or more false rejections among all considered tests is less or equal to a). Furthermore, due to the hierarchical structure of the procedure, we can massively reduce the number of computations: if the final clusters or groups G final;k are relatively high up in the hierarchy of the cluster tree, we only need to compute relatively few hypothesis tests. 2.4.2 Construction of the P-values The hierarchical inference procedure above assumes that one has a method that constructs P-values which are valid (a P-value P is valid for a null-hypothesis H 0 if P H0 P a a for any Genome Chrom 1 Chrom 2 Chrom 21 Chrom 22 Fig. 2. The final cluster tree. The SNPs are first partitioned into chromosomes, and then a cluster tree is built for each chromosome separately using hierarchical clustering with average linkage. The hierarchical clusters of SNPs within chromosomes are not shown due to their size
L.Buzdugan et al. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
.2.4 Type 1 diabetes Eight individual SNPs were declared significant by our method. Five of these are the five associations found in The Wellcome Trust Case Control Consortium (2007). These are: rs6679677, a 2-kb upstream variant in the PHTF1 gene on chromosome 1, rs9272346, a 2-kb upstream variant in the HLA-DQA1 gene on chromosome 6, rs11171739, an intergenic SNP on chromosome 12, rs17696736, an intron in the NAA25 gene on chromosome 12 and rs12924729, an intron in the CLEC16A gene on chromosome 16. Additionally, our method identified 3 new associations. Two of them are located on chromosome 6: rs9272723 is an intron in the HLA-DQA1 gene and rs2523691 is intergenic. The third new finding, rs17388568, is located on chromosome 4 and is an intron in the ADAD1 gene. It did not reach the genome wide significance threshold in the WTCCC study, however it showed moderate association with a P-value of 3  10 6. It also showed moderate association in an independent study by Plagnol et al. (2011). 3.2.5 Type 2 diabetes We identified two small SNP clusters, one on chromosome 10 and the other on chromosome 16. The first cluster contains 10 SNPs: rs4074720, rs10787472, rs7077039, rs11196208, rs11196205, rs10885409, rs12243326, rs4132670, rs7901695, rs4506565, all introns in the TCF7L2 gene, spanning a 62 kb region. One of them, rs4506565, was originally identified by The Wellcome Trust Case Control Consortium (2007), while rs7901695 showed a significant association in a replication study by Zeggini et al. (2007). The second cluster is comprised of four SNPs: rs9926289, rs7193144, rs8050136, rs9939609, all introns in the FTO gene spanning 10 kb. rs9939609 was significantly associated to the phenotype in The Wellcome Trust Case Control Consortium (2007). Additionally, rs8050136 was found to have strong significance in Zeggini et al. (2007) and Scott et al. (2007). 3.2.6 Bipolar disorder For BD, the WTCCC identified only one SNP strongly associated to the phenotype: rs420259. While we did not identify it in a small group, it is present in the large group found to be significant on chromosome 16. Furthermore, as can be seen in Table 3, we found clusters in many of the chromosomes. Table 3 shows the group size, both in terms of number of SNPs, as well as in terms of percentage of the total SNPs in that particular chromosome. Additionally, we investigate whether the SNPs identified using the standard analysis with PLINK (Purcell et al., 2007) map into our groups. The size of the group is in a way inversely proportional to the strength of associations. If a certain chromosome contains SNPs with large effects, we will be able to find them in very small clusters, or maybe even individually. If however the signal is weak, we can only identify larger regions. For example, on chromosomes 4, 6, 7, 8, 10 and 15 the signal is so weak that we can only report that the joint effect of all SNPs in these chromosomes is significant, but we cannot further localize the signal. On the other hand, on chromosome 3 we were able to identify a much smaller group containing only 6% of the SNPs. Our method returns the smallest number of SNPs for which we can find a significant effect, while controlling for all other SNPs. The fact that we cannot disaggregate the signal to small clusters, or single SNPs does not mean that genetics plays no role in BD, but rather that the signal is very dispersed and the effect sizes are very small. This explains why our groups are so large, and why we cannot attribute the signal to narrower regions. Figure 3 shows the variance in bipolar disorder explained by the SNPs on individual chromosomes. We only consider the SNPs selected by the Lasso, in step 2 of Section 2.4.2, as these SNPs are a proxy for the truly relevant SNPs. The total variance explained by all the SNPs is 0.5, and Figure 3 describes how this variation is distributed across the chromosomes. The fitted line corresponds to a linear model, where the predictor is the chromosome length, and the response is the explained variance. The plot gives weight to our previous statement, Multivariable genome wide association analysis
Discussion We have presented a new method for assigning statistical significance in GWAS. Our approach goes beyond the bivariate testing of individual SNPs that looks only at marginal associations. Instead, we use a multivariable approach which includes all the SNPs and controls the familywise error rate. We propose to assign P-values in a hierarchical manner: first for chromosomes, and then in a topdown fashion from larger to smaller groups of SNPs. Such an approach addresses several issues. First, since regression parameters of individual SNPs are typically very small, due to their interpretation and meaning in the model, it is much more likely to detect significant groups of SNPs. Second, because we proceed hierarchically, the problem of multiple testing is much less severe than for the classical one-SNP-at-a-time approach: roughly speaking, one has to adjust only for the number of tests which are considered, and this number is typically much smaller than the entire number of SNPs in the study. Our method is data-driven in the sense that its resolution for the groups of SNPs depends on the strength of the signal present in the data: how much we proceed in the hierarchy and refine the clusters of SNPs depends on how strong the associations are. If the signal is strong and well-localized, we find small clusters or individual SNPs, whereas if the signal is weak, we identify larger regions. We demonstrate our method on the WTCCC data (The Wellcome Trust Case Control Consortium, 2007), where we analyze the seven diseases. Though it is interesting to conceptually validate our findings by comparing them with a measure of marginal association, our method is different and allows for a more powerful interpretation of the findings than testing only marginal association between a SNP and the phenotype. This is because we test whether or not SNPs in a cluster carry any additional information about the phenotype, beyond that available through all the other SNPs. That is, we adjust for the effect of all other SNPs that are not part of this cluster, which translates to a very strong interpretation of the significant clusters. This can be related to causal statements when making additional assumptions (see last paragraph in Section 2.1). Due to the fact that we control for all other SNPs, often we can reduce the number of possible confounders from hundreds or thousands of SNPs to less than 10. Moreover, our possible confounders are desirable candidates, as they are usually part of the same functional unit. This is a favorable outcome because in most cases it is unclear which is the causal SNP, and in many contexts the gene might be the more meaningful biological unit. Even for phenotypes with weaker and more dispersed signal, such as BD and HT, we could still identify larger regions. While these clusters might be too large to identify specific genes, we can still gain insights into the joint influence of all selected SNPs, or the distribution of the variance across the chromosomes. This case is the one which motivated our approach. For distant, non-disease related phenotypes it is perhaps more useful to identify the chromosomes, or the regions that drive the signal, and their contribution to the total explained variance. In such cases identifying single SNPs is most likely impossible, and due to their low predictive power, not very useful.
