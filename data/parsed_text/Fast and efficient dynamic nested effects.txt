Motivation: Targeted interventions in combination with the measurement of secondary effects can be used to computationally reverse engineer features of upstream non-transcriptional signaling cascades. Nested effect models (NEMs) have been introduced as a statistical approach to estimate the upstream signal flow from downstream nested subset structure of perturbation effects. The method was substantially extended later on by several authors and successfully applied to various datasets. The connection of NEMs to Bayesian Networks and factor graph models has been highlighted. Results: Here, we introduce a computationally attractive extension of NEMs that enables the analysis of perturbation time series data, hence allowing to discriminate between direct and indirect signaling and to resolve feedback loops.
INTRODUCTIONReverse engineering of biological networks is a key for the understanding of biological systems. The exact knowledge of interdependencies between proteins in the living cell is crucial for the identification of drug targets for various diseases. However, due to the complexity of the system a complete picture with detailed knowledge of the behavior of individual proteins is still out of reach. Nonetheless, the advent of gene perturbation techniques like RNA interference (RNAi) (), opened new perspectives for network reconstruction by boosting the ability to subject organisms to well-defined interventions. In general, biological networks are represented mathematically by a graph in which the nodes represent biological entities and the edges encode functional relations (of various kinds) between these entities. A number of approaches have been proposed in the literature for estimating networks from perturbation effects. Many of these aim at reconstructing a network from directly observable effects. For example,build a directed disruption graph by drawing an edge (i,j), if gene i results in a significant expression * To whom correspondence should be addressed. change at gene j.uses such disruption networks as a starting point for a further graph-theoretic method, which removes indirect effects (), hence making the network more parsimonious.enhance this approach by additionally making use of edge probabilities and signs to make the network consistent with the observed biological effects. Moreover, Bayesian Networks have been used to model the statistical dependency between perturbation experiments (). For this purpose Pearl (2000) introduces his do calculus, an idealized model of interventions. Other probabilistic graphical models that have been proposed to model interventional data comprise factor graphs () and dependency networks (). In genetics, epistasis analysis is often been applied for learning from indirect downstream effects. For example,use expression profiles from single and double knockdowns to partly reconstruct a developmental pathway in Dictyostelium discoideum via a simple cluster analysis.embedds epistasis analysis into a statistical framework.propose a special kind of Bayesian Network to infer pathway structures from genetic interaction data. All of these approaches deal with static data. However, with the increasing availability of time-resolved data, it is desirable and helpful to model the temporal aspects of signaling. To this end, differential equation systems have been suggested e.g. by. Our approach is an expansion of Nested effects models (NEMs) (). NEMs are specifically designed to learn the signaling flowon a transcriptional as well as non-transcriptional levelbetween perturbed genes from indirect, high-dimensional effects, typically monitored by DNA microarrays. NEMs use a graphical modeling framework to compare a given network hypothesis with the observed nested structure of downstream effects. In conclusion, NEMs estimate an interaction network between hidden entities from a set of observable downstream effects. NEMs have been applied successfully to a number of datasets, e.g. the immune response in Drosophila melanogaster (), a transcription factor network in Saccharomices cerevisiae (), the ER- pathway in human breast cancer cells (), a synthetic lethality interactions network in S.cerevisiae (), murine stem cell development in mice () and the Rosetta dataset for S.cerevisiae ().Page: 239 238244
Dynamic nested effects modelsThis article complements the attempt ofto extend static NEMs to the modeling of perturbation time series measurements. Most importantly, this allows for the resolution of feedback loops in the signaling cascade, as well as for the discrimination of direct and indirect signalling. In contrast to Anchang et al. the key idea in our model is to unroll the signal flow over time. This allows for a computation showing some similarity to Dynamic Bayesian Networks and naturally extends the classical NEM formulation introduced byOur model circumvents the need for time consuming Gibbs sampling, which makes it also computationally attractive.
METHODS
NEMsFor self-containedness, we start with a brief review of the original statistical inference framework by. In this framework, one distinguishes between silenced/perturbed entities (genes or proteins, which cannot be observed directly), called S-genes (S) and other entities (genes or proteins) showing a measurable downstream effect (E-genes, E). The idea of NEMs is to separate the upstream signaling pathway (the graph connecting the S-genes) from the downstream signaling (the graph connecting S-genes to E-genes). Consequently, the edge set of a NEM is partitioned into a directed edge set connecting S-genes among themselves, and another one describing the connections between the S-genes and the E-genes. It is assumed that each E-gene is attached to at most one S-gene only. Knocking down a specific S-gene S k interrupts the signal flow in the downstream pathway, and hence an effect on the E-genes attached to S k or one of the S-genes depending on S k is expected. Perturbing each S-gene once will thus result in a nested subset structure of effects, which can be used to reverse engineer the upstream signal flow graph (). The linking of E-genes to S-genes is formally represented by a binary |S||E| matrix = ( ij ) with ij = 1, if effect j is linked to S-gene i and ij = 0 otherwise. The cross-talk between S-genes (our network hypothesis) is given by a binary |S||S| matrix = ( ij ), with ij = 1 whenever S-gene i is upstream of S-gene j, and the convention ii = 1 for all i  S. A (static) NEM assumes that perturbing S-gene s  S leads to an observable downstream effect for E-gene e  E, if there is a path from s to e, i.e. there exists an s  S, such that ss = 1 and s e = 1. Hence, matrices and together determine whether a perturbation of s  S has an effect on a E-gene e  E. Similarly, if several S-genes S  S have been perturbed simultaneously, an E-gene is affected if there is a path from at least one of the S-genes in S to the respective E-gene. Suppose we have conducted a set K of perturbation experiments. For each experiment k  K, let S k  S denote the set of S-genes that has been actively perturbed. Note that at this point we generalize the original formulation of NEMs () in a way that allows for the integration of combinatorial perturbations. Let D = (D kj ) be a |K||E| matrix of experimentally observed effects. The entry of D kj is a collection of all observations of E-gene j under the perturbation(s) of S k. It may consist of counts of how often a specific gene showed a knockdown effect among experiment repetitions, as originally proposed by) and Tresch and Markowetz (2008) suggested using log P-value densities and log odds ratios, respectively, which are closely related to each other (). In general, a NEM model can be scored according to a likelihood function of the form:The local likelihoods p(D ik | ,) are the building blocks of the NEM. A meaningful way to define these local likelihoods and calculate them efficiently is described in the Supplementary Material.(b)(b) Relation of perturbations and observable effects. A perturbation of S-gene S 2 affects the downstream signaling pathway (S 3 ), and hence an effect on the E-genes attached to S 2 and to S 3 , namely E 2 respectively E 3 , is predicted (grey shading).
Dynamic NEMs (dynoNEMs)The above model monitors static perturbation effects. Specifically, a perturbation signal is supposed to propagate deterministically through the whole S-gene network. Cycles in imply that perturbation effects are indistinguishable within this model. As a matter of principle, it is impossible to detect feedback loops in. Thus, it is highly desirable to have time series measurements of perturbation effects, which help resolve biological feedback loops and distinguish direct from indirect effects. From now on we suppose our data D to consist of a time series, i.e. D = {D ij (t) | t = 1,...,T }. These measurements could be P-values, counts or any other kind of statistics quantifying the effect of a knockdown for E-gene i under perturbation of S-gene j at time t (see Supplementary Material). The time variable t here denotes the index of a time point in a discrete time series, but not the time point itself. As an example, suppose the biological 'truth' is given by the signaling pathway shown in. We unroll the signal flow in this network over time () in the following way: the node set={S(t), S  S} of the dynamic network consists of a copy of the static network nodes, one for each timepoint t = 1,...,T. An E-gene E(t) is linked to S(t) whenever E is linked to S in the static situation, i.e. it is determined by the same matrix as in the static case. The actual unrolling takes place in the wiring of the S-genes. Informally, the static adjacency matrix is converted to a |S||S| weighted adjacency matrix = ( ij ), where 0 means no edge and a value ij > 0 implies an influence of node i on E-genes downstream of node j delayed by ij time steps. Specifically, we have T  ij  ij for i,j  S. A non-zero entry ij = 0 implies that there,...,T  ij. Furthermore, we make the convention ii = 1. Please note again that we neither aim to model physical signaling nor downstream transcription times. Instead, a positive time lag between nodes i and j in our model describes the number of time steps, after which a knockdown of node i results in an observed effect downstream of node j. This specifically implies that we do not need any assumptions about the physical time it takes a signal at node j to produce a downstream effect at an E-gene. In contrast to classical Dynamic Bayesian Networks (), an edge in our model may not connect consecutive time layers, but it may Page: 240 238244
H.Frhlich et al.(b)skip a certain amount of time steps (as it is the case for the entry S 2 S 3 = 2 in, which implies the edge S 2 (1)  S 3 (3). In other words, we do not rely on a first order Markov assumption in our model. In this way, we model the unknown and variable time delays in perturbation responses due to the upstream signaling. In the following, we refer to this model as dynoNEM. The likelihood formula for dynoNEMs is given as (c.f. Supplementary Material):To compute p(D ik (t) | ,, is = 1) according to the proposed unrolling of the signal flow, we introduce a time-dependent Boolean perturbation state for each S-gene s, which we encode with 0 (perturbed, S-gene is underexpressed or overexpressed) and 1 (unperturbed, S-gene is naturally expressed), respectively. A knockdown of s corresponds to a switch 1  0. Since the perturbation state of s at a particular time step t is not observable, we identify it with the value [s(t)] of a random variable s(t). Let pa(s)(t) denote the set of parents nodes of s at time t (i.e. the set {p | 0 << ps < t} which can be empty, if appropriate). Then, according to the unrolling of the signal flow over time, we write:In the absence of more precise information, we define:The definition means that s is perturbed at time t, if any of its parents (including s itself) are perturbed. We are now left with the definition of the local likelihoods p(D ik,, is = 1), which can be calculated efficiently in a similiar fashion as for static NEMs. Details are described in the Supplementary Material.
A prior for network structures and time delaysIn the above paragraph, we introduced the weighted adjacency matrix as a compact representation of the raw upstream network structure and time delays between perturbation events and downstream responses. Learning an upstream signaling cascade now amounts to learning matrix based on the likelihood in Equation (2). While scoring candidate network structures we assume higher edge weights (i.e. observing an effect after longer time lag) to be less likely than small edge weights. Morever, we have to ensure that redundant edges, i.e. edges which are principally not observable do not appear. In other words, addition of these edges to does not change the likelihood of our model. In general, edges x  y are redundant, if their time lag is larger or equal than the length of some other path from x to y, where the path length is defined here as the sum of the path's time lags. We specify our demands in form of a prior p(). Additionally to punishing higher edge weights, p() should enable us to include prior knowledge into the network scoring, i.e. to bias the scoring toward known interactions. For this purpose, we assume to have a given matrixfmatrixmatrixf prior probabilities for each edge.proposed the following prior for :where >0 is an adjustable scaling parameter. The parameter  can be chosen according to the BIC criterion:is an estimate of the number of parameters in the model. In the default case (which is employed in our subsequent studies), we suppos to be an empty graph. This way sparse network structures are favored.
Network learning for dynoNEMsNetwork learning in our case amounts to find an optimal weighted adjacency matrix , where the entries ij can take on discrete values 0,...,T. We employ a greedy hill climbing strategy here. For this purpose, we define three search operators: edge weight increase ( ij  ij +1, if ij < T ), edge weight decrease ( ij  ij 1, if ij > 0), edge reversal (exchange of ij and ji ). At each search step, we are applying all possible operators and accept the solution increasing the posterior likelihood most. This requires O(|S| 2 ) likelihood evaluations per search step, where each likelihood computation according to Equation (2) has a time complexity of O(T |E||S| 2 ) by itself. Hence, each search step requires O(T |E||S| 4 ) time. To further assess the confidence of the inferred network hypothesis on real experimental data, we employ non-parametric bootstrapping (1000 times). That means, from the whole set E of available downstream effects we randomly draw bootstrap samples E  E of size |E| with replacement. On each bootstrap sample, we estimate a network hypothesis using greedy hill climbing. This allows us to estimate confidence intervals for each ij .
Related approaches
DNEMsA first approach for learning from perturbation time series was proposed recently by. Our method differs from theirs according to the following aspects:(1) We do not aim to infer the true upstream signaling time from downstream effects. Instead we only estimate the time lag between a perturbation and an observed downstream effect. This allows us to unroll the signal flow in the upstream signaling cascade over time.(
Dynamic nested effects models
Static NEMs for time seriesSupposed that measurements of all time points were statistically independent one can in principle directly apply static NEMs to time series data. In case of statistical independency of time points, we havethen we retrieve back the classical likelihood formula for NEMs (see Supplementary Material). The difference of dynoNEMs to this idea is the propagation of perturbation effects over time using the time lags (Equation 3). A principle problem when applying the static NEM approach in the context of time series data is that structures with the same transitive closure are likelihood equivalent, i.e. cannot be distinguished. For that reason, we use the maximum a-posteori (MAP) approach introduced in Tresch and Markowetz here instead (). In this approach, the assignment of E-genes to S-genes encoded in the parameter is not integrated out, but estimated explicitely. This in principle allows to distinguish direct from indirect perturbation effects, and thus breaks the likelihood equivalence. A comparision between the MAP approach and the classical NEM approach can be found in. We use greedy hill climbing to learn the network structure for time series data via a static NEM. Search operations are edge insertion, edge deletion and edge reversal, and the greedy hill climber is initialized with an empty network. The same prior for network structures as described above is employed to enforce sparsity of the solution. In the following, we will use the static NEM approach as a 'ground truth' for method comparison.
RESULTS
Simulations
Network samplingTo assess the reconstruction performance of our approach, we ran simulations on 10 networks with n S-genes (n was varied during our simulations, see below), which were generated in a random fashion from KEGG signaling pathways as follows: a random KEGG signaling pathway was picked as base graph. Only genegene interactions were considered within that graph. Within the chosen pathway, a core node was selected randomly. Starting from that core node a random walk (visiting nodes with equal probability) was started and continued until the total number of visited nodes was n. The subgraph of visited nodes was regarded as an S-gene network, and a set of m E-genes (m is varied during our simulations) was attached uniform randomly to all these S-genes. Finally, time lags for edges between connected S-genes were sampled from the set {1,2,3,4} via a geometric distribution with parameter p. Doing so, we ensured that an indirect edge x  y had always a time lag being smaller than than the sum of time lags on all other paths from x to y, i.e. we did not get redundant edges. We further ensured that at least one of the sampled networks was cyclic. All sampled networks can be found in the Supplementary Material.
Data samplingTo generate data for the sampled 10 networks, we simulated knockdowns of each of the network Sgenes according to Equation (4). That means, if S-gene k was 'knocked out', then a downstream S-gene s was supposed to be perturbed as soon as the perturbation signal reached s (here the time lags came into play). If s was perturbed at time t, then we sampled 'P-values' for all E-genes attached to s from the f 1 distribution (see Supplementary Material), otherwise from a uniform distribution (i.e. we supposed to have only one control available, see Supplementary Material). The parameters for the f 1 distribution were itself drawn randomly in the same manner as described in. Afterwards the local effect likelihoodswere estimated using again the f 1 distribution, but this time with slightly different parameters in order to simulate the estimation error of distribution parameters occuring in practice (see Supplementary Material for details). The whole data generation process was repeated 100 times for each network and each parameter configuration being investigated in the following.
Dependency on time lag distributionIn a first simulation, we investigated the dependency of our dynoNEM and static NEM models on the time lag distribution for networks with n = 5 S-genes, m = 100 E-genes and time series of length T = 10, i.e. we varied the parameter p of the geometric distribution. The dependency was measured in terms of sensitivity and specificity (1  false positive rate) of network reconstruction. Moreover, for dynoNEMs we recored the mean squared error (MSE) of estimated time lags. It is worth mentioning that the hill climber for the dynoNEM model was always initialized with the network estimated by a static NEM. We also tested an initialization with an empty graph, but did not find much difference to the results presented here. A direct comparison to the DEM approach by Anchang et al. was impossible due to the prohibitively high computation time for their method. Since in this simulation T was (intentially) much larger than the maximum time lag of 4, the result showing an almost constant behavior of sensitivity, specificity and MSE over the whole parameter range was somehwat expected (Figures in Supplementary Material). It demonstrated that provided we have long enough time series the reconstruction quality is independent of the shape of the time lag distribution. Besides that, it is worth mentioning that our dynoNEMs achieved a sensitivity of >90% with a specifictiy of almost 100%, whereas static NEMs had much lower average sensitivity of ~80% and specificity of ~90%.
Dependency on length of time seriesIn a next simulation, we looked at the influence of the lenght T of the time series for networks with n = 5 S-genes, m = 100 E-genes and P fixed to 0.5 (Figures 3 and 4, rest in Supplementary Material). As expected, an increase of the number of time points lead to a strong improved sensitivity for both, dynoNEMs and static NEMs. The average difference in sensitivity between both methods remained between 15 and 20%. Like before, dynoNEMs achieved a very high specificity of almost 100%, even with a low number of time points, whereas static NEMs showed a slight decrease of specificity with an increasing number of time points. The MSE of estimated time lags dropped to almost 0 with increasing T .
Dependency on number of S-and E-genesIn a third simulation, we investigated the performance for a varying number of E-genes with n = 5,10 and 15 S-genes and time series of length T = 10. Time lags were sampled from a geometric distribution with P = 0.5 (Figures 5 and 6. The dependence on the choice of p, i.e. the influence of the signaling times prior has been evaluated in Section 3 of the Supplementary Material). In all cases, the dynoNEM Page: 242 238244model led to a consistently better sensitivity and specificity than the static NEM model, with improvements in sensitivity and specifictiy of ~1520%. At the same time, the simulation demonstrated that already with a rather low number of E-genes, dynoNEMs reach a rather good reconstruction accuracy. For instance, for n = 5 it seems that just 25 E-genes are sufficient to get a sensitivity of >90%. Like before, the specificity was constantly >95%. With increasing network size, i.e. larger n, the sensitivity drops slightly to 80% (n = 10, 100 E-genes) and 70% (n = 15, 300 E-genes), respectively, but the specificity remains constantly >95% (Figures in Supplementary Material).
H.Frhlich et al.
Dependency on network architectureWe finally investigated, whether there were systematic differences in the reconstruction accuracy for each of our sampled networks. We compared the sensitivities and specificities for each network with n = 5 S-genes, m = 100 E-genes, time lags sampled with P = 0.5 and varying parameter T (see Supplementary Material). This simulation showed for longer time series an influence of the network architecture, whereas for smaller ones the length of the time series was the dominating factor. Specifically, the cyclicnetwork #10 appeared to be harder to learn in terms of sensitivity and specificity than the other ones, and also the indirect edge in network #2 caused sometimes difficulties. Nonetheless, a detailed investigation of the frequency with which individual edges were inferred clearly revealed that dynoNEMs were in general able to identify feed-forward and feed-back loops correctly with high accuracy, even from short time series (see Supplementary Material).
Application to murine stem cell developmentWe applied dynoNEMs to a dataset investigating molecular mechanisms of self-renewal in murine embryonic stem cells (). The dataset consists of time series microarray measurements for RNAi knockdowns of each of the six genes namely, Nanog, Oct4, Sox2, Esrrb, Tbx3 and Tcl1. Mouse embryonic stem cells (ESCs) were grown in the presence of leukemia inhibitory factor (LIF), thus retaining their undifferentiated self-renewing state (positive controls). Differentiation-associated changes in gene expression were measured by replacing LIF with retinoic acid (RA), thus inducing differentiation of stem cells (negative controls). RNAi silencing of the six afore mentioned genes was done in (LIF+, RA) cell culturs to investigate their potential for induced cell Page: 243 238244was measured once on Affymetrix MOE430A and once on MOE430B chips. The authors normalized both datasets via the MAS 5.0 software (). In consistency withfor the following analysis, we only concentrated on the Affymetrix MOE430A chip series. In our framework, the six genes Nanog, Oct4, Sox2, Esrrb, Tbx3 and Tcl1 correspond to S-genes, and all genes showing a significant fold change in response to LIF depletion are E-genes. We here used the same set of 122 E-genes and the same data discretization procedure as described in. We applied our dynoNEM model within a non-parametric bootstrap procedure and recorded, how often each edge appeared in 1000 inferred networks (one network per bootstrap sample). We then computed exact binomial distribution confidence intervals (95%) for the appearence probability of each edge via R-package binom (). The validity of bootstrap probabilities for edges was further checked in a simulation (see Supplementary Material). Only edges with lower confidence bound >50% were regarded as reliable and shown in. The median time lags for all edges were 1, i.e. had the same speed. There are several similarities to the inferred network shown in, which was obtained via the DNEM method, namely the cascades Tbx3  Esrrb  Oct4  Tcl1, Nanog  Oct4  Tcl1 and Sox2  Oct4  Tcl1. A further striking similarity is that the transcription factor Oct4 regulating Tcl1 is itself jointly regulated by the three transcription factors Nanong,Sox2 and Esrrb. In contrast to Anchang et al., in our network Nanog is not placed upstream of Sox2 and does not have any indirect outgoing edges. Indeed, the only shortcut in our network is Sox2  Tcl1. Our network is thus more sparse than the one shown byThis can be partially attributed to our structure prior (Section 2.3), which favors sparse networks. A comparison of the pure graph structures (neglecting edge probabilities) of both, our network and the network by Anchang et al., via our likelihood model favored our network with a Bayes factor of 2.14  10 18. Thus, we believe that the reason for the (relatively small) differences between our network and Anchang et al. are a mixture of a different likelihood model combined with a sparsity prior. A further comparison of our dynoNEM network with a reconstruction based on static NEMs can be found in the Supplementary Material. For validation purposes, we next performed a literature-based reconstruction of the six gene network via the MetaCore TM software (GeneGo Inc.) showing eight known transcriptional and three known non-transcriptional regulations (see Supplementary Material). The sub-networks Sox2  Oct4  Tcl1 and Esrrb  Oct4  Tcl1 appearing in our data-based reconstruction can be found in this literature network as well as Nanog and Tbx3 being placed upstream of Oct4. The edges Sox2  Tcl1 and Nanog  Oct4, which both appear in our network and the one shown incan be explained by the fact that Sox2 binds to Oct4, which itself binds to Essrb, to which also Nanog binds (). Hence, Sox2  Tcl1 and Nanog  Oct4 are most likely mediated through Oct4 and Essrb, respectively. Likewise, Tbx3  Esrrb can be interpreted as being mediated through Oct4. A different way of interpretation was given by Anchang et al., who noted that feed-forward loops, such as Sox2  Tcl1, Nanog  Oct4 and Tbx  Esrrb, are very frequent motifs in transcriptional networks and could serve to stabilize the differentiated state of cells relative to the self-renewal state, hence making cell differentiation a mainly unidirectional process (c.f.). Summing up, we mainly see known transcriptional regulations, and our network is consistent with the known literature.
Dynamic nested effects models
CONCLUSIONWe developed a novel approach to infer signaling cascades from high-dimensional perturbation time series measurements via dynoNEMs, hence allowing to discriminate direct from indirect perturbation effects and to resolve feedback loops. Our approach directly extends the NEMs framework introduced bythe static to the dynamic case by unrolling the network structure over time. This idea allows for a fast and efficient computation of the likelihood function without any time consuming Gibbs sampling. Our simulations revealed a high accuracy of network reconstruction for sufficiently small networks (up to 15 nodes). Thanks to the incorporated network structure prior, we achieved a consistantly high specificity, i.e. low false positive rate. Applying our dynoNEMs to estimate the network between six proteins (five transcription factors) playing a key role in murine stem cell development, we found a good agreement with results published by Achang et al. and with the biological literature. We therefore believe that our approach can serve as a useful tool to generate datadriven hypotheses about signaling and/or transcriptional networks based on high-dimensional perturbation effects.
The Author 2010. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oup.com at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
