Warp2D is a novel time alignment approach, which uses the overlapping peak volume of the reference and sample peak lists to correct misleading peak shifts. Here, we present an easy-to-use web interface for high-throughput Warp2D batch processing time alignment service using the Dutch Life Science Grid, reducing processing time from days to hours. This service provides the warping function, the sample chromatogram peak list with adjusted retention times and normalized quality scores based on the sum of overlapping peak volume of all peaks. Heat maps before and after time alignment are created from the arithmetic mean of the sum of overlapping peak area rearranged with hierarchical clustering, allowing the quality control of the time alignment procedure. Taverna workflow and command line tool are provided for remote processing of local user data. Availability: online data processing service is available at
BACKGROUNDRetention time alignment to correct non-linear retention time shifts () between different chromatograms is a crucial step in the processing of label-free liquid chromatography * To whom correspondence should be addressed.  The authors wish it to be known that, in their opinion, the first two authors should be regarded as joint First Authors. coupled to mass spectrometry (LC-MS) data for proteomics and metabolomics comparative profiling studies. A complex 'omics' chromatogram contains signals from thousands of compounds, and small shifts may lead to improper matching of peaks that are derived from the same compounds leading to inaccurate statistical analysis and possibly to erroneous conclusions on the experimental outcome (). We have recently published a novel time alignment algorithm, Warp2D (), that is based on correlation optimized warping (COW) () to maximize the total peak volume overlap between the reference and sample chromatograms using LCMS peak lists as input data. The peaks in these LC-MS peak lists are considered as three-dimensional Gaussian peaks in the retention time, mass to charge ratio and intensity space. Peak widths in the retention time and mass to charge ratio are related to the mass and chromatographic resolutions, and analytical formula can be derived to calculate the individual peak volume and peak volume of the overlap of multiple peaks. Overlap of multiple peaks is used in the benefit function of the COW procedure in Warp2D () to drive the retention time correction. By considering the overlap of three dimensional Gaussian peaks, Warp2D takes account for the separation of peak in mass dimensions beside the separation of the peaks in the retention time dimension when correcting for nonlinear retention time shifts. The concept of Warp2D is fundamentally new compared with other time alignment methods either using onedimensional mass traces () in their benefit function, peak lists of multiple chromatograms with local regression techniques (), algorithms using a two-dimensional benefit function such as a Hidden Markov Model combined with a Continuous Profile Model () or the recently introduced COW-CODA (), PTW-CODA and DTW-CODA () algorithms combining COW, dynamic time warping (DTW) () and parametric time warping (PTW) () with a Component Detection Algorithm (CODA) (). We previously showed that Warp2D can successfully align peak lists of chromatograms obtained from complex serum and urine samples,Page: 1177 11761178even if compounds in these samples have large concentration variability with maximum 35 min of retention time shifts. Here, we report development of a high-throughput processing service to perform time alignment and quality assessment based on the Warp2D approach. This service is able to perform several hundreds of time alignments per hour for a large number of users by using the Dutch Life Science Grid (DLSG) through an easyto-use web interface available at the portal of the Netherlands Bioinformatics for Proteomics Platform.
Retention time alignment
A B
EASY-TO-USE WEB PAGE FEATURESWarp2D uses space-delimited ASCII peak lists with three columns containing the mass to charge ratio, retention time and peak quantity (height, area or volume). We have chosen this simple format because there is no accepted standard format to store LC-MS peak list. European Bioinformatics Institute is preparing the mzQuantML standard format for preprocessed LC-MS data such as peak lists and aligned peak matrix () and currently the APML format introduced in Corra () LC-MS data processing framework is the only available format to store this type of data. We have, therefore, developed a tool that converts LCMS peak lists in APML format to our format and placed the converter as java command line tool at http://www.nbpp.nl/warp2d.html. As soon as the new official mzQuantML format will be available, we will provide the possibility to use data in this format. The full parameter list, input/output file formats with detailed explanations, tutorial and example dataset used in this application note are available at the web page of the Warp2D processing service (http://www.nbpp.nl/warp2d.html). Warp2D generates three output files: the warped sample chromatogram peak lists with .wpks extension, the .tmap file containing the segment endpoint pairs in the time unit of the original peak list before and after time alignment and the quality file with .qual extension containing all parameters and quality scores reflecting the similarity of the reference and sample peak lists before and after time alignment. Since the .tmap file contains the retention time transformation of the sample chromatogram segment, one can use it to calculate any retention time shift by linear interpolation within the corresponding time segment. Details on the quality score and the most important parameters are provided in the Supplementary Material.
TAVERNA WORKFLOW AND COMMAND LINE OPTIONThe web user interface provides a convenient easy-to-use access to the high-throughput Warp2D LC-MS time alignment service. This application is build on a web service, and to facilitate the reuse of this web service programmatically by bioinformaticians, we developed a Taverna () workflow and command line java tool (supporting material and http://www.nbpp.nl/warp2d.html, the web page contains a detailed description of these tools). These tools enable simple remote processing of data located on a user's computer, automating the process of sending data to and from the grid computational resource. These tools allow the incorporation of the Warp2D LC-MS time alignment service into Taverna pipeline or in any other program or script while having the benefit of the vast processing power of the DLSG.presents two heat maps before and after time alignment showing the arithmetic mean of the sum of overlapping peak volume for 24 chromatograms obtained in an experimental design study to measure proteins quantity in serum from different mouse cancer models, treated with different depletion techniques, measured in different laboratories with different Quadrupole Time Of Flight mass spectrometers, from healthy mice or mice with cancer using a shotgun proteomics approach. The order of files was rearranged using hierarchical clustering of the arithmetic mean of the sum of overlapping peak area in order to identify chromatogram clusters with high similarity. The quality of the heat maps inindicates that chromatograms acquired within the same laboratory can be successfully aligned. The quality matrix that served for the heat maps can be used to select the best reference chromatograms for the final time alignment (e.g. the peak list having the highest quality score after time alignment) for the two peak list clusters. The user-friendly web interface destined for users with little bioinformatics experience allows the use of the Warp2D approach for alignment of large numbers of complex LC-MS chromatograms and provides an overview on the file clusters which can be successfully aligned within a given dataset. Execution time with regular settings of one alignment using peak lists of 5 MB containing 200 000 non deisotoped and non-decharged peaks takes 812 min on a regular PC (Intel Core Quad CPU Q9300 @ 2.5 GHz processor and 8 GB of RAM), while 576 time alignments of 24 peak lists took 4070 min using our web portal depending on the availability of the DLSG computational resources. The same number of alignments on a PC with single or four processing nodes would take 4 days or 1 day, respectively. The processing service includes free access to 10 GB of disk space to store the initial peak lists and processing results.
Page: 1178 11761178
I.Ahmad et al.
CASE STUDY AND CONCLUSIONS
The Author 2011. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oup.com at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
