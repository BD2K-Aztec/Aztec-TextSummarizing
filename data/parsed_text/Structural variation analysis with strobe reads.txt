Motivation: Structural variation including deletions, duplications and rearrangements of DNA sequence are an important contributor to genome variation in many organisms. In human, many structural variants are found in complex and highly repetitive regions of the genome making their identification difficult. A new sequencing technology called strobe sequencing generates strobe reads containing multiple subreads from a single contiguous fragment of DNA. Strobe reads thus generalize the concept of paired reads, or mate pairs, that have been routinely used for structural variant detection. Strobe sequencing holds promise for unraveling complex variants that have been difficult to characterize with current sequencing technologies. Results: We introduce an algorithm for identification of structural variants using strobe sequencing data. We consider strobe reads from a test genome that have multiple possible alignments to a reference genome due to sequencing errors and/or repetitive sequences in the reference. We formulate the combinatorial optimization problem of finding the minimum number of structural variants in the test genome that are consistent with these alignments. We solve this problem using an integer linear program. Using simulated strobe sequencing data, we show that our algorithm has better sensitivity and specificity than paired read approaches for structural variation identification.
INTRODUCTIONIdentifying the DNA sequence differences that distinguish individuals is a major challenge in genetics. Recent wholegenome sequencing and microarray measurements have shown that copy number variants (insertions, duplications and deletions) and balanced rearrangements, such as inversions and translocations, are common in most organisms including human (), mouse (), fly () and yeast (). These larger differences in DNA sequences are commonly referred to as structural variants. The Database of Genomic Variants () currently (winter 2010) lists nearly 30 000 copy number variants and nearly 900 inversion variants in the human genome. Although some of these variants are redundant and/or erroneous, it is clear that structural variation is an important component of human genome variation. In fact, there are more total base pairs in human genome affected by structural variants than single nucleotide polymorphisms (SNP;). Both common and inherited structural variants and de novo structural variants have recently been linked to a number of human diseases (). Moreover, somatic structural variants are common in cancer genomes and lead to altered regulation of oncogenes and tumor suppressor genes () and the creation of novel fusion genes (). Much of the recent excitement surrounding structural variation stems from better measurement technologies. In particular, End Sequence profiling (), also known as paired read mapping (), has been used to identify structural variants in both normal and cancer genomes. In paired read mapping, DNA fragments from a test genome are sequenced from both ends, and these sequences (reads) are mapped to a reference genome. Paired reads, or mate pairs, with discordant alignments identify inversions, translocations, transpositions, insertions, deletions and other rearrangements that distinguish the test genome from the reference genome. A number of methods have been introduced to identify structural variants from paired read sequencing data (). Structural variants vary widely in size and complexity, and are more difficult to characterize than SNPs. Many are associated with repeated sequences in the genome (), complicating their detection and characterization. In extreme cases, the variants themselves have highly repetitive or complex organization relative to the reference genome. For example, different lists of variants have been identified in the same individual using older clone-based sequencing () and various nextgeneration sequencing platforms (). Characterizing these complex variants requires longer reads, longer fragments, or both. Pacific Biosciences recently demonstrated strobe sequencing technology (). A strobe read, or strobe, consists of multiple subreads from a single contiguous fragment of DNA. These subreads are separated by a number of 'dark' nucleotides (called advances), whose identity is unknown (). A strobe with two subreads is analogous to a paired read, while strobes with more than two subreads provide additional information for structural variant detection. Thus far, Pacific Biosciences has demonstrated strobe reads with lengths up to 10 kb with. A strobe read is a sequence of subreads and advances. When aligned to a reference genome, pairs of adjacent subreads can either be labeled as concordant or discordant, according to a derived minimum and maximum allowed length of an advance.Strobe sequencing provides reads from long, contiguous fragments of DNA with low input DNA requirements, a feature missing from current short insert sequencing technologies. However, a consideration with strobe reads are the per-base error rates. While the capabilities of the Pacific Biosciences commercial machine (expected later in 2010) are not yet known, we conservatively assume that this error rate will be higher than existing nextgeneration sequencing technologies. Thus, realizing the advantages of strobe reads for structural variation detection demands new algorithms that utilize information from multiple subreads while allowing higher single-base error rates. We introduce an algorithm to identify and characterize complex structural variants with strobe reads by considering multiple possible alignments for each subread. We formulate the combinatorial optimization problem of selecting an alignment for each subread of every strobe read so that the total number of structural variants in the test genome is minimized. This generalizes a formulation that has proved successful for paired read analysis (). We show how to reduce the problem to an optimization problem on directed graphs, and derive an integer linear program (ILP) for the problem. We apply our method to simulated strobe read sequencing data. We find that strobe reads outperform paired reads for structural variation detection. In particular, at a fixed sensitivity level strobe reads have nearly double the specificity of paired reads.
APPROACHA strobe read, or n-strobe,is an alternating sequence of subreads R i , whose sequence is known, and advances A j , unknown sequences of 'dark' bases. The sequencing technology does not identify precisely the length, or number of dark bases, in each advance. However, the length of an advance is related to the time that the DNA polymerase incorporates dark bases. Thus, a distribution f (a) for the length is obtained from the data. From this distribution, we derive a minimum and maximum allowed length of an advance which we denote by L min and L max , respectively. Suppose one has strobe reads from a test genome and wants to identify structural variants that distinguish this genome from a reference genome. The first step in structural variation identification is to align the strobe reads to the reference genome. Each subread R i is aligned independently and corresponds to an intervalon the reference genome. Suppose that,...,[y n ,x n ] is a sequence of alignments for the subreads of an n-strobe S. We say that an adjacent pair of subread alignments () is concordant provided alignments are on the same strand and in the same order on the reference 1 and L min |y i+1 x i |L max. Otherwise, we say that the pair of subread alignments is discordant. Similarly, we say that a strobe read alignment is concordant if all pairs of adjacent subread alignments are concordant; otherwise, the strobe read is discordant. A discordant pair () suggests a structural variant in the test genome. For example, the breakpoints of a deletion from a pair of alignments mapped to the positive strand of the reference genome satisfy the equation L min  (ax i )+(y i+1 b)  L max (1) See. Similar equations hold for inversions, translocations and other variants (). A collection of discordant strobe reads indicate the same structural variant, if they have discordant pairs that simultaneously satisfy the equation above for a particular choice of breakpoints a and b. Now consider the case when subreads of a strobe read do not have unique alignments to the reference genome because of repetitive sequences in the reference genome and/or sequencing errors. In this case, the selection of an alignment for a subread determines a candidate structural variant. Our intuition is that breakpoints of true structural variants will be contained in many strobe reads. Thus, we aim to choose an alignment for each subread of every strobe read so that the resulting set of structural variants is optimal according to some objective function. This problem has been considered in the paired read case bydefine the maximum parsimony objective function of choosing alignments to minimize the number of predicted structural variants. Below we consider the equivalent problem for strobe reads, show a reduction to an optimization problem on directed graphs and derive an ILP for the problem.
METHODS
Problem formulationConsider an n) denote the set of locations in the reference genome where R i aligns, with each element of M(R i ) being an intervalon the reference genome. An alignment for S is obtained by selecting an alignmentbe the set of alignments for S. For m  M(S), let B(m) be the set of genomic breakpoints indicated by m. If m is concordant, then B(m) =. Note that these breakpoints are only approximately defined according to the uncertainty in the advance lengths [e.g. according to. We define the following problem.
n-Strobe Minimum Breakpoints Problem. Given alignmentfind a set of breakpoints B of minimum cardinality such that for all k = 1,...,K there is anThis problem is NP-hard, as was shown for the paired read case (n = 2) by a reduction to the Set Cover problem (). Below, we reformulate this problem for general n as an ILP.
Page: 1293 12911298
Strobe structural variation
Graph constructionWe derive our ILP from a directed graph G = (V ,E) that represents breakpoints shared by multiple strobe reads. We begin with a graph whose edges are alignments of a subread and vertices are advances between subreads. Formally, consider an individual strobe read S. We represent the set of all possible alignments for S with a directed graphis the set of all possible pairs of alignments of adjacent subreads, with an additional source vertex  S and sink vertex  S corresponding to the start of the first subread and the end of the last subread, respectively. We refer to vertices that are not sources or sinks as internal vertices. The edge set) corresponds to a directed edge (y,x). The alignments for strobe read S are exactly the set of paths in G S from  S to  S. In the graph construction, we use concordant pairs to reduce the number of alignments that we consider for subreads. In particular, if there exists a concordant pair for subreads R i and R i+1 , then we ignore all discordant pairs for these subreads R i with lower alignment score. For every concordant pair of alignments), we consider the vertex, add edges from all incoming neighbors to v to all outward neighbors from v and finally remove v from the graph. Now we form a graph G = (V ,E) by merging vertices in the graphs G S whose alignments are consistent with a single breakpoint (a,b) according to (1). We compute the vertices to merge using GASV (), a program that efficiently computes whether paired reads indicate the same structural variant using a computational geometry algorithm. In each merged vertex, we store the identities of strobe and subread alignments from the original vertices. The n-Strobe Minimum Breakpoints Problem reduces to finding a subgraph H of minimum cardinality (fewest number of vertices) such that H contains a path from source  k to sink  k for all k = 1,...,K. Note that H will always contain the source and sink vertices.
ILP formulationThe graph formulation suggests that finding the subgraph H might be solved as a fixed charge network flow problem. In particular, the graph formulation is suggestive of a fixed charge multi-commodity network flow problem (), with each strobe representing a distinct commodity. However, our problem differs from this and related problems in that we need to maintain separate accounting of each strobe entering and exiting a vertex rather than merely accounting for the net flow as in a multi-commodity flow problem. Nevertheless, we are able to formulate our problem as an ILP, motivated by an ILP for the fixed charge flow problem (). For each vertex v i  G, we define binary indicator variables p i such that p i = 1 if and only if v i is in the optimal solution. Similarly, we introduce variables q k ij , which represent the flow across edge (v i ,v j ) for strobe k. Lastly, we define N k i+ and N k i as the outward and inward neighbors, respectively, of vertex v i and strobe k. Our ILP for minimizing structural variants is then given by,Recall that each vertex v i corresponds to a breakpoint. perhaps common to multiple strobes. The objective (2), minimizes the number of vertices, thus minimizing the number of breakpoints. In the optimal solution, each,...,S 6. In Step 1, the discordant pairs (dotted lines) are clustered, producing seven candidate deletions. In Step 2, a graph is created with a source vertex  and a sink vertex  for each strobe and one vertex for each cluster (candidate deletion). The number on each vertex indicates the number of strobes with a discordant pair consistent with the deletion. In Step 3, the graph is simplified using heuristics described in Section 3.4. Step 3 is repeated until the graph has converged, upon which it is used as input to the ILP. edge q k ij must have weight 0 or 1it is either used once or not used at all per strobe. However, this does not need to be enforced as an explicit binary integer constraint. Instead, constraint (3) bounds q k ij between 0 and 1. Note that the flow for any edge q ij can only be non-zero if the v i and v j are in the optimal solution. Constraint (4) ensures that each strobe has a valid sequence of subread alignments.
Graph simplificationIn order to improve performance, we developed several heuristics to simplify the graph G before solving the ILP ().(removal, each strobe S will have at least one path from source to sink, but may have extraneous alignments that do not lie on any path from source to sink. We remove such edges from the graph, since they cannot appear in the ILP solution due to the flow constraint. The dynamic program for strobe removal is also used for this step.We iteratively perform these three operations on G until no more vertices, strobe reads or edges are removed.
BenchmarkingHere, we present the computations used to assess sensitivity and specificity in detecting a set of known deletions. Consider a set of deletions definedi.e. the prediction length must be smaller than the deletion length plus the largest allowed length of an advance. Let the number of such variants be V. The true positive rate is V |P|. and the number of false positives |B|V. Note that this is not a true ROC curve because we do not compute a false positive rate, but rather report the number of false positives (hence the quotes).
RESULTSWe applied our algorithm to simulated strobe sequencing data from Pacific Biosciences. The Pacific Biosciences simulator models the errors in their single-molecule sequencing technology. Specifically, the simulator models the higher rate of insertions and deletions (using a roughly equivalent ratio of each) relative to miscall errors in subreads that is typically seen in their data (). We analyze two datasets: structural variants identified in the Venter whole-genome assembly (
Comparison to paired readsFor each dataset, we compare the results with strobe reads to those obtained via paired reads. To remove differences due to read alignment, we construct paired reads using subsets of the subreads in each strobe. We consider two sets of paired reads:(The Paired Read Library dataset corresponds to a paired read dataset generated by a single size selection, while the Mixed Paired Read Library dataset corresponds to multiple fragment sizes. Note that for Illumina and ABI SOLiD machines, the latter requires preparation of multiple sequencing libraries. Given a set of strobe reads with physical coverage c, the Paired Read Library will have approximately the same physical coverage as strobe reads with twice as many reads. The Mixed Paired Read Library will have physical coverage 2c with three times as many reads. We subsample the reads in the Mixed Paired Read Library to achieve physical coverage c.
Variant detection on Venter Chromosome 17We simulated a test chromosome based on known rearrangements from Chromosome 17 of the Venter genome (), following the procedure presented in. Given a list of 17 376 insertions, deletions and inversions on Chromosome 17, we concatenated intervals from the hg18 human reference corresponding to the rearrangements. We then simulated 3 kb strobe reads at 10, 20 and 30 coverage, producing 262 355, 524 709 and 787 064 strobe reads, respectively. After aligning the subreads to Chromosome 17 of hg18 using Pacific Biosciences's in-house aligner, BLASR, we generated a Paired Read library and a Mixed Paired Read library as described in Section4.1. BLASR is designed to quickly align large reads and is tolerant to a wide range of sequencing errors (M.Chaisson, personal communication).
DeletionsWe considered the 124 deletions greater than 120 bp in Venter and computed the variant-based ROC curve by varying , the minimum support of a vertex (). In terms of 'Area under the ROC Curve' (AROC) values, strobe reads outperform paired reads for all three coverages. Moreover, strobe reads outperform Mixed Paired Reads for 10 and 30 coverages, where the advantage in AROC for the Mixed Paired Read library is a result of slightly better specificity at extremely low (Thus, we considered the pairs that span the 124 deletions in each dataset and computed the 'pair-based' ROC curve (). Strobe reads outperform paired reads and mixed paired reads for all three coverages (AROC). Strobe reads decrease the false positive rate by an average of 50.83%  4.83 compared with the Paired Read datasets and 56.07%  8.11 compared with the Mixed Paired Read libraries at fixed sensitivity. The size and topology of the graph G used as input to the ILP varies between the Strobe, Paired Read and Mixed Paired Read libraries, affecting the runtime of the ILP. In particular, the Strobe datasets construct graphs with fewer edges and vertices than the Paired Read and Mixed Paired Read libraries. For example, with support = 8 there are 65% fewer edges and internal vertices for 10 coverage; 80% fewer edges and internal vertices for 20 coverage; and 83% fewer edges and internal vertices for 30 coverage (). Note that this does not necessarily indicate that the Strobe dataset generates fewer clusters that are used to construct the graph; Strobe and Paired Read datasets predict the same number of clusters at each coverage (which is expected due to the Paired Read library construction in Section 4.1); and the Mixed Paired Read library uses a smaller set of clusters to construct the graph G. In addition to the size of the input graph G, the graph topology is different between the Strobe datasets and the Paired Read libraries. In general, graphs with many connected components are easily parallelizable, as each connected component could be run independently of the others. While all graphs contain many connected components, the graphs of Paired Read and Mixed Paired Read libraries contain connected components with many more internal vertices than graphs with Strobe data. For example, at 10 coverage with = 4, the largest connected component for the Paired Read library contained 350 internal vertices while the largest connected component for the Strobe dataset contained only six internal vertices. One such connected component from the Strobe dataset with 10 coverage is shown in.
Strobe structural variation
InversionsOnly four inversions appear on Venter Chromosome 17 with lengths detectable by the simulated sequencing data. Our method detects the two longest inversions of these four for the Strobe and Paired Read libraries, while the Strobe dataset predicts 22% fewer false positives (). Here, the true positive rate computation described in Section 3.5 does not apply; instead we counted an inversion if the mutual intersection between the inversion interval and the prediction interval was >50%, following
Comparison with short read sequencing Toillustrate the advantages of the longer fragments and subreads of strobe sequencing, we compared strobe reads to simulated paired read data that approximates the fragments sizes and read lengths that are routinely obtained with short read, short insert sequencing technologies (). Using the same Venter Chromosome 17, we simulated 200 bp fragments with 50 bp reads using the wgsim program from SAMtools () at 20 coverage. The simulated fragments have a base error rate of 0.02, a mutation rate of 0.001, 10% indels and 30% probability that an indel is extended. We aligned the reads using Burrows-Wheeleer Alignment (BWA)The clustering statistics include the number of discordant pairs after removing concordant alignments, the number of these discordant pairs that are deletions (their lengths are greater than L max and they have proper orientation) and the number of clusters. The graph statistics include the number of strobe reads or paired ends that are removed from the graph, the number that are retained, the number of internal vertices and the number of edges in the graph. The solution statistics report the number of internal vertices in the final ILP solution and the number of these vertices that are in the list of 124 deletions 120 bp.(). We then ran GASV () on the discordant pairs that map uniquely to the reference. Since VariationHunter () utilizes reads with non-unique alignments, we considered discordant pairs that have multiple alignments to the reference. We considered reads with low mapping quality (10) for BWA and aligned them with Novoalign, an aligner that has higher sensitivity than BWA at the cost of a longer running time (). We considered up to 100 alignments for reads aligned with Novoalign. At maximum specificity for strobe reads, where the true positive rate is 0.87, VariationHunter achieves a true positive rate of 0.35 and GASV achieves a true positive rate of 0.34 at approximately the same sensitivity (between 85 and 95 false positives). We emphasize that this comparison is limited by its use of simulated data, and by our use of VariationHunter and GASV without further post-processing. For example, the VariationHunter publication () describes several additional steps used to achieve better performance. Additionally, uncontrolled simulation parameters such as the fragment length and the subread length affect the comparison, and explicitly comparing the performance of different types of sequencing platforms is beyond the scope of this article.
Variant detection in repetitive regionsRepetitive regions in the genome are notoriously difficult for structural variant detection. To test the ability of strobe reads to capture breakpoints near repetitive regions, we constructed a 11.6 kb sequence with two translocations by concatenating three different transposons from hg18: a 6 kb L1-family LINE (chr2:181406133181413161), a 503 bp Alu (chr7:66854543-66856104) and a 3 kb L2-family LINE (chr15:87930634-87933678), each flanked by 500 bp. From this sequence, we generated 10 simulations with 10 coverage using the same sized 3 kb strobe reads as above and introduced 5% error. After aligning the subreads to hg18,). Many subreads in the simulations align to Page: 1297 12911298hundreds of different regions on the genome, causing the Paired Read libraries to contain many internal vertices in the input graph for the ILP. However, the number of vertices in the graph is greatly reduced using strobe reads, indicating that many pairs in these repetitive regions are eliminated by incorporating concordant information ().
Strobe structural variation
DISCUSSIONStructural variants vary widely in size and complexity, and thus are generally more difficult to characterize than SNPs. Sensitive and specific detection of structural variation in human genomes from next-generation sequencing data remains a challenge. This is due to both technological limitations (in read length, error rates and insert sizes) and biological factors. Structural variants in human are: (i) enriched for repetitive sequences near their breakpoints (); (ii) may overlap or have complex architectures; and (iii) recurrent (but not identical) variants may exist at the same locus (). We have shown that strobe reads have advantages in sensitivity and specificity over paired reads for structural variant detection. Since a single strobe can resolve multiple breakpoints, inference of duplications and rearrangements become more direct. The method handles both intra-chromosomal (Section 4.2) and interchromosomal (Section 4.3) events, making it suitable for genomewide analyses. While we have examined deletions, inversions and translocations in simulated strobe read data, explicitly testing the detection power of insertions using strobe reads remains future work. An interesting question is whether strobe reads will detect more complex variants that are beyond the abilities of current sequencing technologies. We showed a preliminary comparison of simulated strobe sequencing versus simulated short read, short insert sequencing. Although this comparison demonstrates an advantage for strobes, a more rigorous assessment with real sequencing data is required to obtain a definite comparison of these technologies. An inherent limitation in any approach is the accuracy of the underlying alignments. Most second generation sequencing technologies produce short reads with increasing error rates near the end of the reads and few insertions. The Pacific Biosciences technology differs in that it has predominantly long reads, uniform error over the entire read and an insertion/deletion heavy error model (). For these reasons, different alignment approaches have been suggested that use k-mer seeding followed by alignment extension (). In our study, mappings were ranked using a naive SmithWaterman score, assuming uniform quality of all sequenced bases. As mapping and scoring for single-molecule sequencing technologies mature, the proposed ILP can be changed to use more sophisticated scoring functions, increasing sensitivity (by ensuring true alignments are included) and specificity (by reducing spurious alignments). Current and new technologies are continually increasing the read length (or subread length in the case of strobe reads). Longer subreads imply a higher frequency of split reads (subreads which span a breakpoint). Such events can be readily incorporated into the ILP by converting subreads with non-overlapping mappings (relative to the subread) into psuedo-strobe reads, leading to paths of variable length from source to sink for a given strobe read. The advance in this case becomes the distance between the end of the first alignment and the start of second alignment on the subread. This allows the method to be used as a generic framework for evaluating genome-wide structural variation given any form of sequencing data. The suggested model is designed to handle germ-line mutations. In scenarios with heterogeneous data or when somatic mutations are abundant, such as in cancer, the assumptions in our model could be limiting. For example, the notion of minimizing breakpoints and clustering breakpoint junctions may be incorrect. In areas of elevated chromosome instability, each individual cancer cell may undergo different mutations leading to slightly (or greatly) different breakpoint boundaries. Additionally, breakpoint clustering is significantly more challenging as some genomic aberrations may only be present in a small fraction of cells. Integrating copy number information on a per breakpoint basis could provide added power in detecting these lower frequency events.
CONCLUSIONSWe introduce a combinatorial algorithm for structural variant identification from strobe read sequencing data. We show that strobe Page: 1298 12911298
A.Ritz et al.reads outperform paired reads on simulated sequencing data. In particular, strobe reads have nearly doubled the specificity at fixed sensitivity for structural variation prediction. In the near future, we will test our algorithm on real sequencing data.
The Author 2010. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oxfordjournals.org 1291 at :: on August 31, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
The definition of concordant is different for paired read sequencing technologies (e.g. Illumina) that produce reads on opposite DNA strands.
at :: on August 31, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
at :: on August 31, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from [09:33 4/5/2010 Bioinformatics-btq153.tex] Page: 1296 12911298
