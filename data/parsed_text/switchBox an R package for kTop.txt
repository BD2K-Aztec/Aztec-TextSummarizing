kâ€“Top Scoring Pairs (kTSP) is a classification method for prediction from high-throughput data based on a set of the paired measurements. Each of the two possible orderings of a pair of measurements (e.g. a reversal in the expression of two genes) is associated with one of two classes. The kTSP prediction rule is the aggregation of voting among such individual two-feature decision rules based on order switching. kTSP, like its predecessor, Top Scoring Pair (TSP), is a parameter-free classifier relying only on ranking of a small subset of features, rendering it robust to noise and potentially easy to interpret in biological terms. In contrast to TSP, kTSP has comparable accuracy to standard genomics classification techniques, including Support Vector Machines and Prediction Analysis for Microarrays. Here, we describe 'switchBox', an R package for kTSP-based prediction. Availability: The 'switchBox' package is freely available from Bioconductor: http://www.bioconductor.org.
INTRODUCTIONFinding 'omics'-based biomarkers for clinical use has been extensively studied in numerous diseases. However, mature clinical applications of these biomarkers are scarce due to technological, mathematical and translational barriers (). Basing the prediction solely on the ordering of a small number of features (e.g. gene expression ranks within profiles) may overcome such barriers to clinical translation (). Rank-based classifiers are robust to data normalization and yield transparent decision rules (). The first and simplest of these rank-based methods, the Top Scoring Pair (TSP) classifier, in which the decision rule is entirely determined by the ordering of two features (i.e. the relative expression of two genes), was introduced in. Multiple extensions to TSP were proposed [e.g.;and some have been successfully applied to human cancer such as simplifying clinical biomarkers (). A theoretical analysis, R implementation and description of the TSP algorithm can be found inhttp://hal.archives-ouvertes.fr/docs/00/78/48/69/PDF/Article.pdf), Leek (2009) and Leek (2014), respectively. One powerful successor of TSP is kTop Scoring Pairs (kTSP;), which applies majority voting among multiple pairs of features. kTSP has outperformed Support Vector Machines in an open challenge for cancer classification () and yielded comparable accuracy to the Mammaprint breast cancer assay (). Here, we introduce an R package, 'switchBox', for kTSP. This package selects the gene pairs for the kTSP decision rule. The package also implements a new approach to choose the number of pairs, k, based on the analysis of variance introduced in, which is less computationally intensive and less prone to overfitting than the original method introduced inand implemented in the R 'ktspair' package (). In addition, 'switchBox' provides more flexibility in the selection of candidate ranges of k, as well as alternative strategies for pair votes aggregation compared with the previous R implementation (). Finally, 'switchBox' has a method for calculating sample-specific scores based on the pairs (see Methods), which can be extended beyond classification to class discovery problems.where I is the logical indicator function. The kTSP classification decision is based on thresholding , i.e. ^ Y=If4g provided the labels Y 2 f0; 1g. The standard threshold is = k 2 , equivalent to majority voting. The only parameters required for calculating are the number and choice of feature pairs. In the introductory paper to TSP (), the authors proposed a score for each pair of features, which measures the discriminative power of a two-feature comparison. The score assigned to genes i and j was defined as s ij =jP X i 5X j jY=1  P X i 5X j jY=0j:
METHODSThe first training algorithm proposed for training kTSP, i.e. for finding Y, was an ad hoc method based on the score (). The 'switchBox' package implements a formal method of feature selection based on analysis of variance (). Briefly, this *To whom correspondence should be addressed. method selects the feature pairs maximizing the distance between the expectation of in each group normalized by the variance. The target set of feature pairs is thenThis method as implemented in 'switchBox' uses a greedy search for Y  for computational efficiency. This search process simultaneously selects the optimal number of features, requiring only an upper bound on the number of feature pairs as input. To find Y  , we optimize Equation (2) greedily and with empirical estimates from the data.
IMPLEMENTATIONFor computational efficiency and speed, 'switchBox' calculates the score between all feature pairs using C routines. The user can directly calculate the score of a desired set of features or feature pairs by invoking the SWAP.CalculateSignedScore function. The package provides a training function (SWAP. KTSP.Train) for the classifier and a function (SWAP.KTSP.Classify) for predicting the label of an unseen sample. The training function allows the user to filter either the individual features or the feature pairs, thereby reducing the variability in the learned decision rules. The package also provides a function (SWAP.CalculateSignedScore) to calculate the pairwise scores from any subset of features or subset of feature pairs. Below we briefly show how to train a kTSP classifier for breast cancer recurrence within 5 years using gene expression data from, described in further detail in the 'switchBox' package vignette. First, we load the example training and testing gene expression data contained in the 'switchBox' package. We then train the classifier and compute the confusion matrix for predictions on the test samples as follows:We have found that the kTSP classifier from 'switchBox' is more robust and inferred at greater computational speed than that from the 'ktspair' R package (Supplementary Document). In addition, 'switchBox' provides an additional function SWAP.KTSP.Statistics to calculate kTSP statistics, i.e. in Equation (1). This function is useful for generating ROC curves and for calculating ranked-based statistics from TSPs found in the classifier. For example, the code below generates a heatmap to depict classification results for each pair in the classifier ().
CONCLUSIONWe introduced 'switchBox', an R package for kTSP classifier with a robust procedure for pair selection as previously described in, the procedure requires less computation and is less prone to overfitting than the one described inand implemented in 'ktspair' package (). Moreover, we provide functions for calculating auxiliary statistics as well as any user-defined combination of the comparisons.. The comparisons votes (y-axis) versus samples (x-axis). The samples are labeled either good prognosis or bad prognosis for breast cancer. Truth and falsehood of the comparisons are indicated by blue (lighter shade) and red (darker shade), respectively. The combination of the votes can be used to classify, illustrated by requiring at least three votes for declaring bad prognosis. More explanation and code for this figure can be found in the Supplementary Document
The Author 2014. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
B.Afsari et al. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
