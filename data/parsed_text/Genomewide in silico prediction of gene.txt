Motivation: Modelling the regulation of gene expression can provide insight into the regulatory roles of individual transcription factors (TFs) and histone modifications. Recently, Ouyang et al. in 2009 modelled gene expression levels in mouse embryonic stem (mES) cells using in vivo ChIP-seq measurements of TF binding. ChIP-seq TF binding data, however, are tissue-specific and relatively difficult to obtain. This limits the applicability of gene expression models that rely on ChIP-seq TF binding data. Results: In this study, we build regression-based models that relate gene expression to the binding of 12 different TFs, 7 histone modifications and chromatin accessibility (DNase I hypersensitivity) in two different tissues. We find that expression models based on computa-tionally predicted TF binding can achieve similar accuracy to those using in vivo TF binding data and that including binding at weak sites is critical for accurate prediction of gene expression. We also find that incorporating histone modification and chromatin accessibility data results in additional accuracy. Surprisingly, we find that models that use no TF binding data at all, but only histone modification and chro-matin accessibility data, can be as (or more) accurate than those based on in vivo TF binding data. Availability and implementation: All scripts, motifs and data presented in this article are available online at http://research.
INTRODUCTIONA key challenge in modern genomics is understanding the regulatory interactions that occur to control gene expression. We can use predictive modelling techniques such as linear regression to both determine the accuracy of our understanding of the mechanisms of the regulation of gene expression, and to interpret and offer insight into the roles played by the various regulatory proteins, RNAs and other factors. Perhaps the most studied and best understood mechanism of gene regulation is transcription factor (TF) binding. TFs characteristically have sequence-specific DNA-binding preferences. They typically bind sites that are short (515 bp), and often degenerate. Not surprisingly, navenave computational approaches that simply scan genomic sequence for matching sites are highly prone to making false-positive predictions (). In an attempt to overcome this, methods incorporating evolutionary information regarding the conservation of each putative site such as BBLS () have been proposed. In reality, however, most researchers aim to make tissue-, cell-or condition-specific (hereafter 'tissue-specific') inferences regarding gene regulation, which evolutionary information alone cannot provide. Histones are subject to many different covalent posttranslational modifications such as methylation and acetylation. These modifications can alter chromatin structure and function and are known to comprise a tissue-specific histone 'code', read by proteins to effect changes in gene regulation and expression (van). Recently, global chromatin-immunoprecipitation with massively parallel sequencing (ChIP-seq) 'maps' of many histone modifications have become available through the ENCODE () and NIH Roadmap Epigenomics () projects. ChIP-seq is not just limited to interrogating histone state, but also has become the gold-standard method for the genome-wide prediction of tissue-specific TF-bound regulatory regions. Unfortunately, however, TF ChIP-seq suffers from a major drawback: only one TF (in a single tissue) may be analysed at a time. It would be an extremely significant endeavour to predict the binding of the 41391 known human sequence-specific TFs () in one tissue or condition. As a result, even large-scale projects to date have focused either on a small number of TFs across several tissues (e.g. 10 TFs in modENCODE;), or on a larger number of TFs in relatively few tissues (e.g. three primary tissues in ENCODE;). Additionally, determining an appropriate cutoff for declaring putative binding sites is difficult and has been the focus of substantial research (). ChIP-seq TF binding data have previously been used to construct a model of gene expression () in mouse embryonic stem (mES) cells. They used ChIP-seq binding data for 12 TFs that are known to contribute heavily to maintaining pluripotency () and thus are considered key factors regulating gene expression in ES cells.performed linear regression, correlating binding by these TFs with the expression of all genes and found that it could explain 65% of the variation in gene expression in ES cells (r  0.81). This study did not consider the role of histone modifications on expression, but Karlict al. (2010) built a similar regression model for human CD4 T cells, using histone *To whom correspondence should be addressed. modification data rather than TF binding data and also managed to explain a high degree of expression variance (r  0.74). In this study, we use TF binding, histone modification and chromatin accessibility data to address three major questions:(i) can we accurately predict gene expression using in silico predictions of TF binding rather than in vivo binding data? (ii) Does adding histone modification and chromatin accessibility data improve the accuracy of predicted gene expression? (iii) Are weak binding sites important to accurately predict gene expression? To answer these questions, we derive log-linear regressionbased models that relate gene expression to the binding of 12 different TFs, to 7 histone modifications and to chromatin accessibility. We find that expression models based on computationally predicted TF binding can achieve similar accuracy to those using in vivo TF binding data and that including binding at weak sites is critical for accurate prediction of gene expression. We also find that incorporating histone modification and chromatin accessibility data results in additional accuracy. Surprisingly, we find that models that use no TF binding data at all, but only histone modification and chromatin accessibility data, are essentially as accurate as those based on in vivo TF binding data.
METHODSTo predict gene expression, we build a log-linear regression model of gene expression as a function of TF binding, histone modifications and chromatin accessibility. Each gene is represented as a vector of features, where each feature represents either the predicted binding of a TF, the presence of a histone modification or the chromatin accessibility around the transcription start site (TSS) of the gene. The model is fit to the level of the expression of each gene as measured by RNA-seq.
Predicting TF binding (TF affinity scores)For each TFgene pair, we integrate either measured or predicted TF binding around each gene promoter into a single TF affinity score (TFAS) using a weighted sum, where the weight decreases exponentially as a function of distance from the TSS. Following the definition given by, we define the TFAS, A ij , for the ith gene and the jth TF as the weighted sum over all predicted binding sites (k) as:where g k is the score of an individual predicted TF binding site. We weight the contribution of each site to our integrated TFAS by the exponential decay term e dk=d0 , where d k is the distance in base pairs of the putative binding site (k) from the TSS and d 0 determines the decay rate. Following, we set d 0  5000 for all TFs except E2f1, where we set d 0  500 (). We only include in this weighted sum putative binding sites within 30 000 bp of the TSS, as the weighted contributions of more distant sites are negligible. We evaluate four methods for predicting individual binding sites and assigning individual site scores (g k ), which we discuss below. We then log transform and quantile normalize the TFAS matrix A ().H3K4me3 data. We use parameters  1 and  4  10 5. We scan the genome using this prior and the default FIMO settings. For our site affinity scores (g k ), we use the log-posterior ratio scores reported by FIMO.
ChIP-seq site affinity scores
Measuring histone modifications and chromatin accessibility (histone and DNase scores)We calculate histone modification scores (histone scores) and chromatin accessibility scores (DNase scores) for each histone modification and for DNase I hypersensitivity at the TSS of each gene. Taking a region AE2000 bases relative to the TSS, we sum the number of mapped tags for each histone modification and for DNase (see Section 2.5). We define Z ik for gene i and histone modification or DNase score k as:where TC(k, i, n) is the number of mapped sequence tags for histone modification or DNase I hypersensitivity k at position n relative to gene i's TSS. As we do above for the TFASs, we then log-transform and quantile normalize the matrix Z ().
Linear regressionWe describe genome-wide gene expression by a log-linear model:where Y i is the expression level for gene i, is the basal expression level, A ij is the jth TFAS for the ith gene and j is the fitted coefficient for the jth TFAS. Similarly, Z ij is the jth histone or DNase score for the ith gene and j the fitted coefficient for the jth histone modification or DNase score. i is the gene-specific error term. is a fitted term to avoid taking log(0); we fit using a held-out 20% of our data. To obtain confidence intervals, we bootstrap the regression 1000 times on the remaining 80% of our data.
Linear regression with principal component analysisWe decompose a matrix, C, consisting of the column-wise concatenation of our TFAS matrix, A and our histone and DNase score matrix, Z, using the singular-value decomposition C  UAEV T , as described in. We create the matrix X  UAE, which is of the form X ij , where the columns are the principal components (PCs) and the rows are genes. Using this transformed data, we perform the regression,where Y i is the gene expression level, represents basal expression, M is the number of PCs, i is a gene-specific error term and B j is the fitted coefficient for the jth PC. We fit as previously described. We bootstrap the PC analysis (PCA) regression as previously described.
Data
Mouse embryonic stem cellsThe TSS of genes is taken from the gene annotation dataset for the mouse genome (mm8/NCBIM36.46) from the Ensembl FTP server (ftp://ftp.ensembl.org/). To exclude the possibility that we include multiple transcripts or isoforms of the same gene in our regression, we use the most 5 0-located TSS from the Ensembl gene annotation data as each gene's TSS. We also exclude all genes from haplotype variants and unmapped contig regions. This, combined with the removal of any genes with low confidence RNA-seq mapping, leaves a set of 18 008 genes for analysis. Histone modification ChIP-seq data for H3K4me1, H3K4me2, H3K4me3, H3K9me3, H4K20me3,motif, we trimmed off the non-Oct and non-Sox portion from the Oct4 and Sox2 motifs, respectively. For full details, please see the Supplementary Material. We use an extremely deep RNA-seq mouse expression dataset (), which was re-normalized in reads per kilobase of exon per million tags (RKPM) by. RKPM has been previously shown to be proportional to mRNA abundance ().
GM12878 cellsThe TSS of genes is taken from the gene annotation dataset for the human genome (hg19/GRCh37) from the Ensembl FTP server (ftp://ftp.ensembl.org/). To exclude the possibility that we include multiple transcripts or isoforms of the same gene in our regression, we use the most 5 0-located TSS from the Ensembl gene annotation data as each gene's TSS. We also exclude all genes from haplotype variants and unmapped contig regions. This, combined with the removal of any genes with low confidence RNA-seq mapping, leaves a set of 37 458 genes for analysis. Histone modification ChIP-seq data for H3K4me1, H3K4me2, H4K20me1, H3K27me3 and H3K36me3 are from the ENCODE project 'bigWig' files produced by the Broad laboratory (ENCODE, 2011). H3K4me3 was remapped onto hg19 from the 'fastq' file produced by the Broad laboratory using BowTie (). Raw DNase I hypersensitivity data are from the 'signal' bigWig file produced by the Duke laboratory as part of the ENCODE project (ENCODE, 2011). We use TF ChIP-seq data for c-Fos, Ctcf, Egr1, Nrf1 Nrsf, Pou2f2, Sp1, Srf, Stat3, Usf1 and Yy1. We also use an ENCODE-provided RNA-seq dataset for our GM12878 gene expression data, which we mapped onto hg19 and normalized into RKPM using TopHat (). Full details on the sources of the RNA-seq data, ChIP-seq data and the PWMs are provided in the Supplementary Material.
ImplementationWe implement the log-linear regression models in R (R Development Core). All R scripts, motifs and data (including expression data, TFASs, histone and DNase scores) are available online at http:// research.imb.uq.edu.au/t.bailey/supplementary_data/McLeay2011a/.
RESULTS
Using in silico TF binding predictions to model gene expressionWe first explore whether in silico TF binding predictions can replace ChIP-seq binding measurements. To do this, we build models using only TF binding features and compare models of gene expression based on TF ChIP-seq binding data with models based on in silico TF binding estimates (). As expected, models using in vivo measurements of TF binding (ChIP-seq TFAS) explain substantially more variance (adjusted R 2  0.644;, bar 3) than models using either the non-tissue-specific in silico (PWM) or tissue-specific in silico (PWM  H3K4me3) affinity scores. We find that a model using tissue-specific in silico TF binding predictions (PWM scanning with a H3K4me3 prior) is much more predictive of expression than the non-tissue-specific in silico affinity score model (adjusted R 2  0.521 and adjusted R 2  0.279;, bars 1 and 2, respectively), nearly doubling the explained variance. We hypothesize that possibly one or more of the TFs are poorly described by their PWM, hampering the performance of our models that use in silico binding predictions. To explore this, we take the ChIP-seq TFAS model and replace a single TF with the equivalent tissue-specific in silico data. Replacing the single E2f1 tissue-specific in silico TFAS with ChIP-seq E2f1 data yields a model that is statistically indistinguishable from one using all 12 ChIP-seq datasets (, top two bars. R 2  0.630 and R 2  0.644, respectively, error bars overlap). Replacing any other tissue-specific in silico TFAS with a ChIP-seq TFAS has either minimal or no effect (, compare bottom bar with others), with the exception of Sox2, where its inclusion surprisingly decreases R 2 (see Section 4). Thus, with our in silico method and ChIP-seq data for one TF, we can achieve indistinguishable accuracy to using 12 ChIP-seq datasets. Having observed that E2f1 is the sole TF, where replacing tissue-specific in silico E2f1 data with ChIP-seq TF data is sufficient to increase explained gene expression variance to be indistinguishable from using 12 TF ChIP-seq datasets, we also examine whether in an all ChIP-seq TFAS model, replacing the E2f1 ChIP-seq data with in silico data decreases the accuracy of the model. In our model using all ChIP-seq TFASs, we find that replacing any ChIP-seq TFAS except E2f1 with PWM  H3K4me3 data has no statistically significant effect on model accuracy (, compare bottom bar with others). Replacing E2f1 ChIP-seq TFAS with the E2f1 PWM  H3K4me3 TFAS, however, causes a large decrease in R 2 , suggesting that the tissue-specific in silico binding predictions fail to completely capture the binding of E2f1. For any other TF in the model, replacing ChIP-seq data with tissue-specific in silico binding data causes no significant decrease in accuracy. When we regress each ChIP-seq TFAS alone against expression ('Results' section in the Supplementary Material;), we find that E2f1 is the most individually informative TF. It has been suggested that E2f1 binds520% of its binding sites directly in human ES cells (). If this is the case, PWM-based methods would therefore be unable to predict the majority of E2f1 binding sites. Given the importance of E2f1 in this model, it is not surprising that models including in silico E2f1 data are less predictive of gene expression.
A combination of histone modification and DNase I hypersensitivity data is as predictive of expression as TF ChIP-seq dataNext, we examine whether integrating histone modification data and chromatin accessibility information (DNase) will improve the predictive accuracy of both tissue-specific in silico TFAS and ChIP-seq TFAS models of gene expression. We perform log-linear regression using our 12 TF affinity scores, both alone and combined with histone modification and chromatin accessibility data. In, we compare the descriptive power (expressed as adjusted R 2 ) of four models: ChIP-seq TFAS only, tissue-specific in silico TFAS with histone modification and DNase data, ChIP-seq TFAS with histone modification and DNase data, and histone modification and DNase data alone (no TF binding data). We find that models that use no TF binding data at all are surprisingly accurate. A model using just seven histone scores and the DNase score (bar 2,) is as descriptive of gene expression as the model using the ChIP-seq TF binding data for all 12 TFs (bar 1,). There is no statistically significant difference in the accuracy of these two models (R 2  0.624 cf. R 2  0.644, 95% confidence intervals overlap). While it is well known that histone modifications play key roles in mediating gene expression (), it is still surprising that a model based on only these seven histone modifications and chromatin accessibility, and not on TF binding data, predicts expression almost as well as a model using the 12 TFs known to be key regulators of gene expression in pluripotent mES cells (). Next, we determine whether combining histone modification and chromatin accessibility data with our tissue-specific in silico TF binding predictions improves predictive accuracy. We find that including incorporating histone modification and chromatin accessibility data with our tissue-specific in silico (PWM  H3K4me3) method to be as effective as using ChIP-seq TFAS data (R 2  0.649 and R 2  0.644,, bars 3 and 1, respectively, error bars overlap). We also find that our PWM  H3K4me3 method with histone and DNase scores to be more effective than only using histone modification and DNase data (R 2  0.649 cf. R 2  0.624,, bars 3 and 2, respectively, error bars do not overlap). Finally, combining histone modification and chromatin accessibility data with ChIP-seq TFAS (right-most bar,)provides a significant improvement to the regression fit (R 2  0.695) over ChIP-seq TFAS alone. Both the histone and DNase score only model, and the ChIP-seq TFAS only model, are quite descriptive of gene expression. The improvement gained by combining histone, DNase and TF binding data suggests that there is additional information available in the histone and DNase data that is not present in the TF ChIP-seq data.
Predicted expression correlates well with measured expressionIt is also informative to plot the predicted expression against the actual RNA-seq expression data for our models (d) and to calculate the Pearson correlation coefficients (r). For several of our methods (tissue-specific in silico TF predictions with histone and DNase data; ChIP-seq TF data only; ChIP-seq TF data with histone modification and DNase data; histone modification and DNase data alone), we actually achieve higher correlation between our predicted expression values and actual (RNA-seq) expression values than that observed between RNA-seq and microarray expression experiments in the same tissue (r  0.734; see the Supplementary Material to). The predicted and actual expression values are fairly well correlated in the model that is based on ChIP-seq TF, histone and DNase scores (, r  0.834) and in the model t based on tissue-specific in silico TF, histone and DNase scores (, r  0.806). The correlation in the non-tissue-specific in silico model (PWM,). We find only a relatively small difference in accuracy between these models, both having predicted expression values that correlate well with actual expression.
Principal components provide information on TF and histone rolesWe then perform PCA using singular value decomposition of TF, histone modification and chromatin accessibility (DNase) data, decomposing a joint matrix (with TF, histone modification and DNase data as columns) into PCs (see Section 2.4). Using these components rather than TFASs, and histone and DNase scores directly, we perform log-linear regression. PCA allows the extraction of a small number of non-correlated PCs responsible for the majority of gene variance. We examine the role of each TF, histone modification and chromatin accessibility in the regression. We plot the relative loading of each feature within the most informative PC (PC2), weighted by the proportion of variance explained (adjusted R 2 ) by that PC (). We find that the tissue-specific in silico TF PCA model is very similar to the ChIP-seq TF PCA model at providing biological information on the regulatory roles of the features, especially in the most important PCs. Visually, a high degree of similarity between the PCs is present, with only minor differences (comparing). Both models show all TFs as positively associated with transcription, with E2F1, Klf4, Zfx, c-Myc and(b)n-Myc as the most weighted TFs. Likewise, the weighted loading on each histone modification is qualitatively similar between models.shows the second PC, which alone is the most informative PC in the regression. When a model with PC2 as the only feature is fit to expression, it explains almost half of gene expression variance (R 2  0.475). The remaining PCs and a short discussion are provided in 'Results' section in the Supplementary Material.shows the relative loading of each component within PC2 (which accounts for %48% of explained variance) successfully recapitulating known knowledge of histone modification effects. Both models suggest that H4K20me3, H3K27me3 and H3K9me3 repress gene transcription. Both H3K9me3 and H4K20me3 are known to be involved in gene silencing, associating with heterochromatin (). H3K27me3 is associated with facilitating binding of the Polycomb repressor complex 1 (). In PC2, both the loadings of H3K4me2 and H4K4me3 suggest activating effects, which are well reported throughout the literature (e.g.). A difference between the ChIP-seq and tissue-specific in silico (PWM  H3K4me3) PCA models is noted for H3K36me3, which is known to maintain genes in a 'poised' state for either activation or repression. The similarity between the predicted roles by our tissue-specific in silico method and the roles predicted by the ChIP-seq data strongly suggests that our in silico method is capable of making biologically sound predictions of TF and histone roles.
Confirmation in GM12878 cellsTo insure that our results were not specific to mES cells, we repeated our experiments using equivalent data from GM12878 cells. The pattern of the results are extremely similar to those using mES cell data, with models based on TF ChIP-seq, histone ChIP-seq and DNase I hypersensitivity explaining more gene expression variance than models based on TF ChIP-seq alone (, bars 3 and 6). Compared with the mES cell models, the relative improvement in accuracy of the ChIP-seq-based gene expression model when chromatin modification and accessibility data are added is much larger (compare). This is consistent with the fact that the model based on histone and DNase I data alone (without any TF-specific data) is much more accurate than model based on TF ChIP-seq data. This may be due to the set of TFs we use with the mES cell data being more complete (with respect to the complete set of key regulators) than the set we use in the GM12878 experiments. We note as well that the model using PWMs plus histone and DNase data is far more predictive of gene expressionThe relative loading of each feature of PC2 in a model containing tissue-specific in silico TFAS (PWM  H3K4me3) with histone and DNase scores. Each bar corresponds to the weighted loading of a TF or histone mark in the regression. We weight the loadings of each TFAS or histone and DNase score by the variance explained by the principal component to which they belong. See 'Results' section in the Supplementary Material for all principal componentsthan the model based solely on TF ChIP-seq data (, bars 3 and 5). We note that compared with our previous results in mES cells, each model explains comparatively less expression variance in GM12878 cells (compare Figs 1a and 2 with). For example, the best performing model in both tissuesChIP-seq binding measurements combined with histone modification and chromatin accessibility dataexplains %30% less of the total gene expression variance in GM12878 cells than in mES cells (R 2  0.412 and R 2  0.695, respectively). As noted earlier, this may be partially due to the TFs used in the model. Additionally, one of the most informative histone modifications in mES cells, H4K20me3 () was unavailable for GM12878 cells. We also measure correlation between actual and predicted expression in GM12878 cells for each regression model and perform the singular value decomposition regressions in GM12878 cells and these results are included in the Supplementary Material.
DISCUSSIONWe have successfully explained the majority of variance in gene expression in mES cells by building an integrated model of 12 TFs, seven histone modifications and DNase hypersensitivity data. In fact, we find that gene expression levels predicted by both the tissue-specific in silico models and the histone modification and DNase-only model are more highly correlated with mESC RNA-seq gene expression data than microarray data from the same tissue type. The wide availability of TF binding site motifs () gives our in silico method the advantage of allowing the evaluation of many different TFs without the cost and time required to perform TF ChIP-seq experiments, instead requiring only a PWM and H3K4me3 data in the tissue of interest. Surprisingly, we find that using the seven histone modifications and chromatin accessibility (DNase) data alone produces a model as descriptive of expression as one using 12 TF ChIP-seq datasets. By using histone modifications and DNase data alone, we explain more variation (up to %70%) in gene expression than other studies that use more complex in silico models of TF binding, which vary from %11% () to %33% (). Several of these models incorporate TFTF interactions and other higher order effects compared with our simpler log-linear regression models. We also find that models combining histone data with TF ChIP-seq data outperform models using TF ChIP-seq data alone. This suggests that the histone modifications perhaps capture an 'expression state', containing information not captured by our 12 TFs. Although using tissue-specific in silico (PWM  H3K4me3) predictions of our 12 TFs alone does achieve a less-accurate fit to RNA-seq expression data than using 12 ChIP-seq TFAS, we find that replacing a single TFAS (E2f1) with ChIP-seq data improves the accuracy of our tissue-specific in silico method to be indistinguishable from using all 12 ChIP-seq TFASs. We hypothesize that this is due to both E2f1 being the most informative of these 12 TFs (see Supplementary Material) for predicting expression, and the majority of its binding being indirect () and thus not directly measurable by sequence-based methods. Replacing Sox2 in silico TFAS data with Sox2 ChIP-seq TFAS data, however, actually decreases the fit of the regression (c). We are unsure of why this is the case, although it may be due to noise in the ChIP-seq dataset for Sox2. Re-analyzing the Sox2 ChIP-seq data with more accurate ChIP-seq peak calling algorithms may shed light on why the in silico Sox2 TFAS appears to give an improvement in fit over the ChIP-seq Sox2 TFAS. A recent article shows that models using this TF ChIP-seq data fit expression more accurately when the ChIP-seq data are re-analyzed with more accurate peak calling algorithms (). Using PCA, we extended the study of the roles of TFs () to also include the roles of histone modifications. The results we obtain, accurately assigning (known) roles to histone modifications, suggests that this method is of value for exploring regulation. Applying this method to the full set of histone modification data from the NIH Roadmap Epigenomics Project () would be of particular interest, especially for the examination of less well-studied histone modifications, due to the availability of data across a broad spectrum of tissues. Some histone modifications, for example, H4K20me3 are known to act combinatorially with other marks such as H3K4me1 (). Similarly, some marks are mutually exclusive with other marks (e.g. H3K27me3 and H3K27ac) (). These marks have also been suggested to potentially play different regulatory roles at different genomic loci (). It has been suggested that the combination of marks around a TSS or enhancer form a 'histone state' (). Using the histone states defined byrather than raw tag counts may prove to be more effective in our linear model at capturing the combinatorial effects of histone modifications.
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
R.C.McLeay et al. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
Genome-wide in silico prediction of gene expression at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
