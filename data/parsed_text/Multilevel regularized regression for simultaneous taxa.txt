Motivation: Identifying disease associated taxa and constructing networks for bacteria interactions are two important tasks usually studied separately. In reality, differentiation of disease associated taxa and correlation among taxa may affect each other. One genus can be differentiated because it is highly correlated with another highly differentiated one. In addition, network structures may vary under different clinical conditions. Permutation tests are commonly used to detect differences between networks in distinct phenotypes, and they are time-consuming. Results: In this manuscript, we propose a multilevel regularized regression method to simultaneously identify taxa and construct networks. We also extend the framework to allow construction of a common network and differentiated network together. An efficient algorithm with dual formulation is developed to deal with the large-scale n (m problem with a large number of taxa (m) and a small number of samples (n) efficiently. The proposed method is regularized with a general L p (p 2 ½0; 2) penalty and models the effects of taxa abundance differentiation and correlation jointly. We demonstrate that it can identify both true and biologically significant genera and network structures. Availability and implementation: Software MLRR in MATLAB is available at
IntroductionMassive 16S rRNA and whole-metagenomic shortgun sequencing data have been generated due to advances in next-generation sequencing technologies. The goals of metagenomic research are to investigate the hostmicrobiota associations and bacteria interactions, and examine how changes in microbiota may affect metabolic functions and human disease. Two crucial research problems, disease associated taxa (genera, operational taxonomic units) selection and correlation network constructions, are usually studied separately. Both filter and model-based approaches have been proposed to detect differences in bacteria composition and relative abundance. Filter-based statistical tests select disease-associatedbacteria features one at a time () and suffer from multiple comparisons problem. Modelbased approaches, on the other hand, identify disease-associated taxa through building a sparse prediction model (), and are efficient for explicitly evaluating the predictive power of multiple taxa. However, these methods mainly focus on differences in abundance without considering the interactions among taxa. Biological and taxa association networks have been constructed with various methods (). Such networks investigate the interactions and causality among group of genes systematically. Metabolic networks have also been proven to be powerful tools for studying the physiological and biochemical characteristics of various functional and evolutionary properties of a cell (). A local Poisson graphical (loglinear) model and a Bayesian generalized graphical model have been proposed recently for constructing association networks based on RNA-seq data (). Among all the methods, various graphical models with L 1 regularization are perhaps the most common approach for graphical structure estimation (;). L 1 regularized approaches are based on neighborhood selection for each variable (gene) i. They build a L 1-based sparse regression model for each x i , with the remaining variables x i  fx j jj 6  ig, and determine the sparse graphical model with the collected regression coefficients. They have also been extended to dependency network construction with sparse Bayesian network structure learning (). L 1-based approaches automatically identify a number of dependent genes and are computationally efficient for large-scale network construction, but these approaches construct the network without considering differentiation of the genes across different clinical conditions. In addition, parameters estimated from L 1 penalized regression are asymptotically biased and L 1 does not always identify the true model consistently (). Therefore, elastic net with aL 1  1  aL 2 (0 a 1), which is equivalent to L p (1 p 2), was proposed for choosing highly correlated genes (), and L p (0 < p < 1) penalized regression was proposed for reducing the biases of estimates (). In this article, we develop sparse multilevel models for simultaneous gene selection and network construction, and simultaneous common and differentiated network construction under different clinical conditions. An efficient algorithm with duality and a general L p (p 2 0; 2) penalty is also developed to deal with the n ( m problem efficiently. We also propose a novel criteria entitled mean parameter difference (MPD) for k and p selection. Our methods will be evaluated with simulated and real metagenomic count data. Since the variance of metagenomic counts depends on the mean count, the data are first transformed to a normal distribution using the arcsin and log-ratio variance-stability methods (). We demonstrate that the proposed approaches successfully identify true and biological important taxa and network structures associated with the disease.
MethodsGiven n samples with phenotype y  y 1 ;. .. ; y n  T , our goal is to identify phenotype associated taxa and simultaneously detect the network structure of those species. We are also interested in detecting network differences associated with distinct clinical conditions. For each sample, we have multiple metagenomic count features including the number of 16S rRNA clones assigned to a specific taxon, or the number of shotgun reads mapped to a specific biological pathway or subsystem. The data structure can be represented as:;where X is the metegenomic count matrix with n samples and m features, x kj denotes the total number of reads of feature j in sample k, and y is a binary vector that indicates clinical conditions. A multiclass y will be encoded with the one-versus-rest or one-versus-one scheme. There are two standard approaches to model metagenomic count data. One is to model the sequencing counts directly with zero-inflated Poisson or negative binomial regression (). However, this approach is computationally intensive especially for high-dimensional data. Building a network of decent size requires hours or even days. In addition, the joint likelihood is hard to estimate, so many likelihood-based variable selection criteria such as cross-validation and AIC cannot be applied. We, therefore, will adapt the computationally more efficient approach by first normalizing data through transformation, and then applying the machine learning or statistical tools. Data transformation has also been proposed for analyzing similar RNAseq count data (). To adjust for the read-depth differences in sequencing, the metagenomic count matrix X is first transformed into a proportion matrix P  p kj , where p kj  x kj = P j x kj and P j p kj  1. To overcome variance heterogeneity with compositional data, the proportion matrix P is then converted into a normally distributed matrix Z  z kj  with the arcsine or logratio transformation. z kj  2arcsin  ffiffiffiffiffiffi p kj p  (). For the log-ratio transformation, there may be zeros in the proportion matrix. Therefore, we first replacewhere p km is the value in the last column of the P matrix (). Usually, the values in the last column are the number of sequences that were not assigned to any known taxon with the RDP classifier (rdp.cme.msu.edu), or the sum of sequencing counts in OTU clusters where the total number of counts is below a given threshold.
Multilevel regularized methodsGiven normalized Z  z kj  nm and binary clinical output y, the task is to identify taxa that are different between clinical conditions, and identify correlation structures among taxa. We propose multilevel neighborhood selection methods that incorporate both Z and y.for i  1;. .. ; m and yz j  y z j is an element-wise multiplication. For each taxon i, Pz i jQ i  is the conditional probabilities given a different set of variables. Assuming Px i jQ i  is a Gaussian distribution, the conditional probabilities in Models (I)(III) can be inferred by different linear regression models, where each z i is a linear combination of Q i .b ij z j  i ; for I;c ij yz j  i for III:Equation (3) is the most general model conditional on the rest of the taxa X i , phenotype y and their interactions. Equation (3) reduces to Equation (2) and Equation (1), and Model (III) becomes Models (II) and (I), respectively, when setting a i  0 or c i  0. In the rest of this article, we will explore algorithms only for Equation (3). The same computational approach can be used for Equations (2) and (1). In Model (3), the parameter a i represents the associations between x i and y; a i 6  0, indicates that taxon z i is differentiated under different clinical conditions (y). The value of b i measures the direct dependency between taxon z i and the remaining taxa, and b ij 6  0 shows there is a correlation between z i and z j given all other variables. In addition, c i determines correlation changes across different clinical conditions, and c ij 6  0 suggests that there is a differentiation in correlation between case and control. Therefore, depending on the problem under study, we can simultaneously identify the differentiated taxa and construct a common and a differentiated network using a i , b ij and c ij , respectively. Because it is common that n ( m in genomic and metagenomic data, learning the local graphical structure is usually based on L 1. More generally L p (p 2)-based regularized regression for each z i to minimize the following error function:This will yield a sparse solution with a small number of nonzero parameters when p 2 0; 2. With the ordinary lasso (p  1), the error function E will be convex. An unique solution can be found for a given k, but the estimation is biased toward zero. On the other hand, the solution will have the attractive oracle property with p < 1. L p regression selects the correct models by producing nearly unbiased estimates for the non-zero parameters while forcing the other parameters to zero. However, the error function E is not convex when p < 1. Even though there are efficient algorithms with L 1 for high-dimensional data, efficient algorithms with general L p penalized regression are less well developed. Based on our previous work for survival analysis (), we propose an expectation maximization (EM)-like algorithm to deal with the high-dimensional problem.
Efficientwhere k > 0 is the penalty term and n ( m. By introducing an auxiliary vector u  u 1 ; u 2 ;. .. ; u 2m1  T , we may rewrite Equation (4) asWith Equation (5), we can estimate the M step by first minimizing Eh (maximizing Eh) by taking the first order derivative and setting it to zero.where indicates element-wise division. SoInstead of finding the high-dimensional (2m  1) primal parameters h directly, we introduce n-dimensional dual variables a  a 1 ; a 2 ;. .. ; a n  T , so we havewhere Q T u  q 1 juj 2p ; q 2 juj 2p ;. .. ; q n juj 2p  2m1n ;Taxa selection and network constructionand a k  1 k z k  q T k h:By substituting the primal variables h  Q T u a into Equation (9), we havewhereK u is a much smaller n  n symmetric matrix and is predetermined as long as u is given. The dual variables a can be calculated in matrix form as follows:The primal variables h can then be updated explicitly with a simple matrix computation.The expectation step is simply u  h. Therefore, we have the EM algorithm for each x i and Q i with the local graphical model:The EM algorithm is highly efficient when n ( m, because it uses the inverse of K u  kI nn matrix instead of the inverse of Q T Q 2m12m1 , as in ordinary regression. Compared with one with dimension of ten-thousands, inverting a matrix with hundreds of dimensions is very fast. As discussed earlier, this algorithm will converge to a global optimum with a p  1, because the error function is convex. A local minimum is guaranteed with p < 1. Computational experiences with L p suggest that it converges to a unique solution for p!0:6, when the error function is nearly convex. To construct a local graphical network, we run the EM-like algorithm m times for each fz i ; Q i g; i  1;. .. ; m. The non-zero h ij s indicate a dependency between taxa i and j. Models for each node can be estimated independently and in parallel using appropriate computational power. Negative correlations between genes are difficult to confirm and seemingly less 'biologically relevant' (). Negative correlation can be introduced when count data are transformed into proportions. For example, transforming two random samples with zero correlation into proportions will lead to a perfect r  1 negative correlation, which does not seem biologically sensible. Our approach can be adapted to study positive dependency only by setting hh < 0  0 in the M-step of EM algorithm.
Determination of k and pBoth k and p determine the sparsity of the model. k 2 10 4 ; k max  max jQ i z i j is partitioned into 100 equal intervals in a log scale, and p is chosen from 0 : 0:1 : 2 in this article for simplicity. The regularization parameter k and p are determined through cross-validation. We build regression models with 100 different ks and 20 different ps, the optimal k and p are then selected with either the minimal mean squared error (MSE) of the test data or the most stable parameter (edge) estimation with k-fold cross-validation. Other criteria such as AIC and BIC can also be used to find the optimal k and p. Although cross-validation with MSE is straightforward, stability selection chooses an optimal k with the minimal mean difference of the estimated parameters. Mathematically, we first estimate k sets of parameters fh i g; i  1;. .. ; k with k-fold cross-validation, and the MPD for given k and p is defined asMPD is similar to the stability selection (StARS) approach which identifies the most stable set of parameters with cross-validation (). Because MSE is known as a loose criteria for L 1 , and MPD is a more conservative measure tending to select less variables, the optimal p chosen with MPD is usually larger than 1, whereas the optimal p with MSE is less than 1. In addition, a node (taxon) will be dropped out when the test MSE is larger than a predetermined threshold.
Results
Simulation dataCount data for simulation are generated with Poisson distributions and known correlation structure (). The count x ij has a Poisson distribution Poiss ij  with mean s ij , and log s ij has normal distribution Nl; R with mean l and covariance R. An adjacency matrix can be measured by A  R 1. We simulated data with two groups, with the number of nodes (variables) of m  200, and sample size n  20, 40 and 60 for each group, respectively. The mean l i (i  0, 1) for each group is l 0  2; 2; 2; 2; 2; 2.. .2 T and l 1  4; 4; 4; 4; 4; 2;. .. ; 2 T , respectively, so the generated data only have the first five features differentiated. Therefore, we have a binary class problem with y  y 1 ;. .. ; y n  T , where y k  0 if sample k 2 group 0 and y k  1 for sample k 2 group 1. Three different network structures were incorporated in the data: (i) a common network structure A, where A is a band matrix with bandwidth 1 and each node only connects to its neighborhood nodes, (ii) a common network structure A, where A is a band matrix with bandwidth 2 and (iii) different network structures with A 0 being an adjacency matrix of bandwidth 1 for class 0, and A 1 being an adjacency matrix of bandwidth 2 for class 1. After we generated the count matrix X with known network structure A and class information y, Equation (1) was used to detect differentiated features and the common network structure simultaneously with the first two datasets. We simulated these data 100 times. The generated count data were then transformed with proportion and arcsin transformations. The log-ratio transformation yields similar performance, so only results with proportion and arcsin transformations are reported in this article. Five-fold cross-validation was used to determine the
EM-like AlgorithmGiven a k; p 2 0; 2, small numbers e and e, and training data fz; Qg, Initializing h  rand2m  1; 1,optimal parameters k and p. The area under ROC curves (AUC) was used to evaluate the performance of detecting proposed network structures, where the sensitivity for a network is the proportion of edges that are correctly identified, whereas the specificity for a network measures the proportion of no-edges that are correctly detected. The ROC curve and AUC were then calculated accordingly. Moreover, the performance of feature selection is defined as the number of times that the first five features are correctly identified. AUC for validating the network structures and the number of times that the first five true features are selected are reported in Tables 1 and 2, respectively. Our methods identified the true differentiated features and network structures as shown in Tables 1 and 2. Overall, the predicted AUCs become larger when the sample size increases. In addition, minimizing MPD performs better than minimizing test MSE. Compared with the average AUCs of 0.83, 0.94 and 0.97 with MSE for band 1 network, the corresponding AUCs with MPD are 0.89, 0.97 and 0.99 for n  20, 40 and 60, respectively. Similar results were achieved for band 2 network with different sample sizes and optimal parameters. With n  20, 40 and 60, respectively, out of 100 simulations for band 1 network, more than 40, 46 and 70 times of five differentiated features were appropriately identified with MSE, whereas more than 70, 91 and 92 times of the five features were correctly selected with MPD. MSE identified at least 30, 48 and 78 times of five differentiated features correctly for band 2 network, whereas MPD accurately selected the five features at least 82, 91 and 95 times, indicating that MPD is more accurate. The accuracy of feature identification increases with sample size. Five features were identified correctly over 92 and 95 times with MPD and the sample size of 60 for band 1 and 2 networks, respectively, whereas the average false-positive rates (AFPR) were all under 5%.The comparison between our approach and Student's t-test with the same data is reported in Supplementary Appendix S1. Student's ttest leads to high FPRs and fails to identify the true features even with the conservative Bonferroni correction. Feature selection with network correction is important, and the proposed approach provides an efficient way to accomplish it. Differentiated features, and common and differentiated network structures can also be identified simultaneously with Equation (3). Simulated data were generated with the Poisson distribution with known means and network structures. Data for class 0 is again generated with mean l 0 and a band 1 network and for class 1 is generated with l 1 and a band 2 network, respectively. So the class output y is defined similarly as the previous simulations, and the common network to detect is the band 1 network the differentiated network to identify is the differential structure between band 1 and 2 networks. Equation (3) is used to evaluate the performance. Predictive performance of proposed method is shown in: Differentiated features, and the structures of common and differentiated networks were detected with high accuracy. Because MSE usually has the best performance when p < 1, and MPD has the best performance when p > 1, we define a new integrated performance measure that chooses the optimal k  k MSE  k MPD =2 in roman> for variable selection. AUC for differentiated features (bottom panel) can be identified perfectly (AUC  1) with a larger sample size (n  40) for each group. The common network structure (top panel of) can be detected with over 0.91 AUC, while distinguishing the differentiated structure is more difficult with the test AUC of over 0.74. In addition, AUCs increase as the sample size becomes larger. Finally, the performances with L 1 and L p p  11 penalties are quite similar with the integrated measure, indicating that it is possible to achieve a good performance with L 1 regularized regression with an appropriate measure.
Benchmark metagenomic dataA metagenomic dataset was generated from research findings in our own group (). A recent analysis of microbial co-occurrence in the HMP cohort revealed significant relationships across many body compartments, including 3005 edges and 67 edges among microbiota of all body sites and the gut (fecal compartment), respectively. The differences (if any) may be due to healthy only subjects, different cohorts and fecal (versus mucosal wash compartments). There are in total 299 samples with 76 inflammatory bowel disease (IBD) subjects including Crohn's disease (CD) and ulcerative colitis (UC), and 223 non-IBD subjects. Out of 299 samples, 285 (72 IBDs and 213 controls) have metagenomic count data available. There were a total of 5648 OTUs available. We merged OTUs at the genus level. Then genera with high abundances were selected for further study after discarding those genera with less than five reads on average. Data were then normalized with the proportion and arcsin transformation. The class y is a binary vector with y k  0 for nonIBD, and y k  1 for IBD samples or vice versa. The input Z is the normalized taxa matrix. To identify differentiated genera and positive correlations in whole, IBD and non-IBD populations, we run the program for Equation (3) two times with 0/1 values flipped. Five-fold cross-validation and MPD were used to find optimal k  ; p  . Our program (mlrr) identified the optimal parameter pair k  ; p   and determined the best model automatically. Genes with higher abundance in IBD and non-IBD are reported in. Eight identified genera have higher abundance in IBD, whereas 20 have higher abundance in non-IBD, indicating less bacterial diversity in IBD patients. Common and differentiated networks are shown inNotes: Only the first five features are truly differentiated.
Taxa selection and network constructionFigures 2 and 3, respectively. Several important findings are demonstrated with, Figures 2 and 3 together. Genera Klebsiella has higher abundance in IBD with the largest estimated parameter (0.0626). It also has the highest degrees of 13 and 7 in common and control network, respectively. Klebsiella is probably harmful, because it loses its connections (co-occurrences) with other genera and has higher abundance in IBD. Disease status is determined by both the relative abundance of Klebsiella and its co-occurrence patterns with other genera. In fact, Klebsiella is a well-studied IBD-associated bacteria. It is a likely triggering factor associated with the initiation and development of IBD (). On the other hand, genera Faecalibacterium has higher abundance in non-IBD (lower abundance in IBD) with the largest parameter 0.0319. It also has the largest degree of 13 in the common network, and is connected to Ruminococcus in the IBD network. This may indicate that Faecalibacterium is a protective genera and its lack may contribute to IBD. The fact that Ruminococcus and Faecalibacterium link to each other and both have lower abundance in IBD suggests that the co-abundance of Ruminococcus and Faecalibacterium may be useful for IBD diagnosis. The association between Faecalibacterium and IBD has been an active topic of research recently in the literature (). Investigators have shown that Faecalibacterium is relevant to the etiology and pathogenesis of IBD both in clinical and laboratory investigations. However, the role of Ruminococcus and its co-abundance with Faecalibacterium in IBD has not beenNotes: The estimated parameters are reported in columns 2 and 4, respectively. The larger the parameter value, the more differentiated the genera. well studied. Another genera Haemophilus may also be important for IBD. It has the degree of 9 and 4 in common and non-IBD network, respectively, and has higher abundance in non-IBD. It loses its co-abundance with several other genera in IBD. The other genera such as Fusobacterium, Bacteroides, Veillonella, Lactobacillus and Escherichia with high abundance in IBD may be potential gut pathogens and associated with IBD. On the other hand, the 20 identified genera with higher abundance in non-IBD may be protective bacteria that are negatively associated with IBD. Moreover, genera such as Bifidobacterium could be an important target for IBD, even if its relative abundance does not vary between case and control. Bifidobacterium has interactions with other genera in both common and non-IBD networks, but does not have any connections in the IBD network. The variation in co-occurrence networks may have biological and clinical implications. Finally, less bacteria diversity and interactions in IBD have been observed as shown in the genera list and IBD network. Therefore, it is important to study variations of relative abundance, and common (background) and differentiated networks systematically. Our approach can identify IBD associated bacteria and provide potential targets for further investigations.
ConclusionsWe proposed a multilevel penalized regression method for simultaneous genera selection and network construction. We also developedTaxa selection and network constructionan efficient EM-like algorithm with dual-formulation for solving a general L p , p 2 0; 2 regularized problem. The proposed algorithm includes L 1 and elastic net kL 1  1  kL 2 penalties as special cases, and efficiently deals with high-dimensional n ( m problem. The elastic net penalty is equivalent to a L p with p 2 1; 2. We compared the performance of the proposed method with different p values. Different optimal ps can be selected from different performance measures. A p < 1 usually has the best performance with a loose MSE measure, while a p > 1 will lead to the best performance with a more conservative MPD criteria. LASSO achieves the best performance with the average of optimal ks from test MSE and MPD. We tested our method with simulated and real rRNA 16S sequencing data. Comparing with available methods for network construction and feature selection in the literature, the proposed approach identifies true features and biologically important genera, and constructs common and differentiated networks jointly with high accuracy. It provides a novel tool for studying correlation and differentiation together, and is computational efficient for high-dimensional metagenomic data. Recent work has greatly expanded the cohort size coanalyzed for microbial community structure in new-onset IBD (PMID: 24629344). The present methodology offers a new perspective on disease association and community structure that would be particularly valuable in tackling such extensive datasets. The proposed approach can also be applied to most RNA-seq data directly provided they are normalized.
FundingThis work was partially supported by grants from National Science Foundation
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
Z.Liu et al. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
