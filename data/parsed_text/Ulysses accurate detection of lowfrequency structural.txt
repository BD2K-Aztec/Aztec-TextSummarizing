Motivation: The detection of structural variations (SVs) in short-range Paired-End (PE) libraries remains challenging because SV breakpoints can involve large dispersed repeated sequences, or carry inherent complexity, hardly resolvable with classical PE sequencing data. In contrast, large insert-size sequencing libraries (Mate-Pair libraries) provide higher physical coverage of the gen-ome and give access to repeat-containing regions. They can thus theoretically overcome previous limitations as they are becoming routinely accessible. Nevertheless, broad insert size distributions and high rates of chimerical sequences are usually associated to this type of libraries, which makes the accurate annotation of SV challenging. Results: Here, we present Ulysses, a tool that achieves drastically higher detection accuracy than existing tools, both on simulated and real mate-pair sequencing datasets from the 1000 Human Genome project. Ulysses achieves high specificity over the complete spectrum of variants by assessing , in a principled manner, the statistical significance of each possible variant (duplications, deletions, translocations, insertions and inversions) against an explicit model for the generation of experimental noise. This statistical model proves particularly useful for the detection of low frequency variants. SV detection performed on a large insert Mate-Pair library from a breast cancer sample revealed a high level of somatic duplications in the tumor and, to a lesser extent, in the blood sample as well. Altogether, these results show that Ulysses is a valuable tool for the characterization of somatic mosaicism in human tissues and in cancer genomes. Availability and implementation: Ulysses is available at
IntroductionOur current understanding of the structural and functional impact of SV onto the biology of genomes has largely benefited from the development of the second generation of DNA sequencing technologies. The computational detection of SV has mainly relied on the development of four methodological strategies, the 'read-depth' method (), the 'split-read' method (), the de novo genome assembly () and the 'Paired-End' method. Some detection tools have increased SV detection specificity and breakpoint resolution by combining several of these detection strategies (). Computational analyses using these approaches demonstrated that large SV are major contributors to the genomic polymorphism between individuals (). Polymorphic SV were shown to contribute to both common diseases and rare genomic disorders and to alter normal gene function during cancer development (). New approaches have also started to reveal the quantitative importance of somatic SV in healthy tissues such as neuron or blood cells (). However, the true level of somatic mosaicism probably remains underestimated, owing to the limitations inherent in classical shortrange PE libraries. More SV are now theoretically accessible thanks to the recent development of long-range Mate Pair (MP) libraries in which the two reads can be separated by several kilobases. MP libraries present major advantages over classical PE libraries because large inserts can span over large repeated regions often involved in SV formation and because MP libraries provide, for the same number of reads, a much higher physical coverage of the genome. Higher physical coverage triggers the possibility of uncovering SV that are present at low frequency in mosaic genomes. However, MP libraries involve a ligation step during the library construction which generates a large amount of chimerical Read Pairs (RPs), making those library prone to higher rates of false-positive SV. In addition, MP libraries suffer from wide insert size (IS) distributions, which bring additional noise to the detection of deletion and insertion events. These limitations explain why currently available SV detection tools that were developed for short-range PE libraries perform badly on MP data. Here, we report a new PEM-based software, called Ulysses, specifically designed to detect SV in MP datasets. Ulysses comprises a SV scoring module, which improves SV detection accuracy in MP libraries. Our algorithm can annotate the full spectrum of SV, including deletions (DEL), segmental duplications (DUP), inversions (INV), small insertions (sINS, with a size smaller than the library IS), large insertions (INS), reciprocal translocations (RTs) and non-reciprocal translocations (NRT). Benchmarks on real MP sequencing datasets from the 1000 Human Genome project, on MP simulated datasets as well as on a breast cancer tumor MP library showed that Ulysses outperforms three commonly used detection tools), GASVpro () and Delly (for all types of SV and notably for low frequency structural variants in MP libraries. In addition, Ulysses is on par with or outperforms the three other tools on PE datasets, making it a highly versatile detection tool.
Methods
Overview of UlyssesUlysses is a PEM-based algorithm, which comprises two independent parts: library parsing (Steps 12) and SV detection (Steps 35,). The algorithm automatically tunes parameters for SV detection from the set of statistical properties derived from the library parsing. Then, Ulysses builds simple undirected graphs describing groups of discordant RP that consistently support the existence of the same structural variation (SV). The problem of using cliques to predict SV has already been exactly solved and largely implemented in the past few years (). Cliques are defined in Ulysses in a way closer to (). However, because a parameter ensures that all IS within a clique are in a comparable size range (ISc n , see below), Ulysses adds new constraints on cliques. Note that our clustering rules only reflect our implementation rather than an exact solution to the problem of cliques identification. Finally, Ulysses assesses the statistical significance of each candidate variant in a principled manner using for each type of SV an explicit model for the generation of chimerical RP (). The five main steps are detailed below and further details can be found in the Supplementary Material.
Step 1Statistics of the library and detection parametersStarting from a library alignment file (BAM format), Ulysses derives summary statistics [read-pair orientation, empirical IS distribution (f l ), IS median (l) and median absolute deviation (r)] from 1 million of randomly sampled RP. The median and median absolute deviation estimates were preferred over mean and standard deviation as they are more robust to outliers. These values are used to set SV detection parameters described below (d n , ISc n , p dn=' k s and p IS ,). Two descriptors, d and ISc, are defined to assess whether two RP are consistent (). Given two RP of size IS 1 and IS 2 , spanning the genomic intervals l 1 ; r 1  and l 2 ; r 2 , respectively, we consider: their maximal interdistance: d  max jl 1  l 2 j; jr 1  r 2 j,  their IS difference: ISc  jIS 1  IS 2 j. Two RP are consistent if they satisfy d l  nr and ISc nr (note that ISc only applies to intra-chromosomal RP). For further reference, we will name those thresholds d n and ISc n (see Section 2.5). In addition, two probabilities, p dn=' k s and p IS , are defined to assess the statistical significance of groups of consistent RP (): p dn=' k s the probability that s RP have consistent positions in a chromosome of length ' k , p IS s the probability that s RP have consistent IS. Details about the computation of both probabilities are given in Supplementary Material. 2.1.2 Step 2Selection of discordant RP To define SV, Ulysses relies on the identification of discordant RP (with mapping quality !20), i.e. RP that map incongruously onto the reference genome (). RP are considered as discordant when they fulfill at least one of the three following criteria: Incongruous RP orientation: any RP not in aorientation (throughout the text, read orientations are given for MP and must be reversed for PE libraries). IS deviating from the expected range: any RP with an IS outside the range l  nr; l  nr. Incongruous read location: any RP with the two reads on two different chromosomes.At the end of the library parsing part (Steps 1 and 2), a set of alignment files containing all identified discordant RP is produced (). The following SV detection part (Steps 35) is independent and can be run separately.
Step 3Calculation of SV coverage minimal thresholdThe minimal number s of consistent RP that is required to support each type of SV is set in order to limit the expected number of candidate SV (N SV ). This is especially justified when libraries have a wide distribution of ISs and/or a high number of chimerical reads that will generate a high number of false positives (FPs) (as it is often the case with MP libraries). For each type of SV, if p SV is the probability that x discordant RP are consistent, the number of expected candidate SV supported by x RP is N SV  D RP x  p SV with D RP being the total number ofNote that p SV can be directly expressed as a product between p dn ='k s) and p IS s) because the same value of n is used for both d n and ISc n and therefore there are only two degrees of freedom to fully define the three parameters jl1  l2j; jr1  r2j and jIS1  IS2jUlyssesdiscordant RP of this type. The probability p SV depends on the topology of the SV and can be explicitly formalized using the probabilities p dn=' k s and p IS s defined above (). In practice, N SV is limited to be at most 10 000. The value of s (default s  2) is automatically increased while N SV is above this limit.
Step 4SV detectionDiscordant RP are categorized into one of the seven SV types reported in. RP are then sorted by chromosomes and coordinates, and used to build a simple undirected graph. Each discordant RP represents one vertex of the graph and one edge is drawn between each pair of consistent RP. Ulysses defines a SV as a maximal clique in the graph where all consistent RP are connected to each others. Note that the same vertex can belong to two or more different maximal cliques (meaning that a given RP can be used to define different SV). DEL, sINS and DUP are SV that produce a single new DNA junction in the rearranged chromosome when compared with the reference genome. For those single-junction SV, we directly use the corresponding maximal cliques to identify candidates SV. Each INV, INS or RT produces two new DNA junctions when compared with the reference genome. These two-junction SV are consequently detected by two maximal cliques, which, in Ulysses, need to be interconnected (by RP orientation and relative coordinates,and Supplementary Material). This requirement increases the specificity of the detection in comparison with methods that consider only one junction, even for the detection of two-junction SV. All combinations of compatible pairs of cliques are conserved, thus allowing the same RP to be re-used in several different pairs. In addition, when the position of the centromeres is provided, the relative orientation of the two cliques is checked and an RT event will be reported only when both of the rearranged molecules contain a single centromere. Otherwise, the corresponding SV is classified as an INS. For both INS and RT, the number of RP must be equally distributed between the two cliques (ratio > 0.1). Otherwise, the corresponding SV is classified as a NRT.
Step5SV scoring and selection of statistically significant SV Ulysses evaluates whether the number m of RP that supports each candidate variation is significant. This step is essential to filter out false-positive predictions from the artefacts in the library. The significance level of each candidate is then corrected by controlling the false-discovery rate (FDR). Deletions and small insertions: The statistical significance of each candidate deletion is estimated by calculating the probability b m to randomly sample at least m RP identifying this deletion, given the local physical coverage C. Given the smallest RP describing the deletion with an IS s, each RP drawn from the IS distribution has a probability prop IS to be consistent with the smallest RP (prop IS  P l!s f l , see Supplementary Material). The probability b m will result from the binomial sampling of the RP:In practice, C is estimated over the region corresponding to the DEL position (considering at most the 10 first kilobases of the deleted region). The significance of small insertions can be evaluated in the same manner, by flipping around the IS distribution. Segmental duplications, non-reciprocal translocations and twojunction SV: For those SV, the statistical significance is computed with a binomial distribution as being the probability m that at least m RP among all combinations of discordant RP of each type are consistent, given the probability p SV (see):where C m  D RP m is the number of ways of having m RP among a total of D RP discordant ones on the SV considered (see Step 3 and). m is calculated for each chromosome independently (or each pair of chromosomes for inter-chromosomal rearrangements). After SV scoring, we set up a P-value cut-off by controlling the FDR (default value 0.01). Q-values are estimated using a bootstrap method (). During our tests with experimental and simulated data, this approach greatly improved the specificity of the detection (see Section 3).
Sequencing datasetsThe details and the accession numbers for all real sequencing datasets used in this study (NA12878 and breast cancer BT71) are provided in Supplementary Methods. For simulated sequencing datasets, a MP (l  2000 bp; r  1487 bp, normal distribution, read-length  50 bp) and a PE (l  233 bp; r  10 bp, normal distribution, read-length  50 bp) Illumina-like datasets were generated with wgsim 0.3.1r13 () with default parameters using a 162 Mb human genomic region as a reference (GRCh37/hg19 chromosomes 20, 21 and 22) at three different levels of coverage (10, 30 and 60). The MP dataset was generated with variable proportions of random chimerical RP (0.1%, 1%, 2.5% and 5%) in order to sample different levels of experimental artefacts that can derive from the circularization step during MP library construction. Chimerical RP were generated by randomly sampling the RP and by shuffling the mates. As a consequence, chimerical RP can have any orientations and be either intra or inter-chromosomal. The simulated reads were remapped on the reference genome using BWA aln 0.7.3ar367 with default parameters (). Artificial SV were then added to both PE and MP simulated library datasets after the remapping step in order to avoid mapping artefacts that could bias SV detection. Artificial SV were designed with variable numbers of discordant RP (with 4 and 8 RP in the 10 dataset; with 4, 8, 16 and 32 RP in the 30 dataset and with 4, 8, 16, 32 and 64 RP in the 60 dataset). These numbers correspond to a relative coverage varying from 0.06 (4 RP in the 60 library dataset: 4/(60  4)  0.06) up to 0.52 (64 RP in 60 dataset: 64/(60  64)  0.52). Each set of artificial SV comprises 50 SV of each type (DUP, DEL, INV, INS, RT and NRT) for each relative coverage, generating a total of 600, 1200 and 1500 SV for 10, 30 and 60 datasets, respectively. DUP, DEL and INV were generated with random sizes, varying from 1 to 50 kb. The detection of one SV was considered as true positive (TP) when at least one of the RP that defined the simulated SV was recovered. All simulated datasets are available at http://www.lcqb.upmc.fr/ ulysses/simulations.
Benchmark with other detection toolsAll benchmarks analyses were performed using the AMADEA Biopack platform developed by ISoft (http://www.isoft.fr/bio/biopack_en.htm). Breakdancer v1.2.6 (), GASVproHQ v1.2 () (referred to as GASVpro) and Delly v0.5.6 () were configured to detect SV defined by at least two consistent RP (which is the lowest limit to define a clique). All other parameters remained set by default. The sensitivity (Sn) of a detection tool is the proportion of true SV that are detected (/[TPs  false negatives]) and its precision (or positive predictive value, PPV) is the proportion of true SV among all detected SV (/). The F1-score is an estimator of the trade-off between Sn and PPV (2  Sn  PPV/(Sn  PPV)). Supplementary Tables S1, S2 and S3 report Sn, PPV, F1-scores and running times of Ulysses, Delly, Breakdancer and GASVpro on all simulated datasets. Note that GASVpro cannot perform SV detection for MP datasets (both simulated and experimental). The execution of GASVpro on these data was stopped after more than 166 h of computation on a single CPU after splitting the sequence files by chromosomes (core i7 870, 32GB RAM). As a consequence, GASVpro does not appear in any of the MP analyses.
Ulysses detection parameter nThe performance of Ulysses was tested as a function of the n value, which controls the main detection parameters for all types of SV (the interdistance d n and IS difference ISc n , see Section 3). For both MP and PE simulated datasets, F1-scores remain highly stable for n values ranging from 3 to 10 (Supplementary). For real sequencing dataset (NA12878 MP 30), a n value set to 6 provides a good compromise between Sn and PPV (Supplementary). This value of n  6, set by default in the parameter file, is therefore well suited for most applications and does not require any manual adjustment by the user.
Results
Performance of Ulysses on MP sequencing datasetsThe performance of Ulysses was compared with three other widely used SV detection tools: Breakdancer, GASVpro and Delly. Given that BreakDancer and Delly do not discriminate between INS, RT and NRT, these three types of SV were merged into a single class of events called inter-chromosomal (INTER) for analysis. The performance of each method was estimated with PPV, representing the total number of TPs divided by the total number of detected SV.
Performance on real sequencing data from the 1000 Human Genome ProjectThe three tools were benchmarked on a real MP sequencing dataset (30 coverage) coming from a single individual (NA12878, see Section 2). We focused on DEL detection because a robust GS containing 2209 DEL was available (see Section 2). Results are presented only for Ulysses, Delly and BreakDancer (SV detection could not finish in reasonable time with GASVpro on MP datasets, even with sequences split by chromosome, see Section 2). The results on) is very close to that of BreakDancer (197 TP) and higher than that of Delly (48 TP). As a result, the scoring method strongly increases Ulysses PPV from 0.76% to 45% (a 59-fold increase), which explains the massive gain in specificity of Ulysses over the other tools (, Supplementary). We have checked that the higher detection accuracy of Ulysses did not result from a biased distribution of DEL sizes in the GS that could have favoured Ulysses over the other tools. The median deletion size of DEL from the GS is 4.9 kb, whereas the median deletion sizes of DEL detected by Ulysses, Delly and Breakdancer are of 13.2, 21.5 and 5.5 kb, respectively. Thus, Ulysses and Delly do not detect small DEL from the GS. BreakDancer is able to predict such small DEL at the cost of precision, with the concomitant detection of about 21 000 FPs. In order to further characterize Ulysses higher detection accuracy, we plotted the relative precision (proportion of TP DEL or PPV) and the FDR (proportion of FP DEL) of the three tools as a function of DEL physical coverage (). This plot shows that Ulysses precision remains relatively constant (between 0.24 and 0.57) over the whole range of coverages whereas BreakDancer precision increases with increasing coverage (from 0.0024 to 0.54). Delly achieves correct precision only for intermediate coverage values. Compared with the other tools, Ulysses precision is particularly higher for the lowest physical coverage values (between 1 and 20 RP). These results show that Ulysses is particularly efficient for the detection of low frequency SV.
Detection of somatic mosaicism in tumour sampleWe used 8 kb MP data from a luminal A breast tumor to analyse the somatic mosaicism present in cancer cells (data taken from). In this paper, the authors suggest that tandem duplications appear to be early events in tumour evolution, especially in the genesis of amplicons. We performed the differential detection of tandem DUP in the blood and the tumour samples with Ulysses and Delly (Supplementary). Nearly all DUP detected in the blood sample with allele frequencies higher than 0.2 were also found in the tumour, as expected for germline SV. Note that Uysses detected 49 germline DUP whereas Delly only found 5 such DUP. We found nearly no evidence of high allele frequency (AF >0.2) somatic DUP in the blood sample whereas in the tumor sample, we detected a significant number of somatic DUP that probably occur early during tumour development as suggested by their AF higher than 0.2 (28 with Ulysses versus 3 with Delly, Supplementaryand B, respectively). The highest level of somatic mosaicism was found by Ulysses as low frequency DUP (AF <0.2) in the tumour sample. Ulysses detected 4551 low frequency DUP whereas Delly found only 256 such DUP (Supplementaryand B, respectively). In this analysis, somatic mosaicism was also detected in the blood sample, as already reported (), but to a lesser extent than in the tumour sample (Supplementary).
Performance on simulated SVA MP sequencing dataset with wide IS distributions (l  2 kb; r  1487 bp) was simulated at different sequencing coverage values (10, 30 and 60, see Section 2), using three human chromosomes as reference. Fifty simulated SV of each type (DUP, DEL, INV, INS, RT and NRT) were added to the libraries at relative physical coverages varying from 0.06 up to 0.52. Intrachromosomal SVs (DUP, DEL and INV) were generated with random sizes, varying from 1 kb to 50 kb. Note that simulated SV represent the TP SV in this dataset. In addition, variable proportions of random chimerical RP (from 0.1% to 5% of the reads) were added to the library in order to simulate the typical experimental noise that derives from the circularization step during MP library construction.
UlyssesNo major difference was found across the range of sequencing coverage values. Therefore, the results, presented on, only focus on the 60 coverage dataset (see Supplementary Figs. S5S9 and Supplementary Tables S2 for 10 and 30 results). We first assessed the performance of the three algorithms across variable SV physical coverage values (). For SV present at high relative coverage (0.52, corresponding to a heterozygous SV in a diploid cell), all three algorithms perform globally well, with similar accuracy as estimated by the F1-scores. However, as soon as the SV relative coverage decreases, the performance of Delly and BreakDancer rapidly deteriorates (). At the lowest SV relative coverage (0.06), Ulysses retains a detection accuracy of 71% whereas Delly and BreakDancer drop down to 11% and 2%, respectively. We found that detection accuracy of Delly and BreakDancer deteriorates because of high over-prediction of FP SV (see ROC curves in Supplementary Figs. S5S9). These results show that Ulysses is the only algorithm able to detect low frequency SV (i.e. physical coverage between 0.06 and 0.34) with high accuracy. Next, we compared the three tools for each type of SV, across all physical coverage values. Again, for the highest relative coverage (0.52), all tools achieve comparable accuracies on all types of SV (Supplementary). For all SV types, the performance of Ulysses compared with the other tools gradually improves with decreasing relative coverage. For the lowest relative coverage value, Ulysses outperforms both Delly and BreakDancer for all types of SV (left panel). Because MP libraries often comprise high proportions of chimerical RP, we also tested whether the conclusions drawn here for a dataset containing 1% of chimerical RP also apply to datasets with other levels of chimeras (between 0.1% and 5%). Again, for the lowest SV coverage value (0.06), Ulysses shows the highest F1-scores over the entire range of chimera (right panel). For relative coverage values from 0.12 to 0.34, the difference between the tools gradually reduces and totally vanishes for the highest coverage (0.52, Supplementary).
Performance on PE librariesWe also tested Ulysses performance on classical PE libraries, with smaller ISs, and compared it with Delly, BreakDancer and GASVpro. For real sequencing dataset (NA12878), Ulysses and BreakDancer achieve the best detection accuracies at low coverage (5). For a high coverage 200 dataset, Ulysses clearly outperforms all tools (Supplementary). Noticeably, GASVpro, which also includes a SV scoring and filtering module, performs verypoorly on low coverage data but reached the second best PPV on the high coverage data. For simulated dataset, RP were generated with characteristics similar to those described above for MP data (in terms of sequencing coverage, SV type and physical coverage, see Section 2). Both Ulysses and BreakDancer behave well at all SV relative coverages and across all types of SV whereas Delly and GASVpro show lower F1-scores for low frequency DEL (Supplementary).
DiscussionUlysses uses a PEM approach that relies on the identification of groups of discordant RP to detect the full spectrum of SV. This strategy, also implemented in the three other detection tools tested here, is highly sensitive but usually lacks specificity when used alone on MP data with wide IS distribution and high proportion of chimerical RP. To overcome these limitations, we developed in Ulysses a scoring module that statistically assesses the genuineness of all candidates SV, given an explicit model for the generation of chimerical RP. To deal with wide IS distribution, Ulysses evaluates IS consistency between RP and filters out groups of RP with inconsistent IS. To deal with high proportions of chimerical RP (up to 5%), Ulysses uses statistics based on the relative coverage of candidate SV. These two parameters automatically adjust to the characteristics of the library such that no manual tuning is required to achieve detection with good accuracy across all types of SV. As a result, Ulysses is the only tool that performs equally well on MP and PE data. On a real MP sequencing dataset from the 1000 Human Genome Project (NA12878, 30), Ulysses achieves a better sensitivity than the other tools and by several orders of magnitude the best precision. Ulysses also achieves the highest detection accuracy on PE datasets, showing that globally, Ulysses outperforms the other tools no matter the type of sequencing library. Ulysses scoring module brings a major benefit by enabling accurate detection of low coverage variants. Low coverage SV can correspond to rearrangements occurring in genomic regions which are difficult to sequence and where the local coverage could dramatically drop (some regions were shown to be consistently prone to low coverage). Alternatively, low coverage SV could also result from rearrangements only present in a small subset of the cell population. This is of particular interest when analyzing samples that contain polymorphic somatic mutations such as cancer samples. The analysis of somatic mosaicism in a breast tumour sample revealed that Ulysses achieves an efficient detection of both germline and somatic DUP. We also showed that Ulysses is able to detect somatic mosaicism in a blood sample. Furthermore, recent insights onto somatic mosaicism showed that subclonal cell heterogeneity is not restricted to cancer cells and could be common between cells from a single tissue sample. Given such an unsuspected level of somatic genome plasticity, the availability of a SV detection tool like Ulysses, with high accuracy for rare SV is of primary importance.
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
A.Gillet-Markowska et al. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
