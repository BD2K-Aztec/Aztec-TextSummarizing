Motivation: Knowing the exact locations of multiple change points in genomic sequences serves several biological needs, for instance when data represent aCGH profiles and it is of interest to identify possibly damaged genes involved in cancer and other diseases. Only a few of the currently available methods deal explicitly with estimation of the number and location of change points, and moreover these methods may be somewhat vulnerable to deviations of model assumptions usually employed. Results: We present a computationally efficient method to obtain estimates of the number and location of the change points. The method is based on a simple transformation of data and it provides results quite robust to model misspecifications. The efficiency of the method guarantees moderate computational times regardless of the series length and the number of change points. Availability: The methods described in this article are implemented in the new R package cumSeg available from the Comprehensive R Archive Network at http://CRAN.R-project.org/package=cumSeg.
INTRODUCTIONStatistical analysis in biological research is often faced with outcomes expressed by specific measurements for the gene expression levels. When these observed responses are ordered by their location on the genome, the values form clouds with different observed means, supposedly reflecting different mean levels. By exploiting differences in the observed responses, the statistical analysis of these sequences aims at identifying chromosomal regions with 'abnormal' (increased or decreased) mean levels; changes in the mean level at a particular genome location may be interesting for certain goals, such as assessing the status not only of specific loci (like tumor suppressors and oncogenes) but also any structural genomic alteration, resulting in genomic imbalances, involved in pathogenesis or in various observed abnormal phenotypes. For instance, detecting chromosomal aberrations is crucial for the diagnosis of some diseases, including mental retardation and cancer (e.g.; * To whom correspondence should be addressed.) often associated to aneuploidies, deletions, duplications and/or amplifications. In this respect, the output of the array comparative genomic hybridization (aCGH) experiment is a fluorescence color ratio understood to represent the DNA copy numbers of the actual tumor cells plus noise generated by the normal cells and by the experiment; aCGH analysis aims at finding abrupt changes in the mean of the fluorescence color ratios (or usually their logarithms) to detect chromosomal aberrations. The analysis of aCGH data concerns one of the most important applications involving change point detection, but more generally the analysis of genomic sequences to detect abrupt changes is an important step in several areas of the biological research: recombination of viruses (), characterization of complete transcriptomes via high-density DNA tiling microarrays () or investigation of DNA sequences in general, see Karkin and, for a wider discussion. Several authors have addressed the problem using different approaches within a likelihood-based or Bayesian paradigms. Algorithms based on segmentation techniques include works by,; hidden Markov models have been presented in. When mean levels are of main interest, rather than the change points, Bayesian approaches have been discussed in. Although comprehensive reviews and comparisons of some of the aforementioned methods are given byand Willenbrock and, the focus of the aforementioned procedures is into 'calling gains and losses', namely classification into damaged and non-damaged genes. In general, little emphasis is given to the problem of estimating number and locations of the change points, especially when the stochastic terms are not simple Gaussian independent identically distributed (iid). Typical statistical analyses assume iid Gaussian noise, but there is no guarantee that this is always true. In this article, we present a new approach to detect and estimate change points in genomic sequences. While associated mean levels can be obtained, we are specifically interested in the change points. The main goal is to provide a procedure which works adequately well in different and real scenarios where the true error structure is usually unknown. The method is conceptually simple and it appears to be quite robust to departures from standard model assumptions, such as autocorrelation, non-normality and heteroscedasticity. Moreover,Page: 162 161166
V.M.R.Muggeo and G.Adelfioit can be straightforwardly generalized to include interprobe distance, quality of measurements and multivariate and binary responses. The article is organized as follows. Section 2 describes the model estimation and selection, while Section 3 presents results from a simulation study aimed at comparing the proposed approach with respect to its competitors in selecting the right number of change points. Section 4 reports analyses of two historical datasets, and finally Section 5 is devoted to discussion and future work.
METHODS
The piecewise constant modelLet {(x i ,y i )} n i be the observed data: y i is the outcome, e.g. the log fluorescence ratio, and x i represents the genome location for i = 1,2,...,n genes/clones. As usual in statistical modeling, we assume the datum is the sum of the signal and noise, i.e. y i =  i + i. To deal with possible change points in the sequence, we further assume the signal  i is approximated by a piecewise constant (or mean-shift) regression function with K 0 +1 segments,where i is noise which, depending on its 'strength', distorts the signal  i and complicates change point detection. In Equation (1), I() is the indicator function being equal to one when its argument is true, and the s represent the K 0 change points on the genome, (e.g. the locations of the changes),in our framework we only need that the noise is zero mean, E=0; no assumption on the error density or its higher moments is requested. Notice although in model (1) we have used the simple index variable i = 1,2,...,n denoting the genome index, any continuous variable may be employed. In fact, this restriction is not essential in our framework (see Section 5), but we will assume x i = i throughout the article for the sake of simplicity. The basic statistical problem with model (1) consists in identification of the number of change points (K 0 ). Estimation of their locations (the  k s) and the mean levels assumed in between (the regression coefficients  1 and ) may also be of interest, but we do not deal specifically with them in the present article.
Model estimation: preliminaryWe first discuss estimation assuming fixed and known number of change points, K 0. Taking the cumulative sums of both side of Equation (1) yieldswhere for each k and i,Model (2) has the same parameters of Equation (1), but different responses, covariates and errors. More importantly, Equation (2) underlies a different relationship: unlike (1), it assumes a piecewise linear or segmented relationship, namely the regression function continuous at the change points  k .where, and where we have used lower case letters to mean observed and random variables as well. The parameters  1 and s are from Equations (1)and(2), and the s are 'working' coefficients useful for the estimation procedure (). At each step the working model (3) is fitted and new estimates of the change points are obtained viviThe process is iterated up to convergence when parameter estimates are available and model (1) is readily estimated. Notice we are using standard linear models to fit the change point model, resulting in a very efficient algorithm even with n large and many change points to be estimated. As previously discussed, estimation of model (3) actually may be carried out via least squares, which ensures unbiased parameter estimates by requiring only zero mean errors; in fact, when this assumption is met in the original data, i.e. E=0, it is also fulfilled for model (2) [and its working version (3)], i.e. E=0. An important advantage of the ordinary least squares procedure is its robustness against departures from normality, homoscedasticity or uncorrelation/independence; we will assess robustness with regard to change point detection via simulations later. When the number of change points, K 0 , is known and the starting values are not unreasonably 'far' from solutions, the algorithm converges in a few iterations by returning exactly the estimated locations of these K 0 change points.
Model estimation: overdetecting the change points (output 1)The aforementioned 'segmented' algorithm allows us to get parameter estimates efficiently when the exact number of change points is known and 'reasonable' starting values are set. However, the true number K 0 of change points is unknown in practice and we propose to overcome these issues as follows. We start the algorithm using a large number K of candidate change points, possibly quite larger than the supposed one in order to make irrelevant the location of starting values; we set the starting values at equally spaced values or quantiles of the x i s. Then the working segmented model (3) is iteratively fitted, and at each iteration the k-th change point is discarded (and the corresponding covariates U k and V k deleted) when it is not admissible. We say the estimat  k is not admissible when @BULLET it does not belong to the allowed range. Whether the generic valuevalue value k is not a change point, the relevantrelevant relevant k is approximately zero, leading theAs the algorithm goes on, only admissible values are retained, and at the convergence only the K * (< K) likelier values are returned. We refer this step of the algorithm as 'output 1' that produces for the original data the fitted modemodeThis approach may be considered essentially as a smoothing algorithm based on the 0-degree truncated power functions bases (the V k s) with 'automatic' selection of the knots, i.e. the change points. The output is similar to that returned by the fused lasso (), namely a wiggly fitted 'curve'. While the number of change points will be strongly overestimated, the fitted values from this output may be used to determine, for instance, which segments are aberrant, namely which means may be assumed to be less, equal or greater than 0. In aCGH analysis, typically this is achieved via a post-processing step, namely by applying a given procedure on the fitted values returned by the relevant algorithm. For instance, a simple strategy consists in labeling as aberrant the values outside m times, say, the computed SD. More sophisticated procedures include the so-called 'MergeLevels' (), 'CGHcall' (van) and 'false discovery rate' (FDR)-based approach used inand Tibshirani and Wand (2008). While the fitted values (5) may be employed by any of the aforementioned approaches to yield 'calls for gains and losses', in this article we are specifically interested in the change points. As previously discussed, this can be relevant in several biological contexts, not necessarily involving aCGH data.
Model estimation: selecting the number of change points (outputs 2 and 3)Output 1 returns estimates for the model with K * change points. However, when the algorithm is started with K K 0 , it is likely that the K * returned change points are more than the actual ones, and therefore it is of interest to assess whether K * change points are really necessary. In other words, we need to select only the 'significant' change points by removing the spurious ones. Whether the genericgeneric generic k is not a change point, the corresponding covariate V k should be a noise variable, as it would b  k  0. Thus, selecting the number of change points actually reduces to selecting the significant variablesThis is a variable selection problem, and to solve it efficiently we use the lars algorithm proposed by. At the cost of a single least squares computation, the lars algorithm returns the solutions for the entire path, namely the parameter estimates from the 'null' (only-intercept) model to the full model when every variable V k is included in the model. The fitted 'optimal' model havingKhaving havingK  K * change points selected by any criterion, such as expression (6), is referred as 'output 2'. The 'optimal' model may be selected via any goodness-of-fit criterion penalized for the model dimension. However, at this aim we need to make some assumptions on the errors i ; among the well-known Akaike Information Criterion (AIC), the Bayesian Information Criterion (BIC) or the Minimum Description Length (MDL), we observe that the 'generalized' BIC based on Gaussian iid errorsappears to outperform its competitors. Her  2 is the residual variance estimate, edf is the actual model dimension quantified by the number of estimated parameters given by edf = 1+2{#changepoints} (including the intercept, the s and the s) and C n is a known constant. Note the generalized expression (6) reduces to the usual BIC when C n = 1.discuss the use of C n > 1 in identifying the true model when the number of parameters is not fixed but it diverges as n . In the analysis of genomic sequences, it is reasonable to think that the number of change points depends on the series length, therefore 'diverging' parameters appear to be appropriate here. Simulation studies presented later show that C n = loglogn appears to be the most suitable value, and that it works reasonably well even if the stochastic terms are not Gaussian iid: this is an important feature since the error structure is typically unknown in practice. The change pointspoints points 1 ,...,    K from output 2 are actually a subset of the estimatesestimates estimates 1 ,...,   K * from output 1, since one or more change points are not included due to deletion of one or more variables V k by means of the selection criterion (6). However, it should be recognized that whilwhil  1 ,...,   K * are 'the best' estimates, in that they minimize the residual sum of squares for K * change points, there is no guarantee that the subsetsubset subset 1 ,.(4) Repeat steps 2 and 3 up to some convergence criterion is met;
..,(5) Apply the lars algorithm to discard the noise variables V k and to select significant change points using the generalized BIC with C n = loglogn;(6) Refine, if requested, the parameter estimates by running a new segmented algorithm.Notice that if one is only interested in obtaining fitted values to apply some classification procedure (as in aCGH analysis), the algorithm may stop at step 4; otherwise the algorithm finishes at step 5, or possibly 6: in this case it suffices to run the segmented algorithm in step 4 with three to five iterations, without obtaining complete convergence.
SIMULATION STUDYWe have carried out some simulation experiments to assess the performance of the proposed approach in identifying the correct number of change points. At this aim, we have used the language R (R Development Core Team, 2006) with some additional packages as reported below. The first issue to be discussed concerns the criterion to be used to select the change points. We consider AIC, MDL and 'generalized' BIC (6) with different values of C n (for instance 1,  n,logn,loglogn). Preliminary simulations (not reported here) have revealed that the conventional BIC and especially the AIC strongly overestimate the number of change points, as also reported in. Among the different values C n > 1 examined, C n = loglogn performs the best and we have used this value throughout the rest of simulations. We Page: 164 161166
V.M.R.Muggeo and G.Adelfiohave compared our approach ('cumSeg') against three procedures:(i) circular binary segmentation (CBS;) as implemented in the R package DNAcopy (); (ii) CGHseg () based on dynamic programming and implemented in the package tilingArray () via the function findSegments() [or equivalently segment; (iii) LB, the lassobased discussed bytime of writing code at http://bioinformatics.med.yale.edu/DNACopyNumber/). We have focussed on robustness to some violations of the common model assumptions, namely performance of the procedures in identifying the true number of change points when the standard assumption of Gaussian iid is employed for estimation, but the true model has different stochastic terms: Gaussian iid (zero mean and variance equaling 0.2 2 ), Gaussian autoregressive (first-order autoregressive errors with zero mean are coefficient equal to 0.6, and variance 0.123 2 ), Gaussian heteroscedastic [zero mean and variance equal to 0.2u being u  Unif (0.5,3)] and Laplace iid (scale parameter equal to 0.5/  2). We have considered three sample sizes (n = 100,500,1000) and two values for the true number of change points (K 0 = 0 and 4), being the true signal  i = 0 orthe 'covariate' i includes equispaced values ranging from 0 to 1. It should be stressed that the performance in the 'null' case (K 0 = 0) appears to be crucial, as it represents the well-known type 1 error that has to be controlled; comparisons concerning the capability in identifying change points cannot be apart from their performance when no change point exist. Perhaps surprisingly, it appears that most of the papers in literature have contrasted the different methods only with respect to their ability in detecting aberrant regions when these exist (); to the best of our knowledge, only few papers (e.g.) have carried out comparisons in the null case.reports the results in terms of means and SDs of the number of selected change points over the 1000 replicates in each of the 24 simulation scenarios considered. In our simulation, no method outperforms the others over all the scenarios. For the null (i.e. 'only-intercept') case, CGHseg breaks down in each scenario, regardless of the sample size and the error structure, as it selects too many change points. CBS heavily fails in the autoregressive scenario, especially at larger sample sizes; sensitivity of CBS to'local trends' induced by autocorrelation has also been reported by. LB works adequately in all but the heteroscedastic case, where more change points are selected at larger samples. The proposed approach (cumSeg) selects the correct number of change points in all but the autoregressive scenario; however in this context, the average number of detected s is small and, more importantly, it decreases along with the SD as the sample size increases. When there exist K 0 = 4 change points, cumSeg performs reasonably well in all the scenarios, being slightly below CBS in the heteroscedastic case. However, CBS selects too many segments with autocorrelated errors as in the null case, while heteroscedasticity appears to affect the performance of CGHseg, which does not improve at larger sample sizes. Results from LB are somewhat unsatisfactory depending strongly on the sample size. Simulation results concerning the the estimated locations of the change points and the fitted conditional means can be found in the Supplementary Material.. Mean (m) and standard deviation (s) of the detected number of change points in two models (K 0 = 0 and K 0 = 4) with four different error structures and three sample sizes according to the four different approachesPage: 165 161166We analyze the sequences of the fibroblast cell line GM03563 in four chromosomes, such as 1, 3, 9, 11. Data and results are reported in. By spectral karyotyping, it is known that 'real' alterations are present only in chromosomes #3 and #9 (in particular K 0 = 1 in both the sequences). In chromosome #3, CBS and cumSeg provide the same right answer, while the others return two change points (the two estimates by LB are quite close); in the chromosome #9 no method returns one single change point estimate: CBS fails to find it, and the others select more than one. For the other chromosomes, only LB for chromosome #11 and both LB and cumSeg for chromosome #1 give the correct result (i.e. no change point). By considering chromosomes #1 and #11, results appear coherent with those of the simulation study in previous section. CGHseg always returns too many change points and if there is autocorrelation, CBS and, to some extent, cumSeg tend to overestimate the number of changes, while LB performs the best. However in chromosome #3, LB estimates two, rather than one, change points.
Change point detection
Breast tumor dataHere we consider the breast cancer cell line (MDA157) from cDNA microarray CGH profiled across 6691 mapped human genes in 44 breast tumor samples and 10 breast cancer cell lines. This dataset is discussed inand available from the Stanford Microarray Database at http://smd.stanford.edu.shows the data along the fitted values from the five different approaches. We observe that cumSeg appears to provide reasonable results quite similar to those of CBS with some differences in chromosomes #5, #6 and #19. Unlike the previous dataset, here LB gives fitted curves too wiggly with an excessive number of change points (chromosomes #8, #13 and #19); simulations have also shown that LB tends to select too many change points in certain scenarios (Gaussian heteroscedastic or Laplace iid errors).
DISCUSSION AND FUTURE WORKWe have presented a simple and computationally efficient framework, 'cumSeg', for detection of the number of change points in genomic sequences; we have not discussed in detail estimation of the location of the change points or the mean levels, although some simulation results are provided in the Supplementary Material. 'cumSeg' is based on a quite efficient algorithm to estimate the change points and the lars algorithm to discard the spurious ones via a generalized version of the BIC. The number of change points (K) to initialize the algorithm does not appear to affect the final result (i.e. 'output 2' and '3'), provided that it is large relatively to the supposed number of change points; for instance 30 to 50 or even equal to some fraction of the series length, n/4 say. Simulations and analyses of some datasets corroborate this point. The method turns out to be quite efficient even for large datasets, and for huge datasets it may benefit from strategies such as the R packages biglm () and biglars (), although we have not tried them in practice. The main appealing of the proposed approach is its robustness to the deviations from the common assumptions which are usually employed in real data analyses: Gaussian, independent and homoscedastic errors. Some simulations have shown that the our approach works reasonably well with non-normal errors, spatial dependence due to the physical dependence of nearby markers and heteroscedasticity coming from different quality of measurements. Simulation studies have shown that the other approaches perform poorly in other specific contexts, especially when there is no change Page: 166 161166
V.M.R.Muggeo and G.Adelfiopoint. Like other approaches proposed in literature (), our framework also does not deal with 'single shocks', i.e. unit-width aberrations concerning single observations, genes/clones. As discussed by, it is sometimes difficult to distinguish between single-gene copy number mutations and outliers, since an isolate high/low outcome may be caused by measurement errors/inaccuracies. The cumSeg algorithm, currently implemented in R package cumSeg (), has been illustrated for the basic, simplest case. However, some extensions may be easily supported by our framework. We give a brief outline of the possible topics which may represent hints for development and future research. Firstly, when the real genomic location for each probe (gene/clone) is available (e.g.), the 'segmented' variable x i is not simply the position index and the model should include this information. In this context, it is easy to verify that to 'convert' the jumpoint model (1) into the (continuous) segmented model (2), it suffices to consider z i = i j y j j (rather than simply,...,n, and x (i) > x (i1). The rest of the algorithm remains unchanged. Quality of measurement data may exist in some platforms, seefor a discussion. The reliability for the outcome variable y i is quantified by the value w i , such that the larger w i , the better the measurement. For instance, w i is the inverse of the empirical SD of the pixels corresponding to y i , i.e. associated with the same probe i. In wider statistical context, w i represents the weight which may be included in the objective function, therefore to account for quality of measurements it suffices to estimate model (3) via weighted (rather than ordinary) least squares. Yet another development is the simultaneous analysis of multiple sequences: to deal with such extension the 'segmented' algorithm could include some modifications discussed in Muggeo (2008a) to deal with segmented relationships in each levels of some grouping variable. There is another possible generalization of our framework. Halpern (2000) discusses detecting multiple change point in binary 0/1 genetic sequence for the analysis of recombination of viruses in HIV studies. Here the response variable is Bernoulli and the underlying piecewise constant signal may be expressed on the logit scale, in the spirit of classical generalized linear models (GLMs). The standard iterative weighted least squares algorithm employed in estimation of usual GLMs may be modified by considering the cumulative sums of the working variate. Moreover, the penalized selection criterion (6) should be also modified, but only in the 'fidelity' term: the log variance should be replaced by the bernoulli deviance, remaining unchanged by the penalty term.
at :: on August 31, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
