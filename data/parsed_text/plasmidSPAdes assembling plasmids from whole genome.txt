Motivation: Plasmids are stably maintained extra-chromosomal genetic elements that replicate independently from the host cell's chromosomes. Although plasmids harbor biomedically important genes, (such as genes involved in virulence and antibiotics resistance), there is a shortage of specialized software tools for extracting and assembling plasmid data from whole genome sequencing projects. Results: We present the plasmidSPAdes algorithm and software tool for assembling plasmids from whole genome sequencing data and benchmark its performance on a diverse set of bacterial genomes. Availability and Implementation: PLASMIDSPADES is publicly available at
IntroductionPlasmids are common in Bacteria and Archaea, but have been detected in Eukaryotes as well (). The cells often have multiple plasmids of varying sizes existing together in different numbers of copies per cell. Plasmids are important genetic engineering tools and the vectors of horizontal gene transfer that may harbor genes involved in virulence and antibiotic resistance. Thus, studies of plasmids are important for understanding the evolution of these traits and for tracing the proliferation of drug-resistant bacteria. Since plasmids are difficult to study using Whole Genome Sequencing (WGS) data, biologists often use special biochemical methods for extracting and isolating plasmid molecules for further plasmidome sequencing (). In the case of WGS, when a genome of a bacterial species is assembled, its plasmids often remain unidentified. Obtaining information about plasmids from thousands of genome sequencing projects (without preliminary plasmid isolation) is difficult since it is not clear which contigs in the genome assembly have arisen from plasmids. Since the proliferation of plasmids carrying antimicrobial resistance and virulence genes leads to the proliferation of drug resistantbacterial strains, it is important to understand the epidemiology of plasmids and to develop plasmid typing systems.developed PlasmidFinder software for detecting and classifying variants of known plasmids based on their similarity with plasmids present in plasmid databases. However, PlasmidFinder is unable to identify novel plasmids that have no significant similarities to known plasmids.developed the plasmid constellation network (PLACNET) tool for assembling plasmids from WGS data and applied it for analyzing plasmid diversity and adaptation () PLACNET uses three types of information to identify plasmids: (i) information about scaffold links and coverage in the WGS assembly, (ii) comparison to reference plasmid sequences and (iii) plasmid-diagnostic sequence features such as replication initiator proteins. PLACNET combines these three types of data and outputs a network that needs to be further pruned by expert analysis to eliminate confounding data. While combining all three types of data for plasmid sequencing is important, the focus of this paper is only on using WGS assembly for plasmid reconstruction in a fully automatic fashion. We argue that while the analysis of scaffolds inis important, there is a wealth of additional information about plasmids encoded in the structure of the de Bruijn graph (constructed from k-mers in reads) thatdo not consider. Recently,demonstrated how to use the de Bruijn graphs constructed by the SPADES assembler () to significantly improve the plasmid assembly (focusing on data generated using plasmid isolation techniques) as well as reconstruction of plasmid sequences from metagenomics datasets. Below we describe a novel tool (PLASMIDSPADES) aimed at assembling plasmids from the WGS data. Recently, this problem was addressed in the case of long SMRT reads () but it remains open for datasets containing short Illumina reads, which represent the lion's share of bacterial sequencing projects. We show that PLASMIDSPADES has the potential to massively increase the throughput of plasmid sequencing and to provide information about plasmids in thousands of sequenced bacterial genomes by re-assembling their genomes, identifying their plasmids and supplementing the corresponding GenBank entries with the plasmid annotations. Such plasmid sequencing efforts are important since many questions about plasmid function and evolution remain unanswered. For example,recently found a striking example of a bacterium (Aureimonas sp. AU20) that harbors the rRNA operon on a plasmid rather than on the chromosome. Thus, re-sequencing 1000s of bacterial genomes with the goal to reassemble their plasmids will help to answer important questions about plasmid evolution. We illustrate how plasmidSPAdes contributes to plasmid discovery by analyzing the Citrobacter freundii CFNIH1 genome with wellannotated plasmids and identifying a new previously overlooked plasmid in this genome. We also show how PLASMIDSPADES was used to discover eight new plasmids in ten randomly chosen shotgun datasets derived from bacterial genomes and deposited in the Short Reads Archive. We further benchmark various tools for plasmid sequencing and provide the first analysis of accuracy of existing plasmid sequencing tools across diverse bacterial genomes.
Methods
Separating plasmids from chromosomes by read coveragePLASMIDSPADES uses the read coverage of contigs to assist in distinguishing between plasmids and chromosomes. Illumina DNA sequencing platform typically produces reads with highly uniform coverage of the bacterial chromosomes.andillustrate that 92% (78 out of 85) of contigs greater than 10 kb in length in the assembly graph of the E. coli genome have coverage within 10% of the median value and 99% (84 out of 85) have coverage within 20% of the median value. The coverage of most genomes in this table is rather uniform with exception of Bacillus anthracis A1144, Rhodococcus J21s and Thermus filiformis ATT43280 (shown in bold). Depending on the copy number of the plasmid, its coverage can be higher or lower than the chromosome coverage. For example, if a plasmid has a copy number 10, we expect it to have a much higher coverage than the chromosome coverage. Similarly, if a plasmid can only be found in 1/10 of the sampled cells, it will have a much lower coverage than the chromosome coverage. In order to distinguish plasmids and chromosomes by coverage, PLASMIDSPADES first estimates the chromosome coverage. The naive strategy for estimating the chromosome coverage as the average coverage over all contigs often leads to an inflated estimate because some plasmids have very large copy numbers. Since such plasmids have high coverage, the average coverage may be skewed towards the plasmid coverage. To avoid this pitfall, PLASMIDSPADES computes the median coverage (denoted medianCoverage) using the assembly graph constructed by the SPADES assembler (). SPADES generates the assembly graph by first constructing the de Bruijn graph of all reads and further performs various graph simplification procedures (e.g. bubble and tip removals) to transform it into the assembly graph. An edge in the assembly graph is classified as long if the length of the contig resulting from this edge exceeds the parameter longEdgeLength (the default value is 10 000 bp) and short otherwise. The median coverage is defined as the maximum coverage for which the collection of all long contigs of that coverage or greater covers at least half of the total length of the collection of all long contigs in the SPADES assembly graph. We focus on long (rather than all) contigs for two reasons. First, analyzing long contigs allows us to exclude most repeats from consideration since the longest repeats in most bacterial genomes are shorter than 10 kb (). Second, long contigs have a lower variance in their coverage compared to short contigs.The median coverage for long contigs is 231. Each bar in the histogram represents all contigs with the coverage in a bin of size 5. For example, the tallest bar in the histogram corresponds to the contigs with coverage between 230 and 235. The long contigs with minimum (160) and maximum (268) coverage have lengths 10438 and 13 078 bp, respectivelyshows the differences in coverage between B. cereus chromosome and its plasmid and illustrates the utility of using medianCoverage to identify chromosomal contigs. For this dataset, the long contigs can be separated with perfect sensitivity and specificity into chromosome contigs (coverage varying from 120 to 156) and plasmid contigs (coverage varying from 170 to 184) based on coverage. The medianCoverage (vertical green line) corresponds closely to the center of the bacterial contig distribution because bacterial genomes are typically much larger than plasmid genomes.
plasmidSPAdes algorithmPLASMIDSPADES utilizes SPADES for transforming the de Bruijn graph into the assembly graph () and finds a subgraph of the assembly graph that we refer to as the plasmid graph. It further uses EXSPANDER () for repeat resolution in the plasmid graph using paired reads and generates plasmidic contigs. We define the size of a connected component in the assembly graph as the sum of the lengths of the contigs resulting from its edges. An edge (v, w) in the assembly graph is called a dead-end edge if either the node v has indegree zero or the node w has outdegree zero (but not both). PLASMIDSPADES classifies a connected component in an assembly graph as plasmidic if it is composed of a single loop edge of length at least minCirc (default value is 1 kb) or if its size exceeds minCompSize (default value is 10 kb). To transform the assembly graph into a plasmid graph, PLASMIDSPADES iteratively removes long chromosomal edges and short dead-end edges from the assembly graph. Chromosomal edges are removed because they are presumed to belong to chromosomes rather than plasmids. Dead-end edges are removed because plasmids are not expected to generate dead-end edges. The PLASMIDSPADES algorithm outlined below works best when the plasmids are circular and have a copy number significantly different from 1.PLASMIDSPADES (Reads, k, maxComponentSize) 1. construct the de Bruijn graph using k-mers from Reads and transform it into the assembly graph. 2. compute medianCoverage 3. repeat a. remove each long chromosomal edge in the assembly graph unless it belongs to a connected component with no deadFor each dataset, we computed the median coverage and then counted the number of long (>10 kb) contigs within x% of the median coverage (for x  10, 20 and 30%). For example, for E. coli, the median coverage was 216 and 85 out of 86 long contig had a coverage between within 20% of the median coverage. The table is divided into three parts corresponding to species with known plasmids (upper part), species that have no plasmids (middle part), and species for which it remains unknown whether they have plasmids. For the datasets with known plasmids we also computed the fraction of chromosomal contigs with a coverage within 10%, 20% and 30% of the median value among all chromosomal contigs (shown in parenthesis). The description of these datasets are provided in section 3.1 and Appendix.), 693 (multiplicity 3), 924 (multiplicity 4), etcin the resulting graph with a single edge 4. remove all non-plasmidic connected components from the assembly graph to construct a plasmid graph. 5. launch EXSPANDER to perform repeat resolution on the plasmid graph 6. output all resultant plasmidic contigs and assign them to a connected component in the plasmid graph they originated from. The minCirc and minCompSize parameters (implicit in step 4) serve an important goal of removing relatively short chromosomal contigs that evaded the step 3 of PLASMIDSPADES. For example, error-prone reads sometimes aggregate into short paths in the assembly graph that are represented by short isolated edge with low coverage. These erroneous contigs are not removed in step 3.a because they are short and their coverage differs from the genome coverage. They are not removed in step 3.b because they are not connected to any long edges. However, they are removed in step 4. Step 6 aggregates plasmid contigs into connected components (that are expected to originate from the same plasmid) rather than outputting all plasmid contigs as a set without attempting to assign them to individual plasmids. Ideally, PLASMIDSPADES should capture all plasmids and no chromosomal fragments in the plasmid graph (with the exception of chromosomal segments that share highly similar segments with chromosomes). However, it is not entirely true since some short segments of plasmids are sometimes missing from the plasmid graph and some short chromosomal segments are often present in the plasmid graph. Also, it is difficult to distinguish tandem repeats from plasmids by analyzing the assembly graph. Indeed, tandem repeats often form whirls in the assembly graph () resulting in cycles with high coverage by reads. To distinguish plasmid from tandem repeats, one should perform the plasmid-diagnostic tests for each putative plasmid identified by PLASMIDSPADES, e.g. a test on the presence of the replication initiation (Rep) and relaxase proteins, which are used for classification of plasmids into incompatibility groups and mobility types () Ideally, PLASMIDSPADES should assemble each plasmid into a separate contig. In practice, it is unlikely when plasmids contain long repeats (or share long repeats with other plasmids) with lengths exceeding the insert size.
Results
DatasetsAccession numbers and links to the datasets and reference genomes are available in the Appendix.describes six datasets that we used for benchmarking PLASMIDSPADES (see the next section for a detailed description of all columns). These datasets are composed from paired-end Illumina reads (at least 100 bp in length) from Bacillus cereus ATCC-10987, Rhodobacter sphaeroides 2.4.1, Providencia stuartii ATCC 33672, Citrobacter freundii CFNIH1, Burkholderia cenocepacia DDS 22E1 and Corynebacterium callunae DSM 20147. These genomes, abbreviated as Bce, Rsp, Pst, Cfr, Bcen and Cca, represent well studied bacterial species with completed reference genomes and annotated plasmids. The number of plasmids of different types in these datasets varied from 0 for Bcen to 5 for Rsp. The average copy numbers (estimated as coverage ratios) varied from 1.4 for Bce to 14.0 for Cfr. The lengths of plasmids varied from 4109 bp for Cca to 272 297 bp for Cfr. Analysis of B. anthracis A1144 genome is excluded from analysis insince it has highly non-uniform coverage. Interestingly, plasmidSPAdes assembled an additional previously unidentified short plasmid (5410 bp) in Cfr with high copy number (14) that is not listed in. This plasmid has a high-scoring BLAST hit to the plasmid pCAV1335-5410 in Klebsiella oxytoca strain CAV1335 (alignment length 4454 and percent identity 99.9).lists the following statistics that were generated using QUAST software (). The first eight columns in this table refer to the annotated chromosomes and plasmids and the remaining columns refer to the predicted plasmids.Ideally, chromosome fraction is 0%.benchmarked PLASMIDSPADES, SPADES and RECYCLER () on genomes with annotated plasmids. Although SPADES was not intended to be used for plasmid sequencing, we classified isolated cycles in the assembly graph (of length at least 1000 nt) as putative plasmids output by SPADES. Thus,should be taken with caution since all bechmarked tools were developed with somewhat different goals. We have not included PLACNET () in the benchmarking of various plasmid sequencing tools since it is not a truly de novo tool for plasmid finding, e.g. it requires RefSeq database and uses some proprietary databases which are not publicly available. Also, it is not a fully automated tool since it requires some manual analysis inside the Cytoscape program.
Genomes with annotated plasmids
Genomes with unannotated plasmids
Benchmarking plasmidSPAdes
Genomes with annotated plasmidsWe classify a plasmid (or a plasmidic component) as: @BULLET correct if its contigs were previously annotated as plasmidic (at least 90% plasmid fraction). @BULLET incorrect if its contigs were previously annotated as chromosomal. @BULLET likely correct if it matches an annotated plasmid from the NCBI webBLAST nucleotide database (at least 80% percent sequence identity) or carries plasmid-specific genesBcen N/A 0 N/A 0:0 N/A 0 N/A 0:0 N/A 0 N/A 0:illustrates, SPADES and RECYCLER showed somewhat similar results but RECYCLER generated more false positive plasmids. PLASMIDSPADES detected more plasmids than SPAdes and RECYCLER but often assembled them in multiple contigs rather than intact plasmids. We believe that PLASMIDSPADES and RECYCLER may complement each other since PLASMIDSPADES focuses on sequencing data from genomes of cultivated bacteria while RECYCLER focuses on plasmidome and metagenome data. Appendix 'Evaluating PLASMIDSPADES on annotated plasmids' provides additional information about this benchmarking.ratios for each putative plasmid, i.e. the coverage of each putative plasmid divided by the median coverage (cov ratio) @BULLET Confirmation status (conf). A 'Y' indicates that the putative plasmids best blast hit to NCBI NT database was to a plasmid. A 'N' indicates that the best blast hit to NT database was identified within a chromosome (for some related species). 'N/A' indicates that there are no significant matches to NCBI NT database. We further analyzed all plasmids annotated as 'N' or 'N/A' and, whenever possible, classified them as 'N/A (plasmid)', 'N/A (phage), 'N/A (rRNA)', 'N (phage)', or 'N (mobile).'
Genomes with unannotated plasmidsIn order to validate our results, we ran a blastn search of longest contigs from putative plasmids constructed by PLASMIDSPADES against the NCBI database of nonredundant nucleotides (NT). The best BLAST hit, defined as the hit with the lowest e-value (ties are broken by the highest bit score) for each putative plasmid component from this search can be used to identify each of the components. If the best hit for a component is to a plasmid sequence in the NT database, then we classify it as a confirmed plasmid and mark by Y in the last column of. We note that this confirmation approach is unable to confirm still unknown plasmids that have little similarity with known plasmids and so is prone to false negatives. To further investigate the putative plasmids marked as N/A, we annotated them using RAST server () to check if they harbor plasmid-specific proteins. If RAST identified plasmidspecific proteins, we labeled the corresponding putative plasmidic component as 'N/A (plasmid)' to emphasize that it likely represents a previously unknown plasmid. Interestingly, we found that some putative plasmids annotated as 'N/A' or 'N' likely represent phages (labeled as 'N/A (phage)' or 'N (phage).' Also, one of the putative plasmids annotated as 'N/A' harbored an rRNA gene cluster (labeled as 'N/A (rRNA)'). We also conducted further analysis of putative plasmids annotated as 'N' and found that many of them are formed by mobile elements that plasmidSPAdes failed to remove from the assembly graph (labeled as 'N (mobile)').(the edge representing the contig is a loop edge). Appendix 'Evaluating PLASMIDSPADES on unannotated plasmids' provides additional information about this benchmarking.
Analyzing sequencing datasets with non-uniform read coverageTo investigate why some datasets (like B. anthracis A1144 dataset) have a rather non-uniform coverage, we ordered contigs along the B. anthracis A1144 genome and represented each contig as a bar of height equal to the coverage of this contigs. The resulting histogram () reveals a characteristic shape with the minimum around position 2.5 Mb. The shape of the histogram inis similar to the shape of the skew diagrams that are used for identifying the origin of replication in bacterial genomes (). This similarity between the histogram of coverage and the skew diagram (albeit with a few outliers) suggests that the B. anthracis A1144 culture was sequenced in the growth phase when some cells have been replicating. The abundance of replicating cells leads to the increased coverage near the origin of replication (around position 0 Mb) and the decreased coverage near the origin of termination (around position 2.5 Mb) in B. anthracis A1144. Seefor the link between uneven coverage, rate of bacterial growth and the origin of replication. Since the coverage of the B. anthracis A1144 dataset is non-uniform, PLASMIDSPADES (run with the default parameter maxDeviation  0.3) is unable to remove a significant fraction of chromosomal edges in the assembly graph. Since the median coverage of the B. anthracis A1144 dataset is 130, PLASMIDSPADES only removes the edges with coverage exceeding 169 thus retaining a large number of chromosomal edges (). While increasing the maxDeviation parameter to 0.4 or even higher removes nearly all chromosomal edges, it also removes some plasmidic edges (B. anthracis A1144 has two plasmids with coverage 135 and 183, respectively). This example illustrates additional challenges in reconstructing plasmids from sequencing datasets with highly non-uniform coverage.
DiscussionWe described a novel PLASMIDSPADES algorithm for assembling plasmids from whole genome sequencing data. Since PLASMIDSPADES does not require any specialized sample preparation to isolate plasmids, it has a potential to increase the throughput of plasmid discovery. It thus complements a recently published approach mainly aimed at analyzing plasmids after plasmid isolation (). Asillustrates, PLASMIDSPADES identifies eight plasmids in ten randomly selected SRA dataset (three of them are not similar to any previously identified plasmids). We thus expect that 1000s of new plasmids will be identified when PLASMIDSPADES runs on all bacterial and achaeal SRA genome datasets.
D.Antipov et al. at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
PLASMIDSPADES uses coverage to remove chromosomal contigs from the assembly while retaining the plasmid contigs. We have demonstrated that in many cases it successfully removes over 99% of the chromosomal contigs while retaining over 99% of the plasmid contigs. However, PLASMIDSPADES has the following limitations:  PLASMIDSPADES may misclassify contigs from plasmids with copy numbers close to one as being chromosomal. However, in certain cases, PLASMIDSPADES correctly assembles circular plasmids even when they have similar coverage to the chromosome. For example, an isolated cycle in the assembly graph is classified as a putative plasmid irrespectively of its coverage.  The filtering procedure in PLASMIDSPADES relies on estimating a median chromosomal coverage. As long as the chromosomes are significantly larger than the total length of plasmids, PLASMIDSPADES reliably separates edges in the assembly graph into chromosomal and plasmidic. However, when chromosomes and plasmids are comparable in size (like in the case of megaplasmids (Zheng et al., 2013), filtering based on the median coverage may fail.  While the vast majority of plasmids are circular, some bacteria harbour difficult-to-detect linear plasmids. The performance of PLASMIDSPADES deteriorates in the case of linear plasmids. For example, PLASMIDSPADES assembled only one out of ten linear pasmids in Borrelia burgdorferi B31 (SRA accession number SRR1772332) into a single contig.  Since coverage of some short edges in the assembly graph significantly differ from the median coverage, PLASMIDSPADES may misclassify short chromosmal edges in the assembly graph as plasmidic.  Since chromosomes are typically much longer than plasmids, if even a small portions of a chromosome is not filtered out, the small percent remaining can result in some false positive putative plasmidic contigs. In the future, we plan to improve and extend PLASMIDSPADES by adding the following features:  When two plasmids share highly similar sequences, they may assemble into the same connected component in the assembly graph. However, If these plasmids have significantly different copy numbers, it may be possible to separate them from each other by analyzing their coverage using methods similar to the one described in Rozov et al. (2015). For example, PLASMIDSPADES merged five annotated plasmids in Rsp genomes into a single component in the plasmid graph (Table 2). However, four of them feature significantly different coverages, which would permit the identification of individual plasmids from this connected component.  Identification of plasmidic contigs can be improved by analyzing plasmid-diagnostic sequence features using methods similar to Lanza et al. (2014). For example, because plasmids are often self-regulated, they contain certain plasmid-specific genes to control their regulation. Similarly to PLACNET, these genes could be used as the basis for plasmid classification.  Identification of linear plasmids can be improved by using a less aggressive approach to removing tips in the plasmid graph.  The PLASMIDSPADES algorithm can be extended to sequencing organellar genomes using the coverage arguments that were recently applied to sequencing the spruce organelles (Jackman et al., 2016) by combining Illumina and Pacific Biosciences reads.
