Motivation: Topological domains have been proposed as the backbone of interphase chromosome structure. They are regions of high local contact frequency separated by sharp boundaries. Genes within a domain often have correlated transcription. In this paper, we present a computational efficient spectral algorithm to identify topological domains from chromosome conformation data (Hi-C data). We consider the genome as a weighted graph with vertices defined by loci on a chromosome and the edge weights given by interaction frequency between two loci. Laplacian-based graph segmentation is then applied iteratively to obtain the domains at the given compact-ness level. Comparison with algorithms in the literature shows the advantage of the proposed strategy. Results: An efficient algorithm is presented to identify topological domains from the Hi-C matrix. Availability and Implementation: The Matlab source code and illustrative examples are available at
IntroductionChromosome conformation capture techniques (3C, 4C, Hi-C) have yielded an unprecedented level of information about genome organization, and many studies are now exploring the relationship between genome structure and transcription (). Chromosome conformation capture studies suggest that eukaryotic genomes are organized into structures called topological domains (or topologically associating domains, TADs). Topological domains can be defined as linear units of chromatin that fold as discrete three-dimensional (3D) structures tending to favor internal chromatin interactions (). A majority of regulatory protein binding sites localize within topological domains. This suggests that sites associated with domain borders represent a functionally different subclass of alleles that delimit regions containing housekeeping genes and insulator sites (). Detecting the topological domains is thus helpful for studying the relationship between chromosome organization and gene transcription. For additional works on delineating structural domains (see Le). Topological domains can be detected using data from Hi-C, which allows genome-wide identification of chromatin contacts. The Hi-C method probes the 3D architecture of the whole genome by coupling proximity-based ligation with massively parallel sequencing. The Hi-C data matrix records the contact frequency between pairs of loci. Topological domains, as regions that have high intra-contacts, are characterized by diagonal blocks in the Hi-C matrix. To identify topological domains, in () the authors employed a Hidden Markov Model (HMM) on the directionally index from a Hi-C matrix to determine regions initiated by significant downstream chromatin interactions and terminated by a sequence of significant upstream interactions.formulated the identification problem by maximizing the domaintotal reads and introduced a dynamic programming algorithm to solve the problem with a given scale parameter. These methods perform analysis on a 1D read index or on a 2D image segmentation subblock, and they suffer from sensitivity to initialization (e.g. HMM model parameter adjustment), and high computational complexity (e.g. dynamic programming for combinatorial optimization). However, these methods do account for the fact that Hi-C matrices depend on interactions of loci on the genome. Specifically, the largest entries in a Hi-C matrix define a graph whose vertices are loci in the genome and whose edge weights are the contact frequencies between loci. Loci with high contact frequency are associated with small Euclidean distance in 3D space. Identifying fine domain resolution structures such as TADs can directly be translated to the problem of segmenting the graph into components with weak interconnections. Such graph partitioning approaches have been well developed in spectral graph theory (). Representation of HiC data as a graph and the usage of graph theoretic approaches have also been investigated by. While the former uses networks to present its experiment results and the later use graph theory to discover hubs in chromatin interaction data, neither of them discusses from the point of view of the graph segmentation for chromatin data. Based on a graph theoretic interpretation of Hi-C matrices, we propose a simple and mathematically sound algorithm for topological domain discovery based on spectral graph cuts. Domains at different scales are identified by running the spectral graph cuts algorithm recursively, until the connectivity of the graph associated with the domain reaches the level of desired compactness. Compared with previous algorithms inand, the proposed spectral method has several advantages: First, the method leads to topological domains that are highly correlated with gene transcription. Second, the proposed method admits a unique solution, and does not suffer from the severe initialization sensitivity of the HMM method, which is due to the fact that HMM involves an iterative expectationmaximization (EM) algorithm. Note that stability with respect to initialization affects the robustness of a method. Third, using the proposed graph connectivity stopping criterion leads to domains with sizes more closely related to the inherent structure of the region. Finally, the proposed method relates the Hi-C matrix to the spatial coincidence of loci via a graph and has moderate computational complexity. In the results section, the advantages of the algorithm are confirmed on Hi-C data collected from human fibroblast.
Preliminaries
Introduction to Hi-C dataHi-C evaluates long-range interactions between pairs of segments delimited by specific cutting sites by using spatially constrained ligation, and provides ligation information (segment coordinates, segment directions, etc) for the pairs (). These measurements are formatted into a square symmetric matrix H, where H ij stands for the total number of read pairs sequenced between loci i and j, where locus refers to a sequence of non-overlapping windows of equal sizes. This window size is also referred to as the resolution of the Hi-C matrix where 1 Mb and 100 kb are common resolutions. A Hi-C matrix is non-negative and diagonally dominant and tapered because a segment has higher probability of ligation with proximal regions as compared with distal regions. Furthermore, segments from chromosome centrometric regions cannot be uniquely mapped due to the presence of repeated sequences along the chromosomal strand. Thus there are zero-valued bands in the Hi-C matrix. These zero-valued bands are usually removed since they are non-informative. Finally, the entries are always nonnegative since they record the contact counts between pairs of loci. A Hi-C matrix therefore naturally associates a graph to the genome, where vertices are defined by binned loci in the genome, and the edge weight between a pair of loci is proportional to their contact frequency. Consequently, a TAD is a compact region that can often be visually distinguished as a diagonal block in the Hi-C matrix. TADs are strongly connected graph components having strong intraconnections and weak inter-connections (see the(a)(c) for illustration).
Spectral graph theoryModeling the spatial organization of chromosomes in a nucleus as a graph allows us to use recently introduced spectral methods to quantitively study their properties. Our strategy for identifying topological domains is based on spectral graph theory applied to the Hi-C matrix. Relevant concepts are reviewed below. We define a undirected graph as the ordered pairs of sets G  V; E where V  fv 1 ; v 2 ;. .. ; v N g is a finite set of vertices with cardinality N, and E is an edge set consisting of elements of the form fv i ; v j g; i 6  j. The adjacency matrix AG (or A for short) is the symmetric N  N matrix encoding the adjacency relationships in the graph G, such that AG ij  1 only if fv i ; v j g 2 E, otherwise AG ij  0, with  ij denoting the ijth entry of its matrix argument. The degree of a given vertex, denoted by dv i , iswith N i denoting the neighboring vertices of v i. The degree matrix, DG, is defined as a diagonal matrix with the ith diagonal entry given by dv i , namely, DG ij  dv i  i  j 0 i 6  j:(The Laplacian of graph G is defined byLG  DG  AG;and the normalized Laplacian is given by L N G  DG  1 2 DG  AG DG  1 2 :For a graph, let the ordered eigenvalues of LG (or L N G) be denoted by k 1 ; k 2 ;. .. ; k N , where the following relation holdsThe second smallest eigenvalue k 2 is known as the Fiedler number, or algebraic connectivity, which characterizes the connectivity and stability of the graph (). When the graph is connected the Fiedler number is strictly positive. Intuitively, a more highly connected graph possesses a larger Fiedler number. For example, a complete graph is a graph for which every vertex has degree N  1 and it has maximum Fiedler number among all graphs over N vertices. Therefore, the Fiedler number is an appropriate measure for associating the Hi-C data with the connectivity properties of the chromatin structures. The eigenvector associated with k 2 is called the Fiedler vector. For a graph having several connected components the Fiedler number is zero and the adjacency matrix is permutation-equivalent to a block diagonal adjacency matrix A. In this case the components can be uniquely identified from the signs of the corresponding entries of the Fiedler vector (). The positive and negative pattern defined by the Fiedler vector is called the nodal domain ((d)). More generally, instead of considering binary connections between pairs, weights can be assigned to each edge such that AG ij  w ij only if fv i ; v j g 2 E (otherwise AG ij  0 to characterize the connection strengths. The associated degree matrix, DG, and Laplacian, LG (or L N G), are defined in the same way as in (2) (4). See () for more details on spectral matrix theory for weighted matrices.
Characterizing the TAD graph with the normalized LaplacianThe Hi-C matrix can be interpreted as a weighted adjacency matrix for TAD graph. The normalized Laplacian (4) has several advantages over the unnormalized Laplacian (3). The spectrum of the unnormalized Laplacian is influenced by the nodes having the highest vertex degree. This can lead to the high degree nodes masking the nodes with lower vertex degrees, and consequently leads to loss of sensitivity to complex structure. An extreme example of this is the case where there is one very highly connected component and other smaller connected components in the graph. In this case, the connectivity structure of the highly connected component will have dominating influence on the graph spectrum, masking the spectral imprint of the of the other components. The normalized Laplacian levels the playing field for both highly connected components with nodes of high average vertex degree and components with nodes of lower average vertex degree. This reduces the masking effect and leads to higher sensitivity to hidden structure. Using the Fiedler number from the normalized Laplacian leads to capturing the local structure patterns without being affected by other regions on the same chromosome with high vertex degree, which is consistent with our biological objective of finding the locally organized regions having co-regulated genes. Furthermore, unlike the unnormalized Laplacian (3), the normalized Laplacian (4) has a Fiedler number that is upper bounded, specifically k 2 N N1
2.
Topological domain identification with graph segmentationAs presented, the Fiedler vector of the Hi-C matrix can thus be used to segment the chromosome into domains, and the Fielder value of each domain indicates whether the obtained domain is sufficiently compact, or needs to be further divided. We firstly present some relevant notation and pre-processing, then the proposed strategy.
Notation and pre-processing3.1.1 Dynamic range reduction Let H be the observed Hi-C matrix of a given chromosome of length L (with unmappable regions and diagonal entries removed), and let H be a transformed Hi-C matrix with reduced dynamic range  H ij  0 for i  j f H ij  for i 6  j; (where the function f  is introduced to alleviate the large dispersion of the raw Hi-C matrix data. Functions such as the power transform f x  x a , with a typically in  1 4 ; 1 2 , or the logarithmic transform f x  logx can be used. Besides reducing data variability, since the Hi-C matrix is a matrix of counts that can be modeled as Poisson, power transform can be designed with an exponent that depends on the position of the entry in the matrix (). The power transform with a  1 2 () normalizes the variance of the Poisson entries. Alternatively, the logarithmic transform make entries approximately normal. The function f can also be selected as a canonical link between Poisson variables and explanatory variables for Hi-C matrices in a generalized linear model (GLM) framework ().
Toeplitz normalizationIf two loci lie on the same chromosome of DNA, maximal separation between two loci is the length of DNA lying between them. As a result closely spaced loci are likely to have large Hi-C read counts, regardless of their specific conformation. To remove the distance effect, we employ a Toeplitz normalization. The Toeplitz normalization divides the (i, j)th entry in the Hi-C matrix by the mean of all matrix entries at the same distance ji  jj from the diagonal. Mathematically, this step is described by:where corresponds to elementwise division of entries of H and E, and the entries of E are given bySpectral identification of topological domainswith the set I k'  fm; n j m  n  k  '; 0 < k; ' < Lg, cardI  denotes the cardinality of the finite set I. The Toeplitz matrix E represents the expected contact frequency as a function of the genome distance. Note that read depth normalization (the read depth normalization is defined as H D  c D 1 HD 1 where D is a diagonal matrix with D ii  P L j1 H ij , and the scalar c is the total number of reads) can be performed beforehand, but we found this does not lead to significant difference in the results (see Supplemental Material (SM)).
Fiedler number and vector calculation operatorFor an adjacency matrix A, we use the operator notationto denote the extraction of the Fiedler number k 2 and the Fiedler vector v, by computing the eigen-decomposition of the normalized Laplacian of A defined in (4). When we want to emphasize the extraction of the Fiedler vector, we abuse notation by omitting k 2 from the notation (9), i.e. we write v FvA.
Topological domain extraction via recursive partitioningIn this subsection, a topological domain extraction strategy is proposed based on the normalized graph Laplacian. The algorithm considers both local interactions and long-range interactions embedded in the Hi-C matrix. The algorithm first extracts initial domains via the sign of the Fiedler vector, then it splits each domain recursively until the Fiedler number of a newly obtained domain is higher than some threshold and the size of the domain is sufficiently small. As the Fielder number is proportional to the algebraic connectivity, this threshold ensures discovery of sufficiently disconnected domains. At the first step, we consider the weighted graph with edge weights defined by the Toeplitz normalized matrix H N. The Fiedler vector, denoted by v 1 , of this graph is computed and the graph is segmented into two clusters that are differentiated by the signs of the Fiedler vector entries. A number of locally compact structures are then given by the sets of vertices with the same sign on the largest range of continuous indices from i to j. This results in the regionthe same sign. Experimentally we have observed that the sizes of these domains vary from 100 kb to several megabases. They can naturally be defined as the initial topological domains. We can identify over 3000 TADs determined by the Fiedler vector derived from H N. We will see that compared with the gene expression represented by RNA-seq counts, regions within each domain approximately behave in a binary manner, all active, or all inactive. Further, all domains with the same sign behave binary manner, active or inactive. From spectral graph theory, we known that domains with the same sign are in the same cluster, and have fewer connections to other clusters than connections within their own cluster. This result obtained from H N considers the overall contact organization of the chromatin. This step results in segmentations that are similar to the compartments A and B obtained from (). A further comparison can be found in supplementary materials (Section 4). Topological domains are likely to exhibit hierarchical structures (). After determining the initial domains via the Fiedler vector of H N , we therefore further divide these domains to sub-domains having smaller sizes. For an obtained domain D ij , we calculate the Fiedler vector of the graph whose adjacency matrix is given by the sub-matrix of H indexed by D ij , followed by splitting D ij into sub-domains based on the signs of its Fiedler vector entries. In this step matrix H is used, since the determining these smaller sub-domains relies on diagonal block structures in H, instead of the long-range interactions exhibited in H N. The Fiedler number of the obtained domains are calculated and compared with a predefined threshold k thr to determine whether they are sufficiently compact, or can further be split. The full algorithm is summarized in Algorithm 1. An example of the algorithm processing is illustrated in supplemental data file (Supplementary). A discussion of this twostep strategy and alternative strategies is included in the SM.
Computational complexityThe complexity of the proposed algorithm is dominated by the eigen-decomposition of the normalized Laplacian matrices. Step 1 requires the eigen-decomposition on a moderate size matrix (e.g. %2300  2300 for chromosome 1 at 100 kb resolution, %350  350 for Chromosome 22 at 100 kb resolution). The resultant recursions will process matrices of much smaller sizes, and the computational time for eigen-decomposition is reduced significantly. In the next section, we will provide more details on computational requirements. For higher resolutions with larger matrices, this computation can be performed more efficiently by only computing a few of the first smallest eigenvalues and the associated eigenvectors, using, for example, power iterations (), or by distributed means (). These particular strategies will be investigated in future work.
ResultsIn this section, we illustrate the proposed algorithm and compare it with previously proposed algorithms. The algorithms were first applied to Hi-C data obtained from human foreskin fibroblasts from a normal karyotyped male individual. Fragment contacts were binned to generate Hi-C matrices at 100 kb resolution. The Hi-C library, RNA-seq library, data collection, and raw data processing
Algorithm 1. Identification of TADs via graph LaplacianParameters: Fiedler number threshold k thr , and user-supplied lower bound L on domain size. Pre-processing: For a given chromosome, compute the matrix H using (6) and the normalized matrix H N using (7). Algorithm: Step 1: Calculate the Fiedler vector of the matrix H N :Initial TADs are given by the contiguous regions in v 1 with the same sign.Step 2: For each obtained domain, compute its Fiedler number and vector for each associated sub-matrix in H:If the Fiedler number is smaller than the threshold k 2 k thr , segment the current domain again via v. Recursion: Repeat step 2 until the obtained sub-domain has a Fiedler number larger than the threshold, or its size reaches the lower bound L.were all performed by our laboratory, see SM and Chen et al.for the protocols, the detailed cell culture and data collection methods. The algorithm was then applied to Hi-C data from IMR90 cells at a higher 5 kb resolution. Details of the toolbox can be found in Section 1 of SM. For comparison, we considered the topological domains extraction methods presented in, the authors defined the directionality index (DI) at each bin bywhere N up denotes the reads from the current bin to 2 Mb upstream, N down denotes the reads from the current bin to 2 Mb downstream, and N av  1 2 N up  N down . Then the directionality index was modeled as the observation of a hidden Markov model (HMM) under a Gaussian mixture model, endowed with three hidden states associated with the start, end and middle of a domain. In, the authors formulated the topological domain identification problem via the following optimization:The function q is defined by qk; l; c  sk; l; c  l s k  l, where sk; l; c  N kl kl c with c a scale parameter and N kl is total reads between loci k and l, and l s k  l is mean value of sk; l; c over all sub-matrices of length l  k. The optimization (13) was solved via dynamic programming (DP). For brevity, in this paper we illustrate the identified topological domains for one of the smaller chromosomes of the fibroblasts: chr22. Results on all the other chromosomes can be found inS23 in the supplemental file. The logarithmic transform f  was used in (6) to reduce the dynamic range of data and for variance normalization. The proposed algorithm and the two comparative algorithms were then applied to the transformed Hi-C matrix of Chromosome 22. For the HMM method, we took reads from current bin to 1 Mb upstream and downstream for N up and N down instead of the 2 Mb in the original presentation upstream/downstream distance in order to investigate its effect on the domain size distribution in the HMM segmentation. However, the upstream/downstream distance did not appear to have an effect on the size distribution. For the DP algorithm, the parameter c was set to c  0:2 and 0.25, respectively. For the proposed algorithm, Algorithm 1 was implemented with k thr  0:8 and 0.9, respectively. The identified topological domains are illustrated inwith diagonal blocks marked by blue squares. It can be observed that the proposed algorithm provides results that are most consistent with the observations, and finer domains can be obtained hierarchically by increasing the threshold k thr. Compared with the proposed algorithm, the HMM methods have difficulty controlling the domain resolution to user specifications. Furthermore, the HMM algorithm suffers from the problem of convergence to local maxima of the likelihood function and is over-sensitive to the initialization. The DP method has very high computational complexity, especially for large chromosomes. A comparison among these algorithms and quantitive computational time are reported inand 2 respectively. The advantage of the proposed algorithm in computational efficiency for Hi-C data at 100 kb resolution is obvious. Detailed information on the boundary coordinates identified by the three algorithms are provided in the SM. We use Chromosome 22 to illustrate the capability of the proposed algorithm to identify meaningful domains. The size distribution of identified TADs using the proposed algorithm with k thr  0:8 and k thr  0:9 are shown in(a).Their boundary coordinates are reported in. While varying the Fiedler. Illustration of estimated topological domains on Chromosome 22 obtained by previous algorithms and the proposed algorithm
Spectral identification of topological domainsnumber threshold k thr , we then count the number of domains identified by the proposed algorithm and compute the mean size of the domains. In the top part of(b), as expected the number of domains found in Chromosome 22 increases with increasing k thr. Not shown are the results of decreasing the threshold below 0.8, where there is little change in segmentation. This is due to the fact that the segmentation on H N in Step 1 results in small size domains. Finally, when the threshold reaches k thr  2, the domains are composed of single bins and the number of domains equals the size of the Hi-C matrix. We compare the identified TADs with those identified by the HMM method. First, the proposed methods identified more TADs than the HMM method (Supplementary Table S2 and). Second, note that the proposed method and HMM give very different TAD segmentations. Even the first splitting step results in a larger number of domains than that identified by the HMM method. We show below that the TADs produced by the proposed spectral method with have significantly higher correlation to the transcriptional gene expression as determined by RNAseq (see). Therefore we conclude that the proposed method captures more meaningful structures. Furthermore the domain boundaries captured from these two methods often do not line up (See Supplementary) making further comparisons between the proposed spectral methods and the HMM method difficult.shows the total number of domains identified for Chromosome 22. Correspondingly, the bottom part of(b)shows the mean TAD size, which is expected to decrease with increases in the Fiedler number threshold. The results for the rest of the chromosomes are reported in the supplementary materials. Our proposed method also reveals that although they have the same algebraic connectivity (Fielder number), the topological domains of Chr 17 and 19 are larger than those of Chr 18. This may be related to the fact that Chr 17 and 19 are rich in protein coding genes while Chr 18 has fewer such genes. We next illustrate the relationship between the chromosome structure and gene expression via the identified topological domains.Gene expression is represented by RNA-seq counts. RNA-seq was performed simultaneously with Hi-C in our laboratory. In order to be consistent with Hi-C matrix resolution, we summarized the gene RNA-seq counts into bins of 100 kb resolution, according to their locations. In(a), we show the Fiedler vector of Chromosome 22 obtained in Step 1 of Algorithm 1 and its RNA-seq counts. It can be observed that the sign pattern of the Fiedler vector has high correlation with the expression levels of the RNA-seq data. Note that each locally consistent sign region is a topological domain obtained at Step 1 of Algorithm 1. To show this in a quantitive manner, we took the sign of the Fiedler vector and thresholded the RNA-seq count vector (where the threshold was selected for each chromosome to maximize the correlation), and then computed the correlation coefficient between these two vectors for all chromosomes. The correlation values are shown in(b). Significant correlation is observed according to this result (with p < 10 6 by permutation test. This shows that initial TADs are generally consistent with the two chromosome compartments in the genome, heterochromatin or euchromatin. We also show the decreasing trend of the relation between the averaged variance of log-scaled RNA-Seq reads within TADs versus the Fiedler number threshold (Supplementary). These results confirm the relationship between the identified topological domains and the functional expression (), and also reveals the quality of the identified topological domain. As compared to DP and HMM methods, the proposed method identifies TAD boundaries that are more consistent with the locations of known CTCF enrichment peaks. We plot the CTCF ChIPseq enrichment at bins of 100 kb resolution with the locations of identified TAD boundaries for the three compared algorithms in, with CTCF enrichment extracted from (). It has been proposed that TAD boundaries coincide with insulators such as CTCF binding sites. However, 85% of CTCF binding sites localize within TADs rather than at their borders, suggesting that most CTCF sites are unlikely to aide in identifying the borders that separate TADs. Meanwhile, multiple studies suggest that some insulator elements are not capable of enhancer-blocking or chromatin barrier activity (). Compared with the other two algorithms, the boundaries identified by the proposed algorithm are more consistent with CTCF enrichment peaks. A particularly visible example can be found for the large TAD between 300 and 350 bins. Finally, we illustrate the scalability of the proposed spectral algorithm to Hi-C data at higher resolution (5 kb) by applying it to the Hi-C IMR90 cell data of
ConclusionIn this paper, we presented a method for identifying topological domains based on the spectral decomposition of the graph Laplacian of the Hi-C matrix. The proposed algorithm has clear mathematical interpretation and is more computationally efficient than previous methods, allowing it to be applied to higher resolution Hi-C data. Its favorable comparison with other algorithms and its higher correlation with gene transcription dataillustrate the advantages of the proposed spectral method. Future work may include investigating fast iterative algorithms or parallel computation algorithms for improving the efficiency at higher resolutions.
FundingThis work is supported in part by the DARPA Biochronicity Program and NIH grant K25DK082791-01A109. Conflict of Interest: none declared.Spectral identification of topological domains
at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
J.Chen et al. at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
