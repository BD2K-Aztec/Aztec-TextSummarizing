Motivation: Network inference approaches are widely used to shed light on regulatory interplay between molecular players such as genes and proteins. Biochemical processes underlying networks of interest (e.g. gene regulatory or protein signalling networks) are generally non-linear. In many settings, knowledge is available concerning relevant chemical kinetics. However, existing network inference methods for continuous, steady-state data are typically rooted in statistical formulations , which do not exploit chemical kinetics to guide inference. Results: Herein, we present an approach to network inference for steady-state data that is rooted in non-linear descriptions of biochemical mechanism. We use equilibrium analysis of chemical kinetics to obtain functional forms that are in turn used to infer networks using steady-state data. The approach we propose is directly applicable to conventional steady-state gene expression or proteomic data and does not require knowledge of either network topology or any kinetic parameters. We illustrate the approach in the context of protein phos-phorylation networks, using data simulated from a recent mechanistic model and proteomic data from cancer cell lines. In the former, the true network is known and used for assessment, whereas in the latter, results are compared against known biochemistry. We find that the proposed methodology is more effective at estimating network top-ology than methods based on linear models. Availability: mukherjeelab.nki.nl/CODE/GK_Kinetics.zip Contact
INTRODUCTIONNetworks of molecular components play a prominent role in molecular and systems biology. A graph G  (V(G), E(G)) can be used to describe a biological network, with vertex set V(G) identified with molecular components (e.g. genes or proteins) and edge set E(G) with regulatory interplay between the components. Edges in a biological network are often associated with the causal notion that intervention on a parent node influences its child node(s). Data-driven characterization of the graph structure E(G) (often referred to as the topology) is known as network inference and has emerged as an important problem class in bioinformatics and systems biology. Network inference can aid in efficient generation of biological hypotheses from highthroughput data. Further, network inference can aid in exploring molecular interplay that is associated with specific phenotypes, such as disease states. From a statistical perspective, network inference entails reverse-engineering a graph G using biochemical data D and, where available, prior knowledge regarding aspects of the topology. Over the last decade, many methods for network inference have been proposed (see e.g.). To date, most methods for network inference have been rooted in discrete or linear formulations (). As discussed in Oates and Mukherjee (2012a), a wide range of existing approaches can be viewed as variants of the statistical linear model ('linear' refers to linearity in parameters, so that nonlinear basis functions may be used within a 'linear' framework). Moreover, a number of approaches based on ordinary differential equations (ODEs;) are ultimately reducible to linear statistical models, as described in. However, the biochemical processes underlying biological networks are often highly non-linear. When the data-generating process is non-linear, use of linear models may produce inefficient or inconsistent estimation, attributing causal status to artifacts resulting from model misspecification (). Indeed, such bias can prevent recovery of the correct network even in favourable asymptotic limits of large sample size and low noise (). On the other hand, in many settings, non-linear dynamical models of relevant biochemical processes are available. For example, gene regulation may be modelled using Michaelis Menten functionals (), and metabolism may be modelled using mass action chemical kinetics (). Here, we describe an approach by which kinetic models can be used to inform network inference from steady-state data. As we show below, such information can be valuable in guiding exploration of network topologies. Kinetic formulations have been widely studied in the systems biology literature, and recently, there has been much interest in statistical inference for such systems (e.g.). Our work is in a similar vein but focuses on network *To whom correspondence should be addressed. inference per se and on the steady-state rather than time-course setting. Although biochemical assays have become cheaper, it remains the case that experimental designs must often negotiate a trade off between more conditions (e.g. perturbations, biological samples and technical replicates) and temporal resolution. Methodologies, which can exploit knowledge concerning relevant dynamical systems in the steady-state setting, are therefore potentially valuable. In brief, we proceed as follows. We consider a class of non-linear biochemical dynamical systems that are relevant to the biological process of interest (we focus on protein signalling, discussed in detail later). Steady-state analysis leads to a class of functional relationships between parent and child. These functional relationships are used to formulate a statistical model for network inference from steady-state data. In this way, network inference is rooted in functional relationships derived from non-linear kinetics. Importantly, we do not assume detailed knowledge of the dynamical system, but only the broad class to which dynamics and associated equilibria may belong. Indeed, the approach we describe does not require any kinetic parameters to be known a priori nor knowledge of the network topology and is in that sense directly comparable with conventional network inference methods. Its potential advantage stems from then rich yet constrained nature of the class of functional relationships that are considered. As recently discussed in, non-linear functional forms can aid in identification of underlying causal relationships. We develop these ideas in the context of protein signalling mediated by phosphorylation. Enzyme kinetics have been extensively studied, and dynamical formulations are widely available in the literature (see e.g.). For some proteins and pathways, regulation has been studied in considerable causal and mechanistic detail. Indeed, there exist detailed computational models for canonical protein signalling pathways, which have been validated against experimental data (e.g.). Further, proteomic technologies now allow multivariate, data-driven study of phosphorylation, facilitating biological validation of network inference methodologies. We take advantage of these factors to examine the performance of our approach using both simulated and real data. In the phosphorylation setting, GoldbeterKoshland kinetics () form the functional class that underlies our network inference approach. GoldbeterKoshland kinetics are well known to be capable of highly non-linear behaviour including exquisite sensitivity. It has been experimentally demonstrated that this so-called ultrasensitivity is biologically relevant to signalling network dynamics, facilitating abrupt and precise decision making (e.g). We carry out statistical inference in a Bayesian framework, using reversible-jump Markov chain Monte Carlo (RJMCMC) to explore the joint model and parameter space. This yields posterior probability scores for edges in the network that are analogous to scores obtained in existing statistical network inference approaches for steady-state data (). The remainder of this article is organized as follows. In Section 2, our approach is laid out, followed by an exposition of the associated computational statistics. In Section 3, we present results on data simulated from a recently developed dynamical model of the mitogen-activated protein kinase (MAPK) signalling that has been validated against experimental data (). We then show results on real proteomic data from breast cancer cell lines. Finally, Section 4 closes with a discussion of practical implications and opportunities for network inference based on functional models, along with associated technical challenges.
METHODSWe begin in Section 2.1 by describing our approach in general terms. Section 2.2 then introduces relevant concepts in the application area of protein phosphorylation. In particular, we describe a class of non-linear equations derived from GoldbeterKoshland kinetics. Next, in Section 2.3, this model class is embedded into a Bayesian statistical framework for observations obtained at equilibrium. Inference over model space is facilitated by reversible-jump MCMC, with Section 2.4 dedicated to a presentation of our sampling scheme and a discussion of key implementational details.
General formulationWe consider a state vector X  X 1 ;. .. ; X p  containing concentrations of p proteins. Equilibrium analysis of phosphorylation dynamics, as described below, leads to a system of p equations X i  f i X; U i ; h i  where i indexes proteins, U i are external input variables and i unknown parameters. The component function f i depends on a subset i of the state variables, such that we may write X i  f i X i ; U i ; h i , where X i indicates selection of components of the vector X whose indices are members of the set i. Variables j2 i are the parents of node i in graph G; the parent sets i specify the (unknown) topology of interest since (j,i)2E(G),j2 i. Our inference scheme seeks to infer the i 's from steady-state data. Since the dynamical system is not usually known in detail a priori, we consider the practically applicable case in which the f i 's are known only to belong to a certain class F (derived from GoldbeterKoshland kinetics, as described below) with parent sets i and all parameters i remaining unknown.
Protein phosphorylationWe consider proteins i 2 V  f1;. .. ; pg, each of which has an unphosphorylated form X 0 i and a phosphorylated form X i (i2V). Phosphorylated proteins are referred to as phosphoproteins. The chemical reaction that gives product X i from substrate X 0 i is known as phosphorylation and is catalysed by kinases X E (E 2 E i ). We consider the case in which the kinases themselves are phosphoproteins (if phosphorylation is not driven by a kinase in V, we set E i  ;). The ability of a kinase E 2 E i to catalyse phosphorylation of X i may be tempered by inhibitors X I (I 2 I i;E & V; the double subscript indicates that inhibition is specific to both substrate and kinase). Thus the parents i of X i comprise both the kinases and their inhibitors: i  E i [ fI i;E g E2Ei. Because of specificity of phosphorylation reactions, we assume that the underlying network G is sparse, such that the number of parents i for variate X i is low. An example is shown, using a standard graphical representation, in. In what follows we use X 0 i ; X i to denote the concentrations of proteins X 0 i ; X i , respectively; U i  X 0 i  X i is then the total concentration of protein i, which is taken to be approximately invariant over the timescale of phosphorylation dynamics. For network inference, model selection will take place over parent sets i. Accordingly, we require functional equations for any such subset (). We use ODEs of the MichaelisMenten type to provide a suitable class of analytic approximations for phosphorylation dynamics (). The rate of phosphorylation X 0 i ! X i due to kinase X j is given by VX j X 0 i =X 0 i  K, which explicitly acknowledges variation of kinase concentration X j and permits kinase-specific response profiles (parameterized by K) with maximum reaction rate V. Equilibrium analysis of the foregoing kinetic model yields functional relationships between nodes that we use to inform analysis of steady-state data. The seminal example of Goldbeter and Koshland (1981) considered phosphorylation by a single enzyme (X E ) and dephosphorylation by a single phosphatase (X P ), which at equilibrium satisfy the balance equationis capable of expressing a range of biologically relevant non-linearities. In this work, we extend the class of molecular regulatory mechanisms by entertaining multiple kinases along with multiple kinase inhibitors. For simplicity, we assert that all kinases act independently and that all kinase inhibition occurs competitively. In particular we do not consider complex interactions between these regulators, such as cooperativity. Competitive inhibition requires that substrate (X 0 i ) and inhibitor (X I ) compete for the same binding site on the enzyme (X E ):When multiple inhibitors (I; I0) are present, they are assumed to act exclusively, competing for the same binding site on the enzyme:Mathematically, competitive inhibition by exclusive inhibitors corresponds to rescaling of the MichaelisMenten parameterwhere the sum runs over inhibitors I of the kinase E. (The interested reader is referred to Leskovac (2003) for further details.) Phosphatase specificity is currently poorly characterized compared with kinase specificity, so our analysis does not attempt to cover this level of regulation. In particular dephosphorylation is assumed to occur at a rate V 0 X i proportional to the amount of phosphoprotein. Collecting together our modelling assumptions and solving the resulting balance equation produces a functional model class F , with member functions f i 2 F given byHere, the parameter vector h i contains the maximum rates (V) and MichaelisMenten constants (K) specific to phosphorylation of species i (dependence of V, K on i is notationally suppressed for clarity).When E i  ; we instead define f i  i , equal to the average phosphoprotein concentration.
Statistical formulationThe GoldbeterKoshland model (5) gives a general form for the functional relationship between nodes at steady-state. Inference proceeds based on a Bayesian formulation of this model (). Consider independent observations of protein expression obtained at equilibrium with respect to phosphorylation dynamics. To fix a characteristic scale, all data are scale normalized prior to inference, such that each species has unit mean. For a given protein i, a model M i for phosphorylation describes putative kinases E i and associated inhibitors I i;E (E 2 E i ) for protein i (note that M i contains more information than the subset i , namely the specific mechanistic roles played by each variable in i ). Then, conditional on M i and parameters i we have the following statistical modelwhere " i $ N0; 2 i . Here, the error term " i absorbs contributions from observation error and model misspecification, with the logarithm of both predictor and response taken to improve the normality assumption. In the Bayesian setting, prior probability distributions are required for parameters i and models M i. For the parameters h i  V; K; , which we have augmented with (as with the other parameters, we drop the subscript i on for clarity), physical considerations require that V j , K j , 4 0. Following, we postulate that all biological processes must occur on an observable timescale, motivating, in the shape, scale parametrization, the gamma priors V $ (2,1/2), K $ (2, 1/2), each of unit mean and variance 1/2. The noise parameter is inverse-gamma distributed a priori as $ -1 (6,1), with prior mean 1/5 and variance 1/100 chosen to correspond to the magnitude of measurement noise in current proteomic technologies (). When expert opinion is available, rich subjective model priors may be elicited (see e.g. for graphical models,), but for this work we employed an objective prior, depending on a (possibly empty) prior model M 0 i. Prior specification should account for the distinct roles of kinases and inhibitors; a mathematical formulation is described in the Supplementary Information.
Reversible jump Markov chain Monte CarloInference over networks was carried out using Markov chain Monte Carlo (MCMC). For linear and discrete models, marginal likelihoods are typically available in closed form. Then, sampling needs only to explore the model space (see e.g.). However, in the present, non-linear setting parameters cannot be integrated out analytically, motivating theneed to sample over the joint space of models and parameters. Furthermore, the dimension of the model is not fixed, as the number of parameters dimh M  depends on the modelwhere parameters M (k) for model M (k) belong to  k and  denotes the Cartesian product. The reversible-jump sampler constructs an ergodic Markov chain on S which has, as its stationary distribution, the posterior probability distribution psjD; s 2 S. In particular the marginal pkjD over the model index k 2 K corresponds exactly to the posterior model probabilities pM k jD. Construction of an efficient RJMCMC sampler requires an intuition for the across-model state space. We adopt a deliberately transparent Metropolis-within-Gibbs approach (), updating one coordinate of S at a time using a MetropolisHastings accept/reject probability of the form s; s0  min1; As; s0pDjs0=pDjs. A number of distinct proposal mechanisms were employed to ensure ergodicity and provide rapid mixing. Precise details of the proposals used, along with their associated ratios As; s0 may be found in the Supplementary Information. For applications, 30 000 iterations of the Gibbs sampler were performed, with 5000 discarded as burn-in. Convergence was assessed using repeated runs from dispersed initial conditions.
RESULTSIn this section, we empirically assess our methodology and compare its performance against network inference based on the linear model. In Section 3.1, we show results using a recently published dynamical model of the MAPK signalling pathway due to, where the underlying network is known exactly. In Section 3.2, we apply our approach to a real proteomic dataset. In both cases, for fair comparison between different methods, no informative model priors were used (i.e. we set 8i; M 0 i  ;).
Simulation studyData were generated from a computational model of the MAPK signaling pathway due to, specified by a system of 25 non-linear ODEs (). The simulation gives covariates that are highly correlated at equilibrium, as would be expected in practice, while providing a known network G for evaluation purposes. Further details regarding the computational model are described in the Supplementary Information. We introduced independent Gaussian measurement noise, additive on the log scale, of magnitude  0.2, similar to error incurred by current proteomic technologies (). We benchmarked our approach against the linear-additiveGaussian formulation logX i  $ N1 0  D M M ; 2 I with design matrix D M  .. . logX j . . . j2 M and intercept 0 ; the logarithm of a vector is taken component wise. All variables were mean-variance standardized prior to inference. We consider two standard approaches to inference for the linear model, namely (i) the LASSO with penalty parameter set according to cross validation ('Lin. Lasso') and(ii) a conjugate Bayesian formulation, based on the g-prior M $ N0; n 2 D 0 M D M  1 , with a flat prior over the intercept p( 0 )!1 and reference prior over the noise p()!1/. For the Bayesian approach, we took a model prior p(M) to be uniform over in-degree d  dimb M  with the restriction d 3. Model averaging was then used to obtain posterior inclusion probabilities. For each of the linear approaches (i) and (ii) we also considered adjusted variants ('Lin. Lasso Adj.' and 'Lin. Bayes Adj.') where log-phospho-ratios logX i =U i  constitute the response; this can be motivated as a simple first order correction for variation in total protein levels. For each phosphorylated or active species i in the computational model, we sought to infer the parents i. For a fair comparison with the linear approaches, which do not ascribe functional roles to variables, we did not distinguish between kinases and inhibitors during assessment. The resulting receiver operating characteristic (ROC) curves are shown in.). Circles represent proteins, and rectangles represent interventions (drug treatments) used to perturb the system. For proteins, one strike-through represents inactivity, and two strikes represent degradation. (b) Average receiver operating characteristic (ROC) curves (sample size n  24, noise  0.2, see text for details) using data generated from model (a).Overall performance was quantified using area under the ROC curve (AUR), aggregated over all i2V. Results are shown over 10 datasets D for each of various combinations of sample size n and noise level (). In all regimes, our approach outperformed linear approaches; the latter did not perform well even in this low dimensional example. We note also that even in the least challenging regime (n  24,  0), none of the approaches were able to perfectly recover the entire network G. The adjusted regressions, which model the log-phospho-ratio as the response, did not outperform the standard linear regressions.
Cancer proteomic dataData were obtained using reverse-phase protein arrays [RPPA;] applied to a panel of breast cancer cell lines (). Data D comprised equilibrium observations for p  38 phosphorylated proteins, in addition to their unphosphoryated counterparts (). Cell lines belong to two biologically distinct subtypes known as basal (n  22) and luminal (n  21), with each member cell line comprising one sample. The true data-generating network is not known for biological samples, but for certain nodes, the relevant kinase substrate relationships have been described in considerable mechanistic detail in the literature. To minimize the risk of comparing results of inference against an incorrect literature model, we focused attention on selected nodes in the data for each of whom the key kinase is well established. For example, the protein S6 is known to be phosphorylated via the kinase activity of p70 S6 Kinase (p70S6K); both proteins are included in our assay. Treating S6 as the target (i.e. the network child), we scored each of the remaining 37 proteins as a candidate regulator (i.e. for inclusion in the parent set S6 ) using each method.displays the result of inference for the parents of S6 (S6 is phosphorylated on amino acid residues Serine 235 236; results for basal subtype shown and measurements of S6 phosphorylation on residues Serine 240 244 were excluded since this correlates closely with phosphorylation on Serine 235 236). Despite the known well-established regulatory role for p70S6K, it is striking that only our approach ranks p70S6K highly. The LASSO approaches ascribe no weight to the correct kinase in this case. To gain more insight into the assignment of weights by the competing methodologies, we constructed scatter plots comparing weight distributions (). It is immediately clear that the weight assignments vary markedly between basal and luminal subtypes. In addition, it is noticeable that there is little agreement between the apparently similar linear formulations. We extended this investigation to several other key signalling players whose regulation is well understood (). Overall, we find that the proposed approach outperforms the linear methods.
DISCUSSION AND CONCLUSIONSIn this work, we investigated integration of biochemical mechanisms into network inference for steady-state data. We focused on protein phosphorylation, a key biochemical process where the availability of relatively sophisticated simulation models, extent of existing mechanistic insight and availability of relevant proteomic data combine to facilitate assessment of network inference approaches. Our results, on simulated and real data, demonstrated that protein signalling network topology may be estimated more successfully under our approach than by conventional linear formulations. The linear approaches we used were outperformed on simulated data and failed to identify knownregulation in real data. In addition to superior performance, a chemical formulation ascribes mechanistic roles to variables and may increase interpretability. In complementary work, Oates and Mukherjee (2012b) consider the use of nonlinear chemical kinetics for network inference using time-course data, reporting that a chemical formulation outperformed a number of mechanismfree approaches, including non-parametric models. Estimation of dynamical parameters in the presence of structural uncertainty remains an open area and an important topic for future work. Here, although we sampled both networks and parameters jointly, we focused exclusively on network inference. It remains unclear how to report kinetic parameter estimates in the presence of structural uncertainty. One approach would be to first fix a network and subsequently estimate the associated dynamics. However, this has the disadvantage of relying on a 'point estimate' of the network and therefore being sensitive to network misspecification. This is especially relevant in the small sample setting where typically no one model will capture substantial posterior mass. Alternatively, one could estimate the total effect of an interaction by averaging over all models. This relates to ideas in causal inference for graphical models () but has the disadvantage that the resulting 'total effect' may lack a natural chemical interpretation. It is important to note that the chemical formulations considered here are not fully identifiable with respect to parameters. Indeed, the maximal reaction rates V E are identifiable only up to an unknown normalizing constant V 0 , whereas the Michaelis Menten parameters K E are known to be only weakly identifiable (). Nevertheless, the model structure M itself remains identifiable in this setting (Supplementary Information). Our empirical results on simulated and real data provide examples where structural inference, using the formulation we propose, is possible under realistic conditions. However, factors including model mis-specification and missing variables (see e.g.) may limit structural identifiability in general. Indeed, we found that all approaches performed poorly on luminal cell lines in our real proteomic data example (Supplementary Information). Therefore, results of structural inference should be interpreted with caution and treated as hypotheses to be tested experimentally. We did not consider an explicit observation model. Because of the nonlinear nature of the GoldbeterKoshland formulation, formal uncertainty propagation would be highly nontrivial for our model. Assuming log-normal observation error and neglecting predictor uncertainty, we arrived at the statistical model in Equation (6). In this sense, our formulation may be regarded as an approximation to inference under an explicit log-normal observation model. An interesting avenue for further research would be to make explicit the observation process. Network inference is naturally facilitated by interventional experiments; however, adequate modelling of the effects of intervention is important to ameliorate statistical confounding (). Within a chemical kinetic framework, such factors may be naturally accounted for; for instance, a 'perfect' intervention simply corresponds to removal of the targeted species from the chemical model. Network inference based on non-linear models is computationally challenging. We considered low-to-moderate dimensional settings (p  12, 38), for which RJMCMC proved to be effective. The computations in this article are parallelizable, and it may therefore be possible to extend this work to the high-dimensional setting. In general, non-linear approaches are clearly more burdensome than their linear counterparts, where highly efficient approaches, including those based on LASSO and related penalized likelihood schemes, allow rapid estimation even in high dimensions. We therefore view the methods presented here as complementary to variable selection based on linear models, allowing more refined exploration in settings where some insight into underlying dynamics is available. We investigated integration of biochemical mechanisms into network inference. Although the GoldbeterKoshland formulae are invalid at the single-cell level, which is intrinsically stochastic, our results suggest that these deterministic non-linear equations represent a better approximation than the corresponding linear equations. In particular a chemical kinetic formulation is able to account, in a principled way, for variation in total protein levels between samples. Consequently, inferred edges cannot be interpreted as indicators of direct biochemical interaction; rather an edge corresponds to the prediction that intervention on the parent will result in a change in expression of the child, possibly indirectly via unobserved variables. In our real data example, we therefore allowed for candidate species, which are not themselves kinases, such as S6 and p53. For simplicity, we did not consider post-translational modifications such as ubiquitinylation, nor spatial effects such as translocation, nor did we explicitly distinguish between phosphorylation on different residues. The methodology that we presented may be generalized to other molecular mechanisms. In particular alternative mechanisms of enzyme interaction such as non-competitive, uncompetitive, hyperbolic and parabolic inhibition could be readily integrated into our framework.The proposed method was compared with linear approaches using reverse-phase protein array data for nodes whose regulation has been extensively studied in the literature. Each method ranked potential regulators among candidate proteins; here, we display the rank assigned to the known kinase, using each of the five methods. For example,shows such an analysis for the target node (i.e. network child) S6, where G.K. Kinetics ranked the known kinase p70S6K 1st out of a total of 36 candidates. High rank indicates that the known kinase is correctly highlighted in the analysis; the highest-ranked result is highlighted in bold for each target node. Here, we show the rank assigned to the known kinase for each of the target nodes Akt, p70S6k, S6 and p53. ('NA' indicates that the known kinase received zero weight. Alternative phospho-forms of the target were excluded as candidates for Akt and S6, so that there were 36 candidates rather than 37. Here, we present results obtained using data from cell lines of basal subtype; luminal results are shown in Supplementary Information.)
The Author 2012. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions.com. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
Network Inference using steady-state data and Goldbeterkoshland kinetics at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
C.J.Oates et al. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
