Motivation: Paired-end whole transcriptome sequencing provides evidence for fusion transcripts. However, due to the repetitiveness of the transcriptome, many reads have multiple high-quality mappings. Previous methods to find gene fusions either ignored these reads or required additional longer single reads. This can obscure up to 30% of fusions and unnecessarily discards much of the data. Results: We present a method for using paired-end reads to find fusion transcripts without requiring unique mappings or additional single read sequencing. Using simulated data and data from tumors and cell lines, we show that our method can find fusions with ambiguously mapping read pairs without generating numerous spurious fusions from the many mapping locations.
INTRODUCTIONThe discovery of chimeric transcripts emerging from different and potentially distant genes has introduced another layer of complexity to the genome (). Additionally, the importance of fusion transcripts in the genesis and progression of cancer is becoming increasingly apparent (). Fusion transcripts may be the product of trans-splicing, the joining of two different transcripts emerging from distinct and often distant genes. This is especially common among lower eukaryotes () where trans-splicing is part of normal transcript processing (). However, trans-splicing has also been observed in higher eukaryotes, including humans (). Additionally, fusions may be produced by adjacent genes yielding a single, joined RNA product, creating a read-through transcript (). Fusion transcripts can also result * To whom correspondence should be addressed. from genomic rearrangement that brings together two once distant regions of the genome. Probably the best known example of this type of fusion is BCR-ABL1, a product of a chromosomal translocation () found in many hematologic cancers and a successful drug target (). In addition, a growing list of fusion genes are being found in both hematologic and solid tumors that are the product of genomic lesions or transsplicing (). Thus, the study of fusion transcripts has implications clinically as well for our basic understanding of the genome. The development of high-throughput sequencing methods such as RNA-Seq () has offered an opportunity to hasten a fuller characterization of the transcriptome (), including the identification of fusion transcripts.) demonstrated the potential of the technology by applying transcriptome sequencing to several tumors and cancer cell lines. Using two different sequencing protocols, they were able to detect known fusions such as TMPRSS2-ERG () in a prostate cancer cell line and BCR-ABL1 in a leukemia cell line. Additionally, they identified and experimentally confirmed multiple previously unidentified fusions. Later,carried out similar work on the melanoma transcriptome, finding 11 novel fusions. Alongside these biological discoveries has been the development of computational tools and frameworks for the detection of fusion transcripts from RNA-Seq data.developed a method for joining partial alignments of single RNA-Seq reads to find splice junctions and gene fusions. Upon application of the method to a public dataset, they found hundreds of examples of transcripts that apparently spanned different chromosomes but were doubtful that many were genuine fusion genes.created a probabilistic method for aligning RNA-Seq read pairs that uses expectationmaximization (EM) to find maximum-likelihood alignments. They showed that paired-end reads better cover splice junctions than single reads and that their method can reliably identify splice junctions. Then, by augmenting their approach with long single reads, they were able to identify 18 gene fusions in two cancer cell lines. Common to all of these efforts has been the requirement that a fusion transcript be supported by reads that map uniquely to the genome or transcriptome. Maher and colleagues required single best-hit mappings to the genome or mapped short, 36 nt Illumina. A read pair that maps to a fusion between genes A1 and B1 may also map to homologous genes, leading either to spurious fusion candidates or the elimination of read pairs supporting a true fusion from consideration. paired-end reads to sequences derived from 230 nt Roche 454 reads.required paired-end reads to map uniquely and at least one end of a read to unambiguously map to a junction between exons.required each partial alignment for each read to be unique.considered fusion discovery with short paired-end reads infeasible and found putative fusions with uniquely mapping 75 nt single reads. These strategies highlight a key difficulty in the analysis of transcriptome sequencing data: the transcriptome is filled with repetitive and similar sequences, and many reads cannot be unambiguously mapped to a reference. Some of the repetitiveness is attributable to known repeat families such as the Alu repeat sequence, which can be found both in 5and 3-UTRs as well as occasionally in coding sequence (). Additionally, many genes are part of gene families or have paralogs or expressed pseudogenes and thus share sequence homology with other parts of the transcriptome. Reads mapping to these genes or regions of these genes will often map well to other loci. Ambiguously mapped reads are a concern for all transcriptome sequencing analyses and have previously been addressed by discarding them () or by proportionately allocating them over the different positions to which they map (). However, this issue becomes more prominent for gene fusions because combinations of mappings are considered. Consider, for example, a fusion between a pair of genes, A1 and B1. It is possible that a read pair that maps to this fusion will also map to paralogs of each gene, say A2 and B2. If all of these mappings were accepted as true, then three spurious fusions would be called (). If the read pair was discarded because of its ambiguous mappings, evidence for the true fusion would be disregarded. As we detail below, our simulations indicate that these ambiguously mapping reads are present in up to 30% of the possible gene fusions, underscoring the significance of the problem. In this article, we propose a method to discover fusion transcripts that exploits ambiguously mapping RNA-Seq read pairs, does not require additional long, 75 nt or greater, single read sequencing and decreases the occurrence of mapping artifacts. We begin by mapping read pairs to the transcriptome independently without imposing any unique-mappability criterion. We then find pairs which do not map to the same gene and build a set of possible gene fusions from the mappings of each read. Next, we employ a generative model of RNA-Seq data that utilizes mapping qualities and insert size distributions to resolve any ambiguous mappings. After the convergence of the EM technique used to find maximum-likelihood transcript abundances, we perform a final partial expectation step for the discordantly mapping read pairs to find optimal fusion assignments for pairs that span fusion junctions. In this way, rather than discarding ambiguously mapping read pairs or allowing them to overstate the number of fusions present, we find the best supported fusions by using the mappings of all the reads in the dataset, the quality of those mappings and the implied insert sizes of read pairs that span a fusion site. This allows our method to more sensitively detect gene fusions than if ambiguously mapping read pairs were discarded. We have implemented our method on simulated data generated from fusions between genes with very high similarity to other genes to demonstrate that our method can resolve the ambiguous mappings to find the correct fusions when it is possible to do so. We then implemented it on reads derived from neoplastic and hyperplastic prostate tissue and recovered the known TMPRSS2ERG fusion along with several read-through fusions without finding many spurious, poorly supported fusions as a result of allowing reads to have many mappings. Finally, using publicly available data from several melanoma tumors and cell lines, we find fusion events that would not be detectable without allowing for multimapping reads that span the fusion site.
Fusion detection using ambiguous read pairs
METHODS
Discovery of putative fusionsThe first step of our method is to map each read of a pair independently. We use Bowtie () in single-end mode to perform this mapping against a database of RefSeq transcripts () that have been prepended with 50 nt of upstream sequence and appended with string of adenines to account for variation in transcription start site and polyadenylation, respectively. Filtering the mapping results yields a set of read pairs that only map discordantly to different genes. Then, to decrease the possibility of generating inauthentic fusions as a result of SNPs or mapping or annotation errors, we map these discordant read pairs to the genome and transcriptome, and we greatly relax the stringency of reported mappings and allow for many mappings to be reported for each read. For the experiments in this study, we use the Bowtie flags-l 22-e 350-y-a-m 5000. These flags cause Bowtie to report all mappings for each read, to try as hard as possible to find valid mappings and to suppress mappings with more than two mismatches in the first 22 bases, summed quality values at all mismatched positions greater than 350 or mappings from reads with more than 5000 reportable mappings. With these less stringent mappings, we check if each pair of reads both map within the genomic bounds of a known gene or within 10 kb of each other in a region of the genome with no annotated genes. This filtering step decreases the possibility of events such as retained introns or unannotated transcripts being mistakenly called as gene fusions. After these filtering steps, we consider each pair of genes to which at least two read pairs map discordantly with fewer than three mismatches. Our aim is to determine which exons from each gene should comprise a putative fusion transcript. Combinations of exons are required to satisfy three conditions. First, all exons upstream of the junction site in the upstream gene isoform and all exons downstream of the junction site in the downstream gene isoform must be included. Hence, infusion 4, exon 4 from gene A could not be included without also including exon 3. Second, all exons to which a read maps must be included. For example, in, exons 1 and 2 from gene A must be included because reads map to them. Third, the implied insert size of any read pair should not be unreasonably large given the known insert size used for sequencing. For example, inlarge. To decrease the sensitivity of otherwise acceptable exon combinations to occasional abnormally long insert sizes, we allow one-tenth of read pairs to violate this third criterion. While there are certain types of fusions that would not meet these criteria, say a fusion with multiple, similarly expressed isoforms that vary near the fusion site, we find that these criteria effectively eliminate many spurious fusions without losing sensitivity to bona fide ones. Usually, there are multiple combinations of exons from each gene pair that satisfy the above criteria. To enumerate them efficiently, we find every pair of RefSeq isoforms from each gene pair that is supported by at least two discordantly mapping read pairs. For each isoform pair, we build a directed graph of their exon structures augmented with edges that connect each exon in the upstream isoform to each exon in the downstream isoform (). Then, we search for paths from the beginning of the upstream isoform to the end of the downstream isoform by implementing a depth-limited search:Input: A node representing an exon, a path through the exon graph, and a set of reads mapping to the exons.DLS is initially called with the root node S, an empty path and the set of discordantly mapping read pairs for the isoform pair. It then proceeds through the graph in a depth-first fashion. At each node, it checks if there are reads mapping to that node and opens or closes each read pair appropriately, keeping track of the state of each pair independently. If a read maps to a splice junction, the inner boundary of the mapping is used to determine the exon to which it maps. When a read maps to an exon, only the appropriate portionof the exon's length is added to the implied insert size in line 9. The directed edges of the graph ensure that the first criterion above is met. The second and third criteria are ensured explicitly in lines 1 and 2 and lines 10 and 11, respectively. Since the depth of any search path is limited, this procedure can efficiently discover fusions that meet our desired criteria. In addition, to better facilitate the detection of read-through transcripts, the 3 exon of the upstream gene and the 5 exon of the downstream gene do not contribute to the reads' implied insert sizes. This follows from our observation that these exons often appear truncated in read-through fusions. Finally, since different isoforms of the same gene mostly contain the same exons, duplicate exon sets can be generated by calling DLS on different isoforms. These duplicates are removed before proceeding to the next step.
Mapping to augmented referenceAfter the set of putative fusions are generated, the sequence for each is generated and added to the original set of transcripts from RefSeq. Then, the read pairs are mapped to this augmented reference. Unlike the previous mapping, Bowtie is used in paired-end mode and the default mapping stringencies are used except that up to 1500 possible mappings for each paired-end read are allowed. While the addition of the putative fusion sequences may result in the addition of thousands of additional transcripts to the reference, the total amount of sequence in the augmented reference remains smaller than the genome, and the mapping can still be carried out on a standard desktop computer. After mapping, we proceed, as discussed below, to ranking fusions based on coverage.
Model of paired-end RNA-Seq dataWe extend the generative model ofto develop a probabilistic model for generating read pairs (). We reason that a read pair is generated in four steps. First the transcript from which the pair will come, t n , is chosen. Then the starting point for the upstream read, s n , within that transcript is chosen; then the end point for the downstream read, e n , is chosen. Finally, errors are introduced and the final read pair is observed. As we only observe reads, we can consider transcript choice, starting position, ending position and read error to be hidden variables. The likelihood of a collection of read pairs, and specific values of the hidden variables can be expressed as a function of the true transcript nucleotide abundances:Each term in this equation can be calculated in a straightforward way. The probability of a transcript t being chosen is the relative nucleotide abundance of that transcript, that is, the fraction of all nucleotides that are part of that transcript. Thus, P(t n |) =  t. Assuming that each base within a transcript is equally likely to be the starting point of the upstream read, the probability of a particular starting point is the inverse of the length of the transcript t :The choice of the ending point depends on the distribution of insert sizes used for sequencing and the starting point. We use d(|s n e n |) toindicate the value of the insert size distribution for the distance between the start and end points, which we empirically determine from the read pairs that map concordantly. Finally, the probability of a read being observed from a given transcriptomic locus can be calculated using matches and mismatches between the read sequence and the reference transcriptome and the quality values of the bases in the read (). We denote this probability as (r n ,t n ,s n ,e n ). To expand the probability distribution to N read pairs, we take the product of values for individual reads.
Fusion detection using ambiguous read pairsFinally, the probability of our observed variable, the read pairs, given the transcript abundances can be calculated by summing over the values of the hidden variables.We seek to find the set of transcript abundances, , that maximizes this probability by applying EM to the results of the paired-end mapping to the reference augmented with the putative fusions.
EMFor consistency, we use notation similar to that used by. Let). Then, as the first step of the EM algorithm, we find the expected values of Z nijk given the observed reads and the current estimate of .Then, the E-step consists of calculating the log-likelihood weighted by these values.The values for  (t+1) are then found by finding the  that maximizes this function subject to the constraint M i=1  i = 1 using Lagrange multipliers.Equating all of these terms to zero, we have This procedure is repeated until convergence. We make the probability calculations tractable by only considering, for each read, the values of t, s and e reported by short read mapping software and assuming the probability of the read coming from any other position to be zero.
Calculating mappings to fusion junctionsAfter convergence of the EM algorithm, we have an estimate of the maximum-likelihood abundances for each transcript, including all of the putative fusion transcripts. These abundances reflect the resolution of read mapping ambiguity, as demonstrated by the successful elimination of many spurious fusions in the results below. However, they do not yet account for potential unevenness of coverage across a given transcript. In particular, they can be confounded by a fusion transcript with high coverage everywhere but the fusion site. To illustrate this issue, consider the situation illustrated in. We have three reference transcripts: Gene A, Gene B and a fusion gene created by concatenating Genes A and B. We also have three sets of read pairs: N A pairs that map to Gene A and the fusion gene, N B pairs that map to Gene B and the fusion gene and N F pairs that only map to the fusion gene. For simplicity, assume that the values of (r n ,t n ,s n ,e n ) = 1 and d(|s n e n |) = 1 for each mapping of each read pair and the length of both Genes A and B is 1. Then, the probability of the observed data isIf we further assume that N A = N B and therefore  A =  B , and use the fact that the sum of the transcript abundances must be 1, we have thatThen, the probability of the observed data becomesThis expression is maximized by setting  F to 1, which sets  A and  B to zero. So, if there is a single read pair that spans the fusion site in this scenario, all abundance is transferred to the fusion transcript regardless of how large N A and N B may be in relation to N F. While this example has been rather stringently defined for sake of demonstration, a similar situation occurs whenever N F > 0 and N A >> N F or N B >> N F : an unreasonable abundance is assigned to the fusion transcript based on reads that do not map to the fusion site. In the context of seeking fusions, this means a fusion between highly expressed genes supported by a single read pair, perhaps an experimental artifact, will dominate other putative fusions in abundance. To avoid this, rather than simply using the maximum-likelihood abundances, we calculate the sum of the expected values of Z nijk for each fusion transcript i for read Page: 1072 10681075
M.Kinsella et al.pairs that span the fusion junction to get a probabilistically weighted count of reads supporting the fusion, C i .This retains the ambiguity resolution described above but focuses the abundance estimates on fusions. As a final filtering step to eliminate experimental artifacts, we find the mean physical coverage, that is, the coverage counting both the reads and the insert, for the upstream and downstream genes in the fusion separately and compare each of them to the physical coverage at the fusion site. If coverage at the fusion site is less than one-twentieth of the upstream and downstream coverage, we discard the fusion as a probable artifact based on the same reasoning discussed above. We also discard fusions where all reads have the sequence of an RNA component of the spliceosome, U1 through U6, as these are likely produced artifactually as well.
RESULTS
Fusion transcripts generate ambiguous readsTo quantify the prevalence of ambiguously mapping read pairs and the extent to which discarding them would impact fusion discovery, we simulated gene fusions by randomly selecting a pair of transcripts from RefSeq and the exon within each transcript that would serve as the fusion breakpoint. For each fusion, we generated, with random errors based on quality scores from an existing dataset, the full set of read pairs that could span it given a constant insert size. We then mapped each of these reads and tabulated the number of read pairs with unique mappings that satisfy default Bowtie mapping criteria (). We repeated this for several read lengths, generating 100 000 simulated fusions for each read length, while keeping the insert between the two reads at 200 nt. For each read length, we calculated the fraction of partially ambiguous fusions and totally ambiguous fusions, that is, fusions where some, but not all, of the reads supporting them mapped ambiguously and fusions that only generated ambiguously mapping read pairs. As expected, the fraction of ambiguous fusions declined as read length increased. At a read length of 50 nt, nearly 1 in 20 fusions would only be detectable via ambiguously mapping read pairs (, Supplementary). Even at a read length of 100 nt, over a 10-th of all fusions were able to generate an ambiguously mapping read pair. These results suggest that even as read lengths increase, a significant portion of fusions remain difficult to detect if read pairs are required to map unambiguously.
Resolving ambiguous simulated fusionsTo demonstrate the capability of our method to find gene fusions between highly repetitive regions of the transcriptome using multimapping read pairs, we simulated five fusion genes, outlined in, derived from possible fusions between genes that share homology with other parts of the transcriptome. Then, 10 000 pairs of 40 nt reads were generated from these five fusions using MAQ () in simulate mode with insert size set to 200 nt. Sequencing errors and quality values were modeled from an existing dataset, and the MAQ simulation code was modified to produce a distribution of different expression levels for each transcript so performance over a range of coverage levels could be examined. As a comparison, the coverage levels used in the simulation would correspond to a range of 8 FPKM for MAGED4-MBD3L2 to 80 FPKM for FOXO3-EIF3CL in a 20 M read pair sequencing experiment. Thus, the simulated coverages provide a reasonable range on which to evaluate the performance of our method. Mapping the 10 000 read pairs to RefSeq transcripts yielded 395 pairs that mapped only discordantly. As expected, all these discordantly mapping pairs mapped to multiple genomic loci and thus suggested multiple fusion candidates. Each discordant read pair is mapped, on average, to seven different pairs of genes, and in some cases mapped to as many as 22. The total number of fusion genes that would be nominated by navely accepting all discordant mappings was 56 (Supplementary). Applying the filtering and fusion discovery process described in the Section 2.1 yielded 252 putative fusion transcripts. The high number reflects both the multiple gene pairs to which the discordant read pairs mapped and the multiple sets of exons from each gene pair that could be consistent with the discordant mappings. After allowing the estimate of the maximum-likelihood transcript abundances to converge, only 12 of the 252 nominated fusion transcripts had at least two read pairs assigned to its junction site. Those 12 transcripts represent 7 potential fusion genes (). All five of the fusions from which the data were generated are included in the results. In addition, two spurious fusions are reported. The results include a fusion between FOXO3 and EIF3C in addition to the true fusion between FOXO3 and EIF3CL. However, this is not a failing of the algorithm. The sequences of EIF3C and EIF3CL are very nearly identical; depending on which isoform of each gene is considered, they differ at most by several bases at the end of their 3 exons. So, every read that maps to the fusion of FOXO3 and EIF3CL also maps to the fusion of FOXO3 and EIF3C. Rather than discard these reads, the algorithm simply preserved this unresolvable uncertainty and divided them between the two fusions according to values obtained from the probabilistic model. Similarly, SMN1 and SMN2 are nearly indistinguishable. Thus, using only ambiguously mapping read pairs, our method recovered the five true fusions, eliminated 49 spurious
Fusion detection using ambiguous read pairs
Application to a prostate tissue transcriptome dataWe applied our method to two datasets derived from tissue resected from an individual with prostate cancer. The first dataset consisted of 18 027 834 pairs of 40 nt reads from neoplastic tissue. The second was 21 978 463 read pairs from adjacent hyperplastic tissue. Of the neoplasia read pairs, 18 177 had only discordant mappings and mapped to 127 102 gene pairs. Of the hyperplasia read pairs, 24 569 had only discordant mappings and mapped to 266 571 gene pairs. Application of the filtering and fusion discovery process described above yielded 887 and 746 putative fusion transcripts for neoplasia and hyperplasia, respectively. After estimating transcript abundances, only 15 fusion transcripts from the neoplasia data had at least two reads assigned to its junction site (). The top result, a fusion between TMPRSS2 and ERG, is a known recurrent fusion in prostate cancer (). A novel fusion between GRHL2 and SNTG1 was also reported. These genes lie about 50 Mb apart on chromosome 8. Intriguingly, there is a short sequence shared by both sequences at the site of the fusion (Supplementary), potentially providing a clue to the origin of the chimera (). The remaining results were read-through transcripts present in existing EST databases ().In sharp contrast to the neoplasia results, the hyperplasia data showed no evidence of a fusion between TMPRSS2 and ERG (). This is consistent with the central role that the TMPRSS2-ERG fusion is suspected to play in the progression of prostate cancer (). Beyond this critical difference, the results largely mirrored those from neoplasia. There was one novel read-through transcript reported, RPL7-LOC100130301, and multiple previously reported read-throughs: AZGP1-GJC3, SPINT2-C19orf33, DHRS1-RABGGTA, TMEM203-C9orf75 and IRF6-C1orf74. The large number of potential fusions suggested by a nave examination of discordant reads, over 100 000 in each dataset, underscores the complexity of the transcriptome and the often muddled nature of experimentally derived transcriptomic sequencing data. We were gratified that our method was able to discard nearly all of these inauthentic fusions while retaining those of biological importance.
Discovery of novel ambiguous fusionsTo demonstrate the ability of our method to make new discoveries, we analyzed two publicly available datasets. The first was transcriptome sequencing of a set of melanoma tumors and cell lines originally published by. The second was sequencing of Stratagene's Universal Human Reference RNA (UHR), a reference composed of RNA from 10 cell lines originally published by. Analysis of these data with our method yielded numerous fusions, including all of the fusions reported by Berger and numerous fusions known to be present in UHR including BCR-ABL1, BCAS4-BCAS3 and GAS6-RASA3 (Supplementary). In addition, we found five fusion transcripts where some or all of the read pairs mapping to them also mapped to other potential fusions (). In each case, the ambiguity was due to genomic duplications. Some reads mapping to the MYH6 side of the HOMEZ-MYH6 fusion also mapped to MYH6's paralog, MYH7 (). The remaining ambiguous fusions were due to recent segmental duplications. The fusion between CPEB1 and RPS17 was clearly a read-through, but was confounded by the presence of another copy of RPS17 in an upstream segmental duplication (). KIAA1267-ARL17A was similarly made ambiguous by multiple copies of ARL17. The fusions between PPIP5K1-CATSPER2 and TRIM16L-FBXW10 were confounded by mappings to CATSPER2P1 and TRIM16-CDRT1. The sequence of each fusion is available in Supplementary. These findings confirm that additional fusions can be detected in tumors when ambiguously mapping read pairs are included in the analysis.
Page: 1074 10681075
M.Kinsella et al.
DISCUSSIONIn this article, we have demonstrated a method to use discordantly and often ambiguously mapping RNA-Seq read pairs to identify fusion transcripts. In doing so, we bring the increasingly sophisticated methods employed to estimate transcript abundance in the presence of multimapping reads to the problem of fusion discovery. In contrast to previously proposed methods for fusion identification that focus on reads that map to the junction between two genes (), our method estimates fusion transcript abundances by considering physical coverage over the entire length of the proposed fusion. In addition, it employs several filters to minimize experimental artifacts. Finally, it does not require that any single read sequence hit the point of fusion. Instead, it uses implied insert sizes and known exon boundaries to determine the most likely point of fusion. This would be a liability if a fusion transcript contained partial exons, but reported fusions to date suggest that a vast majority of fusions do indeed involve the joining of whole exons from different genes, the breakpoints occurring in introns and the splice sites remaining unchanged (). Several avenues for future development are apparent from this work. Here, we chose to use RefSeq transcripts as the reference against which reads are mapped. This allowed us to avoid the issue of reads that map to splice junctions because the splice junction sequence would be contiguous in the transcript sequence. However, it prevents us from identifying transcripts that are produced by novel or aberrant splicing, which is common in cancer (), or are significantly altered by RNA editing (). It may be fruitful to combine the approach described here with methods that identify splice junctions and expressed regions of the genome de novo (). Additionally, fusion transcript discovery shares many parallels with the problem of resolving genomic rearrangements, especially the challenges of repetitive sequence. The adaptation of the methods developed here to genomic sequencing may prove useful in this related field.
The Author 2011. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oup.com at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
