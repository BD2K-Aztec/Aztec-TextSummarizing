Motivation: DIYABC is a software package for a comprehensive analysis of population history using approximate Bayesian computation on DNA polymorphism data. Version 2.0 implements a number of new features and analytical methods. It allows (i) the analysis of single nucleotide polymorphism data at large number of loci, apart from micro-satellite and DNA sequence data, (ii) efficient Bayesian model choice using linear discriminant analysis on summary statistics and (iii) the serial launching of multiple post-processing analyses. DIYABC v2.0 also includes a user-friendly graphical interface with various new options. It can be run on three operating systems: GNU/Linux, Microsoft Windows and Apple Os X. Availability: Freely available with a detailed notice document and example projects to academic users at
INTRODUCTIONOne prospect of current biology is that molecular data will help us to reveal the complex demographic processes that have acted on natural populations. The extensive availability of various molecular markers and increased computer power has promoted the development of inferential methods. Among these novel methods, approximate Bayesian computation (ABC) method () is increasingly used to make inferences from large datasets for complex models in various research fields, including population and evolutionary biology. General statistical features, practical aspects and applications of ABC in evolutionary biology have been reviewed in three recent papers (). Briefly, ABC constitutes a recent approach to carrying out model-based inference in a Bayesian setting in which model likelihoods are difficult to calculate (due to the complexity of the models considered) and must be estimated by massive simulations. In ABC, the posterior probabilities of different models and/or the posterior distributions of the demographic parameters under a given model are determined by measuring the similarity between the observed dataset (i.e. the target) and a large number of simulated datasets; all raw datasets (i.e. multilocus genotypes or individual sequences) are summarized by statistics, such as mean number of alleles or F st. Several ABC programs have been proposed to provide solutions to non-specialist biologists (; see also Supplementary Appendix S1).) developed the (coalescent based) software DIYABC in which a user-friendly interface helps non-expert users to perform historical inferences using ABC. DIYABC allows considering complex population histories including any combination of population divergence events, admixture events and changes in past population size (with population samples potentially collected at different times). DIYABC can be used to compare competing evolutionary scenarios and quantify their relative support and estimate parameters for one or more scenarios. Eventually, it provides a way to evaluate the amount of confidence that can be put into the various estimations and to achieve model checking computation. In this article, we present DIYABC v2.0, a completely rewritten version of the software DIYABC (). Version 2.0 implements a number of new features and analytical methods allowing extensive analyses of large molecular datasets, including single nucleotide polymorphism (SNP) data.
NEW FEATURES
Analysis of SNP dataDIYABC v2.0 allows analyzing statistically independent SNP markers, apart from microsatellite and DNA sequence data. Compared with other types of markers, SNP loci have low mutation rates, so that polymorphism at such loci results from a single mutation during the whole population gene tree, and genotypes are bi-allelic. To generate a simulated polymorphic dataset at a given SNP locus, we proceeded following the algorithm proposed by Hudson (2002) (cfs 1 option in the program ms associated to). Briefly, the genealogy at a given *To whom correspondence should be addressed.  The Author 2014. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com locus of all genes sampled in all populations of the studied dataset is simulated until the most recent common ancestor according to coalescence theory. Then a single mutation event is put at random on one branch of the genealogy (the branch being chosen with a probability proportional to its length relatively to the total gene tree length). This algorithm provides the simulation efficiency and speed necessary in the context of ABC, where large numbers of simulated datasets including numerous SNP loci have to be generated (see Supplementary Appendix S1 for additional comments on Hudson's algorithm).
Computation of scenario probabilityEstoup et al. (2012) recently proposed a methodological innovation to deal with the discrimination among a large set of complex scenarios through efficient ABC probability computation. It is based on a linear discriminant analysis on summary statistics before the logistic regression analysis (introduced by). A major practical advantage is that it substantially decreases the dimension of explanatory variables making computation of scenario probability (100 times) faster. We have implemented this methodological innovation in DIYABC v2.0 for the analysis of both the real datasets and the simulated pseudo-observed datasets used to evaluate the amount of confidence that can be put into the discrimination of a given set of scenarios.
New graphical interface and random number generatorDIYABC v2.0 has a new user-friendly graphical interface structured into two main parts: (i) one part including the definition of scenarios, prior distributions, summary statistics and the production of simulated datasets drawing parameter values into priors and (ii) other part including all types of post-processing computations typical of ABC analyses. Among the new options proposed, part (i) allows the definition of different groups of markers characterized by different mutation models and summary statistics and part (ii) allows launching serially multiple post-processing analyses (Supplementary Appendix S2). Random number generators (RNG) are an important issue especially when several processors are used simultaneously for parallel computing. In DIYABC v2.0, we used RNG of Mersenne Twister types. In the multithreaded sections of the codes, which require random draws, each thread uses its own random generator. We initiate the different RNG with the algorithm proposed by Matsumoto and Nishimura (2000) to produce independent random streams.
ImplementationDIYABC v2.0 is a multithreaded program that runs on three operating systems: GNU/Linux, Microsoft Windows and Apple Os X. Computational procedures are written in C, and the graphical user interface is based on PyQt, a Python binding of the Qt framework.
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
DISCUSSION One of the main innovations of DIYABC v2.0 is that it can analyze SNP data, using an efficient simulation algorithm, therefore allowing the treatment of multi-population datasets with large number of loci (e.g. several thousands to ten thousands of loci within a few hours to a few days). The analyzed SNP data are assumed to correspond to independent selectively neutral loci, without any ascertainment bias (AB, i.e. the deviations from expected theoretical results due to the SNP discovery process in which a small number of individuals from selected populations are used as discovery panel). AB may distort measures of diversity and possibly change conclusions drawn from these measures in unexpected ways (e.g. Albrechtsen et al., 2010). AB is mainly a concern when using SNP data obtained from chip-based high-throughput genotyping. It should impact to a much lower extent SNP data obtained from recent next-generation sequencing technologies, such as shotgun sequencing or restriction-site associated DNA sequencing techniques that are increasingly popular, including in population genetics studies of non-model species (Davey et al., 2012). See Supplementary Appendix S1 for additional comments on AB. Another advantage of DIYABC v2.0 is that it provides the posterior distributions of demographic parameters scaled either by the mutation rate or by the effective population size, in parallel to those of original parameters. Scaled parameters are sometimes if not often the only type of parameters that can be robustly inferred under many evolutionary scenarios (e.g. Wakeley, 2005). Owing to the compilation optimization of C code and the multithreading of additional computation sections of the program, DIYABC v2.0 is also running faster than the previous version of the program (Supplementary Appendix S3). Finally, the new interface includes an automatic procedure to produce the different files to easily launch simulations on a computer cluster, hence obtaining access to larger computational resources.
J.-M.Cornuet et al. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
DIYABC v2.0 at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
