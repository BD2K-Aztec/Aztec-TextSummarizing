Sequencing by hybridization to oligonucleotides has evolved into an inexpensive, reliable and fast technology for targeted sequencing. Hundreds of human genes can now be sequenced within a day using a single hybridization to a resequencing microarray. However, several issues inherent to these arrays (e.g. cross-hybridization, variable probe/target affinity) cause sequencing errors and have prevented more widespread applications. We developed an R package for resequencing microarray data analysis that integrates a novel statistical algorithm, sequence robust multi-array analysis (SRMA), for rare variant detection with high sensitivity (false negative rate, FNR 5%) and accuracy (false positive rate, FPR 1×10 −5). The SRMA package consists of five modules for quality control, data normalization, single array analysis, multi-array analysis and output analysis. The entire workflow is efficient and identifies rare DNA single nucleotide variations and structural changes such as gene deletions with high accuracy and sensitivity. Availability: http://cran.r-project.org/,
INTRODUCTIONTo understand the specific DNA variants that contribute to the inheritance of human diseases is a major goal of human genetics (). Medical resequencing has greatly accelerated the identification of disease-related DNA variants. Resequencing array technology utilizes differential hybridization of target DNA to oligonucleotide probes to decode individual DNA sequences. It has been successful in identifying novel and very rare variants in disease candidate genes (). However, low-variant frequency (1/1000 bp), variable data quality as well as technical and experimental limitations have the potential to create sequencing errors. There is a need for improved statistical methods for arraybased resequencing. We have recently developed sequence robust multi-array analysis (SRMA) for resequencing array data analysis * To whom correspondence should be addressed.(). By improving preprocessing procedures, borrowing strength across samples and targeting unique features of rare variations, SRMA achieved a false discovery rate of 2% (FPR 1.210 5 , FNR 5%), which is comparable to that of nextgeneration sequencing technologies. Here, we have established an R package (R Development Core) called 'SRMA' that fully implements these methods and provides an automated analysis pipeline for medical resequencing array data with high accuracy of calling rare variants. (System requirements, file structure, package installation, and a description of the analysis of resequencing array data are provided in the Supplementary Material.)
AVAILABLE FUNCTIONALITYWe describe five modules and their principal functions for the resequencing microarray data analysis in. To take full advantage of the SRMA algorithm for rare DNA variant discovery, we recommend using a larger sample size (>20).
Preprocessing of resequencing dataPreprocessing of resequencing data includes two modules: Quality Control and Normalization, and is contingent on the R package 'aroma.affymetrix' () for extracting probe intensities. This step requires raw CEL files and annotation files: a chip description file (CDF) organized by exon units and an aroma cell sequence (ACS) file. In addition, we also require a data frame, mapping amplicons (i.e. fragments generated during amplification experiments) to exons, and a data frame with information of reference alleles for all bases.
Quality control of resequencing dataThe Quality Control module identifies amplicons that are not suitable for base-calling due to failure in target amplification and hybridization. The 'aroma.affymetrix' reads in raw intensities and allows users to perform strand-specific base position normalization within each array. We then calculate three metrics, including the median of the average (log 2 ) probe intensity, median of the log ratios and reference call rate for each amplicon to evaluate the quality of the amplified targets. We use a criterion of R<0.9 () to identify failed amplicons. This criterion can be modified by users.NAs. After quantile normalization at amplicon level across all samples, we calculate the differences () and averages ( ) of log2 transformed intensities of reference match (RM ) and alternative match (AM ) probes; and record the base pair (reference versus alternative alleles) information. The GC content and the length of exons are also calculated here and stored in a data frame.
Data normalization
Analyzing resequencing array data with SRMA
Single array and multi-array analysisSingle array and multi-array analysis of resequencing data are the core components of the SRMA package. Under the assumption that all variants are bi-allelic, we assign one alternative allele to each position and calculate the posterior probabilities of each position for three variant classes: containing no (SS), one (RS) and two (RR) copies of the reference allele. Multi-array analysis then determines the genotype for each position in each sample and calculates quality scores for the genotype calls.
Single array analysisFor each sample, a linear model is used to adjust the log ratios  for a set of explainable variables, including average intensity  , amplicon length, amplicon GC content and central base pair composition. We assume a Gaussian distribution for adjusted  given the allele variant class, identical and independent distributions for each strand. We then choose one alternative allele using the single array posterior probabilities calculated for all samples at a base position (). We then focus on the subset of data with the chosen alternative alleles and perform another iteration of linear regression and recalculate the single array posterior probabilities.
Multi-array analysisThis module starts from the initial genotype assignments based on single array posterior probabilities. The positions where all samples were designated as RR with the corresponding posterior probabilities >0.999 are considered to be reference-only positions. For the other positions that potentially contain variants, at each position, we first use k-means clustering to designate initial genotypes, and calculate a minor allele count (MAC) as the total number of alternative alleles across all samples. For common variant positions with MAC  4, we perform clustering on  using EM algorithms as implemented in R package 'mclust' (). For rare variant positions with MAC < 4, we classify genotypes on  assuming known parameters for nonreference clusters (). The genotype class with the highest posterior probability among all classes is assigned to each position for each sample. A sample-specific quality score q evaluates clustering quality based on silhouette width () and a position-specific quality score Q evaluates probe quality as a sum of the q scores across samples.
Output analysisOutput analysis includes detection of technical artifacts and identification of reliable rare single nucleotide variations (SNVs) and indels. We detect and eliminate the heterozygous call from footprint effect artifacts, low-homology regions and technical defects. We take known dbSNP positions mapped to the candidate genes and preserve all variant calls at these positions. To balance between FPR and FNR, we choose a threshold of 0.67 for both quality scores to exclude the low-quality genotype calls based on our validation data (). This threshold can be modified by users. We provide the list of SNVs for all samples in the VCF4.0 format ().
The Author 2012. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oup.com at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
