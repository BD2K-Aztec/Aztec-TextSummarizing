Motivation: Recent development in ChIP-Seq technology has generated binding data for many transcription factors (TFs) in various cell types and cellular conditions. This opens great opportunities for studying combinatorial binding patterns among a set of TFs active in a particular cellular condition, which is a key component for understanding the interaction between TFs in gene regulation. Results: As a first step to the identification of combinatorial binding patterns, we develop statistical methods to detect clustering and ordering patterns among binding sites (BSs) of a pair of TFs. Testing procedures based on Ripley's K-function and its generalizations are developed to identify binding patterns from large collections of BSs in ChIP-Seq data. We have applied our methods to the ChIP-Seq data of 91 pairs of TFs in mouse embryonic stem cells. Our methods have detected clustering binding patterns between most TF pairs, which is consistent with the findings in the literature, and have identified significant ordering preferences, relative to the direction of target gene transcription, among the BSs of seven TFs. More interestingly, our results demonstrate that the identified clustering and ordering binding patterns between TFs are associated with the expression of the target genes. These findings provide new insights into co-regulation between TFs. Availability and implementation: See 'www.stat.ucla.edu/$zhou/ TFKFunctions/' for source code.
INTRODUCTIONGene expression in high organisms is regulated by the combinatorial binding of multiple transcription factors (TFs) to the DNA sequence in upstream or other regulatory regions of the gene. A set of interactive TFs often shows complex binding patterns. Clusters of multiple TF binding sites (TFBSs) co-localized in a short DNA region form the so-called cis-regulatory modules (CRMs). More complicated patterns, such as ordering preference among binding sites (BSs) of different TFs in a regulatory region, may exist and encode hidden regulatory signals. Detecting combinatorial binding patterns and CRMs is thus an important step toward a comprehensive understanding of cis-regulation.Consequently, computational methods have been developed for this purpose based on different types of genomic data. Early methods build probabilistic models for TFBSs and their occurrences in CRMs to identify clusters of TFBSs from DNA sequence data. For a recent review of these methods, see Hardison and Taylor (2012). When the TFs involved in a particular cellular condition are known, methods have been developed to detect clusters of motif matches appearing more frequently than expected given a background model for the DNA sequence (). There are also de novo methods for the discovery of CRMs, such as;) for a few examples. Essentially, this group of methods finds clusters of TFBSs based on the enrichment of motif matches compared against a simple background model. Because motif signals are usually weak in high organisms, sophisticated binding patterns, such as the ordering and other location preferences among TFBSs, cannot be reliably detected from sequence data alone and thus are often not incorporated in these methods. Recently, ChIP-Seq technology has been applied to generate genome-wide binding data for TFs in various cellular conditions. The accumulation of such binding data for multiple TFs in the same condition makes it possible to explore the relation among the binding of these TFs. For example, more than 10 TFs have available ChIP-Seq data in mouse embryonic stem cells (ESCs) (). One may want to find out whether the binding of two TFs is independent of each other and, if not, identify specific binding patterns suggested by the data. Such results may indicate how two or more TFs work together to regulate the expression of target genes and help detect novel regulatory signals. However, those motif-enrichment methods reviewed above are not directly applicable owing to the different data type and their simplified model assumptions. On the other hand, ad hoc methods have been used to define and detect clusters of BSs or ChIP-Seq peaks in recent studies.defined multiple TF binding loci by peaks within 100 bp. Lee and Zhou (2013) identified context-dependent co-regulators from co-bound regions constructed by ChIP-Seq peaks of two TFs with distance 550 bp.determined whether binding regions have a clustering tendency based on the empirical distribution of peak-to-peak distances.found clusters of BSs by iteratively merging peaks within 100 bp and then constructed some test using Poisson approximation.identified inter-site spacing bias for some fixed range between 0 and 100 bp by a Fisher's exact test on the *To whom correspondence should be addressed. contingency table of site pair counts within or outside the range. One sees an arbitrary use of distance thresholds and simple empirical tests in finding clusters of BSs (or peaks) in existing work, without any consideration of ordering preference among TFBSs or the individual location distribution for BSs of a TF. Clearly, there is a pressing need for new statistical methods to infer combinatorial binding patterns from ChIP-Seq data. In this work, we develop statistical methods to detect clustering and ordering patterns between BSs of two TFs from their ChIP-Seq data. We assume that under the null model the locations of BSs of a TF follow an inhomogeneous Poisson point process. Test statistics for clustering and ordering binding patterns are constructed based on Ripley's K-function (), a widely used method for detecting point patterns in spatial statistics, and its generalizations to pairwise TF binding data. Our approach does not rely on a pre-specified distance threshold for the detection of clusters of BSs and can automatically find the distance level at which the clustering pattern, if exists, is most significant. We make use of the large number of BSs in ChIP-Seq data and demonstrate that the null distributions of the test statistics can be accurately approximated by largesample theory. This eliminates the need for computationally intensive simulations and allows for efficient large-scale analysis.
METHODSOur methods are designed for the discovery of binding patterns from ChIP-Seq data of two TFs, X and Y. In this work, we focus on the upstream 8K; 2K region, relative to the transcription start site (TSS), of a gene, which is arguably the region that contains most cisregulatory signals. We collect all upstream regions that contain at least one ChIP-Seq peak from each of the two TFs, as our goal is to infer the relation between the binding of them. The corresponding genes of these upstream regions are called the (common) target genes of the two TFs. To simplify notation, we regard the location at 8K bp as the origin and choose the direction of gene transcription as the positive direction, so that an upstream region has coordinates 0; L (L=10K). This data collection procedure gives a meaningful definition of the ordering among BSs, relative to the direction of gene transcription. Suppose that x and y are the coordinates of two BSs (x; y 2 0; L). We say x precedes y if x5y. For the sake of understanding, we first describe our models and methods assuming that the exact locations of BSs are given, and then discuss a computational approach that predicts the exact location of a BS from a ChIP-Seq peak. The input dataset for a pair of TFs X and Y consists of N upstream regions, R 1 ;. .. ; R N , and a set of BS locations on each region. For r=1;. .. ; N, let x r = x r;i ; i=1;. .. ; n r   and y r = y r;j ; j=1;. .. ; m r   be the BS locations for X and Y in the region R r , respectively. Because we assume the same model for each region, the index r may be suppressed when we describe the methods for a generic region.
Inhomogeneous Poisson processesUnder the null model, BS locations of a TF are modeled by an inhomogeneous Poisson point process independent of the binding of other TFs. A Poisson point process on the line is a model for the occurrence of points in a one-dimensional interval. Denote the interval of interest by 0; L, which represents an upstream region in this work. A Poisson point process can be equivalently specified by a counting process for the number of points that have occurred in any subinterval a; b, denoted by Na; b. For an inhomogeneous Poisson process with intensity function x, x 2 0; L, the count Na; b follows a Poisson distributionfor x 2 0; L. This important property of an inhomogeneous Poisson process is most relevant to this study. So far we have been assuming that a region of interest is a continuous interval, but the upstream regions are composed of discrete base pairs. This technical difficulty can be resolved by assuming that the intensity function x is piecewise constant: for x 1 ; x 2 2 k; k+1, where k is an integer, we always have x 1 =x 2 . Under this assumption,for two integers a5b. The Poisson point process is a reasonable model for BS locations of a TF. First, when the considered region is large, such as L=10K in our case, observing a BS in a small interval x  "; x is a rare event with probability / x" and it is independent of the occurrence of BSs in other non-overlapping intervals. Second, the inhomogeneity allows us to capture the common observation that BSs tend to occur more frequently in regions closer to the TSS. Therefore, we expect x to have peaks when x is close to the TSS. We make a key assumption that the conditional density f(x) in (2) for a particular TF is identical across all regions. Denote by f X x the density for TF X. By Equation (2), the intensity function of TF X for the r th regionX in the region R r is r X;0L. Thus, our null model accounts for the fact that each upstream region may have a different number of observed BSs, but assumes that the location distribution of the BSs is identical with a common density f X x, which can be reliably estimated with enough regions. The intensity function of TF Y is defined in the same way as (4). From Equation (1) with a = 0 and b = L, one sees that r X;0L can simply be estimated by n r and r Y;0L by m r for r=1;. .. ; N. To estimate f X and f Y from BS locations x r ; y r , we further assume that the densities are piecewise constant where the length of a piece is h bp. Denote the pieces by B i for i=1;. .. ; L=h. Then f X x for x 2 B i is estimated by ^ f X x= total number of BSs for X in B i over all regions h  n ; 5 where n = X N r=1 n r is the total number of BSs for X. Consequently, the intensity function for the r th region is estimated byfor TF X, and the same estimation is applied for TF Y.
Clustering detectionRipley's K-function () is a broadly used analysis tool for summarizing and detecting point patterns in spatial data. In this section, we develop a method based on a bivariate K-function for detecting clustering binding patterns between two TFs. For two point processes, the bivariate K-function is the expected number of pairs of points, one from each process, with distance t, normalized by the product of the intensities of the two processes (). Consider a generic upstream region with BS locations x=x 1 ;. .. ; x n  for TF X and y=y 1 ;. .. ; y m  for TF Y. An estimated K-function for this region iswhere I is the indicator function, wx i ; y j  is a weight function for edge correction and d xi;yj =jx i  y j j is the distance between x i and y j. Ignoring the edge correction at this moment, if there are many pairs of points within distance t relative to the intensities, ^ K XY t will be greater than its expected value under the assumption that the binding of the two TFs is independent of each other. Reversely, if the BSs of the two TFs are mutually repulsive, one would expect fewer pairs having distance t and thus a small ^ K XY t. By varying the distance t over a wide range, we will obtain a curve of the bivariate K-function to summarize the clustering/ repulsive pattern for all distance levels. This is the overall idea behind our method. There are a few technical issues about the estimated K-function (7). First, edge effects may arise. There may be points lying outside the study area, 0; L, even though they are within the distance t from a point located in the study area. Thus, to avoid bias in estimating the K-function, an appropriate edge correction should be applied to data points close to the boundaries of the region. Several weight functions have been suggested for edge correction (), and Ripley's method () is used in this work. In a plane, wx i ; y j  is defined as the fraction of the circumference of a circle centered at x i with radius d xi;yj that lies inside the study area. In the one-dimensional case where x i and y j are located on the line, the weight function reduces to wx i ; y j = 1 ifx i  d xi;yj ; x i +d xi;yj  0; L 1=2 otherwise:Second, since the intensities X and Y are unknown, they are estimated by n ^ f X and m ^ f Y according to Equation (6). To detect a potential clustering pattern, we calculate the K-function for each region, ^ K r XY t, given the BS locations x r and y r. To evaluate its significance, the expectation and variance of ^ K r XY t are calculated under the null hypothesis H c that BSs of the two TFs are independently distributed according to inhomogeneous Poisson point processes. For any distance t 2 0; L, conditional on the numbers of BSs, n r and m r ,, C X and C Y can be calculated by numerical summation. See Supplementary Document for the detailed derivation. Note that V(t), C X and C Y do not depend on r and thus are identical across different upstream regions, which makes the variance calculation efficient even for a large number of regions. If the two TFs tend to bind in a cluster of distance t, observed value of ^ K r XY t will be substantially greater than its expected value 2t for many regions. Conversely, if it is substantially smaller than 2t, we may conclude that the two TFs have a significant repulsive binding pattern. Because we are interested in such overall binding patterns, it is natural to construct a test statistic that combines the K-functions from all regions. To this end, a normalized Z-score of the K-functions is defined bywhere each term in the summation has zero mean and unit variance under H c. Thus, Z c is the sum of independent random variables with identical means and variances (although their distributions may differ). By Lindberg's central limit theorem, which only requires independence among random variables, Z c t j H c $N 0; 1; as N ! 1: 12This leads to a simple null distribution for our test statistic when N is large. The accuracy of this asymptotic approximation will be evaluated for the data in this work by simulation. So far, we have been focusing on the procedure for a given t. In practice, we consider a range of values of t 2 0; 5000. This range is expected to be wide enough to capture all interesting clustering distances. The testing procedure for detecting clustering patterns is summarized as follows.(1) Estimate by Equations (5) and (6) the intensity functions of the two TFs, r X x and r Y y, for all r.(2) For each value of t:(a) Calculate the V(t), C X and C Y in (10).
Ordering detectionFor a pair of TFs with significant clustering binding for some distance level, we further test whether their binding also has an ordering preference relative to the direction of target gene transcription. For a generic upstream region, let X=X 1 ;. .. ; X n  and Y=Y 1 ;. .. ; Y m  be two random vectors that represent the respective locations of the BSs of the two TFs, X and Y, showing the most significant clustering pattern at distance t . Our ordering detection method is based on modeling the conditional distribution of Y i given X. We assume that Y i is generated independently given one and only one X j from a conditional distribution, PY i =yjX j =x, for y=x  t  ;. .. ; x+t  , and call X j the parent of Y i. As y ranges between x  t  and x+t  , we are only considering those Y i such that jY i  X j j t  for some j. This makes the ordering analysis meaningful and well-defined. Hereafter, n and m, or n r and m r for the r th region, refer to the numbers of BSs satisfying this distance constraint. Because there may be more than one X j whose distance to a particular Y i is t  , we introduce hidden variables Z ij to indicate which X j is the parent of Y i , i.e. Z ij = 1 ifX j is the parent of Y i ;That is, Y i has an equal chance to be located to the left or to the right of its parent. Moreover, we assume that in priori every X j has an equal likelihood to be the parent of Y i. Because the model is essentially a mixture model with hidden variables Z ij , an EM algorithm is developed to estimate under H o (Supplementary Document). Denote by ^ the estimate of output from the EM algorithm. Before we use this estimate for detecting ordering patterns, we apply some simple method to smooth ^ d over d, as many spikes often exist in ^ because of having no or few observations for some distances d. Let x=x 1 ;. .. ; x n  and y=y 1 ;. .. ; y m  be the observed binding locations of the two TFs on a generic upstream region R. We propose a new statistic ^ K YjX t   for ordering detection,and f YjX yjx denotes the conditional probability of Y i =y given x for any i (as they are i.i.d. given x). Under our model assumptions,where J x y =fj : jx j  yj t  g. Under the null hypothesis H o , the expectation and variance of ^ K\ 0; L for j=1;. .. ; n r. See Supplementary Document for the derivation of these results. We did not include edge correction in the definition (16) of ^ K YjX t  . This is because the distance t  for most clustering pairs is much smaller than L, the length of the upstream regions. For the significant ordering pairs we detected in this work, the percentage of BSs located within t  bp to either boundary of the upstream regions is around or 51%. Thus, the edge effect is largely ignorable for the ordering detection method. Finally, by the same argument as in the clustering analysis, a normalized Z-score is used as the test statistic for ordering detection,which approximately follows the standard normal distribution N 0; 1 under H o when N is large. From the definition of cy i ; x in Equation (17), Z o t  40 implies that X binding precedes Y. Now we summarize the testing procedure for ordering detection.from all regions using the EM algorithm and smooth ^ .Obviously, one may switch the roles of X and Y in this procedure, modeling the conditional distribution of X given Y. In practice, we calculate two P-values using the above procedure, one from ^ K YjX and the other from ^ K XjY , and then take the geometric average of the two P-values as the combined evidence for ordering patterns.
Predicting BS locationsA ChIP-Seq peak for a TF is recorded as an interval in which a TFBS is supposed to locate. We need to pinpoint the exact BS locations from ChIP-Seq data before applying our methods for clustering and ordering detection. To do this, we first extract the DNA sequence for a ChIP-Seq peak using the software CisGenome (). Then, we scan the sequence, as well as its reverse compliment, with a sliding window of length w, where w is the length of the position-specific weight matrix (PWM) of the TF from the database TRANSFAC (). We score a w-mer in the DNA sequence by a likelihood ratio,where s i is the nucleotide sequence of the i th w-mer,  is the PWM for this TF and 0 is a background Markov model. The w-mer that has the maximum score among all w-mers scanned from the sequence is chosen as the exact BS, whose location (start position) is used in our analysis.
RESULTSIn this work, we study binding patterns in ChIP-Seq data generated from mouse ESCs. ESCs are pluripotent stem cells derived from the inner cell mass of the blastocyst, an early-stage embryo (). They are known to have two distinctive properties, pluripotency and the ability to replicate indefinitely (), which make ESCs especially important in clinical research. It is expected that many complex diseases might be treated by transplanting cells generated from ESCs (). There has been a substantial amount of recent work on the gene regulatory network in mouse ESCs, which involves the combinatorial regulation by a number of TFs (). For example, Oct4 is known as a master regulator of pluripotency, and a valid amount of Oct4 is needed for dedifferentiation and for sustaining ESC self-renewal (). Four TFs, Oct4, Sox2, cMyc and Klf4, can reprogram somatic cells back to ESC-like cells having the characteristics of self-renewal and pluripotency (). Genome-wide ChIPSeq data have provided the binding regions of410 TFs that play key regulatory roles in mouse ESCs (). Computational analyses have been performed to identify the sequence motifs of these core TFs () and to detect other co-regulators that may regulate genes by working with these TFs (). However, except for some ad hoc analysis on the co-occurrence between binding peaks, it appears that no principled approaches have been applied to detect combinatorial binding patterns from this rich collection of data. In this analysis, we apply our methods to 14 TFs with available ChIP-Seq data from three recent publications () and systematically identify clustering and ordering binding patterns between all 91 TF pairs. The 14 TFs are Oct4, Sox2, Smad1, Stat3, Nanog, Esrrb, Tcfcp2l1, Tcf3, Nr5a2, E2f1, nMyc, cMyc, Zfx and Klf4. We also suggest potential regulatory roles of the identified combinatorial binding patterns by examining the expression profiles and functional annotations of their target genes. We first verified via a simulation study that the normal approximations to the null distributions of the test statistics, Z c (11) and Z o (21), are accurate for the data analyzed in this work. One key feature that distinguishes our methods from other ad hoc methods is the use of inhomogeneous Poisson processes in modeling BS locations, which takes into account the location preference of TFBSs in upstream regions. In the simulation study, we also compared our approach against a simple method that ignores the location preference in detecting clustering. The simple method produced substantially more false discoveries. This shows that modeling the marginal binding distribution of a TF is a critical component for the detection of significant binding patterns. See Supplementary Document for a detailed description of the simulation study.
General clustering patternsIn this section, we analyze the potential clustering patterns of the 91 TF pairs. Because Oct4 and Sox2 are the most well-known and important master regulators in ESCs, we illustrate the details in each step of our analysis with this pair of TFs. The analysis starts with estimating the density function f X for each TF. To construct a robust estimate, we chose the bin size h so that every bin has at least one BS in at least one region. Then, we estimated the density function f X by (5) and the intensity function r X x by (6) for each region. As expected, both TFs tend to bind more frequently near the TSS of a gene (Supplementary). Such marginal location preferences are captured by the estimated densities. As demonstrated by our simulation study, ignoring this fact would lead to false positives in clustering detection. With the estimated intensity functions for a pair of TFs, the bivariate K-function (7) for each upstream region and the Z-score (11) were calculated for a sequence of distances. See(A) for the K-function of Oct4 and Sox2, averaged over upstream regions bound by the two TFs, which lies far above the expected value 2t. This suggests that the two TFs have a significant clustering pattern for all distances, which is confirmed by the large positive values of Z c t in. The maximal Z c value, 66.9, occurs at the distance t  =50, and thus the clustering between Oct4 and Sox2 binding is found most significant when examining the BSs from the two TFs located within 50 bp. The monotone decreasing trend of Z c t as t increases () shows that the clustering pattern becomes less significant as the distance threshold increases. This result is clearly consistent with the known tight clustering between the BSs of Oct4 and Sox2. In fact, in some regions, the two TFs bind adjacent sites with only a few (or even no) gaps (). To summarize the results of all 91 TF pairs, we consider the average of Z c t over t 2 50; 1000, denoted by Z 1000 , for P-value and false discovery rate (FDR) calculations. First, using Z 1000 is more conserved than using the maximal Z-score Z c t   because the latter will cause a selection bias and artificially increase the significance level. Second, for most applications in defining clusters of BSs or CRMs, the maximal distance threshold is often a few hundred base pairs. Given Z 1000 we calculated the P-value from N 0; 1 and the corresponding FDR for all TF pairs. It turns out that 86 out of the 91 pairs were found to have significant clustering patterns with an FDR 52% (Supplementary). This is in line with the finding that most of these TFs show extensive co-binding in mouse ESCs (). The statistics Z 1000 of all the TF pairs are shown as a heatmap in. For almost all significant pairs, the most significant clustering distance t  is within 1000 bp (Supplementary), confirming short-range co-occurrence among BSs in regulatory regions. We further analyzed 11 TF pairs with t  =50 bp, as these TFs are likely to cluster at closer distances. After calculating their Z c t for t550, we found seven pairs having most significant clustering within 6 bp and the other four pairs close to 50 bp (Supplementary). BSs with a gap less than a few base pairs are often considered a composite site bound by a complex, while those separated by a few hundred base pairs have been seen in CRMs (). We compared our approach with a simple overlapping analysis for the co-occurrence of BSs of two TFs in the upstream regions. We calculated the 2 statistics and found that all TF pairs but one (Tcf3 and cMyc) are significant. The 2 statistics and our Z 1000 are positively correlated, but there is no exact correspondence between the two (Supplementary). Our method gives more information than the simple overlapping analysis does. It not only suggests that the TFBSs co-occur in upstream regions but also provides the significance levels for different distances. Furthermore, our method is able to detect a clustering pattern where two TFs bind a certain base pairsapart, reflected by a peak in the curve of Z c t, such as the examples shown inand D. Our clustering statistic Z 1000 can provide detailed information about the co-binding pattern among a set of TFs. To demonstrate this, we performed single-linkage hierarchical clustering of the 14 TFs with Z 1000 as the pairwise similarity measure. The left margin of the heatmap inshows the resulting cluster dendrogram, in which TFs that merge at a lower level have a more significant clustering pattern. One sees that a tight cluster can be formed by cMyc, nMyc, E2f1 and Zfx with high values of Z 1000 between them. These four TFs are the members of the socalled cMyc group defined in previous studies (). Further moving up the dendrogram, the cMyc group merges with Klf4 and other TFs from the Oct4 group, including Oct4, Sox2, Nanog, Esrrb, Tcfcp2l1, Smad1 and Stat3. As expected, one sees another tight cluster of Oct4, Sox2 and Nanog from the heatmap. In addition to partitioning the TFs into two separate groups as suggested by, our result reveals that some Oct4 group TFs extensively co-bind with the cMyc group as well. The existence of a large number of genes extensively bound by both groups has been reported in previous studies (). An integrated analysis of ChIP-Seq, motif and gene expression data suggested that the co-binding among the Oct4 group TFs occurs in a Myc-dependent way (). In both ESCs and induced pluripotent stem cells, genes associated with cMyc binding, by itself or in combination with Oct4, Sox2 and Klf4, are significantly enriched for regulators of metabolic processes, while genes co-bound by Oct4, Sox2 and Klf4 in absence of cMyc are mainly implicated in regulation of development (). Combined with these published data, the tree structure inprovides new biological insights with interesting functional implications into the co-regulation among these core TFs in mouse ESCs. We also noticed that Tcf3, a component in the Wnt-signaling pathway, showed significant clustering patterns with the core ESC regulators, Oct4, Sox2 and Nanog, consistent with the observation in. It was verified in a recent study () by electrophoretic mobility shift assay that Tcf3 competes with Sox2 for the Sox motif in Oct-Sox composite sites, which may counter pluripotency. This shows another example of complicated interactions among multiple TFs to implement diverse transcriptional programs. These examples support the view that combinatorial binding patterns may have important implications in the expression and functions of target genes. Thus, we performed a systematic combined analysis of clustering binding patterns and gene expression data (see next subsection).
BS clustering and differential gene expressionZhou et al. (2007) have generated gene expression profiles in mouse ESCs by sorting cells according to the expression level of the gene Oct4. The expression data consist of eight samples with high Oct4 expression and eight samples with low Oct4 expression. By two-sample comparison between the two groups of samples, they defined 1325 Oct4-sorted+ genes, which showed a strong positive correlation with Oct4 expression, and 1440 Oct4sorted genes with the opposite expression pattern. It is interesting to examine whether the clustering binding pattern between a pair of TFs is different between the upstream regions of these two gene sets. To give a concrete example, among the 375 common target genes of Oct4 and Sox2, 56 of them are in the Oct4-sorted+ set and 11 in the Oct4-sorted set. We wish to test if the clustering binding pattern of these two TFs shows any difference between the upstream regions of the 56 Oct4-sorted+ genes and those of the 11 Oct4-sorted genes. In general, for a pair of TFs X and Y, denote by S 1 and S 2 , respectively, the sets of Oct4-sorted+ and Oct4-sorted target genes of the two TFs. For each gene in either set, we calculate a Z-score for a distance level t,which is one term in the summation of (11). Note that every Z r c t has zero mean and unit variance under the null hypothesis H c. Now regarding fZ r c t : r 2 S 1 g and fZ r c t : r 2 S 2 g as two groups of standardized observations, we use the two-sample t-statistic, denoted by T(t), to test if the two group means are identical. Again, an overall statistic, T 1000 , is calculated as the mean of T(t) over t=50;. .. ; 1000 for each pair. Among the 86 TF pairs showing a clustering pattern, 15 of them also have a significant T 1000 at an FDR of 55% (Supplementary). The significant T 1000 statistics are all positive, indicating that the mean of the Z r c statistics of the Oct4-sorted+ target genes is greater than that of the Oct4sorted target genes. In other words, the clustering binding pattern between a TF pair in the table is more significant in upstream of the Oct4-sorted+ genes than in that of the Oct4sorted genes. One possible explanation for this difference is that these TFs work in concert to activate Oct4-sorted+ genes, which are upregulated in ESCs, but may regulate Oct4-sorted genes and promote early differentiation with other co-regulators not included in our analysis. This result demonstrates a clear association between the co-binding pattern of two TFs and theof their target genes, suggesting that how TFs co-localize to the DNA sequence may serve as some subtle signal for downstream gene regulation.
Ordering among TF bindingWe apply the ordering detection method to the 86 pairs of TFs with a significant clustering pattern. To better understand the detailed procedure, we describe each step of our analysis for the pair of E2f1 (X) and Zfx (Y). For this pair, the most significant clustering distance t  =300, and thus, the model parameter =  300 ;. .. ; 300  as defined in (14). We counted the number of pairwise BSs, x j and y i , with distance d=0;. .. ; t  and added a little pseudo-count to each value of d to avoid zero counts. These counts were normalized into frequencies c d , d=0;. .. ; t  , which were used as the initial estimate 0 with 0 0 =c 0 and 0 d = 0 d =c d =2 for d ! 1. As a result, the initial estimate of was symmetric. Starting with 0 , the EM algorithm developed in the Supplementary Document was run until convergence. We then smoothed the EM estimate ^ by a cubic smoothing spline (using the R function 'smooth.spline'). The plots for the initial value 0 and the EM estimate ^ (after smoothing) for this pair are shown in Supplementary, with a demonstration of the mixture density f YjX yjx (18). Note that although the initial estimate is symmetric by construction, the EM estimate is not symmetric but satisfies the constraint (15) specified by the null hypothesis H o. With this way of initialization, the EM algorithm often converges after a few iterations. Given ^ , it is easy to follow the ordering testing procedure to calculate Z o t  . For E2f1 and Zfx, we obtained Z o 300=12:0 with a P-value of 0. Clearly, there is a significant ordering binding pattern between the two TFs within a distance of t  =300 bp. Moreover, the positive Z o value indicates that the BSs of Zfx (Y) are much more likely to locate to the right of those of E2f1 (X), along the direction of gene transcription. We also repeated the same procedure but switched the labeling of the two TFs to see if the result is consistent. The resulting ordering statistic Z o 0 =  12:7, which suggests the same ordering between the binding of the two TFs with an almost identical significance level. At an FDR of 51%, we detected seven pairs of TFs showing ordering preferences between their BSs (). For all these pairs, switching the labels of X and Y gave essentially the same conclusion on the ordering pattern with comparable absolute values between the two statistics, Z o and Z o 0. The geometric mean of the P-values of Z o and Z o 0 was calculated as the overall measure of the statistical significance for a pair. Note that in the table all pairs are labeled so that X precedes Y (i.e. Z o 40) for easy understanding. The ordering between two TFs may be a local feature that only occurs for BSs within the clustering distance t  or a global feature that reflects that the BSs of one TF tend to locate in upstream of those of the other one. Both patterns can be captured by our testing procedure. We performed a two-sample comparison on the BS locations for each of the seven pairs and found that three of them, E2f1/cMyc (P=7:4  10 15 ), E2f1/Zfx (P=7:2  10 11 ) and Tcfcp2l1/Zfx (P=3:8  10 5 ), showed significant global difference in their binding locations consistent with the orderings reported in. The other four pairs showed no significant global difference and thus the detected ordering patterns here are specific to tightly clustered BSs. The pairwise ordering patterns can be combined to produce an ordering relation graph among multiple TFs. Regarding cMyc and nMyc together as the Myc TF, we encapsulate all the detected pairwise ordering patterns into such a graph in. In this graph, an edge from X to Y means that X precedes Y along the direction of gene transcription. If X precedes Y and Y precedes Z, we conclude that X also precedes Z and link the three TFs into a chain, X  Y  Z. One sees three chains ending at Zfx, meaning that the BSs of Zfx tend to be the closest one to the TSS. In addition, there is a full ordering among the cMyc group TFs (E2f1, cMyc/nMyc and Zfx) and Klf4, which is often regarded as a TF in between the Oct4 and the cMyc groups () (also see). A example region with the exact full ordering is provided in. This seems to suggest a special sequential ordering in the co-binding of the cMyc group TFs. We found 866 genes whose upstream regions have BSs from all the three cMyc group TFs within 300 bp, the maximum t  value between pairs in this group (), and 233 of them have at least one 300-bp region in which the BSs follow the exact ordering (E2f1MycZfx). We call the 233 genes the ordering group (Supplementary) and the other 633 genes the non-ordering group. Enriched gene ontology terms with P-value 510 9 in the ordering group include ribosome biogenesis, translation, macromolecule metabolic process and RNA A Bprocessing, suggesting involvement in some most basic and fundamental biological processes. There are 28 Oct4-sorted+ but only 5 Oct4-sorted genes in the ordering group, showing a noticeable depletion of genes downregulated in ESCs. We then examined the expression profiles in the Oct4-sorted series () of the ordering group (Supplementary) and those of the non-ordering group (Supplementary). The expression profile of each gene was normalized to have zero mean and unit standard deviation. The ordering group has a higher normalized expression level in the Oct4-high samples than the non-ordering group (P=8:0  10 5 ), while the non-ordering group shows a higher expression level in the Oct4-low samples than the ordering group (P=1:3  10 5 ). These observations indicate potential association between the ordering among BSs and the expression pattern of the target gene. Further experimental investigations hold the key to understanding the regulatory role of the exact ordering among the BSs and its relation to the functions of the target genes.
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
M.Cha and Q.Zhou at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
Detecting clustering and ordering binding patterns at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
DISCUSSION We have developed new statistical methods to detect combinatorial binding patterns from ChIP-Seq data. More specifically, we have proposed test statistics for clustering and ordering analysis for a pair of TFs. To construct flexible and threshold-free statistics, bivariate K-functions for Poisson point processes are used and further developed. With a proper normalization, the null distributions can be well-approximated by the standard normal distribution, which avoids the use of simulation-based P-value approximation. This makes our approach suitable for large-scale data. The test statistics can be used not only to make a binary decision, but also to measure how strong a specific binding pattern is between two TFs. Our procedures also offer simple ways to extend the pairwise analysis to multiple TFs, as demonstrated by the hierarchical tree among the binding patterns (Fig. 2) and the ordering relation graph (Fig. 3A). Novel and interesting biological insights can be provided by such new analysis. To the best of our knowledge, our method is the first systematical development for detecting ordering patterns among TFBSs. This work reports strong evidence (with small P-values and FDRs) for the existence of specific binding ordering among a set of TFs. In this study, we predict the exact BSs from ChIP-Seq peaks by scoring w-mers, assuming that each ChIP-seq peak has exactly one BS. The maximum-scored w-mer is regarded as the BS for the region. One future direction is to take into account the uncertainty in the exact location of a BS. For example, we may normalize the likelihood ratio scores (22) to define a probability distribution for the BS in a ChIP-Seq peak and incorporate this distribution into our detection procedures. We may also consider the possibility that some peaks are false positives and may not contain a BS. In this case, exact P-value calculation (Touzet and Varr e, 2007) will be needed to decide which w-mers are more likely the BSs. A direct generalization to multivariate K-functions seems infeasible when the number of TFs becomes large. To extend our methods to the study of multiple TF binding patterns, we may analyze the change in pairwise patterns with respect to the binding of a third TF or some score constructed by the binding of a few other TFs. Funding: This work was supported by NSF [grants DMS1055286 and DMS-1308376 to Q.Z.]. Conflict of Interest: none declared.
