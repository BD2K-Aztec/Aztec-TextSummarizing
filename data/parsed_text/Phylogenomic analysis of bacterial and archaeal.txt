With the explosive growth of bacterial and archaeal sequence data, large-scale phylogenetic analyses present both opportunities and challenges. Here we describe AMPHORA2, an automated phylogenomic inference tool that can be used for high-throughput, high-quality genome tree reconstruction and metagenomic phylotyping. Compared with its predecessor, AMPHORA2 has several major enhancements and new functions: it has a greatly expanded phylogenetic marker database and can analyze both bacterial and archaeal sequences; it incorporates probability-based sequence alignment masks that improve the phylogenetic accuracy; it can analyze DNA as well as protein sequences and is more sensitive in marker identification; finally, it is over 100Ã— faster in metagenomic phylotyping.
INTRODUCTIONAlthough the small subunit rRNA (SSU rRNA) is the 'gold standard' in microbial diversity studies, it has its limitations. For one, it has been shown that the GC compositional bias in rRNA could cause misleading phylogenetic artifacts (). For another, rRNA makes up only a tiny fraction (0.1%) of any given genome. Therefore, the organismal phylogeny based on rRNA alone needs to be corroborated with the analyses of other phylogenetic markers. Thirdly, there are large variations in the rRNA copy number in different bacterial and archaeal species, which prevents the use of rRNA for accurate estimation of the relative abundance of species in a population. Protein-coding genes such as EF-Tu, rpoB, recA and HSP70 have been used as alternative phylogenetic markers to complement rRNA-based analyses (). Because their sequences are conserved at the amino acid level, protein-coding genes offer at least two advantages over rRNA: (i) their protein sequences are less sensitive to GC compositional bias (). (ii) Their fast-evolving nucleotide sequences have more power to resolve the relationships * To whom correspondence should be addressed.between closely related organisms. In the past, the use of proteincoding genes in phylogenetic analyses has been hindered largely by the lack of available protein sequences. Recent explosive growth of microbial genomic sequences, however, has transformed the way we study microbial diversity. For example, now many genes can be combined to make robust 'genome trees', which could serve as a framework for genome-based bacterial and archaeal classification (;). The use of dozens of protein marker genes in addition to rRNA also greatly increases the power of metagenomic phylotyping. Furthermore, many of the protein marker genes are single-copy gene in the genome. Therefore, the species composition estimated from these markers should be more accurate than that estimated based on rRNA (). The promise of phylogenomics comes with new challenges. First, we need to select a set of robust marker genes that are universally distributed and are relatively recalcitrant to lateral gene transfers. Second, we need an efficient way of identifying their orthologs (and not just homologs) from genomic-scale sequences and of rapidly aligning them with the reference sequences. Third, to make high-quality trees, we need to filter out the unreliable alignment regions prior to the phylogenetic inference. The original AMPHORA package was designed to overcome these bottlenecks for automated, high-throughput, high-quality phylogenomic analyses (). However, several issues remain (). To address these issues, we redesigned AMPHORA, made significant enhancements and incorporated new algorithms and functions. We named it AMPHORA2 and describe it below.
APPLICATION DESCRIPTION
Adding archaeal phylogenetic markersAMPHORA relies on a core phylogenetic marker database to identify a set of marker genes from the input sequences. It is limited
M.Wu and A.J.Scottto handling bacterial sequences because it only contains 31 bacterial markers in the database (). In AMPHORA2, we greatly expand the phylogenetic database by including marker genes from the archaeal domain. To limit potential complications from paralogy and lateral gene transfers, we selected archaeal marker genes using two criteria: (i) they are 'universally' distributed.(ii) They are single-copy genes in the genome. To identify these genes, an all-against-all BLASTP search was performed between 112 064 proteins from 50 representative archaeal genomes. Proteins were then clustered using the Markov Cluster Algorithm (MCL) (e-value cutoff = 1e-15) (). The 108 clusters with an average of 1.00  0.02 genes per organism and present in at least 45 organisms were chosen as candidate marker genes. Maximum likelihood trees were made for each marker gene and markers with non-species-specific gene duplications were removed from the list. In the end, 104 archaeal genes were selected and added to the AMPHORA2 phylogenetic marker database (Supplementary Material 1).
Automated sequence alignment filteringSequence alignment masking and filtering improve the accuracy of phylogenetic analysis (). One great advantage of using AMPHORA is that it provides automated high-quality alignment masking and filtering. Although the process itself is automated, the 'stencil' masks that AMPHORA uses to mask the alignments were created manually, which can be laborious and subjective. We recently developed a probability-based alignment masking program named Zorro () that assigns a confidence score to each column in the sequence alignment. The confidence score can be used to mask and filter the alignments (e.g. by removing any column with a confidence score less than a cutoff) or weigh the columns (e.g. by using RAxML's column weight option). The largescale, high-quality capacity of Zorro makes it practical to quickly expand the phylogenetic marker database to include hundreds of marker genes. Incorporating Zorro masks within AMPHORA2 also makes it much easier for users to add markers of their own choice and to build their personalized phylogenetic marker database. The stencil masks in the AMPHORA2 marker database were all created using the Zorro program.
Increasing the speed and accuracy of metagenomic phylotypingPhylotyping (i.e. mapping sequence reads to taxa) is a key component of metagenomic studies. It helps researchers address the two central questions: who is there and what they are doing (e.g. by anchoring functional genes to a phylogenetic marker)? AMPHORA uses a tree-based algorithm for phylotyping. AMPHORA first inserts the query sequence into a reference tree by parsimony and then classifies it based on its position in the tree. It does this one sequence at a time. New placement algorithms make it possible to place hundreds of sequences into a reference tree simultaneously and thus have the potential to dramatically speed up the phylotyping process (). In addition, fast and more accurate likelihood-based placement algorithms are now available and they provide matrices to directly assess the confidence of the phylotyping (). AMPHORA2 takes advantage of RAxML's and pplacer's new placement algorithms and now can perform either parsimony or likelihood-based phylotyping. Our benchmark tests showed that implementing these new algorithms resulted in more than 100 speed gain in phylotyping. AMPHORA2 places sequences into the NCBI taxonomic hierarchy and assigns a confidence score at each rank of taxonomic classification (see Supplementary Material 2). The phylotype results can be imported into spreadsheet programs. Unlike its predecessor, AMPHORA2 can phylotype metagenomic sequences from a mixed population of bacteria and archaea.
Other enhancement and new functionsAMPHORA2 now supports the analyses of DNA sequences, which means that users can apply AMPHORA2 directly to metagenomic reads without the need to first annotate the sequences. AMPHORA2 will make the open reading frame (ORF) calls and identify the markers from the translated peptide sequences. Sequence similarity search using HMMER (version 2.3) is a rate-limiting step in AMPHORA. To speed things up, sequences are first searched and filtered with BLASTP to reduce the workload of HMMER. AMPHORA2 now uses HMMER3 as its sole search engine, which has a speed comparable to BLASTP but is much more sensitive and accurate in detecting homologous sequences.
The Author 2012. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oup.com
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
