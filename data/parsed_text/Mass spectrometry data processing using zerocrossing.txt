Motivation: Peaks are the key information in mass spectrometry (MS) which has been increasingly used to discover diseases-related proteomic patterns. Peak detection is an essential step for MS-based proteomic data analysis. Recently, several peak detection algorithms have been proposed. However, in these algorithms, there are three major deficiencies: (i) because the noise is often removed, the true signal could also be removed; (ii) baseline removal step may get rid of true peaks and create new false peaks; (iii) in peak quantification step, a threshold of signal-to-noise ratio (SNR) is usually used to remove false peaks; however, noise estimations in SNR calculation are often inaccurate in either time or wavelet domain. In this article, we propose new algorithms to solve these problems. First, we use bivariate shrinkage estimator in stationary wavelet domain to avoid removing true peaks in denoising step. Second, without baseline removal, zero-crossing lines in multi-scale of derivative Gaussian wavelets are investigated with mixture of Gaussian to estimate discriminative parameters of peaks. Third, in quantification step, the frequency, SD, height and rank of peaks are used to detect both high and small energy peaks with robustness to noise. Results: We propose a novel Gaussian Derivative Wavelet (GDWavelet) method to more accurately detect true peaks with a lower false discovery rate than existing methods. The proposed GDWavelet method has been performed on the real Surface-Enhanced Laser Desorption/Ionization Time-Of-Flight (SELDI-TOF) spectrum with known polypeptide positions and on two synthetic data with Gaussian and real noise. All experimental results demonstrate that our method outperforms other commonly used methods. The standard receiver operating characteristic (ROC) curves are used to evaluate the experimental results.
INTRODUCTIONMass spectrometry (MS) is a crucial analytical tool in proteomics research to provide tremendous information for disease proteomics study and drug targets identification at the protein/peptide level. Due to measurement error, chemical and other background noise, MS usually contains high-frequency noise and consequently a multitude of misleading peaks. Peak detection is one of the most important steps in MS data analysis because its performance directly effects the final proteomics study results. Because the noise in MS comes from different resources and cannot be estimated, false positive peak detection results are * To whom correspondence should be addressed.unavoidable. This makes peak detection as a challenging problem. In recent years, several peak detection methods have been proposed (). Most previous algorithms have four common preprocessing steps: denoising, baseline correction, alignment of spectrograms and normalization. After preprocessing, local maxima is usually used to detect peak positions and design rules to quantify peaks. In this article, we will explore the limitations of existing peak detection methods and propose several new algorithms to solve them. Most peak detection methods employed denoising step by removing noise in each scale of wavelet, such as commonly used Cromwell () and continuous wavelet transform (CWT) () methods. However, true peaks in MS could have large frequency response and be removed by denoising step. As a result, these true peaks cannot be detected. We propose using bivariate shrinkage model, which considers relationship of two neighbor scales, to remove noise in stationary wavelet domain. Because utilizing relationship between two neighbor coefficients or two scales of wavelets can keep highfrequency true signal (). Stationary wavelet transform (SWT) utilizes spatial information of signals and suppress artifacts by redundant representations. Baseline removal step was widely used in peak detection methods, but it often got rid of true peaks and created new false peaks. To avoid removing baseline, the CWT-based pattern-matching algorithm was introduced in study by. Using Mexican Hat wavelet in multi-scale, this method gave good results in peak detection with high sensitivity and low false discovery rate (FDR). However, the more important property of multi-scale in wavelet domain was not used in this method (). Instead of considering peaks as the sum of delta functions, more generally, we consider MS peaks as a mixture of Gaussian in which each peak corresponds to one Gaussian. We propose to use Gaussian derivative wavelet, instead of Mexican Hat wavelet which is only the second derivative of Gaussian wavelet. Zero-crossing lines which are robust to noise are also introduced to replace Ridge-lines in. We study the zero-crossing lines in multi-scale wavelet and provide new theoretical analysis. In most peak detection methods, signal-to-noise ratio (SNR) was used to remove the small energy peaks with SNR values less than a threshold. But MS noise cannot be correctly estimated in either time domain or wavelet domain. Thus, in this article, instead of SNR, frequency response, height and SD of Gaussian peaks calculated by zero-crossing in Gaussian derivative wavelet domain are used to remove false peaks. In order to improve sensitivity, the Envelope analysis () is also used to save some important peaks with small energy.
N.Nguyen et al.In this article, we propose a new Gaussian derivative wavelet-based peak detection method (GDWavelet) for SurfaceEnhanced Laser Desorption/Ionization Time-Of-Flight (SELDITOF) spectrum. Both simulated and real spectrum with known polypeptide positions and compositions are used to evaluate our method. With simulated data, we compare different peak detection algorithms by both Gaussian and real noise. All experimental results show that our new approach can detect more peaks (in both high and low amplitude) with a lower FDR than state-of-the-art methods.
METHODSIn this section, our new GDWavelet method will be introduced. In GDWavelet, we utilize bivariate smoothing model, Gaussian derivative wavelet and envelope analysis. First, bivariate shrinkage estimator in SWT domain will be used to reduce noise and to keep whole true signal. Second, we will introduce how to detect peaks using Gaussian derivative wavelet through peak properties such as frequency response, SD and height. Finally, envelope analysis is performed to save true small energy peaks which will be missed if only peak properties are used.
Smoothing by bivariate shrinkage functionNoise smoothing in MS is an important step which should remove noise and keep true peaks. In, they tried to remove noise as much as possible, hence some true peaks were also removed. We propose to utilize bivariate shrinkage estimator in SWT domain to reduce noise and keep whole true signal. More precisely, we decrease the noise level without removing most of them. SWT is chosen due to its fast speed and redundant representations. The later step will further handle the remaining noise. To estimate wavelet coefficients, the most well-known rules are universal thresholding and soft thresholding () which was applied to Cromwell method (). These algorithms assume that wavelet coefficients are independent. Unfortunately, frequency response of peak is rather wide. Hard or soft thresholding only considers coefficients in a sub-band with narrow frequency. Recent research shows that algorithms utilizing the dependency between coefficients can give better results than those using the independency assumption (exploited this dependency between coefficients and proposed a non-Gaussian bivariate pdf for the child coefficient w 1 and its parent w 2 as followsThe marginal variance  2 is dependent on the coefficients index k. By this bivariate pdf and the Bayesian estimation theory, the MAP estimator of w 1 () is derived aswwhere y 1 is child noisy coefficient, y 2 is parent noisy coefficient. This estimator is a bivariate shrinkage function. It has been used to smooth many kinds of signals such as image (), DNA copy number (), etc. In this article, bivariate shrinkage estimator is used to smooth MS signals. An example of denoising result is shown in. This example will be discussed in Section 2.4.
Peak detection by Gaussian derivative waveletIn previous works (), MS peaks were considered as the sum of delta functions. That means only heights of peaks have been used for peak detection throughout SNR.utilized width of peaks to improve peak detection results a lot. We consider MS peaks as a mixture of Gaussian in which each peak corresponds to one Gaussian:With this assumption, four parameters providing intrinsic differences between true peaks and noise are peak position, SD, height and frequency response of peak. To find these parameters of a peak, we use zero-crossing lines in multi-scale of Gaussian derivative wavelet instead of ridge-lines in multi-scale of Mexican hat wavelet that was used by Du et al. (2006).
Theory of zero-crossing lines in multi-scaleScaling theory for zerocrossings has been studied and applied to many applications.assumed that signal is the sum of delta functions. Another similar assumption of signal, bandlimited signal, has been studied in. However, studying zero-crossing of signals with Gaussian mixture assumption still is a new and challenging problem. We will build new theory of zero-crossing lines in multi-scale in following sections. Through our theory, parameters (position, SD, height and frequency response) of a Gaussian peak can be accurately estimated. We use the first derivative of f i (t) to locate local maxima corresponding peak position: f i (t 0 ) = 0 with t 0 =  i. We continue using the second derivative and third derivative of f i (t) to estimate height and SD of Gaussian peak:Since smoothing performed in denoising step only reduces noise and keeps small true peaks, multi-scales of Gaussian derivative wavelet are used to make local maxima and minima more robust to noise instead of only one Gaussian filter in. The wavelet transform can be written as convolution product in (4):According to Chapter 6 in, the wavelet transform in (4) can be rewritten as a multi-scale differential operator in (5))(u).In this article, the Gaussian wavelet is used. So,   s (t) can be followed as (6):, we get result in (7),s) belong to connected curves that are never interrupted when the scale decreases.Proof. With the first derivative, (5) can be rewritten as (8)If W 1 f (u,s) = 0, we got u 0 =  i and u 0 (s+1)u 0 (s) = 0 with any scale s. With the second derivative, (5) can be rewritten as (9):, then 0 < u 0 (s+1)u 0 (s)  1 with any scale s. With the third derivative, (5) can be rewritten as (10)) and Gaussian noise (SD = 1); (b) Using Gaus1, the zero-crossing line corresponds to peak position, t = 5; (c) Using Gaus2, two zero-crossing lines correspond to two peak edges whose distances to peak position are  i = 0.5; (d) Using Gaus1, two ridge lines are corresponding to two peak edges whose distances to peak position are  i = 0.5; (e) Using Gaus3, three zero-crossing lines are corresponding to one peak position and two peak edges whose distances to peak position are  3 i = 0.866; (f) Using Gaus2, three ridge lines are corresponding to one peak position and two peak edges whose distances to peak position are  3 i. 0  u 0 (s+1)u 0 (s)  1 with the first and second derivative and zero-crossing lines belong to connected curves. Another conclusion is that zero-crossing lines is discontinuous lines if the third derivative Gaussian wavelet is used. Thus, only the first and second derivative Gaussian wavelets should be used in peak detection. If f i is a discrete signal, (4) can be rewritten as follows:We get f (k) by sampling f i (t) with T s :Note: zero-crossing line is more robust to noise than ridge line. This conclusion is illustrated by an example in.and e show that zero-crossing lines are easier to detect than ridge lines linking local maxima or local minima points.
Applying zero-crossing to peak detectionFrom Section 2.2.1, parameters of a Gaussian peak could be estimated as follows: Estimation of peak position: there are three ways to estimate peak positions throughout zero-crossing of three kind Gaussian derivative wavelets.(1) The first Gaussian Derivative Wavelet (Gaus1): zero-crossing line corresponds peak position. In multi-scale, this zero-crossing line is a continuous line with length N. Peak position should be estimated by(2) The second Gaussian Derivative Wavelet (Gaus2): there are two zerocrossing lines that correspond two edges of Gaussian peak. They are u 0left and u 0right. Because two zero-crossing lines are symmetric at peak position, peak position should be estimated by(3) The Third Gaussian Derivative Wavelet (Gaus3): there are three zerocrossing lines if using the third GD Wavelet. They are u 0left , u 0middle and u 0right. Because u 0left and u 0right are non-continuous lines, they should not be used to estimate peak position. From u 0middle , we can find peak position byEstimation of peak's SD: Another parameter of Gaussian peak is SD  i .There are two ways to estimate  i as follows(1) The second Gaussian Derivative Wavelet (Gaus2): from Remark,  i at scale s could be calculated byAfter calculating  ileft (s) and  iright (s) at all scales,  i should be estimated bywhere N l and N r are length of left and right zero-crossing lines.(2) The third Gaussian Derivative Wavelet (Gaus3): from Remark,  i at scale s could be calculated byAfter calculating  ileft (s) and  iright (s) at all scales,  i should be estimated bywhere N l and N r are length of left and right zero-crossing lines. However, zero-crossing lines at left and right sides of the third Gaussian derivative wavelet are disconnected lines, so it is not easy to estimate  i through). Estimation of peak height: finally, we develop a way to estimate real height of Gaussian peak. With Gaussian peak f i), we haveWe can use (22) to estimate height of Gaussian peak after knowing  i and  i. An Example: to demonstrate the above theory, we assume we have a Gaussian peak as follows:where A x = 10,  x = 5 and  x = 0.5. This peak is added Gaussian noise and baseline as follows:where b is constant, a representation of baseline,  = 0 and  =shrinkage estimator is used to denoise Gaussian noise in signal f (t). The Mexh, Mexican hat wavelet corresponding to Gaus2, is used as core part to detect peak in CWT method () and peak tree method (submitted for publication). Based on result's in, the error rate when using Mexh wavelet () is the largest. We note that we use package 'MassSpecWavelet' () which uses denoising with DWT and finds peak position using ridge lines () with Mexh wavelet. 'Gaus1 with denoise' has the smallest error rate. However, error rates in Gaus1 without denoising and in Gaus2 are still acceptable and much better than in Mexh wavelet. We can estimate  x by (18) or (21). However, with Gaus3, zero-crossing lines are not continuous lines (see Remark in Section 2.2.1). Thus, estimation of zero-crossing in 128 scales of Gaus3 is a problem. This problem causes a larger error in calculating the  x. From result of, we can conclude that Gaus2 with denoising should be used to estimate  x because its error rate is the smallest. By using (22) with zero-crossing lines of both Gaus2 and Gaus3, the height of Gaussian peak is estimated. In this case, baseline b which is used in (24) is a constant. From, Gaus2 with denoising gives the smallest error rate and should be used to calculate A x. i662Page: i663 i659i665From above example, the best way to estimate peak position  x is from the first Gaussian derivative wavelet, Gaus1. The second Gaussian derivative wavelet, Gaus2, should be used to estimate SD  x and height A x of a Gaussian peak.and f shows Ridge lines which correspond to zero-crossing lines inand e. It is clearly that detecting Ridge lines is more difficult than detecting zero-crossing lines. Ridge lines inare similar to Ridge lines in, corresponding to zero-crossing line in Gaus3 which should not be used because of its high error in calculating parameters of peaks.
MS peak detection by Gaussian derivative wavelet
Saving small energy peaks by Envelope analysisEnvelope analysis was introduced by. Any finite energy signal y(t) can be analyzed into three envelope signals including MAX, MIN and MED envelops at the first level. Each of these envelops can be considered as a signal and will be decomposed into three envelopes. In this article, we use MAX and MED envelops to detect peaks because MIN envelops contain no peak. We decompose the original signal into one MAX envelop at level 1, one MAX and one MED envelops at level 2 and four envelops which comprise two MAX envelops and two MED envelops at level n > 2. Empirically, 57 are recommended as the number of levels to get significant peaks.
Proposed GDWavelet methodThe framework of our proposed GDWavelet method is shown in. First, raw MS data is smoothed by bivariate shrinkage estimator (2) in SWT domain to keep true signal and reduce noise. Note that, the lowest frequency detail scale and approximate scale which may include true signal should not be applied with any estimator, so that true signal is not removed. As a result, noise in signal is reduced and smoothed signal still has a little noise. Second, without applying baseline removal that often discards true peaks and creates new peaks, smoothed signal is used to estimate frequency response, position, height and SD of Gaussian peak by zero-crossing lines in multiscale Gaussian derivative wavelet domain. Frequency response of Gaussian peak is proportional to the length of zero-crossing line if the first derivative Gaussian (Gaus1) is used. Peak position,  i , is estimated by (13). SD,  i , of Gaussian peak is calculated by (18). Result of (22) with Gaus2 gives heights of peaks. Using the first and the second derivative Gaussian wavelet, we can estimate all parameters of a Gaussian peak. After removing peaks with frequency response and SD less than a threshold, we get all peak candidates. Third, in peak quantification step, we use two rules to remove false peaks:(i) all peak candidates are quantified by peak rank (PR;) in Envelop analysis. Peaks with PR = 1, even small peaks, are important peaks. (ii) Peak height is used to remove peaks with height smaller than threshold. We use peak height to substitute SNR that was used by, because noise cannot be exactly estimated in either time domain or wavelet domain. Finally, the union results of two quantifying rules are the final detected peaksraw signal and red one is signal smoothed by (2). A zoom in subfigure draws the peak which is used to show its zero-crossing lines in. Using one zero-crossing line in multi-scale of the Gaus1 and two zero-crossing lines in multi-scale of the Gaus2, position, height, SD, and frequency response of this peak are estimated. In, we quantify peaks by two rules: peak height and PR (in Envelope analysis). The circles are results from peak height-based quantification. The stars are from PR-based quantification. Union results include all peaks with heights larger than a threshold or PR one.shows receiver operating characteristic (ROC) curves of four related methods. GDWavlet gives the best performance.
EXPERIMENTS AND DISCUSSIONS
Experimental setupCruzand Emanuele andpresented the extensive studies to compare the performance of state-of-the-art methods for SELDI data preprocessing, including CWT (), Cromwell (), PROcess (), Ciphergen and SpecAlign (). They concluded that CWT () has the best performance. Another method which also works well is Cromwell (). In this section, our GDWavelet method will be compared with the Cromwell (), the CWT () and our previous method, GaborEnvelop (). Cromwell method is implemented by MATLAB which can be downloaded from (UT-MD Anderson Cancer Centre, 2002). The CWT method () was implemented in R (called 'MassSpecWavelet') and Version 1.12 can be downloaded
i663
. If we select s = 100 and  i = 0.1, then u 0 (100+1)u 0 (100) = 1.2247. In conclusion, i660 at :: on August 31, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
at :: on August 31, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
.2 Experimental results Three simulated datasets and one real SELDI-TOF dataset are used to create ROC curves in Figures 4 and 5. In all four datasets, the performance of Cromwell is not stable and gets worse than CWT and GDWavelet. Between GaborEnvelop which used Envelope analysis and CWT which used ridge lines and SNR in peak quantification, GaborEnvelop is better than CWT in real data in Figure 4b and CWT is better than GaborEnvelop in simulated data. In all cases, our GDWavelet method has much better performance than GaborEnvelop and CWT methods. At the same FDR, the sensitivity of our method is consistently higher than GaborEnvelops and CWTs. It is clear that utilizing both of Envelope analysis and Gaussian derivative wavelet in peak quantification made significant contributions to detect both high energy and small energy peaks. Bivariate shrinkage estimator in wavelet domain guarantees that denoising step in our method saves more true signal than in Morris et al. (2005). Zero-crossing lines-based peak parameters estimations in our article is more accurate and robust to noise than ridge lines in Du et al. (2006). Envelope analysis is more efficiently used in GDWavelet than in GaborEnvelop. Therefore, the GDWavelet has better peak detection results than Cromwell, GaborEnvelop and CWT. Thus, it is an efficient and accurate method to detect peaks in both real and simulated MS data. In Figures 4 and 5, CWT's ROC curves is limited in small FDR because two thresholds of the length of ridge lines and the scale corresponding to the maximum amplitude on the ridge line are used as default in MassSpecWavelet (Du et al., 2009). Finally the runtime of GDWavelet algorithm is comparable to CWT method, because both methods need more computational time to decompose a signal to many scale using continuous wavelet transform. 4 CONCLUSIONS In this article, we proposed new zero-crossing line theory in multiscale of Gaussian derivative wavelet to estimate parameters of peaks in MS which has been assumed as a mixture of Gaussian. A novel GDWavelet method was proposed to efficiently and accurately detect MS peaks by integrating bivariate shrinkage model, Gaussian derivative and Envelope analysis. The bivariate shrinkage estimator in SWT domain was used to reduce noise and still keep true peaks. i664 at :: on August 31, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
i665 at :: on August 31, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
