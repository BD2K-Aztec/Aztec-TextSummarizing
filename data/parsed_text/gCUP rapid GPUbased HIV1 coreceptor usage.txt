Next-generation sequencing (NGS) has a large potential in HIV diagnostics, and genotypic prediction models have been developed and successfully tested in the recent years. However, albeit being highly accurate, these computational models lack computational efficiency to reach their full potential. In this study, we demonstrate the use of graphics processing units (GPUs) in combination with a computational prediction model for HIV tropism. Our new model named gCUP, parallelized and optimized for GPU, is highly accurate and can classify 4175 000 sequences per second on an NVIDIA GeForce GTX 460. The computational efficiency of our new model is the next step to enable NGS technologies to reach clinical significance in HIV diagnostics. Moreover, our approach is not limited to HIV tropism prediction, but can also be easily adapted to other settings, e.g. drug resistance prediction. Availability and implementation: The source code can be down-loaded at http://www.heiderlab.de Contact
INTRODUCTIONNext-generation sequencing (NGS) technologies are currently moving into the field of clinical diagnostics, as such enabling the clinicians to analyze not only the majority variants in HIV quasispecies but also smaller fractions and minority variants (). This is especially important for HIV drug resistance prediction, as small fractions of resistant variants can rise during antiviral treatment and can lead to failure of antiviral therapy. An example for such a therapy failure due to minority variants can be found in. We analyzed NGS data from four different patients during treatment with an CCR5-antagonist. These drugs bind specifically to the CCR5 co-receptor on the host cells and, by this, prevent viral entry. However, there exist two classes of HIV viruses, the CCR5using viruses and the CXCR4-using viruses. Obviously, these CCR5-antagonists have no effect on the latter ones. The binding of HIV to the co-receptor is mainly mediated by the so-called V3 loop (), which is part of the surface protein gp120 of HIV. There exist some computational models for HIV tropism prediction, e.g.) and geno2pheno (). These models make their predictions based on genotypic information of HIV, namely the sequence of the V3 loop. Albeit these computational models have been demonstrated to give reliable results on NGS, they all lack computational efficiency with regard to computing time, which is the main bottleneck to clinical relevance of these technologies. Nextgeneration sequencing technologies can generate up to billions of reads for a given sample. For instance, with 454 technology one can generate around 1 million reads, while with the use of the Illumina technology one can generate up to 3 billion reads (). With this large number of reads, minority variants can be reliably detected. However, the huge amount of data generated needs to be efficiently analyzed in a reasonable period. For instance, TCUP, albeit highly accurate, needs around 50 days on a single CPU for 40 million reads from a 454/Roche GS FLX sequencing run. In this study, we introduce and benchmark our new computional prediction model named gCUP. This model is based on our recently developed method T-CUP (), but was redeveloped, parallelized and optimized for the use on graphics processing units (GPUs). In, we demonstrate the accuracy of our T-CUP model for the prediction of HIV-1 tropism compared with other available models. On an independent dataset, T-CUP outperformed Geno2Pheno as well as the model of. gCUP and T-CUP give identical predictions and thus the accuracy of the model is not compromised by using GPUs. By harvesting the power of GPUs and optimizing the use of their fast local memory, gCUP can drastically reduce the runtime and process the same 40 million reads in just 4 min using one modern GPU.
IMPLEMENTATIONFor our GPU-based implementation of gCUP, we used OpenCL on an NVIDIA GeForce GTX 460 with 336 CUDA cores and peak performance of 907 GFLOPS (Giga Floating Point Operations Per Second). gCUP is an R package and uses the C interface of R to manage the computation on the GPU. It seamlessly transfers the data to and from the GPU. gCUP uses as input DNA or amino acid sequences in FASTA format. The results are given as pseudo-probabilites that a given sequence belongs to a CXCR4-using virus and reported in a csv file. The following steps are performed to predict the HIV-1 co-receptor usage for apossibly largeset of input sequences: Preparation and quality control (QC) of the input sequences and translation into proteins is performed on the CPU.Some parts of the preparation are implemented in C for performance reasons. Alignment of the sequence against reference V3 sequence and V3 extraction are using the Gotoh algorithm (). Our implementation is inspired by Ligowski and Rudnicki (2009) and optimizes the use of the fast but small local GPU memory for achieving high performance. Encoding into hydrophobicity and electrostatic potential (ESP) values and interpolation () as well as the classification is done entirely on the GPU. We have built an efficient GPU implementation of the Random Forest that avoids repetitive accesses to the slow GPU global memory and is streamlined to avoid divergent control flow of threads.Note. The mean number of reads per second as well as the variation coefficient of several runs with different sizes (40 000 to 1 300 000 reads) are shown
The Author 2014. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
RESULTS AND DISCUSSION Besides the comparison between T-CUP (written in R) and gCUP (written in OpenCL), we also developed a C-based version of T-CUP (in the following referred to as C-version) to suppress the negative performance effect of R. Additionally, we also tested gCUP on an Intel Core i5-3550 (referred to as gCUP-CPU), as the OpenCL implementation is not restricted to the use with GPUs. The Intel Core i5-3550 has four cores with each being clocked at 3.34 GHz. As shown in Figure 1A and Table 1, gCUP outperforms all the other implementations of T-CUP with regard to number of sequences per second. While T-CUP is able to predict only around 9 sequences per second, gCUP is able to classify4175 000 on average per second. This improvement is neither based only on the fact that gCUP is written in C, as can be seen by comparison between gCUP and the C-version of T-CUP (175 245 versus 4333 sequences per second), nor it is based solely on the OpenCL implementation (10 541 versus 175 245 sequences per second). The high performance increase is based almost completely on the massive parallelization and optimization targeting GPU architecture. We also analyzed the runtime with regard to the different steps that are performed within gCUP, namely QC, alignment of the reads against reference V3 sequence and V3 extraction and hydrophobicity and ESP classification (Fig. 1B). Most of the runtime is needed for the alignment and extraction of the V3 loop from the reads (64.85%). QC makes up the second largest part with 19.93%, while hyrophobicity and ESP classification account only 5.28 and 9.93%, respectively. To the best of our knowledge, this study demonstrates for the first time the successful use of GPUs for HIV-1 tropism prediction based on NGS data. For our solution, no expensive computing clusters are needed. Instead, we used a typical desktop PC with an Intel Core i5-3550 and an NVIDIA GeForce GTX 460, which makes our solution attractive for a broad user community. Moreover, our solution is not limited to tropism prediction. It can also be used for other prediction models, e.g. protease inhibitor resistance and reverse transcriptase inhibitors with comparable speedups (Heider et al., 2013; Lengauer and Sing, 2006), as the current implementation can handle sequences up to a maximum length of 65 535 amino acids, which is enough for all known proteins. Funding: This work was supported by the Straubing Center of Science. Conflict of interest: none declared.
gCUP at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
