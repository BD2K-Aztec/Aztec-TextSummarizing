Motivation: Tandem mass spectrometry (MS/MS) is a dominant approach for large-scale high-throughput post-translational modification (PTM) profiling. Although current state-of-the-art blind PTM spectral analysis algorithms can predict thousands of modified peptides (PTM predictions) in an MS/MS experiment, a significant percentage of these predictions have inaccurate modification mass estimates and false modification site assignments. This problem can be addressed by post-processing the PTM predictions with a PTM refinement algorithm. We developed a novel PTM refinement algorithm, iPTMClust, which extends a recently introduced PTM refinement algorithm PTMClust and uses a non-parametric Bayesian model to better account for uncertainties in the quantity and identity of PTMs in the input data. The use of this new modeling approach enables iPTMClust to provide a confidence score per modification site that allows fine-tuning and interpreting resulting PTM predictions. Results: The primary goal behind iPTMClust is to improve the quality of the PTM predictions. First, to demonstrate that iPTMClust produces sensible and accurate cluster assignments, we compare it with k-means clustering, mixtures of Gaussians (MOG) and PTMClust on a synthetically generated PTM dataset. Second, in two separate benchmark experiments using PTM data taken from a phosphopeptide and a yeast proteome study, we show that iPTMClust outperforms state-of-the-art PTM prediction and refinement algorithms, including PTMClust. Finally, we illustrate the general applicability of our new approach on a set of human chromatin protein complex data, where we are able to identify putative novel modified peptides and modification sites that may be involved in the formation and regulation of protein complexes. Our method facilitates accurate PTM profiling, which is an important step in understanding the mechanisms behind many biological processes and should be an integral part of any proteomic study. Availability: Our algorithm is implemented in Java and is freely available for academic use from http://genes.
INTRODUCTIONPost-translational modifications (PTMs) are known to play a vital role in the cell and are instrumental in many disease-related studies (). A core task in studies involving PTMs is PTM prediction, i.e. identification of peptide sequences and PTMs associated with each modified peptide within a biological sample. A preferred experimental procedure for PTM prediction is tandem mass spectrometry (MS/MS) followed by an analysis with a 'blind' PTM search engine. [See () for reviews]. Blind PTM search engines are commonly used because they can detect both known and novel PTMs. However, PTM predictions produced by blind PTM search engines contain inaccurate modification masses and incorrect modification positions (). The fragmentation process is often incomplete and the presence of labile PTMs may interfere with this process (). These issues result in spectra missing peaks that in turn may lead to ambiguous or erroneous modification predictions. Naturally occurring stable isotopes, such as carbon-13, and electronic noise contribute to inaccurate mass measurements. These issues are more prominent in spectra generated from low mass-resolution spectrometers (e.g. ion trap mass spectrometers), which are still commonly used in today's MS studies. Therefore, it is prudent to incorporate PTM refinement as part of a PTM prediction pipeline, as it can significantly improve the quality of PTM predictions. Previous studies demonstrate that post-processing greatly improves the number of positive predictions while reducing the amount of false PTM assignments (). PTM refinement can be classified into two types of approach: one that scores the localization of PTMs and one that refines observed modification masses and modification positions. The first type provides a way to evaluate the quality of predicted modification sites from PTM search engines. The two main strategies for scoring the reliability of modification site localizations are: (i) to calculate the probability that a peak responsible for the site determination is matched at random and (ii) to compute the search engine score difference between predictions with varying site localizations. Methods that use the former strategy include A-score (), PTM Score (embedded in MaxQuant and Andromeda) (), the *To whom correspondence should be addressed.  The Author 2013. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com Phosphorylation Localization Score (PLS) in InsPecT (), SLoMo (), Phosphinator (), PhosphoRS (). Examples of the latter scoring strategy are Mascot Delta Score (), the site localization in peptide (SLIP) score in Protein Prospector () and the variable modification localization score in Spectrum Mill (). A review of the different modification site scoring localization methods is provided in (). PTM refinement using a modification site localization scoring algorithm can be achieved by reassigning the modification position to the highest scoring position for each modified peptide. However, modification site localization scoring methods are limited when used for general PTM refinement owing to the following three reasons. First, a predefined list of PTMs is required for these scoring methods. Second, these scoring methods assume that input-predicted modification masses are error-free and are mapped precisely to one of the PTMs in the predefined list. Lastly, most of these scoring methods are designed to score only phosphorylated predictions. Consequently, modification site localization scoring methods are ill-suited to analyze PTM datasets generated from blind PTM search engines. The second type of PTM refinement approach is to refine both observed modification masses and modification positions. Two recently published algorithms that use this type of PTM refinement method are PTMFinder () and our previous algorithm, PTMClust (). PTMFinder takes a peptide-level approach to PTM refinement, where it groups and reanalyzes spectra mapping to the same modified peptide sequence to produce for each spectrum a final peptide sequence with a modification mass and a modification position. Hence, refinement using this method is limited to modified peptides that occur multiple times in the same dataset. As shown in a recent study, a modified peptide is rarely found more than three times even for a large-scale, genome-wide experiment (). Furthermore, PTMFinder suffers from favoring high abundance modified peptides and discretizing observed modification masses. In contrast, PTMClust accounts for errors of the observed modification masses and modification positions at the PTM level, and overcomes several issues that PTMFinder has. The principle behind, and the distinguishing feature of, PTMClust is modeling modifications at the PTM level instead of at the peptide level. While peptide-level modeling can benefit from correcting low-level errors, the PTMClust approach has the advantage of accounting for low abundance modified peptides because other peptides with the same underlying PTM can help identify the correct but unknown modification mass and modified amino acid. PTMClust uses a generative model to capture the hidden relationship between factors influencing the PTM mapping process. It uses the expectation-maximization (EM) algorithm and a modified version of the split and merge model selection method to learn and infer an optimal parameter setting for the model. As part of the model selection procedure, a range of models are learned by adjusting a model complexity parameter, and the final model is selected by weighting the trade-off between false positives (determined using decoy peptides) and correct (real) peptides detected. The resulting PTM predictions are of higher quality than those taken from existing blind PTM search engines alone and those post-analyzed with PTMFinder (). Here, we address some limitations of PTMClust: (i) the use of a greedy method for selecting the number of PTM clusters, (ii) the need for manual parameter tuning, and (iii) the lack of a confidence score per modification position. We overcame these limitations by extending the PTMClust model to allow for an unbounded number of mixture components that can account for uncertainties in the quantity and identity of PTMs in the input data. The model makes use of an infinite non-parametric mixture model, so we refer to it as infinite-PTMClust or iPTMClust. This extension parallels the conversion from a finite to an infinite standard mixture model (IMM), but the complex nature of the underlying PTMClust model makes this extension non-trivial. We derived and implemented a Gibbs sampling algorithm () and a split-and-merge Metropolis-Hastings algorithm (), which enable iPTMClust to efficiently infer the groupings of input modified peptides and refine the peptides' modification masses and modification positions. iPTMClust achieves the following benefits: (i) it outperforms PTMClust and other PTM refinement algorithms, (ii) it provides a more highly automated model selection method that does not require manual parameter tuning, and (iii) it outputs modification position-level confidence scores that users can use to assess the quality of the result and further refine their analyses. In a series of benchmark experiments on both synthetic and real-world phosphopeptide datasets, we show that iPTMClust outperforms PTMClust and other state-ofthe-art PTM prediction and PTM refinement algorithms. To ensure broad applicability, we have designed and optimized iPTMClust to analyze PTM data generated from both lowand high-resolution MS/MS spectra processed by popular blind PTM search engines. As with PTMClust, the input to iPTMClust is a list of PTM predictions consisting of the peptide sequence, modification position and modification mass.
METHODSSimilar to PTMClust, iPTMClust is based on a generative probability model that describes a process in which observed modified peptides can be generated by modeling interactions between hidden variables that play a role in the protein modification process. Given an observed modification, we assume it comes from one of many PTMs. However, the number and identity of these PTMs are unknown. Our method accounts for this uncertainty by considering a variable unbounded number of PTMs. By defining appropriate priors on the hidden variables, over-fitting can be avoided, and only a finite set of PTM groups are used at anytime during inference. The latter point is important because it makes calculations in the algorithm tractable. During inference, the properties of the active PTM groups are influenced by the input data and the chosen priors. We adapted both the Gibbs sampling and the restricted Gibbs sampling split-merge algorithms to infer the values of the hidden variables and parameters in our model. After inference, these hidden variables and model parameters can be used to deduce the true modification mass and a confidence score per possible modification position for each input peptide sequence, or the maximum a posteriori (MAP) estimate of modification masses and positions.
iPTMClust model and conditional distributionsThe core of the generative model in iPTMClust is the same as in PTMClust: it describes how a pair of observed modification mass and modification position are generated. iPTMClust extends PTMClust by introducing priors on model variables and parameters that govern the choice of active PTM groups from a boundless number of PTM groups. Given the type of PTM (PTM group) chosen from one of the limitless numbers of PTM groups, we can generate the observed modification mass as a noisy version of the mean modification mass, and select an amino acid most likely to contain the modification as the modified amino acid. Given the peptide sequence, we assume that the 'true' modification position is uniformly distributed among those positions that match the modified amino acid. Finally, we assume that the observed modification position is a noisy version of the true modification position. The structural relationships between variables are shown by the Bayesian network in. The top part outlines the priors represented by their corresponding hyper-parameters placed on the model parameters: mixing coefficient, modification mass means, modification mass variances and probability of modification occurring on an amino acid. The bottom portion describes the model for one input peptide and is repeated for N measurements, as indicated by the plate notation. The extension from PTMClust to iPTMClust follows similar steps as for a standard mixture model, as given in (). In the following, we outline the rational and intuition behind the different components of our model, and the conditional probabilities used during Markov chain sampling. Details can be found in the Appendix. In our model, each input peptide sequence S n , indexed by n 2 f1, :::, Ng, where N is the number of peptides in the dataset, has a corresponding discrete peptide length L n , observed modification position x n 2 f1, :::, L n g and observed modification mass m n. We denote the amino acid in position j of the input sequence n as S n j. The total number of values S n j can take on is A  24, which includes the 20 naturally occurring amino acids and four special characters indicating the beginning and end of proteins and peptides. Additionally, we denote o k to be the unknown number of input peptides assigned to cluster k. The hidden variable c n 2 1, ::, 1 denotes the unknown PTM group that peptide sequence n is assigned to. Following from the derivation of IMMs with a Chinese Restaurant Process (), its probability conditioned on all other c n 's takes into consideration the likelihood of the n-th input modified peptide belonging to the PTM group index is given asis the number of peptides assigned to cluster k that does not consider the n-th peptide sequence, Nnn indicates all indices excluding n, C Nnn is shorthand notation for C i : 8i 2 fNnng, b is the appropriate normalizing constant so the probabilities sum to one, is the hyperparameter concentration parameter and  represents hyper-parameters , , ', , and !. Furthermore, we can write the conditional posterior probability for c n that takes into consideration the likelihood of the n-th input modified peptide belonging to the PTM group index by c n , using parameter setting from the previous sample iteration, as follows, using D to indicate the observed data:where represents parameters , AE and , and H 0 indicates the prior distribution placed on , AE and. The calculations of the conditional posterior probability Pa n , z n , x n , m n jc n , S n ,  and the integral R Pa n , z n , x n , m n , jc n , S n , @H 0  are given later in Equations 13 and 14, respectively. Given a vague inverse gamma prior on , P  IG1, 1, its conditional posterior can be derived by combining the joint distribution of c n 's with the prior to give Pjk, N / k3=2 exp 2We assume that the observed modification mass for each PTM group is normally distributed around the true modification mass, Pm n jc n  k  N  k , AE k , where k and AE k are the mean and variance of the modification mass in the k-th PTM group. For mathematical convenience, we used the conjugate prior normalinverse gamma distribution with hyper-parameter mean , variance , shape ' and scale 1 for all PTM groups. Broad and vague corresponding priors are given to each hyper-parameter to account for uncertainty in their values (see Supplementary Information for details). Given the combination of prior and hyper-prior distributions used, the conditional posteriors for , , ' and have the following forms:where  and 2  are the mean and variance of the observed modification masses,  is the gamma function with the form n  n  1! for a positive integer n and 1  k is shorthand for 1, :::, k. By using conjugate priors on k and AE k , both these parameters can be integrated out to give a probability of m n based directly on the hyper-parameters:. A Bayesian network describing the generative model for our new algorithm iPTMClust, using plate notation. The shaded nodes represent observed variables, the unshaded nodes represent hidden variables and hyper-parameters are shown outside of the plates. The model describes how the observed modification mass and position are generated. The bottom part captures the assumptions about how each observation is generated. The plate notation indicates that there are N copies of the model, one for each measurement. The top portion outlines the structure of the hierarchy of priors and hyper-priors placed on the model parameters, mixing coefficients, modification mass means, modification variances and probability of modified amino acid. The outer plate shows that there is potentially an infinite number of clusters, one for each possible PTM group. The probability of modified amino acid kj is embedded in two plates signifies that there are K  A copies, one for each K ! 1 PTM groups and A possible amino acids where t is the Student's t-distribution, o k is the number of peptides assigned to cluster k, ^ '  'ok ":8i, cik m i is the average observed modification mass for peptides assigned to the k-th PTM group. Let a n : n 2 f1, :::, Ng denote the true (hidden) modified amino acid (i.e. the amino acid that the PTM occurs on) for the n-th peptide sequence. Then, the probability of a n given that the PTM group is k is modeled as a multinomial distribution with parameters ki 8i  1, :::, A. A conjugate Dirichlet distribution with hyper-parameter ! is used for ki. The hyper-parameter ! is given a vague inverse gamma distribution. Because a conjugate prior is used on the ki 's, we can integrate them out using a standard Dirichlet integral. This leads to the conditional posterior of a cluster assignment given all others:where Pz n , x n ja n , S n  can be factorized into Pz n ja n , S n Px n js n . Both Pz n ja n , S n  and Px n js n  are discussed below. The conditional posterior for the hyper-parameter ! can be derived similar to Equation 3 to giveThe details of the rest of the model are the same as those in PTMClust given in (). To reiterate, given the peptide sequence S n and true (hidden) modified amino acid a n , we assume the distribution over modification position z n is uniform over those with matching amino acids:where ni denotes the number of times amino acid i occurs in sequence n and z n  0 indicates that the true PTM occurs outside of the given peptide sequence. Given the true modification position z n , the probability of modification position error (x n  z n ) for the observed modification position x n is modeled with a discrete probability distribution, given asPx n jz n  j  x n  j if j40 L n  if j  0 0 otherwisewhere the likelihood function accounts for the modification position error. This likelihood function is shared across all PTM groups and was inferred from our empirical observation of the yeast PTM dataset as described in (). Finally, we outline how the conditional posterior probability Pa, z, x, mjc, S,  and the integral R Pa, z, x, m, , AE, jc, S, @H 0 , AE,  used in Equation 2 can be evaluated analytically. Based on the structure of the Bayesian network of our model given in, for a given PTM group k, Pa, z, x, mjS,  can be derived as follows:where H n, k is the posterior distribution of , AE and based on their priors and all peptides that are assigned to the k-th PTM group excluding the n-th peptide sequence, and the variables ^ ', ^ , ^ and ^ are defined before in Equation 8. It is easy to see the integral with respect to priors R Pa n , z n , x n , m n , , AE, jc n , S n , @H 0 , AE,  for unoccupied clusters is equivalent to setting o k  0 in Equation 13, which can be written asBy combining the structure of the Bayesian network and the conditional distributions described above, we can write the joint distribution aswhere  represents the model hyper-parameters for the hyper-priors placed on , , , ', and !.
Markov chain inference methodThe combination of complicated interactions of hidden variables and priors in iPTMClust leads to a complex joint distribution over high-dimensional spaces, which is impossible to characterize analytically in its entirety. So, we use an approximate Markov Chain Monte Carlo (MCMC) method (). MCMC methods are commonly used for IMM models. In MCMC sampling, the model posterior distribution can be sampled to collect instances of parameter and variable settings likely under the model. Given a large enough collection of samples, the posterior can be approximated, and the ideal settings of model parameters and hidden variables can be inferred. Although the Gibbs sampling algorithm is a commonly used MCMC sampling method for non-parametric Bayesian clustering models such as ours, it can mix poorly and produce poor results when the input dataset is large and complex (). Hence, in addition to the Gibbs sampling method, we derived and implemented the restricted Gibbs sampling split-merge algorithm (or the split-merge sampling algorithm for short) () for iPTMClust. The split-merge sampling algorithm is designed to mitigate the aforementioned issues with the Gibbs sampling method. We adhered to the recommended settings for running this sampling algorithm given in (). Both of the methods with and without split-merge steps require Gibbs sampling updates. For each Gibbs sampling step, we use the following procedure. First, we sample the set of hidden variables (parameters are considered as hidden variables) associated with input peptide n, where n 2 f1, :::, Ng. Starting with the n-th input observation, for each represented (occupied) cluster K rep , we draw a n according to Equation 9 and z n using Equation 11. Next, we sample a new cluster assignment c n from Equation 2. Finally, we update the sufficient statistics associated with assignments for c n and a n. We repeat this procedure for each input peptide sequence. At the end of each Gibbs sampling step, we obtain a new value for each hyper-parameter, with the exception for , ! and ', directly by sampling from their conditional posterior distribution given in Equations 4, 5 and 6, which are all distributions of standard form. Although they are not standard distributions, the conditional posteriors for , ! and ' are all log-concave, which implies that they are unimodal in the logarithmic domain and have a single global optimum. The log-posteriors of , ! and are given aswhere C is a normalizing constant. Given the equations for the log-posteriors and their log-concave property, a new value for each hyper-parameter can be efficiently sampled using the efficient, easily implemented slice sampling method (). The MCMC sequence is guaranteed to converge to the exact posterior, eventually. However, in practice, it is common to terminate the sampling procedure after a fixed number of iterations, based on an analysis of how well the chain has mixed according to trace plots of the distribution of posterior probabilities and the number of clusters over time. Furthermore, samples from a burn-in period at the beginning of the chain, before mixing has occurred, are discarded. Again, this is determined using trace plots. We found that 1000 burn-in samples and a total of 15 000 samples are enough to produce a good approximation of the posterior for the large-scale PTM datasets we studied, including the phosphopeptides, yeast proteome and human proteinprotein interaction datasets described below. Details of this analysis, including trace plots, are given in Supplementary Information. For simpler datasets, such as the synthetic and phosphorylation datasets, a setting of 100 burn-ins and 6000 total samples was sufficient. A detailed analysis is provided in Supplementary Information. Lastly, to counter auto-correlations amongst the samples, we only use results taken from every fifth sample.
Background modelUnlike PTMClust, the background model for iPTMClust does not explicitly encompass a predefined background component. Instead, it uses a background model consisting of multiple background components learned directly from the input data. Based on the modification mass variance calculated for each PTM group, we define a background component to be a PTM group with a variance ! 2:0. This threshold is chosen based on the assumption that valid PTM groups should have well-defined modification masses, and thus have low variance. By allowing for multiple background components instead of one, we observe empirically that the new model is better at capturing spurious data.
RESULTSOur first goal is to demonstrate that iPTMClust outperforms existing algorithms both in terms of finding correct clustering assignments and in refining PTMs on a set of noisy modified peptide sequences. To this end, we conducted two experiments. We benchmarked iPTMClust against standard clustering algorithms, k-means and MOG, as well as our previous algorithm PTMClust. The key observation, given in Supplementary, is that iPTMClust using the split-merge algorithm attains the most consistent results across different settings and achieves increasingly better results than PTMClust as the problem becomes more complex. Given that the true modification positions are known for simulated data, we can evaluate how well PTMClust and implementations of our new algorithm perform for the task of PTM refinement. Supplementaryshows the same trend as above: iPTMClust with the split-merge algorithm outperforms the others in almost all cases. We also compared blind PTM search engines SIMS (), InsPecT () and MODmap (), a state-of-the-art PTM refinement algorithm PTMFinder and our algorithms PTMClust and iPTMClust on detecting the true modification positions from a well-studied phosphopeptide dataset. In each of the experiments, we use both the split-merge and the Gibbs sampling inference algorithms for iPTMClust. We report results based on MAP estimation for iPTMClust for both experiments.The second goal is to directly show the applicability of iPTMClust to datasets taken from studies of complex protein solutions. To achieve this goal, we analyze data taken from a genome-wide yeast and a human chromatin-specific protein complex study. We have limited our analyses to only post-processing PTM predictions generated from SIMS with either PTMClust or iPTMClust. We include analysis from PTMClust to highlight that iPTMClust is producing sensible results. In these experiments, we initialize k-means, MOG and PTMClust with settings that are outlined in (). The settings for the number of burn-in and total samples for iPTMClust are described in the Supplementary Information.
Benchmarking against phosphopeptide predictionsWe compare iPTMClust against current PTM search engines and PTM refinement algorithms using a real-world dataset enriched for phosphopeptides containing modification sites that are validated (). We will refer to the identities of the known peptide sequences and their modification sites as the reference. The dataset consists of 1655 spectra, but we will focus exclusively on the 1340 spectra mapped and curated as singly modified phosphopeptides (SIMS, InsPecT, PTMClust and iPTMClust are limited to one modification per peptide sequence). In this analysis, we define positives (P) as outputs from the base blind PTM search engine that match to the reference considering only their peptide sequence, i.e. disregarding the positions of their modification, and negatives (N) as all other outputs that do not match their corresponding reference peptide sequences. Each blind PTM search engine produces a different number of P and N. For SIMS, PTMClust and iPTMClust (SIMS was used as the base blind PTM search engine), there are 895 P and 445 N. Lastly, for PTMFinder, which uses InsPecT as its base unrestricted PTM search engine, there are 860 P and 480 N. For iPTMClust, in addition to the MAP estimate, we considered inference by averaging over samples to produce a confidence score per modification position for each output peptide sequence. By varying the confidence threshold setting, we can adjust the sensitivity and specificity of the PTM predictions. For iPTMClust results evaluated using confidence scores, we define a PTM prediction as a peptide sequence and its modification positions with confidence scores above the threshold; peptide sequences that do not have at least one modification position with a confidence score above the threshold are considered to be assigned to the background model. For PTMClust and iPTMClust using MAP estimate, a prediction is any peptide sequence not assigned to the background model. All peptide sequences assigned to the background model are removed from the evaluation. Lastly, we consider all outputs as predictions for the other algorithms because they do not use a background model. Given the true phosphorylation of each peptide are known, we plot the number of correct phosphorylation sites versus the number of incorrect phosphorylation sites identified infor the results of iPTMClust, PTMClust, PTMFinder and InsPecT. For this experiment, the blind PTM search engine InsPecT was used to analyze the input spectra, then each of the PTM refinement algorithms, iPTMClust, PTMClust and PTMFinder, were used to post-process the PTM predictions output from InsPecT. For iPTMClust, we included results for both the split-merge and Gibbs sampling methods using either MAP estimation or inference by averaging over samples. We varied the confidence threshold to obtain a series of results for iPTMClust using inference by averaging over samples. Four key observations can be made from the result: (i) iPTMClust outperforms all other algorithms, including PTMClust and PTMFinder; (ii) iPTMClust with inference by averaging over samples produces better results than its MAP estimate counterpart; (iii) a background model is essential for collecting spurious modifications; and (iv) iPTMClust with the split-merge inference algorithm performs similarly to iPTMClust with the Gibbs sampling algorithm except at the region with low number of incorrect phosphorylation sites identified, where the Gibbs sampling method is performing marginally better than its counterpart. The first observation reinforces our conclusion from the study on synthetic data that iPTMClust outperforms other PTM refinement algorithms. The second highlights the advantage of providing a confidence score per modification position, where adjusting for the confidence threshold allows us to achieve improved results over MAP estimation. Finally, the results highlight a major benefit of iPTMClust beyond PTM refinement, i.e. removal of noisy data. Next, we conducted the same experiment by post-processing the output from SIMS with PTMClust and iPTMClust to ensure that our algorithms are not biased towards any one particular blind PTM search engine. Similarly, we plot the number of correct phosphorylation sites versus the number of incorrect phosphorylation sites identified infor the results of iPTMClust, PTMClust and SIMS. Because PTMFinder is tightly integrated into the InsPecT algorithm, we were not able to decouple PTMFinder from InsPecT to post-process the output from SIMS. Therefore, PTMFinder is omitted from this analysis. The results based on the PTM predictions generated by both SIMS and InsPecT (discussed above) show the same three trends: (i) iPTMClust outperforms all other algorithms;(ii) iPTMClust with inference by averaging over samples produces better results than its MAP estimate counterpart; and (iii) a background model is essential for collecting spurious modifications. Specific to this experiment based on the output from SIMS, we observe that iPTMClust with the split-merge inference algorithm markedly performs better than iPTMClust with the Gibbs sampling in two conditions: when MAP estimate is used and at the region between 30 and 145 number of false phosphorylation sites identified when using inference by averaging over samples. The full list of resulting PTM predictions by SIMS and then post-processed with PTMClust and iPTMClust (one technical replicate) is given in Supplementary Table S2. The result shows in addition to being able to correctly refine PTM predictions, iPTMClust can detect noisy data and rightfully assign them to the background model. Given enough sampling iterations, iPTMClust is able to produce remarkably consistent results. Of the correctly identified phosphopeptides by iPTMClust, $ 98% of them are found by all five technical replications. This is true for either sampling methods. Minor differences are expected and are due to the stochastic nature of the inference methods used in iPTMClust. Furthermore, trace plots of log joint probability distributions and numbers of non-background PTM groups identified, shown in Supplementary, illustrate that iPTMClust using both the split-merge and the Gibbs sampling methods mixes well after 1000 burn-in iterations, and 15 000 iterations are enough to estimate the posterior. Both the trace plots and level of consistency suggest that iPTMClust in each run have converged to a high posterior likelihood solution. The computational time for iPTMClust is heavily dependent of the number of samples collected during inference, which were 15 000 iterations for this experiment. Keeping in mind that an MS/MS experiment takes hours, and in the case of a shotgun proteomics () 12 h, the time it took iPTMClust to analyze the phosphopeptide dataset (on average $50 mins for Gibbs sampling and $70 mins for Spit-merge sampling) is a reasonable investment for higher-quality PTM predictions. As compared with other tested algorithms, iPTMClust took a longer time than InsPect ($2.5 mins) and PTMFinder ($4 mins), and on par with SIMS ($55 mins) and PTMClust ($70 mins). All the algorithms, single process applications, were run on a computer with Intel Xeon 3.0 GHz CPUs and 32 GB of RAM. iPTMClust makes a trade-off with longer computational time for superior quality PTM predictions.
Large-scale PTM analysis of yeast proteomeThrough a series of benchmark experiments, we have shown that iPTMClust beats state-of-the-art algorithms, including our own PTMClust. Furthermore, we demonstrate that iPTMClust using the split-merge sampling method produces improved results over the one using the Gibbs sampling method. Next, we will test iPTMClust's versatility in detecting diverse PTM groups by applying it to analyze a large-scale PTM dataset taken from analyses of the yeast proteome (liquid chromatography (LC)-MS/MS spectra only) () using SIMS. Briefly, the yeast dataset consists of more than 2 million ion trap MS/MS spectra of which 19 560 putatively modified peptides were identified by SIMS with modification range (0, 200) Da.with output from SIMS are used as the baseline. The curves for iPTMClust using the split-merge and the Gibbs sampling algorithm are produced by calculating a confidence score per modification position through inference by averaging over samples and varying the confidence score threshold. These methods for evaluating the result outperform their counterparts using MAP estimation. More importantly, iPTMClust using any one of the inference methods achieves better results than InsPecT, SIMS,
A B
PTMClust and PTMFinderThe estimated false discovery rate for the predictions made by SIMS is 4.3% based on the number of decoy peptides identified. Here, we present the result taken from our post-analysis using iPTMClust with the split-merge algorithm (MAP estimate was used). MAP estimate is used to simplify the analysis and the mapping to known PTMs. The specific setting used for PTMClust is described in (). The known set of modifications was taken from Uniprot (Release 2010_11). We matched the sets of modified peptides produced by SIMS and post-processed with iPTMClust with the split-merge algorithm, iPTMClust with the Gibbs sampling algorithm and PTMClust to the set of known yeast modification sites. This table shows the number of peptides and unique sites that are mapped to known PTMs. The results show iPTMClust is able to improve on SIMS and significantly outperform PTMClust in a complex dataset. A summary of commonly known PTMs taken from the Uniprot knowledgebase () that are found in our dataset is shown in. Overall, iPTMClust using either the split-merge or the Gibbs sampling method is able to reposition a large portion of modifications to known PTM sites that were missed by SIMS originally (increase of $ 49% unique PTMs and $ 34% modified peptides for split-merge, and $ 55% and $ 43% for Gibbs). This represents a significant increase over what can be achieved using PTMClust. The most improvement is gained with phosphorylation sites, where post-analysis with iPTMClust is able to identify 465% more (known) unique sites and almost double the number of instances of phosphopeptide when compared with the result obtained from SIMS. However, iPTMClust using the split-merge method incorrectly places a number of peptides with acetylation and other modifications in the background model that SIMS correctly identified. We note that iPTMClust using the Gibbs sampling method and PTMClust did not make this mistake. A closer look reveals that many of these instances belong to a few unique peptide sequences. The analysis on the yeast proteome dataset confirms that iPTMClust can detect other PTMs such as acetylation and cysteine oxidation (cysteine sulfinic acid) in addition to phosphorylation. Moreover, the results reiterate that iPTMClust using either the split-merge or the Gibbs sampling method can refine a greater number of PTMs than PTMClust.
Analysis of human proteinprotein interaction dataProtein complexes and proteinprotein interactions studies are a major focal point in the field of proteomics. However, to date, the focus has been mainly on finding complex memberships and interaction partners. Because it is well established that PTMs, such as phosphorylation and acetylation, play a vital role in the formation and regulation of proteinprotein interactions, we seek to complement these studies with an emphasis on the identification of PTMs. The dataset we used consists of high mass-resolution MS/MS spectra (Orbitrap mass spectrometer) from a human protein protein interaction study searched using SIMS. The study is a collaboration with the Emili lab at the University of Toronto, and the dataset is not yet published at the time of writing. The experimental protocol used is tandem affinity purification () followed by MS approach. Briefly, the method proceeds by placing a biological tag on all instances of a member of the complex of interest. Next, these tagged proteins are isolated and purified along with their interacting proteins, and finally, the set of purified proteins are subjected to MS analyses. Here, we chose to focus on three well-studied protein complexes, the Mediator (MED), the RNA Polymerase II (POL2) and the Polycomb Repressive Complex 1 (PRC1). This dataset consists of 17 experiments. These experiments include technical replicates, covering 6 of 12 proteins known to be in the MED complex, two experiments covering 2 of the 32 members of the POL2 complex and three experiments covering 2 of 12 members of the PRC1 complex. There is a total of 13 221 spectra mapped to modified peptides by SIMS (estimated false discovery rate of 13.5% based on the number of decoy peptides identified) with a modification range (0, 300) Da. Supplementaryhighlights the 48 distinct peptide sequences putatively identified to be modified either with acetylation or phosphorylation. Including duplicates, 114 modified peptides were found. Of the 48 unique peptides, 9 had at least one instance with their modification site corrected by iPTMClust using the split-merge sampling algorithm that was originally misplaced by SIMS. These are highlighted in bold. We speculate this smaller number improvement is due to two major reasons: (i) a majority of the listed PTMs are acetylation, which SIMS does a good job with, as seen in the yeast study above, and (ii) spectra are cleaner owing to the use of a high-resolution mass spectrometer. In this list, there are 15 putative novel modification sites and 33 known ones according to the Uniprot knowledgebase (). Although the complete list is not shown, after removing those assigned to the background model, we have identified 10 409 putative modified peptides such that alarge portion of them is mapped to regions in their respective proteins that do not contain known PTMs. Similar to those listed putative, novel phosphorylated and acetylated peptides, we believe this list also contains many high-quality new PTM discoveries. Hence, this list represents a filtered list of high-quality candidates for further investigation. We have shown a PTM prediction pipeline comprises a blind PTM search engine, and iPTMClust can be fruitful in novel discoveries and should be used routinely. The use of a high mass-resolution mass spectrometer is expected to reduce errors and potentially remove the need for refinement of measured modification masses. Even so, we noticed many instances where the observed modification mass deviates from our refined modification mass by $1 Da. This modification mass error is believed to be due to the presence of isotopes. Although heuristics can be used to account for these mass shifts, such methods can be error-prone and cannot adapt to unforeseen mass errors. Our results show that iPTMClust can handle such errors and improve the quality of PTM predictions taken from an analysis of a high mass-resolution mass spectrometer.
CONCLUSIONAccurately identifying PTMs and their potential roles in clinical studies such as biomarker discovery and drug development is an important task. Although thousands of PTM candidates have been reported using blind PTM search engines (), these blind PTM search algorithms suffer from mass measurement inaccuracy and uncertainty in predicting modification positions, making the findings error prone. The importance of post-processing PTM predictions using a PTM refinement algorithm have been established in (). The previous state-of-the-art algorithm, PTMClust, achieves a significantly higher PTM prediction accuracy over blind PTM search engines alone and outperforms existing PTM refinement algorithm, PTMFinder. Despite significant improvements in PTM prediction, PTMClust has three main drawbacks of particular interest: (i) it uses of a greedybased non-automatic model selection algorithm, (ii) it requires manual parameterization on the maximum number of PTM groups and (iii) it does not provide a confidence score per modification position. To address these issues, we introduce iPTMClust. iPTMClust extends PTMClust by using an infinite mixture model approach that achieves the following three benefits: (i) outperforming PTMClust and other PTM refinement algorithms, (ii) providing a fully automated model selection method without the need for any manual parameterization, and (iii) offering modification position level confidence scores that users can use to assess the quality of the results and to greater refine their analyses. Through a series of benchmark experiments using both synthetic and real (phosphopeptides and yeast proteome) data, we demonstrated that iPTMClust better models the PTM generative process and outperforms PTMClust, PTMFinder and other blind PTM search engines. In addition, we analyzed data generated from a yeast proteome study using iPTMClust in which we reported an improvement over the base blind PTM search algorithm SIMS in detecting annotated PTMs. Thousands of putative PTMs were found in this analysis. Moreover, in our in-depth look at PTM predictions for three human protein complexes, MED, POL2 and PRC1, iPTMClust identified numerous validated and putative phosphorylated and acetylated peptides that may be involved in the formation and regulation of proteinprotein interactions. Further investigations are warranted, but we believe a number of these putative predictions are valid PTMs and can serve to further our understanding of the complexities involved in proteinprotein interactions. To summarize, our new algorithm iPTMClust is easy to use, achieves overall greater performance than the state-of-the-art, provides confidence scores at the modification position level that allow for a higher flexibility when evaluating potential PTMs and is designed to be broadly applicable to PTM predictions generated from any blind PTM search engine. Given the rapid advancement of mass spectrometer technology, how applicable is iPTMClust going forward? We explore this question by analyzing data generated from high massresolution mass spectrometers, e.g. from an Orbitrap. Although mass accuracy has improved with the use of high mass-resolution mass spectrometers, the presence of isotopes, for example, can result in deviations in observed modification masses. In addition, higher mass accuracy does not necessarily equate to errorless modification site determination. We have shown in our analysis of the human protein complex data that problems with mass measurement inaccuracy and uncertainty predicting modification positions continue to exist for data generated from high mass-resolution mass spectrometers, such as an Orbitrap used in the experiment. Our results demonstrate that iPTMClust can improve on PTM predictions taken from data with high mass accuracy, and continue to be a vital component of a genome-wide PTM study. In designing iPTMClust, we have developed two different inference algorithms, the split-merge Metropolis-Hastings and the Gibbs sampling algorithm. While the Gibbs sampling method is the standard inference algorithm for Bayesian mixture models and IMMs, the split-merge method is shown to perform better when dealing with complex datasets (). Results of our synthetic data experiments also exhibit this trend. iPTMClust using the Gibbs sampling method displays a performance drop, while its counterpart using the split-merge sampling algorithm perform consistently well as the data used gets more complex. It is important to note that when there are few PTMs within a small modification mass window, say 12 Da (e.g. when two or three PTM groups added in our experiment with the synthetic data), our algorithm using the Gibbs sampling performs at par with or slightly worse than its counterpart using the split-merge method. Furthermore, iPTMClust using the Gibbs sampling runs faster per iteration ($ 50% quicker) than iPTMClust using the split-merge method. Hence, for large datasets, where running time can be overwhelmingly long, we recommend running iPTMClust with the Gibbs sampling method as it provides a good trade-off between quality of the result and computational cost. Despite outperforming its competitors, iPTMClust has a number of limitations. Similar to PTMClust, it is unable to handle more than one modification per input peptide sequence, and PTM groups identified can contain multiple PTMs if their modification masses are similar. The latter problem is less of an issue when working with high mass-resolution data. Moreover, iPTMClust does not consider the underlying spectrum when refining a PTM prediction. The presence of certain peaks in the spectrum can add to support to a residue along the peptide sequence as being the modification position. Its limitations notwithstanding, iPTMClust is shown to outperform both PTMClust and previous state-of-the-art in our benchmark tests using both synthetic and real-world PTM data.
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
C.Chung et al. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
iPTMClust: Non-parametric Bayesian PTM refinement algorithm at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
