Motivation: Simple forms of mutualism between microorganisms are widespread in nature. Nevertheless, the role played by the environmental nutrient composition in mediating cross-feeding in microbial ecosystems is still poorly understood. Results: Here, we use mixed-integer bilevel linear programming to investigate the cost of sharing metabolic resources in microbial communities. The algorithm infers an optimal combination of nutrients that can selectively sustain synergistic growth for a pair of species and guarantees minimum cost of cross-fed metabolites. To test model-based predictions, we selected a pair of Escherichia coli single gene knockouts auxotrophic, respectively, for arginine and leucine: DargB and DleuB and we experimentally verified that model-predicted medium composition significantly favors mutualism. Moreover, mass spectrometry profiling of exchanged metabolites confirmed the predicted cross-fed metabolites, supporting our constraint based modeling approach as a promising tool for engineering microbial consortia.
IntroductionIn nature, beneficial interactions between species dramatically contribute in shaping ecosystem dynamics and survival. Microbes form stable relationships with a multitude of different organisms, and many of these relationships have a direct impact on human health (). Hence, in spite of an increased complexity, the attention has been shifted from studying individual microorganisms to investigating the capabilities of microbial consortia as such (). In parallel, several microbial communities have been engineered for bioremediation (), metabolic engineering () and biomedical utilization (). However, understanding the ecological principles that shape and drive dynamics and evolution of microbial ecosystems remains a challenging task.Cooperative interactions between species can take place at different levels. One of the most common cooperative interaction is metabolic, although such type of interactions can have radically different nature. In some cases only one species benefits from the community without participating in sharing metabolic resources (i.e. altruism versus parasitism), while often bacteria can establish mutually beneficial inter-species interactions (). In this bidirectional interaction a pair of organisms receives an advantage from each other, typically in terms of cross-fed metabolites. Nevertheless, mapping these interactions within a microbial community is hampered by the complexity and dynamic nature of multispecies ecosystems. To reduce problem complexity, artificial microbial communities have been successfully used to shed some light on the complex relationships between genetic interactions and microbial community's behavior (). In parallel,). The development of large-scale stoichiometric models combined with linear programming approaches has facilitated the quantitative understanding of microbial metabolism (). In this constraint-based framework, the detailed reconstructions of metabolic reactions are deprived of their kinetic and efficiency parameters and are investigated as chemical reaction matrices. Control strategies that optimize microorganism growth are used to select biologically meaningful steady-state flux distributions among an ensemble of in silico cell phenotypes (). The ability to simulate distributions of fluxes, in various microorganisms () and under diverse perturbations () (), renders this simple method valuable for diverse applications (; Tepper and Shlomi, 2010; i.e. metabolic engineering, drug discovery, etc.). Using stoichiometric models to capture complex cooperative behavior within microbial communities, however, is still an open challenge (). Recently, a set of 46 Escherichia coli single gene knockouts, auxotrophic for different classes of amino acids and nucleotides, were used to test their ability to establish synergistic growth (). Each pair of mutants was co-cultivated in a glucose minimal medium and growth was monitored over a 4-days period. Under this particular nutrient composition, none of the mutants was capable of surviving individually, but significant growth was detected for 17% of the co-cultivated pairs. Because of their reduced complexity, these synthetic microbial communities enabled the use of quantitative predictive models (e.g. constraintbased models) to resolve the underlying molecular interactions. Joint biochemical reaction networks and flux balance analysis were used to predict whether a pair of E.coli knockouts can grow by sharing essential metabolites (). This constraint-based modeling approach has been shown to be too permissive, allowing synergistic growth for more than 90% of the 1035 mutant pairs. One of the limits of this approach is that the cost of sharing metabolic resources between microorganisms is typically not taken into account. Within a community, altruism in bacteria should be promoted in order to sustain mutualistic type of interactions. This could be obtained by an appropriate environment, where sharing metabolic resources is crucial for survival of the different species () and the cost of producing essential metabolites is minimized (). To this end, we here propose an algorithm to predict an optimal nutrient composition that prevents growth of two species when grown in isolation, but promotes their synergistic growth by minimizing the cost of sharing essential metabolites (). To experimentally test our in silico predictions we selected a pair of single E.coli gene knockouts: DargB and DleuB, auxotrophic, respectively, for arginine and leucine. These two strains exhibited poor synergistic growth in a glucose minimal medium (), and, more generally, cross-feeding of arginine and leucine was found to induce moderate and very low cooperativity, respectively (). We applied our algorithm and simulated synergistic growth of DargB and DleuB in a glucose minimal medium and in the model-based predicted medium, where the cost of the interaction was predicted to be significantly lower. We experimentally tested the ability to coculture these two E.coli knockout strains in a minimal M9 medium supplemented with nucleotides precursors, as suggested by the model, and showed significantly improved synergistic growth. By monitoring the supernatant composition using a sensitive mass spectrometry approach, we could also identify the most relevant exchanged metabolites between the two strains and support model predictions.
Materials and Methods
Co-cultivation experimentDeletion strains DargB and DleuB from the Keio collection () were grown overnight to saturation in 7 ml rich (LB) medium in Greiner tubes. Similarly to (), cells were washed twice and inoculated in M9 medium (containing per liter: 7.52 g of Na 2 HPO 4 2H 2 O, 3 g of KH 2 PO 4 , 0.5 g of NaCl, 2.5 g of (O and 1 mg of thiamineHC) plus 5 g/l glucose or 2.5 g/l maltose, 40 lM xanthine, 500 lM inosine (M9  MIX). Individual strains were diluted 1:100 when grown in isolation, whereas a 1:200 dilution was used when the two strains were grown in combination, giving in both cases an initial optical density (OD) of 0.05. Growth was monitored once per day measuring OD with a spectrophotometer at 600 nm. The experiment was conducted in triplicates. Supernatant samples were collected by spinning down 1 ml of culture volume for 10 min at 400 g.
Profiling of metabolites in supernatantDirect flow injection in a Time of Flight Mass Spectrometry was performed on an Agilent 6550 (ESI-iFunnel Q-TOF, Agilent Technologies) following protocols in (). The Agilent 6550 QTOF was operated in high resolution negative mode with a scanning mode from 50 to 1000 m/z. We detected 14083 ions from 4 ul injection of 20 times diluted supernatant samples. Based on metabolites masses, we). Metabolites in Supplementary Tables S1 and S2 were selected by first estimating relative fold-changes of metabolites in the supernatant between individual cultivated DargB and DleuB in normal M9 and in the model predicted medium (M9  MIX). We retained only those metabolites with a fold change ! 2 and a P-value 0.001 from a t-test comparison. In parallel, to filter out those compounds that were likely not to be exchanged (e.g. secreted by one organism and consumed by the other), we also calculated relative fold changes of metabolite levels measured in isolated cultures with respect to the interpolated values for the same OD from cocultivated supernatant samples (dashed blue lines in). We used a similar cut-off of two on estimated fold-changes.
Standard FBA procedureBased on a stoichiometric matrix, thermodynamic (i.e. reaction reversibility) and capacity constraints, standard Flux Balance Analysis (FBA) defines a space of feasible steady-state solutions. The balanced flux distributions maximizing an objective function (i.e. v growth ) and with the minimum sum of absolute values are usually selected as follow:with the subsequent optimization:). 4-Methyl-2-oxopentanoate is the immediate precursor of leucine, while N-Acetyl-L-glutamate is the substrate of the blocked reaction in the DargB mutantwhere, v represents the vector of fluxes, S the stoichiometric M  R matrix (i.e. M metabolites, R reactions), Sv  0 are the mass balance constraints and U/L are the thermodynamic and capacity constraints.
Bilevel FBA procedure (synergistic growth)Here, we implemented an efficient algorithm to explore optimal media composition that minimizes the cost of sustaining synergistic growth between two organisms and simultaneously prevent any growth of the two isolated species. The problem can be formally stated as follow: given two different species (A and B) and their related metabolic networks (S A and S B ), seek for the composition of external nutrients which guarantees biomass production only when the two organisms can share metabolic resources and, at the same time, minimizes the cost of shared essential metabolites. Prior to analysis, the stoichiometric matrix for both organisms is transformed into the corresponding form with only irreversible reactions. To allow the two organisms to communicate through sharing of metabolites, in each stoichiometric model we replicate the existing uptake and secretion reactions (v EX,in ). For each exchangeable reaction, uptake rates of a shared metabolite in organism B has to be identical to the secretion rate in organism A. The method proposed is formulated as a Mixed Integer Bilevel Linear Programming (MILP). To make this problem more tractable and amenable for experimental applications the algorithm finds a maximum of five additive components to be added on top of a standard minimal medium composition (i.e. M9 medium) with no carbon and nitrogen sources. These parameters can be changed by the user. The resulting bilevel optimization is a max-max integer linear programming problem with an inner and outer problem: Outer objective min cost of exchanged metabolites Inner objective s:t: max v AC g  v BC g   v AI g  v BI g  including: n mass balance constraints for both species A and B when cocultivatedvg AC and vg BC are the biomass production reactions for organism A and B when co-cultivated, while vg AI , vg BI when individual growth is simulated; y is a binary variable determining whether a component in the in silico medium is present or not; N EX is the total number of exchange reactions (i.e. possible components to be consumed from the medium), S is the stoichiometric matrix, U j is a thermodynamic constraint on the jth reaction, R is the number of reactions, and M number of metabolites in the metabolic network. This problem can be reformulated as a single-level optimization problem using the strong duality theorem for linear optimization, see also. The bilevel optimization problem is the following (First optimization):k  0 k 2 fmutual uptakeg j 2 fmutual sec retiong v BI j  0; v BI k  0 k 2 fmutual uptakeg; j 2 fmutual sec retiong,. .. , lm [ R are the dual variables associated to the first balance constraints of the inner problem (steady-state constraints Eq. .. .); k1,. .. , kr [ R  are the dual variables associated to the upper bounds constraints in the inner problem; and d1,. .. , dt [ R are associated to the exchangeable reactions which are allowed to be non-zero by the media compositions defined in the outer problem by the binary variable y. Similar formalism was used in Facchetti et al.The inner problem adjusts the fluxes in order to achieve the maximum biomass production for the two organisms when cultivated in isolation (i.e. AI and BI) and when they are allowed to exchange metabolites (i.e. AC and BC). The outer problem selects the combination of media components which in a first objective minimizes the sum of dual variables for inter-species (d) exchanged metabolites, restricting to those solutions of the inner problem which guarantee no growth for the individual organisms (v g AI and v g BI ) (Supplementary). The dual variables d can be considered as the cost of exchanging metabolites in terms of growth rate reduction for organisms A and B, so called shadow prices (). A metabolite with a large negative shadow price has an important contribution in biomass generation. A MILP solution is guaranteed to be optimal. However, its formulation is NP-hard, and the worst case runtime scales exponentially in the number of reactions. In practice for the genome wide metabolic network of E.coli metabolism we have achieved globally optimal solutions relatively quickly. A second optimization minimizes the sum of absolute fluxes for exchanged metabolites between species A and B:To estimate the relative difference between the cost of production of shared metabolites in a glucose minimal medium and the model-predicted medium, we simulated optimal growth of individual strains, DargB and DleuB, in M9 minimal medium without carbon and nitrogen sources, supplemented with five random exchangeable metabolites (and Supplementary). Only those media that could not support the growth of the two isolated organisms were retained. In total, we simulated 3972 randomized media. For E.coli DargB and DleuB, we then supplemented the media with the corresponding essential metabolites: ornithine and leucine, respectively. Maximum biomass production was estimated and compared with optimal growth in the same media, but now forcing DargB to secrete 0.1 mmol/gDW/h of leucine and DleuB to secrete 0.1 mmol/gDW/h of ornithine. Differences between optimal growth solutions reflect the associated cost of sharing ornithine and leucine by the two organisms (i.e. shadow prices). The IBM CPLEX Optimizer solver and Cobra toolbox version 2.0.5 were used to solve the mixed integer and linear problems. in particular the cost of sharing leucine by DargB, if compared to a glucose minimal medium (). In order to test our hypothesis, we co-cultivated the two strains, DargB and DleuB, in M9 glucose minimal medium (i.e. M9  G) and M9 supplemented with maltose, inosine and xanthine (i.e. M9  MIX), according to model suggestions (see Section 2). We grew the two knockout strains in LB medium overnight, washed cells two times with M9 salts and inoculated the main culture media. Similarly to (), we followed growth by measuring OD at 600 nm approximately every 24 h for 86 h (). Overall, synergistic growth between the two E.coli strains was established in the predicted medium (i.e. M9  MIX) with a higher degree of cooperation than in a glucose minimal medium (), confirming model predictions (Supplementary). It is worth noting that the slightly higher OD reached by DargB and DleuB when grown individually in M9  MIX relative to glucose M9, is likely a consequence of amino acid carry-over from overnight cultivation in rich medium. While the residual amino acids amount is similar between glucose M9 and M9  MIX, the presence of nucleotide precursors, as predicted by the model, increases the biomass yield and results in a higher final OD.
Cross-feeding revealed by overflow metabolismWe next asked whether improved synergistic growth was a mere consequence of a richer medium, or if the predicted lower cost of sharing leucine and arginine precursors could be supported experimentally. For each E.coli strain grown in isolation, we therefore collected supernatant samples after 24 h, and for the co-cultivated strains we monitored dynamic metabolic changes in the supernatant for the entire growth experiment. We used a sensitive metabolomics platform to profile secreted metabolites (). In total, we could monitor the relative abundance of 526 metabolites annotated in a genome-scale metabolic model of E.coli (; Supplementary). When comparing relative abundance of metabolites in the supernatant of individually grown species, we identified 15 significantly differentially secreted metabolites in the DargB strain grown on M9  MIX (Supplementary). Despite the fact that our mass-spectrometry approach cannot distinguish isoleucine from leucine, the corresponding ion is among the most significantly excreted ones (). Moreover, we found several intermediates in the leucine biosynthesis pathway (e.g. valine:, 4-methyl-2-oxopentanoate:, 4-aminobutanoate:and S-3-methyl-2-oxopentanoate:), with leucine biosynthesis as the most significant overrepresented metabolic pathway among extracellular metabolites (adjusted P-value of 1.14E-6 from hypergeometric test). It is worth noting that when the two mutants are co-cultivated, we did not detect high level of isoleucine/leucine, suggesting that the higher production of this amino acid from DargB is indeed feeding the DleuB strain and sustain his growth (dashed blue line). In parallel, the DleuB mutant showed an enhanced overflow of 46 metabolites (Supplementary). Although, we could not detect arginine in the supernatant, ornithine, which is the predicted metabolite to be secreted from DleuB and sustain DargB growth, exhibited a slightly higher accumulation ($2-fold higher) (). It is worth noting that similarly to DargB, the most significant accumulating metabolite in DleuB is the substrate of the deleted enzyme (i.e. 3-carboxy-2-hydroxy-4-methylpentanoate for DleuB, and N-acetyl-L-glutamate for DargB) (and H), with no difference between M9  G and M9  MIX media.
ConclusionsIn this study, we developed a flux balance analysis framework adopting bilevel optimization to design complex media promoting cooperation within microbial ecosystems. We experimentally challenged model predictions by selecting a pair of E.coli single gene knockouts auxotrophic, respectively, for arginine and leucine: DargB and DleuB. These strains were previously reported to show a poor cooperation in a glucose minimal medium. Leucine in fact seems to be hardly shared by E.coli when grown in a glucose minimal medium. We experimentally monitored synergistic growth in the model-predicted medium for 86 h. In agreement with model predictions we found the new medium composition to favor mutualism between the strains. By using mass-spectrometry to monitor exchanged compounds, we verified increased sharing of leucine and ornithine in agreement with their reduced 'sharing cost'. Overall, by introducing a novel in silico approach, we are able to investigate how external environment in the form of nutrients viability can favor microbial cooperation and design complex media that can promote mutualism between species. The solutions identified by our constraint-based modeling approach do not take into account possible kinetic limitations, such as restrictions on the rates of substrates uptake. While qualitatively model predictions predict class of metabolites that can improve mutualistic growth, quantitative variations caused by substrates affinities can be experimentally tested to further improve media composition. Moreover, our modeling approach can be scaled to study higher order microbial communities and more complex media compositions. The ever increasing number and accuracy of genomescale metabolic models of different bacteria will soon enable to use similar modeling approaches to facilitate the study of more naturalistic type of microbial communities and to shed light on the interplay between environmental nutrient composition and microbial interactions.
FundingThis work was supported by an 'ETH Zurich Postdoctoral Fellowship' to M.Z. Conflict of Interest: none declared.
at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
M.Zampieri and U.Sauer at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
Results 3.1 Synergistic-growth in model-based predicted media Understanding the mechanisms at the basis of inter-species interactions and how metabolism of the entire microbial community works in concert is crucial to engineer microbial communities. Here, we developed a novel constraint-based modeling approach that is based on MILP and aims at predicting media composition forcing mutualism between microorganisms in two ways: (i) the nutrient composition does not support growth of any of the two individual organisms and (ii) synergistic growth is achieved minimizing the cost of the metabolic interactions (Fig. 1). The cost is estimated in terms of growth rate reduction upon secretion of shared metabolites, so called shadow prices (see Section 2) (Reznik et al., 2013). This approach differs from previous works (Freilich et al., 2011; Klitgord and Segr, 2010) by guarantying optimality of the solution and by taking into account the cost of sharing metabolic resources. By simultaneously simulating the synergistic growth of two species and their individual growth in a bilevel optimization framework, we devised an efficient method to select nutritional components forcing mutualistic type of relationships. To provide testable and meaningful predictions, we restricted our search to a maximum of five nutrient components to be added on top of an M9 minimal medium without any carbon (e.g. glucose) or nitrogen source (e.g. ammonia). By doing so we predicted a relatively simple medium composition, amenable for experimental validation, from which it is possible to intuitively understand the basis of the underlying reduced cost in sharing essential metabolites. We applied our algorithm and searched for optimal media compositions to promote cooperation between two E.coli single geneknockout strains: DargB and DleuB, auxotrophic, respectively, for arginine and leucine. Cooperation between auxotrophic E.coli strains for amino acids such as arginine and leucine, when grown in a glucose minimal medium, led to very poor synergistic growth, highlighting the low propensity in sharing these amino acids (Mee et al., 2014; Wintermute and Silver, 2010). Nevertheless, our analysis suggested that synergistic growth can be significantly improved by an opportune medium composition (Fig. 2A), namely supplementing nucleotide precursors to the medium. We found that addition of nucleotide precursors, such as xanthine and inosine, was key to reduce the cost of the interaction between the two organisms (Supplementary Fig. S2 and Table S3). The underlying reason for the reduced cost was the role of certain amino acids in nucleotide biosynthesis. Hence, when growth is limited by availability of an amino acid, providing the cells with direct precursors of nucleotides increases the amount of biomass that can be produced from an equal amount of amino acid (i.e. yield) (Supplementary Fig. S2). For example, addition of nucleotides precursors further reduces the need for aspartate, which not only is a precursor of branched chain amino acids, but is also involved in arginine, UMP and IMP biosynthesis. Intuitively, when cell growth is limited by amino acids, the yield can be improved by supplementing the media with any metabolites that allow cells to redistribute more amino acids resources into protein biosynthesis to sustain growth, rather than other secondary biosynthetic pathways (e.g. nucleotide metabolism). 3.2 Experimental model validation Our predictions suggested that addition of 1,4-alpha-D-glucan, inosine, maltose, xanthine and xanthosine would have a major impact on the cost of the interaction between the two organisms, reducing Modeling microbial cooperation
