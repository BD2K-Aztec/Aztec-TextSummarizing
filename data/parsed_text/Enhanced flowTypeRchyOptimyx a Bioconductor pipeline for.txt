We present a significantly improved version of the flowType and RchyOptimyx BioConductor-based pipeline that is both 14 times faster and can accommodate multiple levels of biomarker expression for up to 96 markers. With these improvements, the pipeline is positioned to be an integral part of data analysis for high-throughput experiments on high-dimensional single-cell assay platforms, including flow cytometry, mass cytometry and single-cell RT-qPCR. Availability: FlowType and RchyOptimyx are distributed under the Artistic 2.0 license through Bioconductor.
INTRODUCTIONFlow cytometry has undergone a 'chromatic explosion' over the past decade and can now measure 17 markers at once for each of hundreds of thousands of individual cells (). Since then, mass cytometry has enabled measurement of 3045 markers/cell (), whereas single-cell multiplexed RT-qPCR can measure 5096 messenger RNAs/cell (). The growth in high-throughput single-cell data continues to outpace development of corresponding bioinformatics techniques (). To answer this challenge, we previously developed flowType () and RchyOptimyx (). FlowType uses partitioning of cells, either manually or by clustering, into positive or negative for each marker to enumerate all cell types in a sample, e.g.. RchyOptimyx measures the importance of these cell types by correlating their abundance to external outcomes, such as disease state or patient survival, and distills the identified phenotypes to their simplest possible form. These packages have been used to identify several novel cell populations correlated with HIV outcome (). More recently, this pipeline has been used to evaluate standardized immunological panels (), to optimize lymphoma diagnosis () and to analyze a range of other clinical data (unpublished data). However, the higher dimensionality of data produced by mass cytometry generates up to 3 45 % 10 21 possible cell types, with an even greater number (up to 3 96 % 10 45 ) for single-cell qPCR; these magnitudes are beyond the capabilities of flowType and RchyOptimyx. Furthermore, flowType and RchyOptimyx have thus far only treated cells as being either positive or negative for a marker. In practice, many biomarkers can have a range of expression levels such as 'dim' and 'bright'. In this application note, we detail architectural improvements to flowType and RchyOptimyx to overcome these limitations.
APPROACHOur primary challenge was to enable flowType to generate a number of cell types tractable on most common workstations (e.g. those with 412 GB of RAM). We hereafter denote the original flowType implementation as flowType-BF (brute force) and the new version as flowType-DP (dynamic programming). Whereas flowType-BF completely enumerates all cell types over all 1, :::, m markers, we opted in flowType-DP to use a breadthfirst strategy of enumerating all cell types defined over a subset of k m markers. We provide a memory use estimation function to assist users in finding a k that fits within the limits of their hardware. To improve computation time in flowType-DP, we implemented a dynamic programming approach, which exploits the fact that cell types can be arranged into a hierarchy, and membership of any given cell type over n markers is equal to the intersection of one of its parent types (over n1 markers) with a singlemarker cell type. FlowType-DP first enumerates all cell types involving only one marker by simple partitioning and then iterates over 2, :::, k markers, computing all cell types for each level n by set intersections between corresponding cell types in levels n1 and 1.To allow partitioning into levels other than positive and negative, we used a string representation for cell types. The string has *To whom correspondence should be addressed.
yThe authors wish it to be known that, in their opinion, the first three authors should be regarded as joint First Authors. one integer character for every marker, denoting the partition, or zero if the marker is not used. Values 1, :::, n denote partitions 1 to n. For example, if the set of markers were fCD3, CD45, CD13, CD117, CD34g, the cell type CD45  CD117  CD34  would be represented by 03021. RchyOptimyx uses a dynamic programing algorithm for efficiently constructing k-shortest paths (). We modified RchyOptimyx' graph construction component to be able to handle more than one partition per marker.
RESULTS AND DISCUSSIONWe evaluated flowType-DP against flowType-BF on a 10marker dataset available from Flow Repository (ID FR-FCMZZZK) (). FlowType-DP showed a substantial speedup over flowType-BF, which increases exponentially with the number of cells and markers. For example, at 10 6 cells and 10 markers, flowType-DP is 14 times faster (see). Comparison on larger datasets was not possible due to the limitations of flowType-BF. We also computed the limits for k on a hypothetical machine with 12 GB of RAM for samples representative of mass cytometry () and polychromatic flow cytometry (), both of which would be intractable for flowType-BF. FlowType and RchyOptimyx are now able, within the memory of a common workstation (12 GB), to analyze 34-marker data. Finally, to demonstrate the importance of several partitions per marker, we applied flowType and RchyOptimyx to an acute myeloid leukemia (AML) sample from Flow Repository (ID FRFCM-ZZYA) (). CD34 is a stem cell marker typically expressed on AML blast cells. These blasts are also known to have dimly positive CD45 expression and low side scatter (SSC) (). By partitioning CD45 and SSC into four and three partitions and naively running flowType and RchyOptimyx to search for CD34-enriched cell types, we were able to find that the SSC low CD45 dim cell type had a high proportion of CD34  cells, as expected. This would not have been possible with only two partitions for each of CD45 and SSC. Funding: ISAC scholar program, CIHR/MSFHR scholarship for strategic training in bioinformatics, UBC 4YF scholarship, NIH/ NIBIB (EB008400), Canadian Cancer Society (700374), the Terry Fox Research Institute and the Terry Fox Foundation. Conflict of Interest: none declared.
The Author 2014. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
K.O'Neill et al. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
