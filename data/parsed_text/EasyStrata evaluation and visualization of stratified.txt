The R package EasyStrata facilitates the evaluation and visualization of stratified genome-wide association meta-analyses (GWAMAs) results. It provides (i) statistical methods to test and account for between-strata difference as a means to tackle geneâ€“strata interaction effects and (ii) extended graphical features tailored for stratified GWAMA results. The software provides further features also suitable for general GWAMAs including functions to annotate, exclude or highlight specific loci in plots or to extract independent subsets of loci from genome-wide datasets. It is freely available and includes a user-friendly scripting interface that simplifies data handling and allows for combining statistical and graphical functions in a flexible fashion. Availability: EasyStrata is available for free (under the GNU General Public License v3) from our Web site www.genepi-regensburg.de/ easystrata and from the CRAN R package repository cran.r-project. org/web/packages/EasyStrata/.
INTRODUCTIONGenome-wide association meta-analyses (GWAMAs), in which multiple study-specific genome-wide association (GWA) results are pooled, have resulted in a 10-to 20-fold increase in the number of known genes contributing to complex traits and diseases (). Meanwhile, a focus is also on geneenvironment-wide interaction analyses (GEWIS) that are conducted to further characterize genetic main effects as well as to discover novel genetic associations that are only present under certain environmental conditions (geneenvironment interaction, GxE). Although some GEWIS have already extended from single-study analyses to meta-analyses, so far, only few reported replicable GxE effects (). For categorical environmental factors E, GEWIS meta-analyses can be implemented as GWAMAs stratified by E, for example, a GWAMA stratified by sex or by smoking status. Stratified GWAMAs do not only improve power to detect stratum-sensitive genetic main effects () but also allow for testing genestrata (GxS) interaction and joint (main + interaction) effects (). Although a variety of methods for the analysis of stratified GWAMA results exist, the availability of software tools is limited (see Supplementaryfor a comparison with other GWAS tools). We have developed an R-package called EasyStrata, which allows the user to obtain statistical and graphical summaries for comparisons across strata and to investigate potential GxS effects. The software was developed within the GxE working groups of the GIANT (Genetic Investigation of ANthropometric Traits) consortium, and the functionality of the package is exemplified on GWAMA results for anthropometric traits, which are publically available at www.broadinstitute.org/collaboration/giant. EasyStrata is applicable to stratified GWAMAs of continuous or dichotomous outcomes, and many of the functions are also applicable for 'non-stratified' GWAMAs (Supplementary Note).
IMPLEMENTATION
Features and functionalityThe basis for the EasyStrata analyses are GWAMA results for each single-nucleotide polymorphism (SNP) genome-wide and by stratum (m strata) (Supplementary): the stratumspecific meta-analyzed beta estimates and standard errors [inverse-variance weighted meta-analysis (or Z-scores and sample sizes [sample sizeweighted Z-scorebased meta-analysis ()] as well as other information (e.g. stratum-specific association P-values). Examples for strata are men and women (m = 2), or older age group and younger (m = 2), a combination of these (m = 4), smoking status (non-smoker, previous smokers, current smokers, m = 3) or other categorical exposures. *To whom correspondence should be addressed.  The Author 2014. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com
Statistical functionality To evaluate stratifiedGWAMA results, we have implemented statistical approaches to estimate (i) the overall (i.e. strata-combined) effect by meta-analysis of the m strata results (); (ii) the joint effect calculated from m strata results (); (iii) the difference between two strata results as a means to test for GxS effects (); and (iv) the heterogeneity between m strata () (see Supplementaryfor a summary of implemented statistics). All tests are applicable for stratum-specific beta estimates and standard errors as well as for stratum-specific Z-scores and sample sizes. We also provide functions to correct the computed P-values for multiple testing by false discovery rate () or Bonferroni correction () and functions to clump results into independentin terms of physical distance or linkage disequilibrium (LD)subsets of significant SNPs.
Graphing functionality To visualize stratifiedGWAMA results, we have implemented state-of-the-art graphical functions, such as QuantileQuantile plot (QQ), scatterplot and Manhattan plot. More specifically, we provide graphical features that are tailored for between-strata comparison: EasyStrata allows for contrasting two Manhattan plots in so-called 'Miami' plots (), for displaying multiple QQ curves in a single graph (Supplementary), and for extending scatterplots by further dimensions (Supplementary). The graphical functionality is complemented by other convenient features, such as highlighting specific regions in Manhattan or Miami plots (), excluding specific regions from QQ plots to focus on the potential of novel associations, omitting less significant SNPs to substantially improve plotting speed for large datasets, breaking up the scale of the y-axis to ensure proper presentation of extremely significant SNPs, or creating panels of plots to provide a quick overview on the singular studies of the GWAMA or on various traits (Supplementary Figs S4S7).
UsageOur open-source software is written in R and makes use of the 'Cairo' and the 'plotrix' packages. Extracting independent loci using LD-based thresholds requires the software PLINK (). For stratified GWAMA results based on HapMap-imputed studies, we recommend to have at least 4 GB of random access memory (RAM) available (see Supplementaryfor an evaluation of runtime and RAM allocation). EasyStrata is started by calling the function 'EasyStrata' with an ecf-file as parameter: EasyStrata('/path2ecf/ example.ecf'). The user-defined ecf-file is a text-file that provides a flexible scripting interface that allows for generating customized analysis pipelines (Supplementary). A number of template ecf-pipelines (e.g. those that were used to create the here presented figures) can be downloaded from our Web site.
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
CONCLUSIONS With EasyStrata, we provide a user-friendly R package that facilitates evaluation or graphical presentation of stratified GWAMA results. We have developed this software as analysts the GIANT consortium that meta-analyzed more than a hundred studies to investigate the genetic underpinning of anthropometric traits and to identify potential GxE effects. For example, the functionality of our software has been used to evaluate sexstratified GWAMAs for multiple anthropometric traits (Randall et al., 2013). The automated pipeline approach of EasyStrata can save time and minimize errors from manually extracting and merging the data. This software is highly useful for analysts to cope with the increased complexity of high-dimensional stratified GWAMAs data.
T.W.Winkler et al. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
EasyStrata at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
