We describe an R package designed for processing aligned reads from chromatin-oriented high-throughput sequencing experiments. Pasha (preprocessing of aligned sequences from HTS analyses) allows easy manipulation of aligned reads from short-read sequencing technologies (ChIP-seq, FAIRE-seq, MNase-Seq,. . .) and offers innovative approaches such as ChIP-seq reads elongation, nucleosome midpoint piling strategy for positioning analyses, or the ability to subset paired-end reads by groups of insert size that can contain biologically relevant information. Availability and implementation: Pasha is a multi-platform R package, available on CRAN repositories under GPL-3 license (https://cran.r-project.org/web/packages/Pasha/).
IntroductionTranscription regulation analyses benefited from the transition to High Throughput Sequencing (HTS) technology, which offers an unprecedented coverage by sequencing a large number of small sequences in parallel. However, while library preparation protocols recommend the selection of sheared DNA fragments ranging from less than 100 bp to more than 500 bp, the read size generated by the sequencing process is often shorter (25100 bp). As a consequence, typical single-end sequencing reads will display a gap between enrichments on both strands after alignment to the reference genome. In most analyses scenarios, peak detection algorithms are making use of the lag between the strands to infer the theoretical center of enrichment (). However, while the localization of binding events is a crucial step for analyzing stable binding factors in ChIP-seq experiments, an additional layer of qualitative and quantitative analyses are often required for an exhaustive description of transient or dynamic chromatin association (e.g. RNA Polymerase). To characterize such profiles, it is critical torestore the missing coverage information from read sequences in order to preserve the qualitative and quantitative aspect of the data. Here, we describe a piling tool that addresses this question by transforming aligned reads to piled enrichment scores. The modular structure of this pipeline makes it adaptable to most experimental scenarios for chromatin-oriented analyses, as well as short RNA sequencing. Pasha pipeline is for instance able to process seamlessly paired-ends or single-ends dataset by loading appropriate module, and allows the user to focus on biologically relevant parameters. Importantly, a versatile set of options decorates the core pipeline and enables innovative approaches for downstream analyses, such as an alternative midpoint piling strategy often used for nucleosome positioning analyses, or the ability to subset paired-end reads by groups of insert size for a finer analysis of fragments population. Finally, in order to maximize the compatibility with public tools and facilitate the integration to existing pipelines, a broad range of input and output file formats were implemented (Supplementary).
Description
Elongating from the edgesWe developed an original method to estimate the original DNA fragments size from the observed lag between both strands. Because it relies on a simple multiplicative operation on piled scores, most represented fragment sizes are given more importance during elongation estimation, which confers a significant advantage for samples displaying a vast heterogeneity in fragments size as compared to concurrent techniques often based on cross-correlation. By applying this method, and adjusting the coordinates of the region covered by reads, we were able to restore the crucial information required for an accurate representation of reads coverage (Supplementary).
Paired-ends and orphan readsAlternative paired-end sequencing technique waives the requirement for elongation estimation by performing the simultaneous sequencing of both ends of each DNA fragment. Their subsequent alignment to the reference genome provides direct information about the initial fragment length. In some casesbecause of insufficient sequence quality, insertions/deletions events, or repeated regions on the genomeone read from a pair fails to align to the reference genome. These broken pairs can represent a considerable amount of information that is lost when the orphan reads are discarded. In an attempt to provide a thorough handling of paired-end experiments to our pipeline, we developed additional options to rehabilitate orphan reads by elongating them to the median fragment size represented by the remainder of the sample.
Midpoint pilingA common theme in nucleosomal studies (MNase-seq) is to represent data as midpoint to emphasize positioning. Whereas densities (generated by tag elongation) will allow better characterization of nucleosome apparent depletion, midpoints will give a better view of the precise positioning of nucleosome more specifically at promoters (). This type of analysis reduces reads coverage to a single base footprint, centered on the theoretical region covered by the initial DNA fragment. While this compromises the quantitative and qualitative aspect of the observations, it allows a more resolutive outlook for factors with a high density of binding events, and is particularly suited for analyzing binding patterns in large scale analyses (e.g. average profiles). This method is available as an alternative piling method in our package and provides additional options (summarized in Supplementary) such as the possibility to highlight borders of binding events rather than their centered position, as seen in ().
MultiReadsSome genomic regions (eventually large, e.g. telomeric and centromeric) are composed of repeated sequences that can interfere with the assignment of unambiguous coordinates during alignment. These reads are often discarded although they can sum a precious amount of information. Our pipeline integrates specific strategies designed to rehabilitate signal in these regions: one affects a weight divided by the number of candidate positions for each read, while the other iterative algorithm preferentially affect reads to positions showing surrounding enrichments (). In both cases, the complexity threshold is determined by adjusting the maximal number of candidate regions reported during the alignment step. Although their use prevents a strict quantitative comparison between genomic regions, these methods have proven to highlight some signal on relevant repeated genomic features (i.e. miRNAs, snRNAs; Supplementary) and centromeric and telomeric regions.
Size segregationBecause chromatin fragmentation process is likely to be affected by biological factors (e.g. MNase treatment is less efficient where nucleosomes are bound to DNA), it is expected that subpopulations of reads in the fragmented population can reflect relevant biological features. This approach has been used in several studies coupled with MNase-Seq approach to probe for subnucleosomal structures linked to chromatin (). Our pipeline allows for isolation of fragments size subpopulations in paired-end samples and automatically generates reports for specified ranges, possibly revealing relevant biological information in ChIP-seq experiments (Supplementary). Other specific protocols targeting small populations of RNAs () can also benefit from this option as RNA populations can be are characterized by their size (ie. MicroRNAs, tRNAS).
at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
Conclusion The described pipeline is a versatile tool that summarizes chromatinoriented HTS data to enrichment scores using various strategies. It integrates several options allowing a seamless adaptation to various experimental setups. Additionally, the R package provides several tools for programmers that need to develop or integrate additional features.
R.Fenouil et al. at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
