Consensus genetic maps constructed from multiple populations are an important resource for both basic and applied research, including genome-wide association analysis, genome sequence assembly and studies of evolution. The LPmerge software uses linear programming to efficiently minimize the mean absolute error between the consensus map and the linkage maps from each population. This minimization is performed subject to linear inequality constraints that ensure the ordering of the markers in the linkage maps is preserved. When marker order is inconsistent between linkage maps, a minimum set of ordinal constraints is deleted to resolve the conflicts. Availability and implementation: LPmerge is on CRAN at http://cran. r-project.org/web/packages/LPmerge.
INTRODUCTIONBroadly speaking, two types of strategies have been used to construct genetic maps across multiple populations. One is to minimize an objective function based on the observed recombination frequencies between markers, analogous to the strategy used for linkage mapping in a single population. Examples of this approach include the software packages JoinMap () and MultiPoint (). The second strategy is to work directly with the component linkage maps instead of the underlying recombination frequencies, which can lead to significant gains in computational efficiency without compromising map accuracy (). This second strategy is used by the software package MergeMap (), which has been used in several different species ().identified a weakness in MergeMap and proposed an alternative algorithm for merging linkage maps based on linear programming (LP), which was incorporated into an R package called DAGGER. The accuracy of the LP algorithm was validated on simulated data, and in comparison with MergeMap using real barley data was found to have lower mean-squared error on a genome-wide basis (). A significant limitation of DAGGER was that it required the component linkage maps to have a consistent marker order. In practice, the linkage maps from different populations often have ordering conflicts, even when there is a single physical order, because of genotyping errors and statistical errors arising from the use of small populations. Another weakness of DAGGER was that the length of the consensus genetic map was shrunken compared with the original linkage maps. Both of these limitations have been overcome to create a new R package called LPmerge, which is available on CRAN. The LP algorithm has been reformulated without graph theory to eliminate shrinkage of the consensus map, and a new algorithm for resolving ordinal conflicts between linkage maps has been added. The objectives of this Applications Note are to describe these modifications and to illustrate the performance of the conflict resolution algorithm.
ALGORITHM
Consensus map errorIn the first step of LPmerge, markers are assigned to bins. If in every map where two markers were jointly mapped they cosegregated (had the same map position), they are placed in the same bin. Because of some markers co-segregating in one map but not in another, a single linkage map bin may be represented by multiple consensus map bins. Map positions in the ith linkage map are denoted by y i , and consensus map positions are denoted by x. Within linkage map i, the markers are ordered from j  1 to M i , and the map distance between the jth and (j  q)th markers is y i (j  q)y i (j). Letting u(j;i) denote the consensus map bin containing marker j from map i, the corresponding distance in the consensus map for these two markers is x(u(j  q;i))x(u(j;i)). The absolute error between the consensus map and the ith linkage map for this interval is thus E i, j, q  x u j  q; i     x u j; iThe total error between the consensus map and the linkage maps is a sum over maps (i), markers (j) and interval sizes (q):where T is the number of linkage maps and K is the maximum interval size. At the end of a linkage map, when the sum jq exceeds M i , this expression is evaluated as if the linkage maps were circular rather than linear. For example, when jis the number of error terms for map i, and W i is a set of possible weights for the average (W i  1 for unweighted). The maximum interval size K can be varied to produce different consensus maps, and additional criteria can be used to select one. A tutorial illustrating this process is available at http://potatobreeding.cals. wisc.edu/software.
Resolving marker order conflictsWhen minimizing the error [Equation(2)], it is desirable that the consensus map be as consistent as possible with the linkage maps in terms of marker order. This is achieved through the use of linear inequalities. For a pair of adjacent linkage map bins (v,w), each with a single consensus map bin, the corresponding constraint is x(w)  x(v) ! 0. When the linkage map bins contain multiple consensus map bins, constraints are added for every combination of the consensus map bins. The total set of ordinal constraints can be written in matrix notation as Ax ! 0. If there are conflicts in marker order between the maps being merged, the linear system Ax ! 1 will be infeasible. Finding the minimum number of constraints to remove to achieve feasibility is NP-hard ().where b represents the elastic variables, and the objective is to minimize their sum. The algorithm proceeds by finding which constraint (row of A) leads to the lowest elastic sum when removed. This constraint is then removed, and the procedure is repeated. When the algorithm eliminates a constraint and finds the elastic sum is zero, then that subsystem is feasible and the algorithm stops.
LP problemAfter removing the ordinal conflicts in A, linear programming is used to find a consensus map with minimum error (see Supplementary Material online).Eliminated following constraints Map II: C 5 B Map III: G 5 F Map IV: B 5 A Unlike other map-merging algorithms, LPmerge removes inequality constraints rather than markers to resolve conflicts. The consensus map returned by LPmerge for this toy problem has the correct marker order and distances ().. Toy problem illustrating the ability of LPmerge to resolve marker order conflicts (shown in red). Map I represents the correct order, which is recovered by LPmerge
RESULTS
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
J.B.Endelman and C.Plomion at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
