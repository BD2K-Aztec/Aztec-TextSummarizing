Motivation: Classification and feature selection of genomics or transcriptomics data is often hampered by the large number of features as compared with the small number of samples available. Moreover, features represented by probes that either have similar molecular functions (gene expression analysis) or genomic locations (DNA copy number analysis) are highly correlated. Classical model selection methods such as penalized logistic regression or random forest become unstable in the presence of high feature correlations. Sophisticated penalties such as group Lasso or fused Lasso can force the models to assign similar weights to correlated features and thus improve model stability and interpretability. In this article, we show that the measures of feature relevance corresponding to the above-mentioned methods are biased such that the weights of the features belonging to groups of correlated features decrease as the sizes of the groups increase, which leads to incorrect model interpretation and misleading feature ranking. Results: With simulation experiments, we demonstrate that Lasso logistic regression, fused support vector machine, group Lasso and random forest models suffer from correlation bias. Using simulations, we show that two related methods for group selection based on feature clustering can be used for correcting the correlation bias. These techniques also improve the stability and the accuracy of the baseline models. We apply all methods investigated to a breast cancer and a bladder cancer arrayCGH dataset and in order to identify copy number aberrations predictive of tumor phenotype. Availability: R code can be found at:
INTRODUCTIONThe accelerated development of microarrays and, more recently, of high-throughput sequencing techniques affords genome-wide measurements of molecular changes in the cell that have an impact on cancer onset and progression. High-resolution experiments targeting gene expression, DNA copy number or DNA methylation in tumors can be the basis for discovering patterns predictive of diagnosis, prognosis and therapy selection (; * To whom correspondence should be addressed.). Machine-learning techniques for classification and feature selection are often used for automated identification of variables associated with particular tumor phenotypes. In this article, we are concerned with two widely discussed aspects of microarray classification: handling high dimensionality and ill conditioning. The high dimensionality of microarray-based experiments contrasting to the small number of samples easily leads to overfitting. Regularized linear models such as logistic regression with ridge () or Lasso penalty () are popular solutions to fitting sparse models in which only a small subset of features plays a role. More sophisticated penalties for sparse model selection are discussed by. The problem of ill conditioning refers to the existence of groups of highly correlated features. The high correlations often have a biological basis, for example if the correlated features relate to the same molecular pathway (coregulated genes in expression data), are in close proximity in the genome sequence (neighboring genes in copy number data) or share similar methylation profile (consecutive CpG dinucleotides in CpG islands). Methods using simple penalties like Lasso typically discard most of the correlated features: only one or a few arbitrary representatives from every group of correlated features enter the model, provided they are relevant for the outcome. As a consequence, the models become unstable: small changes in the training set result in dramatic changes in the selected subset of features. If the purpose of feature selection includes biological interpretation of the model, then stability must be ensured. A successful approach used in many recent articles is that of selection of groups of features. For example, the group Lasso model () consists of Lasso selection of predefined groups of features. The fused support vector machine () combines a Lasso and a fused penalty for enforcing similar weights on correlated features, this way performing group discovery and group selection simultaneously. Another approach to group selection adopted in a large class of methods uses clustering procedures to discover feature groups, compute super features to summarize every cluster and apply feature selection on the set of super features. For example, in, the features are grouped with a hierarchical clustering procedure and the cluster centroids are used for training linear models. The Metagene method () consists of k-means clustering of the features, followed by computing the principal components of the clusters, called metagenes, which are used for model training.use fuzzy clustering to determine groups of features and then select a limited number of representatives from each cluster for training SVM models.search for dense groups of
Classification with correlated features: unreliability of feature ranking and solutionsfeatures by kernel density estimation. The pelora method () performs supervised grouping of features, by iteratively updating the groups such that the accuracy of a penalized logistic regression model is increased. A non-parametric model often used in microarray classification is the random forest (; Daz-Uriarte and Alvarez). In a recent study,observe that correlated variables are used interchangeably in the decision trees of the random forest models. The authors analyze the consequence of this phenomenon by simulating artificial datasets containing few correlated variables with different predictive values. They notice that the less relevant variables often replace the predictive ones (due to correlation) and thus receive undeserved, boosted importance.introduce a new variable importance measure that better reflects the predictive power of each feature within a correlated group. In contrast to the study by, we assume that the correlated features in a group share the same predictive value (due to a common underlying biological event) and we investigate how correlation affects the feature importance given by random forest. The main contribution of this article is to raise awareness of a specific effect involving feature correlation in several of the methods mentioned above, that can misguide model interpretation. We observed that the Lasso penalized logistic regression, the group Lasso, the fused SVM and the random forest report feature weights which are affected by a type of bias which we call correlation bias. Specifically, the features which belong to larger groups of correlated features receive smaller weights, proportional to the group size, due to a shared responsibility in the model. Therefore, if the group is large enough, all features may appear irrelevant, even if they yield high correlations with the outcome. This effect is expected in the case of the sparse Lasso logistic regression, but is surprising in the case of group Lasso and fused SVM, which are specifically designed to afford selection at group level and improved model interpretation. Moreover, such bias has not been reported on random forest models previously. We show using simulations that correlation bias exists and affects several widely used classification models for microarray data. We also show that group selection based on feature clustering such as provided by the method presented incan be successfully used for removing the correlation bias. We test and compare the methods investigated on two biological datasets.
METHODSWe consider only binary classification problems. Let (x i ,y i ),i = 1,...,N be N i.i.d. observations of a p-dimensional vector x i  R p and a response variable y i {0,1}. Denote by X = (x 1 ,...,x N )  R Np the input matrix and y {0,1} N the binary outcome. In general, we will use small letters to refer to samples x 1 ,...,x N and capital letters to refer to features X 1 ,...,X p of the input matrix X. In the manuscript, we will use the notion feature importance to refer to the measures of feature relevance commonly used for model interpretation, such as feature weights in linear models or variable importance in random forest.
Classification methodsLogistic regression is a popular method for classification of biological data. It models the logarithm of the posterior probabilities of the classes as linear functions of the input features. The parameters w  R p of the model are estimated by maximizing the log-likelihood L(w;X,y) over the observations in the training set. Model sparsity is obtained by adding a Lasso penalty  [see Equation(1)], which can be optimized with cross-validation. Feature importance is given by the model weights w LLR :In what follows, we will call this model Lasso logistic regression (LLR). In our experiments, we used the R package glmnet (Friedman and Hastie and) for training LLR models. Logistic group Lasso () uses the logistic regression model with a more specialized penalty, which takes into account some natural grouping of the features. Assume there are G groups of predictors and each group must be entirely included in the model by receiving non-zero weights or be discarded as irrelevant. The group penalty is a combination of a Lasso penalty acting at the group level and a ridge penalty on the predictors within each group. If I g is the index of the features belonging to group g, then the weights of the logistic group Lasso (GL) model are given by:We use the R package grplasso (by Lukas Meier) for training GL models and cross-validation for estimating the optimum penalty . The fused SVM () has been proposed for the special case that the features can be ordered such that neighboring features are expected to be correlated. This is the case in data on copy number aberrations, where the features are genomic sites ordered by position in the genome. Fused SVM (FSVM) is a linear support vector machine model with two supplementary penalties: a Lasso penalty for model sparsity and a fused penalty, which acts as a smoother of the weights, in such a way that weights of neighboring features are forced to be similar. The weights of the model w FSVM are obtained by minimizing a penalized hinge loss, as followsfor details]:The optimization problem given by System 3 can be solved by a linear program. We implemented this method using Matlab and the CVX optimization toolbox (). Cross-validation for both penalty parameters  and  is necessary, which makes fitting an FSVM model slower than fitting the other methods. Random forest (RF) models () are non-parametric and non-linear models, attractive due to their interpretability. They are based on averaging over a large collection of decision trees, each trained on a separate bootstrap sample of the input set. The aggregate model has lower variance and is less susceptible to overfitting than a single decision tree. Gini Importance (GI) and Variable Importance (VI) are two measures of feature relevance that can be computed based on the RF model. We use the R package randomForest () for training RF models. There are two parameters that influence the performance of RF: the number ntree of trees in the collection and the number mtry of variables considered for each tree split. In our experiments, we use the recommended value mtry =  number of features and we select the optimal value for ntree via cross-validation. Daz-Uriarte and Alvarez de Andrs (2006) evaluate the performance of RF models for various parameter settings in 10 real-world learning instances. Their results suggest that the default value of mtry affords either optimal or close to optimal performance.
Correlation biasIn the classification of high-dimensional data containing (large) groups of correlated features, the requirements of model sparsity and of retrieving of all predictive features are in direct competition. In applications in which assessment of feature importance is the main objective, models that give
L.TolosiTolo Tolosi and T.Lengauerpriority to the latter requirement should be preferred. In what follows, we formulate three key properties that we believe a classification model should meet in order to be a good instrument for assessment of feature importance. Assume that two independent biological events P 1 and P 2 (e.g. the deletion of a chromosome arm can be an event) influence the binary phenotype Y (e.g. tumor stage ) and let us denote the magnitude of their effects on Y with E(P 1 ) and E(P 2 ), respectively and assume that E(). Assume that, by means of an experimental technology, variables associated with each of the two events are measured (e.g. all genes located within a deleted chromosome arm). Let us denote with U 1 ,...,U q the variables associated with P 1 and with V 1 ,...,V p , the variables associated with P 2 , p,q  1. Consequently, {U i } 1iq and {V j } 1jp form two groups of correlated variables. Assume a classification model M is used to predict Y from a set of N observations on features U 1 ,...,U q ,V 1 ,...,V p and this model assigns importance values to features:Without losing generality, assume all the importance values are positive and a larger value indicates a more predictive feature. The following three properties should hold:(1) The importance values of the correlated features are similar:(2) The importance of the variables reflect the magnitude of the effect of the corresponding process on the outcome:(3) The importance of the variables {w 1 i } 1iq and {w 2 i } 1ip does not depend on the corresponding group sizes, namely q and p, respectively.We require that property (i) holds because, in absence of a true model, it is wise to give fair chances to all correlated variables for being considered as causative for the phenotype. In this case, supplementary evidence from other sources should be used for identifying the causative variable from a correlated group. Property (ii) is based on the assumption that E(P 1 ) > E(P 2 ) and hence any of the features {U i } iq contributes more to the outcome than any of the features {V j } jp. Thus, the property ensures a fair ranking of the variables, which is important in applications because often only a few top ranking groups are considered for further investigation. Property (iii) demands that the importance of the features does not change as more evidence (more variables) about the corresponding events is added to the data. In this article, we show that in classification problems with groups of correlated features, the assignment of feature importance by LLR, RF, GL and FSVM does not meet requirements (ii) and (iii). Specifically, the reported feature importance varies with the sizes of the correlated groups of features and results in biased feature ranking. In the context of the example above, the feature weights {w 1 i } 1iq and {w 2 i } 1ip depend on the values of q and p, respectively, in a way that larger group size leads to smaller importance values. As a consequence, if q is much larger than p, variables {U i } 1iq can falsely appear less predictive than variables {V j } 1jp and P 2 is considered more relevant than P 1. In sparse models like LLR, correlated features are generally discarded in favor of a single representative. Instability of feature importance is a known issue in such models (), and it is easy to observe that the larger the group, the smaller the chance of each particular variable within the group is to be selected by the model. Therefore, under repeated perturbations of the training set, the average weights of the features decrease as the size of the group increases. In the case of FSVM, the weights of correlated features are forced to be equal (or similar). Consequently, if the group of correlated features becomes larger, the common weights need to be decreased, in order to accommodate all features in the model and not violate the Lasso penalty. This rescaling of the weights is possible without decreasing the accuracy of the model, since correlated features provide only redundant information. In the Supplementary Material, we show how the interaction between the two penalties of FSVM can cause correlation bias. (see Example of correlation bias, Supplementary Material.) A similar effect can be observed in GL models. In RF, the correlation bias is caused by the bootstrap sampling of the observations and by the sampling of the features at each node of the trees, which causes correlated features to be used interchangeably in the tree components. In this article, we say that models that do not meet requirements (ii) and(iii) are affected by correlation bias.
Methods for reducing correlation bias based on FCIntuitively, a good strategy for reducing the correlation bias is to group the correlated features prior to model fitting and derive corresponding feature representatives as a summary of each group. The importance of the original features can be defined as the importance of the corresponding representatives. A very simple and intuitive approach is described by: average-linkage hierarchical clustering with Euclidean distance is performed on the features. Cluster centroids are used afterwards for training linear regression models. The features are standardized to mean zero and standard deviation one before clustering, such that the Euclidean distance is equivalent with the correlation distance between features. The optimal number of clusters is selected in a supervised manner, by visiting each level of the clustering dendrogram and estimating the model accuracy by means of cross-validation.make use of the monotonicity of the penalized loss and propose a path-following algorithm for efficient search for optimal parameters of the method. In this article, we apply the same approach for clustering features, in combination with LLR and RF models. Since RF are non-parametric models, an efficient path-following algorithm for simultaneous optimization of the number of feature clusters and number of trees in the RF is not available. Therefore, the cross-validation procedure is slower than the one presented in. For a dataset with a few thousands of features, it becomes inefficient to train a model for all levels of the clustering dendrogram. The running time of such a procedure is p k=1 C(k), where C(k) is the running time required by the classification algorithm to fit datasets with k features and and p is the total number of features. Using a univariate filtering for eliminating irrelevant features can help in applications, in which relatively small number of features are expected to be relevant. For example, the sure independence screening method () ensures that all predictive variables survive the filtering procedure. However, such filtering would not provide with substantial dimension reduction in applications like classification of copy number aberrations, because the number of predictive features can be very large (e.g. all probes covering several chromosomes). Therefore, in this study, we propose a cheaper, unsupervised alternative for estimating the number of clusters, based on silhouette values (). For simplicity, we will refer to the method byas supervised feature clustering (FC-Sup). By feature clustering (FC), we mean the alternative approach using silhouette values for estimating the number of clusters. We use both methods in combination with LLR and RF and compare them with the baseline methods and with the group-penalty methods GL and FSVM.
Model evaluationWe compare the performance of classification methods on training sets with (large) groups of correlated features. In particular, we analyze the measures of feature relevance provided by the models investigated and seek for evidence of correlation bias. Additionally, we report and discuss the prediction accuracy of the models (estimated via 10-fold cross-validation) and the stability of the respective feature importance measures. The stability of feature importance is defined as the variability of feature weights under perturbations of the training set. When the goal of classification is to select the most relevant features, small modifications in the training set should not lead to considerable changes in the set of important covariates. When the true distribution of the training set is not known, stability can be inferred via repeated sampling from the available training observations. In, classical 10-fold cross-validation is used in order to create 10 overlapping training sets and model stability is estimated by comparing the 10 resulting feature weightings. For this purpose,
Classification with correlated features: unreliability of feature ranking and solutionsthe authors propose several measures of similarity between two vectors of feature weights. For our purposes, the Pearson's correlation coefficient is most suitable. Overall model stability is given by the average of all pairwise Pearson correlations between feature weight vectors provided by the models fitted on the 10 variations of the training set. The stability score has a value between 1 and +1, with higher values for more stable models.
DATA
Simulated dataSimulation A: we generated datasets with N = 100 samples and p = 250 features. The features are divided into three groups: G 1 , G 2 and R. Group R has 50 features and the cardinality of group G 2 is 200|G 1 |, for different values of |G 1 |{100,120,140,160,180}. The features in each group are mutually correlated and any two features belonging to different groups are independent. The features in group G 1 are generated from the prototype vector U, which is sampled from a mixture of two Gaussians with equal probabilities: g 0 = N (0,0.2) and g 1 = N (1,0.3). The particular choice for a Gaussian mixture stems from gene copy number data, where g 0 corresponds to those samples with normal copy number and g 1 indicates aberrations (copy number gains, in this case). We generate features U 1 ,...,U |G 1 | with the following procedure: randomly select 20% of the components of U and alter them by adding Gaussian noise N (0,0.5), then repeat |G 1 | times. The features generated this way are correlated with U and with each other and resemble segmented copy number data, which are piecewise constant with occasional changes. Using the same algorithm, we generate a prototype vector V independent from U and corresponding features V 1 ,.
..,V |G2 | , which form group G 2 , and then repeat the procedure to simulate group R. Last, we generate a binary outcome y with the following linear classification rule: y = 1, if 5U +4V (5U +4V )+>0, 0, otherwise.where N (0,0.1) and 5U +4V denotes the average of 5U +4V. From the simulation parameters, it follows that features in group G 1 are most relevant to the outcome (being correlated to U), features in group G 2 are less predictive and features in group R are irrelevant.The groups G 1 to G 10 are ordered decreasingly by their relevance to the outcome. In Simulation B, the within-group correlations are smaller than in Simulation A and the number of features is larger, which makes the identification of the groups of features more difficult. In Supplementary, we show the average correlations between features and the average correlations between features and the outcome variable, for each group, summarized over 100 simulations.
Real dataBladder tumors: we tested our methods on a set of 98 CGH arrays measuring copy number aberrations in bladder tumors. The experimental). The authors of the study use statistical tests and report significant associations between certain genetic alterations and ER status (oestrogen receptor) and PR status (progesterone receptor) of the tumors. Using the methodology introduced here, we identify genetic lesions which help discriminate between ER positive and ER negative tumors, and PR positive and PR negative tumors, respectively. In the cohort, there are 60 ER negative and 101 ER positive tumors, and 65 PR negative and 96 PR positive tumors. For all models considered, we report classification accuracy and AUC (using 10-fold cross-validation) and feature importance.
RESULTS
Simulated dataSimulation A: we evaluated the performance of RF, LLR, FSVM and GL with respect to the criteria described in Section 2.4.summarizes the importance values assigned to features from the three groups G 1 , G 2 and R. The average feature weights over 100 simulations are shown for each chosen cardinality of group G 1 , with indication of standard deviation added. The correlation bias is clearly demonstrated by the decreasing importance of group G 1 as its cardinality increases and conversely, the increasing relevance of G 2 as its cardinality decreases. In the case of RF, when the number of features in group G 1 is larger than 140 (|G 1 |/|G 2 | > 2.3), the ranking of the groups given by GI and VI is incorrect in that features in G 2 falsely appear most relevant for the model (). On average, the same effect is observed in LLR models (depicted in). In the case of FSVM and GL, the correlation bias is noticeable even if G 1 = 120 (|G 1 |/|G2| = 1.5) (). In the context of the formal example from the Supplementary Material (see Example of correlation bias in Supplementary Material), note that our
L.TolosiTolo Tolosi and T.Lengauer(a)experimental results agree with the set of conditions (6) (a = 5, b = 4, q = 120, r = 80). We used FC and FC-Sup as preprocessing step before training RF and LLR models. The FC procedure almost always discovered the correct number of groups of features (three). FC-Sup more often than not overestimates the number of groups. Moreover, the RF models select a larger number of groups than the LLR.shows a summary of the selected number of feature groups by FC and FC-Sup. Importantly, both FC and FC-Sup succeed in removing the correlation bias, which is evident fromi. The prediction accuracy of all models is summarized in. All linear models outperform RF, which is expected because the simulations are based on a linear model. With FC, both baseline methods RF and LLR achieve higher accuracy. FC-Sup always outperforms FC, which is surprising, given that FC discovers the true number of feature groups and FC-Sup does not. Most probably, the classification is improved if each group is further split into several subgroups. This is possible because the feature groups are not spherical, but rather elongated, thus a single centroid is not the best representation of the group. As the cardinality ratio |G 1 |/|G 2 | increases, the accuracy of FSVM and GL decreases and thus the LLR with FC becomes significantly better than FSVM and GL.shows the stability estimates for the various models. The RF are most unstable, probably due to their increased complexity and thus tendency to overfitting. As expected, the LLR are the most unstable among the linear models. FC improves dramatically the stability of RF and LLR. FC-Sup is always more stable than the baseline methods. Interestingly, FC is more stable than FC-Sup. This is the case because the grouping of the features by FC is driven onlyby the features themselves, while in the case of FC-Sup, the outcome also plays a role. The results show that FSVM and GL are also very stable models. Simulation B:clearly demonstrates the correlation bias affecting RF (GI) (), RF (VI) (), LLR (), GL () and FSVM () models. Most dramatically, in the case of FSVM, as the cardinality of group G 1 increases
Classification with correlated features: unreliability of feature ranking and solutions(i)features, the features in G 1 appear almost irrelevant. When the size of G 1 exceeds 100 features, the GL model selects only group G 1 and disregards all other predictive groups. As in the case of Simulation A, FC and FC-Sup succeed to remove the correlation bias ( i). FC in general finds the true number of groups (30), but as the number of correlated features in G 1 increases, the number of groups is sometimes underestimated (). FC-Sup often selects a larger number of feature groups. The accuracy of the models is given in. The models show similar relative performance as seen in Simulation A: FC and FCSup always outperform the baseline models and FC-Sup slightly outperforms FC. LLR always outperforms RF, probably due to the underlying linear model. The FSVM and GL lose accuracy as the size of the group G 1 increases. Supplementaryshows the stability scores of all models. FC and FC-Sup improve the stability of the baseline models, with FC being more stable than FC-Sup.
Real dataBladder tumors: by applying FC to the bladder data, we obtained 11311 feature groups with grade labeling and 14031 groups with stage labeling. The varying number of groups corresponds to the 10 training sets of the cross-validation procedure. When applied with RF, FC-Sup method finds 107 groups (with grades labeling) and 20 groups (with stages labeling), respectively. When appliedwith LLR, FC-Sup partitions the set of features into smaller number of groups: 24 (with grade labeling) and 19 (with stage labeling). In both classification scenarios (with grades and stages labeling), the LLR with FC-Sup yields best accuracy. RF with FC and FC-Sup improve the baseline model in the case of tumor grade prediction but decrease it slightly when tumor stage is predicted. The stability scores of the prediction models () lead to the same conclusions as the experiments on the simulated data: the RF and LLR models are most unstable; however, using FC and FC-Sup results in significant improvements. FC-Sup is more unstable than FC. Supplementary Figures S4 and S5 show the feature importance reported by all methods investigated. For comparison purposes, to the set of prediction methods analyzed, we added a univariate measure of feature relevance, consisting of t-test p-values (logtransformed) (Supplementary). A t-test was applied to each feature independently, in order to evaluate the significance of the difference between the means of the two classes. We do not perform multiple testing correction because we use the logtransformed p-values as scores, and not as indicators of relevance. Concerning interpretability, FC and FC-Sup with LLR and RF or FSVM are the better models, reporting clear groups of features with identical weights. GL is also suitable for finding relevant groups; however, there is high variance among the weights within groups. In the absence of a true model, it is difficult to show how correlation bias affects classification models. However, in the case of classification with stage labeling, we speculate that correlation bias is observable in the feature importance given by FSVM. A large group of 175 correlated features on chromosome 7 is ranked fifth (w.r.t. absolute value of the weights) by FSVM (). However, a large subgroup of this group of features located toward the short arm of the chromosome is indicated as most relevant by RF with FC, LLR with FC, LLR with FC-Sup, as well as by univariate t-tests (e). It is possible that the lower rank of this group of features in the FSVM model can be caused by the correlation bias. The FSVM includes the entire group of correlated features, at the price of lower average weights. In order to verify this hypothesis, we constructed a new dataset, by assigning one feature representative to each group with identical weights in the FSVM model. The representatives are computed by averaging over the corresponding group. All features with null weights were excluded. This procedure essentially uses FSVM for discovering groups of correlated features and computes the centroid of each group selected by the FSVM model. The resulting reduced dataset has 11 features. We trained and evaluated
L.TolosiTolo Tolosi and T.Lengauer(a), since most probably there are no further groups to be discovered. We call the new model reduced FSVM. In, the weights of the features in the original FSVM model are represented (in absolute value and only the regions with nonzero weights).shows the weights of the reduced FSVM (in absolute values), extended for convenience so as to be aligned to the original weights. The representative feature corresponding to the group located on chromosome 7 receives highest absolute weight, which could indicate that the correlation bias has been removed. Breast tumors: FC method identifies 13037 groups of features with ER labeling and 12732 groups of features, with PR labeling. FC-Sup in combination with RF selects an optimal partitioning into195 groups (with ER labeling) and 163 groups (with PR labeling), respectively.summarizes the accuracy of the different algorithms on ER and PR classification. FC improves the accuracy of the RF in both cases and of LLR in the case of PR labeling, but decreases slightly the accuracy of the LLR model when ER status is predicted. In the case of ER classification, all RF and LLR models outperform FSVM and GL, however, by a small margin. In the case of the PR classification, FSVM performs best. The models investigated have similar stability scores as in the case of bladder tumors: RF and LLR are most unstable, FC with LLR and RF have increased stability, comparable to that of GL and FSVM models and FC-Sup is less stable than FC (Supplementary). The feature importance reported by the various methods investigated in general confirms the findings reported in the original study () (Supplementary Figs S6 and S7). An interesting aspect is shown in: FC and FC-Sup in combination with RF and LLR select a group of features in chromosome 13 as highly relevant for classification of PR status. In the original study (), none of these features were reported significant, based on univariate association with the outcome (corrected t-test p-value). Allelic loss at chromosome 13 is known to be associated with poor prognosis in breast cancer, due to the loss of the tumor suppressor gene BRCA2, located in this region. Associations with low progesterone content have been reported previously in the literature (), which we confirm in our study.
DISCUSSIONWe have shown that several widely used classification algorithms can generate misleading feature rankings when the training datasetscontain large groups of correlated features. This can confound model interpretation, since large groups of predictive features can be masked and falsely appear irrelevant. Such an effect is likely to occur because variables relating to a biological process or genomic location of high interest (w.r.t. a phenotype) are overrepresented in the probes set of microarray-based experiments. In this article, we have described the correlation bias and have shown that it affects random forest, Lasso logistic regression, group Lasso and fused SVM models. We used two artificial datasets based on linear models to show that the expected importance of the features in a correlated group decreases as the size of the group increases. We also illustrated the correlation bias caused by the combination of fused and Lasso penalties by means of a theoretical example, which considers the particular case of two groups of correlated features. We showed that correlation bias can be reduced using a group-selection algorithm which combines feature clustering with any classification method. We tested two methods for estimating the number of clusters, based on a unsupervised (FC) and supervised approach (FC-Sup), respectively. We showed using simulated data experiments that FC and FCSup successfully remove the correlation bias, improve the stability of feature importance and increase the accuracy of the baseline methods. FC-Sup outperforms FC in terms of accuracy, but FC is faster and has higher stability. The classification of the real data shows that FC dramatically increases the model interpretability and stability of feature importance. Moreover, in five out of eight classification tasks, FC improved the accuracy of the baseline models. FC-Sup improves the accuracy of the baseline models in six out of eight classification tasks. FC-Sup used in combination with Lasso logistic regression yields highest accuracy in three out of four cases. Using hierarchical clustering of the features and then computing cluster centroids using the average is certainly not the only solution for identifying and summarizing groups of correlated features. Depending on the distribution of the features in the sample space, methods using principal component as cluster centroid [as inor even several representatives] may yield better performance.
Classification with correlated features: unreliability of feature ranking and solutions
The Author 2011. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oup.com at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
