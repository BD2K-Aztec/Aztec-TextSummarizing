The Poisson Random Field (PRF) model has become an important tool in population genetics to study weakly deleterious genetic variation under complicated demographic scenarios. Currently, there are no freely available software applications that allow simulation of genetic variation data under this model. Here we present PReFerSim, an ANSI C program that performs forward simulations under the PRF model. PReFerSim models changes in population size, arbitrary amounts of inbreeding, dominance and distributions of selective effects. Users can track summaries of genetic variation over time and output trajectories of selected alleles.
IntroductionUnderstanding the behavior of selected mutations in finite populations is important in population, medical and conservation genetics. Two main computational approaches have been used to model weakly deleterious mutations. First, under the Poisson Random Field (PRF) framework (), a Poisson number of independent mutations enter the population each generation, with subsequent changes in allele frequency due to selection and drift. The PRF framework is a mainstay in population genetic inference of demography and selection (). However, existing implementations of the PRF model do not provide the ages or selection coefficients of individual mutations or permit the user to follow allele frequency trajectories over time. Moreover, including biological complications, like inbreeding at certain time points, or dominance effects, are difficult for the average user within existing software (). The second approach involves simulation of entire populations forward in time. Here, individuals reproduce each generation in proportion to their fitness. Several software programs exist to perform such simulations, including SFS_CODE (), SLiM () and fwdpp (). These programs are designed to simulate large regions of genetic variation with linkage and arbitrary recombination and they track chromosomal regions through time, rather than the behavior of individual mutations. Thus, unless the recombination rate is exceptionally large, they are not directly comparable to the PRF model which assumes free recombination. Further, these simulations may not be ideal for generating trajectories of selected alleles because the trajectories of V C The Author 2016. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com individual alleles may be altered through linkage to other selected sites (). Finally, some features, such as arbitrary amounts of inbreeding, are not included in SFS_CODE and SLiM. The recently released GO Fish () also models individual mutations, but currently does not model distributions of fitness effects nor does it have a complete stand-alone software package. Here, we present a new program, PReFerSim, which combines these approaches and performs forward simulations under the PRF model for a single population. Two features distinguish PReFerSim from existing implementations of the PRF model and forward simulation programs. First, PReFerSim can track allele frequencies over time, and the ages and trajectories of individual mutations. Second, PReFerSim can simulate large amounts of genetic variation data with free recombination quickly.
ImplementationPReFerSim will simulate genetic variation data under the Poisson Random Field model. Each generation a Poisson number (with mean h/2, where h is the population-scaled mutation rate) of mutations enter the population. Information about each mutation is stored in a linked list. Mutations change frequency every generation due to natural selection and genetic drift. Genetic drift is implemented through a binomial sampling step. The program in written in ANSI C and utilizes the GNU Scientific Library for random number generation. PReFerSim allows users to consider a variety of models of selection and demography. The program accepts demographic models with an arbitrary number of population size changes. Inbreeding can be modeled by specifying an inbreeding coefficient, F, which can be constant or change over time. Variable inbreeding is useful to simulate domestication events, or inbreeding following population decline, and is a unique feature of this software. Six distributions of fitness effects are included and the program allows selected mutations to have arbitrary dominance. PReFerSim will output summaries of genetic variation in the present day as well as at various times throughout the simulation. Trajectories of selected alleles can be generated and used in downstream coalescent simulations to model neutral genetic variation linked to the selected site (). Importantly, trajectories from PReFerSim can be conditioned to have any present-day frequency desired by the user. Such simulations can be used to estimate the ages of selected alleles and/or strength of selection (), to estimate the rate of selective sweeps (), or to distinguish between hard and soft selective sweeps ().
ResultsTo demonstrate the performance of PReFerSim, we generated the site frequency spectrum (SFS) under a population expansion demographic model with a gamma distribution of fitness effects (). The SFS produced by PReFerSim is comparable to that generated using dadi (). Additionally, ages of deleterious alleles obtained from PReFerSim are comparable to classical theoretical predictions made by Maruyama (1974; Supplementary). In sum, these results demonstrate that PReFerSim can generate predictions about the frequency spectrum and allele ages under complex models of demography and selection. Example applications of
ConclusionPReFerSim is a forward-in-time population genetic simulation program that can generate data under the PRF model considering complex demography and arbitrary models of selection and dominance. Given the growing interest in studying how demography affects deleterious variation across a wide range of taxa (), there is a need for population genetic software that can easily simulate large amounts of data under complex evolutionary models. As such, we anticipate that PReFerSim will play an important role in future studies.. Comparison of the SFS between PReFerSim (gray) and the diffusion approximation (black; dadi) for complex demographic models with purifying selection. Top: the SFS are similar in a sample of 2000 chromosomes. SNPs with counts greater than 22 are combined in the last bin. Bottom: SFS for a sample of 24 chromosomes. See Supplementary Text for a description of the model parameters
Bioinformatics, 2016, 13 doi: 10.1093/bioinformatics/btw478 Advance Access Publication Date: 19 July 2016 Applications Note Bioinformatics Advance Access published August 4, 2016 at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
D.Ortega-Del Vecchyo et al. at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
