Motivation: The arbor morphologies of brain microglia are important indicators of cell activation. This article fills the need for accurate, robust, adaptive and scalable methods for reconstructing 3-D microglial arbors and quantitatively mapping microglia activation states over extended brain tissue regions. Results: Thick rat brain sections (100–300 mm) were multiplex immunolabeled for IBA1 and Hoechst, and imaged by step-and-image confocal microscopy with automated 3-D image mosaic-ing, producing seamless images of extended brain regions (e.g. 5903 Â 9874 Â 229 voxels). An over-complete dictionary-based model was learned for the image-specific local structure of micro-glial processes. The microglial arbors were reconstructed seamlessly using an automated and scal-able algorithm that exploits microglia-specific constraints. This method detected 80.1 and 92.8% more centered arbor points, and 53.5 and 55.5% fewer spurious points than existing vesselness and LoG-based methods, respectively, and the traces were 13.1 and 15.5% more accurate based on the DIADEM metric. The arbor morphologies were quantified using Scorcioni's L-measure. Coifman's harmonic co-clustering revealed four morphologically distinct classes that concord with known microglia activation patterns. This enabled us to map spatial distributions of microglial activation and cell abundances. Availability and implementation: Experimental protocols, sample datasets, scalable open-source multi-threaded software implementation (Cþþ, MATLAB) in the electronic supplement, and website (www.farsight-toolkit.org).
IntroductionMicroglia are immune cells of the mammalian central nervous system whose importance to brain function is receiving growing recognition (). Normally, these cells are distributed throughout the brain in non-overlapping territories, and comprise up to 20% of the glial cell population (). Their arbor morphologies are dynamic, informative of their internal state of activation and are related to tissue perturbations. Resting microglia exhibit motile and highly branched arbors that constantly screen for perturbations in their local environment. There is considerable heterogeneity in microglial populations, even in normal brain tissue. When perturbed by pathological stimuli, they undergo rapid changes in arbor morphology and migrate toward the lesion site (). The arbor morphologies are indicators of cell activation, and are valuable regardless of any molecular markers of activation. For these reasons, there is a need for methods to analyze individual microglial arbors, profile arbor alterations and map spatial distributions over extended tissue regions. Capturing these phenomena given the small dimensions of microglial processes (<2 mm) requires high-resolution microscopy. Accurately capturing the asymmetrical arbors of non-resting microglia, requires three-dimensional (3-D) imaging of tissue samples that are thick enough to include entire cells. Capturing perturbations to spatial distributions of these cells requires high-extent imaging, especially when the lesions are much larger than the field of view of the microscope ().illustrates the use of step-and-image confocal microscopy and computational image mosaicing to record large 3-D images of brain tissue. Our goal is to describe automated methods for quantifying microglial arbor morphologies and spatial distributions of activation in such images. In considering arbor tracing methods, we note that there is a vast literature on tracing algorithms for neurons (). In contrast, the literature on microglial arbor analysis is much smaller (). Importantly, the prior efforts have tackled much smaller cell populations than reported here, cannot reconstruct microglia seamlessly and three-dimensionally across significant extents of brain tissue (multiple mmcm), and do not guarantee that the reconstructions have a tree topology. Finally, the prior literature does not address population-scale quantitative analysis of microglial arbors as a function of activation. The prior literature on automated neuron tracing provides a valuable basis for reconstructing microglia, but there are important limitations that are specific to microglia that remain unaddressed. Most of the methods are based on pre-defined analytical models of the tubularity ('vesselness') and continuity of neurites. For example,used the multi-scale curvelet transform to model neurites. Automated neurite tracing methods are generally based on modelbased sequential tracing (); probabilistic extraction of centerlines () or on segmentation (). The neurite centerlines are usually detected by variations of skeletonization (), or voxel coding (). For handling complex/dense neurite fields, various approaches have been proposed for negotiating branches and crossovers (). The tracing performance depends on the quality of seed points, effective modeling of the peculiarities of the images being processed, and tracing control criteria (stopping, branching, negotiating crossovers, etc.). Our method is designed to address the needs of large-scale microglia reconstruction by exploiting microglia-specific constraints (e.g. known topology), and using algorithms that are specifically designed for mosaiced high-extent imaging of brain tissue (). Specifically, we address the need to cope with biological and imaging variability within and across samples, without having to retune algorithm parameters. For this, we propose a machine learning approach for modeling the characteristics of microglia in actual images, rather than resorting to a pre-defined analytical model as in the prior work on neuron tracing. To overcome the difficulty of tuning parameters over large-extent images, we propose algorithms with very few parameters that are easy to interpret and adjust. Our method detects the microglial processes reliably using a machinelearning algorithm, and traces the arbors subject to a topological constraint. Appropriately designed cost terms guide our algorithm to exploit the fact that microglia, unlike neurons, are spatially localized (lacking long processes, e.g. axons). Whereas tight fiber crossovers are common for neurite fields, they are rare for microglia. Furthermore, microglia do not form inter-connections with neighboring cells. The more pressing challenge in our work to correctly reconstruct microglia that are split across the microscope fields to enable accurate spatial distribution analysis. Our method uses these same constraints to handle such cells. To achieve scalability, our method is designed to exploit parallel computers. This results in an array of arbor reconstructions, one per IBA1 microglial cell that can be visualized and proofread using 3-D visualization tools that are capable of handling thousands of cells at a time (). The overall pipeline is very usable and scalable. The few adjustable parameters of our method affect the results smoothly, permitting stable and objective analysis of microglia morphologies. The resulting reconstructions are directly amenable to quantitative analysis using Scorcioni's L-measure (). The quantitative arbor measurements are analyzed by Coifman's harmonic co-clustering to reveal morphologically distinct arbor classes that concord with the known microglia activation patterns. ApplicationThree-dimensional reconstruction and quantitative profiling of microglia populationsof these methods to brain tissue analysis will provide unprecedented measurements of microglia as a function of physiological and pathological stimuli.
MethodsQuantitative tissue-scale microglia profiling requires three-dimensional (3-D) imaging of large numbers of cells spread across significant lateral and axial extents of brain tissue (multi-millimeter lateral extent, and 100300 mm depth). For the experiments reported here, coronal sections of 4% paraformaldehyde fixed rat brain tissue from the motor cortex region were cut into 100 lm thick sections, and fluorescently labeled for microglia-specific protein IBA1 to highlight microglia, and DNA stain Hoechst to highlight all nuclei). A Rolera EM-C 2 camera (QImaging, Surrey, Canada; 1004  1002 pixels) mounted on an Olympus DSU spinning-disk confocal microscope with a 30 objective (N.A. 1.05, Silicone oil) was used for imaging individual 3-D image fields of interest (resolution of 0.267 lm/pixel, 14 bits/pixel (x, y), z-step size of 0.3 lm), and also to record a series of overlapping 3-D images for mapping tissue regions that are larger than the field of the microscope. For example, the dataset inis a mosaic constructed from 12 rows and 7 columns of overlapping image tiles, each covering a 267 lm square region. The tiles are collected with a 1520% overlap, spanning a 2.615 mm  1.550 mm  0.1 mm region of tissue. The image tiles were combined into a 3-D montage of the whole field using a previously published method, and displayed in(). In addition to these large montages, randomly selected fields from different animals were also analyzed.
Sparsity-based modeling of microglia processesGiven 3-D images Ix; y; z, our method learns the structure of microglial processes from actual images to construct a computational 'dictionary-based' model for microglial processes, and then utilizes this model to reconstruct the arbors. The term 'dictionary' refers to a set of basis vectors that can be combined linearly to represent the given image. These basis vectors are learned from image patches that are labeled as being foreground (microglia processes), or background. Several authors have shown that learning a dictionary from images rather than using a predetermined analytical model can lead to more effective image representations, and can therefore provide improved results in many practical image-processing applications such as restoration, segmentation and classification (). Our modeling approach is based on the sparse over-complete dictionary learning method described by () that was inspired by the K-singular value decomposition (K-SVD) algorithm (). Specifically, Zhang and Li (2010) described an extension of the K-SVD method, known as the label-consistent K-singular value decomposition method (LC-KSVD). In this method, small image patches that are labeled to indicate classes (e.g. foreground/background) are used as training examples. The typical patches in our work are quite small, typically, 15  15  3 voxels for the current image stacks. These labeled image patches are extracted from representative training images. The LC-KSVD algorithm has the important advantage of simultaneously and consistently learning a single discriminative dictionary (that is typically more compact compared to the K-SVD method), and a linear classifier. In our work, the dictionary typically consists of 675  2000 dimensional vectors (atoms). A mathematical description of our approach is presented next. Let X  fx 1 ;. .. ; x N g 2 R nN denote a set of image patches drawn from the 3-D image Ix; y; z, where n denotes the number of voxels in each patch, and N denotes the total number of image patches. We wish to learn an over-complete dictionary, denoted D  fd 1 ;. .. ;d K g 2 R nK K > n making the dictionary over-completecontaining K basis elements, usually referred to as 'atoms' for building a sparse representation of X. The patch data X is approximated by DC;where C  fc 1 ;. .. ; c N g 2 R KN is a matrix that is chosen to respect a sparsity constraint. Specifically, we are interested in representations that minimize the number of non-zero entries in c i for representing signal x i. In practice, the number of non-zero entries is a user-selected parameter that is known as the sparsity constraint, and denoted T. This requires solving the following optimization: < D; C > arg min D;C kX  DCk 2 F s:t: 8 i; kc i k 0 T;The term kX  DCk 2 F denotes the squared signal reconstruction error where 'F' is the Frobenius norm. The reconstruction error is minimized subject to the L 0 sparsity constraint kc i k 0 T. The K-SVD algorithm is an iterative approach for implementing this optimization in equation that operates in two steps. First, Equation (1) is minimized with respect to C to learn a dictionary D. Given D, the sparse coding algorithm computes the sparse representation C of signal X by solving:F s:t: 8 i; kc i k 0 T:An exact determination of sparse representations is proven to be a NP-hard problem (). Several algorithms have been proposed in the literature to solve the above sparse coding problem, usually by relaxing the L 0 penalty to use the convex L 1 penalty instead, as in the basis pursuit method (). The Focal Underdetermined System Solver (FOCUSS;) is very similar in using the L p norm, with P < 1 as a replacement for the L 0 norm. Another approach is to use greedy algorithms like Matching Pursuit (), or Orthogonal Matching Pursuit (OMP;), that select the dictionary atoms sequentially. In this work, we chose OMP to solve the sparse coding problem with computational efficiency in mind. The next step is to classify the voxels as seed points using these sparse features. The sparse codes from Equation (1) can be directly used for classification. An effective classifier f c can be obtained by determining the model parameters W 2 R mK , satisfyingwhere L is the classification loss function, h i are the labels (seed point / not a seed point) and k is a regularization term that is incorporated to prevent overfitting. Widely used loss functions include the logistic function, hinge function and the quadratic. We used the linear predictive classifier in our study so fc; W  Wc. However, separating the dictionary learning from the classifier learning will make D suboptimal for classification (). It is possible to jointly learn dictionary and classification models () by implementing the following optimization:where H  fh 1 ; h 2 ;. .. h N g 2 R mN denotes the class labels for N examples and m classes. These approaches require relatively large dictionaries to achieve good classification (), making it difficult to set the dictionary size (K). By introducing the label consistency term, a concise unified dictionary can be learned using the LC-KSVD algorithm. The resulting dictionary enables reliable classification using only a small, unified dictionary and a single multi-class linear classifier. The central idea behind this approach is to incorporate two additional terms to the objective function for learning the dictionary, specifically a label consistency term and a classification error term. The dictionary learned in this manner will adapt to the underlying structure of the training data, and generate discriminative sparse codes regardless of the size of the dictionary, as described by. Let Q  fq 1 ; q 2 ;. .. q N g 2 R KN denote such a discriminative set of sparse codes. Let A denote a linear transformation matrix that transforms the original sparse codes to the most discriminative sparse codes in the sparse feature space R K. Let H  fh 1 ; h 2 ;. .. h N g 2 R mN denote the class labels for the N examples for m classes. With this notation, the LC-KSVD algorithm can be expressed as the following expanded optimization problem:where the first term kX  DCk 2 F represents the squared reconstruction error. The second term kQ  ACk 2 F represents the discriminative sparse-coding error. It is intended to penalize sparse codes C that deviate from the discriminative sparse codes Q. Intuitively, it forces the signals from the same class to have similar representations. For example, if q i is the discriminative sparse code corresponding to the input signal x i , then the non-zero values of q i occur at those indices where the input signal x i and the dictionary element d k share the same label. The third term jjH  WCjj 2 2 represents the classification error, and H  fh 1 ; h 2 ;. .. h N g 2 R mXN is the matrix of class labels for N samples and m classes.. The dictionary learned in this manner has excellent representational power, and enforces strong discrimination between the two classes (e.g. seed points versus non-seed points), as detailed later. Importantly, the dictionary is selected to provide a sparse representation of the image. We are interested in constructing a dictionary such that a small number of its atoms can be linearly combined to represent the image. Following () the above optimization can be rewritten as follows:whereThe above optimization is conducted using the Orthogonal Matching Pursuit (OMP) algorithm. Given the nature of the L 0 norm, the non-zero values of q i in the solution occur at those indices where the input signal x i and the dictionary element d k share the same label. We then solve Equation (4) using the KSVD method. The matrix D 0 is L 2-normalized column-wise. We then compute the matrices D  fd 1 ; ::; d k g; A  fa 1 ; ::; a k g; and W  fw 1 ; ::; w k g from D 0 : However, we cannot simply use D; A; and W for classifying new image patches since they are jointly normalized in D 0 , i.e.The normalized dictionary ^ D, transform parameters ^ A, and classifier parameters ^ W are computed as follows:The inputs to the seed detection algorithm are the set of training image patches X, and a corresponding label matrix H. The algorithm requires two adjustable parameters a and b. The setting of these parameters is described in the Experimental Results section. They merely serve to adjust the relative importance of the respective penalty terms in Equation (3). The outputs of the algorithm consist of the dictionary D; classifier weights W; transformation matrix A; and the sparse features C. The sample dictionary shown in, shows two distinct classes despite the variability, corresponding to the arbor processes (IBA1 foreground), and the background. Once the dictionary is learned from the training images, it can be applied to seed detection in other (non-training) images that are collected using the same imaging protocols. Given the dictionary D, the sparse features C can be computed using Equation (2) by any sparse coding algorithm, including OMP. Once the sparse features C and the classifier W, are learned, the next step is to classify each pixel in the test image as a seed point or otherwise, based on the sparse image representation. For this, we first extract the image patch x i , surrounding the voxel in question from the test image I t x; y; z, and compute the sparse feature c i; with respect to the learned dictionary D: Then, we classify the pixel using a linear classifier W as follows,(where V is the seed point image whose voxel value is set to 1 or w 1 for pixels that are classified as a seed point, and to 0 otherwise. In
Three-dimensional reconstruction and quantitative profiling of microglia populationsSection 3, we present experimental data showing that the seed points detected by the above algorithm () are sufficiently reliable and accurate for reconstructing microglial arbors.
Automated microglia arbor reconstructionMicroglia consist of branching processes that form a tree, and the processes stem from a central soma that envelops the cell nucleus. Detecting the soma is the first step to reconstructing the microglia. For this, we proceed in two steps. First, we perform an automated segmentation of the Hoechst image channel (the nuclear label) to detect all cell nuclei (). From the segmentation results, we compute a set of features including the 3-D location, volume, shape factor and chromatin-intensity variance (a texture measure) for each nucleus. Next, we compute the total amount of the microglial marker IBA1 within a distance of eight voxels to each nucleus (). We then isolate the microglial cell nuclei based on these features, using an active learning-based classifier (). Microglial cell somas that extend beyond the nuclei are segmented using a level-set algorithm. The centroids of the somas are used as the starting point for the tracing algorithms. The soma segmentations allow us to eliminate any false seed points that lie within the soma. The remaining seeds are used to reconstruct the cellular arbors. As noted above, individual microglia are known a priori to have a tree topology. Furthermore, microglia do not form inter-connections with neighboring cells (). These constraints enable us to develop fast and scalable algorithms that are appropriate for tracing the arbors of these cells. The tree assumption is also helpful from the standpoint of extracting quantitative measurements of arbors, since existing computational neuroanatomy tools, e.g. the L-measure () expect a tree topology. Based on these considerations, we designate the centroids of the microglial somas as the root points for their respective cellular arbors. Starting from all root points, we simultaneously construct a forest of R minimum spanning trees (MST's), where R is the total number of detected root points. Each MST consists of nodes and directed edges. The nodes for a single cell include the root point, a subset of the seed points, referred to here as the primary nodes and denoted v 2 V 0 , an all intermediate pixels that are termed secondary nodes. The secondary nodes are used for calculating the costs associated with their neighbors (as explained further below). Each node is identified by its 3-D image coordinates. The directed edges, denoted e ij 2 E; link the nodes and their orientations always point towards the root point. Each edge is associated with a weight value that is used for determining whether or not a given pixel belongs in the arbor reconstruction. The process of growing each MST is based on an adaptation of Prim's algorithm (). Starting from each root node, our algorithm connects each successive node to the nearest primary node (in the sense of the cost metric defined below), to form an edge (link). This process is repeated at each added node. The algorithm iterates as it expands all the trees starting from their respective roots concurrently to cover all the primary nodes V 0. For each cell, the tree-growing procedure is stopped when a cumulative cost function (described next) exceeds a preset threshold. Once the computation of the MST's is complete, we obtain a forest of trees T k  V k ; E k , where k is the index of a tree, V k is the list of all nodes belonging to tree k and E k is the list of all edges belonging to tree k. Each tree captures the morphology of a single microglial cell.
Dynamic cost metric for linking nodesThe tree-growing process described above is guided by a cost metric that takes into account the normalized weight, denoted w i , for the classified seed points, and the spatial proximity of points being considered for a connection. Intuitively, this method traces microglial processes by linking nodes forming the shortest geodesic path along the brightest (IBA1) voxels representing the image foreground. With this in mind, we compute our connection costs using the Fast Marching Method (FMM;) that provides an efficient way to identify geodesic paths from each node to the corresponding root node. The FMM provides a fast approximation to the stationary Hamilton-Jacobi equation, commonly referred to as the Eikonal equation. This non-linear partial differential equation is used for path planning problems in non-homogeneous media. Given a domain X & R n ; the Eikonal Equation is of the form:where Cx; y; z is the cost function, Fx; y; z is a positive-valuedfunction, r denotes the gradient operator, and jj  jj is the Euclidean norm. In our formulation, the function Fx; y; z is set to the inverse of the score given by the result of seed detection algorithm, instead of the voxel intensity. In our FMM implementation, a vertex v i from a growing MST T k can be thought to emanate 'waves' that propagate through the image with their speed of propagation proportional to the normalized weight of the classifier. The wave propagation from the vertex v i is allowed to continue to the next closest vertex v j , that is not part of any previously detected tree. The new vertex v j , and the edge e j at this point are included in V k and E k , respectively, resulting in an expansion of the tree T k. This process is repeated concurrently for all trees (one per microglial cell) until all the primary nodes in V 0 are linked, or the minimum distance between all possible links exceeds a pre-defined cost threshold s. Nodes that are deemed more expensive than this threshold are not added to a tree. This is a mechanism to prevent unreliable points from being erroneously added to the distal portions of microglia reconstructions. In other words, s sets the overall sensitivity of the reconstruction method. A higher threshold makes the algorithm more sensitive to image-intensity values, and vice versa. Further details about the priority queue-based reconstruction algorithm and pseudo code summaries of our algorithm are provided in the Electronic Supplement.
Experimental resultsFor proofreading the 3-D arbor reconstructions, we used the open source FARSIGHT Trace editor (). This tool allows the user to view the reconstructions from any angle, and edit the reconstructions if desired. The editing capability was not utilized for the experiments described here, since our end goal was an analysis of microglial activation patterns rather than exact reconstructions of each cell. The core of the dice and trace method is also embedded into this tool for tracing individual cells interactivelythe user can trigger the reconstruction of an entire missed arbor by manually specifying the root point. Manually reconstructing thousands of cells, or even editing automatically generated reconstructions at this scale is not feasible and is time consuming. Our expectations of reconstruction accuracy are also appropriately pragmaticwe expect valid reconstructions with sufficient accuracy to analyze microglia activation patterns. With these considerations in mind, our experiments are primarily designed to study the impact of parameter selection on reconstruction performance. For this, we randomly selected a population of 50 cells across multiple images from multiple animals. These cells were reconstructed manually by a pool of volunteers. Each cell was reconstructed by at least two different users using the Neuromantic tool (), and saved into the standard SWC file format. This is a labor-intensive activity that takes between 40 and 60 min per cell. The next step was to compute a metric to compare the automatic reconstructions against the manual reconstructions. The DIADEM () metric is currently the most respected metric for comparing two different reconstructions. However there are a few limitations, for example, two reconstructions performed manually by different users do not necessarily concord with a perfect score of 1, and this metric was originally intended for neurons. Despite these limitations, we found this metric to be helpful in comparing reconstructions of the tree-like microglial arbors. To compare the quality of the seed points we computed three scores for every cell in the test set. The first score is the number of seed points in the vicinity (we used a radius of 5 voxels) of the manual trace. Higher percentage values indicate greater concordance. However, this does not inform us about the quality of the seed points. The next score is the percentage of seed points that are in the background. This measure indicates the potential for spurious traces. The third score is the percentage of traces missed or not covered by the detected seed points. This measure indicates the potential for missed processes. The average scores for 25 cells are presented in.
Parameter selectionSeed point selection is the primary determinant of reconstruction performance. For this reason, our first experiments are designed to evaluate the impact of parameters that directly affect this step. The first step in seed detection is to learn the patch-based dictionary. Based on the expected range of diameters of the arbor processes, we used a fixed 3-D block (patch) size of 15  15  3 voxels. The labels for learning the dictionary and training the classifier within the LCKSVD algorithm were selected randomly from the manual traces. A total of 50 000 seed points from the image foreground were randomly selected from the training images, and the same numbers of pixels were selected from the background. The dictionary D and the classifier W were derived jointly using the LC-KSVD method. The seed detection algorithm has four parameters (T; K; a,b) for the dictionary learning step. The parameters a and b set the relative importance of the terms in Equation (3). For our experiments, these parameters were set to 5 and 8, respectively following (). We observed that changing these parameters did not have a substantial impact on the type of dictionary learned. We also compared the DIADEM metric for K-SVD (by setting a to zero) versus LC-KSVD. Our results demonstrated that discriminative dictionary learning (LC-KSVD) outperforms the K-SVD method. Furthermore, the DIADEM metric did not vary significantly with respect to the size of the dictionary. During the classification stage, there is only one parameterthe sparsity constraint (T) that must be set by the user. This parameter can be set to the same value that was used for the learning stage. To examine how the reconstruction performance varies with different choices of T and K, we divided our dataset of 50 cells into two groups, a training set containing 25 cells and a test set containing 25 cells. We varied T from 2 to 15 and K from 675 to 1800, respectively, and plotted the average DIADEM metric for these 25 cells inand 4C. As pointed out in describing the LC-KSVD algorithm, the performance of the classification algorithm was not very sensitive to the size of the dictionary and the sparsity constraint, due to the discriminative term that was added during the dictionary and classifier learning stage. The performance of our algorithm was between 0.7 and 0.8 for different values of K and T, indicating that it is stable against parameter changes. The tracing algorithm is, by design, sensitive to one parameterthe cost threshold s.presents a plot of the averageThree-dimensional reconstruction and quantitative profiling of microglia populationsDIADEM metric for 25 different cells against the cost threshold. As expected, the performance of the algorithm was sensitive to this parameter. To test the robustness of the parameters to perturbations, we selected the parameters (K; T; s with the highest DIADEM metric on the training set and traced the test set. The algorithms performed equally well on this dataset with a mean DIADEM metric of 0.77 and a standard deviation of 0.07. We also compared the performance of our algorithm with two different state of the art algorithms based on Laplacian of Gaussian (LoG) and vesselness measures for detecting the seed points () for microglia images. The results were found to be on par, and in some cases, better, as shown in. However our algorithm has the important advantage of performing reconstructions in a scalable and seamless manner across large 3-D image mosaics containing thousands of cells as exemplified by. This gives us the ability to perform arbor analytics seamlessly, on a large scale, over extended tissue regions.
Population-scale arbor morphology analysis by harmonic co-clustering of L-measure dataGiven the reality that no single number captures all aspects of a complex cellular arbor, it is necessary to compute libraries of arbor features.have compiled a comprehensive library called the L-measure, containing approximately 130 features per arbor that quantify various aspects of arbor morphology (e.g. size and shape of the soma, number of stems, branching and tapering profiles, etc.). These features capture the seemingly abstract notion of 'arbor morphology' in the aggregate. In this work, we adopted this methodology for microglia populations, taking advantage of the fact that our reconstructions are guaranteed to be trees. This computation yields a large table of L-measure data with 130 columns and as many rows as there are cells. Interpreting this large table to extract usable insight is a difficult task for several reasons. First the data dimensionality is high, and individual L-measure features represent dissimilar quantities (lengths, areas, volumes, ratios, counts, etc.). The most common need for microglia analysis is to organize the cell population into groups of similar cells so the data interpretation can be attempted one group at a time. Another practical need is to identify features and groups of features that distinguish groups of cells. Co-clustering is a natural strategy for achieving these goals simultaneously. The choice of an appropriate distance measure is a central decision for co-clustering. Traditional metrics, such as the Euclidean distance measure, are quite inadequate for at least two reasons. First, the various features in the L-measure are dissimilar quantities with different units (e.g. soma volume versus process length). Second, the dimensionality of the data is high. Third, the data is inherently noisy. For these reasons, we prefer the non-linear stochastic diffusion distance () to compare arbor morphologies. Coifman's unsupervised harmonic co-clustering algorithm () uses this measure in conjunction with Haar wavelet smoothing to robustly identify groups of cells and features in a hierarchical manner. Importantly, this algorithm has very few tunable parameters, and usable results are produced with default parameter settings. The harmonic co-clustering algorithm clusters both cell reconstructions and cell features at multiple scales simultaneously. This reveals groups of cells with similar morphological properties, and the corresponding features that distinguish the cell groups. The results of co-clustering are presented as a heatmap and dual-tree representation in. Each row in the heat-map corresponds to one cell, and each column corresponds to one feature. The horizontal tree on the left-hand side of the heatmap shows the grouping of the cells, whereas the tree on the top shows the grouping of features. The analysis reveals that microglia in this dataset fall into four major groups (indicated by circles drawn on the horizontal tree). Close-up renderings of representative cells from the four groups are presented in Panels 5G15G4. They clearly correspond to the known microglial activation states including ramified/resting, elongated, activated, and amoeboid/round, respectively. The percentages of these four groups in the population are listed inin the heatmap corresponds to one cell, and each column corresponds to one feature in the L-measure. The co-clustering identified four principal groups. Representative cells from these groups are shown in Panels G1G4, and correspond to ramified cells (G1), elongated cells (G2), activated cells (G3) and amoeboid/round cells (G4), respectively. The ramified and elongated cells have the highest proportion in this data set and they are evenly distributed, whereas the activated and amoeboid cells are the smallest populations. The morphological complexities of the four groups are in decreasing order. We also calculated the mean values of the significant features from each group in. The overall size (surface area and volume) of the four groups are dramatically different from each other. Ramified cells and elongated cells are much larger than the activated cells and amoeboid cells. The complexities (segments, bifurcation, branch point and skewness) of different groups are also distinct. Ramified and elongated cells exhibit higher complexity compared to the other two types. This example illustrates the practical utility of our method.
Conclusion and DiscussionOur method provides a comprehensive population-scale solution for reconstructing, mapping, and quantitatively profiling microglial arbors in a scalable and seamless manner over extended 3-D regions of brain tissue. At the scale of individual cells, our method outperforms current approaches as summarized in. At the tissue scale, our method provides novel capabilities. It can be used to study structural and functional alterations of microglia in response to diverse stimuli, for example, experimental drugs (), injury (), and alcohol abuse (de la). By reconstructing each and every cell in the image field, we avoid the problem of high variance associated with sub-sampling-based methods like unbiased stereology (), important for precise measurement of microglial responses at precisely chosen sites. Our algorithms are capable of adapting to novel image collections by machine learning, and are not restricted to a limited range of samples that fit a predefined set of analytical models. The 'dice and trace' method guarantees that our method can generate seamless reconstructions of the microglia that straddle imaging windows, and is indefinitely scalable with existing computers. This design will be crucial as large-scale brain tissue mapping efforts turn their focus towards the under-served 'other brain' composed of glia and vasculature (). Formulating the reconstruction problem in terms of minimal spanning trees is importantit not only guarantees that the reconstructions are trees but also avoids the difficult problem of breaking non-tree reconstructions. Our algorithm for dynamic linking of nodes improves upon the traditional FMM algorithm in several ways. First, we construct multiple trees simultaneously from a common pool of nodes. This design not only takes advantage of how microglia are distributed in non-overlapping spaces, but also provides an approach to parallel computing for scalability. Second, the edge costs between nodes are not all defined when the algorithm begins execution. This is because our cost metric depends on the costs of the neighboring nodes. As the trees grow from their respective roots, more nodes are included in the queue dynamically, and their costs are updated as they are added. The final difference is that our algorithm incorporates a cost threshold s, as explained above. Nodes that are deemed more expensive than this threshold are not added to a tree. This is a reliable mechanism to prevent distant and ambiguous pixels from being erroneously incorporated into our reconstructions. Harmonic co-clustering is an effective exploratory analysis method that opens the door to subsequent group-specific analysis. This method is robust to noise in features, produces biologically meaningful yet concise results, and is scalable to large datasets (). Our experimental results show that our method is able to identify morphologically distinct subpopulations of microglia that concord with the known biology. On a practical note, we have found our linked software implementation method (www.farsighttoolkit.org) to be particularly suited to microglia analysis. Each row of the harmonic co-clustering heat map is directly linked to an individual cell, and its corresponding L-measure data. This linking extends to other analytics tools (), and a comprehensive 3-D visualization and proofreading system (). In summary, our method will enable comprehensive analysis of microglia morphology and distribution, and coupled with multi-channel 3-D imaging (), will provide unprecedented methods for mapping cellular-scale alterations as a function of development, function, disease, or injury.Three-dimensional reconstruction and quantitative profiling of microglia populations
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
M.Megjhani et al. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
