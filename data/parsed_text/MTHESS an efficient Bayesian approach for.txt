Motivation: Analysing the joint association between a large set of responses and predictors is a fundamental statistical task in integrative genomics, exemplified by numerous expression Quantitative Trait Loci (eQTL) studies. Of particular interest are the so-called 'hotspots', important genetic variants that regulate the expression of many genes. Recently, attention has focussed on whether eQTLs are common to several tissues, cell-types or, more generally, conditions or whether they are specific to a particular condition. Results: We have implemented MT-HESS, a Bayesian hierarchical model that analyses the association between a large set of predictors, e.g. SNPs, and many responses, e.g. gene expression, in multiple tissues, cells or conditions. Our Bayesian sparse regression algorithm goes beyond 'one-at-a-time' association tests between SNPs and responses and uses a fully multivariate model search across all linear combinations of SNPs, coupled with a model of the correlation between condition/ tissue-specific responses. In addition, we use a hierarchical structure to leverage shared information across different genes, thus improving the detection of hotspots. We show the increase of power resulting from our new approach in an extensive simulation study. Our analysis of two case studies highlights new hotspots that would remain undetected by standard approaches and shows how greater prediction power can be achieved when several tissues are jointly considered. Availability and implementation: Cþþ source code and documentation including compilation instructions are available under GNU licence at
IntroductionIntegrating different layers of genomic information is essential to improve our understanding of the genetic basis of complex diseases. The development of integrative analysis strategies has become an important part of experimental design in the era of next-generation genomics (). A fundamental task faced by many integrative strategies in genomics is to study the associations between two high-dimensional datasets. The study of such associations and the related biological questions can be naturally built within a regression framework, which exploits prior biological knowledge on the direction of the relationships between the different layers of genomics data. One prime example is expression quantitative trait loci (eQTL) analysis, which links DNA polymorphisms to gene expression levels on a genome-wide basis. Typically, such analyses would involve testing for association of all transcript-SNP pairs. When eQTL studies involve large numbers of variants and genes, performing millions of such tests can become slow and it has been necessary to develop fast implementations (). To go beyond such 'one at-atime' strategies, eQTL mapping can be performed using high-dimensional regression models with expression measurements modelled as responses and genetic variants as predictors (). The high-dimensional regression framework leverages information across the set of responses that are related to the same predictor, increasing the probability of detecting hotspots, i.e. genomic loci that regulate several genes at once. There is currently much interest in dissecting tissue, cell type or condition specificity of eQTLs (). The multiple tissues or cell types add an extra dimension to the data. For instance, analysis of eQTLs across multiple tissues or cell types can inform to which extent eQTLs are shared (or conserved) between different systems, therefore elucidating fundamental genetic regulatory mechanisms. So far these questions have been addressed using one of two alternative approaches. The first uses separate analysis for each tissue, and intersects the resulting lists of genetic variants (). The second approach () combines tissues but performs a separate analysis for each predictor (genetic variant) and response (gene expression level). Neither approach fully exploits the data available, nor both can result in a loss of power to detect small effect eQTLs that are shared across conditions. To the best of our knowledge, there is currently no alternative method that goes beyond 'one-at-a-time' association tests and models simultaneously the expression of multiple genes under multiple conditions in a multivariate way. In this article, we propose a generic Bayesian variable selection approach and an associated evolutionary stochastic search algorithm to tackle the challenging integrative task of linking parallel high-dimensional multivariate regressions in a computationally efficient way. The specificity of our approach is: (i) to move away from single feature at-a-time analysis and account for the correlated nature of the predictors by implementing a fully multivariate model search over the space of predictors (ii) to allow the analysis of multidimensional responses, and (iii) to exploit the relatedness of multiple responses through a Bayesian hierarchical model. Hierarchical modelling of expression responses allows us to exploit the potential functional relationships (e.g. co-regulation relationship, mRNAmRNA interactions, proteinprotein interactions, etc.) between multiple genes, thus increasing the power to detect hotspots. We build on our previous work (), demonstrate the power of our new efficient hierarchical implementation in an extensive simulation study when compared with MANOVA or the intersection of condition/tissue-specific results. We also illustrate the benefits of our approach in two case studies related to eQTLs in multiple conditions (tissues or cell types), where we recapitulate previously validated hotspots and uncover new hotspots. In one case study, we also show that when several tissues are jointly considered the prediction error is substantially reduced compared with separate single-tissue analysis. Even though our case studies relate to eQTL analyses, the model and algorithm that we present are generic and can be used for a large range of integrative genomics analyses that can be formulated within a parallel regression framework, such as finding targets for miRNAs by regressing gene expression levels on miRNA levels (), linking DNA variation and metabolites levels, the so-called mQTL analyses (), or linking copy number alterations and tumour gene expression ().
Modelling approachWe describe here in a non-technical fashion how we model the association between multiple responses, here the expression of genes in different conditions (e.g. tissues, cell-types, disease states, etc.), and many predictors, here the SNPs. We present a Bayesian variable selection method that acts simultaneously on three levels: 1. Each response in each tissue is sparse-regressed on all the predictors. 2. The sparse regressions from all tissues for the same response are performed jointly as a multi-variate regression, modelling the correlation between tissues, with the same predictors selected for controlling the response in all tissues. 3. The multi-tissue regressions across all responses are influenced by shared prior parameters that encourage borrowing of information.Combining information between tissues allows us to boost signal in a robust way because the residual correlation is modelled accurately by latent covariance matrices. The first level is the key driver of the method. This single response variable selection is accurately described in Bottolo and Richardson (2010). Building on a sparse formulation, this level of analysis eliminates all predictors for which the signal is not strong enough. The model takes into account the correlation between predictors to better identify the best supported combination of predictors. The performance of this method is illustrated in Bottolo and Richardson (2010) and, and it shows a major improvement over univariate and commonly used penalized regression methods used in the 'large p, small n' framework in terms of separation between signal and background noise, and in terms of genetic resolution as it can handle the highly correlated predictors that result from linkage disequilibrium (LD). The second level is built on top of this variable selection, in the sense that evidence from all the tissues influences the probability for a predictor to be selected. This strong assumption is reasonable only when considering a small number of correlated traits for which evidence of joint control is interesting to quantify. Note that once a predictor is selected, tissue-specific regression coefficients can be estimated from the posterior distribution. The third level pools information across all responses in order to enhance the detection of hotspots. It also has the great benefit of eliminating many false positives. The performance of this choice of prior was explored in
Methods
Bayesian hierarchical sparse regressionsOur model is an extension of HESS algorithm () to the case where the response variables are observed in multiple conditions, e.g. in different tissues, cell types or time points. We consider q response variables observed in r different conditions. In the following, we will use upper-case letters for matrices and lower-case letters for vectors and scalars. For k  1;. .. ; q, let Y k be an n  r matrix, whose entry y ik' is the response k measured in condition ' for individual i. The explanatory variables are stored in an n  p matrix X such that x ij is the jth explanatory variable measured in individual i. The association between the explanatory variables and the responses is modelled through q linear regressions linked by a hierarchical model. Each of the q regression equations is given bywhere the matrix of regression coefficients B k is of size p  r, whose generic element b kj' is the regression coefficient relating x j to y k in condition '. Finally, N I n ; R k  is the matrix normal distribution with independent rows, and columns correlated according to the r  r covariance matrix R k (). The intercept A k and the between-conditions covariance matrix R k are specific to each response k. To perform variable selection, we introduce a binary matrix C of size q  p such that c kj  0 implies b kj'  0 for all ' and c kj  1 implies b kj' 6  0 for for all '. For a given k, we denote by c k the row binary vector c k1 ;. .. ; c kp  with the number of its nonzero entries given by jc k j. The matrix X c k of size n  jc k j is obtained by selecting from the matrix X all the columns j such that c kj  1. Similarly, we define B c k to be the matrix of non-zero coefficients of dimension jc k j  r obtained by selecting from the matrix B k all the rows j such that c kj  1. Conditionally on C, A 1 ;. .. ; A q ; B 1 ;. .. ; B q and R 1 ;. .. ; R q , the q sparse regressionsare independent, and their joint likelihood is given by
Prior settingsThe prior distribution for the regression coefficients for the kth response is the matrixvariate normalcentred in the jc k j  r matrix of 0 s, where the prior covariance of the regression coefficients follows a g-prior (). We choose for the constant A k the non-informative prior pA k  / 1. To gain flexibility in fitting the correct amount of shrinkage, the parameter g is learned from the data, and its prior distribution is given by g $ InvGammaa g ; b g . For the binary matrix C, we introduce a q  p matrix X such that Pc kj  1 j X  x kj. To favour hotspot detection while maintaining a sparsity prior C, we decompose each cell of the matrix x as x kj  x k  q j , where the row effect x k accounts for the sparsity, and the column effect q j accounts for the propensity of predictor j to be a hotspot, that is to be associated to a significant proportion of the responses (see the following section for hotspots definition in practical applications). The sparsity prior is given by x k $ Betaa x k ; b x k  and q j $ Gammac q j ; d q j , where x 1 ;. .. ; x q and q 1 ;. .. ; q p are all a priori independent. To enforce that x kj is a probability, we impose the constraint 0 x k  q j 1. The interested reader is referred tofor further information about the multiplicative decomposition of x kj and the sparsity priors assigned to its components. Finally, the prior for the cross-tissue error covariance matrix R k is an Inverse Wishart distribution, R k $ IWd; h k I r . The priors we have chosen allow to integrate out the regression coefficients B k , the intercepts A k and the residual cross conditions covariances R k. For each response k, k  1;. .. ; q, the conditional marginal likelihood is given bywhereThe joint distribution of the Bayesian model factorizes asTo complete the specification of the model, we need to discuss the hyperparameters setting for the priors. Regarding the shrinkage parameter g, a popular choice is the ZellnerSiow priorregression for each condition '  1;. .. ; r. Then we set h k as the median of the condition-specific estimates of the error variance.
MCMC algorithmThe inference on this high-dimensional model is performed using a specifically designed MCMC algorithm. This algorithm has already been presented in great detail in, so we are simply sketching its structure, and we refer to the relevant sources for all the technical details. The variables sampled are those that appear in the posterior density (1), that is the q  p matrix C  c 1 ;. .. ; c q  T , the vectors x 1 ;. .. ; x q and q 1 ;. .. ; q p , and the parameter g. The challenging part is the sampling of the matrices C, and this problem is solved by relying on an Evolutionary Monte Carlo (EMC) structure as introduced in Liang and Wong (2000). To avoid being trapped in a local mode, EMC samples several chains, each with its own temperature, and allows them to exchange information. At each step, the chains are updated by local moves which act on a single chain (i.e. traditional MCMC moves), as well by global moves, which use a selection step inspired from genetic algorithms. In our setting, if we run the MCMC algorithm for T sweeps and C chains, its output is given byand g t with t  1; :::; T and c  1; :::; C. The parameter g has been kept in a single chain because this setting allowed for a faster convergence of our algorithm (see). All the details regarding the local moves and the global moves, as well as the tuning of the temperature parameters, can be found in
Post-processing
Declaration of associations and hotspotsThe posterior distribution of any function of any subset of model parameters can be calculated straightforwardly in the MCMC estimation of the model. Since the model includes explicit variable selection parameters (c kj ), we focus on functions of those parameters in order to summarize the evidence of association between predictors and responses. Pairwise association between response k and predictor j is thus quantified by the marginal posterior probability of inclusion (MPPI)This quantity summarizes the evidence brought by all the data regarding whether the predictor x j is associated with the n  r response Y k. It is straightforwardly estimated by the average number of times c kj  1 during the MCMC run. In order to obtain a list of associations of interest, we need a decision rule. The simplest choice is to threshold on the MPPI: declare an association if p kj is greater than some threshold value c. The threshold is set according to the user's required balance between false positives and false negatives. An alternative approach is to calculate the so-called Bayesian FDR (). For a given threshold c, this is defined asUsers can either calculate the bFDR for a given threshold on the p kj , or can set a required level of bFDR and use that to find a threshold on the p kj. Either way, the declared pairwise associations are those with the largest values of p kj. In the Supplementary Material, Section S.3, we give the true FDR values for our simulation datasets for the decision rule defined by setting a threshold on bFDR. We find that on average the method is conservative, i.e. the bFDR overestimates the true FDR value in line with the strong shrinkage of the p kj resulting from our sparsity assumptions. Thus, reported hotspots using bFDR cut-offs carry a higher level of support than their nominal level. For the results in this article, we use the p kj to declare hotspots as well as pairwise associations. We use a target value of the bFDR to find a threshold on the p kj to declare pairwise associations, and subsequently count the number of associations for each predictor. Other options would be to consider directly the number of associations P k c kj for predictor j, and use the posterior mean or posterior probability of reaching a given level to declare hotspots. Focussing on a particular response k, it can also be of interest to look at the whole set of predictors found to be associated with that response. For this we consider the whole vector c k. We calculate a 're-normalized' estimate of posterior model probabilities for each response, see Supplementary Material, Section S.2, for details.
Model adequacyIn this section, we describe the Bayesian implementation of leaveone-out prediction error and model adequacy (). For ease of notation, in the following we bypass the subscript ' that indicates the condition/tissue under investigation. Let c B k  fc B k : B  max t pc t k jY k ; Xg be the vector of the best model visited during the MCMC for response k. For each response k, given the best model visited c B k and after integrating out the parameter g numerically, we generate observations y f ik from the predictive density f y f ik jy ik ; c B k , where y ik denote the n  1 data vector with y ik deleted. Under model adequacy, y ik is then checked against f y f ik jy ik ; c B k . Since, if the model holds, Y ik is a random realization ofare the empirical mean and variance calculated from the MCMC iterations. For each response, squared prediction error is summed over the sample and the quantity P i gy ik ; y f ik  2 is then used as a measure of model adequacy with large values indicating that the model performs poorly. This quantity resembles the widely adopted mean-square error with the notably modification that now the differences between the predicted and observed values are standardized.
Simulation studyIn order to investigate the performance of our multi-tissue method, we construct an artificial dataset with three tissues and 150 responses. As in, we use the whole genome data of rat Recombinant Inbred (RI) strains derived from a cross between the Spontaneously Hypertensive Rat (SHR) and the Brown Norway (BN) strains, which we have used previously to identify eQTLs across multiple tissues (). This choice allows us to test the performance of our algorithm and compare it with alternatives methods when complex patterns of correlation between markers depends on genetic forces that shape the structure of LD. After removing redundant variables, the genome-wide number of SNPs is reduced to 1304, giving a 29  1304 X matrix. Conditionally on the SNP matrix X, we generate responses for each tissue from a linear model. For each tissue '; 1 ' 3, the n  q matrix Y ' gathering the observations of the 150 responses is given by the regressionwhere B ' is the p  q matrix of regression coefficients, E ' is the n  q matrix of residuals for tissue ' and E shared is a n  q matrix of residuals shared by all tissues. The residuals are given by ik' $ N0;The matrix B ' controls the pattern and strength of signal between each responses and predictors in tissue '. For the simulations we keep B ' constant across tissues (b kj'  k kj  c kj ) and control the signal-to-noise patterns through the noise variance parameters. The pattern of non-zero associations between responses and predictors is encoded by the matrix C of 0 s and 1 s. Because, our method is aimed at detecting a signal that is present in different conditions, we use the same association pattern C in all conditions. This configuration can be seen inwhere six hotspots (vertical bars) with a varying number of associations per hotspot are simulated. The exact specification is given in the Supplementary Material, Section S.1.1. The signal strength is parameterized by l, with k kj $ Nl; 0:001 2 . The signal-to-noise ratio in each tissue is tuned thorough the tissue-specific noise standard deviation r ' and the 'shared' noise standard deviation r shared. Assuming without loss of generality independence of the noise variances, the total noise standard deviation for tissue ' is given by r totalThe correlation between tissues is proportional to the 'shared' noise variance and also depends on the noise variances of the two tissues considered (see Supplementary Material, Section S.1.2). We have conducted an extensive investigation into the effect of the signal-to-noise ratio imbalance across tissues and here we show the output of the simulations for independent residuals (r shared  0) and correlated residuals (r shared  0:04). In each case, we consider a balanced case with r total ' 0:4g. We also ran the simulations with several levels of the signal strength l. For the plots presented here we chose l  0:15. For each simulation set-up we generated nine replicates, and for each of the datasets simulated, we ran MT-HESS analysing the three tissues jointly and a MANOVA test () for each multiple tissue responseSNP pair separately. We also include the receiver operating characteristic (ROC) curves intersecting the results from the single-tissue version of HESS run on each separate tissue (following). We call these analyses iSTHESS, intersection of single tissue HESS, to distinguish it from MTHESS, multi-tissue HESS. Associations were declared by thresholding MPPI values for MT-HESS and ST-HESS and P-values for MANOVA. For the intersection iST-HESS, associations are declared positive for a given threshold if the single-tissue MPPIs exceed the threshold in all three tissues.shows ROC curves for each of the four combination of balanced/unbalanced noise across tissues and independent/correlated residuals between tissues. We see that MT-HESS clearly outperforms MANOVA in all scenarios, which confirms what has already been shown in the literature, that is penalization methods outperform 'one-at-a-time' methods (), and that borrowing information across responses improves even further the performance (). Comparison between MT-HESS versus iST-HESS also confirms previous results () that the intersection of(d) Unbalanced & Correlatedtissue-specific findings is likely to be a conservative approach and is potentially affected by variability between tissues. Specifically in the unbalanced case, MT-HESS strongly outperforms the intersection of separate single-tissue results. This is still evident, although less pronounced, in the balanced case with independent noise. As expected, correlated noise lower slightly the ROC curves for the multi-tissue methods (MT-HESS and MANOVA) since it encourages propagation of false positives across all the tissues. Obviously, this does not affect iST-HESS. Note that the balanced cases have higher signal-tonoise ratio than the unbalanced ones, and so ROC curves for all methods are higher. Supplementary Material, Section S.1, shows a greater range of simulation set-ups and detailed findings for all the methods compared here, i.e. MT-HESS, MANOVA and iST-HESS. In particular, we provide further results obtained by specifying different levels of the signal strength l. We illustrate how MT-HESS achieves a better separation between noise and signal and how it allows to identify more hotspots than traditional methods. We now investigate the ability of the model to detect different types of association patterns. Since the model is designed to borrow information across responses, it is of interest to see whether the model can also detect predictors associated with a single response, for instance, if we can still detect cis-eQTLs. To look at this, we use a different pattern of associations, with six markers designated as hotspots (two each with 10, 20 and 30 responses associated) and 10 cis markers. Half the cis-associations are completely isolated, for the other half the response is also associated with other (trans) markers. The pattern is shown in. We allow the cis-associations to be stronger than those in the hotspots, as trans-associations are expected to be weaker, thus we now have two parameters for signal strength l cis  0:6 and l trans  0:15 with independent residuals (r shared  0) and balanced total noise standard deviation r total '  0:1; 1 ' 3. ROC curves for these associations are very similar to the case shown in(data not shown). The overall performance for all methods considered here is slightly lower for the new cis-and trans-association pattern, due to the lower proportion of associations contained in hotspots. To compare in detail cis-and trans-results, we classify the responsepredictor pairs as 'true negative', 'true cis isolated', 'true cis other' and 'true trans' (part of hotspot).shows the crossclassification of 'true' and 'called' status for the three approaches considered here. Thresholds for calling pairwise associations were determined by fixing the true FDR level at 10%. We see that while both MT-HESS and iST-HESS are able to detect the cis-associations very well, the multiple tissue model is able to pick up more of the associations that are contained in hotspots, thus showing the benefit of combining the tissues in a fully Bayesian way. The MANOVA misses all hotspot associations in this example. Looking directly at the hotspots,shows the average estimated size of each true hotspot (defined as number of responses called marginally): it is clear that MT-HESS has more power to detect hotspots than iSTHESS.
Results
Rat dataThe rat dataset consists of multiple tissue expression and genomewide genotype data ($1400 SNPs) in a panel of 29 RI rat strains (). Here, we focus on the multi-tissue eQTL mapping of a previously reported Interferon regulatory factor 7 IRF7-driven inflammatory network (IDIN) found to be associated with immune response and increased risk of type 1 diabetes in humans (). We used HESS to re-analyse a sub-set of the IDIN network in three rat tissues (left ventricle, aorta and liver) focusing on 146 probe sets (corresponding to 143 protein coding genes), which are both robustly expressed and varying in expression across the three tissues. See Supplementary Material, Section S.5, for details of how these genes were chosen. We ran ST-HESS separately in each tissue and MT-HESS simultaneously across the three tissues, as well as a MANOVA () analysis. We ran HESS on a 2.90-GHz Intel(R) Xeon(R) CPU computer with 130 GB of memory for 15 000 sweeps of which 5000 as burnin and the same hyper-parameters as in the simulation studies. Computational time was 70 and 114 min for ST-HESS (average across tissues) and MT-HESS, respectively. Visual inspection of the trace of the parameters w k and q j and g show no erratic behaviour. Convergence is reached after few iterations due to the combined effect of the automatic tuning of the proposal density in the MetropolisHastings algorithms and the parallel chains implementation which allow good mixing. Focusing on probe set-marker associations significant when using a Bayes FDR (bFDR) of 5% (which corresponds to a MPPI > 0.8), MT-HSSS identified three loci controlling more than 30% of the probe sets under analysis (). In addition to the regulatory hotspot in rat chromosome 15q25, which was previously identified and experimentally validated (), joint analysis of the three tissues revealed two new regulatory hotspots for the IDIN, located at marker J343641 on rat chromosome 10, and at marker SHRSPc66a05_r1_451 on rat chromosome 1, respectively. We also investigated the associations of IDIN network in each single tissue. ST-HESS analysis uncovered a signal for the rat chromosome 15q25 locus in left ventricle tissue, as previously shown (), but failed to identify the new regulatory loci in chromosome 10 and 1, see. In view of the variability of ST-HESS between the three tissues shown in, we did not consider iST-HESS further as it lacks power in unbalanced cases.Note that with the same 5% FDR threshold on P-values for declaring associations, the MANOVA analysis does not return any SNPs associated with five or more genes. In order to see if a MANOVA analysis shows some of the evidence for the hotspots discovered by MT-HESS, we also computed for each locus the sum over all transcripts of the negative log P-values for the MANOVA test (Supplementary). This plot is very noisy, but it is clear that the P-values contain evidence for the hotspots on chromosomes 10 and 15. Given the different output produced by MT-HESS and ST-HESS, we have also investigated their model adequacy (). We compared the two models on the basis of their leave-oneout prediction accuracy by removing one observation at a time and using the remaining observation for calculating the prediction error. Followingwe took a fully Bayesian perspective employing predictive distributions to evaluate model performance by comparing model prediction with what has been observed. To be precise, we use standardized prediction error as checking function, as shown in Equation (2), with squared prediction error summed over the sample as model adequacy.shows the value of model adequacy averaged across probe sets. The best (shared across tissues) models fc B 1 ;. .. ; c B q g obtained by MT-HESS have on overage smaller prediction error than the best models identified by ST-HESS in each tissue separately. In particular MT-HESS is able to predict better than ST-HESS in aorta and liver tissues where ST-HESS was unable to identify any hostpost. In the left ventricle tissue, the additional two hotspots detected by MT-HESS permit a more accurate prediction than the single STHESS hotspot. Altogether, the vast majority of probe sets are better predicted by MT-HESS: among the 32 (22%) probe sets better predicted by ST-HESS only two were declared associated at 5% bFDR with the hotspots found by MT-HESS, showing that almost all probe sets (51/53) controlled by MT-HESS multiple hotspots are better predicted than by single-tissue analysis. Overall, we conclude that the model that comprises the experimentally validated and previously undiscovered putative hotspots is a more adequate model to explain the joint variation of the transcripts across tissues. We comment in more details on the regulatory hotspot located in rat chromosome 10 (rat marker J343641), which showed association with 53 probe sets (MPPI > 0.8), representing 53 protein coding distinct genes. Enrichment analysis of transcription factor binding sites (TFBSs) in the putative promoter of the corresponding human orthologous genes using PASTAA () revealed over-representation of TFBS motifs for IRF7 (adjusted P  3:75  10 4 ), IRF2 (adjusted P  2:60  10 2 ) and NFKB (adjusted P  3:19  10 2 ) and IRF1 or IRF10 (adjusted P  3:20  10 2 ), in keeping with the known IRF-driven regulation of IDIN network genes (). Examination of the genes in the LD block around the regulatory locus on rat chromosome 10 (r 2 > 0:8), revealed only one annotated protein coding gene, Foxk2, with deletion of an exon and an intron in the Spontaneous Hypertensive Rat compared with the BN rat (). Foxk2 encodes the transcription factor forkhead box protein K2. The human orthologue FOXK2 gene is an inhibitor of the Sendai virus-induced IFN-b production and, at the protein level, it forms complexes with two known interferon transcriptional repressors, IRF2 (one of the transcription factors whose binding motifs were enriched as described above) and IRF4 (). In view of this, we propose Foxk2 as a candidate master regulator of the subset of the IDIN network genes whose expression is associated with the regulatory loci located in rat chromosome 10.
Human dataThe human dataset comprised genotype and corresponding expression data from three purified leukocyte subsets (monocytes, and CD4 and CD8 T cells) isolated from the peripheral blood of 59 patients with inflammatory bowel disease (see Supplementary Methods for full details of the cohort). Note that CD4 and CD8 T cells are both T lymphocyte subsets, whereas monocytes are from the myeloid lineage. We ran HESS separately on each cell type, and simultaneously on the joint dataset. The analysis was restricted to 21 788 SNPs on chromosome 5 and 3248 probesets selected by highest variance (see Supplementary Material, Section S.6.1) for computational feasibility. HESS was run using a burn-in of 4000 sweepsFor each tissue, average model adequacy measure across probe sets is reported with standard deviation in brackets. Out of 146 transcripts analysed in the IDIN network, the number of times ST-HESS model adequacy measure is greater than the MT-HESS one is reported in the last column with % in brackets MT-HESS: Multi-Tissue Hierarchical Evolutionary Stochastic Searchand values recorded for 8000 sweeps. MT-HESS took 110 h on a 2.80-GHz Intel(R) Xeon(R) computer. In the single cell type analysis, hotspots were most frequently detected in CD4 T cells, followed by CD8 T cells, whereas in monocytes we found a paucity of hotspot SNPs (). Using a 5% bFDR, the maximum number of genes associated with a SNP in monocytes was 6, versus 78 in CD4 T cells. There was less gene gene correlation in the monocyte expression data (Supplementaryc), and this may account for the lack of hotspot detection in this cell type. In the joint MT-HESS analysis 28 SNPs were associated with expression of five or more genes at a 5% bFDR significance threshold, with four of these SNPs associated with 20 or more genes (Supplementary). The signal in the joint analysis appears to be driven predominantly by signal in either the CD4 T cells or the CD8 T cells (). Unlike in the analysis of the rat data, we did not observe any hotspots that were not detected in the single tissue analysis. However, the number of genes associated with hotspots in the MT-HESS analysis was not substantially diminished despite the hotspots being highlighted mostly in one of the three cell-types (Supplementary). We identified a putative trans master regulator SNP, rs11745891, associated with the highest number of genes in both the CD4 T cell and the joint analysis (78 and 71 genes, respectively). The SNP lies in an intergenic region, $143 kB downstream from the end of the nearest gene, PIK3R1 (phosphoinositide-3-kinase, regulatory subunit 1 (alpha)). Histone marks from ENCODE () suggest the SNP lies near a regulatory locus (Supplementary). Interestingly, this hotspot SNP lies 10.7 kb from the start site of a long intergenic non-coding (linc) RNA (Ensembl transcript ENST00000507733). Emerging evidence suggests that long non-coding RNAs play an important role in orchestrating transcriptional programmes through a variety of mechanisms, commonly involving ribonucleic acidprotein interactions (). We hypothesize that our SNP acts in cis on the lincRNA, and thus exerts its trans effects through differential expression of the lincRNA according to genotype. The 78 genes whose expression in CD4 T cells was associated with rs11745891 genotype are located on 21 chromosomes, most frequently chromosome 1 (nine genes) (Supplementary). P-values from simple univariate regression of the expression of these genes on rs11745891 were skewed towards zero (range from 1:23  10 3 to 1:57  10 8 , see Supplementary). However, after multiple-testing of 3248  217 888  70 767 424 SNPgene pairs, using a 5% FDR threshold (BenjaminiHochberg procedure), none remained statistically significant, demonstrating the strength of HESS in high-dimensional omics analysis. The expression levels of these 78 genes were very highly correlated (). Strong correlation persisted in the residuals from the simple regression of expression of these genes on rs11745891 genotype (). A strength of HESS over traditional one SNP at-atime methods is its multivariate approach combined with variable selection, allowing us to ask what combination of SNPs best explain gene expression. Using this information, we next performed regression of expression of each gene on its best combination of SNP(s). The resulting residuals were substantially less correlated than the residuals from regression on just the hotspot SNP alone (). Thus, we see that including multiple SNPs in the model accounts for a substantial fraction of the correlation in gene expression. This highlights a major advantage of our approach. Additional discussion of the human results is given in the Supplementary Material.
DiscussionThe availability of data collected over multiple tissues or conditions is becoming increasingly common given the decreasing cost of generating transcriptomic, metabolic and epigenetic phenotypes over large cohorts of individuals (). In this article we present a new model that exploits the multidimensional nature of these data and extends ST-HESS presented in: our new hierarchical model and C algorithm, MT-HESS is able to analyse a large number of responses collected over dependent multiple tissues or conditions and regress them on a large set of correlated predictors. Similar to its parent version, MT-HESS retains the ability to perform hotspot discovery inomics experiments. To the best of our knowledge, MT-HESS is the first tool able to unravel whether a genetic marker has a systemic role and influences several OMICS traits in multiple related conditions at the same time. This is demonstrated in the complex multiple tissue scenario of our real rat data analysis. The increased power of MT-HESS allowed the detection of both experimentally validated and previously undiscovered putative hotspots for the IDIN network across left ventricle, aorta and liver tissues. Prediction error analysis confirms the importance of the new detected hotspots. Modeladequacy measure shows the superiority of MT-HESS model over ST-HESS and the benefit of the integrated analysis. While in the rats dataset it is possible to perform a leave-one-out crossvalidation approach, in larger datasets out-of-sample prediction error can be performed by taking a random split of the data, for instance 50/50, and reserving the remaining data for calculating the average prediction error. Due to a lack of competing algorithms that can analyse multiple layers of correlated responses in a fully multivariate fashion, we have compared MT-HESS with a MANOVA test, which is extensively used when multiple outcomes are present. Recall that such MANOVA test is performed for each pair of (SNP  response vector) at a time, where the vector of responses correspond to the expression in multiple tissues or conditions. We see that MT-HESS outperforms MANOVA, demonstrating that our hierarchical modelling approach is more powerful than pairwise methods. When faced with an eQTL analysis task which involves multiple tissues, a natural alternative to MANOVA test is to compare results from the intersection of single-tissue model (iST-HESS) with those from the multiple-tissue one (MT-HSSS). Our extensive simulation study show that when there is a similar pattern of association but varying levels of signal-to-noise ratio across tissues, MT-HESS clearly outperforms iST-HESS. This is well in keeping with the construction of the model underlying MT-HESS, which performs a statistically sound evidence synthesis for detecting hotspots between the set of conditions or tissues. When signal-to-noise ratio is constant across conditions/tissues MT-HESS results become closer to those of iST-HESS pointing to the benefit of adjusting for external sources of correlated noise prior to MT-HESS analysis, for example by using a latent factor approach as in. In our simulation study we show a substantial gain of power of MT-HESS when the association in each tissue were too weak to be detected by ST-HESS, a situation also illustrated in our first case study where two new hotspots were highlighted by MT-HESS, whereas they were not detected in the single tissue analyses. Here the ST-HESS signal is relatively noisy and the ability of MT-HESS to borrow and synthesize information between different layers of the responses results in higher power for MT-HESS. Our new C implementation of the complex hierarchical structure in MT-HESS (comprising ST-HESS as a special case) permits efficient analysis of very large datasets. It made feasible an MT-HESS analysis of our human dataset, where a multivariate analysis and variable selection between 3000 responses in three cell types and nearly 22 000 SNPs was carried out. The putative novel trans master regulator situated near a long intergenic non-coding (linc) RNA (Ensembl transcript ENST00000507733) (see Section 4.2) is a good example of the power of our approach for generating hypotheses which can be validated by follow-up experiments. The clear separation between noise and signal offered by our sparse regression approach is paramount for successfully prioritizing such further validation. In conclusion, our new algorithm MT-HESS with its efficient C architecture is tailored to jointly analyse realistic case studies that comprise a large number of responses collected over dependent multiple tissues or conditions and a large set of potentially collinear predictors.
A.Lewin et al. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
g $ InvGamma1=2; n=2, which allows to learn the amount of shrinkage from the data. Theoretical results show good properties of this prior in model selection (Liang et al., 2008), but little is known when the Zellner prior is used in q related (multiple conditions/tissues) regressions with an exchangeable shrinkage prior on g. In our set-up we have found empirically that when q is large the level of shrinkage is too low. We adapted the ZellnerSiow prior to related multiple responses by taking g $ InvGammaq=2  q  1; nq=2. This corresponds to keep the same prior mode for g as in q  1, and at the same time increasing the precision of the prior proportionally to the number of responses. In our experiments, this improved the performance. We fix c q j  1:2 and d q j  1:2 for all j, in order to centre q j on average around 1. This choice of parameters for the Gamma distribution ensures a finite mode while allowing a large coefficient of variation, thus providing necessary shrinkage for most q j s towards 1 but also supporting some large q j s to enhance hot-spot detection. Alternative parameterizations cannot achieve these two competing goals simultaneously. See Supplementary Material, Section S.4, for a sensitivity analysis on a simulated and real dataset. We let the parameters a x k and b x k to be chosen according to the specific dataset to be analysed. These hyperparamters are determined by back calculation once, for each k, Ejc k j) and Varjc k j) (respectively, the a priori expected number of predictors and its variance for each response k) are specified. Finally, for the covariance matrices R k , we choose the convenient value d  3, which brings ER k   h k I. The choice for h k is more complicated, as it should be comparable in size with the likely error variance. We use the same empirical Bayes approach as in Petretto et al. (2010), that is, for a given response k, we run a stepwise MT-HESS: Multi-Tissue Hierarchical Evolutionary Stochastic Search
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
