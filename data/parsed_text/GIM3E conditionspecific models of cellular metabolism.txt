Motivation: Genome-scale metabolic models have been used extensively to investigate alterations in cellular metabolism. The accuracy of these models to represent cellular metabolism in specific conditions has been improved by constraining the model with omics data sources. However, few practical methods for integrating metabolo-mics data with other omics data sources into genome-scale models of metabolism have been developed. Results: GIM 3 E (Gene Inactivation Moderated by Metabolism, Metabolomics and Expression) is an algorithm that enables the development of condition-specific models based on an objective function, transcriptomics and cellular metabolomics data. GIM 3 E establishes metabolite use requirements with metabolomics data, uses model-paired transcriptomics data to find experimentally supported solutions and provides calculations of the turnover (production/consumption) flux of metabolites. GIM 3 E was used to investigate the effects of integrating additional omics datasets to create increasingly constrained solution spaces of Salmonella Typhimurium metabolism during growth in both rich and virulence media. This integration proved to be informative and resulted in a requirement of additional active reactions (12 in each case) or metabolites (26 or 29, respectively). The addition of constraints from transcriptomics also impacted the allowed solution space, and the cellular metabolites with turnover fluxes that were necessarily altered by the change in conditions increased from 118 to 271 of 1397. Availability: GIM 3 E has been implemented in Python and requires a COBRApy 0.2.x. The algorithm and sample data described here are freely available at: http://opencobra.sourceforge.net/ Contacts:
INTRODUCTIONThe extraction and integration of biological knowledge from large, omics datasets is an active area of research (). Genome-scale metabolic models (GEMs) provide a 'context for content' for metabolic information and facilitate interpreting large datasets in terms of the resulting functional state of the network (). As opposed to an inference-based analysis of omics datasets (), GEMs enable the calculation of the flux through network reactions (). However, sufficient information to uniquely determine all of the fluxes for network reactions is generally not available (). Constraint-based modeling approaches are useful for calculating network states at the genome scale, establishing bounds of allowed operation of the network from available information (). Omics datasets can be used to better constrain the allowed operations of a metabolic network model and improve the accuracy of flux predictions, especially when the regulatory logic of the network is not fully known (). The value of model-guided analysis of omics data is evident from its application in a variety of contexts in systems biology research (). For example, constraint-based models have been used to assess the impact of alternate conditions on growth rate, biofilm formation and other functions that pathogens require to effectively implement a virulence program (). In the context of mammalian metabolism, constraintbased models have been used to study metabolic alterations in diseases of interest to medical research () and drug development (). Algorithms have been developed and used to automatically constrain GEMs by using a variety of data types, especially transcriptomics and proteomics (). Metabolomics has also been used to develop model constraints () and infer altered reactions from GEMs (). When isotopically labeled metabolic substrates are used for cellular uptake, GEMs facilitate the calculation of metabolic fluxes directly from metabolomics data (). In addition, GEMs can be used with transcriptomics data to infer transcriptional control of cellular metabolites (). Metabolomics data can also be used to develop model flux constraints, but using measures of cellular metabolite concentrations to develop model reaction flux constraints requires additional information (). For example, reaction directionality can be bound by the calculated Gibb's free energy change of a reaction from metabolite concentrations (or more precisely, activity) (). However, the free energy *To whom correspondence should be addressed. change for all reactions in the model often is not available and must be estimated from group contribution theory (). Also, free energy varies as a function of cellular pH (), which might be unknown. Furthermore, the concentration of all reaction participants may not be known. Finally, available metabolomics data may be qualitative or semi-quantitative and may not give the absolute concentration of detected metabolites. Here, we present an algorithm to enable the integrated functional analysis of intracellular metabolomics data and gene expression microarray data, guided by a GEM. The algorithm, GIM 3 E (Gene Inactivation Moderated by Metabolism, Metabolomics and Expression), uses metabolomics data to ensure that the detected species are used in the calculated network operating states. Transcriptomics data are used in GIM 3 E to further constrain the model fluxes. The models created with the GIM 3 E algorithm report the modeled rate of creation or consumption (turnover) of metabolites. GIM 3 E can also be implemented with metabolomics data that report the identity of detected metabolites and does not require their absolute concentrations. We developed and used GIM 3 E during an investigation of alterations in S.Typhimurium metabolism in 'rich' and 'virulence' media specifically to combine the broad semi-quantitative metabolomics dataset we developed for this infectious microbe with transcriptomics data (). Our purpose was to better constrain the model and perform an investigation of alterations in the network that was focused on metabolite turnover. Unexpectedly, we discovered alterations in metabolites with previously postulated immunomodulatory roles () and a preferential maintenance of cellular pathways implicated in virulence. However, we did not provide a detailed description of the steps in the algorithm or perform a holistic investigation of the impact of transcriptomic and metabolomic constraints on the conclusions drawn to better validate GIM 3 E. Therefore, we expand on our previous analysis, detail GIM 3 E and elucidate the impact of additional omics data sources on the model-guided interpretation of metabolism.
METHODS
Steps in GIM 3 EThe steps in GIM 3 E proceed in distinct phases to implement constraints based on the cellular objective as well as metabolomics and transcriptomics data (). Models developed with GIM 3 E also report the production or consumption (turnover) of metabolites by adding turnover metabolites to the model. Hence, any reaction that produces or consumes metabolite 'A' also produces a corresponding 'turnover' metabolite, 'A T .' A sink reaction for the turnover metabolite, i.e. 'R ATS ,' therefore tracks the flux through the metabolite. The network can then be constrained to use a detected metabolite by imposing a minimum flux requirement for the turnover. As in the previously developed Gene Inactivation Moderated by Metabolism and Expression (GIMME) algorithm (), penalty coefficients are calculated for model reactions based on transcriptomics data. The penalties minimize the degree to which the network uses reactions that have weaker supporting evidence in the data. Manipulations to the stoichiometric S matrix are also shown in. The mathematical description of the steps in GIM 3 E follows.
Determination of objective function boundThe GEM is optimized for the selected objective with flux balance analysis (). Maximize:Such that:Here, c is a column vector of objective coefficients, v is a column vector of reaction flux values, S is the stoichiometric matrix, a is a vector of lower bounds for the fluxes and b is a vector of upper bounds for the fluxes. Note that a and b include limits for nutrient uptake, and will vary based on the media. Once the optimal value is determined, a constraint is added to require that the objective maintains a value greater than or equal to some fraction, f, of the optimum objective value, o opt. 2. Addition of turnover metabolites The model is first converted to an irreversible format that serves two purposes. First, breaking reversible reactions into complementary irreversible pairs is required for the calculation of virtual metabolite turnover. Second, complementary irreversible pairs will be mathematically necessary to calculate a penalty using commercial linear program solvers. A turnover metabolite for each model cellular metabolite is added to each reaction that produces or consumes the corresponding model cellular metabolite. Next, a sink reaction for each turnover metabolite is added. To ensure that detected metabolites are used by the network in valid model solutions, the lower bound on flux through each turnover sink reaction corresponding to a detected metabolite is set to a small positive value limited by the solver's numerical tolerance (here, 1  10 8 ). As described previously (), it was not possible to require 100% of optimal growth and also produce all detected metabolites. Therefore, we set f to 0.99 to stay within 1% of the maximum objective value, o opt. 3. Addition of penalty coefficients Transcriptomics data are used to develop penalties to reduce the use of reactions with lower evidence for expression. Transcriptomics data are particularly useful, as these data generally offer good coverage of the reactions in the genome-scale model. Penalty coefficients are calculated for each model-paired transcript on the basis of intensity by:Here, g indicates the transcript-associated penalty coefficient for transcript g. I g indicates the corrected log 2 intensity for transcript g. I max indicates the maximum corrected log 2 intensity for all model-paired transcripts in the current media condition being considered. The transcriptassociated penalty coefficients are then mapped to model reactions with geneprotein reaction relationships from the reconstruction () (e.g. g values are mapped to the elements of ' irr , a column vector of reaction penalty coefficients). 4. Determination of penalty bound Optimization is performed to minimize the total penalty. Minimize:Such that:Here, S irr is the stoichiometric matrix that has been converted to an irreversible format () with added turnover metabolites, v irr is the vector of reaction fluxes, a irr is a vector of lower bounds for the fluxes, b irr is a vector of upper bounds for the fluxes and c irr is the column vector of objective coefficients corresponding to the optimization in Step 1. Note that a irr will include lower bounds for the turnover sink reactions, which are taken to be 1.01 ", the solver tolerance. For clarity, a sample penalty calculation is shown in the table in. Once the best objective function value is determined, a constraint is implemented to require that the penalty maintained a value within some fraction, g, of the minimum value,  min. Because we took f to be 0.99 to remain within 1% of maximum growth, we took g to be 1.01 to remain within 1% of the minimum penalty. Network properties could then be explored while maintaining consistency with the omics data sources and the capacity to meet cellular objectives.
Conversion to mixed integer linear programWhen calculating the turnover flux of a metabolite participating in multiple reversible reactions, the flux of one reaction of each reversible pair should be constrained to 0. An example to illustrate the motivation for this requirement is provided in Supplementary. To ensure only one reaction of a reversible pair is used, integer (binary) variables can be incorporated into the model to represent the choice of the forward or reverse reaction for each pair. In this case, a mixed integer linear programming (MILP) problem must be solved. Once we have already established constraints on the penalty and objective function based on the best values, the optimization problem for any linear objective function of interest can be stated as: Optimize (minimize/maximize):Such that:With additional constraints for each reversible reaction pair k (of 1, 2,. .. , K):Here, m is the column vector of objective coefficients, r k is a binary variable that effectively enables just one reaction of forward and reverse reaction pair k, d is a K  2 matrix with rows that track the indices of the forward and reverse pairs in v irr and i forward (k) and i reverse (k) are functions to respectively map each of the K reaction pairs to the appropriate indices in v irr. As described in the Supplementary Data, a distinct formulation was required to implement the MILP in COBRApy ().
Preparation and integration of omics dataThe processed omics data used to inform the analysis are available with the GIM 3 E algorithm (see opencobra.sourceforge.net). Transcriptomics data from 25 microarrays for Salmonella Typhimurium were used (JCVI S.Typhimurium 13k v8 two-channel spotted oligonucleotide microarrays, see SysBEP.org for datalinks). The microarrays offered coverage of 499% of annotated genes (Supplementary) in our previously published genome-scale model of S.Typhimurium metabolism (). Intensities were extracted using the limma package for R from Bioconductor on individual channels (Smyth, 2005a, b), background-corrected with the normexp method (), normalized using the print-tip LOESS method and adjusted by quantile normalization between the channels and arrays. Median intensities were used for transcripts with multiple probes for the calculation of penalties in Equation (4). We used published GCMS metabolomics datasets for S.Typhimurium in log-phase growth in two conditions (), which we have previously described as 'rich' (Luria Burtani broth, LB) and 'virulence' (acidic minimal medium low in phosphate and magnesium, LPM) media. Virulence medium has been designed for the induction of genes critical for intracellular virulence, as observed in vivo (). We used Kyoto Encyclopedia of Genes and Genomes (KEGG) identifiers assigned to the detected metabolites to speed the matching with metabolites in our consensus reconstruction of S.Typhimurium metabolism (). One challenge in interpreting metabolomics data is the confounding factor of subcellular compartment localization. Unlike more complex eukaryotic organisms with greater compartmentalization, our reconstruction of S.Typhimurium metabolism contains a cytoplasmic and periplasmic space. Therefore, we preferentially paired our metabolomics data with metabolites in the larger more biosynthetically relevant cytoplasmic compartment. The cytoplasmic compartment is also potentially less permeable to the loss of metabolites by diffusive transport processes during sample washing and preparation. Future implementations of GIM 3 E to analyze more compartmentalized organisms could alter the implementation of turnover metabolites to couple each metabolite across compartments and ensure flux through the metabolite in at least one compartment.
Effects of penalty and metabolite constraintsImposition of model metabolite and penalty constraints each alters the allowed solution space. Therefore, three methods were used to characterize the solution space: a characterization of reaction and metabolite accessibility, requirement and relative flux range change. Accessibility was evaluated by testing whether the maximal flux for a given reaction (or metabolite) exceeded the numerical tolerance. Required reactions (and metabolites) were enumerated by constraining the flux for the reaction (or metabolite) of interest to zero and checking whether a solution, given the constraints on the objective (growth), penalty and turnover metabolite sink reactions, could still be found. We describe these reactions and metabolites as 'required' as opposed to 'essential' to emphasize that not only non-zero growth constraints but also a near optimal growth constraint and constraints based on omics data must be met. The relative flux range change was previously defined ():Here, x j indicates the relative flux range change for reaction j, r m,j indicates the width of the flux range for reaction j in condition m and c m,j indicates the center of the flux range for reaction j in condition m. Note that r m,j and c m,j are found by flux variability analysis (). A logical cutoff to use when interpreting the relative flux range change is jx j j41. We further characterized the importance of correct metabolite identification on the performance of the GIM 3 E algorithm by quantifying the ability to identify the required metabolites implicated by metabolomics-constrained models created in virulence medium with 'noisy' metabolomics data. Noisy metabolomics datasets were created by randomly selecting a subset of detected metabolites and replacing the selected metabolites with random accessible cellular metabolites. Five alternate noisy metabolomics datasets were created for each number of randomized metabolites to determine the average effect of metabolite misidentification. Alternately constrained models were then created for S.Typhimurium in virulence medium using constraints based on the objective and the noisy metabolomics data. The required cellular metabolites were then tested for each of the alternately constrained models. We then characterized which of the required metabolites agreed with the required metabolites determined with the true metabolomics constraints (true positives) and whether new requirements for metabolites with a non-zero flux were introduced (false positives). When scoring true and false positives, metabolites implicated as required by the model without omics constraints were filtered from the comparison.
RESULTS AND DISCUSSIONCondition-matched transcriptomic, proteomic and metabolomic data sources were available for S.Typhimurium. Multi-omics data (available from SysBEP.org) gathered in two alternate growth conditions, rich and virulence media (), therefore presented a good opportunity for algorithm validation. The model coverage of these alternate omics datasets is described in Supplementary Table S1. To elucidate the impact of additional constraints derived from omics data on the solution space, we performed a detailed analysis of four alternate models for each condition, using alternate constraints in GIM 3 E to customize our published genome-scale model of S.Typhimurium metabolism (). The eight resulting models are described in.
Constraints impact required reactions and metabolitesOne method of characterizing the effects of the constraints on the solution space is to enumerate reactions and metabolites that must necessarily carry a nonzero flux for the model to satisfy the constraints. The concept is similar to an analysis of essential genes, whereby an in silico knockout of a gene is evaluated for an impact on the capability for non-zero growth (). We investigated whether constraining a reaction or metabolite to be inactive (zero flux) resulted in the inability to find a solution that satisfied imposed constraints based on the objective (near optimal growth), as well as transcriptomics (penalty) and metabolomics (turnover metabolite sink reactions) data. To test the impact of the omics data on the required metabolites and reactions, we used four models based on alternate omics constraints: a model with no omics constraints (growth constraints only), a model with transcriptomics-based constraints, a model with metabolomics-based constraints and a model with both transcriptomics and metabolomics constraints. The number of required reactions and metabolites for each model are summarized in. We further contrast the effect of the constraints introduced by omics on the required reactions and metabolites in.Here, each panel contrasts the requirements for models constructed from the alternate omics constraints (metabolomics, transcriptomics or both), but not solely due to constraints on growth. For example, in, we show differences between the required metabolites for the three alternatively constrained models in rich media. If transcriptomics data are additionally included to constrain the model, there are nine additional required metabolites. If transcriptomics data are used, there are 27 required metabolites. If both transcriptomics and metabolomics data are used, there are 36 required metabolites. In, we show differences between the required metabolites for the three alternatively constrained models in virulence media. If metabolomics data are included to build and constrain the model, 29 more metabolites are required to be active, 20 of which were directly detected by metabolomics (green and blue circles). Alternatively, if transcriptomics data are included to constrain the model, 16 metabolites are required to be active (red and blue circles). Inclusion of both metabolomics and transcriptomics constraints results in the requirement for all 45 to be active (bottom, blue circle). In general, imposition of constraints based on metabolomics and transcriptomics data results in additional non-redundant constraints on the solution space. Another feature of GIM 3 E is that the addition of metabolomics-derived constraints effectively identifies additional metabolites required to provide flux to produce/consume the detected metabolites. For example, in virulence medium, both models created with metabolomics constraints require 29 cellular metabolites be produced/consumed that were not required by the model with transcriptomics but not metabolomics constraints (and Supplementary). However, only 20 of these metabolites were detected by metabolomics. As described in the Supplementary Data, we performed an enrichment analysis on model metabolites using pathways defined by KEGG. We first performed an enrichment analysis on the required metabolites identified only when using the metabolomics constraints (Supplementary). The most highly enriched pathway in rich medium was pantothenate and coenzyme A (CoA) metabolism (P  0.0463) and in virulence medium was pyrimidine metabolism (P  0.0533).Our results prompted us to explore the impact of omics datasets on the interpretation of pathway-level alterations in metabolism. In, we examine the impact of additional omics constraints on required reactions and metabolites, from no omics, to metabolomics, to metabolomics plus transcriptomics. Based on the pathways suggested by the enrichment analysis, we examined pyrimidine metabolism in virulence conditions (). The general importance of pyrimidine metabolism for S.Typhimurium virulence in vivo has been noted previously (). Addition of metabolomics to growth constraints suggested an additional reaction, cytosine deaminase, was necessarily active to facilitate the conversion of cytosine to uracil (inset). It has been shown that cytidine and uracil repress cytosine deaminase in S.Typhimurium (). However, the topology and directionality of the pyrimidine synthesis and salvage pathways for uracil () suggest cytosine deaminase should be expressed for uracil production. Therefore, the inclusion of constraints based on metabolomics ensures pathways are maintained in an active state that might not be suspected from known transcriptional regulatory interactions. We also observed that although only thymine was detected, flux through thymidine also became required with the imposition of metabolomics constraints (). When available, exogenous thymine can be directly incorporated for DNA synthesis during growth (). However, given thymine and thymidine are not available in virulence medium, the result suggests synthesized thymidine is degraded to thymine by thymidine phosphorylase. The metabolic versatility for thymine use may come with the cost of metabolic efficiency in the synthesis of DNA precursors. R-pantothenate (vitamin B 5 ) is an important nutrient in CoA synthesis, and S.Typhimurium strains deficient in pantothenate). In rich medium, on the imposition of metabolomics constraints, we observed an enrichment of required metabolites in pantothenate biosynthesis (Supplementary). Constraints on the objective (growth) alone required the conversion of Rpantothenate to CoA (). Cellular-alanine was detected by metabolomics, and the addition of metabolomics constraints required the biosynthesis of R-pantothenate and the conversion of L-asparate, 5-10-methylenetetrahydrofolate and 3-methyl-2oxobutanoate to R-pantothenate. The allowed solution space developed with metabolomics constraints suggests the biosynthetic pathway is active despite availability of pantothenate in the medium. The addition of transcriptomics constraints to the metabolomics constraints resulted in no new additional metabolite requirements for the pathways shown in. Therefore, we wished to further clarify the impact of transcriptomics constraints in addition to metabolomics. We performed the pathway enrichment analysis for metabolites required by metabolomics and transcriptomics constraints, but not required when omics constraints are absent (e.g., all metabolites in the blue circles inandD). Our results confirmed the importance of omics constraints in the interpretation of pantothenate biosynthesis in rich medium (Supplementary). However, the result for virulence conditions did not implicate pyrimidine metabolism with a similar level of significance. The set of metabolites connected by biochemical conversions implicated as required by metabolomics data in the pantothenate biosynthesis pathway () prompted us to investigate the connectivity of metabolites required by the omics datasets. Therefore, we checked for metabolites required by inclusion of metabolomics and also connected by reactions required by the inclusion of metabolomics data. Sets with at least two connected metabolites are shown in Supplementaryand B. In addition to the metabolites previously implicated in rich medium in pantothenate and CoA biosynthesis, the analysis uncovered a grouping of metabolites required for urocanate metabolism in virulence medium. We verified the effect of adding transcriptomics constraints in addition to the metabolomics constraints. Additional sets of connected metabolites were implicated (Supplementaryand D), including intermediates in fatty acid synthesis. Effects of alterations in growth conditions such as temperature, growth phase and medium on the fatty acid composition of bacterial membranes and LPS are well documented (). The result suggests a change in requirements from hexadecanoyl to shorter dodecanoyl intermediates on the change from rich to virulence medium. Furthermore, the addition of transcriptomics constraints implicated an additional required reaction set spanning the conversion of 3-phosphoglyceroyl-phosphate to O-phospho-L-serine. Given glycerol is the primary carbon source in virulence medium, the result may indicate a change in metabolism to facilitate the efficient synthesis of cysteine, which can be produced from serine (). The result is noteworthy because proteomics measurements have identified a protein s-thiolation switch from glutathione to cysteine when changing from rich to virulence medium (). The requirement that detected metabolites are used in valid model solutions is a new development in GIM 3 E. Therefore, we wanted to characterize the impact of metabolite misidentification, or noise in the metabolite identification process, on the required metabolites enumerated from the models created with GIM 3 E (Supplementary). Each identification error reduced the correct identification of true-positive required metabolites by 0.45 (unadjusted R 2 of 0.85 with all datapoints). Each identification error also increased the number falsely identified required metabolites by 1.72 (unadjusted R 2 of 0.776 with all datapoints).
Constraints impact reactions altered between rich and virulence gene-inducing conditionsWe also investigated the impact of alternate model constraints on reactions that were increased or decreased with respect to the relative flux range change, as shown in Equation (18) and discussed further in the Supplementary Data, when comparing cellular metabolism in virulence medium to rich medium. Essentially, the relative flux range change reports alterations in the allowed flux through a reaction between conditions. Models with constraints on the objective only (no omics constraints) exhibited the lowest number of reactions with an increased or decreased flux range, 236 of 1587 in. Integration of transcriptomics constraints shrank the solution space in each condition such that more reactions were necessarily altered in their flux range when comparing between the two conditions, 386 of 1587 reactions. The models created with the GIM 3 E algorithm can also be used to compute the turnover flux of metabolites, and the integration of transcriptomic constraints also had effects on the calculated turnover flux. The number of metabolites necessarily altered in their flux range increased, from 118 to 271 of 1397, when constraints calculated from transcriptomics data were included. Although the integration of metabolomics constraints had a demonstrated impact on the solution space by increasing the required reactions and metabolites, metabolomics constraints did not have a noticeable impact on the number of reactions or metabolites with an altered flux range. In the initial application of the GIM 3 E algorithm, the combined omics data helped elucidate a new possible avenue of host pathogen interaction by alterations in the flux of metabolites (). To summarize those results here, metabolic models of macrophages (), the host cells of S.Typhimurium, and experimental results have demonstrated that individual metabolites can have predicted stimulatory or inhibitory effects on antimicrobial functions such as nitric oxide production. The analysis of S.Typhimurium suggested that metabolites produced or consumed by this pathogen have direct effects on macrophage function through metabolic flux. These results highlight the importance of evaluating omics results in an integrated manner as possible with the GIM 3 E algorithm. Interestingly, another model-guided investigation of metabolism elucidated the ability of S.Typhimurium to exploit parallel nutrient sources to enhance virulence (). An important next step to interpret metabolic feedback will be the integrated model-guided analysis of omics datasets from both the host and pathogen.
CONCLUSIONThe GIM 3 E algorithm uses metabolomics and transcriptomics data to develop constraints for a GEM. GIM 3 E requires a cellular objective and condition-matched omics datasets, preferably transcriptomics data with good coverage of model genes and metabolomics data that may be qualitative or semi-quantitative in nature. In our previous investigation, we illustrated the utility of GIM 3 E to develop biological insights into the cellular metabolism of S.Typhimurium in both rich and virulence media (). Here, we also demonstrate that omics data integrated into the model with GIM 3 E also yields insight into metabolites and reactions that must be active to be in agreement with model constraints but that are not necessarily detected in the metabolomics experiments. Metabolomics and transcriptomics yielded distinct constraints on the solution space. The calculation of metabolite turnover is an additional benefit of using the GIM 3 E algorithm, and omics-derived constraints impacted the allowed metabolite turnover flux ranges.Model reactions that were not implicated in loops that could carry flux greater than the solver tolerance in at least one condition were included. bAll model cellular metabolites that were not implicated in loops were included.
The Author 2013. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
GIM 3 E at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
B.J.Schmidt et al. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
