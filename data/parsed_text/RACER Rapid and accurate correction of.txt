Motivation: High-throughput next-generation sequencing technologies enable increasingly fast and affordable sequencing of genomes and transcriptomes, with a broad range of applications. The quality of the sequencing data is crucial for all applications. A significant portion of the data produced contains errors, and ever more efficient error correction programs are needed. Results: We propose RACER (Rapid and Accurate Correction of Errors in Reads), a new software program for correcting errors in sequencing data. RACER has better error-correcting performance than existing programs, is faster and requires less memory. To support our claims, we performed extensive comparison with the existing leading programs on a variety of real datasets. Availability: RACER is freely available for non-commercial use at
INTRODUCTIONThe automated Sanger sequencing method () has revolutionized biological research by unveiling the sequence of the DNA molecule, most prominently that of the human genome. Limitations of the method created the need for improved sequencing technologies. Great demand caused the discovery of several so-called next-generation sequencing (NGS) technologies, such as Illumina/Solexa, Roche/454, Life/APG's SOLiD, Helicos BioSciences' HeliScope, Pacific Biosciences and Life's Ion Torrent; the survey of Metzker (2010) gives detailed descriptions. These high-throughput technologies produce huge amounts of data at decreasing costs, thus enabling an ever increasing number of applications, including de novo genome assembly, genome resequencing, cancer mutation discovery, metagenomics, DNAprotein interaction discovery and so forth. The way has been opened for ambitious projects, such as the 1000 Genomes Project (), the first project to sequence the genomes of a large number of people to provide a comprehensive resource on human genetic variation, and the Genome 10K Project (), aiming at discovering the genomes of 10 000 vertebrate species. A large number of bioinformatics programs are essential in analyzing the NGS data. Although their variety is impressive, they all need high-quality data. Nearly half of the reads produced by Illumina, the currently dominant technology, contain errors. Among other problems, they make genome assembly much more difficult, and genome assemblers, such as Euler-SR (), ALLPATHS (), ABySS (), SOAPdenovo () or SGA (), include their own correcting mechanisms. The importance of the problem led to the design of many stand-alone error-correcting programs, such as Euler (), SHREC (Schroder), Reptile (), Quake (), CUDA (), HSHREC (), SOAP (), HiTEC (), Coral (Salmela and SchroderSchroder, 2011), Hammer (), ECHO (), PSAEC () and MyHybrid (); see also the survey of. The errors present in sequencing data consist of substitutions, where the correct base has been replaced by an erroneous one, and indels, where new bases have been inserted or existing ones deleted. However, due to the domination of the Illumina technology, which produces mostly substitution errors, the majority of the existing programs focus on correcting this type of errors. For the same reason, the current version of our new program focuses as well on substitution errors. The main idea of all correcting programs is essentially the same. High-throughput technologies compensate for short read length by high coverage, which implies that each position in the genome is sequenced multiple times, many of which are correct. Therefore, the correct way will prevail in a careful analysis and the errors can be corrected. It is the way in which such an analysis is done that makes the difference between various programs. Some programs count the number of k-mers and those with counts above a given threshold are deemed correct, whereas the remaining ones undergo correction; these include SHREC, HiTEC, HSHREC and PSAEC. Others consider all k-mers occurring in each read, the k-spectrum (), and try to correct the entire read with minimum edit distance such that all k-mers have counts above a threshold; CUDA, Quake, Reptile and Hammer are included here. Finally, Coral, ECHO and MyHybrid are based on multiple sequence alignments. The reader is referred to the survey offor details. We propose a new program, RACER (Rapid and Accurate Correction of Errors in Reads), that belongs to the first category. Although SHREC and HSHREC use suffix trees and HiTEC uses the more efficient suffix arrays, RACER uses completely different, more efficient data structures. This way, whereas both SHREC and, to a lesser extent, HiTEC, have high space *To whom correspondence should be addressed. consumption, RACER is space efficient. It is also faster and more effective at correcting errors than the existing programs. We have performed extensive comparison with the leading programs on a variety of real datasets. RACER is freely available for non-commercial use at www.csd.uwo.ca/$ilie/RACER/.
RESULTS
DatasetsWe have performed extensive testing on a wide variety of datasets with difference read length, genome size and coverage. Comparison has been performed exclusively on real datasets because, in our experience, simulated datasets do not offer a good indication of real-life performance. In addition, they are easy to correct and the correcting programs often exhibit unrealistically high performance. Fifteen real datasets were considered, some of which have been previously used either for correcting purposes or assembly: Escherichia coli 36, E.coli 47 (the numbers following the name represent read length and are used to distinguish them), Staphylococcus aureus, Saccharomyces cerevisiae and Drosophila melanogaster have been used in the survey of, and Caenorhabditis elegans was used for comparing SGA with other genome assemblers by Simpson and Durbin (2012). The remaining datasets are new. The accession numbers and details of the datasets, together with the corresponding information concerning the reference genomes, are given in. Full organism names are provided in Supplementary Table S4.
EvaluationWe have compared RACER with the programs tested by, namely, HiTEC, SHREC, Reptile, Quake, Coral, SOAP and ECHO. (We have tested SHREC instead of HSHREC, as we consider only substitution errors.) Of these, SOAP and ECHO were unable to run most of the datasets because of high space or time requirements and are left out of the comparison. All programs tested were evaluated on the raw datasets infor their ability to correct errors as well as the time and space required. Error-correcting performance was evaluated as the percentage of errors corrected. Our evaluation method has the advantage of avoiding the interference of mapping or assembling programs and is described in detail in Section 3.2 of Methods. To have a uniform comparison, we have normalized the time and space values by dividing them by the total number of base pairs in the dataset. The actual time and space values are given in the Supplementary Material. We have run all programs on the same HewlettPackard computer with 24 cores AMD Opteron at 2.1 GHz and 98 GB of random access memory running Linux Red Hat, CentOS 5.5 m. Because HiTEC and Reptile do not run in parallel, we performed the testing in both serial and parallel modes, to include all programs in the comparison. We have used 24 cores in parallel mode. The results are presented in, which contains the error-correcting performance in the top part in percentage of errors corrected, the time in the middle part in seconds per megabyte of input base pairs and space in the bottom part in megabytes required per megabyte of input base pairs. Some programs could not run all datasets and the reasons are indicated by letters explained in the caption of the table. The last row in each part represents the average of the entries for those datasets for which all programs could run. To improve the visualization of the tables, we have used color intensities with darker color representing better performance.Note: All datasets and reference genome sequences are obtained from National Center for Biotechnology Information except C.elegans from www.wormbase.org and D.melanogaster from flybase.org.
ComparisonAs far as error-correcting performance is concerned, only HiTEC comes close to RACER. However, HiTEC requires the second highest space and, therefore, cannot run the largest datasets. For D.melanogaster, HiTEC did not attempt to run it because of different read lengths. Note also HiTEC's poor performance on some of the datasets that were not included in the average. Direct comparison shows a significant difference. Concerning time, RACER was the fastest in both serial and parallel modes, twice faster than second-placed Quake in serial and about one order of magnitude faster than all the others in parallel mode. RACER is also more memory efficient than the other programs. Quake is again second best and uses 450% more space than RACER in parallel mode. RACER and Reptile were the only programs able to run all datasets. Quake came second in time and space, except serial space where it is third, but its error-correcting performance was second last in serial and last in parallel, about half of the performance of RACER. This is in part because Quake trims reads when unable to correct. The evaluation counts the number of base pairs in all correct reads. Reptile came third in time and second in space (serial mode) but its accuracy was last. SHREC required clearly the highest space and for that reason it was able to run the fewest datasets on our machine. On the other hand, it came consistently in third place for correcting performance. Coral was the slowest in serial mode but had the best speedup among all programs, and its parallel performance was close to that of Quake and SHREC. The 15 speedup came at the cost of increasing the space 12 times. RACER's speedup was 11 with a small increase in space.
METHODS
RACERRACER belongs to the class of k-mer counting programs. It uses 2-bit encoding of nucleotides and random replacement of the unknown positions. Each k-mer is represented as a 64-bit integer. The k-mers are stored in a hash table. For each k-mer, eight counters, corresponding to the eight possible nucleotides on both sides, are computed. A threshold t is used to distinguish correct from erroneous positions. A k-mer followed by a nucleotide a is assumed correct if the count is higher than t and erroneous otherwise. In the latter case, assuming there is exactly one letter b that follows the same k-mer and has count higher than t, a is replaced by b. The approximate size of the sequenced genome is required as input, from which RACER automatically computes the k-mer size k and threshold t used in the correction part. The combination of parameters used has been experimentally determined. Like HiTEC, the thresholds are varied to achieve higher correcting performance. A significant space advantage over SHREC and HiTEC is given by the avoidance of full text indexes, such as suffix trees and suffix arrays. The same reason creates a speed advantage because the k-mers and counters, once computed, can be used multiple times for correction. RACER corrects reads of varying length, from both fasta and fastq data. It has been implemented in C and OpenMP and no other software is necessary to run it.
Evaluation detailsTo obtain the most accurate evaluation, we have avoided the use of mapping programs or performance of corrected data for other applications, such as genome assembly. Mapping programs are used for evaluation to know where the errors are and how they should be corrected. However, many reads cannot be mapped uniquely and even more cannot be mapped at all. Such reads are discarded and, therefore, the obtained datasets are significantly different from the original. In particular, all programs have artificially increased performance because the reads that are the most difficult to correct have been eliminated by mapping. On the other hand, genome assemblers have their own implicit or explicit correction procedure, and the interaction between the two correction methods cannot be predicted. Reads are classified as correct or erroneous depending on whether they can be found or not, respectively, in the reference genome by an exact search algorithm. Denoting the number of base pairs in erroneous reads before and after correction by e b and e a , respectively, the error-correcting2. Comparison of the error correction programs on the datasets in, in serial and parallel (24 cores) modes, with respect to errorcorrecting performance, time and space usage(2013). By considering whole-read correction, as explained above, instead of individual-based correction, similar performance is expected; however, the problems associated with read mapping are avoided. Nevertheless, because in some articles the comparison is performed on mapped datasets, we provide, for completeness, such a comparison in the Supplementary Material where the datasets have been mapped using BWA () with high error rate, so that a high number of reads are kept and bias is minimized. The comparison on the mapped datasets is similar with the one on the raw datasets except that, as expected, the percentage of errors corrected increases. All programs have been run according to the instructions given by the authors in the corresponding articles, Web sites or readme files. We have not tuned the parameters of any of the programs to improve performance, as this would be unrealistic. The commands used to run all programs are given in the Supplementary Material.
DISCUSSIONExtensive testing shows that RACER is superior to the existing programs in all aspects: error-correcting performance, time and space. It corrects about three-quarters of the errors in52 min for a bacterial dataset and 3040 min for a larger organism such as a worm or fly. RACER does not require any additional software to run.
CONCLUSIONWe have presented a new tool, RACER, for correcting errors in NGS data. The current version of RACER targets Illumina data, thus correcting substitution error. Future versions will be able to handle indel errors to enable correction of data from other sequencing platforms as well as mixed data.
The Author 2013. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
RACER at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
L.Ilie and M.Molnar at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
