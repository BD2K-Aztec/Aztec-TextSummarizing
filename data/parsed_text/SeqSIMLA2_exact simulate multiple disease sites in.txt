It is difficult for current simulation tools to simulate sequence data in a pre-specified pedigree structure and pre-specified affection status. Previously, we developed a flexible tool, SeqSIMLA2, for simulating sequence data in either unrelated case-control or family samples with different disease and quantitative trait models. Here we extended the tool to efficiently simulate sequences with multiple disease sites in large pedigrees with a given disease status for each pedigree member, assuming that the disease prevalence is low. Availability and implementation: SeqSIMLA2_exact is implemented with Cþþ and is available at
IntroductionFamily studies based on next-generation sequencing (NGS) have become important in complex disease studies because a sufficient number of rare alleles that co-segregate with the disease can be observed in pedigrees (). To evaluate the statistical power for family-based disease studies using NGS, it is necessary to simulate sequencing data in a given family structure with disease status. Moreover, as multiple variants can contribute to the disease, it is crucial to simulate the joint effects of multiple variants on the disease. We searched the Genetic Simulation Resources website (), which provides a comprehensive catalog of simulation tools for genetics studies, and identified four tools, ForSIM (), Nemo (), simuPOP () and SeqSIMLA2 (), that can simulate sequence data in families with affection status. ForSIM, Nemo and simuPOP use forward-time algorithms, which dynamically determine pedigree structures during the simulation. Therefore, it may not be easy to obtain pre-specified pedigree structures from the simulation results. SeqSIMLA2 uses a genedropping algorithm to easily simulate pedigrees with pre-specified structures. However, it is very time consuming for the genedropping algorithm to simulate exactly the same affection status as the pre-specified status for every family member, particularly in large pedigrees and diseases with low prevalence. Another simulation tool, SimRare (), which shares some properties with SeqSIMLA2, can simulate multiple disease loci in sequence data; however, SimRare only simulates unrelated case-control data. In order to efficiently simulate genotypes conditional on the family structure and disease status, a retrospective likelihood, which is the probability of observing genotypes in each family member given the disease status, needs to be calculated. However, calculating the retrospective likelihood is typically based on computationally intensive algorithms such as ElstonStewart () and Markov Chain Monte Carlo (MCMC) algorithms. For example, tools such as FastSLINK (), SUP (), SimWalk2 () and MORGAN () have implemented or extended one of the aforementioned algorithms for simulating genotypes given the trait data. Due to the computational complexity, these tools can simulate only one disease locus. Moreover, although multiple markers not associated with the disease locus can be simulated, SimWalk2 and MORGAN assumeHere we extended SeqSIMLA2 to SeqSIMLA2_exact for simulating sequence data given the pedigree structures and disease status for all family members. When the disease prevalence is low, we show that the retrospective probability can be efficiently approximated without using computationally intensive algorithms.
MethodsFor a pedigree with n members, assume x  x 1 ; :::; x n  is a vector of disease phenotypes and h  h 1 ; :::; h n is a vector of haplotype pairs at the disease loci for the n individuals. Assume c  c 1 ; :::; c s  is a vector of recombination rates at s recombination hotspots within the haplotype region. Family members without parents are referred to as founders, while family members with parents in the pedigree structure are referred to as non-founders. Assume h f is a subset of h that contains haplotype pairs of founders and h nf is the complement of h f containing haplotype pairs of non-founders. The probability of h can be calculated asFirst we calculate Ph f jx; c. Assume (h 1 ,. .. h i-1 ) is a subset of haplotypes in h f that have been simulated. As shown in the Appendix A, assuming no inbreeding and random mating, the probability for h i at founder i is calculated asThe denominator is the sum of the numerators over all possible haplotypes of individual i. The probability Ph i ; x i ; c is further derived as Px i j h i ; cPh i ; c, which can be easily calculated based on the penetrance functions and disease haplotype frequencies. Calculating the probability Px i1 ; :::; x n jc; h 1 ; :::; h i ; x 1 ; :::; x i  in Eq.(2) requires the consideration of affection status for family members who have not been simulated, given the haplotypes and affection status for family members who have been simulated. This process can be time consuming for a large pedigree. To efficiently calculate the probability, we only consider the affection status for family members in the same nuclear family as individual i. It is also commonly assumed that given a person's haplotypes, the person's affection status is independent of any other person's haplotypes (). Moreover, conditional on parental haplotypes, siblings' haplotypes are independent. Based on these assumptions, the probability is written aswhere individuals i  1 through k are in the same nuclear family as individual i, and X is a set of all possible haplotypes of individuals i  1 through k given the haplotypes for family members that have been simulated. Note that we assume that the haplotypes and affection status for the family members who have been simulated (i.e. individuals 1 to i) are independent of the affection status of other family members who are not in the same nuclear families as individuals 1 to i. Our simulation results in the Results section suggest that this assumption holds for diseases with low prevalence. Next we calculate Ph nf jh f ; x; cin Eq. (1). If h j is the haplotype pair at non-founder j and (h m ,. .. h j-1 ) is a subset of haplotypes in h nf that have been simulated, the probability of haplotype pair h j at non-founder j can be calculated asAfter the disease haplotypes have been simulated for all members, the sequences for the members can also be efficiently simulated using the original SeqSIMLA algorithm (). To be more specific, SeqSIMLA requires a population of sequences (i.e. haplotypes) in an external file. As previously described in (), these sequences can be generated by several simulation tools such as HAPGEN2 () and COSI (). In general, a population of 10 000 sequences is required for SeqSIMLA. Each sequence then has an index, which ranges from 1 to 10 000. After reading the external sequences, SeqSIMLA extracts the haplotypes at the disease sites selected by the user. The haplotype frequencies and haplotype pair frequencies are calculated based on the external sequences. When a haplotype pair h i in founder i is determined based on Eq. (2), two haplotypes in the external haplotypes which are consistent with h i are randomly selected. The indices for the two randomly selected haplotypes are assigned to individual i. When a haplotype pair h j in non-founder j is determined based on Eq. (4), the inheritance vectors, including the crossover events, are assigned to individual j. Finally, after all members in a pedigree have been simulated, their sequences can subsequently be simulated rapidly based on the founders' sequence indices, non-founders' inheritance vectors and the external sequences. We used simulation studies to evaluate the performance of the algorithm. Different simulation scenarios with parameters of minor allele frequencies (MAFs) and odds ratios for the disease sites, disease prevalence and family structures were used. We selected three common variants with MAFs of 0.03, 0.05 and 0.13 as the disease sites. We also selected three rare variants with MAFs of 0.005, 0.007 and 0.009 as another set of disease sites. A penetrance model was used based on the following logistic penetrance function in SeqSIMLA2: logitPaffected  b 0  X u i1 b i x i , where b 0 is determined by the disease prevalence, and b i and x i are the log odds ratio and genotype coding, respectively, for disease site i in the u disease sites. We specified the odds ratios of 1, 2 and 3 for the three common variants and higher odds ratios of 1, 5 and 8 for the three rare variants with different disease prevalences (i.e. 0.5%, 1%, 3%, 5% and 10%). Three types of family structures, shown in, representing small, medium and large pedigrees were used. We evaluated the performance of SeqSIMLA2_exact based on whether the 95% confidence intervals for the estimated odds ratios for the disease sites in a simulated replicate contained the true parameters specified. UNPHASED () was used to estimate the odds ratios and their 95% confidence intervals for each of the simulated replicates. For each replicate, 10 000 families were simulated unless otherwise specified. Fewer pedigrees were simulated for some scenarios when analyzing 10 000 pedigrees in UNPHASED was prohibitively time-consuming. A retrospective likelihood, which was the probability of observing the genotypes in parents and their children given the affection status for the children in each nuclear family, was derived in UNPHASED. The effect sizes for the disease sites were obtained from the maximum likelihood estimates based on the likelihood function. A large pedigree is split into independent nuclear families for the inference of likelihood in UNPHASED. When multiple disease sites were simulated in our simulation studies, UNPHASED was used to estimate the odds ratios of haplotypes at the disease sites. The odds ratio for a disease site was obtained from the odds ratio for the haplotype with the disease allele at the disease site, while alleles at other disease sites were the non-disease alleles in the haplotype.shows the estimates of odds ratios for the three common variants with different prevalences for the medium pedigree structure. The 95% confidence intervals generally included the true odds ratios when the disease prevalence was less than 5% or when the specified odds ratio was 1, but the estimates of odds ratios can be smaller than the true values when the disease prevalence was above 5% and the true values were not 1 (i.e. values marked in bold in). This reflects the fact that the approximation of Eq. (3) within nuclear families may not be correct when the disease prevalence is high.shows the estimates of odds ratios for the three common variants with different pedigree structures when the prevalence is 1%. All the 95% confidence intervals included the true oddsSimulating exact disease status in large pedigreesratios with different pedigree structures, suggesting that pedigree size does not bias the estimates.shows the estimates of odds ratios for the three rare variants with the medium pedigree structure at the disease prevalence of 1%. Again, the 95% confidence intervals all included the true values. We also selected a mixture of five rare and common variants with disease prevalence of 1%, and found that with the exception of one case (values marked in bold), the 95% confidence intervals included the true values ().shows the run time of SeqSIMLA2_exact when simulating different numbers of disease sites in 2223 variants in 100 pedigrees with different structures, where s (i.e. the number of recombination hotspots within the haplotype region for disease sites) was fixed at 2. The run time was evaluated on a Linux server with Xeon 2.0 GHz CPUs and 96 GB of memory. The results showed that simulating 5 disease sites in 100 small or medium pedigrees can be completed in 15 s. Moreover, simulating a challenging scenario of 6900 individuals in 100 large pedigrees with exactly the same disease status for each individual as specified can be completed in 14 minutes. However, increasing the number of disease sites significantly increased the run time.shows the run time of SeqSIMLA2_exact when simulating 10 disease sites in 2223 variants in 100 medium pedigrees with different values of s. Similar to the number of disease sites, increasing s also significantly increased the run time.
Results
DiscussionAn efficient algorithm to simulate sequence data given the family structure and affection status for every family member was developed and implemented. Our simulation results suggested that the tool properly simulated multiple disease variants with the desired odds ratios when the disease prevalence was less than 5%, which is the case for many complex diseases, such as schizophrenia, autism and age-related macular degeneration that have prevalences of 1.1%, 1.4% and 1.5% in Caucasians, respectively. As shown inand, the run time for SeqSIMLA2_ exact increased exponentially with either the number of disease loci or the number of recombination hotspots. This can be attributed to calculating the probabilities in Eqs. (3) and (4), which requires enumeration of all possible haplotypes for individuals who have not been simulated under all possible recombination patterns, and the number of possible haplotypes and the number of recombination patterns increase exponentially with the number of disease sites and recombination hotspots, respectively. However, these calculations are only required in the first batch of the simulations. The results can subsequently be saved in memory and used in the following batches of simulations. In our simulations, a logistic penetrance function was used to simulate multiple independent disease loci with additive effects on the disease. However, different disease models can also be simulated using SeqSIMLA2_exact. A penetrance table with penetrance functions for all possible combinations of genotypes at the disease sites can be provided to SeqSIMLA2_exact. These penetrance functions can be specified based on any type of disease model, including the incorporation of interacting loci. Moreover, different directions of effects of the disease loci can be simulated using the logistic penetrance function or the penetrance table. For example, specifying positive and negative values for the log odds ratios in the logistic penetrance function can simulate the risk and protective effects of the disease loci, respectively.At present, SeqSIMLA2_exact assumes that the affection statuses for all family members are given. To account for missing phenotypes, the probability in Eq. (1) can be extended to Ph; x u jx; c, where x u is a vector of the affection statuses of individuals whose affection statuses were not given. We hope to implement this function in SeqSIMLA2_exact in the near future. In conclusion, SeqSIMLA2_exact will be useful to simulate sequence data with multiple disease sites in large pedigrees when the disease prevalence is low. SeqSIMLA2_exact is implemented in SeqSIMLA2 with the-exact option, which is available from http:// seqsimla.sourceforge.net.persons' haplotypes such as h i (), each term in Eq. (A6) except the last term can be written as
Funding
at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
P.-J.Yao and R.-H.Chung at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
