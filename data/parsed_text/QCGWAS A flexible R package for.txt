QCGWAS is an R package that automates the quality control of genome-wide association result files. Its main purpose is to facilitate the quality control of a large number of such files before meta-analysis. Alternatively, it can be used by individual cohorts to check their own result files. QCGWAS is flexible and has a wide range of options, allowing rapid generation of high-quality input files for meta-analysis of genome-wide association studies. Availability: http://cran.r-project.org/web/packages/QCGWAS
INTRODUCTIONThe number of consortia aiming to identify genes for complex traits through meta-analysis of genome-wide association studies (GWAS) has mushroomed in the past 6 years. The advantage of this strategy is that large sample sizes can be reached, allowing detection of genetic variants with small effects. A downside is the lack of unified quality control (QC) on the GWAS analyses of the individual cohorts, as each cohort will typically perform their own analysis according to a standard analysis plan and share only summary statistics. GWAS result files are prone to errors due to the vast amount of data they contain and the different manner in which these data are generated by individual cohorts. Before combining data from individual studies in a metaanalysis, it is important to ensure that all data included are valid, of high quality and compatible between cohorts to reduce both the false-positive and the false-negative findings (). Because GWAS result files usually contain a standard set of variables, it is feasible to automate the QC of these files, thereby gaining speed, reliability, flexibility and the possibility to perform more elaborate checks. To our knowledge, the only other software package currently available for QC of GWAS result files is GWAtoolbox (). However, GWAtoolbox does not produce cleaned results files, is less flexible regarding file format and uses a restrictive format for the QC log. This makes it less suited for processing (and comparing) large numbers of files in preparation of a meta-analysis. It also does not check allele information or allow for the retesting of individual QC steps. To address these shortcomings, we developed QCGWAS with the aim to automate QC and allow rapid generation of high-quality input files for GWAS meta-analyses.
APPROACH
ImplementationQCGWAS is built as a package for R (R Development Core Team, 2012). The R platform was chosen because it is operating systemindependent, commonly used, open source, can handle large datasets and is flexible regarding input file format. QCGWAS requires R version 3.0.1 or later (64-bit recommended) and can be downloaded from the Comprehensive R Archive Network Web site (http://cran.r-project.org).
UsageThe main QC by QCGWAS is executed by the QC_series(.. .) command. This function requires a minimum of two parameters: a list of filenames of GWAS result files and a translation table for the file headers. All other parameters are optional, allowing for a flexible and user-customized QC.
ApproachA standard QC consists of six steps ():STAGE 1: a GWAS result file is inspected for missing and invalid data. Duplicated single nucleotide polymorphisms (SNPs) and SNPs lacking crucial variables are removed. STAGE 2: alleles and strand information are checked and fixed by matching it to a given reference (e.g. HapMap). The SNPs can be removed when their alleles or allele frequencies do not match the reference. This harmonizes the alleles across result files. Next, it correlates the reported allele frequencies for all SNPs to those from the reference set and generates scatter plots to show deviations (Supplementary). STAGE 3: QC plots are generated (see SupplementaryS4). These include histograms of the distribution of SNP quality parameters (allele frequencies, Hardy-Weinberg equilibrium P-values, call rates and imputation quality), a Manhattan plot and a series of Quantile-Quantile (QQ) plots filtered for SNP quality. STAGE 4: various QC statistics are calculated, of which the most important are the genomic-control lambda to check for population stratification *To whom correspondence should be addressed.(), Visscher's statistic () to determine whether the standard errors are in line with the sample size reported, the skewness and kurtosis of the effect-size distribution and the correlation between the reported P-values and those calculated from the effect size and standard error. STAGE 5: the cleaned GWAS result file is saved and extensive QC information is written to a log file. The cleaned file can be saved in different formats, ensuring compatibility for immediate meta-analysis by GWAMA (Magi), META (), MetABEL (), METAL () or PLINK (). STAGE 6: several between-study checks are performed, including a comparison of skewness and kurtosis, of sample sizes and standard errors and of effect-size range to identify incorrect units and/or trait transformations (Supplementary). A checklist of QC statistics is also created. Each of the steps of the QC can be enabled or disabled by the user, allowing for a flexible QC pipeline, and quick retests of particular steps. Finally, independent functions are provided for the creation of histograms or QQ plots using combinations of filter parameters and regional association plots.
PerformanceOn a Windows 7 computer with 2.4 GHz and 48 GB RAM, a QC of a HapMap-imputed GWAS result file (2.5 million SNPs) takes between 5 and 15 min/file. Memory usage is between 2 and 3 GB, depending on the number of graphs to be created. Sequence-imputed results files, such as 1000 Genomes-based data (The 1000 Genomes Project Consortium, 2012) take 40 min and 20 GB of RAM.
CONCLUSIONQCGWAS is a flexible and comprehensive package for automated QC of GWAS result files. It can handle a large number of files within reasonable time and is therefore particularly useful for a centralized QC preceding a GWAS meta-analysis. It can also be used by individual cohorts to inspect the quality of their results. Currently it is geared toward quantitative traits, but case-control results can also be used with proper transformations. Future versions of the package are under development to accommodate nonSNP variants, such as used in sequence-based GWAS data.
The Author 2014. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
P.J.van der Most et al. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
