Accurate tertiary structures are very important for the functional study of non-coding RNA molecules. However, predicting RNA tertiary structures is extremely challenging, because of a large conformation space to be explored and lack of an accurate scoring function differentiating the native structure from decoys. The fragment-based conformation sampling method (e.g. FARNA) bears shortcomings that the limited size of a fragment library makes it infeasible to represent all possible conformations well. A recent dynamic Bayesian network method, BARNACLE, overcomes the issue of fragment assembly. In addition, neither of these methods makes use of sequence information in sampling conformations. Here, we present a new probabilistic graphical model, conditional random fields (CRFs), to model RNA sequence–structure relationship, which enables us to accurately estimate the probability of an RNA conformation from sequence. Coupled with a novel tree-guided sampling scheme, our CRF model is then applied to RNA conformation sampling. Experimental results show that our CRF method can model RNA sequence–structure relationship well and sequence information is important for conformation sampling. Our method, named as TreeFolder, generates a much higher percentage of native-like decoys than FARNA and BARNACLE, although we use the same simple energy function as BARNACLE.
INTRODUCTIONRNA has become an important research subject in recent years, and there is an increasing study of non-coding RNA in biology and health. Its growing important role appears in various life domains and processes, including regulating gene expression (), interaction with other ligands () and stabilizing itself (). To elucidate the function of an RNA molecule, it is essential to determine its 3D structure. However, there are a great number of RNA sequences without solved structures. Experimental methods for RNA 3D structure determination are time-consuming, expensive and sometimes technically challenging. By far, there are 29 million RNA molecules with (predicted) secondary structure in the Rfam database (), but only 4816 of them have tertiary structures in the nucleotide database (). Therefore, we have to fill this large gap by predicting the 3D structure of an RNA using computational methods. * To whom correspondence should be addressed.RNA tertiary structure prediction does not gain as much attention as secondary structure prediction (; Eddy and). Both molecular dynamic methods () and knowledge-based statistical methods () have been proposed to fold RNA molecules. The knowledge-based statistical methods for RNA tertiary structure prediction consist of two major components: an algorithm for conformation sampling and an energy function for differentiating the native structure from decoys. Fragment assembly, a knowledge-based method widely used for protein structure prediction (), has been implemented in FARNA () for RNA 3D structure prediction. However, this method has a couple of limitations: (i) there is no guarantee that any region of an RNA structure can be accurately covered by structure fragments in the RNA solved structure database, which currently contains only a limited number of non-redundant solved RNA structures; and (ii) sequence information is not employed in FARNA for conformation sampling. MC-Sym () is a motif assembly method for RNA 3D structure prediction, which uses a library of nucleotides cyclic motifs (NCM) to construct an RNA structure. MC-Sym has a time complexity exponential with respect to RNA length (i.e. the number of nucleotides), so MC-Sym may not be used to predict the tertiary structure for a very large RNA. As reported in, MC-Sym also fails in the case when the secondary structure of RNA lacks cyclic motifs. Recently,have proposed a probabilistic model (BARNACLE) of RNA conformation space. BARNACLE uses a dynamic Bayesian network (DBN) to model RNA structures, but this DBN method does not take into consideration any sequence information. In addition, BARNACLE models the interdependency between the local conformations of only two adjacent nucleotides, but not of more nucleotides. Other RNA three dimensional structure prediction methods can be found in; Das and Baker (2007);;;;;. This article presents a novel probabilistic method conditional random fields (CRFs) () to model RNA sequencestructure relationship. Different from BARNACLE
Conditional random fields for RNA conformation samplingmodeling only RNA structures, our CRF method models the sophisticated relationship among primary sequence, secondary structure and 3D structure, which enables us to more accurately estimate the probability of RNA conformations from its primary sequence and thus sample RNA conformations more efficiently. We have already successfully applied CRF to model protein sequencestructure relationship and conformation sampling (). However, our CRF method for proteins cannot be directly applied to RNA. In order to apply CRF to RNA modeling, we have to employ a different method to represent an RNA 3D structure and model RNA bond torsion angles. We also have to face the challenge that there are a lot fewer solved RNA structures than the solved protein structures for CRF model training. By exploiting the secondary structure information of an RNA molecule, we have also developed a novel tree-based sampling scheme that can simultaneously sample conformations for two segments far away from each other along the RNA sequence. In contrast, our protein conformation sampling method can sample conformations for only one short segment at a given time. Finally, we also have to employ a totally different energy function for RNA folding. To the best of our knowledge, CRF has also been applied to RNA secondary structure prediction () and alignment (), but not modeling the relationship between RNA sequence and 3D structure. Our method TreeFolder is more effective in sampling nativelike decoys than FARNA and BARNACLE, although we use the same simple energy function as BARNACLE, which contains only base-pairing information. Tested on 11 RNA molecules, TreeFolder obtains much better decoys for most of them. Our results imply that TreeFolder models RNA sequencestructure relationship well, which it is feasible to sample RNA conformations without using fragments and that sequence information is important for RNA conformation sampling. Experiments also show that TreeFolder works well with predicted secondary structures generated by tools such as CONTRAfold ().
METHODS
Representation of an RNA structure and conformation stateWe can represent an RNA 3D structure using a sequence of torsion angles, as shown in. Every nucleotide has in total seven bonds that rotate freely. Six of them lie on the backbone: PO5 , O5 C5 , C5 C4 , C4 C3 , C3 O3 and O3 P. The seventh bond connects a base to atom C1. As shown intorsion  around the seventh bond has a small variance, so we assume that it is independent of the other angles and has a normal distribution. The planar angles between two adjacent bonds on the backbone are almost constants, so are the lengths of the bonds. We use a simplified representation so that we can reduce the number of torsion angles needed for the local conformation of a nucleotide (). In particular, we use the torsions  1 and  2 on pseudo-bonds PC4 and C4 P (see pink lines in). However, to determine coordinates of the six backbone atoms of a nucleotide, we also need two planar angles ,  and another torsion  on bond PO5. Overall, we use a five tuple ( 1 , 2 ,,,) to represent the local conformation of a nucleotide. The torsion angles are separated in several groups in the whole angle space, as shown in. Although there are many different methods to represent an RNA conformation, this simplified representation enables us to rapidly rebuild backbone atoms from angles. Similar representations have also been). Our simplified representation does not lose much accuracy: given the torsion angles, we can rebuild the atom coordinates of an RNA molecule with very good accuracy. As shown in, the structures rebuilt from the native angle values (assuming the bond lengths are constants) have RMSD <1  from their natives. Conformation state: we use a Gaussian distribution to describe the local conformation preference of one nucleotide. First, we cluster all the angles collected from the experimental structures into dozens of groups (20100). Then, we calculate the mean and variance in each group and model the angle distribution, using Gaussian distribution. Each group (or cluster) and its Gaussian distribution are identified by an index, which is also denoted as a conformation state. Given the conformation state of a nucleotide, we can sample its real-valued angles from the corresponding distribution. Note that to make angle sampling easy and fast, we assume the torsion angles are independent of one another in Gaussian distribution. Later we will show how to empirically determine the best number of conformation states to achieve the best sampling performance.
Z.Wang and J.Xu
CRF model for RNA sequencestructure relationshipOur CRF method can estimate the probability of an RNA conformation from the primary sequence and secondary structure. A CRF model consists of two major components: input features and output labels. The input features at each nucleotide include its nucleotide types, base pairing states and its neighbor nucleotide types. The input features are encoded as a vector of binary variables. The base pairing states can be predicted using some secondary structure prediction programs (;;; Knudsen and Hein, 2003;) with reasonable accuracy. The base pairing information can also be obtained using some experimental methods (), which are much less expensive than those methods determining RNA tertiary structures. The output label at each nucleotide is a conformation state (also called label in CRF). It is also the index of the cluster which the angles at this nucleotide belongs to. In contrast to BARNACLE () estimating the generative probability of an RNA structure, our CRF model estimates the conditional probability of an RNA structure, represented as a conformation state vector y, from the input feature vector x as follows.Meanwhile, Z(x) is the partition function; x i is the feature vector at position i; y i is the label at position i; W i,j is the weight for transition from state ij; V i is the weight factor for predicting state i from an input feature x; L isshows a linear-chain CRF model for the sequencestructure relationship of an artificial RNA with five nucleotides. We also extend  to a linear combination of features of the adjacent nucleotides in a sliding window. That is,  is a linear function ofxof ofx i =[x iWL/2 x i+WL/2 ], WL is the window size to be determined later. Once the CRF model is trained, we can calculate the (marginal) probability of a conformation state at a given position, using the forwardbackward algorithm as follows.We train our CRF model by maximizing the occurring probability of a set of training RNAs with solved structures. In order to avoid overfitting, we also enforce regularization on the model parameters. As such, we train the model parameters by maximizing the following regularized log-likelihood.Meanwhile, y k and x k are the conformation state vector and input feature vector of the k-th training RNA, W and V are model parameters defined in Equation (1) and  and  are the regularization factors. This maximization problem can be solved to optimal using the L-BFGS algorithm (). We also extend the first-order CRF model to the second-order model so that we can capture dependency among three adjacent nucleotides. As in, two adjacent positions are combined to a single super node. All the algorithms for the first-order CRF model can be easily extended to the second-order model.
i104
Conditional random fields for RNA conformation sampling
A tree-guided conformation sampling algorithmOnce the CRF model is trained, we can use it to sample conformations for a segment in an RNA molecule. By combining this segment conformation sampling algorithm with a tree representation of the RNA base pairing information, we can have a tree-guided conformation sampling scheme, which enables us to sample conformations for two segments far away from each other along the sequence. Building a guide tree for conformation sampling: the guide tree represents the base pairing information in an RNA, which can be predicted using a secondary structure prediction method or determined by experimental methods. In the case of pseudo-knots, we remove the minimal number of base pairings so that a tree can be built. Since the pseudo-knots do not occur frequently, removal of a small number of base pairings does not impact our method. Note that all the base pairings are taken into consideration in calculating the energy of a sampled conformation. Therefore, removal of some base pairs in tree construction will not impact the formation of pseudoknots, since we also use energy function to guide the folding simulation. Given the base pairing information, we build a guide tree as follows. The root node in the tree corresponds to the whole RNA. Given a base pair (i, j), we have one node in the tree corresponding to the segment between i and j. One node A is the child of the other node B if and only if the segment corresponding to B is the minimal segment containing the segment corresponding to A. In case that one node has more than two child nodes, we can always add some intermediate nodes so that any node has at most two child nodes. For example, supposing node B, corresponding to segment (i,We can add an intermediate node C for segment (i 1 , j 2 ) so that C becomes the parent node of A 1 and A 2 and B has only two child nodes A 3 and C. Segment conformation sampling algorithm: This sampling algorithm consists of two steps: sampling a label for each nucleotide, in the segment, by the probability calculated from the CRF model and sampling realvalued angles from Gaussian distribution corresponding to a label. We use a forwardbackward algorithm to sample the label sequence of a segment from position i to j. The algorithm iteratively draws a conformation label of the last position from the conditional probability as follows.Meanwhile, Z(x) is the partition function and can be calculated using the forwardbackward algorithm. After the conformation state at position j is sampled, the algorithm replaces j by j 1 and repeats the sampling process until position i is sampled. Once the labels of the segment are sampled, we can sample the real-valued angles from the Gaussian distribution associated with a label. Folding simulation: the folding simulation begins with a heating up process, in which we repeatedly sample conformations for the whole RNA using the above-mentioned segment conformation sampling algorithm. This heating up procedure terminates if one conformation without steric clashes is generated. In our experiments, we usually can obtain a conformation without clashes very quickly, which is used as the initial conformation of the simulated annealing optimization (). To resample conformations of an RNA, we build a conformation sampling guide tree based upon the base pairing information in the RNA and all the nodes in the tree are marked as 'undone'. The torsion angles of the RNA are resampled using a bottom-up method along the tree as follows. We randomly pick up an 'undone' node A in the tree, which is either a leaf node or a node with all the child nodes being marked as 'done'.(i) If A is a leaf node, we resample the angles for the segment corresponding to A using the segment conformation sampling algorithm.(ii) If A has one or two child nodes, by cutting out the segments corresponding to the child nodes, we have at most three separate segments left in A, for which we use the segment conformation sampling algorithm to generate angles separately.The new conformation is accepted if its energy is lower. Otherwise it is accepted by a probability exp(E/T ), where E is the energy difference between current and the new conformations and T is the annealing temperature. This sampling procedure is repeated 3000 times and then node A is marked as 'done'. The folding simulation process ends when the root node is marked as 'done'. Energy function: different from the complex energy function in FARNA, we adopt a simple energy function used by BARNACLE () as follows.where H is the number of hydrogen bonds formed in the secondary structure (every AU and GU pair contributes two distances, and every CG pair contributes three distances),  d k is the distance between the donor and the acceptor of the k-th hydrogen bond and d k is the average length of hydrogen bonds of the same type. The smaller this value is, the more the decoy is consistent with its secondary structure. The energy is measured in , and the ideal base pair energy of 0  is only obtained for conformations with perfect base paring. We employ such a simple energy function (without any tuned parameters) so that we can carefully examine the performance of our sampling algorithm and perform a well-controlled comparison with other sampling methods such as BARNACLE. More sophisticated energy items, such as Mg 2+ ion interaction and stacking effect of base pairs, can be taken into account in future study.
CRF model trainingTraining data: we build our training dataset from the RNA structure classification database DARTS (), which collects 244 structures representing 1333 solved RNA structures and groups them into 94 clusters. Our training set comes from the 94 cluster representative structures, which have 6000 nucleotides in total. We use all 94 cluster representative structures to build empirical distributions of bond torsion angles. To make sure our training dataset does not overlap with the 11 benchmark RNA molecules, we exclude the representative structures in the same cluster as the 11 benchmark RNA. With the remaining 83 structures, we use 3-fold cross-validation to determine the CRF model regularization factors  and  and the proper window size. In each fold validation, two thirds of structures are used for training and the remaining for test.Page: i106 i102i110
Z.Wang and J.XuModel selection: the (training/test) accuracy of a second-order CRF model is defined as the number of correctly predicted states divided by the total number of positions. Fixing the number of conformation states in a CRF model, we search for the appropriate regularization factors and window size using a grid search strategy. As shown in the Supplement, the CRF model with 50 conformation states has the best performance when  = 5,  = 10 and window size = 5. We choose these parameters to maximize accuracy and avoid overfitting. Supplementshows that a larger window size does not improve the test accuracy significantly, but increase the accuracy gap between the training and test data, which might indicate overfitting. We also investigate the sampling performance of the CRF model with respect to the number of conformation states. We tested our CRF models with 20, 30, 50, 80 and 100 conformation states. For each CRF model, we generate 3000 decoys for each of the five RNAs: 2a43, 28sp, 2f88, 1zih and 1xjr.shows the 5% quantiles of the RMSD distributions for decoys generated by four different CRF models. As shown in, the model with 50 states generates better decoys than others. Using different methods to model the distribution of torsion, , makes a slight difference on the quality of sampled decoys.shows the 5% quantiles of RMSD values for 300 decoys sampled using four different  distributions with a well-trained CRF model. In Model 1, we fix  as the mean of the training data. Model 2 samples  from a log normal distribution. Model 3 samples  from a normal distribution. Model 4 uses sample  directly from the training data without using any mathematical modeling. Finally, we decide to use the normal distribution for , to yield a bit of variance.
RESULTSWe use 11 RNAs tested by both BARNACLE and FARNA to benchmark our method TreeFolder. These RNAs contain 12  46 nucleotides and are not homologous to any structures in our training dataset. In case an RNA has multiple NMR structures, we use the first structure in the PDB file as its native structure. It is not very reliable to compare two methods simply using the decoys with the lowest RMSD, since they may be generated by chance and also depend on the number of decoys to be generated. The more decoys are generated, the more likely the lowest-RMSD decoy has lower RMSD from the native. Therefore, a better strategy is to compare the RMSD distributions of decoys. Our TreeFolder generates better decoys than FARNA: we compare FARNA and TreeFolder in terms of the quality of the decoy clustering centroids. Similar to FARNA clustering only on the top 1% decoys with the lowest energy, we run MaxCluster to cluster the top 1% of our decoys with the lowest energy into five clusters. As shown in, TreeFolder can generate decoys with better cluster centroids for nine RNAs: 1a4d, 1esy, 1kka, 1q9a, 1xjr, 1zih, 28sp, 2a43 and 2f88. By the way, even if a significantly smaller number of decoys is generated by us, the lowest RMSD decoys by our TreeFolder for 1a4d, 1zih and 28sp still have smaller RMSD than those by FARNA. Our TreeFolder generates better decoys than BARNACLE:displays the 5% and 25% quantiles of the RMSD distributions for decoys generated by BARNACLE and TreeFolder. The quantiles by BARNACLE are taken from Supplementary Table S4 in. BARNACLE considers only decoys with energy < 1, since this kind of decoys are likely to have more correct base pairings. We use exactly the same energy function as BARNACLE, so we also consider only decoys with energy < 1 to ensure a fair comparison. We did not generate as many decoys as BARNACLE and thus for some test RNAs we do not have many decoys with energy < 1. In this case, we use decoys with energy < 2. On the 10 RNAs shown inPage: i107 i102i110Bold numbers indicate better distributions. Columns '#energy < 1' and '#energy < 2' list the number of decoys with energy <1 and <2, respectively. 'Bps' is the number of base pairings.For 10 of the 11 tested RNAs, the model using sequence information yields decoys with much smaller median RMSD. Bold numbers indicate smaller RMSD values. distributions for eight of them: 1esy, 1kka, 1q9a, 1qwa, 1xjr, 1zih, 28sp, 2a43 and 2f88. Sequence information is important for RNA conformation sampling: different from other two state-of-art methods, FARNA and BARNACLE, our TreeFolder makes use of sequence information to significantly improve conformation sampling, as measured by the median RMSD values of decoys. The result is shown in, in which we compare two CRF models: one using sequence to sample conformations and the other not. Without using sequence information, our CRF method is similar to BARNACLE. That is, it models only angle state transitions in a RNA structure. Both CRF models use 50 conformation states. For the CRF model without sequence features, the regularization factor is set to 5 (i.e.  = 5). While for the CRF model utilizing sequence information, the regularization factor are set to 5 and 10 (i.e.  = 5,  = 10). To calculate the median RMSD, for each RNA we generate 300 decoys using the two CRF models. Sampling real-valued angles generates better decoys: in order to show the detailed difference between our TreeFolder and FARNA, we look into the decoys of 1esy. We choose it because that FARNAand TreeFolder yield the largest difference on this RNA among all the 11 tested RNA molecules. As shown in. TreeFolder can generate a much larger percentage of decoys with RMSD < 4  than FARNA. We also compute local RMSD of each position in the decoys, which is defined as the RMSD of the segment of four consecutive nucleotides starting with this position, as compared to the native structure. We calculate the correlation between the local RMSD of each position with the global RMSD, as shown in. Among the decoys generated by both FARNA and TreeFolder, the local RMSD at position 13 has the highest correlation with the global RMSD. We also calculate the angle error at each position by Error = vv 0 2 , where v is the angle vector of a decoy at one position and v 0 is the native angle vector at the same position.shows the angle error histograms in three positions 13,Page: i108 i102i110accurate secondary structure prediction. The results for 1l2x and 2a43 from predicted secondary structures are quite bad, since all of their base pairs are contained in a H-type pseudoknot and only half of their base pairs are recovered by CONTRAfold. However, our TreeFolder generates decent conformations for half of the pseudoknot with predicted base pairs, as shown in brackets. In particular, TreeFolder generates decent structures for 2a43 from nucleotides 1 to 14 and for 1l2x from nucleotides 1 to 18, respectively. In order to improve sampling performance on the whole structures of 1l2x and 2a43, we need an energy function like what is used in FARNA to guide the folding simulation.
Conditional random fields for RNA conformation sampling
Z.Wang and J.Xu
Comparison with MC-Sym on the large RNA molecules: ourTreeFolder is much faster than the MC-Fold and MC-Sym pipeline () for folding large RNA molecules, asshows three overlay examples of 1q9a, 2a43 and 1xjr with length of 27 nt, 26 nt and 49 nt, respectively. Pictures in blue display native, while in red the best centroids produced by our algorithm. As shown in this figure, our algorithm recovered a pseudoknot for 2a43.
CONCLUSIONSWe have presented a new method TreeFolder for modeling RNA sequencestructure relationship and conformation sampling using CRFs and a tree-guided sampling scheme. Our CRF method not only captures the relationship between sequence and angles, but also models the interdependency among the angles of three adjacent nucleotides. Our conformation sampling method distinguishes from FARNA in that we do not use fragments to build RNA conformations, so that we do not need to worry about if there are a sufficient number of structure fragments to cover all the possible local conformations. Our TreeFolder also differs from both FARNA and BARNACLE, in that we use primary sequence to estimate the probability of backbone angles, while the latter two do not. In addition, we also use a tree, built from (predicted) secondary structure, to guide conformation sampling so that at one moment we can simultaneously sample conformations for two segments far away from each other along the RNA sequence. In contrast, both FARNA and BARNACLE can only sample conformations for a single short segment at any time. The results indicate that our i108
Conditional random fields for RNA conformation samplingTreeFolder indeed models sequencestructure relationship well and compares favorably to both FARNA and BARNACLE, even if we use only the same simple energy function as BARNACLE. We will extend our TreeFolder further. For example, we can incorporate information in sequence homologs into our CRF model so that we can estimate the conformation probability more accurately and thus improve the sampling accuracy. Information in homologs has been successfully used in RNA secondary structure and should be useful for 3D structure prediction. Information in homologs has also been used for protein conformation sampling (). Currently TreeFolder works well when the native base pairing information is used to calculate the energy function (same as BARNACLE) and to build the sampling guide tree. Not all the RNAs without 3D structures have the native base pairing information. Our next step is to further improve TreeFolder with the predicted base pairings. In particular, we need to design an energy function similar to what is used in FARNA to guide the folding simulation so that TreeFolder works well even if the predicted secondary structure is not very accurate. To tolerate errors in the predicted base pairing information, we will use the predicted confidence as the weight of each item in the energy function and only use those base pairings with high confidence to build the conformation sampling guide tree. We can also take another strategy to circumvent possible impact of errors in the predicted base pairings. In particular, we will extend our CRF method so that we can simultaneously sample base pairings and 3D conformations so that errors in the predicted base pairings will be corrected in the folding simulation process. Currently, we use a very simple energy function to guide the folding simulation. We will develop a more sophisticated energy function to guide the formation of hydrogen bonds in a better way, just like what FARNA does. Thus, we can not only generate decoys with better RMSD, but also with better hydrogen bonds.
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from [19:54 6/6/2011 Bioinformatics-btr232.tex] Page: i105 i102i110
i105 at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
and 15. The angles at these three positions determine the conformation of the segment starting at position 13. At positions 13 and 15, the angle errors by our method TreeFolder are significantly smaller than those by FARNA. As Figure 10 shows, the angle errors by FARNA are distributed around several separated peaks, which may be caused by the limited number of fragments used in FARNA. In contrast, the angle errors by TreeFolder are distributed more smoothly, possibly because we can sample real-valued angles. Folding RNA using predicted secondary structures: we use the secondary structures predicted by CONTRAfold (Do et al., 2006) and sample 1000 decoys for each RNA. The quantiles of their RMSD values are shown in Table 5. On 6 of the 10 tested RNA, decoys generated from native secondary structures are better than those from predicted secondary structures. On the other four RNAs, the difference between the two types of decoys is small, because of i107 at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
i110 at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
