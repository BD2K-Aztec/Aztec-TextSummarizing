Motivation: RNA-sequencing technologies provide a powerful tool for expression analysis at gene and isoform level, but accurate estimation of isoform abundance is still a challenge. Standard assumption of uniform read intensity would yield biased estimates when the read intensity is in fact non-uniform. The problem is that, without strong assumptions, the read intensity pattern is not identifiable from data observed in a single sample. Results: We develop a joint statistical model that accounts for non-uniform isoform-specific read distribution and gene isoform expression estimation. The main challenge is in dealing with the large number of isoform-specific read distributions, which potentially are as many as the number of splice variants in the genome. A statistical regularization via a smoothing penalty is imposed to control the estimation. Also, for identifiability reasons, the method uses information across samples from the same region. We develop a fast and robust computational procedure based on the iterated-weighted least-squares algorithm, and apply it to simulated data and two real RNA-Seq datasets with reverse transcriptionâ€“polymerase chain reaction validation. Empirical tests show that our model performs better than existing methods in terms of increasing precision in isoform-level estimation. Availability and implementation: We have implemented our method in an R package called Sequgio as a pipeline for fast processing of RNA-Seq data.
INTRODUCTIONAlternative use of exons can form a number of combinations called splice variants, which can be used as templates for producing related but distinct proteins (). Alternative splicing has been observed among different tissue types in 90 95% of human genes () and greatly diversifies the transcriptome. Many splice variants have been found to be implicated in a wide range of human diseases and functional roles (). For this reason, it is important to develop the technologies and statistical methods to distinguish and quantify different isoforms of the same gene. To compute an absolute expression scorein reads per kilobase per million reads (RPKM) unitsread counts are normalized against the transcript length and the total number of mappable reads (). Typically, to estimate isoform abundance, read counts falling into a gene with multiple isoforms are modeled as a Poisson process with uniform sampling across each transcript (). But due to a number of factors, e.g. the 5 0 or 3 0 bias, local nucleotide composition effectssuch as priming or GC biasor other technical biases, read distribution might not be uniform (). Indeed, empirical goodness-of-fit test for the Poisson model fitted under the uniform assumption shows that a majority of these models have poor fit. This would lead to bias in the isoform expression estimates. Recent methods suggest estimating non-uniform read distribution from single-isoform genes (). These methods are rather limited, where either one distribution is used for all isoforms or a different distribution depending on length. In other words, all transcripts of the same length from all genes, regardless of what genes and whether the genes have single or multiple isoforms, are assumed to have the same read distribution. This ignores, for example, the local composition effect of the transcript. Furthermore, a recent study () did suggest that, as the method used for RNA library preparation introduces some amplification artifacts, the distribution of read coverage could be isoform-specific. In real data we do find that the distribution for different transcripts that share common length is not always the same. In addition, we observe that read distribution is highly correlated across samples. In Supplementary Report, Supplementary Figures S1 and S2 show typical examples of non-uniform read distributions with overabundance on the 3 0 region. Interestingly, across samples, we find similarities in the shape of the read distributions even between different tissues. There is evidence that the sample-to-sample similarity in nonuniform read distributions holds more generally across the genome; see Supplementaryin the Supplementary Report. The restriction imposed by the previous methods in estimating read distribution highlights one main difficulty: once we allow non-uniformity, in principle each transcripteven from the same *To whom correspondence should be addressed. y The authors wish it to be known that, in their opinion, the first two authors should be regarded as Joint First Authors. geneto have its own specific pattern, would lead to a large number of distribution patterns, potentially as many as the number of transcripts. This makes the estimation highly nontrivial. To account for local composition effect,adjusted for priming bias, where each read is reweighted based on its first few bases. If based on seven nucleotides (heptamer), they needed to calculate the proportion of reads starting with each specific heptamer, i.e. 4 7 frequencies. So reads beginning with a certain composition of seven nucleotides overrepresented in the heptamer distribution are down-weighted.modeled the read counts depending on the specific composition of nucleotides along a gene, and developed a more complex Poisson linear and non-linear model to estimate the effect of a certain nucleotide occurring in the k th nucleotides away from a given position j, by modeling the count of reads starting at position j. The gene-expression levels and the coefficients of the effect of surrounding nucleotide are optimized iteratively. Cufflinks (), one of the mostly commonly tools used to deal with sequence-specific biases problem in isoform expression estimation, assumes uniform read distribution in its basic model, but provides an ad hoc correction of bias step (). It also estimates positional bias, which measures whether fragments are preferentially located toward either ends of the transcripts. Unlike the base-level bias correction method, our idea is to model the isoform-specific read distribution and expression jointly. The observed sample-to-sample similarity suggests that combining data from different samples makes read distribution identifiable. Our approach automatically allows for the local composition effect without any need for explicit modeling. Such a joint model is more natural, so we expect it to lead to better performance. The algorithm of iteratively estimating isoform expression and read distribution has some similarity to the idea in a recent published program NURD (), where a global bias curve for all genes and a local bias curve for each gene is estimated using nonparametric models. In this study, we compare the estimation accuracy of our model against Cufflinks, NURD and the method under uniform read distribution assumption, using a set of simulated datasets, and also apply our proposed method to two real datasets. In summary, the purpose of this article is to describe a method for joint estimation of isoform-level expression and isoformspecific read distribution. Allowing for isoform specificity automatically deals with positional bias and local composition effects, but it is challenging, as we then have to estimate as many distributions as the number of isoforms in the genome. Regularization via a smoothing penalty is used to control the estimation of the read distributions. Primary results show that, our approach provides substantial improvement on the quality of model fitting and improves the sensitivity in isoform-level differential expression analysis, compared with the method based on uniform assumption, Cufflinks and NURD.
METHODSIn previous methods (e.g.), a model is fitted gene by gene separately. Instead of genes, we consider a more natural model based on non-overlapping 'transcriptional units', each of which is defined as a union of all overlapping transcripts. A transcriptional unit may possibly contain several overlapping genes. For example, 410 distinct genes lie between position 88 022 280 and 88 277 580 on mouse chromosome 1, including a UDP glucuronosyltransferase 1 family; this family comprises eight transcripts that are annotated with different gene names in RefSeq. If a read is mapped to a region of overlapping genes, it is not possible to decide which gene the read comes from. If the genes are treated separately, the reads would be doubly counted, resulting in falsely higher expression level.
Read-count data and the general modelTo facilitate fast computations, we first summarize the number of reads that align to distinct subregions of a transcriptional unit. Whenever we say regions or subregions, we refer to exons and junctions. Let y ri be the number of fragments from individual i that fall in region r, i.e. the corresponding aligned reads in region r. This counting procedure is obvious for single-end reads, as we can simply count the number of reads that align in each region. For paired-end reads, we construct a two-way table such that the (i, j) th entry records the number of fragments whose first reads fall in the i th region and second reads in the j th region. Hence, in the pair-end case, a 'region' r is naturally defined by a pair of subregions (i, j). With this understanding, the same notation y ri applies for both singleand paired-end reads. Hereafter, unless needed for clarity, we simply use the term 'region' for both single-and paired-end data. For a transcriptional unit g with J known isoforms, let ji be the expression level of isoform j in individual i. The main statistical problem is to estimate transcript abundances ji 's from the read-count data y ri 's. Because of its complexity, we describe the paired-end case in detail; as explained later in the text, the single-end case is a special case of the paired-end. Each paired-end read that aligns inside a transcript is characterized by the starting point of each read; see. It is then convenient to represent all read pairs that align inside the transcript by the shaded area of. For a given transcript, the implied fragment length associated with a read pair at (x,y) is equal to ' j x, y  y  x  k, where k is the read length. Because the fragment length has a certain distribution, e.g. it is normally distributed with mean 300 bases, it affects what x and y values are possible. We have also notedwhere w i is conventionally the total number of mapped reads divided by 10 9 , c j x, y is the transcript-specific non-uniformity effect, ' j x, y is the fragment length implied by the (x,y) position in transcript j and f is the fragment-length density. Now, for each region r, let R r be the corresponding area defined by the region boundaries in the shaded area of; to be clear, from the figure, the shape of R r could be a triangle, a rectangle or a rectangle-minus-triangle. The expected number of read pairs in R r isIn practice, f is either assumed known, e.g. normal with certain mean and variance, or estimated using only read pairs from single-isoform transcriptional units. We shall estimate c j x, y jointly with transcript abundances ji 's. To get some simplifications, we assume that c j x, y % c rj for x, y 2 R r , so the integration is always on a known function, and the model can be written aswhere we defineTo interpret these quantities, we can see that if the fragment length is fixed, then L j is the total length of transcript j minus the fragment length, so in general L j is the effective length of transcript j. Furthermore, x rj can be interpreted as the proportion of read pairs in region r under uniform read distribution. By definition P r x rj  1 for every j. Given a transcript annotation database, the full collection of L j 's and x rj 's need to be evaluated only once. For the single-end case, the region r is an interval coinciding with exons or junctions. In this case, only the first reads are counted, so the double integrals in (1) reduce to the first integral over x, and x rj is now the ratio of the length of region r relative to the total, and the same general model (2) applies.
Uniform read distributionConsider firstly the model under uniform read distribution assumption, so from (2), with c rj 1, we have) and will be referred to as the standard method.
Non-uniform read distributionFor a specific transcriptional unit, we find that read distributions across samples are similar, as we have seen in Supplementary. Dividing length of a transcriptional unit into bin width of 200 bp, the read counts in each bin across samples have similar patterns, as shown in Supplementaryin the Supplementary Report. If expression values are estimated from a single sample, it would not be feasible to discover and unveil the underlying true read distribution. However, by combining reads from multiple samples, it is possible to estimate the read distribution, as multiple observed data points are available to determine the read intensity of a region.In this general case, we also start with the assumption that y ri is Poisson with mean ri in (2). Joint estimation of ji 's and c rj 's will be done using the maximum likelihood approach. The likelihood function is given in Section G of the Supplementary Report. First we can see that, given isoform-specific read intensity c rj 's, the isoform expression ji 's can be estimated from a linear model:where a rj w i c rj L j x rj. For identifiability, we setfor every j. With this restriction, it is clear that the assumption of uniform read distribution implies c rj  1 for all r and j, and the general model (4) reduces to the standard model (3). Thus, the joint estimation can be performed iteratively as follows:A. Given c rj , estimate ji sample by sample using model (4).The iterative scheme can be recognized as a block GaussSeidel method. The iteration looks simple, but in practice we have to use various estimation techniques to ensure a robust and fast computational procedure. In step A, given c rj to estimate ri , we use a generalized linear model with an identity link function. To make the estimation robust to outliers, we perform iterative-weighted least-squares with robust modification to deal with potential outliers (). The explicit steps and the computation of variance of the estimates are given in Section G of the Supplementary Report. The problem of estimating c rj in step B is more complex than the estimation of ji in step A, as now we are dealing with many more parameters. It is possible to estimate read intensity c rj for each region separately. However, intuitively we do not expect read intensity to change dramatically between adjacent regions. So, to allow the possibility of smooth transition between neighboring regions, we consider a model with smoothness penalty. This is done using a generalized linear mixed model with isoform-specific read intensity as correlated random effects (). Overall, the likelihood estimation with smoothness penalty is equivalent to a constrained optimization problem. The iteration scheme follows a block GaussSeidel method; its convergence is guaranteed in this case because both the likelihood and the penalty constraint are convex (). The convexity of the log-likelihood function has been shown byThe penalty function is based on the Gaussian distribution, so it is convex. Indeed, we checked that the Hessian matrix of the negative log-likelihood function is numerically positive definite for every model fitted. With the real mouse data, computations for 97% of the transcriptional units converge within 10 iterations; the rest have slower convergence, most likely due to low coverage.
Availability and implementationThe algorithm described is implemented in the R statistical programming language (http://www.r-project.org/). The package, called Sequgio, is available in Bioconductor's library, with a corresponding vignette. It could be part of an R-based pipeline for measuring differential expression of isoforms using RNA-Seq datasets. The package allows users to load in reads mapped by any alignment program, such as Burrows-Wheeler Alignment tool (BWA) (), Tophat () or Bowtie (). It is freely available on the web at http://www.meb.ki.se/$yudpaw.
DATASET AND PREPROCESSING PROCEDURES
RNA sequencing datamouse tissues and human brain tissueWe use RNA sequencing samples published in Mortazavi et al.Second, it is difficult to discriminate the expression of distinct isoforms using qRTPCR. An annotation with one-to-one match between genes and isoforms in the PCR experiment is available in Supplementary Table S2 of the MAQC project (). But we find that it might not be reliable, as although the annotation may relate a gene to one of its isoforms, we can tell from the RNA-Seq and qRT-PCR estimates that it might be the other isoform or both expressed. So we decide to use the commonly used UCSC annotation NCBI36/hg18 and summarize isoformlevel expression to gene-level before comparing the estimates from the different platforms.
Simulation procedureTo study the performance of the proposed method, we conduct simulations to compare results of Sequgio with (i) the transcriptional unit-and (ii) the gene-based standard methods, (iii) Cufflinks (version 2.0.2) with bias correction () and (iv) NURD (). The basic model in Cufflinks assumes the uniform read distribution, but for our comparisons we have used their suggested bias-correction step to account for non-uniform read distributions. The simulations are based on all transcripts in the reference annotation, and single-end reads are simulated. We first consider a model-based simulator. This is useful as evidence that all the methods have been implemented properly. To be realistic, the parameters are based on real data and performed as follows: first, the expression value and read distribution for each of the isoforms are estimated from the RNA-Seq data in, along with known total number of reads and length of exons and junctions. The expected number of reads for every region is then calculated using (4). Then, counts along the genomic regions in 10 samples are drawn from the Poisson distribution with the expected read counts as the mean. The output of each run of the simulation is read-count data in exons and junctions. We then convert these counts to a BAM/SAM file format, which is the input format accepted by Cufflinks and NURD. Read starting points would be randomly assigned within a region, i.e an exon or a junction, as long as the sum of reads equal to the simulated count for the region. For every randomly generated read, a corresponding cigar is generated and the genome annotation is queried accordingly to collect the corresponding sequence. We then format the reads to SAM style according to the assigned mapped positions. To check the effect of the alignment or mapping step, we further convert the BAM file to an unaligned FASTA file format and reprocess the BAM file with an aligner. Converting read counts into BAM and FASTA is performed using Python and the pysam (https:// code.google.com/p/pysam/) and Bio modules. We then use a second simulator called RNASeq ReadSimulator that is fully independent of our model (http:// www.cs.ucr.edu/$liw/rnaseqreadsimulator.html). This simulator program generates sequencing reads according to certain parameters. Crucially, it allows the users to specify the positional bias at isoform-level such that read distribution would be nonuniform. We use the observed read distributions and expression levels into capture the realistic patterns of positional bias and expression distribution. The expression level of each transcript (in RPKM units) is calculated by normalizing against the total number of reads within a sample and the effective transcript length. The raw simulated data are unmapped reads in FASTA format, which are then processed through the pipelines for the different methods. Among the methods with sequence bias correction, NURD considers a gene as one unit, whereas the others consider overlapping genes together. So, to investigate the necessity of modeling overlapping genes simultaneously, we compare the performance of the methods on transcriptional units that contain multiple genes. As a measure of closeness, resulting isoform-level expression estimates (O) are compared with the predetermined true expression values (E) using an absolute proportion error e  jO  Ej=E:This measure of distance gives a clear idea how close the estimates are to the true values. We then calculate the median value across samples for a transcriptional unit. To summarize the comparative procedures, we compare Sequgio, Cufflinks, NURD and the standard method using simulated reads from four sets of simulation: (A) mapped reads (turned into BAM and SAM file for Cufflinks and NURD, respectively), (B) unmapped reads (FASTA) from model-based simulator, (C) unmapped reads generated by RNASeqReadSimulator where expression levels are simulated based on real data and (D) a subset of (C) only contain transcriptional units formed by more than one gene.
RESULTS
SimulationFor mapped reads from model-based simulator (scenario A), we find Sequgio, Cufflinks and NURD has an overall correlation coefficient with true values of 0.96, 0.93 and 0.90, respectively. For single-isoform transcriptional units, correlation is all 0.99 for the three algorithms. For multi-isoform transcriptional units, Sequgio estimates have a correlation of 0.90 with the true values, compared with 0.85 and 0.78 for Cufflinks and NURD estimates. These high correlation values are obtained across all types of the simulated data, indicating the estimation procedures work as expected. The advantage of the joint model is expected to be more obvious when read distribution is deviated severely from uniformity. We show this in a simulation study given in Section B of the Supplementary Report, from which we note that there is no loss of performance of Sequgio in terms of model fitting when the read distribution is close to uniform. So, we stratify the transcriptional units to those that moderately and severely deviate from uniform according to whether a non-uniformity deviance measure is less or greater than its median value. The deviance measure is defined as the averaged squared difference between true read intensity and uniform intensity. The overall simulation results are summarized in. Among units whose non-uniform deviance is less than the median value, the median proportion errors are 4.0, 12.5, 14.1, 5.0 and 6.9% for Sequgio, the transcriptional unit-and genebased standard method, Cufflinks and NURD, respectively, where Sequgio has the lowest error. For units whose non-uniform deviance is larger than the median, the median proportion errors are 4.6, 5.8, 7.0, 5.5 and 6.6%, and Sequgio estimates are again the closest to the true values. Differences between methods are larger in transcripts with the severe non-uniform read distribution, especially when Sequgio is compared against the standard methods. We observe in particular that the gene-based standard method performs worst among all the methods. This is in line with what we expect, as the gene-based method cannot distinguish reads falling into overlapping genes entirely. In the following simulations, we will not include the gene-based standard method. To analyze simulated data in FASTA format (scenario B), we first have to map reads to the reference genome by an alignment program, such as Tophat, before doing any expression estimation. This setting tells us how well the methods deal with various alignment issues; for example, we find that reads simulated on the negative strand may end up mapped to the positive strand. In addition, filtering procedures of mapped reads, such as the threshold of mapping quality score, may be applied differently by expression quantification tools. Compared with the results from reads simulated at the level of unmapped sequences, performance of all estimators is affected to some extent by the mapping procedure. Cufflinks is the most poorly affected, whereas Sequgio with joint modeling has a consistently good performance among the estimators. Processing data simulated from RNASeqReadSimulator (scenario C) can be considered as a proper test for Sequgio, as the simulator is from an independent source and its output are unmapped reads, so abundance quantification may be affected by mapping and filtering procedure. Sequgio still maintains highquality performance with the median proportion error 56%.Note: Unless otherwise specified, the standard method is fitted for a transcriptional unit, not gene-based. Within each transcriptional unit, the median proportion error of expression level for every transcript across all samples is computed. We stratify transcriptional unit by its read distribution moderately and severely deviated from uniform.When the comparison is restricted to a subset of transcriptional units that contain multiple genes (scenario D), NURD does not function as well as in the other scenarios. NURD treats these genes independently, resulting possible double counting, arbitrary assignment or removal of reads. Thus, overall Sequgio performs better than the other methods.
Sensitivity in differential expression analysisTo investigate how much power one can gain in estimating read distribution by integrating multiple samples, we perform a simulation study for detecting differential expression levels estimated by the standard and the Sequgio method. Our model simulates the number of reads given exon length and read distribution from a real example, gene Cinp that contains six exons of lengths between 100 and 1500 bp. Two isoforms NM_026048 and NM_027223, one with 5 exons and the other with 6. We take data of this gene because its P-value of the goodness-of-fit test for models fitted using the standard method is around the third quartile (see Section 4.3). Also it is an illustration of a gene where read distribution differs between the isoforms, one transcript with a uniform read distribution and the other not. The number of samples in each tissue group is set to be six and the expression fold change of two tissue types varies from 1 to 1.3. The simulation is performed following the same procedures as described for model-based simulator, but for only one gene. The expression levels between tissues are then compared using t-test with unequal variances. For each value of , we generate 100 simulation sets and estimate the power to detect differentiallyexpressed (DE) transcripts. Results are shown in. In panel (a), the power analysis shows that using Sequgio we are able to identify more true DE transcripts. The gain in power can be as much as 20% at fold-change $ 1:2. Panels (b) and (c) indicate that the read distributions are estimated well.
Real RNA-Seq datasetsTo test the performance of our method on real data, we analyze the publicly available mouse tissue dataset (). For each gene whose expression is modeled by the standard method, we compute a goodness-of-fit statistic across regions to test the hypothesis that the assumption of uniform read distribution is adequate. The P-values from the goodness-of-fit test are used to access the model fitting. After correcting for multiple testing, 68.5% of the models have a P-value50.05, indicating that a majority is poorly fitted using the standard method. Overall, 2 statistics are reduced for 70.3% of the models, indicating that Sequgio improves model fitting substantially. In Section D of the Supplementary Report, we show the reduction in 2 statistics in detail for a gene with a median P-value from the goodness-of-fit test. We also calculate the average absolute deviation from uniform read intensity within every transitional unit in the mouse tissue data. The median value across units is 0.214, which can be interpreted as that the average estimated read intensity deviates 21.4% from uniformity. We next report the differential expression analysis of the tissues, and compare the gene-level versus the isoform-level differential expression. Overall the gene expression is equal to the sum of isoform abundance. Differential expression is defined using fold changes (FCs) and false discovery rate from moderated Welch t-test (). Specifically, DE genes are those with FC43, either over-or underexpressed, and false discovery rate50.01. Expression values are analyzed on logx  1 scale because of the zeros in the data. Transcripts with variance50.001 are removed. Only genes with multiple isoforms are considered.types, we look at a known tissue-specific gene Mecp2. Mutations in Mecp2 are the essential cause of the Rett syndrome, a neurodevelopmental disorder of the brain (). It is involved with brain development and neuron function. In one of Mecp2's isoforms ENSMUST00000123362, the estimated average expressions using Sequgio for the brain, liver and muscle tissues are 5.78(0.0003), 0.63(0.0014) and 0.00(0.008), respectively, with standard error indicated in the parenthesis. Using the standard method, the estimated expressions are 3.96(0.002), 0.94(0.001) and 1.69(0.006), respectively. The standard error of expression levels is small. So, the difference between the expression is larger in Sequgio's estimates.
Validation with mouse RT-PCR dataWe compare results derived by our method with RT-PCR quantification as in Zheng and Chen (2009), where RT-PCR is performed to assay transcripts' relative expression levels in the three mouse tissues. For each transcript, a relative expression ratio is computed between brain and muscle, and between brain and liver. For all seven genes annotated with the Alternative Splicing and Transcript Diversity (ASTD, http://www.ebi.ac. uk/astd/) and Ensembl (http://www.ensembl.org/index.html) databases, four transcripts can be matched or partially matched to a gene in the UCSC annotation that we are using. Isoform expression values are computed using our method in the three mouse tissue RNA-Seq data obtained from. We find that in all comparisons except for transcript, Supplementary Report). Not all of our results are in agreement with RT-PCR, although the discrepancies could be due to errors in annotation database and variability in isoform structures. For example, one of the amplified transcript ENSMUST00000115599 (Pcdh1) is no longer in the Ensembl database and has not been mapped to any new identifier. Our result of the expression estimation, although annotated to the other transcript of the same gene, is closely matched with the expression of ENSMUST00000115599. Results produced from our method may be improved with a more consolidated and accurate annotation database. In addition, we note that the relative expression ratio of ENSMUST00000115609 is consistent with the result delivered bybased on the sequencing data, i.e. differential expression pattern is barely detectable in brain/liver and it is positive direction in brain/muscle.
Validation with RT-PCR data in human brain tissueWe begin by examining the expression estimates from Sequgio; see. The correlation of the average expression estimate and the average results of qRT-PCR analysis was 0.82. This is largely in line with the result from Cufflinks, which shows a correlation of 0.84 after bias correction. As we have pointed out in the simulation study, correlation may not be a good statistic for comparing the performance of the two algorithms. The 2 statistic would be better, but, as the expression values from the qRT-PCR experiment are not the true absolute expression, we are not able to calculate the statistic here. Indeed, we can see a systematic deviation from the line of identity in the scatter plot in. Also, we examine the expression on the log scale, instead of on the original scale as shown byin their supplementary report. This is because the correlation coefficient can be severely affected by outliers, which are common in the original expression estimates; see Supplementaryin the Supplementary Report. The difference on scale explains why the correlation we obtain is different from in previous studies ().
DISCUSSIONIn this article, we introduce a novel method using RNA-Seq data from multiple samples to estimate the isoforms expression, taking into account non-uniform read distribution. Through simulations that model read-count data from non-uniform distribution, we demonstrate that our method improves accuracy in the expression quantification. When read distribution deviates dramatically from uniform, there is a striking improvement in accuracy of the expression estimation. Furthermore, our method can be easily adapted for use with any next-generation sequencing technology and mapping program. Sequgio uses a fundamentally distinct method to estimate read distribution. First of all, it does not assume any relationship between sequencing bias and relative position of a certain nucleotide in a fragment. It uses an explicit and transparent model with isoform-specific read intensity to simultaneously correct different sources of bias. Second, Sequgio is able to estimate isoformspecific read distribution as long as count-level data are available for a single transcriptional unit. In contrast, to produce nucleotide-specific bias weights, Cufflinks requires the nucleotide-level information of all genes. The same global nucleotide distribution is then used for all fragments. But estimation of nucleotide bias weights might be sensitive to which and how many singleisoform genes are taken into calculation. The main assumption of the joint model is that non-uniform read distributions can be identified using information across samples, given that the read distribution is consistent across samples. In section A of the Supplementary Report, we have presented evidence that the sample-to-sample similarity holds generally in the genome even between different tissues. In practice, we recommend users to follow the procedure to check the consistency especially when pooling information from two biological groups, e.g. diseased versus healthy. If not consistent, the estimation should be done separately. In the application to human brain tissue data, although only three samples are available, we see Sequgio performs fairly well based on the correlation with Cufflinks' and RT-PCR estimates. When there are 510 samples, we would recommend using them all in estimation. On the other hand, if a large number of samples are available and the computational system is limited, it would be useful to consider a two-staged procedure: (i) in the first stage the readNote: The first row lists the percentage of DE isoforms. But genes with DE isoforms can be non-DE at gene level. Percentage is summarized in the second row. Last two rows show the number of transcripts with both FC410 and highly expressed; the number of transcripts upregulated in tissue (A). Br, L and M stands for brain, liver and muscle. intensities are estimated from a subsample, and (ii) in the second stage these intensities are fixed, so only expression levels need to be estimated. Gold standards for transcript-level expression are difficult to obtain experimentally. Improvement by our method is shown mostly by empirical means via the goodness-of-fit 2 statistics. We also rely on simulations and limited isoform-level RT-PCR data to assess the accuracy of our results. In the simulations, we consider both a non-uniform distribution and a slight deviation from uniformity, and all parameter values are those we estimate from the real data, so they are a fair testing procedure. One limitation of many current methods including our own is that all isoforms for a gene are assumed to be known. Because of the huge amount of information from different isoform-level annotation database and complex structure of transcriptome, the current annotation is incomplete. We suspect this might partially cause discrepancies in the RT-PCR validation. Most biological annotation databases may be updated almost every week. Some databases will be closed and merged with others, e.g ASTD are integrated in Ensembl database. There is a need to develop a reliable and comprehensive mega annotation database. But it is worth emphasizing that with the RNA-Seq mouse tissue data used in this article, mapped counts and $18 000 genes identified are comparable with results from those studies that use the same dataset ().
The Author 2013. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
C.Suo et al. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
Joint estimation of isoform read distribution and expression at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
