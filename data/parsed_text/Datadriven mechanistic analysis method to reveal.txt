Motivation: Mechanistic models based on ordinary differential equations provide powerful and accurate means to describe the dynamics of molecular machinery which orchestrates gene regulation. When combined with appropriate statistical techniques, mechanistic models can be calibrated using experimental data and, in many cases, also the model structure can be inferred from time– course measurements. However, existing mechanistic models are limited in the sense that they rely on the assumption of static network structure and cannot be applied when transient phenomena affect, or rewire, the network structure. In the context of gene regulatory network inference, network rewiring results from the net impact of possible unobserved transient phenomena such as changes in signaling pathway activities or epigenome, which are generally difficult, but important, to account for. Results: We introduce a novel method that can be used to infer dynamically evolving regulatory networks from time–course data. Our method is based on the notion that all mechanistic ordinary differential equation models can be coupled with a latent process that approximates the network structure rewiring process. We illustrate the performance of the method using simulated data and, further, we apply the method to study the regulatory interactions during T helper 17 (Th17) cell differentiation using time–course RNA sequencing data. The computational experiments with the real data show that our method is capable of capturing the experimentally verified rewiring effects of the core Th17 regulatory network. We predict Th17 lineage specific subnetworks that are activated sequentially and control the differentiation process in an overlapping manner. Availability and Implementation: An implementation of the method is available at
IntroductionDuring the past years, several computational approaches have been proposed to infer the structure and dynamics of gene regulatory networks from either steady-state or timecourse measurements (). The approaches range from statistical and information theoretic methods to mechanistic models. Mechanistic models are capable of describing the actual molecular dynamics originating from reaction kinetics and the underlying network structure can also be accurately estimated by combining these models with appropriate statistical techniques (see e.g.). Typically, a mechanistic model consists of a set of interacting molecular components and a formal description for the possible mechanisms affecting the timeevolution of the components. While the mechanistically motivated network inference works well for static network topologies, the standard approach cannot be applied if the molecular mechanisms depend on transient cellular processes, and in particular, if the network structure is dynamically rewired. A good example of such transient processes are epigenetic modifications that typically are not observed in detail but can have a major effect on regulatory V C The Author 2016. Published by Oxford University Press.
i288This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (http://creativecommons.org/licenses/by-nc/4.0/), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.cominteractions, for instance, during cellular differentiation. In the presence of such transient processes, the structure of network becomes time-dependent and, consequently, the network inference becomes notably more challenging. The importance of dynamically evolving regulatory mechanisms has been recognized in many recent experimental studies and also computational techniques have been developed to analyze and understand measurements that are possibly affected by transient mechanisms (see e.g.). The existing computational approaches that address this problem primarily focus on state-space models, such as non-stationary dynamic Bayesian networks (;) and probabilistic Boolean networks and their variants (). To our best knowledge, general approaches that would complement mechanistic models so that they could be used to study and detect dynamically evolving regulatory networks do not exist. The inevitable strength of mechanistic models is that they are capable of describing the underlying molecular mechanisms in detail, and when combined with statistical modeling, they can take the analysis of timecourse data well beyond the state-space models. In other words, by means of mechanistic models it is possible to describe and analyze the actual processes behind the data and not only find patterns, correlations, or other dependencies in time-series. Given these strengths of mechanistic modeling, it is obvious that a high practical value can be obtained by extending this model class to account also for dynamically evolving molecular networks. In this study, we develop a novel mechanistic analysis method that can be used to detect and analyze latent processes which affect the molecular mechanisms by rewiring the underlying network structure. The method that we introduce is called the latent effect mechanistic (LEM) model and it is based on the notion that all mechanistic ordinary differential equation (ODE) models can be coupled with a latent process that approximates the net impact of transient mechanisms affecting the structure of molecular network. We embed the LEM model into a well-defined statistical framework that allows us to infer possible latent effects simultaneously with the model structure and rate parameters. In addition to the theoretical derivation of the LEM model, we also outline numerical techniques that are required to carry out the analysis. We exemplify the performance of our method using simulated data and conclude that we can rigorously recover the underlying model using our inference algorithms. Further, we apply our method to study the regulatory interactions during T helper 17 (Th17) cell differentiation using timecourse RNA sequencing (RNA-seq) data and conclude that our analysis results are in agreement with the previously observed results regarding the time-dependency of the regulatory network that steers Th17 lineage specification.
ApproachTo illustrate our modeling idea, let us consider a gene and some transcription factor A that activates the gene. Let us also assume that, prior to stimulation, the gene's locus is covered with epigenetic marks that prevent the transcription factor A binding the promoter (, left panel) and the gene remains inactive. Upon stimulation, epigenetic marks are removed by unknown enzymatic signals (, middle panel) and eventually the promoter region becomes clear from the repressive marks and the transcription factor can bind the promoter (, right panel). As a result of binding, the gene is activated and a gene product B is produced (, right panel). In mathematical terms this unobserved activation process corresponds to moving from the 'no interaction' network structure (, left panel) to 'interaction activated' network structure (, right panel). Because molecular reactions steering the epigenetic signaling are stochastic in nature, the change from the initial state to the active state does not occur synchronously in a cell culture. In other words, the fraction of cells in the active state increases gradually after stimulation while the fraction of cells in the inactive state decreases. Even though we may neither know nor be able to measure the molecular events that participate in the removal of the repressive epigenetic marks, we can construct an ODE model that describes the net impact of these events at the population level. In this toy example, the model can be, for instance, the ODE systemwhere x 1 and x 2 denote the relative fractions of cells in the inactive and active states, u(t) is an input signal representing stimulus, and h x is a free conversion rate parameter. In this study, we call the solution of this model a latent process.(a) illustrates the possible dynamics of the above latent process with different conversion rates and(b) shows an example of a latent process that consists of three sequential states (latent processes with multiple sequential phases will be discussed more in Section 3.5). In general, if we have some understanding about the mechanisms that influence the production and degradation of the transcription factor A and the gene product B, we can build a mechanistic model. Illustration of a dynamically evolving silencing mechanism that controls the relationship between the transcription factor A and the gene product B Time (h)Fig. 2. Examples of latent processes. (a) A latent process consisting of two states. The conversion from the first state to the second state can occur rapidly or slowly depending on the parameterization of the latent process. (b) A latent process consisting of three sequential states. The conversion from one state to another can occur smoothly or rapidly depending on the parameterization and, further, the parameters s 1 and s 2 determine the time instants for switching Data-driven mechanistic analysis method to reveal dynamically evolving regulatory networks i289 that would rigorously describe their dynamics. For instance, we can construct a model in the form ofwhere we have assumed that A and B degrade at rates d 1 and d 2 , respectively, B is produced at the basal rate k 0 , and A activates B at the rate k 1. This simple model corresponds to the mechanisms illustrated in the right panel in. If the assumptions of the mechanisms incorporated into the model are reasonably realistic, the parameters of the model can be inferred from timecourse population average data on A and B by means of statistical techniques. However, if the interaction between A and B is affected (i.e. rewired) by transient silencing of the gene, parameter and model inference results may become seriously biased or wrong. The LEM model for the above example system can be constructed by considering the standard ODE model (Eqs 3 and 4) and coupling it with the two-state latent process described by Eqs 1 and 2. In this example, the latent state x 1 represents the early state with inactive gene (silencing on) and the state x 2 the late state in which the repressive marks are removed. The LEM model is constructed by coupling the ODE system with the latent process. This results in the timevariant ODE system dA dt  d 1 Awhere z 1 ; z 2 2 f0; 1g. The binary parameters z 1 , z 2 parameterize the network structure and indicate whether the interaction between A and B is active in the latent states x 1 and x 2 or not. Effectively this results in four alternative models that are listed in the Table 1. By means of quantitative model comparison, we can select the most likely configuration for z 1 and z 2 and detect if transient mechanisms are present. Further, the model selection and parameter inference provide information about the possible dynamics of latent processes which, in the context of our example, means that we can infer the rate at which the cells leave the inactive state and enter active state. Naturally, if model selection indicates that most likely z 1  1 and z 2  1, it is obvious that the LEM model reduces to the standard ODE model. In the above example, the latent process can naturally be coupled with all mechanisms included into the model, that is, the basal induction, degradation, and interaction between A and B. In this case, the model selection should be carried out by considering 2 42  2 8 alternative model structures compared to 2 4 model structures in the standard ODE model. For example, stimulus dependent degradation could be detected along with transient interaction between A and B.
Methods
Formal definition of the LEM modelAs illustrated above, the first component of our model is a standard mechanistic ODE model. The standard model can be constructed using the law of mass action, MichaelisMenten or Hill kinetics, or any other similar approach. Without any loss of generality, we assume that the resulting model can be expressed in the formwhere i  1;. .. ; N; f ij y; h y  : R N  R n ! R, J i is the number of functions f ij affecting the component y i (and we denote J  J 1 . ..  J N ), and yt; h y  : 0; T  R n ! R N. In addition, we need to design a latent process xt; h x  : 0; T  R m ! R M which represents M possible underlying latent states. The latent process can be constructed by means of heuristically motivated ODE modeling, as presented for the toy model above, or by defining a wellmotivated parametric form for the process (as we do in Section 3.5). Regardless how the latent process is constructed, it is important that its functional form is flexible enough so that it is possible to infer latent dynamics from the data. Given a standard ODE model and a latent process, the LEM model is constructed by coupling them. Formally, we can write;is a weight function depending on the latent state and z jk 2 f0; 1g; k  1;. .. ; M. The binary parameters z jk determine if f ij is effective in the latent state x k or not (the values 1 and 0, respectively). It is convenient to store these binary parameters into a J  M matrix Z so that fZg jk  z jk. Note that in the standard ODE approach the network structure is defined by a J  1 vector. The LEM modeling approach allows the network structure to be rewired and the consecutive rewiring steps (and thus the dynamically evolving network structure) is defined by a binary J  M matrix Z. Now yt; h y ; xt; h x ; Z 2 R Nis the solution of the ODE system that is coupled with the latent process and we define the model output to bewhich can consist of some subset K N of the state variables y. In this study, we aim to infer the parameters h y and h x as well as the most likely configuration of the matrix Z from timecourse data. In order to do this in a rigorous manner, we need to formulate the problem in statistical terms.
Statistical framework to infer the model parameters and the network structure Zobjective way and propagate the uncertainty in the measurements through the models in a proper manner. In the following, we present a general statistical framework for the LEM model. By means of this framework it is possible to combine the LEM model with any data type or combination data types including, for instance, read count sequencing data and qPCR measurements. The only requirement is that we are capable of making some assumptions about the distribution of the chosen data type(s). Let D kl be a measurement of the kth component of the output / at time t l and let us denote / kl  / k t l . A statistical model can be constructed by assuming that the observation D kl is distributed according to some distribution g which depends on the model output / kl and the parameters of the distribution h d. In other words, D kl $ gD kl j/ kl ; h d :In the context of our ODE model, / kl is fully determined by the parameters h y , h x and Z, and consequently, we can write gD kl j/ kl ; h d   gD kl jh y ; h x ; Z; h d . Further, by introducing the notation h  fh y ; h x ; h d g, the distribution can be expressed in the form gD kl jh; Z. Now, if we have timecourse data on the state variables and we can assume that the measurements are independent given /, we can define the likelihood functionwhere D  fD kl ; k  1;. .. ; K; l  1;. .. ; Lg. A Bayesian statistical model can be obtained by combining the likelihood function with a prior distribution on the parameters, ph; Z (for details about Bayesian methodology, see e.g.). In our model formulation, the different configurations of the binary matrix Z define a discrete set of network structures and it is convenient to write the prior distribution in the form ph; Z  phjZpZ, where pZ is the prior distribution over network structures. By applying Bayes' theorem, we obtain the parameter posterior distribution phjD; Z  pDjh; ZphjZpZ pDjZ ;whereis the marginal likelihood of the model specified by Z. When the marginal likelihoods pDjZ of different configurations for matrix Z are available, model ranking can easily be done by means of the posterior distribution pZjD / pDjZpZ;or equivalently, logpZjD  logpDjZ  logpZ  C;where C is a constant.where pDj b h; Z is the maximum likelihood, k h is the number of parameters, and n is the number of observations. For model ranking purposes, we can simply neglect the constant C and compare unnormalized logarithmic posterior probabilities. Further, if the prior distribution over alternative configurations of binary matrix Z is uniform, Eq. 18 reduces to a form that corresponds to the Bayesian information criterion ().
Estimating
Forward-backward-stepwise selection to speed up model rankingIf we consider a LEM model that consists of J mechanisms and M latent states, we have altogether 2 JM alternative models (i.e. the number of different configurations of binary matrix Z). Typically, the numbers of mechanisms and latent states are such that the estimation of marginal likelihood for all alternative configurations is out of reach. Therefore, we suggest to speed up the model ranking task by means of forward-backward-stepwise selection. This leads essentially to an algorithm that can be implemented through the following four steps:3.5 LEM model for the core regulatory network driving Th17 cell specification T helper 17 (Th17) cells play a crucial role in the adaptive immune system () and they have been noted to have important functions in various autoimmune diseases (). Recent experimental and computational studies have shed light to the regulatory mechanisms that steer the differentiation from a naive CD4  helper T cell to a specialized Th17 cell (see e.g.).also report notable rewiring of the Th17 cell specific regulatory network during early phase of the lineage specification and, consequently, this provides us with a good application to test how LEM model analysis performs in practice.(a) illustrates the core Th17 regulatory network that was experimentally derived by. The core network consists of five transcription factors, the retinoic acid receptorrelated orphan receptor gamma t (RORC), signal transducer and activator of transcription 3 (STAT3), basic leucine zipper transcription factor (BATF), transcription factor Maf (MAF) and interferon regulatory factor 4 (IRF4), and contains only links that have been experimentally validated. For instance, RORC knock-out experiments show that RORC does not participate in any of the feedback Data-driven mechanistic analysis method to reveal dynamically evolving regulatory networks i291 mechanisms regulating STAT3 and, consequently such interactions are excluded from the network. To convert the network structure into a quantitative dynamic model, we denote the time-dependent expression levels of the genes by y i t; i  1;. .. ; N (here, N  5) and assume that the genes can have activating and inhibiting interactions, and, in addition, we allow basal activation and degradation. Each of these mechanisms can be associated with a corresponding rate equation and, as a result, we obtain an ODE system specified bywhere k b i ; k ia ij ; k sa ijk ; k inh ij and k d i are unknown basal activation, independent activation, synergistic activation, inhibition and degradation rate constants, respectively. The rate constants are defined to be strictly positive and setting a specific rate constant to zero removes that mechanisms (and parameter) from the model. We use the experimentally validated network ((a)) as a basis for our inference and include all experimentally validated interactions to the mechanistic model. To construct the LEM model, the system in Eq. 19 is combined with an appropriate latent process. The latent process for Th17 LEM model is constructed based on the findings reported by. They suggest that there are three sequential wiring states during the early phase of Th17 cell differentiation. From the mechanistic modeling perspective it is obvious that transitions between the states must occur gradually and two different wiring states can affect the observations simultaneously during the transitions. To describe a continuum of realistic transitions occurring between the sequential rewiring states, we define the latent processwhere k 1 , k 2 , s 1 and s 2 are the parameters of the process. Because the rewiring occurs in sequential states, we also introduce the restriction s 1 < s 2 .(b) illustrates dynamics of this latent process. To analyze the core Th17 regulatory network using the LEM model, we make use of the timecourse RNA-seq data provided by. To obtain these data,purified naive CD4  cells from lymph nodes and spleen of wild-type mice, cultured the cells in Th17 conditions, and harvested a proportion of cells at the time-points 0, 1, 3, 6, 9, 12, 16, 24 and 48 h for RNA-seq processing (see the original article for details). We use the fragments per kilobase of transcript per million mapped reads (FPKM) values of each gene to inform the LEM model and by assuming independent normally distributed noise, we can write the likelihood function (confer Eq. 13) in the formwhere we use same notation as in Section 3.2, N jl; r 2  is the normal probability density function with mean l and variance r 2 , and a and b parameterize the likelihood function. To construct this statistical model, we have assumed that the noise in the data depends on the signal strength according to the parameter b and, in addition, there is some basal level of variance that is determined by a. The original data consists of one measurement at each time point except at time 6 h there are three replicates. We treat the measurements at 6 h as a single measurement which is taken to be the mean of three replicates. The initial state for each model is fixed according to the measurement at time t  0 h. The prior distribution over the alternative configurations of the matrix Z can be constructed in numerous ways and, in this study, we use the truncated geometric distribution. More specifically, we define h(Z) to denote the number of nonzero elements in the matrix Z and setwhere j  0;. .. ; JM, and p  0.3. Intuitively, we set the prior over the number of nonzero elements in the matrix Z and, with the chosen parameterization, the impact of this prior distribution is rather weak. However, the prior distribution is introduced to prevent the forward-backward-stepwise selection algorithm proceeding in the cases in which the parametric dimension of the model remains the same and the model fit is improved in negligibly small fractions due to overly complex network structure.
Computational implementationThe LEM model, the estimation of unnormalized logarithmic posterior model probabilities, and the forward-backward-stepwise selection algorithm are implemented in Matlab (The MathWorks Inc., Natick, MA, USA). The ODE systems are solved numerically using the CVODES solver from the SUNDIALS package (). Maximum likelihood estimates for parameters are obtained using multi-start local optimization strategy in a similar manner as outlined by). In brief, we solve sensitivity equations in parallel with the ODE system, compute the gradient of the likelihood function accordingly, and use this information to carry out efficient local optimization. For each model, we sample random initial parameter values using Latin hypercube sampling and carry out the local optimization using lsqnonlin optimization routine in Matlab. If the optimization routine happens to operate in a parameter range that results in ODE responses that cannot be solved by using the default settings of the CVODES solver, the likelihood values at such points are mapped to a very small value.
Results
Testing the method using simulated dataBefore applying the LEM model to real data, we test the method and the related numerical procedures using simulated data. To simulate data, we construct a four gene network that is assumed to contain all mechanistically possible interactions ((a)). Further, we assume that the interactions are affected by sequentially occurring latent states in a similar manner as in our Th17 cell differentiation application. The three different wirings of the network are shown in(b) and these wirings affect the observed dynamics in an overlapping manner (see the latent process in(c)). In other words, we assume that the whole cell population does not switch the wiring synchronously but the cells move gradually form one i292 J.wiring state to another. To construct a quantitative model based on the interactions shown in(a), we assume the same structure for rate equations as in Section 3.5 for the Th17 cell specific core network and build the full ODE model according to the Eq. 19. Here, we assume that two genes (i.e. the genes A and B in(a)) have basal transcription mechanisms and the mRNA levels of all genes are allowed to degrade at independent rates. Further, these mechanisms are assumed to be present in all wiring states, that is, the corresponding rows in the matrix Z are fixed to contain only ones (see). To construct the LEM model for this system, we couple the full ODE model with the latent process defined by Eqs. 2022. The parameters that we use to simulate data are given in parentheses after the inferred values inand the resulting response consisting of the latent process and the solution of the ODE model is shown in(c) (dashed lines).(c) also shows the actual data points that are simulated by adding normal fluctuations to the deterministic response according to the statistical model (Eq. 23). In this example inference, the rate parameters are assumed to lay in the range 10 3 ; 10 and we use 100 random initial parameter values in the multi-start local optimization. Otherwise the inference for the simulated data is implemented using the same specifications that are used for the real data.The inference results for the simulated data are summarized inand. We conclude that the forward-backwardstepwise selection algorithm converges successfully to the correct configuration of matrix Z and the inferred parameter values are very close to the values that are used to simulate the data (see). Note that our approximative marginal likelihood computation together with prior for network structure imply appropriate Occam's razor and prevent inferring too complex models. Further, the model response, that is solved using the inferred parameters of the best model, is in a good agreement with the response that was used to generate the data (confer the solid versus dashed lines in). All in all, the inference and model selection perform well in this test case and we can proceed to analyze real data.
LEM model captures rewiring effects of regulatory interactions during early Th17 lineage specificationWe initiate the analysis of real data by visually inspecting the time course FPKM values. Our first observation is that the initial expression level of RORC is very low and, as a consequence, we deduce that the basal expression of the RORC gene is on a rather weak level. To incorporate this prior information into the LEM model analysis, we remove the basal RORC expression from the mechanistic model but allow basal transcription for other genes. The initial expression levels for the ODE models are taken directly from the experimental data. Further, we allow the mRNA levels of all genes to degrade during the experiment. We run the LEM model inference for the Th17 RNA-seq data using the specifications given in Sections 3.5 and 3.6. In our analysis, the rate parameters are constrained to the range 10 3 ; 100 and we use 300 random initial parameter values in the multi-start local optimization (the analysis is also repeated using 600 random initial parameter values to assure ourselves that the forward-backwardstepwise selection algorithm is not affected by suboptimalInferred dynamics plotted against simulated data (red circles). The color coding of the latent process corresponds to the three sequentially activated subnetworks shown above. Dashed lines represent the response that is used to simulate the data with fixed parameters and the solid lines represent the inferred dynamicsIn the statistical model, the parameters a and b have the values, 0.0001 and 0.1, respectively. Data-driven mechanistic analysis method to reveal dynamically evolving regulatory networks i293 optimization performance). The inference results for the Th17 RNAseq data are summarized inand. Intriguingly, the LEM model inference supports many interactions that were experimentally validated using combinations of different measurement techniques and experimental conditions in(for instance, knock-out experiments). The inferred LEM model structure is illustrated in(b) and parameter values are given in. Our LEM model inference does not only provide important information about the regulatory interactions between the genes but can also be used to generate predictions on the sequentially activated subnetworks ((b)) as well as the time evolution of the latent states that determine the impact of the subnetworks (). The predicted latent process in(c) shows that the first phase of differentiation seems to be rather fast, the second state occurs approximately within the time window form 4 to 13 h, and, eventually, after 20 h, the gene expression levels settle to the stable pattern in a long-lasting third state. This temporal behavior is in line with three transcriptional phases reported by, that is, early induction (up to 4 h), intermediate onset of phenotype and amplification (420 h), and late stabilization (2072 h). The predicted latent process ((c)) suggests that these three phases occur in an overlapping manner which seems very natural from the biological point of view. Further, the maximum likelihood fit of the selected model is in a good agreement with the timecourse data ((c)). The regulatory mechanisms that we predict to occur in three waves ((b), (c) and) have also clear interpretations. In the first phase, T cell activation and cytokine driven mechanisms are induced and they prepare cells for lineage commitment (Phase 1 in(b) and (c)). In the second phase, RORC is induced and the differentiation signals are amplified, for instance, through MAF and IRF4 activation (Phase 2 in(b) and (c)). In the third phase, the lineage commitment is maintained through RORC activation by BATF and STAT3 activation by IRF4 (Phase 3 in(b) and (c)). A significant feature in the sequentially occurring subnetworks is that STAT3 has a clear regulatory role during the first two phases. Given the central role of STATs in T helper cell lineage commitment in general (see e.g.), we find this behavior natural. As a matter of fact, STAT3 is directly activated by the inducing cytokines that initiate the Th17 cell differentiation process () and, besides this important role as an early activator, STAT3 also plays an important role in mechanisms that amplify and stabilize the differentiation response (see e.g.). To assess the uncertainty in the estimated parameter values of the inferred model, we carry out parameter identifiability analysis by using the profile likelihood method. The parameter profile likelihood for jth parameter can be defined by writing PL j p  maxs 1 4.018k 2 0.500s 2 12.976In the statistical model, the parameters a and b have the values, 0.0001 and 0.035, respectively. i294 J.which essentially is the maximized log-likelihood that is evaluated as a function of a fixed value p for the jth parameter (). The profile likelihood can be used to determine confidence intervals for estimated parameter values given a fixed confidence level (for details, see). A flat parameter profile likelihood results in an infinite confidence interval and, thus, indicates structural non-identifiability (). On the other hand, a confidence interval that is constrained at one end and extends infinitely to another direction indicates practical non-identifiability ().shows the parameter profile likelihoods for the parameters of the inferred Th17 LEM model. Most of the parameters are identifiable but the basal transcription and degradation of STAT3 as well as two STAT3 activating interactions (independent activation mechanisms by BATF and IRF4) turn out to be practically non-identifiable. However, this non-identifiability can presumably be avoided through a simple reparameterization, for instance, with respect to the degradation rate of STAT3 (for details about reparameterization, see e.g.). All in all, running the LEM model inference for the Th17 RNAseq data confirms that the developed methodology provides a very powerful formalism to analyze regulatory interactions in the presence of unknown latent processes that effectively correspond to dynamical rewiring of the regulatory network structure. The strengths of our approach are further emphasized when the above results are compared with the results that are obtained by running the forwardbackward-stepwise selection algorithm for the static Th17 network (and). The analysis with the static network supports only three experimentally validated interactions and, further, the model fitting against the timecourse data is poor ().
Discussion and conclusionsIn this study, we introduce a general methodology that enables us to analyze and predict dynamically evolving regulatory networks using mechanistic modeling. In the past years, statistical and computational approaches have been developed to infer dynamically evolving regulatory networks (see e.g.) and, in the context of mechanistic models, methods to infer input signals simultaneously with system parameters have been developed (see e.g.). To our best knowledge, general mechanistic modeling approaches to infer dynamically evolving networks do not exist and, consequently, the methodology that we present in this study is novel. A central strength of the LEM model inference is that it can easily be applied to any dataset that is accompanied with some knowledge about the mechanistic interactions between the molecular components. In this sense, the methodology, that we present in this study, provides us with an out-of-the-box method that can be used to obtain quantitative predictions about dynamically evolving regulatory mechanisms. Further, when applied as a first step analysis method, the LEM model inference also serves as an excellent starting point for further model refinement and, for instance, for the construction of detailed mathematical or biophysical models. The LEM model inference is beneficial especially if the molecular system of interest contains several components and the exhaustive construction of detailed alternative models for mechanisms driving the dynamically evolving network structure is out of reach.0.2 MAF. The predicted network structure and the dynamics of the mRNA levels obtained by running the forward-backward-stepwise selection algorithm for the static network without rewiring (i.e. the matrix Z is reduced to a J  1 vector which defines the static network structure). The inference algorithm is run by using the same premises as in the above LEM model analysis for the same Th17 RNA-seq data. The inset shows the predicted static interactions. The predicted dynamics (gray lines) are plotted against the timecourse data (red circles)In the statistical model, the parameters a and b have the values, 0.0001 and 0.035, respectively.
Data-driven mechanistic analysis method to reveal dynamically evolving regulatory networks i295The construction of the LEM model is transparent and the LEM extension can be applied to virtually any standard (stationary) ODE model. Even though the modeling approach is fully general, an obvious challenge in its practical application is the related model ranking problem over a large set of alternative models (i.e. over different network structures for each latent state). In general, for the case of standard stationary ODE models, the total number of network structures is 2 J. In the case of the LEM model, the total number of network structures increases to 2 JM. An exhaustive search over all possible model configurations can be carried out only for simple toy systems but this limitation holds both the standard and the LEM models. In this study, we explore the model space using the forwardbackward-stepwise selection. In practice, the forward-backwardstepwise selection results in a heuristic search algorithm which performs well in most cases but, on the other hand, there is no theoretical guarantee that the global optimum is always found. The possible sub-optimality of the search algorithm may be hard to detect, especially if large networks are considered, and this naturally limits the practical scalability of the LEM model inference and, as a matter of fact, constrains also the scalability of the search over standard ODE model structures. However, the practical scalability can be improved, for instance, by means of probabilistic search algorithms that explore the model space more efficiently. Thus, there is still room for further development of the search algorithms that can be used to calibrate the LEM model but these extensions are out of scope of this study and we leave them for future studies. The analysis that we carry out for T helper 17 cell differentiation combines two major experimental studies that provide information about the regulatory interactions steering the Th17 lineage commitment. More precisely, we use the experimentally validated static core network provided byand combine it with the dynamic view on the regulatory interactions () using our novel methodology. We are the first ones to study the dynamically evolving Th17 regulatory network by means of mechanistic modeling and our results are in line with the current understanding about the detailed biochemical mechanisms. While our methodology is here tested using the five-gene core Th17 network, the proposed model can also easily be extended and used to predict novel core genes or regulatory interactions for further experimental validation. In summary, the latent effect mechanistic (LEM) model, which we introduce in this study, provides us with a flexible yet rigorous means to detect and analyze transient phenomena that affect the wiring of molecular networks. In addition to introducing this novel model class, we present a general statistical framework that can be used to infer the model structure as well as the model parameters.
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
It is important to combine mathematical modeling with timecourse data using well-motivated, data type specific statistical models. Statistical modeling makes it possible to weight the data in an Table 1. Alternative models for the example system Parameters for weighting Interaction A ! B # of parameters z 1  0; z 2  0 no interaction 3  0 z 1  1; z 2  0 early interaction 4  1 z 1  0; z 2  1 late interaction 4  1 z 1  1; z 2  1 sustained interaction 4  0 Here, the number of parameters is a sum over the number of parameters in the actual model and the latent process, respectively. i290 J.Intosalmi et al. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
0.423 (0.5) 9 Degrad. of A 1 1 1 0.169 (0.15) 10 Degrad. of B 1 1 1 3.321 (2.5) 11 Degrad. of C 1 1 1 0.096 (0.05) 12 Degrad. of D 1 1 1 0.047 (0.05)
Basal activ. of BATF 1 1 1 0.115 2 Basal activ. of STAT3 1 1 1 9.620 3 Basal activ. of IRF4 1 1 1 0.097 4 Basal activ. of MAF 1 1 1 0.001
1 0.546 21 Degrad. of STAT3 1 1 1 97.332 22 Degrad. of IRF4 1 1 1 0.422 23 Degrad. of RORC 1 1 1 0.145 24 Degrad. of MAF 1 1 1 0.078
