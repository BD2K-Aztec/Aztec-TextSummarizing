Motivation: Multi-view microscopy techniques such as Light-Sheet Fluorescence Microscopy (LSFM) are powerful tools for 3D + time studies of live embryos in developmental biology. The sample is imaged from several points of view, acquiring a set of 3D views that are then combined or fused in order to overcome their individual limitations. Views fusion is still an open problem despite recent contributions in the field. Results: We developed a wavelet-based multi-view fusion method that, due to wavelet decomposition properties, is able to combine the complementary directional information from all available views into a single volume. Our method is demonstrated on LSFM acquisitions from live sea urchin and zebrafish embryos. The fusion results show improved overall contrast and details when compared with any of the acquired volumes. The proposed method does not need knowledge of the system's point spread function (PSF) and performs better than other existing PSF independent fusion methods. Availability and Implementation: The described method was implemented in Matlab (The Mathworks, Inc., USA) and a graphic user interface was developed in Java. The software, together with two sample datasets, is available at
INTRODUCTION
Multi-view 3D microscopy on live embryos3D + time images of fluorescently labeled cells in live model organisms are essential to developmental biology (). When this kind of images is acquired with enough * To whom correspondence should be addressed. temporal and spatial resolution, tracking of every single cell and reconstructing the cell lineage tree becomes possible (). Typical optical microscopy techniques (like confocal or two-photon laser scanning microscopy) provide images with resolution along the optical axis considerably worse than lateral resolution. Moreover, image quality gets progressively worse as light travels deeper inside the specimen, meaning that for relatively large specimens (such as zebrafish embryos or larvae) it is impossible to get good images of the whole embryo. To overcome this kind of limitations other microscopy techniques have been developed. Spinning-disk microscopy (), for instance, provides much higher imaging speed compared to scanned techniques. In theta-microscopy (), separate illumination and detection optical paths along orthogonal directions are used in order to improve the axial resolution. In a more recent approach called Light-Sheet-based Fluorescence Microscopy (LSFM) () widefield detection is combined with a lateral light-sheet illumination along the focal plane of the detection objective. LSFM is claimed to offer several advantages over conventional confocal laser scanning microscopy (CLSM) technique: @BULLET Unlike CLSM where a large part of the specimen is illuminated when recording a single point or plane, LSFM illuminates only the imaged plane, greatly reducing the overall photo-damage of the specimen. @BULLET The system's point spread function (PSF) is the combination of the light-sheet shape and the detection objective's PSF. For this reason, when low numerical aperture detection lenses are used, LSFM achieves significantly better axial resolution than other techniques such as confocal or two-photon fluorescence microscopy. @BULLET In LSFM wide-field detection is used, meaning that a full plane of the volume is acquired at once by an array of detectors (typically a CCD camera). In contrast, laser scanning microscopy (either confocal or two-photon) acquires one pixel at a time. This means that, for identical frame rates, LSFM has much longer per-pixel measurement time, which translates in a higher number of collected photons per-pixel, higher signal-to-noise ratio and dynamic range.Page: 239 238245of the fusion of the three different views of a sea urchin embryo, acquired at 20 h post-fertilization (hpf) is shown at the center. Renders of the individual views are shown in a smaller scale around the fusion.
Wavelet-based image fusion in multi-view 3D microscopyAnother important feature of typical LSFM implementations is their ability to perform multi-view imaging, i.e. to obtain several volumes of the sample with different orientations. This is usually achieved by mounting the specimen under study on a rotating stage, and it takes advantage of the large working distance of water dipping lens objectives or of relatively low NA objectives, which makes the implementation of the rotation stage easier. Each view is a 3D volume formed as a stack of planes acquired sequentially. General schemes of LSFM can be found in the literature () and in Supplementary. Such multi-view acquisition capability is desirable because, despite the previously mentioned advantages of LSFM over other fluorescence microscopy techniques, single views still show a series of problems (see Supplementary), like an axial resolution still worse than in plane resolution, slices increasingly dim and blurred with depth, etc., which will be further described below.
Multi-view fusion techniquesThe multi-view imaging capability of LSFM provides extra information with respect to a single-view approach, as those regions of the specimen that are acquired with lower quality in one view will appear sharper and brighter in a different view. To be fully useful, the information of the sample distributed among several volumes by multi-view imaging should be combined into a single volume (). Several techniques have been recently proposed for this task (). One approach is to pose the problem as a multi-view deconvolution, which can be solved using extensions of classic iterative deconvolution algorithms like RichardsonLucy () or Maximum A Posteriori () to the multi-view situation, by updating the estimate using one view at a time. This kind of algorithms performs fine when the actual PSF is well approximated and used in the deconvolution process. Its main drawback is precisely the need for a good estimate of the PSF, which is particularly difficult to obtain when the PSF is spatially variant as observed in the LSFM imaged volume due to the shape of light sheet and thickness of specimens. In () a spatially variant RichardsonLucy is proposed, where the PSF is dynamically estimated based on fluorescent beads embedded in the sample. Finally, it is worth mentioning that PSF-based algorithms require an extremely precise registration of the views. A different approach called content-based fusion () was recently proposed in which the fused volume is the weighted average of all the available views, using the local entropy of each view as weights. This method is very fast and the results provided show clear improvement with respect to each of the acquired views. We propose here an alternative method for multi-view fusion on the Discrete Wavelet Transform (DWT) () space. An advantage of such approach when compared to multi-view deconvolution is the fact that it does not require a PSF estimate. Moreover, due to the use of multi-band transforms that decompose each acquired view onto several scales and orientations, our method is able to select the best view independently along each band and can thus be considered as a multi-scale and multi-orientation contentbased fusion. This enhanced orientation discrimination feature is very valuable for LSFM data, as in a given region of the sample two or more views often provide useful information, each one along a different orientation (an example of such situation is provided in Supplementary). In this kind of situation, the image-space weighted average performed by the content-based fusion method is unable to independently discriminate directional information components on each view, while the proposed method can do so by working in the wavelet-space.
METHODS
Problem descriptionThe proposed method is designed to deal with the multi-view volume fusion problem in LSFM. There are mainly two ways in which different 3D fluorescence microscopy acquisitions can be complementary in a multi-view setting (): @BULLET Even though LSFM offers a relatively small axial PSF, due to the use of orthogonal illumination and detection axes, axial resolution remains usually worse than in-plane resolution. The in-plane and axial resolution throughout the specimen's volume change roles while it rotates around an axis orthogonal to the detection axis. Two orthogonal views offer the most complementary information in terms of PSF.For highly diffusive samples (which applies to living tissues even when relatively transparent) excitation and emission light far from the excitation and detection objective respectively gets severely attenuated/absorbed as it travels through the sample, which results in increasingly degraded image quality deeper into the sample. For large specimens such as the zebrafish embryo or larva, each view will contain useful information for less than half of the sample. The complementarity of views taken from different angles to compensate for this effect is quite clear. The goal of our method is to take a set of volumes, each one corresponding to a different view of the same sample (e.g. live embryo or larva of chosen animal models), and combine the complementary information available in all of them to create a new fused volume of a better overall quality than any original view alone.
Page: 240 238245
J.L.Rubio-Guivernau et al.
Fig. 2. Overviewof the pre-processing workflow. On the left (a) and on the right (b) we find the two possible registration methods, while the final step is depicted in the middle (c). For gray-level registration (a) two additional steps are performed: automatic cropping and pre-alignment, while bead-based registration (b) is directly performed on the acquired volumes. With either registration, the output of this step is a total transformation matrix for each of the input volumes, which is then used (c) to create the registered volumes and masks that will be passed to the fusion method. Both the registered volumes and the masks are padded as needed so that all of them have the same dimensions and all their information is preserved.
Pre-processingSeveral pre-processing steps might be performed before applying the fusion method to the data, e.g. cropping the volumes and, for very large datasets, down-sampling the in-plane resolution to lower the computation time. However, the only necessary step that must be performed before the fusion is the alignment or registration of all the acquired views, because any miss-registration will lead to artifacts in the final fused volume. The rotation angle of the sample mount is known from the acquisition setup. But it only provides a coarse estimation of the actual transformation between views. Several artifacts including the lack of precision and accuracy in the rotation calibration and operation () make a fine registration necessary. Fine registration of LSFM images is quite challenging, as the depthdependent blurring means that the registration procedure is complicated by information differences between the views. Furthermore, for large specimens, some regions can be totally obscured because of light scattering as described above. To face these problems, more views might be required to ensure sufficient overlap of usable information and external cues such as fluorescent beads in the mounting medium might be required (). Two different approaches have been used during this work, depending on the characteristics of the dataset: @BULLET A bead-based affine registration algorithm () was used for datasets with fluorescent beads embedded in the mounting medium around the specimen. @BULLET A gray-level affine registration algorithm () for datasets with no fluorescent beads, which uses just the information from the image intensity values.For small embryos such as sea urchin, bead-less sample preparation and thus gray-level registration is preferred. However, 3D volumes acquired from large embryos like zebrafish show extensive blurring and eventually little overlap between views, and we confirm that the bead-based registration proposed previously () is a useful strategy. The detailed pre-processing scheme used for each of the registration approaches is depicted in. For the gray-level registration, each of the acquired volumes is first automatically cropped in order to reduce as much as possible the data size and thus the time and memory consumption of the registration. Due to the low noise level of LSFM images, their background is quite uniform and such automatic cropping works well. Each cropped volume is then prealigned according to the rotation step configured during the acquisition, and the pre-aligned volumes are then passed to the gray-level affine registration algorithm. The transformation matrices corresponding to pre-alignment and fine registration are then composed to produce the total transformation matrix of each input volume. On the other hand, when bead-based registration is selected no initial cropping is used, mainly because it would not make sense to remove the beads needed for the registration algorithm to perform its task. No prealignment step is needed either for this kind of registration, as it performs well directly on the acquired volumes. Once the total transformation matrix has been computed for each of the views (by composing pre-alignment and fine registration matrices in the gray-level case, or directly obtained from the bead-based registration otherwise) they are applied to the original views in order to obtain the registered volumes, which are padded as needed in order to make all of them have the same dimensions. In parallel to this transformation, binary masks are also computed that indicate which voxels of each registered volume contain actual acquired data. These masks will be later used to prevent border artifacts, as it will be further explained later. In both approaches, the first view is arbitrarily chosen as a reference, and either registration method is used to compute the affine transform matching it with the other views. When all the views have been brought to the reference frame coordinate system, the fusion process can start.
3D wavelet fusionThere is a family of techniques named image fusion (), typically used on 2D images, which can effectively combine information from different sources into a single composite image. Among these techniques, wavelet-based image fusion () is one of the most widely used, and has already found some applications in biomedical imaging (). The main idea behind this approach is to take advantage of the properties of multi-band image decomposition schemes like the discrete wavelet transform. In this kind of decompositions, an input image (or volume) X 0 is decomposed onto several bands (each one corresponding to a specific scale and orientation, for instance)...K are the different bands in which the image is decomposed and X K is the residual low-pass approximation of X 0. Salient features in the input image X 0 become high-energy coefficients in at least one of the decomposition bands Y k , while smooth regions become low-or zero-energy coefficients. So, roughly speaking, by applying a common multi-band decomposition to all the input images available, and then choosing the highest energy coefficients, a fused image combining salient features from all input images is obtained. The detailed process is outlined inand the different steps are further described below. Before explaining the different steps, we recall the Page: 241 238245the registered views X 0 i (i = 1...N) and a corresponding set of masks K 0 i (i = 1...N). Each of the registered views is then passed to the wavelet transform of choice, generating the wavelet decomposition bands Y n,m i
Wavelet-based image fusion in multi-view 3D microscopy(where n = 1...N is the scale index and m = 1...7 the orientation index) and the low-pass approximation residuals X N i. In parallel the masks are also processed to get the multi-level masks K n i (n = 1...N) needed later. An activity measure a n,m i is computed for each of the wavelet coefficients, and by looking at those activity measures together with the multi-level masks the decision maps M n,m i are computed. Finally, the wavelet coefficients are combined according to the decision maps, giving place to the fusion decomposition, and by applying the inverse transform we get the fused volume X 0 F as output.(b) Wavelet decomposition example of a 2D slice, using three scales and three orientations, resulting in nine bands (N = 3 and K = 9). Although in this work we use undecimated wavelet transform, for illustration purposes this figure represents the classical decimated wavelet transform. inputs of the fusion method: @BULLET A set of I volumes X 0 i (i = 1...I), each of them containing a different 3D view of the specimen, which have already been registered, using the first volume X 0 1 as reference. @BULLET The corresponding set of binary masks K 0 i , each of them indicating which voxels on each of the volumes X 0 i contain relevant information. These masks are used, for instance, to tell which voxels of a registered volume come from the actual transformed volume, and which ones are just padding, allowing us to avoid border artifacts due to incomplete specimen coverage in some of the views.Transform input volumes: we first apply the wavelet transform of choice to each of the input volumes:, where i = 1...I is the view index. Depending on the specific wavelet transform chosen, there will be a different number and arrangement of the bands. If 3D DWT is selected, we get 7 different orientations on each scale, so when N scales are used during the decomposition, we end up with K = 7N bands. In this case it is more practical to index the bands by scale (n = 1...N) and orientation (m = 1...7):shows an example of the decomposition of a single slice of a LSFM Volume, using a 2D DWT with three scales (N = 3) and three orientations on each scale, resulting in K = 3N = 9 bands. The size of the bands will depend on the precise wavelet transform used. For instance, when using decimated DWT, the bands' size is halved on each level, so that the total number of elements in the whole decomposition W X 0 i is always equal to that of X 0 i. On the other hand, undecimated implementations of DWT, keep the size of each Y n,m i and X N i equal to X 0 i 's size, so each additional level increases the total number of elements in the decomposition. Undecimated implementations are usually preferred for fusion applications due to its shift-invariance property (). Generate multi-scale masks: parallel to the transformation of the input volumes, the corresponding masks are processed in order to prepare adequate multi-scale masks: K n i (n = 1...N). These multi-scale masks are designed to ensure that only valid voxels from the input volumes are taken into account when generating the fused volume. For this purpose we define the support of any given wavelet coefficient), as the set of voxels in the corresponding input volume which get involved in the computation of said coefficient. The size of the support will depend on the scale n and on the wavelet family used. When using haar wavelets, for instance, the support will be a 222 sub-volume for coefficients in scale 1, a 444 sub-volume for scale 2, and so on. If we denote by S X n i () the support of the coefficient X n i ( ), the multiscale masks are built so that K n i () takes the value 1 if the original mask K 0 i is equal to 1 at all the voxels v belonging to S, and otherwise it takes the value 0, that is:) 0 otherwise Supplementaryshows an example of how the use of these multilevel masks prevents the appearance of artifacts when some of the acquired views do not fully cover the specimen. Measure activity: the next step is to compute an activity or saliency measure at every location of each band from all the wavelet decompositions. This will later be used to decide which of the wavelet coefficients are related to salient features in the input volumes, so that they should be included in the fused volume. A common and simple choice, providing very good results, Page: 242 238245
J.L.Rubio-Guivernau et al.is to use the energy or the module of wavelet coefficients. In this context, the activity measure for any given wavelet coefficient Y n,m iComputation of decision maps: this is the most important step in the process depicted in, and it might be considered the core of the fusion method. We mean by decision maps the weights that define how, for each location in every band of the wavelet decompositions (including the residual low-pass approximation), the coefficients from all the input volumes are combined to create the fused volume. As already mentioned, these kind of methods aim at keeping the most salient features, at different scales and orientations, among the input volumes. Having the activity measure from the previous step, a straightforward way to implement such behavior is to create decision maps M n,m i that, for each location, scale and orientation, select the maximum activity measure from the different input volumes. The multi-level masks are taken into account in order to avoid selecting coefficients whose support includes non-valid voxels from the input volumes. This can be achieved with the following decision map equation:However, this definition is not adequate for using on every decomposition band. For instance, depending on the size of the objects present in the input volumes, some scales of their wavelet decomposition might be dominated by noise, so selecting the maximum coefficients on those bands would lead to increased noise in the fused volume. As an alternative for bands featuring noisy components, selecting the minimum activity coefficients instead of the maximum leads to better results. Supplementaryshows a comparison demonstrating how using minimum activity selection on some bands can improve the results. In order to take full advantage of the orientation and scale discrimination capability of the wavelet transform, it is necessary that the decision maps are able to select, in a given region of the image space, information from different views for different decomposition bands. In this sense, the local entropy maps used in content-based fusion, as seen in figure 6 from (), are too smooth. For this reason, in this work more local decision maps like the ones we just defined are preferred. In order to support this statement, in Supplementarywe show the result of combining wavelet decomposition with local entropy maps, which gives results almost identical to content-based fusion itself. With respect to the low-pass approximations corresponding to each input volume, they should contain similar information after extracting the relevant features into the different bands. For this reason it is usually preferred to average all the low-pass approximations, taking into account only those coefficients whose associate multi-level mask equals 1, which can be implemented by defining a different decision map equation, which is simply:Other possible strategies are easy to incorporate into the framework by just creating alternative definitions of the decision maps. Combination of wavelet coefficients: once the decision maps are ready, the next step is to combine the coefficients from all the input volume decompositions, generating the wavelet decomposition of the fused volume:As for the residual low-pass approximation of the fused volume X N F , it is computed in the same way by averaging the low-pass approximations of all the available volumes X N i ,i = 1...I. Inverse transform: finally, the wavelet decomposition generated in the previous step is inverted to get the final fused volume.
Algorithm implementation and performanceThe whole algorithm has been implemented in MATLAB , using a custom 3D extension of its undecimated discrete wavelet transform implementation (swt and iswt functions).summarizes the time consumed by the two main parts of the overall process: registration and fusion. Times are provided for the two registrations used and for both the proposed fusion method and the content-based fusion included in the 'SPIM Registration' plug-in of Fiji (http://www.fiji.sc). The results are averages based on several timesteps from each dataset, and to allow comparison despite different volume sizes, times have been normalized to a common volume size of 600600600. For wavelet-based fusion, the final inverse transform step is independent of the number of views, so the time has been split in a per-view time plus a fixed time. The current implementation of the proposed method is quite more timeconsuming than content-based fusion. We expect a 5-to 10-fold reduction in computation time when the method is recoded in C. Besides all the process is based on filters implemented as convolutions with rather small kernels, so the code should greatly benefit from parallelization schemes.
Dataset descriptionDatasets used in this work were acquired using a Digital Scanned Light-Sheet (DSLM) version of the LSFM microscope () where the light sheet is generated by scanning a light beam instead of using a cylindrical lens as in the Selective Plane Illumination Microscope (SPIM) (). Our method was applied to various kinds of datasets. The results presented here correspond to two datasets obtained from developing sea urchin (Paracentrotus lividus) and zebrafish (Danio rerio) embryos. Acquisition parameters are summarized in.
RESULTS
Live sea urchin embryoA live sea urchin embryo was imaged for 20 h, from 5 h post fertilization (hpf) until 25 hpf. The whole acquisition time was divided in 180 s intervals, leading to over 400 time steps. At each time step 3 volumes (i.e. views) were acquired, using a 120 @BULLET rotation of the sample between consecutive views. On all the acquired volumes, signal intensity relates to the local concentration of fluorescent protein accumulated in the cell nucleus.The sample did not contain fluorescent beads in this study, so the image registration method used before the fusion is the aforementioned gray-level affine registration (). After views registration, we applied the wavelet fusion method as described in Section 2.3. A 3D undecimated DWT was used as W X 0 i , with haar wavelet filters and three scales (N = 3). Regarding the different possibilities for computation of decision maps (as discussed in Section 2.3), the following configuration parameters were used for this dataset: @BULLET Minimum activity selection for bands in scale 1 (the finest) which is dominated by noise. @BULLET Maximum activity selection for bands in scales 2 and 3, which contain the most relevant detail information. @BULLET Averaging of the low-pass approximations.shows an example of the fusion performance, by comparing slices and profiles of the fused volume and the acquired views corresponding to a time step around 20 hpf. Each of the three views provides an incomplete picture of the embryo, with some regions showing sharp and bright nuclei, while others exhibit heavy blurring and even some missing nucleus. Nevertheless, slices from the fused volume present overall sharp nuclei with good contrast. At the bottom of the figure line profiles show that the fusion provides the best representation of cell populations, because even though each view might show increased brightness and contrast for some cells, they might completely miss other ones that are indeed recovered in the fused volume. The whole dataset (406 time steps) was processed similarly. A complete view of the results for this dataset is showed in the video displaying the evolution of the embryo during the 20 h of the imaging procedure (Supplementary Movie S11) 1. Supplementary Movie S11 shows the improvement of individual cell identification in the fused volume that becomes even more obvious as the embryo grows and the individual views are unable to properly capture the details of the whole embryo.
Page: 243 238245
Wavelet-based image fusion in multi-view 3D microscopy
Live zebrafish embryoThe second example is a live zebrafish embryo imaged for 12 h, starting at 5 hpf. The whole acquisition time was divided in
J.L.Rubio-Guivernau et al.
DISCUSSIONWe propose a novel methodology to fuse multi-view images, such as those obtained from light-sheet-based fluorescence microscopy, but not limited to that particular technique. Almost any imaging technique in which several volumes of the same object are acquired, each of one providing incomplete and complementary information, could benefit from the proposed fusion scheme, including recent light-sheet techniques like DSLM using structured illumination (). Our method is based on wavelet multi-scale and multi-orientation decomposition of the input volumes, and does not rely on a priori knowledge of the system PSF. While PSF-aware methods have more potential for reducing PSF-related artifacts, the proposed method can be used on those situations in which such knowledge is not available as is the case with LSFM acquisition where the PSF varies over the volume due to light sheet shape and to distorsion caused by the specimen itself. With respect to the other PSF-independent method mentioned in this work, content-based weighted averaging, the new method
Page: 245 238245
Wavelet-based image fusion in multi-view 3D microscopyhas improved orientation and scale discrimination as a direct consequence of performing the fusion in the wavelet domain instead of the intensity space. This improved discrimination is useful for instance in regions of the sample where two views contribute sharp details in different orientations. This work focuses on the fusion method itself, and does not consider the effect of other complementary methods like denoising techniques which could be used in a pre-processing step. For instance wavelet denoising () and bilateral filtering () seem good choices for future tests. Some variations (cross/joint and dual bilateral filtering) have been used for image fusion in certain situations (), but they are not adequate in situations where different views do not cover the full specimen, as uniform regions in the image being filtered will stay uniform regardless of the information provided by the other views. A possible way to further improve the usefulness of the proposed method would be to automatically adapt the wavelet fusion parameters, e.g. number of scales and fusion scheme, to the content of the input volumes. Moreover, the general scheme can be accommodated to any kind of wavelet transform (different base wavelet basis, non-separable decompositions, etc.), making the proposed method highly flexible and thus adaptable to any kind of input volumes.
The Author 2011. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oup.com at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
Direct download available at http://www.die.upm.es/im/videos/SPIM/ Movie_S11.avi (last accessed date November 27, 2011).
s intervals, leading to over 280 time steps. At each time step five volumes (i.e. views) were acquired, using a 72  rotation of the sample between consecutive views. In all the acquired volumes, signal intensity correlates with the fluorescent protein concentration in the cell nucleus. Fluorescent beads were added to the mounting medium, so that the bead-based registration method could be used. This means that the five acquired views show little overlapping information as shown in Supplementary Figure S7. For this reason, standard gray-based registration would be very challenging for this dataset, and beadbased registration is preferred. The last column in Supplementary Figure S7 shows the result of fusing the five available views (columns 15). The configuration parameters used for this dataset, including wavelet family, number of scales and decision maps computation scheme, were identical to the ones described in Section 3.1 for the sea urchin dataset. The fusion represents the full embryo better than any of the individual volumes, and, while some regions of the embryo are brighter in one specific view, the fusion captures all the relevant information, keeping good contrast whenever such contrast exists in any of the views (Supplementary Movie S12) 2 It is worth mentioning that, due to the size of this embryo, each view appears highly blurred in some regions, but the fusion method is able to deal with this situation and gives preference to non-blurred information from other views. Supplementary Figure S8 shows snapshots of the renders available in the video, with the five original views around the resulting fused volume. For both Supplementary Figure S8 and Movie S12, a hard threshold was applied to the original and fused volumes in order to reduce the number of visible beads in the renders. 3.3 Comparison with existing methods For both datasets, we have also compared our results with those of the previously mentioned content-based weighted averaging (Preibisch et al., 2008), which is also PSF independent and freely available as part of Fiji open-source image processing package. The comparison between our method and Preibisch et al.'s method is shown in Supplementary Figure S9 for the sea urchin embryo, and in Figure 5 for the zebrafish. The results of the wavelet-based fusion method look less blurred, and more individual nuclei can be distinguished. The latter is supported by the line profile comparison through a group of three nuclei in a blurred region (Fig. 5). For the sea urchin, the difference is less striking, but the line profiles in Supplementary Figure S9, reveals slightly better peak contrast with our wavelet fusion method (in blue) compared to the content-based fusion (in yellow). Additionally, a quantitative comparison was carried out on two different timesteps for both datasets, by measuring the contrast of several line profiles, each one passing through two adjacent nuclei. An overall 31% improvement was measured for the proposed method in comparison to content-based fusion. The details are provided in Supplementary Figure S10. 2 Direct download available at http://www.die.upm.es/im/videos/SPIM/ Movie_S12.avi (last accessed date November 27, 2011).
