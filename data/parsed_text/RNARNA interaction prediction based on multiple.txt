Motivation: Many computerized methods for RNA–RNA interaction structure prediction have been developed. Recently, O(N 6) time and O(N 4) space dynamic programming algorithms have become available that compute the partition function of RNA–RNA interaction complexes. However, few of these methods incorporate the knowledge concerning related sequences, thus relevant evolutionary information is often neglected from the structure determination. Therefore, it is of considerable practical interest to introduce a method taking into consideration both: thermodynamic stability as well as sequence/structure covariation. Results: We present the a priori folding algorithm ripalign, whose input consists of two (given) multiple sequence alignments (MSA). ripalign outputs (i) the partition function, (ii) base pairing probabilities, (iii) hybrid probabilities and (iv) a set of Boltzmann-sampled suboptimal structures consisting of canonical joint structures that are compatible to the alignments. Compared to the single sequence-pair folding algorithm rip, ripalign requires negligible additional memory resource but offers much better sensitivity and specificity, once alignments of suitable quality are given. ripalign additionally allows to incorporate structure constraints as input parameters. Availability: The algorithm described here is implemented in C as part of the rip package. The supplemental material, source code and input/output files can freely be downloaded from
INTRODUCTIONRNARNA interactions play a major role at many different levels of the cellular metabolism such as plasmid replication control, viral encapsidation, or transcriptional and translational regulation. With the discovery that a large number of transcripts in higher * To whom correspondence should be addressed. eukaryotes are non-coding RNAs, RNARNA interactions in cellular metabolism are gaining in prominence. Typical examples of interactions involving two RNA molecules are snRNAs (); snoRNAs with their targets (); microRNAs from the RNAi pathway with their mRNA target (); sRNAs from Escherichia coli (); and sRNA looploop interactions (). The common feature in many ncRNA classes, especially prokaryotic small RNAs, is the formation of RNARNA interaction structures that are much more complex than the simple senseantisense interactions. As it is the case for the general RNA folding problem with unrestricted pseudoknots (), the RNARNA interaction problem (RIP) is NP-complete in its most general form (). However, polynomial-time algorithms can be derived by restricting the space of allowed configurations in ways that are similar to pseudoknot folding algorithms (). The simplest approach concatenates the two interacting sequences and subsequently employs a slightly modified standard secondary structure folding algorithm. The algorithms RNAcofold (), pairfold () and NUPACK () subscribe to this strategy. A major shortcoming of this approach is that it cannot predict important motifs such as kissing-hairpin loops. The paradigm of concatenation has also been generalized to the pseudoknot folding algorithm of Rivas and Eddy (1999). The resulting model, however, still does not generate all relevant interaction structures (). An alternative line of thought is to neglect all internal base pairings in either strand and to compute the minimum free energy (MFE) secondary structure for their hybridization under this constraint. For instance, RNAduplex and RNAhybrid () follows this line of thought. RNAup () and intaRNA () restrict interactions to a single interval that remains unpaired in the secondary structure for each partner. These models have proved particularly useful for bacterial sRNA/mRNA interactions (). Pervouchine (2004) andindependently proposed MFE folding algorithms for predicting the joint structure of two interacting RNA molecules with polynomial time complexity. In their model, a 'joint structure' means that the intramolecular
RNARNA interactionstructures of each molecule are pseudoknot-free, the intermolecular binding pairs are non-crossing and there exist no so-called 'zigzags', see Supplementary Material for detailed definition. The optimal joint structure is computed in O(N 6 ) time and O(N 4 ) space via a dynamic programming (DP) routine. A more reliable approach is to consider the partition function, which by construction integrates over the Boltzmann-weighted probability space, allowing for the derivation of thermodynamic quantities, like e.g. equilibrium concentration, melting temperature and base pairing probabilities. The partition function of joint structures was independently derived by. A key quantity here is the probability of hybrids, which cannot be recovered from base pairing probabilities since the latter can be highly correlated.presented a new hybridbased decomposition grammar, facilitating the computation of the non-trivial hybrid probabilities as well as the Boltzmann sampling of RNARNA interaction structures. The partition function of joint structures can be computed in O(N 6 ) time and O(N 4 ) space and current implementations require very large computational resources.recently achieved a substantial speed-up making use of the observation that the external interactions mostly occur between pairs of unpaired regions of single structures.introduced tree-structured Markov Random Fields to approximate the joint probability distribution of multiple (3) contact regions. Unfortunately, incompleteness of the underlying energy model, in particular for hybrid-and kissing-loops, may result in prediction inaccuracy. One way of improving this situation is to involve phylogenetic information of multiple sequence alignments (MSAs). In an MSA, homologous nucleotides are grouped in columns, where homologous is interpreted in both: structural as well as evolutionary sense. That is a column of nucleotides occupies similar structural positions and all diverge from a common ancestral nucleotide. Also, many ncRNAs show clear signs of undergoing compensatory mutations along evolutionary trajectories. In conclusion, it seems reasonable to stipulate that a non-negligible part of the existing RNARNA interactions contain preserved but covarying patterns of the interactions (). Therefore, we can associate a consensus interaction structure to pairs of interacting MSAs (see Section 2.1). Along these lines,) presented an algorithm PETcofold for prediction of RNARNA interactions including pseudoknots in given MSAs. Their algorithm is an extension of PETfold () using elements of RNAcofold () and computational strategies for hierarchical folding (). However, PETcofold is an heuristics-based algorithm. A detailed comparative analysis also including the algorithm inteRNA () will be given in Section 3. Here, we present the algorithm ripalign which computes the partition function, base pairing as well as hybrid probabilities and performs Boltzmann sampling on the level of MSAs. ripalign represents a generalization of rip to pairs of interacting MSAs and a new grammar of canonical interaction structures. The latter is of relevance since there are no isolated base pairs in molecular complexes. One important step consists in identifying the notion of a joint structure compatible to a pair of interacting MSAs. Our notionis based on the framework of, where a sophisticated cost function capturing thermodynamic stability as well as sequence covariation is employed. Furthermore, ripalign is tailored to take structure constraints, such as blocked nucleotides known e.g. from chemical probing, into account.
THEORY
MSAs and compatibilityAn MSA,  R, consists of m  R RNA sequences of known species. Denoting the length of the aligned sequences by N,  R constitutes a m  R N matrix, having 5 3 oriented rows,  R i and columns,  R i. Its (i,j)-th entry,  R i j , is a nucleotide,In the following, we shall assume that a pair of RNA sequences can only interact if they belong to the same species. A pair (  R,  S) can interact if for any row  R i , there exist at least one row in  S that can interact with  R i. Given a pair of interacting MSAs (  R,  S), let m be the total number of potentially interacting pairs. ripalign exhibits a pre-processing step which generates a mN-matrix R and a mM-matrix S such that (R i ,S i ) range over all m potentially interacting RNA pairs, see Section 1.2. of Supplementary Material for details. In the following, we shall refer to R and S as MSAs ignoring the fact that they have multiple sequences. We proceed by defining joint structures that are compatible to a fixed (R,S). To this end, let us briefly review some concepts introduced in. A joint structure J(R,S,I) is a graph consisting of(j1) Two secondary structures R and S, whose backbones are drawn as horizontal lines on top of each other and whose arcs are drawn in the upper and lower halfplane, respectively. We consider R over a 5 to 3 oriented backbone (R 1 ,...,R N ) and S over a 3 to 5 oriented backbone (S 1 ,...,S M ) and refer to any R-and S-arcs as interior arcs.An additional set I, of non-crossing arcs of the form R i S j (exterior arc), where R i and S j are unpaired in R and S.The subgraph of a joint structure J(R,S,I) induced by a pair of,b;c,d if and only if J i,j;h,, is a subgraph of J a,b;c,d induced by (R i ,...,R j ) and (S h ,...,S ). In particular, we use Sto denote the subgraph of J 1,N;1,M induced by (S i ,S i+1 ,...,S j ), where i  j. In particular, in case of i = j, we identify Swith the vertex S i. Given a joint structure, J a,b;c,d , a tight structure (TS), J i,j;h,, , () is a specific subgraph of J a,b;c,d indexed by its type {@BULLET,,,}, see. For instance, we use J i,j;h,, to denote a TS of type. A hybrid is a joint structure J, i.e. a maximal sequence of intermolecular interior loops consisting of a set of exterior arcsof singlestranded nucleotides only. That is, a hybrid is the maximal unbranched stem-loop formed by external arcs. A joint structure J(R,S,I) is called canonical if and only if:(c1) each stack in the secondary structures R and S is of size at least two, i.e. there exist no isolated interior arcs,In the following, we always assume a joint structure to be canonical. Next, we come to (R,S)-compatible joint structures. In difference to single sequence compatibility, this notion involves statistical information of the MSAs. The key point consists in specifying under which conditions two vertices contained in (R 1 ,...,R N ,S 1 ,...,S M ) can pair. This is obtained by a generalization of the RNAalifold approach (). We specify these conditions for interior (be the frequency of (X,Y) which exists in the 2-column submatrix (R i ,R j ) as a row-vector andHere, XY and X Y independently range over all 16 elements of {A,U,G,C}{A,U,G,C} and D R XY,X Y = d H (XY,X Y ), i.e. the Hamming distance between XY and X Y in case of XY and X Y being WatsonCrick, or GU wobble base pair and 0, otherwise. Furthermore, we introduce q R i,j to deal with the inconsistent sequenceswhere (x,y) is the Kronecker delta and h i,j (R) is equal to 1 if R h i and R h jare WatsonCrick or GU wobble base pair and 0, otherwise. Now we obtainBased on sequence data, the threshold for pairing B R * as well as the weight of inconsistent sequences  1 are computed. We haveThe case of two positions S i and S j is completely analogouswhere B S i,j and B S * are analogously defined. As for (c R,S i,j ) a further observation factors in: since many ncRNA show clear signs of undergoing compensatory mutations in the course of evolution (), we postulate the existence of a non-negligible amount of RNARNA interactions containing conserved pairs, consistent mutations, compensatory mutations as well as inconsistent mutations. Based on this observation we arrive atare analogously defined as the case B R i,j and B R * . A joint structure J is compatible to (R,S) if for any J-arc, the corresponding intra-or inter-positions can according to Equation (2.3)(2.5) pair.
Energy modelAccording to, joint structures can be decomposed into disjoint loops. These loop types include standard hairpin-, bulge-, interiorand multi-loops found in RNA secondary structures as well as hybrids and kissing-loops. Following the energy parameter rules of, the energy of each loop can be obtained as a sum of the energies associated with non-terminal symbols, i.e. graph properties (sequence independent) and an additional contributions that depend uniquely on the terminal bases (sequence dependent).Suppose we are given a joint structure J, compatible to a pair P = (R,S). Let L  J be a loop and let F L,i represent the loop energy of the i-th interaction pair (R i ,S i ). Then the loop energy of P isWe consider the energy of the structure as the sum of all loop contributions:To save computational resources, gaps are treated as bases in ripalign. Thus, only alignment positions contribute as indices and loop sizes. Since no measured energy parameters for non-standard base pairs are available at present time, additional terminal-dependent contributions for the latter are ignored. For instance, let Int i,j;h,l denote an interior loop formed byInt,P denote the free energy of Int i,j;h,l with respect to the aligned sequences in P.Int,P associated to the three aligned subsequences ofreads F Int,P i,j;h,,Here G Int i,j;h,, represents contributions related exclusively to the positions of the interior loop while G Int * ,A,B;C,D represents additional contributions related to the specific nucleotides which form the interior loop. We set G Int * ,G,C;.,. to be zero.
The grammar of canonical joint structures and the partition functionThe partition function algorithm is easily extended to work with the modified energy functions given in Equation (2.7). The reformulation of the original hybrid-grammar into a grammar of canonical joint structures represents already for single interaction pairs a significant improvement in prediction quality. The original rip-grammar would oftentimes encounter joint structures having a hybrid composed by a single isolated exterior arc. In order to decompose canonical joint structures via the unambiguous grammar, detailed in the Section 2 of Supplementary Material, we distinguish the two types (Type cc and Type c) of TS's of type , or. Given a TS of type ,, we write depending on whether, respectively. Analogously, we define J ,cc, see. As illustrated in theof Supplementary Material, there are two basic steps of the canonical-grammar: (i) interior arc-removal to reduce TS and (ii) block-decomposition to split a joint structure into two smaller blocks. The key feature here is, that since J is canonical, the smaller blocks are still canonical after block decomposition. Each decomposition step results in substructures which eventually break down into generalized loops whose energies can be directly computed. More details of the decomposition procedures are described in Section 2 of Supplementary Material, where we prove that for any canonical joint structure J, there exists a unique decomposition tree (parse-tree), denoted by T J , see.
Page: 459 456463
RNARNA interaction
Probabilities and the Boltzmann samplingA dynamic programming scheme for the computation of a partition function implies a corresponding computation of probabilities of specific substructures is obtained 'from the outside to the inside' and a stochastic backtracing procedure that can be used to sample from the associated distribution (). We remark that the time complexity does not increase linearly as a function of m (see Supplementary). Along the lines of the design of the Vienna software package (), ripalign now offers the following features as optional input parameters:(i) a position i can be restricted to form an interior or an exterior arc (denoted by '' and ' ^', respectively);(ii) a position i can be forced to be unpaired (denoted by 'x');(iii) a position i can be restricted to form an (interior or an exterior) arc with some position j (denoted by ' * ');(iv) a pair of positions i and j can be forced to form an interior or exterior arc (denoted by '()' or '', respectively). However, the above features are optional. Thus, ripalign can deal with both scenarios: the absence of any a priori information and the existence of specific information, e.g. the location of the Sm-binding site, see.
RESULTS AND DISCUSSIONThis discussion is organized into three parts: Firstly, we apply ripalign to two well-known ncRNA interactions: the fhlA/OxyS and the CopT/CopA. In the process, we provide a comparative analysis with rip, PETcofold with stem constraints (PETcofold + ), without stem constraints (PETcofold  ) and InteRNA. The stem extension constraint of PETcofold represents a specific programming technique of) to avoid incomplete stems. Secondly we study two interactions whose consensus structures are still under investigation: (i) the interaction of the spliceosomal RNAs U4/U6 snRNA and (ii) the interaction of theWe consider sensitivity, specificity, PPV, ACC, MCC and the MFE of the predicted structures. The fhlA/OxyS-joint structures of ripalign and PETcofold are based on the MSAs displayed in. The fhlA/OxyS-joint structures predicted by rip and InteRNA are based on the 8th pair of sequences displayed in. All quantities are based on the natural structure derived in, free energy is given in kcal/mol. The CopT /CopA-joint structures are based on the sequences presented in. All calculations were performed on an Intel(R) Xeon(R) E5410 @ 2.33 GHz (eight cores), 48 GB memory, CentOS release 5.3. The runtime is given in day (d), hour (h), minute (m) and second (s).
SmY-10/SL-1 RNAproposed by. Thirdly, we integrate our findings and give concluding remarks.
The fhlA/OxyS interactionThe OxyS RNA represses fhlA mRNA translation initiation through base pairing with two short sequences (), one of which overlaps the ribosome binding sequence and the other resides further downstream, within the coding region of fhlA. We can report that ripalign improves the computational results in terms of sensitivity, specificity, positive prediction value (PPV), accuracy (ACC), Matthew's correlation coefficient (MCC) in comparison with rip. Furthermore, we can report improvements compared to the existing alignment interaction programs, see. The exception here is the PPV 0.7857 achieved by PETcofold +. Comparison of the predicted interaction () shows that ripalign and PETcofold  produce a similar result and agree well with the natural structure derived in Argaman and Altuvia (2000). In contrast, rip and PETcofold + predict joint structures that differ significantly from Argaman and Altuvia (2000). We display for ripalign each contact region having a probability > 10% and accordingly highlight infour distinct contact regions. The two additional contact regions, identified in the partition function, exhibit a significantly lower probability. An additional hairpin over Ris predicted in OxyS, instead of the unpaired segment occurring in the natural structure, can be understood in the context of minimizing free energy.
The CopT/CopA interactionIt is known that the antisense RNA CopA binds to the leader region of the repA mRNA. The target here is named CopT (). In lack of MSA for CopT /CopA, we cannot utilize the full potential of ripalign; however, the interaction is wellthe PETcofold + structure and (D) the joint structure as predicted by ripalign based on the entire MSA. Target site (grey blocks) probabilities [as detailed in Section 4 of Supplementary Material, Equation (5.5)], computed by ripalign, are annotated explicitly if they exceed 10% or just by  10%, otherwise. known and included for reference purposes. The quality of the prediction is comparable to that of PETcofold + , PETcofold  or InteRNA, see. CopT /CopA exhibits two distinct interactions. While the first (main) interaction is correctly identified as Jby ripalign, the second interaction is ranked fifth, J Hy 54,57;53,56 with a probability of 6.14%, see.
The U4/U6 interactionU4 and U6 are two spliceosomal RNAs (snRNAs) that are known to be involved in splicing pre-mRNA. For at least a quarter century, these two ncRNA molecules have been conjectured to interact. The precise nature of their interaction and related proteins is still the subject of investigation.Adopting an evolutionary perspective, we notice that there are significant distinctions between the different clades (ranging from simple protostomes to higher deuterostomes) in which this interaction is described (). We find for, instance, a discussed 5' stem of U6 as well as stem I between U4 and U6. Furthermore, even within e.g. human a third interaction (stem III) is discussed (A. Bindereif and S. Rader, personal communication).shows a consensus of the previously described U4/U6 interactions. We divide all known metazoan U4 and U6 snRNAs into three distinct groups and alignments: protostomia without insects, insects and deuterostomia.observed that insects behave in their secondary structure different from other protostomes. Comparing all predicted U4/U6 interactions, displayed inE, we draw the following conclusions:(i) The secondary partial structures of the U4/U6 complex for all three groups predicted by ripalign agree predominantly with the described secondary structures in metazoans: Stem I and II are conserved at present, as well as the four commonly described hairpins.(ii) For all three groups, Stem II (, top) is highly conserved. External ascendancies, such as protein interactions are discussed to stabilize Stem II additionally. Stem I is also highly conserved except for insects, which agrees with the literature.(iii) For all three groups, the 5 hairpin of U4 snRNA seems highly conserved to interact with the U6 snRNA ('N'). This RNA feature is not fully understood, since this element is also believed to contain intraloop interactions and may bind to a 15.5-kDa protein ().(iv) For all metazoans, the U6 snRNA shows conserved intramolecular interactions (3'stem '3's').(v) Stem III () seems to be not a conserved feature; however; the same region of U6 interacts in deuterostomes significantly with a probability of 24.3% in higher metazoans with the central stem loop of U4 (, 'J').(6) For both: protostomia (without insects) and deuterostomes, the 5 hairpin of U6 snRNA seems to interact with the U4 3 hairpin ('M'). However, this observation does not hold for insects, which agrees with a systematically different secondary structure of spliceosomal RNAs in insects (). Since the three divergent groups of metazoans independently exhibit analogous secondary structure features, ripalign has led to observations (3)(6), potentially having biological relevance.
Page: 461 456463
RNARNA interaction
The SmY-10/SL-1 interaction of Caenorhabditis elegansOur case studies show that ripalign improves the prediction of interaction regions significantly at the expense of computational cost. The case studies of the fhlA/OxyS and the CopT /CopA interaction show that ripalign's full potential comes to bear when MSAs are present. It is then that our method can reliably predict the joint secondary structures. We remark that structure prediction is just part of the ripalign-functionalities. Derived thermodynamic quantities, in particular the base pairing and hybrid probabilities, are also useful in a variety of ways. For instance, they help to improve the accuracy of other software tools such as RactIP (). The quality of prediction depends critically on the quality of the MSAs. The issue of alignment quality is not easily solved: creating an alignment without knowing the structure is unlikely to produce a structural alignment. In this work, we mainly used handmade alignments considering sequence and structure derived from literature knowledge. In case of automatically derived alignments, it might be an option to realign the sequences of an RNA family taking both the predicted secondary structures and predicted joint structure with other RNA families into consideration. Clearly, ripalign is limited by its a priori output class of joint structures and can in particular not identify any joint structures exhibiting pseudoknots. To save computational resources, we stipulate that only alignment positions contribute as indices and loop sizes. This assumption may cause the existence of some interior arcs R i R j having arc length smaller than three. However,showed that this problem can be improved substantially by introducing a different, more rational handling of alignment gaps, and by replacing the rather simplistic model of covariance scoring with more sophisticated RIBOSUM-like scoring matrices.makes evident that approximation algorithms are much faster. For instance PETcofold (, b), has a time complexity of O(m(N +M) 3 n), where m is the number of sequences in the MSA, N and M being the sequence lengths of the longer and shorter alignment, respectively, and n < N/2 is the number of iterations for the adaption of the threshold value to find likely partial secondary structures. Their basic assumption of PETcofold being that the two secondary structures fold independently and that intra-loop evaluation differences are negligible. The flip side of reducing the complexity of a folding problem by introducing additional assumptions, is the uncertainty of the quality of the labeled with Sm).
and SmY-10 of C.elegans. The Sm-binding sites (black frames labeled with Sm) in the RNA molecules SmY-10 and SL-1are 5 AAUUUUUG3 (R) and 3 GUUUUAA5 (S), respectively. The joint structure contains a single interior arc S 24 S 67 (A), which is predicted by rip implemented by. The joint structure (B) is predicted by ripalign without any structural constraints. The joint structure (C) is predicted by ripalign under the structural constraints that 5 AAUUUUUG3 (R) and 3 GUUUUAA5 (S) are Sm-binding sites in the RNA molecules SmY-10 and SL-1, respectively. The target site (grey blocks) probabilities computed by ripalign are annotated explicitly if > 10% or just by  10%, otherwise. solution. Point in case here is that arguably the two secondary structures did not evolve independently, but rather correlated by means of their functional interaction. The RNARNA interaction problem exhibits a challenge long absent from the folding of RNA secondary structures: the time efficient folding of MFE configurations. While the O(N 3 ) time complexity of the latter is, even for long sequences, easy to work with, it is clear that the O(N 6 ) time complexity of the former has to be improved. At present, the only alternative to the DP-paradigm are heuristic-based algorithms and both approaches complement each other well. When encountering new scenarios, like the U4/U6 interaction or the SmY-10/SL-1 interaction of C.elegans, it seems however safer to explore the entire configuration space and make use of statistical information via the partition functioneven at the high computational cost. For the U4/U6 and the SmY-10/SL-1 interaction, ripalign offers a detailed picture of the interaction and identifies potential interaction regions. Within its complexity limitations, ripalign is capable capturing the entire space of RNA interaction structures and allows to reconstruct the latter via Boltzmann sampling. It is likely that the next milestone for RNARNA folding algorithms lies neither in DP-foldings nor in heuristics. Deeper structural understanding of the landscape generated by arc-configurations over fixed sequence alignments is the key here. Advances on this topic will eventually lead to provable error bounds and thereby simultaneously make the DP-paradigm and heuristics obsolete. At the same time, this might allow us to understand the ad hoc definition of joint structures due to, which is intimately connected to the topology of the configuration.
The Author 2010. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oup.com at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
MacMorris et al. (2007) stipulated that SmY-10 RNA, is possibly involved in trans-splicing, interacts with the splice leader RNA (SL-1 RNA). This interaction has never been identified before. In Figure 7, we show that the Sm-binding sites of the RNA molecules SmY-10 and SL-1 are R[56,62] and S[25,31], respectively. In Figure 7A, the structure is being predicted by rip (Huang et al., 2010). We observe two unsatisfying phenomena: a stack in SmY-10 is formed by a single intra arc S 24 S 67 and there exist intra arcs in the Sm-binding sites. The canonical grammar presented here restricts the configuration ensemble to canonical joint structures, resulting in the structure presented in Figure 7B in which the peculiar isolated interaction arc disappears. However, the nucleotides of the Sm-binding sites still form either intra or inter-molecular base pairs. Incorporating the structural constraints option, we derive the structure displayed in Fig. 7C. Here the Sm-binding sites are constrainted to be single stranded. Since the predicted interactions have either a low probability or consist of two base pairs only, we conclude that if SmY-10 is interacting with SL-1 in vivo, this interaction has to be stabilized further by e.g. proteins.
