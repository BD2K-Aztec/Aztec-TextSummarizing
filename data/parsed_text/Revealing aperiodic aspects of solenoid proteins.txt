Motivation: Repeat proteins, which contain multiple repeats of short sequence motifs, form a large but seldom-studied group of proteins. Methods focusing on the analysis of 3D structures of such proteins identified many subtle effects in length distribution of individual motifs that are important for their functions. However, similar analysis was yet not applied to the vast majority of repeat proteins with unknown 3D structures, mostly because of the extreme diversity of the underlying motifs and the resulting difficulty to detect those. Results: We developed FAIT, a sequence-based algorithm for the precise assignment of individual repeats in repeat proteins and introduced a framework to classify and compare aperiodicity patterns for large protein families. FAIT extracts repeat positions by post-processing FFAS alignment matrices with image processing methods. On examples of proteins with Leucine Rich Repeat (LRR) domains and other solenoids like proteins, we show that the automated analysis with FAIT correctly identifies exact lengths of individual repeats based entirely on sequence information.
IntroductionAlmost 20%, of all plant and animal, including human, proteins are entirely built from or contain large domains that consist of multiple repeats of short sequence motifs (). These repeated motifs typically contain between 3 and 40 amino acids and cannot form independent structures by themselves (). A subset of repeat proteins that folds into solenoid-like structures have motif lengths typically in the range of 2040 amino acids. Since all repeats in any given protein are homologous, it is often assumed that their lengths would be constant and, even if not, the small differences in the length of individual motifs are usually treated as noise. However, when a few available 3D structures of solenoid proteins were analyzed, it was shown that small length variations of 15 amino acids between individual motifs can modify structure in subtle but functionally important ways. For instance, structures of the Leucine Rich Repeat (LRR) family are all known to fold into curved solenoid (), horseshoe-like structures and small motif length variations affect their local curvature () and, hence, the specific shape of the binding cavity and their binding specificity. This feature of LRR proteins is being explored in in silico design of artificial solenoid-like proteins with desired shapes and curvatures (). The interest in detecting and analyzing repeat proteins grew over the last decade as more functionally important groups of such proteins were discovered. This led to the development of many methods for their recognition and analysis based, among others, on self-alignmentRADAR (), HMMsHHRepID (), self-comparison approaches based on tiling () or predefined databases and Fourier transformation Repetita (). Results of such structure analysis now available in dedicated resources such as the RepeatDB database (), as analyzed with Raphael (). However, nearly all methods focused on the first step of the analysisdetecting the motifsand not on identifying exact lengths and variations thereof. At the same time, detecting variations in periodic signals in other fields, such as cardiographic signals or intense sunspot activities that oscillate with an approximate period of 11 years, but with significant variations, created a large repertoire of mathematical frameworks that can be applied to detect length variability in solenoidlike proteins (). Here, we present a novel approach called FFAS-based Aperiodicity detection using Image-processing Techniques (FAIT) for the in detail analysis of solenoid like proteins. FAIT is an adaptation of image-processing algorithms to the post-processing the graphic representation of results of the sensitive profileprofile alignment method FFAS developed previously in our group (). We analyze FAIT's performance comparing FAIT to annotations from our structure-based tool, ConSole (), since no standard benchmark exists that contains information about positions and lengths of individual repeat units for sufficiently large sets of proteins. Finally, we use FAIT to analyze variability of several large families of solenoid proteins.
Aperiodicity profilesIn our previous publication, we introduced a concept of aperiodicity profiles of solenoid-like protein structures to describe their precise variation in solenoid motif lengths (). These are plots of motif lengths, indicating the variability between individual solenoid units. Properties of repeat structures include the mean unit length k l and the lengths of individual units k i , which can also be described as differences from the mean length. Differences from k l are specific for individual repeats, describing how they vary from the average repeat motif length. They can be indicative for presence of binding sites or local curvature of the protein, distinguishing specific individual repeats from other repeats of the same family. For instance, aperiodicity in the TLR4 profile (2Z64) indicates the binding region to MD2 with variable electrostatic potential in several species (). Analysis of these parameters allowed us to automatically highlight aperiodic regions in solenoid structures and identify their specific aperiodicity signatures. Here, we first benchmark FAIT's sequence-derived aperiodicity profiles by comparing them to more-accurate structure-based methods. We also introduce a novel aperiodicity score, the area A under the aperiodicity profile curve, to use in a large-scale analysis of the aperiodicity in LRR proteins (see Section 2 for details). Flat aperiodicity profiles and hence low A scores indicate periodic structures, while profiles with many peaks and hence high A scores are an indicator for highly aperiodic structures. For instance, A allows us to automatically sort structures by their aperiodicity (). We use aperiodicity profiles and A scores as descriptors to benchmark FAIT and to analyze large protein families.
Reference sequenceThe matrix analysis described below relies on the fact that starts and ends of individual solenoid units in the reference protein are known from structure analysis. For LRRs, we selected Listeria internalin (PDB id: 2OMZ, chain A) as the reference protein. The LRR domain in this structure is relatively long and consists of n  15 LRR units. Internalins are ideally periodic LRR structures, so that:Hence, 2OMZ provides a robust reference for detecting aperiodicity in LRRs. The whole protein was manually truncated to the LRR domain, which was extracted from the 2OMZ structure, and all LRR unit start positions were labeled in the sequence based on the ConSole results. For Ankyrin and Armadillo sequences, we similarly extracted positions from the structures 1AWC-B and 3TJ3-A, respectively.
Matrix processingElucidating LRR aperiodicity from the profileprofile scoring matrix M () involves several steps modeled after image processing. In the following description, we will refer to each matrix value at position i,j as pixel p i,j. 1. We apply an averaging filter to amplify local similarity at each position (). The averaging filter calculates the mean value of 10 pixels along the diagonal fragment [p i,j; p i  10,j  10 ]. High values detected for such diagonals indicate regions of high local similarity between corresponding regions of two compared sequences (or profiles). 2. Because repeat unit positions in the reference sequence are known, we now split the whole matrix into several submatrices SM with the size of k reference  m, where k reference is the length of the repeat unit in 2OMZ and m is the length of the analyzed protein. 3. We calculate the average matrix AM of all SM: AM  R i N SM i (). Strong similarities, now visible on some diagonals, indicate high local sequence similarities. This approach to reveal strong features in the matrix is similar to noise-reduction in signal or image processing as it is done by averaging images acquired by cryo electron microscopes for instance (Hrabe and F rster, 2011). 4. We use the discrete Laplace operator filter to amplify diagonals (.4). The Laplace filter is a standard image-processing technique to detect edges in an image (). The outcome of the convolution is matrix L (5. Finally, we average over the first five rows of L to analyze similarity between the query sequence and the static LxLxx pattern of the internalin LRR unit ().
Signal processingAs a result of the steps described in the previous paragraph, we obtain a 1D signal of identical length as the query sequence length (). High values of the signal indicate high similarity to starts of the LRR units in the reference protein. Hence, by extracting positions of these peaks, one can find start positions of units in the query sequence. We use the signal statistics to detect peaks in the. Processing the profileprofile scoring matrix from its original state (1) to the final signal (5) where LRR units can be detected. The respective steps (15) are described in more detail in the main text. (5) Peaks in the final signal are indicators for the starting positions of the LRR units in the query sequence. The highest peak in the profile identifies positions of two engineered residues in the 2OMZ sequenceRevealing aperiodic aspects of solenoid proteinssignal. We define significant peaks as values larger than 2r of the signal over the query sequence length. The average distance between the detected peaks corresponds to the mean unit length k l. The method accepts k l as a valid unit length if it falls within the known unit length intervalsfor LRRs,for Ankyrin andfor Armadillo (). If k l is not within that interval, the r signal factor used in unit detection is gradually decreased. If a valid value of k l is still not found at 1r, the query sequence is classified as a non-LRR. Once k l is known, we iteratively identify LRR units from peaks in the signal. Here, a numeric optimization method starts detection at the first peak and optimizes Equation (5) to detect individual units:Starting at the first peak with position i and a signal value v i , the unit length j is sampled within the k l  d; k l  d   interval, where d specifies the maximum length of a unit. The only predefined parameter in FAIT and is set to d  k l =2. Once a highest scored unit is assigned to residue i, the method continues at position i  j 1.
Similarity of aperiodicity profilesIn order to compare two aperiodicity profiles, we calculate the profile similarity s with a sliding L 2 window. Here, we slide the shorter profile p 1 along the longer profile p 2 and detect the minimal Euclidean distance for all overlapping regions, where N is the number of elements in the shorter sequence p 1 and M the number of elements in the longer sequence p 2 :We experimented with a similar approach by calculating the correlation of p 1 and p 2 , but the L 2 norm yields more stable results. The problem with normalized correlation is that the similarity of two vectors where one has all identical elements is not defined. Correlation becomes not meaningful for extremely periodic proteins, and hence L 2 is a more stable score in this application. Finally, each element in each profile is the respective difference k ui k l measured in amino acids (aa); then, the unit of s is aa, too.shows a high aperiodicity, and both indicate aperiodicity at the same LRR units. Profile similarity equals 0.17. (c) Mouse Nod-like receptor 4 (4KXF-B) structure with its N-terminal LRR domain. Profile similarity equals 0.39. (d) Structure of bacterial LRR human gut symbionts with unknown function (4F0D-A). Unusually for LRRs, the structure is not curved and haves rather linear LRR domains with varying LRR unit lengths. The similarity between FAIT and ConSole profiles are 0.32. Ankyrin box: (e) 4UUC-A structure with a profile similarity of 0.33. Armadillo box: (f) 3TJ3-A structure with a profile similarity of 0.54. Highlighted repeat units in sequence of all six structures are presented in the Supplementary Material
Aperiodicity score AThe aperiodicity score A used for sorting structures inis defined as the area under the aperiodicity profile:where N is the length of the aperiodicity profile.
Results
Benchmark based on aperiodicity profiles from structureIn order to benchmark FAIT, we compared its sequence-based aperiodicity profiles against structure-based profiles from our structurebased method, ConSole. A total of 54 LRR, 148 Ankyrin and 80 Armadillo proteins were used to compare aperiodicity profiles derived directly from structure (Console) to analogous profiles predicted from sequence (FAIT). For all structures, we could identify the error distribution for the profiles as an average profile difference of 0.6 aa and a standard deviation of 0.41 aa, as detected by Equation (6). Moreover, profile lengths differed by 2 aa on average.depicts structures and their compared aperiodicity profiles. Our results indicate that aperiodicity profiles detected with FAIT are in good agreement with the ones detected from structures with ConSole.
Comparing FAIT and HHRepIDWe compared FAIT to HHRepID repeat detector (). HHRepID is probably the conceptually most similar method from all the repeat detection algorithms, as the HMMHMM comparison not only detects any repeat motifs in a sequence, but returns positions of repeat units as well. Hence, for direct comparison, HHRepID was applied to generate aperiodicity profiles for the identical LRR dataset used to benchmark FAIT. Here, we show that FAIT clearly outperforms HHRepID (). For instance, for the ribonuclease inhibitor (PDB ID 1A4Y-A), HHRepID returns unit some lengths as long as 57 aa. This result is not satisfactory as it ignores the fact that these 57 aa contains two LRR units that vary in length between 28 aa and 29 aa, as shown by FAIT (). Similar effects could be observed for Armadillo repeats. Results for Ankyrin repeats, however, were in good agreement for both methods. This must be attributed to the low, intrinsic aperiodicity of the whole protein family, which we also observed in our previously study (). While HHRepID performs well as a generalized repeat detector from sequence, it underperforms in detecting individual repeat units in sequence. HHRepID with other sequence-based methods such as RADAR, Repettita or Tiling were developed and benchmarked for the general purpose of detecting whole repeat domains in sequence, and were not specifically tailored to detect individual repeat units and their lengths ().
Model bias analysisIn order to analyze FAIT's sensitivity to the type of reference used for analysis, we varied the reference sequence for detecting LRR units. Specifically, we used the Ankyrin (PDB: 1AWC-B) sequence as reference for FAIT analysis. Ankyrin proteins also form solenoidlike structures, but their sequence does not resemble any LRR pattern and their structures significantly differ from LRR structures. The difference between the Ankyrin-based FAIT and ConSole profiles detected by the sliding Euclidean score was significantly larger than using the LRR 2OMZ-A as reference. The average difference between aperiodicity profiles was 1.62 aa with a standard deviation of 2.67 aa.). The distribution of k l and A score determines the position of each subfamily cluster in the plot. The cluster centers are determined by the mean values of k l and A score and the cluster width by corresponding standard deviations in the cluster. Structures of the bacterial internalin family and the ribonuclease inhibitor family form clusters in the lower A-score regions, with the ribonuclease inhibitor cluster overlapping the NLR subfamily cluster (not shown). TLR structures generally have a higher aperiodicity (they form clusters in higher A-score regions). LRR structures from human gut show the largest aperiodicity of all subfamilies. The positions and widths of FAIT-based clusters are highly correlated with structure-based results
Revealing aperiodic aspects of solenoid proteins
Pan-family LRR analysisThe intended application of FAIT was to analyze large protein families, with most proteins known only on the sequence level. Here, we analyzed various LRR subfamilies ranging from ideally periodic internalin proteins to highly aperiodic TLR proteins and generated aperiodicity profiles in each subfamily based entirely on sequence information. Aperiodicity profiles were generated for subfamily specific structures and sequences.shows a comparison of structure-and sequence-based aperiodicity analysis. The plot confirms our previous observations about existence of several subfamilies of LRR proteins and hence corroborates the robustness of FAIT:(i) human NLRs and ribonuclease inhibitors have a repeat-unit length of 28 aa and generally a low aperiodicity, (ii) internalins are known to have short unit lengths of typically 22 aa, and (iii) human TLRs cluster around a unit length of 24 aa and have a larger aperiodicity than all previously discussed subfamilies. In addition, our results show that bacterial LRRs from human gut symbionts have the largest aperiodicity we observed in our analysis and are systematically different both from TLR and NLR-like proteins. Again, as shown in, FAIT analysis of sequences is highly correlated with structure-based results from ConSole and validates the robustness of our method.
ConclusionFAIT is a novel method developed to analyze variations in length of individual repeats in solenoid-like proteins, and it is the first method developed specifically to detect it only from sequences. It can, therefore, be used to analyze proteins from newly sequenced genomes and/or large families that were never structurally characterized. It uses information from the profileprofile alignment scoring matrix calculated with FFAS and extracts subtle variations of individual repeats with image-processing algorithms. FAIT was benchmarked against an established structure-based method and shown to give results closely correlated with those obtained using structural data. This allows it to be used on much larger groups of proteins, as 3D structures of only a very small percentage of all repeat proteins are known. HHRepID is probably the sequence-based method with the most similar annotation detail, but as nearly all existing methods it was developed to detect repeat domains and not to specifically provide exact positions of individual units as FAIT. Hence, the major difference between existing methods and FAIT is the analysis of individual units, not the detection of repetitive domains in sequence. Using a previously annotated protein as reference in FFAS comparison is the key feature of our approach, as it allows us to precisely detect individual repeats. Our results indicate that while varying references for cross-family experiments yields valuable results, to get the best results possible it is preferable to use a familyspecific reference. Hence, using annotated reference protein seems to be a required step to increase the resolution in analyzing repeat sequences. We mainly demonstrate the proof of concept of our algorithm on the large LRR protein family, using a previously annotated, long and extremely periodic sequence. However, results on other solenoid-like protein families such as Ankyrin and Armadillo repeats indicate that the FAIT procedure can be readily adapted to other protein families with one previously annotated sequence and known length of repeat motifs. In FAIT, we also introduce a novel framework using the A score and aperiodicity profiles to analyze large groups of solenoid-like proteins and group them by their variability, allowing us to investigate structural and sequence flexibility in more detail than currently possible on the PDBFlex.org webserver (). We performed such analysis to visualize aperiodicity in subfamilies of LRRs. These results also provided additional validation of our method since we compared clustering according to FAIT with structure-based clustering and showed that they are highly correlated. We are currently conducting a larger study in which we use FAIT to analyze the evolution of aperiodicity in NLR and TLR families. As all of our previous methods, FAIT is currently available as an open-source package, and will be extended in a future web-server implementation that automatically distinguishes between multiple solenoid families.
Bioinformatics, 2016, 17 doi: 10.1093/bioinformatics/btw319 Advance Access Publication Date: 9 June 2016 Original Paper Bioinformatics Advance Access published June 22, 2016 at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
Methods Detection of aperiodicity patterns with FAIT is based on a customized signal-processing pipeline where the FFAS-generated profile profile scoring matrix M (Wilson, 1996) is enhanced with imageprocessing techniques to reveal positions of repeat units in the query sequence. The FFAS program (Jaroszewski et al., 2011), similarly to other sequence alignment algorithms, returns the sequence alignment as the main output, but the full scoring matrix used to generate the alignment can also be exported. Visualization of such matrices was used in many early protein and nucleic acid alignment programs to manually identify the alignment in a method referred to as a dotplot analysis (Vingron and Argos, 1991), but its popularity waned with improvement of the automated methods for alignment identification. Here, we identify and enhance repetitive patterns in a profileprofile scoring matrix using image-processing tools. A scoring matrix M is an n-by-m matrix, with n being the length of the reference protein sequence, and m being the length of the query protein sequence. In a classical alignment problem, values at position i,j in M are the result of comparing query sequence residue Q at position i and the reference sequence residue R at position j: M i;j  BQj; Rj (1) where B is an amino acid substitution matrix. An optimal path through matrix M, i.e. the alignment, is typically found by dynamic programming (Wilson, 1996). This approach can be generalized to a profileprofile scoring matrix in which positions in the two profiles being compared are described by vectors rather than amino acids (Rychlewski et al., 2000; Xu et al., 2014). Values at position i,j in the scoring matrix are now determined using a matrixvector product defined as: M i;j  ~ v 2;j  B  ~ v 1;i ; (2) where ~ v 1;i is a vector describing a sequence variation at position ith in the reference protein sequence, B is the amino acid substitution matrix [BLOSUM62 substitution matrix (Henikoff and Henikoff, 1992) in FFAS], and ~ v 2;j is a vector describing a sequence variation at the jth position in the query sequence (Xu et al., 2014). Fig. 1. Several LRR structures sorted by their respective profile area A score. Ideally periodic internalin structures (1H6T A  0, 2OMZ A  0) have a low A score. Ribonuclease inhibitors (1A4Y A  0.5) show a larger degree of aperiodicity with their k i fluctuating between 28 aa and 29 aa. Structures with higher aperiodicity such as the TLR4 (2Z6A A  1.5) or TLR5 (3J0A A  2.1) have larger A scores
at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
