Motivation: Changes in the normal rhythm of a human heart may result in different cardiac arrhythmias, which may be immediately fatal or cause irreparable damage to the heart sustained over long periods of time. Therefore, the ability to automatically identify arrhyth-mias from ECG recordings is important for clinical diagnosis and treatment. In this article, classification by using associative Petri net (APN) for personalized ECG-arrhythmia-pattern identification is proposed for the first time in literature. Results: A rule-based classification model and reasoning algorithm of APN are created for ECG arrhythmias classification. The performance evaluation using MIT-BIH arrhythmia database shows that our approach compares well with other reported studies.
INTRODUCTIONHeart disease is an umbrella term for a number of different diseases which affect the heart such as arrhythmia, myocardial ischemia and myocardial infarction (). As of 2007, it is also one of the leading causes of death in the world, and especially according to the American Heart Association, One American is dying in every 34 s because of this disease (). Changes in the normal rhythm of a human heart may result in different cardiac arrhythmias, which may be immediately fatal or cause irreparable damage to the heart when sustained over long periods of time. Electrocardiogram (ECG) is an important routine clinical practice for continuous monitoring of cardiac activities. Since ECG signals vary greatly for different individuals and within patient groups (), ECG-pattern recognition is a difficult problem even with the aid of a computer. While normal sinus rhythm originates from the sinus node of heart, arrhythmias have various origins and indicate a wide variety of heart problems. Same symptoms of arrhythmia produce different morphologies due to their origins such as premature ventricular contraction (). For effective diagnostics, the study of ECG pattern and heart-rate-variability signal may have to be carried out over several hours. Thus, computer-based analysis and classification of diseases can be very helpful in diagnostics (Guer and U  beyli, 2005;). A number of methods have been proposed to classify ECG-heartbeat patterns based on the features extracted from ECG signals. APNs have knowledge representation ability and could be translated into production rule systems. In addition, the APN formalism also is a graphical and mathematical tool for design, specification, simulation and verification of systems. Therefore, APN can be widely used in computer, knowledge-based systems, process control, decision making as well as other kinds of engineering applications. In this article, classification of ECG arrhythmias by using associative Petri net (APN) is proposed for the first time in the literature and is compared with several pioneering studies for arrhythmias detection.
RELATED WORKAn ECG is a graphic produced by an electrocardiograph. A single normal cycle of the ECG represents the successive arterial depolarization and ventricular repolarization, and can be approximately associated with the peaks and other ECG waveforms, which labeled P, Q, R, S and T (). Recently, different characteristic, such as P, T, U waves and PQ, QRS, ST segments, are also used for diagnostics (). Automated classification of heartbeats has been previously reported by other investigators using a variety of features to represent the ECG and a number of classification methods. Features include RR-Interval features, heartbeat-interval features and ECG-morphology features (), ST-segment deviation,-segment slope (STS),-segment area (STA), T-normal amplitude (), STA, RS interval (RSI), STS, RT interval (RTI), QRS area (QRSA), Q T interval (QTI), R-wave amplitude (RWA), heart-beat rate (HBR), statistical features QRS energy (QRSE), mean of the power spectral density (MPSD), auto-correlation coefficient (ACC), signal histogram (SH) (), discrete Fourier transform coefficients (DFT) (Dokur and O  lmez, 2001), statistical features of the QRS complexes (), Hermite coefficients (), shift-invariant (), continuous wavelet transform coefficients (), QRS complex wave width (), amplitude value, DCT coefficients, DWT coefficients () and DWT coefficients (Abawajy *To whom correspondence should be addressed; Inan and U  beyl, 2005). In addition, the classification of heartbeats employed include linear discriminants (), association rules (), neural network (1 Dokur and O  lmez,; Inan and U  beyl, 2005), fuzzy neural network (), hidden Markov models (), mirrored Gauss model (), artificial immune-recognition system (), support vector machine () and dynamic time warping (), cluster analysis (), NeuroSVMKNN fusion (), LibLINEAR, LibSVM () and Principal component analysis, Linear discriminant analysis, Independent component analysis (). Recent studies developed new feature-extracted and classification methods to detect various heart-related diseases and other complications by analyzing ECG characteristics.use two innovative modified Hilbert transform-based algorithms to extracted QRS complexes and end-systolic enddiastolic pulses for detecting acute hypotensive episodes and mean arterial pressure dropping regimes. A new classification tree based on conditions combinations competition (T-3C) is proposed for the accurate diagnosis of cardiac ischemia and five measurements were considered in their study ().use Bayesian framework to develop an adaptive Kalman filter. The adaptive estimation of the process and measurement noise covariance is performed by maximizing the Bayesian evidence function of the sequential ECG estimation. Sufi and Khalil (2011) use data mining techniques, to perform a real-time classification of cardiovascular disease.use Bayesian algorithm combined with a Markov chain Monte Carlo method to detection and delineation of ECG signals. Recently, association rules have been utilized for the extraction of knowledge from medical history and for the analysis of medical signals (). An APN incorporated the concepts and operations of association algorithm of Aprioriand can represent the associative production rules of a rule-based system. Therefore, an adoption of APNs () in reasoning and classification of ECG arrhythmias is straightforward in this article.
MATERIALS AND METHODSThis section is a brief description of methods used in this research such as a statistical sampling method, membership function generation by Minimize Entropy Principle Approach (MEPA) and reasoning process of ECG signals by proposed APN.
DatasetPhysioNet's MIT-BIH Arrhythmia Database () contains 48 half-hour excerpts of two-channel ambulatory ECG recordings, obtained from 47 subjects (records 201 and 202 are from the same subject) studied by the BIH Arrhythmia Laboratory between 1975 and 1979. Of these, 23 recordings were chosen at random from a collection of44000 Holter tapes, and the other 25 recordings were selected to include examples of uncommon but clinically important arrhythmias that would not be well represented in a small random sample. These groups comprise men and women between the ages of 23 and 89, and are analyzed by two independent cardiologists who use nomenclature to classify them by the types of beats and rhythms. Our selected heartbeat clusters are classified into the eleven heartbeat types including one normal and various abnormal types as shown in.
MEPAIn this section, an MEPA is adopted to provide the persuasiveness of determining the length of intervals and membership functions in heartbeat patterns. Assume that a threshold value is sought for a sample in the range between x 1 and x 2. An entropy equation with each value of x is written for the regions, respectively. A value of x that gives the minimum entropy is the optimum threshold value. The value estimates of f k (x) and g k (x), f(x) and g(x), are calculated as follows:where n k (x)  number of class k samples located in, we can determine the values of entropy for each position of x, as in. The value in the region that holds the minimum entropy is called the primary threshold (PRI) value. If we denote a secondary threshold in one area such as SEC1 and the other secondary threshold in another area will be SEC2. In order to develop seven partitions, we need tertiary threshold values and denoted as TER1, TER2, TER3 and TER4. The induction is performed by the entropy minimization principle, which clusters most optimally the parameters corresponding to the output classes (). By minimizing the entropy, we can find intervals in which the distribution of samples of any class is as relatively uniform as possible.
APN modelClassification using APN was applied for the detection of arrhythmia beats. APN is defined as follows ().
Definition of APNAn APN is a directed graph, which contains three types of nodes: places, squares and transitions. Where circles represent places, squares represent thresholds of association degree and bars represent transitions. Each place may contain a token associated with a truth-value between zero and one. Each transition is associated with a certainty factor (CF) value between zero and one. Directed arcs represent the relationships between places. A generalized APN structure can be defined as a 13-tuple and the APN can be mathematically and graphically illustrated in. Let A be a set of directed arcs. If p j 2 I(t i ), then there exists a directed arc a ji , a ji 2 A, from the place p j to the transition t i. If p k 2 O(t i ), then there exists a directed arc a ik , a ik A, from the transition t i to the place p k. If W(s m )  w m , w m 2, then the support sm is said to be associated with a real value w m. If G(t i )  c i , c i , 2, then the transition t i is said to be associated with a real value c i. If (p j )  d j , d j 2 D, then the place p j is said to be associated with the proposition d j. An APN with some places containing tokens is called a marked APN. In a marked APN, the token in a place p j is represented by a labeled dot pj : The token value in a place p j , p j 2 P, is denoted by (p j ), where (p j ) 2. If (p j )  y i and (p j )  d j , then it indicates that the proposition d j is y i. According to the antecedent portion or consequence portion of an APR contains 'and' or 'or' connectors, the APRs has five rule types ().
Associative transition function Let IT {i 1 , i 2 ,. .. ,i m } be a set of items and DT be a set of database transactions. An association rule is an implication of the form A!B, where A & IT, B & IT and A \ B  : The association rule A!B holds in the transaction set DT with support s, where s is the percentage of transactions in DT that contain A [ B: This is taken to be the probability PA [ B: The association rule A!B has confidence c in the transaction set DT if c is the percentage of transactions in DT containing A that also contain B. This is taken to be the conditional probability P(BjA) (). That is,Typically, association rules are considered interesting if they satisfy both a minimum support threshold m , m 2 0, 1, and a minimum confidence threshold i , i 2 0, 1: If the values of support and confidence are higher than their threshold and , the transition is enabled and the CF value of transition is corresponding to its confidence value (CF  c i ) else the relationship does not exist (CF  0). A generalized formulation of the CF is shown in Equation (11):where c i is the confidence value, i is a threshold of confidence, s m is the support value and m is a threshold of support.). The threshold of degree of truth of each proposition is given as. If (p x ) ! x , then the proposition d x is existed. Assume that the thresholds of support and confidence degree are given with and. If s xy ! xy and c xy ! xy , then the transition is fired. A reasoning algorithm of APN can generate reasoning paths from starting place p s , to goal place p g as described below. Reasoning Algorithm of APN DEFINITION. Let V be a set of successful reasoning paths and v is a successful reasoning path, v 2 V. The proposition of goal place p g is d g (v) and
Reasoning process) is the degree of truth of p g (v) if and only if there exist a successful reasoning paths from starting place to goal place., C, T,  and  are a finite set of places, propositions, transitions, supports, confidences, thresholds of support and thresholds of confidence. OUTPUT. The proposition (p g )  d g and the degree of truth of (p g ) in a goal place. //Step 1: From starting place p s The starting place (p s ,) is a non-terminal place, whereThe path is called a successful reasoning path.Else IF AP ik  {p a , p b ,. .. , p z }, and p g 2 RS(p k ) THEN Let g  Min {(p a ) * c ak , (p b ) * c bk ,. .. and)} be the degree of truth of proposition in p g. //Step 5: At goal place p g The proposition is (p g )  d g , and the degree of truth is (p g )  z.
EXPERIMENTThe experimental procedure for arrhythmia-beat detection is divided into ECG filtering and sampling, feature extraction, transfer function building and classification.
ECG filtering and samplingFirst, we use a non-linear bilateral filter () to remove noise. The sampling size of our dataset has been estimated by the population ratio ():where n is the sampling size, P is the estimator, e is the sampling error, is the confidence coefficient and z is the standard normal probability distribution. Since there is no further study in the estimation of an ECG beat will be the abnormal beat's probability. Therefore, we use non-constant number sampling to obtain the abnormal beat's proportion of population in ten time's trial, which is shown in. From Table 2, we can obtain an abnormal beat's estimator (population proportion expected value) as follow:where C i is beat weight that is the sample proportion of sampling i time, P i is abnormal ratio of sampling i time. C i and P i are shown in. Substitute P-value, with 0.95 confidence levels and 0.02 sampling error in y sampling beat in different group, as shown in, we obtained 553 beat (with 120 normal and 433 abnormal) in our sampling data set. By randomly select, about twothirds (67.5%) of the data set are used to training our proposed APN knowledge model and one-third (32.5%) of the data set are used to evaluate the proposed APN model.
Feature extractionSelected features are important in enhancing the performance of ECG arrhythmia-beat detection. After detailed survey, we used the features listed infor our prototyping. The steps of detecting peaks are (i) calculating the moving average from original signal, and usually using the past ten records to calculate it; (ii) subtracting moving average from original signal, and getting a new signal; (iii) finding the peak of the signal; and (iv) setting the threshold to decide the detected peaks. As soon as the peak 'R' determined, we can obtain peaks P, Q, S and T through their relative position. In order to prevent possible error, peaks' amplitude would be measured from k line as shown in(). The definition of k line is in Equation (13).where k is a baseline, is the greatest amplitude of all peak, i is type of heartbeat and c is a constant. Therefore, the amplitude of peaks P, Q, R, S and T are all homogeneous negative.
Transfer function buildingMembership functions and thresholds are determined by MEPA () in Section 3.2. Each of the features is partitioned into three states which are high, median, and low. For example,is the membership function of TH and the membership functions of some other features are shown in Appendix A.
APN model constructionThe structure of our APN model for arrhythmia beat detection is constructed by using the construction algorithm from Shih et al.(2013) and is shown in. Our APN model for the symptoms of heart-disease reasoning have eight variables, 11 middle states (one normal heart beat and 10 symptoms of heart disease), and one final state. All the degree of truth and states of the input places in the APN are gained by the membership functions calculated by Equation (11).
An example of arrhythmia-beat classificationAn APN reasoning algorithm, in Section 3.3, is used to classify heart-beat symptoms into the following category: normal/abnormal heartbeat or 11 different types of arrhythmia beat. APNAn APN model for Arrhythmic beat classification model inis used for reasoning of arrhythmia-beat classification and has five inputs, three middle states, 11 outputs and one final state. For example, assume that five inputs characteristics [x 1 , x 2 ,. .. , x 5 ] of an ECG-extracted signal from ECG wave are [2.7162, 2.3648, 1.2864, 0.5810,. From Appendix A, we can obtain the membership degree and the linguistic values of this ECG-extracted signal are 1.0 are a mapping from places p 1 , p 2 ,. .. , p 5 to its real values by using membership function. The p 1 , p 2 ,. .. , p 5 are starting places, where 40 shows that the proposition exists and  0 shows that the proposition does not exist. Let, d2, d3,. .. , d8 are eight propositions of ECG signals is shown inStep 1: From starting places p 1 , p 2 ,. .. p 5 : places p 1 , p 2 ,. .. , p 5 are starting places and ()  d 5 are 5 propositions of starting places.Step 2: In descendant place p i , p i 2 IRS(p s ), s  1, 2,. .. ,5; i6, 7,8. AP si  {p 1 , p 2 ,. .. , p 5 } and all transitions are enabled, places p 1 , p 2 ,. .. , p 5 are exist since ((p s ) ! ) and all the values of support and confidence are greater than threshold and , except c 58 (i.e. s si ! si  0.05 and c si ! si  0.02, s  1,2,. .. , 5; i  6, 7, 8). Tokens are moved from p 1 , p 2 ,. .. , p 5 to p 6 , p 7 , p 8. Since the antecedent portion or consequence portion of APRs between p 1 , p 2 ,. .. , p 5 and p 6 , p 7 , p 8 belongs to type 3, the reasoning function is 'Max' operator (). The degree of truth of proposition of place p 6 , p 7 , p 8 are,. .. , 5, i  6, 7, 8}, then, Max{0.708*0.2331, 1*0.3846}  0.3486 Max{0.708*0.1955, 0.970*0.0513, 0.792*0.2623}Step 3: At descendant place p j , p j 2 IRS(p i ), i  6, 7, 8; j  9, 10,. .. , 19. AP ij  {p 6 , p 7 , p 8 } and all transitions are enabled, places p 6 , p 7 , p 8 are exist since ((p j ) ! ). Some paths are not discarded, since the values of support and confidence are less than threshold and , such as p 6 ! p 14 , p 7 !p 11 , etc. (i.e. s ij ! ij  0.05 and c ij ! ij  0.02, j  6, 7, 8; j  9, 10,. .. ,). Tokens are moved from p 6 , p 7 , p 8. Since the antecedent portion or consequence portion of APRs between p 6 , p 7 , p 8 and p 9 , p 10 ,. .. , p 19 belongs to type 1, the reasoning function is 'Min' operator (). The degree of truth of proposition at place p 9 , p 10 ,. .. , p 19 are Min{0.3486*0.2941, 0.2077*0.0827, 0.1182*0.0889}  0.0105.Therefore, (p j j j  9, 10,. .. , 19) {0.0105, 0.0112, 0.0319, 0.0105, 0.0047, 0.0085, 0.0085, 0.0066, 0.0063, 0.0072, 0.0387}.
.. .Step 4: At descendant place p k , since p k  p g  p g20 , places p 9 , p 10 ,. .. , p 19 are exist ((p jk ) ! ) and all the values of support and confidence are greater than threshold and , all transitions are enabled (i.e. s jk ! jk  0.05 and c jk ! jk 0.02, j  9,10,. .. ,). Assume that all the CFs linked to p 20 are 0.9, and let c j,20  0.9,j  9,10,. .. , 19. Tokens are moved from p 9 , p 10 ,. .. , p 19 to p 20 and their degree of truth are (p 20 (v))  {(p j ) * c j,20 j j  9,10,. .. 19}, v  1,2,. .. 11, c j,20  0.9There are eleven successful reasoning paths, v  1, 2,. .. , 11,Step 5: There are 11 successful reasoning paths into goal place p 20 , V 6 . Since the APRs between p 9 , p 10 ,. .. , p 19 and p 20 belongs to type 3, the reasoning function is 'Max' operator, we can select proposition d 20 (v) and the degree of truth of d 20 (v) at the place p 20 as:(2)),. . .Finally, we can obtain the belonged cluster (Cluster 11: Ventricular Premature Contraction) and degree of truth is 0.0348 in this example.
EXPERIMENTAL RESULTS AND DISCUSSIONThe MIT-BIH arrhythmia database is used in our experiment. We use 368 cases in training and 185 cases for testing from sampled data in. After APN model construction, the testing result in confusion matrix of our proposed APN model is summarized in.summarized the other reported results of heart-beat recognition with Fuzzy Petri net (), support vector machine (), neuro-fuzzy network (), fuzzy hybrid neural network () and mirrored gauss model (). Our proposed APN model can successfully recognize most of clusters since every cluster's accuracy are all greater than 90%. In addition, our proposed APN model was further evaluated by the following performance measure such as: true positive rate (sensitivity) (TP-rate  TP/(TP  FN)), true negative rate (specificity) (TN-rate  TN/(FP  TN)), false positive rate (FPrate  FP/(FP  TN)) and false negative rate (FN-rate  FN/ (TP  FN)). Accuracy is defined with equation (TP  TN)/ (TP  FP  FN  TN). F-measure combines precision TP/ (TP  FP) and recall TP/(TP  FN) on the prediction of positive class (F-measure  2  precision  recall/precision  recall). A higher F-measure value indicates that the model performs better on positive class balancing of FP and FN. G-mean is the product of the prediction accuracies for both classes which is ffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffi TN= TN  FP    TP= TP  FN   p : And, AUC is the area under ROC (receiver operating characteristic curve) curve calculated with MedCalc (http://www.medcalc.org/index.php). Higher AUC indicate a classifier has a better classification performance. Other data mining methods such as NaveNave Bayes (NB), Decision tree (C4.5), Bayes Net, Support vector machine (SVM) and Fuzzy Petri net (FPN) running with Weka and MATLAB 2012 are shown infor comparison. APNs and C4.5 have a higher TN-rate in detecting abnormal heartbeat. SVM and FPN have a good TP-rate in detecting normal heartbeat in our experiment. Generally, in, our APN have the best performance than other data-mining methods in sensitivity, F-measure and accuracy measurement. And, other measurements are great too. Therefore, we can conclude that our proposed APN model have a good result on classification of ECG arrhythmias.
CONCLUSIONWe have proposed a methodology for the detection of ECG arrhythmia using a generalized APN model in this article. The performance evaluation using MIT-BIH arrhythmia database inshows that our approach compares well with other reported studies. The experimental results strongly suggest that our proposed APN model can help doctors in the diagnosis of ECG Arrhythmia and may applied to other symptom decision field. In the future, an applicable decision system for the clinical diagnosis of ECG arrhythmias can developed based on our provided APN model. And, the health care practitioners can be aware of typesAn APN model for Arrhythmic beat classification of cardiac arrhythmias and give early treatment to reduce deterioration. APN is a powerful method for representing knowledge and logic reasoning in the domain of decision support systems. Unlike other Petri net model, APN model has a systematic procedure in model construction. The reasoning path of expert systems can be reduced to simple sprouting trees if APN-based reasoning algorithms can be applied. However, there still drawbacks exist in APN such as state explosion and no hierarchy concepts. We shall overcome all these drawbacks in the near future.
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
H.-S.Chiang et al. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
