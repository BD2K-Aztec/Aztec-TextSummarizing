compcodeR is an R package for benchmarking of differential expression analysis methods, in particular, methods developed for analyzing RNA-seq data. The package provides functionality for simulating realistic RNA-seq count datasets, an interface to several of the most commonly used differential expression analysis methods and extensive functionality for evaluating and comparing different approaches on real and simulated data. Availability and implementation: compcodeR is available from
INTRODUCTIONTranscriptome profiling studies using RNA-seq with the goal of finding genes that are differentially expressed (DE) between conditions are abundant in the current scientific literature and can be expected to become even more so, as next-generation sequencing technology becomes cheaper and more accessible. RNA-seq experiments generate millions of short reads, which are aligned to a reference sequence to yield a quantitative measure of the expression levels of a collection of genes or other features. Typically, the processed data are represented as a count matrix, which constitutes the input for many differential expression methods. In the past few years, many novel differential expression methods applicable to count matrices obtained from RNA-seq experiments have been presented (for example,). At this point, both users and developers of such methods would thus greatly benefit from objective and standardized benchmarking and characterization of new and existing approaches. A few comparison studies have been published (e.g.). However, the fast pace at which new and updated methods are being presented and the varying objectives of the users create a need for a tool that makes it easy to evaluate and compare a collection of methods from many different aspects in a standardized way. In this applications note, we present such a tool. compcodeR (COMParison of COunt-based Differential Expression analysis methods with R) is a benchmarking R package that, in a few steps, lets the user evaluate and compare differential expression methods using an approach similar to the one used by Soneson and Delorenzi (2013). Accompanying the package is a large collection of simulated and real-world benchmarking datasets, together with differential expression results obtained by 420 different approaches (available from http://bcf.isb-sib.ch/data/compcodeR). The exact R code used to run each differential expression analysis is included and can be rerun to reproduce the results. Taken together, the package provides users with a pedagogical interface to understand and compare differential expression methods, and gives developers an accessible tool for standardized benchmarking of newly developed approaches.
EXAMPLEThis section outlines the three major functionalities of compcodeR. First, the package contains a function for generating synthetic RNA-seq count matrices, using the approach described byand Soneson and Delorenzi (2013). The user defines the properties of the dataset, such as the number of genes and samples, the fraction of truly DE genes and their effect size distribution, several parameters governing the inclusion of outlier counts and filter thresholds. The following code simulates a dataset consisting of Negative Binomially distributed data for five samples from each of two conditions and 12,500 genes, 10% of which are truly DE. The code generates an object of the class compData, which is saved to a file named mydata_5spc.rds. By rerunning the data simulation with repl.id set to different values, it is possible to generate multiple replicate datasets for a given simulation setting, which can make method comparisons more robust and informative. Second, the package provides an interface to several of the most commonly used methods for differential expression analysis of RNA-seq data. The intention is not to cover all available methods or exploit all of their possibilities, and new methods can easily be included by the user. The code below applies the differential expression test implemented in edgeR () to the data simulated above, and saves a new compData object containing also the test results. A list of the differential expression methods to which compcodeR provides an interface can be obtained using the function listcreateRmd.The runDiffExp function automatically includes the executed code as well as the output from the R console in the result object. The code can be written to an HTML file by the generateCodeHTMLs function.The third pillar of the package is the large number of metrics for comparison of differential expression results obtained by different methods. Many of the metrics are general and can also be applied to test results from other types of data, such as microarrays. Some, such as the overlap between the sets of DE genes found by different methods, are independent of knowledge about the true differential expression status of the genes and can thus be applied to any dataset. Others, such as comparisons of the observed false discovery rates for the different methods, are only applicable when the true differential expression status for each gene is known. The 15 comparison metrics are described in more detail in the package vignette. The code below launches the comparison.The function runComparisonGUI scans the provided input directories for result objects and opens a graphical user interface (GUI) where the user can select the dataset on which to base the comparison, which methods to compare and which comparison metrics to use. To facilitate inclusion in an automated analysis pipeline, the GUI can be circumvented, and the comparison can be directly performed using the function runComparison. The results of the comparison are written to an HTML report that is saved in the designated output directory.shows excerpts from five example plots from such a report.
The Author 2014. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
C.Soneson at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
