Background: The statistical power or multiple Type II error rate in large-scale multiple testing problems as, for example, in gene expression microarray experiments, depends on typically unknown parameters and is therefore difficult to assess a priori. However, it has been suggested to estimate the multiple Type II error rate post hoc, based on the observed data. Methods: We consider a class of post hoc estimators that are functions of the estimated proportion of true null hypotheses among all hypotheses. Numerous estimators for this proportion have been proposed and we investigate the statistical properties of the derived multiple Type II error rate estimators in an extensive simulation study. Results: The performance of the estimators in terms of the mean squared error depends sensitively on the distributional scenario. Estimators based on empirical distributions of the null hypotheses are superior in the presence of strongly correlated test statistics. Availability: R-code to compute all considered estimators based on P-values and supplementary material is available on the authors web page
INTRODUCTIONIn genomic and proteomic research thousands of hypotheses are tested simultaneously. Numerous procedures have been proposed to control multiple Type I error rates, e.g. the false discovery rate (FDR) or the family-wise error rate. The multiple Type II error rate or the statistical power, in contrast, have received less attention so far. The power of a multiple testing procedure can be defined in several ways (). For example, one can consider the probability to reject at least one alternative hypothesis or the probability to reject all alternative hypotheses. We consider an intermediate approach, the average power, defined as the arithmetic mean of the elementary power values of all alternative hypotheses. The average power can be interpreted as the expectation of the proportion of rejected alternative hypotheses among all alternative hypotheses and corresponds to the so-called false negative * To whom correspondence should be addressed. rate (FNR) (e.g.). The FNR is defined as the expectation of the false negative proportion (FNP), the proportion of retained true alternative hypotheses among all true alternative hypotheses and is related to the average power by Average Power = 1FNR. The FNR depends on a number of parameters as the sample size, the effect sizes and the proportion of true null hypotheses among all hypotheses. Therefore, the FNR of an experiment is unknown a priori and can only be guessed based on preliminary assumptions. However, if data have already been observed, the FNR can be estimated based on the observed test statistics. This concept of 'post hoc power analysis' has been criticized for the case of a single hypothesis test (e.g.), where the post hoc power is just a 1:1 function of a single P-value. However, in experiments with a large number of hypotheses one can utilize the empirical distribution of the test statistics to estimate the FNR. Under suitable assumptions (e.g. if the elementary test statistics are sufficiently independent), the FNR is asymptotically equivalent to the FNP such that an estimator for the FNR can also be used to estimate the FNP. An essential element in the estimation of the FNR is the estimation of the proportion of true null hypotheses among all null hypotheses, denoted by  0. Numerous estimators for  0 have been proposed in the literature and we assess their performance in the estimation of the FNR. The FNR is a measure for the fraction of undetected alternative hypotheses and is therefore a crucial parameter to interpret negative findings in experiments where a large number of hypotheses is investigated. In addition, in large-scale multiple testing problems, FNR estimates can be used to define stopping rules for sequential testing. For example, one could continue sampling until the estimated FNR falls below a prespecified threshold. As shown inunder suitable assumptions such sequential testing asymptotically does not inflate the FDR if the sample size is increased for all hypotheses simultaneously and only the test at the final interim analysis determines which hypotheses are rejected. The nomenclature for the FNR is not consistent in literature: we label the expected proportion of retained true alternatives under all alternatives 'FNR' according toand Norris and Kahn (2006).label this quantity 'fraction of genes not selected', Craiu and Sun (2008) non-discovery rate. Additionally, the term FNR has also been used to denote the proportion of false negatives among all retained hypotheses (), a quantity that has also been labeled, e.g. 'false non-discovery rate (FNDR)' (). In Section 2.1, we introduce a family of estimators of the FNR that depend on the data only through the number of
Post hoc power estimationrejected null hypotheses, the critical value applied in the multiple testing procedure and an estimate of the proportion of true null hypotheses  0. In addition, we consider an estimator that is based on estimation of local FDRs. In Section 2.2, we review published and implemented estimators for  0. These  0 estimators and the resulting estimators of the FNR are evaluated in a simulation study in Section 3 for a variety of scenarios including different dependency structures of test statistics across hypotheses as independence, weak dependence and equi-correlation. Finally, we give several real data examples in Section 4.
METHODS
Estimating the FNR and FNPConsider a multiple testing procedure to test m hypotheses of which m 0 (m 1 ) are true null (alternative) hypotheses. Then the proportion of true null hypotheses among all hypotheses is  0 = m 0 /m. Assume that for each of the elementary hypotheses a test with P-value p i ,i = 1,...,m, is defined. Let  denote the critical value applied to the unadjusted elementary P-values. For example, for the Bonferroni test  = /m while for the BenjaminiHochberg (BH) test  = d/m, where d = argmax i {p (i)  i/m} and p (1) ,...,p (m) denote the ordered P-values. We set  = 0 if p (i) > i/m for all i = 1,...,m. Let R = R() = #{p i  } denote the total number of rejected hypotheses and V the number of rejected true null hypotheses. Then the FDR, defined as the expected proportion of erroneous rejections among all rejections, is given by FDR = E(V /max{R,1}) (). Let S = RV denote the number of rejected true alternative hypotheses. The FNP is defined as FNP= 1 S m 1and the FNR is given by
A class of FNR estimators based on estimates of  0 To estimatethe FNR, we consider estimators of the quantities E(S) and m 1. LetLet Let 0 denote an estimate of  0 (in Section 2.2, we discuss several such estimators). LetmLet Letm 1 = (11 1 0 )m and estimate E(S) = E(R)E(V ) in two steps: E(R) is estimated by the observed number of rejections R, and V by mF 0 ()   0 , where F 0 denotes the cumulative distribution function (c.d.f) of the P-values corresponding to the true null hypothesis. Thus, an estimator of the FNR is given byIf the null distribution of the P-values is estimated from the data then F 0 in (3) is replaced by its estimatorFestimator estimatorF 0. Note that  0 = 1 implies that for all hypotheses the null hypothesis holds. Then m 1 = 0 and we define FNR = 0, since in this case no false negative decision can be made. Similarly, forfor for 0 = 1 we set FNR = 0. If we additionally assume that the P-values are uniformly distributed under H 0 then the estimator simplifies to FNR = 1 R()mm m 0 m(11 1 0 ) .This estimator has been considered by, who use the Storey (2002) method to estimate  0 , and, who apply a method byto estimate  0. If  is chosen to control the FDR at level , an alternative estimator is given by FNR = 1A large variety of estimators for  0 have been proposed, mainly as a tool to estimate the FDR. By (3) each such estimator defines also an estimator for the FNR. Given the underlying  0 estimators are consistent as m  and the observations are sufficiently independent across hypotheses (and some additional technical assumptions), the FNR estimators defined by (3) are consistent as well; if the  0 estimator is asymptotically biased, the asymptotic bias of the resulting FNR estimator has the opposite sign (see Section 1 in the Supplementary Material for details). In Section 2.2, we give a review of estimators for  0 and investigate the properties of the resulting FNR estimators for finite m in Section 3.
FNR estimators based on estimates of local FDRsAn alternative estimator of the FNR can be defined using Efron's (2007b) empirical Bayes estimator of the density of the test statistics and estimates of the so-called local FDR. Consider the test of two-sided hypotheses H i :  i = 0 versus,...,m. Then z-values z i are calculated by taking the standard normal quantile of the one-sided P-values. According to a Bayesian mixture model, it is assumed that the z-statistics belong to one of two classes, either corresponding to the true null hypothesis or the true alternative. The prior probability that a z-statistic corresponds to the true null hypothesis is  0. Denoting the density of the z-statistics under the null (alternative) hypothesis by f 0 (z) (f 1 (z)), the mixture density f (z) of the z-statistics is given byThe local FDR for hypothesis i is defined as the posterior probability in the Bayesian mixture model that for hypothesis i the null hypothesis holds. The local FDR is given by fdr(z) =  0 f 0 (z)/f (z), i = 1,...,m, such that f 1 (z) = (1fdr(z)) f (z)/   (1fdr(z)) f (z)dz (). Let c 1 denote the (1)-quantile of the standard normal distribution. Based on this representation of f 1 (z), we define an FNR estimator by(7) replacing fdr(z) and f (z) by appropriate estimates fdr(z) andfand andf (z). Since fdr(z) =  0 f 0 (z)/f (z), the estimate of fdr depends on estimates ofof of 0 ,  f 0 andfand andf. As in Efron (2007b), we estimat f (z) by a natural spline and consider two estimators for f 0 (z) and  0. First, it can be assumed that the null density is a normal distribution with mean  and variance  2 and that the zvalues corresponding to alternative hypotheses have support outside a known intervalonly. Then maximum likelihood estimates (MLEs) of ,  2 , and  0 can be derived based on all observations falling into. The threshold x 0 is chosen based on a heuristic algorithm. For the second option, it is assumed that f 0 (z) is a standard normal distribution [the 'theoretical null distribution' which corresponds to the assumption of uniformly distributed P-values in (4)] and  0 can be estimated as above. For the actual computation we approximate fdr andfand andf by piecewise constant functions using the R-package locfdr such that the integral simplifies to a sum. We consider two FNR estimators: LocThe based on the theoretical null distribution and LocMLE based on the estimated null distribution. Note that this FNR estimator is inby construction. If fdr(z) = 1 for all z, this suggests that the global null hypothesis holds and we set FNR = 0. Additionally, we consider two FNR estimators based on (7) where fdr(z) and f (z) are replaced by corresponding estimates from the fdrtool package. See the paragraph on the fdrtool package in Section 2.2 for details.
Relationship between the two types of FNR estimatorsThe FNR estimators based on  0 estimators are closely related to those based on local FDRs. Each term in (3) corresponds to a term in (7): R()/m is an estimator of the c.d.f. of the (two-sided) P-values at  given by
S.Zehetmayer and M.Poschinby construction. Additionally, the estimated local FDR's are clipped to the range, which can reduce the variability of the resulting estimates especially if the actual local FDR is close to 1. Finally, while in (3), E(R()) is estimated by the empirical distribution function of the P-values, in (7) more sophisticated estimators are used. However, these estimators rely on specific assumptions and may be inefficient if these assumptions are violated.
Estimators for  0In this section, we give a short description of the considered  0 estimators. They were chosen based on their availability in R (R Development Core). As in Section 2.1.2, we assume that the distribution of the z-statistics and P-values can be modeled via a mixture model. According to Equation (6), the mixture density f (p) of the P-values is given byWe use the same symbols to refer to densities of z and P-values and distinguish them by the argument only. If we additionally assume that the P-values under the null hypothesis are uniformly distributed on, then
Estimators based on P-value density estimationIn this section, we consider estimators of  0 that are based on estimates of the density f (p). Under the mixture model (9),   0 = min p f (p) gives an estimate of  0 which is positively biased if min p f 1 (p) > 0. If f 1 takes its minimum at p = 1, the estimate for  0 simplifies to f (1). The estimators for  0 considered in the following are based on different estimatorsfestimators estimatorsf of the mixture density f .): as described in Section 2.1.2, Efron (2007b) proposes to estimate  0 based on a mixture model of the z-transformed P-values. We consider two such estimators for  0 : EfronThe, derived under the assumption of the theoretical null distribution, and EfronMLE, where also the null distribution is estimated from the data. For a reliable estimation of the null distribution Efron suggests to use the method if  0 > 0.9, only. R-package locfdr.): Strimmer (2008) applies a truncated maximum likelihood approach to estimate  0 from the empirical distribution of either P-values, z-scores or t-statistics. If P-values are provided, the theoretical null distribution (i.e. uniform distribution on) is assumed. For z-statistics f 0 is assumed to follow a N(0, 2 0 ) distribution, and  0 and  0 are estimated with the truncated maximum likelihood approach.Similarly, for t-statistics f 0 is assumed to follow a t-distribution and the corresponding degrees of freedom and  0 are estimated. As in Efron's approach, an interval [x 0 ,x 0 ] is chosen which is assumed to contain only test statistics from true null hypotheses. Two different methods to determine x 0 are proposed: the FNDR method is based on minimizing the estimated FNDR which is defined as the expected proportion of retained true alternative hypotheses under all retained hypotheses. For the second method, x 0 is chosen such that a predefined fraction (default: 0.75) of the observed test statistics lies in the interval. ThenThen Then 0 is obtained via MLE of the truncated data. We denote the  0 estimators applying the minimization of the FNDR by Pfndr, Zfndr and Tfndr (based on either P-values, z-statistics or t-tests, respectively). Likewise, Ppct0, Zpct0 and Tpct0 denote the estimators based on the prefixed truncation fraction of 0.75. As outlined in Section 2.1.2, we also considered two FNR estimators, LocZfndr and LocZpct0, which are based on local FDR estimators from the fdrtool package: both local FDR estimators are based on z-statistics. For LocZfndr, the interval [x 0 ,x 0 ] is chosen based on FNDR estimates as described above. For LocZpct0, the central 75% of z-values are used to estimate the null distribution. R-package fdrtool. EbayesThresh (ETLapl, ETCau): Johnstone and Silverman (2004) propose an empirical Bayes approach to estimate  0 for sparse data. They assume that the observations for each hypothesis i are drawn independently from a normal distribution with mean  i and variance 1. The prior distributions of the  i are mixtures of a probability mass of  0 at zero with a given symmetric heavy-tailed distribution. The mixing weight  0 is estimated based on the marginal maximum likelihood. We considered the  0 estimates resulting from a Laplace (ETLapl) and quasi-Cauchy prior (ETCau). R-package EbayesThresh.
Estimation based on the c.d.f. of the P-valuesThe proportion of true null hypotheses can be estimated viwhere  is a tuning parameter. This approach goes back to, who gave a graphical motivation. The nominator gives the observed number of P-values larger than , the denominator is the expected number of P-values larger than , given that for all hypotheses the null hypothesis holds. Assuming that no P-value larger than  corresponds to an alternative hypothesis, (10) is an unbiased estimator. There is a trade-off between bias (which decreases for   1) and variance (which increases for   1). Several choices for  have been considered.) is based on the slope of the c.d.f. of the P-valuesFvalues valuesF(p). Let S i = (1p (i) )/(m+1i) denote the slope of the line from) to the point (1,1). Here, p (i) denote the ordered P-values. Let i denote the smallest, E is the c.d.f. of the Gumbel distribution, a = 2mloglogm, and b = 2loglogm+ 0.5logloglogm0.5log4 (where  denotes the circle constant). It is shown that under suitable conditions this bound is a consistent estimator of  0 as m . For finite m, the estimator can be improved if the infimum in (11) is taken over (,1) for some small in the order of 1/m. For the simulation study in Section 3, we set  = 0.5 such that the estimate (11) is median
Post hoc power estimationunbiased if the confidence bound has exact coverage probability. R-package howmany.
Other Estimators Jin: as forthe EfronMLE estimator, the null distribution is estimated from the data. Under the true null hypothesis, the z-scores are assumed to be N( 0 , 2 0 ) distributed. The parameters  0 , 0 as well as  0 are estimated based on the empirical characteristic function of the z-transformed P-values (). Under suitable conditions, if 1 0 is asymptotically larger than 1/  m, it is shown that the resulting estimate is consistent for m .
R-function provided by the authorswhere  is a real-valued function and E 0 ((, Broberg (2005) constructs an estimator for  0 using the estimated moment generating function of the P-value distribution. The moment generating function is represented as a weighted sum of the moment generating function of the uniform distribution and the unknown P-value distribution under the alternative. The latter is estimated by a recursive algorithm. R-function p0.mom in the Bioconductor package SAGx.
Comparison of FNR estimatorsBy (3) each estimate of  0 leads to an estimate of the FNR. Either the theoretical null distribution F 0 can be used in the estimator or an estimated null distributionFdistribution distributionF 0. We investigate the FNR estimators defined by (3) resulting from different estimators of  0 in a simulation study and report the square root of the mean squared error (RMSE) and the bias for each estimator under a wide range of scenarios. Additionally, we include the estimators LocThe, LocMLE, LocZfndr and LocZpct0 based on local FDRs defined in Section 2.1.2. Note that the  0 estimators corresponding to the LocThe, LocMLE, LocZfndr and LocZpct0 estimators are the same as for the EfronThe, EfronMLE, Zfndr and Zpct0 estimators, respectively, and are not reported separately in the tables and figures. For the simulation, we consider the test of m null hypotheses H i :  i = 0 for the mean of normally distributed observations with mean  i and variance,...,m, with two-sided one-sample t-tests. The critical value is determined by the BH step-up procedure at level  = 0.05 applied to elementary P-values based on the central t-distribution.Note that the BH procedure has been shown to control the FDR also under certain dependency structures (). For For For 0 estimators involving tuning parameters, the default values recommended by the respective authors are used except for the howmany estimator where we set  = 0.5 and for the estimators based on Efron's locfdr procedure (EfronThe, EfronMLE, LocThe and LocMLE) where the value of the degrees of freedom for fitting the estimated density f (z) is set to 14. Additionally, we restrict the  0 and FNR estimates to the interval. The simulations are performed for six reference scenarios. Here, we assume that m = 10000, n = 20 and consider three different proportions of true null hypotheses:  0 {0.9,0.95,0.99}. For the alternative hypotheses, we assume that the data are N( j ,1) distributed where the  j are alternating ,3/4,/2,/4 and ,for the (1 0 )m alternatives. For the reference scenarios, we consider {1,2}. The actual FNRs in these scenarios are given in. For the scenarios with correlated test statistics, the FNRs are practically identical. To investigate the impact of correlated test statistics on the properties of the FNR estimates, we performed the simulations for independent teststatistics, equi-correlated test statistics (as in) and a block correlation structure (). For the latter, we assume that the test statistics are correlated in blocks of 10 hypotheses. Within one block, the correlation between the test statistics of hypotheses H j and H i is , if i,j  5 or i,j > 5, and  if i  5 and j > 5 or vice versa. For each block  is drawn from a uniform distribution on.shows the maximum RMSE and maximum bias of FNR for  0 = 0.9,0.99 for independent and equi-correlated test statistics. The maximum is taken over the alternatives in {1,2}. Tables for all reference scenarios (RMSE and bias forfor for 0 and FNR) can be found in the Supplementary Material. In all considered scenarios,   0 has much lower RMSE than FNR. None of the FNR estimators has a uniformly lowest RMSE. Under independence, the Convest, LocThe and Pfndr estimator have the lowest maximal RMSE across the six considered scenarios (Section 2.3). For the scenario with block correlation, we observe somewhat larger RMSE than in the independent case (Supplementary Material). For the equi-correlated case (with  = 0.5), all estimators with the exception of the LocMLE and EfronMLE estimator have distinctively larger RMSE and bias compared with the independent case. Also the Jin estimator shows low RMSE in scenarios with equi-correlation but, as discussed below, its RMSE appears to depend very sensitively on the underlying parameters.shows the RMSE of FNR of the Convest, Pfndr, LocThe, LocMLE and EfronMLE estimators when varying one of the parameters m,  0 , or  in the reference scenario m = 10000,  0 = 0.9,  = 0, = 2, n = 20. The figures for the remaining FNR estimators as well as for the  0 estimators are given in the Supplementary Material. Due to the factor 1/(11 1 0 ) in the FNR estimators defined by (3), the RMSE is large for  0 close to one even though the RMSE of of of 0 decreases with  0. If  0 = 1, with a large probabilityprobability probability 0 = 1 and the FNR is correctly estimated as 0. However, if the estimat  0 is less than 1, the FNR estimate is typically 1 (since under the global null hypothesis the BH test guarantees that with probability 1 no hypothesis is rejected such that R() = 0). Thus, in this setting, the distribution of FNR is concentrated on 0 and 1 which is reflected in a large RMSE. For  0 << 1 the estimators LocMLE and EfronMLE based on estimated null distributions have a larger RMSE than the estimators based on theoretical null distributions. Increasing the effect sizes of the alternative hypotheses does not lead to a consistent decrease of the RMSE of the FNR estimators. In contrast, for all FNR estimators in, the RMSE reaches a maximum for  1. For increasing m, the RMSE of most estimators slightly decreases. For increasing , the (absolute) bias and RMSE. The maximum RMSE (maximum bias) of the considered FNR estimators for independent or equi-correlated ( = 0.5) test statistics for  0 = 0.9,0.99 and m = 10 000 Independence Equi-correlationThe maximum is taken over the alternatives in {1,2}. The bias of the scenario with the largest absolute bias is reported. 5000 simulation runs have been performed per scenario.
RESULTS
Comparison of the RMSE of the FNR estimators
S.Zehetmayer and M.Poschfor bothboth both 0 and FNR increase, with the exception of the RMSEs of EfronMLE and LocMLE which are nearly constant in . In several of the plots the Jin estimate shows an erratic behavior (Supplementary Material). The estimator involves a tuning parameter  and appears to depend quite sensitively on its value. In the simulation study, we used  = 0.1 as recommended in Jin and Cai (2007). However, for some scenarios, choosing a slightly different value has a large impact on the RMSE (data not shown). In the simulation study, we applied the BH procedure which does not rely on a  0 estimate but is strictly conservative if  0 < 1. This choice guarantees that the actual FNR is the same regardless of the  0 estimator considered for the FNR estimation and allows for a better comparability of the investigated methods. Additional simulations for the Storey, Pfndr and Convest methods, where the FDR was controlled based on the same  0 estimator as used in the FNR estimation, gave very similar RMSEs (data not shown). Normalization: It is well known that normalization can reduce the correlation in microarray datasets. We made further simulations for the five estimators considered above where the observations were standardized per chip such that they have mean 0 and variance 1. This standardization had hardly any impact in the independent and block correlated case. In the equi-correlated case, though, the correlation is practically removed by standardization and theLocMLE Convest EfronMLE Pfndr LocThe FNR 0.5 0.7 0.90.0 0.2 0.4 0.6 0.8
Fig. 1. RMSEof FNR estimators. In the scenario with m = 10000,  0 = 0.9, = 2,  = 0 in each of the graphs one of the parameters is varied. In the graph with varying only values >0 are plotted ( = 0 corresponds to the case  0 = 1). The graphs with varying  refers to the case of equi-correlated test statistics with correlation coefficient . The dotted line shows the true FNR. 500 simulation runs have been performed for each value on the x-axis.resulting FNR estimators have similar RMSEs as in the independent case. Note, however, that standardization may introduce a bias if a larger fraction of genes is differentially expressed and the effect of over-and underexpressed genes does not cancel out. To demonstrate that standardization cannot remove the impact of correlation in general, we performed additional simulations for the Convest, Pfndr, LocThe, LocMLE and EfronMLE estimators under a block correlation structure with larger block size. When increasing the block size to 100, standardization has practically no impact on the RMSE, but the RMSE (across = 1,2) increases compared with the scenarios with block size 10 even after normalization: for  0 = 0.9 to 0.18, 0.19, 0.16 (for Convest, Pfndr and LocThe) and to 0.3, 0.36 (for LocMLE and EfronMLE); for  0 = 0.99 to 0.38, 0.38, 0.34 (for Convest, Pfndr and LocThe) and to 0.39, 0.57 (for LocMLE and EfronMLE). Note that in contrast to the equi-correlated case, for block correlations with large blocks, the estimators based on the empirical null hypothesis show no advantage.
Assessing correlationsThe simulation study shows that the RMSE of the estimators depends on the strength of dependence of the observations across genes. While the results under block correlation and independence match closely, strong correlation (as in the equi-correlation scenario) leads for all estimators based on theoretical null distributions to much larger RMSEs. To assess the correlation between the observed expression levels of different genes, one can investigate
REAL DATA EXAMPLESWe estimate the FNR of two gene expression microarray experiments that were reanalyzed in. Based on a dataset by, we compare gene expression measurements of breast cancer in patients with positive and negative estrogen receptor status by two-sided two-sample t-tests (m = 3389, n = 28 per group). In the second example based on, we compare gene expression measurements of patients with papillary versus normal thyroid carcinoma (m = 12558, n = 8 per group). Due to the outliers and skewed distributions of expression values, the latter comparison was performed with Wilcoxon tests. As in the simulation study, the BH method was used to control the FDR at 5%. The considered estimators give rather divergent  0 and FNR estimates for the Gruvberger data (). However, they can be classified into two groups: the estimators based on the assumption of a uniform null distribution of the P-values (Convest, LocTheand Pfndr) and the estimators based on estimated null distributions (EfronMLE and LocMLE). Within each group the results are similar. The differences between the estimates from the two classes of estimators may be due to either a large fraction of alternative hypotheses or correlation between the test statistics of different hypotheses. As described in Section 3.2, we investigated the distribution of pairwise correlation coefficients between pairs of genes and computed pairwise Pearson's (Spearman's) correlations for the Gruvberger (Huang) dataset. For the Gruvberger dataset, the distribution of the z-transformed correlation coefficients indicates much stronger dependence than for the Huang dataset. This indicates a strong dependence of observations, in the order of the magnitude of block correlation with block size 250 (Section 3.2). Thus, in this dataset standardization cannot remove the correlations. For the Huang dataset, the standardization is performed by subtracting the chip-wise median and dividing by the interquartile range. Since there is little correlation observed in the raw data, standardizing hardly changes the distribution of correlation coefficients [group 1. Note that in both examples after standardization a larger number of hypotheses can be rejected and the FNR estimates become smaller (). The example shows that the choice of the null distribution may be crucial for the estimation of the FNR. However, this also holds for hypothesis testing: for example, if the rejection threshold  in the Gruvberger dataset is chosen such that the FDR estimate from the locfdr package is 0.05, one can reject 111 hypotheses assuming the theoretical null hypothesis but only seven when choosing the empirical null distribution.
CONCLUSIONSWe investigated a family of FNR estimators which is based on the estimated proportion of true null hypotheses  0 as well as estimators based on local FDR estimates. For the former, one can show that given the observations are sufficiently independent across hypotheses, the asymptotic FNR estimates are consistent as m  if the underlying  0 estimate is consistent. This holds, e.g. for the
S.Zehetmayer and M.PoschStorey (assuming that the tuning parameter  approaches 1 at an appropriate rate), Lbe, Howmany and Jin estimators. However, for finite m the simulation studies show that the estimation error in estimating the FNR is considerable larger than for the estimators of  0. A reliable estimation of the FNR is difficult, especially if the number of alternative hypotheses is small. In these settings, the FNP is still highly variable and the FNR estimators are unreliable. Since the proposed FNR estimators are based on univariate P-values, they can be applied to a wide range of statistical tests including multi-stage procedures for which group-sequential P-values can be defined (). The Convest, LocThe and Pfndr estimators that are based on theoretical null distributions showed the most favorable characteristics for independent test statistics in the considered scenarios, but have a large RMSE under strong dependence. In contrast, the EfronMLE and LocMLE estimators based on estimated null distributions are more robust in the equi-correlated scenarios, but show no advantage in the block correlated scenarios or if the proportion of alternative hypotheses is large. The latter comes from the fact that the estimation of the null distribution is based on the assumption that for most hypotheses the null hypothesis holds.
at :: on August 31, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
