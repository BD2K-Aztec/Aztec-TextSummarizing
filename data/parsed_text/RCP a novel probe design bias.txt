Motivation: The Illumina HumanMethylation450 BeadChip has been extensively utilized in epigenome-wide association studies. This array and its successor, the MethylationEPIC array, use two types of probes—Infinium I (type I) and Infinium II (type II)—in order to increase genome coverage but differences in probe chemistries result in different type I and II distributions of methylation values. Ignoring the difference in distributions between the two probe types may bias downstream analysis. Results: Here, we developed a novel method, called Regression on Correlated Probes (RCP), which uses the existing correlation between pairs of nearby type I and II probes to adjust the beta values of all type II probes. We evaluate the effect of this adjustment on reducing probe design type bias, reducing technical variation in duplicate samples, improving accuracy of measurements against known standards, and retention of biological signal. We find that RCP is statistically significantly better than unadjusted data or adjustment with alternative methods including SWAN and BMIQ. Availability: We incorporated the method into the R package ENmix, which is freely available from the Bioconductor website (
IntroductionThe advance of DNA methylation arrays in recent years has enabled large-scale epigenome-wide studies at single CpG site resolution. The Illumina Infinium HumanMethylation450 BeadChip () is currently the most commonly utilized array. It provides measurement of methylation level at about half a million individual CpG sites. Its successor, the Infinium MethylationEpic BeadChip, provides measurement of methylation level at more than 850 000 sites. To increase CpG coverage across the human genome, both arrays utilize probes of two different chemistries, Infinium I (type I) and Infinium II (type II). However, methylation measurements (beta values) derived from the two types of probes exhibit different distributions. In particular, beta values derived from type II probes have a smaller dynamic range and are not as reproducible as the beta values derived from type I probes (). Several methods have been proposed to normalize the beta values derived from the two types of probes. These include adjusting the beta values from both types of probes so that they are more 'comparable' (e.g. SWAN () implemented in the minfi package), or adjusting beta values from type II probes using beta values from type I probes as referents, (e.g. the Peak Based Correction (PBC) () and Beta MIxture Quantile dilation (BMIQ) (). Here, we proposed a novel method of adjusting type II probe beta values based on the correlation between a subset of closely spaced pairs of type I and II probes. This method, Regression on Correlated Probes (RCP), is simple, accurate and efficient. We tested RCP on multiple datasets and found that RCP outperformed BMIQ and other methods. RCP has been implemented in Bioconductor package ENmix (), is freely available for use, and can be combined with other pre-processing methods.
Methods
RCP: Regression on correlated probesSpatial correlation of DNA methylation is well known (with CpG sites near to one another (e.g. <100 base pairs) often having similar methylation, particularly if they have similar genomic context (e.g. location in CpG island, shore or shelf). Taking advantage of this correlation we propose a novel method, RCP, which uses a subset of type I and II probe pairs to derive the quantitative relationship between different probe type measurements. Once derived, this relationship is used to recalibrate all of the less-accurate type II probe measurements so that they more closely approximate the more accurate type I probe measurements. RCP first identifies pairs of nearby (<25 base pairs apart) type I and II probes that have the same genomic context according to Illumina annotation (Island, N_Shelf, N_Shore, S_Shelf, S_shore or OpenSea) and, for each sample, regresses the methylation M-value (logit of beta value) quantiles obtained from the type I probes on the corresponding quantiles for the type II probes. Using the estimated linear regression coefficients ( b b 0 and b b 1 ), RCP then adjusts all type II probe measurements as:where i is the index of a type II probe, M i is the raw M-value of the probe i and M i,adj is the adjusted M-value. Finally, RCP uses the inverse logit function to convert the adjusted M-values M i,adj to the adjusted beta values.
Evaluation datasetsDataset 1: A total of 19 pairs of duplicate whole blood samples (38 samples total) from. As part of this study, duplicate samples were located on separate 96 well plates that underwent independent bisulfite conversion, hybridization and array scanning. To avoid possible impact on evaluations we excluded 69 075 probes, including probes with non-specific binding, probes with common (MAF > 0.05) SNPs at CpG target regions, probes on sex chromosomes and probes with multimodal methylation distributions identified using the ENmix package. We also excluded data points with low quality methylation values where the number of beads was less than 3 or detection P-value greater than 0.05. Dataset 2: A total of 39 methylation laboratory standard control samples reported by. Human unmethylated DNA (HCT116 double knock out (DKO) of both DNA methyltransferases DNMT1 (-/-) and DNMT3b (-/-)) and fully methylated DNA (HCT116 DKO DNA enzymatically methylated) were obtained commercially (Zymo Research, Irving CA) and mixed together in different proportions to create laboratory control samples with specific methylation levels: 0, 5, 10, 20, 40, 50, 60, 80 and 100% methylated. Replicates for each methylation level (n  10, 3, 2, 3, 3, 2, 3, 3 and 10, respectively) were independently assayed on different arrays. Three publically available methylation datasets have been utilized to evaluate various probe type bias correction methods in a previous publication (). To facilitate direct comparison of different correction methods we evaluated RCP in these same datasets: Dataset 3: 450K dataset of three replicates from the HCT116 WT cell-line () and matched bisulfite pyrosequencing (BPS) data for nine type II probes (); Dataset 4: 450K dataset of five fresh frozen (FF) head and neck cancer (HNC) samples, of which two were HPV and three HPV(GEO accession number: GSM937820 to GSM937824; ()); and Dataset 5: 450K dataset of 32 formalin-fixed paraffin-embedded (FFPE) HNC samples, of which 18 were HPV and 14 HPV-(GEO accession number: GSE38266; (). Note that the original GEO dataset GSE38266 contains datasets for 42 FFPE HNC samples, of which 10 were excluded from the evaluation due to poor data quality.
Results
RCP is robust to parameter selectionsRCP is based on regression estimates in methylation M-value quantiles between nearby type I and II probes. To investigate the robustness of RCP to the distance cutoff between type I and II probes, we chose four distance cutoffs: 10 bp (resulting in 6523 pairs), 25 bp (15 855 pairs), 50 bp (27 937 pairs) and 100 bp (47 090 pairs). To investigate robustness to the number of evenly spaced quantiles we chose three sets of quantiles with 199, 999 and 1999 members. For each of the 38 samples in Dataset 1, we used the twelve different combinations of distance and quantiles to obtain RCP-adjusted type II beta values. Using the values obtained from one of these twelve combinations (cutoff  25 bp and 999 quantiles) as the referent, we observed little difference in the resulting adjusted beta values obtained with different distance or quantile combinations (Supplementary). Thus, for all of the subsequent RCP analyses presented here, we used a distance cutoff of 25 base pairs and 999 evenly spaced quantiles (0.001, 0.002,.. ., 0.999).
RCP reduces probe design type biasRCP reduces probe-type bias such that type I and II probes have distributions with similar modes (a mode here is a value at which the distribution has a local maximum value) and dynamic ranges (). For the 38 samples in Dataset 1, the average absolute difference between type I and II probes for the first (left) mode in raw beta value distributions was 0.014 (SD  0.007) and for the second (right) mode was 0.11 (SD  0.02). After RCP adjustment, the mode location differences were significantly reduced to 0.001 (SD  0.001) and 0.005 (SD  0.003) (Student paired T test P  1:1 10 12 and 1:5  10 29 , respectively).
RCP reduces technical variationSimilar to, we calculated the mean-centered correlation and the mean absolute difference between duplicates in Dataset 1. We used these two measures as performance metrics to evaluate the effect of RCP and alternative methods on technical variation and reproducibility. As shown in, all three methods (RCP, SWAN and BMIQ) provided significant improvement over raw values for type II probes; and direct comparison of RCP to other methods showed that RCP was significantly better than BMIQ and SWAN for both performance metrics. As a further test of RCP in reducing technical variation, and to facilitate direct comparisons with previously published methods, we replicated the analysis of Dataset 3 originally published inand again in. Using the three replicate 450K measurements made on HCT116 WT cell-lines we computed the standard deviation for each probe after different adjustment methods. RCP provided the greatest reduction in variation for type II probes (), and that reduction is statistically significant compared against either raw data (P < 2:2  10 16 ) or BMIQ (P < 2:2  10 16 ). RCP also reduced the average absolute difference in methylation between replicate pairs (), and that reduction is statistically significant against raw data (P < 2:2  10 16 for all three pairs respectively) and BMIQ (P < 2:2  10 16 for all three pairs respectively).
RCP improves data accuracyIn order to determine the effect of different adjustment methods on methylation accuracy we evaluated RCP and alternative methods using data from a set of laboratory controls with known methylation ranging from 0 to 100% (Dataset 2). We compared the performance of all three methods (RCP, SWAN and BMIQ) on improving data accuracy for beta values from type II probes. In particular, for each of the 39 samples, we identified the mode of the distribution of beta values from type II probes following different adjustment methods. We then calculated the absolute difference between the expected methylation level (0, 5, 10, 20, 40, 50, 60, 80 or 100%) and the average of the modes obtained from the replicate samples representing that methylation level. Overall RCP had modes that were significantly closer to the expected level than raw data (P  1:7  10 9 ), SWAN (P  1:8  10 10 ) and BMIQ (P  1:2  10 4 ). Additionally, unlike BMIQ and SWAN, the RCP modes were always more accurate than raw values (). As a further test that RCP adjusts beta values closer to true methylation values and to facilitate direct comparisons with other published methods we reanalyzed Dataset 3 for which bisulfite pyrosequencing (BPS) measurements of nine type II probe sites were available (). These BPS data were used as a gold standard by previous publications (). For the replicate in GEO dataset GSM815138, we calculated the absolute difference in beta value from the true estimate obtained by pyrosequencing at each of the nine probe sites. RCP outperforms raw and BMIQ-adjusted measures with RCP having statistically significantly smaller mean deviations from pyrosequencing results than raw beta values (P  0.005) and BMIQ (P  0.004) ().
RCP identifies more CpG sites associated with HPV statusA bias correction method should retain biological signals while reducing the technical variation. Similar towe used a cross validation strategy to evaluate how RCP performs in identifying CpGs associated with HPV status. The two HPV and three HPVHNC samples in Dataset 4 were used as a discovery set to identify HPV status-related differentially methylated CpG sites using the limma method (). The test set consists of 18 HPV and 14 HPVFFPE HNC samples in Dataset 5 (). At false discovery rate (FDR) cutoff 0.35 (the same cutoff used by), we identified similar numbers of differentially methylated CpG sites to those originally reported byin raw data or BMIQ adjusted data (). RCP outperformed SWAN, PBC and BMIQ: it identified the most differentially methylated CpG sites (290) in the training set (Dataset 4), resulted the largest number of validated sites (81), and had the highest positive predictive value (PPV  0.28). 56 sites were validated in both BMIQ-adjusted and RCP-adjusted data (Supplementary Table 2).. Effect of various bias correction methods on methylation concordance for 19 pairs of duplicate samples evaluated using mean-centered correlation coefficient (larger is better) and average absolute methylation difference (smaller is better)
RCPprobe types for each sample using a quantile linear regression model, and then monotonically and smoothly recalibrates all type II probe measures of the sample based on the regression estimates. Evaluation of multiple datasets shows that RCP consistently outperforms PBC, SWAN and BMIQ in correcting probe design bias and improving data quality. Like SWAN and BMIQ, RCP uses quantile information to normalize type II probe measures toward comparable type I probe measures. SWAN assumes that type I and II probes have identical distributions across the entire genome if they share similar genomic context and adjusts the distributions of both sets of probes to match. This assumption may not hold given that the use of type I and II probes in the methylation array is non-random. SWAN normalization adversely alters type I data, resulting in increased type I probe technical variation, reduced concordance between duplicates (), and results in few validated differentially methylated sites (). RCP only assumes comparable quantiles between type I and II probes that are in close proximity and have the same genomic context. Like BMIQ, RCP leaves the values of type I probes unchanged. BMIQ utilizes a model-based approach, and assumes that methylation values from type I and II probes will fit a three-state beta-mixture distribution model. After finding the best fit for type I probes, it assumes the same model for type II probes, reassigning the quantiles of the type II probes according to the type I distribution. BMIQ model parameter estimation is computationally intensive (e.g. 500 sample processing time of 7.8 h for BMIQ versus 2.5 min for RCP with one CPU core) which may be problematic for large studies. Although the model works reasonably well for most data, it may not fit some experimental data, resulting in highly inaccurate adjustments that are much worse than raw data (). RCP is directly applicable to the new Illumina MethylationEPIC BeadChip and can be used with other preprocessing methods to improve data quality. It is incorporated as a user-selectable function into ENmix (), a multiprocessor-capable R package that contains a suite of preprocessing, data quality, and visualization tools designed to facilitate large-scale analysis of methylation data.
ConclusionsRCP is a novel and computationally efficient method to correct probe type design bias for Illumina methylation BeadChips. It can significantly improve data quality for type II probes, resulting in increased precision and detection of true biological signals in DNA methylation analysis.. Comparison of different bias correction methods on retaining biological signals was done by counting the number of differentially methylated sites (nDMSs) associated with HPV status in FF HNC samples using the training set (Dataset 4), the number of validated differentially methylated sites (nTPs) associated with HPV status in FFPE HNC samples using the test set (Dataset 5), and also the estimates for the positive predictive value (PPV), i.e. nTP/nDMS
Funding
RCP
Bioinformatics, 2016, 15 doi: 10.1093/bioinformatics/btw285 Advance Access Publication Date: 5 May 2016 Original Paper Bioinformatics Advance Access published June 6, 2016 at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
Here, we introduce RCP, a novel method for 450K and EPIC BeadChips that reduces technical noise and improves measurement quality of type II probes. Although type I probes were used exclusively on the original 27K methylation arrays, Illumina has increasingly replaced them on subsequent arrays by type II probes, which now comprise 72% of the 450K array and 84% of the EPIC array. While type II probes facilitate increased array density, they cannot substitute for type I probes at some CpG sites and have decreased dynamic range and reproducibility compared to type I probes (Dedeurwaerder et al., 2011). Taking advantage of the high spatial correlation of DNA methylation levels along the human genome, RCP utilizes nearby type I and II probe pairs that share the same genomic context to derive a quantitative relationship between Fig. 3. Bar plots comparing absolute difference between distribution modes of type II probes and true methylation levels from Dataset 2 considered in Xu et al. (2015). Nine different methylation levels (0, 5, 10, 20, 40, 50, 60, 80 and 100%) were created by mixing unmethylated and fully methylated DNA together in different proportions, with each level of methylation represented by multiple replicates. RCP adjustment resulted in modes with the smallest average deviation from true levels Fig. 4. Bar plots of the maximum (MAX), average (MEAN) and root mean square error (RMSE) of the deviations (absolute differences) from the bisulfite pyrosequencing measurement across nine type II probes for a HCT116 WT cell considered in (Dedeurwaerder et al., 2011), for three types of beta values: raw beta values and adjusted beta values by BMIQ and RCP respectively Fig. 2. (A) Boxplots of the standard deviations of beta values across the three HCT116 WT replicates considered in Dedeurwaerder et al. (2011), for raw beta values (raw), adjusted beta values by BMIQ (BMIQ) and adjusted beta values by RCP (RCP). (B) Bar plots of the averaged (across type II probes) absolute difference of beta values between two replicates in each of three possible pairs of the three replicates, for raw beta values (raw), adjusted beta values by BMIQ (BMIQ) and adjusted beta values by RCP (RCP)
