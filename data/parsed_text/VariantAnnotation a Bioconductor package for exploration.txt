VariantAnnotation is an R / Bioconductor package for the exploration and annotation of genetic variants. Capabilities exist for reading, writing and filtering variant call format (VCF) files. VariantAnnotation allows ready access to additional R / Bioconductor facilities for advanced statistical analysis, data transformation , visualization and integration with diverse genomic resources. Availability and implementation: This package is implemented in R and available for download at the Bioconductor Web site (http:// bioconductor.org/packages/2.13/bioc/html/VariantAnnotation. html). The package contains extensive help pages for individual functions and a 'vignette' outlining typical work flows; it is made available under the open source 'Artistic-2.0' license.
AVAILABLE FUNCTIONALITYImportant operations available with the VariantAnnotation package are summarized in; we illustrate these operations using a subset of chr7 breast cancer variants for a tumor/normal pair ().
Reading, writing and filteringreadVcf reads data from a VCF file into a VCF R object. Genomic locations are stored as a GRanges object, with REF, ALT, FILTER, QUALITY and INFO fields as metadata columns. The GRanges object is a convenient format for manipulating range data and is compatible with extensive and well-developed Bioconductor () tools for discovering overlaps and matching between ranges (). Genotype data are parsed into arrays and stored in reference classes to avoid multiple data copies. A VCF object can be written out as a tabix-indexed () VCF file with writeVcf. One strategy for processing large tabix-indexed files is to use scanVcfHeader to identify INFO or FORMAT fields of interest, formulate range-based queries and load the data with readVcf. Memory use can be tuned by setting a yieldSize and iterating over the data in chunks.
library(VariantAnnotation)4 fl 5-system.file(''extdata", ''chr7sub.vcf.gz",  package"VariantAnnotation'') 4 hdr 5-info(scanVcfHeader(fl)) ##'info' fields *To whom correspondence should be addressed.Reading, writing and filtering scanVcfHeader Retrieve information about file content ScanVcfParam Select fields to input readVcf Read a VCF file into an R object readGeno, readInfo, readGT Read a single field into an R object writeVcf Write an R object to a VCF filereadInfo, readGeno and readGT retrieve individual fields as standard R objects. filterVcf identifies records satisfying predefined and ad hoc criteria, creating a new VCF file.
Annotating and transforming variantslocateVariants associates variants with coding, intron, splice site, promoter, UTR or intergenic regions.The gene, transcript and coding region identifiers provided in the output can be used with other Bioconductor resources to map to additional identifiers such as protein families database (PFAM) or gene ontology project (GO).predictCoding computes amino acid coding changes for non-synonymous variants that overlap coding regions. Reference sequences are retrieved from a BSgenome package or FASTA file. Variant sequences are constructed by substituting or inserting variant alleles into the reference sequence. Custom genomes can be imported as a Transcriptdb object with one of the makeTranscriptDb functions available in the GenomicFeatures package. 4 library(BSgenome.Hsapiens.UCSC.hg19) 4 predictCoding(vcf, txdb, Hsapiens) genotypeToSnpMatrix performs probability-based encoding of the genotype calls in a VCF object to create an SnpMatrix object for use in downstream packages. snpSummary provides counts and distribution statistics.
Integration and comparison with other resourcesVariantAnnotation offers highly flexible tools to interrogate and transform VCF files into R objects for exploration and analysis. In contrast to programs such as VCFtools () or PLINK/SEQ, VariantAnnotation provides an interactive environment for integrated portable analysis and methods development. The ensemblVEP package is an interface to the VEP () tool, while functions in VariantAnnotation allow close integration with SNP analysis routines in packages such as snpStats. I/O capabilities are compatible with upstream alignment and variant calling R packages such as gmapR and VariantTools, as well as VCFs produced by VarScan (), GATK (), etc. The ability to transform and output VCF subsets enables creation of files for use in tools such as ANNOVAR (). R VCF objects can be visualized with packages such as ggbio (). VariantAnnotation has good performance relative to other R tools operating on VCF files, e.g. Rplinkseq. NA values indicate the function could not perform the abstraction. A range of 63 088 records and two INFO and two genotype fields were arbitrarily chosen for testing. VariantAnnotation outperformed load.vcf when reading the range with all fields and meta.fetch when reading in specific INFO and genotype fields. VariantAnnotation was $30 faster than Rplinkseq when iterating over all records in the file. Input times for scanVcf scale linearly with the number of variants or samples.
CONCLUSIONSThis Note introduces the VariantAnnotation package to flexibly interrogate, annotate and transform VCF files. The package integrates with Bioconductor packages for advanced SNP and variant analysis, gene and genome annotation and rich tools for range-based queries. VariantAnnotation is performant compared with other R solutions and scales to handle large files with reasonable memory requirements. Read/write capabilities allow ready integration with third party software.
The Author 2014. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
Bioconductor VariantAnnotation at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
V.Obenchain et al. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
