Motivation: CRISPR RNAs (crRNAs) are a type of small non-coding RNA that form a key part of an acquired immune system in prokary-otes. Specific prediction methods find crRNA-encoding loci in nearly half of sequenced bacterial, and three quarters of archaeal, species. These Clustered Regularly Interspaced Short Palindromic Repeats (CRISPR) arrays consist of repeat elements alternating with specific spacers. Generally one strand is transcribed, producing long pre-crRNAs, which are processed to short crRNAs that base pair with invading nucleic acids to facilitate their destruction. No current software for the discovery of CRISPR loci predicts the direction of crRNA transcription. Results: We have developed an algorithm that accurately predicts the strand of the resulting crRNAs. The method uses as input CRISPR repeat predictions. CRISPRDirection uses parameters that are calculated from the CRISPR repeat predictions and flanking sequences, which are combined by weighted voting. The prediction may use prior coding sequence annotation but this is not required. CRISPRDirection correctly predicted the orientation of 94% of a reference set of arrays. Availability and implementation: The Perl source code is freely available from http://bioanalysis.otago.ac.nz/CRISPRDirection.
INTRODUCTIONMany bacteria and archaea have defense systems that target incoming nucleic acids, termed CRISPR-Cas (Clustered Regularly Interspaced Short Palindromic RepeatsCRISPR-associated proteins) systems. Recent studies have shown that these RNAmediated systems are a major antiviral mechanism in prokaryotes (). In bacterial genomic sequences, CRISPRs are characterized by repeated elements (repeats) interspersed with unique spacers. In most systems, RNA Polymerase transcribes the CRISPR array in one direction to produce the pre-CRISPR RNA (pre-crRNA), which is processed to provide separate small RNA effectors (crRNAs) that target foreign genetic elements (). The mechanism of targeting requires a number of Cas (CRISPR-associated proteins) that are typically encoded nearby to the CRISPR arrays. Most CRISPR-Cas systems target DNA from bacteriophages, plasmids and mobile elements in bacterial chromosomes (); however, some CRISPR-Cas systems target RNA (). The direction of transcription is unknown for most CRISPR arrays, and current algorithms do not predict direction. Normally, only one strand is transcribed and processed into small crRNAs, which determines base pairing target specificity. The crRNAs provide target specificity through base pairing for the CRISPR-Cas system. Therefore, target prediction algorithms permit both potential crRNAs to be analyzed, as the correct strand is often unknown (). There are several CRISPR discovery programs available to find these repeat arrays in genomic () or metagenomic sequences (). The most cited of these (CRISPRFinder) locates CRISPR arrays in 46% (1080 in 2355) of the complete genomes of bacteria and in 84% (126 in 150) of archaea. As CRT and PILER-CR are better suited to automation, they are used in bacterial genome annotation pipelines (). Recent CRISPR-Cas classifications include three types (IIII) and at least ten subtypes (). These are based on multiple criteria, including the presence of specific Cas proteins. For those type III-B systems that target singlestranded RNA, appropriate assignment of the direction of CRISPR expression is essential to accurately identify RNA targets and avoid false target predictions. Whereas for type I and II, additional short specific sequences are associated 5 0 or 3 0 of true targets and function in different steps of the CRISPR-Cas process. These sequences are termed protospacer adjacent motifs (), and recent work has suggested that these can be further discriminated into target interference motifs and spacer acquisition motifs that function at the different stages (). The identification of these additional determinants requires knowledge of the transcribed strand (). The ability to accurately identify the target strand would also be useful to determine if during conjugation the single strand initially transferred into the recipient is preferentially targeted (). Repeats may be dissimilar between the same types in different species, and the relationship between sequence and type is complex, i.e. near identical repeats in the same species can be *To whom correspondence should be addressed. associated with different types, e.g. I-B and III-B (), and multiple types commonly exist with a species (). However, repeats can independently be clustered and grouped into sequence or structural classes (). The most recent analysis puts 3527 repeats into 33 structural motif classes, 40 sequence family classes and 6 superclasses. Some of these classes are preferentially associated with specific CRISPR subtypes (). In some types (I and II), the repeat RNA has a stable stem loop, typically with 46 bases in the stem (). Pre-crRNA processing occurs within the repeat, resulting in 5 0 and 3 0 handles derived from the repeats and attached to the spacer (). This repeat structure within the pre-crRNA is required for processing in type I-F systems (). In some systems, the 5 0 crRNA handle is UAAGAAA derived from the 3 0 end of the repeat (). In addition, it has recently been shown that for a few species using type II systems, crRNA transcription can occur from multiple promoter sequences (TANAAT 10 like) within the 3 0 end of the repeat (). CRISPR arrays expand by acquiring specific sequences from invading nucleic acids. Although it is not completely understood, this adaptation typically involves addition of new spacers at the 5 0 end of the array (). However, there is evidence of some systems acquiring new spacers at positions internal to the CRISPR array (). Spacers and repeats may subsequently degenerate, then be lost by successive point mutations, deletions or recombination (). However, as clear targets of most crRNAs are not present in sequence databases, it is difficult to determine if mutations have occurred in spacers. In addition, it is likely that both target nucleic acids and host crRNAs are accumulating mutations after the initial contact and spacer acquisition (). For example, phages can escape CRISPR-Cas interference via the acquisition of point mutations in their target sequences, and old spacers might accumulate mutations when there is no longer a selective advantage (i.e. in the absence of the target phage/plasmid) (). The 'leader' is the sequence that precedes the array and contains both the promoter and 5 0 region before the first repeat (). In some characterized systems, there is clear accumulation of point mutations in the repeats (and spacers) at the 3 0 end of the array (leader-distal end). Consistent with this observation, current data indicate that new spacers are acquired at the 5 0 (leader) end of the CRISPR array, and older spacers and repeats decay at the 3 0 end (trailer end spacers) (). Previous studies have predicted the direction of repeats as parts of larger studies. It has been observed that repeats in archaea are A-rich and this has been used to determine direction in that domain (). Recently,used A-richness, and the presence of ATTGAAA(C/G) at the 3 0 end of repeats, to determine the direction of repeats (). In this article, we aimed to use information within, and nearby, predicted CRISPR arrays to determine the direction of transcription. Prediction was performed as much as possible independently of the use of biological knowledge (e.g. repeat class), as this is not known for many sequences. The algorithm is described and available as a Perl module for a gene prediction and annotation pipeline. This CRISPRDirection algorithm predicts with490% accuracy the direction of transcription and thus the correct sequences of the crRNAs that target foreign nucleic acids. CRISPRDirection will be useful for more accurate prediction of CRISPR arrays, and subsequent prediction of their types and targets, such as via CRISPRTarget ().
METHODS
Preprocessing of arrays
Prediction of arrays Arrays were predicted withCRISPRFinder, PILER-CR and CRT on complete bacterial (2341 species with 4458 sequences) and archaeal (153 species with 236 sequences) genomes using the default parameters (). Only CRISPR arrays with two or more spacers (i.e. three or more repeats) were used in the analyses. The three programs predicted 4053, 3471 and 3166 CRISPRs, respectively. There was partial or full overlap between all three predictions for 3115 arrays. Because arrays predicted with CRISPRFinder do not show variation in individual repeats in the final output, and its dependencies are not freely available, the CRISPRFinder-predicted arrays were not used. Because similar arrays were often predicted by CRT and PILER-CR, only the longer ones were used from the combined list of predictions. For overlapping predictions, the longest array was selected. The final list included 3571 CRISPR arrays. Those pipelines that include CRISPR annotation use a similar methodology.
Identifying representative repeat sequences Asthe PILERCR output format provides most of the information required by CRISPRDirection, we converted the CRT-predicted arrays into PILER-CR format. However, as CRT does not provide a representative. Overview of the methods used in CRISPRDirection. Arrays were predicted using CRT and PILER-CR. An array with n repeats R 1 R n is shown. Parameters were calculated from the repeats or using flanking regions, e.g. the distance to the next annotated protein CDS (arrows) (Section 2). Relative AT% in the flanks was determined in fixed windows. For each array, a representative repeat was determined and then assessed for motifs, composition and secondary structure (Section 2) repeat, we had to determine this for the arrays predicted by CRT. To find the representative/centroid repeat for each array, we used a match-scoring method, then the frequency of individual repeats. We first collected all the repeat sequences of an array and the number of individual occurrences in the array. At this stage if two repeats have single base difference, they were treated as two separate sequences. We initially selected the sequence with the least mismatches as the representative repeat. Where two or more sequences had the same degeneracy score, the most common repeat was selected. If these were equal, the repeat with fewer mismatches at the ends of the array was selected. The representative repeats were collected from the 3571 arrays, and after identical or reverse complemented repeats were removed, there were 2023 unique repeats.
Reference set of arrays and repeat sequencesTo develop a reference set of CRISPRs with known orientation, a set of 26 repeats with experimentally determined direction was used, 13 repeats were taken from Biswas et al. (2013) and supplemented with 13 repeats from the recent literature (Supplementary). These were chosen to cover each of the 10 subtypes and a range of structural and sequence classes (Section 4 and Supplementary Material S3) (). There were 208 arrays containing these exact 26 repeats. To generate a larger reference set of arrays for our analysis, we searched the 2023 repeats for sequences similar to the 26 repeats of known orientation. In this comparison, repeats with a maximum of three mismatching bases were retained. This gave us a set of 120 unique repeats that were present in 575 distinct arrays (Supplementary). We removed arrays with 495% sequence identity using CD-HIT-EST (Supplementary). This reduced the number of arrays to 460 arrays, 340 from 205 bacterial and 120 from 43 archaeal species. These 460 arrays were used as a reference set in our analyses.
Calculation of parametersWe derived and used a number of parameters and attributes from the repeats and regions immediately flanking the array. Each of these sets of parameters was used as a method to predict the direction of the array as either F (Forward) or R (Reverse). For some methods all 460 arrays could be used, and for others, not all arrays were suitable for the analysis. If the array was not valid for the analysis, or the analysis results in a draw, it reports NP (No Prediction). For example, if there are no mutations in an array, the reported direction by the method dependent on these will be NP (Supplementary). A set of 100 CRISPR arrays were selected randomly in each run and the set is used for all the methods. This was repeated 100 times. The mean Positive Predictive Value (PPV) was calculated using resampling by re-substitution, as n is much larger than the number of predictors to be estimated. An alternative method of resampling by 10-fold cross-validation is provided in Supplementary File S2, which produced similar predictors and scores AE 0.03. As the random probability of getting a true prediction is 0.50, we used as a weighted score (score) for each method its PPV minus 0.50.
Screen for ATTGAAA-like sequences The sequenceATTGAAA and variants shown inwere searched for individually on both strands of the representative repeat (). Any single base, or no base, was allowed following the motif, to allow for inaccuracy in prediction of the repeat/spacer transition in tuning the algorithm.
Biased nucleotide composition in the 5 0 and 3 0 flanks relative AT richnessIn testing, we compared the percentage of nucleotides A and T (AT%) in different length windows ranging from 15 to 165 nucleotides with a step of 15 nucleotides flanking the 5 0 and 3 0 ends of the arrays (). The AT% in each of these regions were compared, in testing, to determine if they have an absolute minimum percentage difference ranging from 0.5 to 14.5%. When the AT differences for windows were greater than the minimum cutoff, a prediction was obtained. For example, if the 5 0 end of the array showed a higher AT% for a window size (e.g. 135) and minimum cutoff (e.g. 2.5%) the prediction was F. Similarly, the predicted direction will be R when the 3 0 end of the array shows a higher AT% than the 5 0 end of the array. For all other cases, NPs are reported.
Degeneracy at the 3 0 end of the arrayThe array was divided into three sections: 5 0 , middle and 3 0 sections, each with an equal number of repeats, where possible, or the nearest integer. For arrays with three or four repeats, both 5 0 and 3 0 sections had one repeat each. Of the 460 arrays, 164 had no mutations in the array and were excluded from this analysis. The remaining 296 had one or more mutations and a direction could be predicted. We calculated the total number of mutations present in these sections. In this analysis, a base was denoted as mutated only when it differed from an adjacent repeat (Supplementary). This rule of mutation was necessary as many long CRISPR arrays were shown to have a point mutation, which is propagated to the next repeats, resulting in two common repeats in a single array. Often, both the repeats were found to have more than one-third of repeats associated with them, making it difficult to select one as the representative repeat. The score for the 5 0 and 3 0 sections were calculated in the following manner: 5 0 section score  Total number of mutations  Observed mutation in the first repeat; 3 0 section score  Total number of mutations  Observed mutation in the last repeat. The 'observed mutation in the first/last repeat' can either be True (1) or False (0), and this was useful to correctly identify the direction when the total number of mutations in both 5 0 and 3 0 section was equal. The end with the lowest score was predicted to be the 5 0 end.
Potential for RNA secondary structure in the repeat Forthis analysis, we first removed the redundant repeats from the sample (Supplementary) and used RNAfold to measure the Minimum Free Energy (MFE) of the repeats in both directions (). In addition, we masked bases from 0 to 11 bases from both ends and calculated the MFE of the center part of the repeats and their reverse complements. The direction with the lowest free energy for those with differences of 40.5 kcal/mol was designated as forward.2.2.5 A relative to T in the repeat A/T ratio For this analysis, the relative number of A to T in the representative repeat was measured and the direction with the highest A/T ratio designated as forward.
Distanceto the next coding gene at the 5 0 and 3 0 end length of leader analysis Using the start and stop positions of the 460 arrays, we obtained the positions of next CoDing Sequences (CDS) from their annotation files (NCBI Genbank format, gbk). All CDSs overlapping any CRISPR arrays were omitted (99 CDS). The closest CDS coordinate on the 5 0 end of the array and the closest CDS coordinate on the 3 0 end of the array were analyzed. The end with the longest distance was designated as forward.
Parameters
Final predictionThe score for forward or reverse is the sum of the individual scores from each of the methods (e.g. Total_Forward_score is the sum of the forward scores, Supplementary). NP is not counted. The Confidence_score (CS)  absolute value of (Total_Forward_score  Total_Reverse_score). Predictions are made with 'high' confidence if the CS is !66% of the 'Sum of all Applied Scores' (SAS  Total_Forward_score  Total_Reverse_score) and also40.5; 'medium': CS 566% !33% SAS and 'low': 533% SAS. The required confidence score of 40.5 for 'High' confidence is required to exclude results solely from less accurate prediction methods, where the more accurate methods did not produce a prediction (NP).
AvailabilityAn implementation in Perl with documentation and test data is available at http://bioanalysis.otago.ac.nz/CRISPRDirection. This will take as input a fasta or Genbank formatted, annotated or unannotated genomic sequences, or simply repeat sequences in fasta format. The algorithm is shown in Supplement S4, and output is shown in T5.
RESULTSWe aimed to develop an algorithm to detect the direction of CRISPR transcription. This would, as much as possible, be independent of specific biological knowledge for known types of arrays, as often this is neither known nor predicted. Such a method could be applied within a pipeline to new instances and potentially new classes of arrays. The predictive methods adopted were (i) searching for ATTGAAA-like sequence motifs in the repeats, (ii) finding biased nucleotide composition (relative AT richness) in the leader and trailer regions of the arrays, (iii) analysis of mutation(s) in the repeats (array degeneracy), (iv) analysis of RNA secondary structure in the repeats, (v) finding the longer distance to the next coding gene at the 5 0 and 3 0 ends and (vi) greater number A compared with T in the repeat. These methods are depicted in. A reference set of known direction was assembled by using a set of 26 repeats of experimentally determined orientation in 135 unique arrays. This was extend to 460 repeats by allowing up to three mismatches (see Section 2.1).
Specific sequences at the 3 0 end of the repeatA recent analysis of repeats noted that about a third of their set of repeats end in ATTGAAA(C/G), and they used that to predict repeat direction (). To investigate whether this was a useful predictor on our independently created reference set, we searched for variants of ATTGAAA(N) at the 3 0 end on both strands. An exact match was found in 30% (137) of the 460 reference arrays. In all these cases, this correctly predicted the direction of the array (PPV  1.00,). Similar one-base variants of all the bases except the G slightly increased the number of predictions but retained PPVs of 1.00 (). Extensive substitution at the 5 0 end, e.g. WWWGAAA(N), still retained a high PPV (0.96,). For those 137 arrays that had ATTGAAA(N), we used this as a certain predictor of the direction of these arrays. This parameter was given a score of 0.50 (PPV of 1.000.50 random chance).
Biased AT composition in the 5 0 and 3 0 flanksThe promoter/leader sequence 5 0 of the CRISPR array would be expected to differ from the terminator sequence following it. These promoters have been described as being AT rich in several studies, and some AT-rich sequences (e.g. TATAAT-like sigma 70 promoter 10 elements) have been shown to be functional in CRISPR promoters (). The AT% was calculated in windows at the two flanks and the percent difference compared. An AT% difference of 0.514% and windows up to 165 bp long were compared (see Section 2.2.2). The analysis was repeated 100 times for new randomly selected sets of 100 CRISPR arrays in each run, and the results were compared to determine the window length and minimum percentage difference in the AT that gave an optimal PPV (Supplementary). This sampling approach was used to calculate measures of variability within our set of 460 repeats, which is a sample of all possible CRISPR arrays. As shown in, a window size of 60 with a minimum AT% difference of 10% gave a high PPV (0.82) with a tolerable NP (TP 39, FP 9 and NP 53). Higher PPVs could be achieved, e.g. window size of 105, AT% difference 414%, PPV 0.95 (Supplementary). However, this combination could only be applied to one-third of the data. As this method is one of a combination to predict the probable direction, we used a window size of 60, 410% AT% as a balanced default for CRISPRDirection. Alternative combinations can be applied in the implementation, and results are shown in Supplementary.
Degeneracy at the 3 0 end of the arrayBased on the idea that repeat sequences at the 3 0 end may have accumulated mutations, we looked for differences at either end of the predicted arrays.shows that a PPV of 40.90 could be achieved (TP 89, FP 9 and NP 2). Some of the FPs may be caused by a random mutation or rare sequencing errors within the arrays. A higher accuracy (PPV 0.95) can be achieved by only including arrays with a minimum of two or three mutations (). However, as that increases the number of NP (to $40%) we did not set any minimum mutation requirement
Potential for RNA secondary structure in the repeatSome CRISPR repeats are known to form small RNA secondary structures, which would be strand-specific. We used a simple method to test for the greater ability to form thermodynamically stable secondary structures on each strand. This method was designed to avoid requiring prior knowledge of classes or structures in different classes when predicting the direction. The hypothesis was that theMFE of the forward strand would be lower compared with the MFE of the other strand. In an initial analysis, we observed that calculating the MFE of the whole repeats gives a poor prediction accuracy (, PPV 0.55). The RNA secondary structural elements, where experimentally characterized, are typically present toward the center of the repeats rather than at the ends (). Therefore, we progressively masked the leading bases from the both ends of the repeats and calculated the MFE (). The accuracy of the prediction increased as the ends were masked by up to five bases (and PPV 0.87). Further base neutralization showed that although the PPV was increased, the number of true predictions rapidly reduced (e.g. PPV 0.90 and NP 26% at 8). The average repeat length is 31 nucleotides, removing up to five bases from both sides (total 10 bases) still kept the secondary structural elements intact in the middle for most cases and gave a more accurate prediction. However, as more bases were masked, only longer repeats gave useful results, indicated by the rapid drop off after eight bases in.
Analysis of A relative to T in repeatsA/T ratio analysisSeveral studies have also used A/T ratios in the repeat as a predictor of direction, as it has been observed that archaeal repeats are A rich (). The notion is the forward strand will have more A than T. The PPV for this was 0.72 (68 TP, 27 FP, 5 NP of samples of 100). During this analysis, we observed that AT-rich repeats had a higher rate of false predictions. To investigate whether this has a clear pattern, which can be applied to improve the overall prediction, we separated the repeats into two groups. The first group contains the AT-rich repeats (i.e. AT%4GC%) and the second group contains AT-poor repeats and reapplied the method. The result (shows that this method is better applied to repeats that are AT poor (PPV 0.87).
Distance to the next coding gene at the 5 0 and 3 0 end length of leader analysisThe 'leader' region containing the promoter may be longer than the 'trailing' region containing the transcription terminator (). To test if this could be used to predict the direction, the positions of the nextCDS at the 5 0 and 3 0 end were obtained from their corresponding Genbank annotation. Only thismethod, of the prediction methods implemented, relies on other types of gene annotation. The distances were compared to obtain a parameter that could be tested for use in prediction. As yet the NCBI Reference sequences do not include CRISPR predictions and leave them as long intergenic gaps. Hence, CDS annotations may not be accurate in these regions, and it is possible to have undetected CDS close to the CRISPR arrays, or falsely predicted CDS close or within the arrays. Indeed, 99 predicted probable arrays showed overlapping predicted CDS. These overlapping CDS were ignored for this analysis. Distances ranged from 2 to 5252 bases to the next CDS for the set. However, often both distances were short (575), making prediction unreliable. Hence, instead of only testing for the longer sequence, we also compared if the longer sequence was at least 120, 140, 160, 180 or 4200% the size of the shorter, and required that at least one of the lengths be 475 nucleotides (Supplementary). NP was made if the ratio did not meet the criteria or the length was too short (). These predictions can be found in the Supplementary spreadsheet (Supplementary File S2). The maximum PPV obtained was 0.68 (4200%,), this was selected to be used by default. However, about half the arrays did not have such long leaders and resulted in NP calls ().
Combined predictionEach of the six predictors was combined. To weight more accurate predictions higher (i.e. assigning higher scores to more accurate methods), each of the six predictions was weighted according to PPV (Section 2.2.8). Thus, the highest weighted prediction was ATTGAAA(N) (0.5) followed by degeneracy (0.41) and the lowest weighted prediction was longer leader (0.18). The combined method correctly predicted 424 arrays of the 460 CRISPRs used as reference with a PPV of 0.94, FP 27 and NP 4 (Bacteria: PPV 0.92, TP 317, FP 19, NP 4; Archaea: PPV 0.93, TP 112, FP 8, NP 0). To further assess the robustness of the method, the algorithm was run without each of the methods in turn and without combinations of related methods. Leaving out the most accurate predictor (ATTGAAA(N)) had a small effect reducing the PPV by $4% (Supplementaryand Supplementary). Leaving out the degeneracy had the greatest single impact on PPV, reducing it to 0.91. Leaving out the longer leader method, the only measure that depends on CDS annotation reduced had little effect. If only repeat sequences were used as input, an option in the implementation, PPV was 0.87 using three methods (i.e. Motif search, A/T ratio and RNA structure analysis) that only require the repeat. An alternative prediction strategy was to predict using the highest practical PPV from each method (window size 120 and minimum AT% difference 14 in relative AT-richness analysis, 8 masked bases in the RNA secondary structure analysis and by requiring two or more mutation in the array degeneracy analysis). Using this alternative set of options stated as 'high precision parameters' in the section 2.2.7, we obtained a PPV of 0.95 against the whole reference set, with 413 TP, 21 FP and 26 NP (bacteria: PPV 0.95, NP 26; archaea: PPV 0.97, NP 4, Supplementary File S2). Predictions differ in total scores; therefore, a prediction confidence could be determined. Predictions are flagged with 'high' confidence if they met defined criteria (Section 2.2.8 and Supplementary). Final predictions, and confidence scores, for the direction for the full dataset of 3571 arrays are available in the Supplementary Material on the companion Web site.
DISCUSSIONThe algorithm described works surprisingly well using a set of relatively easily calculable parameters. At the default level of accuracy, it correctly predicts 94% of reference arrays. Higher levels of accuracy (e.g. PPV 0.95 and NP 26) are possible by changing some of the parameters. This method can be built into a generic prokaryotic prediction pipeline, without a requirement of knowledge whether the sequence is from bacteria or archaea and without the need to define the type, subtype, class or superclass of the array or repeat. However, it is also possible for users analyzing specific genomes to incorporate biological knowledge, e.g. specific motifs or presence of RNA structure into the prediction.
Reference setThe method was tested on a set of 460 arrays, and these consisted of 208 arrays having exact matches to a set of 26 experimentally verified repeats from all 10 subtypes. This set was extended by allowing a small number of mismatches (up to 3 in repeats of mean length 31). Within genera and classes of arrays, there is often a large amount of substitution in arrays (). Including this small tolerance might include some nonfunctional arrays, but is unlikely to reverse the arrays. We compared our array sets with the repeat sets used by. Our set had members in 7 of the 10 largest structural classes and 9 of 10 largest sequence classes described (Supplementaryand Supplementary Tables S7 and S9) (). This set provides a new independent reference set for CRISPR analysis. The similarity to known repeats could be extended to provide a predictive measure; however, its validation would require a. The distance to the next CDS was determined for each flank. The side that was longer was predicted to be the leader. TP: True positives, FP: False positives, NP: No Prediction, PPV: Positive Predictive Value. Data are the mean and standard deviation of 100 random samples. PPV values are poor (near random) when the lengths are similar ($1). The highest PPV (0.68) is obtained when the ratio is 4200% different reference set. We generated another reference set by using the 528 arrays that have ATTGAAA(N) at the 3 0 end, and of these, 140 had 54 mismatches to the 26 known repeats (Supplementary). All 140 were correctly orientated. Up to 7 mismatches provided a PPV of 1.0 (250 arrays), and 43% of all the arrays had this amount of similarity (Supplement T3). This alternative approach is also implemented in CRISPRDirection. The use of this motif as a predictor (or any user-defined motif) can be included optionally in the CRISPRDirection program. The score can also be changed, e.g. increased to 4.5, to override the other predictions. In both the previous sets, there are clearly some sequences with incorrect orientation, based on subsequent experimentally verified repeats (). For example, the type I-F systems have a structured repeat that commonly ends in CUAAGAAA (and Supplementary) (). These are represented in the classification ofas CRISPR-4. They comprise classes, M4 and F5, and incorrectly, its reverse complement, M6 and F8, in the classification of. The work described here will allow further merging and refinement of these repeat classes, after prior prediction of the repeat direction.
Specific methodsWe used one specific motif set in this analysis (AUUGAAAlike), as it was present in one-third of arrays. Cleavage immediately before this sequence generates the 5 0 handle on the crRNA in several systems (). Variations on this also provided strong predictors, as long as the G was retained (). These or other variants could also be used as predictors, particularly if the type was known. For example, to predict type I-Fassociated CRISPRs, a variant of this in which there is reordering of the leading AU right region may be used (UUAGAAA) (). We searched for motifs at the end of the sequence but also allowed an additional base to be present in the repeat prediction. Current CRISPR array prediction algorithms cannot always accurately predict the termini of repeats, e.g. if the first base of the following spacer is also repeated (and Supplementary). Other sequence motifs can be defined by users in the repeats. For example, the presence of motif 'GUU' in the first bases of the repeats improved accuracy, and TATAAT-like sequences function in some repeats (). However, as some CRISPRs (e.g. I-E) do not obey these rules, and because our aim was to make the analysis unbiased to specific properties, we did not use more complex motif analysis by default here. The relative AT% on either side of the repeat provided a useful predictor for 177 of the 460 arrays (). This is likely to represent the presence of AT-rich promoter sequences (e.g. TATAAT) and GC-rich structured terminator sequences. In addition, the leader region is important for acquisition of new spacers, which may require AT-rich binding sequences (Diez). The automated determination of the direction of arrays will enable further computational analysis of these regulatory regions (). The relative AT% could also possibly represent adjacent tracrRNA (Type II) or cas genes (). For 197 of the reference arrays, the presence of a greater number of mutations at the 3 0 trailer end provided a specific predictor (). We believe this reflects the degeneration of older repeats at the trailer end. Therefore, CRISPRDirection will facilitate studies of the evolution of these arrays (). Calculation of a likelihood of forming an RNA structure worked poorly as a predictor on full-length repeats (). This was surprising, as some types have structures (I, II) and these are well represented in our reference set. However, these structures are commonly small and located near the center of the repeat, with the termini involved in other processes (see above). Exclusion of the five bases at each end (e.g. UGAAA in more than one-third of the sequences) improved the PPV (). The relative number of A compared with T in repeats has previously been used to predict CRISPR direction. In particular, this is used as a predictor of the directions of arrays in the UCSC Archaeal Genome Browser (). This gave a PPV of 0.72 overall, but was most effective (0.87) when applied to repeats with 550% AT ().We examined the distance to the next annotated CDS as a predictor (). This was not an effective predictor unless the sequences were relatively long. This is the only measure used here that depends on prior annotation of the genome, and its exclusion (Supplementary) only reduced precision by 1%. Therefore, when CRISPRDirection is used as part of a pipeline it could be run before CDS prediction. This order would have the advantage of avoiding the many likely spurious CDS predictions within CRISPR arrays (e.g. 99 of 460 arrays in the RefSeq annotation). CRISPRDirection could be built into such pipelines, such as that used by the JGI-DOE (). A disadvantage of CRISPR prediction before CDS prediction is that repeats in some proteins may be falsely predicted as arrays by CRISPR prediction algorithms. The combined analysis is robust to the removal of any of the predictors or combinations of predictors (Supplementary). Normally a prediction is made that depends on several methods. This confidence score normally ranges from 2.6 (where all parameters when added are concordant, Section 2.2.8) to 0.04 (when predictors are discordant or most are NP). For each prediction, the confidence score can be used to classify the prediction as high, medium or low confidence (Section 2.2.8). The 32 arrays, mainly bacterial, for which a false prediction was made had no obvious similarity in terms of species origin, repeat sequence or likely class (Supplementary). However, 30 of the 32 false predictions were classified as low confidence. In the future, CRISPRDirection could be built into a more sophisticated CRISPR array finding algorithm. This could include additional automatically calculable parameters, or user inputted parameters. We observed that specific sequences are common near the ends of the repeats, such as GAA 3 0 , GTT 5 0 , and specific sequences are also found in the leader/promoter region. These could likely be used to refine the prediction algorithm, particularly in those cases where the direction is unable to be called with confidence. This could also be provided in a later interactive CRISPR prediction interface where expert users could input relevant predictors, or balance the parameters for their own species.
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
A.Biswas et al. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
Accurate computational prediction of the transcribed strand of CRISPR non-coding RNAs at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
