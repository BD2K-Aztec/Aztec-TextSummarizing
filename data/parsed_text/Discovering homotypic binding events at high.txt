Motivation: Clusters of protein–DNA interaction events involving the same transcription factor are known to act as key components of invertebrate and mammalian promoters and enhancers. However, detecting closely spaced homotypic events from ChIP-Seq data is challenging because random variation in the ChIP fragmentation process obscures event locations. Results: The Genome Positioning System (GPS) can predict protein– DNA interaction events at high spatial resolution from ChIP-Seq data, while retaining the ability to resolve closely spaced events that appear as a single cluster of reads. GPS models observed reads using a complexity penalized mixture model and efficiently predicts event locations with a segmented EM algorithm. An optional mode permits GPS to align common events across distinct experiments. GPS detects more joint events in synthetic and actual ChIP-Seq data and has superior spatial resolution when compared with other methods. In addition, the specificity and sensitivity of GPS are superior to or comparable with other methods. Availability: http://cgs.
INTRODUCTIONThe precise physical description of where transcription factors, histones, RNA polymerase II and other proteins interact with the genome provides an invaluable mechanistic foundation for understanding gene regulation. ChIP-Seq (Chromatin immunoprecipitation followed by high-throughput sequencing) has become an indispensable tool for genome-wide profiling of protein-DNA interactions (). Computational methods are necessary to predict the location of proteinDNA interaction events from ChIP-Seq data because random variation in the ChIP DNA fragmentation process obscures the actual location of interaction events. Thus while ChIP-Seq DNA sequence reads are mapped to precise bases in the genome, these reads do not manifestly indicate the location of the proteinDNA * To whom correspondence should be addressed. interaction events that caused them. We define spatial resolution to be the difference between the computationally predicted location of a proteinDNA binding event and the midpoint of its actual location. An ideal computational method for analyzing ChIP-Seq data would accurately localize protein-DNA interaction events (high spatial resolution), would include no false events (high specificity), would include all true events (high sensitivity), and would be able to resolve closely spaced DNA-protein interactions (joint event discovery). Joint event discovery is important because it can capture cooperative biological regulatory mechanisms in proximal genomic locations (). Homotypic clusters of transcription factor binding sites (TFBS) have been extensively studied in Drosophila (). Such regulatory mechanisms may be common in mammalian genomes as 4060% of certain ChIP-Seq defined protein-DNA interaction regions contain more than one motif within 200 bp (). Furthermore, homotypic clusters of TFBS occupy nearly 2% of the human genome and may act as key components of almost half of the human promoters and enhancers (). Thus, homotypic event discovery is necessary to fully reveal the transcription factor regulatory interactions present in ChIP-Seq data. Existing ChIP-Seq computational methods () do not simultaneously consider multiple events as the cause for observed reads in the context of a probabilistic model at mammalian genome scale. To detect binding events, PeakSeq extends the length of mapped reads to create peaks (), MACS shifts the mapped position of reads a fixed distance towards their 3-ends (), FindPeaks aggregates overlapping reads (), SISSRs identifies positive to negative strand transition points at read accumulations (), cisGenome scans for the center of modes of the 5 and 3 peaks (), and QuEST () and spp () use kernel density estimation methods. All of these methods use statistical detection criteria such as overlapping read counts or read distribution strand symmetry to estimate the location of a proteinDNA interaction event. A recent method named CSDeconv deconvolves proximal binding events using a computed spatial read distribution (), although it is at present computationally impractical on entire mammalian genomes. In addition, recent evaluations showed that while all these methods identified binding sites with a highly significant overlap with the corresponding sequence motif (), and exhibited similar sensitivity and specificity, there are pronounced differences in their spatial resolution ().Page: 3029 30283034
Homotypic binding events at high spatial resolutionWe present the Genome Positioning System (GPS), a highresolution genome-wide ChIP-Seq analysis method that can accurately detect closely spaced protein-DNA interaction events (joint events). GPS detects more joint events in synthetic and actual ChIP-Seq data and has superior spatial resolution when compared with other methods. In addition, the specificity and sensitivity of GPS are superior to or comparable with other methods.
METHODS
GPS model overviewGPS has three phases: spatial distribution discovery, event discovery and the determination of event significance. In its first phase, GPS summarizes the observed spatial distribution of reads from proteinDNA interaction events in the input ChIP-Seq data. The farther a mapped read is located from an event, the less likely it is to be caused by the event (). We assume in GPS that for a given ChIP-Seq experiment, every interaction event will produce the same characteristic distribution of reads. While this assumption will not always be true, we have found that it produces good results in practice. Note that reads from joint events will spatially mix with one another along the genome, presenting a challenge for precisely estimating the multiplicity and exact positions of proximal proteinDNA interaction events (). In its second phase, GPS employs a probabilistic mixture model to assign an event probability to every base in the genome. Each potential event's contribution to generating the observed reads is modeled (and d). A sparse prior on event probabilities provides a complexity penalty that biases events to have their probability mass at a single base position. Event probabilities are selected to maximize the penalized likelihood of observed reads using a multi-resolution EM algorithm that segments the genome into efficiently solvable subproblems. GPS uses the number of reads assigned to a base by the mixture model as a measure of the relative strength of a predicted event at that base. In its third and final phase, GPS filters discovered events by comparing the number of reads at the predicted events to the corresponding normalized(a) Protein-DNA interaction events at positions 1 and 2 on the genome result in DNA end sequence reads in the ChIP-Seq protocol. (b) The observed spatial read density (blue: '+' strand, red: '' strand) from 4000 CTCF events aligned with respect to the CTCF motif position at each event (c) GPS models ChIP-Seq reads as being generated by a mixture of binding events at every genomic base, with each event producing the characteristic spatial read density. (d) A sparse prior on mixture components causes GPS to assign events to as few bases as possible to explain the observed reads (green and orange reads). In GPS, a given read can be explained by more than one event (yellow reads). number of reads in the control channel. We compute the statistical significance using the binomial distribution () and correct for multiple hypothesis testing by applying a Benjamini-Hochberg correction ().
GPS mixture modelGPS is based on a generative mixture model that describes the likelihood of an observed set of ChIP-Seq reads from a set of proteinDNA interaction events. Each event contributes a distribution of reads surrounding its genomic position to the mixture of reads. We assume that reads are independent conditioned on the locations of their underlying causal events. GPS performs event discovery by finding the set of proteinDNA interaction events that maximizes the penalized likelihood of the observed ChIP-Seq reads. We consider N ChIP-Seq reads that have been mapped to genome locations R = {r 1 , ..., r N } and M possible proteinDNA interaction events at genome locations B = {b 1 , ..., b M }. We represent the latent assignments of reads to the location of events that caused them as, where z n = j when j is the index of the event located at position b j that caused read n. The conditional probability of read r n being generated from event j iswhere emp(d) is the empirical spatial distribution that models the probability of a read occurring d bases away from its corresponding event position. Strand sense is handled by s n = 0 or s n = 1 if read r n is mapped to the forward strand or reverse strand, respectively. We assume that all the events in one ChIP-Seq experiment have the same empirical spatial distribution. The empirical spatial distribution is obtained from ChIP-Seq data (see below). The probability of a read is a convex combination of possible binding eventswhere M is the number of possible events,  denotes the parameter vector of mixing probabilities, and  j is the probability of event j,The overall likelihood of the observed set of reads is then,Our assumption is that binding events are relatively sparse throughout the genome. To model this assumption, we place a negative Dirichlet prior distribution (where  is a tuning parameter to adjust the degree of sparseness. If for event j, the value of  j becomes zero (see component elimination below), the model is restructured to eliminate it.
EM algorithmWe solve for the MAP (maximum a posteriori) solution for  using the ExpectationMaximization (EM) algorithm (). The complete data log penalized likelihood isis the indicator function. We initialize mixing probabilities  with uniform probabilities,  j = 1/M, where j = 1, .
.., M.Page: 3030 30283034
Y.Guo et al.At the E step, we use the current parameter estimates  to evaluate the expectation of Z given R,We can interpret (z n = j) as the fraction of read n that is assigned to event j. This is referred to as a 'soft assignment' because read n can be assigned partially to multiple events. At the M step, on iteration i we find parameterparameter parameter (i) to maximize the expected complete-data log penalized likelihood,By simplifying, we find find find(i)where N j is the expected number of reads assigned to event j. As we iteratively estimat , we use a component elimination method (). If N j  , we set  j = 0 to eliminate event j. Our final estimate ofof of (i) is is isThe sparseness parameter  can be interpreted as the minimum number of reads that an event needs to survive the EM iterations. The EM algorithm is deemed to have converged when the change in likelihood falls below a specified threshold. Our implementation of component elimination includes two special cases. To avoid premature elimination of components during EM iterations, we start with  = 0 for a number of iterations to allow nascent components to gain support from the data. We then set  to our desired value. This is because when the number of components M is large, no component may have enough initial support to prevent  from being immediately forced to zero. Furthermore, in a single iteration we do not eliminate all the components that meet the criteria N j  . Instead, we only eliminate the components with the lowest value of N j at each iteration. This allows the data points that supported the eliminated components to be re-distributed immediately to support the other components. At the convergence of the EM algorithm, the GPS mixture model produces a list of non-zero-probability events  j = 0, and the 'soft' read assignments to these events (z n = j). We do not use the mixing probabilities  in subsequent analysis because we segment the genome into regions for analysis, and  values are dependent on the region analyzed. We define event strength as the expected number of reads associated with the event. Thus the event strength of event j is calculated as
Empirical spatial distribution of readsGPS iteratively estimates the empirical spatial distribution of reads directly from ChIP-Seq data. Given a set of events, we count all the reads at each position relative to the corresponding event positions. Only the base positions within 250 bp of the event are counted because typical ChIP-Seq protocols performs a size selection in the range of 150300 bp () and we have empirically found that the probability of generating reads at positions further than 250 bp is not significant. The initial set of events for estimating the empirical spatial distribution can be defined by using known motifs or by finding the center of the forward and reverse read profiles (). With the predicted event positions from GPS, we can re-estimate the empirical spatial distribution and use it for more accurate prediction. This process can be repeated until convergence (Supplementary).
Statistical significance of predicted eventsTo evaluate the statistical significance of predicted events when we have a control dataset, we compare the number of reads of the IP event to the number of reads in the corresponding region in the control sample. For non-overlapping events, we count the number of control reads in the range of the empirical spatial distribution (250 bp). For joint events, we need to assign control reads to the corresponding events. We run the EM algorithm without the sparse prior (no component elimination, equivalent to  = 0) on the control data, initializing the events j at the same positions as predicted IP events. The M step of EM algorithm is modified as
as as(i)To account for differences between IP and control dataset sizes, we multiply the control reads by a scaling factor. We divide long non-specificbinding regions (defined by excluding the 'enriched regions') into short segments (length 10 Kb) and perform least-squares linear regression using all the read count pairs of IP and control segments that have at least one mapped fragment. The slope of the regression is then the scaling factor, F IP/C , between the read counts from the IP and control (). Using a statistical testing method proposed by, we calculate the P-value from the cumulative distribution function for the binomial distribution using the corresponding IP and scaled control read counts, F(k,n,where k is the scaled control read count, n is ceiling of total count of IP and scaled control reads, P = 0.5, which is the probability under the null hypothesis that reads should occur with equal likelihood from the IP as from the control data. To correct for multiple hypothesis testing, we apply a BenjaminiHochberg correction to adjust the P-value (). All the predicted events that are tested for significance are ranked by P-value from most significant to least significant. For each event, the Q-value is given by
Q-value = P-value count rankwhere count is the total number of events tested. Significant events are then selected using a Q-value threshold. If control data is not available, we apply a statistical test proposed bythat uses a dynamic Poisson distribution to account for local biases. The dynamic parameter of a local Poisson model for the candidate event is defined aswhere the  BG ,  5 kb ,  10 kb are  estimated from corresponding chromosome (background), 5 kb or 10 kb window centered at the event location, to capture the background variability at both global and local scales. The P-value is calculated to be the upper tail of the Poisson distribution,where n event is the read count of the candidate event. To correct for multiple hypothesis testing, we apply a BenjaminiHochberg correction as above.
Artifact filteringGPS filters the predicted events by computing the KullbackLeibler divergence () from the empirical read distributionPage: 3031 30283034
Homotypic binding events at high spatial resolutionwhere event() is the distribution of non-zero read count of the event computed from the EM algorithm, and emp() is the empirical read distribution with the corresponding positions of the non-zero reads, i is the index of the non-zero read positions. Events with a KullbackLeibler divergence value higher than a user defined threshold are discarded.
Event alignment across independent experimentsTo align events across experiments, we first apply the GPS model to the combined data from all experiments to discover a global set of events, and then use this global set of events to condition a modified version of GPS for experiment specific event discovery (). Events from the global set represent a superset of potential events for each experiment. Thus, we allow only the  components corresponding to these global events to be non-zero for the discovery of experiment specific events. A uniform initial weighting is assigned to these possible events. Since the global set of events is sparse, we do not use a sparse prior on  for each condition. The complete alignment algorithm is described in the Supplementary Notes.
GPS has an efficient implementationWe have implemented GPS in Java, and our software is available for download from our website (http://cgs.csail.mit.edu/gps). For computational efficiency GPS independently processes separable genomic regions. We identify separable regions with a conservative method that spatially segments the genome at read gaps that are larger than the width of empirical spatial distribution (500 bp) and further excludes regions that contain fewer than six reads. The segmented protein binding regions are typically a few thousand base pairs long. To further reduce memory requirements and run time, GPS estimates events in two stages for each region. In the first stage, events are spaced at 5 bp intervals to make a rough estimate of event locations. In the second stage, events are spaced at 1 bp near locations predicted in the first stage. For the CTCF ChIP-Seq experiment in this study (4.2 million IP reads and 7.9 million control reads), GPS requires 750 MB of main memory, and runs for 21 min on an AMD 64-bit 2.3 GHz computer.
RESULTS
GPS predictions have higher spatial resolutionWe analyzed the performance of GPS on ChIP-seq data profiling the insulator binding factor CTCF (CCCTC-binding factor) (), as the strong CTCF motif allows us to reliably measure spatial resolution. We used GFP ChIP-Seq data () in the third phase of GPS to control for non-specific binding. We found that the spatial resolution of GPS on the CTCF data is superior to the spatial resolution produced by seven published ChIP-Seq analysis methods (, Supplementary): MACS (), SISSRs (), cisGenome (), QuEST (), FindPeaks (), spp-wtd and spp-mtc (). Because different methods predict different sets of binding events (Supplementary), we limit our comparison to a matched set of events.), and thus our analysis of CTCF data shows that GPS has superior spatial resolution to these seven methods. By evaluating the fraction of identified binding sites that contain a CTCF binding motif, we found that GPS, MACS and FindPeaks achieve higher specificity overall than the other methods and GPS performs better for the high-ranking predictions (Supplementary). GPS also achieves marginally better sensitivity in discovering binding events that are supported by CTCF binding motifs (Supplementary).
GPS discovers more joint eventsUsing synthetic data we found that GPS is able to detect more joint events than other methods. We generated synthetic events by placing ChIP-seq binding events from actual CTCF data at predefined intervals (Supplementary Notes). GPS detects 99.7% of joint events that are 200 bp apart, while SISSRs only detects 54.578.0% of joint events that are 200750 bp apart, respectively. MACS and QuEST detect joint events only when they are more than 280 bp apart. MACS detects 97.9% and QuEST detects 88.4% of joint events when they are separated by 750 bp (). GPS is also able to predict more joint events than the other methods we tested on actual ChIP-Seq data. For example, GPS uniquely detects two CTCF events in mouse ES cells over proximal CTCF motifs that are 99 bp apart on chromosome 8 (). However, the CTCF dataset does not contain a sufficient number of joint events to effectively evaluate the methods on a whole genome scale (Supplementary). We selected a human Growth Associated Binding Protein (GABP) ChIPSeq dataset for our evaluation because GABP ChIP-Seq data Page: 3032 30283034were previously reported to contain joint events (). We identified 581 candidate sites of joint events that all had at least one event detected by all five methods and where each site contains two or more GABP motifs separated by <500 bp. GPS identified joint events in 122 candidate sites, while SISSRs and QuEST detected joint events at fewer than 83 of the candidate sites, and MACS and cisGenome only identified 3 and 5 of the candidate sites as containing joint events respectively (). In addition, we compared GPS with CSDeconv on a 2 Mb region of GABP ChIP-Seq data that CSDeconv could process (). GPS found four joint events with clustered GABP motifs while CSDeconv found two joint events (Supplementaryand Supplementary).
Y.Guo et al.
GPS aligns events across multiple experimentsBecause transcription factors bind at sequence-specific sites, we would expect them to bind at the same genome location in different conditions. We have generalized the GPS model to optionally align events across multiple experiments by considering the data from independent experiments simultaneously. In alignment mode, a global mixture component biases events to be aligned, and also provides improved spatial resolution for events that are shared by a collection of experiments (Supplementary). In addition, event alignment across experimental conditions provides a straightforward way to detect events that are lost and gained between experimental conditions. We performed GPS in multicondition alignment mode using human CTCF ChIP-Seq data from two different cell types (GM12878, HUVEC) produced by the ENCODE project () and determined the distribution of the distances between all the events across conditions. We limit our evaluation to a distance range of <500 bp because events outside of this window are likely to involve independent sites. Within this window, GPS aligns 45.5% of the events to be at the same genomic position (). The presence of closely spaced unaligned events (conditions to be aligned. When GPS was performed on data from both cell types independently, only 13.7% of events are within 10 bp, and about 3040% of the event distances are in the range of 10100 bp (). This suggests that events occurring at the same genomic position in two conditions are likely to be predicted to occur at different locations with independent event discovery. Thus the alignment mode of GPS provides a simple way to recognize events that are gained and lost in a particular condition.
Homotypic binding events at high spatial resolution
DISCUSSIONGPS is a novel computational method that uses a probabilistic mixture model to predict the most likely positions of binding events at single-base resolution based on a characteristic spatial distribution of reads. Our analysis with synthetic and actual ChIP-Seq data demonstrates the value of our approach in resolving closely spaced joint events and improving event spatial resolution. GPS's ability to resolve homotypic events from ChIP-Seq data will facilitate the genome-wide study of cooperative binding on gene expression under specific biological conditions. Homotypic binding sites have been shown to act as key components of invertebrate and mammalian promoters and enhancers (). In addition, modeling based approaches have demonstrated that identifying homotypic binding is important for the faithful reproduction of biological behaviors (). GPS also provides improved spatial resolution, specificity, and sensitivity when compared with contemporary methods. The high spatial resolution of GPS can be used to produce a positionspecific prior () that can be used by motif discovery methods to limit motif search to tight genomic regions around events (Supplementary Notes, Supplementary), or can exclude event locations for co-factor motif discovery. In addition, we expect that alternative empirical read distributions can be used for different kinds of events, such as histone location, as the GPS framework is inherently adaptable to other empirical read distributions.
The Author 2010. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oup.com at :: on August 31, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
at :: on August 31, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
