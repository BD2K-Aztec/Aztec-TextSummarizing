Motivation: Over the last decade, both static and dynamic fragment libraries for protein structure prediction have been introduced. The former are built from clusters in either sequence or structure space and aim to extract a universal structural alphabet. The latter are tailored for a particular query protein sequence and aim to provide local structural templates that need to be assembled in order to build the full-length structure. Results: Here, we introduce HHfrag, a dynamic HMM-based fragment search method built on the profile–profile comparison tool HHpred. We show that HHfrag provides advantages over existing fragment assignment methods in that it: (i) improves the precision of the fragments at the expense of a minor loss in sequence coverage; (ii) detects fragments of variable length (6–21 amino acid residues); (iii) allows for gapped fragments and (iv) does not assign fragments to regions where there is no clear sequence conservation. We illustrate the usefulness of fragments detected by HHfrag on targets from most recent CASP. Availability: A web server for running HHfrag is available at http:// toolkit.tuebingen.mpg.de/hhfrag. The source code is available at
INTRODUCTIONThe success of many protein structure prediction methods critically depends on the existence of structural templates and our ability to detect them. It seems that known protein structures have reached a sufficient level of diversity for template-based structure prediction (). The percentage of new folds in the Protein Data Bank (PDB) () dwindles, and even the new folds tend to reuse building blocks such as super-secondary structure motifs shared with non-homologous proteins (). The new folds add to PDB's diversity by providing new arrangements of known motifs rather than by introducing completely novel building blocks. Also our ability to identify structural templates has reached a level of sensitivity such that the boundaries between homology modeling and threading methods blur (). Structures evolve more * To whom correspondence should be addressed. slowly than sequences and therefore highly divergent sequences may still share a common structure. The critical threshold of 30% sequence identity has been pushed to ever smaller values by profile profile methods () superseding conventional sequence comparison algorithms. Even if no full-length template exists or if we fail to detect it, there is still hope for structure prediction. Segments of the query profile may show significant similarity to short conserved regions in proteins from different folds. Such recurring sequence patterns often correlate with persistent local structure. Examples of recurring motifs have been compiled into the I-Sites fragment library () and proved useful in protein structure prediction (). I-Sites aims to build a concise, static dictionary of reusable fragments and is an early attempt to discover a universal 'structural alphabet' (). In contrast, dynamic methods such as Rosetta's fragment extraction module NNmake () aim to create a fragment library that is customized to the query sequence. Although dynamically extracted fragments often correspond to the recurring motifs of static approaches, no attempt is made to compile them into a non-redundant universal dictionary. Static fragment libraries trade low sequence coverage for high precision. Therefore, dynamic fragment search seems more suitable for structure prediction. In conserved regions, also a dynamic approach should be as accurate as static libraries. But in nonconserved regions, the better coverage of dynamic fragment search comes at the price of reduced precision. Another limitation is that fragments typically come in fixed size, with 9mer fragments being a popular choice (). This is more for technical convenience rather than having a specific biological meaning. The actual instances of a structural motif often show variable lengths with extensions or deletions at the termini. I-Sites tries to address this problem by defining a set of overlapping, partially redundant motifs. The Rosetta fragment selection tool NNmake searches a database of crystal structures with better than 2.5  resolution and pairwise sequence identity <50% (). All nine residue windows from the query sequence are compared to the database entries using a score that is based on sequence profile comparison and secondary structure match. The PSI-BLAST profiles of the query and the candidate fragments are compared using the cityblock distance metric. This method has been extended by the FRazor dynamic fragment selection tool (). Using integer linear programming, FRazor combines the sequence profile similarity score with additional structural features (secondary structure, solvent accessibility and contact capacity) in order to improve the fragment selection. An alternative to fragment selection is the recent development of fragment sampling from probabilistic
HHfrag: HMM-based fragment detection using HHpredmodels. This approach has been pioneered by Hamelryck and coworkers ().have developed similar approaches but use different types of latent networks. The basic idea of fragment sampling is to not select fragments from a structure database, but to learn generative models of local protein structure such as hidden Markov models. The advantage of this approach is that the possible structures of a fragment are represented probabilistically such that there is no restriction caused by the size and diversity of a structure database. For every sequence, it will be possible to generate fragment structures and to assess their likelihood. The TorusDBN model () was shown to generate conformations that are locally as accurate as structures obtained with Rosetta. HHsearch () has proven to be a very sensitive profileprofile comparison tool for template selection in comparative modeling and threading (). Here, we extend its scope to the case when the structure database does not provide a full-length template. We take advantage of HHsearch's high sensitivity in order to detect local regions of structural similarity, shared among proteins across different folds. Once these regions are identified in the target sequence, our method attempts to find and excise matching segments with known structure and to build a fragment library that is: (i) dynamic (i.e. fragments are customized to the query sequence aiming at high coverage); (ii) flexible (i.e. fragments are variable in length but also allow for gaps and gapped fragment assignments) and (iii) precise (i.e. conserved regions are not buried in a large number of false positives). We have benchmarked our fragment search method on 105 proteins from CASP 9 and observed an increased precision (compared with Rosetta's fragment search) as well as an increased sequence coverage (compared with I-Sites). A fragment library that shows a higher coverage than a static dictionary and that is, at the same time, more precise than the dynamic Rosetta approach should allow for more efficient sampling of conformational space by fragment assembly. This implies that an ab initio model of the target structure can be built in less number of trials and from better decoys. We support this notion by applying our fragment library to CASP 9 targets using a modified Rosetta ab initio protocol, adjusted to work with fragments of variable length.
METHODSGiven a query sequence of unknown structure, our method builds a dynamic library by excision of fragments from a non-redundant structure database. First, the query HMM is divided into a set of overlapping HMM fragments of variable length (621 residues). The optimal boundaries of each query HMM segment are determined dynamically: HMMHMM comparison probes each fragment for recurrence in the structure database. Second, an ordered fragment map is compiled by finding the locally optimal regions of similarity between the query HMM segments and the HMMs in the structure database.
Generation of HMM profilesWe use the standard HHpred toolchain () to build a profile-HMM of the query sequence and the sequences in the template database. This step involves generation of multiple alignments with several rounds of PSI-BLAST (). In addition to a pure sequencebased score, predicted and observed secondary structure is taken into account. We use DSSP () to calculate eight-state secondary structure assignments for known structures from the template database. The query sequence is also converted to a profile HMM with predicted three-state secondary structure using PSIPRED (). Each final(b)HMM comprises amino acid emission probabilities and secondary structure propensities and is built using HHmake with pseudo-count correction.
Template databaseTo strip down homologies from the PDB, we use the April 2010 build of PDBselect25 () as template database. There are 4824 chains in the set sharing sequence identity up to 25%. For each structure, a profile HMM (sequence profile and secondary structure) is generated using the above procedure and the 3D coordinates are extracted. We refer to the resulting set of HMM/3D structure pairs as PDBS25-HMM template database.
Fragment extraction and assignmentThe fragment extraction routine uses the HHsearch algorithm for HMMHMM alignment (). HHsearch scores via co-emission probability of the amino acid distributions at each profile column and through secondary structure match. In all HHsearch runs, the hit list includes all matches with probability 0.2. If there are no or less than 10 hits with probability greater than this threshold, additional hits with lower probability, if available, will be included until the number of hits is at least 10.shows a flowchart of our dynamic fragment search (a detailed description of HHfrag can be found in the Supplementary Material). The search consists of two phases: (i) identification of flexible query segments and (ii) fragment search. The first step is detailed in the next subsection. In the second phase, each query fragment HMM is compared against the template database using local HMMHMM alignment (HHsearch with default parameters).
I.Kalev and M.HabeckAligned regions in the database entries are excised as template fragments if they are at least six residues long. Finally, we build a position-specific fragment map that combines all extracted fragments (seefor example). Each fragment in the map is described by a profile HMM segment (621 residues in length), a 3D structure and its position in the query profile.
Identification of flexible query segmentsWe aim to determine fragments that are flexible in length because it is unlikely that a fixed length will work for all types of fragments equally well. Since HHsearch uses a local alignment algorithm, alignment of the fulllength query profile over a set of templates will produce a list of template fragments with variable length. However, HHsearch still tends to maximize the number of matches between the template and query profile and does not necessarily focus on the conserved blocks. The default search behavior of HHsearch is therefore not suited to decompose the query sequence into short conserved motifs. To trigger the desired local search behavior, we chop the query HMM into a nested set of segments. At a given column c, this procedure results in a list of candidate query segments spanning residues (c,c+6) to (c,c+21). However, the excision of a profile segment with a fixed position is an inherently 'violent' act that may destroy the information encoded in the entire profile in the same way as blindly extracting a word from a sentence may yield a truncated word. We use the number of hits to rank the integrity of the candidate query segmentsthe candidate with the highest number of matches is likely to be the one that survives the excision with minimal 'damage'. For each candidate fragment, we run HHsearch and collect local profile matches in the PDBS25-HMM database. The query segment achieving the maximum number of hits is chosen as optimal query segment, because it has the highest degree of recurrence among the candidates and the best chance of collecting true positives when used for query. After shifting the origin of the nested segments by three, we find the next query segment and thereby obtain optimal query fragments at positions 1+3i.
Assessment of fragment searchesWe use several criteria to assess the performance of fragment searches. A fragment is considered a true hit or true positive if the C RMSD to the native structure is below a threshold value (typically 1.5 ). Since the RMSD is strongly length dependent, we also ran tests with a length-independent definition of true positives. However, we found that the overall picture of our results does not change (for details see Supplementary Material). We therefore use the conceptually simpler definition of a true positive based on RMSD (). The precision is the percentage of true positives among the fragments assigned to the query. We report local residuewise precision that assesses the percentage of true hits covering a specific residue. We also report the global precision measuring the percentage of true positives assigned to the entire target. The coverage is the percentage of target residues that are covered by at least one truly positive fragment (). Precision and coverage depend on the true positive threshold and increase if the threshold increases. Figures reporting all criteria are found in the Supplementary Material.
Fragment selection with Rosetta NNmakeAll Rosetta 9mer and 3mer fragment libraries were generated using NNmake and the default Rosetta Fragments database taken from Rosetta v3.1. We used only PSIPRED secondary structure predictions and therefore the fragment generation program was started with the relevant command line arguments to suppress all other secondary structure prediction options.
Fragment sampling with TorusDBNAs an alternative to NNmake, we used the TorusDBN model byto sample protein conformations with a generative probabilistic model. For a given query sequence, we instantiated a TorusDBN model based(b)on the sequence and predicted secondary structure and drew 100 random conformations. For calculation of the precision and accuracy, we used 9mer fragment structures excised from the full-length samples.
Decoy generationTo test our fragments in ab initio structure prediction, we have built a modified version of the standard Rosetta AbinitioRelax application from the Rosetta 3.1 C++ source distribution. We store the fragment library in Rosetta fragment format and directly feed it into AbinitioRelax in place of the standard 9mer library. We generate 1000 decoys per target. Each decoy is superimposed to the native structure of the target using local RMSD fitting and ranked by C RMSD and TM-score ().
RESULTS AND DISCUSSION
From static to dynamic fragment librariesOur initial goal was to create a static dictionary of fragments from profile HMMs. One of the issues that we wanted to address was the restriction to a fixed fragment length. To determine recurrent fragments of variable length, we use the approach outlined in Section 2.4. This approach rediscovers most of the motifs present in I-Sites but does not improve the coverage significantly, which makes sense intuitively because any attempt to describe a large cluster of fragments by a single profile will eventually decrease the sensitivity of the profile. We also find that many of the long fragments in our static library correspond to more than one I-Sites motif, suggesting that some fragments could be decomposed further into submotifs. Some proteins in the template database contain instances of the 'full' motif, while others have only 'partial' or even 'minimal' matches. This modularity is also observed in the I-Sites library itself (). Some I-Sites motifs are highly related in terms of sequence and structure and refer to a common core motif. We also found instances Page: 3113 31103116of fragments that contain minimal gaps or insertions, which suggests that there is no 'optimal' length for a given fragment and that it should be beneficial to allow for greater flexibility when defining fragment boundaries. Comparison of the performance in fragment assignment between I-Sites and a classical dynamic approach (Rosetta fragments) shows that I-Sites as well as our own static library is highly specific, but the sequence coverage is insufficient for structure prediction (). On the other hand, Rosetta's fragment extraction module achieves excellent coverage but tends to bury the good fragments in a vast number of low-quality hits.
HHfrag: HMM-based fragment detection using HHpred
Dynamic fragment detectionBased on the above observations, we decided to keep our fragments variable in length but make the fragment extraction routine truly dynamic with the aim of increasing the coverage while maintaining the current high level of precision.shows an example where our method may look outperformed by Rosetta in terms of coverage: Rosetta reaches 87% coverage at an RMSD threshold of 1.4 , whereas HHfrag's coverage is 76% at the same threshold. However, coverage alone is a misleading metric. Coverage counts the number of residues that are covered by at least one fragment with acceptable structure but does not assess how many of the assigned fragments are actually correct. The picture changes significantly if one considers also the precision of the fragments and asks oneself: if, at a given position in the query sequence, we pick one of theassigned fragments randomly, what is the chance that this fragment will have the correct structure? For the same target, HHfrag has 1.5-fold higher precision than Rosetta at the same RMSD cutoff. The position-specific precision (; see also Supplementary Material) reveals that the quality of the assigned fragments is not uniform along the sequence of the query. Plots of the local precision usually demonstrate a characteristic shape. We observe well-expressed peaks of high-quality fragments connected by regions with no or very uncertain assignments. The high-quality regions exhibit a strong sequence signal and typically correspond to recurrent motifs similar to the I-Sites paradigms. The profiles of the I-Sites motifs always align to query regions where HHfrag assigns a high amount of truly positive fragments, 8018% on average. The unassigned and/or low-quality regions show the highest variability and uncertainty, and need to be modeled using a brute-force approach during an ab initio structure prediction. The fact that HHfrag does not assign fragments to uncertain regions ('white regions' in the fragment map) should be considered a feature rather than a shortcoming, because it indicates that such areas require special treatment during modeling. However, current structure prediction protocols such as Rosetta AbinitioRelax may not be able to take advantage of this information (Supplementary Material). The residue-wise precision diagrams have also similar patterns for both our and Rosetta's fragment maps. The locations of the highaccuracy peaks along the target sequence are correlated. However, the Rosetta histograms display a peculiar triangular shape, whereas HHfrag assignments have a more block-like structure. The peaks in NNmake's fragment map are sharp, and the precision quickly decreases as we move away from the maximum. This behavior can be explained by the lack of context variability of the Rosetta fragments and illustrates some of the disadvantages of using fragments of constant length. The main advantage of HHfrag is therefore the ability to focus more precisely on the actual boundaries of the conserved regions. Gapped fragment assignments have a small impact on the global precision of the method provided that the database of structural templates is diverse enough (Section 3.3). However, the ability to detect insertions and deletions may have a decisive advantage if the database contains only few instances of a structural motif.
Page: 3114 31103116
I.Kalev and M.Habeck
BenchmarkWe used 105 target sequences from the CASP 9 competition (http://www.predictioncenter.org/casp9/) to test the performance of our dynamic fragment search method. The experimental structures of the benchmark proteins have been published after May 2010 and therefore do not appear in our template database. For each target, we built a position-specific fragment map (see Section 2) and compared its performance to a reference Rosetta 9mer fragment map. The C coordinates of all fragments were superimposed onto the native structure of the target based on the fragment map (shows an example).shows the distribution of fragment lengths found by dynamic HHfrag searches. The distribution of fragment lengths peaks at a value of seven, but shows significant probability for detecting longer fragments (the average length is 10.33.6). The average sequence coverage of HHfrag is 7113% (). If we restrict the analysis to residues in regular secondary structure, the coverage rises to 8414%. The percentage of residues that remain completely unassigned (white regions) is 1912%.This is a significant improvement over static libraries such as ISites and an acceptable loss in coverage compared with Rosetta's fragment selection module reaching 906% coverage.provides also a summary of the global precision for all targets in the benchmark. On average, HHfrag obtains a precision of 6216%, which is a significant improvement over Rosetta's fragment selection with a precision of 3817%. The improvement in the precision is two-fold on average and for some targets achieves a dramatic increase by a factor of 4 to 6. This improvement is clearly consistent across all three CASP target categories. We also compared the quality of fragments extracted with HHfrag with generative statistical models that capture local sequence structure correlations. We used the TorusDBN model of
HHfrag: HMM-based fragment detection using HHpredconformations with the HHfrag fragment assignments (; see Section 2 and Supplementary Material for more details). This comparison shows that HHfrag produces more accurate and less heterogenous local structural fragments than the TorusDBN model (average precision 28.416.3%, average coverage 91.36.5%). At this instance, we would like to point out that comparison of fragment selection and fragment sampling methods is a non-trivial issue. In HHfrag, not all residues are assigned the same number of fragments, because we use fragments of variable length and because HHsearch assigns a variable number of hits to a query segment (on average there are 39 such hits). This will potentially lower the coverage of HHfrag's fragment selection in comparison to methods that use a fixed number of top scoring fragments such as NNmake. However, coverage is not the only important parameter, and the major goal of HHfrag is to find a trade-off between precision and coverage. There is a fundamental difference here between fragment selection and fragment sampling. In fragment selection by searching a database, some residues (typically located in loops) will never be assigned a fragment for various reasons: either these residues are highly non-conserved and the fragment detection fails or the database of templates is not comprehensive enough. In probabilistic fragment sampling, on the other hand, there is always a non-zero change that every residue will be covered as long as we sample long enough. In the limit of infinitely many samples drawn from a generative probabilistic model such as TorusDBN, the coverage will approach one, but the precision may drop to very low values if the native fragment is not contained in the high probability density region. This shows that coverage is not the only quantity that should be looked at. Also for practical purposes, we want a small number of fragments, which is valid for HHfrag. Of all true positive fragments (RMSD < 1.5 ) found by HHfrag 90.8% have uninterrupted structure. However, gapped fragments have been extracted at least once for 98 out of all 105 benchmark proteins. These gaps typically represent very small insertions or deletions in or around the central region of the motif (see the Supplementary Material). With the current degree of structural diversity of the PDBS25-HMM database, the gapped assignments are not strongly influencing the overall performance of HHfrag. However, 8.4% of the best-fitting fragments per query position are in fact part of gapped assignments, which suggests that gap detection may be useful when the number of available local templates is limited.
Impact on decoysThe performance of our variable-length fragment libraries with refined precision was tested in ab initio protein folding experiments (; see also Supplementary Material). After modifying the original Rosetta AbinitioRelax protocol to accept fragments of variable length, we generated decoys for a subset of the proteins in our benchmark. Initially, we found 15 targets for which the BAKER-ROSETTASERVER has submitted models on CASP 9 with comparable or even better quality than the HHpredA server. Following the guidelines in the AbinitioRelax's documentation, we picked the 11 shortest single-domain targets with lengths up to 150 residues to ensure that Rosetta has a good chance to predict their structure with reasonable accuracy. After generating 1000 decoys for each target in the subset using standard parameters and fragments detected with Rosetta NNmake, 4 targets remained for which Rosettaperformed well: 3nzlA, 2l01A, 2l02A and 2l09A. The exact criteria for selection were as follows:(i) average TM-score to the native greater than the random (0.17) and (ii) at least 2% of all decoys have significant TM-score (>0.4). For each target, we repeated the AbinitioRelax protocol with exactly the same parameters, except for the 9mer fragment library, which was substituted by a corresponding HHfrag-derived variable-length fragment library. In all instances, we observed a positive shift in the distribution of decoy TM-scores implying an increased accuracy of the predicted structures (). HHfrag shifts the position of the most populated TM-score bin and increases the fraction of good decoys (TM-score > 0.4) by 31, 26, 14 and 29%, respectively. Although the best decoys generated with both methods have essentially the same TM-score, good decoys are produced 1.416.0 times more often when using a fragment library built with HHfrag.
CONCLUSIONWe have introduced HHfrag, a new HMM-based fragment detection method that uses the profile comparison tool HHpred to build a customized fragment library for a query protein sequence. Our results show that a dynamic fragment library has advantages over a static library in that it improves the sequence coverage dramatically. Compared to other dynamic approaches such as Rosetta NNmake, HHfrag improves the precision of the fragments significantly at the expense of a 1915% loss in sequence coverage. A distinctive advantage is that HHfrag extracts fragments with variable length that may also contain gaps. Often fragments identified by HHfrag seem to point at a common evolutionary origin of the proteins sharing the same motif. Consider the example of the GD box (). The GD box links remotely homologous members of the cradle-loop barrel metafold () and also otherwise unrelated folds sharing an analogous motif. HHfrag detects GD boxes with very high coverage and precision. This example shows that fragments found by HHfrag may arise from a common evolutionary origin and can be also the result of convergence. Our experiences with decoy generation using Rosetta's AbInitioRelax protocol shows that most likely new strategies of
I.Kalev and M.Habeckfragment assembly need to be developed in order to take full advantage of the HHfrag approach. Tests with an ideal fragment library show that even few gaps in the fragment map may have a disastrous effect on the distribution of decoys (Supplementary Material). Moreover, an increased number of false positives slows down the convergence and can also increase the population of misfolded decoys. In the examples where Rosetta successfully generates near-native decoys, we see a clear enrichment of near-native structures when using HHfrag fragments. Often, this enrichment is the result of a more pronounced folding funnel (see energy versus TM-score plots in the Supplementary Material). Here, our main focus is on how to select fragments that capture local protein structure and not on how to improve the Rosetta structure prediction protocol. Fragments are useful for many purposes, not only for structure prediction. Fragment-based approaches have, for example, been instrumental in the recent structure determination of mitochondrial uncoupling protein 2 (). Future work will focus on the combination of HHfrag fragments with sparse and low-quality experimental data.
The Author 2011. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oup.com at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
