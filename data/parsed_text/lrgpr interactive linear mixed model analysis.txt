The linear mixed model is the state-of-the-art method to account for the confounding effects of kinship and population structure in genome-wide association studies (GWAS). Current implementations test the effect of one or more genetic markers while including prespecified covariates such as sex. Here we develop an efficient implementation of the linear mixed model that allows composite hypothesis tests to consider genotype interactions with variables such as other genotypes, environment, sex or ancestry. Our R package, lrgpr, allows interactive model fitting and examination of regression diagnos-tics to facilitate exploratory data analysis in the context of the linear mixed model. By leveraging parallel and out-of-core computing for datasets too large to fit in main memory, lrgpr is applicable to large GWAS datasets and next-generation sequencing data. Availability and implementation: lrgpr is an R package available from
INTRODUCTIONGenetic confounding owing to kinship and population structure is a common cause of inflation in genome-wide association studies (GWAS) test statistics and can lead to a substantial increase in false-positive results (). Linear mixed models have been widely adopted to correct for genetic confounding in GWAS analysis (), and the low-rank linear mixed model has advantages in terms of power and computational efficiency (). Yet, current software uses a 'one size fits all' paradigm where the analyst selects covariates and a genetic similarity metric, and the program performs a standard analysis on each genetic marker. As GWAS datasets have become larger and more complex, there is great potential for a custom analysis to identify biologically relevant associations not found by a standard analysis.
METHODSWe have developed an efficient and user-friendly R package, lrgpr, that facilitates custom exploratory data analysis of GWAS datasets by combining the well-established linear mixed model with novel statistical, diagnostic and interactive functionality. The package's main function, lrgpr(), is designed with much of the same functionality as the standard lm() function for linear regression and takes advantage of R's interactive paradigm for exploratory data analysis (R Core). This function allows visualization of diagnostic plots that are essential for complex datasets to ensure that the regression model is not badly misspecified (). Combining interactive analysis with model diagnostics allows the analyst to examine the relevance of additional covariates or non-linear effects of covariates on the phenotype. The lrgpr() function also provides composite hypothesis testing using a Wald statistic in the context of the linear mixed model to allow tests of epistasis as well as genotype interactions with other variables such as environment, sex or ancestry, where these variables are fit as fixed effects. The function is able to fit the linear mixed model using either a full-or low-rank genetic similarity matrix () and can learn the appropriate rank by cross-validation () or model selection criteria (). For genome-wide analysis, the function lrgprApply() allows time and memory-efficient fitting of the linear mixed model for millions of genetic markers and can apply a composite hypothesis test on a large scale. This function applies a fast approximation, which reuses estimates from the null model (), but has an option to use an exact method to reestimate variance components for each marker (). Moreover, lrgprApply() can efficiently remove markers in the region being tested from the random effect to increase power (). The complementary function glmApply() fits fixed-effect linear and logistic models. These functions allow analysis of large datasets in parallel on multicore computers. They are designed to take advantage of the bigmemory package () for out-of-core computing to efficiently process datasets that cannot fit into main memory.
FEATURESThe lrgpr package provides the following: Seamless interactive R interface to arbitrarily large datasets through big.matrix from the bigmemory package. Scalable fixed-effect linear or logistic regression for millions of hypothesis tests using glmApply()
APPLICATIONThe main contribution of the lrgpr software is its flexibility and integration into the R environment while being scalable to large datasets. This framework facilitates integration of existing analyses in R and rapid prototyping of novel methods. To illustrate its efficiency and scalability, we applied lrgpr to two simulated datasets of 5000 samples with 500 000 markers and 10 000 samples with 1 million markers. Although lrgpr is more flexible than other software, we ran the full-rank linear mixed model reusing variance component estimates from the null model to make a fair comparison between methods. All programs were run with default parameters using the same genetic similarity matrix. The runtimes required to fit a linear mixed model on this dataset are shown for lrgpr and six widely used programs, in addition to plink, which fits a fixed-effects linear model (). [Running GEMMA and FaST-LMM with the same grid search for estimating variance components as lrgpr uses increases the runtime (Supplementary).] The runtimes indicate that lrgpr, despite its flexible and user-friendly interface, is competitive with existing software.
DISCUSSIONAs most analysis of GWAS datasets have been performed under the 'one size fits all' paradigm, there is great potential for a custom exploratory reanalysis to examine novel aspects of existing datasets to further elucidate the molecular mechanisms of complex traits. Moreover,emphasizes that the optimal analysis depends on the population stratification, kinship, sample size, genetic architecture, disease prevalence and study design of each dataset. The lrgpr package allows an analyst to apply multiple variations of existing methods to customize an analysis based on the empirical properties of a specific dataset. This description of the lrgpr software is necessarily brief, and we provide a detailed tutorial illustrating the functionality of the software on the package's Web site.Analysis was run with default settings on an 8 core Intel V R Xeon V R E5-2687W @ 3.10 GHz with 64 Gb RAM using R 3.1.0 compiled with the Intel V R Math Kernel Library. Overhead for file conversion is not included.
The Author 2014. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oup.com at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
v1.07 2 Multithreaded version from 2/10/2012 3 v0.92 4 v2.06.20130802 5 GenABEL v1.8.0 6 MixABEL v0.0.9.1 with DatABEL v0.1.6 7 v0.1.0 8 Requires more than 64Gb of memory 9 Dataset exceeds hardware-independent size limit that GenABEL can load.
Irgpr at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
