Motivation: Studies of the biochemical functions and activities of un-cultivated microorganisms in the environment require analysis of DNA sequences for phylogenetic characterization and for the development of sequence-based assays for the detection of microorganisms. The numbers of sequences for genes that are indicators of environmentally important functions such as nitrogen (N 2) fixation have been rapidly growing over the past few decades. Obtaining these sequences from the National Center for Biotechnology Information's GenBank database is problematic because of annotation errors, nomenclature variation and paralogues; moreover, GenBank's structure and tools are not conducive to searching solely by function. For some genes, such as the nifH gene commonly used to assess community potential for N 2 fixation, manual collection and curation are becoming intractable because of the large number of sequences in GenBank and the large number of highly similar paralogues. If analysis is to keep pace with sequence discovery, an automated retrieval and curation system is necessary. Results: ARBitrator uses a two-step process composed of a broad collection of potential homologues followed by screening with a best hit strategy to conserved domains. 34 420 nifH sequences were identified in GenBank as of November 20, 2012. The false-positive rate is $0.033%. ARBitrator rapidly updates a public nifH sequence database , and we show that it can be adapted for other genes. Availability and implementation: Java source and executable code are freely available to non-commercial users at http://pmc.ucsc.edu/ $wwwzehr/research/database/.
INTRODUCTIONMicroorganisms catalyze a variety of biogeochemical transformations, such as nitrogen (N 2 ) fixation, that are critical for ecosystem function. Because many microorganisms in the environment have not been cultivated, studies of such functions depend on amplification and sequencing of genes that encode proteins involved in the functions of interest (). This approach facilitates detection and phylogenetic characterization of uncultivated microorganisms. Dinitrogen (N 2 ) is the most abundant gas in the atmosphere, but is not bioavailable unless it is reduced to ammonia by N 2 fixation. Biological N 2 fixation can require the protein products of up to 20 nif genes. The nifH, nifD and nifK gene products are the structural components of the conventional molybdenum (Mo)-containing nitrogenase enzyme (). The products of other nif genes are involved in roles such as regulation and biosynthesis (). In environmental studies, nifH, which encodes the iron (Fe) protein of molybdenum (Mo), vanadium (V) and iron (Fe) nitrogenases, is the most commonly used nitrogenase gene for the investigation of microorganisms with the potential to fix N 2 , as it is the most highly conserved in sequence (). This gene can be used to examine the diversity of N 2-fixing microorganisms in the environment, provides insight into the evolution and ecology of N 2 fixation and can indicate the potential for N 2 fixation in microbial communities (). The application of degenerate nifH PCR primers () enabled the discovery of novel nifH sequences in the environment. This approach fueled studies of N 2 fixation across a broad range of habitats, including woody dicotyledenous plants (), rice roots (), termite guts (), stromatolites (), central ocean gyres () and salt marshes (). The size of phylogenetic trees based on all available nucleotide and amino acid sequences expanded from 19 sequences in 1994 () to $100 sequences in 1997 () and to $1500 sequences in 2003 (). Four (or five, depending on author) major phylogenetic clusters have been described (). Only three of these phylogenetically related clusters contain true nitrogenase-encoding nif genes. Cluster I nifH primarily comprises 'conventional' nifH, which encodes the Fe protein of Mo nitrogenase (), as well as vnfH genes that encode the Fe protein of V nitrogenase (note that vanadium nitrogenase genes cluster differently based on nifD or nifK genes;). Organisms that contain Cluster 1 nifH genes include cyanobacteria and alpha-, beta-and gamma-proteobacteria. Cluster II nifH genes encode the Fe protein of 'alternative' nitrogenases that contain iron but do not contain Mo or V (*To whom correspondence should be addressed.). Cluster III is dominated by genes encoding Fe proteins of nitrogenases primarily of anaerobes, including methanogens and sulfate reducers; these nitrogenases likely contain Mo. Clusters IV and V (sometimes grouped as Cluster IV) contain nifH paralogues whose functions include photopigment biosynthesis () and non-N 2-fixation electron transport (). It has also been suggested that the function of Cluster IV nifH paralogues found in non-N 2-fixing Archaea is the biosynthesis of cofactor F430, essential to the production of methane (). The gene name nflH, for 'nifH-like', has been proposed for these nifH paralogues (). As sequences are accumulating rapidly in gene sequence databases, ongoing efforts to retrieve and analyze new nifH records are necessary to elucidate relationships between phylogenetic categories and identify phylotypes in different ecosystems. These efforts can be frustrated by the sheer number and growth rate of nifH gene sequences deposited into the National Center for Biotechnology Information (NCBI) GenBank database (). For example, in February 2009, Gaby and Buckley identified nifH sequences from the non-redundant nucleotide collection database (nr/nt) at GenBank for a global census of nitrogenase diversity () and records were manually curated to form a database of $17 000 sequences. We estimate that in the intervening time between the download and publication of the related article in 2011, at least 10 000 nifH sequences were added to the database. We estimate that as of January 2012 there were 432 000 nifH sequences in that database, with a growth rate of 4300 sequences per month. Retrieval involving human intervention now requires a significant investment of manpower that will increase over time; an automated retrieval pipeline is needed to allow analysis to keep pace with data collection. However, automating retrieval of all sequences of any specific gene from GenBank is difficult. Moreover, the most common query idioms for searching GenBank are variants of BLAST (), which search for sequence similarity rather than function. Approaches based on BLAST alone are likely to be overly sensitive, as hits to nifH homologues with functions other than N 2 fixation are not easily distinguished from genuine nifH hits. Text searches that analyze sequence annotation can be misled by misannotation () or misspellings in the annotation fields; a text search for 'nifh' in the nr protein database found only 6173 sequences, of which we believe 527 are not actually nifH. The Fungene database (http://fungene.cme.msu.edu) provides a repository of collections of functional genes from GenBank, classified by hidden Markov models (); however, updates from GenBank are infrequent and the hidden Markov model approach is prone to false calls. An alternative nifH database available to the public, maintained at Cornell (), requires the manual retrieval and curation of GenBank nifH sequences. To resolve these issues, a software pipeline was developed, called ARBitrator, that requires little human intervention and retrieves up-to-date nifH sequence collections within a few hours. The software is adaptable to collecting sequences for genes other than nifH, and is especially helpful for discriminating genes of interest from their paralogues, as it incorporates an auto-curation feature based on best Reversed PSI-BLAST hits to GenBank's Conserved Domain Database. ARBitrator's output is formatted for input into other programs, such as the ARB phylogenetic software environment (). Supplementary Appendix A provides a procedure for incrementally updating an existing nifH ARB database using the output of ARBitrator, thus facilitating maintenance of a comprehensive updated gene database.
SYSTEM AND METHODS
Design criteriaTo retrieve sequences for a single gene (in this case the nifH gene) from a large public database, and to facilitate maintenance of a sequence database for that gene, a pipeline needs to meet specific design criteria. Based on experience with maintaining a public database of nifH sequences (http://pmc.ucsc.edu/$wwwzehr/ research/database/), the following requirements were identified:(1) The pipeline should be easy to invoke and should require no manual setup or runtime intervention. In particular, the pipeline should use the public online GenBank database and services provided by NCBI, rather than using a local copy of the database that would need to be downloaded and updated before pipeline execution.(2) The data should not require manual curation. Given the current size of the GenBank database and the rate at which new nifH sequences are submitted, any step involving even trivial manual inspection of individual records would introduce excessive delays and possible errors.(3) The pipeline should have acceptable error rates. Automated classification systems have inherent error rates that must be controlled to within acceptable tolerances. In the case of nifH classification, sequences with strong similarity to nifH but different function might be accepted on the basis of homology (false positives). Similarly, sequences with nifH function that have strong similarity to non-nifH genes might be rejected (false negatives). Both kinds of error must be minimized.(4) Sequence identification should not rely on annotations in the database. Although annotations are useful as qualitycontrol checks (e.g. for determining false-positive/-negative rates), classification should be based only on sequence content. A solution based on annotations could be no better than the false-annotation rate, which is unknown but may be too high for reliable classification. Moreover, any such solution would complicate the software by requiring natural language processing.(5) The output of the pipeline should contain all metadata associated with the identified sequences, presented in a standard format. The pipeline's results should be easy to analyze. We have traditionally used ARB () to build phylogenetic trees of nifH sequences; therefore, the pipeline must produce output in EMBL format (), which ARB is able to read. All annotation information and metadata should be included in the EMBL records.(6) The pipeline should be adaptable to the retrieval of genes other than nifH. To this end, code should be open source under standard licenses, and adaptation should not require a high level of programming expertise or technical support.
AlgorithmARBitrator evaluates candidate sequences on two criteria, which we designate 'quality' and 'superiority'. Quality measures a candidate sequence's similarity to the most similar member of a repre-sentative set of 15 nifH sequences; superiority measures the degree to which a candidate is more similar to nifH than to genes coding for other known proteins. ARBitrator first executes a sensitivity phase in which it collects candidates based on quality (). Initial investigations showed that this phase is effective at finding nifH sequences; however, many non-nifH (false positive) sequences are also collected. In the subsequent specificity phase, false-positive candidates are eliminated based on superiority. In a final formatting phase, nucleotide sequences and annotations are retrieved for each accepted sequence, and an output file is generated in EMBL format.
ImplementationIn the sensitivity phase, a set of nifH protein sequences is BLASTed against the nr database at GenBank using the blastp (protein query, protein subject) program. Given the large number of known nifH sequences (415 000 at the inception of this project), a 'representative set' was selected consisting of 15 sequences that are evenly distributed throughout the nifH phylogenetic tree (). By only BLASTing these representative sequences, rather than all known sequences, time spent in this phase of the algorithm is reduced by three orders of magnitude. For all candidate sequences (hits) retrieved, we define 'quality' as the negative log 10 of the E-value of the hit. If a subject is hit by multiple queries from the representative set, then quality is defined as the negative log 10 of the smallest E-value across all hits. The sensitivity phase accepts sequences with quality !2 (i.e. all E-values are 0.01). The output of this phase is a collection of GIs (GenInfo Identifiers). To support the specificity phase, a database of conserved domains was constructed based on the total set of GenBank Conserved Domains in the Subfamily Hierarchy for cd01983, Fer4_Nifh. Candidate GIs that meet the sensitivity criteria are Reversed PSI-BLASTed against this database. The Reversed PSI-BLAST (Reversed Position-Specific Iterated BLAST) algorithm uses position-specific scoring (), and is thus appropriate for conserved domain analysis, as differences within a conserved domain are penalized more heavily than differences in non-conserved regions. The three bestscoring hits for each candidate are analyzed. Any hits to the cd02117 (NifH_like) conserved domain are discarded as uninformative; candidate sequences are accepted if the best remaining hit is to the cd02040 (NifH) conserved domain, and the E-value of this hit is at least 10 smaller than the E-value of the next best hit. We define a sequence's superiority as log 10 (E-value of best non-cd02040 hit) log 10 (E-value of cd02040 hit). Thus, candidates are accepted if their superiority is !1. The output of the sensitivity phase is a subset of the protein GIs generated by the sensitivity phase, representing sequences that ARBitrator classifies as nifH. For analysis requiring only protein GIs, the pipeline may optionally be terminated at this point. The formatting phase retrieves the nucleotide coding sequence and annotations associated with each protein GI, and builds a record in EMBL format (). The GenBank protein record for each GI is retrieved from NCBI via the eUtils utility (http://www.ncbi.nlm.nih.gov/books/NBK25497/ pdf/chapter2.pdf). This record is scanned for the 'coded_by' subfield of the 'CDS' (coding sequence) field to extract the identifier of a nucleotide sequencetypically a complete genomealong with coordinates for the start and end of the protein sequence. A second eUtils query retrieves the nucleotide record, from which the nifH nucleotide sequence is extracted. The public-domain ReadSeq utility (http://iubio.bio.indiana.edu/soft/molbio/readseq/java/) converts this record to EMBL format. Lastly, for compatibility with ARB's input filtering, multi-line literal quote fieldARBitrator executes, the protocol described in Supplementary Appendix A is used to add new records to an existing ARB database. Neighbor-joining tree of partial nifH amino acid sequences constructed using the 15 representative sequences (red boxes) and positive training set sequences. All major clusters are represented by at least one sequence. Labels are GenBank GIs values in the EMBL record are concatenated into single monolithic lines. After execution of the pipeline, new records can be incorporated into an existing ARB database using a protocol described in Supplementary Appendix A. Briefly, new records are imported into ARB using a custom import filter. All protein sequences are then exported and aligned to the NifH/FrxC protein family using a hidden Markov model. The aligned sequences are then imported into ARB. Nucleotide sequences are backaligned to the protein alignment using the ARB backalign tool. The nucleotide and amino acid sequences can then be used for phylogenetic analysis and probe design.
TuningThe software's classification algorithm is fine-tuned by three parameters: the representative set of verified nifH sequences used as the BLAST queries of the sensitivity phase, and the threshold values for quality and superiority. The representative set was chosen to broadly represent the known clades in the nifH phylogenetic tree. Members of the set are shown in. To determine threshold values for quality and superiority, positive and negative training sets were created. The positive training set contains the 15 513 nifH sequences in a manually curated nifH database (http://pmc.ucsc.edu/$wwwzehr/research/database/) as of September 1, 2010. The negative training set contains 766 sequences that are believed not to be nifH but that are moderately similar to nifH. Optimal quality and superiority thresholds were computed by exhaustive search of quality superiority space. When quality threshold = 2 and superiority threshold = 1, miscalls are minimized in both training sets. These thresholds were verified by N-fold cross-validation.
Error ratesTo determine false-positive and false-negative rates, ARBitrator was executed immediately after the November 2012 run reported herein, with the quality threshold relaxed to zero and the superiority threshold relaxed to 10. This generated a sample set consisting of sequences that were accepted by ARBitrator as nifH, as well as sequences that were rejected by a small margin. Sequences were aligned to a Pfam-curated multiple alignment of the NifH/ frxC family (Fer4_NifH; PF00142) using the HMMalign module of the HMMer software package (). Sequences that were too short for reliable alignment were omitted from the error-rate computation. To classify 'accept' sequences, a neighbor-joining phylogenetic tree () was constructed using sequences that had amino acid residues in the region most widely PCR amplified by nifH primers (), as the majority of the sequences submitted to GenBank are from PCR amplification. Sequences with short branches within Clusters I through III were classified as nifH; sequences with short branches within Cluster IV (which contains nifH homologues and non-functional genes) could not be classified with confidence, and were omitted from the error-rate computation; sequences with long branches within Cluster IV were classified as not nifH. ARBitrator's false-positive rate was computed as the number of 'accept' sequences classified phylogenetically as not nifH, divided by the total number of 'accept' sequences that could be aligned. A false-positive rate for sequences reported as nifH by Fungene was computed by the same method. To classify 'reject' sequences, any sequence that aligned poorly with the NifH/frxC family model was classified as not nifH. Those that aligned well but did not have amino acid residues in the region most widely amplified by nifH primers were omitted from the error-rate computation, as their phylogenetic analysis would not be reliable. A neighbor-joining tree was constructed using the remaining 'rejects' (i.e. those whose alignments permitted phylogenetic analysis), and the nifH representative set sequences. Classification was performed as described above, except that sequences with short branches to Cluster IV were conservatively classified as nifH to determine an upper bound for the false-positive rate. To assess the reliability of annotations among nifH and similar sequences, annotated gene function was retrieved for all 'accept' and 'reject' sequences. Records whose annotated function was nifH or synonymous to nifH ('dinitrogenase reductase', 'nitrogenase Fe protein' and 138 others) were classified as annotated as nifH. Phylogeny-based misannotation rates were computed using the approach described to determine error rates. Sequences whose annotation contradicted phylogenetic classification were blasted against the GenBank nr database to assess the likelihood of misannotation.
Extension beyond nifHTo test ARBitrator's effectiveness on genes other than nifH, the pipeline was configured to retrieve sequences of the nifD gene (that encodes the alpha subunit of the Mo, V and Fe nitrogenase proteins). The representative sequence set consisted of the nifD sequences of the organisms that contributed to the nifH representative set, as well as three sequences of vnfD (the vanadiumusing form of nifD). A positive training set was built by running the pipeline with the nifD representative and the quality/superiority settings used for nifH, and hand-selecting 73 sequences from the results; 43 additional sequences were added from six published studies (). A negative training set was built by selecting 82 sequences of five genes that are known to have high similarity to nifD: nifE, nifH, nifK, nifN and protochlorophyllide reductase. Optimal quality and superiority thresholds were computed by exhaustive search of qualitysuperiority space, and the pipeline was executed with quality = 8.1 and superiority = 0.1. As with the nifH configuration, the thresholds were then relaxed to generate a sample set for computation of true-and false-negative rates.
RESULTS
Sequences Retrieved on November 20, 2012On November 20, 2012, ARBitrator returned 34 420 nifH sequences from GenBank, of which 1757 were new to GenBank since the previous ARBitrator run on July 11, 2012. The list of protein sequence GIs may be downloaded from http://pmc.ucsc. edu/$wwwzehr/research/database/.shows a phylogenetic tree of representatives of the 34 420 sequences.shows the distribution by quality and superiority of all sequences in the sample set. Linear regression analysis of the accepted sequences (upper-right quadrant) shows a linear relationship with superiority = 1.3 + .45 x quality, and a coefficient of determination of 0.91. Most sequences accepted by ARBitrator cluster around the point (quality = 63, superiority = 28). Intriguingly, there is a cluster of rejected sequences around the point (quality = 2, superiority = 5); these are predominantly annotated as septum-site determining proteins or cobyrinic acid a,c-diamide synthase (cobB).
Error ratesOf 34 420 sequences in the sample set that are called nifH by ARBitrator (upper-right quadrant in), 2208 are too short for phylogenetic analysis and are omitted from the errorrate computation. 30 051 cluster with short branches with Clusters I, II and III, and are confirmed as nifH. 2151 sequences that cluster with short branches within Cluster IV cannot be confidently classified as nifH or not-nifH, and are omitted from the computation. Ten sequences associate via long branches with Cluster IV and are classified as not nifH. Thus, the phylogenetically derived false-positive rate is 10/(10 + 30 051) = 0.033%. Of the 32 227 sequences in the sample that are rejected by ARBitrator (upper-left, lower-left and lower-right quadrants in), 2067 are too short for phylogenetic analysis and are omitted from the error-rate computation. 28 846 align poorly with the NifH/frxC family and are confirmed as not nifH. 1134 cluster with long branches within Cluster IV, and are also confirmed as not nifH. Eight associate via short branches with Cluster IV and are omitted from the error-rate computation. Thus, the phylogenetic analysis detected no false-negative errors. See Supplementaryfor phylogenetic trees of accepted and rejected sequences. 104 sequences that ARBitrator accepts are annotated as not nifH; 87 of these are confirmed by phylogeny as nifH (i.e. phylogeny confirms ARBitrator's call), 10 are classified by phylogeny as not nifH and 10 cannot be phylogenetically classified. A total of 88 sequences in the sample set that ARBitrator rejects are annotated as nifH; 82 of these are classified by phylogeny as not nifH (i.e. phylogeny confirms ARBitrator's call), 8 are). Clusters and subclusters are marked classified by phylogeny as nifH and 8 cannot be phylogenetically classified.
Comparison to other nifH databasesThe sequences were compared with the 31 970 sequences in the Fungene database as of November 20, 2012. ARBitrator and Fungene had 29 836 sequences in common. ARBitrator collected 4584 sequences that Fungene rejected, and Fungene collected 2134 sequences that ARBitrator rejected; of these, ARBitrator rejected 1744 because of quality and 390 because of superiority. For the sequences reported by both ARBitrator and Fungene, the phylogenetically derived false-positive rate is 0.033%, the same as the overall ARBitrator false-positive rate. For the 2134 sequences that only Fungene reports as nifH, 1964 did not align with the NifH/frxC family and are classified as not nifH. Thus, the false-positive rate for these sequences is !1964/ 2134 = 92%. The overall Fungene false-positive rate is 6.2%. The second update of the Cornell nifH database reported inbased on a May 2012 snapshot of GenBankcontained 32 854 nt records, 28 742 of which have corresponding protein records specified by a 'db_xref' field, thus permitting comparison with ARBitrator. ARBitrator rejected 479 of these records (1.7%): 440 because of low quality, and 39 because of low superiority.
nifD resultsThe nifD configuration of the pipeline returned 2747 sequences, of which 2726 are annotated as nifD, for a false-positive rate of 0.76% conditioned on annotation accuracy. The sample set contained 8715 rejected sequences, of which 76 are annotated as nifD, for an annotation-conditioned false-negative rate of 0.87%. For the 2972 nifD sequences reported by Fungene for which unambiguous annotations could be retrieved, the annotationconditioned false-positive rate is 48%.
DISCUSSIONnifH gene diversity studies, and all single-gene diversity studies, are hampered by the difficulty of collecting all sequences associated with the gene of interest. NCBI's GenBank, the database where newly discovered sequences are deposited, provides no service for selecting all records that are annotated as representing a specified gene. A direct text search of the database would be of dubious value because of misannotations. GenBank's main query idiom is the BLAST search, which selects based on sequence similarity regardless of function. Consequently, a sequence collection pipeline that simply BLASTs a representative set of query genes will accept paralogues with the wrong function. The challenge of supporting diversity studies is exacerbated by the rapid growth of GenBank: the collection of nifH, and presumably other genes, appears to have been growing exponentially for the past several years. Thus, there exists an opportunity to facilitate diversity studies by increasing the efficiency of sequence retrieval.
Necessity for both quality and superiority criteriaAsshows, sequences obtained and accepted as nifH by ARBitrator (above and to the right of the purple crosshairs) cluster around the point (quality = 63, superiority = 28). When the quality and superiority criteria are relaxed (to the left of and/or below the crosshairs), a second cluster appears around quality = 0.1, superiority = 5; sequences in this second cluster are predominantly annotated as MinD (membrane ATPase of the MinC-MinD-MinE system) or CobB (cobyrinic acid a,c-diamide synthase, involved in the biosynthesis of vitamin B12). There is an approximately linear relationship between quality and superiority (superiority = 1.3 + .45 quality), withand we propose that these sequences were systematically misannotated as nifH.
Comparison with other nifH databasesThe ARBitrator and Fungene databases as of November 20, 2012, had 29 836 nifH sequences in common. ARBitrator accepted 4584 sequences that Fungene rejected. The false-positive rate for these sequences is approximately the same as for the overall sample set (0.03%). Fungene accepted 2134 sequences that ARBitrator rejected; the false-positive rate for these sequences is 90%. This discrepancy can perhaps be attributed to the fundamental difference between ARBitrator's BLAST-based algorithm and the hidden Markov model that underlies the Fungene pipeline. ARBitrator classifies according to similarity to representative nifH sequences and to the NifH conserved domain; Fungene classifies according to similarity to a composite profile model. ARBitrator's results are substantially in agreement with the latest update of the Buckley Laboratory database, which is not generated by auto-curating software and requires manual processing ().
Extension beyond nifHThe nifD pipeline configuration, despite being based on cruder positive and negative training sets than the nifH configuration, nevertheless produced annotation-based error rates that were 51%. This result supports the applicability of the ARBitrator algorithm to other genes besides nifH. The discrepancy between the superiority thresholds for nifH (1.0) and nifD (0.1) can be explained by the evolutionary history of nifD, which apparently originated as an ancestral gene that underwent a duplication event, giving rise to an ancestral bicistronic operon that later duplicated again to produce the presentday nifD, nifE, nifK and nifN genes (). Thus, many nifD genes have low superiority because their similarity to the nifE, nifK and nifN conserved domains is only slightly worse than their similarity to the nifD conserved domain. A higher superiority threshold would reject such sequences and increase the false-negative rate. The similarity of nifD to other genes makes it a particularly rigorous test of the extension of the ARBitrator approach. In conclusion, by combining a quality-based sensitivity phase with a superiority-based specificity phase, we have been able to implement a pipeline that meets all design criteria. Records provide nucleotide and amino acid sequences, as well as complete annotations. Computed false-positive and false-negative rates are acceptably low, and actual rates may be even lower. Results from the November 20, 2012, run are generally in good agreement with the nifH sequence collection at Fungene; however, the ARBitrator results are more extensive, have a lower error rate, and can be updated whenever a user wishes to rerun the pipeline. ARBitrator is designed to support ongoing nifH phylogeny research into the future as the GenBank collection continues to grow exponentially. If error rates increase, adjustments can be made to the quality and superiority thresholds. If NifH/FrxC family and CobB sequences continue to be major contributors to the false-positive rate, the software may need to be adapted to detect and reject these special cases. In addition to its original application to nifH phylogeny, ARBitrator can be adapted to other genes, as evidenced by the nifD results. An immediate use for adapted versions of the pipeline would be the collection nif genes other than nifH and nifD. Comparison of phylogenies of multiple nif genes could provide new insight into N 2 fixation diversity and ecology.
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
P.Heller et al. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
ARBitrator at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
r 2 = 0.91. This relationship is not strong enough to allow either quality or superiority alone to be used as a selection criterion. For example, without the quality criterion, all sequences to the right of the vertical crosshair would be accepted, including many sequences from the MinD/cobyrinic acid peak. Similarly, without the superiority criterion, all sequences below the horizontal crosshair would be accepted. 4.2 Error rates ARBitrator's low error rates (0.033% false positives, no detectable false negatives) can be understood in light of the underlying similarities between the ARBitrator algorithm and the error-rate analysis. In both approaches, candidate sequences are aligned against known nifH sequences. With ARBitrator, the candidate sequences are the contents of the GenBank protein database, and the known nifH sequences are the 15 representative sequences; during the sensitivity phase, the BLAST step aligns each query (known nifH representative) against each database member (candidate). Candidates are provisionally accepted if they align well enough with the representatives, with the specificity phase providing necessary additional accuracy to the measurement of alignment quality. In the error-rate analysis, the candidate sequences are the members of the ARBitrator sample set, which are aligned against the known nifH members of the Fer4_NifH Pfam family. The alignment algorithms in the two approaches are not identical in all implementation details, but in both cases sequences are accepted if and only if they are similar to known nifH sequences, with similarity measured by alignment score. When a sequence's annotation contradicts gene its ARBitrator classification (i.e. ARBitrator accepts a sequence that is not annotated as nifH, or rejects a sequence that is annotated as nifH), phylogenetic analysis supports the ARBitrator call in 90% of cases. In all, 104 sequences are classified by ARBitrator as nifH but annotated as not nifH. When these were BLASTed against the nr database, and the top 20 nonself hits for each query were inspected, 48 queries hit exclusively to nifH subjects or to non-nifH subjects from the same study as the query. We propose that these subject sequences, which come from two studies that submitted multiple sequences to GenBank, were systematically misannotated by the researchers and should have been annotated as nifH. Similarly, ARBitrator rejects 88 sequences that are annotated as nifH. When these were blasted against the nr database and the top 20 hits of each query were inspected, it was found that 54 of the queries hit exclusively to non-nifH subjects, or to nifH subjects from the same study as the query. These subject sequences come from five studies that submitted multiple sequences to GenBank,
