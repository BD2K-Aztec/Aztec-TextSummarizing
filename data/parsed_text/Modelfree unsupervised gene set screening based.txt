Motivation: A number of unsupervised gene set screening methods have recently been developed for search of putative functional gene sets based on their expression profiles. Most of the methods statistically evaluate whether the expression profiles of each gene set are fit to assumed models: e.g. co-expression across all samples or a subgroup of samples. However, it is possible that they fail to capture informative gene sets whose expression profiles are not fit to the assumed models. Results: To overcome this limitation, we propose a model-free unsupervised gene set screening method, Matrix Information Enrichment Analysis (MIEA). Without assuming any specific models, MIEA screens gene sets based on information richness of their expression profiles. We extensively compared the performance of MIEA to those of other unsupervised gene set screening methods, using various types of simulated and real data. The benchmark tests demonstrated that MIEA can detect singular expression profiles that the other methods fail to find, and performs broadly well for various types of input data. Taken together, this study introduces MIEA as a broadly applicable gene set screening tool for mining regulatory programs from transcriptome data.
INTRODUCTIONRecently, a number of gene set screening methods have been introduced successfully to analyze regulatory programs hidden in transcriptome data. While classical microarray analyses focus on individual genes, gene set screening methods search a prescribed gene set library for gene sets with informative expression profiles in given transcriptome data. By treating a gene set as a unit, these methods enhance statistical power as well as make results easier to biologically interpret. For example, Gene Set Enrichment Analysis (GSEA), which finds gene sets showing differential expression between two sample groups (), has become one of the pivotal tools for transcriptome analysis. A lot of other methods employing similar supervised approach are used to search * To whom correspondence should be addressed. for gene sets associated with given sample labels (). However, if we want to globally search for putatively functional gene sets, irrespectively of association with sample labels, we need another approach that does not rely on supervision of sample labels, i.e. the unsupervised approach. For this purpose,proposed a method to find a set of genes whose expressions are induced or repressed in any samples based on a hypergeometric test. Although their pioneering method realizes an unsupervised approach, this method can also be regarded as a kind of supervised method in that it tests differential expression between a single sample and the others. We recently proposed an unsupervised method, Extraction of Expression Module (EEM) to search for gene sets that have significantly large subsets of genes coherently expressed in the input transcriptome data (also proposed a method termed Gene Set Expression Coherence Analysis (GSECA), which selects gene sets based on expression coherence. GSECA is different from EEM in that GSECA measures expression coherence, taking into account all the members in the gene set rather than focusing on the coherent subset. Since EEM assumes that a significant gene set is co-expressed across all samples, it is possible that EEM fails to capture gene sets that exhibit coherent expression patterns across only a subset of samples. To overcome this limitation, we also developed an extended version of EEM termed Biclustering-based EEM (BEEM), which takes advantage of a biclustering algorithm () to identify gene sets coherently expressed in a subgroup of samples (). Compared with the supervised approach, few gene set screening methods have so far employed the unsupervised approach, and also there remain some problems to be solved in the existing methods. For example, although EEM and BEEM evaluate expression coherence of an input gene set based on specific models, i.e. co-expression across all samples or a subgroup of samples, it is possible that such a model-based method fails to capture informative expression profiles that do not fit to the assumed model. To address this problem, we developed a novel model-free method termed MIEA (Matrix Information Enrichment Analysis). Without assuming any specific model, MIEA evaluates information in expression profiles; therefore, it could be used to search for gene sets associated with any types of informative expression profiles. In order to reveal the properties of MIEA and other unsupervised gene set screening methods, we extensively performed benchmark tests to compare their performances using both simulated and
Model-free unsupervised gene set screeningreal data. These benchmark tests showed that MIEA can capture significant gene sets which the other methods miss, and is broadly applicable to various types of transcriptome data and gene sets. Together with the other unsupervised gene set screening methods, MIEA would be a useful gene set screening tool for mining regulatory programs from transcriptome data.
METHODS
MIEALet E and M denote an n g n s input expression matrix and a gene set of |M| genes, respectively. The rows and columns of E index genes and samples, and the elements of each row vector are normalized so that the mean is 0 and the variance is 1. From E, we extract the row vectors corresponding to the genes in M and obtain a |M|n s sub-matrix E M. Generally, to evaluate informative patterns in E M , unsupervised gene set screening methods employ statistics based on their own specific models. For example, EEM uses the maximalsized coherent subset of M in E M as the test statistic. Namely, EEM assumes a specific model for informative patterns in E M : informative patterns should be coherent expression of a large subset of M. Note that it is possible that model-based methods like EEM fail to detect informative patterns in E M if the patterns do not fit to the assumed model, or are too complex to explain based on one simple model. To overcome this limitation, we proposed a model-free method, MIEA. The MIEA statistic scores information richness of E M without assuming any specific model, but taking advantage of singular value decomposition (SVD). Let X denote an nm matrix and its rank is r. Note that, without loss of generality, we assume n  m, and therefore r  m holds. The SVD theorem states ():where U is an nm matrix whose columns are the left singular vectors u k , and V is an mm matrix whose column are the right singular vectors v k. The left and right singular vectors form an orthonormal set, i.e. v T i v j = u T i u j = 1 for i = j and v T i v j = u T i u j = 0 for i = j. An mm diagonal matrix S has diagonal elements s 1  s 2 ...  s m  0, which are called singular values. Furthermore, s k > 0 for 1  k  r, and s k = 0 for r +1  k  m. One important result of the SVD of X is thatis the matrix of rank-l that minimizes the sum of the squares,This result can be used for data compression of X. If the singular values s j rapidly approach to zero for j  l +1, we can obtain a good approximation of X by X (l). In other words, if the singular values are uneven, we can assume X has so much redundancy that can be compressed. When applying hierarchical clustering to the matrix, this information can be visualized as non-random pattern in the heatmap. Therefore, by measuring unevenness of the singular values, we can know how much information the gene expression matrix has. To measure unevenness of the singular values, we define an entropy of the matrix X by, we can compare information richness between matrices of the same dimension; i.e. the less d(X) is, the more information X should have. We can assume that d(X) = 0 corresponds to the most information-rich case that can only be achieved when X = X (1) , while d(X) = log(m) corresponds to the most information-poor case where all singular values are equal and X has no information to be compressed. MIEA employs the entropy of E M , d(E M ), as a test statistic, and its statistical significance is evaluated by an empirical approach. That is, an empirical null distribution can be generated by repeatedly sampling random gene sets whose sizes are equal to that of M, |M|. The P-value of d(E M ) is obtained by the ratio of the null statistics which are smaller than d(E M ). Namely, the tested null hypothesis is that d(E M ) is equal to entropies of equalsized random sub-matrices from E. However, relying only on this empirical approach leads to intensive computational time. Fortunately, we found that, when |M| is large enough, the empirical null distribution is well approximated by the normal distribution. Based on this observation, we first sample 1000 null statistics and apply the Shapiro test to validate their normality. If the P-value of the Shapiro test is greater than the cutoff of 0.01, we calculate the MIEA P-value by fitting the normal distribution to the 1000 null statistics. Otherwise, we continue resampling until obtaining 10 4 null statistics, and empirically calculate the P-value from them. Note that, even in the latter case, computational time is not serious, because gene sets that reject the null hypothesis of the Shapiro test have relatively small sizes and, for such small gene sets, computation can be finished quickly.
Other methods compared with MIEAIn this study, we compare the performance of MIEA with those of other gene set screening methods employing unsupervised approach: EEM, BEEM, GSECA and SSA. Here, we give belief explanations of the competitive methods.
EEMFrom the input gene set, M, EEM finds the maximal-sized subset of M that shows coherent expression across all samples under the given radius parameter r (). A coherent subset of M is represented as:where c = (c 1 ,...,c ns ) T is the vector of the center parameters. The EEM algorithm is designed to findcfind findc = arg max, the maximal-sized coherent subset for all n g genes, r can be converted to the relative radius r R so that r R =|S al al c |/n g. We tested relative radius parameters of 0.05,0.10 and 0.15, chose the one which leads to the smallest P-value, and corrected the P-value for multiple testing.
BEEM While EEM measures expressioncoherence across all samples, BEEM measures expression coherence in a subset of samples by employing a biclustering algorithm, ISA (). We assumed a bicluster as a subset of genes that exhibits higher or lower expressions than a predefined threshold across a subset of samples, and vice versa. BEEM obtains a subset of M which is associated with a bicluster in E, and statistically evaluates the size of the bicluster-associated subset. ISA requires three parameters for specifying two thresholds controlling the bicluster size and the targeted bicluster types (i.e. upregulated or downregulated). We performed BEEM with 18 different parameter settings and obtained multiple testing-corrected P-values as described by(2010).
GSECAGSECA is similar to EEM in that GSECA tests expression coherence of E M. However, although EEM uses the size of the maximalsized coherent subset of M to evaluate expression coherence, GSECA uses the mean of expression correlation values between every pair of genes in M as the test statistic e ():The P-value for this statistic is calculated based on an empirical approach described by; an empirical null distribution was produced by randomly sampling 10 5 gene sets whose sizes are equal to |M|.proposed a method that screens gene sets without sample label information, relying on over or underexpression in each sample. However, their method does not explicitly assign P-value to a single gene set as the other method does. To make comparison easier, we used a reformulated version of their method termed SSA, which assigns a single P-value to each gene set (). The j-th column vector of E, E j = (E 1j ,.
Page: 3092 30903097
A.Niida et al.
SSA
..,E ngj) T scores how much each gene is over or underexpressed in the j-th sample, compared with the average across all samples. Based on E j , we obtain the top 5% of the upregulated genes in the j-th sample, denoted as U j. SSA tests overlap between the input gene set M and U j based on the hypergeometric test, and a P-value, p u j , for upregulation of M in the j-th sample is obtained. Similarly, a P-value, p d j , is also calculated for downregulation of M in the j-th sample. By calculating p u j and p d j for each sample, we obtain a P-value vector of length 2n s ,SSA finally combines p using Fisher's method () to obtain a single P-value to M; if this combined P-value is small, it means that M is over or underexpressed in any of the n s samples.
Generation of simulated dataWe simulated expression matrices and gene set libraries for the input data. Generally, the transcriptome contains sets of co-regulated genes called expression modules. Genes that belong to the same expression module behave together at the expression level. We simulated expression matrices of 4000 genes 100 samples, each of which harbors different types of expression modules. A simulated gene set library contains positive gene sets, which have significant overlaps with any of the expression modules, and negative gene sets, which were randomly sampled from the 4000 genes. Unsupervised gene set screening can be regarded as a process to search for gene sets that are associated with expression modules; the positive gene sets should be identified by unsupervised gene set screening, while the negative gene sets should not. To simulate expression matrices, we assumed three different models:For each module, we first chose one gene and generated its expression values across samples by the standard Gaussian distribution. That is, assuming that we chose gene k, we have E kj  N(0,1) for j = 1,...,100. The other module genes were generated so that they gather around gene k. The expression value of gene i who is a member of the module generated from gene k iswhere  ij  N(0,1) and s c is a parameter specifying signal strength. @BULLET Bicluster model. We assumed that an expression matrix has 50 modules, each of which consists of 200 module genes, and is allowed to overlap with each other. We randomly selected 200 genes from the 4000 genes to define module genes of each expression modules. We assumed the 200 module gene constitute a bicluster, and randomly chose 100r s samples as samples that constitute the bicluster in the module. Here, r s is a parameter specifying the ratio of the samples that constitute a bicluster. Let B ij be an indicator variable, where B ij takes 1 if and only if the expression value of gene i in sample j, E ij , belongs to any of the defined bicluster, or 0 otherwise. We set
E ij = s b B ij + ij ,where  ij  N(0,1) and s b is a parameter specifying signal strength.For each module, we randomly shuffled indices of samples. The expression value of the i-th module gene and the sample associated with the shuffled sample index j was then defined as follows:where ij  N(0,1), and s c is a parameter specifying signal strength.We next generated gene set libraries that make pairs with each of the expression matrices. Each gene set library includes 10 positive and 10 negative gene sets. A positive gene set includes 200r g genes sampled from one expression module, and randomly sampled 200(1r g ) genes. Here, r g is a given parameter specifying the ratio of module genes in the positive gene set. Ten negative gene sets were prepared by randomly sampling 200 genes. We additionally simulated another type of gene set library for the expression matrices of the coherent and bicluster models. For a given parameter K, the alternative gene set library was prepared so that the 200r g genes in a positive gene set consist of equal-sized K groups whose members were sampled from different K modules; i.e. a positive gene set with a larger K value has a more complex expression profiles. Hereafter, we refer to the paired set of these alternative gene set libraries and the expression matrices from the coherent and bicluster models as the composite coherent model and the composite bicluster model, respectively. Note that the models with K = 1 are identical to the normal coherent and bicluster models.
Preparation of real dataWe also measured performance of each method using real data. The real data used in this study include seven expression datasets and five gene set libraries. To prepare the expression datasets, we obtained seven datasets from public resources. The information of the seven datasets is summarized in. The data preprocessing was done as described by. Briefly, they were scaled to the logarithmic scale, and normalized in each sample. After the probe set IDs were converted to gene symbols, expression profiles of 6000 or 8000 genes (depending on the original numbers of genes) with the largest variance were extracted and normalized across samples. The five gene set libraries have various types of sources as listed in. The PWM gene set library was prepared by predicting downstream target genes of cis-regulatory motifs, using the proximal promoter sequences and position weight matrices (PWMs) obtained from the TRANSFAC database (). The locus gene set library was prepared by collecting genes located next to each other on the chromosomes. To collect such genes, we set a window containing 100 genes adjacent on the genome, moved the window by 10 genes and kept genes covered by the window at each position (). The miRtarget gene set library was prepared from the MicroCosm Targets database (); genes in each gene set were predicted to have miRNA binding sites in their 3 UTR with P < 10 3. The curated and GO gene set libraries are downloaded from MSigDb, a database used in GSEA (). Note that not all genes in each gene set were used for our analysis; the intersection of each gene set and genes in each expression dataset was used as an actual input gene set. In each gene set screening, we also discarded gene sets for which the intersection is less than 10.
RESULTS
Simulated data testWe performed a simulation study to compare the performance of MIEA with those of the four other unsupervised gene set screening methods: EEM, BEEM, GSCEA and SSA. We simulated input data based on the five models: the coherent, composite coherent, bicluster, composite bicluster and sine-wave models (See examples in Supplementary)simulations, we calculated specificity and sensitivity for each method over the whole range of significance cutoffs to depict receiver operating characteristic (ROC) curves. Specificity was calculated as the proportion of negative gene sets whose significance is below the cutoff, while sensitivity is calculated as the proportion of positive gene sets whose significance is above the cutoff. We then computed the area under the curves (AUCs) as a measure of the performance of each method, since the AUC assesses the overall discriminative ability of the method at determining whether a given gene set is associated with an expression module. The results are summarized as follows:
Model-free unsupervised gene set screening@BULLET Coherent model. This model assumes that genes in the same expression module are coherently expressed across all samples, and a subset of a positive gene set overlaps with any single expression module. This type of expression modules should be efficiently captured by EEM. Expectedly, EEM performs best among the five methods, while BEEM, GSECA and MIEA follow EEM (). @BULLET Composite coherent model. This model also assumes coherent expression modules, but differs in that a positive gene set is assumed to harbor K subsets overlapping with different expression modules. Also for the composite coherent model with K = 2, EEM works best among the five methods; however, the performance is attenuated compared with that for the coherent model. For BEEM and GSECA, we also observed similar trends; their performances are worse than those for thecoherent model. On the other hand, MIEA does not show any distinct difference between the results for the two models, and keeps relatively good performance (). This observation prompted us to inspect dependency of these method on the value of parameter K. We found that the performance of MIEA is the most robust to the changes of K, and MIEA performs best for larger K (K =5, 10 and 20 in). @BULLET Bicluster model. In this model, module genes are assumed to be overexpressed in a subset of samples. Since this type of expression module is a target of BEEM, BEEM performs best for this model. The other methods except SSA also show good performance ().@BULLET Composite bicluster model. This model is based on the same expression module model as the bicluster model, but assumes that positive gene sets have two subsets associated with different expression modules. As compared with the bicluster model, the performance of BEEM is substantially impaired for the composite bicluster model with K = 2. On the other hand, MIEA, EEM and GSECA remain good choices, although the performance of EEM is slightly attenuated (). We also confirmed that MIEA performs best for large K values in this model ().coherence and bicluster. A model-free method, MIEA, successfully retrieves a gene set associated with this singular expression module. EEM also performs comparably well, suggesting that EEM is powerful enough to capture coherent patterns hidden in singular expression modules. The other three methods hardly work at all (). Taken together, MIEA demonstrates relatively good performance for all the five models. Especially, it should be noted that MIEA performs better than the other methods in complex expression profiles generated from the sine-wave model or the composite models with large K values. This observation suggests that MIEA is broadly applicable for various types of input data, which is what we would expect for a model-free method. EEM shows superior performance for all the five models, especially for the coherent and composite coherent models. GSECA is also a good choice except for the sine-wave model. BEEM is effective for the bicluster model, as expected. SSA shows the worst performance for all the five models.
A.Niida et al.
Real data testNext, we evaluated the practical performance of the above methods using real data. The real data include seven microarray datasets and five gene set libraries listed in Tables 1 and 2. We performed gene set screenings by applying MIEA EEM, BEEM, GSCEA and SSA to every combination of the expression datasets and the gene set libraries: i.e. (5 methods)  (7 expression datasets)  (5 gene set libraries) = (175 gene set screenings) were performed. In each gene set screening, we considered gene sets whose P-values are less than a cutoff of 10 4 as significant gene sets. To evaluate the performance of each method, we calculated the ratio of significant gene sets in each gene set screening (Supplementary). A heatmap of the performance profiles across input data () reveals that the performance of the four methods except SSA has similar dependency on the input data while, on average, GSECA has slightly better performance than others. The four methods other than SSA show outstandingly high performance for the combination of the breastGrayCell expression dataset and the locus gene set library. This observation presumably reflects the fact that in breast cancer cell lines there are some chromosomal regions whose copy numbers are frequently altered, and the genes residing on such regions behave together in the transcriptome. Note that some methods take substantial ratios of the locus gene set library for expression data from clinical tumor samples, i.e. breastGray breastMiller and gliomaPhillips. However, it is reasonable that the data from monoclonal cell lines have much higher signal strength than those from the mixture of heterogeneous tumor tissues. On average, the curated and GO gene set libraries tend to contain more significant gene sets across the seven expression datasets.are hard to be detected at the transcriptome level, consistent with the previous reports that miRNAs regulate their target genes at both the transcriptional and post-transcriptional levels (). Among the five methods, SSA shows the worst performance in most of the gene set screenings. Although it shows high performance for PWM gene set library, this observation might be only a statistical artifact caused by gene set-size dependency, as described previously (). The breastMiller dataset whose matrix size is the largest (8000 genes  251 samples) is most associated with significant results. Based on this observation, we checked how much the matrix size affects the performance of each method. For the breastMiller and GNF datasets, we downsized expression matrices by randomly sampling 50, 25 and 12.5% of genes or samples. We then applied the five methods to the combination of the curated gene set library and each of the downsized matrices, and compared the results with those from the original matrices. This analysis demonstrated that the performance of each method is relatively robust to the sample-wise downsizing while the gene-wise downsizing decreases the performance more severely, especially for SSA (Supplementary). Among the five methods, EEM seems the most robust to both types of the downsizing. Thus, the performance variance is partially caused by the different sizes of input expression matrices, and also would reflect data qualities and biological properties of them. Next, we tried to characterize performance difference by focusing on each gene set. We omitted SSA from this analysis, because it shows the worst performance in the above analyses. Since each library includes hundreds to thousands of gene sets, all the combinations of the seven expression datasets and five gene set libraries yields 350 26 pairs of expression datasets and gene sets. Hereafter, we refer to each of the pairs simply as an expression-gene set pair. When we applied MIEA, EEM, BEEM and GSECA to the 35 026 expression-gene set pairs, 7267 pairs scored P-values less than a cutoff of 10 4 in any of the four methods. We divided the 7267 pairs into 15 groups based on in which methods they are significant. The Venn diagram visualizing the 15 groups demonstrates that expression-gene set pairs targeted by the four methods are largely overlapping, while each method, especially MIEA and GSECA, has unique expression-gene set pairs which are retrieved by only one method, but not others (). We also examined which expression dataset and gene set library is associated with the 15 group of expression-gene set pairs. For each group, we calculated a hypergeometric P-value for enrichment of the expression-gene set pairs associated with each expression dataset or each gene set library. Namely, the P-value for the enrichment was calculated as follows:
Model-free unsupervised gene set screeningwhere G is the group of expression-gene set pairs, F is a set of expression-gene set pairs associated with a particular expression dataset or gene set library, and N is the total number of expressiongene set pairs, i.e. 35 026.shows the association P-value p in minus log scale. Negative associations (i.e. depletion of the expression-gene set pairs associated with each expression dataset or each gene set library) can be measured by 1p, which are shown in Supplementary. We found that the degree of association to each expression dataset or each gene set library substantially varies among the 15 groups. For example, expression profiles of gene sets in the GNF expression dataset tend to be targeted uniquely by BEEM. For the gliomaPhillips dataset, MIEA performs relatively poor while EEM performs better. For the breastGray expression datasets, MIEA performs well; it retrieves gene sets that the other methods fail to find. Taken together, these observations suggest that the four methods have different characteristics to target different types of expression profiles of gene sets.
DISCUSSIONIn this study, we introduced a new unsupervised model-free gene set screening method, MIEA, and extensively compared its performance with those of the four existing unsupervised gene set screening methods: SSA, EEM, BEEM and GSECA. SSA is a reformulated version of the classical gene set screening method proposed by. SSA shows by far the worst performance in all the benchmark tests. This result seems reasonable when considering that SSA tests over or underexpression of a gene set in each single sample individually, while the other methods take into account expression profiles of a gene set across multiple samples. On the other hand, EEM, which tests expression coherence across all samples, performs broadly well for various types of input data. BEEM, which tests over or underexpression in a subgroup of samples, works well for the GNF expression dataset, confirming our previous report (). However, in the other expression datasets, EEM outperforms BEEM; biclustertype expression modules targeted by BEEM are less common than coherent expression modules targeted by EEM in most real expression datasets. The feature of these methods is that they are based on the rigid model assumptions. There are pros and cons about this feature. A notable advantage of this feature is that it can be utilized for not only gene set screening, but also expression module discovery. If a gene set is taken as significant by EEM and BEEM, a subset of genes should be co-expressed across all samples or in a subgroup of samples. EEM and BEEM can extract the subset as an expression module. This expression module discovery approachbrings us much biological knowledge, especially when combined with additional analyses of the extracted module information (). However, note that EEM and BEEM potentially fail to capture expression profiles which do not fit to their expression module models. Similarly to EEM, GSECA assumes expression coherence of input gene sets as an indication of its functionality. However, while EEM tests existence of a coherent subset in the input gene set, GSECA evaluates overall coherence by calculating the sum of correlations for all gene pairs in the gene set (). In the real data test, this approach retrieves the largest number of gene sets as significant, possibly by capturing loosely coherent patterns that cannot be detected by EEM. An example of such an expression profile is given in Supplementary. However, note that GSECA cannot capture a gene set containing subsets whose expressions are anti-correlated, because the coherence signals cancel each other out. Supplementaryshows an example taken as significant by MIEA, EEM and BEEM, but not GSECA. This case was also shown in the simulated data test using the sine-wave model (Supplementaryand G). The newly introduced method, MIEA, is designed to detect any informative expression profiles of the input gene sets without assuming any specific models. This notable feature endows the method with the broad applicability so that it can capture complex expression profiles that the other model-based methods fail to detect. Supplementaryand D shows such complex expression profiles, which are hard to be captured by any simple models. However, note that this broad applicability comes at cost: in case where a model-based method would be appropriate, the model-free method has less power, demonstrated by the simulated data test using the coherent and bicluster model. (). Collectively, we conclude that MIEA is broadly applicable to various types of gene sets and expression datasets, while EEM and GSECA also have comparably broad applicability. Since EEM and GSECA have biased preferences for their targets, they might perform better than MIEA when applied to their favorite target. Although each method alone seems to have enough performance, combining these different methods would enable more comprehensive screenings for functional gene sets. This study not only introduced MIEA but also revealed unique characteristics of the novel and existing unsupervised gene set screening methods by performing extensive benchmark tests. Taken together with our previous studies (), this study provides a foundation for unsupervised gene set screening analysis, a novel paradigm in transcriptome data analysis.
The Author 2010. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oup.com at :: on August 31, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
at :: on August 31, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
