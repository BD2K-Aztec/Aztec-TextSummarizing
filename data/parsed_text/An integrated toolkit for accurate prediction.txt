Motivation: We present an integrated toolkit, BoBro2.0, for prediction and analysis of cis-regulatory motifs. This toolkit can (i) reliably identify statistically significant cis-regulatory motifs at a genome scale; (ii) accurately scan for all motif instances of a query motif in specified gen-omic regions using a novel method for P-value estimation; (iii) provide highly reliable comparisons and clustering of identified motifs, which takes into consideration the weak signals from the flanking regions of the motifs; and (iv) analyze co-occurring motifs in the regulatory regions. Results: We have carried out systematic comparisons between motif predictions using BoBro2.0 and the MEME package. The comparison results on Escherichia coli K12 genome and the human genome show that BoBro2.0 can identify the statistically significant motifs at a genome scale more efficiently, identify motif instances more accurately and get more reliable motif clusters than MEME. In addition, BoBro2.0 provides correlational analyses among the identified motifs to facilitate the inference of joint regulation relationships of transcription factors. Availability: The source code of the program is freely available for noncommercial uses at
INTRODUCTIONComputational identification of conserved cis-regulatory motifs represents an important problem in computational genomics, and it can provide a key piece of information for inference of gene regulation networks (). In the past three decades, numerous tools have been developed to find cis-regulatory motifs in the promoter regions of given genes (), and have been successfully applied to several organisms to generate large-scale regulatory networks (). In addition, two related problems are also of great interest: (i) motif scanning for additional motif instances across a genome based on known or predicted motifs, which needs a reliable measurement for the statistical significance of the scanned motif instances; and high false-positive prediction rates are the main issue with the existing prediction tools; and (ii) reliability assessment of the predicted motifs against annotated motifs in motif databases, which requires an effective way to compare the predicted motifs with the documented cis-regulatory motifs in the published literature and databases. A number of software packages have been developed to deal with such issues (). For example, the MEME package () was originally developed to identify conserved motifs (), and now consists of a number of analysis capabilities, such as FIMO () and MAST () for motif scanning and TOMTOM () for motif comparison. These additional capabilities have substantially extended the utility of the MEME program. Although substantial efforts have been invested to study these motif-related problems since the mid-80s, they are still largely unsolved, especially for genome-scale applications (). A number of challenging issues persist and await for better solutions, including (i) more effective ways for reliably assessing the statistical significance of the predicted motifs (), hence possibly overcoming the high false-positive rate issue; (ii) improved capabilities for evaluating predicted motif instances to decrease the false-positive rates in motif scanning (da); and (iii) improved similarity measures between two motifs, which currently suffer from the inability to effectively deal with sequence variations in motifs, hence leading to low prediction sensitivities (). We have recently developed an improved version of our previous tool BoBro (), BoBro2.0, to address some of these issues (seefor the flowchart of BoBro2.0). Compared with BoBro, the new toolkit has a number of novel capabilities (i) motif refinement and evaluation based on information extracted from the entire genome and a phylogenetic footprinting method, (ii) motif scanning based on a global P-value estimation method, (iii) motif comparison and clustering using a novel and effective *To whom correspondence should be addressed.
yThe authors wish it to be known that, in their opinion, the first two authors should be regarded as joint First Authors. technique and (iv) analysis of motifs' co-occurrences in the regulatory regions. The capability of (i) can make the predicted motifs not only statistically significant but also biologically meaningful; the one in (ii) can improve motif-scanning performance in both the prediction precision and recall. The motif comparison and clustering function in (iii) can identify more reliable motif clusters for a given transcription factor (TF), and the cooccurring motif analysis in (iv) can provide useful information about joint regulations among TFs. We have assessed the performance of BoBro2.0 in comparison with MEME and associated analysis tools on large test sets spanning genomic sequences of E.coli K12 and human, and found that our program consistently performed better than those programs.
METHODSBoBro2.0 represents an integrated toolkit for motif identification and analysis, including capabilities for BoBro-based motif Refinement tool (BBR), BoBro-based motif Scanning tool (BBS), BoBro-based motif Comparison and Clustering tool (BBC) and BoBro-based motif correlation Analysis tool (BBA).summarizes the key features of each of these components, and details about applications and references are available in the Supplementary Material. Generally, a regulatory motif can be represented by different models, e.g. consensus (), position weight matrix (PWM) () or hidden Markov model (), which are all based on aligned motif binding sites. Hence, in the following, we use motif to represent a set of aligned similar binding sites (documented or predicted), and use instance or motif instance to represent each individual site of the motif.
2.1BBR: a method for filtering out noises among predicted motifs at a genome scaleConsider a genome-scale motif prediction problem: denote all the motifs predicted by a de-novo motif finding tool as ; R and C represent the given set of regulatory sequences for motif identification and a control sequence set, respectively. For any motif m 2 , it is considered as a motif if it satisfies the following three criteria: (i) the P-value of m with respect to a hypothesis that it appears in R by chance is below a specified cutoff value; (ii) R is more enriched of the instances of m than C, as defined in formula (1); and (iii) m is well-conserved across a diverse set of species, as defined in formula (2). Criterion (i) is measured using the P-value defined in our previous work (). Specifically, let x be a random variable denoting the number of instances of a motif in a given set of regulatory sequences, and its probability distribution, p(x), can be approximated using a Poisson distribution. Hence, the P-value of a motif can be calculated by summing up the probability of p(x) over x ! k, denoting that the motif has at least k instances. An enrichment score is defined to evaluate the statistical significance of the ratio between the number of m's instances in R and that in C, as given in the following,where N R and N C are the numbers of instances of m in R and C, respectively; and jRj and jCj are the sequence lengths of R and C, respectively. Criterion (iii) is defined in terms of the average enrichment score defined in formula (2), with each Z term being defined in (1) for each organism over a set of diverse species and the original genome.where G r represents a set of species and Z i is m's enrichment score in species i, i 2 G r. We consider a motif as statistically significant if its P53.3e-5 (the P-value threshold has been corrected for multiple testing based on the estimated number, 300, of TFs in E.coli). Criteria (ii) and(iii) are designed to ensure that predicted motifs will be as biologically meaningful as possible ().
BBS: scanning and ranking new instances of a query motif based on P-valuesA key to reliable motif-scanning at a genome scale is an ability to effectively evaluate the similarity between a motif instance and a query motif (; Haverty and). Obviously, different similarity cutoffs may result in different scanning results. BBS provides a global P-value for the entire motif instances for each motif scan. We first introduce a few definitions; let M be an aligned query motif of L nucleotides long and its PWM W M is defined as a 4-by-L matrix, given in (3):where p ij is the probability of nucleotide i 2 A, C, G, T f gappearing at position j in M; and q i is the probability of i appearing in the background sequences, e.g. all the promoter sequences in the entire genome. Comparing with the traditional PWM model that assumes independence among different sequence positions, we assumed first-order Markovchain property among consecutive sequence positions in our model. We generated a transition matrixW 0 M , with W 0 M i, i 0 , j representing the probability of a specific nucleotide type i followed by a specific nucleotide type i 0 in consecutive positions j and j  1 of the query motif (see Supplementary Material for details). The similarity between a motif instance b  i 1 , i 2 , :::, i L i j 2 A, C, G, T f gand a query motif M is measured using:Consider a motif M 0 with t instances a 1 , a 2 , :::, a t f g , the average similarity ASM 0 , M between M 0 and M is measured using the following:A l closure of M, denoted as M, l, is a set of sequence segments in the input regulatory sequences, each having a similarity score no less thanl  ASM 0 , M. Our previous experience has been that the documented cisregulatory motifs tend to have significantly more instances with high similarities among them than the accidental ones, and the size of a l closure provides a good measure for this (). The P-value pM, l of M, l can be approximated using a Poisson distribution based on our previous work (). We can select a l value l M so that the l closure of M can give the best motif prediction performance measured in terms of prediction sensitivity and specificity. One way to accomplish this is through finding a l M that minimizes the following function:This capability can be used to derive an optimal similarity cut-off for motif scanning on a statistically sound basis.
BBC: motif comparison and clusteringUtilization of weak conserved signals of motifs' flanking regions in motif comparison: We have observed that the flanking regions of cis-regulatory motifs tend to have some level of sequence conservation, and we have developed the following procedure to take advantage of this information in motif comparison. Define a deformation of information content () for a motif M of length L as follows:where F M  p ij  4L and the other items are the same as in formula (3). Consider two motifs M 1 and M 2 with lengths L 1 and L 2 , respectively, and L  min {L 1 , L 2 }. Let M 1 ' and M 2 ' be the two extended motifs formed by concatenating the L 1 =2 and L 2 =2 nucleotides on each side of each motif instance sequence of M 1 and M 2 , respectively (If the location information of given motifs in their original genome is available, we can use the flanking region of each motif to generate the extended motif sequence); hence, their lengths are 2L 1 and 2L 2. The similarity between the extended instances of M 1 and M 2 is defined as follows:shows an example of motif comparison using this measure, which illustrates the idea of this measure using the information from the motif flanking regions. Motif clustering using the new similarity measure: A group of motifs can be clustered into subgroups of similar motifs using the following algorithm, which is based on a maximum spanning tree (MST) representation of the candidate motifs. First, consider a complete graph defined over a list of candidate motifs, each represented as a node and each pair of motifs connected by an edge; the weight of an edge is the similarity between the two corresponding motifs (see). An MST of the graph is constructed using Kruskal's algorithm (). We have clustered the predicted motifs based on two different similarity thresholds, T 1 and T 2 , giving rise to two classes of motif clusters, namely, highly reliable and relatively reliable motif clusters, respectively. We have compared each pair of documented motifs in the RegulonDB database () and assigned the median and the upper quartile of all the similarities to T 1 and T 2 , respectively. Each of the two thresholds is used to remove edges with similarities lower than the threshold, giving rise to the final list of motif clusters (see) represented as a connected sub-tree of the MST after application of the threshold. Then, all instances of each motif cluster are mapped back to the original regulatory sequences, facilitating further analysis and interpretation of the motif-prediction results (Supplementary).
BBA: motif co-occurrence analysisWe have implemented a function BBA to evaluate the co-occurrences among the identified motifs in a given set of regulatory sequences, which can reveal joint regulation relationships by multiple TFs. For a given motif pair a and b, and the entire set of promoter sequences P, let A and B be the subsets of P that contain motif instances of a and b, respectively (we assume, without loss of generality, A j j B j j). Let k  A \ B j j , then the probability of A and B sharing k promoter sequences can be calculated using the following hyper-geometric function:The P-value of a and b co-occurring in the same regulatory regions is calculated as the probability of A and B sharing at least k regulatory sequences. For a pair of motifs, a significant P-value means their instances tend to occur in same regulatory sequences, hence indicating that their corresponding TFs may co-regulate the same genes with high probability.
Data preparationTo test the motif-finding performance of BoBro2.0, we have collected 2462 promoter sequences (also referred to as regulatory sequences), each being 300 bps long, covering all the predicted operons in E.coli K12, which were retrieved from the DOOR database (). Two hundred sixteen bacterial genomes within the same phylum but in different genre of E.coli were collected from the NCBI (2011-11-01). In each genus, we selected the largest genome to avoid potential selection bias in comparative genomic studies (). In addition for the motif scanning assessment, we have collected all the known cis-regulatory motifs of E.coli K12 from the RegulonDB database (), which has the PWM matrices. Further, we retrieved the detailed information of eight global TFs from RegulonDB, representing the eight largest regulons in the database, namely, CRP, FNR, Fur, LexA, IHF, GntR, PhoP and UlaR, to assess the performance of motif comparison methods.
RESULTSHere we compare BoBro2.0 with the latest version of the MEME suite, a most popular motif-finding and analysis package, in terms of their performance on both prokaryotic and eukaryotic genomes. We found that (i) the predicted motifs by BoBro2.0 have better motif-matching scores and regulon coverage scores (RCSs) than those by MEME; (ii) the average F-score of BBS (0.32) on 31 E.coli motifs is significantly higher than that of FIMO (0.14); similar performance results are found in 1460 human cis-regulatory motifs (0.34 versus 0.15); (iii) BBC can identify more accurate motif clusters than TOMTOM in a constructed motif database; and (iv) BBA can identify jointly regulating TFs, which are supported by the published literature. The computational complexity, the actual computing time and selected parameters of each used program can be found in Supplementary Table S1.
BoBro2.0 can identify cis-regulatory motifs at a genome scale reliably and efficientlyTo assess the motif-finding performance of our toolkit, we have systematically compared BoBro2.0 with MEME on the entire E.coli K12 genome. For each program, we take the top 100 predicted motifs as the predictions (the parameters of each program can be found in Supplementary). First, we note that BoBro is much faster than MEME, as it took 2181 min in comparison with 4492 min by MEME to generate the top 100 motifs for the promoter sequences in E.coli K12 (both BoBro and MEME are implemented on a computer with 264GB memory and CPU E5-2630 0 @ 2.3 GHz). To highlight the performance of our motif refinement tool, BBR, we have applied it to the motif predictions by both BoBro and MEME, denoted as BoBroBBR and MEMEBBR, respectively (see Supplementary Appendix 1 for details). We then compared the motif prediction performance of the four programs, MEME, MEMEBBR, BoBro and BoBroBBR, in terms of the motif-matching score (MMS), defined as follows:where M g represents the set of genes in the immediate downstream operon of motif M; r g represents the set of genes in regulon r; the set of all the regulons encoded in E.coli K12 is denoted as R; and N is the number of genes in the E.coli K12 genome. The MMS can be used to infer whether a predicted motif is involved in the regulation of a specific regulon. From the comparison results in, we noted that through top 10 to top 100, (i) the MMSs of the predicted motif by BoBro are significantly higher than that by MEME, and (ii) the MMSs of the refined motifs by BoBroBBR and MEMEBBR are higher than predicted motifs by BoBro and MEME, in most cases, respectively. The consensus and enrichment scores for each predicted motif by BoBro and by MEME are shown in Supplementary Table S2. In addition, we define RCS for each regulon r asmeasure the coverage of individual operons of a regulon predicted by a prediction program versus the known component operons of the regulon, where M i g 1 i T denotes the predicted gene sets by a program (T  10, 20,.. ., 100). Note that the larger the RCS, the more component genes of the corresponding regulon are correctly covered by the prediction program.shows a comparison among the RCS values by the four programs on the 12 largest regulons: CRP, Fur, FNR, IHF, Fis, Lrp, CpxR, LexA, NsrR, NarL, Cra and. The MMSs comparison between MEME, MEMEBBR, BoBro and BoBroBBR, where XBBR means the motif finding tool X combined with our motif refinement tool BBR. An example of a two-level clustering of motifs using a minimal spanning tree, consisting of six motifs: (a) a complete similarity graph is constructed with the weight of each edge representing the two corresponding motifs' similarity; (b) an MST {,6)} is constructed using Kruskal's algorithm; (c) four connected components of the MST created using the first-level threshold T 2 , i.e. {1, 2}, {5, 6}, {3} and {4}, reflecting that motifs 1 and 2 and 5 and 6 are similar compared with the other motif pairs; and (d) the motif cluster {1, 2} is split into two dependent motif clusters {1} and {2} using the threshold T 2 , reflecting that the similarity between motifs 1 and 2 are lower than that between motifs 5 and 6ArcA, each containing at least 20 operons. It is clear that (i) the prediction coverage by BoBro is considerably higher than that by MEME, and (ii) our refinement tool, BBR, can improve the RCSs of predicted motifs by both BoBro and MEME (see details in Supplementary). One of the issues that have troubled the motif-finding programs is how to effectively distinguish between cis-regulatory motifs and the so-called bacterial-interspersed mosaic elements (), also known as repetitive extra-genic palindrome elements (), which are conserved palindromic sequences with various sequence lengths, mostly in the intergenic regions. For example, 'CTTATCCGGCCTACAAA' is a key repetitive extra-genic palindrome pattern in E.coli K12. BoBro2.0 can effectively identify such elements when searching for cis-regulatory motifs through the designed criteria embedded in BBR (see details in Methods section), and filter some of them out, although overall the problem remains an unsolved one.
BBS can identify motif instances more accurately than FIMOThe BBS provides a global P-value for the entire motif prediction when scanning for motif instances at a genome scale, which provides a reliable way for automatically selecting an optimal sequence-similarity threshold for global motif scanning. Our results show that BBS can significantly improve the motif-scanning performance in both E.coli K12 and human genomes compared with the FIMO program in MEME. The test set consists of 31 conserved motifs from RegulonDB (see Section 2.5 for details). We used an F-score to measure the prediction accuracy (van), which is the harmonic mean of precision and recall,where precision represents the fraction of the predicted motif instances that are documented TF binding sites (), and recall is the fraction of the documented TF binding sites that are predicted.shows that the F-scores on the 31 TFs by BBS are significantly higher than those by FIMO (see Supplementary Table S4 for details). In addition, we have also applied BBS to 1 460 regulatory motifs of the human genome, extracted from, which are identified in promoters and 3' UTRs by comparative analyses of the human, mouse, rat and dog genomes.shows a performance comparison on this dataset between BBS and FIMO (see Supplementary Table S5 for details). It is noteworthy that the decreased performance by the two programs in comparison with that on E.coli K12 is probably owing to the higher noise level in the human genome than a bacterial genome. Also, the documented motifs representing only a very small fraction of all the encoded cis-regulatory motifs in the human genome also account for the decline in the performance statistics. As shown in, some motifs, scanned by BBS and FIMO, have F-scores close to 0 in both human genome and E.coli K12, for which the real motifs are known. This is caused by the relatively high false-positive rates that all motif scanning programs have to overcome. From the performance statistics, we can see that there is clearly a large room for improvement in human or other complex eukaryotic genomes, possibly by using additional information and techniques.
BBC can identify more accurate motif clusters than TOMTOMMotif BLAST is a process for identifying statistically significant motifs in a known motif database, which match the given query motifs. We have compared the performance in this area by BoBro2.0 and MEME. We have built a motif dataset using the footprinting technique () for the assessment purpose (see Supplementary Material for details). The dataset contains 561 motifs, covering 216 bacterial genomes, for 8 global TFs, namely, CRP, FNR, Fur, LexA, IHF, GntR, PhoP and UlaR (see Section 2.5). The motifs of these eight TFs in E.coli K12 are used as the queries. For any query motif m, we define the motif prediction sensitivity as B m \ I m j j = I m j j, where B m represents all. The RCSs comparison between MEME, MEMEBBR, BoBro and BoBroBBR, where XBBR means the motif finding tool X combined with our motif refinement tool BBRshows the comparison results of the identification sensitivity on the eight regulons. BBC has at least as high sensitivity as TOMTOM. and USG Inter-Institutional Collaborative Grant) and by the U.S. Department of Energy's BioEnergy Science Center (BESC) grant through the Office of Biological and Environmental Research. G.J.L's work was also supported in part by grants 61070095, 60873207 and 61272016 from NSFC, and ZR2010FM014 from NSF of Shandong Province, China. B.Q.L's work was supported by grants ZR2011FQ010 and ZR2010AQ018 from NSF of Shandong Province, China. Conflict of Interest: none declared.Note: The two motifs in each pair are represented by a and b, and A and B are the corresponding promoter sets. The P-value is for motif co-occurrence.
The Author 2013. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
Q.Ma et al. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
An integrated toolkit for accurate prediction and analysis of cis-regulatory motifs at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
.4 BBA can identify TFs that jointly regulate genes It is known that some genes are jointly regulated by multiple TFs, and these genes should have the cis-regulatory motifs of the corresponding TFs, generally arranged in tandem in their promoter sequences (Madan Babu and Teichmann, 2003). We have done statistical analysis on each pair of TFs in E.coli K12 to identify such joint regulations. Specifically, we infer that a pair of TFs jointly regulates genes using the motif co-occurrence analysis on all the documented 159 motifs of E.coli K12 in RegulonDB (see Methods section). To calibrate the P-value distribution, we have run BBA on both documented motifs and randomly simulated motifs (see Supplementary Material for details). Figure 7 shows the distribution of the P-values on both the documented and simulated motifs. We can see that 164 (represented by red bars in Fig. 7) of all 12 561 pairs of documented motifs have significant P-values (50.01) to co-occur in the same promoters. The comparison with the simulated data (represented by green bars) shows that the P-value threshold is significant enough and the chosen pairs are not random noise. Hence, we predict these 164 pairs of TFs jointly regulate gene transcription in E.coli K12 and 42 of them have full or partial supporting evidence in the published literature. Table 2 shows the most significant 10 TF pairs, and the full list is given in Supplementary Table S6. To assess the quality of our predicted TF pairs, we have done an extensive literature search aiming to find published data that may support our predictions. Among the 164 TF pairs, 42 pairs have full or partial supporting evidence with the detailed information given in Supplementary Table S6. We highlight a few examples here. (i) GalS and GalR are known to jointly regulate the gal regulon (Geanacopoulos and Adhya, 1997; Weickert and Adhya, 1992); (ii) GadX and GadW are members of the AraC/XylS family of TFs and they collaboratively regulate glutamate-dependent acid resistance in E.coli K12 (Gallegos et al., 1997; Ma et al., 2002; Martin and Rosner, 2001; Tramonti et al., 2008); (iii) FNR and CRP belong to the CRP/FNR superfamily of TFs whose members are widely distributed in bacteria, and they have been reported to co-activate the genes involved in reductive dehalogenation of chlorinated aromatic compounds (Gabor et al., 2006; Korner et al., 2003); (iv) IHF and Fis are two nucleoid-associated proteins in gram-negative bacteria (Dillon and Dorman, 2010), which comprise the prereplication complexes to unwind the origin of replication in E.coli K12 (Ryan et al., 2004); (v) the CytR protein cannot act alone, and the synergistic DNA binding is increased by direct interaction with CRP (Sogaard-Andersen, et al., 1990a,b, 1991); and (vi) IHF and CRP are known to collaborate to regulate the expression of the tpl promoter and gltBDF operon (Bai and Somerville, 1998; Paul et al., 2007). 4 CONCLUSION AND DISCUSSION Compared with the most popular motif analysis software MEME, BoBro2.0 has the following unique and strong features, which all improve the state-of-the-art: it (i) can reliably identify statistically significant cis-regulatory motifs at a genome scale; (ii) provides a reliable way for optimizing the sequence-similarity cutoff in genome-scale motif scanning; (iii) has a reliable capability to compare and cluster motifs and (iv) can identify TFs that may jointly regulate genes through identification of the co-occurrences of their cis-regulatory motifs. With these features, we expect that BoBro 2.0 provides a useful tool for motif identification and analysis complementary to the existing tools. It is noteworthy that based on the above performance on the human genome, BoBro2.0 can be realistically applied to eukaryotic genomes for reliable identification of conserved cis-regulatory motifs. Specifically, BBR is designed to improve the applications of BoBro in eukaryotes. In addition, BBA, which is more genome-independent, can clearly be applied to eukaryotes, and we expect that its performance should be about the same as on prokaryotic genomes. Funding: This research was supported in part by National Science Foundation (NSF/MCB-0958172, NSF/DEB0830024 Fig. 7. Distributions of P-value for the entire motif pairs among 159 documented E.coli K12 motifs and simulated motifs. The number shown on the top of each bar represents the number of motif pairs with corresponding P-values on x-axis. The green bars represent the distribution of P-value for simulated motif pairs; the red and blue bars are for real data. Motif pairs with P 5 0.01 (red bars) are considered as significantly co-occurred Fig. 6. Comparisons of regulon BLAST sensitivity between TOMTOM (blue) and BBC (red)
