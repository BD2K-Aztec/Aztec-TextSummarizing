Motivation: Cell sizes and shapes are a fundamental defining characteristic of all cellular life. In bacteria like Escherichia coli, the machinery that determines cell length is complex and interconnected, spanning extracellular cues, biosynthesis and cell division. Few tools exist to study cell lengths in a population. We have developed and tested three automated image analysis routines on growing E.coli cultures to simultaneously measure cell lengths and nucleoid numbers in populations of bacteria. We find population profiles changing with culture densityâ€”higher density of culture leads to fewer long cells. Additionally, lab strains mutant for recA show a correlation between the number of nucleoids and cell length.
INTRODUCTIONCell shape, size and its regulation are a fundamental property of cellular organisms. Escherichia coli is a rod-shaped bacterium and multiple genetic factors have been isolated over the years that affect its shape and size (reviewed in). Cell size in E.coli can be characterized as cell length and width. While width has been observed to be more or less constant, length of the bacteria has been shown to vary even in cells in the same environment and of the same age (). For instance, the proportion of long cells has been shown to decrease with increasing cell density (). Decreasing temperature caused increased cell volume () while more recently cell lengths were observed to decrease at 22C compared with 37C (). The filamentous phenotype corresponding to elongated E.coli cells has been generated by inhibition, mutation or deletion of penicillin binding proteins, cell scaffolding proteins Mre and Mbl, cell division proteins FtsZ and MinCDE and nucleoid occlusion (reviewed in). However, the population variability in such length measurements has been lacking. Thus, reproducible quantification of cell sizes and subcellular structures is important to address combinations of effects of genetic and environmental factors on cell phenotype. Recent studies examining bacterial cell lengths have used cell sorters and particle analyzers to measure bacterial cell size () and cell * To whom correspondence should be addressed. cycle stage (). However, these methods lack spatial information about the cells or their subcellular structures. Microscopy and image analysis appear to be the optimal solution.have estimated the accuracy of cell division in E.coli to be 2.9% by measuring the SD in the pinch position as a fraction of cell length in phase contrast images. Using green fluorescent protein (GFP) expressing cells, the SD of cell width was estimated as 6.6% (). More recently, a high-content image analysis tool has been applied to measuring the E.coli cell length variability and MinD oscillations (). The methods used works well on phase contrast and fluorescence images, but not on differential interference contrast (DIC) images. Bacterial genomic DNA that is compacted in the cell is referred to as the 'nucleoid', distinguishing it from the membrane-bound nucleus found in eukaryotes. Nucleoids form an important part of the cell division machinery, as has been seen recently seen in their role in determining the positioning of the FtsZ ring necessary for equational division in E.coli (). In Bacillus, incomplete DNA replication causes filamentation of cells () by 'nucleoid occlusion', i.e. the steric hindrance of the cell division machinery by nucleoids. We have developed an algorithm to detect cell lengths in DIC microscopy images of populations of E.coli laboratory strains grown in liquid batch culture. We combined this with automated detection of nucleoids in fluorescence images. We confirmed with previous findings that the proportion of long cells decreases with increasing culture density. Additionally, the lab strain DH5 with attenuated recombinase activity shows a linear correlation between cell length and nucleoid numbers. We hypothesize that a higher rate of replication fork stalling in such strains results in the inhibition of cell division, while cell elongation continues leading to longer cells. The algorithm presented here demonstrates our ability to detect and quantify cell length variability in E.coli and relate it to the variability in nucleoid numbers. Changing properties like nutrient availability per cell appears to affect this population variability, in a manner consistent across strains.
METHODSBacterial strain: the strains used in the study were Escherichia coli K12 (MG1655), HB101 and DH5 grown in Luria Bertani (LB) rich liquid broth at 37 @BULLET C with shaking. Sample preparation: an inoculum of a single colony of E.coli in 10 ml LB was grown at 37 @BULLET C, with shaking at 170 r.p.m., overnight. A 1:100 dilution of this saturated culture was grown in LB and incubated at 170 r.p.m. and 37 @BULLET C. For staining the nucleoids, 0.1 g/ml of 4 , 6-Diamidino-2-phenylindole
Population length variability in E. colidihydrochloride (DAPI, Sigma-Aldrich) was added to an aliquot and grown further for 15 min. The cells were resuspended in 1:4 (vol/vol) of methanol and the sample was placed on a glass microscopy slide (Medicos Appliances Centre, Pune, India) and allowed to dry. The sample was mounted using 2 l of mountant [20 mM Tris, pH 8, 0.5% N-propyl gallate (Sigma-Aldrich), 90% glycerol] and used for microscopy. Microscopy: an epifluorescence Zeiss Axio Imager Z1 (Carl Zeiss, Germany) upright microscope with EC Plan-Neofluar 40 lens of numerical aperture of 0.75 was used. Images were acquired using the Zeiss Image acquisition program (Axiovision version 4.8) in the DIC and fluorescence modes. The filter cube sets for DAPI excitation and emission were used for fluorescence measurements based on a mercury short arc lamp light source (X-Cite Series 120, Lumen Dynamics Inc., Canada). Image processing: three strategies were used for image analysis of E.coli DIC images, based on either (i) previously described methods of automated edge detection () or (ii) in-house developed shadow and (iii) gradient detection methods as described in Section 3. All algorithms were implemented in MATLAB version 7, R14 (Mathworks Inc., MA, USA) in combination with the Image Processing Toolbox. Algorithms were compared to manual (averaged over three people) detection (a comparison with membrane labeled FM4-64 labeling demonstrates it to be a good measure of accuracy, Supplementary).
RESULTS
Algorithm
Edge detectionBased on MATLAB ImageProcessing Toolbox (Mathworks Inc., MA, USA) recommended procedures (), we detected cells using the Canny Edge Detector (), followed by dilation, hole-filling and border clearing (, iiv). The segmented cell regions were then subjected to a skeletonization routine, which thinned the elongated structures to a 1-pixel wide contour. This was used for quantification of lengths (, v).
Shadow detectionThe topographic appearance of the DIC image shows a prominent dark shadow as seen in the 2D images. The shadow was detected by histogram equalization to enhance contrast, median filtering, followed by a 2D wiener filter and an optimizedintensity threshold (iiv). Inbuilt object detection (,v) was used to extract perimeter (P) and minor axis (l) lengths for closed objects in the binary image. From this, the length (L) of the bacterium was determined by L = P/2 l/2, assuming a spherocylindrical geometry (). This method is used to account for the deviations from a rigid rod.
Gradient detectionIn order to improve the detection of the 3D perspective shadow of DIC images, after contrast enhancement and smoothing (iiii), a pixel-wise gradient in X (x i,j ) and Y (y i,j ) is calculated from the difference between a pixel and the values of neighbours. The neighbouring pixel value is an average of n neighbours and the gradients are:The indices i and j are the coordinates of a pixel, and n is the size of the averaging mask. The value of n was optimally set to n = 3 (Supplementary). The two gradient images were made binary by a threshold () to obtain two binary-images D x and D y whereThese were combined to obtain a binary image D xy , where, iv). These binary contours were thinned to obtain skeletons, which correspond to length of the cell (, v). Objects with a length below a threshold of 1.5 m were removed.
Cell crossing-over detectionOccasional crossing-over of bacteria was observed in the images (Supplementary). To avoid overestimating lengths, a pixel-wise branch detection method was developed. Using the skeletonized image as an input, neighbouring pixels and their location were detected using a deconvolution filter. End points of the skeleton are those pixels with only one local neighbour in a neighbourhood of 8 (Moore's Neighbourhood). Branched structures were defined as skeletons with more than two end points. Using an end point as the initial location, the algorithm steps pixel-wise by detecting successive neighbours and calculating a running average of the angle of the skeleton ( S ). At branch points, the angle of each neighbour is calculated ( N ) where N = 27. That neighbour is chosen that minimizes the difference  N = | N  S |. In case multiple neighbours have the same value for  N , a random choice is made. The process results in as many skeletons as end points (Supplementary). The skeleton with the lowest SD of the mean angle is finally selected (Supplementary), while the others are discarded.
Length frequency and phenotypic noiseThe data obtained from image analysis were plotted as frequency distribution of cell length. The prominent feature of the data is its long tail, which was fit to an exponential function f (L) = Ae . Although other functions such as lognormal could fit the entire distribution, the optimized length threshold of our detection algorithm (1.5 m) could lead to artefacts with respect to very short cells. The exponential function provides us a measure of the population length distribution of long cells. We also calculate the intrinsic phenotypic noise (Ozbudak Page: 2946 29442948) as
C.A.Athale and H.Chaudhariwhere L is the mean length and  2 L is the variance.
Nucleoid detection Bacterial nucleoidswere stained with DAPI, a DNA binding fluorescent dye, and fixed (see Section 2, sample preparation). Images of cells in the same field of view were acquired in DIC and fluorescence channels. The gradient detection algorithm was run to produce a skeleton. Since nucleoids occupy the entire diameter of the cell, a 5-pixel wide dilated skeleton mask was obtained from the DIC images. These coordinates were used to generate mean intensity profiles of the DAPI image along the cell length. This 1D intensity profile was then processed for peak detection using a simple valley threshold. If a point is at the edge of the valley deeper than the threshold, it is considered a peak. These peaks correspond well with the centroids of nucleoids.
Testing the algorithmsThe evaluation of the algorithms was performed on images of bacteria obtained from a liquid broth and mounted on slides (). While all three algorithms worked comparably well on isolated cells, using populations of cells differentiated one method over all others.
Number and length comparisonThe number of bacteria detected manually was considered to be the standard. The first two methods, edge detection and shadow detection, showed higher false negatives than the gradient method (). The increase in false positives in gradient detection is related to its extreme sensitivity to out of focus cells that manual detection ignored. The true positives and true negatives in turn are, respectively, highest and lowest in gradient detection. The ratio of the number of bacteria automatically detected in each image (Na) by the manual value (Nm) () and the length ratios () were averaged for four images. Here too, we noticed that gradient detection performed better than the other two and is our method of choice. Cell counts obtained areThe measured frequency of log cell lengths is plotted for K12 (black squares), HB101 (light grey triangles) and DH5 (grey diamonds) strains and the continuous lines are the exponential fits, (D) with the two parameters A (grey) and  (stripes) for the three strains. the best among the three methods tested, while cell lengths are still comparable between edge detection and gradient detection. The method of gradient detection is sensitive to the angle of the prism. In all our experiments, it is tuned to produce sufficient contrast, which generates the shadow along the length of the bacterial cells covering half its width.
A B C D
E. coli length variability within lab strains
Length comparison E.coliK12 (MG1655) cells showed a frequency maximum of 2 m with a sharp exponential drop for frequencies of longer lengths. In contrast, the E.coli strains HB101 and DH5 appeared to show a greater proportion of long cells as demonstrated by the longer tails in their distributions (). We observed a difference in the mean and median lengths for the three strains while the mode length value was comparable (). The fit to the length distributions was a scaled exponential with two parameters A and  (). The values for A and  compared across the profiles show a definitive fold-change for DH5 over K12 (). In addition, the percentage of long cells (length >8 m) were low in K12 as expected, while DH5 and HB101 showed higher frequencies. The values of phenotypic noise ( L ) measured for the strains K12, HB101 and DH5 were 0.54, 2.17 and 3.43, respectively.
Effect of culture densityTo determine if this was dependent on cell culture density, we compared the density with the proportion of long cells and found that this value decreases with increasing culture density in growing cultures () of all three strains Page: 2947 29442948Growing cultures of three strains of E.coli K12, HB101 and DH5 in rich medium with shaking at 37C were sampled for cell length. (B) The increasing density of the culture corresponds with a decrease in the percentage of long cells (length >8 m) for all three strains.
Population length variability in E. coli(). This is consistent with the previous reports for E.coli B/r (). Thus, the difference between the strains K12, HB101 and DH5 lies in the quantitative change in the exponential fit to the length distributions, not in a novel distribution type.
NucleoidsUsing the cell length and nucleoid information from K12 () and DH5 () strains, we correlate length with nucleoid numbers (). The wild-type strain K12 shows little or no correlation between the two, while the distribution of DH5 cells shows a linear correlation with a slope of 2.2 (R 2 = 0.8). This is the first time to our knowledge that such a correlation has been quantified in a mutant recA1 containing E.coli strain.
DISCUSSIONThe image analysis algorithm presented here detects cell lengths and nucleoids in rod-shaped and filamentous bacterial populations.shows a linear trend (linear fit R 2 = 0.8) with slope 2.2 (please refer online for colour figures).
AAutomated image analysis is making it possible to relate the microscopic subcellular details of cells to phenotypic-and population-level properties (). Developing and optimizing algorithms as these therefore assumes more importance than before. A correlative approach between the cell morphology as observed in DIC and the DNA content has been performed before to address the role of nucleoids in bacterial cell division (), but these approaches use interactive methods of quantification. DIC optics generates contrast based on gradients in the optical path length simplifying the detection of elongated objects such as rod-shaped bacteria. The method described here can be used on fixed cells, live cells in liquid or on agar pads. Some recent studies have addressed variability in cell division at a population level, but these work best with phase contrast images, and ignore the role of the nucleoid (). Here we find E.coli K12 (MG1655) mean cell lengths show a SD of 4060% of cell length, while HB101 and DH5 show 6580% and 7090%, respectively. The exponential fit to the length Page: 2948 29442948
C.A.Athale and H.Chaudharifrequency distribution allows us to quantify both the steepness of the distribution and the length of the tail. The long tail and shallow decay in length frequencies in DH5 and HB101 might be related to their common genetic background of defective recombinase A (recA). We speculate that since the replication fork stalling is stochastic, it will lead to a non-Gaussian distribution of the cell lengths by increasing the proportion of the longer cells. Thus, a RecA1 mutant strain like DH5 that has higher probabilities of stalling has a longer tailed distribution. Our observation in growing liquid cultures of a decrease in percent long cells with increasing cell density in all three strains appears to suggest a common growth rate limited effect, independent of mutational background. This is consistent with the previous findings from continuous cultures (). The mutant strains, however, appear to have a quantitative amplification of this effect. Since cell elongation depends on nutrient availability, we can hypothesize that higher cell densities lead to lower frequency of long cells. In all, it would appear to suggest such population studies in mutant strains might shed light on the robustness of E.coli K12 length regulation. Previously, bacterial strains lacking RecA were identified as 'noisy' at a gene expression level (). Here, we find phenotypic noise in terms of cell length to also increase in the presence of a recA1 mutation. This would appear to suggest the noise at the level of cell morphology and the gene expression variability might be related. Additionally, this study demonstrates how environmental factors like nutrient availability might modulate the variability. In future, it would be interesting to develop a theoretical model to study the consequences of replication fork stalling, cell elongation and nucleoid occlusion on population length variability. Additionally, experiments examining the single cell behaviour with tracking of individual cell lineages might yield further insights. This study allows us to begin to connect environmental effects with single cell division and replication.
The Author 2011. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oup.com at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
