Motivation: DNA and protein patterns are usefully represented by sequence logos. However, the methods for logo generation in common use lack a proper statistical basis, and are non-optimal for recognizing functionally relevant alignment columns. Results: We redefine the information at a logo position as a per-observation multiple alignment log-odds score. Such scores are positive or negative, depending on whether a column's observations are better explained as arising from relatedness or chance. Within this framework, we propose distinct normalized maximum likelihood and Bayesian measures of column information. We illustrate these measures on High Mobility Group B (HMGB) box proteins and a dataset of enzyme alignments. Particularly in the context of protein alignments, our measures improve the discrimination of biologically relevant positions. Availability and implementation: Our new measures are implemented in an open-source Web-based logo generation program, which is available at http://www.ncbi.nlm.nih.gov/CBBresearch/Yu/ logoddslogo/index.html. A stand-alone version of the program is also available from this site.
INTRODUCTIONPatterns or motifs that are shared among multiple DNA or protein sequences often correlate with important biological functions. A widely used method for representing and studying such patterns is provided by 'sequence logos' (). A sequence logo represents concisely two important features of a multiple alignmentthe 'information content' at each alignment position and the frequencies of the nucleotides or amino acids observed at that position. Here, we suggest modifications to the way in which the information content is usually measured. These modifications yield a direct connection between the information for an alignment position and a multiple alignment log-odds score (). We have implemented a program that uses the modified information measures, and illustrate its application to protein alignments.
METHODS
BackgroundSequence logos were introduced by, and a popular Web-based logo construction program was made available by. A variety of alternative methods for calculating and presenting logos have since been described (). A logo is derived from a multiple alignment, and represents each position of the alignment by a stack of letters, each corresponding to a nucleotide or an amino acid. The height of each letter in the stack is proportional to the observed frequency of the letter at that position, and the aggregate height of the stack corresponds to the 'information content' of the position. To formalize, assume our alphabet has size L (4 for DNA, and 20 for proteins), indexed by the first L positive integers, and that the background frequencies with which these letters appear by chance is given by the fixed vector ~ p. We represent by ~ u the special uniform case in which all p j =1=L. Assume at a given alignment position we have N observations, given by the vector ~ x, with x i 2 f1;. .. ; Lg. Let the counts of the various letters within ~ x be given by the vector ~ n, and let us define the observed frequencies as ~ q ~ n=N. From the information theory (), the entropy (in bits) of a frequency distribution ~ f is defined as H ~ f  P L j=1 f j log 2 f j .use entropy to define the 'information content' of a given position as the difference between the maximum possible entropy and that observed at the position as follows:Here, e(N) is a correction for small sample size () (see Appendix, Supplementary Material), which approaches 0 for large N. To calculate e(N) using the approach of (), but without assuming ~ p=~ u, requires summing C N+L1 N =ON L1  terms. For proteins, this becomes impractical well before N reaches 30, so the term e(N) has generally been ignored (), giving rise to the measure U ~ x: U ~ x H~ u  H~ q=log 2 L  H~ q: 2Because expectation and summation commute, however, one may calculate e(N) exactly for arbitrary ~ p in time OLN, and its standard deviation in time OL 2 N 2 ; all factors of L may be dropped when ~ p=~ u. This does not appear to have been observed before. Accordingly, while we study both R ~ x and U ~ x in this article, only U ~ x has previously been in widespread use for proteins. *To whom correspondence should be addressed. y Present address: JanssenOur proposal is simply to replace R ~ x or U ~ x with one of the two alternative measures, A ~ x or B ~ x, as defined and discussed below. Although the proposed change may appear minor, in the protein alignment context it can have important consequences for the appearance, interpretation and use of sequence logos. The WebLogo program () implements a number of modifications to the original theory (). These modifications are not described in detail either inor in the program's user manual, but examination of the code reveals they are different in substance and spirit from those we advance here. Thus, for brevity, accuracy and clarity, we will compare our proposed measures of column information only with the original measure Rx of Schneider and Stephens (1990) and its uncorrected form U ~ x. The measure implemented by WebLogo is the closest in form and output to U ~ x.
The log-odds perspectiveThe average per-observation information available for distinguishing a stretch of symbols that follows a known probability distribution ~ q from a stream of symbols that follows a background distribution ~ p is generally understood to be the distributions' relative entropy ():By continuity, one may set 0log 2 0 0, and thus render D well-defined for ~ q in which some components are zero. The asymmetry of D in ~ q and ~ p can be understood by considering the relative ease of recognizing a stretch of a dozen fair coin flips within a sea of million that are 99.9% biased toward heads, compared with the converse. To recognize a DNA motif within a long stretch of DNA is a similar problem, except that the frequency of nucleotides within the motif differs from the background frequencies in a position-dependent manner. In the infinite N limit, a motif's frequencies at an individual position may be taken as a known, fixed vector ~ q, so the average information available per observation should be given by Equation (3). In the case of uniform background frequencies,so that the relative-entropy measure of column information is numerically equal to Schneider and Stephens' measure. However, the two definitions differ substantially when ~ p 6  ~ u, which is the case for many organisms of interest. Most obviously, for a column dominated by a particular letter a, so that q a % 1, the R of Equation (1) approaches log 2 L bits, whereas the D of Equation (3) approaches log 2 1=p a bits. In other words, relative entropy yields higher information content for columns dominated by a letter with lower background frequency.suggested relative entropy as an alternative to 1 for measuring column information, butdid not pursue this suggestion further. Relative entropy has also been advocated by, Schuster-B ockler et al. (2004), Stormo (1998) andhave made the same suggestion, but contrary to their statement, replacing ~ u by ~ p in Equation (1) does not render the two measures equivalent. Before turning to the small N case, it is useful to observe that, given a ~ q exactly proportional to ~ n, relative entropy can be understood as the per-observation log-odds ratio of Q ~ x to P ~ x, where Q ~ x and P ~ x are the likelihoods of generating ~ x given the two alternative multinomials ~ q and ~ p. In other words,By requiring, for small N, that Q remain a probability distribution over ~ x, the log-odds perspective provides the key to our proposed measures of column information. The special status of log-odds scores has long been recognized in the local alignment context (). There, the formalism is used explicitly to construct all popular pairwise substitution matrices (). A negative log-odds score simply means that the aligned letters are explained better by a model of chance than a model of relatedness. There are many advantages to extending log-odds scores to multiple alignments, as discussed at length in. They may, for example, be used in a principled way to distinguish related from unrelated alignment regions and to include or exclude sequences from a multiple alignment (). In this article, we show empirically that even within alignments of related protein sequence regions, the relative importance of alignment positions, which logos are designed to represent, is better captured using log-odds scores than other measures of column information in common use.
The normalized maximum-likelihood-based column information measureFor finite N, although the background ~ p remains fixed, ~ q is taken to be the maximum-likelihood multinomial ~ n=N implied by the observation ~ x, and thus varies from one ~ x to another. For a fixed multinomial, the likelihoods for all possible ~ x sum to 1, and may therefore be considered probabilities, but this is no longer the case if ~ q varies with ~ x. Instead, this sum is given by Z P ~ x Q j n j =N nj. In minimum description length theory, log 2 Z is called the complexity of the multinomial model, and the measure A ~ x described below can be seen as derived from the normalized maximum-likelihood description length of ~ x (). To convert the likelihoods for the ~ x implied by ~ q ~ x into probabilities, they must be divided by Z, so that we must write Q ~ x= Q j q j nj =Z. Thus, the log-odds perspective of Equation (5) leads us to define our per-observation log-odds measure of column information as follows:Q j q j nj approaches 0 for large N and plays an analogous but logically and numerically distinct role to the term e(N) in Equation (1). We give values of c(N) for small N in Supplementary Tables S1 and S2, and derive in the Appendix (see Supplementary Material) an asymptotic formula for c(N). Interestingly, for large N and ~ p=~ u, eN % cN=lnN (). The R ~ x that results from Equation (1) has expected value 0 for columns of random letters, whereas in this context, A ~ x has negative expected value, because of its derivation as a per-observation log-odds score ().
The BILD-score-based column information measureThe approach above calculates Q ~ x by inferring a maximum-likelihood multinomial ~ q ~ x for each ~ x, and normalizing the resulting likelihoods.An alternative Bayesian approach is to define a prior probability density, over the space of all L-letter multinomials, for the ~ q associated with a motif column. Q ~ x may then be taken as the probability of observing ~ x implied by this prior. Because no parameters are fitted, no correction term analogous to c(N) above is needed. This approach is mathematically tractable if the prior is chosen as a Dirichlet mixture (). Such a mixture, the superposition of M Dirichlet components, is specified by its mixture parameters ~ m (M positive numbers that sum to 1), and its Dirichlet parameters ~ i;j (positive numbers indexed by i 2 f1;. .. ; Mg and j 2 f1;. .. ; Lg). It is convenient to define 'concentration parameters' i P j i;j. The resulting measure of column information is given by the following:This is the per-observation 'Bayesian Integral Log-odds' or 'BILD' score defined in Altschul et al. (2010). A more indirect Bayesian approach, which we have not implemented, is first to infer, from the prior and the observations, a posterior multinomial ~ ^ q () and then to calculate a column-information score based on ~ ^ q. This may be done using Equation (6), but with its second q j replaced by ^ q j , and with q j replaced by ^ q j in the formula for c(N). The correction term c(N) now depends on the priors used, so the values given in the Supplementary Tables S1 and S2 no longer apply, nor do the constants derived in the Appendix for the asymptotic formula for c(N). Minus its log-odds correction for sample size, this alternative Bayesian approach has strong similarities to the HMM measure proposed in Schuster-B ockler et al.. For proteins, both use Dirichlet mixtures to take account of the prior knowledge concerning amino acid relationships, as do BILD scores. However, as we will see below, properly correcting scores for small sample size (a distinct issue) is important if one wishes to compare the scores of columns containing differing numbers of observations.
Relationship of measures A and BA fairly deep connection exists between measures A and B. To a first approximation, the two measures are equal when the Bayesian prior required for B is taken as a single Dirichlet with all j =1=2 (). This is known as the Jeffreys prior, and is uninformative in a truer sense than the uniform prior, which has all j =1 (). Thus, measure A may be seen, in essence, as a special case of measure B, in which no prior knowledge concerning relationships among the letters is available. If there is substantial prior knowledge about which letters are likely to co-occur in columns representing true relationships, then by capturing this knowledge through its priors, the BILD-score-based measure of Equations (7) and (8) should, for related columns, usually exceed the normalized maximum-likelihood-based measure of Equation (6). Because such prior knowledge is available for proteins, we prefer B ~ x to A ~ x in this context. It is less clear that B will have any substantial advantage to A for DNA.
Logo boundariesBasing measures of column information on log-odds multiple alignment scores provides an automatic means for determining boundaries for a logo (). Because log-odds scores represent the information for distinguishing true from chance similarities, it is appropriate to seek logos with maximum implied log-odds score (). This is achieved by choosing a contiguous set of columns that maximizes, where N k is the number of observations in column k, and ~ x k is the associated observation vector. This optimization may be achieved using the algorithm of Smith and, simplified to the one-dimensional case.
Sequence weightsThe mathematics underlying multiple alignment log-odds scores () makes the implicit assumption that the letters observed in a column are independent draws from the multinomial representing that column. This is a reasonable assumption for most DNA multiple alignments, where the constraints on sequence are primarily physical (as in the alignment of instances of a transcription factor's binding sites across a genome) rather than historical. However, many or most protein multiple alignments contain some sequences that are similar primarily due to recent ancestry rather than to physical constraints. This problem may be mitigated through sequence weighting (e.g). Such weighting should account not only for the relative frequencies of the residues observed in each column but also for the effective number of independent observations as well (). Here, we use the weighting method ofas modified in. The method yields aggregate numbers of independent observations that vary by column, even for alignments without gaps; this result is consistent with the idea that evolution proceeds at different rates at different protein positions.
ProgramWe have modified the open-source WebLogo code () to implement the definitions of column information presented above. The new program, LogOddsLogo, is available at http://www.ncbi.nlm.nih. gov/CBBresearch/Yu/logoddslogo/index.html A stand-alone version of the program is also available from this site. The program's most important features are as follows:(1) The user may select either A ~ x of Equation (6) or B ~ x of Equations (7) and (8) to calculate the information content of sites. In either case, this information may be understood as a per-observation log-odds score. The measures R ~ x and U ~ x may also be specified. Null or gap characters are ignored, and not counted toward the number of observations in a column.(2) Because log-odds scores measure the relative evidence for models of relatedness and chance, information may be positive or negative, and is thus represented in the logo by positive or negative departures from the axis.(3) For proteins, if amino acid counts are calculated from a multiple alignment, as opposed to being supplied explicitly, the user has the option of automatically calculating weighted observations () for each residue.To apply measure B, one needs to specify a Dirichlet mixture prior. For DNA logos, we take this prior to be a single Dirichlet distribution, with parameters j =p j. The user may specify the concentration parameter , but we set = 1 by default, as recommended in. As in WebLogo (), the background frequencies p j are uniform by default, but the user may select those characteristic of various model organisms, or specify an arbitrary cytosine-guanine (CG) percentage. To apply measure B to proteins, the user may select among several Dirichlet mixtures, and amino acid background frequencies are then inferred from the mixture chosen. For other measures, the background frequencies of Robinson and Robinson (1991) are used. The stand-alone version of the program also allows the user to specify arbitrary background amino acid frequencies.
RESULTSIn the DNA context, it is appropriate to posit ignorance and use Jeffreys priors, essentially rendering measures A and B equivalent. Furthermore, although these measures are formally distinct from the entropy difference measure (), for uniform background frequencies, they differ only by an N-dependent constant, which approaches 0 as N grows. Measures A and B do differ substantially from entropy difference in the important case of non-uniform background frequencies, but for large datasets, they are still similar to the known relative-entropy measure. Thus, it is primarily in the protein context that a user will encounter noticeable differences between the measures we propose and other measures in common use. Here, to apply measure B to proteins, we use the Dirichet mixture 'dist-ncbi134', described in. For the sake of consistent comparison, we use the background frequencies implied by this mixture throughout. When used to analyze proteins, logos are usually applied to multiple alignments in which all the sequence segments included are, in fact, related. The primary purpose is to visualize those positions that are the most conserved, and thus presumably the most relevant to protein structure and function. To illustrate the behavior of our various measures, we first apply them to a particular HMGB box alignment in which the most important positions may be independently determined by structural features and by conservation within a broader encompassing family. Second, we consider a set of alignments of enzyme families, in which the catalytic sites stand as proxies for the most important positions.
HMGB box proteinsWe consider a subset of the HMGB box family of DNA binding proteins (http://www.ncbi.nlm.nih.gov/Structure/cdd/cddsrv. cgi?hslf=1&uid=cd01388&#seqhrch) prepared from the Conserved Domain Database (CDD) at NCBI (). We downloaded 24 aligned domains of the HMGB box domain from the SOX-TCF_HMG-box subfamily for use in this analysis (Supplementary). These subsequences comprise the $6972 amino acid long DNA-binding domain, and were aligned with reference to the Saccharomyces cerevisiae protein NHP6A () with known structure (PDB: 1J5N http://www.ncbi.nlm.nih.gov/Structure/mmdb/mmdbsrv. cgi?uid=49732). The HMGB box proteins form a large family with a wide range of DNA-binding functions and specificities. A subgroup within the family consists mostly of DNA-binding proteins that bind to specific target sequences, and the structures of several of the domains have been determined. For example, the structure of NHP6A () is similar to that of other HMGB box protein domains such as TCF/LEF-1 and SRY (). The compact domain contains a conserved sequence motif described in. These sequences fold into an L-shaped structure with three alpha helices and an unstructured N-terminal peptide. Using various considerations described in the caption of, and illustrated in the Supplementary, a set of 18 positions, numbered 5 10,, 62 and 69 within our alignment, can be identified as particularly important. Below, we will consider these 18 positions to be either true-positives or falsenegatives, and all other positions either false-positives or truenegatives.The four panels ofshow sequence logos for our HMGB box alignment that were constructed, respectively, using the information measures U, R, A and B. We weighted sequences using the method ofas modified in. All four measures report scores in bits, and are shown using a common scale, but only measures A and B, which have a similar log-odds interpretation, are directly comparable. For each measure, we selected a threshold score that yields seven false-positives, and the corresponding logo positions are colored blue. (Despite their designation here as 'falsepositives', these strongly conserved positions may well have important biological functions that have not yet been described.) Using these thresholds, we have colored true-positive positions red and false-negative positions orange. The measures U, R, A and B yield, respectively, 13, 13, 15 and 18 true-positives. The use of seven false-positives here is arbitrary. Different choices would yield different threshholds for separating true-positives from false-negatives, but broadly similar qualitative results. Comparing the panels offor measures U and R, it is evident that by correcting for the noise from small sample sizes, measure R renders the most important positions more visually prominent. However, for an alignment in which all columns contain the same number N of independent observations, measures U and R differ only by the constant correction term e(N), and thus, with corresponding thresholds, will always yield the same false-and true-positives. Because the weighting system we use () yields estimates for N that vary by column, measures U and R yield true-positives and false-negatives that are not completely congruent, although nevertheless similar. As we will see below, these measures can differ greatly when applied to sets of alignments containing widely varying numbers of sequences. Measure A differs from R in two major respects. First, its correction term c(N) is generally greater than e(N). This results in a more complete visual suppression of noise from nonconserved positions. Second, A attributes relatively greater information to positions populated primarily by rare amino acids. Comparing the panels offor measures R and A, this results in the elevation to true-positives of positions 10, 12, 62 and 69, whose most frequent amino acids are, respectively, the relatively rare M, F, H and Y. At the same time, it results in the demotion to false-negatives of positions 37 and 47, whose most frequent amino acids are the relatively common G and E, respectively. Among our measures, B is the only one to exploit prior amino acid relationship information. For alignments of related sequences, B thus yields greater reported information than A at almost all positions. This information increase will not necessarily be greater for important positions, but in our example it elevates to true-positive positions 37, 47 and 48. This stems, respectively, from the recognized relationships among the small G and A, the polar and negatively biased E, Q and D and the polar and positively biased K, Q and R (). One may not conclude from this single example that measure B will on average outperform A at recognizing important alignment positions, or that A will outperform U and R. However, the example illustrates the qualitative features that differentiate these measures and affect their performance.and B. The alignment on which the logos are based is given in Supplementary, we show the HMGB box logos produced using this default coloring system
Catalytic sitesThere are many structural and functional reasons for particular sites within protein families to be conserved, and it is difficult to systematically identify those that should be of most interest to a biologist. However, one class of positions that may be presumed to be of particular interest are catalytic sites within enzymes. Capra and Singh (2007) constructed a dataset of 660 multiple alignments of enzyme families in which the catalytic sites are known, and we have applied the measures U, R, A and B to this dataset, always first weighting the raw amino acid counts in each column. In, we show the resulting mean bit scores, and standard deviations for the dataset's 1999 catalytic sites, and 231 059 other sites. We note, first, that when moving from measure U to R, the larger decrease in mean score among catalytic vis-a-vis other sites is caused by our weighting scheme () assigning on average fewer aggregate independent counts N to highly conserved columns. As with the HMGB box proteins, measure A yields even greater average corrections, but it also adjusts columns' scores with reference to the background frequencies ~ p. Measure B increases the mean bit score for all columns vis-a-vis A, but does so to a greater degree for the catalytic sites. In, we compare distributions of the various measures' catalytic site scores after they have been normalized using the means and standard deviations of the non-catalytic site scores. For U, R, A and B, the mean-scaled catalytic site scores are, respectively, 1.43, 1.80, 2.01 and 2.02, and the median-scaled scores are 1.89, 1.96, 1.99 and 2.12. Thus, in comparison with U and R, the log-odds measures improve the separation of most catalytic site scores from those for the mass of non-catalytic sites. Receiver-operating characteristic (ROC) analysis () is often useful for comparing retrieval methods. The relevance of this analysis is somewhat vitiated here, because the non-catalytic sites contain a large percentage of functionally important positions that have as much claim to be considered true-positives as the catalytic sites, and these sites are presumably heavily represented among those with highest score. Nevertheless, in, we show ROC 35 000 curves and scores for the pooled results from the catalytic site dataset, representing $15% of all dataset columns. Measure U gives the uniform score of log 2 20=4:32 bits to all completely conserved columns, and always prefers them to columns in which more than one type of amino acid is observed; this yields the long straight-line segment in the curve for measure U. Failing to correct for small sample size is a particular handicap when scores are given significance outside the context of an individual multiple alignment, because a highly conserved but non-uniform column from a large alignment may well be of greater interest than a uniform column from a small alignment: measure R thus easily outperforms measure U. By this ROCanalysis, measures A and B outperform R, but neither is significantly preferred to the other. Adding prior information concerning amino acid relationships increases, on average, all bit scores, as seen in, but it does not appear to favor catalytic sites more than highly conserved non-catalytic sites.
DISCUSSION AND CONCLUSIONWe have proposed two distinct definitions for column information. Both are per-observation log-odds scores, taking the form 1 N log 2 Q ~ x=P ~ x, where Q ~ x and P ~ x are probabilities for the column's data under alternative models of relatedness and chance. The first measure A calculates Q ~ x using the maximumlikelihood multinomial ~ q=~ n=N but then normalizes over the space of all possible observation vectors ~ x, so that Q is a probability. A is closest in spirit and form to the original measure proposed by Schneider and Stephens (1990). The second measure B derives Q ~ x from a Dirichlet mixture prior over multinomial space. B is the per-observation BILD score from Altschul et al. (2010). In the DNA context, the assumption of ignorance underlying the measure A may yield the best information measure from the perspective of a molecule that is trying to recognize a DNA control element (). Other perspectives, however, are possible. Empirical study has shown that the multinomials characteristic of naturally occurring DNA motifs are more likely to be skewed toward a single nucleotide than even the Jeffreys prior would suggest. Thus, from a human perspective, more information for distinguishing motif from non-motif positions is attainable by using, e.g. a prior in which all j =0:25 (). When protein motifs are described with logos, even the molecular perspective of Schneider (1994) may be misleading. A protein may be seen as trying to achieve a particular conformation or structure within the constraints imposed by protein physics. The resulting correlations among amino acid frequencies at individual positions, which we discover empirically (), may be taken as implicitly known to evolution. To measure the information inherent in a protein motif, it is thus reasonable to use a Dirichlet mixture prior that captures these correlations, and not to be bound by an uninformative prior. All local pair-wise alignment scores may be seen as log-odds scores (), and all popular local alignment programs () may be understood as optimizing pair-wise log-odds scores. Extending the logodds formalism to multiple alignments () retains many of the features that render it useful for pair-wise alignment. We have modified the open-source program ofto use the log-odds measures A ~ x and B ~ x as well as the entropy difference measures U ~ x and R ~ x. Applying all these measures to an alignment of HMGB box proteins, and to a dataset of enzyme alignments, we found that log-odds scores facilitate the recognition of structurally and functionally important sites. For protein alignments, we prefer B ~ x on the theoretical grounds that prior knowledge concerning amino acids relationships is implicitly available to evolution and thus relevant to analyzing protein families. There is also some evidence that exploiting this knowledge increases the separation by score of biologically important from less important sites. We have made Web-based and stand-alone versions of our program available.
Published by Oxford University Press 2014. This work is written by US Government employees and is in the public domain in the US. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
Log-Odds Sequence Logos at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
Y.-K.Yu et al. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
