Many fundamental questions in evolutionary biology entail estimating rates of lineage diversification (speciation–extinction) that are modeled using birth–death branching processes. We leverage recent advances in branching-process theory to develop a flexible Bayesian framework for specifying diversification models—where rates are constant, vary continuously, or change episodic-ally through time—and implement numerical methods to estimate parameters of these models from molecular phylogenies, even when species sampling is incomplete. We enable both statistical inference and efficient simulation under these models. We also provide robust methods for comparing the relative and absolute fit of competing branching-process models to a given tree, thereby providing rigorous tests of biological hypotheses regarding patterns and processes of lineage diversification. Availability and implementation: The source code for TESS is freely available at http://cran.r-pro ject.org/web/packages/TESS/.
IntroductionStochastic-branching process models (e.g. birthdeath models) describe the process of diversification that gave rise to a given study tree, and include parameters such as the rate of speciation and extinction. Statistical analysis of lineage diversification rates involves: (i) simulating trees under null and alternative hypotheses; (ii) estimating parameters in, e.g. a Bayesian framework, and; (iii) evaluating the relative and absolute fit of candidate models. These considerations motivated our development of TESS, an R package for statistical inference of lineage diversification rates that allows researchers to address three fundamental questions: (i) What are the rates of the process that gave rise to my study tree? (ii) Have diversification rates changed through time in my study tree? (iii) Is there evidence that my study tree experienced mass extinction? We compare TESS to other software in the accompanying vignette (http://cran.r-project.org/web/packages/TESS/).
Methods and algorithms
Branching-process modelsInferring rates of lineage diversification is based on the reconstructed evolutionary process described by; a birthdeath process in which only sampled, extant lineages are observed. Our implementation exploits recent theoretical work () that allows the rate of diversification to be specified as an arbitrary function of time (but is constant across lineages at any instant). By adopting this generic approach, we can specify an effectively infinite number of branching-process models in TESS. These possibilities correspond to four main types of diversification models:
Phylogeny simulationTESS can be used to efficiently simulate phylogenies under any timedependent birthdeath process (H hna, 2013). Simulation is crucial both for evaluating the performance and statistical behavior of an inference method, and also for evaluating model adequacy (see below).
Phylogenetic dataTESS can be used to estimate parameters of any time-dependent birthdeath process from a given tree. Specifically, TESS requires rooted ultrametric trees, where all of the tips are sampled at the same time horizon (the present). Additionally, TESS implements various approaches for accommodating incompletely sampled trees, including uniform and diversified species-sampling schemes (H hna et al., 2011; H hna, 2014).
Parameter estimationIn TESS, parameters of the branching-process models are inferred in a Bayesian statistical framework. Specifically, we estimate the joint posterior probability density of the model parameters from the study tree using numerical methods; Markov chain Monte Carlo (MCMC) algorithms (). The numerical methods implemented in TESS include adaptive-MCMC algorithms () where the scale of the proposal mechanisms is automatically tuned to ensure optimal efficiency (mixing) of the MCMC simulation and also feature real-time diagnostics to assess convergence of the MCMC simulation to the stationary distribution (the joint posterior probability density of the model parameters). The real-time diagnostics, such as the minimum effective sample size and the Geweke statistic, are used to automatically terminate the MCMC simulation when it has drawn an adequate sample from the posterior.
Model comparisonEach branching-process model specifies a possible scenario for the diversification process that gave rise to a given study tree. For most studies, several (possibly many) competing branching-process models of varying complexity will be plausible a priori. We therefore need a way to objectively identify the best candidate diversification model. Bayesian model selection is based on Bayes factors (e.g.). This procedure requires that we first estimate the marginal likelihood of each candidate model, and then compare the ratio of the marginal likelihoods for each pair of candidate models. We have implemented both stepping-stone sampling () and path-sampling () algorithms for estimating the marginal likelihoods.
Model adequacyBayes factors allow us to assess the relative fit of two or more competing branching-process models to a given study tree. However, even the very best candidate model may nevertheless be inadequate in an absolute sense. Accordingly, TESS implements methods to assess the absolute fit of a candidate diversification model to a given study tree using posterior-predictive simulation (). The basic premise of this approach is as follows: if the diversification model under consideration provides an adequate description of the process that gave rise to our study tree, then we should be able to use that model to generate new phylogenies that are in some sense 'similar' to our study tree. TESS permits use of any test statistic e.g. the c-statistic or any tree-shape statistic to identify rate variation among lineages ()to measure the similarity between predicted and observed data.
Model averagingThe vast space of possible branching-process models precludes their exhaustive pairwise comparison using Bayes factors. This issue may be addressed by means of model-averaging approaches that treat the model as a random variable (). TESS implements such an approach; the CoMET (CPP on Mass-Extinction Times) model (), which uses a compound Poisson process (CPP) model and reversible-jump MCMC to average over all possible models ().
ConclusionsTESS allows users to specify an effectively countless number of diversification models, where each model describes an alternative scenario for the diversification of the tree. TESS can be used to efficiently simulate. Estimating rates of (and identifying shifts in) lineage diversification through time. Left: Plots of the posterior mean and 95% credible interval for the speciation and extinction rate (upper and lower panels, respectively). Right: Identifying temporal shifts in the speciation and extinction rate (upper and lower panels, respectively) using Bayes factors estimated by rjMCMC. Each bar indicates the posterior probability of at least one rate shift within that interval. Bars that exceed the specified significance threshold (here, 2 ln BF. Identifying significant mass-extinction events using rjMCMC. Each bar indicates the posterior probability of at least one mass extinction within that interval. Bars that exceed the specified significance threshold (here, 2 ln BF > 6) are inferred to be significant mass-extinction events. Here we show results for the conifer analysis (), which identifies one significant massextinction event that occurred 22 million years ago under and/or infer parameters of these models. Additionally, TESS provides robust methods for assessing the relative fit of competing models to a given tree, providing users with an extremely flexible yet intuitive framework for testing hypotheses regarding the patterns and processes of lineage diversification. TESS is accompanied by a comprehensive vignette that provides detailed explanations of the methods and examples (http://cran.r-project.org/web/packages/TESS/). Conflict of Interest: none declared.
at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
S.H hna et al. at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
