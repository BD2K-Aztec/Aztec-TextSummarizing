Motivation: A wide range of fundamental biological processes are mediated by membrane proteins. Despite their large number and importance, less than 1% of all 3D protein structures deposited in the Protein Data Bank are of membrane proteins. This is mainly due to the challenges of crystallizing such proteins or performing NMR spectroscopy analyses. All the more so, there is only a small number of membrane protein–protein complexes with known structure. Therefore, developing computational tools for docking membrane proteins is crucial. Numerous methods for docking globular proteins exist, however few have been developed especially for membrane proteins and designed to address docking within the lipid bilayer environment. Results: We present a novel algorithm, Memdock, for docking a-helical membrane proteins which takes into consideration the lipid bilayer environment for docking as well as for refining and ranking the docking candidates. We show that our algorithm improves both the docking accuracy and the candidates ranking compared to a standard protein–protein docking algorithm. Availability and Implementation
IntroductionAnalysis of the complete genomic sequences for several organisms indicates that 30% of all genes code for membrane proteins (). Due to their central role in a wide range of fundamental biological processes, membrane proteins constitute around 60% of approved drug targets (). However, despite their large number and importance and even though there is an increasing number of solved membrane protein structures, they are still under-represented in the Protein Data Bank (PDB)(). In July 2015 only 1722 PDB entries were of membrane proteins (http://blanco.biomol.uci.edu/ mpstruc/). This is owing to the difficulties involved in expressing, purifying and crystallizing these proteins (). In light of this deficit of empirical information, it is particularly important to develop efficient computational methods for predicting the structure, interactions and docking of membrane proteins. Docking algorithms aim to predict the atomic resolution structure of a proteinprotein complex given the structure of the separate proteins. Binding of two proteins to form a complex often results in conformational changes of the proteins. Therefore, there is a distinction between docking of 'bound' and 'unbound' protein structures. The conformation of the 'bound' structures is identical to their conformation in the complex, whereas the 'unbound' structure conformations are either the native conformation of the separate proteins in solution or their conformation in other complexes. Docking 'unbound' structures is a significantly more difficult task, since, as mentioned above, the 'unbound' proteins might undergo conformational changes upon binding ().The pipeline of docking algorithms usually includes three steps:(i) rigid docking; (ii) conformational refinement and (iii) docking candidates re-ranking by an energy score (). Numerous methods exist for the first step of rigid protein docking (). These include Fast Fourier Transform based methods (ZDOCK,), shape complementarity search by Geometric Hashing (PatchDock,), Monte-Carlo based algorithms () or information driven methods (e.g. HADDOCK,). In the first step, of rigid-body docking, minor steric clashes between the receptor and the ligand structures are penalized liberally, thus tolerating conformational inaccuracies, which usually do not affect the protein backbone, but could have a significant impact on the side chain conformations. Consequently, the calculated energy value of a docking candidate could be high even if it is a near native one. Thus, it is necessary in the next step of refinement to remove steric clashes from the structures by exploring the conformational space of the side chains, while allowing minor movements in the backbone, as well (). All refinement methods use energy based scoring functions for re-ranking the candidate complexes in the last step. Membrane proteins have special properties which are determined by their hydrophobic environment. Since the membrane imposes strong folding constraints, the polar groups of the polypeptide backbone of the membrane protein participate in intra-molecular hydrogen bonds. This is typically accomplished through two structural motifs: the membrane-spanning alpha-helix bundle and the beta-barrel (). One of the advantages of membrane protein modeling is the smaller conformational search space which includes those two structural motifs. In the past decade there was a vast improvement in membrane protein modeling as outlined in a recent comprehensive review () Developing algorithms for membrane proteins docking is important for understanding various fundamental biological processes and, especially, for drug design.performed a systematic study on the suitability of some commonly used protein docking software designed for globular proteins, for modeling complexes of membrane proteins. Their results indicate that these algorithms can be used for obtaining relatively reliable models of membrane protein complexes. However, the proteinprotein docking results for membrane proteins are worse than corresponding results for water-soluble proteins. They also conclude that the GRAMM-X algorithm () may be considered the best performing algorithm for membrane proteins. Kaczor et al. explain GRAMM-X success by noting that it takes into account evolutionary conservation in its scoring function.developed an algorithm for predicting the quaternary structure of a-helical multi homo-oligomers based on the ZDOCK 2.1 docking suite (). In a post processing step they filter the results which do not conform with the expected orientation of the transmembrane segments vis-a-vis the membrane lipid bilayer.also developed a protocol for modeling GPCR dimers. In the protocol each monomer is rotated around its z-axis by increments of p/6 resulting in 144 dimer models compatible with membrane integration. In the next step, Rosetta proteinprotein docking () is applied using local refinement mode, resulting in a final population of 1440 dimer models. The obtained dimer models are evaluated according to a set of scoring factors especially tailored for GPCR. The scoring function contains up to 11 different parameters, such as: potential energy, electrostatic interaction energy, free energy of binding, energy of hydrogen bond interactions, evolutionary conservation score, shape complementarity and more. The protocol was evaluated on six GPCR dimers. The results showed a correct indication for all six dimers.developed a tool, MPDock, which combines RosettaMP with the RosettaDock algorithm. The algorithm conducts a local docking refinement of proteinprotein complex hypotheses. MPDock was tested on five proteinprotein complexes. Out of 1000 models for each complex the scoring function was able to rank the native-like as a top scoring in about half of the targets. Recentlydeveloped an algorithm for docking membrane proteins. In their work they use the rigid body docking algorithm DOCK/PIER without adaptation to the membrane environment. Then the results are re-ranked with a new score developed for membrane proteins in which a new energy term is added representing the membrane transfer energy. The algorithm was applied to a benchmark of 30 protein complexes and was able to obtain a near-native structure in the top ten solutions for 36.7% of the complexes. In the current paper we present an integrated docking algorithm which includes the docking, refinement and re-ranking stages designed for docking within the membrane. Our docking algorithm, Memdock, attempts to customize all three docking steps to the lipid bilayer environment. The first step of our algorithm is based on the PatchDock algorithm (). PatchDock is an efficient rigid 'unbound' soft docking algorithm, which ranks docking candidates mainly by geometric shape complementarity between the docked proteins. In the modified PatchDock (Mem-PatchDock) the hypothesized placement of the docked proteins is enforced to be in a membrane consistent orientation. Thus, the change in the angle formed between the protein helical axis and the membrane normal in the apo and holo forms of the protein is constrained. Likewise, the shift in the position of the protein helices along the membrane normal cannot change significantly as a result of the docking. In the second step, a refinement algorithm is used, based on the FiberDock algorithm (), which conducts flexible refinement of docking candidates. The method models both side-chain and backbone flexibility and performs rigid body optimization of the ligand orientation. In the modified FiberDock (Mem-FiberDock), perturbations of the ligand are enforced to be in a membrane consistent orientation, similarly to the rigid docking step. Finally, the refined models are re-scored and re-ranked according to an energy function that was designed specifically for membrane proteins. We evaluated our algorithm on an a-helical membrane proteins dataset and show that it performs well and much faster when docking membrane proteins compared with the original algorithms designed for the docking of globular proteins.
Materials and methods
Benchmark setA benchmark dataset of a-helical membrane proteins was collected from the Orientations of Proteins in Membranes (OPM) database (). OPM provides spatial arrangements of membrane proteins with respect to the hydrocarbon core of the lipid bilayer and includes all unique experimental structures of membrane proteins. The initial set of PDB entries for proteins was filtered to include at least one a-helix within the membrane. Then each pair of chains was tested for binding within the lipid bilayer. A final non-redundant subset of 64 protein pairs was generated, with less than 40% sequence Memdockidentity for at least one pair of components. The subset of protein pairs was divided to 21 protein pairs for evaluating the algorithm and 43 protein pairs for training. Eleven protein pairs (out of the 21 pairs used for benchmarking) were used for the 'unbound' evaluation (described below). The training set proteins and the benchmark proteins are listed in Tables A and B (respectively) of the Supplementary Materials. Our algorithm was evaluated in the 'bound' and 'unbound' docking scenarios. The 'bound' structures were extracted from the original PDB complex. The 'unbound' structures were constructed by modeling the individual chains according to homologous sequences using MODELLER (). Homologous sequences (with identity of 5585%) were retrieved using BLAST (). Only in 11 out of the 65 protein pairs homologues could be found which were not (structurally) identical to the native structures. Only these were used for the evaluation. The list of 'unbound' structures, their sequence identity percentage and RMSD from the native can be found inof the Supplementary Materials.
Protein movement in the membrane environment is restricted  membrane protein docking principleThe guiding principle in designing membrane protein docking algorithm is that proteins in the membrane are restricted in their movement between their apo and holo structures. Specifically, given an apo structure, let's attach a 3D Euclidean coordinate frame XYZ to this structure, centered at its center of mass and having the Z axis parallel to the membrane normal. After docking this structure will be transformed to the holo structure with the coordinate frame X 0 Y 0 Z 0. Due to the above mentioned restrictions the center of mass of the holo structure can have only a limited translation in the Z direction and the angle between the Z and Z 0 axes is limited as well (see).
The rigid docking stepIn this step the docked protein structures are maintained rigid. One of the protein molecules, which will be named 'receptor', remains fixed and the other protein molecule, which will be named 'ligand', is moving with respect to the receptor to find the docking candidates. Our rigid membrane protein docking algorithm is based on the PatchDock algorithm (). PatchDock is a geometrybased molecular docking algorithm, which detects docking candidates that yield good molecular shape complementarity. The PatchDock algorithm divides the surface of the proteins molecules into concave, convex and flat patches. Then, complementary patches are matched in order to generate docking candidates. An RMSD (root mean square deviation) clustering is applied to the docking candidates in order to discard redundant solutions. Customizing PatchDock to membrane proteins, using MemPatchDock, is done by enforcing membrane consistent poses for the docking candidates. This is carried out during the patch matching stage by limiting the translations along the Z axis up to a threshold of 8 A  and the rotation tilt angle from the original Z axis up to a threshold of 0.4 radians. Thus, in the patch matching stage both complementarity between the patches and the proper position within the membrane bilayer is being thought. Limitations of the translation along the Z-axis to 8 A  was motivated by the findings ofthat the average length of helices in ahelix bundle membrane proteins is 38 6 7 A  .used a 6 A  translation limitation in their work. The input to the Rigid Docking step are two separate proteins structures oriented so that the Z axis is parallel to the membrane plane normal and the centroid of the proteins is at zero.
The refinement and re-ranking stepsFor the refinement step we present an algorithm based on the FiberDock algorithm (Mem-FiberDock). In FiberDock () each candidate complex is subsequently refined by restricted interface side-chain rearrangement and by soft rigid-body optimization. The side-chain flexibility is modeled by rotamers and the obtained combinatorial optimization problem is solved by integer linear programming (). Following rearrangement of the side-chains, a normal mode analysis (NMA) based backbone refinement procedure is applied. Finally, the relative position of the docking partners is refined by Monte Carlo minimization of the binding score function. Customizing FiberDock to membrane environment, using MemFiberDock, is done in two stages: first, a preprocessing step of filtering membrane inconsistent docking candidates' complexes generated in the rigid docking step is performed. This stage is conducted for cases in which the input to the refinement algorithm was not produced by Mem-PatchDock. This preliminary stage is carried out by limiting the Z-axis offset of the ligand, and tilt angle from the original structure, up to 12 A  and 0.8 radians respectively. These are evaluated on the Z axis of the Center Of Mass (COM) of the ligand. During refinement membrane orientation is re-evaluated before each rigid body perturbation by limiting the Z coordinate perturbation movement up to an 8 A  shift and an 0.4 radians angle rotation. The refined candidates are re-ranked by the energy function designed for membrane proteins, as described below.
Energy functionWe have developed a scoring function (Memscore) based on statistics derived from known 3D structures of a-helical membrane proteins. The energy function takes into account the lipid bilayer environment, distinguishing polar and hydrophobic layers. The function was adopted partially from the FireDock method () with additional membrane parameter E env (environment energy), while deleting the desolvation ACE (AtomicContact Energy) based component and the density energy. The function includes Atomic softened van der Waals interactions energy (E repVdW  van der Waals repulsion energy, E attVdW  van der Waals attraction energy), partial electrostatics (E repElect  electrostatic repulsion energy, E attElect  electrostatic attraction energy) and estimations of the binding free energy (E HB  Hydrogen bond energy, E aliph  aliphatic interaction energy and E pipi  pp interaction energy). E env potential score is analogous to the environment score used in the Rosetta membrane protein modeling prediction method (). The calculated energy score is a linear combination of the individual energy terms (see Equation 1), where ah are user defined weights. The weights were calculated on a 43 membrane proteins training set (of the Supplementary Materials). Training was conducted using a genetic programming algorithm ().E env potential score was calculated by dividing the membrane into horizontal layers. The layers, similarly to the layers chosen byfor membrane protein modeling, approximately corresponding to the water-exposed, polar, interface and hydrophobic layers of the membrane (described by) (layer 1:-12 A  Z coordinate 12 A  , layer 2: 12 A  < Z coordinate 18 A  , layer 3: 18 A  < Z coordinate 24 A  , layer 4: 24 A  < Z coordinate, layer 5:-18 A  Z coordinate <-12 A  , layer 6:-24 A  Z coordinate <-18 A  , layer 7: Z coordinate <-24 A  ). The environment potential was defined as:where i is a residue index, N(aa i jL,B) is the number of amino acid type aa i in a layer/burial (L,B) state and N(aa i ) is the frequency of amino acid type aa i (20 amino acid types) in all layer/burial states. The buried state of a residue presents the number of neighboring residues around it. It was defined as the number of residue centroids within 10 A  of the examined residue centroid (define in), classified into four states (neighbors number 5, 6 neighbors number 11, 12 neighbor s number 17, neighbors number ! 18).
Evaluating the docking candidatesThe parameters used to evaluate the quality of the predicted docking candidates were as in the CAPRI challenge (). The docking results are classified into three categories: 'High', 'Medium' and 'Acceptable' according to the values of the parameters Irms (Interface RMSD), Lrms (Ligand RMSD) and fnat (fraction of native contacts):
Comparison with PatchDock/FiberDock and GRAMM-X algorithmsMemdock performance was compared with the performance of the algorithms on which it is based: using PatchDock for rigid body docking followed by FiberDock for the refinement. These were run with the default 'unbound' setting. For the refinement stage up to 1000 docking candidates were chosen. In addition, Memdock performance was compared with that of GRAMM-X algorithm, which includes both rigid docking and refinement stages. GRAMM-X was chosen as it was shown in previous work () to perform the best from numerous docking algorithms on a membrane proteins benchmark. GRAMMX algorithm was run via its server with the default parameters and 100 outputs.
ResultsThe Memdock algorithm is particularly efficient. Mem-PatchDock running time on membrane proteins is by an order of magnitude shorter than that of the original algorithm, PatchDock (). Moreover, the number of docking candidates drops significantly with Memdock and the percentage of complexes with an at least 'Acceptable' docking candidate increases. The results are presented inand inof the Supplementary Materials.
Docking results
'Bound' structures resultsOur algorithm was evaluated on 21 'bound' structures. Comparison between the performance of PatchDock/FiberDock, Memdock and GRAMM-X was conducted. In addition, docking candidates were ranked using FiberDock score and the Memscore (Memdock score). The docking results are shown in. Memdock protocol succeeds to sample and rank structures of 'Acceptable' or higher accuracy among the top ten docking candidates in 71% of the benchmark complexes compared to only 33%in the original algorithm designed for standard docking using PatchDock/FiberDock and 57% in GRAMM-X algorithm.
'Unbound' structures resultsOur algorithm was evaluated on 11 'unbound' structures with available template homologous sequences. The docking results are shown in. In this experiment an 'Acceptable' solution was ranked at the top in 4 of the cases and was found among the top 100 candidates in 8 of the cases when using the Memdock protocol. On our benchmark Memdock implemented with the membrane specific Memscore did not outperform in the 'unbound' cases application of Memdock with the non-specific Fiberdock score. However, when PatchDock/Fiberdock was first used for docking the membrane proteins and the resulting candidates have been reranked with Memscore it contributed significantly to the improvement of the results (in Supplementary Materials). This might indicate that the membrane consistent translations and rotations enforced by Memdock and the membrane oriented layer scoring of Memscore are essentially based on the same information.
Further docking analysisFurther analysis was performed in order to check whether the structures in which GRAMM-X succeeds in docking have a conserved binding site, since GRAMM-X uses an evolutionary conservation term in its scoring function. This analysis was performed by ConSurf (). Indeed, the complexes in which GRAMM-X predicted an 'Acceptable' or higher accuracy among the top ten docking candidates had a conserved binding site (Tables B and D, Supplementary Materials). In fact in most of our benchmark complexes there is certain level of conservation in the binding site (Table B, Supplementary Materials). The docking success of Memdock is influenced by the size of the binding site (Tables B and D of the Supplementary Materials). One can see that most of the proteins pairs in which the docking was less successful had a small binding site. In addition, the docking was not influenced by the size or the protein or the tilt angle of the helices.
Docking and refinement success in using the membrane algorithmsWe present in this section several examples of membrane protein complexes which highlight the advantage of using the membrane docking algorithm-Memdock () on the 'unbound' dataset. The enzyme cytochrome c oxidase (1M56) controls the last step of food oxidation. Cytochrome c oxidase takes electrons and attaches them to an oxygen molecule converting molecular oxygen to two molecules of water. Docking was performed with comparative models based on templates of 97.6% (PDB 3OMI) and 72% (PDB 1QLE) sequence identity for chains A and B, respectively. PatchDock/FiberDock protocol did not find in any 'Acceptable' docking candidate. Memdock, however, found an 'Acceptable' accuracy docking candidate ranked 11th (). Multisubunit cytochrome b (1Q90) interacting with the complex Photosystems I and II which reaction centres capture light energy in order to derive oxygenic photosynthesis. Docking was performed with comparative models based on templates of 85% (PDB 2ZT9) sequence identity for chains B and S. PatchDock/FiberDock protocol found an 'Acceptable' docking candidate ranked 525. Memdock, however, found an 'Acceptable' accuracy docking candidate ranked first (). Pentameric formate channel (3KLY) enables formate transport across the inner membrane which is a critical step in anaerobic bacterial respiration. Docking was performed with comparative models based on templates of 55.3% (PDB 3KCU) sequence identity for chains A and B. PatchDock/FiberDock protocol did not find in any 'Acceptable' docking candidate. Remarkably, Memdock, found a 'High' accuracy docking candidate ranked first ().
Efficient rigid dockingThe original PatchDock is a fast and efficient algorithm. The main reason behind PatchDock's high efficiency is its fast transformational search, which is driven by local feature matching rather than bruteCytochrome c oxidase , chains A and C (1M56), (b) Cytochrome b, chains B and S (1Q90) and (c) Pentameric formate channel, chains A and B (3KLY)force searching of the six-dimensional transformation space. It further speeds up the computational processing time by utilizing advanced data structures and spatial pattern detection techniques, such as geometric hashing and pose clustering (). The new developed algorithm designed for membrane proteins is even more efficient than the original one because it further limits the transformation search. In addition, the number of docking candidates decreases significantly (). There is no significant difference in the refinement speed between Mem-FiberDock and FiberDock, however, the number of docking candidates entering refinement is significantly reduced by Memdock.
DiscussionWe introduced an algorithm with excellent performance for docking and refinement of a-helical membrane proteins. This improvement is achieved by introducing sampling and scoring specific for membrane proteins. First, we enforce membrane consistent orientation in both docking and refinement steps as an integral part of the algorithms rather than a post-processing step. Second, the refined docking candidates undergo re-ranking using a scoring function formulated from combination of knowledge-based potentials derived from statistical analyses of known 3D structures of a-helical membrane proteins and the FireDock scoring function terms which are based on the binding forces between the receptor and the ligand. The algorithm was applied to a benchmark set of 21 'bound' proteins structures and 11 'unbound' protein structures. In 33% of the 'bound' benchmark set and 36% of the 'unbound' benchmark set an 'Acceptable' docking candidate was ranked at the top (). In 71% of the 'bound' benchmark set and 45% of the 'unbound' benchmark set an 'Acceptable' docking candidate was predicted among the top 20 ranking results (). Thus, the algorithm is shown to perform well both on the 'bound' and on the 'unbound' examples. The algorithm significantly improves docking accuracy and the speed compared to the standard docking. A web server for the Memdock algorithm is being currently implemented and will be available at http://bioinfo3d.cs.tau.ac.il/ Memdock/.
at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
N.Hurwitz et al. at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
