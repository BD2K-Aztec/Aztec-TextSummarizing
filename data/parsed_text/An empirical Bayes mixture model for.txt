Motivation: Detecting single-nucleotide polymorphism (SNP) in pooled sequencing data is more challenging than in individual sequen-cing because of sampling variations across pools. To effectively differentiate SNP signal from sequencing error, appropriate estimation of the sequencing error is necessary. In this article, we propose an empirical Bayes mixture (EBM) model for SNP detection and allele frequency estimation in pooled sequencing data. Results: The proposed model reliably learns the error distribution by pooling information across pools and genomic positions. In addition, the proposed EBM model builds in characteristics unique to the pooled sequencing data, boosting the sensitivity of SNP detection. For large-scale inference in SNP detection, the EBM model provides a flexible and robust way for estimation and control of local false discovery rate. We demonstrate the performance of the proposed method through simulation studies and real data application.
INTRODUCTIONRecent advances in next-generation sequencing (NGS) technologies have significantly reduced the cost and time involved in sequencing the human genome in hundreds or thousands of individuals. The resulting comprehensive genomic analyses will provide powerful tools for discovering the genetic variations underlying complex phenotypic traits. NGS holds the promise of revolutionizing genetic studies due to its ability to detect rare variants that are not observed in array-based genome-wide association studies (GWAS). The importance of rare variants underlying complex diseases has been discussed in a number of recent articles (). It is believed that rare variants account for a significant proportion of genetic heritability missed by previous GWAS (). Although the cost of NGS has dropped dramatically over the past few years, it is still prohibitively expensive to sequence individual genome at a sufficient read depth. An alternative approach to reduce the cost of sample preparation and sequencing is to pool genomic DNA from multiple individuals and sequence the pooled DNA samples (). The feasibility of pooled sequencing has been demonstrated in several studies ().used pooled sequencing to identify causal rare variants in candidate genes of Type I diabetes. When analyzing NGS data, the first step is to identify polymorphic sites in the genomic regions. A number of computational methods have been developed to identify singlenucleotide polymorphisms (SNPs) in individual sequenced samples (). These methods use sequencing and mapping quality scores to distinguish true SNPs from sequencing and mapping errors. Some methods utilize cross-sample information to estimate sequencing error at each genomic position (). In addition, incorporation of pedigree information and linkage disequilibrium (LD) has been demonstrated to significantly improve SNP calling accuracy in individual sequencing (). Methods for individual sequencing do not directly apply to SNP calling in pooled sequencing. Characteristics unique to pooled sequencing make SNP calling more challenging than in individual sequencing. First, because of sampling variation, the frequency of a variant allele will vary across the pools. Allele frequency in a pool is a function of the population allele frequency and pool size (number of individuals in a pool;). In cases in which there exists a rare variant with small pool size, the presence of the variant allele will be sporadic across pools. In contrast, in individual sequencing, the variant allele frequency for a diploid sample is 0, 0.5 or 1. Variation of allele frequency across pools makes it difficult to differentiate the true SNP signal from sequencing error. Second, external information, such as pedigree and LD information, is not available in pooled sequencing. Third, because of the small number of pools, it is almost impossible to get a good estimate of the sequencing error using only cross-pool information. Therefore, sophisticated methods are needed to call SNPs in pooled sequencing. Recently, several SNP calling methods designed for pooled sequencing have been reported (). SNPSeeker (), derived from large deviation theory, requires negative control data to estimate error model. CRISP (Comprehensive Read analysis for Identification of Single Nucleotide Polymorphisms from Pooled sequencing,) models allele counts across multiple pools using contingency tables. It uses Fisher's exact test to detect uneven distributions of variant reads across pools and then uses Chernoff bound to compute an upper bound on the P-value of the overabundance of alternate alleles within each *To whom correspondence should be addressed. pool against the sequencing error. This method builds on the assumption that the presence of a rare variant in a pool is likely to cause excess variant reads compared with the other pools. Such an assumption does not hold for less rare or common variant and is questionable when the pool size is large. Consequently, CRISP is not effective for detection of less rare and common SNPs. As an alternative approach, SNVer () models variant reads in a single pool using a binomialbinomial model and combines P-values from multiple pools to identify SNPs. Because it is difficult to simultaneously estimate the population allele frequency and sequencing error using the binomialbinomial model, SNVer arbitrarily specifies the sequencing error to be 0.01 for all positions. As we show in the simulation studies, inaccurate specification of sequencing error will lead to high false-positive rates and low sensitivity. In this article, we introduce an empirical Bayes mixture (EBM) model for detecting SNPs in pooled sequencing data. In contrast to the existing methods that detect SNPs one at a time, the EBM model learns error distribution by pooling information across multiple pools and genomic positions. It is well known that the sequencing error at each position is highly reproducible across samples or pools. Cross-sample information in individual sequencing has been gathered to estimate sequencing error. However, in pooled sequencing, direct estimation sequencing error has not been explored due to the small number of pools available and the variations of allele frequency across pools. Additional information is needed to obtain a good estimate of the sequencing error in pooled sequencing. Using the EBM model, data across genomic positions can be pooled to learn the error distribution. Since the density of a SNP is estimated to be approximately 1 of 1000 bases (), leveraging the information from a large number of null positions will allow fairly accurate estimation of the error distribution. The fundamental idea of pooling information to estimate null distribution in empirical Bayes methods has been applied to genomic data since the advent of microarray analysis (extended Efron's empirical Bayes method to detect SNPs in individual sequencing. In this article, different from previous methods, we propose an EBM model that builds in characteristics unique to pooled sequencing for SNP detection. The EBM model blurs the line between hypothesis testing and parameter estimation. In addition to SNP detection, the proposed method produces empirical Bayes shrinkage estimation of allele frequency. Allele frequency estimation is important for downstream analyses, such as association studies or population genetic analysis. Yet, it is left unexplored by the current SNP detection methods. In the EBM model, SNP detection and allele frequency estimation are nicely integrated. In the following sections, we will present mathematical formulation of the EBM model and demonstrate its performance through simulation studies and a real data application.
METHODSOur objective is to build an EBM model to pool information across genomic positions and utilize sequence reads from multiple pools to identify SNPs. Consider a sequencing study in which a targeted region of I nucleotides is sequenced in K pools. Each pool contains n diploid individuals (i.e. 2n haplotypes, n is not necessarily equal across pools). We assume that the reads from each pool have been aligned to a reference genome. Suppose there are N ij reads covering position i in pool j, among which V ij are mismatches (V ij is the count of the most frequent non-reference base and we ignore reads of other bases). In the absence of a variant, mismatched reads are merely the result of sequencing error (base calling error or/and alignment error) and are expected to be similar across pools since most sequencing errors are local context dependent (). On the other hand, the presence of a variant will result in excessive mismatches in one or more pools, and the variant allele reads distribution is likely to be uneven across pools for rare variants. Existing methods, such as CRISP, use the uneven distribution across pools as a signal to identify SNPs. Our proposed EBM model also incorporates such cross-pool information to enhance the sensitivity of SNP detection. In addition, the EBM model pools data across genomic positions to learn the error distribution. Due to small number of pools, sequencing error is difficult to estimate from the data for each individual position. To overcome this difficulty, empirical Bayes approach specifies a prior distribution on position-specific parameters and learns the prior distribution by aggregating the data across different positions. Simultaneously incorporating information across pools and positions increases the sensitivity for detection of true SNP sites. Next, we present the detailed formulation of the EBM model.
EBM modelFor a particular position i in pool j, we model the mismatch counts V ij as drawn from a binomial distribution V ij $ BinomialN ij , p ij . Instead of specifying an EBM model for V ij , we first apply a normalizing and variance stabilizing transformation to the data V ij , N ij :Brown (2008) has shown that transformed data are approximately normal for moderate or large size of N ij (for example, N ij ! 12): Z ij $ N ij , 1 4Nij  and ij  arcsin ffiffiffiffi ffi p ij p. By using equation (1), the count data are transformed to more familiar Gaussian data. Importantly, the transformation equation (1) ensures the variance of Z ij is known and independent of ij. Data across pools are collected into vectors. Let Z i  Z i1,. .. , Z iK  0 and k i   i1 , i2 ,. .. , iK  0. Bold letters are used to denote vectors and matrices. We assume Z i , k i  are generated from the following hierarchical model:where D i  diag 1 4Ni1 ,. .. , 1 4NiK  is the diagonal matrix whose elements are 1 4Nij. In this hierarchical model, Z ij is independently normal with a variance of 1 4Nij , conditioned on the mean vector k i. The empirical Bayes approach does not specify the prior distribution h in advance. Instead, it models h using a mixture of multivariate Gaussians and estimates the mixture distribution from the data. The mixture Gaussians can approximate any smooth density and gives a flexible and nearly non-parametric way to model the prior distribution (). Specifically, let hk i   X null components of equation (3), let P  K 1 ee 0 be the K  K projection matrix onto the rank 1 space of constant vectors, where e 0  1,. .. , 1 is a K  1 vector of 1 s. Let Q  I K  P be the projection matrix onto the orthogonal complement of RP. We can write any vector k i  Pk i  Qk i. For the null position i, the second term Qk i vanishes. Given D i , we model k i drawn from the g th null component aswhere v g and g are scalars. The covariance matrix g PD i P guarantees that k i is a constant vector. For a SNP position i, whose k i is drawn from a non-null component g, we model the distribution of k i asThe extra component g QD i Q adds further variance to k i so that the k i becomes a non-constant vector. The hyper-parameters l g , g , g  will be estimated from the data by pooling information across positions. Under the hierarchical model (2), the marginal distribution of Z i is the mixture of multivariate Gaussians:The posterior distribution of k i jZ i is also the mixture of Gaussians. It can be easily shown thatwhere p g Z i    g f g Z i = fZ i  is the posterior probability that Z i is drawn from component g, and h g k i jZ i  is the posterior distribution if the prior were h g. The structure of the model is illustrated in. With this model, we proceed in three steps to call SNPs. We first estimate the parameters h   g , l g , g , g  by maximizing the marginal likelihood using a modified expectationmaximization (EM) algorithm. Details are given in the next section. We then use the estimated parameters to find the posterior probability that Z i is drawn from the null components of equation (3). Finally, we use the estimated posterior probability to call SNPs. The posterior probability that Z i is drawn from the null components relates to the local false discovery rate (fdr). In statistical testing framework, let H i be the null hypothesis that the position iis non-SNP. The fdr is defined as the posterior probability fdrz  PH i is true jZ i  z. It is related to the commonly used FDR and possesses features that are more attractive than FDR in certain scenarios. See Efron (2007) andfor comprehensive discussions about FDR. The EBM model makes it straightforward to calculate FDR. Specifically,Positions with FDR less than a pre-specified threshold are identified as SNP sites. For SNP sites, we estimate the mean vector k i by its posterior mean:where E g k i jZ i  is the posterior mean under h g k i jZ i . The empirical Bayes estimator shrinks the positional estimate toward the common mean shared across positions. The allele frequency estimate is obtained
Model fitting and parameter estimationWe fit the EBM model using the expectation-conditional maximization (ECM) algorithm (). The ECM algorithm replaces the M-step of the usual EM algorithm with a series of partial maximizations. It is computationally simpler than using the EM algorithm, yet possesses many of the same convergence properties. We first define indicator ig  Ik i is from component g for each position i and treat it as missing data. The log-likelihood for the complete data Z i , ig  is lZ,In the CM step, we sequentially optimize parameters using the expected values of the indicators (for simplicity, we will write ig for E ig jZ). g is updated byig for null components, where PZ i is the projection of Z i on RP. Using the fitted ^ g and ^ l g , we estimate g and g by maximizing the marginal likelihood of Z. The EBM model has two tuning parameters: the number of null components, G 0 , and the number of non-null components, G 1. The tuning parameters can be determined using various model selection criteria, such as Akaike Information Criterion or the Bayesian Information Criterion (). The tuning parameters are not critical for the purpose of fitting distribution function (). In the simulations and real data analysis, we choose G 0  2 and G 1  4. We use two null components to capture the sequencing error distribution and two non-null components to capture SNP signals beyond the sequencing error. We put other two non-null components at the same location of the null components but add g QD i Q to the covariance matrix to allow cross-pool variations. These two non-null components are used to detect rare variants, whose signals are at the same level or lower than the sequencing error but exhibit cross-pool variations. For starting values, we use g  0:498 and g  0:001 for the null and non-null components. We initialize the center l g of the two null components (and two non-null components) at 40% and 80% quantile of the data. The centers of the two remaining non-null components are set to be at the 92.5% and 97.5% quantile of the data. We initialize g and g to be 1. After initialization, the ECM iterations will fine-tune the parameters and reach the final estimate.
RESULTS
Simulations studiesWe simulate synthetic data to evaluate the performance of the EBM model and compare it with other methods. Data areis 10, 25 or 50. We generate 100 datasets under each setting and rank the position based on the posterior probability of being a SNP. Positions with high posterior probability of being drawn from the non-null components in equation (3) are ranked at the top of the list. Then, we assess the quality of ranking by computing the area under the receiver operating characteristic (ROC) curve averaged over the 100 datasets. The ROC curve is the plot of 1-specificity versus sensitivity, which is equivalent to the Type I error rate versus 1-Type II error rate. The area under the curve (AUC) value close to one indicates high sensitivity and high specificity in identifying true SNPs.shows the AUC of the EBM model for a variety of settings. Several observations are noteworthy. First, increasing read depth significantly improves the sensitivity of SNP detection for rare variants with a high sequencing error. The largest improvement of AUC ($19%) by increasing read depth comes from MAF of 0.01 and sequencing error of 0.05. Second, large sample size helps improve sensitivity, particularly in detecting rare variants. This is because with larger sample size, rare variants are more likely to be included in pools. For example, the probability of presence in at least one pool (assuming five pools in total) for a variant with MAF  0.01 is 99.3% if the pool size includes 50 samples. This probability dramatically decreases to 63.3% if the pool size is 10 (i.e. with probability 36.7%, the SNP can never be identified no matter how sensitive the method is). Third, the EBM model is sensitive enough to identify SNPs as long as the read depth is sufficient even in situations where the signal is weaker than the sequencing error. For example, with MAF 0.01 and pool size of 50, the SNP signal (1%) is lower than the sequencing error of 0.05, but the EBM model still achieves AUC of 0.986 under the read depth of 50. The EBM model is sensitive enough to detect rare variants because of two reasons. First, it borrows information from other genomic positions to help estimate the error distribution. Second, it detects the uneven distribution of variant reads across pools when a rare variant is present. Next, we evaluate the false-positive rate of the EBM model, which is controlled by specifying the fdr to be less than a certain threshold. For the data generated above, we call SNPs by setting the threshold fdr 0.001 (0.05 or 0.1). The FDR is estimated by equation (8). For each threshold, the FDR and false-positive rate are well controlled (data not shown). We then generate sequencing data as previously described, except all 1000 positions are non-SNP sites. We use the threshold fdr 0.001 (0.05 or 0.1) to call SNPs.shows the false-positive rate under each threshold, demonstrating that it is effectively controlled. We then compare the efficiency of ranking candidate SNPs by different methods. We focus on comparisons with CRISP and SNVer, since they have been shown to outperform other methods for SNP calling in pooled sequencing (). CRISP uses Fisher's exact test followed by additional filtering steps. The positions are ranked based on the P-values from Fisher's exact test. In contrast, SNVer first computes a P-value based on a binomialbinomial model for a single pool and then uses Simes' method to calculate a pooled P-value for the multiple pools. Positions are ranked by the pooled P-value.shows the AUC comparisons of the three methods. We can see that the EBM model outperforms other methods in every scenario. CRISP has a good sensitivityfor SNP detection when the variant is rare but does less well when the allele frequency becomes less rare or common. This is because the working hypothesis of CRISP (i.e. uneven distribution of variant reads across pools) does not hold well for less rare and common variants. SNVer performs reasonably well when the assumed error rate matches the true sequencing error, but is the least efficient in ranking candidate SNPs when the true sequencing error deviates from the specified error rate. In practice, the sequencing error is unknown and varies across position. Specifying an arbitrary error rate for all positions would be problematic for application of SNVer to real data. Different from the previous methods, the EBM model integrates hypothesis testing and allele frequency estimation in a single procedure: By fitting the hierarchical model (2), we obtain the posterior probability that Z i is drawn from the null components of the prior distribution (3), based on which the position iis declared as SNP or null. Meanwhile, we use the empirical Bayes estimator ^ k i to estimate the minor allele frequency of a SNP i,As an alternative, the naive estimator for MAF of SNP i is ^We compare the accuracy of these two estimators by simulating 1000 positions, among which the first 30 positions are SNPs with allele frequencies ranging from 0.01 to 0.3, each incrementing by 0.01. Estimation accuracy is measured by the total sum of squared errors (SSE) defined as:the two estimators respectively, where p i is the true allele frequency. The SSE averaged over 100 datasets is plotted infor a variety of settings. The EB estimator outperforms the naive estimator in every setting. The improvement is more noticeable when the sample size is small. By pooling information across positions, the EB estimator overcomes the small sample size and improves the allele frequency estimation.), resulting in averaged coverage of 34 per individuals.shows the distribution of coverage per haplotype. We use the EBM model to identify SNPs in the $20 kb sequenced coding region on chromosome 16. Before applying the EBM model, the data were preprocessed by filtering out reads with base calling quality score 510 and mapping quality score 520. Positions with coverage 520 in one or more pools were not included in the analysis. After applying the EBM model, 93 SNPs were identified at the threshold of fdr 0.001. As a comparison, we applied CRISP with the default parameters and identified 75 SNPs. Sixty SNPs were identified by both methods. Fifteen SNPs were identified by CRISP alone, and 33 SNPs were identified by the EBM model alone ().between 0.05 and 0.1 and 23.3% had MAF40.1. We compare with a list of variants on the same set of 100 samples from the HapMap and the 1000 Genomes Projects (HM  1KG dataset). Due to the missing data in the 1000 genomes dataset for three of the pools, the HM  1KG dataset is only a partial list of the variants. Forty-four (73%) of the 60 SNPs are on the list of HM  1KG dataset. For the 16 SNPs identified by both the EBM model and CRISP but not on the list of HM  1KG, we inspect the aligned sequence reads from the pooled data and found that 10 of the 16 sites are strongly supported by the pooled sequence data as SNP sites. Among the 33 SNPs identified by the EBM model but not by CRISP, 97% (32 SNPs) have allele frequencies 40.05 (). The excess variant allele reads strongly suggest these sites are true SNPs. Of note, CRISP failed to detect these SNP sites, which is consistent with the simulations results showing that CRISP is not sufficiently sensitive for detection of less rare and common SNPs. We further inspected the 15 SNPs identified by CRISP but not the EBM model. Fourteen of the SNPs were rare (MAF50.05;), and eight of them had the variant allele present in only one pool. Three of the 15 sites are strongly supported by the alignment data to be true SNPs. The remaining sites were inconclusive based on the alignment data. We then compared the allele frequency estimated by the empirical Bayes shrinkage estimator and the naive estimator. We calculated the total SSE between the estimated allele frequencies with those obtained from 1000 genome data for the overlapping 44 SNPs. The SSEs were 0.102 and 0.185 when using empirical Bayes estimate and the naive estimate, respectively. Correlations of the estimated allele frequencies and the 1000 genome allele frequencies were 0.973 for the empirical Bayes estimate and 0.951 for the naive estimate. The empirical Bayes estimator performs slightly better than the naive estimator.
Real data application
DISCUSSIONSWe have developed an EBM model for SNP calling in the analysis of pooled sequencing data. The EBM model is able to learn the error distribution reliably by borrowing information across pools and positions. Because of the small number of pools, it is necessary to borrow information across positions to infer the error distribution in pooled sequencing.developed an empirical Bayes model to detect SNPs in individual sequencing, but their model is not applicable to pooled sequencing. The proposed EBM model effectively incorporates characteristics of the pooled sequencing data to increase the sensitivity of SNP detection. Simulation studies and real data application have demonstrated the superior performance of the EBM model over other methods. In contrast to previously available methods, such as CRISP, which use P-value as threshold to call SNPs, the EBM model uses fdr as the threshold for SNP calling thereby controlling the false-positive rate. It has been established that the FDR and fdr are more appropriate than P-values for large-scale inference of genomic data (). The concept of fdr was developed byfor the analysis of microarray data. In the context of SNP calling, fdr quantifies the site-specific evidence indicating that each position is a SNP site. The usual FDR, on the other hand, averages over other sites with stronger evidence. Several authors have argued that FDR may result in misleading inferences and advocated the use of fdr in genomic studies (). However, fdr is often more difficult to estimate than FDR. The FDR can be formulated in terms of the cumulative distribution functions, for which the empirical distribution is a consistent and stable estimator. But to estimate fdr, it is necessary to estimate the density of distributions, which requires parametric models or non-parametric smoothing methods (). The EBM approach provides a simple and flexible way to estimate fdr () and effectively controls the false-positive rate. As a comparison, the P-value approach of CRISP has been shown to result in inflated type I errors (). Another advantage of the EBM model is that it integrates the allele frequency estimation in a single procedure with SNP detection. The EBM model estimates allele frequency using an empirical Bayes shrinkage estimator, which shrinks the SNP-specific MAF toward a genome-wide consensus. Statistical properties of the empirical Bayes estimator have been extensively discussed in the literature (). We have shown here that it outperforms the naive estimator for MAF estimation especially when the sample size is small. In NGS, sampling bias is a non-trivial issue. Reads coverage is almost certainly non-uniform across positions. By considering one position at a time, previous methods completely ignore the non-uniform distribution of reads coverage. The EBM model is able to incorporate coverage information in the covariance matrix of equation (2) to reflect the noise level of different positions. Before applying the EBM model, appropriate filtering of sequence reads is necessary. The EBM model uses transformation (1), which requires the coverage to be at least 12 or so (). Positions with read coverage 512 are not suitable fortransformation as the mean and variance formula no longer hold well. It is recommended to discard or manually inspect these poorly covered positions. Reads with low base calling or mapping qualities should also be excluded. It is possible to apply more sophisticated filtering strategies to eliminating systematic error or strand bias, see Rivas et al. (2011) for detailed discussions. The EBM model can be extended in several ways for future work. First, detection of small indels is not supported by our current model. The indels impose a great challenge for NGS. DNA amplification and reads mapping techniques to handle indels are under development. In future work, we may incorporate indels calling in the EBM model. Second, we may extend the EBM framework to include downstream analysis, such as association analysis of casecontrol data. Currently, there is a lack of methods for association analysis for pooled sequencing data. In summary, we have developed an efficient EBM model for SNP calling in pooled sequencing data that is applicable to NGS data generated by various sequencing platforms.
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
G0G1 g1 g h g k i , 3 where each component h g k i   Nl g ,  gi  is a multivariate normal with mean l g and covariance  gi. g are unknown mixture proportions. In the mixture distribution, g  1, 2. .. , G 0 are null components used to capture the sequencing error distribution. The remaining non-null components capture true SNP signals that are beyond the error distribution. For a null position i, we expect its p ij s (i.e. sequencing error) is approximately the same across pools, so k i is a constant vector with equal components: i1  i2      iK. To impose this constraint on the
B.Zhou at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
An EBM model for SNP detection at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
