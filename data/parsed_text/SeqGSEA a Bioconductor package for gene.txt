SeqGSEA is an open-source Bioconductor package for the functional integration of differential expression and splicing analysis in RNA-Seq data. SeqGSEA implements an analysis pipeline, which first computes differential splicing and differential expression scores, followed by integrating them into a per-gene score that quantifies each gene's association with a phenotype of interest, and finally executes gene set enrichment analysis in a cutoff-free manner to achieve biological insights. SeqGSEA accounts for biological variability and determines the statistical significance of gene pathways and networks using subject permutation, and thus requires at least five samples per group. Real applications show that SeqGSEA detects more biologically meaningful gene sets without biases toward long or highly expressed genes. SeqGSEA can be set up to run in parallel to reduce the analysis time. Availability and implementation: The SeqGSEA package with a vi-gnette is available at
INTRODUCTIONBy enabling simultaneous quantification of abnormal expression and aberrant splicing, high-throughput transcriptome sequencing or RNA-Seq is providing unprecedented insight into disease and condition-associated transcriptome alterations. Although these complex patterns of transcriptional activity have a profound influence in the pathophysiology of disease, we need tools that are capable of integrating their biological influences to determine their functional significance. Functional annotation of independently differentially expressed genes and their pathway analysis is ideal for investigating highly controlled interventions in clonal or syngeneic systems with no underlying heterogeneity. However, when comparing conditions in outbred populations, particularly for complex phenotypes or diseases, biologically significant effects are often distributed in pathways or networks such that the influence of individual genes is redundant and untraceable.Arguably the best alternative in thisituation is to consider related gene sets using gene set enrichment analysis (GSEA) to identify disturbances at the pathway and network levels that have biologically associated function (). Although there are existing tools for performing GSEA on conventional gene expression data, there are currently no tools for implementing GSEA with RNA-Seq data that can efficiently incorporate gene expression and alternative splicing (AS). For example, GOSeq () cannot account for AS in its enrichment analysis. In higher primates, the majority of genes undergo AS; especially, in humans more than 90% genes are alternatively spliced (). Recent evidence suggests that splicing and transcription largely take place almost simultaneously (), and both result in the alteration of mRNA composition, stability, localization and translation. In this Applications Note, we introduce a new software system for implementing a recently proposed enrichment analysis approach for RNA-Seq data, combining both overall differential expression (DE) and differential splicing (DS) (). We also demonstrate the utility of this approachdesignated SeqGSEA, to maximize the yield of biological insight from RNA-Seq data without any biases toward long or highly expressed genes, in a number of data sets.
IMPLEMENTATIONIn well-annotated organisms, such as the human and mouse, the first step of RNA-Seq analysis is usually to map short reads to the reference genome with splice-tolerant mappers, such as Tophat, to yield BAM/ SAM-formatted outputs. Given a set of gene annotation, SeqGSEA uses a Python script based on the HTSeq package (http://www-huber. embl.de/users/anders/HTSeq) to count reads mapped to individual exons of each gene. Based on the read counts, SeqGSEA uses the DSGseq method () to quantify transcript-level differences resulting from AS between samples of different phenotypes. Similarly, based on read counts summed up for each gene, SeqGSEA imports DESeq method () to quantify overall expression differences for each gene. As the statistical metrics given by DSGseq and DESeq for differential expression and differential splicing are not necessarily comparable, SeqGSEA uses a normalization step to aid integration. The normalization is performed against background metric distributions achieved by a number (say, 1000) of permutated datasets. We call the normalized metrics the DE and DS scores. To integrate DE and DS scores, two strategies can be selected, including a weighted linear *To whom correspondence should be addressed. combination and a rank-based integration. The rank-based strategy has a tendency to generate slightly more overrepresented gene sets than the linear combination. (See Supplementary Note S1 for more details on DE and DS integration.) We term the integrated scores as gene scores, representing each gene's association with the phenotype studied. Finally, SeqGSEA uses the state-of-the-art GSEA method () for functional enrichment analysis. The GSEA method then computes normalized enrichment scores (NESs) for each gene set against the permutation background, and calls statistical significance based on the observed NESs compared with those on the permutated datasets. SeqGSEA ignores the direction of gene expression changes in its analysis, as the significance of direction in DS is ambiguous, and the significance of direction in DE can also be variable, as interacting gene pairs are often inversely regulated. An overview of SeqGSEA's analysis workflow is shown in Supplementary. The SeqGSEA package includes a built-in capacity to generate welldesigned figures for users to easily present the results of analysis, and well-formatted output text files to archive analysis outcomes with relevant information. For example, Supplementaryshows the distribution of NESs compared with those on the permutated datasets, from which it is clear that a few gene sets are significantly overrepresented in the studied dataset. Another example in Supplementaryshows the relationship between NESs and P-values, false discovery rates and family-wise error rates, providing a quick and direct overview of SeqGSEA's analysis results. For each significantly overrepresented gene set, functions are also available to generate detailed gene set-specific plots (Supplementary). SeqGSEA is implemented in R, and has been deposited in Bioconductor. With a regular update cycle, SeqGSEA will keep updating by taking users' comments and implementing new functions that make the package more comprehensive. To reduce analysis running time, SeqGSEA was made multi-thread compatible so that users can easily run SeqGSEA with a specified number of multiple cores.
APPLICATION EXAMPLESWe applied the SeqGSEA package to a prostate cancer RNASeq dataset, downloaded from the NCBI SRA database with accession number SRP002628. The data were generated from 20 prostate cancer samples and 10 matched benign samples by Illumina GAII, 22.2 million reads on average per sample. We mapped the reads to the human reference genome using Tophat, resulting in BAM files. Read counts at the exon level were computed using Python scripts based on HTSeq released with the package. DE and DS analyses were then conducted, followed by DE and DS score integration and gene set analysis with the GSEA algorithm. The analysis scripts are exemplified in the package vignette (released with the Bioconductor package; section ''An analysis example'') and provided in Supplementary Note S2 with corresponding mathematical explanation. With linear combination of DE and DS equally contributed, SeqGSEA resulted in 16 overrepresented gene sets at false discovery rate 0.05 (Supplementary). Comparison with alternative methods. We have compared SeqGSEA with alternative analysis pipelines, which can only account for DE and DS separately, on the prostate cancer dataset as well as two schizophrenia transcriptome sequencing datasets and shown that more gene sets with high biological relevancy can be detected by SeqGSEA (). A brief summary of this comparison study is provided in Supplementary Note S3. Moreover, while the existing GOSeq strategy compensates for biased selection of long and highly expressed genes (), we have not observed any bias in SeqGSEA's gene scores against gene length or read counts (Supplementary Note S4). Typical running time. We have recorded the running time with the cancer data on the MsigDB collection 5 (c5, 1454 gene sets). Using eight cores of Intel Sandy Bridge E5-2600 CPUs, it took 516 h to finish. If a gene set collection contains more gene sets, it takes slightly more time for the whole procedure. We summarized running time of the cancer data and two schizophrenia datasets across two gene set collections in Supplementary Table S1.
The Author 2014. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
DISCUSSION SeqGSEA provides an RNA-Seq data analysis pipeline for functional integration of DE and DS, gathering multiple analysis steps together into a Bioconductor package, which enables bioinformaticians and biologists to interpret their own RNA-Seq data into biological insight, quickly and easily. The advantage of SeqGSEA over existing functional analysis pipelines includes (i) taking into account sequencing bias and biological variation with negative binomial models in DESeq and DSGseq, (ii) efficiently accounting of both differential expression and splicing, (iii) permutation-based gene scores securing enrichment analysis without bias toward gene sets of long and highly expressed genes and (iv) cutoff-free property that facilitates detection of subtle accumulating alteration in gene activity. This package can also be used for DE-or DS-only GSEA by setting the weighting parameter in DE/DS score combination to 1 or 0. DE-only GSEA is particularly useful for organisms with few or none AS, such as prokaryotes. Therefore, SeqGSEA can be applied to any organisms and not just higher eukaryotes. SeqGSEA performs statistical significance assessment based on subject permutation, and thus requires a moderate samples size. Greater than five samples per group meets the least requirement for running SeqGSEA. More importantly, enough sample size is critical to secure accurate analysis results because of the sample heterogeneity, particularly when studying human samples, which are generally subject to much larger biological variation than cell lines or model organisms (Oberg et al., 2012). Funding: This study was supported by the Schizophrenia Research Institute, utilizing funding from NSW Health and the Henderson Foundation; X.W. is supported by a National Health and Medical Research Council project grant (631057) and M.C. is supported by an M.C. Ainsworth Research Fellowship in Epigenetics. Computational infrastructure used in this work was provided by Intersect Australia Ltd. Conflict of Interest: none declared.
X.Wang and M.J.Cairns at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
SeqGSEA at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
