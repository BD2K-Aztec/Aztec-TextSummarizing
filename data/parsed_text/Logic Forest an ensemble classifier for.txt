Motivation: Highly sensitive and specific screening tools may reduce disease-related mortality by enabling physicians to diagnose diseases in asymptomatic patients or at-risk individuals. Diagnostic tests based on multiple biomarkers may achieve the needed sensitivity and specificity to realize this clinical gain. Results: Logic regression, a multivariable regression method predicting an outcome using logical combinations of binary predictors, yields interpretable models of the complex interactions in biologic systems. However, its performance degrades in noisy data. We extend logic regression for classification to an ensemble of logic trees (Logic Forest, LF). We conduct simulation studies comparing the ability of logic regression and LF to identify variable interactions predictive of disease status. Our findings indicate LF is superior to logic regression for identifying important predictors. We apply our method to single nucleotide polymorphism data to determine associations of genetic and health factors with periodontal disease. Availability: LF code is publicly available on CRAN, http://cran.r-project.org/.
INTRODUCTIONDiseases often stem from complex genegene and geneenvironment interactions and single biomarkers typically perform poorly with respect to sensitivity and specificity (Alvarez).note that common statistical methods for screening high-dimensional biomarker data focus on only main effects and do not capture interactions that lead to disease. Failure to recognize interactions among genes leads to the inability to replicate study results in human populations (). Many authors suggest that a panel of biomarkers rather than a single marker has the potential to provide improvements in sensitivity and specificity required to replace traditional diagnosis (see, e.g.). Diseases for which panels of markers demonstrate improved sensitivity and specificity over single markers include prostate, * To whom correspondence should be addressed. ovarian and bladder cancer and heart disease (). Non-parametric tree-based methods are easily interpretable and have flexibility to identify relationships among predictor variables (). Logic regression (LR;) is a tree-based method capable of modeling a binary, continuous or survival response with higher order interactions among binary predictors. In this article, we focus on classification of a binary response. LR generates classification rules by constructing Boolean ('and'= , 'or'= , and 'not'= !) combinations of binary predictors for classification of a binary outcome. An LR model is represented as a tree with connecting nodes as the logical operators and terminal nodes (called leaves) as the predictors. LR has been used in the development of screening and diagnostic tools for several diseases and has shown modest improvements in sensitivity and specificity compared with traditional approaches such as logistic regression and CART (). LR can be unstable when data are noisy. In the context of identifying interacting genetic loci, performance was poor for frequently occurring interactions only weakly associated with the response (). A study designed to identify regulatory motifs confirmed that increasing noise in data severely limited the ability of LR to correctly identify the true model in simulated data (). Ensemble extensions of tree-based methods demonstrate improved predictive accuracy (). Two ensemble adaptations of LR are available. Monte Carlo LR (MCLR) builds a series of models from the training dataset using Monte Carlo methods and identifies groups of predictors that co-occur across all models (). However, the relationship among predictors (,  and !) is unclear. LogicFS, a bagging version of LR, constructs an ensemble by drawing repeated bootstrap samples and building LR models from each (). In contrast to MCLR, logicFS identifies explicit predictor interactions [referred to as prime implicants (. Additionally, logicFS provides a measure of variable interaction importance. In Section 2, we present a new ensemble of logic trees approach called Logic Forest (LF), and introduce a new permutation-based measure of predictor importance. We also develop the idea of subset matching as an additional means of identifying important interactions. We present a simulation study in Section 3 comparing the performance of LR and logicFS with LF considering data with noise in the predictors, latent predictors and varying true modelcomplexity. We apply LF to periodontal disease data in Section 4 and discuss the results of our simulation studies in Section 5.
DEFINITIONS AND NOTATION
LFGiven observed data W = y,x recorded on n subjects consisting of a binary response y = y 1 ,...,y n and p binary predictors,...,n, LR constructs a tree T describingBoolean combinations of predictors that best classify the response. For example, LR might produce the expressionwe calculate the misclassification rate as:Associated with tree b in the forest is an out-of-bag dataset, OOB (T b ), comprising observations not included in the bootstrap sample used to construct T b. If test data are not available, we can use OOB (T b ) to obtain an unbiased estimate of the forest's misclassification rate. Let W i = (y i ,x i )  W, and let O (W i ,T b ) = I (W i  OOB (T b ) ) indicate the i-th observation's membership in OOB (T b ). The LF OOB prediction is
Variable importance measuresLet X be a predictor or, more generally, a PI occurring in the tree. The importance of X in an LR model, VIMP.LR X , is determined by X's presence or absence in a fitted tree, T , providing a crude assessment of association with response. An advantage of LF over LR is the availability of many trees for identifying important predictors and PIs. Our LF importance measure for predictor X j ,j = 1,...,p, is based on the misclassification rates for each tree in the forest. Denote the OOB misclassification rate for T b byValues range between 1 and 1, with positive values suggesting a positive association between response, Y, and predictor X j. More generally, (6) can be computed with X j being a PI. An algorithm similar to LF, called logicFS, was introduced by. Unlike logicFS, LF randomly selects the maximum size when building each tree in the ensemble. Although tree size can vary in logicFS, flexibility in the upper bound for the maximum number of leaves in a tree enhances the probability that the forest will discover smaller PIs. Additionally, Schwender and Ickstadt provide a different measure of PI importance obtained by replacing the permutation step in (6) with addition or removal of the PI in tree T b , which we will refer to as VIMP.FS ().
Subset matchingLet F be the set of unique PIs identified in a LF consisting of B trees. When a given PI, P for example, is an element of F, we say P is an 'exact match'. We say P is a 'subset match' for a forest if P is an exact match or P Q is an element of F for some PI, Q. For example, LF might identify PI 1 =X 4 X 5 and PI 2 =X 4 X 5 X 6. The PI X 4 X 5 is an exact match to PI 1 and a subset match to PI 2. The concept of subset matching enables us to fully detect contributions of PIs to the fitted trees in LF W,B . Also, if a PI has multiple subset matches to increasingly larger PIs in F, then that PI is said to persist.
SIMULATIONSWe compare the performance of LR and logicFS with LF using eight simulation studies. Each simulation is characterized by an underlying logical relation L and predictor noise level. A training dataset W = (y,x) used to construct LRmodels, FS W,B , is generated by simulating error-free Bernoulli predictors z and obtaining the observed response y = L(z). Observed predictors x are constructed such that x j = 1z j with probability  and otherwise x j = z j where  is a prespecified noise level. We focus on the effects of predictor noise, the complexity of L and an omitted predictor, the last motivated by our experience that complexity of biological networks prohibits observation of all related variables.(i) mean model error rate, defined as the misclassification rate of the fitted model for the test dataset (2); (ii) identification of PIs in L according to VIMP.LR and inclusion in K for LF; and (iii) identification of PIs in L according to subset matching as described in Section 2.3 for LR and according to subset matching to K for LF and logicFS. We use the LogicReg package () in R v. 2.7.1 (R Development Core Team, 2009) with simulated annealing optimization to fit all LR models. Maximum model size for LR models is selected using the cross-validation procedure suggested by. Cross-validation improves LR model performance by reducing the likelihood of over-fitting. LogicFS models are constructed using the logicFS package () available at www.bioconductor.org. The LF algorithm (Section 2.1) is used to generate all ensemble models. LogicFS and LF models include B = 100 logic regression trees. The same starting and ending annealing temperatures are selected for LR, logicFS and LF. The starting temperature of 2 is selected such that 90% of 'new' models are accepted. The final temperature of 1 is set to achieve a score where >5% of new models are accepted. The cooling schedule is set so that 50 000 iterations are required to get from start to end temperature. Increasing the number of iterations to 250 000 did not affect our findings. With these settings, an ensemble is constructed in less than a minute on a Windows 2.26 GHz machine.
Predictor noiseCases 1 and 2 () examine the effects of noisy predictors on LR, logicFS and LF performance. The results for the mean model error rates for samples sizes 25, 200 and 1000 are shown in. Model error rates are similar at all sample sizes for all three methods for Cases 1 and 2.shows the proportion of times each method recovered the PI X 4 X 5 using exact and subset matching by sample size for each noise level. Error bars in the figure represent 95% confidence intervals for the proportions.shows that LF is significantly more likely to exactly identify the PI X 4 X 5 than LR for sample sizes n = 25 to 100 in data with 5% noise and for n = 25 to 300 in data with 15% noise. The performance of LF and logicFS is similar in data with 5% noise although LF more frequently exactly identifies the PIs forsample sizes n  50. LF exactly identifies X 4 X 5 significantly more frequently than logicFS in data with 15% noise for sample sizes from n = 35 to 200. The results for PI X 5 X 11 were similar to those of X 4 X 5 (results not shown). The performance of the three methods does not improve significantly with subset matching in data with 5% noise. However, in data with 15% noise, the ability of all three methods is enhanced under subset matching. Although the performance of LR and logicFS is closer to LF when subset matching is used, LF still identifies the PIs more frequently than logic FS for 50  n  150 and more frequently that LR for 25  n  300. Both LR and logicFS identify the relationship between X 4 and X 5 and between X 5 and X 11 , but the tendency is to add spurious components to the PI. We also consider a null scenario in which there is no association between predictors and the response. The predictors follow the distribution for Cases 1 and 2 () and the response is L iid
Model complexityCases 36 () examine the effect of model complexity on the ability of each method to correctly identify PIs truly associated with the response and on the error rate of the fitted model. Cases 3 and 4 investigate a simple logic expression, L 1 , describing the response using two PIs of size 2. Cases 5 and 6 investigate a more complex model, L 2 , containing three PIs, two of Size 4 and one of Size 5. These models also have a lower probability of an observed response value of 1 relative to Cases 1 and 2, which has been shown to reduce the ability of LR to identify interactions known to be important ().of LF is significantly smaller than both LR and logic for n = 25 in Cases 3 through 5. However, logicFS has smaller mean model error rate than LF and LR in Cases 3 and 5 for n  200. The difference in mean model error rates for logicFS and LF is significant for n  500 for Case 3 and for n  300 for Case 5. From, for data with a simple underlying model L 1 and 5% noise in the predictors LF is significantly more likely to exactly identify the true PI, X 4 X 5 , than LR and logicFS for n  35 and for 35  n  500, respectively. The results for recovery of X 5 X 11 are similar in data with 5% predictor noise. In data with 15% noise, LR
Page: 2187 21832189
Logic Forest
and logicFS exactly identify these PIs X 4 X 5 and X 5 X11 in <5% of models at all sample sizes. However, LF exactly identifies the PIs in >60% of all models once n = 150 (see, Section 1 of the Supplementary Material). A comparison of the performance of both methods for Cases 1 and 2 versus Cases 3 and 4, which consider the same simple model but with P, respectively, indicate that all three methods are less likely to recover the true PIs if there is reduced probability of a response being 1 (Figs 1 and 2). In the complex model, L 2 , LF and logicFS exactly identify the two PIs of Size 4 with greater frequency than LR at sample sizes n  150 for both noise levels. LF and logicFS identify all PIs in L 2 equally well with the exception of the two PIs of Size 4 at n = 75 and the largest PI at n = 1000 where logicFS exactly identifies these PIs more frequently than LF. All three methods have difficulty in identifying the largest PI in L 2 (). This is likely due to the fact that the largest PI explains only a small proportion of variation in the response. In data with 15% noise, the proportion of times the two Size 4 PIs are recovered is greatly reduced for all three methods. However, LF exactly identifies the two Size 4 PIs more frequently than LR for n  150 and than logicFS for n  300. LF achieves a maximum of 23% of models containing exact matches compared with 15% for logicFS and 2% for LR. In data with 15% noise, none of the methods is able to recover the largest PI exactly. LR, logicFS and LF all demonstrate improved performance for true underlying model L 1 when evaluated by subset matching. However, LF identifies the two PIs from model L 1 more often than LR and logicFS for sample sizes between n = 75 and n = 200 in data with 5% noise and between n = 75 and n = 300 for data with 15% noise. Use of subset matching for identifying PIs in the complex model L 2 only significantly improves the performance of the three methods in data with 15% predictor noise (see, Section 1 in the Supplementary Material). LogicFS and LF both identify the PIs of Size 4 more frequently than LR as subset matches for n  300. LogicFS identifies these two PIs more frequently as subset matches than LF for n  750. Even using subset matching, all three methods have difficulty identifying the Size 5 PI in the complex model at both noise levels.
Latent predictorsIn Cases 7 and 8 (), we consider models in which a latent variable directly affects one or more PIs explanatory of the response. The true response for Case 7, L 3 , has two PIs but only Z 5 Z 11 Z 21 contains the latent predictor Z 21. In Case 8, the response, L 4 , has similar PIs and both PIs are affected by the latent predictor. Corresponding to the latency of Z 21 , predictor X 21 is not observed and therefore not available when constructing the models; thus we cannot identify the true PIs. For these cases, we determine the proportion of times each method identifies X 4 X 5 and X 5 X 11 , the observed components of the true PIs. The mean model error rate was not statistically different at a majority of sample sizes (results not shown). The only exception occurs at n = 25 where LF and logicFS have significantly smaller mean error rates than LR.shows the proportion of times each method recovers the two partial PIs by sample size for L 3. The ability of each method to recover the partial PIs X 4 X 5 or X 5 X 11 depends on the model. For L 3 , where only the relationshipbetween X 5 and X 11 is strongly affected by the absence of X 21 , X 4 X 5 is exactly recovered in 100% of models for n > 150 for all three methods, while exact recovery of X 5 X 11 occurs much less frequently (). LF is more adept at exactly recovering X 5 X 11 than LR and logicFS at all sample sizes. LR and logicFS rarely recover the exact PI X 5 X 11 for data generated under L 3 (). In L 4 , LR and logicFS rarely exactly recover either PI even with increasing sample size. However, LF is able to exactly identify both PIs in L 4 in up to 60% of models (see, Section 2 in the Supplementary Material). For X 5 X 11 for L 3 and for both X 4 X 5 and X 5 X 11 for L 4 , the performance of LR and logicFS improves greatly with subset matching. Despite improvement in the performance of LR with subset matching, LF performs significantly better than LR in both models and for all sample sizes n  35 (). However, logicFS identifies the PI X 5 X 11 in L 3 significantly more frequently as subset matches than LF for sample sizes ranging between n = 75 and n = 200. LogicFS also identifies both PIs in L 4 as subset matches more frequently than LF for n  500.
PERIODONTAL DISEASE IN AFRICAN AMERICANS WITH DIABETESWe examine the association of genetic and health factors with prevalence of generalized adult periodontitis using data from a study conducted at the Center for Oral Health Research at the Medical University of South Carolina. Here, generalized adult periodontitis is defined as 3 mm clinical attachment loss and >30% of sites affected. These data are drawn from 244 African American adults with diabetes. Information on each subject includes the binary health indicators total cholesterol (>200 mg/dl),HDL(> 40mg/dl), triglycerides (>150mg/dl), C-reactive protein levels (>1mg/l), HbA1c levels (>7%), smoking status (current versus former and never, former versus current and never) and genotype data for nine single nucleotide polymorphisms (SNPs) believed to play a role in inflammation and/or bone resorption. Among the 244 participants in the study, 95 have generalized adult periodontitis. Seven of the SNPs are coded by two dummy variables for the LF analysis. The first dummy variable takes value 1 if the subject has a SNP genotype with at least one copy of the minor allele (dominant effect of the minor allele) and the second takes value 1 if the subject has two copies of the minor allele (recessive effect of the minor allele). This coding allows for consideration of both dominant andrecessive genetic effects in the model. The remaining two SNPs for which no subjects have two copies of the minor allele are coded for the dominant genetic effect only. The final dataset includes 23 binary predictors composed of these 16 SNP dummy variables and seven health indicators. Two LF models, each with B = 100 trees, are constructed from the data. The first LF model includes all SNPs and health indicators as predictors. The second model is constructed with only the SNPs as predictors. The top five PIs for both models, as determined by VIMP.LF magnitude, are shown in. VIMP.LF scores are normalized so the largest is 1. The most important single predictor identified by the models is the recessive genetic effect for the IL1 889 minor allele (IL1A1.22). Previous studies suggest that the minor allele of IL-1 889 is associated with advanced periodontitis, though these studies considered only the dominant genetic effect (). Also two PIs selected among the top five by VIMP.LF magnitude appear in both models: (i) IL1B.12  IL1A1.22 and (ii) IL1A1.22  !MMP3.12 (). IL1A1.22 represents the recessive genetic effect for the IL-1 889 minor allele, IL1B.12 represents the dominant genetic effect for the IL-1 +3954 minor allele and !MMP3.12 represents the recessive genetic effect for the MMP3 major allele. PI(a), IL1B.12  IL1A1.22, suggests an association consistent with previous reports (). The recessive genetic effect for the MMP3 minor allele is implicated in chronic periodontitis in a Brazilian population (), but the interaction described by PI(b) has not been noted previously.
CONCLUSIONSLR has the ability to model complex interactions such as those that might describe a disease state. To improve identification of important PIs, Schwender and Ickstadt (2008) presented a bagged version of LR called logicFS. Unlike their approach, our method randomly selects a maximum size when building each tree in the ensemble, thereby enhancing the probability that the forest will discover smaller PIs. We also introduce a permutation measure to quantify PI importance. Additionally, we present the notion of subset matching to enhance sensitivity to PI contributions. We extend simulations in previous studies evaluating the performance of LR, logicFS and our ensemble of LR trees, LF, by including larger sample sizes, noise in the predictors and smaller probabilities of the response variable taking value 1. Our results show that LF and logicFS are better able identify important PIs than LR. LF also demonstrates improved ability to recover PIs relative to logicFS at smaller sample sizes in a majority of the simulation scenarios. We also show that forced inclusion of smaller trees in the forest is beneficial for PI identification, particularly in data with latent variables or noisy predictors. Using the permutation-based measure of variable importance, LF is more adept at identifying informative PIs in noisy data, in data with a latent variable and in more complex true models than LR and logicFS. The greatest improvement from LF occurs in scenarios where PIs are smaller and more weakly associated with a response or in situations where there is failure to observe a predictor truly associated with the response. LF also exhibits greater improvement relative to LR as sample size increases, while the largest improvements in performance of LF relative to logicFS occurs at smaller sample sizes (35  n  200). The main exception occurs for data following a complex underlying model where the performance of LF and logicFS is similar for recovery of the three PIs in L 2 (). LR, logicFS and LF all demonstrate limited ability to recover large PIs weakly associated with the outcome in the presence of smaller PIs with stronger associations. We also introduce the idea of subset matching. If a PI persists in increasingly larger PIs, then that PI may represent a true association. For example, discovery of the PIs P, P Q 1 and P Q 2 Q 3 suggests a true association of the PI P with the response. In LF, as opposed to LR, we have the richness of the forest in which to evaluate this persistence of predictors and PIs. Especially in a latent variable setting, where not all components of a predictive PI are observed, persistence throughout the forest facilitates identification of the observed components of that PI. LF, LR and logicFS were also compared with Random Forest (RF) and MCLR. The mean model error rate for RF was larger than all three methods for a majority of sample sizes for simulation Cases 1, 2, 3, 5 and 7 and comparable with LF for Cases 4 and 8. RF is designed to identify important individual predictors from among all predictors in the data and concerning identification of individual predictors, RF performed comparably with LF. However, RF provides no direct mechanism for quantifying associations among predictor interactions and response. MCLR is designed to identify predictors that co-occur with the greatest frequency. MCLR identified predictor combinations from true PIs in <5% of all models for all simulation scenarios (results are not shown). The simulations presented in this article are by no means an exhaustive study of all scenarios one might encounter in biologic data. However, this study provides insight into the effectiveness of ensemble methods, LF in particular, in improving the identification of PIs in scenarios likely in biological studies. LF is not designed to handle data with a larger number of predictors than observations. Based on simulations examining the performance of LF, data should have at least twice as many observations as predictors for the best performance. The methods and measures presented in this study were restricted to classification trees. LR has the ability to build trees as predictors in linear and logistic regression models by altering the scoring functions used in constructing the LR model (sums of squares and deviance, respectively). Further studies are necessary to assess the performance of LF with such alternative scoring functions.
The Author 2010. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oxfordjournals.org 2183 at :: on August 31, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
at :: on August 31, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
