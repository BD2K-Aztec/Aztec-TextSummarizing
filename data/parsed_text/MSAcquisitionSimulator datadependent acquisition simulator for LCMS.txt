Data-dependent acquisition (DDA) is the most common method used to control the acquisition process of shotgun proteomics experiments. While novel DDA approaches have been proposed, their evaluation is made difficult by the need of programmatic control of a mass spectrometer. An alternative is in silico analysis, for which suitable software has been unavailable. To meet this need, we have developed MSAcquisitionSimulator—a collection of C þþ programs for simulating ground truth LC-MS data and the subsequent application of custom DDA algorithms. It provides an opportunity for researchers to test, refine and evaluate novel DDA algorithms prior to implementation on a mass spectrometer. Availability and implementation: The software is freely available from its Github repository http:// www.github.com/DennisGoldfarb/MSAcquisitionSimulator/ which contains further documentation and usage instructions.
IntroductionMass spectrometry is an analytical technique used in proteomics to identify and quantify proteins. Many of its applications share the underlying goal of uncovering the full protein complement in a biological sample. However, for complex samples this is rarely achieved partly because the number of ion populations exceeds that which contemporary instruments can individually target for sequence analysis with a tandem mass spectrum scan (MS/MS) (). Acquisition algorithms are necessary to control the data acquisition process and manage the limited scan speed. Data-dependent acquisition (DDA) constitutes a major class of data acquisition methods. DDA methods perform a precursor scan to determine the mass-to-charge ratio (m/z) and abundance of ions currently entering the mass spectrometer, followed by sequence determining MS/MS scans on ions from a subset of detected peaks. The standard DDA algorithm, TopN, selects ions for MS/MS scans that contributed to peaks of greatest signal intensity from the latest precursor scan. Several other approaches, as well as adjustments to TopN, have been proposed in order to increase peptide and protein identifications (). However, TopN continues to be the dominant choice for acquisition control despite its bias toward abundant proteins and relatively poor reproducibility. Currently, evaluation of novel acquisition strategies requires access to both a mass spectrometer and its application programming interface (API). Unfortunately, few instrument vendors provide an API, and therefore the pool of researchers with the necessary tools to explore this field is extremely limited. An alternative is to evaluate). However, the size of the simulations is limited due to speed, memory and/or disk space requirements. Most importantly, the simulated MS/MS spectra lead to nearly perfect peptide-spectrummatches (PSMs) when analyzed with existing database search algorithms. The reasons for this include the absence of co-fragmentation from neighboring ions within an isolation window, the difficulty of predicting fragmentation patterns, and potentially other not yet understood phenomena. This limitation makes evaluating any acquisition strategy impractical as the metrics for success are based on the number of confident peptide and protein identifications. Here, we present an acquisition simulator that produces PSMs with realistic peptide sequence and probability assignments for DDA strategies by foregoing fragmentation simulation and instead directly generating PSMs based on the precursor ion fractions of MS/MS scans. It builds upon previous work on LC-MS simulations and scales to larger datasets due to probabilistic models of ion generation and subsequent pruning of rare ions. This allows for an increased number of proteins, peptides and post-translational modifications that can be simulated.
MethodsMSAcquisitionSimulator consists of three standalone command-line programs. The first, FASTASampler, assists users in creating a FASTA file containing the proteins to be included in the simulation. Users select a protein FASTA file, the distribution of protein abundance and the number of proteins to be sampled. The output contains a random subset of proteins with each header appended with a '#' followed by the protein's abundance. Next, GroundTruthSimulator uses the previously created FASTA file and a configuration file containing simulation parameters to simulate digestion, residue modifications, retention time, chromatographic elution profiles, ionization efficiency and charge and isotope distributions. It outputs the tab delimited ground truth data on the generated ions, which will be used for testing acquisition algorithms. In contrast to previous simulators, there are no limits on missed cleavages, enzymatic termini or dynamic modifications. A probabilistic approach is taken instead and rare peptides below a user-defined threshold are efficiently pruned. Details on the probability calculations are in the Supplementary methods. Finally, the AcquisitionSimulator program takes as input the previously generated ground truth file and another configuration file. This program simulates a user-defined DDA algorithm on the ground truth data. It models ion accumulation, precursor scan spectra, scan time durations and database search PSMs (Supplementary). Currently, MS/MS fragmentation spectra are not simulated. Instead, the PSMs are generated by sampling from the list of precursors isolated in an MS/MS scan and candidate peptides from a database search. This approach leads to true positives, false positives and reverse decoy matches similar to real experiments (Supplementary Figs. S2S4 ). Ion accumulation is simulated by numerically integrating an ion's elution profile. Ion transmission rates are not modeled and are assumed to be 100%. The elapsed time for a scan is equal to the scan overhead time plus the larger of either the injection time or the transient time. This models the scan time for a QExactive-like instrument. The output includes an mzML file and a PSM graph file, which is used as input for the Fido protein inference algorithm (). Speed and memory usage comparisons with existing simulation software are provided in Supplementary.
Case studyTo demonstrate the utility of MSAcquisitionSimulator, we evaluated three simple DDA algorithmsTopN, RandomN and WeightedN. TopN selects the most abundant precursor peaks for MS/MS scans, RandomN samples from a uniform random distribution of the observed peaks and WeightedN samples from a random distribution weighted by observed peak intensity. Dynamic exclusion was enabled, and precursor scans were de-isotoped prior to MS/MS selection decisions. FASTASampler was executed on the human proteome provided by UniProtKB using a lognormal abundance distribution and 50% of the proteins, resulting in 45 809 protein sequences. Default configuration files were used with both GroundTruthSimulator and AcquisitionSimulator. TopN resulted in the greatest number of confident protein and peptide identifications, closely followed by WeightedN, and RandomN provided far fewer protein identifications (). RandomN's poor performance stemmed from the challenges in targeting low abundant ions. The wide MS/MS isolation window of 2 m/z captured neighboring abundant ions and created spectra dominated by peptides whose monoisotopic mass fell outside the small precursor mass tolerance used to simulate the database search. In addition, fewer scans were performed due to increased injection time.
ConclusionDDA simulation will assist in the development and assessment of novel methods. The next generation of algorithms will likely further integrate data generation with data analysis, such as real-time peptide sequencing and protein inference. They may also become more goal-oriented, seeking to identify subsets of proteins, specific modifications or to improve quantification. Their sophistication may also come at a computational cost too great for their implementation on contemporary mass spectrometers. For such a scenario, MSAcquisitionSimulator will be a great tool for their evaluation.
FundingThis. Distribution of protein probabilities using various DDA algorithms on simulated data. Fido was used for protein inference with parameters alpha  0.1, beta  0.01 and gamma  0.5
TopN
RandomN
WeightedN
at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
D.Goldfarb et al. at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
