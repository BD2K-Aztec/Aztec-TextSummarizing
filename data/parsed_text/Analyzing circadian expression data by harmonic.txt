Motivation: Circadian rhythms are prevalent in most organisms. Identification of circadian-regulated genes is a crucial step in discovering underlying pathways and processes that are clock-controlled. Such genes are largely detected by searching periodic patterns in microarray data. However, temporal gene expression profiles usually have a short time-series with low sampling frequency and high levels of noise. This makes circadian rhythmic analysis of temporal microarray data very challenging. Results: We propose an algorithm named ARSER, which combines time domain and frequency domain analysis for extracting and characterizing rhythmic expression profiles from temporal microarray data. ARSER employs autoregressive spectral estimation to predict an expression profile's periodicity from the frequency spectrum and then models the rhythmic patterns by using a harmonic regression model to fit the time-series. ARSER describes the rhythmic patterns by four parameters: period, phase, amplitude and mean level, and measures the multiple testing significance by false discovery rate q-value. When tested on well defined periodic and non-periodic short time-series data, ARSER was superior to two existing and widely-used methods, COSOPT and Fisher's G-test, during identification of sinusoidal and non-sinusoidal periodic patterns in short, noisy and non-stationary time-series. Finally, analysis of Arabidopsis microarray data using ARSER led to identification of a novel set of previously undetected non-sinusoidal periodic transcripts, which may lead to new insights into molecular mechanisms of circadian rhythms. Availability: ARSER is implemented by Python and R. All source codes are available from http://
INTRODUCTIONCircadian rhythm is one of the most well-studied periodic processes in living organisms. DNA microarray technologies have often been applied in circadian rhythm studies (). Thus, we can monitor the mRNA expression of the whole-genome level, which is an effective way to simultaneously identify many hundreds or thousands of periodic transcripts. The matter to be addressed is which genes are rhythmically expressed based on their gene expression profiles. This can be classified as a periodicity identification problem. However, there are computational challenges when dealing with this issue: sparse determination of sampling rate, and short periods of data collection for microarray experiments (). Circadian microarray experiments are usually designed to collect data every 4 h over a course of 48 h, generating expression profiles with 12 or 13 time-points (Yamada and Ueda, * To whom correspondence should be addressed.
2007). There are two main factors that limit the number of data points that can be feasibly obtained: budget constraints and dampening of the circadian rhythm (). Such short timeseries data render many methods of classical time-series analysis inappropriate, since they generally require much larger samples to generate statistically significant results. A variety of algorithms have been developed and applied to microarray time-series analysis;indicated that the existing technologies fall into two major categories: time-domain and frequency-domain analyses. Typical time-domain methods rely on sinusoid-based pattern matching technology, while frequencydomain methods are based on spectral analysis methods. Of the time-domain methods, COSOPT () is a well-known algorithm frequently used to analyze circadian microarray data in Arabidopsis (), Drosophila () and mammalian systems (). COSOPT measures the goodness-of-fit between experimental data and a series of cosine curves of varying phases and period lengths. The advantages of pattern-matching methods are simplicity and computational efficiency, while they are not effective at finding periodic signals that are not perfectly sinusoidal (). Of the frequency-domain methods, Fisher's G-test was proposed to detect periodic gene expression profiles by) and has been used to analyze circadian microarray data of Arabidopsis () and mammalian systems (). Fisher's G-test searches periodicity by computing the periodogram of experimental data and tests the significance of the dominant frequency using Fisher's Gstatistic; however, it is limited by low frequency resolution for short time-series generated by circadian microarray experiments, which means it is often not adequate to resolve the periodicity of interest (). Time-domain and frequencydomain methods are two different ways to analyze the timeseries, each with advantages and disadvantages. Frequency-domain methods are noise-tolerant and model-independent but their results are difficult for biologists to understand. Time-domain methods can give comprehensive and easily-understood descriptions for rhythms but are noise-sensitive and model-dependent (e.g. sinusoid). Considering the above limitations, we propose an algorithm named ARSER that combines time-domain and frequency-domain analyses to identify periodic transcripts in large-scale time-course gene expression profiles. ARSER employs autoregressive (AR) spectral analysis () to estimate the period length of a circadian rhythm from the frequency spectrum. It is well-suited to analyze short time-series since it can generate smooth and highresolution spectra from gene expression profiles. It is related (but not identical) to a method called maximum entropy spectral analysis,Page: i169 i168i174
Detecting rhythmic gene expressionwhich has been applied to the analysis of micorarray data (). After the frequency-domain analysis, ARSER takes harmonic regression () to model the circadian rhythms extracted from gene expression profiles. Harmonic regression models fully describe the rhythms using four parameters: period (duration of one complete cycle), the mean level (the mid-value of the time-series), the amplitude (half the distance from the peak to the trough of the fitted cosine, indicating the predictable rise and fall around the mean level) and the phase (the location in time of the peak of the curve). The joint strategy overcomes the shortcomings of separate timedomain or frequency-domain analyses. ARSER uses AR spectral analysis to find the circadian rhythms and a harmonic regression model to characterize and statistically validate them. When tested on multiple synthetic datasets, ARSER is robust to noise, quickly and exactly estimates periodicity and gives comprehensive and statistically significant results in analysis of short time-series. This article is organized as follows. Section 2 describes the mathematical and implemental details of the ARSER algorithm. Section 3 compares the performance of ARSER with COSOPT and Fisher's G-test by testing on different simulation datasets. Numerical experiments are designed by varying noise intensity and period length, including random background models and identifying nonsinusoidal periodic patterns. Finally, ARSER was used to analyze Arabidopsis microarray data and obtained a novel set of rhythmic transcripts, many of which showed non-sinusoidal periodic patterns. Section 4 summarizes the methodology.
METHODS
OverviewOur methodology to detect circadian rhythms in gene expression profiles consists of three procedures: data pre-processing, period detection and harmonic regression modeling (). First, ARSER performs a data preprocessing strategy called detrending that removes any linear trend from the time-series so that we can obtain a stationary process to search for cycles. Detrending is carried out by ordinary least squares (OLS). Second, ARSER determines the periods of the time-series within the range of circadian period length (2028 h) (). The method to estimate periods is carried out by AR spectral analysis, which calculates the power spectral density of the time-series in the frequency domain. If there are cycles of circadian period length in the time-series, the AR spectral density curve will show peaks at each associated frequency (). With the periods obtained from AR spectral analysis, ARSER employs harmonic regression to model the cyclic components in the time-series. Harmonic analysis provides the estimates of three parameters (amplitude, phase and mean) that describe the rhythmic patterns. Finally, when analyzing microarray data, false discovery rate q-values are calculated for multiple comparisons.
Period detectionAs circadian rhythm has approximately (but never exactly) 24 h periodicity (), the first matter to be addressed is to measure the length of actual period for each gene expression profile. ARSER estimates the period by AR spectral estimation, which is a highresolution spectral analysis technique comparing with the classical fast Fourier transform periodogram. Given an equally sampled time-series {x t } with the sampling interval , AR spectral estimation first applies an AR model of order p, abbreviated AR(p), to fit the time-series using the following equation:where  t is white noise and  i are model parameters (or AR coefficients) with  p = 0 for an order p process.and Spyersreported that AR coefficients are generally estimated by three methods: the YuleWalker method, maximum likelihood estimation and the Burg algorithm. ARSER implements the AR model-fitting by setting order p = 24// and computing the AR coefficients using all three methods. After AR modeling, AR spectral analysis estimates the spectrum, with model parameters instead of original data, using the following equation:where  2  is the variance of white noise;  k are parameters defined in Equation (1). If periodic signals are present in the time-series, then the spectrum derived from Equation (2) will show peaks at dominant frequencies. However, at high frequencies the noise signals may also show peaks known as pseudo-periods. ARSER obtains the period by using the following step-by-step procedure:(1) Remove the linear trend in time-series {x t }, denoting the detrended time-series as { x t }.
ABPage: i170 i168i174
R.Yang and Z.Su(2) Smooth { x t } by a fourth-order SavitzkyGolay algorithm (). This is a low-pass filter that can efficiently remove pseudo-peaks in a spectrum caused by noise. The smoothed timeseries is denoted as {x{x t }.(3) Calculate the AR spectrum of {x{x t } by Equation (2), and select all periods {{ i }that show peaks in the spectrum.(4) Calculate the AR spectrum of detrended time-series { x t } by Equation (2), and select all periods {  i }that show peaks in the spectrum.(5) The periods {  i } and {{ i } are chosen as input to the harmonic regression analysis for { x t } by Equation (3).(6) The optimum periods in {x t } are determined by Akaike's information criterion () among the regression models generated in step 5.
Rhythm modeling and gene selectionThe next matter to be addressed is how to model the rhythmic patterns in the time-series of gene expression. ARSER employs the harmonic regression model to represent the cycle trends, which involves fitting sinusoidal models to a time-series using the following equation:where x t is the observed value at time t;  is the mean level of the timeseries;  i is the amplitude of the waveform;  i is the phase, or location of peaks relative to time zero;  t are residuals that are unrelated to the fitted cycles; and t are the sampling time-points. The f i term in Equation (3) are the dominant frequencies in the circadian range derived by Equation (2). The periods ( i ) of the time-series equal (1/f i ), where is the sampling interval. Since periods are predetermined by AR spectral analysis, Equation (3) can be reduced to an even simpler multiple linear regression model:The unknown parameters p i , q i and  can be estimated by OLS method. Then the amplitude  i and phase  i are obtained byBy applying a harmonic regression model, rhythmicity in a time-series is fully described by four parameters: period, phase, amplitude and mean level. Tests of statistical significance are also essential to distinguish between real rhythms and random oscillations. In a harmonic regression model, an F-test is employed to assess the significance of p i and q i coefficients, and so statistically validates the rhythmicity. When analyzing microarray expression data, tens of thousands of genes will be estimated simultaneously, so the problem of multiple testing must be considered. We employed the method of Storey and Tibshirani (2003). Briefly, by examining the distribution of P-values from the given dataset, an estimate of the proportion that are truly non-rhythmic can be derived. The P-value for each transcript can be converted to a more stringent q-value which represents the false discovery rate. In our study, we consider genes with q < 0.05 to be rhythmically expressed.
Generating simulation dataWe provide a comprehensive testing strategy to test and compare the performance of ARSER with COSOPT and Fisher's G-test. Our simulation datasets consist of periodic and non-periodic time-series data. The periodic time-series was generated by two models based on the methods proposed by. One is classified as a stationary model, defined bywhere SNR is signal-to-noise ratio;  is period;  is phase; and  t is ( = 0,where  t is ( = 0, = 50) normally distributed noise; the mean level and amplitude exponentially decay over time. The periodic datasets used in our numerical experiments were generated by assigning different values to ,  and SNR. Compared with the stationary model, the non-stationary model is more likely to approximate the circadian rhythm (). The non-periodic time-series was generated from ( = 0, = 1) normally distributed white noise and AR processes of order one, AR(1), as suggested by Futschik and Herzel (2008).
RESULTS AND DISCUSSIONARSER was applied to both simulated and real microarray data. A series of numerical experiments were designed to test and compare the performance of ARSER with COSOPT and Fisher's G-test. The tasks were to (i) precisely estimate periodicity, (ii) separate periodic from non-periodic signals and (iii) identify non-sinusoidal periodic patterns.
Robustness to noiseIn the first experiment, we compared the robustness of three algorithms to noise. We generated 10 000 stationary(iii) at each period and phase, taking SNR of 5:1, 4:1, 3:1, 2:1 and 1:1. Each time-series possessed 12 data points, within 044 h at 4 h sampling intervals, which was the same as the majority of published circadian microarray datasets. There were 2000 periodic time-series under each SNR. We also generated 2000 ( = 0, = 1) normally distributed random signals. Then we applied ARSER, COSOPT and Fisher's G-test to identify periodic signals from the positive (periodic) and negative (random) samples and measured their performance of periodicity prediction under different SNRs by Matthew's correlation coefficient (MCC) (and B). The MCC is in essence a correlation coefficient between the observed and predicted binary classifications, with values between 1 and +1. MCC = +1 represents a perfect prediction, 0 an average random prediction and 1 an inverse prediction (). Of the three methods, ARSER performed best at any noise-level for both stationary and non-stationary time-series, suggesting it was a robust periodicity detection algorithm.
Correctness for predicting wavelengthThe task of precisely estimating periodicity included two parts: identification of truly periodic signals and the measurement of actual wavelength. The former case was verified for the three algorithms in the robustness experiment, and we continued to investigate the latter one. According to the predictions in the robustness experiment, we calculated the differences for each periodic signal in its actual period and predicted value by each algorithm. The distributions of prediction errors for the three algorithms () showed that ARSER and COSOPT were more accurate (errors with zero means i170Page: i171 i168i174
Detecting rhythmic gene expressionand small variations) in predicting the period length compared with Fisher's G-test (errors of large variation). This indicates ARSER and COSOPT are high-resolution detecting algorithms and can accurately estimate the wavelength of circadian rhythms.
Periodicity detection with random background modelsTo verify our algorithm, our second task was to separate periodic from non-periodic signals, which measured the sensitivity and specificity in the predictions.. Accuracy of ARSER, COSOPT and Fisher's G-test at identifying (A) stationary and (B) non-stationary periodic signals under decreasing signal-to-noise ratio. For each group of periodic signals, there are 1:1 negative sample data generated by ( = 0, = 1) white noise. The performance is measured by MCC. As noise intensity increased, ARSER (blue) performed robustly with noise in both situations, while COSOPT (red) and Fisher's G-test (yellow) performed badly for stationary periodic signals with high-level noise and even worse for non-stationary ones. They all scored the signals as periodic using the threshold of 0.05 for FDR q-value for ARSER and Fisher's G-test, or by pMMC- for COSOPT. pMMC- measures the probability for multiple testing, similarly to the FDR q-value.The periodic signals generated in the robustness experiment contained 10 000 stationary and 10 000 non-stationary time-series. The non-periodic signals were generated by white noise and AR(1) models with 10 000 samples in each case. Then we created four testing datasets by combining (i) stationary periodic signals with white noise signals, (ii) non-stationary periodic signals with white noise signals, (iii) stationary periodic signals with AR(1)based random signals and (iv) non-stationary periodic signals with AR(1)-based random signals. Since predictions were periodic or non-periodic, a well-suited binary classification, we applied receiver operating characteristic (ROC) curves () to compare the performances of the three algorithms on the four datasets (D). Performances were measured by the area under the ROC curve criterion, with the larger the area the better the method. ROC analysis showed that ARSER outperformed COSOPT and Fisher's G-test in all cases.
Detection of non-sinusoidal periodic waveformsThe last numerical experiment was to apply the three algorithms to detect non-sinusoidal periodic patterns. The testing dataset was downloaded from the HAYSTACK web site (http://haystack.cgrb.oregonstate.edu/). This dataset included five cycling patterns based on diurnal and circadian time-course studies: rigid, spike, sine and two box-like patterns (). Each periodic pattern contained 24 samples with the phase shifted from 0 to 23 h by 1 h intervals. A total of 120 time-series were contained in the dataset, which possessed 12 time-points that represent two circadian cycles obtained at 4 h sampling intervals. We also added 120 ( = 0, = 1) white-noise signals as negative data. ARSER performed the best of the three algorithms (), and identified more spike and box-like periodic pattern profiles while maintaining a very low false positive rate.
Analysis of Arabidopsis circadian expression dataOur methodology for identifying periodicity of short time-series worked successfully on synthetic datasets. We applied ARSER to analyze a real microarray dataset generated from the work ofof the differences between the predicted wavelength (using three algorithms) and the actual wavelength of stationary periodic signals (yellow) and non-stationary periodic signals (blue). Log transformation for the difference () was carried out using ln(1+||). The errors of wavelength prediction by ARSER and COSOPT were low and close to zero, while those for Fisher's G-test were high and in a wide range.The waveforms include sinusoidal (red) and non-sinusoidal: rigid waves (yellow), box1 waves (blue), box2 waves (magenta) and spike waves (green). The dataset and periodic patterns were generated by HAYSTACK tool ().in the study of the Arabidopsis circadian system. The data (available from http://millar.bio.ed.ac.uk/data.htm) are expression profiles of 13 data points, representing 48 h of observation obtained at 4 h sampling intervals. In the original study, the authors used COSOPT to identify cyclic genes. Of all 22 810 genes represented on the array, 3504 genes were considered rhythmic at the significance threshold pMMC- < 0.05.The microarray data were originally analyzed by COSOPT in the study of, and scored 3504 genes as rhythmic (pMMC- < 0.05). A total of 4929 genes were identified by ARSER (FDR q < 0.05), while only 536 were found by Fisher's G-test (FDR q < 0.05). Venn diagram was generated by BioVenn tool ().Page: i173 i168i174of the variance. The first and second eigengenes are cyclic with spike-like patterns, and the third shows a linear trend. These data reveal that non-sinusoidal and non-stationary periodic transcripts could be found by applying ARSER. PCA was carried out by Mev tool ().data are not well defined. Thus, we used the 27 known clock genes as benchmark genes to evaluate a given algorithm in terms of false negatives for analyzing circadian expression data. We applied three algorithms to rank the 22 810 genes of the entire Arabidopsis genome in order of the statistical significance of their expression profiles. The rankings of the 27 known clock genes () showed that the three algorithms performed similarly, and all identified most of the known clock genes from among their top 25% ranked candidates.
i171
R.Yang and Z.Su
Detecting rhythmic gene expression
CONCLUSIONIn this study, we present an automated algorithm for identifying periodic patterns in large-scale temporal gene expression profiles. It employs harmonic regression based on AR spectral analysis to identify and model circadian rhythms. Compared with separate frequency-domain or time-domain methods, our methodology is a joint strategy which analyzes the time-series through both frequency and time domains. Testing on synthetic and real microarray data showed that our novel method was computationally optimal and substantially more accurate than two existing and widely-used rhythmicity detection techniques (COSOPT and Fisher's G-test).In addition, our method identifies a novel set of rhythmically expressed Arabidopsis genes which may supply more valuable information for further study of plant circadian systems.
t)+, where t [0,96] with 4 h intervals and  is white noise following ( = 0, = 40) normal distribution. i169 at :: on August 31, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
at :: on August 31, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
We re-analyzed this microarray data using ARSER and Fisher's Gtest, both of which scored rhythmic transcripts by FDR q < 0.05, and compared their predictions with those of COSOPT (Fig. 6). ARSER identified 96% of the cycling transcripts identified by COSOPT, suggesting our methodology efficiently reproduced the original results, while Fisher's G-test merely identified only 15%, implying it may not efficiently analyze this circadian expression data. In addition, a novel set of 1549 transcripts were uniquely identified as rhythmic by ARSER. To examine these newly found genes more closely, we employed principal component analysis (Wall et al., 2003) to visualize the dominant expression patterns from their profiles. The first two principal components accounted for 70% of the variance (Fig. 7A) and were cyclic with spike-like patterns (Fig. 7B and C). These plots revealed a rhythmic component with a period of 24 h in many transcripts of the novel set, which was consistent with the estimate using ARSER. These periodic patterns were mainly non-sinusoidal and may explain why they were not identified by COSOPT in the original study. The third component also showed a linear trend (Fig. 7D), indicating the non-stationary feature of the data. Dodd et al. (2007) reported 27 well-known clockassociated genes in Arabidopsis. Two of these genes were found among the newly identified genes of the present study. One was CRYPTOCHROME 1 (CRY1), which functions as a photoreceptor for the circadian clock in a light-dependent fashion. In plants, the blue light photoreception can be used to cue developmental signals (Brautigam et al., 2004). The other one was PSEUDO-RESPONSE REGULATORS 9 (PRR9), which plays an important role in response to temperature signals in a temperature-sensitive circadian system (Harmer, 2009) and acted as transcriptional repressors of CCA1 and LHY in the feedback loop of the circadian clock (Nakamichi et al., 2010). Thus more clues could be provided by applying ARSER to further study of Arabidopsis circadian expression data. Unlike the synthetic datasets used in numeral experiments, the notions of false positives and false negatives in real experimental i172 at :: on August 31, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
i174 at :: on August 31, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
