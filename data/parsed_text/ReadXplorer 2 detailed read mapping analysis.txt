Motivation: The vast amount of already available and currently generated read mapping data requires comprehensive visualization, and should benefit from bioinformatics tools offering a wide spectrum of analysis functionality from just one source. Appropriate handling of multiple mapped reads during mapping analyses remains an issue that demands improvement. Results: The capabilities of the read mapping analysis and visualization tool ReadXplorer were vastly enhanced. Here, we present an even finer granulated read mapping classification, improving the level of detail for analyses and visualizations. The spectrum of automatic analysis functions has been broadened to include genome rearrangement detection as well as correlation analysis between two mapping data sets. Existing functions were refined and enhanced, namely the computation of differentially expressed genes, the read count and normalization analysis and the transcription start site (TSS) detection. Additionally, ReadXplorer 2 features a highly improved support for large eukaryotic data sets and a command line version, enabling its integration into workflows. Finally, the new version is now able to display any kind of tabular results from other bioinformatics tools.
Extended Read ClassificationFor a more detailed distinction of the reads in comparison to the first ReadXplorer version, two additional read mapping classes have been added to the three existing ones (Perfect Match  a mapping without mismatches, Best Match  a mapping with less deviations than all other mappings of the read, and Common Match  a mapping of a multiple mapped read with better mappings with less deviations elsewhere) (see):  The Single Perfect Match class contains all reads with exactly one (single) perfect match.  The Single Best Match class contains all mappings that cannot be allocated to another position in the reference with the same number or fewer mismatches than at the current position-they exactly have one (single) best match. The Perfect and Best Match mapping classes contain multiple mapped reads with equally good mapping positions, e.g. two perfect mappings without mismatches at different genomic positions. In contrast, the Single Perfect Match and Single Best Match class contain both uniquely mapped reads and the distinctive best mapping of multiple mapped reads. This extended classification enables quick discrimination of reads with only one distinctive best mapping from mappings with multiple equally scoring mappings, while not requiring the read to be uniquely mapped. Reads from both Single Match classes can have more mappings with lower quality, falling in the Common Match class. Thus, this classification is not as strict as only considering uniquely mapped reads with exactly one valid mapping to the reference. The extended read classification is not only used for visualization () but also for read selection during the wizard based setup of all analysis tools offered by ReadXplorer 2. Hereby, additional use cases are enabled for the automatic analysis of read mapping data. As one example, the " Coverage Analysis " can now be used to identify almost identical repetitive regions. By only selecting the Perfect, Best and Common Match mapping classes, only genomic intervals covered by multiple mapped reads  representing repetitive regions in the genome-are returned by the analysis. Such a region is depicted inby the light yellow, red and light green areas.Read has multiple mappings with the same number of deviations from the reference Common Match Read has better mappings with less deviations to the reference
Read
Read Count NormalizationThe first ReadXplorer version featured an RPKM (total exon reads per million mapped read per kilobase of exon model) () based read count analysis. This analysis has been enhanced by two additions: the model for assigning reads to a genomic feature was improved to allow for a more accurate way of read assignment to a feature and the TPM (Transcripts per million) () normalization method was added to the analysis. RPKM is meant to reflect relative molar concentrations of transcripts by normalizing for transcript length and library size. This type of normalization is necessary for reasonable comparisons of transcript abundances both within one and among multiple samples. TPM was proposed as an improvement to RPKM, because TPM has the advantage of being invariant between samples and species () while RPKM values may change when the mean expressed transcript length changes due to different sets of active genes in two samples. TPM is defined according to (B.) as where c is the number of mappable reads for genomic feature i and j is an integer ranging from 1 to the number of genomic features of the same type (e.g. genes). To take into account that reads of a given length cannot start at each position in a transcript, the effective length of transcripts  can optionally be used for the normalization instead of the whole transcript length l. The effective length of transcript i was first defined by () as where x is one of the observed read length values in transcript i of length li, and F is the fraction of reads for i with length x. The model for assigning reads to a transcript needs to be as precise as possible, because the normalization outcome is determined by the chosen transcript boundaries and the inclusion model for the reads. Our analysis offers to either use the given boundaries of genomic features or define a fixed offset for start and stop positions, separately. Using an offset can be useful when most of the 5 " UTRs and 3 " UTRs are not taken into account by the genomic features of the reference. Additionally, automatically annotated gene start and stop positions might be incorrect, leading to data loss. The implemented read assignment model for read mappings overlapping multiple genomic features (e.g. genes or CDS) is similar to the union model of HTSeq-count () with one difference: we include read mappings of the two cases marked as ambiguous by HTSeqcount " s union model instead of discarding them (Supplementary). In the first case, reads fully contained in the first feature and overlapping the start of a second feature are associated to the first feature. In the second case, reads fully contained in two overlapping feature are counted proportionally for each of the overlapped features. In addition to the general export functionality, the TPM or RPKM-value distribution of the analyzed data set can be visualized in a log-scaled histogram (see). All bin borders are dynamically calculated according to the percentage they contribute to the result.
TSS AnalysisThe transcription start site (TSS) detection has been substantially enhanced towards a more detailed analysis of TSS properties. In some cases the coverage increases in steps at a TSS. To consider this case, an option was implemented to associate all predicted TSSs within a small user-defined bp window to the statistically most significant TSS. Hereby, neither several predicted TSS appear for one gene, nor is any of them lost. To identify at a glance if evidence for alternative TSSs exist, all identified TSSs within a user defined window are classified. The statistically most significant position is designated as "primary" TSS, while all other TSSs on the same strand are marked as "secondary". In many microbial organisms the majority of transcripts contains a leader, but transcripts can also be leaderless (). To distinguish both cases easily, leaderless transcripts are flagged in the result and can thus be retrieved instantly. The maximum distance of a TSS to the actual translation start site can be adjusted in the wizard. To offer a deeper insight into novel transcripts identified by the analysis, the TSS detection further computes the next start codon on the respective strand, the leader length and the next in-frame stop codon. The novel transcript length is deduced from the assigned start and stop codons. Another new feature is the option to configure the length of exported upstream and downstream regions for promoter analysis.
Differential Gene Expression with DESeq2To offer easy access to one of the most recent analysis tools for differential gene expression analysis, we added DESeq2 () to the set of integrated tools. With baySeq () and the original DESeq () already integrated, ReadXplorer 2 offers three widely used analysis tools for identifying differentially expressed genes. The settings for the analysis can be easily specified by a step-by-step wizard in the same fashion as for the already integrated tools (Supplementary).). ReadXplorer 2 offers an effortless exploration of the data underlying the genome rearrangements detected by GASV (table at the bottom). The region of the deletion selected in the table is centered simultaneously in the reference, track and read pair viewer. In the example, the hypothetical protein PA0343 is deleted in P. aeruginosa strain B420 from the study by (). No reads map to the corresponding region of P. aeruginosa PAO1 and many read pairs are observed in B420 with an enlarged distance of about 1200bp instead of the expected 300bp.
Genome Rearrangement DetectionGenome rearrangements or structural variations (SVs) are associated to many diseases including cancer (). In addition, genome rearrangement detection is useful for the phylogenetic analysis of eukaryotic and prokaryotic organisms. In general, the tools for SV detection are command-line based. Integrating an established SV detection tool into ReadXplorer 2 makes genome rearrangement detection accessible for researchers unfamiliar with command-line tools and enables immediate visual inspection of read pair configurations in genomic regions with predicted SVs (see). We chose GASV 2.0 (, http://compbio.cs.brown.edu/projects/gasv/) for integration. Its development focused on the human genome, but it has also been tested successfully on other genomes like yeast (). GASV supports a broad range of rearrangements: insertions, deletions, inversions, translocations and can handle more divergent rearrangement events i.e. resulting from multiple rearrangements at the same locus. To guarantee flexibility for the user, the GASV wizard in ReadXplorer 2 offers all options available for the command line version of GASV. Note that only Single Perfect Match and Single Best Match mappings are allowed for the GASV analysis. Testing different mapping classifications with different example data sets showed that it is inevitable to use only these two classes to produce reasonable results. Otherwise, repeat regions lead to many false positive rearrangement predictions obscuring the correct predictions.
Correlation AnalysisA correlation coefficient can be used to identify regions of two tracks mapped to the same reference showing very similar or completely different coverage to identify similarities and differences in the data sets automatically. Two exemplary applications are: The comparison of 2 RNA-Seq data sets (e.g. a whole transcriptome and a 5 " enriched one) to identify all TSS regions correlating in both tracks or retrieval of all genomic regions with correlating expression patterns. To compare 2 tracks, we divide the genome into intervals of user defined length and perform statistical correlation analysis of the coverage value pairs for each position within each interval. The options are configured on a single wizard page, where the user can choose the correlation method and additional parameters. The two implemented methods to calculate the correlation coefficient are (i) the Bravais-Pearson () product-moment and (ii) the Spearman " s rank () correlation coefficient. Spearman " s rank correlation coefficient has the advantage that no assumptions on the underlying probability distribution have to be made and no linear relationship is required between the random variables. For a correct visualization of eukaryotic RNA-Seq reads spanning an exon-intron boundary, the user interface was enhanced to display split read mappings in the Track Viewer, the Alignment Viewer and the Histogram Viewer. Analysis functions also take the mapped blocks of split read mappings into account.
Other Analysis EnhancementsMinor, but notable new features include: (i) Each analysis now offers the option to select the strand on which the reads are mapped in relation to genomic features (same, opposite or combine reads of both strands). (ii) The read classes of the reads used for an analysis can be selected and a minimum mapping quality threshold (PHRED scale) can be set.
Command Line InterfaceIn order to cope with data sets consisting of many tracks and to enable the integration of ReadXplorer 2 into automatic analysis pipelines, the software now provides a command line interface (CLI). Via this new interface it is possible to concurrently import reference and mapping files, perform analyses and export results by providing corresponding parameters without the need for user interaction. Thus, executing a whole workflow is less time consuming than before. For the sake of usability all import and analyses preferences can be set in a separate configuration file which can be reused for future analyses. This new feature allows command line users an easy and flexible integration of ReadXplorer 2 in any command line pipeline or automatic analysis scripts.
Rserve IntegrationFor the differential gene expression analysis ReadXplorer 2 primarily relies on established tools only available for GNU R (R Core Team, 2014). In order to use these tools a Java to GNU R interface is needed. In ReadXplorer 2 we changed this interface to Rserve (), offering an easier setup and a more stable execution of the analysis tasks. On Windows machines an automatic setup is offered, for Linux and Mac OS X the connection to an Rserve instance can easily be configured via the options menu.
Other Implementation EnhancementsReadXplorer 2 can import tabular results (CSV, XLS, VCF) either created by itself or any other tool. This enables comparisons of ReadXplorer 2 generated results with the results created by other established tools and offers flexible visualization of analysis results from commandline tools. A link was added for cross-linking genomic features with an EC-number to a user configurable enzyme database (default: ExPASy, http://www.expasy.org/). The graphical user interface now offers a detailed viewer for combined tracks. Additionally, the alignment view of the detailed viewer is now zoomable and the bases are colored based on quality. The track viewer supports additional feature types for displaying (ncRNA, 5'UTR, 3'UTR, RBS,-35_signal,-10_signal) and offers a new option to display all reads from both strands on the forward or reverse strand only. This is especially useful for visualizing data sets originating from non-strand-specific RNA-Seq experiments. The complete mapping statistics of all tracks can now be exported from the database.: The difference of the read coverage between only uniquely mapped reads (middle row) and using the " Single Perfect Match " and " Single Best Match " mapping classes is shown for the genes AT5G46900 and AT4G12510 (upper row). In total numbers 144 and 78 more reads can be included in the analysis respectively when using the extended read mapping classification.
ResultsWe used ReadXplorer 2 for the evaluation of an Arabidopsis thaliana RNA-Seq test data set that was generated for this purpose. Several of the aspects described above were addressed, namely extended read classification, improved handling of eukaryotic data and the DESeq2 integration. The experiment focused on differential gene expression analysis between the A. thaliana Col-0 wild-type and a myb11-12-111 triplemutant line (Supplementary methods); array-based data for this biological material are available (). Three biological replicates, each of them consisting of two technical replicates, were created from wild-type and mutant each. The 12 samples produced ~183 million usable reads that were mapped to the TAIR 10 A. thaliana Col-0 reference. Besides visual inspection, we started the analysis with a " read count and normalization calculation " , to check the integrity of the biological and technical replicates. This was achieved by plotting their TPM values against each other to check for correlation (Supplementary). For all except one technical replicate, the resulting expression values corresponded to each other (were located close to the 45 diagonal). Thus, the problematic technical replicate was excluded from further analysis. Further investigation showed that in the problematic sample rRNA removal was incomplete. This experimental complication occurs at low frequency with the RNA-Seq kits from Illumina. To identify differentially expressed genes between the wild type and the mutant and simultaneously monitor the effect of employing the extended read mapping classification, we applied DESeq2 via ReadXplorer 2 twice with different included read mapping classes. Once, we only used the uniquely mapped reads and in the second case, we used the Single Perfect and Single Best Match mapping classes  also including reads with a distinctive best mapping. The latter selection enabled us to include on average 1,400,000 more reads per data set in the analysis (Supplemental), leading to more accurate gene expression values and minimizing underestimation of expression levels. This effect can be observed even in the most differentially expressed genes (). Two examples are the genes AT5G46900 and AT4G12510. Their mean expression is increased from 299 to 379 reads in the first case and from 135 to 189 reads in the second case. These and other examples (Supplementary) convincingly show that the level of differential gene expression is underestimated if only uniquely mapped reads are used. In total, the expression of 13,850 of all 28,775 annotated genes is underestimated. Of these, 1896 genes can be assigned > 100 and 153 genes > 1000 additional mappings when applying the extended read classification. The comparison of the DESeq2 results between only incorporating uniquely mapped reads and using the Single Perfect and Single Best Match mapping classes is shown in SupplementaryAdditionally, we show in Supplementary Table S4 that ReadXplorer 2 offers several unique features and combines many useful features that are not present in this composition in one of the other commonly used read mapping visualization tools like Savant (), IGB (), Artemis (), IGV () and GenomeView (). Finally, we assessed the performance of analysis functions offered by ReadXplorer 2. We benchmarked the performance on small (~6 mb), medium (~120 mb) and large (~3 gb) reference genomes (Supplementary). This assessment also includes a comparative runtime benchmark between ReadXplorer 1 and ReadXplorer 2 (Supplementary). The results show that on the same hardware the new version of our software significantly outperforms the older release when the same tasks are executed.
DiscussionThe comprehensive read mapping data visualization and automatic analysis tool ReadXplorer 2 features substantially enhanced capabilities from one source. The major improvement presented here is the extended read mapping classification which leads to more specific analysis results as shown in the results section. Further, the extended classification enables meaningful integration of multiple mapped reads and creates awareness for the different types of multiple mapped reads, e.g. to identify repetitive regions (). Moreover, two newly implemented analysis functions and substantial improvement of existing analyses widen the spectrum covered by ReadXplorer 2 and enable the user to screen for genome rearrangements and correlation between two data sets without the need to install additional software. The read count normalization can now be compared between different samples as the added TPM normalization is invariant between samples. With DESeq2 another widely used differential gene expression analysis package is available from within the software. The enhanced TSS detection allows deeper insights into the TSS landscape by analyzing additional properties of the TSS and presenting them to the user. The application range of ReadXplorer 2 is further broadened by improving the handling of eukaryotic data. Using our A. thaliana RNA-Seq data set, we were able to successfully evaluate the new features and could show that the enhanced read classification helps to improve the analysis results. With the new command line interface, integration into automatic analysis pipelines is enabled. This allows handling experiments with many samples more efficiently than in the graphical user interface as only a single command is needed to import all data and subsequently run all desired analyses. Finally, integration of results from multiple tools and viewing the read mapping data along with analysis results is important for researchers. Therefore, the new possibility to import arbitrary data tables starting with a genomic position column aids this need.
Associate Editor: Prof. Bonnie Berger Bioinformatics Advance Access published August 18, 2016 at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
.7. Visualization of Split Read Mappings at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
.4. Web Service To ease the use of ReadXplorer 2, we added it to the toolbox of our Galaxy server at https://www.computational.bio.uni-giessen.de/galaxy/. The server is available for registered users only, but registration is free of charge. Here, we use the CLI to automatically create a ReadXplorer database for the user data and allow downloading the full data package after project calculation. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
