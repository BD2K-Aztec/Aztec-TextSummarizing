Motivation: When comparing the organization of two genomes, it is important not to draw conclusions on their modes of evolution from a single most parsimonious scenario explaining their differences. Better estimations can be obtained by sampling many different genomic rearrangement scenarios. For this problem, the Double Cut and Join (DCJ) model, while less relevant, is computationally easier than the Hannenhalliâ€“Pevzner (HP) model. Indeed, in some special cases, the total number of DCJ sorting scenarios can be analytically calculated, and uniformly distributed random DCJ scenarios can be drawn in polynomial running time, while the complexity of counting the number of HP scenarios and sampling from the uniform distribution of their space is unknown, and conjectured to be #P-complete. Statistical methods, like Markov chain Monte Carlo (MCMC) for sampling from the uniform distribution of the most parsimonious or the Bayesian distribution of all possible HP scenarios are required. Results: We use the computational facilities of the DCJ model to draw a sampling of HP scenarios. It is based on a parallel MCMC method that cools down DCJ scenarios to HP scenarios. We introduce two theorems underlying the theoretical mixing properties of this parallel MCMC method. The method was tested on yeast and mammalian genomic data, and allowed us to provide estimates of the different modes of evolution in diverse lineages. Availability: The program implemented in Java 1.5 programming language is available from http://www.renyi.hu/~miklosi/DCJ2HP/.
INTRODUCTIONAlthough genome rearrangement was the very first clearly stated computational problem in biology introduced by, and many computational methods finding one most parsimonious rearrangement scenario have been published in the past 15 years, the statistical tools available for analysing genome rearrangements are still very limited.published the first polynomial running time algorithm that finds a most parsimonious scenario transforming one genome * To whom correspondence should be addressed. into another using reversals. The method has been extended to transforming multichromosomal genomes by reversals and translocations (). This general model is called the HannenhalliPevzner (HP) model. Having a single parsimonious scenario is usually not enough to draw conclusions on the evolution of the genomes. For example,have computed different values of the breakpoint reuse rate for different scenarios transforming a human genome into a mouse genome, which tell different stories about their evolution. Exact counting or sampling in the space of parsimonious HP scenarios seems to be difficult and has only been achieved for very small examples (). Several authors published Markov chain Monte Carlo methods that sample from a Bayesian distribution of genome rearrangement scenarios (), but these Markov chains have very poor mixing (), and it has been proved that there are series of data (pair of genomes) for which the mixing time of these Markov chains grows exponentially with the size of the data (). This means that billions of Markov chain Monte Carlo (MCMC) steps are necessary to get a sufficient number of low-correlated samples from the Markov chain, making the approach computationally infeasible for large datasets.introduced a massively parallel MCMC method that samples from the uniform distribution of most parsimonious reversal scenarios, and approximately counts the number of such scenarios. By applying the method on real biological data, they showed that it is superior to other available methods. However, they could not prove that fast mixing of their Markov chain is guaranteed for any input. Furthermore, their method works only for most parsimonious reversal scenarios, and it is not clear how to extend it to sampling from the Bayesian distribution of all possible HP scenarios. The double cut and join (DCJ) model was introduced byand in a slightly different version by. This model allows all types of mutations of the HP model, together with mutations that are rarely observed in biological data. In particular, the formation of circular chromosomes, which is frequent in the DCJ model, is never observed in the evolution of Eukaryote genomes. A few big transpositions possibly issued from such a mechanism are hypothesized (), and some cancer karyotypes carry circular chromosomes. However, observed as well as predicted rearrangements are almost always of HP type. For example,infer a scenario with
Rearrangement sampling via DCJ144 rearrangements on the yeast genome that we also use in this study, all of them being HP mutations. So a current convention, supported by past observations, which might be refuted in the future, assumes that the DCJ scenarios have lower biological relevance than translocations and reversals scenarios. On the other hand, the algorithmics of DCJ is much simpler. Indeed, not only can the DCJ distance be calculated in linear time () (as well as the HP distance), but also it is possible to quickly count the number of most parsimonious DCJ scenarios of co-tailed genomes (). Furthermore, it is also possible to quickly sample from the uniform distribution of DCJ scenarios of co-tailed genomes (). The computational simplicity on its own would not be sufficient to intensively study the DCJ model; however, it opened a new perspective in developing novel methods for inferring genome rearrangements. Indeed, the DCJ model has turned to be a computationally useful concept, for example, the genome rearrangement distance under the HP model can be calculated in linear time via the DCJ distance ().
APPROACHIn this article, we explore further how the DCJ model helps developing computational tools for inferring genome rearrangements. We conjecture that counting the number of most parsimonious HP scenarios is hard (#P-complete), and hence, sampling exactly from the uniform distribution of most parsimonious scenarios or from the Bayesian distribution of all possible scenarios is also hard. However, approximate stochastic counting or sampling could be possible, and one way to do it is to use the computationally simpler DCJ model. We introduce a parallel Markov chain Monte Carlo method sampling DCJ scenarios transforming one genome into another. Each Markov chain has its fixed temperature, and the distribution of the rearrangement scenarios depends on the temperature of the chain in the following way. We define an energy function mapping from the scenarios to real numbers. Scenarios containing many DCJs that are not in the HP model get a high energy, and the minimum energy is taken on the scenarios that have only HP-type mutations. At infinite temperature, all types of mutations of the DCJ model are equally probable. The probability of DCJ mutations that are not in the HP model decreases with the temperature, and at zero temperature, only the mutations in the HP model have non-zero probability. See Section 3 for details. We implemented the method in the Java programming language, and tested it on yeast and mammalian data. In Section 4, we show how our method can provide quantitative estimates of the ratio of different types of rearrangements. Such numbers were previously inferred by hand () with a lot of uncertainties, or from a single parsimonious scenario, which, given the huge number of equivalent ones, is unsound. We correct the manual estimate ofon yeast data, and show that the rates of reversal/translocation are very different among studied taxa. In addition to this demonstration of the applicability of our novel approach, we prove in the Appendix that(1) Any DCJ scenario can be transformed into an HP scenario using the small changes of the Markov chains, such that the energy is monotonously decreasing. This means that the surface of the energy function we defined is smooth in the sense that all local minima are global minima.(2) With an appropriately chosen number of parallel chains and temperatures, the probability of exchanging information between any two neighbour chains is above 1/2. Furthermore, the highest temperature can be chosen to infinite, and the lowest temperature can be chosen such that the probability of an HP scenario in its distribution is at least 1 2 .The first theorem guarantees that the MCMC cannot be trapped in a local minimum. The second theorem shows that the MCMC will not be trapped even in a global minimum, it can break out from a global minimum to visit another global minimum. Such break out is essential for fast mixing, asproved that these global minima might be far from each other, thus causing slow mixing. In summary, we build theoretically founded and biologically sound rearrangement scenarios. This allows to observe some modes of evolution in different taxa, as well as to provide analyses for the construction of more precise models of structural evolution.
METHODS
Definitions and notations
GenomesA gene a is an oriented sequence of DNA, identified by its tail a t and its head a h. Tails and heads are the extremities of the genes. An adjacency is an unordered pair of gene extremities. A genome is a set of adjacencies on a set of genes, where a gene extremity belongs to at most one adjacency. Each adjacency in a genome means that two gene extremities are consecutive on the DNA molecule. In a genome, a gene extremity g which does not belong to an adjacency is called a telomere. For a genome on a set of genes, we define the graph G : its vertex set is the set of all gene extremities, and its edge set is composed of a t a h for every gene a, plus the adjacencies of. The graph G is composed of disjoint cycles and paths. Each component of G is called a chromosome of. A chromosome is linear, if it is a path, and circular if it is a cycle. A genome is linear, if it has only linear chromosomes, and circular, if it has only circular chromosomes.
DCJ and HP operations If Gis the set of gene extremities, let G * = G {T } be the same set extended with an additional null element T. A DCJ  is an oriented pair ((pq,rs),(pr,qs)), where p,q,r,s are elements of G * , and couples pq, rs, pr, qs, as well as couples (pq,rs) and (pr,qs) are not oriented. A DCJ is valid for a genome if pq and rs are either adjacencies of , of type Tx where x is a telomere of , or of type TT. Applying a valid DCJ on removes the two adjacencies pq and rs if they exist, and creates the two adjacencies pr and qs or telomeres x if pr or qs equals xT. The result of applying a valid DCJ  on a genome is denoted by /. A DCJ scenario between two genomes and on the same set of genes is a sequence  1 ... k of valid DCJ operations ( i is valid for / 1 /.../ i1 ) such that / 1 /.../ k =. The length of a shortest DCJ scenario between two genomes and is the DCJ distance, denoted by d DCJ (,). Given two genomes and , a valid DCJ operation for falls into one of these three categories: decreasing the distance by 1, not changing the distance and increasing the distance by 1. These three types will be denoted by-1-DCJ, 0-DCJ and +1-DCJ, respectively. In a scenario S, two consecutive DCJs ((pq,rs),(pr,qs)) and ((ab,cd),(ac,bd)) are said to commute if the intersection between {p,q,r,s} and {a,b,c,d} is empty or is the singleton {T }. It is easy to check that if two consecutive DCJ commute, then it is possible to swap their positions in the scenario, and obtain a valid scenario again.
Page: 3014 30123019
I.Mikls and E.TannierA DCJ operation can change the structure of a genome in several ways. If it acts on one or two linear chromosomes and does not create any circular chromosome, then it is called an HP operation. The DCJs that are also HP operations are the following: reversals, changing the order and orientation of the genes in a segment of a chromosome, reciprocal translocations, where two chromosomes exchange an arm (possibly one of the arms is empty), fusions of two linear chromosomes, and fissions of one linear chromosome into two linear ones. The DCJs that are not HP operations are: fusions of one linear and one circular chromosome or of two circular chromosomes, fissions of one chromosome into a linear and a circular chromosome or into two circular chromosomes, circularization or linearization of chromosomes. The number of valid HP operations for a genome will be denoted by v().
Breakpoint graphsThe breakpoint graph of two genomes and on the same set of genes, denoted by, is the graph in which vertex set is the set of extremities of the genes, and in which there is an edge between two vertices x and y if xy is an adjacency in either (these are-edges) or (-edges).The breakpoint graph of two genomes is a set of disjoint paths and cycles. The DCJ distance is immediately readable from the breakpoint graph. Theorem 1. () For two genomes and ,
MCMCWe apply a parallel MCMC method, where there are several Markov chains, each converging to a prescribed distribution. Each chain has a fixed hypothetical temperature, the target distribution of the chain depends on the temperature. Unlike the usual Parallel Tempering method (), the distribution is not simply a Boltzmann distribution. In Section 3.2.1, we precisely define the target distribution of a chain at a particular temperature. The chains are coupled in a Metropolis Coupling way described in Section 3.2.2.
The probability distribution of a chain at a particular temperatureThe states of the Markov chains are the tuples {R,r}, where R is a DCJ scenario between genomes and , and r is the rate of any DCJ mutation. To reach a distribution over this state space, we first introduce a Markov model on HP scenarios. We model genome evolution with a continuous time Markov model, where any valid HP mutation can happen with a rate r. Since we cannot measure the evolutionary time and the rate of mutations independently, w.l.o.g., we can set the evolutionary time to unit 1, and let only the evolutionary rate vary. The probability density that the first HP mutation happens after time t is e v()rtThe probability of a particular scenario R =  1 , 2 ,..., k starting from genome given parameter r is given by the integrale v()r(1t k ) dt 1 dt 2 .
..dt kAlthough there is no closed formula for Equation (2), it can be analytically calculated by an efficient algorithm introduced by. We can define the likelihood of parameter r using the data augmentation on the possible scenarios:where R|(,) means a summation over scenarios R transforming into . By setting the prior distribution of r to the exponential distribution with expectation 1, we arrive to the posterior distribution of {R,r}:We extend the formula in Equation (2) to DCJ scenarios. Note that in this case, P(R|,r) is not a probability distribution in the sense that the equationholds only if we restrict the summation to HP scenarios. However, P({R,r}) in Equation (4) is still a well-defined distribution when R can be any DCJ scenario. Furthermore, if we restrict this extended distribution to the HP scenarios, we get back the proper Bayesian distribution. This restriction can be done by omitting the non-HP scenarios from the MCMC samples. For each scenario, we define the DCJ energy function, c(R), as the sum of the number of circular chromosomes along the scenario. The target distribution of the Markov chain iswhere T i is the temperature of chain i. The restriction of this distribution to the HP scenarios is exactly the Bayesian distribution defined in Equation (4), which is our aim.
MCMC stepsThere are two types of steps in the global MCMC, composed of k parallel chains: @BULLET chain-swapping steps @BULLET in-chain steps.The probability of both types of steps is 0.5. In chain-swapping steps, a random i is drawn from the uniform distribution on. The two states of the two chains i and i+1 are swapped with probability minSwapping the two states with this probability guarantees the convergence of the chains to their prescribed distribution ().shows that all hidden normalizing constants introduced by extending the HP scenarios to DCJ scenarios and by defining distributions up to unknown normalizing constants in Equation (4 and 6) cancel out. When an in-chain step is chosen, a random i is drawn from the uniform distribution on. With probability 1 2 , a random window w is chosen from state of chain i, and a new scenario is proposed for this window, independently from the current scenario in the window. The new scenario is constructed by iteratively proposing a new valid DCJ for the current genome. For each valid DCJ to be chosen, the type is first determined according to. Then we choose one DCJ of this type uniformly, and apply this mutation to the genome. If the result is not the genome , then the outcome will be the input of the next step. If the result is , then we stop with probability 0.99, and with probability 0.01 we propose as the input of the next step. Since we know the cardinality of all the three subsets of mutations, we can calculate the proposal and backproposal probabilities easily. The probability of accepting the new scenario is defined by the Metropolis Hasting ratio (). With probability 1 2 , mutation rate r is changed following a standard MetropolisHastings algorithm (). The method has been implemented in Java 1.6 and its correctness has been tested on some toy examples.There are only five different cases because it is easy to prove that if there is no 1-DCJ then there is no 0-DCJ, and in this case there must be at least one +1-DCJ. In all runs, we set  = 0.95,  = 0.04,  = 0.01. See text for details.
Rearrangement sampling via DCJ
RESULTS
MCMC diagnosisTheorem 3 in Appendix B provides an upper bound on the number of chains which are necessary to guarantee an intensive exchange of states between the Markov chains. In practice, we used a significantly lower number of chains, only 10 parallel chains. Also, we used a different temperature scaling than the theoretical one in the Theorem 3. The inverse of the temperature for the k-th chain was set to 1where s was set to 0.01 for the two yeast analyses and both to 0.01 and 0.04 in several runs of mammalian analyses. In this way, the temperature of the 0 index chain was set to infinity, and the coldest chain's temperature was set to 1 or 0.25. The empirical swap probabilities for the mammalian analysis are shown on. Although the swap probabilities between high temperature chains were relatively small, there was still a reasonable swap frequency, providing hundreds of swaps in a 200 000 step long MCMC run. While this setup for the temperatures and number of chains provided reasonable mixing of the chains, we cannot say by any mean that these protocols are optimal. In general, the smaller the difference between neighbour chains, the higher the acceptance probability of accepting a swap between two chains; furthermore, the smaller the temperature of the coldest chain, the higher the fraction of HP scenarios in it. However, a smaller coldest temperature as well as smaller differences between the temperatures of neighbour chains call for a larger number of chains, hence increased computational time to perform one in-chain step on all chains. Furthermore, the increased number of chains also increases the hitting time of the coldest chain from the hotter chain (in terms of accepted swaps). We opted for the quadratic function in Equation (8) because according to our experience, the acceptance probabilities of swapping two chains decrease more with the temperature gap at high temperatures. The heuristic explanation for this is that the energy function varies more at high temperatures, and thus, c in Lemma 5 takes high values more frequently than at low temperatures. To show that the state swaps indeed influence all Markov chains, we calculated how many MCMC steps were needed to have a given number of chains whose state was at least once in the hottest chain during the MCMC run (). As expected, the number of necessary steps is smaller when the temperature difference is smaller. Similar results were obtained for the yeast analysis (data not shown).Among these samples, we found thousands of HP scenarios ranging from 1957 till 3354 in the mammalian analyses, and above 3000, ranging up to 4736 samples in the yeast analyses, showing that the higher indexed chains were cold enough to have HP scenarios in their target distributions with non-negligible probabilities. The minimum were taken on one of the runs with s = 0.01, showing that the HP scenarios are less frequent at high temperature. We also would like to mention that the hottest chains almost never sampled HP scenarios, the empirical frequency of HP scenarios in the hottest chain is <0.0003. This shows that it is computationally inefficient to sample DCJ scenarios and restrict the samples to HP scenarios. Tempering is needed to sample HP scenarios frequently. MCMC runs on each input data were repeated at least three times with different random seeds, and the convergence was also checked by comparing the samples from different runs (see, e.g.). showing the empirical distribution of parameter r estimated from two different runs.
Biological data analysisWe tested the MCMC sampler on two datasets. One is the comparison of the yeast Saccharomyces cerevisiae with its ancestral genome pre-dating the whole-genome duplication that occurred in that lineage 100 million years ago. This dataset was manuallyanalysed byusing parsimony principles and it is interesting to compare their results with the automatic method. The other one is a human mouse genome comparison, which is interesting for two purposes. The first is a possibility of comparing the modes of structural evolution in different lineages, i.e. in yeast versus mammals. The second arises from a debate on the computation of the breakpoint reuse rate, which is sometimes computed independently from any scenario () or from an ad hoc parsimonious scenario (), and has very different values according to the method, which drives opposite biological conclusions. Sampling among scenarios allows the computation of a mean breakpoint reuse. For the yeast genome, we used as 'genes' the markers constructed by Gavranovic and Tannier (2010) using a double synteny principle. These markers cover 97% of the genes used by, from which we take the ancestral pre-duplication configuration [the ancestral genomes vary only by one DCJ (a non reciprocal translocation) from one method to the other].estimated the number of rearrangements from the ancestor to S.cerevisiae to be 73 inversions, 66 reciprocal translocations and 5 non-reciprocal translocations. Our results are summarized in. The ratio of reversals/translocations is lower than in(0.66 versus 1.03), confirming the propensity of yeasts to evolve mainly by translocations. This is also confirmed by the comparison of the same ancestral configuration to the non-duplicated genome Lachancea kluyveri, where the ratio is about 24% [the manual study ofwas limited to the scenario in the S.cerevisiae branch]. In contrast, for mammalian genomes, we used the Pecan alignment coordinates from the release 58 of the Ensembl-Compara database (), retrieving the seeds that were present in the Human, Macaca, Mouse, Rat, Dog, Horse, Cow and Opossum genomes. By joining consecutive alignments and discarding the groups covering <100 kb in at least one species, we obtained 915 universal orthology blocks covering 70% of the chosen mammalian genomes. We used the euarchontoglire (humanmouse ancestor) ancestral genome reconstruction using the method of, and compared its organization with the extant genomes. The results, reported onfor human and mouse, show that the modes of evolution are very different from yeast ones, and even can be very different among lineages.The presence of fusions and fissions contrasts with the evolution of
I.Mikls and E.Tannier
Rearrangement sampling via DCJWe introduced a promising approach for inferring genome rearrangement evolution. The previous best method () was able to sample only from the uniform distribution of all most parsimonious reversal scenarios. Our new method provides a radically different approach that can sample also from the Bayesian distribution of all possible reversal scenarios. The MCMC we constructed has a theoretical ground; however, Theorems 2 and 3 work for more particular types of data than the MCMC itself, as they are limited to unichromosomal co-tailed hurdle-free genomes, and parsimonious scenarios. However, we conjecture they are true for a more general case, if not the most general one in which the MCMC stands. This new method also has the potential to be extended to multiple genome rearrangements. So far, no efficient method is available for the Bayesian inferring of genome rearrangement phylogenies. BADGER, the best method available for Bayesian rearrangement phylogenies () needs tens of millions of MCMC steps to converge on moderate data containing less than 80 syntheny blocks (). We conjecture that the torpid mixing of BADGER is caused by the bottlenecks in the state space discovered byalready realized, the usual parallel tempering that heats up the distribution towards suboptimal scenarios cannot eliminate these bottlenecks. The new heating protocol introduced in this article, which heats the distribution towards DCJ scenarios can eliminate these bottlenecks.
APPENDIX AIn this appendix, we prove in a particular case that all local minima on the energy surface defined by the sum of the number of circular chromosomes along a DCJ path are global minima. We conjecture the same result for the general case (multichromosomal genomes).
A.1. Unichromosomal hurdle-free co-tailed genomesA unichromosomal genome is a genome with only one chromosome. A couple of genomes is said to be co-tailed if they share the same telomeres. The DCJ distance between two unichromosomal linear co-tailed genomes is n(c(,)+1). On unichromosomal linear genomes, DCJs are either reversals, or fusions or fissions of chromosomes involving at least one circular chromosome. A fission of a chromosome into two, immediately followed by the fusion of these two chromosomes (with different points of fusions) is called a blockinterchange. A-edge (respectively-edge) of the breakpoint graph of two genomes and is said to be oriented if it joins two gene heads or two gene tails. It is unoriented if it joins a head and a tail. A cycle is said to be oriented if it has an oriented edge.
Page: 3018 30123019
I.Mikls and E.TannierTwo cycles A,B of a breakpoint graph of unichromosomal co-tailed genomes and are said to cross if the minimal path of G containing the extremities of A also contains extremities from B, and vice-versa. The interleaving graph of two genomes and is the graph whose vertex set is the set of cycles of the breakpoint graph, and two cycles are linked by an edge if they cross. A component of and is the set of genes extremities of the cycles of a connected component of the interleaving graph of and if this set has cardinality at least 4. A component is said to be oriented if at least one edge of a cycle of the component has an oriented edge. It is unoriented otherwise. and are hurdle-free if they have no unoriented component. The following two results are corollaries of the HannenhalliPevzner theorem ().The number of different DCJ scenarios between two hurdle-free co-tailed unichromosomal genomes and can be easily computed, while computing the number of DCJ scenarios containing only reversals, as well as only reversals and block-interchanges, are open problems.
Result 1. For two hurdle-free co-tailed unichromosomal genomes and
A.2. The theoremFor a DCJ scenario S between genomes and , denoted by S(i) the DCJ at the i-th position on S., we define d(S 1 ,S 2 ) as the smallest integer d such that there exists k verifying:In other words, d(S 1 ,S 2 )  d if it is possible to replace d consecutive DCJs of S 1 , by d other DCJs to obtain S 2. For a genome , let circ() be the number of circular chromosomes of .) be the score of the scenario S. For any DCJ scenario S between two unichromosomal co-tailed genomes, c(S)  0 and S is a scenario of reversals if and only if c(S) = 0.@BULLET S k is a reversal scenario.
A.3. Proof of Theorem 2Letbe a scenario between unichromosomal co-tailed hurdlefree genomes and such that c(S 1 ) > 0. We prove that there always exists a finite sequence). This proves the theorem. A DCJ scenario that is not a reversal scenario contains fissions and fusions. If in a DCJ scenario every fission is immediately followed by a fusion, then we say it is a reversal/block-interchange scenario. The first step of our proof shows that any DCJ scenario can be transformed into a scenario of this type. The second step of the proof shows that this can further be transformed into a reversal scenario.By hypothesis on  q ,  q1 involves either only gene extremities from G 1 or only gene extremities from G 2. Suppose w.l.o.g. that it is G 1. If  q and  q1 commute, let  q1 =  q and  q =  q1. If they do not commute, denote  q1 by ((ab,cd),(ac,bd)) and  q by ((ac,ef ),(ae,cf )), with a,b,c,d being gene extremities of G 1 and ef being gene extremities from G 2. Now let  q1 = ((ab,ef ),(ae,bf )) and  q = ((cd,bf ),(bd,cf )). In both cases, the scenariois composed of valid DCJ operations, we trivially have d(S 1 ,S 2 )  2 and we also have c(@BULLET For all i = q1,@BULLET Clearly , |circ()circ(/)|1 for any genome and DCJ , so circ()1; @BULLET The DCJ  q1 is a chromosome fusion so circ(Now in S 2 ,  q1 is the first DCJ after  p which involves gene extremities both from G 1 and G 2. Applying this transformation again to S 2 decreases the index q of the first DCJ after  p which involves gene extremities both from G 1 and G 2. We may apply the same transformation until q = p+1, which means that  p  p+1 is a block interchange. Applying the same transformation to every  p fission which is the first DCJ of a non-block-interchange type eventually gives a reversal/blockinterchange scenario.Note that in that case the number of circular chromosomes in a scenario  its scoreis also the number of block interchanges. So the goal will be to get progressively rid of all block interchanges and arrive at a reversal scenario. First, if for a block interchange  p  p+1 (both operations are DCJs), the genomes S p1 and S p+1 have an oriented component, then  p  p+1 can easily be replaced by two reversals, as a direct consequence of Result 1. Doing this yields a scenario which is distant from the initial one of at most two, and the number of circular chromosomes is deceased by one, proving the theorem. So we may assume that all block interchanges  p  p+1 are unoriented, which means the breakpoint graph of S p1 and S p+1 has only unoriented components. Let now  r and  b be a reversal and a block interchange in the scenario S. We note  the genome before the application of the first event among  r and  b , and + the genome after the application of the last one. We say that  r and  b cross if the minimal path on G  between the gene extremities used by  r contains extremities used by  b , vice-versa, exchanging  r and  b. It is easy to see that if they are consecutive and do not cross, then they commute and swapping their position yields a scenario which is distant of 3 from the original one, and has the same score (the reversal stays a reversal, the block interchange stays a block interchange). Choose now  r and  b which cross, and such that there are as few DCJs as possible between them in S. These exist because else the reversals and block interchange would act on different components, which is not possible because there is no unoriented component. From now we assume that  r is before  b , but a symmetric reasoning yields the proof for the opposite case. Suppose there are rearrangements between  r and  b. If among those rearrangements, there is a reversal which is immediately before a block interchange, then by hypothesis on  r and  b , they do not cross. So it is possible to swap them without changing the score of the scenario, nor the crossing properties of any pair or reversal and block interchange. Iteratively, applying this allows to assume that all reversals occur after all block interchanges between  r and  b .
Page: 3019 30123019
Rearrangement sampling via DCJNow  r occurs before a block interchange, and if it is not  b , then they do not cross. So it is possible to swap them. This has the effect of applying a block interchange to . As this block interchange does not cross any reversal applied before  b , it cannot change the crossing properties of reversals and block interchanges, so it is possible to repeatedly apply this procedure while there are block interchanges between  r and  b , there are only reversals left. In the same way, as  b occurs after a reversal, if it is not  r then they do not cross and it is possible to swap them without changing the crossing properties of reversals and block interchanges. After repeating this procedure there are no rearrangement anymore between  r and  b and they are immediately consecutive. The following lemma yields the theorem in that case.
APPENDIX BIn this appendix, we prove the following theorem, showing that with a nonnegligible probability, the MCMC can diversify efficiently in the solution space of HP scenarios:
can be defined with the following properties:@BULLET The temperature of the first chain is infinite, @BULLET The swapping probability between any two consecutive chains given by Equation(7) is at least 1 2 , @BULLET The probability of a HP scenario in the target distribution of the k-th chain is at least 1 2 .The first property provides that all most parsimonious DCJ scenarios are equally probable in the target distribution of the first chain. We proved (Mikls,I. and Tannier,E., manuscript in preparation) that it is easy to sample from this distribution with Markov chains, and if the genomes are co-tailed, exact sampling is also possible (). The second property provides that the information change between the parallel chains is not negligible. The third property provides that a few samples from the k-th chain is sufficient to get HP scenarios. Although these together do not prove fast mixing of our method, it is definitely takes us closer to a final proof. The theorem is proved using the following lemmas. Lemma 2. For any most parsimonious DCJ scenario S between and ,Proof. Since and are linear, circ() = circ() = 0. |circ( ) circ(/)|1 for any genome , thus c(S) is maximal, if the number of circles increases till the middle of the path, and then decreases. Since the maximum length of the path is n1, Equation (10) immediately holds.
Lemma 3. The number of most parsimonious DCJ scenarios between and is at most (4n 2 n) n1 .Proof. n genes have 2n extremities, forming at most 2n telomeres and adjacencies. There are at most two DCJs acting on a given pair of telomeres and/or adjacencies, having an upper bound of 2 2n 2 DCJs acting on a pair of telomers/adjacencies. Above these, there are fissions involving one adjacency. The number of them is at most n, thus the number of DCJs applicable for a genome with n genes cannot be more than 4n 2 n. The length of a most parsimonious DCJ scenario is at most n1, thus the number of most parsimonious DCJ scenarios is a most (4n 2 n) n1 .The following lemma sets the largest temperature we need.
Lemma 4. If the inverse of the temperature of the Markov chain is greaterthan (n1)log(4n 2 n), then the probability of the HP scenarios is at least 1 2 in the target distribution. Proof. c(S) is at least 1 for any non-HP path, thus the probability of any non-HP path is at least (4n 2 n) n1 times smaller than that of a HP path. Since there are less than (4n 2 n) n1 times more non-HP paths than HP paths, the probability of the HP paths in the target distribution is at least 1 2 .The following lemma tells what difference between the temperature of neighbour chains is necessary for a swapping probability greater or equal than 1 2 .Lemma 5. If the difference between the inverse temperatures is 4log2 n(n2) , then the swapping probability given byis at least 1 2. Proof. Let c denote the difference between c(R i ) and c(R i+1 ) and let. Equation (7) can be simplified as min 1,e cTSince c is at most n(n2) 4 , the swapping probability is at least 1 2 .
B.1. Proof of Theorem 3We set the temperature of the first chain to infinite, as prescribed, and the temperature of the i+1 st chain asThe swapping probability between two chains will be at least 1 2 , based on Lemma 5. The chain with index, and thus, the probability of the HP scenarios in its target distribution is at least 1 2 .
The Author 2010. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oup.com at :: on August 31, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
at :: on August 31, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
yeast species, even if the ratio between the two is biased because of a reconstruction of an ancestral genome with 27 contiguous ancestral regions, which are probably fused into 23 or 24 proto-chromosomes in reality. The reversal/translocation ratio is surprisingly variable, the human lineage evolving mainly by reversals, whereas in mouse, as in yeasts, reciprocal translocations are the dominant mechanism. If we count one break for a fission, one for a translocation and two for reversals and reciprocal translocations, we arrive at a breakpoint reuse rate of 1.46 for the human branch, and 1.59 for the mouse branch. Such a rate, which can have consequences on the construction of models of structural evolution, cannot be analysed on its own, its significance depends on the sizes of the chromosomal regions affected by the rearrangement breakages, thus on the properties of the constructed orthology blocks. Such an analysis is beyond the scope of this article, which nevertheless provides a way to have a good estimation of this value. 5 DISCUSSION The estimation of rates of different rearrangements, as well as the breakpoint reuse rate, are important to devise a model of genome structural evolution, just like the estimation of a substitution matrix is necessary to use a model of nucleotide or amino acid sequence evolution. Up to now, most models are limited to one kind of rearrangements, or provide only parsimonious solutions, giving an equal probability to any kind of event. The analysis of rearrangements for distant species is thus rarely possible. We arrived at estimations of the ratio of different kinds of rearrangements, showing that fusions and fissions are usual modes of evolution in mammalian genomes, but not in yeasts. Reversals are also much more frequent in mammals, compared with translocations. However, non-reciprocal translocations, called telomeric translocations in Gordon et al. (2009), are quite frequent in both taxa. The significance of the breakpoint reuse rate for refuting or not the Random Breakage Model is beyond the scope of this study, which can however propose a solution to the problem of its computation. These observations of different rates for different types of rearrangements, or the possible preferential usage of some breakpoints might be included as parameters in a more general model in a future work. We could also use this kind of work to test the hypothesis that non-HP DCJ, with or without immediate reincorporation of circular chromosomes, are indeed rare or irrelevant, by sampling from low but non-zero temperature, and compute the probabilities of the inferred scenarios. We leave this large debate to a future work.
