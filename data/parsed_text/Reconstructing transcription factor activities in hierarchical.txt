Motivation: A knowledge of the dynamics of transcription factors is fundamental to understand the transcriptional regulation mechanism. Nowadays, an experimental measure of transcription factor activities in vivo represents a challenge. Several methods have been developed to infer these activities from easily measurable quantities such as mRNA expression of target genes. A limitation of these methods is represented by the fact that they rely on very simple single-layer structures, typically consisting of one or more transcription factors regulating a number of target genes. Results: We present a novel statistical inference methodology to reverse engineer the dynamics of transcription factors in hierarchical network motifs such as feed-forward loops. The approach we present is based on a continuous time representation of the system where the high-level master transcription factor is represented as a two state Markov jump process driving a system of differential equations. We solve the inference problem using an efficient variational approach and demonstrate our method on simulated data and two real datasets. The results on real data show that the predictions of our approach can capture biological behaviours in a more effective way than single-layer models of transcription, and can lead to novel biological insights.
INTRODUCTIONUnraveling the regulation mechanisms of gene expression is a fundamental problem in systems biology. Recent years have seen tremendous advances towards this goal, driven by technological advances in experimental techniques as well as a systematic application of mathematical modelling. High-throughput techniques, such as microarrays and chromatin immunoprecipitation (ChIP), have uncovered much important information on gene expression profiles and the architecture of biological transcriptional networks. Combining this information in predictive mathematical models can yield precious insights in the way biological systems work. Nonetheless, in order to understand and predict mechanistically the behaviour of a transcriptional control system, * To whom correspondence should be addressed. an understanding of the dynamics of transcription factors' (TFs) response to environmental signals is essential. Nowadays, an experimental measure of TFs activities represents a challenge, since TFs are often present at very low concentrations and they are frequently post-transcriptionally regulated through allosteric changes. This motivated many groups to develop quantitative statistical models in order to infer activities of TFs by combining mRNA expression measurements of their target genes with data about the architecture of the regulatory network, usually obtained from ChIP-on-chip experiments. Broadly speaking, two different classes of approach have been proposed: simplified models of large transcriptional networks and detailed kinetic models of small subnetworks. The first type of models are usually discrete time models that use log-linear approximations to infer the activities of hundreds of TFs from thousands of target genes (). While recent advances () can model non-linear interactions between transcription factors on a genome-wide scale, these models are still unable to capture the dynamics of gene expression, and rely on steady-state assumptions. While these models do provide useful insights in biological processes (), their simplified nature means that many of the subtleties of regulation will inevitably be lost. The other class of approaches, to which this work belongs, adopts a more realistic model of the dynamics of transcriptional regulation based on ordinary differential equations (ODEs) and then infers the profile of the TFs directly from a continuous time representation of the system. This more faithful representation of the regulatory mechanism, however, comes at a higher computational cost so that inference in this class of models has so far been possible only on restricted transcriptional networks with simple single-layer architectures. In particular, all methods we are aware of consider simple networks with a single layer of unobserved TFs. In most cases, inference is restricted to the singleinput module (SIM) network motif, which is composed of a number of target genes regulated by a single TF () or at most a few TFs that jointly regulate a number of target genes (). While these simple models constitute a strong proof of principle of the methodology, and may indeed be useful in specific situations (), many important information processing functions in cells are carried out through hierarchical motifs which entail multiple stages of transcriptional regulation. In this article, we present an ODE-based inference methodology for the most fundamental hierarchical transcriptional network
A.Ocone and G.Sanguinettistructure, the feed-forward loop (FFL) network motifs. These network motifs consist of a master TF that directly regulates (transcriptionally) a slave TF; both master and slave TF then control the expression of (a number of) target genes, possibly with non-linear interactions at the target promoters. They are frequently encountered in transcriptional regulatory networks due to their robustness and important functions in biological signal processing, such as filtering biological noise fluctuations (). Predicting the dynamics of these fundamental circuits is trivial if we know the parameters of the models and the activity profile of the master TF. Solving the reverse problem of inferring the master TF activity and model parameters from observations is instead difficult, due to the inevitable non-linearities in these circuits. We use the variational Bayesian approach for approximate inference in continuous-time stochastic processes (), using a two state Markov jump process as prior distribution over the master TF activity (). The slave TF is assumed to be transcriptionally regulated and we use a logical approximation so that it becomes active when its concentration crosses a critical threshold (inferred from the data). We test the model extensively on simulated data to assess its identifiability, reporting accurate continuous time inference of TFs activities, good fitting to data and parameters estimation. We then apply the model on two real datasets: a study of the tumour suppressor protein p53 (), which was previously used as a benchmark for ODE-based inference models (), and a timecourse experiment of Escherichia coli undergoing a transition from aerobic to anaerobic environment (). We show that our approach can be more effective at predicting independent validatory experiments than existing single-layer approaches, as well as being a useful tool for producing novel testable biological hypothesis.
MODEL AND METHODSWe consider a FFL consisting of a master TF (whose binary activity state 1 is denoted as ), a slave TF (whose protein expression we denote as x) and a target gene whose mRNA expression we denote as y. The regulation of the target gene is given by a combination of master and slave TFs activities through a logic OR or AND gate. A graphical representation of the network is given in. Usually, the master TF functions as a1 A binary representation for both master and slave TF activities is motivated by the fact that transitions between protein states are very rapid (). sensor for environmental signals; to enable rapid reactions, many TFs have evolved to function as binary switches (active/inactive) triggered by fast post-translational modification (e.g. a phosphorylation) (). We can capture the switch-like behaviour of the master TF by modelling it as a two state Markov jump process (telegraph process) (). In contrast, we assume that the slave TF is transcriptionally regulated, so that its activity is a (non-linear) function of its protein abundance. To allow for saturation effects, we model the regulation of the target gene by the slave TF by a logical function of the slave TF's protein (). Mathematically, the model with OR gate is described by the following equations 2 :dyHere represents the Heaviside step function and c represents a critical threshold of slave TF protein concentration, such that its regulatory effect becomes important only when its mRNA concentration exceeds c. Equation(1) refers to the regulation of the slave TF protein x by the master TF. Here, (t) is the activity of the master TF, given a telegraph process prior; A 1 is the sensitivity of the gene encoding x for the master TF; b 1 and  1 represent the basal transcription rate and decay rate of the slave TF x, respectively. In practice, we seldom have access to protein measurements of the slave TF, so we will use its mRNA concentration as a proxy for its protein concentration. This is a potentially fraught assumption, as it effectively assumes that the slave TF is transcriptionally regulated and that the protein equilibrates fast compared with the sampling interval in our experimental design. These assumptions are not always met but can be sometimes justified, if only as a rough approximation in the absence of better data. Equation (2) is similar to the Equation (1) but it contains an additional term A 2represents the binary activation state of slave TF. The model can perform both activation or repression over the three edges of the FFL motif, depending on the value of sensitivity parameters A i. In addition, it can collapse into a SIM network motif when the parameter A 2 is null. In the AND gate FFL, the TF inputs on the target gene are multiplied. In this case, Equation (2) of the model is described by dy(t)Also the AND gate FFL can collapse into a SIM if the threshold c is null, with y becoming a target gene only of the master TF. Mathematical simulation of the above ODEs is trivial given the profile of the master TF and the model parameters. The problem we wish to address is the reverse problem: given mRNA observations of both the target gene and the slave TF, can we reconstruct both master and slave TF activity profiles (state inference) and the parameters of the model (parameters estimation)? This is an analytically intractable problem due to the strong non-linearity introduced by the Heaviside function in Equations (2)and(3); we next describe an approximate procedure that can effectively and efficiently handle the problem. Briefly, we compute an approximate variational free energy by introducing two main approximations: the posterior process for the master TF is assumed to be Markovian, and the induced process on the slave TF is approximated as Gaussian using a Laplace-type approximation. This enables us to derive a gradient for the free energy, which can then be used in a gradient descent algorithm.
InferenceThe telegraph process representing the activity of the master TF is a continuous time stochastic process that switches with transition rates f  (t)
Inference in hierarchical network motifsbetween an ON state and an OFF state. The single time marginal, which represents the probability to be at a given time point in a certain state, is given by the following master equation:where p 1 (t) and p 0 (t) represent the marginal probability that at time t the process is in ON and OFF state, respectively. Notice that by means of the telegraph process we have turned our model, described by deterministic ODEs, into a stochastic model that can be studied in terms of probability distributions. We assume we have mRNA observations corrupted by i.i.d. zero mean Gaussian noise. In particular, the probability to observe the valu y i if the true value is y i is given byThe same noise model (possibly with different noise variance) is assumed also for the slave TF mRNA observations,  x. By means of Bayes' theorem, we combine the prior distribution over the master TF with the likelihood, in order to compute the posterior distribution of the process  0:T , given the observationsxobservations observationsx andyand andy:This defines the posterior distribution of the master TF activity for all time points ( 0:T ) as a measure over the space of continuous time paths of the  process. However, as remarked above, direct computation from Equation(7) is not possible; we adopt a variational approach to solve the problem. Variational inference is widely used in machine learning (): it relies on a lower bound on the log marginal likelihood to find the optimal approximate posterior within a given family of processes. In our case, the family of approximating processes will be the family of inhomogeneous telegraph processes; we will denote the transition rates of the approximating telegraph process as g  (t), emphasizing their dependence on time. It can be shown that the variational approximation is equivalent to minimizing the KullbachLeibler (KL) divergence of the approximating process q( 0:T ) with the true posterior p( 0:T ):The KL divergence is a functional of the transition rates g  of the approximating process, which in turn determine its single time marginals by Equations (4) and (5). The state inference problem, therefore, turns into an optimization problem (in an infinite dimensional space). In addition, since the KL divergence is also a function of the model parameters, parameter learning can be easily done through optimization. Therefore, state inference is carried out in parallel with parameters estimation. It is possible to include prior distributions for the parameters as well to obtain a fully Bayesian (approximate) inference framework; however in the following, we will place a prior distribution only on the critical threshold c, for which we define a Gaussian prior distribution centred at half of x gene expression.
OptimizationBy plugging Equation (7) into the KL divergence (8), we obtain the following expression:+KL q||p prior +lnZ .The second term on the right-hand side of Equation (9) represents the KL divergence between two telegraph processes: the KL divergence between two general Markov jump processes has been derived by Opper and Sanguinetti (2007), and it can be easily computed in terms of process rates and single time marginals of the approximating process. The difficulty lies in computing the likelihood terms in (9): these contain the first and second moment of both the variables x(t) and y(t) under the marginals of the approximating distribution q((t)). It is important to remark that an exact minimization of the KL functional is impossible as it would involve calculating intractable expectations of the Heaviside function(which arise in the likelihood terms involving the target mRNA y). These, in principle, involve computing all the moments of the slave TF x. In practice, we resort to a Laplace-type approximation assuming that x(t) is normally distributed, so thatIn practice, in order to minimize Equation (9) with respect to g  , it is more convenient to work in an extended space where the KL divergence is considered to be a functional of the single time marginals q(t) also. Naturally, process rates and single time marginals are not independent, but they are linked by the master equation. Furthermore, the KL divergence is a functional of the first and second moments of the observed slave gene (x and x 2 ) and target gene (y and y 2 ) as well. These moments are also related to transition rates g  and single time marginals by a number of ODEs. So the problem turns into a constrained optimization problem. This can be solved by adding Lagrange multipliers to the KL divergence and performing an efficient gradient descent method based on solving ODEs forward and backward in time. The derivation of the optimization method is given in the Supplementary Material. Parameter estimation is obtained in parallel through the same strategy.
Heaviside step momentsFor the inference in FFL models, we have to consider y(t) and most of the problems arise from the presence of the Heaviside step function. In order to compute the expectation of y(t) under the approximating process q(t), we have to compute the expectation of the Heaviside step function. This is a non-trivial problem, since the argument of the Heaviside step function contains x(t),which in turn contains the whole history of the stochastic process (t). We address the problem by considering that the Heaviside step function is a deterministic function whose values belong to {0,1} depending on the sign of its argument being negative or positive, respectively. Therefore, the expectation of the Heaviside step function is the cumulative distribution function:We can use a Laplace-type approximation for the distribution of x(t) giving Equation (10). In other words, we have approximated the probability density function of x(t),), as a Gaussian distribution with first moment and variance of the process x(t), as its mean and variance, respectively. The rationale behind this approximation is that the process x(t) is proportional to a sum over many steps of the stochastic process (s) [see Equation (11)]. As a consequence of the central limit theorem, the probability distribution over x(t) tends to be Gaussian with the increase of the switching rate. By means of this approximation, the expectation of the Heaviside step function can be computed through the error function. For the first moment of y(t) in the AND gate FFL, the situation is even more complex since we have to compute the expectation of the quantity
A.Ocone and G.SanguinettiAnother expectation that is needed is the autocorrelation function of the processdecreases exponentially with time interval t s and decay constant  1. As a consequence, since the Heaviside step function codomain is defined in the range {0,1}, we can assume thatwhere we have used the short notation t and s foris known; therefore, it is possible to evaluate the accuracy of the inference not only for the master TF activity (t), but also for the slave TF activity. Parameter estimation is performed in parallel with state inference during gradient descend optimization. However, the critical threshold c is harder to evaluate, as it appears within the non-differentiable function. Therefore, we learned the critical threshold off-line, by selecting the value that minimizes the variational free energy among a set N c of discrete values used to run different simulations.shows the inferred posterior master () and slave () TF activities, compared with the true TF activities. The posterior slave TF activity is defined asAs can be observed, the method gives an excellent reconstruction of both TF activities, with a precise prediction of the correct transition times and an appropriate switch-like behaviour.and D show the posterior first moment of x and y, with observations. Again, the model gives a credible fit to the data, giving confidence that a good optimum of the free energy has been reached.and run our algorithm (which assumes Gaussian noise). In our experiments, we found that this did not make a significant difference, and the model was still capable of giving a good reconstruction of TF activity (see Supplementary Material).
Inference of p53 activity in human leukaemia cell lineCopyeditedWhile a careful selection of the p53 target genes may moderate the problem (), we are interested in testing whether the discrepancy may arise from model inadequacy. In particular, it is known that p53 belongs to a modified FFL where another important transcriptional regulator, E2F1, controls the expression of p53 and directly common p53 targets (). This represents a FFL where E2F1 is the master TF and p53 is the slave TF (). The target genes are DDB2, p21, BIK, a subgroup of the genes used inwhich are regulated by p53 and E2F1 (); in addition, we use the apoptotic genes PUMA, SIVA and the gene DRAM, involved in the process of autophagy, regulated again by both p53 and E2F1 (). 3 We infer the activity of both E2F1 and p53 from the observation of the expression of these common target genes and p53 itself. We run two different simulations, first using only the SIM part of the model to infer the activity of p53 from its target genes and then using the whole FFL model with also another SIM part regarding other genes (MCM5, MCM7, LIG1) regulated only by E2F1 (). In the former case, the p53 activity is qualitatively similar to the one predicted by). On the contrary, inclusion of the FFL structure leads to a completely different prediction of p53 activity, which fits the experimental measure much better (). Inference of E2F1 is also obtained but it is not as interesting as the posterior p53 activity, since we do not have an experimental validation for it. Instead, it is interesting that, on this particular real biological dataset, both an AND and an OR FFL seem capable of fitting the data reasonably (no strong evidence was found using standard model selection heuristics such as BIC or AIC). Experimental evidence derived from a knock-out of p53 shows that the common target genes of p53 and E2F1 are still activated, indicating that master TF E2F1 and slave TF p53 cannot be combined into a pure AND gate (). It is important to remark that the assumption that the activity of the slave TF is transcriptionally regulated is violated in this case: in fact, it isknown that p53 activity is post-translationally regulated by multiphosphorylation () and E2F1 does not directly affect the transcription of p53. Nonetheless, E2F1 directly regulates the transcription of other genes that either phosphorylate or interact with p53, resulting in a stimulation of its apoptotic activity. Therefore, we may assume that that E2F1's activity results in a more efficient activation of p53 protein, thus justifying the assumption that slave TF expression is a good proxy for its activity. However, the lack of a direct regulation of p53 expression by E2F1 means that the physical meaning of the parameters A 1 , b 1 and  1 is unclear in this particular case. What our results in fact show is that the inclusion of a hierarchical structure does lead to a considerable improvement in the prediction. Intuitively, this could be explained by the model using the flexibility given by the threshold parameter c to adjust the mRNA profile (in this case a suboptimal proxy) to be as close as possible to the true slave TF activity profile.
A B
Sugar foraging in E.coli during aerobic-anaerobic transitionAs a further example of the applicability of our methodology, we considered a study of the transcriptional response of E.coli during oxygen withdrawal. FFLs are particularly over-represented in bacterial transcriptional networks (). Furthermore, there is experimental evidence that during transitions E.coli adopts a nutrient foraging strategy based on hierarchical transcriptional regulation (). We therefore focus on a subnetwork composed of the cAMP receptor protein (CRP) as master transcriptional regulator, the major regulator of carbon catabolism in E.coli. Among the CRP target genes, we consider three genes (manX, manY and manZ) belonging to the PEP-dependent sugar transporting PTS system. The essential function of the manXYZ operon is to make sugar substrates available for metabolism, principally through glycolysis. In addition to the positive regulation by CRP, manXYZ is subject to a negative regulation by Mlc, another global regulator of bacterial metabolism. mlc is in turn positively regulated by CRP, leading to the FFL structure shown in(). The dataset contains E.coli global gene expression measurements taken during the transition from aerobic to anaerobic condition, at initial time and four successive discrete time points (5, 10, 15 and 60 mins) (). The expression profiles of these genes, as well as the model fits, are shown in the Supplementary Material.the master TF, Mlc represents the slave TF and both regulate target genes manXYZ (here only manX is showed). Target genes of the only CRP (ppDD and agp) have been included too (). Using microarray time courses from target genes manX, manY and manZ, we infer the activity of Mlc and more interestingly the activity of CRP using an OR gate FFL. Posterior expectations give a good fit of the (noisy) target genes expressions (and B); in addition, we note that the inferred parameters A and A 1 are positive (), whereas parameter A 2 is negative, representing inhibition, which is in accordance with existing knowledge about the sign of regulation in this network. In, we show posterior activity of CRP: it is interesting to note that this activity rapidly transits to the active state and after a short interval it goes back to the inactive state. This behaviour can be rationalized using existing knowledge of the regulation of PEP by the two pyruvate kinases of E.coli, whose different temporal behaviour may induce a transient response of CRP. In any case, it directly leads to a testable prediction on the dynamics of cAMP during aerobicanaerobic transitions, which may lead to insights in the survival strategy of E.coli under stress. While this hypothesis clearly needs experimental validation, it gives a useful example of the kind of insights this type of modelling can offer.
A.Ocone and G.Sanguinetti
CONCLUSIONSDifferential equation models of gene regulation have been enormously successful in the last decade in providing a flexible predictive tool for systems biology. However, their effectiveness depends crucially on the availability of model parameters and external inputs (in the case of non-autonomous systems). Often, these are simply not available, motivating the need for integrating statistical inference tools in ODE-based methodologies. Methodologies for statistical inference in these systems are difficult to develop, but can often offer insights in the underlying biological system which are complementary to those gained by traditional mechanistic modelling. In this article, we introduced an approximate inference methodology for ODE-based models of FFLs driven by an unobserved binary TF. While FFLs are very simple structures, they can be viewed as the fundamental building block for hierarchical regulatory networks; from the methodological point of view, there are no significant conceptual difficulties to extending the proposedapproach to more complex multi-layer networks. Inference of TF activity in ODE-based models has recently attracted considerable attention, and several tools now exist for network motifs involving a single layer of hidden TFs (). To the best of our knowledge, similar methodologies for hierarchical networks of transcriptional regulators have not been previously reported; given the importance and frequent occurrence of these motifs, the lack of methodology for inference represented a significant obstacle to the adoption of statistical methodologies in ODE-based models of biological networks. Our contribution means that inference methods are now available for all the fundamental building blocks of transcriptional networks. While we view our contribution as mainly methodological, application to two real datasets shows the potential for this type of methodology to yield consistent predictions and to lead to testable hypotheses in biology. From the methodological point of view, our method belongs to the class of deterministic variational approximate inference techniques, which originated in the statistical physics literature and have been widely used in the machine learning community in recent years (). While these provide often accurate and efficient estimates of the posterior statistics of interest, they are inherently biased by the choice of family of approximating processes (in our case, Markovian processes). An unbiased alternative would be to resort to stochastic approximations such as Markov chain Monte Carlo. While these have been used successfully in stochastic processes with continuous state space (), it is not obvious how to derive an efficient sampling strategy for a highly non-linear hybrid model as the one we consider here. There are several further avenues of research in which this work can be extended. Inference in stochastic models of gene regulation, which are capable of capturing the intrinsic fluctuations of fluorescence data, are at the moment only available for SIM architectures (), and it would be important to
A B C D
Inference in hierarchical network motifsextend them to the FFL case. Extrinsic noise sources contributions have also been considered in a Bayesian inference model of gene regulation (). A linear noise approximation is adopted to deal with the mesoscopic nature of the observed fluorescent data. For the different levels of gene expression, they perform a noise analysis, which would be even more relevant but not straightforward for a hierarchical model such as the one presented here. Another important direction would be to remove the use of the slave TF mRNA as a proxy for its active protein concentration. This is in principle straightforward in the case when the regulation is purely transcriptional (so that the difference between mRNA and protein profile is entirely due to the difference in half-life between protein and mRNA), and can be done by introducing a simple model of translation ().
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
Our definition of OR gate is slightly different from the usual Boolean one; we use OR as a synonym of linearly additive response.
As a first real dataset, we tested our model on the p53 prediction task, which has been already tackled by a number of authors with ODE-based models using a SIM architecture (Barenco et al., 2006; Lawrence et al., 2006). This dataset focuses on the tumour suppressor protein p53. Data were obtained from three independent replicates and represent gene expression at seven discrete time steps from an irradiated human leukaemia cell line. After the irradiation, tumour suppressor protein p53 increases its activity in order to trigger genes whose function is to protect the cell and eventually induce its apoptosis. An attractive feature of this dataset is the existence of a (semi-quantitative) experimental measure of the p53 activity, through a western blot analysis; this allows us to validate, at least qualitatively, the predictions of the model. We compare our predictions with results obtained by Barenco et al. (2006) using their HVDM model, which pre-supposes a SIM architecture; results using different inference methodologies (but still a SIM architecture) do not differ qualitatively (Lawrence et al., 2006). Previous models based on a SIM structure could not reproduce the p53 experimental measurements (Barenco et al., 2006; Lawrence et al., 2006), predicting a decrease of the p53 activity after about 5 h time, rather than the experimentally measured 10 h time. To explain the discrepancy, an unknown mechanism of migration of a part of the p53 protein from the nucleus to the cytoplasm was postulated, but no experimental evidence is available to support this mechanism.
Other apoptotic and non-apoptotic genes mentioned in Polager and Ginsberg (2009) have not been included due to their highly noisy expression profiles.
