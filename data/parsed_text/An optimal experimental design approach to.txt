Motivation: Finding suitable models of dynamic biochemical systems is an important task in systems biology approaches to the biosciences. On the one hand, a correct model helps to understand the underlying mechanisms and on the other hand, one can use the model to predict the behavior of a biological system under various circumstances. Typically, before the correct model of a biochemical system is found, different hypothetical models might be reasonable and consistent with previous knowledge and available data. The main goal now is to find the best suited model out of different hypotheses. The process of falsifying inappropriate candidate models is called model discrimination. Results: We have developed a new computational tool to compute optimal experiments for biochemical kinetic systems with underlying ordinary differential equation (ODE) models for the purpose of model discrimination. We were inspired by the demands of biological experimentalists which perform one run measurement where perturbations to the system are possible. We provide a criterion which calculates the number and location of time points of optimal measurements as well as optimal initial conditions and optimal perturbations to the system. Availability: The model discrimination algorithm described here is implemented in C++ in the package ModelDiscriminationToolkit. The source code can be downloaded from
INTRODUCTIONTypically, before the correct model of a biochemical system is found different hypothetical models might be reasonable and consistent with previous knowledge and available data. Let us assume that all the models have in common that they fit one initial series of measurements. The main goal now is to find the best suited model out of different hypotheses. This is usually done by iterative measurements and successive fitting of the different models to the * To whom correspondence should be addressed. collectivity of all series of measurements. This is repeated until all 'wrong' models do not fit to the collectivity of all series of measurements any more. Thus, the 'wrong' models are iteratively falsified. The whole process is called model discrimination. To discriminate a set of candidate models against a given set of experimental data often likelihood ratio tests based on bootstrap methods are preformed (see e.g.). Ranking methods like Stewart's method () or the well-known Akaike information criterion (see e.g.) are popular as well in the field of biological modeling. Applications can be found, for example, inor Bernacki and Murphy (2009). This article deals with the problem of designing experiments so that these methods can be applied in an optimal sense. This fundamentally differs from the case of finding an experimental design to best estimate the parameters of a model for a given experimental system (see e.g.). An overview of different experimental design techniques can be found in Kreutz and Timmer (2009). Different approaches to design experiments for model discrimination exist. Beside optimization methods (see e.g.), a model-based feedback controller (see e.g.) and Markov chain Monte Carlo sampling methods () are used to construct an appropriate design. We have developed a new computational tool to compute optimal experiments for biochemical kinetic systems with underlying ordinary differential equation (ODE) models for the purpose of model discrimination. We were inspired by the demands of biological experimentalists who perform one run measurement where perturbations to the system are possible. We provide a criterion which calculates optimal measurement time points instead of a continuous design (see e.g.;). The theory of the new criterion is presented in Section 2. In Section 2.1, we give a brief overview of KullbackLeibler (KL)-optimality introduced by Lpez. In Section 2.2, we derive our optimality criterion by use of KL-optimality. In Section 2.3, we present the numerical implementation of our optimal design algorithm. Numerical results on allosteric models for glycolytic oscillations are presented in Section 3. We provide Supplementary Material for more details on theory and applications.
D.Skanda and D.Lebiedz
DISCRIMINATION BETWEEN DYNAMIC BIOCHEMICAL MODELS
KL-optimal designIn this section, a model discrimination criterion based on the KL distance called KL-optimality introduced by Lpez-Fidalgo et al.is briefly presented. Lpezdemonstrate that KL-optimality is consistent with T-optimality () and generalized T-optimality (UcinskiUcinski and), which are well-known model discrimination criteria. The advantage of the KL-optimality criterion is that it does not depend on the general non-linear regression models y 1 and y 2 with corresponding candidate Models 1 and 2where the random variables are independent and normally distributed with zero mean and constant variance The KL distance is a non-symmetric measure of the difference between two probability distributions. The integral is computed over the sample space of the possible observations. If the probability space is discrete the integral changes to a sum. As reviewed by, the KL distance is closely related to likelihood ratio tests. Considering f 1 (y,x, 1 ,) as being a null hypothesis H and f 2 (y,x, 2 ,) being the alternative hypothesis A, the log likelihood ratio is defined asIntuitively, one expects (y) to have a high value if A is true and both probability distributions are reasonably well separated. The NeymanPearson lemma [a proof is given injustifies the optimality of the likelihood ratio critical regionwith respect to Type I and Type II errors. We denote P H (W ) as the probability of the region W under the assumption that the null hypothesis is true. By setting u such that P H (W ) = , one can use W as a critical region to reject H by applying the likelihood ratio test. The NeymanPearson lemma states that this critical region is superior to any other W * with respect to the Type II error, i.e.where P A (W ) is the probability of W if the alternative hypothesis A is true. For this critical region W , one can see that the Type II error is as much smaller as the mean with respect to A of the likelihood ratio (y) is bigger.The mean with respect to A of the likelihood ratio (y) is given bydy.Therefore,) which directly leads to the KL-optimality criterionwhere  denotes the set of all experimental conditions subject to optimal design.
Mathematical construction of the optimal experimental designIn the following section, we use the framework of the KL-optimal design to derive an optimization criterion which is constructed to best fit the needs to discriminate between models of kinetic time series experiments often performed by biologist, e.g in vitro experiments of enzyme kinetics. In most situations such experiments are time and cost consuming. Therefore, one wants to get the most information out of a single experiment taking place within a given fixed time span. This means that in an optimal experimental design the most informative measurement time points for one measurement run have to be calculated in such a way that only one measurement at one time point can be performed. Often, an experiment cannot produce measurements in a time continuous way. Therefore, we assume that there has to be a minimal time t for the separation of measurement time points. Additionally, the initial species concentrations of the participating species should be chosen in a most discriminating way. A commonly used in vitro practice is to disturb time series measurements by external adding of species quantities. In the context of model discrimination, one wants to know the optimal time point of perturbation and the optimal species quantities, which should be added to the experimental system. We further assume that a measurement cannot be done at the same time as a perturbation. Given the measurement time-vector t  R N + with entries for the N measurement time points t i ,i  1, ... ,N such that t i+1  t i , the model response vectors
.. ,N} are the solution of the ODEs, ... ,N.The vectors c i denote species quantities the experimental system gets perturbed with. f rhs 1,2 are the right hand side functions of the ODEs of both models. y 0 1,2 := y I denotes the initial species concentration y I which is the same for both models. The vector y t i denotes the species concentration of a measurement at measurement time point t i. By assuming normally distributed error vectors i 1 and i 2 with zero mean and variance functions () 2 according to models 1 and 2 one gets for the regression modelsPage: 941 939945
Optimal experimental design approachthe two model probability distributions f 1 for model 1 and f 2 for model 2 for one measurement time point) 2 and the number of species concentrations M. We allow for different error models for both candidate models. The error model is dependent on the species concentrations y i 1,2 , the time t i and possibly on parameters  1,2. For the sake of simplicity we defineWith this notation one gets both the probability distribution models for all N measurement time pointsHowever, by assuming such a model probability distribution one does not prohibit that at one time point several measurements can be performed. To overcome this problem, we first extend the probability space R M i (where M is the number of species) of the i-th measurement by a one state set N i to R M  N i .The state of the set N i with P N i denotes the probability that no measurement is performed. Then, we introduce the Heaviside functions ,, * : R + (14)withBy use of these Heaviside functions, we define the new model probabilitiesfIn this case * (t i ) is the probability P N i that no measurement is performed at the i-th measurement time. The sum over allfall allf now gives the probability density of one experimental outcome. By integrating the density one has to take care that the differentfdifferent differentf are defined on different spaces. The non-disjunct conjunction of these different spaces now defines the probability space used. By introducing these modifications, the reduced probability distribution functionsffunctions functionsf 1,2 (y) do not dependent on the measurements that are performed in less than t time after the previous measurement anymore. To take into account that a species concentration perturbation to the system can only be performed if no measurement is done, the same procedure is repeated with the Heaviside functionsThe model probabilities now are defined in the same way as above by replacing (t i ) withInserting the two probability models into the KL-optimality criterionone getsDue to the fact that log(1) = 0 this simplifies toPage: 942 939945. Switching functions: the left switching function is used to guarantee that only one measurement is done at a time point, the right one is used to guarantee that if a perturbation is done at a time point no measurement is done at the same time point.
D.Skanda and D.LebiedzBy inserting the normal distribution this further simplifies toA detailed derivation can be found in the Supplementary Material. This criterion has to be maximized with respect to the initial concentrations y I , the measurement time points t and the system perturbations c. For our optimal experimental design, we generally start with more measurement time points than needed. By use of the step functions, the number of measurement time points gets reduced in the sense that for t i <<t the corresponding measurement time point is 'turned off'. It should be noted that the Heaviside functions can be replaced by any appropriate switching functions i.e + * = 1 and , * , e.g. continuous functions.
Numerical implementation of the optimal experimental designTo solve the maximization problem (7) numerically by applying efficient derivative-based optimizers, we replace the Heaviside functions (t i ) and (c i ) by continuous approximations, parameterized hyperbolic tangent functionsThe parameters a 1,2 characterize the width of the transition region between 0 and 1. The parameters b 1,2 determine the center of the transition region (). By setting the parameters in an adequate way, one can construct arbitrarily close approximations of the Heaviside functions. The optimization problem is formulated in a multiple shooting setup (see, e.g.). The idea of the multiple shooting method is to subdividewhere s {1,2},i denotes the multiple shooting nodes are modified toA graphical scheme of the multiple shooting setup is shown in. For simplicity, we consider the homoscedastic case with equal variances, i.e.The overall optimization problem can be stated asNumerical optimization is performed by the interior point package IPOPT () using the linear solver MA27 (). The numerical integration as well as the Page: 943 939945
Optimal experimental design approachsensitivity generation within a multiple shooting discretization is done by the CVODES integrator package (). All derivatives are calculated by automatic differentiation using CppAD ().
NUMERICAL RESULTS
Allosteric models for glycolytic oscillationsAs a test case for model discrimination, we implemented the following models describing glycolytic oscillations (). @BULLET Model 1 describes an allosteric model with positive feedback and linear product sink. The differential equations are given by@BULLET Model 2 describes an allosteric model with positive feedback in the absence of cooperativity when the product sink is represented by MichaelisMenten kinetics. The differential equations are given byThe species concentration of the substrate is denoted by  and the concentration of the product is denoted by . For both models the inflow parameter  is the same. It is regarded as known and was set to  = 0.22. It represents the inflow of the substrate to the experimental system, here a tank reactor. The parameter sets (,q,k s ,L) of Model 1 and (q,r s ,,L) of Model 2 are independent of each other and are regarded as unknown. Due to the non-availability of experimental data, we simulate data by use of Model 1. Note that  of the parameter set of Model 1 and the variance  2 are not the same. To generate a measurement we add a normally distributed error term with zero mean and variance  2 = 1 to the simulated data. The used parameter set is (8.89  10 1 , 2.16,1.11  10 1 , 1.76  10 4 ). We simulated in a time span of T = 400 with initial concentrations of  = 1.47  10 1 and  = 2.21. After 10 numerical integration time steps, a simulated measurement is generated. Both models were fitted to the simulated data to determine the model parameters as well as the initial species concentrations. The fitting was performed by standard least squares minimization implemented in the same numerical optimization framework as the model discrimination. The results of the fitting procedure are shown in
Results of model discrimination procedureWith the so generated parameter estimates of Models 1 and 2, we start the model discrimination algorithm on an overall time span T end = 400. We insert 100 equally spaced possible measurement points. The initial species concentrations to start the procedure are set to  = 15 and  = 2 and are restricted to be less than 25. The parameters of the switching function (t) are chosen as a 1 = 20 and b 1 = 10. With these parameters we expect the minimal time span between two measurement points to be bigger than 10 time steps. The parameters of the switching function (c) are chosen as a 2 = 0.05 and b 2 = 0.025. We first calculate an experimental design as the solution of problem 31 where no perturbations on the system are allowed. Therefore, the design is optimal with respect to the initial concentrations and the measurement time points. In, the situation before the optimization procedure is shown. One can easily see that the model response of Models 1 and 2 are very similar. The result after the optimization procedure is shown in. The measurement time points were reduced from N = 100 to N = 31. Both model responses are well separated. The computational time to calculate the experimental design was 52 s on one core of a Intel(R) Xeon(R) X5460 CPU with 3.16 GHz. In a second run we add at five measurement points the ability to perturb the system by adding species quantities less or equal to 10 for each species. We further restricted the sum of all initial species concentrations and species perturbations to be less than 100. The results are shown in 5b.Now both model responses are well separated over the entire time span. The number of measurement time points is reduced to N = 27. The computational time to calculate the experimental design was 118 s on one core of a Intel(R) Xeon(R) X5460 CPU with 3.16 GHz. By use of the optimal design calculated with respect to the initial species and optimal time points, we again generate data with the correct Model 1 with correct parameters according to the experimental design. After that we fitted both models coincidentally to the first generated samples and the second generated samples. In, one can see that Model 1 naturally fits both generated samples as expected. To test for a local optimum Model 2 was fitted 50 times with uniform random distributed initial values in the range offor each parameter. The best fit is shown inoptimum is the global scatter search method, see for example,. A further numerical example for the situation that the model to simulate the data is different from both candidate models can be found in the Supplementary Material.
The Author 2010. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oxfordjournals.org
at :: on August 31, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
CONCLUSION By use of the KL-optimality we derived a model discrimination criterion that might be more appropriate for dynamic time series experiments performed by biologist than the existing approaches, e.g the continuous time design (Atkinson and Fedorov, 1975; Cooney and McDonald, 1995; Kremling et al., 2004). We included optimal initial species concentrations, optimal measurement time points for a one run experiment where the time span between two measurements have to be larger than a given t and optimal perturbations to the system with respect to the perturbation time and the amount of perturbing species quantities. We further exemplified our method on a simulated example for allosteric models for glycolytic oscillations by performing the sequential run of making an experiment (a simulated one in our test case) and afterwards calculating an optimally discriminating design. After only one iteration of an experimental design, we can clearly discriminate between Model 1 and Model 2 which shows the efficiency of our method. Funding: Freiburg Initiative for Systems Biology (FRISYS); the Freiburg part of the BMBF FORSYS systems biology initiative; Freiburg excellence cluster Centre for Biological Signalling Studies (BIOSS). Conflict of Interest: none declared.
