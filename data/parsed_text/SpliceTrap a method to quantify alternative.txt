Motivation: Alternative splicing (AS) is a pre-mRNA maturation process leading to the expression of multiple mRNA variants from the same primary transcript. More than 90% of human genes are expressed via AS. Therefore, quantifying the inclusion level of every exon is crucial for generating accurate transcriptomic maps and studying the regulation of AS. Results: Here we introduce SpliceTrap, a method to quantify exon inclusion levels using paired-end RNA-seq data. Unlike other tools, which focus on full-length transcript isoforms, SpliceTrap approaches the expression-level estimation of each exon as an independent Bayesian inference problem. In addition, SpliceTrap can identify major classes of alternative splicing events under a single cellular condition, without requiring a background set of reads to estimate relative splicing changes. We tested SpliceTrap both by simulation and real data analysis, and compared it to state-of-the-art tools for transcript quantification. SpliceTrap demonstrated improved accuracy, robustness and reliability in quantifying exon-inclusion ratios. Conclusions: SpliceTrap is a useful tool to study alternative splicing regulation, especially for accurate quantification of local exon-inclusion ratios from RNA-seq data. Availability and Implementation: SpliceTrap can be implemented online through the CSH Galaxy server http://cancan.cshl.edu/ splicetrap and is also available for download and installation at http:// rulai.cshl.edu/splicetrap/.
INTRODUCTIONIn higher eukaryotes, a given transcribed locus can generate several mature mRNA isoforms via the process of alternative splicing (AS). AS is frequently a regulated mechanism, which coordinates the removal of the internal non-coding portions of the transcripts (introns) with the differential joining of the coding and 5 /3 untranslated portions (exons). As a result, proteins with similar, different or antagonistic activities can be generated from a single genomic locus (). In addition, AS can lead to downregulation of gene expression by diverting some of the mRNA isoforms to the nonsense-mediated mRNA decay pathway (). More than 90% of human genes express primary transcripts that undergo AS (). Owing to the regulatory power of this process, an increasing number of studies are being directed at understanding AS regulation at the single-exon level (). In general, researchers in the splicing regulation field have utilized comparative approaches to reveal tissue-specific () or disease-related () AS events. However, such methodologies have not been used to generate maps of AS activity within one cellular condition. The completion of such maps would add a higher level of resolution to transcriptome analysis, allowing precise quantification of exon inclusion levels within a population of related isoforms. Until recently, systematic analysis of AS was done using expressed sequence tags (EST) () or specialized microarrays (). These techniques facilitated the discovery of a large number of alternative transcripts, and the extraction of distinctive features of alternatively spliced exons. Nevertheless, these techniques suffer from several limitations. ESTs are subject to cloning biases especially towards the 3-end of transcriptslow coverage and insufficient robustness to allow reliable quantification. Likewise, the specificity of splicing microarrays is negatively affected by cross-hybridization with related mRNA molecules. The development of deep-sequencing technologies provided an alternative to ESTs and microarrays for transcriptomic quantification. Two recent studies utilized single-end RNA-seq to analyze a series of human tissues. In, the inclusion level of alternative exons was quantified as the percentage of the number of reads that match the two splice junctions formed by exon inclusion, over the splice junction formed by exon skipping.also utilized splice-junction reads for quantification of minor isoforms with different frequencies, as a function of the readPage: 3011 30103016
SpliceTrapcoverage or RPKM (reads per kilobase of exon per million mapped reads. Although both studies demonstrated improved coverage relative to microarrays and ESTs, they utilized only isoform-specific reads, leaving out the majority of reads, which map to common exons of different isoforms. An improved version of the deep-sequencing technique utilizes paired-end tags (), which allows a significant gain of coverage and a reduction in read ambiguity through the generation of linked tag pairs that span longer stretches of sequenced template. This technology is especially suitable for AS profiling, because many exon-mapped tags are expected to span splice junctions, and these can be exploited to improve AS quantification. Two recent methods exploit paired-end sequencing information for transcript quantification: Cufflinks (), which is based on a previous RNA-seq model for single-end reads () and Scripture (). Both can reconstruct transcript structures using directed graphs, and assign FPKM (fragment per kilobase of exon per million mapped reads) or RPKM values to every transcript, without relying on a reference genome. Cufflinks uses a mathematical model to identify alternatively spliced transcripts at each gene locus. Scripture employs a statistical segmentation model to distinguish expressed loci, and filters out experimental noise. Both methods were originally designed to identify and quantify full-transcript expression levels, but in our tests they appear not to be optimal for inferring local exoninclusion ratios, presumably due to limited transcript coverage and sequencing noise. Here we introduce SpliceTrap, a method to quantify local exon inclusion levels in paired-end RNA-seq data. SpliceTrap generates alternative splicing profiles for different splicing patterns, such as exon skipping, alternative 5 or 3 splice sites, and intron retention. It utilizes a comprehensive human exon database called TXdb (see Section 2) to estimate the expression level of every exon as an independent Bayesian inference problem. Unlike microarraybased methods, SpliceTrap relies on RNA-seq, and therefore it can determine the inclusion level of every exon within a single cellular condition, without requiring a background set of reads. We tested SpliceTrap both by simulation and real data analysis. Compared to Cufflinks and Scripture, it demonstrated improved accuracy, robustness and reliability in quantifying a large fraction of AS activity. In particular, SpliceTrap is suitable for studying changes at the single-exon levels and it can facilitate the discovery of nearby cis-regulatory elements in diverse applications. SpliceTrap can be implemented online through the CSH Galaxy () server http://cancan.cshl.edu/splicetrap and is also available for download and installation at http://rulai.cshl.edu/splicetrap/.
METHODS
Database constructionTo quantify exon-inclusion levels, we designed an exon-trio database called TXdb. First, we captured all known transcripts encoded by every human gene (and B), using annotations from RefSeq () (downloaded from the UCSC genome browser, hg18) and the EST-based AS database dbCASE (). Second, to account for every possible exon-skipping event, we subdivided each transcript set (i.e. encoded by the same gene) into exon trios, by sliding a 3-exon window along the transcript (). In particular cases in which an exon was flanked by more than one assembly of flanking exons, every possible combination was represented inwindow, we subdivided the transcript isoform population into exon trios, accounting for all known transcriptomic variability. Every exon trio is then used as an independent mappable unit, wherein the middle exon (red block) is queried for alternative splicing activity and the flanking exons (blue blocks) are treated as constitutive exons. (D) Two isoforms are constructed for each trio. Every exon-skipping event is represented by an inclusion isoform (f 1 ) and a skipping isoform (f 2 ) which comprise a pair of flanking exons (E1, E3) and an alternative exon (E2) present in f 1 but not in f 2. To examine additional types of alternative splicing, such as (E) alternative 5 splice sites, (F) alternative 3 splice sites, and (G) intron retention, we generated exon duos to compare extended isoforms to shortened isoforms. (H) SpliceTrap can detect consecutive alternative exons. When the alternative exon a or b is used as a flanking exon in an exon trio (f 1a , f 2a , f 1b and f 2b ), if it is skipped, the exon trio will not pass the coverage cutoff, and thus will not be considered to be reliable. However, if substitute exon trios are present inTXdb as a separate case. About 20% of the exons in TXdb are represented by more than one assembly of flanking exons (i.e. trios or duos). The pie charts in Supplementaryshow the types and numbers of exons represented by one or multiple assemblies. Next, we formatted the database to allow quantification of exon skipping (CA: cassette exon). We assumed that the middle exon was a cassette exonPage: 3012 30103016
J.Wu et al.(). For hg18, we counted the numbers of events that could be represented in the format of exon trio/duo. About 74.14% of the events from RefSeq accounted for single-exon AS events, all of which were covered by TXdb with a single exon trio/duo. When ESTs annotations were included, the percentage of covered events was 64.2%. It is important to note that some EST-based annotations might be of poor quality, as a result of noise in EST libraries (). In SpliceTrap, ESTs are used only as mapping references, and not as a sole means to predict AS events; in this way, EST-based predictions can be confirmed if they align with a substantial number of RNA-seq reads. In addition, 9.82% of the RefSeq AS events in AStalavista (8.96% with ESTs) could be described by combining two entries in TXdb (e.g. consecutive CAs), and 2.9% (RefSeq only) or 1.97% (ESTs included) corresponded to assemblies of three or more exon trios/duos. The rest corresponded to more complex AS events that could not be handled directly by TXdb. Complex AS events (i.e. involving two or more exon trios/duos) can be investigated by further comparing SpliceTrap quantifications. For example,illustrates two consecutive exons that are alternatively spliced. If either of them is skipped, the respective exon trios would not pass the coverage cutoff (see Section 2.3 for details). However, if annotations exist, the inclusion ratio may be quantified based on substitute exon trios available in TXdb (Supplementary). By comparing the inclusion ratios of both exons, one may detect if they are mutually exclusive or skipped together. It is important to note that the ability of SpliceTrap to detect complex AS events is limited, and depends on the availability of AS annotations to generate several trios/duos for each examined exon. For this reason, we recognize that some AS events may be overlooked, especially if they involve more than two consecutive alternative exons. The final assembly of TXdb for hg18 comprises a total of 167 445 CA candidates, of which 11 812 have CA annotation, and the remaining 155 633 are annotated as constitutive exons (CS, to be examined whether they are in fact skipped). In addition, TXdb comprises 8667 AA, 4838 AD, and 1170 IR candidates, based on annotations from dbCASE or RefSeq. All together, SpliceTrap contains 224 995 exon trios (or duos) embodying transcript variability from 182 560 human exons (Supplementary). Finally, we wish to bring to the reader's attention that since 6% of the exons in TXdb are uniquely annotated in dbCASE, a slight bias towards the 3-end of the transcript may exist, especially for AAs, ADs and IRs, which are generally unique to dbCASE (Supplementary). TXdb is available online as part of the SpliceTrap package at http://rulai.cshl.edu/splicetrap/.
A Bayesian model to estimate inclusion ratiosIn a paired-end RNA-seq experiment, a fragment is defined as a sequence segment encompassed between the first and last nucleotides of a read-pair. We assume that for each exon trio/duo, the positions of the mapped fragments follow a uniform distribution, and that their sizes follow a nearly normal distribution that depends upon the experimental protocol. Based on these assumptions, a fragment j can be described as a vector r j : (b j ,s j ), where b j and s j denote the beginning position and size of the fragment, respectively. Then, for every exon trio (or exon duo), we define the set of all possible isoforms as F ={f 1 ,f 2 }, where f 1 is an inclusion (or extended) isoform, and f 2 is a skipping (or shortened) isoform (). The lengths and the relative expression levels of these isoforms areAccordingly, the probability of observing an isoform i, given the expression level E, can be written as:Let m be the number of fragments R ={r j ,j = 1,2, ,m} that can be mapped to F. Given that for each fragment r j : (b j ,s j ), b j and s j are independent, the probability of observing r j , given an isoform f i , is:where l i is the effective length of f i (l i = L i s j +1), and P(s j ) is the probability of observing a fragment size s j in the experiment. Note that if only one end can be mapped to f i , then P(s j ) is set as 1 to ignore fragment-size information. For all isoforms in F, we can write P(r j |E) as:So for the whole data, we can write:Provided the prior distribution of E (see Section 2.4), a Bayesian posterior function can be written as:Then, we can maximize P(E|R) to estimate the inclusion ratio e 1 for every exon. Note that throughout the text we refer to P(s j ) as FSM (Size distribution Model), and to P(E) as IRM (Inclusion-Ratio distribution Model), both of which are prior distributions and will be further described in Section 2.4.
Pipeline designWe designed a simple pipeline to run SpliceTrap (). We started by mapping the read-pairs onto TXdb. For this purpose, we independently aligned every read to the inclusion/skipping isoforms in TXdb using Bowtie (). Then, the fragments unambiguously mapped to single exons were used to build a FSM (Section 2.4). To filter out poorly covered exon trios, we applied a dynamic, exon-sizedependent cutoff strategy (Supplementary). Basically, we applied different coverage thresholds to every exon, such that the size of the exon and the coverage are inversely correlated. As an extreme example, an exon that is shorter than a read would need to be covered several times to be reliable. However, very long exons may be partially covered and still be reliable. Accordingly, we filtered exon trios with poorly covered flanking exons E1 and E3, but we did not require minimal coverage for exon E2 (i.e. the exon under consideration). This filtering method is intended to reduce noise resulting from rarely expressed transcripts, truncated transcripts, DNA contamination, wrongly mapped reads, etc., while avoiding unnecessary loss of information from exons with good coverage (details in Section 3.1). Next, we maximized Equation 4 for every exon trio, utilizing all the mapped reads and the FSM to estimate the exon inclusion ratios. Finally,
Page: 3013 30103016
SpliceTrapto reduce variability noise, we corrected the results with an inclusionratio distribution model (IRM) derived from high-confidence data (see Section 2.4).
Prior information models (FSM and IRM)To generate FSMs, we took all the fragments uniquely mapped within the boundaries of constitutive exons (i.e. not spanning across splice junctions) and extracted the fragment sizes according to the positions of the reads. Finally, the occurrence of each fragment size was recorded to generate the distribution. The FSM distribution can be affected by variations in the experimental protocols. In previous studies, it was approximated as a normal distribution (); however, to increase prediction accuracy, we chose to derive the FSMs directly from the dataset under study. We generated IRMs for every type of splicing pattern separately (Supplementary). Essentially, after mapping RNA-seq data onto TXdb, we selected the highest covered exon trios (FPKM > 10) and estimated their inclusion ratios using Equation 4 (SupplementaryD). As a control, we also generated IRMs with Cufflinks (Supplementary H). Notably, the distributions were very similar with both methods. To avoid overfitting, we smoothed the IRMs by fitting beta distributions (SupplementaryL) to the histograms, which were then used in subsequent correction steps. Note that there is no specific IRM for CS, because every CS is examined as a potential CA with a CA IRM.
Metrics for accuracy testingTo test the ability of SpliceTrap to discriminate alternative from constitutive exons with inclusion ratios, we designed a series of metrics based on TXdb annotations. The assumption is that exons annotated as CA are enriched within the fraction of exons with inclusion ratio ir < 1, and conversely, exons annotated as CS are included at approximately ir = 1.Constitutive exon discovery rate (CSD): by analogy to the False Positive Rate, above a certain ir(ir < 1), all constitutive exons are false positives (the number of which is denoted by CS ir<1 ), whereas all constitutive exons at ir = 1 are true negatives (CS ir=1 ), because these are reported as constitutively spliced, then CSD ir can be written as:Specificity (SP): using the definitions above, we calculate the specificity, which is nearly the converse case of CSD:
RESULTSSpliceTrap is a tool specifically designed to detect local alternative splicing activity and quantify exon-inclusion ratios. Below, we present both simulations and data analysis demonstrating that SpliceTrap is highly accurate, reliable and robust, and we also compare it to state-of-the-art RNAseq analysis tools.
Simulation of inclusion-ratio quantificationWe carried out a simulation in order to test the accuracy of SpliceTrap compared to other methods. A series of exon trios was generated by analogy to TXdb. For every exon trio, the flankingexons (E1 and E3) were fixed to a size of 120 nt (the average exon size in TXdb) whereas the middle exons (E2) varied in size from 9 to 500 nt. For these isoforms, we set expression levels based on the distribution of inclusion ratios. We selected the IRM for CA, which is the most common AS type (Supplementary). To simulate an RNA-seq experiment, we randomly fragmented the isoforms into overlapping fragments of sizes following a N(200,15 2 ) distribution (by analogy to typical paired-end datasets), and preserved only the 75 (or 36) nt ends of each fragment as readpairs. For every exon trio, the number of reads was adjusted to achieve exon coverage between 0 and 10. All together, we ran a total of 5555 simulations with different combinations of middle-exon size and coverage per tested method. For each simulation, 1000 repeats were made, and then the Pearson correlation coefficient (PCC) and the mean absolute error between the predicted and expected inclusion ratios were calculated for accuracy evaluation. We evaluated five different methods (): a nave method based on RPKM counts alone (); Cufflinks (); Scripture (); a maximum likelihood estimation model (MLE) (SpliceTrap using uniform IRM and FSM models); and SpliceTrap. (see Supplementary Method 1.2 for the implementations of Cufflinks and Scripture). Our simulation demonstrated that SpliceTrap can outperform all the other methods, with higher PCCs and lower mean errors (). We observed that using 36 nt or 75 nt reads, the average PCC of SpliceTrap was the highest (0.830.87) compared to RPKM (0.750.76), Cufflinks (0.780.83) and Scripture (0.610.72). In addition, we noticed that by adding prior information (i.e. the full Bayesian model) we obtained better results compared to MLE alone (0.790.84) providing evidence for the contribution of the prior-information models to the estimations. A similar pattern can be found in the mean absolute errors, where SpliceTrap attained the lowest errors (0.110.13) compared to the rest of the tools (0.110.25). Next, we carried out simulations for the other three major types of AS patterns (Supplementary). We kept the same parameters, except for the IRM models, which were adjusted to each splicing type (Supplementary). In all cases, the error means and PCCs obtained were similar to those calculated using a CA IRM with 36 nt and 75 nt reads. (Supplementary), indicating that SpliceTrap can be used to investigate different splicing patterns. Notably, these simulations revealed a general association between the prediction accuracy, the size and the coverage of the exons (Supplementary). Specifically, whereas smaller exons required higher coverages, low-coverage but larger exons achieved comparable accuracies. This resulted in a power-law-shaped surface, both for the mean error and the PCC, which was independent of themethod used (Supplementary). We took advantage of this observation and designed a dynamic cutoff strategy accordingly. Using the simulation results shown in Supplementary, cutoff curves were derived at different PCCs ranging from 0.1 to 0.9 (Supplementary). For convenience, these dynamic cutoff curves are referred to as 0.1dc to 0.9dc throughout the text. Basically, for every exon in the data, we required a minimum coverage, depending on its size. Smaller exons required higher coverage, and larger exons required lower coverage. In short, this procedure should filter out most of the noise, and yet avoid unnecessary loss of exons that are partially covered, albeit by a sufficient number of reads.
Running SpliceTrap with RNA-seq dataTo experimentally test SpliceTrap and compare it to other methods, we generated more than 60 million 36 nt paired-end reads using HeLa cell RNA (see Supplementary Methods 1.1). We applied SpliceTrap to these data, using dynamic cutoffs from 0.1dc to 0.9dc (and Supplementary). We noticed that in general, the distributions of the inclusion ratios had a 'U' shape () which was also observed using Cufflinks (SupplementaryH) and in other studies based on ESTs (). This means that in the sample analyzed, the exons tended to be highly included (i.e. constitutive) or fully skipped from the transcripts. Nevertheless, a substantial proportion of the exons showed intermediate inclusion levels, regardless of the stringency of the dynamic cutoff. In addition, we noticed that the number of selected exon trios did not vary dramatically within the range of lower dynamic cutoffs (0.1dc0.6dc) although it dropped considerably above 0.7dc. Based on these observations, we selected low (0.6dc), medium (0.7dc) and high (0.8dc) stringency dynamic cutoffs for further analysis. We ran Cufflinks and Scripture on the same datasets (provided with TXdb annotations), then we used three different cutoffs: FPKM = 1, FPKM = 2, FPKM = 10 for Cufflinks; and RPKM = 1, RPKM = 2, RPKM = 10 for Scripture. For every AS candidate, Cufflinks and Scripture reported the expression levels of the inclusion and skipping isoforms. We used these numbers to calculate inclusion ratios (See Supplementary Methods 1.2 for details).
Predicting known splicing patternsWe first tested the ability of SpliceTrap and other methods to detect known splicing events. In TXdb, every exon is assigned an annotation based on high-confidence ESTs and/or cDNAs (Supplementary). Our assumption is that exons annotated as cassette (CA) should be predominantly skipped (ir < 1), whereas exons annotated as constitutive (CS) should be highly included at approximately ir =1. Based on this premise, we extracted all the exons (CA and CS) and their inclusion ratios from the above results. CS exons were examined in SpliceTrap as potential CAs using the CA IRM. Therefore, in this assay, SpliceTrap was 'blind' to TXdb annotations (CS or CA). To test the ability of the different methods to discriminate between CA and CS, we calculated the CAD, CSD and SP (see Section 2.5). Notably, for any selected threshold, SpliceTrap performed better at detecting low-included CAs, compared to the other tools (). Whereas Cufflinks and Scripture detected CAs in any ir range to a similar extent, SpliceTrap was more efficient at identifying known CAs as the ir decreased. For example, at ir = 0.5, the SpliceTrap CAD value was 0.6, and at ir = 0.1, it was almost 1. On the other hand, SpliceTrap detected CSs almost exclusively at high inclusion ratios (), with CSD values below 0.1 at ir = 0.5 and  0 at ir = 0.1. Accordingly, SpliceTrap exhibited higher specificity than Cufflinks and Scripture (), achieving levels above 0.5 for ir < 0.5. In summary, SpliceTrap quantifications appear to be consistent with previous AS annotations; that is, most annotated CSs are included at around ir = 1, whereas CAs are spread through the whole range of inclusion ratios (). Using a U-shaped CA IRM (Supplementary) as prior information may have contributed to the prediction accuracy of SpliceTrap. Also, wrongly annotated CAs/CSs in TXdb or novel AS events might have affected the accuracy of the metrics.
Robustness and reliability of SpliceTrap Weevaluated the robustness of SpliceTrap estimations to technical variability among different replicates of a same experiment. To this end, we compared the results obtained from two independent RNA-seq lanes (36-nt paired-end) generated under the same conditions. The plots comparing the two lanes, using either SpliceTrap, Cufflinks or Scripture with different thresholds, are shown in. Consistently with, SpliceTrap predicted most exons to be constitutively spliced (C). Using the stringent cutoff, 78% of the exons were included at ir  0.9 in both experimental replicates. In contrast, only 30% of the exons for Cufflinks ( F) and 23% for Scripture (I) showed ir  0.9 in both replicates. Notably, SpliceTrap could reliably reproduce the results (PCC from 0.74 to 0.77) regardless of the threshold used. In contrast, Cufflinks achieved a maximum PCC of 0.7 (), but only when using the highest threshold (FPKM = 10). In other words, Cufflinks could achieve a reproducibility comparable to that of SpliceTrap, but only at the expense of the number of reported exons. whereas SpliceTrap reported 97 068 exons at PCC = 0.74, Cufflinks reported only 11 606 exons at PCC = 0.7. Scripture performed with high reproducibility (0.830.92), however the predicted inclusion ratios were averaged around 0.5. This would signify that most human exons are alternatively spliced (), which is not in agreement with previous transcript annotations. Of note, Cufflinks achieved a high PCC in reproducing the expression levels of the inclusion (0.91) and skipping (0.81) isoforms (Supplementary), suggesting that Cufflinks has a higher robustness in detecting full transcript expression than AS.Finally, we wanted to rule out dependencies between the net expression levels and the inclusion ratios detected by SpliceTrap and the other tools. To this end, we ranked all calculated inclusion ratios from one lane in(A, D and G) according to the expression levels of the full-length exon trios reported by Cufflinks. We observed that the inclusion ratios calculated with SpliceTrap were independent of the expression levels, with a constant average rate of  0.95 (Supplementary). In contrast, the inclusion ratios calculated with Cufflinks decreased proportionally to the expression levels. The inclusion ratios calculated with Scripture were also constant; however, as in, they averaged around 0.5, meaning that most exons in the data are viewed as alternatively spliced. In conclusion, SpliceTrap can detect AS events in a more reliable and reproducible way, compared to Cufflinks and Scripture, which can be used to quantify local AS events, although with lower accuracy.
DISCUSSIONSpliceTrap is a computational tool fully dedicated to quantify major classes of AS activity based on paired-end RNA-seq data. Unlike other available tools, SpliceTrap focuses on quantifying local exon-inclusion ratios, instead of full-transcript expression levels. Rather than reporting background-based read densities, SpliceTrap utilizes Bayesian statistics to summarize exon-inclusion probabilities derived from every single read-pair. For this reason, SpliceTrap is also insensitive to transcript expression levels. SpliceTrap was specifically designed to accurately quantify alternative splicing at the single exon level. To achieve this goal, we started by describing the problem with a statistical model based on exon trios/duos, instead of full transcripts. To reduce the number of false positives and yet minimize the loss of information, we applied dynamic cutoffs derived from simulation, rather than using fixed cutoffs. Finally, we adjusted the results using specific inclusionratio models for different AS patterns. In theory, full-transcript quantification tools like Cufflinks and Scripture can also be used to calculate inclusion ratios with TXdb annotations (Supplementary Method 1.2), However, these tools were originally designed and optimized for transcript-level estimation, and our analysis indicates that they are less accurate than SpliceTrap for the specific problem of calculating exon inclusion ratios.
Page: 3016 30103016
J.Wu et al.We have shown that it is possible to approach every exon as a separate problem, and yet quantify its inclusion ratio without knowledge of the full transcript structure. Given that our quantitative units are the exons, we can disregard information from distant exons (hence reducing complexity and noise), though it is certainly important for transcript-level quantification. SpliceTrap can detect different splicing patterns. Even though the original algorithm was developed to detect single cassette exons, we have adapted it to other types of AS, such as alternative 3 /5 splice sites and intron retention. In combination, these patterns account for 75% of all known human AS events in RefSeq (). Additionally, some of the complex AS patterns involving multiple exon trios/duos were also detected by SpliceTrap (Supplementary). However, SpliceTrap's ability to detect very complex AS patterns may be limited, depending on the annotations present in TXdb. At this stage, SpliceTrap does not offer an option for ab initio exon prediction. We chose to focus on a set of 200 000 well characterized exons, and designed a transcript database (TXdb) as a mapping reference. In this way, we sought to reduce ambiguities generated by rarely expressed isoforms, especially during the mapping procedure. Because TXdb is a collection of exon trios/duos, in the future it can be expanded by adding newly discovered or predicted splice juctions, such as those derived by splice-junction mappers like TopHat, or novel exons predicted by gene-prediction tools, e.g. GENSCAN (). In this way, the depth and sensitivity of SpliceTrap can be enhanced. SpliceTrap is based on the assumption that the reads are uniformly distributed within the exon trio/duo. Although the uniformity in a small region is presumably a better assumption than in a full transcript, this factor will still bias the results and should be considered in future versions of the model. SpliceTrap's running time depends on the number of mapped reads. For instance, using a 2 GHz AMD CPU with 8 GB of memory, the running time was 3 h for one lane (202 million 36 nt pairedend reads), and 12 h for three lanes. Less than 500 MB memory and 10-30 GB of hard disk space were needed. SpliceTrap is easy to operate and requires a small number of input parameters, reducing the user's setup time. SpliceTrap also supports SUN Grid engine (SGE) qsub for parallel computing. It can be implemented online through the CSH Galaxy server (http://cancan.cshl.edu/splicetrap) or downloaded at http://rulai.cshl.edu/splicetrap/.
The Author 2011. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oup.com at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
(E2) (regardless of whether it is annotated as alternatively or constitutively spliced) and the flanking exons (E1 and E3) are constitutive exons. Accordingly, each exon trio in TXdb was represented by two sequences (Fig. 1D): an inclusion isoform (f 1 ) with all three exons; and a skipping isoform (f 2 ) comprising the flanking exons only. The first and last exons from every transcript were filtered out, because transcriptomic variability in these areas is primarily due to alternative transcription initiation or polyadenylation, rather than to AS per se. By using TXdb as a mapping database, we can approach every exon as an independent case to estimate its AS level. Based on this concept, we extended TXdb for detecting other types of AS patterns (AA: alternative 3 splice site, AD: alternative 5 splice site. IR: intron retention). To analyze AD (Fig. 1E) and AA (Fig. 1F) we compiled exon duos (rather than trios), setting f 1 as the extended isoform (spliced via the proximal splice site), and f 2 as the shortened isoform (spliced via the distal splice site). In addition, to account for IR (Fig. 1G), we defined f 1 as the intron-retaining isoform, and f 2 as the spliced isoform. To estimate the extent to which the trio/duo assemblies can capture local AS variability, we downloaded the compendium of AS events from the AStalavista website (http://genome.crg.es/astalavista/)
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
