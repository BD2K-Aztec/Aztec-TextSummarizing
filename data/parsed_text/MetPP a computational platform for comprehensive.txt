Motivation: Due to the high complexity of metabolome, the comprehensive 2D gas chromatography time-of-flight mass spectrometry (GCÂGC-TOF MS) is considered as a powerful analytical platform for metabolomics study. However, the applications of GCÂGC-TOF MS in metabolomics are not popular owing to the lack of bioinfor-matics system for data analysis. Results: We developed a computational platform entitled metabolo-mics profiling pipeline (MetPP) for analysis of metabolomics data acquired on a GCÂGC-TOF MS system. MetPP can process peak filtering and merging, retention index matching, peak list alignment, normalization, statistical significance tests and pattern recognition, using the peak lists deconvoluted from the instrument data as its input. The performance of MetPP software was tested with two sets of experimental data acquired in a spike-in experiment and a bio-marker discovery experiment, respectively. MetPP not only correctly aligned the spiked-in metabolite standards from the experimental data, but also correctly recognized their concentration difference between sample groups. For analysis of the biomarker discovery data, 15 metabolites were recognized with significant concentration difference between the sample groups and these results agree with the literature results of histological analysis, demonstrating the effectiveness of applying MetPP software for disease biomarker discovery. Availability: The source code of MetPP is available at http://
INTRODUCTIONComprehensive 2D gas chromatography time-of-flight mass spectrometry (GCGC-TOF MS) uses two GC columns connected via a thermal modulator. Compared with the first column, the second column is usually a short column with a different stationary phase and is operated at a higher temperature. The metabolites co-eluted from the first column are further separated in the second column and are directed to a time-of-flight mass spectrometer for detection. Consequently, the GCGC-TOF MS system brings more accurate and rich information about compound retention times and mass spectrum than a 1D GC-MS system, representing a powerful technique for analysis of metabolites in complex biological systems. The GCGC-TOF MS system generates a huge amount of high-dimensional data in metabolomics study that require efficient and accurate data analysis algorithms to uncover the biological information. Many data analysis algorithms have been developed to process the GCGC-TOF MS data for peak picking (), chromatogram alignment () and peak list alignment (). Guineu () is the only reported tool that uses the peak lists as its input and performs retention time correction, peak list alignment, normalization and statistical significance tests. A comprehensive review of the developed methods is given by. Compared with liquid chromatography mass spectrometry (LC-MS), the applications of GCGC-TOF MS to metabolomics were not fully explored during the past decade. One significant bottleneck limiting the usage of GCGC-TOF MS in metabolomics is the lack of accurate and comprehensive data analysis tools. We herein report a computational platform for analysis of metabolomics data generated from the GCGC-TOF MS instrument in a form of metabolomics profiling pipeline (MetPP). MetPP uses the peak lists deconvoluted from the instrument data as its input and then renders peak filtering and merging, retention index matching, peak list alignment, normalization, statistical significance tests and pattern recognition. To test its performance, MetPP was used to analyze the GCGC-TOF MS data of 30 metabolite extracts of mouse livers with spiked-in metabolite standards at different concentrations, and two groups of liver metabolite samples from mice fed different diets. MetPP was developed using MATLAB (The Mathworks, Natick, MA, USA), and its source code is available at http://metaopen.sourceforge.net. *To whom correspondence should be addressed.
METHODS
Materials
Spike-in samplesA total of 30 spike-in samples were analyzed on a LECO Pegasus 4D GCGC-TOF MS instrument (LECO Corp., St. Joseph, MI, USA). The sample set was composed of five sample groups, i.e. G10, G20, G40, G50 and G80, with six samples per group. All samples in the five sample groups had the same amount of metabolite extract from mouse livers. All six samples in the same sample group had the same amount of the 28 spiked-in metabolite standards (Supplementary), but amounts were different among the sample groups with concentration ratio of C G10 :C G20 :C G40 :C G50 :C G80  1:2:4:5:8.
Mouse liver samplesFour-week-old male C57Bl/6J mice were fed AIN-76A purified diet for 1 week before initiating feeding with either low-fat diet (LFD; 13% fat in calories) or high-fat diet (HFD; 42% fat in calories) for 10 weeks, as described in our previous study (). This study evaluated six mice fed the LFD and five mice fed the HFD. For termination, mice were anesthetized with ketamine/xylazine (100/15 mg/kg, i.m.). Portions of liver tissue were frozen immediately in liquid nitrogen. Metabolites were extracted from mouse liver using solvent methonal:water (v:v  4:1). Details of chemicals, sample preparation (spike-in samples and liver samples), GCGC-TOF MS analysis and instrument data analysis using ChromaTOF are provided in the Supplementary Information.shows the workflow of MetPP software that consists of seven functional modules: retention index matching, peak filtering and merging, peak list alignment, quant mass conversion, normalization, statistical significance tests and pattern recognition. MetPP uses the peak list deconvoluted from the instrument as its input. In case of the LECO Pegasus instrument, the instrument control software ChromaTOF reduces the instrument data into peak lists, where each peak is characterized by more than 60 values. Nine of these reported values are used by MetPP for data analysis, including first dimension time (s), second dimension time (s), chemical abstract system (CAS) number, quant masses, area, profile purity, purity, concerns and mass spectra.
Algorithm
Retention index matchingRetention index is a concept in gas chromatography to convert the retention times into system-independent constants (). The linear retention index is defined as follows:where t R is retention time, s refers to the target compound that elutes off the GC column between two adjacent n-alkane reference compounds with carbon numbers z and z  1, respectively, z refers to the n-alkane with z carbon atoms and z  1 represents the n-alkane with z  1 carbon atoms. Using retention index information can increase the confidence of compound identification. Currently, MetPP can perform retention index matching only for the first dimensional GC. We improved the algorithms of iMatch approach () by enabling retention index matching of multiple top-ranked identification results, to ensure that the true metabolite can still be preserved even though it may not have the best score for mass spectral matching (). We further updated the retention index database used in iMatch to NIST11 retention index database and calculated all retention index distributions. Briefly, all retention index data recorded in the NIST11 retention index database are categorized into nine subgroups based on experimental conditions (stationary phase and temperature gradient). An empirical distribution function (DF) of the absolute retention index deviation to its mean value is generated from each of the grouped retention index data. The DF information is then used for retention index matching based on a user-defined confidence interval (P value), from which a retention index variation window is deduced.
Peak merging and filtrationIt is possible that multiple peak entries can be falsely generated for one metabolite in the peak list during spectrum deconvolution. To minimize data variations introduced into the downstream statistical analysis, all peak entries of the same metabolite need to be recognized and merged as one entry in each peak list. MetPP uses a two-step approach to recognize and merge the multiple peak entries originated from the same metabolite. Following criteria are used to check the same metabolite appears more than once:where 1 t i, j and 1 t i, j1 are the first dimensional retention times of two adjacent j-th and (j  1)-th peak entries in the i-th sample S i , respectively, k is a user-defined coefficient, P M is modulation period, 2 t i, j and 2 t i, j1 are the second dimensional retention times of the two adjacent peak entries, respectively, and 2 " R is user-defined maximum variation of 2 t R. The default values of k and 2 " R are 1 and 0.15, respectively. MetPP merges all the multiple peak entries into a representative peak. To select a representative peak from the multiple peak entries that fulfills all the three criteria in Equation (2), the CAS number of these peak candidates is used to search the NIST11 mass spectral library to get its reference spectrum s r. Linear regression is used to fit each of the mass spectra s i to s r. The peak entry with maximum fitting coefficient can be determined as follows:where Cor(x,y) is the Pearson's correlation coefficient between x and y. The peak with the maximum value of Cor(x,y) is selected as the representative peak with its peak area equals to the sum of the peak areas of the multiple peak entries, and its values of the first-dimension retention time and the second-dimension retention time are determined by the peak-area-weighted average values.
Peak list alignment MetPP uses the 2D retention times andmass spectrum of each peak for alignment. The metabolite peaks in different samples are aligned based on their similarity of these three pieces of information measured by a mixture score. The retention time value of each peak in a peak list P i is first transformed into a modified z-score as follows ():where t i, j denotes the retention time of the j-th peak in the i-th sample S i , and are the median values of means and standard deviations of the retention time values among peaks of all sample set S, respectively. The mass spectral similarity between two peaks is calculated as follows ():jj jj w jj 5where w  (x,y) is a vector of weight factors of intensity and m/z value, respectively, w   w i  n i1 and w   w i  n i1 are weighted intensities andwhere   i  i1, ..., n and   i  i1, ..., n are the intensities of the two matching mass spectra, respectively, z i is the m/z value of the i-th intensity, i  1, 2,. .. , n, and x and y are weight factors with (x, y)  (0.53, 1.3). To measure the matching quality between two peaks, a mixture similarity score C m is defined as follows:where d i is the Euclidean distance of z-score transformed retention times in the 2D chromatogram between the i-th two matched peaks, d max is the maximum value of the Euclidean distance between two matched peaks in all samples, R i is the spectral similarity between the matched peak pair and w is a coefficient (0 w 1). To perform alignment, MetPP uses a two-step peak alignment approach, full alignment and partial alignment. The full alignment recognizes all potential landmark peaks, i.e. peaks generated by the same metabolite and presented in all samples. During the full alignment, a reference peak list (P r ) is first randomly selected from the sample set S. Each of the remaining peak lists is aligned to P r , respectively. Considering two peak lists P r , S i f g, the mass spectrum of each peak in P r is used to first find all corresponding peaks in S i with a mass spectral similarity R ! 0.6. It should be noted that 0.6 was empirically chosen based on our experience and that this threshold can be decided by a user in MetPP. The peak in S i with the minimal Euclidian distance to the peak in P r in the 2D chromatogram is then considered as a possible match to the peak in P r. All of these matched peak pairs are considered as candidates of landmark peaks between P r , S i f g, and further used to optimize the value of weight factor w for calculation of C m by maximizingwhere L is the number of peak pairs and w is set as 0.05, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9 and 0.95, respectively. This process is operated on all peak list pairs P r , S i i  1,. .. , n  1 j f g , and the optimal weight factor set w 1 ,. .. , w n1 f g is obtained for S i i  1,. .. , n  1 j f g. The outlier values in fC i m i  1,. .. , n  1 j g are further detected at a confidence level of 95%. All landmark peak candidates are removed if their C m values are detected as outliers. The minimum mixture score C min m of the test peak lists is then used as the threshold value of C m in the partial alignment. After full alignment, the retention time values of remaining peaks in S i are corrected based on the retention time difference of the landmark peaks between S i and P r. Local linear fitting is used to correct retention time values of metabolites eluted between two adjacent landmark peaks in the 2D retention time domain, respectively. To correct the first dimensional retention time of peaks that do not elute off the GC column between two landmark peaks, i.e. peaks eluted before the first landmark peak and the peaks eluted later than the last landmark peak, an iterative optimization method is applied to each of these two sections of peaks, respectively. In each optimization process, 30% of landmark peaks are randomly selected and a polynomial model fitting is used to correct the retention times of peaks in the section of interest. The polynomial fitting error is computed as follows:where 1 t o i, j is the original z-score transformed first dimensional retention time of the j-th peak in the i-th sample S i , 1 t ;f i, j is the fitted retention time of the j-th peak and k is the number of peaks in S i at the section of interest. This process is repeated 1000 times and the model with minimum fitting error is selected and used for retention time correction. The same process is performed to correct the second dimensional retention time. After the retention time correction in S i , the partial alignment is performed to align all the non-landmark peaks in S i to the peaks in P r. For each peak pair in P r , S i f g, a mixture score C m is calculated using Equation (6). A peak pair is considered as a match if its mixture score C m ! C min m. If one peak in the test sample is matched to multiple peaks in P r, or vice versa, the peak pair with the maximum mixture score is kept and the remaining matches are discarded. If a peak in S i cannot be matched to any peaks in P r , this peak is considered as a new peak to P r and is added to P r. The updated P r is then used to align peaks in the next test peak list, and this process is repeated until all test peak lists are aligned.
Quant mass conversion Afterpeak alignment, an alignment table is obtained,,. .. , p i, n g represents all aligned peaks of the i-th compound in S, m is the number of aligned metabolite peaks, p i, j denotes the peak of the i-th compound in the j-th sample and n is the number of samples. If the peak list is generated by ChromaTOF, the peak area of each peak refers to the peak area of a specific fragment ion entitled quant mass. The same compound may have different quant mass in each sample. Therefore, it is critical to ensure that the peak area of each aligned peak is consistent across samples. A reference spectrum-based peak area conversion method is developed in MetPP to convert the values of peak area to be quant mass independent. For a group of aligned peaks P i , the quant mass with the highest frequency across all samples is selected as the representative quant mass q i. The CAS number of the peak P i with the largest spectral similarity in the peaks with the same q i is then used to extract reference mass spectrum s r from the NIST11 mass spectral database. A linear regression process is applied between s r and each spectrum of the aligned peaks in P i , respectively, to obtain a set of regression coefficients fa i, 1 , a i, 2 ,. .. , a i, n g. Each peak area in P i is then converted into a new value bywhere a i, 1 is the fitting coefficient of the i-th peak in sample S 1 , a i, j is the fitting coefficient of the peak in S j and I i, j is the original peak area of the i-th compound in S j .
Normalization Six normalization methods are implemented inMetPP, including quantile normalization, cyclic loess normalization (), contrast-based normalization (), trimmed constant mean normalization, trimmed constant median normalization and group-based quantile normalization (). Quantile normalization makes the peak area distribution in each sample the same across all samples. Cyclic loess and contrast-based normalizations are two extensions of the difference in log expression values versus the average of the log expression values method. Trimmed constant mean and trimmed constant median are two scaling-based normalization methods. Group-based quantile normalization first performs quantile normalization for the samples that belong to the same sample group, and then uses a trimmed constant mean method to normalize all samples across the sample groups.
Statistical significance tests Multiple conventional statisticalsignificance test methods are provided in MetPP, including two-tailed t-test, two-sample KolmogorovSmirnov test, KruskalWallis test and Wilcoxon rank sum test. To increase the confidence of the statistical testing, sample permutation is also provided as an option for each conventional statistical significance test. Permutation test, also called re-randomization test, is a nonparametric test. It first randomly exchanges sample labels and then performs one of the above mentioned conventional statistical test methods. The Bonferroni correction (), the Benjamini Hochberg method () and the q-value method () are available to correct multiple comparison issues.
Pattern recognition MetPPfirst filters data based on a userdefined frequency threshold, defined as the number of samples, in which a metabolite was detected, divided by the number of all samples. The k-nearest neighbor imputation algorithm is then used to estimate the missing data (). Two feature selection methods, principal component analysis (PCA) () and partial least squares (), are provided as options for the user, if the user decides to reduce irrelevant variables for improving clustering efficiency. Three clustering methods were implemented, including k-means clustering, agglomerative hierarchical clustering and fuzzy c-means clustering (). Two options for clustering objects are provided, users can choose all data to do clustering analysis or select only the significant molecules obtained from statistical analysis, for clustering. The clustering accuracy is calculated as the number of correctly clustered samples divided by the number of all samples.
RESULTSMetPP has a modular design including project management and multiple data analysis components. Supplementaryis a screenshot of the project management module, which contains all sample meta-information and information of experimental conditions, while Supplementary Figures S2S6 are the screenshots of data analysis components.07% and 0.55%, respectively, demonstrating a good stability of the instrument during the 2D GC separation and a high accuracy of ChromaTOF in determining peak location in the 2D gas chromatograms.depicts the peak area distribution of the 28 spiked-in metabolites in G10 before and after peak area conversion. A large variation in each box represents the peak area variation of the same compound between the six samples. By design, each compound should have the identical peak area among the six samples. However, ChromaTOF reports only the peak area of a quant mass (a fragment ion that has the highest quality for quantification), and it often chooses different quant mass for the same metabolite, depending on the data. Of the 28 metabolites, 10 metabolites in at least one of the six samples have quant mass different from the other samples. For instance, compound 4 (oxalic acid) inhas 2 quant mass values and the value of peak area has a large deviation, ranging from 1 041 108 to 3 206 235. After reference spectrum-based peak area conversion, the span of peak area is greatly reduced to 1 329 0431 935 698 (), demonstrating the effectiveness of the reference spectrum-based peak area conversion. The converted peak area values not only reduced the variation in peak area, but also guarantee the consistency of the values of peak area across samples for the downstream statistical analysis. To demonstrate whether the concentration differences of the spiked-in metabolite standards can be recognized from the alignment table, a two-tailed t-test was used to check the mean difference of the peak area of each compound between sample groups through different p-value settings. The true-positive rate (TPR) and the false-positive rate (FPR) are used as measures for metabolite relative quantification (Supplementary Information).depicts the receiveroperating characteristic curve (ROC) of recognizing the concentration difference of the spiked-in metabolite standards between sample groups using
Analysis of spike-in samples(b). Boxplot of peak area of the 28 spiked-in metabolites in G10 before reference spectrum-based peak area conversion (a) and after the reference spectrum-based peak area conversion (b).  refers to the values of peak area considered as outliers the alignment results. As expected, the FPR increases with the increase of TPR. The TPR levels off at 1.0 when the FPR reaches 0.9 between all the comparing sample groups. The AUC of the ROC curve of G10 vs G20 is 0.87, while the AUC of the ROC curve of G20 vs G40 and G10 vs G40 is 0.71 and 0.81, respectively. A high value of AUC indicates a high accuracy of recognizing the concentration difference of the spiked-in compounds between sample groups, which is achieved on the basis of correct alignment of the spiked-in compounds. Moreover, it is worth mentioning that the spiked-in metabolites that were not recognized as metabolites with significant concentration difference between the two testing sample groups are all present in the mouse liver extract before the addition of the mixture of authentic standards. This means that the concentration differences of these metabolites between sample groups may be much smaller than 2:1 or 4:1, depending on the amount of the metabolites in each sample of mouse liver extract.
Analysis of biological samplesAbout 600 metabolites were identified in each mouse liver sample via mass spectral matching. By setting P 0.001 for retention index matching, 18.6% of the identified metabolites were confirmed by the first dimension retention index matching and 51.8% were preserved owing to the lack of retention index information in the NIST11 database. However, 29.5% of the mass spectral matched metabolites were removed owing to the large first-dimension retention index deviation from the database values. The mean absolute deviation between the database value and experimental retention index of the removed metabolites is 318 i.u., with a standard deviation of 267 i.u. The corresponding values of the preserved metabolites are 21 AE 16 i.u. After the retention time filtering, about 300500 peaks were left in each sample for alignment. Among the aligned peaks, the maximum values of the RSD for the first dimensional retention time and the second dimensional retention time were only 3.15 and 3.30%, respectively.lists all the metabolites detected with significant abundance changes between sample groups LFD and HFD. Compared with the LFD group, the abundances of 10 metabolites were increased and 5 metabolites were decreased in the HFD group.depicts the abundance distribution of metabolite L-threonine in the samples of LFD group and HFD group. Three free fatty acids (entries 13 in) were detected with significant abundance changes between the two testing sampleshows that the regulation of this metabolite in the HFD group is increased with a fold change of 2.10 and a p-value of 2.4  10 2 comparing with LFD group groups. The levels of these free fatty acids are all increased in mice fed a HFD. This observation agrees with the results of literaturereported hepatic lipid level test ().
DISCUSSIONMetPP uses the peak lists generated by peak deconvolution software, such as commercial software ChromaTOF, as its input. It is well known that the ChromaTOF software has some shortcomings, including multiple peak table entries for the same compound, limited accuracy in calculation of peak areas, etc. To minimize these shortcomings of ChromaTOF software, MetPP provides options for users to filter data from the peak lists generated by ChromaTOF using the peak quality information (profile purity, purity, concerns) provided by ChromaTOF. The multiple peak entries of the same compound are recognized based on user defined 2D retention time variation windows. These peak entries are then merged and represented by one representative peak entry. To handle peaks detected in blank sample(s), MetPP has three options for the user to select from: no action, deducting the peak area of blank sample(s) from the biological samples and removing the metabolites. The user can also remove metabolites using a user-provided exclusion list. In this study, the default values for peak quality-based filtering and merging multiple peak entries were used. The analysis of spike-in data demonstrates that the data preprocessing methods implemented in MetPP is able to remove some of the shortcomings of ChromaTOF software without affecting identification and quantification of the spiked-in standards. To reduce the rate of false-positive identification, the current version of MetPP provides an option for users to match the firstdimension retention index of each compound with the database values. A large value of the mean absolute deviation between the database value and experimental retention index of the removed metabolites (308 AE 257 i.u. for the spike-in data, 318 AE 267 i.u. for the biomarker discovery data) and a small value of the corresponding values of the preserved metabolites (28 AE 12 i.u. for the spike-in data, 21 AE 16 i.u. for the biomarker discovery data) demonstrates the mass spectral matching-based metabolite identification can introduced a high rate of false identification, and the retention index filtering methods in MetPP can detect and remove some of these false-identified metabolites. MetPP performs peak list alignment using a mixture score function to simultaneously evaluate the deviation of the 2D retention time and mass spectral similarity. Compared with the progressive retention time map searching method implemented in the distance and spectrum correlation optimization (DISCO) algorithm (), the mixture score approach is able to align chromatographic peaks that may have a large variation in either retention time or mass spectral similarity, as long as the overall quality of two peak are similar. Supplementarydepicts the alignment results of the spike-in experimental data by DISCO and MetPP. All 28 spiked-in metabolites were fully aligned in all 30 samples by MetPP. However, 23 metabolite standards were fully aligned by DISCO, while the rest of the spiked-in metabolites were aligned in a portion of the 30 samples. In terms of metabolite quantification, the data analysis algorithms implemented in MetPP are able to correctly identify and quantify all spiked-in metabolite standards. Analysis of biological samples using MetPP revealed that 15 metabolites have significant abundance changes between two sample groups. The accuracy of clustering samples using all metabolite data in each sample is 0.82, while the clustering accuracy is improved to 0.91 when the abundance of the 15 metabolites in each sample are used for clustering. The improvement in sample clustering accuracy demonstrates that MetPP correctly recognized the metabolites with significant abundance difference between sample groups LFD and HFD. The abundance changes of the free fatty acids agree with the literature results of hepatic lipid level test, a different analytical method. These analysis results further demonstrate that the MetPP software can be used to recognize the metabolites with significant abundance changes between sample groups. The performance of MetPP in analysis the spike-in data was also compared with the existing Guineu software () in terms of accuracy of alignment and relative quantification. Supplementaryshows that only 9 of the 28 spiked-in metabolites were fully aligned by Guineu, while all the 28 spiked-in metabolites were fully aligned by MetPP. For relative quantification, MetPP also significantly outperforms Guineu in all three statistical measures of TPR, PPV and their harmonic mean F1 for analysis of all pairwise comparison between the five sample groups (Supplementary). Analysis of both the spike-in data and biomarker discovery data demonstrates that the methods implemented in MetPP for peak filtering and merging are effective in minimizing the shortcomings of ChromaTOF. However, compound 24 (nonanoic acid) instill has a large variation in peak area after the peak filtering and merging. For the future development, accurate peak deconvolution algorithms are needed to improve the quality of peak lists. A large variation in peak area introduced during peak deconvolution can significantly affect the downstream statistical analysis. It is also important to develop algorithms for analysis of time course data and construction of metabolite correlation networks.
CONCLUSIONSA computational platform for analysis of metabolomics data generated on GCGC-TOF MS instrumentation was developed in the form of MetPP using MATLAB. MetPP uses the peak lists generated by a spectral deconvolution software such as commercial software ChromaTOF as its input and then performs peak merging and filtering, retention index matching, peak list alignment, normalization, statistical significance tests and pattern recognition. Two sets of experimental data acquired on GCGCTOF MS were used to validate the performance of MetPP. The analysis results demonstrate that MetPP is able to recognize the concentration difference of the spiked-in metabolite standards between sample groups. The analysis results of biological samples agree with the hepatic lipid level test, further demonstrating that MetPP is able to correctly process the data of complex samples. Willis and Jihong Wang at LECO Corporation for their help on using ChromaTOF software. The authors also thank Dr Mark Styczynski's research group at Georgia Institute of Technology for their suggestions of improving the software.
The Author 2013. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
MetPP for analysis of GCxGC-TOF MS data at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
X.Wei et al. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
