Hypersensitivity to DNaseI digestion is a hallmark of open chromatin, and DNaseI-seq allows the genome-wide identification of regions of open chromatin. Interpreting these data is challenging, largely because of inherent variation in signal-to-noise ratio between datasets. We have developed PeaKDEck, a peak calling program that distinguishes signal from noise by randomly sampling read densities and using kernel density estimation to generate a dataset-specific probability distribution of random background signal. PeaKDEck uses this probability distribution to select an appropriate read density threshold for peak calling in each dataset. We benchmark PeaKDEck using published ENCODE DNaseI-seq data and other peak calling programs, and demonstrate superior performance in low signal-to-noise ratio datasets. Availability and implementation: PeaKDEck is written in standard Perl and runs on any platform with Perl installed. PeaKDEck is also available as a standalone application written in Perl/Tk, which does not require Perl to be installed. Files, including a user guide, can be down-loaded at: www.ccmp.ox.ac.uk/
INTRODUCTIONDNaseI hypersensitivity analysis can be used to map sites of open chromatin in genomic DNA (). Hypersensitivity of DNA to digestion by DNaseI arises when nucleosomal histone proteins are displaced from chromatin, leaving a region of 'naked' nucleosome-free DNA that is accessible to the DNaseI enzyme (Owen). Histone displacement and consequent DNaseI hypersensitivity characteristically occur at promoter and enhancer sites (), allowing the sequence-specific binding of proteins, such as transcription factors to the DNA. Recently, advances in high-throughput sequencing methods have been applied to DNaseI hypersensitivity testing [DNaseI-seq; Supplementary Information, Section S1; (). With DNaseI-seq, regulatory DNA fragments at accessible open chromatin sites are released by 'two-hit' digestion. These fragments are sequenced using high-throughput technology and mapped back to the reference genome. The comparison of DNaseI hypersensitivity patterns in different datasets can play an important role in the study of gene regulation (), for example, in response to a physiological stimulus. However, a major challenge in analyzing these data is the variation in signal-to-noise ratio (SNR) between datasets (Supplementary). While many potential sources of noise exist, a key variable affecting the SNR is the enzymatic activity of DNaseI, which is difficult to control between experiments. Variation in the level of DNaseI activity leads to different amounts of digestion (Supplementary), altering the composition of the population of short DNA fragments that are sequenced. There is no universal surrogate measurement of digestion that can be used to accurately quantify digestion at the library preparation stage and no ideal control sample (discussed in Supplementary Information, Section S2). For these reasons, distinguishing signal from noise in a manner that allows comparison between datasets is more challenging with DNaseI-seq than with other high-throughput sequencing approaches, such as ChIP-seq. Several peak-calling programs have been developed for use with high-throughput sequencing data. Most focus on ChIPseq where a clear input control is available, but some have also been used for DNaseI-seq data, including F-seq (), MACS () and HOMER (). While analyzing our own DNaseI-seq data, we found variable performance between peak callers, particularly at low SNRs, and the identification of a suitable peak threshold was challenging. This confounded the comparison between datasets with different SNRs (see Supplementary Information, Section S4 for SNR estimation). We have developed a peak-calling algorithm (PeaKDEck) that limits the effect of SNR on threshold setting, which is of particular value in datasets with lower SNRs. We have used Hotspotidentified () DNaseI-seq sites from 125 cell types published by ENCODE () to compare the quality of peak calling by PeaKDEck with that by other peak calling programs. PeaKDEck also includes additional tools for DNaseI-seq data analysis (see Supplementary Information, Section S9 for description of additional tools).This is an Open Access article distributed under the terms of the Creative Commons Attribution License (http://creativecommons.org/licenses/by/3.0/), which permits unrestricted reuse, distribution, and reproduction in any medium, provided the original work is properly cited. randomly from the genome, and overlapping sites are discarded (Supplementary). Next, the signal strength is measured at the non-overlapping sites using sampling bins (and Supplementary). This is achieved by measuring the background read density in a large bin surrounding the site ('background read density'; default3000 bp), and then measuring the read density in a smaller focused bin at the same site ('central read density'; default300 bp). The corrected read density is calculated by subtracting the expected read density (given the background read density) from the central read density. Once this calculation has been repeated for all the randomly selected sites in the dataset, a probability distribution is generated to describe the distribution of these corrected read density scores (Supplementary). Because the distribution of these scores is typically non-Gaussian, PeaKDEck uses kernel density estimation (Supplementary Information, Section S5) to calculate a probability distribution for the randomly selected corrected read density scores, where n is the number of sites sampled, h is the bandwidth (h  1), x i is the value of x for the ith site and K u is a Gaussian kernel:
PEAK CALLINGTo identify a threshold for peak calling, PeaKDEck calculates the probability that a given corrected read density belongs to the background probability distribution for increasing values of corrected read density. The corrected read density threshold is when the calculated probability drops below a pre-determined level (defaultP50.001). The entire dataset is then scanned in overlapping sampling bins and the corrected read density determined across the genome (Supplementary). Peaks are called where the corrected read density exceeds the threshold. Peaks can be scored by their maximum corrected read density or probability score.
PERFORMANCEWe assessed the performance of PeaKDEck by calling peaks in 10 DNaseI-seq datasets from the NCBI Short Reads Archive (Supplementary Information, Section S3). To determine whether the sites identified by PeaKDEck as open chromatin were known open chromatin sites, we amalgamated 125 ENCODE DNaseIseq datasets for different cell types, tagging each genomic locus with the number of cell types with open chromatin at that site (Supplementary). For each of the 125 datasets, we calculated the percentage of open chromatin sites unique to that dataset, the percentage of sites shared with one other cell type, continuing up to the percentage of sites per dataset shared across all 125 cell types. The mean percentage of unique peaks per dataset was 3.61 AE 4.13% ( AE standard deviation). For the peaks called by PeaKDEck in our 10 sample DNaseI-seq datasets, the mean percentage of unique peaks per dataset was 4.6 AE 1.6% (AE standard deviation; see Supplementary Information, Section S6 and S7 for details). This demonstrates that the overlap between open chromatin sites identified by PeaKDEck and known open chromatin sites is within the normal range of variation observed in the ENCODE data. Because PeaKDEck adjusts signal measurement to account for local variation in read densities and extensively samples background signal in individual datasets, PeaKDEck performs well at setting thresholds in low SNR datasets. To demonstrate this, we called peaks in the 10 sample NCBI DNaseI-seq datasets with PeaKDEck, MACS, FSEQ and HOMER (Supplementary) and quantified the number of unique sites (not occurring in the ENCODE-125 dataset) as a percentage of the total identified sites in each dataset, with each peak caller (). In the dataset with lowest SNR, 6.95% of the total peaks identified by PeaKDEck were unique, compared with 7.38, 9.64 and 31.4% of peaks identified by MACS, Homer and FSEQ, respectively, suggesting that PeaKDEck is more likely to identify authentic open chromatin sites even at low SNRs compared with other available peak callers. Although PeaKDEck is designed for use in DNaseI-seq data analysis (using the read start site as the point of interest), it can be used for similar methods such as chromatin immunoprecipitation sequencing and FAIRE-seq, by applying a user-defined offset to calculated genomic positions. PeaKDEck is especially useful compared with other peak callers where SNR is low (see Supplementary Information, Section S8).
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
M.T.McCarthy and C.A.O'Callaghan at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
