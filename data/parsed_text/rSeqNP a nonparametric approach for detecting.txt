High-throughput sequencing of transcriptomes (RNA-Seq) has become a powerful tool to study gene expression. Here we present an R package, rSeqNP, which implements a non-parametric approach to test for differential expression and splicing from RNA-Seq data. rSeqNP uses permutation tests to access statistical significance and can be applied to a variety of experimental designs. By combining information across isoforms, rSeqNP is able to detect more differentially expressed or spliced genes from RNA-Seq data. Availability and implementation: The R package with its source code and documentation are freely available at
IntroductionHigh-throughput sequencing of transcriptomes (RNA-Seq) is a widely used approach to study gene expression (). Many statistical approaches have been developed to characterize gene expression variation across RNA-Seq experiments, and many of them are designed for testing differential expression (DE) of genes without considering their alternative spliced isoforms. For a comprehensive review, see. Several recent studies have shown that directly applying the DE approach for detecting differential splicing (DS) may lead to erroneous results, because those approaches do not incorporate the complexity induced by isoform expression estimation for genes with multiple isoforms (). To this end, several approaches were recently developed to detect DE at isoform level (). However, there are two remaining issues: (i) many existing approaches only compare between two biological conditions (such as normal versus diseased) and their usages for complex experimental designs are thus limited, and (ii) most existing approaches assume parametric distributions (Poisson or negative binomial) for observed read counts which, although can achieve good performance when the distributional assumptions hold, may have severely deteriorated performance should the distributional assumptions be violated, and that is often the case especially for large sample size RNA-Seq data where outliers usually exist (). Here we present rSeqNP, a non-parametric approach for testing DE and DS from RNA-Seq data. rSeqNP extends a non-parametric approach for detecting DE () and aims at detecting both DE and DS. rSeqNP can be used with a variety of RNA-Seq experimental designs, including those with two (unpaired or paired) or multiple biological conditions, and those with quantitative or survival outcomes.
MethodsData preprocessing: Before applying rSeqNP, the raw sequence reads need to be processed to obtain the expression estimates of allsummarizes the test statistics that are used in various study designs of RNA-Seq experiments. See Supplementary Section S1 for details. rSeqNP also reports p-values from these tests and false discovery rates (FDR) based on the BenjaminiHochberg (BH) procedure. Testing DE and DS of genes jointly: For each gene, rSeqNP also computes an overall gene-level differential score (GDS) based on the statistics used in testing the DE of the isoforms. Suppose that a gene has J distinct isoforms, and T j is the statistic for testing the DE of the jth isoform (e.g. for two condition comparison, T j is the Wilcoxon rank-sum statistic), the GDS is computed asThe GDS captures both DE and DS of the gene. For genes with a given number of isoforms, larger GDS indicates stronger evidence of DE and DS. The GDS incorporates information from all the isoforms of the gene, and therefore is more comprehensive in detecting differentially expressed and spliced genes than simply detecting genes that contain differentially expressed isoforms. Estimating P-values and FDR for GDS: Since the null distribution of the GDS is unknown, rSeqNP implements a permutation plug-in method to estimate the p-values and FDRs (). See Supplementary Section S2 for details.
ResultsUsing simulation studies, we find that our proposed approach has well controlled type I error rate, and achieves good statistical power for moderate sample sizes and effect sizes. See Supplementary Section S3 for details. Here we apply rSeqNP to a real RNA-Seq dataset and compare it with EBSeq () and Cuffdiff (), which are two existing approaches for detecting DE of genes and isoforms from RNA-Seq data. The dataset was generated from paired-end RNA-Seq experiments performed on prostate cancer samples and matched benign samples from 14 Chinese prostate cancer patients (). Since neither EBSeq nor Cuffdiff can handle paired two-group comparison, we run all three programs on the dataset under the setting of unpaired two-group comparison, i.e. treat cancer and benign samples as two distinct groups, as well as run rSeqNP under the setting of paired two-group comparison. For preprocessing, we use the programs suggested by each of the three approaches to quantify expression values for all the genes and isoforms: RSEM () for EBSeq, rSeq () for rSeqNP and the integrated quantification program for Cuffdiff. Nevertheless, the three programs for quantification show very similar results (see Supplementary Section S4).summarizes the numbers of differentially expressed and spliced genes identified by each program. See Supplementary Section S4 for detailed steps and additional results of the analysis. We use FDR 0.05 for rSeqNP and Cuffdiff, and posterior probability of being differentially expressed (PPDE) 0.95 for EBSeq to call a differential event. PPDE is the metric reported by EBSeq and PPDE 0.95 corresponds to controlling FDR at 5%. As expected, when treating the data as two distinct groups, rSeqNP detects fewer differentially expressed genes and isoforms, but by applying the GDS, more differentially expressed or spliced genes are detected. Furthermore, when accounting for the paired two group nature of the data, rSeqNP detects even more differential events. We find that Cuffdiff detects a much smaller number of differentially expressed or spliced genes, which is consistent with report from another study ().
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
Conclusion We present rSeqNP, a non-parametric approach for detecting differentially expressed and spliced genes from RNA-Seq data. It is flexible in handling various types of experimental designs. It is worth mentioning that, as pointed out by the reviewer, our method relies on expression estimates for genes and isoforms reported from upstream programs, which are typically based on parametric approaches. The major limitation of rSeqNP is that its power is relatively low for small sample size RNA-Seq data. In simulation studies, we show that the power is decent with five or more samples in each group for two-group comparison. If the sample size is even smaller, parametric approaches would be preferred. Funding National Institute of Health (U01CA111275 and 1UM1HG006508 to A.M.C.). A.M.C. is also supported by the Alfred A. Taubman Institute, the American Cancer Society, and the Howard Hughes Medical Institute. H.J. is supported by University of Michigan (startup grant). Conflict of Interest: none declared.
