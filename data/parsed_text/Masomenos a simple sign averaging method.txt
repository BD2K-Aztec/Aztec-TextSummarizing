Motivation: The successful translation of genomic signatures into clinical settings relies on good discrimination between patient subgroups. Many sophisticated algorithms have been proposed in the statistics and machine learning literature, but in practice simpler algorithms are often used. However, few simple algorithms have been formally described or systematically investigated. Results: We give a precise definition of a popular simple method we refer to as m as-o-menos, which calculates prognostic scores for discrimination by summing standardized predictors, weighted by the signs of their marginal associations with the outcome. We study its behavior theoretically, in simulations and in an extensive analysis of 27 independent gene expression studies of bladder, breast and ovarian cancer, altogether totaling 3833 patients with survival outcomes. We find that despite its simplicity, m as-o-menos can achieve good discrimination performance. It performs no worse, and sometimes better, than popular and much more CPU-intensive methods for discrimination, including lasso and ridge regression. Availability and Implementation: M as-o-menos is implemented for survival analysis as an option in the survHD package, available from http://www.bitbucket.org/lwaldron/survhd and submitted to Bioconductor.
INTRODUCTIONThe successful translation of genomic signatures into clinical settings relies on good discrimination between patient subgroups that should receive different clinical management. Relatively, sophisticated methods such as penalized regression, support vector machines, random forests, bagging and boosting have seen detailed treatments in the statistics and machine learning literature (B  uhlmann and Van De; Sch  olkopf and); however, in practice many researchers prefer simpler algorithms (). A systematic meta-analysis of prognostic models for late-stage ovarian cancer () found that the most common methods in the field, and those used to generate the best-performing models on independent datasets, were of the 'univariate ensemble' type, where results of univariate regressions are aggregated to formulate a risk score. The simplest of the univariate ensemble class of prediction methods sets the coefficients of a linear risk score for standardized covariates equal to the signs of their univariate associations with the clinical outcome of interest. In other words, for survival analysis it produces a risk score equal to the sum of the 'bad prognosis' features minus the sum of the 'good prognosis' features. This method and closely related variants can be found in the top clinical, bioinformatic and general science journals () and in commercially available prognostic gene signatures, such as the MyPRS signature for multiple myeloma prognosis (). It has even been proposed, in a formula-free article, as a practical algorithm that can be performed in a spreadsheet with the 'software and skill sets available to the cancer biologist' (). Despite the popularity and apparent effectiveness of this simplest of methods, to our knowledge, it has never been formally described or systematically investigated. We give a precise definition of the procedure and study its behavior theoretically, in simulations and in an extensive analysis of 27 independent gene expression studies of bladder, breast and ovarian cancer, altogether totaling 3833 patients with survival outcomes. We provide theoretical arguments that this method has good discrimination power and low variability when positively correlated features tend to have the same directions of marginal association with outcome. In simulations under a variety of sparsity and covariance structures, it performs competitively with lasso and ridge regression under all situations except the unlikely scenario of independent features, and was more than an order of magnitude faster. In application to survival analysis of three large microarray databases, it performed better than lasso and ridge regression in two of three cancer types, and comparably in the third. We refer to the method as m aso-menos because in Spanish the phrase 'm as o menos' means both 'plus or minus', describing the method's implementation, *To whom correspondence should be addressed. and 'so-so', describing its theoretically non-optimal but still practically useful discrimination ability.
METHODS
M as-o-menosLet each component X ij of the p  1 covariate vector X i = X i1 ;. .. ; X ip  T be a quantitative measurement of the j th gene from the i th subject. The X ij could represent various types of genomic information, such as expression levels from microarrays or next-generation sequencing experiments, or non-genomic data. M as-o-menos uses a patient's X i to calculate a signed sum of that patient's covariate values. The procedure is as follows:(1) Standardize the covariates such that n  1 1 X X ij  X j  2 =1; j=1;. .. ; p, where(2) Perform univariate regressions of the outcome on each gene to obtain marginal estimates of the regression coefficient ^ j .(3) Let ^ v j = sgn ^ j =p 1=2 , where sgnc = 2I c40  1 for c 6  0 and sgnc=0 for c = 0.(4) The risk score for the i th patient is calculated as X T i ^ v, whereThe factor of p 1=2 in the definition of the ^ v j merely serves to ensure the arbitrary scaling jj^ vjj 2 = 1. By changing the regression model used in step (3), m as-o-menos can be used with clinical outcomes of any type, such as continuous, binary or censored data. The discrimination performance of X T i ^ v can be quantified using correlation for continuous outcomes, the area under the receiver operating characteristic curve for binary outcomes () or the C-statistic for censored outcomes (). M as-o-menos, and procedures similar to it, is already in use for analyzing genomic data. For example, Donoho and Jin (2008) introduced a family of classifiers, one of which, called HCT-clip, is equivalent to m aso-menos. They found that HCT-clip performed surprisingly well in cross-validation experiments using standard datasets with uncensored outcomes. Some also use marginal regression to identify good and bad prognosis covariates, which are then used to rank patients by risk. Ranking methods include the t-statistic for difference in expression of good versus bad prognosis genes () and signed averaging of discretized or continuous expression values (). Replacing lasso coefficients by their signs has been proposed for summarizing gene pathway activity (). It may sometimes be helpful to perform an initial feature selection step before implementing m as-o-menos, as we argue in Section 2.3. Feature selection has been the subject of a great deal of research, and a detailed discussion is beyond the scope of this article. In our data analysis in Section 3.3, we found that selection had little effect on the discrimination ability of m as-o-menos. However, selection can provide more interpretable models by dramatically reducing the number of genes required for prediction.
Discrimination for survival outcomesWe focus on survival outcomes because they are typically the most difficult to deal with and the most clinically relevant and are the outcomes collected in our real data. Let T i be the survival time of the i th subject. To measure discrimination in the survival setting, we use the C-statistic over the follow-up period 0; , defined byas C b = PfgX i  4 gX j  j T i 5 T j ; T i 5 g; 1 where gX is the risk score for a subject with covariate vector X. We consider linear risk scores of the form gX = X T b for b =  1 ;. .. ; p  T. We define the optimal weight vector to be b 0 = arg max b:kb 0 k 2 =1 PX T i b 4 X T j bjT i 5 T j ; T i 5 ;where we have arbitrarily scaled b 0 to have norm 1 because C b is invariant to scaling of b. To implement m as-o-menos in this setting, we will obtain the ^ j by fitting univariate Cox models. We choose the Cox model because it is a well-established and well-understood procedure in clinical research. In addition, the estimators ^ j converge to well-defined 0j even when the Cox model is not correctly specified (;), as is likely to be the case in our marginal regressions. Finally, if the data truly come from a Cox model, the true parameter vector should maximize C and should be a scalar multiple of the optimal b 0 .
Statistical propertiesWe show that under certain conditions, the m as-o-menos weights can have good discrimination power along with low variability.provided similar arguments to justify equalization of regression coefficients when all covariates have the same directions of effect on the outcome, and this direction is known a priori. Hand describes this in terms of the 'flat maximum effect': that in the context of classifiers, often little advantage can be gained in prediction accuracy over simple models. Here, we do not assume that the directions of effect are known. Let v  =v  1 ;. .. ; v  p  T be the probability limit of ^ v, such that ^ v ! v . Because ^ v j =sgn ^ j , if ^ j ! 0j in probability, then by the continuous mapping theorem v  j =sgn 0j . We will analyze the performance of the m as-o-menos estimator ^ v in terms of the discrimination ability of v  relative to that of b 0 , and the variability of ^ v around v . For now, we assume v  j 6  0 for all genes j. At the end of the section we discuss the implications if this is not true. By the definition of C , the discrimination performance of v  =v  1 ;. .. ; v  p  T depends only on the degree of linear association between X T i b 0 and X T i v . In addition,The second equality follows because v  j  v  j always equals 1. Thus, X T i v  will be highly correlated with X T i b 0 , and will have similar discriminative ability, under the condition that X j 0j v  j and have the same sign.It is not unreasonable to expect these terms to be positive. First, each 0j quantifies the association between X ij and T i conditional on all genes in X i , while each v  j reflects its univariate association. If a gene has the same direction of effect in both the conditional and marginal models, then 0j v  j 40. This is plausible for at least some genes, and even if it does not hold for all genes P j 0j v  j can still be positive. Second, the term is the minimum average covariance between X ij v  j and X ik v  k. This will be positive if genes with the same marginal directions of effect tend to be positively correlated, while genes with different marginal directions of effect tend to be negatively correlated. Indeed, the encoded proteins of conserved co-expressed gene pairs are likely to be part of the same biological pathway (van). Again, can be positive even if this covariance condition holds only for some pairs of genes, as we merely need the average covariance to be positive. Restricting the m as-o-menos weights to be either +1 or 1 endows it with low variability, which has been shown to be especially important in classification (). The variability of ^ v j is given by P ^ v j 6  v  j = P ^ j 5 0 if 0j 4 0; P ^ j 4 0 if 0j 5 0; P ^ j 6  0 if 0j = 0:Lin andshowed that ^ j ! N 0j ; 2 j =n for some 0j and 2 j. This approximation, combined with Mill's inequality, gives the approximate relation 0, which approaches 0 much faster than var ^ j . For large n and/or large j 0j j, the variability of ^ v j will be close to zero. Thus, ^ v is likely to be less susceptible to overfitting and, as a result, can have better out-of-sample discrimination performance. Difficulties arise when v  j =0 for some marginally unimportant genes j. First, covX T i b 0 ; X T i v   will depend in part on the covariances between these genes and the marginally important ones, and it is unclear how these covariances will behave. Second, as ^ j is a continuous estimator, P  ^ j 6  0 will equal 1 for any sample size. In other words, m as-o-menos may be less predictive and more variable when used on data where many of the covariates are not marginally associated with the outcome. An initial feature screening step may remove many such covariates, so that there are few j such that 0j =0. On the other hand, because gene expression levels tend to be correlated, even genes not involved in the disease process may be correlated to important genes and may have nonzero marginal associations.
RESULTS
Competing methodsWe compared m as-o-menos to three popular analysis methods that also generate linear risk scores, lasso (), ridge regression () and marginal regression (), which gives risk scores of the form P j X ij ^ j. For all methods we first standardized all covariates to have unit variance. We also included two negative controls: (i) the single gene with the largest ^ j estimated from the training set and (ii) randomly generated risk scores P j X ij Z j , where the Z j were drawn independently from a standard normal. We implemented lasso and ridge regression for the Cox model using the package glmnet (), selecting the penalty parameter using 3-fold cross-validation using the built-in function. Marginal Cox regressions and m as-o-menos are implemented in the package survHD ().
SimulationsTo simulate training data, we generated p  1 covariate vectors X i and survival times from a Cox model with a p  1 true parameter vector b 0. We let the true Cox regression coefficient vector b 0 have s non-zero components all with magnitude s 1=2 , such that kb 0 k 2 = 1. The first s=2 non-zero components were positive and the rest were negative. We generated censoring times from an independent exponential distribution to give $50% censoring. In each testing dataset, we replaced the positive entries of b 0 by random uniform draws from 0; 4=s 1=2 , and the negative entries by random draws from 4=s 1=2 ; 0. Each training and testing dataset contained n = 200 observations. We considered the low-dimensional case of P = 100 and the high-dimensional one of P = 10 000. To generate sparse b 0 , we let s = 10, and for non-sparse b 0 we let s = P. We drew X i from a multivariate normal with mean zero and unit marginal variance. From Section 2.3, the discrimination ability of m aso-menos depends on the covariance structure of the X i. In an 'easy' setting, the covariates were divided into two blocks, with X ij positively correlated within blocks and negatively correlated between blocks. Those X ij with 0j 40 were assigned to one block, those with 0j 50 were assigned to the other and those with 0j =0 were assigned equally between the blocks. In a 'hard' setting, we let covX ij ; X ik  4 0 for j and k both even or both odd, and covX ij ; X ik  5 0 otherwise. We let jcovX ij ; X ik j=0, 0.3 or 0.5 for all j and k and ran 200 simulations. The computations in this article were run on the Odyssey cluster supported by the Faculty of Arts and Sciences (FAS) Science Division Research Computing Group at Harvard University.illustrates the speed advantage enjoyed by m as-o-menos. In general, m as-o-menos kept pace with lasso, ridge and marginal regression. Each of these performed better than the single best gene and the randomly generated negative control.reports the average out-of-sample C-statistics obtained by the different methods. The C-statistics were calculated at =2, where is defined in (1). Confidence intervals represent the empirical 2.5 and 97.5% quantiles. The results clearly illustrate the importance of the covariance structure. All of the methods except for the negative control performed better under the easy covariance setting than under the hard one. The easy covariance satisfies the assumptions of the theoretical discussion in Section 2.3: covX ij v  j ; T i  4 0 and covX ij v  j ; X ik v  k  4 0 for all j, k. The difficulty of the hard covariance structure arises from the fact that it is impossible to meet this condition. For example, by construction, covX i1 ; T i  4 0 and covX i2 ; T i  4 0, but covX i1 ; X i2 50. In other words, the signs of the 0j and the covariances are incoherent in the hard covariance case. When the covariates were independent, higher dimensionality made discrimination harder regardless of sparsity, perhaps because there was no way to borrow information across the covariates. Under the easy covariance structure with a dense b 0 , however, high dimensionality was actually beneficial, perhaps because if the effects of some covariates were by chance incorrectly estimated, there were many other correlated ones that could be used as surrogates. On the other hand, with a hard covariance matrix, dimensionality added difficulty even in the non-sparse case because of the incoherence between the 0j and the covariate correlations. With no correlation, sparsity allowed for easier discrimination. When correlation was introduced in the easy covariance setting, sparsity was detrimental to prediction. This might have been owing to the screening step because univariate screening is liable to retain unimportant covariates simply because they are correlated with important ones. These incorrectly retained covariates can degrade performance. In the hard covariance setting, however, sparsity was helpful regardless of the level of correlation. This may be because in the sparse case, there werefewer important covariates with which the hard covariance structure could cause difficultly.
Application to bladder, breast and ovarian cancerWe applied m as-o-menos, lasso, ridge, marginal regression and the two negative control methods to an extensive compendium of real cancer gene expression data (). We obtained six bladder cancer datasets totaling 679 patients from Riester et al.. The bladder and ovarian cancer data have been manually curated to have standardized clinical annotations, probeset identifiers and microarray preprocessing, and are available in the Bioconductor packages curatedBladderData and curatedOvarianData, respectively. For each disease, we limited our analyses to the probesets common to all studies. We trained each algorithm on the largest available study and evaluated its performance on each of the remaining datasets using the C-statistic calculated at =5 years, where is defined in (1). Roughly 60% of all study participants, combined across all diseases, were still alive after 5 years. The C-statistic is robust to the choice of unless few deaths or censoring events occur at times greater than (). We generated 100 bootstrap samples of each validation dataset to obtain 95% confidence intervals. In addition to applying the methods without feature selection, we also implemented higher criticism thresholding (), which screens out covariates with high marginal Cox regression P-values but is entirely data-driven and automatically chooses the number of covariates to retain. Summary statistics were calculated by fixed effects meta-analysis with the metafor package ().reports the results. Selecting only a single gene or using random weights gave the lowest performance, confirming the appropriateness of our negative controls. M as-o-menos was consistently on par with lasso, and even outperformed lasso in several cases. Its performance was much more similar to those of ridge and marginal regression. Screening did not dramatically affect the performances of any of the methods. A referee noted that it is unclear how well m as-o-menos performs within a single dataset, as opposed to across datasets. To answer this question, we evaluated the performance of each risk prediction algorithm within each dataset of each disease type by calculating the average 3-fold cross-validated C-statistic at =5 years. No feature screening was implemented.reports the results and shows that m as-o-menos was again on par or better than the other methods. It appears that in addition to being robust across studies, m as-o-menos is also simply a good predictor.
DISCUSSIONWe have studied m as-o-menos, a simple algorithm for classification and discrimination that has seen popular adoption but has not been formally investigated. We gave a precise definition of the algorithm, showed theoretically and in simulations that it can perform well and demonstrated in an extensive analysis of real cancer gene expression studies that it can achieve good discrimination performance in realistic settings, even compared with lasso and ridge regression. Our results provide some justification to support its widespread use in practice. We hope our work will help shift the emphasis of ongoing prediction modeling efforts in genomics from the development of complex models to the more important issues of study design, model interpretation and independent validation. One reason why m as-o-menos is comparable with more sophisticated methods such as penalized regression may be that we often use a prediction model trained on one set of patients to discriminate between subgroups in an independent sample, usually collected from a slightly different population and processed in a different laboratory. This cross-study variation is not captured by standard theoretical analyses, so theoretically optimal methods may not perform well in real applications ().proposed a method for giving a realistic measure of the practical utility of algorithms in the presence of cross-study variation. At the same time, we found using cross-validation experiments that even within the
0.e n o s S i n g l e g e n e R a n d o msame dataset, m as-o-menos remained competitive with more sophisticated methods. Batch effects create study-specific measurement bias, and are widespread and often unidentified in genomic data (). They may be responsible for the cross-study variation that degrades the performance of algorithms such as lasso or ridge regression. Although certain batch-correction techniques have gained widespread use (), these have been motivated primarily by class comparison rather than class prediction. In a genomic prediction competition, batch correction was seen to provide no overall benefit for validation accuracy (MAQC). Rather, we propose that the impact of unknown batch effects may be best mitigated by using methods less prone to overfitting. M as-o-menos risk scores have lower variability, and may be less associated with batch, than those of the other methods, which might explain its robust performance in both cross-validation and cross-study validation in 27 datasets from three cancer types. While we focused on microarray data and survival endpoints, m as-o-menos can be applied to any type of outcome variable, using any regression model, and has precedents for application in diverse settings outside of genomics (). It is fast to implement, simple to interpret, comparable in performance with more complex methods and appears robust to cross-study variation. M as-o-menos should be useful for developing prediction models from high-dimensional data in any situation where the covariates are sufficiently correlated and the true effect is roughly linear.
ACKNOWLEDGEMENTThe authors thank the anonymous referees for comments, which substantially improved this article.
The Author 2014. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
M as-o-menos at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
S.D.Zhao et al. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
