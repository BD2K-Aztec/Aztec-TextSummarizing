Motivation: Comparative modeling of RNA is known to be important for making accurate secondary structure predictions. RNA structure prediction tools such as PPfold or RNAalifold use an aligned set of sequences in predictions. Obtaining a multiple alignment from a set of sequences is quite a challenging problem itself, and the quality of the alignment can affect the quality of a prediction. By implementing RNA secondary structure prediction in a statistical alignment framework, and predicting structures from multiple alignment samples instead of a single fixed alignment, it may be possible to improve predictions. Results: We have extended the program StatAlign to make use of RNA-specific features, which include RNA secondary structure prediction from multiple alignments using either a thermodynamic approach (RNAalifold) or a Stochastic Context-Free Grammars (SCFGs) approach (PPfold). We also provide the user with scores relating to the quality of a secondary structure prediction, such as information entropy values for the combined space of secondary structures and sampled alignments, and a reliability score that predicts the expected number of correctly predicted base pairs. Finally, we have created RNA secondary structure visualization plugins and automated the process of setting up Markov Chain Monte Carlo runs for RNA alignments in StatAlign. Availability and implementation: The software is available from
INTRODUCTIONOur recently created Statistical Alignment package, StatAlign (), performs simultaneous multiple sequence alignment and phylogenetic tree reconstruction using a statistical alignment strategy (). This method operates in a Bayesian framework and uses the Markov chain Monte Carlo (MCMC) method to sample from the joint posterior space of alignments, trees and model parameters. It works with a realistic insertiondeletion model on the gene level, TKF92 () and offers a selection of substitution models. The clear advantage of this approach is that the complete evolutionary history is modelled and estimated in a single sound statistical framework. RNA secondary structure prediction is an important problem in molecular biologythe function of the RNA molecule depends on the way it folds. Stochastic Context-Free Grammars (SCFGs) have been used to great effect in programs such as Pfold (), which has recently been reimplemented. They use the homology of RNA sequences to help make accurate predictions, as the base pair complementarity must be kept for structural conservation. Multiple sequence alignment in itself is a challenging problem, as most multiple alignment programs rely on score-based heuristics rather than attempting to model the underlying biological process of substitution, insertion and deletion. It is therefore desirable to implement RNA folding in a statistical alignment framework to gain the advantages from statistical alignment, including being able to predict from multiple alignment samples, and statistical measures associated with the probabilistic model.
RNA PLUGINWe have extended the program StatAlign to include several RNA-specific features. A modified secondary structure-prediction approach that makes use of sampled multiple alignments has been implemented. Each alignment sample is folded using PPfold or RNAalifold (), and a base pairing probability matrix is produced. These matrices are averaged to obtain a single base pairing probability matrix, and maximum posterior-decoding (as described in) is used to obtain a secondary structure. We refer to this method as the base pair averaging method. Output is produced on the GUI through the VARNA package), see Supplementary] and additionally written to file. In a second approach, which also makes use of multiple alignment samples, we calculate phylogenetic probabilities as inby averaging over the phylogenetic probabilities of each of our alignment samples. PPfold then takes these probabilities and produces a secondary structure prediction using the standard SCFG method. Given that this *To whom correspondence should be addressed. alignment requires an evolutionary model in order to produce phylogenetic probabilities, this second method of consensus structure prediction is only available for the SCFG method. We refer to this method as the phylogenetic averaging method. To benchmark the methods, we took reference alignments from Rfam (). In a pre-filtering step, we discarded outlier sequences with many/long insertions and deletions from each family. Indels were first determined relative to a family consensus sequence, then a total mismatch score was calculated based on indel lengths, and sequences that had significantly larger mismatch score than the family mean were deleted. From 44 families that remained, we took a random sample of 5 sequences, as Knudsen and Hein (1999) suggest this is adequate to capture the evolutionary information. We then re-aligned the sequences using MUSCLE (), MAFFT (), Clustal Omega () and StatAlign, and predicted structures on the resulting alignments. Predictive accuracy was assessed by F-score, the harmonic mean of sensitivity and positive predictive value ().gives the results of the benchmark. By considering multiple alignments, the average F-score is at least as good or better as many current alignment programs. In particular, the averaging methods improve upon the structure prediction on the StatAlign consensus alignment. When sequences are easy to align, we might expect methods to perform similarly, but when alignment is difficult, a method which can consider multiple alignments will produce fewer poor predictions. Naturally, additional computational time is required for the RNA secondary structure predictions, for which the algorithms are cubic in the length of the alignment. For the base pair averaging method, we require PPfold or RNAalifold to fold each of the sample alignments. The phylogenetic averaging method is in practice slightly faster (but with the same complexity), as the inside-outside algorithms only runs once. The user is also provided with additional scores relating to the quality of secondary structure predictions. Firstly, the information entropy (SukosdSuko) is calculated to give the user an indication of how clear the signal of secondary structure prediction is. Paired and unpaired column probabilities are calculated using the Pfold model over alignment samples and averaged. PPfold then uses these probabilities along with SCFG probabilities to calculate the consensus entropy. The second score is a reliability score, designed to give the user an indication of how many base pairings are expected to be correctly predicted in a particular secondary structure. The reliability score we calculate is a modified version of the PPfold reliability score, which averages the posterior SCFG probabilities of base pairs and unpaired bases. Our score considers only base pairs, and correlates more strongly with the F-score measure of predictive accuracy. Evaluating the new reliability score on the benchmarking dataset showed that the R 2 value between this reliability score and the PPfold F-score increased from 0.2685 for the existing PPfold reliability score to an R 2 value of 0.4021 for our modified reliability score, when performing linear regression. These calculations are only available for the SCFG method. Lastly, an option to automate StatAlign's MCMC parameters for RNA alignments has been includedpreviously, the user was expected to specify the parameters of the MCMC run prior to execution. The burn-in process is terminated when we get a significant decline in the log likelihood graph. The sample rate is calculated by taking many samples and measuring the distances between alignments: the rate is chosen to be the number of steps such that the distance between alignments approaches a constant. The MCMC run is terminated when adding more alignment samples no longer results in significant changes to the consensus alignment. Automating the process in this way allows the user to obtain desirable results which otherwise might not be the case for a poor choice of parameters.
The Author 2013. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
StatAlign 2.0 at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
