Motivation: The three dimensional tertiary structure of a protein at near atomic level resolution provides insight alluding to its function and evolution. As protein structure decides its functionality, similarity in structure usually implies similarity in function. As such, structure alignment techniques are often useful in the classifications of protein function. Given the rapidly growing rate of new, experimentally determined structures being made available from repositories such as the Protein Data Bank, fast and accurate computational structure comparison tools are required. This paper presents SPalignNS, a non-sequential protein structure alignment tool using a novel asymmetrical greedy search technique. Results: The performance of SPalignNS was evaluated against existing sequential and non-sequential structure alignment methods by performing trials with commonly used datasets. These benchmark datasets used to gauge alignment accuracy include (i) 9538 pairwise alignments implied by the HOMSTRAD database of homologous proteins; (ii) a subset of 64 difficult alignments from set (i) that have low structure similarity; (iii) 199 pairwise alignments of proteins with similar structure but different topology; and (iv) a subset of 20 pairwise alignments from the RIPC set. SPalignNS is shown to achieve greater alignment accuracy (lower or comparable root-mean squared distance with increased structure overlap coverage) for all datasets, and the highest agreement with reference alignments from the challenging dataset (iv) above, when compared with both sequentially constrained alignments and other non-sequential alignments. Availability and implementation: SPalignNS was implemented in Cþþ. The source code, binary executable, and a web server version is freely available at: http://sparks
IntroductionThe three dimensional tertiary structure of proteins at near atomic level resolution provides an indication of their function and evolutionary relationships. In particular, similarity in structure usually implies similarity in function. Accordingly, functions of a protein without annotated functions can be predicted if it is structurally similar to proteins with known functions. These comparisons are productive because protein structures are often more conserved than their sequences (). Accurate computational structure comparison is complementary to the much slower process of manual classification () which is unable to keep pace with newly determined structures from structural genomics projects (). As a consequence, protein structure alignment has become an important technique for computational biology researchers involved in protein classification, evolutionary relationship determination, protein functional prediction, molecular modelling and protein engineering ().Protein structure alignment has been studied for over thirty years, with a large number of computational tools and techniques developed to address the problem (). In general, protein structure alignment can be defined as generating the set of residue pair mappings which maximizes the detection of similarity whilst minimizing geometric divergence. To date this has been achieved in two ways: sequentially and non-sequentially. A valid sequential alignment is achieved through adherence of the following two constraints: (1) exclusivity  no amino acid can be aligned with more than one amino acid in the other protein; and (2) ordering  the order of amino acids must be maintained with respect to the alignment. That is, if amino acids i and j in one protein are aligned with amino acids k and l in the other protein, then i < j if and only if k < l. (). Alternatively, non-sequential alignments release the ordering constraint and only enforce the exclusivity constraint, which in some instances has been found to improve similarity detection performance compared with sequentially constrained alignments, potentially uncovering hidden or unexpected relationships assisting with evolutional and functional annotations (). Representative examples of sequential alignment methods in early studies include DALI (), SSAP (), CE (), FATCAT (), TMalign ()/ FrTMalign () and SALIGN (). A recent sequential alignment method is SPalign () which optimizes a size-independent score called SP-score which fixes the cutoff distance at 4 A  and removes size dependence by using a normalization pre-factor. SPalign demonstrated improvements of alignment accuracy compared with (DALI, CE, TMalign and FrTMalign), as shown in (). Representative examples of non-sequential alignment methods in earlier studies include: DALI (this tool can produce both sequential and non-sequential alignments), Geometric Hashing (), SARF (), MASS (,b), MUSTANG (), GANGSTA  (), SNAP (), FlexSnap (), CLICK () and MICAN (). Both GANGSTA  , and CLICK methods make use of combinatorial-based approaches to produce non-sequential structure alignments. GANGSTA  is an extension of the original Genetic Algorithm for Non-Sequential and Gapped Structure Alignment (GANGSTA) () tool, and replaced their Genetic Algorithm component with a combinatorial approach providing improved efficiency and reliability. CLICK alignments are generated by grouping locally aligned representative atoms within a certain distance threshold and then matches these groups into the best combination that maximizes coverage with the least squares fit. FlexSnap uses a greedy algorithm for chaining aligned fragment pairs (AFPs), allowing for flexible alignments to be produced by introducing hinges between AFPs. MICAN is based on the geometric hashing paradigm and focuses on SSEs for alignment, utilizing a multiple vector representation for each SSE. This study employed combinatorial optimization techniques, specifically a Linear Sum Assignment Problem (LSAP) () algorithm, to produce non-sequential structure alignments of proteins. We developed the Asymmetrical Greedy Search (AGS) algorithm that locates an approximate LSAP solution efficiently with negligible difference from the global minimum. The new non-sequential alignment software package, SPalignNS, is based on the optimization of SP-score () for structure alignment. SPalignNS achieves highly accurate alignment results with better or comparable RMSD at a higher number of aligned residue pairs in a significantly shorter computational time than CLICK.
MethodLSAP is a classic combinatorial optimization problem that searches for an optimal combination of assignments subject to an n  m cost/ benefit matrix, with the overall goal being to minimize/maximize the cost/benefit through a complete selection of one-to-one assignments. In terms of aligning a pair of protein structures, the benefit matrix applied here was generated using SP-score (detailed in Sect. 2.3) as the objective function for each residue from protein A (n rows) aligned with each residue from protein B (m columns). When n  m the LSAP is symmetrical and when n 6  m the LSAP is asymmetrical. Here, a symmetrical LSAP would require both input structures to have identical counts of representative atoms. In most cases the number of these potential alignment points in each protein will differ, requiring the application of an asymmetric LSAP algorithm. A valid solution for asymmetric LSAP is a semi-complete assignment where either every row is assigned to the best possible column leaving surplus columns unassigned, or conversely every column is assigned to the best possible row, leaving surplus rows unassigned. Attained assignment solutions will then directly represent the set of individual residue alignments used for non-sequential structure alignment. One of the first exact algorithms to solve the symmetrical LSAP was the Hungarian Algorithm (). Many other exact algorithms have subsequently been developed including the Auction Algorithm () which is considered to be one of the fastest algorithms for finding the optimal solution to the assignment problem. However, for large-scale or complex instances of the assignment problem, the Auction Algorithm is not a viable option due to its pseudo-polynomial time complexity, particularly within applications where it is desirable to have minimal computational processing cost such as the one studied in this paper. Consequently the major requirement is that the LSAP algorithm must be able to quickly identify a solution which is very close to optimal. As the use of the LSAP algorithm in protein structure alignment is just one step within a heuristic process which has a number of approximations, optimality of the LSAP algorithm is not a requirement as the accuracy benefit from an exact LSAP solution compared with an approximate LSAP solution is negligible.
AGS algorithmHere we developed a new heuristic algorithm for this study, Asymmetric Greedy Search (AGS), that locates approximate asymmetric LSAP solutions efficiently with negligible difference from the global minimum. The AGS algorithm was inspired by a similar algorithm applied in a different context, Deep Greedy Switching (DGS) (). Existing algorithms such as DGS, Hungarian and Auction are unsuitable for application to non-sequential protein structure alignment due to being constrained to symmetrical LSAP instances. However, the AGS algorithm is compatible with both symmetric and asymmetric LSAP instances. The AGS algorithm operates as follows: It is assumed that the number of rows will be less than or equal to the number of columns. If this is not true, a transposition will occur to satisfy this Fast and accurate non-sequential protein structure alignmentrequirement, however the final solution will be unaffected by this. Then, after generating an initial solution, the algorithm creates, for each row, the best row R; R b  and column C; C b  vectors of possible swaps. The time complexity of evaluating the total effect of swapping rows is On 2 , and for evaluating the swapping of unused columns is Onm  n. These best row and column vectors are used to perform swaps from largest benefit to smallest benefit order until there are none remaining which improve the total benefit of the solution. During this improvement phase, the only updates to the best row R; R b  and column C; C b  benefit vectors are those for the row(s) involved in the swap. The time complexity for the updates to the best row and column vector at each iteration of the improvement phase is O2n  1  O2m  n and Om  n respectively. When there is no benefit improvement possible, R; R b ; C; C b are regenerated and the improvement phase is repeated. The algorithm terminates when there are no improving swaps available after R; R b ; C; C b  have been regenerated, and the final assignment solution is returned. In comparison to the fastest exact method (Hungarian algorithm) which has a time complexity of On 3 , the AGS algorithm is an order of magnitude faster with an overall time complexity of On 2 . The speedup here has proved beneficial for quickly solving the problem of finding the best set of non-sequential residue assignments, as this problem itself includes an inherent rise of computational complexity required when compared to finding the best set of sequential residue assignments. This complexity increase is due to the total number of possible residue assignment combinations being significantly increased when the ordering constraint is removed.
Computational experimentsThe performance of SPalignNS was evaluated and compared with a) for full definition), a self-defined similarity score, for both similarity evaluation and alignment optimization. This guarantees that our final alignments are close to or at the global maxima for this score. To assess the alignment quality of each method, the following metrics and measures have been employed and are outlined as follows.
Alignment measures
Number of aligned residues (Nali)For each pairwise structure alignment, Nali represents the total count of aligned representative atoms. The default representative atom used for protein structures within SPalign and SPalignNS is Carbon Alpha (Ca), but this can be changed through the specification of an input parameter.
Root mean square deviation (RMSD)RMSD provides an overall indication of the three-dimensional geometric similarity between two protein structures from a set of aligned residue mappings after superimposition, as calculated by Eq. (1), where n represents the count of aligned residues and d 2 ij is the squared Euclidian distance between representative atoms of the aligned residue pair.2.3.3 Structure overlap (SO) SO is defined as the percentage value of all aligned residues that are within 3.5 A  of each other after superimposition, and is given by Eq. (2), where m is the smaller residue number of the two aligned structures, n is the number of aligned residues, d ij is the Euclidian distance between representative atoms of aligned residue pairs and d 0 is the 3.5 A  Euclidian distance threshold.2.3.4 SP-score SP-score is used as both the objective function for alignment optimization and as the final structure similarity score. It is calculated per Eq. (3), where L is defined as the sum of aligned core residues (where d ij 2d 0 ) and the average number of neighbouring residues within 3d 0 from any core residues. The summation only includes residues that are within 2d 0 , so that only meaningfully aligned residues contribute to the SP-score. The size-dependant normalization factor a is a constant value of 0.3. Finally, a constant value of 0.2 is used to ensure a smooth cut-off when d ij  2d 0 .
Alignment datasetsIn order to comprehensively assess the alignment performance of SPalignNS, a number of computational experiments have been carried out over four benchmark datasets. Defined as follows, the first three datasets were used as benchmarks for testing CLICK in (). The final dataset has been used for comparatively assessing the quality of pairwise protein structure alignment methods (), multiple protein structure alignment methods (), and is often used to test the accuracy of non-sequential protein structure alignment methods.
HOMSTRAD homologous proteinsA total of 3454 structures make up the 9538 pairwise alignments in this dataset implied by the HOMSTRAD (HOMologous STRucture Alignment Database) () database of multiple alignments. These manually curated alignments have been used to create a collection of protein families, clustered on the basis of sequence and structural similarity. This benchmark aims to comparatively assess the performance of aligning homologous structures where structurally similar regions share the same topology.
Difficult cases of aligning homologous protein pairsThis dataset is a subset of the HOMSTRAD dataset above, however focusing on alignments with low structure similarity. The dataset includes 64 pairwise alignments that have between 30% and 70% SO and RMSD above 2.5 A  .
Similar structure but different topologyThis dataset includes a total of 199 pairwise alignments from 91 protein structures. These pairwise alignments are made up from 5 pairs with circular permutation, 60 pairs with non-topological similarities, 24 pairs with swapped domains and 110 alignments amongst 10 members of retinol binding proteins, 5 members of verotoxin family and 4 members of the pleckstrin family. This benchmark aims to comparatively assess the performance of aligning non-homologous structures where structurally similar regions do not share the same topology.
RIPCThis dataset was compiled by () and contains 40 structure pairs which are considered difficult to align due to the presence of Repititions, extensive Indels (Insertions/Deletions), Circular Permutations and/or considerable Conformational variability. The authors also provide a series of reference alignments for a subset of the RIPC set (23 pairs) that are based on sequence and function conservation: two were generated based on curated alignments of homologous proteins, three were generated by mapping the residue numbers from PDB structures corresponding to alternate conformations of the same protein and the 18 remaining are a result of searching for functionally equivalent residues (i.e. equivalent catalytic residues and/or binding sites sharing similar physicochemical environments). Of these reference alignments we analyze a subset of 20 pairs with reference alignments that have between $10% and $35% sequence identity (disregarding three cases with $100% sequence identity).
Results and discussionThe results obtained by SPalignNS is compared with other methods using benchmark datasets discussed in the previous section are presented in the following subsections. To assist in interpreting these results, the following points are relevant:). Fromit can be seen that SPalignNS achieves the highest average SO percentage with the lowest RMSD compared to the other methods. SPalignNS also achieves a statistically significant (P-value < 0.05) improvement in terms of SO when compared with each method. On average SPalignNS was able to locate two more well-aligned residues compared to CLICK. More importantly, the alignment quality improves on CLICK with a reduction of RMSD by 6%. Methods with larger Nali do not necessarily indicate higher SO. This is because SO considers only superimposed residues within 3.5 A  , thus it is entirely possible for a smaller Nali to achieve greater SO than a larger Nali. As stated by (), 9442 out of 9538 pairwise alignments from this dataset were found to follow the topology of aligned structures. This is reflected in the results by the competitive performance of sequential methods, SPalign and SALIGN, in terms of RMSD and SO.shows the 9538 pairwise SO values from SPalignNS as compared with HOMSTRAD (left) and CLICK (right). SPalignNS yields higher SO values than HOMSTRAD in 7832 cases (82%) whereas HOMSTRAD has only 263 cases better than SPalignNS. Similarly, alignments generated from SPalignNS have higher SO values than CLICK in 6820 alignments (71%) whereas CLICK have better SO values only in 972 cases. Also it can be seen that SPalignNS was able to consistently achieve SO scores greater than 40% for all alignments in this dataset. The insert charts of
HOMSTRAD homologous proteins
Difficult cases of aligning homologous protein pairsPresented inare the comparative results for the 64 pairwise protein structure alignments of the difficult HOMSTRAD alignments dataset. It can be seen that SPalignNS again achieves the highest average SO with the lowest RMSD in comparison to all of the other methods. SPalignNS also achieves a statistically significant
Fast and accurate non-sequential protein structure alignment(P-value < 0.05) improvement in terms of SO when compared with each method. On average SPalignNS was able to locate five more well-aligned residues compared to CLICK with an RMSD reduction of 7%. For CPU cost SPalignNS demonstrates a significant reduction (approximately 65%) of required processing time compared to CLICK. The fastest methods, MICAN and SPalign, resulted with an increased RMSD (approximately 0.75 A  ) compared to SPalignNS, CLICK and GANGSTA . This is indicative of the increased average number of aligned residues (approximately 25%) found, and since all atoms in the structures are weighted equally when calculating RMSD, the RMSD is heavily dependent on protein size and very sensitive to any badly aligned regions and local structural changes (). However, SPalign achieved a comparable SO result to CLICK, again this is likely due to the large number of sequential similarities present in this dataset as discussed in the previous HOMSTRAD homologous proteins dataset results.presents the breakdown of individual SO results for the 64 pairwise alignments (top) where the individual SO scores from CLICK and HOMSTRAD (x-axis) have been plotted against respective SO scores from SPalignNS (y-axis). Also included is the distribution of SO improvement (bottom) that shows the percentage of pairwise alignments in the dataset changed by D SO (%) as compared to SPalignNS. it can be seen that SPalignNS is the only method that consistently achieves SO scores of at least 50% or more for all alignments, and there was not a single case where a HOMSTRAD alignment had a superior SO value compared to SPalignNS, with the exception of 5 cases having identical SO values. Finally, comparing SPalignNS to CLICK it can be seen the majority of alignments have been improved by at least 5% SO, and comparing SPalignNS to HOMSTRAD the majority of alignments have been improved by at least 10% SO.
Similar structure but different topologyPresented inare the comparative results for the 199 pairwise protein structure alignments of the similar structure but different topology dataset. It can be seen that SPalignNS achieves the highest average SO percentage of all methods, with a comparable RMSD to the lowest RMSD achieved by CLICK differing by only 0.03 A . However, on average SPalignNS found three more aligned residues which makes this negligible increase of RMSD acceptable. SPalignNS also achieved a statistically significant (P-value < 0.05) improvement in terms of SO over each method for this dataset. In terms of CPU cost, it can be seen that SPalignNS again demonstrates a significant reduction (approximately 65%) to required processing time compared to CLICK, and approximately a 40% reduction of CPU requirements compared to FlexSnap. MICAN, the fastest nonsequential method, has the second largest RMSD and approximately 25% less SO compared to SPalignNS. By releasing the ordering constraint and performing alignments non-sequentially, a significant improvement of SO can be noticed from all the non-sequential methods compared to sequentiallypresents the breakdown of individual SO results for the 199 pairwise alignments where the individual SO scores from CLICK (x-axis), have been plotted against respective SO scores from SPalignNS (y-axis). Also included is the distribution of SO improvement (inset) that shows the percentage of pairwise alignments in the dataset changed by D SO (%) as compared to SPalignNS. Here this again demonstrates that in the majority of cases, SPalignNS was able to align more residues than CLICK within 3.5 A  with the improvement to SO mostly between 5% and 10%.
RIPCThe RIPC set contains protein pairs with very difficult structural relations including repetitions, large InDels, circular permutations and conformational variability (). Here, alignments generated by computational methods are compared to the provided reference alignments. Presented inare the comparativethe reference alignments with a total agreement of 80.5% (227 out of 282 residues) and has the lowest RMSD and the largest SO when compared with all other methods. It was the second fastest non-sequential method, approximately twice as fast as CLICK. Compared to the next best performing non-sequential methods, CLICK and MICAN, SPalignNS has an improvement of agreement by 10-15%. The MICAN method performs the fastest but has the largest RMSD and nearly 10% less SO than SPalignNS.
Case study
at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
number of recent sequential and non-sequential structure alignment methods by performing trials with commonly used datasets including two benchmarks containing known occurrences of proteins with non-sequential structural similarities. The three most recent non-sequential methods were used to compare against: FlexSnap (Salem et al., 2010), CLICK (Nguyen et al., 2011) and MICAN (Minami et al., 2013). Pre-compiled Linux binary files were downloaded and executed for FlexSnap available from http://www.cs.rpi.edu/$zaki/software/flexsnap, and for CLICK available from http://mspc.bii.a-star.edu.sg/click. The freely available source code for MICAN was downloaded and compiled from http://www.tbp.cse.nagoya-u.ac.jp/MICAN. It should be noted that all methods were executed using default parameters, and CLICK was used with the MODELLER software (Sali and Blundell, 1993) in order to replicate the published results in Nguyen and Madhusudhan (2011). The benchmark datasets used to gauge alignment accuracy include (i) 9538 pairwise alignments implied by the HOMSTRAD database of homologous proteins, assessing the performance on alignments with the same topology; (ii) a subset of 64 difficult alignments from set (i) that have low structure similarity; (iii) 199 pairwise alignments of proteins with similar structure but different topology; and (iv) a subset of 20 pairwise alignments from the challenging RIPC set.
P.Brown et al. at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
To illustrate the usefulness of SPalignNS, we apply it to the protein pair 2ES91SXJ that have a non-sequential structure relationship as discovered by Guerler and Knapp (2008). Comparative metrics for this alignment can be found in Table 5. Presented in Figure 4 is the SPalignNS alignment (left), the SPalign alignment (middle) and the CLICK alignment (right). It can be seen here that the sequential alignment has almost successfully aligned all a helices, with exception of the far left to the far right as shown in the left portion of the figure. Interestingly, the best CLICK alignment has produced an almost identical result as SPalign, both of which achieve an SO value close to 55%. By aligning non-sequentially with SPalignNS it can be seen from the middle portion of the figure that all of the alpha helices have been matched to a corresponding helix, and SO increases significantly to 81.82% (approximately 25% improvement). The FlexSnap method was also able to achieve a comparable alignment to SPalignNS for this pair, with a slightly lower SO value of 80.80% and increased RMSD. 4 Conclusion The three dimensional structure of proteins at near atomic level resolution often gives an indication of their evolution and function. In particular, similarity in structure often implies similarity in function, so predictions of protein functional similarity can often be facilitated through structural comparison results. Given the rapid rate at which protein structures are being determined, it is crucial to have fast and accurate computational tools to classify and categorize these structures. Although there are a large number of existing sequential and non-sequential protein structure alignment methods, none of them provide an optimal structure alignment with comparable quality to manual curation for all protein pairs. As a consequence, considerable scope exists for the development of new techniques that are able to both improve alignment accuracy and minimize computational processing time. Traditionally, the identification of similarity in structure of protein pairs has been performed using methods which preserve the sequence order of the proteins. However, in some cases this has been an overly restrictive constraint as function of a protein is often decided by only its global shape without considering its internal topology. Thus, relaxing this constraint has lead to the discovery of previously hidden structural similarities. The development of fast and accurate non-sequential protein structure alignment tools provide the potential of uncovering of new evolutionary or functional relationships between protein structures containing topological permutations. This study presents SPalignNS, a new non-sequential protein structure alignment tool by using a novel asymmetric linear sum assignment heuristic. Specifically, the Asymmetric Greedy Search algorithm was shown to produce viable non-sequential structure alignments of proteins. The performance of SPalignNS was evaluated by performing trials with commonly used datasets containing known occurrences of proteins with non-sequential structural similarities. SPalignNS was able to achieve greater alignment accuracy when compared with sequential, as well as non-sequential alignment methods. Statistically significant P-values < 0.05 were attained when comparing the percentage of high-quality residue alignments measured by SO coverage of SPalignNS against the other methods compared across all benchmark dataset experiments. Finally, SPalignNS is generally 3 times faster than the CLICK method.
