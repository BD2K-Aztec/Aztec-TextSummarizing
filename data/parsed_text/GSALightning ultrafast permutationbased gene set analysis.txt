The computational speed of many gene set analysis methods can be slow due to the com-putationally demanding permutation step. This article introduces GSA-Lightning, a fast implementation of permutation-based gene set analysis. GSA-Lightning achieves significant speedup compared with existing methods, particularly when the number of gene sets and permutations are large. Availability and implementation: The GSA-Lightning R package is available on Github at https:// github.com/billyhw/GSALightning and on R Bioconductor. The package also contains a comprehensive user's guide with a step-by-step tutorial vignette.
IntroductionGene set analysis embodies a range of techniques for analyzing the functional and biological properties of differentially-expressed genes. One common type of gene set analysis method, termed selfcontained method (), tests whether genes within a predefined gene-set are collectively differentially expressed across two different experimental conditions. The gene set's significance is typically assessed through permutation testing. Due to the computationally-demanding permutation tests, the speed of permutation-based gene set analysis methods is often compromised. There is a need to address this computation issue, particularly when performing large-scale analysis. As an example, for a genome-wide expression analysis of target genes of regulatory elements (), the number of gene sets, each set being the target genes of a regulatory element, can reach tens of thousands. If there areexpression measurements, and the gene set statistics are functions of the mean of the individual statistics. All these quantities can be computed efficiently using matrix products. Also, it is actually possible to perform the permutations using matrix products. The online Supplementary Materials provide details on how this can be done. Speed and memory efficiency are further increased by using sparse matrix computations whenever possible. When the number of permutations is large, GSA-Lightning breaks the permutations into batches. Each batch is handled separately and then combined to obtain the final results. The online Supplementary Materials provide further details, and also contain a justification of the equivalence between GSA-Lightning and GSA by comparing the two methods' program outputs. This justifies that GSA-Lightning does not sacrifice GSA's accuracy in order to achieve the speedup.
ResultsOnly methods with R implementations were compared to ensure hardware-independent results. Focusing on permutation-based twosample testing, non-permutation-based methods were not compared. GSA-Lightning (with the 'maxmean' option and restandardization) was compared with six other methods using their default options unless stated otherwise. These methods were GSA (with the 'maxmean' option and restandardization) (), gseattperm from the R Bioconductor package Category, the self-contained version of SigPathway (), SAFE (), Globaltest () and PADOG (). All analyses were performed using a MacBook Pro with a 2.3 GHz Intel Core i7 processor and 16 GB RAM. The gene sets used were the target genes of 36 381 distal regulatory elements from () with three or more target genes. The breast cancer data set from The Cancer Genome Atlas (The Cancer Genome Atlas Research) downloaded using the ELMER R Bioconductor package () was used as the gene expression data. The data set contained gene expression measures for 114 controls and 1104 patients. After removing genes without matching gene symbols and/or with 0 sample variance, 20 038 genes remained for further analysis. Three speed trials were performed to examine the speed of the various methods. First, the number of gene sets was fixed at 500, and the number of permutations varied from 500 to 10 6. Second, the number of permutations was fixed at 1000, and the number of gene sets varied from 500 to 30 000. The third trial mimics a more realistic scenario: the numbers of gene sets were the same as in the second trial, but the number of permutations varied according to 2  (no. genesets)/0.05. This number of permutations ensured accurate P-value estimation even after multiple correction at significance level 0.05. Only GSA-Lightning, SigPathway, and Globaltest were tested in this trial as the other methods were too slow here.presents the results. GSA, SAFE and PADOG were not run for number of permutations >10 000, and gseattperm was not run for >50 000 permutations since these methods were too slow. Also, SigPathway and Globaltest encountered memory issues when the numbers of permutations were respectively >10 6 and 10 5 in the first trial, and when the number of gene sets was >5000 in the third trial, and hence were not performed there. GSA-Lightning was faster than all other methods. In particular,suggests that GSALightning was the only method that could analyze large amounts of gene sets with a large number of permutations within reasonable time. In the experiments above, the maximum RAM usage for GSALightning was 4 GB. A speed comparison between the different gene set statistics, with or without restandardization, for GSA-Lightning and GSA is provided in the online Supplementary Materials. Note that all the methods compared earlier are based on different test statistics. The results and sensitivity of these methods will therefore be different, depending on the data set and the methods' assumptions. Nevertheless, a recent review considered GSA with the 'maxmean' statistics one of the better gene set analysis methods (). By virtue of GSA's strengths, a fast version of GSA is worth developing. Also, a detailed speed comparison would involve comparing separately the speed for calculating the individual gene statistics, the gene set statistics, and the permutation. Such comparison is beyond the scope of this article. Still, for large-scale gene set analysis, the results above suggest that GSA-Lightning is the only possible option among the methods compared. Altogether, GSALightning is a tool capable of performing large-scale gene set analysis with statistical power guarantee.
Funding
000 gene sets, the significance level of 0.05 becomes 1.67  10 6 after Bonferroni correction. One million permutations are now required for accurate P-values estimation. Most existing methods are computationally infeasible in this case, due to the large number of gene sets and number of permutations required. This article introduces GSA-Lightning, a fast and memory-efficient implementation of permutation-based gene set analysis. Through a speed comparison of GSA-Lightning and other existing permutation-based gene set analysis methods, we demonstrate that GSA-Lightning is computationally much more efficient, particularly when the number of gene sets and permutations are large. 2 Implementation GSA-Lightning is based on the GSA method (Efron and Tibshirani, 2007). GSA-Lightning computes the student-T statistics for each individual gene, and provides the 'maxmean', 'mean' and 'absolutemean' options for combining the individual gene statistics into gene set statistics. Similar to GSA, GSA-Lightning provides the restandardization procedure and further supports independent and paired two-sample tests. GSA-Lightning takes advantage of R's efficiency in matrix computations, and achieves substantial speedup by calculating the gene set statistics and their permutation distributions through matrix computations. Indeed, the student-T statistics mainly depends only on the mean and standard deviation of the V C The Author 2016. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com 1 Bioinformatics, 2016, 13 doi: 10.1093/bioinformatics/btw349 Advance Access Publication Date: 13 June 2016 Applications Note Bioinformatics Advance Access published July 6, 2016 at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
B.H.W.Chang and W.Tian at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
