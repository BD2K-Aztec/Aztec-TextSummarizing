Phylogenetics, likelihood, evolution and complexity (PLEX) is a flexible and fast Bayesian Markov chain Monte Carlo software program for large-scale analysis of nucleotide and amino acid data using complex evolutionary models in a phylogenetic framework. The program gains large speed improvements over standard approaches by implementing 'partial sampling of substitution histories', a data augmentation approach that can reduce data analysis times from months to minutes on large comparative datasets. A variety of nucleotide and amino acid substitution models are currently implemented, including non-reversible and site-heterogeneous mixture models. Due to efficient algorithms that scale well with data size and model complexity , PLEX can be used to make inferences from hundreds to thousands of taxa in only minutes on a desktop computer. It also performs probabilistic ancestral sequence reconstruction. Future versions will support detection of co-evolutionary interactions between sites, prob-abilistic tests of convergent evolution and rigorous testing of evolutionary hypotheses in a Bayesian framework. Availability and implementation: PLEX v1.0 is licensed under GPL. Source code and documentation will be available for download at www.evolutionarygenomics.com/ProgramsData/PLEX. PLEX is implemented in Cþþ and supported on Linux, Mac OS X and other platforms supporting standard Cþþ compilers.
INTRODUCTIONComparative genomic and phylogenetic datasets are growing dramatically in size, thanks to rapid and inexpensive next-generation DNA sequencing technologies. The wealth of information present in large datasets, however, is difficult to exploit due to the non-linearly increasing computational burden imposed by increasing data size and model complexity (). For example, it is not uncommon for phylogenetic analysis of large datasets to now incur compute times on the order of months, even with models that are fairly simple from a mechanistic, biochemical perspective (e.g.). To help overcome these challenges, we developed Phylogenetics, Likelihood, Evolution and Complexity (PLEX), which implements rapid data augmentation methods using partial sampling of substitution histories () and derivative methods. PLEX is an active research platform and will support the future development of new models and algorithms. The capabilities of PLEX will therefore expand over time. For example, the current version now incorporates more models than previously as well as implementations of conjugate Gibbs sampling () and slice sampling (). phylogenetic analysis task (). Furthermore, the approach was designed to substantially reduce the scaling of time complexity with model complexity (Supplementary), so that model realism can be more effectively explored without the need to greatly oversimplify models for computational convenience. For example, the times to achieve an average of 1000 effectively independent posterior samples on a large dataset are shown for a variety of amino acid substitution models (). Remarkably, the most parameter-rich site-homogeneous model in this set is also the easiest to sample from (and therefore the fastest), because conjugate Gibbs sampling mechanisms are possible for all parameters in this case (general non-reversible). Thus, not only do these approaches reduce the need to simplify models for computational convenience but also in some cases they facilitate an inversion of incentives, making complex models more computationally convenient than simpler ones. It should be noted that similar contrasts can be constructed when exact substitution timings are augmented (). For performance comparisons between PLEX and several popular phylogenetics programs, see Supplementary Results. When Gibbs update mechanisms are unavailable for a given model, PLEX uses slice sampling or MetropolisHastings updates. The simple form of PLEX's likelihood function often makes likelihood evaluations for these mechanisms extremely rapid and sometimes even O(1) (). The PLEX code is written in C/C and has no dependencies on external libraries. It should therefore compile on any platform that supports standard C/C.
APPLICATIONSPLEX is run at the command line using a control file interface that allows customization of analyses, including locations of input sequence alignments and tree topologies. Example control files are included that demonstrate how to run most types of supported analyses. Any position in the alignment possessing a gap can be excluded or optionally treated as missing. PLEX currently has several main uses, including:(1) Rate matrix and branch-length estimation from hundreds to thousands of taxa in minutes on a desktop computer.(2) Inference of site heterogeneity in substitution patterns.(3) Probabilistic inference of ensembles of ancestral states.(4) Calculation of posterior statistics of substitution histories (e.g. for tests of co-evolution; our unpublished data).(5) Hypothesis testing and model evaluation using posterior-predictive statistics (scripts to automate thermodynamic integration will be made available in a future release). PLEX is an active research platform for the development of new models and algorithms. As such, it will be updated frequently and will grow in capabilities over time. We therefore expect that PLEX will continue to evolve into an increasingly capable and comprehensive package for studying molecular evolutionary mechanisms.
APPROACH PLEX performs Bayesian Markov chain Monte Carlo (MCMC) analysis using novel data augmentation strategies that can afford it great speed advantages over MCMC packages that use fully integrated likelihood calculations (e.g. MrBayes, Ronquist and Huelsenbeck, 2003 and BEAST, Drummond and Rambaut, 2007). Speed advantages are obtained by 'partially sampling' substitution events to the nearest branch region and rapidly integrating over the timing of events within regions when evaluating the likelihood. This approach can be much faster than sampling the exact timing of substitution events, but appears to retain the computational advantages of doing so (de Koning et al., 2010). As a result, PLEX is faster than programs that augment sequences with fully specified substitution histories (e.g. PhyloBayes; Lartillot et al., 2009). The program samples branch lengths, model parameters and 'missing' unobserved data (e.g. ancestral states) from their posterior distributions and provides posterior summaries to facilitate inferences about evolutionary mechanisms. The distribution also includes the ability to calculate posterior statistics of substitution histories, which can be an effective approach for making complex inferences from comparative data without fully modeling the processes of interest (e.g. for detecting co-evolution; our unpublished data). Posterior-predictive simulation is included for some model checking applications, and Bayes factor calculation can be made using thermodynamic integration (Lartillot and Philippe, 2006; Rodrigue and Aris-Brosou, 2011). Importantly, the speed advantages enabled by PLEX's data augmentation approach help to overcome computational challenges of large-scale phylogenomic inference in general and are thus applicable to virtually any evolutionary model or *To whom correspondence should be addressed.  The Author 2012. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
CONCLUSION PLEX is a software package for performing rapid and accurate Bayesian MCMC analysis on large phylogenomic datasets that remain under active development. Future updates will include models of temporal heterogeneity, spatial substitution gradients (Faith and Pollock, 2003) and codon substitution. It is likely that parallelization and tuning of our slice sampling algorithms will further substantially improve speed for certain complex analysis tasks and will thus be pursued in future releases.
A.P.J. de Koning et al. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
