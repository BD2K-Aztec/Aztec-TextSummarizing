Motivation: As the quantity of genomic mutation data increases, the likelihood of finding patients with similar genomic profiles, for various disease inferences, increases. However, so does the difficulty in identifying them. Similarity search based on patient mutation profiles can solve various translational bioinformatics tasks, including prognostics and treatment efficacy predictions for better clinical decision making through large volume of data. However, this is a challenging problem due to heterogeneous and sparse characteristics of the mutation data as well as their high dimensionality. Results: To solve this problem we introduce a compact representation and search strategy based on Gene-Ontology and orthogonal non-negative matrix factorization. Statistical significance between the identified cancer subtypes and their clinical features are computed for validation; results show that our method can identify and characterize clinically meaningful tumor subtypes comparable or better in most datasets than the recently introduced Network-Based Stratification method while enabling real-time search. To the best of our knowledge, this is the first attempt to simultaneously characterize and represent somatic mutational data for efficient search purposes.
IntroductionDue to advancements of genome scale sequencing data of patients, sequencing will become a common practice in medicine (). In the near future, the amount of patient records that include gene mutation data will be huge. As the quantity of genomic mutation data increases, the likelihood of finding patients with similar genomic profiles, for various disease inferences, increases. However, so does the difficulty in identifying them. Even with the significance of the impact and need, genomic-based patient similarity searching has not yet been actively studied by the bioinformatics community.
Types of genome dataEach type of genome data has different significance for each of the disease. However, the most commonly studied data that are expected to be associated with many of the disease, other than the gene expression, are the sequence mutation data. In the recent years, huge numbers of tumor samples have been sequenced in large-scale projects such as The Cancer Genome Atlas (TCGA) (The Cancer Genome Atlas Research) and the International Cancer Genome Consortium (ICGC) (). Due to the current limitations on the availability of patient data, we focus on mutation data from cancer patients, because such V C The Author 2015. Published by Oxford University Press.
3653This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (http://creativecommons.org/licenses/by-nc/4.0/), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com3659 doi: 10.1093/bioinformatics/btv409 Advance Access Publication Date: 23 July 2015 Original Paper data are relatively abundant. However, the proposed method is not limited to (somatic) mutations alone and can further be extended to combine various types of genome data.
Somatic mutations and associated challengesSomatic mutations are mutations that are not inherited from the parents. Assuming that fewer somatic mutations occur in normal cells than in cancer cells, a typical method to identify somatic mutations in cancer patients is to find the differences between genome sequences of normal tissues and cancer tissues (). Characterizing cancer patients with somatic mutations is a natural process for cancer studies because cancer is the result of massive disruption of genes by various causes (). Note that with other diseases, somatic mutations may not be as significant as in cancer. Somatic mutation data as well as other type of mutation data are sparse in character. That is, compared with all possible mutations, the actual number of mutations is small. Typically, 100200 genes have somatic mutations among 20 000 human genes for a cancer patient (). Also, for complex diseases, including cancer, mutations are genetically heterogeneous (). That is, even for patients with similar clinical phenotype, raw mutational profiles can be divergent. Various efforts have focused on making sense of the heterogeneity, especially in cancer data (). However, for our purpose, we focus on reducing the effect of heterogeneity in the identification of similar patients.
Gene-Ontology and orthogonal non-negative matrix factorizationThe Gene-Ontology (GO) provides consistent and unified functional descriptions of genes and gene products across databases, and is used in various tasks including functional profiling of gene sets (). Typical GO applications utilize terms at a particular depth in the GO hierarchy (). However, such approach has the problem of biological terms in different levels of the GO hierarchy (). Our method includes a proposal to solve this problem. In various contexts, NMF is a widely used method for various clustering tasks and is known to be more accurate than other methods such as principal components analysis and singular vector decomposition (). Orthogonal NMF (ONMF) puts an orthogonal constraint on creation of the basis vectors (or encoding vector) and is shown to improve the accuracy of NMF in clustering (). Besides the clustering capability, NMF and ONMF have the potential for use in compact representations. However, the capability of NMF and ONMF in terms of indexing and searching in cancer genomics has not been widely explored. In this work, we exploit both the clustering and the representative capabilities of NMF and ONMF.
Characteristics of proposed methodThe main characteristics of the proposed patient mutation profile are as follows:@BULLET Compact. The resulting patient mutation profiles have dimension <10, the number of the subtypes, which varies according to cancer types. This also removes the sparsity problem. @BULLET Enable real-time search. We can retrieve similar patients within 0.08 s using simulated data size of 10 000. @BULLET Tolerant to heterogeneity. The resulting profile shows tolerance to genetic heterogeneity, and tolerance to difference in diagnostic environments. @BULLET Directness in function interpretation. Mutations map to GO terms in which function interpretations can be made directly. @BULLET High predictive power for clinical features. The cancer stratification results show it has high predictive power (or high correlation) for clinical features (the histological basis feature or the survival time) compared with Network-Based Stratification (NBS) ().
Materials and Methods
Overview of patient profile construction and validationThe first step in patient profile generation () is to extract mutation profiles. We use somatic mutations to generate the mutation profiles of cancer patients. For each patient, a mutation profile is represented as a binary vector in which each entry is 1 if any of the somatic mutations is present in the gene compared with germ line, 0 otherwise. Next, GO-based mutation profiles (GO-MP) are obtained by multiplying the mutation profile matrix by the gene profile matrix. The gene profile matrix is constructed based on the geneGO relationships. Each gene is represented as a binary vector in which each entry indicates a binary state of the association between gene and its GO terms. The influence of GO terms at non-leaf nodes spreads to their descendant terms according to the GO hierarchy. The influence spread is computed iteratively until only the GO terms at the leaf nodes have non-zero entries. Finally, a compact ONMF mutation profile (ONMF-MP), is obtained by using ONMF () to factorize GO-MP and taking the encoding matrix as the profile of the patients. In experiments, analysis of cancer stratification is conducted to verify the quality of the proposed profiles, and top-k searches are performed with the ONMF-MP to verify real-time search capability and search characteristics.
DatasetSomatic mutation information of level-2 exome and clinical data for ovarian serous cystadenocarcinoma (OV), lung adenocarcinoma (LUAD), uterine corpus endometrial carcinoma (UCEC), glioblastoma multiforme (GBM) and breast invasive carcinoma (BRCA) from TCGA were downloaded and filtered. Data from patients that have fewer than 10 mutations were discarded, because consistently capturing relations among patients requires at least 10 mutations. This filtering process left 441 patients with 12 431 genes for the OV data, 516 patients with 18 067 genes for the LUAD data, 247 patients with 20 446 genes for the UCEC data, 291 patients with 9341 genes for the GBM data and 772 patients with 13 078 genes for the BRCA data.
Constructing mutation profilesGO functional terms and ONMF are used to construct proposed mutation profiles: GO-MPs and ONMF-MPs. Two major benefits of GO-based representation are that it reduces the genetic heterogeneity and sparsity, and that it enables direct function interpretation. The distinction of our approach in application of GO is that we take a genome-scale approach for GO-based function analysis in construction of the proposed mutation profiles. That is, unlike typical function profiling methods, in which a small number of preselected genes is analyzed to find the most relevant functional terms, we unbiasedly consider all genes during the analysis. Moreover, we use the most specific functional terms, i.e. the leaf node terms, to minimize the inter-correlations between terms. Benefits in using ONMF are that it further reduces the heterogeneity and makes the profile even more compact by separating out global signatures with sample weights for the signatures. Details of construction are as follows.(Somatic) mutation profile, S patientgene : For each patient, the mutation profile s i is represented as a binary vector in which each entry indicates the binary state of the gene; in case of somatic mutations, 1 if any of somatic mutations (i.e. a single-nucleotide base change and the deletion/insertion of bases) has occurred in the gene compared with the germ line (or normal tissue), 0 otherwise. As aforementioned, mutations occur heterogeneously even for patients with the same cancer type, and the frequency of occurrence is slight making the profile matrix S divergent and sparse. Gene-function profile, G geneGO : A gene-function profile is represented as a binary vector in which each entry indicates the binary state on a gene; 1 if a gene is associated with the GO term (information mapping gene sequence to accession number (gene2accession) and gene to GO term (gene2go) are obtained from NCBI), 0 otherwise. A GO term of a node is highly correlated with GO terms of its descendant nodes as well as its ancestor nodes due to its hierarchical structure (The GO hierarchy of biological processes (BPs) is from GO version 2014-02-02;). To ensure that only qualified GO terms are used, GO terms of 'Non-traceable Author Statement' (NAS), 'No biological Data available' (ND) and 'Not Recorded' (NR) are ignored (). To reduce the term correlation, we use only the most specific terms, i.e. the leaf node term after propagating the scores of the non-leaf terms down to the leaf node terms. This approach also resolves the problem of evaluating genes annotated with general term as the effect of the gene of function identification is spread out over several leaf node terms. We do this by defining an asymmetric adjacency matrix of GO, M GO , where entry (i, j) indicates the parent(i)-child(j) relationship, and only the diagonal entries of leaf nodes are 1. This matrix is further normalized according to the node degree. Equation for the iterative influence propagation is as follows:where G t is the gene profile matrix at the t-th iteration. This process is repeated until G t converges (usually within 15 iterations), then the matrix entries of the non-leaf nodes become zero. GO-based mutation profile (GO-MP), X patientGO : The GO-MP is generated as X 0  S  G, where S is the initial mutation profile matrix and G is the gene-function profile matrix using 'BP' domain of GO. By this process, each entry of a GO-MP becomes a weighted sum of the gene contributions on each GO term. The rows of the resulting X 0 are further quantile normalized to X by enforcing the distribution of the GO profiles to be identical. Using the mutation profile S without the gene-function profile, G geneGO , usually shows reduction in the performance of the predictive power of clinical features (Supplementary). In addition, we have tested different combinations of GO domains for generating gene-function profile matrix and BP domain showed the most consist and accurate results compared with other GO domain combinations (Supplementary). ONMF mutation profile (ONMF-MP), W patientsubtype : The GOMP is further made compact by taking the encoding matrix W of ONMF on X (Eq. 2) as profile vectors. This process reduces the number of dimension of a patient profile to the number k of subtypes while maintaining all information contained in H. Details are provided in the next section.
Representation and stratification with ONMF2.4.1 Non-negative matrix factorization NMF factorizes a non-negative data matrix into non-negative basis vectors and their non-subtractive combinations. Specifically, given data matrix X with n observed data points fx i g n i1 , NMF seeks a decomposition of X as follows:where H contains basis vectors and W contains encoding vectors that represent the extent to which each basis vector is used to reconstruct each input vector. More specifically, based on randomly initialized matrices W and H, NMF finds the solution of minjjX  WHjj 2  P i P j X i;j  WH i;j  2 by applying the multiplicative update rules ():The mutation profiles are represented as a binary vector in which each entry indicates a binary state of a gene. The GO-based mutation profile matrix, X, is obtained by multiplying the mutation profile matrix, S, and the gene function profile matrix, G. The ONMF mutation profile matrix, W, is obtained by factorizing GO-MPs through ONMF. For stratification, we assign the patients to the cluster that has the highest value based on the encoding vector. For query search, the query profile is generated by minimizing reconstruction error between the mutation profile and the estimated profile multiplied by latent basis vector, and patients who are similar to a given query patient are identified by calculating the Euclidean distance between them and the query patient
GO and ONMF-Based Mutation ProfileH i;j ! H i;j  W T X i;j W T WH i;j ;where X i;j  X i;j indicates (i,j)-th element of the matrix X.
Orthogonal NMFONMF puts an orthogonal constraint on the encoding matrix (HH T  I) which generates signatures of subtypes that are orthogonal to each other. The ONMF allows emphasizing significant GO terms for each subtype, which make the interpretation easier. Also, ONMF have been shown to perform better than NMF for certain cases (). To solve the optimization problem with orthogonal constraint on H, the Lagrangian, L, is used as follows:where X is the symmetric matrix containing Lagrangian multipliers. According to (), the multiplicative update rules can be derived by using the true gradient on Stiefel manifold:where the update rule of W follows Equation (3). ONMF allows better interpretation of the factorized results and usually results in better clustering quality (). The dimension of ONMF-MP is determined based on the performance of the predictive power. For example, for UCEC and BRCA, the dimension used is four (Section 3.2.2).
Stratification and top-k search using ONMFAfter factorizing X into the encoding matrix W and the basis matrix H, we use the encoding matrix for cancer stratification. Specifically, for stratification of patients into k-th subtypes, we assign patients x i to cluster k  which has the highest value based on the encoding vector, as:In this work, to enable reuses of factorized matrices and to allow for real-time search capability, consensus clustering is not used. The dimension of ONMF-MP is determined based on the dimension that resulted in the best performance in the predictive power test (Section 3.2.2). Stratification using K-means have been tested. However, there were no significant differences in the results (Supplementary) showing that the proposed profiles are not dependent on the type of clustering methods used. To retrieve top-k similar patients, it is required to compute query-patient similarity scores in the ONMF-MP. Thus we compare the vectors in the encoding matrix W with the ONMF-MP of a query patient, w  q  min wq q  w q  H, where q is the GO-MP of a query patient. It is used to seek patients who are similar to a given query patient by calculating the Euclidean distance between the query profile and patient profiles in the database.
Search performance validationWe validated the proposed profiles using accuracy measures and speed calculation of top-k search results. In a top-k search, we used the similarity of clinical profiles to determine whether the search results are correct. Clinical profiles were constructed based on a set of clinical features that have statistically significant correlation with the cancer subtypes. Statistical significance was evaluated by the P value of log-rank test for the cancer subtypes on clinical features. We considered P value 0:05 as significant. Two types of clinical profiles were tested: profiles with single clinical feature and profiles with combinations of clinical features. The accuracy of top-k search using single features was computed by dividing the number of patients retrieved with the same clinical feature to that of the query patient by k, the number of patients searched. Overall accuracy of the dataset was computed by taking the average of the leave-one-out top-k search accuracies. Accuracy calculation using combination of clinical features was conducted similarly, except that two patients are determined as similar when the number of overlapped features over the entire number of features is larger than or equal to the threshold h%.
Results
Search accuracy and speedIn this section, we validated the effectiveness of the proposed profile by accessing its accuracy and speed measurement on the top-k search results using the ONMF-MP. The accuracy of ONMF-MP based topk search was validated by empirical examination of search results and calculation of average search accuracy. The search speed was computed on expanded data to simulate a 'big data' search scenario.
Top-k search accuracyWe first looked at empirical examples of the search results on OV, LUAD, UCEC, GBM and BRCA data. We found examples of clinically meaningful similarities using the ONMF-MP for all five datasets.shows selected examples of query patient and their top-1 search results with list of similar or same clinical features between the query and the top-1 retrieval. Next, we systematically evaluated the retrieval accuracies as described in the Section 2.5. In the experiment, a leave-one-out test of top-1 and top-10 nearest neighbor search was conducted on UCEC and BRCA data. The dimension of ONMF-MP that we used for both UCEC and BRCA data is four, which showed the best performance in the predictive power (Section 3.2.2). Experiments for OV, LUAD, and GBM are not provided due to insufficient clinical information. That is, the clinical features provided in TCGA for the three cancer types had too many missing values or were extremely skewed. We calucluated the accuracy based on single clinical feature that had the best correlation with all compared methods. Using ONMF-MP on UCEC data, 79.04% of the patients had samehistological types as their top-1 similar patient, and on average 65.83% of the patients had the same histological types as their top10 patients. In contrast, the accuracy of GO-MP was 42.74% and 65.44% comparing top-1 and top-10, respectively. This shows that the ONMF-MP finds latent GO relationship among similar patients with reduced sensitivity to experimental environment than does GO-MP. According to the top-k search on the ONMF-MP on BRCA data, 73.42% of top-1 similar patients had the same estrogen receptor status. In contrast to that of UCEC data, GO-MP was more accurate than ONMF-MP (76.01%). However, using ONMF-MP, 80.39% of top-10 similar patients had the same clinical feature whereas only 77.78% were the same using GO-MP. As a second systematic experiment, a combination of clinical features was used as truth-values of the search results for retrieving similar patients using raw somatic mutation profile, GO-MP and ONMFMP. Again, only UCEC and BRCA data were used. For the clinical features of the UCEC, histological type, pathological grade, residual, and histICD03 were used. For clinical features of the BRCA, histological type, estrogen status, progesterone status and margin status were used (the descriptions of the clinical features are provided at https:// tcga-data.nci.nih.gov/docs/dictionary/). The accuracy of top-10 nearest neighbor search on the three profiles shows that GO-MP and ONMF-MP improve the accuracy in finding clinically similar patients compared with raw somatic mutation profiles ().
Search speed and compactnessProfiles of the OV, LUAD, UCEC, GBM and BRCA, were expanded in order to simulate top-k search in a large dataset. The size of clinical bio-data continues to grow. However, it is still not large ( 500) enough to verify the top-k search efficiency of the proposed method in a 'big data' scenario. The simulated datasets were created by iteratively combining a randomly selected pair of profiles to create a new profile until we had 10 000 profiles for each cancer types. The speedup from mutation profile (dim. !22 000) to GO-MP (dim. !3000) and then to the final ONMF-MP (dim. 10) is not surprising because each step is basically a dimension reduction step (). Also, the speed improvement is expected to be more drastic when the dataset size increases, since the search process included the profile generation of the query data that takes up a constant factor of time (data not shown).
Validation of cancer stratificationWe verified the accuracy of the proposed profile by performing cancer stratification experiments and showing meaningful associations between the resulting subtypes and clinical features. We performed stratification tests using GO-MP and matrix decomposition methods NMF and ONMF, and compared the results to that of a recently introduced method called NBS (). NBS is a cancer stratification method that uses gene-gene networks to propagate the effect of somatic mutations across affected genes and their associated genes. We ran NBS using default parameters and gene-gene network on which NBS performed best, i.e. STRING () for UCEC and HumanNet () for OV, LUAD, GBM and BRCA (information mapping gene sequence to accession number (gene2accession) and gene to GO term (gene2go) are obtained from NCBI). After stratification, selected subtypes were validated using two criteria: survival curves and predictive power. To be as fair as possible, we compared results only for the number of subtypes that are the most favorable to NBS as indicated by the logrank test or the v 2 test and P value combination for each dataset.
Survival analysisWe performed survival analysis for each subtype using the Cox proportional hazards regression model () implemented in the R survival package (). We compare a full model consisting of subtypes and clinical features against a baseline model that consists of clinical features only. The following clinical features were used for analysis of OV and GBM datasets: age, gender, clinical stage, histologic grade/type and residual surgical resection. In addition to those features, smoking history was used in the LUAD dataset. Analysis for UCEC and BRCA dataset were omitted due to highly skewed death rates. The log-rank statistics and associated P values were computed to compare survival distributions (or hazard functions) of two sample sets that are right-censored. Based on the best log-rank statistics, the ONMF result was more statistically significant than NBS result in two of three datasets. That is, on LUAD dataset, the best log-rank statistics value of ONMF, 71.26, was higher than that of NBS, 69.15 (). Likewise, the best log-rank statistics value of NMF, 36.79, was slightly higher than that of NBS, 36.12 (). Following the number of subtypes according to the highest log-rank statistics of NBS (C), we use results that stratify dataset to two subtypes for OV, eight for LUAD and four for GBM dataset, in the following analyses.F shows the boxplots of the least aggressive subtype (max) and the most aggressive cancer subtype (min) based on the median survival time. Overall, the three approaches were comparable in that median survival time of the least and the most aggressive subtypes were in similar ranges. Examination shows that ONMF-MP is better at identifying the subtypes with patients having longer survival time for LUAD () and GBM () compared with NBS and NMF. Also, looking at survival time range, NBS assigned some patients with longer survival time to the most aggressive subtype (min) for OV () and LUAD ().shows the survival curve of patients in the min/max subtypes. The survival curves of all the subtypes are provided in the Supplementary. In OV, the three survival curves showed similar pattern for the all three approaches. In LUAD, the all three methods showed clear separation between the maximum survival group and the minimal survival group. However, NBS produced inaccurate survival curves in which the min subtype shows longer survival pattern than the max subtype. In GBM data, NBS was successful at grouping the min survival whereas ONMF was better at grouping the max survival. Overall, the identified subtypes are good indicators of patient survival time (Figs 2DF and 3). According tothe result, NMF and ONMF showed comparable results to that of NBS, and ONMF shows the best stability (C).
Predictive powerTo verify the biological importance of the identified subtypes, we conducted experiments to investigate whether the identified subtypes are predictive of the observed clinical features. Statistical significance between the subtypes was evaluated using Pearson's v 2 test, and associated P values were calculated when survival analysis is not possible due to biased death rates. The predictive power of clinical features was evaluated for UCEC and BRCA data and omitted for OV, LUAD and GBM data again due to biased death rates. To analyze the predictive power of ONMF-MP on UCEC data, six clinical features were generated. The features were created based on histological basis (two histologic grades times three histological types). The identified subtypes extracted by our method were more closely associated with the clinical feature than NBS according to the best v 2 and P value combination (). Also, the distribution of the features of the identified subtypes by ONMF-MP, evaluated on stratification that results in three subtypes, showed a clear distinction between subtypes (). That is, most patients with serous adenocarcinoma and high histological grade were included in the first subtype, patients with low histological grade were included in the second and third subtypes, and the patients with the combination of endometrioid type and high grade were included in the second subtype. Predictive power of estrogen receptor status, which is categorized as intermediate, negative and positive, were evaluated on BRCA data (). The estrogen receptor status was highly correlated with the extracted subtypes by GO-MP and ONMF-MP. In addition, ONMF-MP produced subtypes with the highest correlations to the clinical features even for highly skewed features. Also, the v 2 values of ONMF-MP were larger than NBS and GO-MP in predicting histologic type, which is categorized in to three feature values that are highly skewed to 'infiltrating lobular carcinoma (IDC)' (82% of the samples). That is, only ONMF-MP wassuccessful at grouping the patients with a minor feature, 'IDC' (10% of the samples), to a subtype.
ConclusionWe proposed a compact representation for genome mutation. This representation is called the ONMF mutation profile (ONMF-MP); it is used for efficient search and characterization of patients' genome data, and provides basic information for many data mining tasks in translational bioinformatics. The ONMF-MP uses ONMP to exploit the functional representation property of GO and the ability to correlate GO terms that are latent in a collection of genome mutation data. This representation solves the sparsity problem of mutation data and achieves reduced sensitivity to heterogeneous factors; it also enables genome-based real-time search for similar patients. We show experimentally that stratification results using the proposed representation have comparable or better correlations with clinical features than do those achieved using a recently introduced method. Insufficient clinical information prevents us from using the all five cancer types for the two the validation test to make the validation complete. However, this is not an inherent charateristic of the data and we expect that more data accumulation will evidentially resolve this problem. We also show that the representation can search through millions of patients in milliseconds.. Association between UCEC cancer subtypes and histological clinical features. C1, (serous adenocarcinoma, High grade), C2, (other, High grade), C3, (endometrioid type, High grade), C4, (endometrioid type, Low grade). Only four features are presented and two features with low frequency ( 5) are omitted to increase the visibility
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
S.Kim et al. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
