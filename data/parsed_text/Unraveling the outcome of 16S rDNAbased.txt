Motivation: 16S rDNA pyrosequencing is a powerful approach that requires extensive usage of computational methods for delineating microbial compositions. Previously, it was shown that outcomes of studies relying on this approach vastly depend on the choice of pre-processing and clustering algorithms used. However, obtaining insights into the effects and accuracy of these algorithms is challenging due to difficulties in generating samples of known composition with high enough diversity. Here, we use in silico microbial datasets to better understand how the experimental data are transformed into taxonomic clusters by computational methods. Results: We were able to qualitatively replicate the raw experimental pyrosequencing data after rigorously adjusting existing simulation software. This allowed us to simulate datasets of real-life complexity, which we used to assess the influence and performance of two widely used pre-processing methods along with 11 clustering algorithms. We show that the choice, order and mode of the pre-processing methods have a larger impact on the accuracy of the clustering pipeline than the clustering methods themselves. Without pre-processing, the difference between the performances of clustering methods is large. Depending on the clustering algorithm, the most optimal analysis pipeline resulted in significant underestimations of the expected number of clusters (minimum: 3.4%; maximum: 13.6%), allowing us to make quantitative estimations of the bacterial complexity of real microbiome samples. Contact: a.may@vu.nl or b.brandt@acta.nl Supplementary information: Supplementary data are available at Bioinformatics online. The simulated datasets are available via http:// www.ibi.vu.nl/downloads.
INTRODUCTIONRapidly improving next-generation sequencing technologies have rendered 16S rDNA amplicon sequencing a standard approach to explore the composition and dynamics of complex microbial communities (). The accurate identification of bacteria and discovery of new species with this approach help describe, in unprecedented detail, the hitherto unknown biodiversity in environments such as ocean water () and soil (). On a broader scale, simultaneous sequencing of internal transcribed spacer regions, 16S and 18S rDNA amplicons has led to the successful characterization of bacterial, archaeal and eukaryotic microorganisms (). Within a clinical context, this technique provides novel insights into the relationship between the health status of the host and associated microbiome, for example, the human gut () or oral cavity (). A typical 16S rDNA-based profiling study involves PCR amplification of one or more hypervariable regions (HVRs) of microbial 16S rRNA genes, followed by massively parallel sequencing. Because incomplete 16S rDNA databases limit reference-based taxonomic classification (), a common approach is to perform a taxonomy-independent analysis (TIA), where the sequences (reads) are compared with each other and are clustered into operational taxonomic units (OTUs; conventionally 97% similarity for species-level clustering). The number and sizes of the resulting OTUs describe the diversity in the sample. Among next-generation sequencing platforms that are suitable for amplicon sequencing, 454 pyrosequencing has possibly been the most popular technique due to its relatively long reads and sufficient sampling depth (). Nevertheless, sample diversity and structure estimates based on this procedure are affected by a number of factors, including the DNA extraction method (), choice of primers (), copy number variation (), presence of chimeric () or non-target sequences (), sequencing errors (), and OTU clustering (). Among these, detecting chimeric sequences () and correcting sequencing errors () have perhaps been the most successfully addressed issues by computational means, resulting in a number of algorithms for data pre-processing that incorporate these corrective steps. The removal of such artifacts is key to avoiding accumulation of spurious records in databases (). More importantly, recent studies stress the necessity of data pre-treatment by pointing out that diversity estimates differ orders of magnitude depending on the pre-processing procedure used (). However, conclusive reports on how these methods work *To whom correspondence should be addressed. on a representative scale are limited due to the absence of ground truth in complex environmental datasets. Following pre-processing, accurate clustering of reads into OTUs facilitates the recovery of the community composition in the sample. However, numerous clustering methods used for TIA, such as single linkage or furthest linkage hierarchical clustering (), have been reported to yield considerably different results, and even small changes in algorithm parameters within individual methods can lead to vast differences (). In addition, differences in clustering algorithms, such as different criteria for the ordering of input sequences or the calculation of distance matrices, are likely to yield different clustering outcomes. The evaluation of the various data treatment and clustering methods and their use on real datasets have hitherto been limited to in vitro mock studies, where sample diversities are typically (at least) an order of magnitude less compared with those in real-life situations. Such limitations of in vitro studies have led to the development of simulation software, such as MetaSim () and Grinder (), which are capable of generating complex sequence datasets. These packages, which do not produce the 454-specific standard flowgram format, can be complemented by FlowSim () or 454Sim () to simulate flowgrams (the pyrosequencing output). Nevertheless, some aspects of 16S rDNA pyrosequencing are not amenable to implementation in simulations or cannot be incorporated at all. These include PCR efficiency, primer bias, 16S rDNA copy number variation and realistic read quality scores. Here, using in silico datasets, we aimed to provide an independent assessment of the accuracy and effects of computational techniques on delineating compositions of complex microbial communities using 16S rDNA pyrosequencing. We analyzed two low-complexity experimental datasets and derived data characteristics, which were then used to simulate datasets that are likely to mimic real-life complexity. We applied two widely used data pre-processing tools followed by 11 clustering algorithms on these datasets, and evaluated the accuracy of the resulting clusters using the normalized mutual information (NMI) score and the number of OTUs formed. The overall experimental design is shown in. We show that pre-processing methods have a larger impact on the results of the TIA pipeline than the clustering methods themselves. Without pre-processing, clustering methods were found to yield considerably different outcomes. The workflow that yielded the best agreement with the expected number of clusters resulted in significant underestimations of the expected number of OTUs, depending on the clustering algorithm used. We conclude with a discussion on how these new findings can be projected to earlier studies that describe the microbial complexity in human saliva samples.
METHODS
In vitro datasetsWe studied two GS-FLX Titanium datasets, hereafter referred to as Mock-I and Mock-II, from a mock community of 15 oral bacteria. For both sequencing runs, the V5V7 HVR of the 16S rDNA was amplified using the forward primer 785 F (GGATTAGATACCCBRGTAGTC) and the reverse primer 1175R (ACGTCRTCCCCDCCTTCCTC) (). The reference 16S rDNA sequences were downloaded from the SILVA SSU 16S rRNA database v111 (). The presence of three different 16S rDNA copies in the database for one of the 15 species led to the retrieval of 17 non-redundant reference sequences.
Analysis of in vitro mock datasets2.2.1 Quality filtering The reads were demultiplexed using QIIME v1.5.0 (with the 'truncate_remove' option for reverse primer removal. Two mismatches to both primers and zero mismatches to the barcode were allowed. No filtering was performed based on quality scores, read length, homopolymer region length or the number of ambiguous bases. The read length distribution was calculated by demultiplexing without primer removal.
Chimera detectionAfter quality filtering, the set of true chimeras was approximated by identifying a set of high-confidence chimeras, as previously described by, using the seq.error (hereafter referred to as SEQERR) routine in mothur v1.25.0 (). The SEQERR method is applicable only to datasets where the reference sequences from which the reads originated are known. We used USEARCH UCHIME v6.1.544 (), an algorithm that is widely used for datasets of unknown composition, to identify putative chimeras. The union set of chimeras detected by the de novo and reference-based chimera detection modes of UCHIME was taken as the final list of putative chimeras. Reads were first dereplicated (derep_fulllength), otherwise default parameters were used. The reference database (primers removed) used for the reference-based mode was produced by in silico amplification of the SILVA SSU 16S rRNA database v111 using the 785F and 1175R primers (allowing for one mismatch). The sensitivity and specificity of UCHIME chimera detection in in vitro setswere evaluated based on the set of high-confidence chimeras identified by SEQERR.
Error analysis (in vitro reads)Error rates were calculated using the non-chimeric reads only. To determine the reference sequences of these reads and their relative abundance, chimeras detected by SEQERR were removed from the datasets and the remaining reads (primers removed) were queried against the set of reference sequences using BLASTN () with a minimum similarity threshold of 80%. Reads that were mapped to a reference with a unique top score were then globally aligned to their parents using the needle program in EMBOSS v6.5.7 (). Global alignments were truncated to discard the end gaps. The error rate per base for insertions, deletions, substitutions and ambiguous base calls was normalized by dividing the number of occurrences of each error type by the sum of truncated (pairwise) alignment lengths of all reads. The overall error rate per base for mismatches was calculated as the sum of error rate per base for each error type.
SimulationsFirst, the Mock-I-sim dataset was generated to replicate the in vitro Mock-I dataset as closely as possible. After establishing the in silico reproducibility of the in vitro data properties, two groups of compositionally more complex datasets, collectively referred to as CORE-sim, were simulated. Below, we first detail the methods shared by Mock-I-sim and CORE-sim simulations and then describe these individually.
In silico dataset generationGrinder v0.5.3 (was used to simulate the PCR amplification of full-length (V5V7) nonchimeric amplicons based on a given total read count and a relative abundance profile for the reference sequences. The percentage of nonerroneous reads in Mock-I after quality filtering, which was 66% of nonchimeric reads, was approximated by merging two Grinder-produced datasets: a dataset of amplicons with uniformly distributed substitution errors and another dataset with non-erroneous amplicons (6.2 and 93.8% of Grinder reads, respectively). Further errors were subsequently introduced by 454Sim as described below. Chimeras that constitute 14.5% of all reads in the datasets, in the form of bimeras, trimeras and quadmeras, were generated using CHSIM (), based on a slightly modified n-mera state distribution (bi:81%, tri:18.7% and quad: 0.3%) reported in. The relative abundance of chimeras for each top-parent similarity interval between 89 and 99% was modeled to have a linear increase from 0.05 to 0.15 (e.g. 5% of all chimeras were 8990% similar to their top-parents). The relative abundance of a given parent (reference) sequence in the CHSIM input was assigned the same as that in the Grinder-generated amplicons. Next, Grinder and CHSIM reads were used as input for 454Sim v1.04 () to generate the corresponding flowgrams, which included further insertion and deletion errors. The 454Sim parameters that control the read lengths, homopolymer model for positive flows, and degeneration of positive and negative flows, were manually tuned to obtain a comparable length distribution and error rates to those of the Mock-I dataset.
Mock-I-sim: simulation of 15-species mock datasetThe reference sequences of in vitro mock species and their relative abundances found in Mock-I were used in Grinder to simulate 34 172 full-length and non-chimeric amplicons, of which 32 047 (93.8%) did not contain any errors, while the remainder contained 0.72% substitution errors on average. In accordance with the abundance of chimeric sequences detected by SEQERR in Mock-I, 5786 chimeras were simulated using CHSIM. Finally, a FASTA file of 39 958 reads was processed with 454Sim to obtain flowgrams. To analyze the errors, reads were quality-filtered/ demultiplexed in QIIME by removing primers ('truncate_remove' option) and true chimeras, known by their read labels, were discarded. The remaining non-chimeric reads were aligned to the reference sequences from which they were generated by the needle program, and error rates were calculated as described above for in vitro datasets (Section 2.2). In addition, to investigate the influence of the pre-processing order, the putative chimeras were identified by UCHIME (Section 2.2), without or with denoising the reads using denoiser (). For both treatments, the performance of UCHIME was calculated based on the set of simulated chimeras that remained after quality filtering.
Complex mockdataset simulations (CORE-sim) CORE v2012-02-09 (), an oral microbiome database of 1159 phylogenetically curated 16S rDNA sequences, was amplified in silico using TaxMan () with the 785 F and 1175R primers (no mismatches allowed). Sequences containing ambiguous bases or more than one unique taxonomic lineage in their headers were discarded. The thus filtered CORE database (CORE 1 ) contained 672 amplicons fromnumber of OTUs for each algorithm was derived from its corresponding reference clustering, whereas the number of expected OTUs (due to 97% filtering) was 200. The clustering accuracy was evaluated by calculating the number of OTUs and the NMI score (). The NMI score is penalized when sequences of the same label are assigned to different clusters, as well as when sequences of different labels are assigned to the same cluster (). The NMI score was calculated at both the species and genus level, where taxonomic lineage labels, which were used as the ground truth, were taken from Grinder sequence headers for nonchimeric reads. For chimeras, the lineage of the parent species with the highest similarity to the chimeric read was taken from the CHSIM read headers.
RESULTSWe first analyzed two in vitro datasets from a small mock community. Using simulation packages, we then replicated this mock community in silico and compared the results with the in vitro data. After verifying that the simulation parameters were set appropriately, we simulated two groups of more complex datasets to uncover the effects and accuracy of computational methods on a realistic scale ().
In vitro mock datasets
Error rate estimationTo determine a set of primary data attributes required for simulations, we analyzed two in vitro datasets derived from pyrosequencing 16S rDNA (V5V7 HVR) from a mock community of 15 oral microbes. First, we determined the rate of substitution, deletion and insertion errors. For pyrosequencing, one typically expects the substitution rate to be much lower than insertion and deletion rates, as the main cause of errors is over-and undercalls in homopolymer runs (). However, error analysis of non-chimeric reads in both Mock-I and Mock-II datasets resulted in suspiciously high ratios of substitution errors to insertion and deletion errors. Moreover, the rates of substitutions were 10-fold higher than the reported rates (). The high substitution error rates were identified to be caused by (i) non-specific binding at degenerate primer positions and (ii) the absence of seven (unknown) variant sequences in the reference database, which contained single nucleotide mismatches at one or two positions with respect to their original database references (). These variants were confirmed by Sanger sequencing of newly produced amplicons, starting from genomic DNA. Consecutively, they were added to the initial reference database of 17 sequences. In addition, spurious reads were identified by clustering the denoised non-chimeric reads using UCLUST. Eight spurious OTUs were detected in both datasets and were considered contaminants on manual inspection, leading to the removal of their members (45 reads in Mock-I and 36 reads in Mock-II). The final error rates were calculated using the contaminantfree datasets with the updated reference database. An overall error rate per base of 0.14% for Mock-I and 0.12% for MockII was found for the non-chimeric reads (). More than half the reads in both datasets were entirely error-free (66% in Mock-I and 74% in Mock-II, see Supplementaryfor the error distribution).
Estimatingthe abundance of chimeras 16S rDNA pyrosequencing includes a PCR amplification step prior to sequencing, resulting in the formation of a significant number of chimeras, which can be more than 45% of all reads (). Any realistic computational taxonomy analysis pipeline working with such datasets is required to address this issue. To determine the abundance of chimeric sequences, SEQERR and UCHIME algorithms were separately applied to Mock-I and Mock-II datasets. Using SEQERR, 14.5% (Mock-I) and 17.6% (Mock-II) of the raw reads were found to be chimeric (). The performance of UCHIME was evaluated on the basis of these sets of high-confidence chimeras detected by SEQERR. The sensitivity, precision and specificity of UCHIME in both datasets were found to be 0.92, 0.98 and 1.00 (Supplementary).
In silico mock datasets3.2.1 Mock-I-sim simulations Using the read length distribution, the abundance and forms of chimeric sequences, and the rate of errors found in the in vitro Mock-I dataset, we first replicated the Mock-I datasets in silico. Mock-I-sim, the resulting dataset, contained 39 600 reads after quality filtering, of which 5761 were chimeras generated by CHSIM. The length distribution of reads in Mock-I-sim and Mock-I were almost in complete agreement (Supplementary). The overall error rate in reads when simulated chimeras were discarded was the same as in non-chimeric Mock-I reads (0.14%,), and the distribution of these errors over the dataset was found to be similar to Mock-I and Mock-II (Supplementary). In addition, the overall error rate in reads after chimeras identified by UCHIME were filtered out, as well as UCHIME's performance in terms of sensitivity (0.96) and specificity (1.00), was very similar to the values obtained for Mock-I. Errors occurring along the Lactobacillus casei reference sequence. Mock-I reads, which were mapped uniquely to the L. casei reference sequence by BLASTN, were globally aligned to the reference amplicon. The high substitution peaks at the degenerate positions on the forward and reverse primers reveal non-specific priming. The substitution (G!A) peak at position 260 results from the abundant presence of a variant. The bottom of the figure shows an example with the reference and a read sequence (Supplementary). We note that achieving such resemblance between Mock-I and Mock-I-sim datasets was possible only after extensive re-parameterization of Grinder, CHSIM and 454Sim packages and adjustments in several parts of the simulation pipeline. To determine the effects of the order of the pre-processing steps, chimera checking was performed separately on denoised and non-denoised datasets, using the de novo and reference-based modes of UCHIME. The latter mode outperformed the first in terms of sensitivity, an outcome that was more pronounced on non-denoised sequences (). Taking the union set of chimeras detected by the two modes resulted in an improved sensitivity in chimera detection and did not inflate the number of false-positive chimeras. When the reads were denoised prior to chimera checking, the majority of chimeric sequences with high similarity to their parents were altered by denoising. These reads with altered sequences were not detected as chimeras by UCHIME, resulting in a 440% decrease in UCHIME's sensitivity with respect to the original read labels (Table 2, DCC approach). However, these denoised chimeras did not inflate the diversity estimation, as clustering the reads using UCLUST did not yield any unexpected OTUs. Indeed, chimeric sequences with high parent similarity are likely to be denoised to a non-chimeric state.
CORE-sim simulationsHaving been able to replicate the in vitro Mock-I dataset in considerable detail, we extended the simulations to generate datasets of more realistic diversity. To obtain two reference databases of different compositional properties, CORE 1 and CORE 2 were derived from the CORE oral microbiome database (see Section 2.3.3). CORE 1 contained amplicons that are 497% similar to each other, as well as different amplicons from the same taxonomic lineage. To probe the limitations of a database with such properties, the CORE 2 database was constructed, where the reference sequences were 597% similar to each other and had unique taxonomic lineages. Using each database, 50 representative datasets of 40 000 amplicons were simulated from randomly selected reference sequences. To assess the taxonomy analysis pipeline, each dataset was pre-processed in five different ways: no cleaning (NC), denoised (D), chimera checked (CC), denoised and chimera checked (DCC) and chimera checked and denoised (CCD). The resulting reads were clustered separately by 11 clustering algorithms at a 97% similarity threshold. CRUNCHLUST and swarm do not use percentage similarity, but Levenshtein distance. We set this parameter to 11 based on the average read length (368 nt) and 3% divergence. The clusters were evaluated by calculating the NMI score and the number of OTUs. For each simulated dataset, a non-erroneous dataset was created by discarding chimeric readsA given percentage interval describes the sequence similarity of chimeras in that group to their parents. CC, chimera checked; DCC, denoised and chimera checked.The number of raw reads and chimeras identified by SEQERR and UCHIME after quality filtering (on primers and bar-code errors only), respectively, are shown (Mock-I, Mock-II and Mock-I-sim), along with the number of chimeras generated by CHSIM (Mock-I-sim). The error rates per base (%) after the removal of chimeras by different methods are listed. , chimera removal by SEQERR; , chimera removal by UCHIME; , chimera removal based on CHSIM read labels. and replacing the erroneous reads with the non-erroneous reference amplicon sequences from which they originated. These datasets were used to obtain reference clusterings for each clustering algorithm. Additionally, we set the number of expected OTUs to 200 for CORE 2 simulations because the sequences in CORE 2 are 597% similar to each other. The distinctive compositions of CORE 1 and CORE 2 databases are reflected in the clustering results. In simulations performed using the CORE 1 database, OTUs formed by clustering the nonerroneous (reference) datasets resulted in species-level NMI scores between 0.93 and 0.97 (). This outcome is expected when amplicons from different taxonomic lineages that are 97% similar to each other cluster together. In contrast, the average NMI score per clustering algorithm for non-erroneous datasets in CORE 2 simulations ranged between 0.98 and 1.00 (), indicating that almost all reads were correctly clustered when reads with different taxonomic labels were597% similar to each other. Likewise, for all CORE 2 datasets, a given clustering algorithm produced more consistent numbers of OTUs than in CORE 1 datasets. The variance in the number of OTUs formed by the clustering algorithms for the reference datasets also shows the difference between these databases (and F). At species level (and B), clustering algorithms expectedly yielded higher NMI scores when clustering the nonerroneous datasets than the pre-processed datasets. At genus level, however, denoising followed by chimera checking (CCD), as well as chimera checking followed by denoising (DCC) resulted in NMI scores higher than reference clusterings (and D). This was found to be a consequence of denoising, where sequences of different species of the same genus, which were not assigned to the same cluster at a 97% similarity threshold in reference clusterings, were clustered together in the case of the DCC and CCD approaches. Correspondingly, the number of OTUs formed by sequences of the same genus in the reference clusterings was higher than the number of OTUs formed by the DCC and CCD approaches. This also explains why all clustering algorithms (applied after DCC or CCD) underestimate the number of expected OTUs: denoising decreases the divergence of very similar sequences (and F). When the average number of OTUs for the 50 CORE 2 simulations (per algorithm) after the CCD pre-processing approach is considered, the largest diversity underestimation with respect to the number of expected OTUs (200) was observed with CROP (13.6%), whereas DNACLUST, USEARCH, USEARCH Optimal and swarm provided the smallest underestimation (3.4%). When the same comparison is performed between the average number of OTUs obtained in the reference clusterings and after the CCD approach, CLUSTOM yielded the largest overestimation (4.2%), whereas CRUNCHCLUST resulted in the smallest underestimation (1.7%), suggesting that CRUNCHCLUST is rather robust against the remaining noise. CROP resulted in a 2.9% overestimation of the number of OTUs obtained in the reference clustering (173 versus 168 OTUs). The run times of the clustering algorithms are given in Supplementary Table S2. The NC approach resulted in the lowest NMI scores along with diversity overestimations as high as 20-fold (and F), confirming earlier clusterings (). Chimera checking or denoising alone was insufficient to obtain accurate clustering. The removal of chimeras was the most important stepThe sequencing error rate (0.14%) in our in vitro and simulated datasets is low compared with other reported values, such as 1.07% () or 0.61% (). This may appear to be limiting the resolution at which the performance of different clustering algorithms can be compared for the pre-processing approaches that include denoising. Other than CLUSTOM and CROP, there was no prominent difference between the outcomes of different algorithms in the DCC and CCD approaches, and they all yielded underestimations of the expected number of OTUs [minimum (min): 3.4% with CCD-swarm; maximum (max): 13.7% with DCC-CROP for CORE 2 , averaged over all 50 simulations]. Highly erroneous CORE 2 simulations with a 6-fold higher error rate (0.86%) did not help differentiate between clustering methods when denoising was applied either (results not shown). In this case, all methods excluding CLUSTOM, CRUNCHCLUST and CROP yielded a small (min: 0.7% DCC-TBC; max: 5.8% CCD-USEACH), but significant, overestimation of the expected number of OTUs (200) instead of an underestimation (M-pick could not be included due to its large memory requirement). These findings suggest that studies where accurate estimations of the sample complexity is of crucial importance should include a thorough analysis to appropriately adjust the sequence/flowgram similarity thresholds used for denoising, preferably with the guidance of an experimental mock dataset, to avoid over-or underestimations. This is supported by an earlier study (), which thoroughly examined the spectrum of changes caused by a variety of pyrosequencing noise-removal tools. The authors report that some of these changes were inconsistent with removing noise and could potentially lead to undesired outcomes such as removing rare variants. Similarly,provide a discussion on the effects of subsampling and error correction, where they observed the loss of rare OTUs as a denoising outcome. Because the datasets used in both studies are derived from environmental samples lacking a ground truth, results presented here can be regarded as complementary with respect to such earlier predictive conclusions. Recently,analyzed the diversity in human saliva samples using a taxonomy-independent approach. After denoising, chimera checking and clustering with ESPRIT-Tree, they reported 306 OTUs. In our 50 simulated datasets of closely related sequences (CORE 1 ), DCC followed by ESPRIT-Tree clustering, on average, yielded a 6.0% underestimation of the sample diversity (min: 1.3%; max: 12.1%). In 50 simulations of more divergent sequences (CORE 2 ), the same approach resulted in a 4.2% underestimation on average (min: 1.0%; max: 7.0%). When our in silico findings are projected on the results reported by Bonder et al., we predict the microbial diversity in this saliva dataset to be slightly higher, namely, between 319 and 326 OTUs. Although we did not observe major differences in the performance of different clustering algorithms after the DCC and CCD approaches, the NC and CC approaches, as well as the calculation of the NMI scores at different taxonomic levels, provide useful information for the comparison of different clustering methods. An indication of accurate clustering is a high NMI score at both the species and genus level for a given dataset. A method that clusters sequences at similarity thresholds that are lower than a specified value (e.g. 97%) will have a high NMI score at genus level, whereas the species-level NMI score will be low. When the CORE-sim results are evaluated in this context, ESPRIT-Tree and TBC are identified as the two best clustering algorithms of the 11 considered in this study. They consistently achieved the highest NMI scores at both taxonomic levels in pre-processing approaches that do not include denoising, while simultaneously providing very close approximations after the DCC or CCD treatments to the reference number of OTUs. Here, we assessed different data pre-processing strategies in combination with several clustering algorithms that are commonly used in taxonomy analysis. Based on our as well as previous results (), we suggest an analysis workflow, which (after quality filtering) starts with chimera removal. We showed that the most accurate chimera detection is obtained when the union of chimeras detected by UCHIME de novo and reference-based modes are taken, where the reference database should be extensive, quality checked [e.g. SILVA () or Greengenes (and preferably trimmed to the HVR of interest (). As the current UCHIME algorithm is remarkably fast, chimera checking can be performed before denoising, resulting in 2-fold shorter denoising time due to the reduction in unique flowgrams after chimera removal. The resulting reads should be corrected for sequencing errors, preferably with a denoising algorithm that is fine-tuned for the error rate that is specific to the dataset. The chimera-checked and denoised reads can be clustered with ESPRIT-Tree, TBC or a significantly faster clustering algorithm such as USEARCH or swarm in the case of run-time constraints.
The Author 2014. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
S rDNA-based taxonomy analysis through mock data and simulations at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
taxonomic lineages (447 species; 139 genera). Next, we constructed a second database in which each taxonomic lineage contained only one amplicon, and then used alignments constructed by the needle program (Rice et al., 2000) to remove all amplicons that had (based on the shorter sequence) 97% similarity to any other sequence. This second database (CORE 2 ) contained 292 sequences from 292 taxonomic lineages (292 species; 126 genera). When present, the subspecies part of a lineage label (starting with 'subsp.') was removed (for CORE 1 and CORE 2 ). Simulations For each database (CORE 1 and CORE 2 ), 50 compositionally different datasets were generated. To obtain 200 OTUs for each dataset at a 97% similarity threshold, 250 (CORE 1 ) or 200 (CORE 2 ) reference sequences were randomly drawn from their respective databases. For each dataset, 40 000 reads were simulated, as for Mock-Isim (see Section 2.3.2). However, in this case, the relative abundances of the sequences were randomly assigned using a powerlaw distribution with parameter 0.4 (Grinder). Reads were quality filtered (QIIME) using the following options: reverse primer removal: 'truncate_only'; minimum sequence length: 150; ambiguous bases: 0; maximum homopolymer run: 6 nt; one forward and two reverse primer mismatches; a minimum quality score of 25; sliding window: 50; and zero barcode errors. Next, the reads were pre-processed in five different ways: no cleaning (NC), denoised (D), chimera checked (CC), denoised and chimera checked (DCC) and chimera checked and denoised (CCD). Clustering After each pre-processing approach, the remaining reads were clustered at a 97% similarity threshold with 11 different clustering algorithms with their default parameters: CD-HIT v3.1.1 (Li and Godzik, 2006), DNACLUST parallel release 2 (option:-l) (Ghodsi et al., 2011), ESPRIT-Tree 64-bit v11152011 (Cai and Sun, 2011), UCLUST v1.2.22q (Edgar, 2010), USEARCH v6.1.544 (Edgar, 2010), CLUSTOM v0.10 (Hwang et al., 2013), TBC version January 31, 2011 (Lee et al., 2012), CROP v1.33 (options:-e 4400-s-m 20-z 400-r 2-b int[#uniq sequences/ 50  0.5]) (Hao et al., 2011), M-pick (-f 1) (Wang et al., 2013), swarm v1.2.2 (-d 11; https://github.com/torognes/swarm) and CRUNCHCLUST v43 (-strict-min 0-max 1000-keep_n-diff 11-d_hl-noendgaps) (Hartmann et al., 2012). USEARCH was also evaluated with options 'maxaccepts' and 'maxrejects' set to zero (referred to as USEARCH Optimal). Before clustering with USEARCH and swarm, the reads were dereplicated, sorted by abundance and sequence length. In the case of M-pick, the reads were dereplicated and randomly shuffled to avoid crashes during clustering. To improve its memory usage, some code changes that do not influence the clustering output were made in the M-pick package (see the patch file at http://www.ibi.vu.nl/ downloads). To obtain ground truths for the clustering algorithms, non-erroneous datasets (50 for CORE 1 and 50 for CORE 2 ) were generated, which contained only the complete V5V7 reference sequences of non-chimeric reads (primers removed). These non-chimeric and non-erroneous reads were clustered using each algorithm to obtain the 'reference clusterings'. For evaluating the clustering results of CORE 2 simulations, the reference
A.May et al. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
S rDNA-based taxonomy analysis through mock data and simulations at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
because the clustering accuracy deteriorated far more by the presence of low-parent similarity chimeras (D) than by the occurrence of erroneous reads (CC). The low error rate in the NC sequences and successful chimera removal by UCHIME gave rise to high NMI scores in the CC approach. This is especially salient in CORE 2 simulations, where achieving a good agreement with ground truth labels is more likely because reference sequences in these simulations were at least 3% distant from each other, making inaccurate clustering due to sequence errors less probable. The best agreement with the number of OTUs formed in reference clusterings was obtained by the DCC and CCD approaches. Although hardly any difference was observed in the number of OTUs formed between the two approaches, the clusters formed using the latter approach showed consistently higher NMI scores. This was due to a large portion (10%) of undetected chimeras in the DCC approach: denoising not only converted the chimeras into non-chimeric sequences but also resulted in disagreements between the non-detected chimeras and their taxonomic labels. We observed the same denoising effect for undetected chimeras in the CCD approach; however, because their number was substantially lower (10-fold), the NMI score was not affected. The differences (NMI scores and number of OTUs) between the various clustering algorithms became less pronounced when they were applied after denoising (D, DCC, CCD). Four exceptions here were CLUSTOM, CRUNCHCLUST, CROP and M-pick, which in both CORE 1 and CORE 2 simulations resulted in slightly lower species-level NMI scores than other algorithms, whereas at genus level they achieved slightly higher NMI scores. Along with these, the relatively small number of OTUs formed by CLUSTOM and CROP, especially for NC datasets, is indicative of over-clustering, which in this case occurs when sequences from two species of the same genus with 597% similarity are assigned to the same cluster. In contrast, clustering by ESPRIT-Tree and TBC resulted in consistently higher speciesand genus-level NMI scores after NC and CC approaches, as well as good estimations of the reference number of OTUs after the DCC and CCD approaches. 4 DISCUSSION Pre-processing and clustering are two major steps in the analysis of pyrosequenced 16S rDNA amplicons, which have a dramatic influence on the accuracy of downstream efforts such as diversity estimation. In this study, we aimed to improve our understanding of how these methods transform the sequencing datasets into community profiles. To this end, we analyzed data from two pyrosequencing runs that were performed for a 15-species mock microbial community. Data properties derived from these analyses were adapted in computer simulations to overcome the main shortcoming of in vitro studies, namely, the absence of ground truth. Error rates, error distributions, read length distributions, and percentage of chimeras are good examples of basic data features that can be incorporated in silico. To the best of our knowledge, this is the first study where such characteristics of a given pyrosequencing dataset are replicated with high precision in the raw experimental output (flowgrams). This, for example, resulted in similar chimera detection sensitivity for in vitro MockI and in silico Mock-I-sim data.
S rDNA-based taxonomy analysis through mock data and simulations at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
S rDNA-based taxonomy analysis through mock data and simulations at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
