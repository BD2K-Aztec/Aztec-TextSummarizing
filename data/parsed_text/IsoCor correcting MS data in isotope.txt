Mass spectrometry (MS) is widely used for isotopic labeling studies of metabolism and other biological processes. Quantitative applications—e.g. metabolic flux analysis—require tools to correct the raw MS data for the contribution of all naturally abundant isotopes. IsoCor is a software that allows such correction to be applied to any chemical species. Hence it can be used to exploit any isotopic tracer, from well-known (13 C, 15 N, 18 O, etc) to unusual (57 Fe, 77 Se, etc) isotopes. It also provides new features—e.g. correction for the isotopic purity of the tracer—to improve the accuracy of quantitative isotopic studies, and implements an efficient algorithm to process large datasets. Its user-friendly interface makes isotope labeling experiments more accessible to a wider biological community. Availability: IsoCor is distributed under OpenSource license at
INTRODUCTIONMass spectrometry (MS) is extensively used for stable isotopic studies of metabolism. During the last decade, quantitative approachessuch as 13 C metabolic flux analysishave been increasingly used in the fields of systems biology and biotechnology to provide novel biological insights and improve industrial processes (). In such experiments, the different labeled formsor isotopologuesof metabolites are quantified by the fine exploitation of isotopic clusters in MS spectra (). These clusters also contain information on all other isotopes that occur naturally in the molecules. To extract meaningful labeling informationi.e. isotopologue distributionthe contribution of naturally occurring isotopes first has to be subtracted. This can be achieved using publicly available software such as MSCorr () developed under MATLAB or the algorithm developed in Perl by (). However, the former software is only applicable to 13 C-labeling experiments and the latter is restricted to the correction of ultra-high resolution MS data for natural abundance of 13 C or 15 N. Here, we present a novel software to correct MS data, IsoCor, which includes the following features:). For molecules containing a high number of atoms, the number of possible combinations to be calculated is high which can cause a bottleneck in the correction process. In probability theory, the probability distribution of the sum of independent variables is the convolution of their individual distributions. Therefore, the calculation can be performed faster by iteratively convolving the isotopic vectors v A = [p(A(1)),,p(A(x))] of all the atomsexcept those of the label tracerwhere p(A(x)) denotes the natural abundance of the x-th isotope of the atom A. Finally, the contribution of the tracer is added by convolving the previous isotopic cluster i-1 times by the purity vector of the tracer (e.g. [0.01, 0.99] for a purity of 99%), and n-i times by its natural abundance (e.g. [0.9893, 0.0107] in a 13 C-labeling experiment) when it has to be corrected.
Optimization algorithmBecause the measurement of isotopic clusters contains noise, Equation (1) has to be solved using a least squares method. This process can result in biases, such as the calculation of negative isotopic fractions sometimes observed with MSCorr. Because negative fractions cannot exist, they are just flattened to 0 in (), which can lead to errors in the estimated parameters and in their interpretation. To avoid such biases, the optimization method used in IsoCor includes constraints on the isotopic fraction values. We applied the LBFGSB algorithm described in () and implemented in the optimize.l_bfgs_g() function of the SciPy module. The cost function of the minimization process is defined as the sum of the squared weighted errors. The lower boundary of corrected isotopic fractions is constrained to 0, and the stopping criterion is fixed to 10 10 of relative reduction in cost value. The fitted isotopologue distribution is normalized to 1. The residuum vector may be used for an independent quality control (). The calculation speed and correction accuracy of IsoCor were evaluated by processing several sets of simulated isotopologues with varying numbers of tracer atoms (up to 100 to stress the algorithm) and levels of labeling. The correction was performed after addition of the theoretical contributions of other naturally abundant elements to these isotopologues, with or without addition of measurement noise. The implementation was quite robust and highly accurate in both cases (see the IsoCor tutorial), showing that IsoCor provides high calculation speed together with high precision. Hence IsoCor is capable to efficiently process the large datasets that can now be acquired with modern, high-throughput MS technologies. This is critical for highthroughput metabolomics and even more for high-throughput fluxomics, which is a current major challenge for many biological applications.
USAGEIsoCor is provided with plain text files that contain the information required to perform the correction. The file Isotopes.dat contains the values of the natural abundances of isotopes commonly found in biological compounds (). The files Metabolites.dat and Derivatives.dat contain the elemental formula of most common metabolites and derivative residues, respectively. These files can be easily edited and implemented according to the user's needs. Complete usage of IsoCor is detailed in the tutorial provided with the software.shows its graphic user interface. Briefly, the user can load datasets containing one or more isotopic clusters to be corrected (Panel C). These data files should be generated according to the format described in the tutorial. The options i.e. selection of the isotopic tracer, correction for the isotopic purity of the label input, correction for unlabeled positions in the label input and calculation of mean enrichmentof the correction process have to be selected (Panel B) before running the calculation. When correction is applied to single isotopic clusters, the calculated
* To whom correspondence should be addressed.  Correction for any chemical element, thereby extending the range of isotopic tracersfrom well-known ( 13 C, 15 N) to unusual ( 57 Fe, 77 Se, etc) isotopesand chemical species that can be investigated. Tracer elements with more than two isotopes (e.g. 16 O, 17 O, 18 O) can be considered.  When metabolite derivatization is required for analytical purposes [e.g. derivatization of amino acids for GC-MS analysis (Wittmann, 2007)], IsoCor performs appropriate correction by taking into account the contribution of naturally occurring isotopes brought by the derivatization reagent.  IsoCor provides two options that allow flexible correction of isotopic clusters to account for (or not) the composition of the label input including: (i) correction for the isotopic purity of the label input and (ii) correction for the occurrence of unlabeled positions in the label input. These options are of particular value for specific applications (RodriguezCastrillon et al., 2008; Wittmann and Heinzle, 1999).  IsoCor calculates the mean isotopic enrichment of molecules, which refers to the molecular content in the isotope. This information is particularly useful for targeted metabolic investigations, such as the quantification of split ratios between two metabolic pathways.  IsoCor can be applied to large datasets and can deal with the increasing number of data that are generated with modern methods in a single experiment.
The Author 2012. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oup.com at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
