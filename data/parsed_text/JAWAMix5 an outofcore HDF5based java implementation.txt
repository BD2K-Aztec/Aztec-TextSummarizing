We present JAWAMix5, an out-of-core open-source toolkit for association mapping using high-throughput sequence data. Taking advantage of its HDF5-based implementation, JAWAMix5 stores genotype data on disk and accesses them as though stored in main memory. Therefore, it offers a scalable and fast analysis without concerns about memory usage, whatever the size of the dataset. We have implemented eight functions for association studies, including standard methods (linear models, linear mixed models, rare variants test, analysis in nested association mapping design and local variance component analysis), as well as a novel Bayesian local variance component analysis. Application to real data demonstrates that JAWAMix5 is reasonably fast compared with traditional solutions that load the complete dataset into memory, and that the memory usage is efficient regardless of the dataset size. Availability: The source code, a 'batteries-included' executable and user manual can be freely downloaded from
INTRODUCTIONNext-generation sequencing (NGS) enables investigators to use whole-genome sequences for genotypephenotype association mapping, but it brings with it the challenge of developing scalable tools to handle very large datasets. To do association studies, it is usually preferable to put data into random access memory (RAM); however, the sequence data generated by NGS are usually too large to be loaded into RAM. Therefore, analysts may have to use ad hoc methods to manipulate file reading. As the magnitude of sequencing projects goes up, this problem will become more and more pronounced. To solve this problem of scalability, it would be ideal to have data stored on disk, but also provide a handy read/write protocol that users can use as if the data were stored in the main memory (an approach referred to as 'out-of-core' in computer science). This toolkit should offer transparency (i.e. hide the tedious implementation details) and high performance. Hierarchical Data Format (HDF5) (www.hdfgroup.org/HDF5) is a set of libraries designed to store and organize large datasets that was originally developed by the National Center for Supercomputing Applications. Because of its excellent performance and convenience, it has been widely used in many scientific computing communities, including storing NGS sequences (). We developed JAWAMix5, a toolkit that uses HDF5 for storing and analyzing whole-genome genotypes for association mapping with various statistical models. The linear mixed model has been considered an important framework in GWAS for controlling population structure () and estimating genetic architecture (), and it has recently been significantly improved (). We implemented most functions in JAWAMix5 based on the mixed model. In addition, we provide standard functions without the mixed model as an alternative for users (e.g. stepwise regression and nested association mapping). Given that current implementations of mixed model are based on C/C, R or Python, JAWAMix5 provides another alternative for researchers to use. Java programmers can contribute () based on the specifications described in our user manual.
FEATURESWe provide eight main functions in the first release of JAWAMix5: (i) GWAS in structured populations using the mixed model approach [EMMAX (; (ii) local variance component analysis by traditional point estimations similar to (), and jointly accounting for population structure; (iii) local variance component analysis by Bayesian estimations (see motivation and descriptions in Supplementary Notes); (iv) rare variants analysis using aggregate test (), and an aggregate test jointly accounting for population structure by mixed model; (v) standard linear regression without mixed model; (vi) standard stepwise regression; (vii) stepwise regression based on mixed model; and (viii) imputation and regression analysis in the framework of nested association mapping (NAM) design (). The detailed formulations are presented in Supplementary Notes.To visualize the analytical results, we provide automatic plotting, e.g. Manhattan plots for logged P-values and variance explained, or heat-map for distributions from Bayesian analysis. An advantage of using HDF5 for storing the data is that users can use HDF5View, a GUI provided by the HDF5 group, to view the compressed raw genotype data. Users can then easily view details of interesting or suspicious results. The core program and libraries are written in Java, so that users do not need to install any third-party library and can simply copy and run our executable, regardless of type of machine or operating system ('batteries-included' solution). To facilitate GWAS using genotypes that are quantitative, e.g. copy number variants or methylation levels, in all functions of JAWAMix5, storing and analyzing genotypes as floating numbers are also supported.
PERFORMANCEGiven that the data are stored on disk instead of in RAM, one might expect slower runtimes compared with the traditional solution of putting data into RAM (in the event that one does have the resources). We tested the performance in the following two experiments: first, we compare our HDF5-based solution with our own RAM-based implementation to see what is the overhead brought by HDF5; second, we compare core functions of JAWAMix5 with other existing tools: EMMAX (), PLINK () and GCTA () (GCTA is originally for estimating variance component of the whole chromosome. We make use of it for local region by generating .bed files using variants of focal region and code them with the same chromosome id.). We analyzed our sequences data (6 million SNPs times 400 individuals) in The 1001 Genomes Project (www.1001genomes. org) and found that performance is good: in the worse case, JAWAMix5 is 20% slower than the RAM-based solutions, whereas in some cases, it is even faster. Detailed comparisons are listed in. Memory wise, JAWAMix5 uses 5500 MB RAM regardless of the amount of the data, whereas the memory usage of memory-based solutions increases linearly proportional to the size of the data. Then we run existing tools that generated same results. The comparisons between JAWAMix5 and existing tools are presented in. Details of how the tools are used are in Supplementary Notes. In addition to testing it on Arabidopsis data, we also run JAWAMix5 on human data using Phase I data of The 1000 Genomes Project (www.1000genomes.org) with our simulated random phenotype. In all, it took 18 h, which is comparable with EMMAX that spent 21 h.
FUTURE WORKImmediately planned extensions are genegene interaction analysis and the annotations based on existing known gene models and functions. Another extension we are working on is the HDF5 interface for storing methylation data. Additionally, more functions for RNA-Seq expression analysis will be added. Although the novel Bayesian method in JAWAMix5 has revealed new biological insight in Arabidopsis data (Supplementary Notes), it has not been rigorously validated with extensive simulations. We plan to do it in the future work.
The Author 2013. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oup.com at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
JAWAMix5 at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
Q.Long et al. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
