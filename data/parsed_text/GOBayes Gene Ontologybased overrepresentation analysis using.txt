Motivation: A typical approach for the interpretation of high-throughput experiments, such as gene expression microarrays, is to produce groups of genes based on certain criteria (e.g. genes that are differentially expressed). To gain more mechanistic insights into the underlying biology, overrepresentation analysis (ORA) is often conducted to investigate whether gene sets associated with particular biological functions, for example, as represented by Gene Ontology (GO) annotations, are statistically overrepresented in the identified gene groups. However, the standard ORA, which is based on the hypergeometric test, analyzes each GO term in isolation and does not take into account the dependence structure of the GO-term hierarchy. Results: We have developed a Bayesian approach (GO-Bayes) to measure overrepresentation of GO terms that incorporates the GO dependence structure by taking into account evidence not only from individual GO terms, but also from their related terms (i.e. parents, children, siblings, etc.). The Bayesian framework borrows information across related GO terms to strengthen the detection of overrepresentation signals. As a result, this method tends to identify sets of closely related GO terms rather than individual isolated GO terms. The advantage of the GO-Bayes approach is demonstrated with a simulation study and an application example. Contact:
INTRODUCTIONIn typical high-throughput experiments, such as gene expression microarrays, the first step in the analysis of the results is often to produce groups of genes based on certain criteria (e.g. genes that are differentially expressed). To gain more mechanistic insights into the underlying biology, overrepresentation analysis (ORA) is conducted to use the knowledge of the functional characteristics of the genes to investigate whether gene sets associated with particular biological functions are overrepresented in the identified gene groups. Draghiciis the first paper to discuss the overrepresentation * To whom correspondence should be addressed. problem and propose different statistical methods that can be used in this area. ORA is based on the postulate that if a biological process has more identified genes than expected by chance alone, that biological process is probably linked to the experiment. One of the most popular gene description databases used in ORA was developed by the Gene Ontology (GO) Consortium (). Each GO term annotates a set of genes, indicating their known molecular functions, involvement in biological processes and cellular component locations. GO terms are structured in a directed acyclic graph (DAG) of parentchild relationship, where a child indicates a more specific biological classification than its parent(s). Based on the true-path rule the annotation of a gene to a GO term implies automatic annotation to all the ancestors of that term. Another feature is that a GO term is allowed to have more than one parent nodes, a feature known as multiple inheritance. For example, immune response is not only a specific form of organismal movement but also a part of defense response. Furthermore, some genes might be annotated by a parent GO node but not by any of its children because less is known about that gene's specific function. For a rigorous analysis, these dependency characteristics of the GO DAG need to be considered when developing statistical methods to detect overrepresentation of GO annotations. In ORA, the most commonly used statistical test is based on the hypergeometric distribution or its binomial approximation (; among others). Let A denote a GO term or the set of genes annotated to A (with cardinality I A ), and let S denote the set of genes (with cardinality I S ) based on a certain criterion (i.e. differential expression) from a full gene list G (with cardinality I) in an experiment. The number of genes belonging to both S and A (S A), denoted by n A , indicates the representation of A in S. Under the null hypothesis that S and A are independent (i.e. the GO term is irrelevant to the gene cluster), n A follows a hypergeometric distribution. The P-value measuring the significance of association is the tail probability of observing n A or more genes annotated by A in S,GeneMerge, FuncAssociate, GOTree Machine, etc.) have been developed based on the hypergeometric P-value. Detailed review can be found in Khatri and DraghiciDraghici (2005). The hypergeometric P-value provides a straightforward measure of overrepresentation for each individual GO term. However, the major drawback of this approach is that it ignores the hierarchical structure in the GO DAG, which contains a substantial amount of information regarding the interactions among the GO terms. We use an artificial DAG () to illustrate this issue. It consists of 25 nodes A j ,j = 1,...,25 , each denoted by a circle. Let G = {a,b,...,z} denote the full list of genes, and 10 genes in S are marked in red. The rectangles contain the subset of genes annotated by each node, where (I A ,n A ) are listed under each rectangle.includes some important features of the GO DAG, such as multiple inheritance (e.g. A 14 and A 23 have two parent nodes) and that a gene might be annotated at different specific level (eg. gene k is annotated by A 2 , but not by any of its children: A 5 , A 6 and A 7 ). Note that in this example S is overrepresented in the regions under A 2 , while underrepresented in the regions under A 3 and A 4. We report the hypergeometric P-values estimated by (1) in blue. First, given I and I S , GO terms with the same (I A ,n A ) have exactly the same hypergeometric P-values. For example, with (I A ,n A ) = (2,2), the P-values for A 14 and A 24 are both 0.139. Based on, A 14 is more likely to be linked with S because of the stronger evidence of overrepresentation in its neighboring nodes (related biological functions). Using evidence only from individual terms, the hypergeometric P-value does not differentiate between A 14 and A 24. Second, given I and I S , the hypergeometric P-value has a lower limit determined by I A , which is denoted as L(I A ). Specifically, L(I A ) is achieved when n A = I A , i.e. the P-value reaches its lower limit when all the genes annotated by A are in S. The smaller the I A , the larger the L(I A). For example, we have L(3) = 0.046 as in A 12 and L(2) = 0.139 as in A 14. This observation suggests that if we set the threshold for the P-value at L(k), then the hypergeometric test could not identify any GO terms with I A < k. In ORA, detecting more specific GO terms, which usually have a relatively smaller I A , might be more desirable because they provide more detailed biological information. However, the hypergeometric test tends to identify less specific GO terms because of the constraint of L(I A ). In, the most significant term selected by the P-value is A 2 , a term next to the root. The more specific terms that are associated with S (i.e. A 12 and A 14 ) are considered less significant compared with A 2. All of these issues essentially stem from the limitation of the hypergeometric test in treating the GO terms as independent entities and ignoring their interrelated structure. Recently some new methods have been proposed in ORA. Lewin andpropose to group closely related GO nodes together and then compute a hypergeometric P-value for each group. In their approach, the graphical distance between nodes in the GO DAG is assumed to have some quantitative biological meaning.calculate the overrepresentation of a GO term from leaf to root by downweighting the contribution of genes which are annotated by a child term that has been found to be significantly enriched.measure the overrepresentation of each GO term relative to its parent(s). From root to leaf, their method computes the significance of overrepresentation for a GO term conditional on the representation at the parent term(s). The last Page: 907 905911
GO-Bayestwo methods purposely remove the dependence between parent and child terms. In this article, we develop a Bayesian hierarchical model to incorporate the dependence structure of the DAG in assessing GO term overrepresentation. It takes into account evidence not only from individual GO terms, but also from their related terms (i.e. parents, children, siblings, etc.). The Bayesian framework enables borrowing information across related GO terms to strengthen the detection of overrepresentation signals. As a result, this method tends to identify sets of closely related GO terms rather than individual unrelated GO terms. The utility of the method is demonstrated using a gene expression microarray dataset from a human B cell stimulation experiment.
METHOD
The Bayesian modelThe proposed method is called GO-Bayes: GO-based ORA using a Bayesian approach. In the model, each GO term has a relevance parameter measuring its association with the selected genes in S. The novelty of the model is that the complex dependence structure in the GO DAG is incorporated via a hierarchical prior on the relevance parameters. To introduce GO-Bayes, we define the following notations. Let A = {A j ,j = 1,...,J} be the set of GO terms involved in the annotation of the full list of I genes (i.e. I A j > 0, for j = 1,...,J), among which I S genes are grouped in S in the experiment. We use A j 1  A j 2 to indicate that A j 1 is a parent of A j 2. We defineto be the sets of parent and child nodes of A j , respectively. We use |U| to denote the cardinality of set U. Without loss of generality, let A 1 denotes the root node and |P 1 |=0. For the non-root nodes, we have |P j |1, where |P j | > 1 indicates multiple inheritance. We call A j an end node if |C j |=0 and an inner node otherwise. For example, in,the gene level, we use g i  A j to denote that gene i is annotated by A j. We further use g i A j to indicate that A j is the most specific GO term that annotates gene i, with the formal definition being g i  A j and g i /  A k for any A k  C j. We define B i = A j : g i A j to be the set of the most specific annotations of gene i. The true-path rule implies that B i contains all the annotation information about gene i. In, we havebe the observed expression status of gene i, y i = 1 if gene i is in S and y i = 0 otherwise. The binary y i is assumed to follow a Bernoulli distribution,, where p i is the probability that gene i belongs to S. Using the idea that if A j is associated with S, the genes annotated by A j have a higher chance of being grouped in S, we construct the following logistic model,We specify b 0 as a constant and set b 0 = logwhere p 0 is the background probability that gene i is grouped in S by chance. The random error e i is assumed to have a normal distribution with mean 0 and variance  2 , denoted by e i iid  N(0, 2 ). Parameter  j characterizes the relevance of GO term A j to the set of identified genes S, where it modifies the odds of gene i being grouped in S by a factor of exp( j ) if g i A j. Thus, positive (negative) values of  j indicate over(under)-representation. Based on the true-path rule, we only include  j s from B i , the most specific annotations, in model (2) to avoid repeated use of information. The  j s from less-specific annotations are assumed to affect the odds indirectly via a hierarchical prior on  =  j ,j = 1,...,J , constructed according to the dependence structure in the GO DAG. We set  1 = 0 for the root node. Then the prior of  j (j = 2,...,J) is specified conditionally given the relevance parameters of its parent nodes,Prior (3) assumes that  j arises from a mixture distribution of |P j | components, each component being a normal distribution centered at the relevance parameter of one of its parents. The equal mixing probability 1/|P j | in (3) assumes a priori that each parent has equal influence over  j. Parameter  2 characterizes the variability among the children nodes. The joint prior of  is obtained by the product of (3) over j = 2,...,J. This prior provides a mechanism to share information among the GO terms based on the DAG structure. It also naturally accommodates multiple inheritance. We assign an inverse gamma prior, IG(a  ,b  ), on  2 , which has been used extensively in Bayesian models (). Similarly, an IG(a  ,b  ) prior is assumed for  2. We infer the relevance of GO term A j based on the posterior distribution of  j , denoted by,...,I} is the collection of observations. Specifically, we use r j  P( j > 0 | Y) (denoted as the B-score) to measure the relevance of a GO term to S. It is the posterior probability of A j being positively associated with S. Making inferences based on posterior probabilities is a common practice in Bayesian analysis of microarray data (). Markov Chain Monte Carlo (MCMC) sampling algorithm is employed to simulate random samples from the joint posterior distribution. We implement the adaptive-rejection sampling method to take advantage of the log-concave property of the full conditional distributions (). The computation can be performed efficiently.
Demonstration of GO-Bayes with the artificial DAGGO-Bayes is applied to the artificial DAG () to detect overrepresentation of the terms. We present the B-score, r j , below the hypergeometric P-value. In the following discussion, we use association to refer to positive association between a GO term and S. By incorporating the dependence structure of the GO DAG, GO-Bayes shows distinctive advantages over the hypergeometric test. First, GO-Bayes is capable of distinguishing terms with the same (I A j ,n A j ). For example, GOBayes produces r 14 = 0.958 and r 24 = 0.772, for A 14 and A 24 , respectively, indicating that A 14 is more likely to be associated with S based on the stronger evidence of overrepresentation of its neighboring nodes. Second, the B-score for all nodes has a range of 01 regardless of I A. Thus, GO-Bayes can identify more specific GO terms as long as their neighboring nodes are consistently overrepresented. For example, the top two terms selected by GO-Bayes are A 12 and A 14. Third, GO-Bayes also highlights underrepresentations as well as overrepresentations. In, all the terms with n A = 0 have the same P-value of 1.0. Under all the branches of A 2 , A 3 and A 4 , there are terms with a P-value of 1.0. GO-Bayes suggests that it is the terms under A 3 , whose r j 's are close to 0, that are most underrepresented in S. We have also compared the GO-Bayes B-score with the elim P-value () and the parentchild (union) P-value () based on the artificial DAG. Due to the space limit, the results are presented in Supplementary. In general, both the elim method and the parentchild method address the 'dependency problem' caused by overlapping annotations between parentchild GO terms. The elim method removes (or downweights) all genes annotated to a significantly enriched node from all its ancestors. By doing this, the method tends to identify strongly overrepresented GO terms that remain significant even after discounting evidence from their offsprings. For illustrative purpose, we set the P-value cutoff at 0.05 for the elim method. Thus, A 12 is considered significantly overrepresented and genes (a,b,c) are removed from its ancestor terms A 5 and A 2. Based on the elim P-value, the term A 12 becomes the most significant, where A 2 ranks second and A 5 ranks sixth. The parentchild method computes the significance of a node conditional on the significance of its parents. It implements the idea by computing a hypergeometric P-value for each GO term in the context of its parent (treating the genes annotated by the parent term as the fullPage: 908 905911
S.Zhang et al.gene list). This approach tends to identify GO terms that show stronger overrepresentation compared with their parents. Take A 7 and A 11 , for example, which have the same (I A , n A ). Based on the parentchild P-value, A 11 has a higher rank (second) because its overrepresentation (2 out of 3) is stronger than its parent A 4 (3 out of 11). In contrast, A 7 has a lower rank (10th) because its overrepresentation (2 out of 3) is weaker compared with its parent A 2 (8 out of 11). The GO-Bayes method accounts for the parent child relationship through the hierarchical prior. The strategy of borrowing information from neighboring terms allows GO-Bayes to detect moderate but consistent signals from closely related GO terms. As a result, A 7 has a higher rank than A 11 (r 7 = 0.802 and r 11 = 0.397) because the overrepresentation in A 7 is corroborated by related terms in its neighborhood. With the biological truth unknown, there is no gold standard to compare the methods in real studies (). The results based on the artificial DAG, however, help to illustrate the distinctive characteristics of each method.
APPLICATION
DatasetIn order to test the utility of the GO-Bayes approach, we selected a gene expression microarray dataset in which a B-cell lymphoma cell line (Ramos) was stimulated either through the B-cell antigen receptor (BCR), CD40 or a combination of the two (). Specifically, we used an Affymetrix gene expression dataset selected from the GSE2350 series (GSM44051 to GSM44074) downloaded from the NCBI GEO database (http://www.ncbi.nlm.nih.gov/projects/geo/). The expression values of all six replicates under four experimental conditions were normalized by rows and a list of 3952 differentially expressed genes (I = 3952) were selected using the Significance Analysis of Microarray (SAM) approach (). The differentially expressed genes were subdivided into 20 groups based on their expression pattern by K-means clustering using Euclidean distance as the similarity metric. Gene Cluster #7 (GC7) was chosen for detailed analysis because it promised to reveal some interesting biology about B-cell responses to receptor signaling. The 196 genes (I S = 196) present in GC7 showed a particularly interesting expression pattern: these genes were upregulated in response to BCR signaling alone; however, this upregulation was suppressed when CD40 signaling was included (). These treatment conditions mimic important biological responses of immature B cells (). Immature B cells must learn to distinguish between signals delivered by authentic pathogen-derived antigens and signals delivered by self-antigens. In the former case, B cells need to respond by productive proliferation and differentiation into immune effector cells. In the later case, B-cell responses need to be suppressed either through the induction of a state of unresponsiveness or apoptotic cell death. The two-signal hypothesis is one mechanism proposed to elicit either responsiveness or non-responsiveness to antigen exposure, which states that B cells receiving only one signal, through the BCR, will proliferate and die, but B cells receiving two signals both through the BCR and a co-stimulatory receptor-like CD40 will proliferate and survive due to suppression of the cell death response. Thus, gene present in GC7 are those genes whose expression is suppressed with the addition of CD40 signaling and could thus be involved either in the cell death response or in the induction of unresponsiveness.
ResultFor the full list of 3952 differentially expressed genes (I = 3952), 6768 GO terms (J = 6768) have been used to annotate their functions. Four groups of GO terms are found in the top 20 list of most significant terms based on the GO-Bayes approach (). The GO term with the highest B-score (0.9004) is 'transferase activity, transferring hexosyl groups' (GO:0016758). Nine of the top 20 GO terms based on the B-score are related to this group. Five of the top 20 GO terms are related to 'G-protein signaling, coupled to cAMP nucleotide second messenger' (GO:0007188); six are related to 'lysosome' (GO:0005764); and two are in the group of 'negative regulation of transcription, DNA-dependent' (GO:0045892). In the case of the 'transferase activity, transferring hexosyl groups', all nine related terms (GO:0016758, GO:0016757, GO:0000030, GO:0003844, GO:0008375, GO:0015020, GO:0042328, GO:0004703, GO:0004674) can be found near GO:0016758 in the GO hierarchy (see Supplementary). Even though some of these terms are poorly represented in this dataset (e.g. GO:0003844 represented by only a single gene in the dataset), all of these terms have relatively high B-scores due to the overrepresentation of other terms that are close relatives in the hierarchy. In some cases, the association of the group of GO terms highlighted by the GO-Bayes approach matches our expectations.
Page: 909 905911
GO-Bayes
GO-Bayesfor the interpretation of gene expression microarray data and GO annotation, the general strategy can be applied to any circumstance in which groups of entities are annotated with terms derived from any ontology hierarchy or similar dependency structure.
The Author 2010. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oxfordjournals.org
at :: on August 31, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
The columns I A and n A represent the cardinality of the relevant GO term and the number of genes in the GO term that also appear in Gene Cluster #7; P-value and Rank P represent the hypergeometric P-value computed by CLASSIFI, and the rank of the GO terms based on the P-value; and B-score and Rank B represent the GO-Bayes measure and the corresponding rank of the GO terms. Under the column 'Group', 'a' represents GO terms closely related to GO:0007188 (G-protein signaling, coupled to cAMP nucleotide second messenger) in the GO hierarchy; 'b' represents GO terms closely related to GO:0005764 (lysosome); 'c' represents GO terms closely related to GO:0016757 (transferase activity, transferring glycosyl groups); 'd' represents GO terms closely related to GO:0045892 (negative regulation of transcription, DNA-dependent); and 'f' represents GO terms unrelated to the above four groups. NA, not applicable. It is well known that activation of B cells through the BCR induces endocytosis and the fusion of endocytic vesicles with lysosomes as a mechanism to capture antigen for presentation to T cells in order to stimulate the helper immune response (Lee et al., 2006). Thus, the presence of lysosome-related GO terms in the cluster of genes upregulated in response to BRC stimulation might be expected. In other cases, the association is not immediately expected, but subsequent investigations revealed that the association is supported by previous experiment data. For example, the majority of genes giving rise to the 'negative regulation of transcription, DNA-dependent' association, including ID3 (Pan et al., 1999), CTCF (Qi et al., 2003), SMAD3 (Ramesh et al., 2009), KLF12 (Roth et al., 2000), E2F6 (Xu et al., 2007), FosB (Yin et al., 2007) and PA2G4 (Zhang et al., 2008), have been found to be upregulated in response to BCR stimulation in B cells or somehow involved in B-cell signaling responses. In the case of CTCF, Qi et al. (2003) showed that this upregulation is associated with the induction of apoptosis in B cells and can be suppressed by co-stimulation through
at :: on August 31, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from [10:40 5/3/2010 Bioinformatics-btq059.tex] Page: 910 905911
