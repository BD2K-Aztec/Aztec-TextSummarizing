A non-parametric Bayesian factor model is proposed for joint analysis of multi-platform genomics data. The approach is based on factorizing the latent space (feature space) into a shared component and a data-specific component with the dimensionality of these components (spaces) inferred via a beta-Bernoulli process. The proposed approach is demonstrated by jointly analyzing gene expression/ copy number variations and gene expression/methylation data for ovarian cancer patients, showing that the proposed model can potentially uncover key drivers related to cancer. Availability and implementation: The source code for this model is written in MATLAB and has been made publicly available at https:// sites.google.com/site/jointgenomics/
INTRODUCTIONGene expression profiles are commonly used in the study of cancer biology (). However, human cancers are highly heterogeneous because of the combined effects of genetic instabilities and epigenetic alterations. Hence, it is notoriously difficult to gain understanding of the mechanisms of cancer progression from gene expression data alone. The root cause of cancer is due to several possible events. For instance, copy number variations (CNVs) under selective pressure change the dosage of key tumor-inducing and tumor-suppressing genes, which thereby affect mRNA transcription and neoplastic cell proliferation (). On the other hand, the mechanism of epigenetic alteration is more complicated. DNA methylation patterns are globally disrupted in tumor cells, characterized by both global hypomethylation and regionspecific hypermethylation at CpG islands (). There is a recent explosion in the availability of cancer datasets of multiple heterogeneous data types from sources like the Cancer Genome Atlas project (TCGA; cancergenome.nih.gov). It is hoped that the availability of simultaneous measurements of multiple biological features such as gene expression, DNA copy number change, DNA methylation and others will offer an increased insight into the root causes of cancer phenotypes. These insights have the potential to distinguish genetic/epigenetic changes that promote cancer progression (driver mutation) from those with no selective advantage (passenger mutation) (), which could revolutionize the treatment of cancer by suggesting novel targets for cancer therapeutics and by developing biomarkers to identify the patients who will most benefit from such therapeutics (). There are numerous publications on combining different types of DNA modifications with gene expression. Perhaps the most natural of these are the brute force methods such as expression quantitative trait loci (eQTL) analysis (). Joint analysis of single nucleotide polymorphism (SNP) data with gene expression data by expression quantitative trait loci involves testing every gene-single nucleotide polymorphism pair for association with a t-test, and then correcting for multiple hypothesis testing. CNAmet () defines a similar approach to relate gene expression changes with either copy number change or DNA methylation. Other approaches use well-established models for each of the individual data types, and then combine the results into a statistic that addresses the problem of interest. The approach ofis an example of this for the identification of genes that are regulated by DNA methylation. A shortcoming of all of these approaches is that they do not reduce the dimension of the individual datasets through an accounting of their respective correlation structures. In, the authors used kernel functions predefined for each data type, and mapped to the same vector space, which allows joint analysis in the common range of the kernels. Copy number and expression in cancer () has been proposed as a Bayesian scoring function that measures how well a set of candidate gene regulators correlates with the expression of gene modules (groups of genes that are correlated with each other). Another approach () uses a sparse factor (SF) model to describe the correlation structure of the gene expression data but uses post hoc hypothesis tests to draw connections between gene expression and copy number data. These approaches allow for effective dimension reduction but do not use correlation structure in one dataset to inform the estimations of correlation in the others. Zheng andextended this approach by the development of a two-SF model using aneuploidy and gene expression as an example. It assumes some factors are shared by two data where *To whom correspondence should be addressed. y The authors wish it to be known that, in their opinion, the first two authors should be regarded as Joint First Authors. z The authors wish it to be known that, in their opinion, the last two authors should be regarded as Joint Last Authors. there is a statistical correlation, and some factors are unique to each dataset. The common factors are further linked by sampling gene expression factors centered on the CNV factors with some Gaussian noise, thereby preventing the difference in data size from overwhelming the information available on associations between them. However, it is difficult to check model assumptions in high-dimension by specifying different numbers of factors. In the recent years, model-based integration approach has become popular for analyzing TCGA data.proposed a three-node Bayesian graphical model to represent the dependence structure of CNVs, methylation and gene expression. This method identifies the mRNA regulatory event separately for each candidate gene but does not consider gene modules as a whole. iBAG () specifies gene-methylation effect and other regulatory module controlled effect and then uses a two-component regression model to identify gene/biomarkers that are associated with clinical outcomes (e.g. survival time, tumor stage and other demographic variables). In this way, it assumes linear and independent effects between gene expression and methylation as well as patient survival and gene expression. However, given the complexity of epigenetic regulatory mechanisms, more flexible Bayesian non-parametric models may be preferred. For jointly modeling heterogeneous data, Bayesian and semiBayesian latent variable models have been developed to factorize the latent space into a shared and data-specific part (). However, in these approaches the number of latent factors is chosen a priori. Alternatively, one may consider multiple factor models, each with a different number of factors, and perform model selection based on information criteria such as Akaike information criterion (AIC) () or Bayesian information criterion (BIC) (). However, as stated earlier, it is often challenging to check modeling assumptions in highdimensions. Hence, a non-parametric or semiparametric model is desirable. In this article, we propose a non-parametric Bayesian factor analysis approach for integrating heterogeneous genomics data, with the number of factors inferred from the available data. Our proposed approach is based on factoring the latent space into shared and data-specific components, using a beta-Bernoulli process (;) to infer the dimension of these latent spaces. We demonstrate the proposed approach on the joint analysis of genomics data for ovarian cancer patients, including three different data types: gene expression, CNV and DNA methylation data. We demonstrate that the joint analysis of gene expression/CNV and gene expression/DNA methylation levels can potentially identify genomic and epigenomic regulators influencing cancer pathophysiology outcomes. The remainder of the article is organized as follows. In Section 2, we present the proposed hierarchical Bayesian model for jointly analyzing heterogeneous genomics data. In Section 3, we discuss priors on factor loadings and factor scores. Section 4 outlines an MCMC inference algorithm. Section 5 provides experimental results for the proposed model on the analysis of multiple genomics data. Finally, we provide concluding remarks in Section 6.
JOINT BAYESIAN FACTOR ANALYSISrepresent data from R different modalities, where X r  x r 1 ,. .. , x r M  2 R NrM. Here N r represents the dimensionality of the observation vectors of modality r (e.g. the total number of genes) and M represents the total number of samples, e.g. patients. In SF modeling, learning a single shared matrix of factor loadings for different signal classes has been proposed in. However, for heterogeneous data such as that considered here, learning a shared set of factor loadings is more difficult. The joint factor model may be represented asThe matrix D r  d r 1 ,. .. , d r K  2 R NrK consists of the factor loadings specific to data modality r, factor scores W r  w r 1 ,. .. , w r M  2 R KM are specific to data from modality r, W c  w c 1 ,. .. , w c M  2 R KM consists of the factor scores common among all modalities and E r   r 1 ,. .. , r M  2 R NrM consists of the noise/residual specific to data of modality r. Note that one may alternatively considerwhere D rc corresponds to factor loadings associated with common factors, with D rc reflective of how these common factors are viewed by modality r; D r are factor loadings associated with factors specific only to modality r. The framework in (1), which we use throughout, allows the ability to share factor loadings between the common and modality-specific factors, and the manner in which W c and W r are modeled allows sufficient flexibility to yield (2) if the data so warrant. We wish to impose the condition that any x r i is a sparse linear combination of the factor loadings. Hence, the factor scores are represented as,represents the Hadamard product (element-wise vector product). The sparse binary vectors b r i are drawn from the following betaBernoulli process (;)Betac, c1   4 with k representing the k th component of and 2 0, 1. In practice K is finite, and the above equation represents a finite approximation to the beta-Bernoulli process, where the number of non-zero components of each b r i is a random variable drawn from Binomial K,  . If is set to K , in the limit K ! 1 this reduces to the number of non-zero components in b r i being drawn from Poisson; this corresponds to the Indian buffet process (IBP) (). Therefore, we may explicitly impose a prior belief on the number of non-zero components in w r i. The shared binary vectors b c i are modeled similarly as b r i .The properties of the beta process induce sparsity in the feature space by encouraging sharing of features. An example of a binary feature matrix drawn from a beta-Bernoulli process is shown in. If K is set to a relatively large value, the finite beta-Bernoulli process allows inference of the number of factors needed to represent the data. Conceptually, in a finite beta-Bernoulli process, we start with a large number of parameters (instead of an infinite number of parameters, as done in an IBP), and then allow the data to infer the appropriate (lowdimensional) model order during posterior inference. In principle, one might desire to actually treat the model as infinite within inference; however, Paisley andshow that the finite approximation of the beta-Bernoulli process, for large K, yields a very accurate approximation to the IBP, and hence we anticipate little, if any, change in results for an infinite model from those obtained in this article. The noise or residual in (1) is modeled aswhere I Nr represents the N r  N r identity matrix. The construction in (1) imposes the belief that there are underlying (low-dimensional) features represented by the factor scores that may be shared across modalities, via W c ; however, each modality has a unique mapping from these low-dimensional factor scores to the high-dimensional data, reflected by D r. Further, each modality may also have idiosyncratic low-dimensional features, characterized by W r. The common and idiosyncratic features are learned jointly, via the simultaneous analysis of all modalities. A unique feature of the above construction is that it allows complete sharing of some low-dimensional features across different data modalities as well as partial sharing, i.e. a shared feature may be slightly perturbed via W r and shared across different modalities.
MODEL CONSTRUCTION
Priors for factor loadings and factor scoresIn the absence of covariates, the factor loadings may be drawn i.i.d. (independent and identically distributed) from a Gaussian distribution (for ease of notation, we henceforth drop the modality index r, unless referring to multiple data modalities simultaneously),One may impose covariate-dependent factor loadings [e.g. factor loadings drawn from a Gaussian process or a mixture of Gaussian processes (or an additional Markov structure () on the factor loadings to impose the correlation. However, for the genomics data considered in this article, it was deemed unnecessary to impose such structures. The factor scores may be drawn i.i.d. (independent and identically distributed) from a Gaussian distribution as,We impose broad gamma prior on r and c :
Imposing sparsityIn many biological applications, such as those considered in this article, it is desirable that the factor loading matrix is sparse (). To impose sparsity on the factor loadings, we use a Student-t sparseness-promoting prior (). In this construction, d jk , the j th component of d k , is drawnHowever, there are multiple ways by which one may desire to impose sparsity, such as using the spike-slab prior (). This consists of a discrete-continuous mixture of a point mass at zero, referred to as the 'spike', and any other distribution, such as the Gaussian distribution, known as the 'slab'. A hierarchical betaBernoulli construction of the spike-slab prior for imposing sparsity on the factor loadings is provided in. We found that the spike-slab prior works as well as the model presented above; however, for the sake of brevity, we include only the results for the Student-t sparseness prior in this article. Note that for modeling the heterogeneous genomic data considered in this article, we have this imposed sparsity both on the factor loadings (via a student-t sparseness-promoting prior) and on the factor scores (via a beta-Bernoulli process).
MCMC INFERENCEThe conditional posterior distribution of all the model parameters for the joint factor model may be derived analytically. We use a Gibbs sampler to draw samples from the posterior distribution of the model parameters. The number of Gibbs burn-in samples is set to 3000 and the number of collection samples is setvery similar results. The shrinkage parameters on the factor loadings are set at a 1  10 3 and b 1  10 6 (for gene-copy number analysis) and a 1  1 and b 1  10 2 (for gene-methylation analysis). The shape parameters on the beta-Bernoulli process are set as follows:(i) for gene-copy number analysis, the common and data-specific factors have the same hyperparameters, c  400,  2:5e  9; (ii) for gene-methylation analysis, the hyper priors on the common factors are c  700,  1:5e  4, on the gene-expression-specific factors are c  500,  2e  4 and on the methylation-specific factors are c  10,  0:01. The mixing of the MCMC sampler was also carefully examined. The sampler was run extensively for different number of burn-in and collection samples. It was also run multiple times in parallel with different initial values. The results of these experiments were found to be consistent and repeatable across such runs. Details of the Gibbs update equations are provided in the Supplementary Material.
JOINT ANALYSIS OF HETEROGENEOUS GENOMICS DATA
Data descriptionThe data in this study include ovarian cancer gene expression, CNVs and methylation data collected from TCGA project. We aim to integrate gene expression/CNVs and gene expression/ methylation from 74 ovarian cancer patients. For computing purposes, we downsized the original massive data into smaller sets. Independent gene-by-gene filtering (based on criteria such as overall mean and overall variance) is typically used to reduce data dimension as well as increase the number of discoveries in high-throughput experiments (). In our analysis, a filtering criterion was established for the gene expression data (Affymetrix HT_HGU133A) to eliminate probes with sample mean56 or SD 50.4, which resulted in a gene expression dataset downsized from 22 277 to 5976. Comparative genomic hybridization (CGH) data were filtered to remove Agilent Human Genome CGH 244A probes containing missing values. This set was further filtered by keeping only one in 50 probes, leaving 4443 probes. Methylation data (Illumina Infinium human methylation 27K bead assay) was filtered to retain only higher variance samples (resulting in 4722 probes) and was inverse-probit transformed to lie on the real line.
Analysis of gene expression and CNVs dataWe applied the joint Bayesian factor model to gene expression and CGH to identify the factors that are representative of correlated changes in gene expression and DNA CNVs. We set the upper bound on the number of factors as K  60 and obtained 1 specific to gene expression, 4 unique to CNVs and 19 shared between both modalities (). The results are relatively insensitive to the choice of K, and various other choices yielded similar results.shows the correlation structure of the probe sets (gene expression) and CGH clones (CNVs) that are included in joint factor number 41 (the factor numbering is arbitrary, and changes between collection samples, with these results illustrative; in these and related results we depict the maximum likelihood collection sample). As expected, correlation between the factor genes for those patients who were included in this factor is higher than for those not included. It is well known that some variations in cancer gene expression are caused by gene dosage changes because of CNVs. In addition, because of the mechanism by which CNV occurs, it tends to happen in contiguous regions. Of the 19 CNV factors identified, one is a nearly perfect representation of batch effects in the data and the remaining 18 display copy number amplification/ deletion in specific chromosomal regions. Most of these show similar gene expression changes in the same region. We demonstrate this behavior in, which shows that the largest factor loadings from both CNV and gene expression for factor 18 are clustered around the same region of chromosome 8. We identified highly associated CNVs in the chromosomal arm 8q12.38q24.13 (factor 18), which is a known region for frequent high-level amplification associated with disease progression in human cancers (). The rediscovery of genes in this region also validates our approach. For example, E2F5 (8q21.2, Unique ID: 1875), an important gene in the regulation of cell cycle, is known to be overexpressed in ovarian epithelial cancer (). Overexpressed genes, MTDH (8q22.1, Unique ID: 92140) and EBAG9 (8q23, Unique ID: 9166), have been recognized in a variety of cancers including ovarian and breast cancers. The inferred feature selection matrices that are unique to data of modality r (B r ) and common to both data modalities (B c ). From left to right, the figures are binary matrices unique to gene expressions, CNVs and shared between gene expressions and CNVs, respectively. The y-axis is the indicator of each factor, and x-axis represents the 74 subjects. The inferred factors and samples selected by the model are assigned as 1 (white) and 0 (black) otherwise. Results are shown for the maximumlikelihood collection sample (for illustration purposes) (). Another gene in this region whose expression level is known to be important in tumor biology is WWP1 (8q21, Unique ID: 11059). This recapitulation of some of the well-known features of aneuploidy in cancer suggests that our joint model is appropriately capturing correlation structure between gene expression and CGH data. As described above, many factors we obtained are associated with individual chromosomal locations, as demonstrated in. However, there is also a subset of factors that are representative of multiple regions.shows that the largest factor loadings in CNV/gene expression for factor 41 come from both chromosomes 6 and 17. This is the explanation of the checkerboard regions of positive and negative correlation inas well. The CNVs from the top-ranked CGH probes in the two locations are highly negatively correlated, with copy number gain in chromosome 6 and loss in the other. There are a number of possible mechanistic explanations for this feature. For example, it is possible that wholesale duplication of one region is lethal to the cells without shutting down the apoptosis pathway. Such a shut down might be accomplished by deletion of other regions. Previous approaches to the joint analysis of gene expression and CNV through the use of factor models, such as, have failed to find these relationships. The proposed joint factor model provides the flexibility of discovering factors that are relevant only for a subset of the subjects. It is interesting to note that a similar model, which enforces that all subjects are included in the inferred factors, performed poorly compared with the proposed model and discovered fewer factors that captured correlated changes in gene expression and CNVs.
Analysis of gene expression and DNA methylation dataFor computational purpose, we selected probes with highest variances across samples and obtained top 1000 probes for both gene expression and methylation. Eighteen common factors were thus obtained. Unlike CNVs, methylation does not typically occur in contiguous regions; therefore, it is not surprising that no regional peaks were detected. Methylation acts as an epigenetic regulator and silences tumor suppressor genes by changing chromosomal structures. We detected a gene, SPON1 (11p15.2, Unique ID: 10418), which appears to be predominantly regulated by methylation of its CpG site (). Elevated expression of this gene relative to normal tissue is a known hallmark of ovarian cancer (); however, the mechanism of this overexpression was previously unknown. SPON1 encodes VSGP/F-spondin protein promoting proliferation in vascular smooth cell during ovarian folliculogenesis, which has been identified as a potential diagnostic marker or therapeutic target for). In contrast to the almost single gene precision of factor 5, factor 12 shows strong correlation between methylation and gene expression in many different loci on X chromosome (, Supplementary). The list of CpG sites heavily loaded on this factor is displayed in Supplementary Table S4. Pathway analysis on these candidate genes () reveals that many are involved in the regulation of transcription. They may regulate the expression of XIST (), the dysregulation of which has been found in several cancers (). The correlation of methylation levels at all of these sites combined with their correlated gene expression levels suggests that they might all be the targets of a single methylation program; however, the existence of coordinated methylation enzymes that target these locations is unconfirmed. We implemented the joint factor model for analysis of multiple genomics data in non-optimized Matlab on a quad core PC with 2.2 GHz CPU and 4 GB ram. The average time per iteration of the Gibbs sampler for the results in Section 5.2 is 72 s and for the results in Section 5.3 is 55 s.
CONCLUSIONA non-parametric joint factor analysis method is introduced for modeling multiple disparate but statistically related data. The proposed approach was demonstrated on the joint analysis of heterogeneous genomics data related to ovarian cancer. The proposed model uncovered key drivers of cancer, some of which have been previously reported in literature as well as some new genomic causes of cancer (potentially). In this article, we have focused on integrating multiple heterogeneous but statistically correlated datasets, via a joint factor analysis approach, where the latent space is factorized into a shared component and data-specific components. The joint factor analysis model allows enough flexibility to incorporate additional information into the model. For example, we could alternatively use a Gaussian process prior or a Sticky-HMM prior () on the loadings of CNVs to incorporate spacial-dependence structure in the model. Hence, more refined regional peaks may be recovered. We plan to investigate such priors in our future work. Besides, we assume data-specific linear mappings between the latent space and the observation space. However, the assumption that the data lie in or close to a lowdimensional subspace is restrictive and a better assumption is that the data lie on a manifold. In the future, we wish to relax the linearity assumption of our joint factor model via a mixture of factor analyzers approach.. Loadings from factor 12 with strong correlations between methylation (A) and gene expression (B) at many different loci. The gray denotes odd-numbered chromosomes and the black denotes even-numbered chromosomes. Diamond markers denote loci where the absolute value of loadings are 40.5, and gene expressions are significantly associated with adjacent methylation sites, detailed in Supplementarygene identified in the loadings peak from factor 5 of the joint factor model fit to DNA methylation (A) and gene expression (B) data. The gray denotes odd-numbered chromosomes and the black denotes even-numbered chromosomes
A
The Author 2014. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
Heterogeneous genomics data at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
P.Ray et al. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
