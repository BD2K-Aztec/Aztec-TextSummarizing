Motivation: Recent advances in mass spectrometry and related metabolomics technologies have enabled the rapid and comprehensive analysis of numerous metabolites. However, biosynthetic and biodegradation pathways are only known for a small portion of metabolites, with most metabolic pathways remaining uncharacterized. Results: In this study, we developed a novel method for supervised de novo metabolic pathway reconstruction with an improved graph alignment-based approach in the reaction-filling framework. We proposed a novel chemical graph alignment algorithm, which we called PACHA (Pairwise Chemical Aligner), to detect the regioisomer-sensitive connectivities between the aligned substruc-tures of two compounds. Unlike other existing graph alignment methods, PACHA can efficiently detect only one common subgraph between two compounds. Our results show that the proposed method outperforms previous descriptor-based methods or existing graph alignment-based methods in the enzymatic reaction-likeness prediction for isomer-enriched reactions. It is also useful for reaction annotation that assigns potential reaction characteristics such as EC (Enzyme Commission) numbers and PIERO (Enzymatic Reaction Ontology for Partial Information) terms to substrate–product pairs. Finally, we conducted a comprehensive enzymatic reaction-likeness prediction for all possible uncharacterized compound pairs, suggesting potential metabolic pathways for newly predicted substrate–product pairs.
IntroductionUnderstanding cell metabolism is essential in a wide range of fields, e.g. metabolic engineering, synthetic biology, drug discovery and clinical treatments of metabolic disorders (). Recent advances in mass spectrometry and related metabolomics technologies have enabled the rapid and comprehensive analysis of numerous metabolites. However, biosynthetic and biodegradation pathways are only known for a small portion of metabolites, with the majority of pathways remaining uncharacterized (). For example, it is estimated that at least 1 060 000 metabolites are produced within all plants, for which most chemical transformations remain to be identified (). Elucidation of potential metabolic pathways in plants would provide a significant benefit for environmental, agricultural, pharmaceutical and public health matters. Experimental determination of metabolic pathways is difficult, expensive and time consuming (); thus automatic pathway reconstruction on a metabolome scale is a challenging issue in current computational biology. The traditional in silico method for metabolic pathway reconstruction is the predefined pathway approach, where enzyme-coding genes are mapped onto appropriate positions in the predefined pathway diagrams based on gene-gene sequence similarities (). This method has been used for analyzing metabolic pathways in fully sequenced organisms or in specific conditions of cellular processes (). Another method in the predefined
i161This is an Open Access article distributed under the terms of the Creative Commons Attribution Non-Commercial License (http://creativecommons.org/licenses/by-nc/4.0/), which permits non-commercial re-use, distribution, and reproduction in any medium, provided the original work is properly cited. For commercial re-use, please contact journals.permissions@oup.com, i161i170 doi: 10.1093/bioinformatics/btv224 ISMB/ECCB 2015 pathway approach is to consider chemical structures for finding pathways that conserve atoms from start to the target compounds in predefined pathway diagrams (). However, these methods are not applicable to the identification of previously unknown pathways (absent from predefined pathway maps). Conversely, various de novo pathway reconstruction methods have been developed to elucidate novel reactions based on metabolite chemical structures, known enzymatic reactions and possible chemical transformations. The overall problem resembles that of synthetic organic chemistry (), but few studies have tackled this problem for enzymatic reactions. Previously developed de novo methods can be categorized into either the compound-filling framework () or the reaction-filling framework (). However, previous methods in both frameworks are not applicable to metabolome-scale compound sets because of prohibitive computational burden. Recently, de novo pathway reconstruction in the reaction-filling framework has been formulated as a problem of enzymatic reactionlikeness, and an efficient supervised method has been proposed to predict whether the given pairs of metabolites can be chemically interconverted by single enzymatic reactions (). With this method, the use of chemical descriptorsbinary/integer vectors representing compound chemical characteristics (e.g. chemical substructures) ()is key for computational efficiency, which enables metabolome-scale application for tens of thousands of metabolites at a time. However, chemical descriptors cannot handle connectivities among substructures in a compound; thus, in theory, it is difficult to distinguish regioisomers (positional isomers), resulting in many false positive predictions in practice. Regioisomers are a group of compounds with the same compositional formula (numbers of respective elements) but are different in connectivity among the substructures. Proper distinction of isomers is required for appropriate interpretation of metabolome data (). Thus, there is a strong need to develop an efficient approach that can deal with regioisomers, thus strengthening the de novo pathway reconstruction study. In this study, we developed a novel method for supervised de novo metabolic pathway reconstruction with an improved graph alignment-based approach in the reaction-filling framework. We propose a novel chemical graph alignment algorithm, which we called PACHA (Pairwise Chemical Aligner), in order to detect regioisomer-sensitive connectivities between the aligned substructures of two compounds. Unlike other existing graph alignment methods [such as SIMCOMP (, PACHA can efficiently detect only one common subgraph between two compounds. Our results show that the proposed method outperforms previous descriptor-based methods or existing graph alignmentbased methods in the enzymatic reaction-likeness prediction for isomer-enriched reactions. It is also useful for reaction annotation that assigns potential reaction characteristics such as EC (Enzyme Commission) numbers () and PIERO (Enzymatic Reaction Ontology for Partial Information) terms () to substrateproduct pairs. Finally, we conducted a comprehensive enzymatic reaction-likeness prediction for all possible uncharacterized compound pairs, suggesting potential metabolic pathways for newly predicted substrateproduct pairs.
Materials
Chemical structures of compoundsChemical structures of metabolic compounds were retrieved from the KEGG LIGAND database (). MDL molfiles, which are the de facto standard of chemical structure format files, were converted to the KEGG Chemical Function (KCF) format (). In KCF, atoms (with the exception of hydrogen atoms) and bonds were represented as vertices and edges, respectively. Each vertex was given three labels representing the different levels of physicochemical properties, e.g. 'C' for a carbon atom, 'C1' for an sp3 carbon and 'C1a' for a methyl carbon (CH 3-). Hydrogen atoms were not explicitly represented as vertices but were implicitly represented in the attached atoms (see http://www.genome. jp/kegg/reaction/KCF.html). In this study, the one-letter label (e.g. C), two-letter label (e.g. C1) and three-letter label (e.g. C1a) were referred to as the primary, secondary and tertiary labels, respectively.
Substrateproduct pair datasetsSubstrateproduct relationships were retrieved from KEGG RPAIR and used as the positive examples of enzymatic reaction likeness. Different reaction directions were dealt as different pairs (e.g. 'LArginine-L-Ornithine' and 'L-Ornithine-L-Arginine') in order to not miss the similarity between the forward direction of a reaction and the reverse of another reaction. Known substrateproduct pairs were regarded as positive examples, whereas the remaining compound pairs were regarded as negative examples. To a certain extent, substrateproduct pairs share common structures, therefore, chemical similarity is one of the efficient measures to distinguish positive and negative examples. In this study, we focused on dealing with similar pairs (Jaccard coefficient > 0.5), which are more difficult and realistic condition. The numbers of positive examples and negative examples are 10 852 and 518 854, respectively, which is referred to as the 'all' dataset. From the all dataset, the positive and negative pairs were grouped by the same compositional formulas (i.e. the compound on one side of a pair is a regioisomer of the compound on the same side of another pair). The groups were then removed if there were less than four positive or negative pairs within a group. The set of the remaining compound pairs was referred to as the 'isomer-enriched' dataset. The numbers of positives and negatives in the isomerenriched dataset were 1632 and 53 046, respectively. Note that the isomer-enriched dataset is more difficult than the 'all' dataset in terms of enzymatic reaction-likeness prediction because of the issue of regioisomers.
Chemical descriptorsChemical structures of compounds were represented by highdimensional chemical descriptors, which are the binary/integer vectors representing the chemical structural characteristics of metabolites. We tested CDK Extended fingerprint, CDK GraphOnly fingerprint, CDK Hybridization fingerprint (), EState fingerprint (), KlekotaRoth fingerprint (), MACCS fingerprint (), PubChem fingerprint (), the atomic environment (AE) descriptor () and KCF-S descriptor (). For example, KCF-S descriptors represent the number of biochemical substructures, e.g. methyl, n-butyl, benzene and adenine residue. AE and KCF-S descriptors were calculated by our in-house program, whereas the other descriptors were generated using the Chemistry Development Kit (). i162 Y.Yamanishi et al.
Manually curated reaction annotationsEC numbers and PIERO terms were retrieved from KEGG and GenomeNet, respectively. EC numbers represent the hierarchical enzyme classification based on the full reaction equation (). EC sub-subclasses (upto the third digit of the EC numbers) were used as the reaction annotation by EC. PIERO is a collection of terminology annotating substrateproduct relationships in enzymatic reactions (). Because computing the exact solution for the graph alignment is intractable, we solved it using a greedy strategy. To efficiently select vertex pairs with the highest similarity in order, we propose to use the priority queue PQUEUE that stores vertex pairs v; v 0  2 V  V 0 and their similarities Sv; v 0 . PQUEUE supports the following operations:@BULLET Insert: insert a vertex pair v; v 0  2 V  V 0 and its similarity sv; v 0  into PQUEUE. @BULLET Get: get the vertex pair v; v 0  with the highest similarity in PQUEUE. @BULLET Pop: delete the vertex pair v; v 0  with the highest similarity from PQUEUE.We propose the following algorithm. We initialize PQUEUE as a vertex pair v; v 0  2 V  V 0 with the highest similarity and its similarity sv; v 0 . The algorithm iterates as follows. We first get the vertex pair v; v 0  with the highest similarity in PQUEUE and delete it from PQUEUE. We then insert the vertex pair v; v 0  into a set M c. Let N(v) be a set of vertices adjacent to v 2 V. We next insert all combinations of vertex pairs adjacent to v and v 0 , i.e. x; x 0  2 Nv  Nv 0 , into PQUEUE, which is necessary to satisfy constraint (ii) in the graph alignment. Considering constraint (i), we insert only vertex pairs x; x 0  2 Nv  Nv 0  into PQUEUE such that x; z 6 2 M c for all z 2 V 0 and z; x 0  6 2 M c for all z 2 V. When PQUEUE is empty, the algorithm stops. For accurate alignments, the algorithm restarts from each vertex pair chosen among those with top-k highest similarities, where k is a user defined parameter; k is set to 10 in this study. The algorithm finally returns the set of vertex pairs with the highest summation of similarities in M c. The pseudocode of the algorithm is presented in Algorithm 1.
Vertex similarity function based on fingerprintsWe propose to evaluate the similarity of each vertex pair in a graph by computing the similarity between two fingerprints of the vertices using the WeisfeilerLehman (WL) procedure (). A fingerprint defined as a binary vector is conceptually equivalent to the set that contains elements i if the ith bit of the fingerprint is 1, thus we use the set representation of fingerprints in this paper.Suppose we are given a chemical graph G  V; E; L. The first fingerprint of a vertex v 2 V is obtained by collecting vertex labels from N(v), adjacent vertices of v, to create a string. The string is then converted into a unique integer using a hash function, and it is added to the fingerprint as a new element. The integer is also assigned to a new vertex label for v. The same procedure is repeated T times. As a consequence, we obtain a fingerprint of T elements per vertex. The pseudocode of the WL procedure is presented in Algorithm 2.Algorithm 2 WL procedure for computing fingerprints for vertices in a graph. T is a user-defined parameter for deciding the number of iterations. g : R  ! R is a hash function that maps a string s h v to an integer such that gs h v  gs h w if and only if s h v  s h w. 1: function WLprocedure(G) 2: Wv / for all v 2 V 3: Initialize ' 0 v to v's vertex label L(v) for all v 2 V 4: for h  1;. .. ; T do 5: for each v 2 V do 6: Assign a multi-label M h v : f' h1 u; u 2 Nvg to v 7: Sort elements in M h v in the ascending order of vertex labels and concatenate them into a string s h v 8: Set ' h v : gs h v as a new vertex label of v 9: Wv Wv [ f' h vg 10: return fWv; v 2 Vg Each vertex in the chemical graph has three types of labels: primary, secondary and tertiary labels in this study. We apply the WL procedure to each label.shows an illustration of the WL procedure. The fingerprint for a vertex v is defined as W(v), which is the union of the resulting fingerprints for three labels. Given two compound chemical graphs G  V; E; L and G 0  V 0 ; E 0 ; L 0 , we propose the following similarity function s : V V 0 ! R for a vertex pair v; v 0  using the corresponding fingerprints W(v) and Wv 0  generated by the WL procedure: sv; v 0  : jWv \ Wv 0 j jWv [ Wv 0 j if v 0 s primary label is identical to v 0 s primary label; 1 otherwise:The vertex similarity is computed by the Tanimoto (also known as Jaccard) coefficient of fingerprints W(v) and Wv 0  if v's primary label is identical to v 0 's primary label. Otherwise, the vertex similarity is set to 1, which forces atom pairs with different primary labels to be unmatched in the graph alignment between two compounds.
Graph alignment-based feature vectorThe PACHA-based graph alignment enables us to assign one of three alignment states: 'aligned', 'generated' and 'eliminated' to each vertex pair, defined as follows:(which is referred to as 'PACHA descriptor' in this study. We built the PACHA descriptors using 68 tertiary labels, resulting in 3567-dimensional integer vectors.represents an example of the PACHA descriptor.
Predictive models for metabolic pathway reconstructionWe propose to apply the above PACHA descriptor to the enzymatic reaction-likeness prediction and reaction annotation, which are important applications for metabolic pathway reconstruction. Given two compound chemical graphs G and G 0 , we consider a predictive model defined as the linear function f G; G 0   w > U pacha G; G 0 , where w 2 R D is a weight vector. In the case of enzymatic reaction-likeness prediction, the weight vector w is estimated such that it can correctly predict the enzymatic reactionlikeness of compound-compound pairs. In the case of reaction annotation, the weight vector w is estimated such that it can correctly predict a specific reaction annotation class (i.e. EC sub-subclass or PIERO term in this study) of the compound-compound pairs. Given a collection of compound-compound pairs and their labels U pacha G i ; G j ; y ij , where y ij 2 f1; 1gi  1;. .. ; n; j  1; .. . ; n; i 6  j and n is the number of compounds in the learning set, we optimize the weight vector w by L 1-regularized linear support vector machine (L1SVM) formulated aswhere P ij  max f1  y ij w > U pacha G i ; G j ; 0g 2 , C is a hyperparameter and jj  jj 1 is L 1 norm (the sum of absolute values in the vector). L 1-regularization has an effect of making the weights of uninformative features zeros without loss of classification accuracy, which enables to extract important features characteristic of each task.
Results
Performance evaluation of the enzymatic reactionlikeness predictionWe tested the proposed PACHA descriptor for its ability to predict enzymatic reaction-likeness of compound-compound pairs from their chemical structure data. We compared this with previously developed chemical descriptors and graph alignment methods: CDK Extended fingerprint, CDK GraphOnly fingerprint, CDK Hybridization fingerprint, EState fingerprint, KlekotaRoth fingerprint, MACCS fingerprint, PubChem fingerprint, AE descriptor, KCF-S descriptor and SIMCOMP alignment (see Section 2 for more details). First, we focused on analysis of the isomer-enriched reaction data to validate the ability of PACHA to solve the issue of regioisomers. We performed the following five-fold cross-validation. First, we randomly split the compound-compound pairs in the gold standard reaction data into five subsets of roughly equal sizes, where known substrateproduct pairs were regarded as positive examples and the other compound-compound pairs were regarded as negative examples. Second, we took each subset as a test set and the remaining four subsets as a training set. Third, we learned a predictive model based only on the training set. Finally, we evaluated the prediction accuracy based on the prediction scores of compoundcompound pairs in the test set over the 5-folds. We evaluated the prediction performance using the receiver operating characteristic (ROC) curve, which is a plot of true-positive rates as a function of false-positive rates, and the precision-recall (PR) curve, which is a plot of precision (positive predictive value) as a function of recall (sensitivity). We summarized the performance by the area under the ROC curve (AUC) score, where 1 is perfect inference and 0.5 is random inference, and the area under the PR curve (AUPR) score, where 1 is perfect inference and the ratio of positive examples in the gold standard data is random inference. The third column ofshows the resulting AUC and AUPR scores and their standard deviations (SDs) in performing 5-fold cross-validation experiments for the isomer-enriched reaction data. It was observed that PACHA worked best among the graph alignment-based methods and KCF-S worked the best among the descriptor-based methods. In total, PACHA outperformed the previously developed methods in terms of higher AUC and AUPR scores. These results suggest that PACHA can capture the important features of(i) Build a multi-label from adjacent vertices ex) primary: {S,O,N}, secondary: {O2, N2, S3} tertiary: {O2c, N2c, S3x} (ii) Sort ex) primary: N, O, S secondary: N2, S3, O2 tertiary: N2c, S3x, O2c (iii) Add the vertex label as a prefix ex) primary: C, N, O, S secondary: C1, N2, S3, O3 tertiary: C1c, N2c, S3x, O2c(iv) Map the label sequence to a unique value ex) primary: C, N, O, S  X secondary: C1, N2, S3, O3  X10 tertiary: C1c, N2c, S3x, O2c  X10y (v) Assign the unique value as a new vertex label. Updating a node label surrounded by double circle by aggregating with neighboring labels in the WL procedure. The WL procedure is applied to each label class of primary, secondary and tertiary labels isomer-related chemical changes in reactions, while other methods can not capture isomer-specific chemical changes. Next, we tested the PACHA descriptor on its ability to predict enzymatic reaction-likeness using the 'all' reaction data that contains not only isomer-enriched reactions but also other enzymatic reactions. We performed Five-fold cross-validation experiments in a similar manner as the previous experiments. The fourth column ofshows the resulting AUC and AUPR scores and their SDs in performing the Five-fold cross-validation experiments of the enzymatic reaction-likeness prediction for all reactant pair data. It was also observed that PACHA worked the best among graph alignment-based methods and KCF-S worked the best among the descriptor-based methods. Thus, we attempted to combine PACHA and KCF-S by vector concatenation, which we call 'PACHA  KCF-S'. As a result, PACHA  KCFS worked much better than other individual methods, implying that descriptor-and graph alignment-based methods are complementary to each other and the integration of both approaches is useful in practice.
Analysis of chemical changes in isomer-related reactionsWe examined the detailed prediction results of the cross-validation experiments and analyzed the relationship with chemical changes in isomer-related reactions. We then compared PACHA (the best among graph alignment-based methods) and KCF-S (the best among descriptor-based methods).shows some examples of the predicted chemical transformations grouped by isomeric compounds. Most positive examples (a1, b1 and c1) were predicted correctly by KCF-S and PACHA, whereas some negative examples (a2, a3, b2, b3, c2 and c3) were predicted differently. Pairs a2, b2 and c2 were predicted as negative by KCF-S and positive by PACHA. Although these pairs were not known substrateproduct pairs, these chemical changes were already known in other compounds, which occurs only once in each pair. Therefore, we can conclude that these pairs represent potential reactions that are likely to occur. Conversely, pairs a3, b3 and c3 were predicted negative by PACHA and positive by KCF-S. If these chemical conversions were to occur, at least two reactions would be needed for each pair. Pair a3, representing the chemical change from pinocarveol (C11941) to myrtenal (C11939), would require dehydroxylation and hydroxylation reactions and the isomerization of the pi-conjugated system.Pair b3, genistein (C06563) and vitexin (C01460), would require not only C-glycosylation but also in the rearrangement of the ring attachment. Pair c3, benzopyrene (C14435) and benzopyrene7,8-epoxide (C14850), would also require at least two reactions, not only an epoxydation but also the rearrangement of the ring structure. Thus, we can conclude that these pairs do not represent single reactions.
Performance evaluation of reaction annotation and extraction of reaction class-specific featuresWe investigated the usefulness of the proposed PACHA descriptor for reaction annotation. As enzymatic reaction characteristics, we used EC sub-subclasses and PIERO terms. Reaction annotation is generally performed by predicting potential EC sub-subclasses or PIERO terms directly from differential chemical structures of compoundcompound pairs, which is referred to as 'direct approach'. Here, we proposed a two-step approach that first performs enzymatic reaction-likeness prediction for compoundcompound pairs, followed by the reaction annotation for only the predicted substrateproduct pairs, which is referred to as the 'filtering approach'. Because PACHA  KCF-S worked the best in the cross-validation experiments for enzymatic reaction-likeness prediction, we focused on the use of PACHA  KCF-S and made a performance comparison between the previous direct approach and our proposed filtering approach. We performed the following Five-fold cross-validation. First, we randomly split compoundcompound pairs in the gold standard reaction data with an EC sub-subclass (respectively, PIERO term) into five subsets of roughly equal sizes, where compoundcompound pairs with the EC sub-subclass (respectively, PIERO term) were regarded as positive examples and other compoundcompound pairs were regarded as negative examples. Second, we took each subset as a test set and the remaining four subsets as a training set. Third, we learned an EC-specific (respectively, PIERO-specific) predictive model based only on the training set. Fourth, we evaluated the prediction accuracy based on the prediction scores of compound compound pairs in the test set over the Five-folds. Finally, we repeated the above processes for all EC sub-subclasses (respectively, all PIERO terms). Figures 4 and 5 show the resulting AUC and AUPR scores for EC sub-subclasses and PIERO terms, respectively. In both cases, our proposed filtering approach outperformed the previous direct approach(Metabolome-scale de novo pathway reconstruction i167 in terms of higher AUC and AUPR scores. These results suggest that, in practice, comprehensive filtering of compound-compound pairs by enzymatic reaction-likeness is useful for more accurate reaction annotation.shows the examples of respective reaction annotations predicted by the direct and filtering approaches. The filtering approach worked better than the direct approach in terms of AUC and AUPR. The best performance was achieved for EC1.3.5 'oxidoreductase reactions acting on the CH-CH group of donors with a quinone or related compound as an acceptor' as EC sub-subclasses and 'diesterification' as PIERO. Regardless of AUC or AUPR, the predictive values were generally higher in PIERO than in EC. This result reflects the fact that EC numbers were given to full reaction equations, whereas PIERO terms were given to substrateproduct pairs.shows several examples of the extracted vector features in PACHA and KCF-S that are significant to EC and PIERO. Note that the predictive model used in this study (i.e. L1SVM) has the ability of feature extraction. Interestingly, the extracted PACHA features correspond to the chemical changes that occurred in the preserved atoms. For example, the feature 'a:O2x  O7x' represents the preserved oxygen atom that changes from a cyclic ether to a cyclic ester, which is one of the typical EC1.1.1 reactions that causes dehydrogenation of sugars to yield lactone sugars. This feature was a reasonably important and characteristic feature of EC1.1.1 and 'dehydrogenation'. Conversely, the extracted features from descriptors-based methods (e.g. KCF-S) were generally difficult to interpret because descriptor-based methods cannot distinguish the relationships between preserved atoms and their chemical changes. All results can be found at http://www.bioreg. kyushu-u.ac.jp/labo/systemcohort/pacha/.
Novel predictionFinally, we conducted a comprehensive prediction of enzymatic reaction-likeness for all possible compound pairs, with the exception of known substrateproduct pairs. We trained a predictive model using all known substrateproduct pairs in the gold standard data (10 852 pairs retrieved from KEGG as of December 2012) and applied the model to all possible uncharacterized compound-compound pairs (30 719 540 pairs) for which pathways and reaction characteristics were not known. PACHA and PACHA  KCFS predicted 54 919 and 28 192 compound pairs as potential substrateproduct pairs, respectively. We confirmed the validity of 672 compound pairs predicted by PACHA and 683 compound pairs predicted by PACHA  KCF-S using independent resources such as recent scientific literatures and the latest databases (KEGG as of December 2014).shows an example of the newly predicted pathways by PACHA and PACHA  KCF-S methods, which are supported by the latest database information. Note that the reactions in the pathway were not used in the learning set for constructing the predictive model. These reactions and compounds were not in the January 2014 release of KEGG but were recently added to the December 2014 release. This pathway represents the biosynthesis ofbrassinosteroids, important steroid hormones that regulate plant development and physiology (). This pathway was successfully reconstructed by our proposed methods but was not reconstructed by previous methods.
DiscussionWe developed a novel method for supervised de novo metabolic pathway reconstruction with an improved graph alignment algorithm called PACHA. Our proposed PACHA enabled us to detect regioisomer-sensitive connectivities between aligned substructures of two compounds. The novelty of our proposed method lies in the detection of a unique graph alignment, scalability for analyzing a vast amount of compounds on a metabolome-scale and applicability to many tasks in metabolic pathway reconstruction. We showed the usefulness of the PACHA descriptors for enzymatic reaction-likeness prediction and reaction annotation with a sparsity-induced classifier. This study addressed the importance of the distinction of regioisomers for metabolic pathway analysis. Although a popular approach for representing compounds is to use chemical descriptors that deal with many small chemical substructures, they cannot correctly consider the substructure connectivity. Thus, the comparison of two chemical descriptors is insufficient to generate atomatom mapping, which makes it impossible for all descriptor-based methods to describe sensitive chemical changes in a single enzymatic reaction, as illustrated in. SIMCOMP (), the most related previous graph-based method, was designed for searching similar compounds in databases by allowing some small common substructures. The common procedure in SIMCOMP and PACHA is to generate an association graph, where the vertices (association nodes) represent the atomatom pairs of two compounds and obtain common subgraph(s) considering adjacency. The difference between SIMCOMP and PACHA lies in the definition of 'adjacency' in the association graph. PACHA defines the association nodes as being adjacent to each other only when the corresponding atoms are adjacent in both compounds; therefore, only one common subgraph occurs and the second common subgraph is not allowed. SIMCOMP defines the association nodes to be adjacent either when the corresponding atoms are adjacent in both compounds or when they are not adjacent in both compounds. The adjacency in the SIMCOMP association graph often generates multiple common subgraphs, which are integrated afterwards; however, in some cases, the integrated subgraph contains many gaps. Having such gaps is not an issue when finding similar compounds, e.g. for pharmaceutical purposes. However, it is of crucial importance for metabolic pathway analysis, because most reactions generate or eliminate only a few chemical bonds. Therefore, the number of gaps affects the prediction accuracy of enzymatic reaction-likeness. Our proposed PACHA algorithm solved this problem successfully as demonstrated by significant improvement of the de novo pathway reconstruction, especially in the analysis of isomerenriched data. Future extensions would involve the detection of frequent substructure changes and stereoinversions, which requires more sophisticated tuning of PACHA.
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
Methods 3.1 Chemical graph alignment problem We address the problem of chemical graph alignment using a simple example. Figure 1 shows two compounds of n-butylamine (compound A) and methyl-n-propylamine (compound B) that are regioisomers (positional isomers). Figure 1(a) shows the atomatom mapping by the chemical graph alignment of the two compounds, which detects the preserved substructure in a putative reaction and the changed chemical bonds. In this example, four vertices are preserved, two of which changed labels; an edge labeled 'C1a-C1b' is eliminated and an edge labeled 'C1a-N1b' is generated. To characterize reactions and distinguish regioisomers, it is crucial to detect type of bond that has changed and the position where it has changed. Since the two compounds are regioisomers, no differences would be detected by counting the elements (C, H and N). Figure 1(b) shows a feature vector representation of the compound pairs, such as, using KCF-S descriptors representing the number of substructures, e.g. methyl (C1a-), ethyl (C1a-C1b-) and n-propyl (C1a-C1bC1b-), etc. The feature vector detects preserved (common) and changed (decreased and increased) chemical characteristics. However, the descriptor-based feature vector does not necessarily reflect the exact chemical changes that actually occur in the reaction. For example, although the feature vector indicates that vertex C1a is preserved in two compounds, the C1a vertices do not form an atomatom pair in the graph alignment. Thus, it is very difficult for descriptor-based methods to capture the chemically important characteristics of reactions. In this study, we propose a novel method for chemical graph alignment that can handle the issue of regioisomers and show the potential of the proposed method for applications to the enzymatic reaction likeness prediction and reaction annotation on a metabolome-scale. The details of the proposed method are explained below. 3.2 Pairwise chemical aligner (PACHA) We propose a novel, efficient algorithm named PACHA for chemical graph alignments. We represent each compound chemical structure G by a labeled graph defined as G  V; E; L, where V is the set of vertices (i.e. atoms in this study), E is the set of undirected edges (i.e. bonds in this study) and L : V ! R is a function that assigns labels from an alphabet R to vertices (i.e. primary, secondary or tertiary labels in this study). Let s : V  V ! R be a similarity function between a vertex pair (i.e. an atomatom pair in this study) and returns 1 if the vertex pair is unmatched. The function s will be detailed in the next subsection. Suppose we are given two chemical graphs G  V; E; L and G 0  V 0 ; E 0 ; L 0 . We formulate the graph alignment as the problem of finding a set of matching vertex pairs M V  V 0 that maximizes the summation of vertex similarities sv; v 0  for v; v 0  2 M as follows: max MVV 0 X v;v 0 2M sv; v 0 ; (1) under the following two constraints: (i) If v; v 0  2 M, then v; z 6 2 M for all z 2 V 0 and z; v 0  6 2 M for all z 2 V, i.e. a vertex in V can be matched to at most one vertex in V 0. (ii) The matching vertices in M of G (respectively, G 0 ) and edges E 0 (respectively, E 0 ) form connected subgraphs, i.e. there is a pass from any vertex to the other vertices in G (respectively, G 0 ). Note that constraint (ii) is absent from existing graph alignment methods such as SIMCOMP (Hattori et al., 2003), which causes the generation of many (possibly small) subgraph matches, thus preventing the sensitive detection of regioisomers. (a) (b) Fig. 1. (a) Graph alignment-based vector proposed in this study. Graph alignment yields atomatom mapping (represented by dashed lines). Subsequently, the number of atomatom pairs in the alignment (e.g. the column labeled 'a:C1a  C1a' in the white boxes on the left), the number of eliminated bonds (e.g. the column labeled 'e:C1a-C1b' in the gray boxes in the middle) and the number of generated bonds (e.g. column labeled 'g:C1a-N1b' in the gray boxes on the right) were represented as a vector. The symbols '' and '' represent the atomatom mapping and the chemical bond, respectively. (b) Descriptor-based vectors in the previous studies (e.g. KCF-S). Each compound vector represents chemical characteristics (e.g. number of substructures). The feature vector for the compound pair consists of three parts: common features between the two compounds (in the white boxes on the left), excess number of features in the left compound (in the gray boxes in the middle) and right compound (in the gray boxes on the right) Metabolome-scale de novo pathway reconstruction i163 at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
Metabolome-scale de novo pathway reconstruction i165 at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
Metabolome-scale de novo pathway reconstruction i169 at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
