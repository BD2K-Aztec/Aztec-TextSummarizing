Motivation: Haplotype models enjoy a wide range of applications in population inference and disease gene discovery. The hidden Markov models traditionally used for haplotypes are hindered by the dubious assumption that dependencies occur only between consecutive pairs of variants. In this article, we apply the multivariate Bernoulli (MVB) distribution to model haplotype data. The MVB distribution relies on interactions among all sets of variants, thus allowing for the detection and exploitation of long-range and higher-order interactions. We discuss penalized estimation and present an efficient algorithm for fitting sparse versions of the MVB distribution to haplotype data. Finally, we showcase the benefits of the MVB model in predicting DNaseI hypersensitivity (DH) status—an epigenetic mark describing chromatin accessibility—from population-scale haplotype data. Results: We fit the MVB model to real data from 59 individuals on whom both haplotypes and DH status in lymphoblastoid cell lines are publicly available. The model allows prediction of DH status from genetic data (prediction R 2 ¼ 0:12 in cross-validations). Comparisons of prediction under the MVB model with prediction under linear regression (best linear unbiased prediction) and logistic regression demonstrate that the MVB model achieves about 10% higher prediction R 2 than the two competing methods in empirical data. Availability and implementation: Software implementing the method described can be down-loaded at
IntroductionAccidents of history and variable recombination rates have divided the human genome into blocks of shared recent ancestry (1000). Ancestry sharing manifests itself in complex haplotype patterns and strong dependencies among variants. [Recall that a haplotype summarizes the sequence of alleles displayed by the sampled markers in a narrow genomic region of a particular chromosome (Therefore, modeling haplotype data is of paramount importance for a wide range of problems in population genetics and disease gene discovery (). Haplotypes have been traditionally analyzed by hidden Markov models (HMMs) (), with emissions corresponding to observed genotypes and transitions to recombination events. Although HMMs for haplotypes undergird many efficient and accurate algorithms for haplotype phasing (), genotype imputation (Browning and Browning,) and identity-by-descent detection (), they suffer from the drawback of modeling only dependencies between consecutive variants. This assumption leads to the unrealistic conclusion that the previous variant and the next variant are independent given the current variant. Ignoring dependencies among non-consecutive markers makes it difficult to detect and exploit long range correlations and higherorder interactions among variants. These complex dependencies definitely exist in the human genome and are important factors in genetic studies (). This article applies the multivariate Bernoulli (MVB) distribution to haplotype data. The MVB distribution captures the entire spectrum of dependencies among the entries of random binary vectors of length N (). The observed haplotypes at N nearby single-nucleotide polymorphisms (SNPs) can be thought of as realizations of such a process. Since there are 2 N possible haplotypes for N SNPs, the MVB distribution requires an unsustainable exponential number of parameters. Vast amounts of training data or clever algorithms cannot compensate for this combinatorial explosion. Here, we investigate a Poisson re-parameterization of the MVB distribution and impose an '1-norm penalty to enforce sparsity in parameter estimation. These steps allow us to devise an efficient coordinate ascent algorithm for learning the MVB parameters from haplotype data while restricting the number of parameters to a manageable level. We showcase the utility of the MVB model by predicting an individual's DNaseI hypersensitivity (DH) status from haplotypes observed near known DH sites. DH status is a mark of open chromatin and flags genomic regions where the DNA is accessible to the DNaseI enzyme. These regions, such as transcription start sites, correlate with active DNA regulation. DH status is usually assayed through DNase-Seq, a genome-wide high-throughput technology that sequences genomic regions sensitive to DNaseI (). Recent research () suggests that genetic variants control this epigenetic mark. Since DH status can be naturally encoded as a binary variable, the MVB model offers a natural way to integrate DH status and local haplotype data. In predicting DH status from haplotypes, the MVB model allows all allelic sets to contribute regardless of the order of the participating SNPs and the physical distances separating them. Our analysis of data from the 1000 Genomes project (1000 Genomes) demonstrates the superiority of the sparse MVB distribution in model fitting. In practice, interactions beyond order three play little role in determining haplotype frequencies in these data. Our new cyclic coordinate descent algorithm for estimating the MVB interaction parameters converges quickly and reliably. The MVB model also turns out to be pertinent to predicting DH status from haplotype data at known DH sites (). On a sample of just 59 subjects, cross-validation under the MVB yields a prediction R 2 of 0.12 for dichotomized DH levels. As expected, the accuracy of DH prediction decreases as extraneous predictors are added. Finally, prediction under the MVB achieves about 10% better accuracy than prediction by linear regression (best unbiased linear predictor or BLUP) and logistic regression. Thus, the MVB model is recommended for prediction of binary epigenetic status from local haplotype data.
Methods
The MVB distribution as a model for haplotype dataThe MVB distribution extends the univariate Bernoulli distribution to binary vectors of fixed length N (). The density PrY  y  p y1; ... ;yN  of such a discrete random vector Y depends on 2 N probabilities p 0;0; ... ;0 ; p 0;0; ... ;1 ;. .. ; p 1;1 ... ;1 specific to the different realizations of Y. For example, the bivariate Bernoulli distribution consists of four realizations (0, 0), (0, 1), (1, 0) and (1, 1) specified by four probabilities p 0;0 ; p 0;1 ; p 1;0 and p 1;1. By definition, the conditional distribution of a subvector, say Y 1 ; Y 2 ;. .. ; Y k , given the complementary subvector, say Y k1 ;. .. ; Y N , is also MVB. In the bivariate case, conditioning on either Y 1 or Y 2, produces a standard univariate Bernoulli distribution. There is an alternative parameterization that captures interactions and is conducive to parsimony. This parameterization substitutes subsets of f1;. .. ; Ng for binary vectors. To the realization y, we correspond the index set A  fi : y i  1g. The natural parameters f C of the MVB model are indexed by interaction subsets C, and the density function PrY  y is written as the ratiowhere we define S A  P C A f C for notational simplicity. The denominator P B expS B  is the appropriate normalizing constant. The haplotypes spanning N bi-allelic SNPs can be represented as binary vectors of length N. We adopt the convention that y i  0 indicates the major allele and y i  1 indicates the minor allele at SNP i. One can obviously model the distribution of haplotypes in a population as MVB. The major advantage of the MVB is its ability to incorporate interactions in the recovery of haplotype frequencies. The number of parameters in both the naive and interaction parameterizations grows exponentially fast in N. However, the interaction parameterization organizes interactions by level and suggests limiting model complexity by imposing an upper bound on interaction level. The next section introduces a lasso penalty that in combination with maximum likelihood estimation eliminates superfluous interactions and keeps the number of levels in check.
Estimating MVB parameters from haplotype dataTo estimate haplotype frequencies and ultimately infer missing haplotypes, one can randomly sample a population and count the number X A of haplotypes of each type A. For a fixed sample size M, the X A jointly follow a multinomial distribution with M total counts and the count probabilities PrA displayed in Equation (1). Alternatively, one can adopt a Poisson rather than a multinomial sampling framework. The two share the assumption of independent samples but differ in whether the total sample size is random (Poisson) or fixed (multinomial). The law of small numbers justifies the equivalence of the two frameworks. The Poisson setting invokes a mean sample size l, which is estimated by the observed sample size P A X A. One can show () that the random variables X A are independent and Poisson distributed with means l A  lPrA. In the Poisson framework, it is easier to work with the interaction parameters by setting l A  expS A   exp P B A f B  and ignoring l and the normalizing constant P B expS B . In effect, these are absorbed into the empty set parameter f ;. Independence of the X A now yields the likelihoodwhere X  X A  and f  f A  are the vectors of haplotype counts and interaction parameters, respectively. Taking logarithms produces the log likelihoodIt is natural to estimate the MVB parameter vector f  f A  by maximizing 'fjX. Unless N is small and the sample size M is large, estimating all 2 N MVB parameters is an exercise in over-fitting. To achieve parsimony, we append an ' 1-norm (lasso) penalty to the log likelihood. Any reasonable model should include the low-order parameters f A with jAj 1, where jAj denotes the cardinality of the set A. Hence, we maximize the penalized log likelihoodHere, k is a tuning constant determining the strength of the penalty. Increasing k increases the sparsity of the estimated parameter vector. The analogy with lasso-guided regression is obvious. The new objective function Ff is concave and directionally differentiable. It has kinks introduced by the terms jf A j. We recommend maximization by coordinate ascent.
Coordinate ascent algorithmCoordinate ascent maximizes the objective function one parameter at a time holding other parameters fixed. Cycling through the parameters continues until the objective value converges or a maximum number of iterations is reached. Algorithm 1 outlines the coordinate ascent algorithm for estimating model parameters.Algorithm 1 coordinate ascent algorithm for fitting the MVB 1: Let C be the collection of possible haplotypes of length N 2: Initialize f A to 0 for all A 2 C 3: while stop condition fails do 4: for A in C do 5: f A  arg max fA Ff 6: end for 7: end whileLine 5 of Algorithm 1 requires finding arg max fA Ff. To update f A when jAj 1, we set the partial derivative of Ffwith respect to f A equal to 0. This yields the updateWhen jAj ! 2, the supergradientmust contain 0 (). Equating it to 0 yields the updateIn view of the summations over B A in the denominators of Equations (6) and (8), each coordinate ascent update takes nearly O2 N  operations. This computational load restricts estimation to MVB models with small N, say N 15. Once parameters are estimated, prediction under the MVB is relatively straightforward. The normalizing constant in formula (1) must be calculated, but this can be done once and the result stored.
Best linear unbiased predictorPart of our evaluation of the MVB involves comparison of DH prediction on simulated data. The simulated DH status y i of an individual i was constructed as a linear combination of individual i's SNP alleles and SNP pairwise interactions weighted by effect sizes b j and b jk. In symbolswhere h ij is the SNP predictor (standardized version of 0 or 1) of individual i at SNP j, h ij h ik is the SNP interaction of individual i for the pair of SNPs j and k and e i is an independent normally distributed error term. Simplified versions of the model ignore the pairwise interactions and take all b jk  0. To make predictions under the linear model, we first estimate the effect sizes b j and b jk from training dataset and then predict the phenotype (DH status) of each individual in the test data, substituting estimated parameters for true parameters. For notational brevity, let H  H SNP ; H INT  be the block matrix of single SNP and interaction SNP predictors across the training set; for each subject i and SNPs j and k, the matrix H SNP has entries h ij  and the matrix H INT has entries h ij h ik . The effect sizes b j and b jk are estimated by the least squares formula ^ b  H T H 1 H T y:Finally, the BLUP ^ y i of DH status for an individual i is computed via2.5 Logistic regression (LOGIT)We also compared the MVB model with logistic regression (LOGIT); unlike linear regression, logistic regression directly models binary outcomes. Under logistic regression, the probability of the DH status y i of individual i given his/her SNP alleles h ij  and pairwise interactions h ij h ik  iswhere c i  a 0  P j a j h ij  P fj;kg a jk h ij h ik. Here the a's are the regression coefficients in logistic regression. As with linear regression, one can simplify the model by ignoring pairwise interactions and taking all a jk  0. To estimate the parameters of the model, one maximizes the likelihoodover the entire sample. Prediction of the DH status of individual i relies on the predicted probabilityof y i  1, where ^ c i is the same as c i except for substitution of estimated regression coefficients for true coefficients.
HMM for haplotypesAn HMM views a haplotype h of length N as a mosaic of haplotypes from a set H of R reference haplotypes (). The N  R HMM states (i, j) capture the particular reference haplotype j occurring at SNP i. A transition matrix K models recombination events and controls how switches occur between haplotypes in meiosis. The entries Kij; kl of the transition matrix are 0 unless k  i  1. For neighboring SNPs, the entries depend on the distance between the SNPs. Thus, the larger the distance, the larger the transition probability for j 6  l. The emission probabilities Prh i jij allow for mistyping and occasional mutation events. Inferences based on HMM are achieved efficiently through the forward, backward and Viterbi algorithms, all of which have complexity ONR 2 . We adopt the latest IMPUTE2 () implementation of HMM for comparison purposes.
Results
Assessment of MVB on 1000 genome haplotypesIn an initial set of experiments, we used the 1000 Genomes EUR (European) haplotypes (505 individuals) to investigate the performance of the MVB model and our coordinate descent algorithm for fitting it to data. We randomly selected 50 regions on chromosome 1, each containing 15 SNPs and fit the MVB under various settings. The first setting imposed no constraint on the maximum order (max jAj) of the interaction sets A. Thus, in effect, we estimated all 2 15  32 768 parameters.shows that the regularization constant k has a significant effect on the magnitude of parameters, especially for f A 's where jAj ! 4. For example, as k increases from 0.0 to 0.5, the sum P jAj4 jf A j of estimated parameters decreases from 87.5 to 30 for interaction sets with jAj  4. Furthermore,indicates that the average value of jf A j converges to 0 as jAj tends to N  15. Thus, we conclude that the lower-order interactions f A predominate in determining haplotype frequencies. Next we investigated how well the MVB fits the selected 1000 Genomes haplotypes using just lower-order interactions. To measure goodness of fit, we computed the Euclidean distance between the haplotype frequencies recovered by the MVB model as given in Equation (1) and the haplotype frequencies observed in the data.demonstrates that the MVB model requires only the lowerorder interactions terms to accurately fit typical data. Because k  0:25 attains the best fit across interaction level bounds (jAj b, we set k to 0.25 in all future experiments. We also recorded the number of iterations until convergence of the coordinate descent algorithm. The algorithm invariably converges within 2030 iterations. Seefor typical results. Finally,lists that the bulk of computational time is taken in estimating MVB parameters; once model parameters are estimated, applying the model to making predictions is relatively trivial.
Prediction of DH status in simulationsTo simulate binary DH data, we took the 1010 EUR (Bold values indicates the column attaining the best fit for the MVB model.ively. Finally, we converted the continuous DH values to binary DH values by imposing a threshold chosen so that 20% of the binary DH values were elevated (status 1 rather than status 0). For testing under the MVB model, we constructed binary vectors of length 16 by concatenating each 15-SNP haplotype and a corresponding simulated binary DH status. Given the tuning constant k  0:25, this allows us to estimate the f A parameters. To predict DH status given observed SNP haplotypes, one simply computes a conditional probability under the MVB model. In one set of MVB trials, we limited the interaction level to jAj 2, for a total of 137 parameters. In a second set of trials, we limited the interaction level jAj 3, for a total of 697 parameters. One can compare MVB prediction to BLUP and LOGIT prediction based on the same SNP haplotypes and interaction model. For BLUP and LOGIT, we also tested a model involving SNPs and interactions between adjacent SNPs. In linear regression, Equation (10) supplies effect sizes, and Equation (11) supplies predicted values. In logistic regression, Equation (14) supplies predicted values. For estimation and prediction under HMM, we concatenated DH status as a pseudo SNP at the end of each 15-SNP haplotype to avoid changing the SNP interactions in the original haplotype. We also set the physical distance between the pseudo SNP and the last SNP to be the average distance between consecutive pairs of SNPs in the original 15-SNP haplotype.We employed half of the simulated individuals as reference panel and ran HMM with IMPUTE2 default settings on the other half to obtain predicted DH status. All 200 simulations summarized below involve two causal SNPs (m  2) and two causal SNP interactions (n  2) for 200 randomly sampled individuals. Of these 200 people, 100 served as training individuals and 100 as validation individuals. We first investigated performance of MVB, BLUP, LOGIT and HMM prediction for varying h 2 for a fixed interaction h 2 int of 0.1.shows that prediction R 2 achieved by all models increases as h 2 increases. However, the MVB model consistently achieves higher prediction R 2 than BLUP, LOGIT and HMM under both settings, suggesting that the MVB model is capable of yielding more accurate estimates of effect sizes for prediction. Notably as h 2 increases, the improvement in prediction R 2 also increases. In other words, as the effect of a single SNP increases, the comparative advantage of the MVB model over BLUP, LOGIT and HMM increases. Next we investigated the accuracy of these approaches at varying h 2 int values.demonstrates that for all pairs of h 2 and h 2 int , the MVB model also achieves higher prediction R 2 than BLUP, LOGIT and HMM. Finally, we investigated the number of samples required for accurate prediction.shows that although the MVB model requires more parameters than BLUP, LOGIT and HMM, it is able to outperform these models even if the training sample size is small. This suggests that the MVB model is less sensitive to noise. Notably, HMM under-performs both MVB and LOGIT in most simulation settings, suggesting that HMM is less capable of detecting long range interactions for reasonable sample sizes. Across all simulated datasets, we observe no major difference in prediction R 2 between the two MVB settings. This is to be expected since only pairwise interactions are simulated.
Predicting DH status in empirical dataWe now turn to real data on DH status and reach similar conclusions. The dataset in question () contains normalized DH scores for 70 YRI (Yorubas in Ibadan, Nigeria) individuals at 1.5 million 100-bp genomic windows. These windows cover the5% of the human genome with the highest DNaseI sensitivity. About half of the windows are expected to be truly sensitive to DNaseI (); 8902 windows have associated dsQTLs [SNPs showing significant correlations with DH scores across individuals (. We dichotomized DH scores by placing scores above the threshold of 0.0 in one category and scores below the threshold of 0.0 in the complementary category. Among the 70 YRI individuals in the sample, 59 are also in the 1000 Genome project (1000 Genomes) and have fully phased haplotypes. We accordingly used the haplotypes and the binary DH status of these 59 individuals to evaluate the MVB model. For computational reasons, we selected one haplotype for each individual and restricted our analysis to 250 random DH sites and the 377 DH sites with associated dsQTLs on chromosome 22. In genomic windows with associated dsQTLs, the dsQTLs are on average about 8000 base pairs (10 SNPs) away from their windows. This action at a distance renders it difficult for HMMs to accurately capture interactions between dsQTLs and their genomic windows. Because sequence order is an important factor for HMMs, the question also arises of where to place binary DH status (a pseudo SNP) in the haplotype. For this reason, we excluded HMM from comparisons on real data. To avoid over-fitting, we assessed prediction accuracy by leaveone-out cross-validation. Thus, we estimated parameters using data from 58 (all but one) training individuals and predicted DH status for the remaining validation individual. Repeating this process across all 59 individuals allowed us to compare predicted and true DH status. The results can be summarized in a squared Pearson correlation (prediction R 2 ). Prior to parameter estimation in each of the 59 folds, we selected a small number of relevant SNP predictors by linear regression and forward selection. Our selection procedure excluded SNPs with minor allele frequency below 1% or at a distance of 1 Mb or greater from the center of the window. Each successive SNP entering the candidate list provided the greatest reduction of the current residual sum of squares. Given a candidate set of SNP predictors P in the MVB model, we created binary haplotype vectors of length jPj  1 from the SNPs and the binary DH status. We considered at most secondorder interactions and set the penalty constant k to 0.25. For BLUP and LOGIT, we considered three models, one limited to single SNPs, one involving both single SNPs and two-way interactions and one involving single SNPs and only interactions between adjacent SNPs.shows the prediction R 2 obtained through leave-oneout cross-validation averaged over the 250 randomly selected windows. Because of overfitting and our small sample size, the average prediction R 2 decreases for all methods as the number of predictors j Pj increases. The MVB model achieves higher prediction R 2 than BLUP and LOGIT over both settings. We repeated the same experiment on the 377 windows with associated dsQTLs. Again the MVB model consistently achieves higher prediction R 2 than BLUP and LOGIT ().and d depict the distribution of prediction R 2 's under each model. It is clear that the MVB models achieve more high prediction R 2 's (greater than 0.2) than BLUP and LOGIT. One can legitimately conclude that the MVB model predicts DH status better than BLUP and LOGIT.summarizes the average and standard error of prediction R 2 for some representative experiments.
DiscussionThis article presents the MVB distribution as a vehicle for modeling haplotype data. Because the number of distinct haplotypes observed in a narrow genomic region tends to be small, the MVB model is typically wildly over-parameterized. To achieve parsimony, we propose a lasso penalty within a Poisson sampling framework. The penalized MVB model encourages the detection and exploitation of higher-order interactions among the underlying SNPs. In contrast to Markovian models, interactions extend beyond nearest neighbor and pairwise interactions. The interaction parameterization adopted here is more natural than the naive MVB parameterization implicitly seen in BLUP and LOGIT. Empirically, the interaction parameterization extracts more haplotype information and predicts with better accuracy. Our application of the MVB model to predict DH status from observed haplotypes supports the utility of the model. We show that the MVB model achieves better accuracy than BLUP and LOGIT in predicting simulated DH status. The overall prediction R 2 achieved by MVB, BLUP and LOGIT on real DH status suggests substantial heritability of this epigenetic signal.. Prediction R 2 across 100 validation individuals averaged over 200 regions for MVB, BLUP, LOGIT and HMM as a function of h 2 int when h 2 is fixed at 0
.1In likelihood evaluation and parameter estimation, the computational complexity of the MVB models scales like 2 N for N SNPs. This harsh reality limits the applicability of the model to a small number of variants. Fortunately, even for small N, the MVB model offers valuable insights into genomic data. The MVB model may well be critical in predicting binary gene expression when a small number of causal variants localize within a gene. In particular, MVB profiles in cases and controls may help in fine mapping traits in genome-wide association studies. Overcoming the computational limits of the MVB model limit is high on our research agenda. Once this task is accomplished, it will be possible to apply the MVB model to pre-phasing, a technique for improving genotype imputation by first imputing haplotypes (). We conjecture that Monte Carlo methods will play a decisive role in extending the range of the model to larger N. Finding an efficient sampling scheme to approximate the normalization constant P B expS B  is of paramount importance and doubtless the place to start in accelerating algorithm performance.
at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
