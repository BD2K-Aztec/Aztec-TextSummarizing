Motivation: Feature selection, identifying a subset of variables that are relevant for predicting a response , is an important and challenging component of many methods in statistics and machine learning. Feature selection is especially difficult and computationally intensive when the number of variables approaches or exceeds the number of samples, as is often the case for many genomic datasets. Results: Here, we introduce a new approach—the Bayesian Ising Approximation (BIA)—to rapidly calculate posterior probabilities for feature relevance in L2 penalized linear regression. In the regime where the regression problem is strongly regularized by the prior, we show that computing the marginal posterior probabilities for features is equivalent to computing the magnetizations of an Ising model with weak couplings. Using a mean field approximation, we show it is possible to rapidly compute the feature selection path described by the posterior probabilities as a function of the L2 penalty. We present simulations and analytical results illustrating the accuracy of the BIA on some simple regression problems. Finally, we demonstrate the applicability of the BIA to high-dimensional regression by analyzing a gene expression dataset with nearly 30 000 features. These results also highlight the impact of correlations between features on Bayesian feature selection. Availability and implementation: An implementation of the BIA in Cþþ, along with data for reproducing our gene expression analyses, are freely available at
IntroductionLinear regression is one of the most broadly and frequently used statistical tools. Despite hundreds of years of research on the subject (), modern applications of linear regression to large datasets present a number of new challenges. Modern applications of linear regression, such as Genome Wide Association Studies (GWAS), often consider datasets that have at least as many potential variables (or features) as there are data points (). Applying linear regression to high-dimensional datasets often involves selecting a subset of relevant features, a problem known as feature selection in the literature on statistics and machine learning (). Even for classical least-squares linear regression, it turns out that the associated feature selection problem is quite difficult (). The difficulties associated with feature selection are especially pronounced in genomics and GWAS. In general, the goal of many genomics studies is to identify a relationship between a small number of genes and a phenotype of interest, such as height or body V C The Author 2015. Published by Oxford University Press. All rights reserved. For Permissions, please email: journals.permissions@oup.com mass index (). For example, many GWAS seek to identify specific genetic mutations (called single nucleotide polymorphismsSNPs) that best explain the variation of a quantitative trait, such as height or body mass index, in a population (). Using various techniques, the trait is regressed against binary variables representing the presence or absence of the SNPs in order to find a subset of SNPs that are highly explanatory for the trait (). Although the number of individuals genotyped in such a study may be in the thousands or even tens of thousands, this pales in comparison to the number of potential SNPs which can be in the millions (). Moreover, the presence or absence of various SNPs tends to be correlated due to chromosome structure and genetic processes that induce the so-called linkage disequilibrium (). As a result, selecting the best subset of SNPs for the regression involves a search for the global minimum of a landscape that is both high dimensional (due to the large number of SNPs) and rugged (due to correlations between SNPs). The obstacles that make feature selection difficult in GWAS also occur in many other applications of linear regression to big datasets. In fact, the task of finding the optimal subset of features is proven, in general, to be NP-hard (). Therefore, it is usually computationally prohibitive to search over all possible subsets of features and one has to resort to other methods of feature selection. For example, forward (or backward) selection adds (or eliminates) one feature at a time to the regression in a greedy manner (). Alternatively, one may use heuristic methods such as Sure Independence Screening (SIS) (), which selects features independently based on their correlation with the response, or Minimum Redundancy Maximum Relevance (), which penalizes features that are correlated with each other. The most popular approaches to feature selection for linear regression, however, are penalized least-squares methods () that introduce a function that penalizes large regression coefficients. Common choices for the penalty function include an L2 penalty, called 'Ridge' regression (), and an L1 penalty, commonly referred to as LASSO regression (). Penalized methods for linear regression typically have natural interpretations as Bayesian approaches with appropriately chosen prior distributions. For example, L2 penalized regression can be derived by maximizing the posterior distribution obtained with a Gaussian prior on the regression coefficients. Similarly, L1 penalized regression can be derived by maximizing the posterior distribution obtained with a Laplace (i.e. double-exponential) prior on the regression coefficients. While penalized regression methods essentially aim to find the features that maximize a posterior distribution they do not allow one to actually compute posterior probabilities, which provide information about confidence in a Bayesian framework. Calculating these posterior probabilities generally requires Monte Carlo methods, which can be very computationally demanding in high dimensions (). Thus, in order to apply Bayesian approaches to feature selection to highdimensional problems it is necessary to develop approximate methods for computing posterior probabilities that bypass the need for extensive sampling from the posterior distribution. Inspired by the success of statistical physics approaches to hard problems in computer science () and statistics (), we study high-dimensional regression with 'strongly regularizing' prior distributions. A strongly regularizing prior distribution is one that exerts a significant influence on the posterior distribution even when the sample size goes to infinity. The definition will be made more precise later. In this strongly regularized regime, we show that the marginal posterior probabilities of feature relevance for L2 penalized regression are well-approximated by the magnetizations of an appropriately chosen Ising modela widely studied model from physics used to describe magnetic materials (). For this reason, we call our approach the Bayesian Ising Approximation (BIA) of the posterior distribution. Using the BIA, the posterior probabilities can be computed without resorting to Monte Carlo simulation using an efficient mean field approximation that facilitates the analysis of very high-dimensional datasets. We envision the BIA as part of a two-stage procedure where the BIA is applied to rapidly screen irrelevant variables, i.e. those that have low rank in posterior probability, before applying a more computationally intensive cross-validation procedure to infer the regression coefficients for the reduced feature set. This study is especially well suited to modern feature selection problems where the number of features, p, is often larger than the sample size, n. Our approach differs significantly from previous methods for feature selection. Traditionally, penalized regression and related Bayesian approaches have focused on the 'weakly regularized regime' where the effect of the prior is assumed to be negligible as the sample size tends to infinity. The underlying intuition for considering the weak-regularization regime is that as long as the prior (i.e. the penalty parameter) is strong enough to regularize the inference problem, a less influential prior distribution should be better suited for feature selection and prediction tasks because it 'allows the data to speak for themselves' (). In the machine learning literature, the penalty parameter is usually chosen using cross validation to maximize out-of-sample predictive ability (). A similar esthetic is also reflected in the abundant literature on 'objective' priors for Bayesian inference (). As expected, these weakly regularizing approaches perform well when the sample size exceeds the number of features n ) p. However, very strong priors may be required for high-dimensional inference where the number of features can greatly exceed the sample size p ) n. Our BIA approach exploits the large penalty parameter in this strongly regularized regime to efficiently calculate marginal posterior probabilities using methods from statistical physics. The article is organized as follows: in Section 2.1, we review Bayesian linear regression; in Section 2.2, we derive the BIA using a series expansion of the posterior distribution and describe the associated algorithm for variable selection; and in Section 3.1, we present analytical results and simulations on the performance of the BIA using features with a constant correlation, in Section 3.2 we analyze a real dataset for predicting bodyfat percentage from 12 different body measurements and in Section 3.3 we analyze a real dataset for predicting a quantitative phenotypic trait from data on the expression of 28 395 genes in soybeans.
Methods
Bayesian linear regressionIn this section, we briefly review the necessary aspects of Bayesian linear regression. This entire section follows standard arguments, the details of which can be found in many textbooks on Bayesian statistics (see e.g. O'). The goal of linear regression is to infer the set of coefficients b j for j  1;. .. ; p that describe the relationship y  x T b  g from n observations y i ; x i  for i  1;. .. ; n. Here, x is a (p  1 vector of features and g $ N 0; r 2  is a Gaussian distributed random variable with unknown variance r 2. Without loss of generality, we will assume throughout this article that the data are standardized withj  n so that it is not necessary to include an intercept term in the regression. Penalized least-squares methods estimate the regression coefficients by minimizing a convex objective function in the form of:where f b is a function that penalizes large regression coefficients and k is the strength of the penalty. Common choices for the penalty function include f b  X j b 2 j for L2 penalized or 'Ridge' regression (), and f b  X j jb j j for L1 penalized or LASSO regression (). The standard least-squares (and maximum likelihood) estimate ^ b  X T X 1 X T y is recovered by setting k  0, where X is the n  p design matrix with columns x i. Adding a penalty to the least-squares objective function mitigates instability that results from computing the inverse of the X T X matrix. In the case of the L1 penalty, many of the regression coefficients end up being shrunk exactly to 0 resulting in a type of automatic feature selection (). Bayesian methods combine the information from the data, described by the likelihood function, with a priori knowledge, described by a prior distribution, to construct a posterior distribution that describes one's knowledge about the parameters after observing the data. In the case of linear regression, the likelihood function is a GaussianIn this work, we will use standard conjugate prior distributions for b and r 2 given byPb; r 2 js  Pr 2 Pbjr 2 ; swhereThese distributions were chosen because they ensure that the posterior distribution can be obtained in closed-form (O'). Here, we have introduced a vector (s) of indicator variables so that b j  0 if s j  1 and b j 6  0 if s j  1. We also have to specify a prior for the indicator variables, which we will set to a flat prior Ps / 1 for simplicity. In principle, a 0 , b 0 and the penalty parameter on the regression coefficients, k, are free parameters that must be specified ahead of time to reflect our prior knowledge. We will discuss these parameters in the following section. We have set up the problem so that identifying which features are relevant is equivalent to identifying those features for which s j  1. Therefore, we need to compute the posterior distribution for s, which can be determined from Bayes' theorem:where C is a constant and E s k is the sum of the squared residual errors. In this expression, q  X j 1  s j =2 is the number of variables with s j  1, I is the q  q identity matrix and X s is a n  q restricted design matrix which only contains columns corresponding to features where s j  1. The sum of the squared residual errors is given by E s k  y T y  y T X s b s k, where b s k  kI  X T s X s  1 X T s y is the Bayesian estimate for the regression coefficients corresponding to those variables for which s j  1.
The Ising approximation
Strongly regularized expansionIn principle, one can directly use Equation (2) to estimate the relevance of each feature using two different approaches. First, we could find the s that maximizes the posterior probability distribution. Alternatively, we could compute the marginal probabilities of feature relevance, P k s j  1jy  1  hs j i=2, where hs j i is the expectation value of s j with respect to the posterior distribution, and select the features with the largest P k s j  1jy. In the Bayesian setting, these two point estimates result from the use of different utility functions (). Here, we will focus on computing the latter, i.e., the expected value of s. The expectation values cannot be evaluated analytically due to the cumbersome restriction of the design matrix to those variables for which s j  1. Moreover, although the computation of the expectation values can be performed using Monte Carlo methods (), the numerical calculations often take a long time to converge for high-dimensional inference problems. Our main resultwhich we call the BIA of the posterior distribution for feature selectionis that a second-order series expansion of Equation (2) in k 1 corresponds to an Ising model described by logP k sjy 'with an error that is O k 3 TrX T s X s  3  where Tr is the matrix trace operator and the external fields and couplings are defined asHere, rz 1 ; z 2  is the Pearson correlation coefficient between variables z 1 and z 2. In writing this expression, we have assumed that the hyperparameters a 0 and b 0 are small enough to neglect, though this assumption is not necessary. A detailed derivation of this result is presented in the Supporting Information. The series expansion converges as long as k k > TrX T s X s  k  for all s and integer powers k!1, which defines the regime that we call 'strongly regularized'. Since X s is the restricted design matrix for standardized data, we can relate TrX T s X s  k  to the covariances between x j 's. In particular, Gershgorin's Circle Theorem () implies that the series will converge as long as k > n1  pr~ where r~jrX i ; X j j (see Supporting Information). For large p, we can replace r~ by the root-mean-squared correlation between features,This defines a natural scale k   n1  pr:for the penalty parameter at which the BIA is expected to breakdown. We expect the BIA to be accurate when k ) k  and to breakdown when k ( k . Because higher-order terms in the series can be neglected, the strongly regularized expansion allows us to remove any references to the restricted design matrix, and maps the posterior distribution to the Ising model, which has been studied extensively in the physics literature. Moreover, the magnitude of the couplings (J ij ) scales as k 1 , ensuring that the couplings are weak, which will allow us to compute posterior probabilities analytically. To perform feature selection, we are interested in computing marginal probabilities P k s j  1jy ' 1  m j k=2, where we have defined the magnetizations m j k  hs j i. While there are many techniques for calculating the magnetizations of an Ising model, we focus on the mean field approximation which leads to a self-consistent equation ():This mean field approximation provides a computationally efficient tool that approximates Bayesian feature selection for linear regression, requiring only the calculation of the Pearson correlations and solution of Equation (7).
Computing the feature selection pathAs with other approaches to penalized regression, our expressions depend on a free parameter (k) that determines the strength of the prior distribution. As it is usually difficult, in practice, to choose a specific value of k ahead of time it is often helpful to compute the feature selection path; i.e. to compute m j k over a wide range of k's. Indeed, computing the variable selection path is a common practice when applying other feature selection techniques such as LASSO regression. To obtain the mean field variable selection path as a function of  1=k, we notice that lim !0 m j   0 and so define the recursive formulawith a small step size d ( 1=k   n 1 1  pr 1. We have set d  0:05=k  in all of the examples presented below. We note that our implementation of the BIA is an example of homotopy algorithm and could potentially be improved by applying more advanced methods ().
RemarksThe BIA provides a computationally efficient framework to calculate posterior probabilities of feature relevance as a function of k without Monte Carlo simulations. We have used a simple, unoptimized C implementation of the BIA method. Using this code, computing the entire feature selection path for a genomics dataset with almost 30 000 features took $15 min on a desktop computer with 24 GB of RAM and two 2.4 GHz 6-core Intel Xeon processors. The bulk of the computational effortin terms of both processing power and memory usageis expended computing the p  p correlation matrix. For example, computing the feature selection path for the genomics dataset with our naive implementation required $15 GB of RAM. However, any method designed for efficiently computing large correlation matrices could be applied to improve the computational performance of the BIA. For example, adaptive thresholding estimators could be used to obtain a sparse correlation matrix that requires less memory (). In any case, we have left the optimization of the code for future research. To first order in  k 1 , the posterior distribution corresponds to an Ising model with fields and couplings given by h i  r 2 y; x i  1=n and J ij  0. That is, the indicator variables representing feature relevance are independent, and the probability that a feature is relevant is only a function of its squared correlation with the response. Specifically, m j k!0 if jry; x j j > 1= ffiffiffi n p and m j k 0 if jry; x j j < 1= ffiffiffi n p. Therefore, the BIA demonstrates that methods that rank features by their squared correlation with the response, such as SIS (), are actually performing a first-order approximation to Bayesian feature selection in the strongly regularized limit. The couplings between the spin variables representing feature relevance enter into the BIA with the second-order term in  k 1. A positive coupling between spins i and j favors models that include both features i and j, whereas a negative coupling favors models that include one feature or the other, but not both. In general, the coupling terms are negative for highly correlated variables which minimizes the redundancy of the feature set.
ExamplesWe have chosen three examples to illustrate different characteristics of the BIA for Bayesian feature selection. (A) First, we consider regression problems with p features that have a constant correlation r. We present some simple analytic expressions in the large p limit that illustrates how different aspects of the problem affect feature selection performance, and study some simulated data. (B) Next, we analyze a dataset on the prediction of bodyfat percentage from various body measurements. The number of features (p  12) is small enough that we can compute the exact posterior probabilities and, therefore, directly assess the accuracy of the BIA for these data. (C) Finally, we demonstrate the applicability of the BIA for feature selection on high-dimensional regression problems by examining a dataset relating the expression of p  28 395 genes to the susceptibility of soybean plants to a pathogen.
Features with a constant correlationCorrelations between features are detrimental to feature selection. For example, suppose that we observe a response variable y given by y  bx 1  g. A second feature x 2 that is strongly correlated with x 1 will also be correlated with y. Thus, identifying which feature, x 1 or x 2 , is the relevant one is not an easy task. Of course, the reasoning becomes more complicated in high dimensions, but similar effects are observed in high-dimensional regression with the LASSO (). Given these observations, we use this section to analyze a simple model of BIA feature selection that allows us to examine many of the characteristics that influence feature selection performance. Specifically, we consider a simple, analytically tractable, model in which we are given p features that are correlated with each other with a constant Pearson correlation coefficient, r. The response, y~, is a linear function of the first p~ p variables, which have equal true regression coefficients b j  b for j p~. That is, y~ b X jp~ j1 x j g~ where g~$ N 0; r~ 2  is a Gaussian noise. We are interested in studying the behavior of this model when the number of features is large (p ) 1). To simplify analytic expressions, it is helpful to define the number of samples as n  hp, and the number of relevant features as p~ /p. Furthermore, we assume that the correlation between features scales as r  ap 1 so that the correlation between y and x j stays constant in the large p limit.presents an example feature selection path computed using the BIA for a simulation of this model. This variable selection path was generated for data simulated from a linear model using p  200 features with a constant correlation r  2=p, n  100, p~ 10 and x 2  r~ 2 =b 2  1.demonstrates that all but one of the relevant features (red) have higher posterior probabilities than the irrelevant features (black) as long as k > k . In fact, there is a clear gap in posterior probability separating the relevant and irrelevant features, and the correct features can be easily selected by visible inspection of the feature selection path in. The BIA breaks down beyond the threshold of the penalty parameter and the feature selection performance of the BIA deteriorates, as demonstrated by the mixing of the probabilities for the relevant (red lines) and irrelevant (black lines) features in. The indicator variables characterizing the feature selection problem can be divided into two groups: relevant features with j p~ and magnetization m  , and irrelevant features with j > p~ and magnetization m . Note that an algorithm that performs perfect variable selection will have m   1 and m   1. The Pearson correlation coefficient of a relevant feature (j p~) with the standardized response y  y~= ffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffi VARy~ p is given bywhere x 2  r~ 2 =b 2 $ O1 is an inverse signal-to-noise ratio. Similarly, the Pearson correlation coefficient of an irrelevant variable (j > p~) with the standardized response isNote that correlations make this problem incredibly difficult when the number of true features is large, i.e. r  =r  ! 1 as p~! 1 for r > 0. If we choose k  hp 2 to ensure that the problem is always in the strongly regularized regime, the magnetizations can be computed explicitly to order 1=p givingIn general, we say that feature selection performance is good, on average, as long as m  < 0 < m  , because relevant features have Ps j  1jy > 1=2 and irrelevant features have Ps j  1jy < 1=2.shows that the average feature selection performance is good in this sense within a large volume of the phase space. Specifically,However, m  < m  even if the stronger statement m  < 0 < m  is not satisfied. As a result, there is always a gap between the posterior probabilities of the relevant and irrelevant features. Nevertheless, the gap between the relevant and irrelevant features shrinks with increasing correlations, suggesting that feature selection performance will be strongly affected by sample-to-sample fluctuations, which we have neglected here.
Bodyfat percentageBodyfat percentage is an important indicator of health, but obtaining accurate estimates of bodyfat percentage is challenging. For example, underwater weighing is one of the most accurate methods for measuring bodyfat percentage but it requires special equipment, e.g. a pool. Here, we analyze a well-known dataset obtained from StatLib (http://lib.stat.cmu.edu/datasets/) on the relationship between bodyfat percentage and various body measurements from n  252 men (). The p  12 features included in our regression are age and body mass index (height=mass 2 ), as well as circumference measurements of the neck, chest, waist, hip, thigh, knee, ankle, upper arm, forearm and wrist. All of the data were standardized to have mean 0 and variance 1. Therefore, there are 2 12  4096 potential combinations of features. For our purposes, the most interesting part about the bodyfat dataset is that the number of features is small enough to compute the posterior probabilities exactly using Equation (2) by enumerating all of the 4096 feature combinations. The exact posterior probabilities as a function of k 1 are shown in.The posterior probabilities computed from recursive solution of the BIA are shown inwithdemonstrates that the posterior probabilities computed from the BIA are very accurate for k ) k  , with k   n1  pr and r the root-mean-squared correlation between features. However, the approximation breaks down for k ( k  as expected.provides another representation of the breakdown of the BIA upon approaching the breakdown point of the penalty (k  ). The root-mean-squared error given by RMSE k  ffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffimoidal, with an inflection point close to k . In the strongly regularized regime with k ) k  , the exact Bayesian probabilities and those computed using the BIA both rank waist and chest circumference as the most relevant features. Below the breakdown point of the penalty parameter, however, the BIA suggests solutions that are too sparse. That is, it underestimates many of the posterior probabilities describing whether or not the features are relevant. Far below the breakdown point of the penalty parameter (beyond the range of the graph in), the BIA ranks age and body mass index as the most relevant variables even thoughwhere m  < 0 < m  computed with k  hp 2 these have some of the smallest correlations with the response. Age and body mass index also become increasingly important for small k's in the exact calculation; though, they are never ranked as the most relevant variables. The change in the rankings of the features as a function of k highlights the importance of the coupling terms (J ij k) that punish correlated features.
Gene expressionIn 2010, the Dialogue for Reverse Engineering Assessments and Methods (DREAM) () initiative issued a challenge to predict the response of soybean plants to a pathogen from data on gene expression (). These DREAM5 training data consist of a response of n  200 different soybean plants to a pathogen (specifically, the response is a measure of the amount of pathogen in an infected tissue sample) along with the expressions of p  28 395 genes. The team () that achieved the highest rank correlation on a blind test set of 30 other soybean plants trained their model using elastic net regression to predict the ranks of the responses in the training set. The ranks were used rather than the actual values of the responses to mitigate the effects of outliers, and the value of the penalty parameter was chosen using cross validation.found that their cross-validation procedure for elastic net regression favored sparse models with only a few features, and they highlighted 12 of these features that were frequently chosen by their procedure. However, even the best teams achieved only modest performance on the test data (). Nevertheless, the soybean gene expression dataset presents a good benchmark to compare Bayesian feature selection with the BIA to feature selection using cross-validated penalized regression for a very high-dimensional inference problem. We used the BIA to compute the posterior probabilities for all p  28 395 features as a function of k 1 using the ranks of the responses of the soybean plants to the pathogen as our y variable. As before, all of the data were standardized to have mean 0 and variance 1.compares the posterior probabilities of the 12 features highlighted by(red lines) to the distribution of posterior probabilities for all of the features (gray area). Visual inspection ofsuggests that the 12 features identified byhave some of the highest posterior probabilities among all 28 395 features. Similarly,shows that only a small percentage of features have higher posterior probabilities than those identified by, demonstrating that there is generally a pretty good agreement between features that are predictive (i.e. those that perform well in cross validation) and those with high posterior probabilities computed with the BIA. Although our analyses of the soybean gene expression data identify similar features as cross-validated elastic net regression, the posterior probabilities all fall in the range P k s j jy  1=260:001. The small range of posterior probabilities around the value representing random chance (P k s j jy  1=2) is consistent with the highly variable out-of-sample performance discussed by. One reason for the generally poor performance of feature selection on these data, aside from the underdetermined nature of the problem, is that the expressions of the genes are significantly correlated (r % 0:29). To demonstrate this, we constructed synthetic datasets with varying numbers of relevant and irrelevant genes and computed the rate at which true features were identified by the BIA (and Supporting Information). Like the original data, these synthetic datasets each contained n  200 distinct samples. The true positive rate (or sensitivity) was defined as the fraction of true features among the q features with the highest BIA posterior probabilities at k  0:5k . Comparing the true positive rates of BIA feature selection on synthetic data using genes with a strong correlation (r % 0:28,) and synthetic data with a weak correlation obtained by randomly shuffling the genes (r % 0:07,) clearly demonstrates the dramatic effect that interfeature correlations have on feature selection performance. This highlights the importance of strong
DiscussionTo summarize, we have shown that Bayesian feature selection for L2 penalized regression, in the strongly regularized regime, corresponds to an Ising model, which we call the BIA. Mapping the posterior distribution to an Ising model that has simple expressions for the local fields and couplings using a controlled approximation opens the door to analytical studies of Bayesian feature selection using the vast number of techniques developed in physics for studying the Ising model. It will be interesting to see if our analyses can be generalized to study Bayesian feature selection for many statistical techniques other than linear regression, as well as other prior distributions. From a practical standpoint, the BIA provides an algorithm to efficiently compute Bayesian feature selection paths for L2 penalized regression. Using our approach, it is possible to compute posterior probabilities of feature relevance for very high-dimensional datasets such as those typically found in genomic studies. Unlike most previous work of feature selection, the BIA is ideally suited for large genomic datasets where the number of features can be much greater than the sample size, p ) n. The underlying reason for this is that we work in strongly regularized regime where the prior always has a large influence on the posterior probabilities. This is in contrast to previous works on penalized regression and related Bayesian approaches that have focused on the 'weakly regularized regime' where the effect of the prior is assumed to be small. Moreover, we have identified a sharp threshold for the regularization parameter k   n1  pr where the BIA is expected to break down. This threshold depends on the sample size, n, number of features, p, and root-mean-squared correlation between features, r. The threshold at which the BIA breaks down occurs precisely at the transition from the strongly regularized to the weakly regularized regimes where the prior and the likelihood have a comparable influence on the posterior distribution. This study also highlights the importance of accounting for correlations between features when assessing statistical significance in large datasets. When the number of features is large, even small correlations can cause a huge reduction in the posterior probabilities of features. For example, our analysis of a dataset including the expression of 28 395 genes demonstrates that the resulting posterior probabilities of gene relevance may be very close to value representing random chance P k s j jy  1=2 when p ) n and the genes are moderately correlated, e.g. r % 0:29. This is likely to have important implications for assessing the results of GWAS studies where such correlations are often ignored. Moreover, we suggest that it is generally not reasonable to choose a posterior probability threshold for judging significance on very high-dimensional problems. Instead, the BIA can be used as part of a two-stage procedure, where the BIA is applied to rapidly screen irrelevant variables, i.e. those that have low rank in posterior probability, before applying a more computationally intensive crossvalidation procedure to infer the regression coefficients. The computational efficiency of the BIA and the existence of a natural threshold for the penalty parameter where the BIA works make this procedure ideally suited for such two-stage procedures.. True positive rates for feature selection with (a) correlated and (b) uncorrelated genes. Features were selected by taking the q genes with highest posterior probability at k  0:5k . The uncorrelated genes were created by randomly shuffling the correlated genes. The root mean squared correlation among the correlated genes was r  0.28 compared with r  0.7 for the uncorrelated genes
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
C.K.Fisher and P.Mehta at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
