We describe a tool for quantifying the uniformity of mapped reads in high-throughput sequencing experiments. Our statistic directly measures the uniformity of both read position and fragment length, and we explain how to compute a P-value that can be used to quantify biases arising from experimental protocols and mapping procedures. Our method is useful for comparing different protocols in experiments such as RNA-Seq. Availability and implementation: We provide a freely available and open source python script that can be used to analyze raw read data or reads mapped to transcripts in BAM format at
INTRODUCTIONIn biological experiments, controlling the quality of data is fundamental to the reliability and reproducibility of the results. Quality control is especially important in modern sequencing experiments, where small biases in the preparation of DNA libraries can be amplified in the subsequent sequencing steps which typically yield millions of reads. Sequenced reads ideally represent fragments sampled uniformly at random from a library, and expected coverage statistics can be obtained from the classic LanderWaterman model Lander and. However, a key aspect of current experiments is variable fragment length, requiring the extension of the Lander Waterman model to account for random fragment position as well as length. Such a generalization was described inwhere it was shown that the data from a sequencing experiment can be modeled by a two-dimensional spatial Poisson process. We present a statistical test for uniformity in the reads of a sequencing experiment based on this idea and show how it can be used to compare multiple sets of reads in order to assess different protocols. Our test requires the alignment of paired-end reads to a reference transcriptome so that fragment positions and lengths can be determined. Fortunately, such alignments are routinely produced after sequencing experiments, so that our test can easily be incorporated into sequencing analysis pipelines.
METHODSAn aligned read can be represented as an integer point in R 2 as follows: The 't-coordinate' corresponding to the read is its left-end point while the 'l-coordinate' is the length of the fragment. In, it is shown that for any choice of fragment length distribution, the collection of points f(t, l)} from a sequencing experiment forms a two-dimensional Poisson process. This principle guides our further analysis of these points f(t, l)}, as we test for uniformity in both the t and l coordinates. The output of ReadSpy is a list of test statistics and P-values for each transcript. A statistically significant (low) P-value means we reject the fact that the dataset is uniform on that transcript. Thus, a higher P-value corresponds to a set of reads sampled uniformly, which is desired. In the next two sections, we describe the statistical test applied a each transcript. The test is formulated in terms of the genomic segment. We handle ambiguous reads in ReadSpy by first reporting all possible alignments, using eXpress Roberts and Pachter (Submitted for publication) (http://bio.math.berkeley.edu/eXpress/) to assign a probability to each alignment and then selecting one t-value per fragment according to the observed probabilities.
Hypothesis test for datasetFirst, we describe the statistical test for a set of aligned reads from one sequencing experiment. The (t, l) coordinates corresponding to reads aligned tosatisfy t ! a and t  l b:We define shifted coordinates in the (x, y)-plane as follows:The new point set S of transformed datapoints satisfies x 2 0; 1; y 2 0; 1 and is still homogeneous along the x-axis. We use a simple 2 statistic to test this partial homogeneity assumption using test constants C and D. First, we partition the points into horizontal stripswhere 1  b 0 5b 1 5b 2 5.. .5b m  1 and the boundaries b k are chosen such that each jH k j ! C. Next, we ignore the y-coordinates within each strip and test the uniformity of the x coordinates. We divide the intervalinto D subintervals and define O kj  jfx; y 2 H k jj  1=D5x j=Dgj:If the original point set forms a spatial Poisson process, then*To whom correspondence should be addressed.where E k  jHkj D. Since all T k s come from mutually independent strips, we haveThis allows us to calculate a P-value for the collection of aligned reads. This value may vary depending on the choice of constants C and Da reasonable choice seems to be C  200 and D  20.shows the aligned reads for two yeast genes both in the (t, l)-plane and the (x,
Comparing multiple datasetsAssume we want to compare multiple sets of reads aligned to the same genomic interval. Since the P-value of the above test depends on how the plane is divided into strips, the boundaries b k are chosen to be the same across all the transformed point sets S i ; i  1;. .. ; n. We impose the requirement that for each point set S i , the horizontal strip H k i contains at least C points. The resulting H k is are then subsampled to produce H 0 k i such that for all i, we have jH 0 k ij  min j1;...;n jH k jj:We then apply our statistical test to each point set S i using the horizontal strips H 0 k i with vertical subdivisions given by the constant D as above.
RESULTSWe applied our statistical test to examine a variety of popular RNA-Seq protocols. Using data analyzed in, we compare seven paired-end methods on 1464 transcripts in the yeast genome. Supplementarygives transcriptby-transcript summary statistics for the log probabilities. There are multiple criteria for selecting an RNA-Seq protocal, but using ReadSpy we find that the dUTP protocol is statistically most randommeaning least biasedwhich agrees with. Additionally, we make pairwise comparisons between the methods, which can be found in Supplementary Table S2. For each pair, the binomial test addresses statistically whether or not one method 'wins' on more often than the other. The P-values for this test are also listed in Supplementary Table S2. Our findings mostly agree with the results of; however, our method illustrates the variability in sequence uniformity among genes. For instance,gives the point sets for dUTP protocol and two yeast genes: YDR007W (in A) and YJL078C (in B). When comparing all seven methods, dUTP achieved p  1:2e  19 for YJL140W and p  .27 for YKL041W. A low P-value indicates that the reads aligning to the transcript are not uniform, which is undesirable. One can visually see the difference inbetween non-random (in A) and random (in B).
The Author 2012. Published by Oxford University Press on behalf of The Society for Financial Studies. All rights reserved. For Permissions, please e-mail: journals.permissions.com. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
