Motivation: Epigenetic landscapes in the regulatory regions reflect binding condition of transcription factors and their co-factors. Identifying epigenetic condition and its variation is important in understanding condition-specific gene regulation. Computational approaches to explore complex multi-dimensional landscapes are needed. Results: To study epigenomic condition for gene regulation, we developed a method, AWNFR, to classify epigenomic landscapes based on the detected epigenomic landscapes. Assuming mixture of Gaussians for a nucleosome, the proposed method captures the shape of histone modification and identifies potential regulatory regions in the wavelet domain. For accuracy estimation as well as enhanced computational speed, we developed a novel algorithm based on down-sampling operation and footprint in wavelet. We showed the algorithmic advantages of AWNFR using the simulated data. AWNFR identified regulatory regions more effectively and accurately than the previous approaches with the epigenome data in mouse embryonic stem cells and human lung fibroblast cells (IMR90). Based on the detected epige-nomic landscapes, AWNFR classified epigenomic status and studied epigenomic codes. We studied co-occurring histone marks and showed that AWNFR captures the epigenomic variation across time. Availability and implementation: The source code and supplemental document of AWNFR are available at
INTRODUCTIONThe epigenetic landscapes, represented by modifications to histones, DNA methylation and other proteins that package the genome, regulate the function of cells by activating or repressing gene activity (). The epigenetic landscapes drawn over the genome reflect the commitment of cells to a lineage and/or response to the environmental changes (). Histone codes representing combinatorial effects of histone modification tell how transcriptional apparatuses are used in a given cell-type/environment. At active promoters, active marks, including mono-, di-and tri-methylation of Lys4 of H3 (H3K4me1/2/3), showed strong signals. Chromatin marks at the enhancers showed strong H3K4me1 and weak H3K4me3 (). Histone acetylations are enriched both at active promoter and enhancer (). Epigenetic variations reflected condition-specific binding of transcription factors (TFs) (). Therefore, identifying epigenomic condition in regulatory regions is important to understand condition-specific gene regulation. Algorithmic development to exploit epigenomic landscapes is required for systematic analysis of cell-type specific gene regulation. Here, we present a method that explores multi-dimensional epigenomic landscapes using the wavelet transforms (WTs). Wavelet compromises between time-and frequency-based views of signal. Because of its property, wavelet has been widely used in signal and image processing (). In genome-wide study, wavelet has been applied to analyzing DNA replication profile (), studying admixed population () and analyzing protein or microarray data (). Also, wavelet has been also applied for epigenomic data analysis (). We applied wavelet to idntify nucleosome, given the multi-dimensional histone modification data. For accurate and fast performance, we applied down-sampling WT and wavelet footprint in modeling nucleosome. AWNFR identifies the position and the shape of nucleosomes after modeling a nucleosome with mixture of Gaussians (MoGs). The gapped region between two identified nucleosomes is defined as a nucleosome free region (NFR). Using the shape of histone modification captured in the WD, we classified NFRs based on the epigenomic landscapes and interrogated the combination of histone modification marks. Previously, a number of algorithms were suggested to detect NFRs from histone modification data. A method named nucleosome positioning from sequencing (NPS) was designed to predict nucleosome position (). NPS used WT for denoising signal after modeling a nucleosome with Laplacian of Gaussian. Homer package () is equipped with a function to predict NFRs. NOrMAL uses Gaussian mixture model to identify nucleosome position (). However, these frameworks only allow one mark for the input and cannot be applied to detecting comprehensive epigenetic variation or code. An HMM-based approach, called Chromia, predicted regulatory regions using epigenome data (*To whom correspondence should be addressed.
2008). However, it requires carefully selected training set. Compared with supervised methods (), AWNFR uses an unsupervised method to exploit epigenomic landscapes. More importantly, AWNFR is capable of detecting epigenetic codes and their variations from the identified NFRs. Using simulated data, we showed the advantages of new peak and edge detection algorithms which are used in our method. We applied AWNFR to the epigenomic data in mouse embryonic stem cells (mESC) and IMR90 and showed the outperforming performance over the previous approaches in detecting potential regulatory regions. Also, we show that AWNFR can study the epigenetic variations using the histone modification data during adipogenesis ().
METHODSTo detect the epigenetic variation and its code, we developed a waveletbased method called AWNFR. AWNFR is composed of three steps. Step1: Detecting enriched regions (Section 2.1)Haar wavelet moving (HWM) is implemented to identify enriched region with activating histone marks (active regions) by scanning the genome across multiple histone marks.Step 2: Identifying nucleosome positions (Section 2.2)After assuming MoGs for a nucleosome, we identified the parameters of MoGs using zero-crossing. NFRs are defined as the region between two imaginary MoGs.Step 3: Clustering NFRs (Section 2.3) A clustering method was applied to the identified NFRs to study the combination of epigenetic marks.
AWNFR detects epigenomic enriched regionsWe developed a shift-invariant and down-sampling method called HWM. In WT, shift variance has been a major problem (). Lack of shift invariance can cause major variation in the output by small shifts in the input signal. Several methods such as stationary WT and dual tree complex wavelet transform (DT-CWT) were suggested to overcome shift variance, but at the cost of computation time () (see Supplementary Documents for more detail about the previous WTs). To deal with large-scale data efficiently, we developed HWM, a shift invariant and down-sampling wavelet-based method. An approximate scale, representing the low frequency (L) of the signal after WT, can be represented as y i app  ::x  g 1L   g 2L   :::::  g iL ,Where  denotes a convolution operation, and x is an input signal or histone modification data with a length N. g iL is the low pass filters at level i. Applying down-sampling, we get y i app  :::x  g 1L  # 2  g 2L # 2  :::  g iL  # 2,where # 2 is the down-sampling operation. Using Haar WT, g iL can be written as g iL). Then, at a level l,where, n is the index of the output. Derived from Haar WT, Equation (1) is called HWM because of its similarity with the moving average algorithm. At level l, the genomic position is thenwhere p x is genomic position of x, and n m is the position at maxima of xk with 2 1 n  1  15k52 1 n. The wavelet level l then can be estimated 1  log 2 bs n =bs o , 3 where bs o is the size of a bin of the data and bs n is the new bin size. To handle multiple marks, we stacked the genomic data. We applied HWM across the genome (HWM1d) and the stacked histone modification data (HWM2d). We denoted that n histone marks are represented as X  (x 1 ,. .. ,x n ). HWM2d is then represented by the series of HWM1d.Y h  y 1 y 2 :::y n   HWM1dX  HWM1dx 1 x 2 :::x n   4 Appling HWM1d to the transposed matrix of y h , we get Y v  HWM1dY T h   HWM1dy 1 y 2 :::y n  T , 5 where T is the transpose of a matrix. h and v were used for horizontal row and vertical column.demonstrates how AWNFR detects active regions using 18 histone modification marks and 3 DNaseI hypersensitivity data in IMR90 () (Supplementarylists the marks we used). The epigenome data () were transformed into the WD (). HWM2d found four peaks that correspond to four active regions in Y v ().
AWNFR detects NFRs after modeling a nucleosome with MoGsAWNFR detects the shape of histone modifications and the position of nucleosomes. This is an important step for the subsequence procedure of exploiting epigenetic landscapes and classifying regulatory regions. Previously, Laplacian of Gaussian was used to model a nucleosome (). However, diverse histone modification patterns are observed in the genome. We used MoG as it can model more general signal than Laplacian of Gaussian. Because any signal can be represented as a sum of multiple Gaussians (), we used MoG to model a nucleosome. To detect the parameters of MoG, AWNFR used zerocrossing, which was successfully applied for parameter estimation using continuous wavelet transform (CWT) (). Zerocrossing is a method to identify wavelet footprint that captures the) (See Supplementary text for detail). In this article, zero-crossing of the derivatives of Gaussians was applied for parameter identification. Assuming MoG for a nucleosome, we getwhere 1 and i are the center and the standard deviation of a nucleosome. AWNFR uses the zero-crossing lines across wavelet scales. A zerocrossing is a point where the sign of a function changes. A zero-crossing line is obtained by connecting the zero-crossing points obtained over the wavelet scales. CWT converts signals to the WD using a convolution operator.where s denotes a wavelet scale, u is a position in the genome and: Let WFw, s,F i w and e w be the fast Fourier transform (FFT) of Wfu, s, f i t and e  s t, respectively.where F  denotes the inverse FFT (iFFT). Instead of using convolution, we use FFT (F ) and iFFT (F  ) to estimate the wavelet coefficients (Wfu, s)The peaks and the edges of the MoGs can be obtained by taking derivativeWhere  is a gamma function (), and n is the order of derivative of the Gaussian wavelet. Replacing e  and F from Equations (10)and (9) to Equation (8), we getWFw, s  jw n 1 ffiffiffiffiffi ffin  1, 2, 3 correspond to each order of derivative.The parameters of the Gaussian for each derivative can be obtained using Wfu 0 , s, 1  0, we have u 0  i ; 16 Wfu 0 , s, 2  0, we haveWfu 0 , s, 3  0, we have u 0  i or 0  i AE ffiffi ffiWe call the first, the second and the third derivative of Gaussian wavelet as DOG1, DOG2 and DOG3, respectively. They are selectively used to estimate the position, the height and the standard deviation of Gaussians. Supplementary Table S2 and the Supplementary document summarize how the parameters of MoGs were calculated using each derivative. In conclusion, AWNFR selected DOG1 to calculate the peak and the height and DOG2 to obatin standard deviation of MoGs because they showed the best estimation performance in the simulation using artifical histone modification data (See Section 3.2). To summarize,Figure 2 demonstrates how NFRs are detected in the wavelet domain (WD) using the zero-crossing lines in the WD. After the conversion into the WD, DOG1 (upper panel) and DOG2 (lower panel) are applied to obtain zero-crossing lines, respectively. DOG1 is applied to detect the peak positions, and DOG2 is applied to detect the standard deviation of the Gaussians.
Clustering epigenetic patternsNFRs provide access to sequence specific TFs and basal transcription machinery (). Identifying epigenomic landscapes around NFRs is important to understand the epigenetic condition for gene regulation. We defined an NFR as the gapped region between the two estimated nucleosomes. We clustered NFRs using K-means algorithm based on the epigenomic conditions (binding score) around them. For n data (x 1 ,. .. , x n ), HWM2d detects active regions and the strongest marks among them. The binding scores are calculated as follows using the strongest mark. From, the height of the left and the right peak of sample x j at the enriched region number i is A j i left peak  x j  i left peak  b 23 A j i right peak  x j  i right peak  b 24. Therefore, the number of output cluster is equal or smaller than the number of the cluster given initially. Using the clustering results, we identified epigenomic codes and variations.
RESULTSTo show the algorithmic advantages of AWNFR, we evaluated the performance of HWM in both parameter estimation and NFR detection. First, we compared HWM with DWT and DT-CWT () for enriched region detection. Also, we compared DOG1/2/3 with other competitors such as Gass1/2/3 (), NPS () and Canny () for the parameter estimation of MoGs. For real data, we compared the performance using histone modifications in mESC and IMR90. Supplementarysummarizes the data we used to predict NFRs.
Assessment of HWM in detecting enriched regionsWe compared the performance of HWM with DWT and DT-CWT () using a simulating model. For the simulation, we used f s t  sinwt f o t  N , whereis the middle position of an active region, and 2 i is the width of the active region. We assume that i follows a uniform distribution, and N is Poisson noise. We evaluated each algorithm by calculating the CC between f o t and the estimated model. We also calculated running time (RT) of 100 independent tests (). The simulation showed that that CC of HWM is significantly better than DTW-CWT and DWT. Notably, HWM implemented 44 and 8 times faster than DWT and DT-CWT, respectively. This demonstrates that HWM is an accurate and effective way to identify enriched regions.
Assessment of parameter estimation algorithmTo assess the MoG parameter estimation, we again used a simulation model. ft  10e t5=20:5 2   5  N 27 For N, we used Gaussian noise N  g  0,  1, ) as well as Poisson noiseBesides DOG1/2/3, we compared Gauss1/2/3 (), NPS () and Canny (). Among them, NPS () is a method designed to identify nucleosome positions.compares the averaged error rates of peak position and standard deviation estimation. DOG1 performed best in peak detection. We did not include NPS and Canny, as they are not designed to detect peak position. For standard deviation, DOG2 outperformed other methods. Using the same model, we also evaluate the performance in estimating the peak height. In this test, Gaus1 and DOG1 performed better than other methods (). The performance of NPS was worse than DOG2/3. This is possibly because DOG2/3 uses MoGs that is more general function than Laplacian of Gaussian that NPS uses. Based on the results shown in Tables 2 and 3, AWNFR chose DOG1 for peak and height and DOG2 for standard deviation estimation.
AWNFR identifies regulatory regions accuratelyCapturing the shape of histone modification around NFRs, AWNFR has a function to predict potential regulatory regions. To assess the performance in identifying NFRs, we compared the performance of AWNFR with Chromia (), Homer () and NPS (). First, we compared the performance after detecting NFRs using H3K4me1/2/3 in mESC (). For this test, we used the binding sites of 13 TFs as a measure to assess the prediction (Supplementary). We defined a prediction as a true positive (TP) if a prediction is within 1 kb of a TF binding site (TFBS). We calculated true predicative rate against false predicative rate while changing the threshold for the binding score. We evaluated the performance of AWNFR using a single mark (AWNFR4s) as well as multiple marks (AWNFR4m). Chromia was trained using the same set of histone marks (H3K4me1/2/3) using active promoter and enhancer. To obtain active promoter, we used the top 200 genes based on gene expression. To obtain the training set for enhancer, we used distal TFBSs in chromosome 1. AWNFR4s using H3K4me3 outperformed Homer and Chromia. AWNFR4s showed comparable results with NPS. Using multiple histone modification marks, AWNFR4m outperformed all other predictors (). As an additional test, we predicted NFRs using 18 marks in IMR90 () (Supplementary). To evaluate the performance, we used DNaseI hypersensitive sites (DHSs) (). For a single mark, we used H3K4me3. Compared with NPS, AWNFR4s showed higher true predicative rate when false predicative rate 50.02 (). Homer predicted NFRs only when the nucleosomes around them are clearly observed and made only limited number of predictions. The HMM-based method (Chromia) was trained using the epigenome data at active promoter (top 200) and distalDHS in chromosome 1. Using multiple histone modification marks as well as a supervised learning approach, Chromia performed much better than NPS or Homer. AWNFR4m outperformed Chromia when they used the same datasets, even though AWNFR4s uses an unsupervised learning approach. NPS showed comparable performance with AWNFR4m when using a single mark. NPS was developed based on Laplacian of Gaussian as a single filter to identify nucleosome positions (). Compared with NPS, AWNFR used multiple wavelet scales. Supplementaryshows an example that compared the results of AWNFR and NPS. Three peaks of H3K4me3 formed two valleys. Although NPS identified one NFR, AWNFR identified two NFRs correctly. The most right peak might not be modeled well with the Laplacian of Gaussian. All the NFRs identified by NPS were also predicted by AWNFR. It is also interesting that AWNFR performed better than the supervised learning method, Chromia (). Chromia used HMM to capture the characteristic patterns of histone modification data. Histone modification data are highly stochastic. Noise in the training dataset could deteriorate the performance. Training set of Chromia was collected at active promoter and potential enhancers (TFBSs in mESC, DHS in IMR90). Though Chromia can capture the profiles of histone modification, there could be some members in the training set that do not follow the average profile. Noise in the training data and the shift of the signal due to the low resolution of TFBSs could also affect the performance of Chromia. Homer uses the intensity of signal simply to predict NFRs. Though it performed worst, it runs fast, as it only applies simple enrichment calling to identify NFRs. Supplementarycompares the characteristics of the methods we tested.
Clustering using AWNFR finds diverse combinations of histone modificationApplying AWNFR, we classified the NFRs based on the combination of histone modifications.and Supplementaryshow 64 clusters when we used eight histone marks: H2BK12ac, H2BK120ac, H3K4me1/2/3, H3K18ac, H3K27ac and H4K91ac (Supplementary). The clustering results showed diverse combinations of histone modifications. For example, Groups 11 and 12 were with acetylation but without H3K4me1/3. Group 15 was with H3K27ac, H3K18ac and H3K4me2/3. Supplementarysummarizes the histone codes for each group. Expanding this research, we studied overlapping histone modifications in IMR90 (). We found H3K4me3 poorly cooccupied with H3K4me1, H2BK20ac or H2BK12ac. H2BK20ac was highly co-occupied with H2BK12ac but not with H3K4me1. It is because H2BK20ac and H2BK12ac are enriched in the promoter and the transcribed region of active genes (). Also, we observed co-enrichment of H2BK15ac with H2BK20ac and H2BK12ac. Interestingly, the same results were observed by coherent and shifted bicluster identification (CoSBI) in CD4T cells (). Contrary to the results of CoSBI, we observed a high co-occurrence of H3K4me2 with H3K18ac, H3K27ac and H3K9ac. However, our observation is supported by other genome-wide study in CD4T cells where H3K4me2 is one of the backbone histone marks along with H3K27ac and H3K9ac (). We also observed that H3K4me3 co-occurs with H3K9ac (80.9%) more frequently than any other histone acetylation marks. Though H3K27ac overlapped with both H3K4me1 and H3K4me3, its closest marks were H3K18ac (82.3%) and H4K91ac (74.9%). We systematically investigated whether a histone mark can be represented with a combination of other marks. For this, we used the union of the marks in the order of overlapping ratio (Supplementary). Both H3K14ac and H3K23ac can be represented with the combination of H4K9ac and H3K27ac 495%. For other marks, it required at least three other marks to. The performance comparison using the histone modification data (a) in mESC (b) in IMR90. We ran AWNFR for a single mark (AWNFR4s) and multiple histone modification (AWNFR4m)cover 495%. For example, six marks were needed to represent 95% of H3K4me3 (Supplementary).
Cell type specific histone codeWe compared the epigenomic code in IMR90 against H1 (human embryonic stem cells). We investigated the overlap between each histone marks (Supplementary). In general, we observed the decreased level of overlaps. This is because the small number of overlaps between histone marks at the p300 binding sites in H1. Similarly, overlaps were shown decreased at the p300 binding sites in H1 (). For example, the overlaps of H3K23ac and H3K4ac were significantly reduced at p300 binding sites, which are reflected by our observation. Interestingly, however, the random forest method did not catch it and even showed higher overlaps in H1 than in IMR90 (). The overlaps of H3K4me1 with other marks were smaller in H1 compared with IMR90, which is not surprising because H3K4me1 marks poised enhancers in ESCs (). H3K4me2, H3K9ac and H3K27ac showed strong overlapping with other histone marks in IMR90 as well as in H1.
AWNFR identifies epigenetic variationsAWNFR clusters NFRs based on the binding score. The clusters provided epigenetic codes. In the same way, we clustered H3K27ac across multiple time points during murine adipogenesis (). Instead of histone codes, it provides epigenetic variation across time. H3K27as was measured at 4 time points during white adipocyte cells differentiation: proliferating (day 2), confluent preadipocytes (day 0), immature adipocyte (day 3) and mature adipocytes in mouse (day 7) (). Investigating epigenetic variations, we identified eight clusters with distinct variations (Supplementary). For example, H3K27ac in Group 8 gradually increased, whereas Group 4 showed gradual decrease of H3K27ac during the adipogenesis. This result shows that AWNFR detects epigenetic variations across time.
DISCUSSIONSIdentifying epigenomic condition is important to understand the conditions for gene regulation. Our knowledge about the combination of histone modifications and the role for gene regulation is still limited. Computational approaches that exploit the complex landscapes and collect useful information out of them are highly in need. In this article, we presented a wavelet-based approach to explore multi-dimensional epigenomic landscapes. Using this approach, we identified nucleosome position and the epigenetic combination. Though there are several computational algorithms to predict nucleosome, our approach is uniquely designed to explore the epigenetic landscapes. Besides its outperforming performance in identifying nucleosome, we believe AWNFR suggests a new way of studying epigenetic data. One of the problems in studying large-scale multi-dimensional data is the computational cost. To deal with large amount of epigenmic data efficiently, AWNFR is equipped with down-sampling wavelet. As shown in the simulation, HWM that AWNFR uses identified enriched regions faster than previous waveletbased method with better accuracy. In the enriched regions, AWNFR explored more deeply to the landscapes by identifying nucleosome position. This framework using multiple epigenetic marks provided the condition for outperforming performance in predicting NFRs and exploring epigenetic codes. We tested the algorithmic advantages of AWNFR using simulated models as well as real data. AWNFR outperformed previous competitors () in identifying NFRs in mESC and IMR90. We also compared our histone codes with the previous predictors. Previously, Chromasig () was developed to study histone code using correlation of histone signals. ChromHMM used histone code to annotate the genome (). CoSBI exhaustively searched for histone code based on correlation within a 5 kb window (). ChromHMM also used the enriched information of histone marks rather than studying the pattern itself. More recently, a random forest based enhancer identification method from chromatin states (RFECS) was developed based on random forests (). Unique to AWNFR is the approach to study histone codes from the identified NFRs.. Overlapping analysis using 18 histone marks. Number of overlapping NFR predictions over total number of NFR predictions on the histone marks were calculated. Clustering results in IMR90. Groups 11 and 12 are with acetylation but without methylation. Group 15 is with H3K27ac, H3K18ac, H4K91ac and H3K4me2/3. Group 48 is with H3K4me2/3 but not with others. The entire groups are found at the Supplementary Document Compared with the CoSBI's results, we observed consistent (H3K4me3 partners poorly with H2BK120ac and H2BK12ac) as well as inconsistent results (a high co-occurrence of H3K4me2 with H3K18ac, H3K27ac and H3K9ac). However, our results were further supported by another genome-wide study in CD4T cells (). Using our histone codes, we studied whether a histone mark can be represented by other marks. Although H3K14ac and H3K23ac can be replaced easily by the combination of two marks, H3K4me3 required more combination to be replaced (Supplementary). We also studied cell-type specific histone codes. We found much less co-occurrences of histone modification in H1. These results, however, were similar with the results from RFECS (). We did not find differences in motif enrichment between groups. However, it clearly shows that AWNFR can capture histone codes and the epigenomic variations across time. As genome-wide analyses of epigenetic regulations have become more popular, the demand for analysis tools such as the one described in this study will be high. As the clustering is based on K-means algorithm, the number of clusters depends on the initial number of clusters. For a binary call for n samples, 2 n clusters are needed. However, we required more than 2 n clusters, as we used floating values for the binding score. For simplicity, we used 64 clusters when we used eight histone marks in IMR90. We also tested the implementation speed. In processing 18 marks (Supplementary) at chromosome 1, NPS took 472 min, whereas our method took around 64 min (Intel core CPU 870@2.93 GHZ, 16 GB RAM), though AWNFR uses multiple wavelet scales.
The Author 2013. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
A wavelet-based method to exploit epigenomic language at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
N.Nguyen et al. at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
