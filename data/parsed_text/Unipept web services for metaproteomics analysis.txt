Unipept is an open source web application that is designed for metaproteomics analysis with a focus on interactive datavisualization. It is underpinned by a fast index built from UniProtKB and the NCBI taxonomy that enables quick retrieval of all UniProt entries in which a given tryptic peptide occurs. Unipept version 2.4 introduced web services that provide programmatic access to the metaproteomics analysis features. This enables integration of Unipept functionality in custom applications and data processing pipelines. Availability and implementation: The web services are freely available at http://api.unipept.ugent. be and are open sourced under the MIT license.
IntroductionUnipept is a web application for biodiversity analysis of complex metaproteomics samples (). The application is powered by a fast index built from UniProtKB () and a cleaned up version of the NCBI taxonomy (). This index enables quick retrieval of all UniProt entries in which a given tryptic peptide occurs. Using the taxonomic annotations of UniProt entries, Unipept also returns the complete set of organisms in which a given peptide occurs. This set of organisms is then processed using a Lowest Common Ancestor (LCA) algorithm to determine the taxonomic specificity of the peptide. All results are presented in clear overview tables and in an interactive treeview. Fast computation of LCAs for given lists of peptides also enables interactive biodiversity analysis of metaproteomics datasets. The biodiversity in complex samples can then be inspected using multiple interactive visualizations such as a treeview (Supplementary), a sunburst view (Supplementary) and a treemap (Supplementary). All visualizations on the Unipept website can be saved as publication-grade graphics, and all analysis results can be exported as Microsoft Excel-compatible CSV files. To guarantee optimal performance and correctness, the Unipept project pursues excellence regarding best practices for modern web application development. One example of this is automatic correctness testing by over 1000 tests after each code change. The entire application including the web services is open source and licensed under the terms of the MIT license. The source code can be found at http://github.com/unipept/unipept. In this article, we present the latest addition to the Unipept toolbox: a set of web services that expose the Unipept analysis functions for use in other applications and data processing pipelines.
MethodsUnipept version 2.4 introduced the Unipept web services. These web services allow access to all Unipept peptide analysis features through a RESTful API. This means that all communication with the web services can be done using simple stateless HTTP requests, to which V C The Author 2016. Published by Oxford University Press. All rights reserved. For Permissions, please e-mail: journals.permissions@oup.com the server answers in JSON. JSON is an open standard for transmitting data that is both human readable and has wide support in developer tools and programming languages. In the next sections, we discuss the available API functions by drawing parallels between usage of the Unipept website and the Unipept API. Supplementarydisplays a schematic overview of the functions, along with the expected input and output. The full documentation can be found at http://api.unipept.ugent.be and as supplementary material. Next to the documentation, the website also offers an interactive API explorer (Supplementary) where API requests can be composed and tested with just a few clicks.
pept2protThe fundamental component in the Tryptic Peptide Analysis feature of Unipept is fast retrieval of all UniProt entries in which a given tryptic peptide occurs. All subsequent calculations are based on this result, and therefore the database indexes are heavily optimized to return it as fast as possible. When doing a Tryptic Peptide analysis in the web interface, the set of all matching UniProt entries is listed on the Protein Matches tab. Its web service counterpart, pept2prot, takes a single tryptic peptide as input and returns the list of all UniProt entries containing the given tryptic peptide. By default, for each entry, the UniProt accession number, protein name and associated NCBI taxon ID are returned. Optionally, users can also request additional information fields such as the name of the organism associated with the UniProt entry, a list of cross-referenced EC numbers () and a list of cross-referenced GO terms (). Users can also choose to equate the isobaric amino acids isoleucine (I) and leucine (L) when matching peptides to proteins, a typical option for mass spectrometry-related queries. Batch retrieval of multiple peptides at once is also supported.
pept2taxaAfter matching the UniProt entries, Unipept uses the cross-referenced NCBI taxon IDs to compile a set of organisms in which the queried peptide occurs. These organisms are then mapped to their taxonomic lineages using a cleaned up version of the NCBI taxonomy database. Using the web interface, the list of organisms along with their lineage can be found in the Lineage Table tab and an interactive visualization is available in the Lineage Tree tab (Supplementary). Similarly, the API function pept2taxa takes a tryptic peptide as input and returns the set of organisms associated with the UniProt entries containing the given tryptic peptide. By default, the taxon ID, name and rank are returned for each of the matched organisms. Optionally, the full lineage of each organism can be requested as a sequence of taxon IDs and/or taxon names. Batch requests and equating isoleucine and leucine are also supported.
pept2lcaThe matched organisms from the previous section are then used to calculate the taxonomic lowest common ancestor (LCA). Simply put, the LCA is the most specific taxonomic rank that all matched organisms have in common. However, the algorithm used by Unipept has several advancements to better cope with taxonomic noise and misclassifications (). One of these improvements is the invalidation of taxonomic nodes that provide little informational values, such as those containing words like 'uncultured', 'unspecified' or 'undetermined' in their name. Invalidated taxa are ignored during LCA calculation and mapped to their first valid ancestor. These invalidated taxa would otherwise result in a drastic loss of information when used for LCA calculation. Another example is mapping strain-specific taxon IDs to their first valid parent taxon to counter the, now abandoned, practice of creating strain-level taxon IDs (). Correspondingly, the pept2lca function returns the LCA (taxon ID, name and rank) for a given tryptic peptide. Optionally, the full lineage (IDs and/or names) can be requested and both equating isoleucine and leucine and batch requests are supported. The LCAs for all tryptic peptides are pre-calculated and stored in the database. Therefore, the peptide matching steps can be skipped for the pept2lca function, resulting in improved performance.
taxa2lcaThe Unipept LCA algorithm can also be used outside a proteomics context by using the taxa2lca function. This API function takes a list of NCBI taxon IDs and calculates their LCA by using the advanced algorithm as applied by Unipept. The result is returned by listing the taxon ID, name and rank of the LCA. Additional lineage information is also available upon request. Note that the pept2lca function can be mimicked by chaining the pept2taxa and taxa2lca functions. This is however not recommended, as pept2lca makes use of precomputed data and is therefore several orders of magnitude faster.
TaxonomyThe taxonomy function provides access to the cleaned up version of the NCBI taxonomy as used by Unipept. This function can be used, for example, to compute more detailed statistics about taxon hits or implement alternative aggregation strategies next to the LCA computation as used by Unipept. The function takes one or more taxon IDs as input and returns the name and rank for each of the given IDs. Optionally, the full lineage can also be returned.
ResultsThe Unipept project consists of two main parts: a collection of scripts to construct the database and the web application. The first part of the database construction, the code to parse UniProt, was recently updated to use Berkeley DB (), a high performance key value store, to store intermediate results. This resulted in an enormous boost in parsing speed: where the old parser took over 30 days to parse UniProt, the new approach using Berkeley DB does the job in under 10 hours. The second part of the database construction is the pre-calculation of the LCAs of all the peptides in the database. The old Ruby code was rewritten in Java and computation time was reduced from over four weeks to just 15 min with the help of some new Java 8 features. The combination of these advancements allows us to consistently offer analysis results based on the latest UniProt release. The second part of Unipept is a Ruby on Rails web application that uses JavaScript for all client side interactions. All data visualizations () are made in-house with the D3.js JavaScript library (). The GalaxyP project already takes advantage of the new Unipept web services to integrate Unipept functionality into the Galaxy Framework (). Exact matching of peptides to UniProt entries is also implemented by the Peptide Match application () of the Protein Information Resource (PIR). Where Unipept is restricted for use with tryptic peptides, Peptide
Unipept web services for metaproteomics analysisMatch has no such limitation. However, the advantage of accepting all peptides comes at the cost of reduced performance. For a test set of 500 tryptic peptides, the Unipept pept2prot function returned all matching UniProt entries in 1.5 s whereas Peptide Match took over 33 min. Since (meta)proteomics experiments almost exclusively use trypsin to digest proteins, resulting in a list of tryptic peptides, this is a reasonable compromise (). All functions of the Unipept API are tweaked for optimal performance and usable for high throughput data analysis. The pept2lca function (no counterpart in PIR), can process over 10 000 peptides per second. For this reason, the information fields that are returned by default are limited to the subset of available fields that can be returned without performance penalty.
Bioinformatics, 32(11), 2016, 17461748 doi: 10.1093/bioinformatics/btw039 Advance Access Publication Date: 27 January 2016 Applications Note at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
B.Mesuere et al. at University of California, Los Angeles on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
