We show the software SOLOMON is improved by using the likelihood ratio instead of an ad hoc statistic.
INTRODUCTIONIn a recent Bioinformatics article, Christie, Tennessen and Blouin (hereafter CTB) present the software SOLOMON for parentage inference from genotype data (). They propose a method of estimating the number of true parent-offspring pairs amongst all the candidate pairs in a dataset and show it provides better results than the program CERVUS () when the fraction of sampled candidates (an input to CERVUS) is misspecified. Here we show that the performance of SOLOMON can be improved by making full use of the genotype data, replacing CTB's statistic with the likelihood ratio as prescribed by a well-established literature (). This is particularly beneficial when using single nucleotide polymorphisms (SNPs) chosen to have minor allele frequency near 0.5, as desired for SNP-based pedigree reconstruction ().
METHODSWe start with an overview of SOLOMON's methodology, adopting new notation where it permits a more complete succinct description.
SOLOMON's methodologyAssume L unlinked loci used to identify the true parents of n 2 diploid offspring from amongst n 1 diploid candidate parents. CTB focus first on the case where all candidate parents are of the same sex and the goal is to identify true parentoffspring pairs from amongst the n 1 n 2 candidate pairs. Let z j count the number of loci not compatible with Mendelian inheritance (barring a genotyping error) between the candidate parent and offspring of pair j. The method of CTB then proceeds in four steps.Step 1: Partition all n 1 n 2 pairs into disjoint sets P 0 ,. .. , P L , where P i includes all pairs j such that z j  i. Denote by #fP i g the cardinality of P i. Step 2: Estimate i , the unknown fraction of pairs in each set P i that are unrelated pairs (i.e. the two members of the pair are unrelated), with ~ i  min 1, n 1 n 2 Pz j  i j pair j is unrelated #fP i g : 1The probability in the numerator is computed by simulation from the estimated allele frequencies in the population. CTB denote ~ i by Pr, and refer to it as the prior probability that a pair in P i is unrelated. CTB define a statistic to describe allele sharing between a pair of individuals. Let y s, ' and y k, ' be genotypes at locus ' in the putative sire s and the putative kid k, respectively. Then, y s, ' , y k, '   0 if s and k share no alleles at locus ', h if s and k share at least one allele and h is the index of the least frequent of the shared alleles,i.e. if a single allele is shared, h is its index, if two alleles are shared, then h is the index of the shared allele that is the least frequent (in the population) of the two shared alleles. Step 3: Calculate for each pair j in P i with i 51 the quantities:where s and k are the members of the pair, R sk denotes the assumed relationship between s and k, U and PO denote 'unrelated' and 'parentoffspring', respectively, L is the set of loci at which s and k share at least one allele, and fy s, ' , y k, '  is the relative frequency in the population of the allele with index y s, ' , y k, ' . To compute T U j , CTB approximate Py s, ' , y k, ' jR sk  U by Monte Carlo simulation. Step 4: Combine ~ i and to compute a 'posterior probability' of parentage for each pair in each P i with i 51. Let X U i represent a random variable defined as the product in (2) when s and k are unrelated individuals simulated conditional on sharing at least one allele at every locus, and L is a randomly chosen set of Li loci at which s and k share alleles. Let X PO i be a random variable that is the product in (3) when s and k are a simulated true parent and offspring. CTB define the 'posterior probability of parentage' for a pair j in P i , with observed values of T U j and T PO j , as:*To whom correspondence should be addressed. QPOj, more a P-value than a posterior probability, is computed by simulation and used to accept or reject pairs as being parentoffspring pairs.
AnalysisThe statistics T PO j and T U j reflect the fact that 'pairs sharing rare alleles are much more likely to be true parentoffspring pairs' (, p. 726); however, they do not reflect the fact that 'a homozygous male that is compatible with a given offspring really does have a higher likelihood of producing it than a heterozygous male sharing one allele with the offspring' (, p. 2512). As such, SOLOMON is not making full use of the data; T PO j and T U j are not sufficient statistics. An example demonstrates this. Consider L  60 biallelic loci, each with one allele at frequency of 0.501 and the other at 0.499. Clearly, little information is gained by knowing whether the first or the second allele is shared in a candidate parentoffspring pair, so, in effect, the statistic y s, ' , y k, '  is merely recording whether or not at least one allele is shared. An unrelated pair shares at least one allele at every locus with probability close to 1  1 8  60  3:3  10 4. Imagine that n 1  n 2  500 and #fP 0 g  165. By (1) we have ~ 0  3:3  10 4  500 2 =165  0:5, so we expect that half of the pairs in P 0 are true parentoffspring pairs. Those true pairs cannot, however, be identified by CTB's method because the observed values T U j and T PO jare effectively identical for every pair j in P 0 , whether it is a true parentoffspring pair or not. We implemented CTB's approach, but based it on the likelihood ratio:Kids are assigned to the candidate sire with highest LRy s , y k . Confidence in those assignments can still be assessed with a P-value, Q  POjy s , y k , like that in (4), by substituting LRy s , y k  for both T PO j and T U j in (4) and redefining X U i and X PO i to be the random variable LRy s , y k  for an s and k drawn randomly from the population conditional on s and k being either unrelated or parental, respectively, and sharing at least one allele at a randomly determined Li loci. We call this the 'likelihood ratio (LR) approach'. To compare the performance of the LR approach to SOLOMON, we simulated 20 datasets under two different scenarios with no genotyping error: (i) n 1  n 2  500, number of true pairs  83 and L  60 biallelic loci with equifrequent alleles; and (ii) n 1  n 2  200 with 50 true pairs, and L  10 loci each with 10 alleles and with the frequency of allele v  1,. .. , 10, proportional to 1=v. 0 is expected to be 0.50 and 0.48 for the scenarios, respectively. Each dataset was analyzed using the LR approach and SOLOMON, and accuracy was compared graphically by plotting the receiver-operating characteristic (ROC) curve () for each dataset.shows that, as predicted, SOLOMON's criterion for parentage contains no extra information beyond Mendelian incompatibility in data scenario 1, with equifrequent alleles. The ROC curves indicate SOLOMON does not rank true pairs any higher than false pairs in P 0. The LR approach performs considerably better.shows that on data with 10 alleles at frequencies that are far from equal (scenario 2), the LR approach still outperforms SOLOMON, as expected. Our implementation of the LR approach, using 10 5 simulation replicates to approximate Q  POjy s , y k , requires roughly 0.1 and 1 min for each dataset from scenarios 1 and 2, respectively, on a single core from a Mac Pro running at 2.8 GHz. SOLOMON, using the default 1000 replicates, requires 16.6 and 225 min.
RESULTS AND CONCLUSIONSCTB propose an interesting way of accounting for the unknown sampling fraction of parents, and we appreciate their efforts to make approachable software. We recommend SOLOMON be updated to use the likelihood instead of , so as to make it more accurate, faster and better suited for general use. In the future it will be interesting to compare how SOLOMON performs against methods that estimate the sampling fraction directly from the genotype probabilities (), rather than formulating a 'prior' based on Mendelian incompatibilities.
at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
E.C.Anderson and T.C.Ng at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
Comment on Christie et al. (2013) at :: on August 30, 2016 http://bioinformatics.oxfordjournals.org/ Downloaded from
